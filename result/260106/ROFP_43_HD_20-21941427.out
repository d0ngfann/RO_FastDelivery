
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 43
DI Scenario: HD
Start Time: 2026-01-05 19:51:54
================================================================================
Loading data from data/DH_data_full_seed43.pkl...

Applying DI scenario: HD
DI values:
  Product 0: ['1.000', '1.412', '1.993'] (k=0.850)
  Product 1: ['1.000', '1.491', '2.224'] (k=0.986)
  Product 2: ['1.000', '1.317', '1.734'] (k=0.678)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=944, max=1697
  DC capacity (MC): min=457, max=879

Demand Structure (s_rk matrix):
  Total customer-product pairs: 85/150 (43.3% sparse)
  Average products per customer: 1.70

Demand (only non-zero entries):
  Nominal (μ): min=10.02, max=34.82, count=85
  Deviation (μ̂): min=4.07, max=10.00

Costs:
  Plant fixed cost: min=5122, max=9822
  DC fixed cost: min=3070, max=5087
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.412', '1.993'] (k=0.850)
    Product 1: ['1.000', '1.491', '2.224'] (k=0.986)
    Product 2: ['1.000', '1.317', '1.734'] (k=0.678)
  MD:
    Product 0: ['1.000', '1.299', '1.688'] (k=0.646)
    Product 1: ['1.000', '1.154', '1.331'] (k=0.353)
    Product 2: ['1.000', '1.286', '1.654'] (k=0.621)
  LD:
    Product 0: ['1.000', '1.028', '1.058'] (k=0.069)
    Product 1: ['1.000', '1.059', '1.121'] (k=0.141)
    Product 2: ['1.000', '1.015', '1.031'] (k=0.037)
  Mixed:
    Product 0: ['1.000', '1.412', '1.993'] (k=0.850)
    Product 1: ['1.000', '1.154', '1.331'] (k=0.353)
    Product 2: ['1.000', '1.015', '1.031'] (k=0.037)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48765 nonzeros
Model fingerprint: 0x0956dbd4
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11666 rows and 2666 columns
Presolve time: 0.20s
Presolved: 5007 rows, 5834 columns, 34720 nonzeros
Variable types: 3575 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -268911.4625
Found heuristic solution: objective -195766.1755

Root relaxation: objective 1.929586e+05, 5257 iterations, 0.40 seconds (0.40 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 192958.602    0  420 -195766.18 192958.602   199%     -    0s
H    0     0                    -195510.0803 192958.602   199%     -    0s
H    0     0                    -161602.2594 175881.030   209%     -    1s
     0     0 175881.030    0  709 -161602.26 175881.030   209%     -    1s
H    0     0                    -153826.3883 175867.871   214%     -    2s
     0     0 175238.329    0  719 -153826.39 175238.329   214%     -    2s
     0     0 175183.062    0  731 -153826.39 175183.062   214%     -    2s
     0     0 175181.763    0  735 -153826.39 175181.763   214%     -    2s
     0     0 162023.519    0  767 -153826.39 162023.519   205%     -    4s
     0     0 161440.506    0  774 -153826.39 161440.506   205%     -    4s
     0     0 161354.662    0  768 -153826.39 161354.662   205%     -    4s
     0     0 161351.855    0  772 -153826.39 161351.855   205%     -    4s
H    0     0                    -152622.5121 150524.059   199%     -    7s
     0     0 150524.059    0  653 -152622.51 150524.059   199%     -    7s
H    0     0                    -134632.0875 150523.346   212%     -    7s
H    0     0                    -69732.42133 149481.245   314%     -    7s
     0     0 149481.245    0  593 -69732.421 149481.245   314%     -    7s
H    0     0                    -61182.58480 149326.529   344%     -    8s
     0     0 149326.529    0  678 -61182.585 149326.529   344%     -    8s
H    0     0                    42681.322284 149282.622   250%     -    8s
H    0     0                    83654.927723 149282.622  78.5%     -    8s
     0     0 149282.622    0  685 83654.9277 149282.622  78.5%     -    8s
     0     0 149262.880    0  701 83654.9277 149262.880  78.4%     -    8s
     0     0 149261.396    0  698 83654.9277 149261.396  78.4%     -    8s
     0     0 145449.226    0  703 83654.9277 145449.226  73.9%     -   10s
     0     0 144785.900    0  719 83654.9277 144785.900  73.1%     -   11s
H    0     0                    83657.265340 144518.733  72.8%     -   11s
     0     0 144518.733    0  717 83657.2653 144518.733  72.8%     -   11s
H    0     0                    84579.531217 144473.092  70.8%     -   12s
H    0     0                    85871.980765 144473.092  68.2%     -   12s
H    0     0                    85921.180345 144473.092  68.1%     -   12s
H    0     0                    86031.944389 144473.092  67.9%     -   12s
H    0     0                    86081.143969 144473.092  67.8%     -   12s
     0     0 144473.092    0  736 86081.1440 144473.092  67.8%     -   12s
     0     0 144463.008    0  732 86081.1440 144463.008  67.8%     -   12s
     0     0 143412.909    0  692 86081.1440 143412.909  66.6%     -   13s
     0     0 143104.573    0  757 86081.1440 143104.573  66.2%     -   13s
H    0     0                    87369.111710 143043.720  63.7%     -   14s
H    0     0                    91052.476343 143043.720  57.1%     -   14s
     0     0 143043.720    0  759 91052.4763 143043.720  57.1%     -   14s
H    0     0                    91839.030599 143028.039  55.7%     -   14s
H    0     0                    92602.288386 143028.039  54.5%     -   14s
H    0     0                    93067.607598 143028.039  53.7%     -   14s
H    0     0                    93068.880067 143028.039  53.7%     -   14s
H    0     0                    93433.103353 143028.039  53.1%     -   14s
H    0     0                    93434.375822 143028.039  53.1%     -   14s
H    0     0                    93639.925423 143028.039  52.7%     -   14s
H    0     0                    93641.197892 143028.039  52.7%     -   14s
     0     0 143028.039    0  771 93641.1979 143028.039  52.7%     -   14s
H    0     0                    93657.738942 143028.039  52.7%     -   14s
H    0     0                    93735.647703 143028.039  52.6%     -   14s
H    0     0                    95809.782538 141366.215  47.5%     -   15s
H    0     0                    98309.859089 141366.215  43.8%     -   15s
     0     0 141366.215    0  688 98309.8591 141366.215  43.8%     -   15s
     0     0 140996.122    0  747 98309.8591 140996.122  43.4%     -   16s
H    0     0                    98930.423925 140799.715  42.3%     -   16s
     0     0 140799.715    0  742 98930.4239 140799.715  42.3%     -   16s
     0     0 140771.442    0  753 98930.4239 140771.442  42.3%     -   16s
H    0     0                    99058.659199 139880.402  41.2%     -   18s
H    0     0                    99161.138428 139880.402  41.1%     -   18s
H    0     0                    99269.551616 139880.402  40.9%     -   18s
H    0     0                    99323.141188 139880.402  40.8%     -   18s
H    0     0                    99738.148952 139880.402  40.2%     -   18s
     0     0 139880.402    0  707 99738.1490 139880.402  40.2%     -   18s
     0     0 139718.302    0  709 99738.1490 139718.302  40.1%     -   18s
     0     0 139629.425    0  722 99738.1490 139629.425  40.0%     -   18s
     0     0 139611.073    0  770 99738.1490 139611.073  40.0%     -   19s
     0     0 138947.957    0  684 99738.1490 138947.957  39.3%     -   20s
     0     0 138782.327    0  710 99738.1490 138782.327  39.1%     -   20s
     0     0 138661.464    0  744 99738.1490 138661.464  39.0%     -   21s
     0     0 138629.208    0  751 99738.1490 138629.208  39.0%     -   21s
     0     0 138197.682    0  677 99738.1490 138197.682  38.6%     -   22s
     0     0 138094.858    0  766 99738.1490 138094.858  38.5%     -   22s
H    0     0                    100196.48606 138063.818  37.8%     -   23s
H    0     0                    102334.72008 138063.818  34.9%     -   23s
H    0     0                    102420.55470 138063.818  34.8%     -   23s
     0     0 138063.818    0  815 102420.555 138063.818  34.8%     -   23s
H    0     0                    102499.31511 138063.818  34.7%     -   23s
H    0     0                    102764.53868 138063.818  34.3%     -   23s
H    0     0                    102988.54460 138063.818  34.1%     -   23s
     0     0 137027.157    0  562 102988.545 137027.157  33.1%     -   24s
     0     0 136794.145    0  564 102988.545 136794.145  32.8%     -   25s
     0     0 136713.559    0  577 102988.545 136713.559  32.7%     -   25s
     0     0 136664.390    0  597 102988.545 136664.390  32.7%     -   25s
     0     0 136649.805    0  682 102988.545 136649.805  32.7%     -   25s
     0     0 136004.745    0  567 102988.545 136004.745  32.1%     -   26s
H    0     0                    103591.53877 135801.097  31.1%     -   27s
H    0     0                    103697.59232 135801.097  31.0%     -   27s
H    0     0                    103895.59963 135801.097  30.7%     -   27s
H    0     0                    104329.22973 135801.097  30.2%     -   27s
     0     0 135801.097    0  602 104329.230 135801.097  30.2%     -   27s
     0     0 135731.476    0  609 104329.230 135731.476  30.1%     -   27s
     0     0 135699.773    0  660 104329.230 135699.773  30.1%     -   28s
     0     0 135273.810    0  611 104329.230 135273.810  29.7%     -   29s
     0     0 135102.679    0  657 104329.230 135102.679  29.5%     -   29s
     0     0 135036.226    0  652 104329.230 135036.226  29.4%     -   30s
     0     0 135015.428    0  660 104329.230 135015.428  29.4%     -   30s
H    0     0                    104739.08340 134839.737  28.7%     -   31s
     0     0 134839.737    0  661 104739.083 134839.737  28.7%     -   31s
     0     0 134839.701    0  661 104739.083 134839.701  28.7%     -   31s
     0     2 134839.655    0  661 104739.083 134839.655  28.7%     -   33s
     7    16 133907.353    3  620 104739.083 134566.354  28.5%  1537   36s
    63    96 133005.411    6  560 104739.083 133677.432  27.6%  1930   40s
H  104   184                    104980.50934 133677.432  27.3%  1674   42s
H  114   184                    105689.72518 133677.432  26.5%  1623   42s
H  154   184                    107662.97453 133677.432  24.2%  1443   42s
   322   361 130566.008   11  580 107662.975 133677.432  24.2%   971   45s
H  345   361                    108097.96509 133677.432  23.7%   953   45s
H  383   393                    108244.63547 133677.432  23.5%   931   47s
   572   655 131168.903   15  581 108244.635 133677.432  23.5%   784   51s
H  735   820                    108420.91728 133677.432  23.3%   721   53s
H  758   820                    108476.79065 133677.432  23.2%   727   53s
H  773   820                    109145.99330 133677.432  22.5%   716   53s
   851   888 129789.574   18  487 109145.993 133677.432  22.5%   686   55s
H  875   888                    109239.71695 133677.432  22.4%   688   55s
H  993  1058                    109317.48613 133677.432  22.3%   653   58s
H  997  1058                    109318.05644 133677.432  22.3%   654   58s
H 1003  1058                    109320.22814 133677.432  22.3%   659   58s
H 1023  1058                    109381.52224 133677.432  22.2%   657   58s
  1193  1189 128329.698   23  482 109381.522 133440.892  22.0%   623   62s
H 1197  1189                    109384.26425 133440.892  22.0%   623   62s
  1330  1317 128045.122   24  492 109384.264 133440.892  22.0%   649   65s
  1684  1717 126866.481   31  405 109384.264 133440.892  22.0%   626   70s
H 1721  1717                    109470.80685 133440.892  21.9%   627   70s
  2541  2642 122224.020   49  256 109470.807 133311.618  21.8%   534   75s
  3299  3412 120289.857   64  204 109470.807 133311.618  21.8%   484   80s
  4222  4014 115021.505  105  200 109470.807 133178.253  21.7%   435   85s
  4522  4385 112230.606  114  245 109470.807 133178.253  21.7%   445   91s
  5072  4898 128398.575   13  514 109470.807 133026.352  21.5%   431   95s
  5641  5146 111025.331  107  661 109470.807 132963.348  21.5%   424  110s
  5662  5160 123379.518   34  303 109470.807 131174.078  19.8%   422  115s
  5682  5173 130852.216    7  316 109470.807 130852.216  19.5%   421  120s
  5838  5308 123021.810   18  324 109470.807 127899.845  16.8%   428  125s
H 6026  5064                    109489.05821 127430.168  16.4%   426  127s
H 6389  4881                    109496.83728 125915.542  15.0%   416  129s
  6431  4909 118614.350   24  231 109496.837 125699.949  14.8%   415  130s
  7124  5031 117419.255   24  267 109496.837 124596.798  13.8%   399  135s
  7844  5159 112628.922   26  111 109496.837 122793.397  12.1%   382  140s
  8359  5102 109611.286   37   20 109496.837 122360.810  11.7%   371  145s
  9483  5053     cutoff   41      109496.837 120948.119  10.5%   352  150s
 12058  4743 117946.013   22  192 109496.837 119349.711  9.00%   320  155s
 14821  4147 111715.915   25  331 109496.837 118090.255  7.85%   301  160s
 17990  3204     cutoff   23      109496.837 116815.697  6.68%   285  166s
 21218  2477 109912.171   28  255 109496.837 115653.697  5.62%   272  171s
 22571  2242     cutoff   27      109496.837 115126.057  5.14%   268  175s
*24754  1965              46    109504.26141 114529.693  4.59%   262  178s
 25305  1660     cutoff   25      109504.261 114292.990  4.37%   260  180s
H25307  1582                    109684.42669 114292.990  4.20%   260  180s
H25501  1542                    109787.04486 114292.990  4.10%   259  180s
*26999  1115              41    109800.37102 113553.069  3.42%   255  182s
H31421     0                    109837.61233 110037.651  0.18%   230  184s

Cutting planes:
  Gomory: 2
  Implied bound: 8
  Projected implied bound: 2
  MIR: 409
  Mixing: 2
  Flow cover: 608
  RLT: 6
  Relax-and-lift: 73

Explored 31482 nodes (7292094 simplex iterations) in 184.82 seconds (270.84 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 109838 109838 109800 ... 109384

Optimal solution found (tolerance 1.00e-04)
Best objective 1.098376123290e+05, best bound 1.098376123290e+05, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 184.83s
  Master Objective (UB) = 109837.61, θ = 283746.86
  Upper Bound (UB) = 109837.61

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 283746.86
  [DEBUG]   ✓ Scenario 0: θ = 283746.86 ≤ Q = 283746.86 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x7925c74f
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x7925c74f
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.568503e+13
Presolve removed 2567 rows and 1858 columns
Presolve time: 0.01s
Presolved: 526 rows, 531 columns, 1484 nonzeros
Found heuristic solution: objective 8230679.8586
Variable types: 361 continuous, 170 integer (170 binary)

Root relaxation: objective -1.662283e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -166228.33    0  122 8230679.86 -166228.33   102%     -    0s
H    0     0                    -129881.5085 -166228.33  28.0%     -    0s
H    0     0                    -131311.6074 -166228.33  26.6%     -    0s
*    0     0               0    -134100.0004 -134100.00  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 207

Explored 1 nodes (378 simplex iterations) in 0.03 seconds (0.02 work units)
Thread count was 32 (of 32 available processors)

Solution count 5: -134100 -131312 -129882 ... 1.5685e+13
No other solutions better than -134100

Optimal solution found (tolerance 1.00e-04)
Best objective -1.341000004153e+05, best bound -1.341000004153e+05, gap 0.0000%
  Subproblem solved in 0.06s
  Worst-case operational profit (Z_SP) = 249243.70
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -134100.00
  [DEBUG]   S×d_nominal = 383343.70
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 383343.70 + -134100.00 = 249243.70
  [DEBUG]   Current θ from Master = 283746.86
  [DEBUG]   ⚠️  Z_SP ≤ θ by 34503.16 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 75334.45
  Lower Bound (LB) = 75334.45
  Gap (UB-LB) = 34503.1638, Absolute Gap = 34503.1638, Relative Gap = 0.314129
  Not converged yet (gap = 34503.16 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 92011 nonzeros
Model fingerprint: 0xa5c6cd17
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 75334.4 (0.02s)
Loaded MIP start from previous solve with objective 75334.4

Presolve removed 13131 rows and 5330 columns
Presolve time: 0.57s
Presolved: 18832 rows, 9410 columns, 104388 nonzeros
Variable types: 7151 continuous, 2259 integer (2259 binary)

Root relaxation: objective 1.238013e+05, 8077 iterations, 1.32 seconds (1.35 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 123801.312    0  179 75334.4486 123801.312  64.3%     -    2s
H    0     0                    79590.060024 123801.312  55.5%     -    2s
H    0     0                    82242.302122 123801.312  50.5%     -    2s
     0     0 116353.686    0  283 82242.3021 116353.686  41.5%     -    4s
H    0     0                    82345.825874 116338.148  41.3%     -    4s
     0     0 115955.188    0  334 82345.8259 115955.188  40.8%     -    5s
     0     0 115931.970    0  334 82345.8259 115931.970  40.8%     -    5s
H    0     0                    82365.674998 115931.970  40.8%     -    5s
H    0     0                    82377.833855 115931.970  40.7%     -    5s
H    0     0                    82463.182613 111538.810  35.3%     -    7s
     0     0 111538.810    0  422 82463.1826 111538.810  35.3%     -    7s
     0     0 110551.284    0  387 82463.1826 110551.284  34.1%     -    8s
     0     0 110411.452    0  384 82463.1826 110411.452  33.9%     -    8s
     0     0 110404.226    0  383 82463.1826 110404.226  33.9%     -    8s
     0     0 110402.769    0  385 82463.1826 110402.769  33.9%     -    8s
H    0     0                    82469.024259 108506.468  31.6%     -   10s
H    0     0                    82479.853894 108506.468  31.6%     -   11s
     0     0 108506.468    0  369 82479.8539 108506.468  31.6%     -   11s
H    0     0                    82502.945442 107732.005  30.6%     -   12s
H    0     0                    82505.349513 107732.005  30.6%     -   12s
     0     0 107732.005    0  390 82505.3495 107732.005  30.6%     -   12s
     0     0 107410.896    0  415 82505.3495 107410.896  30.2%     -   12s
     0     0 107137.382    0  394 82505.3495 107137.382  29.9%     -   12s
     0     0 107082.926    0  404 82505.3495 107082.926  29.8%     -   13s
     0     0 106952.758    0  409 82505.3495 106952.758  29.6%     -   13s
     0     0 106842.319    0  424 82505.3495 106842.319  29.5%     -   13s
     0     0 106827.917    0  422 82505.3495 106827.917  29.5%     -   13s
     0     0 106825.773    0  415 82505.3495 106825.773  29.5%     -   13s
H    0     0                    82515.878089 105471.559  27.8%     -   17s
     0     0 105471.559    0  344 82515.8781 105471.559  27.8%     -   17s
H    0     0                    82516.317658 105470.438  27.8%     -   17s
H    0     0                    82531.111950 105470.438  27.8%     -   17s
     0     0 104954.311    0  352 82531.1120 104954.311  27.2%     -   18s
     0     0 104781.950    0  345 82531.1120 104781.950  27.0%     -   19s
     0     0 104694.359    0  475 82531.1120 104694.359  26.9%     -   19s
     0     0 104663.052    0  407 82531.1120 104663.052  26.8%     -   19s
     0     0 104654.884    0  416 82531.1120 104654.884  26.8%     -   19s
     0     0 104646.681    0  423 82531.1120 104646.681  26.8%     -   20s
     0     0 104643.997    0  421 82531.1120 104643.997  26.8%     -   20s
     0     0 104099.929    0  391 82531.1120 104099.929  26.1%     -   21s
     0     0 104054.000    0  390 82531.1120 104054.000  26.1%     -   22s
     0     0 104023.065    0  400 82531.1120 104023.065  26.0%     -   22s
     0     0 104017.881    0  397 82531.1120 104017.881  26.0%     -   22s
     0     0 104015.999    0  397 82531.1120 104015.999  26.0%     -   23s
     0     0 103767.447    0  324 82531.1120 103767.447  25.7%     -   24s
     0     0 103646.700    0  337 82531.1120 103646.700  25.6%     -   25s
     0     0 103601.026    0  344 82531.1120 103601.026  25.5%     -   25s
     0     0 103588.198    0  334 82531.1120 103588.198  25.5%     -   25s
     0     0 103587.669    0  328 82531.1120 103587.669  25.5%     -   25s
     0     0 103485.790    0  336 82531.1120 103485.790  25.4%     -   26s
     0     0 103471.499    0  443 82531.1120 103471.499  25.4%     -   27s
     0     0 103468.829    0  442 82531.1120 103468.829  25.4%     -   27s
     0     0 103418.822    0  422 82531.1120 103418.822  25.3%     -   27s
     0     0 103388.598    0  388 82531.1120 103388.598  25.3%     -   29s
     0     0 103383.441    0  399 82531.1120 103383.441  25.3%     -   29s
     0     0 103380.868    0  387 82531.1120 103380.868  25.3%     -   29s
     0     0 103341.344    0  383 82531.1120 103341.344  25.2%     -   30s
     0     0 103320.112    0  387 82531.1120 103320.112  25.2%     -   30s
     0     0 103315.126    0  397 82531.1120 103315.126  25.2%     -   30s
     0     0 103314.735    0  399 82531.1120 103314.735  25.2%     -   30s
     0     0 103296.576    0  339 82531.1120 103296.576  25.2%     -   31s
     0     0 103293.433    0  333 82531.1120 103293.433  25.2%     -   31s
     0     0 103280.746    0  344 82531.1120 103280.746  25.1%     -   32s
     0     0 103276.435    0  339 82531.1120 103276.435  25.1%     -   32s
     0     0 103276.430    0  324 82531.1120 103276.430  25.1%     -   32s
     0     0 103274.780    0  324 82531.1120 103274.780  25.1%     -   33s
     0     2 103274.780    0  324 82531.1120 103274.780  25.1%     -   38s
     3     8 103049.981    2  327 82531.1120 103127.255  25.0%   511   40s
    63    96 101762.168    6  326 82531.1120 102243.250  23.9%  1086   46s
    95   135 101435.626    7  326 82531.1120 102243.250  23.9%   904   51s
H  110   135                    82532.277219 102243.250  23.9%   844   51s
   234   313 99956.9048    9  306 82532.2772 102243.250  23.9%   705   55s
   451   516 99823.4234   10  317 82532.2772 102243.250  23.9%   628   60s
   671   680 98991.8931   13  480 82532.2772 102243.250  23.9%   579   66s
H  769   751                    82591.381676 102243.250  23.8%   572   68s
   779   834 98807.1491   15  306 82591.3817 102243.250  23.8%   570   70s
  1005  1009 96876.5865   21  379 82591.3817 102243.250  23.8%   538   76s
  1198  1210 96449.5367   26  434 82591.3817 101836.934  23.3%   507   81s
  1490  1516 95649.9135   31  402 82591.3817 101836.934  23.3%   466   85s
  1825  1829 94169.9047   36  341 82591.3817 101836.934  23.3%   451   91s
  2168  2092 93184.1553   40  318 82591.3817 101759.312  23.2%   421   95s
  2506  2391 91338.8779   47  210 82591.3817 101584.929  23.0%   407  100s
  3130  2998 84540.4345   57  275 82591.3817 101344.958  22.7%   384  107s
  3435  3263 84862.0981   61  137 82591.3817 101155.621  22.5%   368  110s
  3785  3264 98992.7925   10  324 82591.3817 101022.830  22.3%   351  120s
  3788  3266 95101.3100   18  280 82591.3817 101022.830  22.3%   351  126s
  3793  3269 93313.0422   26  363 82591.3817 101022.830  22.3%   350  130s
  3801  3275 99523.2498    9  324 82591.3817 101022.830  22.3%   349  135s
  3805  3277 92935.9606   21  348 82591.3817 101022.830  22.3%   349  140s
  3812  3282 95491.4899   15  327 82591.3817 101022.830  22.3%   348  146s
  3816  3285 95096.2878   18  326 82591.3817 101022.830  22.3%   348  151s
  3819  3287 92768.2651   32  328 82591.3817 101022.830  22.3%   348  155s
  3826  3291 87105.7208   41  337 82591.3817 101022.830  22.3%   347  163s
  3827  3292 99879.9380    9  337 82591.3817 101022.830  22.3%   347  166s
  3828  3296 100882.275   13  313 82591.3817 101022.830  22.3%   355  170s
  3842  3319 94946.1383   16  284 82591.3817 100553.385  21.7%   358  176s
  3890  3367 92994.1704   18  289 82591.3817 99863.7086  20.9%   369  180s
  4081  3488 88774.9728   21  276 82591.3817 99860.4435  20.9%   379  186s
  4225  3495 86665.8034   23  272 82591.3817 99522.1875  20.5%   384  190s
  4346  3533 84825.1840   24  331 82591.3817 99522.1875  20.5%   390  195s
  4483  3575 82992.4137   26  302 82591.3817 99038.7719  19.9%   391  200s
  4665  3629 92636.7149   24  254 82591.3817 99038.7719  19.9%   392  205s
  4898  3672 91824.9322   27  202 82591.3817 99038.7719  19.9%   390  211s
  5084  3692 89122.5273   29  176 82591.3817 98179.0511  18.9%   389  216s
  5274  3714 87639.4438   31  134 82591.3817 98178.4578  18.9%   390  221s
  5482  3746 86309.8067   34  131 82591.3817 97628.9746  18.2%   391  226s
  5662  3735 85138.4043   42  143 82591.3817 97572.6142  18.1%   391  230s
  5964  3829 93836.6487   23  367 82591.3817 96802.9547  17.2%   389  235s
  6403  3826 83726.6460   35   83 82591.3817 96555.5983  16.9%   384  241s
  6857  3922 83918.7603   29  168 82591.3817 96453.2259  16.8%   383  246s
  7406  3947 83755.5381   32  162 82591.3817 96299.9682  16.6%   379  251s
  7922  3972 86449.2144   30  197 82591.3817 95907.9143  16.1%   378  256s
  8242  3915 88906.9115   23  177 82591.3817 95032.3521  15.1%   379  261s
  8671  3910     cutoff   31      82591.3817 94869.0846  14.9%   377  267s
  8886  3928 88499.6337   28  256 82591.3817 94869.0846  14.9%   378  271s
  9489  3972 89376.2019   32  202 82591.3817 94227.2184  14.1%   380  278s
  9811  3972 89745.7244   24  292 82591.3817 94227.2184  14.1%   378  282s
 10243  3945     cutoff   29      82591.3817 94227.2184  14.1%   375  285s
 11000  3945     cutoff   28      82591.3817 93249.2126  12.9%   375  292s
 11413  3926 83416.4880   27  160 82591.3817 93249.2126  12.9%   375  296s
 12350  3925 86088.3015   28  228 82591.3817 92769.7621  12.3%   373  302s
 12851  3813 86711.1944   28  341 82591.3817 92563.5406  12.1%   372  306s
 13189  3788     cutoff   31      82591.3817 92376.7488  11.8%   370  310s
 13694  3802 83810.7289   23  224 82591.3817 92326.4479  11.8%   370  315s
 14276  3846 84525.5921   28  167 82591.3817 92133.8260  11.6%   367  323s
H14331  3785                    82912.945391 92133.8260  11.1%   366  323s
 14338  3836 84258.5621   29  176 82912.9454 92133.8260  11.1%   366  327s
 15062  3918     cutoff   30      82912.9454 91967.3103  10.9%   363  331s
 15598  3946 87959.1299   31  177 82912.9454 91661.1067  10.6%   363  336s
H15600  3924                    82962.877046 91661.1067  10.5%   363  336s
 15720  4017 87284.9491   32  185 82962.8770 91657.8772  10.5%   363  340s
 16764  4120 83037.7403   35  182 82962.8770 91405.2401  10.2%   363  349s
 16919  4124     cutoff   36      82962.8770 91357.0300  10.1%   363  353s
 17035  4181 83300.7093   36  160 82962.8770 91356.1067  10.1%   363  357s
 17610  4198 88509.9537   23  247 82962.8770 91226.7409  10.0%   361  363s
 18126  4224 89518.7198   25  342 82962.8770 90995.1202  9.68%   361  369s
H18127  4152                    83097.638394 90995.1202  9.50%   361  369s
 18350  4227 88087.0145   26  199 83097.6384 90952.8341  9.45%   362  374s
 19236  4259 86520.3497   19  276 83097.6384 90680.8023  9.13%   360  379s
 19961  4245 85765.2483   29  303 83097.6384 90434.2593  8.83%   359  384s
 20863  4252     cutoff   29      83097.6384 90224.8203  8.58%   358  391s
 21266  4240 86262.0939   24  226 83097.6384 90011.5446  8.32%   358  397s
 22264  4179 84814.0424   28  209 83097.6384 89867.2079  8.15%   356  404s
 23234  4130 84277.5783   30  208 83097.6384 89704.3429  7.95%   356  409s
 24296  4026 85554.4348   30  205 83097.6384 89228.4917  7.38%   354  417s
 25368  3888 83708.9409   25  324 83097.6384 88955.5022  7.05%   352  424s
 26280  3630 83413.1094   30  229 83097.6384 88671.5602  6.71%   350  432s
 27562  3280     cutoff   25      83097.6384 88266.9040  6.22%   348  438s
 28924  2870 83307.5916   27  224 83097.6384 87821.5337  5.68%   345  445s
 30339  2220 84041.8604   28  310 83097.6384 87369.5094  5.14%   341  454s
 31828  1198 infeasible   28      83097.6384 86540.2823  4.14%   338  460s
 34036  3192     cutoff   37      83097.6384 85836.1540  3.30%   328  467s
*34090  3192              69    83127.013335 85836.1540  3.26%   328  467s
*34190  3192             104    83154.282267 85836.1540  3.23%   327  467s
*35101  3192              69    83295.537698 85727.1434  2.92%   319  467s
*35162  3192              77    83426.558564 85727.1434  2.76%   319  467s
*35334  3192              80    83461.185616 85727.1434  2.71%   318  467s
 40084  5292 83828.9432   47   50 83461.1856 84135.7530  0.81%   285  476s
*40510  5292              86    83580.315853 84135.7530  0.66%   282  476s
*47094  5292             106    83584.701617 83993.1403  0.49%   246  476s
*47422  2536              75    83719.848053 83931.7455  0.25%   245  478s

Cutting planes:
  Lift-and-project: 51
  MIR: 407
  Mixing: 2
  Flow cover: 897
  RLT: 8
  Relax-and-lift: 87

Explored 53247 nodes (11739155 simplex iterations) in 480.09 seconds (781.19 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 83719.8 83719.8 83584.7 ... 83097.6

Optimal solution found (tolerance 1.00e-04)
Best objective 8.371984805344e+04, best bound 8.371984805344e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 480.17s
  Master Objective (UB) = 83719.85, θ = 233905.02
  Upper Bound (UB) = 83719.85

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 233905.02
  [DEBUG]   ✓ Scenario 0: θ = 233905.02 ≤ Q = 233905.02 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 233905.02 ≤ Q = 233905.02 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x3d652750
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x3d652750
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.577034e+13
Presolve removed 2569 rows and 1861 columns
Presolve time: 0.01s
Presolved: 524 rows, 528 columns, 1481 nonzeros
Found heuristic solution: objective 8281059.4406
Variable types: 358 continuous, 170 integer (170 binary)

Root relaxation: objective -1.717179e+05, 263 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -171717.85    0  133 8281059.44 -171717.85   102%     -    0s
H    0     0                    -132475.9611 -171717.85  29.6%     -    0s
H    0     0                    -134011.0492 -171717.85  28.1%     -    0s
H    0     0                    -151174.1288 -171717.85  13.6%     -    0s
     0     0 -157779.34    0  127 -151174.13 -157779.34  4.37%     -    0s
H    0     0                    -155236.7792 -157777.66  1.64%     -    0s
     0     0 -157076.33    0  106 -155236.78 -157076.33  1.18%     -    0s
     0     0 -156672.03    0   56 -155236.78 -156672.03  0.92%     -    0s
H    0     0                    -156192.6168 -156670.04  0.31%     -    0s
H    0     0                    -156258.2678 -156670.04  0.26%     -    0s
     0     0 -156657.61    0   39 -156258.27 -156657.61  0.26%     -    0s
     0     0 -156651.43    0   37 -156258.27 -156651.43  0.25%     -    0s
H    0     0                    -156279.1641 -156629.34  0.22%     -    0s
     0     0 -156625.53    0   40 -156279.16 -156625.53  0.22%     -    0s
     0     0 -156595.39    0   34 -156279.16 -156595.39  0.20%     -    0s
     0     0 -156592.21    0   31 -156279.16 -156592.21  0.20%     -    0s
     0     0 -156591.78    0   32 -156279.16 -156591.78  0.20%     -    0s
     0     0 -156496.05    0   18 -156279.16 -156496.05  0.14%     -    0s
H    0     0                    -156298.7918 -156496.03  0.13%     -    0s
     0     0 -156489.00    0   20 -156298.79 -156489.00  0.12%     -    0s
     0     0 -156485.20    0   17 -156298.79 -156485.20  0.12%     -    0s
     0     0 -156485.20    0   61 -156298.79 -156485.20  0.12%     -    0s
     0     0 -156437.13    0   17 -156298.79 -156437.13  0.09%     -    0s
H    0     0                    -156311.7401 -156430.60  0.08%     -    0s
     0     0 -156430.60    0   17 -156311.74 -156430.60  0.08%     -    0s
     0     0 -156350.13    0   53 -156311.74 -156350.13  0.02%     -    0s
     0     0 -156334.69    0   22 -156311.74 -156334.69  0.01%     -    0s
     0     0          -    0      -156311.74 -156327.19  0.01%     -    0s

Cutting planes:
  Gomory: 17
  Implied bound: 3
  MIR: 54
  Flow cover: 12
  Relax-and-lift: 7

Explored 1 nodes (1000 simplex iterations) in 0.27 seconds (0.07 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -156312 -156299 -156279 ... 8.28106e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.563117401136e+05, best bound -1.563271888398e+05, gap 0.0099%
  Subproblem solved in 0.31s
  Worst-case operational profit (Z_SP) = 211354.71
  Scenario: 38 demand increases, 22 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -156311.74
  [DEBUG]   S×d_nominal = 367666.45
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 367666.45 + -156311.74 = 211354.71
  [DEBUG]   Current θ from Master = 233905.02
  [DEBUG]   ⚠️  Z_SP ≤ θ by 22550.31 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 61169.54
  Lower Bound (LB) = 75334.45
  Gap (UB-LB) = 8385.3995, Absolute Gap = 8385.3995, Relative Gap = 0.100160
  Not converged yet (gap = 8385.40 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 38 increases, 22 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135257 nonzeros
Model fingerprint: 0x8d72c6e5
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 61169.5 (0.03s)
MIP start from previous solve produced solution with objective 61169.5 (0.04s)
Loaded MIP start from previous solve with objective 61169.5

Presolve removed 19695 rows and 7995 columns
Presolve time: 0.83s
Presolved: 27558 rows, 12985 columns, 169574 nonzeros
Variable types: 10726 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   47323    8.3916934e+04   0.000000e+00   7.762785e+06      5s
Concurrent spin time: 0.16s

Solved with dual simplex

Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   22013    1.1951443e+05   0.000000e+00   0.000000e+00      9s

Root relaxation: objective 1.195144e+05, 22013 iterations, 7.95 seconds (8.95 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 119514.434    0   85 61169.5391 119514.434  95.4%     -    9s
H    0     0                    63920.385841 119514.434  87.0%     -    9s
H    0     0                    69142.849909 119514.434  72.9%     -    9s
H    0     0                    77223.374247 119514.434  54.8%     -    9s
H    0     0                    77489.274751 119514.434  54.2%     -    9s
     0     0 111952.133    0  107 77489.2748 111952.133  44.5%     -   12s
     0     0 110635.690    0  166 77489.2748 110635.690  42.8%     -   14s
     0     0 110525.594    0  168 77489.2748 110525.594  42.6%     -   14s
     0     0 110525.594    0  166 77489.2748 110525.594  42.6%     -   15s
     0     0 110525.594    0  166 77489.2748 110525.594  42.6%     -   15s
     0     0 107448.849    0  264 77489.2748 107448.849  38.7%     -   17s
H    0     0                    78731.819483 107448.835  36.5%     -   18s
H    0     0                    78900.487115 107448.835  36.2%     -   18s
     0     0 106860.141    0  310 78900.4871 106860.141  35.4%     -   20s
     0     0 106687.314    0  321 78900.4871 106687.314  35.2%     -   20s
     0     0 106648.220    0  318 78900.4871 106648.220  35.2%     -   21s
     0     0 106643.396    0  314 78900.4871 106643.396  35.2%     -   21s
     0     0 106641.771    0  316 78900.4871 106641.771  35.2%     -   21s
     0     0 106641.443    0  316 78900.4871 106641.443  35.2%     -   21s
H    0     0                    79028.492168 105104.278  33.0%     -   26s
H    0     0                    79080.016972 105104.278  32.9%     -   26s
     0     0 105104.278    0  261 79080.0170 105104.278  32.9%     -   26s
     0     0 104681.147    0  271 79080.0170 104681.147  32.4%     -   27s
     0     0 104374.856    0  294 79080.0170 104374.856  32.0%     -   28s
     0     0 104133.418    0  283 79080.0170 104133.418  31.7%     -   29s
H    0     0                    79097.467990 104107.344  31.6%     -   29s
H    0     0                    79126.643005 104107.344  31.6%     -   29s
     0     0 104107.344    0  286 79126.6430 104107.344  31.6%     -   29s
H    0     0                    79131.017701 104090.831  31.5%     -   30s
     0     0 104090.831    0  320 79131.0177 104090.831  31.5%     -   30s
     0     0 104083.890    0  322 79131.0177 104083.890  31.5%     -   30s
     0     0 104080.728    0  323 79131.0177 104080.728  31.5%     -   30s
     0     0 104078.305    0  323 79131.0177 104078.305  31.5%     -   30s
     0     0 104064.851    0  324 79131.0177 104064.851  31.5%     -   30s
     0     0 104055.377    0  331 79131.0177 104055.377  31.5%     -   31s
     0     0 104054.601    0  328 79131.0177 104054.601  31.5%     -   31s
     0     0 103365.937    0  332 79131.0177 103365.937  30.6%     -   36s
H    0     0                    79153.015010 103365.510  30.6%     -   36s
     0     0 103272.772    0  291 79153.0150 103272.772  30.5%     -   38s
     0     0 103116.127    0  296 79153.0150 103116.127  30.3%     -   39s
     0     0 103059.934    0  299 79153.0150 103059.934  30.2%     -   40s
     0     0 103028.090    0  293 79153.0150 103028.090  30.2%     -   40s
     0     0 103018.584    0  304 79153.0150 103018.584  30.2%     -   41s
     0     0 103014.744    0  303 79153.0150 103014.744  30.1%     -   41s
     0     0 103013.735    0  301 79153.0150 103013.735  30.1%     -   41s
     0     0 102815.584    0  368 79153.0150 102815.584  29.9%     -   43s
     0     0 102762.790    0  303 79153.0150 102762.790  29.8%     -   44s
     0     0 102712.785    0  383 79153.0150 102712.785  29.8%     -   45s
     0     0 102703.911    0  354 79153.0150 102703.911  29.8%     -   45s
     0     0 102701.401    0  351 79153.0150 102701.401  29.8%     -   45s
     0     0 102699.924    0  352 79153.0150 102699.924  29.7%     -   45s
     0     0 102601.748    0  311 79153.0150 102601.748  29.6%     -   47s
     0     0 102568.429    0  323 79153.0150 102568.429  29.6%     -   48s
     0     0 102560.378    0  356 79153.0150 102560.378  29.6%     -   48s
     0     0 102555.434    0  398 79153.0150 102555.434  29.6%     -   49s
     0     0 102554.346    0  355 79153.0150 102554.346  29.6%     -   49s
     0     0 102435.671    0  365 79153.0150 102435.671  29.4%     -   50s
     0     0 102383.127    0  316 79153.0150 102383.127  29.3%     -   51s
     0     0 102363.568    0  369 79153.0150 102363.568  29.3%     -   51s
     0     0 102356.940    0  370 79153.0150 102356.940  29.3%     -   52s
     0     0 102355.977    0  370 79153.0150 102355.977  29.3%     -   52s
     0     0 102338.820    0  318 79153.0150 102338.820  29.3%     -   53s
     0     0 102335.985    0  326 79153.0150 102335.985  29.3%     -   53s
     0     0 102335.130    0  323 79153.0150 102335.130  29.3%     -   53s
     0     0 102325.012    0  320 79153.0150 102325.012  29.3%     -   54s
     0     0 102321.307    0  323 79153.0150 102321.307  29.3%     -   54s
     0     0 102316.592    0  321 79153.0150 102316.592  29.3%     -   54s
     0     0 102314.297    0  317 79153.0150 102314.297  29.3%     -   55s
     0     0 102313.151    0  329 79153.0150 102313.151  29.3%     -   55s
     0     0 102310.990    0  324 79153.0150 102310.990  29.3%     -   55s
     0     0 102308.818    0  326 79153.0150 102308.818  29.3%     -   56s
     0     0 102308.818    0  324 79153.0150 102308.818  29.3%     -   56s
     0     0 102306.395    0  324 79153.0150 102306.395  29.3%     -   57s
H    0     0                    79382.621258 102306.395  28.9%     -   64s
     0     2 102306.395    0  324 79382.6213 102306.395  28.9%     -   64s
     1     4 102076.933    1  367 79382.6213 102303.127  28.9%  1270   65s
     7    16 101519.591    3  325 79382.6213 102024.976  28.5%  1416   70s
    31    64 101146.773    5  369 79382.6213 101448.302  27.8%  3154   77s
    63    96 100548.772    6  383 79382.6213 101145.187  27.4%  2711   81s
H   95   177                    79402.800664 101145.187  27.4%  2862   85s
H   96   177                    79511.018790 101145.187  27.2%  2842   85s
H   97   177                    79747.051196 101145.187  26.8%  2831   85s
   266   335 99929.0812    9  449 79747.0512 101145.187  26.8%  1620   92s
H  295   335                    79808.579296 101145.187  26.7%  1576   92s
   334   405 98402.0618    9  335 79808.5793 101145.187  26.7%  1526   95s
H  442   502                    79820.013277 101145.187  26.7%  1369   99s
   501   589 99585.4539   11  361 79820.0133 101145.187  26.7%  1327  103s
   590   671 99341.5107   12  355 79820.0133 101145.187  26.7%  1238  105s
   754   791 98394.7289   16  318 79820.0133 101145.187  26.7%  1128  110s
H  813   822                    79835.143439 101145.187  26.7%  1124  113s
H  819   822                    79873.571060 101145.187  26.6%  1135  113s
H  831   822                    79899.134752 101145.187  26.6%  1143  113s
   847   870 95749.8761   17  320 79899.1348 101145.187  26.6%  1144  116s
H  851   870                    79904.239066 101145.187  26.6%  1145  116s
   903   920 97055.2904   18  338 79904.2391 101145.187  26.6%  1148  120s
  1036  1009 95208.6865   19  325 79904.2391 100923.253  26.3%  1174  127s
  1084  1059 94652.1923   20  342 79904.2391 100923.253  26.3%  1162  131s
  1211  1204 94359.6292   22  293 79904.2391 100774.700  26.1%  1142  137s
  1297  1249 93882.1732   23  294 79904.2391 100774.700  26.1%  1121  140s
H 1303  1249                    79918.970215 100774.700  26.1%  1118  140s
H 1327  1249                    79975.523758 100774.700  26.0%  1124  140s
  1481  1486 93185.2014   26  286 79975.5238 100774.700  26.0%  1069  146s
  1611  1645 90836.1746   28  272 79975.5238 100690.404  25.9%  1039  152s
  1770  1825 86322.7315   29  270 79975.5238 100690.404  25.9%   995  156s
  2133  2221 84048.1878   35  205 79975.5238 100690.404  25.9%   907  161s
  2526  2508 84548.8958   41  178 79975.5238 100604.238  25.8%   817  168s
  2764  2666 83495.3822   44  197 79975.5238 100604.238  25.8%   776  171s
  3138  2904 97680.8728   11  270 79975.5238 100604.238  25.8%   751  177s
  3268  3054 94046.8680   13  220 79975.5238 100604.238  25.8%   750  181s
H 3488  3269                    80011.996106 100604.238  25.7%   733  185s
H 3496  3269                    80055.762627 100372.579  25.4%   733  185s
H 3531  3269                    80056.129822 100372.579  25.4%   730  185s
H 3549  3269                    80073.202576 100372.579  25.4%   729  185s
  3732  3270 99853.5804    8  324 80073.2026 100372.579  25.4%   707  200s
  3734  3271 93362.5716   16   85 80073.2026 100372.579  25.4%   706  208s
  3735  3272 84455.7237   78  294 80073.2026 100372.579  25.4%   706  214s
  3736  3273 89632.8110   49  350 80073.2026 100372.579  25.4%   706  217s
  3737  3273 91923.6595   41  292 80073.2026 100372.579  25.4%   706  220s
  3743  3277 81666.2629   49  373 80073.2026 100372.579  25.4%   705  225s
  3747  3280 95977.5155   19  364 80073.2026 100372.579  25.4%   704  230s
  3753  3284 86767.2719   31  365 80073.2026 100372.579  25.4%   703  235s
  3756  3286 88916.6214   19  321 80073.2026 100372.579  25.4%   702  240s
  3761  3289 92052.6252   19  337 80073.2026 100372.579  25.4%   701  245s
  3766  3293 87844.7744   41  341 80073.2026 100372.579  25.4%   700  250s
  3771  3296 93532.6625   22  336 80073.2026 100372.579  25.4%   700  255s
  3775  3299 93793.8120   22  345 80073.2026 100372.579  25.4%   699  270s
  3776  3299 90577.2497   23  345 80073.2026 100372.579  25.4%   699  277s
  3777  3303 95822.6623   15  310 80073.2026 100372.579  25.4%   717  283s
  3779  3306 95455.2883   16  313 80073.2026 100372.579  25.4%   718  289s
  3783  3313 94688.0299   17  326 80073.2026 100372.579  25.4%   719  292s
  3791  3326 94469.3085   18  323 80073.2026 100372.579  25.4%   722  301s
H 3807  3187                    80099.121974 99897.6389  24.7%   735  308s
  3839  3208 93098.6475   20  342 80099.1220 99556.1731  24.3%   750  312s
  3871  3272 89667.7408   21  313 80099.1220 99555.8730  24.3%   770  317s
  3954  3289 89253.6242   22  366 80099.1220 99555.8730  24.3%   780  321s
  4009  3312 87127.6951   23  270 80099.1220 99555.8730  24.3%   792  326s
  4114  3336 83940.6000   24  258 80099.1220 99555.8730  24.3%   813  335s
  4202  3384 82289.2084   26  219 80099.1220 99555.8730  24.3%   835  343s
  4261  3405     cutoff   27      80099.1220 99555.8730  24.3%   838  346s
  4400  3445 80291.3229   27  246 80099.1220 99555.8730  24.3%   844  354s
  4479  3461 94398.3295   21  293 80099.1220 98338.7765  22.8%   846  357s
  4547  3477 92625.0467   22  314 80099.1220 98338.7765  22.8%   849  361s
  4605  3504 91306.6814   23  284 80099.1220 98338.7765  22.8%   849  365s
  4746  3551 87480.4091   26  331 80099.1220 97614.3948  21.9%   849  371s
  4829  3550 82427.2243   27  283 80099.1220 97614.3948  21.9%   847  376s
  4965  3585 infeasible   29      80099.1220 97028.4528  21.1%   847  385s
  5073  3597 86895.4837   29  318 80099.1220 97028.4528  21.1%   844  390s
  5267  3643 92669.8872   24  347 80099.1220 96697.9869  20.7%   843  398s
  5383  3661 90092.5486   26  307 80099.1220 96697.9869  20.7%   841  404s
  5517  3652 86727.2032   28  277 80099.1220 96697.9869  20.7%   837  407s
  5595  3664 91511.7372   27  246 80099.1220 96697.9869  20.7%   837  412s
  5707  3659 90836.7476   29  135 80099.1220 96016.4969  19.9%   835  418s
  5854  3672 90686.3412   30  129 80099.1220 95668.7036  19.4%   832  422s
  5962  3719 86673.5318   33  149 80099.1220 95668.7036  19.4%   835  427s
  6117  3774 92044.7861   23  227 80099.1220 95569.0790  19.3%   831  430s
  6280  3808 89689.3098   24  203 80099.1220 95569.0790  19.3%   829  435s
  6496  3814 90094.5183   25  182 80099.1220 95569.0790  19.3%   822  440s
  6707  3790 85389.3040   26  318 80099.1220 94688.2078  18.2%   818  445s
  6816  3848 88968.5658   27  315 80099.1220 94688.2078  18.2%   818  450s
  6996  3869 80889.8705   27  215 80099.1220 94688.2078  18.2%   817  457s
  7215  3878 87728.6627   29  266 80099.1220 94688.2078  18.2%   819  462s
  7375  3921     cutoff   30      80099.1220 94462.2457  17.9%   824  468s
  7577  3970     cutoff   34      80099.1220 94462.2457  17.9%   827  478s
  7897  3955 91166.6096   24  334 80099.1220 94462.2457  17.9%   820  484s
  8203  3989 89055.7150   27  356 80099.1220 93599.2886  16.9%   819  491s
  8473  3970 85459.2059   33  192 80099.1220 93599.2886  16.9%   819  497s
  8612  4034 82932.1041   39  108 80099.1220 93599.2886  16.9%   818  503s
  8911  4061 82475.7873   25  245 80099.1220 93493.9762  16.7%   817  511s
  9140  4078     cutoff   29      80099.1220 93252.9094  16.4%   819  517s
  9385  4114 87771.1148   28  173 80099.1220 93252.9094  16.4%   823  524s
  9727  4132 89688.0123   24  409 80099.1220 93232.2783  16.4%   823  531s
 10052  4139 84226.4602   31  287 80099.1220 92826.7039  15.9%   824  540s
 10438  4165 88858.5089   30  216 80099.1220 92612.3595  15.6%   822  550s
 10855  4156 84492.5626   22  225 80099.1220 92612.3595  15.6%   821  558s
 11256  4151 82958.7774   27  209 80099.1220 91986.9599  14.8%   821  566s
 11633  4110 82827.6656   24  199 80099.1220 91986.9599  14.8%   823  574s
 11951  4130     cutoff   28      80099.1220 91840.5765  14.7%   819  583s
 12430  4118 87802.8263   24  226 80099.1220 91541.2171  14.3%   815  591s
 12916  4102 89305.4423   31  168 80099.1220 91245.6952  13.9%   815  600s
 13399  4134 88205.9118   25  194 80099.1220 91245.6952  13.9%   814  610s
 13863  4274 85323.0389   30  162 80099.1220 91239.9073  13.9%   813  619s
 14316  4447 87536.7631   28  248 80099.1220 90875.0334  13.5%   814  629s
 14905  4570 82369.0120   34  171 80099.1220 90637.3315  13.2%   812  639s
 15359  4706 83579.6514   33  119 80099.1220 90633.6938  13.2%   811  650s
 16001  4789 81499.0232   28  274 80099.1220 90633.6938  13.2%   810  661s
 16707  4885 80396.3252   36  162 80099.1220 90268.8371  12.7%   804  672s
 17271  4921 84175.7849   33  253 80099.1220 90268.8371  12.7%   801  684s
 17599  5065     cutoff   35      80099.1220 90150.6030  12.5%   802  698s
 18292  5182 80731.5770   23  204 80099.1220 89932.8723  12.3%   803  710s
 18987  5288 85124.1115   28  316 80099.1220 89759.9906  12.1%   804  722s
 19594  5375     cutoff   31      80099.1220 89687.2456  12.0%   803  736s
 20369  5506 82357.5952   31  212 80099.1220 89577.5736  11.8%   804  748s
 21139  5660 83938.1150   34  212 80099.1220 89386.6204  11.6%   806  767s
 21945  5750     cutoff   36      80099.1220 89242.0349  11.4%   807  785s
 22810  5881 82048.8660   27  273 80099.1220 89078.0370  11.2%   807  801s
 23684  6036 87303.5038   24  282 80099.1220 88903.6672  11.0%   808  818s
 24557  6159     cutoff   28      80099.1220 88753.6339  10.8%   811  834s
 25490  6275     cutoff   33      80099.1220 88572.8797  10.6%   812  851s
 26509  6384 84637.4247   25  309 80099.1220 88383.2379  10.3%   811  869s
 27645  6479 83374.7720   31  303 80099.1220 88195.9171  10.1%   809  887s
 28731  6567 82934.4346   37  173 80099.1220 88022.2137  9.89%   807  905s
 29851  6628     cutoff   39      80099.1220 87936.0698  9.78%   807  930s
 31194  6662     cutoff   35      80099.1220 87663.9717  9.44%   805  947s
 32215  6649 81514.9819   34  205 80099.1220 87530.8790  9.28%   805  966s
 33410  6650 82510.4041   29  124 80099.1220 87325.4480  9.02%   804  985s
 34713  6620 81436.7661   28  238 80099.1220 87045.6835  8.67%   802 1004s
 35927  6625 85424.0436   29  264 80099.1220 86840.4689  8.42%   799 1024s
 37313  6565 80204.0353   26  258 80099.1220 86675.2281  8.21%   797 1046s
 38757  6527 infeasible   28      80099.1220 86412.3540  7.88%   795 1069s
 39481  6455     cutoff   28      80099.1220 86297.9346  7.74%   795 1094s
 41092  6366     cutoff   34      80099.1220 86120.4869  7.52%   793 1119s
 42912  6175 80233.4270   34  154 80099.1220 85853.4526  7.18%   786 1144s
 44593  5956     cutoff   34      80099.1220 85629.5015  6.90%   784 1169s
 46265  5693 80484.9981   34  288 80099.1220 85364.2046  6.57%   784 1196s
 48279  5406     cutoff   35      80099.1220 84966.6728  6.08%   779 1224s
 49939  4975     cutoff   38      80099.1220 84873.0951  5.96%   777 1252s
 52146  4323 83163.4629   31  234 80099.1220 84454.2259  5.44%   772 1281s
 54525  3612     cutoff   35      80099.1220 84001.8997  4.87%   765 1310s
 56882  2635     cutoff   28      80099.1220 83548.7629  4.31%   760 1340s
 59527  1095 80650.9231   32  193 80099.1220 83126.7563  3.78%   752 1368s
 62623  1221     cutoff   35      80099.1220 82330.9060  2.79%   737 1383s
 67799  3792 80300.2538   57   36 80099.1220 80520.4982  0.53%   687 1395s
H68195  3792                    80108.991771 80520.4982  0.51%   683 1395s
H69207  3792                    80130.726435 80503.4378  0.47%   674 1395s
H69705  3792                    80156.441813 80496.5491  0.42%   669 1395s
H69799  3792                    80165.005434 80496.5491  0.41%   668 1395s
*71206  3792              89    80191.774044 80481.2273  0.36%   656 1395s
 80538     0     cutoff   81      80191.7740 80304.4994  0.14%   583 1405s
*80565     0              84    80199.901813 80304.4994  0.13%   583 1405s
H80823     0                    80203.482055 80304.4994  0.13%   581 1405s
H82003     0                    80204.369126 80304.2263  0.12%   573 1405s

Cutting planes:
  Learned: 1
  MIR: 713
  Mixing: 2
  Flow cover: 1727
  RLT: 10
  Relax-and-lift: 119

Explored 84696 nodes (47120240 simplex iterations) in 1406.22 seconds (2907.40 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 80204.4 80204.4 80203.5 ... 80099.1

Optimal solution found (tolerance 1.00e-04)
Best objective 8.020436912606e+04, best bound 8.020436912606e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1406.37s
  Master Objective (UB) = 80204.37, θ = 233034.88
  Upper Bound (UB) = 80204.37

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 233034.88
  [DEBUG]   ✓ Scenario 0: θ = 233034.88 ≤ Q = 233117.02 (slack: 82.14)
  [DEBUG]   ✓ Scenario 1: θ = 233034.88 ≤ Q = 233034.88 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 233034.88 ≤ Q = 233046.67 (slack: 11.80)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x6736a94d
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x98c956b3
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.569691e+13
Presolve removed 2569 rows and 1861 columns
Presolve time: 0.01s
Presolved: 524 rows, 528 columns, 1478 nonzeros
Found heuristic solution: objective 8405595.8823
Variable types: 358 continuous, 170 integer (170 binary)

Root relaxation: objective -1.683575e+05, 274 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -168357.49    0  131 8405595.88 -168357.49   102%     -    0s
H    0     0                    -130363.4205 -168357.49  29.1%     -    0s
H    0     0                    -132631.3086 -168357.49  26.9%     -    0s
H    0     0                    -138900.5977 -168357.49  21.2%     -    0s
H    0     0                    -152820.7073 -168357.49  10.2%     -    0s
H    0     0                    -153147.7741 -154569.51  0.93%     -    0s
     0     0 -154569.51    0   62 -153147.77 -154569.51  0.93%     -    0s
H    0     0                    -153860.0730 -154491.64  0.41%     -    0s
     0     0 -153962.99    0   20 -153860.07 -153962.99  0.07%     -    0s
     0     0 -153958.30    0   19 -153860.07 -153958.30  0.06%     -    0s
     0     0 -153958.23    0   16 -153860.07 -153958.23  0.06%     -    0s
     0     0 -153920.40    0    5 -153860.07 -153920.40  0.04%     -    0s
     0     0 -153920.40    0   10 -153860.07 -153920.40  0.04%     -    0s
     0     0 -153920.40    0    9 -153860.07 -153920.40  0.04%     -    0s
H    0     0                    -153875.5064 -153920.40  0.03%     -    0s
     0     0 -153895.15    0    2 -153875.51 -153895.15  0.01%     -    0s
H    0     0                    -153890.6089 -153894.67  0.00%     -    0s

Cutting planes:
  Gomory: 4
  Implied bound: 1
  MIR: 4
  Flow cover: 3
  Relax-and-lift: 2

Explored 1 nodes (622 simplex iterations) in 0.14 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -153891 -153876 -153860 ... 8.4056e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.538906088754e+05, best bound -1.538946747052e+05, gap 0.0026%
  Subproblem solved in 0.17s
  Worst-case operational profit (Z_SP) = 208315.41
  Scenario: 27 demand increases, 33 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -153890.61
  [DEBUG]   S×d_nominal = 362206.02
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 362206.02 + -153890.61 = 208315.41
  [DEBUG]   Current θ from Master = 233034.88
  [DEBUG]   ⚠️  Z_SP ≤ θ by 24719.47 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 55484.90
  Lower Bound (LB) = 75334.45
  Gap (UB-LB) = 4869.9206, Absolute Gap = 4869.9206, Relative Gap = 0.060719
  Not converged yet (gap = 4869.92 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 27 increases, 33 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178503 nonzeros
Model fingerprint: 0x9d6724ea
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 55484.9 (0.10s)
MIP start from previous solve produced solution with objective 55484.9 (0.11s)
Loaded MIP start from previous solve with objective 55484.9

Presolve removed 26260 rows and 10660 columns
Presolve time: 1.64s
Presolved: 36283 rows, 16560 columns, 224259 nonzeros
Variable types: 14301 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 36283 rows, 16560 columns, 224259 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   38399    6.4540696e+04   0.000000e+00   3.453562e+06      5s
   50420    9.8960898e+04   0.000000e+00   9.112964e+05     10s
   62540    1.1369608e+05   0.000000e+00   2.962155e+05     15s
Concurrent spin time: 2.57s (can be avoided by choosing Method=3)

Solved with primal simplex

Root relaxation: objective 1.190992e+05, 32923 iterations, 17.40 seconds (17.87 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 119099.213    0   84 55484.9037 119099.213   115%     -   19s
H    0     0                    63559.199520 119099.213  87.4%     -   19s
H    0     0                    76153.418596 119099.213  56.4%     -   20s
H    0     0                    76203.374271 119099.213  56.3%     -   20s
H    0     0                    76330.759471 119099.213  56.0%     -   20s
     0     0 113407.733    0  123 76330.7595 113407.733  48.6%     -   28s
H    0     0                    76364.747306 113404.201  48.5%     -   28s
     0     0 112096.826    0  118 76364.7473 112096.826  46.8%     -   31s
H    0     0                    76710.945507 112096.826  46.1%     -   32s
     0     0 108324.342    0  203 76710.9455 108324.342  41.2%     -   32s
     0     0 108324.083    0  154 76710.9455 108324.083  41.2%     -   33s
     0     0 108324.083    0  162 76710.9455 108324.083  41.2%     -   33s
     0     0 108324.083    0  162 76710.9455 108324.083  41.2%     -   33s
     0     0 108321.251    0  280 76710.9455 108321.251  41.2%     -   38s
H    0     0                    76993.493504 108321.251  40.7%     -   38s
H    0     0                    77024.545706 108321.251  40.6%     -   38s
H    0     0                    77080.643015 108321.251  40.5%     -   38s
H    0     0                    77173.157989 108321.251  40.4%     -   38s
H    0     0                    77376.438438 108321.251  40.0%     -   38s
     0     0 108098.610    0  275 77376.4384 108098.610  39.7%     -   41s
     0     0 107874.950    0  241 77376.4384 107874.950  39.4%     -   43s
     0     0 107562.351    0  283 77376.4384 107562.351  39.0%     -   45s
     0     0 107498.386    0  309 77376.4384 107498.386  38.9%     -   46s
     0     0 107491.352    0  309 77376.4384 107491.352  38.9%     -   46s
     0     0 107486.067    0  307 77376.4384 107486.067  38.9%     -   46s
H    0     0                    77431.153254 107476.291  38.8%     -   47s
     0     0 107476.291    0  301 77431.1533 107476.291  38.8%     -   47s
H    0     0                    77441.519771 107476.220  38.8%     -   47s
H    0     0                    77510.324846 107476.220  38.7%     -   47s
H    0     0                    77548.427315 107476.220  38.6%     -   47s
     0     0 107476.220    0  305 77548.4273 107476.220  38.6%     -   47s
     0     0 105258.748    0  273 77548.4273 105258.748  35.7%     -   55s
H    0     0                    77712.852365 104694.253  34.7%     -   59s
     0     0 104694.253    0  264 77712.8524 104694.253  34.7%     -   59s
     0     0 104481.594    0  270 77712.8524 104481.594  34.4%     -   61s
H    0     0                    77731.650800 104300.248  34.2%     -   63s
     0     0 104300.248    0  271 77731.6508 104300.248  34.2%     -   63s
     0     0 104170.574    0  270 77731.6508 104170.574  34.0%     -   64s
     0     0 104136.555    0  269 77731.6508 104136.555  34.0%     -   65s
     0     0 104116.238    0  276 77731.6508 104116.238  33.9%     -   66s
     0     0 104081.679    0  286 77731.6508 104081.679  33.9%     -   67s
     0     0 104067.996    0  279 77731.6508 104067.996  33.9%     -   68s
     0     0 104031.867    0  264 77731.6508 104031.867  33.8%     -   69s
     0     0 103981.957    0  321 77731.6508 103981.957  33.8%     -   70s
     0     0 103966.893    0  288 77731.6508 103966.893  33.8%     -   70s
     0     0 103962.796    0  288 77731.6508 103962.796  33.7%     -   70s
     0     0 103961.134    0  295 77731.6508 103961.134  33.7%     -   70s
     0     0 103960.712    0  293 77731.6508 103960.712  33.7%     -   70s
     0     0 103295.754    0  304 77731.6508 103295.754  32.9%     -   77s
H    0     0                    77854.384251 103078.804  32.4%     -   80s
     0     0 103078.804    0  305 77854.3843 103078.804  32.4%     -   80s
     0     0 102843.749    0  314 77854.3843 102843.749  32.1%     -   81s
     0     0 102729.870    0  314 77854.3843 102729.870  32.0%     -   83s
     0     0 102690.009    0  310 77854.3843 102690.009  31.9%     -   84s
     0     0 102681.584    0  315 77854.3843 102681.584  31.9%     -   84s
     0     0 102672.613    0  320 77854.3843 102672.613  31.9%     -   85s
     0     0 102668.809    0  325 77854.3843 102668.809  31.9%     -   85s
     0     0 102667.634    0  327 77854.3843 102667.634  31.9%     -   85s
     0     0 102592.177    0  327 77854.3843 102592.177  31.8%     -   87s
H    0     0                    78160.014694 102483.456  31.1%     -   89s
H    0     0                    78312.001705 102483.456  30.9%     -   89s
     0     0 102483.456    0  346 78312.0017 102483.456  30.9%     -   89s
     0     0 102448.530    0  356 78312.0017 102448.530  30.8%     -   90s
     0     0 102439.694    0  358 78312.0017 102439.694  30.8%     -   91s
     0     0 102430.872    0  360 78312.0017 102430.872  30.8%     -   91s
     0     0 102428.567    0  358 78312.0017 102428.567  30.8%     -   91s
     0     0 102426.847    0  360 78312.0017 102426.847  30.8%     -   91s
H    0     0                    78361.562457 102287.917  30.5%     -   93s
     0     0 102287.917    0  319 78361.5625 102287.917  30.5%     -   93s
H    0     0                    78483.351353 102284.968  30.3%     -   94s
     0     0 102250.557    0  371 78483.3514 102250.557  30.3%     -   96s
     0     0 102237.437    0  371 78483.3514 102237.437  30.3%     -   96s
     0     0 102234.900    0  333 78483.3514 102234.900  30.3%     -   96s
     0     0 102234.376    0  330 78483.3514 102234.376  30.3%     -   96s
     0     0 102212.015    0  368 78483.3514 102212.015  30.2%     -   97s
     0     0 102210.808    0  375 78483.3514 102210.808  30.2%     -   98s
     0     0 102208.241    0  373 78483.3514 102208.241  30.2%     -   98s
H    0     0                    78601.388940 102207.695  30.0%     -   99s
H    0     0                    78606.481001 102207.695  30.0%     -   99s
H    0     0                    78641.809205 102207.695  30.0%     -   99s
H    0     0                    78655.390408 102207.695  29.9%     -   99s
     0     0 102205.797    0  409 78655.3904 102205.797  29.9%     -   99s
     0     0 102205.602    0  337 78655.3904 102205.602  29.9%     -   99s
     0     0 102186.916    0  333 78655.3904 102186.916  29.9%     -  100s
     0     0 102181.645    0  330 78655.3904 102181.645  29.9%     -  101s
     0     0 102180.236    0  341 78655.3904 102180.236  29.9%     -  101s
     0     0 102173.690    0  342 78655.3904 102173.690  29.9%     -  102s
     0     0 102172.288    0  341 78655.3904 102172.288  29.9%     -  104s
     0     0 102166.040    0  385 78655.3904 102166.040  29.9%     -  104s
     0     0 102165.349    0  384 78655.3904 102165.349  29.9%     -  105s
     0     0 102162.883    0  342 78655.3904 102162.883  29.9%     -  105s
     0     0 102162.762    0  342 78655.3904 102162.762  29.9%     -  106s
H    0     2                    78879.622564 102162.671  29.5%     -  126s
     0     2 102162.671    0  342 78879.6226 102162.671  29.5%     -  126s
     1     4 101714.028    1  367 78879.6226 102162.671  29.5%  5417  131s
     7    16 101230.693    3  402 78879.6226 101518.830  28.7%  2970  139s
    15    32 101133.216    4  451 78879.6226 101225.962  28.3%  3735  146s
    31    60 100305.018    5  346 78879.6226 101131.984  28.2%  5406  159s
    59    92 99745.4885    6  299 78879.6226 101130.721  28.2%  5856  166s
H   81    92                    78909.912309 101130.721  28.2%  4875  166s
    91   239 99642.1406    7  286 78909.9123 101130.721  28.2%  4613  175s
   238   313 99078.7493   11  365 78909.9123 101130.721  28.2%  2606  180s
   379   455 99048.6877   12  363 78909.9123 101130.721  28.2%  2240  189s
   454   533 98998.0472   12  333 78909.9123 101130.721  28.2%  2079  193s
   534   592 99058.9902   12  333 78909.9123 101130.721  28.2%  1955  198s
   595   670 98595.2337   13  330 78909.9123 101130.721  28.2%  1928  203s
   677   738 98752.3306   13  345 78909.9123 100780.404  27.7%  1820  209s
   749   814 96837.3425   13  326 78909.9123 100780.404  27.7%  1760  216s
   827   846 96552.3099   13  321 78909.9123 100780.404  27.7%  1706  221s
H  856   846                    78917.419121 100780.404  27.7%  1703  221s
   861   922 97242.5525   13  330 78917.4191 100780.404  27.7%  1701  227s
   956   953 98333.8735   14  353 78917.4191 100780.404  27.7%  1625  233s
   989   986 98339.8061   14  369 78917.4191 100780.404  27.7%  1618  239s
  1040  1051 97192.3127   15  340 78917.4191 100629.842  27.5%  1604  244s
  1117  1148 93826.2594   15  360 78917.4191 100629.842  27.5%  1557  250s
  1224  1263 93801.7467   14  371 78917.4191 100629.842  27.5%  1496  255s
  1351  1360 95128.8962   14  352 78917.4191 100183.570  26.9%  1415  261s
  1474  1470 94715.9065   14  279 78917.4191 100183.570  26.9%  1364  267s
  1602  1583 95505.6672   16  309 78917.4191 100183.570  26.9%  1321  271s
  1745  1690 94699.6794   16  317 78917.4191 100183.570  26.9%  1276  278s
  1879  1796 92811.6161   17  321 78917.4191 100183.570  26.9%  1254  284s
  2014  1910 95055.0620   17  312 78917.4191 100183.570  26.9%  1232  292s
  2138  1947 94968.6011   18  306 78917.4191 99567.9869  26.2%  1221  297s
  2177  2030 94711.0405   19  296 78917.4191 99567.9869  26.2%  1219  302s
  2272  2061 94499.1559   20  301 78917.4191 99567.9869  26.2%  1198  307s
  2305  2092 93634.3832   20  267 78917.4191 99567.9869  26.2%  1198  311s
  2338  2122 93807.4448   21  210 78917.4191 99567.9869  26.2%  1192  317s
H 2347  2122                    79136.622543 99567.9869  25.8%  1190  317s
  2374  2345 92998.7288   22  190 79136.6225 99567.9869  25.8%  1187  323s
  2631  2645 85241.5941   24  171 79136.6225 99567.9869  25.8%  1122  329s
  2981  2887 91930.7188   30  195 79136.6225 99567.9869  25.8%  1040  336s
  3309  3094 90871.8644   33  201 79136.6225 99567.9869  25.8%   986  343s
H 3609  3094                    79155.407833 99567.9869  25.8%   952  347s
  3610  3095 95369.1525   10  342 79155.4078 99567.9869  25.8%   951  372s
  3612  3096 97816.6800    8   80 79155.4078 99567.9869  25.8%   951  388s
  3613  3097 97434.7965   12  325 79155.4078 99567.9869  25.8%   951  399s
  3614  3098 82887.5632   90  297 79155.4078 99567.9869  25.8%   950  405s
  3616  3099 92850.6015   27  350 79155.4078 99567.9869  25.8%   950  413s
  3617  3100 93797.7275   22  351 79155.4078 99567.9869  25.8%   950  416s
  3619  3101 94688.3172   11  326 79155.4078 99567.9869  25.8%   949  421s
  3623  3104 82110.2438   49  372 79155.4078 99567.9869  25.8%   948  425s
  3626  3106 89581.1623   31  338 79155.4078 99567.9869  25.8%   947  431s
H 3627  2950                    79254.997558 99567.9869  25.6%   947  434s
  3629  2952 92698.3664   23  342 79254.9976 99567.9869  25.6%   946  437s
  3632  2954 93614.5603   29  333 79254.9976 99567.9869  25.6%   946  440s
  3635  2956 89489.1028   49  328 79254.9976 99567.9869  25.6%   945  445s
  3637  2957 92546.5662   14  359 79254.9976 99567.9869  25.6%   944  450s
H 3639  2809                    79509.504072 99567.9869  25.2%   944  455s
  3643  2812 98664.4883   10  341 79509.5041 99567.9869  25.2%   943  460s
  3644  2813 79647.8826   70  341 79509.5041 99567.9869  25.2%   942  476s
  3645  2813 86406.3889   43  341 79509.5041 99567.9869  25.2%   942  487s
  3646  2817 99567.9869   15  331 79509.5041 99567.9869  25.2%   965  497s
  3648  2820 99567.9869   16  329 79509.5041 99567.9869  25.2%   965  506s
  3652  2827 99567.9869   17  380 79509.5041 99567.9869  25.2%   968  514s
  3660  2840 99567.9869   18  372 79509.5041 99567.9869  25.2%   976  529s
  3676  2851 99150.7480   19  309 79509.5041 99567.9869  25.2%   995  547s
  3692  2878 97258.7404   20  340 79509.5041 99567.9869  25.2%  1033  556s
H 3706  2732                    79550.330209 99567.9869  25.2%  1040  556s
  3724  2832 96317.0184   21  333 79550.3302 99567.9869  25.2%  1046  566s
  3830  2867 95778.8804   23  316 79550.3302 99567.9869  25.2%  1096  574s
  3906  2898 94389.6655   22  280 79550.3302 99567.9869  25.2%  1112  581s
  3985  2899 95470.5543   24  314 79550.3302 99567.9869  25.2%  1120  586s
  4022  2919 91341.1022   24  314 79550.3302 99567.9869  25.2%  1125  592s
  4060  2932 94539.3360   24  327 79550.3302 99567.9869  25.2%  1133  597s
  4103  2940 90035.1441   24  331 79550.3302 99567.9869  25.2%  1137  603s
  4145  2949 93736.8830   23  273 79550.3302 99567.9869  25.2%  1141  611s
  4187  2963 94611.5396   25  267 79550.3302 99567.9869  25.2%  1146  621s
  4229  2990 93611.5219   26  319 79550.3302 99567.9869  25.2%  1150  631s
  4278  3024 93075.9604   27  239 79550.3302 99567.9869  25.2%  1149  639s
  4344  3046 92335.8627   28  314 79550.3302 99567.9869  25.2%  1147  646s
  4417  3074 91010.6862   28  221 79550.3302 99567.9869  25.2%  1146  657s
  4491  3091 90302.0835   29  209 79550.3302 99567.9869  25.2%  1146  663s
  4574  3109 90187.6421   30  195 79550.3302 99567.9869  25.2%  1140  672s
  4664  3136 89310.6336   31  191 79550.3302 99567.9869  25.2%  1137  682s
  4757  3158 89291.1257   32  132 79550.3302 99402.5739  25.0%  1142  690s
  4837  3196 89197.3468   33  147 79550.3302 99401.8271  25.0%  1148  700s
  4931  3229 88873.8402   36  111 79550.3302 99401.8271  25.0%  1150  709s
  5034  3251 88411.3642   35  182 79550.3302 99401.8271  25.0%  1151  717s
  5151  3291 88274.5608   37  189 79550.3302 99401.8271  25.0%  1148  725s
  5289  3287 87325.0760   42  137 79550.3302 99401.8271  25.0%  1141  734s
  5411  3303 81552.3506   42   82 79550.3302 98931.9264  24.4%  1139  744s
  5535  3341 86183.1221   50   94 79550.3302 98927.8794  24.4%  1142  751s
  5666  3383 84619.5689   55   68 79550.3302 97628.4534  22.7%  1142  761s
  5812  3427 80781.0452   59  140 79550.3302 97628.4534  22.7%  1140  770s
  5983  3434 88181.8277   35  138 79550.3302 97554.7645  22.6%  1137  780s
  6131  3455 85958.1091   38  105 79550.3302 97554.7645  22.6%  1134  788s
  6292  3450 80143.9439   42   89 79550.3302 97554.7645  22.6%  1135  799s
  6457  3467 92400.3102   27  300 79550.3302 96143.3374  20.9%  1141  811s
  6579  3524 91318.8560   29  284 79550.3302 96143.3374  20.9%  1155  825s
  6731  3556 85746.1813   31  265 79550.3302 96143.3374  20.9%  1165  834s
  6886  3573 82496.4051   35  140 79550.3302 96143.3374  20.9%  1175  847s
  7044  3600 80097.8276   38  165 79550.3302 96052.7317  20.7%  1177  856s
  7214  3637 93107.0511   25  265 79550.3302 95715.6781  20.3%  1179  867s
  7448  3692 91164.4675   29  216 79550.3302 95715.6781  20.3%  1178  881s
  7668  3740 85569.3239   39  111 79550.3302 95622.3151  20.2%  1184  896s
  7923  3783 93285.3828   26  306 79550.3302 95622.3151  20.2%  1187  906s
  8151  3853 88691.2417   34  149 79550.3302 95622.3151  20.2%  1194  918s
  8396  3858 80398.0565   42   84 79550.3302 95540.2563  20.1%  1197  930s
  8621  3915 84911.2775   27  240 79550.3302 95540.2563  20.1%  1205  945s
  8892  3907 80641.8817   33  167 79550.3302 95540.2563  20.1%  1213  958s
  9084  3940 85985.3383   27  281 79550.3302 95354.6913  19.9%  1219  976s
  9392  3969 79921.1528   33  230 79550.3302 95354.6913  19.9%  1223  992s
  9689  4036 87499.1559   32  152 79550.3302 94291.5346  18.5%  1231 1008s
 10021  4053 90785.5740   23  261 79550.3302 94291.5346  18.5%  1234 1023s
 10333  4123 87442.0948   29  134 79550.3302 94291.5346  18.5%  1236 1037s
 10670  4187 91005.4486   30  365 79550.3302 93905.6023  18.0%  1242 1054s
 11051  4203 86118.8470   36  211 79550.3302 93845.7599  18.0%  1247 1071s
 11460  4228 83914.3773   39  109 79550.3302 93845.7599  18.0%  1249 1088s
 11887  4324 85564.7019   26  178 79550.3302 93586.9248  17.6%  1253 1106s
 12310  4474 87685.8190   28  149 79550.3302 93586.9248  17.6%  1258 1123s
 12600  4614 83068.1338   24  240 79550.3302 92672.7413  16.5%  1269 1142s
 13055  4739     cutoff   30      79550.3302 92544.3536  16.3%  1275 1160s
 13508  4852 89180.0935   26  228 79550.3302 92466.5887  16.2%  1277 1183s
 13896  5051 80142.0247   33  183 79550.3302 92225.1954  15.9%  1280 1203s
H14136  5047                    79615.100666 92170.1171  15.8%  1283 1203s
 14367  5217 86884.1718   26  193 79615.1007 92170.1171  15.8%  1280 1223s
H14388  5217                    79621.868655 92170.1171  15.8%  1280 1223s
 14954  5327 infeasible   31      79621.8687 92168.2084  15.8%  1280 1245s
 15468  5487 87059.0523   30  240 79621.8687 92168.2084  15.8%  1278 1273s
 16026  5655 81245.1617   35  186 79621.8687 91838.3323  15.3%  1283 1297s
 16532  5782     cutoff   33      79621.8687 91647.8095  15.1%  1290 1325s
 17137  5924 84595.4228   29  280 79621.8687 91548.2138  15.0%  1294 1350s
 17813  6128 84736.8915   33  142 79621.8687 91548.2138  15.0%  1294 1380s
 18485  6306     cutoff   38      79621.8687 91104.2066  14.4%  1297 1409s
 19180  6467 84467.6960   26  331 79621.8687 90964.2337  14.2%  1298 1435s
 19777  6662     cutoff   31      79621.8687 90959.1476  14.2%  1299 1463s
H20367  6658                    79636.434514 90896.2745  14.1%  1300 1463s
 20466  6862 88818.1438   26  299 79636.4345 90822.8432  14.0%  1301 1497s
 21305  7081 81639.1284   35  102 79636.4345 90650.4346  13.8%  1302 1529s
 22182  7287 83169.0933   31  236 79636.4345 90462.1337  13.6%  1301 1559s
 23023  7455     cutoff   28      79636.4345 90324.8235  13.4%  1305 1592s
 23964  7693 84840.2719   35  216 79636.4345 90157.4192  13.2%  1302 1625s
 24875  7795 79918.8397   34  163 79636.4345 90060.7996  13.1%  1305 1658s
 25368  7971 82717.7129   25  363 79636.4345 90052.7792  13.1%  1305 1693s
 26387  8182 80314.9918   30  235 79636.4345 89985.9571  13.0%  1306 1728s
 27470  8354 83973.0331   26  383 79636.4345 89805.7043  12.8%  1306 1767s
 28567  8486 81888.8444   30  228 79636.4345 89677.9101  12.6%  1306 1806s
 29710  8686     cutoff   33      79636.4345 89531.8626  12.4%  1307 1850s
 30857  8864 86952.0318   31  216 79636.4345 89380.0545  12.2%  1311 1892s
 32058  8972 82065.3365   31  221 79636.4345 89206.5928  12.0%  1312 1936s
 33314  9157 86848.8164   24  236 79636.4345 88985.9103  11.7%  1313 1979s
 34562  9293 84958.8281   28  195 79636.4345 88823.0414  11.5%  1314 2025s
 35894  9299     cutoff   33      79636.4345 88702.2590  11.4%  1312 2073s
 35954  9359 82983.6603   27  239 79636.4345 88702.2590  11.4%  1313 2119s
 36686  9561 80088.6106   30  195 79636.4345 88702.2590  11.4%  1311 2170s
 38250  9819 81880.0996   28  321 79636.4345 88470.3888  11.1%  1310 2222s
 39834  9946 infeasible   38      79636.4345 88293.8248  10.9%  1309 2276s
 41304 10042 83091.8337   29  294 79636.4345 88158.4267  10.7%  1314 2332s
 42998 10154 80300.7026   29  226 79636.4345 87928.7465  10.4%  1313 2390s
 44651 10272 84007.5866   26  299 79636.4345 87705.0784  10.1%  1315 2453s
 46390 10366 82441.7815   30  302 79636.4345 87520.4357  9.90%  1317 2516s
 48239 10400 80288.0340   30  147 79636.4345 87356.8664  9.69%  1317 2580s
 49936 10428 81626.9733   25  271 79636.4345 87232.2604  9.54%  1319 2659s
 51979 10430 79807.8641   32  349 79636.4345 86986.5581  9.23%  1318 2726s
 54069 10350 81932.1928   30  274 79636.4345 86821.6506  9.02%  1317 2797s
 56277 10292 80722.8770   28  291 79636.4345 86676.3876  8.84%  1316 2870s
 58485 10201 83097.3004   25  328 79636.4345 86371.8022  8.46%  1314 2945s
 60853 10083 80631.1070   36  191 79636.4345 86186.5747  8.23%  1312 3025s
 63284  9924 82306.1451   32  199 79636.4345 85954.1917  7.93%  1311 3106s
 65764  9714     cutoff   28      79636.4345 85752.3472  7.68%  1309 3189s
 68103  9450 81413.9982   34  165 79636.4345 85579.0562  7.46%  1308 3282s
 70622  9138 80278.4255   27  139 79636.4345 85335.9218  7.16%  1311 3376s
 73409  8784     cutoff   33      79636.4345 85045.3031  6.79%  1310 3489s
 76050  8273     cutoff   31      79636.4345 84896.2497  6.60%  1310 3592s
 79147  8214     cutoff   38      79636.4345 84582.0540  6.21%  1309 3600s

Cutting planes:
  MIR: 1044
  Mixing: 3
  Flow cover: 2345
  RLT: 21
  Relax-and-lift: 126

Explored 79390 nodes (103936522 simplex iterations) in 3600.05 seconds (7591.99 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 79636.4 79621.9 79615.1 ... 78909.9

Time limit reached
Best objective 7.963643451358e+04, best bound 8.454915801831e+04, gap 6.1689%
  WARNING: Time limit reached. Using best solution found (gap: 6.17%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = 79636.43, θ = 230279.63
  Upper Bound (UB) = 79636.43

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 230279.63
  [DEBUG]   ✓ Scenario 0: θ = 230279.63 ≤ Q = 230279.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 230279.63 ≤ Q = 230279.63 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 230279.63 ≤ Q = 230279.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 230279.63 ≤ Q = 230279.63 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x7ec6aa21
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x813955df
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.580081e+13
Presolve removed 2568 rows and 1860 columns
Presolve time: 0.01s
Presolved: 525 rows, 529 columns, 1481 nonzeros
Found heuristic solution: objective 8309209.0767
Variable types: 359 continuous, 170 integer (170 binary)

Root relaxation: objective -1.682922e+05, 255 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -168292.23    0  129 8309209.08 -168292.23   102%     -    0s
H    0     0                    -132262.0333 -168292.23  27.2%     -    0s
H    0     0                    -134310.4488 -168292.23  25.3%     -    0s
H    0     0                    -135628.1009 -168292.23  24.1%     -    0s
H    0     0                    -142647.2428 -168292.23  18.0%     -    0s
     0     0 -150808.76    0   90 -142647.24 -150808.76  5.72%     -    0s
H    0     0                    -145287.8879 -150804.63  3.80%     -    0s
     0     0 -150426.58    0   92 -145287.89 -150426.58  3.54%     -    0s
     0     0 -150423.59    0   92 -145287.89 -150423.59  3.53%     -    0s
H    0     0                    -148250.3803 -150423.24  1.47%     -    0s
     0     0 -150423.24    0   92 -148250.38 -150423.24  1.47%     -    0s
     0     0 -149880.22    0   61 -148250.38 -149880.22  1.10%     -    0s
H    0     0                    -148483.1727 -149878.83  0.94%     -    0s
H    0     0                    -148831.5354 -149838.19  0.68%     -    0s
     0     0 -149838.19    0   41 -148831.54 -149838.19  0.68%     -    0s
     0     0 -149832.13    0   51 -148831.54 -149832.13  0.67%     -    0s
H    0     0                    -149125.9735 -149832.13  0.47%     -    0s
     0     0 -149816.46    0   13 -149125.97 -149816.46  0.46%     -    0s
H    0     0                    -149422.5237 -149815.38  0.26%     -    0s
H    0     0                    -149786.9879 -149815.38  0.02%     -    0s
     0     0 -149804.35    0   31 -149786.99 -149804.35  0.01%     -    0s
     0     0 -149804.31    0    5 -149786.99 -149804.31  0.01%     -    0s

Cutting planes:
  Gomory: 32
  MIR: 92
  Flow cover: 11
  RLT: 76
  Relax-and-lift: 7
  BQP: 1

Explored 1 nodes (630 simplex iterations) in 0.06 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -149787 -149423 -149126 ... -132262

Optimal solution found (tolerance 1.00e-04)
Best objective -1.497869879305e+05, best bound -1.497989627973e+05, gap 0.0080%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 212923.66
  Scenario: 25 demand increases, 35 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -149786.99
  [DEBUG]   S×d_nominal = 362710.65
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 362710.65 + -149786.99 = 212923.66
  [DEBUG]   Current θ from Master = 230279.63
  [DEBUG]   ⚠️  Z_SP ≤ θ by 17355.97 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 62280.46
  Lower Bound (LB) = 75334.45
  Gap (UB-LB) = 4301.9860, Absolute Gap = 4301.9860, Relative Gap = 0.054020
  Not converged yet (gap = 4301.99 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 25 increases, 35 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221749 nonzeros
Model fingerprint: 0x8b13eeef
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 32825 rows and 13325 columns
Presolve time: 1.90s
Presolved: 45008 rows, 20135 columns, 278944 nonzeros
Variable types: 17876 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -281170.8884
Found heuristic solution: objective -170322.5182

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 45008 rows, 20135 columns, 278944 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   24248    3.9271271e+03   0.000000e+00   1.005732e+10      5s
   38122    9.6434029e+04   0.000000e+00   9.527387e+06     10s
   48121    1.0607488e+05   0.000000e+00   2.953366e+06     15s
   58004    1.1244353e+05   0.000000e+00   4.888034e+06     20s
   66561    1.1476566e+05   0.000000e+00   4.797307e+05     25s
Concurrent spin time: 8.60s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 1.189653e+05, 45264 iterations, 31.77 seconds (32.04 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 118965.278    0   90 -170322.52 118965.278   170%     -   34s
H    0     0                    -151773.6978 118965.278   178%     -   34s
H    0     0                    -145435.4754 118965.278   182%     -   34s
H    0     0                    -144944.2355 118965.278   182%     -   34s
H    0     0                    -144381.8233 118965.278   182%     -   34s
H    0     0                    1382.2601631 118965.278  8507%     -   34s
H    0     0                    61926.361707 118965.278  92.1%     -   35s
H    0     0                    63254.282427 118965.278  88.1%     -   35s
H    0     0                    71947.364992 118965.278  65.4%     -   35s
H    0     0                    73487.166000 118965.278  61.9%     -   35s
H    0     0                    73531.731074 118965.278  61.8%     -   35s
H    0     0                    74933.652851 118965.278  58.8%     -   35s
H    0     0                    75305.590401 118965.278  58.0%     -   35s
H    0     0                    75323.462937 118965.278  57.9%     -   35s
H    0     0                    75450.198163 118965.278  57.7%     -   35s
H    0     0                    75495.301304 118965.278  57.6%     -   35s
H    0     0                    76195.539985 113021.173  48.3%     -   45s
H    0     0                    76264.535960 113021.173  48.2%     -   45s
H    0     0                    76547.033096 113021.173  47.6%     -   45s
     0     0 113021.173    0  222 76547.0331 113021.173  47.6%     -   45s
     0     0 111225.380    0  210 76547.0331 111225.380  45.3%     -   49s
     0     0 111225.380    0  217 76547.0331 111225.380  45.3%     -   50s
     0     0 111225.380    0  214 76547.0331 111225.380  45.3%     -   50s
     0     0 111225.380    0  212 76547.0331 111225.380  45.3%     -   51s
     0     0 107211.622    0  241 76547.0331 107211.622  40.1%     -   60s
     0     0 106421.044    0  279 76547.0331 106421.044  39.0%     -   65s
     0     0 106162.259    0  268 76547.0331 106162.259  38.7%     -   68s
     0     0 106045.339    0  279 76547.0331 106045.339  38.5%     -   70s
     0     0 106026.323    0  285 76547.0331 106026.323  38.5%     -   71s
     0     0 105963.608    0  285 76547.0331 105963.608  38.4%     -   72s
     0     0 105963.259    0  285 76547.0331 105963.259  38.4%     -   72s
     0     0 104277.706    0  282 76547.0331 104277.706  36.2%     -   85s
H    0     0                    76595.852348 103780.951  35.5%     -   91s
     0     0 103780.951    0  308 76595.8523 103780.951  35.5%     -   91s
     0     0 103671.019    0  296 76595.8523 103671.019  35.3%     -   94s
     0     0 103627.880    0  305 76595.8523 103627.880  35.3%     -   95s
     0     0 103591.709    0  313 76595.8523 103591.709  35.2%     -   97s
     0     0 103577.298    0  314 76595.8523 103577.298  35.2%     -   98s
     0     0 103561.061    0  315 76595.8523 103561.061  35.2%     -   99s
     0     0 103558.482    0  317 76595.8523 103558.482  35.2%     -  100s
     0     0 103557.066    0  319 76595.8523 103557.066  35.2%     -  100s
     0     0 103113.081    0  358 76595.8523 103113.081  34.6%     -  108s
     0     0 102889.374    0  311 76595.8523 102889.374  34.3%     -  112s
     0     0 102796.396    0  353 76595.8523 102796.396  34.2%     -  114s
     0     0 102761.475    0  345 76595.8523 102761.475  34.2%     -  116s
     0     0 102747.213    0  345 76595.8523 102747.213  34.1%     -  117s
     0     0 102731.670    0  350 76595.8523 102731.670  34.1%     -  117s
     0     0 102711.368    0  352 76595.8523 102711.368  34.1%     -  118s
     0     0 102691.776    0  353 76595.8523 102691.776  34.1%     -  119s
     0     0 102687.250    0  354 76595.8523 102687.250  34.1%     -  120s
     0     0 102684.476    0  314 76595.8523 102684.476  34.1%     -  121s
     0     0 102684.358    0  354 76595.8523 102684.358  34.1%     -  121s
     0     0 102593.084    0  310 76595.8523 102593.084  33.9%     -  124s
     0     0 102554.718    0  326 76595.8523 102554.718  33.9%     -  127s
     0     0 102537.174    0  327 76595.8523 102537.174  33.9%     -  128s
     0     0 102532.603    0  327 76595.8523 102532.603  33.9%     -  129s
     0     0 102529.884    0  328 76595.8523 102529.884  33.9%     -  129s
     0     0 102529.078    0  333 76595.8523 102529.078  33.9%     -  130s
     0     0 102457.894    0  330 76595.8523 102457.894  33.8%     -  133s
     0     0 102408.453    0  338 76595.8523 102408.453  33.7%     -  139s
     0     0 102382.988    0  340 76595.8523 102382.988  33.7%     -  140s
     0     0 102366.897    0  337 76595.8523 102366.897  33.6%     -  142s
     0     0 102363.053    0  342 76595.8523 102363.053  33.6%     -  143s
     0     0 102361.726    0  344 76595.8523 102361.726  33.6%     -  143s
     0     0 102300.949    0  346 76595.8523 102300.949  33.6%     -  146s
     0     0 102277.278    0  335 76595.8523 102277.278  33.5%     -  148s
     0     0 102269.974    0  344 76595.8523 102269.974  33.5%     -  148s
     0     0 102263.146    0  345 76595.8523 102263.146  33.5%     -  149s
     0     0 102257.172    0  346 76595.8523 102257.172  33.5%     -  149s
     0     0 102249.169    0  346 76595.8523 102249.169  33.5%     -  150s
     0     0 102247.781    0  345 76595.8523 102247.781  33.5%     -  150s
     0     0 102187.619    0  324 76595.8523 102187.619  33.4%     -  151s
     0     0 102170.468    0  323 76595.8523 102170.468  33.4%     -  158s
     0     0 102167.256    0  333 76595.8523 102167.256  33.4%     -  158s
     0     0 102165.142    0  332 76595.8523 102165.142  33.4%     -  159s
     0     0 102164.483    0  333 76595.8523 102164.483  33.4%     -  159s
     0     0 102145.924    0  337 76595.8523 102145.924  33.4%     -  160s
     0     0 102144.420    0  337 76595.8523 102144.420  33.4%     -  161s
     0     0 102140.786    0  339 76595.8523 102140.786  33.4%     -  162s
     0     0 102136.774    0  339 76595.8523 102136.774  33.3%     -  163s
     0     0 102125.387    0  331 76595.8523 102125.387  33.3%     -  163s
     0     0 102120.800    0  333 76595.8523 102120.800  33.3%     -  164s
     0     0 102115.762    0  337 76595.8523 102115.762  33.3%     -  164s
     0     0 102113.475    0  329 76595.8523 102113.475  33.3%     -  165s
     0     0 102112.040    0  331 76595.8523 102112.040  33.3%     -  165s
     0     0 102107.675    0  327 76595.8523 102107.675  33.3%     -  166s
     0     0 102097.342    0  329 76595.8523 102097.342  33.3%     -  167s
     0     0 102093.490    0  330 76595.8523 102093.490  33.3%     -  167s
     0     0 102092.233    0  329 76595.8523 102092.233  33.3%     -  168s
     0     0 102086.884    0  335 76595.8523 102086.884  33.3%     -  169s
     0     0 102082.420    0  336 76595.8523 102082.420  33.3%     -  169s
     0     0 102080.252    0  337 76595.8523 102080.252  33.3%     -  170s
     0     0 102080.058    0  337 76595.8523 102080.058  33.3%     -  170s
     0     0 102078.198    0  337 76595.8523 102078.198  33.3%     -  171s
     0     0 102077.815    0  334 76595.8523 102077.815  33.3%     -  172s
     0     0 102076.110    0  334 76595.8523 102076.110  33.3%     -  172s
     0     0 102075.657    0  334 76595.8523 102075.657  33.3%     -  173s
     0     0 102075.618    0  332 76595.8523 102075.618  33.3%     -  174s
     0     0 102075.539    0  332 76595.8523 102075.539  33.3%     -  175s
H    0     0                    76667.956103 102075.263  33.1%     -  194s
H    0     2                    76678.061496 102075.263  33.1%     -  195s
     0     2 102075.263    0  332 76678.0615 102075.263  33.1%     -  195s
     1     4 101893.784    1  328 76678.0615 102073.447  33.1%  5237  201s
     3     8 101801.947    2  320 76678.0615 101893.779  32.9%  4516  206s
     7    16 101619.428    3  321 76678.0615 101801.545  32.8%  4410  214s
    15    32 101238.506    4  328 76678.0615 101618.765  32.5%  5649  223s
    31    54 99519.0325    5  305 76678.0615 101237.945  32.0%  8054  238s
H   53    86                    76881.251133 101237.945  31.7%  7076  250s
H   66    86                    76886.041460 101237.945  31.7%  6845  250s
H   76    86                    76896.619621 101237.945  31.7%  6499  250s
    85   197 97181.7287    7  322 76896.6196 101237.945  31.7%  6284  277s
   196   310 97041.0981    9  321 76896.6196 101237.945  31.7%  3982  286s
H  201   310                    76935.561523 101237.945  31.6%  3953  286s
H  223   310                    77086.620906 101237.945  31.3%  3734  286s
   309   402 96845.7451   10  313 77086.6209 101237.945  31.3%  3254  295s
   401   476 96985.4379   10  310 77086.6209 101237.945  31.3%  3053  302s
   475   555 96621.7681   11  304 77086.6209 101237.945  31.3%  2895  312s
   554   635 96797.2023   11  309 77086.6209 101237.945  31.3%  2756  321s
H  569   635                    77088.999311 101237.945  31.3%  2747  321s
   634   703 95838.2513   11  293 77088.9993 101237.945  31.3%  2665  331s
   714   742 94979.2080   11  285 77088.9993 101237.945  31.3%  2574  340s
   759   798 95695.0097   11  255 77088.9993 101237.945  31.3%  2553  352s
H  797   798                    77120.541216 101237.945  31.3%  2523  352s
   823   826 95688.8552   11  257 77120.5412 101237.945  31.3%  2481  359s
H  828   826                    77218.044193 101237.945  31.1%  2474  359s
H  852   826                    77421.046952 101237.945  30.8%  2467  359s
   859   901 95861.8412   11  254 77421.0470 101237.945  30.8%  2456  367s
   956   935 94557.4176   12  261 77421.0470 101237.945  30.8%  2367  372s
H  985   935                    77699.723649 101237.945  30.3%  2358  372s
H  988   935                    77933.246823 101237.945  29.9%  2356  372s
  1000   970 95384.6371   12  254 77933.2468 101237.945  29.9%  2350  383s
H 1007   970                    78168.528608 101237.945  29.5%  2355  383s
H 1034   970                    78263.640167 101237.945  29.4%  2340  383s
  1061   993 94738.7295   12  271 78263.6402 101237.945  29.4%  2314  389s
  1100  1045 94704.3494   12  244 78263.6402 101237.945  29.4%  2332  397s
  1166  1100 95335.4686   13  250 78263.6402 101237.945  29.4%  2296  409s
H 1171  1100                    78312.963720 101237.945  29.3%  2290  409s
  1233  1181 93848.4052   13  239 78312.9637 101237.945  29.3%  2254  421s
  1344  1272 94057.5411   15  282 78312.9637 101237.945  29.3%  2207  430s
  1464  1371 94294.5555   14  251 78312.9637 101237.945  29.3%  2147  439s
  1579  1498 91753.4714   15  268 78312.9637 101237.945  29.3%  2122  449s
  1725  1529 93646.2829   15  275 78312.9637 101237.945  29.3%  2055  455s
  1758  1562 91326.2413   15  261 78312.9637 101237.945  29.3%  2061  462s
H 1775  1562                    78519.967514 101237.945  28.9%  2060  462s
  1795  1730 91135.3731   16  282 78519.9675 101237.945  28.9%  2056  474s
  1991  1897 91659.7393   16  220 78519.9675 101237.945  28.9%  1945  486s
  2224  2018 91563.5323   17  225 78519.9675 101237.945  28.9%  1827  498s
  2427  2150 92595.5123   18  277 78519.9675 100918.682  28.5%  1753  508s
  2616  2264 87368.1215   19  272 78519.9675 100911.814  28.5%  1724  520s
  2770  2293 91831.8142   19  270 78519.9675 100911.814  28.5%  1726  528s
  2805  2317 88870.7936   19  260 78519.9675 100911.814  28.5%  1735  537s
  2843  2344 87489.4235   19  265 78519.9675 100911.814  28.5%  1752  545s
  2878  2383 90304.8860   20  248 78519.9675 100911.814  28.5%  1767  554s
  2925  2456 89679.6623   21  241 78519.9675 100911.814  28.5%  1770  561s
  3006  2485 88566.1318   22  223 78519.9675 100911.814  28.5%  1753  569s
  3041  2539 87864.4529   23  203 78519.9675 100911.814  28.5%  1758  577s
  3109  2667 86423.1732   25  124 78519.9675 100911.814  28.5%  1755  588s
  3269  2853 79946.9544   27   60 78519.9675 99078.8941  26.2%  1718  598s
  3494  2854 89919.9010   30  332 78519.9675 99078.8941  26.2%  1665  668s
  3496  2855 84942.5717   46   86 78519.9675 99078.8941  26.2%  1664  692s
  3497  2856 98096.5427    7  344 78519.9675 99078.8941  26.2%  1664  710s
  3498  2857 91669.5726   27  276 78519.9675 99078.8941  26.2%  1664  720s
  3499  2857 89550.6983   22  321 78519.9675 99078.8941  26.2%  1663  727s
  3500  2858 81303.5303   38  312 78519.9675 99078.8941  26.2%  1663  733s
  3501  2859 80632.8046   52  320 78519.9675 99078.8941  26.2%  1662  737s
  3502  2859 91831.1422   20  317 78519.9675 99078.8941  26.2%  1662  741s
  3504  2861 92525.2724   19  370 78519.9675 99078.8941  26.2%  1661  746s
  3507  2863 83969.8642   27  330 78519.9675 99078.8941  26.2%  1659  751s
  3509  2864 84400.6104   42  337 78519.9675 99078.8941  26.2%  1658  756s
  3511  2865 86458.3574   14  337 78519.9675 99078.8941  26.2%  1657  760s
  3514  2867 82758.6798   28  335 78519.9675 99078.8941  26.2%  1656  767s
  3516  2869 84392.2727   52  333 78519.9675 99078.8941  26.2%  1655  772s
  3518  2870 91019.4507   13  337 78519.9675 99078.8941  26.2%  1654  776s
  3520  2871 97906.0017   10  337 78519.9675 99078.8941  26.2%  1653  781s
  3522  2873 81756.7071   45  342 78519.9675 99078.8941  26.2%  1652  787s
  3524  2874 96189.7475   12  341 78519.9675 99078.8941  26.2%  1651  791s
  3525  2875 94646.5403   21  341 78519.9675 99078.8941  26.2%  1651  820s
  3526  2875 91223.2214   23  341 78519.9675 99078.8941  26.2%  1650  832s
  3527  2879 99078.8941   15  323 78519.9675 99078.8941  26.2%  1679  853s
  3529  2882 99078.8941   16  416 78519.9675 99078.8941  26.2%  1680  867s
  3533  2889 99078.8941   17  424 78519.9675 99078.8941  26.2%  1683  884s
  3541  2902 99078.8941   18  454 78519.9675 99078.8941  26.2%  1692  908s
  3557  2919 97254.6533   19  304 78519.9675 99078.8941  26.2%  1737  933s
  3579  2944 95641.8310   20  417 78519.9675 99078.8941  26.2%  1772  956s
  3611  3082 95592.3101   21  341 78519.9675 99078.8941  26.2%  1797  974s
  3760  3089 94263.7351   24  297 78519.9675 99078.8941  26.2%  1825  984s
  3817  3136 94246.7429   25  334 78519.9675 99078.8941  26.2%  1860  994s
  3884  3186 90800.3774   23  357 78519.9675 99078.8941  26.2%  1876 1007s
  3966  3225 91984.2326   25  285 78519.9675 99078.8941  26.2%  1880 1018s
  4038  3254 92218.5338   26  184 78519.9675 99078.8941  26.2%  1890 1030s
  4117  3269 91172.4953   27  179 78519.9675 99078.8941  26.2%  1890 1042s
  4189  3280 90696.5229   28  187 78519.9675 99078.8941  26.2%  1888 1065s
  4260  3313 89921.6959   29  178 78519.9675 99078.8941  26.2%  1895 1076s
  4335  3320 89746.9249   30  192 78519.9675 99078.8941  26.2%  1891 1088s
  4414  3318 87765.2685   28  166 78519.9675 99078.8941  26.2%  1888 1097s
  4458  3336 88120.0864   31  178 78519.9675 99078.8941  26.2%  1888 1108s
  4521  3346 88403.2968   31  184 78519.9675 99078.8941  26.2%  1887 1120s
  4571  3388 86667.2220   30  137 78519.9675 99078.8941  26.2%  1888 1132s
  4648  3422 87928.7582   32  153 78519.9675 99078.8941  26.2%  1890 1140s
  4742  3436 87156.5434   35  149 78519.9675 99078.8941  26.2%  1882 1155s
  4838  3452 86316.0738   38   97 78519.9675 99078.8941  26.2%  1876 1164s
  4942  3461 84563.6067   40  108 78519.9675 98816.8955  25.8%  1871 1176s
  5061  3459 83622.0581   43  123 78519.9675 98697.9959  25.7%  1865 1190s
  5173  3482     cutoff   44      78519.9675 98697.9959  25.7%  1865 1202s
  5271  3483     cutoff   50      78519.9675 98367.2829  25.3%  1868 1209s
  5326  3528 94607.4959   25  341 78519.9675 98367.2829  25.3%  1868 1220s
  5429  3567 93950.8751   26  338 78519.9675 98367.2829  25.3%  1864 1234s
  5547  3592 93065.3508   28  328 78519.9675 97839.7428  24.6%  1860 1247s
  5664  3606 91021.7843   32  244 78519.9675 97839.7428  24.6%  1862 1260s
  5756  3648 90832.6883   33  195 78519.9675 97550.4048  24.2%  1861 1273s
  5881  3684 87741.7341   36  144 78519.9675 97550.4048  24.2%  1857 1289s
  6005  3716 84246.6442   40  172 78519.9675 97198.7262  23.8%  1861 1303s
  6135  3766 82796.4768   45  156 78519.9675 97134.7011  23.7%  1868 1319s
  6276  3747 94929.6268   22  272 78519.9675 97134.7011  23.7%  1875 1331s
  6339  3771 94338.6596   23  265 78519.9675 97134.7011  23.7%  1878 1342s
  6420  3817 93174.7013   25  338 78519.9675 97134.7011  23.7%  1876 1360s
  6608  3855 90643.2552   29  176 78519.9675 96693.5175  23.1%  1863 1376s
  6865  3812 88564.1144   33  115 78519.9675 96693.0803  23.1%  1840 1395s
H 7025  3606                    78688.501321 96465.0513  22.6%  1833 1395s
  7032  3711 86870.8500   39  125 78688.5013 96465.0513  22.6%  1834 1414s
  7203  3761 84852.7386   46  108 78688.5013 96465.0513  22.6%  1848 1440s
  7392  3797 79907.2069   53  104 78688.5013 96288.2897  22.4%  1860 1461s
  7649  3843 87095.5444   28  167 78688.5013 96174.2255  22.2%  1858 1479s
  7893  3889 84040.9769   38  186 78688.5013 96174.2255  22.2%  1859 1499s
  8182  3904     cutoff   53      78688.5013 96174.2255  22.2%  1852 1516s
H 8271  3736                    78714.445333 96174.2255  22.2%  1851 1516s
  8396  3868 90886.6257   24  289 78714.4453 96174.2255  22.2%  1847 1536s
  8663  3950 85944.7974   27  171 78714.4453 96174.2255  22.2%  1848 1558s
  8950  4023 82084.6605   32  101 78714.4453 96174.2255  22.2%  1847 1580s
  9261  4045 78948.1651   44   95 78714.4453 95969.0982  21.9%  1844 1604s
  9544  4030 85355.4723   28  303 78714.4453 95969.0982  21.9%  1852 1632s
H 9653  3843                    78796.773088 95969.0982  21.8%  1852 1632s
  9678  3972 82177.9917   30  196 78796.7731 95969.0982  21.8%  1854 1655s
 10025  4027 89519.4868   24  320 78796.7731 95829.0632  21.6%  1855 1679s
 10272  4146 85056.9814   26  333 78796.7731 95829.0632  21.6%  1877 1705s
 10611  4215 85070.5621   28  254 78796.7731 95005.6669  20.6%  1883 1734s
 10707  4183 88935.5942   24  292 78796.7731 94243.3367  19.6%  1881 1735s
 11093  4309 80316.3140   31  204 78796.7731 94243.3367  19.6%  1866 1762s
 11597  4528     cutoff   33      78796.7731 94043.0463  19.3%  1850 1791s
 11961  4695 85279.4548   27  205 78796.7731 93947.3858  19.2%  1857 1821s
 12375  4878 80217.5023   39  111 78796.7731 93815.4945  19.1%  1847 1857s
 12798  5134 85129.2766   26  234 78796.7731 93815.4945  19.1%  1851 1887s
 13249  5414 89977.6975   30  336 78796.7731 93815.4945  19.1%  1852 1927s
 13744  5778 82618.1103   37  132 78796.7731 93815.4945  19.1%  1848 1964s
 14387  6075 83571.4629   35  187 78796.7731 93595.3669  18.8%  1831 1999s
 14944  6235 81254.6350   33  186 78796.7731 93595.3669  18.8%  1828 2035s
 15370  6571 85568.1905   25  169 78796.7731 92897.5702  17.9%  1827 2073s
 15976  6847 84810.0872   27  232 78796.7731 92576.8778  17.5%  1823 2113s
 16595  7156 88346.5788   27  258 78796.7731 92558.0036  17.5%  1821 2154s
 17208  7424 82668.0180   26  147 78796.7731 92358.3009  17.2%  1821 2198s
 17836  7739 84235.0094   28  261 78796.7731 92100.1219  16.9%  1822 2243s
 18619  8017 84409.1866   37  110 78796.7731 92098.1362  16.9%  1811 2288s
 19296  8335     cutoff   34      78796.7731 91964.6331  16.7%  1811 2333s
 20105  8675 88631.0083   29  343 78796.7731 91772.0690  16.5%  1802 2377s
 20858  9029 82669.7537   30  313 78796.7731 91623.0609  16.3%  1802 2432s
 21658  9400 81575.3328   27  292 78796.7731 91298.3407  15.9%  1798 2483s
 22412  9771 79179.4623   27  298 78796.7731 91255.9286  15.8%  1800 2535s
 23298 10116 79336.5760   39   93 78796.7731 90946.5343  15.4%  1797 2593s
 24130 10147 80463.8793   36   80 78796.7731 90806.2732  15.2%  1800 2652s
H24131 10100                    78947.278213 90806.2732  15.0%  1800 2652s
H24133 10099                    78954.465255 90806.2732  15.0%  1800 2652s
H24171 10011                    79101.794787 90806.2732  14.8%  1800 2652s
H24179 10051                    79104.177991 90806.2732  14.8%  1800 2701s
H24190 10039                    79131.463723 90806.2732  14.8%  1800 2701s
H24199 10031                    79155.311124 90806.2732  14.7%  1800 2701s
H24211 10031                    79155.686259 90806.2732  14.7%  1800 2701s
 24247 10283 85658.2739   32  288 79155.6863 90806.2732  14.7%  1802 2760s
 25125 10580 86751.3089   22  163 79155.6863 90633.9575  14.5%  1804 2820s
 25997 10847 80701.3647   33  168 79155.6863 90518.3573  14.4%  1814 2894s
 27042 11174 82132.5841   27  204 79155.6863 90395.1825  14.2%  1813 2968s
 27980 11570 80072.1849   43  100 79155.6863 90217.7343  14.0%  1818 3034s
 29061 12071 85156.1452   30  181 79155.6863 90081.1078  13.8%  1815 3127s
 30341 12327 85611.8503   31  283 79155.6863 89883.9648  13.6%  1812 3193s
 31380 12650 82459.2982   31  203 79155.6863 89758.6638  13.4%  1813 3262s
 32544 13075 81196.7048   29  109 79155.6863 89643.6513  13.2%  1812 3339s
 33755 13390 80720.1649   31  217 79155.6863 89523.2562  13.1%  1810 3412s
 34947 13730 82642.6124   35  168 79155.6863 89309.9621  12.8%  1811 3486s
 36314 14123     cutoff   27      79155.6863 89231.5524  12.7%  1807 3563s
 37710 14272 86055.3094   38   76 79155.6863 89076.7217  12.5%  1804 3600s

Cutting planes:
  MIR: 777
  Mixing: 1
  Flow cover: 1460
  RLT: 25
  Relax-and-lift: 143

Explored 38406 nodes (69331840 simplex iterations) in 3600.05 seconds (6892.77 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 79155.7 79155.3 79131.5 ... 78688.5

Time limit reached
Best objective 7.915568625903e+04, best bound 8.905789062665e+04, gap 12.5098%
  WARNING: Time limit reached. Using best solution found (gap: 12.51%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = 79155.69, θ = 232047.10
  Upper Bound (UB) = 79155.69

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 232047.10
  [DEBUG]   ✓ Scenario 0: θ = 232047.10 ≤ Q = 232047.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 232047.10 ≤ Q = 232047.10 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 232047.10 ≤ Q = 232047.38 (slack: 0.27)
  [DEBUG]   ✓ Scenario 3: θ = 232047.10 ≤ Q = 232047.10 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 232047.10 ≤ Q = 232047.10 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x5d88dc09
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x5d88dc09
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.559142e+13
Presolve removed 2576 rows and 1867 columns
Presolve time: 0.01s
Presolved: 517 rows, 522 columns, 1459 nonzeros
Found heuristic solution: objective 8277918.6418
Variable types: 353 continuous, 169 integer (169 binary)
Found heuristic solution: objective 8277463.9980

Root relaxation: objective -1.644308e+05, 250 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -164430.76    0  130 8277464.00 -164430.76   102%     -    0s
H    0     0                    -143717.6565 -164430.76  14.4%     -    0s
H    0     0                    -145182.0419 -164430.76  13.3%     -    0s
H    0     0                    -149640.0449 -164430.76  9.88%     -    0s
H    0     0                    -153190.9853 -154935.89  1.14%     -    0s
     0     0 -154935.89    0  100 -153190.99 -154935.89  1.14%     -    0s
H    0     0                    -153598.5815 -154548.96  0.62%     -    0s
     0     0 -154548.96    0  101 -153598.58 -154548.96  0.62%     -    0s
     0     0 -154545.50    0  101 -153598.58 -154545.50  0.62%     -    0s
     0     0 -153856.96    0   46 -153598.58 -153856.96  0.17%     -    0s
     0     0 -153784.79    0   25 -153598.58 -153784.79  0.12%     -    0s
     0     0 -153783.27    0   25 -153598.58 -153783.27  0.12%     -    0s
     0     0 -153745.52    0   22 -153598.58 -153745.52  0.10%     -    0s
     0     0 -153726.48    0   18 -153598.58 -153726.48  0.08%     -    0s
     0     0 -153722.16    0   17 -153598.58 -153722.16  0.08%     -    0s
     0     0 -153708.08    0   16 -153598.58 -153708.08  0.07%     -    0s
     0     0 -153691.04    0   15 -153598.58 -153691.04  0.06%     -    0s
     0     0 -153650.96    0   10 -153598.58 -153650.96  0.03%     -    0s
     0     0 -153650.61    0   10 -153598.58 -153650.61  0.03%     -    0s
     0     0 -153650.45    0   10 -153598.58 -153650.45  0.03%     -    0s
H    0     0                    -153604.6511 -153650.45  0.03%     -    0s
     0     0 -153624.69    0    4 -153604.65 -153624.69  0.01%     -    0s
     0     0          -    0      -153604.65 -153613.33  0.01%     -    0s

Explored 1 nodes (666 simplex iterations) in 0.08 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -153605 -153599 -153384 ... 1.55914e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.536046510583e+05, best bound -1.536133331847e+05, gap 0.0057%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 209834.52
  Scenario: 43 demand increases, 17 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -153604.65
  [DEBUG]   S×d_nominal = 363439.18
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 363439.18 + -153604.65 = 209834.52
  [DEBUG]   Current θ from Master = 232047.10
  [DEBUG]   ⚠️  Z_SP ≤ θ by 22212.58 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 56943.11
  Lower Bound (LB) = 75334.45
  Gap (UB-LB) = 3821.2377, Absolute Gap = 3821.2377, Relative Gap = 0.048275
  Not converged yet (gap = 3821.24 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 43 increases, 17 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 264995 nonzeros
Model fingerprint: 0x1159830f
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 39390 rows and 15990 columns
Presolve time: 1.60s
Presolved: 53733 rows, 23710 columns, 333629 nonzeros
Variable types: 21451 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -281170.8884
Found heuristic solution: objective -174612.9734

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 53733 rows, 23710 columns, 333629 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   23728   -1.5871605e+04   0.000000e+00   1.265356e+08      5s
   37010    7.4001299e+04   0.000000e+00   3.435261e+08     10s
   47300    9.1302979e+04   0.000000e+00   1.815151e+07     15s
   57626    1.0332858e+05   0.000000e+00   4.386390e+07     20s
   67230    1.0619890e+05   0.000000e+00   3.085579e+06     25s
Concurrent spin time: 6.63s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 1.186737e+05, 52803 iterations, 30.95 seconds (36.05 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 118673.727    0   92 -174612.97 118673.727   168%     -   33s
H    0     0                    -169143.6261 118673.727   170%     -   33s
H    0     0                    -159522.8609 118673.727   174%     -   33s
H    0     0                    -159434.4261 118673.727   174%     -   33s
H    0     0                    -158521.1200 118673.727   175%     -   33s
H    0     0                    -120983.2530 118673.727   198%     -   34s
H    0     0                    -117474.1157 118673.727   201%     -   34s
H    0     0                    -116890.2918 118673.727   202%     -   34s
H    0     0                    -109506.2161 118673.727   208%     -   34s
H    0     0                    -109398.4608 118673.727   208%     -   34s
H    0     0                    -108518.9700 118673.727   209%     -   34s
H    0     0                    -107781.0070 118673.727   210%     -   34s
H    0     0                    -107737.0674 118673.727   210%     -   34s
H    0     0                    -106972.6463 118673.727   211%     -   34s
H    0     0                    -106918.2966 118673.727   211%     -   34s
H    0     0                    -106870.2651 118673.727   211%     -   34s
H    0     0                    -106678.2593 118673.727   211%     -   34s
H    0     0                    -106678.2479 118673.727   211%     -   34s
H    0     0                    -7284.872270 118673.727  1729%     -   34s
H    0     0                    -7195.198624 118673.727  1749%     -   34s
H    0     0                    58117.715817 118673.727   104%     -   34s
H    0     0                    60813.007086 118673.727  95.1%     -   34s
H    0     0                    64708.909485 118673.727  83.4%     -   34s
H    0     0                    65021.202228 118673.727  82.5%     -   34s
H    0     0                    69869.351759 118673.727  69.9%     -   34s
H    0     0                    72360.616754 118673.727  64.0%     -   35s
H    0     0                    73596.175204 118673.727  61.2%     -   35s
H    0     0                    73612.939526 118673.727  61.2%     -   35s
H    0     0                    74533.907471 118673.727  59.2%     -   35s
H    0     0                    75012.858218 118673.727  58.2%     -   35s
H    0     0                    75065.967171 112777.674  50.2%     -   51s
H    0     0                    75933.789269 112777.674  48.5%     -   51s
H    0     0                    76340.510191 112777.674  47.7%     -   51s
H    0     0                    76486.195950 112777.674  47.4%     -   51s
     0     0 112777.674    0  194 76486.1960 112777.674  47.4%     -   51s
H    0     0                    76533.090371 112776.736  47.4%     -   52s
     0     0 110918.065    0  169 76533.0904 110918.065  44.9%     -   61s
     0     0 110918.065    0  173 76533.0904 110918.065  44.9%     -   63s
     0     0 110918.065    0  173 76533.0904 110918.065  44.9%     -   64s
     0     0 110918.065    0  173 76533.0904 110918.065  44.9%     -   64s
     0     0 107887.931    0  292 76533.0904 107887.931  41.0%     -   78s
     0     0 107297.292    0  290 76533.0904 107297.292  40.2%     -   85s
     0     0 106878.780    0  307 76533.0904 106878.780  39.7%     -   89s
     0     0 106827.219    0  308 76533.0904 106827.219  39.6%     -   91s
     0     0 106780.578    0  271 76533.0904 106780.578  39.5%     -   92s
     0     0 106768.650    0  275 76533.0904 106768.650  39.5%     -   94s
     0     0 106742.998    0  268 76533.0904 106742.998  39.5%     -   95s
     0     0 106735.145    0  274 76533.0904 106735.145  39.5%     -   95s
     0     0 106734.350    0  277 76533.0904 106734.350  39.5%     -   95s
H    0     0                    76536.863439 105300.327  37.6%     -  113s
     0     0 105300.327    0  299 76536.8634 105300.327  37.6%     -  113s
     0     0 104949.538    0  295 76536.8634 104949.538  37.1%     -  118s
     0     0 104852.028    0  288 76536.8634 104852.028  37.0%     -  121s
     0     0 104756.168    0  291 76536.8634 104756.168  36.9%     -  122s
     0     0 104722.127    0  293 76536.8634 104722.127  36.8%     -  123s
     0     0 104699.365    0  298 76536.8634 104699.365  36.8%     -  124s
     0     0 104695.642    0  298 76536.8634 104695.642  36.8%     -  124s
     0     0 104692.883    0  303 76536.8634 104692.883  36.8%     -  125s
     0     0 104686.408    0  298 76536.8634 104686.408  36.8%     -  125s
     0     0 104683.580    0  300 76536.8634 104683.580  36.8%     -  125s
     0     0 104682.374    0  302 76536.8634 104682.374  36.8%     -  125s
     0     0 103739.008    0  299 76536.8634 103739.008  35.5%     -  143s
     0     0 103418.971    0  325 76536.8634 103418.971  35.1%     -  148s
     0     0 103288.142    0  328 76536.8634 103288.142  35.0%     -  151s
     0     0 103189.716    0  346 76536.8634 103189.716  34.8%     -  155s
     0     0 103135.604    0  341 76536.8634 103135.604  34.8%     -  157s
     0     0 103089.526    0  389 76536.8634 103089.526  34.7%     -  158s
     0     0 103006.846    0  340 76536.8634 103006.846  34.6%     -  161s
     0     0 102986.949    0  341 76536.8634 102986.949  34.6%     -  162s
     0     0 102949.788    0  390 76536.8634 102949.788  34.5%     -  163s
     0     0 102938.630    0  349 76536.8634 102938.630  34.5%     -  165s
     0     0 102926.217    0  352 76536.8634 102926.217  34.5%     -  165s
     0     0 102921.470    0  347 76536.8634 102921.470  34.5%     -  166s
     0     0 102917.099    0  348 76536.8634 102917.099  34.5%     -  167s
     0     0 102916.246    0  322 76536.8634 102916.246  34.5%     -  167s
     0     0 102617.335    0  426 76536.8634 102617.335  34.1%     -  174s
     0     0 102514.975    0  351 76536.8634 102514.975  33.9%     -  178s
     0     0 102459.828    0  345 76536.8634 102459.828  33.9%     -  181s
     0     0 102436.880    0  342 76536.8634 102436.880  33.8%     -  183s
     0     0 102421.525    0  343 76536.8634 102421.525  33.8%     -  184s
     0     0 102407.933    0  344 76536.8634 102407.933  33.8%     -  185s
     0     0 102402.646    0  347 76536.8634 102402.646  33.8%     -  185s
     0     0 102399.421    0  346 76536.8634 102399.421  33.8%     -  186s
     0     0 102394.207    0  355 76536.8634 102394.207  33.8%     -  186s
     0     0 102389.175    0  352 76536.8634 102389.175  33.8%     -  187s
     0     0 102387.263    0  349 76536.8634 102387.263  33.8%     -  187s
     0     0 102385.060    0  350 76536.8634 102385.060  33.8%     -  188s
     0     0 102383.899    0  352 76536.8634 102383.899  33.8%     -  188s
     0     0 102143.021    0  316 76536.8634 102143.021  33.5%     -  195s
     0     0 102109.512    0  372 76536.8634 102109.512  33.4%     -  198s
     0     0 102084.056    0  336 76536.8634 102084.056  33.4%     -  200s
     0     0 102077.041    0  330 76536.8634 102077.041  33.4%     -  201s
     0     0 102071.112    0  326 76536.8634 102071.112  33.4%     -  202s
     0     0 102068.296    0  328 76536.8634 102068.296  33.4%     -  203s
     0     0 102059.507    0  330 76536.8634 102059.507  33.3%     -  203s
     0     0 102058.108    0  337 76536.8634 102058.108  33.3%     -  205s
     0     0 102015.198    0  376 76536.8634 102015.198  33.3%     -  207s
H    0     0                    76668.082460 102014.994  33.1%     -  208s
     0     0 102000.347    0  380 76668.0825 102000.347  33.0%     -  209s
     0     0 101993.273    0  384 76668.0825 101993.273  33.0%     -  210s
     0     0 101987.848    0  381 76668.0825 101987.848  33.0%     -  211s
     0     0 101986.536    0  383 76668.0825 101986.536  33.0%     -  211s
     0     0 101959.751    0  335 76668.0825 101959.751  33.0%     -  214s
     0     0 101947.493    0  337 76668.0825 101947.493  33.0%     -  218s
     0     0 101939.580    0  330 76668.0825 101939.580  33.0%     -  219s
     0     0 101934.895    0  339 76668.0825 101934.895  33.0%     -  219s
     0     0 101930.487    0  339 76668.0825 101930.487  33.0%     -  220s
     0     0 101927.375    0  339 76668.0825 101927.375  32.9%     -  220s
     0     0 101925.106    0  337 76668.0825 101925.106  32.9%     -  221s
     0     0 101923.777    0  326 76668.0825 101923.777  32.9%     -  221s
     0     0 101916.192    0  337 76668.0825 101916.192  32.9%     -  223s
     0     0 101913.667    0  339 76668.0825 101913.667  32.9%     -  223s
     0     0 101912.511    0  327 76668.0825 101912.511  32.9%     -  224s
     0     0 101911.651    0  339 76668.0825 101911.651  32.9%     -  225s
     0     0 101910.722    0  339 76668.0825 101910.722  32.9%     -  227s
     0     0 101879.207    0  316 76668.0825 101879.207  32.9%     -  229s
     0     0 101861.483    0  332 76668.0825 101861.483  32.9%     -  231s
     0     0 101858.587    0  326 76668.0825 101858.587  32.9%     -  231s
     0     0 101855.795    0  338 76668.0825 101855.795  32.9%     -  232s
     0     0 101854.251    0  329 76668.0825 101854.251  32.9%     -  232s
     0     0 101846.085    0  342 76668.0825 101846.085  32.8%     -  234s
     0     0 101844.640    0  342 76668.0825 101844.640  32.8%     -  240s
     0     0 101840.870    0  337 76668.0825 101840.870  32.8%     -  242s
     0     0 101830.092    0  342 76668.0825 101830.092  32.8%     -  244s
     0     0 101829.407    0  342 76668.0825 101829.407  32.8%     -  244s
     0     0 101816.348    0  333 76668.0825 101816.348  32.8%     -  246s
     0     0 101814.507    0  342 76668.0825 101814.507  32.8%     -  247s
     0     0 101795.753    0  335 76668.0825 101795.753  32.8%     -  248s
     0     0 101791.348    0  338 76668.0825 101791.348  32.8%     -  250s
     0     0 101790.926    0  340 76668.0825 101790.926  32.8%     -  250s
     0     0 101784.160    0  330 76668.0825 101784.160  32.8%     -  252s
     0     0 101781.362    0  332 76668.0825 101781.362  32.8%     -  252s
     0     0 101780.582    0  336 76668.0825 101780.582  32.8%     -  253s
     0     0 101764.555    0  328 76668.0825 101764.555  32.7%     -  254s
     0     0 101764.080    0  328 76668.0825 101764.080  32.7%     -  255s
     0     2 101761.615    0  328 76668.0825 101761.615  32.7%     -  290s
     3     8 101569.832    2  306 76668.0825 101723.904  32.7%  1142  296s
     7    16 101060.444    3  332 76668.0825 101608.414  32.5%  2458  301s
    15    32 100909.525    4  318 76668.0825 101432.050  32.3%  3405  310s
    31    64 100720.771    5  327 76668.0825 101269.576  32.1%  6436  321s
    63    72 100039.257    6  312 76668.0825 101179.703  32.0%  6107  334s
    71   101 99398.9474    7  293 76668.0825 101179.703  32.0%  6362  354s
   100   133 99335.7811    8  289 76668.0825 101178.965  32.0%  6842  367s
H  103   133                    76688.104764 101178.965  31.9%  6681  367s
   132   233 99297.5267    9  290 76688.1048 101178.965  31.9%  5983  386s
   232   312 99067.1227   11  277 76688.1048 101178.965  31.9%  4703  400s
   311   404 98808.3085   10  282 76688.1048 101178.965  31.9%  4214  412s
   407   435 98169.0134   12  313 76688.1048 101178.965  31.9%  3738  421s
   440   480 97470.5768   11  281 76688.1048 101178.965  31.9%  3622  437s
   489   524 98034.1360   13  270 76688.1048 101178.965  31.9%  3489  445s
   535   571 98103.4544   13  305 76688.1048 101178.965  31.9%  3359  455s
   582   612 96429.0245   20  314 76688.1048 101178.965  31.9%  3256  467s
   625   666 97779.1381   14  263 76688.1048 101178.965  31.9%  3165  477s
   679   713 97574.3081   14  263 76688.1048 101178.965  31.9%  3037  488s
   728   764 97578.5649   15  332 76688.1048 101178.965  31.9%  2962  497s
   783   802 97156.4071   15  255 76688.1048 101178.965  31.9%  2854  508s
   829   851 97028.9215   16  330 76688.1048 101178.965  31.9%  2799  514s
H  859   851                    78160.518492 101178.965  29.5%  2733  514s
   882   909 96448.2969   15  279 78160.5185 101178.965  29.5%  2718  524s
H  883   909                    78245.433190 101178.965  29.3%  2715  524s
   970   993 96719.5281   17  264 78245.4332 101042.041  29.1%  2575  537s
  1104  1073 96378.9504   18  264 78245.4332 101042.041  29.1%  2392  549s
  1246  1166 89740.1139   17  274 78245.4332 101036.820  29.1%  2248  562s
  1383  1193 89124.9740   17  265 78245.4332 101036.820  29.1%  2134  573s
H 1396  1193                    78250.518553 100861.163  28.9%  2136  573s
  1418  1309 96075.3280   19  261 78250.5186 100861.163  28.9%  2136  587s
  1566  1451 95489.2688   22  255 78250.5186 100822.888  28.8%  2064  597s
  1724  1595 94124.0411   21  257 78250.5186 100822.888  28.8%  1982  607s
  1896  1720 92781.8348   23  267 78250.5186 100822.888  28.8%  1889  623s
  2045  1873 95055.8775   23  241 78250.5186 100822.888  28.8%  1853  638s
  2218  2047 92715.9215   25  189 78250.5186 100822.888  28.8%  1797  652s
  2448  2073 89702.0490   26  221 78250.5186 100822.888  28.8%  1709  666s
  2486  2099 90738.5018   28  198 78250.5186 100719.610  28.7%  1707  676s
  2526  2127 90176.3803   28  167 78250.5186 100719.610  28.7%  1710  688s
  2564  2157 91683.1480   28  185 78250.5186 100719.610  28.7%  1719  696s
  2606  2214 90046.8614   29  198 78250.5186 100719.610  28.7%  1714  706s
  2669  2291 89073.8129   29  169 78250.5186 100563.368  28.5%  1697  721s
  2778  2424 85550.1010   28  190 78250.5186 100563.368  28.5%  1664  738s
  2975  2583 87835.8987   35  189 78250.5186 100466.540  28.4%  1611  755s
  3160  2802 87330.2098   43  195 78250.5186 100466.540  28.4%  1574  767s
  3434  2803 85986.0824   27  328 78250.5186 100466.540  28.4%  1513  817s
  3436  2804 86605.3366   54   92 78250.5186 100466.540  28.4%  1512  868s
  3437  2805 95025.0369   16  328 78250.5186 100466.540  28.4%  1512  894s
  3438  2806 82200.4785   43  309 78250.5186 100466.540  28.4%  1512  907s
  3439  2806 89255.9529   33  297 78250.5186 100466.540  28.4%  1511  917s
  3440  2807 89536.4099   26  313 78250.5186 100466.540  28.4%  1511  924s
  3441  2808 84098.7715   27  361 78250.5186 100466.540  28.4%  1510  930s
  3443  2809 90549.4236   14  336 78250.5186 100466.540  28.4%  1509  936s
  3445  2810 96653.0402   12  337 78250.5186 100466.540  28.4%  1508  941s
  3448  2812 97936.3116   12  324 78250.5186 100466.540  28.4%  1507  945s
  3450  2814 92719.5823   22  337 78250.5186 100466.540  28.4%  1506  950s
  3454  2816 80401.2860   46  328 78250.5186 100466.540  28.4%  1505  961s
  3455  2817 85597.4494   49  371 78250.5186 100466.540  28.4%  1504  966s
  3457  2818 94763.3197   10  341 78250.5186 100466.540  28.4%  1503  970s
  3458  2819 81289.6103   86  339 78250.5186 100466.540  28.4%  1503  976s
  3462  2822 87045.4916   46  335 78250.5186 100466.540  28.4%  1501  981s
  3463  2822 92036.1457   28  387 78250.5186 100466.540  28.4%  1501  987s
  3465  2824 89154.4156   30  339 78250.5186 100466.540  28.4%  1500  990s
  3466  2824 88768.3931   50  374 78250.5186 100466.540  28.4%  1499  995s
  3469  2826 93468.8403    8  380 78250.5186 100466.540  28.4%  1498 1000s
  3472  2828 94976.5358   17  335 78250.5186 100466.540  28.4%  1497 1012s
  3474  2830 96698.3661   19  338 78250.5186 100466.540  28.4%  1496 1015s
  3476  2831 98141.9873   13  341 78250.5186 100466.540  28.4%  1495 1021s
  3477  2832 99236.4733   10  340 78250.5186 100466.540  28.4%  1495 1028s
  3479  2833 85196.7239   22  341 78250.5186 100466.540  28.4%  1494 1033s
  3480  2834 90236.0679   29  340 78250.5186 100466.540  28.4%  1493 1035s
  3481  2834 83403.5806   47  346 78250.5186 100466.540  28.4%  1493 1040s
  3483  2836 81287.8555   32  377 78250.5186 100466.540  28.4%  1492 1046s
  3484  2836 82429.2979   73  377 78250.5186 100466.540  28.4%  1492 1092s
  3485  2837 88126.7329   61  377 78250.5186 100466.540  28.4%  1491 1117s
  3486  2841 100466.540   11  405 78250.5186 100466.540  28.4%  1544 1152s
  3488  2844 100466.540   12  374 78250.5186 100466.540  28.4%  1546 1175s
  3492  2851 100350.952   13  414 78250.5186 100466.540  28.4%  1553 1203s
  3500  2864 99934.5933   14  382 78250.5186 100348.773  28.2%  1571 1225s
  3516  2875 98396.5376   15  378 78250.5186 99975.4086  27.8%  1613 1264s
  3532  2901 95891.5703   16  337 78250.5186 99975.4086  27.8%  1670 1295s
H 3539  2756                    78295.051009 99975.4086  27.7%  1679 1295s
  3564  2885 95604.4668   17  295 78295.0510 99975.4086  27.7%  1737 1322s
  3706  2901 93197.9393   18  313 78295.0510 99975.4086  27.7%  1824 1341s
  3791  2947 93056.0562   20  294 78295.0510 99975.4086  27.7%  1834 1361s
  3879  2987 94554.0184   20  317 78295.0510 99975.4086  27.7%  1851 1376s
  3953  3013 92791.1896   21  293 78295.0510 99975.4086  27.7%  1887 1385s
  4039  3004 91861.2567   21  311 78295.0510 99975.4086  27.7%  1892 1399s
  4075  3010 92469.2758   21  247 78295.0510 99975.4086  27.7%  1897 1416s
  4117  3014 90570.3495   21  301 78295.0510 99975.4086  27.7%  1916 1431s
  4165  3034 92262.4806   22  250 78295.0510 99975.4086  27.7%  1933 1443s
  4224  3053 90041.5289   24  201 78295.0510 99975.4086  27.7%  1957 1457s
  4278  3064 89218.1556   26  222 78295.0510 99975.4086  27.7%  1975 1467s
  4335  3080 86233.6791   30  131 78295.0510 99975.4086  27.7%  1990 1480s
  4398  3098 88076.2963   31  168 78295.0510 99975.4086  27.7%  2004 1493s
  4470  3113 87263.9837   33  167 78295.0510 99975.4086  27.7%  2006 1509s
  4556  3119 86586.1074   34  153 78295.0510 99975.4086  27.7%  2022 1530s
  4643  3136 85324.7426   36  173 78295.0510 99975.4086  27.7%  2041 1545s
  4722  3149 83590.2224   39   99 78295.0510 99975.4086  27.7%  2063 1559s
  4827  3151 82004.2702   40   56 78295.0510 99975.4086  27.7%  2059 1579s
  4942  3147 80029.4908   45  133 78295.0510 99975.4086  27.7%  2065 1596s
  5028  3176     cutoff   54      78295.0510 99009.5094  26.5%  2092 1612s
  5126  3212 90025.7275   17  302 78295.0510 99009.5094  26.5%  2120 1627s
  5228  3247 87774.8465   20  265 78295.0510 99009.5094  26.5%  2138 1645s
  5345  3277 85414.3707   22  239 78295.0510 99009.5094  26.5%  2157 1663s
  5475  3290 83452.8662   25  194 78295.0510 99009.5094  26.5%  2176 1683s
  5599  3300 81369.0342   31  190 78295.0510 99009.5094  26.5%  2196 1701s
  5734  3341 80101.3975   35  152 78295.0510 99009.5094  26.5%  2212 1718s
  5863  3321 88090.2344   19  265 78295.0510 98388.4475  25.7%  2237 1736s
  5945  3345 80764.0214   21  217 78295.0510 96893.2901  23.8%  2248 1757s
  6040  3341 79176.5155   23  178 78295.0510 96040.8604  22.7%  2269 1774s
  6082  3353 78996.6077   24  178 78295.0510 96040.8604  22.7%  2288 1796s
  6131  3373     cutoff   32      78295.0510 95860.8671  22.4%  2298 1818s
  6227  3387 94284.4860   20  313 78295.0510 95860.8671  22.4%  2302 1843s
  6354  3384 91551.1709   24  310 78295.0510 95530.1514  22.0%  2324 1869s
  6512  3413 82218.0987   28  223 78295.0510 95355.2647  21.8%  2351 1891s
  6668  3448     cutoff   30      78295.0510 95355.2647  21.8%  2370 1913s
  6896  3446 86699.7470   22  376 78295.0510 94664.1441  20.9%  2385 1934s
  7063  3447 85448.9359   24  345 78295.0510 94664.1441  20.9%  2423 1961s
  7168  3479 85229.7884   25  301 78295.0510 94382.9664  20.5%  2446 1981s
  7322  3537 83530.0899   26  300 78295.0510 94244.4451  20.4%  2466 2006s
  7496  3571 82930.7342   27  271 78295.0510 94244.4451  20.4%  2493 2033s
  7678  3593 79889.3303   28  266 78295.0510 94244.4451  20.4%  2528 2059s
  7895  3635     cutoff   29      78295.0510 94244.4451  20.4%  2559 2089s
  8095  3671 90331.1676   23  230 78295.0510 94244.4451  20.4%  2608 2118s
  8354  3700 85944.5781   24  190 78295.0510 94244.4451  20.4%  2647 2144s
  8587  3739 88474.1610   26  240 78295.0510 94244.4451  20.4%  2693 2173s
  8888  3721 82460.5738   30  166 78295.0510 94244.4451  20.4%  2727 2202s
  9199  3727 88780.5557   22  244 78295.0510 93295.4154  19.2%  2758 2235s
  9572  3749 87086.6513   27  171 78295.0510 93114.6044  18.9%  2774 2270s
  9933  3725 88002.1412   25  293 78295.0510 93114.6044  18.9%  2795 2303s
 10293  3720 81041.9585   29  186 78295.0510 92783.7605  18.5%  2820 2338s
 10665  3703 79771.6458   28  194 78295.0510 92398.5660  18.0%  2852 2375s
 11057  3739 88082.4790   20  227 78295.0510 91783.7961  17.2%  2883 2408s
 11373  3753 81997.8315   24  203 78295.0510 91653.6089  17.1%  2929 2452s
 11789  3847 84824.6208   23  232 78295.0510 91653.6089  17.1%  2956 2491s
 12292  3954 80259.3647   24  241 78295.0510 91200.1834  16.5%  2968 2528s
 12654  4079 infeasible   26      78295.0510 91177.3398  16.5%  2988 2572s
 13145  4185 79240.3205   24  179 78295.0510 91045.2702  16.3%  3007 2616s
 13653  4315     cutoff   31      78295.0510 90849.1783  16.0%  3031 2663s
 14166  4408 infeasible   29      78295.0510 90770.9943  15.9%  3059 2717s
 14695  4539 88033.6068   22  299 78295.0510 90489.0534  15.6%  3085 2770s
 15236  4664 82606.2597   25  240 78295.0510 90482.2486  15.6%  3108 2821s
 15832  4799     cutoff   29      78295.0510 90309.4037  15.3%  3131 2872s
 16449  4952     cutoff   26      78295.0510 89993.5980  14.9%  3149 2927s
 17097  5069 78781.4711   28  228 78295.0510 89878.1943  14.8%  3169 2977s
 17749  5082 85819.7273   24  252 78295.0510 89797.1187  14.7%  3193 3032s
 17832  5170 85544.5413   25  221 78295.0510 89797.1187  14.7%  3198 3088s
 18260  5296     cutoff   27      78295.0510 89686.1078  14.5%  3214 3158s
 19065  5458 83765.8226   25  284 78295.0510 89388.4807  14.2%  3222 3219s
 19782  5598 84621.0582   23  298 78295.0510 89214.8701  13.9%  3246 3283s
 20589  5762 81818.5397   24  291 78295.0510 89052.0670  13.7%  3259 3351s
 21409  5922 86225.6242   19  347 78295.0510 88897.5123  13.5%  3268 3417s
 22251  6007 84782.6450   23  292 78295.0510 88707.8182  13.3%  3285 3490s
 23175  6114 80377.8599   30  174 78295.0510 88573.7330  13.1%  3291 3561s
 24087  6136 83020.5198   24  212 78295.0510 88356.1029  12.9%  3304 3600s

Cutting planes:
  MIR: 1052
  Mixing: 1
  Flow cover: 1964
  RLT: 24
  Relax-and-lift: 211

Explored 24662 nodes (81682206 simplex iterations) in 3600.05 seconds (6852.35 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 78295.1 78250.5 78160.5 ... 75933.8

Time limit reached
Best objective 7.829505100905e+04, best bound 8.821462314864e+04, gap 12.6695%
  WARNING: Time limit reached. Using best solution found (gap: 12.67%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = 78295.05, θ = 249204.34
  Upper Bound (UB) = 78295.05

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 249204.34
  [DEBUG]   ✓ Scenario 0: θ = 249204.34 ≤ Q = 249204.34 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 249204.34 ≤ Q = 249204.34 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 249204.34 ≤ Q = 249204.34 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 249204.34 ≤ Q = 249204.34 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 249204.34 ≤ Q = 249204.34 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 249204.34 ≤ Q = 249204.34 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x39d92a3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xfc626d5d
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.566543e+13
Presolve removed 2567 rows and 1867 columns
Presolve time: 0.01s
Presolved: 526 rows, 522 columns, 1475 nonzeros
Found heuristic solution: objective 7481802.6922
Variable types: 352 continuous, 170 integer (170 binary)

Root relaxation: objective -1.670499e+05, 252 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -167049.93    0  122 7481802.69 -167049.93   102%     -    0s
H    0     0                    -130688.4556 -167049.93  27.8%     -    0s
H    0     0                    -132093.8680 -167049.93  26.5%     -    0s
     0     0 -148958.73    0  121 -132093.87 -148958.73  12.8%     -    0s
H    0     0                    -146415.5796 -148935.88  1.72%     -    0s
H    0     0                    -146745.4221 -148935.88  1.49%     -    0s
H    0     0                    -146761.2045 -148935.88  1.48%     -    0s
H    0     0                    -147084.8194 -148935.88  1.26%     -    0s
     0     0 -148022.56    0   99 -147084.82 -148022.56  0.64%     -    0s
H    0     0                    -147458.0930 -148019.07  0.38%     -    0s
     0     0 -147938.57    0   56 -147458.09 -147938.57  0.33%     -    0s
     0     0 -147938.03    0   54 -147458.09 -147938.03  0.33%     -    0s
     0     0 -147925.33    0   55 -147458.09 -147925.33  0.32%     -    0s
H    0     0                    -147463.2648 -147925.33  0.31%     -    0s
     0     0 -147781.01    0   79 -147463.26 -147781.01  0.22%     -    0s
     0     0 -147780.98    0   78 -147463.26 -147780.98  0.22%     -    0s
     0     0 -147739.41    0   44 -147463.26 -147739.41  0.19%     -    0s
     0     0 -147737.01    0   44 -147463.26 -147737.01  0.19%     -    0s
     0     0 -147683.66    0   39 -147463.26 -147683.66  0.15%     -    0s
H    0     0                    -147497.3305 -147679.46  0.12%     -    0s
     0     0 -147679.46    0   39 -147497.33 -147679.46  0.12%     -    0s
     0     0 -147675.88    0   36 -147497.33 -147675.88  0.12%     -    0s
     0     0 -147663.61    0   36 -147497.33 -147663.61  0.11%     -    0s
H    0     0                    -147505.8739 -147663.61  0.11%     -    0s
     0     0 -147663.61    0   71 -147505.87 -147663.61  0.11%     -    0s
     0     0 -147663.61    0   61 -147505.87 -147663.61  0.11%     -    0s
     0     0 -147663.61    0   33 -147505.87 -147663.61  0.11%     -    0s
     0     0 -147645.84    0   20 -147505.87 -147645.84  0.09%     -    0s
     0     0 -147575.70    0   14 -147505.87 -147575.70  0.05%     -    0s
     0     0 -147575.28    0    8 -147505.87 -147575.28  0.05%     -    0s
     0     0 -147562.38    0   13 -147505.87 -147562.38  0.04%     -    0s
H    0     0                    -147541.2502 -147556.29  0.01%     -    0s
     0     0 -147556.29    0   12 -147541.25 -147556.29  0.01%     -    0s
     0     0 -147556.29    0   11 -147541.25 -147556.29  0.01%     -    0s
     0     0 -147555.92    0    6 -147541.25 -147555.92  0.01%     -    0s

Cutting planes:
  Gomory: 10
  Implied bound: 5
  MIR: 69
  Flow cover: 18
  Relax-and-lift: 2

Explored 1 nodes (1133 simplex iterations) in 0.13 seconds (0.07 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -147541 -147506 -147497 ... 7.4818e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.475412501703e+05, best bound -1.475559169624e+05, gap 0.0099%
  Subproblem solved in 0.16s
  Worst-case operational profit (Z_SP) = 236607.13
  Scenario: 36 demand increases, 24 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -147541.25
  [DEBUG]   S×d_nominal = 384148.38
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 384148.38 + -147541.25 = 236607.13
  [DEBUG]   Current θ from Master = 249204.34
  [DEBUG]   ⚠️  Z_SP ≤ θ by 12597.22 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 65697.84
  Lower Bound (LB) = 75334.45
  Gap (UB-LB) = 2960.6025, Absolute Gap = 2960.6025, Relative Gap = 0.037813
  Not converged yet (gap = 2960.60 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 36 increases, 24 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308241 nonzeros
Model fingerprint: 0x3266f9c4
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 45955 rows and 18655 columns
Presolve time: 2.19s
Presolved: 62458 rows, 27285 columns, 388314 nonzeros
Variable types: 25026 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -281170.8884
Found heuristic solution: objective -174612.9734

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 62458 rows, 27285 columns, 388314 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   21505   -1.7437685e+05   0.000000e+00   1.637040e+08      5s
   37755    3.7981113e+04   0.000000e+00   1.241091e+08     10s
   46983    5.6125356e+04   0.000000e+00   6.958071e+07     15s
   53199    7.0959872e+04   0.000000e+00   5.176738e+06     20s
   60434    7.9910430e+04   0.000000e+00   4.411195e+07     25s
   67496    8.5568443e+04   0.000000e+00   2.384434e+07     30s
   74605    9.2125282e+04   0.000000e+00   1.117749e+07     35s
Concurrent spin time: 10.02s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 1.186619e+05, 61370 iterations, 46.12 seconds (48.14 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 118661.921    0   90 -174612.97 118661.921   168%     -   49s
H    0     0                    -169143.6261 118661.921   170%     -   49s
H    0     0                    -100118.4159 118661.921   219%     -   49s
H    0     0                    -69465.78980 118661.921   271%     -   49s
H    0     0                    -68306.67224 118661.921   274%     -   49s
H    0     0                    7332.7567741 118661.921  1518%     -   49s
H    0     0                    46888.306894 118661.921   153%     -   49s
H    0     0                    57301.007584 118661.921   107%     -   50s
H    0     0                    57854.785528 118661.921   105%     -   50s
H    0     0                    58566.430563 118661.921   103%     -   50s
H    0     0                    61660.163780 118661.921  92.4%     -   50s
H    0     0                    62840.061366 118661.921  88.8%     -   50s
H    0     0                    73012.084702 118661.921  62.5%     -   50s
H    0     0                    74684.586838 118661.921  58.9%     -   50s
H    0     0                    74708.190989 118661.921  58.8%     -   50s
H    0     0                    74848.953918 118661.921  58.5%     -   50s
H    0     0                    75090.417268 118661.921  58.0%     -   51s
H    0     0                    75448.095863 118661.921  57.3%     -   51s
H    0     0                    75771.378128 112783.430  48.8%     -   71s
H    0     0                    75891.005924 112783.430  48.6%     -   73s
H    0     0                    76258.573027 112783.430  47.9%     -   73s
H    0     0                    76396.829525 112783.430  47.6%     -   73s
H    0     0                    76513.424296 112783.430  47.4%     -   73s
H    0     0                    76538.955370 112783.430  47.4%     -   73s
H    0     0                    76581.007278 112783.430  47.3%     -   73s
     0     0 112783.430    0  131 76581.0073 112783.430  47.3%     -   73s
     0     0 110897.145    0  132 76581.0073 110897.145  44.8%     -   84s
     0     0 110897.145    0  180 76581.0073 110897.145  44.8%     -   88s
     0     0 110897.145    0  174 76581.0073 110897.145  44.8%     -   90s
     0     0 110897.145    0  176 76581.0073 110897.145  44.8%     -   90s
     0     0 110897.145    0  176 76581.0073 110897.145  44.8%     -   90s
H    0     0                    76643.036414 107748.543  40.6%     -  109s
     0     0 107748.543    0  237 76643.0364 107748.543  40.6%     -  109s
     0     0 107248.498    0  250 76643.0364 107248.498  39.9%     -  119s
     0     0 107067.209    0  287 76643.0364 107067.209  39.7%     -  125s
     0     0 107049.345    0  258 76643.0364 107049.345  39.7%     -  126s
     0     0 107025.161    0  289 76643.0364 107025.161  39.6%     -  128s
     0     0 107020.087    0  291 76643.0364 107020.087  39.6%     -  129s
     0     0 107019.738    0  291 76643.0364 107019.738  39.6%     -  129s
     0     0 104778.203    0  273 76643.0364 104778.203  36.7%     -  153s
     0     0 103958.063    0  278 76643.0364 103958.063  35.6%     -  162s
     0     0 103783.376    0  284 76643.0364 103783.376  35.4%     -  166s
     0     0 103653.819    0  281 76643.0364 103653.819  35.2%     -  170s
     0     0 103619.097    0  280 76643.0364 103619.097  35.2%     -  172s
     0     0 103591.906    0  282 76643.0364 103591.906  35.2%     -  174s
     0     0 103583.358    0  279 76643.0364 103583.358  35.2%     -  175s
     0     0 103571.351    0  282 76643.0364 103571.351  35.1%     -  177s
     0     0 103542.790    0  287 76643.0364 103542.790  35.1%     -  178s
     0     0 103505.321    0  314 76643.0364 103505.321  35.0%     -  181s
     0     0 103495.004    0  314 76643.0364 103495.004  35.0%     -  182s
     0     0 103493.620    0  312 76643.0364 103493.620  35.0%     -  182s
     0     0 102942.586    0  375 76643.0364 102942.586  34.3%     -  193s
     0     0 102679.868    0  345 76643.0364 102679.868  34.0%     -  198s
     0     0 102615.992    0  383 76643.0364 102615.992  33.9%     -  200s
     0     0 102590.831    0  316 76643.0364 102590.831  33.9%     -  202s
     0     0 102558.065    0  351 76643.0364 102558.065  33.8%     -  204s
     0     0 102533.522    0  349 76643.0364 102533.522  33.8%     -  206s
     0     0 102530.079    0  350 76643.0364 102530.079  33.8%     -  207s
     0     0 102528.841    0  358 76643.0364 102528.841  33.8%     -  207s
     0     0 102361.931    0  312 76643.0364 102361.931  33.6%     -  212s
     0     0 102331.188    0  319 76643.0364 102331.188  33.5%     -  215s
     0     0 102289.504    0  319 76643.0364 102289.504  33.5%     -  217s
     0     0 102262.217    0  325 76643.0364 102262.217  33.4%     -  218s
     0     0 102251.751    0  319 76643.0364 102251.751  33.4%     -  219s
     0     0 102244.176    0  324 76643.0364 102244.176  33.4%     -  220s
     0     0 102236.809    0  328 76643.0364 102236.809  33.4%     -  221s
     0     0 102233.875    0  327 76643.0364 102233.875  33.4%     -  221s
     0     0 102231.848    0  328 76643.0364 102231.848  33.4%     -  222s
     0     0 102218.592    0  331 76643.0364 102218.592  33.4%     -  223s
     0     0 102217.861    0  327 76643.0364 102217.861  33.4%     -  223s
     0     0 102148.296    0  324 76643.0364 102148.296  33.3%     -  226s
     0     0 102120.691    0  328 76643.0364 102120.691  33.2%     -  232s
     0     0 102096.343    0  328 76643.0364 102096.343  33.2%     -  235s
     0     0 102084.674    0  333 76643.0364 102084.674  33.2%     -  236s
     0     0 102083.752    0  332 76643.0364 102083.752  33.2%     -  236s
     0     0 102059.673    0  326 76643.0364 102059.673  33.2%     -  239s
     0     0 102023.244    0  323 76643.0364 102023.244  33.1%     -  241s
     0     0 102016.154    0  330 76643.0364 102016.154  33.1%     -  242s
H    0     0                    76764.472598 102011.036  32.9%     -  243s
     0     0 102011.036    0  371 76764.4726 102011.036  32.9%     -  243s
     0     0 102007.769    0  331 76764.4726 102007.769  32.9%     -  243s
     0     0 102006.120    0  334 76764.4726 102006.120  32.9%     -  244s
     0     0 101982.579    0  325 76764.4726 101982.579  32.9%     -  247s
H    0     0                    76935.561523 101982.265  32.6%     -  253s
     0     0 101972.522    0  338 76935.5615 101972.522  32.5%     -  256s
     0     0 101967.427    0  325 76935.5615 101967.427  32.5%     -  257s
     0     0 101966.964    0  324 76935.5615 101966.964  32.5%     -  257s
     0     0 101937.277    0  322 76935.5615 101937.277  32.5%     -  259s
     0     0 101904.905    0  329 76935.5615 101904.905  32.5%     -  262s
     0     0 101886.355    0  332 76935.5615 101886.355  32.4%     -  263s
     0     0 101877.466    0  331 76935.5615 101877.466  32.4%     -  264s
     0     0 101875.964    0  334 76935.5615 101875.964  32.4%     -  264s
     0     0 101864.146    0  334 76935.5615 101864.146  32.4%     -  266s
     0     0 101858.631    0  337 76935.5615 101858.631  32.4%     -  267s
     0     0 101856.692    0  340 76935.5615 101856.692  32.4%     -  268s
     0     0 101850.507    0  339 76935.5615 101850.507  32.4%     -  269s
     0     0 101844.980    0  337 76935.5615 101844.980  32.4%     -  271s
     0     0 101842.434    0  341 76935.5615 101842.434  32.4%     -  271s
     0     0 101840.373    0  344 76935.5615 101840.373  32.4%     -  272s
     0     0 101839.870    0  342 76935.5615 101839.870  32.4%     -  272s
     0     0 101822.800    0  382 76935.5615 101822.800  32.3%     -  275s
     0     0 101819.817    0  386 76935.5615 101819.817  32.3%     -  275s
     0     0 101816.130    0  385 76935.5615 101816.130  32.3%     -  276s
     0     0 101813.825    0  386 76935.5615 101813.825  32.3%     -  277s
     0     0 101812.794    0  387 76935.5615 101812.794  32.3%     -  278s
     0     0 101804.976    0  342 76935.5615 101804.976  32.3%     -  279s
     0     0 101800.351    0  344 76935.5615 101800.351  32.3%     -  280s
     0     0 101796.766    0  338 76935.5615 101796.766  32.3%     -  281s
     0     0 101796.593    0  342 76935.5615 101796.593  32.3%     -  281s
     0     0 101778.811    0  326 76935.5615 101778.811  32.3%     -  283s
     0     0 101777.339    0  332 76935.5615 101777.339  32.3%     -  284s
     0     0 101774.521    0  340 76935.5615 101774.521  32.3%     -  285s
     0     0 101774.335    0  342 76935.5615 101774.335  32.3%     -  286s
     0     0 101771.333    0  338 76935.5615 101771.333  32.3%     -  287s
     0     0 101769.452    0  338 76935.5615 101769.452  32.3%     -  287s
     0     0 101769.404    0  342 76935.5615 101769.404  32.3%     -  289s
     0     0 101769.051    0  342 76935.5615 101769.051  32.3%     -  290s
H    0     0                    76940.898522 101769.051  32.3%     -  333s
     0     2 101769.051    0  342 76940.8985 101769.051  32.3%     -  334s
     1     4 101662.785    1  332 76940.8985 101767.973  32.3%  3164  341s
     3     8 101526.666    2  328 76940.8985 101661.149  32.1%  3687  347s
     7    16 101314.565    3  323 76940.8985 101522.855  31.9%  4472  357s
    15    32 100938.157    4  337 76940.8985 101314.439  31.7%  5810  369s
    31    48 99427.5121    5  314 76940.8985 100937.877  31.2%  8001  398s
H   47    80                    76970.207448 100937.877  31.1%  8463  410s
    79   144 98088.2291    7  294 76970.2074 100937.877  31.1%  7208  443s
   143   176 97951.4165    8  278 76970.2074 100937.877  31.1%  5252  454s
   175   263 97813.0298    9  284 76970.2074 100937.877  31.1%  4734  470s
   262   295 97901.6681    9  273 76970.2074 100937.877  31.1%  3898  484s
   294   333 97770.9087    9  271 76970.2074 100937.877  31.1%  3684  506s
   332   371 96804.5212   10  278 76970.2074 100937.877  31.1%  3615  519s
   370   411 97800.9053   10  285 76970.2074 100937.877  31.1%  3467  530s
   410   451 96687.5770   10  266 76970.2074 100937.877  31.1%  3343  539s
   450   491 97654.9716   10  274 76970.2074 100937.877  31.1%  3257  551s
   490   531 97782.9405   10  278 76970.2074 100937.877  31.1%  3240  563s
   530   570 97343.6539   10  269 76970.2074 100937.877  31.1%  3190  572s
   570   605 97671.3833   10  272 76970.2074 100937.877  31.1%  3094  587s
   609   635 97216.9635   10  269 76970.2074 100937.877  31.1%  3014  597s
   649   665 97390.7128   11  276 76970.2074 100937.877  31.1%  2920  614s
   685   696 97222.9942   11  269 76970.2074 100937.877  31.1%  2843  631s
   722   730 96569.3541   11  277 76970.2074 100937.877  31.1%  2798  639s
   756   767 96422.8243   11  262 76970.2074 100937.877  31.1%  2762  664s
   793   806 96775.1920   11  261 76970.2074 100937.877  31.1%  2754  676s
   832   856 96941.5907   11  265 76970.2074 100937.877  31.1%  2769  688s
   886   916 97008.6513   12  266 76970.2074 100937.877  31.1%  2692  705s
   950   967 97226.6152   12  279 76970.2074 100937.877  31.1%  2613  721s
H  974   967                    77003.694113 100937.877  31.1%  2582  721s
  1013  1029 95633.0160   11  256 77003.6941 100937.877  31.1%  2540  736s
H 1017  1029                    77046.765586 100937.877  31.0%  2532  736s
H 1054  1029                    77129.875599 100937.877  30.9%  2492  736s
H 1085  1029                    77249.214570 100937.877  30.7%  2492  736s
  1088  1193 96819.4349   13  250 77249.2146 100937.877  30.7%  2490  752s
  1264  1367 95805.4713   15  225 77249.2146 100937.877  30.7%  2319  769s
  1466  1415 95678.0857   13  242 77249.2146 100937.877  30.7%  2161  787s
H 1484  1415                    77371.116776 100937.877  30.5%  2146  787s
H 1485  1415                    77378.616366 100937.877  30.4%  2146  787s
  1536  1553 95590.4952   16  223 77378.6164 100937.877  30.4%  2115  805s
  1732  1663 93804.0467   16  196 77378.6164 100937.877  30.4%  2028  822s
  1940  1792 93835.1973   19  225 77378.6164 100937.877  30.4%  1954  840s
  2117  1863 95032.5444   17  262 77378.6164 100937.877  30.4%  1922  858s
H 2119  1863                    77421.687839 100937.877  30.4%  1923  858s
  2234  1996 94045.8480   20  208 77421.6878 100456.809  29.8%  1895  879s
  2417  2150 94034.1125   21  204 77421.6878 100455.158  29.8%  1876  897s
  2615  2310 91655.8841   23  172 77421.6878 100455.158  29.8%  1863  917s
  2819  2474 93514.6801   26  187 77421.6878 100185.573  29.4%  1841  933s
  3029  2647 92263.2572   31  198 77421.6878 99996.8325  29.2%  1820  953s
  3254  2821 91948.8349   36  204 77421.6878 99996.8325  29.2%  1797  975s
  3479  2822 79274.3136   26  342 77421.6878 99839.5044  29.0%  1776 1035s
  3481  2823 90633.0353   16   92 77421.6878 99839.5044  29.0%  1775 1093s
  3482  2824 95721.9061   14  342 77421.6878 99839.5044  29.0%  1775 1129s
  3483  2825 80586.2964   59  318 77421.6878 99839.5044  29.0%  1774 1153s
  3484  2825 97765.5766    9  292 77421.6878 99839.5044  29.0%  1774 1162s
  3485  2826 96955.4021   11  298 77421.6878 99839.5044  29.0%  1773 1168s
  3486  2827 86920.9640   41  318 77421.6878 99839.5044  29.0%  1773 1173s
  3487  2827 84151.5264   23  316 77421.6878 99839.5044  29.0%  1772 1179s
  3488  2828 83146.7536   50  325 77421.6878 99839.5044  29.0%  1771 1184s
  3489  2829 80576.5629   23  335 77421.6878 99839.5044  29.0%  1771 1188s
  3490  2829 94696.9618   17  330 77421.6878 99839.5044  29.0%  1770 1191s
  3493  2831 92876.2885   18  326 77421.6878 99839.5044  29.0%  1769 1199s
  3494  2832 91976.0576   20  362 77421.6878 99839.5044  29.0%  1768 1203s
  3495  2833 84335.2025   19  333 77421.6878 99839.5044  29.0%  1768 1209s
  3496  2833 85256.4115   77  340 77421.6878 99839.5044  29.0%  1767 1212s
  3498  2835 85774.5716   15  330 77421.6878 99839.5044  29.0%  1766 1216s
  3499  2835 86351.7844   37  411 77421.6878 99839.5044  29.0%  1766 1224s
  3500  2836 86978.4850   40  335 77421.6878 99839.5044  29.0%  1765 1227s
  3502  2837 83843.4394   26  370 77421.6878 99839.5044  29.0%  1764 1230s
  3504  2839 94534.8240   23  336 77421.6878 99839.5044  29.0%  1763 1238s
  3505  2839 85397.4466   33  346 77421.6878 99839.5044  29.0%  1763 1240s
  3507  2841 94820.3088   12  384 77421.6878 99839.5044  29.0%  1762 1249s
  3508  2841 89310.0156   35  386 77421.6878 99839.5044  29.0%  1761 1252s
  3509  2842 85695.3431   65  392 77421.6878 99839.5044  29.0%  1761 1255s
  3510  2843 97136.7907    9  432 77421.6878 99839.5044  29.0%  1760 1262s
  3512  2844 80279.6847   60  356 77421.6878 99839.5044  29.0%  1759 1269s
  3513  2845 81505.1522   34  348 77421.6878 99839.5044  29.0%  1759 1271s
  3514  2845 80717.0331   77  344 77421.6878 99839.5044  29.0%  1758 1275s
  3516  2847 78929.7928   74  349 77421.6878 99839.5044  29.0%  1757 1281s
  3518  2848 95568.2178   17  349 77421.6878 99839.5044  29.0%  1756 1286s
  3519  2849 81660.2907   43  349 77421.6878 99839.5044  29.0%  1756 1344s
  3520  2849 96512.8637   15  349 77421.6878 99839.5044  29.0%  1755 1385s
  3521  2853 99839.5044   13  342 77421.6878 99839.5044  29.0%  1810 1431s
  3523  2856 99839.5044   14  371 77421.6878 99839.5044  29.0%  1812 1454s
  3527  2863 99839.5044   15  312 77421.6878 99839.5044  29.0%  1817 1483s
  3535  2876 99839.5044   16  316 77421.6878 99839.5044  29.0%  1838 1510s
  3551  2892 95311.7885   17  310 77421.6878 99839.5044  29.0%  1899 1712s
  3572  2917 95999.4423   18  306 77421.6878 99839.5044  29.0%  1966 1734s
  3604  3012 95676.3050   19  304 77421.6878 99839.5044  29.0%  2020 1767s
  3710  3057 93982.9265   21  258 77421.6878 99839.5044  29.0%  2131 1789s
  3790  3060 90272.8276   21  245 77421.6878 99839.5044  29.0%  2165 1803s
  3824  3083 91534.7921   21  281 77421.6878 99839.5044  29.0%  2176 1819s
  3860  3105 93650.8326   22  259 77421.6878 99839.5044  29.0%  2192 1837s
  3898  3144 95172.5595   22  293 77421.6878 99839.5044  29.0%  2199 1848s
  3951  3178 88374.0776   22  246 77421.6878 99839.5044  29.0%  2206 1867s
  4021  3213 93800.4497   22  269 77421.6878 99839.5044  29.0%  2205 1894s
  4088  3246 92974.4070   23  254 77421.6878 99839.5044  29.0%  2207 1910s
  4155  3275 89236.5890   23  263 77421.6878 99839.5044  29.0%  2211 1928s
  4226  3308 92491.3553   24  245 77421.6878 99839.5044  29.0%  2206 1948s
  4296  3348 91966.7446   25  311 77421.6878 99839.5044  29.0%  2208 1963s
  4375  3378 91950.9202   26  314 77421.6878 99839.5044  29.0%  2207 1982s
  4459  3408 91698.0242   27  224 77421.6878 99839.5044  29.0%  2204 1999s
  4556  3426 91849.3056   26  306 77421.6878 99839.5044  29.0%  2202 2014s
H 4570  3277                    77461.226178 99839.5044  28.9%  2196 2014s
  4620  3324 90535.6077   28  204 77461.2262 99839.5044  28.9%  2199 2032s
  4713  3377 90346.1440   29  191 77461.2262 98960.7710  27.8%  2198 2050s
  4833  3396 89776.2392   29  173 77461.2262 98960.7710  27.8%  2185 2070s
  4964  3413 88818.2566   30  197 77461.2262 98960.7710  27.8%  2175 2088s
  5082  3440 88908.2226   30  163 77461.2262 98960.7710  27.8%  2173 2107s
  5185  3426 87524.2548   32  171 77461.2262 98053.3045  26.6%  2182 2129s
  5226  3443 84640.8799   32  153 77461.2262 98053.3045  26.6%  2187 2143s
H 5250  3299                    77653.464951 98053.3045  26.3%  2188 2143s
  5264  3375 87522.4719   33  153 77653.4650 98053.3045  26.3%  2194 2164s
  5396  3396 86836.4834   37  174 77653.4650 98053.3045  26.3%  2188 2190s
  5554  3370 86293.4101   39  163 77653.4650 98053.3045  26.3%  2175 2215s
  5587  3379 85657.2645   40  173 77653.4650 98053.3045  26.3%  2178 2235s
H 5603  3245                    77961.149990 98053.3045  25.8%  2177 2235s
  5627  3293     cutoff   38      77961.1500 98053.3045  25.8%  2182 2263s
  5790  3310 84916.8726   44  135 77961.1500 97406.2893  24.9%  2176 2286s
  5903  3365 84484.8317   50  147 77961.1500 96761.3296  24.1%  2194 2308s
  6025  3397 83503.0832   54  200 77961.1500 96761.3296  24.1%  2204 2331s
  6127  3490 83489.7696   55  129 77961.1500 96642.8452  24.0%  2218 2356s
  6298  3585     cutoff   58      77961.1500 96642.8452  24.0%  2212 2384s
  6508  3639     cutoff   64      77961.1500 96642.8452  24.0%  2199 2410s
H 6737  3465                    77962.100638 96642.8452  24.0%  2190 2430s
  6775  3575 79709.1116   76  117 77962.1006 96642.8452  24.0%  2195 2460s
  6974  3597 78210.8840   82  100 77962.1006 96158.7168  23.3%  2202 2488s
  7167  3651 94753.2758   19  243 77962.1006 96158.7168  23.3%  2207 2519s
  7376  3666 93797.8701   22  240 77962.1006 96158.7168  23.3%  2218 2551s
  7586  3707 89441.6253   27  170 77962.1006 95849.8658  22.9%  2234 2588s
  7816  3651 87618.6092   32  156 77962.1006 95686.4069  22.7%  2237 2611s
H 7826  3530                    78017.593841 95267.4218  22.1%  2240 2611s
H 7859  3403                    78118.980435 95174.2854  21.8%  2245 2611s
  7861  3526 85833.9826   33  191 78118.9804 95174.2854  21.8%  2246 2641s
  8068  3557 79304.8549   40  150 78118.9804 95174.2854  21.8%  2264 2673s
  8333  3583 86703.6640   27  369 78118.9804 95174.2854  21.8%  2264 2710s
  8567  3592     cutoff   30      78118.9804 95174.2854  21.8%  2283 2751s
  8817  3606     cutoff   31      78118.9804 95174.2854  21.8%  2300 2789s
  9039  3574     cutoff   34      78118.9804 95083.0260  21.7%  2326 2823s
  9216  3618 93014.6738   26  256 78118.9804 95083.0260  21.7%  2327 2864s
  9410  3696 87232.4162   32  173 78118.9804 94111.6063  20.5%  2346 2906s
  9785  3642 89707.9720   28  309 78118.9804 93962.8421  20.3%  2340 2953s
 10093  3730 80682.7924   35  198 78118.9804 93954.0883  20.3%  2355 3000s
 10525  3791     cutoff   35      78118.9804 93954.0883  20.3%  2348 3050s
 10935  3923     cutoff   22      78118.9804 93644.6331  19.9%  2349 3103s
 11345  4090 79956.2015   35  141 78118.9804 93599.4823  19.8%  2356 3152s
 11769  4261 87973.5661   30  242 78118.9804 93415.5829  19.6%  2358 3208s
 12395  4383 84453.9189   37  250 78118.9804 93325.4713  19.5%  2327 3260s
 12856  4587 87939.2889   26  366 78118.9804 93010.8703  19.1%  2329 3317s
 13303  4780     cutoff   33      78118.9804 92988.4247  19.0%  2339 3373s
 13725  5008 79478.8376   26  142 78118.9804 92544.3481  18.5%  2363 3426s
 14212  5272 84197.5069   32  229 78118.9804 92472.1680  18.4%  2371 3494s
 14764  5452 86927.0812   28  205 78118.9804 92293.8226  18.1%  2374 3555s
 15286  5518     cutoff   28      78118.9804 92251.5943  18.1%  2382 3600s

Cutting planes:
  Learned: 1
  MIR: 751
  Mixing: 1
  Flow cover: 1644
  RLT: 23
  Relax-and-lift: 183

Explored 15665 nodes (37695962 simplex iterations) in 3600.06 seconds (5952.76 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 78119 78017.6 77962.1 ... 77129.9

Time limit reached
Best objective 7.811898043482e+04, best bound 9.212037480912e+04, gap 17.9232%
  WARNING: Time limit reached. Using best solution found (gap: 17.92%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = 78118.98, θ = 249133.42
  Upper Bound (UB) = 78118.98

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 249133.42
  [DEBUG]   ✓ Scenario 0: θ = 249133.42 ≤ Q = 249133.42 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 249133.42 ≤ Q = 249133.42 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 249133.42 ≤ Q = 249133.42 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 249133.42 ≤ Q = 249133.42 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 249133.42 ≤ Q = 249133.42 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 249133.42 ≤ Q = 249133.42 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 249133.42 ≤ Q = 249133.42 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x5cb16680
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x5cb16680
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [3e-13, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [3e-15, 2e+02]
Found heuristic solution: objective 1.563405e+13
Presolve removed 2567 rows and 1867 columns
Presolve time: 0.01s
Presolved: 526 rows, 522 columns, 1475 nonzeros
Found heuristic solution: objective 7475908.5551
Variable types: 352 continuous, 170 integer (170 binary)

Root relaxation: objective -1.683214e+05, 279 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -168321.43    0  131 7475908.56 -168321.43   102%     -    0s
H    0     0                    -130428.7159 -168321.43  29.1%     -    0s
H    0     0                    -131519.4138 -168321.43  28.0%     -    0s
H    0     0                    -136169.4703 -168321.43  23.6%     -    0s
H    0     0                    -149012.4404 -168321.43  13.0%     -    0s
     0     0 -154895.85    0   84 -149012.44 -154895.85  3.95%     -    0s
H    0     0                    -152714.2892 -154862.42  1.41%     -    0s
H    0     0                    -153047.4472 -154862.42  1.19%     -    0s
H    0     0                    -153156.7192 -154862.42  1.11%     -    0s
H    0     0                    -153489.8773 -154862.42  0.89%     -    0s
     0     0 -154491.44    0   77 -153489.88 -154491.44  0.65%     -    0s
     0     0 -154482.94    0   77 -153489.88 -154482.94  0.65%     -    0s
     0     0 -154474.97    0   77 -153489.88 -154474.97  0.64%     -    0s
     0     0 -153847.34    0   44 -153489.88 -153847.34  0.23%     -    0s
     0     0 -153807.98    0   31 -153489.88 -153807.98  0.21%     -    0s
     0     0 -153786.48    0   28 -153489.88 -153786.48  0.19%     -    0s
     0     0 -153781.31    0   29 -153489.88 -153781.31  0.19%     -    0s
     0     0 -153598.66    0   17 -153489.88 -153598.66  0.07%     -    0s
     0     0 -153582.38    0   13 -153489.88 -153582.38  0.06%     -    0s
     0     0 -153507.95    0    4 -153489.88 -153507.95  0.01%     -    0s

Cutting planes:
  Gomory: 3
  Implied bound: 4
  MIR: 10
  Flow cover: 4
  RLT: 1
  Relax-and-lift: 1

Explored 1 nodes (786 simplex iterations) in 0.09 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -153490 -153349 -153157 ... 1.5634e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.534898772624e+05, best bound -1.535048498215e+05, gap 0.0098%
  Subproblem solved in 0.12s
  Worst-case operational profit (Z_SP) = 230658.50
  Scenario: 35 demand increases, 25 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -153489.88
  [DEBUG]   S×d_nominal = 384148.38
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 384148.38 + -153489.88 = 230658.50
  [DEBUG]   Current θ from Master = 249133.42
  [DEBUG]   ⚠️  Z_SP ≤ θ by 18474.92 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 59644.06
  Lower Bound (LB) = 75334.45
  Gap (UB-LB) = 2784.5319, Absolute Gap = 2784.5319, Relative Gap = 0.035645
  Not converged yet (gap = 2784.53 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 35 increases, 25 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351487 nonzeros
Model fingerprint: 0xcb42dc42
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 52520 rows and 21320 columns
Presolve time: 2.35s
Presolved: 71183 rows, 30860 columns, 442999 nonzeros
Variable types: 28601 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -281170.8884
Found heuristic solution: objective -174612.9734

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 71183 rows, 30860 columns, 442999 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   21649   -2.0419993e+05   0.000000e+00   2.451465e+06      5s
   37847    1.3900368e+04   0.000000e+00   1.630344e+09     10s
   47338    4.6546071e+04   0.000000e+00   4.478575e+08     15s
   55315    6.0608861e+04   0.000000e+00   5.816553e+06     20s
   62947    7.9873449e+04   0.000000e+00   2.091167e+07     25s
   72513    8.8923372e+04   0.000000e+00   2.358291e+06     30s
   78594    9.1250896e+04   0.000000e+00   1.755187e+07     35s
   85877    9.4812488e+04   0.000000e+00   8.034398e+07     40s
   92597    1.0074214e+05   0.000000e+00   8.625014e+06     45s
   99365    1.0428956e+05   0.000000e+00   2.543737e+06     50s
  106657    1.0696187e+05   0.000000e+00   6.721539e+05     55s
  112361    1.0730441e+05   0.000000e+00   4.509254e+05     60s
Concurrent spin time: 19.03s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 1.185693e+05, 79787 iterations, 74.46 seconds (83.20 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 118569.322    0   96 -174612.97 118569.322   168%     -   77s
H    0     0                    -161043.6304 118569.322   174%     -   77s
H    0     0                    -115213.8798 118569.322   203%     -   78s
H    0     0                    -114728.9628 118569.322   203%     -   78s
H    0     0                    -114504.0916 118569.322   204%     -   78s
H    0     0                    -113658.5801 118569.322   204%     -   78s
H    0     0                    -113034.5634 118569.322   205%     -   78s
H    0     0                    -2456.235313 118569.322  4927%     -   78s
H    0     0                    45999.894539 118569.322   158%     -   78s
H    0     0                    46144.686729 118569.322   157%     -   78s
H    0     0                    58143.984404 118569.322   104%     -   78s
H    0     0                    61783.383050 118569.322  91.9%     -   79s
H    0     0                    64859.272653 118569.322  82.8%     -   79s
H    0     0                    68365.309770 118569.322  73.4%     -   79s
H    0     0                    69345.509897 118569.322  71.0%     -   79s
H    0     0                    73611.373925 118569.322  61.1%     -   79s
H    0     0                    73809.769105 118569.322  60.6%     -   79s
H    0     0                    74338.594952 118569.322  59.5%     -   79s
H    0     0                    74684.586838 118569.322  58.8%     -   79s
H    0     0                    74751.263104 118569.322  58.6%     -   79s
H    0     0                    74778.629586 111938.429  49.7%     -  103s
H    0     0                    75528.774339 111938.429  48.2%     -  103s
H    0     0                    75747.365715 111938.429  47.8%     -  103s
H    0     0                    75827.598593 111938.429  47.6%     -  103s
H    0     0                    76010.229879 111938.429  47.3%     -  103s
H    0     0                    76045.453144 111938.429  47.2%     -  103s
H    0     0                    76191.522713 111938.429  46.9%     -  103s
H    0     0                    76238.488246 111938.429  46.8%     -  103s
H    0     0                    76241.358789 111938.429  46.8%     -  103s
H    0     0                    76327.306628 111938.429  46.7%     -  103s
     0     0 111938.429    0  132 76327.3066 111938.429  46.7%     -  103s
     0     0 109427.200    0  220 76327.3066 109427.200  43.4%     -  120s
     0     0 109427.200    0  172 76327.3066 109427.200  43.4%     -  125s
     0     0 109427.200    0  178 76327.3066 109427.200  43.4%     -  127s
     0     0 109427.200    0  179 76327.3066 109427.200  43.4%     -  129s
     0     0 109427.200    0  180 76327.3066 109427.200  43.4%     -  130s
     0     0 106612.424    0  276 76327.3066 106612.424  39.7%     -  154s
     0     0 106008.173    0  276 76327.3066 106008.173  38.9%     -  163s
     0     0 105941.996    0  281 76327.3066 105941.996  38.8%     -  168s
     0     0 105888.137    0  286 76327.3066 105888.137  38.7%     -  171s
     0     0 105839.741    0  283 76327.3066 105839.741  38.7%     -  173s
     0     0 105829.970    0  283 76327.3066 105829.970  38.7%     -  175s
     0     0 105826.815    0  288 76327.3066 105826.815  38.6%     -  176s
     0     0 105825.589    0  284 76327.3066 105825.589  38.6%     -  176s
     0     0 104054.858    0  288 76327.3066 104054.858  36.3%     -  208s
     0     0 103409.222    0  337 76327.3066 103409.222  35.5%     -  222s
     0     0 103120.493    0  298 76327.3066 103120.493  35.1%     -  229s
     0     0 102920.340    0  303 76327.3066 102920.340  34.8%     -  238s
     0     0 102835.296    0  303 76327.3066 102835.296  34.7%     -  243s
H    0     0                    76456.424605 102803.598  34.5%     -  246s
     0     0 102803.598    0  303 76456.4246 102803.598  34.5%     -  246s
     0     0 102777.607    0  301 76456.4246 102777.607  34.4%     -  248s
     0     0 102762.799    0  308 76456.4246 102762.799  34.4%     -  249s
     0     0 102744.552    0  305 76456.4246 102744.552  34.4%     -  251s
     0     0 102725.669    0  309 76456.4246 102725.669  34.4%     -  253s
     0     0 102721.042    0  307 76456.4246 102721.042  34.4%     -  255s
     0     0 102710.462    0  305 76456.4246 102710.462  34.3%     -  256s
     0     0 102706.987    0  310 76456.4246 102706.987  34.3%     -  257s
     0     0 102705.456    0  310 76456.4246 102705.456  34.3%     -  258s
     0     0 102414.681    0  310 76456.4246 102414.681  34.0%     -  270s
     0     0 102318.978    0  357 76456.4246 102318.978  33.8%     -  276s
     0     0 102282.742    0  393 76456.4246 102282.742  33.8%     -  278s
     0     0 102261.055    0  397 76456.4246 102261.055  33.8%     -  280s
     0     0 102254.348    0  357 76456.4246 102254.348  33.7%     -  282s
     0     0 102242.398    0  366 76456.4246 102242.398  33.7%     -  283s
     0     0 102233.378    0  361 76456.4246 102233.378  33.7%     -  284s
     0     0 102230.547    0  362 76456.4246 102230.547  33.7%     -  285s
     0     0 102228.834    0  364 76456.4246 102228.834  33.7%     -  285s
     0     0 102102.105    0  347 76456.4246 102102.105  33.5%     -  291s
     0     0 102015.754    0  320 76456.4246 102015.754  33.4%     -  295s
     0     0 101971.692    0  362 76456.4246 101971.692  33.4%     -  298s
     0     0 101953.485    0  363 76456.4246 101953.485  33.3%     -  300s
     0     0 101951.617    0  366 76456.4246 101951.617  33.3%     -  301s
     0     0 101890.584    0  336 76456.4246 101890.584  33.3%     -  306s
H    0     0                    76555.048677 101890.516  33.1%     -  312s
     0     0 101849.741    0  327 76555.0487 101849.741  33.0%     -  315s
     0     0 101835.230    0  332 76555.0487 101835.230  33.0%     -  318s
     0     0 101832.566    0  334 76555.0487 101832.566  33.0%     -  319s
     0     0 101831.224    0  335 76555.0487 101831.224  33.0%     -  319s
     0     0 101809.821    0  332 76555.0487 101809.821  33.0%     -  323s
     0     0 101804.853    0  330 76555.0487 101804.853  33.0%     -  325s
     0     0 101801.979    0  324 76555.0487 101801.979  33.0%     -  325s
     0     0 101800.749    0  325 76555.0487 101800.749  33.0%     -  326s
     0     0 101796.408    0  336 76555.0487 101796.408  33.0%     -  327s
     0     0 101795.100    0  332 76555.0487 101795.100  33.0%     -  336s
     0     0 101794.701    0  332 76555.0487 101794.701  33.0%     -  339s
     0     0 101793.587    0  391 76555.0487 101793.587  33.0%     -  341s
     0     0 101792.108    0  385 76555.0487 101792.108  33.0%     -  343s
     0     0 101785.889    0  385 76555.0487 101785.889  33.0%     -  345s
     0     2 101785.889    0  385 76555.0487 101785.889  33.0%     -  417s
     1     4 101679.582    1  370 76555.0487 101785.889  33.0%  3603  426s
     3     8 101464.481    2  363 76555.0487 101679.216  32.8%  4523  440s
     7    16 101402.353    3  357 76555.0487 101496.078  32.6%  6294  457s
    15    32 100733.415    4  373 76555.0487 101401.298  32.5%  8067  478s
    31    48 99159.2717    5  368 76555.0487 100731.167  31.6% 11694  513s
    47    80 98560.9031    6  357 76555.0487 100731.167  31.6% 11233  541s
    79   127 98439.6367    7  354 76555.0487 100731.167  31.6%  8612  589s
   126   240 98217.0158    9  347 76555.0487 100731.167  31.6%  6998  617s
   239   341 98292.9163    9  337 76555.0487 100731.167  31.6%  5305  635s
   340   412 97969.4294   11  341 76555.0487 100731.167  31.6%  4600  653s
   411   488 97251.3695   10  317 76555.0487 100731.167  31.6%  4450  667s
   487   575 97753.9621   12  334 76555.0487 100731.167  31.6%  4251  683s
   574   650 97233.1071   12  300 76555.0487 100731.167  31.6%  4000  700s
   651   721 97178.1933   12  309 76555.0487 100731.167  31.6%  3838  713s
   726   798 97510.2895   13  291 76555.0487 100731.167  31.6%  3714  726s
   813   827 97519.6040   13  340 76555.0487 100731.167  31.6%  3531  739s
   844   861 97085.3087   13  268 76555.0487 100731.167  31.6%  3506  754s
   888   889 96979.2583   13  312 76555.0487 100731.167  31.6%  3471  767s
   924   916 97060.4345   13  304 76555.0487 100731.167  31.6%  3418  780s
   962   942 96239.3910   13  282 76555.0487 100731.167  31.6%  3404  796s
   996   972 96985.6980   14  281 76555.0487 100731.167  31.6%  3367  810s
H 1003   972                    76581.007278 100731.167  31.5%  3352  810s
H 1025   972                    76714.819085 100731.167  31.3%  3332  810s
  1028  1099 95038.5236   14  280 76714.8191 100731.167  31.3%  3338  823s
  1185  1219 97227.4762   14  328 76714.8191 100731.167  31.3%  3050  840s
  1345  1333 96867.5864   14  271 76714.8191 100731.167  31.3%  2825  858s
  1505  1445 89445.1151   14  239 76714.8191 100731.167  31.3%  2677  875s
  1665  1557 94785.0925   15  273 76714.8191 100731.167  31.3%  2555  892s
  1818  1662 93168.2905   15  256 76714.8191 100731.167  31.3%  2474  915s
  1955  1800 94177.0426   16  266 76714.8191 100731.167  31.3%  2428  932s
  2114  1956 96203.1302   16  267 76714.8191 100731.167  31.3%  2362  950s
  2299  2035 92296.7325   17  268 76714.8191 100731.167  31.3%  2281  972s
H 2300  2035                    76723.677712 100731.167  31.3%  2280  972s
H 2322  2035                    76844.235360 100547.564  30.8%  2272  972s
H 2374  2035                    76911.762324 100547.564  30.7%  2255  972s
  2400  2189 93461.4181   19  224 76911.7623 100547.564  30.7%  2249  995s
  2602  2343 93311.2851   20  225 76911.7623 100547.564  30.7%  2173 1013s
  2798  2513 92560.9475   24  251 76911.7623 100493.331  30.7%  2118 1033s
  3018  2680 92422.8226   25  249 76911.7623 100493.331  30.7%  2060 1056s
  3235  2818 91970.2791   28  247 76911.7623 100339.118  30.5%  2021 1083s
  3457  2845 91383.0326   31  202 76911.7623 100339.118  30.5%  1985 1103s
  3504  2909 91225.6237   32  200 76911.7623 100275.496  30.4%  1990 1124s
H 3590  2909                    76940.898522 100275.496  30.3%  1995 1143s
  3591  2910 87736.2795   22  385 76940.8985 100275.496  30.3%  1995 1202s
  3593  2911 98806.5933    9   96 76940.8985 100275.496  30.3%  1994 1283s
  3594  2912 82660.7446   51  283 76940.8985 100275.496  30.3%  1993 1338s
  3595  2913 98149.3622   10  322 76940.8985 100275.496  30.3%  1993 1369s
  3596  2913 81935.0723   90  332 76940.8985 100275.496  30.3%  1992 1382s
  3597  2914 84759.2354   61  301 76940.8985 100275.496  30.3%  1991 1395s
  3598  2915 85555.6762   48  366 76940.8985 100275.496  30.3%  1991 1409s
  3599  2915 82061.3721   55  334 76940.8985 100275.496  30.3%  1990 1414s
  3600  2916 83953.7805   16  373 76940.8985 100275.496  30.3%  1990 1417s
  3601  2917 79816.5030   95  368 76940.8985 100275.496  30.3%  1989 1421s
  3603  2918 80700.8677   61  369 76940.8985 100275.496  30.3%  1988 1427s
  3604  2919 79663.4385   98  327 76940.8985 100275.496  30.3%  1988 1431s
  3605  2919 85256.3299   47  367 76940.8985 100275.496  30.3%  1987 1435s
  3606  2920 92373.7136   17  363 76940.8985 100275.496  30.3%  1987 1441s
  3609  2922 95586.6063   11  331 76940.8985 100275.496  30.3%  1985 1446s
  3610  2923 84229.0908   16  334 76940.8985 100275.496  30.3%  1984 1454s
  3611  2923 84895.7070   33  338 76940.8985 100275.496  30.3%  1984 1455s
  3614  2925 89009.6985   21  342 76940.8985 100275.496  30.3%  1982 1462s
  3615  2926 95233.8128   24  339 76940.8985 100275.496  30.3%  1982 1466s
  3617  2927 80880.7404   83  338 76940.8985 100275.496  30.3%  1980 1477s
  3619  2929 90233.6500   17  340 76940.8985 100275.496  30.3%  1979 1485s
  3621  2930 93403.9235   19  386 76940.8985 100275.496  30.3%  1978 1490s
  3622  2931 88349.0169   37  339 76940.8985 100275.496  30.3%  1978 1497s
  3624  2932 94617.9362   14  347 76940.8985 100275.496  30.3%  1977 1505s
  3626  2933 93473.5594   11  347 76940.8985 100275.496  30.3%  1976 1512s
  3627  2934 84159.5765   19  347 76940.8985 100275.496  30.3%  1975 1577s
H 3627  2786                    76964.146584 100275.496  30.3%  1975 1629s
  3628  2787 89161.3895   26  347 76964.1466 100275.496  30.3%  1974 1633s
H 3628  2649                    76970.207448 100275.496  30.3%  2035 1703s
  3629  2650 100275.496   15  379 76970.2074 100275.496  30.3%  2036 1727s
  3631  2654 100275.496   16  406 76970.2074 100275.496  30.3%  2039 1760s
  3635  2660 100275.496   17  399 76970.2074 100275.496  30.3%  2044 1792s
  3643  2674 100275.496   18  411 76970.2074 100275.496  30.3%  2061 1829s
  3659  2686 94822.4223   19  271 76970.2074 100275.496  30.3%  2128 1878s
  3677  2712 96093.4235   20  387 76970.2074 100275.496  30.3%  2167 1912s
  3709  2846 95813.1319   21  374 76970.2074 100275.496  30.3%  2252 1947s
  3853  2859 95592.1362   25  384 76970.2074 100275.496  30.3%  2297 1968s
  3914  2905 95574.4463   23  369 76970.2074 100275.496  30.3%  2338 1987s
  3986  2923 92627.9237   26  369 76970.2074 100275.496  30.3%  2371 2008s
  4043  2935 92909.6394   26  381 76970.2074 100275.496  30.3%  2403 2030s
  4076  2961 92784.7484   25  325 76970.2074 100133.516  30.1%  2421 2046s
  4115  2980 95195.1237   25  289 76970.2074 100133.516  30.1%  2456 2060s
  4147  3008 94869.8335   26  286 76970.2074 100133.516  30.1%  2476 2076s
  4187  3024 94655.6836   27  276 76970.2074 100133.516  30.1%  2491 2092s
  4222  3045 86212.3125   34  209 76970.2074 100133.516  30.1%  2502 2106s
  4262  3064 93136.6761   28  251 76970.2074 100133.516  30.1%  2513 2118s
  4302  3078 92514.9882   29  257 76970.2074 99884.4936  29.8%  2523 2134s
  4347  3093 91596.1360   30  230 76970.2074 99884.4936  29.8%  2532 2149s
  4391  3111 91200.1830   31  223 76970.2074 99884.4936  29.8%  2539 2171s
  4440  3132 91016.7987   32  221 76970.2074 99884.4936  29.8%  2552 2192s
  4493  3155 89990.9362   33  200 76970.2074 99884.4936  29.8%  2577 2208s
  4549  3172 86938.4097   33  186 76970.2074 99884.4936  29.8%  2619 2227s
  4622  3173 89540.0558   34  184 76970.2074 99884.4936  29.8%  2640 2259s
  4694  3183 87457.2863   34  183 76970.2074 99884.4936  29.8%  2659 2280s
  4772  3226 87966.1519   35  233 76970.2074 99884.4936  29.8%  2687 2303s
  4870  3255 85722.6072   35  165 76970.2074 99884.4936  29.8%  2707 2334s
  4969  3286 87088.5866   36  205 76970.2074 99884.4936  29.8%  2738 2355s
  5077  3310 84312.8801   36  135 76970.2074 99884.4936  29.8%  2754 2375s
  5197  3342 86964.4631   37  189 76970.2074 99884.4936  29.8%  2755 2400s
  5332  3353 83672.4260   38  101 76970.2074 99234.3651  28.9%  2761 2427s
  5464  3369 84065.3610   41  162 76970.2074 99234.3651  28.9%  2772 2454s
  5599  3383 82180.5730   43  123 76970.2074 99234.3651  28.9%  2796 2480s
  5731  3361 81738.8063   46  133 76970.2074 98678.1445  28.2%  2824 2504s
  5768  3372 infeasible   44      76970.2074 98678.1445  28.2%  2846 2522s
  5806  3388 81541.7175   48  114 76970.2074 98678.1445  28.2%  2871 2544s
  5845  3434 80614.7526   49  144 76970.2074 98678.1445  28.2%  2881 2570s
  5937  3478 78734.1336   51  120 76970.2074 98320.1462  27.7%  2897 2606s
  6078  3492 95079.6405   22  322 76970.2074 98320.1462  27.7%  2921 2637s
  6239  3513 91548.3630   24  301 76970.2074 98208.3613  27.6%  2953 2670s
  6368  3569 88771.1661   27  266 76970.2074 98208.3613  27.6%  3010 2700s
  6505  3645 84922.4202   30  234 76970.2074 98208.3613  27.6%  3060 2735s
  6685  3707 82874.7893   34  267 76970.2074 98208.3613  27.6%  3083 2776s
  6870  3797 80005.6562   39  143 76970.2074 97239.2248  26.3%  3116 2812s
  7102  3842 77123.7682   45  118 76970.2074 97239.2248  26.3%  3132 2854s
  7364  3866 88643.3142   24  281 76970.2074 97041.0302  26.1%  3142 2891s
  7622  3939 84926.3378   28  207 76970.2074 96860.5196  25.8%  3161 2939s
  7869  3967 79344.2516   35   95 76970.2074 96860.5196  25.8%  3185 2979s
  8048  4007 92586.4541   23  300 76970.2074 96475.9680  25.3%  3230 3023s
  8188  4025 86075.2519   24  304 76970.2074 96097.0537  24.8%  3274 3063s
  8341  4114 83712.2973   24  301 76970.2074 95973.4664  24.7%  3300 3113s
H 8532  3917                    77003.694113 95973.4664  24.6%  3331 3113s
  8560  4041 82212.2149   26  287 77003.6941 95973.4664  24.6%  3339 3171s
  8784  4111     cutoff   27      77003.6941 95804.6017  24.4%  3409 3216s
  9022  4153 90550.5490   21  282 77003.6941 95804.6017  24.4%  3477 3265s
  9328  4171 86091.8739   28  152 77003.6941 95804.6017  24.4%  3525 3315s
  9612  4140 83976.7048   35  110 77003.6941 95598.1879  24.1%  3583 3364s
H 9639  4002                    77024.081136 95598.1879  24.1%  3586 3364s
H 9640  3875                    77116.071478 95598.1879  24.0%  3587 3364s
H 9723  3680                    77406.050013 95566.1600  23.5%  3596 3364s
  9793  3783 84766.1730   25  299 77406.0500 95460.1347  23.3%  3602 3422s
 10027  3847 78716.0994   34  169 77406.0500 95424.2621  23.3%  3686 3478s
 10278  3998 88313.9519   30  245 77406.0500 95214.3225  23.0%  3755 3537s
 10547  4164 85416.9308   35  109 77406.0500 95214.3225  23.0%  3839 3591s
 10907  4182 83107.2875   43  134 77406.0500 95214.3225  23.0%  3891 3600s

Cutting planes:
  Learned: 1
  MIR: 817
  Mixing: 2
  Flow cover: 1678
  RLT: 24
  Relax-and-lift: 175

Explored 10963 nodes (42906059 simplex iterations) in 3600.04 seconds (6283.60 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 77406.1 77116.1 77024.1 ... 76723.7

Time limit reached
Best objective 7.740605001345e+04, best bound 9.521432250910e+04, gap 23.0063%
  WARNING: Time limit reached. Using best solution found (gap: 23.01%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.05s
  Master Objective (UB) = 77406.05, θ = 249273.83
  Upper Bound (UB) = 77406.05

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 249273.83
  [DEBUG]   ✓ Scenario 0: θ = 249273.83 ≤ Q = 249273.83 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 249273.83 ≤ Q = 249273.83 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 249273.83 ≤ Q = 249273.83 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 249273.83 ≤ Q = 249273.83 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 249273.83 ≤ Q = 249273.83 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 249273.83 ≤ Q = 249273.83 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 249273.83 ≤ Q = 249273.83 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 249273.83 ≤ Q = 249273.83 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x2f2bb361
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xd0d44c9f
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [7e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [9e-14, 2e+02]
Found heuristic solution: objective 1.564591e+13
Presolve removed 2568 rows and 1859 columns
Presolve time: 0.01s
Presolved: 525 rows, 530 columns, 1484 nonzeros
Found heuristic solution: objective 8188443.4375
Variable types: 360 continuous, 170 integer (170 binary)

Root relaxation: objective -1.683818e+05, 252 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -168381.78    0  129 8188443.44 -168381.78   102%     -    0s
H    0     0                    -134013.7656 -168381.78  25.6%     -    0s
H    0     0                    -136043.6662 -168381.78  23.8%     -    0s
H    0     0                    -136063.5653 -151311.85  11.2%     -    0s
H    0     0                    -143088.9985 -151311.85  5.75%     -    0s
     0     0 -151311.85    0   81 -143089.00 -151311.85  5.75%     -    0s
H    0     0                    -149643.0358 -151303.82  1.11%     -    0s
H    0     0                    -149965.0754 -151303.82  0.89%     -    0s
H    0     0                    -149982.1165 -151273.91  0.86%     -    0s
     0     0 -151273.91    0   76 -149982.12 -151273.91  0.86%     -    0s
     0     0 -151266.84    0   81 -149982.12 -151266.84  0.86%     -    0s
     0     0 -150806.26    0   44 -149982.12 -150806.26  0.55%     -    0s
H    0     0                    -150297.4504 -150793.87  0.33%     -    0s
H    0     0                    -150527.6856 -150793.87  0.18%     -    0s
     0     0 -150788.21    0   33 -150527.69 -150788.21  0.17%     -    0s
     0     0 -150766.18    0   34 -150527.69 -150766.18  0.16%     -    0s
H    0     0                    -150661.5766 -150766.18  0.07%     -    0s
     0     0 -150748.11    0   30 -150661.58 -150748.11  0.06%     -    0s
     0     0 -150748.11    0   33 -150661.58 -150748.11  0.06%     -    0s
H    0     0                    -150683.9416 -150748.11  0.04%     -    0s
     0     0 -150737.01    0   27 -150683.94 -150737.01  0.04%     -    0s
H    0     0                    -150726.9499 -150734.15  0.00%     -    0s

Cutting planes:
  Gomory: 2
  Implied bound: 1
  MIR: 23
  Flow cover: 16

Explored 1 nodes (667 simplex iterations) in 0.12 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -150727 -150684 -150662 ... -143089

Optimal solution found (tolerance 1.00e-04)
Best objective -1.507269499187e+05, best bound -1.507341521759e+05, gap 0.0048%
  Subproblem solved in 0.15s
  Worst-case operational profit (Z_SP) = 233421.43
  Scenario: 21 demand increases, 39 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -150726.95
  [DEBUG]   S×d_nominal = 384148.38
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 384148.38 + -150726.95 = 233421.43
  [DEBUG]   Current θ from Master = 249273.83
  [DEBUG]   ⚠️  Z_SP ≤ θ by 15852.40 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 61553.65
  Lower Bound (LB) = 75334.45
  Gap (UB-LB) = 2071.6015, Absolute Gap = 2071.6015, Relative Gap = 0.026763
  Not converged yet (gap = 2071.60 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 21 increases, 39 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394733 nonzeros
Model fingerprint: 0x18e886ff
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 59085 rows and 23985 columns
Presolve time: 2.63s
Presolved: 79908 rows, 34435 columns, 488900 nonzeros
Variable types: 32176 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -281170.8884
Found heuristic solution: objective -174612.9734

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 79908 rows, 34435 columns, 488900 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   16814   -2.3343899e+05   0.000000e+00   5.564294e+06      5s
   38011   -1.1273967e+04   0.000000e+00   3.544159e+09     10s
   49402    4.2112023e+04   0.000000e+00   1.158022e+10     15s
   57696    6.6818302e+04   0.000000e+00   5.739956e+07     20s
   64758    7.6790165e+04   0.000000e+00   1.957517e+09     25s
   71791    8.7688832e+04   0.000000e+00   1.123103e+08     30s
   77354    9.0234540e+04   0.000000e+00   2.654692e+07     35s
   81836    9.1131510e+04   0.000000e+00   9.920903e+07     40s
   85565    9.1507044e+04   0.000000e+00   1.424323e+07     45s
   89696    9.5155122e+04   0.000000e+00   7.689742e+07     50s
   94912    9.7885100e+04   0.000000e+00   1.602187e+07     55s
Concurrent spin time: 16.98s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 1.188230e+05, 80526 iterations, 72.94 seconds (77.54 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 118823.019    0   91 -174612.97 118823.019   168%     -   76s
H    0     0                    -167189.6947 118823.019   171%     -   76s
H    0     0                    -86559.36582 118823.019   237%     -   77s
H    0     0                    -72488.86339 118823.019   264%     -   77s
H    0     0                    -72237.56210 118823.019   264%     -   77s
H    0     0                    -14248.52475 118823.019   934%     -   77s
H    0     0                    43173.185331 118823.019   175%     -   77s
H    0     0                    57316.611421 118823.019   107%     -   78s
H    0     0                    58576.645881 118823.019   103%     -   78s
H    0     0                    63547.206358 118823.019  87.0%     -   78s
H    0     0                    65140.658135 118823.019  82.4%     -   79s
H    0     0                    67006.101831 118823.019  77.3%     -   79s
H    0     0                    71643.456834 118823.019  65.9%     -   79s
H    0     0                    74309.871372 118823.019  59.9%     -   79s
H    0     0                    74508.659315 118823.019  59.5%     -   79s
H    0     0                    74715.197754 118823.019  59.0%     -   79s
     0     0 113029.312    0  192 74715.1978 113029.312  51.3%     -  115s
H    0     0                    74848.953918 113029.199  51.0%     -  117s
H    0     0                    75060.938429 113029.199  50.6%     -  117s
H    0     0                    75259.838336 113029.199  50.2%     -  117s
H    0     0                    75342.889498 113029.199  50.0%     -  117s
H    0     0                    75455.698295 113029.199  49.8%     -  117s
H    0     0                    75601.698760 113029.199  49.5%     -  117s
     0     0 110964.854    0  275 75601.6988 110964.854  46.8%     -  133s
     0     0 110964.854    0  304 75601.6988 110964.854  46.8%     -  139s
     0     0 110964.854    0  301 75601.6988 110964.854  46.8%     -  140s
     0     0 110964.854    0  301 75601.6988 110964.854  46.8%     -  140s
H    0     0                    75681.638393 107658.427  42.3%     -  169s
H    0     0                    75752.531388 107658.427  42.1%     -  169s
H    0     0                    75922.835716 107658.427  41.8%     -  169s
H    0     0                    75940.059480 107658.427  41.8%     -  169s
H    0     0                    75946.199740 107658.427  41.8%     -  169s
H    0     0                    76025.273084 107658.427  41.6%     -  169s
     0     0 107658.427    0  214 76025.2731 107658.427  41.6%     -  169s
     0     0 107000.066    0  245 76025.2731 107000.066  40.7%     -  188s
     0     0 106769.387    0  353 76025.2731 106769.387  40.4%     -  197s
     0     0 106586.783    0  347 76025.2731 106586.783  40.2%     -  208s
     0     0 106529.984    0  264 76025.2731 106529.984  40.1%     -  215s
     0     0 106477.824    0  256 76025.2731 106477.824  40.1%     -  220s
     0     0 106424.366    0  256 76025.2731 106424.366  40.0%     -  226s
     0     0 106401.054    0  385 76025.2731 106401.054  40.0%     -  229s
     0     0 106385.357    0  387 76025.2731 106385.357  39.9%     -  232s
     0     0 106366.274    0  390 76025.2731 106366.274  39.9%     -  236s
     0     0 106313.977    0  394 76025.2731 106313.977  39.8%     -  239s
     0     0 106306.999    0  394 76025.2731 106306.999  39.8%     -  241s
     0     0 106306.590    0  396 76025.2731 106306.590  39.8%     -  242s
H    0     0                    76106.419414 104358.063  37.1%     -  294s
H    0     0                    76245.707186 104358.063  36.9%     -  294s
H    0     0                    76374.061064 104358.063  36.6%     -  294s
     0     0 104358.063    0  326 76374.0611 104358.063  36.6%     -  294s
     0     0 103976.507    0  355 76374.0611 103976.507  36.1%     -  313s
     0     0 103848.715    0  350 76374.0611 103848.715  36.0%     -  322s
     0     0 103735.741    0  348 76374.0611 103735.741  35.8%     -  332s
     0     0 103688.918    0  343 76374.0611 103688.918  35.8%     -  339s
     0     0 103665.070    0  342 76374.0611 103665.070  35.7%     -  344s
     0     0 103612.923    0  340 76374.0611 103612.923  35.7%     -  349s
     0     0 103559.434    0  339 76374.0611 103559.434  35.6%     -  358s
     0     0 103551.779    0  375 76374.0611 103551.779  35.6%     -  361s
     0     0 103527.420    0  343 76374.0611 103527.420  35.6%     -  365s
     0     0 103516.970    0  343 76374.0611 103516.970  35.5%     -  367s
     0     0 103515.119    0  343 76374.0611 103515.119  35.5%     -  368s
     0     0 103461.302    0  337 76374.0611 103461.302  35.5%     -  372s
     0     0 103412.012    0  382 76374.0611 103412.012  35.4%     -  377s
     0     0 103405.689    0  382 76374.0611 103405.689  35.4%     -  379s
     0     0 103398.016    0  385 76374.0611 103398.016  35.4%     -  382s
     0     0 103393.644    0  389 76374.0611 103393.644  35.4%     -  384s
     0     0 103393.432    0  389 76374.0611 103393.432  35.4%     -  385s
     0     0 102933.186    0  311 76374.0611 102933.186  34.8%     -  414s
     0     0 102782.214    0  321 76374.0611 102782.214  34.6%     -  423s
     0     0 102708.915    0  317 76374.0611 102708.915  34.5%     -  428s
     0     0 102569.739    0  314 76374.0611 102569.739  34.3%     -  435s
     0     0 102556.358    0  365 76374.0611 102556.358  34.3%     -  438s
     0     0 102547.165    0  372 76374.0611 102547.165  34.3%     -  440s
H    0     0                    76419.987010 102526.424  34.2%     -  442s
H    0     0                    76434.466298 102526.424  34.1%     -  442s
H    0     0                    76473.512540 102526.424  34.1%     -  442s
     0     0 102526.424    0  320 76473.5125 102526.424  34.1%     -  442s
     0     0 102490.855    0  327 76473.5125 102490.855  34.0%     -  445s
     0     0 102472.242    0  330 76473.5125 102472.242  34.0%     -  447s
     0     0 102456.334    0  326 76473.5125 102456.334  34.0%     -  450s
     0     0 102444.760    0  325 76473.5125 102444.760  34.0%     -  453s
     0     0 102438.597    0  330 76473.5125 102438.597  34.0%     -  455s
     0     0 102435.441    0  332 76473.5125 102435.441  33.9%     -  456s
     0     0 102432.239    0  331 76473.5125 102432.239  33.9%     -  458s
     0     0 102430.659    0  329 76473.5125 102430.659  33.9%     -  459s
     0     0 102359.947    0  330 76473.5125 102359.947  33.9%     -  465s
H    0     0                    76494.752782 102359.107  33.8%     -  466s
     0     0 102297.393    0  407 76494.7528 102297.393  33.7%     -  470s
     0     0 102281.191    0  372 76494.7528 102281.191  33.7%     -  472s
     0     0 102271.611    0  362 76494.7528 102271.611  33.7%     -  474s
     0     0 102266.720    0  324 76494.7528 102266.720  33.7%     -  475s
     0     0 102263.654    0  415 76494.7528 102263.654  33.7%     -  477s
     0     0 102263.051    0  325 76494.7528 102263.051  33.7%     -  478s
     0     0 102172.232    0  421 76494.7528 102172.232  33.6%     -  485s
     0     0 102119.280    0  329 76494.7528 102119.280  33.5%     -  492s
     0     0 102104.095    0  325 76494.7528 102104.095  33.5%     -  494s
     0     0 102095.041    0  333 76494.7528 102095.041  33.5%     -  496s
     0     0 102090.624    0  377 76494.7528 102090.624  33.5%     -  497s
     0     0 102077.114    0  376 76494.7528 102077.114  33.4%     -  500s
     0     0 102072.558    0  328 76494.7528 102072.558  33.4%     -  501s
     0     0 102070.679    0  330 76494.7528 102070.679  33.4%     -  502s
     0     0 101983.641    0  328 76494.7528 101983.641  33.3%     -  509s
     0     0 101933.889    0  468 76494.7528 101933.889  33.3%     -  514s
     0     0 101905.840    0  471 76494.7528 101905.840  33.2%     -  519s
     0     0 101898.750    0  484 76494.7528 101898.750  33.2%     -  521s
     0     0 101896.578    0  484 76494.7528 101896.578  33.2%     -  523s
     0     0 101895.504    0  482 76494.7528 101895.504  33.2%     -  524s
     0     0 101876.629    0  355 76494.7528 101876.629  33.2%     -  527s
H    0     0                    76499.627254 101875.106  33.2%     -  536s
     0     0 101864.553    0  360 76499.6273 101864.553  33.2%     -  538s
     0     0 101862.885    0  360 76499.6273 101862.885  33.2%     -  539s
     0     0 101806.000    0  497 76499.6273 101806.000  33.1%     -  545s
     0     0 101762.371    0  425 76499.6273 101762.371  33.0%     -  550s
     0     0 101749.414    0  429 76499.6273 101749.414  33.0%     -  552s
     0     0 101738.045    0  427 76499.6273 101738.045  33.0%     -  555s
     0     0 101729.592    0  427 76499.6273 101729.592  33.0%     -  557s
     0     0 101725.304    0  506 76499.6273 101725.304  33.0%     -  559s
     0     0 101722.822    0  430 76499.6273 101722.822  33.0%     -  560s
     0     0 101719.959    0  434 76499.6273 101719.959  33.0%     -  561s
     0     0 101718.009    0  430 76499.6273 101718.009  33.0%     -  562s
     0     0 101701.689    0  411 76499.6273 101701.689  32.9%     -  566s
     0     0 101680.031    0  413 76499.6273 101680.031  32.9%     -  572s
     0     0 101677.382    0  414 76499.6273 101677.382  32.9%     -  573s
     0     0 101676.683    0  412 76499.6273 101676.683  32.9%     -  573s
     0     0 101638.625    0  345 76499.6273 101638.625  32.9%     -  578s
     0     0 101630.216    0  349 76499.6273 101630.216  32.9%     -  581s
     0     0 101623.076    0  343 76499.6273 101623.076  32.8%     -  582s
     0     0 101618.399    0  347 76499.6273 101618.399  32.8%     -  584s
     0     0 101610.538    0  345 76499.6273 101610.538  32.8%     -  586s
     0     0 101607.788    0  383 76499.6273 101607.788  32.8%     -  587s
     0     0 101605.618    0  344 76499.6273 101605.618  32.8%     -  587s
     0     0 101550.710    0  336 76499.6273 101550.710  32.7%     -  591s
     0     0 101539.483    0  339 76499.6273 101539.483  32.7%     -  601s
     0     0 101535.173    0  340 76499.6273 101535.173  32.7%     -  602s
     0     0 101533.595    0  341 76499.6273 101533.595  32.7%     -  603s
     0     0 101525.706    0  334 76499.6273 101525.706  32.7%     -  607s
     0     0 101521.558    0  336 76499.6273 101521.558  32.7%     -  609s
     0     0 101520.238    0  338 76499.6273 101520.238  32.7%     -  610s
     0     0 101518.478    0  341 76499.6273 101518.478  32.7%     -  611s
H    0     0                    76939.841498 101518.250  31.9%     -  656s
H    0     0                    77197.644008 101518.250  31.5%     -  663s
     0     0 101515.459    0  342 77197.6440 101515.459  31.5%     -  672s
     0     0 101513.961    0  348 77197.6440 101513.961  31.5%     -  672s
     0     0 101512.593    0  347 77197.6440 101512.593  31.5%     -  674s
     0     0 101512.374    0  348 77197.6440 101512.374  31.5%     -  675s
     0     0 101511.905    0  345 77197.6440 101511.905  31.5%     -  676s
     0     0 101510.688    0  345 77197.6440 101510.688  31.5%     -  678s
H    0     0                    77262.278833 101505.631  31.4%     -  762s
     0     2 101505.631    0  345 77262.2788 101505.631  31.4%     -  774s
     1     4 101295.949    1  331 77262.2788 101505.631  31.4%  4826  780s
     3     8 101113.260    2  339 77262.2788 101464.746  31.3%  3784  799s
     7    14 100235.173    3  308 77262.2788 101113.026  30.9%  6096  824s
    13    28 97622.7351    4  308 77262.2788 101113.026  30.9% 10797  843s
    27    42 99778.6006    4  324 77262.2788 100786.182  30.4% 14305  897s
    41    74 98766.2295    5  364 77262.2788 100786.182  30.4% 13694  967s
    73   167 98576.3950    6  316 77262.2788 100281.786  29.8% 12594 1016s
   166   271 98387.6666    9  306 77262.2788 100281.786  29.8%  8275 1044s
   270   348 98175.4888   12  342 77262.2788 100281.786  29.8%  6251 1066s
   347   419 97700.7162   14  332 77262.2788 100281.786  29.8%  5621 1085s
   418   487 97438.7037   16  318 77262.2788 100281.786  29.8%  5164 1104s
   486   561 97315.5656   18  303 77262.2788 100281.786  29.8%  4868 1127s
   560   628 96938.3389   19  252 77262.2788 100281.786  29.8%  4584 1154s
   627   655 92847.2932   20  251 77262.2788 100281.786  29.8%  4395 1177s
   654   685 92659.9061   21  262 77262.2788 100281.786  29.8%  4346 1193s
   684   714 91580.5911   22  253 77262.2788 100281.786  29.8%  4334 1208s
H  695   714                    77300.258962 100281.786  29.7%  4314 1208s
   713   801 90824.2042   23  254 77300.2590 100281.786  29.7%  4282 1228s
   802   876 90754.1797   24  252 77300.2590 100281.786  29.7%  4000 1246s
   881   950 89482.2801   26  245 77300.2590 100281.786  29.7%  3847 1263s
   963  1046 91089.7898   32  226 77300.2590 100281.786  29.7%  3730 1283s
  1063  1082 89265.5147   27  259 77300.2590 100281.786  29.7%  3545 1307s
  1121  1139 89232.8808   28  259 77300.2590 100281.786  29.7%  3463 1332s
  1200  1163 89132.5696   29  257 77300.2590 100281.786  29.7%  3383 1357s
  1238  1193 89043.7923   30  302 77300.2590 100281.786  29.7%  3421 1379s
  1272  1246 88502.4464   31  245 77300.2590 100281.786  29.7%  3464 1399s
  1331  1323 88253.5518   32  247 77300.2590 100281.786  29.7%  3433 1419s
  1422  1417 88211.4027   33  238 77300.2590 100281.786  29.7%  3344 1440s
  1528  1509 87918.3882   34  246 77300.2590 100281.786  29.7%  3232 1463s
  1634  1610 87819.5774   35  236 77300.2590 100281.786  29.7%  3163 1484s
  1747  1655 85181.6943   36  243 77300.2590 100281.786  29.7%  3092 1499s
  1798  1748 85133.1799   37  244 77300.2590 100281.786  29.7%  3059 1520s
  1911  1825 79944.6753   38  222 77300.2590 100281.786  29.7%  2966 1553s
  2035  1911     cutoff   39      77300.2590 100281.786  29.7%  2924 1580s
  2188  1991     cutoff   39      77300.2590 99728.5128  29.0%  2865 1608s
  2324  2125 82801.2591   39  216 77300.2590 99673.3092  28.9%  2834 1636s
  2492  2208 82633.7165   40  262 77300.2590 99357.2502  28.5%  2783 1667s
  2617  2313 80565.9708   41  257 77300.2590 99357.2502  28.5%  2782 1696s
  2752  2450 80078.0549   42  263 77300.2590 99357.2502  28.5%  2783 1725s
  2925  2577 79982.0215   43  256 77300.2590 99357.2502  28.5%  2738 1756s
  3106  2719 79181.4262   45  197 77300.2590 99301.9535  28.5%  2714 1790s
  3315  2884     cutoff   50      77300.2590 99208.8533  28.3%  2675 1826s
  3537  2885 84396.4160   37  345 77300.2590 99154.0510  28.3%  2631 1943s
  3539  2886 94608.8935   21   96 77300.2590 99154.0510  28.3%  2629 2043s
  3540  2887 96726.6858   16  341 77300.2590 99154.0510  28.3%  2629 2123s
  3541  2888 90790.1058   38  349 77300.2590 99154.0510  28.3%  2628 2187s
  3542  2888 90297.8147   25  364 77300.2590 99154.0510  28.3%  2627 2217s
  3543  2889 80586.6567   57  395 77300.2590 99154.0510  28.3%  2627 2236s
  3544  2890 85927.4835   42  399 77300.2590 99154.0510  28.3%  2626 2250s
  3545  2890 86112.7159   72  368 77300.2590 99154.0510  28.3%  2625 2264s
  3546  2891 90931.1031   33  428 77300.2590 99154.0510  28.3%  2624 2272s
  3547  2892 91110.5884   54  369 77300.2590 99154.0510  28.3%  2624 2277s
  3548  2892 87243.0864   30  337 77300.2590 99154.0510  28.3%  2623 2284s
  3549  2893 90969.8910   35  377 77300.2590 99154.0510  28.3%  2622 2289s
  3550  2894 81619.5063   87  379 77300.2590 99154.0510  28.3%  2621 2292s
  3551  2894 88739.2812   39  340 77300.2590 99154.0510  28.3%  2621 2297s
  3552  2895 81647.9925  114  391 77300.2590 99154.0510  28.3%  2620 2302s
  3553  2896 87650.1521   48  401 77300.2590 99154.0510  28.3%  2619 2317s
  3554  2896 89332.8424   34  414 77300.2590 99154.0510  28.3%  2618 2322s
  3555  2897 80031.0713   61  351 77300.2590 99154.0510  28.3%  2618 2326s
  3557  2898 80718.5777   51  354 77300.2590 99154.0510  28.3%  2616 2334s
  3558  2899 93143.3124   27  387 77300.2590 99154.0510  28.3%  2615 2348s
  3559  2900 89155.3893   28  334 77300.2590 99154.0510  28.3%  2615 2354s
  3560  2900 88234.4999   65  391 77300.2590 99154.0510  28.3%  2614 2360s
  3561  2901 97937.4748   11  344 77300.2590 99154.0510  28.3%  2613 2368s
  3562  2902 82103.6017   45  465 77300.2590 99154.0510  28.3%  2612 2376s
  3563  2902 94044.9800   12  443 77300.2590 99154.0510  28.3%  2612 2388s
  3564  2903 81754.8358  113  356 77300.2590 99154.0510  28.3%  2611 2395s
  3566  2904 91154.4635   29  354 77300.2590 99154.0510  28.3%  2610 2416s
  3567  2905 91239.0108   31  354 77300.2590 99154.0510  28.3%  2609 2421s
  3568  2906 84969.1348   42  447 77300.2590 99154.0510  28.3%  2608 2432s
  3569  2906 92396.7749   28  413 77300.2590 99154.0510  28.3%  2607 2436s
  3570  2907 94545.2472   22  408 77300.2590 99154.0510  28.3%  2607 2448s
  3571  2908 98568.3157   15  411 77300.2590 99154.0510  28.3%  2606 2455s
  3572  2908 83582.2752   53  362 77300.2590 99154.0510  28.3%  2605 2463s
  3573  2909 84159.0657   54  364 77300.2590 99154.0510  28.3%  2604 2467s
  3574  2910 84744.9487   46  364 77300.2590 99154.0510  28.3%  2604 2474s
  3575  2910 90330.8418   20  364 77300.2590 99154.0510  28.3%  2603 2558s
  3576  2911 81016.5188   88  364 77300.2590 99154.0510  28.3%  2602 2647s
H 3576  2766                    77461.226178 99154.0510  28.0%  2697 2745s
  3577  2768 99154.0510   14  453 77461.2262 99154.0510  28.0%  2699 2798s
  3579  2771 99154.0510   15  356 77461.2262 99154.0510  28.0%  2704 2865s
  3583  2778 99154.0510   16  446 77461.2262 99154.0510  28.0%  2711 2928s
  3591  2791 99154.0510   17  356 77461.2262 99154.0510  28.0%  2744 2984s
  3607  2802 96667.1024   18  332 77461.2262 99154.0510  28.0%  2812 3061s
  3623  2828 97002.1182   19  320 77461.2262 99154.0510  28.0%  2915 3107s
  3655  2935 94920.1807   20  305 77461.2262 99154.0510  28.0%  2952 3166s
  3772  2971 94281.1374   24  296 77461.2262 99154.0510  28.0%  3108 3197s
  3847  3017 94514.3888   24  299 77461.2262 99154.0510  28.0%  3131 3226s
  3918  3071 94452.8273   24  279 77461.2262 99154.0510  28.0%  3148 3251s
  3998  3116 93968.0659   25  255 77461.2262 99154.0510  28.0%  3157 3274s
  4079  3121 93596.0985   26  254 77461.2262 99154.0510  28.0%  3151 3293s
  4111  3143 93383.4615   27  245 77461.2262 99154.0510  28.0%  3159 3311s
  4143  3167 89093.1189   28  249 77461.2262 99154.0510  28.0%  3164 3329s
  4180  3186 91947.4570   28  214 77461.2262 99154.0510  28.0%  3162 3350s
  4220  3200 91813.9166   29  205 77461.2262 99154.0510  28.0%  3154 3368s
  4258  3214 91405.3629   30  199 77461.2262 99154.0510  28.0%  3153 3391s
  4295  3224 90063.7155   31  193 77461.2262 99154.0510  28.0%  3147 3413s
  4337  3236 91644.9387   30  205 77461.2262 99154.0510  28.0%  3142 3439s
  4373  3249 91136.0550   31  195 77461.2262 99154.0510  28.0%  3140 3458s
  4412  3267 90431.7989   32  178 77461.2262 99154.0510  28.0%  3145 3483s
  4455  3290 85841.4830   32  184 77461.2262 99154.0510  28.0%  3151 3505s
  4509  3306 89856.6709   33  180 77461.2262 99154.0510  28.0%  3143 3533s
  4568  3299 89568.9750   34  222 77461.2262 99154.0510  28.0%  3130 3560s
  4635  3315 89416.5312   35  230 77461.2262 99154.0510  28.0%  3116 3595s
  4695  3302 89266.7081   35  220 77461.2262 99154.0510  28.0%  3112 3600s

Cutting planes:
  Learned: 1
  Projected implied bound: 40
  MIR: 889
  Mixing: 1
  Flow cover: 1553
  RLT: 29
  Relax-and-lift: 203

Explored 4725 nodes (15080289 simplex iterations) in 3600.06 seconds (5206.59 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 77461.2 77300.3 77262.3 ... 76420

Time limit reached
Best objective 7.746122617835e+04, best bound 9.915405097466e+04, gap 28.0048%
  WARNING: Time limit reached. Using best solution found (gap: 28.00%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = 77461.23, θ = 248743.79
  Upper Bound (UB) = 77461.23

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 248743.79
  [DEBUG]   ✓ Scenario 0: θ = 248743.79 ≤ Q = 248743.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 248743.79 ≤ Q = 248743.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 248743.79 ≤ Q = 248743.79 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 248743.79 ≤ Q = 248743.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 248743.79 ≤ Q = 248743.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 248743.79 ≤ Q = 248743.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 248743.79 ≤ Q = 248743.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 248743.79 ≤ Q = 248743.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 248743.79 ≤ Q = 248743.79 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x3c0465a3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x3c0465a3
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.567008e+13
Presolve removed 2567 rows and 1858 columns
Presolve time: 0.01s
Presolved: 526 rows, 531 columns, 1484 nonzeros
Found heuristic solution: objective 8230039.1788
Variable types: 361 continuous, 170 integer (170 binary)

Root relaxation: objective -1.689121e+05, 253 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -168912.10    0  131 8230039.18 -168912.10   102%     -    0s
H    0     0                    -129935.4824 -168912.10  30.0%     -    0s
H    0     0                    -131128.6074 -168912.10  28.8%     -    0s
H    0     0                    -131710.4984 -168912.10  28.2%     -    0s
H    0     0                    -144548.2110 -168912.10  16.9%     -    0s
     0     0 -151481.63    0   52 -144548.21 -151481.63  4.80%     -    0s
H    0     0                    -150153.3538 -151402.47  0.83%     -    0s
H    0     0                    -150462.0470 -151402.47  0.63%     -    0s
H    0     0                    -150672.5902 -151147.21  0.32%     -    0s
     0     0 -151147.21    0   32 -150672.59 -151147.21  0.32%     -    0s
     0     0 -151070.52    0   25 -150672.59 -151070.52  0.26%     -    0s
     0     0 -151034.26    0   18 -150672.59 -151034.26  0.24%     -    0s
     0     0 -151023.14    0   16 -150672.59 -151023.14  0.23%     -    0s
     0     0 -151022.61    0   16 -150672.59 -151022.61  0.23%     -    0s
     0     0 -150780.34    0    6 -150672.59 -150780.34  0.07%     -    0s
     0     0 -150780.34    0   12 -150672.59 -150780.34  0.07%     -    0s
H    0     0                    -150688.5427 -150780.34  0.06%     -    0s
     0     0 -150739.16    0    4 -150688.54 -150739.16  0.03%     -    0s
H    0     0                    -150730.1548 -150736.68  0.00%     -    0s

Cutting planes:
  Gomory: 2
  Implied bound: 4
  MIR: 6
  Flow cover: 6

Explored 1 nodes (584 simplex iterations) in 0.11 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -150730 -150689 -150673 ... -129935

Optimal solution found (tolerance 1.00e-04)
Best objective -1.507301547889e+05, best bound -1.507366817518e+05, gap 0.0043%
  Subproblem solved in 0.14s
  Worst-case operational profit (Z_SP) = 233418.22
  Scenario: 18 demand increases, 42 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -150730.15
  [DEBUG]   S×d_nominal = 384148.38
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 384148.38 + -150730.15 = 233418.22
  [DEBUG]   Current θ from Master = 248743.79
  [DEBUG]   ⚠️  Z_SP ≤ θ by 15325.57 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 62135.66
  Lower Bound (LB) = 75334.45
  Gap (UB-LB) = 2126.7776, Absolute Gap = 2126.7776, Relative Gap = 0.027456
  Not converged yet (gap = 2126.78 > ε = 200)

  [DEBUG] Adding NEW scenario 9 to Master Problem...
  [DEBUG] New scenario pattern: 18 increases, 42 decreases
    [DEBUG] Scenario 9 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 9 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 9]
    [DEBUG]   - Total constraints in model: 154283
    [DEBUG]   - Total variables in model: 64660
  [DEBUG] Total scenarios in Master: 10
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 10
================================================================================
[Iteration 10] Solving Master Problem...
  Current scenarios in Master: 10
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 154283 rows, 64660 columns and 437979 nonzeros
Model fingerprint: 0x32ad87fd
Variable types: 62401 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 65650 rows and 26650 columns
Presolve time: 2.72s
Presolved: 88633 rows, 38010 columns, 538529 nonzeros
Variable types: 35751 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -294025.5928
Found heuristic solution: objective -174612.9734

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.30s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.857e+06
 Factor NZ  : 8.387e+06 (roughly 120 MB of memory)
 Factor Ops : 1.465e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.85650293e+07  1.74984986e+08  1.35e+05 2.33e+01  9.01e+04     5s
   1  -1.40459926e+07  1.58860362e+08  9.45e+04 1.02e+02  6.22e+04     5s
   2  -7.76406864e+06  1.30954988e+08  5.12e+04 3.76e+01  3.48e+04     5s
   3  -1.19579477e+06  9.69408999e+07  3.89e+03 2.52e+00  3.15e+03     5s
   4  -6.67963787e+05  4.48115349e+07  5.67e+02 2.48e-01  6.09e+02     5s
   5  -4.93764455e+05  2.90703854e+07  1.81e+02 1.46e-01  2.78e+02     5s
   6  -4.01914185e+05  2.17311090e+07  1.12e+02 1.02e-01  1.90e+02     5s
   7  -2.79483555e+05  1.57105029e+07  6.04e+01 7.00e-02  1.24e+02     5s
   8  -1.68020568e+05  1.02292861e+07  2.58e+01 4.25e-02  7.25e+01     6s
   9  -1.00421219e+05  7.76536184e+06  1.32e+01 3.12e-02  5.19e+01     6s
  10  -6.29763147e+04  3.35558922e+06  7.59e+00 1.23e-02  2.21e+01     6s
  11   1.54962328e+04  6.39819724e+05  1.20e+00 1.84e-03  3.88e+00     6s
  12   3.88466854e+04  3.49511189e+05  8.05e-01 1.37e-03  1.93e+00     6s
  13   4.88285703e+04  2.59160916e+05  6.28e-01 9.10e-04  1.30e+00     6s
  14   5.76872108e+04  2.13917087e+05  5.15e-01 1.43e-03  9.68e-01     6s
  15   6.45523863e+04  1.97994084e+05  4.38e-01 1.25e-03  8.26e-01     6s
  16   7.45451169e+04  1.85009862e+05  3.29e-01 1.37e-03  6.83e-01     6s
  17   8.67993774e+04  1.67181990e+05  2.21e-01 1.62e-03  4.97e-01     6s
  18   9.41898118e+04  1.50640084e+05  1.61e-01 1.87e-03  3.49e-01     6s
  19   9.55694855e+04  1.46476335e+05  1.50e-01 1.62e-03  3.15e-01     7s
  20   9.63622970e+04  1.44983482e+05  1.44e-01 1.55e-03  3.00e-01     7s
  21   9.82654704e+04  1.39862685e+05  1.30e-01 1.36e-03  2.57e-01     7s
  22   1.00066850e+05  1.37451008e+05  1.16e-01 1.18e-03  2.31e-01     7s
  23   1.03341417e+05  1.32880452e+05  9.24e-02 9.44e-04  1.82e-01     7s
  24   1.06290540e+05  1.29257471e+05  7.25e-02 1.13e-03  1.42e-01     7s
  25   1.10755070e+05  1.24142218e+05  4.44e-02 2.38e-03  8.27e-02     7s
  26   1.13858566e+05  1.21045207e+05  2.64e-02 2.72e-03  4.44e-02     7s
  27   1.15197619e+05  1.20455299e+05  1.87e-02 1.99e-03  3.25e-02     7s
  28   1.16630462e+05  1.20037795e+05  1.09e-02 1.44e-03  2.10e-02     7s
  29   1.17324313e+05  1.19646972e+05  7.47e-03 9.39e-04  1.43e-02     8s
  30   1.17832230e+05  1.19406638e+05  4.96e-03 6.44e-04  9.72e-03     8s
  31   1.18236448e+05  1.19255611e+05  3.02e-03 4.49e-04  6.29e-03     8s
  32   1.18502624e+05  1.19068945e+05  1.83e-03 2.06e-04  3.50e-03     8s
  33   1.18719475e+05  1.18994100e+05  8.34e-04 1.12e-04  1.70e-03     8s
  34   1.18803291e+05  1.18950695e+05  4.66e-04 5.18e-05  9.10e-04     8s
  35   1.18838377e+05  1.18944750e+05  3.12e-04 4.43e-05  6.57e-04     8s
  36   1.18849921e+05  1.18943307e+05  2.62e-04 4.24e-05  5.76e-04     8s
  37   1.18851992e+05  1.18939050e+05  2.53e-04 3.69e-05  5.37e-04     8s
  38   1.18860791e+05  1.18935859e+05  2.13e-04 3.27e-05  4.63e-04     9s
  39   1.18890851e+05  1.18928654e+05  8.52e-05 2.31e-05  2.33e-04     9s
  40   1.18898015e+05  1.18919755e+05  5.44e-05 1.09e-05  1.34e-04     9s
  41   1.18903941e+05  1.18917891e+05  2.95e-05 8.39e-06  8.60e-05     9s
  42   1.18908827e+05  1.18912933e+05  9.78e-06 1.78e-06  2.53e-05     9s
  43   1.18910737e+05  1.18911840e+05  2.78e-06 7.82e-07  6.81e-06     9s
  44   1.18910882e+05  1.18911730e+05  2.25e-06 4.84e-07  5.24e-06     9s
  45   1.18911192e+05  1.18911670e+05  1.11e-06 3.40e-07  2.95e-06     9s
  46   1.18911508e+05  1.18911530e+05  5.15e-08 1.94e-07  1.34e-07    10s
  47   1.18911518e+05  1.18911528e+05  1.26e-06 7.83e-09  6.41e-08    10s
  48   1.18911521e+05  1.18911528e+05  1.67e-06 7.04e-08  4.41e-08    10s
  49   1.18911524e+05  1.18911528e+05  1.37e-06 8.35e-08  2.27e-08    10s
  50   1.18911525e+05  1.18911528e+05  1.70e-06 9.67e-08  1.47e-08    10s
  51   1.18911527e+05  1.18911528e+05  2.79e-06 4.19e-08  6.47e-09    10s

Barrier solved model in 51 iterations and 10.28 seconds (7.88 work units)
Optimal objective 1.18911527e+05


Root crossover log...

   81969 DPushes remaining with DInf 0.0000000e+00                10s
    5461 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                17s

   21396 PPushes remaining with PInf 1.1612600e-04                17s
      32 PPushes remaining with PInf 2.1465432e-03                20s
       0 PPushes remaining with PInf 0.0000000e+00                20s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.3118793e+05     20s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   68135    1.1891153e+05   0.000000e+00   1.311879e+05     20s
   71009    1.1891153e+05   0.000000e+00   0.000000e+00     25s
   71009    1.1891153e+05   0.000000e+00   0.000000e+00     25s
Concurrent spin time: 7.94s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 1.189115e+05, 71009 iterations, 29.28 seconds (32.14 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 118911.528    0  109 -174612.97 118911.528   168%     -   33s
H    0     0                    -167189.6947 118911.528   171%     -   33s
H    0     0                    -145915.2790 118911.528   181%     -   34s
H    0     0                    -141262.5004 118911.528   184%     -   34s
H    0     0                    -140497.1950 118911.528   185%     -   35s
H    0     0                    -140077.0707 118911.528   185%     -   35s
H    0     0                    -139813.1915 118911.528   185%     -   35s
H    0     0                    -13770.31831 118911.528   964%     -   35s
H    0     0                    57909.431147 118911.528   105%     -   35s
H    0     0                    69728.977547 118911.528  70.5%     -   37s
H    0     0                    71500.211513 118911.528  66.3%     -   37s
H    0     0                    74732.695414 118911.528  59.1%     -   37s
H    0     0                    75307.471851 118911.528  57.9%     -   37s
H    0     0                    75350.100205 118911.528  57.8%     -   37s
H    0     0                    75799.810226 113306.646  49.5%     -  130s
H    0     0                    76164.993094 113306.646  48.8%     -  130s
H    0     0                    76468.389261 113306.646  48.2%     -  130s
     0     0 113275.278    0  281 76468.3893 113275.278  48.1%     -  130s
     0     0 112000.181    0  313 76468.3893 112000.181  46.5%     -  175s
     0     0 112000.181    0  309 76468.3893 112000.181  46.5%     -  192s
     0     0 112000.181    0  305 76468.3893 112000.181  46.5%     -  202s
     0     0 112000.181    0  313 76468.3893 112000.181  46.5%     -  204s
     0     0 112000.063    0  306 76468.3893 112000.063  46.5%     -  206s
     0     0 112000.059    0  306 76468.3893 112000.059  46.5%     -  207s
     0     0 107865.534    0  211 76468.3893 107865.534  41.1%     -  309s
     0     0 107215.963    0  242 76468.3893 107215.963  40.2%     -  358s
     0     0 106849.576    0  233 76468.3893 106849.576  39.7%     -  395s
     0     0 106615.904    0  289 76468.3893 106615.904  39.4%     -  424s
     0     0 106500.956    0  341 76468.3893 106500.956  39.3%     -  440s
     0     0 106482.349    0  345 76468.3893 106482.349  39.3%     -  458s
     0     0 106461.530    0  337 76468.3893 106461.530  39.2%     -  467s
     0     0 106450.192    0  345 76468.3893 106450.192  39.2%     -  474s
     0     0 106444.963    0  352 76468.3893 106444.963  39.2%     -  477s
     0     0 106440.160    0  239 76468.3893 106440.160  39.2%     -  481s
     0     0 106432.908    0  236 76468.3893 106432.908  39.2%     -  485s
     0     0 106430.649    0  236 76468.3893 106430.649  39.2%     -  488s
     0     0 106430.143    0  236 76468.3893 106430.143  39.2%     -  491s
     0     0 105636.334    0  369 76468.3893 105636.334  38.1%     -  582s
     0     0 105282.210    0  372 76468.3893 105282.210  37.7%     -  638s
     0     0 105105.385    0  370 76468.3893 105105.385  37.4%     -  692s
     0     0 105048.773    0  371 76468.3893 105048.773  37.4%     -  716s
     0     0 104993.797    0  373 76468.3893 104993.797  37.3%     -  728s
     0     0 104956.654    0  370 76468.3893 104956.654  37.3%     -  739s
     0     0 104950.098    0  431 76468.3893 104950.098  37.2%     -  742s
     0     0 104942.430    0  420 76468.3893 104942.430  37.2%     -  746s
     0     0 104934.193    0  433 76468.3893 104934.193  37.2%     -  749s
     0     0 104920.990    0  386 76468.3893 104920.990  37.2%     -  755s
     0     0 104911.766    0  390 76468.3893 104911.766  37.2%     -  762s
     0     0 104909.875    0  390 76468.3893 104909.875  37.2%     -  764s
     0     0 104902.115    0  387 76468.3893 104902.115  37.2%     -  769s
     0     0 104892.714    0  437 76468.3893 104892.714  37.2%     -  773s
     0     0 104891.310    0  442 76468.3893 104891.310  37.2%     -  775s
     0     0 103629.597    0  301 76468.3893 103629.597  35.5%     -  854s
     0     0 103208.482    0  307 76468.3893 103208.482  35.0%     -  885s
     0     0 103097.546    0  355 76468.3893 103097.546  34.8%     -  902s
     0     0 103026.460    0  349 76468.3893 103026.460  34.7%     -  926s
     0     0 102947.235    0  362 76468.3893 102947.235  34.6%     -  952s
     0     0 102937.601    0  368 76468.3893 102937.601  34.6%     -  959s
     0     0 102924.510    0  365 76468.3893 102924.510  34.6%     -  968s
     0     0 102909.185    0  362 76468.3893 102909.185  34.6%     -  978s
     0     0 102892.154    0  438 76468.3893 102892.154  34.6%     -  992s
     0     0 102874.988    0  444 76468.3893 102874.988  34.5%     - 1004s
     0     0 102859.425    0  371 76468.3893 102859.425  34.5%     - 1011s
     0     0 102854.171    0  315 76468.3893 102854.171  34.5%     - 1016s
     0     0 102845.593    0  318 76468.3893 102845.593  34.5%     - 1025s
     0     0 102842.546    0  320 76468.3893 102842.546  34.5%     - 1028s
     0     0 102822.295    0  373 76468.3893 102822.295  34.5%     - 1035s
     0     0 102816.793    0  382 76468.3893 102816.793  34.5%     - 1039s
     0     0 102814.963    0  320 76468.3893 102814.963  34.5%     - 1043s
     0     0 102436.989    0  493 76468.3893 102436.989  34.0%     - 1073s
     0     0 102322.377    0  447 76468.3893 102322.377  33.8%     - 1088s
     0     0 102252.822    0  454 76468.3893 102252.822  33.7%     - 1101s
     0     0 102237.612    0  500 76468.3893 102237.612  33.7%     - 1108s
     0     0 102224.522    0  509 76468.3893 102224.522  33.7%     - 1116s
     0     0 102221.185    0  507 76468.3893 102221.185  33.7%     - 1120s
     0     0 102220.059    0  506 76468.3893 102220.059  33.7%     - 1122s
     0     0 102141.043    0  328 76468.3893 102141.043  33.6%     - 1137s
     0     0 102126.562    0  332 76468.3893 102126.562  33.6%     - 1145s
     0     0 102120.569    0  335 76468.3893 102120.569  33.5%     - 1150s
     0     0 102107.839    0  337 76468.3893 102107.839  33.5%     - 1158s
     0     0 102106.726    0  337 76468.3893 102106.726  33.5%     - 1160s
     0     0 102027.030    0  322 76468.3893 102027.030  33.4%     - 1180s
     0     0 101989.425    0  330 76468.3893 101989.425  33.4%     - 1193s
     0     0 101977.407    0  328 76468.3893 101977.407  33.4%     - 1202s
     0     0 101972.416    0  327 76468.3893 101972.416  33.4%     - 1206s
     0     0 101957.281    0  329 76468.3893 101957.281  33.3%     - 1216s
     0     0 101928.680    0  321 76468.3893 101928.680  33.3%     - 1229s
     0     0 101920.240    0  327 76468.3893 101920.240  33.3%     - 1238s
     0     0 101917.312    0  332 76468.3893 101917.312  33.3%     - 1242s
     0     0 101915.006    0  329 76468.3893 101915.006  33.3%     - 1244s
     0     0 101799.197    0  326 76468.3893 101799.197  33.1%     - 1263s
     0     0 101785.877    0  332 76468.3893 101785.877  33.1%     - 1282s
     0     0 101777.743    0  412 76468.3893 101777.743  33.1%     - 1291s
     0     0 101773.696    0  335 76468.3893 101773.696  33.1%     - 1292s
     0     0 101771.401    0  411 76468.3893 101771.401  33.1%     - 1295s
     0     0 101747.979    0  334 76468.3893 101747.979  33.1%     - 1301s
     0     0 101745.853    0  334 76468.3893 101745.853  33.1%     - 1304s
     0     0 101687.591    0  514 76468.3893 101687.591  33.0%     - 1318s
     0     0 101652.189    0  335 76468.3893 101652.189  32.9%     - 1336s
     0     0 101645.195    0  337 76468.3893 101645.195  32.9%     - 1342s
     0     0 101643.106    0  511 76468.3893 101643.106  32.9%     - 1344s
     0     0 101635.718    0  336 76468.3893 101635.718  32.9%     - 1350s
     0     0 101634.752    0  334 76468.3893 101634.752  32.9%     - 1353s
     0     0 101630.160    0  337 76468.3893 101630.160  32.9%     - 1357s
     0     0 101628.805    0  340 76468.3893 101628.805  32.9%     - 1373s
     0     0 101623.374    0  339 76468.3893 101623.374  32.9%     - 1380s
     0     0 101620.805    0  334 76468.3893 101620.805  32.9%     - 1383s
     0     0 101618.857    0  336 76468.3893 101618.857  32.9%     - 1386s
     0     0 101616.400    0  336 76468.3893 101616.400  32.9%     - 1390s
     0     0 101616.283    0  336 76468.3893 101616.283  32.9%     - 1392s
H    0     0                    76555.048677 101616.264  32.7%     - 1516s
H    0     0                    76746.971458 101616.258  32.4%     - 1624s
H    0     0                    76774.144614 101616.258  32.4%     - 1671s
H    0     0                    76896.619621 101616.258  32.1%     - 1690s
H    0     0                    76901.939351 101616.258  32.1%     - 1707s
     0     2 101616.258    0  336 76901.9394 101616.258  32.1%     - 1714s
     1     3 100927.058    1  288 76901.9394 101616.258  32.1%  8078 1732s
     2     4 101528.302    1  410 76901.9394 101528.302  32.0%  6553 1747s
     3     6 101386.499    2  324 76901.9394 101528.294  32.0%  6729 1767s
     5    10 101269.360    3  325 76901.9394 101528.294  32.0%  6984 1795s
     9    17 100981.350    4  317 76901.9394 101384.408  31.8%  6569 1834s
    16    33 100351.401    4  327 76901.9394 101332.899  31.8%  8780 1870s
    32    48 99687.4046    6  309 76901.9394 100850.591  31.1% 14453 1953s
    47    79 98720.3648    7  300 76901.9394 100850.591  31.1% 14892 2009s
    78   111 98581.5896    8  287 76901.9394 100837.477  31.1% 12889 2048s
   110   146 98551.2705    9  287 76901.9394 100837.477  31.1% 11155 2088s
H  113   146                    76950.243023 100837.477  31.0% 10915 2088s
   145   273 98495.1813   10  285 76950.2430 100837.477  31.0%  9588 2140s
   272   340 98422.9196   12  281 76950.2430 100837.477  31.0%  6809 2176s
   339   380 98225.2492   12  287 76950.2430 100837.477  31.0%  6387 2214s
   379   407 97745.5151   13  284 76950.2430 100837.477  31.0%  6326 2290s
   406   462 98016.1463   13  269 76950.2430 100837.477  31.0%  6507 2327s
   463   521 98144.0751   13  262 76950.2430 100837.477  31.0%  6302 2362s
   524   544 98291.5341   14  261 76950.2430 100837.477  31.0%  6059 2394s
   551   593 97622.2461   14  277 76950.2430 100837.477  31.0%  6098 2419s
   604   647 98178.1078   13  263 76950.2430 100837.477  31.0%  6152 2443s
   658   697 97548.3316   13  275 76950.2430 100837.477  31.0%  6112 2472s
   708   756 97000.5243   14  255 76950.2430 100837.477  31.0%  6202 2496s
   769   819 77760.3980   44   81 76950.2430 100837.477  31.0%  6192 2522s
   842   843 96830.6177   15  257 76950.2430 100837.477  31.0%  6092 2551s
   876   874 96386.7955   16  250 76950.2430 100837.477  31.0%  6157 2577s
   923   910 90610.0523   17  246 76950.2430 100837.477  31.0%  6161 2600s
   965   935 95332.1001   16  243 76950.2430 100837.477  31.0%  6167 2627s
  1042   958 87283.8860   19  238 76950.2430 100837.477  31.0%  6106 2662s
  1089  1022 95387.8132   17  224 76950.2430 100837.477  31.0%  6173 2689s
  1175  1083 93577.3875   17  230 76950.2430 100837.477  31.0%  6138 2721s
  1272  1156 93380.9256   18  216 76950.2430 100837.477  31.0%  6145 2755s
  1367  1209 92938.1493   18  232 76950.2430 100837.477  31.0%  6136 2783s
  1432  1325 92601.5350   19  222 76950.2430 100837.477  31.0%  6208 2812s
  1560  1466 90709.9037   20  221 76950.2430 100837.477  31.0%  6036 2838s
  1727  1566 91359.7646   20  207 76950.2430 100837.477  31.0%  5853 2877s
  1902  1694 90986.2278   21  237 76950.2430 100837.477  31.0%  5665 2913s
  2092  1748 90470.0657   21  211 76950.2430 100837.477  31.0%  5477 2951s
  2220  1826 90079.9956   22  228 76950.2430 100837.477  31.0%  5396 2991s
  2348  1899 89661.2043   23  241 76950.2430 100837.477  31.0%  5389 3031s
  2495  1951 88973.4271   24  228 76950.2430 100422.095  30.5%  5360 3075s
  2639  2012 87725.8399   25  190 76950.2430 100351.316  30.4%  5353 3117s
  2744  2077 87428.5631   26  184 76950.2430 100351.316  30.4%  5421 3160s
  2845  2163 86251.4809   28  171 76950.2430 100351.316  30.4%  5540 3211s
  2997  2224 84904.3949   31  142 76950.2430 100351.316  30.4%  5574 3281s
  3112  2315 83161.4492   31  165 76950.2430 100351.316  30.4%  5604 3329s
  3247  2428 84337.0085   34  156 76950.2430 100209.867  30.2%  5673 3386s
  3390  2512 78255.8823   38   58 76950.2430 100209.867  30.2%  5769 3445s
  3524  2626 84092.6291   40  233 76950.2430 100209.867  30.2%  5861 3496s
  3688  2765 infeasible   45      76950.2430 99469.9497  29.3%  5916 3554s

Cutting planes:
  Learned: 3
  Implied bound: 81
  MIR: 2078
  Flow cover: 1881
  RLT: 37
  Relax-and-lift: 376

Explored 3873 nodes (23704514 simplex iterations) in 3600.03 seconds (5069.64 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 76950.2 76901.9 76896.6 ... 75350.1

Time limit reached
Best objective 7.695024302331e+04, best bound 9.946994972661e+04, gap 29.2653%
  WARNING: Time limit reached. Using best solution found (gap: 29.27%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = 76950.24, θ = 248960.60
  Upper Bound (UB) = 76950.24

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 248960.60
  [DEBUG]   ✓ Scenario 0: θ = 248960.60 ≤ Q = 248960.60 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 248960.60 ≤ Q = 248960.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 248960.60 ≤ Q = 248960.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 248960.60 ≤ Q = 248960.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 248960.60 ≤ Q = 248960.60 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 248960.60 ≤ Q = 248960.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 248960.60 ≤ Q = 248960.60 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 248960.60 ≤ Q = 248960.60 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 248960.60 ≤ Q = 248960.60 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 248960.60 ≤ Q = 248960.60 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 10] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x7f487012
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x7f487012
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.570618e+13
Presolve removed 2567 rows and 1858 columns
Presolve time: 0.01s
Presolved: 526 rows, 531 columns, 1484 nonzeros
Found heuristic solution: objective 8221460.9230
Variable types: 361 continuous, 170 integer (170 binary)

Root relaxation: objective -1.678581e+05, 256 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -167858.14    0  127 8221460.92 -167858.14   102%     -    0s
H    0     0                    -130709.1361 -167858.14  28.4%     -    0s
H    0     0                    -132326.2315 -167858.14  26.9%     -    0s
     0     0 -148420.54    0   52 -132326.23 -148420.54  12.2%     -    0s
H    0     0                    -147327.1723 -148355.42  0.70%     -    0s
     0     0 -148355.42    0   47 -147327.17 -148355.42  0.70%     -    0s
H    0     0                    -147749.4950 -147864.23  0.08%     -    0s
     0     0 -147863.21    0   24 -147749.49 -147863.21  0.08%     -    0s
     0     0 -147808.55    0    8 -147749.49 -147808.55  0.04%     -    0s
     0     0 -147806.14    0    7 -147749.49 -147806.14  0.04%     -    0s
     0     0 -147781.70    0    7 -147749.49 -147781.70  0.02%     -    0s
     0     0          -    0      -147749.49 -147760.87  0.01%     -    0s

Cutting planes:
  Gomory: 24
  Implied bound: 2
  MIR: 116
  Flow cover: 5
  RLT: 46
  Relax-and-lift: 2
  BQP: 2

Explored 1 nodes (517 simplex iterations) in 0.05 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 5: -147749 -132326 -130709 ... 1.57062e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.477494949756e+05, best bound -1.477608693574e+05, gap 0.0077%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 236398.88
  Scenario: 19 demand increases, 41 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -147749.49
  [DEBUG]   S×d_nominal = 384148.38
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 384148.38 + -147749.49 = 236398.88
  [DEBUG]   Current θ from Master = 248960.60
  [DEBUG]   ⚠️  Z_SP ≤ θ by 12561.72 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 64388.52
  Lower Bound (LB) = 75334.45
  Gap (UB-LB) = 1615.7945, Absolute Gap = 1615.7945, Relative Gap = 0.020998
  Not converged yet (gap = 1615.79 > ε = 200)

  [DEBUG] Adding NEW scenario 10 to Master Problem...
  [DEBUG] New scenario pattern: 19 increases, 41 decreases
    [DEBUG] Scenario 10 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 10 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 10]
    [DEBUG]   - Total constraints in model: 169573
    [DEBUG]   - Total variables in model: 70900
  [DEBUG] Total scenarios in Master: 11
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 11
================================================================================
[Iteration 11] Solving Master Problem...
  Current scenarios in Master: 11
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 169573 rows, 70900 columns and 481225 nonzeros
Model fingerprint: 0xb4a446b5
Variable types: 68641 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 72215 rows and 29315 columns
Presolve time: 2.90s
Presolved: 97358 rows, 41585 columns, 589146 nonzeros
Variable types: 39326 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -301103.2843
Found heuristic solution: objective -174612.9734

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.34s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 4.469e+06
 Factor NZ  : 9.808e+06 (roughly 140 MB of memory)
 Factor Ops : 1.831e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.92834338e+07  1.90343292e+08  1.40e+05 2.28e+01  9.31e+04     5s
   1  -1.46365785e+07  1.74178043e+08  9.83e+04 1.02e+02  6.44e+04     5s
   2  -8.47329592e+06  1.43488299e+08  5.58e+04 3.82e+01  3.76e+04     5s
   3  -1.34841730e+06  1.06268155e+08  4.95e+03 2.88e+00  3.85e+03     5s
   4  -6.76973817e+05  5.32865211e+07  6.60e+02 1.90e-01  6.93e+02     5s
   5  -5.28088084e+05  3.49673365e+07  2.50e+02 1.12e-01  3.35e+02     5s
   6  -3.52109432e+05  2.49996076e+07  9.10e+01 7.37e-02  1.87e+02     5s
   7  -2.65541221e+05  2.07254799e+07  5.18e+01 5.86e-02  1.41e+02     5s
   8  -1.13436678e+05  1.22401956e+07  7.89e+00 3.10e-02  7.18e+01     6s
   9  -8.15225843e+04  6.70857312e+06  5.30e+00 1.66e-02  3.91e+01     6s
  10  -3.63688129e+04  2.26389133e+06  2.87e+00 5.02e-03  1.31e+01     6s
  11   2.26227081e+04  5.66684890e+05  1.11e+00 1.23e-03  3.08e+00     6s
  12   4.03248574e+04  3.02362695e+05  7.66e-01 9.88e-04  1.48e+00     6s
  13   5.07865301e+04  2.55266300e+05  6.17e-01 1.45e-03  1.15e+00     6s
  14   5.98359627e+04  2.11478608e+05  5.05e-01 1.72e-03  8.56e-01     6s
  15   7.17459571e+04  1.85286630e+05  3.82e-01 1.85e-03  6.40e-01     6s
  16   8.32431066e+04  1.57751614e+05  2.80e-01 2.79e-03  4.20e-01     6s
  17   8.99507446e+04  1.41857561e+05  2.23e-01 1.94e-03  2.93e-01     6s
  18   9.50432580e+04  1.38486785e+05  1.81e-01 1.93e-03  2.45e-01     7s
  19   9.85586417e+04  1.31471481e+05  1.50e-01 2.00e-03  1.86e-01     7s
  20   1.03106918e+05  1.28665346e+05  1.14e-01 1.86e-03  1.44e-01     7s
  21   1.03717648e+05  1.27327068e+05  1.09e-01 1.57e-03  1.33e-01     7s
  22   1.04430200e+05  1.26245812e+05  1.03e-01 1.48e-03  1.23e-01     7s
  23   1.06652993e+05  1.24591259e+05  8.65e-02 1.43e-03  1.01e-01     7s
  24   1.10367269e+05  1.23360621e+05  5.95e-02 2.02e-03  7.33e-02     7s
  25   1.13752333e+05  1.21182817e+05  3.49e-02 2.07e-03  4.19e-02     7s
  26   1.15038036e+05  1.20052419e+05  2.58e-02 1.09e-03  2.83e-02     7s
  27   1.16263233e+05  1.19708935e+05  1.72e-02 1.02e-03  1.95e-02     8s
  28   1.17485294e+05  1.19367679e+05  8.60e-03 5.96e-04  1.06e-02     8s
  29   1.18005440e+05  1.19138626e+05  5.12e-03 3.19e-04  6.39e-03     8s
  30   1.18189138e+05  1.19075157e+05  3.95e-03 2.47e-04  5.00e-03     8s
  31   1.18503098e+05  1.18997231e+05  2.00e-03 2.20e-04  2.79e-03     8s
  32   1.18668967e+05  1.18945435e+05  9.86e-04 1.39e-04  1.56e-03     8s
  33   1.18720515e+05  1.18895724e+05  6.73e-04 6.94e-05  9.87e-04     8s
  34   1.18773146e+05  1.18874976e+05  3.79e-04 3.92e-05  5.74e-04     8s
  35   1.18790171e+05  1.18871339e+05  2.88e-04 3.40e-05  4.57e-04     9s
  36   1.18819877e+05  1.18859941e+05  1.30e-04 1.71e-05  2.26e-04     9s
  37   1.18834258e+05  1.18855231e+05  5.29e-05 1.11e-05  1.18e-04     9s
  38   1.18840500e+05  1.18852381e+05  2.60e-05 7.64e-06  6.68e-05     9s
  39   1.18844533e+05  1.18847671e+05  8.09e-06 2.62e-06  1.76e-05     9s
  40   1.18846562e+05  1.18846588e+05  1.14e-08 1.38e-07  1.47e-07     9s
  41   1.18846578e+05  1.18846578e+05  8.86e-10 1.18e-09  1.27e-10     9s

Barrier solved model in 41 iterations and 9.46 seconds (7.66 work units)
Optimal objective 1.18846578e+05


Root crossover log...

   89643 DPushes remaining with DInf 0.0000000e+00                10s
   37343 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                14s

    1001 PPushes remaining with PInf 3.3640957e-06                14s
       0 PPushes remaining with PInf 0.0000000e+00                15s

  Push phase complete: Pinf 0.0000000e+00, Dinf 6.8766194e-02     15s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   42740    1.1884658e+05   0.000000e+00   6.876619e-02     15s
   42743    1.1884658e+05   0.000000e+00   0.000000e+00     15s
   42743    1.1884658e+05   0.000000e+00   0.000000e+00     15s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 1.188466e+05, 42743 iterations, 11.17 seconds (13.58 work units)
Total elapsed time = 15.12s (DegenMoves)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 118846.578    0  101 -174612.97 118846.578   168%     -   15s
H    0     0                    -166429.7187 118846.578   171%     -   15s
H    0     0                    -136146.5924 118846.578   187%     -   16s
H    0     0                    -135566.9119 118846.578   188%     -   16s
H    0     0                    -22011.90684 118846.578   640%     -   16s
H    0     0                    57828.508715 118846.578   106%     -   16s
H    0     0                    57840.407469 118846.578   105%     -   17s
H    0     0                    72293.940488 118846.578  64.4%     -   18s
H    0     0                    73613.210056 118846.578  61.4%     -   18s
H    0     0                    74185.964224 118846.578  60.2%     -   18s
H    0     0                    74252.640490 118846.578  60.1%     -   18s
H    0     0                    74734.141126 118846.578  59.0%     -   19s
H    0     0                    74901.663046 118846.578  58.7%     -   19s
     0     0 113219.617    0  279 74901.6630 113219.617  51.2%     -  136s
H    0     0                    74925.054621 113219.617  51.1%     -  138s
H    0     0                    75547.329887 113219.617  49.9%     -  138s
H    0     0                    75921.128978 113219.617  49.1%     -  138s
H    0     0                    75948.869967 113219.617  49.1%     -  138s
H    0     0                    76033.349194 113219.617  48.9%     -  138s
     0     0 111310.861    0  412 76033.3492 111310.861  46.4%     -  206s
     0     0 111310.861    0  400 76033.3492 111310.861  46.4%     -  221s
     0     0 111310.861    0  396 76033.3492 111310.861  46.4%     -  225s
     0     0 111310.049    0  403 76033.3492 111310.049  46.4%     -  228s
     0     0 111308.828    0  396 76033.3492 111308.828  46.4%     -  231s
     0     0 111308.808    0  399 76033.3492 111308.808  46.4%     -  231s
     0     0 107711.312    0  231 76033.3492 107711.312  41.7%     -  301s
H    0     0                    76134.958211 106997.484  40.5%     -  352s
     0     0 106997.484    0  242 76134.9582 106997.484  40.5%     -  352s
     0     0 106641.394    0  237 76134.9582 106641.394  40.1%     -  391s
     0     0 106561.648    0  243 76134.9582 106561.648  40.0%     -  414s
     0     0 106514.806    0  299 76134.9582 106514.806  39.9%     -  435s
     0     0 106511.506    0  305 76134.9582 106511.506  39.9%     -  441s
     0     0 106479.293    0  301 76134.9582 106479.293  39.9%     -  461s
     0     0 106473.526    0  294 76134.9582 106473.526  39.8%     -  470s
     0     0 106459.180    0  299 76134.9582 106459.180  39.8%     -  481s
     0     0 106458.667    0  299 76134.9582 106458.667  39.8%     -  485s
     0     0 104934.055    0  436 76134.9582 104934.055  37.8%     -  593s
H    0     0                    76181.852632 104933.840  37.7%     -  594s
H    0     0                    76324.776976 104450.081  36.8%     -  641s
     0     0 104450.081    0  452 76324.7770 104450.081  36.8%     -  642s
     0     0 104267.675    0  467 76324.7770 104267.675  36.6%     -  669s
     0     0 104188.327    0  462 76324.7770 104188.327  36.5%     -  686s
     0     0 104144.984    0  443 76324.7770 104144.984  36.4%     -  701s
     0     0 104122.381    0  450 76324.7770 104122.381  36.4%     -  710s
     0     0 104110.272    0  449 76324.7770 104110.272  36.4%     -  715s
     0     0 104102.233    0  447 76324.7770 104102.233  36.4%     -  720s
     0     0 104056.678    0  456 76324.7770 104056.678  36.3%     -  731s
     0     0 104048.492    0  463 76324.7770 104048.492  36.3%     -  736s
     0     0 103995.942    0  447 76324.7770 103995.942  36.3%     -  747s
     0     0 103989.322    0  466 76324.7770 103989.322  36.2%     -  753s
     0     0 103979.842    0  462 76324.7770 103979.842  36.2%     -  757s
     0     0 103976.060    0  462 76324.7770 103976.060  36.2%     -  760s
     0     0 103971.988    0  459 76324.7770 103971.988  36.2%     -  763s
     0     0 103950.545    0  467 76324.7770 103950.545  36.2%     -  771s
     0     0 103948.330    0  468 76324.7770 103948.330  36.2%     -  774s
     0     0 103941.734    0  466 76324.7770 103941.734  36.2%     -  776s
     0     0 103938.299    0  474 76324.7770 103938.299  36.2%     -  779s
     0     0 103902.060    0  470 76324.7770 103902.060  36.1%     -  787s
     0     0 103898.694    0  430 76324.7770 103898.694  36.1%     -  789s
     0     0 103896.493    0  421 76324.7770 103896.493  36.1%     -  792s
     0     0 103894.131    0  430 76324.7770 103894.131  36.1%     -  795s
     0     0 103893.444    0  468 76324.7770 103893.444  36.1%     -  796s
     0     0 103112.136    0  322 76324.7770 103112.136  35.1%     -  882s
H    0     0                    76397.983007 102840.278  34.6%     -  910s
     0     0 102840.278    0  318 76397.9830 102840.278  34.6%     -  910s
     0     0 102655.024    0  418 76397.9830 102655.024  34.4%     -  930s
     0     0 102557.263    0  309 76397.9830 102557.263  34.2%     -  946s
     0     0 102517.397    0  357 76397.9830 102517.397  34.2%     -  956s
     0     0 102482.651    0  350 76397.9830 102482.651  34.1%     -  970s
     0     0 102442.653    0  442 76397.9830 102442.653  34.1%     -  985s
     0     0 102428.681    0  441 76397.9830 102428.681  34.1%     -  997s
     0     0 102410.718    0  444 76397.9830 102410.718  34.0%     - 1009s
     0     0 102408.248    0  363 76397.9830 102408.248  34.0%     - 1015s
     0     0 102388.841    0  426 76397.9830 102388.841  34.0%     - 1022s
     0     0 102373.555    0  363 76397.9830 102373.555  34.0%     - 1031s
     0     0 102365.256    0  365 76397.9830 102365.256  34.0%     - 1038s
     0     0 102360.927    0  365 76397.9830 102360.927  34.0%     - 1044s
     0     0 102351.170    0  442 76397.9830 102351.170  34.0%     - 1052s
     0     0 102349.806    0  442 76397.9830 102349.806  34.0%     - 1056s
     0     0 102251.056    0  486 76397.9830 102251.056  33.8%     - 1079s
     0     0 102184.450    0  368 76397.9830 102184.450  33.8%     - 1097s
     0     0 102126.225    0  421 76397.9830 102126.225  33.7%     - 1114s
     0     0 102100.232    0  505 76397.9830 102100.232  33.6%     - 1129s
     0     0 102096.355    0  439 76397.9830 102096.355  33.6%     - 1133s
     0     0 102076.518    0  436 76397.9830 102076.518  33.6%     - 1144s
     0     0 102061.042    0  505 76397.9830 102061.042  33.6%     - 1154s
     0     0 102055.441    0  512 76397.9830 102055.441  33.6%     - 1161s
     0     0 102050.579    0  510 76397.9830 102050.579  33.6%     - 1168s
     0     0 102047.499    0  509 76397.9830 102047.499  33.6%     - 1173s
     0     0 102041.506    0  510 76397.9830 102041.506  33.6%     - 1178s
     0     0 102039.306    0  516 76397.9830 102039.306  33.6%     - 1181s
     0     0 101922.968    0  326 76397.9830 101922.968  33.4%     - 1205s
H    0     0                    76605.371728 101922.803  33.0%     - 1215s
     0     0 101894.525    0  332 76605.3717 101894.525  33.0%     - 1228s
     0     0 101885.074    0  333 76605.3717 101885.074  33.0%     - 1239s
     0     0 101881.690    0  337 76605.3717 101881.690  33.0%     - 1244s
     0     0 101873.130    0  341 76605.3717 101873.130  33.0%     - 1250s
     0     0 101871.961    0  338 76605.3717 101871.961  33.0%     - 1252s
     0     0 101781.696    0  328 76605.3717 101781.696  32.9%     - 1269s
     0     0 101720.565    0  332 76605.3717 101720.565  32.8%     - 1280s
     0     0 101710.839    0  331 76605.3717 101710.839  32.8%     - 1283s
     0     0 101703.122    0  336 76605.3717 101703.122  32.8%     - 1288s
     0     0 101695.840    0  328 76605.3717 101695.840  32.8%     - 1293s
     0     0 101695.238    0  334 76605.3717 101695.238  32.8%     - 1296s
     0     0 101684.013    0  324 76605.3717 101684.013  32.7%     - 1301s
     0     0 101682.486    0  327 76605.3717 101682.486  32.7%     - 1325s
     0     0 101668.957    0  328 76605.3717 101668.957  32.7%     - 1330s
     0     0 101661.889    0  332 76605.3717 101661.889  32.7%     - 1336s
     0     0 101660.894    0  320 76605.3717 101660.894  32.7%     - 1337s
     0     0 101646.676    0  333 76605.3717 101646.676  32.7%     - 1346s
     0     0 101639.938    0  326 76605.3717 101639.938  32.7%     - 1357s
     0     0 101638.513    0  336 76605.3717 101638.513  32.7%     - 1359s
     0     0 101614.449    0  331 76605.3717 101614.449  32.6%     - 1367s
     0     0 101612.545    0  334 76605.3717 101612.545  32.6%     - 1372s
     0     0 101604.852    0  335 76605.3717 101604.852  32.6%     - 1378s
     0     0 101600.028    0  464 76605.3717 101600.028  32.6%     - 1402s
     0     0 101593.628    0  323 76605.3717 101593.628  32.6%     - 1411s
     0     0 101591.896    0  458 76605.3717 101591.896  32.6%     - 1417s
     0     0 101576.671    0  523 76605.3717 101576.671  32.6%     - 1433s
     0     0 101568.363    0  330 76605.3717 101568.363  32.6%     - 1444s
     0     0 101565.926    0  340 76605.3717 101565.926  32.6%     - 1449s
     0     0 101565.617    0  468 76605.3717 101565.617  32.6%     - 1454s
     0     0 101530.594    0  317 76605.3717 101530.594  32.5%     - 1471s
H    0     0                    76633.312917 101530.580  32.5%     - 1571s
     0     0 101521.895    0  460 76633.3129 101521.895  32.5%     - 1639s
     0     0 101519.938    0  327 76633.3129 101519.938  32.5%     - 1641s
     0     0 101512.525    0  329 76633.3129 101512.525  32.5%     - 1648s
H    0     0                    76860.889489 101510.553  32.1%     - 1649s
H    0     0                    76863.760032 101510.553  32.1%     - 1649s
     0     0 101510.553    0  329 76863.7600 101510.553  32.1%     - 1651s
     0     0 101509.596    0  329 76863.7600 101509.596  32.1%     - 1654s
     0     0 101508.255    0  333 76863.7600 101508.255  32.1%     - 1656s
     0     0 101506.208    0  329 76863.7600 101506.208  32.1%     - 1658s
     0     0 101503.722    0  329 76863.7600 101503.722  32.1%     - 1661s
H    0     0                    76867.756225 101503.722  32.0%     - 1812s
     0     2 101503.722    0  329 76867.7562 101503.722  32.0%     - 1894s
     1     3 100588.314    1  295 76867.7562 101503.722  32.0% 15650 1924s
     2     4 101238.827    1  321 76867.7562 101238.827  31.7% 14612 1949s
     3     8 99905.6522    2  300 76867.7562 101238.724  31.7% 14336 1975s
     7    16 99732.3317    3  309 76867.7562 101142.071  31.6% 12088 2014s
    15    32 99608.1175    4  313 76867.7562 101128.538  31.6% 12361 2064s
    31    47 99685.2920    5  342 76867.7562 100836.408  31.2% 18872 3600s

Cutting planes:
  Gomory: 6
  Implied bound: 120
  MIR: 2011
  Flow cover: 1812
  RLT: 48
  Relax-and-lift: 320

Explored 46 nodes (1645625 simplex iterations) in 3600.15 seconds (3408.95 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 76867.8 76863.8 76860.9 ... 76033.3

Time limit reached
Best objective 7.686775622530e+04, best bound 1.008364080703e+05, gap 31.1817%
  WARNING: Time limit reached. Using best solution found (gap: 31.18%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.18s
  Master Objective (UB) = 76867.76, θ = 249788.06
  Upper Bound (UB) = 76867.76

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 249788.06
  [DEBUG]   ✓ Scenario 0: θ = 249788.06 ≤ Q = 249788.06 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 249788.06 ≤ Q = 249788.06 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 249788.06 ≤ Q = 249788.06 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 249788.06 ≤ Q = 249788.06 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 249788.06 ≤ Q = 249788.06 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 249788.06 ≤ Q = 249788.06 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 249788.06 ≤ Q = 249788.06 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 249788.06 ≤ Q = 249788.06 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 249788.06 ≤ Q = 249788.06 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 249788.06 ≤ Q = 249788.06 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 249788.06 ≤ Q = 249788.06 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 11] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0xb940466
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x0b940466
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [1e-11, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e-13, 2e+02]
Found heuristic solution: objective 1.575416e+13
Presolve removed 2567 rows and 1858 columns
Presolve time: 0.01s
Presolved: 526 rows, 531 columns, 1487 nonzeros
Found heuristic solution: objective 8220352.0502
Variable types: 361 continuous, 170 integer (170 binary)

Root relaxation: objective -1.664614e+05, 249 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -166461.38    0  122 8220352.05 -166461.38   102%     -    0s
H    0     0                    -130133.9216 -166461.38  27.9%     -    0s
H    0     0                    -131542.1016 -166461.38  26.5%     -    0s
     0     0 -144239.71    0   85 -131542.10 -144239.71  9.65%     -    0s
H    0     0                    -142415.5652 -144174.32  1.23%     -    0s
     0     0 -143388.80    0   91 -142415.57 -143388.80  0.68%     -    0s
H    0     0                    -142835.8745 -143382.95  0.38%     -    0s
     0     0 -143303.99    0   85 -142835.87 -143303.99  0.33%     -    0s
     0     0 -143301.25    0   82 -142835.87 -143301.25  0.33%     -    0s
     0     0 -143301.23    0   82 -142835.87 -143301.23  0.33%     -    0s
     0     0 -142996.22    0   25 -142835.87 -142996.22  0.11%     -    0s
     0     0 -142981.37    0   13 -142835.87 -142981.37  0.10%     -    0s
     0     0 -142946.94    0   22 -142835.87 -142946.94  0.08%     -    0s
     0     0 -142946.69    0   10 -142835.87 -142946.69  0.08%     -    0s
     0     0 -142909.09    0   18 -142835.87 -142909.09  0.05%     -    0s
     0     0 -142909.09    0   11 -142835.87 -142909.09  0.05%     -    0s
H    0     0                    -142844.7059 -142909.09  0.05%     -    0s
     0     0 -142883.37    0   10 -142844.71 -142883.37  0.03%     -    0s
H    0     0                    -142851.9237 -142880.36  0.02%     -    0s
     0     0 -142869.08    0    5 -142851.92 -142869.08  0.01%     -    0s
     0     0          -    0      -142851.92 -142864.96  0.01%     -    0s

Cutting planes:
  Gomory: 5
  Implied bound: 1
  MIR: 5
  Flow cover: 4

Explored 1 nodes (764 simplex iterations) in 0.11 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -142852 -142845 -142836 ... 1.57542e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.428519236663e+05, best bound -1.428649622367e+05, gap 0.0091%
  Subproblem solved in 0.15s
  Worst-case operational profit (Z_SP) = 241296.45
  Scenario: 35 demand increases, 25 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -142851.92
  [DEBUG]   S×d_nominal = 384148.38
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 384148.38 + -142851.92 = 241296.45
  [DEBUG]   Current θ from Master = 249788.06
  [DEBUG]   ⚠️  Z_SP ≤ θ by 8491.61 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 68376.15
  Lower Bound (LB) = 75334.45
  Gap (UB-LB) = 1533.3077, Absolute Gap = 1533.3077, Relative Gap = 0.019947
  Not converged yet (gap = 1533.31 > ε = 200)

  [DEBUG] Adding NEW scenario 11 to Master Problem...
  [DEBUG] New scenario pattern: 35 increases, 25 decreases
    [DEBUG] Scenario 11 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 11 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 11]
    [DEBUG]   - Total constraints in model: 184863
    [DEBUG]   - Total variables in model: 77140
  [DEBUG] Total scenarios in Master: 12
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 12
================================================================================
[Iteration 12] Solving Master Problem...
  Current scenarios in Master: 12
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 184863 rows, 77140 columns and 524471 nonzeros
Model fingerprint: 0xb97ba2ae
Variable types: 74881 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 78780 rows and 31980 columns (presolve time = 5s)...
Presolve removed 78780 rows and 31980 columns
Presolve time: 5.52s
Presolved: 106083 rows, 45160 columns, 640139 nonzeros
Variable types: 42901 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -299701.6466
Found heuristic solution: objective -174612.9734

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.34s

Barrier statistics:
 Dense cols : 706
 AA' NZ     : 3.346e+06
 Factor NZ  : 8.232e+06 (roughly 130 MB of memory)
 Factor Ops : 1.633e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.99701518e+07  2.05739764e+08  1.45e+05 2.26e+01  9.59e+04     8s
   1  -1.51848503e+07  1.89704509e+08  1.02e+05 1.02e+02  6.62e+04     8s
   2  -7.14748289e+06  1.57949611e+08  4.73e+04 4.26e+01  3.19e+04     8s
   3  -1.42969782e+06  1.17933981e+08  4.72e+03 3.59e+00  3.69e+03     8s
   4  -7.53852581e+05  6.06195368e+07  6.09e+02 3.67e-01  6.75e+02     8s
   5  -6.66480448e+05  3.55711617e+07  2.16e+02 1.76e-01  3.00e+02     8s
   6  -5.83644585e+05  2.40878733e+07  8.77e+01 1.13e-01  1.67e+02     8s
   7  -2.63330194e+05  1.92392399e+07  3.55e+01 8.70e-02  1.15e+02     8s
   8  -1.71159433e+05  1.22757455e+07  1.67e+01 5.21e-02  6.92e+01     8s
   9  -8.03632181e+04  4.74000787e+06  6.39e+00 1.75e-02  2.58e+01     9s
  10  -1.63240827e+04  1.86622248e+06  2.32e+00 6.53e-03  9.85e+00     9s
  11   2.59367948e+04  1.09763618e+06  1.04e+00 3.64e-03  5.56e+00     9s
  12   3.66431129e+04  6.17287707e+05  7.94e-01 1.75e-03  3.01e+00     9s
  13   4.76632013e+04  3.57070278e+05  5.41e-01 8.97e-04  1.60e+00     9s
  14   5.84472856e+04  2.58440925e+05  3.97e-01 1.13e-03  1.03e+00     9s
  15   6.64839518e+04  2.17131187e+05  3.20e-01 1.14e-03  7.79e-01     9s
  16   7.82351068e+04  1.76912967e+05  2.29e-01 2.25e-03  5.10e-01     9s
  17   8.32095351e+04  1.66081012e+05  1.93e-01 1.95e-03  4.28e-01     9s
  18   9.01197443e+04  1.46601205e+05  1.53e-01 3.24e-03  2.92e-01     9s
  19   9.53161544e+04  1.39553399e+05  1.22e-01 2.11e-03  2.29e-01    10s
  20   9.97469552e+04  1.30641235e+05  9.72e-02 3.35e-03  1.60e-01    10s
  21   1.03195309e+05  1.28308634e+05  7.97e-02 2.62e-03  1.30e-01    10s
  22   1.08125736e+05  1.24586021e+05  5.44e-02 3.42e-03  8.51e-02    10s
  23   1.11523674e+05  1.22731705e+05  3.77e-02 2.26e-03  5.80e-02    10s
  24   1.14681478e+05  1.21667309e+05  2.18e-02 1.99e-03  3.61e-02    10s
  25   1.16775062e+05  1.20893465e+05  1.18e-02 1.30e-03  2.13e-02    10s
  26   1.17674447e+05  1.20390848e+05  7.57e-03 8.55e-04  1.40e-02    10s
  27   1.18206490e+05  1.20100292e+05  5.11e-03 5.97e-04  9.79e-03    10s
  28   1.18561880e+05  1.19897919e+05  3.58e-03 4.23e-04  6.90e-03    10s
  29   1.18937033e+05  1.19734466e+05  1.87e-03 2.84e-04  4.12e-03    11s
  30   1.19082415e+05  1.19591422e+05  1.24e-03 1.69e-04  2.63e-03    11s
  31   1.19127644e+05  1.19557326e+05  1.05e-03 1.41e-04  2.22e-03    11s
  32   1.19262097e+05  1.19474499e+05  4.88e-04 6.98e-05  1.10e-03    11s
  33   1.19367680e+05  1.19413690e+05  8.11e-05 1.96e-05  2.37e-04    11s
  34   1.19389712e+05  1.19391178e+05  1.56e-06 1.47e-06  7.56e-06    11s
  35   1.19390624e+05  1.19390627e+05  2.13e-08 8.91e-09  1.33e-08    11s
  36   1.19390626e+05  1.19390626e+05  1.49e-08 3.48e-11  2.68e-10    11s

Barrier solved model in 36 iterations and 11.36 seconds (7.35 work units)
Optimal objective 1.19390626e+05


Root crossover log...

   96963 DPushes remaining with DInf 0.0000000e+00                11s
       0 DPushes remaining with DInf 0.0000000e+00                14s

    2385 PPushes remaining with PInf 1.7378212e-05                14s
       0 PPushes remaining with PInf 0.0000000e+00                15s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.9716069e-03     15s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   44766    1.1939063e+05   0.000000e+00   3.971607e-03     15s
   44767    1.1939063e+05   0.000000e+00   0.000000e+00     15s
   44767    1.1939063e+05   0.000000e+00   0.000000e+00     15s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 1.193906e+05, 44767 iterations, 8.49 seconds (9.58 work units)
Total elapsed time = 15.34s (DegenMoves)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 119390.626    0  112 -174612.97 119390.626   168%     -   15s
H    0     0                    -168466.9091 119390.626   171%     -   15s
H    0     0                    -121911.7220 119390.626   198%     -   16s
H    0     0                    -121911.6294 119390.626   198%     -   16s
H    0     0                    -74118.50296 119390.626   261%     -   16s
H    0     0                    -71322.14339 119390.626   267%     -   16s
H    0     0                    -71184.67915 119390.626   268%     -   16s
H    0     0                    -70967.09868 119390.626   268%     -   16s
H    0     0                    -70929.65562 119390.626   268%     -   16s
H    0     0                    -11375.00668 119390.626  1150%     -   16s
H    0     0                    35009.897742 119390.626   241%     -   17s
H    0     0                    54665.455421 119390.626   118%     -   18s
H    0     0                    65038.907044 119390.626  83.6%     -   19s
H    0     0                    71719.298240 119390.626  66.5%     -   19s
H    0     0                    72284.109797 119390.626  65.2%     -   19s
H    0     0                    72978.939199 119390.626  63.6%     -   19s
H    0     0                    73245.169392 119390.626  63.0%     -   19s
H    0     0                    73396.730992 119390.626  62.7%     -   19s
H    0     0                    73434.508331 119390.626  62.6%     -   19s
H    0     0                    73460.879998 119390.626  62.5%     -   19s
H    0     0                    73471.945326 119390.626  62.5%     -   19s
H    0     0                    73937.579492 119390.626  61.5%     -   19s
H    0     0                    74023.062831 119390.626  61.3%     -   19s
H    0     0                    74416.813133 119390.626  60.4%     -   19s
     0     0 112659.260    0  374 74416.8131 112659.260  51.4%     -  152s
H    0     0                    74901.305970 112659.260  50.4%     -  154s
     0     0 112588.221    0  370 74901.3060 112588.221  50.3%     -  214s
     0     0 112588.221    0  367 74901.3060 112588.221  50.3%     -  237s
     0     0 108949.355    0  400 74901.3060 108949.355  45.5%     -  249s
     0     0 108949.355    0  397 74901.3060 108949.355  45.5%     -  252s
     0     0 108949.355    0  400 74901.3060 108949.355  45.5%     -  254s
     0     0 108949.355    0  400 74901.3060 108949.355  45.5%     -  256s
     0     0 108949.355    0  400 74901.3060 108949.355  45.5%     -  257s
     0     0 108853.197    0  224 74901.3060 108853.197  45.3%     -  353s
H    0     0                    75527.543843 107655.628  42.5%     -  434s
H    0     0                    75778.747786 107655.628  42.1%     -  434s
H    0     0                    75783.394917 107655.628  42.1%     -  434s
H    0     0                    75930.100399 107655.628  41.8%     -  434s
H    0     0                    75996.776665 107655.628  41.7%     -  434s
H    0     0                    76049.160926 107655.628  41.6%     -  434s
     0     0 107655.628    0  437 76049.1609 107655.628  41.6%     -  434s
     0     0 107204.189    0  399 76049.1609 107204.189  41.0%     -  476s
     0     0 107059.331    0  397 76049.1609 107059.331  40.8%     -  504s
     0     0 107036.165    0  426 76049.1609 107036.165  40.7%     -  516s
     0     0 106998.966    0  398 76049.1609 106998.966  40.7%     -  526s
     0     0 106935.068    0  428 76049.1609 106935.068  40.6%     -  544s
     0     0 106925.459    0  404 76049.1609 106925.459  40.6%     -  549s
     0     0 106903.421    0  448 76049.1609 106903.421  40.6%     -  558s
     0     0 106897.060    0  439 76049.1609 106897.060  40.6%     -  562s
     0     0 106890.465    0  440 76049.1609 106890.465  40.6%     -  566s
     0     0 106890.022    0  439 76049.1609 106890.022  40.6%     -  567s
H    0     0                    76314.991951 104721.908  37.2%     -  700s
     0     0 104721.908    0  386 76314.9920 104721.908  37.2%     -  700s
H    0     0                    76321.626874 104721.848  37.2%     -  701s
     0     0 103951.369    0  411 76321.6269 103951.369  36.2%     -  767s
     0     0 103610.222    0  357 76321.6269 103610.222  35.8%     -  814s
     0     0 103489.595    0  408 76321.6269 103489.595  35.6%     -  837s
     0     0 103426.542    0  504 76321.6269 103426.542  35.5%     -  863s
     0     0 103369.927    0  325 76321.6269 103369.927  35.4%     -  883s
     0     0 103338.742    0  499 76321.6269 103338.742  35.4%     -  897s
     0     0 103321.576    0  346 76321.6269 103321.576  35.4%     -  912s
     0     0 103305.518    0  340 76321.6269 103305.518  35.4%     -  920s
     0     0 103278.914    0  492 76321.6269 103278.914  35.3%     -  929s
     0     0 103247.776    0  333 76321.6269 103247.776  35.3%     -  939s
     0     0 103242.885    0  336 76321.6269 103242.885  35.3%     -  946s
     0     0 103174.915    0  472 76321.6269 103174.915  35.2%     -  968s
H    0     0                    76351.711296 103128.153  35.1%     -  985s
H    0     0                    76392.132516 103128.153  35.0%     -  985s
     0     0 103128.153    0  490 76392.1325 103128.153  35.0%     -  985s
     0     0 103114.146    0  468 76392.1325 103114.146  35.0%     -  994s
     0     0 103105.114    0  472 76392.1325 103105.114  35.0%     - 1002s
     0     0 103090.010    0  484 76392.1325 103090.010  34.9%     - 1009s
     0     0 103086.848    0  474 76392.1325 103086.848  34.9%     - 1013s
     0     0 103083.387    0  479 76392.1325 103083.387  34.9%     - 1017s
     0     0 103081.894    0  484 76392.1325 103081.894  34.9%     - 1020s
     0     0 102637.875    0  338 76392.1325 102637.875  34.4%     - 1061s
     0     0 102354.502    0  335 76392.1325 102354.502  34.0%     - 1096s
     0     0 102262.787    0  341 76392.1325 102262.787  33.9%     - 1119s
     0     0 102205.348    0  344 76392.1325 102205.348  33.8%     - 1132s
     0     0 102199.739    0  336 76392.1325 102199.739  33.8%     - 1141s
     0     0 102193.307    0  339 76392.1325 102193.307  33.8%     - 1147s
     0     0 102187.786    0  335 76392.1325 102187.786  33.8%     - 1152s
     0     0 102182.572    0  336 76392.1325 102182.572  33.8%     - 1157s
     0     0 102178.038    0  336 76392.1325 102178.038  33.8%     - 1159s
     0     0 102158.506    0  344 76392.1325 102158.506  33.7%     - 1168s
     0     0 102151.563    0  336 76392.1325 102151.563  33.7%     - 1171s
     0     0 102146.790    0  338 76392.1325 102146.790  33.7%     - 1174s
     0     0 102143.783    0  329 76392.1325 102143.783  33.7%     - 1176s
     0     0 102138.595    0  343 76392.1325 102138.595  33.7%     - 1180s
H    0     0                    76401.003182 102136.395  33.7%     - 1182s
     0     0 102136.395    0  337 76401.0032 102136.395  33.7%     - 1183s
     0     0 101992.376    0  338 76401.0032 101992.376  33.5%     - 1208s
     0     0 101964.686    0  400 76401.0032 101964.686  33.5%     - 1218s
     0     0 101953.380    0  412 76401.0032 101953.380  33.4%     - 1226s
     0     0 101947.989    0  359 76401.0032 101947.989  33.4%     - 1230s
H    0     0                    76468.389261 101945.534  33.3%     - 1234s
     0     0 101945.534    0  397 76468.3893 101945.534  33.3%     - 1234s
     0     0 101882.532    0  380 76468.3893 101882.532  33.2%     - 1251s
     0     0 101853.499    0  348 76468.3893 101853.499  33.2%     - 1279s
     0     0 101849.005    0  502 76468.3893 101849.005  33.2%     - 1284s
     0     0 101845.251    0  342 76468.3893 101845.251  33.2%     - 1292s
     0     0 101844.657    0  341 76468.3893 101844.657  33.2%     - 1293s
     0     0 101819.034    0  455 76468.3893 101819.034  33.2%     - 1310s
     0     0 101813.864    0  561 76468.3893 101813.864  33.1%     - 1320s
     0     0 101813.631    0  561 76468.3893 101813.631  33.1%     - 1321s
     0     0 101759.887    0  562 76468.3893 101759.887  33.1%     - 1341s
H    0     0                    76528.101709 101759.277  33.0%     - 1374s
     0     0 101745.702    0  352 76528.1017 101745.702  33.0%     - 1384s
     0     0 101740.585    0  408 76528.1017 101740.585  32.9%     - 1391s
     0     0 101734.945    0  343 76528.1017 101734.945  32.9%     - 1396s
     0     0 101733.055    0  341 76528.1017 101733.055  32.9%     - 1399s
     0     0 101723.646    0  499 76528.1017 101723.646  32.9%     - 1405s
H    0     0                    76634.989833 101723.604  32.7%     - 1407s
     0     0 101720.949    0  407 76634.9898 101720.949  32.7%     - 1410s
     0     0 101719.150    0  345 76634.9898 101719.150  32.7%     - 1412s
     0     0 101717.543    0  343 76634.9898 101717.543  32.7%     - 1418s
     0     0 101717.180    0  346 76634.9898 101717.180  32.7%     - 1419s
     0     0 101716.779    0  345 76634.9898 101716.779  32.7%     - 1421s
     0     0 101716.572    0  346 76634.9898 101716.572  32.7%     - 1423s
     0     0 101716.572    0  345 76634.9898 101716.572  32.7%     - 1425s
     0     0 101716.072    0  346 76634.9898 101716.072  32.7%     - 1426s
     0     0 101716.072    0  454 76634.9898 101716.072  32.7%     - 1428s
     0     0 101716.072    0  454 76634.9898 101716.072  32.7%     - 1432s
     0     2 101716.072    0  454 76634.9898 101716.072  32.7%     - 1648s
     1     3 100644.134    1  470 76634.9898 101715.992  32.7% 22552 1692s
     2     4 101595.562    1  439 76634.9898 101595.562  32.6% 14176 1711s
     3     8 101451.314    2  531 76634.9898 101595.454  32.6% 12801 1742s
     7    15 98988.9824    3  413 76634.9898 101549.141  32.5% 11998 1793s
    14    27 98856.1319    4  370 76634.9898 101451.228  32.4% 13583 1867s
    26    39 97716.5808    5  351 76634.9898 101379.909  32.3% 20912 2004s
    38    68 98982.3993    5  323 76634.9898 101210.901  32.1% 22708 2193s
    67   124 98770.3861    6  306 76634.9898 101210.901  32.1% 20842 2341s
   123   247 98667.0748    7  301 76634.9898 101210.901  32.1% 16266 2430s
   246   312 98320.6464   12  303 76634.9898 101210.901  32.1% 11237 2494s
   311   373 98117.9667   13  284 76634.9898 101210.901  32.1% 10359 2545s
   372   430 97926.4115   14  285 76634.9898 101210.901  32.1%  9838 2599s
   429   458 97849.5680   15  291 76634.9898 101210.901  32.1%  9335 2642s
   457   496 97751.1421   16  289 76634.9898 101210.901  32.1%  9206 2684s
   495   524 97363.7287   17  288 76634.9898 101210.901  32.1%  9138 2726s
   523   552 97149.2676   18  282 76634.9898 101210.901  32.1%  9400 2771s
   553   576 94685.1636   12  306 76634.9898 101210.901  32.1%  9300 2814s
   577   605 94743.0172   12  307 76634.9898 101210.901  32.1%  9297 2867s
   606   638 95805.4747   18  278 76634.9898 101210.901  32.1%  9243 2905s
   639   675 95023.9011   19  255 76634.9898 101210.901  32.1%  9479 2956s
H  655   675                    76831.328567 101210.901  31.7%  9341 2956s
   676   744 94418.0254   20  233 76831.3286 101210.901  31.7%  9262 3004s
   747   823 94066.0139   21  226 76831.3286 101210.901  31.7%  8860 3051s
   832   920 93640.0456   23  309 76831.3286 101210.901  31.7%  8399 3098s
   933   985 93515.4620   24  395 76831.3286 101210.901  31.7%  7797 3148s
  1010  1077 93489.8966   25  363 76831.3286 101210.901  31.7%  7479 3205s
  1114  1157 92186.0733   19  198 76831.3286 101210.901  31.7%  7098 3280s
  1221  1240 92067.4265   21  190 76831.3286 101210.901  31.7%  6733 3356s
  1337  1262 91705.3171   26  380 76831.3286 101210.901  31.7%  6388 3404s
H 1338  1262                    76863.760032 101210.901  31.7%  6383 3404s
  1372  1344 88443.6631   27  381 76863.7600 101210.901  31.7%  6363 3463s
  1488  1444 87698.5627   28  248 76863.7600 101210.901  31.7%  6149 3526s
  1615  1569 87569.8995   29  246 76863.7600 101210.901  31.7%  5909 3586s
  1770  1603 85703.5289   52  203 76863.7600 101210.901  31.7%  5639 3600s

Cutting planes:
  Gomory: 5
  Implied bound: 333
  MIR: 1897
  Flow cover: 2542
  RLT: 81
  Relax-and-lift: 659

Explored 1830 nodes (10792588 simplex iterations) in 3600.06 seconds (4626.96 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 76863.8 76635 76528.1 ... 76049.2

Time limit reached
Best objective 7.686376003198e+04, best bound 1.012109013818e+05, gap 31.6757%
  WARNING: Time limit reached. Using best solution found (gap: 31.68%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.09s
  Master Objective (UB) = 76863.76, θ = 249504.90
  Upper Bound (UB) = 76863.76

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 249504.90
  [DEBUG]   ✓ Scenario 0: θ = 249504.90 ≤ Q = 249504.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 249504.90 ≤ Q = 249504.90 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 249504.90 ≤ Q = 249504.90 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 249504.90 ≤ Q = 249504.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 249504.90 ≤ Q = 261485.87 (slack: 11980.96)
  [DEBUG]   ✓ Scenario 5: θ = 249504.90 ≤ Q = 249504.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 249504.90 ≤ Q = 249504.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 249504.90 ≤ Q = 249504.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 249504.90 ≤ Q = 249504.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 249504.90 ≤ Q = 249504.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 249504.90 ≤ Q = 256352.01 (slack: 6847.11)
  [DEBUG]   ✓ Scenario 11: θ = 249504.90 ≤ Q = 249504.90 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 12] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x51e92679
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xae16d987
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.574328e+13
Presolve removed 2567 rows and 1858 columns
Presolve time: 0.01s
Presolved: 526 rows, 531 columns, 1487 nonzeros
Found heuristic solution: objective 8202528.1652
Variable types: 361 continuous, 170 integer (170 binary)

Root relaxation: objective -1.672270e+05, 254 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -167227.01    0  130 8202528.17 -167227.01   102%     -    0s
H    0     0                    -128484.4112 -167227.01  30.2%     -    0s
H    0     0                    -129892.5912 -167227.01  28.7%     -    0s
H    0     0                    -138876.9672 -144077.77  3.74%     -    0s
     0     0 -144077.77    0   51 -138876.97 -144077.77  3.74%     -    0s
H    0     0                    -143061.4303 -144012.38  0.66%     -    0s
     0     0 -144012.38    0   47 -143061.43 -144012.38  0.66%     -    0s
     0     0 -143998.75    0   46 -143061.43 -143998.75  0.66%     -    0s
     0     0 -143728.02    0   32 -143061.43 -143728.02  0.47%     -    0s
     0     0 -143718.91    0   30 -143061.43 -143718.91  0.46%     -    0s
H    0     0                    -143424.2781 -143718.91  0.21%     -    0s
     0     0 -143569.55    0   38 -143424.28 -143569.55  0.10%     -    0s
     0     0 -143501.32    0   13 -143424.28 -143501.32  0.05%     -    0s
     0     0 -143497.90    0    5 -143424.28 -143497.90  0.05%     -    0s
     0     0 -143453.43    0    3 -143424.28 -143453.43  0.02%     -    0s
     0     0 -143453.43    0    7 -143424.28 -143453.43  0.02%     -    0s
H    0     0                    -143429.2538 -143453.43  0.02%     -    0s
     0     0          -    0      -143429.25 -143443.42  0.01%     -    0s

Cutting planes:
  Gomory: 1
  Implied bound: 4
  MIR: 3
  Flow cover: 4

Explored 1 nodes (573 simplex iterations) in 0.13 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -143429 -143424 -143061 ... 1.57433e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.434292538013e+05, best bound -1.434434183591e+05, gap 0.0099%
  Subproblem solved in 0.16s
  Worst-case operational profit (Z_SP) = 240719.12
  Scenario: 18 demand increases, 42 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -143429.25
  [DEBUG]   S×d_nominal = 384148.38
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 384148.38 + -143429.25 = 240719.12
  [DEBUG]   Current θ from Master = 249504.90
  [DEBUG]   ⚠️  Z_SP ≤ θ by 8785.78 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 68077.98
  Lower Bound (LB) = 75334.45
  Gap (UB-LB) = 1529.3115, Absolute Gap = 1529.3115, Relative Gap = 0.019896
  Not converged yet (gap = 1529.31 > ε = 200)

  [DEBUG] Adding NEW scenario 12 to Master Problem...
  [DEBUG] New scenario pattern: 18 increases, 42 decreases
    [DEBUG] Scenario 12 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 12 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 12]
    [DEBUG]   - Total constraints in model: 200153
    [DEBUG]   - Total variables in model: 83380
  [DEBUG] Total scenarios in Master: 13
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 13
================================================================================
[Iteration 13] Solving Master Problem...
  Current scenarios in Master: 13
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 200153 rows, 83380 columns and 567717 nonzeros
Model fingerprint: 0xdbf11d20
Variable types: 81121 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 85345 rows and 34645 columns
Presolve time: 4.00s
Presolved: 114808 rows, 48735 columns, 689150 nonzeros
Variable types: 46476 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -322226.4806
Found heuristic solution: objective -174612.9734

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.41s

Barrier statistics:
 Dense cols : 679
 AA' NZ     : 3.891e+06
 Factor NZ  : 1.046e+07 (roughly 150 MB of memory)
 Factor Ops : 3.173e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.06828103e+07  2.20613325e+08  1.50e+05 2.00e+01  9.87e+04     6s
   1  -1.57914503e+07  2.05032930e+08  1.05e+05 1.02e+02  6.82e+04     6s
   2  -5.80710709e+06  1.69365373e+08  3.75e+04 1.75e+01  2.56e+04     6s
   3  -1.34817968e+06  1.22793471e+08  5.06e+03 2.08e+00  3.86e+03     6s
   4  -6.60247807e+05  6.45825851e+07  6.19e+02 3.21e-01  6.71e+02     7s
   5  -5.52388059e+05  3.87416930e+07  2.36e+02 1.58e-01  3.10e+02     7s
   6  -4.36967170e+05  2.57546457e+07  1.16e+02 9.74e-02  1.78e+02     7s
   7  -2.61700308e+05  1.75275306e+07  4.61e+01 6.23e-02  1.03e+02     7s
   8  -2.21758511e+05  1.47806214e+07  3.71e+01 5.14e-02  8.44e+01     7s
   9  -1.04478442e+05  6.92195527e+06  1.59e+01 2.08e-02  3.70e+01     7s
  10  -5.10076009e+04  3.75142259e+06  8.06e+00 1.03e-02  1.92e+01     7s
  11  -1.01934896e+04  1.96840850e+06  4.35e+00 5.35e-03  9.75e+00     7s
  12   2.87249388e+04  6.07555140e+05  2.06e+00 1.34e-03  2.81e+00     8s
  13   4.09036057e+04  3.98061528e+05  1.45e+00 9.04e-04  1.73e+00     8s
  14   5.05454226e+04  2.75393426e+05  1.13e+00 8.52e-04  1.09e+00     8s
  15   5.57562941e+04  2.34766641e+05  9.77e-01 8.12e-04  8.63e-01     8s
  16   7.02682801e+04  2.02377913e+05  6.05e-01 1.04e-03  6.35e-01     8s
  17   7.78532729e+04  1.65309485e+05  4.78e-01 1.81e-03  4.20e-01     8s
  18   8.54628914e+04  1.51684226e+05  3.79e-01 1.74e-03  3.18e-01     8s
  19   8.99067493e+04  1.42449420e+05  3.24e-01 1.77e-03  2.53e-01     8s
  20   9.39687863e+04  1.33610310e+05  2.78e-01 2.27e-03  1.91e-01     8s
  21   9.88550584e+04  1.30603441e+05  2.20e-01 2.43e-03  1.53e-01     9s
  22   1.04059058e+05  1.28652665e+05  1.61e-01 2.25e-03  1.18e-01     9s
  23   1.06277896e+05  1.25129386e+05  1.37e-01 3.38e-03  9.07e-02     9s
  24   1.09330377e+05  1.23278508e+05  1.04e-01 2.32e-03  6.72e-02     9s
  25   1.10794402e+05  1.22867850e+05  8.92e-02 1.97e-03  5.81e-02     9s
  26   1.14147657e+05  1.21651105e+05  5.42e-02 1.66e-03  3.61e-02     9s
  27   1.15155641e+05  1.21224117e+05  4.37e-02 1.60e-03  2.92e-02     9s
  28   1.15880236e+05  1.20867462e+05  3.62e-02 1.31e-03  2.40e-02     9s
  29   1.17322750e+05  1.20341576e+05  2.17e-02 1.02e-03  1.45e-02    10s
  30   1.18043405e+05  1.20167912e+05  1.49e-02 7.03e-04  1.02e-02    10s
  31   1.18391628e+05  1.20056583e+05  1.14e-02 5.97e-04  8.01e-03    10s
  32   1.18741538e+05  1.19875769e+05  8.09e-03 4.47e-04  5.46e-03    10s
  33   1.18977961e+05  1.19837142e+05  5.74e-03 4.09e-04  4.13e-03    10s
  34   1.19127212e+05  1.19774959e+05  4.29e-03 3.40e-04  3.11e-03    10s
  35   1.19193012e+05  1.19747884e+05  3.65e-03 3.21e-04  2.67e-03    10s
  36   1.19345987e+05  1.19688013e+05  2.23e-03 2.22e-04  1.64e-03    10s
  37   1.19412644e+05  1.19665778e+05  1.60e-03 2.09e-04  1.22e-03    11s
  38   1.19471242e+05  1.19645272e+05  1.05e-03 1.43e-04  8.36e-04    11s
  39   1.19535721e+05  1.19631594e+05  4.69e-04 1.13e-04  4.60e-04    11s
  40   1.19564160e+05  1.19609515e+05  2.18e-04 4.68e-05  2.17e-04    11s
  41   1.19581939e+05  1.19599389e+05  6.66e-05 2.02e-05  8.35e-05    11s
  42   1.19585823e+05  1.19597744e+05  3.69e-05 1.62e-05  5.70e-05    11s
  43   1.19586298e+05  1.19596151e+05  3.32e-05 1.24e-05  4.71e-05    11s
  44   1.19587626e+05  1.19594960e+05  2.38e-05 9.44e-06  3.51e-05    11s
  45   1.19589918e+05  1.19594224e+05  7.57e-06 7.66e-06  2.06e-05    12s
  46   1.19590206e+05  1.19593168e+05  5.54e-06 5.14e-06  1.41e-05    12s
  47   1.19590642e+05  1.19592778e+05  1.81e-06 4.20e-06  1.02e-05    12s
  48   1.19590961e+05  1.19591388e+05  4.24e-08 8.31e-07  2.03e-06    12s
  49   1.19591007e+05  1.19591077e+05  7.34e-09 1.36e-07  3.34e-07    12s
  50   1.19591013e+05  1.19591017e+05  1.74e-08 4.18e-09  1.92e-08    12s
  51   1.19591014e+05  1.19591014e+05  5.54e-07 2.13e-09  2.53e-09    13s

Barrier solved model in 51 iterations and 12.64 seconds (9.62 work units)
Optimal objective 1.19591014e+05


Root crossover log...

  103963 DPushes remaining with DInf 0.0000000e+00                13s
   25614 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                19s

   20153 PPushes remaining with PInf 1.3195892e-04                19s
    9876 PPushes remaining with PInf 1.5136019e-04                20s
       0 PPushes remaining with PInf 0.0000000e+00                22s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.1824569e+05     22s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   71404    1.1959101e+05   0.000000e+00   2.182457e+05     22s
   73342    1.1959101e+05   0.000000e+00   1.013902e+02     25s
   73589    1.1959101e+05   0.000000e+00   0.000000e+00     25s
   73589    1.1959101e+05   0.000000e+00   0.000000e+00     26s
Concurrent spin time: 3.66s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 1.195910e+05, 73589 iterations, 24.37 seconds (26.32 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 119591.014    0  132 -174612.97 119591.014   168%     -   30s
H    0     0                    -12651.63920 119591.014  1045%     -   31s
H    0     0                    50916.047587 119591.014   135%     -   32s
H    0     0                    57471.450802 119591.014   108%     -   32s
H    0     0                    63164.552004 119591.014  89.3%     -   33s
H    0     0                    71600.291296 119591.014  67.0%     -   33s
H    0     0                    72019.864463 119591.014  66.1%     -   33s
H    0     0                    72069.341393 119591.014  65.9%     -   33s
H    0     0                    72076.396632 119591.014  65.9%     -   33s
H    0     0                    72396.630399 119591.014  65.2%     -   33s
H    0     0                    72449.945967 119591.014  65.1%     -   33s
H    0     0                    72723.635234 119591.014  64.4%     -   33s
H    0     0                    73190.491791 119591.014  63.4%     -   33s
H    0     0                    73752.545292 119591.014  62.2%     -   33s
H    0     0                    75193.378435 114021.446  51.6%     -  161s
H    0     0                    75273.881941 114021.446  51.5%     -  162s
     0     0 114021.446    0  284 75273.8819 114021.446  51.5%     -  163s
H    0     0                    75512.606873 114021.426  51.0%     -  165s
H    0     0                    75674.546200 114021.426  50.7%     -  165s
H    0     0                    75922.632529 114021.426  50.2%     -  165s
H    0     0                    76339.332016 114021.426  49.4%     -  165s
     0     0 112291.064    0  323 76339.3320 112291.064  47.1%     -  300s
     0     0 112291.064    0  297 76339.3320 112291.064  47.1%     -  324s
     0     0 112291.064    0  306 76339.3320 112291.064  47.1%     -  328s
     0     0 112291.064    0  301 76339.3320 112291.064  47.1%     -  330s
     0     0 112291.064    0  306 76339.3320 112291.064  47.1%     -  331s
     0     0 108187.885    0  364 76339.3320 108187.885  41.7%     -  510s
     0     0 107451.620    0  468 76339.3320 107451.620  40.8%     -  587s
     0     0 107235.766    0  473 76339.3320 107235.766  40.5%     -  639s
     0     0 107188.694    0  476 76339.3320 107188.694  40.4%     -  658s
     0     0 107157.883    0  480 76339.3320 107157.883  40.4%     -  675s
     0     0 107131.176    0  481 76339.3320 107131.176  40.3%     -  693s
     0     0 107122.456    0  475 76339.3320 107122.456  40.3%     -  702s
     0     0 107079.995    0  480 76339.3320 107079.995  40.3%     -  718s
     0     0 107032.613    0  482 76339.3320 107032.613  40.2%     -  731s
     0     0 107000.493    0  485 76339.3320 107000.493  40.2%     -  747s
     0     0 106998.018    0  489 76339.3320 106998.018  40.2%     -  751s
     0     0 106993.388    0  482 76339.3320 106993.388  40.2%     -  755s
     0     0 106992.238    0  482 76339.3320 106992.238  40.2%     -  758s
     0     0 104449.469    0  313 76339.3320 104449.469  36.8%     -  913s
     0     0 103755.471    0  508 76339.3320 103755.471  35.9%     -  999s
     0     0 103498.465    0  479 76339.3320 103498.465  35.6%     - 1040s
     0     0 103388.698    0  468 76339.3320 103388.698  35.4%     - 1061s
     0     0 103320.289    0  466 76339.3320 103320.289  35.3%     - 1075s
     0     0 103223.254    0  466 76339.3320 103223.254  35.2%     - 1092s
     0     0 103167.907    0  508 76339.3320 103167.907  35.1%     - 1107s
     0     0 103135.062    0  521 76339.3320 103135.062  35.1%     - 1119s
     0     0 103124.349    0  526 76339.3320 103124.349  35.1%     - 1127s
     0     0 103113.860    0  530 76339.3320 103113.860  35.1%     - 1134s
     0     0 103094.249    0  542 76339.3320 103094.249  35.0%     - 1140s
     0     0 103084.861    0  532 76339.3320 103084.861  35.0%     - 1147s
     0     0 103072.314    0  538 76339.3320 103072.314  35.0%     - 1156s
     0     0 103064.733    0  536 76339.3320 103064.733  35.0%     - 1162s
     0     0 103064.169    0  529 76339.3320 103064.169  35.0%     - 1165s
     0     0 102485.501    0  329 76339.3320 102485.501  34.2%     - 1226s
     0     0 102340.104    0  322 76339.3320 102340.104  34.1%     - 1252s
     0     0 102221.735    0  324 76339.3320 102221.735  33.9%     - 1271s
     0     0 102189.983    0  323 76339.3320 102189.983  33.9%     - 1288s
     0     0 102177.518    0  319 76339.3320 102177.518  33.8%     - 1296s
     0     0 102155.490    0  327 76339.3320 102155.490  33.8%     - 1306s
     0     0 102147.017    0  322 76339.3320 102147.017  33.8%     - 1312s
     0     0 102136.503    0  332 76339.3320 102136.503  33.8%     - 1319s
     0     0 102133.936    0  337 76339.3320 102133.936  33.8%     - 1322s
     0     0 102079.068    0  380 76339.3320 102079.068  33.7%     - 1342s
     0     0 102050.483    0  334 76339.3320 102050.483  33.7%     - 1352s
     0     0 102025.181    0  373 76339.3320 102025.181  33.6%     - 1367s
     0     0 102020.269    0  371 76339.3320 102020.269  33.6%     - 1372s
     0     0 102018.740    0  330 76339.3320 102018.740  33.6%     - 1376s
     0     0 101882.667    0  482 76339.3320 101882.667  33.5%     - 1408s
H    0     0                    76450.202471 101882.603  33.3%     - 1424s
     0     0 101842.891    0  493 76450.2025 101842.891  33.2%     - 1444s
     0     0 101816.287    0  347 76450.2025 101816.287  33.2%     - 1456s
     0     0 101809.878    0  347 76450.2025 101809.878  33.2%     - 1461s
     0     0 101803.595    0  343 76450.2025 101803.595  33.2%     - 1465s
     0     0 101801.715    0  339 76450.2025 101801.715  33.2%     - 1467s
     0     0 101754.787    0  339 76450.2025 101754.787  33.1%     - 1488s
H    0     0                    76502.586732 101754.683  33.0%     - 1488s
     0     0 101745.648    0  335 76502.5867 101745.648  33.0%     - 1498s
     0     0 101741.117    0  489 76502.5867 101741.117  33.0%     - 1506s
     0     0 101737.224    0  470 76502.5867 101737.224  33.0%     - 1511s
     0     0 101736.460    0  338 76502.5867 101736.460  33.0%     - 1513s
     0     0 101716.255    0  472 76502.5867 101716.255  33.0%     - 1525s
H    0     0                    76543.007951 101716.107  32.9%     - 1540s
H    0     0                    76605.091493 101716.107  32.8%     - 1544s
     0     0 101709.213    0  344 76605.0915 101709.213  32.8%     - 1553s
     0     0 101707.879    0  338 76605.0915 101707.879  32.8%     - 1554s
     0     0 101669.293    0  324 76605.0915 101669.293  32.7%     - 1575s
     0     0 101647.911    0  482 76605.0915 101647.911  32.7%     - 1589s
     0     0 101642.377    0  502 76605.0915 101642.377  32.7%     - 1596s
     0     0 101632.743    0  333 76605.0915 101632.743  32.7%     - 1602s
     0     0 101629.925    0  487 76605.0915 101629.925  32.7%     - 1608s
     0     0 101628.254    0  483 76605.0915 101628.254  32.7%     - 1613s
     0     0 101584.984    0  479 76605.0915 101584.984  32.6%     - 1630s
H    0     0                    76648.899812 101584.714  32.5%     - 1652s
     0     0 101523.078    0  379 76648.8998 101523.078  32.5%     - 1688s
     0     0 101503.376    0  474 76648.8998 101503.376  32.4%     - 1705s
     0     0 101490.075    0  490 76648.8998 101490.075  32.4%     - 1718s
     0     0 101484.575    0  488 76648.8998 101484.575  32.4%     - 1726s
     0     0 101482.516    0  490 76648.8998 101482.516  32.4%     - 1731s
     0     0 101454.457    0  334 76648.8998 101454.457  32.4%     - 1748s
     0     0 101450.571    0  335 76648.8998 101450.571  32.4%     - 1752s
     0     0 101448.106    0  336 76648.8998 101448.106  32.4%     - 1760s
     0     0 101442.990    0  339 76648.8998 101442.990  32.3%     - 1768s
     0     0 101442.209    0  339 76648.8998 101442.209  32.3%     - 1771s
     0     0 101439.782    0  339 76648.8998 101439.782  32.3%     - 1775s
     0     0 101439.537    0  339 76648.8998 101439.537  32.3%     - 1779s
     0     2 101437.837    0  339 76648.8998 101437.837  32.3%     - 2039s
     1     3 100729.654    1  302 76648.8998 101437.837  32.3% 21445 2086s
     2     4 101379.502    1  338 76648.8998 101379.502  32.3% 12718 2104s
     3     6 101153.133    2  318 76648.8998 101379.468  32.3% 12298 2133s
     5    10 100331.836    3  314 76648.8998 101379.468  32.3% 13263 2190s
     9    18 99932.2808    4  319 76648.8998 100992.018  31.8% 14028 2248s
    17    36 99757.1298    5  322 76648.8998 100992.018  31.8% 14188 2285s
    35    50 100116.200    6  313 76648.8998 100482.162  31.1% 17490 2423s
    49    75 97647.4980    7  316 76648.8998 100482.162  31.1% 22812 2511s
    74   111 97501.0561    8  295 76648.8998 100482.162  31.1% 18026 2686s
   110   146 96953.6043   10  296 76648.8998 100482.162  31.1% 16787 2753s
   145   207 96939.8991   11  286 76648.8998 100482.162  31.1% 14724 2822s
   206   278 95951.0730   16  281 76648.8998 100482.162  31.1% 12497 2887s
   277   356 95758.8684   17  283 76648.8998 100482.162  31.1% 11026 2944s
   355   386 95445.8803   18  401 76648.8998 100482.162  31.1% 10027 2987s
   385   419 95293.4438   19  404 76648.8998 100482.162  31.1% 10083 3044s
   418   451 94886.0499   20  269 76648.8998 100482.162  31.1%  9868 3083s
H  432   451                    76663.742789 100482.162  31.1%  9971 3083s
   450   532 94811.1755   21  273 76663.7428 100482.162  31.1%  9967 3151s
   531   615 94124.1129   23  260 76663.7428 100482.162  31.1%  9333 3200s
   614   680 93944.3332   26  261 76663.7428 100482.162  31.1%  8866 3250s
   679   753 93402.2219   27  244 76663.7428 100482.162  31.1%  8568 3303s
   752   782 93114.9789   28  246 76663.7428 100482.162  31.1%  8241 3545s
   781   811 92985.2094   29  238 76663.7428 100482.162  31.1%  8176 3600s

Cutting planes:
  Gomory: 16
  Implied bound: 176
  MIR: 2329
  Flow cover: 2564
  RLT: 102
  Relax-and-lift: 857

Explored 810 nodes (7398575 simplex iterations) in 3600.08 seconds (4486.46 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 76663.7 76648.9 76605.1 ... 75512.6

Time limit reached
Best objective 7.666374278850e+04, best bound 1.004821624159e+05, gap 31.0687%
  WARNING: Time limit reached. Using best solution found (gap: 31.07%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.10s
  Master Objective (UB) = 76663.74, θ = 249769.71
  Upper Bound (UB) = 76663.74

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 249769.71
  [DEBUG]   ✓ Scenario 0: θ = 249769.71 ≤ Q = 249769.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 249769.71 ≤ Q = 249769.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 249769.71 ≤ Q = 249769.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 249769.71 ≤ Q = 249769.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 249769.71 ≤ Q = 249769.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 249769.71 ≤ Q = 249769.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 249769.71 ≤ Q = 249769.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 249769.71 ≤ Q = 249769.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 249769.71 ≤ Q = 249769.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 249769.71 ≤ Q = 249769.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 249769.71 ≤ Q = 249769.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 249769.71 ≤ Q = 249769.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 249769.71 ≤ Q = 249769.71 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 13] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0xe72d013
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xf18d2fed
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.577009e+13
Presolve removed 2567 rows and 1858 columns
Presolve time: 0.01s
Presolved: 526 rows, 531 columns, 1486 nonzeros
Found heuristic solution: objective 8222613.1607
Variable types: 361 continuous, 170 integer (170 binary)

Root relaxation: objective -1.665257e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -166525.70    0  122 8222613.16 -166525.70   102%     -    0s
H    0     0                    -130172.1992 -166525.70  27.9%     -    0s
H    0     0                    -131590.0055 -166525.70  26.5%     -    0s
     0     0 -142074.56    0   87 -131590.01 -142074.56  7.97%     -    0s
H    0     0                    -140055.7665 -142011.10  1.40%     -    0s
     0     0 -141141.56    0   87 -140055.77 -141141.56  0.78%     -    0s
H    0     0                    -140551.4447 -141133.61  0.41%     -    0s
     0     0 -141130.20    0   86 -140551.44 -141130.20  0.41%     -    0s
     0     0 -140857.05    0   57 -140551.44 -140857.05  0.22%     -    0s
     0     0 -140815.46    0   40 -140551.44 -140815.46  0.19%     -    0s
     0     0 -140752.99    0   41 -140551.44 -140752.99  0.14%     -    0s
     0     0 -140749.22    0   42 -140551.44 -140749.22  0.14%     -    0s
     0     0 -140668.99    0   40 -140551.44 -140668.99  0.08%     -    0s
     0     0 -140666.85    0   24 -140551.44 -140666.85  0.08%     -    0s
     0     0 -140666.00    0   17 -140551.44 -140666.00  0.08%     -    0s
     0     0 -140658.07    0   15 -140551.44 -140658.07  0.08%     -    0s
     0     0 -140658.07    0    9 -140551.44 -140658.07  0.08%     -    0s
     0     0 -140658.07    0   10 -140551.44 -140658.07  0.08%     -    0s
     0     0 -140653.41    0    9 -140551.44 -140653.41  0.07%     -    0s
     0     0 -140653.41    0   21 -140551.44 -140653.41  0.07%     -    0s
*    0     0               0    -140604.4960 -140604.50  0.00%     -    0s

Cutting planes:
  Gomory: 13
  MIR: 9
  Flow cover: 10
  Relax-and-lift: 6

Explored 1 nodes (832 simplex iterations) in 0.17 seconds (0.05 work units)
Thread count was 32 (of 32 available processors)

Solution count 8: -140604 -140551 -140151 ... 1.57701e+13
No other solutions better than -140604

Optimal solution found (tolerance 1.00e-04)
Best objective -1.406044960446e+05, best bound -1.406044960446e+05, gap 0.0000%
  Subproblem solved in 0.20s
  Worst-case operational profit (Z_SP) = 243543.88
  Scenario: 36 demand increases, 24 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -140604.50
  [DEBUG]   S×d_nominal = 384148.38
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 384148.38 + -140604.50 = 243543.88
  [DEBUG]   Current θ from Master = 249769.71
  [DEBUG]   ⚠️  Z_SP ≤ θ by 6225.83 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 70437.91
  Lower Bound (LB) = 75334.45
  Gap (UB-LB) = 1329.2942, Absolute Gap = 1329.2942, Relative Gap = 0.017339
  Not converged yet (gap = 1329.29 > ε = 200)

  [DEBUG] Adding NEW scenario 13 to Master Problem...
  [DEBUG] New scenario pattern: 36 increases, 24 decreases
    [DEBUG] Scenario 13 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 13 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 13]
    [DEBUG]   - Total constraints in model: 215443
    [DEBUG]   - Total variables in model: 89620
  [DEBUG] Total scenarios in Master: 14
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 14
================================================================================
[Iteration 14] Solving Master Problem...
  Current scenarios in Master: 14
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 215443 rows, 89620 columns and 610963 nonzeros
Model fingerprint: 0xfe603402
Variable types: 87361 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 91910 rows and 37310 columns
Presolve time: 4.32s
Presolved: 123533 rows, 52310 columns, 757973 nonzeros
Variable types: 50051 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -284372.9440
Found heuristic solution: objective -174612.9734

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.47s

Barrier statistics:
 Dense cols : 722
 AA' NZ     : 4.797e+06
 Factor NZ  : 1.130e+07 (roughly 160 MB of memory)
 Factor Ops : 2.499e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.22628294e+07  2.36576917e+08  1.63e+05 2.15e+01  1.06e+05     7s
   1  -1.72278993e+07  2.21643925e+08  1.16e+05 1.01e+02  7.47e+04     7s
   2  -6.81325335e+06  1.83434087e+08  4.44e+04 1.69e+01  2.98e+04     7s
   3  -1.46659730e+06  1.34709148e+08  5.96e+03 2.07e+00  4.44e+03     7s
   4  -6.93764495e+05  6.92708749e+07  8.46e+02 4.06e-01  8.05e+02     7s
   5  -5.97795024e+05  4.02471972e+07  4.28e+02 1.87e-01  4.07e+02     7s
   6  -4.40098752e+05  2.83873669e+07  1.18e+02 1.23e-01  1.85e+02     7s
   7  -3.16779294e+05  1.91258891e+07  5.65e+01 7.62e-02  1.10e+02     8s
   8  -2.03310401e+05  1.36102117e+07  3.08e+01 5.02e-02  7.17e+01     8s
   9  -1.22305884e+05  5.94178316e+06  1.49e+01 1.82e-02  2.98e+01     8s
  10  -7.68182898e+04  2.45657647e+06  5.05e+00 6.58e-03  1.17e+01     8s
  11  -3.41596335e+04  9.29978563e+05  2.26e+00 2.27e-03  4.37e+00     8s
  12   3.23193371e+03  4.21094302e+05  1.13e+00 9.48e-04  1.88e+00     8s
  13   2.36813829e+04  2.94620873e+05  7.77e-01 6.62e-04  1.22e+00     8s
  14   4.71707175e+04  2.43047901e+05  5.59e-01 1.45e-03  8.77e-01     8s
  15   5.43232652e+04  1.96043875e+05  4.98e-01 1.41e-03  6.36e-01     9s
  16   6.69137784e+04  1.70727014e+05  3.98e-01 2.12e-03  4.66e-01     9s
  17   7.56608132e+04  1.53397870e+05  3.22e-01 1.73e-03  3.49e-01     9s
  18   8.17169876e+04  1.46328714e+05  2.67e-01 2.14e-03  2.90e-01     9s
  19   8.59569673e+04  1.36607306e+05  2.30e-01 1.98e-03  2.28e-01     9s
  20   9.39135544e+04  1.31165721e+05  1.69e-01 2.63e-03  1.68e-01     9s
  21   9.70931202e+04  1.27941758e+05  1.46e-01 2.63e-03  1.39e-01     9s
  22   9.93941937e+04  1.26597516e+05  1.30e-01 2.58e-03  1.22e-01    10s
  23   1.03949643e+05  1.24519929e+05  9.71e-02 2.62e-03  9.26e-02    10s
  24   1.08002229e+05  1.22626669e+05  6.88e-02 3.04e-03  6.58e-02    10s
  25   1.09644274e+05  1.21270396e+05  5.78e-02 1.56e-03  5.24e-02    10s
  26   1.13275860e+05  1.20688213e+05  3.36e-02 1.77e-03  3.33e-02    10s
  27   1.15826514e+05  1.19990712e+05  1.71e-02 2.04e-03  1.87e-02    10s
  28   1.17098374e+05  1.19326201e+05  9.08e-03 1.53e-03  1.00e-02    10s
  29   1.17495595e+05  1.19168534e+05  6.63e-03 1.14e-03  7.51e-03    10s
  30   1.17978327e+05  1.18991796e+05  3.75e-03 7.33e-04  4.54e-03    11s
  31   1.18198520e+05  1.18951418e+05  2.47e-03 6.43e-04  3.37e-03    11s
  32   1.18395689e+05  1.18798019e+05  1.36e-03 3.08e-04  1.80e-03    11s
  33   1.18526821e+05  1.18710047e+05  6.44e-04 1.25e-04  8.21e-04    11s
  34   1.18615329e+05  1.18680026e+05  1.75e-04 5.79e-05  2.89e-04    11s
  35   1.18641354e+05  1.18663464e+05  4.85e-05 1.98e-05  9.87e-05    11s
  36   1.18650967e+05  1.18654798e+05  8.48e-06 2.60e-06  1.71e-05    11s
  37   1.18653381e+05  1.18653498e+05  1.90e-07 5.80e-08  5.22e-07    12s
  38   1.18653460e+05  1.18653460e+05  3.70e-10 1.35e-10  5.24e-10    12s

Barrier solved model in 38 iterations and 11.76 seconds (9.14 work units)
Optimal objective 1.18653460e+05


Root crossover log...

  113253 DPushes remaining with DInf 0.0000000e+00                12s
   16403 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                19s

    2688 PPushes remaining with PInf 1.6123776e-05                19s
       0 PPushes remaining with PInf 0.0000000e+00                20s

  Push phase complete: Pinf 0.0000000e+00, Dinf 9.0295029e-02     20s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   58867    1.1865346e+05   0.000000e+00   9.029503e-02     20s
   58871    1.1865346e+05   0.000000e+00   0.000000e+00     20s
   58871    1.1865346e+05   0.000000e+00   0.000000e+00     20s
Concurrent spin time: 0.74s

Solved with barrier

Root relaxation: objective 1.186535e+05, 58871 iterations, 15.83 seconds (19.92 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 118653.460    0   97 -174612.97 118653.460   168%     -   22s
H    0     0                    -170399.4988 118653.460   170%     -   22s
H    0     0                    -169336.6984 118653.460   170%     -   23s
H    0     0                    -163858.0883 118653.460   172%     -   23s
H    0     0                    -156992.3270 118653.460   176%     -   24s
H    0     0                    -15862.69809 118653.460   848%     -   25s
H    0     0                    41097.290905 118653.460   189%     -   26s
H    0     0                    53884.507598 118653.460   120%     -   26s
H    0     0                    57215.917587 118653.460   107%     -   27s
H    0     0                    62651.324623 118653.460  89.4%     -   27s
H    0     0                    66926.701476 118653.460  77.3%     -   27s
H    0     0                    71377.748493 118653.460  66.2%     -   28s
H    0     0                    72486.826550 118653.460  63.7%     -   28s
H    0     0                    72836.755976 118653.460  62.9%     -   28s
H    0     0                    73089.112672 118653.460  62.3%     -   28s
H    0     0                    73443.723988 118653.460  61.6%     -   28s
H    0     0                    73454.757842 118653.460  61.5%     -   28s
H    0     0                    73569.123680 118653.460  61.3%     -   28s
H    0     0                    73592.908031 118653.460  61.2%     -   28s
H    0     0                    73702.778878 113083.511  53.4%     -  181s
H    0     0                    73809.063141 113083.511  53.2%     -  181s
H    0     0                    73930.672504 113083.511  53.0%     -  181s
H    0     0                    74062.717732 113083.511  52.7%     -  181s
H    0     0                    74254.945272 113083.511  52.3%     -  181s
     0     0 113083.511    0  270 74254.9453 113083.511  52.3%     -  181s
H    0     0                    74267.731952 113083.172  52.3%     -  183s
H    0     0                    74474.666313 113083.172  51.8%     -  183s
     0     0 111202.683    0  294 74474.6663 111202.683  49.3%     -  290s
     0     0 111178.072    0  300 74474.6663 111178.072  49.3%     -  319s
     0     0 111178.072    0  293 74474.6663 111178.072  49.3%     -  333s
     0     0 111178.072    0  297 74474.6663 111178.072  49.3%     -  341s
     0     0 111178.072    0  296 74474.6663 111178.072  49.3%     -  345s
     0     0 111178.072    0  297 74474.6663 111178.072  49.3%     -  347s
     0     0 108116.641    0  260 74474.6663 108116.641  45.2%     -  460s
H    0     0                    74514.368433 106821.519  43.4%     -  534s
H    0     0                    74752.512966 106821.519  42.9%     -  534s
H    0     0                    75300.683242 106821.519  41.9%     -  534s
H    0     0                    76129.769368 106821.519  40.3%     -  534s
     0     0 106821.519    0  276 76129.7694 106821.519  40.3%     -  535s
H    0     0                    76300.926483 106630.711  39.8%     -  585s
H    0     0                    76434.466298 106630.711  39.5%     -  585s
     0     0 106630.711    0  298 76434.4663 106630.711  39.5%     -  586s
     0     0 106523.177    0  292 76434.4663 106523.177  39.4%     -  607s
     0     0 106510.863    0  296 76434.4663 106510.863  39.3%     -  615s
     0     0 106341.963    0  306 76434.4663 106341.963  39.1%     -  656s
     0     0 106304.860    0  297 76434.4663 106304.860  39.1%     -  687s
     0     0 106279.938    0  298 76434.4663 106279.938  39.0%     -  709s
     0     0 106216.658    0  292 76434.4663 106216.658  39.0%     -  732s
     0     0 106186.781    0  293 76434.4663 106186.781  38.9%     -  758s
     0     0 106178.381    0  298 76434.4663 106178.381  38.9%     -  770s
     0     0 106174.085    0  297 76434.4663 106174.085  38.9%     -  777s
     0     0 106160.601    0  297 76434.4663 106160.601  38.9%     -  782s
     0     0 106159.642    0  297 76434.4663 106159.642  38.9%     -  784s
     0     0 104748.535    0  298 76434.4663 104748.535  37.0%     -  897s
H    0     0                    76453.033988 104303.607  36.4%     -  971s
     0     0 104303.607    0  290 76453.0340 104303.607  36.4%     -  971s
     0     0 104107.710    0  305 76453.0340 104107.710  36.2%     - 1021s
     0     0 103969.697    0  310 76453.0340 103969.697  36.0%     - 1066s
     0     0 103933.466    0  309 76453.0340 103933.466  35.9%     - 1083s
     0     0 103912.622    0  313 76453.0340 103912.622  35.9%     - 1095s
     0     0 103879.476    0  311 76453.0340 103879.476  35.9%     - 1105s
     0     0 103871.316    0  314 76453.0340 103871.316  35.9%     - 1111s
     0     0 103869.989    0  313 76453.0340 103869.989  35.9%     - 1113s
     0     0 102817.546    0  443 76453.0340 102817.546  34.5%     - 1196s
     0     0 102635.216    0  412 76453.0340 102635.216  34.2%     - 1231s
     0     0 102602.877    0  321 76453.0340 102602.877  34.2%     - 1248s
     0     0 102572.094    0  321 76453.0340 102572.094  34.2%     - 1258s
     0     0 102561.558    0  325 76453.0340 102561.558  34.1%     - 1264s
     0     0 102548.292    0  443 76453.0340 102548.292  34.1%     - 1271s
     0     0 102537.549    0  320 76453.0340 102537.549  34.1%     - 1277s
     0     0 102533.940    0  319 76453.0340 102533.940  34.1%     - 1280s
     0     0 102523.307    0  322 76453.0340 102523.307  34.1%     - 1291s
     0     0 102511.703    0  325 76453.0340 102511.703  34.1%     - 1298s
     0     0 102508.660    0  329 76453.0340 102508.660  34.1%     - 1300s
     0     0 102503.513    0  327 76453.0340 102503.513  34.1%     - 1304s
     0     0 102500.355    0  329 76453.0340 102500.355  34.1%     - 1310s
     0     0 102483.181    0  440 76453.0340 102483.181  34.0%     - 1317s
     0     0 102473.909    0  438 76453.0340 102473.909  34.0%     - 1322s
     0     0 102472.018    0  438 76453.0340 102472.018  34.0%     - 1324s
     0     0 102258.783    0  322 76453.0340 102258.783  33.8%     - 1353s
     0     0 102214.782    0  328 76453.0340 102214.782  33.7%     - 1366s
     0     0 102210.185    0  331 76453.0340 102210.185  33.7%     - 1368s
     0     0 102204.577    0  335 76453.0340 102204.577  33.7%     - 1372s
     0     0 102201.006    0  335 76453.0340 102201.006  33.7%     - 1373s
     0     0 102198.621    0  333 76453.0340 102198.621  33.7%     - 1375s
     0     0 102198.018    0  333 76453.0340 102198.018  33.7%     - 1375s
     0     0 102159.561    0  338 76453.0340 102159.561  33.6%     - 1386s
H    0     0                    76477.458392 102159.498  33.6%     - 1406s
     0     0 102120.242    0  339 76477.4584 102120.242  33.5%     - 1419s
     0     0 102112.785    0  337 76477.4584 102112.785  33.5%     - 1424s
     0     0 102108.994    0  331 76477.4584 102108.994  33.5%     - 1426s
     0     0 102106.289    0  334 76477.4584 102106.289  33.5%     - 1428s
     0     0 102103.347    0  334 76477.4584 102103.347  33.5%     - 1429s
     0     0 102103.121    0  334 76477.4584 102103.121  33.5%     - 1430s
     0     0 102027.553    0  416 76477.4584 102027.553  33.4%     - 1451s
     0     0 102006.026    0  419 76477.4584 102006.026  33.4%     - 1462s
     0     0 102001.517    0  416 76477.4584 102001.517  33.4%     - 1466s
     0     0 101997.740    0  414 76477.4584 101997.740  33.4%     - 1473s
     0     0 101994.017    0  420 76477.4584 101994.017  33.4%     - 1477s
     0     0 101992.858    0  422 76477.4584 101992.858  33.4%     - 1480s
     0     0 101960.650    0  408 76477.4584 101960.650  33.3%     - 1498s
     0     0 101938.012    0  403 76477.4584 101938.012  33.3%     - 1555s
     0     0 101923.214    0  405 76477.4584 101923.214  33.3%     - 1562s
     0     0 101916.490    0  409 76477.4584 101916.490  33.3%     - 1566s
     0     0 101913.783    0  410 76477.4584 101913.783  33.3%     - 1569s
     0     0 101912.775    0  416 76477.4584 101912.775  33.3%     - 1571s
     0     0 101887.080    0  332 76477.4584 101887.080  33.2%     - 1580s
     0     0 101866.411    0  342 76477.4584 101866.411  33.2%     - 1593s
     0     0 101856.148    0  430 76477.4584 101856.148  33.2%     - 1599s
     0     0 101831.069    0  420 76477.4584 101831.069  33.2%     - 1613s
     0     0 101829.996    0  425 76477.4584 101829.996  33.2%     - 1615s
     0     0 101823.346    0  338 76477.4584 101823.346  33.1%     - 1622s
     0     0 101821.779    0  426 76477.4584 101821.779  33.1%     - 1625s
     0     0 101820.513    0  334 76477.4584 101820.513  33.1%     - 1629s
     0     0 101818.647    0  341 76477.4584 101818.647  33.1%     - 1634s
     0     0 101817.256    0  430 76477.4584 101817.256  33.1%     - 1641s
     0     0 101815.569    0  337 76477.4584 101815.569  33.1%     - 1644s
     0     0 101808.790    0  341 76477.4584 101808.790  33.1%     - 1649s
     0     0 101808.269    0  341 76477.4584 101808.269  33.1%     - 1653s
     0     2 101807.741    0  341 76477.4584 101807.741  33.1%     - 1957s
     1     3 101356.833    1  289 76477.4584 101807.741  33.1% 15412 2002s
     2     4 101698.459    1  334 76477.4584 101698.459  33.0% 10308 2019s
     3     6 100631.364    2  310 76477.4584 101698.352  33.0%  9952 2047s
     5    11 99550.3272    3  288 76477.4584 101698.352  33.0% 10981 2084s
    10    20 98817.2062    4  282 76477.4584 101515.764  32.7% 11289 2139s
    19    29 97019.5900    5  286 76477.4584 101513.366  32.7% 18575 2254s
    28    57 98389.5356    4  317 76477.4584 101458.134  32.7% 17847 2488s
    56    89 97924.3124    5  324 76477.4584 101458.134  32.7% 22638 2548s
    88   209 97834.1375    6  319 76477.4584 101458.134  32.7% 20055 2633s
   208   271 96748.1978   10  381 76477.4584 101458.134  32.7% 12172 2706s
   270   322 96613.9348   11  369 76477.4584 101458.134  32.7% 10872 2749s
   321   363 93251.5959   12  277 76477.4584 101458.134  32.7% 10482 2796s
   364   391 92738.7008   13  272 76477.4584 101458.134  32.7% 10339 2833s
   392   414 92508.1547   14  239 76477.4584 101458.134  32.7% 10730 2871s
   415   446 92200.9197   15  234 76477.4584 101458.134  32.7% 10863 2909s
   447   470 91902.5896   16  228 76477.4584 101458.134  32.7% 11152 2942s
   471   497 91813.3818   17  216 76477.4584 101458.134  32.7% 11102 2984s
   498   527 91719.3006   18  203 76477.4584 101458.134  32.7% 11154 3022s
   528   563 91569.9194   19  206 76477.4584 101458.134  32.7% 11228 3062s
   564   599 91475.3272   20  206 76477.4584 101458.134  32.7% 11120 3180s
   600   638 91127.0696   21  199 76477.4584 101458.134  32.7% 10900 3209s
H  621   638                    76498.242786 101458.134  32.6% 10741 3209s
   641   714 91044.6092   22  196 76498.2428 101458.134  32.6% 10686 3248s
   726   785 89557.1249   25  192 76498.2428 101458.134  32.6% 10204 3288s
   813   847 89036.6333   27  184 76498.2428 101458.134  32.6%  9796 3323s
   883   916 88557.8682   30  279 76498.2428 101458.134  32.6%  9645 3358s
   960   985 77114.1743   32  160 76498.2428 101458.134  32.6%  9565 3397s
  1046  1058     cutoff   33      76498.2428 101458.134  32.6%  9354 3434s
  1137  1157 87868.7758   33  331 76498.2428 101458.134  32.6%  9244 3474s
  1248  1182 87486.7899   41  184 76498.2428 101458.134  32.6%  8967 3514s
  1283  1218 84382.1202   42  280 76498.2428 101458.134  32.6%  8952 3545s
  1321  1261 84327.8014   43  179 76498.2428 101458.134  32.6%  8921 3587s
  1372  1290 84249.8918   44  168 76498.2428 101458.134  32.6%  8878 3600s

Cutting planes:
  Learned: 1
  Gomory: 2
  Implied bound: 132
  MIR: 1709
  Flow cover: 2039
  RLT: 58
  Relax-and-lift: 236

Explored 1411 nodes (13009485 simplex iterations) in 3600.08 seconds (4510.79 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 76498.2 76477.5 76453 ... 74474.7

Time limit reached
Best objective 7.649824278649e+04, best bound 1.014581340445e+05, gap 32.6281%
  WARNING: Time limit reached. Using best solution found (gap: 32.63%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.10s
  Master Objective (UB) = 76498.24, θ = 249488.71
  Upper Bound (UB) = 76498.24

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 249488.71
  [DEBUG]   ✓ Scenario 0: θ = 249488.71 ≤ Q = 249488.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 249488.71 ≤ Q = 249488.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 249488.71 ≤ Q = 249488.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 249488.71 ≤ Q = 249488.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 249488.71 ≤ Q = 249488.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 249488.71 ≤ Q = 249488.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 249488.71 ≤ Q = 249488.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 249488.71 ≤ Q = 249488.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 249488.71 ≤ Q = 249488.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 249488.71 ≤ Q = 249488.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 249488.71 ≤ Q = 249488.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 249488.71 ≤ Q = 249488.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 249488.71 ≤ Q = 249488.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 249488.71 ≤ Q = 249488.71 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 14] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0xb7a806a
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xf4857f96
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.573240e+13
Presolve removed 2566 rows and 1857 columns
Presolve time: 0.01s
Presolved: 527 rows, 532 columns, 1487 nonzeros
Found heuristic solution: objective 8199676.6202
Variable types: 362 continuous, 170 integer (170 binary)

Root relaxation: objective -1.668090e+05, 250 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -166809.00    0  124 8199676.62 -166809.00   102%     -    0s
H    0     0                    -130085.0749 -166809.00  28.2%     -    0s
H    0     0                    -131526.8201 -166809.00  26.8%     -    0s
     0     0 -143135.15    0   54 -131526.82 -143135.15  8.83%     -    0s
H    0     0                    -141552.1465 -143056.32  1.06%     -    0s
H    0     0                    -141860.8397 -143056.32  0.84%     -    0s
     0     0 -142504.38    0   65 -141860.84 -142504.38  0.45%     -    0s
H    0     0                    -142192.1793 -142492.90  0.21%     -    0s
     0     0 -142435.50    0   57 -142192.18 -142435.50  0.17%     -    0s
     0     0 -142429.22    0   48 -142192.18 -142429.22  0.17%     -    0s
     0     0 -142426.83    0   48 -142192.18 -142426.83  0.17%     -    0s
     0     0 -142382.48    0   33 -142192.18 -142382.48  0.13%     -    0s
     0     0 -142382.48    0   40 -142192.18 -142382.48  0.13%     -    0s
     0     0 -142382.48    0   41 -142192.18 -142382.48  0.13%     -    0s
     0     0 -142382.48    0   29 -142192.18 -142382.48  0.13%     -    0s
     0     0 -142382.48    0   26 -142192.18 -142382.48  0.13%     -    0s
     0     0 -142366.14    0   18 -142192.18 -142366.14  0.12%     -    0s
     0     0 -142322.88    0    8 -142192.18 -142322.88  0.09%     -    0s
     0     0 -142304.21    0    6 -142192.18 -142304.21  0.08%     -    0s
     0     0 -142295.28    0    5 -142192.18 -142295.28  0.07%     -    0s
     0     0 -142270.66    0    2 -142192.18 -142270.66  0.06%     -    0s
H    0     0                    -142252.4615 -142268.32  0.01%     -    0s

Cutting planes:
  Gomory: 11
  MIR: 35
  Flow cover: 8
  RLT: 2

Explored 1 nodes (719 simplex iterations) in 0.21 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -142252 -142192 -141861 ... 1.57324e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.422524614841e+05, best bound -1.422648506744e+05, gap 0.0087%
  Subproblem solved in 0.24s
  Worst-case operational profit (Z_SP) = 241895.91
  Scenario: 18 demand increases, 42 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -142252.46
  [DEBUG]   S×d_nominal = 384148.38
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 384148.38 + -142252.46 = 241895.91
  [DEBUG]   Current θ from Master = 249488.71
  [DEBUG]   ⚠️  Z_SP ≤ θ by 7592.79 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 68905.45
  Lower Bound (LB) = 75334.45
  Gap (UB-LB) = 1163.7942, Absolute Gap = 1163.7942, Relative Gap = 0.015213
  Not converged yet (gap = 1163.79 > ε = 200)

  [DEBUG] Adding NEW scenario 14 to Master Problem...
  [DEBUG] New scenario pattern: 18 increases, 42 decreases
    [DEBUG] Scenario 14 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 14 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 14]
    [DEBUG]   - Total constraints in model: 230733
    [DEBUG]   - Total variables in model: 95860
  [DEBUG] Total scenarios in Master: 15
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 15
================================================================================
[Iteration 15] Solving Master Problem...
  Current scenarios in Master: 15
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 230733 rows, 95860 columns and 654209 nonzeros
Model fingerprint: 0xaaf6c9cc
Variable types: 93601 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 98475 rows and 39975 columns (presolve time = 5s)...
Presolve removed 98475 rows and 39975 columns
Presolve time: 5.80s
Presolved: 132258 rows, 55885 columns, 813363 nonzeros
Variable types: 53626 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -283316.3452
Found heuristic solution: objective -174612.9734

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.52s

Barrier statistics:
 Dense cols : 734
 AA' NZ     : 5.361e+06
 Factor NZ  : 1.244e+07 (roughly 180 MB of memory)
 Factor Ops : 2.857e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.36118419e+07  2.51171169e+08  1.73e+05 2.20e+01  1.12e+05     8s
   1  -1.83573141e+07  2.37605675e+08  1.24e+05 1.02e+02  7.92e+04     9s
   2  -7.76481015e+06  1.96672813e+08  5.02e+04 1.49e+01  3.35e+04     9s
   3  -1.71477582e+06  1.47012619e+08  7.57e+03 3.61e+00  5.50e+03     9s
   4  -7.14491713e+05  8.64111260e+07  9.24e+02 6.19e-01  9.13e+02     9s
   5  -6.21253157e+05  4.74406085e+07  4.64e+02 2.68e-01  4.47e+02     9s
   6  -5.01933306e+05  3.09408299e+07  1.54e+02 1.59e-01  2.06e+02     9s
   7  -3.69532962e+05  2.21195129e+07  6.24e+01 1.07e-01  1.20e+02     9s
   8  -1.84272103e+05  1.44311251e+07  1.69e+01 6.67e-02  6.62e+01    10s
   9  -1.13485187e+05  7.17456127e+06  8.25e+00 3.09e-02  3.18e+01    10s
  10  -8.17032887e+04  3.52145518e+06  3.88e+00 1.46e-02  1.53e+01    10s
  11  -4.40694963e+04  2.02551303e+06  1.60e+00 8.08e-03  8.68e+00    10s
  12  -1.26894582e+04  5.89936548e+05  7.49e-01 2.25e-03  2.51e+00    10s
  13   2.95595035e+04  3.55698666e+05  3.62e-01 1.09e-03  1.36e+00    10s
  14   5.82784842e+04  2.66145401e+05  1.99e-01 1.49e-03  8.64e-01    10s
  15   6.94109754e+04  2.22173832e+05  1.55e-01 1.53e-03  6.35e-01    11s
  16   7.66230410e+04  1.76288291e+05  1.27e-01 2.30e-03  4.14e-01    11s
  17   7.94082516e+04  1.68428381e+05  1.17e-01 2.06e-03  3.70e-01    11s
  18   8.61233867e+04  1.52336757e+05  9.34e-02 2.28e-03  2.75e-01    11s
  19   8.87815160e+04  1.40272950e+05  8.39e-02 1.93e-03  2.14e-01    11s
  20   9.33733028e+04  1.33954413e+05  6.99e-02 2.46e-03  1.69e-01    11s
  21   9.77034384e+04  1.29413487e+05  5.71e-02 2.99e-03  1.32e-01    11s
  22   9.98994094e+04  1.28515167e+05  5.08e-02 2.75e-03  1.19e-01    12s
  23   1.02759645e+05  1.25193344e+05  4.26e-02 2.02e-03  9.35e-02    12s
  24   1.06855900e+05  1.23436740e+05  3.11e-02 1.46e-03  6.91e-02    12s
  25   1.10461555e+05  1.22073593e+05  2.12e-02 1.01e-03  4.84e-02    12s
  26   1.12870622e+05  1.20841566e+05  1.47e-02 6.53e-04  3.32e-02    12s
  27   1.14900163e+05  1.20182995e+05  9.42e-03 4.44e-04  2.20e-02    13s
  28   1.15559904e+05  1.19858108e+05  7.78e-03 3.43e-04  1.79e-02    13s
  29   1.16770806e+05  1.19567143e+05  4.68e-03 2.56e-04  1.16e-02    13s
  30   1.17752860e+05  1.19259185e+05  2.20e-03 1.41e-04  6.27e-03    13s
  31   1.18077197e+05  1.19062683e+05  1.40e-03 9.35e-05  4.10e-03    13s
  32   1.18288374e+05  1.18965796e+05  8.87e-04 6.69e-05  2.82e-03    13s
  33   1.18468186e+05  1.18846481e+05  4.93e-04 6.44e-05  1.57e-03    13s
  34   1.18559261e+05  1.18798437e+05  3.00e-04 4.08e-05  9.94e-04    14s
  35   1.18676372e+05  1.18744238e+05  5.71e-05 1.84e-05  2.82e-04    14s
  36   1.18696584e+05  1.18722237e+05  2.00e-05 6.80e-06  1.06e-04    14s
  37   1.18704770e+05  1.18714272e+05  6.18e-06 2.80e-06  3.94e-05    14s
  38   1.18708593e+05  1.18709464e+05  4.22e-07 3.42e-07  3.62e-06    14s
  39   1.18709104e+05  1.18709108e+05  1.19e-09 2.08e-09  1.53e-08    15s
  40   1.18709107e+05  1.18709107e+05  8.23e-10 1.39e-10  4.77e-11    15s

Barrier solved model in 40 iterations and 14.83 seconds (10.41 work units)
Optimal objective 1.18709107e+05


Root crossover log...

  121344 DPushes remaining with DInf 0.0000000e+00                15s
   59938 DPushes remaining with DInf 0.0000000e+00                15s
    2120 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                21s

    1173 PPushes remaining with PInf 4.7291762e-06                21s
       0 PPushes remaining with PInf 0.0000000e+00                21s

  Push phase complete: Pinf 0.0000000e+00, Dinf 4.3056469e-10     21s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   56651    1.1870911e+05   0.000000e+00   0.000000e+00     22s
   56651    1.1870911e+05   0.000000e+00   0.000000e+00     22s
Concurrent spin time: 0.03s

Solved with barrier

Root relaxation: objective 1.187091e+05, 56651 iterations, 14.83 seconds (16.72 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 118709.107    0   90 -174612.97 118709.107   168%     -   22s
H    0     0                    -170399.4988 118709.107   170%     -   22s
H    0     0                    -148930.7060 118709.107   180%     -   23s
H    0     0                    -147353.3595 118709.107   181%     -   23s
H    0     0                    -138641.6356 118709.107   186%     -   24s
H    0     0                    -137659.0370 118709.107   186%     -   24s
H    0     0                    -10931.25930 118709.107  1186%     -   24s
H    0     0                    57828.508715 118709.107   105%     -   25s
H    0     0                    66008.041128 118709.107  79.8%     -   27s
H    0     0                    66312.452621 118709.107  79.0%     -   27s
H    0     0                    69628.219964 118709.107  70.5%     -   27s
H    0     0                    73270.873823 118709.107  62.0%     -   27s
H    0     0                    74307.484127 118709.107  59.8%     -   27s
H    0     0                    74309.871372 118709.107  59.7%     -   27s
H    0     0                    74580.698833 118709.107  59.2%     -   28s
     0     0 113312.927    0  188 74580.6988 113312.927  51.9%     -  160s
H    0     0                    75468.460812 113312.927  50.1%     -  162s
     0     0 111605.858    0  257 75468.4608 111605.858  47.9%     -  266s
     0     0 111479.898    0  266 75468.4608 111479.898  47.7%     -  294s
     0     0 111452.575    0  303 75468.4608 111452.575  47.7%     -  338s
     0     0 111452.575    0  279 75468.4608 111452.575  47.7%     -  345s
     0     0 111452.575    0  298 75468.4608 111452.575  47.7%     -  351s
     0     0 111452.575    0  297 75468.4608 111452.575  47.7%     -  353s
H    0     0                    75529.744870 107631.813  42.5%     -  497s
H    0     0                    76000.171990 107631.813  41.6%     -  497s
H    0     0                    76167.793123 107631.813  41.3%     -  497s
     0     0 107631.813    0  285 76167.7931 107631.813  41.3%     -  497s
     0     0 107047.976    0  292 76167.7931 107047.976  40.5%     -  578s
     0     0 106590.421    0  282 76167.7931 106590.421  39.9%     -  629s
     0     0 106512.266    0  295 76167.7931 106512.266  39.8%     -  651s
     0     0 106448.880    0  296 76167.7931 106448.880  39.8%     -  669s
     0     0 106426.198    0  300 76167.7931 106426.198  39.7%     -  683s
     0     0 106408.832    0  297 76167.7931 106408.832  39.7%     -  690s
     0     0 106394.658    0  294 76167.7931 106394.658  39.7%     -  700s
     0     0 106349.238    0  287 76167.7931 106349.238  39.6%     -  715s
     0     0 106336.380    0  287 76167.7931 106336.380  39.6%     -  721s
     0     0 106251.210    0  288 76167.7931 106251.210  39.5%     -  744s
     0     0 106245.324    0  285 76167.7931 106245.324  39.5%     -  748s
     0     0 106242.149    0  295 76167.7931 106242.149  39.5%     -  753s
     0     0 106189.804    0  300 76167.7931 106189.804  39.4%     -  768s
     0     0 106176.540    0  297 76167.7931 106176.540  39.4%     -  774s
     0     0 106173.677    0  302 76167.7931 106173.677  39.4%     -  778s
     0     0 106161.414    0  303 76167.7931 106161.414  39.4%     -  782s
     0     0 106147.372    0  296 76167.7931 106147.372  39.4%     -  790s
     0     0 106142.135    0  305 76167.7931 106142.135  39.4%     -  794s
     0     0 106137.442    0  300 76167.7931 106137.442  39.3%     -  797s
     0     0 106137.360    0  300 76167.7931 106137.360  39.3%     -  798s
H    0     0                    76242.775779 103975.551  36.4%     -  884s
     0     0 103975.551    0  290 76242.7758 103975.551  36.4%     -  884s
     0     0 103505.542    0  350 76242.7758 103505.542  35.8%     -  931s
     0     0 103371.830    0  309 76242.7758 103371.830  35.6%     -  963s
     0     0 103267.411    0  314 76242.7758 103267.411  35.4%     -  986s
     0     0 103237.069    0  318 76242.7758 103237.069  35.4%     -  998s
     0     0 103207.037    0  315 76242.7758 103207.037  35.4%     - 1008s
     0     0 103192.003    0  315 76242.7758 103192.003  35.3%     - 1014s
     0     0 103182.646    0  325 76242.7758 103182.646  35.3%     - 1019s
     0     0 103178.541    0  316 76242.7758 103178.541  35.3%     - 1021s
     0     0 103174.947    0  320 76242.7758 103174.947  35.3%     - 1023s
     0     0 103166.011    0  315 76242.7758 103166.011  35.3%     - 1027s
     0     0 103162.758    0  320 76242.7758 103162.758  35.3%     - 1029s
     0     0 103161.270    0  317 76242.7758 103161.270  35.3%     - 1031s
     0     0 102549.946    0  365 76242.7758 102549.946  34.5%     - 1097s
     0     0 102414.291    0  455 76242.7758 102414.291  34.3%     - 1131s
     0     0 102377.813    0  446 76242.7758 102377.813  34.3%     - 1154s
     0     0 102365.166    0  375 76242.7758 102365.166  34.3%     - 1163s
     0     0 102315.627    0  377 76242.7758 102315.627  34.2%     - 1182s
     0     0 102298.111    0  449 76242.7758 102298.111  34.2%     - 1193s
     0     0 102260.806    0  456 76242.7758 102260.806  34.1%     - 1210s
     0     0 102258.399    0  457 76242.7758 102258.399  34.1%     - 1213s
     0     0 102252.714    0  453 76242.7758 102252.714  34.1%     - 1216s
     0     0 102251.013    0  461 76242.7758 102251.013  34.1%     - 1218s
     0     0 102149.130    0  330 76242.7758 102149.130  34.0%     - 1238s
     0     0 102115.164    0  334 76242.7758 102115.164  33.9%     - 1257s
H    0     0                    76251.646445 102103.401  33.9%     - 1276s
     0     0 102103.401    0  339 76251.6464 102103.401  33.9%     - 1276s
     0     0 102093.612    0  336 76251.6464 102093.612  33.9%     - 1286s
     0     0 102089.797    0  425 76251.6464 102089.797  33.9%     - 1294s
     0     0 102083.619    0  419 76251.6464 102083.619  33.9%     - 1300s
     0     0 102081.388    0  417 76251.6464 102081.388  33.9%     - 1304s
     0     0 102080.662    0  413 76251.6464 102080.662  33.9%     - 1306s
     0     0 101956.399    0  316 76251.6464 101956.399  33.7%     - 1330s
H    0     0                    76456.424605 101956.334  33.4%     - 1356s
     0     0 101927.148    0  332 76456.4246 101927.148  33.3%     - 1368s
     0     0 101917.873    0  336 76456.4246 101917.873  33.3%     - 1377s
     0     0 101896.221    0  345 76456.4246 101896.221  33.3%     - 1387s
     0     0 101890.048    0  341 76456.4246 101890.048  33.3%     - 1390s
     0     0 101887.768    0  343 76456.4246 101887.768  33.3%     - 1393s
     0     0 101886.647    0  341 76456.4246 101886.647  33.3%     - 1395s
     0     0 101841.755    0  421 76456.4246 101841.755  33.2%     - 1416s
     0     0 101825.245    0  401 76456.4246 101825.245  33.2%     - 1436s
     0     0 101820.123    0  411 76456.4246 101820.123  33.2%     - 1441s
     0     0 101819.182    0  414 76456.4246 101819.182  33.2%     - 1445s
     0     0 101796.715    0  387 76456.4246 101796.715  33.1%     - 1461s
     0     0 101789.819    0  376 76456.4246 101789.819  33.1%     - 1519s
     0     0 101786.837    0  376 76456.4246 101786.837  33.1%     - 1524s
     0     0 101785.584    0  343 76456.4246 101785.584  33.1%     - 1527s
     0     0 101774.935    0  378 76456.4246 101774.935  33.1%     - 1536s
     0     0 101770.398    0  384 76456.4246 101770.398  33.1%     - 1547s
     0     0 101769.107    0  433 76456.4246 101769.107  33.1%     - 1553s
     0     0 101767.387    0  387 76456.4246 101767.387  33.1%     - 1558s
     0     0 101765.900    0  390 76456.4246 101765.900  33.1%     - 1561s
     0     0 101765.048    0  359 76456.4246 101765.048  33.1%     - 1565s
     0     0 101756.530    0  376 76456.4246 101756.530  33.1%     - 1578s
     0     0 101751.319    0  374 76456.4246 101751.319  33.1%     - 1582s
     0     0 101750.221    0  375 76456.4246 101750.221  33.1%     - 1585s
     0     0 101733.888    0  380 76456.4246 101733.888  33.1%     - 1603s
     0     0 101730.355    0  375 76456.4246 101730.355  33.1%     - 1613s
     0     0 101729.065    0  378 76456.4246 101729.065  33.1%     - 1617s
     0     0 101704.499    0  376 76456.4246 101704.499  33.0%     - 1635s
     0     0 101700.200    0  336 76456.4246 101700.200  33.0%     - 1642s
     0     0 101697.675    0  380 76456.4246 101697.675  33.0%     - 1649s
     0     0 101697.169    0  379 76456.4246 101697.169  33.0%     - 1652s
     0     0 101690.074    0  375 76456.4246 101690.074  33.0%     - 1669s
     0     0 101684.540    0  340 76456.4246 101684.540  33.0%     - 1678s
     0     0 101681.703    0  340 76456.4246 101681.703  33.0%     - 1682s
     0     0 101680.957    0  378 76456.4246 101680.957  33.0%     - 1685s
     0     0 101676.987    0  334 76456.4246 101676.987  33.0%     - 1693s
     0     0 101676.211    0  377 76456.4246 101676.211  33.0%     - 1698s
     0     0 101675.355    0  379 76456.4246 101675.355  33.0%     - 1703s
     0     0 101674.664    0  379 76456.4246 101674.664  33.0%     - 1706s
     0     0 101673.345    0  494 76456.4246 101673.345  33.0%     - 1715s
     0     0 101673.197    0  494 76456.4246 101673.197  33.0%     - 1721s
     0     2 101673.197    0  494 76456.4246 101673.197  33.0%     - 2000s
     1     3 101490.234    1  396 76456.4246 101673.035  33.0%  7938 2023s
     2     4 101521.133    1  334 76456.4246 101521.133  32.8%  8034 2047s
     3     5 100018.154    2  290 76456.4246 101520.107  32.8%  9301 2076s
     4     8 101011.299    2  328 76456.4246 101517.033  32.8%  8494 2112s
     7    15 100854.563    3  351 76456.4246 101275.479  32.5%  8295 2149s
    14    29 100689.983    4  318 76456.4246 101275.479  32.5%  9798 2197s
    28    43 100289.510    5  321 76456.4246 100905.512  32.0% 15473 2341s
    42    73 99222.0839    6  330 76456.4246 100849.972  31.9% 15331 2570s
    72   105 99114.4285    7  325 76456.4246 100849.972  31.9% 15071 2755s
   104   137 99046.6885    8  321 76456.4246 100849.972  31.9% 14359 2815s
   136   169 98774.3571    9  297 76456.4246 100849.972  31.9% 12099 2897s
H  165   169                    76487.003962 100849.972  31.9% 11160 2897s
   168   281 97874.8425   10  295 76487.0040 100849.972  31.9% 11218 2994s
   280   311 98965.1867   14  286 76487.0040 100849.972  31.9%  8845 3047s
   310   344 98772.3522   10  301 76487.0040 100849.972  31.9%  8514 3109s
   343   378 98760.7993   11  304 76487.0040 100849.972  31.9%  8430 3180s
   377   427 98477.2665   12  295 76487.0040 100849.972  31.9%  8451 3242s
   426   494 98204.8068   12  285 76487.0040 100849.972  31.9%  8223 3305s
   493   565 97743.3806   13  282 76487.0040 100849.972  31.9%  7911 3366s
   564   635 97445.9700   14  282 76487.0040 100849.972  31.9%  7556 3427s
   634   712 96820.1535   13  267 76487.0040 100849.972  31.9%  7321 3483s
   711   797 97385.9302   15  284 76487.0040 100849.972  31.9%  7098 3535s
   796   871 88397.9562   32  231 76487.0040 100849.972  31.9%  6719 3584s
   872   899 80610.2397   41  136 76487.0040 100849.972  31.9%  6447 3600s

Cutting planes:
  Learned: 1
  Implied bound: 141
  MIR: 1966
  Flow cover: 2335
  RLT: 46
  Relax-and-lift: 271
  PSD: 1

Explored 900 nodes (6334185 simplex iterations) in 3600.05 seconds (4352.58 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 76487 76456.4 76251.6 ... 74309.9

Time limit reached
Best objective 7.648700396152e+04, best bound 1.008499717129e+05, gap 31.8524%
  WARNING: Time limit reached. Using best solution found (gap: 31.85%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = 76487.00, θ = 249658.61
  Upper Bound (UB) = 76487.00

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 249658.61
  [DEBUG]   ✓ Scenario 0: θ = 249658.61 ≤ Q = 249658.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 249658.61 ≤ Q = 249658.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 249658.61 ≤ Q = 249658.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 249658.61 ≤ Q = 249658.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 249658.61 ≤ Q = 249658.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 249658.61 ≤ Q = 249658.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 249658.61 ≤ Q = 249658.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 249658.61 ≤ Q = 249658.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 249658.61 ≤ Q = 249658.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 249658.61 ≤ Q = 249658.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 249658.61 ≤ Q = 249658.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 249658.61 ≤ Q = 249658.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 249658.61 ≤ Q = 249658.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 249658.61 ≤ Q = 249658.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 249658.61 ≤ Q = 249658.61 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 15] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x49396c8f
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x49396c8f
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.575275e+13
Presolve removed 2567 rows and 1858 columns
Presolve time: 0.01s
Presolved: 526 rows, 531 columns, 1487 nonzeros
Found heuristic solution: objective 8208151.8003
Variable types: 361 continuous, 170 integer (170 binary)

Root relaxation: objective -1.667967e+05, 258 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -166796.75    0  132 8208151.80 -166796.75   102%     -    0s
H    0     0                    -128659.9063 -166796.75  29.6%     -    0s
H    0     0                    -130051.9576 -166796.75  28.3%     -    0s
     0     0 -143763.07    0   48 -130051.96 -143763.07  10.5%     -    0s
H    0     0                    -142566.1711 -143690.03  0.79%     -    0s
H    0     0                    -142874.8643 -143690.03  0.57%     -    0s
     0     0 -143690.03    0   43 -142874.86 -143690.03  0.57%     -    0s
H    0     0                    -143156.7767 -143690.03  0.37%     -    0s
     0     0 -143344.20    0    9 -143156.78 -143344.20  0.13%     -    0s
     0     0 -143322.58    0    8 -143156.78 -143322.58  0.12%     -    0s
     0     0 -143238.60    0    7 -143156.78 -143238.60  0.06%     -    0s
     0     0 -143229.85    0    6 -143156.78 -143229.85  0.05%     -    0s
     0     0 -143201.80    0    5 -143156.78 -143201.80  0.03%     -    0s
     0     0 -143192.54    0    6 -143156.78 -143192.54  0.02%     -    0s
     0     0          -    0      -143156.78 -143169.89  0.01%     -    0s

Cutting planes:
  Gomory: 2
  Implied bound: 3
  MIR: 2
  Flow cover: 5

Explored 1 nodes (565 simplex iterations) in 0.11 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 6: -143157 -142566 -130052 ... 1.57528e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.431567766623e+05, best bound -1.431698852422e+05, gap 0.0092%
  Subproblem solved in 0.15s
  Worst-case operational profit (Z_SP) = 240991.60
  Scenario: 16 demand increases, 44 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -143156.78
  [DEBUG]   S×d_nominal = 384148.38
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 384148.38 + -143156.78 = 240991.60
  [DEBUG]   Current θ from Master = 249658.61
  [DEBUG]   ⚠️  Z_SP ≤ θ by 8667.01 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 67820.00
  Lower Bound (LB) = 75334.45
  Gap (UB-LB) = 1152.5554, Absolute Gap = 1152.5554, Relative Gap = 0.015069
  Not converged yet (gap = 1152.56 > ε = 200)

  [DEBUG] Adding NEW scenario 15 to Master Problem...
  [DEBUG] New scenario pattern: 16 increases, 44 decreases
    [DEBUG] Scenario 15 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 15 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 15]
    [DEBUG]   - Total constraints in model: 246023
    [DEBUG]   - Total variables in model: 102100
  [DEBUG] Total scenarios in Master: 16
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 16
================================================================================
[Iteration 16] Solving Master Problem...
  Current scenarios in Master: 16
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 246023 rows, 102100 columns and 697455 nonzeros
Model fingerprint: 0x6ace3f74
Variable types: 99841 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 105040 rows and 42640 columns (presolve time = 5s)...
Presolve removed 105040 rows and 42640 columns
Presolve time: 5.21s
Presolved: 140983 rows, 59460 columns, 866685 nonzeros
Variable types: 57201 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -283517.0519
Found heuristic solution: objective -174612.9734

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.90s

Barrier statistics:
 Dense cols : 727
 AA' NZ     : 6.045e+06
 Factor NZ  : 1.381e+07 (roughly 200 MB of memory)
 Factor Ops : 3.145e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.49524125e+07  2.65737352e+08  1.83e+05 2.07e+01  1.17e+05     9s
   1  -1.94959371e+07  2.54155961e+08  1.31e+05 1.04e+02  8.34e+04    10s
   2  -8.84301338e+06  2.10688987e+08  5.70e+04 1.36e+01  3.78e+04    10s
   3  -1.82718788e+06  1.58980925e+08  8.33e+03 3.18e+00  5.98e+03    10s
   4  -7.29001167e+05  8.47803079e+07  1.02e+03 4.63e-01  9.41e+02    10s
   5  -6.19709895e+05  5.21588527e+07  4.77e+02 2.24e-01  4.65e+02    10s
   6  -5.02741399e+05  3.35211152e+07  1.66e+02 1.28e-01  2.15e+02    10s
   7  -4.00965312e+05  2.43919219e+07  9.12e+01 8.52e-02  1.37e+02    10s
   8  -2.56082103e+05  1.58951744e+07  4.20e+01 5.04e-02  7.81e+01    11s
   9  -1.39530702e+05  9.89290584e+06  1.52e+01 2.90e-02  4.31e+01    11s
  10  -1.07174999e+05  4.86134373e+06  9.39e+00 1.31e-02  2.07e+01    11s
  11  -6.92038072e+04  1.85810870e+06  4.75e+00 4.64e-03  7.81e+00    11s
  12  -3.31559007e+04  6.56714394e+05  2.69e+00 1.58e-03  2.76e+00    11s
  13   4.72065803e+03  3.52805576e+05  1.54e+00 1.92e-03  1.38e+00    11s
  14   5.07039032e+04  2.62712646e+05  5.76e-01 2.31e-03  8.33e-01    11s
  15   6.51126634e+04  2.12268438e+05  4.32e-01 1.41e-03  5.78e-01    12s
  16   7.20327953e+04  1.94346610e+05  3.68e-01 9.97e-04  4.81e-01    12s
  17   7.73780701e+04  1.70785966e+05  3.18e-01 1.38e-03  3.67e-01    12s
  18   8.46525836e+04  1.54430061e+05  2.53e-01 1.66e-03  2.75e-01    12s
  19   8.68224857e+04  1.39555108e+05  2.32e-01 2.85e-03  2.08e-01    12s
  20   9.58691306e+04  1.32594948e+05  1.56e-01 2.24e-03  1.45e-01    12s
  21   9.98662825e+04  1.29175624e+05  1.27e-01 3.41e-03  1.16e-01    13s
  22   1.01957001e+05  1.25800360e+05  1.12e-01 1.85e-03  9.41e-02    13s
  23   1.07543086e+05  1.23334346e+05  7.21e-02 2.03e-03  6.23e-02    13s
  24   1.10477659e+05  1.21623323e+05  5.24e-02 1.71e-03  4.40e-02    13s
  25   1.13370358e+05  1.20896119e+05  3.36e-02 2.15e-03  2.97e-02    13s
  26   1.16539411e+05  1.20071364e+05  1.28e-02 1.32e-03  1.39e-02    13s
  27   1.17355182e+05  1.19350355e+05  7.52e-03 5.98e-04  7.85e-03    13s
  28   1.17996047e+05  1.19040679e+05  3.84e-03 5.28e-04  4.11e-03    14s
  29   1.18122328e+05  1.18983770e+05  3.13e-03 4.34e-04  3.39e-03    14s
  30   1.18427077e+05  1.18888323e+05  1.43e-03 2.84e-04  1.81e-03    14s
  31   1.18574618e+05  1.18816259e+05  6.51e-04 1.68e-04  9.48e-04    14s
  32   1.18609574e+05  1.18780458e+05  4.73e-04 1.14e-04  6.70e-04    14s
  33   1.18682547e+05  1.18731817e+05  1.13e-04 7.57e-05  1.93e-04    15s
  34   1.18701387e+05  1.18716309e+05  2.85e-05 1.90e-05  5.84e-05    15s
  35   1.18706389e+05  1.18710755e+05  9.13e-06 6.97e-06  1.71e-05    15s
  36   1.18708793e+05  1.18709428e+05  9.03e-07 1.25e-06  2.49e-06    15s
  37   1.18709107e+05  1.18709107e+05  1.05e-09 2.31e-09  3.71e-09    15s

Barrier solved model in 37 iterations and 15.29 seconds (11.34 work units)
Optimal objective 1.18709107e+05


Root crossover log...

  129567 DPushes remaining with DInf 0.0000000e+00                15s
   22342 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                25s

   17417 PPushes remaining with PInf 1.0292212e-04                25s
   10786 PPushes remaining with PInf 5.6443242e-05                25s
       0 PPushes remaining with PInf 0.0000000e+00                28s

  Push phase complete: Pinf 0.0000000e+00, Dinf 6.5288150e+05     28s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   87690    1.1870911e+05   0.000000e+00   6.528815e+05     28s
   89763    1.1870911e+05   0.000000e+00   0.000000e+00     30s
   89763    1.1870911e+05   0.000000e+00   0.000000e+00     30s
Concurrent spin time: 6.02s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 1.187091e+05, 89763 iterations, 29.77 seconds (31.10 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 118709.107    0   90 -174612.97 118709.107   168%     -   37s
H    0     0                    -170399.4988 118709.107   170%     -   37s
H    0     0                    -170320.4093 118709.107   170%     -   38s
H    0     0                    -146395.5238 118709.107   181%     -   38s
H    0     0                    -139282.6470 118709.107   185%     -   39s
H    0     0                    -10931.25930 118709.107  1186%     -   39s
H    0     0                    34558.667965 118709.107   244%     -   40s
H    0     0                    57788.363980 118709.107   105%     -   40s
H    0     0                    60656.434176 118709.107  95.7%     -   42s
H    0     0                    61519.599165 118709.107  93.0%     -   42s
H    0     0                    68716.273576 118709.107  72.8%     -   42s
H    0     0                    70777.993019 118709.107  67.7%     -   42s
H    0     0                    71894.703444 118709.107  65.1%     -   42s
H    0     0                    73270.022485 118709.107  62.0%     -   42s
H    0     0                    74508.659315 118709.107  59.3%     -   42s
     0     0 113294.432    0  264 74508.6593 113294.432  52.1%     -  247s
H    0     0                    74897.919550 113277.796  51.2%     -  250s
H    0     0                    75283.199514 113277.796  50.5%     -  250s
     0     0 111936.474    0  283 75283.1995 111936.474  48.7%     -  333s
     0     0 111883.773    0  284 75283.1995 111883.773  48.6%     -  356s
     0     0 111877.631    0  286 75283.1995 111877.631  48.6%     -  369s
     0     0 111877.418    0  286 75283.1995 111877.418  48.6%     -  370s
     0     0 108338.965    0  255 75283.1995 108338.965  43.9%     -  513s
H    0     0                    75309.187305 108338.900  43.9%     -  514s
H    0     0                    75487.171043 108338.900  43.5%     -  514s
     0     0 107297.814    0  340 75487.1710 107297.814  42.1%     -  624s
     0     0 107020.989    0  321 75487.1710 107020.989  41.8%     -  696s
     0     0 106873.024    0  322 75487.1710 106873.024  41.6%     -  738s
     0     0 106797.090    0  318 75487.1710 106797.090  41.5%     -  777s
     0     0 106658.834    0  316 75487.1710 106658.834  41.3%     -  813s
     0     0 106586.399    0  377 75487.1710 106586.399  41.2%     -  846s
     0     0 106567.741    0  366 75487.1710 106567.741  41.2%     -  857s
     0     0 106559.630    0  357 75487.1710 106559.630  41.2%     -  872s
     0     0 106557.600    0  363 75487.1710 106557.600  41.2%     -  877s
     0     0 106529.074    0  355 75487.1710 106529.074  41.1%     -  896s
     0     0 106526.818    0  359 75487.1710 106526.818  41.1%     -  903s
     0     0 106526.204    0  357 75487.1710 106526.204  41.1%     -  905s
     0     0 104619.081    0  319 75487.1710 104619.081  38.6%     - 1075s
H    0     0                    76015.596564 104618.921  37.6%     - 1077s
     0     0 104299.482    0  283 76015.5966 104299.482  37.2%     - 1118s
     0     0 104023.633    0  328 76015.5966 104023.633  36.8%     - 1161s
     0     0 103937.335    0  334 76015.5966 103937.335  36.7%     - 1180s
     0     0 103866.226    0  432 76015.5966 103866.226  36.6%     - 1207s
     0     0 103844.716    0  336 76015.5966 103844.716  36.6%     - 1222s
     0     0 103840.296    0  344 76015.5966 103840.296  36.6%     - 1229s
     0     0 103769.180    0  444 76015.5966 103769.180  36.5%     - 1248s
     0     0 103616.460    0  332 76015.5966 103616.460  36.3%     - 1269s
     0     0 103587.274    0  340 76015.5966 103587.274  36.3%     - 1280s
     0     0 103578.701    0  345 76015.5966 103578.701  36.3%     - 1289s
     0     0 103572.348    0  347 76015.5966 103572.348  36.3%     - 1294s
     0     0 103564.798    0  353 76015.5966 103564.798  36.2%     - 1303s
     0     0 103562.156    0  351 76015.5966 103562.156  36.2%     - 1305s
     0     0 103561.594    0  349 76015.5966 103561.594  36.2%     - 1308s
     0     0 102942.170    0  330 76015.5966 102942.170  35.4%     - 1386s
     0     0 102703.994    0  360 76015.5966 102703.994  35.1%     - 1433s
     0     0 102602.170    0  388 76015.5966 102602.170  35.0%     - 1459s
     0     0 102553.590    0  313 76015.5966 102553.590  34.9%     - 1476s
     0     0 102519.138    0  317 76015.5966 102519.138  34.9%     - 1488s
     0     0 102501.742    0  325 76015.5966 102501.742  34.8%     - 1501s
     0     0 102496.342    0  401 76015.5966 102496.342  34.8%     - 1506s
     0     0 102483.752    0  388 76015.5966 102483.752  34.8%     - 1514s
     0     0 102478.793    0  323 76015.5966 102478.793  34.8%     - 1518s
     0     0 102477.241    0  321 76015.5966 102477.241  34.8%     - 1521s
     0     0 102283.648    0  452 76015.5966 102283.648  34.6%     - 1556s
     0     0 102228.929    0  450 76015.5966 102228.929  34.5%     - 1579s
     0     0 102201.736    0  467 76015.5966 102201.736  34.4%     - 1597s
     0     0 102186.338    0  472 76015.5966 102186.338  34.4%     - 1608s
     0     0 102183.677    0  471 76015.5966 102183.677  34.4%     - 1612s
     0     0 102174.410    0  461 76015.5966 102174.410  34.4%     - 1631s
     0     0 102167.241    0  459 76015.5966 102167.241  34.4%     - 1637s
     0     0 102163.178    0  462 76015.5966 102163.178  34.4%     - 1640s
     0     0 102155.508    0  464 76015.5966 102155.508  34.4%     - 1648s
     0     0 102149.856    0  451 76015.5966 102149.856  34.4%     - 1655s
     0     0 102141.231    0  460 76015.5966 102141.231  34.4%     - 1661s
     0     0 102136.151    0  468 76015.5966 102136.151  34.4%     - 1665s
     0     0 102135.056    0  472 76015.5966 102135.056  34.4%     - 1667s
     0     0 102045.280    0  333 76015.5966 102045.280  34.2%     - 1695s
H    0     0                    76055.901468 102045.062  34.2%     - 1714s
H    0     0                    76104.823252 102045.062  34.1%     - 1717s
H    0     0                    76210.430199 102045.062  33.9%     - 1717s
     0     0 102014.365    0  331 76210.4302 102014.365  33.9%     - 1734s
     0     0 102000.147    0  329 76210.4302 102000.147  33.8%     - 1742s
     0     0 101996.668    0  378 76210.4302 101996.668  33.8%     - 1749s
     0     0 101993.980    0  337 76210.4302 101993.980  33.8%     - 1753s
     0     0 101993.323    0  337 76210.4302 101993.323  33.8%     - 1754s
     0     0 101950.813    0  334 76210.4302 101950.813  33.8%     - 1779s
H    0     0                    76262.814460 101950.621  33.7%     - 1780s
     0     0 101907.693    0  332 76262.8145 101907.693  33.6%     - 1794s
     0     0 101905.225    0  333 76262.8145 101905.225  33.6%     - 1799s
     0     0 101898.984    0  329 76262.8145 101898.984  33.6%     - 1805s
     0     0 101897.112    0  330 76262.8145 101897.112  33.6%     - 1808s
     0     0 101864.879    0  421 76262.8145 101864.879  33.6%     - 1823s
     0     0 101858.845    0  325 76262.8145 101858.845  33.6%     - 1834s
     0     0 101840.282    0  428 76262.8145 101840.282  33.5%     - 1843s
     0     0 101835.154    0  335 76262.8145 101835.154  33.5%     - 1851s
     0     0 101833.588    0  419 76262.8145 101833.588  33.5%     - 1855s
     0     0 101787.073    0  423 76262.8145 101787.073  33.5%     - 1880s
H    0     0                    76303.235679 101786.942  33.4%     - 1881s
     0     0 101780.618    0  330 76303.2357 101780.618  33.4%     - 1891s
     0     0 101777.675    0  418 76303.2357 101777.675  33.4%     - 1895s
     0     0 101769.250    0  412 76303.2357 101769.250  33.4%     - 1900s
     0     0 101765.295    0  421 76303.2357 101765.295  33.4%     - 1908s
     0     0 101763.645    0  334 76303.2357 101763.645  33.4%     - 1910s
     0     0 101752.350    0  351 76303.2357 101752.350  33.4%     - 1925s
H    0     0                    76456.424605 101752.054  33.1%     - 1975s
     0     0 101745.178    0  388 76456.4246 101745.178  33.1%     - 1986s
     0     0 101743.488    0  382 76456.4246 101743.488  33.1%     - 1988s
     0     0 101732.122    0  348 76456.4246 101732.122  33.1%     - 1998s
     0     0 101730.886    0  346 76456.4246 101730.886  33.1%     - 2003s
     0     0 101726.921    0  351 76456.4246 101726.921  33.1%     - 2009s
     0     0 101725.662    0  334 76456.4246 101725.662  33.1%     - 2012s
     0     0 101724.142    0  408 76456.4246 101724.142  33.0%     - 2018s
     0     0 101723.925    0  408 76456.4246 101723.925  33.0%     - 2023s
     0     2 101723.925    0  408 76456.4246 101723.925  33.0%     - 2323s
     1     3 101443.693    1  381 76456.4246 101723.925  33.0%  9651 2349s
     2     4 101585.862    1  352 76456.4246 101585.862  32.9%  8275 2370s
     3     5 101083.424    2  379 76456.4246 101584.794  32.9% 10414 2407s
     4     8 101196.980    2  352 76456.4246 101583.490  32.9% 10012 2456s
     7    16 100869.014    3  325 76456.4246 101196.750  32.4% 11395 2535s
    15    32 100844.289    4  328 76456.4246 101081.248  32.2% 12669 2580s
    31    48 98787.3632    5  320 76456.4246 100843.642  31.9% 18679 2751s
    47    78 97839.7867    6  294 76456.4246 100843.642  31.9% 26064 2859s
    77   125 97153.4421    7  285 76456.4246 100843.642  31.9% 21623 3002s
H  121   125                    76494.752782 100843.642  31.8% 18153 3002s
   124   247 96818.5318   10  265 76494.7528 100843.642  31.8% 18084 3105s
   246   319 95760.8874   14  247 76494.7528 100843.642  31.8% 11748 3165s
   318   349 96422.8042   11  273 76494.7528 100843.642  31.8% 10501 3216s
   348   391 95127.3892   17  226 76494.7528 100843.642  31.8% 10461 3266s
   390   433 94908.6863   21  222 76494.7528 100843.642  31.8%  9880 3314s
   432   470 94803.8713   22  223 76494.7528 100843.642  31.8%  9422 3363s
   469   503 94738.3508   23  227 76494.7528 100843.642  31.8%  9129 3437s
   502   545 94592.7074   24  223 76494.7528 100843.642  31.8%  8919 3478s
   544   586 92527.5067   25  244 76494.7528 100843.642  31.8%  8778 3518s
   585   628 92361.0644   27  248 76494.7528 100843.642  31.8%  8825 3562s
   627   671 91554.2813   29  235 76494.7528 100843.642  31.8%  8906 3600s

Cutting planes:
  Implied bound: 113
  MIR: 2227
  Flow cover: 2297
  RLT: 42
  Relax-and-lift: 326

Explored 670 nodes (6757799 simplex iterations) in 3600.14 seconds (4424.98 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 76494.8 76456.4 76303.2 ... 75309.2

Time limit reached
Best objective 7.649475278174e+04, best bound 1.008436415499e+05, gap 31.8308%
  WARNING: Time limit reached. Using best solution found (gap: 31.83%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.16s
  Master Objective (UB) = 76494.75, θ = 249813.04
  Upper Bound (UB) = 76494.75

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 249813.04
  [DEBUG]   ✓ Scenario 0: θ = 249813.04 ≤ Q = 249813.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 249813.04 ≤ Q = 249813.04 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 249813.04 ≤ Q = 249813.04 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 249813.04 ≤ Q = 249813.04 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 249813.04 ≤ Q = 249813.04 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 249813.04 ≤ Q = 249813.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 249813.04 ≤ Q = 249813.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 249813.04 ≤ Q = 249813.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 249813.04 ≤ Q = 249813.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 249813.04 ≤ Q = 249813.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 249813.04 ≤ Q = 249813.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 249813.04 ≤ Q = 249813.04 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 249813.04 ≤ Q = 249813.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 249813.04 ≤ Q = 249813.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 249813.04 ≤ Q = 249813.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 249813.04 ≤ Q = 249813.04 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 16] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x25e5439
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x025e5439
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.574328e+13
Presolve removed 2566 rows and 1857 columns
Presolve time: 0.01s
Presolved: 527 rows, 532 columns, 1487 nonzeros
Found heuristic solution: objective 8218462.2275
Variable types: 362 continuous, 170 integer (170 binary)

Root relaxation: objective -1.664812e+05, 251 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -166481.20    0  122 8218462.23 -166481.20   102%     -    0s
H    0     0                    -130149.6442 -166481.20  27.9%     -    0s
H    0     0                    -131576.0220 -166481.20  26.5%     -    0s
     0     0 -141010.68    0  114 -131576.02 -141010.68  7.17%     -    0s
H    0     0                    -139127.3444 -141009.48  1.35%     -    0s
H    0     0                    -139281.4174 -141009.48  1.24%     -    0s
H    0     0                    -139379.7165 -141009.48  1.17%     -    0s
     0     0 -140197.81    0   64 -139379.72 -140197.81  0.59%     -    0s
     0     0 -140159.17    0   52 -139379.72 -140159.17  0.56%     -    0s
H    0     0                    -139571.7289 -140158.64  0.42%     -    0s
     0     0 -140158.64    0   53 -139571.73 -140158.64  0.42%     -    0s
H    0     0                    -139913.8495 -140158.64  0.17%     -    0s
     0     0 -140108.17    0   60 -139913.85 -140108.17  0.14%     -    0s
     0     0 -140107.86    0   49 -139913.85 -140107.86  0.14%     -    0s
     0     0 -140091.85    0   49 -139913.85 -140091.85  0.13%     -    0s
     0     0 -140077.76    0   49 -139913.85 -140077.76  0.12%     -    0s
     0     0 -140063.78    0    4 -139913.85 -140063.78  0.11%     -    0s
     0     0 -140063.78    0    4 -139913.85 -140063.78  0.11%     -    0s
H    0     0                    -139942.6580 -140063.78  0.09%     -    0s
     0     0 -140063.78    0   78 -139942.66 -140063.78  0.09%     -    0s
H    0     0                    -139982.6193 -140063.78  0.06%     -    0s
     0     0 -140063.78    0   42 -139982.62 -140063.78  0.06%     -    0s
     0     0 -140011.17    0    5 -139982.62 -140011.17  0.02%     -    0s
     0     0 -140010.41    0    4 -139982.62 -140010.41  0.02%     -    0s
     0     0 -140009.85    0    2 -139982.62 -140009.85  0.02%     -    0s
*    0     0               0    -140004.1794 -140004.18  0.00%     -    0s

Cutting planes:
  Gomory: 30
  Implied bound: 4
  MIR: 87
  Flow cover: 6

Explored 1 nodes (944 simplex iterations) in 0.18 seconds (0.06 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -140004 -139983 -139943 ... -130150
No other solutions better than -140004

Optimal solution found (tolerance 1.00e-04)
Best objective -1.400041793517e+05, best bound -1.400041793517e+05, gap 0.0000%
  Subproblem solved in 0.22s
  Worst-case operational profit (Z_SP) = 244144.20
  Scenario: 17 demand increases, 43 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -140004.18
  [DEBUG]   S×d_nominal = 384148.38
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 384148.38 + -140004.18 = 244144.20
  [DEBUG]   Current θ from Master = 249813.04
  [DEBUG]   ⚠️  Z_SP ≤ θ by 5668.85 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 70825.90
  Lower Bound (LB) = 75334.45
  Gap (UB-LB) = 1160.3042, Absolute Gap = 1160.3042, Relative Gap = 0.015168
  Not converged yet (gap = 1160.30 > ε = 200)

  [DEBUG] Adding NEW scenario 16 to Master Problem...
  [DEBUG] New scenario pattern: 17 increases, 43 decreases
    [DEBUG] Scenario 16 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 16 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 16]
    [DEBUG]   - Total constraints in model: 261313
    [DEBUG]   - Total variables in model: 108340
  [DEBUG] Total scenarios in Master: 17
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 17
================================================================================
[Iteration 17] Solving Master Problem...
  Current scenarios in Master: 17
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 261313 rows, 108340 columns and 740701 nonzeros
Model fingerprint: 0xf9e23412
Variable types: 106081 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 111605 rows and 45305 columns (presolve time = 5s)...
Presolve removed 111605 rows and 45305 columns
Presolve time: 5.05s
Presolved: 149708 rows, 63035 columns, 921103 nonzeros
Variable types: 60776 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -289299.0583
Found heuristic solution: objective -174612.9734

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.62s

Barrier statistics:
 Dense cols : 731
 AA' NZ     : 6.716e+06
 Factor NZ  : 1.559e+07 (roughly 200 MB of memory)
 Factor Ops : 3.882e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.61900660e+07  2.79840951e+08  1.92e+05 2.13e+01  1.23e+05     8s
   1  -2.05341476e+07  2.69908514e+08  1.38e+05 1.05e+02  8.73e+04     8s
   2  -9.81556559e+06  2.23856996e+08  6.30e+04 1.06e+01  4.15e+04     8s
   3  -1.99373744e+06  1.70525533e+08  9.42e+03 3.88e+00  6.68e+03     9s
   4  -7.36862917e+05  9.36166346e+07  1.04e+03 6.81e-01  9.71e+02     9s
   5  -6.28252239e+05  5.74744321e+07  4.80e+02 3.05e-01  4.77e+02     9s
   6  -5.20068863e+05  3.61370590e+07  1.63e+02 1.63e-01  2.16e+02     9s
   7  -4.17305282e+05  2.65469568e+07  6.19e+01 1.12e-01  1.26e+02     9s
   8  -2.71174409e+05  1.72691580e+07  2.77e+01 6.82e-02  7.42e+01     9s
   9  -1.69350274e+05  1.21061484e+07  1.13e+01 4.59e-02  4.81e+01     9s
  10  -1.18712293e+05  7.95389545e+06  6.10e+00 2.89e-02  3.08e+01    10s
  11  -9.77196094e+04  4.96351598e+06  3.96e+00 1.77e-02  1.91e+01    10s
  12  -6.58713624e+04  2.46307768e+06  2.16e+00 8.43e-03  9.41e+00    10s
  13  -2.54919422e+04  8.43173491e+05  8.35e-01 2.61e-03  3.20e+00    10s
  14   3.31752969e+04  3.96469799e+05  2.45e-01 1.16e-03  1.33e+00    10s
  15   5.20985454e+04  2.77145360e+05  1.72e-01 1.24e-03  8.27e-01    10s
  16   6.31984885e+04  2.18118816e+05  1.39e-01 2.28e-03  5.69e-01    10s
  17   7.44051495e+04  1.88245804e+05  1.08e-01 1.97e-03  4.18e-01    11s
  18   7.79650728e+04  1.80070227e+05  9.78e-02 1.78e-03  3.75e-01    11s
  19   8.66835580e+04  1.62381223e+05  7.28e-02 1.28e-03  2.78e-01    11s
  20   9.51881802e+04  1.51148500e+05  4.94e-02 1.33e-03  2.06e-01    11s
  21   9.99068789e+04  1.43518402e+05  3.70e-02 1.16e-03  1.60e-01    11s
  22   1.02584815e+05  1.34258850e+05  3.06e-02 7.82e-04  1.16e-01    12s
  23   1.04799436e+05  1.29139224e+05  2.58e-02 5.29e-04  8.94e-02    12s
  24   1.09904710e+05  1.25673831e+05  1.55e-02 7.32e-04  5.79e-02    12s
  25   1.12507933e+05  1.24256837e+05  1.07e-02 5.75e-04  4.32e-02    12s
  26   1.13837216e+05  1.22983588e+05  8.22e-03 5.77e-04  3.36e-02    12s
  27   1.15962009e+05  1.21553284e+05  4.41e-03 4.11e-04  2.05e-02    13s
  28   1.17141067e+05  1.20681767e+05  2.28e-03 2.89e-04  1.30e-02    13s
  29   1.17934159e+05  1.19891320e+05  1.04e-03 1.79e-04  7.18e-03    13s
  30   1.18201575e+05  1.19417155e+05  6.48e-04 1.06e-04  4.46e-03    13s
  31   1.18364202e+05  1.19221920e+05  4.24e-04 7.66e-05  3.15e-03    13s
  32   1.18490578e+05  1.19039621e+05  2.58e-04 4.96e-05  2.01e-03    14s
  33   1.18594881e+05  1.18899073e+05  1.33e-04 2.83e-05  1.12e-03    14s
  34   1.18609311e+05  1.18884941e+05  1.15e-04 2.62e-05  1.01e-03    14s
  35   1.18657642e+05  1.18846298e+05  5.84e-05 2.02e-05  6.91e-04    14s
  36   1.18682729e+05  1.18743679e+05  2.96e-05 4.91e-06  2.24e-04    15s
  37   1.18701483e+05  1.18718984e+05  7.68e-06 1.14e-06  6.42e-05    15s
  38   1.18707569e+05  1.18710404e+05  1.09e-06 1.35e-07  1.04e-05    15s
  39   1.18709041e+05  1.18709148e+05  2.59e-08 6.44e-08  3.92e-07    15s
  40   1.18709107e+05  1.18709107e+05  1.11e-10 1.07e-10  4.49e-11    15s

Barrier solved model in 40 iterations and 15.42 seconds (12.56 work units)
Optimal objective 1.18709107e+05


Root crossover log...

  136957 DPushes remaining with DInf 4.0822337e-08                15s
    7766 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                22s

    1355 PPushes remaining with PInf 4.7961663e-06                22s
       0 PPushes remaining with PInf 0.0000000e+00                23s

  Push phase complete: Pinf 0.0000000e+00, Dinf 4.5831207e-10     23s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   61769    1.1870911e+05   0.000000e+00   0.000000e+00     23s
   61769    1.1870911e+05   0.000000e+00   0.000000e+00     23s
Concurrent spin time: 1.48s

Solved with barrier

Root relaxation: objective 1.187091e+05, 61769 iterations, 18.03 seconds (19.14 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 118709.107    0   90 -174612.97 118709.107   168%     -   25s
H    0     0                    -131492.3099 118709.107   190%     -   26s
H    0     0                    -125318.1110 118709.107   195%     -   26s
H    0     0                    -124109.0658 118709.107   196%     -   26s
H    0     0                    -10931.25930 118709.107  1186%     -   26s
H    0     0                    57828.508715 118709.107   105%     -   27s
H    0     0                    73120.972110 118709.107  62.3%     -   30s
H    0     0                    73270.022485 118709.107  62.0%     -   30s
H    0     0                    73569.123680 118709.107  61.4%     -   31s
H    0     0                    73592.908031 118709.107  61.3%     -   31s
     0     0 113553.377    0  253 73592.9080 113553.377  54.3%     -  196s
     0     0 112286.900    0  273 73592.9080 112286.900  52.6%     -  311s
     0     0 112189.509    0  285 73592.9080 112189.509  52.4%     -  343s
     0     0 112173.647    0  279 73592.9080 112173.647  52.4%     -  358s
     0     0 112170.252    0  279 73592.9080 112170.252  52.4%     -  363s
     0     0 112169.675    0  279 73592.9080 112169.675  52.4%     -  365s
     0     0 112167.310    0  279 73592.9080 112167.310  52.4%     -  368s
     0     0 112166.880    0  279 73592.9080 112166.880  52.4%     -  368s
     0     0 108500.270    0  219 73592.9080 108500.270  47.4%     -  538s
     0     0 107647.922    0  208 73592.9080 107647.922  46.3%     -  633s
     0     0 107478.330    0  221 73592.9080 107478.330  46.0%     -  679s
     0     0 107108.800    0  315 73592.9080 107108.800  45.5%     -  734s
     0     0 106982.112    0  365 73592.9080 106982.112  45.4%     -  769s
     0     0 106931.734    0  376 73592.9080 106931.734  45.3%     -  794s
     0     0 106929.466    0  376 73592.9080 106929.466  45.3%     -  802s
     0     0 106911.709    0  372 73592.9080 106911.709  45.3%     -  818s
     0     0 106910.640    0  370 73592.9080 106910.640  45.3%     -  824s
     0     0 105318.619    0  276 73592.9080 105318.619  43.1%     -  972s
     0     0 104589.223    0  292 73592.9080 104589.223  42.1%     - 1059s
     0     0 104005.432    0  300 73592.9080 104005.432  41.3%     - 1153s
     0     0 103841.917    0  433 73592.9080 103841.917  41.1%     - 1212s
     0     0 103699.430    0  307 73592.9080 103699.430  40.9%     - 1276s
     0     0 103640.218    0  439 73592.9080 103640.218  40.8%     - 1300s
     0     0 103587.740    0  315 73592.9080 103587.740  40.8%     - 1327s
     0     0 103571.787    0  434 73592.9080 103571.787  40.7%     - 1349s
     0     0 103540.805    0  425 73592.9080 103540.805  40.7%     - 1364s
     0     0 103528.500    0  444 73592.9080 103528.500  40.7%     - 1373s
     0     0 103525.177    0  445 73592.9080 103525.177  40.7%     - 1380s
     0     0 103509.955    0  348 73592.9080 103509.955  40.7%     - 1389s
     0     0 103494.107    0  312 73592.9080 103494.107  40.6%     - 1404s
     0     0 103491.099    0  347 73592.9080 103491.099  40.6%     - 1413s
     0     0 103481.358    0  445 73592.9080 103481.358  40.6%     - 1430s
     0     0 103477.855    0  445 73592.9080 103477.855  40.6%     - 1439s
     0     0 103416.490    0  444 73592.9080 103416.490  40.5%     - 1461s
     0     0 103393.389    0  445 73592.9080 103393.389  40.5%     - 1482s
     0     0 103385.959    0  434 73592.9080 103385.959  40.5%     - 1489s
     0     0 103381.631    0  436 73592.9080 103381.631  40.5%     - 1494s
     0     0 103380.305    0  437 73592.9080 103380.305  40.5%     - 1498s
     0     0 102920.231    0  317 73592.9080 102920.231  39.9%     - 1595s
     0     0 102718.411    0  322 73592.9080 102718.411  39.6%     - 1654s
     0     0 102685.023    0  320 73592.9080 102685.023  39.5%     - 1676s
     0     0 102660.356    0  332 73592.9080 102660.356  39.5%     - 1702s
     0     0 102636.134    0  324 73592.9080 102636.134  39.5%     - 1723s
     0     0 102616.554    0  326 73592.9080 102616.554  39.4%     - 1736s
     0     0 102604.451    0  328 73592.9080 102604.451  39.4%     - 1746s
     0     0 102596.319    0  332 73592.9080 102596.319  39.4%     - 1756s
     0     0 102586.735    0  332 73592.9080 102586.735  39.4%     - 1763s
     0     0 102584.761    0  327 73592.9080 102584.761  39.4%     - 1767s
     0     0 102425.904    0  501 73592.9080 102425.904  39.2%     - 1812s
H    0     0                    73789.824704 102424.673  38.8%     - 1814s
     0     0 102391.578    0  328 73789.8247 102391.578  38.8%     - 1838s
     0     0 102372.761    0  334 73789.8247 102372.761  38.7%     - 1851s
     0     0 102364.571    0  339 73789.8247 102364.571  38.7%     - 1860s
     0     0 102357.468    0  335 73789.8247 102357.468  38.7%     - 1870s
     0     0 102341.936    0  341 73789.8247 102341.936  38.7%     - 1881s
     0     0 102331.177    0  336 73789.8247 102331.177  38.7%     - 1895s
     0     0 102327.303    0  420 73789.8247 102327.303  38.7%     - 1905s
     0     0 102325.003    0  337 73789.8247 102325.003  38.7%     - 1912s
     0     0 102322.244    0  338 73789.8247 102322.244  38.7%     - 1917s
     0     0 102321.646    0  337 73789.8247 102321.646  38.7%     - 1919s
     0     0 102138.687    0  433 73789.8247 102138.687  38.4%     - 1955s
     0     0 102099.254    0  469 73789.8247 102099.254  38.4%     - 2030s
     0     0 102080.546    0  429 73789.8247 102080.546  38.3%     - 2044s
     0     0 102072.523    0  436 73789.8247 102072.523  38.3%     - 2054s
     0     0 102063.503    0  344 73789.8247 102063.503  38.3%     - 2060s
     0     0 102060.657    0  461 73789.8247 102060.657  38.3%     - 2063s
     0     0 102058.828    0  466 73789.8247 102058.828  38.3%     - 2067s
     0     0 101977.167    0  334 73789.8247 101977.167  38.2%     - 2101s
     0     0 101950.885    0  342 73789.8247 101950.885  38.2%     - 2121s
     0     0 101944.573    0  341 73789.8247 101944.573  38.2%     - 2134s
     0     0 101935.664    0  350 73789.8247 101935.664  38.1%     - 2148s
     0     0 101933.489    0  350 73789.8247 101933.489  38.1%     - 2155s
     0     0 101926.783    0  341 73789.8247 101926.783  38.1%     - 2167s
     0     0 101919.768    0  345 73789.8247 101919.768  38.1%     - 2180s
     0     0 101918.470    0  348 73789.8247 101918.470  38.1%     - 2184s
     0     0 101895.766    0  343 73789.8247 101895.766  38.1%     - 2209s
H    0     0                    73931.300862 101895.341  37.8%     - 2254s
H    0     0                    74017.438261 101895.341  37.7%     - 2264s
H    0     0                    74365.818745 101895.341  37.0%     - 2264s
H    0     0                    74555.799647 101895.341  36.7%     - 2264s
     0     0 101886.424    0  347 74555.7996 101886.424  36.7%     - 2274s
     0     0 101884.492    0  346 74555.7996 101884.492  36.7%     - 2279s
     0     0 101865.566    0  338 74555.7996 101865.566  36.6%     - 2300s
     0     0 101858.209    0  347 74555.7996 101858.209  36.6%     - 2308s
     0     0 101853.678    0  354 74555.7996 101853.678  36.6%     - 2319s
     0     0 101851.905    0  349 74555.7996 101851.905  36.6%     - 2325s
     0     0 101828.548    0  343 74555.7996 101828.548  36.6%     - 2351s
     0     0 101812.877    0  340 74555.7996 101812.877  36.6%     - 2363s
     0     0 101809.858    0  339 74555.7996 101809.858  36.6%     - 2370s
     0     0 101808.425    0  338 74555.7996 101808.425  36.6%     - 2373s
     0     0 101806.513    0  337 74555.7996 101806.513  36.6%     - 2379s
     0     0 101803.840    0  337 74555.7996 101803.840  36.5%     - 2385s
     0     0 101803.245    0  335 74555.7996 101803.245  36.5%     - 2388s
     0     0 101801.796    0  452 74555.7996 101801.796  36.5%     - 2395s
     0     0 101800.225    0  456 74555.7996 101800.225  36.5%     - 2398s
     0     0 101795.904    0  344 74555.7996 101795.904  36.5%     - 2405s
     0     0 101795.460    0  343 74555.7996 101795.460  36.5%     - 2410s
     0     0 101793.948    0  343 74555.7996 101793.948  36.5%     - 2418s
     0     0 101793.857    0  343 74555.7996 101793.857  36.5%     - 2424s
H    0     0                    74584.962549 101793.745  36.5%     - 2620s
H    0     0                    74726.916968 101793.745  36.2%     - 2620s
H    0     0                    75414.988746 101793.737  35.0%     - 2886s
     0     2 101793.737    0  343 75414.9887 101793.737  35.0%     - 2891s
     1     3 100718.367    1  309 75414.9887 101793.737  35.0% 27975 2981s
     2     4 101368.689    1  335 75414.9887 101368.689  34.4% 24125 3038s
     3     7 100395.410    2  325 75414.9887 101368.339  34.4% 19510 3083s
     6    13 100266.086    3  320 75414.9887 101367.543  34.4% 15907 3137s
    12    25 100157.397    4  305 75414.9887 101244.387  34.2% 14980 3252s
    24    37 99744.3670    4  309 75414.9887 101165.692  34.1% 21183 3411s
    36    60 100194.207    5  328 75414.9887 101057.619  34.0% 19759 3600s
H   39    60                    75681.365386 101057.619  33.5% 19385 3600s
H   53    60                    75921.209301 101057.619  33.1% 17579 3600s

Cutting planes:
  Implied bound: 75
  MIR: 2198
  Flow cover: 2293
  RLT: 40
  Relax-and-lift: 267
  BQP: 1

Explored 59 nodes (1797950 simplex iterations) in 3600.17 seconds (3848.12 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 75921.2 75681.4 75415 ... 73789.8

Time limit reached
Best objective 7.592120930124e+04, best bound 1.010576191315e+05, gap 33.1085%
  WARNING: Time limit reached. Using best solution found (gap: 33.11%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.22s
  Master Objective (UB) = 75921.21, θ = 249765.29
  Upper Bound (UB) = 75921.21

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 249765.29
  [DEBUG]   ✓ Scenario 0: θ = 249765.29 ≤ Q = 249765.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 249765.29 ≤ Q = 249765.29 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 249765.29 ≤ Q = 249765.29 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 249765.29 ≤ Q = 249765.29 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 249765.29 ≤ Q = 249765.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 249765.29 ≤ Q = 249765.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 249765.29 ≤ Q = 249765.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 249765.29 ≤ Q = 249765.29 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 249765.29 ≤ Q = 249765.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 249765.29 ≤ Q = 250392.80 (slack: 627.51)
  [DEBUG]   ✓ Scenario 10: θ = 249765.29 ≤ Q = 249765.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 249765.29 ≤ Q = 249765.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 249765.29 ≤ Q = 249765.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 249765.29 ≤ Q = 249765.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 249765.29 ≤ Q = 249765.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 249765.29 ≤ Q = 249765.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 249765.29 ≤ Q = 249765.29 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 17] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x53d9bf91
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xac26406f
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.577234e+13
Presolve removed 2566 rows and 1857 columns
Presolve time: 0.01s
Presolved: 527 rows, 532 columns, 1487 nonzeros
Found heuristic solution: objective 8214177.6157
Variable types: 362 continuous, 170 integer (170 binary)

Root relaxation: objective -1.664874e+05, 250 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -166487.42    0  122 8214177.62 -166487.42   102%     -    0s
H    0     0                    -130113.6870 -166487.42  28.0%     -    0s
H    0     0                    -131535.2281 -166487.42  26.6%     -    0s
     0     0 -146193.65    0   80 -131535.23 -146193.65  11.1%     -    0s
H    0     0                    -144147.7568 -146133.01  1.38%     -    0s
     0     0 -145498.68    0   72 -144147.76 -145498.68  0.94%     -    0s
H    0     0                    -144545.1032 -145498.68  0.66%     -    0s
H    0     0                    -144547.6489 -145411.07  0.60%     -    0s
     0     0 -145411.07    0   60 -144547.65 -145411.07  0.60%     -    0s
     0     0 -145409.94    0   61 -144547.65 -145409.94  0.60%     -    0s
     0     0 -145092.20    0   58 -144547.65 -145092.20  0.38%     -    0s
     0     0 -145005.03    0   55 -144547.65 -145005.03  0.32%     -    0s
     0     0 -145002.37    0   53 -144547.65 -145002.37  0.31%     -    0s
     0     0 -144997.34    0   54 -144547.65 -144997.34  0.31%     -    0s
     0     0 -144851.59    0   37 -144547.65 -144851.59  0.21%     -    0s
     0     0 -144846.36    0   45 -144547.65 -144846.36  0.21%     -    0s
     0     0 -144790.50    0   41 -144547.65 -144790.50  0.17%     -    0s
     0     0 -144783.48    0   41 -144547.65 -144783.48  0.16%     -    0s
H    0     0                    -144556.7688 -144783.48  0.16%     -    0s
     0     0 -144783.48    0   60 -144556.77 -144783.48  0.16%     -    0s
     0     0 -144783.48    0   38 -144556.77 -144783.48  0.16%     -    0s
H    0     0                    -144568.3423 -144783.48  0.15%     -    0s
     0     0 -144734.24    0   35 -144568.34 -144734.24  0.11%     -    0s
     0     0 -144646.13    0   10 -144568.34 -144646.13  0.05%     -    0s
     0     0 -144618.06    0    9 -144568.34 -144618.06  0.03%     -    0s
     0     0 -144617.91    0    7 -144568.34 -144617.91  0.03%     -    0s
     0     0 -144586.39    0    2 -144568.34 -144586.39  0.01%     -    0s
     0     0 -144586.39    0    2 -144568.34 -144586.39  0.01%     -    0s
H    0     0                    -144585.0516 -144586.39  0.00%     -    0s

Explored 1 nodes (1039 simplex iterations) in 0.19 seconds (0.07 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -144585 -144568 -144557 ... 1.57723e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.445850516107e+05, best bound -1.445863914528e+05, gap 0.0009%
  Subproblem solved in 0.23s
  Worst-case operational profit (Z_SP) = 239563.32
  Scenario: 34 demand increases, 26 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -144585.05
  [DEBUG]   S×d_nominal = 384148.38
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 384148.38 + -144585.05 = 239563.32
  [DEBUG]   Current θ from Master = 249765.29
  [DEBUG]   ⚠️  Z_SP ≤ θ by 10201.96 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 65719.25
  Lower Bound (LB) = 75334.45
  Gap (UB-LB) = 586.7607, Absolute Gap = 586.7607, Relative Gap = 0.007729
  Not converged yet (gap = 586.76 > ε = 200)

  [DEBUG] Adding NEW scenario 17 to Master Problem...
  [DEBUG] New scenario pattern: 34 increases, 26 decreases
    [DEBUG] Scenario 17 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 17 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 17]
    [DEBUG]   - Total constraints in model: 276603
    [DEBUG]   - Total variables in model: 114580
  [DEBUG] Total scenarios in Master: 18
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 18
================================================================================
[Iteration 18] Solving Master Problem...
  Current scenarios in Master: 18
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 276603 rows, 114580 columns and 783947 nonzeros
Model fingerprint: 0x9f0fb996
Variable types: 112321 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 118170 rows and 47970 columns (presolve time = 5s)...
Presolve removed 118170 rows and 47970 columns
Presolve time: 6.03s
Presolved: 158433 rows, 66610 columns, 972681 nonzeros
Variable types: 64351 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -283424.7691
Found heuristic solution: objective -174612.9734

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.70s

Barrier statistics:
 Dense cols : 719
 AA' NZ     : 7.515e+06
 Factor NZ  : 1.765e+07 (roughly 230 MB of memory)
 Factor Ops : 4.604e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.74905850e+07  2.94621848e+08  2.01e+05 2.00e+01  1.28e+05     9s
   1  -2.16153293e+07  2.87129173e+08  1.44e+05 1.06e+02  9.12e+04    10s
   2  -1.11347832e+07  2.39207721e+08  7.15e+04 1.16e+01  4.68e+04    10s
   3  -2.20591087e+06  1.83283320e+08  1.10e+04 2.86e+00  7.64e+03    10s
   4  -7.56735576e+05  1.05856577e+08  1.18e+03 5.00e-01  1.09e+03    10s
   5  -6.36828529e+05  6.75426209e+07  5.03e+02 2.68e-01  5.19e+02    10s
   6  -5.48135314e+05  4.58653139e+07  1.89e+02 1.62e-01  2.59e+02    10s
   7  -4.82382630e+05  3.29423164e+07  1.04e+02 1.09e-01  1.64e+02    11s
   8  -3.70058241e+05  2.15676312e+07  4.81e+01 6.46e-02  9.48e+01    11s
   9  -2.61941944e+05  1.63704941e+07  2.28e+01 4.75e-02  6.52e+01    11s
  10  -2.07477673e+05  8.31504121e+06  1.70e+01 2.17e-02  3.30e+01    11s
  11  -1.28498620e+05  5.24900562e+06  9.59e+00 1.28e-02  2.00e+01    11s
  12  -9.20990121e+04  3.22322893e+06  4.74e+00 7.63e-03  1.19e+01    11s
  13  -5.50796700e+04  2.12892450e+06  2.42e+00 4.92e-03  7.72e+00    12s
  14  -1.03484870e+04  6.05353314e+05  8.24e-01 1.33e-03  2.15e+00    12s
  15   2.79217329e+04  3.40171704e+05  4.06e-01 8.38e-04  1.09e+00    12s
  16   4.60537614e+04  2.47215454e+05  2.86e-01 1.85e-03  7.00e-01    12s
  17   6.24825604e+04  1.88460130e+05  2.12e-01 1.72e-03  4.39e-01    12s
  18   7.26225124e+04  1.62482927e+05  1.71e-01 2.93e-03  3.13e-01    12s
  19   8.02001990e+04  1.52673835e+05  1.40e-01 3.32e-03  2.53e-01    13s
  20   8.50983034e+04  1.44103479e+05  1.18e-01 2.35e-03  2.06e-01    13s
  21   9.02704257e+04  1.37129692e+05  9.71e-02 2.11e-03  1.63e-01    13s
  22   9.50359999e+04  1.29669367e+05  7.91e-02 1.73e-03  1.21e-01    13s
  23   9.61219919e+04  1.27364136e+05  7.53e-02 1.56e-03  1.09e-01    13s
  24   9.94561852e+04  1.24623460e+05  6.40e-02 1.94e-03  8.79e-02    13s
  25   1.04843962e+05  1.23232460e+05  4.54e-02 2.53e-03  6.42e-02    14s
  26   1.08839754e+05  1.21279596e+05  3.17e-02 1.86e-03  4.34e-02    14s
  27   1.10227120e+05  1.20539610e+05  2.71e-02 1.28e-03  3.60e-02    14s
  28   1.13987103e+05  1.20053041e+05  1.48e-02 9.37e-04  2.12e-02    14s
  29   1.15920556e+05  1.19318121e+05  8.42e-03 4.38e-04  1.19e-02    14s
  30   1.16985133e+05  1.19124533e+05  4.95e-03 3.09e-04  7.46e-03    15s
  31   1.17437583e+05  1.18961679e+05  3.56e-03 1.99e-04  5.32e-03    15s
  32   1.17963040e+05  1.18896044e+05  1.98e-03 1.54e-04  3.25e-03    15s
  33   1.18166527e+05  1.18805362e+05  1.37e-03 9.76e-05  2.23e-03    15s
  34   1.18452500e+05  1.18711682e+05  5.23e-04 3.33e-05  9.03e-04    15s
  35   1.18611609e+05  1.18672446e+05  9.08e-05 4.26e-05  2.12e-04    16s
  36   1.18640616e+05  1.18657822e+05  2.53e-05 6.80e-06  5.99e-05    16s
  37   1.18651733e+05  1.18654394e+05  2.86e-06 1.20e-06  9.25e-06    16s
  38   1.18653418e+05  1.18653499e+05  4.06e-08 8.12e-08  2.80e-07    16s
  39   1.18653460e+05  1.18653460e+05  3.54e-10 1.19e-10  2.80e-10    16s

Barrier solved model in 39 iterations and 16.29 seconds (12.65 work units)
Optimal objective 1.18653460e+05


Root crossover log...

  144419 DPushes remaining with DInf 0.0000000e+00                16s
   21662 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                25s

    2565 PPushes remaining with PInf 1.7637211e-05                25s
       0 PPushes remaining with PInf 0.0000000e+00                26s

  Push phase complete: Pinf 0.0000000e+00, Dinf 9.3320571e+00     26s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   68275    1.1865346e+05   0.000000e+00   9.332057e+00     26s
   68294    1.1865346e+05   0.000000e+00   0.000000e+00     26s
   68294    1.1865346e+05   0.000000e+00   0.000000e+00     26s
Concurrent spin time: 1.43s

Solved with barrier

Root relaxation: objective 1.186535e+05, 68294 iterations, 20.10 seconds (23.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 118653.460    0   97 -174612.97 118653.460   168%     -   28s
H    0     0                    -169466.5625 118653.460   170%     -   30s
H    0     0                    -158355.9035 118653.460   175%     -   31s
H    0     0                    -157983.5473 118653.460   175%     -   31s
H    0     0                    -156522.3535 118653.460   176%     -   32s
H    0     0                    -156505.9224 118653.460   176%     -   32s
H    0     0                    -156368.3038 118653.460   176%     -   32s
H    0     0                    -156207.2501 118653.460   176%     -   32s
H    0     0                    -15862.69809 118653.460   848%     -   32s
H    0     0                    -15655.55205 118653.460   858%     -   33s
H    0     0                    41097.290905 118653.460   189%     -   33s
H    0     0                    57869.901637 118653.460   105%     -   34s
H    0     0                    65154.769769 118653.460  82.1%     -   36s
H    0     0                    66696.767221 118653.460  77.9%     -   36s
H    0     0                    68195.827483 118653.460  74.0%     -   36s
H    0     0                    73154.783472 118653.460  62.2%     -   36s
H    0     0                    73352.404702 118653.460  61.8%     -   36s
H    0     0                    73569.123680 118653.460  61.3%     -   36s
H    0     0                    73592.908031 118653.460  61.2%     -   37s
     0     0 113096.242    0  277 73592.9080 113096.242  53.7%     -  281s
H    0     0                    73702.778878 113096.227  53.4%     -  285s
H    0     0                    73756.678880 113096.227  53.3%     -  285s
     0     0 111339.061    0  313 73756.6789 111339.061  51.0%     -  446s
     0     0 110971.321    0  304 73756.6789 110971.321  50.5%     -  505s
     0     0 110949.959    0  310 73756.6789 110949.959  50.4%     -  524s
     0     0 110947.745    0  308 73756.6789 110947.745  50.4%     -  530s
     0     0 110947.427    0  301 73756.6789 110947.427  50.4%     -  532s
     0     0 107869.304    0  272 73756.6789 107869.304  46.3%     -  740s
     0     0 107220.273    0  276 73756.6789 107220.273  45.4%     -  837s
     0     0 106971.677    0  376 73756.6789 106971.677  45.0%     -  897s
     0     0 106817.555    0  279 73756.6789 106817.555  44.8%     -  976s
     0     0 106587.459    0  355 73756.6789 106587.459  44.5%     - 1067s
     0     0 106532.934    0  253 73756.6789 106532.934  44.4%     - 1116s
     0     0 106456.529    0  386 73756.6789 106456.529  44.3%     - 1164s
     0     0 106366.566    0  232 73756.6789 106366.566  44.2%     - 1205s
     0     0 106340.958    0  238 73756.6789 106340.958  44.2%     - 1228s
     0     0 106314.311    0  245 73756.6789 106314.311  44.1%     - 1249s
     0     0 106302.000    0  235 73756.6789 106302.000  44.1%     - 1262s
     0     0 106295.943    0  242 73756.6789 106295.943  44.1%     - 1269s
     0     0 106295.702    0  244 73756.6789 106295.702  44.1%     - 1272s
     0     0 104257.741    0  412 73756.6789 104257.741  41.4%     - 1527s
     0     0 103818.563    0  373 73756.6789 103818.563  40.8%     - 1664s
     0     0 103729.387    0  398 73756.6789 103729.387  40.6%     - 1728s
     0     0 103673.513    0  403 73756.6789 103673.513  40.6%     - 1774s
     0     0 103631.789    0  401 73756.6789 103631.789  40.5%     - 1811s
     0     0 103608.071    0  402 73756.6789 103608.071  40.5%     - 1839s
     0     0 103598.027    0  401 73756.6789 103598.027  40.5%     - 1853s
     0     0 103589.759    0  401 73756.6789 103589.759  40.4%     - 1861s
     0     0 103575.500    0  403 73756.6789 103575.500  40.4%     - 1878s
     0     0 103568.901    0  396 73756.6789 103568.901  40.4%     - 1894s
     0     0 103553.743    0  405 73756.6789 103553.743  40.4%     - 1924s
     0     0 103506.475    0  349 73756.6789 103506.475  40.3%     - 1988s
     0     0 103474.960    0  477 73756.6789 103474.960  40.3%     - 2029s
     0     0 103460.613    0  469 73756.6789 103460.613  40.3%     - 2052s
     0     0 103454.744    0  469 73756.6789 103454.744  40.3%     - 2070s
     0     0 103453.523    0  472 73756.6789 103453.523  40.3%     - 2080s
     0     0 102972.493    0  325 73756.6789 102972.493  39.6%     - 2228s
     0     0 102847.857    0  319 73756.6789 102847.857  39.4%     - 2284s
     0     0 102763.287    0  320 73756.6789 102763.287  39.3%     - 2333s
     0     0 102736.979    0  323 73756.6789 102736.979  39.3%     - 2361s
     0     0 102717.391    0  321 73756.6789 102717.391  39.3%     - 2386s
     0     0 102705.351    0  322 73756.6789 102705.351  39.2%     - 2400s
     0     0 102698.619    0  326 73756.6789 102698.619  39.2%     - 2412s
     0     0 102689.802    0  321 73756.6789 102689.802  39.2%     - 2426s
     0     0 102682.458    0  320 73756.6789 102682.458  39.2%     - 2434s
     0     0 102681.034    0  325 73756.6789 102681.034  39.2%     - 2443s
     0     0 102510.178    0  355 73756.6789 102510.178  39.0%     - 2527s
     0     0 102457.712    0  374 73756.6789 102457.712  38.9%     - 2565s
     0     0 102435.834    0  450 73756.6789 102435.834  38.9%     - 2593s
     0     0 102418.730    0  449 73756.6789 102418.730  38.9%     - 2611s
     0     0 102409.472    0  455 73756.6789 102409.472  38.8%     - 2627s
     0     0 102401.857    0  457 73756.6789 102401.857  38.8%     - 2640s
     0     0 102394.967    0  458 73756.6789 102394.967  38.8%     - 2654s
     0     0 102390.747    0  449 73756.6789 102390.747  38.8%     - 2664s
     0     0 102389.827    0  450 73756.6789 102389.827  38.8%     - 2672s
     0     0 102282.539    0  331 73756.6789 102282.539  38.7%     - 2730s
H    0     0                    75193.224859 102280.952  36.0%     - 2765s
     0     0 102216.888    0  338 75193.2249 102216.888  35.9%     - 2804s
     0     0 102161.099    0  390 75193.2249 102161.099  35.9%     - 2838s
     0     0 102143.696    0  400 75193.2249 102143.696  35.8%     - 2864s
     0     0 102139.813    0  399 75193.2249 102139.813  35.8%     - 2876s
     0     0 102137.913    0  401 75193.2249 102137.913  35.8%     - 2883s
     0     0 102102.465    0  334 75193.2249 102102.465  35.8%     - 2909s
     0     0 102051.514    0  334 75193.2249 102051.514  35.7%     - 2942s
     0     0 102038.476    0  329 75193.2249 102038.476  35.7%     - 2955s
     0     0 102030.964    0  338 75193.2249 102030.964  35.7%     - 2967s
     0     0 102018.703    0  336 75193.2249 102018.703  35.7%     - 2980s
     0     0 102012.610    0  334 75193.2249 102012.610  35.7%     - 2989s
     0     0 102008.350    0  331 75193.2249 102008.350  35.7%     - 2999s
     0     0 102005.345    0  337 75193.2249 102005.345  35.7%     - 3004s
     0     0 102004.456    0  335 75193.2249 102004.456  35.7%     - 3008s
     0     0 101899.559    0  326 75193.2249 101899.559  35.5%     - 3062s
     0     0 101843.750    0  335 75193.2249 101843.750  35.4%     - 3145s
     0     0 101835.904    0  348 75193.2249 101835.904  35.4%     - 3176s
     0     0 101831.248    0  353 75193.2249 101831.248  35.4%     - 3187s
     0     0 101827.821    0  348 75193.2249 101827.821  35.4%     - 3199s
     0     0 101825.890    0  350 75193.2249 101825.890  35.4%     - 3204s
     0     0 101814.227    0  346 75193.2249 101814.227  35.4%     - 3230s
H    0     0                    75240.119279 101814.156  35.3%     - 3232s
     0     0 101803.935    0  340 75240.1193 101803.935  35.3%     - 3245s
     0     0 101801.200    0  338 75240.1193 101801.200  35.3%     - 3249s
     0     0 101800.202    0  343 75240.1193 101800.202  35.3%     - 3253s
     0     0 101780.026    0  341 75240.1193 101780.026  35.3%     - 3278s
     0     0 101776.810    0  344 75240.1193 101776.810  35.3%     - 3301s
     0     0 101776.626    0  346 75240.1193 101776.626  35.3%     - 3305s
     0     0 101766.975    0  345 75240.1193 101766.975  35.3%     - 3327s
     0     0 101756.282    0  346 75240.1193 101756.282  35.2%     - 3341s
     0     0 101754.073    0  412 75240.1193 101754.073  35.2%     - 3351s
     0     0 101750.990    0  346 75240.1193 101750.990  35.2%     - 3360s
     0     0 101749.694    0  354 75240.1193 101749.694  35.2%     - 3364s
     0     0 101694.815    0  340 75240.1193 101694.815  35.2%     - 3392s
     0     0 101686.556    0  340 75240.1193 101686.556  35.1%     - 3404s
     0     0 101684.233    0  343 75240.1193 101684.233  35.1%     - 3410s
     0     0 101683.407    0  343 75240.1193 101683.407  35.1%     - 3416s
     0     0 101680.505    0  418 75240.1193 101680.505  35.1%     - 3429s
     0     0 101679.289    0  416 75240.1193 101679.289  35.1%     - 3436s
     0     0 101677.022    0  458 75240.1193 101677.022  35.1%     - 3449s
     0     0 101672.069    0  352 75240.1193 101672.069  35.1%     - 3457s
     0     0 101668.535    0  349 75240.1193 101668.535  35.1%     - 3464s
     0     0 101666.995    0  349 75240.1193 101666.995  35.1%     - 3469s
     0     0 101666.132    0  349 75240.1193 101666.132  35.1%     - 3476s
     0     0 101665.954    0  349 75240.1193 101665.954  35.1%     - 3482s

Cutting planes:
  Learned: 1
  Gomory: 2
  Implied bound: 93
  MIR: 895
  Flow cover: 810
  RLT: 15
  Relax-and-lift: 119

Explored 1 nodes (926837 simplex iterations) in 3600.02 seconds (3040.51 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 75240.1 75193.2 73756.7 ... 66696.8

Time limit reached
Best objective 7.524011927866e+04, best bound 1.016659542805e+05, gap 35.1220%
  WARNING: Time limit reached. Using best solution found (gap: 35.12%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.09s
  Master Objective (UB) = 75240.12, θ = 249389.31
  Upper Bound (UB) = 75240.12

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 249389.31
  [DEBUG]   ✓ Scenario 0: θ = 249389.31 ≤ Q = 249389.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 249389.31 ≤ Q = 249389.31 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 249389.31 ≤ Q = 249389.31 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 249389.31 ≤ Q = 249389.31 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 249389.31 ≤ Q = 249389.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 249389.31 ≤ Q = 249389.31 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 249389.31 ≤ Q = 249389.31 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 249389.31 ≤ Q = 249389.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 249389.31 ≤ Q = 249389.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 249389.31 ≤ Q = 249389.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 249389.31 ≤ Q = 249389.31 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 249389.31 ≤ Q = 249389.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 249389.31 ≤ Q = 249389.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 249389.31 ≤ Q = 249389.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 249389.31 ≤ Q = 249389.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 249389.31 ≤ Q = 249389.31 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 249389.31 ≤ Q = 249389.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 249389.31 ≤ Q = 249389.31 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 18] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x2aad2646
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x2aad2646
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.580885e+13
Presolve removed 2568 rows and 1859 columns
Presolve time: 0.01s
Presolved: 525 rows, 530 columns, 1487 nonzeros
Found heuristic solution: objective 8269025.8350
Variable types: 360 continuous, 170 integer (170 binary)

Root relaxation: objective -1.668453e+05, 256 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -166845.26    0  124 8269025.84 -166845.26   102%     -    0s
H    0     0                    -129455.0608 -166845.26  28.9%     -    0s
H    0     0                    -130980.1805 -166845.26  27.4%     -    0s
H    0     0                    -134686.4110 -143673.96  6.67%     -    0s
H    0     0                    -139080.5612 -143673.96  3.30%     -    0s
     0     0 -143673.96    0   85 -139080.56 -143673.96  3.30%     -    0s
H    0     0                    -141424.9752 -143671.50  1.59%     -    0s
H    0     0                    -141732.3550 -143671.50  1.37%     -    0s
     0     0 -143094.70    0   54 -141732.36 -143094.70  0.96%     -    0s
H    0     0                    -142817.9862 -143089.41  0.19%     -    0s
     0     0 -143062.66    0   50 -142817.99 -143062.66  0.17%     -    0s
     0     0 -143061.35    0   48 -142817.99 -143061.35  0.17%     -    0s
H    0     0                    -142842.5088 -143061.35  0.15%     -    0s
     0     0 -142968.31    0   14 -142842.51 -142968.31  0.09%     -    0s
     0     0 -142968.18    0   13 -142842.51 -142968.18  0.09%     -    0s
     0     0 -142916.71    0    9 -142842.51 -142916.71  0.05%     -    0s
     0     0 -142915.97    0    8 -142842.51 -142915.97  0.05%     -    0s
     0     0 -142901.24    0    2 -142842.51 -142901.24  0.04%     -    0s
     0     0 -142901.24    0   37 -142842.51 -142901.24  0.04%     -    0s
     0     0 -142901.24    0   25 -142842.51 -142901.24  0.04%     -    0s
     0     0 -142901.24    0   20 -142842.51 -142901.24  0.04%     -    0s
     0     0 -142901.24    0   14 -142842.51 -142901.24  0.04%     -    0s
     0     0 -142901.24    0   13 -142842.51 -142901.24  0.04%     -    0s
H    0     0                    -142866.4621 -142901.24  0.02%     -    0s
     0     0 -142889.81    0    2 -142866.46 -142889.81  0.02%     -    0s
     0     0 -142885.59    0    5 -142866.46 -142885.59  0.01%     -    0s
H    0     0                    -142873.4347 -142885.59  0.01%     -    0s

Explored 1 nodes (669 simplex iterations) in 0.12 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -142873 -142866 -142843 ... -129455

Optimal solution found (tolerance 1.00e-04)
Best objective -1.428734347388e+05, best bound -1.428855921189e+05, gap 0.0085%
  Subproblem solved in 0.15s
  Worst-case operational profit (Z_SP) = 241274.94
  Scenario: 16 demand increases, 44 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -142873.43
  [DEBUG]   S×d_nominal = 384148.38
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 384148.38 + -142873.43 = 241274.94
  [DEBUG]   Current θ from Master = 249389.31
  [DEBUG]   ⚠️  Z_SP ≤ θ by 8114.37 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 67125.75
  Lower Bound (LB) = 75334.45
  Gap (UB-LB) = -94.3293, Absolute Gap = 94.3293, Relative Gap = -0.001254
  *** CONVERGED (small negative gap: -94.33 within tolerance ε=200) ***
  Note: Negative gap likely due to numerical precision or solver tolerance

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 18
Total Time: 56089.01s
Converged: True
Final Lower Bound: 75334.4486
Final Upper Bound: 75240.1193
Final Gap: -94.329279
Number of Critical Scenarios: 18
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [1] (1/3)
Product 1 Plants: [0] (1/3)
Product 2 Plants: [1] (1/3)
Total Plant Openings: 3
DCs Opened: [0, 1, 4, 5, 7] (5/10)
Active Routes (Plant→DC): 14
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 0 customers  Mode 1: 0 customers  Mode 2: 50 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 18
Start Time: 2026-01-05 19:51:54
End Time: 2026-01-06 11:26:43
Total Time: 56089.01s
Optimal Value: 75334.45
Lower Bound: 75334.45
Upper Bound: 75240.12
Gap: -94.329279
Plants Opened: {0: [1], 1: [0], 2: [1]} (3 plants)
DCs Opened: [0, 1, 4, 5, 7] (5 DCs)
================================================================================

Results saved to: result/DH_single_full_seed43_HD_gamma20_20260106_112643.csv

Total Execution Time: 56089.61 seconds
End Time: 2026-01-06 11:26:44

All tasks completed successfully!

