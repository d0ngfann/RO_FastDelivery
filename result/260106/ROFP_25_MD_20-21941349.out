
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 25
DI Scenario: MD
Start Time: 2026-01-04 12:31:03
================================================================================
Loading data from data/DH_data_full_seed25.pkl...

Applying DI scenario: MD
DI values:
  Product 0: ['1.000', '1.220', '1.489'] (k=0.491)
  Product 1: ['1.000', '1.185', '1.405'] (k=0.419)
  Product 2: ['1.000', '1.249', '1.560'] (k=0.549)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=941, max=1710
  DC capacity (MC): min=405, max=850

Demand Structure (s_rk matrix):
  Total customer-product pairs: 76/150 (49.3% sparse)
  Average products per customer: 1.52

Demand (only non-zero entries):
  Nominal (μ): min=8.28, max=34.84, count=76
  Deviation (μ̂): min=4.00, max=9.95

Costs:
  Plant fixed cost: min=5742, max=9721
  DC fixed cost: min=3176, max=5734
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.421', '2.021'] (k=0.867)
    Product 1: ['1.000', '1.424', '2.028'] (k=0.872)
    Product 2: ['1.000', '1.372', '1.882'] (k=0.780)
  MD:
    Product 0: ['1.000', '1.220', '1.489'] (k=0.491)
    Product 1: ['1.000', '1.185', '1.405'] (k=0.419)
    Product 2: ['1.000', '1.249', '1.560'] (k=0.549)
  LD:
    Product 0: ['1.000', '1.013', '1.025'] (k=0.031)
    Product 1: ['1.000', '1.042', '1.086'] (k=0.102)
    Product 2: ['1.000', '1.116', '1.245'] (k=0.270)
  Mixed:
    Product 0: ['1.000', '1.421', '2.021'] (k=0.867)
    Product 1: ['1.000', '1.185', '1.405'] (k=0.419)
    Product 2: ['1.000', '1.116', '1.245'] (k=0.270)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48738 nonzeros
Model fingerprint: 0x410aedc6
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 12035 rows and 3035 columns
Presolve time: 0.12s
Presolved: 4638 rows, 5465 columns, 32308 nonzeros
Variable types: 3206 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -295334.9337
Found heuristic solution: objective -182931.6033

Root relaxation: objective 8.113669e+04, 5112 iterations, 0.40 seconds (0.42 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 81136.6900    0  747 -182931.60 81136.6900   144%     -    0s
H    0     0                    -180863.0308 81136.6900   145%     -    0s
     0     0 77826.1721    0  945 -180863.03 77826.1721   143%     -    1s
H    0     0                    -165760.3351 77826.0061   147%     -    1s
     0     0 77722.6090    0  952 -165760.34 77722.6090   147%     -    1s
     0     0 77712.2374    0  944 -165760.34 77712.2374   147%     -    1s
     0     0 77709.5430    0  953 -165760.34 77709.5430   147%     -    1s
     0     0 77709.5041    0  953 -165760.34 77709.5041   147%     -    1s
H    0     0                    -165535.3372 74454.1253   145%     -    3s
     0     0 74454.1253    0 1109 -165535.34 74454.1253   145%     -    3s
     0     0 74235.7091    0 1108 -165535.34 74235.7091   145%     -    3s
     0     0 74199.7458    0 1116 -165535.34 74199.7458   145%     -    3s
     0     0 74193.2168    0 1114 -165535.34 74193.2168   145%     -    3s
     0     0 74192.6384    0 1115 -165535.34 74192.6384   145%     -    3s
H    0     0                    -165353.8672 71579.3729   143%     -    5s
H    0     0                    -162571.9103 71579.3729   144%     -    5s
     0     0 71579.3729    0 1203 -162571.91 71579.3729   144%     -    5s
H    0     0                    -158371.1078 71578.6736   145%     -    6s
H    0     0                    -150983.4874 71578.6736   147%     -    6s
H    0     0                    -92927.44622 71202.4762   177%     -    6s
H    0     0                    -92864.42975 71202.4762   177%     -    6s
H    0     0                    -66867.78674 71202.4762   206%     -    6s
H    0     0                    14093.350276 71202.4762   405%     -    6s
     0     0 71202.4762    0 1219 14093.3503 71202.4762   405%     -    6s
     0     0 71165.1285    0 1225 14093.3503 71165.1285   405%     -    6s
     0     0 71161.4161    0 1229 14093.3503 71161.4161   405%     -    6s
     0     0 71160.4982    0 1227 14093.3503 71160.4982   405%     -    7s
     0     0 68691.1711    0 1197 14093.3503 68691.1711   387%     -    9s
     0     0 68340.4061    0 1196 14093.3503 68340.4061   385%     -   10s
     0     0 68272.4550    0 1205 14093.3503 68272.4550   384%     -   10s
     0     0 68253.8578    0 1211 14093.3503 68253.8578   384%     -   11s
     0     0 68249.9030    0 1226 14093.3503 68249.9030   384%     -   11s
H    0     0                    14155.327095 67023.6569   373%     -   13s
H    0     0                    14280.445788 67023.6569   369%     -   13s
H    0     0                    14419.314439 67023.6569   365%     -   13s
H    0     0                    14657.746950 67023.6569   357%     -   13s
H    0     0                    14787.620194 67023.6569   353%     -   13s
H    0     0                    14820.123220 67023.6569   352%     -   13s
H    0     0                    15118.567627 67023.6569   343%     -   13s
H    0     0                    15135.994051 67023.6569   343%     -   13s
H    0     0                    15154.697354 67023.6569   342%     -   13s
H    0     0                    15158.119428 67023.6569   342%     -   13s
H    0     0                    15185.374824 67023.6569   341%     -   13s
H    0     0                    15515.572552 67023.6569   332%     -   13s
H    0     0                    15619.917911 67023.6569   329%     -   13s
     0     0 67023.6569    0 1176 15619.9179 67023.6569   329%     -   13s
     0     0 66807.6081    0 1195 15619.9179 66807.6081   328%     -   13s
     0     0 66763.4680    0 1205 15619.9179 66763.4680   327%     -   14s
     0     0 66754.0268    0 1211 15619.9179 66754.0268   327%     -   14s
     0     0 66752.0986    0 1233 15619.9179 66752.0986   327%     -   14s
H    0     0                    15623.665643 64971.4295   316%     -   16s
H    0     0                    15629.792291 64971.4295   316%     -   16s
H    0     0                    15630.588261 64971.4295   316%     -   16s
H    0     0                    15634.426231 64971.4295   316%     -   16s
H    0     0                    15701.556461 64971.4295   314%     -   16s
H    0     0                    15730.031484 64971.4295   313%     -   16s
H    0     0                    15787.661759 64971.4295   312%     -   16s
H    0     0                    15788.605393 64971.4295   312%     -   16s
H    0     0                    15917.893101 64971.4295   308%     -   16s
H    0     0                    15944.802090 64971.4295   307%     -   16s
H    0     0                    16003.790689 64971.4295   306%     -   16s
H    0     0                    16023.379779 64971.4295   305%     -   16s
H    0     0                    16024.067180 64971.4295   305%     -   16s
     0     0 64971.4295    0 1178 16024.0672 64971.4295   305%     -   16s
H    0     0                    16024.557976 64680.3495   304%     -   17s
     0     0 64680.3495    0 1226 16024.5580 64680.3495   304%     -   17s
     0     0 64629.4358    0 1244 16024.5580 64629.4358   303%     -   18s
     0     0 64616.0408    0 1258 16024.5580 64616.0408   303%     -   18s
H    0     0                    16076.307717 64611.1265   302%     -   18s
     0     0 64611.1265    0 1262 16076.3077 64611.1265   302%     -   18s
     0     0 63995.7961    0 1155 16076.3077 63995.7961   298%     -   20s
     0     0 63829.7678    0 1197 16076.3077 63829.7678   297%     -   21s
     0     0 63800.6840    0 1214 16076.3077 63800.6840   297%     -   21s
H    0     0                    16222.673484 63784.8568   293%     -   22s
H    0     0                    16302.975623 63784.8568   291%     -   22s
     0     0 63784.8568    0 1226 16302.9756 63784.8568   291%     -   22s
     0     0 63782.1057    0 1235 16302.9756 63782.1057   291%     -   22s
     0     0 63212.8952    0 1133 16302.9756 63212.8952   288%     -   23s
H    0     0                    16350.797246 63070.5807   286%     -   24s
H    0     0                    16377.007821 63070.5807   285%     -   24s
     0     0 63070.5807    0 1156 16377.0078 63070.5807   285%     -   24s
     0     0 63022.3210    0 1160 16377.0078 63022.3210   285%     -   25s
     0     0 63009.7361    0 1158 16377.0078 63009.7361   285%     -   25s
H    0     0                    18848.230040 63009.7361   234%     -   25s
H    0     0                    19562.909671 63009.7361   222%     -   25s
H    0     0                    19584.933229 62631.7500   220%     -   27s
H    0     0                    19728.084470 62631.7500   217%     -   27s
     0     0 62631.7500    0 1149 19728.0845 62631.7500   217%     -   27s
     0     0 62520.8065    0 1143 19728.0845 62520.8065   217%     -   28s
     0     0 62494.4759    0 1132 19728.0845 62494.4759   217%     -   28s
     0     0 62492.1430    0 1135 19728.0845 62492.1430   217%     -   28s
H    0     0                    20127.681053 62226.5812   209%     -   30s
H    0     0                    20188.697568 62226.5812   208%     -   30s
H    0     0                    20326.171406 62226.5812   206%     -   30s
H    0     0                    20781.138285 62226.5812   199%     -   30s
     0     0 62226.5812    0 1137 20781.1383 62226.5812   199%     -   30s
H    0     0                    20968.464586 62225.4142   197%     -   30s
H    0     0                    21831.576580 62140.8180   185%     -   31s
H    0     0                    22032.179516 62140.8180   182%     -   31s
     0     0 62140.8180    0 1163 22032.1795 62140.8180   182%     -   31s
H    0     0                    22140.645103 62120.4984   181%     -   31s
H    0     0                    22216.495847 62120.4984   180%     -   31s
     0     0 62120.4984    0 1185 22216.4958 62120.4984   180%     -   31s
     0     0 62116.5506    0 1190 22216.4958 62116.5506   180%     -   32s
     0     0 61008.5100    0 1108 22216.4958 61008.5100   175%     -   34s
H    0     0                    22414.626234 60829.3980   171%     -   35s
H    0     0                    22456.509829 60829.3980   171%     -   35s
H    0     0                    22458.679754 60829.3980   171%     -   35s
H    0     0                    22473.141138 60829.3980   171%     -   35s
     0     0 60829.3980    0 1121 22473.1411 60829.3980   171%     -   35s
     0     0 60788.3328    0 1124 22473.1411 60788.3328   170%     -   36s
H    0     0                    22569.175981 60777.0483   169%     -   36s
H    0     0                    22651.500504 60777.0483   168%     -   36s
H    0     0                    22884.038435 60777.0483   166%     -   36s
     0     0 60777.0483    0 1110 22884.0384 60777.0483   166%     -   36s
H    0     0                    22932.000364 59085.3654   158%     -   39s
     0     0 59085.3654    0 1075 22932.0004 59085.3654   158%     -   39s
H    0     0                    22958.025639 58847.9736   156%     -   40s
H    0     0                    23016.540542 58847.9736   156%     -   40s
     0     0 58847.9736    0 1080 23016.5405 58847.9736   156%     -   40s
     0     0 58773.5343    0 1109 23016.5405 58773.5343   155%     -   41s
     0     0 58752.3965    0 1091 23016.5405 58752.3965   155%     -   41s
     0     0 58747.6398    0 1114 23016.5405 58747.6398   155%     -   41s
     0     0 58365.0954    0 1064 23016.5405 58365.0954   154%     -   43s
     0     0 58273.6161    0 1097 23016.5405 58273.6161   153%     -   44s
     0     0 58248.7297    0 1107 23016.5405 58248.7297   153%     -   45s
     0     0 58241.9946    0 1104 23016.5405 58241.9946   153%     -   45s
H    0     0                    23105.444115 57119.3782   147%     -   48s
H    0     0                    23201.406269 57119.3782   146%     -   48s
     0     0 57119.3782    0 1032 23201.4063 57119.3782   146%     -   48s
     0     0 56870.1434    0 1057 23201.4063 56870.1434   145%     -   49s
     0     0 56812.6709    0 1082 23201.4063 56812.6709   145%     -   50s
     0     0 56798.5060    0 1098 23201.4063 56798.5060   145%     -   50s
     0     0 56496.7313    0 1092 23201.4063 56496.7313   144%     -   52s
     0     0 56378.0331    0 1087 23201.4063 56378.0331   143%     -   53s
     0     0 56360.3742    0 1102 23201.4063 56360.3742   143%     -   53s
     0     0 56189.2853    0 1074 23201.4063 56189.2853   142%     -   54s
     0     0 56150.2748    0 1053 23201.4063 56150.2748   142%     -   55s
     0     0 56139.9061    0 1055 23201.4063 56139.9061   142%     -   55s
     0     0 55999.9929    0 1037 23201.4063 55999.9929   141%     -   57s
     0     0 55999.5944    0 1037 23201.4063 55999.5944   141%     -   57s
     0     2 55999.5944    0 1037 23201.4063 55999.5944   141%     -   60s
     3     8 54636.0657    2  791 23201.4063 55291.0534   138%  3213   65s
    63    90 49172.2242    6  495 23201.4063 49206.4298   112%  1694   70s
H   99   148                    23483.331498 49143.4856   109%  1200   71s
H  278   273                    24047.612778 49143.4856   104%   633   73s
H  278   273                    24523.787819 49143.4856   100%   633   73s
H  470   420                    24538.891237 49143.4856   100%   532   74s
   483   496 47462.6108   16  473 24538.8912 49143.4856   100%   525   75s
H  578   529                    24551.945961 49023.0784   100%   498   75s
H  580   529                    24699.194725 49023.0784  98.5%   499   75s
H  606   529                    24973.969288 49023.0784  96.3%   493   75s
   919   814 41425.6188   21  457 24973.9693 49023.0784  96.3%   485   80s
  1137   926 27069.2974   23  306 24973.9693 47905.4875  91.8%   545   85s
  1349  1072 28543.5277   25  351 24973.9693 47837.9892  91.6%   584   91s
  1718  1303 27731.4890   27  338 24973.9693 47837.9892  91.6%   533   96s
  1960  1438 27382.4052   30  383 24973.9693 45864.7757  83.7%   529  100s
H 2142  1513                    24988.730231 45151.2715  80.7%   529  103s
  2168  1580     cutoff   31      24988.7302 45151.2715  80.7%   528  105s
  2921  2050 39150.4832   15  354 24988.7302 43858.4850  75.5%   491  111s
H 3127  2100                    24993.269648 43858.4850  75.5%   487  112s
  3413  2305 27953.7560   21  363 24993.2696 43245.4867  73.0%   480  116s
  3842  2427 32486.9674   22  341 24993.2696 43033.8706  72.2%   476  120s
H 4207  2578                    25066.176403 42885.0791  71.1%   491  124s
  4260  2684     cutoff   20      25066.1764 41985.9589  67.5%   489  126s
H 4486  2683                    25115.269115 41354.8875  64.7%   491  128s
H 4486  2683                    25115.784969 41354.8875  64.7%   491  129s
H 4486  2683                    25135.223647 41354.8875  64.5%   491  129s
  4487  2684 34970.9081   15 1037 25135.2236 41354.8875  64.5%   490  142s
  4500  2693 30883.5186   33  402 25135.2236 36584.4229  45.6%   489  145s
  4523  2724 33181.6307   17  402 25135.2236 34666.6113  37.9%   492  150s
H 4829  2585                    25253.715056 30968.5123  22.6%   485  152s
H 4934  2410                    25606.135271 29882.1816  16.7%   479  152s
H 4998  2267                    25625.673215 29882.1816  16.6%   475  152s
H 5219  2042                    25635.571346 29214.5595  14.0%   462  153s
H 5224  1930                    25660.795697 29214.5595  13.8%   462  153s
  5535  1787 26954.0724   31  149 25660.7957 27902.5379  8.74%   441  155s

Cutting planes:
  Implied bound: 3
  Projected implied bound: 5
  MIR: 207
  Flow cover: 334
  Zero half: 1
  RLT: 2
  Relax-and-lift: 48

Explored 6023 nodes (2553386 simplex iterations) in 156.00 seconds (198.52 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 25660.8 25635.6 25625.7 ... 24988.7

Optimal solution found (tolerance 1.00e-04)
Best objective 2.566079569700e+04, best bound 2.566079569700e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 156.00s
  Master Objective (UB) = 25660.80, θ = 168297.77
  Upper Bound (UB) = 25660.80

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 168297.77
  [DEBUG]   ✓ Scenario 0: θ = 168297.77 ≤ Q = 168297.77 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x2188b164
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x2188b164
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.165545e+13
Presolve removed 2624 rows and 1916 columns
Presolve time: 0.01s
Presolved: 469 rows, 473 columns, 1322 nonzeros
Found heuristic solution: objective 5337551.7650
Variable types: 321 continuous, 152 integer (152 binary)

Root relaxation: objective -1.333904e+05, 235 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -133390.41    0  123 5337551.76 -133390.41   102%     -    0s
H    0     0                    -102119.2813 -133390.41  30.6%     -    0s
H    0     0                    -102494.4150 -133390.41  30.1%     -    0s
H    0     0                    -104746.3055 -104746.31  0.00%     -    0s
     0     0          -    0      -104746.31 -104746.31  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 199

Explored 1 nodes (361 simplex iterations) in 0.02 seconds (0.01 work units)
Thread count was 32 (of 32 available processors)

Solution count 5: -104746 -102494 -102119 ... 1.16555e+13
No other solutions better than -104746

Optimal solution found (tolerance 1.00e-04)
Best objective -1.047463054659e+05, best bound -1.047463054659e+05, gap 0.0000%
  Subproblem solved in 0.05s
  Worst-case operational profit (Z_SP) = 136115.51
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -104746.31
  [DEBUG]   S×d_nominal = 240861.82
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 240861.82 + -104746.31 = 136115.51
  [DEBUG]   Current θ from Master = 168297.77
  [DEBUG]   ⚠️  Z_SP ≤ θ by 32182.26 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -6521.46
  Lower Bound (LB) = -6521.46
  Gap (UB-LB) = 32182.2566, Absolute Gap = 32182.2566, Relative Gap = 1.254141
  Not converged yet (gap = 32182.26 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 91957 nonzeros
Model fingerprint: 0x2427ae3f
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -6521.46 (0.02s)
MIP start from previous solve produced solution with objective -6521.46 (0.02s)
Loaded MIP start from previous solve with objective -6521.46

Presolve removed 14949 rows and 6068 columns
Presolve time: 0.46s
Presolved: 17014 rows, 8672 columns, 94038 nonzeros
Variable types: 6413 continuous, 2259 integer (2259 binary)

Root relaxation: objective 3.300436e+04, 10009 iterations, 2.04 seconds (2.65 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 33004.3578    0  406 -6521.4609 33004.3578   606%     -    2s
H    0     0                    -6104.322580 33004.3578   641%     -    2s
H    0     0                    -5974.485147 33004.3578   652%     -    2s
H    0     0                    -5827.039289 33004.3578   666%     -    3s
     0     0 23976.9397    0  470 -5827.0393 23976.9397   511%     -    5s
H    0     0                    -5755.456960 23975.7257   517%     -    5s
     0     0 23739.1843    0  477 -5755.4570 23739.1843   512%     -    5s
     0     0 23736.7951    0  475 -5755.4570 23736.7951   512%     -    5s
     0     0 18447.5143    0  445 -5755.4570 18447.5143   421%     -    8s
H    0     0                    -4135.470973 18180.5654   540%     -    8s
H    0     0                    -4059.505622 18180.5654   548%     -    8s
     0     0 18180.5654    0  488 -4059.5056 18180.5654   548%     -    8s
H    0     0                    -4053.799736 18150.0536   548%     -    8s
H    0     0                    -3684.461357 18150.0536   593%     -    8s
H    0     0                    -3587.202792 18150.0536   606%     -    8s
H    0     0                    -3365.085746 18150.0536   639%     -    8s
H    0     0                    -3305.749871 18150.0536   649%     -    8s
     0     0 18150.0536    0  560 -3305.7499 18150.0536   649%     -    8s
     0     0 18145.9936    0  561 -3305.7499 18145.9936   649%     -    9s
     0     0 18145.9614    0  563 -3305.7499 18145.9614   649%     -    9s
H    0     0                    -3097.692579 15265.7607   593%     -   12s
H    0     0                    -3061.766034 15265.7607   599%     -   12s
     0     0 15265.7607    0  540 -3061.7660 15265.7607   599%     -   12s
H    0     0                    -2614.106061 15265.1776   684%     -   12s
     0     0 14612.3146    0  548 -2614.1061 14612.3146   659%     -   13s
     0     0 14445.0862    0  605 -2614.1061 14445.0862   653%     -   13s
     0     0 14423.8373    0  556 -2614.1061 14423.8373   652%     -   13s
     0     0 14420.1118    0  562 -2614.1061 14420.1118   652%     -   13s
     0     0 12836.7494    0  474 -2614.1061 12836.7494   591%     -   17s
H    0     0                    -2611.523482 12836.1478   592%     -   17s
H    0     0                    -2565.251922 12836.1478   600%     -   17s
H    0     0                    -2560.030627 12836.1478   601%     -   17s
H    0     0                    -2552.125035 12836.1478   603%     -   17s
     0     0 12517.6118    0  469 -2552.1250 12517.6118   590%     -   18s
     0     0 12386.8390    0  472 -2552.1250 12386.8390   585%     -   18s
     0     0 12347.1621    0  496 -2552.1250 12347.1621   584%     -   19s
     0     0 12320.0685    0  473 -2552.1250 12320.0685   583%     -   19s
     0     0 12296.1118    0  483 -2552.1250 12296.1118   582%     -   19s
     0     0 12293.2320    0  474 -2552.1250 12293.2320   582%     -   19s
H    0     0                    -2550.123839 11890.6878   566%     -   20s
H    0     0                    -2537.137250 11890.6878   569%     -   20s
H    0     0                    -2503.223748 11890.6878   575%     -   20s
H    0     0                    -2491.959696 11890.6878   577%     -   20s
H    0     0                    -2485.020168 11890.6878   578%     -   20s
     0     0 11890.6878    0  508 -2485.0202 11890.6878   578%     -   20s
     0     0 11647.8641    0  552 -2485.0202 11647.8641   569%     -   21s
H    0     0                    -2475.358181 11587.6690   568%     -   22s
H    0     0                    -2431.680935 11587.6690   577%     -   22s
H    0     0                    -2423.696301 11587.6690   578%     -   22s
     0     0 11587.6690    0  507 -2423.6963 11587.6690   578%     -   22s
     0     0 11544.3881    0  508 -2423.6963 11544.3881   576%     -   22s
     0     0 11532.6749    0  514 -2423.6963 11532.6749   576%     -   22s
     0     0 11484.3615    0  501 -2423.6963 11484.3615   574%     -   22s
     0     0 11474.3403    0  500 -2423.6963 11474.3403   573%     -   23s
     0     0 11468.6945    0  512 -2423.6963 11468.6945   573%     -   23s
     0     0 11241.0750    0  457 -2423.6963 11241.0750   564%     -   24s
H    0     0                    -2063.793201 11240.8925   645%     -   25s
H    0     0                    -2035.779707 11240.8925   652%     -   25s
H    0     0                    -1741.763465 11240.8925   745%     -   25s
H    0     0                    -1696.277321 11240.8925   763%     -   25s
H    0     0                    -1679.131678 11240.8925   769%     -   25s
     0     0 11187.7661    0  479 -1679.1317 11187.7661   766%     -   25s
     0     0 11163.5384    0  477 -1679.1317 11163.5384   765%     -   25s
     0     0 11160.1608    0  469 -1679.1317 11160.1608   765%     -   26s
     0     0 10985.3941    0  539 -1679.1317 10985.3941   754%     -   27s
     0     0 10949.0723    0  542 -1679.1317 10949.0723   752%     -   27s
     0     0 10932.8374    0  485 -1679.1317 10932.8374   751%     -   27s
     0     0 10927.6180    0  475 -1679.1317 10927.6180   751%     -   28s
     0     0 10813.7447    0  543 -1679.1317 10813.7447   744%     -   28s
     0     0 10773.2266    0  541 -1679.1317 10773.2266   742%     -   29s
     0     0 10761.5450    0  540 -1679.1317 10761.5450   741%     -   29s
     0     0 10754.8747    0  553 -1679.1317 10754.8747   741%     -   29s
     0     0 10703.3768    0  478 -1679.1317 10703.3768   737%     -   30s
     0     0 10688.8966    0  467 -1679.1317 10688.8966   737%     -   30s
     0     0 10685.7999    0  480 -1679.1317 10685.7999   736%     -   31s
     0     0 10674.0815    0  540 -1679.1317 10674.0815   736%     -   31s
     0     0 10668.3518    0  461 -1679.1317 10668.3518   735%     -   32s
     0     0 10662.2710    0  469 -1679.1317 10662.2710   735%     -   33s
     0     0 10662.1216    0  469 -1679.1317 10662.1216   735%     -   33s
H    0     0                    -1661.817415 10662.0477   742%     -   42s
H    0     0                    -1542.589551 10662.0477   791%     -   43s
H    0     0                    -790.5426032 10662.0477  1449%     -   44s
H    0     0                     122.2040077 10662.0477  8625%     -   44s
H    0     0                     477.2430057 10662.0477  2134%     -   44s
H    0     0                     764.0340120 10662.0477  1295%     -   44s
H    0     0                     837.2762503 10662.0477  1173%     -   44s
H    0     0                     838.2953422 10662.0477  1172%     -   44s
     0     2 10662.0477    0  469  838.29534 10662.0477  1172%     -   44s
     1     4 10253.3119    1  482  838.29534 10662.0477  1172%  1383   45s
    31    60 2290.42040    5  549  838.29534 9643.69742  1050%  1189   50s
H   65    88                     892.7265874 9522.08812   967%   955   53s
H  112   185                    1259.8605022 9470.33008   652%   907   54s
H  127   185                    2827.1510006 9445.12790   234%   838   54s
   210   209     cutoff    9      2827.15100 9445.12790   234%   621   55s
   340   262 infeasible    8      2827.15100 9445.12790   234%   551   60s
H  520   332                    3061.6264663 9422.22276   208%   515   63s
   631   371 7894.43871   10  432 3061.62647 9333.53070   205%   488   65s
H  808   426                    3135.2859545 9317.02372   197%   470   66s
  1138   623 4284.94882   15  282 3135.28595 9009.30916   187%   411   70s
  1704   829 5976.23052   14  297 3135.28595 8299.97651   165%   376   75s
  2094   929 5165.53770   12  383 3135.28595 8132.70611   159%   370   80s
  2187  1019 4718.24562   14  288 3135.28595 8132.70611   159%   371   85s
  2771  1117 6417.59271   14  363 3135.28595 7820.74515   149%   337   90s
H 3003  1137                    3205.1149774 7708.18059   140%   331   91s
  3674  1329     cutoff   31      3205.11498 7157.76442   123%   313   97s
  4232  1466 4959.06967   27  259 3205.11498 6913.94384   116%   308  101s
  5195  1481     cutoff   10      3205.11498 6565.28742   105%   292  105s
  6242  1676 4406.16208   21  301 3205.11498 6115.07929  90.8%   280  110s
  7619  1842 4303.01842   26  469 3205.11498 5829.06378  81.9%   265  126s
  7622  1844 4852.94858   29  359 3205.11498 5829.06378  81.9%   265  132s
  7625  1846 5249.07095   12  412 3205.11498 5829.06378  81.9%   265  135s
  7635  1853 5036.62344   39  503 3205.11498 5829.06378  81.9%   265  140s
  7641  1857 3785.80882   25  499 3205.11498 5829.06378  81.9%   265  146s
  7645  1859 4258.21252   20  512 3205.11498 5829.06378  81.9%   265  151s
  7648  1861 4363.91580   30  513 3205.11498 5829.06378  81.9%   264  157s
  7649  1862 5411.38515   22  513 3205.11498 5829.06378  81.9%   264  160s
  7662  1876     cutoff   13      3205.11498 5829.06378  81.9%   270  165s
  7723  1902 5829.06378   16  341 3205.11498 5829.06378  81.9%   274  170s
  8002  1878 5829.06378   20  377 3205.11498 5829.06378  81.9%   280  175s
  8220  1826     cutoff   25      3205.11498 5829.06378  81.9%   281  180s
  8558  1652 4132.74758   25  190 3205.11498 5829.06378  81.9%   282  185s

Cutting planes:
  Lift-and-project: 2
  Implied bound: 12
  MIR: 156
  Mixing: 1
  Flow cover: 365
  RLT: 4
  Relax-and-lift: 40

Explored 8828 nodes (2517592 simplex iterations) in 189.02 seconds (282.76 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 3205.11 3135.29 3061.63 ... 477.243

Optimal solution found (tolerance 1.00e-04)
Best objective 3.205114977420e+03, best bound 3.205114977420e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 189.04s
  Master Objective (UB) = 3205.11, θ = 134346.13
  Upper Bound (UB) = 3205.11

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 134346.13
  [DEBUG]   ✓ Scenario 0: θ = 134346.13 ≤ Q = 134346.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 134346.13 ≤ Q = 134346.13 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x40116468
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xbfee9b98
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.335094e+13
Presolve removed 2628 rows and 1922 columns
Presolve time: 0.01s
Presolved: 465 rows, 467 columns, 1310 nonzeros
Found heuristic solution: objective 6231771.6670
Variable types: 315 continuous, 152 integer (152 binary)

Root relaxation: objective -1.410229e+05, 236 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -141022.89    0  127 6231771.67 -141022.89   102%     -    0s
H    0     0                    -108230.9368 -141022.89  30.3%     -    0s
H    0     0                    -108606.0704 -141022.89  29.8%     -    0s
H    0     0                    -122447.3609 -141022.89  15.2%     -    0s
H    0     0                    -122570.8652 -129616.64  5.75%     -    0s
H    0     0                    -122829.2217 -129616.64  5.53%     -    0s
H    0     0                    -125404.8790 -129616.64  3.36%     -    0s
     0     0 -129616.64    0  119 -125404.88 -129616.64  3.36%     -    0s
     0     0 -129134.48    0  121 -125404.88 -129134.48  2.97%     -    0s
H    0     0                    -126296.4530 -129134.48  2.25%     -    0s
     0     0 -128036.60    0  120 -126296.45 -128036.60  1.38%     -    0s
H    0     0                    -126534.8875 -128017.19  1.17%     -    0s
     0     0 -127950.81    0   99 -126534.89 -127950.81  1.12%     -    0s
     0     0 -127909.88    0  120 -126534.89 -127909.88  1.09%     -    0s
     0     0 -127869.21    0  120 -126534.89 -127869.21  1.05%     -    0s
H    0     0                    -126538.9739 -127869.21  1.05%     -    0s
     0     0 -127193.38    0   80 -126538.97 -127193.38  0.52%     -    0s
     0     0 -127142.34    0   85 -126538.97 -127142.34  0.48%     -    0s
     0     0 -127113.79    0   77 -126538.97 -127113.79  0.45%     -    0s
     0     0 -127113.60    0   77 -126538.97 -127113.60  0.45%     -    0s
     0     0 -126966.46    0   63 -126538.97 -126966.46  0.34%     -    0s
     0     0 -126908.61    0   65 -126538.97 -126908.61  0.29%     -    0s
     0     0 -126890.87    0   57 -126538.97 -126890.87  0.28%     -    0s
     0     0 -126890.47    0   65 -126538.97 -126890.47  0.28%     -    0s
     0     0 -126876.00    0    8 -126538.97 -126876.00  0.27%     -    0s
H    0     0                    -126571.7972 -126870.75  0.24%     -    0s
     0     0 -126870.75    0    8 -126571.80 -126870.75  0.24%     -    0s
     0     0 -126870.75    0    8 -126571.80 -126870.75  0.24%     -    0s
H    0     0                    -126822.6607 -126870.75  0.04%     -    0s
     0     0 -126870.75    0   61 -126822.66 -126870.75  0.04%     -    0s
     0     0 -126870.75    0   51 -126822.66 -126870.75  0.04%     -    0s
     0     0 -126870.12    0   53 -126822.66 -126870.12  0.04%     -    0s
     0     0 -126836.29    0   50 -126822.66 -126836.29  0.01%     -    0s
     0     0 -126835.51    0   47 -126822.66 -126835.51  0.01%     -    0s

Cutting planes:
  Gomory: 8
  Implied bound: 4
  MIR: 61
  Flow cover: 11
  RLT: 4

Explored 1 nodes (1047 simplex iterations) in 0.27 seconds (0.07 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -126823 -126704 -126572 ... -108231

Optimal solution found (tolerance 1.00e-04)
Best objective -1.268226606673e+05, best bound -1.268344705763e+05, gap 0.0093%
  Subproblem solved in 0.30s
  Worst-case operational profit (Z_SP) = 114851.71
  Scenario: 33 demand increases, 27 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -126822.66
  [DEBUG]   S×d_nominal = 241674.37
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 241674.37 + -126822.66 = 114851.71
  [DEBUG]   Current θ from Master = 134346.13
  [DEBUG]   ⚠️  Z_SP ≤ θ by 19494.42 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -16289.31
  Lower Bound (LB) = -6521.46
  Gap (UB-LB) = 9726.5759, Absolute Gap = 9726.5759, Relative Gap = 3.034704
  Not converged yet (gap = 9726.58 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 33 increases, 27 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135176 nonzeros
Model fingerprint: 0x4baaa15d
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -16289.3 (0.03s)
Loaded MIP start from previous solve with objective -16289.3

Presolve removed 22422 rows and 9102 columns
Presolve time: 0.58s
Presolved: 24831 rows, 11878 columns, 138749 nonzeros
Variable types: 9619 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   29732    2.8060018e+04   0.000000e+00   1.205853e+07      5s
Concurrent spin time: 0.20s

Solved with dual simplex

Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   17775    3.2293137e+04   0.000000e+00   0.000000e+00      6s

Root relaxation: objective 3.229314e+04, 17775 iterations, 5.58 seconds (6.79 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 32293.1373    0  413 -16289.307 32293.1373   298%     -    6s
H    0     0                    -529.3471829 32293.1373  6201%     -    6s
H    0     0                    1111.0511016 32293.1373  2807%     -    6s
H    0     0                    1223.0184045 32293.1373  2540%     -    6s
H    0     0                    1681.0026158 32293.1373  1821%     -    7s
H    0     0                    1688.9278105 32293.1373  1812%     -    7s
H    0     0                    1709.1660287 32293.1373  1789%     -    7s
H    0     0                    2130.3066055 32293.1373  1416%     -    7s
H    0     0                    2136.5403609 32293.1373  1411%     -    7s
     0     0 23582.5309    0  459 2136.54036 23582.5309  1004%     -   10s
     0     0 23263.5148    0  468 2136.54036 23263.5148   989%     -   11s
     0     0 23250.8569    0  457 2136.54036 23250.8569   988%     -   11s
     0     0 23213.8435    0  528 2136.54036 23213.8435   987%     -   12s
     0     0 23202.6144    0  528 2136.54036 23202.6144   986%     -   12s
     0     0 23201.7430    0  527 2136.54036 23201.7430   986%     -   12s
     0     0 17763.0323    0  371 2136.54036 17763.0323   731%     -   17s
     0     0 17151.1711    0  490 2136.54036 17151.1711   703%     -   19s
     0     0 16890.1410    0  484 2136.54036 16890.1410   691%     -   20s
     0     0 16840.7658    0  494 2136.54036 16840.7658   688%     -   20s
     0     0 16835.2911    0  559 2136.54036 16835.2911   688%     -   20s
     0     0 16832.7125    0  563 2136.54036 16832.7125   688%     -   20s
H    0     0                    2199.9146893 16832.7125   665%     -   23s
H    0     0                    2217.2732246 16832.7125   659%     -   23s
H    0     0                    2218.2168023 16832.7125   659%     -   23s
H    0     0                    2261.1860885 14340.4643   534%     -   26s
     0     0 14340.4643    0  457 2261.18609 14340.4643   534%     -   26s
H    0     0                    2364.3613040 14338.7842   506%     -   27s
     0     0 13815.1909    0  395 2364.36130 13815.1909   484%     -   29s
     0     0 13589.5002    0  472 2364.36130 13589.5002   475%     -   30s
     0     0 13513.5847    0  613 2364.36130 13513.5847   472%     -   31s
     0     0 13470.9743    0  553 2364.36130 13470.9743   470%     -   32s
     0     0 13425.5169    0  493 2364.36130 13425.5169   468%     -   33s
     0     0 13407.7244    0  475 2364.36130 13407.7244   467%     -   33s
     0     0 13381.0277    0  608 2364.36130 13381.0277   466%     -   34s
     0     0 13361.8160    0  621 2364.36130 13361.8160   465%     -   35s
     0     0 13353.3873    0  552 2364.36130 13353.3873   465%     -   35s
     0     0 13350.9969    0  501 2364.36130 13350.9969   465%     -   35s
     0     0 12113.2191    0  471 2364.36130 12113.2191   412%     -   42s
     0     0 11786.0002    0  467 2364.36130 11786.0002   398%     -   44s
     0     0 11603.4377    0  487 2364.36130 11603.4377   391%     -   45s
     0     0 11509.4147    0  477 2364.36130 11509.4147   387%     -   46s
     0     0 11479.7024    0  476 2364.36130 11479.7024   386%     -   47s
     0     0 11298.0869    0  497 2364.36130 11298.0869   378%     -   48s
     0     0 11252.7605    0  494 2364.36130 11252.7605   376%     -   49s
     0     0 11232.6042    0  580 2364.36130 11232.6042   375%     -   50s
     0     0 11222.1950    0  511 2364.36130 11222.1950   375%     -   50s
     0     0 11215.0886    0  497 2364.36130 11215.0886   374%     -   50s
     0     0 11213.2411    0  498 2364.36130 11213.2411   374%     -   51s
     0     0 10895.8949    0  532 2364.36130 10895.8949   361%     -   53s
     0     0 10789.7374    0  531 2364.36130 10789.7374   356%     -   55s
     0     0 10723.4387    0  552 2364.36130 10723.4387   354%     -   56s
     0     0 10699.0322    0  551 2364.36130 10699.0322   353%     -   56s
     0     0 10688.7538    0  541 2364.36130 10688.7538   352%     -   57s
     0     0 10686.0381    0  544 2364.36130 10686.0381   352%     -   57s
     0     0 10487.2555    0  468 2364.36130 10487.2555   344%     -   59s
     0     0 10437.4530    0  475 2364.36130 10437.4530   341%     -   61s
     0     0 10418.3859    0  530 2364.36130 10418.3859   341%     -   61s
     0     0 10410.0968    0  493 2364.36130 10410.0968   340%     -   62s
     0     0 10408.3322    0  490 2364.36130 10408.3322   340%     -   62s
     0     0 10337.9965    0  487 2364.36130 10337.9965   337%     -   64s
     0     0 10299.7261    0  481 2364.36130 10299.7261   336%     -   65s
     0     0 10280.1157    0  477 2364.36130 10280.1157   335%     -   66s
     0     0 10273.7553    0  492 2364.36130 10273.7553   335%     -   66s
     0     0 10270.9730    0  491 2364.36130 10270.9730   334%     -   66s
     0     0 10211.3918    0  478 2364.36130 10211.3918   332%     -   68s
     0     0 10179.1665    0  457 2364.36130 10179.1665   331%     -   69s
     0     0 10167.3374    0  471 2364.36130 10167.3374   330%     -   70s
     0     0 10163.7905    0  476 2364.36130 10163.7905   330%     -   70s
     0     0 10131.0641    0  455 2364.36130 10131.0641   328%     -   72s
     0     0 10112.2072    0  470 2364.36130 10112.2072   328%     -   73s
     0     0 10109.3792    0  473 2364.36130 10109.3792   328%     -   73s
     0     0 10073.3909    0  566 2364.36130 10073.3909   326%     -   74s
     0     0 10063.3924    0  534 2364.36130 10063.3924   326%     -   76s
     0     0 10060.5646    0  537 2364.36130 10060.5646   326%     -   76s
     0     0 10044.9929    0  464 2364.36130 10044.9929   325%     -   77s
     0     0 10044.7435    0  464 2364.36130 10044.7435   325%     -   78s
     0     2 10044.7435    0  464 2364.36130 10044.7435   325%     -   92s
     1     4 9685.14364    1  388 2364.36130 10044.7435   325%  4887   96s
     7    16 8690.86878    3  489 2364.36130 9411.19097   298%  3292  102s
    15    32 8619.98902    4  424 2364.36130 9181.86276   288%  3314  107s
    31    64 8599.85873    5  428 2364.36130 9112.84736   285%  4337  112s
    63    95 8290.74020    6  475 2364.36130 9091.32508   285%  3294  116s
   130   153 7473.63259    8  365 2364.36130 9091.32508   285%  2535  125s
H  167   153                    2366.3772451 9091.32508   284%  2298  125s
   305   337 7771.72725   12  438 2366.37725 9091.32508   284%  1584  131s
   401   360 7593.69174   13  432 2366.37725 9030.70522   282%  1437  135s
   514   405 7480.99223   14  418 2366.37725 8810.10656   272%  1574  143s
   552   439 7395.11000   14  423 2366.37725 8810.10656   272%  1607  146s
H  655   487                    2385.9251605 8744.33568   266%  1550  149s
   688   539 7239.21257   20  366 2385.92516 8744.33568   266%  1546  153s
   764   583 6354.39618   21  350 2385.92516 8744.33568   266%  1521  156s
   913   671 6034.02267   24  333 2385.92516 8294.60719   248%  1485  161s
  1006   707 5428.11284   25  331 2385.92516 8290.19491   247%  1451  165s
  1195   771 2591.86807   27  353 2385.92516 7944.76880   233%  1445  173s
  1282   784     cutoff   29      2385.92516 7813.41286   227%  1456  176s
  1477   858 5647.82556   14  329 2385.92516 7701.12257   223%  1456  186s
  1753   954 6615.10307   18  363 2385.92516 7701.12257   223%  1405  193s
  1866  1013     cutoff   20      2385.92516 7701.12257   223%  1380  196s
  2205  1113     cutoff   21      2385.92516 7554.82000   217%  1319  204s
  2347  1165 6421.99967   15  437 2385.92516 7418.44077   211%  1316  207s
  2495  1210 6345.33251   16  448 2385.92516 7418.44077   211%  1304  213s
  2682  1309 5841.31018   19  367 2385.92516 7380.83493   209%  1286  217s
  2923  1387 5034.45173   22  297 2385.92516 7329.44494   207%  1244  221s
  3179  1443 3316.69818   39  234 2385.92516 7329.44494   207%  1209  225s
H 3277  1443                    2409.4427681 7315.08614   204%  1199  225s
  3338  1495 5241.49609    8  423 2409.44277 7315.08614   204%  1198  230s
H 3341  1495                    2409.5900423 7315.08614   204%  1198  230s
  3785  1657 4749.26755    8  198 2409.59004 7113.21738   195%  1175  238s
  3975  1759 4224.89791   15  172 2409.59004 7016.39397   191%  1174  244s
  4243  1867 3006.42720   14  562 2409.59004 6955.23391   189%  1161  248s
  4483  1942     cutoff   19      2409.59004 6805.39934   182%  1147  253s
  4708  2010 3590.10922   15  178 2409.59004 6776.54580   181%  1136  258s
  4944  2105 3016.29568   15  302 2409.59004 6634.90166   175%  1134  266s
  5240  2238 3772.94443   11  295 2409.59004 6622.14291   175%  1124  271s
  5581  2239 5950.73260   16  464 2409.59004 6526.67277   171%  1105  290s
  5584  2241 4940.10481   27  354 2409.59004 6526.67277   171%  1105  299s
  5585  2242 4832.59420   30  403 2409.59004 6526.67277   171%  1105  301s
  5588  2244 4864.21509    9  443 2409.59004 6526.67277   171%  1104  305s
  5593  2247 3675.28457   17  459 2409.59004 6526.67277   171%  1103  310s
  5598  2250 5504.58257   14  469 2409.59004 6526.67277   171%  1102  315s
  5601  2252 4582.43790   15  483 2409.59004 6526.67277   171%  1101  321s
  5604  2254 5264.18072   29  482 2409.59004 6526.67277   171%  1101  326s
  5607  2256 5594.35194   22  509 2409.59004 6526.67277   171%  1100  330s
  5611  2259 3915.11250   13  509 2409.59004 6526.67277   171%  1099  338s
  5612  2260 5894.25576   17  509 2409.59004 6526.67277   171%  1099  344s
  5613  2263 6526.67277   15  480 2409.59004 6526.67277   171%  1109  348s
  5615  2267 6526.67277   16  423 2409.59004 6526.67277   171%  1110  351s
  5619  2273 6526.67277   17  389 2409.59004 6526.67277   171%  1111  355s
  5643  2310 5486.07988   19  284 2409.59004 6526.67277   171%  1120  361s
  5707  2342 3942.10527   21  261 2409.59004 6526.67277   171%  1128  368s
  5740  2347 3164.66376   22  261 2409.59004 6526.67277   171%  1133  372s
  5788  2333     cutoff   23      2409.59004 6526.67277   171%  1137  375s
  5907  2287     cutoff   22      2409.59004 6526.67277   171%  1140  380s
  6033  2252     cutoff   24      2409.59004 6526.67277   171%  1136  386s
  6160  2177 infeasible   25      2409.59004 6526.67277   171%  1131  391s
  6370  2045     cutoff   26      2409.59004 5855.39263   143%  1114  396s
  6520  1966     cutoff   29      2409.59004 3153.60632  30.9%  1097  400s

Cutting planes:
  Implied bound: 5
  MIR: 173
  Flow cover: 501
  RLT: 10
  Relax-and-lift: 57

Explored 6562 nodes (7262596 simplex iterations) in 402.63 seconds (632.59 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 2409.59 2409.44 2385.93 ... 2136.54

Optimal solution found (tolerance 1.00e-04)
Best objective 2.409590042304e+03, best bound 2.409590042304e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 402.64s
  Master Objective (UB) = 2409.59, θ = 133138.46
  Upper Bound (UB) = 2409.59

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 133138.46
  [DEBUG]   ✓ Scenario 0: θ = 133138.46 ≤ Q = 133138.46 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 133138.46 ≤ Q = 133138.46 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 133138.46 ≤ Q = 133138.46 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x23da9a13
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xdc2565ed
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [6e-13, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.336291e+13
Presolve removed 2628 rows and 1922 columns
Presolve time: 0.01s
Presolved: 465 rows, 467 columns, 1310 nonzeros
Found heuristic solution: objective 6256401.7548
Variable types: 315 continuous, 152 integer (152 binary)

Root relaxation: objective -1.400648e+05, 269 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -140064.78    0  127 6256401.75 -140064.78   102%     -    0s
H    0     0                    -103552.1808 -140064.78  35.3%     -    0s
H    0     0                    -103927.3144 -140064.78  34.8%     -    0s
H    0     0                    -120029.2670 -140064.78  16.7%     -    0s
H    0     0                    -120196.6986 -130825.16  8.84%     -    0s
H    0     0                    -128392.3248 -130825.16  1.89%     -    0s
     0     0 -130825.16    0   89 -128392.32 -130825.16  1.89%     -    0s
H    0     0                    -128651.5066 -130517.14  1.45%     -    0s
     0     0 -130517.14    0   89 -128651.51 -130517.14  1.45%     -    0s
     0     0 -130507.33    0   89 -128651.51 -130507.33  1.44%     -    0s
     0     0 -129416.33    0   84 -128651.51 -129416.33  0.59%     -    0s
     0     0 -129209.78    0   28 -128651.51 -129209.78  0.43%     -    0s
     0     0 -129062.42    0   33 -128651.51 -129062.42  0.32%     -    0s
     0     0 -129047.73    0   44 -128651.51 -129047.73  0.31%     -    0s
     0     0 -129043.13    0   44 -128651.51 -129043.13  0.30%     -    0s
H    0     0                    -128666.8178 -129043.13  0.29%     -    0s
H    0     0                    -128671.5603 -128711.29  0.03%     -    0s
     0     0 -128711.29    0    9 -128671.56 -128711.29  0.03%     -    0s
     0     0 -128706.26    0    8 -128671.56 -128706.26  0.03%     -    0s
     0     0 -128704.63    0    8 -128671.56 -128704.63  0.03%     -    0s
     0     0 -128688.31    0    6 -128671.56 -128688.31  0.01%     -    0s
     0     0 -128688.31    0    5 -128671.56 -128688.31  0.01%     -    0s
H    0     0                    -128685.3308 -128688.31  0.00%     -    0s

Explored 1 nodes (719 simplex iterations) in 0.09 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -128685 -128672 -128667 ... 1.33629e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.286853308210e+05, best bound -1.286883053301e+05, gap 0.0023%
  Subproblem solved in 0.12s
  Worst-case operational profit (Z_SP) = 111634.54
  Scenario: 46 demand increases, 14 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -128685.33
  [DEBUG]   S×d_nominal = 240319.87
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 240319.87 + -128685.33 = 111634.54
  [DEBUG]   Current θ from Master = 133138.46
  [DEBUG]   ⚠️  Z_SP ≤ θ by 21503.92 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -19094.33
  Lower Bound (LB) = -6521.46
  Gap (UB-LB) = 8931.0509, Absolute Gap = 8931.0509, Relative Gap = 3.706461
  Not converged yet (gap = 8931.05 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 46 increases, 14 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178395 nonzeros
Model fingerprint: 0x7bbb9350
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -19094.3 (0.04s)
Loaded MIP start from previous solve with objective -19094.3

Presolve removed 29896 rows and 12136 columns
Presolve time: 1.25s
Presolved: 32647 rows, 15084 columns, 201399 nonzeros
Variable types: 12825 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 32647 rows, 15084 columns, 201399 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   34837   -1.5532847e+04   0.000000e+00   6.339290e+07      5s
Concurrent spin time: 0.48s

Solved with dual simplex

Root relaxation: objective 2.110380e+04, 18730 iterations, 6.19 seconds (8.04 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 21103.8015    0  162 -19094.328 21103.8015   211%     -    7s
H    0     0                    -8655.524522 21103.8015   344%     -    7s
H    0     0                    -8336.124655 21103.8015   353%     -    8s
H    0     0                    -6896.502805 21103.8015   406%     -    8s
H    0     0                    -6778.936018 21103.8015   411%     -    8s
H    0     0                    -6597.627712 21103.8015   420%     -    8s
H    0     0                    -6107.618427 21103.8015   446%     -    8s
H    0     0                    -5956.083766 21103.8015   454%     -    8s
H    0     0                    -5945.908630 21103.8015   455%     -    8s
H    0     0                    -5248.874809 16616.6990   417%     -   12s
     0     0 16472.8205    0  268 -5248.8748 16472.8205   414%     -   12s
     0     0 16400.4409    0  262 -5248.8748 16400.4409   412%     -   13s
     0     0 16400.4409    0  271 -5248.8748 16400.4409   412%     -   14s
     0     0 16400.4409    0  267 -5248.8748 16400.4409   412%     -   14s
     0     0 16400.4409    0  265 -5248.8748 16400.4409   412%     -   14s
     0     0 16400.4409    0  269 -5248.8748 16400.4409   412%     -   14s
H    0     0                    -5200.663126 13808.9420   366%     -   18s
     0     0 13808.9420    0  272 -5200.6631 13808.9420   366%     -   18s
H    0     0                    -4748.333293 13807.4120   391%     -   18s
H    0     0                    -4600.687359 13807.4120   400%     -   18s
H    0     0                    -4405.634018 13807.4120   413%     -   18s
H    0     0                    -4293.393076 13807.4120   422%     -   18s
H    0     0                    -4122.148402 13807.4120   435%     -   18s
H    0     0                    -4118.610375 13807.4120   435%     -   18s
H    0     0                    -4080.124593 13807.4120   438%     -   18s
     0     0 13152.6146    0  299 -4080.1246 13152.6146   422%     -   20s
     0     0 13095.4423    0  302 -4080.1246 13095.4423   421%     -   21s
     0     0 12924.9127    0  331 -4080.1246 12924.9127   417%     -   22s
     0     0 12889.8875    0  344 -4080.1246 12889.8875   416%     -   23s
     0     0 12874.0945    0  308 -4080.1246 12874.0945   416%     -   23s
     0     0 12869.3861    0  314 -4080.1246 12869.3861   415%     -   23s
     0     0 12869.2785    0  315 -4080.1246 12869.2785   415%     -   23s
H    0     0                    -4061.177716 11141.5143   374%     -   29s
H    0     0                    -4043.953973 11141.5143   376%     -   29s
     0     0 11141.5143    0  387 -4043.9540 11141.5143   376%     -   29s
H    0     0                    -2344.625349 11138.0253   575%     -   29s
H    0     0                    -2195.265686 11138.0253   607%     -   29s
H    0     0                    -2123.862218 11138.0253   624%     -   29s
H    0     0                    -2014.843807 11138.0253   653%     -   29s
H    0     0                    -1925.202271 11138.0253   679%     -   29s
H    0     0                    -1920.139374 11138.0253   680%     -   29s
H    0     0                    -1889.784448 11138.0253   689%     -   29s
H    0     0                    -1842.497694 11138.0253   705%     -   29s
     0     0 10775.2538    0  380 -1842.4977 10775.2538   685%     -   30s
     0     0 10619.1604    0  391 -1842.4977 10619.1604   676%     -   32s
     0     0 10538.6858    0  398 -1842.4977 10538.6858   672%     -   32s
     0     0 10408.6899    0  397 -1842.4977 10408.6899   665%     -   34s
     0     0 10387.1720    0  398 -1842.4977 10387.1720   664%     -   34s
     0     0 10366.0516    0  398 -1842.4977 10366.0516   663%     -   34s
     0     0 10358.5124    0  402 -1842.4977 10358.5124   662%     -   34s
     0     0 10357.6484    0  399 -1842.4977 10357.6484   662%     -   35s
     0     0 9819.04430    0  406 -1842.4977 9819.04430   633%     -   41s
H    0     0                    -1784.799169 9809.78523   650%     -   41s
H    0     0                    -1692.157008 9809.78523   680%     -   41s
H    0     0                    -1643.329216 9809.78523   697%     -   41s
     0     0 9513.76770    0  420 -1643.3292 9513.76770   679%     -   43s
     0     0 9364.38299    0  421 -1643.3292 9364.38299   670%     -   44s
     0     0 9288.82898    0  463 -1643.3292 9288.82898   665%     -   46s
     0     0 9280.26898    0  456 -1643.3292 9280.26898   665%     -   46s
     0     0 9263.44515    0  458 -1643.3292 9263.44515   664%     -   47s
     0     0 9256.96700    0  457 -1643.3292 9256.96700   663%     -   47s
     0     0 9254.46613    0  431 -1643.3292 9254.46613   663%     -   48s
     0     0 9246.74546    0  455 -1643.3292 9246.74546   663%     -   48s
     0     0 9235.63638    0  421 -1643.3292 9235.63638   662%     -   49s
     0     0 9233.05195    0  452 -1643.3292 9233.05195   662%     -   49s
     0     0 9229.98429    0  463 -1643.3292 9229.98429   662%     -   49s
     0     0 9228.75435    0  464 -1643.3292 9228.75435   662%     -   49s
     0     0 9122.45442    0  427 -1643.3292 9122.45442   655%     -   52s
H    0     0                    -1626.645041 9121.95401   661%     -   52s
     0     0 9063.21286    0  420 -1626.6450 9063.21286   657%     -   53s
     0     0 9041.02432    0  438 -1626.6450 9041.02432   656%     -   54s
     0     0 9030.24346    0  432 -1626.6450 9030.24346   655%     -   55s
     0     0 9025.80749    0  440 -1626.6450 9025.80749   655%     -   55s
     0     0 9023.89484    0  449 -1626.6450 9023.89484   655%     -   55s
     0     0 9021.69145    0  437 -1626.6450 9021.69145   655%     -   55s
     0     0 9021.14427    0  470 -1626.6450 9021.14427   655%     -   56s
     0     0 8904.63797    0  431 -1626.6450 8904.63797   647%     -   58s
     0     0 8871.92433    0  468 -1626.6450 8871.92433   645%     -   60s
     0     0 8862.38381    0  439 -1626.6450 8862.38381   645%     -   60s
     0     0 8861.41487    0  445 -1626.6450 8861.41487   645%     -   60s
     0     0 8832.77919    0  436 -1626.6450 8832.77919   643%     -   62s
     0     0 8799.75722    0  453 -1626.6450 8799.75722   641%     -   63s
     0     0 8789.09401    0  449 -1626.6450 8789.09401   640%     -   64s
     0     0 8785.25131    0  455 -1626.6450 8785.25131   640%     -   64s
     0     0 8783.52012    0  456 -1626.6450 8783.52012   640%     -   64s
     0     0 8775.61553    0  454 -1626.6450 8775.61553   639%     -   65s
     0     0 8774.31381    0  458 -1626.6450 8774.31381   639%     -   65s
     0     0 8754.91508    0  452 -1626.6450 8754.91508   638%     -   66s
H    0     0                    -1527.966631 8754.41911   673%     -   66s
     0     0 8746.77304    0  452 -1527.9666 8746.77304   672%     -   67s
     0     0 8741.11704    0  466 -1527.9666 8741.11704   672%     -   67s
     0     0 8738.46785    0  460 -1527.9666 8738.46785   672%     -   68s
     0     0 8737.62746    0  465 -1527.9666 8737.62746   672%     -   68s
     0     0 8728.39957    0  458 -1527.9666 8728.39957   671%     -   69s
     0     0 8727.85308    0  460 -1527.9666 8727.85308   671%     -   69s
     0     0 8717.36560    0  454 -1527.9666 8717.36560   671%     -   70s
H    0     0                    -1482.809491 8716.29853   688%     -   70s
H    0     0                    -1468.673561 8716.29853   693%     -   70s
     0     0 8712.48642    0  458 -1468.6736 8712.48642   693%     -   71s
     0     0 8710.72948    0  496 -1468.6736 8710.72948   693%     -   71s
     0     0 8709.85799    0  495 -1468.6736 8709.85799   693%     -   71s
     0     0 8703.47176    0  461 -1468.6736 8703.47176   693%     -   72s
H    0     0                    -1468.018119 8703.28082   693%     -   72s
     0     0 8701.71068    0  457 -1468.0181 8701.71068   693%     -   73s
     0     0 8701.27541    0  463 -1468.0181 8701.27541   693%     -   73s
     0     0 8699.83187    0  465 -1468.0181 8699.83187   693%     -   74s
     0     0 8699.45568    0  465 -1468.0181 8699.45568   693%     -   74s
H    0     0                    -1466.384873 8699.45568   693%     -   88s
     0     2 8699.45568    0  465 -1466.3849 8699.45568   693%     -   88s
     1     4 8600.60257    1  441 -1466.3849 8699.45568   693%  1510   91s
     7    16 8239.28498    3  471 -1466.3849 8419.58182   674%  2364   97s
    15    32 8136.95274    4  477 -1466.3849 8237.26234   662%  2620  103s
    31    64 8034.16754    5  507 -1466.3849 8136.50626   655%  4001  107s
    63    96 7713.85274    6  481 -1466.3849 8034.05935   648%  3044  110s
H   96   193                    -1431.253708 8034.05935   661%  2663  114s
H   96   193                    -1317.725885 8034.05935   710%  2663  114s
H  101   193                    -1193.549171 8034.05935   773%  2589  114s
H  136   193                    -1127.181168 8034.05935   813%  2234  114s
   192   266 7143.75402    8  457 -1127.1812 8034.05935   813%  1805  118s
   265   314 6362.09023    9  399 -1127.1812 8034.05935   813%  1644  122s
H  267   314                    -1095.427281 8034.05935   833%  1644  122s
H  269   314                    -1044.366446 8034.05935   869%  1652  122s
H  271   314                    -856.1023719 8034.05935  1038%  1645  122s
H  275   314                    -837.7616368 8034.05935  1059%  1655  122s
   327   349 6869.60612    9  430 -837.76164 8034.05935  1059%  1553  128s
   402   384 4951.82561   10  366 -837.76164 7759.76870  1026%  1542  132s
H  413   384                    -836.4341411 7759.76870  1028%  1564  132s
H  438   384                    -825.6023774 7759.76870  1040%  1575  132s
   443   431 4577.66144   10  361 -825.60238 7759.76870  1040%  1584  135s
H  514   465                     -26.0094091 7759.76870      -  1586  138s
   544   489 1537.70754   11  368  -26.00941 7759.76870      -  1574  144s
   604   514 4478.07210   12  365  -26.00941 7713.37005      -  1672  148s
H  605   514                      89.7193471 7713.37005  8497%  1670  148s
H  643   514                     143.8327624 7596.53540  5182%  1668  148s
   653   560 3125.74104   13  313  143.83276 7596.53540  5182%  1663  151s
   719   591 3809.77299   13  305  143.83276 7595.16721  5181%  1634  155s
H  720   591                     165.7931764 7595.16721  4481%  1632  155s
   764   636     cutoff   14       165.79318 7595.16721  4481%  1620  161s
H  853   680                     411.4748625 7441.17483  1708%  1581  164s
   893   738 1440.69418   16  326  411.47486 7415.11166  1702%  1552  168s
   977   771 1030.07051   17  266  411.47486 7415.11166  1702%  1494  173s
H  979   771                     458.6550826 7415.11166  1517%  1492  173s
  1059   792     cutoff   17       458.65508 7159.43800  1461%  1435  177s
  1138   819     cutoff   18       458.65508 7062.85998  1440%  1393  181s
  1284   908 3630.56704   10  242  458.65508 6897.33781  1404%  1323  189s
  1370   964 2985.00612   12  226  458.65508 6897.33781  1404%  1299  193s
  1459  1022 1460.92138   13  203  458.65508 6897.33781  1404%  1278  198s
  1557  1104 1436.63834   14  209  458.65508 6770.79958  1376%  1260  203s
  1699  1171 1087.93039   22  202  458.65508 6770.79958  1376%  1220  208s
  1859  1240     cutoff   28       458.65508 6770.79958  1376%  1173  216s
  2016  1340 5017.93454    9  344  458.65508 6770.79958  1376%  1145  222s
  2186  1397 1893.56161   13  183  458.65508 6594.70203  1338%  1112  227s
  2317  1477     cutoff   16       458.65508 6594.70203  1338%  1087  232s
  2454  1545 5307.61021   12  346  458.65508 6594.70203  1338%  1074  237s
  2622  1615 3921.71418   14  247  458.65508 6594.70203  1338%  1061  243s
  2792  1683 3139.04278   15  179  458.65508 6522.91727  1322%  1052  248s
  2967  1775 1213.58635   25  187  458.65508 6394.09717  1294%  1040  255s
  3157  1792     cutoff    8       458.65508 6267.62754  1267%  1026  262s
  3336  1841 2879.03046    9  392  458.65508 6174.35882  1246%  1019  268s
  3481  1877 2395.87744   10  399  458.65508 6137.23644  1238%  1008  274s
  3638  1923 1438.53953   12  226  458.65508 6081.30094  1226%  1011  280s
  3811  1947 1735.36844   10  262  458.65508 6081.30094  1226%  1013  288s
  4023  1998 1911.77989   10  343  458.65508 5670.89576  1136%  1013  296s
  4210  2045 1164.79726   12  268  458.65508 5641.87566  1130%  1018  303s
  4454  2061 1472.45008   12  397  458.65508 5641.87566  1130%  1010  310s
  4500  2077  638.71059   13  387  458.65508 5641.87566  1130%  1017  316s
  4624  2128     cutoff   14       458.65508 5451.23515  1089%  1013  324s
  4844  2184 3583.37546    8  217  458.65508 5092.48285  1010%  1008  332s
  5118  2235  965.90987   11  327  458.65508 4995.53184   989%  1004  340s
  5434  2282     cutoff   16       458.65508 4825.43201   952%   994  349s
  5749  2320     cutoff   11       458.65508 4676.10505   920%   986  356s
  6072  2361 2423.53142   19  279  458.65508 4586.63328   900%   978  366s
  6407  2472     cutoff   27       458.65508 4466.00092   874%   972  375s
  6789  2520  686.36527   23  213  458.65508 4386.96469   856%   960  385s
  7253  2566     cutoff   22       458.65508 4352.34814   849%   946  396s
  7672  2612 1098.82106   27  320  458.65508 4163.19069   808%   937  406s
  8141  2673  967.09039   10  248  458.65508 3964.26924   764%   924  415s
  8630  2719 1546.02201   16  142  458.65508 3757.83271   719%   912  426s
  9143  2693     cutoff   16       458.65508 3702.23027   707%   902  436s
  9729  2712     cutoff   22       458.65508 3567.45281   678%   887  448s
 10302  2671     cutoff   21       458.65508 3443.49135   651%   874  459s
 10940  2617 1478.39285   16  307  458.65508 3259.96967   611%   859  469s
 11578  2655 1155.72450   19  298  458.65508 3151.93067   587%   847  480s
 12364  2607  809.55100   15  265  458.65508 2966.07711   547%   829  491s
 13148  2516 1815.03451   15  340  458.65508 2753.96259   500%   814  503s
 13957  2431  838.48897   18  233  458.65508 2608.41031   469%   799  515s
 14786  2280  777.05965   19  275  458.65508 2496.02385   444%   784  528s
 15784  2243     cutoff   17       458.65508 2193.63804   378%   765  539s
 15908  1993 1543.81955   19  193  458.65508 2193.63804   378%   764  553s
 16648  1566  560.74200   23  158  458.65508 2156.64015   370%   750  566s
 17702   990     cutoff   31       458.65508 1837.43913   301%   736  580s
 18914   173     cutoff   21       458.65508 1766.56052   285%   713  593s
 20424     0     cutoff   21       458.65508 1279.10029   179%   680  595s

Cutting planes:
  Learned: 1
  Gomory: 2
  Implied bound: 29
  MIR: 554
  Flow cover: 863
  RLT: 32
  Relax-and-lift: 76

Explored 20744 nodes (14031147 simplex iterations) in 595.08 seconds (1230.39 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 458.655 411.475 165.793 ... -856.102

Optimal solution found (tolerance 1.00e-04)
Best objective 4.586550826393e+02, best bound 4.586550826393e+02, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 595.12s
  Master Objective (UB) = 458.66, θ = 134185.53
  Upper Bound (UB) = 458.66

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 134185.53
  [DEBUG]   ✓ Scenario 0: θ = 134185.53 ≤ Q = 134185.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 134185.53 ≤ Q = 134185.53 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 134185.53 ≤ Q = 134185.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 134185.53 ≤ Q = 134185.53 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x41b291e3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x41b291e3
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.356660e+13
Presolve removed 2625 rows and 1918 columns
Presolve time: 0.01s
Presolved: 468 rows, 471 columns, 1319 nonzeros
Found heuristic solution: objective 6376879.3504
Variable types: 319 continuous, 152 integer (152 binary)

Root relaxation: objective -1.373638e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -137363.76    0  124 6376879.35 -137363.76   102%     -    0s
H    0     0                    -105811.1656 -137363.76  29.8%     -    0s
H    0     0                    -111037.7763 -137363.76  23.7%     -    0s
H    0     0                    -111996.7709 -120821.15  7.88%     -    0s
     0     0 -120821.15    0   75 -111996.77 -120821.15  7.88%     -    0s
H    0     0                    -118092.9358 -120719.58  2.22%     -    0s
     0     0 -120310.27    0   78 -118092.94 -120310.27  1.88%     -    0s
     0     0 -120302.59    0   78 -118092.94 -120302.59  1.87%     -    0s
H    0     0                    -118427.1881 -120301.35  1.58%     -    0s
     0     0 -120301.35    0   78 -118427.19 -120301.35  1.58%     -    0s
     0     0 -119269.71    0   55 -118427.19 -119269.71  0.71%     -    0s
H    0     0                    -118605.0034 -119267.59  0.56%     -    0s
     0     0 -119125.21    0   34 -118605.00 -119125.21  0.44%     -    0s
     0     0 -119113.28    0   41 -118605.00 -119113.28  0.43%     -    0s
     0     0 -119111.49    0   41 -118605.00 -119111.49  0.43%     -    0s
     0     0 -118894.93    0   12 -118605.00 -118894.93  0.24%     -    0s
     0     0 -118894.92    0   11 -118605.00 -118894.92  0.24%     -    0s
H    0     0                    -118630.0291 -118892.22  0.22%     -    0s
     0     0 -118882.15    0   18 -118630.03 -118882.15  0.21%     -    0s
     0     0 -118881.87    0   18 -118630.03 -118881.87  0.21%     -    0s
     0     0 -118796.36    0    9 -118630.03 -118796.36  0.14%     -    0s
     0     0 -118757.17    0   10 -118630.03 -118757.17  0.11%     -    0s
     0     0 -118725.06    0   10 -118630.03 -118725.06  0.08%     -    0s
     0     0 -118721.56    0   11 -118630.03 -118721.56  0.08%     -    0s
H    0     0                    -118662.3824 -118721.56  0.05%     -    0s
H    0     0                    -118680.9610 -118680.96  0.00%     -    0s
     0     0          -    0      -118680.96 -118680.96  0.00%     -    0s

Cutting planes:
  Gomory: 4
  Implied bound: 3
  MIR: 4
  Flow cover: 6
  Relax-and-lift: 2

Explored 1 nodes (775 simplex iterations) in 0.17 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -118681 -118662 -118630 ... 6.37688e+06
No other solutions better than -118681

Optimal solution found (tolerance 1.00e-04)
Best objective -1.186809610096e+05, best bound -1.186809610096e+05, gap 0.0000%
  Subproblem solved in 0.20s
  Worst-case operational profit (Z_SP) = 121656.30
  Scenario: 34 demand increases, 26 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -118680.96
  [DEBUG]   S×d_nominal = 240337.26
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 240337.26 + -118680.96 = 121656.30
  [DEBUG]   Current θ from Master = 134185.53
  [DEBUG]   ⚠️  Z_SP ≤ θ by 12529.23 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -12070.57
  Lower Bound (LB) = -6521.46
  Gap (UB-LB) = 6980.1160, Absolute Gap = 6980.1160, Relative Gap = 15.218660
  Not converged yet (gap = 6980.12 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 34 increases, 26 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221614 nonzeros
Model fingerprint: 0xc7046bf5
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 37370 rows and 15170 columns
Presolve time: 1.23s
Presolved: 40463 rows, 18290 columns, 250369 nonzeros
Variable types: 16031 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -366101.7227
Found heuristic solution: objective -161037.0536

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 40463 rows, 18290 columns, 250369 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   23782   -3.8954608e+04   0.000000e+00   6.186850e+06      5s
   34723   -4.0274859e+03   0.000000e+00   1.163166e+06     10s
Concurrent spin time: 0.51s

Solved with dual simplex

Root relaxation: objective 2.110380e+04, 22807 iterations, 9.65 seconds (12.70 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 21103.8015    0  162 -161037.05 21103.8015   113%     -   11s
H    0     0                    -153358.0758 21103.8015   114%     -   11s
H    0     0                    -110560.1465 21103.8015   119%     -   11s
H    0     0                    -109919.4820 21103.8015   119%     -   11s
H    0     0                    -109810.5701 21103.8015   119%     -   11s
H    0     0                    -85899.15171 21103.8015   125%     -   11s
H    0     0                    -84520.91507 21103.8015   125%     -   11s
H    0     0                    -19178.84736 21103.8015   210%     -   11s
H    0     0                    -19120.99136 21103.8015   210%     -   11s
H    0     0                    -11980.22761 21103.8015   276%     -   12s
H    0     0                    -11052.97846 16833.3641   252%     -   17s
H    0     0                    -10873.99007 16833.3641   255%     -   17s
H    0     0                    -10864.08593 16833.3641   255%     -   17s
H    0     0                    -10647.89589 16833.3641   258%     -   17s
H    0     0                    -10608.39135 16833.3641   259%     -   17s
     0     0 16491.6389    0  268 -10608.391 16491.6389   255%     -   17s
     0     0 16400.1838    0  270 -10608.391 16400.1838   255%     -   21s
     0     0 16400.1838    0  269 -10608.391 16400.1838   255%     -   22s
     0     0 16400.1838    0  265 -10608.391 16400.1838   255%     -   22s
     0     0 16400.1838    0  265 -10608.391 16400.1838   255%     -   22s
H    0     0                    -9678.184420 13686.2889   241%     -   29s
H    0     0                    -9575.720489 13686.2889   243%     -   29s
H    0     0                    -8900.306420 13686.2889   254%     -   29s
H    0     0                    -8871.015155 13686.2889   254%     -   29s
     0     0 13686.2889    0  279 -8871.0152 13686.2889   254%     -   29s
H    0     0                    -8377.966808 13199.1755   258%     -   33s
H    0     0                    -7754.695954 13199.1755   270%     -   33s
H    0     0                    -4232.695995 13199.1755   412%     -   33s
H    0     0                    -4194.314361 13199.1755   415%     -   33s
     0     0 13199.1755    0  338 -4194.3144 13199.1755   415%     -   33s
     0     0 13013.0365    0  328 -4194.3144 13013.0365   410%     -   35s
     0     0 12956.7098    0  304 -4194.3144 12956.7098   409%     -   36s
     0     0 12895.0260    0  306 -4194.3144 12895.0260   407%     -   37s
     0     0 12890.1048    0  352 -4194.3144 12890.1048   407%     -   37s
     0     0 12887.2045    0  313 -4194.3144 12887.2045   407%     -   38s
     0     0 12878.4918    0  347 -4194.3144 12878.4918   407%     -   38s
     0     0 12876.3062    0  348 -4194.3144 12876.3062   407%     -   38s
     0     0 12876.0509    0  349 -4194.3144 12876.0509   407%     -   38s
H    0     0                    -4179.340665 11416.9050   373%     -   50s
     0     0 11416.9050    0  371 -4179.3407 11416.9050   373%     -   50s
     0     0 10952.4333    0  365 -4179.3407 10952.4333   362%     -   53s
     0     0 10636.8523    0  376 -4179.3407 10636.8523   355%     -   57s
     0     0 10554.3867    0  380 -4179.3407 10554.3867   353%     -   59s
     0     0 10524.9389    0  383 -4179.3407 10524.9389   352%     -   60s
     0     0 10455.7429    0  388 -4179.3407 10455.7429   350%     -   61s
     0     0 10441.2484    0  387 -4179.3407 10441.2484   350%     -   62s
     0     0 10401.7245    0  390 -4179.3407 10401.7245   349%     -   64s
     0     0 10383.9464    0  385 -4179.3407 10383.9464   348%     -   65s
     0     0 10379.8579    0  384 -4179.3407 10379.8579   348%     -   65s
     0     0 10371.3426    0  389 -4179.3407 10371.3426   348%     -   65s
     0     0 10361.2905    0  389 -4179.3407 10361.2905   348%     -   66s
     0     0 10360.4464    0  389 -4179.3407 10360.4464   348%     -   66s
H    0     0                    -4015.680760 10360.4464   358%     -   72s
H    0     0                    -3839.624341 10360.4464   370%     -   72s
     0     0 9506.22800    0  412 -3839.6243 9506.22800   348%     -   77s
H    0     0                    -3724.566383 9506.15097   355%     -   78s
H    0     0                    -3713.173536 9506.15097   356%     -   78s
     0     0 9271.55959    0  410 -3713.1735 9271.55959   350%     -   81s
H    0     0                    -3445.927780 9227.34130   368%     -   83s
H    0     0                    -3197.574924 9227.34130   389%     -   83s
H    0     0                    -2967.688815 9227.34130   411%     -   83s
H    0     0                    -2814.867584 9227.34130   428%     -   83s
H    0     0                    -2792.284385 9227.34130   430%     -   83s
H    0     0                    -2748.711615 9227.34130   436%     -   83s
H    0     0                    -2736.140894 9227.34130   437%     -   83s
H    0     0                    -2730.590272 9227.34130   438%     -   83s
H    0     0                    -2718.092076 9227.34130   439%     -   83s
H    0     0                    -2698.750657 9227.34130   442%     -   83s
H    0     0                    -2698.204032 9227.34130   442%     -   83s
     0     0 9227.34130    0  416 -2698.2040 9227.34130   442%     -   83s
H    0     0                    -2668.063711 9188.07148   444%     -   84s
     0     0 9188.07148    0  417 -2668.0637 9188.07148   444%     -   84s
     0     0 9161.75674    0  425 -2668.0637 9161.75674   443%     -   85s
H    0     0                    -2625.639382 9134.14762   448%     -   87s
     0     0 9134.14762    0  460 -2625.6394 9134.14762   448%     -   87s
     0     0 9122.06289    0  434 -2625.6394 9122.06289   447%     -   88s
     0     0 9119.23245    0  435 -2625.6394 9119.23245   447%     -   88s
     0     0 9118.08688    0  437 -2625.6394 9118.08688   447%     -   89s
     0     0 9004.94800    0  458 -2625.6394 9004.94800   443%     -   92s
     0     0 8974.86128    0  458 -2625.6394 8974.86128   442%     -   93s
     0     0 8962.07941    0  464 -2625.6394 8962.07941   441%     -   95s
     0     0 8955.92102    0  469 -2625.6394 8955.92102   441%     -   95s
     0     0 8954.02463    0  468 -2625.6394 8954.02463   441%     -   96s
     0     0 8952.93805    0  469 -2625.6394 8952.93805   441%     -   96s
     0     0 8928.25152    0  472 -2625.6394 8928.25152   440%     -   98s
H    0     0                    -2609.348279 8927.83120   442%     -  100s
H    0     0                    -2470.183815 8927.83120   461%     -  100s
H    0     0                    -2233.675752 8927.83120   500%     -  100s
H    0     0                    -2197.483989 8927.83120   506%     -  100s
     0     0 8917.94040    0  437 -2197.4840 8917.94040   506%     -  102s
     0     0 8915.12919    0  441 -2197.4840 8915.12919   506%     -  102s
     0     0 8914.30480    0  436 -2197.4840 8914.30480   506%     -  102s
     0     0 8894.13449    0  428 -2197.4840 8894.13449   505%     -  104s
     0     0 8886.36468    0  427 -2197.4840 8886.36468   504%     -  105s
     0     0 8881.89811    0  430 -2197.4840 8881.89811   504%     -  106s
     0     0 8881.26450    0  429 -2197.4840 8881.26450   504%     -  106s
     0     0 8872.98166    0  421 -2197.4840 8872.98166   504%     -  108s
H    0     0                    -1986.287822 8872.79236   547%     -  108s
H    0     0                    -1968.481145 8872.79236   551%     -  109s
     0     0 8871.19239    0  429 -1968.4811 8871.19239   551%     -  109s
     0     0 8870.66262    0  426 -1968.4811 8870.66262   551%     -  109s
     0     0 8861.73993    0  435 -1968.4811 8861.73993   550%     -  111s
     0     0 8860.72879    0  437 -1968.4811 8860.72879   550%     -  112s
     0     0 8852.32815    0  439 -1968.4811 8852.32815   550%     -  114s
H    0     0                    -1625.358895 8852.22311   645%     -  118s
H    0     0                    -1569.149395 8852.22311   664%     -  118s
H    0     0                    -1522.686460 8852.22311   681%     -  118s
     0     0 8846.75543    0  433 -1522.6865 8846.75543   681%     -  118s
     0     0 8840.04179    0  435 -1522.6865 8840.04179   681%     -  119s
     0     0 8837.48094    0  436 -1522.6865 8837.48094   680%     -  119s
     0     0 8836.44287    0  437 -1522.6865 8836.44287   680%     -  120s
     0     0 8832.41141    0  439 -1522.6865 8832.41141   680%     -  121s
     0     0 8831.39182    0  438 -1522.6865 8831.39182   680%     -  121s
     0     0 8828.79416    0  441 -1522.6865 8828.79416   680%     -  123s
     0     0 8827.72169    0  442 -1522.6865 8827.72169   680%     -  123s
     0     0 8824.92592    0  438 -1522.6865 8824.92592   680%     -  125s
     0     0 8823.65791    0  442 -1522.6865 8823.65791   679%     -  125s
     0     0 8820.70418    0  446 -1522.6865 8820.70418   679%     -  126s
     0     0 8820.47812    0  446 -1522.6865 8820.47812   679%     -  127s
H    0     0                    -1486.729861 8820.47418   693%     -  154s
     0     2 8820.47418    0  446 -1486.7299 8820.47418   693%     -  155s
     3     8 8642.02728    2  425 -1486.7299 8679.20403   684%  3569  164s
     7    16 8552.53179    3  437 -1486.7299 8641.96912   681%  4138  170s
    15    32 8471.36591    4  446 -1486.7299 8549.97762   675%  4721  178s
    31    61 7840.06284    5  414 -1486.7299 8471.00951   670%  6090  192s
    60    93 5766.39432    6  329 -1486.7299 8471.00951   670%  7976  200s
    92   180 5760.36808    7  329 -1486.7299 8471.00951   670%  6353  217s
   187   211 5496.82419   10  311 -1486.7299 8471.00951   670%  4079  222s
H  188   211                    -509.7044817 8471.00951  1762%  4057  222s
   220   285 5306.74228   10  306 -509.70448 8283.37423  1725%  3708  231s
   323   317 5460.25111   11  309 -509.70448 8277.01307  1724%  3140  238s
   355   352 5229.50637   11  300 -509.70448 8277.01307  1724%  3105  244s
   392   389 5396.95674   12  300 -509.70448 8277.01307  1724%  3033  252s
   429   424 1681.15685   11  229 -509.70448 8277.01307  1724%  3017  256s
H  459   424                    -318.9150364 8277.01307  2695%  2961  256s
   470   514 1633.57962   11  218 -318.91504 8277.01307  2695%  2932  263s
   586   607 5345.43771   13  257 -318.91504 8268.59809  2693%  2589  269s
   687   695 5038.84001   14  261 -318.91504 8189.76459  2668%  2380  277s
   783   776 4745.37018   17  244 -318.91504 8189.76459  2668%  2242  281s
   876   872 4676.00587   18  238 -318.91504 8189.76459  2668%  2109  288s
   988   917 4440.22468   21  308 -318.91504 8114.19834  2644%  1973  297s
  1092   939 4059.46062   23  309 -318.91504 7903.19291  2578%  1887  305s
  1138   967 3448.58573   23  250 -318.91504 7889.38443  2574%  1896  312s
H 1139   967                    -279.6834498 7889.38443  2921%  1894  312s
  1196  1050 2550.59776   24  329 -279.68345 7889.38443  2921%  1886  320s
  1334  1137 3542.48436   25  315 -279.68345 7889.38443  2921%  1813  330s
  1402  1179 1704.69440   29  261 -279.68345 7889.38443  2921%  1779  336s
  1472  1247 2859.55268   30  299 -279.68345 7889.38443  2921%  1752  345s
  1568  1323 2662.37220   32  302 -279.68345 7889.38443  2921%  1710  351s
  1682  1424 2174.35345   36  283 -279.68345 7841.19773  2904%  1669  360s
  1813  1539 1471.92946   38  296 -279.68345 7841.19773  2904%  1619  367s
  1971  1622 1185.43279   43  266 -279.68345 7406.26572  2748%  1568  374s
  2108  1707  558.73833   46  257 -279.68345 7305.57177  2712%  1545  382s
  2240  1775     cutoff   55      -279.68345 7305.57177  2712%  1528  389s
  2369  1882 4791.84600    7  274 -279.68345 7267.13152  2698%  1520  400s
  2523  1977 3713.98784   11  276 -279.68345 7267.13152  2698%  1503  408s
  2696  2109 3002.14857   13  276 -279.68345 7261.39491  2696%  1477  417s
  2881  2231 2589.72675   18  291 -279.68345 7256.03440  2694%  1450  426s
  3071  2366 1933.79572   22  284 -279.68345 7176.94290  2666%  1433  438s
  3268  2491  664.67369   32  209 -279.68345 7176.94290  2666%  1408  448s
  3492  2628 2428.74185   11  370 -279.68345 7068.18125  2627%  1394  458s
  3723  2679 1502.28175   14  299 -279.68345 7068.18125  2627%  1379  468s
  3872  2747  282.32518   14  225 -279.68345 7068.18125  2627%  1398  478s
  4048  2832 5876.13387   11  207 -279.68345 7068.18125  2627%  1403  487s
  4227  2891 -248.99067   15  139 -279.68345 7068.18125  2627%  1411  500s
  4432  3028 4648.25963   13  331 -279.68345 7068.18125  2627%  1403  513s
  4695  3029 4471.44804   23  446 -279.68345 7068.18125  2627%  1388  546s
  4697  3030 1609.96543   18  162 -279.68345 7068.18125  2627%  1387  562s
  4698  3031 1693.25676   31  314 -279.68345 7068.18125  2627%  1387  574s
  4699  3032  982.43351   27  401 -279.68345 7068.18125  2627%  1387  585s
  4700  3032  711.98070   22  437 -279.68345 7068.18125  2627%  1386  592s
  4701  3033 3029.37643   21  437 -279.68345 7068.18125  2627%  1386  597s
  4702  3034  322.26753   29  424 -279.68345 7068.18125  2627%  1386  601s
  4703  3034 6296.73522   15  465 -279.68345 7068.18125  2627%  1385  605s
  4706  3036 5656.61609   14  428 -279.68345 7068.18125  2627%  1384  612s
  4708  3038  592.12689   12  428 -279.68345 7068.18125  2627%  1384  615s
  4711  3040 3292.88933   16  432 -279.68345 7068.18125  2627%  1383  623s
  4712  3040 2732.52629   32  439 -279.68345 7068.18125  2627%  1383  627s
  4713  3041 1315.77163   49  443 -279.68345 7068.18125  2627%  1382  630s
  4716  3043 1320.56787   25  486 -279.68345 7068.18125  2627%  1382  640s
  4720  3046 1967.25793   41  510 -279.68345 7068.18125  2627%  1380  647s
  4721  3046  374.90553   45  448 -279.68345 7068.18125  2627%  1380  650s
  4723  3048 4396.51062   20  467 -279.68345 7068.18125  2627%  1379  655s
  4725  3049  410.57244   31  505 -279.68345 7068.18125  2627%  1379  661s
  4726  3050 2511.76771   25  511 -279.68345 7068.18125  2627%  1379  667s
  4728  3051  816.09586   58  472 -279.68345 7068.18125  2627%  1378  670s
  4729  3052 1902.06598   20  505 -279.68345 7068.18125  2627%  1378  675s
  4731  3053 1245.10395   29  510 -279.68345 7068.18125  2627%  1377  681s
  4732  3054 1982.97723   22  471 -279.68345 7068.18125  2627%  1377  686s
  4734  3055 2475.10744   41  465 -279.68345 7068.18125  2627%  1376  690s
  4736  3056  407.67375   24  466 -279.68345 7068.18125  2627%  1376  697s
  4737  3057 6300.47132   16  474 -279.68345 7068.18125  2627%  1375  702s
  4738  3058 2055.50120   16  474 -279.68345 7068.18125  2627%  1375  720s
  4739  3058 4814.11009   16  474 -279.68345 7068.18125  2627%  1375  739s
  4740  3062 7068.18125   12  450 -279.68345 7068.18125  2627%  1412  759s
  4742  3065 7068.18125   13  435 -279.68345 7068.18125  2627%  1416  771s
  4746  3072 7068.18125   14  429 -279.68345 7068.18125  2627%  1420  777s
  4754  3085 7068.18125   15  424 -279.68345 7068.18125  2627%  1425  793s
  4770  3096 6708.22350   16  366 -279.68345 7068.18125  2627%  1437  811s
  4786  3100 3939.22374   17  299 -279.68345 7068.18125  2627%  1469  820s
  4818  3146 3655.05284   18  290 -279.68345 7068.18125  2627%  1484  830s
  4900  3148 2879.72186   20  281 -279.68345 7068.18125  2627%  1512  843s
  4972  3153 3183.91147   19  282 -279.68345 6990.70574  2600%  1533  861s
  5070  3131  924.82437   21  260 -279.68345 6458.99637  2409%  1551  872s
  5131  3119 2630.42132   21  291 -279.68345 6458.99637  2409%  1568  883s
  5209  3110 2636.77156   20  337 -279.68345 6458.99637  2409%  1599  894s
  5273  3109 2660.91628   21  291 -279.68345 6458.99637  2409%  1615  903s
  5343  3100 1027.17158   21  339 -279.68345 6088.63167  2277%  1636  909s
  5401  3094     cutoff   21      -279.68345 5801.18329  2174%  1645  916s
  5480  3088 1461.58278   22  260 -279.68345 5539.26181  2081%  1661  925s
  5519  3101 1322.88515   23  270 -279.68345 5539.26181  2081%  1671  930s
  5567  3101     cutoff   25      -279.68345 5539.26181  2081%  1684  936s
  5613  3109     cutoff   25      -279.68345 5429.46221  2041%  1693  942s
  5676  3098 2358.19424   23  277 -279.68345 5429.46221  2041%  1698  952s
  5754  3076  149.23067   25  255 -279.68345 5429.46221  2041%  1704  961s
  5851  3068     cutoff   26      -279.68345 5190.92859  1956%  1712  972s
H 5892  2900                    -235.6825430 4958.14438  2204%  1717  972s
  5927  2890 1064.95500   25  260 -235.68254 4902.43809  2180%  1716  978s
  6030  2872     cutoff   27      -235.68254 4756.17349  2118%  1726  987s
  6154  2827     cutoff   21      -235.68254 4756.17349  2118%  1727  993s
  6270  2794 2627.09550   26  333 -235.68254 4612.81013  2057%  1739 1001s
  6372  2747  135.02091   28  272 -235.68254 4381.06922  1959%  1750 1010s
  6496  2714 infeasible   30      -235.68254 4381.06922  1959%  1765 1017s
H 6572  2542                    -177.1923037 4381.06922  2572%  1769 1017s
  6615  2514  268.93019   23  379 -177.19230 4381.06922  2572%  1775 1026s
  6736  2426     cutoff   25      -177.19230 3731.80404  2206%  1779 1036s
  6916  2349 1893.81222   22  227 -177.19230 3731.80404  2206%  1776 1045s
H 7046  2166                    -157.7398217 3731.80404  2466%  1780 1045s
  7060  2085     cutoff   25      -157.73982 3731.80404  2466%  1779 1055s
H 7282  1879                    -134.0441534 2816.65389  2201%  1767 1055s
  7291  1775     cutoff   24      -134.04415 2783.90736  2177%  1766 1061s
  7514  1626     cutoff   24      -134.04415 2633.85457  2065%  1750 1069s
  7655  1534     cutoff   27      -134.04415 1816.14352  1455%  1736 1074s
H 7704  1393                     -84.1079555 1816.14352  2259%  1728 1074s
  7788  1366  -43.85819   55   14  -84.10796  966.22801  1249%  1714 1076s
H 7905  1208                     -57.1367918   60.15560   205%  1690 1076s

Cutting planes:
  Gomory: 1
  MIR: 492
  Flow cover: 1125
  RLT: 11
  Relax-and-lift: 108

Explored 7999 nodes (13498959 simplex iterations) in 1076.98 seconds (1888.13 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -57.1368 -84.108 -134.044 ... -1486.73
No other solutions better than -57.1368

Optimal solution found (tolerance 1.00e-04)
Best objective -5.713679182463e+01, best bound -5.713679182463e+01, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1076.99s
  Master Objective (UB) = -57.14, θ = 134239.08
  Upper Bound (UB) = -57.14

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 134239.08
  [DEBUG]   ✓ Scenario 0: θ = 134239.08 ≤ Q = 134239.08 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 134239.08 ≤ Q = 134239.08 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 134239.08 ≤ Q = 134239.08 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 134239.08 ≤ Q = 134239.08 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 134239.08 ≤ Q = 134239.08 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x6b1dee90
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x6b1dee90
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.352795e+13
Presolve removed 2626 rows and 1919 columns
Presolve time: 0.01s
Presolved: 467 rows, 470 columns, 1316 nonzeros
Found heuristic solution: objective 6380759.4604
Variable types: 318 continuous, 152 integer (152 binary)

Root relaxation: objective -1.419305e+05, 243 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -141930.48    0  122 6380759.46 -141930.48   102%     -    0s
H    0     0                    -108872.4234 -141930.48  30.4%     -    0s
H    0     0                    -109973.2177 -141930.48  29.1%     -    0s
H    0     0                    -110915.2955 -123941.21  11.7%     -    0s
H    0     0                    -120468.4169 -123941.21  2.88%     -    0s
     0     0 -123941.21    0   82 -120468.42 -123941.21  2.88%     -    0s
H    0     0                    -120558.4477 -123940.95  2.81%     -    0s
H    0     0                    -121214.0306 -123940.95  2.25%     -    0s
H    0     0                    -121304.0614 -123940.95  2.17%     -    0s
     0     0 -123376.48    0   84 -121304.06 -123376.48  1.71%     -    0s
     0     0 -123101.36    0   52 -121304.06 -123101.36  1.48%     -    0s
H    0     0                    -121423.1352 -122994.84  1.29%     -    0s
     0     0 -122981.62    0   66 -121423.14 -122981.62  1.28%     -    0s
H    0     0                    -121439.7957 -122738.03  1.07%     -    0s
     0     0 -122738.03    0   53 -121439.80 -122738.03  1.07%     -    0s
     0     0 -122724.07    0   50 -121439.80 -122724.07  1.06%     -    0s
     0     0 -122597.93    0   52 -121439.80 -122597.93  0.95%     -    0s
     0     0 -122594.47    0   52 -121439.80 -122594.47  0.95%     -    0s
     0     2 -122560.02    0   52 -121439.80 -122560.02  0.92%     -    0s
H   45    45                    -121842.3350 -122146.05  0.25%  11.8    0s
H   52    42                    -121843.1539 -122096.58  0.21%  11.5    0s
*  105     3               7    -121855.2532 -121997.25  0.12%   7.7    0s

Cutting planes:
  Gomory: 36
  Implied bound: 3
  MIR: 133
  Flow cover: 1
  RLT: 51
  Relax-and-lift: 1

Explored 150 nodes (1446 simplex iterations) in 0.19 seconds (0.06 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -121855 -121843 -121842 ... -108872
No other solutions better than -121855

Optimal solution found (tolerance 1.00e-04)
Best objective -1.218552532171e+05, best bound -1.218552532171e+05, gap 0.0000%
  Subproblem solved in 0.23s
  Worst-case operational profit (Z_SP) = 118143.33
  Scenario: 15 demand increases, 45 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -121855.25
  [DEBUG]   S×d_nominal = 239998.58
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 239998.58 + -121855.25 = 118143.33
  [DEBUG]   Current θ from Master = 134239.08
  [DEBUG]   ⚠️  Z_SP ≤ θ by 16095.75 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -16152.89
  Lower Bound (LB) = -6521.46
  Gap (UB-LB) = 6464.3241, Absolute Gap = 6464.3241, Relative Gap = 113.137680
  Not converged yet (gap = 6464.32 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 15 increases, 45 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 264833 nonzeros
Model fingerprint: 0xb3ce0dbc
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 44844 rows and 18204 columns
Presolve time: 1.28s
Presolved: 48279 rows, 21496 columns, 299339 nonzeros
Variable types: 19237 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -366101.7227
Found heuristic solution: objective -161037.0536

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 48279 rows, 21496 columns, 299339 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   21793   -6.8315505e+04   0.000000e+00   2.165997e+09      5s
   33223   -1.9039873e+04   0.000000e+00   6.515233e+06     10s
   41269   -4.7099441e+03   0.000000e+00   1.591395e+06     15s
Concurrent spin time: 1.68s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 2.107102e+04, 29367 iterations, 16.38 seconds (21.12 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 21071.0202    0  164 -161037.05 21071.0202   113%     -   18s
H    0     0                    -157059.5669 21071.0202   113%     -   18s
H    0     0                    -68337.86266 21071.0202   131%     -   18s
H    0     0                    -66427.00484 21071.0202   132%     -   18s
H    0     0                    -33790.51720 21071.0202   162%     -   18s
H    0     0                    -31822.68080 21071.0202   166%     -   18s
H    0     0                    -31374.09370 21071.0202   167%     -   18s
H    0     0                    -22872.49658 21071.0202   192%     -   19s
H    0     0                    -20286.84929 21071.0202   204%     -   19s
H    0     0                    -19965.62762 21071.0202   206%     -   19s
H    0     0                    -19795.50006 17108.0871   186%     -   26s
H    0     0                    -19578.58695 17108.0871   187%     -   26s
     0     0 17108.0871    0  263 -19578.587 17108.0871   187%     -   26s
     0     0 17045.9846    0  260 -19578.587 17045.9846   187%     -   27s
     0     0 17045.9846    0  268 -19578.587 17045.9846   187%     -   28s
     0     0 17045.9846    0  268 -19578.587 17045.9846   187%     -   28s
     0     0 14504.8216    0  256 -19578.587 14504.8216   174%     -   34s
H    0     0                    -15607.55570 14504.6313   193%     -   35s
H    0     0                    -15046.56873 14504.6313   196%     -   35s
H    0     0                    -14576.80272 14504.6313   200%     -   35s
H    0     0                    -14170.73073 14504.6313   202%     -   35s
H    0     0                    -14131.62520 14504.6313   203%     -   35s
H    0     0                    -11608.16866 14224.3003   223%     -   39s
H    0     0                    -10504.03494 14224.3003   235%     -   39s
H    0     0                    -10487.08690 14224.3003   236%     -   39s
H    0     0                    -10475.92577 14224.3003   236%     -   39s
H    0     0                    -10346.09167 14224.3003   237%     -   39s
     0     0 14224.3003    0  268 -10346.092 14224.3003   237%     -   39s
     0     0 14115.0539    0  277 -10346.092 14115.0539   236%     -   40s
     0     0 14028.4225    0  275 -10346.092 14028.4225   236%     -   41s
     0     0 14017.2955    0  285 -10346.092 14017.2955   235%     -   42s
     0     0 13984.7172    0  292 -10346.092 13984.7172   235%     -   43s
     0     0 13976.6286    0  290 -10346.092 13976.6286   235%     -   43s
     0     0 13974.8616    0  292 -10346.092 13974.8616   235%     -   43s
     0     0 13974.1880    0  292 -10346.092 13974.1880   235%     -   43s
H    0     0                    -10035.55972 12065.2719   220%     -   56s
     0     0 12065.2719    0  337 -10035.560 12065.2719   220%     -   56s
H    0     0                    -9929.155736 12065.0819   222%     -   57s
H    0     0                    -9911.953015 12065.0819   222%     -   57s
     0     0 11435.0066    0  351 -9911.9530 11435.0066   215%     -   60s
     0     0 11268.4634    0  356 -9911.9530 11268.4634   214%     -   63s
H    0     0                    -8164.184821 11181.1537   237%     -   64s
     0     0 11181.1537    0  356 -8164.1848 11181.1537   237%     -   64s
     0     0 11132.9250    0  359 -8164.1848 11132.9250   236%     -   65s
     0     0 11104.8672    0  361 -8164.1848 11104.8672   236%     -   66s
     0     0 11086.8800    0  364 -8164.1848 11086.8800   236%     -   67s
     0     0 11063.0336    0  362 -8164.1848 11063.0336   236%     -   67s
     0     0 11057.6283    0  362 -8164.1848 11057.6283   235%     -   68s
     0     0 11041.4786    0  370 -8164.1848 11041.4786   235%     -   68s
     0     0 11034.4043    0  373 -8164.1848 11034.4043   235%     -   69s
     0     0 11032.7767    0  373 -8164.1848 11032.7767   235%     -   69s
     0     0 11031.8491    0  375 -8164.1848 11031.8491   235%     -   69s
     0     0 10156.5864    0  433 -8164.1848 10156.5864   224%     -   83s
     0     0 9976.81062    0  389 -8164.1848 9976.81062   222%     -   88s
     0     0 9903.86085    0  434 -8164.1848 9903.86085   221%     -   90s
     0     0 9845.54356    0  402 -8164.1848 9845.54356   221%     -   92s
     0     0 9767.89842    0  410 -8164.1848 9767.89842   220%     -   94s
     0     0 9754.45581    0  410 -8164.1848 9754.45581   219%     -   96s
     0     0 9742.77179    0  410 -8164.1848 9742.77179   219%     -   97s
     0     0 9737.54070    0  414 -8164.1848 9737.54070   219%     -   98s
     0     0 9734.73521    0  453 -8164.1848 9734.73521   219%     -   98s
     0     0 9734.29104    0  417 -8164.1848 9734.29104   219%     -   99s
     0     0 9515.12610    0  451 -8164.1848 9515.12610   217%     -  104s
H    0     0                    -8092.045528 9515.01316   218%     -  104s
H    0     0                    -7872.504305 9515.01316   221%     -  104s
     0     0 9418.37936    0  456 -7872.5043 9418.37936   220%     -  108s
     0     0 9379.96353    0  467 -7872.5043 9379.96353   219%     -  111s
H    0     0                    -6476.842167 9364.19269   245%     -  113s
     0     0 9364.19269    0  467 -6476.8422 9364.19269   245%     -  113s
     0     0 9346.48429    0  476 -6476.8422 9346.48429   244%     -  115s
     0     0 9343.28402    0  474 -6476.8422 9343.28402   244%     -  116s
     0     0 9331.15256    0  474 -6476.8422 9331.15256   244%     -  117s
     0     0 9326.35446    0  467 -6476.8422 9326.35446   244%     -  118s
     0     0 9317.67677    0  464 -6476.8422 9317.67677   244%     -  119s
     0     0 9313.50757    0  471 -6476.8422 9313.50757   244%     -  119s
     0     0 9311.92696    0  479 -6476.8422 9311.92696   244%     -  120s
     0     0 9311.46996    0  473 -6476.8422 9311.46996   244%     -  120s
     0     0 9228.80456    0  433 -6476.8422 9228.80456   242%     -  124s
H    0     0                    -6084.169176 9226.98751   252%     -  125s
H    0     0                    -4654.547857 9226.98751   298%     -  125s
H    0     0                    -4640.829565 9226.98751   299%     -  125s
H    0     0                    -4375.737803 9226.98751   311%     -  125s
H    0     0                    -4268.107408 9226.98751   316%     -  125s
     0     0 9195.92827    0  464 -4268.1074 9195.92827   315%     -  127s
     0     0 9165.26365    0  462 -4268.1074 9165.26365   315%     -  129s
     0     0 9157.17914    0  463 -4268.1074 9157.17914   315%     -  131s
     0     0 9150.41475    0  463 -4268.1074 9150.41475   314%     -  131s
     0     0 9147.98580    0  458 -4268.1074 9147.98580   314%     -  132s
     0     0 9146.50585    0  456 -4268.1074 9146.50585   314%     -  132s
     0     0 9143.75674    0  459 -4268.1074 9143.75674   314%     -  133s
     0     0 9141.85267    0  463 -4268.1074 9141.85267   314%     -  133s
     0     0 9140.59508    0  465 -4268.1074 9140.59508   314%     -  133s
     0     0 9096.48763    0  430 -4268.1074 9096.48763   313%     -  138s
H    0     0                    -3853.342611 9095.47632   336%     -  138s
     0     0 9077.64258    0  475 -3853.3426 9077.64258   336%     -  141s
     0     0 9058.94012    0  449 -3853.3426 9058.94012   335%     -  142s
     0     0 9052.92322    0  444 -3853.3426 9052.92322   335%     -  143s
     0     0 9050.93032    0  445 -3853.3426 9050.93032   335%     -  144s
     0     0 9048.88346    0  449 -3853.3426 9048.88346   335%     -  145s
     0     0 9047.09872    0  451 -3853.3426 9047.09872   335%     -  145s
     0     0 9046.89598    0  454 -3853.3426 9046.89598   335%     -  145s
H    0     0                    -3596.457839 8982.82590   350%     -  149s
H    0     0                    -3588.400323 8982.82590   350%     -  149s
H    0     0                    -3337.611248 8982.82590   369%     -  149s
     0     0 8982.82590    0  426 -3337.6112 8982.82590   369%     -  149s
H    0     0                    -3222.262192 8982.78995   379%     -  150s
H    0     0                    -3213.043969 8982.78995   380%     -  150s
H    0     0                    -3199.727889 8982.78995   381%     -  150s
H    0     0                    -3111.600710 8982.78995   389%     -  150s
H    0     0                    -2885.583232 8964.18788   411%     -  151s
     0     0 8964.18788    0  443 -2885.5832 8964.18788   411%     -  151s
     0     0 8958.85706    0  443 -2885.5832 8958.85706   410%     -  152s
     0     0 8957.58168    0  443 -2885.5832 8957.58168   410%     -  153s
     0     0 8952.83995    0  441 -2885.5832 8952.83995   410%     -  154s
H    0     0                    -2771.254005 8952.46421   423%     -  155s
H    0     0                    -2741.766916 8952.46421   427%     -  155s
H    0     0                    -2707.327680 8952.46421   431%     -  155s
H    0     0                    -2706.509500 8952.46421   431%     -  155s
H    0     0                    -2679.058770 8952.46421   434%     -  155s
     0     0 8949.97741    0  448 -2679.0588 8949.97741   434%     -  155s
     0     0 8949.24980    0  448 -2679.0588 8949.24980   434%     -  156s
     0     0 8928.56030    0  449 -2679.0588 8928.56030   433%     -  159s
     0     0 8925.61790    0  443 -2679.0588 8925.61790   433%     -  162s
     0     0 8921.83883    0  449 -2679.0588 8921.83883   433%     -  163s
     0     0 8920.92119    0  445 -2679.0588 8920.92119   433%     -  163s
     0     0 8914.04036    0  443 -2679.0588 8914.04036   433%     -  164s
     0     0 8909.81323    0  443 -2679.0588 8909.81323   433%     -  166s
     0     0 8907.07167    0  448 -2679.0588 8907.07167   432%     -  167s
     0     0 8905.07001    0  450 -2679.0588 8905.07001   432%     -  167s
     0     0 8904.28168    0  453 -2679.0588 8904.28168   432%     -  168s
     0     0 8887.41536    0  453 -2679.0588 8887.41536   432%     -  170s
H    0     0                    -2572.348325 8887.27843   445%     -  171s
H    0     0                    -2571.530145 8887.27843   446%     -  171s
H    0     0                    -2518.918768 8887.27843   453%     -  171s
     0     0 8884.89624    0  455 -2518.9188 8884.89624   453%     -  172s
     0     0 8883.92758    0  452 -2518.9188 8883.92758   453%     -  173s
     0     0 8881.35785    0  451 -2518.9188 8881.35785   453%     -  174s
     0     0 8880.05074    0  444 -2518.9188 8880.05074   453%     -  175s
     0     0 8875.88829    0  452 -2518.9188 8875.88829   452%     -  176s
     0     0 8875.48028    0  453 -2518.9188 8875.48028   452%     -  176s
     0     0 8767.75193    0  462 -2518.9188 8767.75193   448%     -  180s
     0     0 8764.00231    0  460 -2518.9188 8764.00231   448%     -  182s
     0     0 8762.84703    0  465 -2518.9188 8762.84703   448%     -  182s
     0     0 8738.84577    0  454 -2518.9188 8738.84577   447%     -  186s
H    0     0                    -2459.122403 8738.25702   455%     -  187s
H    0     0                    -2410.613600 8738.25702   462%     -  187s
     0     0 8732.53412    0  463 -2410.6136 8732.53412   462%     -  189s
     0     0 8727.66076    0  465 -2410.6136 8727.66076   462%     -  189s
     0     0 8726.17271    0  466 -2410.6136 8726.17271   462%     -  190s
     0     0 8690.85103    0  467 -2410.6136 8690.85103   461%     -  193s
     0     0 8676.43985    0  497 -2410.6136 8676.43985   460%     -  196s
     0     0 8675.71140    0  459 -2410.6136 8675.71140   460%     -  196s
     0     0 8665.15560    0  463 -2410.6136 8665.15560   459%     -  199s
     0     0 8662.93180    0  464 -2410.6136 8662.93180   459%     -  200s
     0     0 8662.06135    0  466 -2410.6136 8662.06135   459%     -  201s
     0     0 8648.56347    0  462 -2410.6136 8648.56347   459%     -  203s
     0     0 8647.46275    0  468 -2410.6136 8647.46275   459%     -  204s
     0     0 8645.74103    0  501 -2410.6136 8645.74103   459%     -  205s
     0     0 8644.23303    0  464 -2410.6136 8644.23303   459%     -  206s
     0     0 8641.21418    0  495 -2410.6136 8641.21418   458%     -  207s
     0     0 8640.90789    0  495 -2410.6136 8640.90789   458%     -  208s
     0     2 8640.90789    0  495 -2410.6136 8640.90789   458%     -  234s
     1     4 8539.78016    1  483 -2410.6136 8640.90789   458%  5212  241s
     3     8 8465.78821    2  477 -2410.6136 8539.58621   454%  5747  245s
     7    16 8359.30761    3  445 -2410.6136 8465.75444   451%  4365  254s
    15    32 8071.09258    4  474 -2410.6136 8358.56603   447%  6765  263s
    31    48 7184.99408    5  447 -2410.6136 8071.07664   435%  7996  284s
    47    80 6682.84230    6  387 -2410.6136 8071.07664   435%  9509  294s
H   49    80                    -2350.695547 8071.07664   443%  9235  294s
H   50    80                    -2316.575301 8071.07664   448%  9152  294s
    79   141 6650.07071    7  427 -2316.5753 8071.07664   448%  6763  313s
H  156   198                    -2061.984079 8071.07664   491%  4342  327s
H  157   198                    -1661.539406 8071.07664   586%  4330  327s
H  207   198                    -1151.414783 8071.07664   801%  3715  327s
   217   299 6632.05418    9  424 -1151.4148 8071.07664   801%  3632  337s
   348   381 6414.48953   10  366 -1151.4148 8071.07664   801%  2865  348s
   456   439 6028.99118   11  337 -1151.4148 8071.07664   801%  2530  358s
   557   501 6398.76660   11  352 -1151.4148 8071.07664   801%  2340  368s
   644   565 6151.43598   12  379 -1151.4148 8071.07664   801%  2218  379s
   730   623 5644.52976   13  377 -1151.4148 8071.07664   801%  2118  389s
   817   703 5398.54591   12  320 -1151.4148 8071.07664   801%  2026  398s
   915   779 5779.14748   12  374 -1151.4148 8071.07664   801%  1919  406s
  1013   850 -464.41835   12  200 -1151.4148 8071.07664   801%  1855  417s
  1110   908 5422.39120   14  411 -1151.4148 8071.07664   801%  1805  425s
  1212   950 5320.77652   15  371 -1151.4148 8071.07664   801%  1751  437s
  1296   999 4802.98060   16  363 -1151.4148 8071.07664   801%  1738  447s
  1373  1071 4718.53245   17  356 -1151.4148 8071.07664   801%  1764  458s
* 1453  1071              78    -1071.697471 8071.07664   853%  1756  458s
  1470  1135 4324.35961   18  343 -1071.6975 8071.07664   853%  1757  468s
  1566  1175 4039.69151   19  350 -1071.6975 7853.54057   833%  1753  478s
  1669  1222 3621.68664   21  362 -1071.6975 7853.54057   833%  1746  490s
H 1674  1222                    -987.2864403 7853.54057   895%  1744  490s
H 1681  1222                    -881.2782466 7853.54057   991%  1742  490s
H 1694  1222                    -687.6236968 7853.54057  1242%  1738  490s
H 1718  1222                    -553.3547008 7853.54057  1519%  1735  490s
H 1736  1222                    -524.6461961 7600.41409  1549%  1738  490s
  1744  1275 3543.77895   22  358 -524.64620 7600.41409  1549%  1738  503s
  1857  1359 3119.11118   25  301 -524.64620 7600.16062  1549%  1716  514s
  1994  1369 2416.81295   28  292 -524.64620 7023.03194  1439%  1697  523s
H 2026  1369                    -483.0378182 7023.03194  1554%  1716  523s
  2046  1432 infeasible   28      -483.03782 6952.95770  1539%  1719  536s
  2175  1455 2111.56764   26  280 -483.03782 6952.95770  1539%  1713  544s
H 2177  1455                    -439.8026179 6952.95770  1681%  1712  544s
  2216  1525 2293.20735   29  285 -439.80262 6731.15557  1630%  1717  556s
  2348  1586  570.70715   33  208 -439.80262 6731.15557  1630%  1719  569s
  2481  1627   45.57178   36  265 -439.80262 6731.15557  1630%  1720  583s
  2628  1705 -157.05884   14  216 -439.80262 6656.95435  1614%  1727  596s
  2760  1791  356.80404   12  343 -439.80262 6656.95435  1614%  1740  608s
H 2789  1791                    -391.6504492 6296.30603  1708%  1738  608s
  2873  1840 -359.78840   13  331 -391.65045 6296.30603  1708%  1738  624s
  3055  1855 1553.89274   12  378 -391.65045 6296.30603  1708%  1714  640s
  3226  1926 1004.82563   15  368 -391.65045 6296.30603  1708%  1707  657s
  3412  1995  609.54857   18  343 -391.65045 5996.43317  1631%  1698  673s
  3583  2076     cutoff   20      -391.65045 5996.43317  1631%  1706  689s
H 3744  2095                    -344.4702290 5834.87383  1794%  1717  698s
H 3772  2094                    -327.9428969 5834.87383  1879%  1722  698s
  3784  2135     cutoff   24      -327.94290 5834.87383  1879%  1725  713s
H 3793  2135                    -322.5903422 5834.87383  1909%  1724  713s
H 3794  2134                    -321.7789573 5834.87383  1913%  1725  713s
  3884  2214 1341.10200   10  286 -321.77896 5834.87383  1913%  1724  729s
  4108  2299     cutoff   13      -321.77896 5834.87383  1913%  1718  746s
  4322  2427 1916.17791    9  401 -321.77896 5779.87075  1896%  1721  764s
H 4553  2426                    -302.4585047 5779.87075  2011%  1716  820s
H 4553  2425                    -291.1940439 5779.87075  2085%  1716  824s
  4554  2426 5164.99903   13  495 -291.19404 5779.87075  2085%  1716  871s
  4556  2427 3980.73143   17  164 -291.19404 5779.87075  2085%  1715  896s
  4557  2428 3168.94184   17  361 -291.19404 5779.87075  2085%  1715  912s
  4558  2429  480.79474   27  383 -291.19404 5779.87075  2085%  1715  925s
  4559  2429 3070.73784   17  414 -291.19404 5779.87075  2085%  1714  936s
  4560  2430 2126.64083   21  471 -291.19404 5779.87075  2085%  1714  943s
  4561  2431 1134.44592   10  435 -291.19404 5779.87075  2085%  1713  951s
  4562  2431 1700.41236   21  479 -291.19404 5779.87075  2085%  1713  956s
  4563  2432 -236.46681   16  462 -291.19404 5779.87075  2085%  1713  962s
  4564  2433 1383.18268   24  464 -291.19404 5779.87075  2085%  1712  967s
  4565  2433 1063.10558   19  444 -291.19404 5779.87075  2085%  1712  973s
  4566  2434 1481.45709   20  442 -291.19404 5779.87075  2085%  1712  976s
  4567  2435  392.75069   32  458 -291.19404 5779.87075  2085%  1711  980s
  4569  2436 2579.90510   21  457 -291.19404 5779.87075  2085%  1710  985s
  4571  2437  140.40792   22  457 -291.19404 5779.87075  2085%  1710  991s
  4573  2439  194.43156   29  470 -291.19404 5779.87075  2085%  1709  998s
  4574  2439 2228.08525   24  490 -291.19404 5779.87075  2085%  1709 1005s
  4576  2441 1129.78199   33  459 -291.19404 5779.87075  2085%  1708 1011s
  4578  2442 3585.92542   25  452 -291.19404 5779.87075  2085%  1707 1019s
  4579  2443  592.95417   25  468 -291.19404 5779.87075  2085%  1707 1022s
  4580  2443 1890.58151   41  466 -291.19404 5779.87075  2085%  1706 1028s
  4581  2444 1040.21068   33  458 -291.19404 5779.87075  2085%  1706 1031s
  4582  2445  261.29173   43  462 -291.19404 5779.87075  2085%  1706 1036s
  4584  2446 4789.81806   18  482 -291.19404 5779.87075  2085%  1705 1043s
  4585  2447 1968.61843   34  484 -291.19404 5779.87075  2085%  1704 1046s
  4586  2447 3910.34594   10  467 -291.19404 5779.87075  2085%  1704 1051s
  4588  2449  669.82140   20  521 -291.19404 5779.87075  2085%  1703 1055s
  4590  2450  141.13187    9  484 -291.19404 5779.87075  2085%  1703 1086s
  4591  2451  493.13401   18  484 -291.19404 5779.87075  2085%  1702 1106s
  4592  2454 5779.87075   12  461 -291.19404 5779.87075  2085%  1743 1119s
  4594  2458 5779.87075   13  465 -291.19404 5779.87075  2085%  1744 1134s
  4598  2464 5779.87075   14  451 -291.19404 5779.87075  2085%  1748 1149s
  4606  2478 5779.87075   15  463 -291.19404 5779.87075  2085%  1755 1164s
  4622  2489 4342.90211   16  275 -291.19404 5779.87075  2085%  1789 1195s
  4639  2516 2703.60574   17  220 -291.19404 5779.87075  2085%  1808 1211s
H 4644  2390                    -283.9430189 5779.87075  2136%  1812 1211s
  4671  2490 2084.59333   18  211 -283.94302 5779.87075  2136%  1827 1229s
  4800  2483     cutoff   23      -283.94302 5779.87075  2136%  1840 1241s
  4877  2507     cutoff   22      -283.94302 5779.87075  2136%  1840 1257s
  4960  2509 5779.87075   17  479 -283.94302 5779.87075  2136%  1840 1267s
  5020  2501 5779.87075   17  463 -283.94302 5779.87075  2136%  1838 1286s
  5106  2499 5779.87075   18  458 -283.94302 5779.87075  2136%  1835 1297s
  5169  2508 5779.87075   18  453 -283.94302 5779.87075  2136%  1841 1309s
  5237  2497 4421.72275   18  518 -283.94302 5779.87075  2136%  1846 1321s
  5300  2507 3666.11427   18  439 -283.94302 5779.87075  2136%  1849 1336s
  5366  2499 5779.87075   19  377 -283.94302 5779.87075  2136%  1852 1349s
  5417  2510 3108.50644   19  459 -283.94302 5779.87075  2136%  1855 1361s
  5483  2514 5779.87075   19  495 -283.94302 5779.87075  2136%  1861 1371s
H 5528  2382                    -270.1010974 5779.87075  2240%  1867 1371s
  5537  2405 5779.87075   20  491 -270.10110 5779.87075  2240%  1867 1382s
  5607  2408 5779.87075   21  495 -270.10110 5779.87075  2240%  1873 1392s
  5662  2433 5779.87075   22  469 -270.10110 5779.87075  2240%  1875 1401s
  5736  2433 5779.87075   23  511 -270.10110 5779.87075  2240%  1876 1413s
H 5777  2308                    -267.7064295 5779.87075  2259%  1877 1413s
  5790  2329 5779.87075   24  509 -267.70643 5779.87075  2259%  1875 1426s
  5892  2314 4774.12522   26  477 -267.70643 5779.87075  2259%  1873 1437s
  5959  2320 4295.09255   25  513 -267.70643 5779.87075  2259%  1874 1450s
  6053  2300 4538.45109   27  390 -267.70643 5779.87075  2259%  1874 1464s
  6130  2307 1173.42752   28  311 -267.70643 5779.87075  2259%  1878 1477s
  6224  2307     cutoff   27      -267.70643 5779.87075  2259%  1880 1491s
  6342  2276  307.92739   33  244 -267.70643 5779.87075  2259%  1883 1505s
  6458  2285     cutoff   33      -267.70643 5344.77781  2097%  1893 1520s
  6575  2277 4120.77635   19  399 -267.70643 5062.73440  1991%  1900 1535s
  6708  2233 3174.06167   22  343 -267.70643 4841.27615  1908%  1904 1551s
  6795  2209 3041.88495   23  331 -267.70643 4841.27615  1908%  1903 1565s
  6917  2189 1951.18657   25  224 -267.70643 4794.56267  1891%  1911 1583s
  7070  2145  -46.99054   30  227 -267.70643 4646.33416  1836%  1915 1599s
  7231  2109 2490.41517   19  250 -267.70643 4186.77823  1664%  1918 1614s
  7409  2061     cutoff   25      -267.70643 4119.25273  1639%  1916 1633s
  7593  1989 -198.01945   26  201 -267.70643 4119.25273  1639%  1919 1649s
  7779  1918 1280.06946   27  160 -267.70643 3676.75596  1473%  1923 1668s
  7973  1843 1002.00814   29  108 -267.70643 3676.75596  1473%  1928 1690s
  8173  1728 1939.23360   24  206 -267.70643 3456.68872  1391%  1924 1711s
  8418  1611 2342.43416   25  264 -267.70643 3076.90327  1249%  1920 1731s
  8684  1457     cutoff   26      -267.70643 2766.63926  1133%  1913 1750s
  9014  1211 1313.05965   23  257 -267.70643 2565.84161  1058%  1893 1771s
  9356   911     cutoff   21      -267.70643 2075.31567   875%  1872 1791s
  9817   479     cutoff   21      -267.70643 1974.92712   838%  1833 1807s
 10374   223     cutoff   38      -267.70643 1312.75373   590%  1771 1821s
 10766    46  168.20549   29   51 -267.70643  440.78432   265%  1713 1825s

Cutting planes:
  Learned: 1
  Gomory: 1
  MIR: 520
  Mixing: 3
  Flow cover: 1305
  Zero half: 1
  RLT: 3
  Relax-and-lift: 101

Explored 11026 nodes (18665234 simplex iterations) in 1826.04 seconds (3320.19 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -267.706 -270.101 -283.943 ... -391.65
No other solutions better than -267.706

Optimal solution found (tolerance 1.00e-04)
Best objective -2.677064294985e+02, best bound -2.677064294985e+02, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1826.05s
  Master Objective (UB) = -267.71, θ = 134329.50
  Upper Bound (UB) = -267.71

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 134329.50
  [DEBUG]   ✓ Scenario 0: θ = 134329.50 ≤ Q = 134329.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 134329.50 ≤ Q = 134329.50 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 134329.50 ≤ Q = 134329.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 134329.50 ≤ Q = 134329.50 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 134329.50 ≤ Q = 134329.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 134329.50 ≤ Q = 134329.50 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x74437510
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x8bbc8af0
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.356660e+13
Presolve removed 2625 rows and 1918 columns
Presolve time: 0.01s
Presolved: 468 rows, 471 columns, 1319 nonzeros
Found heuristic solution: objective 6378022.0617
Variable types: 319 continuous, 152 integer (152 binary)

Root relaxation: objective -1.347843e+05, 236 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -134784.29    0  123 6378022.06 -134784.29   102%     -    0s
H    0     0                    -103292.7032 -134784.29  30.5%     -    0s
H    0     0                    -103522.6566 -134784.29  30.2%     -    0s
H    0     0                    -106839.8931 -134784.29  26.2%     -    0s
H    0     0                    -108808.3881 -120980.07  11.2%     -    0s
H    0     0                    -108991.6012 -120980.07  11.0%     -    0s
     0     0 -120980.07    0   73 -108991.60 -120980.07  11.0%     -    0s
H    0     0                    -119386.3462 -120906.24  1.27%     -    0s
     0     0 -120558.82    0   52 -119386.35 -120558.82  0.98%     -    0s
     0     0 -120174.69    0   59 -119386.35 -120174.69  0.66%     -    0s
H    0     0                    -119777.4062 -120174.69  0.33%     -    0s
     0     0 -120155.68    0   57 -119777.41 -120155.68  0.32%     -    0s
     0     0 -119926.48    0   13 -119777.41 -119926.48  0.12%     -    0s
     0     0 -119908.90    0   10 -119777.41 -119908.90  0.11%     -    0s
     0     0 -119893.99    0    9 -119777.41 -119893.99  0.10%     -    0s
     0     0 -119840.64    0   12 -119777.41 -119840.64  0.05%     -    0s
     0     0 -119839.90    0    6 -119777.41 -119839.90  0.05%     -    0s
     0     0 -119803.81    0    4 -119777.41 -119803.81  0.02%     -    0s
     0     0          -    0      -119777.41 -119788.68  0.01%     -    0s

Explored 1 nodes (618 simplex iterations) in 0.11 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -119777 -119329 -119292 ... 1.35666e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.197774061543e+05, best bound -1.197886771644e+05, gap 0.0094%
  Subproblem solved in 0.14s
  Worst-case operational profit (Z_SP) = 120387.26
  Scenario: 36 demand increases, 24 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -119777.41
  [DEBUG]   S×d_nominal = 240164.66
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 240164.66 + -119777.41 = 120387.26
  [DEBUG]   Current θ from Master = 134329.50
  [DEBUG]   ⚠️  Z_SP ≤ θ by 13942.24 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -14209.95
  Lower Bound (LB) = -6521.46
  Gap (UB-LB) = 6253.7545, Absolute Gap = 6253.7545, Relative Gap = 23.360494
  Not converged yet (gap = 6253.75 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 36 increases, 24 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308052 nonzeros
Model fingerprint: 0x394f8db4
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 52318 rows and 21238 columns
Presolve time: 1.68s
Presolved: 56095 rows, 24702 columns, 348309 nonzeros
Variable types: 22443 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -366101.7227
Found heuristic solution: objective -161037.0536

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 56095 rows, 24702 columns, 348309 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   23148   -1.2928990e+05   0.000000e+00   4.998965e+06      5s
   35726   -3.0611305e+04   0.000000e+00   3.279268e+06     10s
   44192   -5.2237403e+03   0.000000e+00   3.844775e+07     15s
   52418    4.0435703e+03   0.000000e+00   1.896517e+07     20s
   58761    5.3529546e+03   0.000000e+00   9.173418e+05     25s
   65215    6.8993355e+03   0.000000e+00   2.750342e+07     30s
Concurrent spin time: 0.02s

Solved with dual simplex

Root relaxation: objective 2.090497e+04, 43761 iterations, 31.14 seconds (41.90 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 20904.9710    0  167 -161037.05 20904.9710   113%     -   33s
H    0     0                    -157059.5669 20904.9710   113%     -   33s
H    0     0                    -113826.2542 20904.9710   118%     -   33s
H    0     0                    -71195.52156 20904.9710   129%     -   33s
H    0     0                    -70932.24918 20904.9710   129%     -   34s
H    0     0                    -24970.64827 20904.9710   184%     -   34s
H    0     0                    -24912.79228 20904.9710   184%     -   34s
H    0     0                    -20803.33543 20904.9710   200%     -   34s
H    0     0                    -20745.47943 20904.9710   201%     -   34s
H    0     0                    -14679.82185 20904.9710   242%     -   34s
H    0     0                    -11849.51963 20904.9710   276%     -   34s
H    0     0                    -8927.623590 16467.7762   284%     -   48s
H    0     0                    -7828.254074 16467.7762   310%     -   48s
H    0     0                    -7335.574201 16467.7762   324%     -   48s
     0     0 15759.0878    0  255 -7335.5742 15759.0878   315%     -   48s
     0     0 15712.7012    0  275 -7335.5742 15712.7012   314%     -   54s
     0     0 15712.7012    0  271 -7335.5742 15712.7012   314%     -   56s
     0     0 15712.7012    0  273 -7335.5742 15712.7012   314%     -   57s
     0     0 15712.7012    0  273 -7335.5742 15712.7012   314%     -   57s
     0     0 15712.7012    0  276 -7335.5742 15712.7012   314%     -   58s
     0     0 15712.7012    0  276 -7335.5742 15712.7012   314%     -   58s
     0     0 15712.7012    0  281 -7335.5742 15712.7012   314%     -   60s
     0     0 15712.7012    0  280 -7335.5742 15712.7012   314%     -   60s
     0     0 15712.7012    0  280 -7335.5742 15712.7012   314%     -   60s
     0     0 12959.7076    0  321 -7335.5742 12959.7076   277%     -   74s
     0     0 12460.4536    0  324 -7335.5742 12460.4536   270%     -   80s
     0     0 12402.8610    0  327 -7335.5742 12402.8610   269%     -   82s
     0     0 12325.6766    0  341 -7335.5742 12325.6766   268%     -   85s
     0     0 12290.0402    0  342 -7335.5742 12290.0402   268%     -   87s
     0     0 12265.4663    0  343 -7335.5742 12265.4663   267%     -   88s
     0     0 12258.6922    0  344 -7335.5742 12258.6922   267%     -   90s
     0     0 12221.9486    0  339 -7335.5742 12221.9486   267%     -   91s
     0     0 12203.2167    0  347 -7335.5742 12203.2167   266%     -   92s
     0     0 12186.2726    0  294 -7335.5742 12186.2726   266%     -   93s
     0     0 12184.2770    0  299 -7335.5742 12184.2770   266%     -   94s
     0     0 12181.9913    0  299 -7335.5742 12181.9913   266%     -   94s
     0     0 12178.5787    0  297 -7335.5742 12178.5787   266%     -   94s
     0     0 12166.1337    0  347 -7335.5742 12166.1337   266%     -   95s
     0     0 12165.1690    0  351 -7335.5742 12165.1690   266%     -   95s
     0     0 12165.1024    0  351 -7335.5742 12165.1024   266%     -   96s
     0     0 10876.5450    0  394 -7335.5742 10876.5450   248%     -  117s
     0     0 10538.1568    0  389 -7335.5742 10538.1568   244%     -  123s
     0     0 10454.0951    0  386 -7335.5742 10454.0951   243%     -  125s
     0     0 10375.3627    0  396 -7335.5742 10375.3627   241%     -  127s
     0     0 10270.4661    0  409 -7335.5742 10270.4661   240%     -  131s
     0     0 10264.4321    0  406 -7335.5742 10264.4321   240%     -  132s
     0     0 10243.1630    0  413 -7335.5742 10243.1630   240%     -  134s
     0     0 10208.8703    0  412 -7335.5742 10208.8703   239%     -  136s
     0     0 10188.3539    0  415 -7335.5742 10188.3539   239%     -  138s
     0     0 10153.8071    0  411 -7335.5742 10153.8071   238%     -  140s
     0     0 10102.2401    0  406 -7335.5742 10102.2401   238%     -  142s
     0     0 10092.0765    0  413 -7335.5742 10092.0765   238%     -  144s
     0     0 10091.0766    0  412 -7335.5742 10091.0766   238%     -  144s
     0     0 9528.15642    0  430 -7335.5742 9528.15642   230%     -  161s
     0     0 9329.49568    0  424 -7335.5742 9329.49568   227%     -  167s
     0     0 9262.75255    0  428 -7335.5742 9262.75255   226%     -  171s
     0     0 9203.23123    0  435 -7335.5742 9203.23123   225%     -  175s
     0     0 9162.70556    0  438 -7335.5742 9162.70556   225%     -  178s
     0     0 9137.67763    0  441 -7335.5742 9137.67763   225%     -  180s
     0     0 9132.12857    0  440 -7335.5742 9132.12857   224%     -  182s
     0     0 9125.68759    0  436 -7335.5742 9125.68759   224%     -  183s
     0     0 9122.76168    0  442 -7335.5742 9122.76168   224%     -  184s
     0     0 9118.41886    0  445 -7335.5742 9118.41886   224%     -  185s
     0     0 9090.99384    0  437 -7335.5742 9090.99384   224%     -  186s
     0     0 9062.08454    0  441 -7335.5742 9062.08454   224%     -  189s
     0     0 9033.27043    0  450 -7335.5742 9033.27043   223%     -  191s
     0     0 9028.15926    0  451 -7335.5742 9028.15926   223%     -  192s
     0     0 9023.88813    0  450 -7335.5742 9023.88813   223%     -  193s
     0     0 9016.27138    0  450 -7335.5742 9016.27138   223%     -  194s
     0     0 8980.67767    0  471 -7335.5742 8980.67767   222%     -  196s
     0     0 8959.87557    0  470 -7335.5742 8959.87557   222%     -  197s
     0     0 8958.01802    0  478 -7335.5742 8958.01802   222%     -  198s
     0     0 8957.62093    0  480 -7335.5742 8957.62093   222%     -  198s
     0     0 8871.09348    0  463 -7335.5742 8871.09348   221%     -  202s
     0     0 8857.24579    0  459 -7335.5742 8857.24579   221%     -  204s
     0     0 8847.53589    0  462 -7335.5742 8847.53589   221%     -  205s
     0     0 8845.33725    0  462 -7335.5742 8845.33725   221%     -  206s
     0     0 8844.63544    0  469 -7335.5742 8844.63544   221%     -  206s
     0     0 8799.88681    0  450 -7335.5742 8799.88681   220%     -  210s
H    0     0                    -4224.531367 8799.82828   308%     -  212s
H    0     0                    -3464.879082 8799.82828   354%     -  213s
H    0     0                    -3228.235409 8799.82828   373%     -  213s
H    0     0                    -2272.556730 8799.82828   487%     -  213s
H    0     0                    -2267.200086 8799.82828   488%     -  213s
H    0     0                    -1750.806865 8799.82828   603%     -  213s
     0     0 8780.59605    0  453 -1750.8069 8780.59605   602%     -  215s
     0     0 8771.36027    0  454 -1750.8069 8771.36027   601%     -  215s
     0     0 8770.13762    0  454 -1750.8069 8770.13762   601%     -  216s
     0     0 8751.66109    0  460 -1750.8069 8751.66109   600%     -  220s
     0     0 8748.28471    0  462 -1750.8069 8748.28471   600%     -  221s
     0     0 8746.61834    0  468 -1750.8069 8746.61834   600%     -  222s
     0     0 8746.09658    0  464 -1750.8069 8746.09658   600%     -  222s
     0     0 8734.80320    0  464 -1750.8069 8734.80320   599%     -  226s
H    0     0                    -1625.358895 8734.78727   637%     -  229s
H    0     0                    -1522.686460 8734.78727   674%     -  230s
H    0     0                    -1486.729861 8734.78727   688%     -  230s
     0     0 8733.38713    0  460 -1486.7299 8733.38713   687%     -  231s
     0     0 8726.16873    0  463 -1486.7299 8726.16873   687%     -  233s
     0     0 8722.93527    0  467 -1486.7299 8722.93527   687%     -  235s
     0     0 8721.79808    0  468 -1486.7299 8721.79808   687%     -  235s
     0     0 8709.39114    0  455 -1486.7299 8709.39114   686%     -  238s
     0     0 8705.28347    0  461 -1486.7299 8705.28347   686%     -  245s
     0     0 8704.71468    0  467 -1486.7299 8704.71468   685%     -  246s
     0     0 8695.71402    0  470 -1486.7299 8695.71402   685%     -  249s
     0     0 8693.38930    0  471 -1486.7299 8693.38930   685%     -  250s
     0     0 8693.15306    0  474 -1486.7299 8693.15306   685%     -  251s
     0     0 8687.85133    0  473 -1486.7299 8687.85133   684%     -  253s
     0     0 8683.78318    0  471 -1486.7299 8683.78318   684%     -  254s
     0     0 8681.72305    0  475 -1486.7299 8681.72305   684%     -  255s
     0     0 8680.99494    0  478 -1486.7299 8680.99494   684%     -  256s
     0     0 8679.32812    0  484 -1486.7299 8679.32812   684%     -  257s
     0     0 8679.27266    0  484 -1486.7299 8679.27266   684%     -  259s
     0     2 8679.17806    0  484 -1486.7299 8679.17806   684%     -  297s
     1     4 8547.09615    1  470 -1486.7299 8679.17806   684%  4893  309s
     3     8 8403.89672    2  452 -1486.7299 8546.23242   675%  7966  315s
     7    16 8336.57357    3  466 -1486.7299 8403.84553   665%  5945  328s
    15    32 8208.75359    4  475 -1486.7299 8334.51050   661%  7557  345s
    31    48 7108.01013    5  426 -1486.7299 8208.40286   652% 10119  375s
    49    78 6344.13859    6  360 -1486.7299 8208.40286   652%  9560  390s
    81   136 6276.17363    7  346 -1486.7299 8208.40286   652%  7439  407s
   139   192 5968.05573    8  345 -1486.7299 8208.40286   652%  5445  421s
H  150   192                    -1402.201498 8208.40286   685%  5318  421s
H  193   192                    -1298.259977 8208.40286   732%  4590  421s
   195   316 5298.70512    8  323 -1298.2600 8208.40286   732%  4576  433s
   323   359 5215.15903   11  329 -1298.2600 8208.40286   732%  3496  446s
   398   424 5372.42983   12  347 -1298.2600 8208.40286   732%  3307  459s
   486   473 4278.09011   12  264 -1298.2600 8208.40286   732%  3100  471s
H  489   473                    -823.2418149 8208.40286  1097%  3102  471s
   567   532 4040.74832   12  246 -823.24181 8208.40286  1097%  2924  483s
   642   562 5314.32986   13  361 -823.24181 8208.40286  1097%  2801  493s
H  644   562                    -648.2708186 8208.40286  1366%  2802  493s
H  654   562                    -458.8125502 8208.40286  1889%  2787  493s
H  672   562                    -372.1552474 8208.40286  2306%  2796  493s
   678   611 4923.89927   13  328 -372.15525 8208.40286  2306%  2785  505s
   759   655 4968.34710   15  337 -372.15525 8208.40286  2306%  2675  516s
   841   700 2553.16993   15  263 -372.15525 8208.40286  2306%  2592  529s
   914   736 1846.19262   16  317 -372.15525 8208.40286  2306%  2559  542s
   988   773 3921.18979   16  326 -372.15525 8208.40286  2306%  2546  555s
  1057   808 2853.66779   17  271 -372.15525 8208.40286  2306%  2553  570s
  1138   846 3437.92148   17  272 -372.15525 8208.40286  2306%  2524  584s
  1204   909 3124.69932   18  283 -372.15525 8208.40286  2306%  2540  598s
  1295   976 2848.73980   18  259 -372.15525 8208.40286  2306%  2511  611s
  1409  1018 2593.07791   20  297 -372.15525 8090.96970  2274%  2458  625s
  1513  1083 infeasible   19      -372.15525 8087.86520  2273%  2426  639s
  1627  1128 1862.31114   26  245 -372.15525 8087.86520  2273%  2391  654s
  1738  1195     cutoff   27      -372.15525 8087.86520  2273%  2374  671s
  1841  1274 1561.42580   28  252 -372.15525 8087.86520  2273%  2354  685s
  1962  1337 1290.71583   30  344 -372.15525 8087.86520  2273%  2323  701s
  2074  1446 1177.49722   31  295 -372.15525 8087.86520  2273%  2290  713s
  2234  1472  592.91114   36  285 -372.15525 7140.42541  2019%  2236  725s
  2285  1523  367.97569   38  291 -372.15525 7140.42541  2019%  2239  738s
  2362  1575 -155.50189   44  255 -372.15525 7140.42541  2019%  2228  756s
  2448  1659 3617.63733   10  220 -372.15525 7140.42541  2019%  2231  774s
  2590  1756 1536.90341   13  199 -372.15525 6965.92486  1972%  2208  791s
  2761  1820 1108.73521   20  182 -372.15525 6965.92486  1972%  2178  805s
  2872  1927  116.80655   33  168 -372.15525 6477.06818  1840%  2152  821s
  3047  2045 2644.67504   12  410 -372.15525 6477.06818  1840%  2120  838s
  3223  2185 2281.30075   14  458 -372.15525 6477.06818  1840%  2108  857s
  3409  2306 1101.10671   18  420 -372.15525 6477.06818  1840%  2105  882s
  3598  2456  539.48111   21  378 -372.15525 6477.06818  1840%  2095  903s
  3814  2457 2864.50560   15  484 -372.15525 6477.06818  1840%  2086  967s
  3816  2458  356.31098   35  167 -372.15525 6477.06818  1840%  2084  997s
  3817  2459 1114.24612   22  365 -372.15525 6477.06818  1840%  2084 1022s
  3818  2460  868.84131   31  361 -372.15525 6477.06818  1840%  2083 1039s
  3819  2460  985.94268   32  475 -372.15525 6477.06818  1840%  2083 1049s
  3820  2461 3020.17179   14  458 -372.15525 6477.06818  1840%  2082 1057s
  3821  2462 3132.87406   25  446 -372.15525 6477.06818  1840%  2082 1066s
  3822  2462 1416.14904   26  470 -372.15525 6477.06818  1840%  2081 1074s
  3823  2463  728.18144   39  476 -372.15525 6477.06818  1840%  2081 1081s
  3824  2464  528.95026   43  455 -372.15525 6477.06818  1840%  2080 1086s
  3825  2464  121.28643   41  455 -372.15525 6477.06818  1840%  2080 1091s
  3827  2466 3531.12413   29  470 -372.15525 6477.06818  1840%  2078 1097s
  3828  2466 5533.08635   10  480 -372.15525 6477.06818  1840%  2078 1101s
  3830  2468  481.74252   26  466 -372.15525 6477.06818  1840%  2077 1106s
  3832  2469 2686.89128   29  473 -372.15525 6477.06818  1840%  2076 1119s
  3833  2470 1657.34057   23  462 -372.15525 6477.06818  1840%  2075 1124s
  3834  2470 1712.84570   24  471 -372.15525 6477.06818  1840%  2075 1127s
  3835  2471 1633.33467   25  456 -372.15525 6477.06818  1840%  2074 1130s
  3837  2472  702.90379   37  460 -372.15525 6477.06818  1840%  2073 1135s
  3839  2474 2111.18290   36  532 -372.15525 6477.06818  1840%  2072 1151s
  3840  2474 2828.86516   20  501 -372.15525 6477.06818  1840%  2071 1158s
  3841  2475 1601.60555   18  573 -372.15525 6477.06818  1840%  2071 1162s
  3842  2476 1342.22192   40  528 -372.15525 6477.06818  1840%  2070 1165s
  3843  2476 1487.50919   19  559 -372.15525 6477.06818  1840%  2070 1173s
  3844  2477 3959.99819   24  494 -372.15525 6477.06818  1840%  2069 1176s
  3845  2478   87.11656   30  547 -372.15525 6477.06818  1840%  2069 1181s
  3846  2478 4788.83627   13  491 -372.15525 6477.06818  1840%  2068 1188s
  3847  2479 -165.98894   33  536 -372.15525 6477.06818  1840%  2068 1191s
  3848  2480 4664.71871   13  537 -372.15525 6477.06818  1840%  2067 1202s
  3849  2480 2983.45895   27  590 -372.15525 6477.06818  1840%  2067 1207s
  3850  2481  435.99533   30  577 -372.15525 6477.06818  1840%  2066 1216s
  3852  2482 4059.90839   13  607 -372.15525 6477.06818  1840%  2065 1223s
  3853  2483 2311.22179   14  577 -372.15525 6477.06818  1840%  2064 1232s
  3854  2484 1490.53988   27  553 -372.15525 6477.06818  1840%  2064 1237s
  3855  2484  437.02207   28  540 -372.15525 6477.06818  1840%  2063 1243s
  3856  2485  223.95660   24  551 -372.15525 6477.06818  1840%  2063 1248s
  3857  2486 5927.75498    9  564 -372.15525 6477.06818  1840%  2062 1256s
  3858  2486  868.84131   31  564 -372.15525 6477.06818  1840%  2062 1285s
  3859  2487 5163.59156    8  564 -372.15525 6477.06818  1840%  2061 1321s
  3860  2491 6477.06818   14  558 -372.15525 6477.06818  1840%  2127 1335s
  3862  2494 6477.06818   15  555 -372.15525 6477.06818  1840%  2129 1362s
  3866  2501 6477.06818   16  557 -372.15525 6477.06818  1840%  2133 1387s
  3874  2514 6477.06818   17  568 -372.15525 6477.06818  1840%  2145 1422s
  3890  2525 6477.06818   18  559 -372.15525 6477.06818  1840%  2189 1452s
  3906  2551 4320.75594   19  300 -372.15525 6477.06818  1840%  2222 1474s
  3938  2656 3991.19772   20  294 -372.15525 6477.06818  1840%  2246 1496s
  4076  2627 3249.71977   25  249 -372.15525 6477.06818  1840%  2253 1509s
  4115  2633 3222.88156   23  253 -372.15525 6477.06818  1840%  2254 1523s
  4164  2642 3274.15425   25  246 -372.15525 6477.06818  1840%  2252 1536s
  4206  2650 2134.77317   24  204 -372.15525 6477.06818  1840%  2258 1557s
  4263  2637 2447.96068   26  224 -372.15525 6477.06818  1840%  2261 1578s
  4327  2636 infeasible   26      -372.15525 6477.06818  1840%  2259 1593s
  4390  2633     cutoff   26      -372.15525 6477.06818  1840%  2262 1614s
  4452  2620   37.02734   29  232 -372.15525 6477.06818  1840%  2270 1631s
  4496  2620 -316.16093   30  198 -372.15525 6477.06818  1840%  2281 1647s
  4547  2629 infeasible   31      -372.15525 6477.06818  1840%  2298 1662s
  4606  2629  496.16786   32  161 -372.15525 6477.06818  1840%  2309 1677s
  4661  2620  306.67793   33  146 -372.15525 6477.06818  1840%  2318 1700s
  4717  2618  -67.36074   37  180 -372.15525 6477.06818  1840%  2328 1714s
  4776  2610 -346.17388   41  138 -372.15525 6477.06818  1840%  2342 1729s
  4843  2604     cutoff   23      -372.15525 6477.06818  1840%  2351 1744s
  4910  2597 2053.44933   27  389 -372.15525 6477.06818  1840%  2360 1760s
  4960  2602 1912.20297   28  387 -372.15525 6477.06818  1840%  2367 1776s
  5026  2594 1615.25539   31  338 -372.15525 6477.06818  1840%  2374 1793s
  5092  2607 1492.36862   32  327 -372.15525 6044.41159  1724%  2379 1810s
  5161  2611     cutoff   33      -372.15525 6044.41159  1724%  2392 1828s
  5248  2601  426.90790   34  429 -372.15525 6044.41159  1724%  2390 1848s
  5337  2601  299.33062   35  435 -372.15525 6044.41159  1724%  2402 1869s
  5418  2590   -7.23658   38  392 -372.15525 5915.97463  1690%  2411 1889s
  5513  2571     cutoff   40      -372.15525 5020.50662  1449%  2424 1909s
  5604  2576 2917.69457   27  353 -372.15525 5020.50662  1449%  2442 1930s
  5716  2549 1490.37997   29  280 -372.15525 4867.11254  1408%  2448 1949s
  5774  2540     cutoff   30      -372.15525 4867.11254  1408%  2449 1967s
  5821  2528   12.33149   31  381 -372.15525 4853.63960  1404%  2466 1986s
  5893  2517  -91.60383   32  330 -372.15525 4853.63960  1404%  2470 2008s
  5984  2505 -167.26527   33  321 -372.15525 4805.43484  1391%  2470 2032s
  6084  2472     cutoff   34      -372.15525 4361.91183  1272%  2478 2055s
  6227  2455  359.57876   24  431 -372.15525 4197.99662  1228%  2483 2076s
  6384  2417     cutoff   29      -372.15525 4197.99662  1228%  2486 2101s
  6569  2363 -254.35253   30  279 -372.15525 3897.45160  1147%  2489 2128s
  6752  2320     cutoff   31      -372.15525 3813.83822  1125%  2498 2156s
  6926  2265 1656.93953   26  320 -372.15525 3531.30675  1049%  2511 2183s
  7133  2198 -114.98391   29  214 -372.15525 3344.86152   999%  2519 2210s
  7363  2115  438.47528   22  342 -372.15525 3165.76142   951%  2511 2240s
  7586  2033 -203.42444   24  349 -372.15525 3076.16020   927%  2516 2270s
  7862  1942  659.57686   26  454 -372.15525 2709.32839   828%  2503 2302s
  8122  1810     cutoff   28      -372.15525 2577.03713   792%  2496 2331s
  8432  1657     cutoff   27      -372.15525 2282.68028   713%  2481 2361s
  8726  1492  310.81995   30  262 -372.15525 2092.38632   662%  2462 2394s
  9028  1282     cutoff   24      -372.15525 1976.83626   631%  2455 2429s
  9428   918     cutoff   33      -372.15525 1742.22743   568%  2427 2474s
  9964   520  619.68444   27  244 -372.15525 1287.16005   446%  2363 2497s
 10410   359 -356.55850   48    4 -372.15525 1171.11449   415%  2296 2503s
*10693   139              51    -345.5860840  217.75484   163%  2239 2503s
 10763    70     cutoff   37      -345.58608 -181.28644  47.5%  2225 2506s

Cutting planes:
  MIR: 639
  Mixing: 2
  Flow cover: 1563
  RLT: 33
  Relax-and-lift: 167

Explored 11026 nodes (24233392 simplex iterations) in 2508.17 seconds (4453.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -345.586 -372.155 -458.813 ... -1625.36
No other solutions better than -345.586

Optimal solution found (tolerance 1.00e-04)
Best objective -3.455860839593e+02, best bound -3.455860839593e+02, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2508.18s
  Master Objective (UB) = -345.59, θ = 134059.91
  Upper Bound (UB) = -345.59

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 134059.91
  [DEBUG]   ✓ Scenario 0: θ = 134059.91 ≤ Q = 134059.91 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 134059.91 ≤ Q = 134059.91 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 134059.91 ≤ Q = 134059.91 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 134059.91 ≤ Q = 134059.91 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 134059.91 ≤ Q = 134059.91 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 134059.91 ≤ Q = 134059.91 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 134059.91 ≤ Q = 134059.91 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0xb92e7f
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xff46d181
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [7e-13, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e-15, 2e+02]
Found heuristic solution: objective 1.364915e+13
Presolve removed 2626 rows and 1919 columns
Presolve time: 0.01s
Presolved: 467 rows, 470 columns, 1316 nonzeros
Found heuristic solution: objective 6459092.0112
Variable types: 318 continuous, 152 integer (152 binary)

Root relaxation: objective -1.401625e+05, 243 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -140162.54    0  126 6459092.01 -140162.54   102%     -    0s
H    0     0                    -106451.1946 -140162.54  31.7%     -    0s
H    0     0                    -106657.5275 -140162.54  31.4%     -    0s
H    0     0                    -111444.4908 -140162.54  25.8%     -    0s
H    0     0                    -112055.5287 -123869.24  10.5%     -    0s
     0     0 -123869.24    0   82 -112055.53 -123869.24  10.5%     -    0s
H    0     0                    -120672.4585 -123841.76  2.63%     -    0s
H    0     0                    -120762.4893 -123841.76  2.55%     -    0s
H    0     0                    -121272.9175 -123841.76  2.12%     -    0s
H    0     0                    -121362.9483 -123841.76  2.04%     -    0s
     0     0 -123294.71    0   84 -121362.95 -123294.71  1.59%     -    0s
     0     0 -122441.71    0   70 -121362.95 -122441.71  0.89%     -    0s
H    0     0                    -121488.9334 -122435.76  0.78%     -    0s
     0     0 -122328.33    0   61 -121488.93 -122328.33  0.69%     -    0s
     0     0 -122323.95    0   61 -121488.93 -122323.95  0.69%     -    0s
     0     0 -122159.64    0   48 -121488.93 -122159.64  0.55%     -    0s
     0     0 -122148.44    0   42 -121488.93 -122148.44  0.54%     -    0s
     0     0 -122085.35    0   42 -121488.93 -122085.35  0.49%     -    0s
     0     0 -122081.46    0   52 -121488.93 -122081.46  0.49%     -    0s
     0     0 -122006.21    0   57 -121488.93 -122006.21  0.43%     -    0s
     0     0 -122000.35    0   57 -121488.93 -122000.35  0.42%     -    0s
H    0     0                    -121514.8291 -122000.35  0.40%     -    0s
H    0     0                    -121542.8131 -122000.35  0.38%     -    0s
     0     0 -122000.35    0   87 -121542.81 -122000.35  0.38%     -    0s
     0     0 -122000.35    0   44 -121542.81 -122000.35  0.38%     -    0s
     0     0 -121987.02    0   47 -121542.81 -121987.02  0.37%     -    0s
     0     0 -121983.56    0   47 -121542.81 -121983.56  0.36%     -    0s
     0     0 -121928.26    0   48 -121542.81 -121928.26  0.32%     -    0s
     0     0 -121906.12    0   41 -121542.81 -121906.12  0.30%     -    0s
     0     0 -121905.60    0   41 -121542.81 -121905.60  0.30%     -    0s
     0     0 -121822.76    0   44 -121542.81 -121822.76  0.23%     -    0s
H    0     0                    -121580.0805 -121803.91  0.18%     -    0s
     0     0 -121803.91    0   44 -121580.08 -121803.91  0.18%     -    0s
     0     0 -121789.16    0   42 -121580.08 -121789.16  0.17%     -    0s
     0     0 -121783.62    0   43 -121580.08 -121783.62  0.17%     -    0s
     0     0 -121780.98    0   42 -121580.08 -121780.98  0.17%     -    0s
     0     0 -121771.42    0   42 -121580.08 -121771.42  0.16%     -    0s
     0     0 -121769.18    0   42 -121580.08 -121769.18  0.16%     -    0s
     0     0 -121769.18    0   47 -121580.08 -121769.18  0.16%     -    0s
     0     0 -121769.18    0   43 -121580.08 -121769.18  0.16%     -    0s
     0     0 -121728.67    0   29 -121580.08 -121728.67  0.12%     -    0s
     0     0 -121727.76    0   27 -121580.08 -121727.76  0.12%     -    0s
     0     0 -121665.72    0   13 -121580.08 -121665.72  0.07%     -    0s
     0     0 -121659.40    0   11 -121580.08 -121659.40  0.07%     -    0s
     0     0 -121659.19    0   10 -121580.08 -121659.19  0.07%     -    0s
     0     0 -121606.54    0    7 -121580.08 -121606.54  0.02%     -    0s
     0     0 -121598.23    0    6 -121580.08 -121598.23  0.01%     -    0s
H    0     0                    -121583.7351 -121598.23  0.01%     -    0s

Cutting planes:
  MIR: 3
  Flow cover: 3
  Relax-and-lift: 4

Warning: cleanup yields a better solution due to numeric instability

Explored 1 nodes (1447 simplex iterations) in 0.36 seconds (0.10 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -1.01082e+21 -121584 -121580 ... -111444
No other solutions better than -121594

Optimal solution found (tolerance 1.00e-04)
Best objective -1.010820591647e+21, best bound -1.010820591647e+21, gap 0.0000%
  Subproblem solved in 0.39s
  Worst-case operational profit (Z_SP) = -1010820591647493980160.00
  Scenario: 38 demand increases, 22 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -1010820591647494242304.00
  [DEBUG]   S×d_nominal = 240361.52
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 240361.52 + -1010820591647494242304.00 = -1010820591647493980160.00
  [DEBUG]   Current θ from Master = 134059.91
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1010820591647494111232.00 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -1010820591647494111232.00
  Lower Bound (LB) = -6521.46
  Gap (UB-LB) = 6175.8748, Absolute Gap = 6175.8748, Relative Gap = 17.870728
  Not converged yet (gap = 6175.87 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 38 increases, 22 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351271 nonzeros
Model fingerprint: 0xfeb1066b
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 59792 rows and 24272 columns
Presolve time: 2.15s
Presolved: 63911 rows, 27908 columns, 397279 nonzeros
Variable types: 25649 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -366101.7227
Found heuristic solution: objective -161037.0536

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 63911 rows, 27908 columns, 397279 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   22599   -1.6847909e+05   0.000000e+00   2.414595e+06      5s
   32532   -6.9997990e+04   0.000000e+00   1.279260e+07     10s
   41668   -2.3618988e+04   0.000000e+00   1.838731e+06     15s
   49998    1.0815494e+03   0.000000e+00   1.116723e+07     20s
   56794    5.5888762e+03   0.000000e+00   3.683871e+06     25s
   63007    9.6423887e+03   0.000000e+00   1.474741e+06     30s
   68595    1.2049907e+04   0.000000e+00   2.069819e+07     35s
   74728    1.6542886e+04   0.000000e+00   8.241909e+06     40s
   80754    1.8339335e+04   0.000000e+00   9.505061e+07     45s
Concurrent spin time: 2.44s

Solved with dual simplex

Root relaxation: objective 2.090358e+04, 48607 iterations, 45.61 seconds (58.12 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 20903.5815    0  168 -161037.05 20903.5815   113%     -   48s
H    0     0                    -154400.3792 20903.5815   114%     -   48s
H    0     0                    -95419.78222 20903.5815   122%     -   48s
H    0     0                    -85377.90084 20903.5815   124%     -   48s
H    0     0                    -84808.18483 20903.5815   125%     -   49s
H    0     0                    -84543.02152 20903.5815   125%     -   49s
H    0     0                    -69107.10311 20903.5815   130%     -   49s
H    0     0                    -68843.83073 20903.5815   130%     -   49s
H    0     0                    -17900.97440 20903.5815   217%     -   49s
H    0     0                    -9943.106154 20903.5815   310%     -   49s
H    0     0                    -9831.067797 16719.7123   270%     -   67s
H    0     0                    -9725.798614 16719.7123   272%     -   67s
H    0     0                    -9675.355781 16719.7123   273%     -   67s
H    0     0                    -9578.932119 16719.7123   275%     -   67s
H    0     0                    -9464.460002 16719.7123   277%     -   67s
H    0     0                    -9445.813853 16719.7123   277%     -   67s
     0     0 16292.0690    0  259 -9445.8139 16292.0690   272%     -   67s
     0     0 16292.0690    0  266 -9445.8139 16292.0690   272%     -   71s
     0     0 16292.0690    0  275 -9445.8139 16292.0690   272%     -   72s
     0     0 16292.0690    0  275 -9445.8139 16292.0690   272%     -   73s
     0     0 16292.0690    0  275 -9445.8139 16292.0690   272%     -   73s
     0     0 16292.0690    0  274 -9445.8139 16292.0690   272%     -   74s
     0     0 16292.0690    0  274 -9445.8139 16292.0690   272%     -   74s
     0     0 16292.0690    0  274 -9445.8139 16292.0690   272%     -   74s
     0     0 16292.0690    0  274 -9445.8139 16292.0690   272%     -   75s
     0     0 13581.1595    0  293 -9445.8139 13581.1595   244%     -   94s
     0     0 13150.1400    0  288 -9445.8139 13150.1400   239%     -  101s
     0     0 13025.1628    0  287 -9445.8139 13025.1628   238%     -  107s
     0     0 13002.9626    0  298 -9445.8139 13002.9626   238%     -  109s
     0     0 13001.3450    0  295 -9445.8139 13001.3450   238%     -  110s
     0     0 12959.9860    0  326 -9445.8139 12959.9860   237%     -  113s
     0     0 12889.4051    0  291 -9445.8139 12889.4051   236%     -  116s
     0     0 12872.7149    0  293 -9445.8139 12872.7149   236%     -  118s
H    0     0                    -9305.279877 12861.1488   238%     -  120s
H    0     0                    -8354.327593 12861.1488   254%     -  120s
H    0     0                    -8023.625277 12861.1488   260%     -  120s
     0     0 12861.1488    0  333 -8023.6253 12861.1488   260%     -  120s
     0     0 12859.5722    0  334 -8023.6253 12859.5722   260%     -  120s
     0     0 12857.7563    0  335 -8023.6253 12857.7563   260%     -  121s
     0     0 12857.2520    0  335 -8023.6253 12857.2520   260%     -  121s
     0     0 11181.6025    0  429 -8023.6253 11181.6025   239%     -  149s
     0     0 10876.8054    0  358 -8023.6253 10876.8054   236%     -  157s
     0     0 10723.5739    0  340 -8023.6253 10723.5739   234%     -  162s
     0     0 10637.9392    0  381 -8023.6253 10637.9392   233%     -  167s
     0     0 10539.1239    0  347 -8023.6253 10539.1239   231%     -  171s
     0     0 10487.4095    0  385 -8023.6253 10487.4095   231%     -  176s
     0     0 10457.2087    0  397 -8023.6253 10457.2087   230%     -  178s
     0     0 10435.5715    0  399 -8023.6253 10435.5715   230%     -  180s
     0     0 10414.6520    0  408 -8023.6253 10414.6520   230%     -  182s
     0     0 10377.3225    0  432 -8023.6253 10377.3225   229%     -  185s
     0     0 10370.9899    0  432 -8023.6253 10370.9899   229%     -  186s
     0     0 10369.5570    0  429 -8023.6253 10369.5570   229%     -  186s
     0     0 10368.6349    0  429 -8023.6253 10368.6349   229%     -  186s
     0     0 9762.77573    0  418 -8023.6253 9762.77573   222%     -  219s
     0     0 9527.26706    0  426 -8023.6253 9527.26706   219%     -  227s
     0     0 9473.95672    0  430 -8023.6253 9473.95672   218%     -  231s
     0     0 9463.28038    0  474 -8023.6253 9463.28038   218%     -  233s
     0     0 9451.61044    0  428 -8023.6253 9451.61044   218%     -  235s
H    0     0                    -7949.018233 9445.92802   219%     -  237s
     0     0 9445.92802    0  425 -7949.0182 9445.92802   219%     -  237s
     0     0 9436.40844    0  427 -7949.0182 9436.40844   219%     -  238s
     0     0 9426.63627    0  467 -7949.0182 9426.63627   219%     -  240s
     0     0 9403.69096    0  423 -7949.0182 9403.69096   218%     -  242s
     0     0 9390.82674    0  428 -7949.0182 9390.82674   218%     -  244s
     0     0 9380.36645    0  432 -7949.0182 9380.36645   218%     -  245s
     0     0 9377.02330    0  437 -7949.0182 9377.02330   218%     -  246s
     0     0 9374.60264    0  435 -7949.0182 9374.60264   218%     -  247s
     0     0 9373.32494    0  430 -7949.0182 9373.32494   218%     -  248s
     0     0 9299.06578    0  448 -7949.0182 9299.06578   217%     -  255s
H    0     0                    -7395.896601 9299.03190   226%     -  256s
     0     0 9232.91724    0  452 -7395.8966 9232.91724   225%     -  262s
     0     0 9169.93694    0  492 -7395.8966 9169.93694   224%     -  266s
     0     0 9163.20241    0  492 -7395.8966 9163.20241   224%     -  268s
     0     0 9155.79173    0  535 -7395.8966 9155.79173   224%     -  270s
     0     0 9151.78362    0  500 -7395.8966 9151.78362   224%     -  272s
     0     0 9147.30975    0  491 -7395.8966 9147.30975   224%     -  275s
     0     0 9140.80080    0  489 -7395.8966 9140.80080   224%     -  276s
     0     0 9135.72384    0  493 -7395.8966 9135.72384   224%     -  277s
     0     0 9117.53422    0  456 -7395.8966 9117.53422   223%     -  281s
     0     0 9104.70026    0  485 -7395.8966 9104.70026   223%     -  283s
     0     0 9097.63859    0  468 -7395.8966 9097.63859   223%     -  285s
     0     0 9094.88133    0  495 -7395.8966 9094.88133   223%     -  285s
     0     0 9092.29185    0  498 -7395.8966 9092.29185   223%     -  286s
     0     0 9091.96723    0  488 -7395.8966 9091.96723   223%     -  286s
     0     0 8990.10064    0  463 -7395.8966 8990.10064   222%     -  293s
H    0     0                    -4757.428577 8988.84773   289%     -  298s
     0     0 8981.08258    0  460 -4757.4286 8981.08258   289%     -  300s
     0     0 8973.48740    0  498 -4757.4286 8973.48740   289%     -  303s
     0     0 8972.06446    0  547 -4757.4286 8972.06446   289%     -  303s
     0     0 8962.87396    0  475 -4757.4286 8962.87396   288%     -  307s
H    0     0                    -2102.493908 8962.77908   526%     -  307s
H    0     0                    -1602.238179 8962.77908   659%     -  307s
     0     0 8937.12519    0  492 -1602.2382 8937.12519   658%     -  311s
     0     0 8932.03852    0  490 -1602.2382 8932.03852   657%     -  312s
     0     0 8931.17993    0  498 -1602.2382 8931.17993   657%     -  313s
     0     0 8919.47883    0  475 -1602.2382 8919.47883   657%     -  317s
H    0     0                    -1600.275976 8919.30904   657%     -  321s
H    0     0                    -1589.187791 8919.30904   661%     -  322s
H    0     0                    -1486.729861 8919.30904   700%     -  322s
     0     0 8915.23299    0  506 -1486.7299 8915.23299   700%     -  324s
     0     0 8913.36781    0  479 -1486.7299 8913.36781   700%     -  325s
     0     0 8912.06029    0  476 -1486.7299 8912.06029   699%     -  326s
     0     0 8906.78800    0  501 -1486.7299 8906.78800   699%     -  328s
     0     0 8904.53816    0  515 -1486.7299 8904.53816   699%     -  330s
     0     0 8903.62036    0  524 -1486.7299 8903.62036   699%     -  331s
     0     0 8897.60330    0  523 -1486.7299 8897.60330   698%     -  334s
     0     0 8892.41880    0  528 -1486.7299 8892.41880   698%     -  343s
     0     0 8891.48772    0  524 -1486.7299 8891.48772   698%     -  343s
     0     0 8887.83520    0  470 -1486.7299 8887.83520   698%     -  347s
     0     0 8887.63298    0  470 -1486.7299 8887.63298   698%     -  349s
     0     2 8887.55377    0  470 -1486.7299 8887.55377   698%     -  417s
     1     4 8770.63110    1  454 -1486.7299 8887.20842   698%  3720  432s
     3     8 8538.42333    2  447 -1486.7299 8770.57001   690%  8429  446s
     7    16 8452.56272    3  452 -1486.7299 8537.94776   674%  8473  452s
    15    32 8221.26606    4  462 -1486.7299 8452.51166   669%  6853  469s
    31    48 7768.43231    5  452 -1486.7299 8221.14018   653% 11776  499s
    47    80 7014.38451    6  402 -1486.7299 8221.14018   653% 10350  519s
    79   187 7001.72765    7  447 -1486.7299 8221.14018   653%  8251  541s
   188   295 6620.28425   10  379 -1486.7299 8221.14018   653%  4631  556s
   300   370 6249.94409    9  396 -1486.7299 8221.14018   653%  3604  569s
   379   403 6898.49833    8  434 -1486.7299 8221.14018   653%  3353  581s
   412   439 6532.25622   11  413 -1486.7299 8221.14018   653%  3305  594s
   454   460 6025.56964   10  363 -1486.7299 8221.14018   653%  3348  611s
   499   499 6228.45251   12  465 -1486.7299 8221.14018   653%  3370  621s
   563   543 6309.16075   12  379 -1486.7299 8221.14018   653%  3280  634s
   633   565 6054.24287   12  332 -1486.7299 8221.14018   653%  3178  653s
   687   600  185.74196   24  187 -1486.7299 8221.14018   653%  3200  667s
   752   634 6064.05531   13  365 -1486.7299 8221.14018   653%  3173  681s
   824   667 6166.20384   13  376 -1486.7299 8221.14018   653%  3096  694s
   893   690 5946.45135   14  370 -1486.7299 8221.14018   653%  3028  708s
   962   715 2540.71959   13  321 -1486.7299 8221.14018   653%  3006  723s
  1025   750 5853.91948   15  299 -1486.7299 8221.14018   653%  3001  737s
  1080   817 5831.82968   16  299 -1486.7299 8221.14018   653%  2987  752s
  1169   907 5591.66712   17  296 -1486.7299 8221.14018   653%  2915  767s
  1280   990 5076.00336   18  258 -1486.7299 8221.14018   653%  2826  780s
  1399  1046 -341.07434   25  147 -1486.7299 8221.14018   653%  2748  797s
  1515  1094 5036.02598   19  269 -1486.7299 8221.14018   653%  2679  814s
  1627  1130 4794.35430   21  261 -1486.7299 8221.14018   653%  2654  834s
  1721  1209 1391.47220   19  199 -1486.7299 8221.14018   653%  2654  854s
  1820  1287 4405.99694   22  304 -1486.7299 8221.14018   653%  2650  872s
  1934  1363 4163.37007   22  244 -1486.7299 8221.14018   653%  2649  891s
  2064  1440 3589.25434   23  234 -1486.7299 8221.14018   653%  2614  908s
  2185  1508 2881.96587   25  236 -1486.7299 8221.14018   653%  2612  929s
  2324  1535 2553.97256   23  222 -1486.7299 8221.14018   653%  2598  945s
  2359  1568 2145.23833   26  291 -1486.7299 8221.14018   653%  2622  964s
  2402  1609 infeasible   26      -1486.7299 8221.14018   653%  2650  981s
  2481  1655 1772.29496   28  301 -1486.7299 8221.14018   653%  2635 1002s
  2549  1706 1572.07540   28  232 -1486.7299 8221.14018   653%  2636 1021s
  2624  1733 1750.11018   29  229 -1486.7299 7822.70997   626%  2634 1044s
  2691  1773 1306.92226   30  220 -1486.7299 7822.24613   626%  2626 1065s
  2775  1849 1522.86645   29  284 -1486.7299 7822.24613   626%  2633 1088s
  2899  1947 1265.47568   30  215 -1486.7299 7822.24613   626%  2645 1112s
  3071  1973  219.08832   38  179 -1486.7299 7822.24613   626%  2624 1134s
  3109  2004  468.89252   36  186 -1486.7299 7206.61900   585%  2636 1155s
  3153  2048  179.87899   37  193 -1486.7299 7206.61900   585%  2648 1176s
  3213  2127  179.48892   37  199 -1486.7299 7206.61900   585%  2658 1197s
  3331  2256  279.77879   41  160 -1486.7299 6996.63676   571%  2634 1223s
  3500  2384 infeasible   45      -1486.7299 6996.63676   571%  2610 1249s
  3732  2451 -1230.2142   60  186 -1486.7299 6646.05451   547%  2576 1279s
  3968  2536 3305.93273    7  262 -1486.7299 6623.62200   546%  2559 1312s
  4141  2630 -374.47311   10  156 -1486.7299 6623.62200   546%  2596 1350s
  4333  2750     cutoff   39      -1486.7299 6492.12676   537%  2612 1383s
H 4580  2410                    -715.3367796 6400.79632   995%  2614 1399s
H 4580  2390                    -688.8057593 6400.79632  1029%  2614 1399s
H 4580  2338                    -605.5460167 6400.79632  1157%  2614 1402s
  4581  2316 4450.62196   10  470 -605.54602 6400.79632  1157%  2613 1464s
  4583  2317 4270.81318   18  168 -605.54602 6400.79632  1157%  2612 1499s
H 4583  2201                    -605.1987498 6400.79632  1158%  2612 1533s
H 4583  2090                    -585.3408764 6400.79632  1194%  2612 1533s
H 4583  1986                    -527.2240216 6400.79632  1314%  2612 1533s
H 4583  1887                    -506.6132386 6400.79632  1363%  2612 1533s
H 4584  1793                    -502.7353668 6400.79632  1373%  2612 1556s
  4586  1794 1303.70372   26  407 -502.73537 6400.79632  1373%  2611 1569s
  4587  1795 -111.88991   40  455 -502.73537 6400.79632  1373%  2610 1580s
  4588  1796 6147.55673    7  478 -502.73537 6400.79632  1373%  2609 1589s
  4589  1796  516.01871   23  505 -502.73537 6400.79632  1373%  2609 1599s
  4590  1797  564.04532   18  469 -502.73537 6400.79632  1373%  2608 1610s
  4591  1798 6002.05114   15  501 -502.73537 6400.79632  1373%  2608 1618s
  4592  1798  753.37182   15  501 -502.73537 6400.79632  1373%  2607 1625s
  4593  1799 6155.56702   12  498 -502.73537 6400.79632  1373%  2607 1632s
  4594  1800  936.91379   19  544 -502.73537 6400.79632  1373%  2606 1636s
  4596  1801  118.49257   36  409 -502.73537 6400.79632  1373%  2605 1643s
  4597  1802 -490.01838   25  460 -502.73537 6400.79632  1373%  2604 1648s
  4598  1802 4495.97604   10  503 -502.73537 6400.79632  1373%  2604 1652s
  4599  1803 3778.14643   12  470 -502.73537 6400.79632  1373%  2603 1656s
  4600  1804 4297.32204   13  512 -502.73537 6400.79632  1373%  2603 1674s
  4601  1804 6400.79632   13  499 -502.73537 6400.79632  1373%  2602 1680s
  4602  1805 -481.91341   31  454 -502.73537 6400.79632  1373%  2601 1686s
  4603  1806 5740.55514   11  482 -502.73537 6400.79632  1373%  2601 1690s
  4605  1807 3940.75353   12  508 -502.73537 6400.79632  1373%  2600 1698s
  4606  1808 3604.22417   17  463 -502.73537 6400.79632  1373%  2599 1711s
  4607  1808 3863.49993   20  478 -502.73537 6400.79632  1373%  2599 1717s
  4608  1809  559.41657   18  469 -502.73537 6400.79632  1373%  2598 1723s
  4609  1810  361.77980   23  516 -502.73537 6400.79632  1373%  2597 1737s
  4610  1810 2292.48208   15  526 -502.73537 6400.79632  1373%  2597 1743s
  4611  1811 -476.27105   34  531 -502.73537 6400.79632  1373%  2596 1748s
  4612  1812 -167.00168   31  489 -502.73537 6400.79632  1373%  2596 1759s
  4613  1812 5149.30844   25  490 -502.73537 6400.79632  1373%  2595 1762s
  4614  1813 2184.02486   17  494 -502.73537 6400.79632  1373%  2595 1767s
  4615  1814 -501.38610   30  497 -502.73537 6400.79632  1373%  2594 1777s
  4616  1814 4961.08275   12  489 -502.73537 6400.79632  1373%  2594 1782s
  4617  1815 5312.55267   10  483 -502.73537 6400.79632  1373%  2593 1793s
  4618  1816 5364.87066   22  538 -502.73537 6400.79632  1373%  2592 1800s
  4619  1816 3695.25031   11  503 -502.73537 6400.79632  1373%  2592 1808s
  4620  1817  214.19092   18  497 -502.73537 6400.79632  1373%  2591 1813s
  4621  1818 2079.99906   23  518 -502.73537 6400.79632  1373%  2591 1821s
  4622  1818  -69.62345   20  495 -502.73537 6400.79632  1373%  2590 1825s
  4623  1819  -87.42749   15  508 -502.73537 6400.79632  1373%  2590 1831s
  4624  1820 3378.35738   10  508 -502.73537 6400.79632  1373%  2589 1870s
  4625  1820 3568.17075   18  508 -502.73537 6400.79632  1373%  2589 1921s
  4626  1823 6400.79632   13  524 -502.73537 6400.79632  1373%  2648 1948s
  4627  1826 6400.79632   14  471 -502.73537 6400.79632  1373%  2650 1968s
  4630  1831 6400.79632   15  497 -502.73537 6400.79632  1373%  2652 1981s
  4636  1841 6400.79632   16  507 -502.73537 6400.79632  1373%  2657 2012s
  4648  1849 6400.79632   16  446 -502.73537 6400.79632  1373%  2677 2060s
  4660  1877 6248.15531   17  439 -502.73537 6400.79632  1373%  2699 2126s
  4692  1929 5634.56892   18  445 -502.73537 6400.79632  1373%  2776 2164s
  4766  1938 3655.98626   19  227 -502.73537 6400.79632  1373%  2914 2189s
H 4793  1837                    -497.9585394 6400.79632  1385%  2931 2189s
  4801  1877 5346.73684   20  464 -497.95854 6400.79632  1385%  2936 2221s
  4878  1892 3528.40378   23  216 -497.95854 6400.79632  1385%  2972 2253s
  4950  1903 4697.90001   23  416 -497.95854 6400.79632  1385%  3003 2280s
  5031  1899  552.14671   24  237 -497.95854 6400.79632  1385%  3026 2301s
  5081  1914 -174.63131   25  226 -497.95854 6400.79632  1385%  3037 2335s
H 5136  1809                    -441.6367338 6400.79632  1549%  3038 2335s
  5155  1819 2186.17323   26  230 -441.63673 6400.79632  1549%  3042 2357s
  5228  1830 infeasible   27      -441.63673 6400.79632  1549%  3051 2389s
  5301  1835 3033.47069   26  255 -441.63673 6400.79632  1549%  3059 2411s
  5371  1844     cutoff   29      -441.63673 6351.86447  1538%  3077 2432s
  5434  1843 4958.34623   19  474 -441.63673 6351.86447  1538%  3096 2450s
  5478  1859 4777.71333   20  455 -441.63673 6351.86447  1538%  3100 2470s
  5529  1861 3601.85129   22  440 -441.63673 6351.86447  1538%  3104 2489s
  5600  1853 3109.03864   23  399 -441.63673 6351.86447  1538%  3101 2509s
  5669  1844 2630.45312   25  409 -441.63673 6351.86447  1538%  3107 2530s
H 5697  1752                    -441.3313132 6351.86447  1539%  3108 2530s
  5743  1763 1285.36178   27  377 -441.33131 6351.86447  1539%  3115 2554s
  5830  1754     cutoff   30      -441.33131 6351.86447  1539%  3129 2578s
H 5837  1673                    -427.3140358 6351.86447  1586%  3130 2578s
  5905  1700     cutoff   30      -427.31404 6351.86447  1586%  3135 2601s
  6013  1687 -271.34616   30  168 -427.31404 6351.86447  1586%  3134 2626s
H 6025  1608                    -402.4225880 6351.86447  1678%  3135 2626s
  6129  1622 4400.57131   24  405 -402.42259 6351.86447  1678%  3137 2652s
  6241  1624 3735.67651   26  419 -402.42259 5253.59100  1405%  3139 2684s
  6353  1599 3257.22801   28  371 -402.42259 4980.31734  1338%  3141 2716s
  6472  1588 1750.73238   30  381 -402.42259 4980.31734  1338%  3150 2742s
H 6476  1515                    -372.1552474 4956.40170  1432%  3150 2742s
  6561  1528 1049.45643   31  367 -372.15525 4918.45389  1422%  3154 2777s
  6666  1522 infeasible   36      -372.15525 4918.45389  1422%  3174 2810s
  6772  1506  895.84647   24  147 -372.15525 4910.82637  1420%  3196 2844s
  6893  1484 2752.65706   25  266 -372.15525 4580.88833  1331%  3219 2879s
  7000  1474   14.09239   30   81 -372.15525 4543.04753  1321%  3244 2915s
  7138  1443 1068.68350   23  447 -372.15525 4543.04753  1321%  3260 2946s
  7185  1489 1066.95148   24  453 -372.15525 4543.04753  1321%  3272 2980s
  7294  1482  -75.53787   26  373 -372.15525 4320.42120  1261%  3278 3016s
  7425  1465 infeasible   26      -372.15525 4248.65904  1242%  3299 3053s
  7586  1422  890.20579   23  244 -372.15525 4237.98687  1239%  3317 3091s
  7730  1401 infeasible   32      -372.15525 4237.98687  1239%  3345 3135s
  7886  1344  615.07256   22  158 -372.15525 4136.39528  1211%  3371 3188s
  8052  1329  121.92318   22  376 -372.15525 3897.55508  1147%  3397 3233s
  8227  1285 2044.31012   27  348 -372.15525 3875.27762  1141%  3418 3284s
  8415  1260  -36.68769   27  277 -372.15525 3742.07248  1106%  3442 3336s
  8613  1222 1098.00625   25  283 -372.15525 3575.18150  1061%  3462 3379s
  8791  1268  442.96811   29  303 -372.15525 3498.99274  1040%  3471 3426s
  8995  1312 infeasible   28      -372.15525 3346.77110   999%  3493 3482s
  9240  1351 -162.83545   27  242 -372.15525 3346.77110   999%  3501 3535s
  9509  1375 infeasible   27      -372.15525 3179.69728   954%  3509 3594s
  9755  1381  -99.37705   36  340 -372.15525 3092.94022   931%  3532 3600s

Cutting planes:
  Learned: 1
  MIR: 733
  Mixing: 1
  Flow cover: 2005
  RLT: 22
  Relax-and-lift: 156

Explored 9783 nodes (34774737 simplex iterations) in 3600.04 seconds (6327.44 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -372.155 -402.423 -427.314 ... -585.341

Time limit reached
Best objective -3.721552474164e+02, best bound 3.092940218123e+03, gap 931.0887%
  WARNING: Time limit reached. Using best solution found (gap: 931.09%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.05s
  Master Objective (UB) = -372.16, θ = 134681.49
  Upper Bound (UB) = -372.16

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 134681.49
  [DEBUG]   ✓ Scenario 0: θ = 134681.49 ≤ Q = 134681.49 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 134681.49 ≤ Q = 134681.49 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 134681.49 ≤ Q = 134681.49 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 134681.49 ≤ Q = 134681.49 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 134681.49 ≤ Q = 134681.49 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 134681.49 ≤ Q = 134681.49 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 134681.49 ≤ Q = 134681.49 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 134681.49 ≤ Q = 134681.49 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x2757f9ab
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xd8a80655
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.368779e+13
Presolve removed 2625 rows and 1918 columns
Presolve time: 0.01s
Presolved: 468 rows, 471 columns, 1319 nonzeros
Found heuristic solution: objective 6447834.9194
Variable types: 319 continuous, 152 integer (152 binary)

Root relaxation: objective -1.357748e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -135774.75    0  129 6447834.92 -135774.75   102%     -    0s
H    0     0                    -100705.7077 -135774.75  34.8%     -    0s
H    0     0                    -101485.9612 -135774.75  33.8%     -    0s
H    0     0                    -110078.6694 -135774.75  23.3%     -    0s
     0     0 -122901.28    0   83 -110078.67 -122901.28  11.6%     -    0s
H    0     0                    -120169.6373 -122780.46  2.17%     -    0s
     0     0 -122184.05    0   84 -120169.64 -122184.05  1.68%     -    0s
     0     0 -122166.10    0   84 -120169.64 -122166.10  1.66%     -    0s
     0     0 -121634.76    0   63 -120169.64 -121634.76  1.22%     -    0s
H    0     0                    -120657.2675 -121581.42  0.77%     -    0s
     0     0 -121352.67    0   55 -120657.27 -121352.67  0.58%     -    0s
     0     0 -121343.76    0   55 -120657.27 -121343.76  0.57%     -    0s
     0     0 -120942.95    0   23 -120657.27 -120942.95  0.24%     -    0s
     0     0 -120927.42    0   17 -120657.27 -120927.42  0.22%     -    0s
H    0     0                    -120673.6336 -120922.62  0.21%     -    0s
     0     0 -120847.39    0   21 -120673.63 -120847.39  0.14%     -    0s
     0     0 -120839.42    0   20 -120673.63 -120839.42  0.14%     -    0s
     0     0 -120836.51    0   21 -120673.63 -120836.51  0.13%     -    0s
     0     0 -120737.84    0    9 -120673.63 -120737.84  0.05%     -    0s
     0     0 -120733.31    0    8 -120673.63 -120733.31  0.05%     -    0s
H    0     0                    -120700.8067 -120733.31  0.03%     -    0s

Cutting planes:
  Gomory: 2
  Implied bound: 2
  MIR: 1
  Flow cover: 4
  Relax-and-lift: 3

Explored 1 nodes (712 simplex iterations) in 0.14 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -120701 -120674 -120657 ... 1.36878e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.207008067183e+05, best bound -1.207081432043e+05, gap 0.0061%
  Subproblem solved in 0.18s
  Worst-case operational profit (Z_SP) = 119990.24
  Scenario: 40 demand increases, 20 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -120700.81
  [DEBUG]   S×d_nominal = 240691.05
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 240691.05 + -120700.81 = 119990.24
  [DEBUG]   Current θ from Master = 134681.49
  [DEBUG]   ⚠️  Z_SP ≤ θ by 14691.24 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -15063.40
  Lower Bound (LB) = -6521.46
  Gap (UB-LB) = 6149.3056, Absolute Gap = 6149.3056, Relative Gap = 16.523496
  Not converged yet (gap = 6149.31 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 40 increases, 20 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394490 nonzeros
Model fingerprint: 0xe44f809f
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 67266 rows and 27306 columns
Presolve time: 2.77s
Presolved: 71727 rows, 31114 columns, 446249 nonzeros
Variable types: 28855 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -366101.7227
Found heuristic solution: objective -161037.0536

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 71727 rows, 31114 columns, 446249 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   27053   -2.1216392e+05   0.000000e+00   3.457890e+07      5s
   42248   -5.1468551e+04   0.000000e+00   1.400163e+07     10s
   55021   -1.9547603e+04   0.000000e+00   1.264212e+07     15s
   64495    2.0869280e+03   0.000000e+00   1.327291e+07     20s
   71745    9.4197848e+03   0.000000e+00   3.044964e+06     25s
   77566    1.1453792e+04   0.000000e+00   1.125311e+07     30s
   84431    1.6156154e+04   0.000000e+00   4.909049e+06     35s
   90905    1.7587555e+04   0.000000e+00   3.093442e+06     40s
   96659    1.8198436e+04   0.000000e+00   3.533337e+05     45s
  101327    1.8558008e+04   0.000000e+00   1.522409e+06     50s
  106466    1.8951687e+04   0.000000e+00   3.687980e+05     55s
Concurrent spin time: 6.54s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 2.090358e+04, 77079 iterations, 58.74 seconds (80.02 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 20903.5815    0  168 -161037.05 20903.5815   113%     -   62s
H    0     0                    -144550.3093 20903.5815   114%     -   62s
H    0     0                    -118982.7081 20903.5815   118%     -   62s
H    0     0                    -105364.3339 20903.5815   120%     -   62s
H    0     0                    -104639.6382 20903.5815   120%     -   63s
H    0     0                    -104520.4141 20903.5815   120%     -   63s
H    0     0                    -69107.10311 20903.5815   130%     -   63s
H    0     0                    -68843.83073 20903.5815   130%     -   63s
H    0     0                    -33037.23624 20903.5815   163%     -   63s
H    0     0                    -15596.92748 20903.5815   234%     -   63s
H    0     0                    -10325.16180 20903.5815   302%     -   63s
H    0     0                    -10190.09439 20903.5815   305%     -   63s
H    0     0                    -9943.106154 20903.5815   310%     -   63s
H    0     0                    -9887.780235 16082.7985   263%     -   81s
H    0     0                    -9640.779509 16082.7985   267%     -   81s
H    0     0                    -9561.916265 16082.7985   268%     -   81s
H    0     0                    -9437.591554 16082.7985   270%     -   81s
     0     0 16082.7985    0  275 -9437.5916 16082.7985   270%     -   81s
H    0     0                    -7645.161467 16080.6509   310%     -   82s
H    0     0                    -7213.405077 16080.6509   323%     -   82s
     0     0 15730.4961    0  270 -7213.4051 15730.4961   318%     -   88s
     0     0 15730.4961    0  272 -7213.4051 15730.4961   318%     -   90s
     0     0 15730.4961    0  274 -7213.4051 15730.4961   318%     -   91s
     0     0 15730.4961    0  274 -7213.4051 15730.4961   318%     -   91s
     0     0 13056.9261    0  279 -7213.4051 13056.9261   281%     -  109s
     0     0 12367.3376    0  329 -7213.4051 12367.3376   271%     -  123s
     0     0 12255.7485    0  287 -7213.4051 12255.7485   270%     -  129s
     0     0 12215.1573    0  297 -7213.4051 12215.1573   269%     -  133s
     0     0 12185.3311    0  304 -7213.4051 12185.3311   269%     -  135s
     0     0 12147.2132    0  301 -7213.4051 12147.2132   268%     -  138s
     0     0 12042.9551    0  336 -7213.4051 12042.9551   267%     -  142s
     0     0 12029.2103    0  341 -7213.4051 12029.2103   267%     -  143s
     0     0 12023.6035    0  346 -7213.4051 12023.6035   267%     -  144s
     0     0 12000.9298    0  349 -7213.4051 12000.9298   266%     -  146s
     0     0 11997.6441    0  351 -7213.4051 11997.6441   266%     -  147s
     0     0 11994.6354    0  307 -7213.4051 11994.6354   266%     -  147s
     0     0 11992.9787    0  347 -7213.4051 11992.9787   266%     -  148s
     0     0 11965.7854    0  304 -7213.4051 11965.7854   266%     -  150s
     0     0 11964.0940    0  349 -7213.4051 11964.0940   266%     -  150s
     0     0 11962.5666    0  358 -7213.4051 11962.5666   266%     -  151s
     0     0 11962.4431    0  356 -7213.4051 11962.4431   266%     -  151s
     0     0 10918.0628    0  346 -7213.4051 10918.0628   251%     -  178s
     0     0 10560.4596    0  379 -7213.4051 10560.4596   246%     -  187s
     0     0 10438.1856    0  385 -7213.4051 10438.1856   245%     -  196s
     0     0 10361.4842    0  342 -7213.4051 10361.4842   244%     -  202s
     0     0 10180.8283    0  392 -7213.4051 10180.8283   241%     -  212s
     0     0 10148.6215    0  389 -7213.4051 10148.6215   241%     -  215s
     0     0 10071.3561    0  385 -7213.4051 10071.3561   240%     -  219s
     0     0 10049.7377    0  396 -7213.4051 10049.7377   239%     -  223s
     0     0 10045.9549    0  401 -7213.4051 10045.9549   239%     -  224s
     0     0 9971.78911    0  394 -7213.4051 9971.78911   238%     -  229s
     0     0 9962.27081    0  395 -7213.4051 9962.27081   238%     -  231s
     0     0 9960.25357    0  398 -7213.4051 9960.25357   238%     -  232s
     0     0 9930.03915    0  406 -7213.4051 9930.03915   238%     -  235s
H    0     0                    -3725.421192 9922.12561   366%     -  237s
     0     0 9922.12561    0  404 -3725.4212 9922.12561   366%     -  237s
     0     0 9918.64185    0  405 -3725.4212 9918.64185   366%     -  239s
     0     0 9913.54663    0  407 -3725.4212 9913.54663   366%     -  240s
     0     0 9912.84389    0  409 -3725.4212 9912.84389   366%     -  240s
H    0     0                    -3337.336547 9912.84389   397%     -  246s
H    0     0                    -3054.694889 9456.80150   410%     -  256s
     0     0 9456.80150    0  428 -3054.6949 9456.80150   410%     -  256s
     0     0 9163.50443    0  450 -3054.6949 9163.50443   400%     -  265s
     0     0 9050.34203    0  447 -3054.6949 9050.34203   396%     -  271s
     0     0 9021.65304    0  448 -3054.6949 9021.65304   395%     -  273s
     0     0 9015.99427    0  446 -3054.6949 9015.99427   395%     -  275s
     0     0 9005.41622    0  440 -3054.6949 9005.41622   395%     -  277s
     0     0 9001.91745    0  457 -3054.6949 9001.91745   395%     -  279s
     0     0 8997.73102    0  451 -3054.6949 8997.73102   395%     -  281s
     0     0 8930.56297    0  436 -3054.6949 8930.56297   392%     -  286s
     0     0 8920.08202    0  440 -3054.6949 8920.08202   392%     -  287s
     0     0 8917.70196    0  442 -3054.6949 8917.70196   392%     -  289s
     0     0 8914.32198    0  442 -3054.6949 8914.32198   392%     -  290s
     0     0 8912.16875    0  436 -3054.6949 8912.16875   392%     -  291s
     0     0 8909.43383    0  439 -3054.6949 8909.43383   392%     -  292s
     0     0 8907.93938    0  442 -3054.6949 8907.93938   392%     -  293s
     0     0 8907.77095    0  441 -3054.6949 8907.77095   392%     -  293s
     0     0 8835.73929    0  440 -3054.6949 8835.73929   389%     -  300s
H    0     0                    -2032.758561 8835.38543   535%     -  300s
     0     0 8815.09137    0  432 -2032.7586 8815.09137   534%     -  303s
     0     0 8805.61918    0  444 -2032.7586 8805.61918   533%     -  306s
     0     0 8798.76068    0  445 -2032.7586 8798.76068   533%     -  308s
     0     0 8797.37525    0  449 -2032.7586 8797.37525   533%     -  309s
     0     0 8709.30682    0  441 -2032.7586 8709.30682   528%     -  317s
H    0     0                    -1519.489344 8708.95158   673%     -  322s
H    0     0                    -1486.729861 8708.95158   686%     -  322s
     0     0 8696.75681    0  473 -1486.7299 8696.75681   685%     -  325s
     0     0 8690.14588    0  467 -1486.7299 8690.14588   685%     -  327s
     0     0 8683.10363    0  469 -1486.7299 8683.10363   684%     -  328s
     0     0 8679.66376    0  468 -1486.7299 8679.66376   684%     -  330s
     0     0 8676.27299    0  475 -1486.7299 8676.27299   684%     -  331s
     0     0 8675.70874    0  472 -1486.7299 8675.70874   684%     -  331s
     0     0 8648.85283    0  449 -1486.7299 8648.85283   682%     -  335s
     0     0 8646.09969    0  448 -1486.7299 8646.09969   682%     -  336s
     0     0 8644.88627    0  454 -1486.7299 8644.88627   681%     -  337s
     0     0 8630.75614    0  445 -1486.7299 8630.75614   681%     -  340s
     0     0 8629.28750    0  451 -1486.7299 8629.28750   680%     -  349s
     0     0 8626.60837    0  456 -1486.7299 8626.60837   680%     -  351s
     0     0 8624.92922    0  458 -1486.7299 8624.92922   680%     -  352s
     0     0 8624.27826    0  460 -1486.7299 8624.27826   680%     -  353s
     0     0 8622.32022    0  463 -1486.7299 8622.32022   680%     -  356s
     0     0 8620.80483    0  465 -1486.7299 8620.80483   680%     -  359s
     0     0 8620.21713    0  465 -1486.7299 8620.21713   680%     -  360s
     0     0 8618.77781    0  467 -1486.7299 8618.77781   680%     -  362s
     0     0 8618.66186    0  467 -1486.7299 8618.66186   680%     -  364s
     0     2 8618.66186    0  467 -1486.7299 8618.66186   680%     -  422s
     1     4 8591.90507    1  457 -1486.7299 8618.27987   680%  3425  434s
     3     7 7287.34902    2  416 -1486.7299 8589.23175   678%  8191  444s
     6    14 7357.77570    3  416 -1486.7299 8589.14092   678%  8731  455s
    13    28 6202.74206    4  402 -1486.7299 8330.49515   660%  9058  472s
    27    43 2800.77853    5  197 -1486.7299 8175.54993   650% 12178  501s
    42    75 7129.20627    5  418 -1486.7299 8174.87016   650% 11472  547s
    74   174 7026.95883    6  415 -1486.7299 8005.98762   638% 10362  569s
   182   246 5398.50502    8  393 -1486.7299 8005.98762   638%  6791  585s
   277   307 4739.70319    9  379 -1486.7299 8005.98762   638%  5779  600s
   370   366 4264.21819   11  387 -1486.7299 8005.98762   638%  5061  612s
   451   385 4180.37119   13  391 -1486.7299 8005.98762   638%  4639  624s
   532   403     cutoff   22      -1486.7299 8005.98762   638%  4264  637s
   590   438 2697.64843   15  370 -1486.7299 8005.98762   638%  4259  650s
   647   459 1328.39680   16  396 -1486.7299 8005.98762   638%  4395  662s
   695   478 1232.62545   17  374 -1486.7299 8005.98762   638%  4433  673s
   744   494  518.83221   18  361 -1486.7299 8005.98762   638%  4524  686s
   796   533  361.99972   19  345 -1486.7299 8005.98762   638%  4614  699s
   857   558 -114.03499   21  355 -1486.7299 8005.98762   638%  4625  709s
   890   600 -421.08085   22  280 -1486.7299 7686.40070   617%  4701  723s
   944   636 -624.88393   23  276 -1486.7299 7686.40070   617%  4751  737s
   990   661 -640.01720   24  220 -1486.7299 7407.87646   598%  4770  751s
  1055   695 -937.46033   25  213 -1486.7299 7407.87646   598%  4708  766s
  1119   740 -1312.0992   26  213 -1486.7299 7407.87646   598%  4667  780s
  1203   744 infeasible   27      -1486.7299 7407.87646   598%  4609  796s
  1283   766 3158.59530   12  345 -1486.7299 7407.87646   598%  4547  812s
  1339   789 2875.26140   13  288 -1486.7299 7407.87646   598%  4609  826s
  1386   830 -1360.9650   16  190 -1486.7299 7407.87646   598%  4689  842s
  1457   868     cutoff   17      -1486.7299 7407.87646   598%  4757  859s
  1551   898 2635.08942    9  389 -1486.7299 7407.87646   598%  4750  874s
  1655   946 1594.08830   10  373 -1486.7299 7407.87646   598%  4742  891s
  1751   983 1054.29231   11  371 -1486.7299 7407.87646   598%  4739  910s
  1866  1000  671.06116   12  280 -1486.7299 6754.20623   554%  4687  931s
  1953  1048  157.58029   13  265 -1486.7299 6754.20623   554%  4644  949s
  2063  1078 -1331.7090   16  279 -1486.7299 6754.20623   554%  4644  968s
  2153  1162     cutoff   17      -1486.7299 6754.20623   554%  4646  987s
  2288  1259  743.49321    9  266 -1486.7299 6754.20623   554%  4615 1006s
  2427  1317     cutoff   12      -1486.7299 6754.20623   554%  4564 1026s
  2607  1363 -794.18745   12  370 -1486.7299 6153.61299   514%  4484 1048s
  2711  1444 -1433.8441   14  280 -1486.7299 6153.61299   514%  4525 1070s
  2872  1507 -1411.7692   15  203 -1486.7299 6153.61299   514%  4513 1093s
  3054  1585  743.06515   10  307 -1486.7299 6153.61299   514%  4482 1119s
  3248  1639 -594.21489   15  238 -1486.7299 6153.61299   514%  4457 1145s
  3408  1693 -855.94254   16  224 -1486.7299 5880.35259   496%  4431 1171s
  3568  1765  348.83669    8  298 -1486.7299 5787.39757   489%  4432 1195s
  3740  1865     cutoff   13      -1486.7299 5722.05704   485%  4468 1223s
  3998  1929     cutoff   13      -1486.7299 5722.05704   485%  4408 1253s
  4237  1940     cutoff   59      -1486.7299 5393.01272   463%  4383 1273s
  4288  1967 -1084.8577   10  292 -1486.7299 5358.76682   460%  4398 1302s
  4332  1984 -1049.5062   54   98 -1486.7299 5335.21422   459%  4401 1329s
  4421  2041 3096.05163   18  212 -1486.7299 5335.21422   459%  4400 1354s
  4544  2137 1847.96059   20  229 -1486.7299 5335.21422   459%  4370 1383s
  4777  2275 -652.89508   23  135 -1486.7299 5335.21422   459%  4324 1415s
  5096  2276 -842.50687   17  467 -1486.7299 5253.89010   453%  4271 1496s
  5098  2277 -1105.4075   14  168 -1486.7299 5253.89010   453%  4270 1533s
  5099  2278 2109.42168   15  291 -1486.7299 5253.89010   453%  4269 1570s
  5100  2279 3595.98041    9  336 -1486.7299 5253.89010   453%  4268 1597s
  5101  2279 2354.34876   13  450 -1486.7299 5253.89010   453%  4267 1616s
  5102  2280  171.91106   26  441 -1486.7299 5253.89010   453%  4266 1630s
  5103  2281 -1023.3241   27  472 -1486.7299 5253.89010   453%  4266 1646s
  5104  2281  285.73103   14  451 -1486.7299 5253.89010   453%  4265 1655s
  5105  2282 3242.56900    7  444 -1486.7299 5253.89010   453%  4264 1661s
  5106  2283  -40.18847   24  440 -1486.7299 5253.89010   453%  4263 1670s
  5107  2283 1468.56673   11  460 -1486.7299 5253.89010   453%  4262 1675s
  5109  2285 3860.43042   13  450 -1486.7299 5253.89010   453%  4261 1683s
  5110  2285  -31.54166   24  436 -1486.7299 5253.89010   453%  4260 1696s
  5111  2286  846.14650   15  460 -1486.7299 5253.89010   453%  4259 1704s
  5112  2287 1066.59175   12  457 -1486.7299 5253.89010   453%  4258 1708s
  5113  2287 1428.46157   11  465 -1486.7299 5253.89010   453%  4257 1712s
  5114  2288 2524.46657    8  471 -1486.7299 5253.89010   453%  4256 1717s
  5115  2289 3815.75257   16  478 -1486.7299 5253.89010   453%  4256 1728s
  5116  2289  673.77593   21  451 -1486.7299 5253.89010   453%  4255 1735s
  5117  2290  913.50606   20  454 -1486.7299 5253.89010   453%  4254 1746s
  5118  2291  534.98052   24  453 -1486.7299 5253.89010   453%  4253 1750s
  5119  2291 3000.51229   11  454 -1486.7299 5253.89010   453%  4252 1755s
  5120  2292  400.76880   46  468 -1486.7299 5253.89010   453%  4251 1760s
  5121  2293 -826.50520   26  459 -1486.7299 5253.89010   453%  4251 1770s
  5122  2293 1586.83495   15  483 -1486.7299 5253.89010   453%  4250 1775s
  5123  2294 2063.34208   13  499 -1486.7299 5253.89010   453%  4249 1781s
  5124  2295 4061.55820   13  484 -1486.7299 5253.89010   453%  4248 1803s
  5125  2295  406.16666   11  551 -1486.7299 5253.89010   453%  4247 1809s
  5126  2296  312.18948   18  503 -1486.7299 5253.89010   453%  4246 1815s
  5127  2297  448.23809   22  578 -1486.7299 5253.89010   453%  4246 1826s
  5128  2297 -889.10494   14  515 -1486.7299 5253.89010   453%  4245 1832s
  5129  2298 -474.53530   26  504 -1486.7299 5253.89010   453%  4244 1838s
  5130  2299 1376.35651   17  527 -1486.7299 5253.89010   453%  4243 1844s
  5131  2299 -102.14397   51  507 -1486.7299 5253.89010   453%  4242 1858s
  5132  2300  566.47318    8  521 -1486.7299 5253.89010   453%  4241 1865s
  5133  2301 4068.97899   10  486 -1486.7299 5253.89010   453%  4241 1876s
  5134  2301   63.59803   15  486 -1486.7299 5253.89010   453%  4240 1915s
  5135  2302  978.32717   24  486 -1486.7299 5253.89010   453%  4239 1997s
  5136  2305 5253.89010   11  434 -1486.7299 5253.89010   453%  4296 2014s
  5137  2307 4457.58872   12  237 -1486.7299 5253.89010   453%  4297 2031s
  5140  2311 3997.27756   13  231 -1486.7299 5253.89010   453%  4298 2062s
  5145  2321 3314.54674   14  291 -1486.7299 5253.89010   453%  4302 2080s
  5156  2330 1881.39095   15  174 -1486.7299 5253.89010   453%  4327 2122s
  5169  2354 3974.22269   14  318 -1486.7299 5253.89010   453%  4341 2222s
  5201  2382 3663.15763   15  349 -1486.7299 5253.89010   453%  4407 2264s
  5247  2404 2952.38905   18  340 -1486.7299 5253.89010   453%  4453 2303s
  5301  2433 1381.79372   21  308 -1486.7299 5253.89010   453%  4486 2333s
  5361  2451 -663.55467   25  216 -1486.7299 5253.89010   453%  4521 2356s
  5441  2443 5253.89010   18  481 -1486.7299 5253.89010   453%  4552 2382s
  5508  2444 4815.96088   19  397 -1486.7299 5253.89010   453%  4568 2406s
  5577  2454 4348.85618   20  412 -1486.7299 5253.89010   453%  4602 2431s
  5652  2458 4341.03255   21  408 -1486.7299 5253.89010   453%  4636 2450s
  5727  2462 -258.10181   24  270 -1486.7299 5253.89010   453%  4636 2471s
  5799  2472 2605.78807   22  357 -1486.7299 5253.89010   453%  4640 2488s
H 5853  2338                    -1259.755789 5253.89010   517%  4639 2488s
  5877  2341 1269.74825   23  280 -1259.7558 5253.89010   517%  4643 2507s
  5957  2336  646.97840   25  220 -1259.7558 5253.89010   517%  4640 2525s
H 5967  2223                    -1122.693574 5253.89010   568%  4643 2525s
H 5988  2111                    -997.5442260 5253.89010   627%  4641 2525s
  6030  2112     cutoff   25      -997.54423 5253.89010   627%  4641 2544s
  6119  2106     cutoff   29      -997.54423 5253.89010   627%  4640 2572s
H 6122  2006                    -982.4711778 5253.89010   635%  4641 2572s
H 6126  1911                    -970.4405979 5253.89010   641%  4642 2572s
H 6143  1815                    -957.2992589 5253.89010   649%  4643 2572s
H 6172  1720                    -854.3105722 5253.89010   715%  4647 2572s
  6193  1730 3629.48356   19  441 -854.31057 5253.89010   715%  4649 2592s
  6270  1728 3451.03877   20  393 -854.31057 4785.91416   660%  4647 2612s
  6347  1736 3021.53048   21  350 -854.31057 4654.81095   645%  4654 2636s
  6432  1725 2085.86099   22  293 -854.31057 4588.21087   637%  4663 2656s
  6531  1712  282.07137   24  194 -854.31057 4578.24447   636%  4660 2677s
  6640  1683 2001.38974   17  353 -854.31057 4578.24447   636%  4662 2700s
  6754  1675  433.67440   18  247 -854.31057 4578.24447   636%  4662 2722s
  6854  1655  435.54756   19  353 -854.31057 3890.96921   555%  4684 2739s
  6901  1652  433.37748   20  290 -854.31057 3890.96921   555%  4688 2758s
  6953  1649  224.10022   21  291 -854.31057 3890.96921   555%  4689 2780s
  7002  1645     cutoff   21      -854.31057 3890.96921   555%  4695 2796s
H 7014  1560                    -768.7712795 3890.96921   606%  4694 2796s
  7045  1546     cutoff   22      -768.77128 3890.96921   606%  4699 2822s
  7218  1519 2293.79066   22  403 -768.77128 3747.63135   587%  4679 2851s
  7374  1482 -385.79303   25  270 -768.77128 3747.63135   587%  4670 2882s
  7549  1419  689.37565   22  342 -768.77128 3252.90773   523%  4668 2913s
  7739  1361     cutoff   25      -768.77128 3252.90773   523%  4648 2942s
  7913  1314 -129.47101   22  361 -768.77128 3168.43901   512%  4660 2972s
  8083  1245     cutoff   22      -768.77128 2843.97977   470%  4661 2999s
  8166  1221 1377.38466   19  350 -768.77128 2738.31359   456%  4672 3026s
  8285  1161  352.23222   20  347 -768.77128 2574.17766   435%  4668 3056s
  8469  1111 -197.04396   21  353 -768.77128 2574.17766   435%  4660 3089s
  8650  1009     cutoff   22      -768.77128 2297.83270   399%  4665 3132s
  8897   860     cutoff   21      -768.77128 2061.41936   368%  4650 3171s
  9177   685   13.52265   24  231 -768.77128 1759.42135   329%  4643 3207s
  9469   370     cutoff   27      -768.77128 1539.84438   300%  4630 3245s
  9951   233     cutoff   24      -768.77128 1156.09411   250%  4523 3273s
 10641   536 -592.31894   50   54 -768.77128  324.14887   142%  4284 3293s
 11719   871 -182.87992   22  358 -768.77128  193.32417   125%  3903 3309s
 13027  1173 -597.23378   45   20 -768.77128 -574.43311  25.3%  3519 3314s
 14627  1196 -661.82414   47   14 -768.77128 -628.35904  18.3%  3143 3318s
*16449  1196              52    -757.8658716 -645.86859  14.8%  2803 3318s
 16547   532 -736.82473   54    8 -757.86587 -660.30563  12.9%  2787 3323s
*16552   532              57    -756.6829502 -660.30563  12.7%  2786 3323s
*17080   532              71    -698.5217525 -662.55442  5.15%  2702 3323s
 18767     0     cutoff   59      -698.52175 -678.66699  2.84%  2464 3326s

Cutting planes:
  Learned: 1
  MIR: 970
  Mixing: 5
  Flow cover: 2342
  RLT: 22
  Relax-and-lift: 165

Explored 19283 nodes (46570926 simplex iterations) in 3327.41 seconds (6202.98 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -698.522 -756.683 -757.866 ... -1122.69
No other solutions better than -698.522

Optimal solution found (tolerance 1.00e-04)
Best objective -6.985217524632e+02, best bound -6.985217524632e+02, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3327.43s
  Master Objective (UB) = -698.52, θ = 133319.61
  Upper Bound (UB) = -698.52

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 133319.61
  [DEBUG]   ✓ Scenario 0: θ = 133319.61 ≤ Q = 133319.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 133319.61 ≤ Q = 133319.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 133319.61 ≤ Q = 133319.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 133319.61 ≤ Q = 133319.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 133319.61 ≤ Q = 133319.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 133319.61 ≤ Q = 133319.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 133319.61 ≤ Q = 133319.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 133319.61 ≤ Q = 133319.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 133319.61 ≤ Q = 133319.61 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x54e98a3c
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xab1675c4
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.360527e+13
Presolve removed 2625 rows and 1918 columns
Presolve time: 0.01s
Presolved: 468 rows, 471 columns, 1319 nonzeros
Found heuristic solution: objective 6369561.8895
Variable types: 319 continuous, 152 integer (152 binary)

Root relaxation: objective -1.361281e+05, 236 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -136128.11    0  123 6369561.89 -136128.11   102%     -    0s
H    0     0                    -104584.9542 -136128.11  30.2%     -    0s
H    0     0                    -104791.2871 -136128.11  29.9%     -    0s
H    0     0                    -107936.4464 -136128.11  26.1%     -    0s
H    0     0                    -110082.1933 -119853.63  8.88%     -    0s
H    0     0                    -110306.4435 -119853.63  8.66%     -    0s
     0     0 -119853.63    0  127 -110306.44 -119853.63  8.66%     -    0s
H    0     0                    -115717.7817 -119803.73  3.53%     -    0s
     0     0 -118605.82    0  126 -115717.78 -118605.82  2.50%     -    0s
H    0     0                    -116175.6630 -118556.22  2.05%     -    0s
H    0     0                    -116469.1445 -118556.22  1.79%     -    0s
     0     0 -118046.58    0  120 -116469.14 -118046.58  1.35%     -    0s
     0     0 -118009.61    0  120 -116469.14 -118009.61  1.32%     -    0s
     0     0 -118009.61    0  120 -116469.14 -118009.61  1.32%     -    0s
     0     0 -117605.97    0   87 -116469.14 -117605.97  0.98%     -    0s
     0     0 -117570.92    0  101 -116469.14 -117570.92  0.95%     -    0s
     0     0 -117569.74    0  101 -116469.14 -117569.74  0.94%     -    0s
     0     0 -117142.55    0   50 -116469.14 -117142.55  0.58%     -    0s
     0     0 -117021.03    0   73 -116469.14 -117021.03  0.47%     -    0s
     0     0 -117017.42    0   85 -116469.14 -117017.42  0.47%     -    0s
     0     0 -116731.47    0   41 -116469.14 -116731.47  0.23%     -    0s
     0     0 -116731.24    0   29 -116469.14 -116731.24  0.23%     -    0s
     0     0 -116696.05    0   34 -116469.14 -116696.05  0.19%     -    0s
     0     0 -116693.47    0   30 -116469.14 -116693.47  0.19%     -    0s
     0     0 -116685.01    0   28 -116469.14 -116685.01  0.19%     -    0s
     0     0 -116589.34    0   11 -116469.14 -116589.34  0.10%     -    0s
     0     0 -116589.34    0   17 -116469.14 -116589.34  0.10%     -    0s
H    0     0                    -116506.0440 -116589.34  0.07%     -    0s
     0     0 -116524.20    0    7 -116506.04 -116524.20  0.02%     -    0s
H    0     0                    -116522.9087 -116523.54  0.00%     -    0s
     0     0 -116523.54    0    6 -116522.91 -116523.54  0.00%     -    0s

Cutting planes:
  Gomory: 4
  MIR: 1
  Flow cover: 15
  Relax-and-lift: 4

Explored 1 nodes (1142 simplex iterations) in 0.18 seconds (0.06 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -116523 -116506 -116469 ... -104791

Optimal solution found (tolerance 1.00e-04)
Best objective -1.165229087490e+05, best bound -1.165235441833e+05, gap 0.0005%
  Subproblem solved in 0.21s
  Worst-case operational profit (Z_SP) = 123934.23
  Scenario: 60 demand increases, 0 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -116522.91
  [DEBUG]   S×d_nominal = 240457.14
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 240457.14 + -116522.91 = 123934.23
  [DEBUG]   Current θ from Master = 133319.61
  [DEBUG]   ⚠️  Z_SP ≤ θ by 9385.38 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -10083.90
  Lower Bound (LB) = -6521.46
  Gap (UB-LB) = 5822.9391, Absolute Gap = 5822.9391, Relative Gap = 8.336088
  Not converged yet (gap = 5822.94 > ε = 200)

  [DEBUG] Adding NEW scenario 9 to Master Problem...
  [DEBUG] New scenario pattern: 60 increases, 0 decreases
    [DEBUG] Scenario 9 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 9 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 9]
    [DEBUG]   - Total constraints in model: 154283
    [DEBUG]   - Total variables in model: 64660
  [DEBUG] Total scenarios in Master: 10
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 10
================================================================================
[Iteration 10] Solving Master Problem...
  Current scenarios in Master: 10
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 154283 rows, 64660 columns and 437709 nonzeros
Model fingerprint: 0x79771fa4
Variable types: 62401 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 74740 rows and 30340 columns
Presolve time: 2.81s
Presolved: 79543 rows, 34320 columns, 489159 nonzeros
Variable types: 32061 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -366101.7227
Found heuristic solution: objective -171217.0927

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 79543 rows, 34320 columns, 489159 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   20547   -1.9407034e+05   0.000000e+00   1.983786e+06      5s
   41952   -7.1762716e+04   0.000000e+00   2.008031e+08     10s
   51102   -4.2263915e+04   0.000000e+00   1.201139e+07     15s
   55904   -3.9254982e+04   0.000000e+00   1.927768e+07     20s
   61949   -2.7167781e+04   0.000000e+00   2.996303e+07     25s
   68189   -1.8702281e+04   0.000000e+00   4.721125e+06     30s
   73351   -1.5337309e+04   0.000000e+00   7.284576e+06     35s
   78472   -1.2640250e+04   0.000000e+00   2.101969e+07     40s
   82685   -9.3281933e+03   0.000000e+00   5.899560e+06     45s
Concurrent spin time: 4.07s

Solved with dual simplex

Root relaxation: objective 1.954052e+04, 60891 iterations, 46.29 seconds (59.63 work units)
Total elapsed time = 50.05s (DegenMoves)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 19540.5201    0  166 -171217.09 19540.5201   111%     -   50s
H    0     0                    -168379.0214 19540.5201   112%     -   50s
H    0     0                    -134699.0563 19540.5201   115%     -   50s
H    0     0                    -134073.1088 19540.5201   115%     -   50s
H    0     0                    -133853.5325 19540.5201   115%     -   50s
H    0     0                    -132576.0578 19540.5201   115%     -   51s
H    0     0                    -72292.54058 19540.5201   127%     -   51s
H    0     0                    -11662.84373 19540.5201   268%     -   51s
H    0     0                    -11395.87512 19540.5201   271%     -   51s
H    0     0                    -10208.54753 19540.5201   291%     -   52s
H    0     0                    -9600.459311 19540.5201   304%     -   52s
H    0     0                    -9190.077788 15928.5910   273%     -   70s
H    0     0                    -9064.882049 15928.5910   276%     -   70s
H    0     0                    -8980.783992 15928.5910   277%     -   70s
     0     0 15795.1057    0  276 -8980.7840 15795.1057   276%     -   70s
H    0     0                    -8889.864707 15795.1057   278%     -   71s
     0     0 15795.1057    0  276 -8889.8647 15795.1057   278%     -   74s
     0     0 15795.1057    0  282 -8889.8647 15795.1057   278%     -   76s
     0     0 15795.1057    0  282 -8889.8647 15795.1057   278%     -   76s
     0     0 15795.1057    0  282 -8889.8647 15795.1057   278%     -   77s
     0     0 15790.1188    0  282 -8889.8647 15790.1188   278%     -   78s
     0     0 15789.9911    0  282 -8889.8647 15789.9911   278%     -   78s
H    0     0                    -8809.502831 13296.1703   251%     -   99s
     0     0 13296.1703    0  236 -8809.5028 13296.1703   251%     -   99s
     0     0 12616.1607    0  268 -8809.5028 12616.1607   243%     -  110s
     0     0 12561.9365    0  278 -8809.5028 12561.9365   243%     -  114s
     0     0 12525.4984    0  277 -8809.5028 12525.4984   242%     -  117s
     0     0 12521.1885    0  273 -8809.5028 12521.1885   242%     -  119s
     0     0 12505.7067    0  272 -8809.5028 12505.7067   242%     -  121s
     0     0 12491.1364    0  273 -8809.5028 12491.1364   242%     -  123s
     0     0 12419.2402    0  273 -8809.5028 12419.2402   241%     -  128s
     0     0 12415.0466    0  274 -8809.5028 12415.0466   241%     -  130s
     0     0 12382.1072    0  274 -8809.5028 12382.1072   241%     -  132s
     0     0 12379.3541    0  273 -8809.5028 12379.3541   241%     -  133s
     0     0 12378.4500    0  279 -8809.5028 12378.4500   241%     -  134s
     0     0 12374.2253    0  276 -8809.5028 12374.2253   240%     -  135s
     0     0 12373.9799    0  274 -8809.5028 12373.9799   240%     -  136s
     0     0 10878.8223    0  445 -8809.5028 10878.8223   223%     -  166s
     0     0 10368.1745    0  457 -8809.5028 10368.1745   218%     -  183s
     0     0 10017.6653    0  459 -8809.5028 10017.6653   214%     -  192s
     0     0 9976.25581    0  469 -8809.5028 9976.25581   213%     -  195s
     0     0 9965.98427    0  470 -8809.5028 9965.98427   213%     -  198s
     0     0 9944.19544    0  473 -8809.5028 9944.19544   213%     -  199s
     0     0 9927.87048    0  475 -8809.5028 9927.87048   213%     -  202s
     0     0 9923.39238    0  468 -8809.5028 9923.39238   213%     -  203s
     0     0 9851.21353    0  475 -8809.5028 9851.21353   212%     -  208s
     0     0 9835.10818    0  480 -8809.5028 9835.10818   212%     -  210s
     0     0 9809.01175    0  489 -8809.5028 9809.01175   211%     -  212s
     0     0 9770.37822    0  474 -8809.5028 9770.37822   211%     -  216s
     0     0 9760.13138    0  482 -8809.5028 9760.13138   211%     -  217s
     0     0 9756.02930    0  483 -8809.5028 9756.02930   211%     -  219s
     0     0 9755.78435    0  487 -8809.5028 9755.78435   211%     -  219s
H    0     0                    -5110.314916 8796.23263   272%     -  256s
H    0     0                    -5068.413244 8796.23263   274%     -  256s
H    0     0                    -4910.406594 8796.23263   279%     -  256s
H    0     0                    -4579.438727 8796.23263   292%     -  256s
     0     0 8796.23263    0  417 -4579.4387 8796.23263   292%     -  256s
H    0     0                    -3972.944220 8796.20844   321%     -  257s
     0     0 8492.33400    0  421 -3972.9442 8492.33400   314%     -  270s
     0     0 8362.51338    0  433 -3972.9442 8362.51338   310%     -  278s
     0     0 8312.59702    0  436 -3972.9442 8312.59702   309%     -  285s
     0     0 8290.87174    0  441 -3972.9442 8290.87174   309%     -  288s
     0     0 8262.29373    0  442 -3972.9442 8262.29373   308%     -  291s
     0     0 8249.17495    0  438 -3972.9442 8249.17495   308%     -  294s
     0     0 8221.82411    0  437 -3972.9442 8221.82411   307%     -  298s
     0     0 8211.55442    0  435 -3972.9442 8211.55442   307%     -  302s
     0     0 8210.18591    0  436 -3972.9442 8210.18591   307%     -  303s
     0     0 7866.85556    0  464 -3972.9442 7866.85556   298%     -  324s
H    0     0                    -3959.179227 7866.58381   299%     -  324s
H    0     0                    -3948.833616 7866.58381   299%     -  324s
     0     0 7788.45389    0  441 -3948.8336 7788.45389   297%     -  333s
     0     0 7780.80734    0  470 -3948.8336 7780.80734   297%     -  337s
     0     0 7774.47936    0  475 -3948.8336 7774.47936   297%     -  339s
     0     0 7763.96674    0  459 -3948.8336 7763.96674   297%     -  341s
     0     0 7756.09787    0  464 -3948.8336 7756.09787   296%     -  342s
     0     0 7745.22405    0  460 -3948.8336 7745.22405   296%     -  344s
     0     0 7744.18298    0  460 -3948.8336 7744.18298   296%     -  345s
     0     0 7564.87206    0  464 -3948.8336 7564.87206   292%     -  357s
H    0     0                    -2959.195500 7564.68401   356%     -  359s
     0     0 7530.63009    0  480 -2959.1955 7530.63009   354%     -  367s
     0     0 7501.44153    0  478 -2959.1955 7501.44153   353%     -  372s
     0     0 7492.07020    0  446 -2959.1955 7492.07020   353%     -  375s
     0     0 7487.57247    0  447 -2959.1955 7487.57247   353%     -  377s
     0     0 7477.55159    0  448 -2959.1955 7477.55159   353%     -  378s
     0     0 7461.49678    0  452 -2959.1955 7461.49678   352%     -  381s
     0     0 7448.37833    0  453 -2959.1955 7448.37833   352%     -  384s
     0     0 7437.74586    0  456 -2959.1955 7437.74586   351%     -  386s
     0     0 7431.54807    0  451 -2959.1955 7431.54807   351%     -  388s
     0     0 7428.43725    0  463 -2959.1955 7428.43725   351%     -  389s
     0     0 7427.42216    0  457 -2959.1955 7427.42216   351%     -  390s
     0     0 7337.01170    0  461 -2959.1955 7337.01170   348%     -  398s
H    0     0                    -2801.861310 7336.96070   362%     -  399s
     0     0 7323.91061    0  473 -2801.8613 7323.91061   361%     -  401s
     0     0 7311.85792    0  463 -2801.8613 7311.85792   361%     -  405s
     0     0 7307.89863    0  466 -2801.8613 7307.89863   361%     -  406s
     0     0 7306.47797    0  471 -2801.8613 7306.47797   361%     -  407s
     0     0 7283.05946    0  461 -2801.8613 7283.05946   360%     -  412s
H    0     0                    -2790.399997 7283.00647   361%     -  413s
     0     0 7279.42779    0  470 -2790.4000 7279.42779   361%     -  414s
     0     0 7277.63752    0  470 -2790.4000 7277.63752   361%     -  415s
     0     0 7273.27022    0  465 -2790.4000 7273.27022   361%     -  416s
     0     0 7272.50266    0  464 -2790.4000 7272.50266   361%     -  417s
     0     0 7258.80747    0  465 -2790.4000 7258.80747   360%     -  420s
     0     0 7254.69395    0  462 -2790.4000 7254.69395   360%     -  423s
     0     0 7253.83718    0  459 -2790.4000 7253.83718   360%     -  423s
     0     0 7236.48261    0  460 -2790.4000 7236.48261   359%     -  428s
     0     0 7234.28422    0  458 -2790.4000 7234.28422   359%     -  433s
     0     0 7233.72779    0  459 -2790.4000 7233.72779   359%     -  435s
     0     0 7202.68886    0  450 -2790.4000 7202.68886   358%     -  440s
     0     0 7195.33118    0  457 -2790.4000 7195.33118   358%     -  444s
     0     0 7194.52017    0  464 -2790.4000 7194.52017   358%     -  445s
     0     0 7189.81202    0  484 -2790.4000 7189.81202   358%     -  448s
     0     0 7185.33396    0  500 -2790.4000 7185.33396   358%     -  454s
     0     0 7184.33488    0  505 -2790.4000 7184.33488   357%     -  454s
     0     0 7171.85043    0  494 -2790.4000 7171.85043   357%     -  458s
     0     0 7169.00724    0  467 -2790.4000 7169.00724   357%     -  460s
     0     0 7168.64245    0  503 -2790.4000 7168.64245   357%     -  461s
     0     0 7166.01886    0  469 -2790.4000 7166.01886   357%     -  463s
H    0     0                    -2736.634592 7165.63786   362%     -  465s
     0     0 7165.32961    0  471 -2736.6346 7165.32961   362%     -  466s
     0     0 7160.97380    0  504 -2736.6346 7160.97380   362%     -  469s
     0     0 7157.70969    0  503 -2736.6346 7157.70969   362%     -  471s
     0     0 7156.61004    0  512 -2736.6346 7156.61004   362%     -  471s
     0     0 7155.94582    0  508 -2736.6346 7155.94582   361%     -  474s
     0     0 7155.76778    0  508 -2736.6346 7155.76778   361%     -  477s
H    0     0                    -2706.843549 7155.67611   364%     -  555s
     0     2 7155.67611    0  508 -2706.8435 7155.67611   364%     -  621s
     1     4 7067.79646    1  487 -2706.8435 7154.71408   364%  6805  629s
     3     8 6820.69583    2  483 -2706.8435 7067.78017   361%  7710  651s
     7    16 6736.55743    3  477 -2706.8435 6820.39555   352% 11117  670s
    15    32 6542.56485    4  495 -2706.8435 6736.20257   349%  9375  687s
    31    48 6368.21820    5  493 -2706.8435 6542.52586   342% 13914  735s
    47    80 6077.46106    6  496 -2706.8435 6542.52586   342% 13188  761s
    79   146 6036.52788    7  494 -2706.8435 6542.52586   342% 10143  817s
   153   216 6012.19210    9  457 -2706.8435 6542.52586   342%  6799  846s
   245   261 5714.27773    9  464 -2706.8435 6542.52586   342%  5671  869s
   312   278 5746.40652    9  424 -2706.8435 6542.52586   342%  5745  893s
   353   302 5922.88486   10  439 -2706.8435 6542.52586   342%  5771  914s
   406   335 5598.54487   10  456 -2706.8435 6542.52586   342%  5590  934s
   458   368 5092.46000   10  425 -2706.8435 6542.52586   342%  5416  955s
   515   417 5408.90734   10  413 -2706.8435 6542.52586   342%  5217  976s
   586   457 5383.86616   10  405 -2706.8435 6542.52586   342%  4985  994s
   664   489 5494.99387   11  432 -2706.8435 6542.52586   342%  4703 1012s
   725   519 5370.36974   11  411 -2706.8435 6542.52586   342%  4578 1033s
   789   537 5055.05742   11  413 -2706.8435 6542.52586   342%  4431 1051s
   829   559  871.80705   34  408 -2706.8435 6542.52586   342%  4406 1070s
   867   591 4698.60486   12  406 -2706.8435 6542.52586   342%  4371 1089s
   905   631 3510.81158   13  403 -2706.8435 6542.52586   342%  4395 1107s
   955   680 3473.47620   13  358 -2706.8435 6542.52586   342%  4340 1123s
  1016   723 2887.89922   14  349 -2706.8435 6542.52586   342%  4277 1140s
  1081   776 2894.82095   14  271 -2706.8435 6542.52586   342%  4187 1157s
  1142   828 2998.68497   14  389 -2706.8435 6542.52586   342%  4111 1178s
  1222   891 2729.08967   15  337 -2706.8435 6079.38196   325%  4040 1199s
  1317   942 2799.14906   14  406 -2706.8435 5922.62090   319%  3947 1221s
  1412   986 2736.94033   15  384 -2706.8435 5922.41090   319%  3897 1246s
  1508  1044 2710.04603   16  323 -2706.8435 5922.41090   319%  3819 1270s
  1592  1101     cutoff   15      -2706.8435 5922.41090   319%  3790 1293s
  1698  1175 1425.78290   17  308 -2706.8435 5922.41090   319%  3745 1317s
  1844  1277 2153.44211   18  298 -2706.8435 5780.23287   314%  3645 1342s
  2003  1346 -167.70868   16  339 -2706.8435 5780.23287   314%  3549 1372s
  2152  1435 infeasible   18      -2706.8435 5493.95986   303%  3483 1399s
  2304  1521 1742.26969   20  196 -2706.8435 5493.95986   303%  3424 1427s
  2488  1599   86.74429   19  373 -2706.8435 5408.25086   300%  3347 1457s
  2658  1679 1592.54695   21  204 -2706.8435 5408.25086   300%  3298 1488s
  2816  1742     cutoff   20      -2706.8435 5408.25086   300%  3263 1521s
  3007  1780 -933.91013   23  306 -2706.8435 5408.25086   300%  3217 1556s
  3172  1788     cutoff   24      -2706.8435 5408.25086   300%  3214 1589s
  3226  1815     cutoff   26      -2706.8435 5192.02927   292%  3237 1624s
  3283  1846 1257.06646   13  384 -2706.8435 5022.80513   286%  3263 1651s
  3350  1860  343.65595   14  377 -2706.8435 4980.69626   284%  3272 1683s
  3418  1891  168.35594   15  375 -2706.8435 4956.86164   283%  3287 1721s
  3471  1921 -221.77703   16  363 -2706.8435 4900.48818   281%  3306 1751s
  3551  1956 -371.49748   17  348 -2706.8435 4887.60923   281%  3303 1786s
  3640  2033 -992.20018   18  393 -2706.8435 4861.52522   280%  3309 1823s
  3786  2090 -1646.4337   21  389 -2706.8435 4861.52522   280%  3282 1864s
  4013  2172 1893.84514    9  275 -2706.8435 4751.86581   276%  3223 1903s
  4163  2245 1322.74051   10  215 -2706.8435 4749.10436   275%  3192 1946s
  4314  2315 1309.05681   11  205 -2706.8435 4620.60158   271%  3176 1995s
  4528  2423  -52.74385   17  317 -2706.8435 4620.60158   271%  3161 2044s
  4793  2524 -1874.5880    9  230 -2706.8435 4620.60158   271%  3157 2094s
  5034  2525 1754.32424   28  508 -2706.8435 4494.08003   266%  3175 2595s
  5036  2526 3188.40941    8  166 -2706.8435 4494.08003   266%  3173 2661s
  5037  2527 1837.70257   12  369 -2706.8435 4494.08003   266%  3173 2702s
  5038  2528  241.78352   20  424 -2706.8435 4494.08003   266%  3172 2733s
  5039  2528 1179.65694   31  424 -2706.8435 4494.08003   266%  3172 2756s
  5040  2529  494.05847   14  408 -2706.8435 4494.08003   266%  3171 2772s
  5041  2530 1316.48400   31  455 -2706.8435 4494.08003   266%  3170 2786s
  5042  2530 3650.92099   14  537 -2706.8435 4494.08003   266%  3170 2799s
  5043  2531 1131.52303   17  496 -2706.8435 4494.08003   266%  3169 2815s
  5044  2532 -1864.7506   19  470 -2706.8435 4494.08003   266%  3168 2821s
  5045  2532 -1111.4053   55  513 -2706.8435 4494.08003   266%  3168 2830s
  5046  2533 3804.28501    7  472 -2706.8435 4494.08003   266%  3167 2836s
  5047  2534 -1623.5239   57  504 -2706.8435 4494.08003   266%  3167 2844s
  5048  2534 2184.79640   15  478 -2706.8435 4494.08003   266%  3166 2849s
  5049  2535  891.94090   12  507 -2706.8435 4494.08003   266%  3165 2853s
  5050  2536 3038.41754    7  475 -2706.8435 4494.08003   266%  3165 2858s
  5051  2536 -500.63450   14  496 -2706.8435 4494.08003   266%  3164 2870s
  5052  2537 -325.39070   27  522 -2706.8435 4494.08003   266%  3163 2876s
  5054  2538 -2316.6397   43  527 -2706.8435 4494.08003   266%  3162 2886s
  5055  2539 2815.97592    8  523 -2706.8435 4494.08003   266%  3162 2902s
  5056  2540 -1075.8733   26  521 -2706.8435 4494.08003   266%  3161 2906s
  5057  2540 2491.52065   11  529 -2706.8435 4494.08003   266%  3160 2914s
  5058  2541 1537.39173   20  505 -2706.8435 4494.08003   266%  3160 2923s
  5059  2542 3824.50227   15  538 -2706.8435 4494.08003   266%  3159 2926s
  5060  2542 3807.77376   13  502 -2706.8435 4494.08003   266%  3158 2931s
  5061  2543 -1136.9962   29  515 -2706.8435 4494.08003   266%  3158 2943s
  5062  2544 -902.67720   63  528 -2706.8435 4494.08003   266%  3157 2949s
  5063  2544 -2308.7774   42  495 -2706.8435 4494.08003   266%  3157 2955s
  5064  2545 2110.56748   16  476 -2706.8435 4494.08003   266%  3156 2971s
  5065  2546 -1875.4644   31  477 -2706.8435 4494.08003   266%  3155 2978s
  5066  2546 2949.34215   20  535 -2706.8435 4494.08003   266%  3155 2991s
  5067  2547 1646.34516   35  498 -2706.8435 4494.08003   266%  3154 3001s
  5068  2548 -491.48050   20  544 -2706.8435 4494.08003   266%  3153 3012s
  5069  2548 -907.50531   37  486 -2706.8435 4494.08003   266%  3153 3026s
  5070  2549 -888.62474   36  486 -2706.8435 4494.08003   266%  3152 3092s
  5071  2550 -1766.0230   19  486 -2706.8435 4494.08003   266%  3152 3145s
  5072  2553 4494.08003   13  466 -2706.8435 4494.08003   266%  3217 3213s
  5074  2557 4494.08003   14  460 -2706.8435 4494.08003   266%  3221 3252s
  5078  2563 4494.08003   15  453 -2706.8435 4494.08003   266%  3227 3282s
  5086  2577 4494.08003   16  464 -2706.8435 4494.08003   266%  3241 3336s
  5102  2588  330.67827   17  255 -2706.8435 4494.08003   266%  3286 3403s
  5119  2615 2480.41974   18  303 -2706.8435 4494.08003   266%  3344 3451s
  5151  2644 2291.69952   19  285 -2706.8435 4494.08003   266%  3393 3500s
  5191  2689 2265.95696   20  337 -2706.8435 4494.08003   266%  3410 3542s
  5272  2723 1951.37257   21  262 -2706.8435 4494.08003   266%  3437 3584s
  5365  2711 -1388.7072   22  311 -2706.8435 4494.08003   266%  3485 3600s

Cutting planes:
  Gomory: 3
  MIR: 614
  Mixing: 1
  Flow cover: 1521
  RLT: 11
  Relax-and-lift: 138

Explored 5429 nodes (19441712 simplex iterations) in 3600.07 seconds (5919.94 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -2706.84 -2736.63 -2790.4 ... -4910.41

Time limit reached
Best objective -2.706843549356e+03, best bound 4.494080030056e+03, gap 266.0266%
  WARNING: Time limit reached. Using best solution found (gap: 266.03%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = -2706.84, θ = 131656.27
  Upper Bound (UB) = -2706.84

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 131656.27
  [DEBUG]   ✓ Scenario 0: θ = 131656.27 ≤ Q = 131656.27 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 131656.27 ≤ Q = 131656.27 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 131656.27 ≤ Q = 131656.27 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 131656.27 ≤ Q = 131656.27 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 131656.27 ≤ Q = 131656.27 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 131656.27 ≤ Q = 131656.27 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 131656.27 ≤ Q = 131656.27 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 131656.27 ≤ Q = 131656.27 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 131656.27 ≤ Q = 131656.27 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 131656.27 ≤ Q = 131695.87 (slack: 39.60)
  [DEBUG] All optimality cuts satisfied.
[Iteration 10] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x5a24ca00
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x5a24ca00
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.385541e+13
Presolve removed 2625 rows and 1918 columns
Presolve time: 0.01s
Presolved: 468 rows, 471 columns, 1319 nonzeros
Found heuristic solution: objective 6533702.1097
Variable types: 319 continuous, 152 integer (152 binary)

Root relaxation: objective -1.371419e+05, 249 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -137141.91    0  128 6533702.11 -137141.91   102%     -    0s
H    0     0                    -102043.7342 -137141.91  34.4%     -    0s
H    0     0                    -102365.4964 -137141.91  34.0%     -    0s
H    0     0                    -105495.0835 -118413.76  12.2%     -    0s
H    0     0                    -113177.7840 -118413.76  4.63%     -    0s
     0     0 -118320.12    0   39 -113177.78 -118320.12  4.54%     -    0s
H    0     0                    -116936.2089 -118320.12  1.18%     -    0s
     0     0 -118221.92    0   39 -116936.21 -118221.92  1.10%     -    0s
     0     0 -118221.92    0   38 -116936.21 -118221.92  1.10%     -    0s
H    0     0                    -117520.0129 -117910.50  0.33%     -    0s
     0     0 -117852.36    0   14 -117520.01 -117852.36  0.28%     -    0s
H    0     0                    -117570.6387 -117852.36  0.24%     -    0s
     0     0 -117656.45    0   12 -117570.64 -117656.45  0.07%     -    0s
     0     0 -117604.95    0    4 -117570.64 -117604.95  0.03%     -    0s
     0     0 -117583.37    0    3 -117570.64 -117583.37  0.01%     -    0s
     0     0          -    0      -117570.64 -117577.13  0.01%     -    0s

Explored 1 nodes (516 simplex iterations) in 0.13 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -117571 -117520 -117314 ... 1.38554e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.175706387168e+05, best bound -1.175771253292e+05, gap 0.0055%
  Subproblem solved in 0.16s
  Worst-case operational profit (Z_SP) = 120399.21
  Scenario: 15 demand increases, 45 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -117570.64
  [DEBUG]   S×d_nominal = 237969.84
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 237969.84 + -117570.64 = 120399.21
  [DEBUG]   Current θ from Master = 131656.27
  [DEBUG]   ⚠️  Z_SP ≤ θ by 11257.06 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -13963.91
  Lower Bound (LB) = -6521.46
  Gap (UB-LB) = 3814.6173, Absolute Gap = 3814.6173, Relative Gap = 1.409249
  Not converged yet (gap = 3814.62 > ε = 200)

  [DEBUG] Adding NEW scenario 10 to Master Problem...
  [DEBUG] New scenario pattern: 15 increases, 45 decreases
    [DEBUG] Scenario 10 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 10 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 10]
    [DEBUG]   - Total constraints in model: 169573
    [DEBUG]   - Total variables in model: 70900
  [DEBUG] Total scenarios in Master: 11
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 11
================================================================================
[Iteration 11] Solving Master Problem...
  Current scenarios in Master: 11
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 169573 rows, 70900 columns and 480928 nonzeros
Model fingerprint: 0x3f2c4349
Variable types: 68641 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 82214 rows and 33374 columns
Presolve time: 2.82s
Presolved: 87359 rows, 37526 columns, 534487 nonzeros
Variable types: 35267 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -369336.6276
Found heuristic solution: objective -171217.0927

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.26s

Barrier statistics:
 Dense cols : 554
 AA' NZ     : 3.347e+06
 Factor NZ  : 7.393e+06 (roughly 100 MB of memory)
 Factor Ops : 1.273e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.64095243e+07  1.55585349e+08  8.60e+04 2.05e+01  7.35e+04     5s
   1  -1.24209953e+07  1.39191751e+08  5.97e+04 5.74e+01  5.07e+04     5s
   2  -4.11558934e+06  1.04611123e+08  1.96e+04 4.99e-01  1.77e+04     5s
   3  -8.06389342e+05  7.63307942e+07  1.77e+03 1.26e+00  1.97e+03     5s
   4  -4.73005481e+05  4.67026841e+07  3.43e+02 5.82e-01  5.58e+02     5s
   5  -3.74343277e+05  2.44892535e+07  9.70e+01 2.50e-01  2.20e+02     5s
   6  -2.95666169e+05  1.71224099e+07  3.44e+01 1.64e-01  1.29e+02     5s
   7  -1.77942324e+05  1.34581102e+07  6.04e+00 1.25e-01  8.80e+01     5s
   8  -1.26931818e+05  6.58652695e+06  2.11e+00 5.99e-02  4.24e+01     5s
   9  -1.01877663e+05  4.27511874e+06  1.42e+00 3.87e-02  2.75e+01     5s
  10  -7.90450422e+04  1.62787510e+06  8.50e-01 1.47e-02  1.07e+01     5s
  11  -4.65978055e+04  4.97568560e+05  3.75e-01 4.08e-03  3.40e+00     5s
  12  -2.66889858e+04  2.19511041e+05  1.81e-01 2.04e-03  1.54e+00     5s
  13  -1.84224445e+04  1.30602562e+05  1.22e-01 1.24e-03  9.30e-01     6s
  14  -1.17457908e+04  8.82244286e+04  9.20e-02 1.51e-03  6.24e-01     6s
  15  -6.91279489e+03  7.43875570e+04  7.75e-02 1.39e-03  5.07e-01     6s
  16  -1.33777305e+03  5.24121178e+04  5.87e-02 1.86e-03  3.35e-01     6s
  17   2.69740817e+03  4.18783849e+04  4.64e-02 1.55e-03  2.44e-01     6s
  18   5.72632726e+03  3.58424216e+04  3.72e-02 1.22e-03  1.88e-01     6s
  19   8.95370676e+03  2.87782302e+04  2.78e-02 1.57e-03  1.24e-01     6s
  20   1.05835568e+04  2.69537480e+04  2.33e-02 1.24e-03  1.02e-01     6s
  21   1.16599273e+04  2.41183056e+04  2.02e-02 8.24e-04  7.78e-02     6s
  22   1.40467017e+04  2.25290991e+04  1.38e-02 5.44e-04  5.29e-02     6s
  23   1.59566545e+04  2.12834929e+04  8.84e-03 3.12e-04  3.32e-02     6s
  24   1.73041264e+04  2.07255339e+04  5.39e-03 2.06e-04  2.14e-02     6s
  25   1.75100200e+04  2.04726815e+04  4.88e-03 1.61e-04  1.85e-02     7s
  26   1.80634681e+04  2.01638264e+04  3.51e-03 1.05e-04  1.31e-02     7s
  27   1.81661771e+04  2.00785500e+04  3.25e-03 8.82e-05  1.19e-02     7s
  28   1.86515268e+04  1.98851476e+04  2.07e-03 5.55e-05  7.70e-03     7s
  29   1.89027701e+04  1.98085132e+04  1.45e-03 4.36e-05  5.65e-03     7s
  30   1.91153795e+04  1.96977957e+04  9.40e-04 2.98e-05  3.63e-03     7s
  31   1.91397168e+04  1.96633060e+04  8.83e-04 2.34e-05  3.27e-03     7s
  32   1.92218695e+04  1.96416476e+04  6.96e-04 1.92e-05  2.62e-03     7s
  33   1.92854013e+04  1.95939892e+04  5.53e-04 1.05e-05  1.93e-03     7s
  34   1.94049735e+04  1.95721533e+04  2.90e-04 6.26e-06  1.04e-03     8s
  35   1.94540586e+04  1.95597535e+04  1.79e-04 3.87e-06  6.60e-04     8s
  36   1.94589588e+04  1.95549498e+04  1.67e-04 3.00e-06  5.99e-04     8s
  37   1.94927194e+04  1.95506775e+04  9.36e-05 2.20e-06  3.62e-04     8s
  38   1.95068401e+04  1.95446587e+04  6.45e-05 1.07e-06  2.36e-04     8s
  39   1.95227862e+04  1.95421193e+04  3.05e-05 7.06e-07  1.21e-04     8s
  40   1.95255745e+04  1.95417384e+04  2.47e-05 6.32e-07  1.01e-04     8s
  41   1.95258819e+04  1.95414744e+04  2.41e-05 5.80e-07  9.73e-05     8s
  42   1.95306132e+04  1.95402693e+04  1.45e-05 3.15e-07  6.03e-05     8s
  43   1.95334488e+04  1.95386586e+04  8.90e-06 1.65e-06  3.25e-05     9s
  44   1.95340734e+04  1.95383590e+04  7.70e-06 5.00e-07  2.68e-05     9s
  45   1.95361833e+04  1.95383202e+04  3.58e-06 4.16e-07  1.33e-05     9s
  46   1.95366789e+04  1.95381764e+04  2.63e-06 1.33e-07  9.35e-06     9s
  47   1.95380428e+04  1.95381345e+04  7.66e-08 1.85e-07  5.72e-07     9s
  48   1.95381276e+04  1.95381282e+04  1.63e-08 7.42e-08  3.79e-09     9s
  49   1.95381279e+04  1.95381282e+04  1.39e-06 1.54e-08  2.03e-09     9s
  50   1.95381282e+04  1.95381282e+04  7.08e-09 3.01e-08  8.56e-12     9s

Barrier solved model in 50 iterations and 9.25 seconds (8.01 work units)
Optimal objective 1.95381282e+04


Root crossover log...

   76188 DPushes remaining with DInf 0.0000000e+00                 9s
   22790 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                12s

    1074 PPushes remaining with PInf 2.8200571e-07                12s
       0 PPushes remaining with PInf 0.0000000e+00                12s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.2502281e-10     12s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   32381    1.9538128e+04   0.000000e+00   0.000000e+00     12s
   32381    1.9538128e+04   0.000000e+00   0.000000e+00     13s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 1.953813e+04, 32381 iterations, 8.87 seconds (10.67 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 19538.1282    0  224 -171217.09 19538.1282   111%     -   13s
H    0     0                    -163492.0412 19538.1282   112%     -   13s
H    0     0                    -120953.3489 19538.1282   116%     -   13s
H    0     0                    -97997.55129 19538.1282   120%     -   13s
H    0     0                    -96586.72264 19538.1282   120%     -   13s
H    0     0                    -96431.57274 19538.1282   120%     -   13s
H    0     0                    -95835.98558 19538.1282   120%     -   13s
H    0     0                    -66821.86209 19538.1282   129%     -   13s
H    0     0                    -20118.04901 19538.1282   197%     -   14s
H    0     0                    -20067.33329 19538.1282   197%     -   14s
H    0     0                    -19482.98079 19538.1282   200%     -   14s
H    0     0                    -19096.60252 15187.3034   180%     -   62s
H    0     0                    -16434.02582 15187.3034   192%     -   62s
H    0     0                    -16134.30383 15187.3034   194%     -   62s
     0     0 15158.5525    0  382 -16134.304 15158.5525   194%     -   62s
H    0     0                    -11472.02014 15158.5525   232%     -   63s
H    0     0                    -11227.70011 15158.5525   235%     -   63s
H    0     0                    -11191.08495 15158.5525   235%     -   63s
     0     0 14052.7601    0  384 -11191.085 14052.7601   226%     -   90s
     0     0 14052.7601    0  380 -11191.085 14052.7601   226%     -   98s
     0     0 14052.7601    0  382 -11191.085 14052.7601   226%     -   99s
     0     0 14052.7601    0  380 -11191.085 14052.7601   226%     -  100s
     0     0 14052.7601    0  382 -11191.085 14052.7601   226%     -  101s
H    0     0                    -10487.69072 11805.4089   213%     -  155s
H    0     0                    -9391.974426 11805.4089   226%     -  155s
H    0     0                    -9322.773682 11805.4089   227%     -  155s
     0     0 11706.8230    0  483 -9322.7737 11706.8230   226%     -  156s
     0     0 11061.6394    0  499 -9322.7737 11061.6394   219%     -  191s
H    0     0                    -8904.762021 10926.9377   223%     -  207s
H    0     0                    -8820.663964 10926.9377   224%     -  207s
     0     0 10926.9377    0  507 -8820.6640 10926.9377   224%     -  207s
     0     0 10798.7410    0  476 -8820.6640 10798.7410   222%     -  221s
     0     0 10751.8160    0  495 -8820.6640 10751.8160   222%     -  230s
     0     0 10729.1317    0  499 -8820.6640 10729.1317   222%     -  239s
     0     0 10601.9960    0  497 -8820.6640 10601.9960   220%     -  251s
     0     0 10586.5431    0  502 -8820.6640 10586.5431   220%     -  254s
     0     0 10578.3470    0  504 -8820.6640 10578.3470   220%     -  258s
     0     0 10573.8854    0  502 -8820.6640 10573.8854   220%     -  260s
     0     0 10541.0332    0  505 -8820.6640 10541.0332   220%     -  266s
     0     0 10496.5744    0  487 -8820.6640 10496.5744   219%     -  272s
     0     0 10472.2824    0  512 -8820.6640 10472.2824   219%     -  278s
     0     0 10468.5306    0  498 -8820.6640 10468.5306   219%     -  281s
     0     0 10463.9650    0  502 -8820.6640 10463.9650   219%     -  283s
     0     0 10459.8374    0  500 -8820.6640 10459.8374   219%     -  286s
     0     0 10454.0252    0  497 -8820.6640 10454.0252   219%     -  288s
     0     0 10450.3759    0  509 -8820.6640 10450.3759   218%     -  290s
     0     0 10449.7279    0  506 -8820.6640 10449.7279   218%     -  292s
     0     0 9079.79066    0  482 -8820.6640 9079.79066   203%     -  344s
     0     0 8714.31187    0  445 -8820.6640 8714.31187   199%     -  370s
     0     0 8552.98207    0  516 -8820.6640 8552.98207   197%     -  385s
     0     0 8429.22686    0  524 -8820.6640 8429.22686   196%     -  397s
     0     0 8380.01662    0  516 -8820.6640 8380.01662   195%     -  407s
     0     0 8335.42596    0  502 -8820.6640 8335.42596   194%     -  418s
H    0     0                    -8742.834250 8297.32243   195%     -  429s
     0     0 8297.32243    0  432 -8742.8343 8297.32243   195%     -  429s
H    0     0                    -8635.037769 8228.83370   195%     -  440s
H    0     0                    -8493.272443 8228.83370   197%     -  440s
     0     0 8228.83370    0  432 -8493.2724 8228.83370   197%     -  440s
H    0     0                    -8399.273880 8201.09841   198%     -  449s
     0     0 8201.09841    0  423 -8399.2739 8201.09841   198%     -  449s
     0     0 8170.10260    0  433 -8399.2739 8170.10260   197%     -  456s
     0     0 8160.78717    0  423 -8399.2739 8160.78717   197%     -  460s
H    0     0                    -8300.824060 8139.73910   198%     -  468s
     0     0 8139.73910    0  428 -8300.8241 8139.73910   198%     -  468s
     0     0 8135.85415    0  427 -8300.8241 8135.85415   198%     -  471s
     0     0 8129.62323    0  428 -8300.8241 8129.62323   198%     -  475s
     0     0 8126.87806    0  430 -8300.8241 8126.87806   198%     -  476s
     0     0 8118.80120    0  441 -8300.8241 8118.80120   198%     -  480s
     0     0 8116.99383    0  436 -8300.8241 8116.99383   198%     -  484s
     0     0 8114.50441    0  444 -8300.8241 8114.50441   198%     -  486s
     0     0 8114.10654    0  445 -8300.8241 8114.10654   198%     -  487s
H    0     0                    -6780.748455 7788.33274   215%     -  527s
H    0     0                    -6644.304209 7788.33274   217%     -  527s
H    0     0                    -6629.409947 7788.33274   217%     -  527s
     0     0 7788.33274    0  444 -6629.4099 7788.33274   217%     -  527s
H    0     0                    -6457.236362 7788.25117   221%     -  528s
H    0     0                    -6296.949570 7788.25117   224%     -  529s
H    0     0                    -6213.094214 7788.25117   225%     -  529s
H    0     0                    -6182.396438 7788.25117   226%     -  529s
     0     0 7647.23345    0  434 -6182.3964 7647.23345   224%     -  552s
     0     0 7572.41480    0  437 -6182.3964 7572.41480   222%     -  565s
     0     0 7550.39899    0  440 -6182.3964 7550.39899   222%     -  572s
     0     0 7537.61897    0  439 -6182.3964 7537.61897   222%     -  578s
     0     0 7533.98790    0  442 -6182.3964 7533.98790   222%     -  582s
     0     0 7526.23097    0  437 -6182.3964 7526.23097   222%     -  590s
     0     0 7490.80301    0  620 -6182.3964 7490.80301   221%     -  601s
     0     0 7467.68117    0  467 -6182.3964 7467.68117   221%     -  609s
     0     0 7457.82960    0  470 -6182.3964 7457.82960   221%     -  613s
     0     0 7445.94442    0  522 -6182.3964 7445.94442   220%     -  618s
     0     0 7429.36399    0  441 -6182.3964 7429.36399   220%     -  623s
     0     0 7421.83205    0  475 -6182.3964 7421.83205   220%     -  625s
     0     0 7413.71854    0  442 -6182.3964 7413.71854   220%     -  628s
     0     0 7409.15798    0  440 -6182.3964 7409.15798   220%     -  631s
     0     0 7407.89196    0  445 -6182.3964 7407.89196   220%     -  633s
     0     0 7323.15456    0  560 -6182.3964 7323.15456   218%     -  654s
     0     0 7301.35494    0  575 -6182.3964 7301.35494   218%     -  662s
     0     0 7284.07942    0  445 -6182.3964 7284.07942   218%     -  669s
     0     0 7260.87256    0  474 -6182.3964 7260.87256   217%     -  676s
     0     0 7256.60381    0  477 -6182.3964 7256.60381   217%     -  679s
     0     0 7255.11837    0  478 -6182.3964 7255.11837   217%     -  680s
     0     0 7187.68516    0  541 -6182.3964 7187.68516   216%     -  697s
H    0     0                    -6077.149486 7186.36139   218%     -  702s
     0     0 7164.85582    0  648 -6077.1495 7164.85582   218%     -  712s
     0     0 7149.52001    0  639 -6077.1495 7149.52001   218%     -  720s
     0     0 7144.82281    0  663 -6077.1495 7144.82281   218%     -  724s
     0     0 7142.47150    0  610 -6077.1495 7142.47150   218%     -  727s
     0     0 7137.76421    0  676 -6077.1495 7137.76421   217%     -  730s
     0     0 7135.76536    0  674 -6077.1495 7135.76536   217%     -  732s
     0     0 7135.30302    0  676 -6077.1495 7135.30302   217%     -  734s
     0     0 7118.90018    0  458 -6077.1495 7118.90018   217%     -  744s
     0     0 7116.65479    0  461 -6077.1495 7116.65479   217%     -  747s
     0     0 7115.34601    0  457 -6077.1495 7115.34601   217%     -  749s
     0     0 7105.60510    0  461 -6077.1495 7105.60510   217%     -  755s
H    0     0                    -6058.311317 7103.55530   217%     -  757s
H    0     0                    -6056.010154 7103.55530   217%     -  757s
     0     0 7103.55530    0  459 -6056.0102 7103.55530   217%     -  758s
     0     0 7094.86614    0  472 -6056.0102 7094.86614   217%     -  762s
     0     0 7094.14568    0  468 -6056.0102 7094.14568   217%     -  764s
     0     0 7089.88850    0  458 -6056.0102 7089.88850   217%     -  768s
     0     0 7089.51298    0  458 -6056.0102 7089.51298   217%     -  771s
H    0     0                    -6023.886824 7089.17462   218%     -  874s
H    0     0                    -5978.855792 7089.17462   219%     -  879s
H    0     2                    -5504.929542 7089.17462   229%     -  885s
     0     2 7089.17462    0  458 -5504.9295 7089.17462   229%     -  885s
     1     4 7041.56909    1  448 -5504.9295 7089.05376   229%  3125  899s
     3     7 6800.91691    2  460 -5504.9295 7039.39615   228%  8455  920s
     6    13 6614.90295    3  456 -5504.9295 6799.83111   224% 10520  943s
    12    26 6426.51548    4  467 -5504.9295 6799.83111   224% 11570  966s
    25    39 5760.02360    5  447 -5504.9295 6426.01314   217% 15276 1033s
H   38    71                    -5408.682949 6426.01314   219% 13220 1164s
H   44    71                    -5387.498778 6426.01314   219% 13661 1164s
H   47    71                    -5327.130637 6426.01314   221% 13665 1164s
    70   153 4746.54981    7  426 -5327.1306 6028.31784   213% 16630 1266s
H  152   252                    -5037.929944 6027.80695   220% 10562 1310s
H  157   252                    -4927.703896 6027.80695   222% 10463 1310s
H  240   252                    -4916.425345 6027.80695   223%  8593 1310s
   251   329 3794.40141   12  276 -4916.4253 6027.80695   223%  8426 1358s
   332   404 3625.97848   13  265 -4916.4253 6027.80695   223%  7752 1388s
H  357   404                    -4890.429608 6027.80695   223%  7565 1388s
   415   482 1931.13033   14  232 -4890.4296 6027.80695   223%  7253 1413s
H  497   525                    -4857.898815 6027.80695   224%  7045 1439s
H  516   525                    -4770.506819 6027.80695   226%  7014 1439s
H  531   525                    -4260.010959 6027.80695   241%  6947 1439s
   550   569  637.14421   17  397 -4260.0110 6027.80695   241%  7020 1461s
   610   607 -292.91745   18  397 -4260.0110 6027.80695   241%  6984 1483s
H  621   607                    -4230.778982 6027.80695   242%  6923 1483s
H  627   607                    -4226.268864 6027.80695   243%  6927 1483s
H  645   607                    -3764.352430 6027.80695   260%  6924 1483s
   676   649 -762.72294   19  296 -3764.3524 6027.80695   260%  6915 1507s
H  738   690                    -3587.832976 6027.80695   268%  7021 1527s
H  781   690                    -3548.280965 6027.80695   270%  6939 1527s
   797   720 -2089.8104   23  305 -3548.2810 6027.80695   270%  6941 1550s
   881   773 -2588.0840   25  307 -3548.2810 6027.80695   270%  6769 1575s
H  887   773                    -3539.407355 6027.80695   270%  6735 1575s
   968   799     cutoff   31      -3539.4074 6027.80695   270%  6535 1602s
H 1054   819                    -3519.292108 6027.80695   271%  6407 1630s
H 1077   819                    -3505.771858 6027.80695   272%  6441 1630s
H 1103   819                    -3481.590356 6027.80695   273%  6380 1630s
  1104   860     cutoff   23      -3481.5904 6027.80695   273%  6403 1653s
  1201   892     cutoff   22      -3481.5904 6027.80695   273%  6301 1678s
H 1263   892                    -3433.437955 6027.80695   276%  6219 1678s
H 1288   892                    -3398.813976 6027.80695   277%  6223 1678s
  1289   939 -1248.3182   16  348 -3398.8140 6027.80695   277%  6241 1702s
  1370   995 -1459.9467   17  345 -3398.8140 6027.80695   277%  6332 1725s
  1458  1020 -1743.0655   20  312 -3398.8140 6027.80695   277%  6429 1751s
H 1461  1020                    -3341.859474 6027.80695   280%  6417 1751s
H 1462  1020                    -3328.533049 6027.80695   281%  6418 1751s
H 1465  1020                    -3212.895049 6027.80695   288%  6441 1751s
H 1467  1020                    -3177.778623 6027.80695   290%  6435 1751s
H 1490  1020                    -3164.325208 6027.80695   290%  6467 1751s
  1493  1044 -1912.6378   21  309 -3164.3252 6027.80695   290%  6467 1774s
  1533  1084     cutoff   22      -3164.3252 6027.80695   290%  6523 1798s
  1601  1117 -2171.8572   23  318 -3164.3252 6027.80695   290%  6564 1824s
  1680  1173 -2435.7571   25  256 -3164.3252 6027.80695   290%  6590 1852s
  1774  1234 -2678.6255   32  244 -3164.3252 6027.80695   290%  6578 1879s
  1873  1331 -1053.1956   10  331 -3164.3252 5388.76595   270%  6640 1910s
  1994  1371 -1926.2874   11  374 -3164.3252 5388.76595   270%  6661 1939s
  2054  1427     cutoff   12      -3164.3252 5056.21762   260%  6659 1967s
  2174  1493 -2276.2739   13  343 -3164.3252 5056.21762   260%  6556 1999s
  2288  1582 -2837.2238   14  346 -3164.3252 5056.21762   260%  6583 2034s
  2405  1675 3579.06592   16  453 -3164.3252 5056.21762   260%  6620 2069s
  2528  1740 1146.56408   18  346 -3164.3252 5056.21762   260%  6672 2108s
  2679  1829  213.55361   21  263 -3164.3252 4745.03392   250%  6642 2145s
  2821  1905 -890.35444   32  197 -3164.3252 4745.03392   250%  6646 2181s
  2937  2000 -2002.4018   41  125 -3164.3252 4728.40274   249%  6619 2221s
  3130  2123     cutoff   34      -3164.3252 4697.60515   248%  6592 2260s
  3297  2210     cutoff    7      -3164.3252 4697.60515   248%  6631 2305s
  3458  2252  936.05261    7  399 -3164.3252 4697.60515   248%  6654 2347s
  3548  2302  461.88674    8  346 -3164.3252 4697.60515   248%  6668 2393s
  3698  2372   11.74800    9  433 -3164.3252 4384.36674   239%  6719 2447s
  3840  2473 -1410.3060   12  388 -3164.3252 4380.59735   238%  6834 2497s
  4021  2571 -2220.3348   18  348 -3164.3252 4376.43954   238%  6921 2552s
  4218  2674     cutoff   24      -3164.3252 4376.43954   238%  6977 2612s
H 4395  2670                    -3111.393329 4244.09841   236%  7054 2645s
  4396  2671 -318.78536   21  458 -3111.3933 4244.09841   236%  7052 2785s
  4398  2672 1429.66445   14  162 -3111.3933 4244.09841   236%  7049 2799s
  4399  2673 -1014.3221   22  435 -3111.3933 4244.09841   236%  7047 2894s
  4400  2674 -2334.7746   30  408 -3111.3933 4244.09841   236%  7046 2954s
  4401  2674 -998.42890   31  460 -3111.3933 4244.09841   236%  7044 2994s
  4402  2675 -1652.1597   32  538 -3111.3933 4244.09841   236%  7042 3025s
  4403  2676 -643.91708   44  447 -3111.3933 4244.09841   236%  7041 3051s
  4404  2676 2830.59258    9  458 -3111.3933 4244.09841   236%  7039 3069s
  4405  2677 1005.37801   18  468 -3111.3933 4244.09841   236%  7038 3085s
  4406  2678 -139.71270   23  463 -3111.3933 4244.09841   236%  7036 3099s
  4407  2678  215.24821   24  467 -3111.3933 4244.09841   236%  7034 3106s
  4408  2679  381.33350    9  458 -3111.3933 4244.09841   236%  7033 3117s
  4409  2680 1013.98023   16  488 -3111.3933 4244.09841   236%  7031 3133s
  4410  2680 -1171.4342   32  460 -3111.3933 4244.09841   236%  7030 3152s
  4411  2681 -1024.5123   23  470 -3111.3933 4244.09841   236%  7028 3163s
  4412  2682 -1099.7263   25  469 -3111.3933 4244.09841   236%  7026 3176s
  4413  2682 2842.59873   17  463 -3111.3933 4244.09841   236%  7025 3185s
H 4413  2547                    -3007.945723 4244.09841   241%  7025 3209s
  4415  2549 -3007.9457   25  483 -3007.9457 4244.09841   241%  7022 3220s
  4416  2549 1371.95621   16  508 -3007.9457 4244.09841   241%  7020 3230s
  4417  2550 1354.70684   13  517 -3007.9457 4244.09841   241%  7018 3239s
  4418  2551  -37.45345   15  523 -3007.9457 4244.09841   241%  7017 3246s
  4419  2551 1385.11978   13  483 -3007.9457 4244.09841   241%  7015 3263s
  4420  2552 -1365.2403   21  529 -3007.9457 4244.09841   241%  7014 3272s
  4421  2553 -418.34101   16  484 -3007.9457 4244.09841   241%  7012 3280s
  4422  2553 3621.37032   14  537 -3007.9457 4244.09841   241%  7010 3308s
  4423  2554 -2188.3145   26  591 -3007.9457 4244.09841   241%  7009 3319s
  4424  2555 1342.72989    9  566 -3007.9457 4244.09841   241%  7007 3331s
  4425  2555 -1128.9703   34  664 -3007.9457 4244.09841   241%  7006 3355s
  4426  2556  885.06862   16  672 -3007.9457 4244.09841   241%  7004 3363s
H 4426  2428                    -3007.754837 4244.09841   241%  7004 3373s
H 4426  2306                    -2986.562798 4244.09841   242%  7004 3373s
H 4426  2190                    -2982.100097 4244.09841   242%  7004 3373s
H 4426  2080                    -2962.814913 4244.09841   243%  7004 3373s
  4428  2081 -2845.2995   37  532 -2962.8149 4244.09841   243%  7001 3399s
  4429  2082 -1270.8589   29  579 -2962.8149 4244.09841   243%  6999 3411s
  4430  2083 -2303.2279   44  599 -2962.8149 4244.09841   243%  6998 3418s
  4431  2083 -788.37915   29  565 -2962.8149 4244.09841   243%  6996 3428s
  4432  2084 -410.55093   33  553 -2962.8149 4244.09841   243%  6995 3454s
  4433  2085 2606.85720   18  559 -2962.8149 4244.09841   243%  6993 3465s
  4434  2085 -2782.5396   53  562 -2962.8149 4244.09841   243%  6991 3476s
  4435  2086  431.09483   27  552 -2962.8149 4244.09841   243%  6990 3491s
  4436  2087 -1911.9294   25  552 -2962.8149 4244.09841   243%  6988 3521s

Cutting planes:
  Learned: 1
  Gomory: 3
  Implied bound: 12
  Projected implied bound: 90
  MIR: 318
  Mixing: 1
  Flow cover: 630
  RLT: 28
  Relax-and-lift: 62

Explored 4436 nodes (31930252 simplex iterations) in 3600.02 seconds (5657.28 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -2962.81 -2982.1 -2986.56 ... -3328.53

Time limit reached
Best objective -2.962814912766e+03, best bound 4.244098414190e+03, gap 243.2455%
  WARNING: Time limit reached. Using best solution found (gap: 243.25%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.09s
  Master Objective (UB) = -2962.81, θ = 131621.42
  Upper Bound (UB) = -2962.81

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 131621.42
  [DEBUG]   ✓ Scenario 0: θ = 131621.42 ≤ Q = 131621.42 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 131621.42 ≤ Q = 131621.42 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 131621.42 ≤ Q = 131621.42 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 131621.42 ≤ Q = 131621.42 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 131621.42 ≤ Q = 131621.42 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 131621.42 ≤ Q = 131621.42 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 131621.42 ≤ Q = 131621.42 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 131621.42 ≤ Q = 131621.42 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 131621.42 ≤ Q = 131621.42 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 131621.42 ≤ Q = 131621.42 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 131621.42 ≤ Q = 131621.42 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 11] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0xb61aaf5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xf49e550b
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [7e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.381045e+13
Presolve removed 2625 rows and 1918 columns
Presolve time: 0.01s
Presolved: 468 rows, 471 columns, 1319 nonzeros
Found heuristic solution: objective 6505436.8926
Variable types: 319 continuous, 152 integer (152 binary)

Root relaxation: objective -1.350931e+05, 244 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -135093.11    0  127 6505436.89 -135093.11   102%     -    0s
H    0     0                    -101965.5027 -135093.11  32.5%     -    0s
     0     0 -115701.33    0   84 -101965.50 -115701.33  13.5%     -    0s
H    0     0                    -112201.8906 -115613.59  3.04%     -    0s
     0     0 -115488.14    0   82 -112201.89 -115488.14  2.93%     -    0s
     0     0 -115467.77    0   82 -112201.89 -115467.77  2.91%     -    0s
     0     0 -114893.85    0   66 -112201.89 -114893.85  2.40%     -    0s
H    0     0                    -113177.1284 -114893.85  1.52%     -    0s
H    0     0                    -113305.4193 -114789.99  1.31%     -    0s
     0     0 -114789.99    0   70 -113305.42 -114789.99  1.31%     -    0s
     0     0 -114782.69    0   70 -113305.42 -114782.69  1.30%     -    0s
H    0     0                    -113522.0295 -114782.69  1.11%     -    0s
     0     0 -114669.86    0   10 -113522.03 -114669.86  1.01%     -    0s
H    0     0                    -114415.5915 -114668.69  0.22%     -    0s
     0     0 -114659.69    0   16 -114415.59 -114659.69  0.21%     -    0s
     0     0 -114641.13    0    7 -114415.59 -114641.13  0.20%     -    0s
     0     0 -114632.02    0    3 -114415.59 -114632.02  0.19%     -    0s
H    0     0                    -114599.4818 -114632.02  0.03%     -    0s
     0     0 -114630.04    0    4 -114599.48 -114630.04  0.03%     -    0s
     0     0 -114630.04    0    9 -114599.48 -114630.04  0.03%     -    0s
H    0     0                    -114601.7426 -114630.04  0.02%     -    0s
H    0     0                    -114619.7080 -114630.04  0.01%     -    0s

Explored 1 nodes (590 simplex iterations) in 0.07 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -114620 -114602 -114599 ... 6.50544e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.146197079583e+05, best bound -1.146300418691e+05, gap 0.0090%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 122856.96
  Scenario: 12 demand increases, 48 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -114619.71
  [DEBUG]   S×d_nominal = 237476.66
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 237476.66 + -114619.71 = 122856.96
  [DEBUG]   Current θ from Master = 131621.42
  [DEBUG]   ⚠️  Z_SP ≤ θ by 8764.46 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -11727.27
  Lower Bound (LB) = -6521.46
  Gap (UB-LB) = 3558.6460, Absolute Gap = 3558.6460, Relative Gap = 1.201103
  Not converged yet (gap = 3558.65 > ε = 200)

  [DEBUG] Adding NEW scenario 11 to Master Problem...
  [DEBUG] New scenario pattern: 12 increases, 48 decreases
    [DEBUG] Scenario 11 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 11 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 11]
    [DEBUG]   - Total constraints in model: 184863
    [DEBUG]   - Total variables in model: 77140
  [DEBUG] Total scenarios in Master: 12
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 12
================================================================================
[Iteration 12] Solving Master Problem...
  Current scenarios in Master: 12
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 184863 rows, 77140 columns and 524147 nonzeros
Model fingerprint: 0x2007a693
Variable types: 74881 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 89688 rows and 36408 columns
Presolve time: 3.50s
Presolved: 95175 rows, 40732 columns, 579191 nonzeros
Variable types: 38473 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -371588.8790
Found heuristic solution: objective -171217.0927

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.29s

Barrier statistics:
 Dense cols : 548
 AA' NZ     : 3.822e+06
 Factor NZ  : 8.556e+06 (roughly 120 MB of memory)
 Factor Ops : 1.542e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.64259221e+07  1.67278895e+08  8.61e+04 2.04e+01  7.31e+04     5s
   1  -1.24676948e+07  1.49874990e+08  5.97e+04 5.56e+01  5.03e+04     5s
   2  -3.77536463e+06  1.12613990e+08  1.77e+04 5.96e-01  1.60e+04     5s
   3  -7.78676746e+05  7.94923102e+07  1.49e+03 7.96e-01  1.70e+03     6s
   4  -4.85018568e+05  3.71243335e+07  3.36e+02 2.47e-01  4.64e+02     6s
   5  -3.69667253e+05  2.23401235e+07  9.20e+01 1.33e-01  1.91e+02     6s
   6  -3.05921308e+05  1.51566085e+07  5.43e+01 8.28e-02  1.19e+02     6s
   7  -1.90816260e+05  1.24818671e+07  1.42e+01 6.60e-02  7.98e+01     6s
   8  -1.20669048e+05  7.76452962e+06  5.39e+00 3.92e-02  4.71e+01     6s
   9  -9.69264026e+04  4.23711528e+06  3.14e+00 2.09e-02  2.55e+01     6s
  10  -8.04107343e+04  1.46218883e+06  2.11e+00 7.05e-03  9.01e+00     6s
  11  -4.81800448e+04  6.78524419e+05  9.46e-01 2.99e-03  4.20e+00     6s
  12  -3.41153674e+04  3.46341563e+05  5.97e-01 1.71e-03  2.19e+00     6s
  13  -2.49479876e+04  1.92095384e+05  3.51e-01 1.19e-03  1.25e+00     6s
  14  -1.88350965e+04  1.13670651e+05  2.56e-01 1.57e-03  7.62e-01     6s
  15  -1.39813203e+04  7.74820342e+04  1.99e-01 2.20e-03  5.26e-01     7s
  16  -8.64934342e+03  6.00830750e+04  1.56e-01 2.76e-03  3.95e-01     7s
  17  -5.76245607e+03  5.64999049e+04  1.39e-01 3.03e-03  3.58e-01     7s
  18  -1.67362358e+03  4.44979450e+04  1.14e-01 2.63e-03  2.65e-01     7s
  19   4.32786487e+03  3.59214493e+04  7.87e-02 1.82e-03  1.81e-01     7s
  20   7.07229415e+03  2.97858756e+04  6.33e-02 2.16e-03  1.30e-01     7s
  21   8.60465535e+03  2.68587525e+04  5.50e-02 1.67e-03  1.05e-01     7s
  22   1.10441138e+04  2.57080145e+04  4.24e-02 1.94e-03  8.42e-02     7s
  23   1.22642870e+04  2.34680700e+04  3.61e-02 1.93e-03  6.44e-02     7s
  24   1.42430608e+04  2.23771886e+04  2.52e-02 1.41e-03  4.67e-02     7s
  25   1.53755311e+04  2.12529529e+04  1.96e-02 8.23e-04  3.38e-02     7s
  26   1.64972174e+04  2.08010405e+04  1.42e-02 5.92e-04  2.47e-02     8s
  27   1.77380812e+04  2.05536738e+04  8.34e-03 4.77e-04  1.62e-02     8s
  28   1.80280662e+04  2.02759582e+04  7.02e-03 3.46e-04  1.29e-02     8s
  29   1.85245771e+04  2.00779204e+04  4.69e-03 2.47e-04  8.92e-03     8s
  30   1.85960687e+04  1.99641207e+04  4.36e-03 1.95e-04  7.86e-03     8s
  31   1.87495732e+04  1.98361327e+04  3.64e-03 1.36e-04  6.24e-03     8s
  32   1.88005895e+04  1.97437726e+04  3.38e-03 9.70e-05  5.42e-03     8s
  33   1.90123965e+04  1.96885834e+04  2.37e-03 7.96e-05  3.89e-03     8s
  34   1.92209599e+04  1.96353938e+04  1.39e-03 5.09e-05  2.38e-03     8s
  35   1.92822308e+04  1.95718966e+04  1.12e-03 2.36e-05  1.67e-03     9s
  36   1.93961114e+04  1.95625144e+04  6.14e-04 1.62e-05  9.57e-04     9s
  37   1.94468047e+04  1.95601870e+04  3.89e-04 1.47e-05  6.52e-04     9s
  38   1.94553811e+04  1.95548679e+04  3.50e-04 1.13e-05  5.72e-04     9s
  39   1.94975799e+04  1.95471108e+04  1.65e-04 6.04e-06  2.85e-04     9s
  40   1.95126458e+04  1.95405024e+04  9.93e-05 2.01e-06  1.60e-04     9s
  41   1.95181431e+04  1.95391025e+04  7.70e-05 4.41e-06  1.20e-04     9s
  42   1.95267927e+04  1.95382583e+04  4.07e-05 2.27e-06  6.59e-05     9s
  43   1.95347229e+04  1.95374553e+04  9.21e-06 4.59e-06  1.57e-05     9s
  44   1.95358119e+04  1.95373895e+04  5.17e-06 3.26e-06  9.06e-06     9s
  45   1.95366722e+04  1.95372326e+04  1.94e-06 2.31e-07  3.22e-06    10s
  46   1.95372013e+04  1.95372113e+04  4.19e-07 8.79e-08  5.72e-08    10s
  47   1.95372014e+04  1.95372113e+04  6.00e-07 8.88e-08  5.70e-08    10s
  48   1.95372017e+04  1.95372114e+04  4.56e-06 8.47e-08  5.53e-08    10s
  49   1.95372018e+04  1.95372114e+04  4.56e-06 7.97e-08  5.52e-08    10s
  50   1.95372020e+04  1.95372115e+04  4.36e-06 7.43e-08  5.50e-08    10s
  51   1.95372101e+04  1.95372108e+04  3.77e-07 1.24e-07  4.45e-09    10s
  52   1.95372106e+04  1.95372108e+04  1.61e-07 4.13e-08  1.28e-09    10s
  53   1.95372106e+04  1.95372108e+04  1.66e-06 3.01e-08  1.12e-09    10s

Barrier solved model in 53 iterations and 10.32 seconds (8.80 work units)
Optimal objective 1.95372106e+04


Root crossover log...

   85055 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                12s

   10338 PPushes remaining with PInf 4.5088474e-05                12s
       0 PPushes remaining with PInf 4.5265288e-08                14s

  Push phase complete: Pinf 4.5265288e-08, Dinf 3.3129423e+06     14s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   51699    1.9537211e+04   0.000000e+00   3.312942e+06     14s
   52569    1.9537211e+04   0.000000e+00   7.329238e+04     15s
   55687    1.9537211e+04   0.000000e+00   0.000000e+00     19s
   55687    1.9537211e+04   0.000000e+00   0.000000e+00     20s
Concurrent spin time: 1.11s

Solved with barrier

Root relaxation: objective 1.953721e+04, 55687 iterations, 16.41 seconds (22.02 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 19537.2108    0  160 -171217.09 19537.2108   111%     -   21s
H    0     0                    -167206.9795 19537.2108   112%     -   21s
H    0     0                    -161182.3381 19537.2108   112%     -   21s
H    0     0                    -143008.6637 19537.2108   114%     -   22s
H    0     0                    -68150.24111 19537.2108   129%     -   22s
H    0     0                    -20448.95691 19537.2108   196%     -   22s
H    0     0                    -19482.98079 19537.2108   200%     -   22s
H    0     0                    -17171.55573 16055.8063   194%     -   98s
H    0     0                    -16925.30586 16055.8063   195%     -   98s
     0     0 15965.4519    0  376 -16925.306 15965.4519   194%     -   98s
H    0     0                    -16215.21948 15965.4519   198%     -   99s
H    0     0                    -16164.50376 15965.4519   199%     -   99s
H    0     0                    -14597.51047 15965.4519   209%     -   99s
H    0     0                    -14236.95998 15965.4519   212%     -   99s
     0     0 15916.6427    0  376 -14236.960 15916.6427   212%     -  118s
     0     0 15916.6427    0  372 -14236.960 15916.6427   212%     -  129s
     0     0 15916.6427    0  370 -14236.960 15916.6427   212%     -  131s
     0     0 15916.6427    0  372 -14236.960 15916.6427   212%     -  136s
     0     0 15916.6427    0  372 -14236.960 15916.6427   212%     -  136s
     0     0 13452.7079    0  426 -14236.960 13452.7079   194%     -  199s
H    0     0                    -10551.93809 13452.7079   227%     -  199s
     0     0 13128.3537    0  364 -10551.938 13128.3537   224%     -  232s
     0     0 13003.5532    0  432 -10551.938 13003.5532   223%     -  248s
     0     0 12916.2209    0  355 -10551.938 12916.2209   222%     -  265s
     0     0 12865.7800    0  435 -10551.938 12865.7800   222%     -  276s
     0     0 12846.8504    0  372 -10551.938 12846.8504   222%     -  290s
     0     0 12752.4335    0  441 -10551.938 12752.4335   221%     -  306s
     0     0 12740.6278    0  368 -10551.938 12740.6278   221%     -  310s
     0     0 12733.2640    0  366 -10551.938 12733.2640   221%     -  315s
     0     0 12703.3353    0  359 -10551.938 12703.3353   220%     -  322s
     0     0 12690.1233    0  363 -10551.938 12690.1233   220%     -  328s
     0     0 12638.3771    0  448 -10551.938 12638.3771   220%     -  338s
     0     0 12624.2292    0  434 -10551.938 12624.2292   220%     -  346s
     0     0 12619.6244    0  441 -10551.938 12619.6244   220%     -  350s
     0     0 12617.8497    0  448 -10551.938 12617.8497   220%     -  352s
     0     0 12614.9017    0  451 -10551.938 12614.9017   220%     -  356s
     0     0 12604.0427    0  377 -10551.938 12604.0427   219%     -  363s
     0     0 12581.9998    0  443 -10551.938 12581.9998   219%     -  370s
     0     0 12572.6427    0  452 -10551.938 12572.6427   219%     -  377s
     0     0 12567.1330    0  457 -10551.938 12567.1330   219%     -  384s
     0     0 12563.5698    0  457 -10551.938 12563.5698   219%     -  389s
     0     0 12559.9428    0  459 -10551.938 12559.9428   219%     -  392s
     0     0 12554.1904    0  448 -10551.938 12554.1904   219%     -  395s
     0     0 12554.1401    0  451 -10551.938 12554.1401   219%     -  396s
     0     0 10539.0268    0  529 -10551.938 10539.0268   200%     -  490s
H    0     0                    -9976.904862 10538.9605   206%     -  490s
H    0     0                    -9489.534425 10538.9605   211%     -  490s
H    0     0                    -9346.645831 10538.9605   213%     -  490s
H    0     0                    -9295.930116 10538.9605   213%     -  490s
H    0     0                    -9046.368308 10538.9605   216%     -  490s
H    0     0                    -8975.990541 10538.9605   217%     -  490s
H    0     0                    -8809.502831 10159.6193   215%     -  527s
     0     0 10159.6193    0  560 -8809.5028 10159.6193   215%     -  527s
     0     0 10003.8950    0  585 -8809.5028 10003.8950   214%     -  554s
     0     0 9948.24992    0  588 -8809.5028 9948.24992   213%     -  569s
     0     0 9924.84919    0  579 -8809.5028 9924.84919   213%     -  579s
     0     0 9914.09388    0  597 -8809.5028 9914.09388   213%     -  586s
     0     0 9864.25300    0  590 -8809.5028 9864.25300   212%     -  600s
     0     0 9850.14075    0  595 -8809.5028 9850.14075   212%     -  608s
     0     0 9849.16332    0  582 -8809.5028 9849.16332   212%     -  611s
H    0     0                    -8261.403062 8887.72055   208%     -  717s
H    0     0                    -7934.762573 8887.72055   212%     -  717s
H    0     0                    -7916.277546 8887.72055   212%     -  717s
     0     0 8887.72055    0  391 -7916.2775 8887.72055   212%     -  717s
     0     0 8559.16012    0  415 -7916.2775 8559.16012   208%     -  762s
H    0     0                    -7883.469752 8389.46448   206%     -  803s
H    0     0                    -7762.347907 8389.46448   208%     -  803s
     0     0 8389.46448    0  424 -7762.3479 8389.46448   208%     -  803s
     0     0 8244.01332    0  417 -7762.3479 8244.01332   206%     -  839s
     0     0 8212.22343    0  433 -7762.3479 8212.22343   206%     -  856s
H    0     0                    -7436.019788 8125.26533   209%     -  888s
H    0     0                    -7277.541822 8125.26533   212%     -  888s
H    0     0                    -7220.192340 8125.26533   213%     -  888s
H    0     0                    -7154.455682 8125.26533   214%     -  888s
     0     0 8125.26533    0  439 -7154.4557 8125.26533   214%     -  888s
     0     0 8116.33555    0  439 -7154.4557 8116.33555   213%     -  899s
     0     0 8113.95170    0  432 -7154.4557 8113.95170   213%     -  908s
     0     0 8094.50504    0  588 -7154.4557 8094.50504   213%     -  922s
     0     0 8078.03178    0  444 -7154.4557 8078.03178   213%     -  931s
     0     0 8065.32409    0  448 -7154.4557 8065.32409   213%     -  939s
     0     0 8060.89586    0  448 -7154.4557 8060.89586   213%     -  943s
     0     0 8046.82473    0  445 -7154.4557 8046.82473   212%     -  949s
     0     0 8044.28906    0  446 -7154.4557 8044.28906   212%     -  951s
     0     0 8041.21044    0  446 -7154.4557 8041.21044   212%     -  954s
     0     0 8040.29499    0  452 -7154.4557 8040.29499   212%     -  956s
     0     0 7766.38658    0  600 -7154.4557 7766.38658   209%     -  994s
H    0     0                    -7084.411059 7766.21014   210%     -  995s
     0     0 7707.25661    0  607 -7084.4111 7707.25661   209%     - 1010s
     0     0 7638.64068    0  446 -7084.4111 7638.64068   208%     - 1024s
H    0     0                    -6994.130192 7604.88109   209%     - 1035s
     0     0 7604.88109    0  520 -6994.1302 7604.88109   209%     - 1035s
     0     0 7565.28642    0  523 -6994.1302 7565.28642   208%     - 1044s
     0     0 7538.95265    0  522 -6994.1302 7538.95265   208%     - 1051s
H    0     0                    -6819.025365 7530.92480   210%     - 1057s
H    0     0                    -6802.411124 7530.92480   211%     - 1057s
H    0     0                    -6718.182683 7530.92480   212%     - 1057s
H    0     0                    -6694.436397 7530.92480   212%     - 1057s
     0     0 7530.92480    0  529 -6694.4364 7530.92480   212%     - 1057s
     0     0 7525.84297    0  518 -6694.4364 7525.84297   212%     - 1063s
     0     0 7504.15381    0  519 -6694.4364 7504.15381   212%     - 1072s
     0     0 7485.53051    0  554 -6694.4364 7485.53051   212%     - 1082s
     0     0 7475.68091    0  531 -6694.4364 7475.68091   212%     - 1089s
     0     0 7473.53165    0  564 -6694.4364 7473.53165   212%     - 1095s
     0     0 7469.40470    0  559 -6694.4364 7469.40470   212%     - 1098s
     0     0 7464.81676    0  556 -6694.4364 7464.81676   212%     - 1101s
     0     0 7449.45972    0  532 -6694.4364 7449.45972   211%     - 1105s
     0     0 7440.37733    0  547 -6694.4364 7440.37733   211%     - 1111s
     0     0 7435.89329    0  563 -6694.4364 7435.89329   211%     - 1118s
     0     0 7435.20314    0  554 -6694.4364 7435.20314   211%     - 1120s
     0     0 7330.27955    0  477 -6694.4364 7330.27955   209%     - 1137s
H    0     0                    -6693.550685 7330.19530   210%     - 1143s
H    0     0                    -6691.104542 7330.19530   210%     - 1145s
H    0     0                    -6598.429242 7330.19530   211%     - 1145s
     0     0 7302.32270    0  480 -6598.4292 7302.32270   211%     - 1153s
     0     0 7259.88312    0  446 -6598.4292 7259.88312   210%     - 1171s
     0     0 7252.45273    0  452 -6598.4292 7252.45273   210%     - 1180s
     0     0 7234.50507    0  467 -6598.4292 7234.50507   210%     - 1194s
     0     0 7226.85194    0  634 -6598.4292 7226.85194   210%     - 1205s
     0     0 7223.50265    0  477 -6598.4292 7223.50265   209%     - 1211s
     0     0 7222.57265    0  444 -6598.4292 7222.57265   209%     - 1216s
     0     0 7175.67040    0  645 -6598.4292 7175.67040   209%     - 1232s
H    0     0                    -6577.751353 7175.67037   209%     - 1238s
H    0     0                    -6503.544973 7160.56211   210%     - 1250s
H    0     0                    -6499.312773 7160.56211   210%     - 1250s
H    0     0                    -6482.170933 7160.56211   210%     - 1250s
H    0     0                    -6443.829842 7160.56211   211%     - 1250s
     0     0 7160.56211    0  451 -6443.8298 7160.56211   211%     - 1250s
     0     0 7151.22920    0  443 -6443.8298 7151.22920   211%     - 1257s
H    0     0                    -6238.352954 7146.31885   215%     - 1265s
     0     0 7146.31885    0  450 -6238.3530 7146.31885   215%     - 1265s
     0     0 7144.09557    0  456 -6238.3530 7144.09557   215%     - 1270s
     0     0 7142.55799    0  444 -6238.3530 7142.55799   214%     - 1274s
     0     0 7107.64655    0  452 -6238.3530 7107.64655   214%     - 1285s
H    0     0                    -6181.927088 7107.38375   215%     - 1290s
     0     0 7097.32049    0  446 -6181.9271 7097.32049   215%     - 1296s
     0     0 7093.81747    0  448 -6181.9271 7093.81747   215%     - 1299s
     0     0 7086.64445    0  451 -6181.9271 7086.64445   215%     - 1304s
     0     0 7081.13772    0  450 -6181.9271 7081.13772   215%     - 1309s
     0     0 7079.85864    0  452 -6181.9271 7079.85864   215%     - 1311s
     0     0 7075.43457    0  488 -6181.9271 7075.43457   214%     - 1319s
     0     0 7070.46056    0  637 -6181.9271 7070.46056   214%     - 1324s
     0     0 7069.41259    0  638 -6181.9271 7069.41259   214%     - 1326s
     0     0 7063.42034    0  452 -6181.9271 7063.42034   214%     - 1332s
H    0     0                    -6159.510177 7063.38947   215%     - 1346s
H    0     0                    -6159.505980 7063.38947   215%     - 1346s
H    0     0                    -6138.206108 7063.38947   215%     - 1348s
H    0     0                    -6121.117983 7063.38947   215%     - 1348s
     0     0 7060.84861    0  457 -6121.1180 7060.84861   215%     - 1350s
     0     0 7059.94775    0  462 -6121.1180 7059.94775   215%     - 1351s
H    0     0                    -6110.393711 7059.94775   216%     - 1353s
H    0     0                    -6110.316790 7059.94775   216%     - 1353s
H    0     0                    -6108.059860 7055.61339   216%     - 1361s
     0     0 7055.61339    0  464 -6108.0599 7055.61339   216%     - 1361s
     0     0 7052.01795    0  655 -6108.0599 7052.01795   215%     - 1367s
     0     0 7050.43838    0  466 -6108.0599 7050.43838   215%     - 1369s
     0     0 7048.01610    0  496 -6108.0599 7048.01610   215%     - 1373s
     0     0 7047.86893    0  496 -6108.0599 7047.86893   215%     - 1376s
H    0     0                    -6104.458763 7047.86893   215%     - 1525s
H    0     0                    -6021.845411 7047.86893   217%     - 1531s
H    0     2                    -5994.884063 7047.86893   218%     - 1638s
     0     2 7047.86893    0  496 -5994.8841 7047.86893   218%     - 1638s
     1     4 6908.81895    1  436 -5994.8841 7047.66427   218% 11334 1677s
     3     8 6833.03822    2  543 -5994.8841 6908.43222   215% 16545 1707s
     7    15 6600.15833    3  654 -5994.8841 6832.81463   214% 16701 1748s
    14    30 6437.37460    4  463 -5994.8841 6612.97327   210% 16706 1792s
    29    45 6089.94176    5  471 -5994.8841 6436.74806   207% 21067 1904s
    44    77 4427.75479    6  425 -5994.8841 6436.74806   207% 22827 2013s
    76   185 4141.75304    7  425 -5994.8841 6199.46771   203% 19021 2106s
   184   266 3918.53522    9  406 -5994.8841 6199.23418   203% 11483 2140s
H  207   266                    -5959.825789 6199.23418   204% 10889 2140s
   267   346 3709.33952   10  392 -5959.8258 6199.23418   204%  9755 2169s
   347   406 3651.84636   11  389 -5959.8258 6199.23418   204%  8526 2200s
H  358   406                    -3805.263503 6199.23418   263%  8406 2200s
   407   446 3579.15324   13  391 -3805.2635 6199.23418   263%  8051 2229s
H  451   501                    -3794.161052 6199.23418   263%  7932 2254s
H  459   501                    -3543.580318 6199.23418   275%  7891 2254s
   508   553 2042.29504   14  326 -3543.5803 6199.23418   275%  7715 2280s
   572   607 2369.36075   17  311 -3543.5803 6199.23418   275%  7666 2301s
H  609   607                    -3529.355412 6199.23418   276%  7579 2301s
H  617   607                    -3494.083851 6199.23418   277%  7601 2301s
   632   643 2007.72208   18  301 -3494.0839 6199.23418   277%  7573 2327s
H  633   643                    -3440.102475 6199.23418   280%  7561 2327s
H  637   643                    -3405.939246 6199.23418   282%  7538 2327s
H  641   643                    -3319.548290 6199.23418   287%  7534 2327s
   686   708 2479.66159   13  311 -3319.5483 6199.23418   287%  7597 2347s
H  722   708                    -3242.118860 6199.23418   291%  7443 2347s
   761   777  237.02965   19  259 -3242.1189 6199.23418   291%  7434 2369s
   842   830     cutoff   20      -3242.1189 6199.23418   291%  7332 2390s
   925   896  -72.85342   20  239 -3242.1189 6199.23418   291%  7184 2413s
  1023   923 -650.58143   31  360 -3242.1189 6199.23418   291%  7004 2432s
  1070   972 -681.59073   32  376 -3242.1189 6199.23418   291%  7012 2455s
H 1078   972                    -3201.194177 6199.23418   294%  6992 2455s
  1158  1019 -899.31761   34  299 -3201.1942 6199.23418   294%  6799 2479s
  1264  1079 -1802.2052   37  187 -3201.1942 6199.23418   294%  6643 2505s
  1362  1154 -3073.7743   41  157 -3201.1942 6199.23418   294%  6530 2532s
  1483  1217 infeasible   51      -3201.1942 5944.05010   286%  6372 2558s
  1599  1237 4497.68356    7  425 -3201.1942 5888.62112   284%  6288 2582s
H 1603  1237                    -3164.325208 5888.62112   286%  6291 2582s
  1643  1299 4321.30465    8  415 -3164.3252 5888.62112   286%  6328 2613s
  1775  1332     cutoff   60      -3164.3252 5888.62112   286%  6221 2643s
  1866  1388 3531.26447    9  391 -3164.3252 5888.62112   286%  6266 2677s
  1930  1471 3293.28372   10  333 -3164.3252 5888.62112   286%  6408 2705s
  2029  1554 -898.20710   12  479 -3164.3252 5888.62112   286%  6505 2739s
  2129  1597 -1113.8259   13  484 -3164.3252 5888.62112   286%  6552 2771s
  2186  1675 -1794.1250   14  459 -3164.3252 5888.62112   286%  6599 2801s
  2290  1698 -2040.8033   15  439 -3164.3252 5888.62112   286%  6606 2828s
H 2311  1698                    -3065.156437 5888.62112   292%  6630 2828s
  2329  1802 -2214.9721   16  451 -3065.1564 5888.62112   292%  6650 2863s
  2507  1919     cutoff   19      -3065.1564 5632.87233   284%  6587 2903s
  2698  1982 -2799.8329   20  166 -3065.1564 5632.87233   284%  6494 2939s
  2881  2012 infeasible   35      -3065.1564 5602.91360   283%  6444 2982s
  3003  2031 4645.25048   11  430 -3065.1564 5558.76389   281%  6505 3025s
H 3009  2028                    -3025.498239 5558.76389   284%  6511 3025s
H 3011  2028                    -3011.093341 5558.76389   285%  6512 3025s
  3038  2072 4566.32635   12  379 -3011.0933 5470.97622   282%  6589 3068s
  3165  2147 3684.51038   15  434 -3011.0933 5470.97622   282%  6664 3112s
  3288  2186 1368.28681   18  277 -3011.0933 5466.00326   282%  6766 3158s
H 3291  2186                    -3004.873060 5466.00326   282%  6767 3158s
H 3311  2186                    -2991.082523 5416.45035   281%  6763 3158s
H 3323  2183                    -2952.006478 5416.45035   283%  6776 3158s
  3361  2271 -1248.6140   21  153 -2952.0065 5416.45035   283%  6853 3204s
  3507  2390     cutoff   31      -2952.0065 5416.45035   283%  6948 3254s
  3688  2489 3293.84409   11  252 -2952.0065 5349.72254   281%  6976 3305s
  3877  2589 2006.95693   14  197 -2952.0065 5321.36368   280%  7021 3356s
H 3903  2588                    -2921.266525 5321.36368   282%  7020 3356s
H 3904  2582                    -2903.253027 5321.36368   283%  7025 3356s
  4041  2717 -321.05244   21  123 -2903.2530 5321.36368   283%  7081 3413s

Cutting planes:
  Implied bound: 88
  MIR: 2029
  Flow cover: 2584
  RLT: 87
  Relax-and-lift: 504

Explored 4257 nodes (30917802 simplex iterations) in 3600.12 seconds (5922.95 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -2903.25 -2921.27 -2952.01 ... -3201.19

Time limit reached
Best objective -2.903253027249e+03, best bound 5.219623254812e+03, gap 279.7853%
  WARNING: Time limit reached. Using best solution found (gap: 279.79%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.16s
  Master Objective (UB) = -2903.25, θ = 131668.32
  Upper Bound (UB) = -2903.25

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 131668.32
  [DEBUG]   ✓ Scenario 0: θ = 131668.32 ≤ Q = 131668.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 131668.32 ≤ Q = 131668.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 131668.32 ≤ Q = 131668.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 131668.32 ≤ Q = 131668.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 131668.32 ≤ Q = 131668.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 131668.32 ≤ Q = 131668.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 131668.32 ≤ Q = 131668.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 131668.32 ≤ Q = 131668.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 131668.32 ≤ Q = 131668.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 131668.32 ≤ Q = 131693.14 (slack: 24.82)
  [DEBUG]   ✓ Scenario 10: θ = 131668.32 ≤ Q = 131668.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 131668.32 ≤ Q = 131668.32 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 12] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x420a030b
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xbdf5fcf5
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e-13, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.381674e+13
Presolve removed 2625 rows and 1918 columns
Presolve time: 0.01s
Presolved: 468 rows, 471 columns, 1319 nonzeros
Found heuristic solution: objective 6500766.0040
Variable types: 319 continuous, 152 integer (152 binary)

Root relaxation: objective -1.349670e+05, 240 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -134967.00    0  123 6500766.00 -134967.00   102%     -    0s
H    0     0                    -103454.0675 -134967.00  30.5%     -    0s
H    0     0                    -104066.2719 -134967.00  29.7%     -    0s
     0     0 -111610.42    0   80 -104066.27 -111610.42  7.25%     -    0s
H    0     0                    -107545.4130 -111477.68  3.66%     -    0s
H    0     0                    -107843.0367 -111477.68  3.37%     -    0s
H    0     0                    -108645.9742 -111477.68  2.61%     -    0s
H    0     0                    -108943.5979 -111477.68  2.33%     -    0s
     0     0 -110421.40    0   79 -108943.60 -110421.40  1.36%     -    0s
     0     0 -110026.78    0   81 -108943.60 -110026.78  0.99%     -    0s
     0     0 -110018.18    0   81 -108943.60 -110018.18  0.99%     -    0s
     0     0 -109812.22    0   77 -108943.60 -109812.22  0.80%     -    0s
     0     0 -109807.53    0   74 -108943.60 -109807.53  0.79%     -    0s
     0     0 -109655.63    0   71 -108943.60 -109655.63  0.65%     -    0s
     0     0 -109642.44    0   74 -108943.60 -109642.44  0.64%     -    0s
H    0     0                    -108951.9435 -109622.19  0.62%     -    0s
     0     2 -109622.19    0   74 -108951.94 -109622.19  0.62%     -    0s
H  335   102                    -108962.3167 -109172.96  0.19%   9.2    0s

Cutting planes:
  Gomory: 43
  Implied bound: 6
  MIR: 174
  Flow cover: 5
  RLT: 7
  BQP: 2

Explored 917 nodes (5828 simplex iterations) in 0.20 seconds (0.09 work units)
Thread count was 32 (of 32 available processors)

Solution count 8: -108962 -108952 -108944 ... 1.38167e+13
No other solutions better than -108962

Optimal solution found (tolerance 1.00e-04)
Best objective -1.089623167028e+05, best bound -1.089623167028e+05, gap 0.0000%
  Subproblem solved in 0.23s
  Worst-case operational profit (Z_SP) = 128760.79
  Scenario: 34 demand increases, 26 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -108962.32
  [DEBUG]   S×d_nominal = 237723.11
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 237723.11 + -108962.32 = 128760.79
  [DEBUG]   Current θ from Master = 131668.32
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2907.52 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -5810.77
  Lower Bound (LB) = -5810.77
  Gap (UB-LB) = 2907.5209, Absolute Gap = 2907.5209, Relative Gap = 1.001470
  Not converged yet (gap = 2907.52 > ε = 200)

  [DEBUG] Adding NEW scenario 12 to Master Problem...
  [DEBUG] New scenario pattern: 34 increases, 26 decreases
    [DEBUG] Scenario 12 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 12 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 12]
    [DEBUG]   - Total constraints in model: 200153
    [DEBUG]   - Total variables in model: 83380
  [DEBUG] Total scenarios in Master: 13
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 13
================================================================================
[Iteration 13] Solving Master Problem...
  Current scenarios in Master: 13
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 200153 rows, 83380 columns and 567366 nonzeros
Model fingerprint: 0x653ed049
Variable types: 81121 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 97162 rows and 39442 columns
Presolve time: 3.71s
Presolved: 102991 rows, 43938 columns, 625047 nonzeros
Variable types: 41679 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -371588.8790
Found heuristic solution: objective -171217.0927

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.33s

Barrier statistics:
 Dense cols : 548
 AA' NZ     : 4.323e+06
 Factor NZ  : 9.749e+06 (roughly 140 MB of memory)
 Factor Ops : 1.835e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.64633835e+07  1.79245258e+08  8.63e+04 1.99e+01  7.28e+04     6s
   1  -1.24973540e+07  1.60645480e+08  5.97e+04 5.28e+01  5.00e+04     6s
   2  -4.13658389e+06  1.20991384e+08  1.92e+04 6.20e-01  1.71e+04     6s
   3  -8.22407219e+05  8.72458968e+07  1.72e+03 1.37e+00  1.89e+03     6s
   4  -4.84501087e+05  5.39063394e+07  3.29e+02 6.43e-01  5.39e+02     6s
   5  -3.92170395e+05  3.03258075e+07  9.87e+01 3.03e-01  2.29e+02     6s
   6  -3.15018495e+05  2.28358859e+07  2.85e+01 2.18e-01  1.40e+02     6s
   7  -2.35685358e+05  1.61493973e+07  5.37e+00 1.49e-01  8.95e+01     6s
   8  -1.32544733e+05  7.46438253e+06  4.83e-01 6.82e-02  4.04e+01     6s
   9  -9.11465533e+04  1.97071758e+06  3.10e-01 1.80e-02  1.09e+01     7s
  10  -6.23599319e+04  1.03192503e+06  1.88e-01 9.27e-03  5.80e+00     7s
  11  -4.36202792e+04  6.41407826e+05  1.23e-01 5.62e-03  3.63e+00     7s
  12  -3.32093287e+04  3.13490154e+05  8.02e-02 2.74e-03  1.84e+00     7s
  13  -1.96099447e+04  2.12754041e+05  4.12e-02 1.83e-03  1.23e+00     7s
  14  -1.16359924e+04  1.14613979e+05  2.69e-02 1.53e-03  6.69e-01     7s
  15  -5.71005906e+03  8.01016602e+04  2.00e-02 1.53e-03  4.55e-01     7s
  16   1.34183109e+02  5.67424628e+04  1.49e-02 9.16e-04  3.00e-01     7s
  17   6.80010420e+03  4.36771604e+04  9.28e-03 5.89e-04  1.95e-01     7s
  18   9.01840027e+03  3.50741781e+04  7.60e-03 7.33e-04  1.38e-01     8s
  19   1.16126479e+04  3.21822519e+04  5.65e-03 5.91e-04  1.09e-01     8s
  20   1.35558169e+04  2.79051134e+04  4.27e-03 3.88e-04  7.60e-02     8s
  21   1.40445744e+04  2.72051944e+04  3.89e-03 3.56e-04  6.97e-02     8s
  22   1.57274650e+04  2.49712359e+04  2.81e-03 2.38e-04  4.90e-02     8s
  23   1.64482585e+04  2.37375545e+04  2.36e-03 1.78e-04  3.86e-02     8s
  24   1.72423352e+04  2.32111726e+04  1.87e-03 1.49e-04  3.16e-02     8s
  25   1.81319078e+04  2.17538898e+04  1.34e-03 1.27e-04  1.92e-02     9s
  26   1.85725955e+04  2.15014416e+04  1.07e-03 9.38e-05  1.55e-02     9s
  27   1.91190708e+04  2.09356838e+04  7.46e-04 1.27e-04  9.63e-03     9s
  28   1.96412779e+04  2.07405308e+04  4.54e-04 7.42e-05  5.83e-03     9s
  29   2.00144365e+04  2.06542587e+04  2.38e-04 5.14e-05  3.39e-03     9s
  30   2.01078905e+04  2.05836105e+04  1.87e-04 3.32e-05  2.52e-03     9s
  31   2.02081284e+04  2.05675099e+04  1.31e-04 2.92e-05  1.90e-03     9s
  32   2.02448265e+04  2.05238939e+04  1.11e-04 1.80e-05  1.48e-03     9s
  33   2.03260322e+04  2.04859248e+04  6.37e-05 8.77e-06  8.47e-04    10s
  34   2.03782826e+04  2.04709837e+04  3.56e-05 5.68e-06  4.91e-04    10s
  35   2.03951767e+04  2.04608030e+04  2.65e-05 3.27e-06  3.48e-04    10s
  36   2.03972973e+04  2.04585064e+04  2.54e-05 2.68e-06  3.24e-04    10s
  37   2.04169350e+04  2.04552144e+04  1.54e-05 1.81e-06  2.03e-04    10s
  38   2.04290841e+04  2.04515694e+04  9.01e-06 9.89e-07  1.19e-04    10s
  39   2.04467317e+04  2.04479056e+04  9.26e-08 4.21e-07  6.22e-06    11s
  40   2.04471767e+04  2.04473325e+04  5.89e-08 5.07e-08  8.25e-07    11s
  41   2.04472444e+04  2.04472445e+04  3.33e-10 3.86e-11  4.37e-10    11s

Barrier solved model in 41 iterations and 10.85 seconds (8.83 work units)
Optimal objective 2.04472444e+04


Root crossover log...

   91668 DPushes remaining with DInf 0.0000000e+00                11s
       0 DPushes remaining with DInf 0.0000000e+00                14s

    2864 PPushes remaining with PInf 2.4545529e-05                14s
       0 PPushes remaining with PInf 0.0000000e+00                15s

  Push phase complete: Pinf 0.0000000e+00, Dinf 6.0695202e+02     15s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   42834    2.0447244e+04   0.000000e+00   6.069520e+02     15s
   42913    2.0447244e+04   0.000000e+00   0.000000e+00     15s
   42913    2.0447244e+04   0.000000e+00   0.000000e+00     15s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 2.044724e+04, 42913 iterations, 10.46 seconds (12.78 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 20447.2444    0  181 -171217.09 20447.2444   112%     -   15s
H    0     0                    -160227.6074 20447.2444   113%     -   15s
H    0     0                    -116369.3233 20447.2444   118%     -   16s
H    0     0                    -112443.6864 20447.2444   118%     -   16s
H    0     0                    -111971.7353 20447.2444   118%     -   17s
H    0     0                    -111807.4816 20447.2444   118%     -   17s
H    0     0                    -70758.85635 20447.2444   129%     -   17s
H    0     0                    -48673.53629 20447.2444   142%     -   17s
H    0     0                    -48615.68030 20447.2444   142%     -   17s
H    0     0                    -29877.24121 20447.2444   168%     -   17s
H    0     0                    -25489.91283 20447.2444   180%     -   17s
H    0     0                    -20068.28095 20447.2444   202%     -   19s
H    0     0                    -19426.76072 20447.2444   205%     -   19s
H    0     0                    -12834.06857 15676.9492   222%     -   89s
H    0     0                    -11989.73397 15676.9492   231%     -   89s
H    0     0                    -11748.10959 15676.9492   233%     -   89s
     0     0 15676.9492    0  346 -11748.110 15676.9492   233%     -   90s
H    0     0                    -11424.64789 15676.9488   237%     -   91s
H    0     0                    -10409.44502 15676.9488   251%     -   91s
     0     0 15599.8489    0  339 -10409.445 15599.8489   250%     -  100s
     0     0 15579.6359    0  353 -10409.445 15579.6359   250%     -  104s
     0     0 15533.4959    0  343 -10409.445 15533.4959   249%     -  110s
     0     0 15524.6913    0  341 -10409.445 15524.6913   249%     -  111s
     0     0 15508.6233    0  345 -10409.445 15508.6233   249%     -  116s
     0     0 15505.7606    0  345 -10409.445 15505.7606   249%     -  117s
     0     0 15505.7078    0  347 -10409.445 15505.7078   249%     -  118s
     0     0 13149.2381    0  424 -10409.445 13149.2381   226%     -  192s
     0     0 12790.4339    0  451 -10409.445 12790.4339   223%     -  237s
     0     0 12704.3050    0  446 -10409.445 12704.3050   222%     -  259s
     0     0 12637.9015    0  449 -10409.445 12637.9015   221%     -  275s
     0     0 12610.2838    0  458 -10409.445 12610.2838   221%     -  288s
     0     0 12593.9137    0  463 -10409.445 12593.9137   221%     -  293s
     0     0 12591.5816    0  456 -10409.445 12591.5816   221%     -  297s
     0     0 12577.7909    0  451 -10409.445 12577.7909   221%     -  306s
     0     0 12564.1725    0  456 -10409.445 12564.1725   221%     -  314s
     0     0 12557.5824    0  464 -10409.445 12557.5824   221%     -  319s
     0     0 12551.6737    0  459 -10409.445 12551.6737   221%     -  322s
     0     0 12542.9530    0  452 -10409.445 12542.9530   220%     -  328s
     0     0 12538.2617    0  463 -10409.445 12538.2617   220%     -  333s
     0     0 12528.7839    0  455 -10409.445 12528.7839   220%     -  339s
     0     0 12510.2618    0  463 -10409.445 12510.2618   220%     -  345s
     0     0 12506.5694    0  465 -10409.445 12506.5694   220%     -  348s
     0     0 12505.0290    0  464 -10409.445 12505.0290   220%     -  350s
     0     0 12504.8406    0  464 -10409.445 12504.8406   220%     -  351s
H    0     0                    -8912.314578 10534.4992   218%     -  458s
H    0     0                    -8897.470526 10534.4992   218%     -  458s
H    0     0                    -8863.691260 10534.4992   219%     -  458s
     0     0 10534.4992    0  376 -8863.6913 10534.4992   219%     -  458s
     0     0 10024.2485    0  541 -8863.6913 10024.2485   213%     -  519s
     0     0 9769.70483    0  468 -8863.6913 9769.70483   210%     -  562s
     0     0 9700.15243    0  563 -8863.6913 9700.15243   209%     -  587s
     0     0 9555.99375    0  555 -8863.6913 9555.99375   208%     -  631s
     0     0 9506.87345    0  557 -8863.6913 9506.87345   207%     -  650s
     0     0 9467.60650    0  569 -8863.6913 9467.60650   207%     -  662s
     0     0 9398.61128    0  559 -8863.6913 9398.61128   206%     -  680s
     0     0 9365.37662    0  567 -8863.6913 9365.37662   206%     -  692s
     0     0 9310.68644    0  582 -8863.6913 9310.68644   205%     -  707s
     0     0 9294.30755    0  584 -8863.6913 9294.30755   205%     -  718s
     0     0 9286.49084    0  595 -8863.6913 9286.49084   205%     -  723s
     0     0 9282.69421    0  585 -8863.6913 9282.69421   205%     -  728s
     0     0 9270.01674    0  570 -8863.6913 9270.01674   205%     -  733s
     0     0 9264.01372    0  580 -8863.6913 9264.01372   205%     -  736s
     0     0 9263.33160    0  594 -8863.6913 9263.33160   205%     -  739s
H    0     0                    -8852.530127 8577.76718   197%     -  837s
H    0     0                    -8809.502831 8577.76718   197%     -  837s
H    0     0                    -8462.881727 8577.76718   201%     -  837s
H    0     0                    -8087.250126 8577.76718   206%     -  837s
H    0     0                    -8057.094502 8577.76718   206%     -  837s
H    0     0                    -7836.358343 8577.76718   209%     -  837s
     0     0 8577.76718    0  431 -7836.3583 8577.76718   209%     -  837s
H    0     0                    -7765.491107 8242.68659   206%     -  895s
H    0     0                    -7714.775391 8242.68659   207%     -  895s
     0     0 8242.68659    0  587 -7714.7754 8242.68659   207%     -  896s
H    0     0                    -7598.301606 8007.32589   205%     -  938s
H    0     0                    -7165.269953 8007.32589   212%     -  938s
     0     0 8007.32589    0  608 -7165.2700 8007.32589   212%     -  938s
     0     0 7936.52308    0  603 -7165.2700 7936.52308   211%     -  967s
     0     0 7881.24458    0  631 -7165.2700 7881.24458   210%     - 1001s
H    0     0                    -6849.917404 7818.34640   214%     - 1022s
H    0     0                    -6838.756271 7818.34640   214%     - 1022s
     0     0 7818.34640    0  631 -6838.7563 7818.34640   214%     - 1022s
     0     0 7786.25404    0  644 -6838.7563 7786.25404   214%     - 1035s
     0     0 7762.35103    0  621 -6838.7563 7762.35103   214%     - 1051s
     0     0 7757.53385    0  635 -6838.7563 7757.53385   213%     - 1057s
     0     0 7744.70750    0  627 -6838.7563 7744.70750   213%     - 1068s
H    0     0                    -6767.637484 7647.21973   213%     - 1083s
H    0     0                    -6673.234436 7647.21973   215%     - 1083s
     0     0 7647.21973    0  604 -6673.2344 7647.21973   215%     - 1083s
     0     0 7596.86474    0  638 -6673.2344 7596.86474   214%     - 1095s
     0     0 7569.60047    0  640 -6673.2344 7569.60047   213%     - 1106s
     0     0 7525.79102    0  631 -6673.2344 7525.79102   213%     - 1116s
     0     0 7513.96397    0  633 -6673.2344 7513.96397   213%     - 1123s
     0     0 7502.73348    0  635 -6673.2344 7502.73348   212%     - 1129s
     0     0 7499.28470    0  618 -6673.2344 7499.28470   212%     - 1135s
     0     0 7495.13641    0  651 -6673.2344 7495.13641   212%     - 1141s
     0     0 7488.67638    0  603 -6673.2344 7488.67638   212%     - 1146s
     0     0 7487.22536    0  650 -6673.2344 7487.22536   212%     - 1149s
     0     0 7342.49121    0  470 -6673.2344 7342.49121   210%     - 1173s
H    0     0                    -6628.559693 7342.42087   211%     - 1174s
     0     0 7311.58885    0  480 -6628.5597 7311.58885   210%     - 1190s
     0     0 7296.71859    0  481 -6628.5597 7296.71859   210%     - 1201s
     0     0 7277.63597    0  482 -6628.5597 7277.63597   210%     - 1210s
     0     0 7274.90392    0  484 -6628.5597 7274.90392   210%     - 1217s
     0     0 7269.70709    0  452 -6628.5597 7269.70709   210%     - 1223s
     0     0 7268.13181    0  669 -6628.5597 7268.13181   210%     - 1228s
     0     0 7202.05442    0  652 -6628.5597 7202.05442   209%     - 1251s
H    0     0                    -6546.496048 7201.26375   210%     - 1260s
H    0     0                    -6490.953438 7201.26375   211%     - 1260s
     0     0 7187.12917    0  493 -6490.9534 7187.12917   211%     - 1268s
     0     0 7166.07563    0  656 -6490.9534 7166.07563   210%     - 1283s
     0     0 7152.01526    0  503 -6490.9534 7152.01526   210%     - 1290s
     0     0 7146.07772    0  662 -6490.9534 7146.07772   210%     - 1297s
     0     0 7145.40028    0  680 -6490.9534 7145.40028   210%     - 1299s
     0     0 7128.86448    0  477 -6490.9534 7128.86448   210%     - 1312s
     0     0 7122.18934    0  480 -6490.9534 7122.18934   210%     - 1318s
     0     0 7117.92277    0  483 -6490.9534 7117.92277   210%     - 1320s
     0     0 7115.93086    0  486 -6490.9534 7115.93086   210%     - 1323s
     0     0 7112.50851    0  491 -6490.9534 7112.50851   210%     - 1326s
     0     0 7111.23351    0  494 -6490.9534 7111.23351   210%     - 1328s
     0     0 7076.85506    0  503 -6490.9534 7076.85506   209%     - 1340s
H    0     0                    -6448.325388 7076.37966   210%     - 1349s
     0     0 7067.75415    0  489 -6448.3254 7067.75415   210%     - 1357s
     0     0 7066.06892    0  493 -6448.3254 7066.06892   210%     - 1358s
     0     0 7052.45705    0  500 -6448.3254 7052.45705   209%     - 1367s
     0     0 7047.43203    0  505 -6448.3254 7047.43203   209%     - 1372s
     0     0 7044.58777    0  456 -6448.3254 7044.58777   209%     - 1377s
     0     0 7043.81959    0  471 -6448.3254 7043.81959   209%     - 1379s
     0     0 7037.36863    0  470 -6448.3254 7037.36863   209%     - 1386s
H    0     0                    -6406.135726 7037.35473   210%     - 1400s
H    0     0                    -6374.189699 7037.35473   210%     - 1404s
     0     0 7037.02407    0  470 -6374.1897 7037.02407   210%     - 1406s
     0     0 7032.45432    0  471 -6374.1897 7032.45432   210%     - 1415s
     0     0 7030.18834    0  477 -6374.1897 7030.18834   210%     - 1419s
     0     0 7029.64274    0  470 -6374.1897 7029.64274   210%     - 1421s
     0     0 7023.70543    0  464 -6374.1897 7023.70543   210%     - 1433s
     0     0 7023.65657    0  464 -6374.1897 7023.65657   210%     - 1438s
H    0     0                    -5335.588220 7023.62666   232%     - 1637s
H    0     0                    -4639.285771 7023.62666   251%     - 1637s
H    0     0                    -4577.661901 7023.62666   253%     - 1658s
H    0     0                    -4216.103543 7023.62666   267%     - 1661s
H    0     0                    -4175.576255 7023.62666   268%     - 1662s
H    0     0                    -4073.720087 7023.62666   272%     - 1662s
H    0     0                    -3995.569670 7023.62666   276%     - 1662s
H    0     0                    -3766.461687 7023.62666   286%     - 1662s
H    0     0                    -3761.962895 7023.62666   287%     - 1664s
H    0     0                    -3678.509477 7023.62666   291%     - 1664s
H    0     2                    -3497.932412 7023.62666   301%     - 1690s
     0     2 7023.62666    0  464 -3497.9324 7023.62666   301%     - 1690s
     1     4 6975.02603    1  438 -3497.9324 7023.60608   301% 10385 1730s
     3     8 6787.42106    2  446 -3497.9324 6973.28301   299% 16139 1761s
     7    16 6524.33489    3  430 -3497.9324 6786.43062   294% 15780 1817s
    15    32 6380.84228    4  434 -3497.9324 6523.67414   287% 18096 1842s
    31    48 5551.04501    5  443 -3497.9324 6380.83667   282% 18501 1934s
    47    80 4815.18612    6  450 -3497.9324 6380.83667   282% 23802 1977s
    79   177 4641.21461    7  435 -3497.9324 6380.83667   282% 23364 2041s
H  176   207                    -3208.436393 6380.83667   299% 13694 2072s
H  205   207                    -3165.792247 6380.83667   302% 12441 2072s
   206   263 4089.93123    9  511 -3165.7922 6380.83667   302% 12449 2111s
   264   300 4280.36441    9  526 -3165.7922 6380.83667   302% 10942 2137s
H  266   300                    -3154.573812 6380.83667   302% 10877 2137s
   301   365 4513.87899    9  429 -3154.5738 6380.83667   302% 10274 2182s
   368   420 3865.96168   10  580 -3154.5738 6380.83667   302%  9379 2216s
   431   469 3898.95100   10  515 -3154.5738 6380.83667   302%  8807 2250s
   494   507 4286.83229   10  443 -3154.5738 6380.83667   302%  8255 2281s
   542   544 4097.78715   10  532 -3154.5738 6380.83667   302%  7931 2311s
H  549   544                    -3152.183466 6380.83667   302%  7870 2311s
H  559   544                    -3072.353352 6380.83667   308%  7793 2311s
   603   587  -90.99583   19  360 -3072.3534 6380.83667   308%  7489 2344s
   672   638 -222.16231   22  356 -3072.3534 6380.83667   308%  7063 2372s
   745   694 -641.93981   26  474 -3072.3534 6380.83667   308%  6682 2397s
   833   746 -751.20804   27  465 -3072.3534 6380.83667   308%  6228 2425s
   938   770 -981.81414   20  204 -3072.3534 6380.83667   308%  5771 2464s
H 1022   779                    -3042.992921 6380.83667   310%  5505 2495s
  1095   815 infeasible   26      -3042.9929 6380.83667   310%  5339 2533s
  1195   847 -1859.0370   30   80 -3042.9929 6380.83667   310%  5131 2567s
H 1324   866                    -3027.153857 6380.83667   311%  4812 2601s
  1426   882 infeasible   39      -3027.1539 6380.83667   311%  4681 2638s
  1516   898 3081.00009   10  421 -3027.1539 6380.83667   311%  4597 2679s
  1572   923 2145.57255   12  387 -3027.1539 6380.83667   311%  4589 2720s
  1629   961 -378.29331   12  324 -3027.1539 6380.83667   311%  4620 2763s
  1689  1006 -413.42455   13  307 -3027.1539 6380.83667   311%  4656 2804s
  1758  1027 -2261.5632   15  354 -3027.1539 6380.83667   311%  4681 2840s
H 1761  1027                    -3007.344732 6380.83667   312%  4674 2840s
  1795  1083 -2541.6586   16  474 -3007.3447 6380.83667   312%  4699 2880s
  1901  1129     cutoff   18      -3007.3447 6380.83667   312%  4670 2924s
  1999  1161 infeasible   20      -3007.3447 6380.83667   312%  4659 2975s
  2099  1266 -1915.0836   23  194 -3007.3447 6380.83667   312%  4621 3020s
  2218  1369 infeasible   28      -3007.3447 6380.83667   312%  4530 3064s
  2404  1401  782.86647   12  509 -3007.3447 6380.83667   312%  4374 3110s
  2527  1440 -2247.5429   13  418 -3007.3447 6380.83667   312%  4347 3167s
  2608  1506     cutoff   16      -3007.3447 6380.83667   312%  4405 3221s
  2712  1598 infeasible   14      -3007.3447 6380.83667   312%  4437 3277s
  2832  1702 infeasible   15      -3007.3447 6380.83667   312%  4446 3335s
  3004  1749 -973.68502   13  210 -3007.3447 6380.83667   312%  4411 3394s
  3145  1816 -2838.5218   17   92 -3007.3447 6380.83667   312%  4396 3455s
  3274  1840 infeasible   12      -3007.3447 5870.43160   295%  4441 3512s
  3312  1878 2990.80924    6  474 -3007.3447 5870.34629   295%  4469 3562s
  3364  1915 -1755.6601   21  475 -3007.3447 5870.34629   295%  4477 3600s

Cutting planes:
  Learned: 2
  Gomory: 2
  Implied bound: 57
  MIR: 2206
  Flow cover: 2961
  Zero half: 1
  RLT: 112
  Relax-and-lift: 791

Explored 3479 nodes (16251216 simplex iterations) in 3600.05 seconds (5361.75 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -3007.34 -3027.15 -3042.99 ... -3678.51

Time limit reached
Best objective -3.007344732455e+03, best bound 5.870346286458e+03, gap 295.2003%
  WARNING: Time limit reached. Using best solution found (gap: 295.20%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = -3007.34, θ = 131773.32
  Upper Bound (UB) = -3007.34

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 131773.32
  [DEBUG]   ✓ Scenario 0: θ = 131773.32 ≤ Q = 131773.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 131773.32 ≤ Q = 131811.65 (slack: 38.33)
  [DEBUG]   ✓ Scenario 2: θ = 131773.32 ≤ Q = 131773.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 131773.32 ≤ Q = 131773.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 131773.32 ≤ Q = 131773.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 131773.32 ≤ Q = 148814.59 (slack: 17041.27)
  [DEBUG]   ✓ Scenario 6: θ = 131773.32 ≤ Q = 131773.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 131773.32 ≤ Q = 131773.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 131773.32 ≤ Q = 131773.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 131773.32 ≤ Q = 131773.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 131773.32 ≤ Q = 131773.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 131773.32 ≤ Q = 131773.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 131773.32 ≤ Q = 131773.32 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 13] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x79396a5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xf86c695b
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.381674e+13
Presolve removed 2625 rows and 1918 columns
Presolve time: 0.01s
Presolved: 468 rows, 471 columns, 1319 nonzeros
Found heuristic solution: objective 6506237.4709
Variable types: 319 continuous, 152 integer (152 binary)

Root relaxation: objective -1.348644e+05, 236 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -134864.38    0  123 6506237.47 -134864.38   102%     -    0s
H    0     0                    -103385.2240 -134864.38  30.4%     -    0s
H    0     0                    -103997.4284 -134864.38  29.7%     -    0s
     0     0 -110471.29    0   81 -103997.43 -110471.29  6.23%     -    0s
H    0     0                    -106406.2175 -110338.56  3.70%     -    0s
H    0     0                    -106703.8413 -110338.56  3.41%     -    0s
H    0     0                    -107535.6851 -110338.56  2.61%     -    0s
H    0     0                    -107833.3089 -110338.56  2.32%     -    0s
     0     0 -109280.26    0   80 -107833.31 -109280.26  1.34%     -    0s
     0     0 -108823.11    0   84 -107833.31 -108823.11  0.92%     -    0s
     0     0 -108804.26    0   81 -107833.31 -108804.26  0.90%     -    0s
     0     0 -108794.61    0   83 -107833.31 -108794.61  0.89%     -    0s
     0     0 -108613.06    0   80 -107833.31 -108613.06  0.72%     -    0s
     0     0 -108610.37    0   80 -107833.31 -108610.37  0.72%     -    0s
     0     2 -108609.54    0   80 -107833.31 -108609.54  0.72%     -    0s
H  109    61                    -107852.0276 -108060.10  0.19%  10.3    0s
*  180    61              13    -107900.4799 -108019.20  0.11%   8.4    0s

Cutting planes:
  Gomory: 46
  Implied bound: 7
  MIR: 180
  RLT: 4

Explored 423 nodes (2904 simplex iterations) in 0.30 seconds (0.07 work units)
Thread count was 32 (of 32 available processors)

Solution count 8: -107900 -107852 -107833 ... 1.38167e+13
No other solutions better than -107900

Optimal solution found (tolerance 1.00e-04)
Best objective -1.079004798965e+05, best bound -1.079004798965e+05, gap 0.0000%
  Subproblem solved in 0.34s
  Worst-case operational profit (Z_SP) = 129847.73
  Scenario: 14 demand increases, 46 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -107900.48
  [DEBUG]   S×d_nominal = 237748.21
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 237748.21 + -107900.48 = 129847.73
  [DEBUG]   Current θ from Master = 131773.32
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1925.59 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -4932.94
  Lower Bound (LB) = -4932.94
  Gap (UB-LB) = 1925.5906, Absolute Gap = 1925.5906, Relative Gap = 0.640296
  Not converged yet (gap = 1925.59 > ε = 200)

  [DEBUG] Adding NEW scenario 13 to Master Problem...
  [DEBUG] New scenario pattern: 14 increases, 46 decreases
    [DEBUG] Scenario 13 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 13 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 13]
    [DEBUG]   - Total constraints in model: 215443
    [DEBUG]   - Total variables in model: 89620
  [DEBUG] Total scenarios in Master: 14
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 14
================================================================================
[Iteration 14] Solving Master Problem...
  Current scenarios in Master: 14
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 215443 rows, 89620 columns and 610585 nonzeros
Model fingerprint: 0xfef09bb7
Variable types: 87361 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 104636 rows and 42476 columns
Presolve time: 4.16s
Presolved: 110807 rows, 47144 columns, 669259 nonzeros
Variable types: 44885 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -371917.1123
Found heuristic solution: objective -171217.0927

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.38s

Barrier statistics:
 Dense cols : 548
 AA' NZ     : 4.793e+06
 Factor NZ  : 1.104e+07 (roughly 150 MB of memory)
 Factor Ops : 2.176e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.64807252e+07  1.91027625e+08  8.64e+04 1.91e+01  7.25e+04     6s
   1  -1.25052264e+07  1.71368505e+08  5.96e+04 5.14e+01  4.96e+04     6s
   2  -4.69773378e+06  1.29383140e+08  2.22e+04 5.65e-01  1.96e+04     6s
   3  -8.45565088e+05  9.48113122e+07  1.89e+03 1.37e+00  2.03e+03     6s
   4  -5.06195071e+05  4.56135863e+07  4.49e+02 4.42e-01  5.60e+02     7s
   5  -3.80993790e+05  2.87905575e+07  1.20e+02 2.20e-01  2.25e+02     7s
   6  -2.85575259e+05  1.99780262e+07  2.68e+01 1.41e-01  1.16e+02     7s
   7  -1.83061502e+05  1.52485705e+07  7.34e+00 1.05e-01  7.97e+01     7s
   8  -1.09654561e+05  5.82964882e+06  2.24e+00 3.73e-02  2.98e+01     7s
   9  -7.68362123e+04  2.02881612e+06  1.12e+00 1.28e-02  1.05e+01     7s
  10  -5.86804809e+04  1.17103684e+06  7.52e-01 7.23e-03  6.10e+00     7s
  11  -3.77969632e+04  4.68398217e+05  4.37e-01 2.73e-03  2.51e+00     7s
  12  -2.85616680e+04  2.65582305e+05  2.86e-01 1.53e-03  1.45e+00     7s
  13  -1.74232140e+04  1.73487947e+05  1.70e-01 1.10e-03  9.43e-01     7s
  14  -1.08664743e+04  1.07477492e+05  1.28e-01 1.99e-03  5.84e-01     7s
  15  -7.21658497e+03  8.38413195e+04  1.09e-01 1.46e-03  4.50e-01     8s
  16  -5.22519246e+02  6.16579296e+04  7.95e-02 2.28e-03  3.07e-01     8s
  17   3.57651344e+03  4.93412319e+04  6.37e-02 2.69e-03  2.26e-01     8s
  18   5.80882660e+03  4.51247050e+04  5.53e-02 2.86e-03  1.94e-01     8s
  19   9.58790099e+03  4.02178112e+04  4.11e-02 2.67e-03  1.51e-01     8s
  20   1.08461505e+04  3.65841802e+04  3.67e-02 2.10e-03  1.27e-01     8s
  21   1.21625895e+04  3.38622096e+04  3.23e-02 1.43e-03  1.07e-01     8s
  22   1.31009771e+04  3.04376770e+04  2.92e-02 1.64e-03  8.56e-02     8s
  23   1.45390959e+04  2.92832660e+04  2.44e-02 1.48e-03  7.28e-02     8s
  24   1.56078582e+04  2.77057728e+04  2.11e-02 8.78e-04  5.97e-02     8s
  25   1.65908261e+04  2.62594330e+04  1.78e-02 6.39e-04  4.77e-02     9s
  26   1.67007979e+04  2.59762570e+04  1.75e-02 5.92e-04  4.58e-02     9s
  27   1.74486575e+04  2.54148388e+04  1.52e-02 5.05e-04  3.93e-02     9s
  28   1.83352592e+04  2.50423998e+04  1.24e-02 4.39e-04  3.31e-02     9s
  29   1.86703297e+04  2.45381374e+04  1.14e-02 3.50e-04  2.90e-02     9s
  30   1.91425502e+04  2.44972653e+04  9.92e-03 3.43e-04  2.64e-02     9s
  31   1.96820218e+04  2.40684283e+04  8.31e-03 2.71e-04  2.17e-02     9s
  32   1.99057208e+04  2.38351559e+04  7.64e-03 2.33e-04  1.94e-02     9s
  33   2.00797981e+04  2.38053775e+04  7.11e-03 2.28e-04  1.84e-02    10s
  34   2.04090133e+04  2.35371119e+04  6.12e-03 1.85e-04  1.54e-02    10s
  35   2.06367375e+04  2.33953810e+04  5.43e-03 1.59e-04  1.36e-02    10s
  36   2.09293675e+04  2.32158265e+04  4.49e-03 1.30e-04  1.13e-02    10s
  37   2.10155434e+04  2.31768384e+04  4.23e-03 1.23e-04  1.07e-02    10s
  38   2.12956624e+04  2.30996601e+04  3.38e-03 1.10e-04  8.91e-03    10s
  39   2.13108403e+04  2.30681240e+04  3.33e-03 1.04e-04  8.68e-03    10s
  40   2.13689397e+04  2.29808066e+04  3.16e-03 9.03e-05  7.96e-03    11s
  41   2.15991062e+04  2.29316092e+04  2.46e-03 8.16e-05  6.58e-03    11s
  42   2.16406959e+04  2.28850682e+04  2.34e-03 7.35e-05  6.14e-03    11s
  43   2.18624365e+04  2.28483848e+04  1.67e-03 6.65e-05  4.87e-03    11s
  44   2.19245686e+04  2.27664606e+04  1.48e-03 5.20e-05  4.16e-03    11s
  45   2.21201353e+04  2.27094506e+04  9.35e-04 4.18e-05  2.91e-03    11s
  46   2.21784710e+04  2.25981501e+04  7.62e-04 2.33e-05  2.07e-03    11s
  47   2.22642031e+04  2.25552534e+04  5.23e-04 1.59e-05  1.44e-03    12s
  48   2.22993414e+04  2.25425345e+04  4.28e-04 1.38e-05  1.20e-03    12s
  49   2.23546836e+04  2.25131954e+04  2.75e-04 8.43e-06  7.83e-04    12s
  50   2.23616595e+04  2.25033615e+04  2.56e-04 6.84e-06  7.00e-04    12s
  51   2.23733148e+04  2.24993241e+04  2.26e-04 6.20e-06  6.22e-04    12s
  52   2.23860486e+04  2.24981779e+04  1.93e-04 5.99e-06  5.54e-04    12s
  53   2.24142393e+04  2.24832381e+04  1.19e-04 3.43e-06  3.41e-04    12s
  54   2.24373930e+04  2.24705894e+04  5.90e-05 5.24e-06  1.64e-04    12s
  55   2.24515933e+04  2.24635637e+04  2.35e-05 7.89e-07  5.91e-05    13s
  56   2.24573525e+04  2.24621960e+04  9.34e-06 1.67e-06  2.39e-05    13s
  57   2.24609512e+04  2.24617157e+04  1.55e-06 3.28e-08  3.78e-06    13s
  58   2.24616838e+04  2.24616950e+04  9.15e-09 1.26e-09  5.50e-08    13s
  59   2.24616890e+04  2.24616925e+04  2.84e-07 1.60e-10  1.73e-08    13s
  60   2.24616906e+04  2.24616925e+04  1.88e-06 1.00e-08  9.20e-09    13s
  61   2.24616919e+04  2.24616925e+04  4.10e-06 1.02e-08  2.96e-09    13s
  62   2.24616921e+04  2.24616925e+04  3.00e-06 6.35e-09  2.16e-09    13s
  63   2.24616924e+04  2.24616925e+04  7.40e-07 8.44e-09  5.33e-10    13s

Barrier solved model in 63 iterations and 13.42 seconds (12.18 work units)
Optimal objective 2.24616924e+04


Root crossover log...

   94982 DPushes remaining with DInf 0.0000000e+00                13s
   27179 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                17s

    8348 PPushes remaining with PInf 3.9783390e-05                18s
       0 PPushes remaining with PInf 0.0000000e+00                18s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.8755329e+04     18s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   48804    2.2461693e+04   0.000000e+00   1.875533e+04     18s
   48980    2.2461693e+04   0.000000e+00   0.000000e+00     18s
   48980    2.2461693e+04   0.000000e+00   0.000000e+00     19s
Concurrent spin time: 0.73s

Solved with barrier

Root relaxation: objective 2.246169e+04, 48980 iterations, 14.28 seconds (17.73 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 22461.6925    0  257 -171217.09 22461.6925   113%     -   20s
H    0     0                    -166465.5131 22461.6925   113%     -   20s
H    0     0                    -155906.6462 22461.6925   114%     -   21s
H    0     0                    -142130.6787 22461.6925   116%     -   22s
H    0     0                    -141647.0978 22461.6925   116%     -   22s
H    0     0                    -94350.03584 22461.6925   124%     -   23s
H    0     0                    -75941.60408 22461.6925   130%     -   23s
H    0     0                    -71054.45306 22461.6925   132%     -   23s
H    0     0                    -70043.24893 22461.6925   132%     -   23s
H    0     0                    -69935.90382 22461.6925   132%     -   23s
H    0     0                    -55661.48201 22461.6925   140%     -   25s
H    0     0                    -54552.72335 22461.6925   141%     -   25s
H    0     0                    -54288.37724 22461.6925   141%     -   25s
H    0     0                    -53986.19231 22461.6925   142%     -   25s
H    0     0                    -53957.93719 22461.6925   142%     -   25s
H    0     0                    -53914.16166 22461.6925   142%     -   25s
H    0     0                    -53851.36692 22461.6925   142%     -   25s
H    0     0                    -53812.58427 22461.6925   142%     -   25s
H    0     0                    -51786.14149 22458.1138   143%     -   25s
H    0     0                    -41595.66277 22458.1138   154%     -   25s
H    0     0                    -41585.53894 22458.1138   154%     -   25s
H    0     0                    -41133.39915 22458.1138   155%     -   25s
H    0     0                    -41010.31835 22458.1138   155%     -   25s
     0     0 17099.9758    0  349 -41010.318 17099.9758   142%     -   78s
H    0     0                    -38701.18657 17099.8431   144%     -   79s
H    0     0                    -35343.62740 17099.8431   148%     -   79s
H    0     0                    -26265.66550 17099.8431   165%     -   79s
H    0     0                    -25712.92816 17099.8431   167%     -   79s
H    0     0                    -23544.10388 17099.8431   173%     -   79s
H    0     0                    -23298.99084 17099.8431   173%     -   79s
H    0     0                    -22965.99952 17099.8431   174%     -   79s
H    0     0                    -22085.08696 17099.8431   177%     -   79s
H    0     0                    -22058.74994 17099.8431   178%     -   79s
     0     0 16638.1506    0  426 -22058.750 16638.1506   175%     -  110s
     0     0 16376.2465    0  431 -22058.750 16376.2465   174%     -  124s
     0     0 16366.9827    0  439 -22058.750 16366.9827   174%     -  128s
     0     0 16289.1520    0  415 -22058.750 16289.1520   174%     -  138s
     0     0 16289.1520    0  420 -22058.750 16289.1520   174%     -  141s
     0     0 16248.5158    0  419 -22058.750 16248.5158   174%     -  148s
     0     0 16243.5808    0  419 -22058.750 16243.5808   174%     -  152s
     0     0 16235.6973    0  418 -22058.750 16235.6973   174%     -  165s
     0     0 16234.2688    0  452 -22058.750 16234.2688   174%     -  169s
     0     0 16232.7284    0  454 -22058.750 16232.7284   174%     -  170s
     0     0 16232.7231    0  454 -22058.750 16232.7231   174%     -  171s
H    0     0                    -18507.79950 13165.3596   171%     -  273s
H    0     0                    -12035.18512 13165.3596   209%     -  273s
H    0     0                    -12033.49800 13165.3596   209%     -  273s
H    0     0                    -12012.56913 13165.3596   210%     -  273s
H    0     0                    -11796.45411 13165.3596   212%     -  273s
H    0     0                    -11716.10596 13165.3596   212%     -  273s
     0     0 13165.3596    0  366 -11716.106 13165.3596   212%     -  274s
     0     0 12786.9939    0  395 -11716.106 12786.9939   209%     -  326s
     0     0 12692.3349    0  517 -11716.106 12692.3349   208%     -  360s
     0     0 12654.0621    0  420 -11716.106 12654.0621   208%     -  379s
     0     0 12511.7463    0  424 -11716.106 12511.7463   207%     -  405s
     0     0 12480.7870    0  419 -11716.106 12480.7870   207%     -  421s
     0     0 12454.6908    0  424 -11716.106 12454.6908   206%     -  434s
     0     0 12442.0114    0  426 -11716.106 12442.0114   206%     -  440s
     0     0 12435.3166    0  422 -11716.106 12435.3166   206%     -  447s
     0     0 12419.5778    0  429 -11716.106 12419.5778   206%     -  454s
     0     0 12418.4997    0  429 -11716.106 12418.4997   206%     -  455s
H    0     0                    -9334.606889 10331.6716   211%     -  615s
H    0     0                    -8963.314470 10331.6716   215%     -  615s
H    0     0                    -8360.681695 10331.6716   224%     -  615s
H    0     0                    -8341.981314 10331.6716   224%     -  615s
H    0     0                    -8335.035528 10331.6716   224%     -  615s
H    0     0                    -8314.177354 10331.6716   224%     -  615s
H    0     0                    -8306.250449 10331.6716   224%     -  615s
H    0     0                    -7665.153526 10331.6716   235%     -  615s
H    0     0                    -7625.509671 10331.6716   235%     -  615s
H    0     0                    -7573.894242 10331.6716   236%     -  615s
H    0     0                    -7543.338869 10331.6716   237%     -  615s
     0     0 10331.6716    0  555 -7543.3389 10331.6716   237%     -  615s
     0     0 9908.28825    0  336 -7543.3389 9908.28825   231%     -  660s
     0     0 9633.36358    0  553 -7543.3389 9633.36358   228%     -  699s
     0     0 9598.94670    0  345 -7543.3389 9598.94670   227%     -  718s
     0     0 9553.46378    0  475 -7543.3389 9553.46378   227%     -  742s
     0     0 9514.35325    0  490 -7543.3389 9514.35325   226%     -  761s
H    0     0                    -7501.747392 9482.96516   226%     -  779s
H    0     0                    -7296.989988 9482.96516   230%     -  779s
H    0     0                    -7294.565436 9482.96516   230%     -  779s
     0     0 9482.96516    0  481 -7294.5654 9482.96516   230%     -  779s
     0     0 9411.66872    0  470 -7294.5654 9411.66872   229%     -  802s
     0     0 9390.65845    0  478 -7294.5654 9390.65845   229%     -  811s
     0     0 9383.02856    0  496 -7294.5654 9383.02856   229%     -  820s
     0     0 9372.84635    0  488 -7294.5654 9372.84635   228%     -  827s
     0     0 9344.81532    0  481 -7294.5654 9344.81532   228%     -  842s
     0     0 9338.84987    0  478 -7294.5654 9338.84987   228%     -  849s
     0     0 9335.25001    0  487 -7294.5654 9335.25001   228%     -  854s
H    0     0                    -4602.689421 9292.31750   302%     -  873s
H    0     0                    -4426.814650 9292.31750   310%     -  873s
H    0     0                    -4240.081317 9292.31750   319%     -  873s
H    0     0                    -3982.334414 9292.31750   333%     -  873s
H    0     0                    -3943.251107 9292.31750   336%     -  873s
     0     0 9292.31750    0  579 -3943.2511 9292.31750   336%     -  873s
     0     0 9269.09801    0  487 -3943.2511 9269.09801   335%     -  880s
     0     0 9222.12576    0  491 -3943.2511 9222.12576   334%     -  893s
     0     0 9215.31861    0  487 -3943.2511 9215.31861   334%     -  899s
     0     0 9193.17109    0  570 -3943.2511 9193.17109   333%     -  905s
     0     0 9186.07936    0  587 -3943.2511 9186.07936   333%     -  910s
     0     0 9179.67143    0  596 -3943.2511 9179.67143   333%     -  913s
     0     0 9178.80463    0  594 -3943.2511 9178.80463   333%     -  914s
H    0     0                    -3928.328721 8436.74845   315%     -  966s
H    0     0                    -3855.845316 8436.74845   319%     -  966s
H    0     0                    -3761.307754 8436.74845   324%     -  966s
H    0     0                    -3581.444239 8436.74845   336%     -  967s
     0     0 8436.74845    0  357 -3581.4442 8436.74845   336%     -  967s
     0     0 8243.41728    0  407 -3581.4442 8243.41728   330%     - 1002s
     0     0 8202.04729    0  502 -3581.4442 8202.04729   329%     - 1021s
     0     0 8174.75540    0  506 -3581.4442 8174.75540   328%     - 1038s
     0     0 8162.16883    0  502 -3581.4442 8162.16883   328%     - 1050s
     0     0 8087.44041    0  419 -3581.4442 8087.44041   326%     - 1073s
     0     0 8049.31935    0  425 -3581.4442 8049.31935   325%     - 1088s
     0     0 7979.66238    0  431 -3581.4442 7979.66238   323%     - 1107s
     0     0 7965.21195    0  518 -3581.4442 7965.21195   322%     - 1117s
     0     0 7952.82881    0  530 -3581.4442 7952.82881   322%     - 1128s
     0     0 7946.47338    0  518 -3581.4442 7946.47338   322%     - 1137s
     0     0 7938.88057    0  527 -3581.4442 7938.88057   322%     - 1150s
     0     0 7936.35179    0  530 -3581.4442 7936.35179   322%     - 1154s
     0     0 7929.85690    0  538 -3581.4442 7929.85690   321%     - 1162s
     0     0 7928.19442    0  535 -3581.4442 7928.19442   321%     - 1164s
     0     0 7751.29564    0  543 -3581.4442 7751.29564   316%     - 1213s
     0     0 7668.12993    0  558 -3581.4442 7668.12993   314%     - 1241s
     0     0 7628.16593    0  660 -3581.4442 7628.16593   313%     - 1261s
     0     0 7616.31707    0  549 -3581.4442 7616.31707   313%     - 1273s
     0     0 7608.99262    0  561 -3581.4442 7608.99262   312%     - 1281s
     0     0 7594.57786    0  562 -3581.4442 7594.57786   312%     - 1290s
     0     0 7591.87480    0  564 -3581.4442 7591.87480   312%     - 1295s
     0     0 7590.80140    0  562 -3581.4442 7590.80140   312%     - 1299s
     0     0 7500.64081    0  550 -3581.4442 7500.64081   309%     - 1329s
     0     0 7465.39934    0  449 -3581.4442 7465.39934   308%     - 1356s
     0     0 7451.91534    0  452 -3581.4442 7451.91534   308%     - 1369s
     0     0 7445.42993    0  459 -3581.4442 7445.42993   308%     - 1379s
     0     0 7433.86009    0  692 -3581.4442 7433.86009   308%     - 1394s
     0     0 7414.48462    0  450 -3581.4442 7414.48462   307%     - 1405s
     0     0 7403.10912    0  459 -3581.4442 7403.10912   307%     - 1412s
     0     0 7395.70091    0  673 -3581.4442 7395.70091   307%     - 1420s
     0     0 7388.68003    0  661 -3581.4442 7388.68003   306%     - 1430s
     0     0 7384.11465    0  589 -3581.4442 7384.11465   306%     - 1436s
     0     0 7382.50726    0  457 -3581.4442 7382.50726   306%     - 1441s
     0     0 7302.68381    0  668 -3581.4442 7302.68381   304%     - 1477s
     0     0 7291.52475    0  585 -3581.4442 7291.52475   304%     - 1488s
     0     0 7287.56099    0  596 -3581.4442 7287.56099   303%     - 1495s
     0     0 7285.66987    0  573 -3581.4442 7285.66987   303%     - 1499s
     0     0 7255.07391    0  459 -3581.4442 7255.07391   303%     - 1520s
H    0     0                    -3324.539368 7254.44730   318%     - 1535s
     0     0 7247.51115    0  457 -3324.5394 7247.51115   318%     - 1555s
     0     0 7242.62593    0  473 -3324.5394 7242.62593   318%     - 1564s
     0     0 7241.52814    0  549 -3324.5394 7241.52814   318%     - 1570s
     0     0 7213.29246    0  454 -3324.5394 7213.29246   317%     - 1600s
     0     0 7203.23479    0  459 -3324.5394 7203.23479   317%     - 1607s
     0     0 7195.94018    0  451 -3324.5394 7195.94018   316%     - 1617s
     0     0 7193.81326    0  461 -3324.5394 7193.81326   316%     - 1621s
     0     0 7184.08163    0  462 -3324.5394 7184.08163   316%     - 1629s
H    0     0                    -3275.797708 7183.17676   319%     - 1633s
     0     0 7179.28544    0  465 -3275.7977 7179.28544   319%     - 1639s
     0     0 7176.56606    0  465 -3275.7977 7176.56606   319%     - 1642s
     0     0 7173.10367    0  460 -3275.7977 7173.10367   319%     - 1644s
     0     0 7169.03407    0  459 -3275.7977 7169.03407   319%     - 1646s
     0     0 7167.74611    0  462 -3275.7977 7167.74611   319%     - 1648s
     0     0 7164.49339    0  469 -3275.7977 7164.49339   319%     - 1654s
     0     0 7163.36239    0  472 -3275.7977 7163.36239   319%     - 1658s
     0     0 7156.39430    0  553 -3275.7977 7156.39430   318%     - 1667s
H    0     0                    -3273.320925 7156.31230   319%     - 1682s
     0     0 7152.57328    0  473 -3273.3209 7152.57328   319%     - 1686s
     0     0 7150.79361    0  467 -3273.3209 7150.79361   318%     - 1689s
     0     0 7149.71136    0  467 -3273.3209 7149.71136   318%     - 1693s
     0     0 7149.26753    0  467 -3273.3209 7149.26753   318%     - 1699s
H    0     0                    -3265.730833 7149.26753   319%     - 1837s
H    0     0                    -3177.778623 7149.26753   325%     - 1837s
     0     2 7149.26753    0  467 -3177.7786 7149.26753   325%     - 1925s
     1     3 6059.86943    1  428 -3177.7786 7149.26753   325% 21319 1962s
     2     5 5974.38351    2  418 -3177.7786 7149.26753   325% 13940 1976s
     4     9 5780.04488    3  520 -3177.7786 7058.44999   322% 10911 1993s
     8    15 6799.18556    3  633 -3177.7786 7057.62972   322% 10742 2055s
    14    27 6678.11601    4  451 -3177.7786 6986.53398   320% 14909 2091s
    26    39 5539.73999    4  429 -3177.7786 6678.10919   310% 18114 2182s
H   38    68                    -3164.325208 6678.10919   311% 21942 2472s
    67   167 4706.53183    6  358 -3164.3252 6678.10919   311% 23427 2557s
   170   229 4612.11916    9  367 -3164.3252 6678.10919   311% 14158 2603s
   246   268 4474.62650   12  413 -3164.3252 6678.10919   311% 12188 2637s
   325   293 4131.26704   14  344 -3164.3252 6678.10919   311% 11121 2675s
   384   315 3381.84477   10  386 -3164.3252 6678.10919   311% 10450 2705s
   442   329 3970.58228   13  410 -3164.3252 6678.10919   311%  9933 2734s
   476   337 -2055.6198   12  222 -3164.3252 6678.10919   311%  9882 2767s
   521   356 2967.08818   14  390 -3164.3252 6678.10919   311%  9907 2799s
   559   385 2786.26082   15  320 -3164.3252 6678.10919   311%  9969 2829s
   605   428 2265.12673   16  391 -3164.3252 6678.10919   311%  9831 2862s
   662   464 2156.31093   17  543 -3164.3252 6678.10919   311%  9627 2893s
   722   510 1620.58042   18  272 -3164.3252 6678.10919   311%  9628 2925s
   792   546 1513.70327   19  526 -3164.3252 6678.10919   311%  9341 2949s
   858   563 1264.50339   20  270 -3164.3252 6678.10919   311%  9141 2975s
   891   563  820.07387   21  254 -3164.3252 6678.10919   311%  9132 3006s
   937   583 -420.68478   22  242 -3164.3252 6678.10919   311%  9141 3040s
   968   599 -1118.3202   23  226 -3164.3252 6678.10919   311%  9211 3071s
  1004   634 -1147.2640   24  223 -3164.3252 6678.10919   311%  9246 3104s
  1046   664 -1500.5991   25  216 -3164.3252 6678.10919   311%  9302 3135s
  1101   708 -1668.5392   26  220 -3164.3252 6678.10919   311%  9309 3169s
  1171   739 -1770.1084   27  220 -3164.3252 6678.10919   311%  9229 3204s
  1255   775     cutoff   28      -3164.3252 6678.10919   311%  9165 3240s
  1336   824 -2165.2277   28  376 -3164.3252 6678.10919   311%  9103 3276s
  1419   893 -2646.9026   30  358 -3164.3252 6574.01354   308%  9155 3320s
  1517   953     cutoff   34      -3164.3252 6574.01354   308%  9083 3357s
  1637  1052 -1297.3839   28  393 -3164.3252 6574.01354   308%  8946 3397s
  1795  1154 -1424.6516   31  369 -3164.3252 6574.01354   308%  8666 3439s
  1970  1184 -3163.2782   35  306 -3164.3252 6574.01354   308%  8422 3485s
  2108  1237 infeasible   36      -3164.3252 6574.01354   308%  8343 3530s
  2301  1253   -7.68011   11  295 -3164.3252 6574.01354   308%  8126 3584s
  2401  1256 infeasible    9      -3164.3252 6574.01354   308%  8180 3600s

Cutting planes:
  Gomory: 7
  Implied bound: 171
  MIR: 2899
  Flow cover: 3148
  Zero half: 1
  RLT: 111
  Relax-and-lift: 791

Explored 2416 nodes (20736779 simplex iterations) in 3600.07 seconds (5261.67 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -3164.33 -3177.78 -3265.73 ... -3928.33

Time limit reached
Best objective -3.164325207886e+03, best bound 6.574013539579e+03, gap 307.7540%
  WARNING: Time limit reached. Using best solution found (gap: 307.75%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = -3164.33, θ = 130743.78
  Upper Bound (UB) = -3164.33

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 130743.78
  [DEBUG]   ✓ Scenario 0: θ = 130743.78 ≤ Q = 130743.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 130743.78 ≤ Q = 130743.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 130743.78 ≤ Q = 130743.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 130743.78 ≤ Q = 130743.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 130743.78 ≤ Q = 130743.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 130743.78 ≤ Q = 130743.78 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 130743.78 ≤ Q = 130743.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 130743.78 ≤ Q = 130743.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 130743.78 ≤ Q = 130743.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 130743.78 ≤ Q = 130743.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 130743.78 ≤ Q = 130743.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 130743.78 ≤ Q = 130743.78 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 130743.78 ≤ Q = 130743.78 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 130743.78 ≤ Q = 130743.78 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 14] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x64dfc9a3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x9b20365d
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.360527e+13
Presolve removed 2625 rows and 1918 columns
Presolve time: 0.01s
Presolved: 468 rows, 471 columns, 1319 nonzeros
Found heuristic solution: objective 6467688.1274
Variable types: 319 continuous, 152 integer (152 binary)

Root relaxation: objective -1.308113e+05, 236 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -130811.26    0  123 6467688.13 -130811.26   102%     -    0s
H    0     0                    -99463.20351 -130811.26  31.5%     -    0s
H    0     0                    -99669.53634 -130811.26  31.2%     -    0s
     0     0 -106599.83    0   77 -99669.536 -106599.83  6.95%     -    0s
H    0     0                    -103236.5209 -106473.29  3.14%     -    0s
H    0     0                    -103538.0367 -106473.29  2.83%     -    0s
H    0     0                    -103620.0245 -106473.29  2.75%     -    0s
H    0     0                    -103921.5403 -106473.29  2.46%     -    0s
     0     0 -106026.71    0   73 -103921.54 -106026.71  2.03%     -    0s
     0     0 -105706.96    0   76 -103921.54 -105706.96  1.72%     -    0s
     0     0 -105499.76    0   83 -103921.54 -105499.76  1.52%     -    0s
     0     0 -105495.14    0   71 -103921.54 -105495.14  1.51%     -    0s
     0     0 -105207.55    0   74 -103921.54 -105207.55  1.24%     -    0s
     0     0 -105136.86    0   76 -103921.54 -105136.86  1.17%     -    0s
     0     0 -105133.79    0   77 -103921.54 -105133.79  1.17%     -    0s
     0     0 -104988.50    0   73 -103921.54 -104988.50  1.03%     -    0s
     0     0 -104964.13    0   75 -103921.54 -104964.13  1.00%     -    0s
     0     0 -104901.45    0   74 -103921.54 -104901.45  0.94%     -    0s
     0     0 -104885.29    0   74 -103921.54 -104885.29  0.93%     -    0s
     0     2 -104885.29    0   74 -103921.54 -104885.29  0.93%     -    0s
H  389   233                    -104311.0468 -104383.49  0.07%   4.5    0s
H  599    90                    -104322.1086 -104370.94  0.05%   4.2    0s

Cutting planes:
  Gomory: 35
  Implied bound: 1
  MIR: 190
  RLT: 17

Explored 799 nodes (3221 simplex iterations) in 0.25 seconds (0.08 work units)
Thread count was 32 (of 32 available processors)

Solution count 8: -104322 -104311 -103922 ... 1.36053e+13
No other solutions better than -104322

Optimal solution found (tolerance 1.00e-04)
Best objective -1.043221085681e+05, best bound -1.043221085681e+05, gap 0.0000%
  Subproblem solved in 0.28s
  Worst-case operational profit (Z_SP) = 128394.73
  Scenario: 11 demand increases, 49 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -104322.11
  [DEBUG]   S×d_nominal = 232716.84
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 232716.84 + -104322.11 = 128394.73
  [DEBUG]   Current θ from Master = 130743.78
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2349.05 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -5513.37
  Lower Bound (LB) = -4932.94
  Gap (UB-LB) = 1768.6102, Absolute Gap = 1768.6102, Relative Gap = 0.558922
  Not converged yet (gap = 1768.61 > ε = 200)

  [DEBUG] Adding NEW scenario 14 to Master Problem...
  [DEBUG] New scenario pattern: 11 increases, 49 decreases
    [DEBUG] Scenario 14 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 14 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 14]
    [DEBUG]   - Total constraints in model: 230733
    [DEBUG]   - Total variables in model: 95860
  [DEBUG] Total scenarios in Master: 15
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 15
================================================================================
[Iteration 15] Solving Master Problem...
  Current scenarios in Master: 15
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 230733 rows, 95860 columns and 653804 nonzeros
Model fingerprint: 0xef722539
Variable types: 93601 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 112110 rows and 45510 columns
Presolve time: 4.38s
Presolved: 118623 rows, 50350 columns, 732174 nonzeros
Variable types: 48091 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -366101.7227
Found heuristic solution: objective -171217.0927

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.43s

Barrier statistics:
 Dense cols : 557
 AA' NZ     : 6.044e+06
 Factor NZ  : 1.360e+07 (roughly 180 MB of memory)
 Factor Ops : 3.721e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.64478161e+07  2.01513468e+08  8.69e+04 1.85e+01  7.18e+04     7s
   1  -1.26838193e+07  1.79735383e+08  6.12e+04 4.79e+01  5.02e+04     7s
   2  -4.49743375e+06  1.35355017e+08  2.11e+04 2.44e+00  1.84e+04     7s
   3  -8.48880792e+05  9.88301534e+07  1.76e+03 1.17e+00  1.90e+03     7s
   4  -5.26314947e+05  7.02014435e+07  3.98e+02 7.05e-01  6.33e+02     7s
   5  -4.72988722e+05  3.78314094e+07  2.29e+02 3.25e-01  3.33e+02     7s
   6  -3.98404285e+05  2.86268741e+07  7.18e+01 2.32e-01  1.79e+02     7s
   7  -3.09187918e+05  2.19930572e+07  1.41e+01 1.71e-01  1.11e+02     7s
   8  -1.90913756e+05  1.47257551e+07  8.27e-01 1.13e-01  6.91e+01     8s
   9  -1.43886489e+05  2.61408591e+06  3.22e-01 1.96e-02  1.27e+01     8s
  10  -8.93706443e+04  1.31588033e+06  1.22e-01 9.62e-03  6.48e+00     8s
  11  -7.94942077e+04  1.03994726e+06  9.64e-02 7.60e-03  5.16e+00     8s
  12  -5.09145296e+04  5.86217923e+05  3.87e-02 4.15e-03  2.94e+00     8s
  13  -3.52374158e+04  2.49060037e+05  2.05e-02 1.75e-03  1.31e+00     8s
  14  -2.07479688e+04  1.56639927e+05  1.26e-02 1.05e-03  8.18e-01     8s
  15  -1.20741794e+04  1.11259384e+05  9.13e-03 7.17e-04  5.68e-01     8s
  16  -8.49503700e+03  7.59770421e+04  7.83e-03 6.17e-04  3.89e-01     9s
  17  -4.55647895e+03  6.14057377e+04  6.57e-03 4.57e-04  3.04e-01     9s
  18   1.09814604e+02  5.28424094e+04  5.11e-03 3.72e-04  2.43e-01     9s
  19   4.54728633e+03  3.94718129e+04  3.73e-03 2.28e-04  1.61e-01     9s
  20   8.94823661e+03  3.48214521e+04  2.47e-03 2.17e-04  1.19e-01     9s
  21   9.73888613e+03  2.94988933e+04  2.25e-03 1.52e-04  9.11e-02     9s
  22   1.20982130e+04  2.56768478e+04  1.66e-03 8.90e-05  6.26e-02    10s
  23   1.42231969e+04  2.41616815e+04  1.15e-03 6.73e-05  4.58e-02    10s
  24   1.56331291e+04  2.26211904e+04  8.18e-04 5.23e-05  3.22e-02    10s
  25   1.68751976e+04  2.14866706e+04  5.43e-04 4.49e-05  2.13e-02    10s
  26   1.75730759e+04  2.05919841e+04  3.99e-04 2.38e-05  1.39e-02    10s
  27   1.79466545e+04  2.03533469e+04  3.20e-04 1.84e-05  1.11e-02    10s
  28   1.82253283e+04  2.02131667e+04  2.61e-04 1.52e-05  9.16e-03    11s
  29   1.84418390e+04  2.00815070e+04  2.15e-04 1.24e-05  7.56e-03    11s
  30   1.88180325e+04  1.99220295e+04  1.36e-04 8.94e-06  5.09e-03    11s
  31   1.90533606e+04  1.97822459e+04  8.74e-05 5.85e-06  3.36e-03    11s
  32   1.91123826e+04  1.97654176e+04  7.60e-05 5.50e-06  3.01e-03    11s
  33   1.92525336e+04  1.96517898e+04  4.78e-05 3.04e-06  1.84e-03    11s
  34   1.94094237e+04  1.95938649e+04  1.66e-05 1.82e-06  8.50e-04    12s
  35   1.94418583e+04  1.95735214e+04  1.08e-05 1.38e-06  6.07e-04    12s
  36   1.94517763e+04  1.95382398e+04  9.12e-06 6.37e-07  3.99e-04    12s
  37   1.94787804e+04  1.95202050e+04  4.52e-06 2.88e-07  1.91e-04    12s
  38   1.94959283e+04  1.95100013e+04  1.67e-06 1.45e-07  6.49e-05    12s
  39   1.95049718e+04  1.95074960e+04  2.97e-07 1.66e-08  1.16e-05    12s
  40   1.95069183e+04  1.95072091e+04  8.39e-08 7.75e-07  1.34e-06    13s
  41   1.95069849e+04  1.95072087e+04  3.08e-06 5.92e-07  1.03e-06    13s
  42   1.95071490e+04  1.95072077e+04  8.09e-07 1.06e-07  2.70e-07    13s
  43   1.95071593e+04  1.95072076e+04  5.62e-06 8.56e-08  2.22e-07    13s
  44   1.95072068e+04  1.95072074e+04  8.23e-08 3.36e-07  3.10e-09    13s
  45   1.95072069e+04  1.95072074e+04  3.56e-06 2.72e-07  2.67e-09    13s
  46   1.95072069e+04  1.95072074e+04  3.46e-06 2.51e-07  2.47e-09    13s
  47   1.95072069e+04  1.95072074e+04  3.26e-06 2.38e-07  2.33e-09    14s
  48   1.95072070e+04  1.95072074e+04  2.71e-06 1.46e-07  1.93e-09    14s
  49   1.95072070e+04  1.95072074e+04  2.66e-06 1.45e-07  1.90e-09    14s
  50   1.95072071e+04  1.95072074e+04  2.56e-06 1.40e-07  1.82e-09    14s
  51   1.95072072e+04  1.95072074e+04  2.09e-06 8.59e-08  1.35e-09    14s
  52   1.95072072e+04  1.95072074e+04  3.06e-06 9.95e-08  1.05e-09    14s
  53   1.95072073e+04  1.95072074e+04  1.69e-06 1.42e-07  5.81e-10    14s

Barrier solved model in 53 iterations and 14.40 seconds (12.96 work units)
Optimal objective 1.95072073e+04


Root crossover log...

  105478 DPushes remaining with DInf 0.0000000e+00                14s
   55901 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                20s

    6762 PPushes remaining with PInf 2.4059967e-04                20s
    3280 PPushes remaining with PInf 1.5449748e-04                20s
       0 PPushes remaining with PInf 0.0000000e+00                21s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.7661243e+03     21s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   57607    1.9507207e+04   0.000000e+00   2.766124e+03     21s
   58066    1.9507207e+04   0.000000e+00   0.000000e+00     21s
   58066    1.9507207e+04   0.000000e+00   0.000000e+00     21s
Concurrent spin time: 1.34s

Solved with barrier

Root relaxation: objective 1.950721e+04, 58066 iterations, 17.47 seconds (22.27 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 19507.2074    0  162 -171217.09 19507.2074   111%     -   23s
H    0     0                    -170077.6774 19507.2074   111%     -   23s
H    0     0                    -156563.8244 19507.2074   112%     -   24s
H    0     0                    -146648.7154 19507.2074   113%     -   24s
H    0     0                    -146616.7237 19507.2074   113%     -   25s
H    0     0                    -146362.0572 19507.2074   113%     -   25s
H    0     0                    -146005.4994 19507.2074   113%     -   25s
H    0     0                    -69894.59137 19507.2074   128%     -   25s
H    0     0                    -20530.94081 19507.2074   195%     -   25s
H    0     0                    -20096.74534 19507.2074   197%     -   26s
H    0     0                    -20067.33329 19507.2074   197%     -   26s
H    0     0                    -18549.31658 15365.5194   183%     -   89s
H    0     0                    -18424.12085 15365.5194   183%     -   89s
H    0     0                    -18384.61630 15365.5194   184%     -   89s
H    0     0                    -18335.84783 15365.5194   184%     -   89s
H    0     0                    -18238.29938 15365.5194   184%     -   89s
     0     0 15362.4368    0  289 -18238.299 15362.4368   184%     -   89s
H    0     0                    -17932.85963 15362.4368   186%     -   90s
H    0     0                    -17335.86625 15362.4368   189%     -   90s
H    0     0                    -17179.33464 15362.4368   189%     -   90s
     0     0 14562.7049    0  298 -17179.335 14562.7049   185%     -  146s
     0     0 14560.8614    0  298 -17179.335 14560.8614   185%     -  154s
     0     0 14560.8614    0  295 -17179.335 14560.8614   185%     -  160s
     0     0 14560.8614    0  296 -17179.335 14560.8614   185%     -  165s
     0     0 14560.8614    0  301 -17179.335 14560.8614   185%     -  168s
     0     0 14560.8614    0  301 -17179.335 14560.8614   185%     -  169s
     0     0 14560.8614    0  299 -17179.335 14560.8614   185%     -  171s
     0     0 14560.8614    0  298 -17179.335 14560.8614   185%     -  174s
     0     0 14560.8614    0  303 -17179.335 14560.8614   185%     -  174s
H    0     0                    -15354.49897 11964.8431   178%     -  251s
H    0     0                    -13643.79867 11964.8431   188%     -  251s
H    0     0                    -13166.13427 11964.8431   191%     -  251s
H    0     0                    -12925.50025 11964.8431   193%     -  251s
H    0     0                    -12536.81358 11964.8431   195%     -  251s
H    0     0                    -12525.65245 11964.8431   196%     -  251s
     0     0 11964.8431    0  279 -12525.652 11964.8431   196%     -  251s
H    0     0                    -10756.95534 11964.7725   211%     -  252s
     0     0 11706.7340    0  288 -10756.955 11706.7340   209%     -  281s
     0     0 11475.9930    0  326 -10756.955 11475.9930   207%     -  313s
     0     0 11318.6935    0  325 -10756.955 11318.6935   205%     -  344s
     0     0 11285.9113    0  298 -10756.955 11285.9113   205%     -  358s
     0     0 11243.7790    0  344 -10756.955 11243.7790   205%     -  374s
     0     0 11160.4093    0  353 -10756.955 11160.4093   204%     -  399s
     0     0 11099.8747    0  343 -10756.955 11099.8747   203%     -  413s
     0     0 11085.5197    0  352 -10756.955 11085.5197   203%     -  420s
H    0     0                    -9196.379716 11041.5942   220%     -  441s
     0     0 11041.5942    0  358 -9196.3797 11041.5942   220%     -  441s
     0     0 11036.1390    0  352 -9196.3797 11036.1390   220%     -  446s
     0     0 11001.5853    0  350 -9196.3797 11001.5853   220%     -  457s
     0     0 10981.2398    0  345 -9196.3797 10981.2398   219%     -  464s
     0     0 10977.2587    0  347 -9196.3797 10977.2587   219%     -  467s
     0     0 10972.2757    0  341 -9196.3797 10972.2757   219%     -  469s
     0     0 10971.9845    0  348 -9196.3797 10971.9845   219%     -  470s
H    0     0                    -8390.470424 9652.62310   215%     -  591s
H    0     0                    -8260.066126 9652.62310   217%     -  591s
H    0     0                    -8017.818663 9652.62310   220%     -  591s
H    0     0                    -7993.442512 9652.62310   221%     -  591s
H    0     0                    -7866.752941 9652.62310   223%     -  591s
     0     0 9652.62310    0  370 -7866.7529 9652.62310   223%     -  591s
H    0     0                    -6441.013221 9652.22771   250%     -  592s
     0     0 9267.86136    0  331 -6441.0132 9267.86136   244%     -  634s
H    0     0                    -6427.718246 9156.56116   242%     -  666s
H    0     0                    -6235.232127 9156.56116   247%     -  666s
     0     0 9156.56116    0  384 -6235.2321 9156.56116   247%     -  666s
     0     0 9111.39211    0  372 -6235.2321 9111.39211   246%     -  680s
     0     0 9089.08996    0  383 -6235.2321 9089.08996   246%     -  688s
     0     0 9071.11718    0  457 -6235.2321 9071.11718   245%     -  697s
     0     0 9038.32808    0  390 -6235.2321 9038.32808   245%     -  709s
     0     0 9021.63303    0  390 -6235.2321 9021.63303   245%     -  718s
     0     0 8982.37113    0  388 -6235.2321 8982.37113   244%     -  728s
     0     0 8981.27845    0  394 -6235.2321 8981.27845   244%     -  730s
H    0     0                    -5879.347711 8981.27845   253%     -  747s
H    0     0                    -5870.058096 8981.27845   253%     -  747s
H    0     0                    -5759.742299 8981.27845   256%     -  747s
H    0     0                    -5388.879826 8981.27845   267%     -  747s
     0     0 8327.88113    0  418 -5388.8798 8327.88113   255%     -  783s
     0     0 8153.16130    0  423 -5388.8798 8153.16130   251%     -  802s
     0     0 8035.66450    0  430 -5388.8798 8035.66450   249%     -  819s
     0     0 7973.40867    0  427 -5388.8798 7973.40867   248%     -  835s
     0     0 7932.31261    0  428 -5388.8798 7932.31261   247%     -  843s
     0     0 7893.78008    0  428 -5388.8798 7893.78008   246%     -  854s
     0     0 7868.23177    0  427 -5388.8798 7868.23177   246%     -  861s
     0     0 7856.68396    0  464 -5388.8798 7856.68396   246%     -  869s
     0     0 7837.35127    0  424 -5388.8798 7837.35127   245%     -  874s
     0     0 7809.06406    0  430 -5388.8798 7809.06406   245%     -  886s
     0     0 7802.25922    0  435 -5388.8798 7802.25922   245%     -  894s
     0     0 7798.71143    0  436 -5388.8798 7798.71143   245%     -  898s
H    0     0                    -5224.423429 7741.82047   248%     -  911s
H    0     0                    -4683.929053 7741.82047   265%     -  911s
H    0     0                    -4601.602897 7741.82047   268%     -  911s
H    0     0                    -4426.734085 7741.82047   275%     -  911s
H    0     0                    -4300.748762 7741.82047   280%     -  911s
H    0     0                    -4293.468856 7741.82047   280%     -  911s
H    0     0                    -4152.301936 7741.82047   286%     -  911s
H    0     0                    -4075.726846 7741.82047   290%     -  911s
H    0     0                    -4069.320910 7741.82047   290%     -  911s
H    0     0                    -4048.862856 7741.82047   291%     -  911s
     0     0 7741.82047    0  426 -4048.8629 7741.82047   291%     -  911s
     0     0 7724.75836    0  421 -4048.8629 7724.75836   291%     -  917s
     0     0 7721.52182    0  419 -4048.8629 7721.52182   291%     -  920s
     0     0 7719.10185    0  422 -4048.8629 7719.10185   291%     -  922s
     0     0 7705.93931    0  452 -4048.8629 7705.93931   290%     -  927s
     0     0 7674.31551    0  426 -4048.8629 7674.31551   290%     -  933s
     0     0 7671.25270    0  461 -4048.8629 7671.25270   289%     -  936s
     0     0 7644.61925    0  507 -4048.8629 7644.61925   289%     -  943s
     0     0 7629.31942    0  443 -4048.8629 7629.31942   288%     -  948s
     0     0 7627.55003    0  481 -4048.8629 7627.55003   288%     -  952s
     0     0 7626.71475    0  481 -4048.8629 7626.71475   288%     -  954s
     0     0 7543.61473    0  470 -4048.8629 7543.61473   286%     -  969s
     0     0 7511.03164    0  510 -4048.8629 7511.03164   286%     -  981s
H    0     0                    -3920.238605 7487.71398   291%     -  988s
     0     0 7487.71398    0  508 -3920.2386 7487.71398   291%     -  988s
     0     0 7485.45189    0  476 -3920.2386 7485.45189   291%     -  990s
     0     0 7479.19643    0  469 -3920.2386 7479.19643   291%     -  995s
     0     0 7476.36322    0  478 -3920.2386 7476.36322   291%     -  997s
     0     0 7475.14201    0  474 -3920.2386 7475.14201   291%     -  999s
     0     0 7247.29026    0  467 -3920.2386 7247.29026   285%     - 1021s
     0     0 7201.63681    0  438 -3920.2386 7201.63681   284%     - 1036s
     0     0 7178.46868    0  470 -3920.2386 7178.46868   283%     - 1046s
     0     0 7170.21065    0  428 -3920.2386 7170.21065   283%     - 1053s
     0     0 7164.26561    0  434 -3920.2386 7164.26561   283%     - 1057s
     0     0 7160.68139    0  434 -3920.2386 7160.68139   283%     - 1060s
     0     0 7160.08250    0  436 -3920.2386 7160.08250   283%     - 1061s
     0     0 7107.86989    0  430 -3920.2386 7107.86989   281%     - 1079s
H    0     0                    -3776.048376 7107.37165   288%     - 1080s
     0     0 7096.00481    0  467 -3776.0484 7096.00481   288%     - 1092s
     0     0 7087.87139    0  482 -3776.0484 7087.87139   288%     - 1099s
     0     0 7084.74939    0  465 -3776.0484 7084.74939   288%     - 1106s
     0     0 7082.94982    0  480 -3776.0484 7082.94982   288%     - 1113s
     0     0 7077.45697    0  484 -3776.0484 7077.45697   287%     - 1122s
     0     0 7075.36531    0  481 -3776.0484 7075.36531   287%     - 1127s
     0     0 7074.73645    0  485 -3776.0484 7074.73645   287%     - 1129s
     0     0 7052.57159    0  505 -3776.0484 7052.57159   287%     - 1140s
     0     0 7035.85732    0  440 -3776.0484 7035.85732   286%     - 1148s
     0     0 7030.94896    0  515 -3776.0484 7030.94896   286%     - 1151s
H    0     0                    -3710.611742 7028.71651   289%     - 1155s
     0     0 7028.71651    0  515 -3710.6117 7028.71651   289%     - 1155s
     0     0 7027.59007    0  516 -3710.6117 7027.59007   289%     - 1158s
     0     0 7021.86502    0  437 -3710.6117 7021.86502   289%     - 1164s
H    0     0                    -3678.505431 7021.85846   291%     - 1164s
     0     0 7020.39234    0  436 -3678.5054 7020.39234   291%     - 1168s
     0     0 7011.13577    0  436 -3678.5054 7011.13577   291%     - 1176s
     0     0 7008.70822    0  437 -3678.5054 7008.70822   291%     - 1181s
H    0     0                    -3551.317063 7004.16911   297%     - 1186s
     0     0 7004.16911    0  433 -3551.3171 7004.16911   297%     - 1186s
     0     0 7002.07220    0  436 -3551.3171 7002.07220   297%     - 1188s
     0     0 6998.74691    0  437 -3551.3171 6998.74691   297%     - 1192s
     0     0 6997.89686    0  440 -3551.3171 6997.89686   297%     - 1194s
     0     0 6991.62029    0  433 -3551.3171 6991.62029   297%     - 1201s
     0     0 6989.64586    0  444 -3551.3171 6989.64586   297%     - 1205s
     0     0 6987.34423    0  436 -3551.3171 6987.34423   297%     - 1209s
     0     0 6986.00537    0  443 -3551.3171 6986.00537   297%     - 1214s
     0     0 6970.87242    0  440 -3551.3171 6970.87242   296%     - 1227s
H    0     0                    -3481.818331 6970.82316   300%     - 1228s
     0     0 6966.91251    0  439 -3481.8183 6966.91251   300%     - 1231s
     0     0 6966.28255    0  489 -3481.8183 6966.28255   300%     - 1234s
     0     0 6965.00451    0  442 -3481.8183 6965.00451   300%     - 1239s
H    0     0                    -3466.411235 6964.98983   301%     - 1240s
     0     0 6964.02125    0  433 -3466.4112 6964.02125   301%     - 1242s
     0     0 6952.55155    0  438 -3466.4112 6952.55155   301%     - 1249s
     0     0 6949.21840    0  446 -3466.4112 6949.21840   300%     - 1253s
     0     0 6948.50133    0  437 -3466.4112 6948.50133   300%     - 1255s
     0     0 6947.50823    0  441 -3466.4112 6947.50823   300%     - 1258s
     0     0 6947.04723    0  441 -3466.4112 6947.04723   300%     - 1265s
H    0     0                    -3350.900736 6947.04723   307%     - 1490s
     0     2 6947.04723    0  441 -3350.9007 6947.04723   307%     - 1493s
     1     3 5938.55557    1  357 -3350.9007 6947.04723   307% 21246 1528s
     2     4 6883.92280    1  432 -3350.9007 6883.92280   305% 13522 1544s
     3     8 6635.88707    2  421 -3350.9007 6883.80336   305% 12342 1559s
     7    14 4869.24000    3  366 -3350.9007 6766.73002   302% 10742 1611s
    13    27 4794.04168    4  368 -3350.9007 6634.98414   298% 12337 1651s
    26    40 4877.12920    5  355 -3350.9007 6548.73159   295% 19626 1755s
    39    69 5246.03191    5  355 -3350.9007 6481.33158   293% 18610 2021s
H   42    69                    -3255.385508 6481.33158   299% 18276 2021s
    70   168 4920.25327    6  357 -3255.3855 6481.33158   299% 19300 2088s
   181   197 4590.34667    8  327 -3255.3855 6481.33158   299% 12753 2124s
H  186   197                    -3131.293119 6481.33158   307% 12558 2125s
H  214   265                    -3127.352616 6481.33158   307% 12195 2163s
   294   295 -828.77514   10  209 -3127.3526 6481.33158   307% 10169 2191s
   331   333 4381.49343   11  329 -3127.3526 6481.33158   307%  9635 2223s
   383   365 2226.86749   12  257 -3127.3526 6481.33158   307%  9073 2254s
H  440   408                    -3116.400976 6481.33158   308%  8517 2292s
   495   455     cutoff   11      -3116.4010 6481.33158   308%  8398 2323s
   556   512 3850.73966   14  314 -3116.4010 6481.33158   308%  8323 2360s
   625   568 1306.48750   15  212 -3116.4010 6481.33158   308%  8069 2393s
   695   634 2927.89857   15  310 -3116.4010 6481.33158   308%  7828 2421s
   769   711 1524.97044   15  307 -3116.4010 6481.33158   308%  7723 2445s
   854   778  431.48580   21  212 -3116.4010 5759.25320   285%  7519 2469s
   941   834 2879.39732   16  308 -3116.4010 5759.25320   285%  7295 2501s
  1009   903 2450.03447   19  294 -3116.4010 5543.03177   278%  7193 2530s
  1098   967 2387.75138   20  296 -3116.4010 5543.03177   278%  7077 2553s
  1188  1018 2257.05668   22  293 -3116.4010 5543.03177   278%  6999 2581s
  1287  1028 2081.34619   22  277 -3116.4010 5543.03177   278%  6865 2612s
  1343  1054 2210.67869   23  284 -3116.4010 5543.03177   278%  6856 2642s
  1407  1112 1909.42307   24  260 -3116.4010 5543.03177   278%  6826 2673s
  1481  1172     cutoff   24      -3116.4010 5543.03177   278%  6896 2705s
  1575  1256     cutoff   25      -3116.4010 5487.26152   276%  6874 2741s
  1687  1338 1632.87573   27  257 -3116.4010 5487.26152   276%  6796 2767s
  1827  1408  609.10475   28  167 -3116.4010 5487.26152   276%  6646 2800s
  1969  1473 1260.78660   29  248 -3116.4010 5487.26152   276%  6510 2837s
  2080  1548  366.79107   34  292 -3116.4010 5487.26152   276%  6527 2881s
  2221  1618  977.79970   34  290 -3116.4010 5365.60535   272%  6455 2931s
  2352  1659  586.47785   37  269 -3116.4010 5365.60535   272%  6434 2974s
  2409  1732  535.93076   38  268 -3116.4010 5365.60535   272%  6483 3017s
  2508  1810     cutoff   38      -3116.4010 5365.60535   272%  6481 3055s
  2613  1877  493.06382   40  262 -3116.4010 5365.60535   272%  6498 3097s
  2749  1934 -105.08135   46  349 -3116.4010 5365.60535   272%  6480 3148s
  2864  1994 -1186.0235   47  380 -3116.4010 5365.60535   272%  6525 3201s
  2976  2082 -735.20700   46  296 -3116.4010 5365.60535   272%  6616 3247s
  3116  2174 -1366.9471   48  346 -3116.4010 5365.60535   272%  6630 3296s
  3264  2309 -2007.4335   51  287 -3116.4010 5272.94553   269%  6692 3352s
  3445  2399     cutoff   58      -3116.4010 5067.11129   263%  6696 3406s
  3628  2490 3112.85909    6  456 -3116.4010 5067.11129   263%  6698 3464s
  3795  2621 2844.76509    7  463 -3116.4010 5067.11129   263%  6750 3535s

Cutting planes:
  Learned: 2
  Gomory: 1
  Implied bound: 82
  MIR: 1975
  Flow cover: 2556
  Zero half: 2
  RLT: 41
  Relax-and-lift: 229

Explored 3962 nodes (27698602 simplex iterations) in 3600.13 seconds (5460.55 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -3116.4 -3127.35 -3131.29 ... -3710.61

Time limit reached
Best objective -3.116400976436e+03, best bound 5.067111291964e+03, gap 262.5950%
  WARNING: Time limit reached. Using best solution found (gap: 262.59%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.17s
  Master Objective (UB) = -3116.40, θ = 131281.75
  Upper Bound (UB) = -3116.40

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 131281.75
  [DEBUG]   ✓ Scenario 0: θ = 131281.75 ≤ Q = 131281.75 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 131281.75 ≤ Q = 131281.75 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 131281.75 ≤ Q = 131281.75 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 131281.75 ≤ Q = 131281.75 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 131281.75 ≤ Q = 131281.75 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 131281.75 ≤ Q = 131281.75 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 131281.75 ≤ Q = 131281.75 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 131281.75 ≤ Q = 131281.75 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 131281.75 ≤ Q = 131281.75 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 131281.75 ≤ Q = 131281.75 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 131281.75 ≤ Q = 131281.75 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 131281.75 ≤ Q = 131281.75 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 131281.75 ≤ Q = 131281.75 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 131281.75 ≤ Q = 131281.75 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 131281.75 ≤ Q = 131281.75 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 15] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x57f0ebe
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x057f0ebe
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.377806e+13
Presolve removed 2625 rows and 1918 columns
Presolve time: 0.01s
Presolved: 468 rows, 471 columns, 1319 nonzeros
Found heuristic solution: objective 6481729.2623
Variable types: 319 continuous, 152 integer (152 binary)

Root relaxation: objective -1.352185e+05, 240 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -135218.49    0  123 6481729.26 -135218.49   102%     -    0s
H    0     0                    -103690.8711 -135218.49  30.4%     -    0s
H    0     0                    -104286.7557 -135218.49  29.7%     -    0s
     0     0 -112461.87    0   79 -104286.76 -112461.87  7.84%     -    0s
H    0     0                    -110023.6434 -112338.44  2.10%     -    0s
     0     0 -111687.64    0   81 -110023.64 -111687.64  1.51%     -    0s
H    0     0                    -110592.8796 -111682.73  0.99%     -    0s
     0     0 -111674.72    0   80 -110592.88 -111674.72  0.98%     -    0s
     0     0 -111354.07    0   65 -110592.88 -111354.07  0.69%     -    0s
     0     0 -111280.88    0   56 -110592.88 -111280.88  0.62%     -    0s
     0     0 -111277.14    0   57 -110592.88 -111277.14  0.62%     -    0s
     0     0 -111090.29    0   46 -110592.88 -111090.29  0.45%     -    0s
     0     0 -111031.73    0   51 -110592.88 -111031.73  0.40%     -    0s
     0     0 -111023.34    0   50 -110592.88 -111023.34  0.39%     -    0s
     0     0 -110821.39    0   11 -110592.88 -110821.39  0.21%     -    0s
     0     0 -110708.90    0    7 -110592.88 -110708.90  0.10%     -    0s
     0     0 -110661.51    0    3 -110592.88 -110661.51  0.06%     -    0s
     0     0 -110656.26    0    7 -110592.88 -110656.26  0.06%     -    0s
H    0     0                    -110619.0665 -110656.26  0.03%     -    0s
H    0     0                    -110637.7895 -110656.26  0.02%     -    0s

Cutting planes:
  Gomory: 1
  Implied bound: 2
  MIR: 4
  Flow cover: 3
  RLT: 3

Explored 1 nodes (709 simplex iterations) in 0.14 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 8: -110638 -110619 -110593 ... 1.37781e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.106377895355e+05, best bound -1.106472595647e+05, gap 0.0086%
  Subproblem solved in 0.17s
  Worst-case operational profit (Z_SP) = 126919.24
  Scenario: 36 demand increases, 24 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -110637.79
  [DEBUG]   S×d_nominal = 237557.03
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 237557.03 + -110637.79 = 126919.24
  [DEBUG]   Current θ from Master = 131281.75
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4362.51 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -7478.91
  Lower Bound (LB) = -4932.94
  Gap (UB-LB) = 1816.5344, Absolute Gap = 1816.5344, Relative Gap = 0.582895
  Not converged yet (gap = 1816.53 > ε = 200)

  [DEBUG] Adding NEW scenario 15 to Master Problem...
  [DEBUG] New scenario pattern: 36 increases, 24 decreases
    [DEBUG] Scenario 15 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 15 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 15]
    [DEBUG]   - Total constraints in model: 246023
    [DEBUG]   - Total variables in model: 102100
  [DEBUG] Total scenarios in Master: 16
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 16
================================================================================
[Iteration 16] Solving Master Problem...
  Current scenarios in Master: 16
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 246023 rows, 102100 columns and 697023 nonzeros
Model fingerprint: 0x691df550
Variable types: 99841 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 119584 rows and 48544 columns
Presolve time: 4.12s
Presolved: 126439 rows, 53556 columns, 780281 nonzeros
Variable types: 51297 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -366101.7227
Found heuristic solution: objective -171217.0927

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.75s

Barrier statistics:
 Dense cols : 557
 AA' NZ     : 6.786e+06
 Factor NZ  : 1.453e+07 (roughly 200 MB of memory)
 Factor Ops : 3.073e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.64498033e+07  2.13410647e+08  8.69e+04 1.80e+01  7.15e+04     8s
   1  -1.27212706e+07  1.90295578e+08  6.13e+04 4.56e+01  5.01e+04     8s
   2  -4.71908560e+06  1.43291108e+08  2.21e+04 2.91e+00  1.92e+04     8s
   3  -8.56606862e+05  1.05340375e+08  1.80e+03 1.63e+00  1.92e+03     8s
   4  -5.31039768e+05  7.53279657e+07  4.04e+02 9.56e-01  6.38e+02     8s
   5  -4.75286396e+05  4.10961037e+07  2.25e+02 4.41e-01  3.34e+02     8s
   6  -4.04506977e+05  3.08034592e+07  7.32e+01 3.09e-01  1.81e+02     8s
   7  -3.21098104e+05  2.32261222e+07  1.50e+01 2.24e-01  1.10e+02     9s
   8  -2.03249027e+05  1.45602238e+07  7.90e-01 1.39e-01  6.42e+01     9s
   9  -1.42984383e+05  2.36152013e+06  2.39e-01 2.19e-02  1.09e+01     9s
  10  -9.00173675e+04  1.53726054e+06  9.48e-02 1.42e-02  7.05e+00     9s
  11  -7.98140303e+04  1.10210632e+06  7.33e-02 1.01e-02  5.12e+00     9s
  12  -4.72217169e+04  5.13513648e+05  2.65e-02 4.39e-03  2.43e+00     9s
  13  -2.76258074e+04  2.25356268e+05  1.39e-02 1.93e-03  1.09e+00     9s
  14  -1.53919962e+04  1.41244626e+05  7.76e-03 1.37e-03  6.78e-01     9s
  15  -1.05835338e+04  1.04441144e+05  6.24e-03 9.96e-04  4.98e-01     9s
  16  -5.58655779e+03  7.81259674e+04  4.92e-03 7.04e-04  3.62e-01     9s
  17  -1.79602336e+03  5.77579424e+04  4.03e-03 4.72e-04  2.58e-01    10s
  18   2.51711170e+03  4.89814145e+04  3.04e-03 3.69e-04  2.01e-01    10s
  19   5.79728520e+03  3.76810047e+04  2.34e-03 2.60e-04  1.38e-01    10s
  20   9.84802949e+03  3.39836652e+04  1.54e-03 2.10e-04  1.04e-01    10s
  21   1.19037763e+04  2.92075820e+04  1.17e-03 1.43e-04  7.49e-02    10s
  22   1.34414762e+04  2.53873807e+04  9.04e-04 8.72e-05  5.17e-02    10s
  23   1.56856890e+04  2.38134901e+04  5.40e-04 6.39e-05  3.52e-02    11s
  24   1.64090426e+04  2.22897066e+04  4.26e-04 4.19e-05  2.54e-02    11s
  25   1.75153098e+04  2.13881962e+04  2.71e-04 2.80e-05  1.68e-02    11s
  26   1.80808341e+04  2.07774739e+04  1.90e-04 1.86e-05  1.17e-02    11s
  27   1.85154015e+04  2.03700184e+04  1.29e-04 1.25e-05  8.02e-03    11s
  28   1.87307767e+04  2.00912122e+04  9.95e-05 8.36e-06  5.89e-03    11s
  29   1.89484768e+04  1.99154290e+04  7.03e-05 5.79e-06  4.18e-03    11s
  30   1.90833913e+04  1.99031015e+04  5.33e-05 5.64e-06  3.55e-03    12s
  31   1.91321905e+04  1.97647172e+04  4.69e-05 3.68e-06  2.74e-03    12s
  32   1.92689208e+04  1.97057915e+04  2.96e-05 2.88e-06  1.89e-03    12s
  33   1.93588624e+04  1.96317129e+04  1.78e-05 1.82e-06  1.18e-03    12s
  34   1.94320656e+04  1.95626115e+04  8.62e-06 1.20e-06  5.65e-04    12s
  35   1.94697721e+04  1.95215380e+04  4.12e-06 6.77e-07  2.24e-04    12s
  36   1.94939622e+04  1.95131698e+04  1.40e-06 2.81e-07  8.31e-05    12s
  37   1.95050520e+04  1.95126047e+04  1.66e-07 2.57e-07  3.27e-05    13s
  38   1.95063447e+04  1.95082894e+04  7.64e-08 4.95e-08  8.42e-06    13s
  39   1.95064064e+04  1.95082002e+04  1.52e-07 4.59e-08  7.77e-06    13s
  40   1.95071524e+04  1.95072146e+04  1.01e-08 2.72e-08  2.69e-07    13s
  41   1.95072030e+04  1.95072075e+04  7.01e-08 1.04e-09  1.94e-08    13s
  42   1.95072024e+04  1.95072075e+04  8.60e-06 8.97e-09  1.94e-08    13s
  43   1.95072024e+04  1.95072075e+04  8.58e-06 8.77e-09  1.95e-08    13s
  44   1.95072026e+04  1.95072075e+04  9.10e-06 8.55e-09  1.89e-08    14s
  45   1.95072074e+04  1.95072074e+04  5.33e-08 9.04e-07  1.10e-10    14s

Barrier solved model in 45 iterations and 13.74 seconds (13.50 work units)
Optimal objective 1.95072074e+04


Root crossover log...

  112286 DPushes remaining with DInf 0.0000000e+00                14s
   45165 DPushes remaining with DInf 0.0000000e+00                15s
     886 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                21s

    2503 PPushes remaining with PInf 1.1610810e-05                21s
       0 PPushes remaining with PInf 0.0000000e+00                21s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.4910451e-02     21s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   51952    1.9507207e+04   0.000000e+00   2.491045e-02     21s
   51954    1.9507207e+04   0.000000e+00   0.000000e+00     21s
   51954    1.9507207e+04   0.000000e+00   0.000000e+00     21s
Concurrent spin time: 4.40s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 1.950721e+04, 51954 iterations, 20.43 seconds (23.10 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 19507.2074    0  162 -171217.09 19507.2074   111%     -   26s
H    0     0                    -169866.1672 19507.2074   111%     -   26s
H    0     0                    -79411.84465 19507.2074   125%     -   27s
H    0     0                    -21784.21394 19507.2074   190%     -   27s
H    0     0                    -21136.14037 19507.2074   192%     -   28s
H    0     0                    -20096.74534 19507.2074   197%     -   28s
H    0     0                    -20067.33329 19507.2074   197%     -   28s
     0     0 15367.2840    0  282 -20067.333 15367.2840   177%     -   89s
H    0     0                    -18833.10248 15367.0963   182%     -   90s
H    0     0                    -17210.65202 15367.0963   189%     -   90s
H    0     0                    -17156.21239 15367.0963   190%     -   90s
H    0     0                    -17085.45628 15367.0963   190%     -   90s
H    0     0                    -17045.95174 15367.0963   190%     -   90s
H    0     0                    -15513.98437 14600.3381   194%     -  138s
H    0     0                    -15297.86935 14600.3381   195%     -  138s
H    0     0                    -15258.36481 14600.3381   196%     -  138s
     0     0 14600.3381    0  301 -15258.365 14600.3381   196%     -  138s
     0     0 14567.4573    0  299 -15258.365 14567.4573   195%     -  144s
     0     0 14563.4147    0  301 -15258.365 14563.4147   195%     -  148s
     0     0 14563.4147    0  303 -15258.365 14563.4147   195%     -  149s
     0     0 14563.4147    0  299 -15258.365 14563.4147   195%     -  153s
     0     0 14563.4147    0  299 -15258.365 14563.4147   195%     -  154s
H    0     0                    -12990.57676 12133.4860   193%     -  223s
H    0     0                    -12514.56109 12133.4860   197%     -  223s
H    0     0                    -11980.78510 12133.4860   201%     -  223s
H    0     0                    -11934.93806 12133.4860   202%     -  223s
H    0     0                    -11480.66898 12133.4860   206%     -  223s
H    0     0                    -11178.08544 12133.4860   209%     -  223s
H    0     0                    -11047.02157 12133.4860   210%     -  223s
H    0     0                    -10935.82103 12133.4860   211%     -  223s
     0     0 12133.4860    0  289 -10935.821 12133.4860   211%     -  223s
     0     0 11602.3565    0  286 -10935.821 11602.3565   206%     -  279s
     0     0 11424.7774    0  340 -10935.821 11424.7774   204%     -  301s
     0     0 11280.0259    0  364 -10935.821 11280.0259   203%     -  324s
     0     0 11235.4956    0  363 -10935.821 11235.4956   203%     -  340s
     0     0 11138.4511    0  421 -10935.821 11138.4511   202%     -  356s
     0     0 11060.1183    0  366 -10935.821 11060.1183   201%     -  370s
     0     0 10989.2282    0  377 -10935.821 10989.2282   200%     -  392s
     0     0 10986.2556    0  416 -10935.821 10986.2556   200%     -  398s
     0     0 10984.7417    0  416 -10935.821 10984.7417   200%     -  401s
     0     0 10984.7195    0  416 -10935.821 10984.7195   200%     -  402s
H    0     0                    -10809.53267 9612.81601   189%     -  490s
H    0     0                    -10584.07125 9612.81601   191%     -  490s
H    0     0                    -10453.64743 9612.81601   192%     -  490s
H    0     0                    -10437.48447 9612.81601   192%     -  490s
     0     0 9612.81601    0  370 -10437.484 9612.81601   192%     -  490s
H    0     0                    -9336.364775 9176.86008   198%     -  527s
     0     0 9176.86008    0  384 -9336.3648 9176.86008   198%     -  527s
     0     0 9088.29198    0  390 -9336.3648 9088.29198   197%     -  545s
     0     0 9054.79904    0  395 -9336.3648 9054.79904   197%     -  557s
     0     0 9034.92287    0  373 -9336.3648 9034.92287   197%     -  566s
     0     0 9027.46514    0  394 -9336.3648 9027.46514   197%     -  572s
     0     0 9004.48316    0  394 -9336.3648 9004.48316   196%     -  582s
     0     0 8997.74968    0  389 -9336.3648 8997.74968   196%     -  587s
     0     0 8900.88956    0  385 -9336.3648 8900.88956   195%     -  602s
     0     0 8804.92527    0  393 -9336.3648 8804.92527   194%     -  622s
     0     0 8772.56072    0  390 -9336.3648 8772.56072   194%     -  636s
     0     0 8749.85764    0  400 -9336.3648 8749.85764   194%     -  648s
H    0     0                    -9075.343577 8741.40281   196%     -  653s
     0     0 8741.40281    0  404 -9075.3436 8741.40281   196%     -  653s
H    0     0                    -8942.889908 8730.87203   198%     -  661s
H    0     0                    -5640.754353 8730.87203   255%     -  661s
     0     0 8730.87203    0  399 -5640.7544 8730.87203   255%     -  661s
H    0     0                    -5581.036751 8699.63405   256%     -  672s
H    0     0                    -5529.339601 8699.63405   257%     -  672s
H    0     0                    -4503.132759 8699.63405   293%     -  672s
     0     0 8699.63405    0  391 -4503.1328 8699.63405   293%     -  672s
     0     0 8687.04541    0  398 -4503.1328 8687.04541   293%     -  676s
     0     0 8685.11868    0  393 -4503.1328 8685.11868   293%     -  680s
     0     0 8679.81214    0  406 -4503.1328 8679.81214   293%     -  684s
     0     0 8637.74832    0  384 -4503.1328 8637.74832   292%     -  696s
     0     0 8613.03475    0  382 -4503.1328 8613.03475   291%     -  708s
     0     0 8608.31067    0  393 -4503.1328 8608.31067   291%     -  715s
     0     0 8601.79930    0  397 -4503.1328 8601.79930   291%     -  722s
     0     0 8601.47317    0  397 -4503.1328 8601.47317   291%     -  724s
H    0     0                    -4498.669740 8601.47317   291%     -  738s
H    0     0                    -4355.691333 8178.07694   288%     -  775s
     0     0 8178.07694    0  416 -4355.6913 8178.07694   288%     -  775s
     0     0 7938.66713    0  423 -4355.6913 7938.66713   282%     -  800s
     0     0 7896.52191    0  427 -4355.6913 7896.52191   281%     -  815s
     0     0 7836.71988    0  434 -4355.6913 7836.71988   280%     -  831s
     0     0 7807.63264    0  434 -4355.6913 7807.63264   279%     -  846s
     0     0 7752.90181    0  430 -4355.6913 7752.90181   278%     -  854s
     0     0 7735.99119    0  434 -4355.6913 7735.99119   278%     -  863s
     0     0 7720.74574    0  434 -4355.6913 7720.74574   277%     -  868s
     0     0 7717.90392    0  439 -4355.6913 7717.90392   277%     -  871s
     0     0 7709.10651    0  439 -4355.6913 7709.10651   277%     -  874s
     0     0 7706.98291    0  438 -4355.6913 7706.98291   277%     -  877s
     0     0 7705.97178    0  443 -4355.6913 7705.97178   277%     -  879s
     0     0 7571.18929    0  441 -4355.6913 7571.18929   274%     -  903s
H    0     0                    -4244.360304 7570.85850   278%     -  904s
     0     0 7530.69070    0  473 -4244.3603 7530.69070   277%     -  921s
H    0     0                    -4001.967517 7517.33609   288%     -  927s
     0     0 7517.33609    0  452 -4001.9675 7517.33609   288%     -  928s
     0     0 7509.28644    0  449 -4001.9675 7509.28644   288%     -  934s
H    0     0                    -3995.113157 7505.70803   288%     -  938s
     0     0 7505.70803    0  455 -3995.1132 7505.70803   288%     -  938s
     0     0 7504.81275    0  454 -3995.1132 7504.81275   288%     -  941s
H    0     0                    -3937.292138 7293.49686   285%     -  971s
     0     0 7293.49686    0  467 -3937.2921 7293.49686   285%     -  971s
H    0     0                    -3793.469895 7293.28776   292%     -  988s
H    0     0                    -3709.333315 7293.28776   297%     -  988s
     0     0 7279.45482    0  530 -3709.3333 7279.45482   296%     -  996s
     0     0 7271.66553    0  474 -3709.3333 7271.66553   296%     - 1001s
     0     0 7268.33918    0  481 -3709.3333 7268.33918   296%     - 1005s
     0     0 7266.91155    0  477 -3709.3333 7266.91155   296%     - 1008s
H    0     0                    -3452.914229 7211.29767   309%     - 1022s
     0     0 7211.29767    0  467 -3452.9142 7211.29767   309%     - 1022s
     0     0 7202.18153    0  476 -3452.9142 7202.18153   309%     - 1032s
     0     0 7194.39463    0  450 -3452.9142 7194.39463   308%     - 1039s
     0     0 7190.10051    0  484 -3452.9142 7190.10051   308%     - 1043s
     0     0 7188.32234    0  448 -3452.9142 7188.32234   308%     - 1044s
     0     0 7187.16178    0  488 -3452.9142 7187.16178   308%     - 1046s
     0     0 7175.21734    0  448 -3452.9142 7175.21734   308%     - 1052s
H    0     0                    -3370.184234 7175.11494   313%     - 1072s
     0     0 7171.02000    0  438 -3370.1842 7171.02000   313%     - 1078s
     0     0 7169.35844    0  448 -3370.1842 7169.35844   313%     - 1082s
     0     0 7168.76217    0  450 -3370.1842 7168.76217   313%     - 1083s
     0     0 7159.33286    0  445 -3370.1842 7159.33286   312%     - 1093s
     0     0 7150.33759    0  450 -3370.1842 7150.33759   312%     - 1102s
     0     0 7147.93530    0  448 -3370.1842 7147.93530   312%     - 1105s
     0     0 7147.55729    0  451 -3370.1842 7147.55729   312%     - 1107s
     0     0 7121.41983    0  603 -3370.1842 7121.41983   311%     - 1120s
     0     0 7108.49873    0  477 -3370.1842 7108.49873   311%     - 1151s
     0     0 7103.77034    0  472 -3370.1842 7103.77034   311%     - 1154s
     0     0 7101.15368    0  480 -3370.1842 7101.15368   311%     - 1157s
     0     0 7099.04721    0  453 -3370.1842 7099.04721   311%     - 1160s
     0     0 7098.27566    0  447 -3370.1842 7098.27566   311%     - 1162s
     0     0 7084.51403    0  443 -3370.1842 7084.51403   310%     - 1168s
     0     0 7082.88282    0  446 -3370.1842 7082.88282   310%     - 1170s
     0     0 7082.58806    0  446 -3370.1842 7082.58806   310%     - 1171s
     0     0 7077.42620    0  445 -3370.1842 7077.42620   310%     - 1177s
     0     0 7075.79176    0  480 -3370.1842 7075.79176   310%     - 1180s
     0     0 7074.66720    0  448 -3370.1842 7074.66720   310%     - 1182s
     0     0 7070.25968    0  440 -3370.1842 7070.25968   310%     - 1188s
     0     0 7069.14849    0  440 -3370.1842 7069.14849   310%     - 1191s
     0     0 7064.59962    0  441 -3370.1842 7064.59962   310%     - 1198s
     0     0 7064.02426    0  441 -3370.1842 7064.02426   310%     - 1205s
H    0     0                    -3368.163236 7064.02426   310%     - 1288s
H    0     0                    -3356.721372 7064.02426   310%     - 1288s
H    0     0                    -3277.231325 7064.02426   316%     - 1288s
H    0     0                    -3202.802593 7063.94312   321%     - 1454s
H    0     0                    -3181.171435 7063.94312   322%     - 1454s
     0     2 7063.94312    0  441 -3181.1714 7063.94312   322%     - 1471s
     1     3 6203.25596    1  351 -3181.1714 7063.94312   322% 16841 1500s
     2     4 6969.09634    1  434 -3181.1714 6969.09634   319% 10757 1514s
     3     7 5885.29757    2  367 -3181.1714 6969.09548   319% 10526 1533s
     6    13 5655.55916    3  347 -3181.1714 6968.82804   319%  8846 1574s
    12    26 5927.79715    4  422 -3181.1714 6923.43141   318% 12287 1602s
    25    39 5745.57199    5  451 -3181.1714 6739.94128   312% 13405 1677s
    38    65 5377.46074    6  442 -3181.1714 6739.94128   312% 18526 1873s
    70   131 5319.25211    7  439 -3181.1714 6565.57905   306% 19551 1957s
   136   214 5266.70605    8  426 -3181.1714 6503.80786   304% 14992 2011s
   223   281 4746.47976   11  380 -3181.1714 6503.80786   304% 11777 2055s
   296   340 4253.28285   13  322 -3181.1714 6503.80786   304% 10471 2096s
   361   385 4029.33564   15  395 -3181.1714 6503.80786   304%  9928 2134s
   418   427 3881.79682    9  325 -3181.1714 6503.80786   304%  9717 2169s
   473   465 3869.15858   15  386 -3181.1714 6466.44222   303%  9675 2203s
   550   493 3359.51048   18  369 -3181.1714 6466.44222   303%  9612 2234s
   616   502 2087.26573   19  282 -3181.1714 6466.44222   303%  9497 2262s
   644   515 1985.79508   20  213 -3181.1714 6466.44222   303%  9556 2295s
   683   524 infeasible   22      -3181.1714 6466.44222   303%  9628 2323s
   720   540 -493.64721   16  353 -3181.1714 6466.44222   303%  9609 2354s
   764   571 -2547.0774   17  257 -3181.1714 6466.44222   303%  9703 2385s
   809   614 infeasible   19      -3181.1714 6466.44222   303%  9634 2416s
   876   659 1175.13029   12  353 -3181.1714 6466.44222   303%  9605 2446s
   947   707  946.88020   13  252 -3181.1714 6466.44222   303%  9403 2477s
  1023   763   60.78022   15  203 -3181.1714 6466.44222   303%  9238 2505s
  1101   823 -143.87745   17  288 -3181.1714 6466.44222   303%  9098 2533s
  1195   860 -461.62018   22  261 -3181.1714 6297.56464   298%  8814 2566s
  1292   921 -1616.4343   24  205 -3181.1714 6127.67155   293%  8672 2598s
  1399   977 -2162.0674   29  147 -3181.1714 6127.67155   293%  8456 2636s
  1524  1016 -2641.8823   37  272 -3181.1714 6127.67155   293%  8232 2670s
  1627  1070 -2781.9889   40  225 -3181.1714 6127.67155   293%  8158 2706s
  1736  1138 -2122.1619   19  286 -3181.1714 6127.67155   293%  8065 2742s
  1836  1190     cutoff   25      -3181.1714 6127.67155   293%  8080 2777s
  1942  1258 -1020.9142   25  234 -3181.1714 6045.14256   290%  8070 2816s
  2079  1326 -1658.7575   28  224 -3181.1714 6045.14256   290%  7953 2857s
  2189  1425 -2558.6857   33  198 -3181.1714 6045.14256   290%  7987 2904s
  2328  1500 -3090.7365   47  176 -3181.1714 6045.14256   290%  7976 2949s
  2463  1538 3194.04927    8  301 -3181.1714 6045.14256   290%  7977 2994s
  2607  1611 -2245.2818   13  243 -3181.1714 5688.69347   279%  7985 3042s
  2732  1628 -3021.5258   16  175 -3181.1714 5688.69347   279%  8055 3079s
  2777  1656 infeasible   17      -3181.1714 5688.69347   279%  8091 3123s
H 2779  1656                    -3146.347106 5688.69347   281%  8089 3123s
  2817  1687 3715.65378    9  319 -3146.3471 5207.58074   266%  8144 3173s
  2884  1733 3104.80861   10  306 -3146.3471 5207.58074   266%  8133 3222s
  2978  1800 3074.46854   11  309 -3146.3471 5207.58074   266%  8174 3269s
  3125  1877  947.46394   15  232 -3146.3471 5207.58074   266%  8165 3327s
  3270  1973  611.03308   19  158 -3146.3471 5207.58074   266%  8191 3383s
  3428  2078 -868.56950   25  157 -3146.3471 5207.58074   266%  8182 3441s
  3625  2192 -1921.9709   36  176 -3146.3471 5006.42071   259%  8135 3509s
  3803  2298 -2739.2515   56  124 -3146.3471 5006.42071   259%  8171 3576s
  4001  2333     cutoff   49      -3146.3471 4849.42321   254%  8166 3600s

Cutting planes:
  Gomory: 1
  Implied bound: 81
  MIR: 2119
  Flow cover: 2960
  RLT: 29
  Relax-and-lift: 355

Explored 4068 nodes (33809904 simplex iterations) in 3600.04 seconds (5850.29 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -3146.35 -3181.17 -3202.8 ... -3793.47

Time limit reached
Best objective -3.146347106189e+03, best bound 4.849423209915e+03, gap 254.1287%
  WARNING: Time limit reached. Using best solution found (gap: 254.13%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = -3146.35, θ = 131570.71
  Upper Bound (UB) = -3146.35

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 131570.71
  [DEBUG]   ✓ Scenario 0: θ = 131570.71 ≤ Q = 131570.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 131570.71 ≤ Q = 131570.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 131570.71 ≤ Q = 131570.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 131570.71 ≤ Q = 131570.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 131570.71 ≤ Q = 131570.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 131570.71 ≤ Q = 131570.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 131570.71 ≤ Q = 131570.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 131570.71 ≤ Q = 131570.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 131570.71 ≤ Q = 131570.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 131570.71 ≤ Q = 131570.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 131570.71 ≤ Q = 131570.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 131570.71 ≤ Q = 131570.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 131570.71 ≤ Q = 131570.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 131570.71 ≤ Q = 131570.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 131570.71 ≤ Q = 131570.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 131570.71 ≤ Q = 131570.71 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 16] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x78ecacce
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x87135332
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.381674e+13
Presolve removed 2625 rows and 1918 columns
Presolve time: 0.01s
Presolved: 468 rows, 471 columns, 1319 nonzeros
Found heuristic solution: objective 6526420.7493
Variable types: 319 continuous, 152 integer (152 binary)

Root relaxation: objective -1.347613e+05, 236 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -134761.27    0  123 6526420.75 -134761.27   102%     -    0s
H    0     0                    -103286.6837 -134761.27  30.5%     -    0s
H    0     0                    -103931.5277 -134761.27  29.7%     -    0s
     0     0 -110313.01    0   82 -103931.53 -110313.01  6.14%     -    0s
H    0     0                    -106206.4419 -110180.28  3.74%     -    0s
H    0     0                    -107550.2748 -110180.28  2.45%     -    0s
     0     0 -109144.30    0   81 -107550.27 -109144.30  1.48%     -    0s
     0     0 -109107.00    0   81 -107550.27 -109107.00  1.45%     -    0s
     0     0 -108699.02    0   85 -107550.27 -108699.02  1.07%     -    0s
     0     0 -108682.25    0   85 -107550.27 -108682.25  1.05%     -    0s
     0     0 -108564.11    0   78 -107550.27 -108564.11  0.94%     -    0s
     0     0 -108563.98    0   78 -107550.27 -108563.98  0.94%     -    0s
     0     2 -108561.97    0   78 -107550.27 -108561.97  0.94%     -    0s
H   74    83                    -107568.9936 -108184.21  0.57%  15.8    0s

Cutting planes:
  Gomory: 51
  Implied bound: 6
  MIR: 168
  Flow cover: 2
  RLT: 5
  BQP: 3

Explored 2575 nodes (14863 simplex iterations) in 0.37 seconds (0.15 work units)
Thread count was 32 (of 32 available processors)

Solution count 7: -107569 -107550 -106206 ... 1.38167e+13
No other solutions better than -107569

Optimal solution found (tolerance 1.00e-04)
Best objective -1.075689935585e+05, best bound -1.075689935585e+05, gap 0.0000%
  Subproblem solved in 0.40s
  Worst-case operational profit (Z_SP) = 129830.47
  Scenario: 35 demand increases, 25 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -107568.99
  [DEBUG]   S×d_nominal = 237399.47
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 237399.47 + -107568.99 = 129830.47
  [DEBUG]   Current θ from Master = 131570.71
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1740.24 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -4886.58
  Lower Bound (LB) = -4886.58
  Gap (UB-LB) = 1740.2354, Absolute Gap = 1740.2354, Relative Gap = 0.553097
  Not converged yet (gap = 1740.24 > ε = 200)

  [DEBUG] Adding NEW scenario 16 to Master Problem...
  [DEBUG] New scenario pattern: 35 increases, 25 decreases
    [DEBUG] Scenario 16 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 16 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 16]
    [DEBUG]   - Total constraints in model: 261313
    [DEBUG]   - Total variables in model: 108340
  [DEBUG] Total scenarios in Master: 17
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 17
================================================================================
[Iteration 17] Solving Master Problem...
  Current scenarios in Master: 17
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 261313 rows, 108340 columns and 740242 nonzeros
Model fingerprint: 0x0c37765d
Variable types: 106081 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 127058 rows and 51578 columns
Presolve time: 4.44s
Presolved: 134255 rows, 56762 columns, 828563 nonzeros
Variable types: 54503 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -366101.7227
Found heuristic solution: objective -171217.0927

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.53s

Barrier statistics:
 Dense cols : 557
 AA' NZ     : 7.576e+06
 Factor NZ  : 1.713e+07 (roughly 200 MB of memory)
 Factor Ops : 5.246e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.64586494e+07  2.24883939e+08  8.70e+04 1.76e+01  7.11e+04     7s
   1  -1.27587842e+07  2.00420622e+08  6.14e+04 4.37e+01  4.98e+04     7s
   2  -4.90281933e+06  1.51030902e+08  2.29e+04 3.38e+00  1.97e+04     7s
   3  -8.61673958e+05  1.12489487e+08  1.81e+03 1.02e+00  1.93e+03     8s
   4  -5.35582779e+05  8.04718444e+07  4.06e+02 5.75e-01  6.40e+02     8s
   5  -4.78294950e+05  4.43665039e+07  2.20e+02 2.74e-01  3.32e+02     8s
   6  -4.03776538e+05  3.32784554e+07  7.46e+01 1.92e-01  1.84e+02     8s
   7  -3.34193211e+05  2.49489515e+07  2.20e+01 1.38e-01  1.15e+02     8s
   8  -2.17370478e+05  1.82217663e+07  1.30e+00 9.80e-02  7.58e+01     8s
   9  -1.46604284e+05  4.69468840e+06  2.07e-01 2.37e-02  1.98e+01     8s
  10  -1.04172169e+05  2.82391065e+06  1.06e-01 1.48e-02  1.19e+01     9s
  11  -9.13111899e+04  1.84241293e+06  7.53e-02 9.57e-03  7.89e+00     9s
  12  -7.84259366e+04  1.29132291e+06  5.45e-02 6.59e-03  5.59e+00     9s
  13  -4.93307218e+04  4.65476275e+05  1.98e-02 2.11e-03  2.10e+00     9s
  14  -2.61227164e+04  2.06299255e+05  8.12e-03 1.52e-03  9.48e-01     9s
  15  -1.75673858e+04  1.21074482e+05  5.80e-03 8.58e-04  5.65e-01     9s
  16  -1.19058012e+04  8.34244935e+04  4.70e-03 5.60e-04  3.89e-01    10s
  17  -6.50171660e+03  6.02037812e+04  3.75e-03 3.51e-04  2.72e-01    10s
  18  -4.60518236e+03  5.15580815e+04  3.44e-03 2.81e-04  2.29e-01    10s
  19   3.19985465e+02  4.42230942e+04  2.63e-03 2.20e-04  1.79e-01    10s
  20   4.03619337e+03  3.65800360e+04  2.04e-03 1.55e-04  1.33e-01    10s
  21   7.00014963e+03  3.35753717e+04  1.59e-03 1.29e-04  1.08e-01    11s
  22   9.01767750e+03  2.82315174e+04  1.30e-03 8.12e-05  7.84e-02    11s
  23   1.13958232e+04  2.58321417e+04  9.79e-04 5.93e-05  5.89e-02    11s
  24   1.23532424e+04  2.32648897e+04  8.48e-04 3.65e-05  4.45e-02    11s
  25   1.39591370e+04  2.25903434e+04  6.52e-04 2.98e-05  3.52e-02    12s
  26   1.54604890e+04  2.16323784e+04  4.69e-04 2.03e-05  2.52e-02    12s
  27   1.65818286e+04  2.04358166e+04  3.34e-04 8.35e-06  1.57e-02    12s
  28   1.69299710e+04  2.01831872e+04  2.92e-04 6.08e-06  1.33e-02    12s
  29   1.77241761e+04  2.00118365e+04  2.00e-04 4.40e-06  9.33e-03    12s
  30   1.80357058e+04  1.98108485e+04  1.64e-04 2.49e-06  7.24e-03    13s
  31   1.85265516e+04  1.97147137e+04  1.08e-04 1.63e-06  4.85e-03    13s
  32   1.88538621e+04  1.96660380e+04  7.09e-05 1.24e-06  3.31e-03    13s
  33   1.90576734e+04  1.96018305e+04  4.73e-05 7.29e-07  2.22e-03    13s
  34   1.91984191e+04  1.95561040e+04  3.19e-05 4.31e-07  1.46e-03    13s
  35   1.93018933e+04  1.95455806e+04  2.09e-05 4.92e-07  9.94e-04    14s
  36   1.93529920e+04  1.95359862e+04  1.56e-05 1.38e-06  7.46e-04    14s
  37   1.93899454e+04  1.95299375e+04  1.18e-05 1.15e-06  5.71e-04    14s
  38   1.94417294e+04  1.95235851e+04  6.41e-06 8.09e-07  3.34e-04    14s
  39   1.94715232e+04  1.95155877e+04  3.40e-06 4.23e-07  1.80e-04    15s
  40   1.94993453e+04  1.95087982e+04  6.55e-07 6.01e-08  3.86e-05    15s
  41   1.95056637e+04  1.95073531e+04  1.17e-07 7.81e-09  6.89e-06    15s
  42   1.95063491e+04  1.95072310e+04  9.58e-07 1.51e-08  3.60e-06    15s
  43   1.95072023e+04  1.95072075e+04  1.33e-08 1.32e-08  2.14e-08    15s
  44   1.95072070e+04  1.95072075e+04  1.72e-07 9.21e-08  1.93e-09    16s
  45   1.95072073e+04  1.95072074e+04  6.00e-08 6.36e-09  5.83e-10    16s

Barrier solved model in 45 iterations and 15.72 seconds (14.44 work units)
Optimal objective 1.95072073e+04


Root crossover log...

  119108 DPushes remaining with DInf 0.0000000e+00                16s
   13631 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                23s

    8100 PPushes remaining with PInf 4.1064426e-05                23s
       0 PPushes remaining with PInf 0.0000000e+00                24s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.9186287e+03     24s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   65686    1.9507207e+04   0.000000e+00   1.918629e+03     24s
   65823    1.9507207e+04   0.000000e+00   0.000000e+00     24s
   65823    1.9507207e+04   0.000000e+00   0.000000e+00     24s
Concurrent spin time: 1.59s

Solved with barrier

Root relaxation: objective 1.950721e+04, 65823 iterations, 20.59 seconds (26.52 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 19507.2074    0  162 -171217.09 19507.2074   111%     -   27s
H    0     0                    -169866.1672 19507.2074   111%     -   27s
H    0     0                    -155954.6674 19507.2074   113%     -   27s
H    0     0                    -69894.59137 19507.2074   128%     -   28s
H    0     0                    -20067.33329 19507.2074   197%     -   28s
     0     0 15359.4803    0  278 -20067.333 15359.4803   177%     -  120s
H    0     0                    -18879.91934 15359.2419   181%     -  121s
H    0     0                    -17301.57130 15359.2419   189%     -  121s
H    0     0                    -17045.95174 15359.2419   190%     -  122s
     0     0 14627.9822    0  297 -17045.952 14627.9822   186%     -  167s
     0     0 14579.7336    0  294 -17045.952 14579.7336   186%     -  189s
     0     0 14566.7313    0  294 -17045.952 14566.7313   185%     -  195s
     0     0 14563.2019    0  304 -17045.952 14563.2019   185%     -  197s
     0     0 14561.3741    0  297 -17045.952 14561.3741   185%     -  200s
     0     0 14561.3060    0  297 -17045.952 14561.3060   185%     -  200s
     0     0 12048.2184    0  280 -17045.952 12048.2184   171%     -  265s
H    0     0                    -11790.69268 12047.7868   202%     -  266s
     0     0 11465.4453    0  295 -11790.693 11465.4453   197%     -  316s
     0     0 11211.9696    0  347 -11790.693 11211.9696   195%     -  353s
     0     0 11162.1459    0  299 -11790.693 11162.1459   195%     -  375s
     0     0 11147.8595    0  303 -11790.693 11147.8595   195%     -  385s
     0     0 11082.3038    0  348 -11790.693 11082.3038   194%     -  408s
     0     0 11059.4449    0  344 -11790.693 11059.4449   194%     -  419s
     0     0 11052.6092    0  342 -11790.693 11052.6092   194%     -  425s
     0     0 11046.3680    0  346 -11790.693 11046.3680   194%     -  430s
     0     0 11035.8277    0  347 -11790.693 11035.8277   194%     -  435s
     0     0 11034.9564    0  347 -11790.693 11034.9564   194%     -  437s
     0     0 11034.5715    0  349 -11790.693 11034.5715   194%     -  438s
     0     0 9653.13295    0  396 -11790.693 9653.13295   182%     -  525s
H    0     0                    -11597.12047 9653.11554   183%     -  526s
H    0     0                    -10775.28107 9653.11554   190%     -  526s
H    0     0                    -10621.25844 9653.11554   191%     -  526s
     0     0 9441.60589    0  398 -10621.258 9441.60589   189%     -  566s
     0     0 9362.60577    0  412 -10621.258 9362.60577   188%     -  589s
     0     0 9341.65678    0  404 -10621.258 9341.65678   188%     -  602s
     0     0 9325.41862    0  401 -10621.258 9325.41862   188%     -  614s
     0     0 9307.52936    0  408 -10621.258 9307.52936   188%     -  625s
     0     0 9253.51156    0  399 -10621.258 9253.51156   187%     -  646s
     0     0 9231.25331    0  406 -10621.258 9231.25331   187%     -  660s
     0     0 9211.71806    0  413 -10621.258 9211.71806   187%     -  672s
     0     0 9189.46291    0  404 -10621.258 9189.46291   187%     -  679s
     0     0 9186.97007    0  401 -10621.258 9186.97007   186%     -  684s
     0     0 9090.62987    0  395 -10621.258 9090.62987   186%     -  698s
     0     0 9074.94113    0  395 -10621.258 9074.94113   185%     -  711s
     0     0 9072.09093    0  396 -10621.258 9072.09093   185%     -  715s
     0     0 9067.73105    0  398 -10621.258 9067.73105   185%     -  719s
     0     0 9061.45144    0  390 -10621.258 9061.45144   185%     -  723s
     0     0 9058.03018    0  391 -10621.258 9058.03018   185%     -  726s
     0     0 9036.64023    0  394 -10621.258 9036.64023   185%     -  734s
     0     0 9032.88052    0  396 -10621.258 9032.88052   185%     -  739s
     0     0 9032.31920    0  402 -10621.258 9032.31920   185%     -  742s
     0     0 8399.39079    0  409 -10621.258 8399.39079   179%     -  824s
     0     0 8182.28779    0  426 -10621.258 8182.28779   177%     -  858s
     0     0 8091.02995    0  427 -10621.258 8091.02995   176%     -  881s
     0     0 7995.35358    0  442 -10621.258 7995.35358   175%     -  904s
     0     0 7962.72105    0  440 -10621.258 7962.72105   175%     -  923s
     0     0 7948.89640    0  450 -10621.258 7948.89640   175%     -  936s
     0     0 7925.70051    0  441 -10621.258 7925.70051   175%     -  946s
     0     0 7902.65349    0  450 -10621.258 7902.65349   174%     -  962s
     0     0 7896.75438    0  444 -10621.258 7896.75438   174%     -  966s
     0     0 7889.92157    0  453 -10621.258 7889.92157   174%     -  972s
     0     0 7885.10823    0  454 -10621.258 7885.10823   174%     -  978s
     0     0 7883.80563    0  452 -10621.258 7883.80563   174%     -  981s
     0     0 7868.84775    0  491 -10621.258 7868.84775   174%     -  990s
     0     0 7862.56663    0  458 -10621.258 7862.56663   174%     -  995s
     0     0 7861.16715    0  458 -10621.258 7861.16715   174%     -  999s
     0     0 7859.64907    0  461 -10621.258 7859.64907   174%     - 1002s
     0     0 7855.21625    0  447 -10621.258 7855.21625   174%     - 1006s
     0     0 7850.40791    0  451 -10621.258 7850.40791   174%     - 1011s
     0     0 7837.76068    0  440 -10621.258 7837.76068   174%     - 1017s
     0     0 7830.27952    0  439 -10621.258 7830.27952   174%     - 1021s
     0     0 7821.63591    0  446 -10621.258 7821.63591   174%     - 1025s
     0     0 7821.09884    0  523 -10621.258 7821.09884   174%     - 1028s
     0     0 7648.46014    0  481 -10621.258 7648.46014   172%     - 1061s
     0     0 7561.26182    0  456 -10621.258 7561.26182   171%     - 1082s
     0     0 7541.21138    0  462 -10621.258 7541.21138   171%     - 1097s
     0     0 7536.75222    0  466 -10621.258 7536.75222   171%     - 1104s
     0     0 7534.21127    0  467 -10621.258 7534.21127   171%     - 1108s
     0     0 7489.95861    0  457 -10621.258 7489.95861   171%     - 1120s
     0     0 7477.51598    0  469 -10621.258 7477.51598   170%     - 1126s
     0     0 7471.42905    0  470 -10621.258 7471.42905   170%     - 1131s
     0     0 7469.51259    0  471 -10621.258 7469.51259   170%     - 1133s
     0     0 7468.82465    0  471 -10621.258 7468.82465   170%     - 1135s
     0     0 7383.01936    0  444 -10621.258 7383.01936   170%     - 1153s
     0     0 7368.93890    0  487 -10621.258 7368.93890   169%     - 1176s
     0     0 7360.82497    0  481 -10621.258 7360.82497   169%     - 1179s
     0     0 7352.79380    0  481 -10621.258 7352.79380   169%     - 1184s
     0     0 7352.41769    0  487 -10621.258 7352.41769   169%     - 1185s
     0     0 7299.56711    0  468 -10621.258 7299.56711   169%     - 1205s
H    0     0                    -10273.22105 7299.26651   171%     - 1206s
H    0     0                    -9673.551330 7299.26651   175%     - 1206s
H    0     0                    -9404.132352 7299.26651   178%     - 1206s
H    0     0                    -9313.213067 7299.26651   178%     - 1206s
H    0     0                    -9012.935543 7299.26651   181%     - 1206s
H    0     0                    -8825.842630 7299.26651   183%     - 1206s
     0     0 7287.54266    0  489 -8825.8426 7287.54266   183%     - 1213s
     0     0 7285.84206    0  487 -8825.8426 7285.84206   183%     - 1216s
     0     0 7284.76943    0  440 -8825.8426 7284.76943   183%     - 1218s
     0     0 7260.63861    0  485 -8825.8426 7260.63861   182%     - 1230s
     0     0 7243.66977    0  504 -8825.8426 7243.66977   182%     - 1245s
     0     0 7241.94944    0  460 -8825.8426 7241.94944   182%     - 1248s
     0     0 7240.00790    0  449 -8825.8426 7240.00790   182%     - 1251s
     0     0 7239.29090    0  458 -8825.8426 7239.29090   182%     - 1254s
     0     0 7207.93034    0  490 -8825.8426 7207.93034   182%     - 1268s
H    0     0                    -8154.529324 7207.85346   188%     - 1269s
H    0     0                    -8085.328580 7207.85346   189%     - 1269s
     0     0 7203.80338    0  444 -8085.3286 7203.80338   189%     - 1274s
     0     0 7200.17986    0  499 -8085.3286 7200.17986   189%     - 1280s
     0     0 7199.23636    0  452 -8085.3286 7199.23636   189%     - 1282s
     0     0 7188.51114    0  449 -8085.3286 7188.51114   189%     - 1290s
H    0     0                    -7890.547248 7188.45539   191%     - 1292s
     0     0 7185.51840    0  453 -7890.5472 7185.51840   191%     - 1300s
     0     0 7185.40393    0  456 -7890.5472 7185.40393   191%     - 1300s
     0     0 7173.49630    0  438 -7890.5472 7173.49630   191%     - 1310s
     0     0 7168.25082    0  450 -7890.5472 7168.25082   191%     - 1314s
     0     0 7167.31573    0  506 -7890.5472 7167.31573   191%     - 1317s
     0     0 7148.34241    0  455 -7890.5472 7148.34241   191%     - 1324s
H    0     0                    -7624.773921 7145.20571   194%     - 1368s
H    0     0                    -7386.129840 7145.20571   197%     - 1368s
H    0     0                    -7265.007995 7145.20571   198%     - 1377s
H    0     0                    -7253.846863 7145.20571   199%     - 1377s
     0     0 7143.76521    0  462 -7253.8469 7143.76521   198%     - 1387s
     0     0 7142.57862    0  454 -7253.8469 7142.57862   198%     - 1389s
     0     0 7134.78652    0  463 -7253.8469 7134.78652   198%     - 1394s
     0     0 7133.75760    0  455 -7253.8469 7133.75760   198%     - 1397s
     0     0 7020.21874    0  448 -7253.8469 7020.21874   197%     - 1413s
     0     0 7012.58474    0  453 -7253.8469 7012.58474   197%     - 1419s
     0     0 7011.71175    0  463 -7253.8469 7011.71175   197%     - 1421s
     0     0 6998.41686    0  461 -7253.8469 6998.41686   196%     - 1431s
     0     0 6996.44554    0  461 -7253.8469 6996.44554   196%     - 1433s
     0     0 6996.24324    0  459 -7253.8469 6996.24324   196%     - 1435s
     0     0 6993.05699    0  449 -7253.8469 6993.05699   196%     - 1440s
     0     0 6992.09571    0  456 -7253.8469 6992.09571   196%     - 1443s
     0     0 6989.63698    0  454 -7253.8469 6989.63698   196%     - 1448s
     0     0 6988.67524    0  458 -7253.8469 6988.67524   196%     - 1451s
     0     0 6986.64529    0  456 -7253.8469 6986.64529   196%     - 1455s
     0     0 6986.10231    0  456 -7253.8469 6986.10231   196%     - 1462s
H    0     0                    -6065.670290 6986.10231   215%     - 1632s
H    0     0                    -5777.181880 6986.10231   221%     - 1636s
H    0     0                    -3999.468353 6986.10231   275%     - 1636s
     0     2 6986.10231    0  456 -3999.4684 6986.10231   275%     - 1641s
     1     3 5838.41435    1  498 -3999.4684 6985.58793   275% 26225 1682s
     2     6 5619.19121    2  398 -3999.4684 6985.58793   275% 15730 1689s
     5     9 6648.52163    2  455 -3999.4684 6840.77306   271% 11433 1715s
     8    14 4482.77280    4  337 -3999.4684 6840.77306   271% 12234 1742s
    13    28 6471.71591    3  455 -3999.4684 6735.50379   268% 12845 1770s
    27    42 6258.96978    4  554 -3999.4684 6658.48979   266% 17653 1866s
    41    70 6007.61108    5  449 -3999.4684 6658.48979   266% 22557 2544s
H   45    70                    -3672.013225 6658.48979   281% 21867 2544s
H   49    69                    -3511.983250 6658.48979   290% 21831 2544s
H   52    69                    -3396.711167 6658.48979   296% 21038 2544s
H   64    69                    -3329.292820 6658.48979   300% 19195 2544s
    71   133 5633.43193    6  448 -3329.2928 6376.98937   292% 24960 2659s
   137   256 5120.21162    8  485 -3329.2928 6316.11592   290% 17527 2719s
H  206   256                    -3293.647929 6316.11592   292% 13908 2719s
H  260   256                    -3288.791192 6316.11592   292% 12214 2719s
   264   298 5109.67378   10  439 -3288.7912 6316.11592   292% 12152 2763s
   334   328 5044.73649   11  436 -3288.7912 6316.11592   292% 10927 2800s
H  364   328                    -3285.379725 6316.11592   292% 10658 2800s
   384   363 -491.04425   21  256 -3285.3797 6316.11592   292% 10571 2838s
   423   408 5237.55725   10  421 -3285.3797 6316.11592   292% 10232 2874s
H  424   408                    -3230.948480 6316.11592   295% 10208 2874s
   472   462  150.34510   13  229 -3230.9485 6316.11592   295%  9938 2908s
   534   527 1109.05938   19  307 -3230.9485 6316.11592   295%  9526 2939s
H  580   527                    -3181.171435 6316.11592   299%  9320 2939s
   606   582 -629.23633   21  218 -3181.1714 6316.11592   299%  9331 2971s
   684   605 -685.67301   22  229 -3181.1714 6316.11592   299%  9104 2998s
   721   626  388.17079   21  284 -3181.1714 6316.11592   299%  9009 3022s
   764   650  319.65604   22  292 -3181.1714 6316.11592   299%  8944 3045s
   807   680 -657.79642   22  216 -3181.1714 6316.11592   299%  8859 3071s
   875   704  930.20241   21  181 -3181.1714 6316.11592   299%  8645 3101s
   936   740 -982.47623   23  229 -3181.1714 6163.58625   294%  8520 3132s
  1006   772 -2375.7345   23  294 -3181.1714 6163.58625   294%  8336 3163s
  1070   797     cutoff   24      -3181.1714 6163.58625   294%  8128 3195s
  1145   822 -2435.4145   25  250 -3181.1714 6163.58625   294%  7967 3227s
  1197   864 infeasible   25      -3181.1714 6163.58625   294%  7884 3264s
  1298   880 -2834.0042   28  381 -3181.1714 5912.56640   286%  7658 3300s
  1368   901 infeasible   26      -3181.1714 5912.56640   286%  7500 3338s
  1440   972 infeasible   13      -3181.1714 5912.56640   286%  7445 3377s
  1537  1020 -998.77444   38  400 -3181.1714 5912.56640   286%  7402 3418s
  1650  1054 infeasible   40      -3181.1714 5912.56640   286%  7362 3463s
  1748  1057 infeasible   43      -3181.1714 5912.56640   286%  7417 3514s
  1838  1067 1849.70748   15  348 -3181.1714 5912.56640   286%  7350 3563s
  1872  1085 1669.16752   16  390 -3181.1714 5912.56640   286%  7482 3600s

Cutting planes:
  Learned: 1
  Gomory: 1
  Implied bound: 133
  MIR: 2239
  Flow cover: 3098
  RLT: 27
  Relax-and-lift: 264

Explored 1908 nodes (15195864 simplex iterations) in 3600.08 seconds (5119.87 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -3181.17 -3230.95 -3285.38 ... -3999.47

Time limit reached
Best objective -3.181171434610e+03, best bound 5.912566404579e+03, gap 285.8613%
  WARNING: Time limit reached. Using best solution found (gap: 285.86%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.10s
  Master Objective (UB) = -3181.17, θ = 131744.98
  Upper Bound (UB) = -3181.17

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 131744.98
  [DEBUG]   ✓ Scenario 0: θ = 131744.98 ≤ Q = 131744.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 131744.98 ≤ Q = 131744.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 131744.98 ≤ Q = 131744.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 131744.98 ≤ Q = 131744.98 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 131744.98 ≤ Q = 131744.98 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 131744.98 ≤ Q = 131744.98 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 131744.98 ≤ Q = 131744.98 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 131744.98 ≤ Q = 131744.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 131744.98 ≤ Q = 131744.98 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 131744.98 ≤ Q = 131744.98 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 131744.98 ≤ Q = 131744.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 131744.98 ≤ Q = 131744.98 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 131744.98 ≤ Q = 131744.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 131744.98 ≤ Q = 131744.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 131744.98 ≤ Q = 131744.98 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 131744.98 ≤ Q = 131744.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 131744.98 ≤ Q = 131744.98 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 17] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x31397bc4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xcec6843c
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.381674e+13
Presolve removed 2625 rows and 1918 columns
Presolve time: 0.01s
Presolved: 468 rows, 471 columns, 1319 nonzeros
Found heuristic solution: objective 6530888.9538
Variable types: 319 continuous, 152 integer (152 binary)

Root relaxation: objective -1.349824e+05, 236 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -134982.43    0  123 6530888.95 -134982.43   102%     -    0s
H    0     0                    -103541.3200 -134982.43  30.4%     -    0s
H    0     0                    -104186.1640 -134982.43  29.6%     -    0s
     0     0 -110027.55    0  126 -104186.16 -110027.55  5.61%     -    0s
H    0     0                    -106745.6797 -110002.58  3.05%     -    0s
H    0     0                    -106875.0513 -110002.58  2.93%     -    0s
     0     0 -108805.71    0   81 -106875.05 -108805.71  1.81%     -    0s
H    0     0                    -107168.4656 -108793.10  1.52%     -    0s
     0     0 -108671.64    0   81 -107168.47 -108671.64  1.40%     -    0s
     0     0 -108364.17    0   86 -107168.47 -108364.17  1.12%     -    0s
     0     0 -108354.93    0   85 -107168.47 -108354.93  1.11%     -    0s
     0     0 -108239.13    0   81 -107168.47 -108239.13  1.00%     -    0s
     0     0 -108238.08    0   84 -107168.47 -108238.08  1.00%     -    0s
     0     2 -108236.75    0   84 -107168.47 -108236.75  1.00%     -    0s
H  118    35                    -107182.1233 -107805.84  0.58%  10.4    0s
H 1309   494                    -107200.8421 -107459.70  0.24%   5.8    0s

Cutting planes:
  Gomory: 47
  Implied bound: 7
  MIR: 197
  Flow cover: 1
  RLT: 3
  BQP: 2

Explored 3480 nodes (20030 simplex iterations) in 0.39 seconds (0.15 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -107201 -107182 -107168 ... 1.38167e+13
No other solutions better than -107201

Optimal solution found (tolerance 1.00e-04)
Best objective -1.072008421003e+05, best bound -1.072008421003e+05, gap 0.0000%
  Subproblem solved in 0.43s
  Worst-case operational profit (Z_SP) = 130695.34
  Scenario: 35 demand increases, 25 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -107200.84
  [DEBUG]   S×d_nominal = 237896.18
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 237896.18 + -107200.84 = 130695.34
  [DEBUG]   Current θ from Master = 131744.98
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1049.64 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -4230.81
  Lower Bound (LB) = -4230.81
  Gap (UB-LB) = 1049.6418, Absolute Gap = 1049.6418, Relative Gap = 0.329954
  Not converged yet (gap = 1049.64 > ε = 200)

  [DEBUG] Adding NEW scenario 17 to Master Problem...
  [DEBUG] New scenario pattern: 35 increases, 25 decreases
    [DEBUG] Scenario 17 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 17 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 17]
    [DEBUG]   - Total constraints in model: 276603
    [DEBUG]   - Total variables in model: 114580
  [DEBUG] Total scenarios in Master: 18
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 18
================================================================================
[Iteration 18] Solving Master Problem...
  Current scenarios in Master: 18
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 276603 rows, 114580 columns and 783461 nonzeros
Model fingerprint: 0xb887c793
Variable types: 112321 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 134532 rows and 54612 columns (presolve time = 5s)...
Presolve removed 134532 rows and 54612 columns
Presolve time: 5.67s
Presolved: 142071 rows, 59968 columns, 876474 nonzeros
Variable types: 57709 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -366101.7227
Found heuristic solution: objective -171217.0927

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 2.11s

Barrier statistics:
 Dense cols : 555
 AA' NZ     : 8.437e+06
 Factor NZ  : 1.803e+07 (roughly 230 MB of memory)
 Factor Ops : 4.171e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.64670202e+07  2.36372311e+08  8.70e+04 1.72e+01  7.07e+04    10s
   1  -1.28073369e+07  2.10603928e+08  6.16e+04 4.20e+01  4.97e+04    10s
   2  -5.16600651e+06  1.58438008e+08  2.41e+04 3.98e+00  2.07e+04    11s
   3  -8.67194106e+05  1.18773724e+08  1.86e+03 1.31e+00  1.96e+03    11s
   4  -5.34251064e+05  8.50583200e+07  4.11e+02 7.30e-01  6.43e+02    11s
   5  -4.74933574e+05  4.74219251e+07  2.16e+02 3.57e-01  3.31e+02    11s
   6  -4.04922692e+05  3.55326530e+07  7.61e+01 2.52e-01  1.86e+02    11s
   7  -3.31197931e+05  2.60839199e+07  1.63e+01 1.77e-01  1.11e+02    11s
   8  -2.10998861e+05  1.86248776e+07  1.68e-07 1.24e-01  7.26e+01    11s
   9  -1.45917989e+05  2.15370433e+06  1.71e-07 1.37e-02  8.87e+00    12s
  10  -9.19852957e+04  1.68657704e+06  8.05e-08 1.06e-02  6.86e+00    12s
  11  -8.10288453e+04  1.25678678e+06  6.40e-08 7.88e-03  5.16e+00    12s
  12  -5.36057394e+04  9.67162622e+05  3.33e-08 6.07e-03  3.94e+00    12s
  13  -3.60082489e+04  4.04930347e+05  2.10e-08 2.46e-03  1.70e+00    12s
  14  -2.18480404e+04  2.11735105e+05  1.38e-08 1.29e-03  9.00e-01    12s
  15  -1.50271397e+04  1.42419067e+05  1.03e-08 8.44e-04  6.07e-01    13s
  16  -7.34916206e+03  1.06147825e+05  7.22e-09 6.02e-04  4.38e-01    13s
  17  -1.63962638e+03  7.52203715e+04  5.25e-09 3.97e-04  2.96e-01    13s
  18   2.34808024e+03  6.08493310e+04  3.99e-09 3.08e-04  2.26e-01    13s
  19   5.93368456e+03  4.93760693e+04  2.95e-09 2.25e-04  1.67e-01    14s
  20   8.65793770e+03  4.04247555e+04  2.20e-09 1.65e-04  1.22e-01    14s
  21   1.17507787e+04  3.56596925e+04  1.45e-09 1.29e-04  9.22e-02    14s
  22   1.36727629e+04  2.86229817e+04  1.02e-09 7.55e-05  5.76e-02    14s
  23   1.56056708e+04  2.65613089e+04  6.35e-10 5.91e-05  4.22e-02    15s
  24   1.69341959e+04  2.38741282e+04  3.93e-10 3.81e-05  2.68e-02    15s
  25   1.77071100e+04  2.23798605e+04  2.67e-10 2.55e-05  1.80e-02    15s
  26   1.79652585e+04  2.14309332e+04  2.26e-10 1.70e-05  1.34e-02    15s
  27   1.81214280e+04  2.09588571e+04  2.03e-10 1.27e-05  1.09e-02    15s
  28   1.84684844e+04  2.06888062e+04  1.52e-10 1.02e-05  8.56e-03    16s
  29   1.88584538e+04  2.03499649e+04  9.26e-11 7.23e-06  5.75e-03    16s
  30   1.91018526e+04  2.01084178e+04  5.56e-11 5.14e-06  3.88e-03    16s
  31   1.92507050e+04  1.98699826e+04  9.94e-09 3.36e-06  2.39e-03    16s
  32   1.93593591e+04  1.97002892e+04  3.32e-07 1.78e-06  1.31e-03    17s
  33   1.93986591e+04  1.96693442e+04  3.11e-07 1.49e-06  1.04e-03    17s
  34   1.94601743e+04  1.96078095e+04  3.02e-07 9.18e-07  5.69e-04    17s
  35   1.94719461e+04  1.95485601e+04  2.77e-07 3.73e-07  2.95e-04    17s
  36   1.94870540e+04  1.95256975e+04  2.19e-07 1.62e-07  1.49e-04    18s
  37   1.94991627e+04  1.95190392e+04  1.49e-07 1.04e-07  7.66e-05    18s
  38   1.95031952e+04  1.95114911e+04  1.02e-07 3.48e-08  3.20e-05    18s
  39   1.95069663e+04  1.95072854e+04  3.27e-08 3.61e-08  1.23e-06    19s
  40   1.95072072e+04  1.95072075e+04  2.87e-09 8.50e-09  1.20e-09    19s
  41   1.95072074e+04  1.95072074e+04  2.15e-08 1.32e-09  2.79e-11    19s

Barrier solved model in 41 iterations and 19.29 seconds (15.73 work units)
Optimal objective 1.95072074e+04


Root crossover log...

  125919 DPushes remaining with DInf 0.0000000e+00                19s
   60863 DPushes remaining with DInf 0.0000000e+00                20s
     989 DPushes remaining with DInf 0.0000000e+00                25s
       0 DPushes remaining with DInf 0.0000000e+00                26s

    2033 PPushes remaining with PInf 8.0838973e-06                26s
       0 PPushes remaining with PInf 0.0000000e+00                26s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.8492362e-10     26s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   55495    1.9507207e+04   0.000000e+00   0.000000e+00     26s
   55495    1.9507207e+04   0.000000e+00   0.000000e+00     26s
Concurrent spin time: 1.96s

Solved with barrier

Root relaxation: objective 1.950721e+04, 55495 iterations, 20.93 seconds (22.87 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 19507.2074    0  162 -171217.09 19507.2074   111%     -   28s
H    0     0                    -143525.1753 19507.2074   114%     -   29s
H    0     0                    -136450.1630 19507.2074   114%     -   29s
H    0     0                    -73434.35414 19507.2074   127%     -   29s
H    0     0                    -19172.08544 19507.2074   202%     -   30s
H    0     0                    -11980.22761 19507.2074   263%     -   30s
     0     0 15338.1127    0  289 -11980.228 15338.1127   228%     -  108s
H    0     0                    -11954.90726 15337.8687   228%     -  110s
H    0     0                    -10679.16115 15337.8687   244%     -  110s
H    0     0                    -10655.58431 15337.8687   244%     -  110s
H    0     0                    -10488.09841 15337.8687   246%     -  110s
H    0     0                    -10399.62362 15337.8687   247%     -  110s
H    0     0                    -10146.39930 15337.8687   251%     -  110s
     0     0 14602.3418    0  307 -10146.399 14602.3418   244%     -  155s
     0     0 14566.7644    0  307 -10146.399 14566.7644   244%     -  164s
     0     0 14563.8539    0  309 -10146.399 14563.8539   244%     -  166s
     0     0 14561.7208    0  307 -10146.399 14561.7208   244%     -  167s
     0     0 14561.7208    0  307 -10146.399 14561.7208   244%     -  167s
     0     0 12285.7236    0  370 -10146.399 12285.7236   221%     -  249s
     0     0 11672.2042    0  362 -10146.399 11672.2042   215%     -  293s
     0     0 11410.6856    0  366 -10146.399 11410.6856   212%     -  321s
     0     0 11304.1118    0  403 -10146.399 11304.1118   211%     -  339s
     0     0 11232.2618    0  414 -10146.399 11232.2618   211%     -  361s
     0     0 11193.9043    0  419 -10146.399 11193.9043   210%     -  374s
     0     0 11121.5286    0  431 -10146.399 11121.5286   210%     -  391s
     0     0 11075.3701    0  417 -10146.399 11075.3701   209%     -  402s
     0     0 11047.0848    0  424 -10146.399 11047.0848   209%     -  411s
     0     0 11035.8041    0  424 -10146.399 11035.8041   209%     -  419s
     0     0 11030.1378    0  425 -10146.399 11030.1378   209%     -  425s
     0     0 11028.4520    0  426 -10146.399 11028.4520   209%     -  427s
     0     0 11022.9226    0  429 -10146.399 11022.9226   209%     -  435s
     0     0 11001.9426    0  421 -10146.399 11001.9426   208%     -  441s
     0     0 10989.8272    0  426 -10146.399 10989.8272   208%     -  445s
     0     0 10958.3700    0  425 -10146.399 10958.3700   208%     -  455s
     0     0 10950.9803    0  418 -10146.399 10950.9803   208%     -  460s
     0     0 10945.6543    0  386 -10146.399 10945.6543   208%     -  465s
     0     0 10944.0123    0  433 -10146.399 10944.0123   208%     -  469s
     0     0 10943.6588    0  431 -10146.399 10943.6588   208%     -  471s
     0     0 9570.25936    0  390 -10146.399 9570.25936   194%     -  585s
H    0     0                    -10135.23817 9570.00544   194%     -  587s
     0     0 9273.93350    0  389 -10135.238 9273.93350   192%     -  650s
     0     0 9162.90015    0  392 -10135.238 9162.90015   190%     -  695s
     0     0 9107.97775    0  408 -10135.238 9107.97775   190%     -  729s
     0     0 9071.99922    0  399 -10135.238 9071.99922   190%     -  749s
     0     0 9029.94349    0  396 -10135.238 9029.94349   189%     -  763s
     0     0 9018.32440    0  401 -10135.238 9018.32440   189%     -  771s
     0     0 8989.36536    0  393 -10135.238 8989.36536   189%     -  790s
     0     0 8967.80692    0  402 -10135.238 8967.80692   188%     -  803s
     0     0 8933.60506    0  402 -10135.238 8933.60506   188%     -  820s
     0     0 8898.28778    0  403 -10135.238 8898.28778   188%     -  842s
     0     0 8894.70115    0  403 -10135.238 8894.70115   188%     -  848s
     0     0 8891.89158    0  407 -10135.238 8891.89158   188%     -  854s
     0     0 8891.42126    0  403 -10135.238 8891.42126   188%     -  856s
     0     0 8204.02870    0  461 -10135.238 8204.02870   181%     -  965s
     0     0 8030.68732    0  412 -10135.238 8030.68732   179%     - 1005s
     0     0 7894.72365    0  432 -10135.238 7894.72365   178%     - 1038s
     0     0 7831.57866    0  426 -10135.238 7831.57866   177%     - 1060s
     0     0 7731.79506    0  412 -10135.238 7731.79506   176%     - 1077s
     0     0 7702.18575    0  412 -10135.238 7702.18575   176%     - 1086s
     0     0 7687.90060    0  424 -10135.238 7687.90060   176%     - 1092s
     0     0 7677.05956    0  425 -10135.238 7677.05956   176%     - 1098s
     0     0 7671.70949    0  429 -10135.238 7671.70949   176%     - 1103s
     0     0 7643.80549    0  423 -10135.238 7643.80549   175%     - 1114s
     0     0 7633.23389    0  431 -10135.238 7633.23389   175%     - 1121s
     0     0 7631.69046    0  435 -10135.238 7631.69046   175%     - 1126s
     0     0 7621.84833    0  426 -10135.238 7621.84833   175%     - 1133s
     0     0 7601.98347    0  425 -10135.238 7601.98347   175%     - 1140s
     0     0 7597.45977    0  423 -10135.238 7597.45977   175%     - 1143s
     0     0 7595.14415    0  426 -10135.238 7595.14415   175%     - 1147s
     0     0 7595.02547    0  428 -10135.238 7595.02547   175%     - 1150s
     0     0 7511.25477    0  425 -10135.238 7511.25477   174%     - 1182s
     0     0 7487.07640    0  506 -10135.238 7487.07640   174%     - 1209s
     0     0 7478.33517    0  468 -10135.238 7478.33517   174%     - 1222s
     0     0 7473.75224    0  599 -10135.238 7473.75224   174%     - 1231s
     0     0 7471.80453    0  567 -10135.238 7471.80453   174%     - 1240s
     0     0 7470.89463    0  442 -10135.238 7470.89463   174%     - 1244s
     0     0 7411.67593    0  558 -10135.238 7411.67593   173%     - 1270s
H    0     0                    -9724.078154 7411.60188   176%     - 1289s
H    0     0                    -8482.221508 7411.60188   187%     - 1289s
     0     0 7379.65413    0  469 -8482.2215 7379.65413   187%     - 1305s
     0     0 7358.13871    0  552 -8482.2215 7358.13871   187%     - 1316s
     0     0 7354.12729    0  543 -8482.2215 7354.12729   187%     - 1322s
     0     0 7352.18007    0  551 -8482.2215 7352.18007   187%     - 1325s
     0     0 7330.77203    0  440 -8482.2215 7330.77203   186%     - 1337s
     0     0 7323.71133    0  447 -8482.2215 7323.71133   186%     - 1344s
     0     0 7320.88868    0  440 -8482.2215 7320.88868   186%     - 1348s
     0     0 7317.88988    0  441 -8482.2215 7317.88988   186%     - 1351s
     0     0 7314.41284    0  437 -8482.2215 7314.41284   186%     - 1355s
     0     0 7314.33070    0  443 -8482.2215 7314.33070   186%     - 1356s
     0     0 7292.35474    0  426 -8482.2215 7292.35474   186%     - 1372s
H    0     0                    -8351.797682 7292.05771   187%     - 1373s
     0     0 7282.57208    0  590 -8351.7977 7282.57208   187%     - 1382s
     0     0 7278.43860    0  475 -8351.7977 7278.43860   187%     - 1388s
     0     0 7276.57020    0  596 -8351.7977 7276.57020   187%     - 1391s
     0     0 7274.73920    0  474 -8351.7977 7274.73920   187%     - 1394s
     0     0 7269.85360    0  437 -8351.7977 7269.85360   187%     - 1396s
     0     0 7268.43316    0  439 -8351.7977 7268.43316   187%     - 1397s
     0     0 7250.88888    0  428 -8351.7977 7250.88888   187%     - 1406s
H    0     0                    -7282.915917 7250.66988   200%     - 1437s
H    0     0                    -7265.007995 7250.66988   200%     - 1440s
     0     0 7244.14220    0  496 -7265.0080 7244.14220   200%     - 1448s
     0     0 7242.10536    0  464 -7265.0080 7242.10536   200%     - 1451s
     0     0 7240.99210    0  470 -7265.0080 7240.99210   200%     - 1454s
     0     0 7237.01410    0  430 -7265.0080 7237.01410   200%     - 1459s
     0     0 7235.34002    0  445 -7265.0080 7235.34002   200%     - 1462s
     0     0 7226.17634    0  434 -7265.0080 7226.17634   199%     - 1470s
     0     0 7222.03055    0  517 -7265.0080 7222.03055   199%     - 1476s
     0     0 7214.66240    0  574 -7265.0080 7214.66240   199%     - 1481s
     0     0 7211.75878    0  566 -7265.0080 7211.75878   199%     - 1485s
     0     0 7209.01142    0  569 -7265.0080 7209.01142   199%     - 1488s
     0     0 7208.30665    0  567 -7265.0080 7208.30665   199%     - 1490s
     0     0 7204.60909    0  483 -7265.0080 7204.60909   199%     - 1496s
     0     0 7202.50249    0  478 -7265.0080 7202.50249   199%     - 1501s
     0     0 7202.01529    0  475 -7265.0080 7202.01529   199%     - 1504s
     0     0 7184.91137    0  477 -7265.0080 7184.91137   199%     - 1513s
     0     0 7184.63157    0  478 -7265.0080 7184.63157   199%     - 1516s
     0     0 7180.99755    0  442 -7265.0080 7180.99755   199%     - 1522s
     0     0 7178.96834    0  442 -7265.0080 7178.96834   199%     - 1526s
     0     0 7178.38394    0  480 -7265.0080 7178.38394   199%     - 1528s
     0     0 7170.69452    0  434 -7265.0080 7170.69452   199%     - 1536s
     0     0 7167.99246    0  440 -7265.0080 7167.99246   199%     - 1540s
     0     0 7164.84586    0  441 -7265.0080 7164.84586   199%     - 1543s
     0     0 7164.19443    0  441 -7265.0080 7164.19443   199%     - 1544s
     0     0 7144.38769    0  437 -7265.0080 7144.38769   198%     - 1552s
     0     0 7135.83229    0  448 -7265.0080 7135.83229   198%     - 1559s
     0     0 7133.64820    0  447 -7265.0080 7133.64820   198%     - 1560s
     0     0 7133.10040    0  440 -7265.0080 7133.10040   198%     - 1561s
     0     0 7128.44476    0  441 -7265.0080 7128.44476   198%     - 1566s
H    0     0                    -7188.066876 7126.88288   199%     - 1600s
H    0     0                    -7058.229443 7126.88288   201%     - 1603s
H    0     0                    -6748.558986 7126.88288   206%     - 1603s
H    0     0                    -6618.721553 7126.88288   208%     - 1603s
H    0     0                    -6601.113128 7126.88288   208%     - 1603s
     0     0 7125.89733    0  440 -6601.1131 7125.89733   208%     - 1606s
     0     0 7124.16173    0  453 -6601.1131 7124.16173   208%     - 1608s
     0     0 7122.32800    0  445 -6601.1131 7122.32800   208%     - 1610s
     0     0 7121.15263    0  442 -6601.1131 7121.15263   208%     - 1612s
     0     0 7112.62967    0  456 -6601.1131 7112.62967   208%     - 1619s
     0     0 7111.33599    0  443 -6601.1131 7111.33599   208%     - 1622s
     0     0 7105.28352    0  449 -6601.1131 7105.28352   208%     - 1630s
     0     0 7104.61367    0  444 -6601.1131 7104.61367   208%     - 1632s
     0     0 7098.93468    0  443 -6601.1131 7098.93468   208%     - 1638s
     0     0 7098.68627    0  444 -6601.1131 7098.68627   208%     - 1640s
     0     0 7098.35187    0  442 -6601.1131 7098.35187   208%     - 1645s
     0     0 7097.96635    0  442 -6601.1131 7097.96635   208%     - 1653s
H    0     0                    -5793.840488 7097.90853   223%     - 1841s
H    0     0                    -5771.842518 7097.90853   223%     - 1841s
H    0     0                    -5692.472504 7097.90853   225%     - 1940s
     0     2 7097.90853    0  442 -5692.4725 7097.90853   225%     - 1945s
     1     3 6814.68907    1  439 -5692.4725 7097.00301   225% 24325 1989s
     2     4 7032.94134    1  455 -5692.4725 7032.94134   224% 15407 2002s
     3     6 6978.45515    2  436 -5692.4725 7032.70538   224% 14158 2033s
     5    10 6608.08389    3  439 -5692.4725 7032.70538   224% 14787 2071s
     9    17 6190.13622    4  446 -5692.4725 6789.70681   219% 15450 2118s
    16    34 6022.86190    5  449 -5692.4725 6787.93885   219% 16024 2152s
    33    49 5372.03839    5  442 -5692.4725 6434.20200   213% 18316 2236s
    48    76 2926.98630    6  276 -5692.4725 6434.20200   213% 24583 2315s
    75   160 4215.25963    8  367 -5692.4725 6434.20200   213% 19767 2388s
   159   189 4075.82434    9  367 -5692.4725 6434.20200   213% 14490 2450s
   188   226 3966.46773   10  348 -5692.4725 6434.20200   213% 13877 2528s
   225   253 3675.19191   11  298 -5692.4725 6434.20200   213% 12663 2602s
   252   282 3668.48329   12  294 -5692.4725 6434.20200   213% 12174 2665s
H  278   282                    -5632.415514 6434.20200   214% 11846 2665s
   282   302 2349.72913   11  329 -5632.4155 6434.20200   214% 11836 2849s
   320   343 3509.26011   13  293 -5632.4155 6434.20200   214% 11360 2926s
   385   392 2547.44642   15  307 -5632.4155 6434.20200   214% 11219 2991s
   440   455 2513.79702   16  305 -5632.4155 6434.20200   214% 10876 3035s
   523   506 1908.62358   21  279 -5632.4155 6434.20200   214% 10905 3086s
   599   573 1168.33253   26  206 -5632.4155 6434.20200   214% 10637 3130s
   679   629  552.10401   31  249 -5632.4155 6434.20200   214% 10398 3173s
   754   678  142.23806   35  199 -5632.4155 6434.20200   214% 10312 3208s
   827   750  -32.78562   38  250 -5632.4155 6434.20200   214% 10053 3244s
   925   814 -439.75110   43  255 -5632.4155 6434.20200   214%  9735 3278s
  1019   885 -1332.2595   47  233 -5632.4155 6434.20200   214%  9437 3313s
  1114   932 -1715.1156   53  169 -5632.4155 6434.20200   214%  9184 3350s
H 1121   932                    -5624.008892 6434.20200   214%  9149 3350s
  1214   995 -2739.5549   60  203 -5624.0089 6434.20200   214%  8976 3387s
  1315  1088 -3643.2741   66  183 -5624.0089 6434.20200   214%  8781 3426s
  1440  1188 -4292.7939   75  168 -5624.0089 6434.20200   214%  8608 3459s
  1599  1293 -4724.1468   83  158 -5624.0089 6434.20200   214%  8266 3502s
  1760  1358 -4996.5451   92   99 -5624.0089 6434.20200   214%  7874 3545s
  1941  1450 -2621.9805   29  258 -5624.0089 6434.20200   214%  7623 3586s
  2135  1457 -4586.1619   26  173 -5624.0089 6434.20200   214%  7333 3600s

Cutting planes:
  Gomory: 3
  Implied bound: 92
  MIR: 2599
  Flow cover: 3198
  Zero half: 1
  RLT: 44
  Relax-and-lift: 346

Explored 2196 nodes (16651277 simplex iterations) in 3600.14 seconds (5079.61 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -5624.01 -5632.42 -5692.47 ... -7188.07

Time limit reached
Best objective -5.624008891823e+03, best bound 6.434202004864e+03, gap 214.4060%
  WARNING: Time limit reached. Using best solution found (gap: 214.41%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.17s
  Master Objective (UB) = -5624.01, θ = 136270.54
  Upper Bound (UB) = -5624.01

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 136270.54
  [DEBUG]   ✓ Scenario 0: θ = 136270.54 ≤ Q = 136270.54 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 136270.54 ≤ Q = 136270.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 136270.54 ≤ Q = 136270.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 136270.54 ≤ Q = 136270.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 136270.54 ≤ Q = 136270.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 136270.54 ≤ Q = 136270.54 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 136270.54 ≤ Q = 136270.54 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 136270.54 ≤ Q = 136270.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 136270.54 ≤ Q = 136270.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 136270.54 ≤ Q = 136270.54 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 136270.54 ≤ Q = 136270.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 136270.54 ≤ Q = 136270.54 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 136270.54 ≤ Q = 136270.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 136270.54 ≤ Q = 136270.54 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 136270.54 ≤ Q = 136270.54 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 136270.54 ≤ Q = 136270.54 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 136270.54 ≤ Q = 136270.54 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 136270.54 ≤ Q = 136270.54 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 18] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0xb03a422
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xf4fc5bde
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [3e-15, 2e+02]
Found heuristic solution: objective 1.168753e+13
Presolve removed 2625 rows and 1917 columns
Presolve time: 0.01s
Presolved: 468 rows, 472 columns, 1322 nonzeros
Found heuristic solution: objective 5301469.3838
Variable types: 320 continuous, 152 integer (152 binary)

Root relaxation: objective -1.345060e+05, 240 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -134505.99    0  126 5301469.38 -134505.99   103%     -    0s
H    0     0                    -100459.1773 -134505.99  33.9%     -    0s
H    0     0                    -100834.3109 -134505.99  33.4%     -    0s
     0     0 -118840.16    0   63 -100834.31 -118840.16  17.9%     -    0s
H    0     0                    -116317.7289 -118778.99  2.12%     -    0s
     0     0 -118697.73    0   62 -116317.73 -118697.73  2.05%     -    0s
     0     0 -117996.16    0   34 -116317.73 -117996.16  1.44%     -    0s
H    0     0                    -117018.4741 -117933.73  0.78%     -    0s
H    0     0                    -117133.3626 -117824.58  0.59%     -    0s
     0     0 -117824.58    0   29 -117133.36 -117824.58  0.59%     -    0s
     0     0 -117791.04    0   30 -117133.36 -117791.04  0.56%     -    0s
     0     0 -117788.00    0   30 -117133.36 -117788.00  0.56%     -    0s
     0     0 -117493.19    0   17 -117133.36 -117493.19  0.31%     -    0s
     0     0 -117458.05    0   21 -117133.36 -117458.05  0.28%     -    0s
     0     0 -117320.53    0   14 -117133.36 -117320.53  0.16%     -    0s
     0     0 -117278.73    0   12 -117133.36 -117278.73  0.12%     -    0s
     0     0 -117214.91    0    6 -117133.36 -117214.91  0.07%     -    0s
     0     0 -117199.80    0    4 -117133.36 -117199.80  0.06%     -    0s
H    0     0                    -117182.6573 -117199.80  0.01%     -    0s

Cutting planes:
  Implied bound: 3
  MIR: 3
  Flow cover: 2
  RLT: 2

Explored 1 nodes (638 simplex iterations) in 0.10 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 8: -117183 -117133 -117018 ... 1.16875e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.171826573144e+05, best bound -1.171900823436e+05, gap 0.0063%
  Subproblem solved in 0.14s
  Worst-case operational profit (Z_SP) = 124491.71
  Scenario: 28 demand increases, 32 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -117182.66
  [DEBUG]   S×d_nominal = 241674.37
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 241674.37 + -117182.66 = 124491.71
  [DEBUG]   Current θ from Master = 136270.54
  [DEBUG]   ⚠️  Z_SP ≤ θ by 11778.83 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -17402.84
  Lower Bound (LB) = -4230.81
  Gap (UB-LB) = -1393.1957, Absolute Gap = 1393.1957, Relative Gap = -0.247723
  ⚠️  WARNING: NEGATIVE GAP detected!
  UB = -5624.01, LB = -4230.81, Gap = -1393.20
  Possible causes:
    1. Subproblem returned suboptimal Z_SP (too large → LB over-estimated)
    2. Master Problem returned suboptimal θ (too small → UB under-estimated)
    3. Numerical precision issues in bound calculations
  Algorithm will continue to search for better solutions...

  [DEBUG] Adding NEW scenario 18 to Master Problem...
  [DEBUG] New scenario pattern: 28 increases, 32 decreases
    [DEBUG] Scenario 18 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 18 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 18]
    [DEBUG]   - Total constraints in model: 291893
    [DEBUG]   - Total variables in model: 120820
  [DEBUG] Total scenarios in Master: 19
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 19
================================================================================
[Iteration 19] Solving Master Problem...
  Current scenarios in Master: 19
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 291893 rows, 120820 columns and 826680 nonzeros
Model fingerprint: 0x1a0ec022
Variable types: 118561 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 142006 rows and 57646 columns (presolve time = 5s)...
Presolve removed 142006 rows and 57646 columns
Presolve time: 5.42s
Presolved: 149887 rows, 63174 columns, 925178 nonzeros
Variable types: 60915 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -366101.7227
Found heuristic solution: objective -171217.0927

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.64s

Barrier statistics:
 Dense cols : 557
 AA' NZ     : 9.300e+06
 Factor NZ  : 2.022e+07 (roughly 250 MB of memory)
 Factor Ops : 5.089e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.64911049e+07  2.47147749e+08  8.68e+04 1.69e+01  7.04e+04     9s
   1  -1.28541048e+07  2.19953625e+08  6.15e+04 4.07e+01  4.95e+04     9s
   2  -5.29727098e+06  1.65770187e+08  2.46e+04 4.34e+00  2.10e+04     9s
   3  -8.73335744e+05  1.24499339e+08  1.87e+03 1.76e+00  1.96e+03     9s
   4  -5.35874291e+05  8.91532065e+07  4.12e+02 9.68e-01  6.40e+02    10s
   5  -4.78734741e+05  5.02483313e+07  2.23e+02 4.75e-01  3.37e+02    10s
   6  -4.09564938e+05  3.74642598e+07  7.95e+01 3.34e-01  1.89e+02    10s
   7  -3.46616704e+05  2.75162571e+07  2.46e+01 2.36e-01  1.15e+02    10s
   8  -2.79362656e+05  2.04247738e+07  4.05e+00 1.70e-01  7.76e+01    10s
   9  -1.61500028e+05  8.67228884e+06  5.02e-02 7.01e-02  3.23e+01    10s
  10  -1.41198280e+05  2.76645499e+06  3.65e-02 2.27e-02  1.06e+01    11s
  11  -1.05068938e+05  2.21655335e+06  2.16e-02 1.81e-02  8.49e+00    11s
  12  -8.76380914e+04  1.45120471e+06  1.46e-02 1.17e-02  5.63e+00    11s
  13  -6.05140848e+04  1.02491494e+06  7.16e-03 8.20e-03  3.97e+00    11s
  14  -3.10113797e+04  3.53034291e+05  2.02e-03 2.73e-03  1.40e+00    11s
  15  -2.05599119e+04  2.43441508e+05  1.32e-03 1.89e-03  9.65e-01    11s
  16  -1.28727195e+04  1.44204551e+05  9.46e-04 1.09e-03  5.74e-01    12s
  17  -1.02167591e+04  1.20920457e+05  8.36e-04 8.88e-04  4.79e-01    12s
  18  -5.60811365e+03  8.94371277e+04  6.55e-04 6.40e-04  3.47e-01    12s
  19  -2.94629443e+02  6.98314267e+04  4.85e-04 4.69e-04  2.56e-01    12s
  20   3.85725651e+03  5.21705852e+04  3.57e-04 3.22e-04  1.77e-01    13s
  21   6.90051472e+03  4.20340337e+04  2.71e-04 2.26e-04  1.28e-01    13s
  22   9.88670036e+03  3.41778370e+04  1.97e-04 1.49e-04  8.88e-02    13s
  23   1.21191988e+04  2.83254819e+04  1.46e-04 9.00e-05  5.93e-02    13s
  24   1.42830997e+04  2.52456166e+04  9.89e-05 5.86e-05  4.01e-02    14s
  25   1.61256719e+04  2.36650285e+04  6.13e-05 4.25e-05  2.76e-02    14s
  26   1.69592956e+04  2.22489654e+04  4.52e-05 2.78e-05  1.93e-02    14s
  27   1.72836728e+04  2.13426566e+04  3.89e-05 1.84e-05  1.48e-02    14s
  28   1.75921409e+04  2.10196907e+04  3.32e-05 1.52e-05  1.25e-02    15s
  29   1.83205685e+04  2.05610333e+04  2.00e-05 1.04e-05  8.19e-03    15s
  30   1.86971704e+04  2.00800072e+04  1.34e-05 5.65e-06  5.06e-03    15s
  31   1.88992915e+04  1.98941932e+04  9.91e-06 3.77e-06  3.64e-03    15s
  32   1.91013008e+04  1.98223385e+04  6.46e-06 3.06e-06  2.64e-03    15s
  33   1.91816906e+04  1.97461202e+04  5.18e-06 2.29e-06  2.06e-03    16s
  34   1.92243672e+04  1.96566314e+04  4.45e-06 1.43e-06  1.58e-03    16s
  35   1.94054391e+04  1.95880949e+04  1.45e-06 7.59e-07  6.68e-04    16s
  36   1.94412624e+04  1.95376706e+04  9.35e-07 2.76e-07  3.52e-04    16s
  37   1.94708051e+04  1.95265382e+04  5.02e-07 1.71e-07  2.04e-04    17s
  38   1.94946192e+04  1.95149858e+04  1.71e-07 1.19e-07  7.45e-05    17s
  39   1.95002727e+04  1.95100026e+04  9.63e-08 4.04e-08  3.56e-05    17s
  40   1.95068653e+04  1.95074054e+04  3.21e-08 2.18e-09  1.98e-06    18s
  41   1.95070569e+04  1.95072099e+04  2.24e-07 2.68e-07  5.60e-07    18s
  42   1.95070588e+04  1.95072099e+04  1.11e-06 2.65e-07  5.53e-07    18s
  43   1.95071384e+04  1.95072075e+04  5.57e-07 1.08e-08  2.53e-07    19s
  44   1.95071447e+04  1.95072075e+04  3.38e-06 1.16e-07  2.30e-07    19s
  45   1.95071726e+04  1.95072075e+04  1.93e-06 2.63e-06  1.28e-07    19s
  46   1.95071812e+04  1.95072075e+04  1.79e-06 1.32e-06  9.62e-08    19s
  47   1.95071865e+04  1.95072075e+04  1.44e-06 2.32e-06  7.68e-08    20s
  48   1.95071938e+04  1.95072075e+04  2.01e-06 1.95e-06  5.04e-08    20s
  49   1.95071975e+04  1.95072075e+04  2.48e-06 1.10e-06  3.65e-08    20s
  50   1.95072009e+04  1.95072075e+04  1.63e-06 1.36e-06  2.41e-08    20s
  51   1.95072034e+04  1.95072075e+04  1.00e-06 8.79e-07  1.47e-08    21s
  52   1.95072038e+04  1.95072075e+04  1.73e-06 7.99e-07  1.32e-08    21s
  53   1.95072049e+04  1.95072075e+04  2.27e-06 3.31e-07  9.49e-09    21s
  54   1.95072049e+04  1.95072075e+04  7.94e-06 3.46e-07  9.46e-09    21s
  55   1.95072049e+04  1.95072075e+04  7.93e-06 3.49e-07  9.49e-09    21s
  56   1.95072051e+04  1.95072075e+04  7.87e-06 3.63e-07  9.60e-09    22s
  57   1.95072073e+04  1.95072074e+04  3.60e-07 3.22e-07  4.31e-10    22s

Barrier solved model in 57 iterations and 21.87 seconds (19.96 work units)
Optimal objective 1.95072073e+04


Root crossover log...

  132733 DPushes remaining with DInf 0.0000000e+00                22s
   36880 DPushes remaining with DInf 0.0000000e+00                25s
     686 DPushes remaining with DInf 0.0000000e+00                30s
       0 DPushes remaining with DInf 0.0000000e+00                31s

    8466 PPushes remaining with PInf 5.6660048e-05                31s
       0 PPushes remaining with PInf 0.0000000e+00                32s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.5711943e+03     32s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   69364    1.9507207e+04   0.000000e+00   1.571194e+03     32s
   69451    1.9507207e+04   0.000000e+00   0.000000e+00     32s
   69451    1.9507207e+04   0.000000e+00   0.000000e+00     32s
Concurrent spin time: 3.04s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 1.950721e+04, 69451 iterations, 28.27 seconds (30.89 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 19507.2074    0  162 -171217.09 19507.2074   111%     -   36s
H    0     0                    -170278.9058 19507.2074   111%     -   38s
H    0     0                    -69894.59137 19507.2074   128%     -   38s
H    0     0                    -20067.33329 19507.2074   197%     -   38s
     0     0 15372.7478    0  277 -20067.333 15372.7478   177%     -  127s
H    0     0                    -19316.68974 15372.7050   180%     -  128s
H    0     0                    -17978.02517 15372.7050   186%     -  128s
H    0     0                    -17927.30946 15372.7050   186%     -  128s
H    0     0                    -17092.33241 15372.7050   190%     -  129s
H    0     0                    -15423.06509 15372.7050   200%     -  129s
H    0     0                    -15258.36481 15372.7050   201%     -  129s
     0     0 14595.9617    0  299 -15258.365 14595.9617   196%     -  188s
     0     0 14576.2674    0  302 -15258.365 14576.2674   196%     -  201s
     0     0 14575.6287    0  303 -15258.365 14575.6287   196%     -  203s
     0     0 14555.0027    0  303 -15258.365 14555.0027   195%     -  211s
     0     0 14553.2123    0  300 -15258.365 14553.2123   195%     -  215s
     0     0 14552.7839    0  301 -15258.365 14552.7839   195%     -  218s
     0     0 11759.1233    0  293 -15258.365 11759.1233   177%     -  308s
H    0     0                    -12453.75788 11759.0763   194%     -  309s
     0     0 11478.2201    0  289 -12453.758 11478.2201   192%     -  352s
     0     0 11417.4007    0  302 -12453.758 11417.4007   192%     -  373s
     0     0 11356.1888    0  299 -12453.758 11356.1888   191%     -  392s
     0     0 11324.7689    0  289 -12453.758 11324.7689   191%     -  411s
     0     0 11310.7944    0  301 -12453.758 11310.7944   191%     -  425s
     0     0 11274.4842    0  302 -12453.758 11274.4842   191%     -  444s
     0     0 11259.4694    0  300 -12453.758 11259.4694   190%     -  452s
     0     0 11199.4804    0  296 -12453.758 11199.4804   190%     -  473s
     0     0 11180.3376    0  371 -12453.758 11180.3376   190%     -  488s
     0     0 11137.2088    0  369 -12453.758 11137.2088   189%     -  506s
     0     0 11105.7753    0  309 -12453.758 11105.7753   189%     -  525s
     0     0 11101.7243    0  301 -12453.758 11101.7243   189%     -  530s
     0     0 11048.7765    0  365 -12453.758 11048.7765   189%     -  553s
     0     0 11041.6217    0  380 -12453.758 11041.6217   189%     -  562s
     0     0 11040.8143    0  376 -12453.758 11040.8143   189%     -  565s
     0     0 9706.21790    0  392 -12453.758 9706.21790   178%     -  691s
H    0     0                    -12397.85427 9705.95253   178%     -  692s
H    0     0                    -11286.42329 9705.95253   186%     -  692s
H    0     0                    -11030.85861 9705.95253   188%     -  693s
     0     0 9333.11078    0  393 -11030.859 9333.11078   185%     -  740s
     0     0 9221.48678    0  413 -11030.859 9221.48678   184%     -  776s
     0     0 9187.16433    0  408 -11030.859 9187.16433   183%     -  790s
     0     0 9178.14975    0  409 -11030.859 9178.14975   183%     -  796s
     0     0 9166.25174    0  404 -11030.859 9166.25174   183%     -  805s
     0     0 9138.04602    0  395 -11030.859 9138.04602   183%     -  816s
     0     0 9095.29256    0  398 -11030.859 9095.29256   182%     -  838s
     0     0 9065.02529    0  390 -11030.859 9065.02529   182%     -  853s
     0     0 9045.34987    0  399 -11030.859 9045.34987   182%     -  864s
     0     0 9043.44992    0  403 -11030.859 9043.44992   182%     -  869s
     0     0 9043.18088    0  405 -11030.859 9043.18088   182%     -  872s
     0     0 8384.44422    0  488 -11030.859 8384.44422   176%     -  970s
     0     0 8201.65478    0  461 -11030.859 8201.65478   174%     - 1007s
     0     0 8043.69172    0  470 -11030.859 8043.69172   173%     - 1044s
     0     0 7999.42665    0  530 -11030.859 7999.42665   173%     - 1058s
     0     0 7947.46055    0  546 -11030.859 7947.46055   172%     - 1072s
     0     0 7893.35616    0  546 -11030.859 7893.35616   172%     - 1087s
     0     0 7867.85255    0  456 -11030.859 7867.85255   171%     - 1101s
     0     0 7853.15445    0  456 -11030.859 7853.15445   171%     - 1112s
     0     0 7849.68150    0  456 -11030.859 7849.68150   171%     - 1118s
     0     0 7818.92346    0  466 -11030.859 7818.92346   171%     - 1126s
     0     0 7814.18020    0  469 -11030.859 7814.18020   171%     - 1133s
     0     0 7801.47519    0  537 -11030.859 7801.47519   171%     - 1140s
     0     0 7800.01764    0  464 -11030.859 7800.01764   171%     - 1143s
     0     0 7794.09184    0  553 -11030.859 7794.09184   171%     - 1149s
     0     0 7792.14608    0  477 -11030.859 7792.14608   171%     - 1153s
     0     0 7786.92767    0  461 -11030.859 7786.92767   171%     - 1159s
     0     0 7777.18458    0  472 -11030.859 7777.18458   171%     - 1165s
     0     0 7772.90621    0  468 -11030.859 7772.90621   170%     - 1168s
     0     0 7770.55217    0  460 -11030.859 7770.55217   170%     - 1171s
     0     0 7768.55076    0  458 -11030.859 7768.55076   170%     - 1175s
     0     0 7767.16602    0  464 -11030.859 7767.16602   170%     - 1178s
     0     0 7763.56331    0  457 -11030.859 7763.56331   170%     - 1180s
     0     0 7763.45917    0  459 -11030.859 7763.45917   170%     - 1180s
     0     0 7579.79685    0  524 -11030.859 7579.79685   169%     - 1222s
H    0     0                    -11011.86412 7579.65696   169%     - 1223s
H    0     0                    -10199.79197 7579.65696   174%     - 1223s
     0     0 7551.48343    0  568 -10199.792 7551.48343   174%     - 1242s
     0     0 7521.25827    0  569 -10199.792 7521.25827   174%     - 1257s
     0     0 7506.14225    0  569 -10199.792 7506.14225   174%     - 1269s
     0     0 7495.27040    0  570 -10199.792 7495.27040   173%     - 1283s
     0     0 7482.67191    0  566 -10199.792 7482.67191   173%     - 1296s
     0     0 7472.52563    0  526 -10199.792 7472.52563   173%     - 1308s
     0     0 7454.38953    0  568 -10199.792 7454.38953   173%     - 1319s
     0     0 7426.91874    0  561 -10199.792 7426.91874   173%     - 1341s
     0     0 7419.87885    0  565 -10199.792 7419.87885   173%     - 1351s
     0     0 7417.29505    0  570 -10199.792 7417.29505   173%     - 1356s
     0     0 7416.20387    0  573 -10199.792 7416.20387   173%     - 1359s
     0     0 7354.62379    0  471 -10199.792 7354.62379   172%     - 1389s
H    0     0                    -9972.709503 7354.14771   174%     - 1403s
H    0     0                    -9606.417826 7354.14771   177%     - 1403s
     0     0 7343.19102    0  473 -9606.4178 7343.19102   176%     - 1429s
     0     0 7334.79041    0  476 -9606.4178 7334.79041   176%     - 1443s
     0     0 7331.59481    0  471 -9606.4178 7331.59481   176%     - 1454s
     0     0 7328.23192    0  477 -9606.4178 7328.23192   176%     - 1461s
     0     0 7327.99343    0  506 -9606.4178 7327.99343   176%     - 1464s
     0     0 7276.99135    0  460 -9606.4178 7276.99135   176%     - 1493s
     0     0 7267.80159    0  501 -9606.4178 7267.80159   176%     - 1510s
     0     0 7265.09977    0  500 -9606.4178 7265.09977   176%     - 1519s
     0     0 7262.79909    0  465 -9606.4178 7262.79909   176%     - 1524s
     0     0 7261.51602    0  500 -9606.4178 7261.51602   176%     - 1530s
     0     0 7141.81613    0  484 -9606.4178 7141.81613   174%     - 1551s
H    0     0                    -9507.207383 7139.64800   175%     - 1555s
     0     0 7127.25099    0  491 -9507.2074 7127.25099   175%     - 1563s
     0     0 7118.02179    0  506 -9507.2074 7118.02179   175%     - 1575s
     0     0 7115.26565    0  475 -9507.2074 7115.26565   175%     - 1582s
     0     0 7114.25217    0  510 -9507.2074 7114.25217   175%     - 1587s
     0     0 7098.09699    0  464 -9507.2074 7098.09699   175%     - 1605s
     0     0 7091.91041    0  472 -9507.2074 7091.91041   175%     - 1627s
     0     0 7090.82724    0  479 -9507.2074 7090.82724   175%     - 1633s
     0     0 7075.86279    0  471 -9507.2074 7075.86279   174%     - 1648s
H    0     0                    -7439.154343 7075.48375   195%     - 1674s
H    0     0                    -6187.544631 7075.48375   214%     - 1674s
H    0     0                    -6116.253087 7075.48375   216%     - 1676s
H    0     0                    -4698.651811 7075.48375   251%     - 1676s
     0     0 7074.01205    0  471 -4698.6518 7074.01205   251%     - 1683s
     0     0 7071.93558    0  506 -4698.6518 7071.93558   251%     - 1689s
     0     0 7069.39883    0  467 -4698.6518 7069.39883   250%     - 1696s
     0     0 7068.87021    0  473 -4698.6518 7068.87021   250%     - 1699s
     0     0 7055.79987    0  470 -4698.6518 7055.79987   250%     - 1709s
     0     0 7054.06907    0  466 -4698.6518 7054.06907   250%     - 1712s
     0     0 7053.76779    0  475 -4698.6518 7053.76779   250%     - 1713s
     0     0 7044.99084    0  472 -4698.6518 7044.99084   250%     - 1721s
H    0     0                    -3422.675307 7044.71569   306%     - 1725s
     0     0 7043.66265    0  470 -3422.6753 7043.66265   306%     - 1729s
     0     0 7036.68952    0  470 -3422.6753 7036.68952   306%     - 1736s
     0     0 7035.91766    0  470 -3422.6753 7035.91766   306%     - 1739s
     0     0 7033.37803    0  481 -3422.6753 7033.37803   305%     - 1745s
     0     0 7033.28953    0  481 -3422.6753 7033.28953   305%     - 1754s
H    0     0                    -3370.849436 7033.28953   309%     - 1890s
H    0     0                    -3329.349519 7033.24996   311%     - 2161s
H    0     0                    -3319.200572 7033.24996   312%     - 2259s
H    0     0                    -3305.116405 7033.24996   313%     - 2273s
H    0     0                    -3293.609882 7033.24996   314%     - 2273s
H    0     0                    -3272.607275 7033.24996   315%     - 2273s
     0     2 7033.24996    0  481 -3272.6073 7033.24996   315%     - 2275s
     1     3 6663.66766    1  456 -3272.6073 7033.24996   315% 22749 2314s
     2     4 6921.85989    1  462 -3272.6073 6921.85989   312% 17862 2336s
     3     5 6275.44637    2  400 -3272.6073 6921.76090   312% 17849 2377s
     4     9 6099.30309    3  407 -3272.6073 6921.76090   312% 17034 2421s
     8    16 5243.05176    4  439 -3272.6073 6866.63791   310% 15204 2508s
    15    32 5055.99350    5  447 -3272.6073 6866.63791   310% 17894 2567s
    31    48 6467.90783    5  468 -3272.6073 6730.00849   306% 22465 2713s
    47    78 5822.76100    6  437 -3272.6073 6730.00849   306% 26767 2810s
H   77   119                    -3231.699628 6730.00849   308% 22842 2913s
   118   149 5593.24902    9  395 -3231.6996 6730.00849   308% 20044 2984s
   148   198 5584.32274   10  394 -3231.6996 6730.00849   308% 17562 3056s
   197   266 5350.48490   11  391 -3231.6996 6730.00849   308% 15203 3143s
   265   337 5214.37451   13  394 -3231.6996 6730.00849   308% 13002 3222s
   340   387 4555.85488   16  386 -3231.6996 6730.00849   308% 12151 3303s
   392   430 4433.41566   17  391 -3231.6996 6730.00849   308% 11550 3379s
   435   468 3317.45528   21  399 -3231.6996 6730.00849   308% 11217 3462s
   483   513 2378.05940   22  325 -3231.6996 6730.00849   308% 10822 3537s
   539   551  431.88457   24  231 -3231.6996 6730.00849   308% 10387 3600s

Cutting planes:
  Learned: 1
  Implied bound: 77
  MIR: 2547
  Flow cover: 2992
  Zero half: 1
  RLT: 52
  Relax-and-lift: 309

Explored 591 nodes (6771665 simplex iterations) in 3600.06 seconds (5019.25 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -3231.7 -3272.61 -3293.61 ... -6116.25

Time limit reached
Best objective -3.231699628030e+03, best bound 6.730008490094e+03, gap 308.2498%
  WARNING: Time limit reached. Using best solution found (gap: 308.25%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = -3231.70, θ = 132033.81
  Upper Bound (UB) = -3231.70

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 132033.81
  [DEBUG]   ✓ Scenario 0: θ = 132033.81 ≤ Q = 132033.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 132033.81 ≤ Q = 132033.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 132033.81 ≤ Q = 132033.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 132033.81 ≤ Q = 132033.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 132033.81 ≤ Q = 132033.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 132033.81 ≤ Q = 132033.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 132033.81 ≤ Q = 132033.81 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 132033.81 ≤ Q = 132033.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 132033.81 ≤ Q = 132033.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 132033.81 ≤ Q = 132033.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 132033.81 ≤ Q = 132033.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 132033.81 ≤ Q = 132033.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 132033.81 ≤ Q = 132033.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 132033.81 ≤ Q = 132033.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 132033.81 ≤ Q = 132033.81 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 132033.81 ≤ Q = 132033.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 132033.81 ≤ Q = 132033.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 132033.81 ≤ Q = 132033.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 132033.81 ≤ Q = 132033.81 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 19] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x759c73d1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x759c73d1
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [3e-13, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.381674e+13
Presolve removed 2625 rows and 1918 columns
Presolve time: 0.01s
Presolved: 468 rows, 471 columns, 1319 nonzeros
Found heuristic solution: objective 6521266.3333
Variable types: 319 continuous, 152 integer (152 binary)

Root relaxation: objective -1.346605e+05, 236 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -134660.53    0  123 6521266.33 -134660.53   102%     -    0s
H    0     0                    -103221.6347 -134660.53  30.5%     -    0s
H    0     0                    -103817.5193 -134660.53  29.7%     -    0s
     0     0 -110748.28    0   80 -103817.52 -110748.28  6.68%     -    0s
H    0     0                    -106776.4628 -110615.55  3.60%     -    0s
H    0     0                    -108025.0167 -110615.55  2.40%     -    0s
     0     0 -109574.69    0   79 -108025.02 -109574.69  1.43%     -    0s
     0     0 -109533.25    0   79 -108025.02 -109533.25  1.40%     -    0s
     0     0 -109220.43    0   74 -108025.02 -109220.43  1.11%     -    0s
     0     0 -109212.45    0   74 -108025.02 -109212.45  1.10%     -    0s
     0     0 -109102.05    0   74 -108025.02 -109102.05  1.00%     -    0s
     0     0 -109077.78    0   74 -108025.02 -109077.78  0.97%     -    0s
     0     2 -109077.78    0   74 -108025.02 -109077.78  0.97%     -    0s
H   39    29                    -108054.1123 -108635.69  0.54%  15.8    0s
H  100    97                    -108095.7465 -108533.63  0.41%  12.9    0s
*  311   149              14    -108097.4041 -108417.61  0.30%   7.4    0s
*  460   148              14    -108101.1859 -108417.61  0.29%   6.7    0s
*  516   148              17    -108102.8171 -108417.61  0.29%   6.5    0s
H  676   175                    -108111.1494 -108417.61  0.28%   6.4    0s
*  835   153              17    -108127.0605 -108417.61  0.27%   6.3    0s
* 1325    46              14    -108133.4336 -108248.90  0.11%   6.0    0s
* 1328    46              16    -108139.0383 -108248.90  0.10%   6.0    0s
* 1367    46              16    -108142.8200 -108248.90  0.10%   5.9    0s

Cutting planes:
  Gomory: 50
  Implied bound: 3
  MIR: 155
  RLT: 3
  BQP: 2

Explored 1498 nodes (9236 simplex iterations) in 0.20 seconds (0.09 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -108143 -108139 -108133 ... -108054
No other solutions better than -108143

Optimal solution found (tolerance 1.00e-04)
Best objective -1.081428200278e+05, best bound -1.081428200278e+05, gap 0.0000%
  Subproblem solved in 0.24s
  Worst-case operational profit (Z_SP) = 129660.95
  Scenario: 11 demand increases, 49 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -108142.82
  [DEBUG]   S×d_nominal = 237803.77
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 237803.77 + -108142.82 = 129660.95
  [DEBUG]   Current θ from Master = 132033.81
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2372.86 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -5604.56
  Lower Bound (LB) = -4230.81
  Gap (UB-LB) = 999.1136, Absolute Gap = 999.1136, Relative Gap = 0.309160
  Not converged yet (gap = 999.11 > ε = 200)

  [DEBUG] Adding NEW scenario 19 to Master Problem...
  [DEBUG] New scenario pattern: 11 increases, 49 decreases
    [DEBUG] Scenario 19 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 19 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 19]
    [DEBUG]   - Total constraints in model: 307183
    [DEBUG]   - Total variables in model: 127060
  [DEBUG] Total scenarios in Master: 20
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 20
================================================================================
[Iteration 20] Solving Master Problem...
  Current scenarios in Master: 20
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 307183 rows, 127060 columns and 869899 nonzeros
Model fingerprint: 0x9f9220b8
Variable types: 124801 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 149480 rows and 60680 columns (presolve time = 5s)...
Presolve removed 149480 rows and 60680 columns
Presolve time: 5.90s
Presolved: 157703 rows, 66380 columns, 973059 nonzeros
Variable types: 64121 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -366101.7227
Found heuristic solution: objective -171217.0927

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.78s

Barrier statistics:
 Dense cols : 1129
 AA' NZ     : 4.003e+06
 Factor NZ  : 1.098e+07 (roughly 180 MB of memory)
 Factor Ops : 3.547e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.67594384e+07  2.57680292e+08  8.83e+04 1.65e+01  7.11e+04    10s
   1  -1.31153248e+07  2.29473424e+08  6.28e+04 4.09e+01  5.02e+04    10s
   2  -5.56877230e+06  1.72860577e+08  2.59e+04 5.61e+00  2.19e+04    10s
   3  -8.72136374e+05  1.26616990e+08  1.85e+03 2.35e+00  1.92e+03    10s
   4  -5.34105153e+05  9.15117265e+07  4.05e+02 1.36e+00  6.26e+02    11s
   5  -4.78107714e+05  5.26605787e+07  2.21e+02 6.79e-01  3.35e+02    11s
   6  -4.11224037e+05  3.90944972e+07  8.06e+01 4.71e-01  1.88e+02    11s
   7  -3.42254413e+05  2.88427541e+07  1.81e+01 3.31e-01  1.11e+02    11s
   8  -2.58884959e+05  1.87144382e+07  5.06e+00 2.14e-01  6.81e+01    11s
   9  -1.45759687e+05  6.20736084e+06  8.90e-02 6.60e-02  2.21e+01    11s
  10  -1.18076616e+05  3.11651778e+06  5.71e-02 3.35e-02  1.13e+01    11s
  11  -1.01970131e+05  2.25300882e+06  3.98e-02 2.39e-02  8.19e+00    11s
  12  -8.92442906e+04  1.75669663e+06  2.87e-02 1.86e-02  6.42e+00    12s
  13  -6.00157158e+04  1.19580865e+06  1.08e-02 1.24e-02  4.37e+00    12s
  14  -4.04685148e+04  2.89855583e+05  4.77e-03 3.19e-03  1.15e+00    12s
  15  -2.80989034e+04  1.58158914e+05  3.36e-03 1.67e-03  6.48e-01    12s
  16  -1.53222128e+04  1.16310346e+05  2.19e-03 1.21e-03  4.58e-01    12s
  17  -8.97200074e+03  9.23476140e+04  1.69e-03 9.42e-04  3.52e-01    12s
  18  -4.61459146e+03  6.95731309e+04  1.37e-03 6.68e-04  2.58e-01    13s
  19  -1.09071280e+02  5.53599448e+04  1.06e-03 4.83e-04  1.93e-01    13s
  20   2.85395059e+03  4.46755471e+04  8.62e-04 3.55e-04  1.45e-01    13s
  21   5.87414619e+03  3.73916161e+04  6.79e-04 2.56e-04  1.10e-01    13s
  22   7.69086489e+03  3.21850533e+04  5.74e-04 1.84e-04  8.52e-02    13s
  23   1.08586587e+04  3.13177092e+04  4.01e-04 1.73e-04  7.11e-02    14s
  24   1.26658334e+04  2.69501073e+04  3.06e-04 1.11e-04  4.97e-02    14s
  25   1.43895685e+04  2.49290820e+04  2.20e-04 8.22e-05  3.66e-02    14s
  26   1.59366196e+04  2.32149684e+04  1.47e-04 5.66e-05  2.53e-02    14s
  27   1.68434803e+04  2.17282512e+04  1.07e-04 3.43e-05  1.70e-02    14s
  28   1.76003312e+04  2.10515614e+04  7.59e-05 2.36e-05  1.20e-02    15s
  29   1.77669334e+04  2.07130863e+04  6.92e-05 1.84e-05  1.02e-02    15s
  30   1.81552653e+04  2.03781314e+04  5.24e-05 1.31e-05  7.73e-03    15s
  31   1.84852716e+04  1.99243774e+04  3.90e-05 6.16e-06  5.00e-03    15s
  32   1.87777958e+04  1.98516915e+04  2.72e-05 5.05e-06  3.73e-03    15s
  33   1.89522641e+04  1.97554567e+04  2.03e-05 3.56e-06  2.79e-03    16s
  34   1.90945622e+04  1.96559155e+04  1.47e-05 2.22e-06  1.95e-03    16s
  35   1.92874251e+04  1.96092433e+04  7.23e-06 1.58e-06  1.12e-03    16s
  36   1.93460495e+04  1.95618015e+04  5.10e-06 1.03e-06  7.50e-04    16s
  37   1.94150896e+04  1.95407163e+04  2.64e-06 9.15e-07  4.37e-04    16s
  38   1.94242820e+04  1.95378114e+04  2.31e-06 8.59e-07  3.95e-04    16s
  39   1.94516405e+04  1.95194220e+04  1.41e-06 4.91e-07  2.36e-04    17s
  40   1.94735815e+04  1.95128626e+04  6.55e-07 3.85e-07  1.37e-04    17s
  41   1.94759204e+04  1.95027582e+04  5.77e-07 1.72e-07  9.33e-05    17s
  42   1.94779740e+04  1.95012565e+04  5.10e-07 1.43e-07  8.10e-05    17s
  43   1.94807003e+04  1.94985590e+04  4.20e-07 8.10e-08  6.21e-05    17s
  44   1.94847580e+04  1.94969747e+04  2.91e-07 6.17e-08  4.25e-05    18s
  45   1.94935383e+04  1.94950661e+04  2.79e-08 2.49e-08  5.31e-06    18s
  46   1.94935778e+04  1.94950465e+04  2.03e-07 2.07e-08  5.11e-06    18s
  47   1.94937727e+04  1.94949964e+04  4.97e-07 2.24e-08  4.26e-06    18s
  48   1.94941993e+04  1.94946208e+04  2.28e-07 7.63e-08  1.47e-06    19s
  49   1.94945624e+04  1.94945633e+04  1.89e-09 7.97e-10  3.03e-09    19s
  50   1.94945630e+04  1.94945632e+04  6.25e-08 5.16e-10  5.47e-10    19s

Barrier solved model in 50 iterations and 18.91 seconds (16.53 work units)
Optimal objective 1.94945630e+04


Root crossover log...

  140271 DPushes remaining with DInf 0.0000000e+00                19s
   65284 DPushes remaining with DInf 0.0000000e+00                20s
    8015 DPushes remaining with DInf 0.0000000e+00                25s
       0 DPushes remaining with DInf 0.0000000e+00                27s

   11617 PPushes remaining with PInf 8.2342645e-05                27s
       0 PPushes remaining with PInf 0.0000000e+00                30s

  Push phase complete: Pinf 0.0000000e+00, Dinf 4.4004004e+02     30s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   79456    1.9494563e+04   0.000000e+00   4.400400e+02     30s
   79551    1.9494563e+04   0.000000e+00   0.000000e+00     30s
   79551    1.9494563e+04   0.000000e+00   0.000000e+00     30s
Concurrent spin time: 10.69s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 1.949456e+04, 79551 iterations, 33.43 seconds (31.67 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 19494.5632    0  160 -171217.09 19494.5632   111%     -   41s
H    0     0                    -154791.6190 19494.5632   113%     -   42s
H    0     0                    -154408.1903 19494.5632   113%     -   43s
H    0     0                    -152342.2973 19494.5632   113%     -   44s
H    0     0                    -151564.1049 19494.5632   113%     -   44s
H    0     0                    -151530.9559 19494.5632   113%     -   44s
H    0     0                    -151398.9171 19494.5632   113%     -   44s
H    0     0                    -70950.02117 19494.5632   127%     -   44s
H    0     0                    -15371.94313 19494.5632   227%     -   45s
H    0     0                    -13645.11298 19494.5632   243%     -   45s
H    0     0                    -13484.49359 19494.5632   245%     -   45s
H    0     0                    -12644.22573 19494.5632   254%     -   45s
     0     0 15285.3292    0  284 -12644.226 15285.3292   221%     -  156s
H    0     0                    -12246.29205 15285.3276   225%     -  158s
H    0     0                    -11333.24179 15285.3276   235%     -  158s
H    0     0                    -10364.49171 15285.3276   247%     -  158s
H    0     0                    -10146.39930 15285.3276   251%     -  158s
     0     0 14603.1161    0  297 -10146.399 14603.1161   244%     -  229s
     0     0 14596.5113    0  293 -10146.399 14596.5113   244%     -  239s
     0     0 14584.2845    0  292 -10146.399 14584.2845   244%     -  243s
     0     0 14582.8274    0  293 -10146.399 14582.8274   244%     -  245s
     0     0 14582.7911    0  293 -10146.399 14582.7911   244%     -  246s
     0     0 11933.9645    0  279 -10146.399 11933.9645   218%     -  348s
     0     0 11444.4202    0  299 -10146.399 11444.4202   213%     -  446s
     0     0 11390.2584    0  418 -10146.399 11390.2584   212%     -  502s
     0     0 11238.4810    0  422 -10146.399 11238.4810   211%     -  549s
     0     0 11113.7862    0  426 -10146.399 11113.7862   210%     -  588s
     0     0 11057.7562    0  420 -10146.399 11057.7562   209%     -  622s
     0     0 11013.1372    0  459 -10146.399 11013.1372   209%     -  645s
     0     0 10951.0678    0  425 -10146.399 10951.0678   208%     -  687s
     0     0 10912.7317    0  419 -10146.399 10912.7317   208%     -  707s
     0     0 10908.4892    0  426 -10146.399 10908.4892   208%     -  717s
     0     0 10902.1058    0  354 -10146.399 10902.1058   207%     -  724s
     0     0 10901.5248    0  354 -10146.399 10901.5248   207%     -  727s
     0     0 9853.09141    0  379 -10146.399 9853.09141   197%     -  841s
H    0     0                    -10111.24384 9853.05734   197%     -  842s
H    0     0                    -9841.824860 9853.05734   200%     -  842s
H    0     0                    -9824.622139 9853.05734   200%     -  842s
     0     0 9581.32538    0  387 -9824.6221 9581.32538   198%     -  908s
     0     0 9412.90145    0  401 -9824.6221 9412.90145   196%     -  948s
     0     0 9319.99190    0  351 -9824.6221 9319.99190   195%     -  983s
     0     0 9290.19480    0  401 -9824.6221 9290.19480   195%     - 1003s
     0     0 9202.23388    0  391 -9824.6221 9202.23388   194%     - 1033s
     0     0 9178.53284    0  399 -9824.6221 9178.53284   193%     - 1050s
     0     0 9154.19565    0  350 -9824.6221 9154.19565   193%     - 1067s
     0     0 9112.41078    0  399 -9824.6221 9112.41078   193%     - 1089s
     0     0 9099.29050    0  404 -9824.6221 9099.29050   193%     - 1102s
     0     0 9094.79031    0  402 -9824.6221 9094.79031   193%     - 1109s
     0     0 9088.49245    0  407 -9824.6221 9088.49245   193%     - 1120s
     0     0 9058.61802    0  394 -9824.6221 9058.61802   192%     - 1143s
     0     0 9034.65745    0  398 -9824.6221 9034.65745   192%     - 1158s
     0     0 9019.14282    0  399 -9824.6221 9019.14282   192%     - 1176s
     0     0 8995.31858    0  403 -9824.6221 8995.31858   192%     - 1199s
     0     0 8983.67546    0  396 -9824.6221 8983.67546   191%     - 1208s
     0     0 8980.87071    0  395 -9824.6221 8980.87071   191%     - 1213s
     0     0 8979.31626    0  398 -9824.6221 8979.31626   191%     - 1218s
     0     0 8943.89670    0  396 -9824.6221 8943.89670   191%     - 1237s
     0     0 8891.98207    0  395 -9824.6221 8891.98207   191%     - 1261s
     0     0 8880.95104    0  387 -9824.6221 8880.95104   190%     - 1269s
     0     0 8863.71514    0  394 -9824.6221 8863.71514   190%     - 1278s
     0     0 8861.70771    0  397 -9824.6221 8861.70771   190%     - 1282s
     0     0 8861.30958    0  398 -9824.6221 8861.30958   190%     - 1287s
     0     0 8199.88435    0  424 -9824.6221 8199.88435   183%     - 1389s
     0     0 7935.26061    0  421 -9824.6221 7935.26061   181%     - 1440s
     0     0 7859.49054    0  418 -9824.6221 7859.49054   180%     - 1465s
     0     0 7821.93534    0  431 -9824.6221 7821.93534   180%     - 1483s
     0     0 7780.89758    0  449 -9824.6221 7780.89758   179%     - 1512s
     0     0 7772.22159    0  446 -9824.6221 7772.22159   179%     - 1519s
     0     0 7759.59840    0  442 -9824.6221 7759.59840   179%     - 1529s
     0     0 7742.73610    0  451 -9824.6221 7742.73610   179%     - 1540s
     0     0 7741.20908    0  454 -9824.6221 7741.20908   179%     - 1544s
     0     0 7737.06988    0  449 -9824.6221 7737.06988   179%     - 1549s
     0     0 7733.33448    0  452 -9824.6221 7733.33448   179%     - 1555s
     0     0 7688.44639    0  438 -9824.6221 7688.44639   178%     - 1568s
     0     0 7679.64607    0  448 -9824.6221 7679.64607   178%     - 1574s
     0     0 7677.63079    0  447 -9824.6221 7677.63079   178%     - 1577s
     0     0 7674.03735    0  446 -9824.6221 7674.03735   178%     - 1582s
     0     0 7673.45234    0  442 -9824.6221 7673.45234   178%     - 1585s
     0     0 7570.52045    0  431 -9824.6221 7570.52045   177%     - 1609s
     0     0 7523.69029    0  448 -9824.6221 7523.69029   177%     - 1627s
     0     0 7489.33959    0  441 -9824.6221 7489.33959   176%     - 1645s
     0     0 7482.71033    0  455 -9824.6221 7482.71033   176%     - 1653s
     0     0 7480.62454    0  448 -9824.6221 7480.62454   176%     - 1658s
     0     0 7479.72951    0  450 -9824.6221 7479.72951   176%     - 1661s
     0     0 7427.19747    0  448 -9824.6221 7427.19747   176%     - 1689s
H    0     0                    -9314.510926 7427.01225   180%     - 1712s
H    0     0                    -7788.158508 7427.01225   195%     - 1713s
H    0     0                    -7524.176432 7427.01225   199%     - 1713s
H    0     0                    -7473.460716 7427.01225   199%     - 1715s
H    0     0                    -7403.054587 7427.01225   200%     - 1715s
H    0     0                    -7374.968707 7427.01225   201%     - 1715s
     0     0 7376.07982    0  456 -7374.9687 7376.07982   200%     - 1737s
     0     0 7361.02245    0  494 -7374.9687 7361.02245   200%     - 1757s
     0     0 7359.68897    0  501 -7374.9687 7359.68897   200%     - 1763s
     0     0 7345.18904    0  458 -7374.9687 7345.18904   200%     - 1780s
     0     0 7333.06431    0  449 -7374.9687 7333.06431   199%     - 1793s
     0     0 7326.18184    0  448 -7374.9687 7326.18184   199%     - 1801s
     0     0 7322.56821    0  455 -7374.9687 7322.56821   199%     - 1806s
     0     0 7321.37931    0  499 -7374.9687 7321.37931   199%     - 1813s
     0     0 7249.43710    0  475 -7374.9687 7249.43710   198%     - 1841s
H    0     0                    -7337.023891 7249.07266   199%     - 1867s
H    0     0                    -7133.574408 7249.07266   202%     - 1868s
H    0     0                    -7001.269321 7249.07266   204%     - 1869s
H    0     0                    -6771.415053 7249.07266   207%     - 1870s
     0     0 7239.69353    0  462 -6771.4151 7239.69353   207%     - 1881s
     0     0 7234.75322    0  473 -6771.4151 7234.75322   207%     - 1892s
     0     0 7232.98977    0  474 -6771.4151 7232.98977   207%     - 1896s
     0     0 7228.94808    0  477 -6771.4151 7228.94808   207%     - 1902s
     0     0 7227.80122    0  475 -6771.4151 7227.80122   207%     - 1906s
     0     0 7196.55651    0  443 -6771.4151 7196.55651   206%     - 1931s
     0     0 7187.40724    0  463 -6771.4151 7187.40724   206%     - 1954s
     0     0 7184.12269    0  458 -6771.4151 7184.12269   206%     - 1961s
     0     0 7182.87295    0  457 -6771.4151 7182.87295   206%     - 1968s
     0     0 7168.88375    0  453 -6771.4151 7168.88375   206%     - 1986s
H    0     0                    -6737.459753 7168.87415   206%     - 2023s
H    0     0                    -6612.264015 7168.87415   208%     - 2023s
H    0     0                    -6496.645192 7168.87415   210%     - 2030s
H    0     0                    -6269.380766 7168.87415   214%     - 2030s
H    0     0                    -6186.892638 7168.87415   216%     - 2032s
     0     0 7167.77447    0  455 -6186.8926 7167.77447   216%     - 2037s
     0     0 7165.19189    0  451 -6186.8926 7165.19189   216%     - 2048s
     0     0 7164.57231    0  456 -6186.8926 7164.57231   216%     - 2055s
     0     0 7161.33416    0  487 -6186.8926 7161.33416   216%     - 2066s
     0     0 7160.14295    0  487 -6186.8926 7160.14295   216%     - 2072s
     0     0 7157.93753    0  458 -6186.8926 7157.93753   216%     - 2082s
     0     0 7157.89132    0  458 -6186.8926 7157.89132   216%     - 2092s
H    0     0                    -6131.014318 7157.89132   217%     - 2277s
     0     2 7157.89132    0  458 -6131.0143 7157.89132   217%     - 2432s
     1     3 6291.79787    1  368 -6131.0143 7157.21126   217% 19724 2490s
     2     4 7073.85241    1  448 -6131.0143 7073.85241   215% 13457 2510s
     3     5 5536.91746    2  442 -6131.0143 7071.83973   215% 15111 2547s
     4     9 6879.34747    2  462 -6131.0143 7068.01115   215% 14177 2586s
     8    16 6690.47870    3  484 -6131.0143 6878.94374   212% 14088 2676s
    15    31 6628.99976    4  484 -6131.0143 6878.94374   212% 16443 2745s
    30    44 5871.42004    4  453 -6131.0143 6690.38797   209% 23583 2882s
    45    73 5491.29691    5  370 -6131.0143 6628.97374   208% 28246 3206s
H   48    73                    -3447.667757 6628.97374   292% 27363 3206s
    74   153 5448.59407    6  365 -3447.6678 6628.97374   292% 23501 3367s
   157   246 5321.34466    8  427 -3447.6678 6628.97374   292% 17348 3454s
   254   307 5273.58044   10  418 -3447.6678 6628.97374   292% 13400 3514s
   326   340 4892.71569   12  354 -3447.6678 6628.97374   292% 12171 3566s
   377   372 3255.55170   15  359 -3447.6678 6628.97374   292% 12134 3600s

Cutting planes:
  Learned: 3
  Gomory: 1
  Implied bound: 97
  MIR: 2154
  Flow cover: 2775
  RLT: 38
  Relax-and-lift: 305

Explored 423 nodes (6042203 simplex iterations) in 3600.10 seconds (4833.95 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -3447.67 -6131.01 -6186.89 ... -7133.57

Time limit reached
Best objective -3.447667757398e+03, best bound 6.628973738628e+03, gap 292.2741%
  WARNING: Time limit reached. Using best solution found (gap: 292.27%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.13s
  Master Objective (UB) = -3447.67, θ = 129519.19
  Upper Bound (UB) = -3447.67

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 129519.19
  [DEBUG]   ✓ Scenario 0: θ = 129519.19 ≤ Q = 129519.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 129519.19 ≤ Q = 129519.19 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 129519.19 ≤ Q = 129519.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 129519.19 ≤ Q = 129519.19 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 129519.19 ≤ Q = 129519.19 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 129519.19 ≤ Q = 129519.19 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 129519.19 ≤ Q = 129519.19 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 129519.19 ≤ Q = 129519.19 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 129519.19 ≤ Q = 129519.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 129519.19 ≤ Q = 129519.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 129519.19 ≤ Q = 129519.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 129519.19 ≤ Q = 129519.19 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 129519.19 ≤ Q = 129519.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 129519.19 ≤ Q = 129519.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 129519.19 ≤ Q = 129519.19 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 129519.19 ≤ Q = 129519.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 129519.19 ≤ Q = 129519.19 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 129519.19 ≤ Q = 129519.19 (slack: 0.00)
  [DEBUG]   ✓ Scenario 18: θ = 129519.19 ≤ Q = 129519.19 (slack: 0.00)
  [DEBUG]   ✓ Scenario 19: θ = 129519.19 ≤ Q = 129519.19 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 20] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x1c953db0
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x1c953db0
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.374669e+13
Presolve removed 2638 rows and 1929 columns
Presolve time: 0.01s
Presolved: 455 rows, 460 columns, 1284 nonzeros
Found heuristic solution: objective 6349875.2546
Variable types: 310 continuous, 150 integer (150 binary)
Found heuristic solution: objective 6349214.6107

Root relaxation: objective -1.381245e+05, 240 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -138124.52    0  126 6349214.61 -138124.52   102%     -    0s
H    0     0                    -110263.5136 -138124.52  25.3%     -    0s
H    0     0                    -110882.8043 -138124.52  24.6%     -    0s
H    0     0                    -125225.2820 -138124.52  10.3%     -    0s
     0     0 -129083.71    0   82 -125225.28 -129083.71  3.08%     -    0s
H    0     0                    -126816.1134 -128963.31  1.69%     -    0s
     0     0 -128510.72    0   81 -126816.11 -128510.72  1.34%     -    0s
     0     0 -127801.48    0   41 -126816.11 -127801.48  0.78%     -    0s
H    0     0                    -127277.1984 -127801.48  0.41%     -    0s
H    0     0                    -127298.6671 -127668.13  0.29%     -    0s
     0     0 -127668.13    0   21 -127298.67 -127668.13  0.29%     -    0s
     0     0 -127640.92    0   31 -127298.67 -127640.92  0.27%     -    0s
     0     0 -127610.53    0   37 -127298.67 -127610.53  0.24%     -    0s
     0     0 -127608.11    0   37 -127298.67 -127608.11  0.24%     -    0s
     0     0 -127382.57    0   10 -127298.67 -127382.57  0.07%     -    0s
     0     0 -127360.03    0    9 -127298.67 -127360.03  0.05%     -    0s
     0     0 -127330.55    0    6 -127298.67 -127330.55  0.03%     -    0s
     0     0 -127323.51    0    2 -127298.67 -127323.51  0.02%     -    0s
H    0     0                    -127304.0947 -127323.51  0.02%     -    0s
H    0     0                    -127320.0987 -127323.51  0.00%     -    0s

Explored 1 nodes (656 simplex iterations) in 0.27 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -127320 -127304 -127299 ... 6.34921e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.273200986713e+05, best bound -1.273235123532e+05, gap 0.0027%
  Subproblem solved in 0.30s
  Worst-case operational profit (Z_SP) = 111363.33
  Scenario: 41 demand increases, 19 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -127320.10
  [DEBUG]   S×d_nominal = 238683.43
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 238683.43 + -127320.10 = 111363.33
  [DEBUG]   Current θ from Master = 129519.19
  [DEBUG]   ⚠️  Z_SP ≤ θ by 18155.86 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -21603.53
  Lower Bound (LB) = -4230.81
  Gap (UB-LB) = 783.1455, Absolute Gap = 783.1455, Relative Gap = 0.227152
  Not converged yet (gap = 783.15 > ε = 200)

  [DEBUG] Adding NEW scenario 20 to Master Problem...
  [DEBUG] New scenario pattern: 41 increases, 19 decreases
    [DEBUG] Scenario 20 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 20 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 20]
    [DEBUG]   - Total constraints in model: 322473
    [DEBUG]   - Total variables in model: 133300
  [DEBUG] Total scenarios in Master: 21
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 21
================================================================================
[Iteration 21] Solving Master Problem...
  Current scenarios in Master: 21
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 322473 rows, 133300 columns and 913118 nonzeros
Model fingerprint: 0xb42b247d
Variable types: 131041 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 156954 rows and 63714 columns (presolve time = 5s)...
Presolve removed 156954 rows and 63714 columns
Presolve time: 6.31s
Presolved: 165519 rows, 69586 columns, 1020487 nonzeros
Variable types: 67327 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -366101.7227
Found heuristic solution: objective -171217.0927

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.87s

Barrier statistics:
 Dense cols : 1125
 AA' NZ     : 4.340e+06
 Factor NZ  : 1.187e+07 (roughly 200 MB of memory)
 Factor Ops : 3.860e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.70957759e+07  2.69127185e+08  9.03e+04 1.59e+01  7.22e+04    10s
   1  -1.33709740e+07  2.40091776e+08  6.41e+04 4.04e+01  5.09e+04    11s
   2  -5.47882601e+06  1.81142080e+08  2.54e+04 5.71e+00  2.14e+04    11s
   3  -8.92317687e+05  1.35618882e+08  1.92e+03 2.21e+00  1.98e+03    11s
   4  -5.58250856e+05  9.24188400e+07  4.93e+02 1.21e+00  6.76e+02    11s
   5  -4.85142800e+05  5.51264432e+07  2.60e+02 5.85e-01  3.59e+02    11s
   6  -4.20193972e+05  4.05792527e+07  9.63e+01 4.02e-01  1.96e+02    11s
   7  -3.62372998e+05  2.99694080e+07  3.45e+01 2.82e-01  1.20e+02    11s
   8  -3.01152071e+05  2.11109185e+07  1.09e+01 1.92e-01  7.59e+01    11s
   9  -1.88850700e+05  1.08785377e+07  1.27e+00 9.40e-02  3.70e+01    12s
  10  -1.55900372e+05  3.80320407e+06  9.28e-01 3.25e-02  1.32e+01    12s
  11  -1.09509036e+05  2.63342192e+06  4.81e-01 2.23e-02  9.13e+00    12s
  12  -9.50255607e+04  1.71143656e+06  3.41e-01 1.44e-02  6.00e+00    12s
  13  -8.19681296e+04  1.24444178e+06  2.55e-01 1.04e-02  4.41e+00    12s
  14  -4.43961871e+04  5.57872908e+05  6.56e-02 4.37e-03  2.00e+00    12s
  15  -2.92837240e+04  2.23479288e+05  3.92e-02 1.72e-03  8.38e-01    12s
  16  -1.78890829e+04  1.13640578e+05  2.57e-02 1.34e-03  4.36e-01    13s
  17  -9.93781408e+03  8.16514102e+04  1.95e-02 8.82e-04  3.04e-01    13s
  18  -7.41204454e+03  6.66411725e+04  1.75e-02 6.74e-04  2.46e-01    13s
  19  -2.84463069e+03  5.83103487e+04  1.41e-02 5.55e-04  2.03e-01    13s
  20  -3.89220888e+01  5.23742811e+04  1.19e-02 5.26e-04  1.74e-01    13s
  21   4.10237406e+03  3.97819664e+04  8.79e-03 3.41e-04  1.18e-01    14s
  22   6.96750772e+03  3.49845002e+04  6.82e-03 5.47e-04  9.29e-02    14s
  23   7.98971332e+03  3.06181657e+04  6.17e-03 4.03e-04  7.50e-02    14s
  24   1.18412517e+04  2.72341001e+04  3.85e-03 2.67e-04  5.10e-02    14s
  25   1.36257380e+04  2.47968867e+04  2.86e-03 1.84e-04  3.70e-02    14s
  26   1.48963361e+04  2.28164811e+04  2.19e-03 1.20e-04  2.63e-02    14s
  27   1.55658512e+04  2.19934187e+04  1.85e-03 9.33e-05  2.13e-02    15s
  28   1.67426040e+04  2.13794972e+04  1.27e-03 6.95e-05  1.54e-02    15s
  29   1.72235128e+04  2.07595866e+04  1.04e-03 4.65e-05  1.17e-02    15s
  30   1.74245012e+04  2.02868101e+04  9.48e-04 2.92e-05  9.49e-03    15s
  31   1.81973736e+04  2.00116438e+04  5.87e-04 1.85e-05  6.02e-03    15s
  32   1.85415688e+04  1.98107589e+04  4.32e-04 1.10e-05  4.21e-03    16s
  33   1.87458683e+04  1.97581117e+04  3.37e-04 9.07e-06  3.36e-03    16s
  34   1.89430255e+04  1.97123842e+04  2.44e-04 7.50e-06  2.55e-03    16s
  35   1.90048617e+04  1.96606900e+04  2.18e-04 5.73e-06  2.18e-03    16s
  36   1.90150219e+04  1.96271400e+04  2.13e-04 4.57e-06  2.03e-03    16s
  37   1.91360556e+04  1.95748234e+04  1.59e-04 2.70e-06  1.46e-03    17s
  38   1.92088050e+04  1.95621887e+04  1.27e-04 2.25e-06  1.17e-03    17s
  39   1.93421072e+04  1.95526594e+04  6.81e-05 1.92e-06  6.98e-04    17s
  40   1.94218506e+04  1.95178642e+04  3.14e-05 8.25e-07  3.18e-04    17s
  41   1.94298499e+04  1.95067692e+04  2.78e-05 8.67e-07  2.55e-04    18s
  42   1.94385879e+04  1.95011912e+04  2.40e-05 1.66e-06  2.08e-04    18s
  43   1.94683208e+04  1.94977127e+04  1.08e-05 6.69e-07  9.75e-05    18s
  44   1.94720840e+04  1.94971465e+04  9.21e-06 5.60e-07  8.31e-05    18s
  45   1.94813400e+04  1.94964839e+04  5.32e-06 4.16e-07  5.02e-05    18s
  46   1.94873874e+04  1.94962976e+04  2.82e-06 3.80e-07  2.96e-05    18s
  47   1.94945152e+04  1.94946525e+04  1.19e-08 3.50e-07  4.55e-07    18s
  48   1.94945631e+04  1.94945633e+04  2.31e-10 1.24e-09  4.56e-10    19s

Barrier solved model in 48 iterations and 18.60 seconds (16.37 work units)
Optimal objective 1.94945631e+04


Root crossover log...

  147139 DPushes remaining with DInf 0.0000000e+00                19s
   62504 DPushes remaining with DInf 0.0000000e+00                20s
    5147 DPushes remaining with DInf 0.0000000e+00                25s
       0 DPushes remaining with DInf 0.0000000e+00                27s

    4648 PPushes remaining with PInf 4.5142298e-05                27s
       0 PPushes remaining with PInf 0.0000000e+00                28s

  Push phase complete: Pinf 0.0000000e+00, Dinf 9.7731096e+02     28s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   70068    1.9494563e+04   0.000000e+00   9.773110e+02     28s
   70383    1.9494563e+04   0.000000e+00   0.000000e+00     29s
   70383    1.9494563e+04   0.000000e+00   0.000000e+00     29s
Concurrent spin time: 6.28s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 1.949456e+04, 70383 iterations, 27.70 seconds (30.03 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 19494.5632    0  160 -171217.09 19494.5632   111%     -   36s
H    0     0                    -70950.02117 19494.5632   127%     -   38s
H    0     0                    -48789.40681 19494.5632   140%     -   38s
H    0     0                    -30806.00898 19494.5632   163%     -   38s
H    0     0                    -20824.12308 19494.5632   194%     -   38s
H    0     0                    -20766.26709 19494.5632   194%     -   38s
H    0     0                    -18690.56444 19494.5632   204%     -   39s
H    0     0                    -18632.70844 19494.5632   205%     -   39s
H    0     0                    -12734.26016 19494.5632   253%     -   39s
H    0     0                    -12644.22573 19494.5632   254%     -   39s
     0     0 15154.9374    0  282 -12644.226 15154.9374   220%     -  189s
H    0     0                    -12472.95887 15154.8242   222%     -  191s
H    0     0                    -9642.468965 15154.8242   257%     -  191s
H    0     0                    -8820.663964 15154.8242   272%     -  191s
     0     0 14476.8967    0  291 -8820.6640 14476.8967   264%     -  282s
     0     0 14453.1230    0  290 -8820.6640 14453.1230   264%     -  295s
     0     0 14452.2525    0  290 -8820.6640 14452.2525   264%     -  297s
     0     0 14451.6907    0  290 -8820.6640 14451.6907   264%     -  298s
     0     0 14451.6732    0  292 -8820.6640 14451.6732   264%     -  299s
     0     0 11979.8972    0  335 -8820.6640 11979.8972   236%     -  455s
     0     0 11528.5391    0  424 -8820.6640 11528.5391   231%     -  520s
     0     0 11387.9878    0  382 -8820.6640 11387.9878   229%     -  584s
     0     0 11288.1967    0  423 -8820.6640 11288.1967   228%     -  626s
     0     0 11165.2674    0  425 -8820.6640 11165.2674   227%     -  650s
     0     0 11112.9531    0  357 -8820.6640 11112.9531   226%     -  672s
     0     0 11073.7570    0  433 -8820.6640 11073.7570   226%     -  689s
     0     0 11067.3205    0  433 -8820.6640 11067.3205   225%     -  701s
     0     0 11059.9946    0  429 -8820.6640 11059.9946   225%     -  707s
     0     0 10975.8285    0  427 -8820.6640 10975.8285   224%     -  739s
     0     0 10958.8651    0  438 -8820.6640 10958.8651   224%     -  758s
     0     0 10942.5564    0  441 -8820.6640 10942.5564   224%     -  771s
     0     0 10926.7358    0  438 -8820.6640 10926.7358   224%     -  782s
     0     0 10918.1804    0  438 -8820.6640 10918.1804   224%     -  788s
     0     0 10909.6779    0  430 -8820.6640 10909.6779   224%     -  801s
     0     0 10907.0436    0  438 -8820.6640 10907.0436   224%     -  803s
     0     0 10896.8222    0  438 -8820.6640 10896.8222   224%     -  812s
     0     0 10893.0015    0  440 -8820.6640 10893.0015   223%     -  819s
     0     0 10892.7817    0  440 -8820.6640 10892.7817   223%     -  820s
     0     0 9395.38557    0  397 -8820.6640 9395.38557   207%     -  948s
     0     0 9008.01867    0  387 -8820.6640 9008.01867   202%     - 1015s
     0     0 8763.92876    0  406 -8820.6640 8763.92876   199%     - 1064s
     0     0 8738.15822    0  402 -8820.6640 8738.15822   199%     - 1083s
     0     0 8713.78446    0  405 -8820.6640 8713.78446   199%     - 1100s
     0     0 8708.32984    0  406 -8820.6640 8708.32984   199%     - 1113s
     0     0 8705.63192    0  409 -8820.6640 8705.63192   199%     - 1120s
     0     0 8705.38901    0  411 -8820.6640 8705.38901   199%     - 1122s
     0     0 8015.59513    0  461 -8820.6640 8015.59513   191%     - 1213s
     0     0 7825.40431    0  467 -8820.6640 7825.40431   189%     - 1262s
     0     0 7734.82554    0  463 -8820.6640 7734.82554   188%     - 1302s
     0     0 7708.63881    0  473 -8820.6640 7708.63881   187%     - 1324s
     0     0 7672.84601    0  460 -8820.6640 7672.84601   187%     - 1341s
     0     0 7658.43108    0  469 -8820.6640 7658.43108   187%     - 1359s
     0     0 7646.31298    0  476 -8820.6640 7646.31298   187%     - 1371s
     0     0 7639.92710    0  476 -8820.6640 7639.92710   187%     - 1383s
     0     0 7622.30098    0  541 -8820.6640 7622.30098   186%     - 1394s
     0     0 7615.86978    0  472 -8820.6640 7615.86978   186%     - 1400s
     0     0 7615.40821    0  471 -8820.6640 7615.40821   186%     - 1404s
     0     0 7385.06118    0  438 -8820.6640 7385.06118   184%     - 1447s
     0     0 7359.94333    0  436 -8820.6640 7359.94333   183%     - 1482s
     0     0 7346.19264    0  441 -8820.6640 7346.19264   183%     - 1500s
     0     0 7342.39324    0  443 -8820.6640 7342.39324   183%     - 1509s
     0     0 7329.61845    0  453 -8820.6640 7329.61845   183%     - 1531s
     0     0 7324.53534    0  447 -8820.6640 7324.53534   183%     - 1543s
     0     0 7322.31246    0  455 -8820.6640 7322.31246   183%     - 1550s
     0     0 7317.43376    0  454 -8820.6640 7317.43376   183%     - 1558s
     0     0 7314.76682    0  453 -8820.6640 7314.76682   183%     - 1563s
     0     0 7312.85660    0  454 -8820.6640 7312.85660   183%     - 1566s
     0     0 7312.08104    0  453 -8820.6640 7312.08104   183%     - 1569s
     0     0 7282.73074    0  442 -8820.6640 7282.73074   183%     - 1590s
H    0     0                    -7374.968707 7282.29295   199%     - 1613s
     0     0 7262.07868    0  449 -7374.9687 7262.07868   198%     - 1634s
     0     0 7257.99135    0  453 -7374.9687 7257.99135   198%     - 1643s
     0     0 7254.61120    0  450 -7374.9687 7254.61120   198%     - 1648s
     0     0 7254.05055    0  451 -7374.9687 7254.05055   198%     - 1653s
     0     0 7218.38611    0  450 -7374.9687 7218.38611   198%     - 1677s
     0     0 7206.59442    0  459 -7374.9687 7206.59442   198%     - 1694s
     0     0 7202.89488    0  465 -7374.9687 7202.89488   198%     - 1699s
     0     0 7198.24595    0  461 -7374.9687 7198.24595   198%     - 1708s
     0     0 7196.91265    0  462 -7374.9687 7196.91265   198%     - 1712s
     0     0 7159.07638    0  483 -7374.9687 7159.07638   197%     - 1740s
H    0     0                    -7253.846863 7159.01616   199%     - 1771s
     0     0 7146.26645    0  476 -7253.8469 7146.26645   199%     - 1788s
     0     0 7141.66351    0  479 -7253.8469 7141.66351   198%     - 1797s
     0     0 7132.81303    0  477 -7253.8469 7132.81303   198%     - 1810s
     0     0 7130.05225    0  481 -7253.8469 7130.05225   198%     - 1818s
     0     0 7124.89801    0  475 -7253.8469 7124.89801   198%     - 1829s
     0     0 7121.53077    0  474 -7253.8469 7121.53077   198%     - 1837s
     0     0 7117.45525    0  470 -7253.8469 7117.45525   198%     - 1844s
     0     0 7116.25863    0  477 -7253.8469 7116.25863   198%     - 1850s
     0     0 7103.79907    0  494 -7253.8469 7103.79907   198%     - 1865s
     0     0 7100.46298    0  608 -7253.8469 7100.46298   198%     - 1877s
     0     0 7096.37854    0  599 -7253.8469 7096.37854   198%     - 1885s
     0     0 7094.24768    0  490 -7253.8469 7094.24768   198%     - 1891s
     0     0 7093.60092    0  492 -7253.8469 7093.60092   198%     - 1895s
     0     0 7076.37145    0  607 -7253.8469 7076.37145   198%     - 1918s
H    0     0                    -6802.141111 7075.57697   204%     - 1955s
     0     0 7073.79015    0  571 -6802.1411 7073.79015   204%     - 1968s
     0     0 7073.27172    0  496 -6802.1411 7073.27172   204%     - 1974s
     0     0 7066.40789    0  562 -6802.1411 7066.40789   204%     - 1993s
     0     0 7064.04780    0  487 -6802.1411 7064.04780   204%     - 2006s
     0     0 7062.97832    0  495 -6802.1411 7062.97832   204%     - 2012s
     0     0 7055.28406    0  456 -6802.1411 7055.28406   204%     - 2028s
     0     0 7052.85726    0  454 -6802.1411 7052.85726   204%     - 2034s
     0     0 7051.12979    0  467 -6802.1411 7051.12979   204%     - 2041s
     0     0 7050.84222    0  461 -6802.1411 7050.84222   204%     - 2043s
     0     0 7036.77360    0  471 -6802.1411 7036.77360   203%     - 2057s
     0     0 7030.89593    0  459 -6802.1411 7030.89593   203%     - 2070s
     0     0 7030.07550    0  456 -6802.1411 7030.07550   203%     - 2073s
     0     0 7004.60306    0  461 -6802.1411 7004.60306   203%     - 2096s
     0     0 7002.07249    0  463 -6802.1411 7002.07249   203%     - 2104s
     0     0 7000.18781    0  469 -6802.1411 7000.18781   203%     - 2109s
     0     0 6999.89489    0  468 -6802.1411 6999.89489   203%     - 2111s
     0     0 6994.67948    0  507 -6802.1411 6994.67948   203%     - 2124s
     0     0 6991.86037    0  473 -6802.1411 6991.86037   203%     - 2131s
     0     0 6990.91766    0  511 -6802.1411 6990.91766   203%     - 2134s
     0     0 6989.32398    0  511 -6802.1411 6989.32398   203%     - 2142s
     0     0 6986.40271    0  471 -6802.1411 6986.40271   203%     - 2151s
     0     0 6985.09503    0  466 -6802.1411 6985.09503   203%     - 2157s
     0     0 6983.06991    0  471 -6802.1411 6983.06991   203%     - 2164s
     0     0 6982.92280    0  471 -6802.1411 6982.92280   203%     - 2175s
H    0     0                    -5113.416491 6981.30032   237%     - 2501s
H    0     0                    -5092.658593 6981.30032   237%     - 2503s
     0     2 6981.30032    0  471 -5092.6586 6981.30032   237%     - 2508s
     1     3 6009.62284    1  432 -5092.6586 6981.30032   237% 20612 2563s
     2     4 6892.71025    1  456 -5092.6586 6892.71025   235% 18032 2595s
     3     6 5574.67758    2  425 -5092.6586 6892.64154   235% 15965 2637s
     5    10 5054.94329    3  272 -5092.6586 6892.64154   235% 16947 2694s
     9    20 4901.67227    4  273 -5092.6586 6669.96332   231% 14676 2747s
    19    40 4677.64116    5  287 -5092.6586 6571.23113   229% 15073 2800s
    39    52 5142.02306    5  493 -5092.6586 6413.51782   226% 24374 2942s
    51    73 4146.01103    6  413 -5092.6586 6413.51782   226% 27905 3054s
H   54    73                    -4622.616963 6413.51782   239% 27073 3054s
    72   120 4946.53402    7  428 -4622.6170 6413.51782   239% 23338 3209s
   119   169 4907.72493    8  420 -4622.6170 6413.51782   239% 17905 3279s
H  138   169                    -4515.769824 6413.51782   242% 16670 3279s
   168   256 4546.31677   10  376 -4515.7698 6413.51782   242% 15794 3369s
   255   318 4126.79386   12  374 -4515.7698 6413.51782   242% 13302 3446s
H  289   318                    -4384.890818 6413.51782   246% 12538 3446s
   317   388 4241.04760   11  365 -4384.8908 6413.51782   246% 12146 3516s
   387   458 4029.77601   13  369 -4384.8908 6413.51782   246% 11088 3579s
   459   484 3236.27760   17  442 -4384.8908 6413.51782   246% 10250 3600s

Cutting planes:
  Learned: 1
  Gomory: 3
  Implied bound: 72
  MIR: 2489
  Flow cover: 3523
  Zero half: 1
  RLT: 47
  Relax-and-lift: 361

Explored 485 nodes (5645298 simplex iterations) in 3600.08 seconds (4623.71 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -4384.89 -4515.77 -4622.62 ... -9642.47

Time limit reached
Best objective -4.384890818047e+03, best bound 6.413517821540e+03, gap 246.2640%
  WARNING: Time limit reached. Using best solution found (gap: 246.26%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.12s
  Master Objective (UB) = -4384.89, θ = 137649.66
  Upper Bound (UB) = -4384.89

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 137649.66
  [DEBUG]   ✓ Scenario 0: θ = 137649.66 ≤ Q = 137649.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 137649.66 ≤ Q = 137649.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 137649.66 ≤ Q = 137649.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 137649.66 ≤ Q = 137649.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 137649.66 ≤ Q = 137649.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 137649.66 ≤ Q = 137649.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 137649.66 ≤ Q = 137649.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 137649.66 ≤ Q = 137649.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 137649.66 ≤ Q = 137649.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 137649.66 ≤ Q = 137649.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 137649.66 ≤ Q = 137649.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 137649.66 ≤ Q = 137649.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 137649.66 ≤ Q = 137649.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 137649.66 ≤ Q = 137649.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 137649.66 ≤ Q = 137649.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 137649.66 ≤ Q = 137649.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 137649.66 ≤ Q = 137649.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 137649.66 ≤ Q = 137649.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 137649.66 ≤ Q = 137649.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 137649.66 ≤ Q = 137649.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 20: θ = 137649.66 ≤ Q = 137649.66 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 21] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x9805a64
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xf67fa59c
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.131934e+13
Presolve removed 2624 rows and 1916 columns
Presolve time: 0.01s
Presolved: 469 rows, 473 columns, 1322 nonzeros
Found heuristic solution: objective 5146130.6621
Variable types: 321 continuous, 152 integer (152 binary)

Root relaxation: objective -1.326794e+05, 234 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -132679.36    0  123 5146130.66 -132679.36   103%     -    0s
H    0     0                    -101363.8764 -132679.36  30.9%     -    0s
H    0     0                    -102268.9110 -132679.36  29.7%     -    0s
     0     0 -117375.18    0   86 -102268.91 -117375.18  14.8%     -    0s
H    0     0                    -113929.5934 -117259.50  2.92%     -    0s
H    0     0                    -114231.1092 -117259.50  2.65%     -    0s
H    0     0                    -114702.3463 -117259.50  2.23%     -    0s
H    0     0                    -115003.8622 -117259.50  1.96%     -    0s
     0     0 -116084.05    0   80 -115003.86 -116084.05  0.94%     -    0s
     0     0 -116067.49    0   78 -115003.86 -116067.49  0.92%     -    0s
     0     0 -115418.36    0   44 -115003.86 -115418.36  0.36%     -    0s
     0     0 -115417.45    0   42 -115003.86 -115417.45  0.36%     -    0s
     0     0 -115334.10    0   37 -115003.86 -115334.10  0.29%     -    0s
     0     0 -115323.62    0   45 -115003.86 -115323.62  0.28%     -    0s
     0     0 -115145.66    0   13 -115003.86 -115145.66  0.12%     -    0s
     0     0 -115144.67    0   12 -115003.86 -115144.67  0.12%     -    0s
     0     0 -115121.62    0   12 -115003.86 -115121.62  0.10%     -    0s
     0     0 -115099.40    0   12 -115003.86 -115099.40  0.08%     -    0s
     0     0 -115021.24    0    4 -115003.86 -115021.24  0.02%     -    0s
     0     0          -    0      -115003.86 -115012.74  0.01%     -    0s

Explored 1 nodes (691 simplex iterations) in 0.08 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 7: -115004 -114775 -114702 ... 1.13193e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.150038622073e+05, best bound -1.150127435675e+05, gap 0.0077%
  Subproblem solved in 0.12s
  Worst-case operational profit (Z_SP) = 126670.51
  Scenario: 39 demand increases, 21 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -115003.86
  [DEBUG]   S×d_nominal = 241674.37
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 241674.37 + -115003.86 = 126670.51
  [DEBUG]   Current θ from Master = 137649.66
  [DEBUG]   ⚠️  Z_SP ≤ θ by 10979.15 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -15364.04
  Lower Bound (LB) = -4230.81
  Gap (UB-LB) = -154.0776, Absolute Gap = 154.0776, Relative Gap = -0.035138
  *** CONVERGED (small negative gap: -154.08 within tolerance ε=200) ***
  Note: Negative gap likely due to numerical precision or solver tolerance

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 21
Total Time: 56901.97s
Converged: True
Final Lower Bound: -4230.8132
Final Upper Bound: -4384.8908
Final Gap: -154.077581
Number of Critical Scenarios: 21
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [0] (1/3)
Product 1 Plants: [1] (1/3)
Product 2 Plants: [1] (1/3)
Total Plant Openings: 3
DCs Opened: [4, 5, 6, 7] (4/10)
Active Routes (Plant→DC): 10
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 0 customers  Mode 1: 0 customers  Mode 2: 50 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 21
Start Time: 2026-01-04 12:31:03
End Time: 2026-01-05 04:19:25
Total Time: 56901.97s
Optimal Value: -4230.81
Lower Bound: -4230.81
Upper Bound: -4384.89
Gap: -154.077581
Plants Opened: {0: [0], 1: [1], 2: [1]} (3 plants)
DCs Opened: [4, 5, 6, 7] (4 DCs)
================================================================================

Results saved to: result/DH_single_full_seed25_MD_gamma20_20260105_041926.csv

Total Execution Time: 56902.65 seconds
End Time: 2026-01-05 04:19:26

All tasks completed successfully!

