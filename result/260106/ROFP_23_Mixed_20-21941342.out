
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 23
DI Scenario: Mixed
Start Time: 2026-01-04 12:31:02
================================================================================
Loading data from data/DH_data_full_seed23.pkl...

Applying DI scenario: Mixed
DI values:
  Product 0: ['1.000', '1.483', '2.198'] (k=0.971)
  Product 1: ['1.000', '1.151', '1.325'] (k=0.347)
  Product 2: ['1.000', '1.020', '1.041'] (k=0.049)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=957, max=1788
  DC capacity (MC): min=424, max=888

Demand Structure (s_rk matrix):
  Total customer-product pairs: 82/150 (45.3% sparse)
  Average products per customer: 1.64

Demand (only non-zero entries):
  Nominal (μ): min=8.22, max=34.68, count=82
  Deviation (μ̂): min=4.01, max=9.75

Costs:
  Plant fixed cost: min=5308, max=9514
  DC fixed cost: min=3659, max=5984
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.483', '2.198'] (k=0.971)
    Product 1: ['1.000', '1.427', '2.036'] (k=0.877)
    Product 2: ['1.000', '1.404', '1.970'] (k=0.836)
  MD:
    Product 0: ['1.000', '1.153', '1.329'] (k=0.351)
    Product 1: ['1.000', '1.151', '1.325'] (k=0.347)
    Product 2: ['1.000', '1.264', '1.598'] (k=0.578)
  LD:
    Product 0: ['1.000', '1.094', '1.197'] (k=0.222)
    Product 1: ['1.000', '1.121', '1.257'] (k=0.282)
    Product 2: ['1.000', '1.020', '1.041'] (k=0.049)
  Mixed:
    Product 0: ['1.000', '1.483', '2.198'] (k=0.971)
    Product 1: ['1.000', '1.151', '1.325'] (k=0.347)
    Product 2: ['1.000', '1.020', '1.041'] (k=0.049)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48756 nonzeros
Model fingerprint: 0xd112653d
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11789 rows and 2789 columns
Presolve time: 0.12s
Presolved: 4884 rows, 5711 columns, 33922 nonzeros
Variable types: 3452 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -323054.2223
Found heuristic solution: objective -188519.7825

Root relaxation: objective 1.025818e+05, 4972 iterations, 0.31 seconds (0.34 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 102581.811    0  623 -188519.78 102581.811   154%     -    0s
H    0     0                    -154468.1085 102581.811   166%     -    0s
H    0     0                    -152628.6816 102581.811   167%     -    0s
     0     0 95240.4275    0  702 -152628.68 95240.4275   162%     -    1s
     0     0 94841.1796    0  688 -152628.68 94841.1796   162%     -    1s
     0     0 94831.3366    0  698 -152628.68 94831.3366   162%     -    1s
     0     0 94830.5571    0  696 -152628.68 94830.5571   162%     -    1s
H    0     0                    -152341.1943 89888.0810   159%     -    3s
     0     0 89888.0810    0  961 -152341.19 89888.0810   159%     -    3s
     0     0 89552.9642    0  977 -152341.19 89552.9642   159%     -    3s
     0     0 89510.1544    0  976 -152341.19 89510.1544   159%     -    3s
     0     0 89509.0708    0  969 -152341.19 89509.0708   159%     -    3s
     0     0 86544.8531    0 1015 -152341.19 86544.8531   157%     -    5s
H    0     0                    -140095.4618 86544.4786   162%     -    5s
H    0     0                    -139947.2021 86544.4786   162%     -    5s
     0     0 86101.2053    0 1090 -139947.20 86101.2053   162%     -    6s
H    0     0                    -58184.61411 86008.6976   248%     -    6s
H    0     0                    1173.8707368 86008.6976  7227%     -    6s
H    0     0                    1187.3620991 86008.6976  7144%     -    6s
     0     0 86008.6976    0 1106 1187.36210 86008.6976  7144%     -    6s
     0     0 85998.2159    0 1106 1187.36210 85998.2159  7143%     -    6s
     0     0 85997.5057    0 1114 1187.36210 85997.5057  7143%     -    6s
H    0     0                    1315.1572563 82395.5149  6165%     -    9s
     0     0 82395.5149    0 1137 1315.15726 82395.5149  6165%     -    9s
H    0     0                    1903.9975930 82087.3596  4211%     -   10s
H    0     0                    2793.0205685 82087.3596  2839%     -   10s
H    0     0                    2885.0410991 82087.3596  2745%     -   10s
H    0     0                    3630.0211226 82087.3596  2161%     -   10s
     0     0 82087.3596    0 1139 3630.02112 82087.3596  2161%     -   10s
     0     0 82032.4380    0 1143 3630.02112 82032.4380  2160%     -   10s
     0     0 82023.9437    0 1146 3630.02112 82023.9437  2160%     -   10s
     0     0 80252.5743    0 1181 3630.02112 80252.5743  2111%     -   12s
H    0     0                    3926.4804531 79912.6295  1935%     -   13s
H    0     0                    3927.5869554 79912.6295  1935%     -   13s
H    0     0                    4074.3076820 79912.6295  1861%     -   13s
H    0     0                    8084.5317697 79912.6295   888%     -   13s
H    0     0                    13244.185470 79912.6295   503%     -   13s
H    0     0                    13417.327342 79912.6295   496%     -   13s
H    0     0                    13417.544460 79912.6295   496%     -   13s
H    0     0                    13495.250272 79912.6295   492%     -   13s
H    0     0                    13497.128832 79912.6295   492%     -   13s
H    0     0                    13497.345951 79912.6295   492%     -   13s
H    0     0                    14782.323056 79912.6295   441%     -   13s
H    0     0                    14961.475824 79912.6295   434%     -   13s
H    0     0                    14975.870874 79912.6295   434%     -   13s
H    0     0                    14977.749434 79912.6295   434%     -   13s
H    0     0                    14977.817094 79912.6295   434%     -   13s
H    0     0                    15105.560077 79912.6295   429%     -   13s
H    0     0                    17228.036501 79912.6295   364%     -   13s
H    0     0                    17416.179209 79912.6295   359%     -   13s
H    0     0                    17416.246868 79912.6295   359%     -   13s
H    0     0                    17416.463987 79912.6295   359%     -   13s
H    0     0                    17418.342547 79912.6295   359%     -   13s
H    0     0                    17535.535431 79912.6295   356%     -   13s
H    0     0                    17535.603090 79912.6295   356%     -   13s
H    0     0                    17535.752549 79912.6295   356%     -   13s
H    0     0                    17535.820209 79912.6295   356%     -   13s
H    0     0                    17537.698769 79912.6295   356%     -   13s
     0     0 79912.6295    0 1205 17537.6988 79912.6295   356%     -   13s
     0     0 79842.4484    0 1208 17537.6988 79842.4484   355%     -   14s
     0     0 79832.2994    0 1216 17537.6988 79832.2994   355%     -   14s
     0     0 78267.8649    0 1190 17537.6988 78267.8649   346%     -   16s
     0     0 77926.2650    0 1215 17537.6988 77926.2650   344%     -   17s
     0     0 77869.2911    0 1252 17537.6988 77869.2911   344%     -   18s
     0     0 77854.1538    0 1245 17537.6988 77854.1538   344%     -   18s
H    0     0                    17714.066881 76605.1582   332%     -   20s
H    0     0                    17721.267078 76605.1582   332%     -   20s
     0     0 76605.1582    0 1227 17721.2671 76605.1582   332%     -   20s
H    0     0                    17904.803975 76334.3149   326%     -   21s
H    0     0                    17904.871635 76334.3149   326%     -   21s
     0     0 76334.3149    0 1256 17904.8716 76334.3149   326%     -   21s
H    0     0                    17928.037414 76257.6891   325%     -   22s
H    0     0                    17934.316892 76257.6891   325%     -   22s
     0     0 76257.6891    0 1270 17934.3169 76257.6891   325%     -   22s
H    0     0                    18456.974227 76244.7673   313%     -   22s
H    0     0                    18637.054855 76244.7673   309%     -   22s
H    0     0                    18828.224979 76244.7673   305%     -   22s
H    0     0                    19095.141469 76244.7673   299%     -   22s
H    0     0                    19162.892524 76244.7673   298%     -   22s
H    0     0                    19195.061698 76244.7673   297%     -   22s
H    0     0                    19465.872452 76244.7673   292%     -   22s
H    0     0                    19732.782272 76244.7673   286%     -   22s
H    0     0                    19746.695989 76244.7673   286%     -   22s
H    0     0                    19746.763649 76244.7673   286%     -   22s
     0     0 76244.7673    0 1277 19746.7636 76244.7673   286%     -   22s
     0     0 75223.1508    0 1224 19746.7636 75223.1508   281%     -   25s
     0     0 75068.6368    0 1261 19746.7636 75068.6368   280%     -   26s
     0     0 75010.9233    0 1309 19746.7636 75010.9233   280%     -   27s
     0     0 74991.0998    0 1302 19746.7636 74991.0998   280%     -   27s
     0     0 73730.8586    0 1155 19746.7636 73730.8586   273%     -   30s
H    0     0                    21054.498768 73481.5990   249%     -   32s
H    0     0                    21301.208187 73481.5990   245%     -   32s
H    0     0                    21414.647903 73481.5990   243%     -   32s
H    0     0                    21477.042128 73481.5990   242%     -   32s
     0     0 73481.5990    0 1223 21477.0421 73481.5990   242%     -   32s
H    0     0                    22155.551601 73410.8426   231%     -   33s
H    0     0                    22244.564021 73410.8426   230%     -   33s
H    0     0                    22270.546431 73410.8426   230%     -   33s
H    0     0                    22313.852048 73410.8426   229%     -   33s
H    0     0                    22326.019164 73410.8426   229%     -   33s
H    0     0                    22405.620223 73410.8426   228%     -   33s
     0     0 73410.8426    0 1238 22405.6202 73410.8426   228%     -   33s
H    0     0                    25050.645737 73389.5412   193%     -   33s
     0     0 73389.5412    0 1248 25050.6457 73389.5412   193%     -   33s
H    0     0                    25189.655148 72666.1318   188%     -   36s
H    0     0                    25281.675679 72666.1318   187%     -   36s
H    0     0                    25318.644396 72666.1318   187%     -   36s
H    0     0                    25761.723421 72666.1318   182%     -   36s
H    0     0                    25761.791081 72666.1318   182%     -   36s
     0     0 72666.1318    0 1214 25761.7911 72666.1318   182%     -   36s
     0     0 72495.0075    0 1264 25761.7911 72495.0075   181%     -   37s
H    0     0                    25818.694079 72456.7426   181%     -   38s
H    0     0                    25845.442647 72456.7426   180%     -   38s
H    0     0                    25934.815616 72456.7426   179%     -   38s
     0     0 72456.7426    0 1290 25934.8156 72456.7426   179%     -   38s
     0     0 72441.7904    0 1307 25934.8156 72441.7904   179%     -   38s
H    0     0                    25942.435679 72441.7904   179%     -   38s
     0     0 71836.7837    0 1186 25942.4357 71836.7837   177%     -   40s
     0     0 71675.4522    0 1199 25942.4357 71675.4522   176%     -   42s
H    0     0                    25970.769636 71640.7481   176%     -   42s
     0     0 71640.7481    0 1221 25970.7696 71640.7481   176%     -   42s
     0     0 71630.1695    0 1226 25970.7696 71630.1695   176%     -   43s
H    0     0                    25995.210888 69531.6689   167%     -   47s
H    0     0                    26058.094567 69531.6689   167%     -   47s
H    0     0                    26193.909568 69531.6689   165%     -   47s
H    0     0                    26212.481032 69531.6689   165%     -   47s
     0     0 69531.6689    0 1197 26212.4810 69531.6689   165%     -   47s
H    0     0                    26277.588711 69229.6716   163%     -   48s
H    0     0                    26284.524404 69229.6716   163%     -   48s
     0     0 69229.6716    0 1200 26284.5244 69229.6716   163%     -   48s
     0     0 69164.0498    0 1228 26284.5244 69164.0498   163%     -   49s
     0     0 69144.5799    0 1226 26284.5244 69144.5799   163%     -   49s
     0     0 68555.1334    0 1146 26284.5244 68555.1334   161%     -   51s
     0     0 68423.6749    0 1214 26284.5244 68423.6749   160%     -   53s
     0     0 68368.6688    0 1185 26284.5244 68368.6688   160%     -   53s
     0     0 68353.9567    0 1237 26284.5244 68353.9567   160%     -   54s
     0     0 67878.1106    0 1198 26284.5244 67878.1106   158%     -   56s
     0     0 67768.3308    0 1187 26284.5244 67768.3308   158%     -   57s
     0     0 67746.7277    0 1230 26284.5244 67746.7277   158%     -   57s
     0     0 67360.5306    0 1181 26284.5244 67360.5306   156%     -   59s
     0     0 67281.9222    0 1209 26284.5244 67281.9222   156%     -   61s
     0     0 67263.1496    0 1205 26284.5244 67263.1496   156%     -   61s
     0     0 66998.3760    0 1129 26284.5244 66998.3760   155%     -   63s
     0     0 66997.8798    0 1129 26284.5244 66997.8798   155%     -   64s
     0     2 66997.8798    0 1129 26284.5244 66997.8798   155%     -   67s
     1     4 65838.3325    1  990 26284.5244 66997.8798   155%  4373   70s
     7    16 63638.4643    3  683 26284.5244 64528.6972   146%  3780   76s
    31    64 60308.7084    5  596 26284.5244 63323.6910   141%  3846   83s
    95   244 54081.3387    7  475 26284.5244 62163.0346   137%  3972   87s
H  114   244                    28053.191861 62163.0346   122%  3419   87s
   387   419 42266.1872   15  403 28053.1919 62163.0346   122%  1401   90s
H  478   483                    28236.255065 62163.0346   120%  1241   91s
H  617   701                    28238.680383 62163.0346   120%  1029   94s
   817   868 43741.0518   26  322 28238.6804 61376.5883   117%   872   96s
H  830   868                    28370.678505 61376.5883   116%   861   96s
H  903   868                    28374.265839 61087.9706   115%   829   96s
  1151  1138 35748.7887   30  288 28374.2658 59562.6615   110%   757  100s
H 1361  1301                    28859.538399 59416.3904   106%   730  101s
  1690  1579     cutoff   35      28859.5384 58822.4062   104%   677  105s
H 1836  1664                    28954.634600 58822.4062   103%   662  105s
  2259  1955 42854.5858   12  283 28954.6346 58822.4062   103%   619  110s
H 2481  1756                    33832.583747 58371.6043  72.5%   600  111s
H 2558  1755                    34094.050566 57906.3547  69.8%   601  112s
H 2575  1755                    34687.836482 57906.3547  66.9%   601  112s
H 2582  1755                    34849.650287 57906.3547  66.2%   602  112s
H 2586  1755                    34981.078229 57906.3547  65.5%   602  112s
H 2590  1755                    34993.459553 57906.3547  65.5%   602  112s
  2793  1732 43174.9413   17  172 34993.4596 57906.3547  65.5%   588  115s
H 2795  1732                    35417.958109 57906.3547  63.5%   588  115s
H 2836  1732                    35964.741766 57906.3547  61.0%   588  115s
  3557  1827 46784.5105   19  346 35964.7418 54691.7349  52.1%   578  120s
H 4037  2050                    35968.546218 53596.0016  49.0%   565  124s
  4182  2140 39499.8849   30  283 35968.5462 53596.0016  49.0%   560  126s
H 4474  2181                    36011.061474 52725.5845  46.4%   558  128s
H 4493  2174                    36044.228197 52725.5845  46.3%   559  128s
  4512  2245     cutoff    9      36044.2282 52725.5845  46.3%   560  130s
H 4748  2294                    36052.077754 52725.5845  46.2%   558  131s
H 4758  2289                    36107.293639 52725.5845  46.0%   559  131s
H 5089  2391                    36107.361299 52113.2014  44.3%   565  138s
  5090  2392 37641.2750   18 1129 36107.3613 52113.2014  44.3%   565  157s
  5098  2397 42149.7463   13  332 36107.3613 52113.2014  44.3%   564  160s
  5109  2405 44973.3448   34  456 36107.3613 50896.2951  41.0%   563  165s
H 5567  2235                    36333.746832 41754.7881  14.9%   544  169s
  5576  2232 40076.4147   27  194 36333.7468 41754.7881  14.9%   543  170s
H 5814  1957                    36353.160444 40888.2113  12.5%   527  170s
H 5918  1869                    36368.852639 38903.8447  6.97%   519  171s
H 5970  1749                    36387.722347 38903.8447  6.91%   515  171s
H 6653  1634                    36401.769024 37691.2105  3.54%   464  171s
H 7320  1481                    36414.298118 36731.6192  0.87%   424  171s
H 7449  1349                    36429.073192 36731.6192  0.83%   417  171s
* 7788  1256              85    36429.268686 36728.8755  0.82%   399  171s
H 7880  1145                    36449.467293 36728.8755  0.77%   395  171s
H 7882  1113                    36452.006053 36728.8755  0.76%   395  172s
H 7910  1031                    36470.472759 36728.8755  0.71%   394  172s
H 7964   945                    36471.191485 36728.8755  0.71%   391  172s
* 9199   652              80    36476.420434 36694.2643  0.60%   341  172s
* 9200   652              80    36488.344506 36694.2643  0.56%   341  172s
H 9825   429                    36513.008451 36657.1764  0.39%   321  172s
*11025    20              81    36513.230400 36542.8725  0.08%   287  174s

Cutting planes:
  Gomory: 5
  Projected implied bound: 21
  MIR: 164
  Flow cover: 444
  RLT: 5
  Relax-and-lift: 83

Explored 11132 nodes (3279739 simplex iterations) in 174.66 seconds (220.30 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 36513.2 36488.3 36476.4 ... 36414.3

Optimal solution found (tolerance 1.00e-04)
Best objective 3.651323040036e+04, best bound 3.651323040036e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 174.67s
  Master Objective (UB) = 36513.23, θ = 180570.54
  Upper Bound (UB) = 36513.23

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 180570.54
  [DEBUG]   ✓ Scenario 0: θ = 180570.54 ≤ Q = 180570.54 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x6df4fdcd
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x6df4fdcd
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [9e-13, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.245791e+13
Presolve removed 2587 rows and 1879 columns
Presolve time: 0.01s
Presolved: 506 rows, 510 columns, 1427 nonzeros
Found heuristic solution: objective 6284232.4197
Variable types: 346 continuous, 164 integer (164 binary)

Root relaxation: objective -1.333272e+05, 251 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -133327.17    0  123 6284232.42 -133327.17   102%     -    0s
H    0     0                    -100542.0288 -133327.17  32.6%     -    0s
H    0     0                    -100844.8170 -133327.17  32.2%     -    0s
H    0     0                    -102916.7266 -102916.73  0.00%     -    0s
     0     0          -    0      -102916.73 -102916.73  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 205

Explored 1 nodes (388 simplex iterations) in 0.02 seconds (0.01 work units)
Thread count was 32 (of 32 available processors)

Solution count 5: -102917 -100845 -100542 ... 1.24579e+13
No other solutions better than -102917

Optimal solution found (tolerance 1.00e-04)
Best objective -1.029167266076e+05, best bound -1.029167266076e+05, gap 0.0000%
  Subproblem solved in 0.05s
  Worst-case operational profit (Z_SP) = 147989.60
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -102916.73
  [DEBUG]   S×d_nominal = 250906.32
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 250906.32 + -102916.73 = 147989.60
  [DEBUG]   Current θ from Master = 180570.54
  [DEBUG]   ⚠️  Z_SP ≤ θ by 32580.94 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 3932.29
  Lower Bound (LB) = 3932.29
  Gap (UB-LB) = 32580.9374, Absolute Gap = 32580.9374, Relative Gap = 0.892305
  Not converged yet (gap = 32580.94 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 91993 nonzeros
Model fingerprint: 0x649fc7a6
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve produced solution with objective 3932.29 (0.02s)
Loaded MIP start from previous solve with objective 3932.29

Presolve removed 13767 rows and 5586 columns
Presolve time: 0.50s
Presolved: 18196 rows, 9154 columns, 100768 nonzeros
Variable types: 6895 continuous, 2259 integer (2259 binary)

Root relaxation: objective 4.811688e+04, 8542 iterations, 1.31 seconds (1.83 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 48116.8849    0  258 3932.29303 48116.8849  1124%     -    1s
H    0     0                    10706.597054 48116.8849   349%     -    2s
H    0     0                    12356.546721 48116.8849   289%     -    2s
H    0     0                    12380.195191 48116.8849   289%     -    2s
H    0     0                    12609.588375 48116.8849   282%     -    2s
H    0     0                    12638.964448 48116.8849   281%     -    2s
H    0     0                    12681.442984 39096.7374   208%     -    3s
     0     0 39096.7374    0  289 12681.4430 39096.7374   208%     -    4s
     0     0 38783.1746    0  296 12681.4430 38783.1746   206%     -    4s
     0     0 38783.1746    0  300 12681.4430 38783.1746   206%     -    4s
     0     0 38783.1746    0  296 12681.4430 38783.1746   206%     -    4s
     0     0 34061.7594    0  452 12681.4430 34061.7594   169%     -    6s
H    0     0                    12683.371640 34060.0551   169%     -    7s
     0     0 33405.1983    0  532 12683.3716 33405.1983   163%     -    7s
     0     0 33223.3393    0  566 12683.3716 33223.3393   162%     -    8s
H    0     0                    12771.414856 33198.9301   160%     -    8s
     0     0 33198.9301    0  558 12771.4149 33198.9301   160%     -    8s
H    0     0                    12778.579164 33192.0948   160%     -    8s
     0     0 33192.0948    0  521 12778.5792 33192.0948   160%     -    8s
     0     0 33190.6580    0  559 12778.5792 33190.6580   160%     -    8s
     0     0 30007.6554    0  499 12778.5792 30007.6554   135%     -   11s
     0     0 29637.2650    0  572 12778.5792 29637.2650   132%     -   12s
     0     0 29533.6362    0  500 12778.5792 29533.6362   131%     -   13s
     0     0 29510.9226    0  509 12778.5792 29510.9226   131%     -   13s
     0     0 29504.8712    0  511 12778.5792 29504.8712   131%     -   13s
     0     0 29504.4367    0  514 12778.5792 29504.4367   131%     -   13s
H    0     0                    12868.493788 29504.4367   129%     -   15s
H    0     0                    12886.659371 29504.4367   129%     -   15s
     0     0 27842.4902    0  551 12886.6594 27842.4902   116%     -   17s
     0     0 27528.2832    0  597 12886.6594 27528.2832   114%     -   18s
     0     0 27462.5277    0  719 12886.6594 27462.5277   113%     -   18s
     0     0 27437.0803    0  722 12886.6594 27437.0803   113%     -   18s
H    0     0                    12892.416064 27430.1805   113%     -   19s
     0     0 27430.1805    0  731 12892.4161 27430.1805   113%     -   19s
     0     0 27425.3025    0  666 12892.4161 27425.3025   113%     -   19s
     0     0 26953.3895    0  399 12892.4161 26953.3895   109%     -   20s
     0     0 26906.7822    0  480 12892.4161 26906.7822   109%     -   21s
     0     0 26900.0278    0  402 12892.4161 26900.0278   109%     -   21s
     0     0 26896.0209    0  410 12892.4161 26896.0209   109%     -   22s
     0     0 26801.6419    0  528 12892.4161 26801.6419   108%     -   23s
     0     0 26767.8927    0  404 12892.4161 26767.8927   108%     -   23s
     0     0 26750.5484    0  481 12892.4161 26750.5484   107%     -   24s
     0     0 26747.2062    0  471 12892.4161 26747.2062   107%     -   24s
     0     0 26692.3583    0  608 12892.4161 26692.3583   107%     -   25s
     0     0 26680.2712    0  594 12892.4161 26680.2712   107%     -   26s
     0     0 26675.8630    0  456 12892.4161 26675.8630   107%     -   26s
     0     0 26651.0926    0  538 12892.4161 26651.0926   107%     -   27s
     0     0 26632.5196    0  572 12892.4161 26632.5196   107%     -   27s
     0     0 26627.9397    0  535 12892.4161 26627.9397   107%     -   28s
     0     0 26619.4954    0  386 12892.4161 26619.4954   106%     -   28s
     0     0 26613.0456    0  451 12892.4161 26613.0456   106%     -   29s
     0     0 26609.7394    0  393 12892.4161 26609.7394   106%     -   29s
     0     0 26604.7147    0  392 12892.4161 26604.7147   106%     -   30s
     0     0 26603.3148    0  379 12892.4161 26603.3148   106%     -   30s
     0     0 26592.7419    0  530 12892.4161 26592.7419   106%     -   31s
     0     0 26590.9031    0  530 12892.4161 26590.9031   106%     -   31s
     0     2 26590.9031    0  530 12892.4161 26590.9031   106%     -   35s
    15    32 26009.0391    4  448 12892.4161 26031.5095   102%  1339   40s
   127   169 23773.3603    8  475 12892.4161 25900.0651   101%  1009   46s
H  146   169                    13528.056727 25900.0651  91.5%   936   46s
H  157   169                    14180.571015 25900.0651  82.6%   900   46s
H  327   343                    14565.469778 25746.5283  76.8%   630   49s
   364   395 22852.9800   12  375 14565.4698 25746.5283  76.8%   620   51s
   703   577 17045.8528   15  349 14565.4698 25108.3363  72.4%   515   55s
  1026   786 15672.9965   23  308 14565.4698 25103.8554  72.4%   481   60s
  1489  1084 17919.7281   12  284 14565.4698 24193.1682  66.1%   413   66s
  1861  1196     cutoff   22      14565.4698 24166.3231  65.9%   398   70s
H 2140  1224                    14567.797545 22932.0478  57.4%   398   73s
H 2153  1224                    14587.676841 22932.0478  57.2%   399   73s
  2175  1297     cutoff   11      14587.6768 22932.0478  57.2%   399   75s
H 2327  1340                    14604.481784 22932.0478  57.0%   396   76s
H 2383  1340                    14610.317710 22932.0478  57.0%   395   76s
H 2392  1340                    14616.048296 22932.0478  56.9%   394   76s
H 2402  1340                    14617.142400 22932.0478  56.9%   394   76s
  2666  1440     cutoff   31      14617.1424 21976.2397  50.3%   381   80s
  3253  1651 infeasible   16      14617.1424 21499.4918  47.1%   366   85s
  3556  1787     cutoff   16      14617.1424 21420.5932  46.5%   362   91s
  4184  1973 15901.7782    9  226 14617.1424 21262.3500  45.5%   349   96s
  4601  2042     cutoff   14      14617.1424 20701.1225  41.6%   349  100s
  5212  2112 19435.6238   12  305 14617.1424 20299.5507  38.9%   351  106s
  5563  2263 15296.5874   16  252 14617.1424 20186.3764  38.1%   352  110s
  6221  2363 infeasible   15      14617.1424 19992.3121  36.8%   348  117s
  6539  2412 18696.6269   12  369 14617.1424 19751.4008  35.1%   348  120s
  7110  2490 16081.1813   21  530 14617.1424 19554.9748  33.8%   347  134s
  7112  2491 16879.6059   28   94 14617.1424 19554.9748  33.8%   347  136s
  7115  2493 16991.5907   30  416 14617.1424 19554.9748  33.8%   347  140s
  7122  2498 16320.2832   17  375 14617.1424 19554.9748  33.8%   347  145s
  7129  2503 18114.0544   16  384 14617.1424 19554.9748  33.8%   347  152s
  7131  2507 19554.9748   16  358 14617.1424 19554.9748  33.8%   350  156s
  7161  2553 19554.9748   20  310 14617.1424 19554.9748  33.8%   352  160s
  7437  2564 15465.7929   24  305 14617.1424 19554.9748  33.8%   359  165s
  7734  2463 17959.6358   27  247 14617.1424 19554.9748  33.8%   361  171s
  7890  2392 16652.6193   29  188 14617.1424 18710.5575  28.0%   361  175s
  8248  2153 15097.4625   32   87 14617.1424 17836.5343  22.0%   358  180s

Cutting planes:
  Gomory: 3
  Lift-and-project: 1
  MIR: 159
  Flow cover: 298
  RLT: 6
  Relax-and-lift: 38

Explored 8476 nodes (3004245 simplex iterations) in 183.65 seconds (296.64 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 14617.1 14616 14610.3 ... 12892.4

Optimal solution found (tolerance 1.00e-04)
Best objective 1.461714239973e+04, best bound 1.461714239973e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 183.66s
  Master Objective (UB) = 14617.14, θ = 155001.38
  Upper Bound (UB) = 14617.14

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 155001.38
  [DEBUG]   ✓ Scenario 0: θ = 155001.38 ≤ Q = 155001.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 155001.38 ≤ Q = 155001.38 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x1fc1ad2a
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xe03e52d6
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.417154e+13
Presolve removed 2589 rows and 1882 columns
Presolve time: 0.01s
Presolved: 504 rows, 507 columns, 1421 nonzeros
Found heuristic solution: objective 7387467.2565
Variable types: 343 continuous, 164 integer (164 binary)

Root relaxation: objective -1.431607e+05, 269 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -143160.69    0  132 7387467.26 -143160.69   102%     -    0s
H    0     0                    -105602.2601 -143160.69  35.6%     -    0s
H    0     0                    -124314.3145 -143160.69  15.2%     -    0s
H    0     0                    -125585.1262 -132245.44  5.30%     -    0s
H    0     0                    -125815.5082 -132245.44  5.11%     -    0s
     0     0 -132245.44    0   83 -125815.51 -132245.44  5.11%     -    0s
H    0     0                    -129098.1445 -132150.92  2.36%     -    0s
H    0     0                    -130704.8913 -131383.74  0.52%     -    0s
     0     0 -131383.74    0   68 -130704.89 -131383.74  0.52%     -    0s
     0     0 -131379.09    0   68 -130704.89 -131379.09  0.52%     -    0s
H    0     0                    -131073.4012 -131376.82  0.23%     -    0s
     0     0 -131369.71    0   75 -131073.40 -131369.71  0.23%     -    0s
     0     0 -131312.04    0   57 -131073.40 -131312.04  0.18%     -    0s
     0     0 -131297.94    0   35 -131073.40 -131297.94  0.17%     -    0s
     0     0 -131297.11    0   34 -131073.40 -131297.11  0.17%     -    0s
     0     0 -131293.77    0   40 -131073.40 -131293.77  0.17%     -    0s
     0     0 -131154.21    0   13 -131073.40 -131154.21  0.06%     -    0s
     0     0 -131154.21    0   11 -131073.40 -131154.21  0.06%     -    0s
H    0     0                    -131113.5827 -131154.21  0.03%     -    0s
     0     0          -    0      -131113.58 -131122.98  0.01%     -    0s

Cutting planes:
  Gomory: 4
  Implied bound: 1
  MIR: 5
  Flow cover: 2
  Relax-and-lift: 3

Explored 1 nodes (711 simplex iterations) in 0.19 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -131114 -131073 -130705 ... 7.38747e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.311135826895e+05, best bound -1.311229840126e+05, gap 0.0072%
  Subproblem solved in 0.22s
  Worst-case operational profit (Z_SP) = 130191.46
  Scenario: 34 demand increases, 26 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -131113.58
  [DEBUG]   S×d_nominal = 261305.05
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 261305.05 + -131113.58 = 130191.46
  [DEBUG]   Current θ from Master = 155001.38
  [DEBUG]   ⚠️  Z_SP ≤ θ by 24809.92 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -10192.77
  Lower Bound (LB) = 3932.29
  Gap (UB-LB) = 10684.8494, Absolute Gap = 10684.8494, Relative Gap = 0.730981
  Not converged yet (gap = 10684.85 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 34 increases, 26 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135230 nonzeros
Model fingerprint: 0x9132cefe
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve produced solution with objective -10192.8 (0.03s)
Loaded MIP start from previous solve with objective -10192.8

Presolve removed 20624 rows and 8374 columns
Presolve time: 0.66s
Presolved: 26629 rows, 12606 columns, 163799 nonzeros
Variable types: 10347 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   43004    1.6875128e+04   0.000000e+00   1.101237e+07      5s
Concurrent spin time: 0.01s

Solved with dual simplex

Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   15996    3.8044300e+04   0.000000e+00   0.000000e+00      6s

Root relaxation: objective 3.804430e+04, 15996 iterations, 5.12 seconds (6.83 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 38044.3003    0  118 -10192.775 38044.3003   473%     -    6s
H    0     0                    -8287.711031 38044.3003   559%     -    6s
H    0     0                    -4044.417652 38044.3003  1041%     -    6s
H    0     0                    -2123.818993 38044.3003  1891%     -    6s
H    0     0                    -2095.896879 38044.3003  1915%     -    6s
H    0     0                    7990.6011223 38044.3003   376%     -    7s
H    0     0                    9875.3099052 38044.3003   285%     -    7s
H    0     0                    11073.806912 38044.3003   244%     -    7s
H    0     0                    11174.175853 38044.3003   240%     -    7s
     0     0 32878.8069    0  170 11174.1759 32878.8069   194%     -   10s
H    0     0                    11932.593179 32878.8069   176%     -   10s
     0     0 32471.2529    0  181 11932.5932 32471.2529   172%     -   10s
     0     0 32471.2529    0  183 11932.5932 32471.2529   172%     -   11s
     0     0 32471.2529    0  183 11932.5932 32471.2529   172%     -   11s
     0     0 30297.9392    0  270 11932.5932 30297.9392   154%     -   13s
H    0     0                    11953.714131 30297.9392   153%     -   13s
H    0     0                    11969.496553 30297.9392   153%     -   13s
H    0     0                    11993.978350 30297.9392   153%     -   13s
H    0     0                    12004.092446 30297.9392   152%     -   13s
H    0     0                    12004.392750 30297.9392   152%     -   13s
H    0     0                    12023.591794 30297.9392   152%     -   13s
H    0     0                    12025.748424 30297.9392   152%     -   13s
     0     0 29514.5764    0  295 12025.7484 29514.5764   145%     -   14s
     0     0 28870.9634    0  309 12025.7484 28870.9634   140%     -   16s
     0     0 28802.0575    0  320 12025.7484 28802.0575   140%     -   16s
     0     0 28788.9351    0  317 12025.7484 28788.9351   139%     -   16s
     0     0 28787.5191    0  313 12025.7484 28787.5191   139%     -   16s
     0     0 28786.9013    0  315 12025.7484 28786.9013   139%     -   16s
     0     0 27421.0954    0  313 12025.7484 27421.0954   128%     -   20s
     0     0 27039.7404    0  372 12025.7484 27039.7404   125%     -   22s
     0     0 26888.2827    0  371 12025.7484 26888.2827   124%     -   23s
     0     0 26831.5214    0  385 12025.7484 26831.5214   123%     -   24s
     0     0 26811.8249    0  376 12025.7484 26811.8249   123%     -   24s
     0     0 26793.0763    0  387 12025.7484 26793.0763   123%     -   25s
     0     0 26789.2270    0  386 12025.7484 26789.2270   123%     -   25s
     0     0 26788.3000    0  383 12025.7484 26788.3000   123%     -   25s
     0     0 26273.4774    0  410 12025.7484 26273.4774   118%     -   29s
     0     0 26194.6701    0  375 12025.7484 26194.6701   118%     -   31s
     0     0 26036.1057    0  397 12025.7484 26036.1057   117%     -   32s
     0     0 25999.9052    0  406 12025.7484 25999.9052   116%     -   33s
     0     0 25990.6436    0  409 12025.7484 25990.6436   116%     -   33s
     0     0 25987.0421    0  407 12025.7484 25987.0421   116%     -   33s
     0     0 25985.1592    0  406 12025.7484 25985.1592   116%     -   33s
     0     0 25983.6796    0  413 12025.7484 25983.6796   116%     -   33s
     0     0 25983.2586    0  413 12025.7484 25983.2586   116%     -   34s
     0     0 25940.4942    0  379 12025.7484 25940.4942   116%     -   35s
     0     0 25931.8145    0  375 12025.7484 25931.8145   116%     -   36s
     0     0 25929.0579    0  389 12025.7484 25929.0579   116%     -   36s
     0     0 25927.5291    0  388 12025.7484 25927.5291   116%     -   36s
     0     0 25926.9401    0  390 12025.7484 25926.9401   116%     -   36s
     0     0 25913.0649    0  390 12025.7484 25913.0649   115%     -   37s
     0     0 25911.9051    0  378 12025.7484 25911.9051   115%     -   37s
     0     0 25905.2460    0  398 12025.7484 25905.2460   115%     -   38s
     0     0 25899.1247    0  379 12025.7484 25899.1247   115%     -   38s
     0     0 25898.0410    0  393 12025.7484 25898.0410   115%     -   39s
     0     0 25892.7335    0  387 12025.7484 25892.7335   115%     -   39s
     0     0 25891.8706    0  395 12025.7484 25891.8706   115%     -   40s
     0     0 25891.4414    0  400 12025.7484 25891.4414   115%     -   40s
     0     0 25890.2701    0  401 12025.7484 25890.2701   115%     -   40s
     0     0 25890.1619    0  401 12025.7484 25890.1619   115%     -   41s
     0     0 25887.9135    0  401 12025.7484 25887.9135   115%     -   42s
H    0     0                    12029.496943 25886.6341   115%     -   49s
H    0     2                    12050.225044 25886.6341   115%     -   49s
     0     2 25886.6341    0  401 12050.2250 25886.6341   115%     -   49s
     1     4 25719.6857    1  388 12050.2250 25886.6341   115%  1703   51s
     7    16 25207.2118    3  380 12050.2250 25575.5847   112%  2316   57s
    15    32 24982.2783    4  368 12050.2250 25204.8849   109%  2672   60s
    31    64 24569.9217    5  412 12050.2250 24980.0458   107%  3221   65s
H   33    64                    12075.225506 24980.0458   107%  3131   65s
H   38    64                    12079.150517 24980.0458   107%  3118   65s
H   38    64                    12342.486393 24980.0458   102%  3118   65s
    63    95 24088.1780    6  470 12342.4864 24569.6264  99.1%  3749   75s
    94   199 23941.9034    7  479 12342.4864 24569.6264  99.1%  4374   80s
H  102   199                    12365.268990 24569.6264  98.7%  4198   80s
H  130   199                    12394.471117 24569.6264  98.2%  3614   80s
   260   288 22546.3970   11  460 12394.4711 24569.6264  98.2%  2722   86s
H  304   322                    12466.297657 24569.6264  97.1%  2544   89s
   335   390 22413.7110   13  444 12466.2977 24461.2395  96.2%  2443   93s
H  368   390                    12480.402964 24461.2395  96.0%  2398   93s
   413   477 22244.1968   14  437 12480.4030 24461.2395  96.0%  2219   96s
   588   592 22168.8713   16  432 12480.4030 24461.2395  96.0%  1839  102s
   660   622 22020.8736   17  412 12480.4030 24090.0411  93.0%  1768  105s
   734   693 19820.3808   18  439 12480.4030 24090.0411  93.0%  1766  112s
   779   748 20922.0803   19  403 12480.4030 23984.4565  92.2%  1754  115s
H  815   748                    12551.951786 23984.4565  91.1%  1742  115s
   918   880 20603.1831   22  343 12551.9518 23976.4162  91.0%  1677  121s
H  920   880                    12571.120079 23976.4162  90.7%  1677  121s
   996   927 18179.2784   23  289 12571.1201 23976.4162  90.7%  1635  126s
  1124  1017 17447.9646   25  258 12571.1201 23940.2953  90.4%  1578  132s
  1199  1087 17355.2215   26  255 12571.1201 23926.0971  90.3%  1541  136s
  1394  1305     cutoff   31      12571.1201 23926.0971  90.3%  1466  143s
  1545  1458     cutoff   32      12571.1201 23729.8205  88.8%  1377  147s
  1749  1579 14679.2819   37  212 12571.1201 23729.8205  88.8%  1272  151s
  1956  1687 12997.2476   45  171 12571.1201 23729.3550  88.8%  1190  155s
  2274  1891 17706.0233   14  328 12571.1201 23536.8498  87.2%  1130  163s
  2443  1947 17069.3517   17  334 12571.1201 23536.8498  87.2%  1102  167s
  2553  2035 16908.9990   18  320 12571.1201 23289.0704  85.3%  1084  171s
  2710  2163 16358.6165   19  316 12571.1201 23289.0704  85.3%  1064  177s
  2907  2295 14970.0436   25  216 12571.1201 23234.1679  84.8%  1043  182s
  3116  2408 18520.0658   11  236 12571.1201 23128.9605  84.0%  1021  186s
  3312  2495     cutoff   15      12571.1201 23094.4551  83.7%  1005  192s
  3511  2641 13481.7258   15  215 12571.1201 23020.7817  83.1%   997  198s
  3774  2744 14861.1876   13  269 12571.1201 22952.7942  82.6%   974  205s
  3959  2872 14620.1629   14  211 12571.1201 22846.3577  81.7%   960  210s
H 4008  2872                    12598.779270 22818.4167  81.1%   962  210s
H 4042  2872                    12599.693947 22818.4167  81.1%   956  210s
  4164  2873 13392.8690   34  401 12599.6939 22818.4167  81.1%   950  223s
  4166  2874 19305.2840    9  118 12599.6939 22818.4167  81.1%   949  231s
  4167  2875 17740.0014   17  323 12599.6939 22818.4167  81.1%   949  238s
  4168  2876 13820.7167   35  343 12599.6939 22818.4167  81.1%   949  241s
  4170  2877 17355.2809   19  411 12599.6939 22818.4167  81.1%   949  245s
  4175  2880 15787.8404   40  478 12599.6939 22818.4167  81.1%   947  252s
  4178  2882 14313.0446   41  396 12599.6939 22818.4167  81.1%   947  256s
  4182  2885 15369.9796   37  444 12599.6939 22818.4167  81.1%   946  260s
  4186  2888 18145.5958   22  427 12599.6939 22818.4167  81.1%   945  265s
  4189  2890 20258.4308   12  503 12599.6939 22818.4167  81.1%   944  270s
  4192  2892 17506.2546   26  415 12599.6939 22818.4167  81.1%   944  276s
  4195  2894 15536.0951   30  490 12599.6939 22818.4167  81.1%   943  280s
  4197  2895 14024.6667   50  525 12599.6939 22818.4167  81.1%   942  292s
  4198  2896 17414.1507   14  525 12599.6939 22818.4167  81.1%   942  298s
  4199  2899 22818.4167   16  357 12599.6939 22818.4167  81.1%   966  302s
  4201  2903 22818.4167   17  344 12599.6939 22818.4167  81.1%   967  305s
  4213  2923 20741.2143   19  389 12599.6939 22525.6376  78.8%   974  313s
  4229  2941 14154.8960   20  341 12599.6939 21283.3830  68.9%   981  318s
  4261  2941 13321.1185   21  352 12599.6939 20516.5559  62.8%   995  322s
  4293  2978     cutoff   22      12599.6939 19826.0969  57.4%  1012  327s
  4355  3014 15715.2415   22  301 12599.6939 19411.2301  54.1%  1022  331s
  4489  3036     cutoff   26      12599.6939 19411.2301  54.1%  1031  337s
  4574  3038 13243.0936   26  232 12599.6939 19411.2301  54.1%  1033  342s
  4655  3028     cutoff   28      12599.6939 19411.2301  54.1%  1031  346s
  4744  3001 15617.1377   25  240 12599.6939 18704.7264  48.5%  1026  350s
  4876  2998 12960.8773   27  252 12599.6939 18686.2547  48.3%  1029  356s
  4933  3000     cutoff   28      12599.6939 18686.2547  48.3%  1027  360s
  5039  2984     cutoff   23      12599.6939 17947.1340  42.4%  1027  367s
H 5065  2830                    12631.887955 17947.1340  42.1%  1026  367s
  5104  2830     cutoff   26      12631.8880 17946.6579  42.1%  1026  371s
H 5113  2689                    12789.638825 17946.6579  40.3%  1026  371s
  5237  2637 15234.9007   25  188 12789.6388 17946.6579  40.3%  1028  377s
H 5252  2501                    12868.646666 17946.6579  39.5%  1027  378s
  5298  2481 14792.8200   26  192 12868.6467 17946.6579  39.5%  1026  382s
  5395  2448     cutoff   27      12868.6467 17496.9829  36.0%  1026  385s
H 5403  2320                    12890.487408 17455.6814  35.4%  1027  385s
H 5403  2202                    12892.416064 17455.6814  35.4%  1027  385s
  5537  2167     cutoff   28      12892.4161 17455.6814  35.4%  1027  392s
  5597  2154 16206.1023   31  149 12892.4161 17374.2081  34.8%  1026  398s
  5679  2126     cutoff   32      12892.4161 16994.7586  31.8%  1024  401s
  5740  2108 15275.3043   33  141 12892.4161 16994.7586  31.8%  1023  405s
  5935  2048 14874.6202   35  208 12892.4161 16994.7586  31.8%  1017  412s
  6038  2017 14682.8923   36  214 12892.4161 16994.7586  31.8%  1015  418s
  6153  1959     cutoff   37      12892.4161 16347.2285  26.8%  1009  422s
  6292  1882     cutoff   41      12892.4161 16052.5705  24.5%  1004  427s
  6420  1813     cutoff   30      12892.4161 16003.9768  24.1%   999  431s
  6564  1691 13799.6667   28  293 12892.4161 15944.5719  23.7%   993  436s
  6774  1513 14269.9891   33  261 12892.4161 15355.0540  19.1%   980  440s
  6974  1393     cutoff   33      12892.4161 14978.2804  16.2%   968  445s
  7213  1236     cutoff   33      12892.4161 14705.4781  14.1%   950  452s

Cutting planes:
  Gomory: 11
  MIR: 209
  Flow cover: 604
  RLT: 12
  Relax-and-lift: 39

Explored 7258 nodes (6927852 simplex iterations) in 452.67 seconds (813.13 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 12892.4 12890.5 12868.6 ... 12466.3

Optimal solution found (tolerance 1.00e-04)
Best objective 1.289241606378e+04, best bound 1.289241606378e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 452.69s
  Master Objective (UB) = 12892.42, θ = 156700.29
  Upper Bound (UB) = 12892.42

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 156700.29
  [DEBUG]   ✓ Scenario 0: θ = 156700.29 ≤ Q = 156700.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 156700.29 ≤ Q = 156700.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 156700.29 ≤ Q = 156700.29 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x3d79e08e
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xc2861f72
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.250565e+13
Presolve removed 2587 rows and 1879 columns
Presolve time: 0.01s
Presolved: 506 rows, 510 columns, 1427 nonzeros
Found heuristic solution: objective 6175881.9033
Variable types: 346 continuous, 164 integer (164 binary)

Root relaxation: objective -1.503681e+05, 249 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -150368.11    0  125 6175881.90 -150368.11   102%     -    0s
H    0     0                    -111945.0126 -150368.11  34.3%     -    0s
H    0     0                    -120859.4947 -150368.11  24.4%     -    0s
H    0     0                    -134089.3878 -150368.11  12.1%     -    0s
H    0     0                    -135936.8353 -137764.58  1.34%     -    0s
H    0     0                    -136064.7671 -137764.58  1.25%     -    0s
     0     0 -137764.58    0   63 -136064.77 -137764.58  1.25%     -    0s
H    0     0                    -136614.0144 -137696.22  0.79%     -    0s
H    0     0                    -136948.0292 -137696.22  0.55%     -    0s
     0     0 -137201.31    0   52 -136948.03 -137201.31  0.18%     -    0s
     0     0 -137117.64    0   24 -136948.03 -137117.64  0.12%     -    0s
     0     0 -137107.69    0   21 -136948.03 -137107.69  0.12%     -    0s
     0     0 -137106.86    0   21 -136948.03 -137106.86  0.12%     -    0s
     0     0 -137106.11    0   22 -136948.03 -137106.11  0.12%     -    0s
     0     0 -137030.35    0    8 -136948.03 -137030.35  0.06%     -    0s
     0     0 -137030.35    0   13 -136948.03 -137030.35  0.06%     -    0s
H    0     0                    -136967.3501 -137030.35  0.05%     -    0s
     0     0 -137030.35    0    7 -136967.35 -137030.35  0.05%     -    0s
H    0     0                    -136993.3275 -137027.26  0.02%     -    0s
     0     0 -137027.26    0    7 -136993.33 -137027.26  0.02%     -    0s
H    0     0                    -137011.3348 -137024.83  0.01%     -    0s
     0     0 -137024.83    0    5 -137011.33 -137024.83  0.01%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 7
  Flow cover: 8
  Relax-and-lift: 4

Explored 1 nodes (632 simplex iterations) in 0.12 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -137011 -136993 -136967 ... -134089

Optimal solution found (tolerance 1.00e-04)
Best objective -1.370113347581e+05, best bound -1.370248312813e+05, gap 0.0099%
  Subproblem solved in 0.15s
  Worst-case operational profit (Z_SP) = 130930.15
  Scenario: 29 demand increases, 31 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -137011.33
  [DEBUG]   S×d_nominal = 267941.48
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 267941.48 + -137011.33 = 130930.15
  [DEBUG]   Current θ from Master = 156700.29
  [DEBUG]   ⚠️  Z_SP ≤ θ by 25770.14 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -12877.73
  Lower Bound (LB) = 3932.29
  Gap (UB-LB) = 8960.1230, Absolute Gap = 8960.1230, Relative Gap = 0.694992
  Not converged yet (gap = 8960.12 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 29 increases, 31 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178467 nonzeros
Model fingerprint: 0x343e4002
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve produced solution with objective -12877.7 (0.09s)
MIP start from previous solve produced solution with objective -12877.7 (0.10s)
Loaded MIP start from previous solve with objective -12877.7

Presolve removed 27512 rows and 11172 columns
Presolve time: 1.38s
Presolved: 35031 rows, 16048 columns, 216519 nonzeros
Variable types: 13789 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 35031 rows, 16048 columns, 216519 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   31594    1.2060257e+04   0.000000e+00   8.213873e+05      5s
   43378    2.9411853e+04   0.000000e+00   7.366804e+07     10s
Concurrent spin time: 3.26s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 3.802770e+04, 33010 iterations, 12.51 seconds (16.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 38027.7031    0  115 -12877.727 38027.7031   395%     -   14s
H    0     0                    -11828.65144 38027.7031   421%     -   14s
H    0     0                    -11701.94877 38027.7031   425%     -   14s
H    0     0                     673.7982753 38027.7031  5544%     -   14s
H    0     0                     703.8255537 38027.7031  5303%     -   14s
H    0     0                     789.1891258 38027.7031  4719%     -   14s
H    0     0                    12002.368771 38027.7031   217%     -   14s
H    0     0                    12011.215785 38027.7031   217%     -   15s
H    0     0                    12067.318647 33872.8367   181%     -   18s
H    0     0                    12077.954546 33872.8367   180%     -   18s
     0     0 33849.9298    0  179 12077.9545 33849.9298   180%     -   18s
     0     0 32864.6760    0  198 12077.9545 32864.6760   172%     -   21s
     0     0 32851.8046    0  195 12077.9545 32851.8046   172%     -   22s
     0     0 32844.9500    0  195 12077.9545 32844.9500   172%     -   23s
     0     0 32844.9500    0  195 12077.9545 32844.9500   172%     -   23s
     0     0 30154.2983    0  248 12077.9545 30154.2983   150%     -   27s
     0     0 29371.3856    0  297 12077.9545 29371.3856   143%     -   30s
     0     0 28850.0091    0  283 12077.9545 28850.0091   139%     -   33s
     0     0 28824.0902    0  291 12077.9545 28824.0902   139%     -   33s
     0     0 28821.0535    0  293 12077.9545 28821.0535   139%     -   34s
     0     0 28820.8947    0  294 12077.9545 28820.8947   139%     -   34s
     0     0 27372.5274    0  372 12077.9545 27372.5274   127%     -   42s
     0     0 26921.2162    0  390 12077.9545 26921.2162   123%     -   46s
     0     0 26847.6670    0  390 12077.9545 26847.6670   122%     -   48s
     0     0 26758.3065    0  388 12077.9545 26758.3065   122%     -   49s
     0     0 26735.2989    0  392 12077.9545 26735.2989   121%     -   50s
     0     0 26717.2714    0  391 12077.9545 26717.2714   121%     -   50s
     0     0 26705.6252    0  393 12077.9545 26705.6252   121%     -   51s
     0     0 26694.3536    0  401 12077.9545 26694.3536   121%     -   51s
     0     0 26692.2555    0  403 12077.9545 26692.2555   121%     -   51s
     0     0 26690.4822    0  394 12077.9545 26690.4822   121%     -   52s
     0     0 26689.7769    0  399 12077.9545 26689.7769   121%     -   52s
H    0     0                    12118.946762 26335.1902   117%     -   58s
H    0     0                    12282.291936 26335.1902   114%     -   58s
     0     0 26335.1902    0  385 12282.2919 26335.1902   114%     -   58s
     0     0 26149.1218    0  378 12282.2919 26149.1218   113%     -   61s
     0     0 26113.2741    0  379 12282.2919 26113.2741   113%     -   62s
     0     0 26104.0896    0  379 12282.2919 26104.0896   113%     -   63s
     0     0 26097.9097    0  385 12282.2919 26097.9097   112%     -   64s
     0     0 26095.3344    0  389 12282.2919 26095.3344   112%     -   64s
     0     0 26090.0843    0  381 12282.2919 26090.0843   112%     -   64s
     0     0 26089.4354    0  389 12282.2919 26089.4354   112%     -   64s
H    0     0                    12412.230249 26053.4954   110%     -   66s
     0     0 26053.4954    0  425 12412.2302 26053.4954   110%     -   66s
     0     0 26047.5313    0  395 12412.2302 26047.5313   110%     -   66s
     0     0 26037.9575    0  392 12412.2302 26037.9575   110%     -   67s
     0     0 26034.4475    0  394 12412.2302 26034.4475   110%     -   67s
     0     0 26034.0476    0  397 12412.2302 26034.0476   110%     -   68s
     0     0 26008.2906    0  429 12412.2302 26008.2906   110%     -   69s
     0     0 26005.7947    0  381 12412.2302 26005.7947   110%     -   70s
     0     0 26005.3578    0  396 12412.2302 26005.3578   110%     -   70s
     0     0 25997.3706    0  396 12412.2302 25997.3706   109%     -   71s
     0     0 25993.5219    0  389 12412.2302 25993.5219   109%     -   72s
     0     0 25983.1456    0  397 12412.2302 25983.1456   109%     -   73s
H    0     0                    12417.249226 25981.3110   109%     -   74s
     0     0 25981.3110    0  420 12417.2492 25981.3110   109%     -   74s
     0     0 25980.1287    0  397 12417.2492 25980.1287   109%     -   74s
     0     0 25967.9254    0  393 12417.2492 25967.9254   109%     -   75s
     0     0 25955.2078    0  399 12417.2492 25955.2078   109%     -   76s
     0     0 25954.8168    0  396 12417.2492 25954.8168   109%     -   76s
     0     0 25948.8947    0  390 12417.2492 25948.8947   109%     -   77s
     0     0 25945.2461    0  398 12417.2492 25945.2461   109%     -   78s
     0     0 25944.8325    0  404 12417.2492 25944.8325   109%     -   78s
     0     0 25935.5107    0  411 12417.2492 25935.5107   109%     -   79s
     0     0 25933.8259    0  414 12417.2492 25933.8259   109%     -   80s
     0     0 25933.4364    0  414 12417.2492 25933.4364   109%     -   80s
     0     0 25932.2562    0  403 12417.2492 25932.2562   109%     -   81s
     0     0 25931.1304    0  413 12417.2492 25931.1304   109%     -   81s
     0     0 25931.1304    0  412 12417.2492 25931.1304   109%     -   82s
     0     0 25931.1304    0  412 12417.2492 25931.1304   109%     -   82s
     0     2 25931.1304    0  412 12417.2492 25931.1304   109%     -   94s
     1     4 25763.1811    1  392 12417.2492 25928.8346   109%  1990   95s
     3     8 25600.5491    2  425 12417.2492 25850.1341   108%  2600  100s
    15    32 25151.8135    4  457 12417.2492 25401.1050   105%  4195  112s
    31    51 22762.1028    5  425 12417.2492 25151.8130   103%  5920  124s
    50    83 23745.8719    6  361 12417.2492 25150.8982   103%  5667  130s
    82   172 23555.4720    7  346 12417.2492 25150.8982   103%  4421  140s
   175   293 22947.2894   11  401 12417.2492 25150.8982   103%  2814  145s
   298   378 22893.4366   12  313 12417.2492 25150.8982   103%  2175  151s
   383   414 22845.6150   13  389 12417.2492 25150.8982   103%  2018  155s
   419   462 22699.7307   12  414 12417.2492 25150.8982   103%  1968  160s
   467   521 23047.0668   13  387 12417.2492 25150.8982   103%  2018  166s
   530   573 22517.5892   12  389 12417.2492 25150.8982   103%  1966  171s
   598   628 22601.9985   13  370 12417.2492 25150.8982   103%  1932  181s
   665   676 22810.6521   13  316 12417.2492 25150.8982   103%  1958  186s
   742   707 19757.2064   14  340 12417.2492 25150.8982   103%  1932  191s
   841   738 20903.7011   14  357 12417.2492 25150.8982   103%  1858  201s
   916   782 21027.0169   14  364 12417.2492 24655.0148  98.6%  1917  211s
   986   848 19946.7975   14  359 12417.2492 24655.0148  98.6%  1988  216s
  1058   907 20082.9272   14  313 12417.2492 24306.1048  95.7%  2031  221s
  1119   967 20356.5973   14  307 12417.2492 24306.1048  95.7%  2004  225s
  1213  1006 20158.6192   14  287 12417.2492 24306.1048  95.7%  1975  230s
  1257  1055 20628.8168   15  330 12417.2492 24306.1048  95.7%  1984  237s
  1346  1120 20606.5332   16  332 12417.2492 24306.1048  95.7%  1969  243s
  1451  1196 20276.9493   17  272 12417.2492 24306.1048  95.7%  1941  249s
  1577  1281 19019.5096   19  318 12417.2492 24306.1048  95.7%  1915  254s
  1694  1380 18881.5429   20  327 12417.2492 24306.1048  95.7%  1889  259s
  1829  1494 18023.5690   20  286 12417.2492 24306.1048  95.7%  1865  266s
  1999  1572 18227.8539   21  359 12417.2492 24306.1048  95.7%  1821  272s
  2157  1617 13701.4745   22  117 12417.2492 23613.1480  90.2%  1791  278s
  2251  1686 14675.9244   21  382 12417.2492 23613.1480  90.2%  1806  282s
  2362  1773 infeasible   23      12417.2492 23613.1480  90.2%  1817  291s
  2511  1881 19763.3504    8  431 12417.2492 23613.1480  90.2%  1821  298s
  2706  1977 19354.9583   10  408 12417.2492 23613.1480  90.2%  1786  306s
  2929  2058 17950.6059   13  295 12417.2492 23297.7686  87.6%  1752  319s
  3100  2179 17070.3006   15  252 12417.2492 22990.5654  85.2%  1752  327s
  3267  2285     cutoff   19      12417.2492 22990.5654  85.2%  1763  334s
  3449  2386 12595.0175   20  225 12417.2492 22990.5654  85.2%  1735  343s
  3650  2508 13333.8384   22  215 12417.2492 22990.5654  85.2%  1724  351s
  3854  2638 17090.5782    9  232 12417.2492 22990.5654  85.2%  1726  361s
  4073  2639 18066.9197   14  412 12417.2492 22990.5654  85.2%  1732  385s
  4075  2640 19484.4788   11  115 12417.2492 22990.5654  85.2%  1731  405s
  4076  2641 19545.1031   15  369 12417.2492 22990.5654  85.2%  1731  415s
  4077  2642 21057.3665    8  386 12417.2492 22990.5654  85.2%  1730  422s
  4078  2642 18360.6871   13  457 12417.2492 22990.5654  85.2%  1730  427s
  4079  2643 21851.7072   10  376 12417.2492 22990.5654  85.2%  1729  431s
  4081  2644 18453.4878   21  391 12417.2492 22990.5654  85.2%  1729  435s
  4085  2647 18384.5774   15  436 12417.2492 22990.5654  85.2%  1727  442s
  4087  2648 20865.1322   13  384 12417.2492 22990.5654  85.2%  1726  446s
  4090  2650 19927.9340    9  441 12417.2492 22990.5654  85.2%  1725  452s
  4092  2652 18708.7763   12  444 12417.2492 22990.5654  85.2%  1724  457s
  4094  2653 14369.4878   18  427 12417.2492 22990.5654  85.2%  1723  464s
  4095  2654 19231.3203   10  432 12417.2492 22990.5654  85.2%  1723  466s
  4097  2655 20666.0227   17  444 12417.2492 22990.5654  85.2%  1722  471s
  4099  2656 16845.2368   21  504 12417.2492 22990.5654  85.2%  1721  478s
  4100  2657 22139.0789   14  489 12417.2492 22990.5654  85.2%  1721  481s
  4102  2658 16946.5874   14  435 12417.2492 22990.5654  85.2%  1720  504s
  4103  2659 16881.4185   21  435 12417.2492 22990.5654  85.2%  1719  519s
  4104  2663 22990.5654   13  428 12417.2492 22990.5654  85.2%  1747  529s
  4106  2666 22990.5654   14  388 12417.2492 22990.5654  85.2%  1749  539s
  4110  2673 22990.5654   15  453 12417.2492 22990.5654  85.2%  1754  546s
  4118  2686 22990.5654   16  468 12417.2492 22990.5654  85.2%  1764  558s
  4134  2697 16105.5393   17  261 12417.2492 22990.5654  85.2%  1776  572s
  4152  2719 21537.2733   18  326 12417.2492 22990.5654  85.2%  1810  586s
  4184  2760 21267.3729   19  326 12417.2492 22990.5654  85.2%  1831  599s
  4240  2803 18635.0891   20  309 12417.2492 22990.5654  85.2%  1851  610s
  4344  2800 17608.3607   21  326 12417.2492 22990.5654  85.2%  1886  622s
  4450  2794 19542.4705   20  375 12417.2492 22990.5654  85.2%  1900  632s
  4543  2803 16966.0580   22  258 12417.2492 22990.5654  85.2%  1918  641s
  4637  2794     cutoff   22      12417.2492 22869.9633  84.2%  1935  648s
  4687  2812 16235.1626   24  201 12417.2492 22252.0031  79.2%  1943  654s
  4750  2816 15762.6438   25  276 12417.2492 22252.0031  79.2%  1947  662s
  4813  2827     cutoff   25      12417.2492 21481.1688  73.0%  1952  669s
  4877  2847 15487.8859   25  213 12417.2492 21481.1688  73.0%  1967  675s
  4935  2862 15063.2842   27  186 12417.2492 21481.1688  73.0%  1978  683s
  5007  2861     cutoff   29      12417.2492 20905.5750  68.4%  1988  688s
  5046  2876     cutoff   28      12417.2492 20905.5750  68.4%  1994  693s
  5092  2879 14124.6791   32  222 12417.2492 20905.5750  68.4%  2000  700s
  5134  2885 13853.6774   33  228 12417.2492 20905.5750  68.4%  2005  707s
  5190  2892 13877.8039   33  220 12417.2492 20905.5750  68.4%  2011  714s
  5265  2884 13575.7838   36  235 12417.2492 20691.8541  66.6%  2006  720s
  5371  2874 14018.6647   26  252 12417.2492 20691.8541  66.6%  1995  731s
  5471  2849 12925.0380   28  311 12417.2492 20691.8541  66.6%  1995  740s
  5582  2844     cutoff   28      12417.2492 20253.5120  63.1%  2000  752s
  5676  2836 16133.4416   22  275 12417.2492 19898.1517  60.2%  2017  760s
  5775  2820 13745.1461   23  306 12417.2492 19898.1517  60.2%  2025  769s
  5885  2816     cutoff   23      12417.2492 19646.8551  58.2%  2040  777s
  6005  2800     cutoff   22      12417.2492 19646.8551  58.2%  2049  786s
  6136  2788 14102.7939   23  297 12417.2492 19446.5913  56.6%  2054  795s
  6290  2786 13409.2728   25  246 12417.2492 19446.5913  56.6%  2051  806s
  6427  2763     cutoff   25      12417.2492 19256.2765  55.1%  2054  816s
  6568  2755 14445.1135   22  380 12417.2492 19256.2765  55.1%  2066  825s
  6710  2750 13668.0556   24  362 12417.2492 19082.7412  53.7%  2071  836s
  6860  2716     cutoff   20      12417.2492 19082.7412  53.7%  2075  847s
  7045  2694 13956.8575   21  329 12417.2492 18881.6872  52.1%  2080  857s
  7188  2681 12648.8377   23  316 12417.2492 18881.6872  52.1%  2073  867s
  7370  2664 12508.0379   24  314 12417.2492 18881.6872  52.1%  2073  879s
  7572  2642 12562.5096   25  377 12417.2492 18041.2098  45.3%  2073  894s
  7782  2622 14127.0378   23  250 12417.2492 17620.9100  41.9%  2072  908s
  8007  2590     cutoff   27      12417.2492 17538.2451  41.2%  2073  921s
  8270  2545 14309.1274   22  233 12417.2492 17452.3016  40.5%  2066  937s
  8488  2512     cutoff   24      12417.2492 17375.0483  39.9%  2064  950s
  8765  2397 12952.0173   24  344 12417.2492 17375.0483  39.9%  2059  963s
  9109  2302     cutoff   26      12417.2492 17159.7742  38.2%  2041  977s
  9433  2213     cutoff   22      12417.2492 16664.0386  34.2%  2031  991s
  9776  2132 12464.1898   29  201 12417.2492 16499.5977  32.9%  2027 1005s
 10093  2038     cutoff   27      12417.2492 16499.5977  32.9%  2016 1020s
 10478  1873 12856.3354   26  292 12417.2492 16032.0687  29.1%  2007 1035s
 10956  1671     cutoff   24      12417.2492 16032.0687  29.1%  1984 1052s
 11529  1390     cutoff   23      12417.2492 15572.5436  25.4%  1949 1068s
 12077  1017     cutoff   22      12417.2492 15218.1318  22.6%  1924 1085s
 12673   556     cutoff   21      12417.2492 14819.6111  19.3%  1895 1103s
 13688   148 infeasible   31      12417.2492 14484.5244  16.6%  1809 1124s
H13754   148                    12426.801721 14387.8038  15.8%  1802 1124s
H13762   148                    12427.277747 14387.8038  15.8%  1801 1124s
H13776   148                    12434.908141 14387.8038  15.7%  1800 1124s
H13819   148                    12463.079262 14285.9789  14.6%  1796 1124s
H13825   148                    12482.143601 14285.9789  14.5%  1795 1124s
H13829   148                    12498.717963 14285.9789  14.3%  1794 1124s
 14680    29 12598.2668   38   93 12498.7180 14093.4200  12.8%  1715 1127s
*15086    29              58    12512.148893 13755.9436  9.94%  1671 1127s

Cutting planes:
  Learned: 1
  Gomory: 8
  MIR: 372
  Mixing: 1
  Flow cover: 969
  RLT: 15
  Relax-and-lift: 79

Explored 15283 nodes (25326797 simplex iterations) in 1127.54 seconds (2119.26 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 12512.1 12498.7 12482.1 ... 12282.3

Optimal solution found (tolerance 1.00e-04)
Best objective 1.251214889343e+04, best bound 1.251214889343e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 1127.55s
  Master Objective (UB) = 12512.15, θ = 152059.37
  Upper Bound (UB) = 12512.15

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 152059.37
  [DEBUG]   ✓ Scenario 0: θ = 152059.37 ≤ Q = 152059.37 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 152059.37 ≤ Q = 152059.37 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 152059.37 ≤ Q = 152059.37 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 152059.37 ≤ Q = 152059.37 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x3b421930
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x3b421930
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [7e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.421298e+13
Presolve removed 2589 rows and 1882 columns
Presolve time: 0.01s
Presolved: 504 rows, 507 columns, 1421 nonzeros
Found heuristic solution: objective 7441740.2872
Variable types: 343 continuous, 164 integer (164 binary)

Root relaxation: objective -1.423318e+05, 249 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -142331.80    0  122 7441740.29 -142331.80   102%     -    0s
H    0     0                    -105536.7307 -142331.80  34.9%     -    0s
H    0     0                    -111581.5695 -142331.80  27.6%     -    0s
H    0     0                    -113119.0494 -126307.74  11.7%     -    0s
H    0     0                    -114564.8257 -126307.74  10.3%     -    0s
     0     0 -126307.74    0  128 -114564.83 -126307.74  10.3%     -    0s
H    0     0                    -122269.7211 -126261.13  3.26%     -    0s
     0     0 -125863.38    0  116 -122269.72 -125863.38  2.94%     -    0s
     0     0 -125240.40    0  112 -122269.72 -125240.40  2.43%     -    0s
H    0     0                    -123850.9458 -125200.16  1.09%     -    0s
     0     0 -125200.16    0  107 -123850.95 -125200.16  1.09%     -    0s
     0     0 -124891.65    0  108 -123850.95 -124891.65  0.84%     -    0s
     0     0 -124804.80    0  109 -123850.95 -124804.80  0.77%     -    0s
     0     0 -124803.54    0   99 -123850.95 -124803.54  0.77%     -    0s
     0     0 -124451.23    0   79 -123850.95 -124451.23  0.48%     -    0s
     0     0 -124432.39    0   87 -123850.95 -124432.39  0.47%     -    0s
     0     0 -124407.12    0   87 -123850.95 -124407.12  0.45%     -    0s
     0     0 -124403.11    0   88 -123850.95 -124403.11  0.45%     -    0s
     0     0 -124287.40    0   82 -123850.95 -124287.40  0.35%     -    0s
     0     0 -124269.20    0   82 -123850.95 -124269.20  0.34%     -    0s
     0     2 -124269.20    0   82 -123850.95 -124269.20  0.34%     -    0s
H   36    18                    -123861.7940 -124052.56  0.15%  18.7    0s
H   39    18                    -123861.8800 -124050.92  0.15%  18.4    0s

Cutting planes:
  Gomory: 15
  Implied bound: 10
  MIR: 147
  Flow cover: 14
  RLT: 71
  Relax-and-lift: 2

Explored 246 nodes (3069 simplex iterations) in 0.19 seconds (0.08 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -123862 -123862 -123851 ... 1.4213e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.238618799898e+05, best bound -1.238703905617e+05, gap 0.0069%
  Subproblem solved in 0.22s
  Worst-case operational profit (Z_SP) = 134980.12
  Scenario: 60 demand increases, 0 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -123861.88
  [DEBUG]   S×d_nominal = 258842.00
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 258842.00 + -123861.88 = 134980.12
  [DEBUG]   Current θ from Master = 152059.37
  [DEBUG]   ⚠️  Z_SP ≤ θ by 17079.25 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -4567.11
  Lower Bound (LB) = 3932.29
  Gap (UB-LB) = 8579.8559, Absolute Gap = 8579.8559, Relative Gap = 0.685722
  Not converged yet (gap = 8579.86 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 60 increases, 0 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221704 nonzeros
Model fingerprint: 0x9a997221
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 34380 rows and 13960 columns
Presolve time: 1.08s
Presolved: 43453 rows, 19500 columns, 269299 nonzeros
Variable types: 17241 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -359784.4177
Found heuristic solution: objective -183019.6155

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 43453 rows, 19500 columns, 269299 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   25413   -7.7442561e+03   0.000000e+00   3.079680e+06      5s
   35430    7.6821490e+03   0.000000e+00   1.507057e+06     10s
   45458    1.7928720e+04   0.000000e+00   5.453225e+06     15s
Concurrent spin time: 3.98s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 3.506984e+04, 37623 iterations, 15.49 seconds (19.49 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 35069.8381    0  118 -183019.62 35069.8381   119%     -   17s
H    0     0                    -173113.9610 35069.8381   120%     -   17s
H    0     0                    -68322.95029 35069.8381   151%     -   17s
H    0     0                    -8210.766374 35069.8381   527%     -   17s
H    0     0                    -6275.401792 35069.8381   659%     -   18s
H    0     0                    -5767.516571 35069.8381   708%     -   18s
H    0     0                    -5760.344170 35069.8381   709%     -   18s
H    0     0                    -5656.766829 35069.8381   720%     -   18s
H    0     0                    -5635.839567 35069.8381   722%     -   18s
H    0     0                    -5607.917452 35069.8381   725%     -   18s
     0     0 30200.2068    0  179 -5607.9175 30200.2068   639%     -   25s
     0     0 29651.6551    0  206 -5607.9175 29651.6551   629%     -   28s
     0     0 29651.6551    0  213 -5607.9175 29651.6551   629%     -   28s
     0     0 29651.6433    0  216 -5607.9175 29651.6433   629%     -   28s
     0     0 27654.6526    0  228 -5607.9175 27654.6526   593%     -   33s
     0     0 26560.3088    0  270 -5607.9175 26560.3088   574%     -   38s
     0     0 26420.5317    0  277 -5607.9175 26420.5317   571%     -   40s
     0     0 26376.2532    0  265 -5607.9175 26376.2532   570%     -   41s
     0     0 26331.1819    0  256 -5607.9175 26331.1819   570%     -   42s
     0     0 26330.4029    0  265 -5607.9175 26330.4029   570%     -   43s
     0     0 24758.8647    0  314 -5607.9175 24758.8647   541%     -   52s
H    0     0                    -1318.787519 24202.6600  1935%     -   58s
H    0     0                    -1176.763719 24202.6600  2157%     -   58s
H    0     0                    -1123.356992 24202.6600  2254%     -   58s
H    0     0                     277.6827907 24202.6600  8616%     -   58s
H    0     0                     331.2413756 24202.6600  7207%     -   58s
H    0     0                     426.3375761 24202.6600  5577%     -   58s
     0     0 24202.6600    0  383  426.33758 24202.6600  5577%     -   58s
     0     0 23975.2088    0  380  426.33758 23975.2088  5524%     -   60s
     0     0 23821.1078    0  380  426.33758 23821.1078  5487%     -   64s
     0     0 23784.2683    0  379  426.33758 23784.2683  5479%     -   65s
     0     0 23776.3201    0  391  426.33758 23776.3201  5477%     -   65s
     0     0 23765.8750    0  384  426.33758 23765.8750  5474%     -   66s
     0     0 23759.6947    0  378  426.33758 23759.6947  5473%     -   66s
     0     0 23747.6905    0  375  426.33758 23747.6905  5470%     -   67s
     0     0 23745.5214    0  373  426.33758 23745.5214  5470%     -   68s
     0     0 23742.6560    0  390  426.33758 23742.6560  5469%     -   68s
     0     0 23735.2820    0  384  426.33758 23735.2820  5467%     -   68s
     0     0 23732.8496    0  377  426.33758 23732.8496  5467%     -   69s
     0     0 23732.7065    0  383  426.33758 23732.7065  5467%     -   69s
H    0     0                    1205.2835272 23218.0461  1826%     -   75s
H    0     0                    1557.3395788 23218.0461  1391%     -   75s
H    0     0                    1565.1127461 23218.0461  1383%     -   75s
     0     0 23218.0461    0  393 1565.11275 23218.0461  1383%     -   75s
     0     0 22966.1979    0  398 1565.11275 22966.1979  1367%     -   79s
     0     0 22885.1897    0  402 1565.11275 22885.1897  1362%     -   80s
     0     0 22854.1632    0  415 1565.11275 22854.1632  1360%     -   80s
     0     0 22842.3096    0  409 1565.11275 22842.3096  1359%     -   81s
     0     0 22828.1927    0  379 1565.11275 22828.1927  1359%     -   82s
     0     0 22817.6575    0  415 1565.11275 22817.6575  1358%     -   82s
     0     0 22812.9851    0  458 1565.11275 22812.9851  1358%     -   83s
     0     0 22812.0502    0  462 1565.11275 22812.0502  1358%     -   83s
H    0     0                    1572.8097750 22812.0502  1350%     -   84s
     0     0 22763.9995    0  441 1572.80977 22763.9995  1347%     -   86s
     0     0 22755.8489    0  401 1572.80977 22755.8489  1347%     -   87s
     0     0 22754.4491    0  503 1572.80977 22754.4491  1347%     -   87s
     0     0 22742.1821    0  454 1572.80977 22742.1821  1346%     -   89s
     0     0 22738.4197    0  472 1572.80977 22738.4197  1346%     -   91s
     0     0 22737.6805    0  413 1572.80977 22737.6805  1346%     -   91s
     0     0 22664.5618    0  408 1572.80977 22664.5618  1341%     -   94s
H    0     0                    1600.7346674 22663.9679  1316%     -   94s
     0     0 22650.8202    0  421 1600.73467 22650.8202  1315%     -   95s
     0     0 22648.2621    0  469 1600.73467 22648.2621  1315%     -   95s
     0     0 22647.0074    0  461 1600.73467 22647.0074  1315%     -   95s
     0     0 22642.5608    0  459 1600.73467 22642.5608  1315%     -   97s
H    0     0                    1714.1499835 22640.7536  1221%     -  100s
     0     0 22640.7536    0  472 1714.14998 22640.7536  1221%     -  101s
     0     0 22636.3217    0  404 1714.14998 22636.3217  1221%     -  102s
H    0     0                    1761.8540918 22635.3251  1185%     -  102s
H    0     0                    1764.5501294 22635.3251  1183%     -  102s
     0     0 22635.1966    0  472 1764.55013 22635.1966  1183%     -  102s
     0     0 22633.7681    0  473 1764.55013 22633.7681  1183%     -  104s
     0     0 22632.6452    0  479 1764.55013 22632.6452  1183%     -  104s
     0     0 22573.6066    0  421 1764.55013 22573.6066  1179%     -  106s
     0     0 22565.6718    0  478 1764.55013 22565.6718  1179%     -  107s
     0     0 22564.9207    0  436 1764.55013 22564.9207  1179%     -  107s
     0     0 22563.8440    0  427 1764.55013 22563.8440  1179%     -  108s
     0     0 22562.4712    0  485 1764.55013 22562.4712  1179%     -  108s
     0     0 22561.3798    0  481 1764.55013 22561.3798  1179%     -  110s
     0     0 22556.9550    0  432 1764.55013 22556.9550  1178%     -  110s
     0     0 22505.4764    0  437 1764.55013 22505.4764  1175%     -  112s
     0     0 22501.8991    0  484 1764.55013 22501.8991  1175%     -  113s
     0     0 22501.6793    0  422 1764.55013 22501.6793  1175%     -  113s
     0     0 22497.4037    0  440 1764.55013 22497.4037  1175%     -  115s
     0     0 22495.4607    0  417 1764.55013 22495.4607  1175%     -  115s
     0     0 22495.2160    0  412 1764.55013 22495.2160  1175%     -  115s
     0     0 22493.6293    0  423 1764.55013 22493.6293  1175%     -  116s
     0     0 22492.7483    0  434 1764.55013 22492.7483  1175%     -  117s
     0     0 22491.9843    0  478 1764.55013 22491.9843  1175%     -  118s
     0     0 22491.7233    0  478 1764.55013 22491.7233  1175%     -  119s
H    0     0                    1880.9341894 22491.7233  1096%     -  133s
H    0     0                    1999.2898142 22491.7233  1025%     -  133s
     0     2 22491.7233    0  478 1999.28981 22491.7233  1025%     -  134s
     1     4 22382.2943    1  374 1999.28981 22491.4702  1025%  2305  135s
     7    16 21445.7557    3  365 1999.28981 22249.9994  1013%  3545  146s
    15    32 21238.4457    4  385 1999.28981 22037.1367  1002%  4636  152s
    31    49 17912.3056    5  296 1999.28981 21862.4720   994%  6843  166s
    48    81 17424.1182    6  287 1999.28981 21862.4720   994%  6551  186s
H   79    81                    2008.1368289 21862.4720   989%  5224  186s
    80   236 17305.8840    7  276 2008.13683 21862.4720   989%  5180  197s
   235   291 17151.0808    8  267 2008.13683 21862.4720   989%  2889  204s
H  241   291                    2058.7006861 21862.4720   962%  2878  204s
H  283   291                    2086.9042623 21862.4720   948%  2701  204s
   290   390 16318.1634   11  257 2086.90426 21862.4720   948%  2661  213s
   390   422 16028.6262   12  249 2086.90426 21862.4720   948%  2370  219s
   422   454 15869.0438   15  228 2086.90426 21862.4720   948%  2366  225s
H  423   454                    3733.3110452 21862.4720   486%  2360  225s
H  427   454                    4744.5859570 21862.4720   361%  2349  225s
H  444   454                    5167.1605532 21862.4720   323%  2354  225s
H  446   454                    5279.2329762 21862.4720   314%  2352  225s
H  452   454                    5431.9649477 21862.4720   302%  2361  225s
   454   478 15960.9888   14  226 5431.96495 21862.4720   302%  2357  231s
H  456   478                    6278.5406337 21862.4720   248%  2360  231s
   494   529 15767.3401   15  233 6278.54063 21862.4720   248%  2364  239s
   582   556 15054.6631   16  241 6278.54063 21862.4720   248%  2366  246s
   619   585 15565.7403   15  229 6278.54063 21862.4720   248%  2371  256s
H  626   585                    7536.2633888 21862.4720   190%  2393  256s
   652   646 15218.2899   16  222 7536.26339 21862.4720   190%  2405  266s
   743   670 11877.1994   16  215 7536.26339 21862.4720   190%  2333  276s
H  746   670                    7724.3976072 21862.4720   183%  2331  276s
   779   748 14377.1101   17  267 7724.39761 21862.4720   183%  2344  283s
   865   836 14134.5567   17  264 7724.39761 21862.4720   183%  2297  288s
   965   916 11834.7956   18  232 7724.39761 21862.4720   183%  2233  298s
  1079   947 13441.5669   18  225 7724.39761 21862.4720   183%  2165  307s
H 1080   947                    8013.0657654 21862.4720   173%  2163  307s
H 1083   947                    8671.2938078 21862.4720   152%  2162  307s
  1112  1051 14779.3207   17  286 8671.29381 21862.4720   152%  2181  317s
  1242  1143 12627.5721   18  267 8671.29381 21862.4720   152%  2101  323s
  1350  1248 13477.7216   19  247 8671.29381 21433.0318   147%  2059  330s
  1483  1329 13001.0449   22  227 8671.29381 21362.5369   146%  2018  336s
  1582  1422 12974.5028   24  281 8671.29381 21362.5369   146%  2032  343s
  1695  1534 12807.0675   25  271 8671.29381 21362.5369   146%  2028  353s
  1841  1621 12502.4076   25  282 8671.29381 21362.5369   146%  1995  364s
  1976  1678 12388.2141   28  227 8671.29381 20930.2812   141%  1990  376s
  2081  1714     cutoff   28      8671.29381 20930.2812   141%  2043  386s
H 2179  1742                    8829.0369697 20930.2812   137%  2098  391s
H 2181  1742                    8916.4900878 20930.2812   135%  2100  391s
H 2185  1742                    9214.3902839 20930.2812   127%  2103  391s
H 2215  1763                    9386.0913197 20930.2812   123%  2146  396s
H 2217  1763                    9507.5296467 20930.2812   120%  2149  396s
H 2225  1763                    9664.5345436 20930.2812   117%  2154  396s
  2258  1824 infeasible   33      9664.53454 20930.2812   117%  2188  403s
  2339  1856 15081.7412   11  261 9664.53454 20930.2812   117%  2254  411s
  2445  1865 15074.1889   12  259 9664.53454 20930.2812   117%  2276  420s
  2578  1963     cutoff   15      9664.53454 20848.1061   116%  2281  431s
  2721  2082     cutoff   16      9664.53454 20759.0169   115%  2285  444s
H 2900  2111                    9668.6309991 20759.0169   115%  2268  456s
H 2902  2107                    9733.9777785 20759.0169   113%  2267  456s
H 2904  2088                    9915.2621909 20759.0169   109%  2269  456s
  2933  2155 11210.0431   16  241 9915.26219 20759.0169   109%  2287  465s
  3126  2180 12116.3613    7  225 9915.26219 20363.7436   105%  2274  474s
H 3127  2180                    9919.4176380 20363.7436   105%  2274  474s
H 3129  2180                    9931.6865490 20363.7436   105%  2275  474s
H 3131  2180                    9935.3202326 20363.7436   105%  2275  474s
H 3147  2178                    9944.7462080 20363.7436   105%  2293  474s
  3179  2271     cutoff    8      9944.74621 20363.7436   105%  2303  482s
  3350  2371 11661.8481    8  217 9944.74621 19814.6705  99.2%  2306  493s
  3549  2493 10293.1296   10  214 9944.74621 19784.7512  98.9%  2291  507s
  3771  2557 14559.7994    7  366 9944.74621 19784.7512  98.9%  2286  519s
H 3799  2556                    9955.8467406 19784.7512  98.7%  2287  519s
  3879  2669 13571.4675    8  353 9955.84674 19662.8026  97.5%  2298  533s
  4112  2795 12484.4988   10  279 9955.84674 19532.4872  96.2%  2287  545s
H 4352  2795                    9956.6815370 19498.1106  95.8%  2278  571s
  4353  2796 16339.3583   13  478 9956.68154 19498.1106  95.8%  2278  608s
  4355  2797 10497.8713   28  118 9956.68154 19498.1106  95.8%  2277  627s
  4356  2798 14176.4563   13  260 9956.68154 19498.1106  95.8%  2276  640s
  4357  2799 15550.3766   31  370 9956.68154 19498.1106  95.8%  2276  650s
  4358  2799 10269.3787   41  439 9956.68154 19498.1106  95.8%  2275  657s
  4359  2800 12900.1716   24  405 9956.68154 19498.1106  95.8%  2275  661s
  4361  2801 15302.4715   13  377 9956.68154 19498.1106  95.8%  2274  669s
  4362  2802 12062.0282   19  436 9956.68154 19498.1106  95.8%  2273  670s
  4365  2804 12540.7342   38  436 9956.68154 19498.1106  95.8%  2271  677s
  4367  2805 11801.9075   20  483 9956.68154 19498.1106  95.8%  2270  680s
  4368  2806 11441.8633   37  437 9956.68154 19498.1106  95.8%  2270  686s
  4370  2807 16322.4119   23  527 9956.68154 19498.1106  95.8%  2269  692s
  4372  2809 13188.7710   20  480 9956.68154 19498.1106  95.8%  2268  699s
  4373  2809 15417.8502   25  419 9956.68154 19498.1106  95.8%  2267  700s
  4375  2811 12993.0198   51  470 9956.68154 19498.1106  95.8%  2266  706s
  4377  2812 14536.3001   28  491 9956.68154 19498.1106  95.8%  2265  711s
  4379  2813 14174.5593   11  416 9956.68154 19498.1106  95.8%  2264  733s
  4380  2814 18063.5173    9  416 9956.68154 19498.1106  95.8%  2264  745s
  4381  2818 19498.1106   16  479 9956.68154 19498.1106  95.8%  2292  761s
  4383  2821 19498.1106   17  455 9956.68154 19498.1106  95.8%  2294  766s
  4387  2828 19498.1106   18  453 9956.68154 19498.1106  95.8%  2294  777s
  4395  2841 19498.1106   19  373 9956.68154 19498.1106  95.8%  2295  793s
  4411  2860 19498.1106   20  432 9956.68154 19498.1106  95.8%  2323  806s
  4443  2861 17976.8904   21  463 9956.68154 19498.1106  95.8%  2351  825s
  4455  2883 15637.2831   22  477 9956.68154 19498.1106  95.8%  2367  840s
  4491  2894 14371.3882   23  358 9956.68154 19498.1106  95.8%  2442  851s
H 4523  2741                    9973.1810431 19498.1106  95.5%  2459  851s
  4528  2800 14231.5992   24  359 9973.18104 19498.1106  95.5%  2463  864s
  4629  2788 11282.9358   27  296 9973.18104 19498.1106  95.5%  2475  872s
  4671  2798 10960.3261   28  311 9973.18104 19498.1106  95.5%  2473  883s
  4715  2826 10866.4976   29  310 9973.18104 19498.1106  95.5%  2472  890s
  4796  2818     cutoff   31      9973.18104 19498.1106  95.5%  2456  900s
  4905  2813 14378.7626   23  397 9973.18104 19498.1106  95.5%  2436  908s
  4997  2810 14047.4564   24  343 9973.18104 18693.1927  87.4%  2424  917s
  5072  2804 13598.8965   25  254 9973.18104 18076.9156  81.3%  2416  925s
  5156  2784 12054.7461   27  301 9973.18104 18076.9156  81.3%  2406  935s
  5234  2776 12036.4110   28  301 9973.18104 16883.3131  69.3%  2397  946s
  5304  2782 10834.6129   30  232 9973.18104 16883.3131  69.3%  2394  952s
  5371  2773 10331.4181   32  231 9973.18104 16762.0077  68.1%  2392  963s
  5466  2738 12629.9833   25  403 9973.18104 16762.0077  68.1%  2380  975s
  5570  2735     cutoff   26      9973.18104 16762.0077  68.1%  2371  984s
  5648  2704 12210.7595   26  326 9973.18104 16762.0077  68.1%  2373  996s
  5766  2676     cutoff   35      9973.18104 15283.2436  53.2%  2359 1007s
  5862  2646     cutoff   29      9973.18104 15128.2924  51.7%  2356 1017s
  5976  2611 12328.7017   24  285 9973.18104 14853.7963  48.9%  2351 1029s
  6074  2571     cutoff   25      9973.18104 14511.6338  45.5%  2351 1042s
  6202  2525     cutoff   27      9973.18104 14454.5246  44.9%  2342 1052s
  6334  2471 12266.3039   28  278 9973.18104 14265.4643  43.0%  2333 1061s
  6464  2420     cutoff   25      9973.18104 13942.0466  39.8%  2326 1073s
  6548  2387 11648.9118   24  375 9973.18104 13942.0466  39.8%  2323 1083s
  6675  2312 11382.9598   25  306 9973.18104 13942.0466  39.8%  2313 1095s
  6828  2221     cutoff   26      9973.18104 13598.2242  36.3%  2300 1108s
  7023  2113 12126.8147   28  357 9973.18104 13298.1477  33.3%  2282 1121s
  7201  2000 10166.9940   30  305 9973.18104 13175.2475  32.1%  2270 1133s
  7441  1832     cutoff   22      9973.18104 12575.1329  26.1%  2238 1144s
  7686  1653 10629.2142   29  283 9973.18104 12006.9381  20.4%  2207 1156s
  7964  1507     cutoff   31      9973.18104 11542.6929  15.7%  2155 1165s

Cutting planes:
  Learned: 2
  Gomory: 6
  MIR: 330
  Flow cover: 901
  RLT: 11
  Relax-and-lift: 75

Explored 8345 nodes (17425459 simplex iterations) in 1168.45 seconds (2161.26 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 9973.18 9956.68 9955.85 ... 9668.63

Optimal solution found (tolerance 1.00e-04)
Best objective 9.973181043100e+03, best bound 9.973181043100e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 1168.46s
  Master Objective (UB) = 9973.18, θ = 153192.78
  Upper Bound (UB) = 9973.18

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 153192.78
  [DEBUG]   ✓ Scenario 0: θ = 153192.78 ≤ Q = 153192.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 153192.78 ≤ Q = 153192.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 153192.78 ≤ Q = 153192.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 153192.78 ≤ Q = 153192.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 153192.78 ≤ Q = 153192.78 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x5adb41e6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x5adb41e6
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.244406e+13
Presolve removed 2593 rows and 1884 columns
Presolve time: 0.01s
Presolved: 500 rows, 505 columns, 1411 nonzeros
Found heuristic solution: objective 6113433.3390
Variable types: 342 continuous, 163 integer (163 binary)
Found heuristic solution: objective 6113039.3356

Root relaxation: objective -1.400190e+05, 258 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -140018.97    0  129 6113039.34 -140018.97   102%     -    0s
H    0     0                    -100938.5838 -140018.97  38.7%     -    0s
H    0     0                    -101396.6240 -140018.97  38.1%     -    0s
H    0     0                    -106940.3821 -118330.99  10.7%     -    0s
H    0     0                    -114078.9499 -118330.99  3.73%     -    0s
H    0     0                    -117796.8086 -118330.99  0.45%     -    0s
     0     0 -118330.99    0   24 -117796.81 -118330.99  0.45%     -    0s
     0     0 -118126.17    0   21 -117796.81 -118126.17  0.28%     -    0s
     0     0 -118126.17    0   20 -117796.81 -118126.17  0.28%     -    0s
     0     0 -118126.17    0   19 -117796.81 -118126.17  0.28%     -    0s
H    0     0                    -117888.7566 -118063.76  0.15%     -    0s
     0     0 -118028.62    0   16 -117888.76 -118028.62  0.12%     -    0s
     0     0 -118028.62    0   10 -117888.76 -118028.62  0.12%     -    0s
     0     0 -118028.62    0   10 -117888.76 -118028.62  0.12%     -    0s
H    0     0                    -118015.0535 -118028.62  0.01%     -    0s

Cutting planes:
  Gomory: 8
  Implied bound: 3
  MIR: 106
  Flow cover: 1
  RLT: 29
  BQP: 2

Explored 1 nodes (438 simplex iterations) in 0.04 seconds (0.02 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -118015 -117797 -114079 ... 1.24441e+13
No other solutions better than -118015

Optimal solution found (tolerance 1.00e-04)
Best objective -1.180150534885e+05, best bound -1.180150534885e+05, gap 0.0000%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 144072.40
  Scenario: 7 demand increases, 53 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -118015.05
  [DEBUG]   S×d_nominal = 262087.46
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 262087.46 + -118015.05 = 144072.40
  [DEBUG]   Current θ from Master = 153192.78
  [DEBUG]   ⚠️  Z_SP ≤ θ by 9120.38 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 852.80
  Lower Bound (LB) = 3932.29
  Gap (UB-LB) = 6040.8880, Absolute Gap = 6040.8880, Relative Gap = 0.605713
  Not converged yet (gap = 6040.89 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 7 increases, 53 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 264941 nonzeros
Model fingerprint: 0x241d0fe1
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 41268 rows and 16758 columns
Presolve time: 1.39s
Presolved: 51855 rows, 22942 columns, 322019 nonzeros
Variable types: 20683 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -359784.4177
Found heuristic solution: objective -183019.6155

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 51855 rows, 22942 columns, 322019 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   28289   -5.1116659e+04   0.000000e+00   5.506781e+07      5s
   39844   -2.3232246e+03   0.000000e+00   2.821915e+06     10s
   48355    8.8004098e+03   0.000000e+00   1.979754e+06     15s
   54571    1.3765501e+04   0.000000e+00   3.136565e+06     20s
   60741    1.5559507e+04   0.000000e+00   5.490014e+06     25s
Concurrent spin time: 2.63s

Solved with dual simplex

Root relaxation: objective 3.506980e+04, 43069 iterations, 28.52 seconds (37.10 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 35069.7983    0  120 -183019.62 35069.7983   119%     -   30s
H    0     0                    -175863.8484 35069.7983   120%     -   30s
H    0     0                    -168531.2171 35069.7983   121%     -   30s
H    0     0                    -68527.62237 35069.7983   151%     -   30s
H    0     0                    -8072.668307 35069.7983   534%     -   31s
H    0     0                    -6652.739888 35069.7983   627%     -   31s
H    0     0                    -6624.270350 35069.7983   629%     -   31s
H    0     0                    -6445.378803 35069.7983   644%     -   31s
H    0     0                    -5958.705766 35069.7983   689%     -   31s
H    0     0                    -5655.621560 35069.7983   720%     -   31s
H    0     0                    -5635.839567 35069.7983   722%     -   31s
H    0     0                    -5607.917452 35069.7983   725%     -   31s
     0     0 30342.2702    0  157 -5607.9175 30342.2702   641%     -   40s
     0     0 29812.1868    0  164 -5607.9175 29812.1868   632%     -   45s
     0     0 29812.1868    0  166 -5607.9175 29812.1868   632%     -   46s
     0     0 29811.6393    0  174 -5607.9175 29811.6393   632%     -   46s
     0     0 29811.4004    0  170 -5607.9175 29811.4004   632%     -   47s
     0     0 27425.1597    0  217 -5607.9175 27425.1597   589%     -   54s
H    0     0                    -1655.187562 27423.9832  1757%     -   55s
H    0     0                    -633.3398123 27423.9832  4430%     -   55s
H    0     0                    -293.2516906 27423.9832  9452%     -   55s
H    0     0                     -78.1652209 27423.9832      -     -   55s
H    0     0                     275.4161051 27423.9832  9857%     -   55s
     0     0 26890.2850    0  266  275.41611 26890.2850  9664%     -   60s
     0     0 26820.7943    0  235  275.41611 26820.7943  9638%     -   63s
     0     0 26817.3743    0  244  275.41611 26817.3743  9637%     -   64s
     0     0 26814.4788    0  248  275.41611 26814.4788  9636%     -   64s
     0     0 26813.0741    0  242  275.41611 26813.0741  9635%     -   65s
     0     0 26811.7600    0  235  275.41611 26811.7600  9635%     -   65s
     0     0 26811.1370    0  238  275.41611 26811.1370  9635%     -   65s
     0     0 24756.6072    0  373  275.41611 24756.6072  8889%     -   85s
H    0     0                     302.5017584 24756.2623  8084%     -   85s
     0     0 23996.1705    0  381  302.50176 23996.1705  7833%     -   91s
     0     0 23844.4021    0  378  302.50176 23844.4021  7782%     -   95s
     0     0 23796.5728    0  395  302.50176 23796.5728  7767%     -   97s
     0     0 23755.5853    0  397  302.50176 23755.5853  7753%     -   98s
     0     0 23750.5689    0  389  302.50176 23750.5689  7751%     -   99s
     0     0 23748.1304    0  387  302.50176 23748.1304  7751%     -   99s
     0     0 23744.9531    0  385  302.50176 23744.9531  7750%     -  100s
     0     0 23744.8473    0  385  302.50176 23744.8473  7749%     -  100s
     0     0 23082.8737    0  346  302.50176 23082.8737  7531%     -  114s
     0     0 22852.9716    0  441  302.50176 22852.9716  7455%     -  118s
     0     0 22819.4707    0  371  302.50176 22819.4707  7444%     -  119s
     0     0 22803.8429    0  414  302.50176 22803.8429  7438%     -  120s
     0     0 22802.4512    0  414  302.50176 22802.4512  7438%     -  120s
     0     0 22768.8562    0  509  302.50176 22768.8562  7427%     -  123s
     0     0 22761.8488    0  499  302.50176 22761.8488  7425%     -  124s
     0     0 22759.9956    0  469  302.50176 22759.9956  7424%     -  125s
     0     0 22755.9968    0  460  302.50176 22755.9968  7423%     -  125s
     0     0 22755.3016    0  454  302.50176 22755.3016  7422%     -  126s
     0     0 22735.4187    0  457  302.50176 22735.4187  7416%     -  127s
     0     0 22724.1764    0  450  302.50176 22724.1764  7412%     -  130s
     0     0 22723.6501    0  451  302.50176 22723.6501  7412%     -  130s
     0     0 22702.4009    0  418  302.50176 22702.4009  7405%     -  132s
     0     0 22697.9104    0  416  302.50176 22697.9104  7403%     -  134s
     0     0 22694.1811    0  421  302.50176 22694.1811  7402%     -  134s
     0     0 22693.6312    0  465  302.50176 22693.6312  7402%     -  135s
     0     0 22690.6730    0  430  302.50176 22690.6730  7401%     -  137s
H    0     0                     314.4618046 22689.7294  7115%     -  139s
H    0     0                     393.0360501 22689.7294  5673%     -  139s
H    0     0                     439.1127408 22689.7294  5067%     -  139s
     0     0 22689.7294    0  428  439.11274 22689.7294  5067%     -  139s
     0     0 22685.1038    0  448  439.11274 22685.1038  5066%     -  141s
     0     0 22682.6355    0  463  439.11274 22682.6355  5066%     -  142s
     0     0 22681.7479    0  432  439.11274 22681.7479  5065%     -  142s
     0     0 22681.5652    0  434  439.11274 22681.5652  5065%     -  143s
     0     0 22680.2646    0  434  439.11274 22680.2646  5065%     -  145s
H    0     0                     466.1983941 22679.6768  4765%     -  162s
H    0     0                     804.8530008 22679.6768  2718%     -  162s
H    0     0                    1139.2838589 22679.6768  1891%     -  162s
H    0     0                    1173.0269720 22679.6768  1833%     -  162s
H    0     0                    1236.8918701 22679.6768  1734%     -  162s
H    0     0                    1245.7388848 22679.6768  1721%     -  163s
H    0     2                    8540.1214047 22679.6768   166%     -  180s
     0     2 22679.6768    0  434 8540.12140 22679.6768   166%     -  180s
     3     8 22359.4583    2  458 8540.12140 22522.6953   164%  4402  191s
     7    16 22091.2655    3  369 8540.12140 22358.6448   162%  5490  200s
    15    32 21552.8755    4  360 8540.12140 22082.9031   159%  6293  208s
    31    45 14887.9727    5  263 8540.12140 21552.7184   152%  8904  230s
    48    75 18500.8946    6  358 8540.12140 21552.0631   152% 10426  255s
H   80   147                    8679.1219066 21386.9376   146%  8235  272s
H   85   147                    8774.9160104 21386.9376   144%  7874  272s
H   89   147                    9151.1418755 21386.9376   134%  7686  272s
H  116   147                    9268.1967148 21386.9376   131%  6577  272s
H  158   229                    9571.0224638 21278.0775   122%  5841  286s
   262   330 17625.1626   12  386 9571.02246 21278.0775   122%  4738  297s
   375   403 17759.4891   12  381 9571.02246 21278.0775   122%  3955  310s
H  394   403                    9588.6941250 21278.0775   122%  3840  310s
   456   479 17630.1316   13  319 9588.69412 21278.0775   122%  3616  318s
   548   532 14146.4025   12  224 9588.69412 21278.0775   122%  3355  324s
   637   577 17368.3045   13  327 9588.69412 21278.0775   122%  3130  335s
   732   630 17405.3279   13  364 9588.69412 21271.8424   122%  2977  342s
   813   681 17664.5932   13  326 9588.69412 21271.8424   122%  2927  351s
   876   708 16752.7112   14  329 9588.69412 21125.4412   120%  2988  361s
   927   747 16854.3954   14  311 9588.69412 21125.4412   120%  3030  372s
   986   803 17095.8995   14  265 9588.69412 21125.4412   120%  3047  380s
  1060   841 16814.4581   14  301 9588.69412 21125.4412   120%  3036  385s
  1102   868 17302.5680   14  372 9588.69412 21125.4412   120%  3059  393s
H 1103   868                    9593.6572144 21125.4412   120%  3056  393s
  1139   940 14141.5738   14  212 9593.65721 21125.4412   120%  3078  399s
  1243   966 16688.4855   15  362 9593.65721 21125.4412   120%  3015  410s
  1279   993 16946.8834   15  321 9593.65721 21125.4412   120%  3025  422s
  1326  1037 16752.1008   16  364 9593.65721 21125.4412   120%  3024  432s
  1384  1086 16666.1165   16  360 9593.65721 21125.4412   120%  3040  445s
  1458  1172 16724.8488   17  365 9593.65721 21125.4412   120%  3048  456s
  1556  1250 16385.9721   20  358 9593.65721 21125.4412   120%  3013  469s
  1664  1352 16214.1114   21  388 9593.65721 21125.4412   120%  2994  482s
  1782  1481 15759.8939   23  397 9593.65721 21125.4412   120%  2958  491s
  1930  1608 15929.8024   24  428 9593.65721 20952.1891   118%  2890  504s
  2128  1676 15618.5943   28  369 9593.65721 20952.1891   118%  2800  516s
  2260  1739 14968.0984   31  381 9593.65721 20828.4369   117%  2833  529s
  2370  1810     cutoff   30      9593.65721 20527.9970   114%  2899  542s
  2479  1906 12436.4458   32  357 9593.65721 20479.5366   113%  2966  552s
  2619  1971     cutoff   32      9593.65721 20479.5366   113%  2982  567s
  2774  2037 11654.9519   35  298 9593.65721 20479.5366   113%  2984  581s
  2904  2086 11107.4630   35  230 9593.65721 20208.3966   111%  3031  595s
  3003  2180 15024.4180   11  279 9593.65721 20155.6313   110%  3046  607s
  3157  2243 13725.8122   16  233 9593.65721 20155.6313   110%  3025  622s
  3306  2351 12481.7213   20  206 9593.65721 20094.3801   109%  3035  637s
  3461  2446 11901.0334   29  165 9593.65721 20094.3801   109%  3046  653s
  3614  2551 16708.5889   15  338 9593.65721 20094.3801   109%  3080  669s
  3761  2654 11343.4237   17  283 9593.65721 20094.3801   109%  3111  685s
H 3938  2654                    9602.2721320 20094.3801   109%  3122  692s
  3939  2655 16797.3541   10  434 9602.27213 20094.3801   109%  3121  722s
  3941  2656 16178.5715   10  120 9602.27213 20094.3801   109%  3119  748s
  3942  2657 11422.6530   20  241 9602.27213 20094.3801   109%  3119  768s
  3943  2658 11159.3284   17  334 9602.27213 20094.3801   109%  3118  777s
  3944  2658 14991.5420   14  423 9602.27213 20094.3801   109%  3117  786s
  3945  2659 12354.5845   19  386 9602.27213 20094.3801   109%  3116  795s
  3947  2660 12419.5841   35  362 9602.27213 20094.3801   109%  3115  800s
  3949  2662 15032.4344   40  451 9602.27213 20094.3801   109%  3113  805s
  3952  2664 15319.0555   26  433 9602.27213 20094.3801   109%  3111  812s
  3955  2666 11723.1745   27  421 9602.27213 20094.3801   109%  3108  818s
  3956  2666 11919.8088   43  439 9602.27213 20094.3801   109%  3108  822s
  3957  2667 15295.2642   17  452 9602.27213 20094.3801   109%  3107  828s
  3958  2668 11786.2681   31  398 9602.27213 20094.3801   109%  3106  830s
  3960  2669 14072.3708   15  448 9602.27213 20094.3801   109%  3104  837s
  3962  2670 19229.5291    9  445 9602.27213 20094.3801   109%  3103  844s
  3963  2671 14916.7074   15  498 9602.27213 20094.3801   109%  3102  846s
  3964  2672 19093.0176   10  513 9602.27213 20094.3801   109%  3101  852s
  3965  2672 15555.8079   17  518 9602.27213 20094.3801   109%  3101  855s
  3966  2673 14228.9959   34  412 9602.27213 20094.3801   109%  3100  860s
  3968  2674 10850.8835   38  455 9602.27213 20094.3801   109%  3098  867s
  3969  2675 14280.5985   20  455 9602.27213 20094.3801   109%  3097  893s
  3970  2676 10834.3400   32  455 9602.27213 20094.3801   109%  3097  921s
  3971  2679 20094.3801   13  407 9602.27213 20094.3801   109%  3134  931s
  3973  2683 20094.3801   14  400 9602.27213 20094.3801   109%  3136  946s
  3977  2689 20094.3801   15  451 9602.27213 20094.3801   109%  3136  962s
  3985  2703 20094.3801   16  527 9602.27213 20094.3801   109%  3144  976s
  4001  2712 19590.1487   17  459 9602.27213 20094.3801   109%  3173 1003s
  4018  2735 16224.3306   18  267 9602.27213 20094.3801   109%  3188 1021s
  4050  2800 13978.7614   19  271 9602.27213 20094.3801   109%  3223 1043s
  4132  2805 12772.5433   20  276 9602.27213 20094.3801   109%  3265 1053s
  4166  2825 12651.2104   20  309 9602.27213 20094.3801   109%  3268 1068s
  4224  2825 12307.4507   21  266 9602.27213 20094.3801   109%  3262 1088s
  4311  2812 12278.2370   21  258 9602.27213 20094.3801   109%  3244 1113s
  4385  2818 12167.3438   21  272 9602.27213 20094.3801   109%  3241 1131s
  4461  2811 12097.9884   22  230 9602.27213 20094.3801   109%  3227 1148s
  4550  2804 11194.5465   27  207 9602.27213 20094.3801   109%  3213 1162s
  4629  2793 10759.5929   30  267 9602.27213 20094.3801   109%  3203 1175s
  4703  2779     cutoff   31      9602.27213 20094.3801   109%  3197 1189s
  4752  2780 13403.9704   24  461 9602.27213 20094.3801   109%  3195 1203s
  4811  2770 9739.93983   26  348 9602.27213 20094.3801   109%  3203 1216s
  4852  2769     cutoff   27      9602.27213 20094.3801   109%  3205 1228s
  4908  2747     cutoff   27      9602.27213 20094.3801   109%  3204 1242s
  4977  2731     cutoff   26      9602.27213 20094.3801   109%  3198 1257s
  5048  2732     cutoff   26      9602.27213 18991.4826  97.8%  3190 1272s
  5123  2735 13402.4202   20  405 9602.27213 18991.4826  97.8%  3187 1288s
  5212  2740 11459.6893   21  357 9602.27213 18991.4826  97.8%  3178 1304s
  5300  2729 11072.8815   22  366 9602.27213 17734.9875  84.7%  3175 1321s
  5374  2711 10648.9879   23  368 9602.27213 17039.3424  77.5%  3169 1338s
  5473  2699 10781.7171   23  293 9602.27213 16231.8185  69.0%  3158 1354s
  5571  2686     cutoff   24      9602.27213 15892.7503  65.5%  3152 1373s
  5671  2666     cutoff   25      9602.27213 15778.5043  64.3%  3151 1391s
  5798  2646     cutoff   26      9602.27213 15591.7245  62.4%  3132 1408s
  5942  2619 10701.6989   25  356 9602.27213 15268.0513  59.0%  3112 1427s
  6070  2586 9956.54142   26  341 9602.27213 15237.4133  58.7%  3097 1447s
  6228  2541     cutoff   27      9602.27213 15237.4133  58.7%  3076 1461s
  6281  2525     cutoff   27      9602.27213 14565.1983  51.7%  3071 1477s
  6345  2515 10839.2074   27  361 9602.27213 14564.6993  51.7%  3066 1496s
  6404  2498 10691.0274   28  322 9602.27213 14564.6993  51.7%  3061 1513s
H 6405  2363                    9688.1161062 14564.6993  50.3%  3061 1513s
  6468  2373 10443.4914   29  339 9688.11611 14564.6993  50.3%  3054 1533s
  6664  2329     cutoff   27      9688.11611 13794.6890  42.4%  3019 1556s
H 6665  2201                    9704.0740479 13794.6890  42.2%  3019 1556s
H 6841  2021                    9711.8397143 13746.6715  41.5%  2991 1556s
  6880  2052 10356.9278   20  341 9711.83971 13484.0970  38.8%  2981 1578s
  7103  1965 10066.1295   27  221 9711.83971 13484.0970  38.8%  2947 1601s
H 7263  1797                    9712.8528217 13164.3803  35.5%  2921 1601s
  7372  1749 infeasible   34      9712.85282 13149.1684  35.4%  2898 1628s
  7652  1634 10059.0407   28  312 9712.85282 12995.7056  33.8%  2853 1648s
H 7702  1509                    9717.4656312 12981.2343  33.6%  2850 1648s
  7803  1417 10128.1122   29  245 9717.46563 12884.2256  32.6%  2835 1672s
  8124  1266     cutoff   25      9717.46563 12380.0246  27.4%  2782 1695s
  8441  1075 10824.0136   38  254 9717.46563 11993.3319  23.4%  2739 1718s
H 8450   968                    9721.1625440 11993.3319  23.4%  2736 1718s
  8882   638     cutoff   23      9721.16254 11797.4706  21.4%  2656 1738s
  9340   264 9857.47360   29  284 9721.16254 11260.9354  15.8%  2566 1755s
  9938    48     cutoff   25      9721.16254 10512.7345  8.14%  2437 1760s

Cutting planes:
  Learned: 1
  Gomory: 5
  MIR: 556
  Mixing: 1
  Flow cover: 1286
  RLT: 16
  Relax-and-lift: 107

Explored 10741 nodes (24468352 simplex iterations) in 1764.26 seconds (3340.97 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 9721.16 9717.47 9712.85 ... 9571.02

Optimal solution found (tolerance 1.00e-04)
Best objective 9.721162543968e+03, best bound 9.721162543968e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 1764.28s
  Master Objective (UB) = 9721.16, θ = 153195.99
  Upper Bound (UB) = 9721.16

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 153195.99
  [DEBUG]   ✓ Scenario 0: θ = 153195.99 ≤ Q = 153195.99 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 153195.99 ≤ Q = 153195.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 153195.99 ≤ Q = 153195.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 153195.99 ≤ Q = 153195.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 153195.99 ≤ Q = 153195.99 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 153195.99 ≤ Q = 153195.99 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x6183a621
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x6183a621
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.250565e+13
Presolve removed 2593 rows and 1884 columns
Presolve time: 0.01s
Presolved: 500 rows, 505 columns, 1411 nonzeros
Found heuristic solution: objective 6148214.7498
Variable types: 342 continuous, 163 integer (163 binary)
Found heuristic solution: objective 6147820.7463

Root relaxation: objective -1.396449e+05, 243 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -139644.91    0  121 6147820.75 -139644.91   102%     -    0s
H    0     0                    -97766.46944 -139644.91  42.8%     -    0s
H    0     0                    -104625.7268 -139644.91  33.5%     -    0s
H    0     0                    -105794.9126 -139644.91  32.0%     -    0s
H    0     0                    -105999.8065 -139464.25  31.6%     -    0s
     0     0 -116957.61    0  113 -105999.81 -116957.61  10.3%     -    0s
H    0     0                    -112368.2282 -116956.03  4.08%     -    0s
H    0     0                    -112702.2429 -116956.03  3.77%     -    0s
H    0     0                    -113882.8651 -116956.03  2.70%     -    0s
H    0     0                    -114216.8798 -116956.03  2.40%     -    0s
     0     0 -116470.24    0  107 -114216.88 -116470.24  1.97%     -    0s
H    0     0                    -115238.5391 -116465.52  1.06%     -    0s
H    0     0                    -115395.3787 -116465.52  0.93%     -    0s
     0     0 -116083.07    0   49 -115395.38 -116083.07  0.60%     -    0s
H    0     0                    -115421.9606 -116026.86  0.52%     -    0s
     0     0 -116026.86    0   48 -115421.96 -116026.86  0.52%     -    0s
     0     0 -116022.68    0   75 -115421.96 -116022.68  0.52%     -    0s
     0     0 -115659.32    0   22 -115421.96 -115659.32  0.21%     -    0s
     0     0 -115602.13    0   21 -115421.96 -115602.13  0.16%     -    0s
     0     0 -115513.84    0   11 -115421.96 -115513.84  0.08%     -    0s
     0     0 -115508.76    0   10 -115421.96 -115508.76  0.08%     -    0s
H    0     0                    -115431.5240 -115508.76  0.07%     -    0s
     0     0 -115508.76    0   11 -115431.52 -115508.76  0.07%     -    0s
     0     0 -115491.83    0   10 -115431.52 -115491.83  0.05%     -    0s
     0     0 -115491.83    0   34 -115431.52 -115491.83  0.05%     -    0s
     0     0 -115491.83    0   35 -115431.52 -115491.83  0.05%     -    0s
     0     0 -115445.78    0    6 -115431.52 -115445.78  0.01%     -    0s

Cutting planes:
  Gomory: 1
  Implied bound: 2
  MIR: 22
  Flow cover: 15
  RLT: 1
  PSD: 1

Explored 1 nodes (798 simplex iterations) in 0.13 seconds (0.05 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -115432 -115422 -115395 ... -97766.5

Optimal solution found (tolerance 1.00e-04)
Best objective -1.154315240472e+05, best bound -1.154410202887e+05, gap 0.0082%
  Subproblem solved in 0.16s
  Worst-case operational profit (Z_SP) = 146445.14
  Scenario: 29 demand increases, 31 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -115431.52
  [DEBUG]   S×d_nominal = 261876.66
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 261876.66 + -115431.52 = 146445.14
  [DEBUG]   Current θ from Master = 153195.99
  [DEBUG]   ⚠️  Z_SP ≤ θ by 6750.85 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 2970.31
  Lower Bound (LB) = 3932.29
  Gap (UB-LB) = 5788.8695, Absolute Gap = 5788.8695, Relative Gap = 0.595491
  Not converged yet (gap = 5788.87 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 29 increases, 31 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308178 nonzeros
Model fingerprint: 0xd694e8bc
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 48136 rows and 19546 columns
Presolve time: 2.11s
Presolved: 60277 rows, 26394 columns, 374799 nonzeros
Variable types: 24135 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -359784.4177
Found heuristic solution: objective -183019.6155

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 60277 rows, 26394 columns, 374799 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   22815   -1.6568073e+05   0.000000e+00   1.386268e+09      5s
   35741   -1.7058687e+03   0.000000e+00   7.130179e+06     10s
   44994    1.3994105e+04   0.000000e+00   6.993696e+06     15s
   51369    1.7206020e+04   0.000000e+00   7.229125e+06     20s
   57497    1.8731790e+04   0.000000e+00   2.977751e+06     25s
   63489    1.9794726e+04   0.000000e+00   3.176518e+08     30s
   70156    2.4166795e+04   0.000000e+00   1.317727e+07     35s
Concurrent spin time: 11.16s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 3.506980e+04, 68374 iterations, 46.24 seconds (54.75 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 35069.7983    0  120 -183019.62 35069.7983   119%     -   49s
H    0     0                    -176482.4138 35069.7983   120%     -   49s
H    0     0                    -86455.70311 35069.7983   141%     -   49s
H    0     0                    -86192.09353 35069.7983   141%     -   49s
H    0     0                    -27871.03396 35069.7983   226%     -   49s
H    0     0                    -24586.53347 35069.7983   243%     -   49s
H    0     0                    -7093.773131 35069.7983   594%     -   49s
H    0     0                    -6252.653140 35069.7983   661%     -   50s
H    0     0                    -6149.029508 35069.7983   670%     -   50s
H    0     0                    -6111.869678 35069.7983   674%     -   50s
H    0     0                    -5893.588476 35069.7983   695%     -   50s
H    0     0                    -5607.917452 35069.7983   725%     -   50s
     0     0 30006.3257    0  165 -5607.9175 30006.3257   635%     -   65s
     0     0 29507.1445    0  175 -5607.9175 29507.1445   626%     -   71s
     0     0 29507.1445    0  213 -5607.9175 29507.1445   626%     -   73s
     0     0 29507.1445    0  216 -5607.9175 29507.1445   626%     -   73s
     0     0 27511.8834    0  193 -5607.9175 27511.8834   591%     -   82s
H    0     0                    -2092.752483 27511.8834  1415%     -   83s
H    0     0                    -2082.030887 27511.8834  1421%     -   83s
H    0     0                      45.4443009 27511.8834      -     -   83s
H    0     0                      56.1658971 27511.8834      -     -   83s
H    0     0                     163.0172868 27511.8834      -     -   83s
H    0     0                     232.5086489 27511.8834      -     -   83s
     0     0 26731.8907    0  293  232.50865 26731.8907      -     -   92s
     0     0 26474.5766    0  268  232.50865 26474.5766      -     -   96s
     0     0 26425.7007    0  281  232.50865 26425.7007      -     -   98s
     0     0 26363.9417    0  279  232.50865 26363.9417      -     -  101s
     0     0 26351.3341    0  311  232.50865 26351.3341      -     -  102s
     0     0 26342.2430    0  292  232.50865 26342.2430      -     -  103s
     0     0 26339.9042    0  287  232.50865 26339.9042      -     -  103s
     0     0 26339.8615    0  287  232.50865 26339.8615      -     -  103s
     0     0 24701.0033    0  345  232.50865 24701.0033      -     -  126s
     0     0 24125.4469    0  369  232.50865 24125.4469      -     -  132s
     0     0 24003.0107    0  377  232.50865 24003.0107      -     -  137s
     0     0 23950.4413    0  369  232.50865 23950.4413      -     -  139s
     0     0 23784.9943    0  365  232.50865 23784.9943      -     -  143s
     0     0 23760.6024    0  375  232.50865 23760.6024      -     -  145s
     0     0 23758.6030    0  370  232.50865 23758.6030      -     -  145s
     0     0 23755.0151    0  383  232.50865 23755.0151      -     -  146s
     0     0 23752.4389    0  379  232.50865 23752.4389      -     -  147s
     0     0 23748.9504    0  387  232.50865 23748.9504      -     -  148s
     0     0 23748.5902    0  392  232.50865 23748.5902      -     -  148s
     0     0 23219.3058    0  343  232.50865 23219.3058  9886%     -  162s
     0     0 23088.5606    0  367  232.50865 23088.5606  9830%     -  167s
H    0     0                    1717.7575371 23003.3339  1239%     -  169s
H    0     0                    6010.1904916 23003.3339   283%     -  169s
H    0     0                    7056.1308946 23003.3339   226%     -  169s
H    0     0                    7099.7671431 23003.3339   224%     -  169s
H    0     0                    7179.0008554 23003.3339   220%     -  169s
H    0     0                    7399.3600242 23003.3339   211%     -  169s
     0     0 23003.3339    0  372 7399.36002 23003.3339   211%     -  169s
     0     0 22972.5620    0  368 7399.36002 22972.5620   210%     -  171s
H    0     0                    7429.6208846 22929.2717   209%     -  173s
     0     0 22929.2717    0  395 7429.62088 22929.2717   209%     -  173s
     0     0 22897.4808    0  416 7429.62088 22897.4808   208%     -  175s
     0     0 22884.3712    0  375 7429.62088 22884.3712   208%     -  177s
     0     0 22879.4031    0  368 7429.62088 22879.4031   208%     -  177s
     0     0 22877.5597    0  375 7429.62088 22877.5597   208%     -  177s
     0     0 22877.0218    0  373 7429.62088 22877.0218   208%     -  178s
     0     0 22795.4330    0  410 7429.62088 22795.4330   207%     -  181s
     0     0 22783.5601    0  411 7429.62088 22783.5601   207%     -  182s
     0     0 22777.7875    0  420 7429.62088 22777.7875   207%     -  183s
     0     0 22776.6658    0  464 7429.62088 22776.6658   207%     -  184s
     0     0 22753.0752    0  456 7429.62088 22753.0752   206%     -  187s
     0     0 22747.7706    0  414 7429.62088 22747.7706   206%     -  189s
     0     0 22742.6137    0  411 7429.62088 22742.6137   206%     -  190s
H    0     0                    7453.4959545 22741.4836   205%     -  190s
     0     0 22741.4836    0  414 7453.49595 22741.4836   205%     -  190s
     0     0 22727.4023    0  408 7453.49595 22727.4023   205%     -  193s
H    0     0                    7495.9744910 22726.1441   203%     -  194s
     0     0 22720.9088    0  404 7495.97449 22720.9088   203%     -  194s
     0     0 22711.4896    0  424 7495.97449 22711.4896   203%     -  195s
     0     0 22711.2041    0  427 7495.97449 22711.2041   203%     -  196s
     0     0 22707.8793    0  457 7495.97449 22707.8793   203%     -  197s
H    0     0                    7528.2084561 22707.2813   202%     -  199s
H    0     0                    7570.9001717 22707.2813   200%     -  199s
H    0     0                    7583.8129464 22707.2813   199%     -  199s
H    0     0                    7642.9715119 22707.2813   197%     -  199s
H    0     0                    7675.6018224 22707.2813   196%     -  199s
     0     0 22707.0124    0  418 7675.60182 22707.0124   196%     -  199s
     0     0 22703.8370    0  394 7675.60182 22703.8370   196%     -  201s
     0     0 22703.4927    0  410 7675.60182 22703.4927   196%     -  202s
     0     0 22701.9788    0  453 7675.60182 22701.9788   196%     -  203s
     0     0 22701.5037    0  453 7675.60182 22701.5037   196%     -  206s
     0     0 22701.1500    0  418 7675.60182 22701.1500   196%     -  207s
     0     0 22700.9093    0  424 7675.60182 22700.9093   196%     -  208s
     0     0 22700.6047    0  416 7675.60182 22700.6047   196%     -  209s
     0     0 22695.8736    0  416 7675.60182 22695.8736   196%     -  211s
H    0     0                    7874.3784493 22695.8736   188%     -  232s
H    0     0                    7918.8602437 22695.8736   187%     -  232s
H    0     0                    7941.8714205 22695.8736   186%     -  235s
H    0     0                    8451.4320914 22695.8736   169%     -  235s
H    0     0                    8582.1160753 22695.8736   164%     -  235s
H    0     2                    8937.1855909 22695.8736   154%     -  276s
     0     2 22695.8736    0  416 8937.18559 22695.8736   154%     -  276s
     1     4 22472.8491    1  419 8937.18559 22688.2081   154%  7061  286s
     3     8 21919.7886    2  374 8937.18559 22471.4746   151%  9158  295s
     7    16 21263.9180    3  428 8937.18559 22160.9295   148%  9497  308s
    15    32 21155.3447    4  451 8937.18559 21668.3789   142%  9146  319s
    31    50 11049.7540    5  235 8937.18559 21551.7313   141% 10797  350s
    49    80 16802.5905    6  289 8937.18559 21551.5013   141% 12496  362s
    81   142 16709.4263    7  279 8937.18559 21551.5013   141%  9607  380s
   143   213 15532.8041    8  270 8937.18559 21551.5013   141%  6862  398s
   240   267 13423.3484    9  294 8937.18559 21551.5013   141%  5298  411s
H  251   267                    8964.4818674 21551.5013   140%  5183  411s
H  271   267                    8979.8533161 21187.5701   136%  4932  411s
H  276   267                    9171.8570552 21187.5701   131%  4854  411s
H  284   267                    9383.0868034 21187.5701   126%  4790  411s
   330   281 10349.4488    9  220 9383.08680 21187.5701   126%  4418  424s
H  342   281                    9430.7807223 21187.5701   125%  4339  424s
   374   321 13233.0301   10  286 9430.78072 21187.5701   125%  4225  440s
H  409   321                    9477.2398160 21187.5701   124%  4038  440s
H  421   321                    9517.9085384 21187.5701   123%  4012  440s
   448   349 12633.9838   10  316 9517.90854 21187.5701   123%  3998  454s
   518   385 11685.2059   11  250 9517.90854 21187.5701   123%  3831  468s
H  529   385                    9603.0193268 21187.5701   121%  3819  468s
   581   423 11474.8715   11  300 9603.01933 21187.5701   121%  3737  480s
   653   457 11265.0253   12  301 9603.01933 21187.5701   121%  3606  493s
   717   492 11197.4768   13  244 9603.01933 21187.5701   121%  3523  506s
   782   517 15680.7716   10  428 9603.01933 21187.5701   121%  3485  518s
   843   550 15639.8217   11  375 9603.01933 21187.5701   121%  3444  532s
   916   569 15236.5523   13  397 9603.01933 21187.5701   121%  3339  545s
   951   587 15208.5373   14  360 9603.01933 21187.5701   121%  3353  556s
   993   602 13920.4447   15  370 9603.01933 20857.0226   117%  3345  567s
H 1001   602                    9633.4862831 20857.0226   117%  3327  567s
  1036   606 13889.0746   16  311 9633.48628 20857.0226   117%  3332  583s
  1084   621 13790.2842   17  352 9633.48628 20857.0226   117%  3333  596s
  1125   660 13626.4934   18  306 9633.48628 20857.0226   117%  3314  610s
  1196   687 13614.0874   19  346 9633.48628 20807.6219   116%  3261  627s
  1229   707 11027.7968   20  314 9633.48628 20807.6219   116%  3271  642s
  1283   729 11017.3604   21  304 9633.48628 20475.8023   113%  3255  657s
  1349   776 11002.7906   22  305 9633.48628 20264.6538   110%  3274  674s
H 1358   776                    9717.4656312 20264.6538   109%  3269  674s
  1422   850 10955.5041   23  313 9717.46563 20264.6538   109%  3244  689s
  1566   899     cutoff   29      9717.46563 20264.6538   109%  3098  707s
  1703   951 infeasible    9      9717.46563 19891.4177   105%  3008  725s
  1816  1008 11688.7367   11  319 9717.46563 19891.4177   105%  2983  744s
  1943  1057 13830.5928    7  360 9717.46563 19583.7210   102%  2931  766s
  2042  1090 12995.8725    8  378 9717.46563 19583.7210   102%  2942  786s
  2140  1101 12809.3771    9  382 9717.46563 19101.8258  96.6%  2957  806s
  2219  1179 12550.7811   10  383 9717.46563 18950.2011  95.0%  2960  826s
  2353  1264 12229.5104   12  386 9717.46563 18950.2011  95.0%  2909  846s
  2519  1318 11872.6347   16  404 9717.46563 18950.2011  95.0%  2851  868s
  2672  1350 11117.2737   20  375 9717.46563 18532.9928  90.7%  2830  892s
  2808  1364     cutoff   25      9717.46563 18515.8332  90.5%  2840  917s
  2952  1404     cutoff   12      9717.46563 18293.3259  88.3%  2856  940s
  3076  1436 11540.8388    8  341 9717.46563 18293.3259  88.3%  2883  967s
  3217  1472     cutoff   10      9717.46563 18293.3259  88.3%  2893  991s
  3325  1519 13936.0177   12  424 9717.46563 17808.1481  83.3%  2902 1019s
  3490  1541 13690.6474   13  411 9717.46563 17808.1481  83.3%  2887 1040s
  3542  1568 13601.2102   14  400 9717.46563 17808.1481  83.3%  2896 1068s
  3637  1606     cutoff   16      9717.46563 17808.1481  83.3%  2912 1097s
  3809  1702 11374.7146   17  294 9717.46563 17808.1481  83.3%  2902 1124s
  4032  1791     cutoff   20      9717.46563 17425.9948  79.3%  2869 1156s
  4279  1838     cutoff   24      9717.46563 17425.9948  79.3%  2843 1187s
  4536  1897 13279.8252   11  288 9717.46563 17096.2574  75.9%  2816 1223s
  4817  2008 11765.7697   37  252 9717.46563 17096.2574  75.9%  2784 1260s
  5109  2092     cutoff   17      9717.46563 16810.1839  73.0%  2755 1297s
  5383  2182 10507.9198   18  386 9717.46563 16669.0021  71.5%  2751 1337s
  5666  2228     cutoff   18      9717.46563 16562.5714  70.4%  2748 1373s
  5838  2308 10520.2677   16  377 9717.46563 16544.4519  70.3%  2762 1409s
  6102  2309 13175.8376   10  416 9717.46563 16405.0308  68.8%  2766 1464s
  6104  2310 10944.4721   36  120 9717.46563 16405.0308  68.8%  2765 1519s
  6105  2311 16023.3119   11  314 9717.46563 16405.0308  68.8%  2764 1545s
  6106  2312 15347.3750   18  359 9717.46563 16405.0308  68.8%  2764 1561s
  6107  2312 14247.0406   12  396 9717.46563 16405.0308  68.8%  2764 1570s
  6108  2313 11927.5525   37  389 9717.46563 16405.0308  68.8%  2763 1579s
  6109  2314 14784.5137   14  433 9717.46563 16405.0308  68.8%  2763 1586s
  6110  2314 10652.3565   21  374 9717.46563 16405.0308  68.8%  2762 1590s
  6112  2316 10865.6568   15  363 9717.46563 16405.0308  68.8%  2761 1595s
  6114  2317 10677.0932   21  408 9717.46563 16405.0308  68.8%  2760 1601s
  6115  2318 12481.1569   16  364 9717.46563 16405.0308  68.8%  2760 1606s
  6117  2319 10188.0688   33  374 9717.46563 16405.0308  68.8%  2759 1614s
  6118  2320 12404.6501   15  352 9717.46563 16405.0308  68.8%  2759 1617s
  6119  2320 14330.9691   16  428 9717.46563 16405.0308  68.8%  2758 1621s
  6121  2322 10831.1221   25  431 9717.46563 16405.0308  68.8%  2757 1627s
  6122  2322 10437.0534   18  390 9717.46563 16405.0308  68.8%  2757 1635s
  6124  2324 11212.9904   31  377 9717.46563 16405.0308  68.8%  2756 1644s
  6125  2324 14747.9518   12  441 9717.46563 16405.0308  68.8%  2755 1647s
  6126  2325 15351.4677   16  411 9717.46563 16405.0308  68.8%  2755 1652s
  6127  2326 12471.7149   14  411 9717.46563 16405.0308  68.8%  2755 1704s
  6128  2326 10357.5315   27  411 9717.46563 16405.0308  68.8%  2754 1729s
  6129  2330 16405.0308   15  407 9717.46563 16405.0308  68.8%  2787 1740s
  6131  2333 16405.0308   16  409 9717.46563 16405.0308  68.8%  2788 1756s
  6135  2340 16405.0308   17  404 9717.46563 16405.0308  68.8%  2789 1774s
  6143  2353 16405.0308   18  464 9717.46563 16405.0308  68.8%  2798 1791s
  6159  2364 16405.0308   19  465 9717.46563 16405.0308  68.8%  2822 1821s
  6175  2390 16405.0308   20  394 9717.46563 16405.0308  68.8%  2838 1846s
  6206  2445 16405.0308   21  388 9717.46563 16405.0308  68.8%  2865 1884s
  6276  2446 15568.3891   22  429 9717.46563 16405.0308  68.8%  2957 1903s
  6311  2455 16129.0761   23  424 9717.46563 16405.0308  68.8%  2960 1925s
  6352  2445 16229.4487   23  375 9717.46563 16405.0308  68.8%  2957 1939s
  6407  2449 15084.2994   23  527 9717.46563 16405.0308  68.8%  2957 1958s
  6445  2439 14925.0183   23  465 9717.46563 16405.0308  68.8%  2960 1977s
  6517  2420 14911.5890   24  421 9717.46563 16405.0308  68.8%  2961 1994s
  6570  2416 15734.4491   24  352 9717.46563 16405.0308  68.8%  2966 2009s
  6631  2396 14308.3910   24  387 9717.46563 16405.0308  68.8%  2964 2027s
  6681  2387 15489.8293   24  358 9717.46563 16405.0308  68.8%  2963 2043s
  6739  2390 12647.4778   24  376 9717.46563 16405.0308  68.8%  2967 2060s
  6801  2399 13137.3441   24  397 9717.46563 16405.0308  68.8%  2974 2078s
  6865  2419 14429.2143   24  465 9717.46563 16405.0308  68.8%  2974 2096s
  6935  2420 14365.4817   25  429 9717.46563 16405.0308  68.8%  2978 2111s
  7014  2417 14142.7177   26  325 9717.46563 16405.0308  68.8%  2976 2127s
  7081  2426 14117.3120   27  393 9717.46563 16405.0308  68.8%  2975 2143s
  7177  2418 14116.9980   28  334 9717.46563 16405.0308  68.8%  2969 2162s
  7278  2418 13622.7973   31  274 9717.46563 16405.0308  68.8%  2962 2178s
  7372  2411 13334.5483   31  301 9717.46563 16405.0308  68.8%  2962 2197s
  7481  2393 13054.3391   32  240 9717.46563 16132.4952  66.0%  2955 2216s
  7586  2374 11534.0720   34  216 9717.46563 16132.4952  66.0%  2955 2240s
  7702  2362 10089.7501   35  204 9717.46563 15733.3969  61.9%  2952 2260s
  7829  2318     cutoff   35      9717.46563 15733.3969  61.9%  2945 2282s
  7968  2275 10870.7645   23  317 9717.46563 15342.7276  57.9%  2940 2303s
  8123  2223     cutoff   26      9717.46563 15173.9843  56.2%  2927 2324s
  8255  2184 10452.1778   24  321 9717.46563 15173.9843  56.2%  2928 2348s
  8414  2131     cutoff   25      9717.46563 15173.9843  56.2%  2919 2371s
  8570  2102 9903.61422   24  331 9717.46563 14712.7311  51.4%  2918 2394s
  8740  2051     cutoff   37      9717.46563 14712.7311  51.4%  2906 2428s
  8795  2045 10201.4061   23  270 9717.46563 14712.7311  51.4%  2908 2473s
  8850  2045 9977.47726   24  261 9717.46563 14712.7311  51.4%  2909 2514s
  8910  2015     cutoff   25      9717.46563 14712.7311  51.4%  2907 2538s
  8998  1986     cutoff   24      9717.46563 14712.7311  51.4%  2901 2561s
  9094  1936 9834.47840   26  398 9717.46563 14712.7311  51.4%  2896 2585s
  9176  1911 9791.43388   27  386 9717.46563 13813.3002  42.1%  2895 2612s
  9252  1875 9769.31148   28  390 9717.46563 13238.3039  36.2%  2890 2638s
  9349  1831     cutoff   29      9717.46563 13196.0724  35.8%  2882 2666s
  9466  1750     cutoff   31      9717.46563 13102.0219  34.8%  2877 2702s
  9595  1692     cutoff   34      9717.46563 12982.8887  33.6%  2871 2729s
  9685  1648 9915.41357   26  272 9717.46563 12736.3140  31.1%  2873 2763s
  9796  1603     cutoff   27      9717.46563 12736.3140  31.1%  2866 2793s
  9927  1531 10201.2709   30  205 9717.46563 12636.7903  30.0%  2857 2821s
 10068  1429 10128.3011   31  166 9717.46563 12636.7903  30.0%  2843 2853s
 10334  1230 9991.00931   32  153 9717.46563 12392.1843  27.5%  2811 2886s
 10728   892     cutoff   31      9717.46563 11920.7777  22.7%  2754 2914s
 11341   609     cutoff   59      9717.46563 11344.0694  16.7%  2638 2931s

Cutting planes:
  Gomory: 13
  MIR: 436
  Flow cover: 1128
  RLT: 10
  Relax-and-lift: 93

Explored 11788 nodes (30242351 simplex iterations) in 2932.53 seconds (5563.86 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 9717.47 9633.49 9603.02 ... 8964.48

Optimal solution found (tolerance 1.00e-04)
Best objective 9.717465631183e+03, best bound 9.717465631183e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 2932.59s
  Master Objective (UB) = 9717.47, θ = 153473.59
  Upper Bound (UB) = 9717.47

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 153473.59
  [DEBUG]   ✓ Scenario 0: θ = 153473.59 ≤ Q = 153473.59 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 153473.59 ≤ Q = 153473.59 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 153473.59 ≤ Q = 153473.59 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 153473.59 ≤ Q = 153473.59 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 153473.59 ≤ Q = 153473.59 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 153473.59 ≤ Q = 153473.59 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 153473.59 ≤ Q = 153473.59 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x59146a58
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xa6eb95a8
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.242267e+13
Presolve removed 2593 rows and 1884 columns
Presolve time: 0.01s
Presolved: 500 rows, 505 columns, 1411 nonzeros
Found heuristic solution: objective 6080848.5194
Variable types: 342 continuous, 163 integer (163 binary)
Found heuristic solution: objective 6080454.5159

Root relaxation: objective -1.393681e+05, 238 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -139368.12    0  121 6080454.52 -139368.12   102%     -    0s
H    0     0                    -96736.42724 -139368.12  44.1%     -    0s
H    0     0                    -97283.78097 -139368.12  43.3%     -    0s
H    0     0                    -97847.21662 -139215.11  42.3%     -    0s
     0     0 -118292.63    0   45 -97847.217 -118292.63  20.9%     -    0s
H    0     0                    -117285.9640 -118210.84  0.79%     -    0s
H    0     0                    -117583.8880 -118210.84  0.53%     -    0s
     0     0 -117984.82    0   29 -117583.89 -117984.82  0.34%     -    0s
     0     0 -117921.76    0   25 -117583.89 -117921.76  0.29%     -    0s
     0     0 -117887.24    0   16 -117583.89 -117887.24  0.26%     -    0s
     0     0 -117867.59    0   12 -117583.89 -117867.59  0.24%     -    0s
     0     0 -117694.60    0    9 -117583.89 -117694.60  0.09%     -    0s
     0     0 -117662.54    0    6 -117583.89 -117662.54  0.07%     -    0s
     0     0 -117662.54    0   15 -117583.89 -117662.54  0.07%     -    0s
     0     0          -    0      -117583.89 -117594.77  0.01%     -    0s

Cutting planes:
  Gomory: 5
  Implied bound: 4
  MIR: 5
  Flow cover: 7
  RLT: 1

Explored 1 nodes (568 simplex iterations) in 0.14 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 7: -117584 -97847.2 -97283.8 ... 1.24227e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.175838880231e+05, best bound -1.175947734711e+05, gap 0.0093%
  Subproblem solved in 0.18s
  Worst-case operational profit (Z_SP) = 144319.56
  Scenario: 16 demand increases, 44 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -117583.89
  [DEBUG]   S×d_nominal = 261903.45
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 261903.45 + -117583.89 = 144319.56
  [DEBUG]   Current θ from Master = 153473.59
  [DEBUG]   ⚠️  Z_SP ≤ θ by 9154.03 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 563.43
  Lower Bound (LB) = 3932.29
  Gap (UB-LB) = 5785.1726, Absolute Gap = 5785.1726, Relative Gap = 0.595338
  Not converged yet (gap = 5785.17 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 16 increases, 44 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351415 nonzeros
Model fingerprint: 0x059572ae
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 55024 rows and 22344 columns
Presolve time: 1.87s
Presolved: 68679 rows, 29836 columns, 427519 nonzeros
Variable types: 27577 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -359784.4177
Found heuristic solution: objective -183019.6155

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 68679 rows, 29836 columns, 427519 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   24939   -1.8147134e+05   0.000000e+00   4.952383e+06      5s
   38435   -3.6010394e+04   0.000000e+00   9.396588e+06     10s
   46066   -1.0355631e+04   0.000000e+00   5.858361e+07     15s
   53946    6.2807251e+03   0.000000e+00   3.728878e+06     20s
   60395    1.1366318e+04   0.000000e+00   7.953104e+08     25s
   66211    1.5218910e+04   0.000000e+00   2.726743e+06     30s
   71560    1.6863277e+04   0.000000e+00   2.362679e+06     35s
   77205    2.2937478e+04   0.000000e+00   2.215320e+06     40s
   83539    2.5424079e+04   0.000000e+00   1.382208e+08     45s
Concurrent spin time: 5.24s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 3.506980e+04, 49326 iterations, 44.48 seconds (59.14 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 35069.7983    0  120 -183019.62 35069.7983   119%     -   47s
H    0     0                    -169281.4347 35069.7983   121%     -   47s
H    0     0                    -166644.8917 35069.7983   121%     -   47s
H    0     0                    -166613.8727 35069.7983   121%     -   47s
H    0     0                    -166312.8180 35069.7983   121%     -   48s
H    0     0                    -86660.37520 35069.7983   140%     -   48s
H    0     0                    -86424.62841 35069.7983   141%     -   48s
H    0     0                    -8424.343316 35069.7983   516%     -   48s
H    0     0                    -7226.218235 35069.7983   585%     -   48s
H    0     0                    -6931.405814 35069.7983   606%     -   48s
H    0     0                    -6636.629912 35069.7983   628%     -   48s
H    0     0                    -5814.908664 35069.7983   703%     -   48s
H    0     0                    -5639.353648 35069.7983   722%     -   49s
H    0     0                    -5609.374737 35069.7983   725%     -   49s
H    0     0                    -5607.917452 35069.7983   725%     -   49s
     0     0 29963.4037    0  187 -5607.9175 29963.4037   634%     -   66s
     0     0 29532.7825    0  175 -5607.9175 29532.7825   627%     -   72s
     0     0 29532.7825    0  172 -5607.9175 29532.7825   627%     -   73s
     0     0 29532.7825    0  176 -5607.9175 29532.7825   627%     -   74s
     0     0 27396.4524    0  226 -5607.9175 27396.4524   589%     -   84s
H    0     0                    -4165.742519 27396.2944   758%     -   84s
     0     0 26916.0506    0  232 -4165.7425 26916.0506   746%     -   91s
     0     0 26330.5420    0  271 -4165.7425 26330.5420   732%     -  101s
     0     0 26250.6807    0  271 -4165.7425 26250.6807   730%     -  105s
     0     0 26229.2851    0  279 -4165.7425 26229.2851   730%     -  107s
     0     0 26225.4682    0  292 -4165.7425 26225.4682   730%     -  108s
     0     0 26223.4684    0  287 -4165.7425 26223.4684   730%     -  108s
     0     0 26221.8618    0  287 -4165.7425 26221.8618   729%     -  109s
     0     0 26221.8161    0  289 -4165.7425 26221.8161   729%     -  109s
H    0     0                    -3918.314838 24523.4929   726%     -  136s
     0     0 24523.4929    0  319 -3918.3148 24523.4929   726%     -  136s
     0     0 23990.9704    0  394 -3918.3148 23990.9704   712%     -  145s
H    0     0                    -1748.405875 23786.7665  1460%     -  153s
H    0     0                    -392.4282724 23786.7665  6161%     -  153s
     0     0 23786.7665    0  370 -392.42827 23786.7665  6161%     -  153s
H    0     0                    -190.0296409 23699.1107      -     -  156s
H    0     0                    -150.7253061 23699.1107      -     -  156s
H    0     0                     -74.7586764 23699.1107      -     -  156s
     0     0 23699.1107    0  382  -74.75868 23699.1107      -     -  156s
     0     0 23659.4624    0  385  -74.75868 23659.4624      -     -  159s
H    0     0                     -49.0350130 23614.7705      -     -  162s
     0     0 23614.7705    0  384  -49.03501 23614.7705      -     -  162s
     0     0 23588.3638    0  374  -49.03501 23588.3638      -     -  164s
     0     0 23582.9110    0  376  -49.03501 23582.9110      -     -  165s
     0     0 23580.2462    0  386  -49.03501 23580.2462      -     -  166s
     0     0 23577.6736    0  392  -49.03501 23577.6736      -     -  167s
     0     0 23576.4883    0  376  -49.03501 23576.4883      -     -  168s
     0     0 23170.4210    0  349  -49.03501 23170.4210      -     -  180s
     0     0 22989.1365    0  394  -49.03501 22989.1365      -     -  186s
     0     0 22917.7200    0  401  -49.03501 22917.7200      -     -  190s
     0     0 22898.6446    0  447  -49.03501 22898.6446      -     -  191s
     0     0 22877.7364    0  367  -49.03501 22877.7364      -     -  193s
     0     0 22850.6504    0  397  -49.03501 22850.6504      -     -  195s
     0     0 22847.8639    0  404  -49.03501 22847.8639      -     -  196s
     0     0 22844.9612    0  368  -49.03501 22844.9612      -     -  197s
     0     0 22843.0094    0  408  -49.03501 22843.0094      -     -  198s
     0     0 22842.7093    0  370  -49.03501 22842.7093      -     -  199s
     0     0 22789.0724    0  428  -49.03501 22789.0724      -     -  203s
     0     0 22779.5494    0  438  -49.03501 22779.5494      -     -  204s
     0     0 22770.6237    0  448  -49.03501 22770.6237      -     -  206s
     0     0 22768.2983    0  452  -49.03501 22768.2983      -     -  206s
     0     0 22767.7862    0  452  -49.03501 22767.7862      -     -  207s
     0     0 22745.1256    0  403  -49.03501 22745.1256      -     -  210s
H    0     0                     216.4859855 22744.4277      -     -  214s
     0     0 22734.5457    0  443  216.48599 22734.5457      -     -  216s
     0     0 22733.5324    0  447  216.48599 22733.5324      -     -  217s
     0     0 22716.2439    0  440  216.48599 22716.2439      -     -  220s
     0     0 22688.8733    0  497  216.48599 22688.8733      -     -  223s
     0     0 22668.4936    0  457  216.48599 22668.4936      -     -  225s
     0     0 22663.6908    0  500  216.48599 22663.6908      -     -  226s
     0     0 22660.7716    0  494  216.48599 22660.7716      -     -  227s
     0     0 22659.7313    0  500  216.48599 22659.7313      -     -  228s
     0     0 22654.6990    0  465  216.48599 22654.6990      -     -  230s
H    0     0                     359.2079202 22653.9071  6207%     -  232s
     0     0 22651.6700    0  469  359.20792 22651.6700  6206%     -  234s
     0     0 22650.3630    0  512  359.20792 22650.3630  6206%     -  235s
     0     0 22639.0672    0  470  359.20792 22639.0672  6202%     -  237s
H    0     0                     386.2935735 22637.2283  5760%     -  238s
     0     0 22633.8549    0  467  386.29357 22633.8549  5759%     -  239s
     0     0 22632.8825    0  510  386.29357 22632.8825  5759%     -  240s
     0     0 22627.4491    0  475  386.29357 22627.4491  5758%     -  242s
H    0     0                     947.2254360 22626.1030  2289%     -  249s
H    0     0                    1150.2844117 22626.1030  1867%     -  249s
H    0     0                    1155.3033890 22626.1030  1858%     -  250s
H    0     0                    1314.3268484 22626.1030  1621%     -  250s
     0     0 22626.1030    0  481 1314.32685 22626.1030  1621%     -  250s
     0     0 22624.0657    0  476 1314.32685 22624.0657  1621%     -  252s
H    0     0                    1341.4125017 22623.0513  1587%     -  252s
     0     0 22623.0513    0  524 1341.41250 22623.0513  1587%     -  253s
     0     0 22618.5052    0  530 1341.41250 22618.5052  1586%     -  254s
     0     0 22614.7473    0  530 1341.41250 22614.7473  1586%     -  256s
H    0     0                    1417.2688380 22614.7473  1496%     -  271s
H    0     0                    1422.2878153 22614.7473  1490%     -  297s
H    0     0                    1782.0873726 22614.7473  1169%     -  297s
     0     2 22614.7473    0  530 1782.08737 22614.7473  1169%     -  300s
     1     4 22485.7691    1  375 1782.08737 22614.7473  1169%  2889  311s
     3     7 22241.6607    2  434 1782.08737 22478.6725  1161%  6727  324s
     6    14 21711.3267    3  527 1782.08737 22237.6636  1148%  8890  339s
    13    28 21547.0393    4  532 1782.08737 21860.7019  1127%  7908  354s
    27    43 16790.1275    5  288 1782.08737 21712.5725  1118% 11186  383s
H   42    75                    1803.2398086 21712.5725  1104% 12817  430s
H   42    75                    1810.9368374 21712.5725  1099% 12817  430s
H   43    75                    1823.0201435 21712.5725  1091% 12751  430s
H   43    75                    1843.3446681 21712.5725  1078% 12751  430s
H   44    75                    1899.6027190 21712.5725  1043% 12648  430s
H   47    75                    2006.4626594 21712.5725   982% 12305  430s
    74   145 19108.6553    7  385 2006.46266 21565.6100   975% 10623  453s
   144   232 18848.0414   10  414 2006.46266 21565.6100   975%  8619  470s
H  149   232                    2278.3211340 21565.6100   847%  8438  470s
H  176   232                    2659.8302618 21565.6100   711%  7797  470s
   231   325 18237.2506   13  404 2659.83026 21565.6100   711%  6820  485s
   324   417 18092.0536   16  386 2659.83026 21565.6100   711%  5660  496s
H  331   417                    2736.0503223 21565.6100   688%  5564  496s
H  369   417                    2751.0059707 21565.6100   684%  5268  496s
H  376   417                    2803.4150659 21565.6100   669%  5224  496s
   418   490 17433.6372   18  363 2803.41507 21565.6100   669%  4945  507s
   493   572 16742.3325   22  298 2803.41507 21565.6100   669%  4654  518s
   579   608 16673.4440   27  307 2803.41507 21565.6100   669%  4329  528s
H  594   608                    2837.5495285 21565.6100   660%  4306  528s
H  615   639                    3979.8169729 21565.6100   442%  4284  538s
   646   713 15986.0563   30  394 3979.81697 21565.6100   442%  4289  549s
   736   744 15916.0386   31  425 3979.81697 21565.6100   442%  4073  558s
H  738   744                    4111.2078949 21565.6100   425%  4073  558s
H  740   744                    7511.3706596 21565.6100   187%  4084  558s
   769   766 15772.9598   32  279 7511.37066 21565.6100   187%  4134  571s
   839   826 13771.5762   34  166 7511.37066 21499.8473   186%  4139  581s
H  899   852                    7572.1653640 21499.8473   184%  4229  592s
H  917   852                    7652.8676707 21499.8473   181%  4275  592s
   933   926 13011.6586   40  145 7652.86767 21499.8473   181%  4272  603s
  1013  1010 12076.9068   46  108 7652.86767 21499.8473   181%  4219  615s
H 1117  1047                    7846.3421040 21499.8473   174%  4085  627s
H 1129  1047                    8097.1970553 21445.7971   165%  4081  627s
H 1132  1047                    8507.4888205 21445.7971   152%  4082  627s
  1164  1116     cutoff   59      8507.48882 21445.7971   152%  4052  640s
  1262  1170 18955.5766    8  470 8507.48882 21445.7971   152%  4076  654s
  1358  1233 17900.9473    9  435 8507.48882 21445.7971   152%  4078  668s
  1451  1326 16966.3144   10  421 8507.48882 21445.7971   152%  4090  682s
  1560  1406 16961.5276   11  418 8507.48882 21445.7971   152%  4069  695s
  1684  1433 15715.5496   13  222 8507.48882 21445.7971   152%  4020  711s
H 1686  1433                    8846.4388346 21445.7971   142%  4016  711s
  1719  1521 15577.0283   14  215 8846.43883 21445.7971   142%  4052  727s
H 1841  1550                    9386.4271172 20624.2824   120%  4005  744s
  1880  1601 13906.8341   18  219 9386.42712 20624.2824   120%  4029  761s
  1974  1661 10422.5844   20  230 9386.42712 20624.2824   120%  4089  777s
H 2086  1688                    9437.2845074 20624.2824   119%  4124  794s
  2131  1775 17152.2016   11  377 9437.28451 20624.2824   119%  4163  811s
  2236  1784     cutoff   12      9437.28451 20624.2824   119%  4198  828s
H 2238  1784                    9488.3203183 20624.2824   117%  4197  828s
H 2241  1784                    9503.5860097 20624.2824   117%  4199  828s
H 2242  1784                    9505.4202458 20624.2824   117%  4199  828s
H 2266  1784                    9555.1707965 20624.2824   116%  4195  828s
  2294  1839 15185.0413   14  276 9555.17080 20624.2824   116%  4218  846s
  2425  1790 12490.6762   15  261 9555.17080 20624.2824   116%  4222  858s
  2478  1852 14425.2394   16  206 9555.17080 20624.2824   116%  4225  875s
  2595  1920 12334.1193   16  242 9555.17080 20624.2824   116%  4184  895s
H 2749  1916                    9591.0583097 20624.2824   115%  4126  895s
  2750  2008 12075.4722   18  235 9591.05831 20624.2824   115%  4131  915s
  2904  2141 13358.9501   19  244 9591.05831 20624.2824   115%  4151  937s
  3083  2274     cutoff   20      9591.05831 20624.2824   115%  4136  959s
  3284  2471     cutoff   24      9591.05831 20303.9729   112%  4107  980s
  3545  2472 14436.7156   12  530 9591.05831 20303.9729   112%  4010 1051s
  3547  2473 17715.5324   11  120 9591.05831 20303.9729   112%  4008 1107s
  3548  2474 13415.8912   29  236 9591.05831 20303.9729   112%  4007 1133s
  3549  2475 10695.2845   38  292 9591.05831 20303.9729   112%  4006 1151s
  3550  2475 12461.5899   33  404 9591.05831 20303.9729   112%  4005 1168s
  3551  2476 11855.5193   26  407 9591.05831 20303.9729   112%  4003 1178s
  3552  2477 15574.3445   16  467 9591.05831 20303.9729   112%  4002 1189s
  3553  2477 14229.7626   17  421 9591.05831 20303.9729   112%  4001 1195s
  3555  2479 11100.7417   21  471 9591.05831 20303.9729   112%  3999 1200s
  3557  2480 18224.0623   11  371 9591.05831 20303.9729   112%  3997 1211s
  3560  2482 10051.5889   16  524 9591.05831 20303.9729   112%  3993 1218s
  3561  2483 18841.2646   12  354 9591.05831 20303.9729   112%  3992 1224s
  3562  2483 17433.5155   19  345 9591.05831 20303.9729   112%  3991 1226s
  3563  2484 10697.9436   23  361 9591.05831 20303.9729   112%  3990 1231s
  3564  2485 10583.1750   51  455 9591.05831 20303.9729   112%  3989 1235s
  3565  2485 18330.2632   15  436 9591.05831 20303.9729   112%  3988 1243s
  3566  2486 12973.6082   13  449 9591.05831 20303.9729   112%  3987 1246s
  3567  2487 16016.0218   15  454 9591.05831 20303.9729   112%  3986 1251s
  3569  2488 17132.6103   10  410 9591.05831 20303.9729   112%  3983 1259s
  3570  2489 12131.2448   23  453 9591.05831 20303.9729   112%  3982 1262s
  3571  2489 11650.8458   30  371 9591.05831 20303.9729   112%  3981 1269s
  3572  2490 15849.5073   17  491 9591.05831 20303.9729   112%  3980 1276s
  3573  2491 13000.5097   33  470 9591.05831 20303.9729   112%  3979 1280s
  3574  2491 12100.6827   22  514 9591.05831 20303.9729   112%  3978 1291s
  3575  2492 14792.8566   11  477 9591.05831 20303.9729   112%  3977 1295s
  3576  2493 10536.9967   52  477 9591.05831 20303.9729   112%  3976 1308s
  3577  2493 18681.5057    9  423 9591.05831 20303.9729   112%  3974 1315s
  3578  2494 15598.0703   16  437 9591.05831 20303.9729   112%  3973 1328s
  3579  2495 9999.14344   25  446 9591.05831 20303.9729   112%  3972 1333s
  3580  2495 10168.9186   17  487 9591.05831 20303.9729   112%  3971 1340s
  3581  2496 13275.2262   20  489 9591.05831 20303.9729   112%  3970 1350s
  3582  2497 16126.5710   16  494 9591.05831 20303.9729   112%  3969 1355s
  3583  2497 16188.8034   20  501 9591.05831 20303.9729   112%  3968 1365s
  3584  2498 15761.5199   27  499 9591.05831 20303.9729   112%  3967 1370s
  3585  2499 14965.6037   25  489 9591.05831 20303.9729   112%  3966 1379s
  3586  2499 13472.6754   19  501 9591.05831 20303.9729   112%  3964 1383s
  3587  2500 16663.1531   33  417 9591.05831 20303.9729   112%  3963 1397s
  3588  2501 14799.9379   27  417 9591.05831 20303.9729   112%  3962 1455s
  3589  2501 16014.4109   20  417 9591.05831 20303.9729   112%  3961 1493s
  3590  2504 20303.9729   15  378 9591.05831 20303.9729   112%  4030 1515s
  3591  2506 20303.9729   16  367 9591.05831 20303.9729   112%  4032 1529s
  3593  2510 19073.5059   16  317 9591.05831 20303.9729   112%  4034 1544s
  3598  2518 19042.2088   17  302 9591.05831 20303.9729   112%  4036 1564s
  3608  2535 18041.4853   18  309 9591.05831 20303.9729   112%  4040 1586s
  3628  2539 18274.0278   19  333 9591.05831 20303.9729   112%  4118 1627s
  3640  2557 14745.2952   21  300 9591.05831 20303.9729   112%  4123 1666s
  3666  2650 12571.1576   22  294 9591.05831 20303.9729   112%  4171 1711s
  3770  2658 10699.1814   25  336 9591.05831 20303.9729   112%  4191 1734s
H 3796  2523                    9593.8535135 20303.9729   112%  4218 1734s
H 3805  2400                    9614.5960800 20303.9729   111%  4232 1734s
  3821  2441 10375.3927   25  290 9614.59608 20303.9729   111%  4260 1756s
  3894  2451     cutoff   26      9614.59608 20303.9729   111%  4271 1778s
H 3897  2337                    9652.1487070 20303.9729   110%  4270 1778s
  3980  2344 9852.91087   25  287 9652.14871 20303.9729   110%  4244 1798s
  4065  2328     cutoff   26      9652.14871 20303.9729   110%  4210 1814s
  4105  2329 12088.2987   26  239 9652.14871 20303.9729   110%  4202 1832s
  4161  2317 10314.0954   28  123 9652.14871 20303.9729   110%  4181 1849s
  4218  2317 10992.5526   28  204 9652.14871 20303.9729   110%  4158 1865s
  4270  2310 10487.6219   31  206 9652.14871 20303.9729   110%  4138 1883s
  4330  2305     cutoff   34      9652.14871 20303.9729   110%  4124 1900s
  4399  2307 9776.90068   35  173 9652.14871 20303.9729   110%  4107 1919s
  4461  2310 11171.7179   29  362 9652.14871 20303.9729   110%  4101 1935s
  4515  2311 11171.0572   30  358 9652.14871 20303.9729   110%  4107 1953s
  4575  2323 11127.3762   31  348 9652.14871 20303.9729   110%  4108 1973s
  4645  2319 10277.4118   31  235 9652.14871 18505.2199  91.7%  4097 1992s
  4736  2311 17204.6829   23  401 9652.14871 18499.3837  91.7%  4073 2010s
  4821  2317 14878.8461   24  389 9652.14871 18499.3837  91.7%  4051 2031s
  4907  2305 14213.9926   25  364 9652.14871 18499.3837  91.7%  4040 2052s
  5006  2296 13126.2956   27  261 9652.14871 18499.3837  91.7%  4017 2074s
  5104  2261 12185.3617   29  205 9652.14871 18499.3837  91.7%  3995 2100s
  5209  2267 11696.0145   31  286 9652.14871 18499.3837  91.7%  3972 2124s
  5321  2279 10154.3962   38  229 9652.14871 18499.3837  91.7%  3951 2150s
  5438  2256 13078.1676   27  330 9652.14871 17122.9417  77.4%  3933 2173s
H 5495  2129                    9678.2579248 16955.8134  75.2%  3923 2173s
  5519  2156 11434.1702   27  323 9678.25792 16955.8134  75.2%  3926 2198s
  5626  2157     cutoff   28      9678.25792 16635.9397  71.9%  3920 2226s
  5772  2135     cutoff   29      9678.25792 16635.9397  71.9%  3888 2255s
  5915  2112 10362.6245   32  297 9678.25792 16441.3642  69.9%  3869 2281s
  6077  2093     cutoff   36      9678.25792 16150.3766  66.9%  3838 2311s
  6218  2099 13062.5196   28  434 9678.25792 16150.3766  66.9%  3824 2347s
  6374  2089 infeasible   32      9678.25792 15915.2932  64.4%  3804 2383s
  6539  2032 10286.6517   33  316 9678.25792 15915.2932  64.4%  3781 2407s
  6601  2028 9922.47145   34  299 9678.25792 15915.2932  64.4%  3778 2438s
  6712  2019 9910.08969   35  302 9678.25792 15915.2932  64.4%  3761 2471s
  6910  1991 11620.6584   28  409 9678.25792 15564.8147  60.8%  3724 2509s
  7103  1949 9921.68044   35  297 9678.25792 15524.6558  60.4%  3706 2551s
  7297  1914 10920.7912   37  262 9678.25792 15155.7533  56.6%  3698 2589s
  7499  1890 11700.9058   28  391 9678.25792 15155.3004  56.6%  3680 2630s
  7755  1818 9780.69355   35  341 9678.25792 14969.1537  54.7%  3641 2673s
  7994  1764 12082.5049   33  194 9678.25792 14969.1537  54.7%  3615 2727s
  8285  1721 10385.7336   43  125 9678.25792 14387.2218  48.7%  3577 2774s
  8627  1628 9762.23582   61   24 9678.25792 14276.0321  47.5%  3525 2820s
  8981  1514 9918.23092   28  263 9678.25792 13878.3166  43.4%  3479 2861s
  9169  1468 10851.8318   29  306 9678.25792 13704.3062  41.6%  3460 2908s
H 9529  1268                    9703.6607801 13499.2395  39.1%  3423 2956s
  9880  1226 11068.6351   27  262 9703.66078 13215.3706  36.2%  3393 3004s
 10277  1153     cutoff   24      9703.66078 12934.1229  33.3%  3361 3058s
 10750  1062     cutoff   34      9703.66078 12568.2174  29.5%  3310 3110s
 11206   920 10436.9966   38  166 9703.66078 12243.7879  26.2%  3272 3166s
 11800   699 10134.1282   35  279 9703.66078 11897.8698  22.6%  3202 3217s
 12385   206 10614.2096   30  302 9703.66078 11595.5739  19.5%  3123 3271s
 13234    13     cutoff   23      9703.66078 11195.4951  15.4%  2997 3294s
 13626     0     cutoff   56      9703.66078 9933.98993  2.37%  2926 3297s

Cutting planes:
  Learned: 3
  Gomory: 5
  MIR: 681
  Flow cover: 1648
  RLT: 17
  Relax-and-lift: 143

Explored 13744 nodes (40114414 simplex iterations) in 3297.36 seconds (6015.65 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 9703.66 9678.26 9652.15 ... 9488.32

Optimal solution found (tolerance 1.00e-04)
Best objective 9.703660780099e+03, best bound 9.703660780099e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 3297.38s
  Master Objective (UB) = 9703.66, θ = 153327.76
  Upper Bound (UB) = 9703.66

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 153327.76
  [DEBUG]   ✓ Scenario 0: θ = 153327.76 ≤ Q = 153327.76 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 153327.76 ≤ Q = 153327.76 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 153327.76 ≤ Q = 153327.76 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 153327.76 ≤ Q = 153327.76 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 153327.76 ≤ Q = 153327.76 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 153327.76 ≤ Q = 153327.76 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 153327.76 ≤ Q = 153327.76 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 153327.76 ≤ Q = 153327.76 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x221e816
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x0221e816
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.251949e+13
Presolve removed 2593 rows and 1884 columns
Presolve time: 0.01s
Presolved: 500 rows, 505 columns, 1411 nonzeros
Found heuristic solution: objective 6152522.4839
Variable types: 342 continuous, 163 integer (163 binary)
Found heuristic solution: objective 6152128.4805

Root relaxation: objective -1.396101e+05, 244 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -139610.14    0  121 6152128.48 -139610.14   102%     -    0s
H    0     0                    -99146.83349 -139610.14  40.8%     -    0s
H    0     0                    -105281.6046 -139610.14  32.6%     -    0s
H    0     0                    -105672.6784 -139610.14  32.1%     -    0s
H    0     0                    -106097.1086 -139429.08  31.4%     -    0s
     0     0 -118678.51    0   61 -106097.11 -118678.51  11.9%     -    0s
H    0     0                    -116997.2202 -118648.38  1.41%     -    0s
H    0     0                    -117331.2349 -118648.38  1.12%     -    0s
H    0     0                    -117581.5202 -118648.38  0.91%     -    0s
     0     0 -118099.21    0   42 -117581.52 -118099.21  0.44%     -    0s
     0     0 -117963.64    0   23 -117581.52 -117963.64  0.32%     -    0s
     0     0 -117955.17    0   24 -117581.52 -117955.17  0.32%     -    0s
     0     0 -117791.54    0   17 -117581.52 -117791.54  0.18%     -    0s
     0     0 -117774.28    0   17 -117581.52 -117774.28  0.16%     -    0s
     0     0 -117718.50    0   15 -117581.52 -117718.50  0.12%     -    0s
     0     0 -117718.50    0   22 -117581.52 -117718.50  0.12%     -    0s
     0     0 -117624.46    0    5 -117581.52 -117624.46  0.04%     -    0s
H    0     0                    -117584.4564 -117615.03  0.03%     -    0s
     0     0 -117615.03    0    4 -117584.46 -117615.03  0.03%     -    0s
     0     0 -117602.54    0    5 -117584.46 -117602.54  0.02%     -    0s
H    0     0                    -117602.3437 -117602.54  0.00%     -    0s

Cutting planes:
  Gomory: 5
  Implied bound: 2
  MIR: 12
  Flow cover: 6
  Relax-and-lift: 5

Explored 1 nodes (691 simplex iterations) in 0.12 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -117602 -117584 -117582 ... -99146.8

Optimal solution found (tolerance 1.00e-04)
Best objective -1.176023437253e+05, best bound -1.176025403370e+05, gap 0.0002%
  Subproblem solved in 0.15s
  Worst-case operational profit (Z_SP) = 144485.11
  Scenario: 25 demand increases, 35 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -117602.34
  [DEBUG]   S×d_nominal = 262087.46
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 262087.46 + -117602.34 = 144485.11
  [DEBUG]   Current θ from Master = 153327.76
  [DEBUG]   ⚠️  Z_SP ≤ θ by 8842.65 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 861.01
  Lower Bound (LB) = 3932.29
  Gap (UB-LB) = 5771.3678, Absolute Gap = 5771.3678, Relative Gap = 0.594762
  Not converged yet (gap = 5771.37 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 25 increases, 35 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394652 nonzeros
Model fingerprint: 0x1947db58
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 61912 rows and 25142 columns
Presolve time: 2.51s
Presolved: 77081 rows, 33278 columns, 472805 nonzeros
Variable types: 31019 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -359784.4177
Found heuristic solution: objective -183019.6155

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 77081 rows, 33278 columns, 472805 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   24152   -2.1418794e+05   0.000000e+00   3.246006e+07      5s
   40712   -3.7670130e+04   0.000000e+00   3.997586e+08     10s
   51604    7.8478366e+03   0.000000e+00   4.843118e+06     15s
   57272    1.5264596e+04   0.000000e+00   1.463933e+07     20s
   62983    2.1187624e+04   0.000000e+00   2.131086e+06     25s
   70007    2.7448568e+04   0.000000e+00   4.712624e+06     30s
   76683    3.0106747e+04   0.000000e+00   8.372391e+05     35s
Concurrent spin time: 3.83s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 3.917253e+04, 47047 iterations, 36.92 seconds (46.78 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 39172.5258    0  182 -183019.62 39172.5258   121%     -   40s
H    0     0                    -170831.1404 39172.5258   123%     -   40s
H    0     0                    -167140.3773 39172.5258   123%     -   40s
H    0     0                    -167014.6539 39172.5258   123%     -   40s
H    0     0                    -123216.3645 39172.5258   132%     -   41s
H    0     0                    -122963.4531 39172.5258   132%     -   41s
H    0     0                    -122847.9695 39172.5258   132%     -   41s
H    0     0                    -62231.57341 39172.5258   163%     -   41s
H    0     0                    -9473.196240 39172.5258   514%     -   41s
H    0     0                    -8454.197029 39172.5258   563%     -   41s
H    0     0                    -7658.053615 39172.5258   612%     -   41s
H    0     0                    -6859.346603 39172.5258   671%     -   42s
H    0     0                    -6841.247056 39172.5258   673%     -   42s
H    0     0                    -6343.195631 39172.5258   718%     -   42s
H    0     0                    -6290.784561 39172.5258   723%     -   42s
H    0     0                    -6243.080453 39172.5258   727%     -   42s
H    0     0                    -6208.425806 31821.2957   613%     -   60s
H    0     0                    -6109.141530 31821.2957   621%     -   60s
H    0     0                    -6021.048446 31821.2957   629%     -   60s
H    0     0                    -5972.199069 31821.2957   633%     -   60s
     0     0 31326.5029    0  223 -5972.1991 31326.5029   625%     -   60s
     0     0 30889.1287    0  226 -5972.1991 30889.1287   617%     -   67s
     0     0 30736.6090    0  239 -5972.1991 30736.6090   615%     -   72s
     0     0 30736.6090    0  270 -5972.1991 30736.6090   615%     -   80s
     0     0 30736.6090    0  276 -5972.1991 30736.6090   615%     -   81s
     0     0 30736.6090    0  273 -5972.1991 30736.6090   615%     -   81s
     0     0 30736.6090    0  272 -5972.1991 30736.6090   615%     -   84s
     0     0 30736.6090    0  274 -5972.1991 30736.6090   615%     -   85s
     0     0 30736.6090    0  274 -5972.1991 30736.6090   615%     -   85s
     0     0 30736.5469    0  279 -5972.1991 30736.5469   615%     -   86s
     0     0 30736.3909    0  272 -5972.1991 30736.3909   615%     -   86s
H    0     0                    -5873.345537 27515.0516   568%     -  104s
     0     0 27491.7999    0  314 -5873.3455 27491.7999   568%     -  104s
H    0     0                    -2346.219072 27488.9628  1272%     -  104s
H    0     0                    -2340.516453 27488.9628  1274%     -  104s
H    0     0                    -2268.383348 27488.9628  1312%     -  104s
     0     0 27234.8124    0  311 -2268.3833 27234.8124  1301%     -  112s
     0     0 27160.2097    0  308 -2268.3833 27160.2097  1297%     -  114s
     0     0 26789.6114    0  301 -2268.3833 26789.6114  1281%     -  120s
     0     0 26746.1124    0  298 -2268.3833 26746.1124  1279%     -  122s
     0     0 26724.7073    0  308 -2268.3833 26724.7073  1278%     -  124s
     0     0 26719.2411    0  363 -2268.3833 26719.2411  1278%     -  125s
     0     0 26692.7155    0  316 -2268.3833 26692.7155  1277%     -  127s
     0     0 26583.7082    0  323 -2268.3833 26583.7082  1272%     -  133s
     0     0 26578.6228    0  315 -2268.3833 26578.6228  1272%     -  134s
     0     0 26574.1886    0  318 -2268.3833 26574.1886  1272%     -  135s
     0     0 26542.8993    0  324 -2268.3833 26542.8993  1270%     -  137s
     0     0 26520.7012    0  318 -2268.3833 26520.7012  1269%     -  139s
     0     0 26506.3758    0  325 -2268.3833 26506.3758  1269%     -  141s
     0     0 26505.7767    0  325 -2268.3833 26505.7767  1268%     -  142s
     0     0 24572.0349    0  441 -2268.3833 24572.0349  1183%     -  170s
H    0     0                    -2261.451167 24571.6769  1187%     -  171s
H    0     0                    -2250.907099 24571.6769  1192%     -  171s
H    0     0                    -2189.993662 24571.6769  1222%     -  171s
     0     0 24405.0064    0  371 -2189.9937 24405.0064  1214%     -  177s
     0     0 24253.8721    0  409 -2189.9937 24253.8721  1207%     -  184s
H    0     0                    -1248.010993 24137.0550  2034%     -  189s
H    0     0                    -942.1793379 24137.0550  2662%     -  189s
H    0     0                    -672.6392450 24137.0550  3688%     -  189s
H    0     0                    -516.3694625 24137.0550  4774%     -  189s
H    0     0                    -503.2357006 24137.0550  4896%     -  189s
     0     0 24137.0550    0  413 -503.23570 24137.0550  4896%     -  189s
     0     0 24115.9499    0  415 -503.23570 24115.9499  4892%     -  192s
     0     0 24067.2446    0  423 -503.23570 24067.2446  4882%     -  196s
     0     0 24044.1716    0  413 -503.23570 24044.1716  4878%     -  198s
     0     0 24025.1529    0  418 -503.23570 24025.1529  4874%     -  200s
     0     0 24014.3621    0  408 -503.23570 24014.3621  4872%     -  202s
     0     0 24003.5786    0  417 -503.23570 24003.5786  4870%     -  203s
     0     0 23996.8032    0  413 -503.23570 23996.8032  4869%     -  204s
     0     0 23996.1167    0  415 -503.23570 23996.1167  4868%     -  205s
H    0     0                    1270.0374438 23469.2683  1748%     -  220s
H    0     0                    1279.4418560 23469.2683  1734%     -  220s
H    0     0                    1391.1228061 23469.2683  1587%     -  220s
H    0     0                    1412.4989790 23469.2683  1562%     -  220s
H    0     0                    1439.4510420 23469.2683  1530%     -  220s
H    0     0                    1504.6512695 23469.2683  1460%     -  220s
H    0     0                    1507.3165637 23469.2683  1457%     -  220s
H    0     0                    1517.4777993 23469.2683  1447%     -  220s
     0     0 23469.2683    0  386 1517.47780 23469.2683  1447%     -  220s
H    0     0                    1705.5381331 23469.1134  1276%     -  221s
H    0     0                    1722.2906457 23469.1134  1263%     -  221s
     0     0 23278.8257    0  437 1722.29065 23278.8257  1252%     -  228s
     0     0 23249.4480    0  440 1722.29065 23249.4480  1250%     -  231s
     0     0 23197.7637    0  478 1722.29065 23197.7637  1247%     -  236s
     0     0 23174.8851    0  447 1722.29065 23174.8851  1246%     -  238s
     0     0 23171.7716    0  486 1722.29065 23171.7716  1245%     -  240s
     0     0 23170.4110    0  503 1722.29065 23170.4110  1245%     -  242s
     0     0 22965.9730    0  519 1722.29065 22965.9730  1233%     -  248s
H    0     0                    1787.3987636 22964.4742  1185%     -  249s
     0     0 22925.6836    0  424 1787.39876 22925.6836  1183%     -  252s
     0     0 22910.0533    0  429 1787.39876 22910.0533  1182%     -  254s
     0     0 22906.2698    0  434 1787.39876 22906.2698  1182%     -  256s
     0     0 22905.8881    0  436 1787.39876 22905.8881  1182%     -  256s
     0     0 22825.2105    0  474 1787.39876 22825.2105  1177%     -  262s
     0     0 22817.4624    0  472 1787.39876 22817.4624  1177%     -  266s
     0     0 22814.2858    0  464 1787.39876 22814.2858  1176%     -  268s
     0     0 22812.4957    0  459 1787.39876 22812.4957  1176%     -  269s
     0     0 22741.0312    0  507 1787.39876 22741.0312  1172%     -  275s
     0     0 22728.9781    0  519 1787.39876 22728.9781  1172%     -  277s
     0     0 22726.9759    0  529 1787.39876 22726.9759  1172%     -  278s
     0     0 22560.3510    0  470 1787.39876 22560.3510  1162%     -  285s
H    0     0                    1822.0742523 22559.8988  1138%     -  286s
H    0     0                    1826.4444632 22559.8988  1135%     -  286s
     0     0 22506.7799    0  475 1826.44446 22506.7799  1132%     -  289s
     0     0 22497.3658    0  465 1826.44446 22497.3658  1132%     -  291s
     0     0 22492.2018    0  472 1826.44446 22492.2018  1131%     -  291s
     0     0 22491.6452    0  473 1826.44446 22491.6452  1131%     -  292s
     0     0 22426.2475    0  514 1826.44446 22426.2475  1128%     -  297s
     0     0 22411.9626    0  524 1826.44446 22411.9626  1127%     -  299s
     0     0 22407.9971    0  518 1826.44446 22407.9971  1127%     -  300s
     0     0 22404.5237    0  533 1826.44446 22404.5237  1127%     -  302s
     0     0 22402.2119    0  496 1826.44446 22402.2119  1127%     -  303s
     0     0 22401.7896    0  533 1826.44446 22401.7896  1127%     -  303s
     0     0 22364.9557    0  526 1826.44446 22364.9557  1125%     -  306s
     0     0 22363.0216    0  495 1826.44446 22363.0216  1124%     -  309s
     0     0 22341.1675    0  465 1826.44446 22341.1675  1123%     -  312s
     0     0 22339.5290    0  433 1826.44446 22339.5290  1123%     -  314s
     0     0 22336.6811    0  484 1826.44446 22336.6811  1123%     -  316s
H    0     0                    1831.4634405 22335.7769  1120%     -  318s
     0     0 22335.6303    0  481 1831.46344 22335.6303  1120%     -  319s
     0     0 22334.8967    0  430 1831.46344 22334.8967  1120%     -  321s
     0     0 22334.3278    0  483 1831.46344 22334.3278  1119%     -  323s
     0     0 22333.4810    0  495 1831.46344 22333.4810  1119%     -  325s
     0     0 22329.9798    0  495 1831.46344 22329.9798  1119%     -  328s
H    0     0                    1993.9523935 22329.4268  1020%     -  406s
H    0     0                    2007.6297151 22329.4268  1012%     -  411s
     0     2 22329.4268    0  495 2007.62972 22329.4268  1012%     -  565s
     1     4 22025.8366    1  430 2007.62972 22329.4268  1012%  6572  571s
     3     8 21869.1798    2  458 2007.62972 22059.5315   999%  6886  584s
     7    16 21506.5355    3  460 2007.62972 21869.1533   989%  8876  597s
    15    32 21160.8037    4  485 2007.62972 21597.9245   976%  8988  613s
    31    48 20000.9885    5  413 2007.62972 21223.3960   957% 12224  655s
    47    80 17369.1640    6  298 2007.62972 21223.3960   957% 11832  676s
    79   148 17274.4327    7  269 2007.62972 21223.3960   957%  9742  741s
   147   264 16957.7212    9  250 2007.62972 21223.3960   957%  7079  766s
   263   369 16239.1582   11  303 2007.62972 21223.3960   957%  5353  787s
   368   442 16766.3611   13  253 2007.62972 21223.3960   957%  4588  802s
   447   486 15187.3206   15  285 2007.62972 21223.3960   957%  4304  818s
   527   533 15385.4498   14  342 2007.62972 21223.3960   957%  4118  834s
   604   606 9766.24452   14  229 2007.62972 21223.3960   957%  4038  848s
   687   645 15254.3411   15  343 2007.62972 21223.3960   957%  3964  863s
H  755   645                    7254.9184730 21223.3960   193%  3888  863s
   772   651 14662.1475   16  338 7254.91847 21223.3960   193%  3882  878s
   833   679 14635.3528   16  341 7254.91847 21223.3960   193%  3927  893s
H  835   679                    8164.4922808 21223.3960   160%  3931  893s
H  846   679                    8469.4515570 21223.3960   151%  3996  893s
   871   690 13364.5294   17  269 8469.45156 21223.3960   151%  4125  909s
   925   705 12245.3507   18  331 8469.45156 21223.3960   151%  4197  924s
H  931   705                    8892.0669531 21223.3960   139%  4245  924s
H  966   705                    9191.9581303 21223.3960   131%  4371  924s
   981   712 11830.3153   18  243 9191.95813 21223.3960   131%  4358  942s
  1048   726 11764.0357   19  273 9191.95813 21223.3960   131%  4441  958s
H 1050   726                    9270.9952569 21223.3960   129%  4442  958s
H 1051   726                    9541.0003835 21223.3960   122%  4441  958s
  1086   753 11145.4687   19  334 9541.00038 21223.3960   122%  4555  976s
  1137   785 11274.8389   19  236 9541.00038 21223.3960   122%  4621  993s
H 1139   785                    9583.2085157 21223.3960   121%  4618  993s
  1191   816     cutoff   20      9583.20852 21223.3960   121%  4720 1011s
  1250   874 11032.2929   20  331 9583.20852 21223.3960   121%  4843 1030s
H 1252   874                    9595.3935915 21223.3960   121%  4844 1030s
  1338   916 10442.9466   22  297 9595.39359 21223.3960   121%  4868 1048s
  1434   920 10654.1754   23  329 9595.39359 21223.3960   121%  4853 1066s
H 1443   920                    9604.0085092 21223.3960   121%  4848 1066s
  1488   962 10476.0969   24  316 9604.00851 21223.3960   121%  4874 1085s
  1594   971 10128.6312   27  262 9604.00851 21223.3960   121%  4874 1104s
  1647  1003 9921.53908   28  235 9604.00851 21223.3960   121%  4953 1124s
  1714  1031 9635.54495   26  254 9604.00851 20675.8801   115%  5018 1140s
  1750  1052 9817.43932   29  231 9604.00851 20675.6062   115%  5095 1162s
  1797  1077 11312.0267   11  432 9604.00851 20675.6062   115%  5135 1184s
  1834  1111 10877.9254   12  408 9604.00851 20675.6062   115%  5206 1205s
  1891  1144     cutoff   14      9604.00851 20675.6062   115%  5241 1221s
  1944  1185 9833.62844   13  405 9604.00851 20675.6062   115%  5276 1243s
  2027  1273     cutoff   14      9604.00851 20675.6062   115%  5242 1266s
  2157  1308 14217.9604    8  383 9604.00851 20675.6062   115%  5221 1289s
  2243  1333 12342.8940    9  324 9604.00851 20675.6062   115%  5188 1315s
  2384  1396 12288.5759   10  258 9604.00851 20118.7488   109%  5126 1342s
  2514  1480 11165.1970   12  218 9604.00851 20118.7488   109%  5176 1373s
  2648  1552     cutoff   20      9604.00851 20118.7488   109%  5194 1402s
  2819  1585 10440.2689   14  369 9604.00851 20118.7488   109%  5147 1432s
  2993  1628     cutoff   18      9604.00851 20118.7488   109%  5124 1464s
  3157  1685 13918.4257   11  331 9604.00851 20118.7488   109%  5150 1497s
  3310  1755 12194.3492   14  278 9604.00851 20118.7488   109%  5194 1532s
  3484  1754 15913.0630   12  276 9604.00851 19327.8290   101%  5235 1561s
  3586  1772 13808.8028   14  271 9604.00851 19327.8290   101%  5241 1593s
  3750  1781 10134.5980   16  240 9604.00851 19327.8290   101%  5252 1633s
  3960  1797 11270.3013   16  250 9604.00851 19327.8290   101%  5229 1675s
  4152  1871 10028.5117   17  288 9604.00851 18575.4615  93.4%  5274 1713s
  4350  1956 14548.3167   11  403 9604.00851 18575.4615  93.4%  5319 1752s
  4617  1995     cutoff   14      9604.00851 18125.2042  88.7%  5287 1796s
  4819  2077 10690.3039   15  358 9604.00851 17980.2645  87.2%  5325 1838s
  5023  2110 12449.0305   13  421 9604.00851 17980.2645  87.2%  5385 1885s
  5304  2205 11075.2681   15  425 9604.00851 17980.2645  87.2%  5369 1931s
  5548  2266 14375.5288   14  302 9604.00851 17613.9907  83.4%  5398 1977s
  5794  2364 10801.6262   17  265 9604.00851 17613.9907  83.4%  5362 2025s
  6046  2365 11632.5508   22  495 9604.00851 17613.9907  83.4%  5411 2219s
  6048  2366 15395.0915   13  140 9604.00851 17613.9907  83.4%  5409 2260s
  6049  2367 11220.9089   18  335 9604.00851 17613.9907  83.4%  5408 2303s
  6050  2368 9920.06845   40  375 9604.00851 17613.9907  83.4%  5407 2321s
  6051  2368 13731.0358   12  413 9604.00851 17613.9907  83.4%  5406 2333s
  6052  2369 16848.0462   14  405 9604.00851 17613.9907  83.4%  5405 2342s
  6053  2370 13193.2998   13  416 9604.00851 17613.9907  83.4%  5404 2348s
  6054  2370 11582.1806   22  421 9604.00851 17613.9907  83.4%  5403 2354s
  6055  2371 14827.4235   18  514 9604.00851 17613.9907  83.4%  5402 2362s
  6056  2372 10296.7107   30  424 9604.00851 17613.9907  83.4%  5402 2366s
  6057  2372 15607.6692    9  442 9604.00851 17613.9907  83.4%  5401 2370s
  6059  2374 10336.4456   26  472 9604.00851 17613.9907  83.4%  5399 2383s
  6060  2374 10791.4241   17  477 9604.00851 17613.9907  83.4%  5398 2387s
  6061  2375 13399.2490   16  481 9604.00851 17613.9907  83.4%  5397 2394s
  6062  2376 12935.5454   12  438 9604.00851 17613.9907  83.4%  5396 2398s
  6063  2376 10566.2256   13  535 9604.00851 17613.9907  83.4%  5395 2411s
  6064  2377 13109.0854   14  438 9604.00851 17613.9907  83.4%  5394 2416s
  6065  2378 12217.0743   16  497 9604.00851 17613.9907  83.4%  5394 2425s
  6066  2378 16952.8089   10  500 9604.00851 17613.9907  83.4%  5393 2430s
  6067  2379 12627.9210   22  507 9604.00851 17613.9907  83.4%  5392 2438s
  6068  2380 14028.0947   12  499 9604.00851 17613.9907  83.4%  5391 2441s
  6069  2380 15129.8549    9  507 9604.00851 17613.9907  83.4%  5390 2448s
  6070  2381 13232.8139   11  503 9604.00851 17613.9907  83.4%  5389 2453s
  6071  2382 10428.7297   16  473 9604.00851 17613.9907  83.4%  5388 2462s
  6072  2382 11931.4341    9  473 9604.00851 17613.9907  83.4%  5387 2503s
  6073  2383 12715.9774   20  473 9604.00851 17613.9907  83.4%  5386 2537s
  6074  2386 17613.9907   10  282 9604.00851 17613.9907  83.4%  5421 2557s
  6075  2388 17613.9907   11  277 9604.00851 17613.9907  83.4%  5421 2583s
  6078  2393 17613.9907   12  292 9604.00851 17613.9907  83.4%  5420 2621s
  6084  2403 16566.4102   13  286 9604.00851 17613.9907  83.4%  5426 2650s
  6096  2411 17613.9907   13  454 9604.00851 17613.9907  83.4%  5442 2694s
  6108  2438 17435.6366   14  461 9604.00851 17613.9907  83.4%  5447 2745s
  6139  2533 17280.1576   15  455 9604.00851 17613.9907  83.4%  5491 2792s
  6252  2518     cutoff   18      9604.00851 17613.9907  83.4%  5536 2809s
  6292  2527 15652.6320   18  384 9604.00851 17613.9907  83.4%  5554 2828s
  6338  2525 16149.4037   18  413 9604.00851 17613.9907  83.4%  5570 2845s
  6381  2519 14851.4965   19  349 9604.00851 17613.9907  83.4%  5595 2866s
  6430  2521 13597.4890   20  320 9604.00851 17613.9907  83.4%  5614 2881s
  6478  2528 13158.1174   20  381 9604.00851 17613.9907  83.4%  5635 2900s
  6514  2539     cutoff   21      9604.00851 17613.9907  83.4%  5652 2917s
  6553  2531 13303.7582   19  348 9604.00851 17613.9907  83.4%  5659 2935s
  6610  2528 12829.4818   20  327 9604.00851 17613.9907  83.4%  5652 2955s
  6656  2535 12339.6404   21  370 9604.00851 17613.9907  83.4%  5651 2972s
  6704  2531 11527.4413   22  381 9604.00851 17613.9907  83.4%  5661 2997s
  6760  2530     cutoff   23      9604.00851 17613.9907  83.4%  5660 3017s
  6808  2538     cutoff   22      9604.00851 17613.9907  83.4%  5675 3033s
  6857  2534 10552.2998   25  242 9604.00851 17613.9907  83.4%  5675 3051s
  6906  2536     cutoff   26      9604.00851 17613.9907  83.4%  5670 3072s
  6960  2532     cutoff   27      9604.00851 17613.9907  83.4%  5668 3093s
  7026  2535 10379.5607   28  171 9604.00851 17613.9907  83.4%  5661 3113s
  7088  2540 10234.8287   29  114 9604.00851 17613.9907  83.4%  5661 3133s
  7158  2525     cutoff   29      9604.00851 17613.9907  83.4%  5664 3153s
  7231  2515     cutoff   31      9604.00851 17613.9907  83.4%  5655 3182s
  7328  2505 10194.2762   31  116 9604.00851 17613.9907  83.4%  5642 3205s
  7426  2511     cutoff   32      9604.00851 17613.9907  83.4%  5638 3227s
  7517  2493 9853.34501   35   84 9604.00851 17613.9907  83.4%  5642 3252s
  7637  2493     cutoff   20      9604.00851 16429.0670  71.1%  5626 3276s
  7749  2484 13608.5799   18  398 9604.00851 16429.0670  71.1%  5624 3302s
  7865  2496 12888.1399   19  342 9604.00851 16350.8050  70.2%  5619 3327s
  7993  2498 12030.0482   21  259 9604.00851 16096.4081  67.6%  5609 3354s
  8140  2466     cutoff   26      9604.00851 16075.8918  67.4%  5580 3381s
  8282  2452 13289.6262   17  278 9604.00851 16075.8918  67.4%  5564 3409s
  8448  2417 10718.8466   20  314 9604.00851 15283.6024  59.1%  5537 3441s
  8603  2401     cutoff   24      9604.00851 15283.6024  59.1%  5522 3472s
  8758  2358 9871.54166   21  452 9604.00851 14747.8695  53.6%  5514 3503s
  8934  2311 12197.9836   21  392 9604.00851 14747.8695  53.6%  5501 3536s
  9120  2264 10126.3242   23  369 9604.00851 14490.9173  50.9%  5492 3570s
  9302  2223     cutoff   24      9604.00851 14455.9118  50.5%  5481 3600s

Cutting planes:
  Learned: 1
  Gomory: 1
  Projected implied bound: 74
  MIR: 883
  Mixing: 2
  Flow cover: 1479
  RLT: 24
  Relax-and-lift: 170

Explored 9508 nodes (52144500 simplex iterations) in 3600.07 seconds (6656.15 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 9604.01 9595.39 9583.21 ... 7254.92

Time limit reached
Best objective 9.604008509168e+03, best bound 1.406460763645e+04, gap 46.4452%
  WARNING: Time limit reached. Using best solution found (gap: 46.45%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = 9604.01, θ = 153813.18
  Upper Bound (UB) = 9604.01

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 153813.18
  [DEBUG]   ✓ Scenario 0: θ = 153813.18 ≤ Q = 153813.18 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 153813.18 ≤ Q = 153813.18 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 153813.18 ≤ Q = 153813.18 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 153813.18 ≤ Q = 153813.18 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 153813.18 ≤ Q = 153813.18 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 153813.18 ≤ Q = 153813.18 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 153813.18 ≤ Q = 153813.18 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 153813.18 ≤ Q = 153813.18 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 153813.18 ≤ Q = 153813.18 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x3fda773a
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xc02588c6
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.248425e+13
Presolve removed 2587 rows and 1879 columns
Presolve time: 0.01s
Presolved: 506 rows, 510 columns, 1427 nonzeros
Found heuristic solution: objective 6230414.3383
Variable types: 346 continuous, 164 integer (164 binary)

Root relaxation: objective -1.380729e+05, 251 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -138072.93    0  123 6230414.34 -138072.93   102%     -    0s
H    0     0                    -105187.6181 -138072.93  31.3%     -    0s
H    0     0                    -105494.7019 -138072.93  30.9%     -    0s
     0     0 -114961.48    0   65 -105494.70 -114961.48  8.97%     -    0s
H    0     0                    -113122.5210 -114888.78  1.56%     -    0s
H    0     0                    -113456.5357 -114888.78  1.26%     -    0s
H    0     0                    -113475.4188 -114888.78  1.25%     -    0s
H    0     0                    -113809.4336 -114888.78  0.95%     -    0s
     0     0 -114141.82    0   27 -113809.43 -114141.82  0.29%     -    0s
     0     0 -114119.01    0   26 -113809.43 -114119.01  0.27%     -    0s
     0     0 -114089.80    0   23 -113809.43 -114089.80  0.25%     -    0s
     0     0 -114086.82    0   20 -113809.43 -114086.82  0.24%     -    0s
     0     0 -114072.21    0   19 -113809.43 -114072.21  0.23%     -    0s
     0     0 -113992.63    0   13 -113809.43 -113992.63  0.16%     -    0s
     0     0 -113971.88    0   14 -113809.43 -113971.88  0.14%     -    0s
H    0     0                    -113820.4032 -113971.88  0.13%     -    0s
     0     0 -113953.76    0   14 -113820.40 -113953.76  0.12%     -    0s
     0     0 -113953.76    0   40 -113820.40 -113953.76  0.12%     -    0s
     0     0 -113891.14    0   15 -113820.40 -113891.14  0.06%     -    0s
H    0     0                    -113837.6907 -113882.86  0.04%     -    0s
     0     0 -113879.65    0   14 -113837.69 -113879.65  0.04%     -    0s
     0     0 -113873.91    0   13 -113837.69 -113873.91  0.03%     -    0s
     0     0 -113873.05    0   13 -113837.69 -113873.05  0.03%     -    0s
     0     0 -113872.67    0   12 -113837.69 -113872.67  0.03%     -    0s

Cutting planes:
  Gomory: 10
  Implied bound: 2
  MIR: 30
  Flow cover: 8
  Relax-and-lift: 5

Explored 1 nodes (775 simplex iterations) in 0.15 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -113838 -113820 -113809 ... 1.24843e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.138376907498e+05, best bound -1.138478251438e+05, gap 0.0089%
  Subproblem solved in 0.19s
  Worst-case operational profit (Z_SP) = 147447.38
  Scenario: 25 demand increases, 35 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -113837.69
  [DEBUG]   S×d_nominal = 261285.07
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 261285.07 + -113837.69 = 147447.38
  [DEBUG]   Current θ from Master = 153813.18
  [DEBUG]   ⚠️  Z_SP ≤ θ by 6365.80 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 3238.21
  Lower Bound (LB) = 3932.29
  Gap (UB-LB) = 5671.7155, Absolute Gap = 5671.7155, Relative Gap = 0.590557
  Not converged yet (gap = 5671.72 > ε = 200)

  [DEBUG] Adding NEW scenario 9 to Master Problem...
  [DEBUG] New scenario pattern: 25 increases, 35 decreases
    [DEBUG] Scenario 9 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 9 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 9]
    [DEBUG]   - Total constraints in model: 154283
    [DEBUG]   - Total variables in model: 64660
  [DEBUG] Total scenarios in Master: 10
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 10
================================================================================
[Iteration 10] Solving Master Problem...
  Current scenarios in Master: 10
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 154283 rows, 64660 columns and 437889 nonzeros
Model fingerprint: 0xf56ce1a9
Variable types: 62401 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 68800 rows and 27940 columns
Presolve time: 2.88s
Presolved: 85483 rows, 36720 columns, 521699 nonzeros
Variable types: 34461 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -361312.0046
Found heuristic solution: objective -183019.6155

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.28s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.691e+06
 Factor NZ  : 8.008e+06 (roughly 110 MB of memory)
 Factor Ops : 1.396e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.74996546e+07  1.57403262e+08  1.03e+05 2.10e+01  7.75e+04     5s
   1  -1.32709420e+07  1.38867724e+08  7.18e+04 9.40e+01  5.36e+04     5s
   2  -3.93632923e+06  1.05595826e+08  2.07e+04 1.19e-01  1.60e+04     5s
   3  -1.83212853e+06  1.00957037e+08  5.98e+03 2.08e+00  5.06e+03     5s
   4  -8.13144429e+05  8.08194032e+07  8.59e+02 1.22e+00  1.13e+03     5s
   5  -6.26810073e+05  3.40662589e+07  5.10e+02 1.04e-01  5.38e+02     5s
   6  -5.23505560e+05  2.43514229e+07  2.53e+02 9.79e-12  3.06e+02     5s
   7  -4.86422419e+05  1.81577744e+07  2.00e+02 1.20e-11  2.28e+02     5s
   8  -3.27096940e+05  1.41952494e+07  7.69e+01 1.10e-11  1.31e+02     5s
   9  -2.31210422e+05  1.16651067e+07  4.38e+01 9.67e-12  9.57e+01     5s
  10  -1.58653660e+05  8.96844035e+06  2.38e+01 6.79e-12  6.72e+01     5s
  11  -1.20858968e+05  4.61342960e+06  1.03e+01 4.63e-12  3.27e+01     6s
  12  -7.67673619e+04  2.37679012e+06  1.72e+00 5.60e-12  1.59e+01     6s
  13  -5.36591198e+04  7.72863616e+05  7.83e-01 2.72e-12  5.31e+00     6s
  14  -2.90518793e+04  3.88540390e+05  4.65e-01 1.84e-12  2.67e+00     6s
  15  -1.63785974e+04  2.41992011e+05  3.08e-01 9.87e-05  1.65e+00     6s
  16  -6.86824022e+03  1.68127931e+05  2.18e-01 2.02e-04  1.12e+00     6s
  17  -2.25767745e+03  1.30910381e+05  1.82e-01 1.25e-03  8.51e-01     6s
  18   4.90943662e+03  9.94703963e+04  1.43e-01 2.68e-03  6.04e-01     6s
  19   1.23038319e+04  7.41499524e+04  1.05e-01 1.99e-03  3.95e-01     6s
  20   1.68987501e+04  6.38341547e+04  8.56e-02 1.54e-03  3.00e-01     6s
  21   2.07706227e+04  5.61132475e+04  6.88e-02 1.42e-03  2.26e-01     6s
  22   2.39448672e+04  5.12797867e+04  5.55e-02 1.27e-03  1.75e-01     6s
  23   2.63104779e+04  4.83693576e+04  4.57e-02 1.14e-03  1.41e-01     7s
  24   2.86188375e+04  4.48837864e+04  3.67e-02 7.63e-04  1.04e-01     7s
  25   3.10555425e+04  4.36835804e+04  2.72e-02 6.15e-04  8.07e-02     7s
  26   3.23999975e+04  4.24805627e+04  2.22e-02 4.72e-04  6.44e-02     7s
  27   3.40244058e+04  4.16353141e+04  1.62e-02 3.75e-04  4.86e-02     7s
  28   3.53867473e+04  4.09524125e+04  1.14e-02 3.26e-04  3.55e-02     7s
  29   3.59858675e+04  4.02253015e+04  9.14e-03 2.25e-04  2.71e-02     7s
  30   3.63491304e+04  3.98563636e+04  7.90e-03 1.62e-04  2.24e-02     7s
  31   3.70991783e+04  3.96286589e+04  5.36e-03 1.33e-04  1.62e-02     7s
  32   3.73728177e+04  3.92924615e+04  4.45e-03 8.00e-05  1.23e-02     8s
  33   3.76339067e+04  3.90907689e+04  3.59e-03 4.86e-05  9.31e-03     8s
  34   3.81151756e+04  3.89806393e+04  2.03e-03 3.12e-05  5.53e-03     8s
  35   3.82525688e+04  3.89092346e+04  1.60e-03 1.94e-05  4.20e-03     8s
  36   3.84837620e+04  3.88587460e+04  8.75e-04 1.11e-05  2.40e-03     8s
  37   3.84932510e+04  3.88513988e+04  8.46e-04 1.00e-05  2.29e-03     8s
  38   3.85123282e+04  3.88353269e+04  7.90e-04 7.53e-06  2.06e-03     8s
  39   3.85274136e+04  3.88336944e+04  7.46e-04 7.24e-06  1.96e-03     8s
  40   3.86957787e+04  3.87977168e+04  2.36e-04 5.32e-05  6.51e-04     9s
  41   3.87405008e+04  3.87933970e+04  1.10e-04 3.75e-05  3.38e-04     9s
  42   3.87512101e+04  3.87916200e+04  8.10e-05 3.12e-05  2.58e-04     9s
  43   3.87590301e+04  3.87902047e+04  6.03e-05 2.62e-05  1.99e-04     9s
  44   3.87700870e+04  3.87879233e+04  3.08e-05 1.77e-05  1.14e-04     9s
  45   3.87822209e+04  3.87843789e+04  8.68e-07 4.47e-06  1.37e-05     9s
  46   3.87829120e+04  3.87829412e+04  1.06e-08 6.69e-07  1.85e-07     9s
  47   3.87829207e+04  3.87829207e+04  1.31e-09 3.49e-09  1.86e-10     9s

Barrier solved model in 47 iterations and 9.32 seconds (7.27 work units)
Optimal objective 3.87829207e+04


Root crossover log...

   76247 DPushes remaining with DInf 0.0000000e+00                 9s
   16523 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                11s

    1346 PPushes remaining with PInf 3.8560980e-06                11s
       0 PPushes remaining with PInf 0.0000000e+00                12s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.6977818e-01     12s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   32508    3.8782921e+04   0.000000e+00   1.697782e-01     12s
   32510    3.8782921e+04   0.000000e+00   0.000000e+00     12s
   32510    3.8782921e+04   0.000000e+00   0.000000e+00     12s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 3.878292e+04, 32510 iterations, 8.14 seconds (7.83 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 38782.9207    0  182 -183019.62 38782.9207   121%     -   12s
H    0     0                    -177885.6564 38782.9207   122%     -   12s
H    0     0                    -90090.02972 38782.9207   143%     -   12s
H    0     0                    -27923.58980 38782.9207   239%     -   12s
H    0     0                    -27003.00840 38782.9207   244%     -   13s
H    0     0                    -26887.87091 38782.9207   244%     -   13s
H    0     0                    -24353.97999 38782.9207   259%     -   13s
H    0     0                    -23720.16687 38782.9207   264%     -   13s
H    0     0                    -23628.91008 38782.9207   264%     -   13s
H    0     0                    -21485.24533 38782.9207   281%     -   15s
H    0     0                    -18358.91389 38782.9207   311%     -   15s
H    0     0                    -12106.67467 38782.9207   420%     -   15s
     0     0 32415.2733    0  241 -12106.675 32415.2733   368%     -   56s
H    0     0                    -9659.200837 32415.2733   436%     -   57s
H    0     0                    -9368.623483 32415.2733   446%     -   57s
H    0     0                    -7841.154499 32415.2733   513%     -   57s
H    0     0                    -7674.876636 32415.2733   522%     -   57s
H    0     0                    -7667.594910 32415.2733   523%     -   57s
H    0     0                    -7396.495739 32415.2733   538%     -   57s
H    0     0                    -7348.555055 32415.2733   541%     -   57s
H    0     0                    -7343.536078 32415.2733   541%     -   57s
H    0     0                    -7262.574807 32415.2733   546%     -   57s
     0     0 31486.2485    0  219 -7262.5748 31486.2485   534%     -   89s
     0     0 29000.9213    0  249 -7262.5748 29000.9213   499%     -  104s
     0     0 28999.4781    0  235 -7262.5748 28999.4781   499%     -  108s
     0     0 28999.4781    0  220 -7262.5748 28999.4781   499%     -  111s
     0     0 28999.4781    0  236 -7262.5748 28999.4781   499%     -  112s
     0     0 28999.4781    0  236 -7262.5748 28999.4781   499%     -  112s
     0     0 28511.1900    0  323 -7262.5748 28511.1900   493%     -  151s
H    0     0                    -2612.836206 28510.9740  1191%     -  152s
H    0     0                    -1996.573818 28510.9740  1528%     -  152s
H    0     0                    -1616.551607 28510.9740  1864%     -  152s
H    0     0                    -1588.053050 28510.9740  1895%     -  152s
H    0     0                    -1586.891535 28510.9740  1897%     -  152s
H    0     0                    -1319.039416 28510.9740  2261%     -  152s
H    0     0                    -1313.358011 28510.9740  2271%     -  152s
     0     0 28099.9911    0  314 -1313.3580 28099.9911  2240%     -  169s
     0     0 28000.1267    0  321 -1313.3580 28000.1267  2232%     -  175s
     0     0 27935.8510    0  328 -1313.3580 27935.8510  2227%     -  185s
     0     0 27774.0668    0  342 -1313.3580 27774.0668  2215%     -  193s
     0     0 27737.1308    0  389 -1313.3580 27737.1308  2212%     -  199s
     0     0 27728.0129    0  342 -1313.3580 27728.0129  2211%     -  203s
     0     0 27725.9144    0  342 -1313.3580 27725.9144  2211%     -  203s
     0     0 27676.8917    0  340 -1313.3580 27676.8917  2207%     -  207s
     0     0 27673.3937    0  338 -1313.3580 27673.3937  2207%     -  209s
     0     0 27673.3871    0  339 -1313.3580 27673.3871  2207%     -  209s
     0     0 24993.1928    0  383 -1313.3580 24993.1928  2003%     -  256s
H    0     0                    -1207.197062 24990.7657  2170%     -  257s
     0     0 24545.9928    0  427 -1207.1971 24545.9928  2133%     -  275s
H    0     0                    -924.8923828 24371.6406  2735%     -  283s
H    0     0                    -745.8953630 24371.6406  3367%     -  283s
H    0     0                    -702.8410395 24371.6406  3568%     -  283s
     0     0 24371.6406    0  453 -702.84104 24371.6406  3568%     -  283s
     0     0 24251.0147    0  484 -702.84104 24251.0147  3550%     -  293s
     0     0 24209.5507    0  493 -702.84104 24209.5507  3545%     -  297s
     0     0 24179.6969    0  509 -702.84104 24179.6969  3540%     -  302s
     0     0 24132.2658    0  446 -702.84104 24132.2658  3534%     -  306s
     0     0 24117.2763    0  447 -702.84104 24117.2763  3531%     -  308s
     0     0 24098.9384    0  436 -702.84104 24098.9384  3529%     -  311s
     0     0 24074.6723    0  430 -702.84104 24074.6723  3525%     -  313s
     0     0 24064.9513    0  441 -702.84104 24064.9513  3524%     -  314s
     0     0 24057.6355    0  432 -702.84104 24057.6355  3523%     -  316s
     0     0 24055.9698    0  442 -702.84104 24055.9698  3523%     -  317s
     0     0 23274.1877    0  387 -702.84104 23274.1877  3411%     -  347s
     0     0 23084.1878    0  467 -702.84104 23084.1878  3384%     -  354s
     0     0 23028.7740    0  439 -702.84104 23028.7740  3377%     -  360s
     0     0 23019.4846    0  478 -702.84104 23019.4846  3375%     -  362s
     0     0 23012.0673    0  485 -702.84104 23012.0673  3374%     -  365s
     0     0 23008.8430    0  451 -702.84104 23008.8430  3374%     -  367s
     0     0 23006.6126    0  493 -702.84104 23006.6126  3373%     -  368s
     0     0 23005.7521    0  452 -702.84104 23005.7521  3373%     -  369s
     0     0 22918.4068    0  369 -702.84104 22918.4068  3361%     -  378s
H    0     0                    -595.5450374 22916.9916  3948%     -  378s
H    0     0                    -505.5874365 22916.9916  4633%     -  379s
     0     0 22866.5877    0  381 -505.58744 22866.5877  4623%     -  384s
     0     0 22845.0801    0  427 -505.58744 22845.0801  4619%     -  389s
     0     0 22830.7877    0  421 -505.58744 22830.7877  4616%     -  393s
     0     0 22819.2717    0  368 -505.58744 22819.2717  4613%     -  395s
     0     0 22817.5929    0  376 -505.58744 22817.5929  4613%     -  396s
     0     0 22768.4766    0  494 -505.58744 22768.4766  4603%     -  403s
H    0     0                    -457.8833282 22768.4330  5073%     -  407s
H    0     0                    -286.5579192 22768.4330  8045%     -  407s
     0     0 22748.8791    0  419 -286.55792 22748.8791  8039%     -  409s
     0     0 22741.1802    0  524 -286.55792 22741.1802  8036%     -  411s
     0     0 22739.9804    0  423 -286.55792 22739.9804  8036%     -  412s
     0     0 22725.8097    0  369 -286.55792 22725.8097  8031%     -  416s
H    0     0                    -281.4193196 22721.9390  8174%     -  417s
H    0     0                    -143.7576104 22721.9390      -     -  417s
     0     0 22716.8342    0  480 -143.75761 22716.8342      -     -  420s
     0     0 22713.0913    0  521 -143.75761 22713.0913      -     -  421s
     0     0 22712.0054    0  423 -143.75761 22712.0054      -     -  422s
     0     0 22705.6409    0  365 -143.75761 22705.6409      -     -  427s
H    0     0                    -133.9933754 22705.3285      -     -  428s
H    0     0                     177.2897269 22705.3285      -     -  428s
H    0     0                     182.9923458 22705.3285      -     -  429s
     0     0 22701.1008    0  384  182.99235 22701.1008      -     -  432s
     0     0 22700.7592    0  387  182.99235 22700.7592      -     -  434s
     0     0 22698.5441    0  385  182.99235 22698.5441      -     -  437s
H    0     0                     400.3161192 22693.8708  5569%     -  438s
     0     0 22693.8708    0  442  400.31612 22693.8708  5569%     -  440s
     0     0 22693.8708    0  480  400.31612 22693.8708  5569%     -  441s
     0     0 22693.8708    0  372  400.31612 22693.8708  5569%     -  445s
     0     0 22692.5142    0  372  400.31612 22692.5142  5569%     -  447s
H    0     0                     540.3786789 22692.5142  4099%     -  494s
H    0     0                     549.2256936 22692.5142  4032%     -  522s
H    0     0                    1785.2432250 22692.5142  1171%     -  529s
H    0     2                    1786.3084177 22692.5142  1170%     -  536s
     0     2 22692.5142    0  372 1786.30842 22692.5142  1170%     -  536s
     1     4 22472.9730    1  353 1786.30842 22692.5142  1170%  8510  546s
     3     8 22260.7067    2  486 1786.30842 22472.6051  1158%  7784  577s
     7    16 22150.7246    3  445 1786.30842 22260.4326  1146% 10646  592s
    15    31 21450.3643    4  438 1786.30842 22148.6361  1140% 10454  617s
    30    46 20891.8803    5  380 1786.30842 21750.7977  1118% 16271  692s
    45    77 17886.6013    6  311 1786.30842 21450.0364  1101% 15159  787s
H   53    77                    1860.8702292 21450.0364  1053% 15092  787s
    76   162 17737.8473    7  319 1860.87023 21450.0364  1053% 14368  837s
H  161   236                    1865.8892065 21450.0364  1050% 11002  875s
H  175   236                    1887.4392082 21450.0364  1036% 10597  875s
   235   337 10700.6948   13  231 1887.43921 21450.0364  1036%  9346  903s
   336   416 9722.54347   18  224 1887.43921 21450.0364  1036%  7531  929s
H  341   416                    1892.4581856 21450.0364  1033%  7431  929s
H  357   416                    1940.4721415 21450.0364  1005%  7243  929s
H  359   416                    1963.2955445 21450.0364   993%  7228  929s
H  378   416                    1998.3509519 21450.0364   973%  7005  929s
   415   495 8918.36258   23  225 1998.35095 21450.0364   973%  6743  958s
   494   534     cutoff   28      1998.35095 21450.0364   973%  6183  984s
H  495   534                    2106.3137271 21450.0364   918%  6170  984s
   553   560 4906.87876   27  199 2106.31373 21450.0364   918%  5955 1010s
   601   587 4891.51545   28  198 2106.31373 21450.0364   918%  5841 1034s
H  604   587                    2133.3993804 21450.0364   905%  5818 1034s
H  626   587                    2217.2647532 21450.0364   867%  5790 1034s
H  643   592                    4582.9943028 21450.0364   368%  5735 1057s
H  650   592                    4790.8989536 21450.0364   348%  5724 1057s
   675   591     cutoff   32      4790.89895 21450.0364   348%  5717 1083s
H  690   591                    5017.0473809 21450.0364   328%  5698 1083s
   737   614 14133.6353   13  377 5017.04738 21450.0364   328%  5532 1110s
H  784   635                    5090.9882287 21450.0364   321%  5457 1136s
H  791   635                    5609.2596516 21450.0364   282%  5452 1136s
H  812   635                    6903.9323255 21450.0364   211%  5393 1136s
   837   645 11201.7461   16  387 6903.93233 21450.0364   211%  5329 1163s
   901   665 10647.9815   17  319 6903.93233 21450.0364   211%  5293 1190s
H  912   665                    7965.8807361 21450.0364   169%  5297 1190s
   945   702 10362.7379   18  319 7965.88074 21450.0364   169%  5314 1220s
  1000   718     cutoff   19      7965.88074 21450.0364   169%  5252 1248s
H 1011   718                    8430.8990933 21450.0364   154%  5252 1248s
  1032   735 9805.77398   18  304 8430.89909 21450.0364   154%  5285 1278s
  1108   752 9508.38832   19  258 8430.89909 21450.0364   154%  5152 1308s
H 1113   752                    8451.1864185 21450.0364   154%  5135 1308s
H 1127   752                    8564.4622537 21450.0364   150%  5120 1308s
H 1165   763                    8566.3918811 21450.0364   150%  5114 1341s
H 1183   763                    8677.2915874 21450.0364   147%  5148 1341s
H 1196   763                    8788.6155316 21450.0364   144%  5134 1341s
  1206   796     cutoff   24      8788.61553 21450.0364   144%  5115 1373s
H 1208   796                    9013.8636458 21450.0364   138%  5111 1373s
H 1216   796                    9040.9798409 21450.0364   137%  5089 1373s
H 1234   796                    9318.4500342 21450.0364   130%  5085 1373s
  1280   815 15745.8837   12  371 9318.45003 21450.0364   130%  5060 1411s
H 1365   855                    9332.7876185 21450.0364   130%  4981 1447s
H 1376   855                    9423.0282981 21450.0364   128%  4995 1447s
  1431   891 13714.3410   15  297 9423.02830 21450.0364   128%  5014 1486s
H 1517   950                    9512.7435964 21450.0364   125%  4988 1523s
  1620  1017 12976.8328   21  268 9512.74360 21450.0364   125%  4875 1561s
  1735  1089 12095.7927   31  248 9512.74360 21450.0364   125%  4790 1600s
H 1756  1089                    9516.6244698 21450.0364   125%  4765 1600s
H 1773  1089                    9545.0404211 21450.0364   125%  4757 1600s
  1849  1158 11420.1103   42  219 9545.04042 21450.0364   125%  4713 1643s
  1970  1237 infeasible   34      9545.04042 21450.0364   125%  4646 1687s
  2079  1314 10686.1169   38  243 9545.04042 21450.0364   125%  4629 1723s
H 2125  1314                    9579.7522628 21450.0364   124%  4586 1723s
  2200  1349 infeasible   41      9579.75226 21450.0364   124%  4556 1760s
H 2236  1349                    9581.8706644 21450.0364   124%  4531 1760s
  2278  1472 13007.3622    8  262 9581.87066 21450.0364   124%  4519 1810s
  2470  1539 12120.1240    9  252 9581.87066 21450.0364   124%  4380 1858s
  2653  1636 11649.3588    9  216 9581.87066 21450.0364   124%  4296 1908s
  2812  1673 infeasible   10      9581.87066 21450.0364   124%  4266 1964s
  2959  1734 12313.8212   10  286 9581.87066 21450.0364   124%  4282 2020s
  3104  1724 10807.2657   11  267 9581.87066 21028.8375   119%  4312 2075s
H 3110  1724                    9586.8854189 21028.8375   119%  4320 2075s
  3158  1796 infeasible   12      9586.88542 21028.8375   119%  4351 2137s
  3305  1725 10323.5781   11  238 9586.88542 21028.8375   119%  4368 2191s
  3346  1754 infeasible   12      9586.88542 21028.8375   119%  4396 2233s
  3411  1775 infeasible   12      9586.88542 18886.7178  97.0%  4387 2294s
  3529  1829 14695.9376    7  331 9586.88542 18886.7178  97.0%  4388 2357s
  3731  1852 12871.7134    8  293 9586.88542 18886.7178  97.0%  4352 2429s
  3935  1916 11757.0369    9  297 9586.88542 18692.0574  95.0%  4335 2506s
  4069  2022     cutoff   11      9586.88542 18692.0574  95.0%  4394 2585s
  4274  2041 13915.0920   20  431 9586.88542 18617.7654  94.2%  4383 2658s
  4317  2069 13745.6478   21  390 9586.88542 18617.7654  94.2%  4411 2744s
  4357  2094 12627.1084   22  330 9586.88542 18432.0644  92.3%  4422 2816s
  4401  2095 16820.0991   18  372 9586.88542 18432.0644  92.3%  4440 2906s
  4403  2096 17539.7766   10  170 9586.88542 18432.0644  92.3%  4438 2919s
  4404  2097 11765.2308   35  369 9586.88542 18432.0644  92.3%  4437 2993s
  4405  2098 12760.5977   20  385 9586.88542 18432.0644  92.3%  4436 3048s
  4406  2098 12647.7911   26  439 9586.88542 18432.0644  92.3%  4435 3083s
  4407  2099 9974.95984   33  377 9586.88542 18432.0644  92.3%  4434 3118s
  4408  2100 13362.9537   15  456 9586.88542 18432.0644  92.3%  4433 3140s
  4409  2100 11551.9267   32  418 9586.88542 18432.0644  92.3%  4432 3148s
  4410  2101 16636.9660   14  440 9586.88542 18432.0644  92.3%  4431 3155s
  4412  2102 10987.9079   37  438 9586.88542 18432.0644  92.3%  4429 3162s
  4413  2103 13279.3975   30  432 9586.88542 18432.0644  92.3%  4428 3173s
  4414  2104 12153.1761   34  433 9586.88542 18432.0644  92.3%  4427 3178s
  4415  2104 14342.6404   14  515 9586.88542 18432.0644  92.3%  4426 3184s
  4416  2105 12990.7265   13  448 9586.88542 18432.0644  92.3%  4425 3197s
  4417  2106 13028.6797   20  408 9586.88542 18432.0644  92.3%  4424 3202s
  4418  2106 10109.4945   35  361 9586.88542 18432.0644  92.3%  4423 3217s
  4419  2107 9929.10995   17  406 9586.88542 18432.0644  92.3%  4422 3224s
  4420  2108 9971.28194   35  457 9586.88542 18432.0644  92.3%  4421 3233s
  4421  2108 15697.1410   18  435 9586.88542 18432.0644  92.3%  4420 3247s
  4422  2109 12066.3109   22  414 9586.88542 18432.0644  92.3%  4419 3254s
  4423  2110 11753.1967   21  409 9586.88542 18432.0644  92.3%  4418 3260s
  4424  2110 17643.2006   12  377 9586.88542 18432.0644  92.3%  4417 3267s
  4425  2111 15981.2460    7  444 9586.88542 18432.0644  92.3%  4416 3283s
  4426  2112 14149.8319   19  391 9586.88542 18432.0644  92.3%  4415 3290s
  4427  2112 12651.8387   20  483 9586.88542 18432.0644  92.3%  4414 3296s
  4428  2113 17959.0739   11  477 9586.88542 18432.0644  92.3%  4413 3309s
  4429  2114 17393.7669   13  581 9586.88542 18432.0644  92.3%  4412 3318s
  4430  2114 10538.6302   48  478 9586.88542 18432.0644  92.3%  4411 3329s
  4431  2115 10163.9634   25  438 9586.88542 18432.0644  92.3%  4410 3336s
  4432  2116 10108.5633   41  484 9586.88542 18432.0644  92.3%  4409 3347s
  4433  2116 10455.4723   28  453 9586.88542 18432.0644  92.3%  4408 3354s
  4434  2117 13950.7672   13  481 9586.88542 18432.0644  92.3%  4407 3366s
  4435  2118 11879.8570   21  481 9586.88542 18432.0644  92.3%  4406 3380s
  4436  2118 11946.6681   14  481 9586.88542 18432.0644  92.3%  4405 3452s
  4437  2121 18432.0644   15  485 9586.88542 18432.0644  92.3%  4475 3498s
  4438  2124 18432.0644   16  451 9586.88542 18432.0644  92.3%  4477 3534s
  4441  2128 18432.0644   17  455 9586.88542 18432.0644  92.3%  4481 3600s

Cutting planes:
  Learned: 2
  Gomory: 4
  Implied bound: 45
  Projected implied bound: 236
  MIR: 922
  Mixing: 1
  Flow cover: 864
  RLT: 30
  Relax-and-lift: 203

Explored 4446 nodes (20301292 simplex iterations) in 3600.05 seconds (5640.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 9586.89 9581.87 9579.75 ... 9040.98

Time limit reached
Best objective 9.586885418943e+03, best bound 1.843206435607e+04, gap 92.2633%
  WARNING: Time limit reached. Using best solution found (gap: 92.26%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 3600.17s
  Master Objective (UB) = 9586.89, θ = 153322.75
  Upper Bound (UB) = 9586.89

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 153322.75
  [DEBUG]   ✓ Scenario 0: θ = 153322.75 ≤ Q = 153322.75 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 153322.75 ≤ Q = 153322.75 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 153322.75 ≤ Q = 153322.75 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 153322.75 ≤ Q = 153322.75 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 153322.75 ≤ Q = 153322.75 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 153322.75 ≤ Q = 153322.75 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 153322.75 ≤ Q = 153322.75 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 153322.75 ≤ Q = 153322.75 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 153322.75 ≤ Q = 153322.75 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 153322.75 ≤ Q = 153322.75 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 10] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x690bc4cb
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x690bc4cb
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.248425e+13
Presolve removed 2593 rows and 1884 columns
Presolve time: 0.01s
Presolved: 500 rows, 505 columns, 1411 nonzeros
Found heuristic solution: objective 6136211.5059
Variable types: 342 continuous, 163 integer (163 binary)
Found heuristic solution: objective 6135817.5024

Root relaxation: objective -1.396856e+05, 236 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -139685.63    0  121 6135817.50 -139685.63   102%     -    0s
H    0     0                    -97896.09431 -139685.63  42.7%     -    0s
H    0     0                    -98768.23134 -139685.63  41.4%     -    0s
H    0     0                    -103947.7122 -139685.63  34.4%     -    0s
     0     0 -115785.24    0   72 -103947.71 -115785.24  11.4%     -    0s
H    0     0                    -113936.9076 -115663.41  1.52%     -    0s
H    0     0                    -114188.3235 -115663.41  1.29%     -    0s
     0     0 -114972.17    0   73 -114188.32 -114972.17  0.69%     -    0s
     0     0 -114922.31    0   70 -114188.32 -114922.31  0.64%     -    0s
     0     0 -114832.68    0   58 -114188.32 -114832.68  0.56%     -    0s
     0     0 -114797.78    0   59 -114188.32 -114797.78  0.53%     -    0s
     0     0 -114712.76    0   53 -114188.32 -114712.76  0.46%     -    0s
     0     0 -114710.39    0   53 -114188.32 -114710.39  0.46%     -    0s
H    0     0                    -114610.6784 -114710.39  0.09%     -    0s
     0     0 -114710.39    0   64 -114610.68 -114710.39  0.09%     -    0s
     0     0 -114710.39    0   51 -114610.68 -114710.39  0.09%     -    0s
     0     0 -114688.74    0   50 -114610.68 -114688.74  0.07%     -    0s
     0     0 -114685.60    0   50 -114610.68 -114685.60  0.07%     -    0s
     0     0 -114662.37    0   49 -114610.68 -114662.37  0.05%     -    0s
     0     0          -    0      -114610.68 -114621.62  0.01%     -    0s

Cutting planes:
  Gomory: 45
  Implied bound: 10
  MIR: 66
  Flow cover: 23
  RLT: 20
  Relax-and-lift: 1

Explored 1 nodes (840 simplex iterations) in 0.15 seconds (0.05 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -114611 -114188 -107848 ... 1.24843e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.146106784476e+05, best bound -1.146216215415e+05, gap 0.0095%
  Subproblem solved in 0.18s
  Worst-case operational profit (Z_SP) = 147410.31
  Scenario: 6 demand increases, 54 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -114610.68
  [DEBUG]   S×d_nominal = 262020.98
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 262020.98 + -114610.68 = 147410.31
  [DEBUG]   Current θ from Master = 153322.75
  [DEBUG]   ⚠️  Z_SP ≤ θ by 5912.44 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 3674.44
  Lower Bound (LB) = 3932.29
  Gap (UB-LB) = 5654.5924, Absolute Gap = 5654.5924, Relative Gap = 0.589826
  Not converged yet (gap = 5654.59 > ε = 200)

  [DEBUG] Adding NEW scenario 10 to Master Problem...
  [DEBUG] New scenario pattern: 6 increases, 54 decreases
    [DEBUG] Scenario 10 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 10 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 10]
    [DEBUG]   - Total constraints in model: 169573
    [DEBUG]   - Total variables in model: 70900
  [DEBUG] Total scenarios in Master: 11
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 11
================================================================================
[Iteration 11] Solving Master Problem...
  Current scenarios in Master: 11
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 169573 rows, 70900 columns and 481126 nonzeros
Model fingerprint: 0xa2637800
Variable types: 68641 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 75688 rows and 30738 columns
Presolve time: 2.92s
Presolved: 93885 rows, 40162 columns, 569377 nonzeros
Variable types: 37903 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -364496.0903
Found heuristic solution: objective -183019.6155

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.29s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 4.224e+06
 Factor NZ  : 9.277e+06 (roughly 130 MB of memory)
 Factor Ops : 1.718e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.82744613e+07  1.70878707e+08  1.07e+05 2.13e+01  8.04e+04     5s
   1  -1.39410067e+07  1.51851435e+08  7.53e+04 9.51e+01  5.58e+04     5s
   2  -3.87432797e+06  1.18829575e+08  2.18e+04 2.27e-11  1.68e+04     5s
   3  -9.50150632e+05  8.19939448e+07  2.75e+03 1.08e+00  2.45e+03     5s
   4  -5.30363132e+05  3.63093696e+07  6.95e+02 1.49e-01  6.62e+02     5s
   5  -3.54601354e+05  2.17805865e+07  2.32e+02 6.75e-02  2.65e+02     5s
   6  -2.11752714e+05  1.58479648e+07  8.64e+01 4.43e-02  1.40e+02     5s
   7  -1.51930709e+05  1.12576510e+07  5.02e+01 2.96e-02  8.92e+01     5s
   8  -1.09860806e+05  7.20702751e+06  2.88e+01 1.73e-02  5.25e+01     5s
   9  -9.75187827e+04  4.95030578e+06  1.79e+01 1.13e-02  3.41e+01     5s
  10  -5.78344788e+04  2.13156464e+06  3.02e+00 4.28e-03  1.31e+01     5s
  11  -2.56165648e+04  4.49483774e+05  1.03e+00 9.32e-04  2.80e+00     6s
  12  -1.63818195e+04  2.13282560e+05  6.62e-01 5.88e-04  1.35e+00     6s
  13  -1.23481011e+04  1.44508915e+05  5.63e-01 4.45e-03  9.19e-01     6s
  14  -5.07015396e+03  1.17428402e+05  4.24e-01 3.17e-03  7.16e-01     6s
  15  -4.09285088e+03  1.09839943e+05  4.09e-01 2.65e-03  6.66e-01     6s
  16   1.52868095e+03  8.78220652e+04  3.37e-01 4.03e-03  5.04e-01     6s
  17   6.33585620e+03  6.80578370e+04  2.82e-01 4.85e-03  3.61e-01     6s
  18   1.01061698e+04  6.24775433e+04  2.47e-01 4.34e-03  3.06e-01     6s
  19   1.44850692e+04  5.52135457e+04  2.05e-01 3.52e-03  2.38e-01     6s
  20   1.66436443e+04  5.27024335e+04  1.85e-01 3.23e-03  2.11e-01     6s
  21   1.98346979e+04  5.08667637e+04  1.58e-01 2.57e-03  1.81e-01     6s
  22   2.21050729e+04  4.74709403e+04  1.38e-01 3.01e-03  1.48e-01     7s
  23   2.43723913e+04  4.64724681e+04  1.18e-01 3.43e-03  1.29e-01     7s
  24   2.52588385e+04  4.46652939e+04  1.10e-01 2.65e-03  1.13e-01     7s
  25   2.77228628e+04  4.40074556e+04  8.79e-02 2.30e-03  9.51e-02     7s
  26   2.85921422e+04  4.31009056e+04  8.00e-02 2.22e-03  8.48e-02     7s
  27   3.00091323e+04  4.22940457e+04  6.73e-02 2.42e-03  7.18e-02     7s
  28   3.07463208e+04  4.09117077e+04  6.01e-02 1.81e-03  5.94e-02     7s
  29   3.22204863e+04  4.03146308e+04  4.79e-02 1.81e-03  4.73e-02     7s
  30   3.33824026e+04  3.97371362e+04  3.84e-02 1.57e-03  3.71e-02     7s
  31   3.45743012e+04  3.92816698e+04  2.87e-02 1.19e-03  2.75e-02     7s
  32   3.51802666e+04  3.90755935e+04  2.37e-02 8.52e-04  2.28e-02     7s
  33   3.56055542e+04  3.88531809e+04  2.04e-02 7.82e-04  1.90e-02     8s
  34   3.59536794e+04  3.87471177e+04  1.77e-02 8.22e-04  1.63e-02     8s
  35   3.62181379e+04  3.85723828e+04  1.56e-02 9.93e-04  1.38e-02     8s
  36   3.65947439e+04  3.84732871e+04  1.26e-02 8.03e-04  1.10e-02     8s
  37   3.67179673e+04  3.84512396e+04  1.17e-02 8.86e-04  1.01e-02     8s
  38   3.68505721e+04  3.84208506e+04  1.07e-02 8.70e-04  9.18e-03     8s
  39   3.69138158e+04  3.83830266e+04  1.02e-02 9.21e-04  8.59e-03     8s
  40   3.71764662e+04  3.83601210e+04  8.16e-03 7.53e-04  6.92e-03     8s
  41   3.72409505e+04  3.83498889e+04  7.65e-03 6.52e-04  6.49e-03     8s
  42   3.73092867e+04  3.83450734e+04  7.14e-03 5.97e-04  6.06e-03     9s
  43   3.73920097e+04  3.83342823e+04  6.53e-03 5.33e-04  5.51e-03     9s
  44   3.75239302e+04  3.83161492e+04  5.57e-03 3.79e-04  4.63e-03     9s
  45   3.75528691e+04  3.83098433e+04  5.35e-03 3.56e-04  4.43e-03     9s
  46   3.76352737e+04  3.83077186e+04  4.71e-03 3.43e-04  3.93e-03     9s
  47   3.76871645e+04  3.83004354e+04  4.31e-03 2.92e-04  3.59e-03     9s
  48   3.77046546e+04  3.82938333e+04  4.18e-03 2.55e-04  3.45e-03     9s
  49   3.77470253e+04  3.82872122e+04  3.85e-03 1.96e-04  3.16e-03     9s
  50   3.79045920e+04  3.82786131e+04  2.65e-03 2.94e-04  2.19e-03     9s
  51   3.79939819e+04  3.82637064e+04  1.95e-03 1.96e-04  1.58e-03    10s
  52   3.80648432e+04  3.82593176e+04  1.43e-03 7.86e-05  1.14e-03    10s
  53   3.80901831e+04  3.82555006e+04  1.23e-03 3.56e-05  9.68e-04    10s
  54   3.81447216e+04  3.82544584e+04  8.04e-04 2.60e-05  6.42e-04    10s
  55   3.81861338e+04  3.82543797e+04  4.87e-04 2.52e-05  3.99e-04    10s
  56   3.82095648e+04  3.82531089e+04  3.08e-04 9.28e-06  2.55e-04    10s
  57   3.82180878e+04  3.82528117e+04  2.45e-04 4.58e-07  2.03e-04    10s
  58   3.82436994e+04  3.82527020e+04  5.71e-05 3.78e-07  5.26e-05    10s
  59   3.82453439e+04  3.82523968e+04  4.61e-05 6.85e-08  4.12e-05    10s
  60   3.82489037e+04  3.82521944e+04  2.04e-05 1.09e-08  1.92e-05    11s
  61   3.82515738e+04  3.82521716e+04  3.19e-06 4.33e-09  3.49e-06    11s
  62   3.82520317e+04  3.82521584e+04  7.29e-07 1.90e-07  7.40e-07    11s
  63   3.82521512e+04  3.82521552e+04  1.19e-08 7.48e-09  2.29e-08    11s
  64   3.82521546e+04  3.82521546e+04  5.50e-10 2.44e-11  1.37e-11    11s

Barrier solved model in 64 iterations and 10.93 seconds (9.49 work units)
Optimal objective 3.82521546e+04


Root crossover log...

   83641 DPushes remaining with DInf 0.0000000e+00                11s
       0 DPushes remaining with DInf 0.0000000e+00                13s

    1246 PPushes remaining with PInf 8.1962327e-07                13s
       0 PPushes remaining with PInf 0.0000000e+00                13s

  Push phase complete: Pinf 0.0000000e+00, Dinf 9.6503115e-11     13s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   32027    3.8252155e+04   0.000000e+00   0.000000e+00     13s
   32027    3.8252155e+04   0.000000e+00   0.000000e+00     13s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 3.825215e+04, 32027 iterations, 9.45 seconds (9.44 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 38252.1546    0  174 -183019.62 38252.1546   121%     -   13s
H    0     0                    -173113.9610 38252.1546   122%     -   13s
H    0     0                    -164465.2231 38252.1546   123%     -   13s
H    0     0                    -159904.5779 38252.1546   124%     -   14s
H    0     0                    -159606.5477 38252.1546   124%     -   14s
H    0     0                    -159571.5823 38252.1546   124%     -   14s
H    0     0                    -88440.53974 38252.1546   143%     -   14s
H    0     0                    -51397.43429 38252.1546   174%     -   14s
H    0     0                    -49702.87431 38252.1546   177%     -   14s
H    0     0                    -31388.87791 38252.1546   222%     -   15s
H    0     0                    -26623.59210 38252.1546   244%     -   15s
H    0     0                    -24946.72336 38252.1546   253%     -   15s
H    0     0                    -24551.57346 38252.1546   256%     -   15s
H    0     0                    -17956.54252 38252.1546   313%     -   17s
H    0     0                    -16806.16286 38252.1546   328%     -   17s
H    0     0                    -13706.01950 38252.1546   379%     -   17s
H    0     0                    -13678.84761 38252.1546   380%     -   17s
H    0     0                    -12830.91023 38252.1546   398%     -   17s
H    0     0                    -12223.89584 38252.1546   413%     -   17s
H    0     0                    -12106.67467 38252.1546   416%     -   17s
H    0     0                    -11900.76803 38251.8675   421%     -   17s
H    0     0                    -11861.36500 38251.8675   422%     -   17s
H    0     0                    -11853.93385 38251.8675   423%     -   17s
H    0     0                    -11848.23123 38251.8675   423%     -   17s
H    0     0                    -8403.856115 34008.8517   505%     -   55s
H    0     0                    -8226.492010 34008.8517   513%     -   55s
H    0     0                    -8220.985447 34008.8517   514%     -   55s
H    0     0                    -8218.435749 34008.8517   514%     -   55s
H    0     0                    -8059.784758 34008.8517   522%     -   55s
H    0     0                    -7981.811000 34008.8517   526%     -   55s
     0     0 33959.6247    0  325 -7981.8110 33959.6247   525%     -   55s
H    0     0                    -7976.792022 33959.6247   526%     -   56s
H    0     0                    -7584.252638 33959.6247   548%     -   56s
H    0     0                    -7490.522911 33959.6247   553%     -   56s
     0     0 32369.9295    0  395 -7490.5229 32369.9295   532%     -   98s
     0     0 32369.9295    0  408 -7490.5229 32369.9295   532%     -  114s
     0     0 32369.9295    0  398 -7490.5229 32369.9295   532%     -  121s
     0     0 32369.9295    0  408 -7490.5229 32369.9295   532%     -  123s
     0     0 32369.9295    0  410 -7490.5229 32369.9295   532%     -  126s
     0     0 32369.9295    0  408 -7490.5229 32369.9295   532%     -  128s
     0     0 32366.0687    0  399 -7490.5229 32366.0687   532%     -  131s
     0     0 32363.7430    0  401 -7490.5229 32363.7430   532%     -  132s
     0     0 32362.8129    0  402 -7490.5229 32362.8129   532%     -  132s
H    0     0                    -6954.725617 28868.3495   515%     -  192s
H    0     0                    -6555.402866 28868.3495   540%     -  192s
H    0     0                    -6047.420997 28868.3495   577%     -  192s
     0     0 28868.3495    0  315 -6047.4210 28868.3495   577%     -  192s
H    0     0                    -2487.198130 28868.2439  1261%     -  193s
H    0     0                    -1242.069881 28868.2439  2424%     -  193s
H    0     0                    -947.8087308 28868.2439  3146%     -  193s
H    0     0                    -934.5855161 28868.2439  3189%     -  193s
H    0     0                    -844.9168634 28868.2439  3517%     -  193s
H    0     0                    -800.7443580 28868.2439  3705%     -  193s
H    0     0                    -677.1458888 28868.2439  4363%     -  193s
H    0     0                    -667.6161330 28868.2439  4424%     -  193s
H    0     0                    -502.1274955 28868.2439  5849%     -  193s
H    0     0                    -428.4927619 28868.2439  6837%     -  193s
H    0     0                    -311.1544319 28868.2439  9378%     -  193s
     0     0 28328.7394    0  301 -311.15443 28328.7394  9204%     -  233s
     0     0 28215.6203    0  445 -311.15443 28215.6203  9168%     -  259s
     0     0 27967.9075    0  370 -311.15443 27967.9075  9088%     -  284s
     0     0 27893.4354    0  385 -311.15443 27893.4354  9064%     -  300s
     0     0 27872.2568    0  379 -311.15443 27872.2568  9058%     -  308s
     0     0 27852.8720    0  356 -311.15443 27852.8720  9051%     -  317s
     0     0 27720.9869    0  482 -311.15443 27720.9869  9009%     -  337s
H    0     0                     -82.7557106 27617.2552      -     -  362s
H    0     0                     -37.7893514 27617.2552      -     -  362s
H    0     0                     -25.2642455 27617.2552      -     -  362s
     0     0 27617.2552    0  388  -25.26425 27617.2552      -     -  362s
     0     0 27608.2875    0  393  -25.26425 27608.2875      -     -  369s
     0     0 27566.5029    0  392  -25.26425 27566.5029      -     -  380s
     0     0 27552.0969    0  404  -25.26425 27552.0969      -     -  386s
     0     0 27550.4486    0  401  -25.26425 27550.4486      -     -  389s
     0     0 27550.3060    0  396  -25.26425 27550.3060      -     -  389s
     0     0 25657.8839    0  505  -25.26425 25657.8839      -     -  472s
     0     0 25330.7680    0  510  -25.26425 25330.7680      -     -  498s
     0     0 25250.0314    0  557  -25.26425 25250.0314      -     -  513s
     0     0 25187.8550    0  518  -25.26425 25187.8550      -     -  529s
     0     0 25077.8060    0  526  -25.26425 25077.8060      -     -  543s
     0     0 24920.5790    0  530  -25.26425 24920.5790      -     -  562s
     0     0 24829.9471    0  542  -25.26425 24829.9471      -     -  579s
     0     0 24716.6594    0  517  -25.26425 24716.6594      -     -  589s
     0     0 24710.4014    0  534  -25.26425 24710.4014      -     -  593s
     0     0 24708.6839    0  534  -25.26425 24708.6839      -     -  596s
     0     0 23820.9037    0  460  -25.26425 23820.9037      -     -  651s
     0     0 23675.6945    0  572  -25.26425 23675.6945      -     -  670s
     0     0 23580.3660    0  591  -25.26425 23580.3660      -     -  682s
     0     0 23465.5702    0  579  -25.26425 23465.5702      -     -  693s
     0     0 23388.4578    0  573  -25.26425 23388.4578      -     -  700s
     0     0 23363.7763    0  569  -25.26425 23363.7763      -     -  705s
     0     0 23351.4943    0  570  -25.26425 23351.4943      -     -  708s
     0     0 23345.6820    0  593  -25.26425 23345.6820      -     -  710s
     0     0 23332.5221    0  508  -25.26425 23332.5221      -     -  714s
     0     0 23328.8677    0  501  -25.26425 23328.8677      -     -  717s
     0     0 23328.3514    0  511  -25.26425 23328.3514      -     -  718s
     0     0 23143.7238    0  409  -25.26425 23143.7238      -     -  736s
     0     0 23076.2264    0  415  -25.26425 23076.2264      -     -  747s
     0     0 23027.5265    0  547  -25.26425 23027.5265      -     -  753s
H    0     0                      54.2053501 23020.7881      -     -  754s
H    0     0                      70.9626095 23020.7881      -     -  754s
     0     0 23020.7881    0  559   70.96261 23020.7881      -     -  754s
H    0     0                     511.6500951 23015.8831  4398%     -  757s
H    0     0                     561.8387468 23015.8831  3997%     -  757s
H    0     0                     667.0972100 23015.8831  3350%     -  757s
     0     0 23015.8831    0  550  667.09721 23015.8831  3350%     -  757s
     0     0 23003.5302    0  564  667.09721 23003.5302  3348%     -  760s
     0     0 22992.8748    0  407  667.09721 22992.8748  3347%     -  763s
     0     0 22989.7778    0  482  667.09721 22989.7778  3346%     -  765s
     0     0 22988.8447    0  489  667.09721 22988.8447  3346%     -  767s
H    0     0                     679.2215902 22892.9551  3270%     -  777s
H    0     0                     686.4276999 22892.9551  3235%     -  777s
H    0     0                     728.6429087 22892.9551  3042%     -  777s
H    0     0                     793.8873633 22892.9551  2784%     -  777s
H    0     0                     863.9203594 22892.9551  2550%     -  777s
H    0     0                     955.3387021 22892.9551  2296%     -  777s
H    0     0                    1040.3322404 22892.9551  2101%     -  777s
H    0     0                    1264.7617760 22892.9551  1710%     -  777s
     0     0 22892.9551    0  459 1264.76178 22892.9551  1710%     -  777s
H    0     0                    1292.3471842 22892.7601  1671%     -  781s
     0     0 22849.5646    0  625 1292.34718 22849.5646  1668%     -  792s
     0     0 22823.2222    0  645 1292.34718 22823.2222  1666%     -  800s
     0     0 22787.4400    0  558 1292.34718 22787.4400  1663%     -  806s
     0     0 22784.6858    0  554 1292.34718 22784.6858  1663%     -  808s
     0     0 22760.0339    0  575 1292.34718 22760.0339  1661%     -  812s
     0     0 22742.6121    0  634 1292.34718 22742.6121  1660%     -  816s
     0     0 22740.1447    0  653 1292.34718 22740.1447  1660%     -  818s
     0     0 22739.8036    0  586 1292.34718 22739.8036  1660%     -  819s
     0     0 22696.3027    0  444 1292.34718 22696.3027  1656%     -  827s
H    0     0                    1495.4061599 22696.2463  1418%     -  827s
     0     0 22682.3696    0  543 1495.40616 22682.3696  1417%     -  832s
     0     0 22674.1966    0  547 1495.40616 22674.1966  1416%     -  835s
     0     0 22672.0102    0  545 1495.40616 22672.0102  1416%     -  837s
     0     0 22644.9353    0  482 1495.40616 22644.9353  1414%     -  843s
H    0     0                    1507.8171536 22644.7339  1402%     -  845s
     0     0 22641.4155    0  491 1507.81715 22641.4155  1402%     -  847s
     0     0 22639.6299    0  502 1507.81715 22639.6299  1401%     -  849s
     0     0 22633.4816    0  561 1507.81715 22633.4816  1401%     -  855s
     0     0 22629.8209    0  456 1507.81715 22629.8209  1401%     -  859s
     0     0 22629.2835    0  464 1507.81715 22629.2835  1401%     -  860s
     0     0 22626.9362    0  475 1507.81715 22626.9362  1401%     -  863s
H    0     0                    1599.3646707 22626.7363  1315%     -  872s
     0     0 22624.4189    0  415 1599.36467 22624.4189  1315%     -  874s
     0     0 22624.0076    0  480 1599.36467 22624.0076  1315%     -  875s
     0     0 22585.8794    0  524 1599.36467 22585.8794  1312%     -  883s
H    0     0                    1683.0653176 22585.4500  1242%     -  884s
     0     0 22578.9625    0  531 1683.06532 22578.9625  1242%     -  887s
     0     0 22481.0561    0  465 1683.06532 22481.0561  1236%     -  894s
     0     0 22454.0346    0  542 1683.06532 22454.0346  1234%     -  898s
     0     0 22451.3969    0  544 1683.06532 22451.3969  1234%     -  901s
     0     0 22449.1074    0  439 1683.06532 22449.1074  1234%     -  903s
     0     0 22339.0656    0  551 1683.06532 22339.0656  1227%     -  912s
H    0     0                    1707.3045009 22338.9094  1208%     -  914s
H    0     0                    1749.6284549 22338.9094  1177%     -  914s
     0     0 22331.0609    0  434 1749.62845 22331.0609  1176%     -  918s
     0     0 22328.1606    0  490 1749.62845 22328.1606  1176%     -  919s
     0     0 22326.1514    0  497 1749.62845 22326.1514  1176%     -  921s
     0     0 22309.7966    0  485 1749.62845 22309.7966  1175%     -  926s
     0     0 22304.3845    0  488 1749.62845 22304.3845  1175%     -  929s
     0     0 22302.1278    0  492 1749.62845 22302.1278  1175%     -  931s
     0     0 22279.8776    0  622 1749.62845 22279.8776  1173%     -  938s
H    0     0                    2196.2091225 22279.5876   914%     -  964s
     0     0 22273.9535    0  644 2196.20912 22273.9535   914%     -  969s
     0     0 22273.4238    0  642 2196.20912 22273.4238   914%     -  970s
     0     0 22270.6745    0  549 2196.20912 22270.6745   914%     -  974s
     0     0 22269.2685    0  484 2196.20912 22269.2685   914%     -  977s
     0     0 22267.0157    0  555 2196.20912 22267.0157   914%     -  981s
     0     0 22266.1357    0  545 2196.20912 22266.1357   914%     -  983s
     0     0 22265.8167    0  639 2196.20912 22265.8167   914%     -  986s
     0     0 22264.9624    0  642 2196.20912 22264.9624   914%     -  987s
     0     0 22263.4532    0  549 2196.20912 22263.4532   914%     -  991s
     0     0 22263.2455    0  549 2196.20912 22263.2455   914%     -  996s
H    0     0                    2857.8184372 22263.2455   679%     - 1042s
H    0     0                    3101.4300522 22263.2455   618%     - 1042s
H    0     0                    3161.6979061 22263.2455   604%     - 1042s
H    0     0                    3287.3659611 22263.2455   577%     - 1042s
H    0     0                    3322.0991038 22263.2455   570%     - 1042s
H    0     0                    3342.5430821 22263.2455   566%     - 1094s
H    0     0                    3384.6625021 22263.2455   558%     - 1096s
H    0     2                    3720.6468710 22263.2455   498%     - 1124s
     0     2 22263.2455    0  549 3720.64687 22263.2455   498%     - 1124s
     1     4 22149.8892    1  481 3720.64687 22263.2455   498%  8869 1135s
     3     8 21598.5145    2  427 3720.64687 22148.7256   495%  9511 1170s
     7    16 21422.7577    3  370 3720.64687 21783.2390   485% 12871 1206s
    15    32 21171.6447    4  398 3720.64687 21422.7536   476% 14104 1242s
    31    48 20715.6953    5  373 3720.64687 21164.3327   469% 18722 2335s
H   47    80                    3720.8028778 21164.3327   469% 22862 2402s
H   77    80                    3730.5352295 21164.3327   467% 19948 2402s
    79   141 19124.9565    7  433 3730.53523 21164.3327   467% 19827 2553s
H  140   181                    4932.5948629 21164.3327   329% 14515 2601s
H  142   181                    4983.9596269 21164.3327   325% 14328 2601s
H  144   181                    5036.5665648 21164.3327   320% 14181 2601s
H  146   181                    5080.7085664 21164.3327   317% 14062 2601s
   180   254 17022.4255   10  391 5080.70857 21164.3327   317% 12357 2659s
   253   338 18892.0438    8  415 5080.70857 21164.3327   317% 11484 2711s
H  332   338                    8352.4163904 21164.3327   153% 10024 2711s
   337   398 16662.0114    9  333 8352.41639 21164.3327   153%  9970 2760s
   421   457 17152.0845    9  398 8352.41639 21164.3327   153%  9008 2808s
   492   504 16775.1754   11  394 8352.41639 21164.3327   153%  8387 2848s
   555   526 16663.3698   12  432 8352.41639 21164.3327   153%  7928 2880s
H  569   526                    8358.3513774 21164.3327   153%  7860 2880s
   583   587 15570.8049   13  304 8358.35138 21164.3327   153%  7861 2923s
   666   615 8395.54601   26  361 8358.35138 21164.3327   153%  7315 2958s
H  680   615                    8358.8001204 21164.3327   153%  7271 2958s
   698   684 15141.6316   14  294 8358.80012 21164.3327   153%  7174 2992s
   810   745 15065.0014   15  272 8358.80012 21164.3327   153%  6550 3025s
   900   806 14502.9050   17  268 8358.80012 21164.3327   153%  6204 3058s
   993   884 12568.2986   16  290 8358.80012 21164.3327   153%  5927 3094s
  1099   972 14495.7634   16  364 8358.80012 21164.3327   153%  5611 3128s
  1222  1007 11198.5836   18  276 8358.80012 21164.3327   153%  5298 3163s
H 1226  1007                    8700.0167392 21164.3327   143%  5287 3163s
H 1231  1007                    8723.7785941 21164.3327   143%  5277 3163s
H 1234  1007                    8989.9615259 21164.3327   135%  5275 3163s
H 1300  1007                    9037.9476489 21164.3327   134%  5118 3163s
  1311  1041 13550.3438   19  284 9037.94765 21164.3327   134%  5089 3205s
  1415  1075 12493.8419   20  336 9037.94765 21164.3327   134%  4964 3249s
  1506  1088 11467.2480   21  257 9037.94765 20889.8793   131%  4899 3293s
  1545  1127     cutoff   21      9037.94765 20888.8655   131%  4939 3349s
H 1553  1127                    9119.6000444 20888.8655   129%  4949 3349s
H 1557  1127                    9227.2374079 20888.8655   126%  4942 3349s
  1610  1239 11366.4411   22  320 9227.23741 20888.8655   126%  4886 3388s
  1781  1301 10696.1873   27  346 9227.23741 20888.8655   126%  4675 3434s
  1925  1356 10348.4099   29  335 9227.23741 20888.8655   126%  4532 3477s
  2064  1408 9968.27043   32  211 9227.23741 20888.8655   126%  4466 3529s
  2185  1469 9963.93421   33  213 9227.23741 20888.8655   126%  4431 3587s
  2306  1487 9501.64302   45  188 9227.23741 20888.8655   126%  4408 3600s

Cutting planes:
  Learned: 1
  Gomory: 11
  Implied bound: 141
  MIR: 2938
  Flow cover: 2640
  RLT: 110
  Relax-and-lift: 803

Explored 2342 nodes (10914202 simplex iterations) in 3600.05 seconds (4687.34 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 9227.24 9119.6 9037.95 ... 5080.71

Time limit reached
Best objective 9.227237407877e+03, best bound 2.088886552864e+04, gap 126.3827%
  WARNING: Time limit reached. Using best solution found (gap: 126.38%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = 9227.24, θ = 153357.66
  Upper Bound (UB) = 9227.24

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 153357.66
  [DEBUG]   ✓ Scenario 0: θ = 153357.66 ≤ Q = 153357.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 153357.66 ≤ Q = 153357.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 153357.66 ≤ Q = 153357.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 153357.66 ≤ Q = 153357.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 153357.66 ≤ Q = 153357.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 153357.66 ≤ Q = 153357.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 153357.66 ≤ Q = 153357.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 153357.66 ≤ Q = 153464.65 (slack: 106.99)
  [DEBUG]   ✓ Scenario 8: θ = 153357.66 ≤ Q = 153357.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 153357.66 ≤ Q = 153357.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 153357.66 ≤ Q = 153357.66 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 11] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x1f365827
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xe0c9a7d9
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.251949e+13
Presolve removed 2587 rows and 1879 columns
Presolve time: 0.01s
Presolved: 506 rows, 510 columns, 1427 nonzeros
Found heuristic solution: objective 6288662.1396
Variable types: 346 continuous, 164 integer (164 binary)

Root relaxation: objective -1.386351e+05, 245 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -138635.07    0  123 6288662.14 -138635.07   102%     -    0s
H    0     0                    -105871.7696 -138635.07  30.9%     -    0s
H    0     0                    -106174.5578 -138635.07  30.6%     -    0s
     0     0 -117941.66    0   71 -106174.56 -117941.66  11.1%     -    0s
H    0     0                    -115888.5874 -117817.23  1.66%     -    0s
H    0     0                    -116222.6022 -117817.23  1.37%     -    0s
     0     0 -116800.32    0   47 -116222.60 -116800.32  0.50%     -    0s
     0     0 -116759.73    0   48 -116222.60 -116759.73  0.46%     -    0s
H    0     0                    -116340.8424 -116759.73  0.36%     -    0s
     0     0 -116568.70    0   17 -116340.84 -116568.70  0.20%     -    0s
     0     0 -116560.45    0   14 -116340.84 -116560.45  0.19%     -    0s
     0     0 -116528.36    0   12 -116340.84 -116528.36  0.16%     -    0s
     0     0 -116517.09    0   11 -116340.84 -116517.09  0.15%     -    0s
     0     0 -116454.45    0   10 -116340.84 -116454.45  0.10%     -    0s
     0     0 -116454.45    0   15 -116340.84 -116454.45  0.10%     -    0s
*    0     0               0    -116391.2957 -116391.30  0.00%     -    0s

Cutting planes:
  Gomory: 4
  Implied bound: 1
  MIR: 6
  Flow cover: 10
  RLT: 1
  Relax-and-lift: 2

Explored 1 nodes (679 simplex iterations) in 0.23 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -116391 -116341 -116223 ... 1.25195e+13
No other solutions better than -116391

Optimal solution found (tolerance 1.00e-04)
Best objective -1.163912956725e+05, best bound -1.163912956725e+05, gap 0.0000%
  Subproblem solved in 0.27s
  Worst-case operational profit (Z_SP) = 145041.14
  Scenario: 30 demand increases, 30 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -116391.30
  [DEBUG]   S×d_nominal = 261432.44
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 261432.44 + -116391.30 = 145041.14
  [DEBUG]   Current θ from Master = 153357.66
  [DEBUG]   ⚠️  Z_SP ≤ θ by 8316.52 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 910.72
  Lower Bound (LB) = 3932.29
  Gap (UB-LB) = 5294.9444, Absolute Gap = 5294.9444, Relative Gap = 0.573839
  Not converged yet (gap = 5294.94 > ε = 200)

  [DEBUG] Adding NEW scenario 11 to Master Problem...
  [DEBUG] New scenario pattern: 30 increases, 30 decreases
    [DEBUG] Scenario 11 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 11 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 11]
    [DEBUG]   - Total constraints in model: 184863
    [DEBUG]   - Total variables in model: 77140
  [DEBUG] Total scenarios in Master: 12
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 12
================================================================================
[Iteration 12] Solving Master Problem...
  Current scenarios in Master: 12
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 184863 rows, 77140 columns and 524363 nonzeros
Model fingerprint: 0x65cf6245
Variable types: 74881 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 82556 rows and 33526 columns
Presolve time: 3.30s
Presolved: 102307 rows, 43614 columns, 618827 nonzeros
Variable types: 41355 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -365019.1989
Found heuristic solution: objective -183019.6155

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.29s

Barrier statistics:
 Dense cols : 674
 AA' NZ     : 3.346e+06
 Factor NZ  : 8.126e+06 (roughly 130 MB of memory)
 Factor Ops : 1.586e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.89715126e+07  1.84880003e+08  1.11e+05 2.00e+01  8.30e+04     5s
   1  -1.44974620e+07  1.65283802e+08  7.83e+04 9.40e+01  5.78e+04     5s
   2  -7.27760153e+06  1.30155612e+08  3.77e+04 1.09e+00  2.88e+04     5s
   3  -1.18404111e+06  9.89410822e+07  2.96e+03 2.02e+00  2.69e+03     5s
   4  -5.91682779e+05  4.09026394e+07  5.46e+02 2.32e-01  5.73e+02     6s
   5  -4.58638754e+05  2.33504679e+07  2.17e+02 1.10e-01  2.53e+02     6s
   6  -3.24520365e+05  1.74621081e+07  8.33e+01 7.51e-02  1.39e+02     6s
   7  -2.10681768e+05  1.29363053e+07  3.41e+01 5.24e-02  8.58e+01     6s
   8  -1.35242932e+05  8.67042125e+06  1.53e+01 3.26e-02  5.23e+01     6s
   9  -9.86041906e+04  5.75371966e+06  8.61e+00 2.06e-02  3.34e+01     6s
  10  -7.58043206e+04  2.08683568e+06  4.83e+00 6.80e-03  1.21e+01     6s
  11  -5.34194808e+04  1.47889400e+06  2.70e+00 4.79e-03  8.40e+00     6s
  12  -2.86499869e+04  4.60646368e+05  1.41e+00 1.38e-03  2.65e+00     6s
  13  -1.91419653e+04  2.79839435e+05  1.01e+00 7.19e-04  1.62e+00     6s
  14  -9.74967728e+03  1.78838019e+05  6.62e-01 8.14e-04  1.02e+00     6s
  15  -1.01281673e+03  1.21456315e+05  4.66e-01 1.09e-03  6.58e-01     6s
  16   5.16943637e+03  8.69995942e+04  3.84e-01 9.90e-04  4.40e-01     6s
  17   8.50474431e+03  7.36823630e+04  3.40e-01 1.38e-03  3.50e-01     6s
  18   1.39711841e+04  6.44337475e+04  2.73e-01 2.01e-03  2.71e-01     7s
  19   1.84307362e+04  5.77470999e+04  2.17e-01 1.79e-03  2.11e-01     7s
  20   2.19615724e+04  5.49873504e+04  1.75e-01 1.99e-03  1.77e-01     7s
  21   2.32856060e+04  5.10550140e+04  1.59e-01 1.61e-03  1.49e-01     7s
  22   2.53716412e+04  4.84479146e+04  1.34e-01 1.66e-03  1.24e-01     7s
  23   2.73649270e+04  4.61774628e+04  1.12e-01 1.64e-03  1.01e-01     7s
  24   2.80710642e+04  4.38918766e+04  1.04e-01 1.26e-03  8.50e-02     7s
  25   2.98330445e+04  4.28758930e+04  8.47e-02 1.12e-03  7.01e-02     7s
  26   3.13472874e+04  4.17031463e+04  6.83e-02 1.32e-03  5.56e-02     7s
  27   3.29485747e+04  4.05007759e+04  5.15e-02 1.35e-03  4.06e-02     7s
  28   3.41763716e+04  3.97738947e+04  3.92e-02 1.27e-03  3.01e-02     7s
  29   3.48877217e+04  3.94412073e+04  3.20e-02 9.20e-04  2.45e-02     7s
  30   3.55367115e+04  3.91630910e+04  2.55e-02 1.04e-03  1.95e-02     8s
  31   3.60822693e+04  3.88668929e+04  2.04e-02 5.58e-04  1.50e-02     8s
  32   3.62423281e+04  3.87856506e+04  1.88e-02 4.88e-04  1.37e-02     8s
  33   3.63148277e+04  3.87447137e+04  1.81e-02 4.64e-04  1.31e-02     8s
  34   3.64444657e+04  3.86825375e+04  1.68e-02 4.30e-04  1.20e-02     8s
  35   3.66353650e+04  3.85582980e+04  1.49e-02 3.86e-04  1.03e-02     8s
  36   3.69789609e+04  3.85215591e+04  1.16e-02 5.36e-04  8.30e-03     8s
  37   3.70865069e+04  3.85092873e+04  1.06e-02 5.18e-04  7.65e-03     8s
  38   3.72044476e+04  3.84438341e+04  9.47e-03 7.17e-04  6.67e-03     8s
  39   3.73421288e+04  3.83867449e+04  8.17e-03 5.38e-04  5.62e-03     8s
  40   3.76924238e+04  3.83207686e+04  4.79e-03 2.83e-04  3.38e-03     8s
  41   3.77860477e+04  3.83176567e+04  3.94e-03 2.70e-04  2.86e-03     9s
  42   3.78870786e+04  3.82629122e+04  2.99e-03 1.15e-04  2.02e-03     9s
  43   3.79349219e+04  3.82504927e+04  2.55e-03 8.35e-05  1.70e-03     9s
  44   3.80920375e+04  3.82374670e+04  1.08e-03 1.14e-04  7.82e-04     9s
  45   3.81417268e+04  3.82215746e+04  6.31e-04 2.18e-04  4.30e-04     9s
  46   3.81779034e+04  3.82162376e+04  3.16e-04 1.26e-04  2.06e-04     9s
  47   3.82005606e+04  3.82153909e+04  1.17e-04 6.00e-05  7.98e-05     9s
  48   3.82106024e+04  3.82148261e+04  2.77e-05 1.12e-05  2.27e-05     9s
  49   3.82126839e+04  3.82146076e+04  1.27e-05 3.83e-06  1.03e-05     9s
  50   3.82141758e+04  3.82145708e+04  2.27e-06 2.45e-06  2.12e-06     9s
  51   3.82142159e+04  3.82145678e+04  2.00e-06 2.30e-06  1.89e-06     9s
  52   3.82143238e+04  3.82145430e+04  1.24e-06 1.18e-06  1.18e-06    10s
  53   3.82144908e+04  3.82145122e+04  6.75e-08 1.03e-08  1.15e-07    10s
  54   3.82145084e+04  3.82145084e+04  1.73e-11 3.34e-09  1.52e-11    10s

Barrier solved model in 54 iterations and 9.79 seconds (8.81 work units)
Optimal objective 3.82145084e+04


Root crossover log...

   90277 DPushes remaining with DInf 1.0685410e-07                10s
   32958 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                12s

    1528 PPushes remaining with PInf 9.1263770e-07                12s
       0 PPushes remaining with PInf 0.0000000e+00                12s

  Push phase complete: Pinf 0.0000000e+00, Dinf 8.6051544e-02     12s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   34849    3.8214508e+04   0.000000e+00   8.605154e-02     12s
   34850    3.8214508e+04   0.000000e+00   0.000000e+00     12s
   34850    3.8214508e+04   0.000000e+00   0.000000e+00     12s
Concurrent spin time: 0.01s

Solved with barrier

Root relaxation: objective 3.821451e+04, 34850 iterations, 7.88 seconds (8.67 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 38214.5084    0  172 -183019.62 38214.5084   121%     -   12s
H    0     0                    -178504.2218 38214.5084   121%     -   12s
H    0     0                    -90201.80549 38214.5084   142%     -   14s
H    0     0                    -29551.93064 38214.5084   229%     -   14s
H    0     0                    -29496.64556 38214.5084   230%     -   14s
H    0     0                    -28690.40337 38214.5084   233%     -   15s
H    0     0                    -24707.98281 38214.5084   255%     -   15s
H    0     0                    -24219.80925 38214.5084   258%     -   15s
H    0     0                    -21160.76630 38214.5084   281%     -   17s
H    0     0                    -13682.04585 38214.5084   379%     -   17s
H    0     0                    -13672.02431 38214.5084   380%     -   17s
H    0     0                    -13322.34417 38214.5084   387%     -   17s
H    0     0                    -13222.57956 38214.5084   389%     -   17s
H    0     0                    -12868.78813 38214.5084   397%     -   17s
H    0     0                    -12026.71677 38214.5084   418%     -   17s
     0     0 33715.9811    0  404 -12026.717 33715.9811   380%     -   48s
H    0     0                    -8267.565193 33715.2838   508%     -   49s
H    0     0                    -8253.699201 33715.2838   508%     -   49s
H    0     0                    -8050.288977 33715.2838   519%     -   49s
     0     0 32865.9649    0  407 -8050.2890 32865.9649   508%     -   74s
     0     0 32741.5411    0  404 -8050.2890 32741.5411   507%     -   79s
     0     0 32630.1442    0  413 -8050.2890 32630.1442   505%     -   88s
     0     0 32604.5524    0  413 -8050.2890 32604.5524   505%     -   96s
     0     0 32600.3815    0  427 -8050.2890 32600.3815   505%     -   98s
     0     0 32590.2827    0  405 -8050.2890 32590.2827   505%     -  102s
     0     0 32590.1611    0  404 -8050.2890 32590.1611   505%     -  103s
     0     0 29772.0754    0  436 -8050.2890 29772.0754   470%     -  172s
H    0     0                    -7630.494314 29772.0071   490%     -  173s
H    0     0                    -6402.738193 29772.0071   565%     -  173s
H    0     0                    -6029.157298 29772.0071   594%     -  173s
H    0     0                    -5685.090735 29772.0071   624%     -  173s
H    0     0                    -5452.419694 29772.0071   646%     -  173s
H    0     0                    -5397.938370 29772.0071   652%     -  173s
H    0     0                    -5342.118503 29772.0071   657%     -  173s
     0     0 28956.9195    0  411 -5342.1185 28956.9195   642%     -  211s
     0     0 28789.1204    0  401 -5342.1185 28789.1204   639%     -  229s
     0     0 28732.8558    0  446 -5342.1185 28732.8558   638%     -  243s
     0     0 28551.9886    0  456 -5342.1185 28551.9886   634%     -  259s
     0     0 28517.8246    0  467 -5342.1185 28517.8246   634%     -  266s
     0     0 28491.7259    0  429 -5342.1185 28491.7259   633%     -  273s
     0     0 28465.5939    0  474 -5342.1185 28465.5939   633%     -  280s
     0     0 28445.0440    0  467 -5342.1185 28445.0440   632%     -  284s
     0     0 28425.4564    0  484 -5342.1185 28425.4564   632%     -  289s
     0     0 28422.9630    0  480 -5342.1185 28422.9630   632%     -  290s
     0     0 28422.8814    0  475 -5342.1185 28422.8814   632%     -  291s
     0     0 26164.7412    0  360 -5342.1185 26164.7412   590%     -  367s
H    0     0                    -5337.748293 26164.3072   590%     -  368s
     0     0 25461.8087    0  552 -5337.7483 25461.8087   577%     -  423s
H    0     0                    -5040.476777 25286.3618   602%     -  446s
H    0     0                    -4823.149893 25286.3618   624%     -  446s
     0     0 25286.3618    0  565 -4823.1499 25286.3618   624%     -  446s
H    0     0                    -4796.243136 25111.0637   624%     -  458s
     0     0 25111.0637    0  543 -4796.2431 25111.0637   624%     -  458s
     0     0 25070.0062    0  585 -4796.2431 25070.0062   623%     -  467s
     0     0 25055.5189    0  536 -4796.2431 25055.5189   622%     -  471s
     0     0 25017.5967    0  538 -4796.2431 25017.5967   622%     -  478s
H    0     0                    -3712.370387 24961.7450   772%     -  487s
     0     0 24961.7450    0  538 -3712.3704 24961.7450   772%     -  487s
     0     0 24899.6350    0  532 -3712.3704 24899.6350   771%     -  498s
H    0     0                    -3707.351410 24864.0795   771%     -  504s
H    0     0                    -3701.648791 24864.0795   772%     -  504s
     0     0 24864.0795    0  555 -3701.6488 24864.0795   772%     -  504s
     0     0 24855.7075    0  555 -3701.6488 24855.7075   771%     -  508s
     0     0 24837.9404    0  565 -3701.6488 24837.9404   771%     -  513s
     0     0 24830.8902    0  557 -3701.6488 24830.8902   771%     -  516s
     0     0 24824.7427    0  552 -3701.6488 24824.7427   771%     -  520s
     0     0 24822.3907    0  553 -3701.6488 24822.3907   771%     -  522s
     0     0 24817.9836    0  560 -3701.6488 24817.9836   770%     -  523s
     0     0 24809.7233    0  561 -3701.6488 24809.7233   770%     -  525s
     0     0 24806.8196    0  563 -3701.6488 24806.8196   770%     -  527s
     0     0 24805.3071    0  562 -3701.6488 24805.3071   770%     -  528s
     0     0 23550.3760    0  530 -3701.6488 23550.3760   736%     -  572s
H    0     0                    -1860.457543 23549.8197  1366%     -  573s
H    0     0                    -1026.822532 23549.8197  2393%     -  573s
H    0     0                    -1006.510736 23549.8197  2440%     -  573s
H    0     0                    -108.9673441 23549.8197      -     -  573s
     0     0 23214.0121    0  558 -108.96734 23214.0121      -     -  599s
     0     0 23090.8938    0  561 -108.96734 23090.8938      -     -  612s
     0     0 23040.7744    0  559 -108.96734 23040.7744      -     -  621s
     0     0 22981.8451    0  571 -108.96734 22981.8451      -     -  632s
     0     0 22962.5739    0  565 -108.96734 22962.5739      -     -  638s
     0     0 22937.7364    0  552 -108.96734 22937.7364      -     -  647s
     0     0 22916.3086    0  562 -108.96734 22916.3086      -     -  653s
     0     0 22912.5151    0  554 -108.96734 22912.5151      -     -  654s
     0     0 22904.5783    0  562 -108.96734 22904.5783      -     -  657s
     0     0 22899.8329    0  560 -108.96734 22899.8329      -     -  659s
     0     0 22895.9343    0  556 -108.96734 22895.9343      -     -  661s
     0     0 22895.5350    0  556 -108.96734 22895.5350      -     -  662s
     0     0 22695.7309    0  430 -108.96734 22695.7309      -     -  685s
H    0     0                     -53.4438179 22694.2073      -     -  686s
     0     0 22675.6145    0  443  -53.44382 22675.6145      -     -  691s
     0     0 22645.8098    0  507  -53.44382 22645.8098      -     -  698s
     0     0 22636.3380    0  446  -53.44382 22636.3380      -     -  701s
     0     0 22631.9109    0  454  -53.44382 22631.9109      -     -  703s
     0     0 22628.5417    0  448  -53.44382 22628.5417      -     -  706s
     0     0 22615.1598    0  431  -53.44382 22615.1598      -     -  710s
     0     0 22612.2761    0  434  -53.44382 22612.2761      -     -  713s
     0     0 22611.8882    0  580  -53.44382 22611.8882      -     -  714s
     0     0 22552.7503    0  567  -53.44382 22552.7503      -     -  727s
H    0     0                     244.2733347 22552.3109  9132%     -  732s
     0     0 22547.2860    0  568  244.27333 22547.2860  9130%     -  736s
     0     0 22542.4825    0  571  244.27333 22542.4825  9128%     -  741s
     0     0 22540.5082    0  620  244.27333 22540.5082  9128%     -  743s
     0     0 22514.7269    0  429  244.27333 22514.7269  9117%     -  752s
     0     0 22504.6127    0  475  244.27333 22504.6127  9113%     -  759s
     0     0 22501.5619    0  476  244.27333 22501.5619  9112%     -  762s
     0     0 22500.3017    0  475  244.27333 22500.3017  9111%     -  764s
     0     0 22495.6016    0  463  244.27333 22495.6016  9109%     -  768s
     0     0 22491.8743    0  597  244.27333 22491.8743  9108%     -  773s
     0     0 22490.8209    0  467  244.27333 22490.8209  9107%     -  775s
     0     0 22487.6518    0  475  244.27333 22487.6518  9106%     -  780s
     0     0 22485.9662    0  610  244.27333 22485.9662  9105%     -  782s
     0     0 22484.3302    0  472  244.27333 22484.3302  9105%     -  787s
     0     0 22484.0975    0  472  244.27333 22484.0975  9104%     -  792s
H    0     0                     252.5287760 22483.8222  8803%     -  824s
H    0     0                     266.1931517 22483.8222  8346%     -  875s
H    0     2                     467.6087987 22483.8222  4708%     -  895s
     0     2 22483.8222    0  472  467.60880 22483.8222  4708%     -  895s
     1     3 22030.8370    1  444  467.60880 22483.4246  4708% 19547  920s
     2     5 21502.9757    2  483  467.60880 22483.4246  4708% 17174  958s
     4    10 21461.5155    2  363  467.60880 22030.0509  4611% 16882  984s
     9    18 21001.5372    3  460  467.60880 21838.5740  4570% 13712 1035s
    17    36 20929.3449    4  476  467.60880 21456.5459  4489% 16225 1063s
    35    50 20407.0051    5  389  467.60880 20934.2469  4377% 20049 1131s
    49    78 19093.9607    6  444  467.60880 20934.2469  4377% 19928 1199s
H   50    78                    1013.8594794 20934.2469  1965% 19529 1199s
H   59    78                    1695.3586921 20934.2469  1135% 18737 1199s
    77   172 18908.7314    7  355 1695.35869 20934.2469  1135% 17037 1356s
   171   232 16612.5793    8  283 1695.35869 20934.2469  1135% 11666 1401s
H  172   232                    1940.4422930 20934.2469   979% 11598 1401s
H  193   232                    1972.1723837 20934.2469   961% 11114 1401s
H  217   232                    6073.7434826 20934.2469   245% 10428 1401s
   231   294 16418.7874    9  323 6073.74348 20934.2469   245% 10146 1450s
   293   371 15922.2940   12  264 6073.74348 20934.2469   245%  9627 1502s
   370   430 15780.3946   17  260 6073.74348 20934.2469   245%  8839 1542s
   431   495 15631.0290   20  386 6073.74348 20934.2469   245%  8653 1582s
   496   546 15248.8964   23  373 6073.74348 20934.2469   245%  8189 1620s
   547   601 15241.8999   24  333 6073.74348 20934.2469   245%  7961 1662s
   606   634 14842.7180   25  336 6073.74348 20934.2469   245%  7683 1703s
   645   667 13962.2908   26  394 6073.74348 20934.2469   245%  7638 1743s
   686   693 10814.3901   27  329 6073.74348 20934.2469   245%  7561 1781s
H  692   693                    7826.1737182 20934.2469   167%  7532 1781s
   720   744 10394.6682   28  331 7826.17372 20934.2469   167%  7481 1819s
   794   755 14405.5577   29  194 7826.17372 20934.2469   167%  7134 1855s
   819   788 10151.2979   29  329 7826.17372 20934.2469   167%  7085 1893s
H  828   788                    8003.7452482 20934.2469   162%  7054 1893s
H  833   788                    8073.7584502 20934.2469   159%  7057 1893s
   860   824 infeasible   30      8073.75845 20934.2469   159%  7059 1939s
   926   874 10023.2874   29  309 8073.75845 20934.2469   159%  6886 1988s
H  992   905                    8092.5386715 20934.2469   159%  6806 2032s
H  995   905                    8140.5661667 20934.2469   157%  6810 2032s
  1035   933 infeasible   31      8140.56617 20934.2469   157%  6843 2085s
  1113   948     cutoff   30      8140.56617 20934.2469   157%  6727 2135s
  1192   962 infeasible   17      8140.56617 20934.2469   157%  6571 2185s
H 1194   962                    8456.5731432 20934.2469   148%  6575 2185s
  1232   984 14310.2148   11  354 8456.57314 20934.2469   148%  6659 2245s
H 1233   984                    8770.2995758 20934.2469   139%  6653 2245s
H 1240   984                    8793.7586785 20934.2469   138%  6661 2245s
  1306  1037 11937.7220   12  245 8793.75868 20934.2469   138%  6593 2299s
  1381  1100     cutoff   14      8793.75868 20934.2469   138%  6585 2356s
H 1491  1117                    9548.6692297 20934.2469   119%  6439 2409s
  1530  1101     cutoff   15      9548.66923 20934.2469   119%  6422 2470s
H 1549  1101                    9566.0314074 20934.2469   119%  6394 2470s
  1630  1130 17041.9909   11  477 9566.03141 20493.1774   114%  6344 2541s
  1691  1205 15118.2467   12  456 9566.03141 20493.1774   114%  6442 2615s
  1790  1266 14212.1297   13  420 9566.03141 20493.1774   114%  6417 2687s
  1913  1303 12965.8762   15  334 9566.03141 20493.1774   114%  6343 2760s
  2022  1330 infeasible   18      9566.03141 20493.1774   114%  6316 2840s
  2105  1369 11226.8137   14  286 9566.03141 20493.1774   114%  6369 2933s
H 2199  1369                    9570.4704318 20493.1774   114%  6352 2933s
H 2208  1382                    9576.5902273 20493.1774   114%  6348 3008s
  2255  1422 9886.23850   18  280 9576.59023 20493.1774   114%  6394 3097s
  2381  1502 15099.5294   12  328 9576.59023 20493.1774   114%  6361 3193s
  2490  1539 13430.2237   14  312 9576.59023 20493.1774   114%  6420 3277s
  2636  1599 10668.8101   17  222 9576.59023 20493.1774   114%  6394 3367s
  2787  1680 9646.39347   18  465 9576.59023 19753.8780   106%  6371 3472s
  2922  1764 infeasible   19      9576.59023 19388.2337   102%  6378 3573s
  3082  1720 13519.6137   10  264 9576.59023 19388.2337   102%  6373 3600s

Cutting planes:
  Learned: 5
  Gomory: 20
  Implied bound: 188
  MIR: 3202
  Flow cover: 3093
  RLT: 122
  Relax-and-lift: 1062

Explored 3106 nodes (20362492 simplex iterations) in 3600.06 seconds (5370.22 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 9576.59 9566.03 9548.67 ... 8003.75

Time limit reached
Best objective 9.576590227271e+03, best bound 1.938823368512e+04, gap 102.4545%
  WARNING: Time limit reached. Using best solution found (gap: 102.45%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = 9576.59, θ = 153053.72
  Upper Bound (UB) = 9576.59

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 153053.72
  [DEBUG]   ✓ Scenario 0: θ = 153053.72 ≤ Q = 153053.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 153053.72 ≤ Q = 153053.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 153053.72 ≤ Q = 153053.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 153053.72 ≤ Q = 153053.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 153053.72 ≤ Q = 153053.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 153053.72 ≤ Q = 153053.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 153053.72 ≤ Q = 153053.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 153053.72 ≤ Q = 153053.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 153053.72 ≤ Q = 153053.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 153053.72 ≤ Q = 153053.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 153053.72 ≤ Q = 153053.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 153053.72 ≤ Q = 153053.72 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 12] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x25476d93
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xdab8926d
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [2e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.244406e+13
Presolve removed 2593 rows and 1884 columns
Presolve time: 0.01s
Presolved: 500 rows, 505 columns, 1411 nonzeros
Found heuristic solution: objective 6130197.7096
Variable types: 342 continuous, 163 integer (163 binary)
Found heuristic solution: objective 6129803.7061

Root relaxation: objective -1.403490e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -140349.02    0  121 6129803.71 -140349.02   102%     -    0s
H    0     0                    -98637.47220 -140349.02  42.3%     -    0s
     0     0 -115288.24    0   54 -98637.472 -115288.24  16.9%     -    0s
H    0     0                    -113790.9057 -115177.01  1.22%     -    0s
H    0     0                    -113955.3232 -115177.01  1.07%     -    0s
     0     0 -114297.47    0   41 -113955.32 -114297.47  0.30%     -    0s
     0     0 -114288.26    0   37 -113955.32 -114288.26  0.29%     -    0s
     0     0 -114284.49    0   36 -113955.32 -114284.49  0.29%     -    0s
H    0     0                    -113961.7755 -114246.49  0.25%     -    0s
H    0     0                    -114016.1497 -114246.49  0.20%     -    0s
H    0     0                    -114065.3484 -114246.49  0.16%     -    0s
     0     0 -114172.78    0   13 -114065.35 -114172.78  0.09%     -    0s
     0     0 -114155.96    0   17 -114065.35 -114155.96  0.08%     -    0s
     0     0 -114150.92    0   16 -114065.35 -114150.92  0.08%     -    0s
     0     0 -114145.34    0   15 -114065.35 -114145.34  0.07%     -    0s
     0     0 -114143.72    0   15 -114065.35 -114143.72  0.07%     -    0s
     0     0 -114140.49    0   15 -114065.35 -114140.49  0.07%     -    0s
     0     0 -114129.79    0   14 -114065.35 -114129.79  0.06%     -    0s
     0     0 -114129.59    0   14 -114065.35 -114129.59  0.06%     -    0s
     0     0 -114129.58    0   14 -114065.35 -114129.58  0.06%     -    0s
H    0     0                    -114073.0346 -114129.58  0.05%     -    0s
     0     0 -114092.31    0    2 -114073.03 -114092.31  0.02%     -    0s
     0     0 -114092.31    0    8 -114073.03 -114092.31  0.02%     -    0s
H    0     0                    -114080.6236 -114092.31  0.01%     -    0s
     0     0          -    0      -114080.62 -114091.61  0.01%     -    0s

Cutting planes:
  Implied bound: 1
  MIR: 5
  Flow cover: 5
  RLT: 3
  Relax-and-lift: 1

Explored 1 nodes (560 simplex iterations) in 0.09 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -114081 -114073 -114065 ... 1.24441e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.140806235509e+05, best bound -1.140916146203e+05, gap 0.0096%
  Subproblem solved in 0.12s
  Worst-case operational profit (Z_SP) = 148292.46
  Scenario: 19 demand increases, 41 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -114080.62
  [DEBUG]   S×d_nominal = 262373.08
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 262373.08 + -114080.62 = 148292.46
  [DEBUG]   Current θ from Master = 153053.72
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4761.26 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 4815.33
  Lower Bound (LB) = 4815.33
  Gap (UB-LB) = 4761.2583, Absolute Gap = 4761.2583, Relative Gap = 0.497177
  Not converged yet (gap = 4761.26 > ε = 200)

  [DEBUG] Adding NEW scenario 12 to Master Problem...
  [DEBUG] New scenario pattern: 19 increases, 41 decreases
    [DEBUG] Scenario 12 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 12 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 12]
    [DEBUG]   - Total constraints in model: 200153
    [DEBUG]   - Total variables in model: 83380
  [DEBUG] Total scenarios in Master: 13
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 13
================================================================================
[Iteration 13] Solving Master Problem...
  Current scenarios in Master: 13
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 200153 rows, 83380 columns and 567600 nonzeros
Model fingerprint: 0xddb0ef3e
Variable types: 81121 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 89424 rows and 36314 columns
Presolve time: 3.10s
Presolved: 110729 rows, 47066 columns, 667709 nonzeros
Variable types: 44807 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -364803.6993
Found heuristic solution: objective -183019.6155

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.34s

Barrier statistics:
 Dense cols : 667
 AA' NZ     : 3.798e+06
 Factor NZ  : 9.996e+06 (roughly 140 MB of memory)
 Factor Ops : 2.940e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.97201586e+07  1.97874289e+08  1.16e+05 1.82e+01  8.57e+04     5s
   1  -1.51435770e+07  1.78108189e+08  8.16e+04 9.36e+01  5.98e+04     5s
   2  -7.78393404e+06  1.43468520e+08  4.03e+04 6.94e-01  3.08e+04     5s
   3  -1.71102415e+06  1.26382201e+08  5.05e+03 1.21e+01  4.37e+03     5s
   4  -8.39963767e+05  7.59505163e+07  7.73e+02 2.99e+00  9.10e+02     6s
   5  -7.35760492e+05  5.70830052e+07  3.39e+02 2.12e+00  5.06e+02     6s
   6  -6.57864265e+05  3.88902901e+07  2.68e+02 1.26e+00  3.55e+02     6s
   7  -4.90027328e+05  3.15236206e+07  9.67e+01 9.66e-01  2.13e+02     6s
   8  -3.76944265e+05  1.94121092e+07  3.38e+01 4.56e-01  1.13e+02     6s
   9  -2.71963734e+05  1.30080947e+07  1.09e+01 1.10e-02  6.95e+01     6s
  10  -1.78999585e+05  7.11354428e+06  5.56e+00 1.27e-01  3.73e+01     6s
  11  -1.24497571e+05  4.95903059e+06  3.61e+00 2.73e-02  2.57e+01     6s
  12  -9.21704712e+04  2.98234350e+06  2.30e+00 2.27e-03  1.54e+01     6s
  13  -6.55095403e+04  2.07291391e+06  1.42e+00 1.56e-03  1.07e+01     6s
  14  -2.78597938e+04  8.36412414e+05  4.30e-01 1.08e-02  4.28e+00     7s
  15  -1.88012137e+04  4.64569809e+05  2.82e-01 3.21e-04  2.39e+00     7s
  16  -4.27045264e+03  2.62789986e+05  1.21e-01 2.14e-04  1.32e+00     7s
  17   1.03529511e+03  1.36325238e+05  9.30e-02 2.23e-04  6.69e-01     7s
  18   9.23968768e+03  9.53401898e+04  6.55e-02 1.18e-03  4.25e-01     7s
  19   1.15791982e+04  8.92515194e+04  5.96e-02 1.41e-03  3.84e-01     7s
  20   1.46079207e+04  7.95426749e+04  5.20e-02 1.24e-03  3.21e-01     7s
  21   1.82125560e+04  6.88460429e+04  4.36e-02 1.52e-03  2.50e-01     7s
  22   2.20418766e+04  6.41484955e+04  3.48e-02 1.35e-03  2.08e-01     7s
  23   2.37213346e+04  5.47900020e+04  3.10e-02 9.60e-04  1.54e-01     8s
  24   2.49002053e+04  5.20861236e+04  2.84e-02 8.07e-04  1.34e-01     8s
  25   2.68871961e+04  4.91825037e+04  2.41e-02 6.35e-04  1.10e-01     8s
  26   2.85742375e+04  4.74500589e+04  2.06e-02 5.30e-04  9.33e-02     8s
  27   3.05624074e+04  4.59241788e+04  1.65e-02 4.31e-04  7.59e-02     8s
  28   3.18074385e+04  4.40585422e+04  1.39e-02 3.19e-04  6.05e-02     8s
  29   3.32553996e+04  4.29522475e+04  1.10e-02 2.45e-04  4.79e-02     8s
  30   3.40195965e+04  4.20076728e+04  9.45e-03 1.88e-04  3.95e-02     8s
  31   3.45688471e+04  4.14679383e+04  8.38e-03 1.51e-04  3.41e-02     9s
  32   3.61149169e+04  4.11828853e+04  5.55e-03 1.33e-04  2.50e-02     9s
  33   3.67177325e+04  4.05459047e+04  4.39e-03 1.11e-04  1.89e-02     9s
  34   3.71204787e+04  4.03510329e+04  3.62e-03 9.41e-05  1.60e-02     9s
  35   3.73133325e+04  4.01517021e+04  3.25e-03 7.89e-05  1.40e-02     9s
  36   3.74022607e+04  3.98094789e+04  3.08e-03 5.31e-05  1.19e-02     9s
  37   3.79379606e+04  3.96746546e+04  2.07e-03 9.83e-05  8.58e-03    10s
  38   3.81827266e+04  3.95237654e+04  1.62e-03 7.05e-05  6.63e-03    10s
  39   3.82701955e+04  3.93822579e+04  1.47e-03 3.96e-05  5.49e-03    10s
  40   3.86048774e+04  3.93014809e+04  8.73e-04 2.67e-05  3.44e-03    10s
  41   3.87519178e+04  3.92001055e+04  6.06e-04 4.36e-05  2.21e-03    10s
  42   3.88459497e+04  3.91828897e+04  4.43e-04 3.46e-05  1.66e-03    10s
  43   3.89597763e+04  3.91651641e+04  2.50e-04 2.54e-05  1.01e-03    10s
  44   3.90206906e+04  3.91315516e+04  1.52e-04 5.91e-06  5.48e-04    11s
  45   3.91022678e+04  3.91220054e+04  1.69e-05 2.99e-06  9.75e-05    11s
  46   3.91082150e+04  3.91174847e+04  1.01e-05 1.73e-06  4.58e-05    11s
  47   3.91149666e+04  3.91171860e+04  1.98e-06 1.94e-06  1.10e-05    11s
  48   3.91169858e+04  3.91170166e+04  1.64e-08 1.59e-07  1.52e-07    11s
  49   3.91170071e+04  3.91170073e+04  4.67e-10 5.38e-10  7.73e-10    11s

Barrier solved model in 49 iterations and 11.23 seconds (9.84 work units)
Optimal objective 3.91170071e+04


Root crossover log...

   96258 DPushes remaining with DInf 0.0000000e+00                11s
       0 DPushes remaining with DInf 0.0000000e+00                13s

    6335 PPushes remaining with PInf 5.4188299e-05                13s
       0 PPushes remaining with PInf 0.0000000e+00                13s

  Push phase complete: Pinf 0.0000000e+00, Dinf 7.9225646e+01     13s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   47792    3.9117007e+04   0.000000e+00   7.922565e+01     13s
   47803    3.9117007e+04   0.000000e+00   0.000000e+00     13s
   47803    3.9117007e+04   0.000000e+00   0.000000e+00     13s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 3.911701e+04, 47803 iterations, 9.17 seconds (8.39 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 39117.0072    0  208 -183019.62 39117.0072   121%     -   13s
H    0     0                    -179651.1626 39117.0072   122%     -   13s
H    0     0                    -173843.6236 39117.0072   123%     -   14s
H    0     0                    -173335.3298 39117.0072   123%     -   14s
H    0     0                    -164469.5802 39117.0072   124%     -   14s
H    0     0                    -163931.6675 39117.0072   124%     -   15s
H    0     0                    -163484.2288 39117.0072   124%     -   15s
H    0     0                    -144470.5345 39117.0072   127%     -   15s
H    0     0                    -144127.7481 39117.0072   127%     -   15s
H    0     0                    -143612.0118 39117.0072   127%     -   16s
H    0     0                    -143152.0320 39117.0072   127%     -   16s
H    0     0                    -143087.3794 39117.0072   127%     -   16s
H    0     0                    -143086.9565 39117.0072   127%     -   16s
H    0     0                    -143084.4246 39117.0072   127%     -   16s
H    0     0                    -143012.5311 39117.0072   127%     -   16s
H    0     0                    -142998.6244 39117.0072   127%     -   16s
H    0     0                    -142995.9764 39117.0072   127%     -   16s
H    0     0                    -142981.0946 39117.0072   127%     -   16s
H    0     0                    -142834.3777 39117.0072   127%     -   16s
H    0     0                    -142645.4797 39117.0072   127%     -   16s
H    0     0                    -142361.3302 39117.0072   127%     -   16s
H    0     0                    -142260.3586 39117.0072   127%     -   16s
H    0     0                    -122759.3074 39117.0072   132%     -   16s
H    0     0                    -121376.2769 39117.0072   132%     -   16s
H    0     0                    -15715.43906 39117.0072   349%     -   16s
H    0     0                    -15233.04385 39117.0072   357%     -   16s
H    0     0                    -14877.95339 39117.0072   363%     -   16s
H    0     0                    -7341.631917 34027.3551   563%     -   63s
H    0     0                    -7341.521537 34027.3551   563%     -   63s
H    0     0                    -7333.695680 34027.3551   564%     -   63s
     0     0 33834.8498    0  434 -7333.6957 33834.8498   561%     -   64s
H    0     0                    -7291.791068 33834.8498   564%     -   65s
H    0     0                    -7260.018669 33834.8498   566%     -   65s
H    0     0                    -7230.212206 33834.8498   568%     -   65s
     0     0 33355.4691    0  442 -7230.2122 33355.4691   561%     -   89s
     0     0 33204.0116    0  444 -7230.2122 33204.0116   559%     -   97s
     0     0 33194.2821    0  446 -7230.2122 33194.2821   559%     -  101s
     0     0 33190.8901    0  438 -7230.2122 33190.8901   559%     -  108s
     0     0 33190.8901    0  463 -7230.2122 33190.8901   559%     -  120s
     0     0 33190.8901    0  465 -7230.2122 33190.8901   559%     -  123s
     0     0 33190.8901    0  467 -7230.2122 33190.8901   559%     -  125s
     0     0 33190.8901    0  469 -7230.2122 33190.8901   559%     -  126s
H    0     0                    -5292.057953 28905.6107   646%     -  189s
H    0     0                    -5276.070253 28905.6107   648%     -  189s
H    0     0                    -5206.463165 28905.6107   655%     -  189s
H    0     0                    -5175.363078 28905.6107   659%     -  189s
H    0     0                    -5140.188566 28905.6107   662%     -  189s
H    0     0                    -4934.423936 28905.6107   686%     -  189s
H    0     0                    -4802.320708 28905.6107   702%     -  189s
     0     0 28905.6107    0  432 -4802.3207 28905.6107   702%     -  190s
H    0     0                    -4793.473694 28903.3191   703%     -  190s
     0     0 28265.1430    0  480 -4793.4737 28265.1430   690%     -  229s
     0     0 28022.7026    0  490 -4793.4737 28022.7026   685%     -  251s
     0     0 27800.6340    0  485 -4793.4737 27800.6340   680%     -  276s
     0     0 27756.0220    0  509 -4793.4737 27756.0220   679%     -  295s
     0     0 27731.9812    0  498 -4793.4737 27731.9812   679%     -  307s
     0     0 27727.2115    0  508 -4793.4737 27727.2115   678%     -  310s
     0     0 27671.8880    0  485 -4793.4737 27671.8880   677%     -  323s
     0     0 27635.5833    0  442 -4793.4737 27635.5833   677%     -  327s
     0     0 27635.0775    0  436 -4793.4737 27635.0775   677%     -  328s
     0     0 25531.9680    0  474 -4793.4737 25531.9680   633%     -  386s
H    0     0                    -4690.726132 25530.8838   644%     -  387s
H    0     0                    -1962.573811 25180.0026  1383%     -  431s
H    0     0                    -1595.532843 25180.0026  1678%     -  431s
H    0     0                    -1592.190788 25180.0026  1681%     -  431s
H    0     0                    -535.4274524 25180.0026  4803%     -  431s
H    0     0                    -425.5463591 25180.0026  6017%     -  431s
H    0     0                    -419.8437402 25180.0026  6097%     -  431s
     0     0 25180.0026    0  459 -419.84374 25180.0026  6097%     -  431s
     0     0 24955.6930    0  534 -419.84374 24955.6930  6044%     -  459s
     0     0 24895.5280    0  497 -419.84374 24895.5280  6030%     -  475s
     0     0 24854.6308    0  472 -419.84374 24854.6308  6020%     -  485s
     0     0 24832.8682    0  539 -419.84374 24832.8682  6015%     -  494s
     0     0 24759.3462    0  508 -419.84374 24759.3462  5997%     -  509s
     0     0 24658.8193    0  555 -419.84374 24658.8193  5973%     -  526s
     0     0 24625.8789    0  478 -419.84374 24625.8789  5965%     -  536s
     0     0 24617.6281    0  510 -419.84374 24617.6281  5964%     -  540s
     0     0 24613.5909    0  516 -419.84374 24613.5909  5963%     -  542s
     0     0 24591.3878    0  517 -419.84374 24591.3878  5957%     -  551s
     0     0 24581.5299    0  515 -419.84374 24581.5299  5955%     -  557s
     0     0 24576.6896    0  503 -419.84374 24576.6896  5954%     -  560s
     0     0 24574.9696    0  507 -419.84374 24574.9696  5953%     -  564s
     0     0 23344.4009    0  600 -419.84374 23344.4009  5660%     -  636s
     0     0 23149.8275    0  678 -419.84374 23149.8275  5614%     -  657s
     0     0 23120.0212    0  697 -419.84374 23120.0212  5607%     -  670s
     0     0 23095.4658    0  680 -419.84374 23095.4658  5601%     -  680s
     0     0 23082.0812    0  672 -419.84374 23082.0812  5598%     -  687s
     0     0 23074.8001    0  672 -419.84374 23074.8001  5596%     -  691s
     0     0 23068.8177    0  679 -419.84374 23068.8177  5595%     -  695s
     0     0 23062.8051    0  674 -419.84374 23062.8051  5593%     -  699s
     0     0 23056.1617    0  662 -419.84374 23056.1617  5592%     -  702s
     0     0 23051.9624    0  663 -419.84374 23051.9624  5591%     -  706s
     0     0 23048.0128    0  649 -419.84374 23048.0128  5590%     -  709s
     0     0 23038.8520    0  650 -419.84374 23038.8520  5587%     -  712s
     0     0 23033.9993    0  685 -419.84374 23033.9993  5586%     -  716s
     0     0 23033.2742    0  675 -419.84374 23033.2742  5586%     -  718s
     0     0 22841.9324    0  565 -419.84374 22841.9324  5541%     -  743s
     0     0 22810.6981    0  578 -419.84374 22810.6981  5533%     -  753s
     0     0 22804.9798    0  513 -419.84374 22804.9798  5532%     -  759s
     0     0 22803.5832    0  560 -419.84374 22803.5832  5531%     -  761s
     0     0 22761.1301    0  511 -419.84374 22761.1301  5521%     -  774s
     0     0 22750.5748    0  517 -419.84374 22750.5748  5519%     -  792s
     0     0 22747.4962    0  489 -419.84374 22747.4962  5518%     -  796s
     0     0 22745.6019    0  430 -419.84374 22745.6019  5518%     -  799s
     0     0 22739.1699    0  566 -419.84374 22739.1699  5516%     -  806s
     0     0 22729.2031    0  573 -419.84374 22729.2031  5514%     -  813s
H    0     0                    -323.1099565 22724.5972  7133%     -  820s
H    0     0                     415.1410520 22724.5972  5374%     -  820s
H    0     0                     634.7008732 22724.5972  3480%     -  820s
H    0     0                     647.7350863 22724.5972  3408%     -  820s
H    0     0                     653.6657755 22724.5972  3376%     -  820s
     0     0 22724.5972    0  486  653.66578 22724.5972  3376%     -  820s
H    0     0                     658.1330639 22723.3027  3353%     -  823s
H    0     0                     756.9087527 22723.3027  2902%     -  823s
H    0     0                     783.2110167 22723.3027  2801%     -  823s
H    0     0                     807.1401701 22723.3027  2715%     -  823s
     0     0 22723.3027    0  427  807.14017 22723.3027  2715%     -  823s
     0     0 22721.1339    0  558  807.14017 22721.1339  2715%     -  830s
H    0     0                    1112.5767575 22720.9054  1942%     -  834s
H    0     0                    2031.7428789 22720.9054  1018%     -  835s
H    0     0                    2562.2146072 22720.9054   787%     -  835s
     0     0 22720.4770    0  465 2562.21461 22720.4770   787%     -  839s
     0     0 22646.7688    0  402 2562.21461 22646.7688   784%     -  850s
H    0     0                    2654.4940790 22645.5386   753%     -  851s
     0     0 22595.2474    0  458 2654.49408 22595.2474   751%     -  858s
     0     0 22589.9413    0  462 2654.49408 22589.9413   751%     -  864s
     0     0 22588.3930    0  472 2654.49408 22588.3930   751%     -  867s
     0     0 22586.5502    0  406 2654.49408 22586.5502   751%     -  873s
H    0     0                    5625.6610911 22585.7692   301%     -  880s
H    0     0                    5640.9606692 22585.7692   300%     -  880s
     0     0 22585.1689    0  495 5640.96067 22585.1689   300%     -  882s
     0     0 22582.0364    0  552 5640.96067 22582.0364   300%     -  888s
H    0     0                    5645.5058476 22582.0275   300%     -  889s
     0     0 22581.3892    0  558 5645.50585 22581.3892   300%     -  892s
     0     0 22580.4586    0  561 5645.50585 22580.4586   300%     -  897s
     0     0 22579.8133    0  561 5645.50585 22579.8133   300%     -  905s
H    0     0                    5728.5029995 22579.8133   294%     -  926s
H    0     0                    5789.8527750 22579.8133   290%     -  926s
H    0     0                    5792.7770826 22579.8133   290%     -  926s
H    0     0                    5881.9849118 22579.8133   284%     -  979s
H    0     0                    6149.0939706 22579.8133   267%     -  982s
H    0     0                    6216.7505354 22579.8133   263%     -  982s
H    0     0                    7025.8633774 22579.8133   221%     -  984s
H    0     0                    7494.3121679 22579.8133   201%     -  987s
H    0     0                    7535.5617393 22579.8133   200%     -  993s
H    0     0                    7539.0510992 22579.8133   200%     -  994s
H    0     2                    7562.3821433 22579.8133   199%     - 1036s
     0     2 22579.8133    0  561 7562.38214 22579.8133   199%     - 1036s
     1     4 22382.3383    1  493 7562.38214 22579.8067   199% 17755 1078s
     3     8 21959.3446    2  490 7562.38214 22379.9083   196% 20053 1111s
     7    15 21498.8886    3  448 7562.38214 21958.4066   190% 16040 1153s
    14    30 21332.3205    4  466 7562.38214 21594.7736   186% 16747 1184s
    29    45 16843.1071    5  384 7562.38214 21332.2991   182% 24100 1280s
    44    77 16101.3620    6  304 7562.38214 21332.2991   182% 26833 1424s
    76   189 16045.4127    7  293 7562.38214 21228.0849   181% 21746 1559s
   188   217 15679.7267   12  272 7562.38214 21228.0849   181% 12541 1595s
   216   235 14553.9770   13  268 7562.38214 21228.0849   181% 11987 1635s
   242   264 14427.3618   14  260 7562.38214 21228.0849   181% 11775 1673s
H  247   264                    7751.4580797 21228.0849   174% 11654 1673s
H  251   264                    7816.7700759 21228.0849   172% 11525 1673s
H  260   264                    7871.3989054 21228.0849   170% 11426 1673s
H  271   264                    8143.0487622 21228.0849   161% 11483 1673s
   273   317 14418.5113   15  261 8143.04876 21228.0849   161% 11472 1718s
   358   368 13286.3313   18  236 8143.04876 21228.0849   161% 10412 1752s
   438   414 13037.8730   22  300 8143.04876 21228.0849   161%  9889 1785s
   513   459 12762.9202   24  292 8143.04876 21228.0849   161%  9560 1817s
   592   509 11709.9294   26  233 8143.04876 21228.0849   161%  9298 1849s
   660   518 infeasible   28      8143.04876 21228.0849   161%  9127 1881s
   713   524 infeasible   28      8143.04876 21228.0849   161%  9109 1910s
H  715   524                    8155.9615369 21228.0849   160%  9096 1910s
H  728   524                    8204.9541401 21228.0849   159%  9131 1910s
H  743   524                    8312.6906680 21228.0849   155%  9179 1910s
   749   533 11939.0874   29  228 8312.69067 21228.0849   155%  9182 1938s
   808   533 10642.0332   20  418 8312.69067 21228.0849   155%  9164 1976s
   852   565 10199.6779   21  399 8312.69067 21228.0849   155%  9038 2004s
   906   606 9487.94115   23  332 8312.69067 21228.0849   155%  8877 2038s
   996   633 9029.95440   25  284 8312.69067 21228.0849   155%  8529 2069s
  1086   640 infeasible   26      8312.69067 21065.3475   153%  8321 2103s
H 1101   640                    8531.1994358 21065.3475   147%  8337 2103s
  1121   647 infeasible   14      8531.19944 21065.3475   147%  8335 2136s
H 1125   647                    8585.5537269 21065.3475   145%  8321 2136s
H 1126   647                    9001.0069046 21065.3475   134%  8326 2136s
  1155   649 12879.8136   16  293 9001.00690 21065.3475   134%  8379 2174s
  1195   675 15446.1562   17  316 9001.00690 21065.3475   134%  8437 2209s
H 1207   675                    9093.6609471 21065.3475   132%  8522 2209s
H 1217   675                    9142.2287903 21065.3475   130%  8572 2209s
  1223   734 15369.8066   18  318 9142.22879 21065.3475   130%  8586 2247s
  1298   813 12435.6261   21  275 9142.22879 21065.3475   130%  8666 2284s
  1393   912 11362.6311   25  174 9142.22879 21065.3475   130%  8560 2319s
  1502  1031 10127.8338   31  159 9142.22879 21065.3475   130%  8525 2351s
  1639  1158     cutoff   40      9142.22879 21065.3475   130%  8337 2392s
  1808  1189 13014.4273   13  273 9142.22879 20955.5045   129%  8076 2434s
H 1810  1189                    9365.4444945 20955.5045   124%  8088 2434s
H 1811  1189                    9482.2549935 20955.5045   121%  8095 2434s
H 1824  1189                    9495.1677681 20955.5045   121%  8084 2434s
  1843  1209 19919.7600    7  387 9495.16777 20955.5045   121%  8084 2476s
  1882  1239 12366.1965   14  247 9495.16777 20955.5045   121%  8084 2511s
  1918  1269 11297.7403   16  258 9495.16777 20955.5045   121%  8087 2546s
H 1945  1269                    9528.0843618 20955.5045   120%  8090 2546s
  1958  1437 10454.7833   18  311 9528.08436 20955.5045   120%  8087 2584s
  2164  1506 10139.2349   21  302 9528.08436 20955.5045   120%  7815 2631s
  2340  1631 9548.22978   23  341 9528.08436 20955.5045   120%  7688 2678s
  2547  1702     cutoff   25      9528.08436 20955.5045   120%  7525 2727s
  2700  1798 infeasible   25      9528.08436 19939.2378   109%  7470 2786s
  2884  1788 19324.9208    6  574 9528.08436 19939.2378   109%  7389 2841s
  3045  1824 16321.4777    7  561 9528.08436 19939.2378   109%  7429 2891s
  3087  1919 16201.0990    8  570 9528.08436 19939.2378   109%  7493 2938s
  3214  2021 12505.5317   10  543 9528.08436 19939.2378   109%  7526 2996s
  3374  2131 12715.0984   44  260 9528.08436 19845.6287   108%  7520 3051s
  3524  2262 11903.1700   11  555 9528.08436 19324.8595   103%  7570 3118s
H 3711  2262                    9542.6939070 19324.8595   103%  7588 3185s
  3712  2263 15534.0308   16  561 9542.69391 19324.8595   103%  7586 3503s
  3714  2264 9803.29856   24  165 9542.69391 19324.8595   103%  7582 3521s

Cutting planes:
  Gomory: 9
  Implied bound: 27
  Projected implied bound: 334
  MIR: 1195
  Mixing: 21
  Flow cover: 658
  RLT: 21
  Relax-and-lift: 269

Explored 3714 nodes (28941240 simplex iterations) in 3600.06 seconds (5898.57 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 9542.69 9528.08 9495.17 ... 8531.2

Time limit reached
Best objective 9.542693906993e+03, best bound 1.932485948205e+04, gap 102.5095%
  WARNING: Time limit reached. Using best solution found (gap: 102.51%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3600.16s
  Master Objective (UB) = 9542.69, θ = 153427.09
  Upper Bound (UB) = 9542.69

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 153427.09
  [DEBUG]   ✓ Scenario 0: θ = 153427.09 ≤ Q = 153427.09 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 153427.09 ≤ Q = 153427.09 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 153427.09 ≤ Q = 153427.09 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 153427.09 ≤ Q = 153427.09 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 153427.09 ≤ Q = 153427.09 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 153427.09 ≤ Q = 153427.09 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 153427.09 ≤ Q = 153427.09 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 153427.09 ≤ Q = 153427.09 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 153427.09 ≤ Q = 153427.09 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 153427.09 ≤ Q = 153427.09 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 153427.09 ≤ Q = 153427.09 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 153427.09 ≤ Q = 153427.09 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 153427.09 ≤ Q = 153427.09 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 13] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0xd98c1b1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x0d98c1b1
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.242267e+13
Presolve removed 2593 rows and 1884 columns
Presolve time: 0.01s
Presolved: 500 rows, 505 columns, 1411 nonzeros
Found heuristic solution: objective 6109588.7189
Variable types: 342 continuous, 163 integer (163 binary)
Found heuristic solution: objective 6109194.7154

Root relaxation: objective -1.395944e+05, 238 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -139594.44    0  121 6109194.72 -139594.44   102%     -    0s
H    0     0                    -98070.07870 -139594.44  42.3%     -    0s
H    0     0                    -103384.9751 -139594.44  35.0%     -    0s
H    0     0                    -104779.8481 -139594.44  33.2%     -    0s
     0     0 -116094.70    0   72 -104779.85 -116094.70  10.8%     -    0s
H    0     0                    -113909.5314 -115972.87  1.81%     -    0s
H    0     0                    -114276.1964 -115972.87  1.48%     -    0s
H    0     0                    -114492.2496 -115972.87  1.29%     -    0s
     0     0 -115243.78    0   62 -114492.25 -115243.78  0.66%     -    0s
     0     0 -115099.41    0   45 -114492.25 -115099.41  0.53%     -    0s
     0     0 -115087.86    0   53 -114492.25 -115087.86  0.52%     -    0s
     0     0 -114807.35    0   21 -114492.25 -114807.35  0.28%     -    0s
     0     0 -114806.99    0   19 -114492.25 -114806.99  0.27%     -    0s
     0     0 -114758.78    0   22 -114492.25 -114758.78  0.23%     -    0s
     0     0 -114758.29    0   22 -114492.25 -114758.29  0.23%     -    0s
     0     0 -114753.90    0   23 -114492.25 -114753.90  0.23%     -    0s
     0     0 -114709.88    0   18 -114492.25 -114709.88  0.19%     -    0s
     0     0 -114709.88    0   31 -114492.25 -114709.88  0.19%     -    0s
     0     0 -114571.73    0    9 -114492.25 -114571.73  0.07%     -    0s
H    0     0                    -114525.3751 -114563.86  0.03%     -    0s
     0     0 -114558.86    0    8 -114525.38 -114558.86  0.03%     -    0s
     0     0 -114557.70    0    8 -114525.38 -114557.70  0.03%     -    0s
     0     0 -114557.47    0    8 -114525.38 -114557.47  0.03%     -    0s
     0     0 -114557.47    0    8 -114525.38 -114557.47  0.03%     -    0s
     0     0 -114557.45    0    8 -114525.38 -114557.45  0.03%     -    0s
     0     0 -114545.38    0    7 -114525.38 -114545.38  0.02%     -    0s
     0     0 -114545.38    0   12 -114525.38 -114545.38  0.02%     -    0s
H    0     0                    -114539.9495 -114545.38  0.00%     -    0s

Explored 1 nodes (872 simplex iterations) in 0.21 seconds (0.05 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -114540 -114525 -114492 ... -98070.1

Optimal solution found (tolerance 1.00e-04)
Best objective -1.145399495326e+05, best bound -1.145453765348e+05, gap 0.0047%
  Subproblem solved in 0.24s
  Worst-case operational profit (Z_SP) = 147499.31
  Scenario: 29 demand increases, 31 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -114539.95
  [DEBUG]   S×d_nominal = 262039.26
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 262039.26 + -114539.95 = 147499.31
  [DEBUG]   Current θ from Master = 153427.09
  [DEBUG]   ⚠️  Z_SP ≤ θ by 5927.78 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 3614.92
  Lower Bound (LB) = 4815.33
  Gap (UB-LB) = 4727.3620, Absolute Gap = 4727.3620, Relative Gap = 0.495391
  Not converged yet (gap = 4727.36 > ε = 200)

  [DEBUG] Adding NEW scenario 13 to Master Problem...
  [DEBUG] New scenario pattern: 29 increases, 31 decreases
    [DEBUG] Scenario 13 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 13 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 13]
    [DEBUG]   - Total constraints in model: 215443
    [DEBUG]   - Total variables in model: 89620
  [DEBUG] Total scenarios in Master: 14
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 14
================================================================================
[Iteration 14] Solving Master Problem...
  Current scenarios in Master: 14
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 215443 rows, 89620 columns and 610837 nonzeros
Model fingerprint: 0x5cca47f2
Variable types: 87361 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 96292 rows and 39102 columns
Presolve time: 4.19s
Presolved: 119151 rows, 50518 columns, 732762 nonzeros
Variable types: 48259 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -360909.6661
Found heuristic solution: objective -183019.6155

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.22s

Barrier statistics:
 Dense cols : 700
 AA' NZ     : 4.666e+06
 Factor NZ  : 1.062e+07 (roughly 150 MB of memory)
 Factor Ops : 2.188e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.07148806e+07  2.10654771e+08  1.24e+05 1.72e+01  8.96e+04     7s
   1  -1.59828540e+07  1.90707418e+08  8.86e+04 9.02e+01  6.33e+04     7s
   2  -4.98741265e+06  1.52394583e+08  2.74e+04 1.10e+00  2.07e+04     7s
   3  -2.59795448e+06  1.53757573e+08  1.31e+04 2.36e+01  1.03e+04     8s
   4  -9.72095030e+05  1.19103857e+08  1.55e+03 3.26e+00  1.65e+03     8s
   5  -7.65134771e+05  6.24485575e+07  5.22e+02 2.15e+00  6.22e+02     8s
   6  -6.64363914e+05  5.94942298e+07  1.67e+02 1.68e+00  3.82e+02     8s
   7  -4.49004269e+05  3.78155184e+07  5.31e+01 2.80e-01  2.06e+02     8s
   8  -3.26519907e+05  2.28084077e+07  1.24e+01 6.99e-02  1.12e+02     8s
   9  -2.09097468e+05  1.52990456e+07  1.63e+00 4.16e-02  7.18e+01     8s
  10  -1.61421388e+05  4.38597768e+06  9.85e-01 1.15e-02  2.10e+01     8s
  11  -1.13471626e+05  3.28442148e+06  5.82e-01 6.65e-02  1.57e+01     8s
  12  -9.29031428e+04  2.58109337e+06  3.77e-01 6.64e-03  1.23e+01     8s
  13  -5.42763520e+04  1.58141024e+06  9.46e-02 3.97e-02  7.52e+00     9s
  14  -2.54209524e+04  3.36248249e+05  2.47e-02 7.51e-04  1.66e+00     9s
  15  -4.62913123e+03  2.12387711e+05  1.05e-02 4.89e-04  9.97e-01     9s
  16   2.21517923e+03  1.55923840e+05  8.26e-03 3.54e-04  7.06e-01     9s
  17   7.80172114e+03  1.25016914e+05  6.60e-03 6.01e-04  5.38e-01     9s
  18   1.35276982e+04  1.00255017e+05  5.03e-03 7.96e-04  3.98e-01     9s
  19   1.81667784e+04  8.19143654e+04  3.88e-03 5.67e-04  2.93e-01     9s
  20   2.13097918e+04  7.06731258e+04  3.14e-03 2.97e-04  2.27e-01     9s
  21   2.40554886e+04  6.14892670e+04  2.56e-03 6.85e-04  1.72e-01     9s
  22   2.75453168e+04  5.50483949e+04  1.89e-03 1.81e-03  1.26e-01    10s
  23   3.04659358e+04  4.96370896e+04  1.35e-03 1.39e-03  8.81e-02    10s
  24   3.18950640e+04  4.76091259e+04  1.10e-03 1.16e-03  7.22e-02    10s
  25   3.44797585e+04  4.54087285e+04  6.65e-04 7.16e-04  5.02e-02    10s
  26   3.55219639e+04  4.21840082e+04  4.99e-04 1.10e-03  3.06e-02    10s
  27   3.63709290e+04  4.08905076e+04  3.67e-04 6.26e-04  2.08e-02    10s
  28   3.68189593e+04  4.04032656e+04  3.00e-04 4.71e-04  1.65e-02    10s
  29   3.74380427e+04  3.99764817e+04  2.07e-04 3.37e-04  1.17e-02    10s
  30   3.79815458e+04  3.93164970e+04  1.29e-04 1.92e-04  6.13e-03    10s
  31   3.83916043e+04  3.91543777e+04  6.96e-05 1.07e-04  3.50e-03    11s
  32   3.84432345e+04  3.90836220e+04  6.26e-05 7.22e-05  2.94e-03    11s
  33   3.86368318e+04  3.90611931e+04  3.73e-05 6.09e-05  1.95e-03    11s
  34   3.87919293e+04  3.90015487e+04  1.74e-05 3.06e-05  9.62e-04    11s
  35   3.88896368e+04  3.89526473e+04  5.35e-06 7.58e-06  2.89e-04    11s
  36   3.89304409e+04  3.89385163e+04  6.85e-07 3.53e-06  3.71e-05    11s
  37   3.89364798e+04  3.89368467e+04  5.78e-08 1.03e-07  1.69e-06    11s
  38   3.89367139e+04  3.89367164e+04  1.62e-08 3.51e-10  1.12e-08    12s
  39   3.89367152e+04  3.89367160e+04  1.98e-07 4.00e-08  3.54e-09    12s
  40   3.89367157e+04  3.89367160e+04  7.30e-07 2.56e-09  1.18e-09    12s

Barrier solved model in 40 iterations and 11.91 seconds (9.87 work units)
Optimal objective 3.89367157e+04


Root crossover log...

  106527 DPushes remaining with DInf 0.0000000e+00                12s
     784 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                16s

   10713 PPushes remaining with PInf 1.7552221e-04                16s
       0 PPushes remaining with PInf 0.0000000e+00                17s

  Push phase complete: Pinf 0.0000000e+00, Dinf 5.4604880e+05     17s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   64601    3.8936716e+04   0.000000e+00   5.460488e+05     17s
   65074    3.8936716e+04   0.000000e+00   0.000000e+00     18s
   65074    3.8936716e+04   0.000000e+00   0.000000e+00     18s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 3.893672e+04, 65074 iterations, 12.49 seconds (15.29 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 38936.7160    0  173 -183019.62 38936.7160   121%     -   18s
H    0     0                    -178504.2218 38936.7160   122%     -   18s
H    0     0                    -145089.6183 38936.7160   127%     -   19s
H    0     0                    -143760.9496 38936.7160   127%     -   19s
H    0     0                    -139197.5537 38936.7160   128%     -   20s
H    0     0                    -132935.6098 38936.7160   129%     -   20s
H    0     0                    -92444.11154 38936.7160   142%     -   20s
H    0     0                    -9158.081450 38936.7160   525%     -   21s
H    0     0                    -8296.423136 38936.7160   569%     -   21s
H    0     0                    -8060.030251 38936.7160   583%     -   21s
H    0     0                    -7178.006886 38936.7160   642%     -   21s
H    0     0                    -6885.070267 38936.7160   666%     -   21s
H    0     0                    -6674.164486 32505.0368   587%     -   75s
H    0     0                    -6614.188882 32505.0368   591%     -   75s
     0     0 32378.7919    0  209 -6614.1889 32378.7919   590%     -   75s
H    0     0                    -6458.155561 32378.7919   601%     -   76s
     0     0 31816.2601    0  266 -6458.1556 31816.2601   593%     -  111s
     0     0 31632.5673    0  248 -6458.1556 31632.5673   590%     -  123s
     0     0 31537.0478    0  279 -6458.1556 31537.0478   588%     -  136s
     0     0 31311.2627    0  281 -6458.1556 31311.2627   585%     -  147s
     0     0 31280.2697    0  278 -6458.1556 31280.2697   584%     -  155s
     0     0 31193.2266    0  276 -6458.1556 31193.2266   583%     -  161s
     0     0 31193.2266    0  258 -6458.1556 31193.2266   583%     -  173s
     0     0 31193.2266    0  281 -6458.1556 31193.2266   583%     -  175s
     0     0 31193.2266    0  256 -6458.1556 31193.2266   583%     -  188s
     0     0 31193.2266    0  262 -6458.1556 31193.2266   583%     -  191s
     0     0 31193.2266    0  325 -6458.1556 31193.2266   583%     -  192s
     0     0 31193.2266    0  325 -6458.1556 31193.2266   583%     -  193s
     0     0 27775.4544    0  367 -6458.1556 27775.4544   530%     -  277s
H    0     0                    -2993.887275 27775.2606  1028%     -  278s
H    0     0                    -2988.184656 27775.2606  1030%     -  278s
     0     0 27032.6233    0  365 -2988.1847 27032.6233  1005%     -  322s
     0     0 26860.9722    0  376 -2988.1847 26860.9722   999%     -  344s
     0     0 26802.2523    0  307 -2988.1847 26802.2523   997%     -  357s
     0     0 26783.3474    0  344 -2988.1847 26783.3474   996%     -  368s
     0     0 26752.5869    0  309 -2988.1847 26752.5869   995%     -  375s
     0     0 26726.9997    0  387 -2988.1847 26726.9997   994%     -  383s
     0     0 26709.6278    0  402 -2988.1847 26709.6278   994%     -  389s
     0     0 26703.9549    0  393 -2988.1847 26703.9549   994%     -  394s
     0     0 26698.2246    0  386 -2988.1847 26698.2246   993%     -  399s
     0     0 26695.5813    0  400 -2988.1847 26695.5813   993%     -  402s
     0     0 26695.0462    0  398 -2988.1847 26695.0462   993%     -  403s
     0     0 24820.0327    0  413 -2988.1847 24820.0327   931%     -  487s
     0     0 24393.8949    0  485 -2988.1847 24393.8949   916%     -  512s
H    0     0                     -98.6780066 24281.6563      -     -  528s
H    0     0                     -18.1267943 24281.6563      -     -  528s
     0     0 24281.6563    0  506  -18.12679 24281.6563      -     -  528s
     0     0 24244.1582    0  427  -18.12679 24244.1582      -     -  535s
     0     0 24211.7316    0  475  -18.12679 24211.7316      -     -  545s
     0     0 24193.9336    0  476  -18.12679 24193.9336      -     -  555s
     0     0 24167.6756    0  472  -18.12679 24167.6756      -     -  563s
     0     0 24133.3486    0  427  -18.12679 24133.3486      -     -  571s
     0     0 24119.8568    0  437  -18.12679 24119.8568      -     -  575s
     0     0 24113.7766    0  443  -18.12679 24113.7766      -     -  578s
     0     0 24081.9184    0  436  -18.12679 24081.9184      -     -  585s
     0     0 24059.1511    0  429  -18.12679 24059.1511      -     -  591s
     0     0 24045.7010    0  482  -18.12679 24045.7010      -     -  596s
     0     0 24043.2091    0  470  -18.12679 24043.2091      -     -  599s
     0     0 24040.6126    0  474  -18.12679 24040.6126      -     -  601s
     0     0 24038.4837    0  474  -18.12679 24038.4837      -     -  602s
     0     0 24033.3718    0  480  -18.12679 24033.3718      -     -  604s
     0     0 24029.8646    0  474  -18.12679 24029.8646      -     -  606s
     0     0 24028.4342    0  481  -18.12679 24028.4342      -     -  607s
     0     0 23407.0898    0  420  -18.12679 23407.0898      -     -  642s
H    0     0                      49.0028616 23407.0007      -     -  644s
     0     0 23300.8697    0  448   49.00286 23300.8697      -     -  660s
     0     0 23174.3697    0  484   49.00286 23174.3697      -     -  674s
     0     0 23134.0862    0  470   49.00286 23134.0862      -     -  683s
     0     0 23119.2426    0  470   49.00286 23119.2426      -     -  688s
     0     0 23097.9659    0  475   49.00286 23097.9659      -     -  693s
     0     0 23089.0117    0  476   49.00286 23089.0117      -     -  695s
     0     0 23085.6995    0  473   49.00286 23085.6995      -     -  696s
     0     0 23084.9207    0  474   49.00286 23084.9207      -     -  698s
     0     0 22896.7760    0  433   49.00286 22896.7760      -     -  711s
H    0     0                     112.5866012 22896.4053      -     -  712s
     0     0 22836.0263    0  532  112.58660 22836.0263      -     -  720s
     0     0 22833.2162    0  483  112.58660 22833.2162      -     -  723s
     0     0 22830.2338    0  486  112.58660 22830.2338      -     -  725s
     0     0 22812.4857    0  549  112.58660 22812.4857      -     -  727s
     0     0 22810.2932    0  490  112.58660 22810.2932      -     -  730s
     0     0 22809.2266    0  424  112.58660 22809.2266      -     -  731s
     0     0 22763.6317    0  418  112.58660 22763.6317      -     -  738s
     0     0 22753.0975    0  482  112.58660 22753.0975      -     -  748s
     0     0 22752.8477    0  445  112.58660 22752.8477      -     -  749s
     0     0 22705.3761    0  447  112.58660 22705.3761      -     -  758s
     0     0 22649.3235    0  415  112.58660 22649.3235      -     -  767s
     0     0 22645.9367    0  421  112.58660 22645.9367      -     -  770s
     0     0 22645.0005    0  415  112.58660 22645.0005      -     -  772s
     0     0 22643.5875    0  408  112.58660 22643.5875      -     -  777s
     0     0 22642.8084    0  415  112.58660 22642.8084      -     -  782s
     0     0 22641.1799    0  412  112.58660 22641.1799      -     -  786s
     0     0 22640.0400    0  419  112.58660 22640.0400      -     -  789s
     0     0 22639.5278    0  418  112.58660 22639.5278      -     -  792s
     0     0 22635.8618    0  379  112.58660 22635.8618      -     -  799s
     0     0 22635.8618    0  422  112.58660 22635.8618      -     -  802s
     0     0 22635.8618    0  422  112.58660 22635.8618      -     -  810s
H    0     0                     206.1703222 22635.8618      -     -  853s
H    0     0                     309.3867158 22635.8618  7216%     -  898s
H    0     0                     322.2075714 22635.8618  6925%     -  898s
H    0     0                     538.3682876 22635.8618  4105%     -  912s
H    0     0                    2550.0865484 22635.8618   788%     -  912s
H    0     0                    2713.7457434 22635.8618   734%     -  912s
H    0     0                    2788.4557063 22635.8618   712%     -  912s
H    0     2                    3074.4067111 22635.8618   636%     -  916s
     0     2 22635.8618    0  422 3074.40671 22635.8618   636%     -  916s
     1     3 21853.5508    1  359 3074.40671 22631.6165   636% 14287  935s
     2     5 21573.2373    2  360 3074.40671 22631.6165   636% 11955  949s
     4     9 21520.8429    3  358 3074.40671 22502.7741   632%  9652 1005s
     8    17 20330.7141    3  312 3074.40671 22502.7741   632% 11747 1048s
    16    34 20075.7225    4  318 3074.40671 22259.3644   624% 14038 1068s
    33    49 21722.5038    5  359 3074.40671 21950.5335   614% 15760 2083s
    48    77 21287.4504    6  360 3074.40671 21950.5335   614% 18318 2221s
H   76   109                    3774.6300537 21950.5335   482% 15813 2273s
H   77   109                    3902.7268956 21950.5335   462% 15750 2273s
H   79   109                    4290.9631669 21950.5335   412% 15593 2273s
H   89   109                    4386.4953149 21950.5335   400% 15085 2273s
H   93   109                    5738.9284463 21950.5335   282% 15275 2273s
   108   214 21120.2172    8  344 5738.92845 21950.5335   282% 14290 2348s
   213   252 19711.4524   11  322 5738.92845 21950.5335   282% 12155 2397s
H  215   252                    8172.0884991 21950.5335   169% 12066 2397s
   256   297 19668.0349   12  327 8172.08850 21950.5335   169% 11064 2448s
   341   323 18736.2338   15  253 8172.08850 21950.5335   169%  9541 2481s
H  348   323                    8594.5118203 21950.5335   155%  9527 2481s
H  359   323                    8643.6637895 21950.5335   154%  9498 2481s
H  370   323                    8727.9020400 21950.5335   151%  9492 2481s
   377   357 19553.9738   12  339 8727.90204 21950.5335   151%  9507 2525s
   456   376 16754.2119   16  374 8727.90204 21950.5335   151%  9108 2562s
H  459   376                    9128.0997657 21950.5335   140%  9115 2562s
   497   425 16288.5922   17  245 9128.09977 21950.5335   140%  9254 2601s
   564   478 16095.5098   19  245 9128.09977 21950.5335   140%  9057 2638s
   633   518 15684.0470   21  242 9128.09977 21950.5335   140%  8940 2670s
   693   573 15292.9153   23  290 9128.09977 21950.5335   140%  8891 2703s
   762   626 13429.2127   25  202 9128.09977 21950.5335   140%  8799 2731s
   835   682 13385.3986   26  216 9128.09977 21950.5335   140%  8646 2765s
   923   734 10129.3652   28  214 9128.09977 21950.5335   140%  8362 2797s
  1007   766 infeasible   29      9128.09977 21874.1630   140%  8218 2828s
  1079   829 infeasible   28      9128.09977 21874.1630   140%  8153 2862s
  1160   912 13914.3721   24  361 9128.09977 21874.1630   140%  8076 2897s
  1263   975 13755.2078   25  264 9128.09977 21874.1630   140%  7948 2934s
  1384  1007 13279.1081   27  279 9128.09977 21738.3537   138%  7700 2972s
  1468  1014 9773.01377   29  250 9128.09977 21738.3537   138%  7717 3014s
  1544  1032 11466.8897   13  260 9128.09977 21738.3537   138%  7829 3054s
  1606  1044 infeasible   14      9128.09977 21738.3537   138%  7906 3098s
  1672  1065 13888.6497   15  497 9128.09977 21738.3537   138%  8078 3144s
  1735  1104 13851.0512   16  427 9128.09977 21738.3537   138%  8275 3190s
  1810  1142 12289.9100   17  392 9128.09977 21738.3537   138%  8393 3234s
  1880  1173 14509.2728   18  346 9128.09977 21738.3537   138%  8479 3286s
  1948  1198 10856.0526   16  544 9128.09977 21738.3537   138%  8606 3335s
H 1954  1198                    9517.9921256 21738.3537   128%  8599 3335s
H 1955  1198                    9525.5498457 21738.3537   128%  8596 3335s
H 1961  1198                    9538.3384858 21738.3537   128%  8601 3335s
  1993  1235     cutoff   17      9538.33849 21738.3537   128%  8677 3385s
  2087  1275 10088.4867   17  351 9538.33849 21291.7143   123%  8751 3441s
  2171  1301 10380.1011   39  227 9538.33849 21290.9050   123%  8821 3492s
  2231  1339 18867.0018    5  344 9538.33849 21290.9050   123%  8890 3553s
  2329  1408 18408.9435    6  409 9538.33849 20620.3135   116%  8903 3600s

Cutting planes:
  Learned: 4
  Gomory: 8
  Implied bound: 197
  MIR: 2596
  Flow cover: 2498
  RLT: 73
  Relax-and-lift: 671

Explored 2442 nodes (22237594 simplex iterations) in 3600.11 seconds (5117.79 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 9538.34 9525.55 9517.99 ... 4386.5

Time limit reached
Best objective 9.538338485793e+03, best bound 2.062031349654e+04, gap 116.1835%
  WARNING: Time limit reached. Using best solution found (gap: 116.18%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 3600.12s
  Master Objective (UB) = 9538.34, θ = 153164.74
  Upper Bound (UB) = 9538.34

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 153164.74
  [DEBUG]   ✓ Scenario 0: θ = 153164.74 ≤ Q = 153164.74 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 153164.74 ≤ Q = 153164.74 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 153164.74 ≤ Q = 153164.74 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 153164.74 ≤ Q = 153164.74 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 153164.74 ≤ Q = 153164.74 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 153164.74 ≤ Q = 153164.74 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 153164.74 ≤ Q = 153164.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 153164.74 ≤ Q = 153164.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 153164.74 ≤ Q = 153164.74 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 153164.74 ≤ Q = 153164.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 153164.74 ≤ Q = 153164.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 153164.74 ≤ Q = 153164.74 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 153164.74 ≤ Q = 153164.74 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 153164.74 ≤ Q = 153164.74 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 14] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x676cfce2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x9893031e
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.245791e+13
Presolve removed 2593 rows and 1884 columns
Presolve time: 0.01s
Presolved: 500 rows, 505 columns, 1411 nonzeros
Found heuristic solution: objective 6118164.0917
Variable types: 342 continuous, 163 integer (163 binary)
Found heuristic solution: objective 6117770.0883

Root relaxation: objective -1.399490e+05, 243 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -139948.95    0  121 6117770.09 -139948.95   102%     -    0s
H    0     0                    -97327.98401 -139948.95  43.8%     -    0s
H    0     0                    -98675.29731 -139948.95  41.8%     -    0s
H    0     0                    -98746.43659 -139795.24  41.6%     -    0s
     0     0 -114296.30    0   73 -98746.437 -114296.30  15.7%     -    0s
H    0     0                    -112081.7791 -114273.89  1.96%     -    0s
H    0     0                    -112415.7939 -114273.89  1.65%     -    0s
H    0     0                    -112521.9915 -114273.89  1.56%     -    0s
     0     0 -113660.86    0   55 -112521.99 -113660.86  1.01%     -    0s
H    0     0                    -112523.7926 -113590.67  0.95%     -    0s
     0     0 -113590.67    0   55 -112523.79 -113590.67  0.95%     -    0s
     0     0 -113573.27    0   56 -112523.79 -113573.27  0.93%     -    0s
     0     0 -113348.56    0   50 -112523.79 -113348.56  0.73%     -    0s
     0     0 -113327.64    0   51 -112523.79 -113327.64  0.71%     -    0s
     0     0 -113284.09    0   51 -112523.79 -113284.09  0.68%     -    0s
     0     0 -113283.01    0   51 -112523.79 -113283.01  0.67%     -    0s
H    0     0                    -112554.8934 -113282.78  0.65%     -    0s
     0     2 -113282.78    0   51 -112554.89 -113282.78  0.65%     -    0s
H   50    67                    -113154.7103 -113160.28  0.00%   8.9    0s
H   65    52                    -113157.7801 -113160.28  0.00%   7.6    0s

Cutting planes:
  Gomory: 25
  Implied bound: 4
  MIR: 182
  Flow cover: 8
  RLT: 15

Explored 77 nodes (1094 simplex iterations) in 0.23 seconds (0.06 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -113158 -113155 -112555 ... 6.11777e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.131577801385e+05, best bound -1.131596069352e+05, gap 0.0016%
  Subproblem solved in 0.27s
  Worst-case operational profit (Z_SP) = 149032.66
  Scenario: 6 demand increases, 54 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -113157.78
  [DEBUG]   S×d_nominal = 262190.44
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 262190.44 + -113157.78 = 149032.66
  [DEBUG]   Current θ from Master = 153164.74
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4132.08 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 5406.26
  Lower Bound (LB) = 5406.26
  Gap (UB-LB) = 4132.0795, Absolute Gap = 4132.0795, Relative Gap = 0.433207
  Not converged yet (gap = 4132.08 > ε = 200)

  [DEBUG] Adding NEW scenario 14 to Master Problem...
  [DEBUG] New scenario pattern: 6 increases, 54 decreases
    [DEBUG] Scenario 14 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 14 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 14]
    [DEBUG]   - Total constraints in model: 230733
    [DEBUG]   - Total variables in model: 95860
  [DEBUG] Total scenarios in Master: 15
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 15
================================================================================
[Iteration 15] Solving Master Problem...
  Current scenarios in Master: 15
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 230733 rows, 95860 columns and 654074 nonzeros
Model fingerprint: 0x81bebdcd
Variable types: 93601 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 103180 rows and 41900 columns
Presolve time: 4.03s
Presolved: 127553 rows, 53960 columns, 784677 nonzeros
Variable types: 51701 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -359784.4177
Found heuristic solution: objective -183019.6155

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.43s

Barrier statistics:
 Dense cols : 703
 AA' NZ     : 5.241e+06
 Factor NZ  : 1.216e+07 (roughly 170 MB of memory)
 Factor Ops : 2.760e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.13391199e+07  2.22641296e+08  1.28e+05 1.64e+01  9.17e+04     6s
   1  -1.65836999e+07  2.02280699e+08  9.14e+04 8.98e+01  6.49e+04     7s
   2  -4.88873876e+06  1.58923504e+08  2.64e+04 9.15e-01  1.99e+04     7s
   3  -7.93733421e+05  1.16470088e+08  1.34e+03 1.30e+00  1.46e+03     7s
   4  -5.67959211e+05  5.27742695e+07  3.73e+02 3.98e-01  4.66e+02     7s
   5  -4.41886446e+05  3.53773526e+07  1.33e+02 2.40e-01  2.31e+02     7s
   6  -3.84714287e+05  2.51499177e+07  5.66e+01 1.60e-01  1.39e+02     7s
   7  -2.85368510e+05  2.08995878e+07  1.89e+01 1.30e-01  9.98e+01     7s
   8  -1.89170693e+05  1.50135063e+07  3.36e+00 9.10e-02  6.65e+01     7s
   9  -1.49301208e+05  1.00714500e+07  1.93e+00 6.34e-02  4.44e+01     8s
  10  -1.21258180e+05  5.41502714e+06  1.29e+00 3.44e-02  2.40e+01     8s
  11  -1.07704322e+05  4.08854501e+06  8.87e-01 2.57e-02  1.81e+01     8s
  12  -8.24680695e+04  2.70043569e+06  3.25e-01 1.69e-02  1.20e+01     8s
  13  -5.95594184e+04  1.30650948e+06  1.52e-01 7.93e-03  5.87e+00     8s
  14  -3.17534232e+04  3.76112396e+05  5.86e-02 2.28e-03  1.75e+00     8s
  15  -1.47664658e+04  2.44382929e+05  3.49e-02 1.36e-03  1.11e+00     8s
  16  -3.34225947e+03  1.74589691e+05  2.40e-02 1.90e-03  7.64e-01     8s
  17   1.80748871e+03  1.39036855e+05  1.97e-02 1.42e-03  5.89e-01     9s
  18   8.79944517e+03  1.03792805e+05  1.42e-02 6.77e-04  4.08e-01     9s
  19   1.57041189e+04  8.12219823e+04  1.02e-02 4.59e-04  2.81e-01     9s
  20   1.96477039e+04  6.71528507e+04  8.05e-03 3.12e-04  2.04e-01     9s
  21   2.33051306e+04  6.11274215e+04  6.29e-03 2.59e-04  1.62e-01     9s
  22   2.46890459e+04  5.54240234e+04  5.66e-03 2.00e-04  1.32e-01    10s
  23   2.78627087e+04  5.00201067e+04  4.30e-03 1.84e-04  9.51e-02    10s
  24   2.96823512e+04  4.65812142e+04  3.56e-03 1.41e-04  7.25e-02    10s
  25   3.21452306e+04  4.54205629e+04  2.59e-03 1.18e-04  5.70e-02    10s
  26   3.43473160e+04  4.37655618e+04  1.74e-03 8.54e-05  4.04e-02    10s
  27   3.52273615e+04  4.20940236e+04  1.40e-03 5.51e-05  2.95e-02    10s
  28   3.58447363e+04  4.12951521e+04  1.18e-03 3.93e-05  2.34e-02    11s
  29   3.65582798e+04  4.07502136e+04  9.31e-04 2.84e-05  1.80e-02    11s
  30   3.70026401e+04  4.03796396e+04  7.70e-04 2.97e-05  1.45e-02    11s
  31   3.73321263e+04  4.01070411e+04  6.53e-04 1.95e-05  1.19e-02    11s
  32   3.80141389e+04  3.98353348e+04  4.13e-04 1.31e-05  7.82e-03    11s
  33   3.84479033e+04  3.94134831e+04  2.63e-04 2.29e-05  4.15e-03    12s
  34   3.86027258e+04  3.93686910e+04  2.11e-04 1.67e-05  3.29e-03    12s
  35   3.88935756e+04  3.93521605e+04  1.12e-04 1.42e-05  1.97e-03    12s
  36   3.91022887e+04  3.93103010e+04  4.47e-05 7.90e-06  8.93e-04    12s
  37   3.91698963e+04  3.92860712e+04  2.40e-05 4.44e-06  4.99e-04    12s
  38   3.92250355e+04  3.92625432e+04  6.99e-06 1.08e-06  1.61e-04    12s
  39   3.92481664e+04  3.92550248e+04  1.01e-06 2.13e-07  2.94e-05    12s
  40   3.92520737e+04  3.92529385e+04  1.52e-07 4.30e-09  3.71e-06    13s
  41   3.92528376e+04  3.92528436e+04  7.41e-09 9.86e-10  2.56e-08    13s
  42   3.92528421e+04  3.92528423e+04  2.12e-08 3.52e-11  8.78e-10    13s

Barrier solved model in 42 iterations and 12.94 seconds (11.35 work units)
Optimal objective 3.92528421e+04


Root crossover log...

  113933 DPushes remaining with DInf 0.0000000e+00                13s
   24851 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                18s

    9115 PPushes remaining with PInf 8.6935209e-05                18s
       0 PPushes remaining with PInf 0.0000000e+00                19s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.9885524e+04     19s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   64208    3.9252842e+04   0.000000e+00   3.988552e+04     19s
   64318    3.9252842e+04   0.000000e+00   0.000000e+00     19s
   64318    3.9252842e+04   0.000000e+00   0.000000e+00     19s
Concurrent spin time: 0.93s

Solved with barrier

Root relaxation: objective 3.925284e+04, 64318 iterations, 15.08 seconds (17.36 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 39252.8423    0  170 -183019.62 39252.8423   121%     -   21s
H    0     0                    -181254.1092 39252.8423   122%     -   21s
H    0     0                    -96261.60905 39252.8423   141%     -   21s
H    0     0                    -13011.24444 39252.8423   402%     -   22s
H    0     0                    -9189.906793 39252.8423   527%     -   22s
H    0     0                    -8486.239188 39252.8423   563%     -   22s
H    0     0                    -7866.389795 39252.8423   599%     -   23s
H    0     0                    -7846.607801 39252.8423   600%     -   23s
H    0     0                    -7145.236304 39252.8423   649%     -   23s
H    0     0                    -6885.070267 39252.8423   670%     -   23s
H    0     0                    -6870.336975 32415.8210   572%     -  110s
H    0     0                    -6636.345085 32415.8210   588%     -  110s
H    0     0                    -6604.678433 32415.8210   591%     -  110s
     0     0 32383.5098    0  225 -6604.6784 32383.5098   590%     -  110s
     0     0 31742.1125    0  268 -6604.6784 31742.1125   581%     -  142s
     0     0 31660.4016    0  259 -6604.6784 31660.4016   579%     -  149s
     0     0 31644.0075    0  265 -6604.6784 31644.0075   579%     -  151s
     0     0 31628.8664    0  244 -6604.6784 31628.8664   579%     -  161s
     0     0 31578.7833    0  243 -6604.6784 31578.7833   578%     -  165s
     0     0 31453.6784    0  241 -6604.6784 31453.6784   576%     -  170s
     0     0 31453.6784    0  247 -6604.6784 31453.6784   576%     -  173s
     0     0 31453.6784    0  243 -6604.6784 31453.6784   576%     -  174s
     0     0 31453.6784    0  246 -6604.6784 31453.6784   576%     -  176s
     0     0 31453.6784    0  247 -6604.6784 31453.6784   576%     -  178s
     0     0 31453.6784    0  247 -6604.6784 31453.6784   576%     -  178s
     0     0 28190.8123    0  314 -6604.6784 28190.8123   527%     -  256s
H    0     0                    -2519.851815 28190.7369  1219%     -  257s
H    0     0                    -1477.778113 28190.7369  2008%     -  257s
     0     0 27472.7811    0  362 -1477.7781 27472.7811  1959%     -  323s
     0     0 27362.6895    0  350 -1477.7781 27362.6895  1952%     -  343s
     0     0 27323.7684    0  333 -1477.7781 27323.7684  1949%     -  356s
     0     0 27279.3774    0  357 -1477.7781 27279.3774  1946%     -  369s
     0     0 27253.1288    0  351 -1477.7781 27253.1288  1944%     -  377s
     0     0 27166.8443    0  352 -1477.7781 27166.8443  1938%     -  392s
     0     0 27102.3188    0  360 -1477.7781 27102.3188  1934%     -  402s
     0     0 27097.3116    0  355 -1477.7781 27097.3116  1934%     -  407s
     0     0 27083.9351    0  359 -1477.7781 27083.9351  1933%     -  411s
     0     0 27073.7446    0  363 -1477.7781 27073.7446  1932%     -  414s
     0     0 27069.4782    0  366 -1477.7781 27069.4782  1932%     -  417s
     0     0 27069.0294    0  366 -1477.7781 27069.0294  1932%     -  417s
     0     0 25398.4445    0  378 -1477.7781 25398.4445  1819%     -  479s
H    0     0                    -1401.008286 25397.6874  1913%     -  481s
H    0     0                    -1227.165884 25397.6874  2170%     -  481s
     0     0 24735.1677    0  411 -1227.1659 24735.1677  2116%     -  516s
     0     0 24516.9714    0  447 -1227.1659 24516.9714  2098%     -  537s
     0     0 24447.1047    0  415 -1227.1659 24447.1047  2092%     -  551s
     0     0 24416.1246    0  432 -1227.1659 24416.1246  2090%     -  561s
     0     0 24384.3919    0  427 -1227.1659 24384.3919  2087%     -  571s
     0     0 24340.8036    0  410 -1227.1659 24340.8036  2083%     -  582s
     0     0 24250.5875    0  409 -1227.1659 24250.5875  2076%     -  594s
     0     0 24239.6579    0  414 -1227.1659 24239.6579  2075%     -  599s
     0     0 24133.6312    0  426 -1227.1659 24133.6312  2067%     -  611s
     0     0 24113.9840    0  413 -1227.1659 24113.9840  2065%     -  615s
     0     0 24103.9634    0  416 -1227.1659 24103.9634  2064%     -  618s
     0     0 24099.4571    0  413 -1227.1659 24099.4571  2064%     -  620s
     0     0 24061.2108    0  411 -1227.1659 24061.2108  2061%     -  627s
     0     0 24057.7607    0  473 -1227.1659 24057.7607  2060%     -  631s
     0     0 24049.9525    0  414 -1227.1659 24049.9525  2060%     -  633s
     0     0 24046.1546    0  411 -1227.1659 24046.1546  2059%     -  637s
     0     0 24043.8750    0  413 -1227.1659 24043.8750  2059%     -  639s
     0     0 24041.3171    0  416 -1227.1659 24041.3171  2059%     -  641s
     0     0 24039.3983    0  414 -1227.1659 24039.3983  2059%     -  643s
     0     0 24038.8230    0  411 -1227.1659 24038.8230  2059%     -  644s
     0     0 23363.4909    0  432 -1227.1659 23363.4909  2004%     -  679s
     0     0 23259.7670    0  431 -1227.1659 23259.7670  1995%     -  690s
     0     0 23237.0303    0  441 -1227.1659 23237.0303  1994%     -  696s
     0     0 23198.1752    0  433 -1227.1659 23198.1752  1990%     -  703s
H    0     0                    -181.2703135 23183.0555      -     -  710s
     0     0 23183.0555    0  437 -181.27031 23183.0555      -     -  710s
H    0     0                    -113.6359641 23112.7050      -     -  717s
     0     0 23112.7050    0  420 -113.63596 23112.7050      -     -  717s
     0     0 23091.0269    0  389 -113.63596 23091.0269      -     -  722s
H    0     0                     -27.1987672 23087.7288      -     -  724s
     0     0 23087.7288    0  427  -27.19877 23087.7288      -     -  724s
H    0     0                       4.9168119 23069.7186      -     -  728s
     0     0 23069.7186    0  393    4.91681 23069.7186      -     -  728s
     0     0 23068.5799    0  402    4.91681 23068.5799      -     -  730s
     0     0 22991.7747    0  427    4.91681 22991.7747      -     -  741s
H    0     0                     138.0443250 22991.6380      -     -  742s
     0     0 22969.9558    0  465  138.04432 22969.9558      -     -  747s
     0     0 22961.9485    0  440  138.04432 22961.9485      -     -  752s
     0     0 22957.2953    0  491  138.04432 22957.2953      -     -  757s
     0     0 22900.0907    0  443  138.04432 22900.0907      -     -  764s
     0     0 22892.3677    0  450  138.04432 22892.3677      -     -  768s
     0     0 22888.5209    0  527  138.04432 22888.5209      -     -  772s
     0     0 22888.2072    0  529  138.04432 22888.2072      -     -  773s
     0     0 22766.9119    0  418  138.04432 22766.9119      -     -  785s
     0     0 22738.1339    0  427  138.04432 22738.1339      -     -  798s
     0     0 22734.3334    0  422  138.04432 22734.3334      -     -  800s
     0     0 22733.1909    0  418  138.04432 22733.1909      -     -  801s
     0     0 22715.8912    0  390  138.04432 22715.8912      -     -  808s
     0     0 22712.2331    0  398  138.04432 22712.2331      -     -  811s
     0     0 22711.3863    0  394  138.04432 22711.3863      -     -  812s
     0     0 22702.7292    0  429  138.04432 22702.7292      -     -  817s
     0     0 22698.8987    0  423  138.04432 22698.8987      -     -  822s
     0     0 22697.7187    0  381  138.04432 22697.7187      -     -  824s
     0     0 22693.1083    0  480  138.04432 22693.1083      -     -  829s
     0     0 22692.3213    0  439  138.04432 22692.3213      -     -  833s
     0     0 22558.0143    0  387  138.04432 22558.0143      -     -  846s
H    0     0                     203.9822499 22557.5770      -     -  848s
     0     0 22495.7710    0  409  203.98225 22495.7710      -     -  856s
     0     0 22469.3780    0  357  203.98225 22469.3780      -     -  861s
     0     0 22463.6059    0  435  203.98225 22463.6059      -     -  864s
     0     0 22460.9398    0  431  203.98225 22460.9398      -     -  865s
     0     0 22459.5919    0  440  203.98225 22459.5919      -     -  866s
     0     0 22437.9938    0  431  203.98225 22437.9938      -     -  874s
     0     0 22411.4104    0  421  203.98225 22411.4104      -     -  879s
     0     0 22404.6472    0  431  203.98225 22404.6472      -     -  880s
     0     0 22401.1839    0  480  203.98225 22401.1839      -     -  882s
     0     0 22400.6516    0  485  203.98225 22400.6516      -     -  883s
     0     0 22379.1059    0  415  203.98225 22379.1059      -     -  890s
H    0     0                     532.1906628 22378.7833  4105%     -  906s
H    0     0                    1292.9904014 22378.7833  1631%     -  909s
     0     0 22378.2577    0  418 1292.99040 22378.2577  1631%     -  912s
     0     0 22377.3990    0  409 1292.99040 22377.3990  1631%     -  915s
     0     0 22376.0011    0  414 1292.99040 22376.0011  1631%     -  917s
     0     0 22375.7906    0  414 1292.99040 22375.7906  1631%     -  920s
H    0     0                    1943.7985056 22375.4537  1051%     -  923s
H    0     0                    2252.9693708 22375.4537   893%     -  923s
H    0     0                    2449.7054514 22375.4537   813%     -  925s
H    0     0                    2453.6439627 22375.4537   812%     -  925s
H    0     0                    2532.2108971 22375.4537   784%     -  925s
     0     0 22375.3703    0  418 2532.21090 22375.3703   784%     -  926s
     0     0 22375.1800    0  414 2532.21090 22375.1800   784%     -  929s
     0     0 22374.8896    0  414 2532.21090 22374.8896   784%     -  937s
H    0     0                    2606.0447524 22374.4237   759%     - 1080s
     0     2 22374.4237    0  414 2606.04475 22374.4237   759%     - 1084s
     1     3 21706.0120    1  394 2606.04475 22374.4237   759% 30548 1142s
     2     4 22170.6273    1  436 2606.04475 22170.6273   751% 20844 1163s
     3     6 22121.9729    2  474 2606.04475 22170.4300   751% 15985 1194s
     5    12 20763.2152    3  373 2606.04475 22170.4300   751% 15564 1229s
    11    24 20576.3840    4  361 2606.04475 21812.1710   737% 12965 1274s
    23    36 21397.5677    5  487 2606.04475 21679.8784   732% 17886 1356s
    35    68 20104.2562    6  342 2606.04475 21679.8784   732% 22164 1615s
H   36    68                    2639.8121876 21679.8784   721% 21549 1615s
H   37    68                    4220.7657736 21679.8784   414% 21233 1615s
H   43    68                    4551.2957574 21679.8784   376% 20062 1615s
H   44    68                    4649.7230087 21679.8784   366% 19935 1615s
H   51    68                    4650.3062179 21679.8784   366% 18680 1615s
    67   116 20034.5613    7  336 4650.30622 21101.6562   354% 23989 1709s
H  115   170                    4878.5237872 21101.6562   333% 18345 1783s
H  124   170                    4967.9237157 21101.6562   325% 17624 1783s
H  127   170                    5304.9886936 21101.6562   298% 17353 1783s
H  133   170                    7121.6086869 21101.6562   196% 16830 1783s
   169   267 19183.7037   11  433 7121.60869 21101.6562   196% 15354 1855s
   268   344 18884.0768   14  421 7121.60869 21101.6562   196% 12414 1905s
   351   418 18628.7848   18  409 7121.60869 21101.6562   196% 10815 1950s
   431   482 18446.4479   20  403 7121.60869 21101.6562   196% 10192 1992s
   505   533 18107.6691   24  369 7121.60869 21101.6562   196%  9656 2029s
H  558   573                    7374.2991351 21101.6562   186%  9373 2056s
H  562   573                    7503.1918593 21101.6562   181%  9356 2056s
H  566   573                    8008.5408801 21101.6562   163%  9336 2056s
H  579   573                    8237.9666147 21101.6562   156%  9447 2056s
   600   638 17628.2184   31  365 8237.96661 21101.6562   156%  9459 2093s
   679   710 17119.3588   35  458 8237.96661 21101.6562   156%  9139 2125s
   757   758 17076.8934   39  489 8237.96661 21101.6562   156%  8803 2151s
   827   810 16385.5552   42  410 8237.96661 21101.6562   156%  8585 2179s
   905   885 16157.8827   46  286 8237.96661 21101.6562   156%  8445 2209s
  1002   914 15427.3430   52  364 8237.96661 21101.6562   156%  8201 2233s
H 1005   914                    8529.1360297 21101.6562   147%  8192 2233s
H 1008   914                    8607.6517729 21101.6562   145%  8201 2233s
H 1021   914                    8762.6982864 21101.6562   141%  8178 2233s
  1037   979 15415.4936   53  332 8762.69829 21101.6562   141%  8195 2267s
  1140  1000 14207.3969   60  318 8762.69829 21101.6562   141%  7953 2298s
H 1177  1000                    9238.6997800 21101.6562   128%  7916 2298s
  1178  1070 13420.8598   61  382 9238.69978 21101.6562   128%  7919 2327s
  1284  1191 11149.4894   67  232 9238.69978 21101.6562   128%  7773 2356s
  1418  1288     cutoff   75      9238.69978 21101.6562   128%  7532 2390s
  1545  1363 infeasible   21      9238.69978 21101.6562   128%  7366 2425s
  1678  1412 13485.0279   27  261 9238.69978 21101.6562   128%  7188 2460s
  1780  1485 13374.9334   28  249 9238.69978 21101.6562   128%  7157 2501s
  1899  1556 11992.8217   30  240 9238.69978 21101.6562   128%  7107 2544s
H 2026  1596                    9271.5073997 20520.0347   121%  7068 2583s
H 2030  1596                    9407.6321524 20520.0347   118%  7065 2583s
H 2045  1596                    9428.7076208 20520.0347   118%  7061 2583s
H 2055  1596                    9453.8983672 20520.0347   117%  7050 2583s
  2092  1687 10875.6667   37  250 9453.89837 20520.0347   117%  7104 2622s
  2211  1708 9606.47350   45  222 9453.89837 20520.0347   117%  7071 2662s
H 2215  1708                    9463.0998042 20520.0347   117%  7064 2662s
H 2219  1708                    9497.4495129 20520.0347   116%  7060 2662s
  2260  1802 infeasible   47      9497.44951 20520.0347   116%  7071 2710s
  2406  1882 13043.3356   40  345 9497.44951 20231.3000   113%  7026 2752s
  2578  2017 11792.7260   45  354 9497.44951 20231.1455   113%  6957 2804s
  2755  2096 9672.14878   48  254 9497.44951 20231.1455   113%  6880 2852s
  2910  2145 infeasible   49      9497.44951 19954.7872   110%  6889 2901s
  3027  2165 13721.7450   16  250 9497.44951 19954.7872   110%  6969 2957s
  3067  2191 10937.5879   17  248 9497.44951 19954.7872   110%  7085 3011s
  3109  2231 10865.9790   18  231 9497.44951 19954.7872   110%  7203 3064s
  3155  2269 10833.0860   19  232 9497.44951 19720.2840   108%  7267 3112s
H 3198  2268                    9512.7270078 19720.2840   107%  7329 3112s
H 3211  2356                    9520.6937308 19720.2840   107%  7319 3164s
H 3215  2354                    9545.3281244 19720.2840   107%  7317 3164s
H 3239  2354                    9548.3007234 19720.2840   107%  7336 3164s
H 3270  2354                    9548.8668743 19720.2840   107%  7350 3164s
H 3306  2354                    9553.2967083 19720.2840   106%  7374 3164s
  3319  2445 infeasible   23      9553.29671 19720.2840   106%  7370 3228s
  3517  2530 12831.3415   20  273 9553.29671 19720.2840   106%  7349 3299s
  3685  2579 16093.2485   12  421 9553.29671 19720.2840   106%  7332 3365s
  3844  2668 14850.5419   14  452 9553.29671 19720.2840   106%  7406 3434s
  3986  2772 11932.0304   18  331 9553.29671 19720.2840   106%  7542 3507s

Cutting planes:
  Learned: 3
  Gomory: 5
  Implied bound: 223
  MIR: 3094
  Flow cover: 3073
  RLT: 58
  Relax-and-lift: 611

Explored 4140 nodes (32327389 simplex iterations) in 3600.05 seconds (5835.07 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 9553.3 9548.3 9545.33 ... 9407.63

Time limit reached
Best objective 9.553296708257e+03, best bound 1.972028402554e+04, gap 106.4239%
  WARNING: Time limit reached. Using best solution found (gap: 106.42%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3600.09s
  Master Objective (UB) = 9553.30, θ = 153830.38
  Upper Bound (UB) = 9553.30

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 153830.38
  [DEBUG]   ✓ Scenario 0: θ = 153830.38 ≤ Q = 153830.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 153830.38 ≤ Q = 153830.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 153830.38 ≤ Q = 153830.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 153830.38 ≤ Q = 153830.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 153830.38 ≤ Q = 153830.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 153830.38 ≤ Q = 153830.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 153830.38 ≤ Q = 153830.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 153830.38 ≤ Q = 153830.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 153830.38 ≤ Q = 153830.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 153830.38 ≤ Q = 153830.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 153830.38 ≤ Q = 153830.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 153830.38 ≤ Q = 153830.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 153830.38 ≤ Q = 153830.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 153830.38 ≤ Q = 153830.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 153830.38 ≤ Q = 153830.38 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 15] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x65f41277
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x65f41277
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.240882e+13
Presolve removed 2587 rows and 1879 columns
Presolve time: 0.01s
Presolved: 506 rows, 510 columns, 1427 nonzeros
Found heuristic solution: objective 6198774.3706
Variable types: 346 continuous, 164 integer (164 binary)

Root relaxation: objective -1.381035e+05, 251 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -138103.55    0  123 6198774.37 -138103.55   102%     -    0s
H    0     0                    -105219.7402 -138103.55  31.3%     -    0s
H    0     0                    -105537.6462 -138103.55  30.9%     -    0s
H    0     0                    -108155.8600 -110575.94  2.24%     -    0s
     0     0 -110575.94    0   84 -108155.86 -110575.94  2.24%     -    0s
H    0     0                    -108452.6582 -110505.26  1.89%     -    0s
H    0     0                    -108623.4973 -110505.26  1.73%     -    0s
H    0     0                    -108920.2956 -110505.26  1.46%     -    0s
     0     0 -110070.94    0   66 -108920.30 -110070.94  1.06%     -    0s
H    0     0                    -109276.8243 -110057.77  0.71%     -    0s
     0     0 -109814.71    0   54 -109276.82 -109814.71  0.49%     -    0s
     0     0 -109809.04    0   53 -109276.82 -109809.04  0.49%     -    0s
     0     0 -109640.20    0   45 -109276.82 -109640.20  0.33%     -    0s
     0     0 -109617.67    0   44 -109276.82 -109617.67  0.31%     -    0s
     0     0 -109617.38    0   49 -109276.82 -109617.38  0.31%     -    0s
     0     0 -109500.96    0   35 -109276.82 -109500.96  0.21%     -    0s
     0     0 -109457.62    0   35 -109276.82 -109457.62  0.17%     -    0s
     0     0 -109456.43    0   35 -109276.82 -109456.43  0.16%     -    0s
     0     0 -109456.43    0   78 -109276.82 -109456.43  0.16%     -    0s
     0     0 -109456.43    0   44 -109276.82 -109456.43  0.16%     -    0s
     0     0 -109449.95    0   43 -109276.82 -109449.95  0.16%     -    0s
     0     0 -109436.21    0   34 -109276.82 -109436.21  0.15%     -    0s
     0     0 -109435.90    0   33 -109276.82 -109435.90  0.15%     -    0s
     0     0 -109353.24    0   43 -109276.82 -109353.24  0.07%     -    0s
     0     0 -109339.83    0   42 -109276.82 -109339.83  0.06%     -    0s
     0     0 -109333.15    0   43 -109276.82 -109333.15  0.05%     -    0s
     0     0 -109330.61    0   43 -109276.82 -109330.61  0.05%     -    0s
     0     0 -109330.61    0   51 -109276.82 -109330.61  0.05%     -    0s
     0     0 -109330.61    0   40 -109276.82 -109330.61  0.05%     -    0s
     0     0 -109330.61    0   36 -109276.82 -109330.61  0.05%     -    0s
     0     0 -109330.61    0   35 -109276.82 -109330.61  0.05%     -    0s
     0     0 -109330.61    0   35 -109276.82 -109330.61  0.05%     -    0s
     0     0 -109330.61    0   34 -109276.82 -109330.61  0.05%     -    0s
     0     0 -109329.25    0   35 -109276.82 -109329.25  0.05%     -    0s
     0     0 -109324.27    0   34 -109276.82 -109324.27  0.04%     -    0s
     0     0 -109322.67    0   34 -109276.82 -109322.67  0.04%     -    0s
     0     0 -109319.39    0   34 -109276.82 -109319.39  0.04%     -    0s
H    0     0                    -109277.5088 -109319.39  0.04%     -    0s
     0     0 -109319.39    0   31 -109277.51 -109319.39  0.04%     -    0s
     0     0 -109319.39    0   40 -109277.51 -109319.39  0.04%     -    0s
     0     0 -109319.39    0   35 -109277.51 -109319.39  0.04%     -    0s
     0     0 -109319.39    0   34 -109277.51 -109319.39  0.04%     -    0s
     0     0 -109319.39    0   34 -109277.51 -109319.39  0.04%     -    0s
     0     0 -109319.39    0   34 -109277.51 -109319.39  0.04%     -    0s
     0     0 -109319.39    0   34 -109277.51 -109319.39  0.04%     -    0s
     0     0 -109319.39    0   34 -109277.51 -109319.39  0.04%     -    0s
     0     2 -109319.39    0   34 -109277.51 -109319.39  0.04%     -    0s

Cutting planes:
  Gomory: 17
  Implied bound: 3
  MIR: 39
  Flow cover: 15
  RLT: 7

Explored 6 nodes (1746 simplex iterations) in 0.38 seconds (0.11 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -109278 -109277 -108925 ... 1.24088e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.092775088465e+05, best bound -1.092825362351e+05, gap 0.0046%
  Subproblem solved in 0.41s
  Worst-case operational profit (Z_SP) = 152025.84
  Scenario: 4 demand increases, 56 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -109277.51
  [DEBUG]   S×d_nominal = 261303.35
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 261303.35 + -109277.51 = 152025.84
  [DEBUG]   Current θ from Master = 153830.38
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1804.54 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 7748.75
  Lower Bound (LB) = 7748.75
  Gap (UB-LB) = 1804.5424, Absolute Gap = 1804.5424, Relative Gap = 0.188892
  Not converged yet (gap = 1804.54 > ε = 200)

  [DEBUG] Adding NEW scenario 15 to Master Problem...
  [DEBUG] New scenario pattern: 4 increases, 56 decreases
    [DEBUG] Scenario 15 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 15 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 15]
    [DEBUG]   - Total constraints in model: 246023
    [DEBUG]   - Total variables in model: 102100
  [DEBUG] Total scenarios in Master: 16
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 16
================================================================================
[Iteration 16] Solving Master Problem...
  Current scenarios in Master: 16
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 246023 rows, 102100 columns and 697311 nonzeros
Model fingerprint: 0xa368c70a
Variable types: 99841 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 110068 rows and 44698 columns (presolve time = 5s)...
Presolve removed 110068 rows and 44698 columns
Presolve time: 5.02s
Presolved: 135955 rows, 57402 columns, 836672 nonzeros
Variable types: 55143 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -359784.4177
Found heuristic solution: objective -183019.6155

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.69s

Barrier statistics:
 Dense cols : 702
 AA' NZ     : 5.887e+06
 Factor NZ  : 1.336e+07 (roughly 200 MB of memory)
 Factor Ops : 2.996e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.19356630e+07  2.34733447e+08  1.31e+05 1.58e+01  9.37e+04     9s
   1  -1.71044668e+07  2.13975748e+08  9.42e+04 8.94e+01  6.65e+04     9s
   2  -5.17310982e+06  1.68443988e+08  2.79e+04 5.80e-01  2.09e+04     9s
   3  -8.43084518e+05  1.24635844e+08  1.50e+03 1.46e+00  1.58e+03     9s
   4  -5.95114231e+05  6.60000990e+07  4.13e+02 5.37e-01  5.36e+02    10s
   5  -4.58733157e+05  4.21725074e+07  1.49e+02 2.94e-01  2.60e+02    10s
   6  -3.99164778e+05  3.01999341e+07  5.53e+01 1.99e-01  1.53e+02    10s
   7  -3.23384411e+05  2.42895906e+07  2.14e+01 1.56e-01  1.09e+02    10s
   8  -2.06675499e+05  1.44173494e+07  3.95e+00 8.91e-02  6.02e+01    10s
   9  -1.51177977e+05  3.95220885e+06  2.46e+00 2.08e-02  1.68e+01    10s
  10  -1.10770202e+05  2.94327888e+06  1.43e+00 1.54e-02  1.24e+01    10s
  11  -1.03349242e+05  2.15603497e+06  9.53e-01 1.13e-02  9.17e+00    10s
  12  -7.37757797e+04  1.79003030e+06  4.93e-01 9.40e-03  7.54e+00    10s
  13  -5.76121602e+04  1.10976086e+06  2.97e-01 5.72e-03  4.71e+00    11s
  14  -3.04737819e+04  3.98119665e+05  8.67e-02 1.96e-03  1.73e+00    11s
  15  -1.81268182e+04  2.32876048e+05  5.27e-02 1.25e-03  1.01e+00    11s
  16   1.88399116e+02  1.59699183e+05  2.47e-02 1.10e-03  6.43e-01    11s
  17   3.79582302e+03  1.33767861e+05  2.16e-02 8.68e-04  5.24e-01    11s
  18   1.12952055e+04  9.94394414e+04  1.55e-02 5.62e-04  3.55e-01    11s
  19   1.72378839e+04  8.20628838e+04  1.12e-02 4.12e-04  2.61e-01    11s
  20   2.19293335e+04  6.97214951e+04  8.17e-03 3.03e-04  1.93e-01    12s
  21   2.52642804e+04  5.83192925e+04  6.21e-03 2.15e-04  1.33e-01    12s
  22   2.79586168e+04  5.48781067e+04  4.82e-03 1.77e-04  1.08e-01    12s
  23   2.97287862e+04  5.14412655e+04  3.96e-03 1.89e-04  8.75e-02    12s
  24   3.07611593e+04  4.72943326e+04  3.47e-03 1.73e-04  6.66e-02    12s
  25   3.28847467e+04  4.55975124e+04  2.54e-03 1.58e-04  5.12e-02    13s
  26   3.45793761e+04  4.43605629e+04  1.83e-03 1.26e-04  3.94e-02    13s
  27   3.56345637e+04  4.32972253e+04  1.38e-03 1.00e-04  3.09e-02    13s
  28   3.65543332e+04  4.19544098e+04  1.00e-03 6.69e-05  2.18e-02    13s
  29   3.70570631e+04  4.12349382e+04  8.00e-04 5.02e-05  1.68e-02    13s
  30   3.79832101e+04  4.07815978e+04  4.51e-04 3.87e-05  1.13e-02    13s
  31   3.81369298e+04  4.06064843e+04  3.92e-04 3.45e-05  9.95e-03    14s
  32   3.84705845e+04  4.01123447e+04  2.63e-04 2.20e-05  6.62e-03    14s
  33   3.87157231e+04  3.97853301e+04  1.73e-04 1.37e-05  4.31e-03    14s
  34   3.90669708e+04  3.95875427e+04  4.91e-05 8.94e-06  2.10e-03    14s
  35   3.91275781e+04  3.94045783e+04  2.95e-05 4.33e-06  1.12e-03    14s
  36   3.91668883e+04  3.93573593e+04  1.70e-05 3.16e-06  7.67e-04    15s
  37   3.91814646e+04  3.92791351e+04  1.27e-05 1.26e-06  3.94e-04    15s
  38   3.92035649e+04  3.92667482e+04  6.21e-06 9.64e-07  2.55e-04    15s
  39   3.92156876e+04  3.92475150e+04  2.82e-06 4.87e-07  1.28e-04    15s
  40   3.92164260e+04  3.92454256e+04  2.61e-06 4.38e-07  1.17e-04    15s
  41   3.92246434e+04  3.92307594e+04  5.07e-07 1.20e-07  2.46e-05    15s
  42   3.92267263e+04  3.92272054e+04  7.24e-08 4.91e-09  1.93e-06    15s
  43   3.92270800e+04  3.92270823e+04  2.47e-09 9.16e-09  9.51e-09    16s
  44   3.92270812e+04  3.92270812e+04  2.75e-09 2.26e-11  3.65e-11    16s

Barrier solved model in 44 iterations and 15.74 seconds (13.31 work units)
Optimal objective 3.92270812e+04


Root crossover log...

  121409 DPushes remaining with DInf 0.0000000e+00                16s
       0 DPushes remaining with DInf 0.0000000e+00                20s

    1908 PPushes remaining with PInf 2.4559917e-06                20s
       0 PPushes remaining with PInf 0.0000000e+00                20s

  Push phase complete: Pinf 0.0000000e+00, Dinf 4.2767020e-02     20s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   53496    3.9227081e+04   0.000000e+00   4.276702e-02     20s
   53497    3.9227081e+04   0.000000e+00   0.000000e+00     20s
   53497    3.9227081e+04   0.000000e+00   0.000000e+00     20s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 3.922708e+04, 53497 iterations, 13.77 seconds (15.13 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 39227.0812    0  173 -183019.62 39227.0812   121%     -   20s
H    0     0                    -161954.0915 39227.0812   124%     -   21s
H    0     0                    -135933.0885 39227.0812   129%     -   21s
H    0     0                    -91016.38709 39227.0812   143%     -   21s
H    0     0                    -90415.99844 39227.0812   143%     -   22s
H    0     0                    -11335.18532 39227.0812   446%     -   22s
H    0     0                    -9587.297590 39227.0812   509%     -   22s
H    0     0                    -9568.415540 39227.0812   510%     -   23s
H    0     0                    -7738.696035 39227.0812   607%     -   23s
H    0     0                    -7037.324538 39227.0812   657%     -   23s
H    0     0                    -6859.346603 39227.0812   672%     -   23s
     0     0 32945.8204    0  216 -6859.3466 32945.8204   580%     -   91s
H    0     0                    -6588.465219 32945.8138   600%     -   93s
H    0     0                    -6531.739350 32945.8138   604%     -   93s
     0     0 32256.7611    0  216 -6531.7394 32256.7611   594%     -  137s
     0     0 32192.7086    0  216 -6531.7394 32192.7086   593%     -  154s
     0     0 32000.3715    0  229 -6531.7394 32000.3715   590%     -  176s
     0     0 31988.7297    0  230 -6531.7394 31988.7297   590%     -  182s
     0     0 31877.8707    0  222 -6531.7394 31877.8707   588%     -  200s
     0     0 31735.2559    0  216 -6531.7394 31735.2559   586%     -  217s
     0     0 31704.1996    0  222 -6531.7394 31704.1996   585%     -  222s
     0     0 31566.2391    0  300 -6531.7394 31566.2391   583%     -  234s
     0     0 31520.8800    0  256 -6531.7394 31520.8800   583%     -  242s
     0     0 31518.9408    0  260 -6531.7394 31518.9408   583%     -  246s
     0     0 31518.6428    0  256 -6531.7394 31518.6428   583%     -  247s
     0     0 28878.4576    0  346 -6531.7394 28878.4576   542%     -  315s
H    0     0                    -1328.329464 28877.8143  2274%     -  317s
     0     0 28515.5705    0  336 -1328.3295 28515.5705  2247%     -  356s
     0     0 28346.3696    0  411 -1328.3295 28346.3696  2234%     -  378s
     0     0 28307.2838    0  413 -1328.3295 28307.2838  2231%     -  387s
     0     0 28185.6340    0  416 -1328.3295 28185.6340  2222%     -  412s
     0     0 28110.4999    0  404 -1328.3295 28110.4999  2216%     -  433s
     0     0 28092.6124    0  409 -1328.3295 28092.6124  2215%     -  437s
     0     0 28082.5430    0  407 -1328.3295 28082.5430  2214%     -  440s
     0     0 28082.2511    0  407 -1328.3295 28082.2511  2214%     -  441s
     0     0 25651.7901    0  366 -1328.3295 25651.7901  2031%     -  527s
H    0     0                    -1286.907999 25651.7880  2093%     -  529s
H    0     0                    -1114.984123 25651.7880  2401%     -  529s
H    0     0                    -1034.092052 25651.7880  2581%     -  529s
H    0     0                    -798.4936401 25651.7880  3313%     -  529s
     0     0 25108.5840    0  399 -798.49364 25108.5840  3244%     -  577s
     0     0 24978.2728    0  407 -798.49364 24978.2728  3228%     -  596s
     0     0 24856.8736    0  428 -798.49364 24856.8736  3213%     -  613s
     0     0 24824.8027    0  423 -798.49364 24824.8027  3209%     -  622s
     0     0 24801.2562    0  421 -798.49364 24801.2562  3206%     -  626s
     0     0 24796.8667    0  429 -798.49364 24796.8667  3205%     -  627s
     0     0 24795.9386    0  429 -798.49364 24795.9386  3205%     -  629s
     0     0 23808.8116    0  447 -798.49364 23808.8116  3082%     -  680s
H    0     0                    -768.5688182 23808.1432  3198%     -  681s
     0     0 23641.6394    0  450 -768.56882 23641.6394  3176%     -  702s
     0     0 23559.1212    0  494 -768.56882 23559.1212  3165%     -  718s
     0     0 23468.5403    0  441 -768.56882 23468.5403  3154%     -  730s
     0     0 23429.2359    0  440 -768.56882 23429.2359  3148%     -  742s
     0     0 23401.7828    0  490 -768.56882 23401.7828  3145%     -  752s
     0     0 23388.4289    0  432 -768.56882 23388.4289  3143%     -  759s
     0     0 23364.5461    0  440 -768.56882 23364.5461  3140%     -  764s
     0     0 23352.6344    0  450 -768.56882 23352.6344  3138%     -  769s
     0     0 23344.7726    0  444 -768.56882 23344.7726  3137%     -  775s
     0     0 23293.4663    0  488 -768.56882 23293.4663  3131%     -  785s
     0     0 23289.0370    0  494 -768.56882 23289.0370  3130%     -  791s
     0     0 23288.0047    0  498 -768.56882 23288.0047  3130%     -  794s
     0     0 23011.5646    0  449 -768.56882 23011.5646  3094%     -  823s
H    0     0                    -476.2190147 23010.8429  4932%     -  824s
     0     0 22972.5461    0  477 -476.21901 22972.5461  4924%     -  837s
     0     0 22962.7242    0  489 -476.21901 22962.7242  4922%     -  843s
     0     0 22939.5723    0  486 -476.21901 22939.5723  4917%     -  850s
     0     0 22932.6984    0  493 -476.21901 22932.6984  4916%     -  856s
     0     0 22928.7947    0  550 -476.21901 22928.7947  4915%     -  859s
     0     0 22926.5432    0  559 -476.21901 22926.5432  4914%     -  861s
     0     0 22918.1658    0  556 -476.21901 22918.1658  4913%     -  864s
     0     0 22917.3410    0  558 -476.21901 22917.3410  4912%     -  866s
     0     0 22826.3971    0  479 -476.21901 22826.3971  4893%     -  881s
H    0     0                    -386.2614138 22825.4294  6009%     -  883s
     0     0 22787.4907    0  525 -386.26141 22787.4907  5999%     -  893s
     0     0 22771.8184    0  607 -386.26141 22771.8184  5995%     -  899s
     0     0 22767.5344    0  579 -386.26141 22767.5344  5994%     -  902s
     0     0 22761.0253    0  574 -386.26141 22761.0253  5993%     -  907s
     0     0 22760.1945    0  528 -386.26141 22760.1945  5992%     -  909s
     0     0 22741.9400    0  526 -386.26141 22741.9400  5988%     -  919s
H    0     0                    -341.9042497 22740.7439  6751%     -  920s
     0     0 22734.1535    0  467 -341.90425 22734.1535  6749%     -  925s
     0     0 22732.5381    0  409 -341.90425 22732.5381  6749%     -  927s
     0     0 22727.6448    0  460 -341.90425 22727.6448  6747%     -  935s
H    0     0                    -327.5624427 22727.3911  7038%     -  936s
     0     0 22724.2046    0  514 -327.56244 22724.2046  7037%     -  938s
     0     0 22723.5487    0  582 -327.56244 22723.5487  7037%     -  939s
     0     0 22721.6111    0  462 -327.56244 22721.6111  7037%     -  945s
     0     0 22721.0206    0  493 -327.56244 22721.0206  7036%     -  948s
     0     0 22718.3242    0  413 -327.56244 22718.3242  7036%     -  954s
     0     0 22715.3055    0  481 -327.56244 22715.3055  7035%     -  957s
     0     0 22715.3055    0  465 -327.56244 22715.3055  7035%     -  961s
     0     0 22715.3055    0  485 -327.56244 22715.3055  7035%     -  963s
     0     0 22715.3055    0  479 -327.56244 22715.3055  7035%     -  967s
     0     0 22715.3055    0  479 -327.56244 22715.3055  7035%     -  976s
H    0     0                    4028.7602208 22715.3055   464%     - 1079s
H    0     0                    4043.1020277 22715.3055   462%     - 1082s
H    0     0                    4210.1537203 22715.3055   440%     - 1082s
H    0     0                    4229.2208461 22715.3055   437%     - 1082s
H    0     0                    4252.4054451 22715.3055   434%     - 1086s
H    0     0                    4257.9002373 22715.3055   433%     - 1086s
H    0     0                    4378.3540267 22715.3055   419%     - 1090s
H    0     0                    4510.2499043 22715.3055   404%     - 1090s
H    0     2                    5833.4232387 22715.3055   289%     - 1101s
     0     2 22715.3055    0  479 5833.42324 22715.3055   289%     - 1101s
     1     3 22220.7081    1  474 5833.42324 22715.3055   289% 15729 1127s
     2     5 21340.2553    2  364 5833.42324 22715.3055   289% 15352 1164s
     4     9 21225.9755    3  365 5833.42324 22558.3252   287% 11730 1285s
     8    18 19113.6380    3  299 5833.42324 22558.3252   287% 17724 1336s
    17    36 18914.2901    4  294 5833.42324 22031.2658   278% 16114 1399s
    35    50 20941.6543    5  389 5833.42324 21783.5228   273% 24895 3199s
H   49    78                    6129.4915601 21783.5228   255% 25181 3312s
H   50    78                    6157.9952582 21783.5228   254% 24959 3312s
H   56    78                    6474.2017783 21783.5228   236% 24081 3312s
H   67    78                    7148.4841824 21783.5228   205% 22334 3312s
    77   171 20310.6508    7  397 7148.48418 21783.5228   205% 21193 3490s
H  170   260                    7830.1372138 21783.5228   178% 14946 3581s
   259   278 18156.8544   12  380 7830.13721 21783.5228   178% 11540 3600s

Cutting planes:
  Learned: 1
  Gomory: 17
  Implied bound: 198
  MIR: 2699
  Flow cover: 2579
  RLT: 60
  Relax-and-lift: 620

Explored 283 nodes (3593636 simplex iterations) in 3600.09 seconds (4232.51 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 7830.14 7148.48 6474.2 ... 4252.41

Time limit reached
Best objective 7.830137213759e+03, best bound 2.178352283094e+04, gap 178.2010%
  WARNING: Time limit reached. Using best solution found (gap: 178.20%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 3600.11s
  Master Objective (UB) = 7830.14, θ = 152692.25
  Upper Bound (UB) = 7830.14

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 152692.25
  [DEBUG]   ✓ Scenario 0: θ = 152692.25 ≤ Q = 152692.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 152692.25 ≤ Q = 152692.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 152692.25 ≤ Q = 152692.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 152692.25 ≤ Q = 152692.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 152692.25 ≤ Q = 152692.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 152692.25 ≤ Q = 152692.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 152692.25 ≤ Q = 152692.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 152692.25 ≤ Q = 152692.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 152692.25 ≤ Q = 152692.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 152692.25 ≤ Q = 152692.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 152692.25 ≤ Q = 152692.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 152692.25 ≤ Q = 152692.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 152692.25 ≤ Q = 152692.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 152692.25 ≤ Q = 152692.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 152692.25 ≤ Q = 152692.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 152692.25 ≤ Q = 152692.25 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 16] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x4319a57a
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xbce65a86
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [3e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.231199e+13
Presolve removed 2594 rows and 1885 columns
Presolve time: 0.01s
Presolved: 499 rows, 504 columns, 1411 nonzeros
Found heuristic solution: objective 6138127.8999
Variable types: 341 continuous, 163 integer (163 binary)
Found heuristic solution: objective 6137733.8964

Root relaxation: objective -1.403958e+05, 248 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -140395.80    0  121 6137733.90 -140395.80   102%     -    0s
H    0     0                    -102225.8283 -140395.80  37.3%     -    0s
H    0     0                    -106963.7431 -140395.80  31.3%     -    0s
H    0     0                    -107470.4147 -140180.92  30.4%     -    0s
     0     0 -117733.42    0  117 -107470.41 -117733.42  9.55%     -    0s
H    0     0                    -113704.9355 -117662.28  3.48%     -    0s
H    0     0                    -114038.9503 -117662.28  3.18%     -    0s
H    0     0                    -114422.7492 -117662.28  2.83%     -    0s
H    0     0                    -114756.7640 -117662.28  2.53%     -    0s
     0     0 -116281.82    0  117 -114756.76 -116281.82  1.33%     -    0s
H    0     0                    -115709.7165 -116272.19  0.49%     -    0s
     0     0 -116025.78    0   23 -115709.72 -116025.78  0.27%     -    0s
     0     0 -116006.11    0   19 -115709.72 -116006.11  0.26%     -    0s
     0     0 -115910.56    0   22 -115709.72 -115910.56  0.17%     -    0s
     0     0 -115900.56    0   19 -115709.72 -115900.56  0.16%     -    0s
     0     0 -115861.77    0    8 -115709.72 -115861.77  0.13%     -    0s
     0     0 -115844.29    0   10 -115709.72 -115844.29  0.12%     -    0s
     0     0 -115844.29    0    7 -115709.72 -115844.29  0.12%     -    0s
     0     0 -115844.29    0    7 -115709.72 -115844.29  0.12%     -    0s
H    0     0                    -115718.2693 -115844.29  0.11%     -    0s
H    0     0                    -115785.0582 -115844.29  0.05%     -    0s
     0     0 -115844.29    0   56 -115785.06 -115844.29  0.05%     -    0s
     0     0          -    0      -115785.06 -115796.17  0.01%     -    0s

Cutting planes:
  Gomory: 1
  Implied bound: 36
  MIR: 48
  Flow cover: 13
  RLT: 3

Explored 1 nodes (850 simplex iterations) in 0.13 seconds (0.05 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -115785 -115718 -115710 ... 6.13813e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.157850582366e+05, best bound -1.157961671355e+05, gap 0.0096%
  Subproblem solved in 0.16s
  Worst-case operational profit (Z_SP) = 146340.93
  Scenario: 26 demand increases, 34 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -115785.06
  [DEBUG]   S×d_nominal = 262125.99
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 262125.99 + -115785.06 = 146340.93
  [DEBUG]   Current θ from Master = 152692.25
  [DEBUG]   ⚠️  Z_SP ≤ θ by 6351.33 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 1478.81
  Lower Bound (LB) = 7748.75
  Gap (UB-LB) = 81.3829, Absolute Gap = 81.3829, Relative Gap = 0.010394
  *** CONVERGED (gap within tolerance) ***

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 16
Total Time: 39914.93s
Converged: True
Final Lower Bound: 7748.7543
Final Upper Bound: 7830.1372
Final Gap: 81.382926
Number of Critical Scenarios: 16
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [2] (1/3)
Product 1 Plants: [1] (1/3)
Product 2 Plants: [1] (1/3)
Total Plant Openings: 3
DCs Opened: [0, 4, 5, 7] (4/10)
Active Routes (Plant→DC): 11
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 11 customers  Mode 1: 7 customers  Mode 2: 32 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 16
Start Time: 2026-01-04 12:31:02
End Time: 2026-01-04 23:36:17
Total Time: 39914.93s
Optimal Value: 7748.75
Lower Bound: 7748.75
Upper Bound: 7830.14
Gap: 81.382926
Plants Opened: {0: [2], 1: [1], 2: [1]} (3 plants)
DCs Opened: [0, 4, 5, 7] (4 DCs)
================================================================================

Results saved to: result/DH_single_full_seed23_Mixed_gamma20_20260104_233618.csv

Total Execution Time: 39915.29 seconds
End Time: 2026-01-04 23:36:18

All tasks completed successfully!

