
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 29
DI Scenario: LD
Start Time: 2026-01-04 21:32:23
================================================================================
Loading data from data/DH_data_full_seed29.pkl...

Applying DI scenario: LD
DI values:
  Product 0: ['1.000', '1.135', '1.289'] (k=0.313)
  Product 1: ['1.000', '1.084', '1.175'] (k=0.198)
  Product 2: ['1.000', '1.046', '1.095'] (k=0.112)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=950, max=1770
  DC capacity (MC): min=539, max=737

Demand Structure (s_rk matrix):
  Total customer-product pairs: 82/150 (45.3% sparse)
  Average products per customer: 1.64

Demand (only non-zero entries):
  Nominal (μ): min=8.14, max=34.00, count=82
  Deviation (μ̂): min=4.00, max=9.92

Costs:
  Plant fixed cost: min=5193, max=8376
  DC fixed cost: min=3911, max=5831
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.318', '1.736'] (k=0.680)
    Product 1: ['1.000', '1.385', '1.918'] (k=0.803)
    Product 2: ['1.000', '1.419', '2.013'] (k=0.863)
  MD:
    Product 0: ['1.000', '1.293', '1.671'] (k=0.633)
    Product 1: ['1.000', '1.164', '1.354'] (k=0.374)
    Product 2: ['1.000', '1.171', '1.372'] (k=0.390)
  LD:
    Product 0: ['1.000', '1.135', '1.289'] (k=0.313)
    Product 1: ['1.000', '1.084', '1.175'] (k=0.198)
    Product 2: ['1.000', '1.046', '1.095'] (k=0.112)
  Mixed:
    Product 0: ['1.000', '1.318', '1.736'] (k=0.680)
    Product 1: ['1.000', '1.164', '1.354'] (k=0.374)
    Product 2: ['1.000', '1.046', '1.095'] (k=0.112)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48756 nonzeros
Model fingerprint: 0xf346acd2
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-03, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11789 rows and 2789 columns
Presolve time: 0.07s
Presolved: 4884 rows, 5711 columns, 33922 nonzeros
Variable types: 3452 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -301867.2051
Found heuristic solution: objective -189524.3450

Root relaxation: objective 6.541611e+04, 4854 iterations, 0.18 seconds (0.34 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 65416.1083    0  650 -189524.35 65416.1083   135%     -    0s
H    0     0                    -178318.9856 65416.1083   137%     -    0s
H    0     0                    -162818.7317 63345.2553   139%     -    0s
H    0     0                    -157417.0856 63345.2553   140%     -    0s
     0     0 63345.2553    0  875 -157417.09 63345.2553   140%     -    0s
     0     0 63238.0598    0  879 -157417.09 63238.0598   140%     -    0s
     0     0 63233.9091    0  883 -157417.09 63233.9091   140%     -    0s
     0     0 63233.7201    0  879 -157417.09 63233.7201   140%     -    0s
H    0     0                    -155736.8487 60526.4276   139%     -    1s
H    0     0                    -152568.4453 60526.4276   140%     -    1s
H    0     0                    -134767.7103 60526.4276   145%     -    1s
     0     0 60526.4276    0 1064 -134767.71 60526.4276   145%     -    1s
H    0     0                    -134339.0171 60524.5750   145%     -    1s
H    0     0                    -113086.9118 60358.2511   153%     -    1s
H    0     0                    -107685.2658 60358.2511   156%     -    1s
     0     0 60345.5052    0 1075 -107685.27 60345.5052   156%     -    1s
     0     0 60345.5052    0 1093 -107685.27 60345.5052   156%     -    1s
     0     0 59757.7282    0 1095 -107685.27 59757.7282   155%     -    1s
     0     0 59757.7282    0 1095 -107685.27 59757.7282   155%     -    2s
     0     0 57776.9187    0 1197 -107685.27 57776.9187   154%     -    3s
H    0     0                    -107603.8907 56627.6756   153%     -    3s
H    0     0                    -57717.27840 56627.6756   198%     -    3s
H    0     0                    -52277.78235 56627.6756   208%     -    3s
H    0     0                    -45183.36732 56627.6756   225%     -    3s
H    0     0                    -15270.14727 56627.6756   471%     -    3s
     0     0 56627.6756    0 1273 -15270.147 56627.6756   471%     -    3s
     0     0 56571.3941    0 1282 -15270.147 56571.3941   470%     -    3s
     0     0 56571.3941    0 1288 -15270.147 56571.3941   470%     -    3s
     0     0 56571.3941    0 1286 -15270.147 56571.3941   470%     -    3s
     0     0 55405.8643    0 1360 -15270.147 55405.8643   463%     -    5s
     0     0 55405.8643    0 1360 -15270.147 55405.8643   463%     -    5s
     0     2 55405.8643    0 1360 -15270.147 55405.8643   463%     -    6s
     7    16 54449.4977    3  999 -15270.147 55100.0214   461%  3470   10s
H   95   237                    -15202.04951 51195.7648   437%  2492   13s
H   99   237                    -15185.94480 51195.7648   437%  2431   13s
H  101   237                    -15034.85239 51195.7648   441%  2409   13s
H  101   237                    -14418.45020 51195.7648   455%  2409   13s
H  124   237                    -12681.78172 51195.7648   504%  2086   13s
   367   405 37714.7699   11  586 -12681.782 51195.7648   504%  1006   16s
H  379   405                    -7619.999216 51195.7648   772%   996   16s
H  382   405                    13281.472308 51195.7648   285%   995   16s
H  510   615                    13327.750066 51195.7648   284%   834   16s
H  529   615                    13559.662901 51195.7648   278%   817   16s
H  531   615                    13740.674882 51195.7648   273%   816   16s
H  552   615                    14084.481640 51195.7648   263%   807   16s
H  599   615                    14173.718545 51195.7648   261%   767   16s
H  720   751                    15916.820060 51195.7648   222%   686   17s
H  726   751                    15948.138143 51195.7648   221%   682   17s
H  745   751                    16034.072901 51195.7648   219%   675   17s
H  746   751                    16465.701485 51195.7648   211%   674   17s
H  750   751                    16902.301880 51195.7648   203%   671   17s
H  877   849                    16947.032574 48340.7773   185%   628   18s
H  891   849                    17266.619436 48340.7773   180%   627   18s
H  909   849                    17272.593411 47434.1972   175%   621   18s
H 1015   974                    17283.820445 46933.2706   172%   595   19s
H 1017   974                    17288.447994 46933.2706   171%   594   19s
H 1026   974                    17307.395331 46933.2706   171%   594   19s
  1080  1054 22386.4623   30  521 17307.3953 46462.4517   168%   577   20s
H 1445  1329                    17329.222558 46245.7341   167%   510   21s
H 1462  1329                    17392.750221 46245.7341   166%   509   21s
  2346  1987 35833.5006   21  610 17392.7502 45763.3336   163%   424   25s
H 2745  2154                    17513.603551 45065.2131   157%   419   27s
H 3015  2315                    17630.344203 44491.3537   152%   407   29s
H 3016  2310                    17808.722168 44491.3537   150%   407   29s
H 3102  2310                    17816.254892 44080.8423   147%   405   29s
  3350  2557 33986.1580   14  515 17816.2549 44016.3779   147%   396   30s
  3998  2828 28076.2484    6 1360 17816.2549 43863.8539   146%   387   41s
  4013  2838 28134.8454    9  555 17816.2549 28134.8454  57.9%   386   45s
  4052  2893 24877.5915   20  437 17816.2549 25625.4253  43.8%   392   50s
H 4296  2779                    19879.655153 24188.5614  21.7%   390   51s
H 4618  2511                    20058.750703 24081.4332  20.1%   374   52s
H 4626  2380                    20318.262998 24081.4332  18.5%   374   52s
H 4647  2251                    20363.197834 24081.4332  18.3%   373   52s
H 4653  2133                    20412.010174 24081.4332  18.0%   372   52s
H 4663  2018                    20481.428328 24081.4332  17.6%   372   52s
H 4832  1858                    20481.985467 23593.5797  15.2%   361   53s
H 4841  1756                    20555.762527 23099.5859  12.4%   361   53s
H 4859  1655                    20563.866415 23099.5859  12.3%   360   53s
H 4882  1557                    20564.018726 23099.5859  12.3%   358   53s
H 5115  1490                    20990.439699 23099.5859  10.0%   343   53s
H 5446  1202                    21025.717907 23099.5859  9.86%   324   53s
H 5468  1056                    21025.745419 23099.5859  9.86%   322   53s
H 5482   978                    21026.044338 23099.5859  9.86%   322   53s
H 5488   906                    21034.967946 23099.5859  9.82%   321   53s
* 5736   724              64    21038.473968 22148.9154  5.28%   308   53s
* 5789   600              52    21040.744671 22148.9154  5.27%   306   54s
* 5813   532              57    21044.717742 22148.9035  5.25%   305   54s

Cutting planes:
  Implied bound: 1
  Projected implied bound: 36
  MIR: 149
  Flow cover: 308
  RLT: 13
  Relax-and-lift: 91

Explored 5846 nodes (1793665 simplex iterations) in 54.13 seconds (116.33 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: 21044.7 21040.7 21038.5 ... 20563.9

Optimal solution found (tolerance 1.00e-04)
Best objective 2.104471774247e+04, best bound 2.104471774247e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 54.13s
  Master Objective (UB) = 21044.72, θ = 147271.41
  Upper Bound (UB) = 21044.72

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 147271.41
  [DEBUG]   ✓ Scenario 0: θ = 147271.41 ≤ Q = 147271.41 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x22cc53a5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x22cc53a5
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.251128e+13
Presolve removed 2589 rows and 1882 columns
Presolve time: 0.00s
Presolved: 504 rows, 507 columns, 1421 nonzeros
Found heuristic solution: objective 6482051.4105
Variable types: 343 continuous, 164 integer (164 binary)

Root relaxation: objective -1.180004e+05, 243 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -118000.38    0  122 6482051.41 -118000.38   102%     -    0s
H    0     0                    -83152.72111 -118000.38  41.9%     -    0s
H    0     0                    -83825.94695 -118000.38  40.8%     -    0s
*    0     0               0    -86531.62091 -86531.621  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 204

Explored 1 nodes (386 simplex iterations) in 0.01 seconds (0.01 work units)
Thread count was 32 (of 256 available processors)

Solution count 5: -86531.6 -83825.9 -83152.7 ... 1.25113e+13
No other solutions better than -86531.6

Optimal solution found (tolerance 1.00e-04)
Best objective -8.653162091471e+04, best bound -8.653162091471e+04, gap 0.0000%
  Subproblem solved in 0.03s
  Worst-case operational profit (Z_SP) = 112750.08
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -86531.62
  [DEBUG]   S×d_nominal = 199281.70
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 199281.70 + -86531.62 = 112750.08
  [DEBUG]   Current θ from Master = 147271.41
  [DEBUG]   ⚠️  Z_SP ≤ θ by 34521.33 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -13476.62
  Lower Bound (LB) = -13476.62
  Gap (UB-LB) = 34521.3337, Absolute Gap = 34521.3337, Relative Gap = 1.640380
  Not converged yet (gap = 34521.33 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 91993 nonzeros
Model fingerprint: 0x8385c309
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-03, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -13476.6 (0.01s)
MIP start from previous solve produced solution with objective -13476.6 (0.01s)
Loaded MIP start from previous solve with objective -13476.6

Presolve removed 13767 rows and 5586 columns
Presolve time: 0.28s
Presolved: 18196 rows, 9154 columns, 100768 nonzeros
Variable types: 6895 continuous, 2259 integer (2259 binary)

Root relaxation: objective 2.115667e+04, 9658 iterations, 0.94 seconds (2.06 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 21156.6695    0  287 -13476.616 21156.6695   257%     -    1s
H    0     0                    -12804.74412 21156.6695   265%     -    1s
H    0     0                    -11798.95597 21156.6695   279%     -    1s
     0     0 15270.8104    0  439 -11798.956 15270.8104   229%     -    2s
H    0     0                    -11673.36614 15269.8890   231%     -    2s
H    0     0                    -11672.46092 15269.8890   231%     -    2s
H    0     0                    -11371.19670 15269.8890   234%     -    2s
     0     0 15029.3305    0  450 -11371.197 15029.3305   232%     -    2s
     0     0 15029.1873    0  450 -11371.197 15029.1873   232%     -    2s
     0     0 9281.82344    0  674 -11371.197 9281.82344   182%     -    4s
H    0     0                    -11367.56064 9278.18305   182%     -    4s
H    0     0                    -11304.70428 9278.18305   182%     -    4s
H    0     0                    -11300.81135 9278.18305   182%     -    4s
     0     0 8913.55586    0  695 -11300.811 8913.55586   179%     -    4s
     0     0 8875.84045    0  686 -11300.811 8875.84045   179%     -    4s
     0     0 8861.96966    0  693 -11300.811 8861.96966   178%     -    4s
     0     0 8861.56405    0  699 -11300.811 8861.56405   178%     -    4s
     0     0 5674.75728    0  709 -11300.811 5674.75728   150%     -    7s
H    0     0                    -11276.70177 5670.30152   150%     -    7s
     0     0 5368.38848    0  639 -11276.702 5368.38848   148%     -    7s
     0     0 5286.02860    0  663 -11276.702 5286.02860   147%     -    8s
     0     0 5281.71604    0  663 -11276.702 5281.71604   147%     -    8s
     0     0 5281.52655    0  654 -11276.702 5281.52655   147%     -    8s
     0     0 3525.50598    0  367 -11276.702 3525.50598   131%     -   10s
H    0     0                    -11098.60349 3196.35813   129%     -   11s
H    0     0                    -11081.04708 3196.35813   129%     -   11s
H    0     0                    -11039.98965 3196.35813   129%     -   11s
     0     0 3196.35813    0  495 -11039.990 3196.35813   129%     -   11s
     0     0 3111.83789    0  516 -11039.990 3111.83789   128%     -   12s
     0     0 3094.81698    0  616 -11039.990 3094.81698   128%     -   12s
     0     0 3088.01490    0  517 -11039.990 3088.01490   128%     -   12s
     0     0 3086.82368    0  709 -11039.990 3086.82368   128%     -   12s
H    0     0                    -11030.41920 2265.41609   121%     -   14s
H    0     0                    -10904.18308 2265.41609   121%     -   14s
     0     0 2265.41609    0  746 -10904.183 2265.41609   121%     -   14s
H    0     0                    -10573.20845 2265.24886   121%     -   14s
H    0     0                    -10463.49258 2265.24886   122%     -   14s
H    0     0                    -10428.07522 2265.24886   122%     -   14s
     0     0 2005.48841    0  562 -10428.075 2005.48841   119%     -   15s
     0     0 1925.38373    0  592 -10428.075 1925.38373   118%     -   15s
     0     0 1871.91040    0  820 -10428.075 1871.91040   118%     -   16s
     0     0 1855.17076    0  844 -10428.075 1855.17076   118%     -   16s
     0     0 1853.70267    0  855 -10428.075 1853.70267   118%     -   16s
     0     0 1432.56860    0  576 -10428.075 1432.56860   114%     -   18s
H    0     0                    -10394.72360 1431.92546   114%     -   18s
     0     0 1320.82229    0  566 -10394.724 1320.82229   113%     -   19s
     0     0 1275.19523    0  582 -10394.724 1275.19523   112%     -   19s
     0     0 1271.44104    0  586 -10394.724 1271.44104   112%     -   19s
     0     0  959.00063    0  565 -10394.724  959.00063   109%     -   20s
H    0     0                    -10355.66703  958.57091   109%     -   20s
H    0     0                    -10283.09602  958.57091   109%     -   20s
H    0     0                    -10267.61667  958.57091   109%     -   20s
H    0     0                    -10236.19954  958.57091   109%     -   20s
H    0     0                    -10225.70034  958.57091   109%     -   20s
     0     0  908.72974    0  673 -10225.700  908.72974   109%     -   21s
     0     0  876.46049    0  589 -10225.700  876.46049   109%     -   21s
     0     0  871.39162    0  585 -10225.700  871.39162   109%     -   21s
     0     0  705.73313    0  833 -10225.700  705.73313   107%     -   22s
H    0     0                    -10218.21984  704.32708   107%     -   23s
H    0     0                    -10217.52514  704.32708   107%     -   23s
H    0     0                    -10214.80714  704.32708   107%     -   23s
     0     0  679.49371    0  478 -10214.807  679.49371   107%     -   23s
     0     0  670.57860    0  470 -10214.807  670.57860   107%     -   23s
     0     0  668.50611    0  474 -10214.807  668.50611   107%     -   23s
     0     0  606.51994    0  650 -10214.807  606.51994   106%     -   24s
     0     0  596.17879    0  745 -10214.807  596.17879   106%     -   24s
     0     0  584.41497    0  843 -10214.807  584.41497   106%     -   25s
     0     0  582.33665    0  745 -10214.807  582.33665   106%     -   25s
H    0     0                    -9682.443087  410.04600   104%     -   26s
H    0     0                    -9610.270015  410.04600   104%     -   26s
     0     0  410.04600    0  645 -9610.2700  410.04600   104%     -   26s
H    0     0                    -9597.684467  408.12281   104%     -   27s
H    0     0                    -9585.515837  408.12281   104%     -   27s
H    0     0                    -9517.873720  408.12281   104%     -   27s
     0     0  357.30204    0  646 -9517.8737  357.30204   104%     -   27s
     0     0  336.30612    0  654 -9517.8737  336.30612   104%     -   27s
     0     0  323.56493    0  655 -9517.8737  323.56493   103%     -   28s
     0     0  321.07023    0  660 -9517.8737  321.07023   103%     -   28s
     0     0  267.62010    0  499 -9517.8737  267.62010   103%     -   28s
     0     0  255.71829    0  493 -9517.8737  255.71829   103%     -   29s
     0     0  249.23977    0  488 -9517.8737  249.23977   103%     -   29s
     0     0  216.30549    0  499 -9517.8737  216.30549   102%     -   30s
     0     0  207.37541    0  667 -9517.8737  207.37541   102%     -   30s
     0     0  205.39665    0  677 -9517.8737  205.39665   102%     -   30s
     0     0  184.94253    0  488 -9517.8737  184.94253   102%     -   30s
     0     0  181.64046    0  488 -9517.8737  181.64046   102%     -   31s
H    0     0                    -9487.971031  179.39465   102%     -   33s
H    0     0                    -9483.788423  179.39465   102%     -   35s
H    0     0                    -9355.777090  179.39465   102%     -   35s
H    0     2                    -9075.583121  179.39465   102%     -   35s
     0     2  179.39465    0  488 -9075.5831  179.39465   102%     -   35s
    15    32 -401.04468    4  607 -9075.5831  -97.94823  98.9%  1441   40s
H   33    64                    -8949.794377 -350.87839  96.1%  1926   42s
H   51    64                    -8860.233681 -556.54634  93.7%  1615   42s
    63    94 -1516.4901    6  604 -8860.2337 -556.54634  93.7%  1493   45s
H  101   127                    -8828.805283 -556.54634  93.7%  1491   46s
H  113   127                    -8820.585349 -556.54634  93.7%  1447   46s
H  358   296                    -8812.050302 -1110.8324  87.4%   766   49s
H  389   296                    -8810.037417 -1110.8324  87.4%   757   49s
   392   345 -3091.2447   11  404 -8810.0374 -1110.8324  87.4%   764   50s
H  826   457                    -8677.420146 -1779.1915  79.5%   576   54s
   862   469     cutoff   16      -8677.4201 -2461.1280  71.6%   576   55s
H 1082   528                    -8250.704313 -2936.6561  64.4%   531   57s
H 1147   528                    -8245.901868 -2936.6561  64.4%   517   57s
  1388   573 -7135.8133   18  188 -8245.9019 -3072.4698  62.7%   488   60s
H 1410   573                    -8243.932194 -3072.4698  62.7%   486   60s
H 1459   573                    -8239.096925 -3072.4698  62.7%   478   60s
  2290   758     cutoff   25      -8239.0969 -4722.4814  42.7%   401   65s
  3641   627 -7614.9816   12  148 -8239.0969 -5780.5891  29.8%   355   70s
* 5194     0              26    -8235.680110 -7472.9549  9.26%   305   72s

Cutting planes:
  Learned: 3
  Gomory: 6
  MIR: 1980
  Flow cover: 1205
  RLT: 29
  Relax-and-lift: 429

Explored 5238 nodes (1644945 simplex iterations) in 72.69 seconds (172.30 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -8235.68 -8239.1 -8243.93 ... -8828.81
No other solutions better than -8235.68

Optimal solution found (tolerance 1.00e-04)
Best objective -8.235680109992e+03, best bound -8.235680109992e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 72.70s
  Master Objective (UB) = -8235.68, θ = 114112.23
  Upper Bound (UB) = -8235.68

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 114112.23
  [DEBUG]   ✓ Scenario 0: θ = 114112.23 ≤ Q = 114112.23 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 114112.23 ≤ Q = 114112.23 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x19cd19df
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xe632e621
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.191150e+13
Presolve removed 2590 rows and 1883 columns
Presolve time: 0.00s
Presolved: 503 rows, 506 columns, 1418 nonzeros
Found heuristic solution: objective 6100899.6449
Variable types: 342 continuous, 164 integer (164 binary)

Root relaxation: objective -1.241423e+05, 256 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -124142.31    0  130 6100899.64 -124142.31   102%     -    0s
H    0     0                    -89524.05755 -124142.31  38.7%     -    0s
H    0     0                    -90595.69261 -124142.31  37.0%     -    0s
H    0     0                    -100250.7479 -124142.31  23.8%     -    0s
H    0     0                    -109395.8319 -124142.31  13.5%     -    0s
H    0     0                    -114894.5620 -116622.92  1.50%     -    0s
     0     0 -116622.92    0   88 -114894.56 -116622.92  1.50%     -    0s
     0     0 -116386.69    0   87 -114894.56 -116386.69  1.30%     -    0s
     0     0 -115969.66    0   40 -114894.56 -115969.66  0.94%     -    0s
H    0     0                    -115743.8135 -115965.76  0.19%     -    0s
     0     0 -115903.90    0   24 -115743.81 -115903.90  0.14%     -    0s
     0     0 -115885.89    0   21 -115743.81 -115885.89  0.12%     -    0s
     0     0 -115874.70    0   22 -115743.81 -115874.70  0.11%     -    0s
H    0     0                    -115755.9962 -115874.70  0.10%     -    0s
     0     0 -115848.29    0   13 -115756.00 -115848.29  0.08%     -    0s
     0     0 -115835.09    0   11 -115756.00 -115835.09  0.07%     -    0s
H    0     0                    -115786.0803 -115835.09  0.04%     -    0s
     0     0 -115804.76    0    6 -115786.08 -115804.76  0.02%     -    0s
H    0     0                    -115798.2629 -115800.92  0.00%     -    0s

Cutting planes:
  Gomory: 3
  Implied bound: 2
  MIR: 3
  Flow cover: 5
  Relax-and-lift: 2

Explored 1 nodes (719 simplex iterations) in 0.09 seconds (0.04 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -115798 -115786 -115756 ... -89524.1

Optimal solution found (tolerance 1.00e-04)
Best objective -1.157982629448e+05, best bound -1.158009159459e+05, gap 0.0023%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 89173.37
  Scenario: 45 demand increases, 15 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -115798.26
  [DEBUG]   S×d_nominal = 204971.63
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 204971.63 + -115798.26 = 89173.37
  [DEBUG]   Current θ from Master = 114112.23
  [DEBUG]   ⚠️  Z_SP ≤ θ by 24938.86 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -33174.54
  Lower Bound (LB) = -13476.62
  Gap (UB-LB) = 5240.9359, Absolute Gap = 5240.9359, Relative Gap = 0.636370
  Not converged yet (gap = 5240.94 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 45 increases, 15 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135230 nonzeros
Model fingerprint: 0xafca7df5
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-03, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -33174.5 (0.01s)
Loaded MIP start from previous solve with objective -33174.5

Presolve removed 20624 rows and 8374 columns
Presolve time: 0.36s
Presolved: 26629 rows, 12606 columns, 163799 nonzeros
Variable types: 10347 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   29505    7.3309920e+03   0.000000e+00   1.084811e+05      5s
Concurrent spin time: 0.00s

Solved with dual simplex

Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   19055    8.5352064e+03   0.000000e+00   0.000000e+00      5s

Root relaxation: objective 8.535206e+03, 19055 iterations, 4.70 seconds (9.84 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 8535.20641    0  218 -33174.539 8535.20641   126%     -    5s
H    0     0                    -31257.65933 8535.20641   127%     -    5s
H    0     0                    -15103.90992 8535.20641   157%     -    5s
H    0     0                    -14514.80389 8535.20641   159%     -    5s
H    0     0                    -14356.77026 8535.20641   159%     -    5s
H    0     0                    -14350.64980 8535.20641   159%     -    5s
H    0     0                    -14022.66284 8535.20641   161%     -    5s
H    0     0                    -13939.55948 8535.20641   161%     -    5s
     0     0 4634.18860    0  417 -13939.559 4634.18860   133%     -    7s
     0     0 4521.14704    0  424 -13939.559 4521.14704   132%     -    8s
     0     0 4520.05334    0  422 -13939.559 4520.05334   132%     -    8s
     0     0 4519.94633    0  424 -13939.559 4519.94633   132%     -    8s
H    0     0                    -13938.06611 2089.09669   115%     -   12s
H    0     0                    -13936.89043 2089.09669   115%     -   12s
H    0     0                    -13932.14856 2089.09669   115%     -   12s
H    0     0                    -11563.48688 2089.09669   118%     -   12s
H    0     0                    -10781.87236 2089.09669   119%     -   12s
H    0     0                    -10781.46057 2089.09669   119%     -   12s
     0     0 2089.09669    0  454 -10781.461 2089.09669   119%     -   12s
H    0     0                    -10487.68657 2088.98909   120%     -   12s
H    0     0                    -10326.26909 2088.98909   120%     -   12s
     0     0 1538.52887    0  477 -10326.269 1538.52887   115%     -   13s
     0     0 1435.55756    0  469 -10326.269 1435.55756   114%     -   14s
     0     0 1415.02547    0  481 -10326.269 1415.02547   114%     -   14s
     0     0 1410.54693    0  481 -10326.269 1410.54693   114%     -   14s
     0     0 1410.50151    0  481 -10326.269 1410.50151   114%     -   14s
     0     0  236.45862    0  492 -10326.269  236.45862   102%     -   17s
H    0     0                    -10113.67727  235.94928   102%     -   18s
H    0     0                    -10031.15272  235.94928   102%     -   18s
H    0     0                    -9960.051826  235.94928   102%     -   18s
H    0     0                    -9955.835452  235.94928   102%     -   18s
H    0     0                    -9929.792930  235.94928   102%     -   18s
H    0     0                    -9928.074173  235.94928   102%     -   18s
     0     0   64.26282    0  500 -9928.0742   64.26282   101%     -   18s
     0     0  -51.34701    0  497 -9928.0742  -51.34701  99.5%     -   19s
     0     0 -104.01149    0  516 -9928.0742 -104.01149  99.0%     -   19s
     0     0 -111.42752    0  523 -9928.0742 -111.42752  98.9%     -   19s
     0     0 -113.63170    0  521 -9928.0742 -113.63170  98.9%     -   19s
H    0     0                    -9906.698095 -134.01831  98.6%     -   20s
H    0     0                    -9906.109920 -134.01831  98.6%     -   20s
     0     0 -134.01831    0  526 -9906.1099 -134.01831  98.6%     -   20s
     0     0 -134.22461    0  526 -9906.1099 -134.22461  98.6%     -   20s
H    0     0                    -9891.843271 -134.22461  98.6%     -   21s
     0     0 -814.34524    0  553 -9891.8433 -814.34524  91.8%     -   23s
     0     0 -986.35570    0  565 -9891.8433 -986.35570  90.0%     -   24s
     0     0 -1043.4217    0  559 -9891.8433 -1043.4217  89.5%     -   25s
     0     0 -1091.7481    0  560 -9891.8433 -1091.7481  89.0%     -   25s
     0     0 -1112.1907    0  567 -9891.8433 -1112.1907  88.8%     -   25s
     0     0 -1126.6452    0  576 -9891.8433 -1126.6452  88.6%     -   25s
     0     0 -1128.1525    0  577 -9891.8433 -1128.1525  88.6%     -   26s
     0     0 -1136.5366    0  580 -9891.8433 -1136.5366  88.5%     -   26s
     0     0 -1136.7377    0  578 -9891.8433 -1136.7377  88.5%     -   26s
     0     0 -1298.0106    0  570 -9891.8433 -1298.0106  86.9%     -   27s
H    0     0                    -9883.598118 -1298.8182  86.9%     -   27s
     0     0 -1327.3553    0  589 -9883.5981 -1327.3553  86.6%     -   27s
     0     0 -1334.2507    0  583 -9883.5981 -1334.2507  86.5%     -   28s
     0     0 -1338.2645    0  586 -9883.5981 -1338.2645  86.5%     -   28s
     0     0 -1338.4114    0  585 -9883.5981 -1338.4114  86.5%     -   28s
     0     0 -1426.1829    0  586 -9883.5981 -1426.1829  85.6%     -   29s
     0     0 -1440.6905    0  594 -9883.5981 -1440.6905  85.4%     -   29s
     0     0 -1450.5205    0  598 -9883.5981 -1450.5205  85.3%     -   29s
     0     0 -1453.1084    0  596 -9883.5981 -1453.1084  85.3%     -   30s
     0     0 -1454.1738    0  595 -9883.5981 -1454.1738  85.3%     -   30s
     0     0 -1534.9049    0  568 -9883.5981 -1534.9049  84.5%     -   31s
     0     0 -1547.3380    0  582 -9883.5981 -1547.3380  84.3%     -   31s
     0     0 -1556.4833    0  596 -9883.5981 -1556.4833  84.3%     -   31s
     0     0 -1557.9990    0  593 -9883.5981 -1557.9990  84.2%     -   31s
     0     0 -1560.1835    0  599 -9883.5981 -1560.1835  84.2%     -   32s
     0     0 -1561.3525    0  607 -9883.5981 -1561.3525  84.2%     -   32s
     0     0 -1601.9765    0  586 -9883.5981 -1601.9765  83.8%     -   32s
H    0     0                    -9882.435090 -1602.1197  83.8%     -   33s
H    0     0                    -9873.406531 -1602.1197  83.8%     -   33s
     0     0 -1608.0503    0  589 -9873.4065 -1608.0503  83.7%     -   33s
     0     0 -1612.9055    0  593 -9873.4065 -1612.9055  83.7%     -   33s
     0     0 -1613.7378    0  590 -9873.4065 -1613.7378  83.7%     -   33s
     0     0 -1628.2510    0  593 -9873.4065 -1628.2510  83.5%     -   34s
     0     0 -1633.3393    0  599 -9873.4065 -1633.3393  83.5%     -   34s
     0     0 -1636.0687    0  592 -9873.4065 -1636.0687  83.4%     -   34s
     0     0 -1636.9932    0  592 -9873.4065 -1636.9932  83.4%     -   34s
     0     0 -1640.4329    0  597 -9873.4065 -1640.4329  83.4%     -   35s
     0     0 -1641.9894    0  603 -9873.4065 -1641.9894  83.4%     -   35s
     0     0 -1642.3976    0  604 -9873.4065 -1642.3976  83.4%     -   35s
     0     0 -1649.3627    0  599 -9873.4065 -1649.3627  83.3%     -   36s
     0     0 -1651.5684    0  597 -9873.4065 -1651.5684  83.3%     -   36s
     0     0 -1652.4346    0  602 -9873.4065 -1652.4346  83.3%     -   36s
     0     0 -1654.3509    0  601 -9873.4065 -1654.3509  83.2%     -   37s
     0     0 -1654.5026    0  601 -9873.4065 -1654.5026  83.2%     -   37s
H    0     0                    -9840.131426 -1654.5144  83.2%     -   42s
H    0     0                    -9836.217772 -1654.5144  83.2%     -   42s
H    0     0                    -9833.730365 -1654.5144  83.2%     -   42s
H    0     0                    -9827.682725 -1654.5144  83.2%     -   42s
H    0     2                    -9823.559422 -1654.5144  83.2%     -   46s
     0     2 -1654.5144    0  601 -9823.5594 -1654.5144  83.2%     -   46s
    15    32 -2333.2658    4  592 -9823.5594 -2241.5752  77.2%  1918   52s
    95   175 -2758.4581    7  577 -9823.5594 -2580.9292  73.7%  1670   56s
H  278   266                    -9819.096814 -2580.9292  73.7%  1055   59s
H  283   266                    -9810.647072 -2580.9292  73.7%  1051   59s
   303   296 -3720.3578    9  476 -9810.6471 -2726.8454  72.2%  1043   62s
   364   338 -4040.9222   10  475 -9810.6471 -3207.4141  67.3%  1037   65s
   475   425 -4021.6323   11  541 -9810.6471 -3207.4141  67.3%  1057   70s
   565   480 -8064.2493   12  522 -9810.6471 -3207.4141  67.3%  1051   76s
   644   541 -4839.4257   13  523 -9810.6471 -3236.1892  67.0%  1065   80s
   796   604 -6452.4306   15  524 -9810.6471 -3236.1892  67.0%  1076   87s
   896   654 -6898.6198   16  502 -9810.6471 -3402.0065  65.3%  1088   91s
   948   674 -7470.5086   16  523 -9810.6471 -3418.0493  65.2%  1090   95s
  1057   724 -8087.0387   17  480 -9810.6471 -3613.0218  63.2%  1107  100s
  1163   761 -9666.4931   19  452 -9810.6471 -3613.0218  63.2%  1122  106s
  1271   825 -4462.7947    7  431 -9810.6471 -3613.0218  63.2%  1129  112s
  1340   847 -5271.5829    9  407 -9810.6471 -3667.3800  62.6%  1122  116s
  1426   868 -6295.5373   12  281 -9810.6471 -3680.6006  62.5%  1123  120s
  1512   901 -6649.0703   14  202 -9810.6471 -3772.8909  61.5%  1122  126s
  1696   937 -8571.2831   16   92 -9810.6471 -3772.8909  61.5%  1109  132s
  1824   944 infeasible   21      -9810.6471 -3772.8909  61.5%  1083  135s
  2080  1004 infeasible   17      -9810.6471 -3772.8909  61.5%  1062  142s
  2125  1020 -7300.6446   17  193 -9810.6471 -3772.8909  61.5%  1065  146s
  2177  1052 -7545.2264   18  193 -9810.6471 -4037.9052  58.8%  1071  150s
  2272  1078 -8563.3390   20  492 -9810.6471 -4037.9052  58.8%  1064  155s
  2426  1121 -9051.3425   22  317 -9810.6471 -4037.9052  58.8%  1056  161s
  2568  1146 infeasible   23      -9810.6471 -4309.9178  56.1%  1053  165s
  2711  1220 -7807.1054    9  383 -9810.6471 -4332.5635  55.8%  1053  170s
  2865  1261 -9206.1411   12  245 -9810.6471 -4359.6144  55.6%  1051  175s
  3041  1296 -7727.2764   15  456 -9810.6471 -4359.6144  55.6%  1049  180s
  3213  1317     cutoff   17      -9810.6471 -4359.6144  55.6%  1044  185s
  3399  1371     cutoff   20      -9810.6471 -4545.1781  53.7%  1038  190s
  3567  1396 -7802.7932    8  448 -9810.6471 -4667.8918  52.4%  1044  195s
  3748  1417     cutoff   11      -9810.6471 -4667.8918  52.4%  1046  201s
  3855  1470 -9365.2822   11  361 -9810.6471 -4780.8684  51.3%  1052  205s
  4009  1467 -6546.1436   12  331 -9810.6471 -4780.8684  51.3%  1058  211s
  4257  1498 -8554.7311   14  238 -9810.6471 -4780.8684  51.3%  1051  216s
  4471  1538 -8537.5234   11  377 -9810.6471 -4865.5857  50.4%  1053  222s
  4728  1551 -7391.7504   11  295 -9810.6471 -4865.5857  50.4%  1045  226s
  4838  1579     cutoff   13      -9810.6471 -5007.4868  49.0%  1046  233s
  4925  1605 infeasible   13      -9810.6471 -5007.4868  49.0%  1040  239s
  5087  1639 -8910.8801   12  289 -9810.6471 -5082.2491  48.2%  1034  245s
  5327  1682 -6969.1509   12  316 -9810.6471 -5082.2491  48.2%  1029  251s
  5609  1704     cutoff   15      -9810.6471 -5098.3265  48.0%  1022  257s
  5734  1750 -9115.3287   15  277 -9810.6471 -5098.3265  48.0%  1020  263s
  6047  1782 -8705.6016   12  271 -9810.6471 -5220.5577  46.8%  1015  271s
  6369  1798 -8884.0666   14  400 -9810.6471 -5418.1714  44.8%  1015  277s
  6713  1832 -6416.9448   14  427 -9810.6471 -5483.7285  44.1%  1015  284s
  7049  1847 -9456.3523   17  258 -9810.6471 -5614.3381  42.8%  1014  292s
  7438  1870 infeasible   12      -9810.6471 -5680.4201  42.1%  1011  300s
  7914  1888 -9751.5816   22  398 -9810.6471 -5878.3707  40.1%  1000  309s
  8271  1889     cutoff   11      -9810.6471 -5960.3220  39.2%   999  317s
  8741  1900     cutoff   15      -9810.6471 -6021.7298  38.6%   992  326s
  9264  1877     cutoff   14      -9810.6471 -6229.0074  36.5%   983  334s
  9615  1851     cutoff   14      -9810.6471 -6271.5116  36.1%   983  343s
 10168  1808 -8638.7569   16  356 -9810.6471 -6366.9804  35.1%   975  352s
 10630  1727     cutoff   20      -9810.6471 -6597.0280  32.8%   977  362s
 11156  1630     cutoff   17      -9810.6471 -6755.2832  31.1%   977  374s
 11674  1535     cutoff   18      -9810.6471 -6907.6679  29.6%   979  383s
 12257  1374     cutoff   19      -9810.6471 -7099.9659  27.6%   976  395s
 12887  1111 -8799.3234   15  296 -9810.6471 -7370.9801  24.9%   973  405s
 13642   770 -8871.4118   13  418 -9810.6471 -7705.3023  21.5%   963  417s
 14476   688 infeasible   23      -9810.6471 -8040.7128  18.0%   950  426s
 14690    91     cutoff   12      -9810.6471 -8040.7128  18.0%   949  435s

Cutting planes:
  Implied bound: 9
  MIR: 432
  Flow cover: 839
  RLT: 34
  Relax-and-lift: 71

Explored 15980 nodes (14428471 simplex iterations) in 436.20 seconds (1307.25 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -9810.65 -9819.1 -9823.56 ... -9883.6
No other solutions better than -9810.65

Optimal solution found (tolerance 1.00e-04)
Best objective -9.810647071833e+03, best bound -9.810647071833e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 436.24s
  Master Objective (UB) = -9810.65, θ = 112217.89
  Upper Bound (UB) = -9810.65

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 112217.89
  [DEBUG]   ✓ Scenario 0: θ = 112217.89 ≤ Q = 112217.89 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 112217.89 ≤ Q = 112217.89 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 112217.89 ≤ Q = 112217.89 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x4132314
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x04132314
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.182094e+13
Presolve removed 2589 rows and 1882 columns
Presolve time: 0.00s
Presolved: 504 rows, 507 columns, 1421 nonzeros
Found heuristic solution: objective 5917674.4511
Variable types: 343 continuous, 164 integer (164 binary)

Root relaxation: objective -1.276226e+05, 249 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -127622.62    0  129 5917674.45 -127622.62   102%     -    0s
H    0     0                    -94752.64942 -127622.62  34.7%     -    0s
H    0     0                    -95869.17770 -127622.62  33.1%     -    0s
H    0     0                    -103314.7164 -111448.02  7.87%     -    0s
H    0     0                    -105999.7395 -111448.02  5.14%     -    0s
     0     0 -111448.02    0   84 -105999.74 -111448.02  5.14%     -    0s
H    0     0                    -108873.0445 -111401.67  2.32%     -    0s
H    0     0                    -109225.5380 -111401.67  1.99%     -    0s
H    0     0                    -109995.5776 -111401.67  1.28%     -    0s
H    0     0                    -110348.0711 -111401.67  0.95%     -    0s
     0     0 -111351.17    0   84 -110348.07 -111351.17  0.91%     -    0s
     0     0 -111348.03    0   84 -110348.07 -111348.03  0.91%     -    0s
     0     0 -110711.91    0   32 -110348.07 -110711.91  0.33%     -    0s
     0     0 -110684.87    0   28 -110348.07 -110684.87  0.31%     -    0s
     0     0 -110684.80    0   27 -110348.07 -110684.80  0.31%     -    0s
H    0     0                    -110385.2828 -110654.21  0.24%     -    0s
     0     0 -110654.21    0   25 -110385.28 -110654.21  0.24%     -    0s
     0     0 -110654.21    0   24 -110385.28 -110654.21  0.24%     -    0s
     0     0 -110654.21    0   24 -110385.28 -110654.21  0.24%     -    0s
     0     0 -110529.58    0   21 -110385.28 -110529.58  0.13%     -    0s
     0     0 -110529.58    0   19 -110385.28 -110529.58  0.13%     -    0s
H    0     0                    -110426.4766 -110529.58  0.09%     -    0s
     0     0 -110460.58    0    6 -110426.48 -110460.58  0.03%     -    0s
H    0     0                    -110428.7463 -110459.56  0.03%     -    0s
H    0     0                    -110435.7096 -110459.56  0.02%     -    0s

Cutting planes:
  Implied bound: 6
  MIR: 5
  Flow cover: 13
  Relax-and-lift: 7

Explored 1 nodes (764 simplex iterations) in 0.06 seconds (0.04 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -110436 -110429 -110426 ... -95869.2

Optimal solution found (tolerance 1.00e-04)
Best objective -1.104357096297e+05, best bound -1.104401117243e+05, gap 0.0040%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 94137.53
  Scenario: 39 demand increases, 21 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -110435.71
  [DEBUG]   S×d_nominal = 204573.24
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 204573.24 + -110435.71 = 94137.53
  [DEBUG]   Current θ from Master = 112217.89
  [DEBUG]   ⚠️  Z_SP ≤ θ by 18080.36 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -27891.01
  Lower Bound (LB) = -13476.62
  Gap (UB-LB) = 3665.9689, Absolute Gap = 3665.9689, Relative Gap = 0.373672
  Not converged yet (gap = 3665.97 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 39 increases, 21 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178467 nonzeros
Model fingerprint: 0xe0baf325
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-03, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -27891 (0.06s)
MIP start from previous solve produced solution with objective -27891 (0.06s)
Loaded MIP start from previous solve with objective -27891

Presolve removed 27492 rows and 11162 columns
Presolve time: 0.46s
Presolved: 35051 rows, 16058 columns, 216579 nonzeros
Variable types: 13799 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 35051 rows, 16058 columns, 216579 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   43480   -3.8998157e+02   0.000000e+00   2.792188e+07      5s
Concurrent spin time: 0.68s

Solved with dual simplex

Root relaxation: objective 8.441390e+03, 29849 iterations, 9.01 seconds (19.98 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 8441.39020    0  226 -27891.008 8441.39020   130%     -    9s
H    0     0                    -13763.01688 8441.39020   161%     -    9s
H    0     0                    -10335.53051 8441.39020   182%     -   10s
H    0     0                    -9986.811983 8441.39020   185%     -   10s
H    0     0                    -9980.649174 8441.39020   185%     -   10s
H    0     0                    -9910.459531 8441.39020   185%     -   10s
H    0     0                    -9898.277492 8441.39020   185%     -   10s
H    0     0                    -9880.365635 8441.39020   185%     -   10s
     0     0 4484.61569    0  437 -9880.3656 4484.61569   145%     -   14s
     0     0 4381.69498    0  423 -9880.3656 4381.69498   144%     -   17s
     0     0 4381.69498    0  434 -9880.3656 4381.69498   144%     -   17s
     0     0 4381.69498    0  436 -9880.3656 4381.69498   144%     -   18s
     0     0 1803.63361    0  385 -9880.3656 1803.63361   118%     -   23s
     0     0 1174.51950    0  500 -9880.3656 1174.51950   112%     -   26s
     0     0 1094.25336    0  510 -9880.3656 1094.25336   111%     -   27s
     0     0 1022.47362    0  416 -9880.3656 1022.47362   110%     -   28s
     0     0 1016.53046    0  414 -9880.3656 1016.53046   110%     -   28s
     0     0 1011.74132    0  494 -9880.3656 1011.74132   110%     -   28s
     0     0 1010.36801    0  427 -9880.3656 1010.36801   110%     -   28s
     0     0 1009.80267    0  427 -9880.3656 1009.80267   110%     -   28s
     0     0  230.99289    0  443 -9880.3656  230.99289   102%     -   34s
     0     0  -88.08635    0  430 -9880.3656  -88.08635  99.1%     -   36s
     0     0 -240.85021    0  430 -9880.3656 -240.85021  97.6%     -   38s
     0     0 -342.50643    0  437 -9880.3656 -342.50643  96.5%     -   39s
     0     0 -359.26138    0  448 -9880.3656 -359.26138  96.4%     -   39s
     0     0 -371.74294    0  534 -9880.3656 -371.74294  96.2%     -   39s
     0     0 -374.17433    0  528 -9880.3656 -374.17433  96.2%     -   40s
     0     0 -381.20285    0  524 -9880.3656 -381.20285  96.1%     -   40s
     0     0 -381.76235    0  527 -9880.3656 -381.76235  96.1%     -   40s
     0     0 -738.34801    0  529 -9880.3656 -738.34801  92.5%     -   44s
     0     0 -911.31326    0  541 -9880.3656 -911.31326  90.8%     -   46s
     0     0 -979.56892    0  551 -9880.3656 -979.56892  90.1%     -   48s
     0     0 -1024.3684    0  565 -9880.3656 -1024.3684  89.6%     -   49s
     0     0 -1048.4886    0  566 -9880.3656 -1048.4886  89.4%     -   49s
     0     0 -1062.1111    0  576 -9880.3656 -1062.1111  89.3%     -   50s
     0     0 -1072.1046    0  579 -9880.3656 -1072.1046  89.1%     -   50s
     0     0 -1075.7928    0  579 -9880.3656 -1075.7928  89.1%     -   50s
     0     0 -1076.5269    0  579 -9880.3656 -1076.5269  89.1%     -   50s
     0     0 -1263.2887    0  580 -9880.3656 -1263.2887  87.2%     -   53s
     0     0 -1281.8455    0  582 -9880.3656 -1281.8455  87.0%     -   54s
     0     0 -1290.6013    0  586 -9880.3656 -1290.6013  86.9%     -   54s
     0     0 -1295.4688    0  584 -9880.3656 -1295.4688  86.9%     -   54s
     0     0 -1298.3135    0  579 -9880.3656 -1298.3135  86.9%     -   54s
     0     0 -1298.4183    0  581 -9880.3656 -1298.4183  86.9%     -   54s
     0     0 -1406.7951    0  578 -9880.3656 -1406.7951  85.8%     -   56s
     0     0 -1425.4255    0  590 -9880.3656 -1425.4255  85.6%     -   57s
     0     0 -1430.9018    0  586 -9880.3656 -1430.9018  85.5%     -   58s
     0     0 -1433.3718    0  586 -9880.3656 -1433.3718  85.5%     -   58s
     0     0 -1433.8435    0  599 -9880.3656 -1433.8435  85.5%     -   58s
     0     0 -1454.1969    0  584 -9880.3656 -1454.1969  85.3%     -   59s
     0     0 -1478.5909    0  595 -9880.3656 -1478.5909  85.0%     -   60s
     0     0 -1480.7350    0  587 -9880.3656 -1480.7350  85.0%     -   60s
     0     0 -1481.3401    0  589 -9880.3656 -1481.3401  85.0%     -   60s
     0     0 -1505.5081    0  586 -9880.3656 -1505.5081  84.8%     -   62s
     0     0 -1522.8599    0  580 -9880.3656 -1522.8599  84.6%     -   63s
     0     0 -1530.1444    0  582 -9880.3656 -1530.1444  84.5%     -   64s
     0     0 -1531.7362    0  579 -9880.3656 -1531.7362  84.5%     -   64s
     0     0 -1532.6281    0  585 -9880.3656 -1532.6281  84.5%     -   64s
     0     0 -1545.3078    0  502 -9880.3656 -1545.3078  84.4%     -   65s
     0     0 -1550.7972    0  588 -9880.3656 -1550.7972  84.3%     -   65s
     0     0 -1551.7840    0  512 -9880.3656 -1551.7840  84.3%     -   65s
     0     0 -1560.4660    0  589 -9880.3656 -1560.4660  84.2%     -   66s
     0     0 -1562.9904    0  584 -9880.3656 -1562.9904  84.2%     -   67s
     0     0 -1563.5161    0  589 -9880.3656 -1563.5161  84.2%     -   67s
     0     0 -1568.9359    0  513 -9880.3656 -1568.9359  84.1%     -   67s
     0     0 -1569.4343    0  590 -9880.3656 -1569.4343  84.1%     -   68s
     0     0 -1577.5121    0  602 -9880.3656 -1577.5121  84.0%     -   69s
     0     0 -1578.8768    0  528 -9880.3656 -1578.8768  84.0%     -   69s
     0     0 -1581.0825    0  598 -9880.3656 -1581.0825  84.0%     -   70s
     0     0 -1582.2909    0  606 -9880.3656 -1582.2909  84.0%     -   70s
     0     0 -1585.6506    0  606 -9880.3656 -1585.6506  84.0%     -   71s
     0     0 -1586.4946    0  606 -9880.3656 -1586.4946  83.9%     -   71s
     0     2 -1586.7005    0  606 -9880.3656 -1586.7005  83.9%     -   98s
     3     8 -1799.4268    2  549 -9880.3656 -1734.2963  82.4%  1815  102s
    15    32 -2664.8523    4  549 -9880.3656 -2092.3818  78.8%  2793  108s
    31    64 -2862.7243    5  557 -9880.3656 -2587.2809  73.8%  4483  111s
    63    96 -3199.4063    6  548 -9880.3656 -2836.8404  71.3%  3152  115s
   180   234 -3613.8712    9  599 -9880.3656 -2837.6213  71.3%  2104  122s
   254   283 -4067.5668   10  572 -9880.3656 -2862.7377  71.0%  1880  126s
   317   311 -5454.5600   10  569 -9880.3656 -2908.8282  70.6%  1841  130s
   388   367 -4968.1627   11  525 -9880.3656 -2998.2747  69.7%  1855  139s
   427   392 -5902.5148   12  435 -9880.3656 -2998.2747  69.7%  1871  142s
   468   413 -6227.5526   13  436 -9880.3656 -2998.2747  69.7%  1869  145s
   556   469 -8104.0553   16  412 -9880.3656 -3001.8288  69.6%  1881  152s
   597   489 -9048.0778   16  482 -9880.3656 -3091.6320  68.7%  1897  156s
   645   512 -8390.4907   17  476 -9880.3656 -3091.6320  68.7%  1970  162s
   683   547 -8859.2533   18  395 -9880.3656 -3091.6320  68.7%  1999  166s
   779   619     cutoff   21      -9880.3656 -3224.5834  67.4%  1967  173s
   840   653     cutoff   11      -9880.3656 -3259.2263  67.0%  1926  178s
   895   681 -5826.8716    9  589 -9880.3656 -3259.2263  67.0%  1920  182s
   959   704 -7337.5152   10  569 -9880.3656 -3259.2263  67.0%  1906  187s
  1023   737 -6924.4390   11  575 -9880.3656 -3299.5206  66.6%  1873  194s
  1096   779 -7519.8256   13  568 -9880.3656 -3299.5206  66.6%  1864  200s
  1174   818 -8707.4035   14  525 -9880.3656 -3463.6224  64.9%  1853  206s
  1280   848     cutoff   15      -9880.3656 -3463.6224  64.9%  1813  210s
  1366   865     cutoff   15      -9880.3656 -3510.7595  64.5%  1809  216s
  1423   891     cutoff   14      -9880.3656 -3594.7212  63.6%  1821  221s
  1505   922     cutoff   15      -9880.3656 -3599.6583  63.6%  1805  226s
  1633   947 -4435.1234   10  417 -9880.3656 -3643.9942  63.1%  1749  234s
  1759   979 -7077.9213   15  281 -9880.3656 -3643.9942  63.1%  1719  242s
  1880  1008 -8719.7791   18  366 -9880.3656 -3932.2520  60.2%  1698  249s
  2011  1054     cutoff   24      -9880.3656 -3953.2736  60.0%  1679  254s
  2122  1094 -9456.4012   13  204 -9880.3656 -3990.2266  59.6%  1676  262s
  2278  1123 -9257.2449   15  270 -9880.3656 -4002.2206  59.5%  1646  270s
  2463  1158 -4899.9388    8  339 -9880.3656 -4072.1314  58.8%  1607  276s
  2552  1233 -6290.5028   10  285 -9880.3656 -4072.1314  58.8%  1600  282s
  2717  1273 -7560.7960   14  267 -9880.3656 -4072.1314  58.8%  1568  290s
  2940  1307 -9566.7621   19  371 -9880.3656 -4398.9908  55.5%  1551  299s
  2984  1319 -9829.5274   20  333 -9880.3656 -4398.9908  55.5%  1555  304s
  3033  1329     cutoff   21      -9880.3656 -4398.9908  55.5%  1556  308s
  3109  1353 -8983.5508   11  222 -9880.3656 -4409.1689  55.4%  1549  314s
  3190  1375 -9544.2743   12  196 -9880.3656 -4409.1689  55.4%  1546  322s
  3297  1409 -6283.9039   13  374 -9880.3656 -4513.0634  54.3%  1547  330s
  3450  1411 -8670.9284   19  238 -9880.3656 -4513.0634  54.3%  1536  339s
  3603  1427 -9810.9626   23  319 -9880.3656 -4513.0634  54.3%  1527  349s
  3730  1475 -6914.8666   12  606 -9880.3656 -4698.9969  52.4%  1525  357s
  3910  1497 -7916.8850   14  593 -9880.3656 -4698.9969  52.4%  1527  365s
  4156  1525 -8968.1964   19  537 -9880.3656 -4702.5909  52.4%  1515  376s
  4405  1536 -9265.5129   21  514 -9880.3656 -4948.8708  49.9%  1513  389s
  4618  1546 -7302.2106   14  421 -9880.3656 -5073.9362  48.6%  1519  400s
  4860  1563 -9874.7238   18  483 -9880.3656 -5097.5797  48.4%  1520  410s
  5095  1633 -9716.0479   18  303 -9880.3656 -5306.0622  46.3%  1507  422s
  5359  1691 -9234.7723   12  390 -9880.3656 -5320.7777  46.1%  1506  435s
  5625  1726 -8723.8718   15  246 -9880.3656 -5369.7150  45.7%  1512  448s
  5903  1744 -8834.4900   12  348 -9880.3656 -5402.7027  45.3%  1520  461s
  6182  1751 -7503.2321   11  334 -9880.3656 -5621.0123  43.1%  1516  474s
  6459  1742     cutoff   15      -9880.3656 -5669.6824  42.6%  1509  487s
  6819  1729 -9439.7153   11  489 -9880.3656 -5803.9133  41.3%  1504  500s
  7206  1707     cutoff   11      -9880.3656 -5986.0818  39.4%  1499  514s
  7631  1707     cutoff   13      -9880.3656 -6154.1107  37.7%  1489  526s
  7932  1680 -9330.4866   19  371 -9880.3656 -6236.9623  36.9%  1487  542s
  8358  1644 -8753.7306   13  551 -9880.3656 -6403.4225  35.2%  1485  559s
  8775  1601 -8588.9275   16  317 -9880.3656 -6484.4737  34.4%  1482  575s
  9234  1538     cutoff   24      -9880.3656 -6610.5606  33.1%  1479  591s
  9629  1409     cutoff   13      -9880.3656 -6875.8202  30.4%  1477  611s
 10170  1200     cutoff   15      -9880.3656 -7103.4138  28.1%  1469  628s
 10746   941 -9819.3753   19  172 -9880.3656 -7338.2164  25.7%  1458  644s
 11496   613 -9347.0257   17  430 -9880.3656 -7789.6040  21.2%  1428  662s
 12432   145     cutoff   16      -9880.3656 -8266.7081  16.3%  1380  676s
 13456     0 infeasible   23      -9880.3656 -8770.4167  11.2%  1322  680s

Cutting planes:
  Learned: 2
  Gomory: 2
  Cover: 1
  Implied bound: 10
  MIR: 555
  Flow cover: 1213
  Zero half: 4
  RLT: 39
  Relax-and-lift: 75

Explored 13676 nodes (17981385 simplex iterations) in 680.59 seconds (2024.34 work units)
Thread count was 32 (of 256 available processors)

Solution count 8: -9880.37 -9898.28 -9910.46 ... -27891
No other solutions better than -9880.37

Optimal solution found (tolerance 1.00e-04)
Best objective -9.880365634987e+03, best bound -9.880365634987e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 680.62s
  Master Objective (UB) = -9880.37, θ = 112926.30
  Upper Bound (UB) = -9880.37

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 112926.30
  [DEBUG]   ✓ Scenario 0: θ = 112926.30 ≤ Q = 112926.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 112926.30 ≤ Q = 112926.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 112926.30 ≤ Q = 112926.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 112926.30 ≤ Q = 112926.30 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0xddb9b53
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xf22464ad
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.184101e+13
Presolve removed 2589 rows and 1882 columns
Presolve time: 0.00s
Presolved: 504 rows, 507 columns, 1421 nonzeros
Found heuristic solution: objective 5915446.6418
Variable types: 343 continuous, 164 integer (164 binary)

Root relaxation: objective -1.241332e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -124133.19    0  122 5915446.64 -124133.19   102%     -    0s
H    0     0                    -88968.82944 -124133.19  39.5%     -    0s
H    0     0                    -89897.84730 -124133.19  38.1%     -    0s
H    0     0                    -92244.49148 -124133.19  34.6%     -    0s
H    0     0                    -93309.77890 -104949.84  12.5%     -    0s
     0     0 -104949.84    0  119 -93309.779 -104949.84  12.5%     -    0s
H    0     0                    -103125.9504 -104940.26  1.76%     -    0s
H    0     0                    -103453.3695 -104940.26  1.44%     -    0s
     0     0 -104442.86    0   75 -103453.37 -104442.86  0.96%     -    0s
     0     0 -104403.23    0   76 -103453.37 -104403.23  0.92%     -    0s
H    0     0                    -103641.0619 -104403.17  0.74%     -    0s
H    0     0                    -103940.4484 -104403.17  0.45%     -    0s
     0     0 -104390.55    0   74 -103940.45 -104390.55  0.43%     -    0s
     0     0 -104157.25    0   21 -103940.45 -104157.25  0.21%     -    0s
     0     0 -104151.64    0   15 -103940.45 -104151.64  0.20%     -    0s
H    0     0                    -103982.8239 -104121.93  0.13%     -    0s
     0     0 -104116.30    0   24 -103982.82 -104116.30  0.13%     -    0s
     0     0 -104112.59    0   19 -103982.82 -104112.59  0.12%     -    0s
     0     0 -104085.61    0   13 -103982.82 -104085.61  0.10%     -    0s
     0     0 -104085.61    0   48 -103982.82 -104085.61  0.10%     -    0s
*    0     0               0    -104020.6366 -104020.64  0.00%     -    0s

Cutting planes:
  Gomory: 7
  Implied bound: 11
  MIR: 40
  Flow cover: 7
  RLT: 5

Explored 1 nodes (909 simplex iterations) in 0.10 seconds (0.05 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -104021 -103983 -103940 ... -89897.8
No other solutions better than -104021

Optimal solution found (tolerance 1.00e-04)
Best objective -1.040206366175e+05, best bound -1.040206366175e+05, gap 0.0000%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 101077.56
  Scenario: 37 demand increases, 23 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -104020.64
  [DEBUG]   S×d_nominal = 205098.20
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 205098.20 + -104020.64 = 101077.56
  [DEBUG]   Current θ from Master = 112926.30
  [DEBUG]   ⚠️  Z_SP ≤ θ by 11848.74 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -21729.10
  Lower Bound (LB) = -13476.62
  Gap (UB-LB) = 3596.2503, Absolute Gap = 3596.2503, Relative Gap = 0.363979
  Not converged yet (gap = 3596.25 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 37 increases, 23 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221704 nonzeros
Model fingerprint: 0x3d391e2d
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-03, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 34360 rows and 13950 columns
Presolve time: 0.57s
Presolved: 43473 rows, 19510 columns, 269359 nonzeros
Variable types: 17251 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -366196.7547
Found heuristic solution: objective -184823.6323

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 43473 rows, 19510 columns, 269359 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   30819   -8.9888685e+03   0.000000e+00   1.147473e+07      5s
Concurrent spin time: 0.75s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 8.408941e+03, 28026 iterations, 7.50 seconds (16.90 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 8408.94094    0  235 -184823.63 8408.94094   105%     -    8s
H    0     0                    -176569.7370 8408.94094   105%     -    8s
H    0     0                    -140183.0404 8408.94094   106%     -    8s
H    0     0                    -93689.06383 8408.94094   109%     -    8s
H    0     0                    -93685.28438 8408.94094   109%     -    8s
H    0     0                    -93583.08569 8408.94094   109%     -    8s
H    0     0                    -93564.56970 8408.94094   109%     -    8s
H    0     0                    -64414.54154 8408.94094   113%     -    8s
H    0     0                    -64411.75335 8408.94094   113%     -    8s
H    0     0                    -38249.39552 8408.94094   122%     -    8s
H    0     0                    -19525.30062 8408.94094   143%     -    8s
H    0     0                    -14974.77354 8408.94094   156%     -    8s
H    0     0                    -14802.92687 8408.94094   157%     -    9s
H    0     0                    -14642.77182 8408.94094   157%     -    9s
H    0     0                    -14620.86059 8408.94094   158%     -    9s
H    0     0                    -14219.29778 8408.94094   159%     -    9s
H    0     0                    -14213.66180 8408.94094   159%     -    9s
H    0     0                    -14208.98837 8408.94094   159%     -    9s
H    0     0                    -14200.30530 8408.94094   159%     -    9s
H    0     0                    -14189.86301 8408.94094   159%     -    9s
H    0     0                    -14154.86284 8408.94094   159%     -    9s
H    0     0                    -14096.38280 8408.94094   160%     -    9s
H    0     0                    -14087.32786 8408.94094   160%     -    9s
H    0     0                    -14062.70014 8408.94094   160%     -    9s
     0     0 4825.76825    0  440 -14062.700 4825.76825   134%     -   15s
     0     0 4309.32484    0  421 -14062.700 4309.32484   131%     -   17s
     0     0 4309.32484    0  431 -14062.700 4309.32484   131%     -   18s
     0     0 4309.32484    0  430 -14062.700 4309.32484   131%     -   19s
     0     0 4309.26466    0  430 -14062.700 4309.26466   131%     -   19s
     0     0 2081.92804    0  396 -14062.700 2081.92804   115%     -   25s
H    0     0                    -11005.57050 2081.92804   119%     -   25s
H    0     0                    -10912.65566 2081.92804   119%     -   25s
     0     0 1436.90080    0  487 -10912.656 1436.90080   113%     -   28s
     0     0 1324.45567    0  490 -10912.656 1324.45567   112%     -   30s
     0     0 1216.72990    0  493 -10912.656 1216.72990   111%     -   31s
     0     0 1188.16606    0  498 -10912.656 1188.16606   111%     -   32s
     0     0 1187.10628    0  499 -10912.656 1187.10628   111%     -   32s
     0     0 1186.13178    0  507 -10912.656 1186.13178   111%     -   32s
     0     0 1185.88520    0  508 -10912.656 1185.88520   111%     -   32s
H    0     0                    -10103.29711  202.74150   102%     -   41s
H    0     0                    -10003.88874  202.74150   102%     -   41s
H    0     0                    -10001.67804  202.74150   102%     -   41s
H    0     0                    -9992.042059  202.74150   102%     -   41s
     0     0  202.74150    0  446 -9992.0421  202.74150   102%     -   41s
     0     0 -125.51133    0  519 -9992.0421 -125.51133  98.7%     -   45s
     0     0 -327.65055    0  524 -9992.0421 -327.65055  96.7%     -   48s
     0     0 -422.12432    0  470 -9992.0421 -422.12432  95.8%     -   49s
     0     0 -458.53707    0  472 -9992.0421 -458.53707  95.4%     -   50s
     0     0 -468.62357    0  472 -9992.0421 -468.62357  95.3%     -   50s
     0     0 -472.60481    0  488 -9992.0421 -472.60481  95.3%     -   51s
     0     0 -473.79101    0  491 -9992.0421 -473.79101  95.3%     -   51s
     0     0 -474.05008    0  498 -9992.0421 -474.05008  95.3%     -   51s
     0     0 -875.20306    0  538 -9992.0421 -875.20306  91.2%     -   56s
     0     0 -987.98078    0  553 -9992.0421 -987.98078  90.1%     -   58s
     0     0 -1028.1542    0  541 -9992.0421 -1028.1542  89.7%     -   60s
     0     0 -1051.5850    0  538 -9992.0421 -1051.5850  89.5%     -   60s
     0     0 -1070.5224    0  550 -9992.0421 -1070.5224  89.3%     -   61s
     0     0 -1079.5020    0  549 -9992.0421 -1079.5020  89.2%     -   61s
     0     0 -1088.7802    0  551 -9992.0421 -1088.7802  89.1%     -   62s
     0     0 -1089.3808    0  558 -9992.0421 -1089.3808  89.1%     -   62s
     0     0 -1269.8931    0  490 -9992.0421 -1269.8931  87.3%     -   64s
     0     0 -1339.1485    0  493 -9992.0421 -1339.1485  86.6%     -   66s
     0     0 -1351.8964    0  498 -9992.0421 -1351.8964  86.5%     -   67s
     0     0 -1358.3024    0  505 -9992.0421 -1358.3024  86.4%     -   68s
     0     0 -1358.4280    0  507 -9992.0421 -1358.4280  86.4%     -   68s
     0     0 -1474.8206    0  490 -9992.0421 -1474.8206  85.2%     -   70s
     0     0 -1493.8267    0  568 -9992.0421 -1493.8267  85.0%     -   71s
     0     0 -1525.3919    0  559 -9992.0421 -1525.3919  84.7%     -   72s
     0     0 -1528.9268    0  610 -9992.0421 -1528.9268  84.7%     -   73s
     0     0 -1532.2583    0  562 -9992.0421 -1532.2583  84.7%     -   73s
     0     0 -1534.2093    0  571 -9992.0421 -1534.2093  84.6%     -   73s
     0     0 -1534.6886    0  574 -9992.0421 -1534.6886  84.6%     -   74s
     0     0 -1635.4897    0  548 -9992.0421 -1635.4897  83.6%     -   76s
     0     0 -1651.7772    0  565 -9992.0421 -1651.7772  83.5%     -   77s
     0     0 -1660.5902    0  559 -9992.0421 -1660.5902  83.4%     -   78s
     0     0 -1667.4447    0  569 -9992.0421 -1667.4447  83.3%     -   78s
     0     0 -1669.2367    0  581 -9992.0421 -1669.2367  83.3%     -   78s
     0     0 -1669.6004    0  577 -9992.0421 -1669.6004  83.3%     -   79s
     0     0 -1685.3476    0  579 -9992.0421 -1685.3476  83.1%     -   80s
     0     0 -1687.6387    0  583 -9992.0421 -1687.6387  83.1%     -   80s
     0     0 -1690.6277    0  585 -9992.0421 -1690.6277  83.1%     -   81s
     0     0 -1692.4898    0  585 -9992.0421 -1692.4898  83.1%     -   81s
     0     0 -1692.7560    0  586 -9992.0421 -1692.7560  83.1%     -   81s
     0     0 -1701.0870    0  581 -9992.0421 -1701.0870  83.0%     -   82s
     0     0 -1702.8110    0  569 -9992.0421 -1702.8110  83.0%     -   83s
     0     0 -1704.3146    0  587 -9992.0421 -1704.3146  82.9%     -   83s
     0     0 -1705.7318    0  592 -9992.0421 -1705.7318  82.9%     -   84s
     0     0 -1706.0850    0  591 -9992.0421 -1706.0850  82.9%     -   84s
     0     0 -1711.3381    0  583 -9992.0421 -1711.3381  82.9%     -   85s
     0     0 -1713.0631    0  588 -9992.0421 -1713.0631  82.9%     -   85s
     0     0 -1713.5006    0  587 -9992.0421 -1713.5006  82.9%     -   85s
     0     0 -1715.4379    0  574 -9992.0421 -1715.4379  82.8%     -   86s
     0     0 -1715.5884    0  580 -9992.0421 -1715.5884  82.8%     -   86s
     0     0 -1716.1539    0  585 -9992.0421 -1716.1539  82.8%     -   87s
     0     0 -1716.3898    0  585 -9992.0421 -1716.3898  82.8%     -   88s
     0     2 -1716.3898    0  585 -9992.0421 -1716.3898  82.8%     -  103s
     1     4 -1823.7805    1  553 -9992.0421 -1716.3898  82.8%  1577  105s
     7    16 -2154.9503    3  539 -9992.0421 -1948.0454  80.5%  2619  111s
    15    32 -2276.2203    4  538 -9992.0421 -2080.4152  79.2%  2804  115s
    31    64 -2839.0229    5  560 -9992.0421 -2107.9420  78.9%  3943  120s
    95   181 -3185.6029    7  555 -9992.0421 -2351.9701  76.5%  3770  130s
   262   335 -4005.4685   10  529 -9992.0421 -2351.9701  76.5%  2188  139s
   338   391 -4032.8456   11  529 -9992.0421 -2351.9701  76.5%  1991  144s
   421   420 -4373.0361   13  527 -9992.0421 -2512.2558  74.9%  1923  148s
   464   459 -4893.3504   13  361 -9992.0421 -2512.2558  74.9%  1871  152s
   514   495 -4405.5981   14  530 -9992.0421 -2512.2558  74.9%  1859  158s
   573   525 -4512.6172   16  453 -9992.0421 -2512.2558  74.9%  1807  163s
   631   562 -4778.9463   17  460 -9992.0421 -2805.0102  71.9%  1781  169s
   681   609 -5672.5345   18  462 -9992.0421 -2805.0102  71.9%  1811  175s
   738   637 -7791.3959   18  329 -9992.0421 -2805.0102  71.9%  1838  181s
   793   671 -5842.3523   19  514 -9992.0421 -2805.0102  71.9%  1860  187s
   851   699 -8051.4965   19  489 -9992.0421 -2937.0468  70.6%  1910  193s
   911   737 -8045.9453   20  512 -9992.0421 -3189.5097  68.1%  1932  199s
   967   778 -7507.4741   20  361 -9992.0421 -3189.5097  68.1%  1966  204s
  1026   806 -7570.0147   21  340 -9992.0421 -3201.2101  68.0%  1972  208s
  1080   829 -9408.1012   22  248 -9992.0421 -3258.4231  67.4%  1960  212s
  1119   862 -7797.2444   22  363 -9992.0421 -3258.4231  67.4%  1970  217s
  1182   892 -8869.1334   23  410 -9992.0421 -3344.2258  66.5%  1975  223s
  1228   933 -8306.5164   23  330 -9992.0421 -3344.2258  66.5%  1992  228s
  1299   979 -8504.0185   24  326 -9992.0421 -3344.2258  66.5%  2000  234s
  1369  1027 -8785.4895   25  320 -9992.0421 -3344.2258  66.5%  2007  240s
  1481  1084 -8994.3099   26  310 -9992.0421 -3344.2258  66.5%  1971  247s
  1603  1131 -9252.4169   27  366 -9992.0421 -3356.5830  66.4%  1920  253s
  1716  1154 infeasible   30      -9992.0421 -3485.9639  65.1%  1902  260s
  1761  1179 -9712.2389   31  370 -9992.0421 -3485.9639  65.1%  1913  269s
  1808  1202     cutoff   32      -9992.0421 -3485.9639  65.1%  1929  275s
  1863  1211 -9829.6424   33  376 -9992.0421 -3485.9639  65.1%  1928  282s
  1930  1236     cutoff   34      -9992.0421 -3485.9639  65.1%  1931  291s
  1991  1260 -5736.4966    8  379 -9992.0421 -3556.8416  64.4%  1941  298s
  2079  1291 -6134.9592    9  454 -9992.0421 -3657.3456  63.4%  1935  305s
  2158  1311 -6346.3438   10  460 -9992.0421 -3657.3456  63.4%  1921  313s
  2248  1352 -6608.7082   11  454 -9992.0421 -3701.9254  63.0%  1931  323s
  2347  1392 -6896.8635   12  496 -9992.0421 -3701.9254  63.0%  1947  332s
  2451  1416 -7303.1073   13  472 -9992.0421 -3701.9254  63.0%  1976  339s
  2504  1439 -7376.2085   14  487 -9992.0421 -3701.9254  63.0%  2033  349s
  2583  1502 -7451.1100   15  480 -9992.0421 -3701.9254  63.0%  2046  359s
  2715  1561 -7984.3581   18  470 -9992.0421 -3701.9254  63.0%  2042  370s
  2900  1628 -9855.4949   21  317 -9992.0421 -3701.9254  63.0%  2009  383s
  3102  1671 -8853.3316   22  391 -9992.0421 -3701.9254  63.0%  1977  394s
  3334  1694 -9739.4470   28  379 -9992.0421 -3780.8738  62.2%  1934  405s
  3441  1747 -9946.3852   30  371 -9992.0421 -3780.8738  62.2%  1936  417s
  3598  1777 -8477.7033   13  185 -9992.0421 -4119.0098  58.8%  1928  432s
  3777  1817 -9477.1390   14  396 -9992.0421 -4176.6771  58.2%  1931  445s
  3975  1874 infeasible   15      -9992.0421 -4178.8227  58.2%  1929  462s
  4194  1931     cutoff   15      -9992.0421 -4178.8227  58.2%  1920  479s
  4417  1981 -9616.8667   17  261 -9992.0421 -4406.6756  55.9%  1917  494s
  4628  2020 -8328.6056   14  335 -9992.0421 -4490.0259  55.1%  1921  509s
  4874  2032 -8468.5258   14  191 -9992.0421 -4524.6416  54.7%  1918  523s
  5072  2109     cutoff   20      -9992.0421 -4679.2788  53.2%  1911  538s
  5391  2204 -5563.1599   10  489 -9992.0421 -4730.3456  52.7%  1892  555s
  5786  2219 -9291.0330   13   99 -9992.0421 -4730.3456  52.7%  1852  574s
  6113  2267     cutoff   16      -9992.0421 -4883.3504  51.1%  1841  594s
  6412  2304 -7026.0487   15  483 -9992.0421 -4883.3504  51.1%  1847  612s
  6752  2376 -7326.2308   17  430 -9992.0421 -4883.3504  51.1%  1828  633s
  7120  2441 -9283.4201   19  274 -9992.0421 -5121.6491  48.7%  1817  653s
  7484  2493 -9626.8406   22  502 -9992.0421 -5121.6491  48.7%  1812  674s
  7894  2522 infeasible   25      -9992.0421 -5318.6789  46.8%  1803  694s
  8213  2558 -8700.8575   15  314 -9992.0421 -5339.4063  46.6%  1802  717s
  8743  2590     cutoff   12      -9992.0421 -5446.3041  45.5%  1778  738s
  9209  2630 -8688.2015   13  310 -9992.0421 -5467.0932  45.3%  1766  760s
  9675  2701 -7607.9921   15  410 -9992.0421 -5467.0932  45.3%  1752  787s
 10244  2757 -7706.8801    9  123 -9992.0421 -5623.4213  43.7%  1734  810s
 10784  2758 -8225.1989   16  585 -9992.0421 -5740.8097  42.5%  1726  875s
 10786  2759 -9502.9157   22  235 -9992.0421 -5740.8097  42.5%  1726  897s
 10787  2760 -7335.6033    8  403 -9992.0421 -5740.8097  42.5%  1726  908s
 10788  2761 -7470.4504   16  565 -9992.0421 -5740.8097  42.5%  1726  918s
 10789  2761 -7849.7930   13  515 -9992.0421 -5740.8097  42.5%  1726  924s
 10790  2762 -9904.2999   19  535 -9992.0421 -5740.8097  42.5%  1726  928s
 10791  2763 -5989.6141   13  598 -9992.0421 -5740.8097  42.5%  1725  933s
 10792  2763 -9266.2553   18  557 -9992.0421 -5740.8097  42.5%  1725  935s
 10794  2765 -7569.5881   10  560 -9992.0421 -5740.8097  42.5%  1725  940s
 10795  2765 -7487.2012   13  534 -9992.0421 -5740.8097  42.5%  1725  945s
 10799  2768 -9109.3648   12  559 -9992.0421 -5740.8097  42.5%  1724  952s
 10802  2770 -7198.7489   19  467 -9992.0421 -5740.8097  42.5%  1724  958s
 10804  2771 -7815.3759   11  545 -9992.0421 -5740.8097  42.5%  1723  960s
 10807  2773 -6102.8062   10  542 -9992.0421 -5740.8097  42.5%  1723  965s
 10809  2775 -8861.7716   20  555 -9992.0421 -5740.8097  42.5%  1722  971s
 10811  2776 -8659.2019   13  570 -9992.0421 -5740.8097  42.5%  1722  998s
 10812  2777 -8489.9458   21  570 -9992.0421 -5740.8097  42.5%  1722 1012s
 10813  2780 -5740.8097   10  556 -9992.0421 -5740.8097  42.5%  1735 1022s
 10815  2784 -5740.8097   11  559 -9992.0421 -5740.8097  42.5%  1736 1031s
 10819  2790 -5740.8097   12  532 -9992.0421 -5740.8097  42.5%  1737 1037s
 10827  2804 -5740.8097   13  537 -9992.0421 -5740.8097  42.5%  1740 1048s
 10843  2812 -5740.8097   14  445 -9992.0421 -5740.8097  42.5%  1751 1069s
 10859  2839 -7450.3247   15  352 -9992.0421 -5740.8097  42.5%  1772 1089s
 10891  2917 -8217.9987   16  291 -9992.0421 -5740.8097  42.5%  1776 1102s
 11006  2904 -9267.4814   19   81 -9992.0421 -5740.8097  42.5%  1787 1109s
 11041  2904 -9347.7862   20  114 -9992.0421 -5740.8097  42.5%  1791 1118s
 11094  2880     cutoff   21      -9992.0421 -5740.8097  42.5%  1797 1127s
 11161  2860 -8704.0669   19  454 -9992.0421 -5740.8097  42.5%  1801 1136s
 11221  2854     cutoff   20      -9992.0421 -5740.8097  42.5%  1812 1145s
 11266  2854     cutoff   21      -9992.0421 -5740.8097  42.5%  1821 1153s
 11313  2853 -9264.3231   23  303 -9992.0421 -5740.8097  42.5%  1830 1162s
 11373  2845 -6492.2569   15  484 -9992.0421 -5740.8097  42.5%  1839 1169s
 11439  2826 -7267.7285   15  471 -9992.0421 -5740.8097  42.5%  1846 1178s
 11508  2815 -7870.9469   16  446 -9992.0421 -5740.8097  42.5%  1852 1186s
 11565  2820 -8120.8749   18  366 -9992.0421 -5740.8097  42.5%  1862 1195s
 11617  2821     cutoff   20      -9992.0421 -5740.8097  42.5%  1874 1203s
 11676  2826 -9878.8178   19  371 -9992.0421 -5740.8097  42.5%  1884 1212s
 11747  2814     cutoff   20      -9992.0421 -5740.8097  42.5%  1892 1220s
 11820  2810 -9862.4726   17  534 -9992.0421 -5740.8097  42.5%  1902 1229s
 11892  2794     cutoff   17      -9992.0421 -5740.8097  42.5%  1916 1239s
 11984  2766 -9945.1824   18  538 -9992.0421 -5740.8097  42.5%  1917 1249s
 12073  2752 -8935.9117   18  157 -9992.0421 -5740.8097  42.5%  1921 1259s
 12160  2732 -7732.3764   17  454 -9992.0421 -5740.8097  42.5%  1927 1269s
 12258  2703 -8101.2947   19  476 -9992.0421 -5833.7772  41.6%  1929 1277s
 12311  2692     cutoff   20      -9992.0421 -5833.7772  41.6%  1935 1286s
 12388  2659 -9505.5402   18  448 -9992.0421 -5833.7772  41.6%  1945 1297s
 12492  2630 -8763.6640   17  483 -9992.0421 -6323.7709  36.7%  1953 1306s
 12567  2597     cutoff   19      -9992.0421 -6323.7709  36.7%  1963 1317s
 12683  2545 -9915.0506   19  532 -9992.0421 -6323.7709  36.7%  1973 1328s
 12806  2471 -9062.9914   17  547 -9992.0421 -6323.7709  36.7%  1976 1341s
 12946  2385     cutoff   17      -9992.0421 -6323.7709  36.7%  1980 1354s
 13104  2273 -8609.1888   20  415 -9992.0421 -6323.7709  36.7%  1980 1366s
 13311  2165 -9578.1845   23   90 -9992.0421 -6323.7709  36.7%  1975 1375s
 13395  2099     cutoff   24      -9992.0421 -7052.4898  29.4%  1974 1384s
 13496  1986 -9177.0042   18  221 -9992.0421 -7697.0556  23.0%  1970 1394s
 13627  1892     cutoff   19      -9992.0421 -7697.0556  23.0%  1961 1402s
 13734  1827 -8921.4854   18  301 -9992.0421 -8340.5657  16.5%  1955 1408s
 13819  1777     cutoff   19      -9992.0421 -8340.5657  16.5%  1947 1416s
 13853  1766     cutoff   27      -9992.0421 -9379.5835  6.13%  1945 1422s
 13856  1762 -9596.7887   25  404 -9992.0421 -9386.5151  6.06%  1945 1427s

Cutting planes:
  Gomory: 3
  MIR: 470
  Flow cover: 1333
  RLT: 28
  Relax-and-lift: 118

Explored 13872 nodes (27108581 simplex iterations) in 1427.40 seconds (3879.77 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -9992.04 -10001.7 -10103.3 ... -14189.9
No other solutions better than -9992.04

Optimal solution found (tolerance 1.00e-04)
Best objective -9.992042058653e+03, best bound -9.992042058653e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 1427.41s
  Master Objective (UB) = -9992.04, θ = 111505.20
  Upper Bound (UB) = -9992.04

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 111505.20
  [DEBUG]   ✓ Scenario 0: θ = 111505.20 ≤ Q = 111505.20 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 111505.20 ≤ Q = 111505.20 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 111505.20 ≤ Q = 111505.20 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 111505.20 ≤ Q = 111505.20 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 111505.20 ≤ Q = 111505.20 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x7d905be3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x7d905be3
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.179058e+13
Presolve removed 2589 rows and 1882 columns
Presolve time: 0.00s
Presolved: 504 rows, 507 columns, 1421 nonzeros
Found heuristic solution: objective 5862852.2848
Variable types: 343 continuous, 164 integer (164 binary)

Root relaxation: objective -1.249001e+05, 243 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -124900.14    0  123 5862852.28 -124900.14   102%     -    0s
H    0     0                    -89596.12518 -124900.14  39.4%     -    0s
H    0     0                    -90540.25853 -124900.14  37.9%     -    0s
H    0     0                    -91856.88803 -124900.14  36.0%     -    0s
H    0     0                    -93490.59567 -105816.41  13.2%     -    0s
H    0     0                    -94130.76883 -105816.41  12.4%     -    0s
     0     0 -105816.41    0   64 -94130.769 -105816.41  12.4%     -    0s
H    0     0                    -103740.0502 -105773.36  1.96%     -    0s
H    0     0                    -104083.7987 -105773.36  1.62%     -    0s
H    0     0                    -104131.7535 -105773.36  1.58%     -    0s
H    0     0                    -104475.5020 -105773.36  1.24%     -    0s
     0     0 -105175.95    0   46 -104475.50 -105175.95  0.67%     -    0s
H    0     0                    -104520.5135 -105146.66  0.60%     -    0s
     0     0 -105146.66    0   38 -104520.51 -105146.66  0.60%     -    0s
     0     0 -105127.36    0   39 -104520.51 -105127.36  0.58%     -    0s
     0     0 -104876.54    0   27 -104520.51 -104876.54  0.34%     -    0s
     0     0 -104843.20    0   30 -104520.51 -104843.20  0.31%     -    0s
     0     0 -104801.50    0   31 -104520.51 -104801.50  0.27%     -    0s
     0     0 -104801.47    0   31 -104520.51 -104801.47  0.27%     -    0s
     0     0 -104736.54    0   21 -104520.51 -104736.54  0.21%     -    0s
     0     0 -104718.70    0   22 -104520.51 -104718.70  0.19%     -    0s
     0     0 -104718.33    0   22 -104520.51 -104718.33  0.19%     -    0s
     0     0 -104676.94    0   16 -104520.51 -104676.94  0.15%     -    0s
     0     0 -104676.94    0   22 -104520.51 -104676.94  0.15%     -    0s
     0     0 -104555.78    0    3 -104520.51 -104555.78  0.03%     -    0s
H    0     0                    -104554.6198 -104554.62  0.00%     -    0s

Cutting planes:
  Gomory: 14
  Implied bound: 1
  MIR: 5
  Flow cover: 5
  RLT: 1
  Relax-and-lift: 4

Explored 1 nodes (822 simplex iterations) in 0.07 seconds (0.05 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -104555 -104521 -104476 ... 5.86285e+06
No other solutions better than -104555

Optimal solution found (tolerance 1.00e-04)
Best objective -1.045546198242e+05, best bound -1.045546198242e+05, gap 0.0000%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 99749.46
  Scenario: 31 demand increases, 29 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -104554.62
  [DEBUG]   S×d_nominal = 204304.08
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 204304.08 + -104554.62 = 99749.46
  [DEBUG]   Current θ from Master = 111505.20
  [DEBUG]   ⚠️  Z_SP ≤ θ by 11755.74 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -21747.78
  Lower Bound (LB) = -13476.62
  Gap (UB-LB) = 3484.5739, Absolute Gap = 3484.5739, Relative Gap = 0.348735
  Not converged yet (gap = 3484.57 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 31 increases, 29 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 264941 nonzeros
Model fingerprint: 0x52175746
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-03, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 41248 rows and 16748 columns
Presolve time: 0.69s
Presolved: 51875 rows, 22952 columns, 322079 nonzeros
Variable types: 20693 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -366196.7547
Found heuristic solution: objective -184823.6323

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 51875 rows, 22952 columns, 322079 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   28341   -1.7087373e+04   0.000000e+00   1.043742e+07      5s
   41493   -1.5402123e+03   0.000000e+00   1.060498e+07     10s
   52276    4.8648540e+03   0.000000e+00   2.122043e+07     15s
   61944    7.5804600e+03   0.000000e+00   2.667556e+05     20s
Concurrent spin time: 0.01s

Solved with dual simplex

Root relaxation: objective 8.327830e+03, 46271 iterations, 19.85 seconds (43.05 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 8327.82971    0  232 -184823.63 8327.82971   105%     -   21s
H    0     0                    -177052.2168 8327.82971   105%     -   21s
H    0     0                    -140876.5293 8327.82971   106%     -   21s
H    0     0                    -66701.54249 8327.82971   112%     -   21s
H    0     0                    -61832.57524 8327.82971   113%     -   21s
H    0     0                    -61691.02706 8327.82971   113%     -   21s
H    0     0                    -61620.85104 8327.82971   114%     -   21s
H    0     0                    -61334.32073 8327.82971   114%     -   21s
H    0     0                    -61320.40631 8327.82971   114%     -   21s
H    0     0                    -55880.91026 8327.82971   115%     -   21s
H    0     0                    -16382.34634 8327.82971   151%     -   21s
H    0     0                    -15111.41262 8327.82971   155%     -   21s
H    0     0                    -15048.13536 8327.82971   155%     -   21s
H    0     0                    -14873.46981 8327.82971   156%     -   21s
H    0     0                    -14779.13084 8327.82971   156%     -   21s
H    0     0                    -14716.88813 8327.82971   157%     -   21s
H    0     0                    -14694.89150 8327.82971   157%     -   21s
H    0     0                    -14683.44286 4268.52909   129%     -   34s
H    0     0                    -14621.83723 4268.52909   129%     -   34s
H    0     0                    -14616.32876 4268.52909   129%     -   34s
H    0     0                    -14612.87544 4268.52909   129%     -   34s
     0     0 4149.91702    0  413 -14612.875 4149.91702   128%     -   35s
     0     0 4149.91702    0  418 -14612.875 4149.91702   128%     -   36s
     0     0 4149.91702    0  420 -14612.875 4149.91702   128%     -   36s
     0     0 4149.91702    0  424 -14612.875 4149.91702   128%     -   37s
     0     0 4149.91702    0  430 -14612.875 4149.91702   128%     -   38s
     0     0 4149.91702    0  427 -14612.875 4149.91702   128%     -   38s
     0     0 4149.91702    0  427 -14612.875 4149.91702   128%     -   38s
H    0     0                    -14604.96396 1959.17418   113%     -   47s
H    0     0                    -14601.66015 1959.17418   113%     -   47s
H    0     0                    -14478.68873 1959.17418   114%     -   47s
H    0     0                    -14478.27695 1959.17418   114%     -   47s
H    0     0                    -14477.24427 1959.17418   114%     -   47s
H    0     0                    -14476.19741 1959.17418   114%     -   47s
     0     0 1931.82113    0  473 -14476.197 1931.82113   113%     -   47s
H    0     0                    -10621.58861 1931.82113   118%     -   47s
H    0     0                    -10554.58551 1931.82113   118%     -   48s
     0     0 1337.81507    0  481 -10554.586 1337.81507   113%     -   56s
H    0     0                    -10518.53873 1247.62952   112%     -   60s
H    0     0                    -10439.38785 1247.62952   112%     -   60s
H    0     0                    -10409.08684 1247.62952   112%     -   60s
H    0     0                    -10376.16617 1247.62952   112%     -   60s
     0     0 1247.62952    0  493 -10376.166 1247.62952   112%     -   60s
     0     0 1179.07805    0  494 -10376.166 1179.07805   111%     -   63s
     0     0 1173.21040    0  489 -10376.166 1173.21040   111%     -   64s
     0     0 1156.20067    0  496 -10376.166 1156.20067   111%     -   65s
     0     0 1132.00387    0  490 -10376.166 1132.00387   111%     -   66s
     0     0 1128.61320    0  499 -10376.166 1128.61320   111%     -   67s
     0     0 1128.45602    0  500 -10376.166 1128.45602   111%     -   67s
     0     0 -289.86460    0  521 -10376.166 -289.86460  97.2%     -   82s
     0     0 -498.55059    0  526 -10376.166 -498.55059  95.2%     -   86s
     0     0 -584.11611    0  530 -10376.166 -584.11611  94.4%     -   88s
     0     0 -669.79747    0  528 -10376.166 -669.79747  93.5%     -   89s
     0     0 -747.66759    0  468 -10376.166 -747.66759  92.8%     -   92s
H    0     0                    -10368.91590 -776.18149  92.5%     -   93s
H    0     0                    -10363.31626 -776.18149  92.5%     -   93s
H    0     0                    -10362.54453 -776.18149  92.5%     -   93s
     0     0 -776.18149    0  529 -10362.545 -776.18149  92.5%     -   93s
H    0     0                    -10302.55563 -786.71865  92.4%     -   94s
     0     0 -786.71865    0  482 -10302.556 -786.71865  92.4%     -   94s
     0     0 -793.47545    0  473 -10302.556 -793.47545  92.3%     -   95s
     0     0 -796.69795    0  535 -10302.556 -796.69795  92.3%     -   95s
     0     0 -796.76064    0  534 -10302.556 -796.76064  92.3%     -   95s
H    0     0                    -10301.96745 -1166.3753  88.7%     -  104s
     0     0 -1166.3753    0  550 -10301.967 -1166.3753  88.7%     -  104s
     0     0 -1336.0652    0  561 -10301.967 -1336.0652  87.0%     -  107s
     0     0 -1434.2306    0  480 -10301.967 -1434.2306  86.1%     -  108s
     0     0 -1482.8856    0  559 -10301.967 -1482.8856  85.6%     -  110s
     0     0 -1512.4091    0  560 -10301.967 -1512.4091  85.3%     -  111s
     0     0 -1524.2129    0  567 -10301.967 -1524.2129  85.2%     -  111s
     0     0 -1533.1569    0  573 -10301.967 -1533.1569  85.1%     -  112s
     0     0 -1538.5446    0  573 -10301.967 -1538.5446  85.1%     -  112s
     0     0 -1539.8422    0  584 -10301.967 -1539.8422  85.1%     -  113s
     0     0 -1540.1762    0  583 -10301.967 -1540.1762  85.0%     -  113s
     0     0 -1638.0414    0  570 -10301.967 -1638.0414  84.1%     -  115s
     0     0 -1651.8786    0  495 -10301.967 -1651.8786  84.0%     -  116s
     0     0 -1653.3099    0  582 -10301.967 -1653.3099  84.0%     -  117s
     0     0 -1653.9380    0  587 -10301.967 -1653.9380  83.9%     -  117s
     0     0 -1695.8446    0  564 -10301.967 -1695.8446  83.5%     -  119s
H    0     0                    -10299.88625 -1702.2871  83.5%     -  120s
     0     0 -1702.2871    0  575 -10299.886 -1702.2871  83.5%     -  120s
     0     0 -1707.2909    0  581 -10299.886 -1707.2909  83.4%     -  121s
     0     0 -1707.6231    0  581 -10299.886 -1707.6231  83.4%     -  121s
     0     0 -1735.2273    0  567 -10299.886 -1735.2273  83.2%     -  123s
     0     0 -1738.0765    0  574 -10299.886 -1738.0765  83.1%     -  123s
     0     0 -1740.8543    0  573 -10299.886 -1740.8543  83.1%     -  124s
     0     0 -1742.0270    0  575 -10299.886 -1742.0270  83.1%     -  124s
     0     0 -1756.1258    0  584 -10299.886 -1756.1258  83.0%     -  126s
     0     0 -1762.1981    0  579 -10299.886 -1762.1981  82.9%     -  127s
     0     0 -1762.7090    0  585 -10299.886 -1762.7090  82.9%     -  127s
     0     0 -1769.6107    0  574 -10299.886 -1769.6107  82.8%     -  128s
     0     0 -1783.7158    0  569 -10299.886 -1783.7158  82.7%     -  129s
     0     0 -1786.3650    0  573 -10299.886 -1786.3650  82.7%     -  130s
     0     0 -1787.5174    0  576 -10299.886 -1787.5174  82.6%     -  130s
     0     0 -1817.1400    0  569 -10299.886 -1817.1400  82.4%     -  131s
     0     0 -1823.1593    0  569 -10299.886 -1823.1593  82.3%     -  132s
     0     0 -1825.4969    0  582 -10299.886 -1825.4969  82.3%     -  132s
     0     0 -1826.2573    0  587 -10299.886 -1826.2573  82.3%     -  132s
     0     0 -1834.8679    0  576 -10299.886 -1834.8679  82.2%     -  134s
     0     0 -1837.1933    0  579 -10299.886 -1837.1933  82.2%     -  134s
     0     0 -1837.2289    0  582 -10299.886 -1837.2289  82.2%     -  134s
     0     0 -1840.3653    0  578 -10299.886 -1840.3653  82.1%     -  135s
     0     0 -1840.9964    0  581 -10299.886 -1840.9964  82.1%     -  136s
     0     0 -1843.6520    0  579 -10299.886 -1843.6520  82.1%     -  137s
     0     0 -1844.4568    0  588 -10299.886 -1844.4568  82.1%     -  137s
     0     0 -1846.3952    0  586 -10299.886 -1846.3952  82.1%     -  138s
     0     0 -1847.2899    0  586 -10299.886 -1847.2899  82.1%     -  139s
     0     2 -1848.9606    0  586 -10299.886 -1848.9606  82.0%     -  172s
     1     3 -2574.8139    1  467 -10299.886 -1848.9606  82.0%  3931  176s
     2     5 -3484.7026    2  365 -10299.886 -1848.9606  82.0%  4596  182s
     4    10 -3519.1765    3  436 -10299.886 -2294.9642  77.7%  3618  185s
    19    40 -4093.4716    5  452 -10299.886 -2447.2599  76.2%  4900  197s
    39    60 -7468.7455    6  170 -10299.886 -2681.2571  74.0%  4935  207s
    59    92 -4309.2600    6  368 -10299.886 -2681.2571  74.0%  6871  216s
    91   196 -4393.8537    7  356 -10299.886 -2681.2571  74.0%  6431  226s
   203   271 -5547.9827   10  328 -10299.886 -2681.2571  74.0%  3914  233s
   306   302 -6610.8904   12  207 -10299.886 -2681.2571  74.0%  3119  241s
   399   318 -6746.2701   13  209 -10299.886 -2681.2571  74.0%  2674  248s
   473   337 -8610.5219   15  199 -10299.886 -2681.2571  74.0%  2516  255s
   530   362 -8761.8944   16  203 -10299.886 -2681.2571  74.0%  2483  263s
   583   391 infeasible   17      -10299.886 -2681.2571  74.0%  2468  270s
   646   406     cutoff   19      -10299.886 -2681.2571  74.0%  2418  278s
   711   418     cutoff   18      -10299.886 -2703.4519  73.8%  2379  286s
   783   444 -3264.8922    6  526 -10299.886 -2703.4519  73.8%  2302  294s
   851   460 -3398.0050    7  474 -10299.886 -2703.4519  73.8%  2256  301s
   923   491 -3930.1649    8  423 -10299.886 -2703.4519  73.8%  2214  309s
   990   525 -5353.1015    9  431 -10299.886 -2703.4519  73.8%  2204  315s
  1054   552 -6004.7092   10  435 -10299.886 -2703.4519  73.8%  2219  322s
  1136   564 infeasible   12      -10299.886 -2703.4519  73.8%  2194  330s
  1182   583 -10081.384   13  386 -10299.886 -2703.4519  73.8%  2205  338s
  1227   608     cutoff   14      -10299.886 -2771.2808  73.1%  2221  346s
  1272   656     cutoff   13      -10299.886 -2771.7388  73.1%  2206  354s
  1374   697 -5394.2513    7  485 -10299.886 -3383.8340  67.1%  2137  363s
  1483   741 -5681.5493    8  403 -10299.886 -3383.8340  67.1%  2073  373s
  1579   781 -5839.1879    9  493 -10299.886 -3384.2895  67.1%  2047  382s
  1662   797 -5934.3768   10  404 -10299.886 -3384.2895  67.1%  2027  390s
  1734   824 -6162.5058   11  400 -10299.886 -3384.2895  67.1%  2036  399s
  1797   857 -6454.4155   14  245 -10299.886 -3384.2895  67.1%  2065  416s
  1895   917 -8452.5222   19  177 -10299.886 -3486.2220  66.2%  2059  427s
  2042   949 infeasible   30      -10299.886 -3486.2220  66.2%  2028  434s
  2100   973 -10056.228   30  107 -10299.886 -4104.8064  60.1%  2032  444s
  2260  1000 -6052.1665    8  339 -10299.886 -4104.8064  60.1%  1983  457s
  2371  1025 -7697.1901   10   99 -10299.886 -4104.8064  60.1%  1991  467s
  2454  1044     cutoff   12      -10299.886 -4104.8064  60.1%  2020  477s
  2527  1063 -9253.0722   14   75 -10299.886 -4104.8064  60.1%  2032  490s
  2671  1076 -6820.2575    9  391 -10299.886 -4104.8064  60.1%  2015  501s
  2746  1114 -7590.0292   11  322 -10299.886 -4317.4448  58.1%  2027  515s
  2866  1132 -8945.4283   14  194 -10299.886 -4547.9730  55.8%  2044  528s
  3014  1170     cutoff   16      -10299.886 -4547.9730  55.8%  2057  542s
  3152  1187 -7539.3612    7  247 -10299.886 -4547.9730  55.8%  2067  557s
  3309  1205     cutoff    9      -10299.886 -4547.9730  55.8%  2078  573s
  3423  1245 -8802.9778    7  301 -10299.886 -5285.9032  48.7%  2080  589s
  3594  1264     cutoff   10      -10299.886 -5285.9032  48.7%  2076  602s
  3765  1276     cutoff   16      -10299.886 -5479.9689  46.8%  2086  622s
  3925  1281 -7083.6724   10  454 -10299.886 -5555.5472  46.1%  2097  639s
  3982  1295 -9929.0297   11  297 -10299.886 -5670.9980  44.9%  2107  660s
H 4033  1295                    -10073.57910 -5766.6789  42.8%  2114  660s
  4048  1319     cutoff   12      -10073.579 -5766.6789  42.8%  2117  680s
  4280  1372     cutoff   14      -10073.579 -5779.9604  42.6%  2104  698s
  4473  1385     cutoff    9      -10073.579 -5947.9393  41.0%  2119  717s
  4674  1410     cutoff   12      -10073.579 -5955.5114  40.9%  2113  737s
  4932  1383 -7643.7264    9  241 -10073.579 -6012.5985  40.3%  2102  757s
  5155  1408     cutoff   12      -10073.579 -6197.2480  38.5%  2118  778s
  5364  1422     cutoff   12      -10073.579 -6247.4617  38.0%  2143  799s
  5605  1424     cutoff   14      -10073.579 -6453.7659  35.9%  2159  822s
  5914  1421     cutoff   17      -10073.579 -6580.6889  34.7%  2151  843s
  6134  1410     cutoff   15      -10073.579 -6614.1986  34.3%  2155  864s
  6439  1410 infeasible   11      -10073.579 -6614.1986  34.3%  2152  888s
  6794  1378     cutoff   14      -10073.579 -6934.4980  31.2%  2146  922s
  7238  1356 -9496.2412   13  398 -10073.579 -7041.9106  30.1%  2117  945s
  7640  1318 -9138.4065   21  276 -10073.579 -7265.8573  27.9%  2092  973s
  8229  1132 infeasible   12      -10073.579 -7478.6001  25.8%  2039  999s
  8855  1011 infeasible   21      -10073.579 -7851.0664  22.1%  1989 1024s
H 9231  1011                    -10067.22144 -8046.6796  20.1%  1957 1024s
  9350   742 -9725.6761   23  110 -10067.221 -8084.9044  19.7%  1951 1049s
 10211   196 infeasible   20      -10067.221 -8472.4326  15.8%  1871 1073s
 11441     0 -9807.9481   24  247 -10067.221 -9166.0588  8.95%  1742 1079s
*11518     0              34    -10066.79160 -9166.0588  8.95%  1733 1079s

Cutting planes:
  Learned: 1
  Gomory: 9
  Cover: 2
  Implied bound: 61
  MIR: 813
  Flow cover: 1488
  RLT: 35
  Relax-and-lift: 83

Explored 11768 nodes (20276109 simplex iterations) in 1079.81 seconds (2841.94 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -10066.8 -10067.2 -10073.6 ... -10376.2
No other solutions better than -10066.8

Optimal solution found (tolerance 1.00e-04)
Best objective -1.006679159827e+04, best bound -1.006679159827e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 1079.85s
  Master Objective (UB) = -10066.79, θ = 110942.67
  Upper Bound (UB) = -10066.79

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 110942.67
  [DEBUG]   ✓ Scenario 0: θ = 110942.67 ≤ Q = 110942.67 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 110942.67 ≤ Q = 110942.67 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 110942.67 ≤ Q = 110942.67 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 110942.67 ≤ Q = 110942.67 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 110942.67 ≤ Q = 110942.67 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 110942.67 ≤ Q = 110942.67 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x68f74811
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x68f74811
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.174012e+13
Presolve removed 2598 rows and 1891 columns
Presolve time: 0.00s
Presolved: 495 rows, 498 columns, 1396 nonzeros
Found heuristic solution: objective 5849975.5555
Variable types: 335 continuous, 163 integer (163 binary)
Found heuristic solution: objective 5849641.8975

Root relaxation: objective -1.263743e+05, 231 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -126374.28    0  121 5849641.90 -126374.28   102%     -    0s
H    0     0                    -97197.74515 -126374.28  30.0%     -    0s
H    0     0                    -97321.12831 -126240.19  29.7%     -    0s
     0     0 -110216.30    0   78 -97321.128 -110216.30  13.3%     -    0s
H    0     0                    -108986.9557 -110158.62  1.08%     -    0s
H    0     0                    -109287.9894 -110158.62  0.80%     -    0s
     0     0 -109852.57    0   71 -109287.99 -109852.57  0.52%     -    0s
     0     0 -109773.74    0   52 -109287.99 -109773.74  0.44%     -    0s
     0     0 -109739.43    0   53 -109287.99 -109739.43  0.41%     -    0s
     0     0 -109739.10    0   53 -109287.99 -109739.10  0.41%     -    0s
     0     0 -109491.41    0   43 -109287.99 -109491.41  0.19%     -    0s
     0     0 -109485.64    0   22 -109287.99 -109485.64  0.18%     -    0s
     0     0 -109450.09    0   17 -109287.99 -109450.09  0.15%     -    0s
     0     0 -109438.70    0   13 -109287.99 -109438.70  0.14%     -    0s
     0     0 -109412.33    0   12 -109287.99 -109412.33  0.11%     -    0s
     0     0 -109410.93    0   13 -109287.99 -109410.93  0.11%     -    0s
     0     0 -109313.43    0    4 -109287.99 -109313.43  0.02%     -    0s
     0     0 -109313.41    0    4 -109287.99 -109313.41  0.02%     -    0s
H    0     0                    -109313.2877 -109313.29  0.00%     -    0s
     0     0 -109313.29    0    4 -109313.29 -109313.29  0.00%     -    0s

Cutting planes:
  Gomory: 4
  Implied bound: 5
  MIR: 2
  Flow cover: 7
  Relax-and-lift: 1

Explored 1 nodes (742 simplex iterations) in 0.08 seconds (0.04 work units)
Thread count was 32 (of 256 available processors)

Solution count 9: -109313 -109288 -106510 ... 1.17401e+13
No other solutions better than -109313

Optimal solution found (tolerance 1.00e-04)
Best objective -1.093132876606e+05, best bound -1.093132876606e+05, gap 0.0000%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 95539.25
  Scenario: 40 demand increases, 20 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -109313.29
  [DEBUG]   S×d_nominal = 204852.53
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 204852.53 + -109313.29 = 95539.25
  [DEBUG]   Current θ from Master = 110942.67
  [DEBUG]   ⚠️  Z_SP ≤ θ by 15403.42 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -25470.21
  Lower Bound (LB) = -13476.62
  Gap (UB-LB) = 3409.8244, Absolute Gap = 3409.8244, Relative Gap = 0.338720
  Not converged yet (gap = 3409.82 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 40 increases, 20 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308178 nonzeros
Model fingerprint: 0xee8e2d88
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-03, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 48116 rows and 19536 columns
Presolve time: 0.79s
Presolved: 60297 rows, 26404 columns, 374859 nonzeros
Variable types: 24145 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -366196.7547
Found heuristic solution: objective -184823.6323

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 60297 rows, 26404 columns, 374859 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   32383   -3.4942573e+04   0.000000e+00   1.174205e+07      5s
   44718   -9.6287309e+03   0.000000e+00   7.962379e+05     10s
   53390   -3.9774698e+03   0.000000e+00   4.065781e+06     15s
Concurrent spin time: 0.76s

Solved with dual simplex

Root relaxation: objective 8.327830e+03, 45237 iterations, 16.56 seconds (37.72 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 8327.82971    0  232 -184823.63 8327.82971   105%     -   17s
H    0     0                    -178963.6501 8327.82971   105%     -   17s
H    0     0                    -121400.2558 8327.82971   107%     -   18s
H    0     0                    -104612.8811 8327.82971   108%     -   18s
H    0     0                    -83196.72118 8327.82971   110%     -   18s
H    0     0                    -83137.62962 8327.82971   110%     -   18s
H    0     0                    -82973.49620 8327.82971   110%     -   18s
H    0     0                    -76107.71086 8327.82971   111%     -   18s
H    0     0                    -14880.11870 8327.82971   156%     -   18s
H    0     0                    -14757.54286 8327.82971   156%     -   18s
H    0     0                    -14698.71276 8327.82971   157%     -   18s
H    0     0                    -14629.36902 8327.82971   157%     -   18s
H    0     0                    -14627.55318 8327.82971   157%     -   18s
H    0     0                    -14601.31939 8327.82971   157%     -   18s
H    0     0                    -14561.20934 4362.77798   130%     -   35s
     0     0 4139.14698    0  437 -14561.209 4139.14698   128%     -   35s
     0     0 4139.14698    0  423 -14561.209 4139.14698   128%     -   38s
     0     0 4139.14698    0  421 -14561.209 4139.14698   128%     -   38s
     0     0 4139.14698    0  420 -14561.209 4139.14698   128%     -   38s
     0     0 4139.14698    0  419 -14561.209 4139.14698   128%     -   39s
     0     0 4139.14698    0  431 -14561.209 4139.14698   128%     -   39s
     0     0 4139.14698    0  432 -14561.209 4139.14698   128%     -   39s
     0     0 4139.14698    0  433 -14561.209 4139.14698   128%     -   39s
H    0     0                    -14561.05519 2210.80563   115%     -   52s
H    0     0                    -14498.91450 2210.80563   115%     -   52s
H    0     0                    -14498.55755 2210.80563   115%     -   52s
     0     0 2210.80563    0  423 -14498.558 2210.80563   115%     -   53s
H    0     0                    -14473.54276 2210.38676   115%     -   53s
     0     0 1497.95721    0  485 -14473.543 1497.95721   110%     -   58s
     0     0 1352.33263    0  485 -14473.543 1352.33263   109%     -   61s
     0     0 1317.38475    0  485 -14473.543 1317.38475   109%     -   63s
     0     0 1291.36318    0  485 -14473.543 1291.36318   109%     -   64s
     0     0 1278.77314    0  489 -14473.543 1278.77314   109%     -   65s
     0     0 1273.41977    0  489 -14473.543 1273.41977   109%     -   66s
     0     0 1273.30798    0  491 -14473.543 1273.30798   109%     -   66s
H    0     0                    -10480.24433 1273.30798   112%     -   69s
H    0     0                    -10459.36748 1273.30798   112%     -   69s
H    0     0                    -10408.03927 1273.30798   112%     -   69s
H    0     0                    -10407.58522 1273.30798   112%     -   69s
     0     0  315.59854    0  450 -10407.585  315.59854   103%     -   78s
     0     0  -22.36593    0  448 -10407.585  -22.36593   100%     -   83s
H    0     0                    -10392.75302 -259.52196  97.5%     -   88s
H    0     0                    -10374.71831 -259.52196  97.5%     -   88s
H    0     0                    -10366.18326 -259.52196  97.5%     -   88s
     0     0 -259.52196    0  430 -10366.183 -259.52196  97.5%     -   88s
     0     0 -357.65106    0  452 -10366.183 -357.65106  96.5%     -   91s
     0     0 -400.55021    0  464 -10366.183 -400.55021  96.1%     -   94s
     0     0 -426.71441    0  522 -10366.183 -426.71441  95.9%     -   95s
     0     0 -452.38886    0  530 -10366.183 -452.38886  95.6%     -   97s
     0     0 -469.36004    0  443 -10366.183 -469.36004  95.5%     -   98s
     0     0 -474.02388    0  454 -10366.183 -474.02388  95.4%     -   99s
     0     0 -486.12554    0  453 -10366.183 -486.12554  95.3%     -   99s
     0     0 -490.15778    0  459 -10366.183 -490.15778  95.3%     -  100s
     0     0 -491.31729    0  453 -10366.183 -491.31729  95.3%     -  100s
     0     0 -491.67617    0  452 -10366.183 -491.67617  95.3%     -  100s
H    0     0                    -10342.22580 -491.67617  95.2%     -  103s
     0     0 -1036.2149    0  523 -10342.226 -1036.2149  90.0%     -  111s
     0     0 -1118.1888    0  469 -10342.226 -1118.1888  89.2%     -  114s
     0     0 -1238.6976    0  479 -10342.226 -1238.6976  88.0%     -  117s
     0     0 -1271.1904    0  540 -10342.226 -1271.1904  87.7%     -  119s
     0     0 -1290.8920    0  543 -10342.226 -1290.8920  87.5%     -  120s
     0     0 -1307.6503    0  528 -10342.226 -1307.6503  87.4%     -  121s
     0     0 -1311.3812    0  526 -10342.226 -1311.3812  87.3%     -  121s
     0     0 -1312.5370    0  529 -10342.226 -1312.5370  87.3%     -  121s
     0     0 -1436.7430    0  552 -10342.226 -1436.7430  86.1%     -  126s
     0     0 -1485.2704    0  561 -10342.226 -1485.2704  85.6%     -  128s
     0     0 -1495.8254    0  567 -10342.226 -1495.8254  85.5%     -  128s
     0     0 -1516.3576    0  561 -10342.226 -1516.3576  85.3%     -  130s
     0     0 -1579.1262    0  567 -10342.226 -1579.1262  84.7%     -  131s
     0     0 -1582.9865    0  572 -10342.226 -1582.9865  84.7%     -  132s
     0     0 -1584.0749    0  574 -10342.226 -1584.0749  84.7%     -  132s
     0     0 -1663.7316    0  539 -10342.226 -1663.7316  83.9%     -  136s
     0     0 -1670.5293    0  542 -10342.226 -1670.5293  83.8%     -  137s
     0     0 -1680.3070    0  551 -10342.226 -1680.3070  83.8%     -  138s
     0     0 -1682.0313    0  547 -10342.226 -1682.0313  83.7%     -  138s
     0     0 -1682.1924    0  554 -10342.226 -1682.1924  83.7%     -  138s
     0     0 -1738.6553    0  542 -10342.226 -1738.6553  83.2%     -  141s
     0     0 -1748.3733    0  573 -10342.226 -1748.3733  83.1%     -  142s
     0     0 -1752.8427    0  568 -10342.226 -1752.8427  83.1%     -  142s
     0     0 -1755.2276    0  572 -10342.226 -1755.2276  83.0%     -  143s
     0     0 -1755.5738    0  571 -10342.226 -1755.5738  83.0%     -  143s
     0     0 -1837.5182    0  536 -10342.226 -1837.5182  82.2%     -  147s
     0     0 -1849.2515    0  552 -10342.226 -1849.2515  82.1%     -  148s
     0     0 -1850.0487    0  551 -10342.226 -1850.0487  82.1%     -  148s
     0     0 -1864.5565    0  538 -10342.226 -1864.5565  82.0%     -  150s
     0     0 -1866.3137    0  548 -10342.226 -1866.3137  82.0%     -  151s
     0     0 -1868.2896    0  554 -10342.226 -1868.2896  81.9%     -  151s
     0     0 -1869.2133    0  543 -10342.226 -1869.2133  81.9%     -  152s
     0     0 -1878.0359    0  552 -10342.226 -1878.0359  81.8%     -  153s
     0     0 -1883.5160    0  562 -10342.226 -1883.5160  81.8%     -  155s
     0     0 -1885.3517    0  565 -10342.226 -1885.3517  81.8%     -  155s
     0     0 -1885.4683    0  567 -10342.226 -1885.4683  81.8%     -  155s
     0     0 -1891.7300    0  557 -10342.226 -1891.7300  81.7%     -  157s
     0     0 -1893.3412    0  560 -10342.226 -1893.3412  81.7%     -  158s
     0     0 -1894.1895    0  562 -10342.226 -1894.1895  81.7%     -  158s
     0     0 -1900.6702    0  550 -10342.226 -1900.6702  81.6%     -  160s
     0     0 -1901.2038    0  559 -10342.226 -1901.2038  81.6%     -  160s
     0     0 -1902.4245    0  561 -10342.226 -1902.4245  81.6%     -  161s
     0     0 -1903.3322    0  555 -10342.226 -1903.3322  81.6%     -  162s
     0     0 -1906.5676    0  552 -10342.226 -1906.5676  81.6%     -  163s
     0     0 -1907.0075    0  552 -10342.226 -1907.0075  81.6%     -  165s
H    0     0                    -10311.94431 -1907.0322  81.5%     -  203s
     0     2 -1907.0322    0  552 -10311.944 -1907.0322  81.5%     -  206s
     1     4 -2069.9390    1  558 -10311.944 -1908.2985  81.5%  4052  213s
     3     8 -2644.8661    2  546 -10311.944 -2071.0024  79.9%  7965  220s
     7    16 -2850.2381    3  540 -10311.944 -2654.0782  74.3%  8500  226s
    15    32 -3083.2031    4  553 -10311.944 -2850.5953  72.4%  6799  232s
H   31    51                    -10307.42478 -3082.6664  70.1%  6094  246s
    50    83 -3638.8258    6  474 -10307.425 -3082.8835  70.1%  8122  251s
    82   216 -3677.7174    7  471 -10307.425 -3082.8835  70.1%  6401  262s
   215   254 -3801.7772   10  462 -10307.425 -3082.8835  70.1%  3566  266s
   253   321 -3815.3060   10  459 -10307.425 -3082.8835  70.1%  3264  272s
   324   390 -3794.6981    9  448 -10307.425 -3082.8835  70.1%  2898  278s
   401   439 -3785.3743    9  446 -10307.425 -3082.8835  70.1%  2703  285s
   482   464 -3930.1631   10  454 -10307.425 -3082.8835  70.1%  2538  293s
   556   486 -3941.8260   10  461 -10307.425 -3082.8835  70.1%  2466  301s
   596   515 -4072.0128   11  448 -10307.425 -3082.8835  70.1%  2578  308s
   636   540 -4104.8855   11  451 -10307.425 -3082.8835  70.1%  2765  315s
   689   566 -4298.1093   11  441 -10307.425 -3082.8835  70.1%  2890  322s
   746   598 -4445.3672   12  446 -10307.425 -3082.8835  70.1%  2973  330s
   795   630 -5598.7976   12  428 -10307.425 -3082.8835  70.1%  3071  337s
   846   653 -5123.5759   12  351 -10307.425 -3082.8835  70.1%  3113  346s
   891   680 -5785.2948   12  422 -10307.425 -3082.8835  70.1%  3139  355s
   949   711 -5983.0914   12  421 -10307.425 -3082.8835  70.1%  3181  362s
  1010   728 -6053.2887   13  420 -10307.425 -3082.8835  70.1%  3239  369s
  1070   758 -6033.8573   13  409 -10307.425 -3082.8835  70.1%  3270  378s
  1116   789 -6185.0156   13  424 -10307.425 -3082.8835  70.1%  3343  383s
  1195   801 -6436.9388   13  332 -10307.425 -3082.8835  70.1%  3300  392s
  1283   816 -6212.3894   13  406 -10307.425 -3082.8835  70.1%  3303  402s
  1338   838 -6312.1041   14  328 -10307.425 -3082.8835  70.1%  3333  411s
  1410   862 -7575.5095   14  410 -10307.425 -3082.8835  70.1%  3382  420s
  1487   875 -6907.3895   14  433 -10307.425 -3082.8835  70.1%  3432  430s
  1572   889 -6489.5833   15  388 -10307.425 -3082.8835  70.1%  3493  441s
  1654   915 -8428.2691   16  207 -10307.425 -3082.8835  70.1%  3539  450s
  1719   939 -9288.0869   18  172 -10307.425 -3082.8835  70.1%  3637  461s
  1803   948     cutoff   19      -10307.425 -3082.8835  70.1%  3697  472s
  1848   968 -9776.6854   20  167 -10307.425 -3082.8835  70.1%  3722  482s
  1896   983     cutoff   21      -10307.425 -3082.8835  70.1%  3768  490s
  1945   999 -6025.1893   13  319 -10307.425 -3082.8835  70.1%  3819  502s
  2019  1029 -6850.4886   14  272 -10307.425 -3082.8835  70.1%  3844  514s
  2091  1037 -6895.6184   15  283 -10307.425 -3385.8183  67.2%  3896  525s
  2170  1062 -8208.3444   15  296 -10307.425 -3385.8183  67.2%  3959  536s
  2239  1087 -8660.6712   16  304 -10307.425 -3385.8183  67.2%  4029  548s
  2320  1097 -7805.6228   14  391 -10307.425 -3385.8183  67.2%  4091  561s
  2432  1134 -9594.3821   17  180 -10307.425 -3385.8183  67.2%  4107  575s
  2521  1168 -9346.2535   20  239 -10307.425 -3837.7137  62.8%  4151  589s
  2575  1211     cutoff   21      -10307.425 -3884.6283  62.3%  4229  603s
  2665  1256 -6063.3975   12  507 -10307.425 -3884.6283  62.3%  4290  616s
  2794  1301 -7580.4312   13  501 -10307.425 -3884.6283  62.3%  4269  631s
  2931  1334 -7076.9199   14  360 -10307.425 -3884.6283  62.3%  4273  650s
  3055  1380 -7764.8283   14  505 -10307.425 -4083.9294  60.4%  4310  666s
  3191  1401 -8322.7521   14  491 -10307.425 -4083.9294  60.4%  4348  678s
  3234  1417 -7658.6805   15  273 -10307.425 -4083.9294  60.4%  4379  692s
  3360  1458 -9631.3145   16  259 -10307.425 -4083.9294  60.4%  4371  711s
  3522  1500     cutoff   17      -10307.425 -4244.6819  58.8%  4352  730s
  3676  1545 -9672.7797   18  325 -10307.425 -4568.7108  55.7%  4380  748s
  3874  1580 -9956.6724   19  333 -10307.425 -4581.6347  55.6%  4368  765s
  3954  1648     cutoff   19      -10307.425 -4814.2394  53.3%  4375  787s
  4172  1754 -6962.6651   17  308 -10307.425 -4814.2394  53.3%  4339  809s
  4391  1818 -9491.3676   21  296 -10307.425 -4814.2394  53.3%  4328  829s
  4610  1902 -6735.2641   11  326 -10307.425 -4814.2394  53.3%  4322  851s
  4794  1930 -9580.9814   14  282 -10307.425 -4961.9465  51.9%  4362  873s
  5041  1936 -10135.811   14  280 -10307.425 -5058.1629  50.9%  4356  892s
  5209  1959     cutoff   14      -10307.425 -5092.7504  50.6%  4344  916s
  5428  1974 -8674.0966   13  335 -10307.425 -5092.7504  50.6%  4356  940s
  5681  1992 -9817.4467   17  401 -10307.425 -5092.7504  50.6%  4379  967s
  5941  2046 -9115.6118   20  219 -10307.425 -5349.8892  48.1%  4395  992s
  6205  2084 -8984.0321   15   90 -10307.425 -5429.3080  47.3%  4422 1021s
  6541  2119 -9296.9601   12  132 -10307.425 -5625.4189  45.4%  4401 1048s
  6870  2164 -9375.4155   26  165 -10307.425 -5759.2695  44.1%  4405 1074s
  7173  2223 -7726.0070   15  376 -10307.425 -5882.4390  42.9%  4380 1100s
  7558  2269 -7618.1164   14  271 -10307.425 -5960.4196  42.2%  4352 1129s
  8030  2313 -9553.8098   22  152 -10307.425 -6049.3792  41.3%  4292 1162s
  8410  2323 -8707.2870   14  283 -10307.425 -6062.7618  41.2%  4287 1195s
H 8448  2323                    -10299.88625 -6172.5281  40.1%  4292 1195s
  8472  2371     cutoff   14      -10299.886 -6172.5281  40.1%  4297 1229s
  9009  2404 -8913.2178   17  185 -10299.886 -6172.5281  40.1%  4239 1265s
  9515  2451 -10282.788   13  387 -10299.886 -6379.6978  38.1%  4202 1299s
  9995  2461     cutoff   14      -10299.886 -6493.5805  37.0%  4161 1334s
 10560  2481     cutoff   15      -10299.886 -6618.0871  35.7%  4120 1375s
 11092  2491 -8512.3782   16  136 -10299.886 -6730.5827  34.7%  4094 1415s
 11744  2485 -8897.1078   10  291 -10299.886 -6871.8062  33.3%  4050 1460s
 12390  2437 -10238.111   15  304 -10299.886 -6955.0945  32.5%  4016 1503s
 13105  2385 -7789.3395   17  376 -10299.886 -7088.6931  31.2%  3974 1546s
 13835  2311 -9464.9937   17  348 -10299.886 -7316.5682  29.0%  3940 1597s
 14596  2179 -8735.2955   16  386 -10299.886 -7449.6224  27.7%  3899 1648s
 15384  2073 -10283.521   14  285 -10299.886 -7587.7294  26.3%  3868 1702s
 16082  1984     cutoff   13      -10299.886 -7717.4839  25.1%  3857 1755s
 16933  1851     cutoff   14      -10299.886 -7818.7534  24.1%  3821 1809s
 17804  1589 -9976.1688   14  329 -10299.886 -8021.3198  22.1%  3783 1865s
 18813  1298 -9621.7519   18  192 -10299.886 -8275.6517  19.7%  3729 1926s
 19819   570 -9781.4578   25  148 -10299.886 -8691.6634  15.6%  3675 1982s
 21280    12     cutoff   28      -10299.886 -8890.5226  13.7%  3546 2022s
 22308     0 -10036.897   20  420 -10299.886 -9685.5879  5.96%  3433 2027s

Cutting planes:
  Gomory: 3
  Cover: 1
  Implied bound: 36
  MIR: 927
  Flow cover: 1786
  RLT: 42
  Relax-and-lift: 136

Explored 22341 nodes (76827837 simplex iterations) in 2027.18 seconds (5926.62 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -10299.9 -10307.4 -10311.9 ... -10459.4
No other solutions better than -10299.9

Optimal solution found (tolerance 1.00e-04)
Best objective -1.029988625341e+04, best bound -1.029988625341e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 2027.22s
  Master Objective (UB) = -10299.89, θ = 111350.32
  Upper Bound (UB) = -10299.89

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 111350.32
  [DEBUG]   ✓ Scenario 0: θ = 111350.32 ≤ Q = 111350.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 111350.32 ≤ Q = 111350.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 111350.32 ≤ Q = 111350.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 111350.32 ≤ Q = 111350.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 111350.32 ≤ Q = 111350.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 111350.32 ≤ Q = 111350.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 111350.32 ≤ Q = 111350.32 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x5af3975f
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xa50c68a1
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-14, 2e+02]
Found heuristic solution: objective 1.189487e+13
Presolve removed 2589 rows and 1882 columns
Presolve time: 0.00s
Presolved: 504 rows, 507 columns, 1421 nonzeros
Found heuristic solution: objective 5914136.5157
Variable types: 343 continuous, 164 integer (164 binary)

Root relaxation: objective -1.247492e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -124749.16    0  123 5914136.52 -124749.16   102%     -    0s
H    0     0                    -89480.23191 -124749.16  39.4%     -    0s
H    0     0                    -90424.36526 -124749.16  38.0%     -    0s
H    0     0                    -92292.91570 -124749.16  35.2%     -    0s
H    0     0                    -93855.07116 -104250.15  11.1%     -    0s
H    0     0                    -94252.33471 -104250.15  10.6%     -    0s
     0     0 -104250.15    0  123 -94252.335 -104250.15  10.6%     -    0s
H    0     0                    -100937.3397 -104179.68  3.21%     -    0s
     0     0 -103770.52    0  128 -100937.34 -103770.52  2.81%     -    0s
H    0     0                    -101655.5451 -103764.64  2.07%     -    0s
H    0     0                    -102104.5634 -103764.64  1.63%     -    0s
     0     0 -103340.65    0   86 -102104.56 -103340.65  1.21%     -    0s
H    0     0                    -102530.9980 -103335.91  0.79%     -    0s
     0     0 -103331.89    0   85 -102531.00 -103331.89  0.78%     -    0s
     0     0 -103033.68    0   39 -102531.00 -103033.68  0.49%     -    0s
H    0     0                    -102789.9815 -103025.77  0.23%     -    0s
     0     0 -102999.50    0   45 -102789.98 -102999.50  0.20%     -    0s
     0     0 -102999.18    0   28 -102789.98 -102999.18  0.20%     -    0s
     0     0 -102992.34    0   28 -102789.98 -102992.34  0.20%     -    0s
     0     0 -102928.84    0   13 -102789.98 -102928.84  0.14%     -    0s
     0     0 -102927.45    0   12 -102789.98 -102927.45  0.13%     -    0s
     0     0 -102914.75    0   10 -102789.98 -102914.75  0.12%     -    0s
     0     0 -102906.69    0   10 -102789.98 -102906.69  0.11%     -    0s
     0     0 -102906.69    0   52 -102789.98 -102906.69  0.11%     -    0s
     0     0 -102905.64    0   11 -102789.98 -102905.64  0.11%     -    0s
     0     0 -102903.04    0   10 -102789.98 -102903.04  0.11%     -    0s
H    0     0                    -102833.4784 -102893.71  0.06%     -    0s
H    0     0                    -102850.0304 -102891.40  0.04%     -    0s
     0     0 -102891.40    0    5 -102850.03 -102891.40  0.04%     -    0s
     0     0 -102879.65    0    4 -102850.03 -102879.65  0.03%     -    0s
     0     0 -102877.84    0    3 -102850.03 -102877.84  0.03%     -    0s
     0     0 -102877.84    0    8 -102850.03 -102877.84  0.03%     -    0s
H    0     0                    -102858.2057 -102877.84  0.02%     -    0s
H    0     0                    -102877.2346 -102877.84  0.00%     -    0s

Cutting planes:
  Gomory: 2
  Implied bound: 1
  MIR: 6
  Flow cover: 4
  Relax-and-lift: 1

Explored 1 nodes (1002 simplex iterations) in 0.13 seconds (0.06 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -102877 -102858 -102850 ... -101656
No other solutions better than -102877

Optimal solution found (tolerance 1.00e-04)
Best objective -1.028772346031e+05, best bound -1.028772346031e+05, gap 0.0000%
  Subproblem solved in 0.14s
  Worst-case operational profit (Z_SP) = 101161.05
  Scenario: 37 demand increases, 23 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -102877.23
  [DEBUG]   S×d_nominal = 204038.28
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 204038.28 + -102877.23 = 101161.05
  [DEBUG]   Current θ from Master = 111350.32
  [DEBUG]   ⚠️  Z_SP ≤ θ by 10189.27 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -20489.16
  Lower Bound (LB) = -13476.62
  Gap (UB-LB) = 3176.7297, Absolute Gap = 3176.7297, Relative Gap = 0.308424
  Not converged yet (gap = 3176.73 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 37 increases, 23 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351415 nonzeros
Model fingerprint: 0x409c49b0
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-03, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 54984 rows and 22324 columns
Presolve time: 0.95s
Presolved: 68719 rows, 29856 columns, 427639 nonzeros
Variable types: 27597 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -366196.7547
Found heuristic solution: objective -184823.6323

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 68719 rows, 29856 columns, 427639 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   33189   -2.1677798e+04   0.000000e+00   4.343223e+06      5s
   43867   -1.0643023e+04   0.000000e+00   6.488211e+06     10s
   52268   -3.1571256e+03   0.000000e+00   1.169290e+06     15s
   59760    2.4179527e+03   0.000000e+00   9.313924e+05     20s
   66677    2.8948754e+03   0.000000e+00   7.702338e+05     25s
Concurrent spin time: 0.01s

Solved with dual simplex

Root relaxation: objective 8.327830e+03, 50379 iterations, 28.70 seconds (57.93 work units)
Total elapsed time = 30.14s (DegenMoves)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 8327.82971    0  232 -184823.63 8327.82971   105%     -   30s
H    0     0                    -173501.0216 8327.82971   105%     -   30s
H    0     0                    -86935.25180 8327.82971   110%     -   30s
H    0     0                    -85589.01807 8327.82971   110%     -   30s
H    0     0                    -82752.44278 8327.82971   110%     -   30s
H    0     0                    -77312.94674 8327.82971   111%     -   30s
H    0     0                    -49556.82664 8327.82971   117%     -   30s
H    0     0                    -20671.97359 8327.82971   140%     -   30s
H    0     0                    -19986.88940 8327.82971   142%     -   30s
H    0     0                    -18792.98171 8327.82971   144%     -   31s
H    0     0                    -16923.44348 8327.82971   149%     -   31s
H    0     0                    -14748.14810 8327.82971   156%     -   31s
H    0     0                    -14708.98527 8327.82971   157%     -   31s
H    0     0                    -14694.89150 8327.82971   157%     -   31s
H    0     0                    -14687.92079 4413.63180   130%     -   45s
H    0     0                    -14677.54293 4413.63180   130%     -   45s
H    0     0                    -14672.44749 4413.63180   130%     -   45s
H    0     0                    -14659.52323 4413.63180   130%     -   45s
H    0     0                    -14621.83723 4413.63180   130%     -   45s
H    0     0                    -14604.70999 4413.63180   130%     -   45s
     0     0 4222.04370    0  412 -14604.710 4222.04370   129%     -   45s
     0     0 4185.82696    0  420 -14604.710 4185.82696   129%     -   49s
     0     0 4164.96050    0  416 -14604.710 4164.96050   129%     -   51s
     0     0 4164.96050    0  419 -14604.710 4164.96050   129%     -   51s
     0     0 4164.96050    0  421 -14604.710 4164.96050   129%     -   52s
     0     0 4164.96050    0  421 -14604.710 4164.96050   129%     -   53s
     0     0 4164.96050    0  424 -14604.710 4164.96050   129%     -   54s
     0     0 4164.96050    0  430 -14604.710 4164.96050   129%     -   55s
     0     0 4164.96050    0  432 -14604.710 4164.96050   129%     -   56s
     0     0 4164.96050    0  433 -14604.710 4164.96050   129%     -   56s
H    0     0                    -14579.33367 1743.36822   112%     -   69s
H    0     0                    -14578.51378 1743.36822   112%     -   69s
H    0     0                    -14574.17004 1743.36822   112%     -   69s
H    0     0                    -14505.31196 1743.36822   112%     -   69s
H    0     0                    -14494.93410 1743.36822   112%     -   69s
H    0     0                    -14489.98949 1743.36822   112%     -   69s
     0     0 1743.36822    0  380 -14489.989 1743.36822   112%     -   69s
     0     0 1419.85575    0  426 -14489.989 1419.85575   110%     -   76s
     0     0 1264.51473    0  501 -14489.989 1264.51473   109%     -   81s
     0     0 1219.86069    0  418 -14489.989 1219.86069   108%     -   85s
H    0     0                    -14079.13102 1205.78442   109%     -   87s
H    0     0                    -13860.45601 1205.78442   109%     -   87s
H    0     0                    -13662.98711 1205.78442   109%     -   87s
H    0     0                    -13631.24411 1205.78442   109%     -   87s
H    0     0                    -13593.97658 1205.78442   109%     -   87s
H    0     0                    -13591.92375 1205.78442   109%     -   87s
H    0     0                    -13541.47046 1205.78442   109%     -   87s
H    0     0                    -13539.55524 1205.78442   109%     -   87s
H    0     0                    -13537.64244 1205.78442   109%     -   87s
H    0     0                    -12329.34850 1205.78442   110%     -   87s
H    0     0                    -12013.69768 1205.78442   110%     -   87s
H    0     0                    -11984.45363 1205.78442   110%     -   87s
H    0     0                    -11942.95323 1205.78442   110%     -   87s
H    0     0                    -11886.66302 1205.78442   110%     -   87s
H    0     0                    -11808.52294 1205.78442   110%     -   87s
H    0     0                    -11760.12719 1205.78442   110%     -   87s
H    0     0                    -11585.87033 1205.78442   110%     -   87s
H    0     0                    -11527.29696 1205.78442   110%     -   87s
H    0     0                    -11526.89760 1205.78442   110%     -   87s
H    0     0                    -11472.66084 1205.78442   111%     -   87s
H    0     0                    -11469.36680 1205.78442   111%     -   87s
     0     0 1205.78442    0  418 -11469.367 1205.78442   111%     -   87s
     0     0 1200.18689    0  423 -11469.367 1200.18689   110%     -   88s
     0     0 1199.02604    0  425 -11469.367 1199.02604   110%     -   88s
     0     0 1196.27910    0  424 -11469.367 1196.27910   110%     -   89s
     0     0 1195.17592    0  501 -11469.367 1195.17592   110%     -   90s
     0     0 1193.88736    0  502 -11469.367 1193.88736   110%     -   91s
     0     0 1190.41517    0  434 -11469.367 1190.41517   110%     -   91s
     0     0 1189.96432    0  434 -11469.367 1189.96432   110%     -   92s
     0     0 -113.33746    0  449 -11469.367 -113.33746  99.0%     -  112s
H    0     0                    -11451.17980 -113.78176  99.0%     -  112s
H    0     0                    -11416.19887 -113.78176  99.0%     -  112s
H    0     0                    -11407.17751 -113.78176  99.0%     -  112s
     0     0 -432.46106    0  447 -11407.178 -432.46106  96.2%     -  120s
     0     0 -525.58618    0  506 -11407.178 -525.58618  95.4%     -  125s
     0     0 -597.42065    0  516 -11407.178 -597.42065  94.8%     -  128s
     0     0 -636.94557    0  532 -11407.178 -636.94557  94.4%     -  131s
     0     0 -650.43497    0  526 -11407.178 -650.43497  94.3%     -  132s
     0     0 -654.41826    0  531 -11407.178 -654.41826  94.3%     -  133s
     0     0 -656.25513    0  537 -11407.178 -656.25513  94.2%     -  134s
     0     0 -678.67369    0  473 -11407.178 -678.67369  94.1%     -  135s
     0     0 -688.43499    0  473 -11407.178 -688.43499  94.0%     -  136s
     0     0 -697.10070    0  473 -11407.178 -697.10070  93.9%     -  138s
     0     0 -698.31655    0  476 -11407.178 -698.31655  93.9%     -  139s
     0     0 -703.56407    0  532 -11407.178 -703.56407  93.8%     -  139s
     0     0 -704.41077    0  473 -11407.178 -704.41077  93.8%     -  139s
     0     0 -1013.9894    0  545 -11407.178 -1013.9894  91.1%     -  147s
H    0     0                    -11390.26541 -1014.1030  91.1%     -  147s
     0     0 -1131.5388    0  534 -11390.265 -1131.5388  90.1%     -  150s
     0     0 -1190.6863    0  524 -11390.265 -1190.6863  89.5%     -  153s
     0     0 -1211.9029    0  477 -11390.265 -1211.9029  89.4%     -  154s
     0     0 -1221.1440    0  532 -11390.265 -1221.1440  89.3%     -  155s
     0     0 -1238.0082    0  541 -11390.265 -1238.0082  89.1%     -  156s
     0     0 -1243.0127    0  535 -11390.265 -1243.0127  89.1%     -  157s
     0     0 -1244.2451    0  539 -11390.265 -1244.2451  89.1%     -  157s
     0     0 -1244.2933    0  537 -11390.265 -1244.2933  89.1%     -  157s
H    0     0                    -11072.19697 -1325.7858  88.0%     -  161s
     0     0 -1325.7858    0  466 -11072.197 -1325.7858  88.0%     -  161s
H    0     0                    -11009.63678 -1326.0608  88.0%     -  161s
H    0     0                    -10946.89313 -1326.0608  87.9%     -  161s
H    0     0                    -10938.32225 -1361.3447  87.6%     -  164s
     0     0 -1361.3447    0  551 -10938.322 -1361.3447  87.6%     -  164s
     0     0 -1378.5746    0  558 -10938.322 -1378.5746  87.4%     -  165s
     0     0 -1384.1784    0  560 -10938.322 -1384.1784  87.3%     -  166s
     0     0 -1385.5067    0  563 -10938.322 -1385.5067  87.3%     -  167s
     0     0 -1389.8087    0  568 -10938.322 -1389.8087  87.3%     -  168s
     0     0 -1390.5191    0  572 -10938.322 -1390.5191  87.3%     -  168s
     0     0 -1465.0312    0  555 -10938.322 -1465.0312  86.6%     -  172s
     0     0 -1490.9505    0  565 -10938.322 -1490.9505  86.4%     -  174s
     0     0 -1495.4330    0  564 -10938.322 -1495.4330  86.3%     -  175s
     0     0 -1500.0848    0  560 -10938.322 -1500.0848  86.3%     -  176s
     0     0 -1513.7006    0  553 -10938.322 -1513.7006  86.2%     -  177s
     0     0 -1515.1834    0  566 -10938.322 -1515.1834  86.1%     -  178s
     0     0 -1515.4811    0  561 -10938.322 -1515.4811  86.1%     -  178s
     0     0 -1579.0692    0  560 -10938.322 -1579.0692  85.6%     -  182s
H    0     0                    -10927.81200 -1579.1407  85.5%     -  182s
     0     0 -1609.7236    0  562 -10927.812 -1609.7236  85.3%     -  184s
     0     0 -1614.8621    0  567 -10927.812 -1614.8621  85.2%     -  185s
     0     0 -1618.0957    0  563 -10927.812 -1618.0957  85.2%     -  186s
     0     0 -1619.4893    0  571 -10927.812 -1619.4893  85.2%     -  186s
     0     0 -1619.5942    0  575 -10927.812 -1619.5942  85.2%     -  186s
     0     0 -1646.7181    0  568 -10927.812 -1646.7181  84.9%     -  189s
     0     0 -1652.5988    0  570 -10927.812 -1652.5988  84.9%     -  190s
     0     0 -1653.2931    0  582 -10927.812 -1653.2931  84.9%     -  191s
     0     0 -1665.7123    0  570 -10927.812 -1665.7123  84.8%     -  193s
H    0     0                    -10908.60539 -1672.4623  84.7%     -  194s
     0     0 -1672.4623    0  575 -10908.605 -1672.4623  84.7%     -  194s
     0     0 -1679.9679    0  573 -10908.605 -1679.9679  84.6%     -  195s
     0     0 -1681.3341    0  579 -10908.605 -1681.3341  84.6%     -  195s
     0     0 -1681.4050    0  579 -10908.605 -1681.4050  84.6%     -  196s
H    0     0                    -10414.58465 -1693.4503  83.7%     -  197s
H    0     0                    -10394.54084 -1693.4503  83.7%     -  197s
     0     0 -1693.4503    0  570 -10394.541 -1693.4503  83.7%     -  197s
     0     0 -1696.3598    0  575 -10394.541 -1696.3598  83.7%     -  198s
     0     0 -1703.8174    0  564 -10394.541 -1703.8174  83.6%     -  200s
     0     0 -1705.3630    0  565 -10394.541 -1705.3630  83.6%     -  200s
     0     0 -1706.5612    0  560 -10394.541 -1706.5612  83.6%     -  201s
     0     0 -1716.9448    0  564 -10394.541 -1716.9448  83.5%     -  203s
     0     0 -1718.1656    0  565 -10394.541 -1718.1656  83.5%     -  204s
     0     0 -1725.0682    0  566 -10394.541 -1725.0682  83.4%     -  206s
     0     0 -1725.1829    0  566 -10394.541 -1725.1829  83.4%     -  207s
     0     2 -1725.1829    0  566 -10394.541 -1725.1829  83.4%     -  247s
     1     4 -1778.1990    1  550 -10394.541 -1725.1829  83.4%  3580  250s
     3     8 -1894.2540    2  550 -10394.541 -1771.4592  83.0%  3483  257s
     7    15 -2447.4606    3  549 -10394.541 -1894.3463  81.8%  5948  263s
    14    29 -2597.3092    4  538 -10394.541 -1894.3463  81.8%  7824  273s
    28    46 -7872.3903    5  165 -10394.541 -2445.1511  76.5%  9445  292s
    45    78 -4879.9045    6  319 -10394.541 -2445.1511  76.5% 11948  301s
    77   199 -5013.9672    7  379 -10394.541 -2445.1511  76.5%  8740  311s
   202   233 -5585.5847   10  389 -10394.541 -2445.1511  76.5%  4872  319s
   263   291 -5634.8185   11  382 -10394.541 -2445.1511  76.5%  4198  327s
   351   325 -6618.7651   13  354 -10394.541 -2445.1511  76.5%  3807  334s
   425   346 -6697.7843   14  357 -10394.541 -2445.1511  76.5%  3500  341s
   456   357 -6971.4196   15  428 -10394.541 -2445.1511  76.5%  3542  348s
   499   378 -7380.8500   16  363 -10394.541 -2445.1511  76.5%  3530  355s
   540   404 -7479.0635   17  229 -10394.541 -2445.1511  76.5%  3691  362s
   592   419     cutoff   18      -10394.541 -2446.2062  76.5%  3618  370s
   653   440 -7789.9037   19  288 -10394.541 -2446.2062  76.5%  3490  378s
   718   457 -8309.3109   20  305 -10394.541 -2446.2062  76.5%  3417  385s
   774   463 -8724.1722   21  280 -10394.541 -2446.2062  76.5%  3452  394s
   833   486 -8829.4476   22  284 -10394.541 -2446.2062  76.5%  3491  401s
   872   513 -8958.9603   23  351 -10394.541 -2446.2062  76.5%  3535  409s
   931   542 -9109.8710   24  341 -10394.541 -2446.2062  76.5%  3489  418s
  1007   561 -9237.1652   25  347 -10394.541 -2446.2062  76.5%  3430  426s
  1090   600     cutoff   26      -10394.541 -2446.2062  76.5%  3420  436s
  1173   640 -9458.3658   27  357 -10394.541 -2446.2062  76.5%  3441  444s
  1257   661     cutoff   28      -10394.541 -2446.2062  76.5%  3419  452s
  1359   679 -9604.4606   28  341 -10394.541 -2446.2062  76.5%  3357  463s
  1437   713     cutoff   29      -10394.541 -2446.2062  76.5%  3432  472s
  1513   719 -7431.0942   11  447 -10394.541 -2446.2062  76.5%  3514  482s
  1586   744 -7954.1603   12  447 -10394.541 -2446.2062  76.5%  3563  492s
  1670   763 -8013.8764   12  410 -10394.541 -2597.9543  75.0%  3658  500s
  1737   785 -8184.2835   13  407 -10394.541 -3017.2680  71.0%  3731  511s
  1843   801 -9360.2282   14   84 -10394.541 -3017.4129  71.0%  3723  520s
  1884   828 -9759.2332   15   93 -10394.541 -3017.4129  71.0%  3760  530s
  1955   846 -9645.0314   15   59 -10394.541 -3017.4129  71.0%  3770  540s
  2009   880 -9751.6742   16   65 -10394.541 -3017.4129  71.0%  3815  552s
  2113   885 -5890.8572   13  287 -10394.541 -3017.4129  71.0%  3860  564s
  2174   912 -6240.9834   14  430 -10394.541 -3017.4129  71.0%  3885  576s
  2272   954 -6378.5855   15  279 -10394.541 -3017.4129  71.0%  3898  588s
  2375  1000 -6917.5948   18  187 -10394.541 -3017.4129  71.0%  3954  600s
  2502  1037 -9074.7781   25   38 -10394.541 -3619.3621  65.2%  3963  608s
  2551  1074 -9507.0241   31   20 -10394.541 -3619.3621  65.2%  3982  620s
  2662  1110 -9717.9197   37    4 -10394.541 -4114.6181  60.4%  3952  636s
  2772  1150     cutoff   16      -10394.541 -4114.6181  60.4%  3961  651s
  2932  1196 -10297.004   19   35 -10394.541 -4614.0041  55.6%  3958  669s
  3076  1245 -8368.7950   15  112 -10394.541 -4614.0041  55.6%  3996  685s
  3271  1291 -9998.9765    8  127 -10394.541 -4614.0041  55.6%  3969  708s
  3409  1325 -8667.3990   13  456 -10394.541 -4866.4985  53.2%  4034  726s
  3576  1405 -9960.4916   10  229 -10394.541 -5079.3838  51.1%  4041  745s
  3824  1441 -8377.8940   10  141 -10394.541 -5104.0978  50.9%  3941  767s
  4027  1458 -10070.286   16  104 -10394.541 -5195.4355  50.0%  3852  788s
  4114  1511 -9282.7905   14   95 -10394.541 -5237.8514  49.6%  3846  806s
  4278  1533 -8290.8312   16  435 -10394.541 -5330.5480  48.7%  3887  825s
  4318  1564 -8552.3500   17  339 -10394.541 -5345.6802  48.6%  3920  842s
  4373  1580     cutoff   18      -10394.541 -5402.9466  48.0%  3934  859s
  4447  1591 -10180.662   19  253 -10394.541 -5402.9466  48.0%  3938  878s
  4606  1623     cutoff   22      -10394.541 -5416.0050  47.9%  3934  905s
  4823  1657     cutoff   19      -10394.541 -5641.5194  45.7%  3922  930s
  5052  1712     cutoff    9      -10394.541 -5745.4159  44.7%  3930  952s
  5323  1738 -9419.8906   20  381 -10394.541 -5745.4159  44.7%  3936  975s
  5619  1756     cutoff   23      -10394.541 -5745.4159  44.7%  3941 1000s
  5915  1764     cutoff   12      -10394.541 -5993.7009  42.3%  3916 1027s
  6319  1800 infeasible   13      -10394.541 -6199.6467  40.4%  3896 1052s
  6642  1790 infeasible   21      -10394.541 -6278.2906  39.6%  3917 1078s
  6996  1813     cutoff   23      -10394.541 -6497.7281  37.5%  3914 1109s
  7263  1831 -8047.4022   13  416 -10394.541 -6594.4813  36.6%  3934 1143s
  7645  1848 -9526.2256   19  294 -10394.541 -6629.1312  36.2%  3925 1177s
  7992  1874 -8530.4463   19  229 -10394.541 -6804.2170  34.5%  3944 1219s
  8401  1872 -10109.482   13  451 -10394.541 -6936.6425  33.3%  3941 1254s
  8681  1885 -10181.726   14  377 -10394.541 -7032.2448  32.3%  3953 1298s
  9074  1889 -8574.1402   18  366 -10394.541 -7072.6830  32.0%  3914 1339s
  9598  1921 -8127.9289   18  442 -10394.541 -7237.2987  30.4%  3897 1376s
 10073  1913 infeasible   24      -10394.541 -7360.7430  29.2%  3893 1418s
 10567  1883     cutoff   16      -10394.541 -7646.7193  26.4%  3898 1464s
 11064  1781     cutoff   36      -10394.541 -7798.9294  25.0%  3911 1510s
 11621  1722     cutoff   21      -10394.541 -7904.5706  24.0%  3914 1552s
 12218  1593 -10239.728   30  315 -10394.541 -8074.6507  22.3%  3906 1614s
 12840  1443 infeasible   22      -10394.541 -8200.8990  21.1%  3894 1657s
 13587  1291     cutoff   19      -10394.541 -8466.6292  18.5%  3852 1700s
 14345  1287 -9957.6401   14  559 -10394.541 -8679.5150  16.5%  3812 1734s
 14446  1121 -10048.301   15  561 -10394.541 -8781.7897  15.5%  3812 1777s
 15216   745 -9656.3431   19  374 -10394.541 -8919.5270  14.2%  3736 1825s
 16515   117     cutoff   23      -10394.541 -9139.2177  12.1%  3603 1865s
H18343   140                    -10384.89982 -9773.9849  5.88%  3354 1869s
 19264     0     cutoff   42      -10384.900 -10352.413  0.31%  3198 1870s
H19362     0                    -10380.07864 -10357.733  0.22%  3182 1870s

Cutting planes:
  Learned: 2
  Implied bound: 28
  MIR: 1078
  Flow cover: 2021
  RLT: 36
  Relax-and-lift: 156

Explored 19875 nodes (61916146 simplex iterations) in 1870.48 seconds (5582.68 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -10380.1 -10384.9 -10394.5 ... -11072.2
No other solutions better than -10380.1

Optimal solution found (tolerance 1.00e-04)
Best objective -1.038007863783e+04, best bound -1.038007863783e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 1870.57s
  Master Objective (UB) = -10380.08, θ = 113541.58
  Upper Bound (UB) = -10380.08

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 113541.58
  [DEBUG]   ✓ Scenario 0: θ = 113541.58 ≤ Q = 113541.58 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 113541.58 ≤ Q = 113553.37 (slack: 11.80)
  [DEBUG]   ✓ Scenario 2: θ = 113541.58 ≤ Q = 113541.58 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 113541.58 ≤ Q = 113541.58 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 113541.58 ≤ Q = 113541.58 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 113541.58 ≤ Q = 113541.58 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 113541.58 ≤ Q = 113541.58 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 113541.58 ≤ Q = 113541.58 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x524615a
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x0524615a
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.181406e+13
Presolve removed 2596 rows and 1888 columns
Presolve time: 0.00s
Presolved: 497 rows, 501 columns, 1402 nonzeros
Found heuristic solution: objective 5991264.1578
Variable types: 338 continuous, 163 integer (163 binary)
Found heuristic solution: objective 5990926.9512

Root relaxation: objective -1.212240e+05, 234 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -121224.02    0  122 5990926.95 -121224.02   102%     -    0s
H    0     0                    -80764.72683 -121224.02  50.1%     -    0s
H    0     0                    -81211.03183 -121224.02  49.3%     -    0s
H    0     0                    -82051.91068 -98274.828  19.8%     -    0s
H    0     0                    -94666.87125 -98274.828  3.81%     -    0s
     0     0 -98274.828    0  128 -94666.871 -98274.828  3.81%     -    0s
H    0     0                    -95884.03087 -98204.536  2.42%     -    0s
     0     0 -97525.378    0  129 -95884.031 -97525.378  1.71%     -    0s
H    0     0                    -96176.71217 -97521.192  1.40%     -    0s
     0     0 -97521.192    0  129 -96176.712 -97521.192  1.40%     -    0s
H    0     0                    -96216.71851 -97269.478  1.09%     -    0s
     0     0 -97269.478    0  125 -96216.719 -97269.478  1.09%     -    0s
H    0     0                    -96231.58917 -97255.424  1.06%     -    0s
     0     0 -97255.424    0  126 -96231.589 -97255.424  1.06%     -    0s
     0     0 -97014.557    0  124 -96231.589 -97014.557  0.81%     -    0s
H    0     0                    -96254.06940 -97007.834  0.78%     -    0s
     0     0 -96965.462    0  122 -96254.069 -96965.462  0.74%     -    0s
     0     0 -96952.635    0  122 -96254.069 -96952.635  0.73%     -    0s
     0     0 -96716.522    0   77 -96254.069 -96716.522  0.48%     -    0s
     0     0 -96676.640    0   76 -96254.069 -96676.640  0.44%     -    0s
     0     0 -96673.258    0   77 -96254.069 -96673.258  0.44%     -    0s
     0     0 -96588.084    0   72 -96254.069 -96588.084  0.35%     -    0s
     0     0 -96577.281    0   72 -96254.069 -96577.281  0.34%     -    0s
     0     2 -96577.281    0   72 -96254.069 -96577.281  0.34%     -    0s
H   30     8                    -96268.42449 -96380.180  0.12%   9.1    0s
H   31     7                    -96274.85757 -96380.180  0.11%   9.0    0s
H   96    34                    -96276.47958 -96328.008  0.05%   6.3    0s
*  151    69              20    -96277.82328 -96322.622  0.05%   5.7    0s
H  272    27                    -96278.42473 -96312.143  0.04%   5.1    0s
H  318    27                    -96279.48575 -96312.143  0.03%   5.1    0s
*  319    27              21    -96280.82946 -96312.143  0.03%   5.1    0s

Cutting planes:
  Gomory: 19
  Implied bound: 9
  MIR: 154
  Flow cover: 13
  RLT: 80
  Relax-and-lift: 7
  BQP: 2

Explored 401 nodes (2838 simplex iterations) in 0.13 seconds (0.09 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -96280.8 -96279.5 -96278.4 ... -96216.7

Optimal solution found (tolerance 1.00e-04)
Best objective -9.628082945540e+04, best bound -9.628757505642e+04, gap 0.0070%
  Subproblem solved in 0.14s
  Worst-case operational profit (Z_SP) = 106514.71
  Scenario: 60 demand increases, 0 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -96280.83
  [DEBUG]   S×d_nominal = 202795.54
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 202795.54 + -96280.83 = 106514.71
  [DEBUG]   Current θ from Master = 113541.58
  [DEBUG]   ⚠️  Z_SP ≤ θ by 7026.87 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -17406.94
  Lower Bound (LB) = -13476.62
  Gap (UB-LB) = 3096.5373, Absolute Gap = 3096.5373, Relative Gap = 0.298315
  Not converged yet (gap = 3096.54 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 60 increases, 0 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394652 nonzeros
Model fingerprint: 0xaa282099
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-03, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 61852 rows and 25112 columns
Presolve time: 0.91s
Presolved: 77141 rows, 33308 columns, 473219 nonzeros
Variable types: 31049 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -366196.7547
Found heuristic solution: objective -196432.4631

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 77141 rows, 33308 columns, 473219 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   35504   -1.9863762e+04   0.000000e+00   1.129340e+07      5s
   47132   -2.0808219e+03   0.000000e+00   7.226129e+06     10s
   55285   -4.4075795e+02   0.000000e+00   2.236643e+06     15s
   62641    1.1466570e+03   0.000000e+00   2.027710e+07     20s
   69962    2.4076914e+03   0.000000e+00   1.145693e+06     25s
   77276    6.1364208e+03   0.000000e+00   2.961964e+08     30s
   84242    7.6234867e+03   0.000000e+00   1.747106e+09     35s
   91504    8.1360028e+03   0.000000e+00   1.510317e+07     40s
Concurrent spin time: 2.03s

Solved with dual simplex

Root relaxation: objective 1.061658e+04, 83829 iterations, 41.94 seconds (95.53 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 10616.5780    0  213 -196432.46 10616.5780   105%     -   43s
H    0     0                    -191171.1886 10616.5780   106%     -   43s
H    0     0                    -96734.17716 10616.5780   111%     -   43s
H    0     0                    -96724.90267 10616.5780   111%     -   43s
H    0     0                    -85219.61346 10616.5780   112%     -   43s
H    0     0                    -11569.05591 10616.5780   192%     -   43s
H    0     0                    -11271.51699 10616.5780   194%     -   43s
H    0     0                    -11251.73881 10616.5780   194%     -   43s
     0     0 5929.71782    0  215 -11251.739 5929.71782   153%     -   56s
     0     0 5408.47212    0  329 -11251.739 5408.47212   148%     -   61s
     0     0 5408.47212    0  349 -11251.739 5408.47212   148%     -   64s
     0     0 5408.47212    0  351 -11251.739 5408.47212   148%     -   64s
     0     0 5408.47212    0  351 -11251.739 5408.47212   148%     -   64s
H    0     0                    -11244.69266 2970.69571   126%     -   73s
     0     0 2970.69571    0  390 -11244.693 2970.69571   126%     -   73s
H    0     0                    -11231.62509 2970.26081   126%     -   73s
H    0     0                    -11210.37449 2970.26081   126%     -   73s
     0     0 2735.30296    0  474 -11210.374 2735.30296   124%     -   77s
     0     0 2641.05190    0  466 -11210.374 2641.05190   124%     -   81s
     0     0 2581.57631    0  473 -11210.374 2581.57631   123%     -   82s
     0     0 2561.51582    0  474 -11210.374 2561.51582   123%     -   83s
     0     0 2556.87149    0  474 -11210.374 2556.87149   123%     -   84s
     0     0 2431.99378    0  490 -11210.374 2431.99378   122%     -   86s
     0     0 2425.84468    0  404 -11210.374 2425.84468   122%     -   87s
     0     0 2413.75883    0  428 -11210.374 2413.75883   122%     -   87s
     0     0 2413.75132    0  428 -11210.374 2413.75132   122%     -   88s
     0     0 -295.15134    0  499 -11210.374 -295.15134  97.4%     -   99s
     0     0 -681.66539    0  605 -11210.374 -681.66539  93.9%     -  105s
     0     0 -836.75946    0  597 -11210.374 -836.75946  92.5%     -  109s
     0     0 -892.55282    0  611 -11210.374 -892.55282  92.0%     -  111s
     0     0 -916.06576    0  622 -11210.374 -916.06576  91.8%     -  113s
     0     0 -1008.0763    0  596 -11210.374 -1008.0763  91.0%     -  115s
     0     0 -1040.9525    0  606 -11210.374 -1040.9525  90.7%     -  117s
     0     0 -1052.3036    0  604 -11210.374 -1052.3036  90.6%     -  118s
     0     0 -1061.3196    0  612 -11210.374 -1061.3196  90.5%     -  120s
     0     0 -1139.7299    0  621 -11210.374 -1139.7299  89.8%     -  122s
     0     0 -1166.3304    0  559 -11210.374 -1166.3304  89.6%     -  123s
     0     0 -1168.7200    0  554 -11210.374 -1168.7200  89.6%     -  125s
     0     0 -1170.1662    0  560 -11210.374 -1170.1662  89.6%     -  125s
H    0     0                    -11104.35954 -2473.5446  77.7%     -  136s
     0     0 -2473.5446    0  559 -11104.360 -2473.5446  77.7%     -  136s
     0     0 -2656.8953    0  567 -11104.360 -2656.8953  76.1%     -  141s
     0     0 -2785.9840    0  567 -11104.360 -2785.9840  74.9%     -  143s
     0     0 -2846.8359    0  584 -11104.360 -2846.8359  74.4%     -  145s
     0     0 -2876.4501    0  581 -11104.360 -2876.4501  74.1%     -  146s
     0     0 -2883.2142    0  586 -11104.360 -2883.2142  74.0%     -  147s
     0     0 -2905.4764    0  590 -11104.360 -2905.4764  73.8%     -  148s
     0     0 -2909.4997    0  597 -11104.360 -2909.4997  73.8%     -  149s
     0     0 -2912.1106    0  597 -11104.360 -2912.1106  73.8%     -  149s
     0     0 -2919.6481    0  596 -11104.360 -2919.6481  73.7%     -  150s
     0     0 -2926.8602    0  597 -11104.360 -2926.8602  73.6%     -  150s
     0     0 -2928.1404    0  596 -11104.360 -2928.1404  73.6%     -  150s
     0     0 -3229.4580    0  566 -11104.360 -3229.4580  70.9%     -  156s
     0     0 -3261.2103    0  578 -11104.360 -3261.2103  70.6%     -  158s
     0     0 -3297.9160    0  575 -11104.360 -3297.9160  70.3%     -  159s
     0     0 -3301.7113    0  580 -11104.360 -3301.7113  70.3%     -  160s
     0     0 -3315.8819    0  592 -11104.360 -3315.8819  70.1%     -  160s
     0     0 -3318.0118    0  584 -11104.360 -3318.0118  70.1%     -  161s
     0     0 -3318.9130    0  597 -11104.360 -3318.9130  70.1%     -  161s
     0     0 -3402.5074    0  590 -11104.360 -3402.5074  69.4%     -  165s
     0     0 -3418.2189    0  590 -11104.360 -3418.2189  69.2%     -  169s
     0     0 -3425.8435    0  605 -11104.360 -3425.8435  69.1%     -  170s
     0     0 -3430.9790    0  592 -11104.360 -3430.9790  69.1%     -  171s
     0     0 -3432.5436    0  601 -11104.360 -3432.5436  69.1%     -  172s
     0     0 -3464.5522    0  591 -11104.360 -3464.5522  68.8%     -  175s
     0     0 -3469.5508    0  593 -11104.360 -3469.5508  68.8%     -  176s
     0     0 -3477.4935    0  589 -11104.360 -3477.4935  68.7%     -  177s
     0     0 -3477.9690    0  587 -11104.360 -3477.9690  68.7%     -  177s
     0     0 -3497.5498    0  580 -11104.360 -3497.5498  68.5%     -  180s
     0     0 -3499.6068    0  586 -11104.360 -3499.6068  68.5%     -  182s
     0     0 -3514.8702    0  583 -11104.360 -3514.8702  68.3%     -  184s
     0     0 -3518.5501    0  599 -11104.360 -3518.5501  68.3%     -  186s
     0     0 -3522.8175    0  594 -11104.360 -3522.8175  68.3%     -  187s
     0     0 -3524.6491    0  590 -11104.360 -3524.6491  68.3%     -  188s
     0     0 -3543.9983    0  588 -11104.360 -3543.9983  68.1%     -  190s
     0     0 -3546.0921    0  598 -11104.360 -3546.0921  68.1%     -  193s
     0     0 -3562.9405    0  576 -11104.360 -3562.9405  67.9%     -  196s
     0     0 -3570.4259    0  585 -11104.360 -3570.4259  67.8%     -  197s
     0     0 -3572.3571    0  584 -11104.360 -3572.3571  67.8%     -  198s
     0     0 -3576.7781    0  591 -11104.360 -3576.7781  67.8%     -  199s
     0     0 -3578.3239    0  591 -11104.360 -3578.3239  67.8%     -  201s
     0     2 -3578.3239    0  591 -11104.360 -3578.3239  67.8%     -  258s
     1     4 -3652.1808    1  568 -11104.360 -3578.3239  67.8%  3557  260s
     3     6 -3786.8526    2  564 -11104.360 -3652.6252  67.1%  3521  266s
     5    11 -4018.4197    3  477 -11104.360 -3652.6252  67.1%  4800  273s
    10    22 -4242.5137    4  482 -11104.360 -3850.7324  65.3%  5452  280s
    21    33 -4392.5241    4  481 -11104.360 -4171.8661  62.4%  8926  296s
    32    64 -6006.4777    6  381 -11104.360 -4171.8661  62.4%  7921  336s
    63    96 -6066.2494    7  374 -11104.360 -4202.0084  62.2% 12048  344s
    95   126 -6300.9241    8  371 -11104.360 -4230.4079  61.9% 10454  358s
   125   168 -6436.6463    9  381 -11104.360 -4230.4079  61.9%  8874  370s
   167   208 -6610.6172   10  369 -11104.360 -4230.4079  61.9%  7321  383s
   207   249 -7231.6267   11  227 -11104.360 -4230.4079  61.9%  7061  394s
   248   294 -7944.4325   12  239 -11104.360 -4230.4079  61.9%  6508  406s
   299   320 -7259.4561   12  220 -11104.360 -4230.4079  61.9%  6116  418s
   329   353 -8230.1256   13  228 -11104.360 -4230.4079  61.9%  6090  432s
   372   393 -7649.7301   14  226 -11104.360 -4230.4079  61.9%  5933  442s
   424   438 -8295.2016   17  185 -11104.360 -4356.3472  60.8%  5827  454s
   483   487 -9759.5648   20  192 -11104.360 -4356.3472  60.8%  5646  466s
   543   541     cutoff   24      -11104.360 -4356.3472  60.8%  5449  477s
   607   599 -10460.630   27  168 -11104.360 -4356.3472  60.8%  5303  487s
   685   653     cutoff   28      -11104.360 -4446.5370  60.0%  5083  495s
   749   700 -5025.8906    7  624 -11104.360 -4454.5803  59.9%  5061  505s
   813   764 -5206.9492    9  634 -11104.360 -4454.5803  59.9%  5028  513s
   885   813 -5519.5153   11  540 -11104.360 -4463.0693  59.8%  4925  524s
   976   845 -6279.6273   12  377 -11104.360 -4463.0693  59.8%  4761  535s
  1056   889 -7205.4708   14  379 -11104.360 -4486.5121  59.6%  4744  546s
  1128   939 -7484.4228   15  364 -11104.360 -4548.1855  59.0%  4726  557s
  1196   991 -7658.7052   16  360 -11104.360 -4548.1855  59.0%  4739  568s
  1288  1048 -7885.7403   18  424 -11104.360 -4548.1855  59.0%  4707  581s
  1359  1127 -8650.4721   20  498 -11104.360 -4548.1855  59.0%  4751  592s
  1475  1172 -8978.0695   22  504 -11104.360 -4548.1855  59.0%  4639  603s
  1586  1244     cutoff   24      -11104.360 -4835.0487  56.5%  4584  615s
  1708  1310 -10649.275   24  371 -11104.360 -4845.1643  56.4%  4559  629s
  1866  1401 -11049.348   26  353 -11104.360 -4854.8527  56.3%  4480  642s
  2025  1472 -7069.7764    9  454 -11104.360 -4855.1559  56.3%  4441  654s
  2196  1503 -8709.2284   12  442 -11104.360 -4907.1677  55.8%  4369  669s
  2315  1571 -10600.683   15  425 -11104.360 -4992.2568  55.0%  4412  685s
  2421  1622 -10367.789   26  477 -11104.360 -4992.2568  55.0%  4518  700s
  2525  1691 -10400.238   27  480 -11104.360 -4992.2568  55.0%  4569  716s
  2662  1764 infeasible   29      -11104.360 -4992.2568  55.0%  4607  732s
  2813  1851 -7486.7667    9  343 -11104.360 -4992.2568  55.0%  4623  749s
  2999  1907 -8776.7269   11  481 -11104.360 -4992.2568  55.0%  4601  766s
  3129  1984 -9351.4678   12  411 -11104.360 -5025.7710  54.7%  4639  785s
  3263  2048 -8141.4334   11  329 -11104.360 -5025.7710  54.7%  4700  805s
  3408  2118 -10685.746   15  138 -11104.360 -5294.1444  52.3%  4736  826s
  3598  2171 -9529.7993   16  166 -11104.360 -5294.1444  52.3%  4732  846s
  3784  2253 -7947.0144    7  207 -11104.360 -5484.4863  50.6%  4739  869s
  3964  2285     cutoff   11      -11104.360 -5544.4006  50.1%  4764  891s
  4119  2337 -10377.375   12  103 -11104.360 -5544.4006  50.1%  4818  915s
  4322  2410 -10286.283   11  191 -11104.360 -5646.8941  49.1%  4842  941s
  4525  2489 -8547.2143   16  361 -11104.360 -5646.8941  49.1%  4879  968s
  4723  2549 -9311.8302   18  215 -11104.360 -5747.7097  48.2%  4905  992s
  4928  2605     cutoff   21      -11104.360 -5747.7097  48.2%  4934 1023s
  5140  2646 -9154.0053   14  490 -11104.360 -5747.7097  48.2%  4977 1045s
  5304  2710 -9360.9189   15  488 -11104.360 -5747.7097  48.2%  4976 1072s
  5544  2761 -10516.496   19  380 -11104.360 -5747.7097  48.2%  4979 1102s
  5822  2789 -10887.664   15  136 -11104.360 -5937.3409  46.5%  4988 1131s
  6058  2844 -7528.6699   10  324 -11104.360 -6099.2908  45.1%  5020 1161s
  6320  2930 -8413.8557   14  280 -11104.360 -6099.2908  45.1%  5043 1193s
  6556  2931 -7540.9063   13  591 -11104.360 -6100.6324  45.1%  5080 1276s
  6558  2932 -6901.5562   13  178 -11104.360 -6100.6324  45.1%  5078 1316s
  6559  2933 -10014.363   22  438 -11104.360 -6100.6324  45.1%  5077 1337s
  6560  2934 -10542.645   12  420 -11104.360 -6100.6324  45.1%  5077 1360s
  6561  2934 -10281.312   55  569 -11104.360 -6100.6324  45.1%  5076 1369s
  6562  2935 -6539.1313    7  548 -11104.360 -6100.6324  45.1%  5075 1378s
  6563  2936 -10163.964   31  565 -11104.360 -6100.6324  45.1%  5074 1383s
  6564  2936 -8966.9946   36  555 -11104.360 -6100.6324  45.1%  5074 1388s
  6565  2937 -8631.4545   18  587 -11104.360 -6100.6324  45.1%  5073 1392s
  6566  2938 -6748.2881   14  598 -11104.360 -6100.6324  45.1%  5072 1397s
  6567  2938 -8428.2720   14  585 -11104.360 -6100.6324  45.1%  5071 1400s
  6569  2940 -7392.8500   19  598 -11104.360 -6100.6324  45.1%  5070 1405s
  6571  2941 -8434.0787   18  567 -11104.360 -6100.6324  45.1%  5068 1417s
  6572  2942 -9896.1608   17  567 -11104.360 -6100.6324  45.1%  5067 1420s
  6574  2943 -9919.9467   25  564 -11104.360 -6100.6324  45.1%  5066 1425s
  6575  2944 -10111.955   22  655 -11104.360 -6100.6324  45.1%  5065 1436s
  6577  2945 -8352.8797   18  581 -11104.360 -6100.6324  45.1%  5064 1441s
  6579  2946 -10904.640   60  621 -11104.360 -6100.6324  45.1%  5062 1452s
  6580  2947 -10543.413   13  623 -11104.360 -6100.6324  45.1%  5061 1455s
  6581  2948 -6884.9399    9  576 -11104.360 -6100.6324  45.1%  5060 1463s
  6582  2948 -6961.8605   12  691 -11104.360 -6100.6324  45.1%  5060 1465s
  6584  2950 -8500.5533   13  571 -11104.360 -6100.6324  45.1%  5058 1479s
  6585  2950 -7352.3751    7  654 -11104.360 -6100.6324  45.1%  5057 1482s
  6586  2951 -10398.810   13  582 -11104.360 -6100.6324  45.1%  5057 1486s
  6587  2952 -6791.6882   18  569 -11104.360 -6100.6324  45.1%  5056 1492s
  6588  2952 -9562.8198   16  574 -11104.360 -6100.6324  45.1%  5055 1495s
  6589  2953 -9757.0405   22  570 -11104.360 -6100.6324  45.1%  5054 1500s
  6591  2954 -7062.4820   20  590 -11104.360 -6100.6324  45.1%  5053 1507s
  6592  2955 -9747.9475   11  586 -11104.360 -6100.6324  45.1%  5052 1510s
  6594  2956 -8338.1659   34  587 -11104.360 -6100.6324  45.1%  5051 1557s
  6595  2957 -9028.0822   16  587 -11104.360 -6100.6324  45.1%  5050 1591s
  6596  2961 -6100.6324   12  579 -11104.360 -6100.6324  45.1%  5092 1612s
  6598  2964 -6100.6324   13  553 -11104.360 -6100.6324  45.1%  5092 1622s
  6602  2971 -6100.6324   14  564 -11104.360 -6100.6324  45.1%  5093 1633s
  6610  2984 -6100.6324   15  547 -11104.360 -6100.6324  45.1%  5097 1651s
  6626  2998 -9328.9203   16  202 -11104.360 -6100.6324  45.1%  5107 1680s
  6645  3020 -6852.5369   17  397 -11104.360 -6100.6324  45.1%  5136 1697s
  6677  3103 -7175.9753   18  389 -11104.360 -6100.6324  45.1%  5141 1718s
  6812  3058 -7634.5878   23  257 -11104.360 -6100.6324  45.1%  5125 1729s
  6879  3041 -8770.7775   19  197 -11104.360 -6100.6324  45.1%  5118 1742s
  6932  3029 -9171.2849   20  188 -11104.360 -6100.6324  45.1%  5125 1754s
  6979  3019 -9998.4881   20  147 -11104.360 -6100.6324  45.1%  5135 1771s
  7027  3014 infeasible   21      -11104.360 -6100.6324  45.1%  5145 1783s
  7071  3010     cutoff   22      -11104.360 -6100.6324  45.1%  5171 1796s
  7115  3003     cutoff   22      -11104.360 -6100.6324  45.1%  5176 1807s
  7162  2992 -10343.824   23  143 -11104.360 -6100.6324  45.1%  5179 1819s
  7217  2977     cutoff   23      -11104.360 -6100.6324  45.1%  5185 1832s
  7263  2962 -9096.0178   23  402 -11104.360 -6100.6324  45.1%  5196 1844s
  7295  2948 -9277.0622   24  403 -11104.360 -6100.6324  45.1%  5206 1861s
  7342  2953 -10773.509   25  331 -11104.360 -6100.6324  45.1%  5214 1873s
  7396  2932 infeasible   26      -11104.360 -6100.6324  45.1%  5216 1889s
  7451  2917 -9729.2860   25  177 -11104.360 -6100.6324  45.1%  5231 1903s
  7509  2904 -10549.124   26  183 -11104.360 -6100.6324  45.1%  5234 1915s
  7548  2891     cutoff   27      -11104.360 -6100.6324  45.1%  5247 1929s
  7588  2886 -11014.155   27  158 -11104.360 -6100.6324  45.1%  5269 1951s
  7623  2878 infeasible   28      -11104.360 -6100.6324  45.1%  5284 1963s
  7667  2856 -9249.8096   21  395 -11104.360 -6100.6324  45.1%  5280 1975s
  7707  2853     cutoff   22      -11104.360 -6100.6324  45.1%  5290 1988s
  7758  2854 -9498.3204   21  372 -11104.360 -6100.6324  45.1%  5302 2002s
  7808  2849 -9579.5231   22  562 -11104.360 -6100.6324  45.1%  5313 2017s
  7844  2852 -9783.1060   23  445 -11104.360 -6100.6324  45.1%  5325 2030s
  7890  2829 -10500.564   24  348 -11104.360 -6100.6324  45.1%  5334 2047s
  7953  2804 infeasible   25      -11104.360 -6100.6324  45.1%  5345 2064s
  8032  2782     cutoff   25      -11104.360 -6100.6324  45.1%  5353 2080s
  8097  2770     cutoff   23      -11104.360 -6100.6324  45.1%  5363 2099s
  8169  2749 infeasible   22      -11104.360 -6192.0696  44.2%  5385 2118s
  8223  2738 -7203.1762   18  503 -11104.360 -6192.0696  44.2%  5403 2137s
  8311  2723 -8345.4511   19  472 -11104.360 -6192.0696  44.2%  5423 2159s
  8382  2702 -8547.0782   20  397 -11104.360 -6868.0705  38.1%  5453 2178s
  8449  2680 -10363.543   21  399 -11104.360 -7133.5158  35.8%  5478 2199s
  8537  2644 -10586.051   22  396 -11104.360 -7133.5158  35.8%  5510 2225s
  8628  2610 infeasible   23      -11104.360 -7203.8894  35.1%  5509 2248s
  8729  2573 -10409.945   18  435 -11104.360 -7203.8894  35.1%  5540 2270s
  8792  2556     cutoff   19      -11104.360 -7203.8894  35.1%  5556 2294s
  8875  2521 -10072.762   22  448 -11104.360 -8721.2978  21.5%  5592 2317s
  9003  2478 -10671.409   25  345 -11104.360 -8721.2978  21.5%  5608 2339s
  9130  2397     cutoff   24      -11104.360 -8937.5350  19.5%  5637 2362s
  9261  2323 -10597.848   24  630 -11104.360 -8937.5350  19.5%  5674 2388s
  9418  2253     cutoff   26      -11104.360 -8937.5350  19.5%  5700 2407s
  9498  2167 -10638.130   18  190 -11104.360 -9234.5277  16.8%  5716 2432s
  9677  2032 -10875.726   20  125 -11104.360 -9619.8945  13.4%  5718 2457s
  9871  1889     cutoff   18      -11104.360 -10016.281  9.80%  5694 2478s
 10022  1815 -10962.544   30  202 -11104.360 -10098.454  9.06%  5673 2492s

Cutting planes:
  Learned: 1
  Gomory: 3
  Projected implied bound: 67
  MIR: 1046
  Mixing: 3
  Flow cover: 1705
  RLT: 10
  Relax-and-lift: 174

Explored 10062 nodes (57300228 simplex iterations) in 2492.75 seconds (6984.99 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -11104.4 -11210.4 -11231.6 ... -96734.2
No other solutions better than -11104.4

Optimal solution found (tolerance 1.00e-04)
Best objective -1.110435953848e+04, best bound -1.110435953848e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 2492.77s
  Master Objective (UB) = -11104.36, θ = 113653.52
  Upper Bound (UB) = -11104.36

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 113653.52
  [DEBUG]   ✓ Scenario 0: θ = 113653.52 ≤ Q = 113653.52 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 113653.52 ≤ Q = 113653.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 113653.52 ≤ Q = 113653.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 113653.52 ≤ Q = 113653.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 113653.52 ≤ Q = 113653.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 113653.52 ≤ Q = 113653.52 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 113653.52 ≤ Q = 113653.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 113653.52 ≤ Q = 113653.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 113653.52 ≤ Q = 113653.52 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x7fe7f4f0
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x7fe7f4f0
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.250724e+13
Presolve removed 2589 rows and 1882 columns
Presolve time: 0.00s
Presolved: 504 rows, 507 columns, 1421 nonzeros
Found heuristic solution: objective 6322849.8926
Variable types: 343 continuous, 164 integer (164 binary)

Root relaxation: objective -1.247365e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -124736.50    0  123 6322849.89 -124736.50   102%     -    0s
H    0     0                    -89502.92020 -124736.50  39.4%     -    0s
H    0     0                    -90429.30814 -124736.50  37.9%     -    0s
     0     0 -105313.40    0   42 -90429.308 -105313.40  16.5%     -    0s
H    0     0                    -104616.6493 -105306.31  0.66%     -    0s
     0     0 -105151.78    0   31 -104616.65 -105151.78  0.51%     -    0s
     0     0 -105049.21    0   16 -104616.65 -105049.21  0.41%     -    0s
     0     0 -105049.16    0   16 -104616.65 -105049.16  0.41%     -    0s
H    0     0                    -104954.5482 -105049.16  0.09%     -    0s
     0     0 -104967.02    0    4 -104954.55 -104967.02  0.01%     -    0s
     0     0          -    0      -104954.55 -104964.44  0.01%     -    0s

Explored 1 nodes (495 simplex iterations) in 0.05 seconds (0.02 work units)
Thread count was 32 (of 256 available processors)

Solution count 7: -104955 -104743 -104568 ... 1.25072e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.049545482214e+05, best bound -1.049644361231e+05, gap 0.0094%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 101435.79
  Scenario: 19 demand increases, 41 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -104954.55
  [DEBUG]   S×d_nominal = 206390.34
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 206390.34 + -104954.55 = 101435.79
  [DEBUG]   Current θ from Master = 113653.52
  [DEBUG]   ⚠️  Z_SP ≤ θ by 12217.73 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -23322.09
  Lower Bound (LB) = -13476.62
  Gap (UB-LB) = 2372.2564, Absolute Gap = 2372.2564, Relative Gap = 0.213633
  Not converged yet (gap = 2372.26 > ε = 200)

  [DEBUG] Adding NEW scenario 9 to Master Problem...
  [DEBUG] New scenario pattern: 19 increases, 41 decreases
    [DEBUG] Scenario 9 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 9 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 9]
    [DEBUG]   - Total constraints in model: 154283
    [DEBUG]   - Total variables in model: 64660
  [DEBUG] Total scenarios in Master: 10
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 10
================================================================================
[Iteration 10] Solving Master Problem...
  Current scenarios in Master: 10
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 154283 rows, 64660 columns and 437889 nonzeros
Model fingerprint: 0xa1a33033
Variable types: 62401 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-03, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 68720 rows and 27900 columns
Presolve time: 0.99s
Presolved: 85563 rows, 36760 columns, 522559 nonzeros
Variable types: 34501 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -367655.1550
Found heuristic solution: objective -196432.4631

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.16s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.802e+06
 Factor NZ  : 8.188e+06 (roughly 120 MB of memory)
 Factor Ops : 1.461e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.72293506e+07  1.51210072e+08  8.69e+04 2.01e+01  7.14e+04     2s
   1  -1.26672300e+07  1.33090514e+08  5.91e+04 6.19e+01  4.81e+04     2s
   2  -4.22410534e+06  1.03575229e+08  1.95e+04 2.52e-11  1.68e+04     2s
   3  -6.78254082e+05  7.12755269e+07  1.27e+03 1.62e-01  1.47e+03     2s
   4  -4.52022707e+05  5.18824581e+07  3.49e+02 1.15e-01  5.97e+02     2s
   5  -4.09953686e+05  3.57049925e+07  2.29e+02 8.35e-02  3.89e+02     2s
   6  -3.39897074e+05  2.58088358e+07  7.84e+01 5.46e-02  2.17e+02     2s
   7  -2.73960793e+05  2.03287834e+07  2.60e+01 4.15e-02  1.46e+02     2s
   8  -1.69701246e+05  1.32969514e+07  9.83e-08 2.62e-02  8.57e+01     2s
   9  -1.13565002e+05  5.11751789e+06  1.25e-07 9.88e-03  3.33e+01     2s
  10  -7.67479547e+04  2.45917193e+06  8.58e-08 4.62e-03  1.61e+01     2s
  11  -4.70603299e+04  1.46269416e+06  5.20e-08 2.79e-03  9.60e+00     2s
  12  -3.39159623e+04  4.75009779e+05  3.72e-08 9.81e-04  3.24e+00     2s
  13  -2.46580385e+04  2.36737094e+05  2.40e-08 6.22e-04  1.66e+00     2s
  14  -1.76037501e+04  1.53105185e+05  1.66e-08 3.97e-04  1.09e+00     2s
  15  -1.28712643e+04  1.17715006e+05  1.28e-08 2.93e-04  8.30e-01     2s
  16  -7.47089318e+03  7.07809735e+04  9.26e-09 9.27e-04  4.98e-01     2s
  17  -3.12083855e+03  5.08314325e+04  6.54e-09 6.48e-04  3.43e-01     2s
  18   5.20948921e+02  3.84058627e+04  4.75e-09 4.38e-04  2.41e-01     2s
  19   3.52138820e+03  3.23785214e+04  3.33e-09 3.41e-04  1.84e-01     2s
  20   4.77544120e+03  2.88518846e+04  2.74e-09 2.82e-04  1.53e-01     2s
  21   6.03589590e+03  2.51320009e+04  2.22e-09 2.21e-04  1.21e-01     2s
  22   7.47447589e+03  2.16078018e+04  1.66e-09 1.62e-04  8.99e-02     3s
  23   8.91632229e+03  1.90270542e+04  1.13e-09 1.07e-04  6.43e-02     3s
  24   1.00349525e+04  1.73659030e+04  7.52e-10 7.96e-05  4.66e-02     3s
  25   1.05712427e+04  1.60481285e+04  5.71e-10 5.90e-05  3.48e-02     3s
  26   1.08599204e+04  1.49121604e+04  4.75e-10 4.26e-05  2.58e-02     3s
  27   1.12440409e+04  1.41444458e+04  3.56e-10 2.94e-05  1.84e-02     3s
  28   1.16535397e+04  1.37673367e+04  2.38e-10 2.25e-05  1.34e-02     3s
  29   1.17875883e+04  1.32372785e+04  1.98e-10 1.29e-05  9.22e-03     3s
  30   1.19247114e+04  1.30150091e+04  1.53e-10 9.11e-06  6.93e-03     3s
  31   1.20642902e+04  1.28436402e+04  1.10e-10 6.34e-06  4.96e-03     3s
  32   1.21099001e+04  1.28009522e+04  9.66e-11 5.62e-06  4.39e-03     3s
  33   1.21580648e+04  1.27593093e+04  8.26e-11 4.94e-06  3.82e-03     3s
  34   1.22270872e+04  1.26898403e+04  6.25e-11 3.78e-06  2.94e-03     3s
  35   1.22826957e+04  1.26251878e+04  4.63e-11 2.71e-06  2.18e-03     3s
  36   1.22970905e+04  1.25780747e+04  4.25e-11 1.94e-06  1.79e-03     3s
  37   1.23784152e+04  1.25065847e+04  2.07e-11 7.04e-07  8.15e-04     3s
  38   1.24227634e+04  1.25023778e+04  1.31e-07 6.36e-07  5.06e-04     3s
  39   1.24353827e+04  1.24753689e+04  1.22e-07 2.10e-07  2.54e-04     3s
  40   1.24496094e+04  1.24657494e+04  6.21e-08 4.84e-07  1.03e-04     3s
  41   1.24559182e+04  1.24627798e+04  4.52e-08 1.27e-07  4.36e-05     3s
  42   1.24603756e+04  1.24624268e+04  3.25e-08 7.13e-08  1.30e-05     3s
  43   1.24619955e+04  1.24620466e+04  2.35e-09 5.54e-09  3.25e-07     3s
  44   1.24620370e+04  1.24620373e+04  1.12e-08 1.13e-09  2.21e-09     3s
  45   1.24620373e+04  1.24620373e+04  2.16e-08 4.14e-11  1.17e-10     3s

Barrier solved model in 45 iterations and 3.24 seconds (7.63 work units)
Optimal objective 1.24620373e+04

Concurrent spin time: 0.03s

Solved with barrier

Root relaxation: objective 1.246204e+04, 35640 iterations, 3.06 seconds (7.90 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 12462.0373    0  273 -196432.46 12462.0373   106%     -    4s
H    0     0                    -188766.7311 12462.0373   107%     -    4s
H    0     0                    -159446.4192 12462.0373   108%     -    4s
H    0     0                    -148191.8271 12462.0373   108%     -    5s
H    0     0                    -141704.5615 12462.0373   109%     -    5s
H    0     0                    -141661.9175 12462.0373   109%     -    5s
H    0     0                    -98233.11561 12462.0373   113%     -    5s
H    0     0                    -97962.00314 12462.0373   113%     -    5s
H    0     0                    -43561.31438 12462.0373   129%     -    5s
H    0     0                    -39713.36851 12462.0373   131%     -    5s
H    0     0                    -38464.64854 12462.0373   132%     -    6s
H    0     0                    -38355.69055 12462.0373   132%     -    6s
H    0     0                    -37826.88922 12462.0373   133%     -    6s
H    0     0                    -37708.97052 12462.0373   133%     -    6s
H    0     0                    -37645.38328 12462.0373   133%     -    6s
H    0     0                    -37640.27888 12462.0373   133%     -    6s
H    0     0                    -29833.62208 12462.0373   142%     -    6s
H    0     0                    -19773.12935 12462.0373   163%     -    6s
H    0     0                    -19768.64596 12462.0373   163%     -    6s
     0     0 7186.77628    0  385 -19768.646 7186.77628   136%     -   22s
H    0     0                    -18649.59361 7182.06545   139%     -   23s
H    0     0                    -18414.32874 7182.06545   139%     -   23s
H    0     0                    -18410.43581 7182.06545   139%     -   23s
     0     0 6946.73188    0  381 -18410.436 6946.73188   138%     -   30s
     0     0 6869.89343    0  552 -18410.436 6869.89343   137%     -   35s
     0     0 6810.69089    0  549 -18410.436 6810.69089   137%     -   38s
     0     0 6736.99215    0  548 -18410.436 6736.99215   137%     -   41s
     0     0 6723.31509    0  550 -18410.436 6723.31509   137%     -   42s
     0     0 6695.92332    0  550 -18410.436 6695.92332   136%     -   43s
     0     0 6693.89030    0  550 -18410.436 6693.89030   136%     -   44s
     0     0 6693.89030    0  396 -18410.436 6693.89030   136%     -   48s
     0     0 6692.31607    0  396 -18410.436 6692.31607   136%     -   50s
     0     0 6691.73911    0  396 -18410.436 6691.73911   136%     -   50s
H    0     0                    -18040.89127 3118.24948   117%     -   68s
H    0     0                    -17210.69990 3118.24948   118%     -   68s
     0     0 3118.24948    0  552 -17210.700 3118.24948   118%     -   68s
H    0     0                    -12077.42025 3116.86683   126%     -   68s
H    0     0                    -11782.41791 3116.86683   126%     -   68s
     0     0 2749.85396    0  550 -11782.418 2749.85396   123%     -   74s
     0     0 2679.12113    0  515 -11782.418 2679.12113   123%     -   78s
     0     0 2556.63896    0  488 -11782.418 2556.63896   122%     -   83s
     0     0 2511.60751    0  491 -11782.418 2511.60751   121%     -   87s
     0     0 2311.63593    0  505 -11782.418 2311.63593   120%     -   92s
     0     0 2284.13741    0  511 -11782.418 2284.13741   119%     -   95s
     0     0 2266.45344    0  514 -11782.418 2266.45344   119%     -   97s
     0     0 2264.87476    0  505 -11782.418 2264.87476   119%     -   98s
     0     0 2252.62151    0  504 -11782.418 2252.62151   119%     -   99s
     0     0 2251.75575    0  507 -11782.418 2251.75575   119%     -  100s
     0     0  233.50216    0  605 -11782.418  233.50216   102%     -  138s
H    0     0                    -11716.92953  233.42190   102%     -  138s
H    0     0                    -11712.68053  233.42190   102%     -  138s
H    0     0                    -11706.40399  233.42190   102%     -  138s
     0     0 -337.75909    0  593 -11706.404 -337.75909  97.1%     -  154s
     0     0 -502.19928    0  612 -11706.404 -502.19928  95.7%     -  161s
     0     0 -587.42497    0  546 -11706.404 -587.42497  95.0%     -  164s
     0     0 -596.33666    0  563 -11706.404 -596.33666  94.9%     -  166s
     0     0 -599.81698    0  532 -11706.404 -599.81698  94.9%     -  167s
     0     0 -600.44244    0  541 -11706.404 -600.44244  94.9%     -  168s
H    0     0                    -11623.48292 -1531.9471  86.8%     -  190s
H    0     0                    -11585.45162 -1531.9471  86.8%     -  190s
     0     0 -1531.9471    0  461 -11585.452 -1531.9471  86.8%     -  190s
     0     0 -1990.0545    0  475 -11585.452 -1990.0545  82.8%     -  206s
     0     0 -2146.1673    0  633 -11585.452 -2146.1673  81.5%     -  215s
     0     0 -2213.7009    0  636 -11585.452 -2213.7009  80.9%     -  221s
     0     0 -2238.6781    0  635 -11585.452 -2238.6781  80.7%     -  225s
     0     0 -2257.0749    0  640 -11585.452 -2257.0749  80.5%     -  228s
     0     0 -2268.5390    0  631 -11585.452 -2268.5390  80.4%     -  231s
     0     0 -2284.3157    0  628 -11585.452 -2284.3157  80.3%     -  232s
     0     0 -2343.8268    0  555 -11585.452 -2343.8268  79.8%     -  237s
     0     0 -2396.8957    0  629 -11585.452 -2396.8957  79.3%     -  245s
     0     0 -2431.9320    0  630 -11585.452 -2431.9320  79.0%     -  248s
     0     0 -2444.8610    0  640 -11585.452 -2444.8610  78.9%     -  250s
     0     0 -2448.4097    0  645 -11585.452 -2448.4097  78.9%     -  250s
     0     0 -2449.5892    0  641 -11585.452 -2449.5892  78.9%     -  251s
     0     0 -2689.4742    0  547 -11585.452 -2689.4742  76.8%     -  258s
     0     0 -2772.9258    0  558 -11585.452 -2772.9258  76.1%     -  263s
     0     0 -2802.4747    0  586 -11585.452 -2802.4747  75.8%     -  265s
     0     0 -2812.9045    0  574 -11585.452 -2812.9045  75.7%     -  267s
     0     0 -2825.8960    0  576 -11585.452 -2825.8960  75.6%     -  268s
     0     0 -2859.1882    0  583 -11585.452 -2859.1882  75.3%     -  270s
     0     0 -2866.6119    0  581 -11585.452 -2866.6119  75.3%     -  272s
     0     0 -2870.4751    0  588 -11585.452 -2870.4751  75.2%     -  273s
     0     0 -2870.8344    0  590 -11585.452 -2870.8344  75.2%     -  273s
     0     0 -3066.9695    0  574 -11585.452 -3066.9695  73.5%     -  281s
     0     0 -3107.1614    0  579 -11585.452 -3107.1614  73.2%     -  287s
     0     0 -3134.9299    0  574 -11585.452 -3134.9299  72.9%     -  289s
     0     0 -3140.7162    0  577 -11585.452 -3140.7162  72.9%     -  290s
     0     0 -3145.6470    0  576 -11585.452 -3145.6470  72.8%     -  291s
     0     0 -3147.6923    0  587 -11585.452 -3147.6923  72.8%     -  292s
     0     0 -3240.8512    0  561 -11585.452 -3240.8512  72.0%     -  297s
     0     0 -3265.8873    0  557 -11585.452 -3265.8873  71.8%     -  300s
     0     0 -3271.9022    0  578 -11585.452 -3271.9022  71.8%     -  302s
     0     0 -3275.1048    0  582 -11585.452 -3275.1048  71.7%     -  303s
     0     0 -3285.1601    0  577 -11585.452 -3285.1601  71.6%     -  304s
     0     0 -3285.4034    0  578 -11585.452 -3285.4034  71.6%     -  304s
     0     0 -3328.3415    0  569 -11585.452 -3328.3415  71.3%     -  310s
     0     0 -3347.2378    0  567 -11585.452 -3347.2378  71.1%     -  314s
     0     0 -3349.4218    0  588 -11585.452 -3349.4218  71.1%     -  315s
     0     0 -3361.0975    0  585 -11585.452 -3361.0975  71.0%     -  319s
     0     0 -3370.7259    0  580 -11585.452 -3370.7259  70.9%     -  321s
     0     0 -3375.7244    0  581 -11585.452 -3375.7244  70.9%     -  323s
     0     0 -3377.1739    0  580 -11585.452 -3377.1739  70.8%     -  324s
     0     0 -3393.1355    0  586 -11585.452 -3393.1355  70.7%     -  327s
     0     0 -3397.5620    0  591 -11585.452 -3397.5620  70.7%     -  329s
     0     0 -3398.6841    0  589 -11585.452 -3398.6841  70.7%     -  330s
     0     0 -3409.4313    0  586 -11585.452 -3409.4313  70.6%     -  333s
     0     0 -3412.0483    0  597 -11585.452 -3412.0483  70.5%     -  335s
     0     0 -3413.3743    0  601 -11585.452 -3413.3743  70.5%     -  336s
     0     0 -3419.8511    0  606 -11585.452 -3419.8511  70.5%     -  339s
     0     0 -3420.0710    0  606 -11585.452 -3420.0710  70.5%     -  341s
     0     2 -3420.0710    0  606 -11585.452 -3420.0710  70.5%     -  409s
     1     4 -3558.7220    1  567 -11585.452 -3420.6470  70.5%  4630  416s
     3     8 -3695.3090    2  579 -11585.452 -3563.3146  69.2%  5767  423s
     7    15 -3892.4638    3  598 -11585.452 -3697.6247  68.1%  6545  435s
    14    28 -4129.5385    4  597 -11585.452 -3894.1132  66.4%  6798  456s
    27    41 -5867.8457    5  244 -11585.452 -3894.1132  66.4% 11770  487s
    40    72 -6633.3301    5  297 -11585.452 -4095.5657  64.6% 11108  555s
    71   121 -6973.8729    6  297 -11585.452 -4095.5772  64.6% 11255  584s
   120   180 -7182.1948    7  293 -11585.452 -4095.5772  64.6% 10098  607s
   185   235 -7246.1365    8  301 -11585.452 -4095.5772  64.6%  8494  631s
   254   266 -8010.8726    9  274 -11585.452 -4095.5772  64.6%  8076  652s
   295   331 -8801.8970   10  271 -11585.452 -4095.5772  64.6%  7608  675s
   371   371 -9301.4330   11  179 -11585.452 -4095.5772  64.6%  6779  697s
   446   400 -9937.9472   13  152 -11585.452 -4095.5772  64.6%  6218  717s
   507   417     cutoff   14      -11585.452 -4095.5772  64.6%  5897  742s
   582   443 -9913.0613   13  434 -11585.452 -4095.5772  64.6%  5537  761s
   659   465 -9860.6501   15  381 -11585.452 -4095.5772  64.6%  5228  782s
   722   489 -10084.666   16  455 -11585.452 -4095.5772  64.6%  5058  804s
   787   522 -10147.323   17  438 -11585.452 -4095.5772  64.6%  4903  822s
   846   535 -10572.225   18  439 -11585.452 -4095.5772  64.6%  4763  851s
   888   559 -10577.972   19  359 -11585.452 -4095.5772  64.6%  4728  872s
   954   593 infeasible   21      -11585.452 -4095.5772  64.6%  4616  893s
  1032   612 infeasible   22      -11585.452 -4095.5772  64.6%  4509  912s
  1089   630 infeasible   11      -11585.452 -4095.5772  64.6%  4409  936s
  1158   629 -9317.5964   11  421 -11585.452 -4095.5772  64.6%  4338  960s
  1233   656 -9499.4774   12  405 -11585.452 -4095.5772  64.6%  4294  984s
  1310   672 -11296.490   14  375 -11585.452 -4095.5772  64.6%  4348 1009s
  1390   703 -11429.435   15  386 -11585.452 -4095.5772  64.6%  4348 1035s
  1461   738 -9471.2824   13  187 -11585.452 -4095.5772  64.6%  4357 1064s
  1546   817 -10127.120   14  131 -11585.452 -4095.5772  64.6%  4354 1109s
  1655   856 -11329.337   23  105 -11585.452 -4095.5772  64.6%  4265 1136s
  1753   930 -9233.4470   18  346 -11585.452 -4095.5772  64.6%  4172 1159s
  1874   994 -10613.496   21  142 -11585.452 -4095.5772  64.6%  4074 1184s
  2016  1027 -11399.923   26   93 -11585.452 -4340.2932  62.5%  3975 1219s
  2155  1049 -4751.1218    6  543 -11585.452 -4340.3644  62.5%  3916 1245s
  2243  1073 -10067.295   23  386 -11585.452 -4340.3644  62.5%  3930 1271s
  2341  1104 -5722.6123    7  506 -11585.452 -4340.3644  62.5%  3928 1303s
  2449  1151 -6214.4324    8  500 -11585.452 -4340.3644  62.5%  3951 1335s
  2554  1168 -6364.4606    9  491 -11585.452 -4340.3644  62.5%  3958 1371s
  2653  1211 -7761.1073   10  471 -11585.452 -4340.3644  62.5%  3978 1407s
  2775  1217 -8234.5048   11  455 -11585.452 -4340.3644  62.5%  4002 1441s
  2856  1247 -8399.1658   12  472 -11585.452 -4340.3644  62.5%  4059 1480s
  2945  1254 -8606.1173   14  310 -11585.452 -4340.3644  62.5%  4116 1525s
  3060  1283 -10226.694   17  294 -11585.452 -5722.6344  50.6%  4151 1583s
  3171  1300 infeasible   19      -11585.452 -5722.6344  50.6%  4199 1624s
  3288  1318 -9825.8946   11  546 -11585.452 -6009.0080  48.1%  4255 1667s
  3393  1355 -9943.8050   12  556 -11585.452 -6009.0080  48.1%  4275 1717s
  3539  1405 -10342.419   13  576 -11585.452 -6647.8418  42.6%  4294 1771s
  3708  1467 infeasible   16      -11585.452 -6647.8418  42.6%  4298 1826s
  3944  1478 infeasible   13      -11585.452 -6715.6013  42.0%  4240 1887s
  4087  1504 -10036.534   14  398 -11585.452 -6822.7909  41.1%  4282 1944s
  4248  1550 infeasible   22      -11585.452 -6822.7909  41.1%  4319 2007s
  4502  1560 -10506.457   14  308 -11585.452 -7050.4412  39.1%  4293 2067s
  4612  1605     cutoff   11      -11585.452 -7190.8701  37.9%  4322 2133s
  4806  1614 -10522.527   15  480 -11585.452 -7256.8884  37.4%  4342 2214s
  5001  1626 -11205.650   14  508 -11585.452 -7364.2718  36.4%  4379 2306s
  5191  1656 -10974.178   13  301 -11585.452 -7381.4926  36.3%  4428 2376s
  5475  1713 infeasible    9      -11585.452 -7603.2726  34.4%  4414 2457s
  5760  1715 infeasible   12      -11585.452 -7753.6819  33.1%  4397 2510s
  5822  1732 -8911.9477   10  332 -11585.452 -7753.6819  33.1%  4407 2578s
  5940  1731     cutoff   11      -11585.452 -7753.6819  33.1%  4405 2662s
  6204  1729 -9445.5797   12  353 -11585.452 -7972.3045  31.2%  4401 2744s
  6534  1755 -11029.527   17  205 -11585.452 -8047.7704  30.5%  4411 2834s
  6873  1747 -9799.8624   11  332 -11585.452 -8227.0963  29.0%  4416 2917s
  7161  1728 infeasible   14      -11585.452 -8341.1725  28.0%  4420 3030s
  7499  1725 -11155.548   11  422 -11585.452 -8536.4368  26.3%  4443 3153s
  7876  1716 infeasible   22      -11585.452 -8720.3565  24.7%  4450 3246s
  8313  1733 infeasible   29      -11585.452 -8945.8133  22.8%  4440 3329s
  8810  1655     cutoff   10      -11585.452 -9096.7324  21.5%  4377 3464s
  9219  1583     cutoff   15      -11585.452 -9181.4181  20.8%  4396 3566s
  9759  1508 -11403.043   15  129 -11585.452 -9442.4577  18.5%  4359 3600s

Cutting planes:
  Learned: 4
  Gomory: 19
  Implied bound: 191
  MIR: 2534
  Flow cover: 2782
  RLT: 109
  Relax-and-lift: 646

Explored 10000 nodes (43744818 simplex iterations) in 3600.04 seconds (8072.60 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -11585.5 -11623.5 -11706.4 ... -18410.4

Time limit reached
Best objective -1.158545162317e+04, best bound -9.442457685665e+03, gap 18.4973%
  WARNING: Time limit reached. Using best solution found (gap: 18.50%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = -11585.45, θ = 112849.47
  Upper Bound (UB) = -11585.45

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 112849.47
  [DEBUG]   ✓ Scenario 0: θ = 112849.47 ≤ Q = 112849.47 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 112849.47 ≤ Q = 112849.47 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 112849.47 ≤ Q = 112849.47 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 112849.47 ≤ Q = 113146.90 (slack: 297.43)
  [DEBUG]   ✓ Scenario 4: θ = 112849.47 ≤ Q = 112849.47 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 112849.47 ≤ Q = 112849.47 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 112849.47 ≤ Q = 112849.47 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 112849.47 ≤ Q = 112849.47 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 112849.47 ≤ Q = 112849.47 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 112849.47 ≤ Q = 112849.47 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 10] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0xdb93fed
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x0db93fed
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [7e-14, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-14, 2e+02]
Found heuristic solution: objective 1.249579e+13
Presolve removed 2589 rows and 1882 columns
Presolve time: 0.00s
Presolved: 504 rows, 507 columns, 1421 nonzeros
Found heuristic solution: objective 6277467.4926
Variable types: 343 continuous, 164 integer (164 binary)

Root relaxation: objective -1.251332e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -125133.20    0  123 6277467.49 -125133.20   102%     -    0s
H    0     0                    -89854.38680 -125133.20  39.3%     -    0s
H    0     0                    -90780.77473 -125133.20  37.8%     -    0s
     0     0 -97260.288    0   64 -90780.775 -97260.288  7.14%     -    0s
H    0     0                    -93052.20197 -97236.417  4.50%     -    0s
H    0     0                    -95752.03179 -97236.417  1.55%     -    0s
H    0     0                    -96721.18074 -97236.417  0.53%     -    0s
     0     0 -97016.034    0    7 -96721.181 -97016.034  0.30%     -    0s
     0     0 -97015.645    0    6 -96721.181 -97015.645  0.30%     -    0s
H    0     0                    -96979.22318 -97013.501  0.04%     -    0s
     0     0 -97010.823    0    2 -96979.223 -97010.823  0.03%     -    0s
     0     0 -97005.506    0    9 -96979.223 -97005.506  0.03%     -    0s
     0     0 -96998.088    0    4 -96979.223 -96998.088  0.02%     -    0s
     0     0          -    0      -96979.223 -96985.161  0.01%     -    0s

Cutting planes:
  Gomory: 1
  Implied bound: 2
  RLT: 2
  Relax-and-lift: 1

Explored 1 nodes (485 simplex iterations) in 0.08 seconds (0.03 work units)
Thread count was 32 (of 256 available processors)

Solution count 7: -96979.2 -96926.8 -95752 ... 1.24958e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -9.697922318306e+04, best bound -9.698516106962e+04, gap 0.0061%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 109018.65
  Scenario: 8 demand increases, 52 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -96979.22
  [DEBUG]   S×d_nominal = 205997.87
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 205997.87 + -96979.22 = 109018.65
  [DEBUG]   Current θ from Master = 112849.47
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3830.83 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -15416.28
  Lower Bound (LB) = -13476.62
  Gap (UB-LB) = 1891.1644, Absolute Gap = 1891.1644, Relative Gap = 0.163236
  Not converged yet (gap = 1891.16 > ε = 200)

  [DEBUG] Adding NEW scenario 10 to Master Problem...
  [DEBUG] New scenario pattern: 8 increases, 52 decreases
    [DEBUG] Scenario 10 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 10 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 10]
    [DEBUG]   - Total constraints in model: 169573
    [DEBUG]   - Total variables in model: 70900
  [DEBUG] Total scenarios in Master: 11
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 11
================================================================================
[Iteration 11] Solving Master Problem...
  Current scenarios in Master: 11
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 169573 rows, 70900 columns and 481126 nonzeros
Model fingerprint: 0x436c499c
Variable types: 68641 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-03, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 75608 rows and 30698 columns
Presolve time: 1.10s
Presolved: 93965 rows, 40202 columns, 570277 nonzeros
Variable types: 37943 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -367252.2753
Found heuristic solution: objective -196432.4631

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.19s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 4.354e+06
 Factor NZ  : 9.517e+06 (roughly 130 MB of memory)
 Factor Ops : 1.813e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.72644190e+07  1.64070688e+08  8.71e+04 1.72e+01  7.10e+04     2s
   1  -1.27202411e+07  1.44389227e+08  5.91e+04 6.08e+01  4.78e+04     2s
   2  -4.65578156e+06  1.13015991e+08  2.13e+04 3.43e-11  1.83e+04     2s
   3  -7.17683065e+05  7.52034874e+07  1.40e+03 1.11e+00  1.55e+03     2s
   4  -4.57703621e+05  3.78528167e+07  3.57e+02 3.54e-01  4.76e+02     2s
   5  -3.99159745e+05  2.35109361e+07  2.12e+02 1.88e-01  2.75e+02     2s
   6  -3.02493648e+05  1.97500918e+07  8.22e+01 1.49e-01  1.67e+02     2s
   7  -1.88247847e+05  1.41661168e+07  9.68e+00 1.02e-01  8.82e+01     2s
   8  -1.21849106e+05  8.66861393e+06  1.46e+00 6.04e-02  5.15e+01     2s
   9  -9.39299104e+04  4.69179375e+06  9.32e-01 3.15e-02  2.79e+01     2s
  10  -6.02976393e+04  1.89882512e+06  4.39e-01 1.24e-02  1.14e+01     2s
  11  -3.70783323e+04  5.79282750e+05  2.11e-01 3.62e-03  3.58e+00     2s
  12  -2.82939048e+04  2.04073323e+05  1.26e-01 1.09e-03  1.35e+00     3s
  13  -2.27573978e+04  1.21626079e+05  9.15e-02 1.10e-03  8.38e-01     3s
  14  -1.63322411e+04  8.93454368e+04  6.15e-02 8.90e-04  6.13e-01     3s
  15  -1.15429476e+04  6.96693091e+04  4.84e-02 1.48e-03  4.71e-01     3s
  16  -6.83973864e+03  4.81835053e+04  3.73e-02 1.35e-03  3.19e-01     3s
  17  -2.25981999e+03  3.63030238e+04  2.76e-02 1.65e-03  2.24e-01     3s
  18   3.39721005e+02  2.95291723e+04  2.24e-02 1.13e-03  1.69e-01     3s
  19   2.43251831e+03  2.66265844e+04  1.80e-02 9.65e-04  1.40e-01     3s
  20   4.20766733e+03  2.41889612e+04  1.44e-02 7.99e-04  1.16e-01     3s
  21   5.16371228e+03  2.08568211e+04  1.26e-02 5.72e-04  9.11e-02     3s
  22   6.64166011e+03  1.78771375e+04  1.00e-02 3.69e-04  6.52e-02     3s
  23   7.85410039e+03  1.65771163e+04  8.02e-03 2.70e-04  5.06e-02     3s
  24   8.52920145e+03  1.57139036e+04  6.87e-03 2.42e-04  4.17e-02     3s
  25   9.05601154e+03  1.51303860e+04  5.89e-03 1.89e-04  3.52e-02     3s
  26   1.00638990e+04  1.48042273e+04  4.19e-03 1.89e-04  2.75e-02     3s
  27   1.05239220e+04  1.45651065e+04  3.37e-03 1.69e-04  2.34e-02     3s
  28   1.07866264e+04  1.41822265e+04  2.91e-03 1.36e-04  1.97e-02     3s
  29   1.10051519e+04  1.41134157e+04  2.54e-03 1.30e-04  1.80e-02     3s
  30   1.13098953e+04  1.35284428e+04  2.05e-03 7.71e-05  1.29e-02     3s
  31   1.14390549e+04  1.32343129e+04  1.83e-03 6.09e-05  1.04e-02     3s
  32   1.15825363e+04  1.30901575e+04  1.59e-03 5.03e-05  8.75e-03     3s
  33   1.18684816e+04  1.30027349e+04  1.15e-03 4.07e-05  6.58e-03     3s
  34   1.19248313e+04  1.29038316e+04  1.06e-03 3.09e-05  5.68e-03     3s
  35   1.20505001e+04  1.28627861e+04  8.64e-04 2.65e-05  4.71e-03     3s
  36   1.21463046e+04  1.28163751e+04  7.07e-04 2.17e-05  3.89e-03     3s
  37   1.22205552e+04  1.27826610e+04  5.91e-04 1.99e-05  3.26e-03     3s
  38   1.22772766e+04  1.27295504e+04  5.02e-04 1.40e-05  2.62e-03     3s
  39   1.23664738e+04  1.27015915e+04  3.68e-04 1.06e-05  1.94e-03     3s
  40   1.24064322e+04  1.26803772e+04  3.03e-04 8.16e-06  1.59e-03     3s
  41   1.24513565e+04  1.26591779e+04  2.31e-04 5.94e-06  1.21e-03     4s
  42   1.24810907e+04  1.26329876e+04  1.84e-04 2.94e-06  8.82e-04     4s
  43   1.25272217e+04  1.26211286e+04  1.11e-04 1.62e-06  5.45e-04     4s
  44   1.25391919e+04  1.26134589e+04  9.32e-05 8.87e-07  4.31e-04     4s
  45   1.25852149e+04  1.26115435e+04  2.61e-05 6.65e-07  1.53e-04     4s
  46   1.25998044e+04  1.26066185e+04  5.62e-06 1.94e-07  3.95e-05     4s
  47   1.26043572e+04  1.26045150e+04  5.03e-08 8.44e-09  9.15e-07     4s
  48   1.26044188e+04  1.26044189e+04  4.95e-10 3.90e-09  2.23e-10     4s

Barrier solved model in 48 iterations and 3.76 seconds (8.85 work units)
Optimal objective 1.26044188e+04


Root crossover log...

       0 DPushes remaining with DInf 0.0000000e+00                 5s

    5190 PPushes remaining with PInf 1.4768762e-05                 5s
       0 PPushes remaining with PInf 0.0000000e+00                 5s

  Push phase complete: Pinf 0.0000000e+00, Dinf 5.2042209e+01      5s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   36422    1.2604419e+04   0.000000e+00   5.204221e+01      5s
   36440    1.2604419e+04   0.000000e+00   0.000000e+00      5s
   36440    1.2604419e+04   0.000000e+00   0.000000e+00      5s
Concurrent spin time: 0.36s

Solved with barrier

Root relaxation: objective 1.260442e+04, 36440 iterations, 4.11 seconds (9.83 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 12604.4189    0  430 -196432.46 12604.4189   106%     -    6s
H    0     0                    -189782.9636 12604.4189   107%     -    6s
H    0     0                    -120781.0787 12604.4189   110%     -    6s
H    0     0                    -117607.0037 12604.4189   111%     -    6s
H    0     0                    -84951.15435 12604.4189   115%     -    6s
H    0     0                    -48966.69869 12604.4189   126%     -    6s
H    0     0                    -46087.72084 12604.4189   127%     -    6s
H    0     0                    -45301.34105 12604.4189   128%     -    6s
H    0     0                    -45083.10308 12604.4189   128%     -    7s
H    0     0                    -44923.19484 12604.4189   128%     -    7s
H    0     0                    -44904.12812 12604.4189   128%     -    7s
H    0     0                    -44901.56410 12604.4189   128%     -    7s
H    0     0                    -38415.69694 12604.4189   133%     -    8s
H    0     0                    -38344.97385 12604.4189   133%     -    8s
H    0     0                    -35095.91197 12604.4189   136%     -    8s
H    0     0                    -34930.89146 12604.4189   136%     -    8s
H    0     0                    -34725.97754 12604.4189   136%     -    8s
H    0     0                    -19988.07129 7244.18316   136%     -   28s
H    0     0                    -19789.93692 7244.18316   137%     -   28s
H    0     0                    -19772.57926 7244.18316   137%     -   28s
H    0     0                    -19730.70121 7244.18316   137%     -   28s
H    0     0                    -19713.34355 7244.18316   137%     -   28s
     0     0 7108.92805    0  643 -19713.344 7108.92805   136%     -   28s
H    0     0                    -18108.66576 7108.92805   139%     -   28s
H    0     0                    -17716.01122 7108.92805   140%     -   28s
H    0     0                    -17712.11828 7108.92805   140%     -   28s
H    0     0                    -17699.92172 7108.92805   140%     -   28s
H    0     0                    -17682.62370 7108.92805   140%     -   28s
H    0     0                    -17628.24170 7108.92805   140%     -   28s
H    0     0                    -17627.21440 7108.92805   140%     -   28s
     0     0 6769.01224    0  651 -17627.214 6769.01224   138%     -   43s
     0     0 6620.57496    0  638 -17627.214 6620.57496   138%     -   50s
     0     0 6540.89832    0  631 -17627.214 6540.89832   137%     -   52s
     0     0 6539.18057    0  641 -17627.214 6539.18057   137%     -   54s
H    0     0                    -17495.08046 3997.66103   123%     -   98s
     0     0 3997.66103    0  528 -17495.080 3997.66103   123%     -   98s
H    0     0                    -14302.76675 3997.19957   128%     -   98s
H    0     0                    -14275.55362 3997.19957   128%     -   98s
H    0     0                    -14215.64082 3997.19957   128%     -   98s
H    0     0                    -14147.65115 3997.19957   128%     -   98s
H    0     0                    -14117.18228 3997.19957   128%     -   98s
H    0     0                    -14103.47456 3997.19957   128%     -   98s
     0     0 3197.51779    0  721 -14103.475 3197.51779   123%     -  141s
     0     0 2976.74774    0  641 -14103.475 2976.74774   121%     -  155s
H    0     0                    -13619.60030 2782.85207   120%     -  182s
H    0     0                    -12968.05220 2782.85207   121%     -  182s
H    0     0                    -12761.11794 2782.85207   122%     -  182s
H    0     0                    -12747.83415 2782.85207   122%     -  182s
     0     0 2782.85207    0  702 -12747.834 2782.85207   122%     -  182s
H    0     0                    -12648.71652 2622.53718   121%     -  206s
     0     0 2622.53718    0  699 -12648.717 2622.53718   121%     -  206s
H    0     0                    -12560.67565 2598.97995   121%     -  220s
H    0     0                    -12480.82846 2598.97995   121%     -  220s
     0     0 2598.97995    0  694 -12480.828 2598.97995   121%     -  220s
     0     0 2567.41142    0  687 -12480.828 2567.41142   121%     -  229s
     0     0 2530.83801    0  707 -12480.828 2530.83801   120%     -  240s
     0     0 2490.69479    0  714 -12480.828 2490.69479   120%     -  248s
     0     0 2461.91736    0  706 -12480.828 2461.91736   120%     -  257s
     0     0 2455.15847    0  711 -12480.828 2455.15847   120%     -  259s
     0     0 2453.74350    0  709 -12480.828 2453.74350   120%     -  260s
     0     0 2453.73696    0  710 -12480.828 2453.73696   120%     -  262s
     0     0  596.09728    0  625 -12480.828  596.09728   105%     -  324s
H    0     0                    -12450.48408  596.06370   105%     -  324s
H    0     0                    -12446.51029  596.06370   105%     -  324s
H    0     0                    -12380.57205   24.38802   100%     -  351s
H    0     0                    -12241.22728   24.38802   100%     -  351s
     0     0   24.38802    0  688 -12241.227   24.38802   100%     -  351s
H    0     0                    -12195.71267 -224.49432  98.2%     -  369s
H    0     0                    -12131.68004 -224.49432  98.1%     -  369s
     0     0 -224.49432    0  707 -12131.680 -224.49432  98.1%     -  369s
     0     0 -444.49536    0  626 -12131.680 -444.49536  96.3%     -  382s
     0     0 -477.25108    0  712 -12131.680 -477.25108  96.1%     -  386s
     0     0 -485.86533    0  701 -12131.680 -485.86533  96.0%     -  391s
     0     0 -496.07676    0  634 -12131.680 -496.07676  95.9%     -  392s
     0     0 -511.65438    0  634 -12131.680 -511.65438  95.8%     -  397s
     0     0 -640.49461    0  647 -12131.680 -640.49461  94.7%     -  405s
     0     0 -642.57325    0  634 -12131.680 -642.57325  94.7%     -  409s
     0     0 -649.45796    0  643 -12131.680 -649.45796  94.6%     -  414s
     0     0 -653.81054    0  652 -12131.680 -653.81054  94.6%     -  417s
     0     0 -655.71473    0  639 -12131.680 -655.71473  94.6%     -  418s
     0     0 -655.93854    0  646 -12131.680 -655.93854  94.6%     -  419s
H    0     0                    -12104.29742 -655.93854  94.6%     -  430s
     0     0 -1815.8207    0  555 -12104.297 -1815.8207  85.0%     -  465s
H    0     0                    -11777.22640 -2062.4738  82.5%     -  492s
     0     0 -2062.4738    0  621 -11777.226 -2062.4738  82.5%     -  492s
H    0     0                    -11698.62643 -2201.0597  81.2%     -  499s
     0     0 -2201.0597    0  583 -11698.626 -2201.0597  81.2%     -  499s
     0     0 -2269.9588    0  631 -11698.626 -2269.9588  80.6%     -  506s
H    0     0                    -11659.79153 -2460.8518  78.9%     -  519s
     0     0 -2460.8518    0  641 -11659.792 -2460.8518  78.9%     -  519s
     0     0 -2488.9920    0  623 -11659.792 -2488.9920  78.7%     -  525s
     0     0 -2513.8275    0  548 -11659.792 -2513.8275  78.4%     -  529s
     0     0 -2526.7930    0  695 -11659.792 -2526.7930  78.3%     -  534s
     0     0 -2528.2823    0  630 -11659.792 -2528.2823  78.3%     -  536s
     0     0 -2784.8035    0  548 -11659.792 -2784.8035  76.1%     -  548s
H    0     0                    -11635.83407 -2784.9441  76.1%     -  549s
     0     0 -2853.4626    0  554 -11635.834 -2853.4626  75.5%     -  555s
     0     0 -2870.7810    0  574 -11635.834 -2870.7810  75.3%     -  558s
     0     0 -2873.9841    0  570 -11635.834 -2873.9841  75.3%     -  559s
     0     0 -2876.7004    0  580 -11635.834 -2876.7004  75.3%     -  560s
     0     0 -2880.0184    0  579 -11635.834 -2880.0184  75.2%     -  561s
     0     0 -2881.4216    0  580 -11635.834 -2881.4216  75.2%     -  561s
     0     0 -3001.4360    0  594 -11635.834 -3001.4360  74.2%     -  570s
     0     0 -3042.8600    0  598 -11635.834 -3042.8600  73.8%     -  577s
     0     0 -3051.7161    0  608 -11635.834 -3051.7161  73.8%     -  579s
     0     0 -3056.7277    0  590 -11635.834 -3056.7277  73.7%     -  580s
     0     0 -3059.0209    0  588 -11635.834 -3059.0209  73.7%     -  581s
     0     0 -3132.7839    0  577 -11635.834 -3132.7839  73.1%     -  588s
     0     0 -3141.3807    0  582 -11635.834 -3141.3807  73.0%     -  591s
     0     0 -3148.9536    0  576 -11635.834 -3148.9536  72.9%     -  593s
     0     0 -3149.9887    0  580 -11635.834 -3149.9887  72.9%     -  594s
     0     0 -3206.4150    0  592 -11635.834 -3206.4150  72.4%     -  601s
     0     0 -3224.5998    0  594 -11635.834 -3224.5998  72.3%     -  606s
     0     0 -3230.4987    0  594 -11635.834 -3230.4987  72.2%     -  608s
     0     0 -3238.0150    0  586 -11635.834 -3238.0150  72.2%     -  610s
     0     0 -3241.4279    0  605 -11635.834 -3241.4279  72.1%     -  612s
     0     0 -3242.1794    0  608 -11635.834 -3242.1794  72.1%     -  613s
     0     0 -3271.3459    0  810 -11635.834 -3271.3459  71.9%     -  619s
     0     0 -3280.6457    0  811 -11635.834 -3280.6457  71.8%     -  622s
     0     0 -3283.7516    0  741 -11635.834 -3283.7516  71.8%     -  624s
     0     0 -3284.4641    0  741 -11635.834 -3284.4641  71.8%     -  625s
     0     0 -3301.2961    0  579 -11635.834 -3301.2961  71.6%     -  630s
     0     0 -3303.9566    0  596 -11635.834 -3303.9566  71.6%     -  633s
     0     0 -3305.0326    0  594 -11635.834 -3305.0326  71.6%     -  634s
     0     0 -3317.8081    0  595 -11635.834 -3317.8081  71.5%     -  638s
     0     0 -3320.0724    0  589 -11635.834 -3320.0724  71.5%     -  640s
     0     0 -3340.6247    0  583 -11635.834 -3340.6247  71.3%     -  645s
     0     0 -3340.6593    0  583 -11635.834 -3340.6593  71.3%     -  648s
     0     2 -3340.8405    0  583 -11635.834 -3340.8405  71.3%     -  718s
     1     3 -3986.4572    1  401 -11635.834 -3341.6173  71.3% 14855  731s
     2     6 -5703.2876    2  259 -11635.834 -3341.6173  71.3% 14274  747s
     5    12 -5814.0833    3  252 -11635.834 -3946.4873  66.1% 12182  760s
    11    24 -5929.4685    4  270 -11635.834 -4024.0489  65.4%  9840  776s
    23    36 -5472.8593    4  559 -11635.834 -4072.5729  65.0% 14180  813s
    35    68 -5522.1060    6  540 -11635.834 -4072.5729  65.0% 15058  916s
    67   151 -5549.5886    7  463 -11635.834 -4382.2336  62.3% 19657  950s
   150   236 -5576.4267    8  453 -11635.834 -4382.2792  62.3% 11446  972s
   235   307 -5625.9686    8  452 -11635.834 -4382.2792  62.3%  8891  992s
   319   359 -5938.2836    9  441 -11635.834 -4382.2792  62.3%  7932 1007s
   396   394 -7434.5174   10  167 -11635.834 -4382.2792  62.3%  7362 1024s
   470   413 -8325.9134   11  173 -11635.834 -4382.2792  62.3%  7188 1064s
   509   439 -6232.7808   10  440 -11635.834 -4547.9592  60.9%  7234 1077s
   543   461 -6248.6899   11  439 -11635.834 -4547.9592  60.9%  7408 1091s
   581   487 -6339.8061   12  500 -11635.834 -4547.9592  60.9%  7310 1105s
   615   519 -8382.9009   13  173 -11635.834 -4627.9556  60.2%  7409 1119s
   657   544 -11246.475   14  124 -11635.834 -4627.9556  60.2%  7434 1130s
H  683   544                    -11623.48292 -4640.4153  60.1%  7427 1130s
   694   606 -11288.199   15  126 -11623.483 -4640.4153  60.1%  7372 1146s
   788   649     cutoff   17      -11623.483 -4640.4153  60.1%  7111 1158s
   858   702 infeasible   20      -11623.483 -4640.4153  60.1%  6954 1173s
   937   740 -5260.0477    8  535 -11623.483 -4640.4153  60.1%  6860 1189s
  1027   774 -10516.311   27  298 -11623.483 -4640.4153  60.1%  6734 1205s
  1102   812 -10820.117   30  346 -11623.483 -4640.4153  60.1%  6675 1221s
  1172   883 -11352.541   28  296 -11623.483 -4640.4153  60.1%  6587 1237s
  1267   938 infeasible   30      -11623.483 -4640.4153  60.1%  6538 1253s
  1348  1020 infeasible   30      -11623.483 -4670.7963  59.8%  6398 1273s
  1474  1115 -5040.8028    7  556 -11623.483 -4670.7963  59.8%  6202 1289s
  1629  1193 -5466.0536    8  537 -11623.483 -4670.7963  59.8%  5981 1306s
  1776  1263 -6148.4887   10  441 -11623.483 -4670.7963  59.8%  5805 1326s
  1903  1334 -7498.3475   11  339 -11623.483 -4862.8576  58.2%  5650 1343s
  2057  1346 -9501.4889   13  321 -11623.483 -4862.8576  58.2%  5498 1364s
  2188  1352 -9938.0769   15  302 -11623.483 -4862.8576  58.2%  5440 1385s
  2266  1376 -10027.299   15  293 -11623.483 -4902.5101  57.8%  5508 1409s
  2351  1398 infeasible   16      -11623.483 -4902.5101  57.8%  5592 1436s
  2435  1419 -11144.268   11  259 -11623.483 -4902.5101  57.8%  5710 1462s
  2478  1432 -11278.886   12  230 -11623.483 -4902.5101  57.8%  5831 1487s
  2553  1456 -11372.407   13  252 -11623.483 -5053.2823  56.5%  5888 1514s
H 2565  1456                    -11619.20353 -5053.2823  56.5%  5887 1514s
  2621  1496 -9683.5253   14  331 -11619.204 -5053.2823  56.5%  6006 1539s
  2721  1520 -10419.823   16  292 -11619.204 -5053.2823  56.5%  6114 1564s
  2835  1543 -11369.088   19  162 -11619.204 -5375.0269  53.7%  6186 1591s
  2968  1562 -10044.576   16  268 -11619.204 -5375.0269  53.7%  6229 1620s
  3071  1591 infeasible   18      -11619.204 -5375.0269  53.7%  6305 1651s
  3158  1607 infeasible   21      -11619.204 -5375.0269  53.7%  6403 1681s
  3292  1639 -11508.853   23  231 -11619.204 -5460.7581  53.0%  6474 1713s
  3414  1671 -6805.0126    9  491 -11619.204 -5765.4183  50.4%  6566 1747s
  3544  1688 -8300.8469   11  443 -11619.204 -5765.4183  50.4%  6616 1776s
  3619  1707 -8889.9707   12  440 -11619.204 -5765.4183  50.4%  6669 1811s
  3707  1738 infeasible   14      -11619.204 -5765.4183  50.4%  6718 1845s
  3809  1770     cutoff   16      -11619.204 -5765.4183  50.4%  6862 1880s
  3953  1810 -6934.8721   10  522 -11619.204 -6059.3313  47.9%  6918 1920s
  4167  1868 -9976.8765   12  414 -11619.204 -6059.3313  47.9%  6882 1961s
  4351  1914 -10206.722   13  487 -11619.204 -6059.3313  47.9%  6908 2001s
  4569  1979 infeasible   15      -11619.204 -6104.4998  47.5%  6905 2047s
  4757  2034 -8106.5354    8  315 -11619.204 -6104.4998  47.5%  6950 2094s
  4902  2083 infeasible   10      -11619.204 -6104.4998  47.5%  7009 2141s
  5057  2163 -11536.224   37  257 -11619.204 -6320.0798  45.6%  7043 2190s
  5262  2234 -11357.702    9  360 -11619.204 -6379.1577  45.1%  7078 2239s
  5526  2262 -7616.6804   22  378 -11619.204 -6381.7090  45.1%  7064 2290s
  5751  2337 -9791.8432   26  280 -11619.204 -6395.0410  45.0%  7101 2342s
  5993  2361 -11193.010   31  306 -11619.204 -6395.0410  45.0%  7151 2381s
  6073  2380 -11345.778   32  322 -11619.204 -6395.0410  45.0%  7151 2430s
  6329  2411 -9324.5542   10  117 -11619.204 -6512.1139  44.0%  7143 2484s
  6595  2435 -8403.2728    8  350 -11619.204 -6581.4353  43.4%  7202 2539s
  6805  2510 -7168.1807   13  339 -11619.204 -6662.5097  42.7%  7241 2605s
  7099  2598 infeasible   18      -11619.204 -6662.5097  42.7%  7258 2672s
  7395  2599 -10309.700   18  583 -11619.204 -6690.3997  42.4%  7289 2780s
  7397  2600 -8667.8963   11  233 -11619.204 -6690.3997  42.4%  7287 2793s
  7398  2601 -9728.0267   12  450 -11619.204 -6690.3997  42.4%  7286 2852s
  7399  2602 -10686.319   39  489 -11619.204 -6690.3997  42.4%  7285 2910s
  7400  2602 -11022.243   17  529 -11619.204 -6690.3997  42.4%  7284 2941s
  7401  2603 -11470.967   22  532 -11619.204 -6690.3997  42.4%  7283 2961s
  7402  2604 -9931.9210   19  520 -11619.204 -6690.3997  42.4%  7282 2970s
  7403  2604 -8484.3956   12  530 -11619.204 -6690.3997  42.4%  7281 2977s
  7404  2605 -9370.0695   11  535 -11619.204 -6690.3997  42.4%  7280 2984s
  7405  2606 -10765.196   17  560 -11619.204 -6690.3997  42.4%  7279 2989s
  7406  2606 -11020.060   33  584 -11619.204 -6690.3997  42.4%  7278 3009s
  7407  2607 -7859.5897   13  550 -11619.204 -6690.3997  42.4%  7277 3016s
  7409  2608 -9381.0001   18  545 -11619.204 -6690.3997  42.4%  7275 3023s
  7410  2609 -10069.523   23  541 -11619.204 -6690.3997  42.4%  7274 3029s
  7411  2610 -8518.0552   11  599 -11619.204 -6690.3997  42.4%  7273 3049s
  7412  2610 -9782.8095   22  609 -11619.204 -6690.3997  42.4%  7272 3057s
  7413  2611 -6978.0601   11  610 -11619.204 -6690.3997  42.4%  7271 3063s
  7414  2612 -8953.3804   10  602 -11619.204 -6690.3997  42.4%  7270 3066s
  7415  2612 -9234.5942   12  599 -11619.204 -6690.3997  42.4%  7269 3071s
  7416  2613 -9385.9585   20  570 -11619.204 -6690.3997  42.4%  7268 3087s
  7417  2614 -9887.3552   31  551 -11619.204 -6690.3997  42.4%  7267 3091s
  7419  2615 -10651.993   20  578 -11619.204 -6690.3997  42.4%  7265 3097s
  7420  2616 -7000.5691   10  681 -11619.204 -6690.3997  42.4%  7264 3112s
  7421  2616 -8929.1014   14  618 -11619.204 -6690.3997  42.4%  7264 3117s
  7422  2617 -10485.328   30  602 -11619.204 -6690.3997  42.4%  7263 3133s
  7423  2618 -7848.3179   24  663 -11619.204 -6690.3997  42.4%  7262 3139s
  7424  2618 -10230.140   20  587 -11619.204 -6690.3997  42.4%  7261 3145s
  7425  2619 -7858.8932   15  634 -11619.204 -6690.3997  42.4%  7260 3155s
  7426  2620 -10244.900   33  638 -11619.204 -6690.3997  42.4%  7259 3161s
  7427  2620 -11396.504   38  642 -11619.204 -6690.3997  42.4%  7258 3172s
  7428  2621 -11483.660   40  588 -11619.204 -6690.3997  42.4%  7257 3176s
  7429  2622 -9689.1551   18  584 -11619.204 -6690.3997  42.4%  7256 3184s
  7430  2622 -11262.681   23  584 -11619.204 -6690.3997  42.4%  7255 3206s
  7431  2623 -9298.0758   13  584 -11619.204 -6690.3997  42.4%  7254 3295s
  7432  2626 -6690.3997   16  530 -11619.204 -6690.3997  42.4%  7297 3308s
  7433  2627 -6690.3997   17  407 -11619.204 -6690.3997  42.4%  7296 3342s
  7435  2631 -7428.2687   18  522 -11619.204 -6690.3997  42.4%  7297 3395s
  7439  2638 -7473.4276   19  520 -11619.204 -6690.3997  42.4%  7305 3419s
  7448  2645 -10158.594   20  152 -11619.204 -6690.3997  42.4%  7307 3497s
  7458  2662 -8121.1273   19  275 -11619.204 -6690.3997  42.4%  7320 3570s
  7486  2681 -8310.0591   20  260 -11619.204 -6690.3997  42.4%  7444 3600s

Cutting planes:
  Learned: 1
  Gomory: 3
  Implied bound: 25
  Projected implied bound: 341
  MIR: 1130
  Mixing: 1
  Flow cover: 1989
  RLT: 90
  Relax-and-lift: 273

Explored 7516 nodes (56578335 simplex iterations) in 3600.09 seconds (8810.00 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -11619.2 -11623.5 -11635.8 ... -12241.2

Time limit reached
Best objective -1.161920352911e+04, best bound -6.690399711201e+03, gap 42.4195%
  WARNING: Time limit reached. Using best solution found (gap: 42.42%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.15s
  Master Objective (UB) = -11619.20, θ = 113468.98
  Upper Bound (UB) = -11619.20

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 113468.98
  [DEBUG]   ✓ Scenario 0: θ = 113468.98 ≤ Q = 113468.98 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 113468.98 ≤ Q = 113468.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 113468.98 ≤ Q = 113468.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 113468.98 ≤ Q = 113468.98 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 113468.98 ≤ Q = 113468.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 113468.98 ≤ Q = 113468.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 113468.98 ≤ Q = 113468.98 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 113468.98 ≤ Q = 113468.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 113468.98 ≤ Q = 113468.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 113468.98 ≤ Q = 113468.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 113468.98 ≤ Q = 113468.98 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 11] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x4ef1bd61
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x4ef1bd61
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [2e-10, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.247290e+13
Presolve removed 2586 rows and 1879 columns
Presolve time: 0.01s
Presolved: 507 rows, 510 columns, 1430 nonzeros
Found heuristic solution: objective 6530692.9573
Variable types: 346 continuous, 164 integer (164 binary)

Root relaxation: objective -1.246256e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -124625.58    0  123 6530692.96 -124625.58   102%     -    0s
H    0     0                    -89415.16207 -124625.58  39.4%     -    0s
H    0     0                    -90335.15048 -124625.58  38.0%     -    0s
     0     0 -94180.512    0   91 -90335.150 -94180.512  4.26%     -    0s
H    0     0                    -92328.20143 -94169.355  1.99%     -    0s
H    0     0                    -92673.62717 -94169.355  1.61%     -    0s
     0     0 -94156.649    0   89 -92673.627 -94156.649  1.60%     -    0s
     0     0 -93923.205    0   93 -92673.627 -93923.205  1.35%     -    0s
     0     0 -93891.117    0   90 -92673.627 -93891.117  1.31%     -    0s
H    0     0                    -92685.18924 -93740.125  1.14%     -    0s
     0     0 -93740.125    0   89 -92685.189 -93740.125  1.14%     -    0s
     0     0 -93735.220    0   89 -92685.189 -93735.220  1.13%     -    0s
     0     2 -93735.220    0   89 -92685.189 -93735.220  1.13%     -    0s
H   31    37                    -92833.42319 -93540.991  0.76%  14.4    0s
H   35    35                    -92987.12759 -93540.991  0.60%  13.0    0s
H   39    30                    -93295.18984 -93497.273  0.22%  13.0    0s
*  172     9              17    -93330.65445 -93333.740  0.00%   6.6    0s

Cutting planes:
  Gomory: 30
  Implied bound: 3
  MIR: 215
  RLT: 2

Explored 225 nodes (1764 simplex iterations) in 0.14 seconds (0.07 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -93330.7 -93295.2 -92987.1 ... 6.53069e+06
No other solutions better than -93330.7

Optimal solution found (tolerance 1.00e-04)
Best objective -9.333065444850e+04, best bound -9.333065444850e+04, gap 0.0000%
  Subproblem solved in 0.15s
  Worst-case operational profit (Z_SP) = 112763.27
  Scenario: 16 demand increases, 44 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -93330.65
  [DEBUG]   S×d_nominal = 206093.93
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 206093.93 + -93330.65 = 112763.27
  [DEBUG]   Current θ from Master = 113468.98
  [DEBUG]   ⚠️  Z_SP ≤ θ by 705.70 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -12324.91
  Lower Bound (LB) = -12324.91
  Gap (UB-LB) = 705.7033, Absolute Gap = 705.7033, Relative Gap = 0.060736
  Not converged yet (gap = 705.70 > ε = 200)

  [DEBUG] Adding NEW scenario 11 to Master Problem...
  [DEBUG] New scenario pattern: 16 increases, 44 decreases
    [DEBUG] Scenario 11 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 11 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 11]
    [DEBUG]   - Total constraints in model: 184863
    [DEBUG]   - Total variables in model: 77140
  [DEBUG] Total scenarios in Master: 12
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 12
================================================================================
[Iteration 12] Solving Master Problem...
  Current scenarios in Master: 12
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 184863 rows, 77140 columns and 524363 nonzeros
Model fingerprint: 0xa241757c
Variable types: 74881 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-03, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 82476 rows and 33486 columns
Presolve time: 1.58s
Presolved: 102387 rows, 43654 columns, 619475 nonzeros
Variable types: 41395 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -367905.1658
Found heuristic solution: objective -196432.4631

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.17s

Barrier statistics:
 Dense cols : 719
 AA' NZ     : 3.057e+06
 Factor NZ  : 7.663e+06 (roughly 120 MB of memory)
 Factor Ops : 1.556e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.72826493e+07  1.76491907e+08  8.72e+04 1.63e+01  7.07e+04     3s
   1  -1.28195879e+07  1.55566765e+08  5.93e+04 5.88e+01  4.77e+04     3s
   2  -4.53403041e+06  1.22267886e+08  2.05e+04 8.92e-01  1.75e+04     3s
   3  -8.02682515e+05  8.39940875e+07  1.59e+03 5.82e-01  1.71e+03     3s
   4  -5.08078511e+05  5.59921794e+07  4.00e+02 3.39e-01  5.97e+02     3s
   5  -4.58534445e+05  3.88161346e+07  2.60e+02 2.10e-01  3.87e+02     3s
   6  -3.91088832e+05  2.88005659e+07  1.28e+02 1.44e-01  2.37e+02     3s
   7  -3.21534714e+05  2.16113673e+07  5.10e+01 1.02e-01  1.46e+02     3s
   8  -2.04491124e+05  1.32259359e+07  1.96e+00 5.82e-02  7.24e+01     3s
   9  -1.26019648e+05  5.89567960e+06  2.50e-01 2.52e-02  3.21e+01     3s
  10  -7.83086498e+04  3.49683853e+06  1.40e-01 1.42e-02  1.91e+01     3s
  11  -4.59437393e+04  1.67184058e+06  4.88e-02 6.62e-03  9.16e+00     3s
  12  -3.49337122e+04  6.26782828e+05  2.22e-02 2.52e-03  3.53e+00     3s
  13  -2.40600417e+04  2.64950874e+05  1.09e-02 9.98e-04  1.54e+00     3s
  14  -1.89514369e+04  1.33787162e+05  7.28e-03 6.62e-04  8.14e-01     3s
  15  -1.48259101e+04  9.91115652e+04  5.41e-03 1.12e-03  6.07e-01     3s
  16  -1.00544167e+04  6.33012965e+04  4.10e-03 8.14e-04  3.91e-01     3s
  17  -8.48891619e+03  5.87854865e+04  3.70e-03 7.42e-04  3.59e-01     3s
  18  -3.05595494e+03  4.44606123e+04  2.40e-03 5.34e-04  2.53e-01     3s
  19  -4.58804863e+02  3.35347502e+04  1.89e-03 4.08e-04  1.81e-01     3s
  20   1.66574871e+03  2.82173153e+04  1.53e-03 3.64e-04  1.42e-01     3s
  21   3.46505255e+03  2.47590938e+04  1.21e-03 2.87e-04  1.13e-01     3s
  22   4.93084665e+03  2.20970673e+04  9.67e-04 2.47e-04  9.15e-02     3s
  23   5.98928015e+03  1.91091386e+04  8.03e-04 1.76e-04  6.99e-02     3s
  24   6.59619298e+03  1.77989457e+04  7.14e-04 1.48e-04  5.97e-02     3s
  25   7.74545392e+03  1.63122499e+04  5.45e-04 1.11e-04  4.57e-02     3s
  26   8.25945447e+03  1.51164128e+04  4.73e-04 8.22e-05  3.65e-02     4s
  27   8.85050073e+03  1.44061424e+04  3.90e-04 6.41e-05  2.96e-02     4s
  28   9.26074629e+03  1.40650151e+04  3.35e-04 5.60e-05  2.56e-02     4s
  29   9.52603943e+03  1.36998152e+04  2.99e-04 4.75e-05  2.22e-02     4s
  30   9.70277700e+03  1.35191823e+04  2.73e-04 4.30e-05  2.03e-02     4s
  31   9.98276792e+03  1.32385574e+04  2.36e-04 3.63e-05  1.74e-02     4s
  32   1.01064841e+04  1.29530320e+04  2.18e-04 2.90e-05  1.52e-02     4s
  33   1.01693644e+04  1.28734381e+04  2.09e-04 2.72e-05  1.44e-02     4s
  34   1.05134045e+04  1.26922844e+04  1.62e-04 2.28e-05  1.16e-02     4s
  35   1.07505984e+04  1.24095779e+04  1.29e-04 1.58e-05  8.84e-03     4s
  36   1.08074620e+04  1.22949625e+04  1.22e-04 1.30e-05  7.93e-03     4s
  37   1.09753023e+04  1.22099220e+04  9.92e-05 1.09e-05  6.58e-03     4s
  38   1.10987834e+04  1.21223705e+04  8.28e-05 8.80e-06  5.46e-03     4s
  39   1.12571620e+04  1.20418112e+04  6.00e-05 7.05e-06  4.18e-03     4s
  40   1.12855832e+04  1.19038574e+04  5.61e-05 4.05e-06  3.30e-03     4s
  41   1.13860572e+04  1.18437176e+04  4.32e-05 2.61e-06  2.44e-03     4s
  42   1.15064758e+04  1.18043574e+04  2.80e-05 3.58e-06  1.59e-03     4s
  43   1.15505278e+04  1.17748411e+04  2.24e-05 2.12e-06  1.20e-03     4s
  44   1.15642723e+04  1.17530474e+04  2.05e-05 1.11e-06  1.01e-03     4s
  45   1.16097035e+04  1.17459867e+04  1.46e-05 7.84e-07  7.26e-04     4s
  46   1.16418837e+04  1.17396396e+04  1.05e-05 4.57e-07  5.21e-04     4s
  47   1.16545894e+04  1.17363730e+04  8.93e-06 3.25e-07  4.36e-04     4s
  48   1.16855351e+04  1.17353319e+04  5.11e-06 2.72e-07  2.65e-04     4s
  49   1.16874115e+04  1.17314198e+04  4.88e-06 1.37e-07  2.35e-04     4s
  50   1.17013017e+04  1.17308152e+04  3.14e-06 1.17e-07  1.57e-04     5s
  51   1.17064262e+04  1.17296994e+04  2.51e-06 8.25e-08  1.24e-04     5s
  52   1.17077049e+04  1.17297233e+04  2.36e-06 7.98e-08  1.17e-04     5s
  53   1.17079406e+04  1.17293584e+04  2.33e-06 7.10e-08  1.14e-04     5s
  54   1.17111619e+04  1.17289997e+04  1.93e-06 5.78e-08  9.51e-05     5s
  55   1.17141982e+04  1.17286696e+04  1.56e-06 4.77e-08  7.71e-05     5s
  56   1.17244111e+04  1.17282571e+04  2.98e-07 3.27e-08  2.05e-05     5s
  57   1.17263133e+04  1.17277039e+04  8.46e-08 1.61e-08  7.41e-06     5s
  58   1.17269207e+04  1.17271556e+04  1.90e-08 1.19e-09  1.25e-06     5s
  59   1.17271144e+04  1.17271144e+04  8.46e-10 3.34e-09  2.79e-10     5s

Barrier solved model in 59 iterations and 4.89 seconds (10.55 work units)
Optimal objective 1.17271144e+04


Root crossover log...

       0 DPushes remaining with DInf 0.0000000e+00                 7s

    7813 PPushes remaining with PInf 1.9781575e-05                 7s
       0 PPushes remaining with PInf 0.0000000e+00                 7s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.9549235e+02      7s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   42203    1.1727114e+04   0.000000e+00   1.954923e+02      7s
   42208    1.1727114e+04   0.000000e+00   0.000000e+00      7s
   42208    1.1727114e+04   0.000000e+00   0.000000e+00      7s
Concurrent spin time: 2.17s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 1.172711e+04, 42208 iterations, 7.39 seconds (14.34 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 11727.1144    0  479 -196432.46 11727.1144   106%     -    9s
H    0     0                    -165728.6281 11727.1144   107%     -   10s
H    0     0                    -145222.8993 11727.1144   108%     -   10s
H    0     0                    -137833.0675 11727.1144   109%     -   10s
H    0     0                    -128411.6500 11727.1144   109%     -   10s
H    0     0                    -128401.7146 11727.1144   109%     -   10s
H    0     0                    -79499.66691 11727.1144   115%     -   10s
H    0     0                    -36133.42539 11727.1144   132%     -   10s
H    0     0                    -35925.54777 11727.1144   133%     -   10s
H    0     0                    -29969.42644 11727.1144   139%     -   12s
H    0     0                    -29673.29521 11727.1144   140%     -   12s
H    0     0                    -29507.28044 11727.1144   140%     -   12s
H    0     0                    -29410.95181 11727.1144   140%     -   12s
H    0     0                    -29404.81234 11727.1144   140%     -   12s
H    0     0                    -29398.30867 11727.1144   140%     -   12s
H    0     0                    -29396.30176 11727.1144   140%     -   12s
H    0     0                    -29386.51832 11727.1144   140%     -   12s
H    0     0                    -29372.84830 11727.1144   140%     -   12s
     0     0 7496.85278    0  674 -29372.848 7496.85278   126%     -   58s
H    0     0                    -26616.07998 7496.02013   128%     -   59s
H    0     0                    -25680.59230 7496.02013   129%     -   59s
H    0     0                    -25622.59398 7496.02013   129%     -   59s
H    0     0                    -25593.27598 7496.02013   129%     -   59s
     0     0 7098.07891    0  680 -25593.276 7098.07891   128%     -   82s
     0     0 6936.78507    0  674 -25593.276 6936.78507   127%     -   92s
     0     0 6687.06014    0  673 -25593.276 6687.06014   126%     -  103s
     0     0 6664.82972    0  669 -25593.276 6664.82972   126%     -  111s
     0     0 6664.82972    0  669 -25593.276 6664.82972   126%     -  118s
     0     0 6664.82972    0  663 -25593.276 6664.82972   126%     -  119s
     0     0 6664.82972    0  658 -25593.276 6664.82972   126%     -  124s
     0     0 6664.82972    0  656 -25593.276 6664.82972   126%     -  125s
     0     0 6664.82972    0  656 -25593.276 6664.82972   126%     -  125s
H    0     0                    -21634.20538 6664.82972   131%     -  127s
H    0     0                    -21274.11008 6664.82972   131%     -  127s
H    0     0                    -19214.71488 6664.82972   135%     -  127s
H    0     0                    -19097.46004 6664.82972   135%     -  127s
H    0     0                    -18994.80836 6664.82972   135%     -  127s
H    0     0                    -17780.96013 4317.14055   124%     -  177s
     0     0 3716.53273    0  653 -17780.960 3716.53273   121%     -  193s
H    0     0                    -12166.69902 3716.53273   131%     -  194s
H    0     0                    -12119.75546 3716.53273   131%     -  194s
H    0     0                    -12115.78167 3716.53273   131%     -  194s
H    0     0                    -12076.63991 3716.53273   131%     -  194s
H    0     0                    -12049.81835 3716.53273   131%     -  194s
H    0     0                    -12032.46068 3716.53273   131%     -  194s
H    0     0                    -11951.23780 2922.26218   124%     -  233s
H    0     0                    -11945.88122 2922.26218   124%     -  233s
     0     0 2922.26218    0  679 -11945.881 2922.26218   124%     -  238s
     0     0 2550.66131    0  645 -11945.881 2550.66131   121%     -  270s
     0     0 2481.98826    0  674 -11945.881 2481.98826   121%     -  286s
     0     0 2459.62688    0  675 -11945.881 2459.62688   121%     -  295s
     0     0 2360.46981    0  664 -11945.881 2360.46981   120%     -  315s
     0     0 2285.92274    0  574 -11945.881 2285.92274   119%     -  332s
H    0     0                    -11911.56306 2219.94681   119%     -  342s
     0     0 2219.94681    0  686 -11911.563 2219.94681   119%     -  350s
     0     0 2211.03110    0  592 -11911.563 2211.03110   119%     -  357s
     0     0 2184.13003    0  592 -11911.563 2184.13003   118%     -  368s
     0     0 2173.92281    0  651 -11911.563 2173.92281   118%     -  373s
     0     0 2173.22683    0  665 -11911.563 2173.22683   118%     -  375s
     0     0   57.15045    0  725 -11911.563   57.15045   100%     -  453s
H    0     0                    -11820.96617 -584.40269  95.1%     -  478s
     0     0 -584.40269    0  777 -11820.966 -584.40269  95.1%     -  479s
     0     0 -815.47755    0  540 -11820.966 -815.47755  93.1%     -  497s
     0     0 -951.27232    0  776 -11820.966 -951.27232  92.0%     -  525s
     0     0 -1057.3799    0  771 -11820.966 -1057.3799  91.1%     -  555s
     0     0 -1074.2825    0  785 -11820.966 -1074.2825  90.9%     -  567s
     0     0 -1102.9299    0  786 -11820.966 -1102.9299  90.7%     -  575s
     0     0 -1114.3036    0  779 -11820.966 -1114.3036  90.6%     -  583s
     0     0 -1178.3618    0  765 -11820.966 -1178.3618  90.0%     -  606s
H    0     0                    -11721.73615 -1189.8302  89.8%     -  610s
     0     0 -1189.8302    0  478 -11721.736 -1189.8302  89.8%     -  612s
     0     0 -1194.7249    0  777 -11721.736 -1194.7249  89.8%     -  619s
     0     0 -1290.9725    0  772 -11721.736 -1290.9725  89.0%     -  635s
     0     0 -1304.7255    0  771 -11721.736 -1304.7255  88.9%     -  640s
     0     0 -1310.2608    0  776 -11721.736 -1310.2608  88.8%     -  643s
     0     0 -1315.0965    0  780 -11721.736 -1315.0965  88.8%     -  645s
     0     0 -1330.8805    0  788 -11721.736 -1330.8805  88.6%     -  649s
     0     0 -1331.7973    0  788 -11721.736 -1331.7973  88.6%     -  651s
     0     0 -2350.1877    0  534 -11721.736 -2350.1877  80.0%     -  693s
H    0     0                    -11635.83407 -2350.4845  79.8%     -  694s
     0     0 -2471.0531    0  624 -11635.834 -2471.0531  78.8%     -  704s
     0     0 -2517.2936    0  626 -11635.834 -2517.2936  78.4%     -  711s
     0     0 -2532.0201    0  629 -11635.834 -2532.0201  78.2%     -  714s
     0     0 -2545.2300    0  630 -11635.834 -2545.2300  78.1%     -  717s
     0     0 -2561.8219    0  552 -11635.834 -2561.8219  78.0%     -  720s
     0     0 -2595.6544    0  550 -11635.834 -2595.6544  77.7%     -  724s
     0     0 -2602.2545    0  560 -11635.834 -2602.2545  77.6%     -  726s
     0     0 -2624.5200    0  542 -11635.834 -2624.5200  77.4%     -  730s
     0     0 -2632.1144    0  538 -11635.834 -2632.1144  77.4%     -  733s
     0     0 -2639.7124    0  543 -11635.834 -2639.7124  77.3%     -  736s
     0     0 -2644.8599    0  553 -11635.834 -2644.8599  77.3%     -  737s
     0     0 -2647.2117    0  554 -11635.834 -2647.2117  77.2%     -  738s
     0     0 -2869.4904    0  560 -11635.834 -2869.4904  75.3%     -  756s
     0     0 -2973.0458    0  625 -11635.834 -2973.0458  74.4%     -  769s
     0     0 -3013.0965    0  645 -11635.834 -3013.0965  74.1%     -  775s
     0     0 -3020.4249    0  656 -11635.834 -3020.4249  74.0%     -  778s
     0     0 -3022.3274    0  648 -11635.834 -3022.3274  74.0%     -  779s
     0     0 -3166.0544    0  559 -11635.834 -3166.0544  72.8%     -  791s
     0     0 -3207.5910    0  554 -11635.834 -3207.5910  72.4%     -  807s
     0     0 -3211.7018    0  559 -11635.834 -3211.7018  72.4%     -  809s
     0     0 -3215.3392    0  650 -11635.834 -3215.3392  72.4%     -  811s
     0     0 -3218.8166    0  557 -11635.834 -3218.8166  72.3%     -  813s
     0     0 -3219.9954    0  559 -11635.834 -3219.9954  72.3%     -  813s
     0     0 -3284.3686    0  561 -11635.834 -3284.3686  71.8%     -  823s
     0     0 -3307.8492    0  712 -11635.834 -3307.8492  71.6%     -  832s
     0     0 -3312.9940    0  576 -11635.834 -3312.9940  71.5%     -  834s
     0     0 -3314.3463    0  576 -11635.834 -3314.3463  71.5%     -  836s
     0     0 -3344.6847    0  564 -11635.834 -3344.6847  71.3%     -  842s
     0     0 -3353.0223    0  569 -11635.834 -3353.0223  71.2%     -  845s
     0     0 -3355.0326    0  574 -11635.834 -3355.0326  71.2%     -  847s
     0     0 -3379.4453    0  590 -11635.834 -3379.4453  71.0%     -  855s
     0     0 -3385.4927    0  581 -11635.834 -3385.4927  70.9%     -  875s
     0     0 -3390.1479    0  590 -11635.834 -3390.1479  70.9%     -  877s
     0     0 -3391.1894    0  591 -11635.834 -3391.1894  70.9%     -  879s
     0     0 -3399.7790    0  579 -11635.834 -3399.7790  70.8%     -  882s
     0     0 -3405.0883    0  589 -11635.834 -3405.0883  70.7%     -  887s
     0     0 -3407.6507    0  683 -11635.834 -3407.6507  70.7%     -  890s
     0     0 -3407.8852    0  599 -11635.834 -3407.8852  70.7%     -  891s
     0     0 -3417.1791    0  680 -11635.834 -3417.1791  70.6%     -  897s
     0     0 -3417.4017    0  680 -11635.834 -3417.4017  70.6%     -  900s
     0     2 -3417.4017    0  680 -11635.834 -3417.4017  70.6%     -  997s
     1     4 -3436.0995    1  676 -11635.834 -3417.4017  70.6%  2449 1007s
     3     7 -3472.4538    2  683 -11635.834 -3441.4016  70.4%  5785 1029s
     6    12 -3477.8707    3  683 -11635.834 -3472.7786  70.2%  8856 1047s
    11    24 -3810.9533    4  773 -11635.834 -3472.7786  70.2%  9672 1061s
    23    36 -4020.5717    5  585 -11635.834 -3812.0476  67.2% 14549 1099s
    35    67 -4318.5758    6  590 -11635.834 -3812.0476  67.2% 13273 1203s
    66   128 -5050.9629    7  550 -11635.834 -4006.2138  65.6% 20376 1274s
   127   203 -6684.5284    9  282 -11635.834 -4118.8347  64.6% 15680 1306s
H  149   203                    -11623.48292 -4118.8347  64.6% 14238 1306s
   202   289 -7127.3458   12  248 -11623.483 -4118.8347  64.6% 12313 1334s
   288   352 -8094.1641   15  274 -11623.483 -4118.8347  64.6% 10323 1362s
   357   402 -10465.200   17  117 -11623.483 -4118.8347  64.6%  9667 1387s
   423   428 -10968.263   21  101 -11623.483 -4118.8347  64.6%  9408 1408s
   461   462 -6390.2105    8  486 -11623.483 -4118.8347  64.6%  9446 1431s
   497   526 -6693.7072    9  382 -11623.483 -4118.8347  64.6%  9364 1451s
   565   580 -6836.4003   10  383 -11623.483 -4118.8347  64.6%  9312 1471s
   631   641 -6970.6065   11  458 -11623.483 -4118.8347  64.6%  9101 1492s
   711   663 -10800.926   12   84 -11623.483 -4318.8745  62.8%  8829 1510s
   743   698 -10718.656   12   78 -11623.483 -4318.8745  62.8%  8820 1526s
   806   715 -8538.6056   15  426 -11623.483 -4318.8745  62.8%  8621 1542s
   867   750 -10343.384   15  292 -11623.483 -4318.8745  62.8%  8374 1565s
   924   787 -8742.8992   16  370 -11623.483 -4318.8745  62.8%  8318 1585s
   991   822 infeasible   17      -11623.483 -4318.8745  62.8%  8335 1607s
  1060   826 -9817.3059   18  281 -11623.483 -4318.8745  62.8%  8353 1632s
  1138   846 -10959.859   20  256 -11623.483 -4318.8745  62.8%  8329 1658s
  1204   876 infeasible   21      -11623.483 -4318.8745  62.8%  8460 1683s
  1264   898 infeasible   21      -11623.483 -4603.1168  60.4%  8593 1710s
  1318   921 -8135.8480   16  220 -11623.483 -4603.1168  60.4%  8709 1738s
  1369   958 -11280.621   12  220 -11623.483 -4603.1168  60.4%  8912 1776s
  1446   993 infeasible   14      -11623.483 -4603.1168  60.4%  8969 1803s
  1546  1032 -9505.4502    8  374 -11623.483 -4603.1168  60.4%  8887 1833s
  1639  1062     cutoff   10      -11623.483 -4603.1168  60.4%  8848 1869s
  1729  1084 -11025.765   10  379 -11623.483 -4821.0909  58.5%  8880 1899s
  1807  1121 infeasible   11      -11623.483 -4821.0909  58.5%  8913 1940s
  1874  1172 -5766.2594    5  351 -11623.483 -4821.0909  58.5%  9039 1978s
  1965  1197 -6517.3702    8  308 -11623.483 -4821.0909  58.5%  9114 2017s
  2059  1229 -10421.666   10  245 -11623.483 -4821.0909  58.5%  9182 2058s
  2155  1242 -7733.7295   10  281 -11623.483 -4821.0909  58.5%  9210 2103s
  2266  1286 -11183.429   12  256 -11623.483 -5380.4954  53.7%  9214 2150s
  2346  1310 infeasible   13      -11623.483 -5425.1818  53.3%  9368 2195s
  2439  1315 -8296.3274   14  422 -11623.483 -5425.1818  53.3%  9531 2235s
  2498  1336 -8702.7449   15  554 -11623.483 -5425.1818  53.3%  9668 2276s
  2569  1365 -8813.4737   16  501 -11623.483 -5425.1818  53.3%  9760 2327s
  2650  1387 -10569.563   17  480 -11623.483 -5545.6982  52.3%  9896 2378s
  2729  1409 infeasible   18      -11623.483 -5545.6982  52.3% 10075 2424s
  2809  1446     cutoff   10      -11623.483 -5568.0197  52.1% 10180 2479s
  2930  1474 -9449.6410   10  618 -11623.483 -5568.0197  52.1% 10249 2533s
  3074  1490 -11098.229   12  517 -11623.483 -5568.0197  52.1% 10305 2584s
  3202  1517 infeasible   13      -11623.483 -5802.9244  50.1% 10421 2642s
  3320  1551 infeasible   13      -11623.483 -5818.7010  49.9% 10578 2706s
  3438  1568 -9602.3207   14  362 -11623.483 -5854.2387  49.6% 10723 2766s
  3587  1587 -9165.5755   14  352 -11623.483 -5925.7006  49.0% 10783 2817s
  3694  1613 -11315.528   15  337 -11623.483 -5988.5438  48.5% 10838 2873s
  3834  1629 infeasible   15      -11623.483 -6081.1315  47.7% 10873 2934s
  3975  1651 -10685.546    8  438 -11623.483 -6081.1315  47.7% 10997 3000s
  4037  1676 infeasible    9      -11623.483 -6081.1315  47.7% 11072 3075s
  4188  1718 -8655.2739   11  147 -11623.483 -6123.9359  47.3% 11148 3147s
  4364  1760 infeasible   12      -11623.483 -6230.2044  46.4% 11207 3223s
  4545  1795 infeasible    7      -11623.483 -6300.6040  45.8% 11276 3298s
  4738  1841 -11531.238   16  332 -11623.483 -6300.6040  45.8% 11393 3383s
  4954  1866 -10017.749   18  390 -11623.483 -6326.6277  45.6% 11469 3455s
  5100  1937 infeasible   21      -11623.483 -6438.6601  44.6% 11518 3535s
  5370  1992 -7086.9153   14  470 -11623.483 -6438.6601  44.6% 11498 3600s

Cutting planes:
  Learned: 1
  Gomory: 6
  Implied bound: 305
  MIR: 3570
  Flow cover: 4015
  RLT: 211
  Relax-and-lift: 1461

Explored 5648 nodes (65352982 simplex iterations) in 3600.05 seconds (8499.38 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -11623.5 -11635.8 -11721.7 ... -12076.6

Time limit reached
Best objective -1.162348292017e+04, best bound -6.438660096195e+03, gap 44.6064%
  WARNING: Time limit reached. Using best solution found (gap: 44.61%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = -11623.48, θ = 113460.17
  Upper Bound (UB) = -11623.48

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 113460.17
  [DEBUG]   ✓ Scenario 0: θ = 113460.17 ≤ Q = 113460.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 113460.17 ≤ Q = 113460.17 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 113460.17 ≤ Q = 113460.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 113460.17 ≤ Q = 113460.17 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 113460.17 ≤ Q = 113460.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 113460.17 ≤ Q = 113460.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 113460.17 ≤ Q = 113460.17 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 113460.17 ≤ Q = 113460.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 113460.17 ≤ Q = 113460.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 113460.17 ≤ Q = 113460.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 113460.17 ≤ Q = 113460.17 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 113460.17 ≤ Q = 113460.17 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 12] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x5c6ed778
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xa3912888
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.248434e+13
Presolve removed 2589 rows and 1882 columns
Presolve time: 0.00s
Presolved: 504 rows, 507 columns, 1421 nonzeros
Found heuristic solution: objective 6309039.5001
Variable types: 343 continuous, 164 integer (164 binary)

Root relaxation: objective -1.245212e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -124521.18    0  123 6309039.50 -124521.18   102%     -    0s
H    0     0                    -89303.80006 -124521.18  39.4%     -    0s
H    0     0                    -90230.18799 -124521.18  38.0%     -    0s
     0     0 -94440.140    0   81 -90230.188 -94440.140  4.67%     -    0s
H    0     0                    -91638.22135 -94391.465  3.00%     -    0s
     0     0 -94326.210    0   43 -91638.221 -94326.210  2.93%     -    0s
H    0     0                    -93700.36102 -94298.065  0.64%     -    0s
H    0     0                    -93992.57531 -94298.065  0.33%     -    0s
H    0     0                    -94024.75945 -94298.065  0.29%     -    0s
     0     0 -94178.088    0   35 -94024.759 -94178.088  0.16%     -    0s
     0     0 -94100.406    0   17 -94024.759 -94100.406  0.08%     -    0s
     0     0 -94077.653    0   11 -94024.759 -94077.653  0.06%     -    0s
     0     0 -94073.901    0    8 -94024.759 -94073.901  0.05%     -    0s
     0     0 -94072.068    0    7 -94024.759 -94072.068  0.05%     -    0s
H    0     0                    -94043.00769 -94067.804  0.03%     -    0s
     0     0 -94067.804    0    7 -94043.008 -94067.804  0.03%     -    0s
     0     0          -    0      -94043.008 -94051.954  0.01%     -    0s

Cutting planes:
  Gomory: 3
  Implied bound: 1
  MIR: 140
  Flow cover: 2
  RLT: 3

Explored 1 nodes (488 simplex iterations) in 0.03 seconds (0.03 work units)
Thread count was 32 (of 256 available processors)

Solution count 7: -94043 -94024.8 -93700.4 ... 1.24843e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -9.404300769182e+04, best bound -9.405195437861e+04, gap 0.0095%
  Subproblem solved in 0.04s
  Worst-case operational profit (Z_SP) = 111954.86
  Scenario: 14 demand increases, 46 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -94043.01
  [DEBUG]   S×d_nominal = 205997.87
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 205997.87 + -94043.01 = 111954.86
  [DEBUG]   Current θ from Master = 113460.17
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1505.31 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -13128.79
  Lower Bound (LB) = -12324.91
  Gap (UB-LB) = 701.4239, Absolute Gap = 701.4239, Relative Gap = 0.060345
  Not converged yet (gap = 701.42 > ε = 200)

  [DEBUG] Adding NEW scenario 12 to Master Problem...
  [DEBUG] New scenario pattern: 14 increases, 46 decreases
    [DEBUG] Scenario 12 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 12 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 12]
    [DEBUG]   - Total constraints in model: 200153
    [DEBUG]   - Total variables in model: 83380
  [DEBUG] Total scenarios in Master: 13
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 13
================================================================================
[Iteration 13] Solving Master Problem...
  Current scenarios in Master: 13
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 200153 rows, 83380 columns and 567600 nonzeros
Model fingerprint: 0x1c84a2aa
Variable types: 81121 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-03, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 89344 rows and 36274 columns
Presolve time: 1.83s
Presolved: 110809 rows, 47106 columns, 668573 nonzeros
Variable types: 44847 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -367859.4339
Found heuristic solution: objective -196432.4631

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.23s

Barrier statistics:
 Dense cols : 712
 AA' NZ     : 3.489e+06
 Factor NZ  : 8.916e+06 (roughly 140 MB of memory)
 Factor Ops : 1.994e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.73008649e+07  1.88777059e+08  8.73e+04 1.87e+01  7.03e+04     3s
   1  -1.28987847e+07  1.66558865e+08  5.94e+04 5.67e+01  4.75e+04     3s
   2  -4.90086763e+06  1.31543119e+08  2.24e+04 7.39e-01  1.89e+04     3s
   3  -8.43625425e+05  9.20229204e+07  1.77e+03 1.20e+00  1.86e+03     3s
   4  -5.04198075e+05  4.01565471e+07  3.81e+02 2.14e-01  4.70e+02     3s
   5  -4.34702437e+05  2.62435112e+07  2.18e+02 1.21e-01  2.73e+02     3s
   6  -3.46502949e+05  2.18555632e+07  8.38e+01 9.44e-02  1.61e+02     3s
   7  -2.26240637e+05  1.69881912e+07  1.57e+01 6.98e-02  9.35e+01     3s
   8  -1.44814328e+05  8.78705315e+06  1.90e+00 3.77e-02  4.47e+01     3s
   9  -9.84493366e+04  5.40814926e+06  1.01e+00 2.27e-02  2.74e+01     3s
  10  -6.92238150e+04  2.36095190e+06  5.25e-01 9.56e-03  1.20e+01     3s
  11  -4.47109076e+04  5.98841691e+05  3.03e-01 2.45e-03  3.18e+00     3s
  12  -2.98668258e+04  2.60823565e+05  1.59e-01 1.06e-03  1.44e+00     3s
  13  -2.05853171e+04  1.50881687e+05  8.80e-02 7.66e-04  8.46e-01     4s
  14  -1.56244689e+04  1.02162888e+05  6.45e-02 8.42e-04  5.81e-01     4s
  15  -1.11142085e+04  7.00373707e+04  4.90e-02 1.24e-03  4.00e-01     4s
  16  -8.48511761e+03  4.83363629e+04  4.18e-02 2.06e-03  2.80e-01     4s
  17  -4.73467064e+03  4.24017955e+04  3.34e-02 1.66e-03  2.33e-01     4s
  18  -1.53111302e+03  3.36358196e+04  2.57e-02 1.23e-03  1.73e-01     4s
  19   4.43260519e+02  2.57610292e+04  2.10e-02 8.20e-04  1.25e-01     4s
  20   2.03532269e+03  2.20370960e+04  1.75e-02 6.18e-04  9.87e-02     4s
  21   3.64834504e+03  1.88333955e+04  1.42e-02 4.25e-04  7.49e-02     4s
  22   4.45335657e+03  1.70105388e+04  1.26e-02 3.76e-04  6.19e-02     4s
  23   6.21927019e+03  1.55294210e+04  9.06e-03 2.45e-04  4.59e-02     4s
  24   7.15493327e+03  1.40782536e+04  7.30e-03 1.66e-04  3.42e-02     4s
  25   8.15908907e+03  1.36108974e+04  5.43e-03 1.38e-04  2.69e-02     4s
  26   8.47042198e+03  1.27936934e+04  4.83e-03 9.30e-05  2.13e-02     4s
  27   9.00460139e+03  1.26508263e+04  3.88e-03 8.44e-05  1.80e-02     4s
  28   9.18082234e+03  1.25104223e+04  3.55e-03 7.62e-05  1.64e-02     4s
  29   9.50574391e+03  1.22218049e+04  2.95e-03 6.51e-05  1.34e-02     4s
  30   9.91786706e+03  1.20747446e+04  2.19e-03 5.58e-05  1.06e-02     4s
  31   1.03074797e+04  1.16880330e+04  1.46e-03 9.08e-05  6.81e-03     4s
  32   1.05718840e+04  1.14963109e+04  1.00e-03 5.62e-05  4.56e-03     4s
  33   1.06062828e+04  1.14433606e+04  9.45e-04 4.74e-05  4.13e-03     4s
  34   1.07715140e+04  1.13593200e+04  6.54e-04 3.26e-05  2.90e-03     4s
  35   1.08529492e+04  1.12749904e+04  5.14e-04 4.07e-05  2.08e-03     4s
  36   1.09729236e+04  1.12673022e+04  3.16e-04 3.74e-05  1.45e-03     4s
  37   1.09981916e+04  1.12424846e+04  2.73e-04 2.84e-05  1.21e-03     4s
  38   1.10363151e+04  1.12192563e+04  2.08e-04 1.98e-05  9.02e-04     5s
  39   1.10898722e+04  1.11827433e+04  1.20e-04 7.81e-06  4.58e-04     5s
  40   1.11253280e+04  1.11735135e+04  6.31e-05 3.15e-06  2.38e-04     5s
  41   1.11378611e+04  1.11708803e+04  4.31e-05 2.04e-06  1.63e-04     5s
  42   1.11392728e+04  1.11704224e+04  4.09e-05 1.85e-06  1.54e-04     5s
  43   1.11414460e+04  1.11700826e+04  3.75e-05 1.71e-06  1.41e-04     5s
  44   1.11461125e+04  1.11687957e+04  3.03e-05 1.04e-06  1.12e-04     5s
  45   1.11558582e+04  1.11679225e+04  1.57e-05 6.69e-07  5.95e-05     5s
  46   1.11654754e+04  1.11664383e+04  7.80e-07 1.48e-07  4.75e-06     5s
  47   1.11658119e+04  1.11660225e+04  2.88e-07 9.98e-10  1.04e-06     5s
  48   1.11659654e+04  1.11660210e+04  6.29e-08 8.20e-09  2.74e-07     5s
  49   1.11660099e+04  1.11660174e+04  5.80e-08 5.26e-07  3.69e-08     5s
  50   1.11660170e+04  1.11660173e+04  9.08e-08 7.37e-09  1.52e-09     5s
  51   1.11660173e+04  1.11660173e+04  4.69e-10 8.16e-09  2.75e-13     5s

Barrier solved model in 51 iterations and 5.00 seconds (10.10 work units)
Optimal objective 1.11660173e+04


Root crossover log...

   84262 DPushes remaining with DInf 0.0000000e+00                 5s
       0 DPushes remaining with DInf 0.0000000e+00                 7s

    3925 PPushes remaining with PInf 3.8618957e-08                 7s
       0 PPushes remaining with PInf 0.0000000e+00                 7s

  Push phase complete: Pinf 0.0000000e+00, Dinf 8.8522693e-11      7s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   34778    1.1166017e+04   0.000000e+00   0.000000e+00      7s
   34778    1.1166017e+04   0.000000e+00   0.000000e+00      7s
Concurrent spin time: 1.28s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 1.116602e+04, 34778 iterations, 5.70 seconds (12.49 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 11166.0173    0  524 -196432.46 11166.0173   106%     -    8s
H    0     0                    -75392.61276 11166.0173   115%     -    8s
H    0     0                    -54393.22250 11166.0173   121%     -    8s
H    0     0                    -49143.40333 11166.0173   123%     -    8s
H    0     0                    -48511.93694 11166.0173   123%     -    9s
H    0     0                    -47955.94386 11166.0173   123%     -    9s
H    0     0                    -47698.74432 11166.0173   123%     -    9s
H    0     0                    -46615.98921 11166.0173   124%     -    9s
H    0     0                    -46466.15398 11166.0173   124%     -   10s
H    0     0                    -28835.40980 7225.67377   125%     -   46s
H    0     0                    -28196.41817 7225.67377   126%     -   46s
H    0     0                    -27946.09074 7225.67377   126%     -   46s
H    0     0                    -26365.00945 7225.67377   127%     -   46s
H    0     0                    -26305.49490 7225.67377   127%     -   46s
H    0     0                    -26285.52370 7225.67377   127%     -   46s
H    0     0                    -26267.97856 7225.67377   128%     -   46s
H    0     0                    -26260.38224 7225.67377   128%     -   46s
H    0     0                    -26253.14995 7225.67377   128%     -   46s
H    0     0                    -26243.05094 7225.67377   128%     -   46s
H    0     0                    -26233.87931 7225.67377   128%     -   46s
     0     0 6985.35441    0  646 -26233.879 6985.35441   127%     -   46s
H    0     0                    -22680.80065 6985.35441   131%     -   46s
H    0     0                    -20977.24059 6985.35441   133%     -   46s
H    0     0                    -20701.06786 6985.35441   134%     -   46s
H    0     0                    -20688.24309 6985.35441   134%     -   46s
     0     0 6455.09225    0  651 -20688.243 6455.09225   131%     -   68s
     0     0 6400.74762    0  712 -20688.243 6400.74762   131%     -   77s
     0     0 6399.64049    0  711 -20688.243 6399.64049   131%     -   87s
     0     0 6399.64049    0  712 -20688.243 6399.64049   131%     -   89s
     0     0 6399.64049    0  712 -20688.243 6399.64049   131%     -   91s
     0     0 6399.64049    0  712 -20688.243 6399.64049   131%     -   93s
     0     0 6399.64049    0  702 -20688.243 6399.64049   131%     -   95s
     0     0 6399.64049    0  698 -20688.243 6399.64049   131%     -   97s
     0     0 6399.64049    0  701 -20688.243 6399.64049   131%     -   98s
     0     0 6399.64049    0  704 -20688.243 6399.64049   131%     -  100s
     0     0 6399.64049    0  713 -20688.243 6399.64049   131%     -  103s
     0     0 6399.64049    0  710 -20688.243 6399.64049   131%     -  104s
     0     0 6399.64049    0  714 -20688.243 6399.64049   131%     -  105s
     0     0 6399.64049    0  714 -20688.243 6399.64049   131%     -  105s
     0     0 6399.64049    0  712 -20688.243 6399.64049   131%     -  105s
H    0     0                    -18047.51517 3952.21847   122%     -  162s
H    0     0                    -16897.77279 3952.21847   123%     -  162s
H    0     0                    -16838.42393 3952.21847   123%     -  162s
H    0     0                    -16427.97163 3952.21847   124%     -  162s
H    0     0                    -12624.96722 3952.21847   131%     -  162s
H    0     0                    -12378.60842 3952.21847   132%     -  162s
H    0     0                    -12362.36771 3952.21847   132%     -  162s
H    0     0                    -12200.87181 3952.21847   132%     -  162s
H    0     0                    -12186.66087 3952.21847   132%     -  162s
     0     0 3952.21847    0  656 -12186.661 3952.21847   132%     -  162s
H    0     0                    -12182.83060 3950.54925   132%     -  163s
H    0     0                    -12132.24642 3950.54925   133%     -  163s
H    0     0                    -12097.92825 3950.54925   133%     -  163s
     0     0 2905.65111    0  693 -12097.928 2905.65111   124%     -  216s
H    0     0                    -11904.64460 2567.80262   122%     -  257s
H    0     0                    -11872.38247 2567.80262   122%     -  257s
     0     0 2567.80262    0  711 -11872.382 2567.80262   122%     -  257s
     0     0 2466.13241    0  692 -11872.382 2466.13241   121%     -  280s
     0     0 2433.63071    0  693 -11872.382 2433.63071   120%     -  297s
     0     0 2368.54314    0  709 -11872.382 2368.54314   120%     -  320s
     0     0 2251.80317    0  718 -11872.382 2251.80317   119%     -  336s
     0     0 2211.33785    0  704 -11872.382 2211.33785   119%     -  347s
     0     0 2183.61423    0  707 -11872.382 2183.61423   118%     -  361s
     0     0 2156.66653    0  712 -11872.382 2156.66653   118%     -  367s
     0     0 2140.35222    0  608 -11872.382 2140.35222   118%     -  377s
     0     0 2137.97446    0  606 -11872.382 2137.97446   118%     -  379s
     0     0 2125.33623    0  610 -11872.382 2125.33623   118%     -  383s
     0     0 2110.90522    0  615 -11872.382 2110.90522   118%     -  389s
     0     0 2110.52061    0  707 -11872.382 2110.52061   118%     -  391s
H    0     0                    -11635.83407 2110.52061   118%     -  407s
     0     0 -119.29230    0  740 -11635.834 -119.29230  99.0%     -  514s
     0     0 -822.30024    0  811 -11635.834 -822.30024  92.9%     -  570s
     0     0 -1109.9728    0  826 -11635.834 -1109.9728  90.5%     -  601s
     0     0 -1204.1296    0  766 -11635.834 -1204.1296  89.7%     -  611s
     0     0 -1251.5403    0  761 -11635.834 -1251.5403  89.2%     -  619s
     0     0 -1300.8629    0  771 -11635.834 -1300.8629  88.8%     -  626s
     0     0 -1318.3826    0  826 -11635.834 -1318.3826  88.7%     -  632s
     0     0 -1329.8747    0  835 -11635.834 -1329.8747  88.6%     -  636s
     0     0 -1331.9474    0  833 -11635.834 -1331.9474  88.6%     -  638s
     0     0 -1343.3491    0  853 -11635.834 -1343.3491  88.5%     -  642s
     0     0 -1355.8733    0  840 -11635.834 -1355.8733  88.3%     -  645s
     0     0 -1357.8546    0  849 -11635.834 -1357.8546  88.3%     -  646s
     0     0 -1492.2488    0  739 -11635.834 -1492.2488  87.2%     -  656s
     0     0 -1526.2928    0  776 -11635.834 -1526.2928  86.9%     -  662s
     0     0 -1530.9277    0  782 -11635.834 -1530.9277  86.8%     -  665s
     0     0 -1532.6128    0  760 -11635.834 -1532.6128  86.8%     -  667s
     0     0 -2207.3438    0  561 -11635.834 -2207.3438  81.0%     -  697s
     0     0 -2356.4202    0  563 -11635.834 -2356.4202  79.7%     -  714s
     0     0 -2403.6873    0  571 -11635.834 -2403.6873  79.3%     -  722s
     0     0 -2466.2721    0  585 -11635.834 -2466.2721  78.8%     -  731s
     0     0 -2485.4597    0  651 -11635.834 -2485.4597  78.6%     -  737s
     0     0 -2517.2472    0  581 -11635.834 -2517.2472  78.4%     -  742s
     0     0 -2535.0618    0  581 -11635.834 -2535.0618  78.2%     -  745s
     0     0 -2559.1546    0  576 -11635.834 -2559.1546  78.0%     -  749s
     0     0 -2560.1627    0  582 -11635.834 -2560.1627  78.0%     -  751s
     0     0 -2672.6868    0  658 -11635.834 -2672.6868  77.0%     -  766s
     0     0 -2722.3623    0  571 -11635.834 -2722.3623  76.6%     -  774s
     0     0 -2763.0340    0  574 -11635.834 -2763.0340  76.3%     -  779s
     0     0 -2820.8294    0  647 -11635.834 -2820.8294  75.8%     -  784s
     0     0 -2830.2273    0  574 -11635.834 -2830.2273  75.7%     -  789s
     0     0 -2832.4785    0  586 -11635.834 -2832.4785  75.7%     -  791s
     0     0 -2920.1456    0  647 -11635.834 -2920.1456  74.9%     -  801s
     0     0 -2947.5774    0  661 -11635.834 -2947.5774  74.7%     -  819s
     0     0 -2957.9088    0  737 -11635.834 -2957.9088  74.6%     -  824s
     0     0 -2962.6899    0  743 -11635.834 -2962.6899  74.5%     -  829s
     0     0 -2965.1931    0  912 -11635.834 -2965.1931  74.5%     -  832s
     0     0 -2967.8739    0  904 -11635.834 -2967.8739  74.5%     -  834s
     0     0 -2968.8344    0  916 -11635.834 -2968.8344  74.5%     -  836s
     0     0 -3018.8810    0  579 -11635.834 -3018.8810  74.1%     -  846s
     0     0 -3024.4480    0  579 -11635.834 -3024.4480  74.0%     -  849s
     0     0 -3027.7852    0  500 -11635.834 -3027.7852  74.0%     -  851s
     0     0 -3031.0312    0  490 -11635.834 -3031.0312  74.0%     -  852s
     0     0 -3031.7971    0  489 -11635.834 -3031.7971  73.9%     -  853s
     0     0 -3114.9920    0  549 -11635.834 -3114.9920  73.2%     -  863s
     0     0 -3120.2773    0  732 -11635.834 -3120.2773  73.2%     -  868s
     0     0 -3123.8742    0  562 -11635.834 -3123.8742  73.2%     -  870s
     0     0 -3127.3251    0  561 -11635.834 -3127.3251  73.1%     -  872s
     0     0 -3128.0154    0  558 -11635.834 -3128.0154  73.1%     -  872s
     0     0 -3167.8009    0  643 -11635.834 -3167.8009  72.8%     -  881s
     0     0 -3170.0929    0  636 -11635.834 -3170.0929  72.8%     -  883s
     0     0 -3180.3702    0  558 -11635.834 -3180.3702  72.7%     -  888s
     0     0 -3210.3916    0  622 -11635.834 -3210.3916  72.4%     -  895s
     0     0 -3220.8416    0  640 -11635.834 -3220.8416  72.3%     -  899s
     0     0 -3222.1137    0  634 -11635.834 -3222.1137  72.3%     -  900s
     0     0 -3231.8370    0  640 -11635.834 -3231.8370  72.2%     -  905s
     0     0 -3235.4823    0  563 -11635.834 -3235.4823  72.2%     -  907s
     0     0 -3236.0398    0  571 -11635.834 -3236.0398  72.2%     -  909s
     0     0 -3262.6070    0  652 -11635.834 -3262.6070  72.0%     -  915s
     0     0 -3265.6879    0  572 -11635.834 -3265.6879  71.9%     -  959s
     0     0 -3266.5350    0  644 -11635.834 -3266.5350  71.9%     -  962s
     0     0 -3272.0668    0  560 -11635.834 -3272.0668  71.9%     -  968s
     0     0 -3280.7631    0  556 -11635.834 -3280.7631  71.8%     -  972s
     0     0 -3282.5390    0  644 -11635.834 -3282.5390  71.8%     -  974s
     0     0 -3289.6024    0  644 -11635.834 -3289.6024  71.7%     -  979s
     0     0 -3292.9139    0  642 -11635.834 -3292.9139  71.7%     -  982s
     0     0 -3295.0793    0  643 -11635.834 -3295.0793  71.7%     -  983s
     0     0 -3309.0589    0  645 -11635.834 -3309.0589  71.6%     -  988s
     0     0 -3309.7776    0  645 -11635.834 -3309.7776  71.6%     -  994s
     0     2 -3309.7776    0  645 -11635.834 -3309.7776  71.6%     - 1094s
     1     3 -3761.6386    1  537 -11635.834 -3310.6452  71.5% 15411 1108s
     2     4 -3975.0804    1  563 -11635.834 -3761.9421  67.7% 19810 1129s
     3     7 -4762.2706    2  605 -11635.834 -3761.9421  67.7% 19795 1146s
     6    12 -5008.0883    3  594 -11635.834 -3761.9421  67.7% 16224 1165s
    11    23 -5064.6360    4  609 -11635.834 -4240.2821  63.6% 13311 1210s
    22    34 -6533.3074    4  607 -11635.834 -4543.1171  61.0% 19397 1287s
    33    63 -6498.9466    6  677 -11635.834 -4543.1171  61.0% 26923 1520s
    62    94 -6545.2815    5  527 -11635.834 -4543.1171  61.0% 32792 1577s
    93   161 -5803.6014    6  579 -11635.834 -4543.1171  61.0% 28537 1649s
   160   254 -5817.7599    7  491 -11635.834 -4543.1171  61.0% 19440 1700s
   261   297 -6177.5148   10  442 -11635.834 -4543.1171  61.0% 14415 1735s
   337   335 -6698.4519   11  341 -11635.834 -4543.1171  61.0% 12569 1769s
   400   368 -9158.3043   13  277 -11635.834 -4543.1171  61.0% 12119 1799s
   466   397 -7674.6727   12  310 -11635.834 -4543.1171  61.0% 11334 1832s
   544   431 -9424.7602   18  351 -11635.834 -4543.1171  61.0% 10584 1859s
   612   442 -8616.0311   22  435 -11635.834 -4543.1171  61.0% 10253 1882s
   686   452 -8642.0386   23  381 -11635.834 -4543.1171  61.0%  9715 1903s
   732   478 -9060.9927   24  350 -11635.834 -4543.1171  61.0%  9568 1925s
   788   505 -9056.7713   23  374 -11635.834 -4543.1171  61.0%  9300 1945s
   836   555 -9237.2761   25  354 -11635.834 -4543.1171  61.0%  9239 1963s
   912   606 -8846.8080   24  278 -11635.834 -4543.1171  61.0%  8955 1984s
   993   649 -9264.3089   24  431 -11635.834 -4543.1171  61.0%  8649 2001s
  1054   663 -9331.0793   26  235 -11635.834 -4543.1171  61.0%  8475 2022s
  1110   705 -9554.4643   26  340 -11635.834 -4543.1171  61.0%  8291 2058s
  1176   734 -9735.9518   27  289 -11635.834 -4543.1171  61.0%  8117 2083s
  1257   763 -9918.6719   29  284 -11635.834 -4543.1171  61.0%  7944 2109s
  1354   787 -10080.400   32  264 -11635.834 -4543.1171  61.0%  7760 2133s
  1453   835 -11307.677   34  236 -11635.834 -4543.1171  61.0%  7578 2157s
  1550   863 -11341.477   35  147 -11635.834 -4543.1171  61.0%  7471 2184s
  1652   936 -10588.234   36  273 -11635.834 -4543.1171  61.0%  7373 2211s
  1807   983 -10807.742   43  128 -11635.834 -4543.1171  61.0%  7107 2241s
  1960   999     cutoff   50      -11635.834 -4543.1171  61.0%  6951 2272s
  2075  1010 -9345.3001   10  112 -11635.834 -4543.1171  61.0%  6910 2306s
  2143  1025 -10372.352   12  101 -11635.834 -4543.1171  61.0%  7008 2340s
  2217  1044 -9997.7881   12  115 -11635.834 -4543.1171  61.0%  7092 2380s
  2274  1074 -10855.967   13   94 -11635.834 -4543.1171  61.0%  7212 2418s
  2349  1107 -10185.334   14  157 -11635.834 -4543.1171  61.0%  7257 2459s
  2467  1116 -10279.128   15  320 -11635.834 -4543.1171  61.0%  7223 2503s
  2576  1133 -11031.381   17  212 -11635.834 -4543.1171  61.0%  7257 2544s
  2675  1159     cutoff   18      -11635.834 -4543.1171  61.0%  7311 2592s
  2770  1195 -11369.078   21   87 -11635.834 -4543.1171  61.0%  7402 2639s
  2928  1224 infeasible   25      -11635.834 -4752.7812  59.2%  7406 2691s
  3065  1255 -6916.2949    9  388 -11635.834 -4752.7812  59.2%  7470 2747s
  3170  1273 -7962.7370   10  333 -11635.834 -4752.7812  59.2%  7621 2797s
  3246  1290 -9816.7069   11  191 -11635.834 -4752.7812  59.2%  7734 2843s
  3295  1307 infeasible   12      -11635.834 -4752.7812  59.2%  7792 2894s
  3363  1328 -10530.064   13  167 -11635.834 -4752.7812  59.2%  7843 2942s
  3455  1372     cutoff   14      -11635.834 -4752.7812  59.2%  7942 2998s
  3596  1434 -9282.9355   13  306 -11635.834 -5305.9224  54.4%  7964 3062s
  3762  1475 -9657.5561   15  524 -11635.834 -5306.2466  54.4%  7970 3119s
  3946  1503 -10261.233   18  517 -11635.834 -5306.2466  54.4%  8051 3185s
  4117  1556 -11452.294   22  563 -11635.834 -5306.2466  54.4%  8094 3250s
  4310  1590     cutoff   15      -11635.834 -5306.2466  54.4%  8164 3308s
  4444  1672 infeasible    9      -11635.834 -7207.0933  38.1%  8211 3374s
  4669  1717 -9827.4707    7  613 -11635.834 -7207.0933  38.1%  8153 3444s
  4882  1768 -11250.760    9  507 -11635.834 -7207.0933  38.1%  8187 3520s
  5105  1794 -7755.1103    9  578 -11635.834 -7367.7294  36.7%  8233 3599s
  5317  1787 infeasible   15      -11635.834 -7367.7294  36.7%  8305 3600s

Cutting planes:
  Learned: 2
  Gomory: 6
  Implied bound: 318
  MIR: 4323
  Flow cover: 4594
  Inf proof: 2
  RLT: 303
  Relax-and-lift: 1720

Explored 5326 nodes (45001784 simplex iterations) in 3600.06 seconds (8379.44 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -11635.8 -11872.4 -11904.6 ... -12378.6

Time limit reached
Best objective -1.163583406704e+04, best bound -7.367729438830e+03, gap 36.6807%
  WARNING: Time limit reached. Using best solution found (gap: 36.68%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = -11635.83, θ = 113322.28
  Upper Bound (UB) = -11635.83

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 113322.28
  [DEBUG]   ✓ Scenario 0: θ = 113322.28 ≤ Q = 113322.28 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 113322.28 ≤ Q = 113322.28 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 113322.28 ≤ Q = 113322.28 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 113322.28 ≤ Q = 113322.28 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 113322.28 ≤ Q = 113322.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 113322.28 ≤ Q = 113322.28 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 113322.28 ≤ Q = 113322.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 113322.28 ≤ Q = 113322.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 113322.28 ≤ Q = 113322.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 113322.28 ≤ Q = 113322.28 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 113322.28 ≤ Q = 113322.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 113322.28 ≤ Q = 113322.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 113322.28 ≤ Q = 113322.28 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 13] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x473739b4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x473739b4
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [9e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.249579e+13
Presolve removed 2589 rows and 1882 columns
Presolve time: 0.00s
Presolved: 504 rows, 507 columns, 1421 nonzeros
Found heuristic solution: objective 6287478.4687
Variable types: 343 continuous, 164 integer (164 binary)

Root relaxation: objective -1.246796e+05, 243 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -124679.56    0  123 6287478.47 -124679.56   102%     -    0s
H    0     0                    -89432.96300 -124679.56  39.4%     -    0s
H    0     0                    -90368.07118 -124679.56  38.0%     -    0s
     0     0 -96596.973    0   75 -90368.071 -96596.973  6.89%     -    0s
H    0     0                    -94997.62506 -96583.192  1.67%     -    0s
H    0     0                    -95612.13026 -96583.192  1.02%     -    0s
     0     0 -96300.911    0   75 -95612.130 -96300.911  0.72%     -    0s
     0     0 -96289.150    0   75 -95612.130 -96289.150  0.71%     -    0s
     0     0 -96008.380    0   77 -95612.130 -96008.380  0.41%     -    0s
     0     0 -95960.131    0   71 -95612.130 -95960.131  0.36%     -    0s
     0     0 -95959.696    0   69 -95612.130 -95959.696  0.36%     -    0s
     0     0 -95957.535    0   69 -95612.130 -95957.535  0.36%     -    0s
     0     0 -95880.247    0   46 -95612.130 -95880.247  0.28%     -    0s
     0     0 -95861.359    0   57 -95612.130 -95861.359  0.26%     -    0s
     0     0 -95797.089    0   61 -95612.130 -95797.089  0.19%     -    0s
     0     0 -95796.656    0   61 -95612.130 -95796.656  0.19%     -    0s
     0     0 -95796.656    0   55 -95612.130 -95796.656  0.19%     -    0s
     0     0 -95796.656    0   21 -95612.130 -95796.656  0.19%     -    0s
H    0     0                    -95667.31043 -95796.656  0.14%     -    0s
     0     0 -95796.656    0   53 -95667.310 -95796.656  0.14%     -    0s
     0     0 -95795.242    0   53 -95667.310 -95795.242  0.13%     -    0s
     0     0 -95780.585    0   54 -95667.310 -95780.585  0.12%     -    0s
     0     0 -95765.209    0   54 -95667.310 -95765.209  0.10%     -    0s
     0     0 -95721.403    0   49 -95667.310 -95721.403  0.06%     -    0s
     0     0 -95713.724    0   49 -95667.310 -95713.724  0.05%     -    0s
     0     0 -95712.928    0   49 -95667.310 -95712.928  0.05%     -    0s
     0     0 -95712.697    0   49 -95667.310 -95712.697  0.05%     -    0s
     0     0 -95694.994    0   49 -95667.310 -95694.994  0.03%     -    0s
     0     0 -95694.407    0   49 -95667.310 -95694.407  0.03%     -    0s
     0     0 -95694.407    0   38 -95667.310 -95694.407  0.03%     -    0s
     0     0 -95694.407    0   39 -95667.310 -95694.407  0.03%     -    0s
     0     0 -95694.407    0   38 -95667.310 -95694.407  0.03%     -    0s
     0     0 -95694.407    0   37 -95667.310 -95694.407  0.03%     -    0s
     0     0 -95688.664    0   38 -95667.310 -95688.664  0.02%     -    0s
     0     0 -95687.535    0   38 -95667.310 -95687.535  0.02%     -    0s

Cutting planes:
  Gomory: 4
  Implied bound: 4
  MIR: 50
  Flow cover: 31
  RLT: 6

Explored 1 nodes (1178 simplex iterations) in 0.17 seconds (0.07 work units)
Thread count was 32 (of 256 available processors)

Solution count 9: -95667.3 -95612.1 -91498.7 ... 1.24958e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -9.566731042924e+04, best bound -9.567245832563e+04, gap 0.0054%
  Subproblem solved in 0.20s
  Worst-case operational profit (Z_SP) = 110330.56
  Scenario: 9 demand increases, 51 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -95667.31
  [DEBUG]   S×d_nominal = 205997.87
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 205997.87 + -95667.31 = 110330.56
  [DEBUG]   Current θ from Master = 113322.28
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2991.73 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -14627.56
  Lower Bound (LB) = -12324.91
  Gap (UB-LB) = 689.0727, Absolute Gap = 689.0727, Relative Gap = 0.059220
  Not converged yet (gap = 689.07 > ε = 200)

  [DEBUG] Adding NEW scenario 13 to Master Problem...
  [DEBUG] New scenario pattern: 9 increases, 51 decreases
    [DEBUG] Scenario 13 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 13 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 13]
    [DEBUG]   - Total constraints in model: 215443
    [DEBUG]   - Total variables in model: 89620
  [DEBUG] Total scenarios in Master: 14
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 14
================================================================================
[Iteration 14] Solving Master Problem...
  Current scenarios in Master: 14
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 215443 rows, 89620 columns and 610837 nonzeros
Model fingerprint: 0x771df52f
Variable types: 87361 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-03, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 96232 rows and 39072 columns
Presolve time: 1.63s
Presolved: 119211 rows, 50548 columns, 733216 nonzeros
Variable types: 48289 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -366196.7547
Found heuristic solution: objective -196432.4631

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.78s

Barrier statistics:
 Dense cols : 751
 AA' NZ     : 4.216e+06
 Factor NZ  : 9.853e+06 (roughly 150 MB of memory)
 Factor Ops : 2.097e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.72821646e+07  1.99018419e+08  8.82e+04 1.82e+01  6.98e+04     4s
   1  -1.30175517e+07  1.75066005e+08  6.12e+04 5.22e+01  4.80e+04     4s
   2  -5.53591369e+06  1.37441353e+08  2.54e+04 3.94e+00  2.11e+04     4s
   3  -7.20860435e+05  9.87608498e+07  1.34e+03 1.24e+00  1.50e+03     4s
   4  -5.23003436e+05  7.70681410e+07  5.16e+02 8.64e-01  7.39e+02     4s
   5  -4.55282084e+05  4.21490480e+07  2.89e+02 3.96e-01  3.90e+02     4s
   6  -3.68890818e+05  3.24121698e+07  1.01e+02 2.89e-01  2.14e+02     4s
   7  -3.15881088e+05  2.44553501e+07  4.17e+01 2.06e-01  1.37e+02     4s
   8  -2.24506100e+05  1.80874387e+07  1.89e+00 1.47e-01  8.49e+01     4s
   9  -1.37883667e+05  9.07078447e+06  1.49e-01 7.26e-02  4.23e+01     4s
  10  -1.03907748e+05  3.27787469e+06  7.04e-02 2.51e-02  1.55e+01     4s
  11  -7.33082596e+04  1.27035967e+06  2.51e-02 9.30e-03  6.16e+00     4s
  12  -4.29020966e+04  4.03686087e+05  7.92e-03 2.70e-03  2.05e+00     4s
  13  -2.92749006e+04  2.15815741e+05  4.61e-03 1.47e-03  1.12e+00     4s
  14  -2.33967384e+04  1.35793558e+05  3.61e-03 8.74e-04  7.30e-01     4s
  15  -1.83965508e+04  1.19221901e+05  2.90e-03 7.71e-04  6.31e-01     4s
  16  -1.38258414e+04  7.71598335e+04  2.27e-03 4.65e-04  4.17e-01     4s
  17  -9.08722062e+03  5.39347507e+04  1.67e-03 5.72e-04  2.89e-01     4s
  18  -5.86020443e+03  4.19478787e+04  1.29e-03 4.23e-04  2.19e-01     4s
  19  -3.73891744e+03  3.57546928e+04  1.07e-03 3.46e-04  1.81e-01     4s
  20  -1.90694719e+03  2.80755553e+04  8.97e-04 2.99e-04  1.38e-01     4s
  21   1.56794600e+03  2.59267465e+04  5.73e-04 2.64e-04  1.12e-01     4s
  22   3.67884694e+03  1.98293636e+04  4.05e-04 1.66e-04  7.41e-02     4s
  23   5.54982018e+03  1.60997950e+04  2.75e-04 1.06e-04  4.84e-02     5s
  24   6.46104830e+03  1.45737592e+04  2.18e-04 7.89e-05  3.72e-02     5s
  25   7.45751837e+03  1.30251131e+04  1.57e-04 5.02e-05  2.55e-02     5s
  26   8.02620275e+03  1.19116306e+04  1.23e-04 2.99e-05  1.78e-02     5s
  27   8.65947159e+03  1.14596595e+04  8.54e-05 2.17e-05  1.28e-02     5s
  28   8.94759883e+03  1.10065768e+04  6.86e-05 1.37e-05  9.44e-03     5s
  29   9.08726444e+03  1.06921510e+04  6.03e-05 8.54e-06  7.36e-03     5s
  30   9.33729807e+03  1.04965585e+04  4.59e-05 5.42e-06  5.32e-03     5s
  31   9.41543838e+03  1.03927521e+04  4.08e-05 3.95e-06  4.48e-03     5s
  32   9.52679545e+03  1.03765236e+04  3.40e-05 3.71e-06  3.90e-03     5s
  33   9.64726845e+03  1.03547377e+04  2.70e-05 3.42e-06  3.25e-03     5s
  34   9.67481231e+03  1.03026314e+04  2.52e-05 2.71e-06  2.88e-03     5s
  35   9.69288079e+03  1.02660814e+04  2.41e-05 2.21e-06  2.63e-03     5s
  36   9.74890580e+03  1.02552695e+04  2.08e-05 2.06e-06  2.32e-03     5s
  37   9.80248986e+03  1.02234505e+04  1.75e-05 1.63e-06  1.93e-03     5s
  38   9.83889740e+03  1.02042814e+04  1.54e-05 1.38e-06  1.68e-03     5s
  39   9.87364063e+03  1.01820742e+04  1.33e-05 1.06e-06  1.41e-03     5s
  40   9.92809823e+03  1.01612234e+04  1.01e-05 7.77e-07  1.07e-03     6s
  41   9.95495445e+03  1.01372555e+04  8.53e-06 4.27e-07  8.36e-04     6s
  42   1.00165595e+04  1.01297969e+04  5.02e-06 3.20e-07  5.19e-04     6s
  43   1.00355800e+04  1.01189435e+04  3.93e-06 1.63e-07  3.82e-04     6s
  44   1.00631856e+04  1.01167284e+04  2.38e-06 1.33e-07  2.46e-04     6s
  45   1.00897288e+04  1.01096462e+04  8.97e-07 4.45e-08  9.14e-05     6s
  46   1.01014422e+04  1.01076940e+04  2.44e-07 6.78e-08  2.87e-05     6s
  47   1.01059912e+04  1.01062996e+04  3.01e-08 3.32e-09  1.42e-06     6s
  48   1.01062305e+04  1.01062311e+04  5.94e-09 1.41e-09  2.71e-09     6s
  49   1.01062307e+04  1.01062311e+04  1.04e-07 1.64e-09  1.88e-09     6s
  50   1.01062311e+04  1.01062311e+04  5.06e-09 2.11e-11  4.61e-12     6s

Barrier solved model in 50 iterations and 6.00 seconds (12.64 work units)
Optimal objective 1.01062311e+04


Root crossover log...

  100172 DPushes remaining with DInf 0.0000000e+00                 6s
       0 DPushes remaining with DInf 0.0000000e+00                 9s

    2532 PPushes remaining with PInf 4.5073560e-07                 9s
       0 PPushes remaining with PInf 0.0000000e+00                 9s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.4361938e-10      9s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   50158    1.0106231e+04   0.000000e+00   0.000000e+00      9s
   50158    1.0106231e+04   0.000000e+00   0.000000e+00     10s
Concurrent spin time: 0.78s

Solved with barrier

Root relaxation: objective 1.010623e+04, 50158 iterations, 8.02 seconds (19.62 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 10106.2311    0  348 -196432.46 10106.2311   105%     -   10s
H    0     0                    -52762.61561 10106.2311   119%     -   11s
H    0     0                    -48575.50120 10106.2311   121%     -   11s
H    0     0                    -48542.03396 10106.2311   121%     -   11s
H    0     0                    -43102.53792 10106.2311   123%     -   11s
H    0     0                    -20843.14260 10106.2311   148%     -   11s
H    0     0                    -17098.67055 10106.2311   159%     -   11s
H    0     0                    -16554.24925 10106.2311   161%     -   11s
H    0     0                    -16494.87350 10106.2311   161%     -   11s
H    0     0                    -16402.85420 5173.10747   132%     -   38s
H    0     0                    -16358.83965 5173.10747   132%     -   38s
     0     0 5173.10747    0  368 -16358.840 5173.10747   132%     -   38s
     0     0 4735.89345    0  498 -16358.840 4735.89345   129%     -   49s
     0     0 4635.76962    0  379 -16358.840 4635.76962   128%     -   56s
     0     0 4617.46671    0  382 -16358.840 4617.46671   128%     -   59s
     0     0 4604.64490    0  377 -16358.840 4604.64490   128%     -   60s
     0     0 4601.11488    0  366 -16358.840 4601.11488   128%     -   62s
     0     0 4591.22030    0  495 -16358.840 4591.22030   128%     -   65s
     0     0 4590.71611    0  495 -16358.840 4590.71611   128%     -   66s
     0     0 4587.11436    0  493 -16358.840 4587.11436   128%     -   67s
     0     0 2370.46606    0  488 -16358.840 2370.46606   114%     -  101s
H    0     0                    -11809.96903 2369.97523   120%     -  101s
H    0     0                    -11806.07609 2369.97523   120%     -  101s
H    0     0                    -11804.19114 2369.97523   120%     -  101s
     0     0 2015.92490    0  480 -11804.191 2015.92490   117%     -  113s
     0     0 1978.30257    0  491 -11804.191 1978.30257   117%     -  119s
     0     0 1968.06009    0  513 -11804.191 1968.06009   117%     -  121s
     0     0 1934.70008    0  488 -11804.191 1934.70008   116%     -  128s
     0     0 1832.43867    0  497 -11804.191 1832.43867   116%     -  135s
     0     0 1786.81536    0  498 -11804.191 1786.81536   115%     -  137s
     0     0 1785.24121    0  502 -11804.191 1785.24121   115%     -  139s
     0     0 1784.96831    0  505 -11804.191 1784.96831   115%     -  141s
     0     0 -405.08304    0  528 -11804.191 -405.08304  96.6%     -  176s
H    0     0                    -11797.98372 -405.15570  96.6%     -  177s
H    0     0                    -11797.37029 -405.15570  96.6%     -  177s
H    0     0                    -11796.97628 -405.15570  96.6%     -  177s
H    0     0                    -11790.58803 -405.15570  96.6%     -  177s
H    0     0                    -11782.05299 -405.15570  96.6%     -  177s
H    0     0                    -11761.00650 -405.15570  96.6%     -  177s
H    0     0                    -11757.85328 -907.18107  92.3%     -  201s
H    0     0                    -11753.96034 -907.18107  92.3%     -  201s
     0     0 -907.18107    0  443 -11753.960 -907.18107  92.3%     -  201s
     0     0 -1017.6682    0  518 -11753.960 -1017.6682  91.3%     -  209s
     0     0 -1049.7174    0  517 -11753.960 -1049.7174  91.1%     -  215s
     0     0 -1070.8144    0  592 -11753.960 -1070.8144  90.9%     -  220s
     0     0 -1096.9463    0  599 -11753.960 -1096.9463  90.7%     -  223s
     0     0 -1101.8354    0  595 -11753.960 -1101.8354  90.6%     -  225s
     0     0 -1141.8060    0  531 -11753.960 -1141.8060  90.3%     -  232s
     0     0 -1153.1231    0  544 -11753.960 -1153.1231  90.2%     -  235s
     0     0 -1222.2198    0  534 -11753.960 -1222.2198  89.6%     -  240s
     0     0 -1232.7771    0  537 -11753.960 -1232.7771  89.5%     -  243s
     0     0 -1305.3897    0  468 -11753.960 -1305.3897  88.9%     -  254s
     0     0 -1325.9458    0  554 -11753.960 -1325.9458  88.7%     -  260s
     0     0 -1329.5044    0  540 -11753.960 -1329.5044  88.7%     -  263s
     0     0 -1331.6328    0  552 -11753.960 -1331.6328  88.7%     -  267s
     0     0 -1333.7152    0  549 -11753.960 -1333.7152  88.7%     -  269s
     0     0 -1342.9003    0  542 -11753.960 -1342.9003  88.6%     -  271s
     0     0 -1368.4219    0  530 -11753.960 -1368.4219  88.4%     -  274s
H    0     0                    -11655.99709 -1374.2817  88.2%     -  275s
     0     0 -1374.2817    0  537 -11655.997 -1374.2817  88.2%     -  275s
     0     0 -1375.0241    0  534 -11655.997 -1375.0241  88.2%     -  276s
     0     0 -2151.3079    0  491 -11655.997 -2151.3079  81.5%     -  294s
     0     0 -2420.3300    0  489 -11655.997 -2420.3300  79.2%     -  304s
     0     0 -2488.0761    0  566 -11655.997 -2488.0761  78.7%     -  312s
     0     0 -2561.8896    0  567 -11655.997 -2561.8896  78.0%     -  318s
     0     0 -2579.1076    0  578 -11655.997 -2579.1076  77.9%     -  322s
     0     0 -2592.6964    0  575 -11655.997 -2592.6964  77.8%     -  324s
     0     0 -2612.0939    0  633 -11655.997 -2612.0939  77.6%     -  328s
     0     0 -2661.6317    0  635 -11655.997 -2661.6317  77.2%     -  332s
     0     0 -2674.2209    0  648 -11655.997 -2674.2209  77.1%     -  334s
     0     0 -2776.7799    0  559 -11655.997 -2776.7799  76.2%     -  338s
     0     0 -2805.0131    0  561 -11655.997 -2805.0131  75.9%     -  342s
     0     0 -2824.6108    0  565 -11655.997 -2824.6108  75.8%     -  344s
     0     0 -2833.9404    0  634 -11655.997 -2833.9404  75.7%     -  345s
     0     0 -2835.2349    0  634 -11655.997 -2835.2349  75.7%     -  346s
     0     0 -3132.8054    0  558 -11655.997 -3132.8054  73.1%     -  357s
     0     0 -3163.3247    0  562 -11655.997 -3163.3247  72.9%     -  361s
     0     0 -3172.0580    0  637 -11655.997 -3172.0580  72.8%     -  363s
     0     0 -3178.3111    0  641 -11655.997 -3178.3111  72.7%     -  364s
     0     0 -3193.7428    0  648 -11655.997 -3193.7428  72.6%     -  366s
     0     0 -3196.8308    0  583 -11655.997 -3196.8308  72.6%     -  368s
     0     0 -3197.7749    0  651 -11655.997 -3197.7749  72.6%     -  369s
     0     0 -3306.3813    0  561 -11655.997 -3306.3813  71.6%     -  378s
     0     0 -3327.4629    0  552 -11655.997 -3327.4629  71.5%     -  385s
     0     0 -3346.2119    0  553 -11655.997 -3346.2119  71.3%     -  388s
     0     0 -3354.3859    0  557 -11655.997 -3354.3859  71.2%     -  389s
     0     0 -3356.2303    0  566 -11655.997 -3356.2303  71.2%     -  390s
     0     0 -3376.0761    0  583 -11655.997 -3376.0761  71.0%     -  395s
     0     0 -3379.4520    0  578 -11655.997 -3379.4520  71.0%     -  398s
     0     0 -3382.7092    0  590 -11655.997 -3382.7092  71.0%     -  400s
     0     0 -3383.3186    0  589 -11655.997 -3383.3186  71.0%     -  401s
     0     0 -3399.1516    0  585 -11655.997 -3399.1516  70.8%     -  405s
     0     0 -3406.2278    0  590 -11655.997 -3406.2278  70.8%     -  408s
     0     0 -3409.0345    0  592 -11655.997 -3409.0345  70.8%     -  409s
     0     0 -3410.0273    0  592 -11655.997 -3410.0273  70.7%     -  410s
     0     0 -3434.3145    0  643 -11655.997 -3434.3145  70.5%     -  415s
     0     0 -3438.3173    0  571 -11655.997 -3438.3173  70.5%     -  417s
     0     0 -3440.1225    0  576 -11655.997 -3440.1225  70.5%     -  419s
     0     0 -3450.4334    0  570 -11655.997 -3450.4334  70.4%     -  422s
     0     0 -3452.7421    0  576 -11655.997 -3452.7421  70.4%     -  424s
     0     0 -3454.7974    0  585 -11655.997 -3454.7974  70.4%     -  425s
     0     0 -3456.3486    0  588 -11655.997 -3456.3486  70.3%     -  425s
     0     0 -3464.8240    0  584 -11655.997 -3464.8240  70.3%     -  429s
     0     0 -3467.0078    0  592 -11655.997 -3467.0078  70.3%     -  431s
     0     0 -3467.4371    0  591 -11655.997 -3467.4371  70.3%     -  432s
     0     0 -3474.6510    0  606 -11655.997 -3474.6510  70.2%     -  436s
     0     0 -3476.0334    0  602 -11655.997 -3476.0334  70.2%     -  443s
     0     0 -3485.1727    0  595 -11655.997 -3485.1727  70.1%     -  447s
     0     0 -3485.2703    0  595 -11655.997 -3485.2703  70.1%     -  452s
     0     2 -3485.6107    0  595 -11655.997 -3485.6107  70.1%     -  551s
     1     3 -3593.2639    1  542 -11655.997 -3485.8889  70.1%  3317  555s
     2     4 -3603.0506    1  578 -11655.997 -3593.2982  69.2%  2307  561s
     3     7 -4446.0923    2  588 -11655.997 -3593.3812  69.2%  3743  576s
     6    14 -4057.1996    3  558 -11655.997 -3603.7180  69.1%  6546  588s
    13    28 -4862.9375    4  557 -11655.997 -3786.5245  67.5%  7816  605s
    27    43 -7744.6833    5  189 -11655.997 -4594.6601  60.6% 12948  653s
    42    70 -7671.1792    6  206 -11655.997 -4597.3375  60.6% 12584  740s
    71   147 -7853.7027    7  215 -11655.997 -4668.3394  59.9% 13050  773s
   148   224 -7970.4988    8  191 -11655.997 -4668.3394  59.9%  9518  804s
   229   253 -8809.4684   11  157 -11655.997 -4668.3394  59.9%  8090  824s
   267   302 -8836.7583   11  149 -11655.997 -4668.3394  59.9%  7821  843s
   325   338 -8835.3450   10  174 -11655.997 -4668.3394  59.9%  7301  863s
   396   365 -9833.2015   12  134 -11655.997 -4668.3394  59.9%  6917  883s
   463   373 -9598.4470   12  127 -11655.997 -4668.3394  59.9%  6548  900s
   509   375 -10228.170   13  112 -11655.997 -4668.3394  59.9%  6458  919s
   553   385 -11350.789   15   81 -11655.997 -4668.3394  59.9%  6426  939s
   593   394 infeasible   18      -11655.997 -4668.3394  59.9%  6537  959s
   628   411 -7208.5756   10  561 -11655.997 -4668.3394  59.9%  6567  979s
   670   438 -7778.2034   11  536 -11655.997 -4668.3394  59.9%  6803 1001s
   720   473 -8167.1851   12  537 -11655.997 -4668.3394  59.9%  6945 1023s
   771   517 -11144.296   18  139 -11655.997 -4668.3394  59.9%  6923 1045s
   841   526 -8249.7138   12  461 -11655.997 -4668.3394  59.9%  6696 1068s
   922   555 -8540.3204   13  306 -11655.997 -4668.3394  59.9%  6496 1090s
  1017   574 -8559.7965   14  444 -11655.997 -4668.3394  59.9%  6221 1109s
  1081   588 -9027.0454   15  319 -11655.997 -4668.3394  59.9%  6083 1128s
  1175   610 -9397.2959   16  351 -11655.997 -4668.3394  59.9%  5943 1148s
  1264   640 -7990.4671   14  379 -11655.997 -4668.3394  59.9%  5828 1171s
  1350   693 -11450.885   17  393 -11655.997 -4668.3394  59.9%  5737 1190s
  1439   723 -11481.261   18  294 -11655.997 -4668.3394  59.9%  5682 1210s
  1549   751 infeasible   19      -11655.997 -4668.3394  59.9%  5657 1233s
  1640   829 -9893.2657    9  157 -11655.997 -4668.3394  59.9%  5678 1257s
  1746   858 -10585.338   11  154 -11655.997 -4668.3394  59.9%  5680 1287s
  1848   906 infeasible   13      -11655.997 -4668.3394  59.9%  5616 1338s
  1941   942 -7829.1941    8  504 -11655.997 -4668.3394  59.9%  5615 1366s
  2069   964 -9986.0520   10  155 -11655.997 -4668.3394  59.9%  5473 1394s
  2151   986 infeasible   14      -11655.997 -4668.3394  59.9%  5559 1420s
  2221  1025 infeasible   14      -11655.997 -4808.7584  58.7%  5651 1451s
  2306  1039 -5336.8776    5  540 -11655.997 -4808.7584  58.7%  5774 1483s
  2388  1053 -6416.1386    7  500 -11655.997 -4808.7584  58.7%  5862 1512s
  2452  1078 -7332.4359    9  403 -11655.997 -4808.7584  58.7%  5974 1545s
  2533  1128 -9263.4439   11  471 -11655.997 -4808.7584  58.7%  6095 1577s
  2637  1165 -10206.186   13  268 -11655.997 -4808.7584  58.7%  6170 1613s
  2750  1180 infeasible   14      -11655.997 -5213.8580  55.3%  6246 1648s
  2837  1203 infeasible   14      -11655.997 -5523.5475  52.6%  6334 1685s
  2959  1217 -8822.7869    6  598 -11655.997 -5523.5475  52.6%  6423 1723s
  3055  1252 -10022.769    7  779 -11655.997 -5523.5475  52.6%  6539 1762s
  3177  1275 -10050.560    8  594 -11655.997 -5523.5475  52.6%  6625 1803s
  3304  1299     cutoff    8      -11655.997 -6401.5760  45.1%  6722 1846s
  3410  1333 -11649.807    9  567 -11655.997 -6853.6546  41.2%  6829 1892s
  3544  1363 -11227.541   10  617 -11655.997 -6853.6546  41.2%  6893 1937s
  3665  1382 infeasible   12      -11655.997 -6853.6546  41.2%  6963 1980s
  3774  1419     cutoff   11      -11655.997 -6922.6529  40.6%  7039 2034s
  3916  1478 -8607.5478   10  339 -11655.997 -6922.6529  40.6%  7131 2101s
  4049  1509 -9032.1644   13  182 -11655.997 -6922.6529  40.6%  7240 2161s
  4208  1574 infeasible   17      -11655.997 -7124.2806  38.9%  7306 2225s
  4401  1644 -11021.972   32   61 -11655.997 -7124.2806  38.9%  7313 2291s
  4631  1685 -10455.149    8  259 -11655.997 -7124.2806  38.9%  7300 2359s
  4788  1712 infeasible    9      -11655.997 -7124.2806  38.9%  7428 2429s
  4984  1733 -9405.1081    7  581 -11655.997 -7409.0550  36.4%  7493 2534s
  5119  1744 infeasible    9      -11655.997 -7409.0550  36.4%  7592 2591s
  5182  1767 -10129.768    9  557 -11655.997 -7409.0550  36.4%  7658 2660s
  5292  1821 -10457.688   10  555 -11655.997 -7409.0550  36.4%  7717 2733s
  5492  1884     cutoff   12      -11655.997 -7602.9583  34.8%  7792 2808s
  5770  1924 infeasible   13      -11655.997 -7736.6066  33.6%  7787 2891s
  6040  1955     cutoff   10      -11655.997 -7872.0919  32.5%  7836 2977s
  6297  2003 -9997.5443   10  427 -11655.997 -7947.1816  31.8%  7881 3068s
  6553  2018 infeasible   15      -11655.997 -7947.1816  31.8%  7975 3155s
  6844  2082 infeasible   12      -11655.997 -8153.6071  30.0%  8017 3244s
  7234  2092 -11556.734   15   45 -11655.997 -8153.6071  30.0%  7956 3334s
  7547  2126 infeasible   11      -11655.997 -8340.6463  28.4%  7999 3425s
  7770  2194 infeasible   13      -11655.997 -8438.5628  27.6%  7991 3525s
  8200  2235 -11519.741   26   66 -11655.997 -8554.7359  26.6%  7923 3600s

Cutting planes:
  Gomory: 4
  Implied bound: 232
  MIR: 3101
  Flow cover: 3569
  Inf proof: 2
  RLT: 84
  Relax-and-lift: 580

Explored 8567 nodes (68173333 simplex iterations) in 3600.07 seconds (8955.23 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -11656 -11754 -11757.9 ... -11804.2

Time limit reached
Best objective -1.165599709062e+04, best bound -8.584792760735e+03, gap 26.3487%
  WARNING: Time limit reached. Using best solution found (gap: 26.35%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = -11656.00, θ = 113171.61
  Upper Bound (UB) = -11656.00

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 113171.61
  [DEBUG]   ✓ Scenario 0: θ = 113171.61 ≤ Q = 113171.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 113171.61 ≤ Q = 113171.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 113171.61 ≤ Q = 113171.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 113171.61 ≤ Q = 113171.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 113171.61 ≤ Q = 113171.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 113171.61 ≤ Q = 113171.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 113171.61 ≤ Q = 113171.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 113171.61 ≤ Q = 113171.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 113171.61 ≤ Q = 113171.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 113171.61 ≤ Q = 113171.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 113171.61 ≤ Q = 113171.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 113171.61 ≤ Q = 113171.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 113171.61 ≤ Q = 113171.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 113171.61 ≤ Q = 113171.61 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 14] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x232045ff
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x232045ff
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.249579e+13
Presolve removed 2589 rows and 1882 columns
Presolve time: 0.00s
Presolved: 504 rows, 507 columns, 1421 nonzeros
Found heuristic solution: objective 6295728.6281
Variable types: 343 continuous, 164 integer (164 binary)

Root relaxation: objective -1.248517e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -124851.67    0  123 6295728.63 -124851.67   102%     -    0s
H    0     0                    -89665.10801 -124851.67  39.2%     -    0s
H    0     0                    -90571.71523 -124851.67  37.8%     -    0s
     0     0 -96811.755    0   77 -90571.715 -96811.755  6.89%     -    0s
H    0     0                    -94867.13268 -96791.419  2.03%     -    0s
H    0     0                    -95239.04908 -96791.419  1.63%     -    0s
H    0     0                    -95496.19047 -96791.419  1.36%     -    0s
H    0     0                    -95868.10688 -96791.419  0.96%     -    0s
     0     0 -96503.118    0   73 -95868.107 -96503.118  0.66%     -    0s
H    0     0                    -95875.02926 -96463.061  0.61%     -    0s
     0     0 -96463.061    0   72 -95875.029 -96463.061  0.61%     -    0s
     0     0 -96169.970    0   50 -95875.029 -96169.970  0.31%     -    0s
     0     0 -96155.573    0   42 -95875.029 -96155.573  0.29%     -    0s
     0     0 -96149.338    0   39 -95875.029 -96149.338  0.29%     -    0s
     0     0 -96142.121    0   37 -95875.029 -96142.121  0.28%     -    0s
     0     0 -96139.098    0   36 -95875.029 -96139.098  0.28%     -    0s
     0     0 -96138.594    0   35 -95875.029 -96138.594  0.27%     -    0s
     0     0 -96080.907    0   31 -95875.029 -96080.907  0.21%     -    0s
     0     0 -96078.246    0   31 -95875.029 -96078.246  0.21%     -    0s
     0     0 -96065.339    0   36 -95875.029 -96065.339  0.20%     -    0s
     0     0 -96064.678    0   36 -95875.029 -96064.678  0.20%     -    0s
     0     0 -95929.859    0    9 -95875.029 -95929.859  0.06%     -    0s
     0     0 -95897.469    0    6 -95875.029 -95897.469  0.02%     -    0s
     0     0          -    0      -95875.029 -95878.693  0.00%     -    0s

Cutting planes:
  Gomory: 2
  Implied bound: 3
  MIR: 1
  Flow cover: 2
  RLT: 1
  Relax-and-lift: 3

Explored 1 nodes (740 simplex iterations) in 0.07 seconds (0.04 work units)
Thread count was 32 (of 256 available processors)

Solution count 8: -95875 -95868.1 -95800.2 ... 1.24958e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -9.587502925618e+04, best bound -9.587869327130e+04, gap 0.0038%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 110122.84
  Scenario: 34 demand increases, 26 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -95875.03
  [DEBUG]   S×d_nominal = 205997.87
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 205997.87 + -95875.03 = 110122.84
  [DEBUG]   Current θ from Master = 113171.61
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3048.77 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -14704.76
  Lower Bound (LB) = -12324.91
  Gap (UB-LB) = 668.9097, Absolute Gap = 668.9097, Relative Gap = 0.057388
  Not converged yet (gap = 668.91 > ε = 200)

  [DEBUG] Adding NEW scenario 14 to Master Problem...
  [DEBUG] New scenario pattern: 34 increases, 26 decreases
    [DEBUG] Scenario 14 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 14 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 14]
    [DEBUG]   - Total constraints in model: 230733
    [DEBUG]   - Total variables in model: 95860
  [DEBUG] Total scenarios in Master: 15
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 15
================================================================================
[Iteration 15] Solving Master Problem...
  Current scenarios in Master: 15
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 230733 rows, 95860 columns and 654074 nonzeros
Model fingerprint: 0x17610dff
Variable types: 93601 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-03, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 103100 rows and 41860 columns
Presolve time: 1.82s
Presolved: 127633 rows, 54000 columns, 785114 nonzeros
Variable types: 51741 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -366196.7547
Found heuristic solution: objective -196432.4631

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.28s

Barrier statistics:
 Dense cols : 752
 AA' NZ     : 4.745e+06
 Factor NZ  : 1.128e+07 (roughly 170 MB of memory)
 Factor Ops : 2.638e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.72971430e+07  2.11306529e+08  8.83e+04 1.77e+01  6.94e+04     3s
   1  -1.30824584e+07  1.85863198e+08  6.14e+04 4.99e+01  4.79e+04     3s
   2  -6.00754547e+06  1.45542386e+08  2.75e+04 5.45e+00  2.26e+04     3s
   3  -7.44846914e+05  1.06288954e+08  1.42e+03 1.46e+00  1.56e+03     3s
   4  -4.96228309e+05  8.04116052e+07  4.16e+02 9.65e-01  6.55e+02     3s
   5  -4.51052012e+05  4.68918031e+07  2.69e+02 4.99e-01  3.83e+02     3s
   6  -3.83363541e+05  3.71865545e+07  1.02e+02 3.77e-01  2.25e+02     4s
   7  -3.42970747e+05  2.87311414e+07  5.28e+01 2.81e-01  1.55e+02     4s
   8  -2.57501961e+05  1.77679785e+07  1.91e+00 1.64e-01  7.81e+01     4s
   9  -1.54377729e+05  8.60104565e+06  1.27e-01 7.74e-02  3.76e+01     4s
  10  -1.06573464e+05  2.35442058e+06  5.13e-02 1.98e-02  1.06e+01     4s
  11  -7.43367821e+04  1.63195091e+06  2.04e-02 1.37e-02  7.32e+00     4s
  12  -5.57094242e+04  9.38841685e+05  9.04e-03 7.79e-03  4.26e+00     4s
  13  -3.70012404e+04  3.16466719e+05  4.34e-03 2.43e-03  1.52e+00     4s
  14  -2.96386274e+04  1.85277839e+05  3.15e-03 1.47e-03  9.21e-01     4s
  15  -2.16195322e+04  1.34822327e+05  2.31e-03 1.16e-03  6.71e-01     4s
  16  -1.53636515e+04  9.25756459e+04  1.71e-03 7.70e-04  4.63e-01     4s
  17  -8.31408397e+03  5.78334935e+04  1.07e-03 4.56e-04  2.84e-01     4s
  18  -6.00829353e+03  4.19855404e+04  8.86e-04 3.05e-04  2.06e-01     4s
  19  -3.71425230e+03  3.60497994e+04  7.26e-04 2.51e-04  1.70e-01     4s
  20  -2.17434339e+03  2.94718256e+04  6.26e-04 1.98e-04  1.36e-01     4s
  21   6.56454098e+02  2.36164785e+04  4.52e-04 2.75e-04  9.84e-02     4s
  22   3.25861134e+03  1.98668884e+04  3.14e-04 2.00e-04  7.12e-02     4s
  23   4.57514333e+03  1.85589667e+04  2.48e-04 1.75e-04  6.00e-02     4s
  24   5.65807537e+03  1.67211878e+04  1.97e-04 1.36e-04  4.74e-02     4s
  25   7.23302015e+03  1.53420754e+04  1.23e-04 1.07e-04  3.48e-02     4s
  26   7.94962793e+03  1.30955828e+04  9.04e-05 5.96e-05  2.21e-02     4s
  27   8.25500558e+03  1.18426631e+04  7.78e-05 3.41e-05  1.54e-02     5s
  28   8.70838607e+03  1.13509344e+04  5.90e-05 2.34e-05  1.13e-02     5s
  29   8.98155822e+03  1.11277307e+04  4.74e-05 1.89e-05  9.20e-03     5s
  30   9.09068705e+03  1.09479423e+04  4.32e-05 1.53e-05  7.96e-03     5s
  31   9.14602583e+03  1.09106805e+04  4.10e-05 1.45e-05  7.57e-03     5s
  32   9.28757932e+03  1.07403404e+04  3.54e-05 1.12e-05  6.23e-03     5s
  33   9.45093527e+03  1.05874548e+04  2.82e-05 8.25e-06  4.87e-03     5s
  34   9.52973478e+03  1.04930153e+04  2.50e-05 6.59e-06  4.13e-03     5s
  35   9.62664908e+03  1.04114663e+04  2.09e-05 5.03e-06  3.36e-03     5s
  36   9.71912718e+03  1.03537623e+04  1.71e-05 3.94e-06  2.72e-03     5s
  37   9.84701585e+03  1.03152708e+04  1.18e-05 3.21e-06  2.01e-03     5s
  38   9.87331975e+03  1.02680021e+04  1.07e-05 2.37e-06  1.69e-03     5s
  39   9.88867118e+03  1.02542330e+04  1.00e-05 2.09e-06  1.57e-03     5s
  40   9.92806105e+03  1.02195534e+04  8.47e-06 1.44e-06  1.25e-03     5s
  41   9.99271698e+03  1.01918949e+04  5.79e-06 1.87e-06  8.54e-04     5s
  42   1.00515075e+04  1.01729681e+04  3.44e-06 1.10e-06  5.21e-04     5s
  43   1.00642747e+04  1.01607787e+04  2.93e-06 5.25e-07  4.14e-04     6s
  44   1.00988648e+04  1.01562415e+04  1.56e-06 3.97e-07  2.46e-04     6s
  45   1.01127824e+04  1.01493452e+04  1.03e-06 2.43e-07  1.57e-04     6s
  46   1.01143114e+04  1.01480470e+04  9.68e-07 2.33e-07  1.45e-04     6s
  47   1.01236737e+04  1.01465087e+04  6.14e-07 1.83e-07  9.79e-05     6s
  48   1.01382851e+04  1.01420382e+04  8.94e-08 5.98e-08  1.61e-05     6s
  49   1.01405587e+04  1.01409328e+04  4.81e-08 2.18e-08  1.61e-06     6s
  50   1.01408511e+04  1.01408534e+04  1.28e-09 5.40e-10  9.97e-09     6s
  51   1.01408510e+04  1.01408533e+04  9.22e-06 4.91e-07  7.27e-09     6s
  52   1.01408509e+04  1.01408533e+04  8.82e-06 4.88e-07  7.23e-09     6s
  53   1.01408533e+04  1.01408533e+04  5.11e-08 2.83e-07  3.60e-11     6s

Barrier solved model in 53 iterations and 5.99 seconds (13.49 work units)
Optimal objective 1.01408533e+04


Root crossover log...

  107303 DPushes remaining with DInf 0.0000000e+00                 6s
       0 DPushes remaining with DInf 0.0000000e+00                 9s

    3395 PPushes remaining with PInf 6.4969888e-06                 9s
       0 PPushes remaining with PInf 0.0000000e+00                10s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.3964134e-10     10s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   52490    1.0140853e+04   0.000000e+00   0.000000e+00     10s
   52490    1.0140853e+04   0.000000e+00   0.000000e+00     10s
Concurrent spin time: 2.48s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 1.014085e+04, 52490 iterations, 9.74 seconds (21.24 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 10140.8533    0  349 -196432.46 10140.8533   105%     -   12s
H    0     0                    -60889.40326 10140.8533   117%     -   12s
H    0     0                    -53863.31460 10140.8533   119%     -   12s
H    0     0                    -30440.62697 10140.8533   133%     -   13s
H    0     0                    -28317.42271 10140.8533   136%     -   13s
H    0     0                    -26962.54293 10140.8533   138%     -   13s
H    0     0                    -25502.46068 10140.8533   140%     -   15s
H    0     0                    -19699.94955 10140.8533   151%     -   15s
H    0     0                    -18193.45846 10140.8533   156%     -   15s
H    0     0                    -18161.32555 10140.8533   156%     -   15s
     0     0 5492.24879    0  261 -18161.326 5492.24879   130%     -   42s
H    0     0                    -17740.13292 5492.24879   131%     -   43s
     0     0 4948.86270    0  294 -17740.133 4948.86270   128%     -   57s
     0     0 4933.75548    0  360 -17740.133 4933.75548   128%     -   63s
     0     0 4904.68240    0  296 -17740.133 4904.68240   128%     -   67s
     0     0 4904.68240    0  287 -17740.133 4904.68240   128%     -   68s
     0     0 4904.68240    0  294 -17740.133 4904.68240   128%     -   69s
     0     0 4729.02134    0  373 -17740.133 4729.02134   127%     -   74s
     0     0 4719.11609    0  375 -17740.133 4719.11609   127%     -   75s
     0     0 2389.26600    0  475 -17740.133 2389.26600   113%     -   98s
     0     0 2389.25479    0  487 -17740.133 2389.25479   113%     -  108s
     0     0 2389.25479    0  498 -17740.133 2389.25479   113%     -  113s
H    0     0                    -17685.40492 2389.25479   114%     -  118s
     0     0 2389.25479    0  493 -17685.405 2389.25479   114%     -  118s
     0     0 2389.25479    0  499 -17685.405 2389.25479   114%     -  123s
     0     0 2389.25479    0  489 -17685.405 2389.25479   114%     -  125s
     0     0 2389.25479    0  494 -17685.405 2389.25479   114%     -  132s
     0     0 2389.25479    0  500 -17685.405 2389.25479   114%     -  135s
     0     0 2389.25479    0  492 -17685.405 2389.25479   114%     -  137s
     0     0 2389.25479    0  497 -17685.405 2389.25479   114%     -  140s
     0     0 2389.25479    0  432 -17685.405 2389.25479   114%     -  142s
     0     0 2389.25479    0  429 -17685.405 2389.25479   114%     -  144s
     0     0 2389.25479    0  424 -17685.405 2389.25479   114%     -  144s
H    0     0                    -12114.48582 -153.16204  98.7%     -  192s
H    0     0                    -12059.22645 -153.16204  98.7%     -  192s
H    0     0                    -12013.50863 -153.16204  98.7%     -  192s
H    0     0                    -12008.66101 -153.16204  98.7%     -  192s
     0     0 -153.16204    0  533 -12008.661 -153.16204  98.7%     -  192s
H    0     0                    -11976.08823 -153.93757  98.7%     -  192s
H    0     0                    -11958.56589 -153.93757  98.7%     -  192s
     0     0 -906.13355    0  520 -11958.566 -906.13355  92.4%     -  236s
     0     0 -1138.9826    0  521 -11958.566 -1138.9826  90.5%     -  246s
     0     0 -1191.4317    0  530 -11958.566 -1191.4317  90.0%     -  250s
     0     0 -1234.9468    0  528 -11958.566 -1234.9468  89.7%     -  254s
     0     0 -1244.6083    0  536 -11958.566 -1244.6083  89.6%     -  257s
     0     0 -1266.7113    0  534 -11958.566 -1266.7113  89.4%     -  259s
     0     0 -1277.4289    0  547 -11958.566 -1277.4289  89.3%     -  262s
H    0     0                    -11925.34662 -1282.8516  89.2%     -  263s
     0     0 -1282.8516    0  543 -11925.347 -1282.8516  89.2%     -  263s
     0     0 -1301.5017    0  542 -11925.347 -1301.5017  89.1%     -  267s
     0     0 -1303.5981    0  535 -11925.347 -1303.5981  89.1%     -  268s
     0     0 -1372.2020    0  538 -11925.347 -1372.2020  88.5%     -  272s
     0     0 -1378.2221    0  549 -11925.347 -1378.2221  88.4%     -  274s
     0     0 -1395.2487    0  539 -11925.347 -1395.2487  88.3%     -  277s
     0     0 -1447.1614    0  546 -11925.347 -1447.1614  87.9%     -  281s
     0     0 -1478.6840    0  568 -11925.347 -1478.6840  87.6%     -  284s
     0     0 -1489.7573    0  569 -11925.347 -1489.7573  87.5%     -  286s
     0     0 -1493.3126    0  559 -11925.347 -1493.3126  87.5%     -  287s
     0     0 -1493.3350    0  562 -11925.347 -1493.3350  87.5%     -  288s
     0     0 -2412.2209    0  552 -11925.347 -2412.2209  79.8%     -  307s
     0     0 -2671.8401    0  569 -11925.347 -2671.8401  77.6%     -  317s
     0     0 -2787.1770    0  547 -11925.347 -2787.1770  76.6%     -  325s
     0     0 -2832.1103    0  569 -11925.347 -2832.1103  76.3%     -  331s
     0     0 -2868.0418    0  559 -11925.347 -2868.0418  76.0%     -  334s
     0     0 -2896.2916    0  585 -11925.347 -2896.2916  75.7%     -  337s
     0     0 -2926.5838    0  588 -11925.347 -2926.5838  75.5%     -  340s
     0     0 -2927.8115    0  586 -11925.347 -2927.8115  75.4%     -  341s
     0     0 -3192.2246    0  633 -11925.347 -3192.2246  73.2%     -  354s
H    0     0                    -11866.64647 -3192.4686  73.1%     -  355s
     0     0 -3233.0764    0  646 -11866.646 -3233.0764  72.8%     -  360s
     0     0 -3257.6315    0  710 -11866.646 -3257.6315  72.5%     -  366s
     0     0 -3272.4727    0  655 -11866.646 -3272.4727  72.4%     -  369s
     0     0 -3278.5307    0  658 -11866.646 -3278.5307  72.4%     -  371s
     0     0 -3279.7663    0  711 -11866.646 -3279.7663  72.4%     -  372s
     0     0 -3384.8628    0  585 -11866.646 -3384.8628  71.5%     -  383s
H    0     0                    -11843.97797 -3385.4835  71.4%     -  386s
H    0     0                    -11792.03093 -3405.1028  71.1%     -  389s
     0     0 -3405.1028    0  590 -11792.031 -3405.1028  71.1%     -  389s
     0     0 -3418.4983    0  585 -11792.031 -3418.4983  71.0%     -  391s
     0     0 -3421.0579    0  586 -11792.031 -3421.0579  71.0%     -  393s
     0     0 -3424.4516    0  641 -11792.031 -3424.4516  71.0%     -  394s
     0     0 -3424.6610    0  583 -11792.031 -3424.6610  71.0%     -  395s
     0     0 -3459.9566    0  635 -11792.031 -3459.9566  70.7%     -  400s
H    0     0                    -11771.86791 -3460.0195  70.6%     -  401s
     0     0 -3496.2507    0  638 -11771.868 -3496.2507  70.3%     -  406s
     0     0 -3506.4942    0  640 -11771.868 -3506.4942  70.2%     -  408s
     0     0 -3512.1408    0  566 -11771.868 -3512.1408  70.2%     -  410s
     0     0 -3515.3319    0  565 -11771.868 -3515.3319  70.1%     -  411s
     0     0 -3518.9758    0  568 -11771.868 -3518.9758  70.1%     -  412s
     0     0 -3519.3759    0  563 -11771.868 -3519.3759  70.1%     -  412s
     0     0 -3536.8937    0  566 -11771.868 -3536.8937  70.0%     -  416s
     0     0 -3545.8890    0  562 -11771.868 -3545.8890  69.9%     -  422s
     0     0 -3555.5210    0  561 -11771.868 -3555.5210  69.8%     -  425s
     0     0 -3559.9345    0  573 -11771.868 -3559.9345  69.8%     -  426s
     0     0 -3560.6636    0  571 -11771.868 -3560.6636  69.8%     -  426s
     0     0 -3576.4319    0  582 -11771.868 -3576.4319  69.6%     -  430s
     0     0 -3580.0786    0  576 -11771.868 -3580.0786  69.6%     -  432s
     0     0 -3584.2269    0  580 -11771.868 -3584.2269  69.6%     -  433s
     0     0 -3585.2849    0  583 -11771.868 -3585.2849  69.5%     -  434s
     0     0 -3595.6070    0  622 -11771.868 -3595.6070  69.5%     -  437s
     0     0 -3596.8783    0  627 -11771.868 -3596.8783  69.4%     -  441s
     0     0 -3599.3974    0  585 -11771.868 -3599.3974  69.4%     -  443s
     0     0 -3600.3681    0  589 -11771.868 -3600.3681  69.4%     -  445s
     0     0 -3604.6586    0  581 -11771.868 -3604.6586  69.4%     -  448s
     0     0 -3605.1439    0  581 -11771.868 -3605.1439  69.4%     -  451s
H    0     0                    -11747.60407 -3605.1439  69.3%     -  552s
     0     2 -3605.1439    0  581 -11747.604 -3605.1439  69.3%     -  601s
     1     4 -4195.7567    1  646 -11747.604 -3607.8543  69.3% 17874  620s
     3     8 -4235.3167    2  578 -11747.604 -4196.0506  64.3% 13138  633s
     7    16 -4474.5630    3  667 -11747.604 -4235.3604  63.9% 11805  653s
    15    32 -4826.4606    4  643 -11747.604 -4474.6010  61.9% 13039  677s
    31    48 -4932.8405    5  590 -11747.604 -4497.0652  61.7% 16689  734s
    47    78 -5682.5124    6  583 -11747.604 -4497.0652  61.7% 18528  772s
H   68    78                    -11722.82692 -4497.0652  61.6% 16000  772s
    77   201 -7199.5524    7  279 -11722.827 -4497.0652  61.6% 15403  806s
   200   233 -7745.2912   10  250 -11722.827 -4497.0652  61.6%  8567  825s
   232   260 -7874.0007   11  237 -11722.827 -4497.0652  61.6%  8064  844s
   259   287 -8592.0197   12  231 -11722.827 -4497.0652  61.6%  7723  864s
   288   314 -10487.507   13  174 -11722.827 -4497.0652  61.6%  7495  891s
   315   348 -10513.887   14  169 -11722.827 -4497.0652  61.6%  7468  907s
   349   378 -10640.863   15  163 -11722.827 -4497.0652  61.6%  7297  926s
   379   407 -10655.829   16  165 -11722.827 -4497.0652  61.6%  7265  943s
   410   440 -10674.279   17  157 -11722.827 -4497.0652  61.6%  7187  960s
   447   463 -10817.388   18  154 -11722.827 -4497.0652  61.6%  7249  980s
   482   481     cutoff   19      -11722.827 -4497.0652  61.6%  7279 1019s
   518   487     cutoff   19      -11722.827 -4497.0652  61.6%  7408 1037s
   562   498 -10711.634   18  157 -11722.827 -4497.0652  61.6%  7449 1059s
   603   521     cutoff   19      -11722.827 -4497.0652  61.6%  7581 1082s
   646   524     cutoff   19      -11722.827 -4497.0652  61.6%  7659 1104s
   702   541 infeasible   18      -11722.827 -4497.0652  61.6%  7598 1123s
   742   561 -7942.5910   10  328 -11722.827 -4497.0652  61.6%  7608 1143s
   781   573 -7953.7372   11  320 -11722.827 -4497.0652  61.6%  7596 1164s
   827   583 -8884.9812   12  317 -11722.827 -4497.0652  61.6%  7606 1184s
   873   607 -8971.1177   13  243 -11722.827 -4497.0652  61.6%  7574 1206s
   919   639 -9077.1647   14  197 -11722.827 -4497.0652  61.6%  7569 1229s
   979   660 -10159.171   15  555 -11722.827 -4497.0652  61.6%  7498 1248s
  1042   696 -10243.373   16  490 -11722.827 -4497.0652  61.6%  7347 1267s
  1118   710 -10846.335   17  415 -11722.827 -4497.0652  61.6%  7167 1290s
  1170   728 -11029.528   18  301 -11722.827 -4497.0652  61.6%  7193 1307s
  1239   729 -11492.520   19  389 -11722.827 -4497.0652  61.6%  7106 1332s
  1337   737     cutoff   20      -11722.827 -4497.0652  61.6%  7000 1360s
  1415   771 -8064.5259   15  451 -11722.827 -4497.0652  61.6%  7039 1384s
  1491   809 -9335.6599   16  525 -11722.827 -4497.0652  61.6%  7152 1408s
  1602   841 -11370.709   17  294 -11722.827 -4497.0652  61.6%  7114 1438s
  1702   868 -11618.747   18  298 -11722.827 -4497.0652  61.6%  7174 1466s
  1819   906 infeasible   20      -11722.827 -4497.0652  61.6%  7160 1498s
  1948   937 -8572.2629   10  276 -11722.827 -4497.0652  61.6%  7165 1530s
  2067   971 -11262.539   12  296 -11722.827 -4497.0652  61.6%  7125 1561s
  2173  1047 -8952.9508   12  312 -11722.827 -4497.0652  61.6%  7181 1594s
  2325  1097 -10451.687   15  255 -11722.827 -4497.0652  61.6%  7162 1630s
  2480  1123 -11346.349   29   81 -11722.827 -4497.0652  61.6%  7144 1670s
  2629  1162 -9180.2514   12  238 -11722.827 -4497.0652  61.6%  7154 1711s
  2738  1187 infeasible   15      -11722.827 -4497.0652  61.6%  7254 1750s
  2869  1246 infeasible   14      -11722.827 -4497.0652  61.6%  7338 1787s
  2993  1272     cutoff   14      -11722.827 -5172.1065  55.9%  7455 1833s
  3135  1337 -5309.1643    6  498 -11722.827 -5191.8623  55.7%  7508 1875s
  3316  1360 -7168.6480    9  511 -11722.827 -5191.8623  55.7%  7585 1925s
  3491  1389     cutoff   12      -11722.827 -5191.8623  55.7%  7619 1973s
  3638  1417 -11349.246   13  450 -11722.827 -5191.8623  55.7%  7760 2021s
  3796  1437 -9892.2739   10  223 -11722.827 -5191.8623  55.7%  7853 2068s
  3962  1492 -11422.062   13  126 -11722.827 -5191.8623  55.7%  7979 2115s
  4144  1524 infeasible   21      -11722.827 -5191.8623  55.7%  8084 2169s
  4314  1561 -11103.947   13  215 -11722.827 -6236.7671  46.8%  8206 2230s
  4506  1625     cutoff   13      -11722.827 -6236.7671  46.8%  8323 2302s
  4725  1625 -9130.2136   15  321 -11722.827 -6236.7671  46.8%  8372 2352s
  4788  1655 -9814.5796   16  288 -11722.827 -6700.3743  42.8%  8398 2398s
  4855  1682 -10335.932   17  267 -11722.827 -6700.3743  42.8%  8391 2467s
  5056  1707 -11701.272   19  203 -11722.827 -7320.1339  37.6%  8367 2541s
  5309  1731 -11573.909   11  144 -11722.827 -7321.2446  37.5%  8390 2620s
  5575  1748 infeasible   18      -11722.827 -7550.6826  35.6%  8424 2700s
  5807  1772 infeasible   27      -11722.827 -7568.5325  35.4%  8490 2780s
  6073  1798 infeasible   24      -11722.827 -7637.8636  34.8%  8567 2860s
  6343  1799 -10877.314   19  402 -11722.827 -7662.5484  34.6%  8638 2945s
  6640  1828 infeasible   12      -11722.827 -7823.4314  33.3%  8685 3036s
  6963  1844 -8751.4776   18  405 -11722.827 -7829.6224  33.2%  8703 3110s
  7171  1870     cutoff   20      -11722.827 -7829.6224  33.2%  8752 3196s
  7506  1884 infeasible   21      -11722.827 -7970.8520  32.0%  8776 3282s
  7903  1871 infeasible   10      -11722.827 -8115.6485  30.8%  8767 3386s
  8248  1872 infeasible    9      -11722.827 -8215.7413  29.9%  8830 3490s
  8677  1848 -11443.860   13   95 -11722.827 -8304.5745  29.2%  8821 3598s
  9127  1840 infeasible   13      -11722.827 -8465.9821  27.8%  8795 3600s

Cutting planes:
  Gomory: 5
  Implied bound: 190
  MIR: 3351
  Flow cover: 3546
  RLT: 81
  Relax-and-lift: 476
  PSD: 1

Explored 9135 nodes (80785445 simplex iterations) in 3600.05 seconds (9782.15 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -11722.8 -11747.6 -11771.9 ... -12008.7

Time limit reached
Best objective -1.172282692458e+04, best bound -8.465982099653e+03, gap 27.7821%
  WARNING: Time limit reached. Using best solution found (gap: 27.78%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = -11722.83, θ = 113408.25
  Upper Bound (UB) = -11722.83

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 113408.25
  [DEBUG]   ✓ Scenario 0: θ = 113408.25 ≤ Q = 113408.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 113408.25 ≤ Q = 113408.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 113408.25 ≤ Q = 113408.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 113408.25 ≤ Q = 113408.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 113408.25 ≤ Q = 113408.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 113408.25 ≤ Q = 113408.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 113408.25 ≤ Q = 113408.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 113408.25 ≤ Q = 113408.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 113408.25 ≤ Q = 113408.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 113408.25 ≤ Q = 113408.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 113408.25 ≤ Q = 113408.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 113408.25 ≤ Q = 113408.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 113408.25 ≤ Q = 113408.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 113408.25 ≤ Q = 113408.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 113408.25 ≤ Q = 113408.25 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 15] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x60861f0f
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x9f79e0f1
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.248434e+13
Presolve removed 2589 rows and 1882 columns
Presolve time: 0.00s
Presolved: 504 rows, 507 columns, 1421 nonzeros
Found heuristic solution: objective 6304794.6327
Variable types: 343 continuous, 164 integer (164 binary)

Root relaxation: objective -1.245722e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -124572.25    0  123 6304794.63 -124572.25   102%     -    0s
H    0     0                    -89334.71816 -124572.25  39.4%     -    0s
H    0     0                    -90417.14139 -124572.25  37.8%     -    0s
     0     0 -94192.245    0   84 -90417.141 -94192.245  4.18%     -    0s
H    0     0                    -93363.94675 -94181.620  0.88%     -    0s
     0     0 -93951.475    0   82 -93363.947 -93951.475  0.63%     -    0s
H    0     0                    -93683.21268 -93913.748  0.25%     -    0s
     0     0 -93753.012    0   61 -93683.213 -93753.012  0.07%     -    0s
     0     0 -93726.161    0   51 -93683.213 -93726.161  0.05%     -    0s
     0     0 -93719.504    0   47 -93683.213 -93719.504  0.04%     -    0s
     0     0 -93719.504    0    7 -93683.213 -93719.504  0.04%     -    0s
     0     0 -93712.106    0    8 -93683.213 -93712.106  0.03%     -    0s
     0     0 -93711.933    0    8 -93683.213 -93711.933  0.03%     -    0s
     0     0 -93696.822    0    5 -93683.213 -93696.822  0.01%     -    0s
     0     0 -93696.822    0    5 -93683.213 -93696.822  0.01%     -    0s

Cutting planes:
  Implied bound: 1
  MIR: 3
  Flow cover: 2
  RLT: 2

Explored 1 nodes (551 simplex iterations) in 0.04 seconds (0.04 work units)
Thread count was 32 (of 256 available processors)

Solution count 8: -93683.2 -93597.4 -93524 ... 1.24843e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -9.368321267500e+04, best bound -9.368839974010e+04, gap 0.0055%
  Subproblem solved in 0.06s
  Worst-case operational profit (Z_SP) = 112314.66
  Scenario: 15 demand increases, 45 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -93683.21
  [DEBUG]   S×d_nominal = 205997.87
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 205997.87 + -93683.21 = 112314.66
  [DEBUG]   Current θ from Master = 113408.25
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1093.60 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -12816.43
  Lower Bound (LB) = -12324.91
  Gap (UB-LB) = 602.0799, Absolute Gap = 602.0799, Relative Gap = 0.051360
  Not converged yet (gap = 602.08 > ε = 200)

  [DEBUG] Adding NEW scenario 15 to Master Problem...
  [DEBUG] New scenario pattern: 15 increases, 45 decreases
    [DEBUG] Scenario 15 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 15 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 15]
    [DEBUG]   - Total constraints in model: 246023
    [DEBUG]   - Total variables in model: 102100
  [DEBUG] Total scenarios in Master: 16
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 16
================================================================================
[Iteration 16] Solving Master Problem...
  Current scenarios in Master: 16
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 246023 rows, 102100 columns and 697311 nonzeros
Model fingerprint: 0x20354f88
Variable types: 99841 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-03, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 109988 rows and 44658 columns
Presolve time: 1.94s
Presolved: 136035 rows, 57442 columns, 836457 nonzeros
Variable types: 55183 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -366196.7547
Found heuristic solution: objective -196432.4631

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.96s

Barrier statistics:
 Dense cols : 746
 AA' NZ     : 5.365e+06
 Factor NZ  : 1.253e+07 (roughly 180 MB of memory)
 Factor Ops : 2.886e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.73076094e+07  2.23046982e+08  8.83e+04 1.74e+01  6.91e+04     4s
   1  -1.31417923e+07  1.96128863e+08  6.16e+04 4.86e+01  4.78e+04     4s
   2  -6.30961674e+06  1.53800866e+08  2.89e+04 6.80e+00  2.36e+04     4s
   3  -7.65439183e+05  1.14461853e+08  1.50e+03 1.17e+00  1.62e+03     4s
   4  -5.03763454e+05  8.56892778e+07  4.37e+02 7.69e-01  6.67e+02     4s
   5  -4.57742306e+05  5.09936692e+07  2.84e+02 3.96e-01  3.96e+02     4s
   6  -3.90204435e+05  3.93929138e+07  1.10e+02 2.91e-01  2.30e+02     4s
   7  -3.51111076e+05  3.07832640e+07  5.92e+01 2.19e-01  1.59e+02     4s
   8  -2.67835291e+05  1.95468262e+07  1.95e+00 1.31e-01  8.07e+01     4s
   9  -1.96434555e+05  1.10017151e+07  4.27e-01 7.25e-02  4.52e+01     4s
  10  -1.20874590e+05  3.07374661e+06  4.44e-02 1.84e-02  1.29e+01     4s
  11  -7.90149112e+04  1.33241525e+06  1.63e-02 7.80e-03  5.68e+00     5s
  12  -5.28419008e+04  8.72282503e+05  6.57e-03 5.09e-03  3.72e+00     5s
  13  -3.34807175e+04  3.00423198e+05  3.10e-03 1.76e-03  1.34e+00     5s
  14  -2.72121712e+04  1.77844708e+05  2.35e-03 1.32e-03  8.25e-01     5s
  15  -1.89677156e+04  1.21824917e+05  1.53e-03 1.49e-03  5.67e-01     5s
  16  -1.23787278e+04  8.73462117e+04  1.05e-03 1.05e-03  4.01e-01     5s
  17  -8.19108343e+03  5.85371718e+04  7.84e-04 6.77e-04  2.69e-01     5s
  18  -4.43105817e+03  4.30151135e+04  5.75e-04 4.65e-04  1.91e-01     5s
  19  -2.38374513e+03  3.50937445e+04  4.75e-04 3.55e-04  1.51e-01     5s
  20  -7.59901842e+01  2.93535623e+04  3.78e-04 2.72e-04  1.18e-01     5s
  21   2.89496018e+03  2.37699824e+04  2.59e-04 1.93e-04  8.40e-02     5s
  22   4.81380946e+03  1.95614839e+04  1.92e-04 1.27e-04  5.94e-02     5s
  23   5.85714064e+03  1.60802650e+04  1.59e-04 7.58e-05  4.12e-02     5s
  24   7.12234080e+03  1.52182943e+04  1.20e-04 6.16e-05  3.26e-02     5s
  25   8.71480049e+03  1.32990289e+04  7.30e-05 3.02e-05  1.85e-02     5s
  26   9.26465745e+03  1.28152538e+04  5.62e-05 2.25e-05  1.43e-02     5s
  27   9.59735565e+03  1.25267338e+04  4.67e-05 1.80e-05  1.18e-02     5s
  28   9.87925281e+03  1.22795205e+04  3.84e-05 1.43e-05  9.66e-03     5s
  29   1.02629627e+04  1.19994891e+04  2.69e-05 1.04e-05  6.99e-03     6s
  30   1.04854908e+04  1.18544786e+04  2.08e-05 8.39e-06  5.51e-03     6s
  31   1.06566883e+04  1.17737134e+04  1.60e-05 7.31e-06  4.50e-03     6s
  32   1.07146397e+04  1.16531122e+04  1.42e-05 5.73e-06  3.78e-03     6s
  33   1.07846043e+04  1.15902022e+04  1.22e-05 4.92e-06  3.24e-03     6s
  34   1.08628107e+04  1.15387184e+04  9.86e-06 4.23e-06  2.72e-03     6s
  35   1.09029811e+04  1.14831644e+04  8.66e-06 3.50e-06  2.34e-03     6s
  36   1.09832074e+04  1.14413246e+04  6.37e-06 2.95e-06  1.84e-03     6s
  37   1.10347961e+04  1.13852544e+04  4.91e-06 2.20e-06  1.41e-03     6s
  38   1.10893351e+04  1.13385486e+04  3.42e-06 1.58e-06  1.00e-03     6s
  39   1.11214132e+04  1.13082987e+04  2.58e-06 1.13e-06  7.52e-04     6s
  40   1.11436905e+04  1.12811633e+04  2.01e-06 7.58e-07  5.53e-04     6s
  41   1.11913679e+04  1.12707743e+04  8.13e-07 6.69e-07  3.20e-04     6s
  42   1.11986197e+04  1.12498939e+04  6.41e-07 7.99e-07  2.06e-04     6s
  43   1.12218690e+04  1.12357323e+04  1.05e-07 4.66e-07  5.58e-05     7s
  44   1.12261245e+04  1.12291032e+04  4.67e-08 8.38e-08  1.20e-05     7s
  45   1.12277046e+04  1.12278102e+04  5.69e-09 2.44e-09  4.26e-07     7s
  46   1.12277657e+04  1.12277660e+04  1.08e-09 8.47e-10  1.44e-09     7s
  47   1.12277660e+04  1.12277660e+04  3.12e-08 2.10e-10  3.41e-11     7s

Barrier solved model in 47 iterations and 6.77 seconds (14.21 work units)
Optimal objective 1.12277660e+04


Root crossover log...

  114205 DPushes remaining with DInf 0.0000000e+00                 7s
    3896 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                11s

    3406 PPushes remaining with PInf 3.4917673e-06                11s
       0 PPushes remaining with PInf 0.0000000e+00                11s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.1608820e-01     11s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   56305    1.1227766e+04   0.000000e+00   1.160882e-01     11s
   56307    1.1227766e+04   0.000000e+00   0.000000e+00     11s
   56307    1.1227766e+04   0.000000e+00   0.000000e+00     11s
Concurrent spin time: 2.15s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 1.122777e+04, 56307 iterations, 10.88 seconds (24.26 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 11227.7660    0  347 -196432.46 11227.7660   106%     -   13s
H    0     0                    -174464.9187 11227.7660   106%     -   14s
H    0     0                    -78854.85158 11227.7660   114%     -   14s
H    0     0                    -75336.52781 11227.7660   115%     -   14s
H    0     0                    -74806.96678 11227.7660   115%     -   14s
H    0     0                    -74457.79621 11227.7660   115%     -   14s
H    0     0                    -74328.63636 11227.7660   115%     -   14s
H    0     0                    -62953.05319 11227.7660   118%     -   14s
H    0     0                    -62950.83565 11227.7660   118%     -   15s
H    0     0                    -46769.23427 11227.7660   124%     -   15s
H    0     0                    -30914.13050 11227.7660   136%     -   15s
H    0     0                    -30319.41608 11227.7660   137%     -   15s
H    0     0                    -30216.37851 11227.7660   137%     -   15s
     0     0 5455.42571    0  368 -30216.379 5455.42571   118%     -   46s
     0     0 5455.42571    0  368 -30216.379 5455.42571   118%     -   46s
H    0     0                    -26242.63754 5454.78506   121%     -   46s
H    0     0                    -25719.77465 5454.78506   121%     -   47s
H    0     0                    -25485.32135 5454.78506   121%     -   47s
H    0     0                    -25253.47494 5454.78506   122%     -   47s
H    0     0                    -24859.30988 5454.78506   122%     -   47s
H    0     0                    -24754.68771 5454.78506   122%     -   47s
H    0     0                    -24731.73002 5454.78506   122%     -   47s
H    0     0                    -24513.38581 5454.78506   122%     -   47s
H    0     0                    -24502.86539 5454.78506   122%     -   47s
H    0     0                    -24454.26701 5454.78506   122%     -   47s
     0     0 4963.38444    0  480 -24454.267 4963.38444   120%     -   57s
     0     0 4899.86032    0  502 -24454.267 4899.86032   120%     -   64s
     0     0 4893.69240    0  503 -24454.267 4893.69240   120%     -   67s
     0     0 4861.16415    0  501 -24454.267 4861.16415   120%     -   72s
     0     0 4846.33721    0  502 -24454.267 4846.33721   120%     -   76s
     0     0 4844.81506    0  488 -24454.267 4844.81506   120%     -   78s
     0     0 4792.65595    0  511 -24454.267 4792.65595   120%     -   82s
     0     0 4790.80293    0  500 -24454.267 4790.80293   120%     -   86s
     0     0 4789.50375    0  502 -24454.267 4789.50375   120%     -   87s
     0     0 4789.12607    0  499 -24454.267 4789.12607   120%     -   88s
     0     0 2490.66328    0  506 -24454.267 2490.66328   110%     -  122s
H    0     0                    -18819.65246 2490.61176   113%     -  123s
H    0     0                    -18704.37604 2490.61176   113%     -  123s
H    0     0                    -18700.48310 2490.61176   113%     -  127s
     0     0 2113.49240    0  481 -18700.483 2113.49240   111%     -  143s
     0     0 2006.61825    0  487 -18700.483 2006.61825   111%     -  150s
     0     0 1988.49167    0  498 -18700.483 1988.49167   111%     -  153s
     0     0 1963.19306    0  495 -18700.483 1963.19306   110%     -  157s
     0     0 1945.79586    0  496 -18700.483 1945.79586   110%     -  161s
     0     0 1945.57002    0  499 -18700.483 1945.57002   110%     -  163s
     0     0  -19.23411    0  519 -18700.483  -19.23411   100%     -  213s
H    0     0                    -18677.49589  -19.24757   100%     -  214s
H    0     0                    -18674.52595  -19.24757   100%     -  214s
H    0     0                    -18643.34684  -19.24757   100%     -  214s
H    0     0                    -18563.93595  -19.24757   100%     -  214s
     0     0 -517.52339    0  592 -18563.936 -517.52339  97.2%     -  242s
     0     0 -750.99056    0  596 -18563.936 -750.99056  96.0%     -  255s
     0     0 -910.53976    0  610 -18563.936 -910.53976  95.1%     -  268s
     0     0 -1008.2839    0  599 -18563.936 -1008.2839  94.6%     -  277s
     0     0 -1025.1716    0  600 -18563.936 -1025.1716  94.5%     -  281s
     0     0 -1029.6025    0  603 -18563.936 -1029.6025  94.5%     -  283s
     0     0 -1166.3464    0  595 -18563.936 -1166.3464  93.7%     -  291s
     0     0 -1190.4468    0  617 -18563.936 -1190.4468  93.6%     -  296s
     0     0 -1198.5563    0  618 -18563.936 -1198.5563  93.5%     -  299s
     0     0 -1205.8874    0  608 -18563.936 -1205.8874  93.5%     -  301s
     0     0 -1208.0307    0  611 -18563.936 -1208.0307  93.5%     -  303s
     0     0 -1217.5448    0  601 -18563.936 -1217.5448  93.4%     -  305s
     0     0 -1217.8848    0  603 -18563.936 -1217.8848  93.4%     -  306s
     0     0 -1987.6215    0  470 -18563.936 -1987.6215  89.3%     -  329s
H    0     0                    -15855.95227 -1988.4221  87.5%     -  330s
H    0     0                    -15730.79774 -1988.4221  87.4%     -  330s
     0     0 -2329.6725    0  551 -15730.798 -2329.6725  85.2%     -  341s
     0     0 -2432.8896    0  547 -15730.798 -2432.8896  84.5%     -  348s
     0     0 -2542.7575    0  564 -15730.798 -2542.7575  83.8%     -  357s
     0     0 -2564.6568    0  562 -15730.798 -2564.6568  83.7%     -  360s
     0     0 -2580.5387    0  570 -15730.798 -2580.5387  83.6%     -  363s
     0     0 -2588.8608    0  565 -15730.798 -2588.8608  83.5%     -  366s
     0     0 -2605.4282    0  571 -15730.798 -2605.4282  83.4%     -  369s
     0     0 -2613.5950    0  567 -15730.798 -2613.5950  83.4%     -  372s
     0     0 -2616.3474    0  569 -15730.798 -2616.3474  83.4%     -  373s
     0     0 -2616.8346    0  568 -15730.798 -2616.8346  83.4%     -  374s
     0     0 -2832.2731    0  679 -15730.798 -2832.2731  82.0%     -  387s
H    0     0                    -14201.74051 -2832.4638  80.1%     -  387s
H    0     0                    -14167.74787 -2832.4638  80.0%     -  387s
H    0     0                    -13470.58534 -2832.4638  79.0%     -  387s
     0     0 -2883.7794    0  580 -13470.585 -2883.7794  78.6%     -  393s
     0     0 -2914.0735    0  708 -13470.585 -2914.0735  78.4%     -  399s
     0     0 -2918.4067    0  592 -13470.585 -2918.4067  78.3%     -  401s
     0     0 -2925.7565    0  576 -13470.585 -2925.7565  78.3%     -  403s
     0     0 -2946.6813    0  581 -13470.585 -2946.6813  78.1%     -  406s
     0     0 -2953.1561    0  571 -13470.585 -2953.1561  78.1%     -  408s
     0     0 -2960.7533    0  572 -13470.585 -2960.7533  78.0%     -  410s
     0     0 -2962.6808    0  581 -13470.585 -2962.6808  78.0%     -  411s
     0     0 -3035.6442    0  572 -13470.585 -3035.6442  77.5%     -  418s
H    0     0                    -13453.71625 -3035.6552  77.4%     -  419s
H    0     0                    -13428.89755 -3035.6552  77.4%     -  419s
H    0     0                    -13425.00461 -3035.6552  77.4%     -  419s
H    0     0                    -13389.28292 -3035.6552  77.3%     -  419s
H    0     0                    -13365.18589 -3035.6552  77.3%     -  419s
H    0     0                    -13360.12845 -3035.6552  77.3%     -  419s
H    0     0                    -13305.44490 -3035.6552  77.2%     -  419s
     0     0 -3056.5373    0  587 -13305.445 -3056.5373  77.0%     -  421s
     0     0 -3061.5287    0  592 -13305.445 -3061.5287  77.0%     -  423s
     0     0 -3066.2294    0  600 -13305.445 -3066.2294  77.0%     -  425s
     0     0 -3068.8092    0  605 -13305.445 -3068.8092  76.9%     -  426s
     0     0 -3080.6170    0  595 -13305.445 -3080.6170  76.8%     -  427s
     0     0 -3083.8895    0  593 -13305.445 -3083.8895  76.8%     -  428s
     0     0 -3089.1585    0  594 -13305.445 -3089.1585  76.8%     -  429s
     0     0 -3089.9604    0  587 -13305.445 -3089.9604  76.8%     -  430s
     0     0 -3175.8927    0  573 -13305.445 -3175.8927  76.1%     -  441s
H    0     0                    -13080.77664 -3176.3710  75.7%     -  442s
H    0     0                    -12791.67907 -3176.3710  75.2%     -  442s
H    0     0                    -12787.78613 -3176.3710  75.2%     -  442s
H    0     0                    -12785.38030 -3176.3710  75.2%     -  442s
     0     0 -3195.5223    0  651 -12785.380 -3195.5223  75.0%     -  445s
     0     0 -3267.8006    0  637 -12785.380 -3267.8006  74.4%     -  449s
     0     0 -3275.2169    0  588 -12785.380 -3275.2169  74.4%     -  451s
     0     0 -3276.1497    0  660 -12785.380 -3276.1497  74.4%     -  452s
     0     0 -3311.3430    0  600 -12785.380 -3311.3430  74.1%     -  457s
H    0     0                    -12721.44156 -3311.5589  74.0%     -  458s
     0     0 -3325.0588    0  590 -12721.442 -3325.0588  73.9%     -  461s
     0     0 -3325.8663    0  657 -12721.442 -3325.8663  73.9%     -  461s
     0     0 -3337.3927    0  599 -12721.442 -3337.3927  73.8%     -  466s
H    0     0                    -12705.93453 -3338.4168  73.7%     -  467s
     0     0 -3366.0643    0  602 -12705.935 -3366.0643  73.5%     -  470s
     0     0 -3372.0332    0  603 -12705.935 -3372.0332  73.5%     -  471s
     0     0 -3374.5467    0  600 -12705.935 -3374.5467  73.4%     -  472s
     0     0 -3375.3838    0  602 -12705.935 -3375.3838  73.4%     -  473s
     0     0 -3383.1833    0  606 -12705.935 -3383.1833  73.4%     -  477s
H    0     0                    -12692.81273 -3383.7665  73.3%     -  477s
H    0     0                    -12667.95892 -3383.7665  73.3%     -  477s
H    0     0                    -12666.63033 -3383.7665  73.3%     -  477s
H    0     0                    -12662.29682 -3383.7665  73.3%     -  477s
H    0     0                    -12648.31811 -3383.7665  73.2%     -  477s
     0     0 -3385.7931    0  604 -12648.318 -3385.7931  73.2%     -  479s
     0     0 -3388.0420    0  610 -12648.318 -3388.0420  73.2%     -  480s
     0     0 -3388.4401    0  608 -12648.318 -3388.4401  73.2%     -  481s
     0     0 -3401.5041    0  598 -12648.318 -3401.5041  73.1%     -  486s
     0     0 -3406.1709    0  610 -12648.318 -3406.1709  73.1%     -  489s
     0     0 -3408.0747    0  601 -12648.318 -3408.0747  73.1%     -  491s
     0     0 -3422.2343    0  588 -12648.318 -3422.2343  72.9%     -  496s
H    0     0                    -12647.27048 -3423.1636  72.9%     -  496s
H    0     0                    -12643.37755 -3423.1636  72.9%     -  496s
     0     0 -3426.0427    0  596 -12643.378 -3426.0427  72.9%     -  498s
     0     0 -3427.9702    0  603 -12643.378 -3427.9702  72.9%     -  499s
     0     0 -3435.9216    0  639 -12643.378 -3435.9216  72.8%     -  504s
     0     0 -3435.9781    0  639 -12643.378 -3435.9781  72.8%     -  510s
H    0     0                    -12016.69429 -3436.3988  71.4%     -  567s
H    0     0                    -11958.55324 -3436.3988  71.3%     -  567s
H    0     0                    -11946.62641 -3436.3988  71.2%     -  567s
H    0     0                    -11865.35154 -3436.3988  71.0%     -  630s
H    0     0                    -11851.63306 -3436.3988  71.0%     -  630s
     0     2 -3436.3988    0  639 -11851.633 -3436.3988  71.0%     -  632s
     1     3 -3778.3249    1  560 -11851.633 -3436.3988  71.0% 12242  643s
     2     4 -4092.9123    1  571 -11851.633 -3778.4474  68.1% 13230  660s
     3     6 -4184.0634    2  574 -11851.633 -3778.4474  68.1% 10549  680s
     5    12 -5185.1935    3  382 -11851.633 -3778.4474  68.1% 14440  698s
    11    24 -5190.0981    4  375 -11851.633 -4189.3545  64.7% 10888  715s
    23    36 -5842.1558    5  631 -11851.633 -4230.1253  64.3% 14174  763s
H   35    68                    -11838.01325 -4230.1253  64.3% 17100  953s
H   35    68                    -11762.21156 -4230.1253  64.0% 17100  953s
H   48    68                    -11742.43339 -4230.1253  64.0% 15315  953s
H   50    68                    -11723.75430 -4230.1253  63.9% 14956  953s
    67   176 -6251.2527    6  575 -11723.754 -4489.7101  61.7% 22422  998s
   175   228 -6344.2089    9  508 -11723.754 -4489.7101  61.7% 13040 1025s
   232   291 -6383.6904   10  519 -11723.754 -4489.7101  61.7% 11691 1051s
   302   325 -6977.4540   12  458 -11723.754 -4489.7101  61.7% 10568 1074s
   354   343 -7144.0759   13  441 -11723.754 -4489.7101  61.7% 10017 1096s
   394   360 -7479.1216   14  409 -11723.754 -4489.7101  61.7% 10050 1120s
   459   392 -6819.6850    7  341 -11723.754 -4489.7101  61.7%  9955 1142s
   509   411 -7824.3503   15  408 -11723.754 -4489.7101  61.7%  9902 1167s
   553   434 -8102.4110   16  413 -11723.754 -4489.7101  61.7%  9668 1192s
   603   445 -10720.452    8  312 -11723.754 -4489.7101  61.7%  9614 1215s
   652   447 -11110.878    9  289 -11723.754 -4774.9818  59.3%  9439 1241s
   701   459 -6618.8501    9  642 -11723.754 -4774.9818  59.3%  9309 1266s
   747   469 -7527.7017    8  354 -11723.754 -4774.9818  59.3%  9312 1290s
   797   486 -9138.4523   14  447 -11723.754 -4774.9818  59.3%  9367 1313s
   836   502 -9323.1663   15  421 -11723.754 -4774.9818  59.3%  9461 1334s
   881   523 -9788.1879   17  501 -11723.754 -4774.9818  59.3%  9487 1359s
   930   541 -10388.176   19  463 -11723.754 -4774.9818  59.3%  9520 1385s
   978   532 infeasible   20      -11723.754 -4774.9818  59.3%  9514 1412s
  1021   537 infeasible   19      -11723.754 -4774.9818  59.3%  9549 1443s
  1064   549 -7833.0188   10  501 -11723.754 -4774.9818  59.3%  9556 1487s
  1110   579 -11343.254   15  222 -11723.754 -4774.9818  59.3%  9551 1534s
  1162   588     cutoff   12      -11723.754 -4774.9818  59.3%  9650 1586s
  1244   607 -10112.478   15  678 -11723.754 -4774.9818  59.3%  9524 1615s
  1317   632 -10372.144   16  554 -11723.754 -4774.9818  59.3%  9528 1644s
  1368   639 infeasible   17      -11723.754 -4774.9818  59.3%  9567 1673s
  1409   651 infeasible   17      -11723.754 -4774.9818  59.3%  9593 1704s
  1455   663 -6601.4224    7  407 -11723.754 -4774.9818  59.3%  9669 1737s
  1511   685 -6779.1850    8  398 -11723.754 -4774.9818  59.3%  9716 1769s
  1567   710 -7101.3586    9  506 -11723.754 -5878.4247  49.9%  9810 1802s
  1657   729 -7532.2475   10  461 -11723.754 -5883.9051  49.8%  9822 1840s
  1745   743 -7895.9418   11  526 -11723.754 -5883.9051  49.8%  9811 1879s
  1808   763 -8414.4050   12  514 -11723.754 -5883.9051  49.8%  9931 1919s
  1876   790 -9468.6963   13  389 -11723.754 -5883.9051  49.8%  9987 1967s
  1975   822 -11445.719   14  329 -11723.754 -6188.9995  47.2% 10058 2007s
  2053   838 infeasible   15      -11723.754 -6188.9995  47.2% 10046 2056s
  2199   870 -10597.220   13  516 -11723.754 -6188.9995  47.2%  9922 2103s
  2321   900 -10964.616   14  522 -11723.754 -6188.9995  47.2%  9935 2153s
  2425   933 -10982.891   15  270 -11723.754 -6345.8875  45.9% 10052 2206s
  2542   984 -11271.059   16  539 -11723.754 -6345.8875  45.9% 10100 2258s
  2697  1014 -11435.468   17  551 -11723.754 -6345.8875  45.9% 10058 2306s
  2808  1054 -11523.587   18  532 -11723.754 -6387.7938  45.5%  9994 2356s
  2917  1082 -11656.133   19  549 -11723.754 -6566.5614  44.0%  9980 2411s
  3021  1089     cutoff   20      -11723.754 -6605.3008  43.7% 10062 2467s
  3116  1117 infeasible   13      -11723.754 -6613.7456  43.6% 10195 2530s
  3270  1151 -9313.1335   10  589 -11723.754 -6613.7456  43.6% 10274 2606s
  3441  1187 infeasible   13      -11723.754 -6697.4263  42.9% 10317 2679s
  3611  1213 infeasible   16      -11723.754 -6719.6124  42.7% 10364 2757s
  3785  1238 -9835.0512   10  567 -11723.754 -6815.3746  41.9% 10452 2833s
  4002  1252 -9529.1800   12  496 -11723.754 -6852.9783  41.5% 10399 2902s
  4052  1274 -10889.848   13  403 -11723.754 -6914.8728  41.0% 10464 2978s
  4121  1286 -11109.468   14  401 -11723.754 -6914.8728  41.0% 10452 3055s
  4235  1290     cutoff   15      -11723.754 -6999.2713  40.3% 10452 3138s
  4373  1316 infeasible   14      -11723.754 -7014.0905  40.2% 10543 3218s
  4555  1341 -8306.6730   11  555 -11723.754 -7014.0905  40.2% 10593 3288s
  4705  1333 -8575.9781   12  532 -11723.754 -7094.6595  39.5% 10603 3369s
  4903  1382 -9180.7898   14  396 -11723.754 -7263.8580  38.0% 10636 3458s
  5198  1402 infeasible   17      -11723.754 -7265.5062  38.0% 10628 3551s
  5445  1403 -10859.538   18  429 -11723.754 -7486.3043  36.1% 10721 3600s

Cutting planes:
  Learned: 3
  Gomory: 3
  Implied bound: 283
  MIR: 3330
  Flow cover: 3844
  RLT: 78
  Relax-and-lift: 596

Explored 5614 nodes (60579519 simplex iterations) in 3600.05 seconds (9209.25 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -11723.8 -11742.4 -11762.2 ... -12643.4

Time limit reached
Best objective -1.172375429619e+04, best bound -7.486304268838e+03, gap 36.1441%
  WARNING: Time limit reached. Using best solution found (gap: 36.14%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = -11723.75, θ = 113364.43
  Upper Bound (UB) = -11723.75

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 113364.43
  [DEBUG]   ✓ Scenario 0: θ = 113364.43 ≤ Q = 113364.43 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 113364.43 ≤ Q = 113364.43 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 113364.43 ≤ Q = 113364.43 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 113364.43 ≤ Q = 113364.43 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 113364.43 ≤ Q = 113364.43 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 113364.43 ≤ Q = 113364.43 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 113364.43 ≤ Q = 113364.43 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 113364.43 ≤ Q = 113364.43 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 113364.43 ≤ Q = 113364.43 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 113364.43 ≤ Q = 113364.43 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 113364.43 ≤ Q = 113364.43 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 113364.43 ≤ Q = 113364.43 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 113364.43 ≤ Q = 113364.43 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 113364.43 ≤ Q = 113364.43 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 113364.43 ≤ Q = 113364.43 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 113364.43 ≤ Q = 113364.43 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 16] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x1af35ff3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x1af35ff3
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.247290e+13
Presolve removed 2589 rows and 1882 columns
Presolve time: 0.00s
Presolved: 504 rows, 507 columns, 1421 nonzeros
Found heuristic solution: objective 6312593.9448
Variable types: 343 continuous, 164 integer (164 binary)

Root relaxation: objective -1.241705e+05, 243 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -124170.48    0  123 6312593.94 -124170.48   102%     -    0s
H    0     0                    -88936.23155 -124170.48  39.6%     -    0s
H    0     0                    -89856.21995 -124170.48  38.2%     -    0s
     0     0 -93268.022    0   41 -89856.220 -93268.022  3.80%     -    0s
H    0     0                    -91558.56151 -93239.909  1.84%     -    0s
H    0     0                    -91699.66626 -93239.909  1.68%     -    0s
H    0     0                    -92016.85367 -93239.909  1.33%     -    0s
H    0     0                    -92157.95842 -93239.909  1.17%     -    0s
     0     0 -93048.161    0   42 -92157.958 -93048.161  0.97%     -    0s
H    0     0                    -92401.81916 -93046.519  0.70%     -    0s
     0     0 -93037.835    0   42 -92401.819 -93037.835  0.69%     -    0s
     0     0 -92960.627    0   41 -92401.819 -92960.627  0.60%     -    0s
     0     0 -92930.460    0   41 -92401.819 -92930.460  0.57%     -    0s
     0     2 -92930.460    0   41 -92401.819 -92930.460  0.57%     -    0s
H   34     7                    -92406.65896 -92819.985  0.45%   7.5    0s
H   70    36                    -92450.41886 -92678.903  0.25%   5.5    0s
*  160    52              21    -92494.95540 -92643.818  0.16%   3.8    0s
*  257    21              20    -92498.46552 -92577.886  0.09%   3.3    0s
*  271    21              21    -92517.19098 -92577.886  0.07%   3.2    0s
*  292     1              23    -92522.08005 -92544.972  0.02%   3.2    0s

Cutting planes:
  Gomory: 21
  Implied bound: 3
  MIR: 152
  Flow cover: 2
  RLT: 2

Explored 303 nodes (1408 simplex iterations) in 0.15 seconds (0.06 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -92522.1 -92517.2 -92498.5 ... -89856.2
No other solutions better than -92522.1

Optimal solution found (tolerance 1.00e-04)
Best objective -9.252208004589e+04, best bound -9.252208004589e+04, gap 0.0000%
  Subproblem solved in 0.17s
  Worst-case operational profit (Z_SP) = 113035.69
  Scenario: 13 demand increases, 47 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -92522.08
  [DEBUG]   S×d_nominal = 205557.77
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 205557.77 + -92522.08 = 113035.69
  [DEBUG]   Current θ from Master = 113364.43
  [DEBUG]   ⚠️  Z_SP ≤ θ by 328.73 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -12052.49
  Lower Bound (LB) = -12052.49
  Gap (UB-LB) = 328.7329, Absolute Gap = 328.7329, Relative Gap = 0.028040
  Not converged yet (gap = 328.73 > ε = 200)

  [DEBUG] Adding NEW scenario 16 to Master Problem...
  [DEBUG] New scenario pattern: 13 increases, 47 decreases
    [DEBUG] Scenario 16 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 16 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 16]
    [DEBUG]   - Total constraints in model: 261313
    [DEBUG]   - Total variables in model: 108340
  [DEBUG] Total scenarios in Master: 17
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 17
================================================================================
[Iteration 17] Solving Master Problem...
  Current scenarios in Master: 17
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 261313 rows, 108340 columns and 740548 nonzeros
Model fingerprint: 0xa6517191
Variable types: 106081 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-03, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 116876 rows and 47456 columns
Presolve time: 2.06s
Presolved: 144437 rows, 60884 columns, 888190 nonzeros
Variable types: 58625 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -366196.7547
Found heuristic solution: objective -196432.4631

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.31s

Barrier statistics:
 Dense cols : 746
 AA' NZ     : 5.964e+06
 Factor NZ  : 1.422e+07 (roughly 200 MB of memory)
 Factor Ops : 3.601e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.73210844e+07  2.34364588e+08  8.84e+04 1.64e+01  6.87e+04     4s
   1  -1.31930180e+07  2.06007579e+08  6.18e+04 4.80e+01  4.77e+04     4s
   2  -6.52458103e+06  1.61859536e+08  2.98e+04 8.17e+00  2.42e+04     4s
   3  -7.87277373e+05  1.21022187e+08  1.58e+03 1.60e+00  1.67e+03     4s
   4  -5.34245227e+05  9.10958498e+07  5.10e+02 9.98e-01  7.20e+02     4s
   5  -4.69517683e+05  5.41710117e+07  2.94e+02 5.13e-01  4.04e+02     4s
   6  -3.92508517e+05  4.03138629e+07  1.16e+02 3.55e-01  2.27e+02     4s
   7  -3.53505454e+05  3.10119664e+07  6.29e+01 2.61e-01  1.55e+02     4s
   8  -2.67462211e+05  2.15375688e+07  2.70e+00 1.71e-01  8.40e+01     4s
   9  -1.97997368e+05  9.71153142e+06  4.91e-01 7.57e-02  3.77e+01     4s
  10  -1.21819647e+05  3.19158731e+06  8.35e-02 2.33e-02  1.26e+01     4s
  11  -8.31945055e+04  1.34203202e+06  3.68e-02 9.63e-03  5.41e+00     4s
  12  -5.94188236e+04  7.67723835e+05  1.67e-02 5.53e-03  3.14e+00     4s
  13  -3.55646897e+04  3.12610212e+05  7.92e-03 2.24e-03  1.32e+00     4s
  14  -2.92171324e+04  1.97244254e+05  6.20e-03 1.64e-03  8.59e-01     4s
  15  -1.95093391e+04  1.20991415e+05  3.89e-03 9.22e-04  5.33e-01     4s
  16  -1.21779419e+04  9.60829645e+04  2.62e-03 7.17e-04  4.11e-01     4s
  17  -7.71623422e+03  6.47802937e+04  1.91e-03 4.72e-04  2.75e-01     5s
  18  -4.67653544e+03  4.68278954e+04  1.47e-03 3.37e-04  1.95e-01     5s
  19  -2.32226716e+03  4.00576681e+04  1.18e-03 2.76e-04  1.61e-01     5s
  20  -3.03716134e+02  3.16296077e+04  9.55e-04 2.03e-04  1.21e-01     5s
  21   2.07834764e+03  2.82569328e+04  7.04e-04 1.74e-04  9.93e-02     5s
  22   4.69513264e+03  2.27812119e+04  4.68e-04 1.20e-04  6.86e-02     5s
  23   5.97568605e+03  2.02329830e+04  3.66e-04 9.57e-05  5.41e-02     5s
  24   6.66987494e+03  1.62687801e+04  3.14e-04 5.91e-05  3.64e-02     5s
  25   8.23590496e+03  1.49511262e+04  2.02e-04 4.29e-05  2.55e-02     5s
  26   8.63889235e+03  1.39340968e+04  1.76e-04 3.05e-05  2.01e-02     5s
  27   9.43104322e+03  1.31014669e+04  1.23e-04 2.07e-05  1.39e-02     5s
  28   9.88955272e+03  1.27274676e+04  9.12e-05 1.63e-05  1.08e-02     5s
  29   9.97643459e+03  1.24939092e+04  8.56e-05 1.36e-05  9.55e-03     5s
  30   1.02453093e+04  1.22479214e+04  6.62e-05 1.11e-05  7.60e-03     5s
  31   1.04899444e+04  1.21794676e+04  4.99e-05 1.04e-05  6.41e-03     6s
  32   1.05277689e+04  1.19274121e+04  4.67e-05 7.66e-06  5.31e-03     6s
  33   1.07231214e+04  1.18216846e+04  3.35e-05 6.61e-06  4.17e-03     6s
  34   1.07994557e+04  1.17362380e+04  2.80e-05 6.07e-06  3.55e-03     6s
  35   1.08625341e+04  1.15822289e+04  2.34e-05 4.37e-06  2.73e-03     6s
  36   1.09214219e+04  1.14445338e+04  1.94e-05 4.92e-06  1.98e-03     6s
  37   1.09769779e+04  1.13959868e+04  1.57e-05 4.27e-06  1.59e-03     6s
  38   1.10189406e+04  1.13851364e+04  1.30e-05 4.03e-06  1.39e-03     6s
  39   1.10765566e+04  1.13272729e+04  9.17e-06 2.36e-06  9.51e-04     6s
  40   1.11042636e+04  1.12978766e+04  7.40e-06 1.75e-06  7.35e-04     6s
  41   1.11489782e+04  1.12852759e+04  4.69e-06 1.50e-06  5.17e-04     6s
  42   1.11773183e+04  1.12713958e+04  2.84e-06 1.06e-06  3.57e-04     6s
  43   1.12043796e+04  1.12496666e+04  1.25e-06 1.66e-06  1.72e-04     6s
  44   1.12218976e+04  1.12335793e+04  2.46e-07 1.11e-06  4.43e-05     7s
  45   1.12267172e+04  1.12296006e+04  7.10e-08 3.23e-07  1.09e-05     7s
  46   1.12276435e+04  1.12278765e+04  4.20e-08 1.26e-08  8.86e-07     7s
  47   1.12277527e+04  1.12277661e+04  4.58e-09 1.18e-09  5.12e-08     7s
  48   1.12277627e+04  1.12277660e+04  5.30e-08 2.32e-10  1.26e-08     7s
  49   1.12277659e+04  1.12277660e+04  3.21e-07 2.34e-10  6.54e-10     7s
  50   1.12277660e+04  1.12277660e+04  4.23e-07 6.40e-08  6.99e-12     7s

Barrier solved model in 50 iterations and 6.87 seconds (15.34 work units)
Optimal objective 1.12277660e+04


Root crossover log...

  121197 DPushes remaining with DInf 0.0000000e+00                 7s
    1578 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                10s

    3163 PPushes remaining with PInf 5.2928819e-06                10s
       0 PPushes remaining with PInf 0.0000000e+00                11s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.5629095e-10     11s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   59094    1.1227766e+04   0.000000e+00   0.000000e+00     11s
   59094    1.1227766e+04   0.000000e+00   0.000000e+00     11s
Concurrent spin time: 0.54s

Solved with barrier

Root relaxation: objective 1.122777e+04, 59094 iterations, 8.56 seconds (22.79 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 11227.7660    0  347 -196432.46 11227.7660   106%     -   11s
H    0     0                    -73769.08079 11227.7660   115%     -   12s
H    0     0                    -71921.13846 11227.7660   116%     -   12s
H    0     0                    -63549.99876 11227.7660   118%     -   12s
H    0     0                    -63474.92562 11227.7660   118%     -   12s
H    0     0                    -63429.83845 11227.7660   118%     -   12s
H    0     0                    -63389.03503 11227.7660   118%     -   12s
H    0     0                    -31880.11671 11227.7660   135%     -   12s
H    0     0                    -31855.75770 11227.7660   135%     -   12s
H    0     0                    -27242.46059 11227.7660   141%     -   13s
H    0     0                    -27073.34105 11227.7660   141%     -   13s
H    0     0                    -27037.56549 11227.7660   142%     -   13s
H    0     0                    -26854.94001 11227.7660   142%     -   13s
     0     0 5460.48262    0  370 -26854.940 5460.48262   120%     -   39s
     0     0 5460.48262    0  370 -26854.940 5460.48262   120%     -   39s
H    0     0                    -26624.28977 5460.48120   121%     -   40s
H    0     0                    -26216.28568 5460.48120   121%     -   40s
H    0     0                    -26188.76461 5460.48120   121%     -   40s
H    0     0                    -26140.30942 5460.48120   121%     -   40s
     0     0 4938.00716    0  367 -26140.309 4938.00716   119%     -   51s
     0     0 4840.40360    0  508 -26140.309 4840.40360   119%     -   61s
     0     0 4828.35689    0  443 -26140.309 4828.35689   118%     -   64s
     0     0 4827.42325    0  507 -26140.309 4827.42325   118%     -   66s
     0     0 4827.40335    0  508 -26140.309 4827.40335   118%     -   67s
     0     0 2544.50153    0  492 -26140.309 2544.50153   110%     -  104s
H    0     0                    -16457.91248 2544.06208   115%     -  104s
H    0     0                    -16415.22838 2544.06208   115%     -  105s
H    0     0                    -16408.18222 2544.06208   116%     -  105s
H    0     0                    -16390.62582 2544.06208   116%     -  105s
     0     0 2232.24029    0  478 -16390.626 2232.24029   114%     -  127s
     0     0 1988.38692    0  510 -16390.626 1988.38692   112%     -  149s
     0     0 1962.59091    0  511 -16390.626 1962.59091   112%     -  154s
     0     0 1934.98386    0  513 -16390.626 1934.98386   112%     -  161s
     0     0 1778.21644    0  506 -16390.626 1778.21644   111%     -  177s
     0     0 1681.78860    0  504 -16390.626 1681.78860   110%     -  191s
     0     0 1666.08138    0  502 -16390.626 1666.08138   110%     -  197s
     0     0 1663.14934    0  503 -16390.626 1663.14934   110%     -  200s
     0     0 1661.91023    0  510 -16390.626 1661.91023   110%     -  201s
     0     0 1634.15955    0  509 -16390.626 1634.15955   110%     -  206s
     0     0 1630.75857    0  515 -16390.626 1630.75857   110%     -  209s
     0     0 1630.43920    0  515 -16390.626 1630.43920   110%     -  210s
     0     0   54.09955    0  545 -16390.626   54.09955   100%     -  271s
H    0     0                    -16364.82517   54.09751   100%     -  272s
H    0     0                    -16359.07119   54.09751   100%     -  272s
H    0     0                    -16347.82806   54.09751   100%     -  272s
     0     0 -450.78794    0  656 -16347.828 -450.78794  97.2%     -  311s
     0     0 -573.01644    0  593 -16347.828 -573.01644  96.5%     -  322s
     0     0 -656.43700    0  579 -16347.828 -656.43700  96.0%     -  334s
     0     0 -835.35514    0  644 -16347.828 -835.35514  94.9%     -  342s
     0     0 -861.06740    0  652 -16347.828 -861.06740  94.7%     -  346s
     0     0 -868.56380    0  655 -16347.828 -868.56380  94.7%     -  349s
     0     0 -871.55410    0  600 -16347.828 -871.55410  94.7%     -  352s
     0     0 -872.78924    0  600 -16347.828 -872.78924  94.7%     -  353s
     0     0 -1783.4049    0  550 -16347.828 -1783.4049  89.1%     -  393s
H    0     0                    -16343.93512 -1784.5033  89.1%     -  394s
     0     0 -1970.6685    0  550 -16343.935 -1970.6685  87.9%     -  406s
     0     0 -2027.0732    0  628 -16343.935 -2027.0732  87.6%     -  416s
     0     0 -2120.8142    0  620 -16343.935 -2120.8142  87.0%     -  422s
     0     0 -2167.8944    0  617 -16343.935 -2167.8944  86.7%     -  428s
     0     0 -2218.8752    0  689 -16343.935 -2218.8752  86.4%     -  434s
     0     0 -2266.3609    0  688 -16343.935 -2266.3609  86.1%     -  442s
     0     0 -2282.1385    0  691 -16343.935 -2282.1385  86.0%     -  445s
     0     0 -2287.8381    0  701 -16343.935 -2287.8381  86.0%     -  448s
     0     0 -2302.0933    0  704 -16343.935 -2302.0933  85.9%     -  451s
     0     0 -2321.2521    0  635 -16343.935 -2321.2521  85.8%     -  456s
     0     0 -2325.8581    0  627 -16343.935 -2325.8581  85.8%     -  458s
     0     0 -2326.9835    0  631 -16343.935 -2326.9835  85.8%     -  459s
     0     0 -2635.2316    0  625 -16343.935 -2635.2316  83.9%     -  478s
     0     0 -2706.5072    0  570 -16343.935 -2706.5072  83.4%     -  486s
     0     0 -2737.3596    0  577 -16343.935 -2737.3596  83.3%     -  491s
     0     0 -2747.1054    0  590 -16343.935 -2747.1054  83.2%     -  493s
     0     0 -2754.5424    0  594 -16343.935 -2754.5424  83.1%     -  495s
     0     0 -2764.5267    0  592 -16343.935 -2764.5267  83.1%     -  496s
     0     0 -2774.1522    0  586 -16343.935 -2774.1522  83.0%     -  499s
     0     0 -2785.6720    0  585 -16343.935 -2785.6720  83.0%     -  502s
     0     0 -2789.4796    0  594 -16343.935 -2789.4796  82.9%     -  503s
     0     0 -2790.2165    0  598 -16343.935 -2790.2165  82.9%     -  504s
     0     0 -2915.0035    0  571 -16343.935 -2915.0035  82.2%     -  522s
H    0     0                    -12331.04903 -2917.0571  76.3%     -  524s
H    0     0                    -12227.19824 -2917.0571  76.1%     -  524s
H    0     0                    -11952.60621 -2917.0571  75.6%     -  525s
H    0     0                    -11950.24870 -2917.0571  75.6%     -  526s
     0     0 -2928.4219    0  582 -11950.249 -2928.4219  75.5%     -  528s
     0     0 -2938.6263    0  579 -11950.249 -2938.6263  75.4%     -  532s
     0     0 -2949.7190    0  718 -11950.249 -2949.7190  75.3%     -  536s
     0     0 -2955.0532    0  584 -11950.249 -2955.0532  75.3%     -  538s
     0     0 -2956.4303    0  636 -11950.249 -2956.4303  75.3%     -  539s
     0     0 -3058.7603    0  577 -11950.249 -3058.7603  74.4%     -  549s
     0     0 -3087.8889    0  687 -11950.249 -3087.8889  74.2%     -  556s
     0     0 -3095.4413    0  641 -11950.249 -3095.4413  74.1%     -  558s
     0     0 -3097.2818    0  639 -11950.249 -3097.2818  74.1%     -  560s
     0     0 -3126.9704    0  560 -11950.249 -3126.9704  73.8%     -  566s
H    0     0                    -11844.88154 -3127.7071  73.6%     -  567s
H    0     0                    -11840.98860 -3127.7071  73.6%     -  567s
H    0     0                    -11823.63094 -3127.7071  73.5%     -  567s
     0     0 -3140.3683    0  623 -11823.631 -3140.3683  73.4%     -  572s
     0     0 -3142.0067    0  569 -11823.631 -3142.0067  73.4%     -  573s
     0     0 -3170.1876    0  625 -11823.631 -3170.1876  73.2%     -  579s
     0     0 -3175.5242    0  626 -11823.631 -3175.5242  73.1%     -  582s
     0     0 -3179.4800    0  630 -11823.631 -3179.4800  73.1%     -  583s
     0     0 -3180.4800    0  636 -11823.631 -3180.4800  73.1%     -  584s
     0     0 -3186.4536    0  588 -11823.631 -3186.4536  73.1%     -  588s
     0     0 -3187.8234    0  589 -11823.631 -3187.8234  73.0%     -  590s
     0     0 -3195.3948    0  591 -11823.631 -3195.3948  73.0%     -  594s
     0     0 -3195.4080    0  591 -11823.631 -3195.4080  73.0%     -  599s
H    0     0                    -11774.70697 -3195.4660  72.9%     -  706s
H    0     0                    -11760.33608 -3195.4660  72.8%     -  711s
     0     2 -3195.4660    0  591 -11760.336 -3195.4660  72.8%     -  718s
     1     4 -3235.4429    1  571 -11760.336 -3195.5535  72.8%  4657  730s
     3     6 -3495.2353    2  594 -11760.336 -3236.1471  72.5%  7332  762s
     5    10 -3766.1242    3  596 -11760.336 -3236.1471  72.5% 12914  778s
     9    18 -4534.9897    4  490 -11760.336 -3756.0667  68.1% 11925  814s
    17    36 -4756.8276    5  487 -11760.336 -3756.0667  68.1% 13258  855s
    35    50 -5959.2483    4  555 -11760.336 -4314.7180  63.3% 18912  935s
H   49    78                    -11747.60407 -4314.7180  63.3% 21296  991s
    77   234 -7784.0267    7  156 -11747.604 -4314.7180  63.3% 16417 1031s
   233   306 -8031.9450    9  148 -11747.604 -4314.7180  63.3%  7767 1048s
   305   361 -8124.8867   10  139 -11747.604 -4314.7180  63.3%  7151 1066s
   368   387 -8343.6730   11  135 -11747.604 -4314.7180  63.3%  6841 1089s
   402   416 -8807.7595   11  144 -11747.604 -4314.7180  63.3%  6771 1128s
   445   449 -8969.3386   11  127 -11747.604 -4314.7180  63.3%  6734 1167s
   504   483 -8387.1464   11  139 -11747.604 -4314.7180  63.3%  6633 1186s
   561   511 -11288.303   12  168 -11747.604 -4314.7180  63.3%  6535 1199s
   621   546 -8992.6322   12  140 -11747.604 -4314.7180  63.3%  6469 1211s
   690   573 -11327.659   12  129 -11747.604 -4314.7180  63.3%  6328 1227s
   751   596 -9292.8719   13  121 -11747.604 -4314.7180  63.3%  6199 1259s
   808   610 -10883.425   14  132 -11747.604 -4314.7180  63.3%  6137 1275s
   876   626 -9961.1300   14  127 -11747.604 -4314.7180  63.3%  6075 1294s
   929   635     cutoff   15      -11747.604 -4314.7180  63.3%  5992 1312s
   974   652 -9385.8122   15  273 -11747.604 -4314.7180  63.3%  6042 1328s
  1029   682 -9524.5238   16  269 -11747.604 -4314.7180  63.3%  6031 1348s
  1095   685 -9918.5541   18  261 -11747.604 -4314.7180  63.3%  5996 1365s
  1137   704 -10080.414   19  180 -11747.604 -4314.7180  63.3%  5985 1383s
  1196   722 -10093.077   20  181 -11747.604 -4314.7180  63.3%  5940 1404s
  1259   727 -10274.524   21  247 -11747.604 -4314.7180  63.3%  5852 1425s
  1322   742 -10877.683   22  242 -11747.604 -4314.7180  63.3%  5765 1446s
  1388   757 -10972.496   23  234 -11747.604 -4314.7180  63.3%  5690 1469s
  1449   773 -10208.922   11  250 -11747.604 -4314.7180  63.3%  5700 1492s
  1533   801 infeasible   12      -11747.604 -4314.7180  63.3%  5614 1515s
  1605   834 -10004.555   19  136 -11747.604 -4314.7180  63.3%  5669 1539s
  1702   867 -10338.842   23  116 -11747.604 -4314.7180  63.3%  5661 1564s
  1785   928 -10522.115   27   97 -11747.604 -4314.7180  63.3%  5705 1594s
  1891   939 -11347.726   38   84 -11747.604 -4314.7180  63.3%  5688 1621s
  1974   966 -10262.540   10  139 -11747.604 -4314.7180  63.3%  5770 1652s
  2017   985 -10487.713   12  133 -11747.604 -4314.7180  63.3%  5880 1682s
  2083   998 -11004.231   13  142 -11747.604 -4314.7180  63.3%  5945 1714s
  2132  1015 -11378.473   14  118 -11747.604 -4444.5631  62.2%  6007 1751s
H 2172  1015                    -11735.70336 -4444.5631  62.1%  6094 1751s
  2189  1068 infeasible   15      -11735.703 -4444.5631  62.1%  6112 1784s
  2297  1094 -6822.9436    7  425 -11735.703 -4444.5631  62.1%  6154 1823s
  2409  1131 -10225.617    8  501 -11735.703 -4444.5631  62.1%  6173 1861s
  2484  1151 -10693.687    9  507 -11735.703 -4444.5631  62.1%  6350 1901s
  2628  1163 infeasible   11      -11735.703 -4444.5631  62.1%  6376 1944s
  2680  1212 -11221.866    9  475 -11735.703 -4444.5631  62.1%  6488 1991s
  2771  1236 infeasible   12      -11735.703 -4444.5631  62.1%  6583 2033s
H 2792  1236                    -11727.64723 -4444.5631  62.1%  6624 2033s
  2859  1296 -7138.3215   13  287 -11727.647 -4444.5631  62.1%  6646 2085s
  2996  1318 -8632.8355   15  229 -11727.647 -4444.5631  62.1%  6711 2126s
  3037  1365 -9141.3173   16  238 -11727.647 -4444.5631  62.1%  6772 2168s
  3121  1372 -9382.5534   17  217 -11727.647 -4444.5631  62.1%  6743 2215s
  3227  1397 infeasible   18      -11727.647 -4791.7721  59.1%  6730 2264s
  3302  1429 -11136.743   18  228 -11727.647 -4791.7721  59.1%  6839 2309s
  3392  1465 -9807.5655   16  233 -11727.647 -4791.7721  59.1%  6915 2361s
  3518  1486 -10315.928   17  231 -11727.647 -5394.7012  54.0%  6977 2434s
  3573  1509 infeasible   17      -11727.647 -5394.7012  54.0%  7061 2510s
  3668  1551 infeasible   19      -11727.647 -6058.5936  48.3%  7107 2559s
  3782  1582 -8727.5306   10  352 -11727.647 -6058.5936  48.3%  7198 2611s
  3917  1606 -10520.847   13  248 -11727.647 -6058.5936  48.3%  7282 2662s
  3987  1637 -11306.144   14  122 -11727.647 -6058.5936  48.3%  7354 2737s
  4080  1715 -8526.8076   14  172 -11727.647 -6058.5936  48.3%  7434 2791s
  4231  1781 infeasible   17      -11727.647 -6058.5936  48.3%  7506 2846s
  4419  1893 -11211.011   17  225 -11727.647 -6058.5936  48.3%  7527 2904s
  4683  1937 infeasible   18      -11727.647 -6058.5936  48.3%  7467 2961s
  4954  1978 -8899.1915   12  300 -11727.647 -6163.3350  47.4%  7416 3027s
  5176  2003 -10486.925   15  186 -11727.647 -6163.3350  47.4%  7470 3095s
  5373  2056 infeasible   20      -11727.647 -6163.3350  47.4%  7561 3169s
  5618  2100 -7742.6373   13  288 -11727.647 -6163.3350  47.4%  7589 3243s
  5823  2119 infeasible   19      -11727.647 -6163.3350  47.4%  7710 3324s
  6050  2185 -8707.7722   12  279 -11727.647 -6748.1591  42.5%  7816 3402s
  6326  2244 infeasible   14      -11727.647 -6748.1591  42.5%  7861 3484s
  6640  2292 -10983.280   14  175 -11727.647 -6948.0869  40.8%  7891 3566s
  6929  2299 infeasible   11      -11727.647 -6948.0869  40.8%  7988 3600s

Cutting planes:
  Learned: 2
  Gomory: 3
  Implied bound: 238
  MIR: 4030
  Flow cover: 3965
  RLT: 103
  Relax-and-lift: 579

Explored 7076 nodes (57077465 simplex iterations) in 3600.07 seconds (8980.78 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -11727.6 -11735.7 -11747.6 ... -11952.6

Time limit reached
Best objective -1.172764723301e+04, best bound -6.948086905869e+03, gap 40.7546%
  WARNING: Time limit reached. Using best solution found (gap: 40.75%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = -11727.65, θ = 113360.53
  Upper Bound (UB) = -11727.65

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 113360.53
  [DEBUG]   ✓ Scenario 0: θ = 113360.53 ≤ Q = 113360.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 113360.53 ≤ Q = 113360.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 113360.53 ≤ Q = 113360.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 113360.53 ≤ Q = 113360.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 113360.53 ≤ Q = 113360.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 113360.53 ≤ Q = 113360.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 113360.53 ≤ Q = 113360.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 113360.53 ≤ Q = 113360.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 113360.53 ≤ Q = 113360.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 113360.53 ≤ Q = 113360.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 113360.53 ≤ Q = 113360.53 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 113360.53 ≤ Q = 113360.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 113360.53 ≤ Q = 113360.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 113360.53 ≤ Q = 113360.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 113360.53 ≤ Q = 113360.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 113360.53 ≤ Q = 113360.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 113360.53 ≤ Q = 113360.53 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 17] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x3e2e4e30
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x3e2e4e30
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.247290e+13
Presolve removed 2589 rows and 1882 columns
Presolve time: 0.00s
Presolved: 504 rows, 507 columns, 1421 nonzeros
Found heuristic solution: objective 6317657.5273
Variable types: 343 continuous, 164 integer (164 binary)

Root relaxation: objective -1.238498e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -123849.82    0  123 6317657.53 -123849.82   102%     -    0s
H    0     0                    -88637.88995 -123849.82  39.7%     -    0s
H    0     0                    -89557.87836 -123849.82  38.3%     -    0s
     0     0 -92612.094    0   41 -89557.878 -92612.094  3.41%     -    0s
H    0     0                    -90659.96594 -92575.531  2.11%     -    0s
H    0     0                    -91186.12296 -92575.531  1.52%     -    0s
     0     0 -92553.714    0   42 -91186.123 -92553.714  1.50%     -    0s
H    0     0                    -91374.99516 -92553.714  1.29%     -    0s
     0     0 -92541.880    0   42 -91374.995 -92541.880  1.28%     -    0s
H    0     0                    -91516.09991 -92541.880  1.12%     -    0s
H    0     0                    -91716.68895 -92541.880  0.90%     -    0s
H    0     0                    -91756.14022 -92541.880  0.86%     -    0s
     0     2 -92541.880    0   42 -91756.140 -92541.880  0.86%     -    0s
H   40    29                    -91770.76340 -92308.903  0.59%   6.2    0s
H   42    28                    -91890.10089 -92308.903  0.46%   6.0    0s
*   71    18               7    -91947.59383 -92296.437  0.38%   6.5    0s

Cutting planes:
  Gomory: 1
  MIR: 139

Explored 600 nodes (2328 simplex iterations) in 0.10 seconds (0.07 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -91947.6 -91890.1 -91770.8 ... -88637.9
No other solutions better than -91947.6

Optimal solution found (tolerance 1.00e-04)
Best objective -9.194759383267e+04, best bound -9.194759383267e+04, gap 0.0000%
  Subproblem solved in 0.12s
  Worst-case operational profit (Z_SP) = 113307.94
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -91947.59
  [DEBUG]   S×d_nominal = 205255.54
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 205255.54 + -91947.59 = 113307.94
  [DEBUG]   Current θ from Master = 113360.53
  [DEBUG]   ⚠️  Z_SP ≤ θ by 52.59 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -11780.24
  Lower Bound (LB) = -11780.24
  Gap (UB-LB) = 52.5883, Absolute Gap = 52.5883, Relative Gap = 0.004484
  *** CONVERGED (gap within tolerance) ***

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 17
Total Time: 38949.75s
Converged: True
Final Lower Bound: -11780.2355
Final Upper Bound: -11727.6472
Final Gap: 52.588265
Number of Critical Scenarios: 17
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [1] (1/3)
Product 1 Plants: [0] (1/3)
Product 2 Plants: [2] (1/3)
Total Plant Openings: 3
DCs Opened: [2, 5, 9] (3/10)
Active Routes (Plant→DC): 9
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 0 customers  Mode 1: 8 customers  Mode 2: 42 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 17
Start Time: 2026-01-04 21:32:23
End Time: 2026-01-05 08:21:33
Total Time: 38949.75s
Optimal Value: -11780.24
Lower Bound: -11780.24
Upper Bound: -11727.65
Gap: 52.588265
Plants Opened: {0: [1], 1: [0], 2: [2]} (3 plants)
DCs Opened: [2, 5, 9] (3 DCs)
================================================================================

Results saved to: result/DH_single_full_seed29_LD_gamma20_20260105_082133.csv

Total Execution Time: 38950.09 seconds
End Time: 2026-01-05 08:21:33

All tasks completed successfully!

