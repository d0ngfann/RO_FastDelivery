
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 28
DI Scenario: MD
Start Time: 2026-01-04 19:51:40
================================================================================
Loading data from data/DH_data_full_seed28.pkl...

Applying DI scenario: MD
DI values:
  Product 0: ['1.000', '1.242', '1.543'] (k=0.535)
  Product 1: ['1.000', '1.145', '1.311'] (k=0.334)
  Product 2: ['1.000', '1.212', '1.470'] (k=0.475)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=901, max=1771
  DC capacity (MC): min=401, max=771

Demand Structure (s_rk matrix):
  Total customer-product pairs: 80/150 (46.7% sparse)
  Average products per customer: 1.60

Demand (only non-zero entries):
  Nominal (μ): min=8.50, max=34.59, count=80
  Deviation (μ̂): min=4.08, max=9.98

Costs:
  Plant fixed cost: min=5810, max=9892
  DC fixed cost: min=3901, max=5911
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.444', '2.086'] (k=0.907)
    Product 1: ['1.000', '1.332', '1.773'] (k=0.707)
    Product 2: ['1.000', '1.380', '1.904'] (k=0.794)
  MD:
    Product 0: ['1.000', '1.242', '1.543'] (k=0.535)
    Product 1: ['1.000', '1.145', '1.311'] (k=0.334)
    Product 2: ['1.000', '1.212', '1.470'] (k=0.475)
  LD:
    Product 0: ['1.000', '1.049', '1.100'] (k=0.117)
    Product 1: ['1.000', '1.032', '1.064'] (k=0.077)
    Product 2: ['1.000', '1.062', '1.127'] (k=0.148)
  Mixed:
    Product 0: ['1.000', '1.444', '2.086'] (k=0.907)
    Product 1: ['1.000', '1.145', '1.311'] (k=0.334)
    Product 2: ['1.000', '1.062', '1.127'] (k=0.148)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48750 nonzeros
Model fingerprint: 0x4f2568ac
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11871 rows and 2871 columns
Presolve time: 0.06s
Presolved: 4802 rows, 5629 columns, 33384 nonzeros
Variable types: 3370 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -299691.2799
Found heuristic solution: objective -186122.4392

Root relaxation: objective 8.790081e+04, 5016 iterations, 0.21 seconds (0.35 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 87900.8130    0  676 -186122.44 87900.8130   147%     -    0s
H    0     0                    -185528.2241 87900.8130   147%     -    0s
H    0     0                    -183736.6880 87900.8130   148%     -    0s
H    0     0                    -178970.6065 78787.1991   144%     -    1s
     0     0 78787.1991    0  736 -178970.61 78787.1991   144%     -    1s
     0     0 78441.1620    0  733 -178970.61 78441.1620   144%     -    1s
     0     0 78441.1620    0  731 -178970.61 78441.1620   144%     -    1s
     0     0 78441.1620    0  736 -178970.61 78441.1620   144%     -    1s
     0     0 73327.2240    0  835 -178970.61 73327.2240   141%     -    2s
     0     0 73031.6091    0  882 -178970.61 73031.6091   141%     -    2s
     0     0 72986.5298    0  878 -178970.61 72986.5298   141%     -    2s
     0     0 72977.2902    0  883 -178970.61 72977.2902   141%     -    2s
     0     0 72976.8585    0  882 -178970.61 72976.8585   141%     -    2s
H    0     0                    -175167.6575 66839.6747   138%     -    3s
H    0     0                    -174887.9902 66839.6747   138%     -    3s
H    0     0                    -174313.0423 66839.6747   138%     -    3s
H    0     0                    -173203.7985 66839.6747   139%     -    3s
H    0     0                    -172257.3341 66839.6747   139%     -    3s
H    0     0                    -96031.63204 66839.6747   170%     -    3s
H    0     0                    7739.7097835 66839.6747   764%     -    3s
     0     0 66839.6747    0  795 7739.70978 66839.6747   764%     -    3s
     0     0 66409.9166    0  840 7739.70978 66409.9166   758%     -    3s
     0     0 66337.5060    0  849 7739.70978 66337.5060   757%     -    3s
     0     0 66322.1566    0  855 7739.70978 66322.1566   757%     -    4s
     0     0 66319.4155    0  849 7739.70978 66319.4155   757%     -    4s
H    0     0                    7820.4731131 66319.4155   748%     -    4s
H    0     0                    11245.818569 66319.4155   490%     -    4s
H    0     0                    11310.585493 66319.4155   486%     -    4s
H    0     0                    12439.942015 66319.4155   433%     -    4s
H    0     0                    12840.701358 66319.4155   416%     -    4s
H    0     0                    12877.679283 66319.4155   415%     -    4s
H    0     0                    13249.851795 66319.4155   401%     -    4s
H    0     0                    13250.385180 66319.4155   401%     -    4s
H    0     0                    26015.642289 66319.4155   155%     -    4s
H    0     0                    27014.025729 60615.1917   124%     -    5s
     0     0 60615.1917    0  616 27014.0257 60615.1917   124%     -    5s
H    0     0                    27111.078760 59952.8795   121%     -    5s
H    0     0                    27391.357950 59952.8795   119%     -    5s
     0     0 59952.8795    0  667 27391.3579 59952.8795   119%     -    5s
     0     0 59802.3726    0  654 27391.3579 59802.3726   118%     -    6s
     0     0 59764.1629    0  667 27391.3579 59764.1629   118%     -    6s
H    0     0                    27618.366298 59753.7169   116%     -    6s
     0     0 59753.7169    0  700 27618.3663 59753.7169   116%     -    6s
H    0     0                    27639.244024 54481.3176  97.1%     -    7s
H    0     0                    27672.900395 54481.3176  96.9%     -    7s
     0     0 54481.3176    0  522 27672.9004 54481.3176  96.9%     -    7s
     0     0 53507.6854    0  619 27672.9004 53507.6854  93.4%     -    7s
     0     0 53410.0584    0  706 27672.9004 53410.0584  93.0%     -    7s
     0     0 53364.9003    0  734 27672.9004 53364.9003  92.8%     -    7s
     0     0 53349.5204    0  664 27672.9004 53349.5204  92.8%     -    8s
     0     0 51318.9314    0  756 27672.9004 51318.9314  85.4%     -    8s
     0     0 50745.3561    0  698 27672.9004 50745.3561  83.4%     -    9s
     0     0 50554.4781    0  802 27672.9004 50554.4781  82.7%     -    9s
     0     0 50503.3584    0  800 27672.9004 50503.3584  82.5%     -    9s
     0     0 50496.1223    0  812 27672.9004 50496.1223  82.5%     -    9s
H    0     0                    28484.138363 48955.8321  71.9%     -   10s
H    0     0                    28638.856478 48955.8321  70.9%     -   10s
H    0     0                    28649.338418 48955.8321  70.9%     -   10s
H    0     0                    28663.801340 48955.8321  70.8%     -   10s
H    0     0                    28750.394353 48955.8321  70.3%     -   10s
H    0     0                    29166.380973 48955.8321  67.9%     -   10s
H    0     0                    29176.862913 48955.8321  67.8%     -   10s
H    0     0                    29191.325835 48955.8321  67.7%     -   10s
     0     0 48955.8321    0  720 29191.3258 48955.8321  67.7%     -   10s
H    0     0                    29244.168157 48712.2447  66.6%     -   11s
     0     0 48712.2447    0  786 29244.1682 48712.2447  66.6%     -   11s
     0     0 48669.1750    0  809 29244.1682 48669.1750  66.4%     -   11s
H    0     0                    29342.384576 48654.2712  65.8%     -   11s
     0     0 48654.2712    0  800 29342.3846 48654.2712  65.8%     -   11s
H    0     0                    29387.222789 47240.0882  60.8%     -   12s
     0     0 47240.0882    0  771 29387.2228 47240.0882  60.8%     -   12s
H    0     0                    29485.439028 46946.2035  59.2%     -   13s
     0     0 46946.2035    0  851 29485.4390 46946.2035  59.2%     -   13s
     0     0 46876.6221    0  893 29485.4390 46876.6221  59.0%     -   13s
     0     0 46855.7522    0  898 29485.4390 46855.7522  58.9%     -   13s
     0     0 45886.6568    0  768 29485.4390 45886.6568  55.6%     -   14s
     0     0 45627.7344    0  825 29485.4390 45627.7344  54.7%     -   15s
     0     0 45530.2269    0  809 29485.4390 45530.2269  54.4%     -   15s
     0     0 45510.3982    0  904 29485.4390 45510.3982  54.3%     -   16s
     0     0 44893.3541    0  785 29485.4390 44893.3541  52.3%     -   17s
H    0     0                    29873.066193 44751.1861  49.8%     -   17s
H    0     0                    30151.390009 44751.1861  48.4%     -   17s
H    0     0                    30269.379362 44751.1861  47.8%     -   17s
H    0     0                    30479.285696 44751.1861  46.8%     -   17s
H    0     0                    30690.125632 44751.1861  45.8%     -   17s
     0     0 44751.1861    0  868 30690.1256 44751.1861  45.8%     -   17s
     0     0 44714.9510    0  779 30690.1256 44714.9510  45.7%     -   18s
H    0     0                    30693.358192 44242.2962  44.1%     -   19s
     0     0 44242.2962    0  837 30693.3582 44242.2962  44.1%     -   19s
H    0     0                    30700.287807 44102.5712  43.7%     -   19s
H    0     0                    30930.390050 44102.5712  42.6%     -   19s
     0     0 44102.5712    0  854 30930.3901 44102.5712  42.6%     -   19s
     0     0 44057.5150    0  882 30930.3901 44057.5150  42.4%     -   20s
     0     0 44047.6775    0  892 30930.3901 44047.6775  42.4%     -   20s
     0     0 43663.3750    0  860 30930.3901 43663.3750  41.2%     -   21s
     0     0 43523.9529    0  891 30930.3901 43523.9529  40.7%     -   21s
     0     0 43504.5589    0  873 30930.3901 43504.5589  40.7%     -   22s
     0     0 43217.4757    0  799 30930.3901 43217.4757  39.7%     -   23s
     0     0 43113.7451    0  876 30930.3901 43113.7451  39.4%     -   23s
     0     0 43080.8513    0  867 30930.3901 43080.8513  39.3%     -   23s
     0     0 42843.4661    0  892 30930.3901 42843.4661  38.5%     -   24s
     0     0 42843.3652    0  892 30930.3901 42843.3652  38.5%     -   24s
     0     2 42843.3652    0  892 30930.3901 42843.3652  38.5%     -   26s
    31    64 41587.4023    5  700 30930.3901 42079.9100  36.0%  2410   30s
H  101   156                    30981.884592 41587.3927  34.2%  1765   33s
H  106   156                    31119.479433 41587.3927  33.6%  1704   33s
H  114   156                    31250.752628 41587.3927  33.1%  1621   33s
   338   345 40418.2889   11  637 31250.7526 41461.4912  32.7%   845   35s
   780   757 38246.4650   17  393 31250.7526 41319.6573  32.2%   607   40s
  1239  1189 37341.8695   20  387 31250.7526 41305.6405  32.2%   528   45s
  1854  1659 35166.9835   35  325 31250.7526 41200.3733  31.8%   446   50s
  2556  2151 38949.3197   11  209 31250.7526 41017.1267  31.3%   415   55s
  3111  2501 31694.8510   42   99 31250.7526 40924.7543  31.0%   403   60s
  3676  2805 38968.6843   12  892 31250.7526 40889.2077  30.8%   426   77s
  3700  2821 35554.5704   40  319 31250.7526 38655.6682  23.7%   423   80s
  4132  2854 31557.7553   24  348 31250.7526 36505.8353  16.8%   410   85s

Cutting planes:
  Implied bound: 9
  Projected implied bound: 4
  MIR: 138
  Mixing: 1
  Flow cover: 332
  RLT: 10
  Relax-and-lift: 83

Explored 4924 nodes (1880740 simplex iterations) in 87.82 seconds (176.75 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: 31250.8 31119.5 30981.9 ... 29873.1

Optimal solution found (tolerance 1.00e-04)
Best objective 3.125075262799e+04, best bound 3.125288122943e+04, gap 0.0068%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 87.82s
  Master Objective (UB) = 31250.75, θ = 175187.85
  Upper Bound (UB) = 31250.75

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 175187.85
  [DEBUG]   ✓ Scenario 0: θ = 175187.85 ≤ Q = 175187.85 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x1221f451
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xedde0baf
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [5e-01, 2e+02]
Found heuristic solution: objective 1.152079e+13
Presolve removed 2598 rows and 1890 columns
Presolve time: 0.00s
Presolved: 495 rows, 499 columns, 1396 nonzeros
Found heuristic solution: objective 5739476.4922
Variable types: 339 continuous, 160 integer (160 binary)

Root relaxation: objective -1.276724e+05, 243 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -127672.45    0  123 5739476.49 -127672.45   102%     -    0s
H    0     0                    -95376.62255 -127672.45  33.9%     -    0s
H    0     0                    -95994.20152 -127672.45  33.0%     -    0s
*    0     0               0    -98339.45246 -98339.452  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 203

Explored 1 nodes (369 simplex iterations) in 0.01 seconds (0.01 work units)
Thread count was 32 (of 256 available processors)

Solution count 5: -98339.5 -95994.2 -95376.6 ... 1.15208e+13
No other solutions better than -98339.5

Optimal solution found (tolerance 1.00e-04)
Best objective -9.833945245848e+04, best bound -9.833945245848e+04, gap 0.0000%
  Subproblem solved in 0.02s
  Worst-case operational profit (Z_SP) = 142348.01
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -98339.45
  [DEBUG]   S×d_nominal = 240687.46
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 240687.46 + -98339.45 = 142348.01
  [DEBUG]   Current θ from Master = 175187.85
  [DEBUG]   ⚠️  Z_SP ≤ θ by 32839.84 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -1589.09
  Lower Bound (LB) = -1589.09
  Gap (UB-LB) = 32839.8418, Absolute Gap = 32839.8418, Relative Gap = 1.050850
  Not converged yet (gap = 32839.84 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 91981 nonzeros
Model fingerprint: 0x6916ddb5
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -1589.09 (0.01s)
MIP start from previous solve produced solution with objective -1589.09 (0.01s)
Loaded MIP start from previous solve with objective -1589.09

Presolve removed 14141 rows and 5740 columns
Presolve time: 0.25s
Presolved: 17822 rows, 9000 columns, 98638 nonzeros
Variable types: 6741 continuous, 2259 integer (2259 binary)

Root relaxation: objective 3.821447e+04, 8647 iterations, 0.82 seconds (1.66 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 38214.4722    0  259 -1589.0892 38214.4722  2505%     -    1s
H    0     0                    -1390.205134 38214.4722  2849%     -    1s
H    0     0                    -1150.865716 38214.4722  3420%     -    1s
H    0     0                    5008.1345841 38214.4722   663%     -    1s
H    0     0                    5795.8681450 38214.4722   559%     -    1s
H    0     0                    5812.4425005 38214.4722   557%     -    1s
H    0     0                    5823.2848382 38214.4722   556%     -    1s
H    0     0                    5918.0336448 38214.4722   546%     -    1s
H    0     0                    5989.2611964 38214.4722   538%     -    1s
H    0     0                    6004.1828455 38214.4722   536%     -    1s
H    0     0                    6018.8589081 38214.4722   535%     -    1s
H    0     0                    6031.3622651 38214.4722   534%     -    1s
H    0     0                    6047.5796545 38214.4722   532%     -    1s
     0     0 27982.0291    0  308 6047.57965 27982.0291   363%     -    2s
H    0     0                    6378.2853404 27974.7623   339%     -    2s
H    0     0                    6389.8201901 27974.7623   338%     -    2s
H    0     0                    6391.3328904 27974.7623   338%     -    2s
H    0     0                    6466.9088442 27974.7623   333%     -    2s
H    0     0                    6492.9228029 27974.7623   331%     -    2s
H    0     0                    6508.9125111 27974.7623   330%     -    2s
H    0     0                    6533.1861729 27974.7623   328%     -    2s
     0     0 27653.2789    0  257 6533.18617 27653.2789   323%     -    2s
     0     0 27642.2808    0  316 6533.18617 27642.2808   323%     -    2s
     0     0 22141.6216    0  443 6533.18617 22141.6216   239%     -    3s
H    0     0                    6570.5104873 22140.8563   237%     -    4s
H    0     0                    6628.6639326 22140.8563   234%     -    4s
H    0     0                    6665.6595054 22140.8563   232%     -    4s
H    0     0                    6674.4460369 22140.8563   232%     -    4s
H    0     0                    6710.4844699 22140.8563   230%     -    4s
     0     0 21297.6395    0  457 6710.48447 21297.6395   217%     -    4s
     0     0 21133.8700    0  478 6710.48447 21133.8700   215%     -    4s
     0     0 21056.5578    0  469 6710.48447 21056.5578   214%     -    4s
     0     0 21053.7756    0  484 6710.48447 21053.7756   214%     -    4s
     0     0 21051.6588    0  479 6710.48447 21051.6588   214%     -    4s
H    0     0                    6939.1644966 21051.6588   203%     -    5s
H    0     0                    6954.1832931 17859.5842   157%     -    6s
H    0     0                    6961.8713140 17859.5842   157%     -    6s
H    0     0                    6981.1785912 17859.5842   156%     -    6s
H    0     0                    7027.1932308 17859.5842   154%     -    6s
H    0     0                    7095.0263659 17859.5842   152%     -    6s
H    0     0                    7098.4623527 17859.5842   152%     -    6s
H    0     0                    7100.3535231 17859.5842   152%     -    6s
H    0     0                    7121.9296209 17859.5842   151%     -    6s
H    0     0                    7245.9272129 17859.5842   146%     -    6s
H    0     0                    7264.1281585 17859.5842   146%     -    6s
     0     0 17859.5842    0  480 7264.12816 17859.5842   146%     -    6s
H    0     0                    7327.3891677 17320.3743   136%     -    6s
H    0     0                    7387.9858893 17320.3743   134%     -    6s
H    0     0                    7395.4026710 17320.3743   134%     -    6s
H    0     0                    7411.2780782 17320.3743   134%     -    6s
     0     0 17320.3743    0  497 7411.27808 17320.3743   134%     -    6s
     0     0 17281.3757    0  502 7411.27808 17281.3757   133%     -    6s
     0     0 17263.0909    0  512 7411.27808 17263.0909   133%     -    6s
     0     0 17262.0065    0  513 7411.27808 17262.0065   133%     -    6s
H    0     0                    7434.2157456 15755.3984   112%     -    8s
     0     0 15755.3984    0  458 7434.21575 15755.3984   112%     -    8s
H    0     0                    7443.4891025 15753.8335   112%     -    8s
H    0     0                    7445.9169950 15753.8335   112%     -    9s
H    0     0                    7468.9134590 15753.8335   111%     -    9s
H    0     0                    7497.2355081 15753.8335   110%     -    9s
     0     0 15315.9505    0  425 7497.23551 15315.9505   104%     -    9s
     0     0 15193.9895    0  487 7497.23551 15193.9895   103%     -    9s
     0     0 15150.7549    0  429 7497.23551 15150.7549   102%     -   10s
     0     0 15150.0890    0  420 7497.23551 15150.0890   102%     -   10s
     0     0 14886.7051    0  459 7497.23551 14886.7051  98.6%     -   11s
H    0     0                    7503.1124385 14886.6968  98.4%     -   11s
     0     0 14747.7613    0  545 7503.11244 14747.7613  96.6%     -   11s
     0     0 14706.2168    0  669 7503.11244 14706.2168  96.0%     -   12s
     0     0 14693.2045    0  630 7503.11244 14693.2045  95.8%     -   12s
     0     0 14679.7866    0  621 7503.11244 14679.7866  95.6%     -   12s
     0     0 14675.8989    0  626 7503.11244 14675.8989  95.6%     -   12s
     0     0 14495.2373    0  459 7503.11244 14495.2373  93.2%     -   13s
     0     0 14421.2938    0  608 7503.11244 14421.2938  92.2%     -   14s
     0     0 14406.2891    0  634 7503.11244 14406.2891  92.0%     -   14s
     0     0 14400.7519    0  643 7503.11244 14400.7519  91.9%     -   14s
     0     0 14320.9984    0  352 7503.11244 14320.9984  90.9%     -   15s
     0     0 14304.0058    0  494 7503.11244 14304.0058  90.6%     -   16s
     0     0 14296.1391    0  500 7503.11244 14296.1391  90.5%     -   16s
     0     0 14291.7930    0  491 7503.11244 14291.7930  90.5%     -   16s
     0     0 14252.0962    0  410 7503.11244 14252.0962  89.9%     -   17s
     0     0 14232.5751    0  365 7503.11244 14232.5751  89.7%     -   17s
     0     0 14227.7937    0  486 7503.11244 14227.7937  89.6%     -   17s
     0     0 14210.4958    0  414 7503.11244 14210.4958  89.4%     -   18s
     0     0 14210.4759    0  414 7503.11244 14210.4759  89.4%     -   18s
     0     2 14210.2124    0  414 7503.11244 14210.2124  89.4%     -   23s
     7    16 13338.2339    3  524 7503.11244 13931.5278  85.7%  1024   25s
   240   276 12396.0510    8  527 7503.11244 12926.1346  72.3%   785   30s
H  246   276                    7510.0537218 12926.1346  72.1%   774   30s
   745   707 10766.6886   16  284 7510.05372 12743.5395  69.7%   461   35s
  1604  1443 9254.00215   39  182 7510.05372 12743.5395  69.7%   320   40s
H 1970  1585                    7510.1418922 12743.5395  69.7%   313   42s
H 1981  1585                    7514.2471002 12743.5395  69.6%   313   42s
  2286  1754 11689.5628   12  313 7514.24710 12590.8992  67.6%   323   45s
  3035  2021 8717.65176   11  283 7514.24710 12313.2872  63.9%   337   50s
H 3105  2042                    7515.5363422 12286.7836  63.5%   339   51s
  3856  2419 11761.9245    8  591 7515.53634 12151.9775  61.7%   329   56s
  4612  2715 9100.20248   14  219 7515.53634 12029.8547  60.1%   328   60s
  4989  2821 7719.85279   25  129 7515.53634 12022.7870  60.0%   330   66s
  5435  2945 8200.81502   39  414 7515.53634 11958.1698  59.1%   320   75s
  5444  2951 9768.34558   12  448 7515.53634 11958.1698  59.1%   319   80s
  5456  2959 8762.51525   46  307 7515.53634 11958.1698  59.1%   319   85s
  5466  2966 9580.22848   33  400 7515.53634 11958.1698  59.1%   318   91s
  5497  2993 10467.2319   16  331 7515.53634 11958.1698  59.1%   326   95s
  5812  2950 9701.56934   23  328 7515.53634 10988.8025  46.2%   337  100s
  8084  2286     cutoff   40      7515.53634 7604.94640  1.19%   262  105s

Cutting planes:
  Lift-and-project: 1
  MIR: 150
  Flow cover: 495
  RLT: 14
  Relax-and-lift: 63

Explored 10004 nodes (2176098 simplex iterations) in 105.56 seconds (257.50 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: 7515.54 7514.25 7510.14 ... 7411.28

Optimal solution found (tolerance 1.00e-04)
Best objective 7.515536342181e+03, best bound 7.515536342181e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 105.57s
  Master Objective (UB) = 7515.54, θ = 131706.06
  Upper Bound (UB) = 7515.54

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 131706.06
  [DEBUG]   ✓ Scenario 0: θ = 131706.06 ≤ Q = 131706.06 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 131706.06 ≤ Q = 131706.06 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x7a9a255
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x07a9a255
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.205644e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.00s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 6217869.6981
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.276987e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -127698.71    0  126 6217869.70 -127698.71   102%     -    0s
H    0     0                    -93687.40306 -127698.71  36.3%     -    0s
H    0     0                    -94370.22195 -127698.71  35.3%     -    0s
H    0     0                    -101270.7387 -127698.71  26.1%     -    0s
H    0     0                    -101929.7988 -127698.71  25.3%     -    0s
H    0     0                    -105956.2565 -117819.06  11.2%     -    0s
H    0     0                    -107862.4155 -117819.06  9.23%     -    0s
     0     0 -117819.06    0   85 -107862.42 -117819.06  9.23%     -    0s
H    0     0                    -115998.4821 -117805.75  1.56%     -    0s
     0     0 -117495.84    0   85 -115998.48 -117495.84  1.29%     -    0s
     0     0 -117053.70    0   33 -115998.48 -117053.70  0.91%     -    0s
H    0     0                    -116473.0289 -117033.40  0.48%     -    0s
H    0     0                    -116603.6897 -117033.40  0.37%     -    0s
     0     0 -116923.17    0   28 -116603.69 -116923.17  0.27%     -    0s
     0     0 -116922.84    0   23 -116603.69 -116922.84  0.27%     -    0s
     0     0 -116732.07    0   22 -116603.69 -116732.07  0.11%     -    0s
H    0     0                    -116615.9673 -116718.95  0.09%     -    0s
     0     0 -116718.95    0   19 -116615.97 -116718.95  0.09%     -    0s
     0     0 -116668.42    0   12 -116615.97 -116668.42  0.04%     -    0s
     0     0 -116643.41    0    6 -116615.97 -116643.41  0.02%     -    0s
H    0     0                    -116618.8049 -116643.41  0.02%     -    0s
     0     0          -    0      -116618.80 -116629.58  0.01%     -    0s

Cutting planes:
  Gomory: 2
  Implied bound: 1
  Flow cover: 5
  Relax-and-lift: 2

Explored 1 nodes (704 simplex iterations) in 0.07 seconds (0.04 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -116619 -116616 -116604 ... -94370.2

Optimal solution found (tolerance 1.00e-04)
Best objective -1.166188049046e+05, best bound -1.166295771943e+05, gap 0.0092%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 107502.20
  Scenario: 41 demand increases, 19 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -116618.80
  [DEBUG]   S×d_nominal = 224121.01
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 224121.01 + -116618.80 = 107502.20
  [DEBUG]   Current θ from Master = 131706.06
  [DEBUG]   ⚠️  Z_SP ≤ θ by 24203.86 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -16688.32
  Lower Bound (LB) = -1589.09
  Gap (UB-LB) = 9104.6255, Absolute Gap = 9104.6255, Relative Gap = 1.211441
  Not converged yet (gap = 9104.63 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 41 increases, 19 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135212 nonzeros
Model fingerprint: 0xdeb644e1
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -16688.3 (0.02s)
Loaded MIP start from previous solve with objective -16688.3

Presolve removed 21210 rows and 8610 columns
Presolve time: 0.34s
Presolved: 26043 rows, 12370 columns, 160049 nonzeros
Variable types: 10111 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...

Concurrent spin time: 0.37s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 2.674060e+04, 16729 iterations, 2.24 seconds (4.57 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 26740.5956    0   73 -16688.321 26740.5956   260%     -    2s
H    0     0                    -4637.150404 26740.5956   677%     -    2s
H    0     0                    -4074.746067 26740.5956   756%     -    2s
H    0     0                    -3333.595526 26740.5956   902%     -    2s
H    0     0                    -898.1033303 26740.5956  3077%     -    2s
H    0     0                    -844.6678845 26740.5956  3266%     -    3s
H    0     0                    -751.1366241 26740.5956  3660%     -    3s
H    0     0                    -710.3424096 26740.5956  3864%     -    3s
H    0     0                     -77.0326572 20875.3580      -     -    4s
H    0     0                       4.4633278 20875.3580      -     -    4s
H    0     0                      13.7671838 20875.3580      -     -    4s
H    0     0                      48.8615397 20875.3580      -     -    4s
     0     0 20383.5124    0  119   48.86154 20383.5124      -     -    4s
     0     0 20383.5124    0  119   48.86154 20383.5124      -     -    5s
     0     0 20383.5124    0  121   48.86154 20383.5124      -     -    5s
     0     0 20383.5124    0  135   48.86154 20383.5124      -     -    5s
     0     0 20383.5124    0  135   48.86154 20383.5124      -     -    5s
H    0     0                      49.9889273 20383.5124      -     -    5s
H    0     0                      96.2250777 20383.5124      -     -    5s
H    0     0                     109.8355429 17608.2872      -     -    7s
H    0     0                     113.7100018 17608.2872      -     -    7s
H    0     0                     119.3988664 17608.2872      -     -    7s
H    0     0                     127.6896554 17608.2872      -     -    7s
H    0     0                     133.9405724 17608.2872      -     -    7s
H    0     0                     139.0628911 17608.2872      -     -    7s
     0     0 17608.2872    0  174  139.06289 17608.2872      -     -    7s
H    0     0                    1798.7757608 17606.6523   879%     -    7s
     0     0 17163.3349    0  167 1798.77576 17163.3349   854%     -    8s
     0     0 17107.9882    0  172 1798.77576 17107.9882   851%     -    8s
     0     0 17100.8961    0  171 1798.77576 17100.8961   851%     -    8s
     0     0 17098.2712    0  178 1798.77576 17098.2712   851%     -    8s
     0     0 17094.7440    0  181 1798.77576 17094.7440   850%     -    8s
     0     0 17090.4201    0  184 1798.77576 17090.4201   850%     -    8s
     0     0 17090.4201    0  184 1798.77576 17090.4201   850%     -    8s
H    0     0                    1967.9654941 17090.4201   768%     -    9s
H    0     0                    1979.8529501 17090.4201   763%     -    9s
H    0     0                    1987.8954115 17090.4201   760%     -    9s
H    0     0                    2053.6464163 17090.4201   732%     -    9s
H    0     0                    2098.9731280 17090.4201   714%     -    9s
     0     0 15096.3308    0  246 2098.97313 15096.3308   619%     -   11s
H    0     0                    2151.0206376 15095.2046   602%     -   11s
H    0     0                    2172.5119405 15095.2046   595%     -   11s
H    0     0                    2214.6246256 15095.2046   582%     -   11s
H    0     0                    2244.4793384 15095.2046   573%     -   11s
H    0     0                    2261.1641368 15095.2046   568%     -   11s
     0     0 14480.3972    0  348 2261.16414 14480.3972   540%     -   12s
     0     0 14347.1919    0  321 2261.16414 14347.1919   535%     -   13s
H    0     0                    2490.2422515 14294.5356   474%     -   13s
     0     0 14294.5356    0  320 2490.24225 14294.5356   474%     -   13s
H    0     0                    2496.5890971 14278.2927   472%     -   13s
H    0     0                    2504.5595395 14278.2927   470%     -   13s
     0     0 14278.2927    0  330 2504.55954 14278.2927   470%     -   13s
     0     0 14264.2909    0  344 2504.55954 14264.2909   470%     -   13s
H    0     0                    2767.5270439 14262.0042   415%     -   13s
H    0     0                    2852.9615180 14262.0042   400%     -   13s
H    0     0                    2863.1206609 14262.0042   398%     -   13s
     0     0 14262.0042    0  337 2863.12066 14262.0042   398%     -   13s
     0     0 14261.2852    0  335 2863.12066 14261.2852   398%     -   13s
H    0     0                    3338.0816003 13634.6719   308%     -   16s
H    0     0                    3339.8933766 13634.6719   308%     -   16s
H    0     0                    3342.1587599 13634.6719   308%     -   16s
H    0     0                    3365.9863779 13634.6719   305%     -   16s
H    0     0                    3400.0624048 13634.6719   301%     -   16s
H    0     0                    3421.5482787 13634.6719   298%     -   16s
H    0     0                    3425.9743285 13634.6719   298%     -   16s
H    0     0                    3433.0794837 13634.6719   297%     -   16s
H    0     0                    3433.7698419 13634.6719   297%     -   16s
H    0     0                    3436.9029095 13634.6719   297%     -   16s
     0     0 13634.6719    0  399 3436.90291 13634.6719   297%     -   16s
H    0     0                    3505.9168394 13634.5050   289%     -   16s
H    0     0                    3550.0451042 13634.5050   284%     -   16s
     0     0 13416.9968    0  347 3550.04510 13416.9968   278%     -   16s
     0     0 13373.9522    0  407 3550.04510 13373.9522   277%     -   17s
     0     0 13356.7265    0  360 3550.04510 13356.7265   276%     -   17s
     0     0 13344.9502    0  412 3550.04510 13344.9502   276%     -   17s
     0     0 13341.0424    0  422 3550.04510 13341.0424   276%     -   17s
     0     0 13339.5412    0  420 3550.04510 13339.5412   276%     -   17s
     0     0 13227.2615    0  381 3550.04510 13227.2615   273%     -   18s
H    0     0                    3554.5430258 13225.5889   272%     -   18s
H    0     0                    3614.4372215 13225.5889   266%     -   18s
     0     0 13192.1245    0  385 3614.43722 13192.1245   265%     -   19s
     0     0 13147.1968    0  386 3614.43722 13147.1968   264%     -   19s
     0     0 13133.7786    0  391 3614.43722 13133.7786   263%     -   19s
     0     0 13121.3818    0  392 3614.43722 13121.3818   263%     -   19s
     0     0 13117.8537    0  389 3614.43722 13117.8537   263%     -   19s
     0     0 13116.7127    0  392 3614.43722 13116.7127   263%     -   19s
     0     0 13077.8163    0  326 3614.43722 13077.8163   262%     -   20s
     0     0 13063.4176    0  326 3614.43722 13063.4176   261%     -   20s
     0     0 13057.2412    0  338 3614.43722 13057.2412   261%     -   20s
     0     0 13052.1381    0  335 3614.43722 13052.1381   261%     -   20s
     0     0 13049.3526    0  322 3614.43722 13049.3526   261%     -   21s
     0     0 13049.0968    0  332 3614.43722 13049.0968   261%     -   21s
     0     0 13022.9800    0  429 3614.43722 13022.9800   260%     -   21s
     0     0 13016.2591    0  422 3614.43722 13016.2591   260%     -   22s
     0     0 13009.7789    0  440 3614.43722 13009.7789   260%     -   22s
     0     0 13006.7145    0  430 3614.43722 13006.7145   260%     -   22s
     0     0 13006.4368    0  434 3614.43722 13006.4368   260%     -   22s
     0     0 12984.0990    0  401 3614.43722 12984.0990   259%     -   23s
     0     0 12971.7330    0  447 3614.43722 12971.7330   259%     -   23s
     0     0 12965.6401    0  444 3614.43722 12965.6401   259%     -   23s
     0     0 12964.7596    0  442 3614.43722 12964.7596   259%     -   23s
     0     0 12947.9099    0  453 3614.43722 12947.9099   258%     -   24s
     0     0 12945.1229    0  393 3614.43722 12945.1229   258%     -   24s
     0     0 12942.9216    0  455 3614.43722 12942.9216   258%     -   24s
     0     0 12942.2238    0  457 3614.43722 12942.2238   258%     -   24s
     0     0 12938.5778    0  498 3614.43722 12938.5778   258%     -   25s
     0     0 12937.4626    0  503 3614.43722 12937.4626   258%     -   25s
     0     0 12934.8782    0  502 3614.43722 12934.8782   258%     -   25s
     0     0 12932.6136    0  456 3614.43722 12932.6136   258%     -   26s
     0     0 12931.7651    0  499 3614.43722 12931.7651   258%     -   26s
     0     0 12926.8484    0  493 3614.43722 12926.8484   258%     -   26s
     0     0 12926.5697    0  493 3614.43722 12926.5697   258%     -   26s
H    0     0                    3624.8141813 12925.8389   257%     -   31s
H    0     0                    3625.7288294 12925.8389   257%     -   31s
H    0     0                    3649.7054444 12925.8389   254%     -   31s
     0     2 12925.8389    0  493 3649.70544 12925.8389   254%     -   32s
     7    16 12507.5356    3  504 3649.70544 12656.1275   247%  1907   35s
    63    96 11706.3975    6  551 3649.70544 12014.6409   229%  2232   40s
H   93    96                    3653.0200426 12014.6409   229%  1993   40s
H  100   193                    3709.2063951 12014.6409   224%  1921   43s
   202   223 11588.7350   11  491 3709.20640 12014.6409   224%  1479   45s
H  204   223                    3744.5637472 12014.6409   221%  1470   45s
H  222   223                    3762.2722861 12014.6409   219%  1474   45s
H  224   223                    3763.2611539 12014.6409   219%  1468   45s
H  243   267                    3763.8671878 12014.6409   219%  1463   47s
   388   356 11380.0413   16  437 3763.86719 11771.6383   213%  1552   51s
   515   418 10700.6621   19  329 3763.86719 11705.8986   211%  1482   55s
H  623   473                    3774.1447506 11590.7556   207%  1498   59s
   646   521 9955.16504   23  351 3774.14475 11578.7851   207%  1510   61s
   863   644 8822.22582   29  330 3774.14475 11527.8521   205%  1466   66s
H  951   657                    3778.7373158 11475.0415   204%  1452   67s
   992   691 8398.13069   32  269 3778.73732 11475.0415   204%  1445   71s
H 1131   781                    3845.1026476 11475.0415   198%  1418   74s
  1192   842 8152.63553   35  287 3845.10265 11475.0415   198%  1385   76s
H 1195   842                    3851.9330742 11475.0415   198%  1384   76s
H 1197   842                    3876.6805985 11475.0415   196%  1382   76s
H 1200   842                    3881.2067874 11475.0415   196%  1381   76s
H 1221   842                    3882.1859702 11475.0415   196%  1366   76s
H 1255   842                    3908.9410683 11470.2612   193%  1365   76s
  1656  1257 6256.88268   44  263 3908.94107 11332.5872   190%  1179   81s
  2096  1558 4622.60443   58  154 3908.94107 11332.5872   190%  1043   85s
  2456  1696 7188.52164   19  256 3908.94107 11104.9875   184%   992   90s
  2756  1783     cutoff   23      3908.94107 11053.8087   183%   991   95s
H 2972  1823                    3935.1624853 11030.0373   180%  1008   99s
  3009  1857 8471.06325   10  477 3935.16249 11030.0373   180%  1004  101s
H 3192  1864                    3942.2979643 10935.8429   177%  1025  104s
  3219  1903 7025.51015   13  313 3942.29796 10935.8429   177%  1034  107s
  3489  2000 4316.73719   19  375 3942.29796 10821.1172   174%  1065  112s
  3645  2072     cutoff   24      3942.29796 10787.0075   174%  1073  115s
  3936  2168 5435.87634   11  242 3942.29796 10637.3919   170%  1077  121s
  4297  2429 4149.60411   12  336 3942.29796 10636.0477   170%  1071  127s
  4581  2441 4532.19115    8  218 3942.29796 10531.9375   167%  1056  131s
H 4709  2519                    3950.7607695 10506.8735   166%  1063  134s
  4836  2604 7429.53639    9  350 3950.76077 10459.6978   165%  1063  137s
  5051  2605 6799.80381   43  493 3950.76077 10459.6978   165%  1065  146s
  5054  2607 4346.83530   86  310 3950.76077 10459.6978   165%  1065  153s
  5055  2608 10001.1406   10  289 3950.76077 10459.6978   165%  1065  155s
  5062  2612 6614.11027   41  323 3950.76077 10459.6978   165%  1063  160s
  5070  2618 7221.57677   10  376 3950.76077 10459.6978   165%  1061  165s
  5078  2623 8290.24268   20  325 3950.76077 10459.6978   165%  1060  174s
  5079  2624 9135.56213   28  325 3950.76077 10459.6978   165%  1060  177s
  5082  2631 10459.6978   16  425 3950.76077 10459.6978   165%  1071  181s
  5094  2651 10459.6978   18  328 3950.76077 10459.6978   165%  1075  186s
  5142  2675 8562.40945   20  377 3950.76077 10459.6978   165%  1094  192s
  5174  2684 4612.72146   21  334 3950.76077 10459.6978   165%  1113  196s
  5265  2659 4788.30732   21  243 3950.76077 10459.6978   165%  1126  200s
  5480  2585     cutoff   22      3950.76077 9888.82917   150%  1120  205s
  5734  2490     cutoff   25      3950.76077 9888.82917   150%  1099  210s
  6206  2336 infeasible   33      3950.76077 9022.67125   128%  1041  215s
 12611  1920     cutoff   55      3950.76077 4068.78204  2.99%   530  220s
 20089  2094 3957.86429   55   16 3950.76077 4001.34506  1.28%   343  225s
*24681   838              93    3958.1374845 3981.54302  0.59%   283  227s

Cutting planes:
  Gomory: 1
  Lift-and-project: 1
  MIR: 371
  Mixing: 2
  Flow cover: 637
  RLT: 5
  Relax-and-lift: 86

Explored 26234 nodes (7071850 simplex iterations) in 227.87 seconds (647.95 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: 3958.14 3950.76 3942.3 ... 3845.1

Optimal solution found (tolerance 1.00e-04)
Best objective 3.958137484548e+03, best bound 3.958137484548e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 227.88s
  Master Objective (UB) = 3958.14, θ = 127946.01
  Upper Bound (UB) = 3958.14

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 127946.01
  [DEBUG]   ✓ Scenario 0: θ = 127946.01 ≤ Q = 127946.01 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 127946.01 ≤ Q = 127946.01 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 127946.01 ≤ Q = 127946.01 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x3fede3c3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x3fede3c3
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [1e-13, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.198169e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.00s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 6175614.2803
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.254179e+05, 260 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -125417.94    0  130 6175614.28 -125417.94   102%     -    0s
H    0     0                    -86940.95382 -125417.94  44.3%     -    0s
H    0     0                    -88129.22671 -125417.94  42.3%     -    0s
H    0     0                    -106773.3385 -125417.94  17.5%     -    0s
H    0     0                    -108678.7604 -125417.94  15.4%     -    0s
H    0     0                    -114532.8582 -125417.94  9.50%     -    0s
     0     0 -116404.13    0   71 -114532.86 -116404.13  1.63%     -    0s
H    0     0                    -115226.2468 -116357.22  0.98%     -    0s
     0     0 -115680.77    0   69 -115226.25 -115680.77  0.39%     -    0s
     0     0 -115657.94    0   67 -115226.25 -115657.94  0.37%     -    0s
     0     0 -115655.35    0   66 -115226.25 -115655.35  0.37%     -    0s
     0     0 -115655.30    0   66 -115226.25 -115655.30  0.37%     -    0s
     0     0 -115265.15    0   18 -115226.25 -115265.15  0.03%     -    0s
     0     0 -115265.15    0    9 -115226.25 -115265.15  0.03%     -    0s
H    0     0                    -115240.7313 -115265.15  0.02%     -    0s
H    0     0                    -115243.5379 -115265.15  0.02%     -    0s
     0     0 -115261.31    0    6 -115243.54 -115261.31  0.02%     -    0s
     0     0 -115255.13    0    6 -115243.54 -115255.13  0.01%     -    0s

Cutting planes:
  Gomory: 42
  Implied bound: 3
  MIR: 65
  Flow cover: 2
  RLT: 100
  Relax-and-lift: 3
  BQP: 4

Explored 1 nodes (591 simplex iterations) in 0.03 seconds (0.03 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -115244 -115241 -115226 ... 1.19817e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.152435379445e+05, best bound -1.152540462242e+05, gap 0.0091%
  Subproblem solved in 0.04s
  Worst-case operational profit (Z_SP) = 102919.99
  Scenario: 35 demand increases, 25 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -115243.54
  [DEBUG]   S×d_nominal = 218163.52
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 218163.52 + -115243.54 = 102919.99
  [DEBUG]   Current θ from Master = 127946.01
  [DEBUG]   ⚠️  Z_SP ≤ θ by 25026.03 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -21067.89
  Lower Bound (LB) = -1589.09
  Gap (UB-LB) = 5547.2267, Absolute Gap = 5547.2267, Relative Gap = 1.401474
  Not converged yet (gap = 5547.23 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 35 increases, 25 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178443 nonzeros
Model fingerprint: 0x0da1cb7d
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -21067.9 (0.14s)
Loaded MIP start from previous solve with objective -21067.9

Presolve removed 28280 rows and 11480 columns
Presolve time: 0.45s
Presolved: 34263 rows, 15740 columns, 211559 nonzeros
Variable types: 13481 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 34263 rows, 15740 columns, 211559 nonzeros

Concurrent spin time: 0.70s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 2.650748e+04, 22994 iterations, 4.34 seconds (9.66 work units)
Total elapsed time = 5.03s (DegenMoves)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 26507.4821    0   73 -21067.890 26507.4821   226%     -    5s
H    0     0                    -3947.112783 26507.4821   772%     -    5s
H    0     0                    1067.8596444 26507.4821  2382%     -    5s
H    0     0                    1453.2392554 26507.4821  1724%     -    5s
H    0     0                    1622.1039348 26507.4821  1534%     -    5s
H    0     0                    2352.5122674 20238.3985   760%     -    8s
H    0     0                    2358.6991676 20238.3985   758%     -    8s
H    0     0                    2388.2494218 20238.3985   747%     -    8s
     0     0 20238.3985    0  181 2388.24942 20238.3985   747%     -    8s
     0     0 19599.5327    0  137 2388.24942 19599.5327   721%     -    8s
     0     0 19599.5327    0  141 2388.24942 19599.5327   721%     -    9s
     0     0 19599.5327    0  185 2388.24942 19599.5327   721%     -    9s
     0     0 19599.5327    0  180 2388.24942 19599.5327   721%     -    9s
     0     0 19599.5327    0  181 2388.24942 19599.5327   721%     -    9s
     0     0 19599.5327    0  181 2388.24942 19599.5327   721%     -    9s
     0     0 17020.2838    0  265 2388.24942 17020.2838   613%     -   11s
H    0     0                    2391.3178976 17019.0462   612%     -   12s
H    0     0                    2562.7496387 17019.0462   564%     -   12s
     0     0 16417.4846    0  282 2562.74964 16417.4846   541%     -   13s
     0     0 16197.8413    0  263 2562.74964 16197.8413   532%     -   14s
     0     0 16147.0852    0  195 2562.74964 16147.0852   530%     -   14s
     0     0 16141.0883    0  259 2562.74964 16141.0883   530%     -   14s
     0     0 16141.0883    0  259 2562.74964 16141.0883   530%     -   14s
H    0     0                    2717.5592252 16141.0883   494%     -   16s
H    0     0                    3241.9041638 14202.8069   338%     -   18s
H    0     0                    3254.4912540 14202.8069   336%     -   18s
H    0     0                    3262.0808762 14202.8069   335%     -   18s
H    0     0                    3274.0036081 14202.8069   334%     -   18s
     0     0 14202.8069    0  281 3274.00361 14202.8069   334%     -   18s
     0     0 13860.7338    0  289 3274.00361 13860.7338   323%     -   20s
H    0     0                    3362.5511535 13817.0333   311%     -   20s
H    0     0                    3367.6803440 13817.0333   310%     -   20s
H    0     0                    3408.5814521 13817.0333   305%     -   20s
     0     0 13817.0333    0  298 3408.58145 13817.0333   305%     -   20s
     0     0 13791.0260    0  308 3408.58145 13791.0260   305%     -   20s
     0     0 13774.8807    0  314 3408.58145 13774.8807   304%     -   21s
     0     0 13750.4813    0  308 3408.58145 13750.4813   303%     -   21s
     0     0 13748.7004    0  300 3408.58145 13748.7004   303%     -   21s
     0     0 13748.6068    0  304 3408.58145 13748.6068   303%     -   21s
     0     0 13140.3702    0  325 3408.58145 13140.3702   286%     -   25s
H    0     0                    3422.1824032 13140.1704   284%     -   25s
H    0     0                    3428.8994341 13140.1704   283%     -   25s
     0     0 13013.4476    0  313 3428.89943 13013.4476   280%     -   26s
     0     0 12991.9266    0  333 3428.89943 12991.9266   279%     -   26s
     0     0 12986.9453    0  335 3428.89943 12986.9453   279%     -   26s
     0     0 12986.4377    0  332 3428.89943 12986.4377   279%     -   26s
H    0     0                    3443.1722061 12949.5147   276%     -   27s
H    0     0                    3461.8368948 12949.5147   274%     -   27s
     0     0 12949.5147    0  319 3461.83689 12949.5147   274%     -   27s
     0     0 12927.8436    0  309 3461.83689 12927.8436   273%     -   27s
     0     0 12920.8636    0  374 3461.83689 12920.8636   273%     -   28s
     0     0 12918.9004    0  407 3461.83689 12918.9004   273%     -   28s
     0     0 12917.4572    0  365 3461.83689 12917.4572   273%     -   28s
     0     0 12894.8113    0  366 3461.83689 12894.8113   272%     -   29s
     0     0 12886.2715    0  326 3461.83689 12886.2715   272%     -   29s
     0     0 12884.0833    0  378 3461.83689 12884.0833   272%     -   29s
     0     0 12883.4487    0  328 3461.83689 12883.4487   272%     -   30s
     0     0 12854.2796    0  375 3461.83689 12854.2796   271%     -   30s
     0     0 12849.1386    0  388 3461.83689 12849.1386   271%     -   30s
     0     0 12847.4814    0  427 3461.83689 12847.4814   271%     -   31s
     0     0 12840.2777    0  317 3461.83689 12840.2777   271%     -   31s
H    0     0                    3492.8875568 12836.9799   268%     -   32s
     0     0 12836.9799    0  375 3492.88756 12836.9799   268%     -   32s
     0     0 12835.3883    0  379 3492.88756 12835.3883   267%     -   32s
     0     0 12827.6515    0  331 3492.88756 12827.6515   267%     -   32s
H    0     0                    3499.4010299 12827.0910   267%     -   32s
     0     0 12827.0418    0  333 3499.40103 12827.0418   267%     -   33s
     0     0 12821.2937    0  324 3499.40103 12821.2937   266%     -   33s
     0     0 12816.4680    0  375 3499.40103 12816.4680   266%     -   33s
     0     0 12813.5028    0  333 3499.40103 12813.5028   266%     -   34s
     0     0 12812.9213    0  329 3499.40103 12812.9213   266%     -   34s
     0     0 12811.7296    0  328 3499.40103 12811.7296   266%     -   34s
     0     0 12811.4937    0  328 3499.40103 12811.4937   266%     -   34s
     0     2 12811.3726    0  328 3499.40103 12811.3726   266%     -   39s
     1     4 12747.2974    1  366 3499.40103 12811.3226   266%  1006   40s
H   31    64                    3512.5483059 11873.3892   238%  2723   47s
    95   166 10948.1205    7  324 3512.54831 11802.1810   236%  1764   52s
   165   220 10821.8239    8  330 3512.54831 11802.1810   236%  1570   55s
   357   358 9948.86280   10  311 3512.54831 11802.1810   236%  1422   63s
   420   400 10139.0431   10  307 3512.54831 11767.8777   235%  1434   65s
   514   476 9710.01346   12  369 3512.54831 11767.8777   235%  1439   71s
   603   541 9355.69321   14  389 3512.54831 11767.8777   235%  1468   77s
H  607   541                    3526.6057455 11767.8777   234%  1470   77s
H  609   541                    3536.8359543 11767.8777   233%  1470   77s
H  629   541                    3538.2213914 11767.8777   233%  1471   77s
   639   592 9325.99712   15  342 3538.22139 11767.8777   233%  1478   80s
H  722   619                    3541.4312670 11622.2366   228%  1470   82s
   737   642 8620.34776   18  406 3541.43127 11622.2366   228%  1461   85s
H  745   642                    3542.0373009 11622.2366   228%  1457   85s
   957   835 8387.53997   22  372 3542.03730 11498.9120   225%  1300   91s
  1092   923 8039.88724   24  341 3542.03730 11436.3267   223%  1230   95s
H 1102   923                    3545.7101192 11436.3267   223%  1229   95s
  1275  1069 7759.07651   29  287 3545.71012 11436.3267   223%  1158  101s
H 1390  1106                    3552.2894359 11434.9072   222%  1130  103s
H 1392  1106                    3560.0281058 11434.9072   221%  1130  103s
H 1402  1106                    3581.8521464 11434.9072   219%  1128  103s
H 1410  1106                    3600.2611707 11434.9072   218%  1126  103s
  1427  1195 7325.76859   33  194 3600.26117 11434.9072   218%  1124  105s
  1723  1453 7055.41636   43  181 3600.26117 11434.9072   218%  1032  110s
  2123  1786 5771.18866   58  141 3600.26117 11423.6404   217%   920  116s
H 2350  1892                    3603.0744251 11421.4991   217%   881  118s
  2492  2045 4532.98016   67  118 3603.07443 11366.5871   215%   850  122s
  2729  2229 6921.25424    9  357 3603.07443 11361.2165   215%   817  125s
  3232  2460 4146.03089   14  204 3603.07443 11292.2392   213%   762  133s
  3404  2570 7457.60140   12  300 3603.07443 11292.2392   213%   765  136s
  3576  2607 5565.27993   14  263 3603.07443 11292.2392   213%   768  141s
H 3588  2607                    3607.8872001 11292.2392   213%   771  141s
  3673  2676 3834.96392   17  204 3607.88720 11292.2392   213%   773  145s
H 3856  2754                    3635.9392285 11094.8815   205%   773  148s
H 3861  2754                    3651.0463439 11094.8815   204%   774  148s
H 3887  2754                    3685.9318579 11094.8815   201%   770  148s
  3997  2785 6181.17786    9  310 3685.93186 11094.8815   201%   776  153s
  4114  2871 4926.69775   10  277 3685.93186 11090.4075   201%   794  157s
  4257  2963 4110.98217   13  281 3685.93186 11035.2073   199%   803  162s
  4450  2964 5263.36075   41  328 3685.93186 11035.2073   199%   807  174s
  4452  2965 7270.14792   13   73 3685.93186 11035.2073   199%   806  180s
  4453  2966 4566.47223   20  335 3685.93186 11035.2073   199%   806  186s
  4455  2967 3986.67684   49  346 3685.93186 11035.2073   199%   806  190s
  4460  2971 4838.80934  108  326 3685.93186 11035.2073   199%   805  195s
  4466  2975 5611.28989   58  491 3685.93186 11035.2073   199%   804  202s
  4470  2977 9144.11276   34  444 3685.93186 11035.2073   199%   803  206s
  4474  2980 4949.54571   67  494 3685.93186 11035.2073   199%   802  210s
  4477  2982 5661.65855   46  492 3685.93186 11035.2073   199%   802  216s
H 4478  2833                    3687.0877926 11035.2073   199%   802  219s
  4480  2834 7933.87300   46  426 3687.08779 11035.2073   199%   801  220s
  4483  2836 3936.53923   13  488 3687.08779 11035.2073   199%   801  256s
  4484  2837 7580.19864   61  488 3687.08779 11035.2073   199%   801  263s
  4485  2840 11035.2073   11  280 3687.08779 11035.2073   199%   817  267s
  4491  2850 11035.2073   13  361 3687.08779 11035.2073   199%   820  272s
  4499  2864 11035.2073   14  421 3687.08779 11035.2073   199%   823  276s
  4515  2884 11035.2073   15  427 3687.08779 11035.2073   199%   827  281s
  4547  2904 10982.8315   16  441 3687.08779 11035.2073   199%   849  286s
  4579  2937 10588.5710   17  380 3687.08779 10977.2589   198%   880  291s
  4642  2943 8228.69958   18  384 3687.08779 10738.9971   191%   892  296s
  4719  2929 10362.2359   19  419 3687.08779 10598.8031   187%   901  300s
  4867  2892 7326.74377   20  327 3687.08779 10552.1452   186%   923  310s
  4996  2866 5984.23467   17  368 3687.08779 10396.4272   182%   940  315s
  5077  2893 5333.77927   22  343 3687.08779 10396.4272   182%   945  325s
  5219  2881 6722.76113   24  375 3687.08779 9860.66802   167%   950  332s
  5290  2868 6257.62548   25  348 3687.08779 9399.45752   155%   950  335s
  5491  2816     cutoff   28      3687.08779 8835.72266   140%   942  342s
  5630  2774     cutoff   30      3687.08779 8815.03582   139%   939  348s
  5722  2744 3760.44691   32  164 3687.08779 8781.10409   138%   938  351s
  5842  2695     cutoff   29      3687.08779 8038.40277   118%   935  355s
  5987  2646 4379.61193   21  308 3687.08779 8038.40277   118%   930  360s
  6315  2520 4726.86890   22  287 3687.08779 7728.08638   110%   909  368s
  6552  2420 4209.26155   25  302 3687.08779 7286.01891  97.6%   892  373s
  6749  2317     cutoff   25      3687.08779 6632.55703  79.9%   876  376s
  7114  2185     cutoff   40      3687.08779 6082.77105  65.0%   842  381s
  7322  2131 3690.17335   62   28 3687.08779 5603.40512  52.0%   822  386s
  7462  2130 3687.14594   52   38 3687.08779 5538.12273  50.2%   807  390s
  7654  2162 3698.29537   53   48 3687.08779 5538.12273  50.2%   788  395s
H 8197  1961                    3691.7745740 4615.47435  25.0%   738  397s
 11290  1571     cutoff   45      3691.77457 3785.31735  2.53%   543  400s

Cutting planes:
  Gomory: 10
  Lift-and-project: 1
  Implied bound: 1
  MIR: 385
  Flow cover: 898
  RLT: 13
  Relax-and-lift: 103

Explored 18832 nodes (6367328 simplex iterations) in 404.20 seconds (1069.02 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: 3691.77 3687.09 3685.93 ... 3560.03

Optimal solution found (tolerance 1.00e-04)
Best objective 3.691774573987e+03, best bound 3.691774573987e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 404.20s
  Master Objective (UB) = 3691.77, θ = 127848.38
  Upper Bound (UB) = 3691.77

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 127848.38
  [DEBUG]   ✓ Scenario 0: θ = 127848.38 ≤ Q = 127848.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 127848.38 ≤ Q = 127848.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 127848.38 ≤ Q = 127848.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 127848.38 ≤ Q = 127870.28 (slack: 21.90)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x312b9ad7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xced46529
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.202656e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.00s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 6239662.3792
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.193544e+05, 240 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -119354.36    0  122 6239662.38 -119354.36   102%     -    0s
H    0     0                    -87290.83861 -119354.36  36.7%     -    0s
H    0     0                    -87962.51979 -119354.36  35.7%     -    0s
H    0     0                    -91350.99033 -105529.77  15.5%     -    0s
H    0     0                    -92509.26657 -105529.77  14.1%     -    0s
     0     0 -105529.77    0  128 -92509.267 -105529.77  14.1%     -    0s
H    0     0                    -102785.2256 -105430.43  2.57%     -    0s
     0     0 -104731.34    0  128 -102785.23 -104731.34  1.89%     -    0s
H    0     0                    -103720.7195 -104656.69  0.90%     -    0s
     0     0 -104345.09    0   85 -103720.72 -104345.09  0.60%     -    0s
     0     0 -104306.84    0   84 -103720.72 -104306.84  0.57%     -    0s
     0     0 -104219.84    0   96 -103720.72 -104219.84  0.48%     -    0s
     0     0 -104196.93    0   66 -103720.72 -104196.93  0.46%     -    0s
     0     0 -104185.98    0   84 -103720.72 -104185.98  0.45%     -    0s
     0     0 -103885.96    0   18 -103720.72 -103885.96  0.16%     -    0s
     0     0 -103885.46    0   16 -103720.72 -103885.46  0.16%     -    0s
     0     0 -103820.23    0   10 -103720.72 -103820.23  0.10%     -    0s
     0     0 -103776.25    0    6 -103720.72 -103776.25  0.05%     -    0s
     0     0 -103759.94    0    8 -103720.72 -103759.94  0.04%     -    0s
H    0     0                    -103725.1552 -103759.94  0.03%     -    0s
     0     0          -    0      -103725.16 -103732.87  0.01%     -    0s

Cutting planes:
  Gomory: 2
  Implied bound: 3
  MIR: 1
  Flow cover: 7
  Relax-and-lift: 2

Explored 1 nodes (896 simplex iterations) in 0.10 seconds (0.05 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -103725 -103721 -102980 ... 1.20266e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.037251552335e+05, best bound -1.037328735983e+05, gap 0.0074%
  Subproblem solved in 0.12s
  Worst-case operational profit (Z_SP) = 114154.26
  Scenario: 60 demand increases, 0 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -103725.16
  [DEBUG]   S×d_nominal = 217879.41
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 217879.41 + -103725.16 = 114154.26
  [DEBUG]   Current θ from Master = 127848.38
  [DEBUG]   ⚠️  Z_SP ≤ θ by 13694.12 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -10002.35
  Lower Bound (LB) = -1589.09
  Gap (UB-LB) = 5280.8637, Absolute Gap = 5280.8637, Relative Gap = 1.430440
  Not converged yet (gap = 5280.86 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 60 increases, 0 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221674 nonzeros
Model fingerprint: 0x5dd2a6ca
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 35350 rows and 14350 columns
Presolve time: 0.55s
Presolved: 42483 rows, 19110 columns, 263069 nonzeros
Variable types: 16851 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -372533.0079
Found heuristic solution: objective -219438.1934

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 42483 rows, 19110 columns, 263069 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   31446    2.1252698e+03   0.000000e+00   1.020015e+06      5s
   47822    2.0632592e+04   0.000000e+00   6.151233e+07     10s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 2.467681e+04, 43278 iterations, 10.49 seconds (21.14 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 24676.8055    0   75 -219438.19 24676.8055   111%     -   11s
H    0     0                    -211667.8797 24676.8055   112%     -   11s
H    0     0                    -184923.8897 24676.8055   113%     -   11s
H    0     0                    -184670.6881 24676.8055   113%     -   11s
H    0     0                    -183895.0509 24676.8055   113%     -   11s
H    0     0                    -143778.4656 24676.8055   117%     -   11s
H    0     0                    -137480.8791 24676.8055   118%     -   11s
H    0     0                    -137244.7587 24676.8055   118%     -   11s
H    0     0                    -136669.8231 24676.8055   118%     -   11s
H    0     0                    -134930.0222 24676.8055   118%     -   11s
H    0     0                    -134480.5597 24676.8055   118%     -   11s
H    0     0                    -134301.0757 24676.8055   118%     -   11s
H    0     0                    -134205.2213 24676.8055   118%     -   11s
H    0     0                    -48247.96724 24676.8055   151%     -   11s
H    0     0                    -40450.41994 24676.8055   161%     -   11s
H    0     0                    -36159.63194 24676.8055   168%     -   11s
H    0     0                    -8670.097911 24676.8055   385%     -   12s
H    0     0                    -6752.257877 24676.8055   465%     -   12s
H    0     0                    -806.7674552 24676.8055  3159%     -   12s
H    0     0                    -780.5834201 24676.8055  3261%     -   12s
H    0     0                    -710.3424096 24676.8055  3574%     -   12s
     0     0 17407.1072    0  178 -710.34241 17407.1072  2551%     -   18s
     0     0 15186.9146    0  183 -710.34241 15186.9146  2238%     -   20s
     0     0 15186.9146    0  182 -710.34241 15186.9146  2238%     -   20s
     0     0 15186.9146    0  176 -710.34241 15186.9146  2238%     -   20s
     0     0 15186.9146    0  180 -710.34241 15186.9146  2238%     -   20s
     0     0 14993.5143    0  236 -710.34241 14993.5143  2211%     -   26s
     0     0 14540.2351    0  175 -710.34241 14540.2351  2147%     -   28s
     0     0 14323.9414    0  191 -710.34241 14323.9414  2116%     -   29s
     0     0 14258.1448    0  192 -710.34241 14258.1448  2107%     -   30s
     0     0 14254.0238    0  186 -710.34241 14254.0238  2107%     -   30s
     0     0 14253.4562    0  196 -710.34241 14253.4562  2107%     -   30s
     0     0 12276.7066    0  320 -710.34241 12276.7066  1828%     -   39s
     0     0 11773.2965    0  392 -710.34241 11773.2965  1757%     -   42s
     0     0 11677.3297    0  297 -710.34241 11677.3297  1744%     -   43s
     0     0 11626.6675    0  393 -710.34241 11626.6675  1737%     -   44s
     0     0 11585.1606    0  349 -710.34241 11585.1606  1731%     -   45s
     0     0 11577.7009    0  350 -710.34241 11577.7009  1730%     -   45s
     0     0 11568.3203    0  355 -710.34241 11568.3203  1729%     -   46s
     0     0 11566.8398    0  358 -710.34241 11566.8398  1728%     -   46s
     0     0 11566.4504    0  354 -710.34241 11566.4504  1728%     -   47s
     0     0 11133.4163    0  384 -710.34241 11133.4163  1667%     -   54s
     0     0 10853.0749    0  387 -710.34241 10853.0749  1628%     -   56s
     0     0 10768.7370    0  433 -710.34241 10768.7370  1616%     -   58s
     0     0 10736.8321    0  376 -710.34241 10736.8321  1612%     -   59s
     0     0 10709.2434    0  374 -710.34241 10709.2434  1608%     -   60s
     0     0 10653.6695    0  381 -710.34241 10653.6695  1600%     -   60s
     0     0 10646.0760    0  394 -710.34241 10646.0760  1599%     -   61s
     0     0 10634.7096    0  445 -710.34241 10634.7096  1597%     -   61s
     0     0 10630.9608    0  451 -710.34241 10630.9608  1597%     -   62s
     0     0 10629.9485    0  447 -710.34241 10629.9485  1596%     -   62s
     0     0 10548.8540    0  464 -710.34241 10548.8540  1585%     -   64s
     0     0 10509.4284    0  463 -710.34241 10509.4284  1579%     -   65s
     0     0 10502.1439    0  469 -710.34241 10502.1439  1578%     -   66s
     0     0 10485.7583    0  461 -710.34241 10485.7583  1576%     -   66s
     0     0 10474.6846    0  465 -710.34241 10474.6846  1575%     -   67s
     0     0 10466.7943    0  469 -710.34241 10466.7943  1573%     -   67s
     0     0 10465.4552    0  472 -710.34241 10465.4552  1573%     -   68s
     0     0 10380.2696    0  529 -710.34241 10380.2696  1561%     -   69s
     0     0 10367.6088    0  530 -710.34241 10367.6088  1560%     -   71s
     0     0 10362.1314    0  522 -710.34241 10362.1314  1559%     -   71s
     0     0 10359.3618    0  542 -710.34241 10359.3618  1558%     -   72s
     0     0 10355.5935    0  538 -710.34241 10355.5935  1558%     -   72s
     0     0 10355.5649    0  538 -710.34241 10355.5649  1558%     -   72s
     0     0 10305.0214    0  536 -710.34241 10305.0214  1551%     -   74s
     0     0 10287.8774    0  529 -710.34241 10287.8774  1548%     -   75s
     0     0 10282.1387    0  570 -710.34241 10282.1387  1547%     -   76s
     0     0 10280.9420    0  534 -710.34241 10280.9420  1547%     -   76s
     0     0 10256.5955    0  577 -710.34241 10256.5955  1544%     -   77s
     0     0 10250.6476    0  578 -710.34241 10250.6476  1543%     -   80s
     0     0 10249.9793    0  583 -710.34241 10249.9793  1543%     -   80s
     0     0 10234.8060    0  580 -710.34241 10234.8060  1541%     -   81s
     0     0 10229.9778    0  575 -710.34241 10229.9778  1540%     -   82s
     0     0 10228.6641    0  578 -710.34241 10228.6641  1540%     -   82s
     0     0 10222.2314    0  545 -710.34241 10222.2314  1539%     -   83s
     0     0 10218.6986    0  540 -710.34241 10218.6986  1539%     -   84s
     0     0 10215.0929    0  539 -710.34241 10215.0929  1538%     -   84s
     0     0 10214.7411    0  542 -710.34241 10214.7411  1538%     -   84s
     0     0 10186.0866    0  573 -710.34241 10186.0866  1534%     -   86s
     0     0 10170.8675    0  579 -710.34241 10170.8675  1532%     -   87s
     0     0 10164.7175    0  583 -710.34241 10164.7175  1531%     -   87s
     0     0 10164.0221    0  580 -710.34241 10164.0221  1531%     -   88s
     0     0 10158.5310    0  537 -710.34241 10158.5310  1530%     -   89s
     0     0 10155.7170    0  405 -710.34241 10155.7170  1530%     -   89s
     0     0 10154.0425    0  333 -710.34241 10154.0425  1529%     -   89s
     0     0 10148.3786    0  328 -710.34241 10148.3786  1529%     -   90s
     0     0 10148.1270    0  547 -710.34241 10148.1270  1529%     -   90s
     0     0 10147.1762    0  337 -710.34241 10147.1762  1528%     -   91s
     0     0 10146.9471    0  343 -710.34241 10146.9471  1528%     -   91s
     0     0 10146.2538    0  535 -710.34241 10146.2538  1528%     -   91s
     0     0 10146.0374    0  544 -710.34241 10146.0374  1528%     -   92s
     0     0 10145.0425    0  401 -710.34241 10145.0425  1528%     -   92s
     0     0 10143.8474    0  401 -710.34241 10143.8474  1528%     -   93s
     0     2 10143.4261    0  401 -710.34241 10143.4261  1528%     -  105s
     7    16 9711.03027    3  395 -710.34241 9964.88241  1503%  3632  112s
    15    32 9453.30563    4  356 -710.34241 9709.44320  1467%  4645  116s
    31    48 9098.36362    5  549 -710.34241 9453.27227  1431%  5995  130s
    47    80 8407.11583    6  422 -710.34241 9453.27227  1431%  7138  135s
    79   129 8318.52298    7  462 -710.34241 9453.27227  1431%  5608  144s
   128   237 7927.01051    9  307 -710.34241 9453.27227  1431%  4944  151s
   242   348 7921.97815   10  303 -710.34241 9453.27227  1431%  3411  157s
   365   393 7433.21129   14  491 -710.34241 9453.27227  1431%  2750  161s
   413   441 7588.40308   12  400 -710.34241 9453.27227  1431%  2616  167s
   479   488 7734.85145   13  358 -710.34241 9453.27227  1431%  2503  174s
   555   550  405.16933   15  204 -710.34241 9453.27227  1431%  2355  181s
   646   600 7283.18903   14  477 -710.34241 9453.27227  1431%  2189  187s
   744   659  470.13308   16  232 -710.34241 9356.74915  1417%  2040  193s
   831   688 7421.18903   16  497 -710.34241 9356.74915  1417%  1962  199s
   864   732 5792.06001   17  407 -710.34241 9356.74915  1417%  1959  202s
   912   775 4199.50267   18  376 -710.34241 9356.74915  1417%  1924  207s
   965   831  879.76155   18  470 -710.34241 9356.74915  1417%  1888  212s
  1037   911 3369.73084   19  356 -710.34241 9356.74915  1417%  1828  216s
  1131   998 infeasible   19      -710.34241 9211.75703  1397%  1737  220s
  1240  1080 2718.77237   21  284 -710.34241 9211.75703  1397%  1666  226s
  1334  1147     cutoff   21      -710.34241 9151.32868  1388%  1635  232s
  1449  1223 2307.63355   23  306 -710.34241 9151.32868  1388%  1590  237s
  1571  1316 2242.27494   24  295 -710.34241 8890.06290  1352%  1550  242s
  1710  1417 1963.88479   25  294 -710.34241 8860.88903  1347%  1517  248s
  1841  1583 1716.64323   26  240 -710.34241 8700.80866  1325%  1500  253s
  2035  1729 1139.38317   28  299 -710.34241 8700.80866  1325%  1435  258s
  2241  1871  656.05129   31  305 -710.34241 8700.80866  1325%  1374  265s
  2421  2023 infeasible   36      -710.34241 8635.11326  1316%  1343  271s
  2618  2111     cutoff   37      -710.34241 8635.11326  1316%  1309  277s
  2786  2214 7379.64719    8  523 -710.34241 8635.11326  1316%  1304  285s
  2956  2297     cutoff   11      -710.34241 8493.43668  1296%  1300  292s
  3085  2401 5859.53888   11  211 -710.34241 8492.28158  1296%  1309  299s
  3215  2506 5595.94903   12  421 -710.34241 8492.28158  1296%  1300  307s
  3386  2593 5310.29877   13  278 -710.34241 8492.28158  1296%  1285  315s
  3508  2756 5150.19577   14  240 -710.34241 8492.28158  1296%  1276  322s
  3746  2757 3104.77787   52  401 -710.34241 8354.07095  1276%  1256  344s
  3748  2758 7458.55880    9   75 -710.34241 8354.07095  1276%  1255  355s
  3749  2759 7734.07606   14  268 -710.34241 8354.07095  1276%  1255  364s
  3750  2760 3354.72251   20  459 -710.34241 8354.07095  1276%  1254  371s
  3751  2760  941.99659   51  479 -710.34241 8354.07095  1276%  1254  375s
  3753  2762 1276.98776   59  515 -710.34241 8354.07095  1276%  1253  381s
  3756  2764 6825.83990   11  573 -710.34241 8354.07095  1276%  1252  385s
  3759  2766 6576.47696   10  476 -710.34241 8354.07095  1276%  1251  390s
  3763  2768 2893.23367   42  463 -710.34241 8354.07095  1276%  1250  395s
  3767  2771 4130.51665   31  477 -710.34241 8354.07095  1276%  1249  401s
  3769  2772 3069.50085   24  561 -710.34241 8354.07095  1276%  1248  406s
  3772  2774 2512.72760   61  524 -710.34241 8354.07095  1276%  1247  411s
  3775  2776 4764.25057    9  550 -710.34241 8354.07095  1276%  1246  415s
  3778  2778 2126.83495   45  499 -710.34241 8354.07095  1276%  1245  430s
  3779  2779  619.07568   18  499 -710.34241 8354.07095  1276%  1245  438s
  3780  2783 8354.07095   10  465 -710.34241 8354.07095  1276%  1283  450s
  3782  2786 8354.07095   11  394 -710.34241 8354.07095  1276%  1285  455s
  3786  2793 8354.07095   12  408 -710.34241 8354.07095  1276%  1288  463s
  3794  2806 8354.07095   13  495 -710.34241 8354.07095  1276%  1298  471s
  3810  2818 6279.23011   14  473 -710.34241 8354.07095  1276%  1337  489s
  3827  2844 5110.39566   15  505 -710.34241 8354.07095  1276%  1365  499s
  3859  2909 1466.51942   16  425 -710.34241 8354.07095  1276%  1408  508s
  3949  2892 1205.14571   18  370 -710.34241 8354.07095  1276%  1554  518s
  4068  2866  946.21924   21  402 -710.34241 8354.07095  1276%  1581  529s
  4153  2859  -70.61635   23  377 -710.34241 8015.65237  1228%  1600  537s
  4211  2884  346.16883   22  415 -710.34241 8015.65237  1228%  1626  543s
  4278  2906     cutoff   23      -710.34241 8015.65237  1228%  1634  550s
  4445  2928 5693.44493   22  370 -710.34241 8015.65237  1228%  1633  560s
H 4472  2779                    -323.6750864 8015.65237  2576%  1632  560s
  4478  2833     cutoff   21      -323.67509 8015.65237  2576%  1631  568s
  4577  2859 4703.46470   25  291 -323.67509 8015.65237  2576%  1625  575s
H 4593  2721                    -242.5065548 8015.65237  3405%  1626  575s
  4654  2757 4684.57152   26  290 -242.50655 8015.65237  3405%  1622  582s
  4751  2770 4406.17909   30  309 -242.50655 7591.08066  3230%  1616  589s
  4841  2766 4186.29570   33  220 -242.50655 7357.30598  3134%  1615  596s
  4905  2793 1605.30146   36  136 -242.50655 7357.30598  3134%  1617  604s
  4995  2812  638.62699   39   80 -242.50655 7357.30598  3134%  1618  610s
  5103  2794  141.65595   42   76 -242.50655 6722.29991  2872%  1616  618s
  5219  2778 3201.90881   15  234 -242.50655 6189.28099  2652%  1617  626s
  5322  2747 2528.02067   17  207 -242.50655 6189.28099  2652%  1619  633s
  5407  2754 1698.89846   19  269 -242.50655 6183.66300  2650%  1618  639s
  5507  2775 1116.32823   22  170 -242.50655 6183.66300  2650%  1619  647s
  5605  2761  468.86357   25  276 -242.50655 6183.66300  2650%  1624  653s
  5644  2782  443.01711   26  215 -242.50655 6130.38977  2628%  1628  661s
  5726  2792     cutoff   31      -242.50655 5955.48859  2556%  1627  669s
  5872  2786     cutoff   20      -242.50655 5559.29155  2392%  1622  678s
  6017  2761 1006.63319   20  220 -242.50655 5440.26942  2343%  1622  687s
  6139  2731     cutoff   22      -242.50655 5440.26942  2343%  1622  694s
  6187  2728  500.75255   31  252 -242.50655 5352.95205  2307%  1628  701s
  6257  2732 4266.29203   19  417 -242.50655 5352.95205  2307%  1627  707s
  6367  2709 3518.87364   23  321 -242.50655 5352.95205  2307%  1620  716s
  6521  2705 2333.34996   28  297 -242.50655 4983.65007  2155%  1619  726s
  6716  2694  472.74011   32  209 -242.50655 4983.65007  2155%  1615  736s
  6932  2731 infeasible   23      -242.50655 4979.99019  2154%  1611  745s
  7142  2716 3482.55952   19  371 -242.50655 4979.99019  2154%  1605  756s
  7389  2671 2558.80068   24  272 -242.50655 4683.91611  2031%  1599  767s
  7649  2636  798.86803   30  265 -242.50655 4590.10282  1993%  1594  777s
  7905  2587 2674.19887   18  405 -242.50655 4289.60540  1869%  1591  787s
  8171  2537  159.02752   21  256 -242.50655 4214.25248  1838%  1584  799s
  8480  2462 2765.37850   19  370 -242.50655 4098.75902  1790%  1579  812s
  8812  2351  841.75222   24  211 -242.50655 3719.13284  1634%  1570  825s
  9234  2236     cutoff   24      -242.50655 3478.93615  1535%  1546  837s
  9626  2136 1873.09342   24  326 -242.50655 3289.16116  1456%  1535  849s
 10075  2008 1267.07840   33  255 -242.50655 3118.33416  1386%  1518  862s
 10561  1790 1122.83742   41  103 -242.50655 2740.53310  1230%  1497  875s
 11130  1522     cutoff   30      -242.50655 2638.30409  1188%  1474  889s
 11774  1309   76.58943   23  377 -242.50655 2294.24235  1046%  1445  901s
 12369  1052 -171.73513   27  209 -242.50655 1974.73170   914%  1416  916s
 13269   452  -64.90634   21  327 -242.50655 1686.10055   795%  1368  930s
 14432     0     cutoff   39      -242.50655 1067.65907   540%  1300  938s

Cutting planes:
  Learned: 1
  Gomory: 3
  MIR: 697
  Mixing: 1
  Flow cover: 1456
  RLT: 22
  Relax-and-lift: 158

Explored 15061 nodes (19094045 simplex iterations) in 938.25 seconds (2742.25 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -242.507 -323.675 -710.342 ... -48248
No other solutions better than -242.507

Optimal solution found (tolerance 1.00e-04)
Best objective -2.425065548269e+02, best bound -2.425065548269e+02, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 938.25s
  Master Objective (UB) = -242.51, θ = 139343.45
  Upper Bound (UB) = -242.51

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 139343.45
  [DEBUG]   ✓ Scenario 0: θ = 139343.45 ≤ Q = 139343.45 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 139343.45 ≤ Q = 139343.45 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 139343.45 ≤ Q = 139343.45 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 139343.45 ≤ Q = 139343.45 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 139343.45 ≤ Q = 139343.45 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x455cfdd4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x455cfdd4
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.144734e+13
Presolve removed 2600 rows and 1892 columns
Presolve time: 0.00s
Presolved: 493 rows, 497 columns, 1390 nonzeros
Found heuristic solution: objective 5712454.2295
Variable types: 337 continuous, 160 integer (160 binary)

Root relaxation: objective -1.368992e+05, 249 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -136899.19    0  126 5712454.23 -136899.19   102%     -    0s
H    0     0                    -103106.9732 -136899.19  32.8%     -    0s
H    0     0                    -103332.0040 -136899.19  32.5%     -    0s
H    0     0                    -107946.4042 -136899.19  26.8%     -    0s
H    0     0                    -113113.9467 -117472.86  3.85%     -    0s
     0     0 -117169.11    0   31 -113113.95 -117169.11  3.59%     -    0s
H    0     0                    -116441.2870 -117169.11  0.63%     -    0s
H    0     0                    -116685.1485 -117025.69  0.29%     -    0s
     0     0 -116971.44    0   20 -116685.15 -116971.44  0.25%     -    0s
     0     0 -116935.50    0   14 -116685.15 -116935.50  0.21%     -    0s
     0     0 -116889.05    0   14 -116685.15 -116889.05  0.17%     -    0s
     0     0 -116854.66    0    8 -116685.15 -116854.66  0.15%     -    0s
     0     0 -116839.35    0    7 -116685.15 -116839.35  0.13%     -    0s
*    0     0               0    -116771.5717 -116771.57  0.00%     -    0s

Cutting planes:
  Gomory: 18
  MIR: 106
  Flow cover: 4
  RLT: 26

Explored 1 nodes (465 simplex iterations) in 0.02 seconds (0.02 work units)
Thread count was 32 (of 256 available processors)

Solution count 8: -116772 -116685 -113114 ... 1.14473e+13
No other solutions better than -116772

Optimal solution found (tolerance 1.00e-04)
Best objective -1.167715716959e+05, best bound -1.167715716959e+05, gap 0.0000%
  Subproblem solved in 0.03s
  Worst-case operational profit (Z_SP) = 124688.85
  Scenario: 12 demand increases, 48 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -116771.57
  [DEBUG]   S×d_nominal = 241460.42
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 241460.42 + -116771.57 = 124688.85
  [DEBUG]   Current θ from Master = 139343.45
  [DEBUG]   ⚠️  Z_SP ≤ θ by 14654.61 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -14897.12
  Lower Bound (LB) = -1589.09
  Gap (UB-LB) = 1346.5826, Absolute Gap = 1346.5826, Relative Gap = 5.552768
  Not converged yet (gap = 1346.58 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 12 increases, 48 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 264905 nonzeros
Model fingerprint: 0x0d74e203
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 42420 rows and 17220 columns
Presolve time: 0.67s
Presolved: 50703 rows, 22480 columns, 314579 nonzeros
Variable types: 20221 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -372533.0079
Found heuristic solution: objective -219438.1934

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 50703 rows, 22480 columns, 314579 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   33654   -2.6567213e+03   0.000000e+00   4.287312e+06      5s
   46557    1.8072144e+04   0.000000e+00   1.682430e+07     10s
Concurrent spin time: 2.42s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 2.467681e+04, 42040 iterations, 12.00 seconds (23.68 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 24676.8055    0   75 -219438.19 24676.8055   111%     -   13s
H    0     0                    -214198.8478 24676.8055   112%     -   13s
H    0     0                    -88321.34732 24676.8055   128%     -   13s
H    0     0                    -87380.91946 24676.8055   128%     -   13s
H    0     0                    -48247.96724 24676.8055   151%     -   13s
H    0     0                    -31380.78772 24676.8055   179%     -   13s
H    0     0                    -806.7674552 24676.8055  3159%     -   13s
     0     0 18020.4523    0  164 -806.76746 18020.4523  2334%     -   17s
H    0     0                    -713.2361947 18020.2317  2627%     -   17s
H    0     0                    -710.3424096 18020.2317  2637%     -   17s
     0     0 17434.5674    0  185 -710.34241 17434.5674  2554%     -   18s
     0     0 17418.6914    0  186 -710.34241 17418.6914  2552%     -   18s
     0     0 17418.2813    0  186 -710.34241 17418.2813  2552%     -   18s
     0     0 14700.7969    0  235 -710.34241 14700.7969  2170%     -   23s
     0     0 14116.7838    0  246 -710.34241 14116.7838  2087%     -   26s
     0     0 14073.2978    0  252 -710.34241 14073.2978  2081%     -   26s
     0     0 14058.5593    0  264 -710.34241 14058.5593  2079%     -   27s
     0     0 14057.5365    0  262 -710.34241 14057.5365  2079%     -   27s
     0     0 12071.2978    0  361 -710.34241 12071.2978  1799%     -   37s
     0     0 11742.2015    0  371 -710.34241 11742.2015  1753%     -   42s
     0     0 11530.4084    0  366 -710.34241 11530.4084  1723%     -   44s
     0     0 11435.4319    0  385 -710.34241 11435.4319  1710%     -   46s
     0     0 11385.6833    0  390 -710.34241 11385.6833  1703%     -   47s
     0     0 11379.3917    0  402 -710.34241 11379.3917  1702%     -   47s
     0     0 11378.0441    0  404 -710.34241 11378.0441  1702%     -   47s
     0     0 10884.1734    0  425 -710.34241 10884.1734  1632%     -   54s
     0     0 10753.8511    0  436 -710.34241 10753.8511  1614%     -   56s
     0     0 10615.2498    0  454 -710.34241 10615.2498  1594%     -   58s
     0     0 10575.6264    0  467 -710.34241 10575.6264  1589%     -   59s
     0     0 10560.2295    0  464 -710.34241 10560.2295  1587%     -   60s
     0     0 10552.1335    0  471 -710.34241 10552.1335  1585%     -   60s
     0     0 10548.5413    0  476 -710.34241 10548.5413  1585%     -   60s
     0     0 10544.6618    0  487 -710.34241 10544.6618  1584%     -   61s
     0     0 10542.9312    0  490 -710.34241 10542.9312  1584%     -   61s
     0     0 10542.2861    0  484 -710.34241 10542.2861  1584%     -   61s
     0     0 10348.2644    0  459 -710.34241 10348.2644  1557%     -   64s
     0     0 10283.0162    0  467 -710.34241 10283.0162  1548%     -   66s
     0     0 10265.9367    0  477 -710.34241 10265.9367  1545%     -   67s
     0     0 10261.6400    0  481 -710.34241 10261.6400  1545%     -   68s
     0     0 10256.1522    0  474 -710.34241 10256.1522  1544%     -   68s
     0     0 10251.3919    0  482 -710.34241 10251.3919  1543%     -   68s
     0     0 10244.6567    0  492 -710.34241 10244.6567  1542%     -   69s
     0     0 10244.0983    0  493 -710.34241 10244.0983  1542%     -   69s
     0     0 10171.4573    0  386 -710.34241 10171.4573  1532%     -   71s
     0     0 10153.8857    0  462 -710.34241 10153.8857  1529%     -   73s
     0     0 10150.2900    0  468 -710.34241 10150.2900  1529%     -   74s
     0     0 10146.8759    0  465 -710.34241 10146.8759  1528%     -   75s
     0     0 10146.0487    0  473 -710.34241 10146.0487  1528%     -   75s
     0     0 10109.8950    0  468 -710.34241 10109.8950  1523%     -   77s
     0     0 10102.7229    0  476 -710.34241 10102.7229  1522%     -   78s
     0     0 10100.5661    0  489 -710.34241 10100.5661  1522%     -   78s
     0     0 10098.8003    0  493 -710.34241 10098.8003  1522%     -   79s
     0     0 10082.2018    0  487 -710.34241 10082.2018  1519%     -   80s
     0     0 10080.6026    0  503 -710.34241 10080.6026  1519%     -   83s
     0     0 10073.8621    0  486 -710.34241 10073.8621  1518%     -   84s
     0     0 10072.8196    0  497 -710.34241 10072.8196  1518%     -   84s
     0     0 10070.5742    0  503 -710.34241 10070.5742  1518%     -   85s
     0     0 10069.1163    0  495 -710.34241 10069.1163  1518%     -   86s
     0     0 10065.1983    0  489 -710.34241 10065.1983  1517%     -   87s
     0     0 10063.5940    0  489 -710.34241 10063.5940  1517%     -   88s
     0     2 10063.5940    0  489 -710.34241 10063.5940  1517%     -   99s
     1     4 10016.3445    1  459 -710.34241 10063.5940  1517%  1821  103s
     3     8 9871.18829    2  464 -710.34241 10016.1899  1510%  3424  108s
     7    16 9741.02386    3  478 -710.34241 9869.37022  1489%  4643  113s
    15    32 9649.49303    4  477 -710.34241 9740.60672  1471%  5109  118s
    31    49 2033.20645    5  211 -710.34241 9706.68285  1466%  6542  132s
    48    81 6319.43667    6  281 -710.34241 9706.68285  1466%  8496  145s
    80   164 6262.80416    7  280 -710.34241 9706.68285  1466%  6349  155s
   163   291 6079.30948    9  279 -710.34241 9706.68285  1466%  4434  164s
   296   357 5960.43560    9  270 -710.34241 9706.68285  1466%  3163  170s
   402   377 3732.98996   10  234 -710.34241 9706.68285  1466%  2685  177s
   478   421 3455.19521   10  365 -710.34241 9706.68285  1466%  2560  184s
   555   482 3485.46331   10  215 -710.34241 9706.68285  1466%  2429  189s
   644   503 3677.18506   10  229 -710.34241 9706.68285  1466%  2280  195s
   696   518 3680.30986   10  233 -710.34241 9706.68285  1466%  2238  201s
   763   528 3515.13636   10  363 -710.34241 9706.68285  1466%  2145  208s
   815   552 2280.99851   10  189 -710.34241 9706.68285  1466%  2095  214s
   884   578 2639.66471   11  213 -710.34241 9706.68285  1466%  2057  220s
   925   604 2435.94375   11  205 -710.34241 9706.68285  1466%  2031  227s
   997   619 1531.14512   12  204 -710.34241 9649.48317  1458%  1980  233s
  1070   671 infeasible   12      -710.34241 9649.48317  1458%  1934  239s
  1156   721  916.87914   14  188 -710.34241 9649.48317  1458%  1875  245s
  1237   784 1017.10767   14  184 -710.34241 9649.48317  1458%  1834  250s
  1332   839 6025.59911    8  289 -710.34241 9649.48317  1458%  1809  256s
  1444   917 2496.89484   10  218 -710.34241 9649.48317  1458%  1779  261s
  1563   941 2057.15821   11  187 -710.34241 9649.48317  1458%  1742  268s
  1603   976 1856.05132   12  173 -710.34241 8883.43222  1351%  1751  276s
  1644  1012 1789.55218   13  176 -710.34241 8882.84741  1351%  1748  285s
  1692  1066  693.78410   14  162 -710.34241 8882.84741  1351%  1739  290s
  1750  1130  620.81209   15  156 -710.34241 8882.84741  1351%  1728  295s
H 1876  1198                    -663.7802770 8882.84741  1438%  1669  299s
  1950  1330     cutoff   15      -663.78028 8758.63667  1420%  1648  308s
  2160  1512 7122.50572    8  285 -663.78028 8758.63667  1420%  1580  314s
  2384  1651 5047.21869   11  251 -663.78028 8679.09340  1408%  1510  321s
  2606  1819 3651.13816   13  219 -663.78028 8358.37065  1359%  1461  328s
  2842  1942 2373.68255   16  175 -663.78028 8358.37065  1359%  1410  336s
  3118  2077  202.69333   21  137 -663.78028 8320.84673  1354%  1357  344s
  3347  2140 1288.36288    8  359 -663.78028 8320.84673  1354%  1333  353s
  3539  2236  656.40115   10  401 -663.78028 8146.28165  1327%  1339  362s
  3727  2274 infeasible   12      -663.78028 7949.08703  1298%  1352  370s
  3917  2357  839.07990   12  194 -663.78028 7705.38298  1261%  1360  381s
  4154  2421     cutoff   14      -663.78028 7705.38298  1261%  1351  391s
  4353  2520 6169.13119   18  365 -663.78028 7694.43773  1259%  1357  402s
H 4368  2516                    -639.6382946 7694.43773  1303%  1359  402s
  4584  2644 5328.32433   21  272 -639.63829 7421.75569  1260%  1355  411s
  4833  2645 4318.84970   20  489 -639.63829 7374.15417  1253%  1350  434s
  4835  2646  566.04789   11   75 -639.63829 7374.15417  1253%  1349  446s
  4836  2647 2906.69398   12  321 -639.63829 7374.15417  1253%  1349  458s
  4837  2648 3797.07900   26  326 -639.63829 7374.15417  1253%  1348  464s
  4838  2648 3522.55860   26  468 -639.63829 7374.15417  1253%  1348  470s
  4840  2650 -390.27778   16  522 -639.63829 7374.15417  1253%  1348  477s
  4842  2651 1943.73845   51  474 -639.63829 7374.15417  1253%  1347  480s
  4846  2654  790.33007   12  476 -639.63829 7374.15417  1253%  1346  488s
  4848  2655 6351.23600   13  281 -639.63829 7374.15417  1253%  1345  492s
  4850  2656  949.81385   37  463 -639.63829 7374.15417  1253%  1345  495s
  4853  2658 6996.05669    6  374 -639.63829 7374.15417  1253%  1344  501s
  4855  2660 1188.81116   51  381 -639.63829 7374.15417  1253%  1343  506s
  4857  2661  238.37104   14  567 -639.63829 7374.15417  1253%  1343  510s
  4859  2662 2059.00993   21  585 -639.63829 7374.15417  1253%  1342  515s
  4864  2666 1322.19013   24  323 -639.63829 7374.15417  1253%  1341  532s
  4865  2666 3243.66878   15  323 -639.63829 7374.15417  1253%  1341  541s
  4866  2670 7374.15417   15  508 -639.63829 7374.15417  1253%  1370  551s
  4868  2673 7374.15417   16  514 -639.63829 7374.15417  1253%  1371  560s
  4872  2680 7374.15417   17  468 -639.63829 7374.15417  1253%  1371  569s
  4880  2693 7374.15417   18  482 -639.63829 7374.15417  1253%  1380  584s
  4896  2704 7374.15417   19  349 -639.63829 7374.15417  1253%  1401  601s
  4912  2730 6014.29530   20  244 -639.63829 7374.15417  1253%  1422  615s
  4944  2786 1753.33643   21  356 -639.63829 7374.15417  1253%  1451  626s
  5049  2775  854.63023   24  240 -639.63829 7374.15417  1253%  1535  636s
  5146  2756 -401.87124   22  203 -639.63829 7374.15417  1253%  1554  645s
  5224  2743     cutoff   23      -639.63829 7374.15417  1253%  1561  654s
  5285  2740     cutoff   25      -639.63829 7374.15417  1253%  1568  663s
  5351  2738  943.71710   23  235 -639.63829 7374.15417  1253%  1578  670s
  5390  2757  934.55963   24  223 -639.63829 7374.15417  1253%  1586  678s
  5434  2775     cutoff   26      -639.63829 7374.15417  1253%  1592  685s
  5493  2767 3833.11756   24  477 -639.63829 7374.15417  1253%  1599  692s
  5565  2770 3636.11997   26  346 -639.63829 7374.15417  1253%  1607  701s
  5637  2766 3208.96135   28  300 -639.63829 7374.15417  1253%  1610  709s
  5710  2756     cutoff   29      -639.63829 7374.15417  1253%  1616  716s
  5779  2746  197.38922   30  337 -639.63829 7374.15417  1253%  1630  723s
  5846  2759   29.33366   32  288 -639.63829 7374.15417  1253%  1637  733s
  5912  2766 1567.33537   22  216 -639.63829 7374.15417  1253%  1647  741s
  6004  2738 1466.09824   23  215 -639.63829 7374.15417  1253%  1650  750s
  6073  2736 1020.14154   24  174 -639.63829 7374.15417  1253%  1657  757s
  6152  2722     cutoff   28      -639.63829 7374.15417  1253%  1668  767s
  6233  2720 6409.56345   21  472 -639.63829 7374.15417  1253%  1680  773s
  6267  2739 6293.34301   22  447 -639.63829 7104.41491  1211%  1687  780s
  6311  2736 5333.13571   24  387 -639.63829 7104.41491  1211%  1690  787s
  6369  2728 3939.12463   27  298 -639.63829 7104.41491  1211%  1697  796s
  6464  2714 2889.99706   29  248 -639.63829 7104.41491  1211%  1697  804s
  6566  2700     cutoff   33      -639.63829 7104.41491  1211%  1705  815s
  6685  2673  332.84656   24  260 -639.63829 7104.41491  1211%  1712  825s
  6806  2666     cutoff   25      -639.63829 6685.61786  1145%  1725  835s
  6945  2644 3620.03635   23  435 -639.63829 6129.57573  1058%  1731  844s
  7090  2609 2929.34763   25  386 -639.63829 6129.57573  1058%  1736  856s
  7243  2583    0.05007   27  391 -639.63829 5992.46517  1037%  1745  867s
  7400  2546   88.53806   26  362 -639.63829 5765.98836  1001%  1756  880s
  7519  2501 -375.17590   27  419 -639.63829 5765.98836  1001%  1760  893s
  7658  2464 -377.06372   28  425 -639.63829 5185.68210   911%  1771  906s
  7849  2393 -184.42952   23  326 -639.63829 4935.16381   872%  1780  919s
  8044  2317     cutoff   24      -639.63829 4935.16381   872%  1784  933s
  8238  2243 -387.97442   24  178 -639.63829 4479.47841   800%  1795  947s
  8446  2161 -103.68119   34   85 -639.63829 3987.60866   723%  1805  962s
  8718  2045     cutoff   33      -639.63829 3680.17113   675%  1802  976s
  8892  1943     cutoff   31      -639.63829 3398.88543   631%  1806  990s
  9153  1791     cutoff   29      -639.63829 2990.17637   567%  1810 1007s
  9466  1578 -580.04658   24  439 -639.63829 2833.81331   543%  1809 1023s
  9880  1270     cutoff   24      -639.63829 2512.86730   493%  1793 1039s
 10295   899     cutoff   27      -639.63829 1968.40598   408%  1779 1048s
 10715   716     cutoff   25      -639.63829 1107.68195   273%  1742 1050s

Cutting planes:
  Gomory: 11
  Lift-and-project: 1
  MIR: 533
  Flow cover: 1283
  RLT: 24
  Relax-and-lift: 171

Explored 10828 nodes (18853866 simplex iterations) in 1050.95 seconds (3003.26 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -639.638 -663.78 -710.342 ... -214199
No other solutions better than -639.638

Optimal solution found (tolerance 1.00e-04)
Best objective -6.396382945876e+02, best bound -6.396382945876e+02, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1050.96s
  Master Objective (UB) = -639.64, θ = 141755.16
  Upper Bound (UB) = -639.64

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 141755.16
  [DEBUG]   ✓ Scenario 0: θ = 141755.16 ≤ Q = 141755.16 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 141755.16 ≤ Q = 141755.16 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 141755.16 ≤ Q = 141755.16 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 141755.16 ≤ Q = 141755.16 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 141755.16 ≤ Q = 141755.16 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 141755.16 ≤ Q = 141755.16 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x4f93100a
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x4f93100a
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [8e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [3e-13, 2e+02]
Found heuristic solution: objective 1.158329e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.00s
Presolved: 494 rows, 498 columns, 1393 nonzeros
Found heuristic solution: objective 5698768.7725
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.322396e+05, 250 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -132239.64    0  128 5698768.77 -132239.64   102%     -    0s
H    0     0                    -98321.02283 -132239.64  34.5%     -    0s
H    0     0                    -98696.41439 -132239.64  34.0%     -    0s
     0     0 -111118.04    0   57 -98696.414 -111118.04  12.6%     -    0s
H    0     0                    -108646.5255 -110986.20  2.15%     -    0s
H    0     0                    -108963.6166 -110986.20  1.86%     -    0s
H    0     0                    -109677.8283 -110986.20  1.19%     -    0s
H    0     0                    -109994.9194 -110986.20  0.90%     -    0s
     0     0 -110986.20    0   46 -109994.92 -110986.20  0.90%     -    0s
     0     0 -110986.20    0   57 -109994.92 -110986.20  0.90%     -    0s
     0     0 -110604.11    0   37 -109994.92 -110604.11  0.55%     -    0s
     0     0 -110519.85    0   37 -109994.92 -110519.85  0.48%     -    0s
     0     0 -110206.22    0   22 -109994.92 -110206.22  0.19%     -    0s
     0     0 -110181.90    0   17 -109994.92 -110181.90  0.17%     -    0s
     0     0 -110134.26    0   19 -109994.92 -110134.26  0.13%     -    0s
     0     0 -110133.89    0   12 -109994.92 -110133.89  0.13%     -    0s
     0     0 -110114.32    0   10 -109994.92 -110114.32  0.11%     -    0s
     0     0 -110032.42    0    9 -109994.92 -110032.42  0.03%     -    0s
     0     0 -110006.70    0    5 -109994.92 -110006.70  0.01%     -    0s
     0     0 -110006.16    0    4 -109994.92 -110006.16  0.01%     -    0s

Cutting planes:
  Gomory: 1
  Implied bound: 1
  MIR: 1
  Flow cover: 3
  Relax-and-lift: 1

Explored 1 nodes (593 simplex iterations) in 0.08 seconds (0.03 work units)
Thread count was 32 (of 256 available processors)

Solution count 7: -109995 -109902 -109678 ... 1.15833e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.099949194167e+05, best bound -1.100014534427e+05, gap 0.0059%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 131465.50
  Scenario: 24 demand increases, 36 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -109994.92
  [DEBUG]   S×d_nominal = 241460.42
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 241460.42 + -109994.92 = 131465.50
  [DEBUG]   Current θ from Master = 141755.16
  [DEBUG]   ⚠️  Z_SP ≤ θ by 10289.66 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -10929.30
  Lower Bound (LB) = -1589.09
  Gap (UB-LB) = 949.4509, Absolute Gap = 949.4509, Relative Gap = 1.484356
  Not converged yet (gap = 949.45 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 24 increases, 36 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308136 nonzeros
Model fingerprint: 0xc32cfaf0
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 49490 rows and 20090 columns
Presolve time: 0.79s
Presolved: 58923 rows, 25850 columns, 366089 nonzeros
Variable types: 23591 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -372533.0079
Found heuristic solution: objective -219438.1934

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 58923 rows, 25850 columns, 366089 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   37381   -1.7152106e+04   0.000000e+00   6.511584e+07      5s
   48889   -1.0569412e+03   0.000000e+00   1.071043e+07     10s
Concurrent spin time: 1.62s (can be avoided by choosing Method=3)

Solved with primal simplex

Root relaxation: objective 2.467661e+04, 54926 iterations, 13.63 seconds (26.48 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 24676.6113    0   75 -219438.19 24676.6113   111%     -   14s
H    0     0                    -211982.6940 24676.6113   112%     -   14s
H    0     0                    -171449.7936 24676.6113   114%     -   14s
H    0     0                    -168255.5823 24676.6113   115%     -   14s
H    0     0                    -123606.2091 24676.6113   120%     -   15s
H    0     0                    -117939.9086 24676.6113   121%     -   15s
H    0     0                    -117459.8695 24676.6113   121%     -   15s
H    0     0                    -116822.5864 24676.6113   121%     -   15s
H    0     0                    -115629.4593 24676.6113   121%     -   15s
H    0     0                    -115400.9557 24676.6113   121%     -   15s
H    0     0                    -48247.96724 24676.6113   151%     -   15s
H    0     0                    -38280.08608 24676.6113   164%     -   15s
H    0     0                    -36361.01042 24676.6113   168%     -   15s
H    0     0                    -23754.14670 24676.6113   204%     -   15s
H    0     0                    -22741.01435 24676.6113   209%     -   15s
H    0     0                    -7035.479141 24676.6113   451%     -   15s
H    0     0                    -2295.252628 24676.6113  1175%     -   15s
H    0     0                    -1091.432085 24676.6113  2361%     -   15s
H    0     0                    -1019.165854 24676.6113  2521%     -   15s
H    0     0                    -872.5184600 24676.6113  2928%     -   15s
     0     0 19074.2669    0  156 -872.51846 19074.2669  2286%     -   20s
     0     0 19074.1573    0  156 -872.51846 19074.1573  2286%     -   22s
     0     0 19074.1573    0  156 -872.51846 19074.1573  2286%     -   22s
H    0     0                    -855.4025789 16189.1652  1993%     -   29s
H    0     0                    -778.9871995 16189.1652  2178%     -   29s
     0     0 16189.1652    0  253 -778.98720 16189.1652  2178%     -   29s
     0     0 15797.4746    0  248 -778.98720 15797.4746  2128%     -   32s
     0     0 15761.6049    0  254 -778.98720 15761.6049  2123%     -   34s
     0     0 15724.7386    0  264 -778.98720 15724.7386  2119%     -   34s
     0     0 15719.5623    0  271 -778.98720 15719.5623  2118%     -   35s
     0     0 15717.2358    0  270 -778.98720 15717.2358  2118%     -   35s
     0     0 15702.6699    0  275 -778.98720 15702.6699  2116%     -   35s
     0     0 15701.2675    0  275 -778.98720 15701.2675  2116%     -   36s
     0     0 15700.6726    0  275 -778.98720 15700.6726  2116%     -   36s
     0     0 13361.8147    0  299 -778.98720 13361.8147  1815%     -   48s
     0     0 12604.4650    0  343 -778.98720 12604.4650  1718%     -   55s
     0     0 12432.7288    0  356 -778.98720 12432.7288  1696%     -   57s
     0     0 12369.1478    0  358 -778.98720 12369.1478  1688%     -   58s
     0     0 12338.4646    0  356 -778.98720 12338.4646  1684%     -   60s
     0     0 12321.7654    0  359 -778.98720 12321.7654  1682%     -   61s
     0     0 12304.3763    0  354 -778.98720 12304.3763  1680%     -   61s
     0     0 12295.3966    0  355 -778.98720 12295.3966  1678%     -   62s
     0     0 12290.4441    0  365 -778.98720 12290.4441  1678%     -   62s
     0     0 12285.2177    0  372 -778.98720 12285.2177  1677%     -   63s
     0     0 12285.1492    0  372 -778.98720 12285.1492  1677%     -   63s
     0     0 11184.5678    0  408 -778.98720 11184.5678  1536%     -   74s
     0     0 10991.6953    0  433 -778.98720 10991.6953  1511%     -   77s
     0     0 10821.1211    0  487 -778.98720 10821.1211  1489%     -   79s
     0     0 10776.1544    0  432 -778.98720 10776.1544  1483%     -   81s
     0     0 10752.9484    0  430 -778.98720 10752.9484  1480%     -   82s
     0     0 10717.7562    0  423 -778.98720 10717.7562  1476%     -   83s
     0     0 10701.7831    0  425 -778.98720 10701.7831  1474%     -   83s
     0     0 10698.2989    0  431 -778.98720 10698.2989  1473%     -   83s
     0     0 10690.2343    0  440 -778.98720 10690.2343  1472%     -   84s
     0     0 10672.7377    0  447 -778.98720 10672.7377  1470%     -   84s
     0     0 10665.2030    0  442 -778.98720 10665.2030  1469%     -   85s
     0     0 10664.2997    0  443 -778.98720 10664.2997  1469%     -   85s
     0     0 10450.0860    0  441 -778.98720 10450.0860  1441%     -   88s
     0     0 10420.7714    0  503 -778.98720 10420.7714  1438%     -   90s
     0     0 10410.0854    0  502 -778.98720 10410.0854  1436%     -   90s
     0     0 10406.7836    0  445 -778.98720 10406.7836  1436%     -   91s
     0     0 10404.2606    0  444 -778.98720 10404.2606  1436%     -   91s
     0     0 10403.9106    0  496 -778.98720 10403.9106  1436%     -   91s
     0     0 10280.0399    0  480 -778.98720 10280.0399  1420%     -   94s
     0     0 10262.3350    0  472 -778.98720 10262.3350  1417%     -   97s
     0     0 10255.5160    0  528 -778.98720 10255.5160  1417%     -   98s
     0     0 10250.8674    0  476 -778.98720 10250.8674  1416%     -   98s
     0     0 10248.0346    0  486 -778.98720 10248.0346  1416%     -   98s
     0     0 10247.2743    0  436 -778.98720 10247.2743  1415%     -   99s
     0     0 10214.2534    0  482 -778.98720 10214.2534  1411%     -  100s
     0     0 10203.2025    0  495 -778.98720 10203.2025  1410%     -  101s
     0     0 10198.9126    0  481 -778.98720 10198.9126  1409%     -  101s
     0     0 10197.1279    0  496 -778.98720 10197.1279  1409%     -  102s
     0     0 10196.7633    0  495 -778.98720 10196.7633  1409%     -  102s
     0     0 10188.7508    0  432 -778.98720 10188.7508  1408%     -  103s
     0     0 10187.4291    0  492 -778.98720 10187.4291  1408%     -  107s
     0     0 10182.1618    0  493 -778.98720 10182.1618  1407%     -  108s
     0     0 10181.1042    0  493 -778.98720 10181.1042  1407%     -  108s
     0     0 10176.7119    0  493 -778.98720 10176.7119  1406%     -  109s
     0     0 10175.3371    0  494 -778.98720 10175.3371  1406%     -  109s
     0     0 10173.5042    0  500 -778.98720 10173.5042  1406%     -  110s
     0     0 10172.6023    0  500 -778.98720 10172.6023  1406%     -  110s
     0     2 10172.0043    0  500 -778.98720 10172.0043  1406%     -  127s
     1     4 10049.8781    1  563 -778.98720 10172.0043  1406%  3355  131s
     7    16 9681.13439    3  474 -778.98720 10036.8492  1388%  3414  137s
    15    32 9536.05227    4  543 -778.98720 9898.90914  1371%  4537  141s
    31    48 9691.94263    5  527 -778.98720 9726.14209  1349%  5925  152s
    47    80 8937.20582    6  518 -778.98720 9726.14209  1349%  5266  158s
    79   133 8923.51674    7  513 -778.98720 9726.14209  1349%  4577  178s
   132   242 8881.55397    9  504 -778.98720 9726.14209  1349%  5601  188s
   243   316 8836.86428   12  497 -778.98720 9726.14209  1349%  3895  197s
   331   319 6064.80609   13  406 -778.98720 9726.14209  1349%  3395  207s
   404   340 6024.75739   13  409 -778.98720 9726.14209  1349%  3181  216s
   469   367 7493.25706   13  443 -778.98720 9726.14209  1349%  3081  224s
   521   406 7464.19289   12  448 -778.98720 9726.14209  1349%  3112  233s
   582   441 7424.24636   13  451 -778.98720 9726.14209  1349%  3121  241s
   640   502 6824.58083   14  316 -778.98720 9726.14209  1349%  3075  248s
   717   546 4921.16509   15  379 -778.98720 9726.14209  1349%  3041  256s
   785   571 6589.27153   15  302 -778.98720 9726.14209  1349%  3000  264s
   865   594 5740.16509   15  388 -778.98720 9726.14209  1349%  2924  272s
   952   623 5443.84452   15  400 -778.98720 9726.14209  1349%  2849  281s
  1042   658 2013.57786   16  166 -778.98720 9726.14209  1349%  2791  289s
  1103   692 4297.12348   16  368 -778.98720 9726.14209  1349%  2787  297s
  1188   747 3754.33241   16  339 -778.98720 9536.73371  1324%  2725  306s
  1267   795 4635.53674   16  452 -778.98720 9501.09478  1320%  2725  315s
  1351   807 3286.00110   17  330 -778.98720 9501.09478  1320%  2710  324s
  1405   845 2294.95948   18  240 -778.98720 9501.09478  1320%  2724  333s
  1477   932 2083.81733   19  227 -778.98720 9501.09478  1320%  2721  340s
  1592  1002 infeasible   19      -778.98720 9501.09478  1320%  2661  349s
  1728  1018     cutoff   21      -778.98720 9501.09478  1320%  2585  358s
  1772  1052 -283.03237   25  241 -778.98720 9501.09478  1320%  2584  366s
  1818  1095 -345.18481   26  241 -778.98720 9501.09478  1320%  2576  376s
  1882  1138 -418.83885   27  211 -778.98720 9501.09478  1320%  2559  384s
  1946  1193 infeasible   27      -778.98720 9325.12186  1297%  2541  392s
  2029  1250 5395.61169    9  401 -778.98720 9325.12186  1297%  2505  402s
  2140  1294 4410.27743   10  282 -778.98720 9301.92066  1294%  2438  411s
  2242  1327 2544.17687   12  199 -778.98720 9301.92066  1294%  2408  422s
  2339  1396 -418.97618   18  125 -778.98720 9301.92066  1294%  2366  431s
  2469  1483 5038.99597    9  245 -778.98720 9301.92066  1294%  2324  442s
  2624  1571 2404.51790   12  175 -778.98720 9246.24023  1287%  2271  452s
  2794  1649     cutoff   70      -778.98720 9206.82991  1282%  2210  464s
  3001  1749 5736.26219   17  415 -778.98720 9206.82991  1282%  2146  474s
  3201  1817 4435.07013   19  263 -778.98720 9194.38221  1280%  2103  486s
  3440  1896 4384.65773   22  303 -778.98720 9194.38221  1280%  2056  498s
  3619  1915 1195.12257   27  254 -778.98720 9063.59285  1264%  2058  506s
  3664  1937  441.19171   28  170 -778.98720 9063.59285  1264%  2061  513s
  3710  1980 -174.54729   29  218 -778.98720 9063.59285  1264%  2062  524s
  3807  2077  322.45110   31  175 -778.98720 9060.74268  1263%  2052  536s
  4027  2265 5307.11914   10  403 -778.98720 9060.74268  1263%  2021  549s
  4279  2266 1330.21446   20  500 -778.98720 9060.74268  1263%  2007  636s
  4281  2267  611.55327   36   75 -778.98720 9060.74268  1263%  2006  655s
  4282  2268 7162.15798   14  265 -778.98720 9060.74268  1263%  2005  668s
  4283  2269 4708.06338   11  247 -778.98720 9060.74268  1263%  2005  674s
  4284  2269 4015.68314   13  424 -778.98720 9060.74268  1263%  2004  681s
  4285  2270 1428.19204   61  418 -778.98720 9060.74268  1263%  2004  688s
  4286  2271 1502.30398   32  450 -778.98720 9060.74268  1263%  2003  693s
  4287  2271 3136.93979   32  493 -778.98720 9060.74268  1263%  2003  696s
  4289  2273 2303.69619   30  557 -778.98720 9060.74268  1263%  2002  700s
  4293  2275 1433.95638   34  527 -778.98720 9060.74268  1263%  2000  705s
  4297  2278 -130.51977   22  526 -778.98720 9060.74268  1263%  1998  713s
  4299  2279 2656.98890   18  517 -778.98720 9060.74268  1263%  1997  716s
  4300  2280  -19.98436    8  511 -778.98720 9060.74268  1263%  1997  721s
  4304  2283  286.83385   31  511 -778.98720 9060.74268  1263%  1995  728s
  4306  2284 3658.80901   31  461 -778.98720 9060.74268  1263%  1994  730s
  4310  2287 4285.96707   19  495 -778.98720 9060.74268  1263%  1992  739s
  4311  2287 1056.74217   74  512 -778.98720 9060.74268  1263%  1992  740s
  4313  2289 4640.65313   19  590 -778.98720 9060.74268  1263%  1991  745s
  4316  2291  535.95559   17  584 -778.98720 9060.74268  1263%  1989  752s
  4318  2292 1518.17150   36  376 -778.98720 9060.74268  1263%  1988  755s
  4321  2294 3758.59473   12  384 -778.98720 9060.74268  1263%  1987  776s
  4322  2295 -512.13285   49  384 -778.98720 9060.74268  1263%  1987  788s
  4323  2298 9060.74268   11  476 -778.98720 9060.74268  1263%  2036  815s
  4325  2302 9060.74268   12  633 -778.98720 9060.74268  1263%  2039  821s
  4329  2308 9060.74268   13  527 -778.98720 9060.74268  1263%  2044  833s
  4337  2322 9060.74268   14  448 -778.98720 9060.74268  1263%  2050  840s
  4353  2337 8115.58592   15  442 -778.98720 9060.74268  1263%  2088  856s
  4374  2362 5055.58015   16  510 -778.98720 9060.74268  1263%  2123  870s
  4406  2380 3013.01937   17  371 -778.98720 9060.74268  1263%  2174  885s
  4464  2386 2796.14075   18  371 -778.98720 9060.74268  1263%  2236  900s
  4566  2366 2388.09836   19  344 -778.98720 9060.74268  1263%  2255  912s
H 4605  2237                    -758.0003236 9060.74268  1295%  2263  912s
  4631  2260     cutoff   19      -758.00032 9060.74268  1295%  2267  922s
* 4661  2140              26    -683.7436965 9060.74268  1425%  2274  922s
  4709  2137     cutoff   20      -683.74370 9060.74268  1425%  2274  933s
H 4713  2031                    -650.3695164 9060.74268  1493%  2275  933s
  4765  2041     cutoff   21      -650.36952 9060.74268  1493%  2281  946s
  4841  2031     cutoff   23      -650.36952 9060.74268  1493%  2286  955s
  4912  2040 3165.00357   23  285 -650.36952 9060.74268  1493%  2292  963s
  5009  2013 2803.93124   25  254 -650.36952 9060.74268  1493%  2287  971s
  5067  1999 2356.58138   27  207 -650.36952 9060.74268  1493%  2284  980s
  5148  1976     cutoff   28      -650.36952 9060.74268  1493%  2285  988s
  5196  1986 -575.93865   30  166 -650.36952 9060.74268  1493%  2295  994s
  5251  1993     cutoff   31      -650.36952 9060.74268  1493%  2298 1001s
  5319  1956 1876.67657   20  156 -650.36952 8197.24611  1360%  2295 1010s
  5387  1951  847.53451   21  145 -650.36952 8197.24611  1360%  2299 1019s
  5459  1939     cutoff   22      -650.36952 8197.24611  1360%  2296 1029s
  5546  1901   10.69650   22  103 -650.36952 8197.24611  1360%  2289 1037s
  5641  1865     cutoff   23      -650.36952 8197.24611  1360%  2282 1047s
  5724  1827 -332.87459   21  307 -650.36952 8197.24611  1360%  2280 1057s
  5811  1781     cutoff   21      -650.36952 8072.79884  1341%  2279 1068s
  5909  1735 -405.78106   23  306 -650.36952 8072.79884  1341%  2275 1078s
  6007  1688 -447.63795   24  378 -650.36952 8072.79884  1341%  2274 1088s
  6099  1641 -478.52726   25  371 -650.36952 6819.34434  1149%  2272 1100s
  6232  1574 2854.91194   19  273 -650.36952 6819.34434  1149%  2267 1111s
  6383  1485 1621.00451   21  248 -650.36952 6819.34434  1149%  2254 1121s
  6513  1428     cutoff   22      -650.36952 6819.34434  1149%  2241 1133s
  6577  1345 1383.49717   22  252 -650.36952 6819.34434  1149%  2244 1143s
  6732  1233     cutoff   23      -650.36952 4754.52084   831%  2230 1155s
  6876  1135     cutoff   22      -650.36952 4754.52084   831%  2218 1163s
  6983  1086  117.48654   24  369 -650.36952 4754.52084   831%  2206 1170s
  7029  1063 infeasible   25      -650.36952 2625.55626   504%  2198 1176s
  7042  1061 1143.98680   21  403 -650.36952 1143.98680   276%  2199 1181s
  7046  1059 infeasible   24      -650.36952 1124.90540   273%  2199 1190s

Cutting planes:
  MIR: 569
  Mixing: 1
  Flow cover: 1383
  RLT: 12
  Relax-and-lift: 159

Explored 7054 nodes (15703355 simplex iterations) in 1191.26 seconds (3531.75 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -650.37 -683.744 -758 ... -7035.48
No other solutions better than -650.37

Optimal solution found (tolerance 1.00e-04)
Best objective -6.503695163778e+02, best bound -6.503695163778e+02, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1191.27s
  Master Objective (UB) = -650.37, θ = 139963.18
  Upper Bound (UB) = -650.37

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 139963.18
  [DEBUG]   ✓ Scenario 0: θ = 139963.18 ≤ Q = 139963.18 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 139963.18 ≤ Q = 139963.18 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 139963.18 ≤ Q = 139963.18 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 139963.18 ≤ Q = 139963.18 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 139963.18 ≤ Q = 139963.18 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 139963.18 ≤ Q = 139963.18 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 139963.18 ≤ Q = 139963.18 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x71e907d4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x71e907d4
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.153709e+13
Presolve removed 2600 rows and 1892 columns
Presolve time: 0.00s
Presolved: 493 rows, 497 columns, 1390 nonzeros
Found heuristic solution: objective 5779158.1213
Variable types: 337 continuous, 160 integer (160 binary)

Root relaxation: objective -1.311411e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -131141.11    0  123 5779158.12 -131141.11   102%     -    0s
H    0     0                    -98925.69961 -131141.11  32.6%     -    0s
H    0     0                    -99526.84587 -131141.11  31.8%     -    0s
     0     0 -111917.54    0   75 -99526.846 -111917.54  12.4%     -    0s
H    0     0                    -109405.5268 -111818.20  2.21%     -    0s
H    0     0                    -109405.6275 -111818.20  2.21%     -    0s
H    0     0                    -109959.8581 -111818.20  1.69%     -    0s
H    0     0                    -109959.9589 -111818.20  1.69%     -    0s
     0     0 -111240.52    0   63 -109959.96 -111240.52  1.16%     -    0s
     0     0 -111098.33    0   56 -109959.96 -111098.33  1.04%     -    0s
     0     0 -111098.33    0   56 -109959.96 -111098.33  1.04%     -    0s
H    0     0                    -110216.4881 -111098.33  0.80%     -    0s
     0     0 -110831.57    0   59 -110216.49 -110831.57  0.56%     -    0s
H    0     0                    -110290.7237 -110805.14  0.47%     -    0s
     0     0 -110760.82    0   58 -110290.72 -110760.82  0.43%     -    0s
     0     0 -110759.05    0   59 -110290.72 -110759.05  0.42%     -    0s
     0     0 -110507.02    0   29 -110290.72 -110507.02  0.20%     -    0s
     0     0 -110489.70    0   24 -110290.72 -110489.70  0.18%     -    0s
     0     0 -110404.28    0   14 -110290.72 -110404.28  0.10%     -    0s
     0     0 -110391.99    0   13 -110290.72 -110391.99  0.09%     -    0s
     0     0 -110389.90    0   14 -110290.72 -110389.90  0.09%     -    0s
     0     0 -110341.75    0   10 -110290.72 -110341.75  0.05%     -    0s
     0     0 -110331.65    0   11 -110290.72 -110331.65  0.04%     -    0s
H    0     0                    -110291.7476 -110331.65  0.04%     -    0s
     0     0          -    0      -110291.75 -110302.66  0.01%     -    0s

Cutting planes:
  Gomory: 2
  Implied bound: 5
  MIR: 3
  Flow cover: 7

Explored 1 nodes (726 simplex iterations) in 0.08 seconds (0.04 work units)
Thread count was 32 (of 256 available processors)

Solution count 9: -110292 -110291 -110216 ... 1.15371e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.102917476379e+05, best bound -1.103026616224e+05, gap 0.0099%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 131168.67
  Scenario: 32 demand increases, 28 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -110291.75
  [DEBUG]   S×d_nominal = 241460.42
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 241460.42 + -110291.75 = 131168.67
  [DEBUG]   Current θ from Master = 139963.18
  [DEBUG]   ⚠️  Z_SP ≤ θ by 8794.51 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -9444.88
  Lower Bound (LB) = -1589.09
  Gap (UB-LB) = 938.7197, Absolute Gap = 938.7197, Relative Gap = 1.443364
  Not converged yet (gap = 938.72 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 32 increases, 28 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351367 nonzeros
Model fingerprint: 0x8c1586c6
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 56560 rows and 22960 columns
Presolve time: 0.89s
Presolved: 67143 rows, 29220 columns, 417599 nonzeros
Variable types: 26961 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -372533.0079
Found heuristic solution: objective -219438.1934

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 67143 rows, 29220 columns, 417599 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   34104   -4.8675513e+04   0.000000e+00   2.408219e+09      5s
   46150   -1.2219195e+04   0.000000e+00   2.273686e+07     10s
   57017    2.7371755e+03   0.000000e+00   2.729784e+07     15s
Concurrent spin time: 0.00s

Solved with primal simplex

Root relaxation: objective 2.467661e+04, 67163 iterations, 17.56 seconds (41.88 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 24676.6113    0   75 -219438.19 24676.6113   111%     -   18s
H    0     0                    -206920.4925 24676.6113   112%     -   18s
H    0     0                    -162061.8475 24676.6113   115%     -   19s
H    0     0                    -160743.3153 24676.6113   115%     -   19s
H    0     0                    -132666.5340 24676.6113   119%     -   19s
H    0     0                    -126637.4302 24676.6113   119%     -   19s
H    0     0                    -125351.3969 24676.6113   120%     -   19s
H    0     0                    -125326.2799 24676.6113   120%     -   19s
H    0     0                    -48247.96724 24676.6113   151%     -   19s
H    0     0                    -38253.01208 24676.6113   165%     -   19s
H    0     0                    -23513.01082 24676.6113   205%     -   19s
H    0     0                    -20157.45292 24676.6113   222%     -   19s
H    0     0                    -4388.771343 24676.6113   662%     -   19s
H    0     0                    -3645.358059 24676.6113   777%     -   19s
H    0     0                    -1168.816034 24676.6113  2211%     -   19s
H    0     0                    -1016.886006 24676.6113  2527%     -   19s
H    0     0                    -994.9616920 24676.6113  2580%     -   19s
H    0     0                    -872.5184600 24676.6113  2928%     -   19s
     0     0 19316.1683    0  153 -872.51846 19316.1683  2314%     -   26s
     0     0 18947.8488    0  162 -872.51846 18947.8488  2272%     -   27s
     0     0 18947.8488    0  162 -872.51846 18947.8488  2272%     -   28s
H    0     0                    -778.9871995 16006.7079  2155%     -   37s
     0     0 16006.7079    0  205 -778.98720 16006.7079  2155%     -   37s
     0     0 15212.7466    0  272 -778.98720 15212.7466  2053%     -   41s
     0     0 15108.9356    0  269 -778.98720 15108.9356  2040%     -   43s
     0     0 15029.5298    0  227 -778.98720 15029.5298  2029%     -   45s
     0     0 15013.2063    0  284 -778.98720 15013.2063  2027%     -   46s
     0     0 14999.3439    0  227 -778.98720 14999.3439  2025%     -   47s
     0     0 14972.8097    0  296 -778.98720 14972.8097  2022%     -   48s
     0     0 14955.0171    0  252 -778.98720 14955.0171  2020%     -   50s
     0     0 14954.2894    0  252 -778.98720 14954.2894  2020%     -   50s
     0     0 13166.8092    0  252 -778.98720 13166.8092  1790%     -   62s
     0     0 12566.3502    0  269 -778.98720 12566.3502  1713%     -   67s
     0     0 12420.2661    0  333 -778.98720 12420.2661  1694%     -   70s
     0     0 12334.2877    0  279 -778.98720 12334.2877  1683%     -   71s
     0     0 12286.9231    0  348 -778.98720 12286.9231  1677%     -   73s
     0     0 12256.0438    0  350 -778.98720 12256.0438  1673%     -   74s
     0     0 12250.2937    0  357 -778.98720 12250.2937  1673%     -   75s
     0     0 12232.7441    0  342 -778.98720 12232.7441  1670%     -   76s
     0     0 12222.6909    0  354 -778.98720 12222.6909  1669%     -   76s
     0     0 12207.4879    0  351 -778.98720 12207.4879  1667%     -   77s
     0     0 12204.4995    0  352 -778.98720 12204.4995  1667%     -   77s
     0     0 12203.3257    0  355 -778.98720 12203.3257  1667%     -   77s
     0     0 11110.3805    0  417 -778.98720 11110.3805  1526%     -   85s
     0     0 10917.3689    0  381 -778.98720 10917.3689  1501%     -   89s
     0     0 10831.4297    0  443 -778.98720 10831.4297  1490%     -   92s
     0     0 10805.1531    0  446 -778.98720 10805.1531  1487%     -   93s
     0     0 10772.7218    0  449 -778.98720 10772.7218  1483%     -   94s
     0     0 10764.8614    0  446 -778.98720 10764.8614  1482%     -   95s
     0     0 10761.8573    0  448 -778.98720 10761.8573  1482%     -   95s
     0     0 10748.9871    0  445 -778.98720 10748.9871  1480%     -   96s
     0     0 10741.6053    0  449 -778.98720 10741.6053  1479%     -   96s
     0     0 10738.9806    0  451 -778.98720 10738.9806  1479%     -   97s
     0     0 10738.6764    0  451 -778.98720 10738.6764  1479%     -   97s
     0     0 10453.6435    0  391 -778.98720 10453.6435  1442%     -  101s
     0     0 10407.3943    0  460 -778.98720 10407.3943  1436%     -  103s
     0     0 10390.1263    0  472 -778.98720 10390.1263  1434%     -  104s
     0     0 10383.2796    0  398 -778.98720 10383.2796  1433%     -  105s
     0     0 10381.4709    0  469 -778.98720 10381.4709  1433%     -  105s
     0     0 10380.4352    0  474 -778.98720 10380.4352  1433%     -  106s
     0     0 10300.6318    0  452 -778.98720 10300.6318  1422%     -  109s
     0     0 10283.9565    0  441 -778.98720 10283.9565  1420%     -  114s
     0     0 10253.3128    0  501 -778.98720 10253.3128  1416%     -  116s
     0     0 10238.4762    0  517 -778.98720 10238.4762  1414%     -  116s
     0     0 10220.6970    0  515 -778.98720 10220.6970  1412%     -  117s
     0     0 10217.4447    0  525 -778.98720 10217.4447  1412%     -  118s
     0     0 10216.8501    0  526 -778.98720 10216.8501  1412%     -  118s
     0     0 10170.6182    0  575 -778.98720 10170.6182  1406%     -  122s
     0     0 10155.4859    0  481 -778.98720 10155.4859  1404%     -  123s
     0     0 10148.3486    0  479 -778.98720 10148.3486  1403%     -  124s
     0     0 10142.0824    0  496 -778.98720 10142.0824  1402%     -  125s
     0     0 10139.4360    0  493 -778.98720 10139.4360  1402%     -  126s
     0     0 10137.2903    0  493 -778.98720 10137.2903  1401%     -  126s
     0     0 10137.0786    0  494 -778.98720 10137.0786  1401%     -  126s
     0     0 10122.7700    0  331 -778.98720 10122.7700  1399%     -  127s
     0     0 10117.2449    0  342 -778.98720 10117.2449  1399%     -  131s
     0     0 10115.8530    0  408 -778.98720 10115.8530  1399%     -  132s
     0     0 10109.5546    0  405 -778.98720 10109.5546  1398%     -  133s
     0     0 10109.1698    0  527 -778.98720 10109.1698  1398%     -  134s
     0     0 10106.4013    0  403 -778.98720 10106.4013  1397%     -  135s
     0     0 10105.8944    0  351 -778.98720 10105.8944  1397%     -  136s
     0     0 10103.8423    0  344 -778.98720 10103.8423  1397%     -  137s
     0     0 10103.7308    0  344 -778.98720 10103.7308  1397%     -  137s
     0     2 10103.6994    0  344 -778.98720 10103.6994  1397%     -  155s
     3     8 9904.53142    2  517 -778.98720 10005.5116  1384%  3897  162s
     7    16 9662.36766    3  309 -778.98720 9945.41912  1377%  4734  166s
    15    32 9416.39718    4  472 -778.98720 9705.63440  1346%  5290  172s
    31    48 8317.56647    5  390 -778.98720 9446.02247  1313%  8047  190s
    47    80 8106.97483    6  524 -778.98720 9446.02247  1313%  7145  198s
    79   137 7966.80023    7  486 -778.98720 9446.02247  1313%  5902  219s
   136   265 7544.43616    9  471 -778.98720 9446.02247  1313%  4700  227s
   268   317 7965.17869    8  480 -778.98720 9446.02247  1313%  3332  235s
   341   356 6936.07186   10  455 -778.98720 9446.02247  1313%  3515  243s
   415   395 6953.04976   10  462 -778.98720 9446.02247  1313%  3561  251s
   494   427 6383.89628   10  464 -778.98720 9446.02247  1313%  3606  259s
   571   477 6810.62391   12  448 -778.98720 9446.02247  1313%  3685  267s
   650   519 6814.90687   12  455 -778.98720 9446.02247  1313%  3711  274s
   715   552 6864.43364   12  433 -778.98720 9446.02247  1313%  3796  281s
   786   566 6669.36179   11  476 -778.98720 9446.02247  1313%  3741  289s
   852   585 6560.90533   12  445 -778.98720 9446.02247  1313%  3778  298s
   905   620 4885.16666   11  405 -778.98720 9446.02247  1313%  3893  307s
   958   673 6655.69215   13  374 -778.98720 9446.02247  1313%  4010  316s
  1025   710 5754.60201   15  364 -778.98720 9446.02247  1313%  4045  324s
  1070   772 5318.92930   16  346 -778.98720 9446.02247  1313%  4066  331s
  1141   842 5147.71042   17  334 -778.98720 9446.02247  1313%  4026  338s
  1245   912 5097.72971   18  272 -778.98720 9446.02247  1313%  3902  344s
  1351   938 4834.23984   19  327 -778.98720 9446.02247  1313%  3810  351s
  1386   955 4784.12863   20  271 -778.98720 9446.02247  1313%  3827  359s
  1435  1006 4639.78804   21  267 -778.98720 9446.02247  1313%  3828  367s
  1504  1079 4530.08450   22  270 -778.98720 9446.02247  1313%  3811  376s
H 1550  1079                    -716.2943886 9446.02247  1419%  3759  376s
  1591  1166 4470.35847   23  313 -716.29439 9446.02247  1419%  3754  385s
  1721  1272 4383.69708   24  303 -716.29439 9446.02247  1419%  3687  396s
  1855  1326 2541.16463   24  287 -716.29439 9209.35332  1386%  3654  405s
  1966  1391 1684.47794   25  308 -716.29439 9209.35332  1386%  3686  415s
  2071  1479 1510.33931   25  243 -716.29439 9209.35332  1386%  3713  424s
  2215  1564  312.84111   26  256 -716.29439 9209.35332  1386%  3705  434s
  2378  1689 1893.96358   26  288 -716.29439 9209.35332  1386%  3652  445s
  2535  1792 1876.54147   27  290 -716.29439 9209.35332  1386%  3632  456s
  2726  1885 1121.83895   33  202 -716.29439 9209.35332  1386%  3570  468s
  2913  1950 1110.76123   34  198 -716.29439 9209.35332  1386%  3548  481s
  3076  2021     cutoff   42      -716.29439 9209.35332  1386%  3555  494s
  3204  2109     cutoff   49      -716.29439 9077.00269  1367%  3599  506s
  3346  2201 3063.30070   14  209 -716.29439 9077.00269  1367%  3627  518s
  3518  2306     cutoff   23      -716.29439 9077.00269  1367%  3636  531s
  3717  2328 3641.74772   10  240 -716.29439 8938.25598  1348%  3621  543s
  3759  2376 3456.08023   11  213 -716.29439 8938.25598  1348%  3642  555s
  3851  2499 3088.68699   12  202 -716.29439 8938.25598  1348%  3647  569s
  4053  2500 6182.89872   16  344 -716.29439 8938.25598  1348%  3632  611s
  4055  2501 2310.94584   49   75 -716.29439 8938.25598  1348%  3630  633s
  4056  2502 1750.22433   24  273 -716.29439 8938.25598  1348%  3629  646s
  4057  2503 1986.32075   41  326 -716.29439 8938.25598  1348%  3629  657s
  4058  2503 5626.30544   12  426 -716.29439 8938.25598  1348%  3628  663s
  4059  2504  174.08241   21  477 -716.29439 8938.25598  1348%  3627  672s
  4060  2505  249.73859   32  418 -716.29439 8938.25598  1348%  3626  676s
  4061  2505 5290.13587   17  447 -716.29439 8938.25598  1348%  3625  680s
  4063  2507  636.55000   25  506 -716.29439 8938.25598  1348%  3623  686s
  4065  2508 5288.94603   17  473 -716.29439 8938.25598  1348%  3621  690s
  4067  2509 7207.51848   17  465 -716.29439 8938.25598  1348%  3620  696s
  4070  2511 3505.69124   15  307 -716.29439 8938.25598  1348%  3617  700s
  4071  2512 2299.86092   14  494 -716.29439 8938.25598  1348%  3616  705s
  4075  2515 1148.93242   20  440 -716.29439 8938.25598  1348%  3613  711s
  4077  2516 -621.56934   24  469 -716.29439 8938.25598  1348%  3611  717s
  4079  2517  445.57477   22  509 -716.29439 8938.25598  1348%  3609  723s
  4080  2518  206.88625   42  522 -716.29439 8938.25598  1348%  3608  725s
  4083  2520  761.32778   46  464 -716.29439 8938.25598  1348%  3605  731s
  4085  2521 1082.98439   50  504 -716.29439 8938.25598  1348%  3604  739s
  4086  2522 1242.39511   18  341 -716.29439 8938.25598  1348%  3603  740s
  4088  2523 3740.40664   12  437 -716.29439 8938.25598  1348%  3601  745s
  4091  2525  429.68885   16  451 -716.29439 8938.25598  1348%  3598  768s
  4092  2526 1732.42609   15  451 -716.29439 8938.25598  1348%  3598  783s
  4093  2530 8938.25598   11  560 -716.29439 8938.25598  1348%  3651  809s
  4095  2533 8938.25598   12  424 -716.29439 8938.25598  1348%  3652  823s
  4099  2540 8937.89776   13  501 -716.29439 8938.25598  1348%  3653  841s
  4107  2553 8818.04100   14  467 -716.29439 8938.25598  1348%  3662  858s
  4123  2564 8474.16826   15  473 -716.29439 8816.44069  1331%  3693  883s
  4139  2581 7090.07168   16  379 -716.29439 8816.44069  1331%  3728  904s
  4169  2652 6934.51184   17  367 -716.29439 8816.44069  1331%  3775  922s
  4283  2630 5875.73475   21  332 -716.29439 8816.44069  1331%  3784  934s
  4363  2621 3942.34472   20  340 -716.29439 8816.44069  1331%  3808  947s
  4401  2631 4825.34011   22  379 -716.29439 8816.44069  1331%  3831  956s
  4455  2643 4755.63655   22  337 -716.29439 8816.44069  1331%  3859  968s
  4514  2650 4342.53705   23  283 -716.29439 8816.44069  1331%  3868  979s
  4578  2663  825.32877   25  277 -716.29439 8816.44069  1331%  3898  990s
  4642  2678 3169.77341   25  376 -716.29439 8429.82262  1277%  3906  999s
  4711  2694 2856.06681   26  253 -716.29439 8429.82262  1277%  3925 1010s
  4780  2705 2618.66425   27  334 -716.29439 8429.82262  1277%  3926 1019s
  4849  2724 2214.47180   28  264 -716.29439 8429.82262  1277%  3924 1029s
  4914  2726 2083.69229   30  137 -716.29439 8429.82262  1277%  3936 1041s
  4991  2719     cutoff   31      -716.29439 8429.82262  1277%  3933 1050s
  5055  2711  830.50669   34  164 -716.29439 8429.82262  1277%  3932 1061s
  5131  2724     cutoff   35      -716.29439 8429.82262  1277%  3930 1069s
  5195  2733     cutoff   35      -716.29439 8429.82262  1277%  3930 1080s
  5276  2742 infeasible   38      -716.29439 8429.82262  1277%  3920 1090s
  5367  2764 -377.80776   38   96 -716.29439 8139.73459  1236%  3922 1100s
  5467  2781     cutoff   41      -716.29439 7247.56046  1112%  3921 1110s
  5581  2775 5683.75611   17  270 -716.29439 7127.51450  1095%  3908 1122s
  5674  2787 1055.63617   21  174 -716.29439 7123.26768  1094%  3898 1136s
  5772  2768 5198.09728   18  263 -716.29439 7123.26768  1094%  3900 1148s
  5818  2777 2984.00831   19  228 -716.29439 7123.26768  1094%  3905 1160s
  5868  2778 2800.11964   20  224 -716.29439 6865.00336  1058%  3904 1172s
  5932  2792 1914.44967   21  237 -716.29439 6865.00336  1058%  3910 1184s
  6012  2799 1726.83867   22  216 -716.29439 6808.83989  1051%  3912 1198s
  6097  2823  610.35598   24  173 -716.29439 6808.83989  1051%  3902 1213s
  6228  2784     cutoff   21      -716.29439 6802.56234  1050%  3892 1228s
  6279  2779 4437.12471   22  424 -716.29439 6802.56234  1050%  3901 1242s
  6329  2785 3006.73142   24  270 -716.29439 6802.56234  1050%  3921 1256s
  6371  2796 2448.71132   27  209 -716.29439 6438.56464   999%  3933 1270s
  6423  2811  956.85945   29  107 -716.29439 6438.56464   999%  3942 1285s
  6475  2824 infeasible   32      -716.29439 6438.56464   999%  3946 1302s
  6556  2874     cutoff   36      -716.29439 6438.56464   999%  3956 1317s
  6668  2878 3196.59129   22  339 -716.29439 6023.84479   941%  3947 1337s
  6825  2919 2740.48788   25  223 -716.29439 6009.73908   939%  3930 1354s
  6993  2941 1874.79111   29  271 -716.29439 6009.73908   939%  3918 1375s
  7158  2962 1346.50991   33  226 -716.29439 5989.77586   936%  3914 1396s
  7333  3009  611.32449   39  144 -716.29439 5989.77586   936%  3908 1416s
  7527  3040     cutoff   27      -716.29439 5677.85600   893%  3913 1437s
  7701  3132 1320.13634   18  284 -716.29439 5677.85600   893%  3916 1458s
  7922  3169    7.13862   20  307 -716.29439 5677.85600   893%  3903 1483s
  8168  3203     cutoff   21      -716.29439 5619.35400   885%  3890 1508s
  8418  3220 4320.74186   24  248 -716.29439 5355.87067   848%  3884 1534s
  8697  3244 2883.36927   32  300 -716.29439 5266.47505   835%  3886 1558s
  8914  3276  647.76985   43  203 -716.29439 5117.47751   814%  3895 1585s
  9220  3253 infeasible   36      -716.29439 4956.36842   792%  3888 1614s
  9488  3256 1934.29107   27  335 -716.29439 4919.55864   787%  3909 1641s
  9798  3275  285.19171   37  107 -716.29439 4910.50546   786%  3922 1669s
 10172  3263 2287.74117   25  289 -716.29439 4910.50546   786%  3918 1697s
 10548  3260 -269.41957   36  176 -716.29439 4621.12933   745%  3924 1727s
 10947  3258 -591.31637   27  208 -716.29439 4568.70574   738%  3916 1755s
 11397  3263 1406.76360   27  131 -716.29439 4454.35401   722%  3906 1788s
 11867  3231     cutoff   34      -716.29439 4327.57423   704%  3878 1824s
 12313  3367  185.86519   28  209 -716.29439 4327.57423   704%  3869 1857s
 12772  3515 2404.74490   29  115 -716.29439 3925.49259   648%  3866 1892s
 13242  3598 -502.88430   43  158 -716.29439 3856.94190   638%  3858 1929s
 13808  3686  140.33501   43  124 -716.29439 3850.40240   638%  3833 1967s
 14314  3707  706.10768   38  133 -716.29439 3621.82808   606%  3834 2007s
 14897  3753 1374.11501   30  353 -716.29439 3361.87913   569%  3823 2046s
 15500  3731 1474.31796   32  192 -716.29439 3031.61899   523%  3809 2080s
 15623  3739 1368.12352   34  163 -716.29439 2996.45654   518%  3813 2118s
 16098  3725  584.24777   22  477 -716.29439 2921.54576   508%  3802 2161s
 16897  3672 2072.75050   27  273 -716.29439 2764.52913   486%  3763 2205s
 17759  3443 -592.16020   23  391 -716.29439 2549.00967   456%  3719 2252s
 18739  3185 -359.77320   25  290 -716.29439 2182.51687   405%  3666 2301s
 19897  2774  515.54199   40  157 -716.29439 1808.28677   352%  3585 2348s
 21193  1923     cutoff   38      -716.29439 1556.65161   317%  3489 2399s
 22864   249     cutoff   38      -716.29439 1059.10038   248%  3355 2441s
 25260     0     cutoff   32      -716.29439  480.07793   167%  3120 2452s

Cutting planes:
  Learned: 1
  Gomory: 2
  MIR: 650
  Flow cover: 1794
  RLT: 14
  Relax-and-lift: 179

Explored 25531 nodes (79198600 simplex iterations) in 2452.38 seconds (7609.48 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -716.294 -778.987 -872.518 ... -23513
No other solutions better than -716.294

Optimal solution found (tolerance 1.00e-04)
Best objective -7.162943885526e+02, best bound -7.162943885526e+02, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2452.40s
  Master Objective (UB) = -716.29, θ = 142063.50
  Upper Bound (UB) = -716.29

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 142063.50
  [DEBUG]   ✓ Scenario 0: θ = 142063.50 ≤ Q = 142063.50 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 142063.50 ≤ Q = 142063.50 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 142063.50 ≤ Q = 142063.50 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 142063.50 ≤ Q = 142063.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 142063.50 ≤ Q = 142063.50 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 142063.50 ≤ Q = 142063.50 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 142063.50 ≤ Q = 142063.50 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 142063.50 ≤ Q = 142063.50 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x75b0be0c
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x75b0be0c
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [1e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e-14, 2e+02]
Found heuristic solution: objective 1.157837e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.00s
Presolved: 494 rows, 498 columns, 1393 nonzeros
Found heuristic solution: objective 5759079.7935
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.321900e+05, 251 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -132190.03    0  128 5759079.79 -132190.03   102%     -    0s
H    0     0                    -98376.68635 -132190.03  34.4%     -    0s
H    0     0                    -98750.16332 -132190.03  33.9%     -    0s
     0     0 -117469.78    0   63 -98750.163 -117469.78  19.0%     -    0s
H    0     0                    -116114.2165 -117403.93  1.11%     -    0s
     0     0 -117349.77    0   62 -116114.22 -117349.77  1.06%     -    0s
     0     0 -117348.71    0   62 -116114.22 -117348.71  1.06%     -    0s
H    0     0                    -116597.7427 -117348.71  0.64%     -    0s
     0     0 -117078.10    0   35 -116597.74 -117078.10  0.41%     -    0s
     0     0 -116800.10    0   11 -116597.74 -116800.10  0.17%     -    0s
     0     0 -116682.81    0   18 -116597.74 -116682.81  0.07%     -    0s
     0     0 -116682.81    0   14 -116597.74 -116682.81  0.07%     -    0s
     0     0 -116682.73    0    6 -116597.74 -116682.73  0.07%     -    0s
H    0     0                    -116608.5516 -116682.73  0.06%     -    0s
H    0     0                    -116609.3119 -116682.73  0.06%     -    0s
H    0     0                    -116629.3831 -116682.73  0.05%     -    0s
H    0     0                    -116648.2057 -116679.50  0.03%     -    0s
     0     0 -116673.54    0    5 -116648.21 -116673.54  0.02%     -    0s
     0     0 -116665.63    0    4 -116648.21 -116665.63  0.01%     -    0s
H    0     0                    -116658.4061 -116665.63  0.01%     -    0s

Explored 1 nodes (607 simplex iterations) in 0.07 seconds (0.03 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -116658 -116648 -116629 ... 1.15784e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.166584061129e+05, best bound -1.166656325808e+05, gap 0.0062%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 124802.01
  Scenario: 27 demand increases, 33 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -116658.41
  [DEBUG]   S×d_nominal = 241460.42
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 241460.42 + -116658.41 = 124802.01
  [DEBUG]   Current θ from Master = 142063.50
  [DEBUG]   ⚠️  Z_SP ≤ θ by 17261.49 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -17977.78
  Lower Bound (LB) = -1589.09
  Gap (UB-LB) = 872.7948, Absolute Gap = 872.7948, Relative Gap = 1.218486
  Not converged yet (gap = 872.79 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 27 increases, 33 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394598 nonzeros
Model fingerprint: 0x063edf05
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 63630 rows and 25830 columns
Presolve time: 1.02s
Presolved: 75363 rows, 32590 columns, 469109 nonzeros
Variable types: 30331 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -372533.0079
Found heuristic solution: objective -219438.1934

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 75363 rows, 32590 columns, 469109 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   36487   -6.0017970e+04   0.000000e+00   1.642777e+08      5s
   51045   -2.1331923e+04   0.000000e+00   2.477239e+06     10s
   61253   -6.8554072e+03   0.000000e+00   4.087919e+06     15s
   70311   -2.7995104e+03   0.000000e+00   2.995509e+06     20s
Concurrent spin time: 2.44s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 2.467661e+04, 64544 iterations, 22.05 seconds (46.60 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 24676.6113    0   75 -219438.19 24676.6113   111%     -   23s
H    0     0                    -214755.7568 24676.6113   111%     -   23s
H    0     0                    -183003.0572 24676.6113   113%     -   23s
H    0     0                    -182137.0654 24676.6113   114%     -   23s
H    0     0                    -181253.3539 24676.6113   114%     -   23s
H    0     0                    -137549.8776 24676.6113   118%     -   23s
H    0     0                    -135895.5812 24676.6113   118%     -   24s
H    0     0                    -135792.6953 24676.6113   118%     -   24s
H    0     0                    -48247.96724 24676.6113   151%     -   24s
H    0     0                    -41927.97386 24676.6113   159%     -   24s
H    0     0                    -1517.657386 24676.6113  1726%     -   24s
H    0     0                    -872.5184600 24676.6113  2928%     -   24s
     0     0 17943.7452    0  169 -872.51846 17943.7452  2157%     -   31s
     0     0 17663.2976    0  188 -872.51846 17663.2976  2124%     -   35s
     0     0 17633.2015    0  194 -872.51846 17633.2015  2121%     -   36s
     0     0 17616.0198    0  190 -872.51846 17616.0198  2119%     -   37s
     0     0 17615.7881    0  193 -872.51846 17615.7881  2119%     -   37s
     0     0 15083.6841    0  239 -872.51846 15083.6841  1829%     -   46s
H    0     0                    -778.9871995 14594.8116  1974%     -   49s
     0     0 14594.8116    0  232 -778.98720 14594.8116  1974%     -   49s
     0     0 14498.5853    0  232 -778.98720 14498.5853  1961%     -   51s
     0     0 14432.9856    0  240 -778.98720 14432.9856  1953%     -   53s
     0     0 14267.8340    0  246 -778.98720 14267.8340  1932%     -   56s
     0     0 14197.3189    0  248 -778.98720 14197.3189  1923%     -   57s
     0     0 14182.4279    0  262 -778.98720 14182.4279  1921%     -   57s
     0     0 14168.7390    0  270 -778.98720 14168.7390  1919%     -   58s
     0     0 14168.2529    0  274 -778.98720 14168.2529  1919%     -   58s
     0     0 12177.1452    0  362 -778.98720 12177.1452  1663%     -   72s
     0     0 11608.4608    0  397 -778.98720 11608.4608  1590%     -   79s
     0     0 11388.8389    0  394 -778.98720 11388.8389  1562%     -   81s
     0     0 11287.6936    0  399 -778.98720 11287.6936  1549%     -   83s
     0     0 11276.9961    0  400 -778.98720 11276.9961  1548%     -   84s
     0     0 11273.4274    0  407 -778.98720 11273.4274  1547%     -   84s
     0     0 11269.6607    0  415 -778.98720 11269.6607  1547%     -   85s
     0     0 11267.5400    0  416 -778.98720 11267.5400  1546%     -   85s
     0     0 11262.1421    0  415 -778.98720 11262.1421  1546%     -   85s
     0     0 11259.0340    0  411 -778.98720 11259.0340  1545%     -   86s
     0     0 11258.1758    0  414 -778.98720 11258.1758  1545%     -   86s
     0     0 10629.4090    0  436 -778.98720 10629.4090  1465%     -   95s
     0     0 10482.1400    0  447 -778.98720 10482.1400  1446%     -   99s
     0     0 10401.0084    0  450 -778.98720 10401.0084  1435%     -  102s
     0     0 10365.1875    0  441 -778.98720 10365.1875  1431%     -  103s
     0     0 10340.7238    0  451 -778.98720 10340.7238  1427%     -  105s
     0     0 10319.6059    0  456 -778.98720 10319.6059  1425%     -  106s
     0     0 10309.2085    0  460 -778.98720 10309.2085  1423%     -  107s
     0     0 10302.7246    0  460 -778.98720 10302.7246  1423%     -  108s
     0     0 10298.7161    0  461 -778.98720 10298.7161  1422%     -  108s
     0     0 10293.6080    0  461 -778.98720 10293.6080  1421%     -  109s
     0     0 10292.7265    0  464 -778.98720 10292.7265  1421%     -  109s
     0     0 10190.9979    0  444 -778.98720 10190.9979  1408%     -  114s
     0     0 10166.1402    0  458 -778.98720 10166.1402  1405%     -  116s
     0     0 10156.2925    0  459 -778.98720 10156.2925  1404%     -  118s
     0     0 10150.2913    0  392 -778.98720 10150.2913  1403%     -  118s
     0     0 10145.4043    0  473 -778.98720 10145.4043  1402%     -  119s
     0     0 10143.6598    0  464 -778.98720 10143.6598  1402%     -  120s
     0     0 10142.6021    0  458 -778.98720 10142.6021  1402%     -  120s
     0     0 10105.5856    0  472 -778.98720 10105.5856  1397%     -  123s
     0     0 10098.4585    0  466 -778.98720 10098.4585  1396%     -  126s
     0     0 10094.2728    0  395 -778.98720 10094.2728  1396%     -  127s
     0     0 10093.5533    0  449 -778.98720 10093.5533  1396%     -  127s
     0     0 10071.4989    0  430 -778.98720 10071.4989  1393%     -  130s
     0     0 10064.4217    0  434 -778.98720 10064.4217  1392%     -  131s
     0     0 10061.1403    0  347 -778.98720 10061.1403  1392%     -  132s
     0     0 10061.1355    0  347 -778.98720 10061.1355  1392%     -  132s
     0     0 10054.5278    0  470 -778.98720 10054.5278  1391%     -  133s
     0     0 10053.9717    0  333 -778.98720 10053.9717  1391%     -  139s
     0     0 10050.1014    0  323 -778.98720 10050.1014  1390%     -  139s
     0     0 10046.2226    0  322 -778.98720 10046.2226  1390%     -  140s
     0     0 10045.9308    0  331 -778.98720 10045.9308  1390%     -  141s
     0     0 10045.3523    0  310 -778.98720 10045.3523  1390%     -  142s
     0     0 10045.1518    0  326 -778.98720 10045.1518  1390%     -  142s
     0     0 10041.7208    0  326 -778.98720 10041.7208  1389%     -  143s
     0     0 10041.5150    0  326 -778.98720 10041.5150  1389%     -  143s
     0     2 10041.5150    0  326 -778.98720 10041.5150  1389%     -  166s
     3     7 9804.80782    2  533 -778.98720 9997.45878  1383%  5564  177s
     6    14 9791.59419    3  537 -778.98720 9804.19450  1359%  5805  181s
    13    28 9386.13037    4  512 -778.98720 9786.72479  1356%  5442  190s
    27    42 8658.29889    5  499 -778.98720 9374.99858  1303%  9994  207s
    41    74 8342.98434    6  506 -778.98720 9374.99858  1303%  9283  276s
    73   171 7937.80950    7  467 -778.98720 8956.35736  1250%  9041  290s
   170   264 7851.92354    9  451 -778.98720 8953.85307  1249%  5969  300s
   263   332 7596.79637   10  430 -778.98720 8953.85307  1249%  4742  309s
   350   368 7648.54347   11  495 -778.98720 8953.85307  1249%  4182  318s
   409   399 7588.78079   12  547 -778.98720 8667.98960  1213%  4120  328s
   459   432 7437.99035   13  541 -778.98720 8667.90872  1213%  4407  337s
   515   466 6387.15108   15  385 -778.98720 8667.90872  1213%  4526  346s
   581   505 5676.54879   16  410 -778.98720 8667.90872  1213%  4656  355s
   640   542 5620.55613   17  355 -778.98720 8667.90872  1213%  4810  364s
   704   580 5204.11756   18  257 -778.98720 8667.90872  1213%  4954  373s
   772   623 2532.55348   10  170 -778.98720 8667.90872  1213%  4937  381s
   839   684 4554.22372   19  172 -778.98720 8667.90872  1213%  4813  389s
   922   731 4376.24174   20  225 -778.98720 8667.90872  1213%  4656  397s
  1007   741 3943.71879   22  337 -778.98720 8667.90872  1213%  4572  407s
  1077   786 3759.85156   23  337 -778.98720 8486.42685  1189%  4566  416s
  1152   838 3548.69358   26  342 -778.98720 8485.72371  1189%  4628  426s
  1230   889 3267.34553   31  372 -778.98720 8485.72371  1189%  4661  435s
  1309   959 2805.95824   35  256 -778.98720 8485.72371  1189%  4658  445s
  1397  1032 2413.03196   37  230 -778.98720 8485.72371  1189%  4665  456s
  1508  1111 1951.63412   43  281 -778.98720 8485.72371  1189%  4585  466s
  1619  1205 1591.07355   47  212 -778.98720 8485.72371  1189%  4513  477s
  1755  1262  539.74915   58  130 -778.98720 8485.72371  1189%  4414  488s
  1866  1327 6577.47205    8  393 -778.98720 8485.72371  1189%  4378  499s
  1953  1383 6089.92461    9  352 -778.98720 8485.72371  1189%  4477  510s
  2071  1429 5276.69235   10  329 -778.98720 8306.37725  1166%  4478  522s
  2155  1507 4907.88727   11  225 -778.98720 8306.37725  1166%  4498  533s
  2267  1631 4821.27794   12  228 -778.98720 8306.37725  1166%  4460  546s
  2452  1746 3540.09463   15  288 -778.98720 8015.93083  1129%  4330  559s
  2618  1857 2652.43562   19  238 -778.98720 8015.93083  1129%  4290  573s
  2782  1887  363.31514   22  185 -778.98720 8007.34032  1128%  4236  581s
  2824  1927     cutoff   23      -778.98720 8007.34032  1128%  4258  596s
  2923  2006 1448.32282   24  248 -778.98720 8007.34032  1128%  4231  611s
  3046  2014 1156.47825   31  201 -778.98720 7890.07448  1113%  4199  626s
  3100  2057  868.94639   32  244 -778.98720 7851.92552  1108%  4209  641s
  3163  2106  816.71438   33  233 -778.98720 7850.54410  1108%  4228  657s
  3315  2207  339.53730   30  125 -778.98720 7814.27705  1103%  4194  674s
  3496  2330 3300.93554   12  204 -778.98720 7814.27705  1103%  4170  690s
  3741  2433  354.62505   44  211 -778.98720 7736.96410  1093%  4115  708s
  3951  2548 7445.90671    6  397 -778.98720 7655.65846  1083%  4114  726s
  4219  2637     cutoff    9      -778.98720 7642.99015  1081%  4085  748s
  4469  2771     cutoff    7      -778.98720 7615.99583  1078%  4068  768s
  4701  2772   39.24609   42  326 -778.98720 7615.99583  1078%  4075  809s
  4703  2773 3671.29249   28   75 -778.98720 7615.99583  1078%  4074  840s
  4704  2774 5569.62582   13  249 -778.98720 7615.99583  1078%  4073  856s
  4705  2775 2308.82695   39  321 -778.98720 7615.99583  1078%  4072  868s
  4706  2775 4254.13154   11  402 -778.98720 7615.99583  1078%  4071  878s
  4707  2776 5817.93228   18  461 -778.98720 7615.99583  1078%  4070  884s
  4708  2777   39.24609   42  439 -778.98720 7615.99583  1078%  4069  889s
  4709  2777 1011.08705   24  362 -778.98720 7615.99583  1078%  4068  893s
  4710  2778 4408.38005   18  443 -778.98720 7615.99583  1078%  4067  898s
  4711  2779  695.73417   58  458 -778.98720 7615.99583  1078%  4067  900s
  4714  2781  914.00988   36  451 -778.98720 7615.99583  1078%  4064  910s
  4716  2782 3169.25256   14  320 -778.98720 7615.99583  1078%  4062  915s
  4718  2783 5142.49315   20  498 -778.98720 7615.99583  1078%  4061  922s
  4720  2785 2854.77567   11  452 -778.98720 7615.99583  1078%  4059  926s
  4721  2785 2060.25656   13  519 -778.98720 7615.99583  1078%  4058  930s
  4723  2787 7205.74330    9  310 -778.98720 7615.99583  1078%  4056  936s
  4725  2788  725.83088   23  574 -778.98720 7615.99583  1078%  4055  943s
  4726  2789  936.98778   16  318 -778.98720 7615.99583  1078%  4054  945s
  4727  2789 2618.37558   14  522 -778.98720 7615.99583  1078%  4053  953s
  4729  2791 -105.12786   43  323 -778.98720 7615.99583  1078%  4051  957s
  4730  2791  586.81144   39  316 -778.98720 7615.99583  1078%  4050  961s
  4732  2793 1207.93509   16  477 -778.98720 7615.99583  1078%  4049  965s
  4733  2793 4467.24083   24  477 -778.98720 7615.99583  1078%  4048  993s
  4734  2794 -709.86712   25  477 -778.98720 7615.99583  1078%  4047 1011s
  4735  2798 7615.99583   15  367 -778.98720 7615.99583  1078%  4093 1036s
  4737  2801 7615.99583   16  364 -778.98720 7615.99583  1078%  4092 1056s
  4741  2808 7615.99583   17  361 -778.98720 7615.99583  1078%  4096 1069s
  4749  2821 7615.99583   18  373 -778.98720 7615.99583  1078%  4109 1085s
  4765  2833  725.42598   19  139 -778.98720 7615.99583  1078%  4124 1116s
  4782  2859 5459.53462   20  303 -778.98720 7615.99583  1078%  4183 1138s
  4814  2902 4831.58047   21  278 -778.98720 7615.99583  1078%  4184 1160s
  4915  2895 4364.80500   22  300 -778.98720 7615.99583  1078%  4236 1178s
  4999  2871  394.40513   24  262 -778.98720 7615.99583  1078%  4211 1197s
  5072  2855  244.14695   24  202 -778.98720 7615.99583  1078%  4202 1214s
  5137  2849  -14.86452   25  173 -778.98720 7615.99583  1078%  4181 1230s
  5202  2832     cutoff   28      -778.98720 7615.99583  1078%  4172 1247s
  5267  2833 4192.27029   26  387 -778.98720 7615.99583  1078%  4157 1266s
  5308  2836 3642.85206   27  289 -778.98720 7615.99583  1078%  4165 1282s
  5372  2833 3205.47367   29  284 -778.98720 7615.99583  1078%  4155 1297s
  5429  2830 3130.21267   30  224 -778.98720 7615.99583  1078%  4145 1311s
  5495  2823 2696.41779   32  209 -778.98720 7615.99583  1078%  4134 1325s
  5567  2818  862.21825   35  158 -778.98720 7615.99583  1078%  4114 1341s
  5647  2804  783.27134   36  125 -778.98720 7615.99583  1078%  4087 1355s
  5724  2799  418.57739   38  156 -778.98720 7615.99583  1078%  4064 1373s
  5794  2785 -502.86103   42  138 -778.98720 7615.99583  1078%  4053 1392s
  5870  2759 1670.65905   24  149 -778.98720 7615.99583  1078%  4040 1408s
  5918  2760 -628.51511   26   92 -778.98720 7615.99583  1078%  4033 1424s
  5983  2761 3877.17027   24  249 -778.98720 7615.99583  1078%  4021 1441s
  6061  2750 1745.13706   26  116 -778.98720 7615.99583  1078%  4006 1467s
  6151  2756     cutoff   28      -778.98720 7615.99583  1078%  3986 1487s
  6232  2757 3143.90632   27  326 -778.98720 6578.66996   945%  3990 1506s
  6332  2759 2507.29997   29  226 -778.98720 6578.66996   945%  3968 1527s
  6435  2743 2124.09463   31  301 -778.98720 6578.66996   945%  3954 1549s
  6545  2722     cutoff   34      -778.98720 6578.66996   945%  3934 1575s
  6665  2688 infeasible   40      -778.98720 6578.66996   945%  3919 1598s
  6777  2649     cutoff   31      -778.98720 5410.56531   795%  3911 1628s
  6876  2628  463.60300   30   62 -778.98720 5000.62999   742%  3899 1654s
  6996  2607 3910.14705   24  356 -778.98720 5000.62999   742%  3887 1676s
  7142  2575 3054.37079   27  419 -778.98720 5000.62999   742%  3867 1698s
  7295  2524 -121.60859   30  360 -778.98720 4350.38338   658%  3847 1719s
  7350  2509 -272.58424   31  362 -778.98720 4139.57100   631%  3842 1735s
  7406  2486 -272.84584   32  363 -778.98720 4139.57100   631%  3835 1754s
  7472  2435     cutoff   34      -778.98720 3910.08407   602%  3824 1774s
  7554  2389 1547.75645   31  295 -778.98720 3909.77026   602%  3813 1796s
  7654  2325     cutoff   39      -778.98720 3909.77026   602%  3804 1823s
  7748  2291     cutoff   27      -778.98720 3909.77026   602%  3791 1847s
  7894  2236     cutoff   39      -778.98720 3233.52508   515%  3772 1870s
  8083  2082 -496.49827   23  180 -778.98720 3007.38545   486%  3737 1899s
  8382  1864     cutoff   25      -778.98720 2691.19025   445%  3679 1929s
  8779  1558     cutoff   32      -778.98720 2691.19025   445%  3591 1957s
  9121  1347     cutoff   25      -778.98720 1098.95493   241%  3512 1971s
  9288  1280     cutoff   40      -778.98720  584.39489   175%  3462 1986s
  9303  1273     cutoff   54      -778.98720 -492.98972  36.7%  3458 2000s

Cutting planes:
  Gomory: 1
  MIR: 731
  Mixing: 1
  Flow cover: 1797
  RLT: 19
  Relax-and-lift: 236

Explored 9314 nodes (32412900 simplex iterations) in 2001.22 seconds (5320.47 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -778.987 -872.518 -1517.66 ... -183003
No other solutions better than -778.987

Optimal solution found (tolerance 1.00e-04)
Best objective -7.789871995146e+02, best bound -7.789871995146e+02, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2001.26s
  Master Objective (UB) = -778.99, θ = 142103.05
  Upper Bound (UB) = -778.99

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 142103.05
  [DEBUG]   ✓ Scenario 0: θ = 142103.05 ≤ Q = 142103.05 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 142103.05 ≤ Q = 142103.05 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 142103.05 ≤ Q = 142103.05 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 142103.05 ≤ Q = 142103.05 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 142103.05 ≤ Q = 142103.05 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 142103.05 ≤ Q = 142103.05 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 142103.05 ≤ Q = 142103.05 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 142103.05 ≤ Q = 142103.05 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 142103.05 ≤ Q = 142103.05 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x6a981cca
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x6a981cca
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.152079e+13
Presolve removed 2598 rows and 1890 columns
Presolve time: 0.00s
Presolved: 495 rows, 499 columns, 1396 nonzeros
Found heuristic solution: objective 5645110.8258
Variable types: 339 continuous, 160 integer (160 binary)

Root relaxation: objective -1.321029e+05, 252 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -132102.92    0  128 5645110.83 -132102.92   102%     -    0s
H    0     0                    -98335.07865 -132102.92  34.3%     -    0s
H    0     0                    -98710.47021 -132102.92  33.8%     -    0s
     0     0 -108776.69    0   20 -98710.470 -108776.69  10.2%     -    0s
H    0     0                    -100743.2859 -108776.69  7.97%     -    0s
H    0     0                    -100953.5354 -108776.69  7.75%     -    0s
H    0     0                    -107969.5566 -108776.69  0.75%     -    0s
     0     0 -108718.38    0   19 -107969.56 -108718.38  0.69%     -    0s
     0     0 -108718.38    0   20 -107969.56 -108718.38  0.69%     -    0s
     0     0 -108717.45    0   20 -107969.56 -108717.45  0.69%     -    0s
H    0     0                    -108534.5353 -108717.45  0.17%     -    0s
     0     0 -108576.18    0    4 -108534.54 -108576.18  0.04%     -    0s
     0     0 -108576.18    0   10 -108534.54 -108576.18  0.04%     -    0s
H    0     0                    -108552.2967 -108576.18  0.02%     -    0s
     0     0          -    0      -108552.30 -108561.55  0.01%     -    0s

Cutting planes:
  Gomory: 1
  Implied bound: 2
  MIR: 6
  Flow cover: 2
  RLT: 3
  Relax-and-lift: 2

Explored 1 nodes (479 simplex iterations) in 0.10 seconds (0.02 work units)
Thread count was 32 (of 256 available processors)

Solution count 9: -108552 -108535 -108141 ... 1.15208e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.085522967436e+05, best bound -1.085615537612e+05, gap 0.0085%
  Subproblem solved in 0.12s
  Worst-case operational profit (Z_SP) = 132908.12
  Scenario: 7 demand increases, 53 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -108552.30
  [DEBUG]   S×d_nominal = 241460.42
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 241460.42 + -108552.30 = 132908.12
  [DEBUG]   Current θ from Master = 142103.05
  [DEBUG]   ⚠️  Z_SP ≤ θ by 9194.93 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -9973.91
  Lower Bound (LB) = -1589.09
  Gap (UB-LB) = 810.1020, Absolute Gap = 810.1020, Relative Gap = 1.039943
  Not converged yet (gap = 810.10 > ε = 200)

  [DEBUG] Adding NEW scenario 9 to Master Problem...
  [DEBUG] New scenario pattern: 7 increases, 53 decreases
    [DEBUG] Scenario 9 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 9 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 9]
    [DEBUG]   - Total constraints in model: 154283
    [DEBUG]   - Total variables in model: 64660
  [DEBUG] Total scenarios in Master: 10
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 10
================================================================================
[Iteration 10] Solving Master Problem...
  Current scenarios in Master: 10
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 154283 rows, 64660 columns and 437829 nonzeros
Model fingerprint: 0x3130c4e1
Variable types: 62401 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 70700 rows and 28700 columns
Presolve time: 1.04s
Presolved: 83583 rows, 35960 columns, 511929 nonzeros
Variable types: 33701 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -373989.5650
Found heuristic solution: objective -219438.1934

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.15s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.509e+06
 Factor NZ  : 7.538e+06 (roughly 100 MB of memory)
 Factor Ops : 1.260e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.59412596e+07  1.44266472e+08  8.88e+04 2.30e+01  7.05e+04     2s
   1  -1.21340554e+07  1.26441631e+08  6.25e+04 7.13e+01  4.90e+04     2s
   2  -5.65385764e+06  9.87870371e+07  2.77e+04 4.99e-11  2.27e+04     2s
   3  -8.57626843e+05  7.11204477e+07  2.00e+03 1.15e+00  2.01e+03     2s
   4  -4.77007077e+05  2.05757918e+07  3.68e+02 8.62e-02  3.79e+02     2s
   5  -3.76797258e+05  1.38087594e+07  1.80e+02 4.76e-02  2.01e+02     2s
   6  -2.78779736e+05  1.04578858e+07  1.03e+02 3.35e-02  1.27e+02     2s
   7  -2.24925062e+05  8.49817268e+06  7.00e+01 2.48e-02  9.18e+01     2s
   8  -1.44956217e+05  6.30790963e+06  3.15e+01 1.64e-02  5.54e+01     2s
   9  -1.18807530e+05  4.40141986e+06  1.68e+01 1.07e-02  3.49e+01     2s
  10  -9.71384600e+04  1.96996506e+06  8.77e+00 4.16e-03  1.50e+01     2s
  11  -6.59932714e+04  5.09092652e+05  3.33e+00 9.42e-04  3.96e+00     2s
  12  -4.51231732e+04  3.07645139e+05  2.18e+00 9.61e-04  2.39e+00     2s
  13  -3.11177389e+04  2.03470167e+05  1.48e+00 7.82e-04  1.57e+00     2s
  14  -2.51249669e+04  1.43646660e+05  1.24e+00 7.91e-04  1.13e+00     2s
  15  -2.13251602e+04  1.18543010e+05  1.08e+00 5.95e-04  9.35e-01     2s
  16  -1.92550158e+04  1.06389129e+05  1.02e+00 5.22e-04  8.40e-01     2s
  17  -8.92645241e+03  8.22192872e+04  7.16e-01 1.59e-03  6.07e-01     2s
  18  -2.62657901e+03  6.80520896e+04  5.64e-01 1.55e-03  4.70e-01     2s
  19   2.94422665e+03  5.50786769e+04  4.38e-01 1.41e-03  3.46e-01     2s
  20   8.07885153e+03  4.47735048e+04  3.34e-01 1.82e-03  2.44e-01     3s
  21   1.09552921e+04  4.18269070e+04  2.80e-01 1.68e-03  2.05e-01     3s
  22   1.28937967e+04  3.82806729e+04  2.42e-01 1.96e-03  1.69e-01     3s
  23   1.54093353e+04  3.59561997e+04  1.97e-01 1.31e-03  1.36e-01     3s
  24   1.62785143e+04  3.28793967e+04  1.82e-01 1.36e-03  1.11e-01     3s
  25   1.83300054e+04  3.17169398e+04  1.49e-01 1.40e-03  8.92e-02     3s
  26   1.90541822e+04  3.12028213e+04  1.37e-01 1.42e-03  8.09e-02     3s
  27   2.00104157e+04  3.04390344e+04  1.21e-01 1.20e-03  6.95e-02     3s
  28   2.07121348e+04  3.03607516e+04  1.10e-01 1.13e-03  6.43e-02     3s
  29   2.11919262e+04  3.00614964e+04  1.02e-01 9.83e-04  5.91e-02     3s
  30   2.22047948e+04  2.97533859e+04  8.62e-02 9.73e-04  5.03e-02     3s
  31   2.24891447e+04  2.94316815e+04  8.13e-02 8.86e-04  4.63e-02     3s
  32   2.42326703e+04  2.88952850e+04  5.48e-02 1.30e-03  3.11e-02     3s
  33   2.48569250e+04  2.86892826e+04  4.57e-02 8.53e-04  2.56e-02     3s
  34   2.54398875e+04  2.85697336e+04  3.70e-02 8.48e-04  2.09e-02     3s
  35   2.59724607e+04  2.85025410e+04  2.90e-02 7.56e-04  1.69e-02     3s
  36   2.63431440e+04  2.83319958e+04  2.39e-02 1.08e-03  1.33e-02     3s
  37   2.69010005e+04  2.81991881e+04  1.56e-02 7.71e-04  8.66e-03     3s
  38   2.69207203e+04  2.81598354e+04  1.54e-02 5.80e-04  8.27e-03     3s
  39   2.70261654e+04  2.81555116e+04  1.39e-02 5.98e-04  7.54e-03     3s
  40   2.72879358e+04  2.81220705e+04  1.01e-02 5.51e-04  5.56e-03     3s
  41   2.74400086e+04  2.80834360e+04  7.85e-03 4.14e-04  4.29e-03     3s
  42   2.75704877e+04  2.80647968e+04  5.97e-03 4.06e-04  3.30e-03     3s
  43   2.76192039e+04  2.80622703e+04  5.29e-03 4.03e-04  2.95e-03     3s
  44   2.77956386e+04  2.80506713e+04  2.79e-03 2.81e-04  1.70e-03     3s
  45   2.78230574e+04  2.80240338e+04  2.40e-03 1.27e-04  1.34e-03     3s
  46   2.79019512e+04  2.80211751e+04  1.34e-03 1.06e-04  7.94e-04     3s
  47   2.79299333e+04  2.80167953e+04  9.58e-04 1.32e-04  5.78e-04     3s
  48   2.79572973e+04  2.80151110e+04  6.08e-04 1.05e-04  3.84e-04     3s
  49   2.79964824e+04  2.80115574e+04  1.13e-04 5.25e-05  9.97e-05     3s
  50   2.80002018e+04  2.80100838e+04  7.28e-05 3.31e-05  6.53e-05     3s
  51   2.80033883e+04  2.80080880e+04  3.88e-05 9.64e-06  3.11e-05     3s
  52   2.80068649e+04  2.80073407e+04  3.51e-06 8.30e-07  3.15e-06     3s
  53   2.80072518e+04  2.80072534e+04  9.37e-09 5.06e-07  1.08e-08     3s
  54   2.80072531e+04  2.80072531e+04  3.39e-10 2.17e-10  9.74e-12     3s

Barrier solved model in 54 iterations and 3.41 seconds (7.05 work units)
Optimal objective 2.80072531e+04

Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 2.800725e+04, 29894 iterations, 2.91 seconds (6.62 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 28007.2531    0  162 -219438.19 28007.2531   113%     -    4s
H    0     0                    -212906.4887 28007.2531   113%     -    4s
H    0     0                    -113220.4543 28007.2531   125%     -    4s
H    0     0                    -58736.25494 28007.2531   148%     -    4s
H    0     0                    -10443.92866 28007.2531   368%     -    5s
H    0     0                    -9260.371998 28007.2531   402%     -    5s
H    0     0                    -9177.748001 28007.2531   405%     -    5s
H    0     0                    -1787.714578 28007.2531  1667%     -    5s
H    0     0                    -1350.627446 28007.2531  2174%     -    5s
     0     0 22365.3453    0  292 -1350.6274 22365.3453  1756%     -   16s
H    0     0                    -1213.408185 22364.9038  1943%     -   16s
     0     0 22118.9020    0  254 -1213.4082 22118.9020  1923%     -   22s
     0     0 22070.0977    0  254 -1213.4082 22070.0977  1919%     -   24s
     0     0 22062.3691    0  251 -1213.4082 22062.3691  1918%     -   24s
     0     0 22025.3070    0  244 -1213.4082 22025.3070  1915%     -   25s
     0     0 22021.0281    0  246 -1213.4082 22021.0281  1915%     -   26s
     0     0 22019.0843    0  246 -1213.4082 22019.0843  1915%     -   26s
     0     0 22019.0843    0  246 -1213.4082 22019.0843  1915%     -   26s
     0     0 18492.3803    0  231 -1213.4082 18492.3803  1624%     -   40s
     0     0 17949.5719    0  250 -1213.4082 17949.5719  1579%     -   52s
     0     0 17866.8879    0  250 -1213.4082 17866.8879  1572%     -   56s
     0     0 17721.4051    0  241 -1213.4082 17721.4051  1560%     -   60s
     0     0 17709.9404    0  244 -1213.4082 17709.9404  1560%     -   61s
     0     0 17637.5896    0  243 -1213.4082 17637.5896  1554%     -   64s
     0     0 17482.7465    0  246 -1213.4082 17482.7465  1541%     -   70s
     0     0 17421.9016    0  264 -1213.4082 17421.9016  1536%     -   76s
     0     0 17410.7257    0  264 -1213.4082 17410.7257  1535%     -   77s
     0     0 17410.1193    0  260 -1213.4082 17410.1193  1535%     -   77s
     0     0 13619.6610    0  329 -1213.4082 13619.6610  1222%     -  102s
     0     0 13075.0785    0  407 -1213.4082 13075.0785  1178%     -  112s
     0     0 12637.8948    0  423 -1213.4082 12637.8948  1142%     -  122s
     0     0 12561.5264    0  378 -1213.4082 12561.5264  1135%     -  125s
     0     0 12473.2663    0  393 -1213.4082 12473.2663  1128%     -  129s
     0     0 12397.1582    0  391 -1213.4082 12397.1582  1122%     -  133s
     0     0 12194.9800    0  397 -1213.4082 12194.9800  1105%     -  139s
     0     0 12156.5392    0  419 -1213.4082 12156.5392  1102%     -  141s
     0     0 12154.3499    0  415 -1213.4082 12154.3499  1102%     -  142s
     0     0 12153.3329    0  409 -1213.4082 12153.3329  1102%     -  143s
     0     0 11290.9547    0  412 -1213.4082 11290.9547  1031%     -  162s
     0     0 10968.7909    0  418 -1213.4082 10968.7909  1004%     -  170s
     0     0 10795.2728    0  440 -1213.4082 10795.2728   990%     -  175s
     0     0 10711.4139    0  447 -1213.4082 10711.4139   983%     -  179s
     0     0 10689.0147    0  462 -1213.4082 10689.0147   981%     -  182s
     0     0 10681.1662    0  457 -1213.4082 10681.1662   980%     -  183s
     0     0 10679.9997    0  453 -1213.4082 10679.9997   980%     -  184s
     0     0 10515.6611    0  364 -1213.4082 10515.6611   967%     -  190s
     0     0 10476.9339    0  375 -1213.4082 10476.9339   963%     -  194s
     0     0 10446.2970    0  445 -1213.4082 10446.2970   961%     -  198s
     0     0 10435.6461    0  377 -1213.4082 10435.6461   960%     -  199s
     0     0 10428.3572    0  370 -1213.4082 10428.3572   959%     -  200s
     0     0 10413.6366    0  373 -1213.4082 10413.6366   958%     -  202s
     0     0 10407.8337    0  423 -1213.4082 10407.8337   958%     -  203s
     0     0 10379.6181    0  443 -1213.4082 10379.6181   955%     -  205s
     0     0 10377.3005    0  381 -1213.4082 10377.3005   955%     -  206s
     0     0 10320.0779    0  414 -1213.4082 10320.0779   951%     -  210s
H    0     0                    -1157.183090 10318.8930   992%     -  213s
     0     0 10309.2409    0  513 -1157.1831 10309.2409   991%     -  216s
     0     0 10300.7438    0  469 -1157.1831 10300.7438   990%     -  217s
     0     0 10291.7121    0  519 -1157.1831 10291.7121   989%     -  219s
     0     0 10287.0367    0  427 -1157.1831 10287.0367   989%     -  220s
     0     0 10286.3160    0  428 -1157.1831 10286.3160   989%     -  221s
     0     0 10219.4004    0  461 -1157.1831 10219.4004   983%     -  224s
H    0     0                    -1091.432085 10215.1959  1036%     -  225s
     0     0 10188.8477    0  465 -1091.4321 10188.8477  1034%     -  227s
     0     0 10180.4064    0  515 -1091.4321 10180.4064  1033%     -  228s
     0     0 10178.4085    0  336 -1091.4321 10178.4085  1033%     -  229s
     0     0 10159.6104    0  513 -1091.4321 10159.6104  1031%     -  233s
H    0     0                    -1077.099348 10159.1730  1043%     -  236s
H    0     0                    -1074.670836 10159.1730  1045%     -  236s
     0     0 10149.2854    0  535 -1074.6708 10149.2854  1044%     -  239s
     0     0 10145.1176    0  578 -1074.6708 10145.1176  1044%     -  240s
     0     0 10143.1604    0  578 -1074.6708 10143.1604  1044%     -  241s
     0     0 10130.6496    0  491 -1074.6708 10130.6496  1043%     -  243s
     0     0 10125.1436    0  505 -1074.6708 10125.1436  1042%     -  246s
     0     0 10122.0985    0  544 -1074.6708 10122.0985  1042%     -  247s
     0     0 10120.3056    0  503 -1074.6708 10120.3056  1042%     -  249s
     0     0 10111.9763    0  490 -1074.6708 10111.9763  1041%     -  251s
     0     0 10110.7751    0  336 -1074.6708 10110.7751  1041%     -  257s
     0     0 10100.3896    0  551 -1074.6708 10100.3896  1040%     -  260s
     0     0 10096.5770    0  502 -1074.6708 10096.5770  1040%     -  261s
     0     0 10094.3971    0  611 -1074.6708 10094.3971  1039%     -  262s
     0     0 10085.1703    0  446 -1074.6708 10085.1703  1038%     -  265s
     0     0 10085.0046    0  446 -1074.6708 10085.0046  1038%     -  266s
H    0     0                    -1013.971770 10084.9826  1095%     -  295s
     0     2 10084.9826    0  446 -1013.9718 10084.9826  1095%     -  303s
     1     4 9998.77820    1  437 -1013.9718 10084.9826  1095%  3194  308s
     3     8 9803.30296    2  556 -1013.9718 9998.69722  1086%  5749  317s
     7    16 9691.98212    3  551 -1013.9718 9803.04036  1067%  6966  325s
    15    32 9308.50397    4  447 -1013.9718 9691.93441  1056%  7480  339s
    31    48 9120.03487    5  563 -1013.9718 9308.49375  1018% 11217  370s
    47    80 8980.66758    6  514 -1013.9718 9308.49375  1018%  9342  387s
    79   141 8737.70250    7  484 -1013.9718 9308.49375  1018%  8187  425s
   140   174 8264.06536    8  468 -1013.9718 9308.49375  1018%  7113  441s
   173   240 8400.48750    9  426 -1013.9718 9308.49375  1018%  6627  458s
   239   308 8385.87044   10  424 -1013.9718 9308.49375  1018%  5579  474s
   313   354 8123.07571   10  414 -1013.9718 9308.49375  1018%  4869  489s
   387   374 8193.49043    9  471 -1013.9718 9308.49375  1018%  4484  506s
   430   404 8385.82291   11  423 -1013.9718 9308.49375  1018%  4316  523s
   477   453 6943.18631   11  291 -1013.9718 9308.49375  1018%  4280  539s
   538   501 6411.53473   11  304 -1013.9718 9308.49375  1018%  4240  552s
   619   534 8233.96003   12  476 -1013.9718 9308.49375  1018%  4006  566s
   690   578 5074.84178   15  313 -1013.9718 9308.49375  1018%  3787  582s
   760   617 4778.24747   16  323 -1013.9718 9308.49375  1018%  3651  596s
   828   652 4366.59329   12  222 -1013.9718 9308.49375  1018%  3518  612s
   889   699 2711.64872   12  245 -1013.9718 9308.49375  1018%  3487  627s
   961   756 3495.26579   13  211 -1013.9718 9308.49375  1018%  3398  643s
  1037   826 3311.64207   13  214 -1013.9718 9308.49375  1018%  3328  658s
  1124   881 2894.25951   14  207 -1013.9718 9308.49375  1018%  3236  672s
  1199   963 3009.22344   14  205 -1013.9718 9195.40286  1007%  3201  686s
  1301  1048 2157.30126   15  204 -1013.9718 9193.79929  1007%  3129  700s
  1414  1142  804.87229   15  212 -1013.9718 9193.79929  1007%  3022  718s
  1524  1261  230.67228   14  199 -1013.9718 9148.25520  1002%  2945  737s
  1659  1374  433.85694   14  196 -1013.9718 9148.25520  1002%  2852  755s
  1800  1505 1680.35543   16  177 -1013.9718 9148.25520  1002%  2768  774s
  1965  1624 1632.76546   17  184 -1013.9718 9148.25520  1002%  2651  794s
  2144  1763 1573.15502   18  176 -1013.9718 8969.80182   985%  2535  812s
  2335  1893  175.40260   19  167 -1013.9718 8969.80182   985%  2434  831s
  2541  1960 1070.46068   19  137 -1013.9718 8964.58985   984%  2345  853s
  2718  2047  996.38496   20  134 -1013.9718 8964.58985   984%  2287  874s
  2853  2144  -56.55638   22  130 -1013.9718 8862.00213   974%  2280  896s
  3013  2237 7318.05612    9  459 -1013.9718 8758.25441   964%  2267  918s
  3198  2326 5693.95635   12  465 -1013.9718 8758.25441   964%  2247  949s
  3336  2435 5104.61602   14  411 -1013.9718 8587.53651   947%  2268  977s
  3483  2609 4649.82845   17  417 -1013.9718 8587.53651   947%  2279 1006s
  3695  2610 3899.24385   37  446 -1013.9718 8587.53651   947%  2251 1120s
  3697  2611  918.50556   25  141 -1013.9718 8587.53651   947%  2250 1128s
  3698  2612 3696.53010   24  302 -1013.9718 8587.53651   947%  2249 1164s
  3699  2613 2475.87823   42  313 -1013.9718 8587.53651   947%  2249 1204s
  3700  2613 4133.67923   16  371 -1013.9718 8587.53651   947%  2248 1227s
  3701  2614 -658.93470   59  431 -1013.9718 8587.53651   947%  2247 1244s
  3702  2615 3928.43719   14  543 -1013.9718 8587.53651   947%  2247 1254s
  3703  2615  -43.39291   59  371 -1013.9718 8587.53651   947%  2246 1262s
  3704  2616  198.90799   69  466 -1013.9718 8587.53651   947%  2245 1267s
  3705  2617 1328.22090   40  487 -1013.9718 8587.53651   947%  2245 1271s
  3707  2618 2110.13054   57  486 -1013.9718 8587.53651   947%  2244 1276s
  3708  2619 -419.94917   26  509 -1013.9718 8587.53651   947%  2243 1285s
  3710  2620 -1012.8221   49  320 -1013.9718 8587.53651   947%  2242 1291s
  3712  2621  392.66356   76  474 -1013.9718 8587.53651   947%  2241 1296s
  3713  2622 4197.15851   21  374 -1013.9718 8587.53651   947%  2240 1302s
  3714  2623 6060.93234   12  328 -1013.9718 8587.53651   947%  2239 1305s
  3715  2623  522.60666   82  535 -1013.9718 8587.53651   947%  2239 1312s
  3717  2625  -64.86617   23  403 -1013.9718 8587.53651   947%  2238 1320s
  3719  2626 6852.81318    9  575 -1013.9718 8587.53651   947%  2236 1327s
  3720  2627 4539.36086   29  530 -1013.9718 8587.53651   947%  2236 1330s
  3721  2627 1347.92108   57  488 -1013.9718 8587.53651   947%  2235 1337s
  3722  2628  317.88506   92  496 -1013.9718 8587.53651   947%  2235 1341s
  3723  2629 4973.46643   25  541 -1013.9718 8587.53651   947%  2234 1346s
  3725  2630 5728.33338   20  483 -1013.9718 8587.53651   947%  2233 1353s
  3726  2631 7607.48337   13  415 -1013.9718 8587.53651   947%  2232 1355s
  3729  2633  543.03953   77  415 -1013.9718 8587.53651   947%  2230 1373s
  3730  2633 2070.56446   12  415 -1013.9718 8587.53651   947%  2230 1407s
  3731  2636 8587.53651   10  437 -1013.9718 8587.53651   947%  2297 1421s
  3732  2639 8510.30563   11  441 -1013.9718 8587.53651   947%  2299 1441s
  3735  2644 7992.97490   12  361 -1013.9718 8587.53651   947%  2305 1463s
  3741  2654 7660.91479   13  383 -1013.9718 8587.53651   947%  2317 1482s
  3753  2662 7834.55706   13  375 -1013.9718 8587.53651   947%  2367 1527s
  3765  2690 5915.14589   14  290 -1013.9718 8587.53651   947%  2396 1583s
  3797  2727 3433.15749   15  277 -1013.9718 8020.49485   891%  2508 1620s
  3845  2757 3341.84979   16  265 -1013.9718 8019.81039   891%  2672 1653s
H 3870  2616                    -967.4096377 8019.81039   929%  2686 1653s
  3893  2689 2957.12709   16  284 -967.40964 8019.81039   929%  2704 1693s
  3994  2687 -436.54620   18  288 -967.40964 8019.81039   929%  2755 1723s
  4054  2717 2840.96773   17  272 -967.40964 8019.81039   929%  2767 1753s
  4138  2727 3259.85115   17  256 -967.40964 7784.29713   905%  2795 1778s
  4209  2758 -583.32010   19  406 -967.40964 7784.29713   905%  2822 1800s
  4277  2776     cutoff   20      -967.40964 7784.29713   905%  2848 1821s
  4343  2800 2591.21002   23  324 -967.40964 7566.05865   882%  2864 1843s
  4423  2800 2562.22624   24  327 -967.40964 7566.05865   882%  2870 1864s
  4496  2815 1665.18109   28  206 -967.40964 7566.05865   882%  2875 1891s
  4583  2799 1319.34913   31  152 -967.40964 7566.05865   882%  2880 1909s
  4617  2811     cutoff   42      -967.40964 7566.05865   882%  2887 1927s
  4669  2809 1129.89586   31  160 -967.40964 7566.05865   882%  2885 1945s
  4708  2831  942.08975   32  368 -967.40964 7566.05865   882%  2894 1963s
H 4749  2693                    -939.1733757 7566.05865   906%  2903 1963s
  4758  2723  664.50019   33  179 -939.17338 7566.05865   906%  2903 1995s
  4868  2745  -86.57202   36  165 -939.17338 7566.05865   906%  2895 2020s
  4979  2755 -514.88550   40  104 -939.17338 7566.05865   906%  2897 2046s
  5100  2757 5852.62425   19  367 -939.17338 7566.05865   906%  2896 2075s
  5233  2764 4398.08152   21  372 -939.17338 7566.05865   906%  2885 2098s
  5353  2745 3251.26377   22  348 -939.17338 6859.32984   830%  2888 2124s
  5472  2761 3135.51939   23  298 -939.17338 6859.32984   830%  2887 2150s
  5583  2749     cutoff   25      -939.17338 6859.32984   830%  2898 2171s
H 5594  2625                    -916.2984082 6859.32984   849%  2899 2171s
  5658  2671 2654.01754   25  401 -916.29841 6859.32984   849%  2902 2198s
  5772  2693 -719.60678   28  342 -916.29841 6859.32984   849%  2918 2226s
  5920  2702     cutoff   29      -916.29841 6518.50049   811%  2916 2262s
  6079  2722 4645.20559   18  354 -916.29841 6288.78189   786%  2921 2295s
  6236  2746 3972.82966   20  464 -916.29841 6288.78189   786%  2923 2327s
  6372  2777 3415.20357   25  433 -916.29841 6143.85862   771%  2938 2358s
  6545  2829 2736.39576   29  396 -916.29841 6143.85862   771%  2946 2392s
  6752  2817 1476.90303   35  221 -916.29841 6143.85862   771%  2936 2422s
  6917  2862 -388.58514   45  241 -916.29841 6143.85862   771%  2915 2458s
  7058  2926 -152.97434   20  177 -916.29841 5963.93912   751%  2929 2495s
  7244  2959 -298.55847   21  181 -916.29841 5963.93912   751%  2930 2534s
  7455  2979 4028.10330   20  344 -916.29841 5869.37392   741%  2930 2579s
  7698  2977 3461.07062   24  404 -916.29841 5804.22738   733%  2920 2623s
  7893  3000 2029.07815   30  305 -916.29841 5712.20396   723%  2934 2669s
  8085  3003   -6.22711   37  222 -916.29841 5637.33025   715%  2950 2716s
  8292  3066 1703.16538   20  452 -916.29841 5629.86294   714%  2956 2767s
  8557  3119  -82.89516   24  311 -916.29841 5557.17164   706%  2960 2822s
  8853  3122     cutoff   24      -916.29841 5451.62077   695%  2957 2871s
  9072  3192     cutoff   35      -916.29841 5447.88099   695%  2960 2928s
  9343  3167 4310.60528   18  346 -916.29841 5414.70120   691%  2948 2986s
  9631  3201 3523.50586   23  284 -916.29841 5341.45886   683%  2958 3046s
  9951  3201  644.55683   31  260 -916.29841 5266.45798   675%  2963 3109s
 10307  3256 infeasible   20      -916.29841 5225.39531   670%  2968 3177s
 10659  3340   56.47518   21  182 -916.29841 5166.34061   664%  2973 3249s
 11023  3479 2587.57100   27  269 -916.29841 4980.60666   644%  2978 3316s
 11350  3576 -357.34768   23  423 -916.29841 4896.50003   634%  2988 3384s
 11722  3789 2856.90332   24  281 -916.29841 4861.30207   631%  2997 3451s
 12149  3919     cutoff   26      -916.29841 4703.96503   613%  3003 3527s
 12566  4008     cutoff   21      -916.29841 4682.66344   611%  3014 3598s
 13025  3992     cutoff   32      -916.29841 4577.92215   600%  3019 3600s

Cutting planes:
  Learned: 4
  Gomory: 15
  Implied bound: 38
  Projected implied bound: 128
  MIR: 1456
  Mixing: 1
  Flow cover: 2669
  RLT: 34
  Relax-and-lift: 378

Explored 13043 nodes (39700319 simplex iterations) in 3600.04 seconds (8643.57 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -916.298 -939.173 -967.41 ... -1350.63

Time limit reached
Best objective -9.162984082382e+02, best bound 4.577922145057e+03, gap 599.6104%
  WARNING: Time limit reached. Using best solution found (gap: 599.61%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.05s
  Master Objective (UB) = -916.30, θ = 141141.54
  Upper Bound (UB) = -916.30

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 141141.54
  [DEBUG]   ✓ Scenario 0: θ = 141141.54 ≤ Q = 141141.54 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 141141.54 ≤ Q = 141141.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 141141.54 ≤ Q = 141141.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 141141.54 ≤ Q = 141141.54 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 141141.54 ≤ Q = 141141.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 141141.54 ≤ Q = 141141.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 141141.54 ≤ Q = 141141.54 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 141141.54 ≤ Q = 141141.54 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 141141.54 ≤ Q = 141141.54 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 141141.54 ≤ Q = 141141.54 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 10] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x53b120b6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xac4edf4a
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.156715e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.00s
Presolved: 494 rows, 498 columns, 1393 nonzeros
Found heuristic solution: objective 5825911.3785
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.297210e+05, 244 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -129721.05    0  123 5825911.38 -129721.05   102%     -    0s
H    0     0                    -97440.71655 -129721.05  33.1%     -    0s
H    0     0                    -98041.86282 -129721.05  32.3%     -    0s
     0     0 -105689.98    0   74 -98041.863 -105689.98  7.80%     -    0s
H    0     0                    -103300.3227 -105601.96  2.23%     -    0s
H    0     0                    -103300.4234 -105601.96  2.23%     -    0s
H    0     0                    -103868.5410 -105601.96  1.67%     -    0s
H    0     0                    -103868.6418 -105601.96  1.67%     -    0s
     0     0 -105041.63    0   75 -103868.64 -105041.63  1.13%     -    0s
H    0     0                    -104138.4207 -105005.40  0.83%     -    0s
     0     0 -104995.79    0   75 -104138.42 -104995.79  0.82%     -    0s
     0     0 -104549.55    0   63 -104138.42 -104549.55  0.39%     -    0s
     0     0 -104425.83    0   65 -104138.42 -104425.83  0.28%     -    0s
     0     0 -104422.83    0   63 -104138.42 -104422.83  0.27%     -    0s
     0     0 -104419.71    0   62 -104138.42 -104419.71  0.27%     -    0s
     0     0 -104409.24    0   55 -104138.42 -104409.24  0.26%     -    0s
     0     0 -104401.43    0   53 -104138.42 -104401.43  0.25%     -    0s
     0     0 -104274.80    0   14 -104138.42 -104274.80  0.13%     -    0s
     0     0 -104272.87    0   12 -104138.42 -104272.87  0.13%     -    0s
     0     0 -104222.87    0    9 -104138.42 -104222.87  0.08%     -    0s
     0     0 -104220.94    0    9 -104138.42 -104220.94  0.08%     -    0s
     0     0 -104201.94    0    5 -104138.42 -104201.94  0.06%     -    0s
     0     0 -104201.94    0    8 -104138.42 -104201.94  0.06%     -    0s
H    0     0                    -104160.3479 -104201.94  0.04%     -    0s
     0     0 -104195.29    0    2 -104160.35 -104195.29  0.03%     -    0s
H    0     0                    -104193.9641 -104194.94  0.00%     -    0s

Cutting planes:
  Gomory: 3
  Implied bound: 2
  MIR: 1
  Flow cover: 6
  Relax-and-lift: 1

Explored 1 nodes (738 simplex iterations) in 0.09 seconds (0.04 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -104194 -104160 -104138 ... 1.15672e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.041939640554e+05, best bound -1.041949390128e+05, gap 0.0009%
  Subproblem solved in 0.12s
  Worst-case operational profit (Z_SP) = 137266.45
  Scenario: 30 demand increases, 30 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -104193.96
  [DEBUG]   S×d_nominal = 241460.42
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 241460.42 + -104193.96 = 137266.45
  [DEBUG]   Current θ from Master = 141141.54
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3875.08 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -4791.38
  Lower Bound (LB) = -1589.09
  Gap (UB-LB) = 672.7908, Absolute Gap = 672.7908, Relative Gap = 0.734249
  Not converged yet (gap = 672.79 > ε = 200)

  [DEBUG] Adding NEW scenario 10 to Master Problem...
  [DEBUG] New scenario pattern: 30 increases, 30 decreases
    [DEBUG] Scenario 10 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 10 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 10]
    [DEBUG]   - Total constraints in model: 169573
    [DEBUG]   - Total variables in model: 70900
  [DEBUG] Total scenarios in Master: 11
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 11
================================================================================
[Iteration 11] Solving Master Problem...
  Current scenarios in Master: 11
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 169573 rows, 70900 columns and 481060 nonzeros
Model fingerprint: 0x4dd90100
Variable types: 68641 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 77770 rows and 31570 columns
Presolve time: 1.10s
Presolved: 91803 rows, 39330 columns, 558929 nonzeros
Variable types: 37071 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -378771.0168
Found heuristic solution: objective -219438.1934

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.18s

Barrier statistics:
 Dense cols : 595
 AA' NZ     : 3.319e+06
 Factor NZ  : 7.510e+06 (roughly 110 MB of memory)
 Factor Ops : 1.324e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.59823193e+07  1.57005111e+08  8.90e+04 2.21e+01  7.02e+04     2s
   1  -1.22341389e+07  1.37948580e+08  6.27e+04 6.78e+01  4.88e+04     2s
   2  -5.93375109e+06  1.07784501e+08  2.91e+04 5.54e-01  2.37e+04     2s
   3  -8.80235768e+05  8.03735673e+07  2.13e+03 1.15e+00  2.12e+03     2s
   4  -4.82537927e+05  2.45651752e+07  3.82e+02 9.97e-02  4.00e+02     2s
   5  -3.86782243e+05  1.66253036e+07  1.85e+02 5.23e-02  2.13e+02     2s
   6  -2.69695736e+05  1.27131611e+07  7.09e+01 3.82e-02  1.17e+02     2s
   7  -1.45916412e+05  1.03823150e+07  2.93e+01 2.95e-02  7.70e+01     2s
   8  -1.30591525e+05  6.19960827e+06  1.49e+01 1.60e-02  4.30e+01     2s
   9  -1.03015538e+05  4.65612149e+06  8.88e+00 1.18e-02  3.08e+01     2s
  10  -6.75898308e+04  1.91884173e+06  2.95e+00 4.17e-03  1.22e+01     2s
  11  -3.73765631e+04  5.88058300e+05  1.13e+00 1.35e-03  3.77e+00     2s
  12  -2.49332275e+04  3.21485483e+05  7.71e-01 8.01e-04  2.08e+00     2s
  13  -2.23105646e+04  2.28175152e+05  6.80e-01 5.67e-04  1.50e+00     2s
  14  -1.94400748e+04  1.72458211e+05  5.84e-01 5.15e-04  1.15e+00     3s
  15  -1.83241810e+04  1.43108742e+05  5.52e-01 4.88e-04  9.66e-01     3s
  16  -1.24945968e+04  1.12450144e+05  4.04e-01 9.42e-04  7.46e-01     3s
  17  -4.44660258e+03  9.01690371e+04  2.57e-01 1.41e-03  5.64e-01     3s
  18   9.28739284e+02  7.75326386e+04  1.86e-01 1.35e-03  4.56e-01     3s
  19   5.88372185e+03  6.64487632e+04  1.43e-01 1.28e-03  3.61e-01     3s
  20   9.87393649e+03  5.87001288e+04  1.10e-01 1.42e-03  2.91e-01     3s
  21   1.12695959e+04  4.76743040e+04  9.97e-02 1.09e-03  2.17e-01     3s
  22   1.39605255e+04  4.36221178e+04  8.22e-02 1.16e-03  1.77e-01     3s
  23   1.53582133e+04  4.11048297e+04  7.26e-02 1.07e-03  1.53e-01     3s
  24   1.74849808e+04  3.82958819e+04  5.94e-02 1.14e-03  1.24e-01     3s
  25   1.92879144e+04  3.57464420e+04  4.82e-02 9.91e-04  9.80e-02     3s
  26   2.03629432e+04  3.44366705e+04  4.17e-02 1.07e-03  8.38e-02     3s
  27   2.20652518e+04  3.31950042e+04  3.16e-02 9.09e-04  6.62e-02     3s
  28   2.26347131e+04  3.24045395e+04  2.84e-02 8.78e-04  5.81e-02     3s
  29   2.31302042e+04  3.14856628e+04  2.58e-02 6.97e-04  4.97e-02     3s
  30   2.37753732e+04  3.11073426e+04  2.24e-02 6.18e-04  4.36e-02     3s
  31   2.42460947e+04  3.09764615e+04  2.00e-02 5.91e-04  4.01e-02     3s
  32   2.46945638e+04  3.00695442e+04  1.77e-02 3.95e-04  3.20e-02     3s
  33   2.52781886e+04  2.97898560e+04  1.46e-02 3.34e-04  2.69e-02     3s
  34   2.57211355e+04  2.96582092e+04  1.24e-02 3.06e-04  2.34e-02     3s
  35   2.58544084e+04  2.94976278e+04  1.17e-02 2.72e-04  2.17e-02     3s
  36   2.65181688e+04  2.93627225e+04  8.44e-03 2.41e-04  1.69e-02     3s
  37   2.67340177e+04  2.90920168e+04  7.38e-03 1.84e-04  1.40e-02     3s
  38   2.72201572e+04  2.88359055e+04  4.95e-03 2.25e-04  9.62e-03     3s
  39   2.73977141e+04  2.87692318e+04  4.08e-03 1.97e-04  8.16e-03     3s
  40   2.77208984e+04  2.86432398e+04  2.57e-03 1.44e-04  5.49e-03     3s
  41   2.77921969e+04  2.85350645e+04  2.23e-03 9.92e-05  4.42e-03     3s
  42   2.79165661e+04  2.84866729e+04  1.64e-03 7.96e-05  3.39e-03     3s
  43   2.80553005e+04  2.84711612e+04  1.02e-03 7.28e-05  2.47e-03     3s
  44   2.80920042e+04  2.83502317e+04  8.55e-04 2.54e-05  1.54e-03     3s
  45   2.81275192e+04  2.83394463e+04  6.97e-04 2.10e-05  1.26e-03     3s
  46   2.81652199e+04  2.83290714e+04  5.31e-04 1.74e-05  9.75e-04     3s
  47   2.81998967e+04  2.83106521e+04  3.73e-04 9.58e-06  6.59e-04     3s
  48   2.82489266e+04  2.82977180e+04  1.53e-04 4.74e-06  2.90e-04     4s
  49   2.82695374e+04  2.82936073e+04  6.70e-05 3.15e-06  1.43e-04     4s
  50   2.82770697e+04  2.82901841e+04  3.57e-05 1.75e-06  7.80e-05     4s
  51   2.82823029e+04  2.82868492e+04  1.28e-05 4.56e-07  2.70e-05     4s
  52   2.82848694e+04  2.82862764e+04  2.90e-06 2.26e-07  8.36e-06     4s
  53   2.82856463e+04  2.82856653e+04  3.70e-08 3.67e-08  1.13e-07     4s
  54   2.82856607e+04  2.82856607e+04  9.25e-11 7.15e-12  3.89e-12     4s

Barrier solved model in 54 iterations and 3.70 seconds (8.15 work units)
Optimal objective 2.82856607e+04

Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 2.828566e+04, 29337 iterations, 3.12 seconds (7.36 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 28285.6607    0  201 -219438.19 28285.6607   113%     -    4s
H    0     0                    -144956.5267 28285.6607   120%     -    5s
H    0     0                    -144635.2655 28285.6607   120%     -    5s
H    0     0                    -144333.1579 28285.6607   120%     -    5s
H    0     0                    -144159.8149 28285.6607   120%     -    5s
H    0     0                    -137705.8795 28285.6607   121%     -    5s
H    0     0                    -57495.57274 28285.6607   149%     -    5s
H    0     0                    -24265.33678 28285.6607   217%     -    5s
H    0     0                    -10787.90524 28285.6607   362%     -    5s
H    0     0                    -10591.71192 28285.6607   367%     -    5s
H    0     0                    -9163.334059 28285.6607   409%     -    6s
H    0     0                    -2461.297270 22951.1692  1032%     -   21s
H    0     0                    -2394.142148 22951.1692  1059%     -   21s
H    0     0                    -2389.321439 22951.1692  1061%     -   21s
H    0     0                    -2266.520020 22951.1692  1113%     -   21s
     0     0 22761.4894    0  266 -2266.5200 22761.4894  1104%     -   21s
     0     0 22205.5421    0  344 -2266.5200 22205.5421  1080%     -   32s
H    0     0                    -1863.609896 22161.6592  1289%     -   37s
H    0     0                    -1600.214915 22161.6592  1485%     -   37s
H    0     0                    -1494.229531 22161.6592  1583%     -   37s
     0     0 21983.8265    0  351 -1494.2295 21983.8265  1571%     -   37s
     0     0 21983.8265    0  355 -1494.2295 21983.8265  1571%     -   38s
     0     0 21912.9458    0  346 -1494.2295 21912.9458  1567%     -   40s
     0     0 21907.7435    0  355 -1494.2295 21907.7435  1566%     -   42s
     0     0 21907.7435    0  357 -1494.2295 21907.7435  1566%     -   42s
     0     0 21907.7435    0  355 -1494.2295 21907.7435  1566%     -   42s
     0     0 21907.7435    0  355 -1494.2295 21907.7435  1566%     -   42s
     0     0 18752.3962    0  247 -1494.2295 18752.3962  1355%     -   64s
H    0     0                    -1129.332515 17907.4921  1686%     -   88s
H    0     0                    -1091.432085 17907.4921  1741%     -   88s
     0     0 17907.4921    0  247 -1091.4321 17907.4921  1741%     -   88s
     0     0 17554.0828    0  395 -1091.4321 17554.0828  1708%     -  106s
     0     0 17413.0691    0  389 -1091.4321 17413.0691  1695%     -  114s
     0     0 17066.7590    0  412 -1091.4321 17066.7590  1664%     -  121s
     0     0 17043.8164    0  405 -1091.4321 17043.8164  1662%     -  125s
     0     0 17033.0323    0  411 -1091.4321 17033.0323  1661%     -  127s
     0     0 17027.5635    0  408 -1091.4321 17027.5635  1660%     -  129s
     0     0 17012.2619    0  401 -1091.4321 17012.2619  1659%     -  131s
     0     0 17011.2545    0  397 -1091.4321 17011.2545  1659%     -  133s
     0     0 13552.0579    0  459 -1091.4321 13552.0579  1342%     -  178s
     0     0 13071.8356    0  460 -1091.4321 13071.8356  1298%     -  193s
     0     0 12949.7760    0  443 -1091.4321 12949.7760  1286%     -  199s
     0     0 12898.7378    0  470 -1091.4321 12898.7378  1282%     -  206s
     0     0 12872.8916    0  479 -1091.4321 12872.8916  1279%     -  209s
     0     0 12844.9085    0  482 -1091.4321 12844.9085  1277%     -  214s
     0     0 12823.4841    0  483 -1091.4321 12823.4841  1275%     -  217s
     0     0 12811.8626    0  478 -1091.4321 12811.8626  1274%     -  219s
     0     0 12805.5768    0  471 -1091.4321 12805.5768  1273%     -  221s
     0     0 12799.5227    0  479 -1091.4321 12799.5227  1273%     -  223s
     0     0 12797.6017    0  478 -1091.4321 12797.6017  1273%     -  224s
     0     0 11847.8527    0  504 -1091.4321 11847.8527  1186%     -  263s
     0     0 11406.7106    0  389 -1091.4321 11406.7106  1145%     -  280s
     0     0 11285.2121    0  536 -1091.4321 11285.2121  1134%     -  292s
     0     0 11195.4648    0  538 -1091.4321 11195.4648  1126%     -  300s
     0     0 11125.6412    0  547 -1091.4321 11125.6412  1119%     -  306s
     0     0 11089.9620    0  566 -1091.4321 11089.9620  1116%     -  312s
     0     0 11072.9765    0  619 -1091.4321 11072.9765  1115%     -  315s
     0     0 11064.2753    0  611 -1091.4321 11064.2753  1114%     -  317s
     0     0 11059.8926    0  622 -1091.4321 11059.8926  1113%     -  319s
     0     0 11057.2415    0  619 -1091.4321 11057.2415  1113%     -  320s
     0     0 11052.5915    0  617 -1091.4321 11052.5915  1113%     -  321s
     0     0 11052.1838    0  612 -1091.4321 11052.1838  1113%     -  322s
     0     0 10711.7152    0  526 -1091.4321 10711.7152  1081%     -  334s
H    0     0                    -1016.865555 10614.4839  1144%     -  340s
     0     0 10614.4839    0  491 -1016.8656 10614.4839  1144%     -  340s
     0     0 10552.5175    0  471 -1016.8656 10552.5175  1138%     -  346s
     0     0 10534.3911    0  549 -1016.8656 10534.3911  1136%     -  350s
     0     0 10502.9302    0  535 -1016.8656 10502.9302  1133%     -  353s
     0     0 10463.9435    0  479 -1016.8656 10463.9435  1129%     -  357s
     0     0 10460.3092    0  480 -1016.8656 10460.3092  1129%     -  358s
     0     0 10458.4416    0  483 -1016.8656 10458.4416  1128%     -  359s
     0     0 10344.1575    0  473 -1016.8656 10344.1575  1117%     -  368s
H    0     0                    -1013.971770 10344.0903  1120%     -  371s
     0     0 10323.0079    0  466 -1013.9718 10323.0079  1118%     -  376s
     0     0 10318.1752    0  475 -1013.9718 10318.1752  1118%     -  378s
     0     0 10308.9671    0  475 -1013.9718 10308.9671  1117%     -  380s
     0     0 10306.1982    0  476 -1013.9718 10306.1982  1116%     -  382s
     0     0 10305.6601    0  490 -1013.9718 10305.6601  1116%     -  382s
     0     0 10267.0335    0  591 -1013.9718 10267.0335  1113%     -  390s
     0     0 10256.8840    0  587 -1013.9718 10256.8840  1112%     -  395s
     0     0 10248.8360    0  526 -1013.9718 10248.8360  1111%     -  398s
     0     0 10245.9719    0  533 -1013.9718 10245.9719  1110%     -  400s
     0     0 10244.0388    0  524 -1013.9718 10244.0388  1110%     -  401s
     0     0 10211.7135    0  481 -1013.9718 10211.7135  1107%     -  408s
     0     0 10172.2386    0  527 -1013.9718 10172.2386  1103%     -  416s
     0     0 10159.0518    0  539 -1013.9718 10159.0518  1102%     -  420s
     0     0 10148.1657    0  489 -1013.9718 10148.1657  1101%     -  423s
     0     0 10144.4397    0  590 -1013.9718 10144.4397  1100%     -  426s
     0     0 10141.7726    0  596 -1013.9718 10141.7726  1100%     -  427s
     0     0 10117.1442    0  484 -1013.9718 10117.1442  1098%     -  432s
     0     0 10111.6415    0  486 -1013.9718 10111.6415  1097%     -  434s
     0     0 10100.3564    0  469 -1013.9718 10100.3564  1096%     -  437s
     0     0 10096.1985    0  480 -1013.9718 10096.1985  1096%     -  439s
     0     0 10095.2958    0  479 -1013.9718 10095.2958  1096%     -  441s
     0     0 10087.5034    0  594 -1013.9718 10087.5034  1095%     -  444s
     0     0 10085.5914    0  490 -1013.9718 10085.5914  1095%     -  446s
     0     0 10077.4434    0  483 -1013.9718 10077.4434  1094%     -  449s
     0     0 10076.1169    0  410 -1013.9718 10076.1169  1094%     -  450s
     0     0 10074.1860    0  409 -1013.9718 10074.1860  1094%     -  452s
     0     0 10073.3435    0  482 -1013.9718 10073.3435  1093%     -  454s
     0     0 10069.7466    0  486 -1013.9718 10069.7466  1093%     -  457s
     0     0 10068.8322    0  544 -1013.9718 10068.8322  1093%     -  459s
     0     0 10067.8202    0  484 -1013.9718 10067.8202  1093%     -  460s
     0     0 10067.7213    0  484 -1013.9718 10067.7213  1093%     -  462s
H    0     0                    -1012.874178 10067.6201  1094%     -  529s
H    0     0                    -998.8027460 10067.6201  1108%     -  545s
H    0     0                    -953.5648465 10067.6201  1156%     -  552s
H    0     0                    -939.1733757 10067.6201  1172%     -  552s
     0     2 10067.6201    0  484 -939.17338 10067.6201  1172%     -  567s
     1     4 10058.9374    1  472 -939.17338 10067.5879  1172%  2098  574s
     3     7 9887.52978    2  579 -939.17338 10058.8391  1171%  5995  585s
     6    14 9878.42478    3  591 -939.17338 9886.41154  1153%  7411  600s
    13    28 9661.74888    4  545 -939.17338 9877.88859  1152%  9065  612s
    27    42 8953.88656    5  517 -939.17338 9661.45103  1129% 12120  654s
    41    74 8815.08209    6  489 -939.17338 9661.45103  1129% 10731  733s
    73   163 8739.74797    7  467 -939.17338 9454.35916  1107% 11521  758s
   162   262 8681.46365   10  554 -939.17338 9453.15121  1107%  8596  776s
   263   348 8241.90532   14  558 -939.17338 9453.15121  1107%  6797  788s
   355   376 8217.64097   15  550 -939.17338 9453.15121  1107%  5863  810s
   385   423 8140.22159   16  557 -939.17338 9453.15121  1107%  5772  840s
   438   492 8044.29408   17  559 -939.17338 9453.15121  1107%  5532  866s
   514   557 7927.23981   18  556 -939.17338 9350.02792  1096%  5179  878s
   594   579 7820.65989   19  546 -939.17338 9350.02792  1096%  4825  890s
   626   597 7781.74632   20  497 -939.17338 9350.02792  1096%  4778  900s
   668   612 7737.10689   21  424 -939.17338 9350.02792  1096%  4736  912s
   705   627 7634.69918   22  431 -939.17338 9350.02792  1096%  4754  926s
   739   647 7557.58695   23  420 -939.17338 9350.02792  1096%  4767  937s
   788   672  278.27348   23  138 -939.17338 9350.02792  1096%  4824  949s
   841   695 4916.70041   24  398 -939.17338 9350.02792  1096%  4780  962s
   896   720 4890.86607   25  401 -939.17338 9350.02792  1096%  4720  975s
   943   743 4865.39874   26  334 -939.17338 9350.02792  1096%  4759  990s
   978   770 4828.57240   27  340 -939.17338 9350.02792  1096%  4892 1004s
  1015   807 4711.38478   28  314 -939.17338 9350.02792  1096%  4966 1016s
  1065   846 4463.22514   29  311 -939.17338 9350.02792  1096%  4960 1032s
  1122   888 4358.79428   30  306 -939.17338 9350.02792  1096%  4969 1044s
  1204   938 4149.13556   31  248 -939.17338 9350.02792  1096%  4864 1060s
  1298   993 4066.11957   32  247 -939.17338 9209.64831  1081%  4794 1077s
  1383  1073 3932.64687   33  258 -939.17338 9209.64831  1081%  4763 1095s
  1472  1159 3899.04939   34  306 -939.17338 9209.64831  1081%  4801 1109s
  1567  1234 3652.98507   35  277 -939.17338 9209.64831  1081%  4816 1125s
  1677  1317 3621.94962   36  223 -939.17338 9209.64831  1081%  4795 1143s
  1794  1430 2807.94454   37  244 -939.17338 9209.64831  1081%  4766 1162s
  1935  1559 2410.23616   38  384 -939.17338 9061.89527  1065%  4715 1180s
  2108  1633 2311.28145   39  412 -939.17338 8951.44525  1053%  4592 1200s
  2268  1711 1725.70609   40  378 -939.17338 8935.97058  1051%  4531 1221s
  2396  1824 1535.56036   41  420 -939.17338 8881.07287  1046%  4535 1242s
  2567  1961 1495.69606   42  332 -939.17338 8881.07287  1046%  4507 1261s
  2746  2128 1436.82271   43  420 -939.17338 8797.07023  1037%  4415 1281s
  2950  2219 1345.78881   44  402 -939.17338 8797.07023  1037%  4327 1303s
  3113  2318 1307.64882   45  322 -939.17338 8797.07023  1037%  4311 1326s
  3232  2413  992.15962   46  315 -939.17338 8795.66913  1037%  4350 1347s
  3367  2526  948.72487   47  295 -939.17338 8713.63593  1028%  4370 1366s
  3538  2727  857.29900   48  300 -939.17338 8685.50972  1025%  4355 1388s
  3798  2728 4767.35604   24  484 -939.17338 8685.50972  1025%  4251 1468s
  3800  2729 7398.20935    7  161 -939.17338 8685.50972  1025%  4249 1477s
  3801  2730 3935.36583   15  410 -939.17338 8685.50972  1025%  4248 1521s
  3802  2731 6662.18228   17  368 -939.17338 8685.50972  1025%  4247 1555s
  3803  2731 1189.07961   19  421 -939.17338 8685.50972  1025%  4246 1578s
  3804  2732 1464.40956   52  370 -939.17338 8685.50972  1025%  4245 1590s
  3805  2733 1930.15896   19  491 -939.17338 8685.50972  1025%  4243 1601s
  3806  2733 6069.37355   22  459 -939.17338 8685.50972  1025%  4242 1611s
  3807  2734 7300.23218   12  391 -939.17338 8685.50972  1025%  4241 1617s
  3808  2735 2460.07451   49  507 -939.17338 8685.50972  1025%  4240 1622s
  3809  2735  357.72991   68  505 -939.17338 8685.50972  1025%  4239 1627s
  3811  2737 2503.60321   25  487 -939.17338 8685.50972  1025%  4237 1631s
  3813  2738  478.66634   76  395 -939.17338 8685.50972  1025%  4235 1641s
  3815  2739 -169.93522   27  374 -939.17338 8685.50972  1025%  4232 1647s
  3816  2740 4864.31210   30  476 -939.17338 8685.50972  1025%  4231 1654s
  3817  2741  795.10899   51  470 -939.17338 8685.50972  1025%  4230 1657s
  3818  2741 3533.11364   36  511 -939.17338 8685.50972  1025%  4229 1660s
  3819  2742 2165.38624   18  510 -939.17338 8685.50972  1025%  4228 1666s
  3821  2743 6327.96670   20  306 -939.17338 8685.50972  1025%  4226 1671s
  3822  2744 3249.25201   38  558 -939.17338 8685.50972  1025%  4225 1677s
  3823  2745 3004.59754   42  549 -939.17338 8685.50972  1025%  4223 1680s
  3825  2746 3160.23688   16  434 -939.17338 8685.50972  1025%  4221 1690s
  3827  2747 7463.45366   16  506 -939.17338 8685.50972  1025%  4219 1697s
  3828  2748 1442.72953   33  565 -939.17338 8685.50972  1025%  4218 1701s
  3829  2749 1757.21102   46  553 -939.17338 8685.50972  1025%  4217 1709s
  3830  2749  210.44276   26  523 -939.17338 8685.50972  1025%  4216 1711s
  3832  2751 1273.68831   42  279 -939.17338 8685.50972  1025%  4214 1716s
  3834  2752 2360.94185   60  285 -939.17338 8685.50972  1025%  4211 1720s
  3835  2753 4262.78343   29  285 -939.17338 8685.50972  1025%  4210 1729s
  3836  2753 1421.93224   20  285 -939.17338 8685.50972  1025%  4209 1761s
  3837  2757 8685.50972   14  439 -939.17338 8685.50972  1025%  4282 1812s
  3839  2760 8685.50972   15  304 -939.17338 8685.50972  1025%  4282 1835s
  3843  2767 8685.50972   16  314 -939.17338 8685.50972  1025%  4285 1862s
  3851  2780 8685.50972   17  312 -939.17338 8685.50972  1025%  4306 1889s
  3867  2790 7445.84301   18  313 -939.17338 8685.50972  1025%  4345 1933s
  3883  2816 5051.63245   19  276 -939.17338 8685.50972  1025%  4434 1965s
  3915  2892 4643.48932   20  306 -939.17338 8685.50972  1025%  4461 2003s
  4019  2879 1723.67316   22  211 -939.17338 8685.50972  1025%  4540 2025s
  4050  2892 3501.92737   23  273 -939.17338 8685.50972  1025%  4540 2048s
  4091  2887  432.78534   23  215 -939.17338 8685.50972  1025%  4549 2069s
  4140  2880 -240.82317   25  214 -939.17338 8685.50972  1025%  4561 2089s
  4199  2891  979.83989   23  214 -939.17338 8685.50972  1025%  4565 2108s
  4266  2891 -669.39280   23  216 -939.17338 8685.50972  1025%  4586 2128s
  4331  2902 1349.22082   24  231 -939.17338 8685.50972  1025%  4603 2156s
  4391  2920 -205.71967   24  216 -939.17338 8685.50972  1025%  4628 2180s
  4470  2964 -238.15971   25  208 -939.17338 8685.50972  1025%  4657 2196s
  4566  2981     cutoff   29      -939.17338 8685.50972  1025%  4646 2214s
  4657  2967 4143.73147   29  468 -939.17338 8685.50972  1025%  4622 2240s
  4691  2975 3801.21925   30  436 -939.17338 8685.50972  1025%  4628 2252s
  4726  2971 3562.11081   31  359 -939.17338 8685.50972  1025%  4647 2269s
  4762  2968 3399.40125   32  353 -939.17338 8685.50972  1025%  4649 2293s
  4797  2971 2852.39285   33  369 -939.17338 8685.50972  1025%  4664 2311s
  4833  2977 2847.13172   34  362 -939.17338 8685.50972  1025%  4688 2328s
  4868  2982 2758.91684   35  305 -939.17338 8685.50972  1025%  4705 2347s
  4904  2971 2476.45579   36  273 -939.17338 8669.68015  1023%  4721 2366s
  4950  2970 2265.91315   37  277 -939.17338 8669.68015  1023%  4742 2392s
  4996  2981 1789.90523   38  332 -939.17338 8669.68015  1023%  4766 2413s
  5060  3000 1612.25823   39  356 -939.17338 8669.68015  1023%  4800 2447s
  5144  3003 1514.38615   40  352 -939.17338 8669.68015  1023%  4822 2471s
  5233  3005 1191.46945   41  336 -939.17338 8669.68015  1023%  4846 2496s
  5319  3010 1006.49872   43  281 -939.17338 7181.51466   865%  4865 2523s
  5425  3041  -73.36170   47  230 -939.17338 7181.51466   865%  4886 2549s
  5552  3038 infeasible   53      -939.17338 6600.77884   803%  4883 2583s
  5665  3048 4982.23637   19  328 -939.17338 6567.34408   799%  4905 2611s
  5762  3077 4644.09790   21  293 -939.17338 6567.34408   799%  4955 2642s
  5876  3112 -337.32775   23  251 -939.17338 6476.93686   790%  5011 2673s
  6016  3142 -596.86770   26  142 -939.17338 6476.93686   790%  5026 2703s
  6195  3138 infeasible   25      -939.17338 6270.95371   768%  5026 2739s
  6350  3139 4627.09737   21  380 -939.17338 5997.43970   739%  5053 2773s
  6487  3152 4438.11311   23  234 -939.17338 5958.04571   734%  5092 2813s
  6619  3208 3212.11377   27  336 -939.17338 5958.04571   734%  5133 2853s
  6789  3264 1552.56068   34  235 -939.17338 5589.23252   695%  5143 2886s
  6992  3274 -605.37441   50  198 -939.17338 5544.28648   690%  5152 2920s
  7177  3263 3612.34798   21  414 -939.17338 5544.28648   690%  5163 2954s
  7328  3241 3153.94600   23  283 -939.17338 5544.28648   690%  5209 2988s
  7434  3244 -741.19445   25   94 -939.17338 5465.49942   682%  5235 3022s
  7580  3261 2551.78185   26  336 -939.17338 5318.17517   666%  5284 3060s
  7744  3262 1798.49428   30  256 -939.17338 5318.17517   666%  5332 3097s
  7949  3247  826.12109   33  341 -939.17338 5168.54745   650%  5373 3137s
  8172  3243 infeasible   42      -939.17338 5126.59618   646%  5410 3179s
  8387  3248 2933.87228   22  513 -939.17338 5126.59618   646%  5458 3221s
  8614  3214 2098.76499   26  405 -939.17338 4892.34920   621%  5499 3267s
  8821  3239 1506.47671   29  296 -939.17338 4842.38860   616%  5549 3314s
  9069  3216  250.51595   33  338 -939.17338 4740.09723   605%  5598 3358s
  9306  3186 -125.01260   37  345 -939.17338 4684.88026   599%  5606 3413s
  9557  3116 infeasible   28      -939.17338 4594.49524   589%  5661 3457s
  9606  3108  598.23695   25  290 -939.17338 4518.67967   581%  5699 3501s
  9660  3108 -538.44714   26  196 -939.17338 4518.67967   581%  5722 3546s
  9709  3139 infeasible   27      -939.17338 4518.67967   581%  5739 3599s

Cutting planes:
  Gomory: 21
  Implied bound: 52
  Projected implied bound: 254
  MIR: 1438
  Mixing: 1
  Flow cover: 2490
  RLT: 57
  Relax-and-lift: 487

Explored 9877 nodes (57444702 simplex iterations) in 3600.02 seconds (9281.43 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -939.173 -953.565 -998.803 ... -1600.21

Time limit reached
Best objective -9.391733756636e+02, best bound 4.518679667168e+03, gap 581.1337%
  WARNING: Time limit reached. Using best solution found (gap: 581.13%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.05s
  Master Objective (UB) = -939.17, θ = 140396.14
  Upper Bound (UB) = -939.17

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 140396.14
  [DEBUG]   ✓ Scenario 0: θ = 140396.14 ≤ Q = 140396.14 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 140396.14 ≤ Q = 140396.14 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 140396.14 ≤ Q = 140396.14 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 140396.14 ≤ Q = 140396.14 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 140396.14 ≤ Q = 140396.14 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 140396.14 ≤ Q = 140396.14 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 140396.14 ≤ Q = 140396.14 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 140396.14 ≤ Q = 140396.14 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 140396.14 ≤ Q = 140396.14 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 140396.14 ≤ Q = 140396.14 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 140396.14 ≤ Q = 140396.14 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 11] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x45b887fb
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xba477805
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.158329e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.00s
Presolved: 494 rows, 498 columns, 1393 nonzeros
Found heuristic solution: objective 5745158.1683
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.306419e+05, 241 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -130641.93    0  123 5745158.17 -130641.93   102%     -    0s
H    0     0                    -98692.81857 -130641.93  32.4%     -    0s
H    0     0                    -99068.21013 -130641.93  31.9%     -    0s
     0     0 -112364.65    0  104 -99068.210 -112364.65  13.4%     -    0s
H    0     0                    -108502.7955 -112244.44  3.45%     -    0s
     0     0 -111457.72    0  105 -108502.80 -111457.72  2.72%     -    0s
H    0     0                    -109992.0721 -111446.87  1.32%     -    0s
     0     0 -110811.41    0   82 -109992.07 -110811.41  0.74%     -    0s
H    0     0                    -109995.2691 -110756.19  0.69%     -    0s
     0     0 -110634.68    0   92 -109995.27 -110634.68  0.58%     -    0s
     0     0 -110626.14    0   92 -109995.27 -110626.14  0.57%     -    0s
     0     0 -110465.25    0   16 -109995.27 -110465.25  0.43%     -    0s
H    0     0                    -110353.0227 -110452.01  0.09%     -    0s
H    0     0                    -110353.0832 -110452.01  0.09%     -    0s
     0     0 -110418.83    0   17 -110353.08 -110418.83  0.06%     -    0s
     0     0 -110409.10    0   11 -110353.08 -110409.10  0.05%     -    0s
     0     0 -110408.83    0   12 -110353.08 -110408.83  0.05%     -    0s
     0     0 -110400.04    0    7 -110353.08 -110400.04  0.04%     -    0s
     0     0 -110400.04    0   21 -110353.08 -110400.04  0.04%     -    0s
     0     0 -110400.04    0   18 -110353.08 -110400.04  0.04%     -    0s
     0     0 -110400.04    0   17 -110353.08 -110400.04  0.04%     -    0s
H    0     0                    -110374.0622 -110400.04  0.02%     -    0s
     0     0 -110391.25    0    2 -110374.06 -110391.25  0.02%     -    0s
     0     0 -110391.25    0    2 -110374.06 -110391.25  0.02%     -    0s
H    0     0                    -110391.1894 -110391.25  0.00%     -    0s

Explored 1 nodes (773 simplex iterations) in 0.14 seconds (0.05 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -110391 -110374 -110353 ... 5.74516e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.103911894226e+05, best bound -1.103912505654e+05, gap 0.0001%
  Subproblem solved in 0.16s
  Worst-case operational profit (Z_SP) = 131069.23
  Scenario: 30 demand increases, 30 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -110391.19
  [DEBUG]   S×d_nominal = 241460.42
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 241460.42 + -110391.19 = 131069.23
  [DEBUG]   Current θ from Master = 140396.14
  [DEBUG]   ⚠️  Z_SP ≤ θ by 9326.91 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -10266.08
  Lower Bound (LB) = -1589.09
  Gap (UB-LB) = 649.9158, Absolute Gap = 649.9158, Relative Gap = 0.692008
  Not converged yet (gap = 649.92 > ε = 200)

  [DEBUG] Adding NEW scenario 11 to Master Problem...
  [DEBUG] New scenario pattern: 30 increases, 30 decreases
    [DEBUG] Scenario 11 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 11 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 11]
    [DEBUG]   - Total constraints in model: 184863
    [DEBUG]   - Total variables in model: 77140
  [DEBUG] Total scenarios in Master: 12
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 12
================================================================================
[Iteration 12] Solving Master Problem...
  Current scenarios in Master: 12
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 184863 rows, 77140 columns and 524291 nonzeros
Model fingerprint: 0x9f960589
Variable types: 74881 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 84840 rows and 34440 columns
Presolve time: 1.29s
Presolved: 100023 rows, 42700 columns, 606239 nonzeros
Variable types: 40441 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -380749.0061
Found heuristic solution: objective -219438.1934

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.18s

Barrier statistics:
 Dense cols : 593
 AA' NZ     : 3.769e+06
 Factor NZ  : 8.671e+06 (roughly 130 MB of memory)
 Factor Ops : 1.595e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.59836023e+07  1.69285839e+08  8.90e+04 2.13e+01  6.97e+04     2s
   1  -1.22133277e+07  1.48801938e+08  6.25e+04 6.50e+01  4.83e+04     2s
   2  -6.00541318e+06  1.16519888e+08  2.94e+04 4.29e-01  2.37e+04     2s
   3  -8.91336346e+05  8.62606076e+07  2.12e+03 7.67e-01  2.09e+03     2s
   4  -4.91865420e+05  2.53790821e+07  3.96e+02 7.94e-02  3.99e+02     2s
   5  -3.69655816e+05  1.73560018e+07  1.43e+02 4.66e-02  1.82e+02     2s
   6  -2.65701189e+05  1.28723300e+07  7.87e+01 3.17e-02  1.14e+02     3s
   7  -1.57807129e+05  1.01610771e+07  3.18e+01 2.36e-02  7.11e+01     3s
   8  -1.13851752e+05  6.03860819e+06  1.62e+01 1.21e-02  3.89e+01     3s
   9  -9.49556125e+04  3.81481208e+06  1.03e+01 7.36e-03  2.37e+01     3s
  10  -7.04332968e+04  1.51530174e+06  5.42e+00 2.62e-03  9.23e+00     3s
  11  -3.71755333e+04  5.01467335e+05  2.14e+00 8.37e-04  3.03e+00     3s
  12  -2.62092338e+04  2.66042443e+05  1.51e+00 1.02e-03  1.63e+00     3s
  13  -1.70328258e+04  1.94440470e+05  9.66e-01 7.97e-04  1.17e+00     3s
  14  -1.66259098e+04  1.39518668e+05  9.45e-01 6.10e-04  8.65e-01     3s
  15  -1.22721004e+04  1.18429904e+05  7.84e-01 7.79e-04  7.23e-01     3s
  16  -5.19401866e+03  8.18659896e+04  5.76e-01 1.36e-03  4.80e-01     3s
  17   6.37991723e+02  6.38104374e+04  4.51e-01 1.43e-03  3.48e-01     3s
  18   5.48906501e+03  5.24461382e+04  3.60e-01 1.19e-03  2.59e-01     3s
  19   9.77541752e+03  4.69278448e+04  2.79e-01 1.31e-03  2.05e-01     3s
  20   1.30762859e+04  4.27563862e+04  2.23e-01 1.54e-03  1.63e-01     3s
  21   1.47838116e+04  3.94891989e+04  1.94e-01 1.62e-03  1.36e-01     3s
  22   1.72644833e+04  3.72869917e+04  1.55e-01 1.50e-03  1.10e-01     3s
  23   1.90176187e+04  3.45366848e+04  1.28e-01 1.12e-03  8.54e-02     3s
  24   2.01260809e+04  3.33842065e+04  1.11e-01 1.07e-03  7.30e-02     3s
  25   2.11521533e+04  3.26776746e+04  9.57e-02 1.32e-03  6.34e-02     3s
  26   2.25166248e+04  3.17962433e+04  7.61e-02 1.17e-03  5.11e-02     3s
  27   2.33590334e+04  3.10775425e+04  6.42e-02 1.07e-03  4.25e-02     3s
  28   2.41420301e+04  3.08816418e+04  5.36e-02 9.62e-04  3.71e-02     3s
  29   2.48281048e+04  3.01434332e+04  4.44e-02 1.06e-03  2.92e-02     3s
  30   2.54594056e+04  2.96683352e+04  3.53e-02 1.32e-03  2.32e-02     3s
  31   2.60516823e+04  2.93017118e+04  2.73e-02 8.43e-04  1.79e-02     3s
  32   2.65104717e+04  2.92207714e+04  2.17e-02 8.44e-04  1.49e-02     3s
  33   2.66269846e+04  2.90705481e+04  2.02e-02 6.16e-04  1.34e-02     3s
  34   2.66977443e+04  2.89696489e+04  1.93e-02 6.37e-04  1.25e-02     3s
  35   2.70287998e+04  2.86902720e+04  1.51e-02 6.65e-04  9.14e-03     3s
  36   2.73892319e+04  2.85944356e+04  1.07e-02 9.78e-04  6.63e-03     3s
  37   2.75816619e+04  2.85656608e+04  8.33e-03 8.82e-04  5.41e-03     3s
  38   2.76248946e+04  2.85524522e+04  7.80e-03 8.43e-04  5.10e-03     3s
  39   2.78093627e+04  2.85099352e+04  5.60e-03 6.99e-04  3.85e-03     3s
  40   2.78769910e+04  2.84841322e+04  4.77e-03 6.20e-04  3.34e-03     4s
  41   2.79094311e+04  2.84237604e+04  4.39e-03 5.00e-04  2.83e-03     4s
  42   2.79909989e+04  2.84116816e+04  3.42e-03 4.59e-04  2.31e-03     4s
  43   2.80986911e+04  2.83721642e+04  2.17e-03 3.17e-04  1.50e-03     4s
  44   2.81259590e+04  2.83418625e+04  1.85e-03 2.09e-04  1.19e-03     4s
  45   2.81589233e+04  2.83302939e+04  1.46e-03 1.89e-04  9.42e-04     4s
  46   2.81807657e+04  2.83145481e+04  1.19e-03 1.21e-04  7.36e-04     4s
  47   2.81959269e+04  2.83110423e+04  1.02e-03 1.07e-04  6.33e-04     4s
  48   2.82182303e+04  2.83014437e+04  7.59e-04 6.76e-05  4.58e-04     4s
  49   2.82269474e+04  2.82972234e+04  6.58e-04 4.93e-05  3.87e-04     4s
  50   2.82408630e+04  2.82959811e+04  4.96e-04 4.35e-05  3.03e-04     4s
  51   2.82701146e+04  2.82888454e+04  1.62e-04 3.65e-05  1.03e-04     4s
  52   2.82849240e+04  2.82860752e+04  4.12e-06 8.41e-06  6.30e-06     4s
  53   2.82856582e+04  2.82856616e+04  7.27e-09 5.95e-08  1.86e-08     4s
  54   2.82856607e+04  2.82856607e+04  3.18e-09 1.04e-11  7.88e-11     4s

Barrier solved model in 54 iterations and 3.96 seconds (8.80 work units)
Optimal objective 2.82856607e+04


Root crossover log...

    2266 PPushes remaining with PInf 9.0533419e-06                 5s
       0 PPushes remaining with PInf 0.0000000e+00                 5s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.4538992e-01      5s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   35897    2.8285661e+04   0.000000e+00   1.453899e-01      5s
   35900    2.8285661e+04   0.000000e+00   0.000000e+00      5s
   35900    2.8285661e+04   0.000000e+00   0.000000e+00      5s
Concurrent spin time: 0.35s

Solved with barrier

Root relaxation: objective 2.828566e+04, 35900 iterations, 3.71 seconds (8.62 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 28285.6607    0  201 -219438.19 28285.6607   113%     -    5s
H    0     0                    -215057.9572 28285.6607   113%     -    5s
H    0     0                    -192054.0839 28285.6607   115%     -    5s
H    0     0                    -164791.5975 28285.6607   117%     -    5s
H    0     0                    -131221.4886 28285.6607   122%     -    5s
H    0     0                    -130704.9238 28285.6607   122%     -    5s
H    0     0                    -114844.6274 28285.6607   125%     -    5s
H    0     0                    -57495.57274 28285.6607   149%     -    6s
H    0     0                    -23953.93925 28285.6607   218%     -    6s
H    0     0                    -20302.23914 28285.6607   239%     -    6s
H    0     0                    -10787.90524 28285.6607   362%     -    6s
H    0     0                    -10591.71192 28285.6607   367%     -    6s
H    0     0                    -3224.041059 28285.6607   977%     -    7s
H    0     0                    -2927.961637 28285.6607  1066%     -    7s
H    0     0                    -1350.627446 28285.6607  2194%     -    7s
     0     0 23184.9907    0  266 -1350.6274 23184.9907  1817%     -   25s
H    0     0                    -1309.833231 23184.5510  1870%     -   25s
     0     0 22288.2943    0  299 -1309.8332 22288.2943  1802%     -   36s
     0     0 22242.0249    0  304 -1309.8332 22242.0249  1798%     -   43s
     0     0 22242.0249    0  309 -1309.8332 22242.0249  1798%     -   47s
     0     0 22242.0249    0  309 -1309.8332 22242.0249  1798%     -   47s
     0     0 22180.6019    0  306 -1309.8332 22180.6019  1793%     -   51s
     0     0 22177.9534    0  307 -1309.8332 22177.9534  1793%     -   52s
     0     0 22177.6835    0  309 -1309.8332 22177.6835  1793%     -   52s
     0     0 18322.7518    0  346 -1309.8332 18322.7518  1499%     -   92s
     0     0 17617.2605    0  347 -1309.8332 17617.2605  1445%     -  114s
     0     0 17181.4520    0  291 -1309.8332 17181.4520  1412%     -  131s
     0     0 16967.0184    0  394 -1309.8332 16967.0184  1395%     -  142s
H    0     0                    -1213.408185 16956.1102  1497%     -  144s
     0     0 16956.1102    0  385 -1213.4082 16956.1102  1497%     -  144s
     0     0 16937.3339    0  388 -1213.4082 16937.3339  1496%     -  147s
     0     0 16933.0463    0  387 -1213.4082 16933.0463  1495%     -  149s
     0     0 16931.7713    0  388 -1213.4082 16931.7713  1495%     -  150s
     0     0 14011.2301    0  380 -1213.4082 14011.2301  1255%     -  190s
     0     0 13540.5729    0  402 -1213.4082 13540.5729  1216%     -  211s
H    0     0                    -1146.937067 13314.1392  1261%     -  226s
H    0     0                    -1055.117552 13314.1392  1362%     -  226s
H    0     0                    -1013.971770 13314.1392  1413%     -  226s
     0     0 13314.1392    0  504 -1013.9718 13314.1392  1413%     -  226s
     0     0 13238.9558    0  461 -1013.9718 13238.9558  1406%     -  236s
     0     0 13141.8538    0  430 -1013.9718 13141.8538  1396%     -  244s
     0     0 13122.0697    0  417 -1013.9718 13122.0697  1394%     -  250s
     0     0 13108.6739    0  488 -1013.9718 13108.6739  1393%     -  254s
     0     0 13106.3492    0  476 -1013.9718 13106.3492  1393%     -  255s
     0     0 13078.7091    0  408 -1013.9718 13078.7091  1390%     -  259s
     0     0 13059.7274    0  467 -1013.9718 13059.7274  1388%     -  264s
     0     0 13053.6409    0  475 -1013.9718 13053.6409  1387%     -  266s
     0     0 13050.5865    0  475 -1013.9718 13050.5865  1387%     -  268s
     0     0 13048.4913    0  474 -1013.9718 13048.4913  1387%     -  270s
     0     0 13048.2499    0  474 -1013.9718 13048.2499  1387%     -  270s
     0     0 11731.0053    0  496 -1013.9718 11731.0053  1257%     -  316s
     0     0 11303.3138    0  512 -1013.9718 11303.3138  1215%     -  334s
     0     0 11103.9902    0  544 -1013.9718 11103.9902  1195%     -  346s
     0     0 11050.7614    0  543 -1013.9718 11050.7614  1190%     -  352s
     0     0 11013.8051    0  539 -1013.9718 11013.8051  1186%     -  358s
     0     0 10983.1118    0  542 -1013.9718 10983.1118  1183%     -  363s
     0     0 10963.4885    0  559 -1013.9718 10963.4885  1181%     -  368s
     0     0 10955.9481    0  558 -1013.9718 10955.9481  1180%     -  370s
     0     0 10946.6230    0  556 -1013.9718 10946.6230  1180%     -  373s
     0     0 10925.1584    0  553 -1013.9718 10925.1584  1177%     -  377s
     0     0 10918.8564    0  557 -1013.9718 10918.8564  1177%     -  380s
     0     0 10915.1744    0  555 -1013.9718 10915.1744  1176%     -  381s
     0     0 10914.4906    0  565 -1013.9718 10914.4906  1176%     -  383s
     0     0 10622.4272    0  596 -1013.9718 10622.4272  1148%     -  399s
     0     0 10583.4781    0  461 -1013.9718 10583.4781  1144%     -  407s
     0     0 10546.5555    0  476 -1013.9718 10546.5555  1140%     -  413s
     0     0 10538.6625    0  581 -1013.9718 10538.6625  1139%     -  417s
     0     0 10498.8152    0  474 -1013.9718 10498.8152  1135%     -  421s
     0     0 10486.9046    0  599 -1013.9718 10486.9046  1134%     -  425s
     0     0 10482.9285    0  584 -1013.9718 10482.9285  1134%     -  427s
     0     0 10481.4588    0  590 -1013.9718 10481.4588  1134%     -  428s
     0     0 10379.1670    0  464 -1013.9718 10379.1670  1124%     -  436s
     0     0 10346.4462    0  518 -1013.9718 10346.4462  1120%     -  445s
     0     0 10327.1834    0  459 -1013.9718 10327.1834  1118%     -  449s
     0     0 10323.1141    0  468 -1013.9718 10323.1141  1118%     -  451s
     0     0 10318.0015    0  488 -1013.9718 10318.0015  1118%     -  453s
     0     0 10311.8907    0  466 -1013.9718 10311.8907  1117%     -  454s
     0     0 10301.0503    0  452 -1013.9718 10301.0503  1116%     -  457s
     0     0 10294.7799    0  500 -1013.9718 10294.7799  1115%     -  460s
     0     0 10290.6666    0  498 -1013.9718 10290.6666  1115%     -  462s
     0     0 10289.3524    0  522 -1013.9718 10289.3524  1115%     -  464s
     0     0 10203.7630    0  575 -1013.9718 10203.7630  1106%     -  470s
     0     0 10178.0718    0  567 -1013.9718 10178.0718  1104%     -  476s
     0     0 10167.6893    0  628 -1013.9718 10167.6893  1103%     -  480s
     0     0 10157.5282    0  621 -1013.9718 10157.5282  1102%     -  482s
     0     0 10154.4352    0  629 -1013.9718 10154.4352  1101%     -  484s
     0     0 10152.4234    0  479 -1013.9718 10152.4234  1101%     -  486s
     0     0 10124.1680    0  659 -1013.9718 10124.1680  1098%     -  491s
     0     0 10117.6047    0  455 -1013.9718 10117.6047  1098%     -  501s
     0     0 10109.4308    0  451 -1013.9718 10109.4308  1097%     -  503s
     0     0 10108.5656    0  458 -1013.9718 10108.5656  1097%     -  504s
     0     0 10105.5892    0  572 -1013.9718 10105.5892  1097%     -  506s
     0     0 10103.5217    0  447 -1013.9718 10103.5217  1096%     -  508s
     0     0 10099.0821    0  455 -1013.9718 10099.0821  1096%     -  511s
     0     0 10097.1531    0  604 -1013.9718 10097.1531  1096%     -  515s
     0     0 10090.8706    0  459 -1013.9718 10090.8706  1095%     -  519s
     0     0 10088.1873    0  462 -1013.9718 10088.1873  1095%     -  521s
     0     0 10079.7751    0  476 -1013.9718 10079.7751  1094%     -  524s
     0     0 10078.8153    0  476 -1013.9718 10078.8153  1094%     -  525s
     0     2 10078.8153    0  476 -1013.9718 10078.8153  1094%     -  616s
     1     4 10020.0594    1  451 -1013.9718 10075.7304  1094%  5758  629s
     3     8 9950.08210    2  495 -1013.9718 10020.0424  1088%  9398  650s
     7    16 9717.58209    3  336 -1013.9718 9950.06105  1081% 13964  671s
    15    32 9451.47357    4  416 -1013.9718 9717.54055  1058% 13736  692s
    31    49 3364.22813    5  236 -1013.9718 9451.44581  1032% 18743  762s
    48    81 6950.68566    6  302 -1013.9718 9451.02222  1032% 18976  789s
    80   148 6604.89004    7  282 -1013.9718 9451.02222  1032% 15438  822s
   149   218 6313.84299    9  278 -1013.9718 9451.02222  1032% 11664  849s
   225   299 2955.21687   11  232 -1013.9718 9451.02222  1032%  9380  871s
   310   362 1877.95487   13  209 -1013.9718 9451.02222  1032%  8597  886s
   404   411 1590.54217   16  202 -1013.9718 9451.02222  1032%  7527  902s
   485   433 3741.64955   10  229 -1013.9718 9451.02222  1032%  6854  914s
   517   454 3444.86177   10  276 -1013.9718 9451.02222  1032%  6754  929s
   554   479 3136.90530   11  231 -1013.9718 9451.02222  1032%  6597  944s
   612   502 2666.12322   11  317 -1013.9718 9451.02222  1032%  6346  965s
   649   533 3147.85112   11  218 -1013.9718 9451.02222  1032%  6330 1006s
   698   564 2651.64538   11  343 -1013.9718 9451.02222  1032%  6264 1023s
   760   587 2878.52270   12  201 -1013.9718 9451.02222  1032%  6143 1037s
   821   613  360.65941   12  214 -1013.9718 9451.02222  1032%  5990 1051s
   887   645 2445.60181   12  364 -1013.9718 9451.02222  1032%  5878 1066s
   949   703 2244.69999   12  338 -1013.9718 9451.02222  1032%  5798 1081s
H  970   703                    -892.1966377 9451.02222  1159%  5733 1081s
  1029   759 1150.48293   22  141 -892.19664 9451.02222  1159%  5639 1099s
  1153   798  184.34038   13  183 -892.19664 9451.02222  1159%  5391 1116s
  1272   825 infeasible   13      -892.19664 9451.02222  1159%  5223 1134s
  1381   841 4538.76447   11  292 -892.19664 9451.02222  1159%  5126 1154s
  1463   864 2187.74999   12  231 -892.19664 9451.02222  1159%  5131 1175s
  1514   910  550.58750   14  215 -892.19664 9451.02222  1159%  5275 1198s
  1564   969 infeasible   17      -892.19664 9451.02222  1159%  5462 1219s
  1647  1044     cutoff   16      -892.19664 9451.02222  1159%  5592 1240s
  1740  1126 infeasible   18      -892.19664 9451.02222  1159%  5675 1263s
  1848  1203 infeasible   44      -892.19664 9451.02222  1159%  5722 1286s
  1979  1263 4859.29297   19  595 -892.19664 9451.02222  1159%  5701 1308s
  2065  1343 4732.01388   20  578 -892.19664 9451.02222  1159%  5755 1332s
  2181  1407 4624.20672   23  522 -892.19664 9451.02222  1159%  5831 1359s
  2327  1491 4596.70198   24  561 -892.19664 9451.02222  1159%  5799 1386s
  2477  1551 4541.12454   24  517 -892.19664 9451.02222  1159%  5799 1411s
  2557  1645 4203.02238   25  496 -892.19664 9451.02222  1159%  5804 1436s
  2715  1686 4547.95349   24  507 -892.19664 9451.02222  1159%  5724 1465s
  2842  1776 4090.67011   26  483 -892.19664 9451.02222  1159%  5693 1495s
  2952  1846 3285.64892   26  213 -892.19664 9451.02222  1159%  5722 1525s
  3059  1899 4087.58867   26  509 -892.19664 9451.02222  1159%  5772 1557s
  3158  1982 4064.35715   27  492 -892.19664 9089.59007  1119%  5826 1589s
  3271  2125 2866.87170   28  209 -892.19664 9089.59007  1119%  5890 1626s
  3446  2264 3613.98397   31  413 -892.19664 9089.59007  1119%  5787 1658s
  3652  2265 2424.81492   44  476 -892.19664 8673.08002  1072%  5708 1813s
  3654  2266  -78.32243   14  157 -892.19664 8673.08002  1072%  5705 1822s
  3655  2267 5679.54879   17  397 -892.19664 8673.08002  1072%  5703 1867s
  3656  2268  274.70985   70  378 -892.19664 8673.08002  1072%  5702 1912s
  3657  2268 -512.05119   24  396 -892.19664 8673.08002  1072%  5700 1933s
  3658  2269 2620.67098   13  471 -892.19664 8673.08002  1072%  5698 1950s
  3659  2270 2958.14912   36  461 -892.19664 8673.08002  1072%  5697 1961s
  3660  2270 5985.33183   17  506 -892.19664 8673.08002  1072%  5695 1976s
  3661  2271 7481.03606    8  423 -892.19664 8673.08002  1072%  5694 1982s
  3662  2272 1522.30165   50  433 -892.19664 8673.08002  1072%  5692 1988s
  3663  2272 2793.78573   29  422 -892.19664 8673.08002  1072%  5691 1996s
  3665  2274 7571.19314    8  479 -892.19664 8673.08002  1072%  5688 2002s
  3667  2275 6829.86099    8  454 -892.19664 8673.08002  1072%  5684 2007s
  3668  2276 6526.02199   11  463 -892.19664 8673.08002  1072%  5683 2019s
  3669  2276 1220.48496   58  304 -892.19664 8673.08002  1072%  5681 2021s
  3671  2278 -369.98654   70  357 -892.19664 8673.08002  1072%  5678 2031s
  3673  2279 5925.56077   10  298 -892.19664 8673.08002  1072%  5675 2037s
  3674  2280 3670.97842   30  462 -892.19664 8673.08002  1072%  5674 2041s
  3675  2280  223.07646   77  507 -892.19664 8673.08002  1072%  5672 2048s
  3676  2281 3360.91493    6  502 -892.19664 8673.08002  1072%  5670 2050s
  3678  2282 3634.30872   31  367 -892.19664 8673.08002  1072%  5667 2056s
  3679  2283 5822.80080   16  451 -892.19664 8673.08002  1072%  5666 2061s
  3681  2284 3704.43682   24  290 -892.19664 8673.08002  1072%  5663 2069s
  3682  2285 7276.52833   11  454 -892.19664 8673.08002  1072%  5661 2072s
  3683  2286 3830.45825   12  480 -892.19664 8673.08002  1072%  5660 2075s
  3686  2288 3119.34800   32  285 -892.19664 8673.08002  1072%  5655 2082s
  3688  2289 3904.75315    9  285 -892.19664 8673.08002  1072%  5652 2086s
  3689  2290 1674.34066   10  285 -892.19664 8673.08002  1072%  5651 2099s
  3690  2290 5190.37125   24  285 -892.19664 8673.08002  1072%  5649 2135s
  3691  2293 8365.60507   15  263 -892.19664 8673.08002  1072%  5728 2148s
  3692  2296 7826.68415   16  242 -892.19664 8673.08002  1072%  5728 2166s
  3695  2301 7601.14406   17  243 -892.19664 8673.08002  1072%  5727 2196s
  3701  2311 6528.47317   18  260 -892.19664 8673.08002  1072%  5737 2221s
  3713  2319 8170.06673   18  441 -892.19664 8673.08002  1072%  5787 2281s
  3725  2346 7723.76786   19  507 -892.19664 8673.08002  1072%  5804 2371s
  3756  2423 7425.47979   20  493 -892.19664 8165.78692  1015%  5954 2422s
  3846  2443 7041.03024   23  459 -892.19664 8146.63389  1013%  6013 2450s
  3930  2442 4576.09794   24  372 -892.19664 8146.63389  1013%  6054 2481s
  4005  2420 4878.30331   23  259 -892.19664 8146.63389  1013%  6080 2511s
  4064  2417 3390.85012   25  412 -892.19664 8146.63389  1013%  6135 2534s
  4115  2415 5376.06816   24  378 -892.19664 8146.63389  1013%  6176 2563s
  4142  2432 6445.96396   24  395 -892.19664 8146.63389  1013%  6201 2589s
  4187  2437 6131.35126   25  446 -892.19664 8146.63389  1013%  6250 2617s
  4235  2441 5455.31481   26  444 -892.19664 8146.63389  1013%  6281 2647s
  4299  2449 5436.89677   27  296 -892.19664 8146.63389  1013%  6316 2669s
  4365  2452 5286.46067   28  434 -892.19664 8146.63389  1013%  6354 2699s
  4423  2457 3821.87714   29  202 -892.19664 8146.63389  1013%  6378 2716s
  4472  2460  316.20898   28  146 -892.19664 8146.63389  1013%  6384 2739s
  4547  2448 infeasible   29      -892.19664 8146.63389  1013%  6384 2778s
  4619  2464 3586.32655   28  177 -892.19664 8146.63389  1013%  6405 2800s
  4698  2454 1085.49986   29  156 -892.19664 8146.63389  1013%  6427 2820s
  4756  2468  919.69040   30  101 -892.19664 8146.63389  1013%  6424 2840s
  4832  2485  -18.80202   33  108 -892.19664 8146.63389  1013%  6440 2865s
  4919  2483 infeasible   36      -892.19664 8146.63389  1013%  6432 2889s
  5014  2488 3485.45319   24  335 -892.19664 8146.63389  1013%  6449 2913s
  5096  2486 3446.37839   25  344 -892.19664 8146.63389  1013%  6448 2938s
  5183  2474 2649.99388   26  235 -892.19664 6880.95423   871%  6463 2967s
  5269  2466 -389.46916   31  147 -892.19664 6754.82548   857%  6480 2996s
  5348  2466 -439.50140   31  174 -892.19664 6754.82548   857%  6499 3051s
  5444  2481     cutoff   34      -892.19664 6754.82548   857%  6533 3080s
  5526  2481     cutoff   26      -892.19664 6754.82548   857%  6602 3107s
  5593  2497 -333.19234   26  379 -892.19664 6531.13927   832%  6644 3144s
  5677  2531     cutoff   27      -892.19664 6237.81117   799%  6681 3175s
  5800  2518 3552.49424   27  239 -892.19664 6237.81117   799%  6698 3216s
  5887  2559 2382.01853   28  385 -892.19664 6237.81117   799%  6719 3255s
  6000  2556     cutoff   32      -892.19664 6237.81117   799%  6736 3288s
  6121  2554     cutoff   34      -892.19664 5737.62466   743%  6777 3332s
  6230  2583 infeasible   35      -892.19664 5737.62466   743%  6821 3370s
  6382  2548 3160.27671   26  387 -892.19664 5737.62466   743%  6848 3413s
  6514  2533 2057.69143   27  379 -892.19664 5643.97573   733%  6888 3457s
  6607  2538 1853.84123   29  310 -892.19664 5544.98032   721%  6954 3506s
  6726  2538 1230.19458   31  357 -892.19664 5544.98032   721%  6991 3547s
  6832  2553  339.10067   35  265 -892.19664 5544.98032   721%  7037 3591s
  6993  2509 -827.52365   42  210 -892.19664 5260.78887   690%  7094 3600s

Cutting planes:
  Learned: 1
  Gomory: 11
  Implied bound: 76
  Projected implied bound: 289
  MIR: 1446
  Mixing: 8
  Flow cover: 2419
  RLT: 66
  Relax-and-lift: 412

Explored 7020 nodes (50394481 simplex iterations) in 3600.07 seconds (8608.61 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -892.197 -1013.97 -1055.12 ... -10591.7

Time limit reached
Best objective -8.921966376769e+02, best bound 5.260788872367e+03, gap 689.6446%
  WARNING: Time limit reached. Using best solution found (gap: 689.64%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = -892.20, θ = 139375.24
  Upper Bound (UB) = -892.20

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 139375.24
  [DEBUG]   ✓ Scenario 0: θ = 139375.24 ≤ Q = 139375.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 139375.24 ≤ Q = 139375.24 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 139375.24 ≤ Q = 139375.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 139375.24 ≤ Q = 139375.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 139375.24 ≤ Q = 139375.24 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 139375.24 ≤ Q = 139375.24 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 139375.24 ≤ Q = 139375.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 139375.24 ≤ Q = 139375.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 139375.24 ≤ Q = 139375.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 139375.24 ≤ Q = 139375.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 139375.24 ≤ Q = 139375.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 139375.24 ≤ Q = 139375.24 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 12] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x7080967a
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x8f7f6986
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.144452e+13
Presolve removed 2600 rows and 1892 columns
Presolve time: 0.00s
Presolved: 493 rows, 497 columns, 1390 nonzeros
Found heuristic solution: objective 5683223.5700
Variable types: 337 continuous, 160 integer (160 binary)

Root relaxation: objective -1.320202e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -132020.21    0  127 5683223.57 -132020.21   102%     -    0s
H    0     0                    -98187.17448 -132020.21  34.5%     -    0s
H    0     0                    -98562.56604 -132020.21  33.9%     -    0s
     0     0 -110250.52    0   58 -98562.566 -110250.52  11.9%     -    0s
H    0     0                    -108033.0224 -110144.54  1.95%     -    0s
     0     0 -110144.54    0   53 -108033.02 -110144.54  1.95%     -    0s
H    0     0                    -109039.7741 -110144.54  1.01%     -    0s
     0     0 -109707.88    0   52 -109039.77 -109707.88  0.61%     -    0s
     0     0 -109625.08    0   36 -109039.77 -109625.08  0.54%     -    0s
H    0     0                    -109063.7602 -109625.08  0.51%     -    0s
     0     0 -109302.95    0   17 -109063.76 -109302.95  0.22%     -    0s
     0     0 -109288.48    0   14 -109063.76 -109288.48  0.21%     -    0s
H    0     0                    -109101.9256 -109264.40  0.15%     -    0s
     0     0 -109232.79    0   12 -109101.93 -109232.79  0.12%     -    0s
     0     0 -109232.57    0   13 -109101.93 -109232.57  0.12%     -    0s
     0     0 -109232.33    0   13 -109101.93 -109232.33  0.12%     -    0s
     0     0 -109192.61    0   16 -109101.93 -109192.61  0.08%     -    0s
     0     0 -109184.21    0    4 -109101.93 -109184.21  0.08%     -    0s
     0     0 -109142.84    0    3 -109101.93 -109142.84  0.04%     -    0s
     0     0 -109142.17    0   11 -109101.93 -109142.17  0.04%     -    0s
     0     0 -109140.15    0    9 -109101.93 -109140.15  0.04%     -    0s
     0     0 -109137.63    0    8 -109101.93 -109137.63  0.03%     -    0s
     0     0 -109115.42    0    2 -109101.93 -109115.42  0.01%     -    0s

Cutting planes:
  Gomory: 1
  Implied bound: 1
  MIR: 4
  Flow cover: 3
  RLT: 1
  Relax-and-lift: 1

Explored 1 nodes (605 simplex iterations) in 0.16 seconds (0.03 work units)
Thread count was 32 (of 256 available processors)

Solution count 7: -109102 -109064 -109040 ... 1.14445e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.091019256247e+05, best bound -1.091115304119e+05, gap 0.0088%
  Subproblem solved in 0.18s
  Worst-case operational profit (Z_SP) = 132358.49
  Scenario: 22 demand increases, 38 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -109101.93
  [DEBUG]   S×d_nominal = 241460.42
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 241460.42 + -109101.93 = 132358.49
  [DEBUG]   Current θ from Master = 139375.24
  [DEBUG]   ⚠️  Z_SP ≤ θ by 7016.75 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -7908.95
  Lower Bound (LB) = -1589.09
  Gap (UB-LB) = 696.8925, Absolute Gap = 696.8925, Relative Gap = 0.781097
  Not converged yet (gap = 696.89 > ε = 200)

  [DEBUG] Adding NEW scenario 12 to Master Problem...
  [DEBUG] New scenario pattern: 22 increases, 38 decreases
    [DEBUG] Scenario 12 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 12 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 12]
    [DEBUG]   - Total constraints in model: 200153
    [DEBUG]   - Total variables in model: 83380
  [DEBUG] Total scenarios in Master: 13
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 13
================================================================================
[Iteration 13] Solving Master Problem...
  Current scenarios in Master: 13
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 200153 rows, 83380 columns and 567522 nonzeros
Model fingerprint: 0x7d76660e
Variable types: 81121 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 91910 rows and 37310 columns
Presolve time: 1.46s
Presolved: 108243 rows, 46070 columns, 654063 nonzeros
Variable types: 43811 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -380201.4567
Found heuristic solution: objective -219438.1934

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.22s

Barrier statistics:
 Dense cols : 586
 AA' NZ     : 4.305e+06
 Factor NZ  : 1.075e+07 (roughly 150 MB of memory)
 Factor Ops : 3.110e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.60010211e+07  1.81132242e+08  8.91e+04 2.05e+01  6.93e+04     3s
   1  -1.22979410e+07  1.59606794e+08  6.26e+04 6.35e+01  4.81e+04     3s
   2  -6.23132047e+06  1.25411446e+08  3.04e+04 4.92e-01  2.44e+04     3s
   3  -9.16552896e+05  9.31615535e+07  2.22e+03 1.37e+00  2.16e+03     3s
   4  -4.91727289e+05  2.91720093e+07  3.80e+02 1.52e-01  3.97e+02     3s
   5  -4.05701072e+05  1.99863305e+07  1.93e+02 8.75e-02  2.19e+02     3s
   6  -3.21575606e+05  1.57973395e+07  9.98e+01 6.23e-02  1.37e+02     3s
   7  -2.09564799e+05  1.24737583e+07  4.39e+01 4.63e-02  8.59e+01     3s
   8  -1.51997804e+05  9.41890983e+06  2.26e+01 3.22e-02  5.77e+01     3s
   9  -1.20862269e+05  8.71107057e+06  1.54e+01 2.94e-02  5.06e+01     3s
  10  -9.84906405e+04  5.08307088e+06  7.22e+00 1.58e-02  2.80e+01     3s
  11  -6.32390823e+04  3.41103711e+06  1.61e+00 1.04e-02  1.78e+01     3s
  12  -3.86074433e+04  7.13301143e+05  4.33e-01 1.85e-03  3.81e+00     3s
  13  -2.68716246e+04  4.21941394e+05  3.11e-01 1.20e-03  2.27e+00     3s
  14  -1.84451038e+04  2.79803468e+05  2.00e-01 7.37e-04  1.51e+00     3s
  15  -1.43895885e+04  1.81524391e+05  1.60e-01 8.50e-04  9.90e-01     3s
  16  -1.14483429e+04  1.43681569e+05  1.39e-01 1.13e-03  7.84e-01     3s
  17  -7.63118012e+03  1.17038935e+05  1.12e-01 1.09e-03  6.30e-01     3s
  18  -2.79914659e+03  8.88560119e+04  8.95e-02 2.08e-03  4.63e-01     3s
  19   2.54552333e+03  6.85430519e+04  7.03e-02 1.97e-03  3.33e-01     3s
  20   8.11791682e+03  5.91830110e+04  5.30e-02 1.50e-03  2.58e-01     3s
  21   1.08705499e+04  5.02032941e+04  4.51e-02 1.92e-03  1.99e-01     4s
  22   1.29557757e+04  4.55451016e+04  3.90e-02 1.48e-03  1.65e-01     4s
  23   1.55290703e+04  4.22175315e+04  3.19e-02 1.20e-03  1.35e-01     4s
  24   1.70304551e+04  3.77592759e+04  2.80e-02 8.39e-04  1.05e-01     4s
  25   1.82723806e+04  3.52248880e+04  2.48e-02 6.31e-04  8.56e-02     4s
  26   1.96245992e+04  3.42206775e+04  2.14e-02 5.31e-04  7.37e-02     4s
  27   2.08594989e+04  3.34411805e+04  1.84e-02 4.62e-04  6.36e-02     4s
  28   2.11400386e+04  3.31080371e+04  1.77e-02 4.31e-04  6.05e-02     4s
  29   2.27520291e+04  3.23178866e+04  1.38e-02 3.56e-04  4.83e-02     4s
  30   2.32444439e+04  3.13104893e+04  1.27e-02 2.63e-04  4.07e-02     4s
  31   2.41601704e+04  3.09486627e+04  1.05e-02 2.28e-04  3.43e-02     4s
  32   2.48142044e+04  3.04371242e+04  9.01e-03 1.52e-04  2.84e-02     4s
  33   2.55916046e+04  3.01234016e+04  7.22e-03 1.20e-04  2.29e-02     4s
  34   2.61204711e+04  2.99522364e+04  6.09e-03 1.01e-04  1.94e-02     4s
  35   2.65404693e+04  2.95843609e+04  5.15e-03 2.06e-04  1.54e-02     4s
  36   2.68223457e+04  2.92948254e+04  4.53e-03 1.07e-04  1.25e-02     4s
  37   2.73797051e+04  2.92259393e+04  3.29e-03 8.68e-05  9.33e-03     4s
  38   2.74806899e+04  2.91748770e+04  3.08e-03 7.86e-05  8.56e-03     4s
  39   2.77852881e+04  2.90973253e+04  2.42e-03 5.29e-05  6.63e-03     4s
  40   2.80151219e+04  2.90762361e+04  1.93e-03 4.64e-05  5.36e-03     5s
  41   2.82094458e+04  2.90613854e+04  1.49e-03 4.21e-05  4.30e-03     5s
  42   2.83798835e+04  2.90093177e+04  1.12e-03 2.70e-05  3.18e-03     5s
  43   2.84690633e+04  2.89946612e+04  9.32e-04 2.22e-05  2.66e-03     5s
  44   2.85821851e+04  2.89652224e+04  6.93e-04 1.33e-05  1.94e-03     5s
  45   2.86553641e+04  2.89559887e+04  5.38e-04 1.42e-05  1.52e-03     5s
  46   2.86880052e+04  2.89500000e+04  4.69e-04 1.18e-05  1.32e-03     5s
  47   2.87384612e+04  2.89416078e+04  3.64e-04 8.03e-06  1.03e-03     5s
  48   2.87744368e+04  2.89397280e+04  2.95e-04 7.14e-06  8.35e-04     5s
  49   2.88045405e+04  2.89356347e+04  2.37e-04 5.38e-06  6.62e-04     5s
  50   2.88506099e+04  2.89325862e+04  1.41e-04 4.36e-06  4.14e-04     5s
  51   2.89123092e+04  2.89277793e+04  1.45e-05 2.33e-06  7.81e-05     5s
  52   2.89151419e+04  2.89229169e+04  9.62e-06 5.99e-07  3.93e-05     5s
  53   2.89182879e+04  2.89215696e+04  4.39e-06 1.93e-07  1.66e-05     5s
  54   2.89208675e+04  2.89209509e+04  9.06e-08 1.23e-09  4.21e-07     5s
  55   2.89209389e+04  2.89209389e+04  3.09e-11 1.85e-09  7.31e-12     5s

Barrier solved model in 55 iterations and 5.33 seconds (10.61 work units)
Optimal objective 2.89209389e+04


Root crossover log...

   92906 DPushes remaining with DInf 0.0000000e+00                 5s
       0 DPushes remaining with DInf 0.0000000e+00                 6s

    2034 PPushes remaining with PInf 6.3992824e-07                 6s
       0 PPushes remaining with PInf 0.0000000e+00                 6s

  Push phase complete: Pinf 0.0000000e+00, Dinf 6.1236634e-11      6s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   34007    2.8920939e+04   0.000000e+00   0.000000e+00      6s
   34007    2.8920939e+04   0.000000e+00   0.000000e+00      6s
Concurrent spin time: 0.54s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 2.892094e+04, 34007 iterations, 4.99 seconds (9.82 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 28920.9389    0  230 -219438.19 28920.9389   113%     -    7s
H    0     0                    -216907.2252 28920.9389   113%     -    7s
H    0     0                    -159065.3176 28920.9389   118%     -    7s
H    0     0                    -155562.4700 28920.9389   119%     -    7s
H    0     0                    -155217.4511 28920.9389   119%     -    7s
H    0     0                    -151878.9240 28920.9389   119%     -    7s
H    0     0                    -57843.21668 28920.9389   150%     -    7s
H    0     0                    -11880.86019 28920.9389   343%     -    7s
H    0     0                    -11555.45276 28920.9389   350%     -    8s
H    0     0                    -10142.67424 28920.9389   385%     -    8s
H    0     0                    -9960.102370 28920.9389   390%     -    9s
H    0     0                    -5654.298412 28920.9389   611%     -    9s
     0     0 23277.3427    0  361 -5654.2984 23277.3427   512%     -   26s
H    0     0                    -4513.590681 23276.6071   616%     -   26s
H    0     0                    -4459.785954 23276.6071   622%     -   26s
H    0     0                    -4216.663688 23276.6071   652%     -   26s
H    0     0                    -3995.148799 23276.6071   683%     -   26s
H    0     0                    -3844.395778 23276.6071   705%     -   26s
H    0     0                    -3687.912580 23276.6071   731%     -   26s
     0     0 22800.5543    0  301 -3687.9126 22800.5543   718%     -   36s
     0     0 22718.8121    0  304 -3687.9126 22718.8121   716%     -   40s
     0     0 22686.3638    0  312 -3687.9126 22686.3638   715%     -   44s
     0     0 22685.2259    0  312 -3687.9126 22685.2259   715%     -   45s
     0     0 22685.0419    0  312 -3687.9126 22685.0419   715%     -   45s
H    0     0                    -2939.957487 19347.7188   758%     -   79s
H    0     0                    -2862.058829 19347.7188   776%     -   79s
H    0     0                    -2846.230265 19347.7188   780%     -   79s
H    0     0                    -2727.339732 19347.7188   809%     -   79s
     0     0 19347.7188    0  400 -2727.3397 19347.7188   809%     -   79s
H    0     0                    -2176.493931 18607.8651   955%     -  102s
H    0     0                    -1774.602056 18607.8651  1149%     -  102s
H    0     0                    -1690.115668 18607.8651  1201%     -  102s
H    0     0                    -1493.505978 18607.8651  1346%     -  102s
H    0     0                    -1309.113118 18607.8651  1521%     -  102s
H    0     0                    -1292.811337 18607.8651  1539%     -  102s
H    0     0                    -1159.288701 18607.8651  1705%     -  102s
H    0     0                    -1119.254231 18607.8651  1763%     -  102s
H    0     0                    -1091.432085 18607.8651  1805%     -  102s
H    0     0                    -1016.865555 18607.8651  1930%     -  102s
     0     0 18607.8651    0  470 -1016.8656 18607.8651  1930%     -  102s
     0     0 18194.9649    0  386 -1016.8656 18194.9649  1889%     -  118s
     0     0 18023.2184    0  464 -1016.8656 18023.2184  1872%     -  128s
     0     0 17972.6111    0  478 -1016.8656 17972.6111  1867%     -  133s
     0     0 17957.4310    0  473 -1016.8656 17957.4310  1866%     -  138s
     0     0 17951.1968    0  468 -1016.8656 17951.1968  1865%     -  139s
     0     0 17947.3321    0  475 -1016.8656 17947.3321  1865%     -  141s
     0     0 17908.4711    0  474 -1016.8656 17908.4711  1861%     -  145s
     0     0 17897.4733    0  466 -1016.8656 17897.4733  1860%     -  147s
     0     0 17873.0720    0  448 -1016.8656 17873.0720  1858%     -  149s
     0     0 17860.9483    0  448 -1016.8656 17860.9483  1856%     -  150s
     0     0 17860.6856    0  456 -1016.8656 17860.6856  1856%     -  151s
     0     0 14569.5358    0  428 -1016.8656 14569.5358  1533%     -  195s
H    0     0                    -1013.971770 14569.3501  1537%     -  196s
     0     0 13932.2213    0  484 -1013.9718 13932.2213  1474%     -  233s
     0     0 13428.3107    0  407 -1013.9718 13428.3107  1424%     -  258s
     0     0 13199.0928    0  437 -1013.9718 13199.0928  1402%     -  267s
     0     0 13145.3856    0  448 -1013.9718 13145.3856  1396%     -  272s
     0     0 13131.9795    0  438 -1013.9718 13131.9795  1395%     -  275s
     0     0 13072.7759    0  443 -1013.9718 13072.7759  1389%     -  280s
     0     0 13056.9648    0  432 -1013.9718 13056.9648  1388%     -  283s
     0     0 13036.3716    0  445 -1013.9718 13036.3716  1386%     -  286s
     0     0 13033.4469    0  442 -1013.9718 13033.4469  1385%     -  288s
     0     0 13028.4525    0  453 -1013.9718 13028.4525  1385%     -  289s
     0     0 13025.4890    0  453 -1013.9718 13025.4890  1385%     -  290s
     0     0 13022.0789    0  455 -1013.9718 13022.0789  1384%     -  291s
     0     0 13016.4609    0  449 -1013.9718 13016.4609  1384%     -  292s
     0     0 13015.2959    0  447 -1013.9718 13015.2959  1384%     -  293s
     0     0 11678.0953    0  386 -1013.9718 11678.0953  1252%     -  335s
     0     0 11509.6556    0  381 -1013.9718 11509.6556  1235%     -  349s
     0     0 11310.0567    0  396 -1013.9718 11310.0567  1215%     -  362s
     0     0 11178.5113    0  396 -1013.9718 11178.5113  1202%     -  371s
     0     0 11097.9019    0  397 -1013.9718 11097.9019  1194%     -  382s
     0     0 11086.0319    0  393 -1013.9718 11086.0319  1193%     -  387s
     0     0 11079.7813    0  516 -1013.9718 11079.7813  1193%     -  392s
     0     0 11071.1960    0  391 -1013.9718 11071.1960  1192%     -  395s
     0     0 11062.6153    0  403 -1013.9718 11062.6153  1191%     -  398s
     0     0 11058.3150    0  399 -1013.9718 11058.3150  1191%     -  401s
     0     0 11056.1510    0  402 -1013.9718 11056.1510  1190%     -  402s
     0     0 10821.3190    0  561 -1013.9718 10821.3190  1167%     -  418s
     0     0 10712.9827    0  576 -1013.9718 10712.9827  1157%     -  434s
     0     0 10674.8082    0  583 -1013.9718 10674.8082  1153%     -  444s
     0     0 10650.7357    0  594 -1013.9718 10650.7357  1150%     -  453s
     0     0 10641.5579    0  602 -1013.9718 10641.5579  1149%     -  458s
     0     0 10638.4607    0  601 -1013.9718 10638.4607  1149%     -  461s
     0     0 10632.1343    0  593 -1013.9718 10632.1343  1149%     -  463s
     0     0 10631.3431    0  602 -1013.9718 10631.3431  1148%     -  464s
     0     0 10540.1821    0  429 -1013.9718 10540.1821  1139%     -  482s
     0     0 10514.5771    0  422 -1013.9718 10514.5771  1137%     -  490s
     0     0 10504.9699    0  425 -1013.9718 10504.9699  1136%     -  497s
     0     0 10496.8593    0  419 -1013.9718 10496.8593  1135%     -  501s
     0     0 10484.8383    0  604 -1013.9718 10484.8383  1134%     -  508s
     0     0 10481.2960    0  606 -1013.9718 10481.2960  1134%     -  509s
     0     0 10473.3274    0  610 -1013.9718 10473.3274  1133%     -  511s
     0     0 10471.8220    0  607 -1013.9718 10471.8220  1133%     -  512s
     0     0 10394.2637    0  445 -1013.9718 10394.2637  1125%     -  522s
     0     0 10383.7021    0  437 -1013.9718 10383.7021  1124%     -  525s
     0     0 10380.1571    0  598 -1013.9718 10380.1571  1124%     -  529s
     0     0 10375.6139    0  597 -1013.9718 10375.6139  1123%     -  531s
     0     0 10375.0485    0  606 -1013.9718 10375.0485  1123%     -  533s
     0     0 10316.2433    0  675 -1013.9718 10316.2433  1117%     -  542s
     0     0 10303.6320    0  631 -1013.9718 10303.6320  1116%     -  551s
     0     0 10293.1384    0  588 -1013.9718 10293.1384  1115%     -  553s
     0     0 10286.8966    0  621 -1013.9718 10286.8966  1115%     -  555s
     0     0 10284.6175    0  629 -1013.9718 10284.6175  1114%     -  557s
     0     0 10223.9441    0  612 -1013.9718 10223.9441  1108%     -  564s
     0     0 10209.0371    0  502 -1013.9718 10209.0371  1107%     -  567s
     0     0 10205.4246    0  567 -1013.9718 10205.4246  1106%     -  570s
     0     0 10203.5070    0  556 -1013.9718 10203.5070  1106%     -  571s
     0     0 10196.1540    0  499 -1013.9718 10196.1540  1106%     -  575s
     0     0 10191.5176    0  506 -1013.9718 10191.5176  1105%     -  582s
     0     0 10187.1008    0  503 -1013.9718 10187.1008  1105%     -  585s
     0     0 10185.6074    0  507 -1013.9718 10185.6074  1105%     -  586s
     0     0 10182.4047    0  511 -1013.9718 10182.4047  1104%     -  590s
     0     0 10175.5006    0  502 -1013.9718 10175.5006  1104%     -  593s
     0     0 10174.2106    0  508 -1013.9718 10174.2106  1103%     -  594s
     0     0 10171.0465    0  505 -1013.9718 10171.0465  1103%     -  597s
     0     0 10170.6307    0  505 -1013.9718 10170.6307  1103%     -  599s
     0     2 10170.6307    0  505 -1013.9718 10170.6307  1103%     -  693s
     1     4 10117.2273    1  596 -1013.9718 10170.6307  1103%  5456  700s
     3     8 10027.5535    2  526 -1013.9718 10117.1313  1098%  8758  715s
     7    14 9903.72016    3  551 -1013.9718 10026.6861  1089% 10159  740s
    13    28 9752.26538    4  425 -1013.9718 9903.41793  1077% 13750  766s
    27    42 7987.05707    5  312 -1013.9718 9752.21691  1062% 16068  819s
    41    74 8128.64982    6  517 -1013.9718 9752.21691  1062% 18544  925s
    73   164 8039.20735    7  483 -1013.9718 9424.96208  1030% 17594  986s
   163   267 7930.70360   10  472 -1013.9718 9424.58032  1029% 11507 1022s
   266   335 7785.75276   14  498 -1013.9718 9424.58032  1029%  9017 1047s
   334   392 7592.91314   16  493 -1013.9718 9424.58032  1029%  8119 1072s
   393   454 7527.20030   18  494 -1013.9718 9424.58032  1029%  7761 1095s
   458   516 7323.14888   20  472 -1013.9718 9424.58032  1029%  7486 1115s
   531   575 7290.43957   22  478 -1013.9718 9424.58032  1029%  7133 1134s
   608   597 7240.59964   23  485 -1013.9718 9424.58032  1029%  6926 1150s
   647   622 7151.56189   24  490 -1013.9718 9424.58032  1029%  6925 1168s
   678   664  431.05190   24  171 -1013.9718 9424.58032  1029%  6956 1182s
   730   708  311.09498   25  183 -1013.9718 9424.58032  1029%  6807 1195s
   799   717  164.86585   26  177 -1013.9718 9424.58032  1029%  6573 1212s
   861   748 2118.54263   13  236 -1013.9718 9424.58032  1029%  6444 1229s
   919   780 1999.73697   14  227 -1013.9718 9424.58032  1029%  6394 1246s
   991   818  710.56732   15  193 -1013.9718 9424.58032  1029%  6354 1266s
  1069   864  545.76506   16  190 -1013.9718 9424.58032  1029%  6287 1285s
  1149   909  531.94037   17  189 -1013.9718 9424.58032  1029%  6208 1306s
  1234   978  296.05767   18  146 -1013.9718 9424.58032  1029%  6138 1329s
  1330  1086 -263.17506   21  127 -1013.9718 9424.58032  1029%  6105 1351s
  1448  1187     cutoff   27      -1013.9718 9424.58032  1029%  6038 1371s
  1568  1276 2321.30000   27  228 -1013.9718 9424.58032  1029%  5934 1394s
  1711  1376 infeasible   28      -1013.9718 9424.58032  1029%  5786 1418s
  1847  1507 4418.07617   40  369 -1013.9718 9424.58032  1029%  5699 1441s
  2014  1609 4028.99417   47  345 -1013.9718 9424.58032  1029%  5572 1469s
  2194  1695 3253.02622   59  262 -1013.9718 9424.58032  1029%  5443 1498s
  2348  1749  188.63883   65  198 -1013.9718 9059.13537   993%  5383 1530s
  2474  1906 infeasible   71      -1013.9718 9059.13537   993%  5375 1559s
  2703  1993     cutoff   32      -1013.9718 9059.13537   993%  5199 1587s
  2876  2047 -1000.1943   90  225 -1013.9718 9059.13537   993%  5123 1619s
  3027  2097 infeasible   36      -1013.9718 9059.13537   993%  5114 1652s
  3180  2137     cutoff   33      -1013.9718 9059.13537   993%  5134 1685s
  3307  2200 -255.89894   20  153 -1013.9718 9059.13537   993%  5197 1721s
  3447  2245 infeasible   63      -1013.9718 9059.13537   993%  5239 1759s
  3576  2318  279.68618   25  196 -1013.9718 8699.20426   958%  5297 1796s
  3728  2346 4023.94016    5  423 -1013.9718 8699.09883   958%  5365 1832s
  3784  2394 3181.90590    6  280 -1013.9718 8699.09883   958%  5477 1873s
  3888  2459 2896.28571    7  394 -1013.9718 8699.09883   958%  5558 1914s
  4013  2553 2751.65106    9  400 -1013.9718 8608.76735   949%  5609 1957s
  4168  2625 -198.99368   10  389 -1013.9718 8608.76735   949%  5682 2004s
  4303  2655 infeasible   11      -1013.9718 8608.76735   949%  5769 2047s
  4358  2656 4468.02232   30  505 -1013.9718 8608.76735   949%  5826 2367s
  4360  2657 5397.27645   26  141 -1013.9718 8608.76735   949%  5823 2377s
  4361  2658 2050.70810   55  336 -1013.9718 8608.76735   949%  5822 2437s
  4362  2659 -143.05559   67  298 -1013.9718 8608.76735   949%  5820 2495s
  4363  2659   -2.16200   22  409 -1013.9718 8608.76735   949%  5819 2533s
  4364  2660  951.92285   71  422 -1013.9718 8608.76735   949%  5818 2560s
  4365  2661 7656.12168   12  450 -1013.9718 8608.76735   949%  5816 2577s
  4366  2661 3282.51965   17  516 -1013.9718 8608.76735   949%  5815 2599s
  4367  2662 7062.76020   10  507 -1013.9718 8608.76735   949%  5814 2608s
  4368  2663 5602.26235   18  478 -1013.9718 8608.76735   949%  5812 2616s
  4369  2663  -64.42707   63  495 -1013.9718 8608.76735   949%  5811 2621s
  4370  2664 3400.50882   58  548 -1013.9718 8608.76735   949%  5810 2631s
  4371  2665 -477.39706   13  494 -1013.9718 8608.76735   949%  5808 2635s
  4372  2665 2761.94522   56  493 -1013.9718 8608.76735   949%  5807 2642s
  4373  2666 1582.06445   11  496 -1013.9718 8608.76735   949%  5806 2649s
  4374  2667 1002.21011   27  437 -1013.9718 8608.76735   949%  5804 2654s
  4375  2667 1534.07167   77  483 -1013.9718 8608.76735   949%  5803 2665s
  4376  2668 -286.79751   65  471 -1013.9718 8608.76735   949%  5802 2674s
  4377  2669  986.83345   54  469 -1013.9718 8608.76735   949%  5800 2680s
  4378  2669 -259.41692   56  494 -1013.9718 8608.76735   949%  5799 2685s
  4379  2670 -471.54675   20  530 -1013.9718 8608.76735   949%  5798 2698s
  4380  2671 6980.62505   11  521 -1013.9718 8608.76735   949%  5796 2706s
  4381  2671 1254.95350   66  486 -1013.9718 8608.76735   949%  5795 2710s
  4383  2673 7223.15697   11  425 -1013.9718 8608.76735   949%  5792 2719s
  4384  2673 1703.52813   12  484 -1013.9718 8608.76735   949%  5791 2728s
  4385  2674 1810.68495   46  489 -1013.9718 8608.76735   949%  5790 2732s
  4386  2675 6730.55062   19  540 -1013.9718 8608.76735   949%  5788 2739s
  4387  2675 7607.33934   13  497 -1013.9718 8608.76735   949%  5787 2749s
  4388  2676 2552.00853   58  496 -1013.9718 8608.76735   949%  5786 2754s
  4389  2677  295.47406   19  558 -1013.9718 8608.76735   949%  5785 2765s
  4390  2677 5786.37909   18  559 -1013.9718 8608.76735   949%  5783 2778s
  4391  2678 2708.42472   33  547 -1013.9718 8608.76735   949%  5782 2788s
  4392  2679 2954.39757   60  554 -1013.9718 8608.76735   949%  5781 2795s
  4393  2679  425.69273   31  356 -1013.9718 8608.76735   949%  5779 2809s
  4394  2680 2108.71898   13  554 -1013.9718 8608.76735   949%  5778 2814s
  4395  2681 3387.42167   47  355 -1013.9718 8608.76735   949%  5777 2821s
  4396  2681  824.02402   54  511 -1013.9718 8608.76735   949%  5775 2828s
  4397  2682 4755.76323   14  506 -1013.9718 8608.76735   949%  5774 2835s
  4398  2683  585.83576   23  506 -1013.9718 8608.76735   949%  5773 2844s
  4399  2683 2421.42792   15  506 -1013.9718 8608.76735   949%  5771 2885s
  4400  2687 8608.76735   16  484 -1013.9718 8608.76735   949%  5845 2968s
  4402  2690 8608.76735   17  465 -1013.9718 8608.76735   949%  5850 2995s
  4406  2697 8608.76735   18  490 -1013.9718 8608.76735   949%  5850 3042s
  4414  2710 8608.76735   19  571 -1013.9718 8608.76735   949%  5873 3106s
  4430  2721 8482.07293   20  448 -1013.9718 8608.76735   949%  5906 3183s
  4446  2748 7131.32686   21  372 -1013.9718 8608.76735   949%  5981 3213s
  4478  2825 6602.51674   22  439 -1013.9718 8608.76735   949%  6040 3252s
  4570  2838 6134.60566   24  388 -1013.9718 8608.76735   949%  6037 3278s
  4645  2830 6115.36994   25  381 -1013.9718 8608.76735   949%  6000 3301s
  4676  2832 5324.63433   26  328 -1013.9718 8608.76735   949%  5990 3326s
  4717  2814 5088.43441   27  358 -1013.9718 8608.76735   949%  5993 3350s
  4764  2798 2866.45716   27  211 -1013.9718 8608.76735   949%  5979 3373s
  4809  2796 -440.41387   29  125 -1013.9718 8608.76735   949%  5973 3397s
  4852  2801 4727.71102   28  351 -1013.9718 8608.76735   949%  5960 3433s
  4900  2793 4301.30939   29  298 -1013.9718 8608.76735   949%  5950 3457s
  4960  2791 4212.74858   30  310 -1013.9718 8608.76735   949%  5934 3490s
  5004  2795 4022.89142   31  314 -1013.9718 8608.76735   949%  5930 3514s
  5065  2789 4130.01693   31  244 -1013.9718 8608.76735   949%  5915 3536s
  5117  2797 3269.76145   24  249 -1013.9718 8608.76735   949%  5896 3566s
  5165  2793  980.75703   25  222 -1013.9718 8608.76735   949%  5885 3594s
  5228  2771 -477.81829   27  205 -1013.9718 8608.76735   949%  5866 3600s

Cutting planes:
  Gomory: 24
  Implied bound: 58
  Projected implied bound: 262
  MIR: 1488
  Mixing: 6
  Flow cover: 1939
  RLT: 51
  Relax-and-lift: 404

Explored 5247 nodes (31392445 simplex iterations) in 3600.05 seconds (8340.50 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -1013.97 -1016.87 -1091.43 ... -1774.6

Time limit reached
Best objective -1.013971770305e+03, best bound 8.608767347914e+03, gap 949.0145%
  WARNING: Time limit reached. Using best solution found (gap: 949.01%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = -1013.97, θ = 142059.12
  Upper Bound (UB) = -1013.97

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 142059.12
  [DEBUG]   ✓ Scenario 0: θ = 142059.12 ≤ Q = 142059.12 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 142059.12 ≤ Q = 142059.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 142059.12 ≤ Q = 142059.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 142059.12 ≤ Q = 142059.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 142059.12 ≤ Q = 142059.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 142059.12 ≤ Q = 142059.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 142059.12 ≤ Q = 142059.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 142059.12 ≤ Q = 142059.12 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 142059.12 ≤ Q = 142059.12 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 142059.12 ≤ Q = 142059.12 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 142059.12 ≤ Q = 142059.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 142059.12 ≤ Q = 142059.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 142059.12 ≤ Q = 142059.12 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 13] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x34fa1bd0
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x34fa1bd0
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.147591e+13
Presolve removed 2598 rows and 1890 columns
Presolve time: 0.00s
Presolved: 495 rows, 499 columns, 1396 nonzeros
Found heuristic solution: objective 5615727.7237
Variable types: 339 continuous, 160 integer (160 binary)

Root relaxation: objective -1.287131e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -128713.08    0  123 5615727.72 -128713.08   102%     -    0s
H    0     0                    -96571.00013 -128713.08  33.3%     -    0s
H    0     0                    -97188.57910 -128713.08  32.4%     -    0s
     0     0 -106766.37    0   63 -97188.579 -106766.37  9.85%     -    0s
H    0     0                    -104369.5114 -106753.29  2.28%     -    0s
H    0     0                    -104870.2599 -106753.29  1.80%     -    0s
H    0     0                    -105207.8948 -106753.29  1.47%     -    0s
     0     0 -106301.90    0   58 -105207.89 -106301.90  1.04%     -    0s
     0     0 -106177.07    0   64 -105207.89 -106177.07  0.92%     -    0s
     0     0 -105693.49    0   20 -105207.89 -105693.49  0.46%     -    0s
     0     0 -105563.35    0   26 -105207.89 -105563.35  0.34%     -    0s
     0     0 -105531.74    0   27 -105207.89 -105531.74  0.31%     -    0s
     0     0 -105531.69    0   28 -105207.89 -105531.69  0.31%     -    0s
     0     0 -105369.69    0   14 -105207.89 -105369.69  0.15%     -    0s
H    0     0                    -105216.6853 -105346.87  0.12%     -    0s
     0     0 -105346.87    0   14 -105216.69 -105346.87  0.12%     -    0s
     0     0 -105282.13    0   10 -105216.69 -105282.13  0.06%     -    0s
     0     0 -105263.39    0    6 -105216.69 -105263.39  0.04%     -    0s
     0     0 -105229.31    0    2 -105216.69 -105229.31  0.01%     -    0s
*    0     0               0    -105227.9293 -105227.93  0.00%     -    0s

Cutting planes:
  Gomory: 3
  Implied bound: 2
  MIR: 3
  Flow cover: 4
  RLT: 1
  Relax-and-lift: 1

Explored 1 nodes (642 simplex iterations) in 0.12 seconds (0.04 work units)
Thread count was 32 (of 256 available processors)

Solution count 9: -105228 -105217 -105208 ... 1.14759e+13
No other solutions better than -105228

Optimal solution found (tolerance 1.00e-04)
Best objective -1.052279292781e+05, best bound -1.052279292781e+05, gap 0.0000%
  Subproblem solved in 0.13s
  Worst-case operational profit (Z_SP) = 136232.49
  Scenario: 24 demand increases, 36 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -105227.93
  [DEBUG]   S×d_nominal = 241460.42
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 241460.42 + -105227.93 = 136232.49
  [DEBUG]   Current θ from Master = 142059.12
  [DEBUG]   ⚠️  Z_SP ≤ θ by 5826.63 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -6840.60
  Lower Bound (LB) = -1589.09
  Gap (UB-LB) = 575.1174, Absolute Gap = 575.1174, Relative Gap = 0.567193
  Not converged yet (gap = 575.12 > ε = 200)

  [DEBUG] Adding NEW scenario 13 to Master Problem...
  [DEBUG] New scenario pattern: 24 increases, 36 decreases
    [DEBUG] Scenario 13 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 13 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 13]
    [DEBUG]   - Total constraints in model: 215443
    [DEBUG]   - Total variables in model: 89620
  [DEBUG] Total scenarios in Master: 14
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 14
================================================================================
[Iteration 14] Solving Master Problem...
  Current scenarios in Master: 14
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 215443 rows, 89620 columns and 610753 nonzeros
Model fingerprint: 0x330ed514
Variable types: 87361 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 98980 rows and 40180 columns
Presolve time: 1.59s
Presolved: 116463 rows, 49440 columns, 702355 nonzeros
Variable types: 47181 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -380201.4567
Found heuristic solution: objective -219438.1934

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.25s

Barrier statistics:
 Dense cols : 578
 AA' NZ     : 4.915e+06
 Factor NZ  : 1.154e+07 (roughly 160 MB of memory)
 Factor Ops : 2.323e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.60225315e+07  1.93070528e+08  8.92e+04 1.98e+01  6.89e+04     3s
   1  -1.23675526e+07  1.70200217e+08  6.28e+04 6.07e+01  4.79e+04     3s
   2  -6.39047861e+06  1.33977520e+08  3.11e+04 8.24e-01  2.48e+04     3s
   3  -9.23985393e+05  9.99048824e+07  2.24e+03 1.54e+00  2.17e+03     3s
   4  -4.94790798e+05  3.22760308e+07  3.84e+02 1.19e-01  4.03e+02     3s
   5  -4.10674435e+05  2.24254898e+07  1.94e+02 7.79e-02  2.24e+02     3s
   6  -3.08048506e+05  1.72313790e+07  9.09e+01 5.45e-02  1.33e+02     3s
   7  -2.19194727e+05  1.32614743e+07  4.54e+01 3.90e-02  8.54e+01     3s
   8  -1.46554106e+05  1.01562622e+07  1.89e+01 2.81e-02  5.61e+01     3s
   9  -1.15448562e+05  9.22953762e+06  1.26e+01 2.53e-02  4.87e+01     3s
  10  -9.95256222e+04  5.28108434e+06  6.90e+00 1.37e-02  2.70e+01     3s
  11  -7.46230346e+04  2.02706867e+06  3.57e+00 4.90e-03  1.03e+01     3s
  12  -3.82545454e+04  5.81290067e+05  1.26e+00 1.29e-03  2.96e+00     3s
  13  -2.98528370e+04  3.87690209e+05  9.68e-01 6.16e-04  1.99e+00     3s
  14  -2.03318283e+04  2.21526482e+05  6.56e-01 4.56e-04  1.15e+00     3s
  15  -1.30321526e+04  1.68408032e+05  4.85e-01 4.73e-04  8.58e-01     3s
  16  -6.73863907e+03  1.16674994e+05  3.38e-01 6.51e-04  5.82e-01     3s
  17  -3.67943432e+03  9.14009886e+04  2.96e-01 7.98e-04  4.49e-01     3s
  18   1.08078102e+03  8.02624529e+04  2.28e-01 1.12e-03  3.73e-01     4s
  19   5.71143918e+03  7.01322984e+04  1.81e-01 1.25e-03  3.04e-01     4s
  20   1.01990461e+04  5.35489360e+04  1.41e-01 1.12e-03  2.04e-01     4s
  21   1.23099367e+04  5.01197478e+04  1.24e-01 1.14e-03  1.78e-01     4s
  22   1.36029867e+04  4.52963521e+04  1.13e-01 1.21e-03  1.49e-01     4s
  23   1.59570916e+04  4.15759474e+04  9.45e-02 9.94e-04  1.21e-01     4s
  24   1.86243760e+04  3.93026973e+04  7.30e-02 1.31e-03  9.74e-02     4s
  25   1.96063732e+04  3.76787990e+04  6.55e-02 1.48e-03  8.51e-02     4s
  26   2.08209933e+04  3.49847651e+04  5.67e-02 1.54e-03  6.67e-02     4s
  27   2.15066476e+04  3.32307855e+04  5.17e-02 1.45e-03  5.53e-02     4s
  28   2.25391406e+04  3.26731652e+04  4.46e-02 1.04e-03  4.78e-02     4s
  29   2.43638078e+04  3.21153360e+04  3.23e-02 1.10e-03  3.65e-02     4s
  30   2.54307105e+04  3.17716135e+04  2.52e-02 1.01e-03  2.99e-02     4s
  31   2.59112563e+04  3.13092842e+04  2.21e-02 7.98e-04  2.54e-02     4s
  32   2.63026413e+04  3.08398289e+04  1.94e-02 6.14e-04  2.14e-02     4s
  33   2.68678751e+04  3.03747725e+04  1.58e-02 4.25e-04  1.65e-02     4s
  34   2.72195529e+04  3.02670322e+04  1.36e-02 4.28e-04  1.44e-02     4s
  35   2.74164100e+04  2.99783299e+04  1.23e-02 2.93e-04  1.21e-02     4s
  36   2.76911902e+04  2.99174479e+04  1.06e-02 2.34e-04  1.05e-02     4s
  37   2.83861195e+04  2.96162097e+04  6.21e-03 1.44e-04  5.80e-03     4s
  38   2.88474815e+04  2.95505101e+04  3.32e-03 9.19e-05  3.31e-03     4s
  39   2.89255355e+04  2.95217893e+04  2.86e-03 6.93e-05  2.81e-03     4s
  40   2.91275717e+04  2.94978012e+04  1.72e-03 4.94e-05  1.75e-03     4s
  41   2.92555980e+04  2.94809122e+04  9.63e-04 3.56e-05  1.06e-03     4s
  42   2.92978502e+04  2.94509055e+04  7.23e-04 1.17e-05  7.22e-04     5s
  43   2.93206908e+04  2.94480115e+04  6.00e-04 9.51e-06  6.00e-04     5s
  44   2.93449001e+04  2.94446594e+04  4.70e-04 7.25e-06  4.70e-04     5s
  45   2.93698210e+04  2.94436952e+04  3.36e-04 6.19e-06  3.48e-04     5s
  46   2.93969104e+04  2.94403871e+04  1.97e-04 3.54e-06  2.05e-04     5s
  47   2.94329982e+04  2.94360291e+04  9.06e-06 1.74e-06  1.43e-05     5s
  48   2.94354271e+04  2.94354482e+04  3.81e-08 2.98e-07  9.91e-08     5s
  49   2.94354415e+04  2.94354415e+04  7.14e-11 4.16e-11  3.97e-12     5s

Barrier solved model in 49 iterations and 4.83 seconds (9.80 work units)
Optimal objective 2.94354415e+04


Root crossover log...

       0 DPushes remaining with DInf 0.0000000e+00                 6s

    2160 PPushes remaining with PInf 1.5332453e-07                 6s
       0 PPushes remaining with PInf 0.0000000e+00                 6s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.0217700e+00      6s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   36886    2.9435441e+04   0.000000e+00   1.021770e+00      6s
   36890    2.9435441e+04   0.000000e+00   0.000000e+00      6s
   36890    2.9435441e+04   0.000000e+00   0.000000e+00      6s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 2.943544e+04, 36890 iterations, 4.07 seconds (9.36 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 29435.4415    0  233 -219438.19 29435.4415   113%     -    6s
H    0     0                    -218199.5844 29435.4415   113%     -    6s
H    0     0                    -134325.9415 29435.4415   122%     -    6s
H    0     0                    -127076.8340 29435.4415   123%     -    6s
H    0     0                    -120387.9941 29435.4415   124%     -    6s
H    0     0                    -119711.9541 29435.4415   125%     -    6s
H    0     0                    -119637.9905 29435.4415   125%     -    6s
H    0     0                    -63749.36363 29435.4415   146%     -    6s
H    0     0                    -8287.330036 29435.4415   455%     -    7s
H    0     0                    -8033.536251 29435.4415   466%     -    7s
H    0     0                    -5634.407197 29435.4415   622%     -    7s
H    0     0                    -3087.691870 23869.1299   873%     -   22s
H    0     0                    -3020.747464 23869.1299   890%     -   22s
H    0     0                    -2851.300871 23869.1299   937%     -   22s
H    0     0                    -2797.074224 23869.1299   953%     -   22s
     0     0 23846.7838    0  307 -2797.0742 23846.7838   953%     -   22s
     0     0 23303.3685    0  344 -2797.0742 23303.3685   933%     -   32s
     0     0 23121.5761    0  335 -2797.0742 23121.5761   927%     -   37s
     0     0 23071.6889    0  333 -2797.0742 23071.6889   925%     -   40s
     0     0 23039.6114    0  337 -2797.0742 23039.6114   924%     -   41s
     0     0 23009.4762    0  343 -2797.0742 23009.4762   923%     -   47s
     0     0 23002.7925    0  345 -2797.0742 23002.7925   922%     -   49s
     0     0 23002.7345    0  345 -2797.0742 23002.7345   922%     -   50s
H    0     0                    -2580.885228 19412.9453   852%     -   95s
H    0     0                    -2400.225973 19412.9453   909%     -   95s
H    0     0                    -2396.129280 19412.9453   910%     -   95s
H    0     0                    -2366.785702 19412.9453   920%     -   95s
H    0     0                    -2363.227267 19412.9453   921%     -   95s
H    0     0                    -2349.144018 19412.9453   926%     -   95s
H    0     0                    -2315.106027 19412.9453   939%     -   95s
H    0     0                    -2235.144492 19412.9453   969%     -   95s
     0     0 19412.9453    0  369 -2235.1445 19412.9453   969%     -   95s
H    0     0                    -2103.950741 19412.9121  1023%     -   96s
     0     0 18541.9446    0  448 -2103.9507 18541.9446   981%     -  123s
H    0     0                    -2077.878151 18318.3448   982%     -  139s
H    0     0                    -2050.437218 18318.3448   993%     -  139s
     0     0 18318.3448    0  462 -2050.4372 18318.3448   993%     -  139s
H    0     0                    -2043.498956 18177.3338   990%     -  152s
     0     0 18177.3338    0  467 -2043.4990 18177.3338   990%     -  152s
     0     0 17924.1354    0  448 -2043.4990 17924.1354   977%     -  169s
     0     0 17886.7985    0  449 -2043.4990 17886.7985   975%     -  178s
     0     0 17850.9155    0  445 -2043.4990 17850.9155   974%     -  185s
     0     0 17754.4574    0  469 -2043.4990 17754.4574   969%     -  196s
H    0     0                    -1641.438224 17641.2642  1175%     -  205s
     0     0 17641.2642    0  466 -1641.4382 17641.2642  1175%     -  205s
H    0     0                    -1518.471706 17603.0421  1259%     -  209s
     0     0 17603.0421    0  465 -1518.4717 17603.0421  1259%     -  209s
     0     0 17590.9534    0  447 -1518.4717 17590.9534  1258%     -  212s
     0     0 17573.8126    0  460 -1518.4717 17573.8126  1257%     -  215s
     0     0 17567.1625    0  468 -1518.4717 17567.1625  1257%     -  217s
     0     0 17566.4152    0  464 -1518.4717 17566.4152  1257%     -  218s
H    0     0                    -1515.703421 14242.7525  1040%     -  288s
H    0     0                    -1375.521581 14242.7525  1135%     -  288s
H    0     0                    -1374.380497 14242.7525  1136%     -  288s
H    0     0                    -1298.092285 14242.7525  1197%     -  288s
H    0     0                    -1238.034132 14242.7525  1250%     -  288s
     0     0 14242.7525    0  455 -1238.0341 14242.7525  1250%     -  288s
H    0     0                    -1129.332515 13608.1958  1305%     -  314s
     0     0 13608.1958    0  511 -1129.3325 13608.1958  1305%     -  314s
     0     0 13424.8108    0  507 -1129.3325 13424.8108  1289%     -  328s
     0     0 13310.6693    0  520 -1129.3325 13310.6693  1279%     -  338s
     0     0 13240.2827    0  514 -1129.3325 13240.2827  1272%     -  346s
     0     0 13194.6540    0  512 -1129.3325 13194.6540  1268%     -  353s
     0     0 13171.9298    0  515 -1129.3325 13171.9298  1266%     -  357s
     0     0 13121.1325    0  524 -1129.3325 13121.1325  1262%     -  364s
     0     0 13111.3538    0  509 -1129.3325 13111.3538  1261%     -  367s
     0     0 13107.9011    0  525 -1129.3325 13107.9011  1261%     -  369s
     0     0 13093.2136    0  525 -1129.3325 13093.2136  1259%     -  372s
     0     0 13092.7282    0  527 -1129.3325 13092.7282  1259%     -  373s
     0     0 11963.5579    0  451 -1129.3325 11963.5579  1159%     -  412s
     0     0 11662.6379    0  410 -1129.3325 11662.6379  1133%     -  432s
     0     0 11537.8912    0  483 -1129.3325 11537.8912  1122%     -  445s
H    0     0                    -1091.432085 11406.4581  1145%     -  454s
     0     0 11406.4581    0  409 -1091.4321 11406.4581  1145%     -  454s
     0     0 11337.4318    0  475 -1091.4321 11337.4318  1139%     -  461s
     0     0 11273.4875    0  462 -1091.4321 11273.4875  1133%     -  469s
     0     0 11191.2388    0  480 -1091.4321 11191.2388  1125%     -  476s
     0     0 11175.0052    0  563 -1091.4321 11175.0052  1124%     -  480s
     0     0 11151.7851    0  486 -1091.4321 11151.7851  1122%     -  485s
     0     0 11121.4313    0  484 -1091.4321 11121.4313  1119%     -  489s
     0     0 11100.8490    0  567 -1091.4321 11100.8490  1117%     -  496s
     0     0 11066.2874    0  488 -1091.4321 11066.2874  1114%     -  503s
     0     0 11064.0783    0  557 -1091.4321 11064.0783  1114%     -  506s
     0     0 10766.1483    0  476 -1091.4321 10766.1483  1086%     -  533s
     0     0 10687.8139    0  552 -1091.4321 10687.8139  1079%     -  544s
     0     0 10665.5144    0  418 -1091.4321 10665.5144  1077%     -  549s
     0     0 10651.5491    0  477 -1091.4321 10651.5491  1076%     -  554s
     0     0 10640.2316    0  415 -1091.4321 10640.2316  1075%     -  559s
     0     0 10626.6696    0  489 -1091.4321 10626.6696  1074%     -  563s
     0     0 10621.6841    0  474 -1091.4321 10621.6841  1073%     -  567s
     0     0 10619.6926    0  477 -1091.4321 10619.6926  1073%     -  568s
     0     0 10515.8150    0  619 -1091.4321 10515.8150  1063%     -  580s
     0     0 10478.8703    0  599 -1091.4321 10478.8703  1060%     -  595s
     0     0 10467.2525    0  654 -1091.4321 10467.2525  1059%     -  600s
     0     0 10451.9927    0  640 -1091.4321 10451.9927  1058%     -  603s
     0     0 10418.6335    0  642 -1091.4321 10418.6335  1055%     -  607s
     0     0 10411.1927    0  649 -1091.4321 10411.1927  1054%     -  610s
     0     0 10406.9718    0  648 -1091.4321 10406.9718  1054%     -  612s
     0     0 10404.8425    0  638 -1091.4321 10404.8425  1053%     -  613s
     0     0 10290.3760    0  474 -1091.4321 10290.3760  1043%     -  623s
     0     0 10228.7774    0  471 -1091.4321 10228.7774  1037%     -  632s
     0     0 10222.1511    0  528 -1091.4321 10222.1511  1037%     -  635s
     0     0 10214.5123    0  468 -1091.4321 10214.5123  1036%     -  637s
     0     0 10209.2759    0  520 -1091.4321 10209.2759  1035%     -  639s
     0     0 10207.7078    0  481 -1091.4321 10207.7078  1035%     -  640s
     0     0 10165.3761    0  536 -1091.4321 10165.3761  1031%     -  648s
     0     0 10149.6039    0  546 -1091.4321 10149.6039  1030%     -  654s
     0     0 10145.3347    0  552 -1091.4321 10145.3347  1030%     -  657s
     0     0 10141.6709    0  537 -1091.4321 10141.6709  1029%     -  659s
     0     0 10139.7394    0  543 -1091.4321 10139.7394  1029%     -  660s
     0     0 10119.6878    0  599 -1091.4321 10119.6878  1027%     -  668s
     0     0 10114.8051    0  624 -1091.4321 10114.8051  1027%     -  672s
     0     0 10112.4187    0  432 -1091.4321 10112.4187  1027%     -  673s
     0     0 10108.7468    0  609 -1091.4321 10108.7468  1026%     -  677s
     0     0 10099.2654    0  490 -1091.4321 10099.2654  1025%     -  682s
     0     0 10096.7632    0  443 -1091.4321 10096.7632  1025%     -  684s
     0     0 10091.9301    0  440 -1091.4321 10091.9301  1025%     -  687s
     0     0 10089.5916    0  443 -1091.4321 10089.5916  1024%     -  689s
     0     0 10088.3195    0  453 -1091.4321 10088.3195  1024%     -  691s
     0     0 10088.3044    0  453 -1091.4321 10088.3044  1024%     -  693s
H    0     0                    -1074.670836 10088.2962  1039%     -  766s
     0     2 10088.2962    0  453 -1074.6708 10088.2962  1039%     -  805s
     1     4 10009.6051    1  440 -1074.6708 10088.2804  1039%  6897  819s
     3     7 9946.34682    2  484 -1074.6708 10008.7359  1031% 10109  837s
     6    14 9818.14496    3  445 -1074.6708 9946.26123  1026% 10654  859s
    13    28 9341.94949    4  525 -1074.6708 9818.12093  1014% 16510  886s
    27    42 9050.49469    5  585 -1074.6708 9341.90183   969% 21888 1483s
    41    74 8415.90473    6  502 -1074.6708 9341.90183   969% 24391 1651s
    73   106 8397.95295    7  492 -1074.6708 8917.01674   930% 22918 1692s
   105   138 8308.83116    8  409 -1074.6708 8915.82034   930% 18883 1733s
   137   186 8253.87969    9  395 -1074.6708 8915.82034   930% 15853 1774s
   185   266 8168.64972   11  396 -1074.6708 8915.82034   930% 13203 1859s
H  242   266                    -1051.181462 8915.82034   948% 11213 1859s
   267   356 7612.13438   15  295 -1051.1815 8915.82034   948% 10857 1899s
H  269   356                    -1023.115817 8915.82034   971% 10791 1899s
   361   441 2912.21265   17  187 -1023.1158 8915.82034   971%  9673 1931s
   459   505 2593.71137   19  174 -1023.1158 8915.82034   971%  8977 1961s
   532   592 2175.23138   21  189 -1023.1158 8896.68078   970%  8712 1990s
   631   666 1765.55803   26  195 -1023.1158 8896.68078   970%  8227 2016s
   717   734 1490.19080   31  187 -1023.1158 8896.68078   970%  7776 2043s
   812   758  639.27327   36  171 -1023.1158 8896.68078   970%  7560 2065s
   848   791  204.74918   38  139 -1023.1158 8896.68078   970%  7529 2106s
   901   817 -191.31229   44  118 -1023.1158 8896.68078   970%  7686 2133s
   959   870 infeasible   46      -1023.1158 8691.54155   950%  7690 2160s
  1028   949 8245.64568    8  468 -1023.1158 8691.54155   950%  7713 2185s
  1113   997 8127.71138    9  515 -1023.1158 8691.54155   950%  7637 2211s
  1197  1052 8079.83916   10  517 -1023.1158 8691.54155   950%  7570 2236s
  1274  1103 7416.65946   12  447 -1023.1158 8691.54155   950%  7609 2268s
  1338  1179 5956.65672   13  420 -1023.1158 8691.54155   950%  7616 2298s
  1430  1266 5484.33938   16  417 -1023.1158 8691.54155   950%  7552 2328s
  1535  1350     cutoff   20      -1023.1158 8691.54155   950%  7480 2365s
  1651  1442 5105.80160   20  366 -1023.1158 8691.54155   950%  7369 2391s
  1773  1569 4381.02250   24  356 -1023.1158 8691.54155   950%  7280 2422s
  1928  1736 3630.60146   31  243 -1023.1158 8683.57190   949%  7104 2451s
  2111  1901 2511.08010   41  233 -1023.1158 8683.57190   949%  6838 2482s
  2316  2044 1857.56835   51  194 -1023.1158 8683.57190   949%  6628 2515s
  2529  2162  772.01248   64  235 -1023.1158 8683.57190   949%  6441 2551s
  2721  2291   30.51429   79  157 -1023.1158 8683.57190   949%  6309 2585s
  2909  2416 7836.89473   11  494 -1023.1158 8683.57190   949%  6218 2624s
  3114  2551 6374.65111   13  471 -1023.1158 8683.57190   949%  6135 2663s
  3323  2736 6057.29980   15  397 -1023.1158 8683.57190   949%  6027 2708s
  3589  2925 5301.51824   18  381 -1023.1158 8683.57190   949%  5869 2749s
  3881  2926 2011.76574   27  453 -1023.1158 8683.57190   949%  5719 2967s
  3883  2927 5748.53381   11  128 -1023.1158 8683.57190   949%  5716 2977s
  3884  2928 6118.14759   14  321 -1023.1158 8683.57190   949%  5715 3022s
  3885  2929  637.66654   40  395 -1023.1158 8683.57190   949%  5713 3065s
  3886  2929 1680.04524   18  442 -1023.1158 8683.57190   949%  5712 3093s
  3887  2930  349.74719   89  471 -1023.1158 8683.57190   949%  5710 3114s
  3888  2931 3139.57289   52  439 -1023.1158 8683.57190   949%  5709 3126s
  3889  2931 3011.67154   13  459 -1023.1158 8683.57190   949%  5707 3135s
  3890  2932 7398.96998   10  416 -1023.1158 8683.57190   949%  5706 3147s
  3891  2933 7046.89455   14  522 -1023.1158 8683.57190   949%  5704 3153s
  3892  2933 1525.71941   52  501 -1023.1158 8683.57190   949%  5703 3162s
  3893  2934   49.27573   32  485 -1023.1158 8683.57190   949%  5701 3167s
  3894  2935 6741.83056   16  483 -1023.1158 8683.57190   949%  5700 3171s
  3895  2935 1147.46654   64  535 -1023.1158 8683.57190   949%  5698 3179s
  3896  2936  614.63690   92  490 -1023.1158 8683.57190   949%  5697 3185s
  3898  2937 3791.24933   40  583 -1023.1158 8683.57190   949%  5694 3191s
  3899  2938 3132.54398   17  435 -1023.1158 8683.57190   949%  5693 3195s
  3901  2939 2079.30747   25  480 -1023.1158 8683.57190   949%  5690 3213s
  3902  2940 1218.28972   67  464 -1023.1158 8683.57190   949%  5688 3217s
  3903  2941 4863.96118   24  414 -1023.1158 8683.57190   949%  5687 3221s
  3904  2941 3274.71997   39  482 -1023.1158 8683.57190   949%  5685 3230s
  3906  2943 6852.18858   10  537 -1023.1158 8683.57190   949%  5682 3240s
  3907  2943 2396.32907   44  562 -1023.1158 8683.57190   949%  5681 3246s
  3909  2945 1395.75183   63  530 -1023.1158 8683.57190   949%  5678 3257s
  3910  2945 2842.52234   15  328 -1023.1158 8683.57190   949%  5677 3260s
  3911  2946 4209.39244   29  539 -1023.1158 8683.57190   949%  5675 3272s
  3912  2947  558.35136   63  542 -1023.1158 8683.57190   949%  5674 3276s
  3913  2947 4937.02446   21  483 -1023.1158 8683.57190   949%  5672 3284s
  3914  2948 1250.24193   53  502 -1023.1158 8683.57190   949%  5671 3289s
  3915  2949 7847.19794   11  529 -1023.1158 8683.57190   949%  5669 3298s
  3916  2949 5170.91060   11  531 -1023.1158 8683.57190   949%  5668 3307s
  3917  2950  418.77913   81  537 -1023.1158 8683.57190   949%  5666 3316s
  3918  2951 7873.61640   10  541 -1023.1158 8683.57190   949%  5665 3321s
  3919  2951  350.95819   95  404 -1023.1158 8683.57190   949%  5664 3329s
  3920  2952 3035.37268   45  411 -1023.1158 8683.57190   949%  5662 3334s
  3921  2953 6344.22648   21  399 -1023.1158 8683.57190   949%  5661 3342s
  3922  2953 5152.81425   23  399 -1023.1158 8683.57190   949%  5659 3356s
  3923  2954 4352.88203   24  399 -1023.1158 8683.57190   949%  5658 3402s
  3924  2958 8683.57190   10  574 -1023.1158 8683.57190   949%  5751 3464s
  3926  2961 8683.57190   11  568 -1023.1158 8683.57190   949%  5754 3509s
  3930  2968 8683.57190   12  532 -1023.1158 8683.57190   949%  5759 3571s
  3938  2978 8637.78797   13  465 -1023.1158 8683.57190   949%  5778 3600s

Cutting planes:
  Gomory: 7
  Implied bound: 53
  Projected implied bound: 191
  MIR: 1143
  Mixing: 4
  Flow cover: 1313
  RLT: 47
  Relax-and-lift: 250

Explored 3951 nodes (23817084 simplex iterations) in 3600.12 seconds (7814.80 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -1023.12 -1051.18 -1074.67 ... -1515.7

Time limit reached
Best objective -1.023115817302e+03, best bound 8.637664574220e+03, gap 944.2509%
  WARNING: Time limit reached. Using best solution found (gap: 944.25%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.14s
  Master Objective (UB) = -1023.12, θ = 140920.86
  Upper Bound (UB) = -1023.12

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 140920.86
  [DEBUG]   ✓ Scenario 0: θ = 140920.86 ≤ Q = 140920.86 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 140920.86 ≤ Q = 140920.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 140920.86 ≤ Q = 140920.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 140920.86 ≤ Q = 140920.86 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 140920.86 ≤ Q = 140920.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 140920.86 ≤ Q = 140920.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 140920.86 ≤ Q = 140920.86 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 140920.86 ≤ Q = 140920.86 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 140920.86 ≤ Q = 140920.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 140920.86 ≤ Q = 140920.86 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 140920.86 ≤ Q = 140920.86 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 140920.86 ≤ Q = 140920.86 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 140920.86 ≤ Q = 140920.86 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 140920.86 ≤ Q = 140920.86 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 14] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x54845a71
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xab7ba58f
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.156715e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.00s
Presolved: 494 rows, 498 columns, 1393 nonzeros
Found heuristic solution: objective 5766326.0376
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.300037e+05, 244 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -130003.73    0  123 5766326.04 -130003.73   102%     -    0s
H    0     0                    -97759.80637 -130003.73  33.0%     -    0s
H    0     0                    -98360.95263 -130003.73  32.2%     -    0s
     0     0 -107587.41    0   65 -98360.953 -107587.41  9.38%     -    0s
H    0     0                    -105470.4200 -107524.37  1.95%     -    0s
H    0     0                    -106196.9406 -107524.37  1.25%     -    0s
     0     0 -106927.25    0   59 -106196.94 -106927.25  0.69%     -    0s
     0     0 -106860.13    0   58 -106196.94 -106860.13  0.62%     -    0s
H    0     0                    -106200.9895 -106860.13  0.62%     -    0s
     0     0 -106500.75    0   19 -106200.99 -106500.75  0.28%     -    0s
     0     0 -106493.96    0   16 -106200.99 -106493.96  0.28%     -    0s
     0     0 -106374.52    0   17 -106200.99 -106374.52  0.16%     -    0s
     0     0 -106374.20    0   16 -106200.99 -106374.20  0.16%     -    0s
     0     0 -106352.04    0   14 -106200.99 -106352.04  0.14%     -    0s
     0     0 -106291.16    0   11 -106200.99 -106291.16  0.08%     -    0s
     0     0 -106291.16    0   15 -106200.99 -106291.16  0.08%     -    0s
H    0     0                    -106226.8408 -106291.16  0.06%     -    0s
     0     0 -106249.55    0    4 -106226.84 -106249.55  0.02%     -    0s
H    0     0                    -106249.3680 -106249.44  0.00%     -    0s

Cutting planes:
  Gomory: 4
  MIR: 8
  Flow cover: 5
  Relax-and-lift: 2

Explored 1 nodes (705 simplex iterations) in 0.09 seconds (0.03 work units)
Thread count was 32 (of 256 available processors)

Solution count 8: -106249 -106227 -106201 ... 1.15672e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.062493680179e+05, best bound -1.062494400928e+05, gap 0.0001%
  Subproblem solved in 0.12s
  Worst-case operational profit (Z_SP) = 135211.05
  Scenario: 26 demand increases, 34 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -106249.37
  [DEBUG]   S×d_nominal = 241460.42
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 241460.42 + -106249.37 = 135211.05
  [DEBUG]   Current θ from Master = 140920.86
  [DEBUG]   ⚠️  Z_SP ≤ θ by 5709.81 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -6732.92
  Lower Bound (LB) = -1589.09
  Gap (UB-LB) = 565.9734, Absolute Gap = 565.9734, Relative Gap = 0.553186
  Not converged yet (gap = 565.97 > ε = 200)

  [DEBUG] Adding NEW scenario 14 to Master Problem...
  [DEBUG] New scenario pattern: 26 increases, 34 decreases
    [DEBUG] Scenario 14 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 14 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 14]
    [DEBUG]   - Total constraints in model: 230733
    [DEBUG]   - Total variables in model: 95860
  [DEBUG] Total scenarios in Master: 15
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 15
================================================================================
[Iteration 15] Solving Master Problem...
  Current scenarios in Master: 15
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 230733 rows, 95860 columns and 653984 nonzeros
Model fingerprint: 0xb6643391
Variable types: 93601 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 106050 rows and 43050 columns
Presolve time: 2.87s
Presolved: 124683 rows, 52810 columns, 767515 nonzeros
Variable types: 50551 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -372861.2647
Found heuristic solution: objective -219438.1934

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.35s

Barrier statistics:
 Dense cols : 600
 AA' NZ     : 6.083e+06
 Factor NZ  : 1.353e+07 (roughly 180 MB of memory)
 Factor Ops : 2.936e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.60223978e+07  2.04542553e+08  9.04e+04 1.91e+01  6.86e+04     5s
   1  -1.24433262e+07  1.79153949e+08  6.46e+04 5.53e+01  4.85e+04     5s
   2  -6.44491552e+06  1.40621166e+08  3.16e+04 4.98e-01  2.48e+04     5s
   3  -9.75787308e+05  1.06858653e+08  2.41e+03 9.56e-01  2.26e+03     5s
   4  -5.35557868e+05  3.68444961e+07  4.28e+02 1.37e-01  4.41e+02     5s
   5  -4.39904327e+05  2.45971335e+07  2.04e+02 7.22e-02  2.32e+02     5s
   6  -3.59149879e+05  1.86192228e+07  9.24e+01 4.92e-02  1.34e+02     5s
   7  -2.76815946e+05  1.44087780e+07  4.80e+01 3.58e-02  8.81e+01     5s
   8  -1.61173689e+05  9.43400842e+06  1.65e+01 2.08e-02  4.85e+01     5s
   9  -1.34986888e+05  6.69190294e+06  1.12e+01 1.40e-02  3.32e+01     5s
  10  -1.07649058e+05  3.16169834e+06  5.17e+00 6.09e-03  1.52e+01     5s
  11  -8.41938062e+04  8.15527311e+05  1.32e+00 1.44e-03  4.02e+00     5s
  12  -6.18263396e+04  3.72289634e+05  7.42e-01 1.72e-03  1.93e+00     5s
  13  -3.57693056e+04  1.95116939e+05  4.14e-01 1.03e-03  1.02e+00     5s
  14  -2.26437485e+04  1.50989588e+05  3.06e-01 1.08e-03  7.67e-01     5s
  15  -1.62392739e+04  1.17185310e+05  2.65e-01 2.02e-03  5.89e-01     5s
  16  -1.42010751e+04  9.58571609e+04  2.47e-01 1.41e-03  4.86e-01     5s
  17  -7.36715654e+03  8.41349676e+04  1.98e-01 1.33e-03  4.04e-01     5s
  18  -2.43064938e+02  6.79828743e+04  1.47e-01 2.04e-03  3.01e-01     5s
  19   4.21860577e+03  5.50394474e+04  1.18e-01 2.45e-03  2.24e-01     5s
  20   7.77019947e+03  4.71365966e+04  9.70e-02 2.41e-03  1.74e-01     6s
  21   8.70926452e+03  4.24135590e+04  8.98e-02 1.81e-03  1.49e-01     6s
  22   1.02856926e+04  4.06193694e+04  8.13e-02 1.66e-03  1.34e-01     6s
  23   1.20355502e+04  3.82444803e+04  7.18e-02 2.43e-03  1.16e-01     6s
  24   1.52525587e+04  3.46051093e+04  5.53e-02 2.21e-03  8.56e-02     6s
  25   1.75259991e+04  3.31064578e+04  4.42e-02 2.03e-03  6.89e-02     6s
  26   1.95275182e+04  3.23192780e+04  3.48e-02 1.74e-03  5.65e-02     6s
  27   2.01772382e+04  3.18330832e+04  3.16e-02 1.58e-03  5.15e-02     6s
  28   2.04119797e+04  3.07594361e+04  3.05e-02 1.34e-03  4.58e-02     6s
  29   2.13496545e+04  2.97943340e+04  2.60e-02 9.84e-04  3.74e-02     6s
  30   2.14583567e+04  2.95886811e+04  2.55e-02 9.00e-04  3.60e-02     6s
  31   2.15980370e+04  2.93432849e+04  2.49e-02 7.98e-04  3.43e-02     6s
  32   2.17906923e+04  2.92731862e+04  2.41e-02 7.71e-04  3.31e-02     6s
  33   2.25388864e+04  2.90243262e+04  2.08e-02 6.69e-04  2.87e-02     6s
  34   2.28140903e+04  2.89690653e+04  1.96e-02 6.47e-04  2.72e-02     6s
  35   2.31727642e+04  2.87162716e+04  1.81e-02 5.44e-04  2.45e-02     6s
  36   2.43016164e+04  2.84804614e+04  1.33e-02 4.90e-04  1.85e-02     6s
  37   2.53338043e+04  2.80039385e+04  8.81e-03 3.53e-04  1.18e-02     6s
  38   2.60614513e+04  2.78189041e+04  5.76e-03 2.10e-04  7.78e-03     6s
  39   2.67670376e+04  2.76588315e+04  2.83e-03 1.15e-04  3.95e-03     6s
  40   2.70290583e+04  2.76160302e+04  1.78e-03 9.57e-05  2.60e-03     6s
  41   2.71002116e+04  2.75750517e+04  1.49e-03 6.29e-05  2.10e-03     7s
  42   2.72559319e+04  2.75390881e+04  8.75e-04 3.45e-05  1.25e-03     7s
  43   2.73742936e+04  2.75147410e+04  4.23e-04 1.39e-05  6.21e-04     7s
  44   2.74130785e+04  2.75039948e+04  2.78e-04 5.70e-06  4.02e-04     7s
  45   2.74460201e+04  2.74992521e+04  1.58e-04 7.31e-06  2.35e-04     7s
  46   2.74620525e+04  2.74985433e+04  1.03e-04 6.39e-06  1.61e-04     7s
  47   2.74733591e+04  2.74960074e+04  6.29e-05 4.06e-06  1.00e-04     7s
  48   2.74789600e+04  2.74946399e+04  4.41e-05 2.47e-06  6.93e-05     7s
  49   2.74861481e+04  2.74943658e+04  1.91e-05 2.20e-06  3.63e-05     7s
  50   2.74867648e+04  2.74937087e+04  1.71e-05 1.52e-06  3.07e-05     7s
  51   2.74917075e+04  2.74928773e+04  9.79e-07 6.88e-07  5.15e-06     7s
  52   2.74921014e+04  2.74923376e+04  1.77e-07 1.43e-07  1.04e-06     7s
  53   2.74921425e+04  2.74922036e+04  1.09e-07 2.56e-06  2.70e-07     7s
  54   2.74921919e+04  2.74921924e+04  6.51e-08 1.64e-07  2.21e-09     7s
  55   2.74921922e+04  2.74921923e+04  1.17e-07 3.62e-09  7.04e-10     7s

Barrier solved model in 55 iterations and 7.33 seconds (12.61 work units)
Optimal objective 2.74921922e+04


Root crossover log...

  112655 DPushes remaining with DInf 0.0000000e+00                 7s
    3699 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                11s

    8107 PPushes remaining with PInf 5.4143789e-05                11s
       0 PPushes remaining with PInf 0.0000000e+00                12s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.4678349e+04     12s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   62510    2.7492192e+04   0.000000e+00   1.467835e+04     12s
   62668    2.7492192e+04   0.000000e+00   0.000000e+00     12s
   62668    2.7492192e+04   0.000000e+00   0.000000e+00     12s
Concurrent spin time: 5.46s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 2.749219e+04, 62668 iterations, 13.76 seconds (17.94 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 27492.1923    0  137 -219438.19 27492.1923   113%     -   18s
H    0     0                    -218199.5844 27492.1923   113%     -   18s
H    0     0                    -150351.0672 27492.1923   118%     -   18s
H    0     0                    -148322.3076 27492.1923   119%     -   18s
H    0     0                    -129103.8229 27492.1923   121%     -   18s
H    0     0                    -126756.4780 27492.1923   122%     -   18s
H    0     0                    -126617.6504 27492.1923   122%     -   18s
H    0     0                    -126296.9695 27492.1923   122%     -   18s
H    0     0                    -71394.31792 27492.1923   139%     -   18s
H    0     0                    -10496.42469 27492.1923   362%     -   19s
H    0     0                    -1845.918364 27492.1923  1589%     -   19s
H    0     0                    -1638.771660 27492.1923  1778%     -   19s
H    0     0                    -1215.581857 27492.1923  2362%     -   19s
     0     0 21908.9276    0  237 -1215.5819 21908.9276  1902%     -   54s
H    0     0                    -1091.432085 21895.6439  2106%     -   55s
H    0     0                    -1074.670836 21895.6439  2137%     -   55s
     0     0 21583.9091    0  238 -1074.6708 21583.9091  2108%     -   65s
     0     0 21552.2354    0  238 -1074.6708 21552.2354  2105%     -   68s
     0     0 21552.2354    0  235 -1074.6708 21552.2354  2105%     -   69s
     0     0 21547.0556    0  237 -1074.6708 21547.0556  2105%     -   70s
     0     0 21543.4028    0  236 -1074.6708 21543.4028  2105%     -   71s
     0     0 21541.3605    0  238 -1074.6708 21541.3605  2104%     -   72s
     0     0 21539.8219    0  242 -1074.6708 21539.8219  2104%     -   73s
     0     0 21539.8219    0  242 -1074.6708 21539.8219  2104%     -   73s
     0     0 18234.0310    0  215 -1074.6708 18234.0310  1797%     -  120s
     0     0 17753.9186    0  233 -1074.6708 17753.9186  1752%     -  138s
     0     0 17697.8182    0  225 -1074.6708 17697.8182  1747%     -  143s
     0     0 17571.7528    0  240 -1074.6708 17571.7528  1735%     -  155s
     0     0 17531.2421    0  242 -1074.6708 17531.2421  1731%     -  166s
     0     0 17485.8437    0  240 -1074.6708 17485.8437  1727%     -  177s
     0     0 17484.0060    0  244 -1074.6708 17484.0060  1727%     -  180s
     0     0 17420.3187    0  248 -1074.6708 17420.3187  1721%     -  189s
     0     0 17276.2052    0  245 -1074.6708 17276.2052  1708%     -  201s
     0     0 17235.4703    0  240 -1074.6708 17235.4703  1704%     -  205s
     0     0 17204.0850    0  245 -1074.6708 17204.0850  1701%     -  209s
     0     0 17194.0840    0  241 -1074.6708 17194.0840  1700%     -  212s
     0     0 17182.4237    0  240 -1074.6708 17182.4237  1699%     -  216s
     0     0 17182.1602    0  240 -1074.6708 17182.1602  1699%     -  216s
     0     0 14393.2945    0  300 -1074.6708 14393.2945  1439%     -  275s
     0     0 13405.6084    0  377 -1074.6708 13405.6084  1347%     -  300s
     0     0 13101.6122    0  356 -1074.6708 13101.6122  1319%     -  315s
     0     0 12919.2817    0  350 -1074.6708 12919.2817  1302%     -  329s
     0     0 12855.6296    0  372 -1074.6708 12855.6296  1296%     -  344s
     0     0 12763.9475    0  368 -1074.6708 12763.9475  1288%     -  358s
     0     0 12717.3865    0  364 -1074.6708 12717.3865  1283%     -  365s
     0     0 12710.0423    0  398 -1074.6708 12710.0423  1283%     -  368s
     0     0 12695.1764    0  362 -1074.6708 12695.1764  1281%     -  371s
     0     0 12682.1713    0  396 -1074.6708 12682.1713  1280%     -  373s
     0     0 12677.5315    0  397 -1074.6708 12677.5315  1280%     -  374s
     0     0 12670.2423    0  398 -1074.6708 12670.2423  1279%     -  376s
     0     0 12664.9118    0  375 -1074.6708 12664.9118  1278%     -  378s
     0     0 12661.1199    0  410 -1074.6708 12661.1199  1278%     -  380s
     0     0 12657.9552    0  417 -1074.6708 12657.9552  1278%     -  383s
     0     0 12657.5037    0  418 -1074.6708 12657.5037  1278%     -  384s
     0     0 11233.8586    0  450 -1074.6708 11233.8586  1145%     -  449s
     0     0 10980.4817    0  453 -1074.6708 10980.4817  1122%     -  468s
     0     0 10935.1924    0  459 -1074.6708 10935.1924  1118%     -  477s
     0     0 10865.4866    0  452 -1074.6708 10865.4866  1111%     -  489s
     0     0 10802.9479    0  458 -1074.6708 10802.9479  1105%     -  501s
     0     0 10775.7912    0  458 -1074.6708 10775.7912  1103%     -  507s
     0     0 10767.8199    0  461 -1074.6708 10767.8199  1102%     -  512s
     0     0 10704.3802    0  463 -1074.6708 10704.3802  1096%     -  523s
     0     0 10684.8875    0  471 -1074.6708 10684.8875  1094%     -  526s
     0     0 10674.5996    0  475 -1074.6708 10674.5996  1093%     -  527s
     0     0 10649.2543    0  472 -1074.6708 10649.2543  1091%     -  531s
     0     0 10647.5203    0  471 -1074.6708 10647.5203  1091%     -  532s
     0     0 10400.9344    0  450 -1074.6708 10400.9344  1068%     -  543s
     0     0 10328.6857    0  456 -1074.6708 10328.6857  1061%     -  554s
     0     0 10311.1793    0  468 -1074.6708 10311.1793  1059%     -  557s
     0     0 10279.2497    0  522 -1074.6708 10279.2497  1057%     -  562s
     0     0 10270.9825    0  541 -1074.6708 10270.9825  1056%     -  565s
     0     0 10267.2911    0  541 -1074.6708 10267.2911  1055%     -  567s
     0     0 10265.7292    0  547 -1074.6708 10265.7292  1055%     -  568s
     0     0 10168.1931    0  536 -1074.6708 10168.1931  1046%     -  577s
     0     0 10115.5194    0  536 -1074.6708 10115.5194  1041%     -  590s
     0     0 10111.0354    0  545 -1074.6708 10111.0354  1041%     -  591s
     0     0 10105.7322    0  598 -1074.6708 10105.7322  1040%     -  594s
     0     0 10103.3227    0  550 -1074.6708 10103.3227  1040%     -  595s
     0     0 10101.5361    0  549 -1074.6708 10101.5361  1040%     -  596s
     0     0 10060.7062    0  490 -1074.6708 10060.7062  1036%     -  600s
     0     0 10057.2738    0  491 -1074.6708 10057.2738  1036%     -  602s
     0     0 10055.8777    0  492 -1074.6708 10055.8777  1036%     -  602s
     0     0 10045.5214    0  534 -1074.6708 10045.5214  1035%     -  605s
     0     0 10043.3534    0  577 -1074.6708 10043.3534  1035%     -  623s
     0     0 10040.9194    0  340 -1074.6708 10040.9194  1034%     -  626s
     0     0 10039.5970    0  500 -1074.6708 10039.5970  1034%     -  627s
     0     0 10034.4707    0  344 -1074.6708 10034.4707  1034%     -  629s
     0     0 10033.3971    0  343 -1074.6708 10033.3971  1034%     -  630s
     0     0 10027.9405    0  349 -1074.6708 10027.9405  1033%     -  632s
     0     0 10027.1887    0  349 -1074.6708 10027.1887  1033%     -  634s
     0     2 10027.1887    0  349 -1074.6708 10027.1887  1033%     -  712s
     1     3 9304.28864    1  383 -1074.6708 10026.2054  1033%  9934  720s
     2     5 8901.19525    2  363 -1074.6708 10026.2054  1033%  8764  729s
     4     9 8597.20406    3  361 -1074.6708 9880.69772  1019%  8319  742s
     8    17 8282.93695    4  366 -1074.6708 9880.48079  1019%  9553  780s
    16    34 8267.69760    4  393 -1074.6708 9767.62346  1009% 13233  795s
    33    49 7246.54507    4  346 -1074.6708 9353.82402   970% 13325  835s
    48    79 8270.66504    5  535 -1074.6708 9353.82402   970% 16356  862s
    78   199 8001.58009    6  484 -1074.6708 9353.82402   970% 14788  892s
   198   231 7496.04461   10  451 -1074.6708 9353.82402   970%  7548  909s
   230   268 7285.91543   11  391 -1074.6708 9353.82402   970%  6992  927s
   271   295 7283.37819   12  388 -1074.6708 9353.82402   970%  6392  944s
   298   315 7208.45416   13  440 -1074.6708 9353.82402   970%  6246  964s
   323   341 6007.24048   14  373 -1074.6708 9353.82402   970%  6233  990s
   363   379 5999.05575   15  368 -1074.6708 9353.82402   970%  5897 1009s
   409   396 5222.78743   16  343 -1074.6708 9353.82402   970%  5522 1033s
   459   419 -482.14862   14  180 -1074.6708 9353.82402   970%  5341 1054s
   498   419     cutoff   15      -1074.6708 9353.82402   970%  5253 1078s
   539   437 6014.95653   12  335 -1074.6708 9353.82402   970%  5144 1099s
   576   471 -294.02029   19  152 -1074.6708 9353.82402   970%  5125 1123s
   631   484 -362.58150   20  150 -1074.6708 9353.82402   970%  5015 1143s
   689   496     cutoff   20      -1074.6708 9353.82402   970%  4845 1165s
   749   507 -835.33942   22  128 -1074.6708 9353.82402   970%  4727 1185s
   805   514 -970.41284   23   94 -1074.6708 9353.82402   970%  4665 1203s
   844   530 -960.05118   22  124 -1074.6708 9353.82402   970%  4645 1223s
   898   543     cutoff   24      -1074.6708 9353.82402   970%  4584 1247s
   931   570 3774.75812   11  214 -1074.6708 9353.82402   970%  4637 1271s
H  954   570                    -1072.734574 9353.82402   972%  4664 1271s
   978   604 4547.37929   20  472 -1072.7346 9353.82402   972%  4657 1299s
  1022   634 1150.78596   12  169 -1072.7346 9353.82402   972%  4698 1323s
H 1058   634                    -997.2809276 9353.82402  1038%  4654 1323s
  1082   655  916.97765   13  160 -997.28093 9353.82402  1038%  4653 1346s
  1135   680  233.12042   14  150 -997.28093 9353.82402  1038%  4588 1369s
  1194   716  251.34486   15  107 -997.28093 9353.82402  1038%  4564 1397s
  1264   759 -300.80841   16   85 -997.28093 9353.82402  1038%  4494 1425s
  1331   858 -312.80524   17   74 -997.28093 9353.82402  1038%  4442 1451s
  1443   983     cutoff   23      -997.28093 9353.82402  1038%  4321 1481s
  1591  1096 1331.22301   37  423 -997.28093 9353.82402  1038%  4157 1509s
  1728  1199 1291.26035   39  358 -997.28093 9353.82402  1038%  4044 1540s
  1872  1318 1014.88196   42  489 -997.28093 9353.82402  1038%  3946 1569s
  2046  1458  865.99899   45  458 -997.28093 9353.82402  1038%  3801 1600s
  2248  1562 infeasible   58      -997.28093 9353.82402  1038%  3648 1631s
  2444  1659 -821.67785   67  141 -997.28093 9353.82402  1038%  3526 1663s
  2604  1822 7036.28338    9  493 -997.28093 9353.82402  1038%  3483 1693s
  2827  1896 5844.61206   11  353 -997.28093 9353.82402  1038%  3379 1726s
  3007  1907 4911.23639   14  402 -997.28093 8806.06638   983%  3331 1755s
H 3021  1907                    -972.5295769 8806.06638  1005%  3332 1755s
  3051  1947 4863.49646   15  344 -972.52958 8806.06638  1005%  3351 1793s
  3242  1962 4455.44395   18  461 -972.52958 8806.06638  1005%  3307 1828s
  3279  1986 4348.89004   19  448 -972.52958 8806.06638  1005%  3348 1863s
  3332  2004 4277.31402   20  457 -972.52958 8733.83418   998%  3368 1898s
  3386  2020 4168.66276   21  443 -972.52958 7729.28201   895%  3403 1937s
  3434  2058 4141.36036   22  449 -972.52958 7729.28201   895%  3430 1974s
  3482  2111 4086.08509   23  445 -972.52958 7596.38609   881%  3458 2011s
  3565  2174 3982.94956   24  405 -972.52958 7488.84445   870%  3494 2052s
  3685  2222 3143.00717   25  422 -972.52958 7488.84445   870%  3528 2096s
  3792  2266 2801.35870   27  382 -972.52958 7398.28740   861%  3536 2153s
  3955  2362 1927.81187   32  267 -972.52958 7313.52862   852%  3557 2209s
H 4113  2404                    -967.4096377 7313.52862   856%  3581 2257s
  4199  2475     cutoff   54      -967.40964 7313.52862   856%  3604 2316s
  4362  2616   -0.97278   71  224 -967.40964 7169.73013   841%  3630 2383s
  4553  2617 -433.97081   74  349 -967.40964 7152.39580   839%  3656 2569s
  4555  2618 3622.01219   30  128 -967.40964 7152.39580   839%  3654 2580s
  4556  2619 6236.77734   13  306 -967.40964 7152.39580   839%  3654 2657s
  4557  2620 4567.43034   20  327 -967.40964 7152.39580   839%  3653 2701s
  4558  2620 -393.04860   32  415 -967.40964 7152.39580   839%  3652 2732s
  4559  2621 6285.38308   13  507 -967.40964 7152.39580   839%  3651 2753s
  4560  2622 2425.85333   12  475 -967.40964 7152.39580   839%  3650 2765s
  4561  2622 4049.56159   22  501 -967.40964 7152.39580   839%  3650 2776s
  4562  2623 1973.53102   70  504 -967.40964 7152.39580   839%  3649 2784s
  4563  2624 3891.93051   29  511 -967.40964 7152.39580   839%  3648 2791s
  4564  2624 4826.55431   10  526 -967.40964 7152.39580   839%  3647 2797s
  4565  2625  723.64416   17  501 -967.40964 7152.39580   839%  3646 2803s
  4566  2626 5443.06273   10  537 -967.40964 7152.39580   839%  3646 2808s
  4567  2626 4587.90978   20  333 -967.40964 7152.39580   839%  3645 2812s
  4568  2627 5545.43792   13  333 -967.40964 7152.39580   839%  3644 2817s
  4569  2628 4392.14417   21  342 -967.40964 7152.39580   839%  3643 2821s
  4570  2628 -695.71408   97  516 -967.40964 7152.39580   839%  3642 2835s
  4572  2630 1560.96489   68  502 -967.40964 7152.39580   839%  3641 2846s
  4573  2630 4004.57272   26  538 -967.40964 7152.39580   839%  3640 2857s
  4574  2631 2756.65180   39  403 -967.40964 7152.39580   839%  3639 2862s
  4575  2632 1064.46681   15  395 -967.40964 7152.39580   839%  3638 2869s
  4576  2632 3033.56354   36  396 -967.40964 7152.39580   839%  3638 2872s
  4577  2633  168.84239   66  461 -967.40964 7152.39580   839%  3637 2879s
  4578  2634  248.01583   63  395 -967.40964 7152.39580   839%  3636 2884s
  4579  2634 6685.26490   11  396 -967.40964 7152.39580   839%  3635 2896s
  4581  2636  374.50070   36  438 -967.40964 7152.39580   839%  3634 2908s
  4582  2636 2330.32051   55  519 -967.40964 7152.39580   839%  3633 2917s
  4583  2637 2180.93623   35  516 -967.40964 7152.39580   839%  3632 2932s
H 4583  2504                    -961.3452693 7152.39580   844%  3632 2935s
  4585  2505 2038.27207   18  463 -961.34527 7152.39580   844%  3630 2947s
  4586  2506 5007.98073   11  409 -961.34527 7152.39580   844%  3630 2953s
  4587  2507 -371.21570   22  362 -961.34527 7152.39580   844%  3629 2960s
  4588  2507 4905.22215   15  362 -961.34527 7152.39580   844%  3628 2972s
  4589  2508 -407.76055   18  362 -961.34527 7152.39580   844%  3627 3028s
  4590  2512 7152.39580   16  564 -961.34527 7152.39580   844%  3708 3097s
  4592  2515 7152.39580   17  601 -961.34527 7152.39580   844%  3710 3130s
  4596  2522 7152.39580   18  427 -961.34527 7152.39580   844%  3712 3164s
  4604  2535 7152.39580   19  453 -961.34527 7152.39580   844%  3736 3210s
  4620  2546 7152.39580   20  434 -961.34527 7152.39580   844%  3774 3278s
  4636  2572 5747.93007   21  278 -961.34527 7152.39580   844%  3849 3307s
  4668  2645 5493.87530   22  268 -961.34527 7152.39580   844%  3932 3354s
  4751  2660 5403.38105   23  270 -961.34527 7152.39580   844%  3976 3386s
  4804  2663 4545.03156   25  232 -961.34527 7152.39580   844%  3999 3414s
  4835  2677 4499.76754   26  264 -961.34527 7152.39580   844%  4009 3446s
  4866  2681 4545.13235   25  237 -961.34527 7152.39580   844%  4022 3485s
  4898  2678 4412.78664   26  261 -961.34527 7152.39580   844%  4034 3521s
  4933  2672 -592.78800   31  158 -961.34527 7152.39580   844%  4054 3567s
  4979  2659 3658.85914   26  230 -961.34527 7152.39580   844%  4066 3600s

Cutting planes:
  Learned: 1
  Gomory: 18
  Implied bound: 13
  Projected implied bound: 129
  MIR: 1380
  Mixing: 4
  Flow cover: 2030
  RLT: 19
  Relax-and-lift: 309

Explored 5013 nodes (20983118 simplex iterations) in 3600.04 seconds (7960.44 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -961.345 -967.41 -972.53 ... -1845.92

Time limit reached
Best objective -9.613452693278e+02, best bound 7.152395795150e+03, gap 843.9986%
  WARNING: Time limit reached. Using best solution found (gap: 844.00%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.05s
  Master Objective (UB) = -961.35, θ = 141575.38
  Upper Bound (UB) = -961.35

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 141575.38
  [DEBUG]   ✓ Scenario 0: θ = 141575.38 ≤ Q = 141575.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 141575.38 ≤ Q = 141575.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 141575.38 ≤ Q = 141575.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 141575.38 ≤ Q = 141575.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 141575.38 ≤ Q = 141575.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 141575.38 ≤ Q = 141575.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 141575.38 ≤ Q = 141575.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 141575.38 ≤ Q = 141575.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 141575.38 ≤ Q = 141575.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 141575.38 ≤ Q = 141575.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 141575.38 ≤ Q = 141575.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 141575.38 ≤ Q = 141575.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 141575.38 ≤ Q = 141575.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 141575.38 ≤ Q = 141575.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 141575.38 ≤ Q = 141575.38 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 15] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x5848d2cf
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x5848d2cf
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.158329e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.00s
Presolved: 494 rows, 498 columns, 1393 nonzeros
Found heuristic solution: objective 5742288.8924
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.293485e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -129348.50    0  123 5742288.89 -129348.50   102%     -    0s
H    0     0                    -97275.87849 -129348.50  33.0%     -    0s
H    0     0                    -97893.45746 -129348.50  32.1%     -    0s
     0     0 -110230.68    0  108 -97893.457 -110230.68  12.6%     -    0s
H    0     0                    -105999.4388 -110085.86  3.86%     -    0s
     0     0 -109262.30    0  108 -105999.44 -109262.30  3.08%     -    0s
H    0     0                    -107903.9947 -109252.08  1.25%     -    0s
     0     0 -108771.62    0   44 -107903.99 -108771.62  0.80%     -    0s
     0     0 -108663.85    0   97 -107903.99 -108663.85  0.70%     -    0s
     0     0 -108599.79    0  100 -107903.99 -108599.79  0.64%     -    0s
     0     0 -108550.57    0   99 -107903.99 -108550.57  0.60%     -    0s
     0     0 -108550.47    0   99 -107903.99 -108550.47  0.60%     -    0s
     0     0 -108340.50    0   55 -107903.99 -108340.50  0.40%     -    0s
     0     0 -108263.45    0   52 -107903.99 -108263.45  0.33%     -    0s
     0     0 -108263.45    0   54 -107903.99 -108263.45  0.33%     -    0s
     0     0 -108251.03    0   52 -107903.99 -108251.03  0.32%     -    0s
     0     0 -108231.94    0   52 -107903.99 -108231.94  0.30%     -    0s
     0     0 -108231.94    0   65 -107903.99 -108231.94  0.30%     -    0s
     0     0 -108231.94    0   48 -107903.99 -108231.94  0.30%     -    0s
     0     0 -108231.94    0   47 -107903.99 -108231.94  0.30%     -    0s
     0     0 -108219.90    0   47 -107903.99 -108219.90  0.29%     -    0s
     0     0 -108210.89    0   47 -107903.99 -108210.89  0.28%     -    0s
     0     0 -108182.88    0   47 -107903.99 -108182.88  0.26%     -    0s
     0     0 -108177.93    0   47 -107903.99 -108177.93  0.25%     -    0s
     0     0 -108171.61    0    3 -107903.99 -108171.61  0.25%     -    0s
H    0     0                    -108163.0119 -108166.42  0.00%     -    0s

Cutting planes:
  Gomory: 21
  Implied bound: 6
  MIR: 69
  Flow cover: 13
  RLT: 1

Explored 1 nodes (1107 simplex iterations) in 0.14 seconds (0.07 work units)
Thread count was 32 (of 256 available processors)

Solution count 7: -108163 -107904 -105999 ... 1.15833e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.081630118539e+05, best bound -1.081664164078e+05, gap 0.0031%
  Subproblem solved in 0.15s
  Worst-case operational profit (Z_SP) = 133297.41
  Scenario: 24 demand increases, 36 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -108163.01
  [DEBUG]   S×d_nominal = 241460.42
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 241460.42 + -108163.01 = 133297.41
  [DEBUG]   Current θ from Master = 141575.38
  [DEBUG]   ⚠️  Z_SP ≤ θ by 8277.98 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -9239.32
  Lower Bound (LB) = -1589.09
  Gap (UB-LB) = 627.7439, Absolute Gap = 627.7439, Relative Gap = 0.652985
  Not converged yet (gap = 627.74 > ε = 200)

  [DEBUG] Adding NEW scenario 15 to Master Problem...
  [DEBUG] New scenario pattern: 24 increases, 36 decreases
    [DEBUG] Scenario 15 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 15 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 15]
    [DEBUG]   - Total constraints in model: 246023
    [DEBUG]   - Total variables in model: 102100
  [DEBUG] Total scenarios in Master: 16
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 16
================================================================================
[Iteration 16] Solving Master Problem...
  Current scenarios in Master: 16
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 246023 rows, 102100 columns and 697215 nonzeros
Model fingerprint: 0x67d2b389
Variable types: 99841 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 113120 rows and 45920 columns
Presolve time: 2.00s
Presolved: 132903 rows, 56180 columns, 818666 nonzeros
Variable types: 53921 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -373468.8541
Found heuristic solution: objective -219438.1934

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.01s

Barrier statistics:
 Dense cols : 602
 AA' NZ     : 6.839e+06
 Factor NZ  : 1.484e+07 (roughly 200 MB of memory)
 Factor Ops : 3.205e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.60472414e+07  2.16325821e+08  9.08e+04 1.85e+01  6.84e+04     4s
   1  -1.24837409e+07  1.89329360e+08  6.50e+04 5.30e+01  4.83e+04     4s
   2  -5.52476725e+06  1.49675153e+08  2.78e+04 3.37e-01  2.17e+04     4s
   3  -8.89835434e+05  1.08309194e+08  2.03e+03 1.45e+00  1.94e+03     4s
   4  -5.07873175e+05  3.84472522e+07  3.83e+02 1.56e-01  4.05e+02     4s
   5  -4.33825732e+05  2.51055151e+07  2.08e+02 8.62e-02  2.27e+02     5s
   6  -3.41770727e+05  1.96479471e+07  9.25e+01 6.06e-02  1.33e+02     5s
   7  -2.46269476e+05  1.52613315e+07  4.91e+01 4.39e-02  8.81e+01     5s
   8  -1.70921344e+05  1.08363043e+07  2.25e+01 2.91e-02  5.44e+01     5s
   9  -1.46219355e+05  8.24118999e+06  1.66e+01 2.15e-02  4.00e+01     5s
  10  -1.18491333e+05  6.05076996e+06  6.65e+00 1.52e-02  2.71e+01     5s
  11  -9.45040219e+04  7.23442558e+05  1.88e+00 1.20e-03  3.47e+00     5s
  12  -6.59736257e+04  3.51861459e+05  9.96e-01 6.62e-04  1.75e+00     5s
  13  -4.21854965e+04  1.86159478e+05  5.60e-01 7.29e-04  9.51e-01     5s
  14  -2.93019195e+04  1.46433228e+05  4.29e-01 8.59e-04  7.31e-01     5s
  15  -2.27256318e+04  1.12375451e+05  3.65e-01 1.34e-03  5.62e-01     5s
  16  -1.82181403e+04  1.00259754e+05  3.27e-01 1.20e-03  4.93e-01     5s
  17  -1.09193390e+04  8.23157163e+04  2.64e-01 1.79e-03  3.88e-01     5s
  18  -1.52703155e+03  7.03670709e+04  1.84e-01 1.53e-03  2.98e-01     5s
  19   1.94685166e+03  6.01932865e+04  1.56e-01 1.31e-03  2.42e-01     5s
  20   5.68621212e+03  4.86691719e+04  1.28e-01 1.53e-03  1.79e-01     5s
  21   8.07775380e+03  4.20648856e+04  1.11e-01 1.51e-03  1.41e-01     5s
  22   1.02881041e+04  3.81320675e+04  9.71e-02 1.81e-03  1.16e-01     5s
  23   1.19384369e+04  3.60929761e+04  8.59e-02 1.22e-03  1.00e-01     5s
  24   1.45661384e+04  3.54043732e+04  6.90e-02 1.21e-03  8.66e-02     5s
  25   1.67721947e+04  3.32561114e+04  5.62e-02 1.60e-03  6.85e-02     5s
  26   1.77137144e+04  3.15493725e+04  5.07e-02 1.37e-03  5.76e-02     6s
  27   2.00415813e+04  3.10980001e+04  3.79e-02 1.37e-03  4.60e-02     6s
  28   2.02711352e+04  3.07959778e+04  3.67e-02 1.43e-03  4.38e-02     6s
  29   2.06028198e+04  2.97758627e+04  3.47e-02 1.24e-03  3.82e-02     6s
  30   2.14206048e+04  2.93956885e+04  3.04e-02 1.04e-03  3.32e-02     6s
  31   2.19965162e+04  2.91142659e+04  2.74e-02 9.05e-04  2.96e-02     6s
  32   2.25371435e+04  2.88906878e+04  2.46e-02 7.88e-04  2.64e-02     6s
  33   2.29561614e+04  2.87622416e+04  2.25e-02 7.22e-04  2.42e-02     6s
  34   2.32118168e+04  2.87024305e+04  2.11e-02 6.91e-04  2.29e-02     6s
  35   2.38497463e+04  2.85006216e+04  1.79e-02 5.72e-04  1.94e-02     6s
  36   2.46244786e+04  2.83187642e+04  1.38e-02 4.57e-04  1.54e-02     6s
  37   2.52261868e+04  2.79241375e+04  1.08e-02 1.16e-03  1.12e-02     6s
  38   2.63095717e+04  2.77216290e+04  5.53e-03 9.26e-04  5.88e-03     6s
  39   2.69269404e+04  2.76349755e+04  2.62e-03 5.59e-04  2.95e-03     6s
  40   2.70580112e+04  2.75895085e+04  1.99e-03 3.73e-04  2.21e-03     6s
  41   2.71723970e+04  2.75784968e+04  1.43e-03 3.31e-04  1.69e-03     6s
  42   2.73448722e+04  2.75326143e+04  6.34e-04 1.47e-04  7.80e-04     6s
  43   2.74199221e+04  2.75115497e+04  3.09e-04 6.79e-05  3.81e-04     6s
  44   2.74447993e+04  2.75047535e+04  2.00e-04 4.03e-05  2.49e-04     6s
  45   2.74532314e+04  2.75008750e+04  1.63e-04 2.78e-05  1.98e-04     7s
  46   2.74759260e+04  2.74973048e+04  6.60e-05 1.62e-05  8.88e-05     7s
  47   2.74789309e+04  2.74965228e+04  5.30e-05 1.37e-05  7.31e-05     7s
  48   2.74794470e+04  2.74940146e+04  5.09e-05 5.83e-06  6.06e-05     7s
  49   2.74900031e+04  2.74933405e+04  8.43e-06 3.68e-06  1.38e-05     7s
  50   2.74904833e+04  2.74932526e+04  6.49e-06 3.39e-06  1.15e-05     7s
  51   2.74908279e+04  2.74930031e+04  5.18e-06 2.62e-06  9.02e-06     7s
  52   2.74915937e+04  2.74929025e+04  2.10e-06 2.27e-06  5.42e-06     7s
  53   2.74921059e+04  2.74924016e+04  2.52e-07 6.41e-07  1.22e-06     7s
  54   2.74921742e+04  2.74923185e+04  4.27e-08 3.87e-07  5.95e-07     7s
  55   2.74921902e+04  2.74922208e+04  3.89e-09 8.61e-08  1.26e-07     7s
  56   2.74921922e+04  2.74921924e+04  2.15e-09 4.00e-10  1.09e-09     7s

Barrier solved model in 56 iterations and 7.29 seconds (14.15 work units)
Optimal objective 2.74921922e+04


Root crossover log...

  119963 DPushes remaining with DInf 0.0000000e+00                 7s
    2363 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                11s

    9253 PPushes remaining with PInf 6.7422780e-05                11s
       0 PPushes remaining with PInf 0.0000000e+00                11s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.2453197e+03     11s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   67119    2.7492192e+04   0.000000e+00   2.245320e+03     11s
   67529    2.7492192e+04   0.000000e+00   0.000000e+00     12s
   67529    2.7492192e+04   0.000000e+00   0.000000e+00     12s
Concurrent spin time: 4.61s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 2.749219e+04, 67529 iterations, 13.65 seconds (20.98 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 27492.1923    0  137 -219438.19 27492.1923   113%     -   16s
H    0     0                    -202374.2611 27492.1923   114%     -   17s
H    0     0                    -201813.2535 27492.1923   114%     -   17s
H    0     0                    -183791.7419 27492.1923   115%     -   17s
H    0     0                    -183354.7795 27492.1923   115%     -   18s
H    0     0                    -183273.8502 27492.1923   115%     -   18s
H    0     0                    -182998.4332 27492.1923   115%     -   18s
H    0     0                    -71394.31792 27492.1923   139%     -   18s
H    0     0                    -10517.04225 27492.1923   361%     -   18s
H    0     0                    -2438.577382 27492.1923  1227%     -   18s
H    0     0                    -1638.771660 27492.1923  1778%     -   18s
H    0     0                    -1457.229248 27492.1923  1987%     -   19s
H    0     0                    -1215.581857 27492.1923  2362%     -   19s
     0     0 21410.8777    0  238 -1215.5819 21410.8777  1861%     -   53s
H    0     0                    -1146.937067 21407.8318  1967%     -   53s
     0     0 21093.6289    0  258 -1146.9371 21093.6289  1939%     -   68s
     0     0 21008.4934    0  268 -1146.9371 21008.4934  1932%     -   72s
     0     0 21007.9520    0  266 -1146.9371 21007.9520  1932%     -   72s
     0     0 17992.7189    0  222 -1146.9371 17992.7189  1669%     -   99s
     0     0 17490.3371    0  240 -1146.9371 17490.3371  1625%     -  111s
     0     0 17426.2076    0  243 -1146.9371 17426.2076  1619%     -  116s
     0     0 17363.5216    0  240 -1146.9371 17363.5216  1614%     -  120s
     0     0 17360.0598    0  246 -1146.9371 17360.0598  1614%     -  121s
     0     0 17337.7632    0  245 -1146.9371 17337.7632  1612%     -  123s
     0     0 17246.2754    0  319 -1146.9371 17246.2754  1604%     -  129s
     0     0 17189.7788    0  227 -1146.9371 17189.7788  1599%     -  132s
     0     0 16953.3645    0  231 -1146.9371 16953.3645  1578%     -  139s
     0     0 16953.0309    0  228 -1146.9371 16953.0309  1578%     -  141s
     0     0 14097.5613    0  331 -1146.9371 14097.5613  1329%     -  172s
H    0     0                    -1145.744138 14097.4504  1330%     -  173s
H    0     0                    -1134.629357 14097.4504  1342%     -  173s
H    0     0                    -1131.755925 14097.4504  1346%     -  173s
     0     0 13539.8743    0  420 -1131.7559 13539.8743  1296%     -  187s
     0     0 13293.9531    0  421 -1131.7559 13293.9531  1275%     -  198s
     0     0 13103.9890    0  422 -1131.7559 13103.9890  1258%     -  208s
     0     0 13012.1022    0  438 -1131.7559 13012.1022  1250%     -  213s
     0     0 12984.1996    0  434 -1131.7559 12984.1996  1247%     -  217s
     0     0 12900.6931    0  477 -1131.7559 12900.6931  1240%     -  222s
     0     0 12864.3010    0  476 -1131.7559 12864.3010  1237%     -  225s
     0     0 12862.5939    0  486 -1131.7559 12862.5939  1237%     -  226s
     0     0 11373.8171    0  443 -1131.7559 11373.8171  1105%     -  253s
     0     0 11147.9802    0  469 -1131.7559 11147.9802  1085%     -  265s
     0     0 11056.9989    0  409 -1131.7559 11056.9989  1077%     -  272s
     0     0 10900.7410    0  418 -1131.7559 10900.7410  1063%     -  280s
     0     0 10866.3841    0  475 -1131.7559 10866.3841  1060%     -  284s
     0     0 10842.2659    0  468 -1131.7559 10842.2659  1058%     -  288s
     0     0 10826.5529    0  417 -1131.7559 10826.5529  1057%     -  291s
     0     0 10790.8842    0  419 -1131.7559 10790.8842  1053%     -  293s
     0     0 10781.3394    0  413 -1131.7559 10781.3394  1053%     -  295s
     0     0 10780.6002    0  419 -1131.7559 10780.6002  1053%     -  296s
     0     0 10637.4063    0  488 -1131.7559 10637.4063  1040%     -  306s
     0     0 10594.8408    0  525 -1131.7559 10594.8408  1036%     -  313s
     0     0 10580.7035    0  471 -1131.7559 10580.7035  1035%     -  315s
     0     0 10564.0243    0  469 -1131.7559 10564.0243  1033%     -  319s
     0     0 10551.1097    0  456 -1131.7559 10551.1097  1032%     -  322s
     0     0 10547.2153    0  476 -1131.7559 10547.2153  1032%     -  323s
     0     0 10536.9663    0  463 -1131.7559 10536.9663  1031%     -  324s
     0     0 10526.6498    0  455 -1131.7559 10526.6498  1030%     -  325s
     0     0 10508.7493    0  463 -1131.7559 10508.7493  1029%     -  327s
     0     0 10484.5212    0  473 -1131.7559 10484.5212  1026%     -  330s
     0     0 10476.5186    0  477 -1131.7559 10476.5186  1026%     -  332s
     0     0 10475.1987    0  527 -1131.7559 10475.1987  1026%     -  333s
     0     0 10370.9742    0  417 -1131.7559 10370.9742  1016%     -  343s
H    0     0                    -1091.432085 10370.7829  1050%     -  351s
     0     0 10325.4296    0  588 -1091.4321 10325.4296  1046%     -  358s
     0     0 10307.0036    0  537 -1091.4321 10307.0036  1044%     -  361s
     0     0 10305.2938    0  537 -1091.4321 10305.2938  1044%     -  362s
     0     0 10267.9805    0  416 -1091.4321 10267.9805  1041%     -  367s
     0     0 10255.9803    0  426 -1091.4321 10255.9803  1040%     -  370s
     0     0 10246.2452    0  415 -1091.4321 10246.2452  1039%     -  372s
     0     0 10245.2702    0  417 -1091.4321 10245.2702  1039%     -  373s
     0     0 10240.8562    0  400 -1091.4321 10240.8562  1038%     -  375s
H    0     0                    -1074.670836 10240.6528  1053%     -  383s
     0     0 10235.8626    0  416 -1074.6708 10235.8626  1052%     -  388s
     0     0 10233.8323    0  419 -1074.6708 10233.8323  1052%     -  391s
     0     0 10230.4823    0  540 -1074.6708 10230.4823  1052%     -  395s
     0     0 10229.3558    0  333 -1074.6708 10229.3558  1052%     -  397s
     0     0 10223.6888    0  404 -1074.6708 10223.6888  1051%     -  401s
     0     0 10222.9460    0  323 -1074.6708 10222.9460  1051%     -  403s
     0     0 10220.3823    0  501 -1074.6708 10220.3823  1051%     -  406s
     0     0 10219.9700    0  501 -1074.6708 10219.9700  1051%     -  408s
     0     2 10218.8452    0  501 -1074.6708 10218.8452  1051%     -  478s
     1     3 9189.90576    1  461 -1074.6708 10218.8452  1051%  8005  490s
     2     4 10083.1735    1  477 -1074.6708 10083.1735  1038%  6294  499s
     3     6 8493.06435    2  583 -1074.6708 10083.1566  1038%  8298  509s
     5    12 6385.93736    3  277 -1074.6708 10083.1566  1038%  8553  519s
    11    24 6273.28367    4  271 -1074.6708 9841.25467  1016%  8811  535s
    23    36 7333.50250    4  274 -1074.6708 9742.19813  1007% 14159  578s
    35    68 7414.44243    6  509 -1074.6708 9742.19813  1007% 16503  706s
    67   109 7393.31071    7  502 -1074.6708 9166.85247   953% 21215  740s
   110   190 7281.65627    8  447 -1074.6708 9166.85247   953% 16228  767s
   195   265 7149.97864    9  481 -1074.6708 9166.85247   953% 11061  792s
   280   320 6674.24059   11  453 -1074.6708 9166.85247   953%  9153  813s
   348   364 5152.04527   11  328 -1074.6708 9166.85247   953%  8551  831s
   412   387 6086.24438   12  298 -1074.6708 9118.48653   948%  8493  850s
   444   412 6049.26993   13  311 -1074.6708 9118.48653   948%  8532  865s
   481   441 5879.30971   14  303 -1074.6708 9118.48653   948%  8335  882s
   530   483 5312.47924   15  260 -1074.6708 9118.48653   948%  8404  897s
   579   524 4970.52310   16  374 -1074.6708 9118.48653   948%  8339  911s
   631   564 4846.83517   17  371 -1074.6708 9118.48653   948%  8152  926s
   685   590 4846.13218   18  369 -1074.6708 9118.48653   948%  7824  941s
   736   625 4099.99773   19  249 -1074.6708 8784.04795   917%  7600  957s
   789   644 3885.18645   20  248 -1074.6708 8784.04795   917%  7452  974s
   848   676 3733.52210   21  289 -1074.6708 8784.04795   917%  7249  989s
   916   717 3645.89391   22  297 -1074.6708 8631.34767   903%  7066 1006s
   976   752 3480.58807   23  295 -1074.6708 8631.34767   903%  7060 1022s
  1042   794 3128.29024   24  288 -1074.6708 8631.34767   903%  7007 1038s
  1101   844 3051.04679   25  249 -1074.6708 8631.34767   903%  6905 1057s
  1163   903 2981.59117   26  235 -1074.6708 8631.34767   903%  6818 1071s
  1244   953 2859.21059   27  246 -1074.6708 8631.34767   903%  6679 1089s
  1347   993 2764.79168   28  273 -1074.6708 8631.34767   903%  6455 1108s
  1458  1049 2625.90629   30  226 -1074.6708 8631.34767   903%  6257 1130s
  1565  1118  791.33253   35  257 -1074.6708 8631.34767   903%  6122 1151s
  1678  1199  494.65146   39  232 -1074.6708 8631.34767   903%  6024 1172s
  1802  1275   52.35283   46  167 -1074.6708 8631.34767   903%  5922 1196s
  1941  1350 -849.78919   56  128 -1074.6708 8631.34767   903%  5825 1219s
  2086  1425  451.60501   11  454 -1074.6708 8631.34767   903%  5785 1246s
  2213  1491 7321.18490    8  507 -1074.6708 8631.34767   903%  5824 1272s
  2347  1543 6136.53828   12  406 -1074.6708 8631.34767   903%  5827 1301s
  2468  1605 5778.11247   14  326 -1074.6708 8631.34767   903%  5905 1329s
  2564  1665 4216.00264   17  345 -1074.6708 8631.34767   903%  6045 1358s
  2650  1756 4164.42459   18  340 -1074.6708 8631.34767   903%  6166 1388s
  2787  1886 3658.77569   22  239 -1074.6708 8579.22891   898%  6224 1419s
  2980  1961 3264.90751   26  283 -1074.6708 8579.22891   898%  6208 1453s
  3159  2062 2612.47233   35  205 -1074.6708 7795.40851   825%  6220 1492s
  3324  2181  825.37318   48   96 -1074.6708 7293.87560   779%  6258 1529s
  3499  2248  162.24207   68   73 -1074.6708 7236.57610   773%  6293 1570s
  3702  2371     cutoff   42      -1074.6708 7132.89330   764%  6324 1610s
  3877  2491 3165.27524   12  356 -1074.6708 7125.35053   763%  6411 1646s
  4059  2492 6488.73382   11  501 -1074.6708 7125.35053   763%  6472 1851s
  4061  2493 4506.13377   23  124 -1074.6708 7125.35053   763%  6469 1865s
  4062  2494 1298.74564   40  343 -1074.6708 7125.35053   763%  6468 1918s
  4063  2495 3930.48387   18  322 -1074.6708 7125.35053   763%  6466 1980s
  4064  2495 2846.50115   41  411 -1074.6708 7125.35053   763%  6464 2024s
  4065  2496 2604.62923   31  368 -1074.6708 7125.35053   763%  6463 2057s
  4066  2497 -470.00183   18  490 -1074.6708 7125.35053   763%  6461 2069s
  4067  2497  828.03092   23  509 -1074.6708 7125.35053   763%  6460 2092s
  4068  2498 -611.73128   44  505 -1074.6708 7125.35053   763%  6458 2102s
  4069  2499 1191.21368   23  513 -1074.6708 7125.35053   763%  6456 2114s
  4070  2499 5742.44892   10  388 -1074.6708 7125.35053   763%  6455 2120s
  4071  2500  823.18373   49  431 -1074.6708 7125.35053   763%  6453 2125s
  4073  2501 2563.60852   15  476 -1074.6708 7125.35053   763%  6450 2133s
  4074  2502 -279.95211   28  418 -1074.6708 7125.35053   763%  6449 2136s
  4075  2503 -227.03884   71  531 -1074.6708 7125.35053   763%  6447 2151s
  4076  2503 4845.02508   19  473 -1074.6708 7125.35053   763%  6445 2160s
  4078  2505 1151.59298   34  387 -1074.6708 7125.35053   763%  6442 2172s
  4079  2505 1872.83151   16  447 -1074.6708 7125.35053   763%  6441 2180s
  4080  2506  452.96527   21  460 -1074.6708 7125.35053   763%  6439 2188s
  4081  2507 4895.98120   19  466 -1074.6708 7125.35053   763%  6437 2193s
  4082  2507  792.90073   31  470 -1074.6708 7125.35053   763%  6436 2200s
  4084  2509 -679.28162   77  523 -1074.6708 7125.35053   763%  6433 2218s
  4085  2509 3873.71084   14  475 -1074.6708 7125.35053   763%  6431 2224s
  4086  2510 1070.15803   22  376 -1074.6708 7125.35053   763%  6430 2230s
  4087  2511 3978.56748   19  473 -1074.6708 7125.35053   763%  6428 2237s
  4089  2512 4786.18777   12  475 -1074.6708 7125.35053   763%  6425 2250s
  4090  2513 -536.91650   71  483 -1074.6708 7125.35053   763%  6423 2255s
  4091  2513   -0.92865   45  389 -1074.6708 7125.35053   763%  6422 2263s
  4092  2514 -331.33252   55  494 -1074.6708 7125.35053   763%  6420 2267s
  4093  2515 1341.19562   42  378 -1074.6708 7125.35053   763%  6419 2274s
  4094  2515 2281.99482   26  378 -1074.6708 7125.35053   763%  6417 2287s
  4095  2516  311.92364   37  378 -1074.6708 7125.35053   763%  6415 2338s
  4096  2520 7125.35053   10  474 -1074.6708 7125.35053   763%  6503 2413s
  4098  2523 7125.35053   11  463 -1074.6708 7125.35053   763%  6506 2457s
  4102  2530 7125.35053   12  527 -1074.6708 7125.35053   763%  6515 2512s
  4110  2543 7125.35053   13  528 -1074.6708 7125.35053   763%  6531 2564s
  4126  2554 7125.35053   14  514 -1074.6708 7125.35053   763%  6584 2643s
  4142  2579 7125.35053   15  448 -1074.6708 7125.35053   763%  6638 2691s
  4174  2683 7125.35053   16  456 -1074.6708 7125.35053   763%  6706 2752s
  4302  2668 6965.78507   20  356 -1074.6708 7125.35053   763%  6747 2783s
  4353  2657 7083.77616   19  434 -1074.6708 7125.35053   763%  6758 2813s
  4394  2649 6671.78090   18  375 -1074.6708 7125.35053   763%  6799 2851s
  4430  2653 6657.43652   21  405 -1074.6708 7125.35053   763%  6833 2878s
  4476  2656 3181.42860   23  322 -1074.6708 7125.35053   763%  6906 2904s
  4515  2661 5970.43393   22  386 -1074.6708 7125.35053   763%  6953 2935s
  4563  2656 5721.15051   23  302 -1074.6708 7125.35053   763%  6978 2961s
  4608  2658 5025.35243   24  316 -1074.6708 7125.35053   763%  7013 2998s
  4658  2647 4672.98751   24  281 -1074.6708 7125.35053   763%  7033 3025s
  4711  2645 4628.46960   25  272 -1074.6708 7125.35053   763%  7064 3049s
  4761  2642 3017.52311   26  249 -1074.6708 7125.35053   763%  7089 3080s
  4823  2655 2610.67005   27  236 -1074.6708 7125.35053   763%  7119 3114s
  4890  2655 2350.12447   29  197 -1074.6708 7125.35053   763%  7147 3146s
  4946  2659 1683.89311   31  203 -1074.6708 7125.35053   763%  7195 3176s
  5006  2669 1156.85765   33  204 -1074.6708 7125.35053   763%  7240 3214s
  5082  2686  292.68490   35  219 -1074.6708 7125.35053   763%  7259 3243s
  5152  2683   28.15597   38  280 -1074.6708 7125.35053   763%  7304 3268s
  5193  2688  -24.85198   39  262 -1074.6708 7125.35053   763%  7311 3300s
  5267  2682 -841.64807   41  125 -1074.6708 7125.35053   763%  7325 3341s
  5336  2703 3955.14752   18  345 -1074.6708 7125.35053   763%  7354 3389s
H 5389  2559                    -996.6715593 7125.35053   815%  7333 3389s
  5426  2557  733.55562   19  297 -996.67156 7125.35053   815%  7369 3414s
H 5431  2436                    -967.4096377 7125.35053   837%  7367 3414s
  5465  2457 -198.46125   20  273 -967.40964 7125.35053   837%  7404 3454s
  5552  2449     cutoff   21      -967.40964 7125.35053   837%  7387 3489s
  5643  2455 -561.16763   21  250 -967.40964 7125.35053   837%  7436 3523s
  5723  2437     cutoff   22      -967.40964 7125.35053   837%  7471 3553s
  5765  2433 1670.98477   20  161 -967.40964 7125.35053   837%  7534 3589s
  5816  2421 3744.23517   21  392 -967.40964 7125.35053   837%  7572 3600s

Cutting planes:
  Learned: 2
  Gomory: 12
  Implied bound: 4
  Projected implied bound: 165
  MIR: 1426
  Mixing: 2
  Flow cover: 2519
  RLT: 28
  Relax-and-lift: 466

Explored 5834 nodes (44680309 simplex iterations) in 3600.06 seconds (9235.57 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -967.41 -996.672 -1074.67 ... -1457.23

Time limit reached
Best objective -9.674096376839e+02, best bound 7.125350532263e+03, gap 836.5391%
  WARNING: Time limit reached. Using best solution found (gap: 836.54%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = -967.41, θ = 141655.03
  Upper Bound (UB) = -967.41

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 141655.03
  [DEBUG]   ✓ Scenario 0: θ = 141655.03 ≤ Q = 141655.03 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 141655.03 ≤ Q = 141655.03 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 141655.03 ≤ Q = 141655.03 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 141655.03 ≤ Q = 141655.03 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 141655.03 ≤ Q = 141655.03 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 141655.03 ≤ Q = 141655.03 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 141655.03 ≤ Q = 141655.03 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 141655.03 ≤ Q = 141655.03 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 141655.03 ≤ Q = 141655.03 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 141655.03 ≤ Q = 141655.03 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 141655.03 ≤ Q = 141655.03 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 141655.03 ≤ Q = 141655.03 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 141655.03 ≤ Q = 141655.03 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 141655.03 ≤ Q = 141655.03 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 141655.03 ≤ Q = 141655.03 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 141655.03 ≤ Q = 141655.03 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 16] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x7139c2e
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xf8ec63d2
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.158329e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.00s
Presolved: 494 rows, 498 columns, 1393 nonzeros
Found heuristic solution: objective 5703384.7411
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.292604e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -129260.44    0  123 5703384.74 -129260.44   102%     -    0s
H    0     0                    -97208.13020 -129260.44  33.0%     -    0s
H    0     0                    -97825.70917 -129260.44  32.1%     -    0s
     0     0 -109938.86    0  107 -97825.709 -109938.86  12.4%     -    0s
H    0     0                    -105923.9952 -109907.58  3.76%     -    0s
H    0     0                    -107431.6195 -109907.58  2.30%     -    0s
     0     0 -109135.61    0  108 -107431.62 -109135.61  1.59%     -    0s
     0     0 -108535.37    0  104 -107431.62 -108535.37  1.03%     -    0s
H    0     0                    -107717.6147 -108485.09  0.71%     -    0s
H    0     0                    -107735.2081 -108447.74  0.66%     -    0s
     0     0 -108447.74    0   75 -107735.21 -108447.74  0.66%     -    0s
     0     0 -108430.94    0   85 -107735.21 -108430.94  0.65%     -    0s
     0     0 -108430.70    0   85 -107735.21 -108430.70  0.65%     -    0s
     0     0 -108037.37    0   73 -107735.21 -108037.37  0.28%     -    0s
     0     0 -108033.43    0   57 -107735.21 -108033.43  0.28%     -    0s
     0     0 -107988.79    0   59 -107735.21 -107988.79  0.24%     -    0s
     0     0 -107988.68    0   57 -107735.21 -107988.68  0.24%     -    0s
     0     0 -107962.09    0   68 -107735.21 -107962.09  0.21%     -    0s
     0     0 -107961.70    0   67 -107735.21 -107961.70  0.21%     -    0s
     0     0 -107955.31    0   55 -107735.21 -107955.31  0.20%     -    0s
     0     0 -107863.56    0   53 -107735.21 -107863.56  0.12%     -    0s
     0     0 -107863.56    0   48 -107735.21 -107863.56  0.12%     -    0s
     0     0 -107863.56    0   45 -107735.21 -107863.56  0.12%     -    0s
     0     0 -107863.56    0   45 -107735.21 -107863.56  0.12%     -    0s
H    0     0                    -107743.5580 -107863.56  0.11%     -    0s
     0     0 -107802.32    0   21 -107743.56 -107802.32  0.05%     -    0s
     0     0 -107760.85    0    5 -107743.56 -107760.85  0.02%     -    0s
     0     0          -    0      -107743.56 -107750.97  0.01%     -    0s

Cutting planes:
  Gomory: 13
  Implied bound: 19
  MIR: 39
  Flow cover: 16
  RLT: 1

Explored 1 nodes (1083 simplex iterations) in 0.14 seconds (0.05 work units)
Thread count was 32 (of 256 available processors)

Solution count 9: -107744 -107735 -107718 ... 1.15833e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.077435580498e+05, best bound -1.077509698232e+05, gap 0.0069%
  Subproblem solved in 0.16s
  Worst-case operational profit (Z_SP) = 133716.86
  Scenario: 48 demand increases, 12 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -107743.56
  [DEBUG]   S×d_nominal = 241460.42
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 241460.42 + -107743.56 = 133716.86
  [DEBUG]   Current θ from Master = 141655.03
  [DEBUG]   ⚠️  Z_SP ≤ θ by 7938.17 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -8905.58
  Lower Bound (LB) = -1589.09
  Gap (UB-LB) = 621.6795, Absolute Gap = 621.6795, Relative Gap = 0.642623
  Not converged yet (gap = 621.68 > ε = 200)

  [DEBUG] Adding NEW scenario 16 to Master Problem...
  [DEBUG] New scenario pattern: 48 increases, 12 decreases
    [DEBUG] Scenario 16 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 16 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 16]
    [DEBUG]   - Total constraints in model: 261313
    [DEBUG]   - Total variables in model: 108340
  [DEBUG] Total scenarios in Master: 17
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 17
================================================================================
[Iteration 17] Solving Master Problem...
  Current scenarios in Master: 17
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 261313 rows, 108340 columns and 740446 nonzeros
Model fingerprint: 0x65b4c7ce
Variable types: 106081 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 120190 rows and 48790 columns
Presolve time: 2.07s
Presolved: 141123 rows, 59550 columns, 868636 nonzeros
Variable types: 57291 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -372861.2647
Found heuristic solution: objective -219438.1934

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.40s

Barrier statistics:
 Dense cols : 597
 AA' NZ     : 7.657e+06
 Factor NZ  : 1.704e+07 (roughly 200 MB of memory)
 Factor Ops : 4.051e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.60714694e+07  2.28317236e+08  9.10e+04 1.79e+01  6.81e+04     4s
   1  -1.24584474e+07  1.99999828e+08  6.51e+04 5.08e+01  4.83e+04     4s
   2  -4.36801199e+06  1.61105631e+08  2.15e+04 4.55e+00  1.67e+04     4s
   3  -8.38506620e+05  1.12045027e+08  1.58e+03 2.05e+00  1.58e+03     4s
   4  -5.68139856e+05  5.77980983e+07  4.40e+02 8.06e-01  5.18e+02     4s
   5  -4.99109397e+05  3.80778884e+07  2.48e+02 4.57e-01  3.01e+02     4s
   6  -4.17404723e+05  2.96483316e+07  7.98e+01 3.32e-01  1.62e+02     4s
   7  -3.63538815e+05  2.22456360e+07  4.01e+01 2.37e-01  1.08e+02     4s
   8  -2.58727936e+05  1.67445142e+07  1.05e+01 1.71e-01  7.05e+01     4s
   9  -1.89988587e+05  1.11877005e+07  4.45e+00 1.12e-01  4.55e+01     4s
  10  -1.46912581e+05  8.16868486e+06  2.72e+00 8.10e-02  3.29e+01     4s
  11  -1.16098006e+05  2.68117241e+06  1.29e+00 2.53e-02  1.10e+01     4s
  12  -8.36419999e+04  1.41284635e+06  4.64e-01 1.38e-02  5.83e+00     5s
  13  -5.85425547e+04  5.12452049e+05  2.36e-01 5.15e-03  2.22e+00     5s
  14  -3.70002204e+04  2.94330023e+05  1.37e-01 2.94e-03  1.29e+00     5s
  15  -2.31919013e+04  2.18490267e+05  9.86e-02 2.20e-03  9.39e-01     5s
  16  -1.51477849e+04  1.54179728e+05  8.01e-02 2.36e-03  6.58e-01     5s
  17  -9.36459837e+03  1.34260235e+05  6.55e-02 2.11e-03  5.58e-01     5s
  18  -3.80402031e+03  1.14879184e+05  5.27e-02 1.91e-03  4.61e-01     5s
  19  -1.32815179e+03  8.51437595e+04  4.72e-02 1.77e-03  3.36e-01     5s
  20   4.77881475e+03  6.66504367e+04  3.49e-02 1.92e-03  2.41e-01     5s
  21   7.90598192e+03  5.52220140e+04  2.91e-02 1.38e-03  1.84e-01     5s
  22   1.04122835e+04  4.80194997e+04  2.46e-02 1.04e-03  1.46e-01     5s
  23   1.31204310e+04  4.22731852e+04  2.01e-02 7.60e-04  1.13e-01     5s
  24   1.78161824e+04  3.86235667e+04  1.26e-02 5.78e-04  8.09e-02     5s
  25   1.89637223e+04  3.61786916e+04  1.09e-02 4.68e-04  6.69e-02     5s
  26   2.04258089e+04  3.48741297e+04  8.89e-03 3.97e-04  5.62e-02     5s
  27   2.09018419e+04  3.38803541e+04  8.25e-03 3.48e-04  5.05e-02     5s
  28   2.18482656e+04  3.27017389e+04  6.92e-03 2.86e-04  4.22e-02     6s
  29   2.21787592e+04  3.20762839e+04  6.50e-03 2.51e-04  3.85e-02     6s
  30   2.23679473e+04  3.17340286e+04  6.25e-03 2.33e-04  3.64e-02     6s
  31   2.26585355e+04  3.15797699e+04  5.87e-03 2.24e-04  3.47e-02     6s
  32   2.28259330e+04  3.15080655e+04  5.66e-03 2.21e-04  3.38e-02     6s
  33   2.30814248e+04  3.14700905e+04  5.32e-03 2.19e-04  3.26e-02     6s
  34   2.36715958e+04  3.10975738e+04  4.58e-03 1.99e-04  2.89e-02     6s
  35   2.41129930e+04  3.01231525e+04  4.01e-03 1.47e-04  2.34e-02     6s
  36   2.48678815e+04  2.99037525e+04  3.09e-03 1.35e-04  1.96e-02     6s
  37   2.59948409e+04  2.87461886e+04  1.69e-03 6.97e-05  1.07e-02     6s
  38   2.64138530e+04  2.81019799e+04  1.16e-03 3.45e-05  6.56e-03     6s
  39   2.65574521e+04  2.79694327e+04  1.00e-03 2.67e-05  5.49e-03     6s
  40   2.70488984e+04  2.77068919e+04  4.62e-04 1.55e-05  2.56e-03     6s
  41   2.72472357e+04  2.76072373e+04  2.49e-04 8.39e-06  1.40e-03     7s
  42   2.74157565e+04  2.75460451e+04  7.65e-05 3.79e-06  5.06e-04     7s
  43   2.74408075e+04  2.75189000e+04  5.05e-05 1.79e-06  3.04e-04     7s
  44   2.74657655e+04  2.75058042e+04  2.44e-05 8.86e-07  1.56e-04     7s
  45   2.74707642e+04  2.75040864e+04  1.98e-05 7.73e-07  1.30e-04     7s
  46   2.74753030e+04  2.75013280e+04  1.56e-05 5.87e-07  1.01e-04     7s
  47   2.74882765e+04  2.74952386e+04  2.53e-06 1.84e-07  2.71e-05     7s
  48   2.74910834e+04  2.74941784e+04  5.71e-07 3.58e-07  1.20e-05     7s
  49   2.74921225e+04  2.74922615e+04  2.51e-08 9.97e-08  5.40e-07     7s
  50   2.74921676e+04  2.74922186e+04  1.83e-06 3.74e-08  1.97e-07     7s
  51   2.74921825e+04  2.74922020e+04  6.87e-07 1.45e-08  7.52e-08     7s
  52   2.74921902e+04  2.74921927e+04  1.27e-07 3.50e-09  9.73e-09     7s
  53   2.74921910e+04  2.74921924e+04  2.89e-07 1.62e-08  5.69e-09     7s
  54   2.74921920e+04  2.74921923e+04  3.26e-06 5.79e-08  1.21e-09     8s
  55   2.74921923e+04  2.74921923e+04  7.56e-07 1.72e-09  2.44e-10     8s

Barrier solved model in 55 iterations and 7.57 seconds (15.67 work units)
Optimal objective 2.74921923e+04


Root crossover log...

  127272 DPushes remaining with DInf 0.0000000e+00                 8s
    1736 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                11s

    4608 PPushes remaining with PInf 3.5772097e-05                11s
       0 PPushes remaining with PInf 0.0000000e+00                11s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.6116977e+00     11s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   60936    2.7492192e+04   0.000000e+00   3.611698e+00     11s
   61036    2.7492192e+04   0.000000e+00   0.000000e+00     11s
   61036    2.7492192e+04   0.000000e+00   0.000000e+00     11s
Concurrent spin time: 2.33s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 2.749219e+04, 61036 iterations, 10.75 seconds (20.04 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 27492.1923    0  137 -219438.19 27492.1923   113%     -   14s
H    0     0                    -116498.9132 27492.1923   124%     -   14s
H    0     0                    -97266.34107 27492.1923   128%     -   14s
H    0     0                    -94894.03323 27492.1923   129%     -   14s
H    0     0                    -71394.31792 27492.1923   139%     -   14s
H    0     0                    -14450.18348 27492.1923   290%     -   14s
H    0     0                    -4867.787303 27492.1923   665%     -   15s
H    0     0                    -1638.771660 27492.1923  1778%     -   15s
H    0     0                    -1215.581857 27492.1923  2362%     -   15s
     0     0 22710.8325    0  234 -1215.5819 22710.8325  1968%     -   41s
H    0     0                    -1091.432085 22701.7754  2180%     -   42s
H    0     0                    -1074.670836 22701.7754  2212%     -   42s
     0     0 22411.9179    0  229 -1074.6708 22411.9179  2185%     -   50s
     0     0 22382.2235    0  224 -1074.6708 22382.2235  2183%     -   53s
     0     0 22374.2934    0  226 -1074.6708 22374.2934  2182%     -   55s
     0     0 22373.4767    0  226 -1074.6708 22373.4767  2182%     -   56s
     0     0 22369.4184    0  231 -1074.6708 22369.4184  2182%     -   57s
     0     0 22369.3628    0  231 -1074.6708 22369.3628  2182%     -   57s
     0     0 19340.2343    0  211 -1074.6708 19340.2343  1900%     -   79s
     0     0 18886.6604    0  222 -1074.6708 18886.6604  1857%     -   92s
     0     0 18815.8161    0  227 -1074.6708 18815.8161  1851%     -   96s
     0     0 18692.5867    0  232 -1074.6708 18692.5867  1839%     -  100s
     0     0 18549.3926    0  238 -1074.6708 18549.3926  1826%     -  104s
     0     0 18502.4588    0  237 -1074.6708 18502.4588  1822%     -  108s
     0     0 18445.4049    0  240 -1074.6708 18445.4049  1816%     -  111s
     0     0 18418.4342    0  245 -1074.6708 18418.4342  1814%     -  114s
     0     0 18416.1759    0  245 -1074.6708 18416.1759  1814%     -  115s
     0     0 18411.7673    0  243 -1074.6708 18411.7673  1813%     -  116s
     0     0 18365.6767    0  235 -1074.6708 18365.6767  1809%     -  118s
     0     0 18187.9975    0  220 -1074.6708 18187.9975  1792%     -  125s
     0     0 18034.4050    0  311 -1074.6708 18034.4050  1778%     -  130s
     0     0 17859.6655    0  313 -1074.6708 17859.6655  1762%     -  134s
     0     0 17847.7934    0  239 -1074.6708 17847.7934  1761%     -  136s
     0     0 17847.3407    0  241 -1074.6708 17847.3407  1761%     -  136s
     0     0 14067.0622    0  319 -1074.6708 14067.0622  1409%     -  170s
     0     0 13545.7067    0  404 -1074.6708 13545.7067  1360%     -  188s
     0     0 13268.8103    0  417 -1074.6708 13268.8103  1335%     -  199s
     0     0 13207.3387    0  416 -1074.6708 13207.3387  1329%     -  205s
     0     0 12996.4051    0  433 -1074.6708 12996.4051  1309%     -  215s
     0     0 12916.6301    0  447 -1074.6708 12916.6301  1302%     -  223s
     0     0 12902.0417    0  449 -1074.6708 12902.0417  1301%     -  226s
     0     0 12880.7131    0  447 -1074.6708 12880.7131  1299%     -  230s
     0     0 12856.9824    0  446 -1074.6708 12856.9824  1296%     -  235s
     0     0 12852.0517    0  452 -1074.6708 12852.0517  1296%     -  237s
     0     0 12844.5721    0  449 -1074.6708 12844.5721  1295%     -  241s
     0     0 12832.3697    0  448 -1074.6708 12832.3697  1294%     -  244s
     0     0 12827.0916    0  452 -1074.6708 12827.0916  1294%     -  246s
     0     0 12824.7800    0  456 -1074.6708 12824.7800  1293%     -  247s
     0     0 12818.8203    0  451 -1074.6708 12818.8203  1293%     -  248s
     0     0 12815.0166    0  451 -1074.6708 12815.0166  1292%     -  249s
     0     0 12814.9022    0  450 -1074.6708 12814.9022  1292%     -  250s
     0     0 11600.6699    0  513 -1074.6708 11600.6699  1179%     -  283s
     0     0 11390.2688    0  487 -1074.6708 11390.2688  1160%     -  300s
     0     0 11252.6693    0  523 -1074.6708 11252.6693  1147%     -  309s
     0     0 11212.9950    0  525 -1074.6708 11212.9950  1143%     -  314s
     0     0 11163.0820    0  520 -1074.6708 11163.0820  1139%     -  319s
     0     0 11111.9463    0  510 -1074.6708 11111.9463  1134%     -  323s
     0     0 11087.8624    0  509 -1074.6708 11087.8624  1132%     -  326s
     0     0 11036.2112    0  522 -1074.6708 11036.2112  1127%     -  331s
     0     0 11032.2926    0  524 -1074.6708 11032.2926  1127%     -  333s
     0     0 11024.9268    0  514 -1074.6708 11024.9268  1126%     -  335s
     0     0 11024.1823    0  519 -1074.6708 11024.1823  1126%     -  336s
     0     0 10828.0232    0  477 -1074.6708 10828.0232  1108%     -  351s
     0     0 10744.1738    0  470 -1074.6708 10744.1738  1100%     -  360s
     0     0 10714.1093    0  552 -1074.6708 10714.1093  1097%     -  367s
     0     0 10688.3006    0  573 -1074.6708 10688.3006  1095%     -  373s
     0     0 10670.7222    0  569 -1074.6708 10670.7222  1093%     -  378s
     0     0 10664.6860    0  566 -1074.6708 10664.6860  1092%     -  381s
     0     0 10641.6265    0  525 -1074.6708 10641.6265  1090%     -  384s
     0     0 10617.8240    0  529 -1074.6708 10617.8240  1088%     -  388s
     0     0 10611.7322    0  546 -1074.6708 10611.7322  1087%     -  390s
     0     0 10605.5599    0  537 -1074.6708 10605.5599  1087%     -  392s
     0     0 10600.9117    0  540 -1074.6708 10600.9117  1086%     -  394s
     0     0 10597.8388    0  541 -1074.6708 10597.8388  1086%     -  394s
     0     0 10595.9177    0  545 -1074.6708 10595.9177  1086%     -  396s
     0     0 10511.1197    0  460 -1074.6708 10511.1197  1078%     -  406s
     0     0 10473.4166    0  477 -1074.6708 10473.4166  1075%     -  420s
     0     0 10447.9202    0  523 -1074.6708 10447.9202  1072%     -  426s
     0     0 10442.2268    0  489 -1074.6708 10442.2268  1072%     -  428s
     0     0 10440.2117    0  481 -1074.6708 10440.2117  1071%     -  429s
     0     0 10393.1584    0  478 -1074.6708 10393.1584  1067%     -  437s
     0     0 10384.1973    0  545 -1074.6708 10384.1973  1066%     -  441s
     0     0 10379.3571    0  538 -1074.6708 10379.3571  1066%     -  443s
     0     0 10374.7252    0  431 -1074.6708 10374.7252  1065%     -  445s
     0     0 10373.0752    0  434 -1074.6708 10373.0752  1065%     -  447s
     0     0 10356.9264    0  520 -1074.6708 10356.9264  1064%     -  453s
     0     0 10351.5623    0  570 -1074.6708 10351.5623  1063%     -  472s
     0     0 10350.2250    0  535 -1074.6708 10350.2250  1063%     -  474s
     0     0 10343.8446    0  525 -1074.6708 10343.8446  1063%     -  478s
     0     0 10340.7575    0  527 -1074.6708 10340.7575  1062%     -  481s
     0     0 10339.4648    0  532 -1074.6708 10339.4648  1062%     -  483s
     0     0 10320.2415    0  470 -1074.6708 10320.2415  1060%     -  490s
     0     0 10317.4484    0  462 -1074.6708 10317.4484  1060%     -  492s
     0     0 10315.9251    0  478 -1074.6708 10315.9251  1060%     -  495s
     0     0 10313.8347    0  468 -1074.6708 10313.8347  1060%     -  498s
     0     0 10312.8642    0  478 -1074.6708 10312.8642  1060%     -  499s
     0     0 10309.7820    0  486 -1074.6708 10309.7820  1059%     -  502s
     0     0 10309.1190    0  484 -1074.6708 10309.1190  1059%     -  503s
     0     0 10304.1713    0  476 -1074.6708 10304.1713  1059%     -  508s
     0     0 10303.9407    0  476 -1074.6708 10303.9407  1059%     -  511s
     0     2 10303.9407    0  476 -1074.6708 10303.9407  1059%     -  598s
     1     3 10225.9818    1  512 -1074.6708 10303.9407  1059%  4743  602s
     2     4 10250.1968    1  453 -1074.6708 10250.1968  1054%  6408  609s
     3     6 9700.88432    2  300 -1074.6708 10248.8536  1054%  7208  624s
     5    11 7598.29258    3  289 -1074.6708 10248.8536  1054%  9219  636s
    10    21 6819.53080    4  278 -1074.6708 10029.9631  1033%  8933  655s
    20    31 9159.75638    4  508 -1074.6708 10029.9074  1033% 15605  695s
    30    58 6586.60222    4  293 -1074.6708 9567.48439   990% 14396  803s
    57    90 8877.56120    5  474 -1074.6708 9567.48439   990% 20076  835s
    89   146 8703.96165    6  463 -1074.6708 9567.48439   990% 17545  876s
   145   232 8351.65402    7  439 -1074.6708 9567.48439   990% 14492  911s
   231   299 3849.09726   10  222 -1074.6708 9567.48439   990% 11802  936s
   302   364 8272.15447    8  434 -1074.6708 9567.48439   990% 10798  958s
   380   388 8702.16637    7  460 -1074.6708 9567.48439   990% 10275  976s
   408   417 2057.78752   16  217 -1074.6708 9567.48439   990% 10035  996s
   449   451 7630.42229    9  482 -1074.6708 9567.48439   990% 10170 1014s
   493   483 1717.52725   18  202 -1074.6708 9567.48439   990%  9866 1031s
   535   521 7166.49255   10  469 -1074.6708 9567.48439   990%  9697 1047s
   583   556 1269.52815   20  196 -1074.6708 9567.48439   990%  9311 1061s
   630   594 7080.93598   11  472 -1074.6708 9567.48439   990%  9144 1078s
   678   637 6368.25354   12  482 -1074.6708 9567.48439   990%  8843 1093s
   729   670 6964.40972   12  477 -1074.6708 9567.48439   990%  8657 1108s
   786   710 6320.05282   13  380 -1074.6708 9567.48439   990%  8416 1123s
   848   758 6728.32815   13  469 -1074.6708 9567.48439   990%  8186 1138s
   915   800 6126.28567   13  475 -1074.6708 9567.48439   990%  7886 1153s
   993   838 6081.81885   14  427 -1074.6708 9567.48439   990%  7619 1172s
  1063   893 2757.79743   14  218 -1074.6708 9567.48439   990%  7459 1191s
  1149   933 6653.40650   14  439 -1074.6708 9567.48439   990%  7300 1214s
  1248   976 6031.34188   15  418 -1074.6708 9567.48439   990%  7111 1239s
  1350  1024  287.19246   15  363 -1074.6708 9567.48439   990%  7053 1262s
  1478  1096 -113.03570   16  373 -1074.6708 9567.48439   990%  6922 1285s
  1597  1160 5564.54452   16  419 -1074.6708 9567.48439   990%  6846 1309s
  1717  1206     cutoff   17      -1074.6708 9567.48439   990%  6794 1334s
  1816  1252 -635.75310   18  370 -1074.6708 9567.48439   990%  6797 1363s
  1894  1300 -706.28339   19  369 -1074.6708 9567.48439   990%  7011 1394s
  1989  1341 infeasible   20      -1074.6708 9252.92244   961%  7087 1423s
  2080  1435 6736.87785   11  410 -1074.6708 9252.84149   961%  7299 1452s
  2228  1534 6601.20599   12  402 -1074.6708 9252.84149   961%  7276 1479s
  2385  1682 6421.19455   13  420 -1074.6708 9252.84149   961%  7237 1506s
  2557  1832 6224.28786   17  341 -1074.6708 9252.84149   961%  7177 1538s
  2767  1999     cutoff   21      -1074.6708 8977.46524   935%  7043 1572s
  2990  2094 4905.11812   19  313 -1074.6708 8803.48697   919%  6926 1632s
  3154  2206 4535.44179   21  449 -1074.6708 8803.32153   919%  6833 1669s
  3360  2360 4075.42691   25  334 -1074.6708 8803.32153   919%  6768 1710s
  3576  2521 1793.94301   46  168 -1074.6708 8690.02912   909%  6712 1748s
  3808  2522  575.61766   72  476 -1074.6708 8606.57047   901%  6652 1976s
  3810  2523  939.04206   20  128 -1074.6708 8606.57047   901%  6649 1989s
  3811  2524  900.68774   59  337 -1074.6708 8606.57047   901%  6647 2046s
  3812  2525 2777.58516   34  325 -1074.6708 8606.57047   901%  6645 2103s
  3813  2525  607.27637   26  437 -1074.6708 8606.57047   901%  6643 2130s
  3814  2526  466.73841   33  437 -1074.6708 8606.57047   901%  6642 2148s
  3815  2527 2674.88829   18  448 -1074.6708 8606.57047   901%  6640 2168s
  3816  2527 3811.08336   13  459 -1074.6708 8606.57047   901%  6638 2181s
  3817  2528  382.92744   51  447 -1074.6708 8606.57047   901%  6636 2190s
  3818  2529  357.25624   61  479 -1074.6708 8606.57047   901%  6635 2198s
  3819  2529  506.75599   65  400 -1074.6708 8606.57047   901%  6633 2206s
  3820  2530 1544.52043   43  464 -1074.6708 8606.57047   901%  6631 2214s
  3821  2531 4840.93046   16  462 -1074.6708 8606.57047   901%  6629 2226s
  3822  2531 7897.30389   16  335 -1074.6708 8606.57047   901%  6628 2231s
  3823  2532  723.39899   21  433 -1074.6708 8606.57047   901%  6626 2237s
  3824  2533 2586.23648   15  489 -1074.6708 8606.57047   901%  6624 2241s
  3825  2533 1994.87068   15  575 -1074.6708 8606.57047   901%  6623 2262s
  3826  2534 2748.23401   11  487 -1074.6708 8606.57047   901%  6621 2270s
  3827  2535 1353.31749   16  470 -1074.6708 8606.57047   901%  6619 2276s
  3828  2535 -704.35925   26  506 -1074.6708 8606.57047   901%  6617 2280s
  3829  2536 1802.90028   42  459 -1074.6708 8606.57047   901%  6616 2286s
  3830  2537 2189.53277   15  372 -1074.6708 8606.57047   901%  6614 2296s
  3832  2538 6979.82818   16  308 -1074.6708 8606.57047   901%  6610 2304s
  3833  2539 3279.65366   30  329 -1074.6708 8606.57047   901%  6609 2314s
  3834  2539  719.93647   60  503 -1074.6708 8606.57047   901%  6607 2320s
  3835  2540 1265.75762   17  455 -1074.6708 8606.57047   901%  6605 2332s
  3836  2541 -711.07093   17  490 -1074.6708 8606.57047   901%  6604 2336s
  3837  2541  696.79133   57  440 -1074.6708 8606.57047   901%  6602 2348s
  3838  2542 2448.53976   10  439 -1074.6708 8606.57047   901%  6600 2355s
  3839  2543 5834.42657   24  461 -1074.6708 8606.57047   901%  6598 2365s
  3841  2544 2209.57281   51  452 -1074.6708 8606.57047   901%  6595 2382s
  3842  2545  559.53292   16  465 -1074.6708 8606.57047   901%  6593 2388s
  3843  2545 6460.42594   18  451 -1074.6708 8606.57047   901%  6592 2395s
  3845  2547 4611.69250   26  450 -1074.6708 8606.57047   901%  6588 2403s
  3846  2547 3411.77669   16  446 -1074.6708 8606.57047   901%  6586 2418s
  3847  2548  755.74833   55  446 -1074.6708 8606.57047   901%  6585 2436s
  3848  2549 1243.67743   33  446 -1074.6708 8606.57047   901%  6583 2521s
  3849  2552 8606.57047   15  490 -1074.6708 8606.57047   901%  6690 2603s
  3851  2556 8606.57047   16  477 -1074.6708 8606.57047   901%  6695 2639s
  3855  2562 8606.57047   17  498 -1074.6708 8606.57047   901%  6698 2688s
  3863  2576 8606.57047   18  492 -1074.6708 8606.57047   901%  6727 2733s
  3879  2586 8316.08883   19  515 -1074.6708 8606.57047   901%  6791 2847s
  3895  2612 6727.77635   20  552 -1074.6708 8606.57047   901%  6868 2924s
  3926  2721 6677.44144   21  553 -1074.6708 8606.57047   901%  6962 2988s
  4052  2712 6362.37516   24  533 -1074.6708 8606.57047   901%  6925 3023s
  4109  2714 6223.84755   25  438 -1074.6708 8606.57047   901%  6937 3053s
  4167  2692 4946.79405   23  271 -1074.6708 8606.57047   901%  6958 3088s
  4209  2692 6031.15511   26  414 -1074.6708 8606.57047   901%  6987 3122s
H 4229  2557                    -1051.181462 8606.57047   919%  7014 3122s
  4244  2558 3756.39163   31  354 -1051.1815 8606.57047   919%  7053 3163s
  4267  2558 5552.49185   27  338 -1051.1815 8606.57047   919%  7073 3214s
  4300  2561 3155.81234   28  375 -1051.1815 8606.57047   919%  7131 3269s
  4340  2555 3922.94813   29  493 -1051.1815 8606.57047   919%  7171 3305s
  4381  2548     cutoff   30      -1051.1815 8606.57047   919%  7227 3348s
  4417  2537     cutoff   29      -1051.1815 8606.57047   919%  7277 3378s
  4460  2538  818.55396   21  213 -1051.1815 8606.57047   919%  7345 3418s
  4504  2531  652.35602   22  226 -1051.1815 8606.57047   919%  7376 3463s
  4561  2517  552.53459   23  229 -1051.1815 8606.57047   919%  7377 3493s
  4625  2510  496.93952   24  230 -1051.1815 8606.57047   919%  7381 3532s
  4686  2510     cutoff   25      -1051.1815 8606.57047   919%  7363 3575s
  4755  2493 5005.62657   23  393 -1051.1815 8606.57047   919%  7358 3600s

Cutting planes:
  Learned: 2
  Gomory: 3
  Implied bound: 10
  Projected implied bound: 159
  MIR: 1591
  Flow cover: 3497
  RLT: 23
  Relax-and-lift: 439

Explored 4832 nodes (36092920 simplex iterations) in 3600.05 seconds (9220.23 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -1051.18 -1074.67 -1091.43 ... -97266.3

Time limit reached
Best objective -1.051181462350e+03, best bound 8.606570468921e+03, gap 918.7521%
  WARNING: Time limit reached. Using best solution found (gap: 918.75%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = -1051.18, θ = 140843.63
  Upper Bound (UB) = -1051.18

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 140843.63
  [DEBUG]   ✓ Scenario 0: θ = 140843.63 ≤ Q = 140843.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 140843.63 ≤ Q = 140843.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 140843.63 ≤ Q = 140843.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 140843.63 ≤ Q = 140843.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 140843.63 ≤ Q = 140843.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 140843.63 ≤ Q = 140843.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 140843.63 ≤ Q = 140843.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 140843.63 ≤ Q = 140843.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 140843.63 ≤ Q = 140843.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 140843.63 ≤ Q = 140843.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 140843.63 ≤ Q = 140843.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 140843.63 ≤ Q = 140843.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 140843.63 ≤ Q = 140843.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 140843.63 ≤ Q = 140843.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 140843.63 ≤ Q = 140843.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 140843.63 ≤ Q = 140843.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 140843.63 ≤ Q = 140843.63 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 17] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x47bba9ad
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x47bba9ad
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.150734e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.00s
Presolved: 494 rows, 498 columns, 1393 nonzeros
Found heuristic solution: objective 5760669.1857
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.300846e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -130084.61    0  123 5760669.19 -130084.61   102%     -    0s
H    0     0                    -97857.65048 -130084.61  32.9%     -    0s
H    0     0                    -98458.79675 -130084.61  32.1%     -    0s
     0     0 -104205.32    0   67 -98458.797 -104205.32  5.84%     -    0s
H    0     0                    -101401.7188 -104141.99  2.70%     -    0s
H    0     0                    -102700.5444 -104141.99  1.40%     -    0s
     0     0 -103695.26    0   69 -102700.54 -103695.26  0.97%     -    0s
     0     0 -103631.32    0   68 -102700.54 -103631.32  0.91%     -    0s
H    0     0                    -102734.5109 -103247.15  0.50%     -    0s
     0     0 -103247.15    0   46 -102734.51 -103247.15  0.50%     -    0s
H    0     0                    -102746.6273 -103220.63  0.46%     -    0s
     0     0 -103143.60    0   50 -102746.63 -103143.60  0.39%     -    0s
     0     0 -103135.55    0   50 -102746.63 -103135.55  0.38%     -    0s
     0     0 -103035.55    0   40 -102746.63 -103035.55  0.28%     -    0s
     0     0 -103032.02    0   40 -102746.63 -103032.02  0.28%     -    0s
     0     0 -103000.56    0   43 -102746.63 -103000.56  0.25%     -    0s
     0     0 -102997.26    0   43 -102746.63 -102997.26  0.24%     -    0s
H    0     0                    -102972.9795 -102997.26  0.02%     -    0s
     0     0 -102997.26    0   45 -102972.98 -102997.26  0.02%     -    0s
     0     0 -102997.26    0   31 -102972.98 -102997.26  0.02%     -    0s
     0     0          -    0      -102972.98 -102980.81  0.01%     -    0s

Cutting planes:
  Gomory: 3
  Implied bound: 1
  MIR: 48
  Flow cover: 9
  RLT: 1

Explored 1 nodes (773 simplex iterations) in 0.14 seconds (0.05 work units)
Thread count was 32 (of 256 available processors)

Solution count 8: -102973 -102747 -102735 ... 1.15073e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.029729794698e+05, best bound -1.029808082715e+05, gap 0.0076%
  Subproblem solved in 0.17s
  Worst-case operational profit (Z_SP) = 138487.44
  Scenario: 9 demand increases, 51 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -102972.98
  [DEBUG]   S×d_nominal = 241460.42
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 241460.42 + -102972.98 = 138487.44
  [DEBUG]   Current θ from Master = 140843.63
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2356.19 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -3407.38
  Lower Bound (LB) = -1589.09
  Gap (UB-LB) = 537.9077, Absolute Gap = 537.9077, Relative Gap = 0.511717
  Not converged yet (gap = 537.91 > ε = 200)

  [DEBUG] Adding NEW scenario 17 to Master Problem...
  [DEBUG] New scenario pattern: 9 increases, 51 decreases
    [DEBUG] Scenario 17 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 17 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 17]
    [DEBUG]   - Total constraints in model: 276603
    [DEBUG]   - Total variables in model: 114580
  [DEBUG] Total scenarios in Master: 18
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 18
================================================================================
[Iteration 18] Solving Master Problem...
  Current scenarios in Master: 18
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 276603 rows, 114580 columns and 783677 nonzeros
Model fingerprint: 0xd188f51a
Variable types: 112321 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 127260 rows and 51660 columns
Presolve time: 2.09s
Presolved: 149343 rows, 62920 columns, 919380 nonzeros
Variable types: 60661 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -373180.1084
Found heuristic solution: objective -219438.1934

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.40s

Barrier statistics:
 Dense cols : 597
 AA' NZ     : 8.506e+06
 Factor NZ  : 1.891e+07 (roughly 240 MB of memory)
 Factor Ops : 4.691e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.60939811e+07  2.39209730e+08  9.11e+04 1.74e+01  6.78e+04     4s
   1  -1.24994722e+07  2.09342308e+08  6.53e+04 4.97e+01  4.82e+04     4s
   2  -4.47218285e+06  1.69404922e+08  2.20e+04 5.50e+00  1.69e+04     4s
   3  -8.44826062e+05  1.18233866e+08  1.59e+03 1.24e+00  1.59e+03     4s
   4  -5.74294109e+05  6.19234530e+07  4.50e+02 4.94e-01  5.27e+02     4s
   5  -5.05260049e+05  4.04371253e+07  2.54e+02 2.74e-01  3.05e+02     4s
   6  -4.25121563e+05  3.14783925e+07  8.33e+01 1.99e-01  1.65e+02     4s
   7  -3.58071548e+05  2.36225236e+07  4.08e+01 1.42e-01  1.09e+02     4s
   8  -2.44266429e+05  1.50408400e+07  8.15e+00 8.49e-02  5.93e+01     4s
   9  -1.89286273e+05  1.05547197e+07  4.38e+00 5.87e-02  4.07e+01     4s
  10  -1.45024764e+05  7.28544683e+06  2.66e+00 4.05e-02  2.78e+01     5s
  11  -1.16296411e+05  3.71562322e+06  1.24e+00 2.02e-02  1.42e+01     5s
  12  -9.44397469e+04  1.99308837e+06  5.65e-01 1.11e-02  7.70e+00     5s
  13  -6.61983737e+04  7.03027046e+05  2.56e-01 3.89e-03  2.83e+00     5s
  14  -3.34995902e+04  4.18120118e+05  1.06e-01 2.25e-03  1.66e+00     5s
  15  -2.30720024e+04  2.85184328e+05  7.55e-02 1.86e-03  1.13e+00     5s
  16  -1.26570784e+04  2.00049524e+05  4.99e-02 1.87e-03  7.81e-01     5s
  17  -7.86598595e+03  1.64245328e+05  4.08e-02 1.31e-03  6.32e-01     5s
  18  -5.28856558e+03  1.06871917e+05  3.46e-02 1.35e-03  4.12e-01     5s
  19  -7.71923550e+01  8.99122900e+04  2.69e-02 1.13e-03  3.31e-01     5s
  20   3.53203460e+03  7.52381634e+04  2.24e-02 8.94e-04  2.63e-01     5s
  21   6.64107016e+03  6.12282061e+04  1.88e-02 6.53e-04  2.01e-01     5s
  22   9.10569547e+03  5.17418588e+04  1.62e-02 4.77e-04  1.57e-01     5s
  23   1.10811678e+04  4.69495691e+04  1.40e-02 3.91e-04  1.32e-01     5s
  24   1.50042752e+04  4.18293442e+04  1.01e-02 2.98e-04  9.85e-02     5s
  25   1.74219930e+04  3.77335567e+04  7.90e-03 2.15e-04  7.46e-02     5s
  26   1.94422337e+04  3.58219612e+04  6.16e-03 1.75e-04  6.02e-02     5s
  27   2.00322183e+04  3.32249431e+04  5.67e-03 1.26e-04  4.85e-02     6s
  28   2.14829643e+04  3.23842484e+04  4.45e-03 1.08e-04  4.00e-02     6s
  29   2.23163162e+04  3.17362980e+04  3.80e-03 9.40e-05  3.46e-02     6s
  30   2.28470013e+04  3.14929240e+04  3.40e-03 8.90e-05  3.18e-02     6s
  31   2.29748236e+04  3.13032956e+04  3.30e-03 8.77e-05  3.06e-02     6s
  32   2.35443414e+04  3.11082458e+04  2.86e-03 8.35e-05  2.78e-02     6s
  33   2.36875626e+04  3.06826254e+04  2.75e-03 7.35e-05  2.57e-02     6s
  34   2.41116774e+04  2.98396057e+04  2.42e-03 5.09e-05  2.10e-02     6s
  35   2.54426384e+04  2.93050285e+04  1.41e-03 3.92e-05  1.42e-02     6s
  36   2.60318129e+04  2.81576298e+04  9.91e-04 1.46e-05  7.81e-03     6s
  37   2.63060720e+04  2.79787482e+04  7.99e-04 1.05e-05  6.15e-03     6s
  38   2.68222990e+04  2.77748912e+04  4.48e-04 5.98e-06  3.50e-03     6s
  39   2.71120064e+04  2.76814305e+04  2.54e-04 3.94e-06  2.09e-03     6s
  40   2.73247515e+04  2.75886824e+04  1.07e-04 1.95e-06  9.70e-04     6s
  41   2.74001125e+04  2.75433317e+04  5.84e-05 1.02e-06  5.26e-04     7s
  42   2.74463185e+04  2.75165086e+04  2.82e-05 8.17e-07  2.58e-04     7s
  43   2.74659090e+04  2.75111373e+04  1.56e-05 6.50e-07  1.66e-04     7s
  44   2.74748512e+04  2.75037230e+04  1.01e-05 4.10e-07  1.06e-04     7s
  45   2.74866165e+04  2.74966380e+04  2.90e-06 1.11e-07  3.68e-05     7s
  46   2.74916476e+04  2.74950633e+04  1.15e-07 7.63e-08  1.25e-05     7s
  47   2.74919427e+04  2.74946808e+04  1.04e-07 6.94e-08  1.01e-05     7s
  48   2.74921221e+04  2.74925236e+04  3.33e-08 1.15e-08  1.47e-06     7s
  49   2.74921689e+04  2.74922035e+04  1.18e-08 4.04e-09  1.27e-07     7s
  50   2.74921908e+04  2.74921929e+04  4.42e-09 8.54e-10  7.73e-09     7s
  51   2.74921920e+04  2.74921926e+04  1.67e-07 7.51e-08  2.51e-09     7s
  52   2.74921922e+04  2.74921923e+04  1.16e-06 2.05e-06  3.87e-10     7s

Barrier solved model in 52 iterations and 7.45 seconds (17.11 work units)
Optimal objective 2.74921922e+04


Root crossover log...

  134583 DPushes remaining with DInf 0.0000000e+00                 7s
    4591 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                11s

    4212 PPushes remaining with PInf 4.4302346e-05                11s
       0 PPushes remaining with PInf 0.0000000e+00                11s

  Push phase complete: Pinf 0.0000000e+00, Dinf 9.7268436e-01     11s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   63101    2.7492192e+04   0.000000e+00   9.726844e-01     11s
   63142    2.7492192e+04   0.000000e+00   0.000000e+00     12s
   63142    2.7492192e+04   0.000000e+00   0.000000e+00     12s
Concurrent spin time: 2.27s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 2.749219e+04, 63142 iterations, 11.07 seconds (23.04 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 27492.1923    0  137 -219438.19 27492.1923   113%     -   14s
H    0     0                    -79333.16368 27492.1923   135%     -   14s
H    0     0                    -74580.58703 27492.1923   137%     -   14s
H    0     0                    -71394.31792 27492.1923   139%     -   14s
H    0     0                    -12996.96496 27492.1923   312%     -   15s
H    0     0                    -5119.266759 27492.1923   637%     -   15s
H    0     0                    -2644.042357 27492.1923  1140%     -   15s
H    0     0                    -1789.289799 27492.1923  1636%     -   15s
H    0     0                    -1696.394464 27492.1923  1721%     -   15s
H    0     0                    -1215.581857 27492.1923  2362%     -   15s
     0     0 22183.3754    0  230 -1215.5819 22183.3754  1925%     -   44s
H    0     0                    -1157.183090 22182.6423  2017%     -   45s
H    0     0                    -1074.670836 22182.6423  2164%     -   45s
     0     0 21929.3862    0  241 -1074.6708 21929.3862  2141%     -   58s
     0     0 21873.0642    0  241 -1074.6708 21873.0642  2135%     -   64s
     0     0 21832.2817    0  251 -1074.6708 21832.2817  2132%     -   71s
     0     0 21828.6789    0  248 -1074.6708 21828.6789  2131%     -   73s
     0     0 21826.6805    0  252 -1074.6708 21826.6805  2131%     -   74s
     0     0 21826.4849    0  252 -1074.6708 21826.4849  2131%     -   74s
     0     0 19147.4483    0  218 -1074.6708 19147.4483  1882%     -  112s
     0     0 19046.4421    0  233 -1074.6708 19046.4421  1872%     -  122s
     0     0 19010.6925    0  239 -1074.6708 19010.6925  1869%     -  128s
     0     0 18965.7903    0  234 -1074.6708 18965.7903  1865%     -  139s
     0     0 18957.9625    0  232 -1074.6708 18957.9625  1864%     -  141s
     0     0 18957.2701    0  243 -1074.6708 18957.2701  1864%     -  142s
     0     0 14885.6016    0  366 -1074.6708 14885.6016  1485%     -  189s
     0     0 14223.6239    0  334 -1074.6708 14223.6239  1424%     -  209s
     0     0 13982.3008    0  352 -1074.6708 13982.3008  1401%     -  226s
     0     0 13898.3797    0  354 -1074.6708 13898.3797  1393%     -  235s
     0     0 13827.4967    0  396 -1074.6708 13827.4967  1387%     -  244s
     0     0 13787.3438    0  410 -1074.6708 13787.3438  1383%     -  248s
     0     0 13769.9356    0  395 -1074.6708 13769.9356  1381%     -  251s
     0     0 13742.3531    0  395 -1074.6708 13742.3531  1379%     -  253s
     0     0 13738.7819    0  402 -1074.6708 13738.7819  1378%     -  256s
     0     0 13735.5765    0  403 -1074.6708 13735.5765  1378%     -  258s
     0     0 13694.4213    0  352 -1074.6708 13694.4213  1374%     -  262s
     0     0 13686.4042    0  396 -1074.6708 13686.4042  1374%     -  264s
     0     0 13685.0657    0  408 -1074.6708 13685.0657  1373%     -  264s
     0     0 12093.8689    0  442 -1074.6708 12093.8689  1225%     -  303s
     0     0 11748.4156    0  475 -1074.6708 11748.4156  1193%     -  319s
     0     0 11643.1324    0  472 -1074.6708 11643.1324  1183%     -  330s
     0     0 11589.9519    0  472 -1074.6708 11589.9519  1178%     -  336s
     0     0 11466.3362    0  447 -1074.6708 11466.3362  1167%     -  345s
     0     0 11429.6327    0  451 -1074.6708 11429.6327  1164%     -  353s
     0     0 11409.8450    0  460 -1074.6708 11409.8450  1162%     -  361s
     0     0 11379.7930    0  468 -1074.6708 11379.7930  1159%     -  369s
     0     0 11370.0139    0  478 -1074.6708 11370.0139  1158%     -  374s
     0     0 11363.9106    0  474 -1074.6708 11363.9106  1157%     -  377s
     0     0 11362.8742    0  476 -1074.6708 11362.8742  1157%     -  379s
     0     0 11069.1481    0  475 -1074.6708 11069.1481  1130%     -  407s
     0     0 10980.8845    0  516 -1074.6708 10980.8845  1122%     -  422s
     0     0 10938.7561    0  493 -1074.6708 10938.7561  1118%     -  431s
     0     0 10905.8278    0  423 -1074.6708 10905.8278  1115%     -  437s
     0     0 10875.3102    0  411 -1074.6708 10875.3102  1112%     -  445s
     0     0 10866.4946    0  532 -1074.6708 10866.4946  1111%     -  449s
     0     0 10859.8868    0  525 -1074.6708 10859.8868  1111%     -  453s
     0     0 10851.7824    0  529 -1074.6708 10851.7824  1110%     -  456s
     0     0 10851.6219    0  534 -1074.6708 10851.6219  1110%     -  458s
     0     0 10672.5432    0  487 -1074.6708 10672.5432  1093%     -  475s
     0     0 10623.3166    0  430 -1074.6708 10623.3166  1089%     -  492s
     0     0 10609.1013    0  432 -1074.6708 10609.1013  1087%     -  497s
     0     0 10603.7404    0  432 -1074.6708 10603.7404  1087%     -  501s
     0     0 10598.8192    0  442 -1074.6708 10598.8192  1086%     -  505s
     0     0 10593.6938    0  432 -1074.6708 10593.6938  1086%     -  510s
     0     0 10589.2563    0  523 -1074.6708 10589.2563  1085%     -  514s
     0     0 10584.5965    0  527 -1074.6708 10584.5965  1085%     -  517s
     0     0 10581.5028    0  528 -1074.6708 10581.5028  1085%     -  519s
     0     0 10577.2718    0  479 -1074.6708 10577.2718  1084%     -  522s
     0     0 10577.2027    0  532 -1074.6708 10577.2027  1084%     -  523s
     0     0 10509.9147    0  574 -1074.6708 10509.9147  1078%     -  534s
     0     0 10490.9415    0  425 -1074.6708 10490.9415  1076%     -  541s
     0     0 10483.4232    0  536 -1074.6708 10483.4232  1076%     -  545s
     0     0 10479.0569    0  519 -1074.6708 10479.0569  1075%     -  548s
     0     0 10477.8359    0  482 -1074.6708 10477.8359  1075%     -  549s
     0     0 10454.4918    0  424 -1074.6708 10454.4918  1073%     -  557s
     0     0 10448.8822    0  433 -1074.6708 10448.8822  1072%     -  576s
     0     0 10447.2708    0  436 -1074.6708 10447.2708  1072%     -  578s
     0     0 10420.1965    0  484 -1074.6708 10420.1965  1070%     -  585s
     0     0 10412.4492    0  469 -1074.6708 10412.4492  1069%     -  590s
     0     0 10403.4551    0  490 -1074.6708 10403.4551  1068%     -  593s
     0     0 10400.4108    0  490 -1074.6708 10400.4108  1068%     -  596s
     0     0 10399.5440    0  534 -1074.6708 10399.5440  1068%     -  598s
     0     0 10374.3831    0  414 -1074.6708 10374.3831  1065%     -  604s
     0     0 10370.2217    0  480 -1074.6708 10370.2217  1065%     -  612s
     0     0 10369.2601    0  479 -1074.6708 10369.2601  1065%     -  613s
     0     0 10362.0354    0  429 -1074.6708 10362.0354  1064%     -  618s
     0     0 10360.3410    0  445 -1074.6708 10360.3410  1064%     -  622s
     0     0 10350.5183    0  437 -1074.6708 10350.5183  1063%     -  627s
     0     0 10349.0338    0  371 -1074.6708 10349.0338  1063%     -  630s
     0     0 10342.9019    0  372 -1074.6708 10342.9019  1062%     -  633s
     0     0 10341.9024    0  426 -1074.6708 10341.9024  1062%     -  635s
     0     0 10338.2403    0  373 -1074.6708 10338.2403  1062%     -  639s
     0     0 10338.0970    0  373 -1074.6708 10338.0970  1062%     -  642s
     0     2 10337.9178    0  373 -1074.6708 10337.9178  1062%     -  762s
     1     3 8807.05990    1  285 -1074.6708 10337.8751  1062% 26457  786s
     2     6 8700.02463    2  287 -1074.6708 10337.8751  1062% 15732  793s
     5     9 7851.75171    2  289 -1074.6708 10218.7021  1051% 13620  819s
     8    18 7477.86150    3  312 -1074.6708 10218.7021  1051% 16495  835s
    17    35 6945.21981    4  318 -1074.6708 10116.5955  1041% 12212  859s
    34    49 8300.73841    4  382 -1074.6708 9834.72062  1015% 17994  919s
    48    77 6909.67628    6  298 -1074.6708 9834.72062  1015% 16127  957s
    76   113 5952.90296    6  257 -1074.6708 9834.72062  1015% 12999  996s
   112   149 5918.86569    7  239 -1074.6708 9834.72062  1015% 11266 1024s
   148   185 3679.62987    9  265 -1074.6708 9834.72062  1015% 10489 1059s
   184   227 5884.88291    8  233 -1074.6708 9834.72062  1015%  9722 1118s
   226   271 2787.34747    9  196 -1074.6708 9834.72062  1015%  8924 1157s
   271   305  909.07891   11  169 -1074.6708 9834.72062  1015%  8674 1191s
   323   381  857.77845   13  163 -1074.6708 9834.72062  1015%  8545 1227s
   410   461 -270.72921   13  157 -1074.6708 9834.72062  1015%  8304 1253s
   514   516 -758.71278   16  145 -1074.6708 9834.72062  1015%  7690 1273s
   608   529 -970.88316   16  135 -1074.6708 9834.72062  1015%  7302 1299s
   643   550     cutoff   17      -1074.6708 9834.72062  1015%  7372 1320s
   686   561 2274.49090   12  195 -1074.6708 9834.72062  1015%  7359 1340s
   723   584 infeasible   13      -1074.6708 9834.72062  1015%  7239 1359s
   783   602 infeasible   14      -1074.6708 9834.72062  1015%  7123 1379s
   843   618  983.26860   12  192 -1074.6708 9834.72062  1015%  7006 1408s
   922   655  515.29510   13  171 -1074.6708 9834.72062  1015%  6891 1427s
  1005   686 infeasible   14      -1074.6708 9834.72062  1015%  6862 1449s
  1102   755  594.64034   14  189 -1074.6708 9834.72062  1015%  6797 1468s
  1226   833     cutoff   15      -1074.6708 9834.72062  1015%  6661 1493s
  1354   875 -632.52565   19  141 -1074.6708 9834.72062  1015%  6604 1516s
  1416   933 -777.84086   20  132 -1074.6708 9834.72062  1015%  6523 1537s
  1509  1023 -912.78720   21  139 -1074.6708 9834.72062  1015%  6428 1564s
  1639  1168 5910.13027   28  268 -1074.6708 9834.72062  1015%  6315 1589s
  1806  1298 5506.99942   30  246 -1074.6708 9834.72062  1015%  6127 1612s
  1995  1388 5266.79200   32  236 -1074.6708 9834.72062  1015%  5964 1655s
  2125  1523  660.96987   33  132 -1074.6708 9834.72062  1015%  5887 1681s
  2306  1608 4686.77602   39  277 -1074.6708 9834.72062  1015%  5756 1709s
  2463  1695 4622.32705   40  364 -1074.6708 9834.72062  1015%  5754 1738s
  2630  1805 4012.67531   41  271 -1074.6708 9834.72062  1015%  5748 1770s
  2803  1926 infeasible   43      -1074.6708 9834.72062  1015%  5746 1803s
  2986  2028 3510.42348   52  248 -1074.6708 9834.72062  1015%  5768 1843s
  3142  2249 3267.04136   58  227 -1074.6708 9635.10950   997%  5792 1880s
  3442  2375 infeasible   65      -1074.6708 9635.10950   997%  5607 1915s
  3708  2497 1895.20206   70  168 -1074.6708 9635.10950   997%  5547 1954s
  3968  2588 infeasible   73      -1074.6708 9439.31581   978%  5494 1994s
  4167  2758  823.37445   87  142 -1074.6708 9439.31581   978%  5537 2032s
  4412  2759  945.40731   36  373 -1074.6708 9439.31581   978%  5545 2326s
  4414  2760 2636.71208   28  129 -1074.6708 9439.31581   978%  5542 2348s
  4415  2761 5600.67244   10  320 -1074.6708 9439.31581   978%  5541 2413s
  4416  2762 1037.28651   36  308 -1074.6708 9439.31581   978%  5540 2469s
  4417  2762  980.98620   27  421 -1074.6708 9439.31581   978%  5539 2502s
  4418  2763 -166.77672   56  423 -1074.6708 9439.31581   978%  5537 2533s
  4419  2764 3828.41549   51  434 -1074.6708 9439.31581   978%  5536 2553s
  4420  2764 4614.69592   11  471 -1074.6708 9439.31581   978%  5535 2565s
  4421  2765  287.92362   17  395 -1074.6708 9439.31581   978%  5534 2577s
  4422  2766  290.01182   76  470 -1074.6708 9439.31581   978%  5532 2601s
  4423  2766 3675.67907    9  475 -1074.6708 9439.31581   978%  5531 2610s
  4424  2767 7121.25601   16  416 -1074.6708 9439.31581   978%  5530 2618s
  4425  2768 5635.36387   10  351 -1074.6708 9439.31581   978%  5529 2621s
  4426  2768 -324.84483   26  473 -1074.6708 9439.31581   978%  5527 2627s
  4427  2769 1092.72494   18  362 -1074.6708 9439.31581   978%  5526 2654s
  4428  2770 1528.33909   87  511 -1074.6708 9439.31581   978%  5525 2664s
  4429  2770 1128.04359   25  475 -1074.6708 9439.31581   978%  5524 2671s
  4430  2771 2867.57973   49  526 -1074.6708 9439.31581   978%  5522 2678s
  4431  2772  293.18557  100  525 -1074.6708 9439.31581   978%  5521 2687s
  4432  2772 4849.09342   30  526 -1074.6708 9439.31581   978%  5520 2693s
  4433  2773 8503.15901    6  525 -1074.6708 9439.31581   978%  5519 2698s
  4434  2774 2025.65938   41  525 -1074.6708 9439.31581   978%  5517 2703s
  4435  2774 -129.36122   50  479 -1074.6708 9439.31581   978%  5516 2716s
  4436  2775 2726.62189   48  469 -1074.6708 9439.31581   978%  5515 2722s
  4437  2776 2024.67752   41  470 -1074.6708 9439.31581   978%  5514 2727s
  4438  2776 -557.34953   56  459 -1074.6708 9439.31581   978%  5512 2737s
  4439  2777 -546.10699   21  464 -1074.6708 9439.31581   978%  5511 2743s
  4440  2778 2810.88775   54  473 -1074.6708 9439.31581   978%  5510 2752s
  4441  2778 1477.58782   26  474 -1074.6708 9439.31581   978%  5509 2755s
  4442  2779  448.81276   35  524 -1074.6708 9439.31581   978%  5507 2770s
  4443  2780 2986.18188   60  526 -1074.6708 9439.31581   978%  5506 2775s
  4444  2780 3267.64164   14  568 -1074.6708 9439.31581   978%  5505 2790s
  4445  2781  396.41147   21  530 -1074.6708 9439.31581   978%  5504 2796s
  4446  2782 -209.18001   23  561 -1074.6708 9439.31581   978%  5503 2810s
  4447  2782  970.46057   35  509 -1074.6708 9439.31581   978%  5501 2819s
  4448  2783  486.98135   57  419 -1074.6708 9439.31581   978%  5500 2826s
  4449  2784 5157.78556   33  517 -1074.6708 9439.31581   978%  5499 2830s
  4450  2784 2882.09194   67  520 -1074.6708 9439.31581   978%  5498 2837s
  4451  2785 6634.18913   13  520 -1074.6708 9439.31581   978%  5496 2853s
  4452  2786 -647.77954   21  520 -1074.6708 9439.31581   978%  5495 2927s
  4453  2789 9439.31581   15  497 -1074.6708 9439.31581   978%  5590 3035s
  4455  2793 9439.31581   16  496 -1074.6708 9439.31581   978%  5592 3083s
  4459  2799 9217.47551   17  366 -1074.6708 9439.31581   978%  5602 3140s
  4467  2813 8955.44745   18  395 -1074.6708 9213.75769   957%  5616 3188s
  4483  2823 6767.97736   19  291 -1074.6708 8955.41518   933%  5691 3300s
  4499  2850 7159.72940   20  460 -1074.6708 8955.41518   933%  5752 3354s
  4531  2937 6196.85533   21  335 -1074.6708 8955.41518   933%  5779 3408s
  4635  2949 5895.90700   23  327 -1074.6708 8955.41518   933%  5906 3438s
  4691  2954 1113.76628   25  200 -1074.6708 8955.41518   933%  5895 3486s
  4739  2956  957.38703   26  172 -1074.6708 8955.41518   933%  5883 3531s
  4792  2935  767.50828   27  180 -1074.6708 8955.41518   933%  5873 3570s
  4837  2915 5696.16597   24  350 -1074.6708 8955.41518   933%  5863 3600s

Cutting planes:
  Learned: 2
  Gomory: 18
  Implied bound: 7
  Projected implied bound: 238
  MIR: 1386
  Mixing: 1
  Flow cover: 2583
  RLT: 19
  Relax-and-lift: 379

Explored 4861 nodes (29196581 simplex iterations) in 3600.04 seconds (8853.52 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -1074.67 -1157.18 -1215.58 ... -74580.6

Time limit reached
Best objective -1.074670836449e+03, best bound 8.955415177251e+03, gap 933.3170%
  WARNING: Time limit reached. Using best solution found (gap: 933.32%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.05s
  Master Objective (UB) = -1074.67, θ = 141807.97
  Upper Bound (UB) = -1074.67

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 141807.97
  [DEBUG]   ✓ Scenario 0: θ = 141807.97 ≤ Q = 141807.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 141807.97 ≤ Q = 141807.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 141807.97 ≤ Q = 141807.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 141807.97 ≤ Q = 141807.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 141807.97 ≤ Q = 141807.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 141807.97 ≤ Q = 141807.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 141807.97 ≤ Q = 141807.97 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 141807.97 ≤ Q = 141807.97 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 141807.97 ≤ Q = 141807.97 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 141807.97 ≤ Q = 141807.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 141807.97 ≤ Q = 141807.97 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 141807.97 ≤ Q = 141807.97 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 141807.97 ≤ Q = 141807.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 141807.97 ≤ Q = 141807.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 141807.97 ≤ Q = 141807.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 141807.97 ≤ Q = 141807.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 141807.97 ≤ Q = 141807.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 141807.97 ≤ Q = 141807.97 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 18] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x73dc01fe
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x73dc01fe
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.153573e+13
Presolve removed 2598 rows and 1890 columns
Presolve time: 0.00s
Presolved: 495 rows, 499 columns, 1396 nonzeros
Found heuristic solution: objective 5695161.0665
Variable types: 339 continuous, 160 integer (160 binary)

Root relaxation: objective -1.290101e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -129010.12    0  123 5695161.07 -129010.12   102%     -    0s
H    0     0                    -96822.14972 -129010.12  33.2%     -    0s
H    0     0                    -97439.72869 -129010.12  32.4%     -    0s
     0     0 -103607.45    0   62 -97439.729 -103607.45  6.33%     -    0s
H    0     0                    -101067.5813 -103501.57  2.41%     -    0s
H    0     0                    -101405.2161 -103501.57  2.07%     -    0s
H    0     0                    -101754.5576 -103501.57  1.72%     -    0s
H    0     0                    -102092.1924 -103501.57  1.38%     -    0s
     0     0 -103128.20    0   60 -102092.19 -103128.20  1.01%     -    0s
     0     0 -103007.60    0   65 -102092.19 -103007.60  0.90%     -    0s
     0     0 -102669.64    0   34 -102092.19 -102669.64  0.57%     -    0s
     0     0 -102635.47    0   40 -102092.19 -102635.47  0.53%     -    0s
     0     0 -102631.34    0   42 -102092.19 -102631.34  0.53%     -    0s
     0     0 -102443.41    0   41 -102092.19 -102443.41  0.34%     -    0s
     0     0 -102430.61    0   40 -102092.19 -102430.61  0.33%     -    0s
     0     0 -102383.80    0   38 -102092.19 -102383.80  0.29%     -    0s
     0     0 -102380.98    0   38 -102092.19 -102380.98  0.28%     -    0s
H    0     0                    -102119.1106 -102376.70  0.25%     -    0s
     0     0 -102376.70    0   49 -102119.11 -102376.70  0.25%     -    0s
     0     0 -102376.70    0   38 -102119.11 -102376.70  0.25%     -    0s
     0     0 -102346.47    0   32 -102119.11 -102346.47  0.22%     -    0s
     0     0 -102317.16    0   34 -102119.11 -102317.16  0.19%     -    0s
     0     0 -102312.27    0   34 -102119.11 -102312.27  0.19%     -    0s
     0     0 -102310.92    0   34 -102119.11 -102310.92  0.19%     -    0s
     0     0 -102268.20    0   30 -102119.11 -102268.20  0.15%     -    0s
     0     0 -102265.75    0   30 -102119.11 -102265.75  0.14%     -    0s
     0     0 -102265.75    0   30 -102119.11 -102265.75  0.14%     -    0s
     0     0 -102265.75    0   37 -102119.11 -102265.75  0.14%     -    0s
     0     0 -102265.75    0   29 -102119.11 -102265.75  0.14%     -    0s
     0     0 -102265.75    0   27 -102119.11 -102265.75  0.14%     -    0s
     0     0 -102259.78    0   21 -102119.11 -102259.78  0.14%     -    0s
     0     0 -102256.38    0   20 -102119.11 -102256.38  0.13%     -    0s
     0     0 -102256.31    0   20 -102119.11 -102256.31  0.13%     -    0s
     0     0 -102162.14    0    6 -102119.11 -102162.14  0.04%     -    0s
     0     0 -102134.29    0    5 -102119.11 -102134.29  0.01%     -    0s

Cutting planes:
  Gomory: 13
  Implied bound: 2
  MIR: 34
  Flow cover: 11
  RLT: 4
  Relax-and-lift: 4

Explored 1 nodes (1170 simplex iterations) in 0.17 seconds (0.08 work units)
Thread count was 32 (of 256 available processors)

Solution count 8: -102119 -102092 -101935 ... 1.15357e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.021191106397e+05, best bound -1.021273780060e+05, gap 0.0081%
  Subproblem solved in 0.19s
  Worst-case operational profit (Z_SP) = 139341.31
  Scenario: 23 demand increases, 37 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -102119.11
  [DEBUG]   S×d_nominal = 241460.42
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 241460.42 + -102119.11 = 139341.31
  [DEBUG]   Current θ from Master = 141807.97
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2466.66 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -3541.33
  Lower Bound (LB) = -1589.09
  Gap (UB-LB) = 514.4183, Absolute Gap = 514.4183, Relative Gap = 0.478675
  Not converged yet (gap = 514.42 > ε = 200)

  [DEBUG] Adding NEW scenario 18 to Master Problem...
  [DEBUG] New scenario pattern: 23 increases, 37 decreases
    [DEBUG] Scenario 18 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 18 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 18]
    [DEBUG]   - Total constraints in model: 291893
    [DEBUG]   - Total variables in model: 120820
  [DEBUG] Total scenarios in Master: 19
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 19
================================================================================
[Iteration 19] Solving Master Problem...
  Current scenarios in Master: 19
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 291893 rows, 120820 columns and 826908 nonzeros
Model fingerprint: 0x01239bcb
Variable types: 118561 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 134330 rows and 54530 columns
Presolve time: 4.03s
Presolved: 157563 rows, 66290 columns, 970002 nonzeros
Variable types: 64031 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -373180.1084
Found heuristic solution: objective -219438.1934

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.62s

Barrier statistics:
 Dense cols : 596
 AA' NZ     : 9.411e+06
 Factor NZ  : 2.088e+07 (roughly 260 MB of memory)
 Factor Ops : 5.409e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.62746140e+07  2.50447132e+08  9.21e+04 1.69e+01  6.81e+04     7s
   1  -1.26554997e+07  2.19307172e+08  6.61e+04 4.85e+01  4.85e+04     7s
   2  -4.61371408e+06  1.78202996e+08  2.27e+04 5.82e+00  1.74e+04     7s
   3  -8.73934794e+05  1.25168138e+08  1.74e+03 1.35e+00  1.69e+03     7s
   4  -5.80865557e+05  6.88125656e+07  4.71e+02 5.68e-01  5.55e+02     7s
   5  -5.10015201e+05  4.30176936e+07  2.63e+02 2.96e-01  3.11e+02     7s
   6  -4.31057563e+05  3.32258350e+07  8.79e+01 2.16e-01  1.67e+02     7s
   7  -3.67586213e+05  2.50262032e+07  4.40e+01 1.54e-01  1.11e+02     7s
   8  -2.59260203e+05  1.59612813e+07  9.80e+00 9.16e-02  6.03e+01     7s
   9  -1.94662985e+05  1.10562918e+07  4.79e+00 6.22e-02  4.05e+01     7s
  10  -1.53483901e+05  8.06617796e+06  2.97e+00 4.53e-02  2.93e+01     7s
  11  -1.18276325e+05  3.79415471e+06  1.22e+00 2.06e-02  1.38e+01     7s
  12  -9.75649004e+04  2.81746500e+06  6.37e-01 1.55e-02  1.02e+01     7s
  13  -7.44084896e+04  1.33099857e+06  2.71e-01 7.28e-03  4.90e+00     7s
  14  -5.42384012e+04  5.80261981e+05  1.27e-01 3.28e-03  2.21e+00     8s
  15  -3.77041175e+04  2.87535160e+05  7.68e-02 1.61e-03  1.13e+00     8s
  16  -2.10310574e+04  2.06723515e+05  5.14e-02 1.59e-03  7.93e-01     8s
  17  -1.52030556e+04  1.70961707e+05  4.40e-02 1.36e-03  6.48e-01     8s
  18  -9.87850005e+03  1.11713381e+05  3.67e-02 1.45e-03  4.24e-01     8s
  19  -5.65365443e+03  9.28031703e+04  3.17e-02 1.14e-03  3.43e-01     8s
  20  -4.67649065e+02  7.26802126e+04  2.59e-02 8.01e-04  2.55e-01     8s
  21   4.77683120e+03  6.38706776e+04  2.01e-02 6.48e-04  2.06e-01     8s
  22   6.80093161e+03  5.77805768e+04  1.80e-02 5.19e-04  1.78e-01     8s
  23   8.61920277e+03  4.86897015e+04  1.61e-02 3.71e-04  1.40e-01     8s
  24   1.09577884e+04  4.48168028e+04  1.37e-02 3.16e-04  1.18e-01     8s
  25   1.32976246e+04  4.22925023e+04  1.15e-02 5.07e-04  1.01e-01     8s
  26   1.66638124e+04  3.94239401e+04  8.34e-03 4.13e-04  7.93e-02     8s
  27   1.86119471e+04  3.66537001e+04  6.64e-03 3.18e-04  6.28e-02     9s
  28   1.98505314e+04  3.50404396e+04  5.61e-03 2.64e-04  5.29e-02     9s
  29   2.00742375e+04  3.44278715e+04  5.43e-03 2.46e-04  5.00e-02     9s
  30   2.12074179e+04  3.30051439e+04  4.49e-03 2.04e-04  4.11e-02     9s
  31   2.19831851e+04  3.15290727e+04  3.90e-03 1.51e-04  3.33e-02     9s
  32   2.24904519e+04  3.12205591e+04  3.52e-03 1.40e-04  3.04e-02     9s
  33   2.28952676e+04  3.09570880e+04  3.23e-03 1.31e-04  2.81e-02     9s
  34   2.34467655e+04  3.07816919e+04  2.79e-03 1.24e-04  2.56e-02     9s
  35   2.37365349e+04  3.01237909e+04  2.58e-03 1.17e-04  2.23e-02     9s
  36   2.40442937e+04  2.96816834e+04  2.36e-03 9.82e-05  1.96e-02     9s
  37   2.47239337e+04  2.92762926e+04  1.86e-03 8.04e-05  1.59e-02     9s
  38   2.55203426e+04  2.88412161e+04  1.30e-03 6.24e-05  1.16e-02    10s
  39   2.60738991e+04  2.83462368e+04  9.02e-04 3.90e-05  7.92e-03    10s
  40   2.64800401e+04  2.80575625e+04  6.30e-04 2.23e-05  5.50e-03    10s
  41   2.70409957e+04  2.77845868e+04  2.72e-04 1.16e-05  2.59e-03    10s
  42   2.71375716e+04  2.76402373e+04  2.11e-04 6.75e-06  1.75e-03    10s
  43   2.73185595e+04  2.75741126e+04  1.01e-04 3.61e-06  8.90e-04    10s
  44   2.74040398e+04  2.75342923e+04  4.98e-05 1.72e-06  4.54e-04    10s
  45   2.74414267e+04  2.75104548e+04  2.78e-05 7.09e-07  2.40e-04    10s
  46   2.74544171e+04  2.75030724e+04  2.04e-05 4.23e-07  1.70e-04    10s
  47   2.74656004e+04  2.75012393e+04  1.41e-05 3.54e-07  1.24e-04    10s
  48   2.74673918e+04  2.74980096e+04  1.32e-05 2.59e-07  1.07e-04    10s
  49   2.74881038e+04  2.74950791e+04  1.67e-06 1.43e-07  2.43e-05    10s
  50   2.74887661e+04  2.74947936e+04  1.40e-06 1.52e-07  2.10e-05    11s
  51   2.74905790e+04  2.74942307e+04  6.17e-07 9.83e-08  1.27e-05    11s
  52   2.74916196e+04  2.74927407e+04  1.87e-07 4.16e-08  3.90e-06    11s
  53   2.74919314e+04  2.74923788e+04  8.42e-08 2.05e-08  1.56e-06    11s
  54   2.74921628e+04  2.74922292e+04  1.50e-08 6.85e-09  2.32e-07    11s
  55   2.74921906e+04  2.74921926e+04  3.65e-08 1.99e-08  7.01e-09    11s
  56   2.74921910e+04  2.74921925e+04  1.89e-07 1.17e-08  5.26e-09    11s
  57   2.74921922e+04  2.74921923e+04  5.94e-08 2.59e-08  5.69e-10    11s

Barrier solved model in 57 iterations and 11.30 seconds (19.30 work units)
Optimal objective 2.74921922e+04


Root crossover log...

  141894 DPushes remaining with DInf 0.0000000e+00                11s
    7016 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                16s

   11011 PPushes remaining with PInf 1.0999497e-04                16s
       0 PPushes remaining with PInf 0.0000000e+00                17s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.5025485e+02     17s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   76435    2.7492192e+04   0.000000e+00   1.502549e+02     17s
   76544    2.7492192e+04   0.000000e+00   0.000000e+00     17s
   76544    2.7492192e+04   0.000000e+00   0.000000e+00     17s
Concurrent spin time: 8.09s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 2.749219e+04, 76544 iterations, 20.56 seconds (26.95 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 27492.1923    0  137 -219438.19 27492.1923   113%     -   26s
H    0     0                    -138121.4900 27492.1923   120%     -   26s
H    0     0                    -129034.6323 27492.1923   121%     -   26s
H    0     0                    -128635.2849 27492.1923   121%     -   26s
H    0     0                    -127778.7909 27492.1923   122%     -   26s
H    0     0                    -71394.31792 27492.1923   139%     -   26s
H    0     0                    -10573.50184 27492.1923   360%     -   27s
H    0     0                    -2753.940075 27492.1923  1098%     -   27s
H    0     0                    -1215.581857 27492.1923  2362%     -   27s
     0     0 21880.2155    0  213 -1215.5819 21880.2155  1900%     -   59s
H    0     0                    -1212.688072 21854.2453  1902%     -   60s
     0     0 21461.0270    0  256 -1212.6881 21461.0270  1870%     -   75s
     0     0 21433.0176    0  256 -1212.6881 21433.0176  1867%     -   80s
     0     0 21430.5494    0  247 -1212.6881 21430.5494  1867%     -   82s
     0     0 21430.5400    0  250 -1212.6881 21430.5400  1867%     -   83s
     0     0 18798.5407    0  241 -1212.6881 18798.5407  1650%     -  129s
     0     0 18518.8007    0  248 -1212.6881 18518.8007  1627%     -  143s
     0     0 18430.7224    0  254 -1212.6881 18430.7224  1620%     -  153s
     0     0 18115.8164    0  240 -1212.6881 18115.8164  1594%     -  163s
     0     0 18014.5073    0  248 -1212.6881 18014.5073  1586%     -  173s
     0     0 17872.8054    0  240 -1212.6881 17872.8054  1574%     -  182s
     0     0 17850.6070    0  240 -1212.6881 17850.6070  1572%     -  186s
     0     0 17849.4315    0  234 -1212.6881 17849.4315  1572%     -  187s
     0     0 17848.7359    0  234 -1212.6881 17848.7359  1572%     -  188s
     0     0 14841.1417    0  331 -1212.6881 14841.1417  1324%     -  236s
     0     0 14147.4704    0  360 -1212.6881 14147.4704  1267%     -  259s
     0     0 13865.2757    0  409 -1212.6881 13865.2757  1243%     -  272s
     0     0 13744.7955    0  421 -1212.6881 13744.7955  1233%     -  280s
     0     0 13729.9073    0  423 -1212.6881 13729.9073  1232%     -  283s
     0     0 13713.5119    0  428 -1212.6881 13713.5119  1231%     -  287s
     0     0 13706.5771    0  428 -1212.6881 13706.5771  1230%     -  290s
     0     0 13662.5236    0  395 -1212.6881 13662.5236  1227%     -  296s
     0     0 13635.0997    0  439 -1212.6881 13635.0997  1224%     -  304s
     0     0 13630.4719    0  444 -1212.6881 13630.4719  1224%     -  307s
     0     0 13625.9626    0  438 -1212.6881 13625.9626  1224%     -  309s
     0     0 13615.7993    0  439 -1212.6881 13615.7993  1223%     -  313s
     0     0 13610.1717    0  425 -1212.6881 13610.1717  1222%     -  316s
     0     0 13609.9174    0  425 -1212.6881 13609.9174  1222%     -  317s
     0     0 12251.8437    0  452 -1212.6881 12251.8437  1110%     -  357s
     0     0 11751.8874    0  462 -1212.6881 11751.8874  1069%     -  382s
     0     0 11626.8133    0  459 -1212.6881 11626.8133  1059%     -  393s
     0     0 11558.7860    0  470 -1212.6881 11558.7860  1053%     -  401s
     0     0 11516.0646    0  517 -1212.6881 11516.0646  1050%     -  409s
     0     0 11485.1671    0  532 -1212.6881 11485.1671  1047%     -  414s
     0     0 11460.7361    0  489 -1212.6881 11460.7361  1045%     -  418s
     0     0 11449.9722    0  488 -1212.6881 11449.9722  1044%     -  420s
     0     0 11443.8104    0  486 -1212.6881 11443.8104  1044%     -  422s
     0     0 11437.2883    0  535 -1212.6881 11437.2883  1043%     -  424s
     0     0 11431.6601    0  529 -1212.6881 11431.6601  1043%     -  426s
     0     0 11426.5504    0  531 -1212.6881 11426.5504  1042%     -  427s
     0     0 11420.8710    0  492 -1212.6881 11420.8710  1042%     -  429s
     0     0 11417.0677    0  539 -1212.6881 11417.0677  1041%     -  430s
     0     0 11415.8502    0  539 -1212.6881 11415.8502  1041%     -  431s
     0     0 11078.5885    0  527 -1212.6881 11078.5885  1014%     -  458s
     0     0 10976.0114    0  515 -1212.6881 10976.0114  1005%     -  474s
     0     0 10953.8794    0  579 -1212.6881 10953.8794  1003%     -  483s
     0     0 10938.8083    0  468 -1212.6881 10938.8083  1002%     -  488s
     0     0 10908.2205    0  537 -1212.6881 10908.2205  1000%     -  496s
     0     0 10904.2873    0  587 -1212.6881 10904.2873   999%     -  500s
     0     0 10837.2873    0  519 -1212.6881 10837.2873   994%     -  511s
     0     0 10824.9143    0  583 -1212.6881 10824.9143   993%     -  518s
     0     0 10821.3263    0  515 -1212.6881 10821.3263   992%     -  522s
     0     0 10819.6622    0  579 -1212.6881 10819.6622   992%     -  524s
     0     0 10662.2231    0  457 -1212.6881 10662.2231   979%     -  543s
     0     0 10662.2231    0  457 -1212.6881 10662.2231   979%     -  543s
H    0     0                    -1200.380362 10662.1431   988%     -  549s
H    0     0                    -1091.432085 10662.1431  1077%     -  549s
     0     0 10603.7324    0  513 -1091.4321 10603.7324  1072%     -  562s
     0     0 10544.9285    0  440 -1091.4321 10544.9285  1066%     -  570s
     0     0 10526.0814    0  451 -1091.4321 10526.0814  1064%     -  574s
     0     0 10521.8584    0  455 -1091.4321 10521.8584  1064%     -  576s
     0     0 10518.8406    0  461 -1091.4321 10518.8406  1064%     -  577s
     0     0 10516.8977    0  464 -1091.4321 10516.8977  1064%     -  578s
     0     0 10396.0238    0  483 -1091.4321 10396.0238  1053%     -  592s
     0     0 10339.5527    0  536 -1091.4321 10339.5527  1047%     -  600s
     0     0 10323.3236    0  472 -1091.4321 10323.3236  1046%     -  606s
     0     0 10307.2223    0  542 -1091.4321 10307.2223  1044%     -  609s
     0     0 10305.9323    0  538 -1091.4321 10305.9323  1044%     -  612s
     0     0 10275.5273    0  577 -1091.4321 10275.5273  1041%     -  621s
     0     0 10230.3540    0  583 -1091.4321 10230.3540  1037%     -  642s
     0     0 10216.6446    0  581 -1091.4321 10216.6446  1036%     -  649s
     0     0 10210.8597    0  581 -1091.4321 10210.8597  1036%     -  652s
     0     0 10205.7822    0  519 -1091.4321 10205.7822  1035%     -  655s
     0     0 10203.6782    0  578 -1091.4321 10203.6782  1035%     -  656s
     0     0 10137.5644    0  572 -1091.4321 10137.5644  1029%     -  667s
     0     0 10098.8594    0  525 -1091.4321 10098.8594  1025%     -  675s
     0     0 10089.1530    0  536 -1091.4321 10089.1530  1024%     -  679s
     0     0 10086.7983    0  538 -1091.4321 10086.7983  1024%     -  680s
     0     0 10057.9726    0  469 -1091.4321 10057.9726  1022%     -  686s
     0     0 10047.1860    0  458 -1091.4321 10047.1860  1021%     -  694s
     0     0 10044.6992    0  564 -1091.4321 10044.6992  1020%     -  697s
     0     0 10036.6829    0  560 -1091.4321 10036.6829  1020%     -  699s
     0     0 10033.1744    0  576 -1091.4321 10033.1744  1019%     -  701s
     0     0 10032.8612    0  572 -1091.4321 10032.8612  1019%     -  702s
     0     0 10028.4848    0  561 -1091.4321 10028.4848  1019%     -  707s
     0     0 10026.2668    0  527 -1091.4321 10026.2668  1019%     -  711s
     0     0 10021.2427    0  537 -1091.4321 10021.2427  1018%     -  714s
     0     0 10019.1031    0  447 -1091.4321 10019.1031  1018%     -  721s
     0     0 10008.1974    0  455 -1091.4321 10008.1974  1017%     -  724s
     0     0 10007.1057    0  459 -1091.4321 10007.1057  1017%     -  726s
     0     0 10004.4955    0  456 -1091.4321 10004.4955  1017%     -  730s
H    0     0                    -1082.616560 10003.8482  1024%     -  797s
     0     0 10002.1152    0  471 -1082.6166 10002.1152  1024%     -  802s
     0     0 9998.41643    0  527 -1082.6166 9998.41643  1024%     -  806s
     0     0 9998.31902    0  527 -1082.6166 9998.31902  1024%     -  810s
H    0     0                    -1077.564622 9998.31902  1028%     -  904s
     0     2 9998.31902    0  527 -1077.5646 9998.31902  1028%     -  912s
     1     3 9829.68028    1  442 -1077.5646 9998.31902  1028%  8530  919s
     2     4 9930.93484    1  518 -1077.5646 9930.93484  1022%  8881  933s
     3     8 9588.36206    2  565 -1077.5646 9930.62459  1022% 11340  949s
     7    16 8738.21233    3  498 -1077.5646 9772.25694  1007% 11111  985s
    15    31 8698.34752    4  500 -1077.5646 9714.99359  1002% 14119 1020s
    30    46 8841.47466    5  468 -1077.5646 9714.99359  1002% 20410 1096s
    45    72 7586.59819    6  484 -1077.5646 9344.61842   967% 22307 1226s
    71   199 7361.61273    7  525 -1077.5646 9344.61842   967% 20185 1298s
   198   258 6801.60469   12  504 -1077.5646 9344.61842   967% 12025 1328s
   257   324 6677.23050   14  556 -1077.5646 9344.61842   967% 11736 1367s
   325   381 6666.05761   19  550 -1077.5646 9344.61842   967%  9936 1401s
   384   453 6512.12731   22  586 -1077.5646 9344.61842   967%  9013 1440s
   460   491 6367.23993   25  570 -1077.5646 9344.61842   967%  8030 1478s
   498   526 6172.44839   26  510 -1077.5646 9344.61842   967%  7843 1514s
   533   549 1434.52416   25  248 -1077.5646 9344.61842   967%  7672 1545s
   558   581 infeasible   26      -1077.5646 9344.61842   967%  7551 1570s
   596   617 5804.01639   23  497 -1077.5646 9344.61842   967%  7442 1597s
   632   657 5615.41673   24  478 -1077.5646 9344.61842   967%  7257 1624s
   674   703 5398.42503   29  472 -1077.5646 9344.61842   967%  7010 1648s
   726   763 5120.94135   34  408 -1077.5646 9344.61842   967%  6747 1674s
   790   805 4654.50250   38  410 -1077.5646 9344.61842   967%  6436 1694s
   842   861 4414.31337   43  395 -1077.5646 9344.61842   967%  6237 1748s
   906   908 4021.92321   48  295 -1077.5646 9344.61842   967%  5963 1772s
   967   979 3877.02470   52  273 -1077.5646 9344.61842   967%  5728 1798s
  1050  1015 2877.23102   59  334 -1077.5646 9344.61842   967%  5470 1829s
  1090  1054 2864.31129   60  335 -1077.5646 9344.61842   967%  5404 1851s
  1155  1076 2843.41488   61  328 -1077.5646 9344.61842   967%  5271 1882s
  1193  1130 2380.47564   62  382 -1077.5646 9344.61842   967%  5257 1906s
  1251  1207 2278.98680   63  379 -1077.5646 9344.61842   967%  5148 1938s
  1345  1312 2136.88580   71  234 -1077.5646 9344.61842   967%  4954 1968s
  1473  1411 1002.38543   80  174 -1077.5646 9344.61842   967%  4651 2000s
  1606  1454  160.83317   90  209 -1077.5646 9344.61842   967%  4436 2049s
  1737  1499 3581.89334   23  447 -1077.5646 9344.61842   967%  4293 2089s
  1862  1539 3498.62565   24  383 -1077.5646 9344.61842   967%  4202 2136s
  1979  1594 3387.94226   26  469 -1077.5646 9344.61842   967%  4124 2178s
  2095  1629 infeasible   29      -1077.5646 9344.61842   967%  4082 2228s
  2192  1721 5749.76141   11  334 -1077.5646 9344.61842   967%  4063 2285s
  2326  1857 4378.78737   12  240 -1077.5646 9344.61842   967%  4012 2337s
  2532  1980 1750.21884   49  295 -1077.5646 9344.61842   967%  3886 2387s
  2733  2097 infeasible   69      -1077.5646 9020.53783   937%  3759 2442s
  2964  2136 7456.57316    6  282 -1077.5646 9020.53783   937%  3649 2506s
  3134  2209 7012.81991    8  333 -1077.5646 9020.53783   937%  3607 2568s
  3288  2292 6480.49888   11  320 -1077.5646 9020.53783   937%  3620 2638s
  3443  2387  513.09041   13  116 -1077.5646 9020.53783   937%  3641 2705s
  3622  2439     cutoff   17      -1077.5646 9020.53783   937%  3648 2761s
  3742  2572  325.31425   67  260 -1077.5646 9020.53783   937%  3664 2823s
  3943  2638     cutoff   85      -1077.5646 9020.53783   937%  3642 2890s
  4093  2710 -427.39499    9  197 -1077.5646 8932.53950   929%  3660 2966s
  4271  2815 infeasible   61      -1077.5646 8377.90114   877%  3677 3046s
  4413  2816  535.66864   79  527 -1077.5646 8377.90114   877%  3720 3387s
  4415  2817  129.21154  100  132 -1077.5646 8377.90114   877%  3718 3401s
  4416  2818 2624.55378   33  382 -1077.5646 8377.90114   877%  3717 3479s
  4417  2819  349.15357   11  352 -1077.5646 8377.90114   877%  3716 3551s
  4418  2819 2246.38689   27  434 -1077.5646 8377.90114   877%  3715 3586s

Cutting planes:
  Gomory: 25
  Implied bound: 21
  Projected implied bound: 122
  MIR: 1115
  Mixing: 1
  Flow cover: 1170
  RLT: 20
  Relax-and-lift: 291

Explored 4418 nodes (17415558 simplex iterations) in 3600.03 seconds (7902.07 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -1077.56 -1082.62 -1091.43 ... -127779

Time limit reached
Best objective -1.077564621581e+03, best bound 8.377901136737e+03, gap 877.4848%
  WARNING: Time limit reached. Using best solution found (gap: 877.48%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.10s
  Master Objective (UB) = -1077.56, θ = 141390.04
  Upper Bound (UB) = -1077.56

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 141390.04
  [DEBUG]   ✓ Scenario 0: θ = 141390.04 ≤ Q = 141390.04 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 141390.04 ≤ Q = 141390.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 141390.04 ≤ Q = 141390.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 141390.04 ≤ Q = 141390.04 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 141390.04 ≤ Q = 141390.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 141390.04 ≤ Q = 141390.04 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 141390.04 ≤ Q = 141390.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 141390.04 ≤ Q = 141390.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 141390.04 ≤ Q = 141390.04 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 141390.04 ≤ Q = 141390.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 141390.04 ≤ Q = 141390.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 141390.04 ≤ Q = 141390.04 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 141390.04 ≤ Q = 141390.04 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 141390.04 ≤ Q = 141390.04 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 141390.04 ≤ Q = 141390.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 141390.04 ≤ Q = 141390.04 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 141390.04 ≤ Q = 141390.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 141390.04 ≤ Q = 141390.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 141390.04 ≤ Q = 141390.04 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 19] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x133bae9b
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x133bae9b
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.159554e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.00s
Presolved: 494 rows, 498 columns, 1396 nonzeros
Found heuristic solution: objective 5731777.0232
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.294575e+05, 241 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -129457.46    0  123 5731777.02 -129457.46   102%     -    0s
H    0     0                    -97219.49880 -129457.46  33.2%     -    0s
H    0     0                    -97837.07777 -129457.46  32.3%     -    0s
H    0     0                    -101490.7410 -105223.03  3.68%     -    0s
     0     0 -105223.03    0  106 -101490.74 -105223.03  3.68%     -    0s
H    0     0                    -102592.3238 -105102.82  2.45%     -    0s
     0     0 -104361.58    0  108 -102592.32 -104361.58  1.72%     -    0s
     0     0 -104277.84    0  108 -102592.32 -104277.84  1.64%     -    0s
H    0     0                    -102800.0405 -104277.84  1.44%     -    0s
     0     0 -104077.78    0  106 -102800.04 -104077.78  1.24%     -    0s
     0     0 -104023.55    0  111 -102800.04 -104023.55  1.19%     -    0s
     0     0 -104011.78    0  111 -102800.04 -104011.78  1.18%     -    0s
     0     0 -103513.32    0  112 -102800.04 -103513.32  0.69%     -    0s
     0     0 -103489.91    0  111 -102800.04 -103489.91  0.67%     -    0s
     0     0 -103486.13    0  103 -102800.04 -103486.13  0.67%     -    0s
     0     0 -103433.02    0  101 -102800.04 -103433.02  0.62%     -    0s
     0     0 -103421.76    0  101 -102800.04 -103421.76  0.60%     -    0s
H    0     0                    -103130.0697 -103421.76  0.28%     -    0s
     0     2 -103421.76    0  101 -103130.07 -103421.76  0.28%     -    0s
H   28     9                    -103150.8050 -103281.04  0.13%   7.9    0s
H   35     8                    -103215.9349 -103281.04  0.06%   7.3    0s
H   66     9                    -103231.3663 -103235.32  0.00%   6.4    0s

Cutting planes:
  Gomory: 30
  Implied bound: 2
  MIR: 198
  Flow cover: 3
  RLT: 3
  BQP: 2

Explored 84 nodes (1140 simplex iterations) in 0.12 seconds (0.08 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -103231 -103216 -103151 ... 1.15955e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.032313663395e+05, best bound -1.032320122741e+05, gap 0.0006%
  Subproblem solved in 0.14s
  Worst-case operational profit (Z_SP) = 138229.05
  Scenario: 29 demand increases, 31 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -103231.37
  [DEBUG]   S×d_nominal = 241460.42
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 241460.42 + -103231.37 = 138229.05
  [DEBUG]   Current θ from Master = 141390.04
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3160.99 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -4238.55
  Lower Bound (LB) = -1589.09
  Gap (UB-LB) = 511.5246, Absolute Gap = 511.5246, Relative Gap = 0.474704
  Not converged yet (gap = 511.52 > ε = 200)

  [DEBUG] Adding NEW scenario 19 to Master Problem...
  [DEBUG] New scenario pattern: 29 increases, 31 decreases
    [DEBUG] Scenario 19 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 19 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 19]
    [DEBUG]   - Total constraints in model: 307183
    [DEBUG]   - Total variables in model: 127060
  [DEBUG] Total scenarios in Master: 20
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 20
================================================================================
[Iteration 20] Solving Master Problem...
  Current scenarios in Master: 20
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 307183 rows, 127060 columns and 870139 nonzeros
Model fingerprint: 0x972ec44b
Variable types: 124801 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 141400 rows and 57400 columns
Presolve time: 2.74s
Presolved: 165783 rows, 69660 columns, 1022097 nonzeros
Variable types: 67401 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -373180.1084
Found heuristic solution: objective -219438.1934

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.37s

Barrier statistics:
 Dense cols : 1189
 AA' NZ     : 3.911e+06
 Factor NZ  : 1.104e+07 (roughly 200 MB of memory)
 Factor Ops : 3.992e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.65373305e+07  2.61628010e+08  9.36e+04 1.64e+01  6.88e+04     5s
   1  -1.28654833e+07  2.29274452e+08  6.71e+04 4.74e+01  4.90e+04     5s
   2  -4.46037145e+06  1.87103033e+08  2.17e+04 6.07e+00  1.66e+04     5s
   3  -9.40001874e+05  1.31090068e+08  2.10e+03 1.39e+00  1.94e+03     5s
   4  -5.95221466e+05  9.90441136e+07  5.32e+02 9.07e-01  6.94e+02     5s
   5  -5.36546751e+05  4.74724146e+07  3.32e+02 3.26e-01  3.56e+02     5s
   6  -4.31886792e+05  3.79458795e+07  8.57e+01 2.44e-01  1.76e+02     5s
   7  -3.80164072e+05  2.75100733e+07  4.40e+01 1.67e-01  1.14e+02     5s
   8  -2.92096939e+05  2.08140680e+07  1.28e+01 1.22e-01  7.54e+01     5s
   9  -1.85024651e+05  1.17274419e+07  2.73e+00 6.75e-02  4.02e+01     5s
  10  -1.55621310e+05  6.97312667e+06  1.90e+00 4.11e-02  2.39e+01     5s
  11  -1.30096973e+05  5.34098113e+06  1.30e+00 3.12e-02  1.83e+01     5s
  12  -1.14073015e+05  3.83210120e+06  8.95e-01 2.24e-02  1.32e+01     5s
  13  -1.07980153e+05  3.14295808e+06  7.48e-01 1.84e-02  1.08e+01     5s
  14  -7.87012597e+04  1.21575677e+06  2.60e-01 7.02e-03  4.29e+00     5s
  15  -4.34708432e+04  4.97257661e+05  1.01e-01 2.93e-03  1.79e+00     5s
  16  -2.85230824e+04  3.15988256e+05  6.45e-02 1.76e-03  1.14e+00     5s
  17  -1.63371455e+04  2.25384798e+05  4.46e-02 1.32e-03  8.00e-01     5s
  18  -1.16838797e+04  1.30994484e+05  3.81e-02 1.10e-03  4.73e-01     5s
  19  -3.46768385e+03  9.74399140e+04  2.82e-02 1.11e-03  3.34e-01     5s
  20  -5.13809862e+02  7.92066499e+04  2.47e-02 8.83e-04  2.64e-01     6s
  21   3.48466626e+03  6.47951722e+04  2.05e-02 6.63e-04  2.03e-01     6s
  22   6.55696899e+03  5.58365628e+04  1.74e-02 5.04e-04  1.63e-01     6s
  23   7.96746818e+03  4.91775719e+04  1.59e-02 3.91e-04  1.37e-01     6s
  24   1.31911845e+04  4.56481301e+04  1.09e-02 3.28e-04  1.08e-01     6s
  25   1.52786523e+04  4.18599353e+04  8.95e-03 4.51e-04  8.80e-02     6s
  26   1.82026793e+04  4.02903718e+04  6.45e-03 4.40e-04  7.31e-02     6s
  27   1.93565731e+04  3.60590937e+04  5.53e-03 2.90e-04  5.53e-02     6s
  28   2.06600060e+04  3.51311672e+04  4.55e-03 2.58e-04  4.79e-02     6s
  29   2.10901563e+04  3.45620392e+04  4.21e-03 2.40e-04  4.46e-02     6s
  30   2.18884659e+04  3.32922390e+04  3.65e-03 2.03e-04  3.78e-02     6s
  31   2.24332142e+04  3.18824029e+04  3.25e-03 1.55e-04  3.13e-02     6s
  32   2.28026994e+04  3.14141653e+04  3.00e-03 1.39e-04  2.85e-02     6s
  33   2.32561928e+04  3.08902767e+04  2.70e-03 1.23e-04  2.53e-02     6s
  34   2.37905986e+04  3.06198556e+04  2.33e-03 1.14e-04  2.26e-02     7s
  35   2.44670852e+04  3.00816333e+04  1.87e-03 9.84e-05  1.86e-02     7s
  36   2.46670588e+04  2.94153697e+04  1.73e-03 7.39e-05  1.57e-02     7s
  37   2.58703417e+04  2.90800039e+04  9.80e-04 6.09e-05  1.06e-02     7s
  38   2.63693840e+04  2.85604222e+04  6.60e-04 4.05e-05  7.26e-03     7s
  39   2.67075740e+04  2.80902771e+04  4.46e-04 2.24e-05  4.58e-03     7s
  40   2.70150066e+04  2.78506711e+04  2.69e-04 1.31e-05  2.77e-03     7s
  41   2.72291376e+04  2.77364473e+04  1.43e-04 1.98e-05  1.68e-03     7s
  42   2.73060758e+04  2.75902002e+04  9.98e-05 8.67e-06  9.41e-04     7s
  43   2.73870632e+04  2.75433887e+04  5.50e-05 8.91e-06  5.18e-04     7s
  44   2.74277354e+04  2.75233558e+04  3.31e-05 5.44e-06  3.17e-04     7s
  45   2.74523816e+04  2.75095741e+04  2.01e-05 2.76e-06  1.89e-04     7s
  46   2.74624176e+04  2.75071068e+04  1.47e-05 2.37e-06  1.48e-04     7s
  47   2.74776359e+04  2.74966560e+04  6.82e-06 4.91e-07  6.30e-05     7s
  48   2.74855503e+04  2.74957803e+04  3.03e-06 4.05e-07  3.39e-05     7s
  49   2.74902231e+04  2.74928939e+04  8.43e-07 2.57e-07  8.85e-06     8s
  50   2.74919676e+04  2.74923554e+04  9.24e-08 1.46e-07  1.28e-06     8s
  51   2.74921516e+04  2.74921980e+04  1.62e-08 2.44e-08  1.54e-07     8s
  52   2.74921894e+04  2.74921936e+04  6.82e-09 6.17e-09  1.37e-08     8s
  53   2.74921922e+04  2.74921923e+04  2.19e-08 1.86e-08  3.08e-10     8s

Barrier solved model in 53 iterations and 7.91 seconds (15.74 work units)
Optimal objective 2.74921922e+04


Root crossover log...

  149199 DPushes remaining with DInf 0.0000000e+00                 8s
   17913 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                12s

    6528 PPushes remaining with PInf 5.4676865e-05                12s
       0 PPushes remaining with PInf 0.0000000e+00                12s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.2391696e+00     12s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   71426    2.7492192e+04   0.000000e+00   1.239170e+00     12s
   71482    2.7492192e+04   0.000000e+00   0.000000e+00     12s
   71482    2.7492192e+04   0.000000e+00   0.000000e+00     12s
Concurrent spin time: 0.79s

Solved with barrier

Root relaxation: objective 2.749219e+04, 71482 iterations, 9.76 seconds (21.10 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 27492.1923    0  137 -219438.19 27492.1923   113%     -   13s
H    0     0                    -155004.3314 27492.1923   118%     -   14s
H    0     0                    -149991.1237 27492.1923   118%     -   14s
H    0     0                    -149415.6196 27492.1923   118%     -   14s
H    0     0                    -71394.31792 27492.1923   139%     -   14s
H    0     0                    -14985.65816 27492.1923   283%     -   15s
H    0     0                    -13481.59929 27492.1923   304%     -   15s
H    0     0                    -5691.750090 27492.1923   583%     -   15s
H    0     0                    -2123.126513 27492.1923  1395%     -   15s
H    0     0                    -1935.951860 27492.1923  1520%     -   16s
H    0     0                    -1359.904056 27492.1923  2122%     -   16s
H    0     0                    -1218.384820 27492.1923  2356%     -   16s
     0     0 21645.7563    0  201 -1218.3848 21645.7563  1877%     -   42s
     0     0 21515.0637    0  231 -1218.3848 21515.0637  1866%     -   56s
     0     0 21432.4544    0  232 -1218.3848 21432.4544  1859%     -   65s
     0     0 21417.6582    0  234 -1218.3848 21417.6582  1858%     -   69s
     0     0 21416.7839    0  234 -1218.3848 21416.7839  1858%     -   70s
     0     0 21373.2495    0  237 -1218.3848 21373.2495  1854%     -   72s
     0     0 21372.9682    0  241 -1218.3848 21372.9682  1854%     -   73s
     0     0 19221.6445    0  231 -1218.3848 19221.6445  1678%     -  150s
     0     0 18912.9992    0  228 -1218.3848 18912.9992  1652%     -  185s
     0     0 18838.5215    0  243 -1218.3848 18838.5215  1646%     -  215s
     0     0 18389.6542    0  249 -1218.3848 18389.6542  1609%     -  239s
     0     0 18381.7822    0  253 -1218.3848 18381.7822  1609%     -  244s
     0     0 18354.4993    0  252 -1218.3848 18354.4993  1606%     -  251s
     0     0 18344.9928    0  252 -1218.3848 18344.9928  1606%     -  254s
     0     0 18333.1160    0  254 -1218.3848 18333.1160  1605%     -  257s
     0     0 18329.3519    0  258 -1218.3848 18329.3519  1604%     -  260s
     0     0 18328.2427    0  258 -1218.3848 18328.2427  1604%     -  261s
     0     0 18321.0619    0  258 -1218.3848 18321.0619  1604%     -  262s
     0     0 18320.4201    0  258 -1218.3848 18320.4201  1604%     -  263s
     0     0 15181.9374    0  327 -1218.3848 15181.9374  1346%     -  342s
     0     0 14624.6894    0  344 -1218.3848 14624.6894  1300%     -  367s
     0     0 14444.5792    0  385 -1218.3848 14444.5792  1286%     -  380s
     0     0 14360.6881    0  353 -1218.3848 14360.6881  1279%     -  389s
     0     0 14271.9036    0  357 -1218.3848 14271.9036  1271%     -  398s
     0     0 14249.8521    0  401 -1218.3848 14249.8521  1270%     -  403s
     0     0 14238.7438    0  357 -1218.3848 14238.7438  1269%     -  406s
     0     0 14170.4285    0  363 -1218.3848 14170.4285  1263%     -  411s
     0     0 14165.4107    0  360 -1218.3848 14165.4107  1263%     -  413s
     0     0 14164.7381    0  358 -1218.3848 14164.7381  1263%     -  414s
     0     0 12774.5141    0  425 -1218.3848 12774.5141  1148%     -  455s
     0     0 12410.4117    0  415 -1218.3848 12410.4117  1119%     -  475s
     0     0 12144.7403    0  355 -1218.3848 12144.7403  1097%     -  489s
     0     0 11953.9163    0  437 -1218.3848 11953.9163  1081%     -  501s
     0     0 11896.3951    0  437 -1218.3848 11896.3951  1076%     -  514s
     0     0 11882.9921    0  441 -1218.3848 11882.9921  1075%     -  520s
     0     0 11860.8537    0  440 -1218.3848 11860.8537  1073%     -  525s
     0     0 11852.0432    0  447 -1218.3848 11852.0432  1073%     -  530s
     0     0 11840.4460    0  449 -1218.3848 11840.4460  1072%     -  533s
     0     0 11832.3556    0  450 -1218.3848 11832.3556  1071%     -  537s
     0     0 11824.1166    0  442 -1218.3848 11824.1166  1070%     -  539s
     0     0 11821.2475    0  446 -1218.3848 11821.2475  1070%     -  540s
     0     0 11819.2181    0  443 -1218.3848 11819.2181  1070%     -  541s
     0     0 11818.2650    0  445 -1218.3848 11818.2650  1070%     -  543s
     0     0 11535.0024    0  376 -1218.3848 11535.0024  1047%     -  562s
     0     0 11412.0406    0  482 -1218.3848 11412.0406  1037%     -  578s
     0     0 11381.6165    0  438 -1218.3848 11381.6165  1034%     -  585s
     0     0 11358.8593    0  452 -1218.3848 11358.8593  1032%     -  589s
     0     0 11348.6537    0  464 -1218.3848 11348.6537  1031%     -  592s
     0     0 11331.8367    0  465 -1218.3848 11331.8367  1030%     -  595s
     0     0 11318.4297    0  451 -1218.3848 11318.4297  1029%     -  598s
     0     0 11314.2948    0  458 -1218.3848 11314.2948  1029%     -  599s
     0     0 11313.8541    0  461 -1218.3848 11313.8541  1029%     -  600s
     0     0 10962.1796    0  514 -1218.3848 10962.1796  1000%     -  618s
     0     0 10922.2420    0  526 -1218.3848 10922.2420   996%     -  635s
     0     0 10911.3657    0  490 -1218.3848 10911.3657   996%     -  641s
     0     0 10903.0877    0  523 -1218.3848 10903.0877   995%     -  645s
     0     0 10894.5490    0  528 -1218.3848 10894.5490   994%     -  649s
     0     0 10882.6957    0  458 -1218.3848 10882.6957   993%     -  654s
     0     0 10880.9373    0  520 -1218.3848 10880.9373   993%     -  656s
     0     0 10685.5460    0  498 -1218.3848 10685.5460   977%     -  670s
     0     0 10618.2530    0  465 -1218.3848 10618.2530   972%     -  680s
     0     0 10573.9556    0  504 -1218.3848 10573.9556   968%     -  689s
     0     0 10555.8291    0  469 -1218.3848 10555.8291   966%     -  694s
     0     0 10540.0973    0  511 -1218.3848 10540.0973   965%     -  699s
     0     0 10536.1392    0  506 -1218.3848 10536.1392   965%     -  702s
     0     0 10534.0276    0  505 -1218.3848 10534.0276   965%     -  704s
     0     0 10491.2794    0  334 -1218.3848 10491.2794   961%     -  714s
H    0     0                    -1203.274147 10491.2170   972%     -  725s
H    0     0                    -1137.622775 10491.2170  1022%     -  729s
H    0     0                    -1091.432085 10491.2170  1061%     -  729s
     0     0 10484.8771    0  403 -1091.4321 10484.8771  1061%     -  734s
     0     0 10478.4032    0  474 -1091.4321 10478.4032  1060%     -  741s
     0     0 10471.8227    0  416 -1091.4321 10471.8227  1059%     -  745s
     0     0 10467.9573    0  409 -1091.4321 10467.9573  1059%     -  747s
     0     0 10465.5295    0  477 -1091.4321 10465.5295  1059%     -  749s
     0     0 10463.6889    0  413 -1091.4321 10463.6889  1059%     -  750s
     0     0 10433.6883    0  476 -1091.4321 10433.6883  1056%     -  760s
     0     0 10424.0056    0  490 -1091.4321 10424.0056  1055%     -  763s
     0     0 10419.3545    0  490 -1091.4321 10419.3545  1055%     -  766s
     0     0 10415.4389    0  486 -1091.4321 10415.4389  1054%     -  768s
     0     0 10413.4338    0  483 -1091.4321 10413.4338  1054%     -  770s
     0     0 10386.7318    0  492 -1091.4321 10386.7318  1052%     -  777s
     0     0 10378.2052    0  494 -1091.4321 10378.2052  1051%     -  786s
     0     0 10376.2534    0  405 -1091.4321 10376.2534  1051%     -  789s
     0     0 10364.7736    0  489 -1091.4321 10364.7736  1050%     -  795s
     0     0 10362.4650    0  491 -1091.4321 10362.4650  1049%     -  799s
     0     0 10355.5072    0  487 -1091.4321 10355.5072  1049%     -  804s
     0     0 10352.0476    0  490 -1091.4321 10352.0476  1048%     -  811s
     0     0 10350.0270    0  498 -1091.4321 10350.0270  1048%     -  814s
     0     0 10335.2628    0  583 -1091.4321 10335.2628  1047%     -  820s
     0     0 10334.8392    0  583 -1091.4321 10334.8392  1047%     -  825s
     0     2 10334.8392    0  583 -1091.4321 10334.8392  1047%     -  906s
     1     4 10303.6345    1  464 -1091.4321 10334.1674  1047%  3985  914s
     3     6 8561.62899    2  288 -1091.4321 10302.7583  1044% 10725  933s
     5    12 9387.90140    3  509 -1091.4321 10302.7583  1044% 12280  944s
    11    24 9317.24661    4  470 -1091.4321 10115.5553  1027% 10273  961s
    23    36 9228.25666    4  517 -1091.4321 9876.07614  1005% 17132 1020s
    35    67 8825.44487    5  545 -1091.4321 9876.07614  1005% 15927 1226s
    66   181 8182.34752    5  307 -1091.4321 9463.16576   967% 24804 1277s
   180   243 8182.30905    6  303 -1091.4321 9455.22186   966% 13578 1305s
   242   296 7970.18441    7  290 -1091.4321 9455.22186   966% 11797 1331s
   295   333 7679.27871    8  282 -1091.4321 9455.22186   966% 11139 1355s
   332   389 7476.08066    9  285 -1091.4321 9455.22186   966% 11038 1379s
   388   420 2904.79694   14  251 -1091.4321 9455.22186   966% 10711 1403s
   419   461 7170.07105    9  281 -1091.4321 9455.22186   966% 11022 1423s
H  421   461                    -1082.616560 9455.22186   973% 10978 1423s
   460   546 2756.44041   16  231 -1082.6166 9455.22186   973% 10873 1443s
   547   614 1618.41993   21  188 -1082.6166 9455.22186   973% 10212 1468s
   632   686 1137.33533   26  173 -1082.6166 9455.22186   973%  9735 1496s
   718   734 1186.39995   13  217 -1082.6166 9455.22186   973%  9275 1524s
   811   772 1099.98750   14  211 -1082.6166 9455.22186   973%  8887 1545s
   901   813  283.60258   17  194 -1082.6166 9455.22186   973%  8587 1571s
   973   833     cutoff   22      -1082.6166 9455.22186   973%  8477 1595s
  1049   854 8479.79332    9  435 -1082.6166 9455.22186   973%  8353 1617s
  1088   904 8369.39328   10  435 -1082.6166 9455.22186   973%  8453 1639s
  1150   980 8162.85491   11  424 -1082.6166 9455.22186   973%  8434 1668s
  1240  1033 8044.88158   12  428 -1082.6166 9455.22186   973%  8281 1698s
  1328  1115 7766.38861   13  298 -1082.6166 9455.22186   973%  8137 1722s
  1437  1180 7695.06706   14  405 -1082.6166 9455.22186   973%  7945 1750s
  1554  1256 5863.47832   15  203 -1082.6166 9455.22186   973%  7743 1779s
  1651  1320 3245.70695   16  146 -1082.6166 9455.22186   973%  7692 1807s
  1764  1394 2786.37006   17  138 -1082.6166 9204.27785   950%  7637 1839s
  1884  1471 2512.26409   18  150 -1082.6166 9204.27785   950%  7503 1871s
  2010  1492 infeasible   19      -1082.6166 9062.70206   937%  7418 1902s
  2051  1512  500.10533   20  149 -1082.6166 9062.70206   937%  7480 1936s
  2093  1537  355.78594   21  135 -1082.6166 8963.31963   928%  7567 1974s
  2142  1612  299.54431   22  127 -1082.6166 8963.31963   928%  7659 2005s
  2223  1665 infeasible   28      -1082.6166 8963.31963   928%  7668 2033s
  2338  1735 infeasible   29      -1082.6166 8963.31963   928%  7608 2072s
  2453  1828 7720.81438   11  430 -1082.6166 8944.69755   926%  7605 2111s
  2578  1956 4069.56754   15  176 -1082.6166 8944.69755   926%  7641 2153s
  2744  2025 1286.08368   16  153 -1082.6166 8940.52122   926%  7567 2189s
  2863  2096 infeasible   30      -1082.6166 8890.16906   921%  7437 2232s
  3005  2143 5656.28536    8  457 -1082.6166 8854.03214   918%  7380 2284s
  3098  2275 5345.59109    9  447 -1082.6166 8854.03214   918%  7434 2329s
  3254  2435 4579.49524   11  424 -1082.6166 8854.03214   918%  7426 2378s
  3476  2544 4138.32316   14  395 -1082.6166 8854.03214   918%  7312 2432s
  3676  2672     cutoff   16      -1082.6166 8854.03214   918%  7258 2484s
  3898  2673 4107.24837   61  583 -1082.6166 8840.41390   917%  7217 2790s
  3900  2674 1281.47264   38  128 -1082.6166 8840.41390   917%  7213 2806s
  3901  2675 7911.83323   17  311 -1082.6166 8840.41390   917%  7212 2892s
  3902  2676 7160.22091   15  336 -1082.6166 8840.41390   917%  7210 2960s
  3903  2676 3243.69093   17  425 -1082.6166 8840.41390   917%  7208 3017s
  3904  2677 4790.96722   43  491 -1082.6166 8840.41390   917%  7206 3075s
  3905  2678 1293.47258   24  472 -1082.6166 8840.41390   917%  7204 3108s
  3906  2678  432.67126   23  389 -1082.6166 8840.41390   917%  7202 3127s
  3907  2679 7840.61486   15  507 -1082.6166 8840.41390   917%  7200 3140s
  3908  2680 6849.96017   10  495 -1082.6166 8840.41390   917%  7199 3149s
  3909  2680  755.32253   67  512 -1082.6166 8840.41390   917%  7197 3162s
  3910  2681 2565.08570   55  545 -1082.6166 8840.41390   917%  7195 3181s
  3911  2682 8453.12419   15  462 -1082.6166 8840.41390   917%  7193 3190s
  3912  2682 6537.20916   11  510 -1082.6166 8840.41390   917%  7191 3199s
  3913  2683 3832.74253   25  541 -1082.6166 8840.41390   917%  7189 3208s
  3914  2684  675.12168   25  465 -1082.6166 8840.41390   917%  7188 3232s
  3915  2684 1322.16598   45  476 -1082.6166 8840.41390   917%  7186 3245s
  3916  2685 3421.15574   32  527 -1082.6166 8840.41390   917%  7184 3261s
  3917  2686 6575.28366   25  511 -1082.6166 8840.41390   917%  7182 3271s
  3918  2686 -854.80580   62  400 -1082.6166 8840.41390   917%  7180 3277s
  3919  2687 3975.15859   29  524 -1082.6166 8840.41390   917%  7178 3285s
  3920  2688 8459.85553    9  525 -1082.6166 8840.41390   917%  7177 3307s
  3921  2688 1063.58776   36  483 -1082.6166 8840.41390   917%  7175 3318s
  3922  2689 7425.69651    9  526 -1082.6166 8840.41390   917%  7173 3331s
  3923  2690 1108.90593   25  376 -1082.6166 8840.41390   917%  7171 3348s
  3924  2690 2436.92347   17  521 -1082.6166 8840.41390   917%  7169 3358s
  3925  2691 8198.97235   11  507 -1082.6166 8840.41390   917%  7167 3373s
  3926  2692 4652.54170   24  524 -1082.6166 8840.41390   917%  7166 3381s
  3927  2692 2169.65652   44  572 -1082.6166 8840.41390   917%  7164 3405s
  3928  2693 1534.77787   47  583 -1082.6166 8840.41390   917%  7162 3415s
  3929  2694 7693.07200   14  528 -1082.6166 8840.41390   917%  7160 3426s
  3930  2694 2252.79087   38  530 -1082.6166 8840.41390   917%  7158 3435s
  3931  2695  551.32886   31  519 -1082.6166 8840.41390   917%  7156 3448s
  3932  2696 3932.67630   29  516 -1082.6166 8840.41390   917%  7155 3453s
  3933  2696 2961.84118   16  479 -1082.6166 8840.41390   917%  7153 3461s
  3934  2697 1550.15733   82  475 -1082.6166 8840.41390   917%  7151 3465s
  3935  2698 1278.47559   46  526 -1082.6166 8840.41390   917%  7149 3472s
  3936  2698 2467.77667   31  526 -1082.6166 8840.41390   917%  7147 3494s
  3937  2699 1649.75101   27  526 -1082.6166 8840.41390   917%  7146 3586s

Cutting planes:
  Gomory: 8
  Implied bound: 10
  Projected implied bound: 164
  MIR: 943
  Mixing: 3
  Flow cover: 1198
  RLT: 11
  Relax-and-lift: 258

Explored 3938 nodes (29404962 simplex iterations) in 3600.08 seconds (8049.50 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -1082.62 -1091.43 -1137.62 ... -13481.6

Time limit reached
Best objective -1.082616560232e+03, best bound 8.840413895205e+03, gap 916.5785%
  WARNING: Time limit reached. Using best solution found (gap: 916.58%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.19s
  Master Objective (UB) = -1082.62, θ = 141878.14
  Upper Bound (UB) = -1082.62

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 141878.14
  [DEBUG]   ✓ Scenario 0: θ = 141878.14 ≤ Q = 141878.14 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 141878.14 ≤ Q = 141878.14 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 141878.14 ≤ Q = 141878.14 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 141878.14 ≤ Q = 141878.14 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 141878.14 ≤ Q = 141878.14 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 141878.14 ≤ Q = 141878.14 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 141878.14 ≤ Q = 141878.14 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 141878.14 ≤ Q = 141878.14 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 141878.14 ≤ Q = 141878.14 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 141878.14 ≤ Q = 141878.14 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 141878.14 ≤ Q = 141878.14 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 141878.14 ≤ Q = 141878.14 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 141878.14 ≤ Q = 141878.14 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 141878.14 ≤ Q = 141878.14 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 141878.14 ≤ Q = 141878.14 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 141878.14 ≤ Q = 141878.14 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 141878.14 ≤ Q = 143303.86 (slack: 1425.72)
  [DEBUG]   ✓ Scenario 17: θ = 141878.14 ≤ Q = 141878.14 (slack: 0.00)
  [DEBUG]   ✓ Scenario 18: θ = 141878.14 ≤ Q = 141878.14 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 141878.14 ≤ Q = 141878.14 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 20] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x618cace9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x618cace9
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.152079e+13
Presolve removed 2598 rows and 1890 columns
Presolve time: 0.00s
Presolved: 495 rows, 499 columns, 1396 nonzeros
Found heuristic solution: objective 5646410.5920
Variable types: 339 continuous, 160 integer (160 binary)

Root relaxation: objective -1.288932e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -128893.21    0  123 5646410.59 -128893.21   102%     -    0s
H    0     0                    -96731.40174 -128893.21  33.2%     -    0s
H    0     0                    -97348.98072 -128893.21  32.4%     -    0s
     0     0 -104012.29    0   27 -97348.981 -104012.29  6.84%     -    0s
H    0     0                    -102911.8550 -103932.56  0.99%     -    0s
H    0     0                    -103308.1360 -103932.56  0.60%     -    0s
     0     0 -103633.16    0   15 -103308.14 -103633.16  0.31%     -    0s
     0     0 -103623.75    0   13 -103308.14 -103623.75  0.31%     -    0s
     0     0 -103615.24    0   12 -103308.14 -103615.24  0.30%     -    0s
H    0     0                    -103324.1605 -103568.69  0.24%     -    0s
     0     0 -103503.40    0    7 -103324.16 -103503.40  0.17%     -    0s
H    0     0                    -103330.6174 -103503.40  0.17%     -    0s
     0     0 -103503.40    0   11 -103330.62 -103503.40  0.17%     -    0s
     0     0 -103503.40    0   11 -103330.62 -103503.40  0.17%     -    0s
     0     0 -103503.40    0   11 -103330.62 -103503.40  0.17%     -    0s
     0     0 -103503.40    0   11 -103330.62 -103503.40  0.17%     -    0s
H    0     0                    -103351.2724 -103480.57  0.13%     -    0s
     0     0 -103465.81    0   12 -103351.27 -103465.81  0.11%     -    0s
     0     0 -103428.51    0   12 -103351.27 -103428.51  0.07%     -    0s
     0     0 -103386.34    0   10 -103351.27 -103386.34  0.03%     -    0s
     0     0 -103372.22    0    5 -103351.27 -103372.22  0.02%     -    0s
     0     0 -103371.86    0    5 -103351.27 -103371.86  0.02%     -    0s
     0     0 -103363.41    0    3 -103351.27 -103363.41  0.01%     -    0s
     0     0          -    0      -103351.27 -103358.04  0.01%     -    0s

Explored 1 nodes (475 simplex iterations) in 0.08 seconds (0.03 work units)
Thread count was 32 (of 256 available processors)

Solution count 9: -103351 -103331 -103324 ... 1.15208e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.033512723966e+05, best bound -1.033580441931e+05, gap 0.0066%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 138109.15
  Scenario: 7 demand increases, 53 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -103351.27
  [DEBUG]   S×d_nominal = 241460.42
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 241460.42 + -103351.27 = 138109.15
  [DEBUG]   Current θ from Master = 141878.14
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3768.99 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -4851.61
  Lower Bound (LB) = -1589.09
  Gap (UB-LB) = 506.4726, Absolute Gap = 506.4726, Relative Gap = 0.467823
  Not converged yet (gap = 506.47 > ε = 200)

  [DEBUG] Adding NEW scenario 20 to Master Problem...
  [DEBUG] New scenario pattern: 7 increases, 53 decreases
    [DEBUG] Scenario 20 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 20 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 20]
    [DEBUG]   - Total constraints in model: 322473
    [DEBUG]   - Total variables in model: 133300
  [DEBUG] Total scenarios in Master: 21
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 21
================================================================================
[Iteration 21] Solving Master Problem...
  Current scenarios in Master: 21
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 322473 rows, 133300 columns and 913370 nonzeros
Model fingerprint: 0x4b3c7df5
Variable types: 131041 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 148470 rows and 60270 columns
Presolve time: 3.29s
Presolved: 174003 rows, 73030 columns, 1072595 nonzeros
Variable types: 70771 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -373180.1084
Found heuristic solution: objective -219438.1934

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.51s

Barrier statistics:
 Dense cols : 1186
 AA' NZ     : 4.249e+06
 Factor NZ  : 1.181e+07 (roughly 200 MB of memory)
 Factor Ops : 4.047e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.68400486e+07  2.72277904e+08  9.53e+04 1.59e+01  6.97e+04     7s
   1  -1.31212027e+07  2.38938606e+08  6.85e+04 4.73e+01  4.97e+04     7s
   2  -4.64308033e+06  1.95539603e+08  2.27e+04 6.55e+00  1.72e+04     7s
   3  -9.68553076e+05  1.37769563e+08  2.25e+03 1.29e+00  2.04e+03     7s
   4  -5.95673733e+05  1.06155148e+08  5.40e+02 8.00e-01  7.03e+02     7s
   5  -5.39071428e+05  5.46995491e+07  3.44e+02 3.50e-01  3.80e+02     7s
   6  -4.52153719e+05  4.42776108e+07  1.21e+02 2.65e-01  2.10e+02     7s
   7  -4.12259040e+05  3.19146669e+07  7.04e+01 1.79e-01  1.38e+02     7s
   8  -3.14275528e+05  2.32838833e+07  2.08e+01 1.24e-01  8.35e+01     7s
   9  -2.14454468e+05  1.36205342e+07  4.44e+00 6.84e-02  4.50e+01     7s
  10  -1.63552795e+05  7.34923426e+06  2.44e+00 3.54e-02  2.41e+01     7s
  11  -1.46806612e+05  6.62509123e+06  1.95e+00 3.17e-02  2.17e+01     7s
  12  -1.22150863e+05  4.79293377e+06  1.17e+00 2.27e-02  1.56e+01     7s
  13  -1.07506332e+05  3.88109569e+06  7.78e-01 1.83e-02  1.27e+01     7s
  14  -7.67879031e+04  8.35852232e+05  2.14e-01 3.68e-03  2.88e+00     7s
  15  -5.02920205e+04  4.35372118e+05  1.03e-01 1.85e-03  1.53e+00     8s
  16  -3.01980697e+04  3.10256187e+05  6.05e-02 1.39e-03  1.07e+00     8s
  17  -2.07636708e+04  2.42357754e+05  4.70e-02 1.20e-03  8.31e-01     8s
  18  -1.85061340e+04  2.11632950e+05  4.41e-02 1.18e-03  7.26e-01     8s
  19  -1.18373995e+04  1.36628246e+05  3.55e-02 2.32e-03  4.69e-01     8s
  20  -2.98026169e+03  1.12420441e+05  2.51e-02 2.20e-03  3.64e-01     8s
  21   1.93113080e+03  8.62348913e+04  1.97e-02 1.58e-03  2.66e-01     8s
  22   5.68299241e+03  7.10222002e+04  1.60e-02 1.21e-03  2.06e-01     8s
  23   7.93574242e+03  5.67638775e+04  1.40e-02 8.38e-04  1.54e-01     8s
  24   1.09680758e+04  5.18490137e+04  1.14e-02 7.07e-04  1.29e-01     8s
  25   1.29548047e+04  4.73997015e+04  9.67e-03 5.87e-04  1.09e-01     8s
  26   1.69230053e+04  4.21961131e+04  6.47e-03 4.40e-04  7.98e-02     8s
  27   1.74591914e+04  3.95630257e+04  6.09e-03 3.72e-04  6.98e-02     8s
  28   1.97199696e+04  3.73726407e+04  4.52e-03 3.05e-04  5.57e-02     8s
  29   2.02670442e+04  3.55819981e+04  4.17e-03 2.55e-04  4.83e-02     9s
  30   2.06465220e+04  3.48451560e+04  3.93e-03 2.34e-04  4.48e-02     9s
  31   2.12105605e+04  3.37540528e+04  3.55e-03 2.02e-04  3.96e-02     9s
  32   2.23308589e+04  3.24438400e+04  2.85e-03 1.60e-04  3.19e-02     9s
  33   2.25723388e+04  3.23751688e+04  2.71e-03 1.58e-04  3.09e-02     9s
  34   2.30515762e+04  3.18160768e+04  2.43e-03 1.41e-04  2.77e-02     9s
  35   2.33041146e+04  3.15954315e+04  2.28e-03 1.35e-04  2.62e-02     9s
  36   2.38012497e+04  3.12211909e+04  1.99e-03 1.24e-04  2.34e-02     9s
  37   2.41261423e+04  3.06105757e+04  1.81e-03 1.03e-04  2.05e-02     9s
  38   2.51609512e+04  2.99961062e+04  1.22e-03 8.27e-05  1.53e-02     9s
  39   2.53975545e+04  2.93118026e+04  1.09e-03 6.04e-05  1.24e-02     9s
  40   2.64262672e+04  2.87086601e+04  5.67e-04 3.90e-05  7.20e-03     9s
  41   2.68770292e+04  2.81688470e+04  3.20e-04 2.00e-05  4.08e-03    10s
  42   2.70489956e+04  2.78754921e+04  2.39e-04 1.00e-05  2.61e-03    10s
  43   2.72198723e+04  2.77550340e+04  1.62e-04 5.81e-06  1.69e-03    10s
  44   2.73192087e+04  2.77172302e+04  1.14e-04 4.46e-06  1.26e-03    10s
  45   2.73497876e+04  2.76554543e+04  1.00e-04 2.87e-06  9.65e-04    10s
  46   2.74697457e+04  2.76415677e+04  4.79e-05 2.38e-06  5.42e-04    10s
  47   2.75238629e+04  2.75970776e+04  2.38e-05 3.38e-06  2.31e-04    10s
  48   2.75561443e+04  2.75843024e+04  9.46e-06 1.17e-06  8.89e-05    10s
  49   2.75690266e+04  2.75827912e+04  4.25e-06 6.80e-07  4.35e-05    10s
  50   2.75768683e+04  2.75809058e+04  1.12e-06 1.65e-07  1.27e-05    10s
  51   2.75796361e+04  2.75802033e+04  1.23e-07 2.51e-08  1.79e-06    10s
  52   2.75797911e+04  2.75800818e+04  7.46e-08 8.68e-09  9.18e-07    10s
  53   2.75800291e+04  2.75800360e+04  6.96e-09 1.90e-08  2.19e-08    10s
  54   2.75800348e+04  2.75800357e+04  4.38e-08 1.83e-10  3.11e-09    11s
  55   2.75800356e+04  2.75800357e+04  5.28e-07 4.24e-07  3.38e-10    11s

Barrier solved model in 55 iterations and 10.62 seconds (17.88 work units)
Optimal objective 2.75800356e+04


Root crossover log...

  155881 DPushes remaining with DInf 0.0000000e+00                11s
    3971 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                16s

    8623 PPushes remaining with PInf 7.3109902e-05                16s
       0 PPushes remaining with PInf 0.0000000e+00                17s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.1109192e+03     17s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   77678    2.7580036e+04   0.000000e+00   1.110919e+03     17s
   77953    2.7580036e+04   0.000000e+00   0.000000e+00     17s
   77953    2.7580036e+04   0.000000e+00   0.000000e+00     17s
Concurrent spin time: 1.48s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 2.758004e+04, 77953 iterations, 14.27 seconds (26.40 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 27580.0357    0  143 -219438.19 27580.0357   113%     -   19s
H    0     0                    -186244.1434 27580.0357   115%     -   21s
H    0     0                    -186204.1501 27580.0357   115%     -   21s
H    0     0                    -186184.8346 27580.0357   115%     -   21s
H    0     0                    -11398.35352 27580.0357   342%     -   21s
H    0     0                    -10926.08129 27580.0357   352%     -   22s
     0     0 21514.9756    0  292 -10926.081 21514.9756   297%     -   67s
H    0     0                    -10293.37306 21514.4800   309%     -   68s
H    0     0                    -2426.223026 21514.4800   987%     -   68s
H    0     0                    -2319.932541 21514.4800  1027%     -   69s
H    0     0                    -1945.058361 21514.4800  1206%     -   69s
     0     0 21023.1843    0  257 -1945.0584 21023.1843  1181%     -   92s
     0     0 20923.7518    0  258 -1945.0584 20923.7518  1176%     -  101s
     0     0 20910.7942    0  256 -1945.0584 20910.7942  1175%     -  105s
     0     0 20881.4375    0  208 -1945.0584 20881.4375  1174%     -  114s
     0     0 20878.3985    0  212 -1945.0584 20878.3985  1173%     -  118s
     0     0 20877.9269    0  215 -1945.0584 20877.9269  1173%     -  120s
     0     0 17352.2148    0  228 -1945.0584 17352.2148   992%     -  153s
     0     0 16591.1609    0  253 -1945.0584 16591.1609   953%     -  174s
     0     0 16499.0462    0  253 -1945.0584 16499.0462   948%     -  185s
     0     0 16435.9948    0  260 -1945.0584 16435.9948   945%     -  197s
     0     0 16383.1020    0  264 -1945.0584 16383.1020   942%     -  200s
     0     0 16376.2625    0  268 -1945.0584 16376.2625   942%     -  203s
     0     0 16374.8169    0  262 -1945.0584 16374.8169   942%     -  205s
     0     0 16301.3492    0  273 -1945.0584 16301.3492   938%     -  213s
     0     0 16296.6212    0  278 -1945.0584 16296.6212   938%     -  216s
     0     0 16295.7630    0  279 -1945.0584 16295.7630   938%     -  217s
     0     0 13306.2632    0  355 -1945.0584 13306.2632   784%     -  274s
H    0     0                    -1708.228907 13305.8696   879%     -  275s
H    0     0                    -1684.417110 13305.8696   890%     -  275s
     0     0 12853.7868    0  406 -1684.4171 12853.7868   863%     -  301s
     0     0 12494.1517    0  418 -1684.4171 12494.1517   842%     -  321s
     0     0 12462.8379    0  417 -1684.4171 12462.8379   840%     -  326s
     0     0 12426.7154    0  432 -1684.4171 12426.7154   838%     -  336s
     0     0 12228.4033    0  429 -1684.4171 12228.4033   826%     -  353s
     0     0 12183.3944    0  442 -1684.4171 12183.3944   823%     -  361s
     0     0 12148.4230    0  439 -1684.4171 12148.4230   821%     -  367s
     0     0 12138.7567    0  443 -1684.4171 12138.7567   821%     -  371s
     0     0 12136.5163    0  443 -1684.4171 12136.5163   821%     -  373s
     0     0 12118.4789    0  445 -1684.4171 12118.4789   819%     -  375s
     0     0 12117.7166    0  445 -1684.4171 12117.7166   819%     -  376s
     0     0 11270.2266    0  393 -1684.4171 11270.2266   769%     -  420s
     0     0 11037.6578    0  488 -1684.4171 11037.6578   755%     -  445s
     0     0 10967.2844    0  468 -1684.4171 10967.2844   751%     -  458s
     0     0 10908.4240    0  468 -1684.4171 10908.4240   748%     -  468s
     0     0 10879.8161    0  519 -1684.4171 10879.8161   746%     -  474s
     0     0 10862.7959    0  474 -1684.4171 10862.7959   745%     -  479s
     0     0 10855.5647    0  537 -1684.4171 10855.5647   744%     -  485s
     0     0 10846.0901    0  523 -1684.4171 10846.0901   744%     -  489s
     0     0 10843.0928    0  476 -1684.4171 10843.0928   744%     -  492s
     0     0 10841.8051    0  480 -1684.4171 10841.8051   744%     -  493s
     0     0 10712.4607    0  460 -1684.4171 10712.4607   736%     -  513s
     0     0 10678.5258    0  457 -1684.4171 10678.5258   734%     -  522s
     0     0 10654.9728    0  498 -1684.4171 10654.9728   733%     -  530s
     0     0 10641.1449    0  473 -1684.4171 10641.1449   732%     -  533s
     0     0 10614.8041    0  548 -1684.4171 10614.8041   730%     -  539s
     0     0 10592.7592    0  562 -1684.4171 10592.7592   729%     -  548s
     0     0 10588.5970    0  563 -1684.4171 10588.5970   729%     -  551s
     0     0 10586.1396    0  558 -1684.4171 10586.1396   728%     -  553s
     0     0 10565.7568    0  569 -1684.4171 10565.7568   727%     -  561s
     0     0 10561.9964    0  572 -1684.4171 10561.9964   727%     -  564s
     0     0 10559.3479    0  565 -1684.4171 10559.3479   727%     -  566s
     0     0 10542.8601    0  575 -1684.4171 10542.8601   726%     -  570s
     0     0 10532.4126    0  571 -1684.4171 10532.4126   725%     -  576s
     0     0 10531.0535    0  574 -1684.4171 10531.0535   725%     -  577s
     0     0 10371.8836    0  531 -1684.4171 10371.8836   716%     -  594s
H    0     0                    -1606.826957 10371.6907   745%     -  605s
     0     0 10339.1864    0  529 -1606.8270 10339.1864   743%     -  613s
     0     0 10335.1826    0  541 -1606.8270 10335.1826   743%     -  615s
     0     0 10331.3151    0  502 -1606.8270 10331.3151   743%     -  618s
     0     0 10331.0244    0  498 -1606.8270 10331.0244   743%     -  620s
     0     0 10252.0659    0  426 -1606.8270 10252.0659   738%     -  636s
H    0     0                    -1277.215520 10252.0518   903%     -  637s
     0     0 10228.0654    0  442 -1277.2155 10228.0654   901%     -  646s
     0     0 10212.9220    0  528 -1277.2155 10212.9220   900%     -  654s
     0     0 10206.9412    0  559 -1277.2155 10206.9412   899%     -  656s
     0     0 10206.0522    0  556 -1277.2155 10206.0522   899%     -  658s
     0     0 10183.2550    0  495 -1277.2155 10183.2550   897%     -  665s
H    0     0                    -1186.583729 10183.2194   958%     -  679s
H    0     0                    -1091.432085 10183.2194  1033%     -  679s
     0     0 10176.0937    0  491 -1091.4321 10176.0937  1032%     -  685s
     0     0 10171.8191    0  496 -1091.4321 10171.8191  1032%     -  687s
     0     0 10165.4570    0  547 -1091.4321 10165.4570  1031%     -  690s
     0     0 10162.8987    0  496 -1091.4321 10162.8987  1031%     -  693s
     0     0 10161.9351    0  495 -1091.4321 10161.9351  1031%     -  694s
     0     0 10132.4074    0  499 -1091.4321 10132.4074  1028%     -  702s
     0     0 10127.5543    0  501 -1091.4321 10127.5543  1028%     -  707s
     0     0 10125.0322    0  498 -1091.4321 10125.0322  1028%     -  710s
     0     0 10121.9764    0  542 -1091.4321 10121.9764  1027%     -  712s
     0     0 10121.6366    0  542 -1091.4321 10121.6366  1027%     -  713s
     0     0 10111.5689    0  494 -1091.4321 10111.5689  1026%     -  719s
     0     0 10111.0585    0  498 -1091.4321 10111.0585  1026%     -  740s
     0     0 10110.1370    0  483 -1091.4321 10110.1370  1026%     -  744s
     0     0 10107.5095    0  489 -1091.4321 10107.5095  1026%     -  746s
     0     0 10107.5095    0  489 -1091.4321 10107.5095  1026%     -  748s
     0     0 10107.5095    0  489 -1091.4321 10107.5095  1026%     -  753s
     0     2 10107.5095    0  489 -1091.4321 10107.5095  1026%     -  894s
     1     3 9629.06978    1  521 -1091.4321 10107.0780  1026% 17234  912s
     2     4 10010.6425    1  483 -1091.4321 10010.6425  1017% 12926  921s
     3     5 9140.40226    2  482 -1091.4321 10010.6321  1017% 12636  934s
     4     8 9430.51010    2  467 -1091.4321 10010.5949  1017% 12512  957s
     7    13 9164.87661    3  405 -1091.4321 9429.47926   964% 11846  989s
    12    26 8959.38111    4  435 -1091.4321 9429.47926   964% 13015 1009s
    25    39 8896.48623    5  339 -1091.4321 8981.63134   923% 17633 1075s
    38    69 7521.59626    6  375 -1091.4321 8981.63134   923% 20443 1262s
    68   117 7460.73280    7  360 -1091.4321 8928.83993   918% 23156 1312s
   116   179 7459.58478    8  359 -1091.4321 8829.15028   909% 17916 1370s
   178   248 7351.42635    9  352 -1091.4321 8829.15028   909% 14765 1416s
   247   318 6769.93886   11  358 -1091.4321 8829.15028   909% 13165 1461s
   317   384 6569.95783   14  323 -1091.4321 8829.15028   909% 12200 1498s
   385   410 3145.89032   16  227 -1091.4321 8829.15028   909% 11358 1524s
   411   457 6271.31917   17  295 -1091.4321 8829.15028   909% 11137 1554s
   458   509 5035.27273   18  257 -1091.4321 8829.15028   909% 11277 1584s
   518   554 5871.14676   18  404 -1091.4321 8829.15028   909% 11200 1615s
   595   601 4287.64912   19  297 -1091.4321 8746.39351   901% 10888 1640s
   672   648 4978.55986   19  311 -1091.4321 8746.39351   901% 10554 1670s
   751   682 4867.25982   21  316 -1091.4321 8746.39351   901% 10333 1713s
   805   718 4486.21889   23  346 -1091.4321 8746.39351   901% 10233 1745s
   873   795 4428.39028   24  338 -1091.4321 8746.39351   901% 10152 1776s
   972   867 4220.46474   26  399 -1091.4321 8746.39351   901%  9939 1805s
  1072   946 3478.52488   27  311 -1091.4321 8746.39351   901%  9677 1833s
  1191  1032 3598.15541   28  368 -1091.4321 8746.39351   901%  9324 1858s
  1305  1137 3311.24214   32  417 -1091.4321 8658.93687   893%  9024 1885s
  1430  1241 3222.98831   34  422 -1091.4321 8658.93687   893%  8773 1913s
  1578  1281 2676.05374   39  391 -1091.4321 8465.12025   876%  8474 1940s
  1662  1346 infeasible   39      -1091.4321 8463.12435   875%  8381 1966s
  1749  1360 1594.40606   40  376 -1091.4321 8463.12435   875%  8292 2000s
  1860  1381 infeasible   42      -1091.4321 8463.12435   875%  8179 2038s
  1958  1407 -436.41336   42  316 -1091.4321 8381.75764   868%  8109 2075s
  2034  1449 -604.62409   47  176 -1091.4321 8381.75764   868%  8193 2112s
  2111  1505 -453.38508   12  235 -1091.4321 8381.75764   868%  8266 2150s
  2207  1558     cutoff   14      -1091.4321 8381.75764   868%  8359 2187s
  2336  1652  389.73324   49  344 -1091.4321 8337.44503   864%  8344 2232s
  2470  1722 -287.50124   60  392 -1091.4321 8337.44503   864%  8301 2274s
  2627  1785     cutoff   73      -1091.4321 8337.44503   864%  8251 2322s
  2750  1842 4694.41474   10  286 -1091.4321 8337.44503   864%  8346 2378s
  2874  1895 4249.62103   11  429 -1091.4321 8210.77880   852%  8375 2438s
  2989  1922 4201.64242   12  427 -1091.4321 8210.46201   852%  8465 2533s
  3056  1981 -408.56194   14  298 -1091.4321 8210.46201   852%  8580 2594s
  3158  2046 -776.22751   16  268 -1091.4321 8210.46201   852%  8647 2666s
  3279  2117 infeasible   18      -1091.4321 8034.28393   836%  8776 2743s
  3406  2206 4340.73452   12  385 -1091.4321 8034.28393   836%  8907 2819s
  3582  2305 4255.18915   13  378 -1091.4321 8034.28393   836%  8925 2893s
  3772  2372     cutoff   15      -1091.4321 8034.28393   836%  8888 2954s
  3900  2452 2409.87174   14  345 -1091.4321 7986.86418   832%  8866 3024s
  4062  2569 2141.40295   16  315 -1091.4321 7986.86418   832%  8864 3104s

Cutting planes:
  Learned: 1
  Gomory: 12
  Implied bound: 360
  MIR: 4143
  Flow cover: 3974
  RLT: 71
  Relax-and-lift: 845

Explored 4257 nodes (38384186 simplex iterations) in 3600.03 seconds (8109.01 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -1091.43 -1186.58 -1277.22 ... -10293.4

Time limit reached
Best objective -1.091432085460e+03, best bound 7.986864180771e+03, gap 831.7784%
  WARNING: Time limit reached. Using best solution found (gap: 831.78%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = -1091.43, θ = 141588.17
  Upper Bound (UB) = -1091.43

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 141588.17
  [DEBUG]   ✓ Scenario 0: θ = 141588.17 ≤ Q = 141588.17 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 141588.17 ≤ Q = 141588.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 141588.17 ≤ Q = 141588.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 141588.17 ≤ Q = 141588.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 141588.17 ≤ Q = 141588.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 141588.17 ≤ Q = 141588.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 141588.17 ≤ Q = 141588.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 141588.17 ≤ Q = 141588.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 141588.17 ≤ Q = 141588.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 141588.17 ≤ Q = 141588.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 141588.17 ≤ Q = 141588.17 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 141588.17 ≤ Q = 141588.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 141588.17 ≤ Q = 141588.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 141588.17 ≤ Q = 141588.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 141588.17 ≤ Q = 141588.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 141588.17 ≤ Q = 141588.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 141588.17 ≤ Q = 141588.17 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 141588.17 ≤ Q = 141588.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 141588.17 ≤ Q = 141588.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 141588.17 ≤ Q = 141588.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 20: θ = 141588.17 ≤ Q = 141588.17 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 21] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x69f460bc
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x960b9f44
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.153573e+13
Presolve removed 2598 rows and 1890 columns
Presolve time: 0.00s
Presolved: 495 rows, 499 columns, 1396 nonzeros
Found heuristic solution: objective 5688401.0656
Variable types: 339 continuous, 160 integer (160 binary)

Root relaxation: objective -1.292217e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -129221.68    0  123 5688401.07 -129221.68   102%     -    0s
H    0     0                    -97003.30594 -129221.68  33.2%     -    0s
H    0     0                    -97620.88492 -129221.68  32.4%     -    0s
     0     0 -103690.87    0   61 -97620.885 -103690.87  6.22%     -    0s
H    0     0                    -100648.3014 -103571.27  2.90%     -    0s
H    0     0                    -100672.4124 -103571.27  2.88%     -    0s
H    0     0                    -101495.2226 -103571.27  2.05%     -    0s
H    0     0                    -101519.3336 -103571.27  2.02%     -    0s
     0     0 -102992.15    0   61 -101519.33 -102992.15  1.45%     -    0s
H    0     0                    -102088.4234 -102986.02  0.88%     -    0s
     0     0 -102730.56    0   51 -102088.42 -102730.56  0.63%     -    0s
     0     0 -102667.61    0   60 -102088.42 -102667.61  0.57%     -    0s
     0     0 -102666.56    0   60 -102088.42 -102666.56  0.57%     -    0s
     0     0 -102440.27    0   48 -102088.42 -102440.27  0.34%     -    0s
     0     0 -102409.52    0   48 -102088.42 -102409.52  0.31%     -    0s
     0     0 -102378.42    0   48 -102088.42 -102378.42  0.28%     -    0s
     0     0 -102315.75    0   47 -102088.42 -102315.75  0.22%     -    0s
     0     0 -102315.75    0   55 -102088.42 -102315.75  0.22%     -    0s
     0     0 -102315.75    0   46 -102088.42 -102315.75  0.22%     -    0s
     0     0 -102315.75    0   44 -102088.42 -102315.75  0.22%     -    0s
     0     0 -102264.80    0   44 -102088.42 -102264.80  0.17%     -    0s
     0     0 -102251.30    0   42 -102088.42 -102251.30  0.16%     -    0s
     0     0 -102248.74    0   30 -102088.42 -102248.74  0.16%     -    0s
     0     0 -102214.52    0   14 -102088.42 -102214.52  0.12%     -    0s
     0     0 -102170.93    0    8 -102088.42 -102170.93  0.08%     -    0s
H    0     0                    -102098.2740 -102170.54  0.07%     -    0s
     0     0 -102170.54    0    8 -102098.27 -102170.54  0.07%     -    0s
     0     0 -102165.31    0    7 -102098.27 -102165.31  0.07%     -    0s
     0     0 -102130.70    0    5 -102098.27 -102130.70  0.03%     -    0s
     0     0 -102129.63    0    7 -102098.27 -102129.63  0.03%     -    0s
*    0     0               0    -102110.7924 -102110.79  0.00%     -    0s

Cutting planes:
  Gomory: 3
  Implied bound: 1
  MIR: 3
  Flow cover: 1
  Relax-and-lift: 1

Explored 1 nodes (985 simplex iterations) in 0.19 seconds (0.05 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -102111 -102098 -102088 ... -97003.3
No other solutions better than -102111

Optimal solution found (tolerance 1.00e-04)
Best objective -1.021107924014e+05, best bound -1.021107924014e+05, gap 0.0000%
  Subproblem solved in 0.20s
  Worst-case operational profit (Z_SP) = 139349.63
  Scenario: 23 demand increases, 37 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -102110.79
  [DEBUG]   S×d_nominal = 241460.42
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 241460.42 + -102110.79 = 139349.63
  [DEBUG]   Current θ from Master = 141588.17
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2238.55 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -3329.98
  Lower Bound (LB) = -1589.09
  Gap (UB-LB) = 497.6571, Absolute Gap = 497.6571, Relative Gap = 0.455967
  Not converged yet (gap = 497.66 > ε = 200)

  [DEBUG] Adding NEW scenario 21 to Master Problem...
  [DEBUG] New scenario pattern: 23 increases, 37 decreases
    [DEBUG] Scenario 21 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 21 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 21]
    [DEBUG]   - Total constraints in model: 337763
    [DEBUG]   - Total variables in model: 139540
  [DEBUG] Total scenarios in Master: 22
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 22
================================================================================
[Iteration 22] Solving Master Problem...
  Current scenarios in Master: 22
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 337763 rows, 139540 columns and 956601 nonzeros
Model fingerprint: 0x91a21d66
Variable types: 137281 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 155540 rows and 63140 columns
Presolve time: 3.06s
Presolved: 182223 rows, 76400 columns, 1123267 nonzeros
Variable types: 74141 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -373180.1084
Found heuristic solution: objective -219438.1934

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.55s

Barrier statistics:
 Dense cols : 1186
 AA' NZ     : 4.583e+06
 Factor NZ  : 1.278e+07 (roughly 200 MB of memory)
 Factor Ops : 4.491e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.70778669e+07  2.83088207e+08  9.66e+04 1.54e+01  7.03e+04     6s
   1  -1.33109776e+07  2.48685662e+08  6.94e+04 4.64e+01  5.01e+04     6s
   2  -4.79884164e+06  2.03590077e+08  2.35e+04 7.31e+00  1.77e+04     6s
   3  -9.74651661e+05  1.45040399e+08  2.23e+03 1.63e+00  2.02e+03     6s
   4  -6.05001929e+05  1.10559613e+08  5.46e+02 9.54e-01  7.02e+02     6s
   5  -5.48028744e+05  5.67563697e+07  3.38e+02 3.94e-01  3.73e+02     7s
   6  -4.67127434e+05  4.67491618e+07  1.36e+02 3.14e-01  2.20e+02     7s
   7  -4.25380137e+05  3.33308492e+07  7.73e+01 2.10e-01  1.41e+02     7s
   8  -3.30211475e+05  2.46455033e+07  2.34e+01 1.47e-01  8.56e+01     7s
   9  -2.11838920e+05  1.34223182e+07  3.43e+00 7.52e-02  4.21e+01     7s
  10  -1.76631264e+05  8.79769475e+06  2.17e+00 4.82e-02  2.75e+01     7s
  11  -1.40487835e+05  7.27814539e+06  1.38e+00 3.95e-02  2.26e+01     7s
  12  -1.28687784e+05  5.71349688e+06  1.02e+00 3.10e-02  1.77e+01     7s
  13  -1.16429429e+05  4.35831277e+06  7.25e-01 2.30e-02  1.36e+01     7s
  14  -9.55086292e+04  2.13639981e+06  3.49e-01 1.13e-02  6.75e+00     7s
  15  -6.92941257e+04  1.08721879e+06  1.40e-01 5.67e-03  3.49e+00     7s
  16  -4.43325741e+04  5.55537639e+05  6.12e-02 2.91e-03  1.81e+00     7s
  17  -2.75422823e+04  3.13333188e+05  3.73e-02 1.61e-03  1.03e+00     7s
  18  -1.90945451e+04  1.80824970e+05  2.90e-02 1.27e-03  6.03e-01     7s
  19  -1.08065993e+04  1.50058889e+05  2.30e-02 1.08e-03  4.85e-01     7s
  20  -8.83883883e+03  1.34218613e+05  2.12e-02 9.58e-04  4.31e-01     7s
  21  -4.87731448e+03  1.08532122e+05  1.83e-02 7.35e-04  3.42e-01     7s
  22   1.68439730e+03  9.22594695e+04  1.32e-02 5.91e-04  2.73e-01     7s
  23   4.74952653e+03  7.50546030e+04  1.11e-02 4.64e-04  2.12e-01     8s
  24   8.59398104e+03  6.51890350e+04  8.74e-03 3.73e-04  1.71e-01     8s
  25   9.08048730e+03  6.09940032e+04  8.45e-03 3.34e-04  1.56e-01     8s
  26   1.03983130e+04  5.69961291e+04  7.63e-03 2.97e-04  1.40e-01     8s
  27   1.30525465e+04  4.95984492e+04  6.14e-03 2.98e-04  1.10e-01     8s
  28   1.47694846e+04  4.76839557e+04  5.24e-03 2.72e-04  9.92e-02     8s
  29   1.58172581e+04  4.32679622e+04  4.69e-03 2.18e-04  8.27e-02     8s
  30   1.89253193e+04  4.02426905e+04  3.20e-03 1.77e-04  6.43e-02     8s
  31   1.99178994e+04  3.70893795e+04  2.76e-03 1.41e-04  5.18e-02     8s
  32   2.06219881e+04  3.59734709e+04  2.48e-03 1.27e-04  4.63e-02     8s
  33   2.12314415e+04  3.48850199e+04  2.22e-03 1.14e-04  4.12e-02     8s
  34   2.22602803e+04  3.41439757e+04  1.81e-03 9.91e-05  3.58e-02     8s
  35   2.26044961e+04  3.37627055e+04  1.67e-03 9.40e-05  3.36e-02     8s
  36   2.28254800e+04  3.32088138e+04  1.58e-03 8.66e-05  3.13e-02     9s
  37   2.30894456e+04  3.22788718e+04  1.49e-03 7.42e-05  2.77e-02     9s
  38   2.35553536e+04  3.14464955e+04  1.32e-03 6.10e-05  2.38e-02     9s
  39   2.39974535e+04  3.10769341e+04  1.16e-03 5.51e-05  2.13e-02     9s
  40   2.45437477e+04  2.98472391e+04  9.67e-04 3.72e-05  1.60e-02     9s
  41   2.52691463e+04  2.94531845e+04  7.12e-04 3.08e-05  1.26e-02     9s
  42   2.56450481e+04  2.87907329e+04  5.84e-04 2.67e-05  9.48e-03     9s
  43   2.62102912e+04  2.80813378e+04  4.04e-04 1.14e-05  5.64e-03     9s
  44   2.65580303e+04  2.78961757e+04  2.90e-04 1.01e-05  4.03e-03     9s
  45   2.68358792e+04  2.77508033e+04  1.99e-04 6.87e-06  2.76e-03     9s
  46   2.69504219e+04  2.76801953e+04  1.63e-04 5.71e-06  2.20e-03     9s
  47   2.71505457e+04  2.75922625e+04  1.01e-04 9.66e-06  1.33e-03     9s
  48   2.72760536e+04  2.75356214e+04  6.20e-05 9.80e-06  7.83e-04     9s
  49   2.73170699e+04  2.75213353e+04  4.96e-05 6.86e-06  6.16e-04     9s
  50   2.74220458e+04  2.75104378e+04  1.72e-05 4.67e-06  2.66e-04    10s
  51   2.74594048e+04  2.75008384e+04  7.46e-06 2.67e-06  1.25e-04    10s
  52   2.74698067e+04  2.74966585e+04  4.70e-06 1.48e-06  8.09e-05    10s
  53   2.74768287e+04  2.74897424e+04  2.82e-06 1.81e-07  3.89e-05    10s
  54   2.74810545e+04  2.74889705e+04  1.76e-06 6.76e-08  2.39e-05    10s
  55   2.74834197e+04  2.74888416e+04  1.19e-06 4.78e-08  1.63e-05    10s
  56   2.74869409e+04  2.74885879e+04  3.23e-07 1.69e-08  4.97e-06    10s
  57   2.74881956e+04  2.74884000e+04  4.08e-08 1.55e-07  6.16e-07    10s
  58   2.74883807e+04  2.74883809e+04  2.93e-09 1.81e-08  7.22e-10    10s

Barrier solved model in 58 iterations and 10.09 seconds (19.49 work units)
Optimal objective 2.74883807e+04


Root crossover log...

  163807 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                13s

   14364 PPushes remaining with PInf 1.2332177e-04                13s
       0 PPushes remaining with PInf 0.0000000e+00                14s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.4807426e+04     14s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   90660    2.7488381e+04   0.000000e+00   1.480743e+04     14s
   90782    2.7488381e+04   0.000000e+00   0.000000e+00     14s
   90782    2.7488381e+04   0.000000e+00   0.000000e+00     14s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 2.748838e+04, 90782 iterations, 10.17 seconds (20.92 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 27488.3809    0  131 -219438.19 27488.3809   113%     -   14s
H    0     0                    -130764.3730 27488.3809   121%     -   15s
H    0     0                    -126974.0792 27488.3809   122%     -   15s
H    0     0                    -71394.31792 27488.3809   139%     -   15s
H    0     0                    -9659.251311 27488.3809   385%     -   15s
H    0     0                    -3831.244296 27488.3809   817%     -   16s
H    0     0                    -3012.250202 27488.3809  1013%     -   16s
H    0     0                    -1522.080106 27488.3809  1906%     -   16s
H    0     0                    -1443.508913 27488.3809  2004%     -   16s
H    0     0                    -1378.478021 27488.3809  2094%     -   16s
     0     0 21514.6389    0  246 -1378.4780 21514.6389  1661%     -   53s
H    0     0                    -1309.833231 21512.9813  1742%     -   54s
H    0     0                    -1282.052975 21512.9813  1778%     -   54s
     0     0 21100.4729    0  268 -1282.0530 21100.4729  1746%     -   72s
     0     0 21070.9729    0  227 -1282.0530 21070.9729  1744%     -   75s
     0     0 21063.4158    0  227 -1282.0530 21063.4158  1743%     -   76s
     0     0 21063.4154    0  227 -1282.0530 21063.4154  1743%     -   77s
     0     0 17672.9834    0  181 -1282.0530 17672.9834  1478%     -  110s
     0     0 17303.4856    0  203 -1282.0530 17303.4856  1450%     -  123s
     0     0 17256.6878    0  206 -1282.0530 17256.6878  1446%     -  129s
     0     0 17181.0754    0  198 -1282.0530 17181.0754  1440%     -  133s
     0     0 16921.1212    0  263 -1282.0530 16921.1212  1420%     -  143s
     0     0 16895.0372    0  219 -1282.0530 16895.0372  1418%     -  148s
     0     0 16893.2756    0  213 -1282.0530 16893.2756  1418%     -  150s
     0     0 16870.9789    0  279 -1282.0530 16870.9789  1416%     -  154s
     0     0 16870.3320    0  277 -1282.0530 16870.3320  1416%     -  156s
     0     0 14145.3043    0  321 -1282.0530 14145.3043  1203%     -  208s
     0     0 13516.1306    0  420 -1282.0530 13516.1306  1154%     -  243s
     0     0 13213.9118    0  433 -1282.0530 13213.9118  1131%     -  265s
     0     0 13039.1921    0  426 -1282.0530 13039.1921  1117%     -  280s
     0     0 13005.4157    0  430 -1282.0530 13005.4157  1114%     -  289s
     0     0 12995.9269    0  431 -1282.0530 12995.9269  1114%     -  294s
     0     0 12970.6843    0  426 -1282.0530 12970.6843  1112%     -  302s
     0     0 12875.2297    0  430 -1282.0530 12875.2297  1104%     -  315s
     0     0 12861.9297    0  426 -1282.0530 12861.9297  1103%     -  320s
     0     0 12829.4714    0  428 -1282.0530 12829.4714  1101%     -  329s
     0     0 12809.6037    0  432 -1282.0530 12809.6037  1099%     -  334s
     0     0 12808.1541    0  434 -1282.0530 12808.1541  1099%     -  337s
     0     0 11955.2263    0  388 -1282.0530 11955.2263  1033%     -  391s
     0     0 11510.0678    0  459 -1282.0530 11510.0678   998%     -  424s
     0     0 11104.1922    0  417 -1282.0530 11104.1922   966%     -  440s
     0     0 11065.3827    0  478 -1282.0530 11065.3827   963%     -  446s
     0     0 11053.5573    0  480 -1282.0530 11053.5573   962%     -  449s
     0     0 11034.8635    0  423 -1282.0530 11034.8635   961%     -  455s
     0     0 11026.1448    0  527 -1282.0530 11026.1448   960%     -  460s
     0     0 11021.8224    0  472 -1282.0530 11021.8224   960%     -  462s
     0     0 11011.9215    0  469 -1282.0530 11011.9215   959%     -  467s
     0     0 11011.1091    0  535 -1282.0530 11011.1091   959%     -  469s
     0     0 10861.9437    0  415 -1282.0530 10861.9437   947%     -  481s
     0     0 10765.1698    0  472 -1282.0530 10765.1698   940%     -  491s
     0     0 10744.4759    0  484 -1282.0530 10744.4759   938%     -  500s
     0     0 10706.4806    0  481 -1282.0530 10706.4806   935%     -  505s
     0     0 10694.8675    0  488 -1282.0530 10694.8675   934%     -  508s
     0     0 10689.0875    0  430 -1282.0530 10689.0875   934%     -  511s
     0     0 10686.1763    0  429 -1282.0530 10686.1763   934%     -  513s
     0     0 10682.7584    0  535 -1282.0530 10682.7584   933%     -  516s
     0     0 10681.4188    0  432 -1282.0530 10681.4188   933%     -  518s
     0     0 10560.7022    0  542 -1282.0530 10560.7022   924%     -  532s
H    0     0                    -1212.688072 10559.8151   971%     -  543s
H    0     0                    -1183.689944 10559.8151   992%     -  544s
     0     0 10526.8035    0  530 -1183.6899 10526.8035   989%     -  553s
     0     0 10518.0771    0  491 -1183.6899 10518.0771   989%     -  559s
     0     0 10512.4057    0  539 -1183.6899 10512.4057   988%     -  563s
     0     0 10511.1075    0  535 -1183.6899 10511.1075   988%     -  565s
     0     0 10483.2482    0  492 -1183.6899 10483.2482   986%     -  575s
     0     0 10476.1688    0  490 -1183.6899 10476.1688   985%     -  581s
     0     0 10467.8777    0  494 -1183.6899 10467.8777   984%     -  583s
     0     0 10460.6335    0  549 -1183.6899 10460.6335   984%     -  588s
     0     0 10459.3766    0  551 -1183.6899 10459.3766   984%     -  590s
     0     0 10372.2494    0  404 -1183.6899 10372.2494   976%     -  599s
H    0     0                    -1157.183090 10371.7902   996%     -  617s
     0     0 10369.3816    0  478 -1157.1831 10369.3816   996%     -  622s
     0     0 10345.2294    0  534 -1157.1831 10345.2294   994%     -  626s
     0     0 10343.9916    0  493 -1157.1831 10343.9916   994%     -  628s
     0     0 10334.5523    0  541 -1157.1831 10334.5523   993%     -  633s
     0     0 10329.2050    0  504 -1157.1831 10329.2050   993%     -  637s
     0     0 10327.1263    0  500 -1157.1831 10327.1263   992%     -  639s
     0     0 10320.1498    0  541 -1157.1831 10320.1498   992%     -  644s
     0     0 10318.4767    0  504 -1157.1831 10318.4767   992%     -  646s
     0     0 10312.8144    0  521 -1157.1831 10312.8144   991%     -  653s
     0     0 10311.6768    0  491 -1157.1831 10311.6768   991%     -  657s
     0     0 10302.7061    0  572 -1157.1831 10302.7061   990%     -  666s
     0     0 10302.6653    0  572 -1157.1831 10302.6653   990%     -  671s
H    0     0                    -1142.850353 10302.6653  1001%     -  776s
     0     2 10302.6653    0  572 -1142.8504 10302.6653  1001%     -  844s
     1     4 10217.6304    1  462 -1142.8504 10302.6653  1001% 18653  867s
     3     8 10108.4556    2  350 -1142.8504 10217.2811   994% 14551  893s
     7    14 9536.58276    3  478 -1142.8504 10108.4149   984% 18137  939s
    13    28 9299.18192    4  352 -1142.8504 9713.15625   950% 22068  978s
    27    42 8961.67453    5  336 -1142.8504 9299.09275   914% 27021 1055s
    41    74 8409.65875    6  349 -1142.8504 9299.09275   914% 28484 1214s
    73   195 8118.17626    7  424 -1142.8504 9102.65067   896% 26429 1283s
   194   218 8084.33100    9  417 -1142.8504 9102.50703   896% 14627 1328s
   217   258 8053.79074   10  416 -1142.8504 9102.50703   896% 13826 1363s
   257   294 7980.58048   12  404 -1142.8504 9102.50703   896% 13294 1413s
   293   349 7824.05797   13  396 -1142.8504 9102.50703   896% 12793 1449s
   354   374 7770.26105   15  406 -1142.8504 9102.50703   896% 11948 1476s
   381   426 7619.90758   16  404 -1142.8504 9102.50703   896% 12047 1507s
   437   477 7604.87494   17  402 -1142.8504 9102.50703   896% 11742 1536s
H  487   477                    -1132.226300 9102.50703   904% 11319 1536s
   521   482 1814.00307   17  222 -1132.2263 9102.50703   904% 11221 1566s
   597   496 6605.14097   17  390 -1132.2263 9102.50703   904% 10923 1594s
   665   505 4706.76189   18  272 -1132.2263 9102.50703   904% 11068 1628s
   726   509 2093.52394   12  226 -1132.2263 9102.50703   904% 11042 1654s
   772   523 1844.40278   19  189 -1132.2263 9102.50703   904% 11108 1681s
   804   540 1447.73563   20  178 -1132.2263 9102.50703   904% 11227 1714s
   842   563  717.40341   22  190 -1132.2263 9102.50703   904% 11424 1740s
   887   581 infeasible   23      -1132.2263 8967.72701   892% 11411 1767s
   937   631 1083.49652   17  202 -1132.2263 8967.72701   892% 11419 1794s
  1009   704 -145.03694   18  188 -1132.2263 8879.96910   884% 11186 1822s
  1096   732 2688.03054   15  208 -1132.2263 8879.96910   884% 10934 1847s
  1191   754 2474.15451   16  209 -1132.2263 8879.96910   884% 10637 1876s
  1227   780 1643.59997   17  179 -1132.2263 8879.96910   884% 10799 1901s
  1273   809 1523.95939   18  162 -1132.2263 8879.96910   884% 10782 1933s
  1318   845 1511.95808   19  163 -1132.2263 8879.96910   884% 10729 1960s
  1367   881  586.07662   20  134 -1132.2263 8879.96910   884% 10612 1989s
  1436   904  388.08674   21  139 -1132.2263 8879.96910   884% 10491 2024s
  1505   951  381.35832   22  132 -1132.2263 8879.96910   884% 10363 2056s
  1574  1012  290.45388   23  107 -1132.2263 8879.96910   884% 10231 2085s
  1667  1059  -36.46455   24  133 -1132.2263 8879.96910   884%  9984 2124s
  1796  1080 -284.47969   25  119 -1132.2263 8879.96910   884%  9686 2166s
  1909  1104 3944.63052   14  231 -1132.2263 8879.96910   884%  9560 2213s
  1995  1146  301.05258   15  153 -1132.2263 8879.96910   884%  9583 2262s
  2083  1188 -590.86466   22  119 -1132.2263 8879.96910   884%  9665 2306s
  2208  1237 -1074.0010   29   99 -1132.2263 8879.96910   884%  9610 2353s
  2331  1312 2894.22962   27  188 -1132.2263 8879.96910   884%  9652 2407s
  2462  1426 4218.60735   29  401 -1132.2263 8879.96910   884%  9668 2457s
  2620  1558 4144.75986   30  346 -1132.2263 8879.96910   884%  9671 2509s
  2826  1684 3613.53731   35  345 -1132.2263 8879.96910   884%  9500 2566s
  3069  1767 3113.91003   38  282 -1132.2263 8879.96910   884%  9266 2625s
  3232  1864 2675.01855   45  319 -1132.2263 8879.96910   884%  9132 2684s
  3389  1945 1989.59027   48  238 -1132.2263 8879.96910   884%  9028 2748s
  3542  2103 1006.08843   57  263 -1132.2263 8879.96910   884%  9021 2811s
  3756  2200 -783.66849   78  322 -1132.2263 8622.32462   862%  8904 2879s
  3929  2201  229.13220   67  572 -1132.2263 8622.32462   862%  8935 3218s
  3931  2202 3132.73056   15  128 -1132.2263 8622.32462   862%  8931 3236s
  3932  2203 3848.05155   32  346 -1132.2263 8622.32462   862%  8929 3320s
  3933  2204 7525.30516    8  421 -1132.2263 8622.32462   862%  8926 3404s
  3934  2204   24.82348   21  439 -1132.2263 8622.32462   862%  8924 3458s
  3935  2205  400.30326   17  478 -1132.2263 8622.32462   862%  8922 3482s
  3936  2206 3645.43909   14  523 -1132.2263 8622.32462   862%  8920 3503s
  3937  2206  226.84414   60  466 -1132.2263 8622.32462   862%  8917 3515s
  3938  2207 7846.56607    7  402 -1132.2263 8622.32462   862%  8915 3530s
  3939  2208  638.23578   20  463 -1132.2263 8622.32462   862%  8913 3540s
  3940  2208 6398.07641    9  486 -1132.2263 8622.32462   862%  8910 3545s
  3941  2209 3302.13444   23  470 -1132.2263 8622.32462   862%  8908 3550s
  3942  2210 -644.00507   30  513 -1132.2263 8622.32462   862%  8906 3559s
  3943  2210  850.82498   19  525 -1132.2263 8622.32462   862%  8904 3563s
  3944  2211 1244.12543   81  484 -1132.2263 8622.32462   862%  8901 3571s

Cutting planes:
  Gomory: 18
  Implied bound: 14
  Projected implied bound: 118
  MIR: 1303
  Mixing: 5
  Flow cover: 1744
  RLT: 21
  Relax-and-lift: 325

Explored 3944 nodes (36276049 simplex iterations) in 3600.06 seconds (9431.22 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -1132.23 -1142.85 -1157.18 ... -1522.08

Time limit reached
Best objective -1.132226299926e+03, best bound 8.622324617137e+03, gap 861.5372%
  WARNING: Time limit reached. Using best solution found (gap: 861.54%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.20s
  Master Objective (UB) = -1132.23, θ = 140817.05
  Upper Bound (UB) = -1132.23

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 140817.05
  [DEBUG]   ✓ Scenario 0: θ = 140817.05 ≤ Q = 140817.05 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 140817.05 ≤ Q = 140817.05 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 140817.05 ≤ Q = 140817.05 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 140817.05 ≤ Q = 140817.05 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 140817.05 ≤ Q = 140817.05 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 140817.05 ≤ Q = 140817.05 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 140817.05 ≤ Q = 140817.05 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 140817.05 ≤ Q = 140817.05 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 140817.05 ≤ Q = 140817.05 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 140817.05 ≤ Q = 140817.05 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 140817.05 ≤ Q = 140817.05 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 140817.05 ≤ Q = 140817.05 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 140817.05 ≤ Q = 140817.05 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 140817.05 ≤ Q = 140817.05 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 140817.05 ≤ Q = 140817.05 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 140817.05 ≤ Q = 140817.05 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 140817.05 ≤ Q = 140817.05 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 140817.05 ≤ Q = 140817.05 (slack: 0.00)
  [DEBUG]   ✓ Scenario 18: θ = 140817.05 ≤ Q = 140817.05 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 140817.05 ≤ Q = 140817.05 (slack: -0.00)
  [DEBUG]   ✓ Scenario 20: θ = 140817.05 ≤ Q = 140817.05 (slack: 0.00)
  [DEBUG]   ✓ Scenario 21: θ = 140817.05 ≤ Q = 140817.05 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 22] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x6e8a75c9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x6e8a75c9
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.159554e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.00s
Presolved: 494 rows, 498 columns, 1396 nonzeros
Found heuristic solution: objective 5711881.6663
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.300887e+05, 243 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -130088.65    0  123 5711881.67 -130088.65   102%     -    0s
H    0     0                    -97753.84465 -130088.65  33.1%     -    0s
H    0     0                    -98371.42362 -130088.65  32.2%     -    0s
     0     0 -105934.52    0  106 -98371.424 -105934.52  7.69%     -    0s
H    0     0                    -101716.1631 -105793.86  4.01%     -    0s
H    0     0                    -102876.9931 -105793.86  2.84%     -    0s
     0     0 -104980.09    0  106 -102876.99 -104980.09  2.04%     -    0s
H    0     0                    -103400.7674 -104958.19  1.51%     -    0s
     0     0 -104958.19    0  106 -103400.77 -104958.19  1.51%     -    0s
     0     0 -104489.26    0  107 -103400.77 -104489.26  1.05%     -    0s
     0     0 -104419.90    0  111 -103400.77 -104419.90  0.99%     -    0s
     0     0 -104408.07    0  111 -103400.77 -104408.07  0.97%     -    0s
     0     0 -104146.65    0  105 -103400.77 -104146.65  0.72%     -    0s
     0     0 -104065.82    0  110 -103400.77 -104065.82  0.64%     -    0s
     0     0 -104061.43    0  110 -103400.77 -104061.43  0.64%     -    0s
     0     0 -103942.09    0   90 -103400.77 -103942.09  0.52%     -    0s
     0     0 -103896.28    0   86 -103400.77 -103896.28  0.48%     -    0s
     0     0 -103872.32    0   84 -103400.77 -103872.32  0.46%     -    0s
     0     0 -103831.83    0  101 -103400.77 -103831.83  0.42%     -    0s
     0     0 -103831.38    0  101 -103400.77 -103831.38  0.42%     -    0s
     0     2 -103831.38    0  101 -103400.77 -103831.38  0.42%     -    0s
H   88    22                    -103416.8204 -103503.27  0.08%   9.9    0s
H  113    22                    -103426.1158 -103503.27  0.07%   8.8    0s
H  113    22                    -103427.1570 -103503.27  0.07%   8.8    0s

Cutting planes:
  Gomory: 31
  Implied bound: 1
  MIR: 222
  Flow cover: 5
  RLT: 3
  BQP: 2

Explored 141 nodes (1830 simplex iterations) in 0.13 seconds (0.08 work units)
Thread count was 32 (of 256 available processors)

Solution count 8: -103427 -103417 -103401 ... 1.15955e+13
No other solutions better than -103427

Optimal solution found (tolerance 1.00e-04)
Best objective -1.034271570278e+05, best bound -1.034271570278e+05, gap 0.0000%
  Subproblem solved in 0.14s
  Worst-case operational profit (Z_SP) = 138033.26
  Scenario: 22 demand increases, 38 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -103427.16
  [DEBUG]   S×d_nominal = 241460.42
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 241460.42 + -103427.16 = 138033.26
  [DEBUG]   Current θ from Master = 140817.05
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2783.79 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -3916.02
  Lower Bound (LB) = -1589.09
  Gap (UB-LB) = 456.8629, Absolute Gap = 456.8629, Relative Gap = 0.403508
  Not converged yet (gap = 456.86 > ε = 200)

  [DEBUG] Adding NEW scenario 22 to Master Problem...
  [DEBUG] New scenario pattern: 22 increases, 38 decreases
    [DEBUG] Scenario 22 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 22 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 22]
    [DEBUG]   - Total constraints in model: 353053
    [DEBUG]   - Total variables in model: 145780
  [DEBUG] Total scenarios in Master: 23
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 23
================================================================================
[Iteration 23] Solving Master Problem...
  Current scenarios in Master: 23
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 353053 rows, 145780 columns and 999832 nonzeros
Model fingerprint: 0xf2ee39c4
Variable types: 143521 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 162610 rows and 66010 columns
Presolve time: 3.10s
Presolved: 190443 rows, 79770 columns, 1173843 nonzeros
Variable types: 77511 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -373180.1084
Found heuristic solution: objective -219438.1934

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.62s

Barrier statistics:
 Dense cols : 1184
 AA' NZ     : 4.946e+06
 Factor NZ  : 1.376e+07 (roughly 200 MB of memory)
 Factor Ops : 4.913e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.73552944e+07  2.93814452e+08  9.82e+04 1.50e+01  7.10e+04     6s
   1  -1.35515528e+07  2.58400725e+08  7.07e+04 4.58e+01  5.07e+04     7s
   2  -4.97630569e+06  2.11364577e+08  2.43e+04 8.01e+00  1.82e+04     7s
   3  -1.00075711e+06  1.51382693e+08  2.34e+03 2.52e+00  2.09e+03     7s
   4  -5.98630954e+05  1.16558145e+08  5.07e+02 1.49e+00  6.78e+02     7s
   5  -5.49352420e+05  6.12161677e+07  3.31e+02 6.50e-01  3.74e+02     7s
   6  -4.69823132e+05  5.04695336e+07  1.33e+02 5.09e-01  2.22e+02     7s
   7  -4.31148127e+05  3.64834740e+07  7.63e+01 3.46e-01  1.45e+02     7s
   8  -3.41690589e+05  2.56158481e+07  1.92e+01 2.29e-01  8.32e+01     7s
   9  -1.96321666e+05  1.34200528e+07  2.23e+00 1.12e-01  3.99e+01     7s
  10  -1.63248113e+05  6.20112877e+06  1.65e+00 5.13e-02  1.86e+01     7s
  11  -1.36908605e+05  5.42322564e+06  1.14e+00 4.46e-02  1.62e+01     7s
  12  -1.21331363e+05  3.92291881e+06  7.71e-01 3.20e-02  1.17e+01     7s
  13  -1.15692579e+05  3.22782122e+06  6.75e-01 2.64e-02  9.69e+00     7s
  14  -8.67953790e+04  2.52641849e+06  2.66e-01 2.11e-02  7.55e+00     7s
  15  -6.37476671e+04  8.00719398e+05  1.11e-01 6.61e-03  2.50e+00     7s
  16  -4.06064153e+04  2.97709219e+05  5.13e-02 1.89e-03  9.76e-01     7s
  17  -2.95782192e+04  2.05244871e+05  3.71e-02 1.55e-03  6.78e-01     7s
  18  -1.94747023e+04  1.59320190e+05  2.78e-02 1.56e-03  5.16e-01     7s
  19  -1.02273973e+04  1.31589036e+05  2.11e-02 1.36e-03  4.09e-01     8s
  20  -6.84919616e+03  1.21462654e+05  1.85e-02 1.23e-03  3.70e-01     8s
  21  -3.13298431e+03  1.00725499e+05  1.60e-02 9.89e-04  3.00e-01     8s
  22   1.92089558e+02  8.46447458e+04  1.37e-02 7.69e-04  2.44e-01     8s
  23   5.37096510e+03  6.52781007e+04  1.05e-02 5.35e-04  1.73e-01     8s
  24   8.69316758e+03  5.51468783e+04  8.56e-03 4.10e-04  1.34e-01     8s
  25   1.18243458e+04  4.89732831e+04  6.82e-03 3.19e-04  1.07e-01     8s
  26   1.40494805e+04  4.29153666e+04  5.64e-03 2.46e-04  8.33e-02     8s
  27   1.68603862e+04  4.13903388e+04  4.25e-03 2.22e-04  7.08e-02     8s
  28   1.73458140e+04  3.99371477e+04  4.04e-03 2.07e-04  6.52e-02     8s
  29   1.80256147e+04  3.80786777e+04  3.73e-03 1.79e-04  5.79e-02     8s
  30   1.90274746e+04  3.59638958e+04  3.29e-03 1.48e-04  4.89e-02     8s
  31   1.98039595e+04  3.54334165e+04  2.96e-03 1.48e-04  4.51e-02     9s
  32   2.09118233e+04  3.44350693e+04  2.48e-03 1.90e-04  3.90e-02     9s
  33   2.10711354e+04  3.27087304e+04  2.40e-03 1.47e-04  3.36e-02     9s
  34   2.27186032e+04  3.22768283e+04  1.74e-03 1.35e-04  2.76e-02     9s
  35   2.29832631e+04  3.16504295e+04  1.63e-03 1.16e-04  2.50e-02     9s
  36   2.33815084e+04  3.10691658e+04  1.47e-03 1.01e-04  2.22e-02     9s
  37   2.35622433e+04  3.03631646e+04  1.40e-03 8.18e-05  1.96e-02     9s
  38   2.43743380e+04  2.98150813e+04  1.10e-03 6.63e-05  1.57e-02     9s
  39   2.49531029e+04  2.89836857e+04  8.92e-04 4.15e-05  1.16e-02     9s
  40   2.56068769e+04  2.87065256e+04  6.63e-04 3.33e-05  8.94e-03     9s
  41   2.61219118e+04  2.85709498e+04  4.77e-04 2.95e-05  7.07e-03     9s
  42   2.64486458e+04  2.83639070e+04  3.67e-04 2.37e-05  5.53e-03     9s
  43   2.67004686e+04  2.82708685e+04  2.83e-04 2.11e-05  4.53e-03    10s
  44   2.69200214e+04  2.80426075e+04  2.07e-04 1.42e-05  3.24e-03    10s
  45   2.70178263e+04  2.79681696e+04  1.73e-04 1.20e-05  2.74e-03    10s
  46   2.72765703e+04  2.78566023e+04  8.58e-05 8.70e-06  1.67e-03    10s
  47   2.74123000e+04  2.77234962e+04  4.16e-05 4.90e-06  8.98e-04    10s
  48   2.74652355e+04  2.76668618e+04  2.54e-05 3.24e-06  5.82e-04    10s
  49   2.74836611e+04  2.76217973e+04  2.00e-05 2.56e-06  3.99e-04    10s
  50   2.75008253e+04  2.76001179e+04  1.50e-05 1.63e-06  2.86e-04    10s
  51   2.75323808e+04  2.75869041e+04  5.51e-06 1.14e-06  1.57e-04    10s
  52   2.75425680e+04  2.75740834e+04  3.00e-06 6.64e-07  9.09e-05    10s
  53   2.75446808e+04  2.75722547e+04  2.52e-06 5.95e-07  7.95e-05    10s
  54   2.75488137e+04  2.75658040e+04  1.54e-06 3.54e-07  4.90e-05    10s
  55   2.75510651e+04  2.75602683e+04  1.05e-06 1.55e-07  2.66e-05    10s
  56   2.75520093e+04  2.75587585e+04  8.33e-07 1.03e-07  1.95e-05    10s
  57   2.75549843e+04  2.75564374e+04  1.65e-07 1.92e-08  4.19e-06    11s
  58   2.75558738e+04  2.75559294e+04  9.64e-09 3.23e-08  1.60e-07    11s
  59   2.75558958e+04  2.75558959e+04  8.90e-11 5.74e-10  1.60e-10    11s

Barrier solved model in 59 iterations and 10.64 seconds (20.82 work units)
Optimal objective 2.75558958e+04


Root crossover log...

  170495 DPushes remaining with DInf 0.0000000e+00                11s
       0 DPushes remaining with DInf 0.0000000e+00                14s

    3157 PPushes remaining with PInf 1.5371861e-05                14s
       0 PPushes remaining with PInf 0.0000000e+00                15s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.7145900e+00     15s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   71726    2.7555896e+04   0.000000e+00   3.714590e+00     15s
   71727    2.7555896e+04   0.000000e+00   0.000000e+00     15s
   71727    2.7555896e+04   0.000000e+00   0.000000e+00     15s
Concurrent spin time: 1.15s

Solved with barrier

Root relaxation: objective 2.755590e+04, 71727 iterations, 12.00 seconds (24.40 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 27555.8958    0  135 -219438.19 27555.8958   113%     -   16s
H    0     0                    -176019.0082 27555.8958   116%     -   17s
H    0     0                    -136515.2017 27555.8958   120%     -   17s
H    0     0                    -118273.4707 27555.8958   123%     -   17s
H    0     0                    -116211.9807 27555.8958   124%     -   17s
H    0     0                    -71394.31792 27555.8958   139%     -   17s
H    0     0                    -4328.740856 27555.8958   737%     -   18s
H    0     0                    -3805.628091 27555.8958   824%     -   18s
H    0     0                    -1991.220095 27555.8958  1484%     -   18s
H    0     0                    -1359.904056 27555.8958  2126%     -   18s
     0     0 21698.5114    0  248 -1359.9041 21698.5114  1696%     -   60s
H    0     0                    -1357.010271 21698.0030  1699%     -   61s
     0     0 21076.8478    0  281 -1357.0103 21076.8478  1653%     -   90s
     0     0 20924.0040    0  268 -1357.0103 20924.0040  1642%     -  106s
     0     0 20913.2903    0  270 -1357.0103 20913.2903  1641%     -  109s
     0     0 20894.9276    0  220 -1357.0103 20894.9276  1640%     -  112s
     0     0 20893.6019    0  272 -1357.0103 20893.6019  1640%     -  114s
     0     0 20893.3941    0  274 -1357.0103 20893.3941  1640%     -  115s
     0     0 17436.1613    0  237 -1357.0103 17436.1613  1385%     -  153s
     0     0 17199.9252    0  254 -1357.0103 17199.9252  1367%     -  164s
     0     0 17069.3018    0  265 -1357.0103 17069.3018  1358%     -  185s
     0     0 16729.3094    0  331 -1357.0103 16729.3094  1333%     -  205s
     0     0 16677.5590    0  316 -1357.0103 16677.5590  1329%     -  212s
     0     0 16655.4524    0  259 -1357.0103 16655.4524  1327%     -  217s
     0     0 16599.1196    0  263 -1357.0103 16599.1196  1323%     -  220s
     0     0 16590.9757    0  270 -1357.0103 16590.9757  1323%     -  223s
     0     0 16579.3199    0  260 -1357.0103 16579.3199  1322%     -  228s
     0     0 16395.3056    0  262 -1357.0103 16395.3056  1308%     -  235s
     0     0 16280.0996    0  315 -1357.0103 16280.0996  1300%     -  245s
     0     0 16129.4168    0  266 -1357.0103 16129.4168  1289%     -  253s
     0     0 16121.4493    0  268 -1357.0103 16121.4493  1288%     -  257s
     0     0 16121.0315    0  267 -1357.0103 16121.0315  1288%     -  258s
     0     0 13821.4456    0  382 -1357.0103 13821.4456  1119%     -  308s
     0     0 13299.7784    0  400 -1357.0103 13299.7784  1080%     -  339s
     0     0 13160.1716    0  423 -1357.0103 13160.1716  1070%     -  355s
     0     0 13086.0149    0  478 -1357.0103 13086.0149  1064%     -  367s
     0     0 13026.9300    0  439 -1357.0103 13026.9300  1060%     -  378s
     0     0 12966.3135    0  435 -1357.0103 12966.3135  1056%     -  390s
     0     0 12956.1326    0  403 -1357.0103 12956.1326  1055%     -  393s
     0     0 12950.7304    0  405 -1357.0103 12950.7304  1054%     -  399s
     0     0 12946.7890    0  444 -1357.0103 12946.7890  1054%     -  404s
     0     0 12942.5110    0  407 -1357.0103 12942.5110  1054%     -  409s
     0     0 12941.6761    0  408 -1357.0103 12941.6761  1054%     -  410s
     0     0 11837.1601    0  446 -1357.0103 11837.1601   972%     -  473s
     0     0 11518.2102    0  490 -1357.0103 11518.2102   949%     -  504s
     0     0 11450.2145    0  435 -1357.0103 11450.2145   944%     -  519s
     0     0 11412.7421    0  348 -1357.0103 11412.7421   941%     -  530s
     0     0 11391.0319    0  351 -1357.0103 11391.0319   939%     -  537s
     0     0 11379.8051    0  346 -1357.0103 11379.8051   939%     -  543s
     0     0 11372.5094    0  437 -1357.0103 11372.5094   938%     -  551s
     0     0 11327.9910    0  340 -1357.0103 11327.9910   935%     -  564s
     0     0 11318.7727    0  346 -1357.0103 11318.7727   934%     -  573s
     0     0 11314.7815    0  347 -1357.0103 11314.7815   934%     -  578s
     0     0 11301.2310    0  341 -1357.0103 11301.2310   933%     -  583s
     0     0 11250.6661    0  433 -1357.0103 11250.6661   929%     -  594s
     0     0 11237.3097    0  430 -1357.0103 11237.3097   928%     -  599s
     0     0 11235.5879    0  433 -1357.0103 11235.5879   928%     -  603s
     0     0 10976.9851    0  383 -1357.0103 10976.9851   909%     -  623s
     0     0 10892.1859    0  457 -1357.0103 10892.1859   903%     -  638s
     0     0 10877.9396    0  460 -1357.0103 10877.9396   902%     -  644s
     0     0 10862.4583    0  466 -1357.0103 10862.4583   900%     -  650s
     0     0 10856.9165    0  393 -1357.0103 10856.9165   900%     -  655s
     0     0 10853.9423    0  394 -1357.0103 10853.9423   900%     -  658s
     0     0 10846.8533    0  469 -1357.0103 10846.8533   899%     -  665s
     0     0 10834.9402    0  399 -1357.0103 10834.9402   898%     -  671s
     0     0 10832.7204    0  407 -1357.0103 10832.7204   898%     -  675s
     0     0 10560.0696    0  526 -1357.0103 10560.0696   878%     -  702s
H    0     0                    -1282.052975 10559.9901   924%     -  716s
     0     0 10507.2906    0  532 -1282.0530 10507.2906   920%     -  731s
     0     0 10484.1798    0  525 -1282.0530 10484.1798   918%     -  740s
     0     0 10469.7062    0  588 -1282.0530 10469.7062   917%     -  745s
     0     0 10459.3066    0  544 -1282.0530 10459.3066   916%     -  748s
     0     0 10453.2352    0  592 -1282.0530 10453.2352   915%     -  750s
     0     0 10451.9714    0  599 -1282.0530 10451.9714   915%     -  751s
     0     0 10396.1973    0  345 -1282.0530 10396.1973   911%     -  772s
     0     0 10363.5990    0  471 -1282.0530 10363.5990   908%     -  782s
     0     0 10351.9505    0  507 -1282.0530 10351.9505   907%     -  790s
     0     0 10348.7103    0  513 -1282.0530 10348.7103   907%     -  795s
     0     0 10347.4325    0  508 -1282.0530 10347.4325   907%     -  797s
     0     0 10327.8036    0  490 -1282.0530 10327.8036   906%     -  809s
H    0     0                    -1143.315626 10327.6890  1003%     -  827s
     0     0 10313.5577    0  492 -1143.3156 10313.5577  1002%     -  837s
     0     0 10306.0344    0  466 -1143.3156 10306.0344  1001%     -  841s
     0     0 10304.4864    0  401 -1143.3156 10304.4864  1001%     -  846s
     0     0 10284.4175    0  452 -1143.3156 10284.4175  1000%     -  855s
     0     0 10278.9783    0  497 -1143.3156 10278.9783   999%     -  863s
     0     0 10276.2395    0  360 -1143.3156 10276.2395   999%     -  865s
     0     0 10271.1837    0  491 -1143.3156 10271.1837   998%     -  870s
     0     0 10270.9379    0  423 -1143.3156 10270.9379   998%     -  871s
     0     0 10261.4849    0  360 -1143.3156 10261.4849   998%     -  880s
H    0     0                    -1142.850353 10261.1994   998%     -  890s
     0     0 10259.6889    0  427 -1142.8504 10259.6889   998%     -  898s
     0     0 10252.9412    0  535 -1142.8504 10252.9412   997%     -  906s
     0     0 10248.8686    0  543 -1142.8504 10248.8686   997%     -  911s
     0     0 10246.5212    0  471 -1142.8504 10246.5212   997%     -  914s
     0     0 10242.6993    0  499 -1142.8504 10242.6993   996%     -  920s
     0     0 10240.5073    0  547 -1142.8504 10240.5073   996%     -  924s
     0     0 10237.8464    0  426 -1142.8504 10237.8464   996%     -  930s
     0     0 10237.8211    0  426 -1142.8504 10237.8211   996%     -  935s
     0     2 10237.8142    0  426 -1142.8504 10237.8142   996%     - 1057s
     1     3 8631.39015    1  306 -1142.8504 10237.6590   996% 19490 1080s
     2     5 8575.91423    2  298 -1142.8504 10237.6590   996% 13276 1097s
     4     9 8407.44289    3  300 -1142.8504 10114.8814   985% 11834 1111s
     8    15 9829.04310    3  493 -1142.8504 10113.9208   985% 11067 1137s
    14    30 9764.11633    4  517 -1142.8504 9918.49312   968% 13529 1162s
    29    45 7382.60088    5  304 -1142.8504 9810.54712   958% 19888 1228s
    44    77 7727.92928    5  335 -1142.8504 9810.54712   958% 22011 1379s
    76   113 7633.12593    6  333 -1142.8504 9771.24484   955% 18972 1418s
   112   149 7606.08320    7  323 -1142.8504 9771.24484   955% 15655 1463s
H  135   149                    -1137.622775 9771.24484   959% 13799 1463s
   148   229 7573.51965    8  306 -1137.6228 9771.24484   959% 13204 1516s
   228   288 5097.59864   12  231 -1137.6228 9771.24484   959% 11528 1553s
   287   333 4954.13018   15  232 -1137.6228 9771.24484   959% 10418 1594s
   333   412 4030.19673   17  204 -1137.6228 9771.24484   959% 10039 1625s
   420   488 3309.09490   21  180 -1137.6228 9771.24484   959%  9691 1652s
   519   533 2731.77808   20  158 -1137.6228 9771.24484   959%  9130 1677s
   615   576 1868.23169   23  152 -1137.6228 9771.24484   959%  8894 1700s
   700   611  340.74496   28  140 -1137.6228 9771.24484   959%  8700 1723s
   784   630 -371.75560   32  115 -1137.6228 9771.24484   959%  8471 1743s
   845   639 -429.95382   34  109 -1137.6228 9771.24484   959%  8396 1785s
   882   660 -512.69331   35  105 -1137.6228 9771.24484   959%  8331 1811s
   915   677     cutoff   36      -1137.6228 9771.24484   959%  8306 1828s
   975   705     cutoff   36      -1137.6228 9771.24484   959%  8238 1846s
  1051   715     cutoff   37      -1137.6228 9771.24484   959%  8049 1870s
  1137   760 -454.59833   41   89 -1137.6228 9771.24484   959%  7802 1896s
  1234   775     cutoff   45      -1137.6228 9771.24484   959%  7673 1921s
  1281   793     cutoff   47      -1137.6228 9771.24484   959%  7770 1947s
  1333   821     cutoff   18      -1137.6228 9547.88425   939%  7759 1975s
  1396   854  288.33175   24  164 -1137.6228 9547.88425   939%  7808 2005s
  1450   906 7269.17094    7  298 -1137.6228 9547.88425   939%  7840 2031s
  1520   945 6724.17952    9  306 -1137.6228 9547.88425   939%  7850 2061s
  1602   989 6527.08232   10  295 -1137.6228 9547.88425   939%  7902 2093s
  1693  1070 4848.40699   12  262 -1137.6228 9547.88425   939%  8028 2123s
  1812  1109 4445.50276   14  248 -1137.6228 9547.88425   939%  8054 2157s
  1911  1204 1052.22762   18  161 -1137.6228 9547.88425   939%  8144 2188s
  2038  1311 infeasible   19      -1137.6228 9547.88425   939%  8073 2228s
  2199  1411   14.18330   21  153 -1137.6228 9547.88425   939%  8040 2265s
  2358  1498 -596.34119   24  145 -1137.6228 9547.88425   939%  8033 2304s
  2543  1624 -212.93770   23  156 -1137.6228 9547.88425   939%  7908 2350s
  2744  1699 -233.05122   24  151 -1137.6228 8968.78510   888%  7807 2390s
  2929  1730 7011.26308   15  528 -1137.6228 8968.78510   888%  7765 2429s
  3037  1778 6723.42679   16  481 -1137.6228 8968.78510   888%  7771 2469s
  3125  1825 6602.68830   17  517 -1137.6228 8586.62903   855%  7884 2514s
  3224  1908 6496.88873   18  461 -1137.6228 8586.62903   855%  7983 2561s
  3358  2004 6341.03184   19  433 -1137.6228 8586.62903   855%  8061 2607s
  3540  2073 6220.17569   20  427 -1137.6228 8429.49475   841%  8030 2660s
  3722  2166 6062.48515   21  413 -1137.6228 8429.49475   841%  8071 2717s
  3883  2233 5673.98047   22  336 -1137.6228 8336.30532   833%  8149 2778s
  4053  2362 3556.19680   24  236 -1137.6228 8267.08801   827%  8246 2835s
  4289  2444  807.78557   28  193 -1137.6228 8267.08801   827%  8256 2901s
  4502  2536 infeasible   39      -1137.6228 8267.08801   827%  8325 2970s
  4717  2537 6030.98154   10  426 -1137.6228 8241.36265   824%  8393 3537s
  4719  2538 7431.92623   14  128 -1137.6228 8241.36265   824%  8389 3557s

Cutting planes:
  Gomory: 46
  Implied bound: 9
  Projected implied bound: 215
  MIR: 1395
  Mixing: 55
  Flow cover: 1321
  RLT: 86
  Relax-and-lift: 324

Explored 4719 nodes (40627948 simplex iterations) in 3600.02 seconds (9198.35 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -1137.62 -1142.85 -1143.32 ... -71394.3

Time limit reached
Best objective -1.137622774666e+03, best bound 8.241362650798e+03, gap 824.4372%
  WARNING: Time limit reached. Using best solution found (gap: 824.44%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = -1137.62, θ = 141232.69
  Upper Bound (UB) = -1137.62

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 141232.69
  [DEBUG]   ✓ Scenario 0: θ = 141232.69 ≤ Q = 141232.69 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 141232.69 ≤ Q = 141232.69 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 141232.69 ≤ Q = 141232.69 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 141232.69 ≤ Q = 141232.69 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 141232.69 ≤ Q = 141232.69 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 141232.69 ≤ Q = 141232.69 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 141232.69 ≤ Q = 141232.69 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 141232.69 ≤ Q = 141232.69 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 141232.69 ≤ Q = 142258.67 (slack: 1025.98)
  [DEBUG]   ✓ Scenario 9: θ = 141232.69 ≤ Q = 141232.69 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 141232.69 ≤ Q = 141232.69 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 141232.69 ≤ Q = 141232.69 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 141232.69 ≤ Q = 141232.69 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 141232.69 ≤ Q = 141232.69 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 141232.69 ≤ Q = 141232.69 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 141232.69 ≤ Q = 141232.69 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 141232.69 ≤ Q = 141232.69 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 141232.69 ≤ Q = 141232.69 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 141232.69 ≤ Q = 141232.69 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 141232.69 ≤ Q = 141232.69 (slack: -0.00)
  [DEBUG]   ✓ Scenario 20: θ = 141232.69 ≤ Q = 141232.69 (slack: 0.00)
  [DEBUG]   ✓ Scenario 21: θ = 141232.69 ≤ Q = 141232.69 (slack: 0.00)
  [DEBUG]   ✓ Scenario 22: θ = 141232.69 ≤ Q = 141232.69 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 23] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x10c8a275
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x10c8a275
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.153573e+13
Presolve removed 2598 rows and 1890 columns
Presolve time: 0.00s
Presolved: 495 rows, 499 columns, 1396 nonzeros
Found heuristic solution: objective 5655161.2539
Variable types: 339 continuous, 160 integer (160 binary)

Root relaxation: objective -1.296375e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -129637.45    0  123 5655161.25 -129637.45   102%     -    0s
H    0     0                    -97376.84668 -129637.45  33.1%     -    0s
H    0     0                    -97994.42565 -129637.45  32.3%     -    0s
     0     0 -103761.08    0   60 -97994.426 -103761.08  5.88%     -    0s
H    0     0                    -100912.8551 -103641.48  2.70%     -    0s
H    0     0                    -100936.9662 -103641.48  2.68%     -    0s
H    0     0                    -101787.8086 -103641.48  1.82%     -    0s
H    0     0                    -101811.9196 -103641.48  1.80%     -    0s
     0     0 -103071.82    0   62 -101811.92 -103071.82  1.24%     -    0s
H    0     0                    -102123.1836 -103068.82  0.93%     -    0s
     0     0 -102718.31    0   43 -102123.18 -102718.31  0.58%     -    0s
     0     0 -102575.01    0   47 -102123.18 -102575.01  0.44%     -    0s
     0     0 -102569.50    0   47 -102123.18 -102569.50  0.44%     -    0s
     0     0 -102383.73    0   34 -102123.18 -102383.73  0.26%     -    0s
     0     0 -102362.45    0   36 -102123.18 -102362.45  0.23%     -    0s
     0     0 -102353.13    0   33 -102123.18 -102353.13  0.23%     -    0s
     0     0 -102353.13    0   40 -102123.18 -102353.13  0.23%     -    0s
     0     0 -102353.13    0   32 -102123.18 -102353.13  0.23%     -    0s
H    0     0                    -102142.2394 -102353.13  0.21%     -    0s
H    0     0                    -102145.5526 -102316.23  0.17%     -    0s
     0     0 -102316.23    0   32 -102145.55 -102316.23  0.17%     -    0s
     0     0 -102313.77    0   31 -102145.55 -102313.77  0.16%     -    0s
     0     0 -102313.70    0   31 -102145.55 -102313.70  0.16%     -    0s
     0     0 -102277.33    0   32 -102145.55 -102277.33  0.13%     -    0s
     0     0 -102263.92    0   31 -102145.55 -102263.92  0.12%     -    0s
     0     0 -102263.72    0   31 -102145.55 -102263.72  0.12%     -    0s
     0     0 -102262.82    0   31 -102145.55 -102262.82  0.11%     -    0s
     0     0 -102260.59    0   32 -102145.55 -102260.59  0.11%     -    0s
     0     0 -102259.58    0   32 -102145.55 -102259.58  0.11%     -    0s
H    0     0                    -102153.9797 -102259.58  0.10%     -    0s
     0     0 -102259.56    0   32 -102153.98 -102259.56  0.10%     -    0s
     0     0 -102257.86    0   32 -102153.98 -102257.86  0.10%     -    0s
     0     0 -102257.86    0   33 -102153.98 -102257.86  0.10%     -    0s
     0     0 -102257.86    0   33 -102153.98 -102257.86  0.10%     -    0s
     0     0 -102244.33    0   31 -102153.98 -102244.33  0.09%     -    0s
     0     0 -102235.44    0   32 -102153.98 -102235.44  0.08%     -    0s
     0     0 -102235.35    0   32 -102153.98 -102235.35  0.08%     -    0s
     0     0 -102229.65    0   32 -102153.98 -102229.65  0.07%     -    0s
     0     0 -102221.51    0   32 -102153.98 -102221.51  0.07%     -    0s
     0     0 -102221.51    0   32 -102153.98 -102221.51  0.07%     -    0s
     0     0 -102220.48    0   32 -102153.98 -102220.48  0.07%     -    0s
     0     2 -102220.48    0   32 -102153.98 -102220.48  0.07%     -    0s

Cutting planes:
  Gomory: 14
  MIR: 39
  Flow cover: 12
  RLT: 8

Explored 16 nodes (1184 simplex iterations) in 0.11 seconds (0.08 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -102154 -102146 -102142 ... 5.65516e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.021539796621e+05, best bound -1.021582227041e+05, gap 0.0042%
  Subproblem solved in 0.12s
  Worst-case operational profit (Z_SP) = 139306.44
  Scenario: 9 demand increases, 51 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -102153.98
  [DEBUG]   S×d_nominal = 241460.42
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 241460.42 + -102153.98 = 139306.44
  [DEBUG]   Current θ from Master = 141232.69
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1926.25 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -3063.88
  Lower Bound (LB) = -1589.09
  Gap (UB-LB) = 451.4664, Absolute Gap = 451.4664, Relative Gap = 0.396851
  Not converged yet (gap = 451.47 > ε = 200)

  [DEBUG] Adding NEW scenario 23 to Master Problem...
  [DEBUG] New scenario pattern: 9 increases, 51 decreases
    [DEBUG] Scenario 23 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 23 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 23]
    [DEBUG]   - Total constraints in model: 368343
    [DEBUG]   - Total variables in model: 152020
  [DEBUG] Total scenarios in Master: 24
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 24
================================================================================
[Iteration 24] Solving Master Problem...
  Current scenarios in Master: 24
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 368343 rows, 152020 columns and 1043063 nonzeros
Model fingerprint: 0x8b173dbe
Variable types: 149761 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 169680 rows and 68880 columns
Presolve time: 3.32s
Presolved: 198663 rows, 83140 columns, 1224211 nonzeros
Variable types: 80881 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -373180.1084
Found heuristic solution: objective -219438.1934

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.53s

Barrier statistics:
 Dense cols : 1182
 AA' NZ     : 5.301e+06
 Factor NZ  : 1.472e+07 (roughly 230 MB of memory)
 Factor Ops : 5.255e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.76112518e+07  3.04063333e+08  9.97e+04 1.46e+01  7.17e+04     7s
   1  -1.37623293e+07  2.67637376e+08  7.17e+04 4.75e+01  5.11e+04     7s
   2  -5.53035546e+06  2.18994254e+08  2.73e+04 8.74e+00  2.02e+04     7s
   3  -1.03724226e+06  1.62444397e+08  2.46e+03 1.87e+00  2.17e+03     7s
   4  -6.18619555e+05  1.37093664e+08  5.44e+02 1.37e+00  7.48e+02     7s
   5  -5.55595379e+05  5.75314741e+07  3.29e+02 3.94e-01  3.49e+02     7s
   6  -4.61954411e+05  4.54350213e+07  1.19e+02 2.92e-01  1.91e+02     7s
   7  -4.17505188e+05  3.28777327e+07  6.88e+01 1.98e-01  1.25e+02     7s
   8  -3.21125966e+05  2.32216803e+07  2.47e+01 1.30e-01  7.52e+01     7s
   9  -1.99569769e+05  1.30392509e+07  3.50e+00 6.75e-02  3.76e+01     7s
  10  -1.67947833e+05  6.59971430e+06  2.52e+00 3.47e-02  1.91e+01     7s
  11  -1.46433002e+05  5.74931513e+06  1.91e+00 3.00e-02  1.66e+01     7s
  12  -1.29313151e+05  4.17287410e+06  1.27e+00 2.16e-02  1.20e+01     7s
  13  -1.18568331e+05  3.54229090e+06  1.03e+00 1.82e-02  1.02e+01     7s
  14  -9.10660106e+04  2.50953143e+06  3.78e-01 1.27e-02  7.22e+00     7s
  15  -6.37356681e+04  9.24704897e+05  1.49e-01 4.61e-03  2.74e+00     8s
  16  -4.51819968e+04  4.31024414e+05  7.39e-02 2.20e-03  1.32e+00     8s
  17  -2.94413130e+04  3.12145069e+05  4.60e-02 1.79e-03  9.45e-01     8s
  18  -2.10425896e+04  1.83156831e+05  3.59e-02 1.26e-03  5.65e-01     8s
  19  -1.30380606e+04  1.36317838e+05  2.80e-02 1.76e-03  4.13e-01     8s
  20  -7.98416878e+03  1.19699812e+05  2.33e-02 1.53e-03  3.53e-01     8s
  21  -3.65230271e+03  1.03126681e+05  1.96e-02 1.29e-03  2.95e-01     8s
  22  -1.13798434e+03  8.32224861e+04  1.74e-02 9.65e-04  2.33e-01     8s
  23   2.55972942e+03  7.25752904e+04  1.46e-02 7.95e-04  1.94e-01     8s
  24   7.72416514e+03  6.59104754e+04  1.07e-02 6.82e-04  1.61e-01     8s
  25   9.94950235e+03  5.70363372e+04  9.12e-03 5.40e-04  1.30e-01     8s
  26   1.18816239e+04  4.80625171e+04  7.86e-03 4.24e-04  1.00e-01     9s
  27   1.25467726e+04  4.41737264e+04  7.40e-03 3.56e-04  8.75e-02     9s
  28   1.56086105e+04  4.08506716e+04  5.70e-03 3.66e-04  6.98e-02     9s
  29   1.75790888e+04  3.75768428e+04  4.64e-03 2.43e-04  5.53e-02     9s
  30   1.88637047e+04  3.57011114e+04  3.97e-03 1.99e-04  4.66e-02     9s
  31   1.99838015e+04  3.47935874e+04  3.41e-03 1.80e-04  4.10e-02     9s
  32   2.02746572e+04  3.32181820e+04  3.26e-03 1.45e-04  3.58e-02     9s
  33   2.07513485e+04  3.28013125e+04  3.02e-03 1.35e-04  3.33e-02     9s
  34   2.10402195e+04  3.24162838e+04  2.87e-03 1.26e-04  3.15e-02     9s
  35   2.24389022e+04  3.19426676e+04  2.21e-03 1.13e-04  2.63e-02     9s
  36   2.31000704e+04  3.15673604e+04  1.90e-03 1.06e-04  2.34e-02     9s
  37   2.32461324e+04  3.14635737e+04  1.83e-03 1.03e-04  2.27e-02    10s
  38   2.33537615e+04  3.13589531e+04  1.77e-03 1.01e-04  2.22e-02    10s
  39   2.36181065e+04  3.10475501e+04  1.65e-03 9.30e-05  2.06e-02    10s
  40   2.44905467e+04  3.07369679e+04  1.26e-03 8.46e-05  1.73e-02    10s
  41   2.50973504e+04  2.96907369e+04  9.94e-04 5.67e-05  1.27e-02    10s
  42   2.57628852e+04  2.91229258e+04  7.04e-04 4.46e-05  9.30e-03    10s
  43   2.61376812e+04  2.85356307e+04  5.52e-04 2.79e-05  6.64e-03    10s
  44   2.67223009e+04  2.82418388e+04  3.10e-04 1.74e-05  4.20e-03    10s
  45   2.67975063e+04  2.80425081e+04  2.80e-04 1.25e-05  3.45e-03    10s
  46   2.70961625e+04  2.78878688e+04  1.66e-04 8.54e-06  2.19e-03    10s
  47   2.72603153e+04  2.76749984e+04  1.02e-04 3.29e-06  1.15e-03    11s
  48   2.73493118e+04  2.76208722e+04  6.86e-05 2.01e-06  7.51e-04    11s
  49   2.74474292e+04  2.75922979e+04  3.08e-05 1.25e-06  4.01e-04    11s
  50   2.74568303e+04  2.75840990e+04  2.74e-05 1.34e-06  3.52e-04    11s
  51   2.75022394e+04  2.75623226e+04  1.19e-05 8.85e-07  1.66e-04    11s
  52   2.75263941e+04  2.75517738e+04  3.56e-06 1.59e-06  7.02e-05    11s
  53   2.75326702e+04  2.75448290e+04  1.78e-06 1.19e-06  3.36e-05    11s
  54   2.75364170e+04  2.75434967e+04  6.83e-07 9.28e-07  1.96e-05    11s
  55   2.75383276e+04  2.75405351e+04  1.50e-07 3.24e-07  6.11e-06    11s
  56   2.75385559e+04  2.75396180e+04  9.66e-08 1.32e-07  2.94e-06    11s
  57   2.75389481e+04  2.75393058e+04  9.06e-09 6.66e-08  9.90e-07    11s
  58   2.75389798e+04  2.75389875e+04  2.80e-08 2.22e-07  2.13e-08    11s
  59   2.75389817e+04  2.75389817e+04  5.67e-10 1.08e-09  5.37e-11    12s

Barrier solved model in 59 iterations and 11.53 seconds (21.95 work units)
Optimal objective 2.75389817e+04


Root crossover log...

  178123 DPushes remaining with DInf 0.0000000e+00                12s
    4487 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                16s

    3060 PPushes remaining with PInf 1.0159009e-05                16s
       0 PPushes remaining with PInf 0.0000000e+00                16s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.9813512e-10     16s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   74227    2.7538982e+04   0.000000e+00   0.000000e+00     16s
   74227    2.7538982e+04   0.000000e+00   0.000000e+00     16s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 2.753898e+04, 74227 iterations, 12.07 seconds (26.65 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 27538.9817    0  135 -219438.19 27538.9817   113%     -   16s
H    0     0                    -218199.5844 27538.9817   113%     -   16s
H    0     0                    -189098.5187 27538.9817   115%     -   17s
H    0     0                    -131063.1381 27538.9817   121%     -   17s
H    0     0                    -98961.81895 27538.9817   128%     -   17s
H    0     0                    -98061.97883 27538.9817   128%     -   17s
H    0     0                    -97888.76875 27538.9817   128%     -   17s
H    0     0                    -97812.64158 27538.9817   128%     -   17s
H    0     0                    -71394.31792 27538.9817   139%     -   17s
H    0     0                    -20867.68377 27538.9817   232%     -   18s
H    0     0                    -4412.665675 27538.9817   724%     -   18s
H    0     0                    -2719.390758 27538.9817  1113%     -   19s
H    0     0                    -2686.097109 27538.9817  1125%     -   19s
H    0     0                    -1522.080106 27538.9817  1909%     -   19s
H    0     0                    -1378.478021 27538.9817  2098%     -   19s
     0     0 22138.4352    0  226 -1378.4780 22138.4352  1706%     -   60s
H    0     0                    -1358.468355 22137.7643  1730%     -   62s
H    0     0                    -1282.052975 22137.7643  1827%     -   62s
     0     0 21819.1299    0  244 -1282.0530 21819.1299  1802%     -   79s
     0     0 21778.8724    0  245 -1282.0530 21778.8724  1799%     -   88s
     0     0 21759.0513    0  255 -1282.0530 21759.0513  1797%     -   95s
     0     0 21755.8348    0  255 -1282.0530 21755.8348  1797%     -   95s
     0     0 21711.8409    0  250 -1282.0530 21711.8409  1794%     -  101s
     0     0 21710.5768    0  253 -1282.0530 21710.5768  1793%     -  103s
     0     0 21708.9376    0  253 -1282.0530 21708.9376  1793%     -  104s
     0     0 21708.8835    0  253 -1282.0530 21708.8835  1793%     -  104s
     0     0 19266.8152    0  229 -1282.0530 19266.8152  1603%     -  143s
     0     0 18557.9736    0  232 -1282.0530 18557.9736  1548%     -  165s
     0     0 18534.0768    0  230 -1282.0530 18534.0768  1546%     -  170s
     0     0 18529.6179    0  228 -1282.0530 18529.6179  1545%     -  173s
     0     0 18226.2473    0  241 -1282.0530 18226.2473  1522%     -  187s
     0     0 18220.5927    0  239 -1282.0530 18220.5927  1521%     -  190s
     0     0 18216.6505    0  238 -1282.0530 18216.6505  1521%     -  192s
     0     0 18216.3685    0  238 -1282.0530 18216.3685  1521%     -  195s
     0     0 14629.7727    0  294 -1282.0530 14629.7727  1241%     -  266s
     0     0 13798.1091    0  353 -1282.0530 13798.1091  1176%     -  315s
     0     0 13602.7502    0  393 -1282.0530 13602.7502  1161%     -  349s
     0     0 13558.0190    0  373 -1282.0530 13558.0190  1158%     -  363s
     0     0 13532.4062    0  364 -1282.0530 13532.4062  1156%     -  375s
     0     0 13517.1033    0  379 -1282.0530 13517.1033  1154%     -  385s
     0     0 13479.9664    0  378 -1282.0530 13479.9664  1151%     -  395s
     0     0 13465.7174    0  308 -1282.0530 13465.7174  1150%     -  402s
     0     0 13455.9428    0  385 -1282.0530 13455.9428  1150%     -  407s
     0     0 13373.8150    0  375 -1282.0530 13373.8150  1143%     -  428s
     0     0 13347.6712    0  384 -1282.0530 13347.6712  1141%     -  435s
     0     0 13324.0273    0  415 -1282.0530 13324.0273  1139%     -  444s
     0     0 13313.5861    0  430 -1282.0530 13313.5861  1138%     -  449s
     0     0 13300.8073    0  423 -1282.0530 13300.8073  1137%     -  453s
     0     0 13283.2496    0  411 -1282.0530 13283.2496  1136%     -  458s
     0     0 13282.4695    0  412 -1282.0530 13282.4695  1136%     -  460s
     0     0 11742.5518    0  452 -1282.0530 11742.5518  1016%     -  559s
     0     0 11469.7639    0  493 -1282.0530 11469.7639   995%     -  594s
     0     0 11376.7796    0  484 -1282.0530 11376.7796   987%     -  612s
     0     0 11329.6432    0  443 -1282.0530 11329.6432   984%     -  625s
     0     0 11285.4333    0  529 -1282.0530 11285.4333   980%     -  639s
     0     0 11264.0033    0  532 -1282.0530 11264.0033   979%     -  648s
     0     0 11250.6767    0  534 -1282.0530 11250.6767   978%     -  655s
     0     0 11246.9286    0  539 -1282.0530 11246.9286   977%     -  660s
     0     0 11244.0764    0  542 -1282.0530 11244.0764   977%     -  664s
     0     0 11239.2766    0  540 -1282.0530 11239.2766   977%     -  669s
     0     0 11232.3602    0  537 -1282.0530 11232.3602   976%     -  675s
     0     0 11231.0607    0  534 -1282.0530 11231.0607   976%     -  678s
     0     0 11000.6327    0  482 -1282.0530 11000.6327   958%     -  716s
     0     0 10886.8804    0  458 -1282.0530 10886.8804   949%     -  741s
     0     0 10855.1688    0  456 -1282.0530 10855.1688   947%     -  752s
     0     0 10835.4141    0  528 -1282.0530 10835.4141   945%     -  756s
     0     0 10813.3211    0  538 -1282.0530 10813.3211   943%     -  765s
     0     0 10800.2354    0  530 -1282.0530 10800.2354   942%     -  771s
     0     0 10791.4515    0  465 -1282.0530 10791.4515   942%     -  775s
     0     0 10785.8901    0  467 -1282.0530 10785.8901   941%     -  780s
     0     0 10778.1327    0  462 -1282.0530 10778.1327   941%     -  784s
     0     0 10776.0876    0  536 -1282.0530 10776.0876   941%     -  789s
     0     0 10655.1115    0  574 -1282.0530 10655.1115   931%     -  814s
H    0     0                    -1211.495143 10655.0579   979%     -  824s
     0     0 10607.9795    0  598 -1211.4951 10607.9795   976%     -  837s
     0     0 10591.0341    0  554 -1211.4951 10591.0341   974%     -  846s
     0     0 10578.5455    0  557 -1211.4951 10578.5455   973%     -  854s
     0     0 10573.4698    0  553 -1211.4951 10573.4698   973%     -  859s
     0     0 10567.6452    0  561 -1211.4951 10567.6452   972%     -  862s
     0     0 10563.7522    0  558 -1211.4951 10563.7522   972%     -  864s
     0     0 10560.5901    0  560 -1211.4951 10560.5901   972%     -  866s
     0     0 10559.7673    0  556 -1211.4951 10559.7673   972%     -  867s
     0     0 10506.7016    0  403 -1211.4951 10506.7016   967%     -  885s
H    0     0                    -1142.850353 10506.0575  1019%     -  886s
     0     0 10501.2632    0  398 -1142.8504 10501.2632  1019%     -  890s
     0     0 10495.0197    0  395 -1142.8504 10495.0197  1018%     -  894s
     0     0 10489.3126    0  404 -1142.8504 10489.3126  1018%     -  897s
     0     0 10488.0532    0  406 -1142.8504 10488.0532  1018%     -  901s
     0     0 10452.9375    0  397 -1142.8504 10452.9375  1015%     -  910s
     0     0 10428.2105    0  407 -1142.8504 10428.2105  1012%     -  942s
     0     0 10424.2033    0  422 -1142.8504 10424.2033  1012%     -  945s
     0     0 10423.0331    0  426 -1142.8504 10423.0331  1012%     -  947s
     0     0 10410.1304    0  402 -1142.8504 10410.1304  1011%     -  958s
     0     0 10397.6992    0  399 -1142.8504 10397.6992  1010%     -  964s
     0     0 10393.5477    0  411 -1142.8504 10393.5477  1009%     -  967s
     0     0 10392.7796    0  413 -1142.8504 10392.7796  1009%     -  969s
     0     0 10338.5983    0  475 -1142.8504 10338.5983  1005%     -  984s
     0     0 10323.0265    0  486 -1142.8504 10323.0265  1003%     -  998s
     0     0 10312.0774    0  489 -1142.8504 10312.0774  1002%     - 1004s
     0     0 10309.2244    0  493 -1142.8504 10309.2244  1002%     - 1007s
     0     0 10308.4997    0  502 -1142.8504 10308.4997  1002%     - 1009s
     0     0 10291.7398    0  491 -1142.8504 10291.7398  1001%     - 1017s
     0     0 10287.7660    0  493 -1142.8504 10287.7660  1000%     - 1022s
     0     0 10281.8154    0  493 -1142.8504 10281.8154  1000%     - 1025s
     0     0 10281.2457    0  500 -1142.8504 10281.2457  1000%     - 1027s
     0     0 10271.7751    0  492 -1142.8504 10271.7751   999%     - 1036s
     0     0 10266.7674    0  482 -1142.8504 10266.7674   998%     - 1051s
     0     0 10265.0473    0  488 -1142.8504 10265.0473   998%     - 1054s
     0     0 10262.1699    0  500 -1142.8504 10262.1699   998%     - 1060s
     0     0 10261.9413    0  494 -1142.8504 10261.9413   998%     - 1063s
     0     0 10259.7980    0  442 -1142.8504 10259.7980   998%     - 1068s
     0     0 10259.5867    0  442 -1142.8504 10259.5867   998%     - 1074s
     0     2 10259.0206    0  442 -1142.8504 10259.0206   998%     - 1482s
     1     4 10182.2056    1  344 -1142.8504 10259.0206   998%  8428 1492s
     3     8 10090.5523    2  508 -1142.8504 10182.1773   991% 10907 1535s
     7    16 9963.55367    3  493 -1142.8504 10090.0752   983% 15512 1573s
    15    32 9481.59044    4  498 -1142.8504 9963.47920   972% 17514 1608s
    31    48 8846.93614    5  491 -1142.8504 9481.37976   930% 24293 1704s
    47    79 8831.20660    6  417 -1142.8504 9481.37976   930% 26797 1756s
    78   151 8810.89239    7  350 -1142.8504 9481.37976   930% 21774 1902s
   150   242 8779.80532    9  341 -1142.8504 9481.37976   930% 15938 1954s
   241   276 7420.90523   10  296 -1142.8504 9481.37976   930% 13019 1994s
   280   303 7132.97593   10  301 -1142.8504 9481.37976   930% 12827 2030s
   315   356 8162.02275   11  560 -1142.8504 9481.37976   930% 13089 2067s
   374   394 6683.12302   11  269 -1142.8504 9481.37976   930% 12725 2100s
   424   413 4453.41594   11  246 -1142.8504 9481.37976   930% 12432 2136s
   472   449 5263.36076   11  512 -1142.8504 9481.37976   930% 12220 2176s
   536   504 2051.86615   16  159 -1142.8504 9481.37976   930% 12262 2205s
   616   557 1364.23751   20  135 -1142.8504 9481.37976   930% 11688 2233s
   695   595  850.64193   17  164 -1142.8504 9481.37976   930% 11129 2262s
   800   617  833.71156   18  155 -1142.8504 9481.37976   930% 10325 2291s
   881   657  238.47448   20  157 -1142.8504 9481.37976   930%  9993 2314s
   986   701   91.73511   23  117 -1142.8504 9481.37976   930%  9538 2343s
  1096   751 -529.09719   29   78 -1142.8504 9481.37976   930%  9069 2371s
  1223   775     cutoff   33      -1142.8504 9481.37976   930%  8606 2397s
  1335   780 4155.02744   27  447 -1142.8504 9481.37976   930%  8358 2433s
  1407   821 4091.29533   28  443 -1142.8504 9481.37976   930%  8254 2476s
  1462   902 3966.88444   29  438 -1142.8504 9481.37976   930%  8282 2509s
  1555  1046 3876.14629   30  439 -1142.8504 9481.37976   930%  8153 2535s
  1707  1196 3694.72180   31  428 -1142.8504 9481.37976   930%  7778 2565s
  1867  1329 3634.63817   32  460 -1142.8504 9481.37976   930%  7485 2592s
  2021  1467 3202.64960   34  413 -1142.8504 9481.37976   930%  7321 2618s
  2200  1541 1962.04374   36  305 -1142.8504 9481.37976   930%  7085 2647s
  2368  1577 1733.23991   39  259 -1142.8504 9481.37976   930%  6920 2684s
  2502  1667 1111.74702   41  341 -1142.8504 9481.37976   930%  6860 2725s
  2660  1754  652.58142   48  331 -1142.8504 9481.37976   930%  6740 2762s
  2823  1853  225.83482   54  383 -1142.8504 9481.37976   930%  6623 2801s
  2990  1929 -527.65340   62  190 -1142.8504 9481.37976   930%  6560 2864s
  3066  1929     cutoff   45      -1142.8504 9481.37976   930%  6498 2865s
  3142  1979 -1109.1319   70  174 -1142.8504 9481.37976   930%  6500 2910s
  3273  2042 7138.80234    8  328 -1142.8504 9428.61726   925%  6515 2953s
  3410  2061 4127.49393   11  200 -1142.8504 9428.61726   925%  6539 3067s
  3445  2080 3896.63080   12  176 -1142.8504 9428.61726   925%  6600 3172s
  3502  2113 3865.77321   13  155 -1142.8504 9428.61726   925%  6620 3216s
  3585  2143 3836.72800   14  149 -1142.8504 9428.61726   925%  6599 3264s
  3686  2158 3800.55353   15  149 -1142.8504 9368.98595   920%  6594 3311s
  3745  2184  617.95523   16  111 -1142.8504 9368.98595   920%  6684 3359s
  3798  2218  509.90366   17  111 -1142.8504 9368.98595   920%  6771 3415s
  3879  2249  502.29262   18  111 -1142.8504 9368.98595   920%  6830 3467s
  3938  2290  443.72910   19  110 -1142.8504 9368.98595   920%  6918 3514s
  3987  2320  -90.77363   20   75 -1142.8504 9368.98595   920%  6996 3600s

Cutting planes:
  Learned: 2
  Gomory: 11
  Implied bound: 465
  MIR: 4044
  Flow cover: 5358
  RLT: 55
  Relax-and-lift: 1163

Explored 4029 nodes (29265716 simplex iterations) in 3600.06 seconds (9112.83 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -1142.85 -1211.5 -1282.05 ... -71394.3

Time limit reached
Best objective -1.142850352783e+03, best bound 9.368985946571e+03, gap 919.7911%
  WARNING: Time limit reached. Using best solution found (gap: 919.79%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = -1142.85, θ = 142026.97
  Upper Bound (UB) = -1142.85

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 142026.97
  [DEBUG]   ✓ Scenario 0: θ = 142026.97 ≤ Q = 142026.97 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 142026.97 ≤ Q = 142026.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 142026.97 ≤ Q = 142026.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 142026.97 ≤ Q = 142026.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 142026.97 ≤ Q = 142026.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 142026.97 ≤ Q = 142026.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 142026.97 ≤ Q = 142026.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 142026.97 ≤ Q = 142026.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 142026.97 ≤ Q = 142026.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 142026.97 ≤ Q = 142026.97 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 142026.97 ≤ Q = 142026.97 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 142026.97 ≤ Q = 142026.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 142026.97 ≤ Q = 142026.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 142026.97 ≤ Q = 142026.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 142026.97 ≤ Q = 142026.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 142026.97 ≤ Q = 142026.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 142026.97 ≤ Q = 142026.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 142026.97 ≤ Q = 142026.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 142026.97 ≤ Q = 142026.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 142026.97 ≤ Q = 142026.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 20: θ = 142026.97 ≤ Q = 142026.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 21: θ = 142026.97 ≤ Q = 142026.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 22: θ = 142026.97 ≤ Q = 142026.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 23: θ = 142026.97 ≤ Q = 142026.97 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 24] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x46add296
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x46add296
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.147591e+13
Presolve removed 2598 rows and 1890 columns
Presolve time: 0.00s
Presolved: 495 rows, 499 columns, 1396 nonzeros
Found heuristic solution: objective 5688173.8536
Variable types: 339 continuous, 160 integer (160 binary)

Root relaxation: objective -1.287841e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -128784.08    0  123 5688173.85 -128784.08   102%     -    0s
H    0     0                    -96603.14902 -128784.08  33.3%     -    0s
H    0     0                    -97220.72799 -128784.08  32.5%     -    0s
     0     0 -102580.54    0   33 -97220.728 -102580.54  5.51%     -    0s
H    0     0                    -101490.7375 -102494.47  0.99%     -    0s
     0     0 -102021.70    0   29 -101490.74 -102021.70  0.52%     -    0s
H    0     0                    -101506.1690 -101984.96  0.47%     -    0s
H    0     0                    -101843.8039 -101984.96  0.14%     -    0s
H    0     0                    -101851.0867 -101955.07  0.10%     -    0s
     0     0 -101955.07    0   13 -101851.09 -101955.07  0.10%     -    0s
     0     0 -101942.80    0    9 -101851.09 -101942.80  0.09%     -    0s
     0     0 -101924.40    0    8 -101851.09 -101924.40  0.07%     -    0s
     0     0 -101875.71    0    2 -101851.09 -101875.71  0.02%     -    0s
     0     0 -101875.71    0    8 -101851.09 -101875.71  0.02%     -    0s
H    0     0                    -101862.1029 -101875.71  0.01%     -    0s
     0     0          -    0      -101862.10 -101868.74  0.01%     -    0s

Cutting planes:
  Gomory: 1
  MIR: 6
  RLT: 1
  Relax-and-lift: 1
  PSD: 1

Explored 1 nodes (496 simplex iterations) in 0.10 seconds (0.03 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -101862 -101851 -101844 ... 1.14759e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.018621029251e+05, best bound -1.018687446679e+05, gap 0.0065%
  Subproblem solved in 0.12s
  Worst-case operational profit (Z_SP) = 139598.31
  Scenario: 11 demand increases, 49 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -101862.10
  [DEBUG]   S×d_nominal = 241460.42
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 241460.42 + -101862.10 = 139598.31
  [DEBUG]   Current θ from Master = 142026.97
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2428.66 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -3571.51
  Lower Bound (LB) = -1589.09
  Gap (UB-LB) = 446.2388, Absolute Gap = 446.2388, Relative Gap = 0.390461
  Not converged yet (gap = 446.24 > ε = 200)

  [DEBUG] Adding NEW scenario 24 to Master Problem...
  [DEBUG] New scenario pattern: 11 increases, 49 decreases
    [DEBUG] Scenario 24 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 24 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 24]
    [DEBUG]   - Total constraints in model: 383633
    [DEBUG]   - Total variables in model: 158260
  [DEBUG] Total scenarios in Master: 25
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 25
================================================================================
[Iteration 25] Solving Master Problem...
  Current scenarios in Master: 25
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 383633 rows, 158260 columns and 1086294 nonzeros
Model fingerprint: 0xa3a03ca5
Variable types: 156001 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 176750 rows and 71750 columns
Presolve time: 3.61s
Presolved: 206883 rows, 86510 columns, 1274921 nonzeros
Variable types: 84251 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -373180.1084
Found heuristic solution: objective -219438.1934

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.64s

Barrier statistics:
 Dense cols : 1181
 AA' NZ     : 5.692e+06
 Factor NZ  : 1.582e+07 (roughly 250 MB of memory)
 Factor Ops : 5.817e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.78264750e+07  3.13602264e+08  1.01e+05 1.45e+01  7.21e+04     7s
   1  -1.39436643e+07  2.76240537e+08  7.23e+04 4.78e+01  5.14e+04     7s
   2  -5.70620494e+06  2.26278032e+08  2.81e+04 9.59e+00  2.07e+04     7s
   3  -1.07708404e+06  1.67515293e+08  2.63e+03 1.84e+00  2.28e+03     7s
   4  -6.28938578e+05  1.41502348e+08  5.79e+02 1.30e+00  7.68e+02     7s
   5  -5.59255618e+05  6.03877894e+07  3.40e+02 3.88e-01  3.57e+02     7s
   6  -4.77728235e+05  4.74958176e+07  1.52e+02 2.89e-01  2.10e+02     8s
   7  -4.37616296e+05  3.29761896e+07  8.71e+01 1.87e-01  1.31e+02     8s
   8  -3.45127418e+05  2.31912607e+07  3.33e+01 1.23e-01  7.65e+01     8s
   9  -2.73420789e+05  1.75112121e+07  1.64e+01 8.92e-02  5.31e+01     8s
  10  -1.92827806e+05  1.12190696e+07  6.74e+00 5.42e-02  3.20e+01     8s
  11  -1.56000777e+05  8.35667207e+06  4.49e+00 3.95e-02  2.35e+01     8s
  12  -1.38760505e+05  6.35184762e+06  3.25e+00 2.98e-02  1.77e+01     8s
  13  -1.24778371e+05  5.57308661e+06  2.08e+00 2.59e-02  1.54e+01     8s
  14  -1.13411479e+05  4.72969570e+06  1.37e+00 2.20e-02  1.30e+01     8s
  15  -9.38315475e+04  1.61119011e+06  7.21e-01 7.57e-03  4.56e+00     8s
  16  -6.45194125e+04  4.85135738e+05  3.11e-01 2.24e-03  1.47e+00     8s
  17  -3.85778841e+04  3.18688000e+05  1.56e-01 1.45e-03  9.51e-01     8s
  18  -2.82969419e+04  2.24525790e+05  1.20e-01 1.70e-03  6.73e-01     8s
  19  -1.90955036e+04  1.43679031e+05  9.59e-02 2.00e-03  4.33e-01     8s
  20  -1.19419924e+04  1.25328516e+05  7.98e-02 2.03e-03  3.65e-01     8s
  21  -8.65628142e+03  9.51462124e+04  7.17e-02 1.89e-03  2.76e-01     9s
  22  -2.48206370e+03  7.32378494e+04  5.81e-02 2.48e-03  2.02e-01     9s
  23   1.43588618e+03  6.17921779e+04  4.95e-02 2.44e-03  1.61e-01     9s
  24   4.51010544e+03  5.61907425e+04  4.28e-02 2.17e-03  1.38e-01     9s
  25   6.09983844e+03  5.04000454e+04  3.92e-02 2.32e-03  1.18e-01     9s
  26   1.18319529e+04  4.75848568e+04  2.67e-02 2.04e-03  9.52e-02     9s
  27   1.45010999e+04  4.46037510e+04  2.09e-02 1.77e-03  8.01e-02     9s
  28   1.57909635e+04  3.85625578e+04  1.85e-02 1.23e-03  6.06e-02     9s
  29   1.82735519e+04  3.63096654e+04  1.40e-02 9.93e-04  4.80e-02     9s
  30   1.93113383e+04  3.49474614e+04  1.22e-02 8.48e-04  4.16e-02     9s
  31   2.04049847e+04  3.43564330e+04  1.03e-02 7.86e-04  3.71e-02     9s
  32   2.07709452e+04  3.32904043e+04  9.70e-03 6.79e-04  3.33e-02     9s
  33   2.20023559e+04  3.24703093e+04  7.71e-03 5.98e-04  2.79e-02    10s
  34   2.26558593e+04  3.21854839e+04  6.67e-03 5.64e-04  2.54e-02    10s
  35   2.31839937e+04  3.16583188e+04  5.86e-03 5.13e-04  2.26e-02    10s
  36   2.34950625e+04  3.09461976e+04  5.37e-03 4.34e-04  1.98e-02    10s
  37   2.45652817e+04  3.04660118e+04  3.82e-03 3.75e-04  1.57e-02    10s
  38   2.46398706e+04  3.01286472e+04  3.71e-03 3.37e-04  1.46e-02    10s
  39   2.50886576e+04  2.97354258e+04  3.08e-03 2.90e-04  1.24e-02    10s
  40   2.54938724e+04  2.96251065e+04  2.52e-03 2.78e-04  1.10e-02    10s
  41   2.60352648e+04  2.89717634e+04  1.74e-03 1.96e-04  7.81e-03    10s
  42   2.62342060e+04  2.85707027e+04  1.47e-03 1.45e-04  6.22e-03    10s
  43   2.67107713e+04  2.83110937e+04  8.40e-04 1.12e-04  4.26e-03    11s
  44   2.71083474e+04  2.76931633e+04  3.39e-04 3.27e-05  1.56e-03    11s
  45   2.71656963e+04  2.75953405e+04  2.74e-04 2.08e-05  1.14e-03    11s
  46   2.72081957e+04  2.75689844e+04  2.28e-04 1.76e-05  9.60e-04    11s
  47   2.72383829e+04  2.75205722e+04  1.93e-04 1.19e-05  7.51e-04    11s
  48   2.73611119e+04  2.74761363e+04  5.85e-05 6.68e-06  3.06e-04    11s
  49   2.73745339e+04  2.74640701e+04  4.43e-05 5.26e-06  2.38e-04    11s
  50   2.73771647e+04  2.74540479e+04  4.15e-05 4.09e-06  2.05e-04    11s
  51   2.73900238e+04  2.74406696e+04  2.76e-05 2.63e-06  1.35e-04    11s
  52   2.74050665e+04  2.74257883e+04  1.17e-05 1.05e-06  5.51e-05    11s
  53   2.74184518e+04  2.74204766e+04  4.64e-07 5.13e-07  5.38e-06    11s
  54   2.74192116e+04  2.74192545e+04  1.28e-08 7.97e-09  1.14e-07    12s
  55   2.74192354e+04  2.74192363e+04  1.23e-08 2.76e-09  2.57e-09    12s
  56   2.74192360e+04  2.74192363e+04  7.72e-07 7.00e-08  9.53e-10    12s
  57   2.74192363e+04  2.74192363e+04  2.46e-08 5.11e-08  2.58e-11    12s

Barrier solved model in 57 iterations and 11.88 seconds (21.87 work units)
Optimal objective 2.74192363e+04


Root crossover log...

  185534 DPushes remaining with DInf 0.0000000e+00                12s
   11640 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                17s

    2686 PPushes remaining with PInf 8.3361194e-06                17s
       0 PPushes remaining with PInf 0.0000000e+00                17s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.2278722e-10     17s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   77938    2.7419236e+04   0.000000e+00   0.000000e+00     17s
   77938    2.7419236e+04   0.000000e+00   0.000000e+00     17s
Concurrent spin time: 0.63s

Solved with barrier

Root relaxation: objective 2.741924e+04, 77938 iterations, 12.92 seconds (27.08 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 27419.2363    0  136 -219438.19 27419.2363   112%     -   18s
H    0     0                    -105694.5296 27419.2363   126%     -   18s
H    0     0                    -104836.8647 27419.2363   126%     -   19s
H    0     0                    -103518.8917 27419.2363   126%     -   19s
H    0     0                    -103384.1713 27419.2363   127%     -   19s
H    0     0                    -101894.6766 27419.2363   127%     -   19s
H    0     0                    -101894.6222 27419.2363   127%     -   19s
H    0     0                    -101751.0653 27419.2363   127%     -   19s
H    0     0                    -101726.1814 27419.2363   127%     -   19s
H    0     0                    -71394.31792 27419.2363   138%     -   19s
H    0     0                    -10675.61037 27419.2363   357%     -   20s
H    0     0                    -9912.956555 27419.2363   377%     -   21s
H    0     0                    -2269.973028 27419.2363  1308%     -   21s
H    0     0                    -2237.542465 27419.2363  1325%     -   21s
H    0     0                    -1522.080106 27419.2363  1901%     -   21s
H    0     0                    -1378.478021 27419.2363  2089%     -   21s
     0     0 21450.8002    0  245 -1378.4780 21450.8002  1656%     -   61s
H    0     0                    -1282.052975 21431.6853  1772%     -   62s
     0     0 21079.0108    0  241 -1282.0530 21079.0108  1744%     -   80s
     0     0 21025.8897    0  237 -1282.0530 21025.8897  1740%     -   87s
     0     0 21025.1125    0  237 -1282.0530 21025.1125  1740%     -   88s
     0     0 21023.8525    0  242 -1282.0530 21023.8525  1740%     -   89s
     0     0 21023.8525    0  242 -1282.0530 21023.8525  1740%     -   89s
     0     0 18353.4332    0  258 -1282.0530 18353.4332  1532%     -  148s
     0     0 17713.6980    0  341 -1282.0530 17713.6980  1482%     -  178s
     0     0 17425.4921    0  342 -1282.0530 17425.4921  1459%     -  189s
     0     0 17385.9833    0  350 -1282.0530 17385.9833  1456%     -  196s
     0     0 17367.6630    0  352 -1282.0530 17367.6630  1455%     -  201s
     0     0 17328.4525    0  341 -1282.0530 17328.4525  1452%     -  205s
     0     0 17270.9946    0  332 -1282.0530 17270.9946  1447%     -  211s
     0     0 17259.9710    0  340 -1282.0530 17259.9710  1446%     -  213s
     0     0 17248.9230    0  347 -1282.0530 17248.9230  1445%     -  217s
     0     0 17247.8581    0  345 -1282.0530 17247.8581  1445%     -  218s
     0     0 14327.8669    0  269 -1282.0530 14327.8669  1218%     -  290s
     0     0 13372.0250    0  376 -1282.0530 13372.0250  1143%     -  340s
     0     0 13155.3640    0  414 -1282.0530 13155.3640  1126%     -  360s
     0     0 12918.4729    0  379 -1282.0530 12918.4729  1108%     -  381s
     0     0 12782.8090    0  384 -1282.0530 12782.8090  1097%     -  403s
     0     0 12727.3497    0  431 -1282.0530 12727.3497  1093%     -  416s
     0     0 12713.1566    0  399 -1282.0530 12713.1566  1092%     -  422s
     0     0 12683.2485    0  394 -1282.0530 12683.2485  1089%     -  433s
     0     0 12674.6700    0  390 -1282.0530 12674.6700  1089%     -  439s
     0     0 12665.8536    0  392 -1282.0530 12665.8536  1088%     -  445s
     0     0 12657.2933    0  425 -1282.0530 12657.2933  1087%     -  453s
     0     0 12655.6197    0  427 -1282.0530 12655.6197  1087%     -  456s
     0     0 11599.1527    0  381 -1282.0530 11599.1527  1005%     -  516s
     0     0 11405.2059    0  475 -1282.0530 11405.2059   990%     -  542s
     0     0 11311.9931    0  476 -1282.0530 11311.9931   982%     -  560s
     0     0 11264.2384    0  466 -1282.0530 11264.2384   979%     -  568s
     0     0 11172.8880    0  472 -1282.0530 11172.8880   971%     -  581s
     0     0 11151.0484    0  473 -1282.0530 11151.0484   970%     -  594s
     0     0 11137.4684    0  479 -1282.0530 11137.4684   969%     -  603s
     0     0 11117.6775    0  475 -1282.0530 11117.6775   967%     -  612s
     0     0 11113.6255    0  475 -1282.0530 11113.6255   967%     -  618s
     0     0 11080.3618    0  477 -1282.0530 11080.3618   964%     -  628s
     0     0 11064.5166    0  473 -1282.0530 11064.5166   963%     -  638s
     0     0 11055.0352    0  472 -1282.0530 11055.0352   962%     -  645s
     0     0 11029.2944    0  488 -1282.0530 11029.2944   960%     -  658s
     0     0 10993.2193    0  463 -1282.0530 10993.2193   957%     -  668s
     0     0 10988.0390    0  472 -1282.0530 10988.0390   957%     -  672s
     0     0 10985.7574    0  477 -1282.0530 10985.7574   957%     -  675s
     0     0 10981.9532    0  479 -1282.0530 10981.9532   957%     -  680s
     0     0 10980.3048    0  486 -1282.0530 10980.3048   956%     -  683s
     0     0 10769.4245    0  518 -1282.0530 10769.4245   940%     -  719s
     0     0 10710.4206    0  479 -1282.0530 10710.4206   935%     -  730s
     0     0 10672.2607    0  540 -1282.0530 10672.2607   932%     -  742s
     0     0 10656.3730    0  537 -1282.0530 10656.3730   931%     -  747s
     0     0 10649.1481    0  541 -1282.0530 10649.1481   931%     -  750s
     0     0 10629.9402    0  529 -1282.0530 10629.9402   929%     -  757s
     0     0 10627.7827    0  525 -1282.0530 10627.7827   929%     -  759s
     0     0 10553.7528    0  519 -1282.0530 10553.7528   923%     -  780s
     0     0 10531.3793    0  564 -1282.0530 10531.3793   921%     -  799s
     0     0 10524.7240    0  574 -1282.0530 10524.7240   921%     -  805s
     0     0 10522.8951    0  578 -1282.0530 10522.8951   921%     -  808s
     0     0 10490.2037    0  412 -1282.0530 10490.2037   918%     -  818s
     0     0 10476.1028    0  532 -1282.0530 10476.1028   917%     -  825s
     0     0 10470.9974    0  585 -1282.0530 10470.9974   917%     -  829s
     0     0 10465.9963    0  570 -1282.0530 10465.9963   916%     -  834s
     0     0 10461.6408    0  518 -1282.0530 10461.6408   916%     -  838s
     0     0 10456.4121    0  508 -1282.0530 10456.4121   916%     -  842s
     0     0 10454.8582    0  514 -1282.0530 10454.8582   915%     -  846s
     0     0 10446.2272    0  512 -1282.0530 10446.2272   915%     -  854s
H    0     0                    -1157.183090 10446.1336  1003%     -  865s
H    0     0                    -1143.315626 10446.1336  1014%     -  872s
     0     0 10442.6618    0  529 -1143.3156 10442.6618  1013%     -  880s
     0     0 10442.0465    0  526 -1143.3156 10442.0465  1013%     -  882s
     0     0 10439.1779    0  531 -1143.3156 10439.1779  1013%     -  890s
     0     0 10438.7145    0  540 -1143.3156 10438.7145  1013%     -  893s
     0     0 10437.8163    0  532 -1143.3156 10437.8163  1013%     -  897s
     0     0 10436.2777    0  532 -1143.3156 10436.2777  1013%     -  906s
     0     0 10436.2777    0  533 -1143.3156 10436.2777  1013%     -  910s
     0     0 10435.8804    0  533 -1143.3156 10435.8804  1013%     -  917s
     0     2 10435.8804    0  533 -1143.3156 10435.8804  1013%     - 1077s
     1     3 10253.2661    1  523 -1143.3156 10435.6076  1013% 14452 1095s
     2     4 10375.3164    1  522 -1143.3156 10375.3164  1007% 11804 1105s
     3     5 9626.53897    2  396 -1143.3156 10375.2655  1007% 12893 1120s
     4     8 10013.5749    2  352 -1143.3156 10375.1404  1007% 11700 1139s
     7    15 9939.83029    3  341 -1143.3156 10375.1404  1007% 11239 1168s
    14    30 7981.60298    4  280 -1143.3156 10010.9867   976% 14967 1214s
    29    45 8517.39280    5  315 -1143.3156 9757.45352   953% 22656 1320s
    44    76 8886.63891    5  468 -1143.3156 9757.45352   953% 21128 1539s
    75   118 8570.49073    6  345 -1143.3156 9606.75484   940% 19753 1603s
   117   172 8357.66485    7  409 -1143.3156 9585.97244   938% 15843 1656s
   171   221 8290.30849    8  391 -1143.3156 9585.97244   938% 14241 1708s
   220   270 8275.80337    9  388 -1143.3156 9585.97244   938% 13125 1761s
   275   342 8073.52743   10  394 -1143.3156 9585.97244   938% 13271 1801s
   349   405 6926.26816   11  395 -1143.3156 9585.97244   938% 12403 1841s
   440   445 8674.38677   12  492 -1143.3156 9585.97244   938% 11993 1875s
   529   477 3124.39926   12  217 -1143.3156 9585.97244   938% 11490 1908s
   619   508  878.31246   13  191 -1143.3156 9585.97244   938% 11038 1935s
   690   529  570.52699   14  190 -1143.3156 9585.97244   938% 10552 1964s
   719   554  202.39798   15  188 -1143.3156 9585.97244   938% 10571 1988s
   760   577     cutoff   16      -1143.3156 9585.97244   938% 10397 2009s
   804   615 infeasible   15      -1143.3156 9391.85220   921% 10144 2031s
   862   649 9005.81023    7  519 -1143.3156 9391.85220   921%  9891 2058s
   932   666 6681.64827    7  250 -1143.3156 9391.85220   921%  9518 2082s
  1003   685 6423.72205    8  247 -1143.3156 9391.85220   921%  9169 2106s
  1086   734 -498.12675   32  102 -1143.3156 9265.36710   910%  8818 2136s
  1184   751 8945.82886    8  523 -1143.3156 9265.36710   910%  8512 2169s
  1297   762 7339.30033    9  423 -1143.3156 9265.36710   910%  8191 2201s
  1408   791  371.09683   13  212 -1143.3156 9265.36710   910%  7993 2233s
  1487   811 5920.18857   13  414 -1143.3156 9265.36710   910%  8038 2271s
  1565   824 6015.86611   14  436 -1143.3156 9265.36710   910%  8140 2310s
  1626   855 5784.63933   15  409 -1143.3156 9265.36710   910%  8248 2348s
  1709   933 5710.49467   16  411 -1143.3156 9265.36710   910%  8290 2390s
  1837  1008 5531.24533   19  195 -1143.3156 9265.36710   910%  8212 2429s
  1982  1047 5054.88682   24  181 -1143.3156 9265.36710   910%  8124 2477s
  2100  1135 3678.74809   33  180 -1143.3156 9265.36710   910%  8100 2522s
  2242  1208 1175.07005   45  141 -1143.3156 9265.36710   910%  8136 2570s
  2386  1275     cutoff   57      -1143.3156 9265.36710   910%  8144 2619s
  2519  1346 6468.99520    8  267 -1143.3156 9265.36710   910%  8204 2667s
  2644  1461  -73.96692   10  409 -1143.3156 9265.36710   910%  8264 2718s
  2806  1579 -262.45102   11  408 -1143.3156 9265.36710   910%  8267 2776s
  2992  1699 infeasible   14      -1143.3156 9265.36710   910%  8195 2835s
  3212  1736 infeasible   22      -1143.3156 9265.36710   910%  8066 2896s
  3353  1798 2692.35354   14  433 -1143.3156 9265.36710   910%  8084 2966s
  3508  1864 2432.76220   16  398 -1143.3156 9265.36710   910%  8168 3031s
  3642  1884 infeasible   20      -1143.3156 9265.36710   910%  8245 3106s
  3678  1908  717.17634   20  224 -1143.3156 9265.36710   910%  8347 3163s
  3728  1936  563.93124   21  188 -1143.3156 9150.00980   900%  8416 3227s
  3766  1953  330.10426   22  183 -1143.3156 9150.00980   900%  8535 3288s
  3810  1979  244.62649   23  293 -1143.3156 9150.00980   900%  8640 3350s
  3846  2017   66.83284   24  184 -1143.3156 9150.00980   900%  8737 3414s
  3912  2065  -66.15414   25  179 -1143.3156 9150.00980   900%  8761 3473s
  3993  2123 -158.31893   26  174 -1143.3156 9150.00980   900%  8779 3535s
  4079  2183 infeasible   27      -1143.3156 9150.00980   900%  8831 3600s
H 4127  2183                    -1126.197644 8576.36053   862%  8882 3600s

Cutting planes:
  Learned: 2
  Gomory: 23
  Implied bound: 309
  MIR: 4314
  Flow cover: 4542
  RLT: 57
  Relax-and-lift: 918

Explored 4205 nodes (38163124 simplex iterations) in 3600.09 seconds (8802.22 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -1126.2 -1143.32 -1157.18 ... -71394.3

Time limit reached
Best objective -1.126197643611e+03, best bound 8.576360528960e+03, gap 861.5325%
  WARNING: Time limit reached. Using best solution found (gap: 861.53%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.11s
  Master Objective (UB) = -1126.20, θ = 140872.38
  Upper Bound (UB) = -1126.20

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 140872.38
  [DEBUG]   ✓ Scenario 0: θ = 140872.38 ≤ Q = 140872.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 140872.38 ≤ Q = 140872.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 140872.38 ≤ Q = 140872.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 140872.38 ≤ Q = 140872.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 140872.38 ≤ Q = 140872.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 140872.38 ≤ Q = 140872.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 140872.38 ≤ Q = 140872.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 140872.38 ≤ Q = 140872.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 140872.38 ≤ Q = 142903.33 (slack: 2030.95)
  [DEBUG]   ✓ Scenario 9: θ = 140872.38 ≤ Q = 140872.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 140872.38 ≤ Q = 140872.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 140872.38 ≤ Q = 140872.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 140872.38 ≤ Q = 140872.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 140872.38 ≤ Q = 140872.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 140872.38 ≤ Q = 140872.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 140872.38 ≤ Q = 140872.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 140872.38 ≤ Q = 140872.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 140872.38 ≤ Q = 140872.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 140872.38 ≤ Q = 140872.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 140872.38 ≤ Q = 140872.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 20: θ = 140872.38 ≤ Q = 140872.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 21: θ = 140872.38 ≤ Q = 140872.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 22: θ = 140872.38 ≤ Q = 140872.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 23: θ = 140872.38 ≤ Q = 140872.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 24: θ = 140872.38 ≤ Q = 140872.38 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 25] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x40e9a0be
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x40e9a0be
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.145874e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.00s
Presolved: 494 rows, 498 columns, 1393 nonzeros
Found heuristic solution: objective 5653630.2402
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.323852e+05, 254 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -132385.24    0  127 5653630.24 -132385.24   102%     -    0s
H    0     0                    -97551.91751 -132385.24  35.7%     -    0s
H    0     0                    -98648.87396 -132385.24  34.2%     -    0s
H    0     0                    -105364.5070 -114039.81  8.23%     -    0s
H    0     0                    -108710.6407 -114039.81  4.90%     -    0s
     0     0 -114039.81    0   63 -108710.64 -114039.81  4.90%     -    0s
H    0     0                    -111932.7701 -113970.54  1.82%     -    0s
     0     0 -113927.99    0   53 -111932.77 -113927.99  1.78%     -    0s
H    0     0                    -112958.7583 -113924.01  0.85%     -    0s
     0     0 -113924.01    0   53 -112958.76 -113924.01  0.85%     -    0s
     0     0 -113310.82    0   34 -112958.76 -113310.82  0.31%     -    0s
     0     0 -113295.01    0   33 -112958.76 -113295.01  0.30%     -    0s
H    0     0                    -112985.5051 -113293.84  0.27%     -    0s
     0     0 -113240.35    0   21 -112985.51 -113240.35  0.23%     -    0s
     0     0 -113240.34    0   20 -112985.51 -113240.34  0.23%     -    0s
     0     0 -113192.76    0   24 -112985.51 -113192.76  0.18%     -    0s
     0     0 -113192.76    0   24 -112985.51 -113192.76  0.18%     -    0s
     0     0 -113192.76    0   24 -112985.51 -113192.76  0.18%     -    0s
     0     0 -113053.06    0    8 -112985.51 -113053.06  0.06%     -    0s
     0     0 -113053.06    0   12 -112985.51 -113053.06  0.06%     -    0s
H    0     0                    -112990.6349 -113053.06  0.06%     -    0s
     0     0          -    0      -112990.63 -113000.65  0.01%     -    0s

Cutting planes:
  Gomory: 3
  Implied bound: 4
  MIR: 6
  Flow cover: 6
  Relax-and-lift: 2

Explored 1 nodes (619 simplex iterations) in 0.10 seconds (0.03 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -112991 -112986 -112959 ... 1.14587e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.129906349005e+05, best bound -1.130006461759e+05, gap 0.0089%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 128469.78
  Scenario: 23 demand increases, 37 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -112990.63
  [DEBUG]   S×d_nominal = 241460.42
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 241460.42 + -112990.63 = 128469.78
  [DEBUG]   Current θ from Master = 140872.38
  [DEBUG]   ⚠️  Z_SP ≤ θ by 12402.59 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -13528.79
  Lower Bound (LB) = -1589.09
  Gap (UB-LB) = 462.8915, Absolute Gap = 462.8915, Relative Gap = 0.411022
  Not converged yet (gap = 462.89 > ε = 200)

  [DEBUG] Adding NEW scenario 25 to Master Problem...
  [DEBUG] New scenario pattern: 23 increases, 37 decreases
    [DEBUG] Scenario 25 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 25 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 25]
    [DEBUG]   - Total constraints in model: 398923
    [DEBUG]   - Total variables in model: 164500
  [DEBUG] Total scenarios in Master: 26
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 26
================================================================================
[Iteration 26] Solving Master Problem...
  Current scenarios in Master: 26
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 398923 rows, 164500 columns and 1129525 nonzeros
Model fingerprint: 0x2d7fd387
Variable types: 162241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 183820 rows and 74620 columns
Presolve time: 4.73s
Presolved: 215103 rows, 89880 columns, 1325338 nonzeros
Variable types: 87621 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -373180.1084
Found heuristic solution: objective -219438.1934

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.96s

Barrier statistics:
 Dense cols : 1180
 AA' NZ     : 6.077e+06
 Factor NZ  : 1.684e+07 (roughly 260 MB of memory)
 Factor Ops : 6.269e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.80907664e+07  3.24857738e+08  1.02e+05 1.39e+01  7.28e+04     9s
   1  -1.41535129e+07  2.86510486e+08  7.36e+04 4.97e+01  5.20e+04     9s
   2  -5.88260272e+06  2.34844460e+08  2.91e+04 9.84e+00  2.12e+04     9s
   3  -1.12039545e+06  1.75715765e+08  2.72e+03 1.90e+00  2.33e+03     9s
   4  -6.49124286e+05  1.46873851e+08  6.15e+02 1.31e+00  7.88e+02     9s
   5  -5.73657210e+05  6.67468305e+07  3.53e+02 4.36e-01  3.75e+02     9s
   6  -5.03443598e+05  5.13263141e+07  1.96e+02 3.15e-01  2.39e+02     9s
   7  -4.54716493e+05  3.73210526e+07  1.08e+02 2.09e-01  1.51e+02     9s
   8  -3.68967596e+05  2.80703320e+07  4.48e+01 1.47e-01  9.27e+01    10s
   9  -2.45069826e+05  1.55777148e+07  1.12e+01 7.22e-02  4.41e+01    10s
  10  -2.03611563e+05  1.06200342e+07  7.41e+00 4.80e-02  2.94e+01    10s
  11  -1.55329962e+05  7.02395187e+06  4.67e+00 3.06e-02  1.91e+01    10s
  12  -1.37835831e+05  5.39878889e+06  3.32e+00 2.32e-02  1.46e+01    10s
  13  -1.22513466e+05  4.35815850e+06  2.35e+00 1.87e-02  1.17e+01    10s
  14  -1.13257212e+05  2.69086083e+06  1.68e+00 1.17e-02  7.29e+00    10s
  15  -7.84958979e+04  7.53617362e+05  6.27e-01 2.97e-03  2.14e+00    10s
  16  -5.03566063e+04  4.49520180e+05  2.86e-01 1.78e-03  1.28e+00    10s
  17  -3.30723913e+04  3.25003380e+05  1.70e-01 1.35e-03  9.17e-01    10s
  18  -2.39717425e+04  2.05254759e+05  1.29e-01 8.15e-04  5.87e-01    10s
  19  -1.64227934e+04  1.33362607e+05  1.06e-01 1.86e-03  3.84e-01    10s
  20  -1.37513152e+04  1.18270361e+05  9.87e-02 1.21e-03  3.38e-01    10s
  21  -9.29754131e+03  9.56292876e+04  8.60e-02 2.33e-03  2.69e-01    11s
  22  -6.52003156e+02  7.70583537e+04  6.07e-02 1.45e-03  1.99e-01    11s
  23  -3.34299620e+02  7.16999788e+04  5.99e-02 1.41e-03  1.85e-01    11s
  24   4.56413995e+03  6.11386006e+04  4.76e-02 2.10e-03  1.45e-01    11s
  25   6.55505817e+03  5.43934562e+04  4.27e-02 1.77e-03  1.23e-01    11s
  26   8.50979346e+03  4.80021156e+04  3.78e-02 1.53e-03  1.01e-01    11s
  27   1.20844806e+04  4.22993900e+04  2.94e-02 1.11e-03  7.74e-02    11s
  28   1.29356884e+04  3.98290571e+04  2.75e-02 9.61e-04  6.89e-02    11s
  29   1.66852137e+04  3.71343473e+04  1.94e-02 7.55e-04  5.24e-02    11s
  30   1.96593414e+04  3.52131407e+04  1.33e-02 6.14e-04  3.98e-02    11s
  31   2.01740547e+04  3.43541322e+04  1.24e-02 5.47e-04  3.63e-02    12s
  32   2.08683074e+04  3.27658226e+04  1.10e-02 4.35e-04  3.05e-02    12s
  33   2.14529874e+04  3.22650153e+04  9.95e-03 3.94e-04  2.77e-02    12s
  34   2.24233176e+04  3.11493599e+04  8.19e-03 3.24e-04  2.24e-02    12s
  35   2.28798413e+04  3.06774646e+04  7.40e-03 2.89e-04  2.00e-02    12s
  36   2.29913053e+04  3.05847848e+04  7.21e-03 2.81e-04  1.95e-02    12s
  37   2.36897562e+04  3.02812570e+04  6.00e-03 2.56e-04  1.69e-02    12s
  38   2.40543709e+04  2.93482612e+04  5.39e-03 2.32e-04  1.36e-02    12s
  39   2.46990855e+04  2.89248803e+04  4.35e-03 1.78e-04  1.08e-02    12s
  40   2.49853327e+04  2.85444832e+04  3.91e-03 1.09e-04  9.12e-03    12s
  41   2.56194013e+04  2.84328786e+04  2.88e-03 9.64e-05  7.21e-03    13s
  42   2.58340953e+04  2.80562257e+04  2.55e-03 1.23e-04  5.70e-03    13s
  43   2.60950739e+04  2.79971657e+04  2.16e-03 1.07e-04  4.88e-03    13s
  44   2.68222258e+04  2.79067919e+04  1.01e-03 5.75e-05  2.78e-03    13s
  45   2.70458488e+04  2.77851183e+04  6.85e-04 3.82e-05  1.89e-03    13s
  46   2.71762150e+04  2.77078510e+04  4.95e-04 2.73e-05  1.36e-03    13s
  47   2.73292433e+04  2.76559265e+04  2.85e-04 1.93e-05  8.37e-04    13s
  48   2.74313727e+04  2.76080341e+04  1.32e-04 1.17e-05  4.52e-04    13s
  49   2.74630281e+04  2.75715754e+04  8.98e-05 5.38e-06  2.78e-04    13s
  50   2.75049860e+04  2.75643668e+04  3.68e-05 4.16e-06  1.52e-04    13s
  51   2.75201215e+04  2.75460144e+04  1.78e-05 1.75e-06  6.63e-05    14s
  52   2.75352363e+04  2.75382720e+04  1.13e-06 2.26e-06  7.77e-06    14s
  53   2.75369579e+04  2.75369938e+04  8.91e-09 2.89e-08  9.19e-08    14s
  54   2.75369822e+04  2.75369822e+04  2.05e-10 9.42e-11  9.66e-12    14s

Barrier solved model in 54 iterations and 13.79 seconds (22.33 work units)
Optimal objective 2.75369822e+04


Root crossover log...

  192297 DPushes remaining with DInf 0.0000000e+00                14s
   56758 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                18s

    2705 PPushes remaining with PInf 3.4676595e-06                19s
       0 PPushes remaining with PInf 0.0000000e+00                19s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.8093293e-10     19s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   78600    2.7536982e+04   0.000000e+00   0.000000e+00     19s
   78600    2.7536982e+04   0.000000e+00   0.000000e+00     19s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 2.753698e+04, 78600 iterations, 12.88 seconds (26.56 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 27536.9822    0  136 -219438.19 27536.9822   113%     -   19s
H    0     0                    -110717.9166 27536.9822   125%     -   19s
H    0     0                    -106520.4626 27536.9822   126%     -   19s
H    0     0                    -105791.0343 27536.9822   126%     -   20s
H    0     0                    -71394.31792 27536.9822   139%     -   20s
H    0     0                    -27288.91815 27536.9822   201%     -   20s
H    0     0                    -1863.000913 27536.9822  1578%     -   20s
H    0     0                    -1281.332862 27536.9822  2249%     -   21s
     0     0 21991.3081    0  246 -1281.3329 21991.3081  1816%     -   73s
H    0     0                    -1143.315626 21991.2040  2023%     -   74s
     0     0 21681.2049    0  254 -1143.3156 21681.2049  1996%     -   94s
     0     0 21643.1320    0  258 -1143.3156 21643.1320  1993%     -  107s
     0     0 21634.9672    0  261 -1143.3156 21634.9672  1992%     -  112s
     0     0 21632.5309    0  258 -1143.3156 21632.5309  1992%     -  115s
     0     0 21632.3306    0  258 -1143.3156 21632.3306  1992%     -  116s
     0     0 19360.5464    0  240 -1143.3156 19360.5464  1793%     -  192s
     0     0 18941.0600    0  253 -1143.3156 18941.0600  1757%     -  244s
     0     0 18726.7730    0  313 -1143.3156 18726.7730  1738%     -  266s
     0     0 18671.7648    0  314 -1143.3156 18671.7648  1733%     -  277s
     0     0 18633.1242    0  304 -1143.3156 18633.1242  1730%     -  290s
     0     0 18604.0704    0  315 -1143.3156 18604.0704  1727%     -  300s
     0     0 18590.8749    0  314 -1143.3156 18590.8749  1726%     -  305s
     0     0 18585.2647    0  313 -1143.3156 18585.2647  1726%     -  308s
     0     0 18375.7914    0  304 -1143.3156 18375.7914  1707%     -  335s
     0     0 18333.9239    0  248 -1143.3156 18333.9239  1704%     -  348s
     0     0 18331.0361    0  261 -1143.3156 18331.0361  1703%     -  353s
     0     0 18330.1580    0  261 -1143.3156 18330.1580  1703%     -  358s
     0     0 15022.3438    0  331 -1143.3156 15022.3438  1414%     -  434s
     0     0 14211.3920    0  340 -1143.3156 14211.3920  1343%     -  491s
     0     0 13770.8453    0  366 -1143.3156 13770.8453  1304%     -  530s
     0     0 13614.3858    0  409 -1143.3156 13614.3858  1291%     -  551s
     0     0 13534.4393    0  408 -1143.3156 13534.4393  1284%     -  559s
     0     0 13468.8435    0  408 -1143.3156 13468.8435  1278%     -  569s
     0     0 13454.8533    0  414 -1143.3156 13454.8533  1277%     -  575s
     0     0 13438.8445    0  421 -1143.3156 13438.8445  1275%     -  581s
     0     0 13437.1764    0  417 -1143.3156 13437.1764  1275%     -  583s
     0     0 13425.9951    0  425 -1143.3156 13425.9951  1274%     -  586s
     0     0 13420.7904    0  422 -1143.3156 13420.7904  1274%     -  589s
     0     0 13419.4720    0  422 -1143.3156 13419.4720  1274%     -  592s
     0     0 12137.8391    0  389 -1143.3156 12137.8391  1162%     -  652s
     0     0 11922.0369    0  442 -1143.3156 11922.0369  1143%     -  681s
     0     0 11847.5181    0  442 -1143.3156 11847.5181  1136%     -  695s
     0     0 11814.0689    0  384 -1143.3156 11814.0689  1133%     -  703s
     0     0 11795.3197    0  338 -1143.3156 11795.3197  1132%     -  709s
     0     0 11783.8976    0  344 -1143.3156 11783.8976  1131%     -  713s
     0     0 11759.7324    0  340 -1143.3156 11759.7324  1129%     -  721s
     0     0 11755.8362    0  342 -1143.3156 11755.8362  1128%     -  723s
     0     0 11752.5826    0  340 -1143.3156 11752.5826  1128%     -  725s
     0     0 11752.2087    0  338 -1143.3156 11752.2087  1128%     -  726s
     0     0 11473.7876    0  454 -1143.3156 11473.7876  1104%     -  748s
     0     0 11294.9104    0  464 -1143.3156 11294.9104  1088%     -  774s
     0     0 11248.0635    0  482 -1143.3156 11248.0635  1084%     -  785s
     0     0 11219.6113    0  407 -1143.3156 11219.6113  1081%     -  794s
     0     0 11192.3597    0  473 -1143.3156 11192.3597  1079%     -  801s
     0     0 11180.0148    0  473 -1143.3156 11180.0148  1078%     -  808s
     0     0 11170.8439    0  476 -1143.3156 11170.8439  1077%     -  811s
     0     0 11167.4288    0  480 -1143.3156 11167.4288  1077%     -  815s
     0     0 11167.1119    0  472 -1143.3156 11167.1119  1077%     -  817s
     0     0 11012.8348    0  432 -1143.3156 11012.8348  1063%     -  841s
     0     0 10972.2481    0  414 -1143.3156 10972.2481  1060%     -  871s
     0     0 10948.2301    0  426 -1143.3156 10948.2301  1058%     -  881s
     0     0 10932.9896    0  433 -1143.3156 10932.9896  1056%     -  889s
     0     0 10925.1031    0  483 -1143.3156 10925.1031  1056%     -  894s
     0     0 10922.8975    0  430 -1143.3156 10922.8975  1055%     -  897s
     0     0 10796.5605    0  540 -1143.3156 10796.5605  1044%     -  928s
     0     0 10746.6905    0  541 -1143.3156 10746.6905  1040%     -  942s
     0     0 10721.8890    0  465 -1143.3156 10721.8890  1038%     -  949s
     0     0 10711.2277    0  474 -1143.3156 10711.2277  1037%     -  955s
     0     0 10702.7964    0  478 -1143.3156 10702.7964  1036%     -  965s
     0     0 10701.0608    0  602 -1143.3156 10701.0608  1036%     -  973s
     0     0 10609.3290    0  564 -1143.3156 10609.3290  1028%     -  991s
     0     0 10589.1703    0  367 -1143.3156 10589.1703  1026%     - 1018s
     0     0 10570.2650    0  535 -1143.3156 10570.2650  1025%     - 1025s
     0     0 10562.2207    0  528 -1143.3156 10562.2207  1024%     - 1030s
     0     0 10558.4964    0  503 -1143.3156 10558.4964  1023%     - 1035s
     0     0 10556.7509    0  539 -1143.3156 10556.7509  1023%     - 1040s
     0     0 10534.2727    0  505 -1143.3156 10534.2727  1021%     - 1049s
     0     0 10525.3325    0  514 -1143.3156 10525.3325  1021%     - 1057s
     0     0 10522.1191    0  516 -1143.3156 10522.1191  1020%     - 1062s
     0     0 10516.4656    0  511 -1143.3156 10516.4656  1020%     - 1068s
     0     0 10514.9511    0  529 -1143.3156 10514.9511  1020%     - 1072s
     0     0 10466.1563    0  492 -1143.3156 10466.1563  1015%     - 1087s
     0     0 10443.3863    0  498 -1143.3156 10443.3863  1013%     - 1102s
     0     0 10440.0053    0  363 -1143.3156 10440.0053  1013%     - 1106s
     0     0 10437.9417    0  497 -1143.3156 10437.9417  1013%     - 1111s
     0     0 10418.2068    0  504 -1143.3156 10418.2068  1011%     - 1123s
     0     0 10412.2965    0  507 -1143.3156 10412.2965  1011%     - 1133s
     0     0 10409.3498    0  508 -1143.3156 10409.3498  1010%     - 1136s
     0     0 10408.1070    0  497 -1143.3156 10408.1070  1010%     - 1139s
     0     0 10394.9394    0  492 -1143.3156 10394.9394  1009%     - 1150s
     0     0 10393.6427    0  511 -1143.3156 10393.6427  1009%     - 1165s
     0     0 10386.7549    0  430 -1143.3156 10386.7549  1008%     - 1176s
     0     0 10385.0368    0  439 -1143.3156 10385.0368  1008%     - 1180s
     0     0 10383.4227    0  428 -1143.3156 10383.4227  1008%     - 1186s
     0     0 10380.2448    0  365 -1143.3156 10380.2448  1008%     - 1192s
     0     0 10378.8940    0  377 -1143.3156 10378.8940  1008%     - 1194s
     0     0 10377.1000    0  379 -1143.3156 10377.1000  1008%     - 1199s
     0     0 10375.6593    0  432 -1143.3156 10375.6593  1008%     - 1204s
     0     0 10366.1349    0  481 -1143.3156 10366.1349  1007%     - 1214s
     0     0 10365.2740    0  481 -1143.3156 10365.2740  1007%     - 1222s
     0     2 10365.2740    0  481 -1143.3156 10365.2740  1007%     - 1338s
     1     3 10190.1160    1  464 -1143.3156 10365.2357  1007% 13738 1355s
     2     4 10304.6722    1  547 -1143.3156 10304.6722  1001% 12534 1367s
     3     5 9510.93191    2  489 -1143.3156 10304.3160  1001% 16606 1397s
     4     9 10051.1215    2  475 -1143.3156 10303.8859  1001% 15886 1419s
     8    16 8279.77652    3  277 -1143.3156 10044.0713   979% 14855 1455s
    15    30 8243.78490    4  271 -1143.3156 10044.0713   979% 15018 1499s
    29    44 8992.64373    4  498 -1143.3156 9497.15699   931% 21948 1632s
    43    71 5787.17757    5  282 -1143.3156 9497.15699   931% 28626 1900s
    70   103 5553.17278    6  277 -1143.3156 9497.15699   931% 27718 1976s
   102   135 5465.55715    7  262 -1143.3156 9497.15699   931% 24766 2045s
   134   167 5391.98102    8  270 -1143.3156 9497.15699   931% 21258 2115s
   166   222 5248.60731    9  269 -1143.3156 9497.15699   931% 18765 2191s
   221   275 3948.88031   12  258 -1143.3156 9497.15699   931% 16161 2263s
   274   337 1869.84051   14  325 -1143.3156 9497.15699   931% 15689 2339s
   344   400 1278.97331   16  314 -1143.3156 9497.15699   931% 15087 2397s
   430   427     cutoff   19      -1143.3156 9497.15699   931% 15164 2455s
   504   445 infeasible   18      -1143.3156 9497.15699   931% 14741 2505s
   537   455  486.60812   12  209 -1143.3156 9497.15699   931% 15144 2553s
   577   472  137.17970   13  195 -1143.3156 9497.15699   931% 15019 2600s
   618   486 -822.27318   15  187 -1143.3156 9497.15699   931% 15162 2649s
   668   507  886.64271   14  220 -1143.3156 9497.15699   931% 15008 2699s
   737   562  606.37142   17  156 -1143.3156 9497.15699   931% 14401 2739s
   810   605 -1097.1601   22  104 -1143.3156 9497.15699   931% 13744 2774s
   889   611 -747.22922   25  128 -1143.3156 9497.15699   931% 13115 2817s
   975   630     cutoff   24      -1143.3156 9497.15699   931% 12453 2861s
  1051   650 1585.29990   19  183 -1143.3156 9497.15699   931% 12102 2904s
  1122   670 1093.65827   22  157 -1143.3156 9497.15699   931% 11976 2947s
  1211   688  717.37770   24  168 -1143.3156 9497.15699   931% 11734 2998s
  1283   723  467.74282   28  159 -1143.3156 9497.15699   931% 11751 3049s
  1373   768   53.14819   31  161 -1143.3156 9497.15699   931% 11671 3104s
  1472   849 5664.56765   17  443 -1143.3156 9497.15699   931% 11588 3160s
  1608   912 5396.07597   18  484 -1143.3156 9497.15699   931% 11313 3219s
  1748  1006 4948.96947   21  453 -1143.3156 9497.15699   931% 11080 3274s
  1877  1128 4518.26765   27  406 -1143.3156 9497.15699   931% 10895 3336s
  2036  1273 2896.32617   32  371 -1143.3156 9497.15699   931% 10689 3406s
  2236  1359 2440.41148   38  255 -1143.3156 9497.15519   931% 10345 3473s
  2424  1467 1763.46257   43  299 -1143.3156 9497.15519   931% 10213 3534s
  2656  1547  264.33394   55  185 -1143.3156 9497.15519   931%  9849 3600s

Cutting planes:
  Learned: 1
  Gomory: 8
  Implied bound: 457
  MIR: 4838
  Flow cover: 5235
  RLT: 58
  Relax-and-lift: 1075

Explored 2850 nodes (28701246 simplex iterations) in 3600.06 seconds (8488.16 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -1143.32 -1281.33 -1863 ... -373180

Time limit reached
Best objective -1.143315626376e+03, best bound 9.497155185686e+03, gap 930.6678%
  WARNING: Time limit reached. Using best solution found (gap: 930.67%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = -1143.32, θ = 141626.99
  Upper Bound (UB) = -1143.32

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 141626.99
  [DEBUG]   ✓ Scenario 0: θ = 141626.99 ≤ Q = 141626.99 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 141626.99 ≤ Q = 141626.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 141626.99 ≤ Q = 141626.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 141626.99 ≤ Q = 141626.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 141626.99 ≤ Q = 141626.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 141626.99 ≤ Q = 141626.99 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 141626.99 ≤ Q = 141626.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 141626.99 ≤ Q = 141626.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 141626.99 ≤ Q = 141626.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 141626.99 ≤ Q = 141626.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 141626.99 ≤ Q = 141626.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 141626.99 ≤ Q = 141626.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 141626.99 ≤ Q = 141626.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 141626.99 ≤ Q = 141626.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 141626.99 ≤ Q = 141626.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 141626.99 ≤ Q = 141626.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 141626.99 ≤ Q = 141626.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 141626.99 ≤ Q = 141626.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 141626.99 ≤ Q = 141626.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 141626.99 ≤ Q = 141626.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 20: θ = 141626.99 ≤ Q = 141626.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 21: θ = 141626.99 ≤ Q = 141626.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 22: θ = 141626.99 ≤ Q = 141626.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 23: θ = 141626.99 ≤ Q = 141626.99 (slack: 0.00)
  [DEBUG]   ✓ Scenario 24: θ = 141626.99 ≤ Q = 141626.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 25: θ = 141626.99 ≤ Q = 141626.99 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 26] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x2e2c177a
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xd1d3e886
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.158060e+13
Presolve removed 2598 rows and 1890 columns
Presolve time: 0.00s
Presolved: 495 rows, 499 columns, 1396 nonzeros
Found heuristic solution: objective 5725843.9348
Variable types: 339 continuous, 160 integer (160 binary)

Root relaxation: objective -1.291903e+05, 243 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -129190.25    0  123 5725843.93 -129190.25   102%     -    0s
H    0     0                    -96982.55133 -129190.25  33.2%     -    0s
H    0     0                    -97600.13031 -129190.25  32.4%     -    0s
     0     0 -102834.07    0   61 -97600.130 -102834.07  5.36%     -    0s
H    0     0                    -100525.9233 -102731.18  2.19%     -    0s
H    0     0                    -101302.4009 -102316.67  1.00%     -    0s
     0     0 -102316.67    0   61 -101302.40 -102316.67  1.00%     -    0s
H    0     0                    -101614.0926 -102315.88  0.69%     -    0s
     0     0 -102315.04    0   59 -101614.09 -102315.04  0.69%     -    0s
     0     0 -102078.13    0   45 -101614.09 -102078.13  0.46%     -    0s
H    0     0                    -101635.1811 -102024.63  0.38%     -    0s
     0     0 -102024.63    0   42 -101635.18 -102024.63  0.38%     -    0s
     0     0 -102024.60    0   37 -101635.18 -102024.60  0.38%     -    0s
     0     0 -102020.54    0   41 -101635.18 -102020.54  0.38%     -    0s
H    0     0                    -101643.5627 -101892.13  0.24%     -    0s
     0     0 -101892.13    0   33 -101643.56 -101892.13  0.24%     -    0s
     0     0 -101871.77    0   34 -101643.56 -101871.77  0.22%     -    0s
     0     0 -101836.31    0   32 -101643.56 -101836.31  0.19%     -    0s
     0     0 -101836.31    0   36 -101643.56 -101836.31  0.19%     -    0s
     0     0 -101836.31    0   36 -101643.56 -101836.31  0.19%     -    0s
H    0     0                    -101650.1578 -101836.31  0.18%     -    0s
H    0     0                    -101682.4123 -101836.31  0.15%     -    0s
     0     0 -101836.31    0   32 -101682.41 -101836.31  0.15%     -    0s
     0     0 -101829.56    0   31 -101682.41 -101829.56  0.14%     -    0s
     0     0 -101825.45    0   31 -101682.41 -101825.45  0.14%     -    0s
     0     0 -101817.17    0   30 -101682.41 -101817.17  0.13%     -    0s
     0     0 -101807.06    0   30 -101682.41 -101807.06  0.12%     -    0s
     0     0 -101807.06    0   30 -101682.41 -101807.06  0.12%     -    0s
     0     0 -101807.06    0   30 -101682.41 -101807.06  0.12%     -    0s
H    0     0                    -101688.4935 -101807.06  0.12%     -    0s
     0     0 -101807.06    0   30 -101688.49 -101807.06  0.12%     -    0s
     0     2 -101807.06    0   30 -101688.49 -101807.06  0.12%     -    0s

Cutting planes:
  Gomory: 8
  MIR: 41
  Flow cover: 14
  RLT: 1

Explored 13 nodes (891 simplex iterations) in 0.19 seconds (0.06 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -101688 -101682 -101650 ... 5.72584e+06
No other solutions better than -101688

Optimal solution found (tolerance 1.00e-04)
Best objective -1.016884935035e+05, best bound -1.016884935035e+05, gap 0.0000%
  Subproblem solved in 0.20s
  Worst-case operational profit (Z_SP) = 139771.92
  Scenario: 10 demand increases, 50 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -101688.49
  [DEBUG]   S×d_nominal = 241460.42
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 241460.42 + -101688.49 = 139771.92
  [DEBUG]   Current θ from Master = 141626.99
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1855.06 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -2998.38
  Lower Bound (LB) = -1589.09
  Gap (UB-LB) = 445.7735, Absolute Gap = 445.7735, Relative Gap = 0.389895
  Not converged yet (gap = 445.77 > ε = 200)

  [DEBUG] Adding NEW scenario 26 to Master Problem...
  [DEBUG] New scenario pattern: 10 increases, 50 decreases
    [DEBUG] Scenario 26 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 26 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 26]
    [DEBUG]   - Total constraints in model: 414213
    [DEBUG]   - Total variables in model: 170740
  [DEBUG] Total scenarios in Master: 27
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 27
================================================================================
[Iteration 27] Solving Master Problem...
  Current scenarios in Master: 27
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 414213 rows, 170740 columns and 1172756 nonzeros
Model fingerprint: 0x21d20398
Variable types: 168481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 190890 rows and 77490 columns
Presolve time: 4.21s
Presolved: 223323 rows, 93250 columns, 1375937 nonzeros
Variable types: 90991 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -373180.1084
Found heuristic solution: objective -219438.1934

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 2.06s

Barrier statistics:
 Dense cols : 1179
 AA' NZ     : 6.492e+06
 Factor NZ  : 1.803e+07 (roughly 300 MB of memory)
 Factor Ops : 6.826e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.82906907e+07  3.34066051e+08  1.03e+05 1.37e+01  7.32e+04     8s
   1  -1.43148071e+07  2.94772462e+08  7.42e+04 5.00e+01  5.22e+04     8s
   2  -5.96661527e+06  2.41969846e+08  2.94e+04 1.05e+01  2.14e+04     9s
   3  -1.15293407e+06  1.80792665e+08  2.74e+03 1.38e+00  2.34e+03     9s
   4  -6.93537222e+05  1.53092890e+08  7.54e+02 1.00e+00  8.83e+02     9s
   5  -5.82883537e+05  7.44914068e+07  3.77e+02 3.43e-01  4.06e+02     9s
   6  -5.13207694e+05  5.40535744e+07  2.07e+02 2.35e-01  2.48e+02     9s
   7  -4.45554739e+05  4.40767479e+07  8.47e+01 1.82e-01  1.54e+02     9s
   8  -4.04277710e+05  3.12039846e+07  4.71e+01 1.23e-01  9.91e+01     9s
   9  -3.01919423e+05  2.19084179e+07  1.23e+01 8.15e-02  5.93e+01     9s
  10  -1.94286526e+05  1.44685097e+07  1.92e+00 5.29e-02  3.66e+01     9s
  11  -1.68902876e+05  8.40801891e+06  1.46e+00 3.05e-02  2.14e+01     9s
  12  -1.44204389e+05  6.81616421e+06  1.03e+00 2.46e-02  1.73e+01     9s
  13  -1.29920866e+05  5.33702590e+06  7.31e-01 1.91e-02  1.35e+01     9s
  14  -1.21739314e+05  4.13765125e+06  6.05e-01 1.52e-02  1.05e+01    10s
  15  -1.03170833e+05  3.82513492e+06  3.35e-01 1.40e-02  9.70e+00    10s
  16  -7.88899194e+04  1.61686735e+06  1.25e-01 5.78e-03  4.18e+00    10s
  17  -5.41991261e+04  4.51346053e+05  5.13e-02 1.60e-03  1.25e+00    10s
  18  -3.38560510e+04  2.59337828e+05  3.22e-02 2.68e-03  7.22e-01    10s
  19  -2.05775363e+04  1.98758877e+05  2.34e-02 2.27e-03  5.40e-01    10s
  20  -1.66031434e+04  1.63224791e+05  2.12e-02 1.82e-03  4.43e-01    10s
  21  -1.32194803e+04  1.39450538e+05  1.93e-02 1.52e-03  3.76e-01    10s
  22  -5.28051429e+03  1.06448665e+05  1.47e-02 1.10e-03  2.75e-01    10s
  23  -5.77547692e+02  8.57229767e+04  1.22e-02 8.18e-04  2.13e-01    10s
  24   2.72504557e+03  6.72588846e+04  1.05e-02 5.40e-04  1.59e-01    10s
  25   6.28548413e+03  5.82482889e+04  8.72e-03 4.23e-04  1.28e-01    11s
  26   6.96384130e+03  5.40751154e+04  8.35e-03 3.73e-04  1.16e-01    11s
  27   1.03102681e+04  4.71910045e+04  6.74e-03 2.83e-04  9.09e-02    11s
  28   1.17562154e+04  4.32753265e+04  6.10e-03 2.28e-04  7.76e-02    11s
  29   1.38384605e+04  3.99388952e+04  5.20e-03 1.93e-04  6.43e-02    11s
  30   1.69424310e+04  3.75019882e+04  3.89e-03 1.57e-04  5.06e-02    11s
  31   1.90555779e+04  3.51670681e+04  3.01e-03 1.24e-04  3.97e-02    11s
  32   1.95157536e+04  3.44456833e+04  2.83e-03 1.14e-04  3.68e-02    11s
  33   1.99366986e+04  3.30852541e+04  2.66e-03 9.23e-05  3.24e-02    11s
  34   2.08743855e+04  3.21036048e+04  2.30e-03 7.65e-05  2.77e-02    12s
  35   2.18472001e+04  3.13970280e+04  1.94e-03 6.62e-05  2.35e-02    12s
  36   2.20864007e+04  3.12704387e+04  1.86e-03 6.43e-05  2.26e-02    12s
  37   2.22237583e+04  3.11068925e+04  1.81e-03 6.17e-05  2.19e-02    12s
  38   2.26030093e+04  3.08057156e+04  1.67e-03 5.67e-05  2.02e-02    12s
  39   2.30023588e+04  3.02465571e+04  1.52e-03 4.80e-05  1.78e-02    12s
  40   2.33477482e+04  3.00644030e+04  1.40e-03 4.52e-05  1.65e-02    12s
  41   2.37350456e+04  2.93734324e+04  1.26e-03 4.70e-05  1.39e-02    12s
  42   2.41805912e+04  2.93000830e+04  1.10e-03 5.08e-05  1.26e-02    13s
  43   2.48710696e+04  2.87603978e+04  8.59e-04 3.59e-05  9.58e-03    13s
  44   2.54791409e+04  2.84303782e+04  6.44e-04 2.69e-05  7.27e-03    13s
  45   2.59592114e+04  2.81042119e+04  4.78e-04 1.81e-05  5.28e-03    13s
  46   2.66464929e+04  2.77683443e+04  2.44e-04 9.92e-06  2.76e-03    13s
  47   2.69257810e+04  2.76208959e+04  1.55e-04 6.24e-06  1.71e-03    13s
  48   2.69384954e+04  2.75981891e+04  1.51e-04 5.55e-06  1.63e-03    13s
  49   2.71244463e+04  2.75207340e+04  9.07e-05 6.30e-06  9.76e-04    13s
  50   2.71444612e+04  2.74928956e+04  8.43e-05 4.42e-06  8.58e-04    13s
  51   2.72454851e+04  2.74729874e+04  5.33e-05 3.11e-06  5.60e-04    14s
  52   2.72897941e+04  2.74479167e+04  3.93e-05 1.60e-06  3.90e-04    14s
  53   2.73487823e+04  2.74408208e+04  2.07e-05 1.23e-06  2.27e-04    14s
  54   2.73967716e+04  2.74286618e+04  6.01e-06 4.83e-07  7.86e-05    14s
  55   2.74169197e+04  2.74221974e+04  4.82e-07 1.37e-07  1.30e-05    14s
  56   2.74191236e+04  2.74197129e+04  1.72e-08 2.15e-08  1.45e-06    14s
  57   2.74192362e+04  2.74192370e+04  1.66e-10 3.43e-09  2.12e-09    14s
  58   2.74192363e+04  2.74192363e+04  7.06e-10 3.95e-11  4.23e-12    14s

Barrier solved model in 58 iterations and 14.23 seconds (25.18 work units)
Optimal objective 2.74192363e+04


Root crossover log...

  200187 DPushes remaining with DInf 0.0000000e+00                14s
  101877 DPushes remaining with DInf 0.0000000e+00                15s
   26407 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                24s

    2639 PPushes remaining with PInf 2.1558907e-06                24s
       0 PPushes remaining with PInf 0.0000000e+00                24s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.7304091e-10     24s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   82934    2.7419236e+04   0.000000e+00   0.000000e+00     24s
   82934    2.7419236e+04   0.000000e+00   0.000000e+00     24s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 2.741924e+04, 82934 iterations, 19.06 seconds (30.71 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 27419.2363    0  136 -219438.19 27419.2363   112%     -   25s
H    0     0                    -98017.36807 27419.2363   128%     -   25s
H    0     0                    -71394.31792 27419.2363   138%     -   26s
H    0     0                    -4228.513922 27419.2363   748%     -   26s
H    0     0                    -3177.546343 27419.2363   963%     -   27s
H    0     0                    -2271.500361 27419.2363  1307%     -   28s
H    0     0                    -1522.080106 27419.2363  1901%     -   28s
H    0     0                    -1378.478021 27419.2363  2089%     -   28s
     0     0 22003.7553    0  253 -1378.4780 22003.7553  1696%     -   91s
H    0     0                    -1375.584236 22003.5917  1700%     -   93s
     0     0 21738.1871    0  244 -1375.5842 21738.1871  1680%     -  117s
     0     0 21724.0586    0  242 -1375.5842 21724.0586  1679%     -  122s
     0     0 21717.5393    0  241 -1375.5842 21717.5393  1679%     -  123s
     0     0 21716.0517    0  247 -1375.5842 21716.0517  1679%     -  124s
     0     0 21715.8635    0  247 -1375.5842 21715.8635  1679%     -  125s
     0     0 18893.4054    0  295 -1375.5842 18893.4054  1473%     -  203s
     0     0 18564.5259    0  316 -1375.5842 18564.5259  1450%     -  230s
     0     0 18384.8246    0  310 -1375.5842 18384.8246  1437%     -  250s
     0     0 18313.2528    0  312 -1375.5842 18313.2528  1431%     -  266s
     0     0 18306.5159    0  320 -1375.5842 18306.5159  1431%     -  274s
     0     0 18302.0697    0  317 -1375.5842 18302.0697  1430%     -  277s
     0     0 18266.4381    0  310 -1375.5842 18266.4381  1428%     -  284s
     0     0 18239.9116    0  310 -1375.5842 18239.9116  1426%     -  294s
     0     0 18125.9840    0  320 -1375.5842 18125.9840  1418%     -  312s
     0     0 18085.1773    0  326 -1375.5842 18085.1773  1415%     -  326s
     0     0 18039.9697    0  316 -1375.5842 18039.9697  1411%     -  334s
     0     0 18033.5519    0  317 -1375.5842 18033.5519  1411%     -  340s
     0     0 17867.1381    0  342 -1375.5842 17867.1381  1399%     -  363s
     0     0 17853.3987    0  336 -1375.5842 17853.3987  1398%     -  371s
     0     0 17848.8532    0  341 -1375.5842 17848.8532  1398%     -  374s
     0     0 17846.8472    0  334 -1375.5842 17846.8472  1397%     -  375s
     0     0 17841.2361    0  345 -1375.5842 17841.2361  1397%     -  380s
     0     0 17836.1475    0  349 -1375.5842 17836.1475  1397%     -  382s
     0     0 17835.6453    0  351 -1375.5842 17835.6453  1397%     -  383s
     0     0 15143.0222    0  269 -1375.5842 15143.0222  1201%     -  489s
H    0     0                    -1369.171271 15142.5762  1206%     -  490s
     0     0 14449.3212    0  373 -1369.1713 14449.3212  1155%     -  549s
     0     0 14152.2181    0  278 -1369.1713 14152.2181  1134%     -  589s
     0     0 13946.3736    0  389 -1369.1713 13946.3736  1119%     -  623s
     0     0 13868.7326    0  319 -1369.1713 13868.7326  1113%     -  642s
     0     0 13809.2600    0  423 -1369.1713 13809.2600  1109%     -  660s
     0     0 13787.3460    0  408 -1369.1713 13787.3460  1107%     -  671s
     0     0 13784.7869    0  417 -1369.1713 13784.7869  1107%     -  675s
     0     0 13662.2839    0  412 -1369.1713 13662.2839  1098%     -  694s
     0     0 13581.5390    0  354 -1369.1713 13581.5390  1092%     -  710s
     0     0 13564.6746    0  421 -1369.1713 13564.6746  1091%     -  720s
     0     0 13553.8475    0  420 -1369.1713 13553.8475  1090%     -  727s
     0     0 13534.7667    0  424 -1369.1713 13534.7667  1089%     -  733s
     0     0 13533.3431    0  425 -1369.1713 13533.3431  1088%     -  736s
     0     0 12299.5596    0  504 -1369.1713 12299.5596   998%     -  839s
     0     0 12033.7748    0  470 -1369.1713 12033.7748   979%     -  887s
     0     0 11915.4305    0  468 -1369.1713 11915.4305   970%     -  910s
     0     0 11847.7594    0  477 -1369.1713 11847.7594   965%     -  934s
     0     0 11825.0023    0  479 -1369.1713 11825.0023   964%     -  946s
     0     0 11790.8066    0  473 -1369.1713 11790.8066   961%     -  963s
     0     0 11784.8612    0  478 -1369.1713 11784.8612   961%     -  973s
     0     0 11781.1740    0  477 -1369.1713 11781.1740   960%     -  977s
     0     0 11777.6541    0  471 -1369.1713 11777.6541   960%     -  983s
     0     0 11763.1334    0  476 -1369.1713 11763.1334   959%     -  995s
     0     0 11742.4870    0  474 -1369.1713 11742.4870   958%     - 1012s
     0     0 11719.4876    0  471 -1369.1713 11719.4876   956%     - 1030s
     0     0 11711.0358    0  476 -1369.1713 11711.0358   955%     - 1039s
     0     0 11710.1221    0  471 -1369.1713 11710.1221   955%     - 1042s
     0     0 11430.7058    0  510 -1369.1713 11430.7058   935%     - 1101s
     0     0 11399.5709    0  525 -1369.1713 11399.5709   933%     - 1121s
     0     0 11376.0061    0  520 -1369.1713 11376.0061   931%     - 1136s
     0     0 11215.2801    0  501 -1369.1713 11215.2801   919%     - 1169s
     0     0 11184.0946    0  511 -1369.1713 11184.0946   917%     - 1194s
     0     0 11178.0622    0  476 -1369.1713 11178.0622   916%     - 1204s
     0     0 11175.4235    0  513 -1369.1713 11175.4235   916%     - 1213s
     0     0 11172.2714    0  517 -1369.1713 11172.2714   916%     - 1222s
     0     0 11169.4785    0  523 -1369.1713 11169.4785   916%     - 1228s
     0     0 11165.5312    0  514 -1369.1713 11165.5312   915%     - 1230s
     0     0 11164.4665    0  515 -1369.1713 11164.4665   915%     - 1233s
     0     0 10969.6392    0  534 -1369.1713 10969.6392   901%     - 1270s
H    0     0                    -1239.275398 10969.2337   985%     - 1284s
     0     0 10861.5416    0  610 -1239.2754 10861.5416   976%     - 1315s
     0     0 10797.8289    0  614 -1239.2754 10797.8289   971%     - 1329s
     0     0 10780.8509    0  630 -1239.2754 10780.8509   970%     - 1338s
     0     0 10770.2576    0  577 -1239.2754 10770.2576   969%     - 1344s
     0     0 10755.3707    0  625 -1239.2754 10755.3707   968%     - 1351s
     0     0 10751.1942    0  625 -1239.2754 10751.1942   968%     - 1355s
     0     0 10743.9364    0  620 -1239.2754 10743.9364   967%     - 1363s
     0     0 10739.1489    0  626 -1239.2754 10739.1489   967%     - 1369s
     0     0 10735.0990    0  622 -1239.2754 10735.0990   966%     - 1374s
     0     0 10733.9476    0  581 -1239.2754 10733.9476   966%     - 1377s
     0     0 10662.7748    0  570 -1239.2754 10662.7748   960%     - 1407s
     0     0 10625.4695    0  543 -1239.2754 10625.4695   957%     - 1431s
     0     0 10614.1632    0  440 -1239.2754 10614.1632   956%     - 1440s
     0     0 10611.8172    0  475 -1239.2754 10611.8172   956%     - 1446s
     0     0 10606.4193    0  467 -1239.2754 10606.4193   956%     - 1453s
     0     0 10602.1071    0  533 -1239.2754 10602.1071   956%     - 1460s
     0     0 10600.6211    0  540 -1239.2754 10600.6211   955%     - 1465s
     0     0 10576.0948    0  425 -1239.2754 10576.0948   953%     - 1484s
H    0     0                    -1231.154035 10573.6884   959%     - 1510s
     0     0 10560.4942    0  485 -1231.1540 10560.4942   958%     - 1525s
     0     0 10556.0016    0  438 -1231.1540 10556.0016   957%     - 1530s
     0     0 10550.9359    0  485 -1231.1540 10550.9359   957%     - 1536s
     0     0 10550.0186    0  449 -1231.1540 10550.0186   957%     - 1539s
     0     0 10457.4790    0  490 -1231.1540 10457.4790   949%     - 1564s
H    0     0                    -1219.731006 10456.7963   957%     - 1565s
     0     0 10446.0069    0  479 -1219.7310 10446.0069   956%     - 1575s
     0     0 10441.4134    0  489 -1219.7310 10441.4134   956%     - 1581s
     0     0 10440.7168    0  495 -1219.7310 10440.7168   956%     - 1585s
     0     0 10409.2623    0  438 -1219.7310 10409.2623   953%     - 1601s
H    0     0                    -1157.183090 10408.8685  1000%     - 1629s
     0     0 10401.0142    0  450 -1157.1831 10401.0142   999%     - 1646s
     0     0 10396.5892    0  446 -1157.1831 10396.5892   998%     - 1653s
     0     0 10393.7870    0  444 -1157.1831 10393.7870   998%     - 1660s
     0     0 10392.4456    0  440 -1157.1831 10392.4456   998%     - 1663s
     0     0 10385.6234    0  434 -1157.1831 10385.6234   997%     - 1674s
     0     0 10382.9946    0  436 -1157.1831 10382.9946   997%     - 1679s
     0     0 10381.1439    0  437 -1157.1831 10381.1439   997%     - 1683s
     0     0 10374.2520    0  501 -1157.1831 10374.2520   997%     - 1698s
     0     0 10371.9378    0  362 -1157.1831 10371.9378   996%     - 1703s
     0     0 10364.4942    0  351 -1157.1831 10364.4942   996%     - 1713s
     0     0 10363.0409    0  357 -1157.1831 10363.0409   996%     - 1718s
     0     0 10360.4541    0  497 -1157.1831 10360.4541   995%     - 1729s
     0     0 10359.4379    0  495 -1157.1831 10359.4379   995%     - 1734s
     0     0 10357.1270    0  493 -1157.1831 10357.1270   995%     - 1742s
     0     0 10357.1236    0  493 -1157.1831 10357.1236   995%     - 1752s
     0     2 10357.1236    0  493 -1157.1831 10357.1236   995%     - 1921s
     1     3 10049.6321    1  505 -1157.1831 10357.1199   995% 24725 1949s
     2     4 10309.5847    1  498 -1157.1831 10309.5847   991% 18042 1964s
     3     5 9729.37294    2  485 -1157.1831 10309.5566   991% 18777 1989s
     4     9 10006.5018    2  542 -1157.1831 10309.5361   991% 17836 2022s
     8    17 9886.30840    3  384 -1157.1831 10006.4393   965% 15516 2102s
    16    31 9599.75382    4  340 -1157.1831 10006.4393   965% 18493 2155s
    30    45 8553.02436    4  496 -1157.1831 9885.91881   954% 28372 2295s
    44    72 7325.91022    5  294 -1157.1831 9599.69686   930% 30745 2496s
    71   142 6779.95928    6  288 -1157.1831 9599.69686   930% 28242 2684s
   141   174 6653.89482    8  281 -1157.1831 9599.69686   930% 20207 2734s
   173   210 6511.65095    9  257 -1157.1831 9599.69686   930% 18742 2786s
   224   246 6120.18051   12  287 -1157.1831 9599.69686   930% 16625 2848s
   293   308 7368.56013   14  332 -1157.1831 9599.69686   930% 15830 2902s
   361   360 6594.58381    9  270 -1157.1831 9599.69686   930% 15144 2953s
   450   396 3823.86874   14  227 -1157.1831 9599.69686   930% 14824 2997s
   520   443 6623.11723    8  285 -1157.1831 9599.69686   930% 14366 3038s
   614   491 1562.22148   11  228 -1157.1831 9599.69686   930% 13643 3078s
   697   508    6.14079   12  177 -1157.1831 9599.69686   930% 12808 3114s
*  727   508              31    -1147.956697 9599.69686   936% 12759 3114s
   734   567 -883.63680   13  171 -1147.9567 9599.69686   936% 12807 3148s
   843   638 infeasible   14      -1147.9567 9599.69686   936% 12224 3186s
   955   713 3526.19848   24  338 -1147.9567 9599.69686   936% 11590 3216s
  1074   760 3505.73148   25  338 -1147.9567 9599.69686   936% 10871 3249s
  1187   822 3186.76044   29  349 -1147.9567 9599.69686   936% 10395 3287s
* 1310   822              60    -1120.984459 9599.69686   956%  9896 3287s
  1316   891 2912.35876   32  356 -1120.9845 9599.69686   956%  9879 3321s
  1441  1018 2462.54866   35  375 -1120.9845 9599.69686   956%  9520 3353s
  1624  1166 2191.69052   41  327 -1120.9845 9599.69686   956%  8903 3382s
  1828  1298 1626.53682   47  265 -1120.9845 9599.69686   956%  8350 3417s
  2036  1388  953.26790   55  216 -1120.9845 9599.69686   956%  7885 3454s
  2248  1479  357.66121   66  240 -1120.9845 9599.69686   956%  7496 3489s
  2429  1581 -232.04007   76  182 -1120.9845 9599.69686   956%  7271 3526s
  2621  1702 infeasible   86      -1120.9845 9599.69686   956%  7069 3567s
  2824  1802   72.68988   64  199 -1120.9845 9599.69686   956%  6886 3600s

Cutting planes:
  Learned: 2
  Gomory: 14
  Implied bound: 344
  MIR: 5132
  Flow cover: 5710
  RLT: 55
  Relax-and-lift: 1039

Explored 3005 nodes (21484118 simplex iterations) in 3600.05 seconds (7628.91 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -1120.98 -1147.96 -1157.18 ... -1522.08

Time limit reached
Best objective -1.120984458822e+03, best bound 9.599696860291e+03, gap 956.3631%
  WARNING: Time limit reached. Using best solution found (gap: 956.36%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = -1120.98, θ = 139753.97
  Upper Bound (UB) = -1120.98

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 139753.97
  [DEBUG]   ✓ Scenario 0: θ = 139753.97 ≤ Q = 141985.91 (slack: 2231.94)
  [DEBUG]   ✓ Scenario 1: θ = 139753.97 ≤ Q = 139753.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 139753.97 ≤ Q = 139753.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 139753.97 ≤ Q = 139753.97 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 139753.97 ≤ Q = 139753.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 139753.97 ≤ Q = 139753.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 139753.97 ≤ Q = 139753.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 139753.97 ≤ Q = 139753.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 139753.97 ≤ Q = 139753.97 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 139753.97 ≤ Q = 139753.97 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 139753.97 ≤ Q = 139753.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 139753.97 ≤ Q = 139753.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 139753.97 ≤ Q = 139753.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 139753.97 ≤ Q = 139753.97 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 139753.97 ≤ Q = 139753.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 139753.97 ≤ Q = 139753.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 139753.97 ≤ Q = 139753.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 139753.97 ≤ Q = 139753.97 (slack: 0.00)
  [DEBUG]   ✓ Scenario 18: θ = 139753.97 ≤ Q = 139753.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 139753.97 ≤ Q = 139753.97 (slack: 0.00)
  [DEBUG]   ✓ Scenario 20: θ = 139753.97 ≤ Q = 139753.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 21: θ = 139753.97 ≤ Q = 139753.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 22: θ = 139753.97 ≤ Q = 139753.97 (slack: 0.00)
  [DEBUG]   ✓ Scenario 23: θ = 139753.97 ≤ Q = 139753.97 (slack: 0.00)
  [DEBUG]   ✓ Scenario 24: θ = 139753.97 ≤ Q = 139753.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 25: θ = 139753.97 ≤ Q = 139753.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 26: θ = 139753.97 ≤ Q = 139753.97 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 27] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x4b2d30f9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xb4d2cf07
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [7e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e-14, 2e+02]
Found heuristic solution: objective 1.133984e+13
Presolve removed 2600 rows and 1892 columns
Presolve time: 0.00s
Presolved: 493 rows, 497 columns, 1390 nonzeros
Found heuristic solution: objective 5689614.7052
Variable types: 337 continuous, 160 integer (160 binary)

Root relaxation: objective -1.312106e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -131210.57    0  123 5689614.71 -131210.57   102%     -    0s
H    0     0                    -99149.13328 -131210.57  32.3%     -    0s
H    0     0                    -99750.27954 -131210.57  31.5%     -    0s
     0     0 -105914.19    0   56 -99750.280 -105914.19  6.18%     -    0s
H    0     0                    -102911.6389 -105821.85  2.83%     -    0s
H    0     0                    -103919.0138 -105821.85  1.83%     -    0s
H    0     0                    -104258.0136 -105821.85  1.50%     -    0s
     0     0 -105270.78    0   57 -104258.01 -105270.78  0.97%     -    0s
     0     0 -105138.68    0   57 -104258.01 -105138.68  0.84%     -    0s
     0     0 -104718.87    0   34 -104258.01 -104718.87  0.44%     -    0s
H    0     0                    -104322.1061 -104705.42  0.37%     -    0s
H    0     0                    -104332.9840 -104628.43  0.28%     -    0s
     0     0 -104628.43    0   40 -104332.98 -104628.43  0.28%     -    0s
     0     0 -104628.38    0   29 -104332.98 -104628.38  0.28%     -    0s
     0     0 -104505.64    0   16 -104332.98 -104505.64  0.17%     -    0s
     0     0 -104468.18    0   29 -104332.98 -104468.18  0.13%     -    0s
     0     0 -104463.00    0   31 -104332.98 -104463.00  0.12%     -    0s
     0     0 -104445.60    0   31 -104332.98 -104445.60  0.11%     -    0s
     0     0 -104444.61    0   26 -104332.98 -104444.61  0.11%     -    0s
     0     0 -104435.61    0   11 -104332.98 -104435.61  0.10%     -    0s
     0     0 -104427.01    0    8 -104332.98 -104427.01  0.09%     -    0s
     0     0 -104427.01    0    8 -104332.98 -104427.01  0.09%     -    0s
H    0     0                    -104337.0783 -104427.01  0.09%     -    0s
     0     0 -104419.40    0   20 -104337.08 -104419.40  0.08%     -    0s
     0     0 -104349.44    0    6 -104337.08 -104349.44  0.01%     -    0s

Cutting planes:
  Gomory: 2
  Implied bound: 9
  MIR: 12
  Flow cover: 6
  RLT: 3

Explored 1 nodes (644 simplex iterations) in 0.08 seconds (0.04 work units)
Thread count was 32 (of 256 available processors)

Solution count 9: -104337 -104333 -104322 ... 1.13398e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.043370782704e+05, best bound -1.043444122556e+05, gap 0.0070%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 137123.34
  Scenario: 21 demand increases, 39 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -104337.08
  [DEBUG]   S×d_nominal = 241460.42
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 241460.42 + -104337.08 = 137123.34
  [DEBUG]   Current θ from Master = 139753.97
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2630.63 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -3751.61
  Lower Bound (LB) = -1589.09
  Gap (UB-LB) = 468.1047, Absolute Gap = 468.1047, Relative Gap = 0.417584
  Not converged yet (gap = 468.10 > ε = 200)

  [DEBUG] Adding NEW scenario 27 to Master Problem...
  [DEBUG] New scenario pattern: 21 increases, 39 decreases
    [DEBUG] Scenario 27 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 27 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 27]
    [DEBUG]   - Total constraints in model: 429503
    [DEBUG]   - Total variables in model: 176980
  [DEBUG] Total scenarios in Master: 28
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 28
================================================================================
[Iteration 28] Solving Master Problem...
  Current scenarios in Master: 28
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 429503 rows, 176980 columns and 1215987 nonzeros
Model fingerprint: 0x942197e5
Variable types: 174721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 197960 rows and 80360 columns
Presolve time: 4.68s
Presolved: 231543 rows, 96620 columns, 1426513 nonzeros
Variable types: 94361 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -372533.0079
Found heuristic solution: objective -219438.1934

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.97s

Barrier statistics:
 Dense cols : 1185
 AA' NZ     : 6.816e+06
 Factor NZ  : 1.894e+07 (roughly 300 MB of memory)
 Factor Ops : 7.424e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.84983742e+07  3.44370509e+08  1.04e+05 1.37e+01  7.37e+04     9s
   1  -1.44828829e+07  3.04048879e+08  7.51e+04 5.01e+01  5.26e+04     9s
   2  -6.10151585e+06  2.50077027e+08  3.01e+04 1.08e+01  2.17e+04     9s
   3  -1.34846400e+06  1.99123003e+08  3.39e+03 3.28e+00  2.82e+03     9s
   4  -7.53687194e+05  1.65275714e+08  6.98e+02 2.17e+00  8.61e+02     9s
   5  -6.40441150e+05  7.78268243e+07  3.50e+02 6.93e-01  3.90e+02     9s
   6  -5.36809074e+05  5.74043597e+07  2.29e+02 3.28e-01  2.63e+02     9s
   7  -4.83713727e+05  4.62720150e+07  1.22e+02 2.25e-01  1.74e+02     9s
   8  -4.08392024e+05  2.84257981e+07  5.84e+01 2.96e-02  9.44e+01    10s
   9  -2.95284108e+05  1.85295486e+07  2.26e+01 1.74e-02  5.28e+01    10s
  10  -2.04803775e+05  1.23480690e+07  1.14e+01 1.10e-02  3.28e+01    10s
  11  -1.57519346e+05  9.11415774e+06  7.08e+00 7.91e-03  2.35e+01    10s
  12  -1.47888980e+05  7.09783545e+06  5.76e+00 6.07e-03  1.82e+01    10s
  13  -1.29538632e+05  5.98314681e+06  3.73e+00 5.08e-03  1.51e+01    10s
  14  -1.09752555e+05  4.63988730e+06  1.69e+00 3.93e-03  1.15e+01    10s
  15  -9.12960095e+04  1.92286701e+06  7.79e-01 1.60e-03  4.83e+00    10s
  16  -6.77104676e+04  5.49007699e+05  3.58e-01 4.80e-04  1.47e+00    10s
  17  -4.73780265e+04  2.87070912e+05  2.06e-01 3.35e-04  7.97e-01    10s
  18  -3.33456592e+04  2.00321792e+05  1.50e-01 1.57e-03  5.57e-01    10s
  19  -2.31234302e+04  1.40303595e+05  1.20e-01 2.36e-03  3.89e-01    10s
  20  -1.92609273e+04  1.26240888e+05  1.10e-01 2.62e-03  3.47e-01    10s
  21  -1.49374163e+04  9.75237258e+04  1.00e-01 3.50e-03  2.68e-01    10s
  22  -6.56494197e+03  8.74091887e+04  7.90e-02 3.51e-03  2.24e-01    11s
  23  -2.16311896e+03  7.75196105e+04  6.84e-02 3.88e-03  1.90e-01    11s
  24   2.21872981e+03  6.52086369e+04  5.67e-02 2.25e-03  1.50e-01    11s
  25   5.48943205e+03  5.69399179e+04  4.79e-02 2.05e-03  1.23e-01    11s
  26   6.07799900e+03  5.02977281e+04  4.59e-02 1.87e-03  1.05e-01    11s
  27   1.08068309e+04  4.57525900e+04  3.40e-02 3.45e-03  8.32e-02    11s
  28   1.19712338e+04  4.21651688e+04  3.12e-02 2.79e-03  7.19e-02    11s
  29   1.26819377e+04  3.79800390e+04  2.94e-02 2.13e-03  6.03e-02    11s
  30   1.64798931e+04  3.67769139e+04  2.08e-02 1.85e-03  4.83e-02    11s
  31   1.83549652e+04  3.50525734e+04  1.67e-02 1.53e-03  3.98e-02    11s
  32   1.93215710e+04  3.42638270e+04  1.48e-02 1.39e-03  3.56e-02    11s
  33   1.97073440e+04  3.35872609e+04  1.40e-02 1.27e-03  3.31e-02    11s
  34   2.05427403e+04  3.28374509e+04  1.23e-02 1.12e-03  2.93e-02    11s
  35   2.09632734e+04  3.20132430e+04  1.15e-02 9.73e-04  2.63e-02    12s
  36   2.18165698e+04  3.12910022e+04  9.81e-03 8.23e-04  2.26e-02    12s
  37   2.23041703e+04  3.09371849e+04  8.88e-03 7.56e-04  2.06e-02    12s
  38   2.25008174e+04  3.08440444e+04  8.51e-03 7.37e-04  1.99e-02    12s
  39   2.29229531e+04  3.00404724e+04  7.70e-03 5.77e-04  1.70e-02    12s
  40   2.31483616e+04  2.96120788e+04  7.30e-03 4.87e-04  1.54e-02    12s
  41   2.37703775e+04  2.93897793e+04  6.21e-03 4.41e-04  1.34e-02    12s
  42   2.41666631e+04  2.91339228e+04  5.50e-03 3.87e-04  1.18e-02    12s
  43   2.45038887e+04  2.87074801e+04  4.89e-03 2.90e-04  1.00e-02    12s
  44   2.52216469e+04  2.84809840e+04  3.64e-03 2.37e-04  7.77e-03    12s
  45   2.56017443e+04  2.81509396e+04  2.98e-03 1.62e-04  6.07e-03    13s
  46   2.63426894e+04  2.78116020e+04  1.71e-03 8.41e-05  3.50e-03    13s
  47   2.68204372e+04  2.75808040e+04  9.24e-04 1.87e-04  1.81e-03    13s
  48   2.69969652e+04  2.75013819e+04  6.37e-04 9.24e-05  1.20e-03    13s
  49   2.71280078e+04  2.74772865e+04  4.24e-04 6.57e-05  8.32e-04    13s
  50   2.71393767e+04  2.74662206e+04  4.06e-04 5.29e-05  7.79e-04    13s
  51   2.72007042e+04  2.74536080e+04  3.15e-04 3.75e-05  6.03e-04    13s
  52   2.73286922e+04  2.74378591e+04  1.24e-04 2.25e-05  2.60e-04    13s
  53   2.74024609e+04  2.74240332e+04  1.56e-05 5.37e-06  5.13e-05    13s
  54   2.74163352e+04  2.74198906e+04  2.46e-06 5.26e-06  8.46e-06    13s
  55   2.74186961e+04  2.74194920e+04  4.53e-07 2.01e-06  1.89e-06    13s
  56   2.74192316e+04  2.74192375e+04  3.51e-09 3.46e-08  1.42e-08    13s
  57   2.74192362e+04  2.74192363e+04  2.28e-07 4.48e-10  2.47e-10    14s

Barrier solved model in 57 iterations and 13.61 seconds (25.10 work units)
Optimal objective 2.74192362e+04


Root crossover log...

  207564 DPushes remaining with DInf 0.0000000e+00                14s
   70564 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                20s

   10321 PPushes remaining with PInf 1.0592945e-04                20s
    3516 PPushes remaining with PInf 3.8676157e-05                20s
       0 PPushes remaining with PInf 0.0000000e+00                21s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.7773988e+02     21s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
  100189    2.7419229e+04   0.000000e+00   2.777399e+02     21s
  100194    2.7419236e+04   0.000000e+00   0.000000e+00     21s
  100194    2.7419236e+04   0.000000e+00   0.000000e+00     21s
Concurrent spin time: 8.49s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 2.741924e+04, 100194 iterations, 23.21 seconds (33.91 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 27419.2363    0  136 -219438.19 27419.2363   112%     -   29s
H    0     0                    -176973.8468 27419.2363   115%     -   31s
H    0     0                    -168217.5331 27419.2363   116%     -   33s
H    0     0                    -59572.43809 27419.2363   146%     -   33s
H    0     0                    -59377.33935 27419.2363   146%     -   34s
H    0     0                    -56377.50221 27419.2363   149%     -   34s
H    0     0                    -55419.32199 27419.2363   149%     -   34s
H    0     0                    -51282.36057 27419.2363   153%     -   34s
H    0     0                    -51087.26183 27419.2363   154%     -   34s
H    0     0                    -44234.85080 27419.2363   162%     -   34s
     0     0 22009.7950    0  239 -44234.851 22009.7950   150%     -  111s
H    0     0                    -40795.20674 22008.7959   154%     -  112s
H    0     0                    -40168.11616 22008.7959   155%     -  112s
H    0     0                    -37932.22755 22008.7959   158%     -  113s
H    0     0                    -19994.63480 22008.7959   210%     -  113s
H    0     0                    -6133.982093 22008.7959   459%     -  113s
H    0     0                    -6069.210612 22008.7959   463%     -  113s
     0     0 21754.8299    0  253 -6069.2106 21754.8299   458%     -  143s
     0     0 21685.3964    0  262 -6069.2106 21685.3964   457%     -  156s
     0     0 21653.8894    0  261 -6069.2106 21653.8894   457%     -  165s
     0     0 21652.5005    0  261 -6069.2106 21652.5005   457%     -  166s
     0     0 21648.8866    0  261 -6069.2106 21648.8866   457%     -  168s
     0     0 21619.9884    0  266 -6069.2106 21619.9884   456%     -  174s
     0     0 21619.2724    0  266 -6069.2106 21619.2724   456%     -  176s
     0     0 21617.0382    0  266 -6069.2106 21617.0382   456%     -  177s
     0     0 21613.8770    0  265 -6069.2106 21613.8770   456%     -  178s
     0     0 21613.3127    0  263 -6069.2106 21613.3127   456%     -  179s
     0     0 18922.0562    0  234 -6069.2106 18922.0562   412%     -  237s
H    0     0                    -5608.986023 18921.9668   437%     -  238s
     0     0 17937.4890    0  243 -5608.9860 17937.4890   420%     -  272s
     0     0 17826.8005    0  249 -5608.9860 17826.8005   418%     -  285s
     0     0 17816.7974    0  246 -5608.9860 17816.7974   418%     -  288s
     0     0 17788.8820    0  258 -5608.9860 17788.8820   417%     -  294s
     0     0 17766.3222    0  250 -5608.9860 17766.3222   417%     -  299s
     0     0 17486.1599    0  269 -5608.9860 17486.1599   412%     -  315s
     0     0 17474.3767    0  258 -5608.9860 17474.3767   412%     -  319s
     0     0 17452.8786    0  260 -5608.9860 17452.8786   411%     -  322s
     0     0 17451.0455    0  259 -5608.9860 17451.0455   411%     -  324s
     0     0 17445.7077    0  253 -5608.9860 17445.7077   411%     -  326s
     0     0 17445.4968    0  253 -5608.9860 17445.4968   411%     -  327s
     0     0 14807.6187    0  343 -5608.9860 14807.6187   364%     -  404s
H    0     0                    -3965.822461 14807.5490   473%     -  405s
H    0     0                    -3877.173719 14807.5490   482%     -  405s
H    0     0                    -3666.526659 14807.5490   504%     -  405s
H    0     0                    -3343.457418 14807.5490   543%     -  405s
     0     0 14198.3786    0  354 -3343.4574 14198.3786   525%     -  437s
     0     0 14054.9024    0  344 -3343.4574 14054.9024   520%     -  453s
     0     0 13988.3064    0  366 -3343.4574 13988.3064   518%     -  465s
     0     0 13901.5532    0  360 -3343.4574 13901.5532   516%     -  480s
     0     0 13893.5539    0  373 -3343.4574 13893.5539   516%     -  486s
     0     0 13857.5213    0  372 -3343.4574 13857.5213   514%     -  493s
     0     0 13854.7336    0  370 -3343.4574 13854.7336   514%     -  496s
     0     0 13843.2628    0  379 -3343.4574 13843.2628   514%     -  500s
     0     0 13840.7007    0  363 -3343.4574 13840.7007   514%     -  502s
     0     0 13839.8654    0  363 -3343.4574 13839.8654   514%     -  503s
     0     0 12576.9955    0  390 -3343.4574 12576.9955   476%     -  570s
     0     0 12337.8271    0  438 -3343.4574 12337.8271   469%     -  615s
     0     0 12106.2055    0  457 -3343.4574 12106.2055   462%     -  644s
     0     0 12073.3950    0  451 -3343.4574 12073.3950   461%     -  659s
     0     0 12034.9568    0  455 -3343.4574 12034.9568   460%     -  672s
     0     0 11957.1565    0  461 -3343.4574 11957.1565   458%     -  689s
     0     0 11935.4512    0  456 -3343.4574 11935.4512   457%     -  698s
     0     0 11894.6151    0  453 -3343.4574 11894.6151   456%     -  710s
     0     0 11844.2571    0  440 -3343.4574 11844.2571   454%     -  721s
     0     0 11824.1162    0  459 -3343.4574 11824.1162   454%     -  729s
     0     0 11821.6897    0  452 -3343.4574 11821.6897   454%     -  734s
     0     0 11798.0856    0  456 -3343.4574 11798.0856   453%     -  742s
     0     0 11782.5197    0  449 -3343.4574 11782.5197   452%     -  749s
     0     0 11775.4968    0  445 -3343.4574 11775.4968   452%     -  755s
     0     0 11774.5917    0  458 -3343.4574 11774.5917   452%     -  757s
     0     0 11293.5180    0  457 -3343.4574 11293.5180   438%     -  803s
H    0     0                    -2759.530316 11293.4853   509%     -  805s
H    0     0                    -2714.125595 11293.4853   516%     -  805s
     0     0 11147.1223    0  380 -2714.1256 11147.1223   511%     -  824s
     0     0 11059.8170    0  376 -2714.1256 11059.8170   507%     -  840s
     0     0 11049.4667    0  378 -2714.1256 11049.4667   507%     -  849s
     0     0 11043.1729    0  384 -2714.1256 11043.1729   507%     -  853s
     0     0 11035.7257    0  386 -2714.1256 11035.7257   507%     -  857s
     0     0 11033.4179    0  385 -2714.1256 11033.4179   507%     -  860s
     0     0 11026.9264    0  383 -2714.1256 11026.9264   506%     -  865s
     0     0 11023.5579    0  380 -2714.1256 11023.5579   506%     -  868s
     0     0 11009.4759    0  389 -2714.1256 11009.4759   506%     -  879s
     0     0 11006.1387    0  386 -2714.1256 11006.1387   506%     -  884s
     0     0 10992.3497    0  458 -2714.1256 10992.3497   505%     -  899s
     0     0 10988.0510    0  461 -2714.1256 10988.0510   505%     -  905s
     0     0 10984.4147    0  389 -2714.1256 10984.4147   505%     -  912s
     0     0 10984.1374    0  390 -2714.1256 10984.1374   505%     -  915s
     0     0 10925.8027    0  426 -2714.1256 10925.8027   503%     -  944s
H    0     0                    -1563.948521 10925.6409   799%     -  954s
     0     0 10854.7597    0  406 -1563.9485 10854.7597   794%     -  977s
     0     0 10821.5037    0  473 -1563.9485 10821.5037   792%     -  996s
     0     0 10812.7087    0  490 -1563.9485 10812.7087   791%     - 1008s
     0     0 10809.2321    0  544 -1563.9485 10809.2321   791%     - 1013s
     0     0 10805.2583    0  547 -1563.9485 10805.2583   791%     - 1018s
     0     0 10804.1081    0  491 -1563.9485 10804.1081   791%     - 1024s
     0     0 10713.7169    0  592 -1563.9485 10713.7169   785%     - 1057s
H    0     0                    -1503.890368 10713.4594   812%     - 1059s
     0     0 10689.8534    0  365 -1503.8904 10689.8534   811%     - 1077s
     0     0 10676.6943    0  484 -1503.8904 10676.6943   810%     - 1088s
     0     0 10672.9859    0  486 -1503.8904 10672.9859   810%     - 1093s
     0     0 10671.0398    0  491 -1503.8904 10671.0398   810%     - 1100s
     0     0 10580.5343    0  440 -1503.8904 10580.5343   804%     - 1125s
H    0     0                    -1492.356307 10580.5181   809%     - 1128s
     0     0 10570.0426    0  435 -1492.3563 10570.0426   808%     - 1137s
     0     0 10562.9362    0  437 -1492.3563 10562.9362   808%     - 1142s
     0     0 10558.6845    0  490 -1492.3563 10558.6845   808%     - 1149s
     0     0 10556.3641    0  495 -1492.3563 10556.3641   807%     - 1155s
     0     0 10547.6348    0  514 -1492.3563 10547.6348   807%     - 1162s
     0     0 10547.1929    0  513 -1492.3563 10547.1929   807%     - 1164s
     0     0 10532.3105    0  496 -1492.3563 10532.3105   806%     - 1178s
H    0     0                    -1434.922276 10532.2894   834%     - 1179s
     0     0 10526.1971    0  496 -1434.9223 10526.1971   834%     - 1184s
     0     0 10524.4744    0  494 -1434.9223 10524.4744   833%     - 1187s
     0     0 10489.1694    0  488 -1434.9223 10489.1694   831%     - 1201s
H    0     0                    -1157.183090 10488.9214  1006%     - 1228s
     0     0 10472.3668    0  439 -1157.1831 10472.3668  1005%     - 1237s
     0     0 10460.1344    0  480 -1157.1831 10460.1344  1004%     - 1245s
     0     0 10458.0448    0  500 -1157.1831 10458.0448  1004%     - 1250s
     0     0 10431.9675    0  442 -1157.1831 10431.9675  1001%     - 1262s
     0     0 10419.4356    0  443 -1157.1831 10419.4356  1000%     - 1273s
     0     0 10417.5315    0  504 -1157.1831 10417.5315  1000%     - 1278s
     0     0 10410.9713    0  439 -1157.1831 10410.9713  1000%     - 1288s
     0     0 10407.2343    0  502 -1157.1831 10407.2343   999%     - 1299s
     0     0 10404.7410    0  447 -1157.1831 10404.7410   999%     - 1303s
     0     0 10404.3309    0  505 -1157.1831 10404.3309   999%     - 1304s
     0     0 10396.8724    0  367 -1157.1831 10396.8724   998%     - 1313s
     0     0 10395.7378    0  368 -1157.1831 10395.7378   998%     - 1317s
     0     0 10389.7425    0  373 -1157.1831 10389.7425   998%     - 1322s
     0     0 10385.5985    0  436 -1157.1831 10385.5985   997%     - 1453s
     0     0 10384.0618    0  439 -1157.1831 10384.0618   997%     - 1456s
     0     0 10381.3375    0  437 -1157.1831 10381.3375   997%     - 1462s
     0     0 10381.0448    0  437 -1157.1831 10381.0448   997%     - 1469s
     0     2 10380.7846    0  437 -1157.1831 10380.7846   997%     - 1627s
     1     3 10183.0543    1  499 -1157.1831 10380.7846   997% 24890 1665s
     2     4 10356.6414    1  435 -1157.1831 10356.6414   995% 16998 1679s
     3     5 9867.57458    2  541 -1157.1831 10356.6037   995% 16429 1702s
     4     9 10070.4457    2  358 -1157.1831 10356.0047   995% 15895 1727s
     8    14 9431.09123    3  514 -1157.1831 10070.0032   970% 14466 1800s
    13    28 7892.15860    4  312 -1157.1831 10070.0032   970% 19949 1835s
    27    42 9665.99502    4  361 -1157.1831 9825.76064   949% 22441 1928s
    41    71 8742.54611    6  531 -1157.1831 9825.76064   949% 27287 2435s
    70   122 8724.98623    7  522 -1157.1831 9720.95491   940% 31715 2556s
   121   200 8051.69046   10  556 -1157.1831 9720.77401   940% 25334 2647s
   199   274 7919.36692   13  439 -1157.1831 9720.77401   940% 20733 2714s
   279   340 7853.37553   16  484 -1157.1831 9720.77401   940% 18551 2764s
   352   389 7659.40787   20  397 -1157.1831 9720.77401   940% 16706 2808s
   425   407 7180.85040   23  417 -1157.1831 9720.77401   940% 15290 2844s
   456   423 6982.66910   24  427 -1157.1831 9720.77401   940% 15290 2883s
   488   438 6974.72967   25  427 -1157.1831 9665.97397   935% 15230 2919s
   527   458 6968.55672   26  429 -1157.1831 9665.97397   935% 15121 2955s
   559   473 4781.53747   27  366 -1157.1831 9665.97397   935% 15015 2988s
   602   489 5956.42349   29  335 -1157.1831 9467.18819   918% 14768 3022s
   642   523 2748.14290   28  347 -1157.1831 9467.18819   918% 14649 3055s
   690   556 2282.03569   29  296 -1157.1831 9358.26654   909% 14338 3096s
   745   605 1429.92231   30  350 -1157.1831 9358.26654   909% 14026 3138s
   810   636 1254.96171   31  339 -1157.1831 9358.26654   909% 13544 3173s
   880   652 1195.90167   32  365 -1157.1831 9358.26654   909% 13297 3211s
   942   664 1123.36609   33  282 -1157.1831 9358.26654   909% 13067 3257s
   996   702  957.89023   34  323 -1157.1831 9358.26654   909% 12828 3439s
  1065   790  727.46250   35  287 -1157.1831 9358.26654   909% 12563 3485s
  1165   894  377.26171   36  280 -1157.1831 9358.26654   909% 12083 3532s
  1305   991 -788.27388   37  230 -1157.1831 9358.26654   909% 11490 3577s
  1444  1092 -1057.8354   38  208 -1157.1831 9358.26654   909% 11051 3600s

Cutting planes:
  Learned: 1
  Gomory: 15
  Implied bound: 410
  MIR: 4908
  Flow cover: 5035
  RLT: 59
  Relax-and-lift: 1032

Explored 1617 nodes (17918926 simplex iterations) in 3600.10 seconds (8733.73 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -1157.18 -1434.92 -1492.36 ... -3877.17

Time limit reached
Best objective -1.157183090257e+03, best bound 9.358266540249e+03, gap 908.7110%
  WARNING: Time limit reached. Using best solution found (gap: 908.71%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.11s
  Master Objective (UB) = -1157.18, θ = 141825.12
  Upper Bound (UB) = -1157.18

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 141825.12
  [DEBUG]   ✓ Scenario 0: θ = 141825.12 ≤ Q = 141825.12 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 141825.12 ≤ Q = 141825.12 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 141825.12 ≤ Q = 141825.12 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 141825.12 ≤ Q = 141825.12 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 141825.12 ≤ Q = 141825.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 141825.12 ≤ Q = 141825.12 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 141825.12 ≤ Q = 141825.12 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 141825.12 ≤ Q = 141825.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 141825.12 ≤ Q = 141825.12 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 141825.12 ≤ Q = 141825.12 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 141825.12 ≤ Q = 141825.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 141825.12 ≤ Q = 141825.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 141825.12 ≤ Q = 141825.12 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 141825.12 ≤ Q = 141825.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 141825.12 ≤ Q = 141825.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 141825.12 ≤ Q = 141825.12 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 141825.12 ≤ Q = 141825.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 141825.12 ≤ Q = 141825.12 (slack: 0.00)
  [DEBUG]   ✓ Scenario 18: θ = 141825.12 ≤ Q = 141825.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 141825.12 ≤ Q = 141825.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 20: θ = 141825.12 ≤ Q = 141825.12 (slack: 0.00)
  [DEBUG]   ✓ Scenario 21: θ = 141825.12 ≤ Q = 141825.12 (slack: 0.00)
  [DEBUG]   ✓ Scenario 22: θ = 141825.12 ≤ Q = 141825.12 (slack: 0.00)
  [DEBUG]   ✓ Scenario 23: θ = 141825.12 ≤ Q = 141825.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 24: θ = 141825.12 ≤ Q = 141825.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 25: θ = 141825.12 ≤ Q = 141825.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 26: θ = 141825.12 ≤ Q = 141825.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 27: θ = 141825.12 ≤ Q = 141825.12 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 28] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0xdbe3d82
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x0dbe3d82
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.152079e+13
Presolve removed 2598 rows and 1890 columns
Presolve time: 0.00s
Presolved: 495 rows, 499 columns, 1396 nonzeros
Found heuristic solution: objective 5682467.9772
Variable types: 339 continuous, 160 integer (160 binary)

Root relaxation: objective -1.289545e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -128954.47    0  123 5682467.98 -128954.47   102%     -    0s
H    0     0                    -96766.35848 -128954.47  33.3%     -    0s
H    0     0                    -97383.93745 -128954.47  32.4%     -    0s
     0     0 -101580.23    0   24 -97383.937 -101580.23  4.31%     -    0s
H    0     0                    -100410.0763 -101521.74  1.11%     -    0s
     0     0 -101240.46    0   13 -100410.08 -101240.46  0.83%     -    0s
H    0     0                    -101066.2987 -101235.81  0.17%     -    0s
     0     0 -101222.36    0   12 -101066.30 -101222.36  0.15%     -    0s
     0     0 -101221.00    0    7 -101066.30 -101221.00  0.15%     -    0s
     0     0 -101220.55    0    8 -101066.30 -101220.55  0.15%     -    0s
     0     0 -101155.15    0    4 -101066.30 -101155.15  0.09%     -    0s
     0     0 -101155.15    0   11 -101066.30 -101155.15  0.09%     -    0s
H    0     0                    -101075.8749 -101155.15  0.08%     -    0s
*    0     0               0    -101099.5940 -101099.59  0.00%     -    0s

Cutting planes:
  Gomory: 3
  Implied bound: 6
  MIR: 7
  Flow cover: 4
  RLT: 1

Explored 1 nodes (495 simplex iterations) in 0.07 seconds (0.03 work units)
Thread count was 32 (of 256 available processors)

Solution count 8: -101100 -101076 -101066 ... 1.15208e+13
No other solutions better than -101100

Optimal solution found (tolerance 1.00e-04)
Best objective -1.010995940015e+05, best bound -1.010995940015e+05, gap 0.0000%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 140360.82
  Scenario: 5 demand increases, 55 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -101099.59
  [DEBUG]   S×d_nominal = 241460.42
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 241460.42 + -101099.59 = 140360.82
  [DEBUG]   Current θ from Master = 141825.12
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1464.30 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -2621.48
  Lower Bound (LB) = -1589.09
  Gap (UB-LB) = 431.9061, Absolute Gap = 431.9061, Relative Gap = 0.373239
  Not converged yet (gap = 431.91 > ε = 200)

  [DEBUG] Adding NEW scenario 28 to Master Problem...
  [DEBUG] New scenario pattern: 5 increases, 55 decreases
    [DEBUG] Scenario 28 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 28 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 28]
    [DEBUG]   - Total constraints in model: 444793
    [DEBUG]   - Total variables in model: 183220
  [DEBUG] Total scenarios in Master: 29
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 29
================================================================================
[Iteration 29] Solving Master Problem...
  Current scenarios in Master: 29
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 444793 rows, 183220 columns and 1259218 nonzeros
Model fingerprint: 0x8912ac55
Variable types: 180961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 205030 rows and 83230 columns (presolve time = 5s)...
Presolve removed 205030 rows and 83230 columns
Presolve time: 5.77s
Presolved: 239763 rows, 99990 columns, 1476941 nonzeros
Variable types: 97731 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -373180.1084
Found heuristic solution: objective -219438.1934

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 2.66s

Barrier statistics:
 Dense cols : 1183
 AA' NZ     : 7.247e+06
 Factor NZ  : 2.010e+07 (roughly 300 MB of memory)
 Factor Ops : 7.967e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.87047552e+07  3.54026303e+08  1.06e+05 1.36e+01  7.41e+04    11s
   1  -1.46524312e+07  3.12752537e+08  7.59e+04 4.94e+01  5.29e+04    11s
   2  -6.21592019e+06  2.57694191e+08  3.06e+04 1.13e+01  2.20e+04    11s
   3  -1.55349217e+06  2.25636192e+08  4.25e+03 9.34e+00  3.46e+03    11s
   4  -9.86099180e+05  1.86466889e+08  1.62e+03 6.21e+00  1.52e+03    11s
   5  -7.37580129e+05  1.09854232e+08  5.96e+02 2.92e+00  6.28e+02    11s
   6  -6.10170129e+05  7.28882376e+07  3.32e+02 1.62e+00  3.63e+02    11s
   7  -5.57432279e+05  5.78660175e+07  1.88e+02 1.11e+00  2.39e+02    12s
   8  -4.65926170e+05  4.34215010e+07  6.07e+01 5.89e-01  1.32e+02    12s
   9  -3.78794573e+05  2.92238425e+07  2.08e+01 4.10e-02  7.69e+01    12s
  10  -2.98442625e+05  1.93885164e+07  1.02e+01 2.64e-02  4.86e+01    12s
  11  -1.93259743e+05  1.29623906e+07  4.30e+00 1.68e-02  3.12e+01    12s
  12  -1.63866509e+05  9.11729368e+06  3.04e+00 1.17e-02  2.18e+01    12s
  13  -1.45756836e+05  7.06264429e+06  2.25e+00 9.00e-03  1.69e+01    12s
  14  -1.27616793e+05  5.32289397e+06  1.46e+00 6.74e-03  1.27e+01    12s
  15  -1.15570202e+05  4.30748219e+06  9.94e-01 5.41e-03  1.02e+01    12s
  16  -9.17074612e+04  2.58159512e+06  4.42e-01 3.15e-03  6.16e+00    12s
  17  -7.21087386e+04  1.20023639e+06  2.23e-01 1.45e-03  2.93e+00    12s
  18  -5.52820312e+04  5.76350905e+05  1.18e-01 6.85e-04  1.45e+00    13s
  19  -3.13484666e+04  2.83248104e+05  6.04e-02 3.24e-04  7.23e-01    13s
  20  -2.24753944e+04  2.19286707e+05  4.81e-02 3.67e-04  5.55e-01    13s
  21  -1.61020089e+04  1.90203164e+05  3.96e-02 3.03e-04  4.74e-01    13s
  22  -8.65036197e+03  1.38209742e+05  3.07e-02 4.25e-04  3.37e-01    13s
  23  -2.94176088e+03  1.18303153e+05  2.37e-02 7.40e-04  2.79e-01    13s
  24   1.36138949e+03  1.00138430e+05  1.87e-02 5.88e-04  2.27e-01    13s
  25   4.51488133e+03  9.24726782e+04  1.53e-02 5.99e-04  2.02e-01    13s
  26   5.99900246e+03  7.66030594e+04  1.38e-02 1.20e-03  1.62e-01    13s
  27   7.36567792e+03  6.60172909e+04  1.26e-02 1.65e-03  1.35e-01    13s
  28   1.08739623e+04  5.58854028e+04  9.52e-03 3.36e-03  1.03e-01    13s
  29   1.14481150e+04  5.30776550e+04  9.06e-03 3.02e-03  9.56e-02    14s
  30   1.34578114e+04  5.04571953e+04  7.52e-03 2.74e-03  8.50e-02    14s
  31   1.53118183e+04  4.52077721e+04  6.26e-03 2.17e-03  6.87e-02    14s
  32   1.71443071e+04  4.19336234e+04  5.12e-03 1.82e-03  5.69e-02    14s
  33   1.90473677e+04  3.85590219e+04  4.03e-03 1.50e-03  4.48e-02    14s
  34   2.05989893e+04  3.64162985e+04  3.18e-03 1.22e-03  3.63e-02    14s
  35   2.13448261e+04  3.56250805e+04  2.78e-03 1.12e-03  3.28e-02    14s
  36   2.16189206e+04  3.47257847e+04  2.63e-03 1.01e-03  3.01e-02    14s
  37   2.24672817e+04  3.31089457e+04  2.18e-03 8.00e-04  2.44e-02    15s
  38   2.30587683e+04  3.22246181e+04  1.90e-03 6.84e-04  2.11e-02    15s
  39   2.33128026e+04  3.18990806e+04  1.78e-03 6.46e-04  1.97e-02    15s
  40   2.36329438e+04  3.13155257e+04  1.63e-03 5.63e-04  1.76e-02    15s
  41   2.43626632e+04  3.10077876e+04  1.30e-03 5.23e-04  1.53e-02    15s
  42   2.44117460e+04  3.05153963e+04  1.28e-03 4.54e-04  1.40e-02    15s
  43   2.51681457e+04  2.97969420e+04  9.35e-04 3.30e-04  1.06e-02    15s
  44   2.57150106e+04  2.93146890e+04  6.92e-04 2.66e-04  8.27e-03    15s
  45   2.60503199e+04  2.85405070e+04  5.49e-04 1.59e-04  5.72e-03    16s
  46   2.64916946e+04  2.80446578e+04  3.62e-04 1.16e-04  3.57e-03    16s
  47   2.70390306e+04  2.77500252e+04  1.41e-04 7.28e-05  1.63e-03    16s
  48   2.71095809e+04  2.76453004e+04  1.13e-04 4.86e-05  1.23e-03    16s
  49   2.71879837e+04  2.76019422e+04  8.33e-05 3.94e-05  9.51e-04    16s
  50   2.72741645e+04  2.75752786e+04  5.08e-05 3.35e-05  6.92e-04    16s
  51   2.73529018e+04  2.75073249e+04  2.14e-05 1.88e-05  3.55e-04    16s
  52   2.73676498e+04  2.74654939e+04  1.64e-05 1.02e-05  2.25e-04    16s
  53   2.73911003e+04  2.74437825e+04  8.60e-06 5.25e-06  1.21e-04    16s
  54   2.74156644e+04  2.74248333e+04  6.89e-07 3.15e-06  2.11e-05    16s
  55   2.74187687e+04  2.74197226e+04  7.15e-08 4.09e-07  2.19e-06    17s
  56   2.74192351e+04  2.74192369e+04  8.06e-10 3.00e-09  4.03e-09    17s
  57   2.74192361e+04  2.74192363e+04  4.20e-08 5.91e-11  5.32e-10    17s

Barrier solved model in 57 iterations and 16.81 seconds (25.66 work units)
Optimal objective 2.74192361e+04


Root crossover log...

  214832 DPushes remaining with DInf 0.0000000e+00                17s
   55062 DPushes remaining with DInf 0.0000000e+00                20s
    1119 DPushes remaining with DInf 0.0000000e+00                25s
       0 DPushes remaining with DInf 0.0000000e+00                26s

   23598 PPushes remaining with PInf 1.7659930e-04                26s
       0 PPushes remaining with PInf 0.0000000e+00                27s

  Push phase complete: Pinf 0.0000000e+00, Dinf 6.9300534e+03     27s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
  124785    2.7419236e+04   0.000000e+00   6.930053e+03     27s
  124929    2.7419236e+04   0.000000e+00   0.000000e+00     27s
  124929    2.7419236e+04   0.000000e+00   0.000000e+00     27s
Concurrent spin time: 0.03s

Solved with barrier

Root relaxation: objective 2.741924e+04, 124929 iterations, 20.44 seconds (40.10 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 27419.2363    0  136 -219438.19 27419.2363   112%     -   28s
H    0     0                    -135635.8777 27419.2363   120%     -   29s
H    0     0                    -133149.8416 27419.2363   121%     -   29s
H    0     0                    -131511.6849 27419.2363   121%     -   29s
H    0     0                    -130701.8354 27419.2363   121%     -   30s
H    0     0                    -130503.1432 27419.2363   121%     -   30s
H    0     0                    -71394.31792 27419.2363   138%     -   30s
H    0     0                    -18532.12258 27419.2363   248%     -   31s
H    0     0                    -3243.297348 27419.2363   945%     -   31s
H    0     0                    -2897.617993 27419.2363  1046%     -   31s
H    0     0                    -2271.500361 27419.2363  1307%     -   32s
H    0     0                    -2237.542465 27419.2363  1325%     -   32s
H    0     0                    -1522.080106 27419.2363  1901%     -   32s
H    0     0                    -1378.478021 27419.2363  2089%     -   32s
     0     0 22486.8604    0  231 -1378.4780 22486.8604  1731%     -   79s
H    0     0                    -1282.052975 22485.9669  1854%     -   81s
     0     0 22122.1616    0  240 -1282.0530 22122.1616  1826%     -  103s
     0     0 22103.0355    0  249 -1282.0530 22103.0355  1824%     -  107s
     0     0 22058.5490    0  273 -1282.0530 22058.5490  1821%     -  115s
     0     0 22051.8094    0  273 -1282.0530 22051.8094  1820%     -  118s
     0     0 22050.6132    0  273 -1282.0530 22050.6132  1820%     -  120s
     0     0 22043.3843    0  279 -1282.0530 22043.3843  1819%     -  123s
     0     0 22043.0674    0  279 -1282.0530 22043.0674  1819%     -  125s
     0     0 18898.7360    0  250 -1282.0530 18898.7360  1574%     -  187s
     0     0 18290.3820    0  260 -1282.0530 18290.3820  1527%     -  218s
     0     0 18263.4149    0  258 -1282.0530 18263.4149  1525%     -  228s
     0     0 18163.6229    0  238 -1282.0530 18163.6229  1517%     -  242s
     0     0 18013.9591    0  254 -1282.0530 18013.9591  1505%     -  254s
     0     0 18007.1521    0  256 -1282.0530 18007.1521  1505%     -  258s
     0     0 18005.9451    0  258 -1282.0530 18005.9451  1504%     -  260s
     0     0 17727.1833    0  271 -1282.0530 17727.1833  1483%     -  273s
     0     0 17703.8290    0  267 -1282.0530 17703.8290  1481%     -  281s
     0     0 17513.8436    0  279 -1282.0530 17513.8436  1466%     -  300s
     0     0 17425.6893    0  257 -1282.0530 17425.6893  1459%     -  316s
     0     0 17392.8368    0  285 -1282.0530 17392.8368  1457%     -  325s
     0     0 17214.2987    0  273 -1282.0530 17214.2987  1443%     -  341s
     0     0 17177.1324    0  331 -1282.0530 17177.1324  1440%     -  351s
     0     0 17170.2756    0  291 -1282.0530 17170.2756  1439%     -  353s
     0     0 17162.1082    0  289 -1282.0530 17162.1082  1439%     -  358s
     0     0 17159.6708    0  291 -1282.0530 17159.6708  1438%     -  363s
     0     0 17159.6362    0  291 -1282.0530 17159.6362  1438%     -  364s
     0     0 14331.7493    0  387 -1282.0530 14331.7493  1218%     -  476s
     0     0 13729.7278    0  390 -1282.0530 13729.7278  1171%     -  514s
     0     0 13613.6304    0  327 -1282.0530 13613.6304  1162%     -  532s
     0     0 13497.0098    0  414 -1282.0530 13497.0098  1153%     -  546s
     0     0 13472.9231    0  419 -1282.0530 13472.9231  1151%     -  553s
     0     0 13452.9793    0  412 -1282.0530 13452.9793  1149%     -  563s
     0     0 13360.4399    0  413 -1282.0530 13360.4399  1142%     -  572s
     0     0 13350.0351    0  410 -1282.0530 13350.0351  1141%     -  577s
     0     0 13345.2667    0  415 -1282.0530 13345.2667  1141%     -  581s
     0     0 13333.9468    0  417 -1282.0530 13333.9468  1140%     -  587s
     0     0 13331.0853    0  419 -1282.0530 13331.0853  1140%     -  589s
     0     0 13330.3626    0  420 -1282.0530 13330.3626  1140%     -  592s
     0     0 12251.8669    0  318 -1282.0530 12251.8669  1056%     -  650s
     0     0 12031.4930    0  424 -1282.0530 12031.4930  1038%     -  686s
     0     0 11747.1328    0  427 -1282.0530 11747.1328  1016%     -  722s
     0     0 11546.1233    0  435 -1282.0530 11546.1233  1001%     -  755s
     0     0 11505.3238    0  474 -1282.0530 11505.3238   997%     -  770s
     0     0 11449.0052    0  483 -1282.0530 11449.0052   993%     -  785s
     0     0 11440.4694    0  480 -1282.0530 11440.4694   992%     -  793s
     0     0 11407.5298    0  481 -1282.0530 11407.5298   990%     -  801s
     0     0 11394.3941    0  483 -1282.0530 11394.3941   989%     -  806s
     0     0 11380.5838    0  474 -1282.0530 11380.5838   988%     -  811s
     0     0 11369.9207    0  480 -1282.0530 11369.9207   987%     -  814s
     0     0 11367.0414    0  479 -1282.0530 11367.0414   987%     -  818s
     0     0 11363.2161    0  485 -1282.0530 11363.2161   986%     -  819s
     0     0 11362.7649    0  487 -1282.0530 11362.7649   986%     -  820s
     0     0 11093.5369    0  419 -1282.0530 11093.5369   965%     -  855s
     0     0 10937.0840    0  555 -1282.0530 10937.0840   953%     -  890s
     0     0 10860.7742    0  435 -1282.0530 10860.7742   947%     -  904s
     0     0 10839.2735    0  441 -1282.0530 10839.2735   945%     -  912s
     0     0 10834.4831    0  441 -1282.0530 10834.4831   945%     -  918s
     0     0 10827.0907    0  453 -1282.0530 10827.0907   945%     -  926s
     0     0 10823.7092    0  446 -1282.0530 10823.7092   944%     -  931s
     0     0 10818.9113    0  446 -1282.0530 10818.9113   944%     -  937s
     0     0 10810.0855    0  439 -1282.0530 10810.0855   943%     -  944s
     0     0 10804.3698    0  411 -1282.0530 10804.3698   943%     -  949s
     0     0 10799.2598    0  441 -1282.0530 10799.2598   942%     -  954s
     0     0 10797.9182    0  444 -1282.0530 10797.9182   942%     -  956s
     0     0 10731.3804    0  485 -1282.0530 10731.3804   937%     -  977s
H    0     0                    -1219.731006 10731.3305   980%     -  997s
     0     0 10675.9430    0  496 -1219.7310 10675.9430   975%     - 1020s
     0     0 10645.2275    0  484 -1219.7310 10645.2275   973%     - 1034s
     0     0 10633.8711    0  552 -1219.7310 10633.8711   972%     - 1044s
     0     0 10620.8207    0  503 -1219.7310 10620.8207   971%     - 1051s
     0     0 10616.7838    0  569 -1219.7310 10616.7838   970%     - 1058s
     0     0 10613.3518    0  562 -1219.7310 10613.3518   970%     - 1063s
     0     0 10611.0619    0  562 -1219.7310 10611.0619   970%     - 1069s
     0     0 10608.4599    0  564 -1219.7310 10608.4599   970%     - 1073s
     0     0 10604.6783    0  500 -1219.7310 10604.6783   969%     - 1076s
     0     0 10604.3438    0  507 -1219.7310 10604.3438   969%     - 1078s
     0     0 10542.9308    0  535 -1219.7310 10542.9308   964%     - 1111s
     0     0 10523.0899    0  509 -1219.7310 10523.0899   963%     - 1125s
     0     0 10517.3774    0  499 -1219.7310 10517.3774   962%     - 1131s
     0     0 10512.3291    0  508 -1219.7310 10512.3291   962%     - 1138s
     0     0 10511.5280    0  504 -1219.7310 10511.5280   962%     - 1143s
     0     0 10452.7260    0  500 -1219.7310 10452.7260   957%     - 1159s
H    0     0                    -1200.380362 10452.0996   971%     - 1193s
     0     0 10432.6258    0  539 -1200.3804 10432.6258   969%     - 1205s
     0     0 10421.4662    0  492 -1200.3804 10421.4662   968%     - 1216s
     0     0 10417.6341    0  504 -1200.3804 10417.6341   968%     - 1221s
     0     0 10414.6112    0  506 -1200.3804 10414.6112   968%     - 1225s
     0     0 10413.6256    0  513 -1200.3804 10413.6256   968%     - 1227s
     0     0 10398.0742    0  469 -1200.3804 10398.0742   966%     - 1238s
     0     0 10395.4569    0  541 -1200.3804 10395.4569   966%     - 1247s
     0     0 10393.6769    0  555 -1200.3804 10393.6769   966%     - 1250s
     0     0 10382.6011    0  553 -1200.3804 10382.6011   965%     - 1261s
     0     0 10376.7947    0  370 -1200.3804 10376.7947   964%     - 1296s
     0     0 10375.5118    0  541 -1200.3804 10375.5118   964%     - 1302s
     0     0 10369.6943    0  540 -1200.3804 10369.6943   964%     - 1310s
     0     0 10367.0801    0  519 -1200.3804 10367.0801   964%     - 1316s
     0     0 10366.2886    0  524 -1200.3804 10366.2886   964%     - 1318s
     0     0 10362.5391    0  373 -1200.3804 10362.5391   963%     - 1326s
     0     0 10361.2927    0  521 -1200.3804 10361.2927   963%     - 1332s
     0     0 10357.9599    0  504 -1200.3804 10357.9599   963%     - 1339s
     0     0 10357.7661    0  504 -1200.3804 10357.7661   963%     - 1348s
     0     2 10357.7661    0  504 -1200.3804 10357.7661   963%     - 1540s
     1     3 9881.93464    1  468 -1200.3804 10357.6797   963% 33618 1584s
     2     4 10241.7305    1  399 -1200.3804 10241.7305   953% 23220 1602s
     3     5 9289.71744    2  402 -1200.3804 10239.6537   953% 23803 1641s
     4     8 10099.6183    2  357 -1200.3804 10237.6796   953% 20922 1675s
     7    15 9905.47049    3  380 -1200.3804 10099.3468   941% 19784 1711s
    14    30 9162.91216    4  522 -1200.3804 10099.3468   941% 24126 1746s
    29    45 8892.71258    5  490 -1200.3804 9382.84808   882% 29139 1855s
    44    71 8317.48028    6  381 -1200.3804 9382.84808   882% 33138 2142s
H   48    71                    -1183.644567 9382.84808   893% 32519 2142s
    70   111 8205.16943    7  382 -1183.6446 9196.21461   877% 31244 2220s
   110   186 6859.55871    9  255 -1183.6446 9038.09175   864% 28986 2293s
   189   231 6632.40689   11  256 -1183.6446 9038.09175   864% 19740 2360s
   238   279 8071.60052   10  467 -1183.6446 9038.09175   864% 18369 2417s
   291   317 3365.94042   12  260 -1183.6446 9038.09175   864% 17587 2494s
   345   327 7151.44527   13  419 -1183.6446 9038.09175   864% 17018 2547s
   370   343 6635.05937   11  256 -1183.6446 9038.09175   864% 17021 2600s
   404   365 2841.55321   15  187 -1183.6446 9038.09175   864% 17242 2668s
   434   392 2450.27140   16  202 -1183.6446 9038.09175   864% 17405 2718s
   481   445 1817.28502   21  148 -1183.6446 9038.09175   864% 17027 2764s
   556   471 1428.15217   26  112 -1183.6446 9038.09175   864% 16234 2809s
   636   518  913.60726   31   73 -1183.6446 9038.09175   864% 15358 2850s
   710   563  541.65806   36   59 -1183.6446 9038.09175   864% 14654 2892s
   779   590  -37.45566   41   49 -1183.6446 9038.09175   864% 14163 2930s
   846   603 -1132.2394   41   37 -1183.6446 9038.09175   864% 13723 3066s
   902   624 4423.64131   25  316 -1183.6446 9038.09175   864% 13520 3104s
   967   646 4227.79757   27  417 -1183.6446 9038.09175   864% 13216 3152s
  1041   706 4029.21945   28  340 -1183.6446 9038.09175   864% 13052 3188s
  1139   745 3582.80309   32  336 -1183.6446 9038.09175   864% 12603 3231s
  1241   807 3157.48797   36  391 -1183.6446 9038.09175   864% 12281 3275s
  1351   905 2670.56831   43  378 -1183.6446 9038.09175   864% 12034 3322s
  1469  1031 1686.71264   49  250 -1183.6446 9038.09175   864% 11746 3368s
  1632  1197  732.97208   59  147 -1183.6446 9038.09175   864% 11267 3410s
  1847  1367 -615.62214   70  140 -1183.6446 9038.09175   864% 10540 3456s
  2104  1514 infeasible   80      -1183.6446 9038.09175   864%  9766 3500s
  2370  1632 5047.72389   18  227 -1183.6446 9038.09175   864%  9119 3549s
  2608  1707 6902.47492   14  502 -1183.6446 9038.09175   864%  8700 3597s
  2852  1700 -298.54025   87  112 -1183.6446 9038.09175   864%  8366 3600s

Cutting planes:
  Learned: 2
  Gomory: 16
  Implied bound: 391
  MIR: 5419
  Flow cover: 5654
  RLT: 63
  Relax-and-lift: 1124

Explored 2869 nodes (25196025 simplex iterations) in 3600.06 seconds (8589.53 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -1183.64 -1200.38 -1219.73 ... -18532.1

Time limit reached
Best objective -1.183644567249e+03, best bound 9.038091752899e+03, gap 863.5816%
  WARNING: Time limit reached. Using best solution found (gap: 863.58%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = -1183.64, θ = 141255.85
  Upper Bound (UB) = -1183.64

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 141255.85
  [DEBUG]   ✓ Scenario 0: θ = 141255.85 ≤ Q = 141255.85 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 141255.85 ≤ Q = 141255.85 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 141255.85 ≤ Q = 141255.85 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 141255.85 ≤ Q = 141255.85 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 141255.85 ≤ Q = 141255.85 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 141255.85 ≤ Q = 141721.87 (slack: 466.02)
  [DEBUG]   ✓ Scenario 6: θ = 141255.85 ≤ Q = 141255.85 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 141255.85 ≤ Q = 141255.85 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 141255.85 ≤ Q = 141255.85 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 141255.85 ≤ Q = 141255.85 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 141255.85 ≤ Q = 141255.85 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 141255.85 ≤ Q = 141255.85 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 141255.85 ≤ Q = 141255.85 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 141255.85 ≤ Q = 141255.85 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 141255.85 ≤ Q = 141301.64 (slack: 45.79)
  [DEBUG]   ✓ Scenario 15: θ = 141255.85 ≤ Q = 141255.85 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 141255.85 ≤ Q = 141255.85 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 141255.85 ≤ Q = 141255.85 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 141255.85 ≤ Q = 141255.85 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 141255.85 ≤ Q = 141255.85 (slack: -0.00)
  [DEBUG]   ✓ Scenario 20: θ = 141255.85 ≤ Q = 141255.85 (slack: -0.00)
  [DEBUG]   ✓ Scenario 21: θ = 141255.85 ≤ Q = 141255.85 (slack: -0.00)
  [DEBUG]   ✓ Scenario 22: θ = 141255.85 ≤ Q = 141255.85 (slack: -0.00)
  [DEBUG]   ✓ Scenario 23: θ = 141255.85 ≤ Q = 141255.85 (slack: -0.00)
  [DEBUG]   ✓ Scenario 24: θ = 141255.85 ≤ Q = 141255.85 (slack: -0.00)
  [DEBUG]   ✓ Scenario 25: θ = 141255.85 ≤ Q = 142125.01 (slack: 869.16)
  [DEBUG]   ✓ Scenario 26: θ = 141255.85 ≤ Q = 141255.85 (slack: 0.00)
  [DEBUG]   ✓ Scenario 27: θ = 141255.85 ≤ Q = 141255.85 (slack: 0.00)
  [DEBUG]   ✓ Scenario 28: θ = 141255.85 ≤ Q = 141255.85 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 29] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x36702a4e
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xc98fd5b2
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.153573e+13
Presolve removed 2598 rows and 1890 columns
Presolve time: 0.00s
Presolved: 495 rows, 499 columns, 1396 nonzeros
Found heuristic solution: objective 5711654.4543
Variable types: 339 continuous, 160 integer (160 binary)

Root relaxation: objective -1.296511e+05, 244 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -129651.05    0  123 5711654.45 -129651.05   102%     -    0s
H    0     0                    -97353.68772 -129651.05  33.2%     -    0s
H    0     0                    -97971.26669 -129651.05  32.3%     -    0s
     0     0 -103094.83    0   34 -97971.267 -103094.83  5.23%     -    0s
H    0     0                    -100938.7623 -103012.82  2.05%     -    0s
H    0     0                    -101868.6418 -103012.82  1.12%     -    0s
H    0     0                    -102184.1921 -103012.82  0.81%     -    0s
     0     0 -102707.99    0   34 -102184.19 -102707.99  0.51%     -    0s
     0     0 -102563.76    0   26 -102184.19 -102563.76  0.37%     -    0s
H    0     0                    -102239.1857 -102563.76  0.32%     -    0s
     0     0 -102557.65    0   26 -102239.19 -102557.65  0.31%     -    0s
     0     0 -102543.07    0   24 -102239.19 -102543.07  0.30%     -    0s
     0     0 -102526.93    0   22 -102239.19 -102526.93  0.28%     -    0s
     0     0 -102526.75    0   21 -102239.19 -102526.75  0.28%     -    0s
     0     0 -102377.27    0   10 -102239.19 -102377.27  0.14%     -    0s
     0     0 -102377.27    0   30 -102239.19 -102377.27  0.14%     -    0s
     0     0 -102284.96    0    6 -102239.19 -102284.96  0.04%     -    0s
H    0     0                    -102281.9134 -102281.91  0.00%     -    0s

Cutting planes:
  Gomory: 2
  Implied bound: 1
  MIR: 24
  Flow cover: 6

Explored 1 nodes (574 simplex iterations) in 0.08 seconds (0.03 work units)
Thread count was 32 (of 256 available processors)

Solution count 9: -102282 -102239 -102184 ... 1.15357e+13
No other solutions better than -102282

Optimal solution found (tolerance 1.00e-04)
Best objective -1.022819134347e+05, best bound -1.022819134347e+05, gap 0.0000%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 139178.50
  Scenario: 10 demand increases, 50 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -102281.91
  [DEBUG]   S×d_nominal = 241460.42
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 241460.42 + -102281.91 = 139178.50
  [DEBUG]   Current θ from Master = 141255.85
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2077.35 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -3260.99
  Lower Bound (LB) = -1589.09
  Gap (UB-LB) = 405.4446, Absolute Gap = 405.4446, Relative Gap = 0.342539
  Not converged yet (gap = 405.44 > ε = 200)

  [DEBUG] Adding NEW scenario 29 to Master Problem...
  [DEBUG] New scenario pattern: 10 increases, 50 decreases
    [DEBUG] Scenario 29 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 29 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 29]
    [DEBUG]   - Total constraints in model: 460083
    [DEBUG]   - Total variables in model: 189460
  [DEBUG] Total scenarios in Master: 30
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 30
================================================================================
[Iteration 30] Solving Master Problem...
  Current scenarios in Master: 30
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 460083 rows, 189460 columns and 1302449 nonzeros
Model fingerprint: 0x55ddf2c1
Variable types: 187201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 212100 rows and 86100 columns (presolve time = 5s)...
Presolve removed 212100 rows and 86100 columns
Presolve time: 5.41s
Presolved: 247983 rows, 103360 columns, 1527357 nonzeros
Variable types: 101101 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -372861.2647
Found heuristic solution: objective -219438.1934

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 2.39s

Barrier statistics:
 Dense cols : 1242
 AA' NZ     : 6.793e+06
 Factor NZ  : 1.848e+07 (roughly 300 MB of memory)
 Factor Ops : 7.761e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.88878273e+07  3.63795343e+08  1.07e+05 1.35e+01  7.44e+04    10s
   1  -1.48008465e+07  3.21487490e+08  7.67e+04 4.88e+01  5.32e+04    10s
   2  -5.55097581e+06  2.63433731e+08  2.95e+04 1.24e+01  2.10e+04    10s
   3  -1.11727799e+06  2.40975317e+08  2.87e+03 1.25e+01  2.52e+03    10s
   4  -6.29437517e+05  1.90316910e+08  6.27e+02 8.02e+00  8.40e+02    10s
   5  -5.53396978e+05  1.03625620e+08  3.37e+02 3.68e+00  4.31e+02    10s
   6  -4.93089337e+05  8.28531338e+07  1.70e+02 2.78e+00  2.81e+02    10s
   7  -4.56632476e+05  6.45014439e+07  9.83e+01 2.00e+00  1.96e+02    11s
   8  -4.18434611e+05  4.97673113e+07  5.34e+01 1.38e+00  1.37e+02    11s
   9  -3.48882198e+05  3.26102307e+07  1.55e+01 2.54e-01  7.93e+01    11s
  10  -2.36524186e+05  1.83868654e+07  3.00e+00 1.27e-01  4.22e+01    11s
  11  -1.98442330e+05  1.06069578e+07  2.02e+00 1.86e-02  2.43e+01    11s
  12  -1.64093448e+05  7.95723151e+06  1.39e+00 1.38e-02  1.82e+01    11s
  13  -1.49513953e+05  7.34473365e+06  1.13e+00 1.27e-02  1.68e+01    11s
  14  -1.31901348e+05  5.72761173e+06  7.75e-01 9.83e-03  1.31e+01    11s
  15  -1.14540182e+05  4.41947382e+06  4.27e-01 7.77e-03  1.01e+01    11s
  16  -8.18764495e+04  2.48247467e+06  1.29e-01 4.21e-03  5.70e+00    11s
  17  -5.51380148e+04  4.88986031e+05  4.63e-02 8.18e-04  1.21e+00    11s
  18  -3.79785523e+04  2.58891662e+05  3.01e-02 2.75e-03  6.60e-01    11s
  19  -2.85363699e+04  2.01510336e+05  2.37e-02 3.77e-03  5.11e-01    12s
  20  -2.04198462e+04  1.68312384e+05  2.01e-02 1.08e-03  4.19e-01    12s
  21  -1.50476834e+04  1.40316933e+05  1.76e-02 7.30e-04  3.45e-01    12s
  22  -8.27056612e+03  1.15467677e+05  1.45e-02 7.11e-04  2.75e-01    12s
  23  -1.45785176e+03  8.68200283e+04  1.15e-02 1.13e-03  1.96e-01    12s
  24   3.07580634e+03  6.98112534e+04  9.48e-03 1.12e-03  1.48e-01    12s
  25   6.74673609e+03  5.72119889e+04  7.85e-03 1.15e-03  1.12e-01    12s
  26   1.04384005e+04  4.79193133e+04  6.22e-03 5.67e-03  8.33e-02    12s
  27   1.23918669e+04  4.49499024e+04  5.39e-03 5.41e-03  7.23e-02    12s
  28   1.51740873e+04  4.14746156e+04  4.25e-03 4.45e-03  5.84e-02    12s
  29   1.71447062e+04  3.71697317e+04  3.46e-03 3.22e-03  4.45e-02    12s
  30   1.87686701e+04  3.50547268e+04  2.86e-03 2.62e-03  3.62e-02    13s
  31   1.98820568e+04  3.42899876e+04  2.47e-03 2.38e-03  3.20e-02    13s
  32   2.02842369e+04  3.31593053e+04  2.32e-03 2.02e-03  2.86e-02    13s
  33   2.08884278e+04  3.24478213e+04  2.11e-03 1.79e-03  2.57e-02    13s
  34   2.22749596e+04  3.18555775e+04  1.63e-03 1.60e-03  2.13e-02    13s
  35   2.28317979e+04  3.11391385e+04  1.44e-03 1.35e-03  1.85e-02    13s
  36   2.32498491e+04  3.08185767e+04  1.30e-03 1.24e-03  1.68e-02    13s
  37   2.42841497e+04  3.00926664e+04  9.64e-04 9.78e-04  1.29e-02    13s
  38   2.45219938e+04  2.93201589e+04  8.86e-04 6.98e-04  1.07e-02    14s
  39   2.51862856e+04  2.85975431e+04  6.77e-04 4.50e-04  7.58e-03    14s
  40   2.59294436e+04  2.81756788e+04  4.47e-04 2.83e-04  4.99e-03    14s
  41   2.62639464e+04  2.78366698e+04  3.42e-04 2.67e-04  3.49e-03    14s
  42   2.63719355e+04  2.78024561e+04  3.10e-04 2.44e-04  3.18e-03    14s
  43   2.64438169e+04  2.77469510e+04  2.88e-04 2.21e-04  2.89e-03    14s
  44   2.67671759e+04  2.75575281e+04  1.92e-04 8.74e-05  1.76e-03    14s
  45   2.70446045e+04  2.74835431e+04  1.06e-04 3.41e-05  9.75e-04    14s
  46   2.71606382e+04  2.74589922e+04  7.26e-05 2.08e-05  6.63e-04    15s
  47   2.72443580e+04  2.74461448e+04  4.94e-05 1.44e-05  4.48e-04    15s
  48   2.72556352e+04  2.74397880e+04  4.60e-05 1.10e-05  4.09e-04    15s
  49   2.73432666e+04  2.74292617e+04  2.03e-05 4.95e-06  1.91e-04    15s
  50   2.74064730e+04  2.74224393e+04  2.53e-06 9.46e-07  3.54e-05    15s
  51   2.74144993e+04  2.74202006e+04  9.06e-07 2.62e-07  1.27e-05    15s
  52   2.74189013e+04  2.74198189e+04  6.34e-08 1.51e-07  2.04e-06    15s
  53   2.74192299e+04  2.74192391e+04  4.98e-09 1.88e-07  2.05e-08    15s
  54   2.74192306e+04  2.74192388e+04  3.17e-07 1.70e-07  1.84e-08    15s
  55   2.74192361e+04  2.74192363e+04  1.39e-08 1.27e-10  5.41e-10    15s

Barrier solved model in 55 iterations and 15.40 seconds (27.22 work units)
Optimal objective 2.74192361e+04


Root crossover log...

  222179 DPushes remaining with DInf 0.0000000e+00                15s
   49227 DPushes remaining with DInf 0.0000000e+00                20s
    3066 DPushes remaining with DInf 0.0000000e+00                25s
       0 DPushes remaining with DInf 0.0000000e+00                27s

   24808 PPushes remaining with PInf 2.0476230e-04                27s
       0 PPushes remaining with PInf 0.0000000e+00                28s

  Push phase complete: Pinf 0.0000000e+00, Dinf 9.3717709e+03     28s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
  129519    2.7419236e+04   0.000000e+00   9.371771e+03     28s
  129568    2.7419236e+04   0.000000e+00   0.000000e+00     29s
  129568    2.7419236e+04   0.000000e+00   0.000000e+00     29s
Concurrent spin time: 0.02s

Solved with barrier

Root relaxation: objective 2.741924e+04, 129568 iterations, 22.26 seconds (43.25 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 27419.2363    0  136 -219438.19 27419.2363   112%     -   30s
H    0     0                    -120409.8621 27419.2363   123%     -   31s
H    0     0                    -120265.9566 27419.2363   123%     -   31s
H    0     0                    -71394.31792 27419.2363   138%     -   31s
H    0     0                    -31641.09769 27419.2363   187%     -   32s
H    0     0                    -21644.84850 27419.2363   227%     -   32s
H    0     0                    -2351.287901 27419.2363  1266%     -   33s
H    0     0                    -2237.542465 27419.2363  1325%     -   33s
H    0     0                    -1522.080106 27419.2363  1901%     -   33s
H    0     0                    -1378.478021 27419.2363  2089%     -   33s
     0     0 21817.7405    0  243 -1378.4780 21817.7405  1683%     -   91s
H    0     0                    -1282.052975 21817.6568  1802%     -   92s
     0     0 21315.8716    0  249 -1282.0530 21315.8716  1763%     -  121s
     0     0 21251.2389    0  248 -1282.0530 21251.2389  1758%     -  130s
     0     0 21248.7291    0  245 -1282.0530 21248.7291  1757%     -  132s
     0     0 21248.1425    0  248 -1282.0530 21248.1425  1757%     -  132s
     0     0 18569.2432    0  236 -1282.0530 18569.2432  1548%     -  185s
     0     0 18248.0729    0  246 -1282.0530 18248.0729  1523%     -  214s
     0     0 18077.3774    0  251 -1282.0530 18077.3774  1510%     -  232s
     0     0 17960.0184    0  260 -1282.0530 17960.0184  1501%     -  244s
     0     0 17943.2461    0  263 -1282.0530 17943.2461  1500%     -  250s
     0     0 17905.7292    0  266 -1282.0530 17905.7292  1497%     -  255s
     0     0 17887.3775    0  260 -1282.0530 17887.3775  1495%     -  259s
     0     0 17885.0125    0  264 -1282.0530 17885.0125  1495%     -  262s
     0     0 17872.7061    0  263 -1282.0530 17872.7061  1494%     -  266s
     0     0 17870.5554    0  263 -1282.0530 17870.5554  1494%     -  269s
     0     0 17867.5338    0  266 -1282.0530 17867.5338  1494%     -  277s
     0     0 17865.9662    0  267 -1282.0530 17865.9662  1494%     -  279s
     0     0 17862.5947    0  267 -1282.0530 17862.5947  1493%     -  281s
     0     0 17855.2238    0  269 -1282.0530 17855.2238  1493%     -  288s
     0     0 17839.7948    0  268 -1282.0530 17839.7948  1492%     -  295s
     0     0 17824.4185    0  261 -1282.0530 17824.4185  1490%     -  300s
     0     0 17785.4573    0  257 -1282.0530 17785.4573  1487%     -  306s
     0     0 17784.0556    0  262 -1282.0530 17784.0556  1487%     -  307s
     0     0 17783.6627    0  262 -1282.0530 17783.6627  1487%     -  308s
     0     0 14466.2596    0  350 -1282.0530 14466.2596  1228%     -  406s
     0     0 13923.8531    0  364 -1282.0530 13923.8531  1186%     -  444s
     0     0 13811.9466    0  368 -1282.0530 13811.9466  1177%     -  461s
     0     0 13750.0528    0  415 -1282.0530 13750.0528  1173%     -  472s
     0     0 13639.8881    0  359 -1282.0530 13639.8881  1164%     -  483s
     0     0 13582.3601    0  380 -1282.0530 13582.3601  1159%     -  495s
     0     0 13565.4113    0  379 -1282.0530 13565.4113  1158%     -  502s
     0     0 13517.2215    0  372 -1282.0530 13517.2215  1154%     -  513s
     0     0 13477.4322    0  418 -1282.0530 13477.4322  1151%     -  527s
     0     0 13466.6733    0  423 -1282.0530 13466.6733  1150%     -  535s
     0     0 13427.6726    0  425 -1282.0530 13427.6726  1147%     -  545s
     0     0 13417.2183    0  435 -1282.0530 13417.2183  1147%     -  551s
     0     0 13405.9580    0  392 -1282.0530 13405.9580  1146%     -  557s
     0     0 13400.4983    0  390 -1282.0530 13400.4983  1145%     -  560s
     0     0 13399.5533    0  400 -1282.0530 13399.5533  1145%     -  562s
     0     0 11941.4365    0  446 -1282.0530 11941.4365  1031%     -  634s
     0     0 11562.2271    0  453 -1282.0530 11562.2271  1002%     -  675s
     0     0 11430.6609    0  464 -1282.0530 11430.6609   992%     -  695s
     0     0 11376.8109    0  449 -1282.0530 11376.8109   987%     -  718s
     0     0 11342.9279    0  457 -1282.0530 11342.9279   985%     -  729s
     0     0 11325.6907    0  460 -1282.0530 11325.6907   983%     -  740s
     0     0 11295.7314    0  455 -1282.0530 11295.7314   981%     -  752s
     0     0 11281.2632    0  467 -1282.0530 11281.2632   980%     -  761s
     0     0 11279.8610    0  464 -1282.0530 11279.8610   980%     -  765s
     0     0 11028.0759    0  471 -1282.0530 11028.0759   960%     -  814s
     0     0 10963.5462    0  428 -1282.0530 10963.5462   955%     -  845s
     0     0 10916.0666    0  465 -1282.0530 10916.0666   951%     -  864s
     0     0 10903.8302    0  470 -1282.0530 10903.8302   950%     -  873s
     0     0 10898.5267    0  464 -1282.0530 10898.5267   950%     -  882s
     0     0 10897.2647    0  468 -1282.0530 10897.2647   950%     -  884s
     0     0 10771.6745    0  528 -1282.0530 10771.6745   940%     -  926s
H    0     0                    -1203.373779 10771.4045   995%     -  947s
     0     0 10718.3631    0  521 -1203.3738 10718.3631   991%     -  972s
     0     0 10690.9619    0  572 -1203.3738 10690.9619   988%     -  988s
     0     0 10683.4207    0  575 -1203.3738 10683.4207   988%     -  996s
     0     0 10674.4981    0  616 -1203.3738 10674.4981   987%     - 1005s
     0     0 10668.5444    0  576 -1203.3738 10668.5444   987%     - 1010s
     0     0 10664.5644    0  581 -1203.3738 10664.5644   986%     - 1014s
     0     0 10663.9394    0  584 -1203.3738 10663.9394   986%     - 1016s
     0     0 10602.3333    0  492 -1203.3738 10602.3333   981%     - 1045s
     0     0 10583.4698    0  480 -1203.3738 10583.4698   979%     - 1062s
     0     0 10573.3527    0  455 -1203.3738 10573.3527   979%     - 1072s
     0     0 10567.7722    0  464 -1203.3738 10567.7722   978%     - 1083s
     0     0 10563.8979    0  415 -1203.3738 10563.8979   978%     - 1091s
     0     0 10560.2716    0  414 -1203.3738 10560.2716   978%     - 1095s
     0     0 10557.7462    0  470 -1203.3738 10557.7462   977%     - 1100s
     0     0 10557.6155    0  470 -1203.3738 10557.6155   977%     - 1101s
     0     0 10511.7723    0  462 -1203.3738 10511.7723   974%     - 1119s
H    0     0                    -1200.380362 10511.1511   976%     - 1144s
     0     0 10470.0867    0  416 -1200.3804 10470.0867   972%     - 1160s
     0     0 10464.8399    0  424 -1200.3804 10464.8399   972%     - 1168s
     0     0 10458.1457    0  425 -1200.3804 10458.1457   971%     - 1175s
     0     0 10453.4474    0  350 -1200.3804 10453.4474   971%     - 1182s
     0     0 10449.9624    0  420 -1200.3804 10449.9624   971%     - 1185s
     0     0 10448.6447    0  428 -1200.3804 10448.6447   970%     - 1191s
     0     0 10425.7924    0  518 -1200.3804 10425.7924   969%     - 1216s
     0     0 10408.0272    0  513 -1200.3804 10408.0272   967%     - 1227s
     0     0 10399.5547    0  484 -1200.3804 10399.5547   966%     - 1236s
     0     0 10396.8100    0  472 -1200.3804 10396.8100   966%     - 1239s
     0     0 10395.8779    0  474 -1200.3804 10395.8779   966%     - 1241s
     0     0 10354.3989    0  525 -1200.3804 10354.3989   963%     - 1257s
     0     0 10347.2012    0  560 -1200.3804 10347.2012   962%     - 1285s
     0     0 10344.7659    0  506 -1200.3804 10344.7659   962%     - 1288s
     0     0 10344.0415    0  464 -1200.3804 10344.0415   962%     - 1290s
     0     0 10338.5250    0  563 -1200.3804 10338.5250   961%     - 1298s
     0     0 10336.5115    0  484 -1200.3804 10336.5115   961%     - 1302s
     0     0 10332.3245    0  432 -1200.3804 10332.3245   961%     - 1311s
     0     0 10328.4608    0  524 -1200.3804 10328.4608   960%     - 1316s
     0     0 10326.7890    0  421 -1200.3804 10326.7890   960%     - 1320s
     0     0 10319.7876    0  427 -1200.3804 10319.7876   960%     - 1327s
     0     0 10319.1037    0  438 -1200.3804 10319.1037   960%     - 1332s
     0     0 10318.5166    0  434 -1200.3804 10318.5166   960%     - 1337s
     0     0 10318.2295    0  434 -1200.3804 10318.2295   960%     - 1347s
     0     2 10318.2171    0  434 -1200.3804 10318.2171   960%     - 1560s
     1     3 10168.9459    1  480 -1200.3804 10317.1773   959% 18333 1581s
     2     4 10276.1096    1  345 -1200.3804 10276.1096   956% 17162 1600s
     3     5 9915.65652    2  474 -1200.3804 10276.1027   956% 16149 1619s
     4     6 8914.49110    2  402 -1200.3804 10276.1027   956% 15294 1646s
     5    12 8788.04798    3  393 -1200.3804 10276.1027   956% 14886 1668s
    11    21 9380.91366    3  410 -1200.3804 9974.89842   931% 13815 1730s
    20    30 7596.33545    4  545 -1200.3804 9380.87969   881% 32386 1858s
    29    57 7498.77886    5  533 -1200.3804 9380.87969   881% 31495 2304s
    56    89 7150.40585    6  423 -1200.3804 9380.87094   881% 43141 2640s
    88   204 6855.66823    7  416 -1200.3804 9380.87094   881% 36997 2783s
   203   294 6447.67644   11  414 -1200.3804 9380.87094   881% 22943 2858s
   293   369 6415.21484   13  406 -1200.3804 9380.87094   881% 19271 2912s
   368   432 5583.03363   16  376 -1200.3804 9380.87094   881% 17824 2960s
   435   492 5443.61137   17  379 -1200.3804 9380.87094   881% 16660 3006s
   505   575 6963.54336   17  327 -1200.3804 9380.87094   881% 15824 3051s
   588   602 6926.10588   18  283 -1200.3804 9380.87094   881% 15083 3086s
   617   630  789.83091   16  217 -1200.3804 9380.87094   881% 14808 3120s
   645   669  533.82615   17  220 -1200.3804 9380.87094   881% 14539 3152s
   686   705  479.88497   20  214 -1200.3804 9380.87094   881% 14334 3186s
   728   749  110.39417   22  189 -1200.3804 9380.87094   881% 14070 3216s
   772   785  -62.20941   25  173 -1200.3804 9380.87094   881% 13743 3245s
   818   821  -80.56637   26  180 -1200.3804 9380.87094   881% 13632 3276s
   866   843 -687.82956   30  161 -1200.3804 9380.87094   881% 13390 3313s
   913   871     cutoff   32      -1200.3804 9380.87094   881% 13338 3350s
   951   911 4403.79209   21  433 -1200.3804 9380.87094   881% 13514 3387s
   999   947 4240.67734   24  374 -1200.3804 9380.87094   881% 13547 3428s
  1053   984 4043.98973   27  364 -1200.3804 9380.87094   881% 13394 3463s
  1115  1019 3654.45207   33  348 -1200.3804 9380.87094   881% 13145 3506s
  1172  1062 -274.67685   35  119 -1200.3804 9380.87094   881% 13073 3553s
  1219  1113 2919.45852   36  393 -1200.3804 9380.87094   881% 13190 3600s

Cutting planes:
  Gomory: 9
  Implied bound: 447
  MIR: 4964
  Flow cover: 5310
  RLT: 68
  Relax-and-lift: 1066

Explored 1282 nodes (18045807 simplex iterations) in 3600.05 seconds (9022.25 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -1200.38 -1203.37 -1282.05 ... -71394.3

Time limit reached
Best objective -1.200380361748e+03, best bound 9.380870938861e+03, gap 881.4915%
  WARNING: Time limit reached. Using best solution found (gap: 881.49%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = -1200.38, θ = 142668.29
  Upper Bound (UB) = -1200.38

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 142668.29
  [DEBUG]   ✓ Scenario 0: θ = 142668.29 ≤ Q = 142668.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 142668.29 ≤ Q = 142668.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 142668.29 ≤ Q = 142668.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 142668.29 ≤ Q = 142668.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 142668.29 ≤ Q = 142668.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 142668.29 ≤ Q = 142668.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 142668.29 ≤ Q = 142668.29 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 142668.29 ≤ Q = 142668.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 142668.29 ≤ Q = 142668.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 142668.29 ≤ Q = 142668.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 142668.29 ≤ Q = 142668.29 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 142668.29 ≤ Q = 142668.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 142668.29 ≤ Q = 142668.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 142668.29 ≤ Q = 142668.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 142668.29 ≤ Q = 142668.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 142668.29 ≤ Q = 142668.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 142668.29 ≤ Q = 142668.29 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 142668.29 ≤ Q = 142668.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 142668.29 ≤ Q = 142668.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 142668.29 ≤ Q = 142668.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 20: θ = 142668.29 ≤ Q = 142668.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 21: θ = 142668.29 ≤ Q = 142668.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 22: θ = 142668.29 ≤ Q = 142668.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 23: θ = 142668.29 ≤ Q = 142668.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 24: θ = 142668.29 ≤ Q = 142668.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 25: θ = 142668.29 ≤ Q = 142668.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 26: θ = 142668.29 ≤ Q = 142668.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 27: θ = 142668.29 ≤ Q = 142668.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 28: θ = 142668.29 ≤ Q = 142668.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 29: θ = 142668.29 ≤ Q = 142668.29 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 30] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x5bb9d5ab
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x5bb9d5ab
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [7e-13, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [5e-01, 2e+02]
Found heuristic solution: objective 1.152079e+13
Presolve removed 2598 rows and 1890 columns
Presolve time: 0.00s
Presolved: 495 rows, 499 columns, 1396 nonzeros
Found heuristic solution: objective 5716257.5738
Variable types: 339 continuous, 160 integer (160 binary)

Root relaxation: objective -1.280594e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -128059.41    0  123 5716257.57 -128059.41   102%     -    0s
H    0     0                    -95773.95199 -128059.41  33.7%     -    0s
H    0     0                    -96391.53096 -128059.41  32.9%     -    0s
     0     0 -99213.249    0   24 -96391.531 -99213.249  2.93%     -    0s
H    0     0                    -97858.86232 -99106.982  1.28%     -    0s
     0     0 -98851.515    0   24 -97858.862 -98851.515  1.01%     -    0s
H    0     0                    -98089.64223 -98844.878  0.77%     -    0s
H    0     0                    -98446.77033 -98844.878  0.40%     -    0s
H    0     0                    -98462.02758 -98835.842  0.38%     -    0s
     0     0 -98835.842    0   18 -98462.028 -98835.842  0.38%     -    0s
H    0     0                    -98527.51043 -98833.946  0.31%     -    0s
H    0     0                    -98674.51231 -98833.946  0.16%     -    0s
     0     0 -98823.942    0   20 -98674.512 -98823.942  0.15%     -    0s
     0     0 -98820.671    0   18 -98674.512 -98820.671  0.15%     -    0s
     0     0 -98820.671    0   30 -98674.512 -98820.671  0.15%     -    0s
     0     0 -98820.671    0   30 -98674.512 -98820.671  0.15%     -    0s
     0     0 -98820.671    0   24 -98674.512 -98820.671  0.15%     -    0s
H    0     0                    -98682.84954 -98818.921  0.14%     -    0s
H    0     0                    -98708.01245 -98818.921  0.11%     -    0s
     0     0 -98818.921    0   18 -98708.012 -98818.921  0.11%     -    0s
*    0     0               0    -98807.05949 -98807.059  0.00%     -    0s

Cutting planes:
  Gomory: 12
  Implied bound: 1
  MIR: 35
  Flow cover: 1
  RLT: 8

Explored 1 nodes (577 simplex iterations) in 0.11 seconds (0.03 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -98807.1 -98708 -98682.8 ... -95774
No other solutions better than -98807.1

Optimal solution found (tolerance 1.00e-04)
Best objective -9.880705948818e+04, best bound -9.880705948818e+04, gap 0.0000%
  Subproblem solved in 0.12s
  Worst-case operational profit (Z_SP) = 142653.36
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -98807.06
  [DEBUG]   S×d_nominal = 241460.42
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 241460.42 + -98807.06 = 142653.36
  [DEBUG]   Current θ from Master = 142668.29
  [DEBUG]   ⚠️  Z_SP ≤ θ by 14.93 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -1215.31
  Lower Bound (LB) = -1215.31
  Gap (UB-LB) = 14.9302, Absolute Gap = 14.9302, Relative Gap = 0.012438
  *** CONVERGED (gap within tolerance) ***

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 30
Total Time: 84078.25s
Converged: True
Final Lower Bound: -1215.3106
Final Upper Bound: -1200.3804
Final Gap: 14.930192
Number of Critical Scenarios: 30
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [2] (1/3)
Product 1 Plants: [1] (1/3)
Product 2 Plants: [1] (1/3)
Total Plant Openings: 3
DCs Opened: [1, 3, 7, 9] (4/10)
Active Routes (Plant→DC): 12
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 0 customers  Mode 1: 0 customers  Mode 2: 50 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 30
Start Time: 2026-01-04 19:51:40
End Time: 2026-01-05 19:12:58
Total Time: 84078.25s
Optimal Value: -1215.31
Lower Bound: -1215.31
Upper Bound: -1200.38
Gap: 14.930192
Plants Opened: {0: [2], 1: [1], 2: [1]} (3 plants)
DCs Opened: [1, 3, 7, 9] (4 DCs)
================================================================================

Results saved to: result/DH_single_full_seed28_MD_gamma20_20260105_191259.csv

Total Execution Time: 84078.81 seconds
End Time: 2026-01-05 19:12:59

All tasks completed successfully!

