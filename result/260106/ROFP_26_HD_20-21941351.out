
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 26
DI Scenario: HD
Start Time: 2026-01-04 12:31:03
================================================================================
Loading data from data/DH_data_full_seed26.pkl...

Applying DI scenario: HD
DI values:
  Product 0: ['1.000', '1.374', '1.888'] (k=0.784)
  Product 1: ['1.000', '1.468', '2.155'] (k=0.947)
  Product 2: ['1.000', '1.491', '2.223'] (k=0.985)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=1015, max=1762
  DC capacity (MC): min=419, max=830

Demand Structure (s_rk matrix):
  Total customer-product pairs: 80/150 (46.7% sparse)
  Average products per customer: 1.60

Demand (only non-zero entries):
  Nominal (μ): min=8.89, max=34.98, count=80
  Deviation (μ̂): min=4.07, max=9.87

Costs:
  Plant fixed cost: min=5727, max=9546
  DC fixed cost: min=3464, max=5845
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.374', '1.888'] (k=0.784)
    Product 1: ['1.000', '1.468', '2.155'] (k=0.947)
    Product 2: ['1.000', '1.491', '2.223'] (k=0.985)
  MD:
    Product 0: ['1.000', '1.174', '1.378'] (k=0.396)
    Product 1: ['1.000', '1.207', '1.456'] (k=0.463)
    Product 2: ['1.000', '1.190', '1.416'] (k=0.429)
  LD:
    Product 0: ['1.000', '1.097', '1.204'] (k=0.229)
    Product 1: ['1.000', '1.011', '1.023'] (k=0.028)
    Product 2: ['1.000', '1.006', '1.011'] (k=0.014)
  Mixed:
    Product 0: ['1.000', '1.374', '1.888'] (k=0.784)
    Product 1: ['1.000', '1.207', '1.456'] (k=0.463)
    Product 2: ['1.000', '1.006', '1.011'] (k=0.014)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48750 nonzeros
Model fingerprint: 0x4b12e962
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11871 rows and 2871 columns
Presolve time: 0.12s
Presolved: 4802 rows, 5629 columns, 33384 nonzeros
Variable types: 3370 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -251409.1255
Found heuristic solution: objective -192490.8375

Root relaxation: objective 1.407564e+05, 5849 iterations, 0.53 seconds (0.58 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 140756.450    0  649 -192490.84 140756.450   173%     -    0s
H    0     0                    -187673.8941 140756.450   175%     -    0s
     0     0 127666.846    0  805 -187673.89 127666.846   168%     -    2s
     0     0 127291.823    0  805 -187673.89 127291.823   168%     -    2s
     0     0 127273.282    0  801 -187673.89 127273.282   168%     -    2s
     0     0 127270.717    0  804 -187673.89 127270.717   168%     -    2s
     0     0 127270.651    0  804 -187673.89 127270.651   168%     -    2s
     0     0 93585.4491    0  493 -187673.89 93585.4491   150%     -    4s
     0     0 92654.7790    0  525 -187673.89 92654.7790   149%     -    4s
     0     0 92588.5620    0  554 -187673.89 92588.5620   149%     -    4s
     0     0 92561.2842    0  548 -187673.89 92561.2842   149%     -    4s
     0     0 92560.7154    0  551 -187673.89 92560.7154   149%     -    4s
H    0     0                    -173705.1134 80275.4488   146%     -    5s
     0     0 80275.4488    0  586 -173705.11 80275.4488   146%     -    6s
H    0     0                    -133266.4930 79444.0250   160%     -    6s
     0     0 79444.0250    0  604 -133266.49 79444.0250   160%     -    6s
H    0     0                    -103440.9963 79316.7641   177%     -    6s
H    0     0                    9401.1887190 79316.7641   744%     -    6s
     0     0 79316.7641    0  622 9401.18872 79316.7641   744%     -    6s
     0     0 79301.2324    0  622 9401.18872 79301.2324   744%     -    6s
H    0     0                    10292.908334 75313.0485   632%     -    8s
H    0     0                    11312.065205 75313.0485   566%     -    8s
H    0     0                    11337.453466 75313.0485   564%     -    8s
H    0     0                    11791.425626 75313.0485   539%     -    8s
H    0     0                    11792.908619 75313.0485   539%     -    8s
H    0     0                    20584.486945 75313.0485   266%     -    8s
     0     0 75313.0485    0  590 20584.4869 75313.0485   266%     -    8s
H    0     0                    21001.495746 74698.4367   256%     -    8s
H    0     0                    21936.248366 74698.4367   241%     -    8s
H    0     0                    22329.511621 74698.4367   235%     -    8s
H    0     0                    22380.578344 74698.4367   234%     -    8s
H    0     0                    22395.343708 74698.4367   234%     -    8s
H    0     0                    23326.208551 74698.4367   220%     -    8s
H    0     0                    23837.327709 74698.4367   213%     -    8s
H    0     0                    23897.119365 74698.4367   213%     -    8s
H    0     0                    24174.992252 74698.4367   209%     -    8s
     0     0 74698.4367    0  670 24174.9923 74698.4367   209%     -    8s
     0     0 74557.4576    0  664 24174.9923 74557.4576   208%     -    8s
     0     0 74490.2288    0  670 24174.9923 74490.2288   208%     -    9s
     0     0 74385.9875    0  688 24174.9923 74385.9875   208%     -    9s
     0     0 74353.4788    0  685 24174.9923 74353.4788   208%     -    9s
     0     0 74341.6304    0  699 24174.9923 74341.6304   208%     -    9s
     0     0 72885.1108    0  700 24174.9923 72885.1108   201%     -   10s
H    0     0                    24515.583945 72656.8181   196%     -   10s
H    0     0                    24524.724029 72656.8181   196%     -   10s
H    0     0                    25282.563084 72656.8181   187%     -   10s
H    0     0                    25337.051646 72656.8181   187%     -   10s
H    0     0                    25612.193792 72656.8181   184%     -   10s
H    0     0                    28548.541281 72656.8181   155%     -   10s
H    0     0                    28638.560694 72656.8181   154%     -   10s
H    0     0                    28756.721961 72656.8181   153%     -   10s
H    0     0                    30184.021377 72656.8181   141%     -   10s
H    0     0                    30606.255556 72656.8181   137%     -   10s
     0     0 72656.8181    0  724 30606.2556 72656.8181   137%     -   10s
H    0     0                    30955.458767 72536.1895   134%     -   10s
H    0     0                    31478.044075 72536.1895   130%     -   10s
H    0     0                    32101.426110 72536.1895   126%     -   10s
     0     0 72536.1895    0  692 32101.4261 72536.1895   126%     -   10s
     0     0 72508.1815    0  747 32101.4261 72508.1815   126%     -   11s
     0     0 71648.7921    0  705 32101.4261 71648.7921   123%     -   11s
     0     0 71377.6805    0  721 32101.4261 71377.6805   122%     -   12s
     0     0 71313.4196    0  784 32101.4261 71313.4196   122%     -   12s
     0     0 71281.6357    0  779 32101.4261 71281.6357   122%     -   12s
     0     0 70601.3431    0  709 32101.4261 70601.3431   120%     -   13s
     0     0 70369.3451    0  790 32101.4261 70369.3451   119%     -   13s
     0     0 70312.7531    0  800 32101.4261 70312.7531   119%     -   14s
     0     0 70294.0831    0  857 32101.4261 70294.0831   119%     -   14s
     0     0 69778.7285    0  693 32101.4261 69778.7285   117%     -   15s
     0     0 69641.7627    0  775 32101.4261 69641.7627   117%     -   15s
H    0     0                    32578.264942 69581.6378   114%     -   15s
     0     0 69581.6378    0  779 32578.2649 69581.6378   114%     -   15s
     0     0 69571.1745    0  796 32578.2649 69571.1745   114%     -   16s
H    0     0                    33245.768515 69223.8366   108%     -   16s
H    0     0                    33403.935944 69223.8366   107%     -   16s
H    0     0                    33587.451265 69223.8366   106%     -   16s
     0     0 69223.8366    0  817 33587.4513 69223.8366   106%     -   16s
H    0     0                    34277.892430 69138.9868   102%     -   17s
     0     0 69138.9868    0  832 34277.8924 69138.9868   102%     -   17s
     0     0 69115.3788    0  840 34277.8924 69115.3788   102%     -   17s
     0     0 68755.0356    0  779 34277.8924 68755.0356   101%     -   18s
     0     0 68754.9771    0  779 34277.8924 68754.9771   101%     -   18s
     0     2 68754.9363    0  779 34277.8924 68754.9363   101%     -   20s
    31    64 66392.9321    5  660 34277.8924 67224.4341  96.1%  2142   26s
H  110   240                    34545.495772 66739.4201  93.2%  1381   28s
   338   371 64857.6289   10  664 34545.4958 66739.4201  93.2%   706   31s
H  387   403                    35604.777329 66739.4201  87.4%   673   33s
H  488   562                    36889.758704 66739.4201  80.9%   628   35s
H  510   562                    36909.730146 66739.4201  80.8%   631   35s
H  514   562                    37504.921971 66739.4201  77.9%   630   35s
H  548   562                    37555.268135 66739.4201  77.7%   611   35s
H  558   562                    37572.990750 66739.4201  77.6%   606   35s
H  661   729                    37917.177816 66739.4201  76.0%   575   36s
H  706   729                    39037.334466 66739.4201  71.0%   556   36s
H 1158  1230                    39667.889349 66739.4201  68.2%   456   39s
H 1165  1230                    40146.027478 66739.4201  66.2%   456   39s
H 1225  1230                    41050.807162 66467.0999  61.9%   450   39s
  1247  1334 63290.9261   20  428 41050.8072 66467.0999  61.9%   447   40s
  1797  1806 54075.5805   27  458 41050.8072 66443.7335  61.9%   442   45s
H 1900  1849                    42014.043291 66443.7335  58.1%   446   45s
H 1913  1849                    42141.557456 66443.7335  57.7%   446   45s
H 1919  1835                    43038.542955 66443.7335  54.4%   448   45s
H 1933  1810                    44985.588096 66443.7335  47.7%   447   45s
  2760  2722 50836.6640   44  267 44985.5881 66443.7335  47.7%   403   50s
H 3609  3123                    45348.992233 66206.4926  46.0%   375   69s
  3610  3124 63268.4911   19  779 45348.9922 66206.4926  46.0%   375   75s
  3640  3144 60474.2619   31  419 45348.9922 63526.3434  40.1%   372   80s
  3661  3167 63296.3145   14  335 45348.9922 63348.9358  39.7%   375   85s
H 3923  3171                    45593.818582 62566.1864  37.2%   374   87s
H 4242  3127                    45819.412314 61019.0603  33.2%   370   90s
H 4376  3001                    46007.447097 60585.9270  31.7%   368   90s
H 4384  2862                    46022.475770 60585.9270  31.6%   368   90s
H 4390  2731                    46353.612458 60585.9270  30.7%   369   90s
H 4507  2610                    46647.631501 59823.8826  28.2%   367   91s
H 4509  2493                    47749.063546 59823.8826  25.3%   367   91s
H 4539  2372                    47971.486809 59823.8826  24.7%   366   91s
H 4540  2267                    48486.680966 59823.8826  23.4%   366   91s
  5020  2295 51410.6259   26  246 48486.6810 58245.9411  20.1%   356   95s
  7071  1934 50828.4740   26  154 48486.6810 55071.5749  13.6%   320  100s
H 7880  1670                    48541.672640 54424.4581  12.1%   312  102s
H 8137  1512                    48590.423540 54124.3540  11.4%   309  102s
  9281  1173 51360.1878   25  306 48590.4235 53023.5968  9.12%   300  105s
 17366  1487     cutoff   44      48590.4235 49364.0498  1.59%   205  110s

Cutting planes:
  Learned: 1
  Gomory: 1
  Implied bound: 2
  Projected implied bound: 11
  MIR: 321
  Mixing: 1
  Flow cover: 450
  RLT: 7
  Relax-and-lift: 54

Explored 25246 nodes (3816807 simplex iterations) in 111.27 seconds (152.30 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 48590.4 48541.7 48486.7 ... 45819.4

Optimal solution found (tolerance 1.00e-04)
Best objective 4.859042353986e+04, best bound 4.859042353986e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 111.28s
  Master Objective (UB) = 48590.42, θ = 235968.93
  Upper Bound (UB) = 48590.42

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 235968.93
  [DEBUG]   ✓ Scenario 0: θ = 235968.93 ≤ Q = 235968.93 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x2255eea3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x2255eea3
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.255664e+13
Presolve removed 2596 rows and 1886 columns
Presolve time: 0.01s
Presolved: 497 rows, 503 columns, 1405 nonzeros
Found heuristic solution: objective 5322142.3551
Variable types: 343 continuous, 160 integer (160 binary)

Root relaxation: objective -1.974465e+05, 243 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -197446.52    0  125 5322142.36 -197446.52   104%     -    0s
H    0     0                    -163712.6917 -197446.52  20.6%     -    0s
H    0     0                    -163996.0679 -197446.52  20.4%     -    0s
*    0     0               0    -166565.9072 -166565.91  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 205

Explored 1 nodes (371 simplex iterations) in 0.02 seconds (0.01 work units)
Thread count was 32 (of 32 available processors)

Solution count 5: -166566 -163996 -163713 ... 1.25566e+13
No other solutions better than -166566

Optimal solution found (tolerance 1.00e-04)
Best objective -1.665659072007e+05, best bound -1.665659072007e+05, gap 0.0000%
  Subproblem solved in 0.05s
  Worst-case operational profit (Z_SP) = 206620.96
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -166565.91
  [DEBUG]   S×d_nominal = 373186.87
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 373186.87 + -166565.91 = 206620.96
  [DEBUG]   Current θ from Master = 235968.93
  [DEBUG]   ⚠️  Z_SP ≤ θ by 29347.97 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 19242.46
  Lower Bound (LB) = 19242.46
  Gap (UB-LB) = 29347.9662, Absolute Gap = 29347.9662, Relative Gap = 0.603987
  Not converged yet (gap = 29347.97 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 91981 nonzeros
Model fingerprint: 0x01330c1b
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 19242.5 (0.02s)
MIP start from previous solve produced solution with objective 19242.5 (0.02s)
Loaded MIP start from previous solve with objective 19242.5

Presolve removed 14141 rows and 5740 columns
Presolve time: 0.46s
Presolved: 17822 rows, 9000 columns, 98638 nonzeros
Variable types: 6741 continuous, 2259 integer (2259 binary)

Root relaxation: objective 6.597091e+04, 8930 iterations, 1.28 seconds (1.59 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 65970.9081    0  245 19242.4573 65970.9081   243%     -    1s
H    0     0                    20082.301825 65970.9081   229%     -    2s
H    0     0                    20236.083785 65970.9081   226%     -    2s
H    0     0                    20945.347921 65970.9081   215%     -    2s
H    0     0                    21297.763823 65970.9081   210%     -    2s
H    0     0                    21304.030570 65970.9081   210%     -    2s
H    0     0                    21667.383663 65970.9081   204%     -    2s
H    0     0                    21712.411292 65970.9081   204%     -    2s
H    0     0                    21772.173070 65970.9081   203%     -    2s
H    0     0                    21901.046268 65970.9081   201%     -    2s
H    0     0                    22002.892011 65970.9081   200%     -    2s
H    0     0                    22063.269240 65970.9081   199%     -    2s
     0     0 59087.3217    0  265 22063.2692 59087.3217   168%     -    3s
     0     0 58628.6315    0  394 22063.2692 58628.6315   166%     -    4s
     0     0 58620.0695    0  394 22063.2692 58620.0695   166%     -    4s
H    0     0                    22462.390605 53650.0636   139%     -    6s
H    0     0                    22561.303699 53650.0636   138%     -    6s
     0     0 53650.0636    0  387 22561.3037 53650.0636   138%     -    6s
H    0     0                    22985.056750 53649.3664   133%     -    6s
H    0     0                    23449.308475 53649.3664   129%     -    6s
     0     0 53066.1066    0  356 23449.3085 53066.1066   126%     -    6s
     0     0 53045.2402    0  364 23449.3085 53045.2402   126%     -    6s
     0     0 53033.8932    0  360 23449.3085 53033.8932   126%     -    6s
     0     0 53033.7937    0  360 23449.3085 53033.7937   126%     -    7s
     0     0 48936.6953    0  372 23449.3085 48936.6953   109%     -    9s
     0     0 47972.4955    0  440 23449.3085 47972.4955   105%     -   10s
     0     0 47747.2712    0  452 23449.3085 47747.2712   104%     -   11s
     0     0 47640.7478    0  471 23449.3085 47640.7478   103%     -   11s
     0     0 47615.8599    0  538 23449.3085 47615.8599   103%     -   11s
     0     0 47591.9885    0  514 23449.3085 47591.9885   103%     -   11s
     0     0 47590.5505    0  526 23449.3085 47590.5505   103%     -   11s
H    0     0                    23669.822027 47590.5505   101%     -   13s
H    0     0                    23706.902935 47590.5505   101%     -   13s
H    0     0                    23951.501736 47590.5505  98.7%     -   13s
H    0     0                    24040.976555 45504.3830  89.3%     -   15s
H    0     0                    24046.720056 45504.3830  89.2%     -   15s
H    0     0                    24298.531107 45504.3830  87.3%     -   15s
     0     0 45504.3830    0  470 24298.5311 45504.3830  87.3%     -   15s
H    0     0                    24381.965117 45504.2025  86.6%     -   15s
H    0     0                    24556.585460 45504.2025  85.3%     -   15s
H    0     0                    24566.478848 45504.2025  85.2%     -   15s
     0     0 45154.4257    0  479 24566.4788 45154.4257  83.8%     -   16s
     0     0 45074.1407    0  490 24566.4788 45074.1407  83.5%     -   16s
     0     0 45031.1792    0  487 24566.4788 45031.1792  83.3%     -   16s
     0     0 45006.3926    0  497 24566.4788 45006.3926  83.2%     -   17s
     0     0 45003.2598    0  490 24566.4788 45003.2598  83.2%     -   17s
     0     0 44351.4957    0  504 24566.4788 44351.4957  80.5%     -   18s
H    0     0                    24573.375802 44350.9000  80.5%     -   18s
     0     0 44143.0878    0  486 24573.3758 44143.0878  79.6%     -   19s
     0     0 44023.1879    0  551 24573.3758 44023.1879  79.1%     -   19s
     0     0 44003.3308    0  562 24573.3758 44003.3308  79.1%     -   20s
     0     0 44002.3113    0  560 24573.3758 44002.3113  79.1%     -   20s
     0     0 43591.5973    0  458 24573.3758 43591.5973  77.4%     -   21s
     0     0 43442.2895    0  485 24573.3758 43442.2895  76.8%     -   22s
     0     0 43388.5298    0  507 24573.3758 43388.5298  76.6%     -   23s
     0     0 43371.0359    0  510 24573.3758 43371.0359  76.5%     -   23s
     0     0 43366.0223    0  523 24573.3758 43366.0223  76.5%     -   23s
     0     0 42866.8942    0  483 24573.3758 42866.8942  74.4%     -   25s
     0     0 42724.0397    0  508 24573.3758 42724.0397  73.9%     -   25s
     0     0 42685.7253    0  460 24573.3758 42685.7253  73.7%     -   26s
     0     0 42677.8911    0  496 24573.3758 42677.8911  73.7%     -   26s
     0     0 42674.6213    0  513 24573.3758 42674.6213  73.7%     -   26s
     0     0 42481.6988    0  469 24573.3758 42481.6988  72.9%     -   27s
     0     0 42384.7832    0  501 24573.3758 42384.7832  72.5%     -   28s
     0     0 42366.6835    0  505 24573.3758 42366.6835  72.4%     -   29s
     0     0 42357.9186    0  469 24573.3758 42357.9186  72.4%     -   29s
     0     0 42357.0293    0  523 24573.3758 42357.0293  72.4%     -   29s
     0     0 42304.5642    0  449 24573.3758 42304.5642  72.2%     -   30s
     0     0 42280.8546    0  449 24573.3758 42280.8546  72.1%     -   30s
     0     0 42257.2334    0  476 24573.3758 42257.2334  72.0%     -   30s
     0     0 42248.8927    0  457 24573.3758 42248.8927  71.9%     -   30s
     0     0 42246.2787    0  464 24573.3758 42246.2787  71.9%     -   31s
     0     0 42225.1787    0  461 24573.3758 42225.1787  71.8%     -   31s
     0     0 42216.2496    0  391 24573.3758 42216.2496  71.8%     -   32s
     0     0 42213.2107    0  447 24573.3758 42213.2107  71.8%     -   32s
     0     0 42191.3538    0  464 24573.3758 42191.3538  71.7%     -   33s
     0     0 42174.1027    0  473 24573.3758 42174.1027  71.6%     -   33s
     0     0 42169.9656    0  477 24573.3758 42169.9656  71.6%     -   33s
     0     0 42162.6158    0  453 24573.3758 42162.6158  71.6%     -   34s
     0     0 42161.0760    0  453 24573.3758 42161.0760  71.6%     -   34s
H    0     0                    24605.655973 42161.0760  71.3%     -   39s
H    0     0                    24764.063626 42161.0760  70.3%     -   39s
H    0     0                    24797.896387 42161.0760  70.0%     -   39s
H    0     0                    24862.117102 42161.0760  69.6%     -   39s
     0     2 42161.0760    0  453 24862.1171 42161.0760  69.6%     -   40s
    31    64 41772.4170    5  467 24862.1171 41909.8078  68.6%  1203   47s
H   32    64                    25066.220048 41909.8078  67.2%  1165   47s
H   33    64                    25319.927900 41909.8078  65.5%  1152   47s
H   36    64                    25362.141948 41909.8078  65.2%  1114   47s
H   40    64                    25385.514476 41909.8078  65.1%  1065   47s
    95   156 41369.1502    7  491 25385.5145 41772.1506  64.6%  1046   51s
H  151   156                    25655.329608 41772.1506  62.8%   839   51s
   345   378 40319.2558   11  421 25655.3296 41772.1506  62.8%   587   55s
H  385   421                    25663.524896 41772.1506  62.8%   581   56s
H  498   565                    25677.765994 41772.1506  62.7%   548   58s
H  503   565                    25753.670016 41772.1506  62.2%   546   58s
   653   713 39905.7190   15  398 25753.6700 41772.1506  62.2%   499   60s
H  775   771                    25813.193378 41651.7352  61.4%   489   61s
   924   912 37952.4510   17  355 25813.1934 41598.1580  61.2%   487   66s
H 1022   987                    25825.020328 41368.2018  60.2%   509   68s
H 1031   987                    25832.246876 41368.2018  60.1%   507   68s
  1127  1106 36693.0958   20  346 25832.2469 41368.2018  60.1%   494   71s
H 1148  1106                    25832.386252 41368.2018  60.1%   496   71s
H 1171  1106                    25837.238083 41368.2018  60.1%   492   71s
  1533  1527 35113.9385   23  354 25837.2381 41198.5137  59.5%   449   76s
  2190  2284 33006.9591   35  308 25837.2381 40984.7033  58.6%   391   81s
  3029  2881 26644.5737   58  185 25837.2381 40984.7033  58.6%   329   85s
  3405  3091 36432.3804   12  291 25837.2381 40869.3412  58.2%   328   90s
  3537  3092 34924.9435   10  453 25837.2381 40869.3412  58.2%   329  100s
  3541  3095 32955.1416   39  321 25837.2381 40869.3412  58.2%   328  105s
  3552  3102 37875.1064   11  437 25837.2381 40869.3412  58.2%   327  111s
  3561  3108 28172.5141   55  487 25837.2381 40869.3412  58.2%   327  115s
  3569  3113 36503.3579   18  495 25837.2381 40869.3412  58.2%   326  120s
  3576  3118 30594.3431   45  466 25837.2381 40869.3412  58.2%   325  125s
  3579  3120 32242.9357   45  493 25837.2381 40869.3412  58.2%   325  130s
H 3580  2966                    25839.413990 40869.3412  58.2%   333  135s
  3595  2991 38537.1397   15  297 25839.4140 39191.1936  51.7%   336  140s
H 3679  2911                    25879.453464 38253.5887  47.8%   349  144s
  3708  2964 35463.6627   19  268 25879.4535 38253.5887  47.8%   352  145s
  3856  3032 35175.3492   21  208 25879.4535 38253.5887  47.8%   359  150s
  4094  3097 33758.7045   24  217 25879.4535 36854.1920  42.4%   370  156s
  4226  3092 32769.0302   25  286 25879.4535 36622.0445  41.5%   377  160s
  4447  3171 30717.5533   28  272 25879.4535 36306.2166  40.3%   397  166s
  4684  3195     cutoff   31      25879.4535 36246.5090  40.1%   403  171s
H 4837  3047                    25923.072034 35951.0741  38.7%   408  174s
H 4855  2907                    25924.050749 35951.0741  38.7%   408  174s
H 4871  2773                    25948.654318 35951.0741  38.5%   409  174s
  4875  2817 26486.3395   36  100 25948.6543 35951.0741  38.5%   409  175s
  5093  2843 34332.2288   19  385 25948.6543 35585.0010  37.1%   411  180s
  5496  2898 28435.1858   25  220 25948.6543 35138.8064  35.4%   410  185s
  5991  2897 29057.8141   28  139 25948.6543 34847.3615  34.3%   411  191s
  6386  2968 26966.1395   33   81 25948.6543 34717.8327  33.8%   413  197s
  6884  2925 30723.4327   23  340 25948.6543 34622.7474  33.4%   414  201s
  7198  2906 27936.9518   26  243 25948.6543 34622.7474  33.4%   418  206s
  7619  2885     cutoff   29      25948.6543 34263.4877  32.0%   420  210s
  7992  2922     cutoff   21      25948.6543 33890.0492  30.6%   424  216s
  8553  2875 infeasible   20      25948.6543 33524.2976  29.2%   422  222s
  8815  2892     cutoff   24      25948.6543 33496.0248  29.1%   423  225s
  9470  2847 29962.0498   25  290 25948.6543 33111.5667  27.6%   425  231s
 10372  2700 27489.2013   30  232 25948.6543 32566.2401  25.5%   424  237s
 10763  2659 28435.9860   25  303 25948.6543 32371.7056  24.8%   425  241s
 11555  2779 infeasible   25      25948.6543 31938.0190  23.1%   425  248s
 12094  2883 28611.0614   25  194 25948.6543 31796.1233  22.5%   424  251s
 12539  3022 29266.9404   25  260 25948.6543 31630.7872  21.9%   423  255s
 13728  3250 29716.6710   28  199 25948.6543 31388.3252  21.0%   421  263s
 14345  3415 infeasible   32      25948.6543 31309.8839  20.7%   419  268s
 15021  3485 27097.1379   24  319 25948.6543 31141.7973  20.0%   417  271s
 15624  3578 26530.4377   35  105 25948.6543 30926.4542  19.2%   418  276s
 16096  3761 29807.9038   29  265 25948.6543 30763.9471  18.6%   417  280s
 17761  4004 26309.6436   37   92 25948.6543 30446.6880  17.3%   410  288s
 18564  4059 26305.4665   30  170 25948.6543 30205.0039  16.4%   407  293s
 19394  4069 29073.1748   24  202 25948.6543 30056.9166  15.8%   406  298s
 19458  4067 28654.1655   25  199 25948.6543 30052.2970  15.8%   406  303s
 19889  4084     cutoff   35      25948.6543 30023.6116  15.7%   404  308s
 20819  4069     cutoff   29      25948.6543 29899.8960  15.2%   401  313s
 21817  4063 27310.0276   28  192 25948.6543 29618.1586  14.1%   400  318s
 22576  3997     cutoff   31      25948.6543 29498.5962  13.7%   396  324s
 23703  3823 26168.1757   34  127 25948.6543 29293.6807  12.9%   394  329s
 24971  3646 27872.4579   29  226 25948.6543 29053.6789  12.0%   390  335s
 26259  3306 26488.8415   36  120 25948.6543 28811.1667  11.0%   386  340s
 27572  2789 27481.0443   28  135 25948.6543 28649.9710  10.4%   383  346s
 29104  2137     cutoff   32      25948.6543 28286.8820  9.01%   377  352s
 30610  2198     cutoff   31      25948.6543 27917.7962  7.59%   371  357s
H30789  1930                    26381.508835 27917.7962  5.82%   370  357s
H31612  1729                    26609.464616 27913.1186  4.90%   363  357s
 34268  2808     cutoff   24      26609.4646 27330.3347  2.71%   344  364s
H34460  2808                    26742.813843 27330.3347  2.20%   342  364s
H37903  2808                    26751.717665 27244.4929  1.84%   314  364s
H38473  2808                    26755.874728 27244.4929  1.83%   310  364s
 40393    76     cutoff   53      26755.8747 26936.5937  0.68%   296  365s
*42129    76              58    26762.874862 26931.3434  0.63%   285  366s
*43502    76              51    26806.502401 26835.3833  0.11%   276  366s

Cutting planes:
  Learned: 2
  MIR: 411
  Mixing: 2
  Flow cover: 802
  RLT: 11
  Relax-and-lift: 61

Explored 43639 nodes (12065227 simplex iterations) in 366.52 seconds (664.21 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 26806.5 26806.5 26762.9 ... 25924.1

Optimal solution found (tolerance 1.00e-04)
Best objective 2.680650240063e+04, best bound 2.680650240063e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 366.53s
  Master Objective (UB) = 26806.50, θ = 196480.78
  Upper Bound (UB) = 26806.50

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 196480.78
  [DEBUG]   ✓ Scenario 0: θ = 196480.78 ≤ Q = 196480.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 196480.78 ≤ Q = 196480.78 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x205c85
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xffdfa37b
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.300363e+13
Presolve removed 2604 rows and 1894 columns
Presolve time: 0.01s
Presolved: 489 rows, 495 columns, 1380 nonzeros
Found heuristic solution: objective 5499602.9846
Variable types: 336 continuous, 159 integer (159 binary)
Found heuristic solution: objective 5499159.1732

Root relaxation: objective -1.992268e+05, 245 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -199226.83    0  127 5499159.17 -199226.83   104%     -    0s
H    0     0                    -180896.9070 -199226.83  10.1%     -    0s
H    0     0                    -181405.9416 -199226.83  9.82%     -    0s
H    0     0                    -181459.6936 -198918.19  9.62%     -    0s
     0     0 -187705.99    0   69 -181459.69 -187705.99  3.44%     -    0s
H    0     0                    -184920.9420 -187594.44  1.45%     -    0s
     0     0 -187082.91    0   71 -184920.94 -187082.91  1.17%     -    0s
     0     0 -187071.01    0   71 -184920.94 -187071.01  1.16%     -    0s
H    0     0                    -185605.6307 -186126.56  0.28%     -    0s
     0     0 -186126.56    0   22 -185605.63 -186126.56  0.28%     -    0s
H    0     0                    -185625.6587 -186091.99  0.25%     -    0s
     0     0 -186091.99    0   19 -185625.66 -186091.99  0.25%     -    0s
     0     0 -186090.89    0   19 -185625.66 -186090.89  0.25%     -    0s
     0     0 -185976.79    0   12 -185625.66 -185976.79  0.19%     -    0s
H    0     0                    -185653.2093 -185924.57  0.15%     -    0s
     0     0 -185913.31    0   27 -185653.21 -185913.31  0.14%     -    0s
     0     0 -185909.78    0   14 -185653.21 -185909.78  0.14%     -    0s
     0     0 -185860.08    0   11 -185653.21 -185860.08  0.11%     -    0s
     0     0 -185860.08    0   39 -185653.21 -185860.08  0.11%     -    0s
H    0     0                    -185714.8258 -185860.08  0.08%     -    0s
     0     0 -185806.50    0    2 -185714.83 -185806.50  0.05%     -    0s
H    0     0                    -185788.6966 -185805.61  0.01%     -    0s

Cutting planes:
  Gomory: 9
  Implied bound: 9
  MIR: 27
  Flow cover: 6

Explored 1 nodes (803 simplex iterations) in 0.09 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -185789 -185715 -185653 ... 5.49916e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.857886966421e+05, best bound -1.858056064748e+05, gap 0.0091%
  Subproblem solved in 0.12s
  Worst-case operational profit (Z_SP) = 173361.70
  Scenario: 37 demand increases, 23 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -185788.70
  [DEBUG]   S×d_nominal = 359150.40
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 359150.40 + -185788.70 = 173361.70
  [DEBUG]   Current θ from Master = 196480.78
  [DEBUG]   ⚠️  Z_SP ≤ θ by 23119.08 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 3687.42
  Lower Bound (LB) = 19242.46
  Gap (UB-LB) = 7564.0451, Absolute Gap = 7564.0451, Relative Gap = 0.282172
  Not converged yet (gap = 7564.05 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 37 increases, 23 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135212 nonzeros
Model fingerprint: 0xd7146230
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 3687.42 (0.03s)
MIP start from previous solve produced solution with objective 3687.42 (0.03s)
Loaded MIP start from previous solve with objective 3687.42

Presolve removed 21210 rows and 8610 columns
Presolve time: 0.65s
Presolved: 26043 rows, 12370 columns, 160049 nonzeros
Variable types: 10111 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...

Concurrent spin time: 0.13s

Solved with dual simplex

Root relaxation: objective 5.391599e+04, 13317 iterations, 3.47 seconds (4.50 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 53915.9856    0  176 3687.42174 53915.9856  1362%     -    4s
H    0     0                    5315.6409399 53915.9856   914%     -    4s
H    0     0                    13117.172278 53915.9856   311%     -    4s
H    0     0                    13691.933214 53915.9856   294%     -    4s
H    0     0                    16581.402245 53915.9856   225%     -    4s
H    0     0                    17132.194322 53915.9856   215%     -    4s
H    0     0                    18017.535009 53915.9856   199%     -    4s
H    0     0                    18641.255981 53915.9856   189%     -    4s
H    0     0                    18800.256966 53915.9856   187%     -    4s
H    0     0                    20022.897625 53915.9856   169%     -    4s
     0     0 50146.1682    0  229 20022.8976 50146.1682   150%     -    6s
H    0     0                    20066.527973 49217.2946   145%     -    8s
     0     0 49217.2946    0  243 20066.5280 49217.2946   145%     -    8s
     0     0 49175.4893    0  228 20066.5280 49175.4893   145%     -    8s
     0     0 49153.6225    0  230 20066.5280 49153.6225   145%     -    8s
     0     0 49153.5701    0  230 20066.5280 49153.5701   145%     -    8s
     0     0 47090.3214    0  262 20066.5280 47090.3214   135%     -   10s
H    0     0                    20494.883958 47089.7325   130%     -   10s
H    0     0                    21027.043419 47089.7325   124%     -   10s
     0     0 46437.5899    0  304 21027.0434 46437.5899   121%     -   11s
     0     0 46278.7086    0  305 21027.0434 46278.7086   120%     -   12s
     0     0 46244.7323    0  312 21027.0434 46244.7323   120%     -   12s
     0     0 46238.2972    0  312 21027.0434 46238.2972   120%     -   12s
     0     0 46235.9840    0  318 21027.0434 46235.9840   120%     -   12s
     0     0 46235.6572    0  319 21027.0434 46235.6572   120%     -   12s
     0     0 44569.3622    0  382 21027.0434 44569.3622   112%     -   15s
     0     0 43910.8685    0  390 21027.0434 43910.8685   109%     -   16s
     0     0 43690.9580    0  401 21027.0434 43690.9580   108%     -   17s
H    0     0                    21232.787640 43589.6966   105%     -   17s
H    0     0                    21236.945184 43589.6966   105%     -   17s
H    0     0                    21311.627100 43589.6966   105%     -   17s
     0     0 43589.6966    0  406 21311.6271 43589.6966   105%     -   17s
     0     0 43555.9051    0  410 21311.6271 43555.9051   104%     -   17s
     0     0 43524.7552    0  407 21311.6271 43524.7552   104%     -   17s
     0     0 43517.0334    0  408 21311.6271 43517.0334   104%     -   18s
     0     0 43513.8259    0  407 21311.6271 43513.8259   104%     -   18s
     0     0 43513.4390    0  409 21311.6271 43513.4390   104%     -   18s
     0     0 42588.9266    0  435 21311.6271 42588.9266   100%     -   21s
     0     0 42286.5882    0  416 21311.6271 42286.5882  98.4%     -   23s
     0     0 42116.7923    0  431 21311.6271 42116.7923  97.6%     -   23s
     0     0 42040.7987    0  441 21311.6271 42040.7987  97.3%     -   24s
     0     0 41982.1358    0  420 21311.6271 41982.1358  97.0%     -   24s
     0     0 41937.6866    0  442 21311.6271 41937.6866  96.8%     -   24s
     0     0 41928.6236    0  449 21311.6271 41928.6236  96.7%     -   24s
     0     0 41923.9087    0  448 21311.6271 41923.9087  96.7%     -   24s
     0     0 41922.2338    0  451 21311.6271 41922.2338  96.7%     -   25s
     0     0 41921.4049    0  450 21311.6271 41921.4049  96.7%     -   25s
     0     0 41598.3173    0  450 21311.6271 41598.3173  95.2%     -   26s
     0     0 41504.8295    0  466 21311.6271 41504.8295  94.8%     -   27s
     0     0 41463.3382    0  444 21311.6271 41463.3382  94.6%     -   28s
     0     0 41442.9156    0  446 21311.6271 41442.9156  94.5%     -   29s
     0     0 41434.0247    0  443 21311.6271 41434.0247  94.4%     -   29s
     0     0 41431.8553    0  448 21311.6271 41431.8553  94.4%     -   29s
     0     0 41431.0650    0  447 21311.6271 41431.0650  94.4%     -   29s
     0     0 41284.1993    0  434 21311.6271 41284.1993  93.7%     -   31s
     0     0 41231.0658    0  434 21311.6271 41231.0658  93.5%     -   32s
     0     0 41181.8608    0  444 21311.6271 41181.8608  93.2%     -   33s
     0     0 41176.3649    0  439 21311.6271 41176.3649  93.2%     -   33s
     0     0 41167.2908    0  439 21311.6271 41167.2908  93.2%     -   33s
     0     0 41162.9553    0  445 21311.6271 41162.9553  93.1%     -   33s
     0     0 41162.9391    0  445 21311.6271 41162.9391  93.1%     -   33s
     0     0 41047.2698    0  436 21311.6271 41047.2698  92.6%     -   35s
     0     0 41021.2041    0  448 21311.6271 41021.2041  92.5%     -   36s
     0     0 41011.1909    0  483 21311.6271 41011.1909  92.4%     -   36s
     0     0 41008.8989    0  477 21311.6271 41008.8989  92.4%     -   36s
     0     0 41008.3660    0  483 21311.6271 41008.3660  92.4%     -   36s
     0     0 40977.8356    0  479 21311.6271 40977.8356  92.3%     -   37s
H    0     0                    21476.341036 40977.5254  90.8%     -   38s
H    0     0                    21495.771340 40977.5254  90.6%     -   38s
H    0     0                    21518.312675 40977.5254  90.4%     -   38s
     0     0 40964.7941    0  452 21518.3127 40964.7941  90.4%     -   38s
     0     0 40958.5884    0  484 21518.3127 40958.5884  90.3%     -   38s
     0     0 40956.0292    0  494 21518.3127 40956.0292  90.3%     -   38s
     0     0 40955.4256    0  466 21518.3127 40955.4256  90.3%     -   38s
     0     0 40937.1797    0  468 21518.3127 40937.1797  90.2%     -   39s
     0     0 40930.6967    0  456 21518.3127 40930.6967  90.2%     -   40s
     0     0 40926.9342    0  456 21518.3127 40926.9342  90.2%     -   40s
     0     0 40925.5009    0  466 21518.3127 40925.5009  90.2%     -   40s
     0     0 40860.6523    0  464 21518.3127 40860.6523  89.9%     -   42s
     0     0 40834.9487    0  478 21518.3127 40834.9487  89.8%     -   43s
     0     0 40828.1833    0  483 21518.3127 40828.1833  89.7%     -   43s
     0     0 40826.8775    0  482 21518.3127 40826.8775  89.7%     -   43s
     0     0 40807.5053    0  472 21518.3127 40807.5053  89.6%     -   44s
     0     0 40801.5128    0  489 21518.3127 40801.5128  89.6%     -   45s
     0     0 40798.1626    0  488 21518.3127 40798.1626  89.6%     -   45s
     0     0 40797.3379    0  486 21518.3127 40797.3379  89.6%     -   45s
     0     0 40789.8855    0  446 21518.3127 40789.8855  89.6%     -   46s
H    0     0                    21589.103643 40788.4079  88.9%     -   47s
     0     0 40786.9555    0  446 21589.1036 40786.9555  88.9%     -   47s
     0     0 40786.4926    0  452 21589.1036 40786.4926  88.9%     -   47s
     0     0 40780.3652    0  489 21589.1036 40780.3652  88.9%     -   48s
H    0     0                    21703.509506 40779.9567  87.9%     -   48s
     0     0 40778.3306    0  441 21703.5095 40778.3306  87.9%     -   48s
     0     0 40777.3388    0  440 21703.5095 40777.3388  87.9%     -   49s
     0     0 40766.4979    0  485 21703.5095 40766.4979  87.8%     -   49s
     0     0 40760.8194    0  442 21703.5095 40760.8194  87.8%     -   49s
     0     0 40759.6123    0  443 21703.5095 40759.6123  87.8%     -   50s
     0     0 40757.7693    0  488 21703.5095 40757.7693  87.8%     -   50s
     0     0 40756.9341    0  488 21703.5095 40756.9341  87.8%     -   50s
H    0     0                    21731.279227 40756.1028  87.5%     -   58s
H    0     0                    21946.444123 40756.1028  85.7%     -   58s
     0     2 40756.1028    0  488 21946.4441 40756.1028  85.7%     -   58s
     3     8 40057.7970    2  446 21946.4441 40681.1579  85.4%  1471   61s
    15    32 39515.9467    4  396 21946.4441 40049.3548  82.5%  2649   67s
    31    64 39337.8340    5  443 21946.4441 39746.8035  81.1%  3159   71s
    95   217 39188.1970    7  437 21946.4441 39411.9679  79.6%  2284   78s
   216   249 38776.2300    9  436 21946.4441 39411.9679  79.6%  1534   81s
H  221   249                    21949.021120 39411.9679  79.6%  1567   81s
H  223   249                    21998.142762 39411.9679  79.2%  1570   81s
H  235   249                    22028.121887 39411.9679  78.9%  1582   81s
H  250   332                    22069.594759 39411.9679  78.6%  1533   84s
H  288   332                    22156.580844 39411.9679  77.9%  1480   84s
   331   412 37678.4500   10  366 22156.5808 39411.9679  77.9%  1352   86s
   481   557 37840.8751   12  361 22156.5808 39411.9679  77.9%  1187   91s
   556   635 36913.6339   13  351 22156.5808 39411.9679  77.9%  1151   95s
H  589   635                    22235.610123 39411.9679  77.2%  1159   95s
   764   842 36162.6748   14  339 22235.6101 39411.9679  77.2%  1071  101s
   845   917 35834.9365   15  397 22235.6101 39411.9679  77.2%  1034  105s
H  848   917                    22457.875473 39411.9679  75.5%  1036  105s
  1026  1023 30964.1539   16  372 22457.8755 39411.9679  75.5%   958  110s
H 1049  1023                    22602.168905 39411.9679  74.4%   964  110s
H 1135  1124                    22725.723053 39411.9679  73.4%   959  116s
H 1145  1124                    22772.056279 39411.9679  73.1%   962  116s
H 1172  1124                    22907.346313 39411.9679  72.0%   976  116s
H 1187  1124                    23098.118499 39411.9679  70.6%   975  116s
  1204  1175 34133.8923   21  328 23098.1185 39411.9679  70.6%   972  120s
H 1284  1235                    23298.352913 39335.5561  68.8%   989  123s
  1343  1307 33470.6554   28  306 23298.3529 39335.5561  68.8%   995  126s
  1449  1380 32849.7197   32  292 23298.3529 39335.5561  68.8%  1004  131s
H 1555  1475                    23368.554259 39335.5561  68.3%   993  136s
H 1556  1475                    23591.027821 39335.5561  66.7%   992  136s
H 1582  1475                    23666.634232 39335.5561  66.2%   987  136s
  1752  1804 32251.8233   36  315 23666.6342 39275.3270  66.0%   939  142s
  1942  1956 31817.5363   40  317 23666.6342 39275.3270  66.0%   890  146s
  2126  2102 31647.5017   42  283 23666.6342 39104.4425  65.2%   855  151s
  2487  2455 30333.0134   49  201 23666.6342 39090.3386  65.2%   808  158s
  2700  2604 29207.6280   51  185 23666.6342 39090.3386  65.2%   785  161s
  3066  2894 38407.8149   11  414 23666.6342 39090.3386  65.2%   761  167s
  3257  2920 35154.5168   13  341 23666.6342 38961.0822  64.6%   753  171s
H 3351  3007                    23709.802867 38961.0822  64.3%   756  174s
  3401  3008 27369.3874   54  488 23709.8029 38961.0822  64.3%   751  187s
  3403  3009 37443.6973    9  176 23709.8029 38961.0822  64.3%   751  194s
  3404  3010 35245.9093   12  377 23709.8029 38961.0822  64.3%   751  200s
  3407  3012 37003.6206    8  419 23709.8029 38961.0822  64.3%   750  206s
  3411  3015 24921.4851   64  438 23709.8029 38961.0822  64.3%   749  210s
  3415  3017 32369.3185   23  460 23709.8029 38961.0822  64.3%   748  215s
  3421  3021 25664.0792   51  448 23709.8029 38961.0822  64.3%   747  221s
  3425  3024 29298.8822   36  422 23709.8029 38961.0822  64.3%   746  226s
  3429  3027 33839.9334   26  485 23709.8029 38961.0822  64.3%   745  231s
  3430  3027 31658.6034   16  485 23709.8029 38961.0822  64.3%   745  239s
  3431  3028 29114.2716   16  485 23709.8029 38961.0822  64.3%   745  247s
  3432  3032 38961.0822   11  479 23709.8029 38961.0822  64.3%   763  251s
  3434  3035 38961.0822   12  404 23709.8029 38961.0822  64.3%   764  256s
  3438  3042 38961.0822   13  420 23709.8029 38961.0822  64.3%   766  261s
  3446  3055 38961.0822   14  464 23709.8029 38961.0822  64.3%   771  267s
  3462  3082 38961.0822   15  464 23709.8029 38961.0822  64.3%   801  274s
H 3474  2926                    23843.222997 38961.0822  63.4%   804  274s
  3494  2949 30387.5904   16  405 23843.2230 38961.0822  63.4%   824  280s
  3526  2967 29835.9940   17  397 23843.2230 38961.0822  63.4%   859  290s
  3559  2979 29445.0047   18  397 23843.2230 38961.0822  63.4%   923  295s
H 3588  2825                    23909.863775 38961.0822  62.9%   941  295s
  3599  2859 29358.0735   19  408 23909.8638 38961.0822  62.9%   948  302s
  3701  2862 28251.5865   20  369 23909.8638 38961.0822  62.9%   994  306s
  3776  2864 25453.0663   20  287 23909.8638 38961.0822  62.9%  1024  312s
  3848  2864 27913.8317   21  388 23909.8638 38961.0822  62.9%  1054  316s
  3885  2881 26453.8456   21  330 23909.8638 38961.0822  62.9%  1076  322s
  3942  2897 24633.9883   22  295 23909.8638 38961.0822  62.9%  1089  328s
  4024  2911 26009.0221   22  318 23909.8638 38961.0822  62.9%  1098  335s
  4100  2929     cutoff   23      23909.8638 38961.0822  62.9%  1112  340s
  4177  2961 31708.1746   20  356 23909.8638 38961.0822  62.9%  1126  345s
  4255  2988 31267.9902   22  369 23909.8638 38961.0822  62.9%  1132  350s
  4329  3020 30442.0284   24  331 23909.8638 38961.0822  62.9%  1138  355s
  4409  3055 28762.8285   26  300 23909.8638 37223.4664  55.7%  1144  361s
  4501  3059 28040.9254   28  312 23909.8638 37223.4664  55.7%  1148  366s
  4561  3084 27714.6939   29  324 23909.8638 37223.4664  55.7%  1152  371s
  4626  3112 27207.1110   30  321 23909.8638 37223.4664  55.7%  1165  377s
  4715  3146 26394.6564   32  248 23909.8638 37223.4664  55.7%  1169  382s
H 4814  3000                    23927.091804 37223.4664  55.6%  1176  385s
  4850  3042 24464.4817   36  225 23927.0918 37223.4664  55.6%  1177  391s
  4987  3044 31033.4769   19  311 23927.0918 37223.4664  55.6%  1174  396s
  5104  3067 29164.1457   21  264 23927.0918 36369.3316  52.0%  1172  403s
  5247  3076 27272.3050   24  249 23927.0918 36320.9245  51.8%  1168  408s
  5367  3120 25362.6020   27  225 23927.0918 36320.9245  51.8%  1169  414s
  5509  3129     cutoff   30      23927.0918 35001.0471  46.3%  1169  421s
  5680  3102 33794.4722   18  417 23927.0918 35001.0471  46.3%  1169  426s
  5772  3131 32780.3821   19  306 23927.0918 34518.8084  44.3%  1172  433s
  5892  3160 32380.3572   20  265 23927.0918 34517.5924  44.3%  1179  439s
  6028  3200 31006.9639   22  244 23927.0918 34517.5924  44.3%  1185  447s
  6194  3223 26930.3247   26  268 23927.0918 34517.5924  44.3%  1188  453s
  6380  3241     cutoff   32      23927.0918 34132.5528  42.7%  1186  460s
  6567  3273 28099.2700   21  351 23927.0918 33987.7133  42.0%  1190  466s
  6756  3310 25800.1305   24  333 23927.0918 33987.7133  42.0%  1194  474s
  6976  3270     cutoff   27      23927.0918 33668.9145  40.7%  1197  481s
  7066  3340 30041.9848   26  354 23927.0918 33668.9145  40.7%  1197  488s
  7332  3335 27513.8291   31  239 23927.0918 33198.1817  38.7%  1199  496s
  7644  3290     cutoff   35      23927.0918 32949.4311  37.7%  1201  505s
  7923  3302 31620.3781   23  259 23927.0918 32739.6809  36.8%  1206  512s
  8158  3247     cutoff   26      23927.0918 32701.9797  36.7%  1215  518s
  8198  3259     cutoff   26      23927.0918 32582.3798  36.2%  1221  528s
  8243  3324     cutoff   26      23927.0918 32582.3798  36.2%  1226  536s
  8505  3322 28419.6921   21  296 23927.0918 32039.6271  33.9%  1228  545s
  8789  3338 30167.8698   23  326 23927.0918 31980.6801  33.7%  1243  553s
  9145  3347 25228.7918   26  299 23927.0918 31980.6801  33.7%  1249  563s
  9494  3365 28461.3006   28  258 23927.0918 31872.5402  33.2%  1244  573s
  9907  3452     cutoff   33      23927.0918 31770.0519  32.8%  1243  582s
 10355  3460 25204.0891   32  194 23927.0918 31399.4208  31.2%  1240  592s
 10804  3441 29363.4626   26  256 23927.0918 31394.7489  31.2%  1239  602s
 11274  3400     cutoff   43      23927.0918 31394.7489  31.2%  1239  613s
 11661  3534 26366.0728   24  347 23927.0918 31004.9922  29.6%  1237  623s
 12176  3671 27704.7897   28  175 23927.0918 31004.9922  29.6%  1233  634s
 12612  3781 25022.6059   24  174 23927.0918 30896.7804  29.1%  1241  646s
 13199  3869     cutoff   30      23927.0918 30727.0464  28.4%  1237  657s
 13815  3971     cutoff   26      23927.0918 30504.6639  27.5%  1230  670s
 14434  4093 27198.9828   21  244 23927.0918 30490.1060  27.4%  1225  682s
 15023  4296 27823.3130   23  214 23927.0918 30324.3155  26.7%  1230  693s
 15608  4489 25367.4223   30  306 23927.0918 30253.0074  26.4%  1231  707s
 16345  4623 29148.4110   23  358 23927.0918 30057.4245  25.6%  1226  721s
 17067  4751 26209.7272   28  220 23927.0918 30030.2857  25.5%  1223  736s
 17725  4913 27616.9191   29  322 23927.0918 29910.3545  25.0%  1227  750s
 18462  5051 24091.0125   32   70 23927.0918 29713.0439  24.2%  1226  765s
 19253  5097 25891.4541   24  149 23927.0918 29561.8595  23.5%  1224  780s
H19259  5096                    23942.774082 29561.8595  23.5%  1224  780s
H19294  5089                    23981.485334 29561.8595  23.3%  1224  780s
H19316  5087                    24002.727711 29561.8595  23.2%  1224  780s
H19331  5113                    24035.711090 29561.8595  23.0%  1225  795s
 19493  5308     cutoff   28      24035.7111 29558.5954  23.0%  1225  810s
 20395  5429 24186.8446   30  175 24035.7111 29493.7245  22.7%  1219  826s
 21262  5570 24133.5798   28  293 24035.7111 29291.0912  21.9%  1218  844s
 22191  5730     cutoff   36      24035.7111 29155.4680  21.3%  1215  861s
 23144  5861     cutoff   30      24035.7111 28970.2692  20.5%  1212  879s
 24171  5947 26428.8949   27  108 24035.7111 28846.1973  20.0%  1209  896s
 25244  6136 25950.4997   31  204 24035.7111 28744.6418  19.6%  1203  914s
 26375  6234 infeasible   29      24035.7111 28577.8533  18.9%  1197  933s
 27601  6350 25189.6749   24  274 24035.7111 28461.1998  18.4%  1189  953s
 28839  6427 24625.6013   29  208 24035.7111 28326.2622  17.9%  1181  974s
 30161  6495     cutoff   24      24035.7111 28184.6783  17.3%  1173  999s
 31742  6568 24172.4731   37   92 24035.7111 28024.6091  16.6%  1163 1017s
 32976  6616 26123.1202   29  206 24035.7111 27897.5943  16.1%  1156 1035s
 34113  6538 25807.3002   26  247 24035.7111 27803.3453  15.7%  1153 1055s
 35430  6601 25901.7004   28  286 24035.7111 27686.9233  15.2%  1145 1076s
 36912  6521 infeasible   22      24035.7111 27574.8926  14.7%  1135 1098s
 38456  6417 25242.6986   32  294 24035.7111 27403.4745  14.0%  1125 1118s
 40044  6204 24210.5503   31  135 24035.7111 27241.6259  13.3%  1114 1140s
 41679  6022     cutoff   30      24035.7111 27044.6770  12.5%  1104 1160s
 43565  5695 25518.9998   30  180 24035.7111 26882.2524  11.8%  1089 1182s
 45411  5327 24986.2126   35  154 24035.7111 26680.7825  11.0%  1078 1206s
 47393  4704     cutoff   30      24035.7111 26488.9083  10.2%  1066 1230s
 49650  3779     cutoff   36      24035.7111 26276.3842  9.32%  1049 1255s
 52177  2614 25312.0935   31  184 24035.7111 25950.9884  7.97%  1029 1277s
 55093  2725     cutoff   29      24035.7111 25618.8889  6.59%  1002 1298s
 63023  6648     cutoff   23      24035.7111 24876.8045  3.50%   896 1308s
*64231  6474              82    24095.323395 24860.9254  3.18%   880 1308s
*68129  6435             109    24103.831156 24835.0259  3.03%   832 1308s
*70193  6319              76    24126.195850 24820.7780  2.88%   809 1308s
 74959  6037     cutoff   66      24126.1958 24469.5382  1.42%   761 1310s
H74961  4133                    24201.314326 24469.5382  1.11%   761 1310s
H74961  3083                    24246.949200 24469.5382  0.92%   761 1310s
*75485  3061             103    24311.128821 24458.0612  0.60%   756 1310s

Cutting planes:
  MIR: 862
  Flow cover: 1356
  RLT: 6
  Relax-and-lift: 97

Explored 79991 nodes (57252068 simplex iterations) in 1312.65 seconds (2725.21 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 24311.1 24311.1 24246.9 ... 23981.5

Optimal solution found (tolerance 1.00e-04)
Best objective 2.431112882118e+04, best bound 2.431112882118e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1312.70s
  Master Objective (UB) = 24311.13, θ = 200149.62
  Upper Bound (UB) = 24311.13

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 200149.62
  [DEBUG]   ✓ Scenario 0: θ = 200149.62 ≤ Q = 202165.62 (slack: 2016.00)
  [DEBUG]   ✓ Scenario 1: θ = 200149.62 ≤ Q = 200155.84 (slack: 6.22)
  [DEBUG]   ✓ Scenario 2: θ = 200149.62 ≤ Q = 200149.62 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x1057e9bd
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x1057e9bd
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.286648e+13
Presolve removed 2611 rows and 1900 columns
Presolve time: 0.01s
Presolved: 482 rows, 489 columns, 1361 nonzeros
Found heuristic solution: objective 5681303.9190
Variable types: 331 continuous, 158 integer (158 binary)
Found heuristic solution: objective 5680401.0134

Root relaxation: objective -1.894406e+05, 245 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -189440.64    0  129 5680401.01 -189440.64   103%     -    0s
H    0     0                    -169639.3208 -189440.64  11.7%     -    0s
     0     0 -177937.64    0   68 -169639.32 -177937.64  4.89%     -    0s
H    0     0                    -176121.0065 -177868.26  0.99%     -    0s
     0     0 -177074.03    0   70 -176121.01 -177074.03  0.54%     -    0s
     0     0 -177059.83    0   70 -176121.01 -177059.83  0.53%     -    0s
     0     0 -177059.76    0   70 -176121.01 -177059.76  0.53%     -    0s
     0     0 -176694.92    0   44 -176121.01 -176694.92  0.33%     -    0s
H    0     0                    -176575.7348 -176679.44  0.06%     -    0s
     0     0 -176649.19    0   18 -176575.73 -176649.19  0.04%     -    0s
     0     0 -176648.97    0   12 -176575.73 -176648.97  0.04%     -    0s
     0     0 -176646.07    0   13 -176575.73 -176646.07  0.04%     -    0s
     0     0 -176629.49    0   10 -176575.73 -176629.49  0.03%     -    0s
     0     0 -176629.49    0    9 -176575.73 -176629.49  0.03%     -    0s
H    0     0                    -176597.4716 -176629.49  0.02%     -    0s
     0     0          -    0      -176597.47 -176614.11  0.01%     -    0s

Cutting planes:
  Gomory: 2
  Implied bound: 3
  MIR: 3
  Flow cover: 5

Explored 1 nodes (655 simplex iterations) in 0.06 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 8: -176597 -176576 -176401 ... 1.28665e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.765974716411e+05, best bound -1.766141142411e+05, gap 0.0094%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 178990.89
  Scenario: 35 demand increases, 25 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -176597.47
  [DEBUG]   S×d_nominal = 355588.36
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 355588.36 + -176597.47 = 178990.89
  [DEBUG]   Current θ from Master = 200149.62
  [DEBUG]   ⚠️  Z_SP ≤ θ by 21158.73 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 3152.40
  Lower Bound (LB) = 19242.46
  Gap (UB-LB) = 5068.6715, Absolute Gap = 5068.6715, Relative Gap = 0.208492
  Not converged yet (gap = 5068.67 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 35 increases, 25 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178443 nonzeros
Model fingerprint: 0xbe026d53
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 3152.4 (0.10s)
Loaded MIP start from previous solve with objective 3152.4

Presolve removed 28280 rows and 11480 columns
Presolve time: 0.86s
Presolved: 34263 rows, 15740 columns, 211559 nonzeros
Variable types: 13481 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 34263 rows, 15740 columns, 211559 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   46533    2.2924933e+04   0.000000e+00   2.867486e+06      5s
Concurrent spin time: 0.48s

Solved with dual simplex

Root relaxation: objective 5.382764e+04, 17757 iterations, 5.68 seconds (7.22 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 53827.6429    0  178 3152.39582 53827.6429  1608%     -    6s
H    0     0                    5172.8702771 53827.6429   941%     -    7s
H    0     0                    7022.6364045 53827.6429   666%     -    7s
H    0     0                    16739.295971 53827.6429   222%     -    7s
H    0     0                    19330.102586 53827.6429   178%     -    8s
H    0     0                    19395.820658 53827.6429   178%     -    8s
     0     0 49379.6779    0  199 19395.8207 49379.6779   155%     -   10s
H    0     0                    19475.454879 49379.6046   154%     -   11s
H    0     0                    19496.229281 49379.6046   153%     -   11s
H    0     0                    19595.913165 49379.6046   152%     -   11s
     0     0 48410.7887    0  237 19595.9132 48410.7887   147%     -   12s
     0     0 48363.5575    0  238 19595.9132 48363.5575   147%     -   13s
     0     0 48345.1967    0  242 19595.9132 48345.1967   147%     -   13s
     0     0 48332.9931    0  244 19595.9132 48332.9931   147%     -   13s
     0     0 48332.8528    0  246 19595.9132 48332.8528   147%     -   13s
     0     0 46209.2026    0  302 19595.9132 46209.2026   136%     -   18s
H    0     0                    19877.211467 46209.2026   132%     -   18s
H    0     0                    19988.205546 46209.2026   131%     -   18s
     0     0 45769.8632    0  325 19988.2055 45769.8632   129%     -   19s
     0     0 45565.3732    0  330 19988.2055 45565.3732   128%     -   20s
     0     0 45457.3503    0  336 19988.2055 45457.3503   127%     -   20s
     0     0 45441.8241    0  335 19988.2055 45441.8241   127%     -   21s
     0     0 45434.8217    0  339 19988.2055 45434.8217   127%     -   21s
     0     0 45425.5049    0  335 19988.2055 45425.5049   127%     -   21s
     0     0 45425.1258    0  334 19988.2055 45425.1258   127%     -   22s
     0     0 44135.5212    0  358 19988.2055 44135.5212   121%     -   28s
H    0     0                    20301.635664 44131.4949   117%     -   28s
     0     0 43335.5149    0  324 20301.6357 43335.5149   113%     -   31s
     0     0 43137.9991    0  398 20301.6357 43137.9991   112%     -   33s
     0     0 43058.4262    0  363 20301.6357 43058.4262   112%     -   34s
     0     0 43010.3250    0  355 20301.6357 43010.3250   112%     -   35s
     0     0 42989.3206    0  366 20301.6357 42989.3206   112%     -   35s
     0     0 42925.8958    0  374 20301.6357 42925.8958   111%     -   36s
     0     0 42917.0624    0  399 20301.6357 42917.0624   111%     -   36s
     0     0 42913.1845    0  372 20301.6357 42913.1845   111%     -   37s
     0     0 42911.7180    0  401 20301.6357 42911.7180   111%     -   37s
     0     0 42908.9894    0  372 20301.6357 42908.9894   111%     -   37s
     0     0 42906.2514    0  401 20301.6357 42906.2514   111%     -   37s
     0     0 42906.2395    0  375 20301.6357 42906.2395   111%     -   37s
     0     0 42177.9309    0  401 20301.6357 42177.9309   108%     -   44s
     0     0 41742.8178    0  421 20301.6357 41742.8178   106%     -   47s
     0     0 41522.7369    0  438 20301.6357 41522.7369   105%     -   49s
     0     0 41469.4225    0  427 20301.6357 41469.4225   104%     -   50s
     0     0 41454.1438    0  431 20301.6357 41454.1438   104%     -   51s
     0     0 41408.6101    0  427 20301.6357 41408.6101   104%     -   52s
     0     0 41383.6719    0  428 20301.6357 41383.6719   104%     -   52s
     0     0 41379.9443    0  458 20301.6357 41379.9443   104%     -   52s
     0     0 41378.6921    0  429 20301.6357 41378.6921   104%     -   53s
     0     0 41219.6627    0  447 20301.6357 41219.6627   103%     -   55s
     0     0 41146.3060    0  447 20301.6357 41146.3060   103%     -   56s
     0     0 41110.0139    0  455 20301.6357 41110.0139   102%     -   57s
     0     0 41090.9857    0  461 20301.6357 41090.9857   102%     -   58s
     0     0 41080.0120    0  461 20301.6357 41080.0120   102%     -   58s
     0     0 41075.8798    0  461 20301.6357 41075.8798   102%     -   58s
     0     0 41074.4180    0  464 20301.6357 41074.4180   102%     -   59s
     0     0 40973.5832    0  478 20301.6357 40973.5832   102%     -   61s
     0     0 40947.3692    0  483 20301.6357 40947.3692   102%     -   63s
     0     0 40939.8363    0  497 20301.6357 40939.8363   102%     -   63s
     0     0 40936.6683    0  496 20301.6357 40936.6683   102%     -   63s
     0     0 40935.3683    0  498 20301.6357 40935.3683   102%     -   63s
     0     0 40909.7366    0  471 20301.6357 40909.7366   102%     -   65s
     0     0 40898.9911    0  465 20301.6357 40898.9911   101%     -   65s
     0     0 40897.2503    0  468 20301.6357 40897.2503   101%     -   66s
     0     0 40894.8121    0  466 20301.6357 40894.8121   101%     -   66s
     0     0 40894.1205    0  471 20301.6357 40894.1205   101%     -   66s
     0     0 40863.4334    0  458 20301.6357 40863.4334   101%     -   67s
H    0     0                    20403.163666 40862.4264   100%     -   68s
     0     0 40849.4098    0  463 20403.1637 40849.4098   100%     -   69s
     0     0 40847.5938    0  466 20403.1637 40847.5938   100%     -   69s
     0     0 40844.2535    0  462 20403.1637 40844.2535   100%     -   69s
     0     0 40843.9105    0  470 20403.1637 40843.9105   100%     -   69s
     0     0 40836.0328    0  476 20403.1637 40836.0328   100%     -   70s
     0     0 40826.6789    0  464 20403.1637 40826.6789   100%     -   71s
     0     0 40825.8445    0  472 20403.1637 40825.8445   100%     -   71s
     0     0 40813.6831    0  417 20403.1637 40813.6831   100%     -   72s
H    0     0                    20423.960326 40812.5317   100%     -   73s
H    0     0                    20896.547745 40812.5317  95.3%     -   73s
H    0     0                    20905.426207 40812.5317  95.2%     -   73s
     0     0 40812.5317    0  419 20905.4262 40812.5317  95.2%     -   73s
     0     0 40801.5646    0  452 20905.4262 40801.5646  95.2%     -   74s
     0     0 40800.0137    0  423 20905.4262 40800.0137  95.2%     -   75s
     0     0 40795.5506    0  423 20905.4262 40795.5506  95.1%     -   75s
     0     0 40792.2936    0  425 20905.4262 40792.2936  95.1%     -   76s
     0     0 40791.7056    0  423 20905.4262 40791.7056  95.1%     -   76s
     0     0 40785.3785    0  417 20905.4262 40785.3785  95.1%     -   77s
     0     0 40785.1732    0  417 20905.4262 40785.1732  95.1%     -   77s
H    0     0                    21106.864302 40784.9949  93.2%     -   91s
     0     2 40784.9949    0  417 21106.8643 40784.9949  93.2%     -   91s
     3     8 40570.6865    2  458 21106.8643 40645.2331  92.6%  1901   98s
     7    16 40418.3630    3  416 21106.8643 40568.8365  92.2%  3040  101s
    15    32 40298.8915    4  460 21106.8643 40418.0168  91.5%  3412  107s
    31    52 35712.3094    5  335 21106.8643 40298.6993  90.9%  4795  118s
    51    84 37874.9362    6  352 21106.8643 40298.6993  90.9%  4451  125s
H   53    84                    21579.329783 40298.6993  86.7%  4359  125s
H   59    84                    21729.030458 40298.6993  85.5%  4301  125s
H   61    84                    22018.511929 40298.6993  83.0%  4224  125s
H   79    84                    22194.395569 40298.6993  81.6%  3641  125s
    83   241 37851.1395    7  345 22194.3956 40298.6993  81.6%  3517  131s
   240   315 37467.1775   10  375 22194.3956 40298.6993  81.6%  1895  135s
   387   451 35755.7420   10  323 22194.3956 40298.6993  81.6%  1622  142s
   450   532 37421.3183   11  369 22194.3956 40298.6993  81.6%  1597  145s
H  563   611                    22365.347758 40298.6993  80.2%  1472  149s
   610   694 36661.5354   12  358 22365.3478 40298.6993  80.2%  1431  153s
   693   726 37125.8965   13  349 22365.3478 40298.6993  80.2%  1354  156s
   770   794 36757.4850   15  365 22365.3478 40298.6993  80.2%  1334  165s
H  813   826                    22425.031172 40298.6993  79.7%  1321  167s
   837   858 36334.9721   17  364 22425.0312 40298.6993  79.7%  1306  171s
   901   919 36153.3698   18  366 22425.0312 40298.6993  79.7%  1274  177s
H  908   919                    22759.164507 40298.6993  77.1%  1267  177s
   938   946 36115.4354   18  362 22759.1645 40298.6993  77.1%  1255  184s
H  959   946                    22790.372765 40298.6993  76.8%  1240  184s
   975  1023 36132.2659   18  360 22790.3728 39851.3216  74.9%  1247  191s
  1060  1106 32160.1028   16  260 22790.3728 39842.9883  74.8%  1241  196s
  1157  1201 36134.0818   19  369 22790.3728 39842.9883  74.8%  1206  201s
  1279  1279 35453.9157   19  346 22790.3728 39842.9883  74.8%  1169  206s
  1379  1347 35253.7987   19  314 22790.3728 39842.9883  74.8%  1159  212s
  1496  1421 35254.7416   19  317 22790.3728 39718.1079  74.3%  1145  217s
  1596  1491 35301.1172   20  302 22790.3728 39247.7488  72.2%  1147  223s
  1696  1571 35339.8017   20  337 22790.3728 39247.7488  72.2%  1156  229s
  1798  1635 35353.2284   20  295 22790.3728 39247.7488  72.2%  1163  235s
  1886  1733 32984.3588   21  197 22790.3728 39247.7488  72.2%  1178  242s
  1998  1767 34572.9654   21  295 22790.3728 39247.7488  72.2%  1177  247s
  2038  1824 33114.1012   21  224 22790.3728 39247.7488  72.2%  1185  252s
  2101  1930 34265.3401   21  319 22790.3728 39247.7488  72.2%  1186  256s
  2227  2071 33153.4870   21  217 22790.3728 39247.7488  72.2%  1161  263s
  2386  2100 34169.0500   22  333 22790.3728 38815.3962  70.3%  1139  269s
  2428  2129 33743.3616   22  230 22790.3728 38726.2869  69.9%  1141  273s
H 2457  2129                    22814.271206 38726.2869  69.7%  1143  273s
  2463  2287 31289.6560   22  216 22814.2712 38726.2869  69.7%  1144  279s
  2703  2465 31946.2373   22  183 22814.2712 38726.2869  69.7%  1097  286s
  2921  2613 33190.6255   23  230 22814.2712 38479.1450  68.7%  1070  292s
  3161  2734 30244.6584   25  209 22814.2712 38479.1450  68.7%  1044  302s
  3344  2886 30650.8762   26  183 22814.2712 38375.9856  68.2%  1045  309s
  3523  2887 33855.7744   13  417 22814.2712 38375.9856  68.2%  1045  334s
  3525  2888 25025.5327   54  178 22814.2712 38375.9856  68.2%  1044  343s
  3526  2889 24647.9787   35  369 22814.2712 38375.9856  68.2%  1044  352s
  3527  2890 33119.3927   15  381 22814.2712 38375.9856  68.2%  1044  356s
  3528  2890 28885.9960   24  412 22814.2712 38375.9856  68.2%  1043  361s
  3530  2892 30351.2213   22  462 22814.2712 38375.9856  68.2%  1043  367s
  3532  2893 24838.6339   41  426 22814.2712 38375.9856  68.2%  1042  371s
  3535  2895 28961.4407   36  460 22814.2712 38375.9856  68.2%  1041  375s
  3537  2896 37228.2063   11  424 22814.2712 38375.9856  68.2%  1041  381s
  3540  2898 32570.2660   13  499 22814.2712 38375.9856  68.2%  1040  387s
  3542  2900 25710.0937   54  495 22814.2712 38375.9856  68.2%  1039  390s
  3545  2902 30107.7550   15  502 22814.2712 38375.9856  68.2%  1038  395s
  3547  2903 23954.3318   65  492 22814.2712 38375.9856  68.2%  1038  400s
  3548  2904 30201.9345   28  475 22814.2712 38375.9856  68.2%  1037  405s
  3552  2906 26512.6342   31  445 22814.2712 38375.9856  68.2%  1036  411s
  3555  2908 24214.3044   39  434 22814.2712 38375.9856  68.2%  1035  425s
  3556  2909 26725.9271   58  434 22814.2712 38375.9856  68.2%  1035  435s
  3557  2913 38375.9856   15  358 22814.2712 38375.9856  68.2%  1058  443s
  3559  2916 38375.9856   16  369 22814.2712 38375.9856  68.2%  1058  452s
  3563  2923 38375.9856   17  434 22814.2712 38375.9856  68.2%  1062  461s
  3571  2936 38375.9856   18  455 22814.2712 38375.9856  68.2%  1072  475s
  3587  2951 38365.9686   19  442 22814.2712 38375.9856  68.2%  1094  491s
  3607  2976 37905.0697   20  394 22814.2712 38375.9856  68.2%  1121  505s
H 3609  2829                    22823.277567 38375.9856  68.1%  1122  505s
H 3611  2690                    22878.898245 38375.9856  67.7%  1124  505s
H 3614  2557                    22922.866691 38375.9856  67.4%  1127  505s
H 3624  2428                    22926.551782 38375.9856  67.4%  1133  505s
H 3626  2309                    22972.733902 38375.9856  67.1%  1134  505s
  3639  2411 35796.2525   21  308 22972.7339 38375.9856  67.1%  1140  517s
  3746  2408 34527.5697   23  322 22972.7339 38375.9856  67.1%  1216  523s
  3778  2429 32240.5898   23  347 22972.7339 38375.9856  67.1%  1224  528s
  3810  2449 35071.7103   22  308 22972.7339 38375.9856  67.1%  1228  534s
  3843  2480 34505.9771   24  319 22972.7339 38375.9856  67.1%  1236  540s
  3887  2508 29565.8417   24  336 22972.7339 38375.9856  67.1%  1246  547s
  3967  2514 33684.8334   23  291 22972.7339 38375.9856  67.1%  1255  559s
  4057  2524 34464.7449   23  347 22972.7339 38375.9856  67.1%  1264  567s
  4131  2547 30658.2882   24  310 22972.7339 38375.9856  67.1%  1277  573s
  4208  2575 32994.5251   25  293 22972.7339 38375.9856  67.1%  1285  579s
  4282  2602 32141.0093   26  286 22972.7339 38375.9856  67.1%  1297  585s
  4350  2626 30635.3988   28  232 22972.7339 38375.9856  67.1%  1306  593s
  4421  2651 28897.7986   29  231 22972.7339 38375.9856  67.1%  1315  601s
  4508  2682 25258.3276   31  125 22972.7339 37901.1725  65.0%  1319  608s
  4602  2693 28125.8974   31  243 22972.7339 37286.3113  62.3%  1323  617s
  4705  2718 26986.7533   34  161 22972.7339 37286.3113  62.3%  1324  626s
  4805  2748 24734.9280   35  117 22972.7339 37286.3113  62.3%  1328  635s
  4899  2754 25443.6373   36  132 22972.7339 37286.3113  62.3%  1333  647s
  5012  2771 24478.7678   37  113 22972.7339 36989.6317  61.0%  1338  654s
  5122  2790     cutoff   40      22972.7339 36989.6317  61.0%  1345  661s
  5218  2779 32610.1021   23  256 22972.7339 36631.0440  59.5%  1357  667s
  5260  2786 31457.6067   24  242 22972.7339 36631.0440  59.5%  1359  676s
H 5267  2671                    23031.343456 36631.0440  59.0%  1359  676s
H 5277  2560                    23072.490165 36631.0440  58.8%  1361  676s
  5309  2618 30906.1980   25  223 23072.4902 36631.0440  58.8%  1365  685s
  5423  2645 27976.3245   29  229 23072.4902 36631.0440  58.8%  1373  694s
  5568  2675 25115.7072   33  182 23072.4902 36631.0440  58.8%  1377  703s
  5708  2684     cutoff   38      23072.4902 36631.0440  58.8%  1377  713s
  5866  2704 28862.8860   26  431 23072.4902 36631.0440  58.8%  1380  723s
  5999  2712 23756.0485   28  418 23072.4902 36044.4962  56.2%  1389  734s
  6156  2724     cutoff   30      23072.4902 35862.8060  55.4%  1394  747s
  6312  2733 25683.4104   26  309 23072.4902 35862.8060  55.4%  1405  758s
  6493  2734 23727.9981   29  370 23072.4902 35862.8060  55.4%  1408  770s
  6656  2750     cutoff   30      23072.4902 34999.5446  51.7%  1416  781s
  6847  2764 28837.5333   22  376 23072.4902 34816.5704  50.9%  1423  792s
  7007  2807 23119.5461   28  250 23072.4902 34816.5704  50.9%  1435  803s
  7203  2838     cutoff   29      23072.4902 34511.5527  49.6%  1441  814s
  7252  2822 23321.0144   30  253 23072.4902 34511.5527  49.6%  1441  815s
  7442  2865 28627.8070   25  255 23072.4902 34511.5527  49.6%  1440  826s
  7763  2863     cutoff   31      23072.4902 34506.1666  49.6%  1427  840s
  8062  2827 29991.1997   23  348 23072.4902 34287.6611  48.6%  1423  852s
  8288  2843 28467.0595   24  305 23072.4902 34287.6611  48.6%  1415  866s
  8559  2850 27892.7698   25  331 23072.4902 34287.6611  48.6%  1414  879s
  8810  2885 24700.6283   29  221 23072.4902 33902.4600  46.9%  1418  893s
  9157  2889     cutoff   26      23072.4902 33490.7552  45.2%  1414  907s
  9442  2910     cutoff   28      23072.4902 33490.7552  45.2%  1420  923s
  9775  2861 25498.6217   28  306 23072.4902 33490.7552  45.2%  1423  937s
  9823  2920 26970.5061   27  346 23072.4902 33490.7552  45.2%  1424  952s
  9986  3059 23842.1501   28  334 23072.4902 33490.7552  45.2%  1429  968s
 10332  3197 23571.4517   31  256 23072.4902 32847.1277  42.4%  1433  986s
 10707  3329     cutoff   25      23072.4902 32594.6669  41.3%  1435 1004s
 11124  3456     cutoff   26      23072.4902 32350.8933  40.2%  1434 1022s
 11560  3581 27799.2172   27  219 23072.4902 32215.8320  39.6%  1435 1040s
 11910  3699 24133.3925   31  233 23072.4902 32050.1251  38.9%  1447 1059s
 12380  3856 26883.6768   32  242 23072.4902 32050.1251  38.9%  1447 1079s
 12912  4026 29264.7188   26  303 23072.4902 31921.0058  38.4%  1442 1099s
 13468  4187 28429.9882   30  263 23072.4902 31568.6130  36.8%  1436 1120s
 13955  4352 26305.9213   28  336 23072.4902 31568.6130  36.8%  1433 1142s
 14464  4536 27632.4684   32  244 23072.4902 31381.1238  36.0%  1429 1163s
 15095  4698 24272.5962   30  321 23072.4902 31219.4969  35.3%  1424 1189s
 15653  4882 28629.6891   29  329 23072.4902 31069.2664  34.7%  1426 1214s
 16285  5079 26254.4234   33  275 23072.4902 30925.7456  34.0%  1425 1239s
 16967  5290 24057.0076   27  295 23072.4902 30684.7474  33.0%  1421 1269s
 17700  5472 23954.8729   35  101 23072.4902 30650.1054  32.8%  1416 1295s
 18275  5661 27352.5868   30  184 23072.4902 30650.1054  32.8%  1409 1323s
 19026  5683 23607.1677   34  259 23072.4902 30416.5309  31.8%  1406 1350s
H19123  5618                    23359.031034 30341.1501  29.9%  1407 1350s
 19140  5753 26220.5210   27  341 23359.0310 30341.1501  29.9%  1407 1378s
H19297  5687                    23512.195939 30341.1501  29.0%  1405 1378s
 19840  5888 26637.1621   25  218 23512.1959 30246.5731  28.6%  1405 1409s
 20675  6013 24503.0656   31  245 23512.1959 30055.9649  27.8%  1404 1441s
 21573  6229 24016.9788   27  236 23512.1959 29938.7822  27.3%  1400 1473s
 22524  6380     cutoff   33      23512.1959 29804.8286  26.8%  1394 1505s
 23483  6639 25330.8405   26  350 23512.1959 29639.2687  26.1%  1390 1540s
 24480  6882 26831.9555   28  348 23512.1959 29502.3532  25.5%  1383 1575s
 25614  7070 27281.7684   31  358 23512.1959 29355.3099  24.9%  1374 1612s
 26643  7252 25504.0962   35  266 23512.1959 29187.8602  24.1%  1367 1649s
 27725  7440     cutoff   34      23512.1959 29031.1413  23.5%  1365 1687s
 28896  7620 26687.1597   30  315 23512.1959 28876.7435  22.8%  1360 1739s
 30239  7816 27069.5794   33  160 23512.1959 28728.8953  22.2%  1354 1775s
 31462  8071     cutoff   34      23512.1959 28557.9965  21.5%  1345 1812s
 32753  8223 24488.9412   38  144 23512.1959 28436.1500  20.9%  1335 1848s
 33966  8388 infeasible   35      23512.1959 28289.2427  20.3%  1329 1889s
 35268  8559 24246.9351   31  216 23512.1959 28159.4077  19.8%  1322 1928s
 36672  8663 25612.0078   33  211 23512.1959 28068.1944  19.4%  1314 1969s
 38058  8791     cutoff   31      23512.1959 27911.8040  18.7%  1308 2011s
 39579  8830 24966.3637   33  296 23512.1959 27795.8373  18.2%  1300 2055s
 41203  8898 infeasible   25      23512.1959 27626.6997  17.5%  1290 2099s
 42843  9046     cutoff   34      23512.1959 27483.6348  16.9%  1282 2145s
 44600  9102     cutoff   35      23512.1959 27335.1734  16.3%  1271 2192s
 46469  9183     cutoff   30      23512.1959 27216.3381  15.8%  1260 2240s
 48617  9137 25250.6654   26  298 23512.1959 27046.7354  15.0%  1245 2290s
 50644  9063 25017.0398   34  246 23512.1959 26875.7306  14.3%  1234 2342s
 52717  8966     cutoff   30      23512.1959 26724.4367  13.7%  1224 2392s
 55071  8716     cutoff   37      23512.1959 26559.2218  13.0%  1211 2444s
 57306  8313     cutoff   30      23512.1959 26354.9635  12.1%  1201 2498s
 59776  7766 24504.2904   32  282 23512.1959 26191.4999  11.4%  1187 2554s
 62395  6896     cutoff   35      23512.1959 25959.2903  10.4%  1173 2610s
 65226  5755 infeasible   43      23512.1959 25729.8136  9.43%  1158 2665s
 68222  4000     cutoff   37      23512.1959 25469.4485  8.32%  1139 2719s
 71812  1820 24028.8523   35  131 23512.1959 25027.6918  6.45%  1114 2760s
 75095  3864     cutoff   38      23512.1959 24414.1558  3.84%  1081 2786s
*79508  3864              90    23514.915012 24411.2595  3.81%  1025 2787s
*80985  3864              95    23585.491465 24410.8610  3.50%  1008 2787s
 87656  2004     cutoff  105      23585.4915 24028.9901  1.88%   937 2812s
*89032  1868              92    23596.632895 24027.6235  1.83%   924 2812s
*90183  1801              83    23601.337206 24027.6235  1.81%   913 2812s
H92363  1145                    23674.899817 24020.7198  1.46%   893 2812s

Cutting planes:
  Learned: 1
  MIR: 1132
  Mixing: 4
  Flow cover: 1725
  RLT: 10
  Relax-and-lift: 95

Explored 104803 nodes (83245297 simplex iterations) in 2814.01 seconds (6184.58 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 23674.9 23674.9 23601.3 ... 22972.7

Optimal solution found (tolerance 1.00e-04)
Best objective 2.367489981657e+04, best bound 2.367489981657e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2814.10s
  Master Objective (UB) = 23674.90, θ = 193961.73
  Upper Bound (UB) = 23674.90

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 193961.73
  [DEBUG]   ✓ Scenario 0: θ = 193961.73 ≤ Q = 193961.73 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 193961.73 ≤ Q = 194006.95 (slack: 45.23)
  [DEBUG]   ✓ Scenario 2: θ = 193961.73 ≤ Q = 193961.73 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 193961.73 ≤ Q = 193961.73 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x53364961
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xacc9b69f
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.295731e+13
Presolve removed 2604 rows and 1894 columns
Presolve time: 0.01s
Presolved: 489 rows, 495 columns, 1380 nonzeros
Found heuristic solution: objective 5528584.8199
Variable types: 336 continuous, 159 integer (159 binary)
Found heuristic solution: objective 5528091.2926

Root relaxation: objective -1.961460e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -196146.04    0  127 5528091.29 -196146.04   104%     -    0s
H    0     0                    -174722.4204 -196146.04  12.3%     -    0s
     0     0 -184699.45    0   81 -174722.42 -184699.45  5.71%     -    0s
H    0     0                    -182207.9481 -184587.89  1.31%     -    0s
H    0     0                    -182504.7897 -183628.18  0.62%     -    0s
     0     0 -183628.18    0   87 -182504.79 -183628.18  0.62%     -    0s
     0     0 -183614.81    0   87 -182504.79 -183614.81  0.61%     -    0s
     0     0 -182896.95    0   30 -182504.79 -182896.95  0.21%     -    0s
     0     0 -182879.54    0   27 -182504.79 -182879.54  0.21%     -    0s
     0     0 -182876.16    0   24 -182504.79 -182876.16  0.20%     -    0s
H    0     0                    -182520.0196 -182857.42  0.18%     -    0s
     0     0 -182817.05    0   25 -182520.02 -182817.05  0.16%     -    0s
     0     0 -182816.58    0   24 -182520.02 -182816.58  0.16%     -    0s
     0     0 -182816.38    0   24 -182520.02 -182816.38  0.16%     -    0s
H    0     0                    -182539.2068 -182816.38  0.15%     -    0s
H    0     0                    -182589.3416 -182816.38  0.12%     -    0s
H    0     0                    -182693.6579 -182816.38  0.07%     -    0s
     0     0 -182758.95    0    8 -182693.66 -182758.95  0.04%     -    0s
     0     0 -182758.95    0    7 -182693.66 -182758.95  0.04%     -    0s
H    0     0                    -182725.9836 -182758.95  0.02%     -    0s
H    0     0                    -182728.2908 -182758.95  0.02%     -    0s
     0     0          -    0      -182728.29 -182745.28  0.01%     -    0s

Cutting planes:
  Gomory: 3
  Implied bound: 2
  Flow cover: 4
  Relax-and-lift: 3

Explored 1 nodes (674 simplex iterations) in 0.12 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -182728 -182726 -182694 ... 5.52809e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.827282907680e+05, best bound -1.827452755720e+05, gap 0.0093%
  Subproblem solved in 0.15s
  Worst-case operational profit (Z_SP) = 171234.60
  Scenario: 40 demand increases, 20 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -182728.29
  [DEBUG]   S×d_nominal = 353962.89
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 353962.89 + -182728.29 = 171234.60
  [DEBUG]   Current θ from Master = 193961.73
  [DEBUG]   ⚠️  Z_SP ≤ θ by 22727.12 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 947.78
  Lower Bound (LB) = 19242.46
  Gap (UB-LB) = 4432.4425, Absolute Gap = 4432.4425, Relative Gap = 0.187221
  Not converged yet (gap = 4432.44 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 40 increases, 20 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221674 nonzeros
Model fingerprint: 0xe3d8ff89
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 35350 rows and 14350 columns
Presolve time: 1.09s
Presolved: 42483 rows, 19110 columns, 263069 nonzeros
Variable types: 16851 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -311526.7819
Found heuristic solution: objective -188257.0362

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 42483 rows, 19110 columns, 263069 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   28518   -5.6225848e+03   0.000000e+00   2.663725e+08      5s
   42930    2.1177635e+04   0.000000e+00   2.435382e+06     10s
   54755    3.6260325e+04   0.000000e+00   4.001668e+06     15s
Concurrent spin time: 0.64s

Solved with dual simplex

Root relaxation: objective 5.315538e+04, 27902 iterations, 15.18 seconds (19.94 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 53155.3850    0  139 -188257.04 53155.3850   128%     -   16s
H    0     0                    -173959.8448 53155.3850   131%     -   16s
H    0     0                    -170869.3566 53155.3850   131%     -   17s
H    0     0                    -169845.2130 53155.3850   131%     -   17s
H    0     0                    -64450.90261 53155.3850   182%     -   17s
H    0     0                    -31386.91450 53155.3850   269%     -   17s
H    0     0                    -12347.00125 53155.3850   531%     -   17s
H    0     0                    1679.2518575 53155.3850  3065%     -   17s
H    0     0                    1943.9314885 53155.3850  2634%     -   17s
H    0     0                    4685.2343299 53155.3850  1035%     -   17s
H    0     0                    5054.4299631 53155.3850   952%     -   17s
H    0     0                    5384.7635980 53155.3850   887%     -   18s
H    0     0                    9141.9194997 48940.4380   435%     -   25s
H    0     0                    9215.8947951 48940.4380   431%     -   25s
H    0     0                    9248.7158324 48940.4380   429%     -   25s
     0     0 48940.4380    0  242 9248.71583 48940.4380   429%     -   25s
H    0     0                    9287.3317853 48940.3687   427%     -   26s
     0     0 48123.6916    0  237 9287.33179 48123.6916   418%     -   29s
     0     0 48123.6916    0  244 9287.33179 48123.6916   418%     -   31s
     0     0 48123.6916    0  241 9287.33179 48123.6916   418%     -   31s
     0     0 48123.6916    0  248 9287.33179 48123.6916   418%     -   31s
     0     0 48123.6915    0  243 9287.33179 48123.6915   418%     -   31s
     0     0 48123.6866    0  245 9287.33179 48123.6866   418%     -   31s
H    0     0                    9399.8832333 45643.1084   386%     -   39s
H    0     0                    9403.4908845 45643.1084   385%     -   39s
     0     0 45516.2718    0  298 9403.49088 45516.2718   384%     -   39s
H    0     0                    9912.8113083 44630.4183   350%     -   45s
H    0     0                    10372.442237 44630.4183   330%     -   45s
     0     0 44630.4183    0  314 10372.4422 44630.4183   330%     -   45s
     0     0 44351.1131    0  349 10372.4422 44351.1131   328%     -   47s
     0     0 44148.4850    0  360 10372.4422 44148.4850   326%     -   48s
     0     0 44091.7029    0  369 10372.4422 44091.7029   325%     -   50s
     0     0 44076.3380    0  369 10372.4422 44076.3380   325%     -   50s
     0     0 44073.2852    0  366 10372.4422 44073.2852   325%     -   50s
     0     0 44070.2886    0  375 10372.4422 44070.2886   325%     -   50s
     0     0 44070.0154    0  375 10372.4422 44070.0154   325%     -   50s
H    0     0                    14450.221776 44070.0154   205%     -   55s
H    0     0                    14568.140815 44070.0154   203%     -   55s
H    0     0                    14582.271037 44070.0154   202%     -   55s
H    0     0                    14608.049380 44070.0154   202%     -   55s
H    0     0                    14669.114234 44070.0154   200%     -   55s
H    0     0                    14733.135961 42722.7400   190%     -   61s
H    0     0                    14782.004368 42722.7400   189%     -   61s
H    0     0                    14836.591833 42722.7400   188%     -   61s
H    0     0                    14852.163911 42722.7400   188%     -   61s
     0     0 42722.7400    0  398 14852.1639 42722.7400   188%     -   61s
H    0     0                    16458.938469 42722.4715   160%     -   62s
H    0     0                    16634.180934 42722.4715   157%     -   62s
     0     0 42413.5327    0  406 16634.1809 42413.5327   155%     -   66s
     0     0 42246.3505    0  416 16634.1809 42246.3505   154%     -   68s
     0     0 42112.9310    0  428 16634.1809 42112.9310   153%     -   69s
     0     0 42060.5231    0  430 16634.1809 42060.5231   153%     -   70s
     0     0 42036.0538    0  429 16634.1809 42036.0538   153%     -   71s
H    0     0                    17481.231540 42025.8446   140%     -   72s
     0     0 42025.8446    0  433 17481.2315 42025.8446   140%     -   72s
     0     0 42021.1281    0  434 17481.2315 42021.1281   140%     -   72s
     0     0 42016.5527    0  429 17481.2315 42016.5527   140%     -   72s
     0     0 42010.6360    0  435 17481.2315 42010.6360   140%     -   73s
     0     0 41992.2940    0  429 17481.2315 41992.2940   140%     -   73s
     0     0 41990.0000    0  426 17481.2315 41990.0000   140%     -   73s
     0     0 41989.2193    0  429 17481.2315 41989.2193   140%     -   73s
H    0     0                    17626.536131 41989.2193   138%     -   79s
     0     0 41234.8946    0  421 17626.5361 41234.8946   134%     -   85s
H    0     0                    18038.916981 41024.7631   127%     -   88s
H    0     0                    18123.550752 41024.7631   126%     -   88s
     0     0 41024.7631    0  448 18123.5508 41024.7631   126%     -   88s
     0     0 40961.4974    0  437 18123.5508 40961.4974   126%     -   91s
     0     0 40921.8738    0  450 18123.5508 40921.8738   126%     -   92s
     0     0 40904.6068    0  460 18123.5508 40904.6068   126%     -   93s
     0     0 40884.9049    0  452 18123.5508 40884.9049   126%     -   94s
     0     0 40869.7225    0  464 18123.5508 40869.7225   126%     -   94s
     0     0 40858.6916    0  456 18123.5508 40858.6916   125%     -   95s
     0     0 40848.1197    0  457 18123.5508 40848.1197   125%     -   96s
     0     0 40838.9769    0  460 18123.5508 40838.9769   125%     -   96s
     0     0 40837.3085    0  458 18123.5508 40837.3085   125%     -   97s
     0     0 40836.8749    0  461 18123.5508 40836.8749   125%     -   97s
     0     0 40717.6879    0  434 18123.5508 40717.6879   125%     -  101s
H    0     0                    18722.833729 40717.6168   117%     -  101s
H    0     0                    18956.125508 40717.6168   115%     -  101s
H    0     0                    18963.838028 40717.6168   115%     -  101s
     0     0 40659.1043    0  378 18963.8380 40659.1043   114%     -  103s
     0     0 40634.1374    0  443 18963.8380 40634.1374   114%     -  105s
     0     0 40622.9043    0  392 18963.8380 40622.9043   114%     -  106s
     0     0 40617.3098    0  440 18963.8380 40617.3098   114%     -  106s
     0     0 40614.7136    0  441 18963.8380 40614.7136   114%     -  107s
     0     0 40612.7146    0  441 18963.8380 40612.7146   114%     -  107s
     0     0 40611.7781    0  438 18963.8380 40611.7781   114%     -  107s
     0     0 40473.8893    0  451 18963.8380 40473.8893   113%     -  110s
H    0     0                    20569.828956 40473.6033  96.8%     -  110s
     0     0 40435.2347    0  456 20569.8290 40435.2347  96.6%     -  113s
     0     0 40427.6705    0  459 20569.8290 40427.6705  96.5%     -  114s
     0     0 40420.1675    0  463 20569.8290 40420.1675  96.5%     -  115s
     0     0 40417.0775    0  450 20569.8290 40417.0775  96.5%     -  115s
     0     0 40413.6541    0  463 20569.8290 40413.6541  96.5%     -  115s
     0     0 40381.2634    0  461 20569.8290 40381.2634  96.3%     -  117s
     0     0 40376.4070    0  452 20569.8290 40376.4070  96.3%     -  118s
     0     0 40370.9511    0  457 20569.8290 40370.9511  96.3%     -  118s
     0     0 40370.2101    0  459 20569.8290 40370.2101  96.3%     -  118s
     0     0 40320.3876    0  441 20569.8290 40320.3876  96.0%     -  122s
     0     0 40299.3701    0  442 20569.8290 40299.3701  95.9%     -  123s
     0     0 40290.0774    0  445 20569.8290 40290.0774  95.9%     -  124s
     0     0 40287.1455    0  447 20569.8290 40287.1455  95.9%     -  125s
     0     0 40285.4949    0  454 20569.8290 40285.4949  95.8%     -  125s
     0     0 40285.1271    0  454 20569.8290 40285.1271  95.8%     -  126s
     0     0 40262.2148    0  444 20569.8290 40262.2148  95.7%     -  127s
     0     0 40240.8996    0  435 20569.8290 40240.8996  95.6%     -  129s
     0     0 40238.4450    0  443 20569.8290 40238.4450  95.6%     -  130s
     0     0 40237.6138    0  445 20569.8290 40237.6138  95.6%     -  130s
     0     0 40223.7780    0  452 20569.8290 40223.7780  95.5%     -  133s
     0     0 40219.3734    0  463 20569.8290 40219.3734  95.5%     -  133s
     0     0 40218.8987    0  457 20569.8290 40218.8987  95.5%     -  133s
     0     0 40209.5874    0  410 20569.8290 40209.5874  95.5%     -  135s
     0     0 40205.0507    0  456 20569.8290 40205.0507  95.5%     -  136s
     0     0 40197.6835    0  457 20569.8290 40197.6835  95.4%     -  137s
     0     0 40196.2525    0  451 20569.8290 40196.2525  95.4%     -  137s
     0     0 40183.7191    0  392 20569.8290 40183.7191  95.4%     -  138s
     0     0 40180.0358    0  456 20569.8290 40180.0358  95.3%     -  139s
     0     0 40179.4564    0  463 20569.8290 40179.4564  95.3%     -  139s
     0     0 40132.8116    0  455 20569.8290 40132.8116  95.1%     -  141s
     0     0 40121.9690    0  502 20569.8290 40121.9690  95.1%     -  144s
     0     0 40118.8360    0  499 20569.8290 40118.8360  95.0%     -  144s
     0     0 40116.2739    0  502 20569.8290 40116.2739  95.0%     -  145s
     0     0 40114.5189    0  455 20569.8290 40114.5189  95.0%     -  145s
     0     0 40113.9674    0  457 20569.8290 40113.9674  95.0%     -  145s
     0     0 40103.5384    0  454 20569.8290 40103.5384  95.0%     -  147s
     0     0 40099.5231    0  458 20569.8290 40099.5231  94.9%     -  148s
     0     0 40099.2223    0  456 20569.8290 40099.2223  94.9%     -  148s
     0     0 40093.8041    0  498 20569.8290 40093.8041  94.9%     -  149s
     0     0 40091.6202    0  457 20569.8290 40091.6202  94.9%     -  168s
     0     0 40090.9734    0  507 20569.8290 40090.9734  94.9%     -  168s
     0     0 40089.8239    0  508 20569.8290 40089.8239  94.9%     -  169s
     0     0 40087.8349    0  506 20569.8290 40087.8349  94.9%     -  170s
     0     0 40087.4467    0  505 20569.8290 40087.4467  94.9%     -  170s
     0     0 40083.8399    0  498 20569.8290 40083.8399  94.9%     -  171s
     0     0 40083.7372    0  498 20569.8290 40083.7372  94.9%     -  172s
     0     2 40083.6249    0  498 20569.8290 40083.6249  94.9%     -  195s
     3     8 39922.8618    2  487 20569.8290 40042.1937  94.7%  3370  202s
     7    16 39898.0293    3  488 20569.8290 39922.4788  94.1%  4249  209s
    15    32 39774.5092    4  476 20569.8290 39897.4875  94.0%  4610  218s
    31    51 38212.2378    5  398 20569.8290 39768.5559  93.3%  6508  233s
    50    83 37096.8520    6  417 20569.8290 39768.5559  93.3%  6386  241s
H   59    83                    20941.394892 39768.5559  89.9%  6224  241s
    82   115 36766.8349    7  327 20941.3949 39768.5559  89.9%  5519  248s
   114   147 36699.0572    8  412 20941.3949 39768.5559  89.9%  5124  255s
   146   179 36690.7547    9  343 20941.3949 39768.5559  89.9%  4417  262s
   178   214 35963.4943   10  303 20941.3949 39768.5559  89.9%  3813  269s
   213   254 36211.5527    9  403 20941.3949 39768.5559  89.9%  3542  277s
   253   322 35707.7126    8  349 20941.3949 39768.5559  89.9%  3314  285s
   321   422 36022.9336   10  396 20941.3949 39768.5559  89.9%  2926  293s
   421   532 35899.6314   11  394 20941.3949 39768.5559  89.9%  2544  300s
   531   564 33137.8606   11  283 20941.3949 39768.5559  89.9%  2263  307s
   563   596 35822.1303   11  383 20941.3949 39768.5559  89.9%  2191  311s
   595   628 35808.2140   10  371 20941.3949 39768.5559  89.9%  2136  315s
   627   661 35656.2881   11  375 20941.3949 39768.5559  89.9%  2095  320s
   660   692 35889.8644   12  391 20941.3949 39768.5559  89.9%  2048  325s
   697   726 35801.6096   13  385 20941.3949 39768.5559  89.9%  2014  331s
   735   787 35477.4980   14  331 20941.3949 39664.3219  89.4%  1982  337s
   798   863 34915.5708   16  324 20941.3949 39664.3219  89.4%  1915  346s
   876   960 34831.5365   14  357 20941.3949 39664.3219  89.4%  1864  354s
   975  1056 35083.4138   17  341 20941.3949 39664.3219  89.4%  1781  361s
  1085  1137 34824.6462   17  326 20941.3949 39664.3219  89.4%  1713  368s
  1202  1220 34769.2739   18  336 20941.3949 39664.3219  89.4%  1649  379s
  1313  1322 34162.4164   18  326 20941.3949 39490.0206  88.6%  1619  385s
  1435  1441 33740.9154   18  354 20941.3949 39489.8467  88.6%  1586  393s
  1574  1563 34357.0543   20  320 20941.3949 39489.8467  88.6%  1534  401s
  1719  1673 34217.0723   21  314 20941.3949 39489.8467  88.6%  1500  412s
  1874  1754 30978.4204   19  332 20941.3949 39489.8467  88.6%  1469  422s
  1971  1843 33577.4462   21  292 20941.3949 39489.8467  88.6%  1506  430s
  2066  1928 32828.1954   22  264 20941.3949 39489.8467  88.6%  1523  439s
  2161  2055 31682.4961   23  301 20941.3949 39489.8467  88.6%  1538  450s
  2325  2189 30940.1224   25  276 20941.3949 39489.8467  88.6%  1514  458s
  2485  2326 31147.7432   25  282 20941.3949 39489.8467  88.6%  1499  469s
  2648  2522 30338.6946   26  314 20941.3949 39489.8467  88.6%  1493  481s
  2860  2794 28297.6226   26  247 20941.3949 39489.8467  88.6%  1461  489s
  3141  2795 30393.7260   33  498 20941.3949 39489.8467  88.6%  1395  523s
  3143  2796 34870.0595   24  139 20941.3949 39489.8467  88.6%  1394  540s
  3144  2797 33957.6841   35  259 20941.3949 39489.8467  88.6%  1394  554s
  3145  2798 35726.2124    9  332 20941.3949 39489.8467  88.6%  1393  563s
  3146  2798 37702.9513   14  413 20941.3949 39489.8467  88.6%  1393  570s
  3147  2799 22986.9497   44  424 20941.3949 39489.8467  88.6%  1393  578s
  3148  2800 30192.0219   27  422 20941.3949 39489.8467  88.6%  1392  583s
  3149  2800 30802.6498   49  409 20941.3949 39489.8467  88.6%  1392  588s
  3150  2801 24481.7588   68  480 20941.3949 39489.8467  88.6%  1391  591s
  3152  2802 34239.1395   13  484 20941.3949 39489.8467  88.6%  1390  597s
  3153  2803 36539.7771   13  482 20941.3949 39489.8467  88.6%  1390  600s
  3156  2805 37143.8408    9  425 20941.3949 39489.8467  88.6%  1389  605s
  3159  2807 35317.0168   16  447 20941.3949 39489.8467  88.6%  1387  611s
  3162  2809 25887.4279   68  464 20941.3949 39489.8467  88.6%  1386  616s
  3164  2810 31937.1488   25  447 20941.3949 39489.8467  88.6%  1385  621s
  3165  2811 34272.2395   11  462 20941.3949 39489.8467  88.6%  1385  627s
  3167  2812 29432.9877   40  459 20941.3949 39489.8467  88.6%  1384  630s
  3170  2814 28780.2730   24  457 20941.3949 39489.8467  88.6%  1382  638s
  3172  2816 30422.6056   42  463 20941.3949 39489.8467  88.6%  1382  641s
  3175  2818 28772.6994   22  503 20941.3949 39480.2613  88.5%  1380  648s
  3177  2819 24906.0983   58  506 20941.3949 39474.9292  88.5%  1379  650s
  3180  2821 31116.3221   37  466 20941.3949 39450.6399  88.4%  1378  655s
  3183  2823 37003.5169   10  505 20941.3949 39421.0700  88.2%  1377  661s
  3186  2825 32905.2154   29  462 20941.3949 39388.6428  88.1%  1375  666s
  3188  2826 34099.2900   17  462 20941.3949 39388.6428  88.1%  1375  670s
  3191  2828 26591.9046   63  496 20941.3949 39370.3961  88.0%  1373  676s
  3192  2829 28860.2674   41  488 20941.3949 39347.8623  87.9%  1373  682s
  3195  2831 32192.2335   34  495 20941.3949 39340.7073  87.9%  1372  687s
  3197  2832 25795.6522   39  457 20941.3949 39307.0009  87.7%  1371  690s
  3198  2833 35677.0657   10  457 20941.3949 39307.0009  87.7%  1370  709s
  3199  2834 27624.4807   58  457 20941.3949 39306.5344  87.7%  1370  757s
  3200  2837 39239.5629   16  448 20941.3949 39306.5344  87.7%  1417  767s
  3202  2841 38847.6228   17  449 20941.3949 39239.3056  87.4%  1420  778s
  3206  2847 38597.7706   18  441 20941.3949 38989.0441  86.2%  1426  789s
  3214  2861 38135.6917   19  471 20941.3949 38588.9557  84.3%  1437  800s
  3230  2872 35077.1663   20  423 20941.3949 38134.6599  82.1%  1481  825s
  3247  2899 34485.8355   21  342 20941.3949 38134.6599  82.1%  1514  840s
  3279  3004 34402.6984   22  344 20941.3949 38134.6599  82.1%  1579  856s
  3395  3052 32928.6192   23  309 20941.3949 38134.6599  82.1%  1594  869s
  3482  3098 33867.8334   24  343 20941.3949 38134.6599  82.1%  1622  878s
  3557  3101 32660.9800   24  304 20941.3949 38134.6599  82.1%  1650  886s
  3592  3124 33212.1918   25  345 20941.3949 38134.6599  82.1%  1666  893s
  3632  3145 33458.5476   25  326 20941.3949 38134.6599  82.1%  1685  900s
  3672  3161 31480.5919   25  332 20941.3949 38134.6599  82.1%  1701  913s
  3713  3170 31524.8533   25  391 20941.3949 38134.6599  82.1%  1720  926s
  3756  3190 30842.0539   24  291 20941.3949 38134.6599  82.1%  1732  939s
  3807  3216 28364.1753   25  293 20941.3949 38134.6599  82.1%  1762  949s
  3859  3242 32045.0052   25  312 20941.3949 38134.6599  82.1%  1788  962s
  3939  3259 28903.2426   26  305 20941.3949 38134.6599  82.1%  1799  975s
  4003  3279 32454.3656   26  400 20941.3949 38134.6599  82.1%  1824  988s
  4067  3304 32760.4791   26  334 20941.3949 38134.6599  82.1%  1844 1000s
  4142  3341 30905.0983   27  382 20941.3949 38134.6599  82.1%  1869 1010s
  4225  3357 28937.7082   26  324 20941.3949 38134.6599  82.1%  1889 1026s
  4334  3363 29945.8780   28  403 20941.3949 37129.8702  77.3%  1894 1039s
  4411  3393 25122.3673   28  373 20941.3949 37129.8702  77.3%  1926 1054s
  4495  3407 28376.5836   29  360 20941.3949 37129.8702  77.3%  1954 1067s
  4601  3420 27753.0190   30  305 20941.3949 37129.8702  77.3%  1967 1082s
  4684  3464 27606.4248   31  330 20941.3949 36514.0846  74.4%  2004 1094s
  4779  3513 26928.7332   32  240 20941.3949 36514.0846  74.4%  2031 1106s
  4882  3543 25670.1711   33  241 20941.3949 36514.0846  74.4%  2041 1123s
  5023  3581 23569.9881   33  259 20941.3949 36514.0846  74.4%  2053 1136s
  5147  3596 25573.2893   34  250 20941.3949 36514.0846  74.4%  2072 1154s
  5306  3601 24440.0215   37  206 20941.3949 36514.0846  74.4%  2075 1173s
  5418  3639     cutoff   37      20941.3949 35969.5689  71.8%  2116 1187s
  5530  3689     cutoff   40      20941.3949 35562.5719  69.8%  2156 1202s
  5661  3719 29889.2681   23  400 20941.3949 35562.5719  69.8%  2179 1218s
  5787  3766 29411.9221   25  311 20941.3949 35562.5719  69.8%  2206 1236s
  5924  3824 24956.8380   27  282 20941.3949 35543.6752  69.7%  2226 1252s
  6095  3857 21614.8714   31  193 20941.3949 35193.0399  68.1%  2239 1272s
* 6138  3700              44    20998.789081 35193.0399  67.6%  2242 1272s
  6299  3714 31364.9364   24  446 20998.7891 35193.0399  67.6%  2250 1289s
* 6321  3565              46    21095.047005 35193.0399  66.8%  2260 1289s
  6476  3625 30295.6929   26  256 21095.0470 34694.0211  64.5%  2277 1307s
  6645  3650 24558.4953   31  197 21095.0470 34694.0211  64.5%  2304 1329s
  6869  3614 21279.9705   40  152 21095.0470 34694.0211  64.5%  2308 1346s
H 6876  3454                    21342.829340 34694.0211  62.6%  2307 1346s
  6990  3519 27867.6237   25  286 21342.8293 33675.7146  57.8%  2325 1367s
  7130  3563 22291.1821   29  267 21342.8293 33675.7146  57.8%  2378 1387s
  7333  3574 27544.1924   24  346 21342.8293 33644.7111  57.6%  2407 1408s
  7571  3571     cutoff   28      21342.8293 33597.6755  57.4%  2431 1429s
  7788  3525 27726.4897   28  297 21342.8293 33405.1462  56.5%  2476 1449s
  7843  3551 25727.4438   29  238 21342.8293 33405.1462  56.5%  2486 1472s
  8016  3536 31692.7093   28  370 21342.8293 33312.0165  56.1%  2502 1493s
  8105  3617 24312.9945   30  353 21342.8293 33312.0165  56.1%  2528 1517s
  8337  3645 29047.4201   31  252 21342.8293 33312.0165  56.1%  2564 1542s
  8608  3694 26042.6804   32  273 21342.8293 33312.0165  56.1%  2595 1569s
  8895  3728 25671.6797   33  262 21342.8293 33312.0165  56.1%  2626 1597s
  9255  3687     cutoff   38      21342.8293 33312.0165  56.1%  2641 1622s
  9535  3728 21690.5120   26  281 21342.8293 33312.0165  56.1%  2655 1650s
  9865  3718 27408.2633   28  253 21342.8293 33063.9118  54.9%  2680 1681s
 10197  3776     cutoff   33      21342.8293 33063.9118  54.9%  2706 1714s
 10589  3813 26261.3213   28  365 21342.8293 32727.1681  53.3%  2721 1742s
 10939  3991     cutoff   36      21342.8293 32238.6093  51.1%  2750 1772s
 11373  4135     cutoff   31      21342.8293 32236.9473  51.0%  2759 1804s
 11794  4318 24317.5833   31  238 21342.8293 32034.6121  50.1%  2782 1840s
 12267  4426 22086.3775   37  121 21342.8293 32014.3794  50.0%  2794 1873s
 12699  4559 28508.6611   26  303 21342.8293 32014.3794  50.0%  2827 1912s
 13135  4716     cutoff   30      21342.8293 32014.3794  50.0%  2859 1953s
 13640  4882 26578.9744   28  320 21342.8293 31575.4056  47.9%  2873 1993s
 14219  5086 26261.1076   27  237 21342.8293 31418.6702  47.2%  2864 2032s
 14710  5258 24571.1476   26  311 21342.8293 31333.3320  46.8%  2886 2072s
 15158  5479 infeasible   29      21342.8293 31333.3320  46.8%  2907 2117s
 15820  5689 22634.7462   27  257 21342.8293 31005.6444  45.3%  2914 2160s
 16504  5904 22678.5106   37  219 21342.8293 30857.0940  44.6%  2917 2205s
 17182  6209 27629.0406   31  286 21342.8293 30760.1418  44.1%  2920 2256s
 17889  6536 24257.9161   34  210 21342.8293 30742.3485  44.0%  2926 2311s
 18727  6803     cutoff   25      21342.8293 30547.5124  43.1%  2916 2363s
 19500  7078 25654.2282   28  362 21342.8293 30410.5972  42.5%  2922 2415s
 20316  7337 23405.6460   31  269 21342.8293 30286.4337  41.9%  2925 2470s
 21137  7372 22379.9734   30  342 21342.8293 30151.4983  41.3%  2930 2521s
 21228  7602 21690.8178   32  290 21342.8293 30151.4983  41.3%  2934 2576s
 21881  7878 22651.9386   36  242 21342.8293 30151.4983  41.3%  2935 2635s
 22789  8165 22150.3984   34  207 21342.8293 29944.4005  40.3%  2938 2697s
 23812  8468 22192.8071   36  198 21342.8293 29841.5022  39.8%  2931 2759s
 24843  8834     cutoff   28      21342.8293 29649.7497  38.9%  2927 2827s
 25948  9152     cutoff   33      21342.8293 29588.4759  38.6%  2918 2894s
 27121  9445 22531.2107   28  416 21342.8293 29486.9974  38.2%  2908 2961s
 28217  9707     cutoff   29      21342.8293 29336.1935  37.5%  2908 3030s
 29390 10128 25526.1358   31  244 21342.8293 29242.5395  37.0%  2904 3111s
 30743 10521     cutoff   35      21342.8293 29110.3980  36.4%  2900 3179s
 31940 10820     cutoff   32      21342.8293 29026.9091  36.0%  2891 3254s
 33180 11134     cutoff   31      21342.8293 28919.7106  35.5%  2883 3324s
 34249 11589 23217.1497   35  239 21342.8293 28825.2108  35.1%  2890 3398s
 35814 11906 22302.3956   36  172 21342.8293 28714.4276  34.5%  2864 3471s
 37396 12194 26146.1307   29  344 21342.8293 28626.1422  34.1%  2841 3547s
*37978 12177              60    21366.543643 28597.8307  33.8%  2844 3547s
 38728 12201 26297.3661   26  333 21366.5436 28551.3519  33.6%  2844 3600s
H38804 12160                    21422.364241 28551.3519  33.3%  2843 3600s
H38805 11937                    21602.606732 28551.3519  32.2%  2842 3600s
H38882 11933                    21606.490626 28551.3519  32.1%  2843 3600s
H38892 11684                    21770.139524 28551.3519  31.1%  2843 3600s

Cutting planes:
  Learned: 1
  Gomory: 4
  MIR: 988
  Mixing: 6
  Flow cover: 1741
  RLT: 33
  Relax-and-lift: 117

Explored 38938 nodes (110817015 simplex iterations) in 3600.08 seconds (7793.07 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 21770.1 21606.5 21602.6 ... 20569.8

Time limit reached
Best objective 2.177013952417e+04, best bound 2.855135191428e+04, gap 31.1491%
  WARNING: Time limit reached. Using best solution found (gap: 31.15%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.11s
  Master Objective (UB) = 21770.14, θ = 190091.58
  Upper Bound (UB) = 21770.14

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 190091.58
  [DEBUG]   ✓ Scenario 0: θ = 190091.58 ≤ Q = 190091.58 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 190091.58 ≤ Q = 190091.58 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 190091.58 ≤ Q = 190091.58 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 190091.58 ≤ Q = 190091.58 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 190091.58 ≤ Q = 190091.58 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x104ff427
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xefb00bd9
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.265885e+13
Presolve removed 2604 rows and 1894 columns
Presolve time: 0.01s
Presolved: 489 rows, 495 columns, 1380 nonzeros
Found heuristic solution: objective 5563425.4111
Variable types: 336 continuous, 159 integer (159 binary)
Found heuristic solution: objective 5562961.1321

Root relaxation: objective -1.905600e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -190559.99    0  130 5562961.13 -190559.99   103%     -    0s
H    0     0                    -166039.6595 -190559.99  14.8%     -    0s
H    0     0                    -166041.8436 -190559.99  14.8%     -    0s
H    0     0                    -171519.0489 -173425.65  1.11%     -    0s
     0     0 -173425.65    0   62 -171519.05 -173425.65  1.11%     -    0s
     0     0 -172813.92    0   64 -171519.05 -172813.92  0.75%     -    0s
     0     0 -172809.22    0   64 -171519.05 -172809.22  0.75%     -    0s
H    0     0                    -172400.0260 -172809.22  0.24%     -    0s
     0     0 -172510.79    0    8 -172400.03 -172510.79  0.06%     -    0s
H    0     0                    -172435.2627 -172507.27  0.04%     -    0s
     0     0 -172507.21    0    4 -172435.26 -172507.21  0.04%     -    0s
H    0     0                    -172469.2559 -172507.21  0.02%     -    0s
     0     0 -172486.78    0    2 -172469.26 -172486.78  0.01%     -    0s
     0     0 -172486.78    0    6 -172469.26 -172486.78  0.01%     -    0s
H    0     0                    -172480.0596 -172486.78  0.00%     -    0s

Cutting planes:
  MIR: 5
  RLT: 1

Explored 1 nodes (503 simplex iterations) in 0.08 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -172480 -172469 -172435 ... 5.56343e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.724800595568e+05, best bound -1.724847070154e+05, gap 0.0027%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 172778.90
  Scenario: 20 demand increases, 40 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -172480.06
  [DEBUG]   S×d_nominal = 345258.96
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 345258.96 + -172480.06 = 172778.90
  [DEBUG]   Current θ from Master = 190091.58
  [DEBUG]   ⚠️  Z_SP ≤ θ by 17312.68 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 4457.46
  Lower Bound (LB) = 19242.46
  Gap (UB-LB) = 2527.6822, Absolute Gap = 2527.6822, Relative Gap = 0.116108
  Not converged yet (gap = 2527.68 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 20 increases, 40 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 264905 nonzeros
Model fingerprint: 0xcb94c4cc
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 42420 rows and 17220 columns
Presolve time: 1.46s
Presolved: 50703 rows, 22480 columns, 314579 nonzeros
Variable types: 20221 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -311526.7819
Found heuristic solution: objective -188257.0362

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 50703 rows, 22480 columns, 314579 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   32254   -1.1728229e+04   0.000000e+00   1.260128e+07      5s
   48663    2.4641025e+04   0.000000e+00   8.087124e+07     10s
   59617    3.4543270e+04   0.000000e+00   2.095753e+06     15s
Concurrent spin time: 1.19s

Solved with dual simplex

Root relaxation: objective 5.315538e+04, 31717 iterations, 16.15 seconds (21.48 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 53155.3850    0  139 -188257.04 53155.3850   128%     -   18s
H    0     0                    -177827.4592 53155.3850   130%     -   18s
H    0     0                    -169911.4119 53155.3850   131%     -   18s
H    0     0                    -148868.0584 53155.3850   136%     -   18s
H    0     0                    -66094.48376 53155.3850   180%     -   18s
H    0     0                    -31386.91450 53155.3850   269%     -   18s
H    0     0                    -17023.86611 53155.3850   412%     -   18s
H    0     0                    -11670.82135 53155.3850   555%     -   19s
H    0     0                    -959.7767236 53155.3850  5638%     -   19s
H    0     0                     327.1660975 53155.3850      -     -   19s
H    0     0                    4452.6065131 53155.3850  1094%     -   19s
H    0     0                    5054.4299631 53155.3850   952%     -   19s
H    0     0                    7547.9450584 49246.6872   552%     -   29s
H    0     0                    8606.1798221 49246.6872   472%     -   29s
H    0     0                    8693.4864534 49246.6872   466%     -   29s
H    0     0                    9122.1062577 49246.6872   440%     -   29s
     0     0 48843.3196    0  166 9122.10626 48843.3196   435%     -   29s
H    0     0                    9172.1206420 48843.3196   433%     -   30s
H    0     0                    9180.5620320 48843.3196   432%     -   30s
H    0     0                    9198.9409900 48843.3196   431%     -   30s
     0     0 48172.6921    0  227 9198.94099 48172.6921   424%     -   34s
     0     0 48003.7882    0  235 9198.94099 48003.7882   422%     -   37s
     0     0 48003.7882    0  244 9198.94099 48003.7882   422%     -   38s
     0     0 48003.7882    0  241 9198.94099 48003.7882   422%     -   39s
     0     0 48003.7882    0  244 9198.94099 48003.7882   422%     -   39s
     0     0 48003.7882    0  249 9198.94099 48003.7882   422%     -   40s
     0     0 48003.7882    0  249 9198.94099 48003.7882   422%     -   40s
H    0     0                    9267.9614448 45132.2513   387%     -   51s
H    0     0                    16641.424222 45132.2513   171%     -   51s
H    0     0                    16709.125974 45132.2513   170%     -   51s
     0     0 45132.2513    0  336 16709.1260 45132.2513   170%     -   51s
     0     0 44471.0761    0  363 16709.1260 44471.0761   166%     -   58s
     0     0 44154.4233    0  350 16709.1260 44154.4233   164%     -   64s
     0     0 43672.0368    0  377 16709.1260 43672.0368   161%     -   69s
     0     0 43594.8779    0  375 16709.1260 43594.8779   161%     -   71s
     0     0 43574.2517    0  373 16709.1260 43574.2517   161%     -   72s
     0     0 43566.1634    0  380 16709.1260 43566.1634   161%     -   73s
     0     0 43539.8903    0  373 16709.1260 43539.8903   161%     -   74s
     0     0 43524.3400    0  374 16709.1260 43524.3400   160%     -   75s
     0     0 43521.1007    0  379 16709.1260 43521.1007   160%     -   75s
     0     0 43520.6017    0  384 16709.1260 43520.6017   160%     -   76s
H    0     0                    16794.094075 42357.9382   152%     -   90s
H    0     0                    16986.540540 42357.9382   149%     -   90s
H    0     0                    17023.230533 42357.9382   149%     -   90s
H    0     0                    17083.167562 42357.9382   148%     -   90s
H    0     0                    17090.250899 42357.9382   148%     -   90s
     0     0 42357.9382    0  383 17090.2509 42357.9382   148%     -   90s
H    0     0                    17603.137445 42357.9337   141%     -   90s
     0     0 41996.0566    0  397 17603.1374 41996.0566   139%     -   96s
H    0     0                    17617.985058 41872.2555   138%     -   99s
     0     0 41872.2555    0  400 17617.9851 41872.2555   138%     -   99s
H    0     0                    17793.753850 41645.6029   134%     -  103s
     0     0 41645.6029    0  399 17793.7539 41645.6029   134%     -  103s
     0     0 41540.3279    0  424 17793.7539 41540.3279   133%     -  107s
     0     0 41501.7956    0  406 17793.7539 41501.7956   133%     -  108s
     0     0 41477.7278    0  407 17793.7539 41477.7278   133%     -  109s
     0     0 41464.8888    0  406 17793.7539 41464.8888   133%     -  110s
     0     0 41438.0120    0  404 17793.7539 41438.0120   133%     -  112s
     0     0 41427.0541    0  407 17793.7539 41427.0541   133%     -  112s
     0     0 41423.1498    0  405 17793.7539 41423.1498   133%     -  113s
     0     0 41421.1432    0  410 17793.7539 41421.1432   133%     -  113s
     0     0 41420.6209    0  409 17793.7539 41420.6209   133%     -  113s
H    0     0                    17876.365379 40925.4565   129%     -  127s
H    0     0                    18111.656077 40925.4565   126%     -  127s
H    0     0                    18116.855213 40925.4565   126%     -  127s
     0     0 40925.4565    0  419 18116.8552 40925.4565   126%     -  127s
H    0     0                    18234.775031 40919.9843   124%     -  128s
     0     0 40772.7132    0  458 18234.7750 40772.7132   124%     -  133s
     0     0 40684.2243    0  433 18234.7750 40684.2243   123%     -  136s
     0     0 40648.1120    0  466 18234.7750 40648.1120   123%     -  137s
     0     0 40623.5423    0  468 18234.7750 40623.5423   123%     -  139s
     0     0 40617.8848    0  473 18234.7750 40617.8848   123%     -  140s
     0     0 40596.4804    0  477 18234.7750 40596.4804   123%     -  142s
     0     0 40593.0875    0  424 18234.7750 40593.0875   123%     -  143s
     0     0 40591.0177    0  418 18234.7750 40591.0177   123%     -  143s
     0     0 40585.9806    0  413 18234.7750 40585.9806   123%     -  144s
     0     0 40583.7317    0  467 18234.7750 40583.7317   123%     -  144s
H    0     0                    18303.008542 40583.1623   122%     -  145s
     0     0 40583.1623    0  470 18303.0085 40583.1623   122%     -  145s
     0     0 40415.9497    0  443 18303.0085 40415.9497   121%     -  150s
H    0     0                    18461.795193 40413.9529   119%     -  150s
H    0     0                    18469.092477 40413.9529   119%     -  150s
H    0     0                    18480.006238 40413.9529   119%     -  150s
H    0     0                    18561.452752 40413.9529   118%     -  150s
H    0     0                    18581.810830 40413.9529   117%     -  150s
     0     0 40369.5895    0  451 18581.8108 40369.5895   117%     -  153s
     0     0 40354.9933    0  453 18581.8108 40354.9933   117%     -  154s
     0     0 40345.1159    0  456 18581.8108 40345.1159   117%     -  155s
     0     0 40342.3096    0  449 18581.8108 40342.3096   117%     -  155s
     0     0 40341.4111    0  443 18581.8108 40341.4111   117%     -  156s
     0     0 40307.4093    0  461 18581.8108 40307.4093   117%     -  159s
H    0     0                    19044.447052 40304.4338   112%     -  161s
H    0     0                    19271.993639 40304.4338   109%     -  161s
     0     0 40275.6879    0  456 19271.9936 40275.6879   109%     -  163s
     0     0 40268.2640    0  456 19271.9936 40268.2640   109%     -  164s
     0     0 40264.6791    0  456 19271.9936 40264.6791   109%     -  165s
     0     0 40263.4965    0  455 19271.9936 40263.4965   109%     -  166s
     0     0 40238.1798    0  445 19271.9936 40238.1798   109%     -  168s
     0     0 40228.9732    0  446 19271.9936 40228.9732   109%     -  169s
     0     0 40226.4744    0  450 19271.9936 40226.4744   109%     -  170s
     0     0 40224.2469    0  458 19271.9936 40224.2469   109%     -  170s
     0     0 40223.9482    0  456 19271.9936 40223.9482   109%     -  170s
     0     0 40204.2240    0  460 19271.9936 40204.2240   109%     -  172s
H    0     0                    19779.370451 40204.2129   103%     -  173s
H    0     0                    19918.537769 40204.2129   102%     -  173s
H    0     0                    19991.345284 40204.2129   101%     -  173s
H    0     0                    20005.879415 40204.2129   101%     -  173s
     0     0 40201.0194    0  453 20005.8794 40201.0194   101%     -  174s
     0     0 40189.1368    0  401 20005.8794 40189.1368   101%     -  175s
     0     0 40183.3622    0  449 20005.8794 40183.3622   101%     -  176s
     0     0 40180.1399    0  457 20005.8794 40180.1399   101%     -  176s
     0     0 40179.5792    0  456 20005.8794 40179.5792   101%     -  177s
     0     0 40161.0353    0  455 20005.8794 40161.0353   101%     -  179s
     0     0 40158.2752    0  457 20005.8794 40158.2752   101%     -  180s
     0     0 40157.6793    0  455 20005.8794 40157.6793   101%     -  180s
     0     0 40151.3405    0  445 20005.8794 40151.3405   101%     -  182s
     0     0 40149.8597    0  455 20005.8794 40149.8597   101%     -  185s
     0     0 40147.1848    0  447 20005.8794 40147.1848   101%     -  186s
     0     0 40146.0925    0  454 20005.8794 40146.0925   101%     -  187s
     0     0 40131.9146    0  444 20005.8794 40131.9146   101%     -  188s
     0     0 40130.4711    0  444 20005.8794 40130.4711   101%     -  189s
H    0     0                    20212.013323 40130.4711  98.5%     -  219s
H    0     0                    20226.492879 40130.4711  98.4%     -  220s
H    0     0                    20240.916605 40130.4711  98.3%     -  221s
     0     2 40130.4711    0  444 20240.9166 40130.4711  98.3%     -  222s
     1     4 40091.5966    1  397 20240.9166 40129.6192  98.3%  2601  230s
     3     8 40032.0479    2  396 20240.9166 40091.5960  98.1%  5183  237s
     7    16 39713.4410    3  444 20240.9166 40044.4899  97.8%  5842  244s
    15    32 38955.6653    4  449 20240.9166 39712.8493  96.2%  7099  255s
    31    51 36588.0812    5  365 20240.9166 38954.7861  92.5%  9625  276s
H   50    83                    20255.036398 38954.7861  92.3%  8941  289s
H   52    83                    20322.029843 38954.7861  91.7%  8942  289s
    82   161 36771.8511    7  419 20322.0298 38954.7861  91.7%  7582  306s
H  160   274                    20414.073977 38954.7861  90.8%  5563  320s
H  207   274                    20430.662137 38954.7861  90.7%  4803  320s
   273   363 36242.0947    9  401 20430.6621 38954.7861  90.7%  4252  329s
   362   440 36069.8233   11  385 20430.6621 38954.7861  90.7%  3746  339s
   439   523 35711.8368   10  367 20430.6621 38954.7861  90.7%  3546  349s
   522   555 36202.7984   12  402 20430.6621 38954.7861  90.7%  3329  357s
   554   597 35698.8503   11  396 20430.6621 38954.7861  90.7%  3268  376s
   596   640 36031.2929   12  383 20430.6621 38954.7861  90.7%  3181  383s
   639   686 35610.8464   11  380 20430.6621 38954.7861  90.7%  3121  391s
   685   728 36039.5847   13  396 20430.6621 38954.7861  90.7%  3044  397s
   729   764 35464.3391   13  400 20430.6621 38954.7861  90.7%  2979  403s
   771   804 35893.0608   13  369 20430.6621 38954.7861  90.7%  2912  410s
   819   850 35514.7521   12  392 20430.6621 38954.7861  90.7%  2826  422s
   865   900 35258.1540   13  374 20430.6621 38954.7861  90.7%  2781  430s
   915   952 35911.3796   14  397 20430.6621 38954.7861  90.7%  2723  438s
   967   997 35793.4242   14  376 20430.6621 38954.7861  90.7%  2663  445s
H 1010   997                    20527.141707 38954.7861  89.8%  2606  445s
  1026  1090 35468.9431   14  357 20527.1417 38954.7861  89.8%  2591  456s
  1139  1202 35280.1849   14  398 20527.1417 38954.7861  89.8%  2484  468s
  1257  1317 35380.0117   15  348 20527.1417 38954.7861  89.8%  2403  478s
  1390  1430 35656.4382   16  395 20527.1417 38954.7861  89.8%  2319  490s
  1527  1522 34500.9938   17  377 20527.1417 38954.7861  89.8%  2254  502s
  1665  1607 35035.8232   18  401 20527.1417 38954.7861  89.8%  2201  514s
  1804  1683 34417.6793   18  340 20527.1417 38954.7861  89.8%  2171  529s
  1918  1776 30526.2729   20  422 20527.1417 38954.7861  89.8%  2187  542s
  2025  1808 33854.8979   19  381 20527.1417 38954.7861  89.8%  2200  551s
  2057  1843 33159.7852   20  359 20527.1417 38954.7861  89.8%  2224  560s
  2096  1879 33093.0770   21  321 20527.1417 38954.7861  89.8%  2235  569s
  2136  1933 32832.0933   22  318 20527.1417 38954.7861  89.8%  2248  578s
  2194  1997 32661.2097   23  289 20527.1417 38954.7861  89.8%  2238  593s
  2286  2059 32320.0972   22  329 20527.1417 38750.1360  88.8%  2214  607s
  2382  2186 32706.1814   23  316 20527.1417 38750.1360  88.8%  2217  622s
  2535  2344 31221.9521   24  301 20527.1417 38750.1360  88.8%  2206  636s
  2727  2571 30382.9626   23  253 20527.1417 38750.1360  88.8%  2161  653s
  2980  2756 30839.4116   25  270 20527.1417 38750.1360  88.8%  2071  669s
  3233  2963 30573.0010   25  298 20527.1417 38514.1063  87.6%  2004  685s
  3495  2964 31922.5676   22  444 20527.1417 38514.1063  87.6%  1949  735s
  3497  2965 35768.9345   11  139 20527.1417 38514.1063  87.6%  1948  779s
  3498  2966 33619.2544   12  287 20527.1417 38514.1063  87.6%  1948  798s
  3499  2967 33658.9626   34  381 20527.1417 38514.1063  87.6%  1947  808s
  3500  2967 34548.0481   17  369 20527.1417 38514.1063  87.6%  1946  818s
  3501  2968 36067.7272   12  436 20527.1417 38514.1063  87.6%  1946  824s
  3502  2969 25435.9850   38  416 20527.1417 38514.1063  87.6%  1945  832s
  3503  2969 21925.7122  103  439 20527.1417 38514.1063  87.6%  1945  838s
  3504  2970 25795.5244   57  436 20527.1417 38514.1063  87.6%  1944  841s
  3505  2971 35225.3378   10  443 20527.1417 38514.1063  87.6%  1944  846s
H 3505  2822                    20535.516745 38514.1063  87.5%  1944  848s
  3507  2823 25052.0624   44  478 20535.5167 38514.1063  87.5%  1943  850s
  3511  2826 22458.6231   59  388 20535.5167 38514.1063  87.5%  1940  855s
  3515  2828 27403.1398   47  398 20535.5167 38514.1063  87.5%  1938  863s
  3517  2830 29800.3920   17  439 20535.5167 38514.1063  87.5%  1937  866s
H 3517  2688                    20545.250938 38514.1063  87.5%  1937  870s
  3521  2690 29853.1978   31  486 20545.2509 38514.1063  87.5%  1935  877s
  3523  2692 35411.4928   22  487 20545.2509 38514.1063  87.5%  1934  882s
  3525  2693 25953.0756   40  507 20545.2509 38514.1063  87.5%  1933  885s
H 3525  2558                    20547.319276 38514.1063  87.4%  1933  888s
  3526  2559 35632.8179    9  478 20547.3193 38514.1063  87.4%  1932  891s
  3528  2560 33077.0454   29  503 20547.3193 38514.1063  87.4%  1931  897s
H 3528  2431                    20635.545176 38514.1063  86.6%  1931  898s
  3529  2432 32224.0848   27  456 20635.5452 38514.1063  86.6%  1930  900s
H 3530  2310                    20640.242074 38514.1063  86.6%  1930  905s
  3532  2312 31858.6248   22  446 20640.2421 38514.1063  86.6%  1929  910s
  3534  2313 29605.6557   42  456 20640.2421 38514.1063  86.6%  1928  915s
  3535  2314 33378.9369   18  456 20640.2421 38514.1063  86.6%  1927  958s
  3536  2314 29858.0710   35  456 20640.2421 38514.1063  86.6%  1927  979s
  3537  2318 38514.1063   16  449 20640.2421 38514.1063  86.6%  1977 1000s
  3539  2321 38514.1063   17  439 20640.2421 38514.1063  86.6%  1979 1016s
  3543  2328 38514.1063   18  450 20640.2421 38514.1063  86.6%  1986 1033s
  3551  2341 38309.2050   19  451 20640.2421 38514.1063  86.6%  2003 1048s
  3567  2352 36928.9937   20  450 20640.2421 38308.8949  85.6%  2049 1079s
  3583  2379 35584.1765   21  447 20640.2421 38308.8949  85.6%  2106 1105s
H 3586  2262                    20649.473595 38308.8949  85.5%  2110 1105s
H 3601  2146                    20657.013847 38308.8949  85.5%  2145 1105s
  3615  2268 33473.8958   22  315 20657.0138 38308.8949  85.5%  2172 1131s
  3742  2299 32943.3681   25  311 20657.0138 38308.8949  85.5%  2294 1146s
  3815  2355 32884.6213   24  311 20657.0138 38308.8949  85.5%  2324 1161s
  3896  2358 31779.7667   26  294 20657.0138 38308.8949  85.5%  2336 1170s
  3928  2384 31809.8729   26  310 20657.0138 38308.8949  85.5%  2339 1179s
  3966  2401 31621.0368   25  281 20657.0138 38308.8949  85.5%  2341 1187s
  4008  2423 31455.3942   26  391 20657.0138 38308.8949  85.5%  2347 1200s
H 4010  2317                    20719.810486 38308.8949  84.9%  2346 1200s
  4044  2397 31623.4036   27  249 20719.8105 38308.8949  84.9%  2347 1212s
  4151  2442 30652.3590   29  231 20719.8105 38308.8949  84.9%  2332 1227s
  4251  2478 30502.8108   30  232 20719.8105 38130.5974  84.0%  2315 1240s
  4343  2506 30347.8765   32  219 20719.8105 38130.5974  84.0%  2305 1252s
  4440  2531 29572.8366   34  221 20719.8105 38130.5974  84.0%  2295 1266s
  4540  2530 29408.0545   35  256 20719.8105 38130.5974  84.0%  2281 1279s
  4643  2528 28793.0236   35  246 20719.8105 38130.5974  84.0%  2271 1298s
  4735  2531 28729.4192   36  216 20719.8105 37629.6926  81.6%  2275 1312s
  4823  2545 23649.5745   35  205 20719.8105 37628.8782  81.6%  2284 1328s
  4887  2554 27699.0257   37  211 20719.8105 37628.8782  81.6%  2299 1337s
H 4918  2444                    20775.703862 37628.8782  81.1%  2305 1337s
  4924  2473 27281.7582   36  220 20775.7039 37628.8782  81.1%  2308 1347s
  4958  2493 25586.8751   38  301 20775.7039 37628.8782  81.1%  2314 1355s
  4994  2497 26270.0603   38  199 20775.7039 37628.8782  81.1%  2322 1370s
  5048  2521 25174.3946   37  221 20775.7039 36724.1578  76.8%  2324 1382s
  5110  2531 25010.1722   38  215 20775.7039 36724.1578  76.8%  2330 1397s
  5180  2538 23885.7899   39  194 20775.7039 36724.1578  76.8%  2327 1411s
  5246  2564 25075.6606   39  284 20775.7039 36264.4811  74.6%  2340 1426s
  5345  2604 22489.9048   39  282 20775.7039 36264.4811  74.6%  2353 1443s
  5466  2608 24485.3845   41  198 20775.7039 36264.4811  74.6%  2353 1460s
H 5467  2513                    20822.138896 36264.4811  74.2%  2352 1460s
  5527  2585 23036.1497   43  159 20822.1389 35968.9808  72.7%  2356 1477s
  5669  2625     cutoff   45      20822.1389 35968.9808  72.7%  2354 1496s
  5810  2603 27174.6561   23  338 20822.1389 35761.4415  71.7%  2358 1512s
  5846  2626 24398.4673   24  333 20822.1389 35761.4415  71.7%  2369 1531s
H 5875  2527                    20877.158510 35761.4415  71.3%  2366 1531s
  5900  2612 23020.0855   25  344 20877.1585 35761.4415  71.3%  2370 1555s
  6033  2653     cutoff   26      20877.1585 35761.4415  71.3%  2377 1575s
  6231  2659 21796.8315   26  384 20877.1585 35761.4415  71.3%  2365 1597s
  6395  2623     cutoff   27      20877.1585 35761.4415  71.3%  2369 1616s
H 6397  2533                    20951.818051 35761.4415  70.7%  2369 1616s
H 6421  2435                    21098.291281 35761.4415  69.5%  2378 1616s
  6440  2502     cutoff   28      21098.2913 35761.4415  69.5%  2380 1637s
  6607  2533 31382.6684   26  269 21098.2913 34911.3056  65.5%  2386 1661s
  6793  2553 29420.4743   30  314 21098.2913 34696.9696  64.5%  2386 1685s
  6992  2547 27261.4507   32  343 21098.2913 34524.7408  63.6%  2386 1712s
  7162  2592 23596.0549   35  262 21098.2913 34130.6463  61.8%  2395 1740s
  7340  2676 31107.5029   25  467 21098.2913 34094.2345  61.6%  2413 1769s
  7571  2617 28105.0779   29  240 21098.2913 33919.1245  60.8%  2408 1787s
H 7614  2526                    21100.473196 33919.1245  60.8%  2411 1787s
  7617  2616 26130.0129   30  196 21100.4732 33919.1245  60.8%  2413 1814s
  7859  2646     cutoff   35      21100.4732 33919.1245  60.8%  2411 1840s
  8100  2762 23621.1003   38  203 21100.4732 33919.1245  60.8%  2416 1868s
  8371  2854 28644.2295   24  259 21100.4732 33890.9744  60.6%  2417 1898s
  8646  2887 27489.3199   27  242 21100.4732 33715.2449  59.8%  2419 1920s
  8687  2966 27840.8603   26  219 21100.4732 33715.2449  59.8%  2424 1947s
  8815  3151 26187.6891   27  204 21100.4732 33576.1777  59.1%  2421 1979s
  9166  3289 24716.6500   28  193 21100.4732 33576.1777  59.1%  2407 2012s
  9505  3411 24547.4949   29  176 21100.4732 33426.5141  58.4%  2405 2046s
  9794  3529     cutoff   31      21100.4732 33426.5141  58.4%  2416 2083s
 10165  3725 29179.9664   31  317 21100.4732 33146.7340  57.1%  2416 2122s
 10558  3891 29813.4707   24  413 21100.4732 33146.7340  57.1%  2415 2161s
 10926  4118 23796.0959   33  253 21100.4732 32697.1530  55.0%  2419 2203s
 11390  4298 24546.1460   29  223 21100.4732 32575.5669  54.4%  2409 2247s
 11820  4382 infeasible   36      21100.4732 32553.1636  54.3%  2407 2295s
 12397  4551 27512.2787   28  290 21100.4732 32553.1636  54.3%  2383 2337s
 12847  4712 21289.2432   36  282 21100.4732 32337.9722  53.3%  2386 2385s
 13295  4861     cutoff   31      21100.4732 32271.7333  52.9%  2390 2432s
H13296  4861                    21114.173034 32271.7333  52.8%  2390 2432s
H13408  4857                    21159.299324 32141.0441  51.9%  2391 2432s
 13781  5087     cutoff   24      21159.2993 32067.2605  51.6%  2394 2486s
H14274  5196                    21165.788966 31939.0919  50.9%  2400 2533s
 14590  5397 27059.3778   27  335 21165.7890 31862.8280  50.5%  2406 2582s
 15136  5530 25336.4892   39  166 21165.7890 31862.8280  50.5%  2408 2639s
 15693  5674 22889.9925   31  162 21165.7890 31755.4508  50.0%  2414 2693s
 16205  6012 27666.6954   30  225 21165.7890 31567.8283  49.1%  2424 2746s
 16778  6328     cutoff   36      21165.7890 31535.8288  49.0%  2433 2808s
 17527  6527     cutoff   35      21165.7890 31533.6910  49.0%  2418 2877s
 18209  6812 27950.3190   25  393 21165.7890 31390.1711  48.3%  2418 2939s
 18954  7016 24364.2071   30  275 21165.7890 31355.1686  48.1%  2413 3005s
 19664  7202 26715.0628   25  317 21165.7890 31279.6515  47.8%  2417 3075s
 20214  7530 28162.2196   29  271 21165.7890 31279.6515  47.8%  2427 3145s
 21086  7842 27396.9332   31  329 21165.7890 31236.8691  47.6%  2418 3222s
 21860  8193 25593.7482   30  311 21165.7890 30931.3921  46.1%  2423 3304s
 22711  8424 28839.8787   34  212 21165.7890 30812.5863  45.6%  2420 3379s
 23243  8747     cutoff   40      21165.7890 30806.5684  45.5%  2420 3459s
*24058  8739              82    21177.601818 30736.6622  45.1%  2417 3459s
 24223  9031 28999.8567   29  275 21177.6018 30736.6622  45.1%  2416 3542s
 25138  9254     cutoff   40      21177.6018 30594.2364  44.5%  2419 3600s

Cutting planes:
  Learned: 1
  MIR: 1136
  Mixing: 5
  Flow cover: 1912
  RLT: 26
  Relax-and-lift: 134

Explored 25840 nodes (62716840 simplex iterations) in 3600.05 seconds (7243.51 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 21177.6 21165.8 21114.2 ... 20719.8

Time limit reached
Best objective 2.117760181836e+04, best bound 3.049020595185e+04, gap 43.9738%
  WARNING: Time limit reached. Using best solution found (gap: 43.97%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.05s
  Master Objective (UB) = 21177.60, θ = 189095.65
  Upper Bound (UB) = 21177.60

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 189095.65
  [DEBUG]   ✓ Scenario 0: θ = 189095.65 ≤ Q = 189095.65 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 189095.65 ≤ Q = 189095.65 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 189095.65 ≤ Q = 189095.65 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 189095.65 ≤ Q = 189095.65 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 189095.65 ≤ Q = 189095.65 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 189095.65 ≤ Q = 189095.65 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x18da267
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xfe725d99
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [9e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [2e-13, 2e+02]
Found heuristic solution: objective 1.264099e+13
Presolve removed 2604 rows and 1894 columns
Presolve time: 0.01s
Presolved: 489 rows, 495 columns, 1380 nonzeros
Found heuristic solution: objective 5507565.0900
Variable types: 336 continuous, 159 integer (159 binary)
Found heuristic solution: objective 5507100.8110

Root relaxation: objective -1.874613e+05, 239 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -187461.27    0  124 5507100.81 -187461.27   103%     -    0s
H    0     0                    -163598.4619 -187461.27  14.6%     -    0s
H    0     0                    -163831.9858 -187461.27  14.4%     -    0s
     0     0 -172088.42    0   69 -163831.99 -172088.42  5.04%     -    0s
H    0     0                    -169090.9232 -171961.83  1.70%     -    0s
H    0     0                    -169359.4535 -171961.83  1.54%     -    0s
H    0     0                    -169915.8264 -171961.83  1.20%     -    0s
H    0     0                    -170184.3568 -171961.83  1.04%     -    0s
     0     0 -171753.19    0   63 -170184.36 -171753.19  0.92%     -    0s
     0     0 -170482.75    0   18 -170184.36 -170482.75  0.18%     -    0s
     0     0 -170473.90    0    9 -170184.36 -170473.90  0.17%     -    0s
     0     0 -170417.67    0   17 -170184.36 -170417.67  0.14%     -    0s
H    0     0                    -170214.6704 -170417.67  0.12%     -    0s
     0     0 -170417.67    0   18 -170214.67 -170417.67  0.12%     -    0s
     0     0 -170333.39    0   13 -170214.67 -170333.39  0.07%     -    0s
     0     0 -170333.39    0   33 -170214.67 -170333.39  0.07%     -    0s
     0     0 -170246.19    0    4 -170214.67 -170246.19  0.02%     -    0s
H    0     0                    -170234.8590 -170240.39  0.00%     -    0s

Cutting planes:
  Gomory: 1
  Implied bound: 2
  MIR: 18
  Flow cover: 13

Explored 1 nodes (671 simplex iterations) in 0.15 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -170235 -170215 -170184 ... 1.2641e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.702348589677e+05, best bound -1.702403857124e+05, gap 0.0032%
  Subproblem solved in 0.18s
  Worst-case operational profit (Z_SP) = 174731.03
  Scenario: 31 demand increases, 29 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -170234.86
  [DEBUG]   S×d_nominal = 344965.89
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 344965.89 + -170234.86 = 174731.03
  [DEBUG]   Current θ from Master = 189095.65
  [DEBUG]   ⚠️  Z_SP ≤ θ by 14364.62 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 6812.98
  Lower Bound (LB) = 19242.46
  Gap (UB-LB) = 1935.1445, Absolute Gap = 1935.1445, Relative Gap = 0.091377
  Not converged yet (gap = 1935.14 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 31 increases, 29 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308136 nonzeros
Model fingerprint: 0x6ce049cc
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 49490 rows and 20090 columns
Presolve time: 1.61s
Presolved: 58923 rows, 25850 columns, 366089 nonzeros
Variable types: 23591 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -311526.7819
Found heuristic solution: objective -188257.0362

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 58923 rows, 25850 columns, 366089 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   22211   -1.1824281e+05   0.000000e+00   2.987597e+07      5s
   34495   -2.0488689e+03   0.000000e+00   2.662876e+06     10s
   45154    2.5501900e+04   0.000000e+00   9.642153e+07     15s
   54692    3.0594132e+04   0.000000e+00   1.026033e+08     20s
   63281    3.5345501e+04   0.000000e+00   2.903133e+05     25s
Concurrent spin time: 8.97s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 5.315538e+04, 55796 iterations, 31.24 seconds (36.36 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 53155.3850    0  139 -188257.04 53155.3850   128%     -   33s
H    0     0                    -182326.5865 53155.3850   129%     -   33s
H    0     0                    -66094.48376 53155.3850   180%     -   33s
H    0     0                    -31386.91450 53155.3850   269%     -   34s
H    0     0                    -17023.86611 53155.3850   412%     -   34s
H    0     0                    4452.6065131 53155.3850  1094%     -   34s
H    0     0                    5054.4299631 53155.3850   952%     -   34s
H    0     0                    7802.8260863 49340.2104   532%     -   43s
     0     0 49340.2104    0  143 7802.82609 49340.2104   532%     -   43s
H    0     0                    7832.1817166 49339.8622   530%     -   43s
H    0     0                    9172.1206420 49339.8622   438%     -   43s
H    0     0                    9252.8157686 48683.8204   426%     -   48s
H    0     0                    9254.9852289 48683.8204   426%     -   48s
H    0     0                    9268.3241687 48683.8204   425%     -   48s
     0     0 48646.0355    0  236 9268.32417 48646.0355   425%     -   48s
     0     0 48602.8361    0  240 9268.32417 48602.8361   424%     -   50s
     0     0 48536.9479    0  236 9268.32417 48536.9479   424%     -   51s
     0     0 48536.9479    0  236 9268.32417 48536.9479   424%     -   53s
     0     0 48536.9479    0  244 9268.32417 48536.9479   424%     -   53s
     0     0 48536.9479    0  244 9268.32417 48536.9479   424%     -   53s
H    0     0                    9799.2703908 46014.1729   370%     -   68s
     0     0 46014.1729    0  303 9799.27039 46014.1729   370%     -   68s
H    0     0                    10011.449276 46013.9395   360%     -   69s
H    0     0                    10346.360431 46013.9395   345%     -   69s
H    0     0                    10458.258204 46013.9395   340%     -   69s
H    0     0                    12853.378678 46013.9395   258%     -   69s
H    0     0                    13326.436534 46013.9395   245%     -   69s
H    0     0                    13490.332955 46013.9395   241%     -   69s
H    0     0                    13612.884692 46013.9395   238%     -   69s
     0     0 45192.8902    0  322 13612.8847 45192.8902   232%     -   79s
     0     0 45007.7402    0  319 13612.8847 45007.7402   231%     -   84s
     0     0 44952.1689    0  311 13612.8847 44952.1689   230%     -   86s
     0     0 44786.9443    0  321 13612.8847 44786.9443   229%     -   91s
     0     0 44603.1128    0  336 13612.8847 44603.1128   228%     -   95s
     0     0 44581.8686    0  335 13612.8847 44581.8686   227%     -   96s
     0     0 44545.6868    0  339 13612.8847 44545.6868   227%     -   97s
     0     0 44543.1415    0  340 13612.8847 44543.1415   227%     -   98s
     0     0 44542.6639    0  340 13612.8847 44542.6639   227%     -   98s
H    0     0                    13807.176066 44542.6639   223%     -  105s
H    0     0                    14253.728751 44542.6639   212%     -  105s
H    0     0                    14275.932751 44542.6639   212%     -  105s
H    0     0                    14305.497275 44542.6639   211%     -  105s
H    0     0                    14324.512517 44542.6639   211%     -  105s
H    0     0                    14420.627766 44542.6639   209%     -  105s
H    0     0                    14615.659424 44542.6639   205%     -  105s
H    0     0                    14618.184771 44542.6639   205%     -  105s
H    0     0                    14787.457299 44542.6639   201%     -  105s
H    0     0                    14813.772467 44542.6639   201%     -  105s
H    0     0                    15106.577798 44542.6639   195%     -  105s
H    0     0                    15177.772772 44542.6639   193%     -  105s
H    0     0                    15743.491572 42992.3928   173%     -  118s
H    0     0                    15751.025469 42992.3928   173%     -  118s
H    0     0                    16078.856193 42992.3928   167%     -  118s
H    0     0                    16092.518785 42992.3928   167%     -  118s
H    0     0                    16857.164472 42992.3928   155%     -  118s
H    0     0                    16873.089699 42992.3928   155%     -  118s
H    0     0                    17223.577948 42992.3928   150%     -  118s
H    0     0                    17384.098397 42992.3928   147%     -  118s
H    0     0                    17550.148729 42992.3928   145%     -  118s
H    0     0                    17947.210888 42992.3928   140%     -  118s
     0     0 42992.3928    0  409 17947.2109 42992.3928   140%     -  118s
H    0     0                    17953.466531 42368.2366   136%     -  125s
H    0     0                    18378.889088 42368.2366   131%     -  125s
H    0     0                    18407.220752 42368.2366   130%     -  125s
H    0     0                    18490.618564 42368.2366   129%     -  125s
     0     0 42368.2366    0  388 18490.6186 42368.2366   129%     -  125s
     0     0 42249.3103    0  409 18490.6186 42249.3103   128%     -  131s
     0     0 42204.4439    0  416 18490.6186 42204.4439   128%     -  133s
     0     0 42187.3509    0  392 18490.6186 42187.3509   128%     -  134s
     0     0 42121.1596    0  418 18490.6186 42121.1596   128%     -  138s
     0     0 42063.1013    0  420 18490.6186 42063.1013   127%     -  140s
     0     0 41994.5109    0  404 18490.6186 41994.5109   127%     -  143s
     0     0 41920.0231    0  427 18490.6186 41920.0231   127%     -  146s
     0     0 41894.2522    0  429 18490.6186 41894.2522   127%     -  148s
     0     0 41884.1605    0  427 18490.6186 41884.1605   127%     -  149s
     0     0 41879.9090    0  428 18490.6186 41879.9090   126%     -  149s
     0     0 41875.8854    0  430 18490.6186 41875.8854   126%     -  150s
     0     0 41875.1869    0  434 18490.6186 41875.1869   126%     -  150s
     0     0 41082.9176    0  423 18490.6186 41082.9176   122%     -  162s
     0     0 40792.9736    0  452 18490.6186 40792.9736   121%     -  169s
     0     0 40698.0034    0  455 18490.6186 40698.0034   120%     -  171s
     0     0 40645.8617    0  462 18490.6186 40645.8617   120%     -  173s
     0     0 40615.1117    0  465 18490.6186 40615.1117   120%     -  175s
     0     0 40607.3256    0  462 18490.6186 40607.3256   120%     -  176s
     0     0 40606.3122    0  460 18490.6186 40606.3122   120%     -  177s
     0     0 40456.5149    0  426 18490.6186 40456.5149   119%     -  182s
     0     0 40405.1989    0  437 18490.6186 40405.1989   119%     -  186s
     0     0 40395.8124    0  440 18490.6186 40395.8124   118%     -  187s
     0     0 40389.5281    0  437 18490.6186 40389.5281   118%     -  188s
     0     0 40386.0855    0  396 18490.6186 40386.0855   118%     -  189s
     0     0 40384.7259    0  395 18490.6186 40384.7259   118%     -  189s
     0     0 40329.4795    0  436 18490.6186 40329.4795   118%     -  193s
H    0     0                    18880.854597 40325.8412   114%     -  195s
     0     0 40310.3575    0  436 18880.8546 40310.3575   113%     -  197s
     0     0 40305.4049    0  441 18880.8546 40305.4049   113%     -  197s
     0     0 40300.0418    0  444 18880.8546 40300.0418   113%     -  199s
     0     0 40297.1340    0  447 18880.8546 40297.1340   113%     -  199s
     0     0 40295.5841    0  447 18880.8546 40295.5841   113%     -  200s
     0     0 40295.2632    0  446 18880.8546 40295.2632   113%     -  200s
     0     0 40258.6426    0  446 18880.8546 40258.6426   113%     -  204s
     0     0 40248.7363    0  391 18880.8546 40248.7363   113%     -  206s
     0     0 40244.1383    0  395 18880.8546 40244.1383   113%     -  207s
     0     0 40242.4318    0  394 18880.8546 40242.4318   113%     -  207s
     0     0 40239.6749    0  400 18880.8546 40239.6749   113%     -  207s
     0     0 40239.6315    0  396 18880.8546 40239.6315   113%     -  208s
     0     0 40229.7390    0  454 18880.8546 40229.7390   113%     -  210s
H    0     0                    19055.939769 40228.6389   111%     -  212s
     0     0 40226.0409    0  452 19055.9398 40226.0409   111%     -  213s
     0     0 40220.2472    0  452 19055.9398 40220.2472   111%     -  214s
     0     0 40218.1944    0  454 19055.9398 40218.1944   111%     -  215s
     0     0 40217.0501    0  454 19055.9398 40217.0501   111%     -  215s
     0     0 40196.2326    0  452 19055.9398 40196.2326   111%     -  218s
H    0     0                    19093.806531 40195.5891   111%     -  218s
     0     0 40189.4845    0  457 19093.8065 40189.4845   110%     -  219s
     0     0 40186.1565    0  453 19093.8065 40186.1565   110%     -  220s
     0     0 40184.7612    0  454 19093.8065 40184.7612   110%     -  220s
     0     0 40175.0785    0  458 19093.8065 40175.0785   110%     -  223s
H    0     0                    19442.923802 40171.8502   107%     -  226s
H    0     0                    19471.947500 40171.8502   106%     -  227s
H    0     0                    19553.315270 40171.8502   105%     -  227s
H    0     0                    19617.535178 40171.8502   105%     -  227s
     0     0 40171.8502    0  459 19617.5352 40171.8502   105%     -  227s
     0     0 40171.6614    0  453 19617.5352 40171.6614   105%     -  228s
     0     0 40158.7917    0  457 19617.5352 40158.7917   105%     -  231s
H    0     0                    19639.686895 40156.9237   104%     -  231s
     0     0 40153.5954    0  467 19639.6869 40153.5954   104%     -  233s
     0     0 40152.7317    0  463 19639.6869 40152.7317   104%     -  233s
     0     0 40142.1510    0  443 19639.6869 40142.1510   104%     -  236s
     0     0 40140.9180    0  451 19639.6869 40140.9180   104%     -  236s
     0     0 40138.4845    0  456 19639.6869 40138.4845   104%     -  238s
     0     0 40136.5041    0  448 19639.6869 40136.5041   104%     -  238s
     0     0 40136.5041    0  448 19639.6869 40136.5041   104%     -  240s
     0     0 40135.1780    0  399 19639.6869 40135.1780   104%     -  241s
     0     0 40133.1903    0  403 19639.6869 40133.1903   104%     -  242s
     0     0 40132.9860    0  405 19639.6869 40132.9860   104%     -  242s
     0     0 40132.6141    0  402 19639.6869 40132.6141   104%     -  244s
     0     0 40132.3791    0  402 19639.6869 40132.3791   104%     -  245s
H    0     0                    19890.934955 40132.3156   102%     -  277s
     0     2 40132.3156    0  402 19890.9350 40132.3156   102%     -  278s
     1     4 40084.0709    1  390 19890.9350 40132.1591   102%  2728  285s
     3     8 40048.9562    2  394 19890.9350 40084.0321   102%  4412  292s
     7    16 39992.3297    3  388 19890.9350 40048.5566   101%  5251  299s
    15    32 39706.1876    4  424 19890.9350 39989.8197   101%  5724  311s
    31    48 39382.2128    5  426 19890.9350 39705.9006   100% 10162  332s
H   47    80                    20009.965499 39705.9006  98.4%  8679  347s
H   49    80                    20207.310296 39705.9006  96.5%  8616  347s
H   50    80                    20504.459301 39705.9006  93.6%  8584  347s
H   62    80                    20540.637747 39705.9006  93.3%  8397  347s
H   78    80                    20598.999675 39705.9006  92.8%  7342  347s
    79   144 38688.4071    7  412 20598.9997 39705.9006  92.8%  7278  386s
   143   255 38041.4195    9  349 20598.9997 39705.9006  92.8%  5886  405s
   254   344 37747.7781    9  346 20598.9997 39705.9006  92.8%  5076  419s
   343   437 37393.1736   10  350 20598.9997 39705.9006  92.8%  4583  429s
   436   530 37544.4215   10  343 20598.9997 39705.9006  92.8%  4097  439s
   529   610 37338.9104   11  336 20598.9997 39705.9006  92.8%  3751  448s
   609   704 34198.2128   21  346 20598.9997 39705.9006  92.8%  3513  458s
   703   734 37445.7437   11  343 20598.9997 39705.9006  92.8%  3253  465s
   735   776 36674.3146   11  319 20598.9997 39705.9006  92.8%  3195  476s
H  738   776                    20758.826000 39705.9006  91.3%  3194  476s
   777   808 37151.6380   11  393 20758.8260 39705.9006  91.3%  3129  481s
   809   848 37414.8607   12  340 20758.8260 39705.9006  91.3%  3083  489s
   849   880 36538.0024   11  337 20758.8260 39705.9006  91.3%  3039  495s
   881   915 37216.5307   13  379 20758.8260 39705.9006  91.3%  2989  505s
   916   968 36440.5948   13  328 20758.8260 39705.9006  91.3%  2967  513s
   969  1055 36370.2477   13  272 20758.8260 39705.9006  91.3%  2902  521s
  1064  1139 37037.4722   14  392 20758.8260 39705.9006  91.3%  2763  535s
  1152  1253 36952.9253   14  336 20758.8260 39705.9006  91.3%  2655  545s
  1274  1349 37069.2470   14  264 20758.8260 39705.9006  91.3%  2516  553s
  1388  1458 36522.2547   15  370 20758.8260 39705.9006  91.3%  2421  564s
  1553  1486 36259.8889   14  333 20758.8260 39655.9415  91.0%  2274  577s
  1587  1507 36945.3802   15  347 20758.8260 39654.9328  91.0%  2277  590s
  1628  1583 36047.3819   14  323 20758.8260 39654.9328  91.0%  2318  605s
  1730  1647 36342.7188   16  338 20758.8260 39654.9328  91.0%  2279  619s
  1848  1718 36735.6688   16  283 20758.8260 39654.9328  91.0%  2260  633s
  1948  1762 36339.9198   16  344 20758.8260 39654.9328  91.0%  2248  647s
  2044  1812 35087.4046   17  297 20758.8260 39654.9328  91.0%  2264  661s
  2116  1890 35167.3726   15  272 20758.8260 39654.9328  91.0%  2309  676s
  2208  2002 34941.6175   18  232 20758.8260 39654.9328  91.0%  2334  691s
  2344  2113 32471.7820   20  197 20758.8260 39654.9328  91.0%  2300  708s
  2481  2272 34023.2252   18  299 20758.8260 39539.9408  90.5%  2301  724s
  2670  2449 30861.5060   21  208 20758.8260 39403.6713  89.8%  2250  741s
  2893  2615 33244.7856   20  221 20758.8260 39322.8082  89.4%  2179  758s
  3104  2755 26813.1476   22  188 20758.8260 39322.8082  89.4%  2137  778s
  3302  2913 28915.0888   23  285 20758.8260 39322.8082  89.4%  2113  796s
  3519  2914 21570.2079   64  402 20758.8260 39322.8082  89.4%  2083  867s
  3521  2915 31279.1475   19  139 20758.8260 39322.8082  89.4%  2082  909s
  3522  2916 23770.6846   57  335 20758.8260 39322.8082  89.4%  2082  935s
  3523  2917 30480.4323   46  420 20758.8260 39322.8082  89.4%  2081  956s
  3524  2917 31013.2492   24  415 20758.8260 39322.8082  89.4%  2081  966s
  3525  2918 36314.5080    7  417 20758.8260 39322.8082  89.4%  2080  977s
  3526  2919 35248.6950    8  410 20758.8260 39322.8082  89.4%  2079  988s
  3527  2919 30143.6995   34  426 20758.8260 39322.8082  89.4%  2079  996s
  3528  2920 27431.1592   36  419 20758.8260 39322.8082  89.4%  2078 1001s
  3530  2921 30696.2296   39  392 20758.8260 39322.8082  89.4%  2077 1006s
  3532  2923 37154.9664    8  392 20758.8260 39322.8082  89.4%  2076 1011s
  3534  2924 29668.4718   36  397 20758.8260 39322.8082  89.4%  2075 1016s
  3537  2926 24967.6822   35  396 20758.8260 39322.8082  89.4%  2073 1021s
  3538  2927 22871.1808   56  445 20758.8260 39322.8082  89.4%  2072 1026s
  3540  2928 32410.9915   28  452 20758.8260 39322.8082  89.4%  2071 1030s
  3543  2930 30742.0214   42  447 20758.8260 39322.8082  89.4%  2069 1040s
  3546  2932 30838.7410   25  487 20758.8260 39322.8082  89.4%  2068 1050s
  3548  2933 21982.7442   54  462 20758.8260 39322.8082  89.4%  2066 1055s
  3549  2934 26558.5059   22  458 20758.8260 39322.8082  89.4%  2066 1062s
  3550  2935 22957.4029   41  465 20758.8260 39322.8082  89.4%  2065 1066s
  3552  2936 35561.0893   15  482 20758.8260 39322.8082  89.4%  2064 1074s
  3553  2937 30387.5257   25  479 20758.8260 39322.8082  89.4%  2064 1076s
  3555  2938 33902.1077   14  454 20758.8260 39322.8082  89.4%  2062 1087s
  3557  2939 30460.9426   15  472 20758.8260 39322.8082  89.4%  2061 1090s
  3559  2941 37270.3247   10  488 20758.8260 39322.8082  89.4%  2060 1098s
  3561  2942 35431.0091   14  470 20758.8260 39322.8082  89.4%  2059 1102s
  3562  2943 30405.5927   18  469 20758.8260 39322.8082  89.4%  2058 1107s
  3563  2943 24488.8368   50  483 20758.8260 39322.8082  89.4%  2058 1110s
  3565  2945 23494.7728   36  516 20758.8260 39322.8082  89.4%  2057 1115s
  3566  2945 30488.3256   16  471 20758.8260 39322.8082  89.4%  2056 1120s
  3568  2947 35927.3827   18  477 20758.8260 39322.8082  89.4%  2055 1130s
  3571  2949 26809.0803   44  516 20758.8260 39322.8082  89.4%  2053 1135s
  3572  2949 26042.2722   74  514 20758.8260 39322.8082  89.4%  2053 1141s
  3574  2951 33150.5913   26  509 20758.8260 39322.8082  89.4%  2051 1146s
  3575  2951 34384.1322   22  500 20758.8260 39322.8082  89.4%  2051 1153s
  3576  2952 31939.6377   19  485 20758.8260 39322.8082  89.4%  2050 1155s
  3577  2953 30282.9463   33  509 20758.8260 39322.8082  89.4%  2050 1160s
  3579  2954 33388.4685   30  516 20758.8260 39322.8082  89.4%  2049 1165s
  3580  2955 23229.2418   44  509 20758.8260 39322.8082  89.4%  2048 1172s
  3582  2956 22750.1435   56  509 20758.8260 39322.8082  89.4%  2047 1175s
  3584  2957 34531.4812   15  505 20758.8260 39322.8082  89.4%  2046 1186s
  3585  2958 24891.6249   34  506 20758.8260 39322.8082  89.4%  2045 1190s
  3586  2959 30954.8845   17  502 20758.8260 39322.8082  89.4%  2045 1196s
  3587  2959 31797.6093   15  502 20758.8260 39322.8082  89.4%  2044 1235s
  3588  2960 21601.2326   35  502 20758.8260 39322.8082  89.4%  2043 1303s
  3589  2964 39124.4397   16  467 20758.8260 39322.8082  89.4%  2122 1337s
  3591  2967 38982.5002   17  391 20758.8260 39124.0296  88.5%  2125 1355s
  3595  2974 38664.4390   18  394 20758.8260 38981.0509  87.8%  2130 1371s
  3603  2987 38250.5906   19  401 20758.8260 38663.7835  86.3%  2146 1394s
  3619  2998 35939.2356   20  402 20758.8260 38250.4151  84.3%  2205 1429s
  3635  3024 35613.0543   21  392 20758.8260 38250.4151  84.3%  2246 1450s
H 3640  2873                    20799.602768 38250.4151  83.9%  2251 1450s
  3667  2950 34969.8249   22  381 20799.6028 38250.4151  83.9%  2285 1478s
  3753  2960 33367.4586   25  296 20799.6028 38250.4151  83.9%  2392 1496s
  3792  3002 33347.5714   23  329 20799.6028 38250.4151  83.9%  2421 1517s
  3847  3038 33267.3910   26  324 20799.6028 38250.4151  83.9%  2466 1538s
  3923  3082 31666.0699   26  260 20799.6028 38250.4151  83.9%  2504 1557s
  4002  3125 32245.0602   27  314 20799.6028 38250.4151  83.9%  2534 1571s
  4089  3153 32041.2637   27  310 20799.6028 38250.4151  83.9%  2551 1588s
  4178  3157 29719.5022   27  228 20799.6028 38250.4151  83.9%  2554 1605s
  4262  3169 30557.4468   28  297 20799.6028 38250.4151  83.9%  2563 1619s
  4332  3169 30472.2470   29  295 20799.6028 38250.4151  83.9%  2579 1634s
  4413  3170 29893.2679   31  229 20799.6028 38180.8462  83.6%  2593 1650s
  4481  3175 29692.0630   32  238 20799.6028 38180.8462  83.6%  2619 1666s
  4546  3178 28446.5959   35  177 20799.6028 38180.8462  83.6%  2645 1683s
  4621  3193 26945.0334   35  184 20799.6028 38180.8462  83.6%  2661 1699s
  4686  3209 28296.8927   36  136 20799.6028 38180.8462  83.6%  2708 1720s
  4767  3208 25765.4102   36  183 20799.6028 37207.0765  78.9%  2734 1738s
  4804  3223 23716.3135   38  179 20799.6028 37207.0765  78.9%  2780 1752s
  4843  3232 26639.1465   38  148 20799.6028 37207.0765  78.9%  2794 1767s
H 4881  3078                    20813.643138 36470.5207  75.2%  2817 1767s
  4883  3135 23813.4750   38  120 20813.6431 36470.5207  75.2%  2817 1784s
H 4982  2993                    20819.812179 36470.5207  75.2%  2834 1796s
H 4989  2863                    20822.271395 36470.5207  75.2%  2836 1796s
H 4993  2741                    20851.149360 36470.5207  74.9%  2836 1796s
H 5019  2678                    20852.578260 36470.5207  74.9%  2857 1815s
  5115  2711     cutoff   39      20852.5783 36470.5207  74.9%  2886 1835s
  5247  2689 21775.8485   47   61 20852.5783 36470.5207  74.9%  2896 1855s
  5352  2723 23230.8563   31  181 20852.5783 36457.1322  74.8%  2906 1874s
  5476  2763 21523.6106   35  136 20852.5783 34541.2058  65.6%  2927 1894s
  5619  2813 31681.1027   22  340 20852.5783 34504.3245  65.5%  2937 1916s
  5742  2833 31258.8170   24  296 20852.5783 34504.3245  65.5%  2956 1938s
  5894  2793 29707.9148   27  199 20852.5783 34504.3245  65.5%  2960 1953s
  5944  2805 29336.5267   28  190 20852.5783 34415.9368  65.0%  2969 1975s
  6028  2842 28228.2858   31  186 20852.5783 34415.9368  65.0%  2973 1999s
  6178  2819 22059.5618   36  129 20852.5783 34415.9368  65.0%  2991 2017s
H 6201  2702                    20886.976542 34415.9368  64.8%  2998 2017s
  6213  2786     cutoff   37      20886.9765 34415.9368  64.8%  2999 2043s
  6387  2775 31080.9741   24  270 20886.9765 34194.8627  63.7%  3006 2070s
  6592  2782     cutoff   27      20886.9765 34119.5112  63.4%  3011 2100s
  6768  2794 28531.6772   28  314 20886.9765 34119.5112  63.4%  3026 2129s
  6960  2825 26304.4688   35  221 20886.9765 34119.5112  63.4%  3053 2157s
  7133  2891 30874.5733   25  305 20886.9765 34019.7360  62.9%  3089 2188s
  7366  2929 27453.4059   30  287 20886.9765 33717.7133  61.4%  3090 2221s
  7575  2969 22456.8954   42  107 20886.9765 33400.3272  59.9%  3105 2257s
  7806  2965 29185.4812   28  278 20886.9765 33105.1164  58.5%  3115 2293s
  8018  3014 24504.1045   32  216 20886.9765 33002.6256  58.0%  3153 2327s
  8241  2997 28720.0961   27  387 20886.9765 33002.6256  58.0%  3188 2361s
  8374  3056 28614.0473   28  349 20886.9765 32915.5186  57.6%  3219 2399s
  8567  3109     cutoff   31      20886.9765 32915.5186  57.6%  3272 2437s
  8771  3139     cutoff   35      20886.9765 32811.0781  57.1%  3338 2476s
  9023  3237 27517.6633   29  213 20886.9765 32667.0700  56.4%  3383 2515s
  9297  3246     cutoff   37      20886.9765 32667.0700  56.4%  3426 2555s
  9519  3267 25396.1243   33  184 20886.9765 32245.5498  54.4%  3440 2593s
  9837  3248 27301.8194   27  338 20886.9765 32245.5498  54.4%  3445 2636s
 10181  3378 23367.3944   32  243 20886.9765 32240.5532  54.4%  3481 2678s
 10560  3473 27888.4576   27  263 20886.9765 32173.0299  54.0%  3507 2732s
 10971  3576 23531.5810   35  183 20886.9765 32086.3785  53.6%  3525 2779s
 11256  3706 28211.7824   25  257 20886.9765 32031.6131  53.4%  3586 2829s
 11564  3845     cutoff   29      20886.9765 32031.6131  53.4%  3651 2880s
 11946  4003     cutoff   27      20886.9765 31751.3148  52.0%  3690 2935s
 12311  4193 23383.1781   28  250 20886.9765 31683.8044  51.7%  3731 2989s
 12774  4331 28327.0179   27  356 20886.9765 31615.2192  51.4%  3752 3048s
 13312  4420 infeasible   38      20886.9765 31362.9244  50.2%  3753 3107s
 13867  4577 27635.8700   29  310 20886.9765 31202.3161  49.4%  3763 3167s
 14317  4749 29230.3385   26  267 20886.9765 31149.0364  49.1%  3801 3227s
 14822  4932 27525.2486   24  315 20886.9765 31047.7698  48.6%  3827 3292s
H14846  4852                    21154.713511 31047.7698  46.8%  3825 3292s
 15249  5084 21472.3273   33  154 21154.7135 30897.4440  46.1%  3839 3359s
 15800  5321 24313.7554   29  188 21154.7135 30661.3368  44.9%  3864 3428s
 16419  5449     cutoff   37      21154.7135 30661.3368  44.9%  3879 3501s
 17008  5638     cutoff   27      21154.7135 30136.2980  42.5%  3904 3571s
 17555  5723 22074.1088   38   97 21154.7135 30126.5927  42.4%  3913 3600s

Cutting planes:
  Learned: 2
  Implied bound: 3
  MIR: 651
  Mixing: 5
  Flow cover: 1424
  RLT: 31
  Relax-and-lift: 98

Explored 17862 nodes (70059629 simplex iterations) in 3600.04 seconds (7229.07 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 21154.7 20887 20852.6 ... 20540.6

Time limit reached
Best objective 2.115471351061e+04, best bound 3.012659269893e+04, gap 42.4108%
  WARNING: Time limit reached. Using best solution found (gap: 42.41%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.05s
  Master Objective (UB) = 21154.71, θ = 199388.87
  Upper Bound (UB) = 21154.71

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 199388.87
  [DEBUG]   ✓ Scenario 0: θ = 199388.87 ≤ Q = 199388.87 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 199388.87 ≤ Q = 199454.18 (slack: 65.31)
  [DEBUG]   ✓ Scenario 2: θ = 199388.87 ≤ Q = 199388.87 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 199388.87 ≤ Q = 199388.87 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 199388.87 ≤ Q = 199388.87 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 199388.87 ≤ Q = 199388.87 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 199388.87 ≤ Q = 199388.87 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x5d00b8a
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xfa2ff476
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.300744e+13
Presolve removed 2604 rows and 1894 columns
Presolve time: 0.01s
Presolved: 489 rows, 495 columns, 1383 nonzeros
Found heuristic solution: objective 5761397.0945
Variable types: 336 continuous, 159 integer (159 binary)
Found heuristic solution: objective 5760946.2144

Root relaxation: objective -1.835620e+05, 238 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -183561.99    0  122 5760946.21 -183561.99   103%     -    0s
H    0     0                    -160247.2389 -183561.99  14.5%     -    0s
H    0     0                    -160564.0377 -183320.91  14.2%     -    0s
     0     0 -169826.80    0   83 -160564.04 -169826.80  5.77%     -    0s
H    0     0                    -167431.1199 -169711.93  1.36%     -    0s
H    0     0                    -168056.0696 -169711.93  0.99%     -    0s
     0     0 -168220.07    0   37 -168056.07 -168220.07  0.10%     -    0s
     0     0 -168215.18    0   12 -168056.07 -168215.18  0.09%     -    0s
     0     0 -168188.43    0   12 -168056.07 -168188.43  0.08%     -    0s
     0     0 -168114.63    0    9 -168056.07 -168114.63  0.03%     -    0s
     0     0 -168101.46    0   14 -168056.07 -168101.46  0.03%     -    0s
     0     0 -168101.43    0   13 -168056.07 -168101.43  0.03%     -    0s
     0     0          -    0      -168056.07 -168069.88  0.01%     -    0s

Cutting planes:
  Gomory: 2
  Implied bound: 2
  MIR: 6
  Flow cover: 8
  Relax-and-lift: 4

Explored 1 nodes (598 simplex iterations) in 0.11 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 8: -168056 -166998 -166934 ... 1.30074e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.680560696444e+05, best bound -1.680698763880e+05, gap 0.0082%
  Subproblem solved in 0.15s
  Worst-case operational profit (Z_SP) = 183835.48
  Scenario: 43 demand increases, 17 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -168056.07
  [DEBUG]   S×d_nominal = 351891.55
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 351891.55 + -168056.07 = 183835.48
  [DEBUG]   Current θ from Master = 199388.87
  [DEBUG]   ⚠️  Z_SP ≤ θ by 15553.39 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 5601.33
  Lower Bound (LB) = 19242.46
  Gap (UB-LB) = 1912.2562, Absolute Gap = 1912.2562, Relative Gap = 0.090394
  Not converged yet (gap = 1912.26 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 43 increases, 17 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351367 nonzeros
Model fingerprint: 0x609be431
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 56560 rows and 22960 columns
Presolve time: 1.84s
Presolved: 67143 rows, 29220 columns, 417599 nonzeros
Variable types: 26961 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -311526.7819
Found heuristic solution: objective -189441.1784

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 67143 rows, 29220 columns, 417599 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   27971   -1.3975604e+05   0.000000e+00   3.048155e+08      5s
   41824   -6.3878045e+03   0.000000e+00   2.788254e+09     10s
   52354    9.7945822e+03   0.000000e+00   7.403602e+07     15s
   60332    1.3688345e+04   0.000000e+00   2.569428e+06     20s
   68682    1.6762269e+04   0.000000e+00   2.882539e+07     25s
   75646    2.1958855e+04   0.000000e+00   3.534627e+08     30s
   83500    2.7576580e+04   0.000000e+00   2.355282e+07     35s
Concurrent spin time: 3.77s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 5.292850e+04, 54891 iterations, 37.20 seconds (50.65 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 52928.5024    0  153 -189441.18 52928.5024   128%     -   39s
H    0     0                    -174553.6185 52928.5024   130%     -   39s
H    0     0                    -166456.2074 52928.5024   132%     -   40s
H    0     0                    -122439.2030 52928.5024   143%     -   40s
H    0     0                    -121845.0927 52928.5024   143%     -   40s
H    0     0                    -121439.2287 52928.5024   144%     -   40s
H    0     0                    -121417.0561 52928.5024   144%     -   40s
H    0     0                    -121415.5602 52928.5024   144%     -   40s
H    0     0                    -121222.0538 52928.5024   144%     -   40s
H    0     0                    -59830.75045 52928.5024   188%     -   40s
H    0     0                    -59696.17693 52928.5024   189%     -   40s
H    0     0                    -8440.617000 52928.5024   727%     -   40s
H    0     0                    -8352.165515 52928.5024   734%     -   40s
H    0     0                    2546.0636341 52928.5024  1979%     -   41s
H    0     0                    4055.6835401 52928.5024  1205%     -   41s
H    0     0                    4687.9695861 52928.5024  1029%     -   41s
H    0     0                    8545.4895670 48945.0853   473%     -   57s
H    0     0                    8673.3847472 48945.0853   464%     -   57s
H    0     0                    8971.0646204 48945.0853   446%     -   57s
H    0     0                    9145.8063532 48945.0853   435%     -   57s
     0     0 48945.0853    0  249 9145.80635 48945.0853   435%     -   57s
     0     0 48438.0207    0  241 9145.80635 48438.0207   430%     -   65s
     0     0 48431.7691    0  251 9145.80635 48431.7691   430%     -   67s
     0     0 48431.7691    0  243 9145.80635 48431.7691   430%     -   68s
     0     0 48431.7691    0  247 9145.80635 48431.7691   430%     -   68s
     0     0 45756.1928    0  291 9145.80635 45756.1928   400%     -   87s
H    0     0                    13788.752742 45756.1928   232%     -   87s
     0     0 45373.8159    0  310 13788.7527 45373.8159   229%     -   94s
     0     0 45167.3611    0  314 13788.7527 45167.3611   228%     -  100s
     0     0 45068.0915    0  275 13788.7527 45068.0915   227%     -  104s
     0     0 45033.0501    0  276 13788.7527 45033.0501   227%     -  105s
     0     0 44975.3855    0  285 13788.7527 44975.3855   226%     -  107s
     0     0 44965.3649    0  283 13788.7527 44965.3649   226%     -  109s
     0     0 44906.3706    0  282 13788.7527 44906.3706   226%     -  110s
     0     0 44855.9087    0  308 13788.7527 44855.9087   225%     -  112s
     0     0 44853.3991    0  313 13788.7527 44853.3991   225%     -  113s
     0     0 44849.6705    0  314 13788.7527 44849.6705   225%     -  113s
     0     0 44827.1774    0  287 13788.7527 44827.1774   225%     -  114s
     0     0 44820.3472    0  289 13788.7527 44820.3472   225%     -  115s
     0     0 44815.7388    0  292 13788.7527 44815.7388   225%     -  116s
     0     0 44814.8840    0  290 13788.7527 44814.8840   225%     -  116s
     0     0 44814.1234    0  292 13788.7527 44814.1234   225%     -  117s
     0     0 44812.8972    0  291 13788.7527 44812.8972   225%     -  117s
     0     0 44812.5302    0  291 13788.7527 44812.5302   225%     -  117s
     0     0 43092.3536    0  359 13788.7527 43092.3536   213%     -  138s
     0     0 42616.4523    0  396 13788.7527 42616.4523   209%     -  150s
     0     0 42349.4984    0  409 13788.7527 42349.4984   207%     -  159s
     0     0 42282.3188    0  413 13788.7527 42282.3188   207%     -  163s
     0     0 42191.9950    0  412 13788.7527 42191.9950   206%     -  167s
     0     0 42066.1442    0  368 13788.7527 42066.1442   205%     -  172s
     0     0 42041.0930    0  403 13788.7527 42041.0930   205%     -  175s
H    0     0                    17212.230990 42037.3307   144%     -  176s
     0     0 42037.3307    0  403 17212.2310 42037.3307   144%     -  176s
H    0     0                    17289.163093 42035.2618   143%     -  176s
H    0     0                    17309.957220 42035.2618   143%     -  176s
     0     0 42035.2618    0  405 17309.9572 42035.2618   143%     -  176s
     0     0 42027.1279    0  410 17309.9572 42027.1279   143%     -  179s
     0     0 42024.7098    0  408 17309.9572 42024.7098   143%     -  179s
     0     0 42024.5583    0  412 17309.9572 42024.5583   143%     -  180s
     0     0 41278.5057    0  432 17309.9572 41278.5057   138%     -  200s
     0     0 40884.3834    0  435 17309.9572 40884.3834   136%     -  206s
     0     0 40821.0092    0  439 17309.9572 40821.0092   136%     -  210s
     0     0 40742.9166    0  452 17309.9572 40742.9166   135%     -  214s
     0     0 40693.9156    0  458 17309.9572 40693.9156   135%     -  217s
     0     0 40636.8422    0  449 17309.9572 40636.8422   135%     -  220s
     0     0 40613.1353    0  452 17309.9572 40613.1353   135%     -  222s
     0     0 40606.5810    0  453 17309.9572 40606.5810   135%     -  223s
     0     0 40604.1066    0  456 17309.9572 40604.1066   135%     -  224s
     0     0 40598.7485    0  452 17309.9572 40598.7485   135%     -  224s
     0     0 40594.4730    0  456 17309.9572 40594.4730   135%     -  225s
     0     0 40582.4066    0  452 17309.9572 40582.4066   134%     -  227s
     0     0 40579.3261    0  453 17309.9572 40579.3261   134%     -  227s
     0     0 40561.5818    0  451 17309.9572 40561.5818   134%     -  230s
     0     0 40543.2687    0  453 17309.9572 40543.2687   134%     -  231s
     0     0 40530.7993    0  458 17309.9572 40530.7993   134%     -  231s
     0     0 40522.4138    0  462 17309.9572 40522.4138   134%     -  233s
     0     0 40522.2203    0  416 17309.9572 40522.2203   134%     -  233s
     0     0 40402.1855    0  466 17309.9572 40402.1855   133%     -  239s
     0     0 40349.0974    0  459 17309.9572 40349.0974   133%     -  242s
     0     0 40319.6784    0  470 17309.9572 40319.6784   133%     -  244s
     0     0 40307.0266    0  472 17309.9572 40307.0266   133%     -  246s
     0     0 40297.5242    0  477 17309.9572 40297.5242   133%     -  248s
     0     0 40290.2715    0  471 17309.9572 40290.2715   133%     -  248s
     0     0 40287.2000    0  475 17309.9572 40287.2000   133%     -  249s
     0     0 40284.1401    0  476 17309.9572 40284.1401   133%     -  249s
     0     0 40281.9236    0  476 17309.9572 40281.9236   133%     -  250s
     0     0 40281.1996    0  478 17309.9572 40281.1996   133%     -  250s
     0     0 40164.8437    0  447 17309.9572 40164.8437   132%     -  254s
H    0     0                    17337.123637 40164.8424   132%     -  258s
     0     0 40141.5891    0  447 17337.1236 40141.5891   132%     -  261s
     0     0 40118.9060    0  440 17337.1236 40118.9060   131%     -  263s
     0     0 40115.6590    0  450 17337.1236 40115.6590   131%     -  263s
     0     0 40115.0930    0  452 17337.1236 40115.0930   131%     -  263s
     0     0 40081.4097    0  406 17337.1236 40081.4097   131%     -  266s
H    0     0                    17518.871544 40079.8773   129%     -  267s
H    0     0                    17527.637772 40079.8773   129%     -  267s
H    0     0                    17552.896821 40079.8773   128%     -  267s
H    0     0                    17641.017549 40079.8773   127%     -  267s
H    0     0                    17660.294687 40079.8773   127%     -  267s
H    0     0                    17696.338871 40079.8773   126%     -  267s
     0     0 40073.8618    0  404 17696.3389 40073.8618   126%     -  268s
     0     0 40070.0909    0  412 17696.3389 40070.0909   126%     -  268s
     0     0 40065.9389    0  413 17696.3389 40065.9389   126%     -  268s
     0     0 40063.3314    0  410 17696.3389 40063.3314   126%     -  269s
     0     0 40062.7690    0  412 17696.3389 40062.7690   126%     -  269s
     0     0 40025.5526    0  453 17696.3389 40025.5526   126%     -  271s
     0     0 40020.1597    0  462 17696.3389 40020.1597   126%     -  274s
     0     0 40018.8119    0  415 17696.3389 40018.8119   126%     -  275s
     0     0 40008.8457    0  454 17696.3389 40008.8457   126%     -  277s
H    0     0                    17702.359784 40008.4417   126%     -  277s
H    0     0                    17718.133503 40008.4417   126%     -  277s
H    0     0                    17760.247264 40008.4417   125%     -  277s
H    0     0                    17865.361781 40008.4417   124%     -  277s
     0     0 40005.0519    0  450 17865.3618 40005.0519   124%     -  278s
     0     0 40004.6972    0  451 17865.3618 40004.6972   124%     -  278s
     0     0 40000.7701    0  409 17865.3618 40000.7701   124%     -  280s
H    0     0                    17912.707452 40000.0640   123%     -  290s
     0     0 39997.6719    0  411 17912.7075 39997.6719   123%     -  291s
     0     0 39997.5651    0  411 17912.7075 39997.5651   123%     -  291s
     0     0 39989.9117    0  410 17912.7075 39989.9117   123%     -  293s
     0     0 39988.3664    0  454 17912.7075 39988.3664   123%     -  294s
     0     0 39985.2713    0  454 17912.7075 39985.2713   123%     -  296s
     0     0 39982.8781    0  454 17912.7075 39982.8781   123%     -  298s
H    0     0                    17971.501663 39982.8781   122%     -  353s
H    0     0                    17999.833327 39982.8781   122%     -  354s
H    0     0                    18011.965230 39982.8781   122%     -  354s
     0     2 39982.8781    0  454 18011.9652 39982.8781   122%     -  355s
     3     8 39716.8613    2  430 18011.9652 39834.4314   121%  4118  369s
     7    16 39419.5046    3  440 18011.9652 39701.2214   120%  7078  386s
    15    32 39144.2364    4  442 18011.9652 39416.2410   119%  9068  399s
    31    48 37484.4132    5  416 18011.9652 39143.6905   117% 13441  438s
    47    80 37271.6702    6  364 18011.9652 39143.6905   117% 12698  462s
H   60    80                    18105.109825 39143.6905   116% 11523  463s
    79   172 37204.1538    7  390 18105.1098 39143.6905   116% 10233  485s
   171   204 36839.3529   10  332 18105.1098 39143.6905   116%  7043  495s
   203   236 37028.1638   10  378 18105.1098 39143.6905   116%  6259  508s
H  204   236                    18172.811577 39143.6905   115%  6228  508s
H  211   236                    18333.129695 39143.6905   114%  6141  508s
H  232   236                    18552.971853 39143.6905   111%  5987  508s
   235   356 36903.3895    9  350 18552.9719 39143.6905   111%  6000  526s
   355   446 36840.6919   11  375 18552.9719 39143.6905   111%  4843  542s
   445   540 36754.5559   11  328 18552.9719 39143.6905   111%  4363  555s
   539   630 36228.6886   11  324 18552.9719 39143.6905   111%  3986  570s
   629   698 36623.0501   10  341 18552.9719 39143.6905   111%  3718  583s
   699   750 36680.7307   12  326 18552.9719 39143.6905   111%  3611  595s
   757   821 33681.0564   34  282 18552.9719 39143.6905   111%  3579  606s
   832   904 36688.5599   12  372 18552.9719 39143.6905   111%  3469  619s
   921   978 36684.4261   12  320 18552.9719 39143.6905   111%  3315  632s
  1007  1032 36161.3481   12  327 18552.9719 39143.6905   111%  3232  646s
  1073  1092 36585.8047   13  329 18552.9719 39143.6905   111%  3167  662s
H 1155  1092                    18705.911684 39143.6905   109%  3045  662s
  1160  1176 36243.2564   13  311 18705.9117 39143.6905   109%  3048  677s
  1262  1244 35504.9770   13  315 18705.9117 38969.5139   108%  2953  691s
  1363  1302 34619.4844   13  342 18705.9117 38965.7015   108%  2898  707s
  1453  1361 30951.8594   13  324 18705.9117 38965.7015   108%  2873  727s
  1546  1385 36344.2797   13  330 18705.9117 38965.7015   108%  2844  745s
H 1547  1385                    18848.853491 38965.7015   107%  2842  745s
  1582  1462 36504.1403   14  332 18848.8535 38965.7015   107%  2885  766s
  1706  1532 35507.1970   11  331 18848.8535 38965.7015   107%  2795  785s
  1828  1583 35765.5611   14  312 18848.8535 38965.7015   107%  2744  806s
  1927  1611 35789.2961   15  332 18848.8535 38965.7015   107%  2738  827s
H 1942  1611                    18982.211715 38965.7015   105%  2744  827s
  1961  1676 32887.8904   15  323 18982.2117 38965.7015   105%  2773  847s
  2055  1751 35424.7174   15  317 18982.2117 38965.7015   105%  2812  868s
  2176  1798 34594.9998   16  326 18982.2117 38965.7015   105%  2811  886s
H 2177  1798                    19024.546971 38965.7015   105%  2810  886s
H 2188  1796                    19296.607453 38965.7015   102%  2817  886s
  2249  1865 33791.9559   17  289 19296.6075 38965.7015   102%  2810  912s
  2375  1952 32672.1548   18  258 19296.6075 38564.1245   100%  2799  935s
  2492  2078 32128.4404   17  264 19296.6075 37901.4620  96.4%  2813  960s
  2640  2217 28355.8665   19  281 19296.6075 37901.4620  96.4%  2790  982s
  2841  2407 30227.8473   19  218 19296.6075 37901.4620  96.4%  2717 1007s
  3071  2551 29019.9270   23  178 19296.6075 37757.0326  95.7%  2640 1033s
  3277  2738 28196.4146   28  150 19296.6075 37731.9458  95.5%  2601 1054s
H 3494  2738                    19338.942709 37731.9458  95.1%  2546 1069s
  3495  2739 33032.0336   13  454 19338.9427 37731.9458  95.1%  2545 1153s
  3497  2740 26403.3847   29  153 19338.9427 37731.9458  95.1%  2543 1198s
  3498  2741 35448.7852   11  358 19338.9427 37731.9458  95.1%  2543 1235s
  3499  2742 27121.5025   42  397 19338.9427 37731.9458  95.1%  2542 1259s
  3500  2742 26897.6857   37  420 19338.9427 37731.9458  95.1%  2541 1277s
  3501  2743 35659.8003   14  425 19338.9427 37731.9458  95.1%  2540 1290s
  3502  2744 20628.8408   56  447 19338.9427 37731.9458  95.1%  2540 1303s
  3503  2744 20195.2059   72  445 19338.9427 37731.9458  95.1%  2539 1312s
  3504  2745 36449.4829   10  451 19338.9427 37731.9458  95.1%  2538 1315s
  3506  2746 20078.1238   25  417 19338.9427 37731.9458  95.1%  2537 1321s
  3508  2748 32144.8300   20  429 19338.9427 37731.9458  95.1%  2535 1328s
  3509  2748 36019.3821   11  435 19338.9427 37731.9458  95.1%  2535 1330s
  3512  2750 32829.8740   25  398 19338.9427 37731.9458  95.1%  2532 1336s
  3515  2752 27929.8902   16  417 19338.9427 37731.9458  95.1%  2530 1347s
  3517  2754 33742.1242   29  417 19338.9427 37731.9458  95.1%  2529 1352s
  3518  2754 31192.1472   25  448 19338.9427 37731.9458  95.1%  2528 1355s
  3519  2755 33550.8747   14  485 19338.9427 37731.9458  95.1%  2527 1365s
  3521  2756 23086.0094   46  477 19338.9427 37731.9458  95.1%  2526 1371s
  3522  2757 30348.6547   23  448 19338.9427 37731.9458  95.1%  2525 1375s
  3523  2758 21216.0519   26  437 19338.9427 37731.9458  95.1%  2525 1381s
  3525  2759 36160.9506   13  452 19338.9427 37731.9458  95.1%  2523 1386s
  3526  2760 24872.9152   13  412 19338.9427 37731.9458  95.1%  2522 1391s
  3528  2761 34589.2334   18  447 19338.9427 37731.9458  95.1%  2521 1397s
  3529  2762 21973.1530   46  418 19338.9427 37731.9458  95.1%  2520 1405s
  3531  2763 36482.3757   14  455 19338.9427 37731.9458  95.1%  2519 1413s
  3532  2764 29287.8108   31  419 19338.9427 37731.9458  95.1%  2518 1415s
  3533  2764 35283.9719   26  448 19338.9427 37731.9458  95.1%  2517 1421s
  3535  2766 33533.1976   27  497 19338.9427 37731.9458  95.1%  2516 1428s
  3536  2766 34376.2142   24  496 19338.9427 37731.9458  95.1%  2515 1432s
  3537  2767 23274.5725   45  474 19338.9427 37731.9458  95.1%  2515 1439s
  3538  2768 30284.7247   38  474 19338.9427 37731.9458  95.1%  2514 1486s
  3539  2768 32565.1346   39  474 19338.9427 37731.9458  95.1%  2513 1534s
H 3539  2630                    19385.181572 37731.9458  94.6%  2577 1609s
  3540  2632 37731.9458   11  452 19385.1816 37731.9458  94.6%  2578 1627s
  3542  2635 37731.9458   12  442 19385.1816 37731.9458  94.6%  2579 1656s
  3546  2642 37731.9458   13  441 19385.1816 37731.9458  94.6%  2587 1678s
  3554  2655 37731.9458   14  476 19385.1816 37731.9458  94.6%  2607 1701s
  3570  2666 37024.1036   15  436 19385.1816 37731.9458  94.6%  2669 1749s
  3586  2693 35184.2600   16  429 19385.1816 37731.9458  94.6%  2720 1785s
  3618  2797 34932.0349   17  421 19385.1816 37731.9458  94.6%  2787 1816s
  3733  2824 34339.9235   21  423 19385.1816 37731.9458  94.6%  2908 1836s
  3798  2863 34332.8697   22  418 19385.1816 37731.9458  94.6%  2938 1857s
  3859  2874 34353.6969   20  433 19385.1816 37731.9458  94.6%  2979 1876s
  3890  2899 33747.0365   23  309 19385.1816 37731.9458  94.6%  3002 1893s
  3926  2923 32253.9213   23  358 19385.1816 37731.9458  94.6%  3034 1912s
  3962  2951 33235.3279   22  352 19385.1816 37731.9458  94.6%  3057 1930s
  4008  2966 31918.2070   22  358 19385.1816 37731.9458  94.6%  3100 1949s
  4046  2978 32866.6189   22  350 19385.1816 37731.9458  94.6%  3123 1966s
  4079  2989 32596.4128   24  303 19385.1816 37731.9458  94.6%  3143 1991s
  4132  2995 30819.1666   24  350 19385.1816 37731.9458  94.6%  3148 2009s
  4180  3005 30947.2306   24  293 19385.1816 37731.9458  94.6%  3156 2029s
  4228  3014 31380.6156   24  338 19385.1816 37731.9458  94.6%  3157 2052s
  4274  3021 32375.6484   25  356 19385.1816 37731.9458  94.6%  3169 2069s
  4321  3031 30648.4408   26  306 19385.1816 37731.9458  94.6%  3183 2085s
  4369  3053 31425.6563   26  375 19385.1816 37731.9458  94.6%  3194 2107s
  4433  3068 30115.9427   27  272 19385.1816 37731.9458  94.6%  3193 2125s
  4500  3071 29304.9588   28  354 19385.1816 37731.9458  94.6%  3198 2155s
  4577  3072 28467.2059   29  376 19385.1816 37731.9458  94.6%  3191 2184s
  4647  3086 28053.4459   30  360 19385.1816 37731.9458  94.6%  3198 2211s
  4722  3102 26564.9256   31  281 19385.1816 37731.9458  94.6%  3212 2236s
  4799  3113 22530.8548   33  271 19385.1816 37661.9732  94.3%  3222 2265s
  4884  3141 26712.1549   31  309 19385.1816 37661.9732  94.3%  3236 2290s
  4979  3174 24005.0729   36  242 19385.1816 37661.9732  94.3%  3243 2318s
  5089  3206 22309.8820   38  223 19385.1816 37661.9732  94.3%  3251 2347s
  5205  3228 21428.2546   39  207 19385.1816 37661.9732  94.3%  3254 2376s
  5328  3235 21316.1606   40  179 19385.1816 37661.9732  94.3%  3257 2409s
  5456  3223 29488.5857   18  338 19385.1816 37661.9732  94.3%  3264 2436s
H 5478  3084                    20061.217190 37661.9732  87.7%  3263 2436s
  5521  3128 24635.6366   19  293 20061.2172 37661.9732  87.7%  3272 2471s
  5633  3177 24142.3369   20  289 20061.2172 36946.3119  84.2%  3289 2502s
  5757  3221 21877.2880   23  249 20061.2172 36917.9961  84.0%  3309 2536s
  5892  3204     cutoff   25      20061.2172 36917.9961  84.0%  3325 2561s
H 5895  3078                    20082.011317 36917.9961  83.8%  3325 2561s
H 5898  2957                    20241.849360 36917.9961  82.4%  3327 2561s
H 5905  2842                    20569.166077 36917.9961  79.5%  3329 2561s
  5927  2926 infeasible   26      20569.1661 36917.9961  79.5%  3333 2598s
  6113  2953 33528.0441   18  340 20569.1661 35483.0677  72.5%  3321 2639s
H 6220  2810                    20670.466043 35431.8053  71.4%  3338 2639s
  6251  2881 32902.7030   20  312 20670.4660 35431.8053  71.4%  3334 2676s
  6414  2921 29184.5736   22  320 20670.4660 35431.8053  71.4%  3346 2715s
  6614  2914 24960.4790   26  135 20670.4660 35181.2556  70.2%  3349 2755s
  6867  2931 20702.9494   36   21 20670.4660 34887.9595  68.8%  3323 2795s
  7086  2965 30243.6988   19  328 20670.4660 34266.5828  65.8%  3314 2832s
  7255  2999 28264.7981   20  304 20670.4660 34266.5828  65.8%  3296 2872s
  7430  3088 26540.9124   23  200 20670.4660 34266.5828  65.8%  3292 2913s
  7646  3110 24605.8669   28  164 20670.4660 34067.3939  64.8%  3298 2963s
  7906  3099     cutoff   32      20670.4660 34067.0547  64.8%  3299 3018s
  8141  3109 24794.3410   23  261 20670.4660 33876.5517  63.9%  3323 3071s
  8345  3130 22594.8720   25  186 20670.4660 33755.3925  63.3%  3356 3128s
  8571  3163 infeasible   27      20670.4660 33557.5777  62.3%  3380 3187s
  8818  3122 27080.3991   20  291 20670.4660 33426.3940  61.7%  3400 3235s
  8947  3170 27836.1020   20  313 20670.4660 33309.7546  61.1%  3411 3284s
  9103  3200 26286.4010   22  295 20670.4660 33234.0675  60.8%  3432 3340s
  9348  3233 21545.4718   24  205 20670.4660 33234.0675  60.8%  3437 3402s
  9579  3299 21402.7654   28  242 20670.4660 33234.0675  60.8%  3457 3462s
  9886  3487 25780.7259   26  272 20670.4660 33199.5947  60.6%  3471 3529s
 10243  3604     cutoff   36      20670.4660 33199.5947  60.6%  3471 3599s
 10651  3601     cutoff   32      20670.4660 33176.5546  60.5%  3473 3600s

Cutting planes:
  MIR: 1076
  Mixing: 6
  Flow cover: 2217
  RLT: 21
  Relax-and-lift: 202

Explored 10654 nodes (37276465 simplex iterations) in 3600.04 seconds (6627.52 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 20670.5 20569.2 20241.8 ... 18982.2

Time limit reached
Best objective 2.067046604343e+04, best bound 3.317655460730e+04, gap 60.5022%
  WARNING: Time limit reached. Using best solution found (gap: 60.50%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.05s
  Master Objective (UB) = 20670.47, θ = 210164.95
  Upper Bound (UB) = 20670.47

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 210164.95
  [DEBUG]   ✓ Scenario 0: θ = 210164.95 ≤ Q = 210164.95 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 210164.95 ≤ Q = 210164.95 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 210164.95 ≤ Q = 210164.95 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 210164.95 ≤ Q = 210164.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 210164.95 ≤ Q = 210164.95 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 210164.95 ≤ Q = 210164.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 210164.95 ≤ Q = 210164.95 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 210164.95 ≤ Q = 210164.95 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x2a741ceb
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xd58be315
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.259098e+13
Presolve removed 2597 rows and 1887 columns
Presolve time: 0.01s
Presolved: 496 rows, 502 columns, 1401 nonzeros
Found heuristic solution: objective 5366486.7507
Variable types: 342 continuous, 160 integer (160 binary)

Root relaxation: objective -1.967307e+05, 251 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -196730.67    0  131 5366486.75 -196730.67   104%     -    0s
H    0     0                    -159687.3629 -196730.67  23.2%     -    0s
H    0     0                    -160140.8200 -196730.67  22.8%     -    0s
H    0     0                    -162572.8701 -196730.67  21.0%     -    0s
H    0     0                    -167725.8862 -196730.67  17.3%     -    0s
     0     0 -178815.43    0   65 -167725.89 -178815.43  6.61%     -    0s
H    0     0                    -176648.3764 -178771.40  1.20%     -    0s
H    0     0                    -177129.4615 -178225.34  0.62%     -    0s
     0     0 -178225.34    0   68 -177129.46 -178225.34  0.62%     -    0s
     0     0 -178204.13    0   68 -177129.46 -178204.13  0.61%     -    0s
     0     0 -177435.20    0   13 -177129.46 -177435.20  0.17%     -    0s
     0     0 -177431.60    0    9 -177129.46 -177431.60  0.17%     -    0s
H    0     0                    -177341.9313 -177403.91  0.03%     -    0s
     0     0 -177403.91    0    7 -177341.93 -177403.91  0.03%     -    0s
     0     0 -177386.65    0    4 -177341.93 -177386.65  0.03%     -    0s
     0     0 -177386.65    0   30 -177341.93 -177386.65  0.03%     -    0s
*    0     0               0    -177371.2387 -177371.24  0.00%     -    0s

Cutting planes:
  Gomory: 2
  Implied bound: 13
  MIR: 20
  Flow cover: 1
  RLT: 2

Explored 1 nodes (619 simplex iterations) in 0.11 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -177371 -177342 -177129 ... 1.2591e+13
No other solutions better than -177371

Optimal solution found (tolerance 1.00e-04)
Best objective -1.773712386904e+05, best bound -1.773712386904e+05, gap 0.0000%
  Subproblem solved in 0.14s
  Worst-case operational profit (Z_SP) = 195815.63
  Scenario: 21 demand increases, 39 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -177371.24
  [DEBUG]   S×d_nominal = 373186.87
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 373186.87 + -177371.24 = 195815.63
  [DEBUG]   Current θ from Master = 210164.95
  [DEBUG]   ⚠️  Z_SP ≤ θ by 14349.32 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 6321.15
  Lower Bound (LB) = 19242.46
  Gap (UB-LB) = 1428.0087, Absolute Gap = 1428.0087, Relative Gap = 0.069084
  Not converged yet (gap = 1428.01 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 21 increases, 39 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394598 nonzeros
Model fingerprint: 0x99d71ee1
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 63630 rows and 25830 columns
Presolve time: 2.55s
Presolved: 75363 rows, 32590 columns, 469109 nonzeros
Variable types: 30331 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -311526.7819
Found heuristic solution: objective -189441.1784

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 75363 rows, 32590 columns, 469109 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   27319   -1.9585223e+05   0.000000e+00   2.305085e+06      5s
   42038   -5.2919055e+04   0.000000e+00   1.223109e+07     10s
   52261   -2.9260735e+04   0.000000e+00   5.819078e+06     15s
   62520   -1.4749648e+04   0.000000e+00   7.229487e+06     20s
   69668   -1.2359687e+04   0.000000e+00   1.132771e+08     25s
   76588   -1.0753094e+04   0.000000e+00   9.961241e+06     30s
   82919   -8.9105065e+03   0.000000e+00   3.596217e+06     35s
   86530   -8.8578226e+03   0.000000e+00   6.667669e+06     40s
   89984   -8.5944668e+03   0.000000e+00   3.744119e+07     45s
   95895    5.2179614e+03   0.000000e+00   3.104181e+09     50s
Concurrent spin time: 4.30s

Solved with dual simplex

Root relaxation: objective 5.292850e+04, 70705 iterations, 54.98 seconds (73.84 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 52928.5024    0  153 -189441.18 52928.5024   128%     -   58s
H    0     0                    -170976.1014 52928.5024   131%     -   58s
H    0     0                    -170524.7390 52928.5024   131%     -   58s
H    0     0                    -166552.5627 52928.5024   132%     -   59s
H    0     0                    -164288.2252 52928.5024   132%     -   59s
H    0     0                    -164196.8088 52928.5024   132%     -   59s
H    0     0                    -164193.8835 52928.5024   132%     -   59s
H    0     0                    -59830.75045 52928.5024   188%     -   59s
H    0     0                    -59696.17693 52928.5024   189%     -   59s
H    0     0                    -8440.617000 52928.5024   727%     -   60s
H    0     0                    -8352.165515 52928.5024   734%     -   60s
H    0     0                    2546.0636341 52928.5024  1979%     -   60s
H    0     0                    2989.3941416 52928.5024  1671%     -   60s
H    0     0                    4055.6835401 52928.5024  1205%     -   60s
H    0     0                    4353.5729543 52928.5024  1116%     -   60s
H    0     0                    4687.9695861 52928.5024  1029%     -   60s
H    0     0                    8915.8282324 48861.5915   448%     -   78s
H    0     0                    8918.0318192 48861.5915   448%     -   78s
H    0     0                    8973.6048258 48861.5915   445%     -   78s
H    0     0                    9145.8063532 48861.5915   434%     -   78s
     0     0 48861.5915    0  235 9145.80635 48861.5915   434%     -   79s
     0     0 48429.6377    0  245 9145.80635 48429.6377   430%     -   87s
     0     0 48429.6377    0  247 9145.80635 48429.6377   430%     -   89s
     0     0 48429.6377    0  241 9145.80635 48429.6377   430%     -   89s
     0     0 48429.6377    0  237 9145.80635 48429.6377   430%     -   92s
     0     0 48429.6377    0  239 9145.80635 48429.6377   430%     -   92s
     0     0 48429.6377    0  239 9145.80635 48429.6377   430%     -   92s
     0     0 48429.6377    0  241 9145.80635 48429.6377   430%     -   93s
     0     0 48429.6319    0  246 9145.80635 48429.6319   430%     -   93s
     0     0 48429.6312    0  248 9145.80635 48429.6312   430%     -   93s
     0     0 45577.6626    0  302 9145.80635 45577.6626   398%     -  118s
H    0     0                    10445.516415 45577.5290   336%     -  119s
     0     0 45146.0751    0  309 10445.5164 45146.0751   332%     -  132s
     0     0 44986.8767    0  334 10445.5164 44986.8767   331%     -  141s
     0     0 44917.4012    0  338 10445.5164 44917.4012   330%     -  146s
     0     0 44903.3256    0  343 10445.5164 44903.3256   330%     -  148s
     0     0 44896.0668    0  341 10445.5164 44896.0668   330%     -  150s
     0     0 44784.3556    0  341 10445.5164 44784.3556   329%     -  155s
     0     0 44776.6192    0  339 10445.5164 44776.6192   329%     -  157s
     0     0 44768.7616    0  338 10445.5164 44768.7616   329%     -  159s
     0     0 44760.2128    0  343 10445.5164 44760.2128   329%     -  160s
H    0     0                    10602.813347 44758.3268   322%     -  161s
H    0     0                    10641.169273 44758.3268   321%     -  161s
     0     0 44758.3268    0  343 10641.1693 44758.3268   321%     -  161s
     0     0 44756.1678    0  341 10641.1693 44756.1678   321%     -  162s
     0     0 44755.8917    0  345 10641.1693 44755.8917   321%     -  162s
     0     0 43120.5962    0  409 10641.1693 43120.5962   305%     -  200s
H    0     0                    12002.008923 42583.0346   255%     -  215s
H    0     0                    13788.752742 42583.0346   209%     -  215s
     0     0 42583.0346    0  427 13788.7527 42583.0346   209%     -  215s
H    0     0                    16404.494978 42306.0342   158%     -  227s
H    0     0                    16423.684620 42306.0342   158%     -  227s
     0     0 42306.0342    0  409 16423.6846 42306.0342   158%     -  227s
     0     0 42149.8064    0  411 16423.6846 42149.8064   157%     -  235s
     0     0 42079.3372    0  425 16423.6846 42079.3372   156%     -  241s
     0     0 41987.5315    0  421 16423.6846 41987.5315   156%     -  246s
     0     0 41962.3974    0  421 16423.6846 41962.3974   155%     -  249s
     0     0 41944.6254    0  413 16423.6846 41944.6254   155%     -  251s
     0     0 41938.2742    0  417 16423.6846 41938.2742   155%     -  252s
     0     0 41919.6533    0  414 16423.6846 41919.6533   155%     -  255s
     0     0 41915.0263    0  416 16423.6846 41915.0263   155%     -  257s
     0     0 41913.4280    0  420 16423.6846 41913.4280   155%     -  258s
     0     0 41913.1959    0  420 16423.6846 41913.1959   155%     -  259s
     0     0 41283.8558    0  431 16423.6846 41283.8558   151%     -  281s
     0     0 41017.9534    0  437 16423.6846 41017.9534   150%     -  289s
     0     0 40934.1613    0  456 16423.6846 40934.1613   149%     -  294s
     0     0 40906.9097    0  420 16423.6846 40906.9097   149%     -  296s
     0     0 40884.5368    0  448 16423.6846 40884.5368   149%     -  298s
     0     0 40696.1587    0  418 16423.6846 40696.1587   148%     -  307s
     0     0 40570.0459    0  450 16423.6846 40570.0459   147%     -  311s
     0     0 40541.8606    0  448 16423.6846 40541.8606   147%     -  313s
     0     0 40519.6932    0  453 16423.6846 40519.6932   147%     -  315s
     0     0 40508.3107    0  447 16423.6846 40508.3107   147%     -  317s
     0     0 40500.5425    0  457 16423.6846 40500.5425   147%     -  318s
     0     0 40498.7688    0  455 16423.6846 40498.7688   147%     -  319s
     0     0 40498.2224    0  455 16423.6846 40498.2224   147%     -  319s
H    0     0                    16426.646367 40353.5064   146%     -  327s
     0     0 40353.5064    0  465 16426.6464 40353.5064   146%     -  327s
H    0     0                    16635.232129 40352.3426   143%     -  328s
     0     0 40333.6259    0  470 16635.2321 40333.6259   142%     -  330s
     0     0 40325.5614    0  473 16635.2321 40325.5614   142%     -  332s
     0     0 40318.2461    0  472 16635.2321 40318.2461   142%     -  333s
     0     0 40313.1254    0  477 16635.2321 40313.1254   142%     -  334s
     0     0 40310.6867    0  477 16635.2321 40310.6867   142%     -  334s
     0     0 40309.4729    0  471 16635.2321 40309.4729   142%     -  335s
     0     0 40190.7195    0  392 16635.2321 40190.7195   142%     -  340s
     0     0 40140.5887    0  444 16635.2321 40140.5887   141%     -  345s
     0     0 40123.9104    0  437 16635.2321 40123.9104   141%     -  346s
     0     0 40116.4016    0  436 16635.2321 40116.4016   141%     -  347s
     0     0 40111.7359    0  438 16635.2321 40111.7359   141%     -  348s
     0     0 40111.1794    0  438 16635.2321 40111.1794   141%     -  348s
     0     0 40051.9651    0  450 16635.2321 40051.9651   141%     -  353s
     0     0 40035.6570    0  443 16635.2321 40035.6570   141%     -  355s
     0     0 40030.1613    0  455 16635.2321 40030.1613   141%     -  356s
     0     0 40026.3330    0  454 16635.2321 40026.3330   141%     -  357s
     0     0 40025.3647    0  461 16635.2321 40025.3647   141%     -  358s
     0     0 39966.1084    0  444 16635.2321 39966.1084   140%     -  365s
     0     0 39923.8485    0  446 16635.2321 39923.8485   140%     -  369s
     0     0 39911.9622    0  465 16635.2321 39911.9622   140%     -  370s
     0     0 39909.9177    0  469 16635.2321 39909.9177   140%     -  371s
     0     0 39908.4542    0  455 16635.2321 39908.4542   140%     -  372s
     0     0 39878.9455    0  453 16635.2321 39878.9455   140%     -  375s
     0     0 39875.2920    0  445 16635.2321 39875.2920   140%     -  377s
     0     0 39873.2083    0  403 16635.2321 39873.2083   140%     -  377s
     0     0 39871.4644    0  450 16635.2321 39871.4644   140%     -  377s
     0     0 39870.6724    0  420 16635.2321 39870.6724   140%     -  378s
     0     0 39863.9404    0  466 16635.2321 39863.9404   140%     -  381s
     0     0 39862.3596    0  463 16635.2321 39862.3596   140%     -  384s
     0     0 39862.0502    0  453 16635.2321 39862.0502   140%     -  385s
     0     0 39845.7899    0  454 16635.2321 39845.7899   140%     -  388s
     0     0 39843.2256    0  458 16635.2321 39843.2256   140%     -  390s
     0     0 39842.2865    0  459 16635.2321 39842.2865   140%     -  390s
     0     0 39840.5702    0  460 16635.2321 39840.5702   139%     -  392s
H    0     0                    16793.436725 39840.2397   137%     -  405s
H    0     0                    16821.768389 39840.2397   137%     -  405s
H    0     0                    16914.002582 39837.7669   136%     -  407s
     0     0 39837.7669    0  464 16914.0026 39837.7669   136%     -  407s
     0     0 39836.6849    0  416 16914.0026 39836.6849   136%     -  407s
     0     0 39835.1607    0  470 16914.0026 39835.1607   136%     -  409s
     0     0 39834.8796    0  472 16914.0026 39834.8796   136%     -  410s
     0     0 39833.4658    0  465 16914.0026 39833.4658   136%     -  412s
     0     0 39832.9125    0  465 16914.0026 39832.9125   136%     -  413s
H    0     0                    17301.340974 39832.5227   130%     -  529s
H    0     0                    18950.101968 39832.5227   110%     -  532s
H    0     0                    19667.994187 39832.5227   103%     -  532s
H    0     0                    19789.112974 39832.5227   101%     -  532s
H    0     0                    19926.909410 39832.5227   100%     -  532s
     0     2 39832.5227    0  465 19926.9094 39832.5227   100%     -  533s
     1     4 39794.5777    1  454 19926.9094 39832.5227   100%  3041  551s
     3     8 39642.6281    2  470 19926.9094 39792.9202   100%  7473  568s
     7    16 39372.6945    3  449 19926.9094 39641.6807  98.9% 10787  585s
    15    32 39166.5529    4  452 19926.9094 39367.3711  97.6% 10722  603s
    31    48 38580.9755    5  392 19926.9094 39162.8035  96.5% 14504  639s
    47    80 37280.3072    6  411 19926.9094 39162.8035  96.5% 15350  672s
H   50    80                    20548.593553 39162.8035  90.6% 15164  672s
H   51    80                    20564.992617 39162.8035  90.4% 15035  672s
H   56    80                    20590.834346 39162.8035  90.2% 14747  672s
    79   173 36884.7364    7  409 20590.8343 39162.8035  90.2% 12627  701s
   172   282 36372.4359   10  394 20590.8343 39162.8035  90.2%  8748  721s
H  191   282                    20636.492286 39162.8035  89.8%  8123  721s
   281   361 35952.1210    9  388 20636.4923 39162.8035  89.8%  6442  735s
   360   429 36313.2842   11  386 20636.4923 39162.8035  89.8%  5715  752s
   430   516 34063.3346   17  367 20636.4923 39162.8035  89.8%  5306  766s
   517   547 36170.8291   12  378 20636.4923 39162.8035  89.8%  4819  780s
   548   581 36126.1618   12  382 20636.4923 39162.8035  89.8%  4666  793s
   582   616 35536.7835   12  384 20636.4923 39162.8035  89.8%  4584  803s
   617   645 36116.9856   12  385 20636.4923 39162.8035  89.8%  4479  817s
   646   680 36028.1405   13  370 20636.4923 39162.8035  89.8%  4440  830s
   681   715 35358.1665   13  368 20636.4923 39162.8035  89.8%  4352  844s
H  708   715                    20759.519254 39162.8035  88.6%  4289  844s
   716   813 35325.7931   13  365 20759.5193 39162.8035  88.6%  4276  859s
   816   892 35959.5993   14  368 20759.5193 39162.8035  88.6%  3986  876s
   897   952 35711.0297   16  378 20759.5193 39162.8035  88.6%  3840  893s
   965  1021 35674.3266   17  381 20759.5193 39162.8035  88.6%  3792  911s
  1044  1096 34369.2512   18  361 20759.5193 39162.8035  88.6%  3711  930s
  1143  1184 35611.4947   17  376 20759.5193 39162.8035  88.6%  3577  949s
  1253  1277 35505.8477   18  368 20759.5193 39162.8035  88.6%  3438  970s
  1383  1360 33399.1610   19  322 20759.5193 39162.8035  88.6%  3275  988s
  1521  1457 32088.4587   19  312 20759.5193 39162.8035  88.6%  3136 1008s
  1650  1610 33309.5336   20  309 20759.5193 39162.8035  88.6%  3027 1028s
  1817  1640 33093.6251   20  368 20759.5193 39162.8035  88.6%  2883 1040s
  1851  1667 32628.9910   21  314 20759.5193 39162.8035  88.6%  2877 1057s
  1892  1697 32427.7717   21  300 20759.5193 39162.8035  88.6%  2872 1076s
  1930  1730 23255.3470   70  150 20759.5193 39162.8035  88.6%  2877 1093s
  1977  1771 30864.2556   22  305 20759.5193 38768.5674  86.8%  2851 1111s
  2032  1833 30866.4377   22  289 20759.5193 38760.0475  86.7%  2821 1127s
  2122  1929 30712.6469   23  303 20759.5193 38760.0475  86.7%  2762 1147s
  2252  2043 29389.8092   24  284 20759.5193 38760.0475  86.7%  2688 1168s
  2430  2159 29702.3708   24  291 20759.5193 38760.0475  86.7%  2587 1191s
  2627  2276 29720.3038   27  290 20759.5193 38760.0475  86.7%  2501 1215s
  2780  2418 29433.6673   27  273 20759.5193 38760.0475  86.7%  2478 1238s
  2954  2506 29398.6987   29  303 20759.5193 38760.0475  86.7%  2443 1263s
  3078  2585 28734.4783   33  303 20759.5193 38760.0475  86.7%  2438 1288s
  3159  2675 28414.9371   34  270 20759.5193 38760.0475  86.7%  2458 1316s
  3271  2813 27750.1462   35  271 20759.5193 38760.0475  86.7%  2449 1340s
  3442  2814 25833.3809   43  465 20759.5193 38760.0475  86.7%  2407 1453s
H 3443  2674                    20789.284621 38760.0475  86.4%  2406 1485s
  3445  2675 32529.3776   24  347 20789.2846 38760.0475  86.4%  2405 1549s
  3446  2676 23640.1885   79  412 20789.2846 38760.0475  86.4%  2404 1581s
  3447  2676 32000.5061   33  459 20789.2846 38760.0475  86.4%  2404 1607s
  3448  2677 23422.2694   66  463 20789.2846 38760.0475  86.4%  2403 1622s
  3449  2678 27626.3328   36  471 20789.2846 38760.0475  86.4%  2402 1634s
  3450  2678 24667.9098   44  468 20789.2846 38760.0475  86.4%  2401 1644s
  3451  2679 32627.2462   16  467 20789.2846 38760.0475  86.4%  2401 1651s
  3452  2680 31836.1883   25  434 20789.2846 38760.0475  86.4%  2400 1658s
  3453  2680 22836.8543   77  442 20789.2846 38760.0475  86.4%  2399 1664s
  3454  2681 32804.3220   21  427 20789.2846 38760.0475  86.4%  2399 1669s
  3455  2682 22236.9894   95  399 20789.2846 38760.0475  86.4%  2398 1675s
  3456  2682 25563.1995   51  443 20789.2846 38760.0475  86.4%  2397 1680s
  3459  2684 24836.5966   78  404 20789.2846 38760.0475  86.4%  2395 1688s
  3460  2685 24447.2116   87  445 20789.2846 38760.0475  86.4%  2395 1690s
  3462  2686 22932.0330   57  468 20789.2846 38760.0475  86.4%  2393 1706s
  3463  2687 23833.2168   88  441 20789.2846 38760.0475  86.4%  2392 1710s
  3465  2688 26837.3792   52  441 20789.2846 38760.0475  86.4%  2391 1716s
  3466  2689 24452.5746   55  448 20789.2846 38760.0475  86.4%  2390 1725s
  3468  2690 27210.2088   45  457 20789.2846 38760.0475  86.4%  2389 1730s
  3471  2692 22389.0243   65  494 20789.2846 38760.0475  86.4%  2387 1736s
H 3472  2558                    20811.349129 38760.0475  86.2%  2386 1747s
  3474  2559 26173.7079   32  507 20811.3491 38760.0475  86.2%  2385 1750s
  3476  2561 28824.0521   47  498 20811.3491 38760.0475  86.2%  2383 1755s
  3477  2561 26892.7815   51  458 20811.3491 38760.0475  86.2%  2383 1762s
  3479  2563 22537.4716   79  460 20811.3491 38760.0475  86.2%  2381 1766s
  3480  2563 30692.5789   28  490 20811.3491 38760.0475  86.2%  2381 1775s
  3482  2565 29947.3737   30  508 20811.3491 38760.0475  86.2%  2379 1785s
  3484  2566 28540.8894   34  449 20811.3491 38760.0475  86.2%  2378 1796s
  3486  2567 23771.8176   94  448 20811.3491 38760.0475  86.2%  2377 1803s
  3487  2568 25675.3195   33  487 20811.3491 38760.0475  86.2%  2376 1809s
  3488  2569 26901.7681   69  497 20811.3491 38760.0475  86.2%  2375 1812s
  3489  2569 28372.6516   31  436 20811.3491 38760.0475  86.2%  2375 1818s
  3490  2570 31729.5797   29  436 20811.3491 38760.0475  86.2%  2374 1852s
  3491  2571 34597.0118   12  436 20811.3491 38760.0475  86.2%  2373 1908s
H 3491  2443                    20847.823257 38760.0475  85.9%  2448 1981s
  3492  2444 38760.0475   15  456 20847.8233 38760.0475  85.9%  2451 2009s
  3494  2448 38760.0475   16  425 20847.8233 38760.0475  85.9%  2454 2041s
  3498  2454 38623.1918   17  433 20847.8233 38760.0475  85.9%  2464 2076s
  3506  2468 37926.7043   18  437 20847.8233 38622.1673  85.3%  2491 2114s
  3522  2478 36746.7174   19  431 20847.8233 37926.2957  81.9%  2583 2187s
  3538  2503 34913.0375   20  374 20847.8233 37926.2957  81.9%  2639 2229s
  3570  2606 34531.1029   21  379 20847.8233 37926.2957  81.9%  2729 2279s
  3684  2652 34272.9059   22  360 20847.8233 37926.2957  81.9%  2869 2308s
  3768  2700 31500.8999   24  325 20847.8233 37926.2957  81.9%  2913 2334s
  3844  2708 33894.1706   23  363 20847.8233 37926.2957  81.9%  2941 2349s
H 3859  2580                    20931.635767 37926.2957  81.2%  2941 2349s
  3877  2636 31924.0653   25  302 20931.6358 37926.2957  81.2%  2949 2371s
  3942  2691 30784.4674   25  317 20931.6358 37926.2957  81.2%  2970 2394s
  4027  2725 31045.7501   25  330 20931.6358 37926.2957  81.2%  2968 2416s
  4111  2720 30670.5698   26  280 20931.6358 37926.2957  81.2%  2971 2434s
  4144  2739 29415.0277   27  270 20931.6358 37926.2957  81.2%  2974 2451s
  4180  2756 28070.5674   27  255 20931.6358 37926.2957  81.2%  2981 2467s
  4224  2769 30655.7522   26  327 20931.6358 37926.2957  81.2%  2983 2486s
  4266  2784 28924.5653   28  262 20931.6358 37926.2957  81.2%  2984 2508s
  4314  2802 28194.5893   29  229 20931.6358 37926.2957  81.2%  2988 2521s
  4361  2801 27550.4983   30  236 20931.6358 37926.2957  81.2%  2989 2540s
  4397  2804 27961.1962   30  203 20931.6358 37926.2957  81.2%  2995 2563s
  4442  2810 25766.7215   31  189 20931.6358 37926.2957  81.2%  3000 2586s
  4480  2817 26616.9312   33  307 20931.6358 37926.2957  81.2%  3003 2609s
  4544  2825     cutoff   32      20931.6358 37926.2957  81.2%  3007 2640s
  4614  2834 25410.3265   36  283 20931.6358 37926.2957  81.2%  3007 2669s
  4692  2859 24854.5047   38  190 20931.6358 37926.2957  81.2%  3008 2697s
  4766  2851 24343.5305   43  163 20931.6358 37369.1318  78.5%  3016 2726s
  4802  2866 24480.7545   42  236 20931.6358 37358.5051  78.5%  3030 2754s
  4843  2881 24446.4839   43   96 20931.6358 37358.5051  78.5%  3036 2782s
  4894  2897 23847.0141   41   80 20931.6358 37358.5051  78.5%  3041 2808s
  4953  2898 24087.3625   44  156 20931.6358 37358.5051  78.5%  3043 2840s
  5037  2912 24182.3057   44  139 20931.6358 36705.3826  75.4%  3046 2870s
  5116  2930 23919.5536   45   70 20931.6358 36705.3826  75.4%  3065 2904s
  5206  2948 infeasible   46      20931.6358 36705.3826  75.4%  3073 2939s
  5298  2978 23119.8085   54   74 20931.6358 36705.3826  75.4%  3090 2972s
  5386  3022 22036.1667   58  143 20931.6358 36705.3826  75.4%  3113 3011s
  5498  3060     cutoff   66      20931.6358 36705.3826  75.4%  3132 3051s
  5625  3090 25811.3565   22  426 20931.6358 36705.3826  75.4%  3154 3093s
  5758  3127 24711.1573   24  389 20931.6358 35899.1146  71.5%  3168 3138s
  5917  3143 23037.7533   27  364 20931.6358 35899.1146  71.5%  3166 3179s
  6061  3161 22198.5827   30  346 20931.6358 35899.1146  71.5%  3177 3229s
  6212  3183 28793.7491   29  288 20931.6358 35899.1146  71.5%  3204 3275s
  6385  3207 27754.6710   31  339 20931.6358 35899.1146  71.5%  3214 3325s
  6542  3237 26623.7685   36  124 20931.6358 35899.1146  71.5%  3231 3378s
  6701  3309 25124.7655   45  158 20931.6358 35899.1146  71.5%  3257 3427s
  6884  3334 21644.6500   60  101 20931.6358 35899.1146  71.5%  3275 3476s
  7063  3340 21032.5808   65   56 20931.6358 35021.9670  67.3%  3288 3526s
  7219  3366 21021.5326   66   62 20931.6358 34600.4657  65.3%  3309 3580s
  7411  3340 31217.1412   22  372 20931.6358 34600.4657  65.3%  3322 3600s

Cutting planes:
  Gomory: 5
  MIR: 963
  Mixing: 1
  Flow cover: 1937
  RLT: 16
  Relax-and-lift: 209

Explored 7518 nodes (25221429 simplex iterations) in 3600.04 seconds (6308.89 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 20931.6 20847.8 20811.3 ... 19926.9

Time limit reached
Best objective 2.093163576695e+04, best bound 3.460046573746e+04, gap 65.3023%
  WARNING: Time limit reached. Using best solution found (gap: 65.30%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.05s
  Master Objective (UB) = 20931.64, θ = 206247.44
  Upper Bound (UB) = 20931.64

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 206247.44
  [DEBUG]   ✓ Scenario 0: θ = 206247.44 ≤ Q = 206247.44 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 206247.44 ≤ Q = 206247.44 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 206247.44 ≤ Q = 206247.44 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 206247.44 ≤ Q = 206247.44 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 206247.44 ≤ Q = 206247.44 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 206247.44 ≤ Q = 206247.44 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 206247.44 ≤ Q = 206247.44 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 206247.44 ≤ Q = 206247.44 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 206247.44 ≤ Q = 206247.44 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x3daed0dc
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xc2512f24
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.248047e+13
Presolve removed 2595 rows and 1885 columns
Presolve time: 0.01s
Presolved: 498 rows, 504 columns, 1405 nonzeros
Found heuristic solution: objective 5180530.6660
Variable types: 344 continuous, 160 integer (160 binary)

Root relaxation: objective -1.997009e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -199700.90    0  128 5180530.67 -199700.90   104%     -    0s
H    0     0                    -163833.4207 -199700.90  21.9%     -    0s
H    0     0                    -164116.7969 -199700.90  21.7%     -    0s
H    0     0                    -165208.9709 -199700.90  20.9%     -    0s
H    0     0                    -172351.1042 -199700.90  15.9%     -    0s
     0     0 -177917.31    0   58 -172351.10 -177917.31  3.23%     -    0s
H    0     0                    -175209.4973 -177820.07  1.49%     -    0s
     0     0 -177610.64    0   62 -175209.50 -177610.64  1.37%     -    0s
     0     0 -177598.39    0   62 -175209.50 -177598.39  1.36%     -    0s
     0     0 -176837.23    0   44 -175209.50 -176837.23  0.93%     -    0s
H    0     0                    -175752.2417 -176833.11  0.61%     -    0s
H    0     0                    -176026.8074 -176833.11  0.46%     -    0s
     0     0 -176792.80    0   32 -176026.81 -176792.80  0.44%     -    0s
     0     0 -176792.19    0   44 -176026.81 -176792.19  0.43%     -    0s
H    0     0                    -176032.5553 -176792.19  0.43%     -    0s
     0     0 -176574.29    0   24 -176032.56 -176574.29  0.31%     -    0s
H    0     0                    -176049.5934 -176544.06  0.28%     -    0s
     0     0 -176544.06    0   25 -176049.59 -176544.06  0.28%     -    0s
     0     0 -176530.54    0   27 -176049.59 -176530.54  0.27%     -    0s
     0     0 -176529.29    0   27 -176049.59 -176529.29  0.27%     -    0s
H    0     0                    -176452.2171 -176528.94  0.04%     -    0s
H    0     0                    -176515.9916 -176528.94  0.01%     -    0s

Cutting planes:
  Gomory: 17
  Implied bound: 1
  MIR: 126
  Flow cover: 4
  RLT: 54
  Relax-and-lift: 6
  BQP: 2

Explored 1 nodes (531 simplex iterations) in 0.06 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -176516 -176452 -176050 ... -164117

Optimal solution found (tolerance 1.00e-04)
Best objective -1.765159916186e+05, best bound -1.765289364788e+05, gap 0.0073%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 196670.88
  Scenario: 15 demand increases, 45 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -176515.99
  [DEBUG]   S×d_nominal = 373186.87
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 373186.87 + -176515.99 = 196670.88
  [DEBUG]   Current θ from Master = 206247.44
  [DEBUG]   ⚠️  Z_SP ≤ θ by 9576.56 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 11355.07
  Lower Bound (LB) = 19242.46
  Gap (UB-LB) = 1689.1785, Absolute Gap = 1689.1785, Relative Gap = 0.080700
  Not converged yet (gap = 1689.18 > ε = 200)

  [DEBUG] Adding NEW scenario 9 to Master Problem...
  [DEBUG] New scenario pattern: 15 increases, 45 decreases
    [DEBUG] Scenario 9 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 9 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 9]
    [DEBUG]   - Total constraints in model: 154283
    [DEBUG]   - Total variables in model: 64660
  [DEBUG] Total scenarios in Master: 10
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 10
================================================================================
[Iteration 10] Solving Master Problem...
  Current scenarios in Master: 10
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 154283 rows, 64660 columns and 437829 nonzeros
Model fingerprint: 0x236a8297
Variable types: 62401 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 70700 rows and 28700 columns
Presolve time: 3.44s
Presolved: 83583 rows, 35960 columns, 511289 nonzeros
Variable types: 33701 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -316148.8914
Found heuristic solution: objective -189441.1784

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.24s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.531e+06
 Factor NZ  : 7.611e+06 (roughly 100 MB of memory)
 Factor Ops : 1.289e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.72266450e+07  1.71085793e+08  1.35e+05 2.09e+01  8.64e+04     5s
   1  -1.29006579e+07  1.57926022e+08  9.30e+04 1.09e+02  5.91e+04     5s
   2  -7.19229728e+06  1.25702570e+08  5.09e+04 1.89e+01  3.32e+04     5s
   3  -1.42016193e+06  9.63269390e+07  5.18e+03 3.06e+00  3.87e+03     5s
   4  -7.38316361e+05  4.58419315e+07  6.65e+02 3.46e-01  6.74e+02     5s
   5  -6.19618406e+05  3.10845238e+07  2.76e+02 2.07e-01  3.48e+02     5s
   6  -4.08667372e+05  2.00543069e+07  7.86e+01 1.23e-01  1.69e+02     6s
   7  -3.25553339e+05  1.58273988e+07  4.82e+01 9.46e-02  1.25e+02     6s
   8  -2.22855247e+05  1.05715379e+07  2.19e+01 6.10e-02  7.73e+01     6s
   9  -1.42050624e+05  6.81951497e+06  9.84e+00 3.76e-02  4.76e+01     6s
  10  -1.11402172e+05  3.61735335e+06  5.44e+00 1.90e-02  2.50e+01     6s
  11  -6.92653092e+04  6.00182408e+05  1.58e+00 2.65e-03  4.42e+00     6s
  12  -2.94307638e+04  3.13401404e+05  6.89e-01 1.46e-03  2.25e+00     6s
  13  -1.04138900e+04  2.21923047e+05  4.75e-01 1.65e-03  1.52e+00     6s
  14   5.57894140e+03  1.61167330e+05  3.36e-01 1.66e-03  1.02e+00     6s
  15   1.38772150e+04  1.41282591e+05  2.70e-01 1.67e-03  8.33e-01     6s
  16   2.34218864e+04  1.10036466e+05  2.00e-01 1.58e-03  5.67e-01     6s
  17   3.06599920e+04  9.70487370e+04  1.50e-01 2.34e-03  4.34e-01     6s
  18   3.78320082e+04  8.74877693e+04  1.01e-01 1.74e-03  3.25e-01     6s
  19   4.20410215e+04  7.80891491e+04  7.49e-02 1.77e-03  2.36e-01     6s
  20   4.42233194e+04  7.27657089e+04  6.15e-02 1.69e-03  1.87e-01     7s
  21   4.67085848e+04  6.87498590e+04  4.81e-02 1.22e-03  1.44e-01     7s
  22   4.80515100e+04  6.45514300e+04  4.08e-02 1.06e-03  1.08e-01     7s
  23   4.86409167e+04  6.31343064e+04  3.74e-02 9.57e-04  9.48e-02     7s
  24   4.88332990e+04  6.19036637e+04  3.65e-02 1.13e-03  8.55e-02     7s
  25   4.99679156e+04  6.09184666e+04  3.09e-02 9.07e-04  7.17e-02     7s
  26   5.20513328e+04  5.99882474e+04  2.10e-02 8.80e-04  5.19e-02     7s
  27   5.34301345e+04  5.90806311e+04  1.44e-02 8.75e-04  3.70e-02     7s
  28   5.40596143e+04  5.83586164e+04  1.15e-02 6.13e-04  2.81e-02     7s
  29   5.45764415e+04  5.81242060e+04  9.14e-03 5.22e-04  2.32e-02     7s
  30   5.52911811e+04  5.79706675e+04  6.03e-03 4.74e-04  1.75e-02     7s
  31   5.55705182e+04  5.76373763e+04  4.72e-03 3.45e-04  1.35e-02     8s
  32   5.58279439e+04  5.74039464e+04  3.62e-03 2.54e-04  1.03e-02     8s
  33   5.61087652e+04  5.71905576e+04  2.44e-03 1.70e-04  7.07e-03     8s
  34   5.63154513e+04  5.69844721e+04  1.61e-03 8.67e-05  4.37e-03     8s
  35   5.64925352e+04  5.68941595e+04  9.26e-04 5.45e-05  2.63e-03     8s
  36   5.65964936e+04  5.68637849e+04  5.36e-04 4.25e-05  1.75e-03     8s
  37   5.66418540e+04  5.68341708e+04  3.68e-04 3.17e-05  1.26e-03     8s
  38   5.66679198e+04  5.68134503e+04  2.73e-04 2.41e-05  9.51e-04     8s
  39   5.66826816e+04  5.67869004e+04  2.21e-04 1.43e-05  6.81e-04     8s
  40   5.67085546e+04  5.67674509e+04  1.29e-04 7.56e-06  3.85e-04     8s
  41   5.67399711e+04  5.67519246e+04  1.83e-05 1.24e-06  7.80e-05     9s
  42   5.67465085e+04  5.67489115e+04  4.00e-06 1.55e-07  1.57e-05     9s
  43   5.67479724e+04  5.67485628e+04  7.83e-07 4.97e-08  3.85e-06     9s
  44   5.67482802e+04  5.67484382e+04  2.01e-07 1.45e-08  1.03e-06     9s
  45   5.67483356e+04  5.67483921e+04  8.31e-08 2.10e-09  3.69e-07     9s
  46   5.67483842e+04  5.67483845e+04  1.59e-08 2.71e-09  2.08e-09     9s

Barrier solved model in 46 iterations and 9.10 seconds (7.21 work units)
Optimal objective 5.67483842e+04


Root crossover log...

   75333 DPushes remaining with DInf 0.0000000e+00                 9s
   19179 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                12s

    5140 PPushes remaining with PInf 2.8877830e-05                12s
       0 PPushes remaining with PInf 0.0000000e+00                13s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.2087118e+03     13s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   43224    5.6748384e+04   0.000000e+00   3.208712e+03     13s
   43491    5.6748384e+04   0.000000e+00   0.000000e+00     13s
   43491    5.6748384e+04   0.000000e+00   0.000000e+00     13s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 5.674838e+04, 43491 iterations, 8.64 seconds (11.18 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 56748.3843    0  161 -189441.18 56748.3843   130%     -   13s
H    0     0                    -175762.8521 56748.3843   132%     -   13s
H    0     0                    -141887.0388 56748.3843   140%     -   13s
H    0     0                    -141214.3644 56748.3843   140%     -   13s
H    0     0                    -140258.0560 56748.3843   140%     -   14s
H    0     0                    -136500.6116 56748.3843   142%     -   14s
H    0     0                    -136241.7674 56748.3843   142%     -   14s
H    0     0                    -50482.99968 56748.3843   212%     -   14s
H    0     0                     923.8215285 56748.3843  6043%     -   15s
H    0     0                    3703.2301051 56748.3843  1432%     -   15s
H    0     0                    7485.2484398 56748.3843   658%     -   16s
H    0     0                    10460.330464 56748.3843   443%     -   16s
H    0     0                    10695.532079 56748.3843   431%     -   16s
H    0     0                    10961.270061 56748.3843   418%     -   16s
H    0     0                    10998.111466 56748.3843   416%     -   16s
H    0     0                    11250.138201 56748.3843   404%     -   17s
H    0     0                    11374.422221 56748.3843   399%     -   17s
H    0     0                    11425.966386 56748.3843   397%     -   17s
H    0     0                    11731.322148 56748.3843   384%     -   17s
H    0     0                    11930.255528 50892.6030   327%     -   71s
H    0     0                    12050.107153 50892.6030   322%     -   71s
H    0     0                    12665.364992 50892.6030   302%     -   71s
H    0     0                    13023.740441 50892.6030   291%     -   71s
H    0     0                    13081.800072 50892.6030   289%     -   71s
H    0     0                    13467.303116 50892.6030   278%     -   71s
H    0     0                    13819.616084 50892.6030   268%     -   71s
H    0     0                    13897.457581 50892.6030   266%     -   71s
     0     0 50598.0346    0  188 13897.4576 50598.0346   264%     -   71s
     0     0 50387.1355    0  283 13897.4576 50387.1355   263%     -   90s
     0     0 50315.7909    0  249 13897.4576 50315.7909   262%     -  100s
     0     0 50315.7909    0  280 13897.4576 50315.7909   262%     -  106s
     0     0 50315.7909    0  283 13897.4576 50315.7909   262%     -  114s
     0     0 50315.7909    0  286 13897.4576 50315.7909   262%     -  116s
     0     0 50315.7909    0  286 13897.4576 50315.7909   262%     -  117s
H    0     0                    14865.751105 46384.3020   212%     -  175s
H    0     0                    14939.178611 46384.3020   210%     -  175s
H    0     0                    15017.863314 46384.3020   209%     -  175s
H    0     0                    15592.412598 46384.3020   197%     -  175s
     0     0 46371.8891    0  336 15592.4126 46371.8891   197%     -  175s
     0     0 45492.1619    0  346 15592.4126 45492.1619   192%     -  207s
     0     0 45195.0956    0  349 15592.4126 45195.0956   190%     -  229s
     0     0 45111.2838    0  325 15592.4126 45111.2838   189%     -  240s
     0     0 45096.9817    0  323 15592.4126 45096.9817   189%     -  246s
     0     0 44930.5669    0  348 15592.4126 44930.5669   188%     -  260s
H    0     0                    15968.562860 44838.1111   181%     -  269s
H    0     0                    16093.857249 44838.1111   179%     -  269s
H    0     0                    16148.035110 44838.1111   178%     -  269s
H    0     0                    16148.143769 44838.1111   178%     -  269s
     0     0 44838.1111    0  324 16148.1438 44838.1111   178%     -  269s
     0     0 44807.5455    0  369 16148.1438 44807.5455   177%     -  276s
     0     0 44793.2866    0  383 16148.1438 44793.2866   177%     -  279s
     0     0 44752.5412    0  385 16148.1438 44752.5412   177%     -  283s
     0     0 44749.6273    0  383 16148.1438 44749.6273   177%     -  285s
     0     0 44745.3397    0  383 16148.1438 44745.3397   177%     -  286s
     0     0 44738.8132    0  387 16148.1438 44738.8132   177%     -  288s
     0     0 44736.8890    0  386 16148.1438 44736.8890   177%     -  288s
     0     0 44736.8459    0  386 16148.1438 44736.8459   177%     -  289s
     0     0 43176.5437    0  404 16148.1438 43176.5437   167%     -  349s
H    0     0                    16163.350314 43175.9304   167%     -  349s
H    0     0                    16465.611521 43175.9304   162%     -  350s
H    0     0                    16500.017294 43175.9304   162%     -  350s
H    0     0                    16885.162959 43175.9304   156%     -  350s
     0     0 42686.6791    0  432 16885.1630 42686.6791   153%     -  375s
     0     0 42375.7057    0  442 16885.1630 42375.7057   151%     -  396s
     0     0 42176.8608    0  440 16885.1630 42176.8608   150%     -  405s
     0     0 42079.1496    0  414 16885.1630 42079.1496   149%     -  414s
     0     0 41971.9859    0  412 16885.1630 41971.9859   149%     -  422s
     0     0 41923.1071    0  417 16885.1630 41923.1071   148%     -  427s
     0     0 41895.2542    0  450 16885.1630 41895.2542   148%     -  431s
     0     0 41880.3327    0  418 16885.1630 41880.3327   148%     -  433s
H    0     0                    17220.565179 41861.0868   143%     -  436s
H    0     0                    17318.508613 41861.0868   142%     -  436s
     0     0 41861.0868    0  448 17318.5086 41861.0868   142%     -  436s
     0     0 41852.5731    0  440 17318.5086 41852.5731   142%     -  438s
     0     0 41821.8714    0  453 17318.5086 41821.8714   141%     -  444s
     0     0 41803.6735    0  456 17318.5086 41803.6735   141%     -  448s
     0     0 41799.9697    0  431 17318.5086 41799.9697   141%     -  449s
     0     0 41798.8262    0  454 17318.5086 41798.8262   141%     -  450s
     0     0 41001.2193    0  431 17318.5086 41001.2193   137%     -  489s
H    0     0                    17391.888887 40825.7612   135%     -  502s
     0     0 40825.7612    0  472 17391.8889 40825.7612   135%     -  502s
     0     0 40741.7144    0  423 17391.8889 40741.7144   134%     -  510s
     0     0 40717.6944    0  432 17391.8889 40717.6944   134%     -  513s
     0     0 40657.7720    0  427 17391.8889 40657.7720   134%     -  519s
     0     0 40643.3319    0  433 17391.8889 40643.3319   134%     -  522s
     0     0 40636.4224    0  437 17391.8889 40636.4224   134%     -  525s
     0     0 40616.9091    0  431 17391.8889 40616.9091   134%     -  529s
     0     0 40609.7096    0  431 17391.8889 40609.7096   133%     -  531s
     0     0 40603.1121    0  425 17391.8889 40603.1121   133%     -  533s
     0     0 40583.2477    0  421 17391.8889 40583.2477   133%     -  537s
     0     0 40574.4732    0  424 17391.8889 40574.4732   133%     -  539s
     0     0 40573.3035    0  426 17391.8889 40573.3035   133%     -  539s
     0     0 40384.1381    0  453 17391.8889 40384.1381   132%     -  551s
     0     0 40341.4611    0  477 17391.8889 40341.4611   132%     -  557s
     0     0 40328.0067    0  436 17391.8889 40328.0067   132%     -  559s
     0     0 40294.4878    0  460 17391.8889 40294.4878   132%     -  563s
H    0     0                    17673.890554 40280.9377   128%     -  566s
     0     0 40280.9377    0  401 17673.8906 40280.9377   128%     -  566s
     0     0 40269.7787    0  410 17673.8906 40269.7787   128%     -  569s
     0     0 40265.7650    0  462 17673.8906 40265.7650   128%     -  571s
     0     0 40262.9605    0  458 17673.8906 40262.9605   128%     -  572s
     0     0 40262.6266    0  458 17673.8906 40262.6266   128%     -  572s
     0     0 40203.7411    0  447 17673.8906 40203.7411   127%     -  583s
H    0     0                    18405.259203 40202.6039   118%     -  585s
     0     0 40162.1863    0  451 18405.2592 40162.1863   118%     -  591s
     0     0 40155.1837    0  458 18405.2592 40155.1837   118%     -  594s
     0     0 40150.3611    0  453 18405.2592 40150.3611   118%     -  596s
     0     0 40145.7043    0  456 18405.2592 40145.7043   118%     -  597s
     0     0 40144.6444    0  450 18405.2592 40144.6444   118%     -  598s
     0     0 40057.9779    0  452 18405.2592 40057.9779   118%     -  612s
     0     0 40033.5348    0  464 18405.2592 40033.5348   118%     -  620s
     0     0 40025.5453    0  428 18405.2592 40025.5453   117%     -  624s
     0     0 40024.6414    0  444 18405.2592 40024.6414   117%     -  626s
     0     0 39982.2569    0  454 18405.2592 39982.2569   117%     -  636s
H    0     0                    18414.573748 39982.0881   117%     -  638s
H    0     0                    18448.399842 39982.0881   117%     -  638s
     0     0 39962.7446    0  471 18448.3998 39962.7446   117%     -  644s
     0     0 39958.1210    0  497 18448.3998 39958.1210   117%     -  647s
     0     0 39955.8887    0  491 18448.3998 39955.8887   117%     -  649s
     0     0 39931.5324    0  474 18448.3998 39931.5324   116%     -  656s
H    0     0                    18575.187434 39930.9306   115%     -  657s
H    0     0                    18646.382357 39930.9306   114%     -  657s
     0     0 39926.6885    0  480 18646.3824 39926.6885   114%     -  660s
     0     0 39924.7663    0  481 18646.3824 39924.7663   114%     -  660s
     0     0 39921.4811    0  471 18646.3824 39921.4811   114%     -  664s
H    0     0                    18973.525983 39921.0618   110%     -  667s
H    0     0                    19127.952315 39921.0618   109%     -  667s
     0     0 39919.4969    0  480 19127.9523 39919.4969   109%     -  672s
     0     0 39876.9768    0  490 19127.9523 39876.9768   108%     -  679s
     0     0 39868.1451    0  468 19127.9523 39868.1451   108%     -  683s
     0     0 39865.7681    0  463 19127.9523 39865.7681   108%     -  685s
     0     0 39865.3294    0  458 19127.9523 39865.3294   108%     -  686s
     0     0 39860.5522    0  461 19127.9523 39860.5522   108%     -  690s
H    0     0                    19151.649210 39858.9816   108%     -  699s
     0     0 39858.9816    0  464 19151.6492 39858.9816   108%     -  699s
     0     0 39854.7458    0  465 19151.6492 39854.7458   108%     -  701s
     0     0 39853.6193    0  462 19151.6492 39853.6193   108%     -  703s
     0     0 39843.1825    0  469 19151.6492 39843.1825   108%     -  707s
     0     0 39843.1448    0  469 19151.6492 39843.1448   108%     -  709s
H    0     0                    19243.425784 39842.9206   107%     -  856s
H    0     2                    19549.104978 39842.9206   104%     -  871s
     0     2 39842.9206    0  469 19549.1050 39842.9206   104%     -  871s
     1     4 39540.1056    1  448 19549.1050 39842.2091   104%  9796  882s
     3     8 39440.3473    2  481 19549.1050 39538.9475   102%  8598  896s
     7    16 38972.1191    3  452 19549.1050 39440.0042   102%  9469  916s
    15    32 38661.1349    4  468 19549.1050 38985.8115  99.4% 10615  935s
    31    48 37808.4862    5  435 19549.1050 38723.5560  98.1% 15304 1000s
    47    80 37444.3396    6  430 19549.1050 38723.5560  98.1% 14996 1042s
H   72    80                    19557.189944 38723.5560  98.0% 13038 1042s
    79   144 37309.6712    7  414 19557.1899 38723.5560  98.0% 12571 1162s
   143   285 37175.6505    9  417 19557.1899 38723.5560  98.0%  9796 1206s
   284   377 37023.2501   11  404 19557.1899 38723.5560  98.0%  6975 1235s
   376   452 36915.5653   11  403 19557.1899 38723.5560  98.0%  6247 1258s
   451   522 36936.8402   13  407 19557.1899 38723.5560  98.0%  6056 1282s
   521   552 35324.1064   22  345 19557.1899 38723.5560  98.0%  5789 1305s
   551   585 35719.0453   12  391 19557.1899 38723.5560  98.0%  5742 1326s
H  562   585                    19657.884507 38723.5560  97.0%  5709 1326s
   584   616 36590.0710   13  360 19657.8845 38723.5560  97.0%  5775 1346s
   615   655 36623.1084   14  367 19657.8845 38723.5560  97.0%  5760 1368s
   654   703 36123.5354   13  328 19657.8845 38723.5560  97.0%  5652 1391s
H  656   703                    19721.241182 38723.5560  96.4%  5647 1391s
H  679   703                    19773.233613 38723.5560  95.8%  5541 1391s
   702   797 34810.9085   13  363 19773.2336 38723.5560  95.8%  5502 1416s
   796   886 35950.6105   14  340 19773.2336 38723.5560  95.8%  5148 1439s
   885   988 31916.8989   38  311 19773.2336 38723.5560  95.8%  4894 1466s
   987  1094 35555.1066   15  387 19773.2336 38723.5560  95.8%  4636 1488s
  1099  1178 35267.8408   16  346 19773.2336 38723.5560  95.8%  4406 1510s
  1187  1287 34899.7833   17  299 19773.2336 38723.5560  95.8%  4297 1535s
  1298  1402 34624.5085   18  354 19773.2336 38723.5560  95.8%  4155 1560s
  1413  1531 33882.8089   16  391 19773.2336 38723.5560  95.8%  4032 1581s
  1553  1631 33723.4549   19  316 19773.2336 38723.5560  95.8%  3863 1608s
  1707  1675 34064.6846   19  287 19773.2336 38723.5560  95.8%  3681 1641s
  1810  1730 31584.0904   20  234 19773.2336 38723.5560  95.8%  3614 1676s
  1911  1795 33645.9728   20  305 19773.2336 38723.5560  95.8%  3559 1713s
  2032  1877 32880.5745   20  327 19773.2336 38723.5560  95.8%  3503 1751s
  2156  1957 31503.5653   22  223 19773.2336 38723.5560  95.8%  3444 1790s
  2311  1971 30230.4051   24  203 19773.2336 38723.5560  95.8%  3361 1822s
H 2312  1971                    19778.906427 38723.5560  95.8%  3360 1822s
  2389  2032 26630.4515   23  193 19778.9064 38723.5560  95.8%  3341 1863s
  2519  2068 28348.8465   25  186 19778.9064 38723.5560  95.8%  3319 1905s
  2615  2115 29207.1465   26  173 19778.9064 38660.7570  95.5%  3346 1948s
  2690  2187 28822.1605   26  173 19778.9064 38660.7570  95.5%  3399 1987s
  2790  2273 27977.6835   26  201 19778.9064 38660.7570  95.5%  3434 2027s
  2904  2391 27945.3261   30  190 19778.9064 38660.7570  95.5%  3460 2072s
  3042  2514 27510.8279   33  205 19778.9064 38341.9451  93.9%  3471 2120s
  3197  2687 27004.5723   37  238 19778.9064 38341.9451  93.9%  3466 2167s
  3408  2730 26634.3735   41  191 19778.9064 38341.9451  93.9%  3415 2200s
H 3459  2730                    19786.221174 38341.9451  93.8%  3412 2200s
H 3465  2730                    19803.881444 38341.9451  93.6%  3414 2233s
H 3465  2730                    19891.717254 38341.9451  92.8%  3414 2354s
  3466  2731 29146.3900   24  469 19891.7173 38341.9451  92.8%  3413 2620s
  3468  2732 26497.5932   28  125 19891.7173 38341.9451  92.8%  3411 2631s
  3469  2733 33021.3988   35  392 19891.7173 38341.9451  92.8%  3410 2722s
  3470  2734 31839.5076   46  411 19891.7173 38341.9451  92.8%  3409 2791s
  3471  2734 21512.9876   69  481 19891.7173 38341.9451  92.8%  3408 2846s
  3472  2735 32816.3308   30  471 19891.7173 38341.9451  92.8%  3407 2893s
  3473  2736 21316.5176   65  441 19891.7173 38341.9451  92.8%  3406 2946s
  3474  2736 36384.1823   17  407 19891.7173 38341.9451  92.8%  3405 2967s
  3475  2737 30279.0212   28  444 19891.7173 38341.9451  92.8%  3404 2990s
  3476  2738 29538.1668   24  422 19891.7173 38341.9451  92.8%  3403 3002s
  3477  2738 34221.7331   22  405 19891.7173 38341.9451  92.8%  3402 3011s
  3478  2739 34932.4779    7  471 19891.7173 38341.9451  92.8%  3402 3017s
  3479  2740 33688.3596   28  455 19891.7173 38341.9451  92.8%  3401 3026s
  3481  2741 29594.6509   66  463 19891.7173 38341.9451  92.8%  3399 3032s
  3483  2742 28430.8805   53  457 19891.7173 38341.9451  92.8%  3397 3039s
  3484  2743 29097.6016   44  465 19891.7173 38341.9451  92.8%  3396 3049s
  3485  2744 28455.9364   55  467 19891.7173 38341.9451  92.8%  3395 3054s
  3486  2744 31071.0436   63  429 19891.7173 38341.9451  92.8%  3394 3059s
  3487  2745 30044.6293   22  476 19891.7173 38341.9451  92.8%  3393 3066s
  3488  2746 33225.4763   19  467 19891.7173 38341.9451  92.8%  3392 3070s
  3489  2746 36339.7299    9  500 19891.7173 38341.9451  92.8%  3391 3081s
  3490  2747 32204.6146   36  443 19891.7173 38341.9451  92.8%  3390 3085s
  3493  2749 20666.9105   65  455 19891.7173 38341.9451  92.8%  3387 3094s
  3494  2750 30544.4560   37  458 19891.7173 38341.9451  92.8%  3386 3103s
  3495  2750 26421.0015   26  449 19891.7173 38341.9451  92.8%  3385 3106s
  3497  2752 36583.7145    8  456 19891.7173 38341.9451  92.8%  3383 3117s
  3499  2753 36965.2331   17  463 19891.7173 38341.9451  92.8%  3381 3122s
  3500  2754 32670.4820   33  458 19891.7173 38341.9451  92.8%  3380 3130s
  3502  2755 36247.1662   19  495 19891.7173 38341.9451  92.8%  3378 3140s
  3504  2756 32291.8069   46  457 19891.7173 38341.9451  92.8%  3376 3153s
  3505  2757 34541.7106   18  459 19891.7173 38341.9451  92.8%  3375 3157s
  3506  2758 22529.4130   73  506 19891.7173 38341.9451  92.8%  3374 3166s
  3507  2758 28189.7854   57  475 19891.7173 38341.9451  92.8%  3373 3170s
  3508  2759 34784.8032    9  476 19891.7173 38341.9451  92.8%  3372 3177s
  3509  2760 33896.1260    9  476 19891.7173 38341.9451  92.8%  3371 3212s
  3510  2760 30714.5249   28  476 19891.7173 38341.9451  92.8%  3371 3289s
  3511  2764 38341.9451   13  473 19891.7173 38341.9451  92.8%  3462 3323s
  3513  2767 38341.9451   14  469 19891.7173 38341.9451  92.8%  3465 3372s
  3517  2773 38341.9451   15  448 19891.7173 38341.9451  92.8%  3470 3426s
  3524  2786 38341.9451   16  447 19891.7173 38341.9451  92.8%  3490 3478s
  3539  2796 36536.4885   17  433 19891.7173 38341.9451  92.8%  3569 3544s
  3554  2822 35068.0608   18  406 19891.7173 38341.9451  92.8%  3650 3600s
H 3556  2682                    19916.062863 38341.9451  92.5%  3654 3600s
H 3558  2549                    19929.771567 38341.9451  92.4%  3662 3600s
H 3570  2420                    19983.967073 38341.9451  91.9%  3710 3600s
H 3571  2301                    20010.076488 38341.9451  91.6%  3711 3600s

Cutting planes:
  Learned: 1
  Gomory: 4
  Implied bound: 10
  Projected implied bound: 150
  MIR: 1069
  Mixing: 1
  Flow cover: 1505
  RLT: 25
  Relax-and-lift: 223

Explored 3585 nodes (13918802 simplex iterations) in 3600.12 seconds (5394.95 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 20010.1 19984 19929.8 ... 19721.2

Time limit reached
Best objective 2.001007648792e+04, best bound 3.834194507141e+04, gap 91.6132%
  WARNING: Time limit reached. Using best solution found (gap: 91.61%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3600.14s
  Master Objective (UB) = 20010.08, θ = 197881.63
  Upper Bound (UB) = 20010.08

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 197881.63
  [DEBUG]   ✓ Scenario 0: θ = 197881.63 ≤ Q = 197881.63 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 197881.63 ≤ Q = 197881.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 197881.63 ≤ Q = 197881.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 197881.63 ≤ Q = 197881.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 197881.63 ≤ Q = 197881.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 197881.63 ≤ Q = 197881.63 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 197881.63 ≤ Q = 197881.63 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 197881.63 ≤ Q = 197881.63 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 197881.63 ≤ Q = 197881.63 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 197881.63 ≤ Q = 197881.63 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 10] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x1309abbd
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xecf65443
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.300839e+13
Presolve removed 2610 rows and 1899 columns
Presolve time: 0.01s
Presolved: 483 rows, 490 columns, 1367 nonzeros
Found heuristic solution: objective 5689025.0745
Variable types: 332 continuous, 158 integer (158 binary)
Found heuristic solution: objective 5688122.1689

Root relaxation: objective -1.890131e+05, 236 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -189013.10    0  124 5688122.17 -189013.10   103%     -    0s
H    0     0                    -162594.6484 -189013.10  16.2%     -    0s
H    0     0                    -162905.1301 -188745.40  15.9%     -    0s
     0     0 -170366.94    0   75 -162905.13 -170366.94  4.58%     -    0s
H    0     0                    -168759.0847 -170299.28  0.91%     -    0s
     0     0 -170042.25    0   75 -168759.08 -170042.25  0.76%     -    0s
     0     0 -170039.69    0   75 -168759.08 -170039.69  0.76%     -    0s
     0     0 -169449.43    0   37 -168759.08 -169449.43  0.41%     -    0s
H    0     0                    -169033.3112 -169426.94  0.23%     -    0s
     0     0 -169376.07    0   33 -169033.31 -169376.07  0.20%     -    0s
     0     0 -169358.60    0   24 -169033.31 -169358.60  0.19%     -    0s
H    0     0                    -169047.0939 -169336.06  0.17%     -    0s
     0     0 -169330.70    0   24 -169047.09 -169330.70  0.17%     -    0s
     0     0 -169275.28    0   25 -169047.09 -169275.28  0.13%     -    0s
     0     0 -169269.40    0   25 -169047.09 -169269.40  0.13%     -    0s
H    0     0                    -169091.0376 -169269.40  0.11%     -    0s
     0     0 -169269.40    0   44 -169091.04 -169269.40  0.11%     -    0s
     0     0 -169269.40    0   33 -169091.04 -169269.40  0.11%     -    0s
     0     0 -169269.13    0   28 -169091.04 -169269.13  0.11%     -    0s
     0     0 -169232.93    0   32 -169091.04 -169232.93  0.08%     -    0s
     0     0 -169228.59    0   32 -169091.04 -169228.59  0.08%     -    0s
     0     0 -169213.87    0   31 -169091.04 -169213.87  0.07%     -    0s
H    0     0                    -169098.3025 -169211.84  0.07%     -    0s
     0     0 -169211.84    0   31 -169098.30 -169211.84  0.07%     -    0s
     0     0 -169202.09    0   31 -169098.30 -169202.09  0.06%     -    0s
H    0     0                    -169109.1194 -169197.61  0.05%     -    0s
     0     0 -169197.61    0   31 -169109.12 -169197.61  0.05%     -    0s
     0     0 -169195.88    0   30 -169109.12 -169195.88  0.05%     -    0s
     0     0 -169192.52    0   30 -169109.12 -169192.52  0.05%     -    0s
     0     0 -169180.32    0   30 -169109.12 -169180.32  0.04%     -    0s
     0     0 -169180.32    0   30 -169109.12 -169180.32  0.04%     -    0s
     0     0 -169173.50    0   30 -169109.12 -169173.50  0.04%     -    0s
H    0     0                    -169153.5771 -169173.50  0.01%     -    0s
     0     0 -169173.50    0   25 -169153.58 -169173.50  0.01%     -    0s
     0     0 -169173.50    0   27 -169153.58 -169173.50  0.01%     -    0s
     0     0 -169173.50    0   24 -169153.58 -169173.50  0.01%     -    0s
     0     0 -169173.50    0   24 -169153.58 -169173.50  0.01%     -    0s
     0     0 -169173.50    0   24 -169153.58 -169173.50  0.01%     -    0s
     0     0 -169173.50    0   24 -169153.58 -169173.50  0.01%     -    0s

Cutting planes:
  Gomory: 1
  Implied bound: 1
  MIR: 43
  Flow cover: 6

Explored 1 nodes (921 simplex iterations) in 0.41 seconds (0.07 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -169154 -169109 -169098 ... 5.68812e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.691535770542e+05, best bound -1.691670026144e+05, gap 0.0079%
  Subproblem solved in 0.44s
  Worst-case operational profit (Z_SP) = 182616.66
  Scenario: 21 demand increases, 39 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -169153.58
  [DEBUG]   S×d_nominal = 351770.23
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 351770.23 + -169153.58 = 182616.66
  [DEBUG]   Current θ from Master = 197881.63
  [DEBUG]   ⚠️  Z_SP ≤ θ by 15264.98 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 4745.10
  Lower Bound (LB) = 19242.46
  Gap (UB-LB) = 767.6192, Absolute Gap = 767.6192, Relative Gap = 0.038362
  Not converged yet (gap = 767.62 > ε = 200)

  [DEBUG] Adding NEW scenario 10 to Master Problem...
  [DEBUG] New scenario pattern: 21 increases, 39 decreases
    [DEBUG] Scenario 10 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 10 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 10]
    [DEBUG]   - Total constraints in model: 169573
    [DEBUG]   - Total variables in model: 70900
  [DEBUG] Total scenarios in Master: 11
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 11
================================================================================
[Iteration 11] Solving Master Problem...
  Current scenarios in Master: 11
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 169573 rows, 70900 columns and 481060 nonzeros
Model fingerprint: 0x2de4a668
Variable types: 68641 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 77770 rows and 31570 columns
Presolve time: 2.64s
Presolved: 91803 rows, 39330 columns, 558599 nonzeros
Variable types: 37071 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -321971.3992
Found heuristic solution: objective -189441.1784

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.25s

Barrier statistics:
 Dense cols : 620
 AA' NZ     : 3.165e+06
 Factor NZ  : 7.259e+06 (roughly 110 MB of memory)
 Factor Ops : 1.301e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.79936506e+07  1.85994020e+08  1.41e+05 1.95e+01  8.97e+04     4s
   1  -1.36378388e+07  1.73361623e+08  9.81e+04 1.09e+02  6.19e+04     4s
   2  -8.00841538e+06  1.43611990e+08  5.66e+04 3.92e+01  3.68e+04     4s
   3  -1.59619009e+06  1.06903087e+08  6.56e+03 1.54e+00  4.79e+03     4s
   4  -7.70747170e+05  5.82771247e+07  1.04e+03 3.89e-01  9.53e+02     5s
   5  -6.26231182e+05  3.95342096e+07  3.74e+02 2.39e-01  4.39e+02     5s
   6  -4.44973110e+05  2.96202660e+07  6.23e+01 1.69e-01  2.10e+02     5s
   7  -3.92956369e+05  1.97486819e+07  3.50e+01 1.08e-01  1.34e+02     5s
   8  -2.65280421e+05  1.48681281e+07  9.57e+00 8.11e-02  9.31e+01     5s
   9  -1.59639592e+05  8.30339791e+06  3.10e+00 4.41e-02  5.09e+01     5s
  10  -1.05299243e+05  2.35227552e+06  1.79e+00 1.24e-02  1.47e+01     5s
  11  -6.15767013e+04  1.31134255e+06  7.03e-01 7.01e-03  8.18e+00     5s
  12  -2.27773728e+04  6.51745276e+05  2.93e-01 3.32e-03  4.01e+00     5s
  13  -1.02353468e+04  3.55905702e+05  2.06e-01 1.62e-03  2.18e+00     5s
  14   5.87729590e+03  2.11197016e+05  1.26e-01 1.39e-03  1.22e+00     5s
  15   1.56151811e+04  1.85549738e+05  9.47e-02 1.24e-03  1.01e+00     5s
  16   2.18739923e+04  1.40539728e+05  7.71e-02 1.41e-03  7.05e-01     5s
  17   2.63314725e+04  1.23027329e+05  6.53e-02 1.06e-03  5.74e-01     5s
  18   3.39571027e+04  1.10987897e+05  4.65e-02 1.22e-03  4.57e-01     5s
  19   3.87599430e+04  9.04052647e+04  3.49e-02 7.73e-04  3.07e-01     6s
  20   4.19824322e+04  8.39231767e+04  2.79e-02 6.85e-04  2.49e-01     6s
  21   4.60842668e+04  7.75872522e+04  1.97e-02 5.20e-04  1.87e-01     6s
  22   4.65884069e+04  7.64656971e+04  1.86e-02 4.94e-04  1.77e-01     6s
  23   4.84453145e+04  6.88359781e+04  1.48e-02 3.14e-04  1.21e-01     6s
  24   4.93140189e+04  6.74645998e+04  1.31e-02 2.82e-04  1.08e-01     6s
  25   5.09028073e+04  6.50787301e+04  1.02e-02 2.31e-04  8.42e-02     6s
  26   5.19507857e+04  6.41661775e+04  8.30e-03 2.07e-04  7.25e-02     6s
  27   5.30342765e+04  6.17151904e+04  6.37e-03 3.27e-04  5.15e-02     6s
  28   5.40373330e+04  6.05577429e+04  4.73e-03 2.43e-04  3.87e-02     6s
  29   5.44806738e+04  5.96374683e+04  3.97e-03 1.83e-04  3.06e-02     6s
  30   5.47366421e+04  5.92817327e+04  3.56e-03 1.59e-04  2.70e-02     7s
  31   5.49707314e+04  5.87993239e+04  3.20e-03 1.20e-04  2.27e-02     7s
  32   5.52991575e+04  5.86770102e+04  2.68e-03 1.27e-04  2.01e-02     7s
  33   5.60566277e+04  5.82023240e+04  1.50e-03 8.83e-05  1.27e-02     7s
  34   5.64391072e+04  5.77358787e+04  9.10e-04 5.21e-05  7.70e-03     7s
  35   5.64965364e+04  5.76451211e+04  8.30e-04 4.53e-05  6.82e-03     7s
  36   5.65976690e+04  5.74970723e+04  6.89e-04 3.27e-05  5.34e-03     7s
  37   5.67111981e+04  5.73486520e+04  5.25e-04 2.03e-05  3.79e-03     7s
  38   5.68663782e+04  5.72287270e+04  3.14e-04 1.03e-05  2.15e-03     7s
  39   5.69698579e+04  5.71621753e+04  1.74e-04 4.80e-06  1.14e-03     7s
  40   5.70095621e+04  5.71517237e+04  1.15e-04 3.99e-06  8.44e-04     7s
  41   5.70120061e+04  5.71442208e+04  1.11e-04 3.44e-06  7.85e-04     7s
  42   5.70336581e+04  5.71311197e+04  8.18e-05 2.45e-06  5.79e-04     8s
  43   5.70470757e+04  5.71242301e+04  6.38e-05 1.93e-06  4.58e-04     8s
  44   5.70668402e+04  5.71064564e+04  3.93e-05 1.62e-06  2.35e-04     8s
  45   5.70790050e+04  5.71022072e+04  2.32e-05 8.12e-07  1.38e-04     8s
  46   5.70895938e+04  5.70991586e+04  9.73e-06 2.65e-07  5.68e-05     8s
  47   5.70964023e+04  5.70980896e+04  1.39e-06 1.72e-07  1.00e-05     8s
  48   5.70974221e+04  5.70977530e+04  1.82e-07 4.63e-08  1.96e-06     8s
  49   5.70974547e+04  5.70976189e+04  1.49e-07 4.07e-09  9.76e-07     8s
  50   5.70974627e+04  5.70976175e+04  1.40e-07 3.67e-09  9.20e-07     8s
  51   5.70975104e+04  5.70976155e+04  1.56e-07 3.23e-09  6.24e-07     9s
  52   5.70975576e+04  5.70976092e+04  1.00e-07 1.48e-09  3.07e-07     9s
  53   5.70975995e+04  5.70976051e+04  8.22e-08 4.15e-09  3.34e-08     9s
  54   5.70975996e+04  5.70976051e+04  4.46e-06 1.26e-08  3.24e-08     9s
  55   5.70976000e+04  5.70976051e+04  1.32e-05 4.00e-08  2.34e-08     9s
  56   5.70976006e+04  5.70976051e+04  1.14e-05 3.70e-08  1.97e-08     9s
  57   5.70976012e+04  5.70976051e+04  1.24e-05 7.23e-08  1.74e-08     9s
  58   5.70976013e+04  5.70976051e+04  1.19e-05 7.19e-08  1.73e-08     9s
  59   5.70976014e+04  5.70976051e+04  1.12e-05 7.08e-08  1.66e-08     9s
  60   5.70976025e+04  5.70976051e+04  8.82e-06 4.38e-08  1.19e-08    10s
  61   5.70976028e+04  5.70976050e+04  8.09e-06 3.07e-08  1.05e-08    10s
  62   5.70976036e+04  5.70976050e+04  5.59e-06 3.09e-08  6.88e-09    10s
  63   5.70976036e+04  5.70976050e+04  5.50e-06 3.13e-08  6.88e-09    10s
  64   5.70976036e+04  5.70976051e+04  5.42e-06 3.07e-08  6.93e-09    10s
  65   5.70976047e+04  5.70976050e+04  1.68e-06 4.14e-08  1.68e-09    10s

Barrier solved model in 65 iterations and 9.93 seconds (10.12 work units)
Optimal objective 5.70976047e+04


Root crossover log...

   82409 DPushes remaining with DInf 0.0000000e+00                10s
   40717 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                13s

    9948 PPushes remaining with PInf 3.0465137e-05                13s
       0 PPushes remaining with PInf 0.0000000e+00                14s

  Push phase complete: Pinf 0.0000000e+00, Dinf 5.5763337e+04     14s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   50545    5.7097605e+04   0.000000e+00   5.576334e+04     14s
   51400    5.7097605e+04   0.000000e+00   0.000000e+00     14s
   51400    5.7097605e+04   0.000000e+00   0.000000e+00     14s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 5.709761e+04, 51400 iterations, 11.15 seconds (14.34 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 57097.6050    0  166 -189441.18 57097.6050   130%     -   15s
H    0     0                    -183773.9619 57097.6050   131%     -   15s
H    0     0                    -160041.0474 57097.6050   136%     -   15s
H    0     0                    -159734.6454 57097.6050   136%     -   15s
H    0     0                    -121062.6016 57097.6050   147%     -   15s
H    0     0                    -118173.8234 57097.6050   148%     -   15s
H    0     0                    -118155.1484 57097.6050   148%     -   15s
H    0     0                    -69006.36423 57097.6050   183%     -   15s
H    0     0                     371.6913954 57097.6050      -     -   16s
H    0     0                    1469.3269884 57097.6050  3786%     -   16s
H    0     0                    1931.2152866 57097.6050  2857%     -   17s
H    0     0                    5712.5606277 57097.6050   900%     -   17s
H    0     0                    7567.6067803 57097.6050   655%     -   17s
H    0     0                    8274.5735859 57097.6050   590%     -   17s
H    0     0                    8281.1909403 57097.6050   589%     -   17s
H    0     0                    8320.2583238 57097.6050   586%     -   17s
H    0     0                    8501.1635061 57097.6050   572%     -   17s
H    0     0                    10034.425197 57097.6050   469%     -   19s
H    0     0                    11150.805456 57097.6050   412%     -   19s
H    0     0                    11153.026907 57097.6050   412%     -   19s
H    0     0                    12183.616624 50878.5437   318%     -   72s
H    0     0                    15583.813832 50878.5437   226%     -   72s
H    0     0                    15645.038728 50878.5437   225%     -   72s
     0     0 50878.5437    0  271 15645.0387 50878.5437   225%     -   72s
H    0     0                    17603.348037 50878.3549   189%     -   74s
     0     0 50204.9206    0  271 17603.3480 50204.9206   185%     -  102s
     0     0 50084.7731    0  279 17603.3480 50084.7731   185%     -  106s
     0     0 50033.0245    0  313 17603.3480 50033.0245   184%     -  115s
     0     0 50033.0245    0  280 17603.3480 50033.0245   184%     -  122s
     0     0 50033.0245    0  312 17603.3480 50033.0245   184%     -  127s
     0     0 50029.0527    0  289 17603.3480 50029.0527   184%     -  130s
     0     0 50028.5947    0  289 17603.3480 50028.5947   184%     -  131s
     0     0 46882.3513    0  322 17603.3480 46882.3513   166%     -  185s
H    0     0                    17617.657273 46882.2304   166%     -  186s
H    0     0                    17665.713479 46882.2304   165%     -  186s
H    0     0                    17681.278676 46882.2304   165%     -  186s
     0     0 46426.0473    0  331 17681.2787 46426.0473   163%     -  226s
     0     0 46247.5737    0  343 17681.2787 46247.5737   162%     -  248s
     0     0 46187.1462    0  371 17681.2787 46187.1462   161%     -  263s
     0     0 45880.7901    0  364 17681.2787 45880.7901   159%     -  287s
     0     0 45821.8368    0  355 17681.2787 45821.8368   159%     -  299s
     0     0 45765.2484    0  332 17681.2787 45765.2484   159%     -  309s
     0     0 45750.6938    0  324 17681.2787 45750.6938   159%     -  315s
     0     0 45749.5807    0  324 17681.2787 45749.5807   159%     -  317s
H    0     0                    17889.934774 43614.3507   144%     -  393s
H    0     0                    17989.580914 43614.3507   142%     -  393s
     0     0 43614.3507    0  396 17989.5809 43614.3507   142%     -  393s
H    0     0                    18627.977556 43164.8754   132%     -  424s
H    0     0                    18699.084617 43164.8754   131%     -  424s
     0     0 43164.8754    0  439 18699.0846 43164.8754   131%     -  424s
H    0     0                    18748.025604 43028.6298   130%     -  439s
H    0     0                    18852.681855 43028.6298   128%     -  439s
     0     0 43028.6298    0  426 18852.6819 43028.6298   128%     -  439s
     0     0 42967.0946    0  424 18852.6819 42967.0946   128%     -  451s
     0     0 42864.6435    0  419 18852.6819 42864.6435   127%     -  466s
     0     0 42801.3337    0  434 18852.6819 42801.3337   127%     -  482s
     0     0 42697.8583    0  442 18852.6819 42697.8583   126%     -  493s
     0     0 42641.1324    0  435 18852.6819 42641.1324   126%     -  504s
     0     0 42604.6946    0  451 18852.6819 42604.6946   126%     -  516s
     0     0 42543.5178    0  442 18852.6819 42543.5178   126%     -  529s
     0     0 42522.1280    0  444 18852.6819 42522.1280   126%     -  535s
     0     0 42505.0463    0  469 18852.6819 42505.0463   125%     -  540s
     0     0 42501.9237    0  441 18852.6819 42501.9237   125%     -  542s
     0     0 42499.9465    0  443 18852.6819 42499.9465   125%     -  543s
     0     0 42490.7671    0  450 18852.6819 42490.7671   125%     -  546s
     0     0 42482.4080    0  442 18852.6819 42482.4080   125%     -  548s
     0     0 42479.4973    0  439 18852.6819 42479.4973   125%     -  549s
     0     0 42473.7609    0  446 18852.6819 42473.7609   125%     -  551s
     0     0 42471.8901    0  438 18852.6819 42471.8901   125%     -  552s
     0     0 42469.9025    0  438 18852.6819 42469.9025   125%     -  553s
     0     0 42469.5413    0  439 18852.6819 42469.5413   125%     -  554s
     0     0 41676.4104    0  441 18852.6819 41676.4104   121%     -  598s
     0     0 41375.0474    0  394 18852.6819 41375.0474   119%     -  617s
     0     0 41105.4889    0  453 18852.6819 41105.4889   118%     -  633s
     0     0 41047.7777    0  461 18852.6819 41047.7777   118%     -  641s
     0     0 41026.1390    0  463 18852.6819 41026.1390   118%     -  646s
     0     0 41009.7052    0  475 18852.6819 41009.7052   118%     -  650s
     0     0 40998.5961    0  480 18852.6819 40998.5961   117%     -  653s
     0     0 40986.8999    0  477 18852.6819 40986.8999   117%     -  655s
     0     0 40978.5643    0  488 18852.6819 40978.5643   117%     -  658s
     0     0 40973.0443    0  479 18852.6819 40973.0443   117%     -  660s
     0     0 40971.8811    0  487 18852.6819 40971.8811   117%     -  662s
     0     0 40763.3280    0  420 18852.6819 40763.3280   116%     -  676s
     0     0 40642.8316    0  461 18852.6819 40642.8316   116%     -  688s
     0     0 40595.1776    0  478 18852.6819 40595.1776   115%     -  695s
     0     0 40557.6477    0  476 18852.6819 40557.6477   115%     -  701s
     0     0 40536.5905    0  427 18852.6819 40536.5905   115%     -  704s
     0     0 40526.9707    0  431 18852.6819 40526.9707   115%     -  707s
     0     0 40523.5323    0  427 18852.6819 40523.5323   115%     -  709s
     0     0 40519.3208    0  464 18852.6819 40519.3208   115%     -  711s
     0     0 40512.8872    0  421 18852.6819 40512.8872   115%     -  713s
     0     0 40509.9173    0  422 18852.6819 40509.9173   115%     -  715s
     0     0 40509.5664    0  422 18852.6819 40509.5664   115%     -  715s
     0     0 40413.6623    0  396 18852.6819 40413.6623   114%     -  726s
     0     0 40357.4661    0  460 18852.6819 40357.4661   114%     -  733s
     0     0 40333.1474    0  466 18852.6819 40333.1474   114%     -  739s
     0     0 40327.0251    0  477 18852.6819 40327.0251   114%     -  741s
     0     0 40320.7935    0  469 18852.6819 40320.7935   114%     -  744s
     0     0 40319.1699    0  469 18852.6819 40319.1699   114%     -  746s
     0     0 40238.2437    0  408 18852.6819 40238.2437   113%     -  756s
     0     0 40225.2972    0  455 18852.6819 40225.2972   113%     -  763s
     0     0 40215.1988    0  416 18852.6819 40215.1988   113%     -  766s
     0     0 40213.7491    0  412 18852.6819 40213.7491   113%     -  768s
     0     0 40163.4842    0  460 18852.6819 40163.4842   113%     -  777s
     0     0 40139.9998    0  463 18852.6819 40139.9998   113%     -  784s
     0     0 40128.4742    0  461 18852.6819 40128.4742   113%     -  787s
     0     0 40123.2637    0  468 18852.6819 40123.2637   113%     -  790s
     0     0 40116.3299    0  458 18852.6819 40116.3299   113%     -  792s
     0     0 40114.3704    0  459 18852.6819 40114.3704   113%     -  793s
     0     0 40079.5516    0  470 18852.6819 40079.5516   113%     -  801s
H    0     0                    18854.015659 40079.0805   113%     -  802s
     0     0 40066.0410    0  467 18854.0157 40066.0410   113%     -  808s
     0     0 40064.2256    0  457 18854.0157 40064.2256   112%     -  810s
     0     0 40033.2432    0  432 18854.0157 40033.2432   112%     -  817s
     0     0 40026.9187    0  423 18854.0157 40026.9187   112%     -  820s
     0     0 40024.9038    0  425 18854.0157 40024.9038   112%     -  822s
     0     0 40015.0986    0  425 18854.0157 40015.0986   112%     -  826s
     0     0 40013.1611    0  428 18854.0157 40013.1611   112%     -  828s
     0     0 40008.3568    0  423 18854.0157 40008.3568   112%     -  833s
     0     0 40004.9887    0  428 18854.0157 40004.9887   112%     -  835s
     0     0 40001.8174    0  471 18854.0157 40001.8174   112%     -  837s
     0     0 40000.8400    0  472 18854.0157 40000.8400   112%     -  839s
     0     0 39974.7532    0  422 18854.0157 39974.7532   112%     -  845s
     0     0 39970.0877    0  467 18854.0157 39970.0877   112%     -  848s
     0     0 39969.5001    0  466 18854.0157 39969.5001   112%     -  848s
     0     0 39959.7956    0  418 18854.0157 39959.7956   112%     -  853s
     0     0 39956.6712    0  466 18854.0157 39956.6712   112%     -  855s
     0     0 39949.9879    0  458 18854.0157 39949.9879   112%     -  856s
     0     0 39949.5568    0  459 18854.0157 39949.5568   112%     -  856s
     0     0 39945.8084    0  414 18854.0157 39945.8084   112%     -  859s
     0     0 39944.6766    0  417 18854.0157 39944.6766   112%     -  861s
     0     0 39943.0064    0  413 18854.0157 39943.0064   112%     -  863s
     0     0 39941.5600    0  413 18854.0157 39941.5600   112%     -  865s
     0     2 39941.5412    0  413 18854.0157 39941.5412   112%     - 1028s
     1     3 39228.2293    1  435 18854.0157 39941.5412   112% 18118 1049s
     2     4 39794.0059    1  409 18854.0157 39794.0059   111% 12210 1060s
     3     7 38963.6459    2  446 18854.0157 39793.6019   111%  9068 1076s
     6    13 38189.7006    3  422 18854.0157 39793.6019   111%  9729 1132s
    12    26 37914.9888    4  488 18854.0157 39237.0790   108% 15115 1157s
    25    39 37374.1738    5  454 18854.0157 38843.0873   106% 21165 1240s
    38    70 37135.6329    6  471 18854.0157 38843.0873   106% 23616 1405s
    69   209 36375.2882    5  421 18854.0157 38488.2722   104% 23205 1459s
   208   252 36816.5942   12  411 18854.0157 38430.9718   104% 11827 1488s
H  219   252                    19156.542668 38430.9718   101% 11428 1488s
   251   313 36244.5014    8  412 19156.5427 38430.9718   101% 10801 1516s
   312   361 36143.9674   10  400 19156.5427 38430.9718   101%  9812 1543s
H  316   361                    19188.461750 38430.9718   100%  9762 1543s
   360   424 36115.0651   11  386 19188.4618 38430.9718   100%  9245 1574s
   423   478 36640.5939   13  414 19188.4618 38430.9718   100%  8714 1603s
   477   541 35967.1228   15  382 19188.4618 38430.9718   100%  8341 1634s
   540   571 35828.7938   17  381 19188.4618 38430.9718   100%  7958 1656s
   570   603 35680.0904   18  371 19188.4618 38430.9718   100%  7877 1686s
   602   637 35402.4294   19  357 19188.4618 38430.9718   100%  8150 1707s
   636   669 35388.6693   20  356 19188.4618 38430.9718   100%  8252 1726s
   668   703 35216.2193   21  363 19188.4618 38430.9718   100%  8316 1746s
   702   737 35133.7636   22  350 19188.4618 38430.9718   100%  8314 1765s
   736   773 34489.0404   23  341 19188.4618 38430.9718   100%  8296 1783s
H  747   773                    19209.255877 38430.9718   100%  8298 1783s
   772   835 34051.7341   24  313 19209.2559 38430.9718   100%  8340 1804s
   834   904 33927.5965   25  362 19209.2559 38430.9718   100%  8293 1825s
   903   967 33801.4124   27  304 19209.2559 38430.9718   100%  8201 1848s
   966  1044 33398.0995   29  287 19209.2559 38430.9718   100%  8164 1869s
  1045  1131 32776.1129   32  268 19209.2559 38430.9718   100%  8054 1891s
  1134  1235 32328.2234   36  264 19209.2559 38430.9718   100%  7950 1916s
H 1138  1235                    19272.275159 38430.9718  99.4%  7934 1916s
H 1146  1235                    19423.680035 38430.9718  97.9%  7923 1916s
  1240  1326 31988.2697   40  309 19423.6800 38430.9718  97.9%  7779 1943s
  1341  1385 31782.8421   43  312 19423.6800 38430.9718  97.9%  7663 1973s
  1414  1466 29411.9493   46  371 19423.6800 38430.9718  97.9%  7689 2004s
  1515  1525 28753.9829   54  317 19423.6800 38430.9718  97.9%  7706 2035s
  1594  1618 26822.1388   58  209 19423.6800 38341.3821  97.4%  7778 2070s
  1722  1687 24864.0934   63  243 19423.6800 38341.3821  97.4%  7665 2107s
  1829  1753 22829.1830   71  216 19423.6800 38341.3821  97.4%  7621 2144s
  1943  1836 22200.5112   81  202 19423.6800 38341.3821  97.4%  7586 2185s
H 1957  1836                    19432.213467 38341.3821  97.3%  7562 2185s
H 1971  1836                    19469.397069 38341.3821  96.9%  7541 2185s
  2066  1883 21253.7247   91  183 19469.3971 38341.3821  96.9%  7528 2223s
  2165  1941 infeasible   61      19469.3971 38311.6965  96.8%  7587 2262s
H 2168  1941                    19492.510431 38311.6965  96.5%  7587 2262s
H 2248  1941                    19520.379400 38311.6965  96.3%  7669 2262s
  2261  2013 33869.7493   10  373 19520.3794 38311.6965  96.3%  7679 2307s
  2350  2123 33455.9247   11  352 19520.3794 38311.6965  96.3%  7795 2344s
H 2468  2122                    19546.619328 38311.6965  96.0%  7720 2344s
  2488  2236 33165.2519   12  353 19546.6193 38311.6965  96.0%  7720 2389s
  2636  2334 28114.8918   12  286 19546.6193 38132.0417  95.1%  7657 2435s
  2786  2401 27477.3570   13  323 19546.6193 38132.0417  95.1%  7664 2474s
  2871  2507 26239.6972   13  252 19546.6193 38132.0417  95.1%  7648 2518s
  3015  2625 24034.1409   14  331 19546.6193 38132.0417  95.1%  7611 2568s
  3173  2771 26792.6644   14  362 19546.6193 38132.0417  95.1%  7566 2617s
H 3212  2770                    19580.759292 38132.0417  94.7%  7547 2617s
  3369  2912 26596.2250   16  341 19580.7593 38132.0417  94.7%  7473 2667s
  3575  2913 24230.7677   32  413 19580.7593 37972.5520  93.9%  7421 2954s
  3577  2914 36244.3568    9  151 19580.7593 37972.5520  93.9%  7416 2966s
H 3577  2768                    19703.200508 37972.5520  92.7%  7416 3070s
  3578  2769 24680.5022   19  381 19703.2005 37972.5520  92.7%  7414 3077s
  3579  2770 31576.4219   30  416 19703.2005 37972.5520  92.7%  7412 3175s
  3580  2770 22752.1366   33  431 19703.2005 37972.5520  92.7%  7410 3228s
  3581  2771 34952.2572   36  440 19703.2005 37972.5520  92.7%  7408 3261s
  3582  2772 27596.9520   25  452 19703.2005 37972.5520  92.7%  7406 3291s
  3583  2772 31490.9040   44  432 19703.2005 37972.5520  92.7%  7404 3313s
  3584  2773 27472.9833   29  407 19703.2005 37972.5520  92.7%  7402 3330s
  3585  2774 22827.4536   31  417 19703.2005 37972.5520  92.7%  7400 3343s
  3586  2774 32734.9536   27  415 19703.2005 37972.5520  92.7%  7398 3353s
  3587  2775 36692.0994   13  420 19703.2005 37972.5520  92.7%  7396 3361s
  3588  2776 23968.5594   29  412 19703.2005 37972.5520  92.7%  7394 3372s
  3589  2776 22979.8156   83  410 19703.2005 37972.5520  92.7%  7392 3380s
  3590  2777 22500.2728   90  470 19703.2005 37972.5520  92.7%  7390 3387s
  3591  2778 32618.8529   23  466 19703.2005 37972.5520  92.7%  7387 3392s
  3592  2778 35694.1804   12  464 19703.2005 37972.5520  92.7%  7385 3404s
  3593  2779 34568.9892   15  448 19703.2005 37972.5520  92.7%  7383 3409s
  3594  2780 36782.9460   10  425 19703.2005 37972.5520  92.7%  7381 3412s
  3595  2780 35191.9736   30  464 19703.2005 37972.5520  92.7%  7379 3424s
  3596  2781 35143.4936   32  444 19703.2005 37972.5520  92.7%  7377 3427s
  3597  2782 20157.9519   37  465 19703.2005 37972.5520  92.7%  7375 3430s
  3598  2782 36556.8328   13  427 19703.2005 37972.5520  92.7%  7373 3435s
  3599  2783 34286.0748   21  467 19703.2005 37972.5520  92.7%  7371 3447s
  3600  2784 31213.2809   48  480 19703.2005 37972.5520  92.7%  7369 3452s
  3601  2784 22390.3610   64  475 19703.2005 37972.5520  92.7%  7367 3462s
  3602  2785 34064.2008   14  468 19703.2005 37972.5520  92.7%  7365 3466s
  3603  2786 30436.0812   18  455 19703.2005 37972.5520  92.7%  7363 3470s
  3604  2786 25487.0011   40  464 19703.2005 37972.5520  92.7%  7361 3475s
  3605  2787 22171.8236   83  455 19703.2005 37972.5520  92.7%  7359 3485s
  3606  2788 25762.4691   67  454 19703.2005 37972.5520  92.7%  7357 3491s
  3607  2788 35647.7670   21  487 19703.2005 37972.5520  92.7%  7355 3503s
  3608  2789 21423.2049   27  475 19703.2005 37972.5520  92.7%  7353 3509s
  3609  2790 30999.5991   16  473 19703.2005 37972.5520  92.7%  7351 3514s
  3610  2790 34126.6307   49  481 19703.2005 37972.5520  92.7%  7349 3520s
  3611  2791 22842.1485   46  465 19703.2005 37972.5520  92.7%  7347 3532s
  3612  2792 34289.3344   11  465 19703.2005 37972.5520  92.7%  7345 3537s
H 3612  2652                    19722.731414 37972.5520  92.5%  7345 3546s
H 3612  2518                    19789.969559 37972.5520  91.9%  7345 3546s
  3614  2519 36392.1775   15  453 19789.9696 37972.5520  91.9%  7340 3551s
  3615  2520 33726.7814   13  506 19789.9696 37972.5520  91.9%  7338 3557s
  3616  2520 35966.2969   11  498 19789.9696 37972.5520  91.9%  7336 3570s
  3618  2522 21359.7385   62  491 19789.9696 37972.5520  91.9%  7332 3586s

Cutting planes:
  Learned: 1
  Gomory: 13
  Implied bound: 25
  Projected implied bound: 240
  MIR: 555
  Mixing: 1
  Flow cover: 606
  RLT: 25
  Relax-and-lift: 142

Explored 3618 nodes (27461340 simplex iterations) in 3600.13 seconds (5468.41 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 19790 19722.7 19703.2 ... 19423.7

Time limit reached
Best objective 1.978996955928e+04, best bound 3.797255204543e+04, gap 91.8778%
  WARNING: Time limit reached. Using best solution found (gap: 91.88%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.18s
  Master Objective (UB) = 19789.97, θ = 197601.77
  Upper Bound (UB) = 19789.97

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 197601.77
  [DEBUG]   ✓ Scenario 0: θ = 197601.77 ≤ Q = 197601.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 197601.77 ≤ Q = 197601.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 197601.77 ≤ Q = 197601.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 197601.77 ≤ Q = 197601.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 197601.77 ≤ Q = 197601.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 197601.77 ≤ Q = 197601.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 197601.77 ≤ Q = 197601.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 197601.77 ≤ Q = 197601.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 197601.77 ≤ Q = 197601.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 197601.77 ≤ Q = 197601.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 197601.77 ≤ Q = 197601.77 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 11] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x4380b5f6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xbc7f4a0a
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.303177e+13
Presolve removed 2611 rows and 1900 columns
Presolve time: 0.01s
Presolved: 482 rows, 489 columns, 1367 nonzeros
Found heuristic solution: objective 5739703.1709
Variable types: 331 continuous, 158 integer (158 binary)
Found heuristic solution: objective 5738800.2653

Root relaxation: objective -1.859817e+05, 233 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -185981.68    0  124 5738800.27 -185981.68   103%     -    0s
H    0     0                    -162727.8745 -185981.68  14.3%     -    0s
     0     0 -172204.25    0   83 -162727.87 -172204.25  5.82%     -    0s
H    0     0                    -170554.1033 -172109.03  0.91%     -    0s
     0     0 -171179.13    0   58 -170554.10 -171179.13  0.37%     -    0s
H    0     0                    -170837.7658 -171177.49  0.20%     -    0s
     0     0 -171012.48    0   48 -170837.77 -171012.48  0.10%     -    0s
     0     0 -171000.80    0   18 -170837.77 -171000.80  0.10%     -    0s
     0     0 -170994.13    0   15 -170837.77 -170994.13  0.09%     -    0s
     0     0 -170973.60    0   13 -170837.77 -170973.60  0.08%     -    0s
     0     0 -170907.74    0    6 -170837.77 -170907.74  0.04%     -    0s
     0     0 -170907.74    0   10 -170837.77 -170907.74  0.04%     -    0s
H    0     0                    -170845.8968 -170907.74  0.04%     -    0s
H    0     0                    -170850.6384 -170907.74  0.03%     -    0s
H    0     0                    -170883.0860 -170907.74  0.01%     -    0s
     0     0          -    0      -170883.09 -170899.41  0.01%     -    0s

Cutting planes:
  Gomory: 1
  Implied bound: 2
  MIR: 9
  Flow cover: 3
  Relax-and-lift: 1

Explored 1 nodes (644 simplex iterations) in 0.07 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -170883 -170851 -170846 ... 1.30318e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.708830859503e+05, best bound -1.708994101396e+05, gap 0.0096%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 181299.94
  Scenario: 40 demand increases, 20 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -170883.09
  [DEBUG]   S×d_nominal = 352183.03
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 352183.03 + -170883.09 = 181299.94
  [DEBUG]   Current θ from Master = 197601.77
  [DEBUG]   ⚠️  Z_SP ≤ θ by 16301.82 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 3488.15
  Lower Bound (LB) = 19242.46
  Gap (UB-LB) = 547.5123, Absolute Gap = 547.5123, Relative Gap = 0.027666
  Not converged yet (gap = 547.51 > ε = 200)

  [DEBUG] Adding NEW scenario 11 to Master Problem...
  [DEBUG] New scenario pattern: 40 increases, 20 decreases
    [DEBUG] Scenario 11 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 11 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 11]
    [DEBUG]   - Total constraints in model: 184863
    [DEBUG]   - Total variables in model: 77140
  [DEBUG] Total scenarios in Master: 12
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 12
================================================================================
[Iteration 12] Solving Master Problem...
  Current scenarios in Master: 12
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 184863 rows, 77140 columns and 524291 nonzeros
Model fingerprint: 0xa396feca
Variable types: 74881 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 84840 rows and 34440 columns
Presolve time: 3.17s
Presolved: 100023 rows, 42700 columns, 606167 nonzeros
Variable types: 40441 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -318769.5091
Found heuristic solution: objective -189441.1784

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.29s

Barrier statistics:
 Dense cols : 611
 AA' NZ     : 3.649e+06
 Factor NZ  : 8.491e+06 (roughly 130 MB of memory)
 Factor Ops : 1.584e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.86538624e+07  2.00806750e+08  1.46e+05 1.86e+01  9.24e+04     5s
   1  -1.42018716e+07  1.88649539e+08  1.01e+05 1.09e+02  6.37e+04     5s
   2  -8.90261491e+06  1.57046099e+08  6.26e+04 2.90e+01  4.04e+04     5s
   3  -1.51910425e+06  1.18386697e+08  5.73e+03 1.96e+00  4.26e+03     5s
   4  -7.63301137e+05  5.92191691e+07  8.00e+02 3.30e-01  7.87e+02     5s
   5  -6.52918292e+05  4.33349940e+07  3.24e+02 2.16e-01  4.15e+02     5s
   6  -5.04359850e+05  3.02359291e+07  5.84e+01 1.41e-01  1.96e+02     5s
   7  -4.50150135e+05  2.06888612e+07  4.09e+01 9.25e-02  1.32e+02     5s
   8  -2.66463082e+05  1.45546181e+07  7.54e+00 6.33e-02  8.33e+01     6s
   9  -1.50287714e+05  6.69962289e+06  2.42e+00 2.77e-02  3.78e+01     6s
  10  -1.08796752e+05  2.49124322e+06  1.46e+00 9.96e-03  1.43e+01     6s
  11  -5.22722926e+04  1.34198919e+06  4.74e-01 5.31e-03  7.62e+00     6s
  12  -3.69799918e+04  6.46450938e+05  3.36e-01 2.41e-03  3.73e+00     6s
  13  -1.40318960e+04  3.34515273e+05  1.92e-01 1.17e-03  1.90e+00     6s
  14   3.74332350e+03  2.32647896e+05  1.14e-01 1.03e-03  1.25e+00     6s
  15   5.73009955e+03  1.99779886e+05  1.07e-01 1.25e-03  1.06e+00     6s
  16   1.68832457e+04  1.55354528e+05  7.65e-02 1.63e-03  7.56e-01     6s
  17   2.37268333e+04  1.33843406e+05  5.95e-02 1.61e-03  6.01e-01     6s
  18   3.29056828e+04  1.16941153e+05  3.80e-02 2.11e-03  4.59e-01     6s
  19   3.83052753e+04  9.17456821e+04  2.67e-02 1.30e-03  2.92e-01     6s
  20   4.00224287e+04  8.56360045e+04  2.35e-02 1.08e-03  2.49e-01     6s
  21   4.39503389e+04  8.04973090e+04  1.68e-02 7.76e-04  1.99e-01     7s
  22   4.57889191e+04  7.32030888e+04  1.40e-02 5.57e-04  1.50e-01     7s
  23   4.68689237e+04  7.14616471e+04  1.24e-02 5.06e-04  1.34e-01     7s
  24   4.77430841e+04  6.76902102e+04  1.12e-02 3.98e-04  1.09e-01     7s
  25   4.89004066e+04  6.55416162e+04  9.37e-03 3.23e-04  9.08e-02     7s
  26   5.06034304e+04  6.34200209e+04  7.07e-03 2.53e-04  6.99e-02     7s
  27   5.14239964e+04  6.11837625e+04  5.97e-03 1.74e-04  5.33e-02     7s
  28   5.24394998e+04  6.07240551e+04  4.60e-03 1.60e-04  4.52e-02     7s
  29   5.28130388e+04  5.93388358e+04  4.07e-03 1.09e-04  3.56e-02     7s
  30   5.35355217e+04  5.83356040e+04  3.13e-03 6.92e-05  2.62e-02     7s
  31   5.41060810e+04  5.73720587e+04  2.39e-03 3.86e-05  1.78e-02     8s
  32   5.44342981e+04  5.67291828e+04  1.98e-03 1.84e-05  1.25e-02     8s
  33   5.49009494e+04  5.65933914e+04  1.41e-03 5.77e-05  9.24e-03     8s
  34   5.54115753e+04  5.64717044e+04  7.88e-04 4.31e-05  5.79e-03     8s
  35   5.55164368e+04  5.62674052e+04  6.61e-04 1.93e-05  4.10e-03     8s
  36   5.55980181e+04  5.62366340e+04  5.70e-04 1.58e-05  3.49e-03     8s
  37   5.56439409e+04  5.62232135e+04  5.12e-04 1.42e-05  3.16e-03     8s
  38   5.56634243e+04  5.62035689e+04  4.88e-04 1.20e-05  2.95e-03     8s
  39   5.57439577e+04  5.61938898e+04  3.97e-04 1.17e-05  2.46e-03     8s
  40   5.58332935e+04  5.61744307e+04  2.94e-04 9.30e-06  1.86e-03     9s
  41   5.58481082e+04  5.61501362e+04  2.78e-04 6.39e-06  1.65e-03     9s
  42   5.59342881e+04  5.61394236e+04  1.79e-04 5.05e-06  1.12e-03     9s
  43   5.59553663e+04  5.61274402e+04  1.54e-04 3.57e-06  9.39e-04     9s
  44   5.59966200e+04  5.61193321e+04  1.07e-04 2.59e-06  6.70e-04     9s
  45   5.60012058e+04  5.61137820e+04  1.02e-04 1.82e-06  6.14e-04     9s
  46   5.60496762e+04  5.61116351e+04  4.84e-05 1.55e-06  3.38e-04     9s
  47   5.60588786e+04  5.61007978e+04  3.89e-05 2.79e-07  2.29e-04     9s
  48   5.60825618e+04  5.60991063e+04  1.54e-05 1.58e-06  9.03e-05     9s
  49   5.60916455e+04  5.60985754e+04  6.39e-06 5.21e-07  3.78e-05    10s
  50   5.60919644e+04  5.60983703e+04  6.06e-06 2.58e-07  3.50e-05    10s
  51   5.60964294e+04  5.60983358e+04  1.58e-06 2.16e-07  1.04e-05    10s
  52   5.60964708e+04  5.60982214e+04  1.54e-06 7.46e-08  9.56e-06    10s
  53   5.60977902e+04  5.60981718e+04  3.45e-07 1.65e-08  2.08e-06    10s
  54   5.60981546e+04  5.60981550e+04  1.48e-10 1.26e-08  2.12e-09    10s

Barrier solved model in 54 iterations and 10.08 seconds (9.81 work units)
Optimal objective 5.60981546e+04


Root crossover log...

   89295 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                12s

   13049 PPushes remaining with PInf 4.9067349e-05                12s
       0 PPushes remaining with PInf 0.0000000e+00                13s

  Push phase complete: Pinf 0.0000000e+00, Dinf 8.3399645e+04     13s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   54644    5.6098155e+04   0.000000e+00   8.339965e+04     13s
   55918    5.6098155e+04   0.000000e+00   0.000000e+00     14s
   55918    5.6098155e+04   0.000000e+00   0.000000e+00     15s
Concurrent spin time: 0.01s

Solved with barrier

Root relaxation: objective 5.609816e+04, 55918 iterations, 10.58 seconds (12.52 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 56098.1550    0  153 -189441.18 56098.1550   130%     -   15s
H    0     0                    -184983.1955 56098.1550   130%     -   15s
H    0     0                    -69696.75254 56098.1550   180%     -   15s
H    0     0                    -8632.466488 56098.1550   750%     -   15s
H    0     0                    -5620.237573 56098.1550  1098%     -   16s
H    0     0                    2734.0106653 56098.1550  1952%     -   16s
H    0     0                    3121.0164822 56098.1550  1697%     -   16s
H    0     0                    5034.8212690 56098.1550  1014%     -   16s
H    0     0                    5063.3843371 56098.1550  1008%     -   16s
H    0     0                    5069.3069172 56098.1550  1007%     -   16s
H    0     0                    5247.8043981 56098.1550   969%     -   16s
H    0     0                    5523.0638307 56098.1550   916%     -   16s
H    0     0                    5733.2262847 56098.1550   878%     -   16s
H    0     0                    5757.4185993 50276.1538   773%     -   65s
H    0     0                    5760.6530437 50276.1538   773%     -   65s
     0     0 50239.6973    0  288 5760.65304 50239.6973   772%     -   76s
H    0     0                    10271.716976 50239.6973   389%     -   78s
H    0     0                    11943.462658 50239.6973   321%     -   78s
H    0     0                    12053.283233 49781.4684   313%     -  120s
     0     0 49656.6793    0  279 12053.2832 49656.6793   312%     -  120s
     0     0 49655.4804    0  301 12053.2832 49655.4804   312%     -  128s
     0     0 49655.4804    0  309 12053.2832 49655.4804   312%     -  133s
     0     0 49655.4804    0  309 12053.2832 49655.4804   312%     -  134s
H    0     0                    12620.819561 46413.6109   268%     -  209s
     0     0 46413.6109    0  330 12620.8196 46413.6109   268%     -  209s
H    0     0                    12674.008296 46413.3745   266%     -  210s
H    0     0                    12704.273845 46413.3745   265%     -  210s
H    0     0                    12780.207553 46413.3745   263%     -  210s
H    0     0                    12973.058882 46413.3745   258%     -  210s
H    0     0                    13213.280339 46413.3745   251%     -  210s
     0     0 45911.0469    0  337 13213.2803 45911.0469   247%     -  253s
     0     0 45550.4698    0  362 13213.2803 45550.4698   245%     -  285s
     0     0 45496.9102    0  360 13213.2803 45496.9102   244%     -  300s
     0     0 45460.5012    0  375 13213.2803 45460.5012   244%     -  314s
     0     0 45250.5342    0  371 13213.2803 45250.5342   242%     -  330s
     0     0 45234.2956    0  379 13213.2803 45234.2956   242%     -  336s
     0     0 45208.2438    0  373 13213.2803 45208.2438   242%     -  344s
     0     0 45200.8655    0  376 13213.2803 45200.8655   242%     -  348s
     0     0 45194.1963    0  378 13213.2803 45194.1963   242%     -  350s
     0     0 45182.1481    0  373 13213.2803 45182.1481   242%     -  355s
     0     0 45174.3407    0  373 13213.2803 45174.3407   242%     -  359s
     0     0 45174.2616    0  373 13213.2803 45174.2616   242%     -  359s
H    0     0                    13550.662957 43141.3984   218%     -  458s
H    0     0                    13561.514906 43141.3984   218%     -  458s
H    0     0                    13580.417168 43141.3984   218%     -  458s
H    0     0                    13604.217014 43141.3984   217%     -  458s
     0     0 43141.3984    0  439 13604.2170 43141.3984   217%     -  459s
H    0     0                    13812.729384 43141.3430   212%     -  460s
H    0     0                    14065.679057 43141.3430   207%     -  460s
H    0     0                    14094.642191 43141.3430   206%     -  460s
H    0     0                    14211.809581 43141.3430   204%     -  460s
H    0     0                    14372.287964 42637.7432   197%     -  507s
H    0     0                    14581.376092 42637.7432   192%     -  507s
H    0     0                    14647.242914 42637.7432   191%     -  507s
H    0     0                    14680.772732 42637.7432   190%     -  507s
H    0     0                    15145.753951 42637.7432   182%     -  507s
H    0     0                    15267.912530 42637.7432   179%     -  507s
     0     0 42637.7432    0  440 15267.9125 42637.7432   179%     -  507s
     0     0 42491.3220    0  452 15267.9125 42491.3220   178%     -  527s
     0     0 42424.3768    0  458 15267.9125 42424.3768   178%     -  539s
     0     0 42373.6806    0  455 15267.9125 42373.6806   178%     -  548s
     0     0 42325.3873    0  460 15267.9125 42325.3873   177%     -  557s
H    0     0                    15369.166979 42299.5756   175%     -  563s
H    0     0                    15450.602770 42299.5756   174%     -  563s
H    0     0                    15470.537694 42299.5756   173%     -  563s
H    0     0                    15478.607442 42299.5756   173%     -  563s
H    0     0                    15508.216626 42299.5756   173%     -  563s
H    0     0                    15981.991839 42299.5756   165%     -  563s
H    0     0                    16193.657919 42299.5756   161%     -  563s
H    0     0                    16301.617727 42299.5756   159%     -  563s
     0     0 42299.5756    0  457 16301.6177 42299.5756   159%     -  563s
     0     0 42273.3267    0  468 16301.6177 42273.3267   159%     -  569s
     0     0 42252.6486    0  454 16301.6177 42252.6486   159%     -  574s
     0     0 42244.4782    0  464 16301.6177 42244.4782   159%     -  577s
     0     0 42239.8181    0  455 16301.6177 42239.8181   159%     -  579s
     0     0 42236.5765    0  463 16301.6177 42236.5765   159%     -  580s
     0     0 42236.2604    0  460 16301.6177 42236.2604   159%     -  581s
H    0     0                    16622.864684 42236.2604   154%     -  591s
     0     0 41104.9375    0  463 16622.8647 41104.9375   147%     -  628s
H    0     0                    16640.109344 41104.7975   147%     -  628s
H    0     0                    16673.322458 41104.7975   147%     -  629s
H    0     0                    16852.458250 41104.7975   144%     -  629s
H    0     0                    16880.955488 41104.7975   143%     -  629s
     0     0 40853.8514    0  469 16880.9555 40853.8514   142%     -  644s
     0     0 40773.1545    0  427 16880.9555 40773.1545   142%     -  655s
     0     0 40737.6889    0  426 16880.9555 40737.6889   141%     -  661s
     0     0 40721.4609    0  401 16880.9555 40721.4609   141%     -  666s
     0     0 40711.6854    0  418 16880.9555 40711.6854   141%     -  669s
     0     0 40685.4564    0  404 16880.9555 40685.4564   141%     -  675s
     0     0 40677.7051    0  406 16880.9555 40677.7051   141%     -  678s
     0     0 40667.6320    0  406 16880.9555 40667.6320   141%     -  681s
     0     0 40665.9358    0  400 16880.9555 40665.9358   141%     -  683s
     0     0 40483.7830    0  399 16880.9555 40483.7830   140%     -  697s
     0     0 40422.0966    0  427 16880.9555 40422.0966   139%     -  709s
     0     0 40402.2402    0  447 16880.9555 40402.2402   139%     -  714s
     0     0 40391.8753    0  425 16880.9555 40391.8753   139%     -  718s
     0     0 40384.1006    0  470 16880.9555 40384.1006   139%     -  720s
     0     0 40379.6118    0  485 16880.9555 40379.6118   139%     -  722s
     0     0 40378.0401    0  427 16880.9555 40378.0401   139%     -  724s
     0     0 40278.3846    0  448 16880.9555 40278.3846   139%     -  737s
     0     0 40252.2900    0  458 16880.9555 40252.2900   138%     -  743s
     0     0 40236.3176    0  449 16880.9555 40236.3176   138%     -  748s
     0     0 40226.4404    0  458 16880.9555 40226.4404   138%     -  751s
     0     0 40222.4665    0  453 16880.9555 40222.4665   138%     -  753s
     0     0 40217.7310    0  451 16880.9555 40217.7310   138%     -  755s
     0     0 40214.6879    0  452 16880.9555 40214.6879   138%     -  756s
     0     0 40211.4834    0  459 16880.9555 40211.4834   138%     -  758s
     0     0 40210.9548    0  454 16880.9555 40210.9548   138%     -  759s
     0     0 40176.0732    0  417 16880.9555 40176.0732   138%     -  769s
     0     0 40140.4154    0  414 16880.9555 40140.4154   138%     -  776s
     0     0 40132.7865    0  414 16880.9555 40132.7865   138%     -  779s
     0     0 40130.2689    0  426 16880.9555 40130.2689   138%     -  781s
     0     0 40129.3985    0  423 16880.9555 40129.3985   138%     -  782s
     0     0 40093.2891    0  394 16880.9555 40093.2891   138%     -  788s
H    0     0                    17108.976522 40093.0579   134%     -  789s
     0     0 40077.3630    0  400 17108.9765 40077.3630   134%     -  793s
     0     0 40072.0994    0  406 17108.9765 40072.0994   134%     -  795s
     0     0 40070.2767    0  408 17108.9765 40070.2767   134%     -  796s
     0     0 40029.2220    0  448 17108.9765 40029.2220   134%     -  808s
H    0     0                    17219.045598 40029.0535   132%     -  809s
     0     0 40020.4748    0  404 17219.0456 40020.4748   132%     -  814s
     0     0 40018.3201    0  413 17219.0456 40018.3201   132%     -  815s
     0     0 39988.4413    0  453 17219.0456 39988.4413   132%     -  831s
     0     0 39981.1674    0  450 17219.0456 39981.1674   132%     -  836s
     0     0 39979.1978    0  458 17219.0456 39979.1978   132%     -  840s
     0     0 39970.6048    0  457 17219.0456 39970.6048   132%     -  845s
     0     0 39966.7325    0  422 17219.0456 39966.7325   132%     -  849s
     0     0 39965.6503    0  414 17219.0456 39965.6503   132%     -  850s
     0     0 39946.0301    0  477 17219.0456 39946.0301   132%     -  857s
     0     0 39938.6751    0  458 17219.0456 39938.6751   132%     -  862s
     0     0 39937.0560    0  470 17219.0456 39937.0560   132%     -  864s
H    0     0                    17219.729557 39913.9179   132%     -  872s
     0     0 39913.9179    0  428 17219.7296 39913.9179   132%     -  872s
H    0     0                    17325.629702 39901.5076   130%     -  878s
     0     0 39901.5076    0  448 17325.6297 39901.5076   130%     -  878s
     0     0 39898.2518    0  459 17325.6297 39898.2518   130%     -  880s
     0     0 39896.6079    0  469 17325.6297 39896.6079   130%     -  881s
     0     0 39881.4000    0  458 17325.6297 39881.4000   130%     -  886s
     0     0 39878.3392    0  477 17325.6297 39878.3392   130%     -  893s
     0     0 39876.2143    0  447 17325.6297 39876.2143   130%     -  895s
     0     0 39873.0750    0  454 17325.6297 39873.0750   130%     -  898s
     0     0 39869.1146    0  454 17325.6297 39869.1146   130%     -  902s
     0     0 39868.8068    0  456 17325.6297 39868.8068   130%     -  903s
     0     0 39864.8957    0  497 17325.6297 39864.8957   130%     -  906s
H    0     0                    17349.075982 39864.4179   130%     -  907s
H    0     0                    17383.702636 39864.4179   129%     -  907s
H    0     0                    17404.001506 39864.4179   129%     -  907s
     0     0 39864.2596    0  455 17404.0015 39864.2596   129%     -  908s
     0     0 39845.1477    0  489 17404.0015 39845.1477   129%     -  915s
     0     0 39845.0922    0  489 17404.0015 39845.0922   129%     -  918s
H    0     0                    17496.536029 39845.0320   128%     - 1024s
H    0     0                    17532.788520 39845.0320   127%     - 1024s
H    0     0                    17698.822809 39845.0320   125%     - 1086s
H    0     0                    17736.949843 39845.0320   125%     - 1086s
H    0     2                    18029.796725 39845.0320   121%     - 1096s
     0     2 39845.0320    0  489 18029.7967 39845.0320   121%     - 1096s
     1     4 39797.5638    1  477 18029.7967 39845.0320   121%  4852 1122s
     3     7 39509.6972    2  479 18029.7967 39797.4691   121% 10081 1156s
     6    14 39484.2221    3  486 18029.7967 39509.5491   119% 12623 1221s
    13    28 39181.5553    4  482 18029.7967 39482.7585   119% 15327 1242s
    27    42 38161.9890    5  408 18029.7967 39181.4975   117% 16878 1301s
H   41    73                    18300.715706 39181.4975   114% 20879 1419s
H   42    73                    18463.973913 39181.4975   112% 20579 1419s
H   54    73                    18503.529584 39181.4975   112% 19188 1419s
H   66    73                    18524.696840 39181.4975   112% 17361 1419s
    72   106 37768.5503    7  460 18524.6968 39034.7391   111% 19716 1462s
H  105   245                    18719.180693 38999.3430   108% 16089 1514s
H  195   245                    18813.739769 38999.3430   107% 11353 1514s
   244   314 37194.6873   12  442 18813.7398 38999.1674   107% 10137 1544s
   313   342 36313.9914   15  368 18813.7398 38999.1674   107%  9130 1568s
H  317   342                    18842.071433 38999.1674   107%  9109 1568s
   341   372 36501.1035   14  395 18842.0714 38999.1674   107%  9108 1597s
   371   401 36342.2264   15  381 18842.0714 38999.1674   107%  8977 1623s
   400   437 36329.8529   16  376 18842.0714 38999.1674   107%  8867 1647s
H  401   437                    19070.007601 38999.1674   105%  8845 1647s
   436   469 36249.3497   17  382 19070.0076 38999.1674   105%  8731 1675s
   468   506 36198.4592   18  378 19070.0076 38999.1674   105%  8735 1701s
   505   548 36168.3019   19  395 19070.0076 38999.1674   105%  8652 1727s
   547   588 36129.4774   20  376 19070.0076 38999.1674   105%  8526 1747s
H  554   588                    19139.484048 38999.1674   104%  8475 1747s
   587   645 35160.0200   24  304 19139.4840 38999.1674   104%  8540 1775s
   644   702 35991.1942   21  377 19139.4840 38999.1674   104%  8554 1799s
   701   746 35555.8879   22  349 19139.4840 38999.1674   104%  8679 1822s
   745   775 35409.5763   23  354 19139.4840 38999.1674   104%  8835 1846s
H  746   775                    19256.289941 38999.1674   103%  8824 1846s
H  758   775                    19326.384710 38999.1674   102%  8902 1846s
   774   825 35352.3583   24  375 19326.3847 38999.1674   102%  9021 1868s
   824   876 35243.3299   26  338 19326.3847 38999.1674   102%  9165 1902s
   875   927 34923.5304   27  328 19326.3847 38999.1674   102%  8984 1935s
   928   963 34344.6035   29  319 19326.3847 38999.1674   102%  9075 1963s
   964  1014 34103.0562   30  330 19326.3847 38999.1674   102%  9123 1991s
H  977  1014                    19329.827210 38999.1674   102%  9123 1991s
  1015  1044 34012.4378   31  359 19329.8272 38999.1674   102%  9205 2020s
  1045  1082 33980.3967   32  330 19329.8272 38999.1674   102%  9133 2046s
  1083  1132 33966.0147   33  361 19329.8272 38999.1674   102%  9168 2073s
  1133  1196 33361.2315   34  347 19329.8272 38999.1674   102%  9178 2104s
  1203  1277 33335.2459   35  357 19329.8272 38999.1674   102%  9146 2133s
  1294  1377 33174.6436   36  300 19329.8272 38999.1674   102%  9049 2164s
  1396  1465 32327.9057   37  324 19329.8272 38999.1674   102%  8926 2196s
  1502  1537 32307.8189   38  311 19329.8272 38999.1674   102%  8806 2232s
  1592  1599 32108.8393   39  306 19329.8272 38999.1674   102%  8805 2266s
H 1594  1599                    19355.303038 38999.1674   101%  8796 2266s
  1664  1694 31968.3084   41  273 19355.3030 38999.1674   101%  8837 2310s
  1789  1805 31711.0022   45  333 19355.3030 38999.1674   101%  8781 2348s
  1912  1923 31211.3314   50  325 19355.3030 38999.1674   101%  8772 2386s
  2060  2020 30998.9304   55  252 19355.3030 38999.1674   101%  8661 2427s
  2212  2127 30610.9320   61  234 19355.3030 38999.1674   101%  8522 2472s
  2343  2163 28710.7381   68  185 19355.3030 38999.1674   101%  8560 2512s
  2379  2227 28643.6752   69  183 19355.3030 38999.1674   101%  8643 2553s
  2457  2298 28591.8935   70  174 19355.3030 38999.1674   101%  8564 2596s
  2564  2371 27931.9196   80  156 19355.3030 38948.7680   101%  8500 2646s
  2661  2480 24543.6288   90  179 19355.3030 38948.7680   101%  8575 2698s
  2790  2552 22991.6271   98  189 19355.3030 38948.7680   101%  8630 2752s
  2909  2621 34982.9554    9  385 19355.3030 38948.7680   101%  8713 2812s
  3002  2711 34533.0671   11  385 19355.3030 38948.7680   101%  8934 2875s
  3106  2862 32570.7524   14  294 19355.3030 38948.7680   101%  9119 2935s
  3266  2863 35347.9533   12  489 19355.3030 38948.7680   101%  9172 3285s
  3268  2864 32995.2101   25  154 19355.3030 38948.7680   101%  9166 3302s
  3269  2865 32085.5538   30  372 19355.3030 38948.7680   101%  9163 3426s
  3270  2866 36942.0722   17  449 19355.3030 38948.7680   101%  9160 3546s

Cutting planes:
  Gomory: 11
  Implied bound: 20
  Projected implied bound: 165
  MIR: 915
  Mixing: 4
  Flow cover: 558
  RLT: 31
  Relax-and-lift: 161

Explored 3270 nodes (30707142 simplex iterations) in 3600.05 seconds (5646.28 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 19355.3 19329.8 19326.4 ... 18524.7

Time limit reached
Best objective 1.935530303820e+04, best bound 3.894876799772e+04, gap 101.2305%
  WARNING: Time limit reached. Using best solution found (gap: 101.23%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3600.15s
  Master Objective (UB) = 19355.30, θ = 193140.30
  Upper Bound (UB) = 19355.30

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 193140.30
  [DEBUG]   ✓ Scenario 0: θ = 193140.30 ≤ Q = 193140.30 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 193140.30 ≤ Q = 193140.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 193140.30 ≤ Q = 193140.30 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 193140.30 ≤ Q = 193140.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 193140.30 ≤ Q = 193140.30 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 193140.30 ≤ Q = 193140.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 193140.30 ≤ Q = 193140.30 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 193140.30 ≤ Q = 193140.30 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 193140.30 ≤ Q = 193140.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 193140.30 ≤ Q = 193140.30 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 193140.30 ≤ Q = 193140.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 193140.30 ≤ Q = 193140.30 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 12] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0xf428f95
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x0f428f95
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.315279e+13
Presolve removed 2602 rows and 1892 columns
Presolve time: 0.01s
Presolved: 491 rows, 497 columns, 1386 nonzeros
Found heuristic solution: objective 5608913.5254
Variable types: 338 continuous, 159 integer (159 binary)
Found heuristic solution: objective 5608581.5933

Root relaxation: objective -1.907726e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -190772.65    0  129 5608581.59 -190772.65   103%     -    0s
H    0     0                    -165622.2691 -190772.65  15.2%     -    0s
H    0     0                    -165846.9540 -190445.25  14.8%     -    0s
     0     0 -176657.29    0   97 -165846.95 -176657.29  6.52%     -    0s
H    0     0                    -173552.9190 -176545.29  1.72%     -    0s
H    0     0                    -174109.4650 -176262.80  1.24%     -    0s
     0     0 -176262.80    0   99 -174109.47 -176262.80  1.24%     -    0s
     0     0 -176261.35    0   99 -174109.47 -176261.35  1.24%     -    0s
     0     0 -174629.54    0   63 -174109.47 -174629.54  0.30%     -    0s
     0     0 -174568.84    0   60 -174109.47 -174568.84  0.26%     -    0s
     0     0 -174566.59    0   60 -174109.47 -174566.59  0.26%     -    0s
     0     0 -174324.77    0   13 -174109.47 -174324.77  0.12%     -    0s
     0     0 -174274.25    0   10 -174109.47 -174274.25  0.09%     -    0s
     0     0 -174208.09    0    9 -174109.47 -174208.09  0.06%     -    0s
     0     0 -174208.09    0   14 -174109.47 -174208.09  0.06%     -    0s
     0     0 -174208.09    0   13 -174109.47 -174208.09  0.06%     -    0s
     0     0 -174154.37    0    5 -174109.47 -174154.37  0.03%     -    0s
H    0     0                    -174142.1804 -174153.25  0.01%     -    0s

Cutting planes:
  Gomory: 4
  Implied bound: 2
  MIR: 2
  Flow cover: 7
  Relax-and-lift: 6

Explored 1 nodes (777 simplex iterations) in 0.21 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -174142 -174109 -173006 ... 1.31528e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.741421803510e+05, best bound -1.741532542508e+05, gap 0.0064%
  Subproblem solved in 0.24s
  Worst-case operational profit (Z_SP) = 176362.28
  Scenario: 48 demand increases, 12 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -174142.18
  [DEBUG]   S×d_nominal = 350504.46
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 350504.46 + -174142.18 = 176362.28
  [DEBUG]   Current θ from Master = 193140.30
  [DEBUG]   ⚠️  Z_SP ≤ θ by 16778.02 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 2577.29
  Lower Bound (LB) = 19242.46
  Gap (UB-LB) = 112.8457, Absolute Gap = 112.8457, Relative Gap = 0.005830
  *** CONVERGED (gap within tolerance) ***

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 12
Total Time: 33414.03s
Converged: True
Final Lower Bound: 19242.4573
Final Upper Bound: 19355.3030
Final Gap: 112.845741
Number of Critical Scenarios: 12
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [1] (1/3)
Product 1 Plants: [0] (1/3)
Product 2 Plants: [2] (1/3)
Total Plant Openings: 3
DCs Opened: [0, 1, 2, 5, 9] (5/10)
Active Routes (Plant→DC): 14
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 1 customers  Mode 1: 11 customers  Mode 2: 38 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 12
Start Time: 2026-01-04 12:31:03
End Time: 2026-01-04 21:47:57
Total Time: 33414.03s
Optimal Value: 19242.46
Lower Bound: 19242.46
Upper Bound: 19355.30
Gap: 112.845741
Plants Opened: {0: [1], 1: [0], 2: [2]} (3 plants)
DCs Opened: [0, 1, 2, 5, 9] (5 DCs)
================================================================================

Results saved to: result/DH_single_full_seed26_HD_gamma20_20260104_214757.csv

Total Execution Time: 33414.34 seconds
End Time: 2026-01-04 21:47:57

All tasks completed successfully!

