
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 21
DI Scenario: LD
Start Time: 2026-01-04 12:30:56
================================================================================
Loading data from data/DH_data_full_seed21.pkl...

Applying DI scenario: LD
DI values:
  Product 0: ['1.000', '1.105', '1.221'] (k=0.246)
  Product 1: ['1.000', '1.060', '1.123'] (k=0.143)
  Product 2: ['1.000', '1.022', '1.044'] (k=0.053)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=943, max=1719
  DC capacity (MC): min=431, max=842

Demand Structure (s_rk matrix):
  Total customer-product pairs: 84/150 (44.0% sparse)
  Average products per customer: 1.68

Demand (only non-zero entries):
  Nominal (μ): min=8.24, max=34.94, count=84
  Deviation (μ̂): min=4.05, max=9.88

Costs:
  Plant fixed cost: min=5672, max=9774
  DC fixed cost: min=3426, max=5483
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.440', '2.075'] (k=0.900)
    Product 1: ['1.000', '1.474', '2.173'] (k=0.957)
    Product 2: ['1.000', '1.444', '2.085'] (k=0.906)
  MD:
    Product 0: ['1.000', '1.180', '1.392'] (k=0.408)
    Product 1: ['1.000', '1.288', '1.660'] (k=0.625)
    Product 2: ['1.000', '1.175', '1.380'] (k=0.398)
  LD:
    Product 0: ['1.000', '1.105', '1.221'] (k=0.246)
    Product 1: ['1.000', '1.060', '1.123'] (k=0.143)
    Product 2: ['1.000', '1.022', '1.044'] (k=0.053)
  Mixed:
    Product 0: ['1.000', '1.440', '2.075'] (k=0.900)
    Product 1: ['1.000', '1.288', '1.660'] (k=0.625)
    Product 2: ['1.000', '1.022', '1.044'] (k=0.053)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48762 nonzeros
Model fingerprint: 0xdc706e37
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11707 rows and 2707 columns
Presolve time: 0.08s
Presolved: 4966 rows, 5793 columns, 34451 nonzeros
Variable types: 3534 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -296323.7635
Found heuristic solution: objective -193271.6795

Root relaxation: objective 6.736945e+04, 5141 iterations, 0.21 seconds (0.40 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 67369.4508    0  963 -193271.68 67369.4508   135%     -    0s
H    0     0                    -186820.9039 67369.4508   136%     -    0s
H    0     0                    -185360.0194 63258.2322   134%     -    1s
     0     0 63258.2322    0 1029 -185360.02 63258.2322   134%     -    1s
H    0     0                    -185284.1744 63256.8239   134%     -    1s
     0     0 63164.5741    0 1042 -185284.17 63164.5741   134%     -    1s
     0     0 63154.5484    0 1042 -185284.17 63154.5484   134%     -    1s
     0     0 63154.5242    0 1043 -185284.17 63154.5242   134%     -    1s
H    0     0                    -182409.9200 60516.5520   133%     -    2s
     0     0 59479.8522    0 1175 -182409.92 59479.8522   133%     -    2s
H    0     0                    -155226.5293 59479.8522   138%     -    2s
H    0     0                    -155168.6040 59479.8522   138%     -    2s
H    0     0                    -155130.7820 59479.8522   138%     -    2s
     0     0 59333.1645    0 1181 -155130.78 59333.1645   138%     -    2s
     0     0 59234.5242    0 1184 -155130.78 59234.5242   138%     -    2s
     0     0 59234.5242    0 1184 -155130.78 59234.5242   138%     -    2s
H    0     0                    -105925.1782 56448.5987   153%     -    4s
H    0     0                    -35411.59125 56448.5987   259%     -    4s
H    0     0                    -33717.44647 56448.5987   267%     -    4s
H    0     0                    -33547.40241 56448.5987   268%     -    4s
H    0     0                    -32296.60472 56448.5987   275%     -    4s
H    0     0                    -31237.96704 56448.5987   281%     -    4s
     0     0 56448.5987    0 1304 -31237.967 56448.5987   281%     -    4s
     0     0 56448.5987    0 1304 -31237.967 56448.5987   281%     -    4s
     0     2 56448.5987    0 1304 -31237.967 56448.5987   281%     -    5s
    63    96 55028.7834    6 1022 -31237.967 55764.4255   279%  2030   10s
H  339   364                    -18618.18572 55764.4255   400%   834   11s
H  359   364                    -16620.54402 55764.4255   436%   820   11s
H  487   510                    -12431.65226 55764.4255   549%   717   11s
H  492   510                    -9436.091779 55764.4255   691%   715   11s
H  495   510                    -5158.038208 55764.4255  1181%   714   11s
H  498   510                    -3401.439722 55764.4255  1739%   712   11s
H  518   620                    -3381.760896 55764.4255  1749%   699   12s
H  523   620                    -3208.388238 55764.4255  1838%   695   12s
H  528   620                    -2710.342268 55764.4255  2157%   691   12s
H  544   620                    -2040.024676 55764.4255  2834%   682   12s
H  674   681                    2743.8619903 55714.2393  1931%   606   12s
H  679   681                    7910.7435473 55714.2393   604%   603   12s
H  842   920                    8689.9212757 55581.0755   540%   536   13s
H  848   920                    10126.292922 55581.0755   449%   533   13s
H  909   920                    10748.187639 55581.0755   417%   507   13s
H  992   920                    10915.547900 55581.0755   409%   479   13s
H 1162  1217                    11142.186128 55523.3309   398%   437   14s
H 1170  1217                    11216.471116 55523.3309   395%   434   14s
H 1172  1217                    12238.733407 55523.3309   354%   433   14s
H 1223  1217                    12334.898457 55523.3309   350%   420   14s
H 1265  1217                    12377.613200 55523.3309   349%   411   14s
  1335  1386 14885.1668   34  345 12377.6132 55523.3309   349%   401   15s
H 1537  1548                    13008.757105 55113.3432   324%   369   15s
H 1555  1548                    13384.948153 55113.3432   312%   368   15s
H 1650  1548                    13562.210594 55113.3432   306%   355   15s
H 1964  2002                    13566.424750 55025.0578   306%   320   16s
H 1975  2002                    13832.378459 55025.0578   298%   319   16s
H 2020  2002                    13881.308990 55025.0578   296%   313   16s
H 2143  2002                    13929.412484 55025.0578   295%   301   16s
H 2173  2002                    14488.137672 55025.0578   280%   298   16s
H 2244  2090                    15180.016099 55025.0578   262%   291   16s
H 2930  2471                    15222.171760 54047.2681   255%   252   18s
H 3287  2757                    15230.551102 54047.2681   255%   236   22s
H 3287  2757                    15235.585827 54047.2681   255%   236   22s
H 3287  2752                    15339.567076 54047.2681   252%   236   22s
H 3287  2697                    15997.840402 54047.2681   238%   236   22s
H 3287  2697                    16026.272943 54047.2681   237%   236   22s
H 3287  2621                    16755.671537 54047.2681   223%   236   23s
H 3287  2553                    17368.178752 54047.2681   211%   236   23s
  3288  2541 35399.1365   19 1304 17368.1788 54047.2681   211%   236   27s
  3300  2549 28968.4398   16  571 17368.1788 28968.4398  66.8%   235   30s
H 3316  2431                    17399.478496 27920.1953  60.5%   234   34s
H 3316  2309                    17412.328730 27920.1953  60.3%   234   34s
H 3316  2193                    17414.466025 27920.1953  60.3%   234   34s
  3318  2194 26274.2507   21  623 17414.4660 27902.5312  60.2%   234   35s
H 3580  2181                    20022.100187 26005.0674  29.9%   253   39s
  3891  2059     cutoff   17      20022.1002 24753.4601  23.6%   251   40s
H 3991  1935                    20046.777247 24712.0072  23.3%   249   40s
H 3992  1835                    20219.939216 24712.0072  22.2%   249   40s
H 3994  1740                    20551.716558 24712.0072  20.2%   248   40s
H 3997  1649                    20654.352851 24712.0072  19.6%   248   40s
H 4026  1554                    20664.429753 24712.0072  19.6%   247   40s
H 4156  1365                    20681.138763 24712.0072  19.5%   246   40s
H 4159  1287                    20688.132491 24712.0072  19.5%   246   40s
H 4195  1202                    20700.925804 24712.0072  19.4%   245   40s
H 4308  1021                    20707.919532 23642.5450  14.2%   242   41s
H 4310   954                    20729.692070 23642.5450  14.1%   242   41s
H 4485   921                    20759.380375 22550.4723  8.63%   235   41s
H 4702   792                    20765.518512 20851.3334  0.41%   226   41s
H 4776   710                    20773.524931 20851.3334  0.37%   223   41s
H 4916   577                    20775.488910 20851.3334  0.37%   217   41s
* 4930   522              48    20781.209754 20834.5114  0.26%   217   41s
* 4941   470              48    20784.333257 20829.9763  0.22%   216   41s
H 5174   346                    20784.948925 20829.8876  0.22%   208   41s
* 5304   225              50    20788.237262 20829.8876  0.20%   203   41s
* 5418   145              49    20792.964515 20815.0920  0.11%   199   41s

Cutting planes:
  Implied bound: 1
  Projected implied bound: 154
  MIR: 225
  Flow cover: 568
  Inf proof: 1
  Zero half: 4
  RLT: 45
  Relax-and-lift: 159

Explored 5539 nodes (1101422 simplex iterations) in 41.79 seconds (92.46 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 20793 20788.2 20784.9 ... 20729.7

Optimal solution found (tolerance 1.00e-04)
Best objective 2.079296451503e+04, best bound 2.079296451503e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 41.80s
  Master Objective (UB) = 20792.96, θ = 150885.42
  Upper Bound (UB) = 20792.96

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 150885.42
  [DEBUG]   ✓ Scenario 0: θ = 150885.42 ≤ Q = 150885.42 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x4451df54
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x4451df54
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [3e-01, 2e+02]
Found heuristic solution: objective 1.236211e+13
Presolve removed 2577 rows and 1870 columns
Presolve time: 0.00s
Presolved: 516 rows, 519 columns, 1455 nonzeros
Found heuristic solution: objective 6702244.6041
Variable types: 351 continuous, 168 integer (168 binary)

Root relaxation: objective -1.121258e+05, 245 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -112125.83    0  121 6702244.60 -112125.83   102%     -    0s
H    0     0                    -77690.91868 -112125.83  44.3%     -    0s
H    0     0                    -79205.94317 -112125.83  41.6%     -    0s
H    0     0                    -81359.10700 -81359.107  0.00%     -    0s
     0     0          -    0      -81359.107 -81359.107  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 205

Explored 1 nodes (382 simplex iterations) in 0.01 seconds (0.02 work units)
Thread count was 32 (of 64 available processors)

Solution count 5: -81359.1 -79205.9 -77690.9 ... 1.23621e+13
No other solutions better than -81359.1

Optimal solution found (tolerance 1.00e-04)
Best objective -8.135910700219e+04, best bound -8.135910700219e+04, gap 0.0000%
  Subproblem solved in 0.03s
  Worst-case operational profit (Z_SP) = 117073.74
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -81359.11
  [DEBUG]   S×d_nominal = 198432.85
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 198432.85 + -81359.11 = 117073.74
  [DEBUG]   Current θ from Master = 150885.42
  [DEBUG]   ⚠️  Z_SP ≤ θ by 33811.68 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -13018.71
  Lower Bound (LB) = -13018.71
  Gap (UB-LB) = 33811.6784, Absolute Gap = 33811.6784, Relative Gap = 1.626111
  Not converged yet (gap = 33811.68 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 92005 nonzeros
Model fingerprint: 0x4a3bb9f0
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve produced solution with objective -13018.7 (0.01s)
Loaded MIP start from previous solve with objective -13018.7

Presolve removed 13363 rows and 5422 columns
Presolve time: 0.31s
Presolved: 18600 rows, 9318 columns, 103068 nonzeros
Variable types: 7059 continuous, 2259 integer (2259 binary)

Root relaxation: objective 2.183479e+04, 10459 iterations, 1.65 seconds (3.45 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 21834.7948    0  435 -13018.714 21834.7948   268%     -    2s
H    0     0                    -11608.62426 21834.7948   288%     -    2s
H    0     0                    -11598.96363 21834.7948   288%     -    2s
H    0     0                    -11597.79507 21834.7948   288%     -    2s
     0     0 15722.9663    0  734 -11597.795 15722.9663   236%     -    3s
     0     0 15303.2481    0  647 -11597.795 15303.2481   232%     -    4s
     0     0 15303.0197    0  705 -11597.795 15303.0197   232%     -    4s
     0     0 10217.3755    0  859 -11597.795 10217.3755   188%     -    6s
H    0     0                    -11557.07745 10216.8464   188%     -    6s
H    0     0                    -11330.51608 9661.60643   185%     -    7s
H    0     0                    -11318.52737 9661.60643   185%     -    7s
     0     0 9661.60643    0  878 -11318.527 9661.60643   185%     -    7s
     0     0 9595.16733    0  883 -11318.527 9595.16733   185%     -    7s
     0     0 9592.23045    0  888 -11318.527 9592.23045   185%     -    7s
     0     0 9592.18008    0  889 -11318.527 9592.18008   185%     -    7s
H    0     0                    -11247.19452 9592.18008   185%     -    8s
H    0     0                    -11227.01893 9592.18008   185%     -    8s
H    0     0                    -10883.03810 5809.08985   153%     -   11s
H    0     0                    -10881.87858 5809.08985   153%     -   11s
     0     0 5809.08985    0  770 -10881.879 5809.08985   153%     -   11s
H    0     0                    -10814.74996 5808.87166   154%     -   11s
H    0     0                    -10755.35881 5808.87166   154%     -   11s
H    0     0                    -10754.19928 5808.87166   154%     -   11s
     0     0 5298.02246    0  934 -10754.199 5298.02246   149%     -   13s
     0     0 5175.72584    0  851 -10754.199 5175.72584   148%     -   13s
     0     0 5167.03839    0  861 -10754.199 5167.03839   148%     -   13s
     0     0 5166.42062    0  849 -10754.199 5166.42062   148%     -   13s
     0     0 3411.19016    0  763 -10754.199 3411.19016   132%     -   18s
     0     0 3127.01693    0  834 -10754.199 3127.01693   129%     -   19s
     0     0 3054.20955    0  824 -10754.199 3054.20955   128%     -   19s
     0     0 3030.12837    0  835 -10754.199 3030.12837   128%     -   20s
     0     0 3027.05646    0  842 -10754.199 3027.05646   128%     -   20s
     0     0 2353.41234    0  798 -10754.199 2353.41234   122%     -   22s
     0     0 2225.67969    0  678 -10754.199 2225.67969   121%     -   23s
     0     0 2185.62935    0  824 -10754.199 2185.62935   120%     -   24s
     0     0 2179.83880    0  694 -10754.199 2179.83880   120%     -   24s
     0     0 1945.74527    0  643 -10754.199 1945.74527   118%     -   26s
H    0     0                    -10414.51676 1945.63343   119%     -   26s
H    0     0                    -10381.69610 1945.63343   119%     -   26s
H    0     0                    -10320.09616 1945.63343   119%     -   26s
H    0     0                    -10318.72968 1945.63343   119%     -   26s
     0     0 1901.70918    0  685 -10318.730 1901.70918   118%     -   27s
     0     0 1885.06562    0  691 -10318.730 1885.06562   118%     -   27s
     0     0 1882.42643    0  696 -10318.730 1882.42643   118%     -   27s
     0     0 1679.06301    0  802 -10318.730 1679.06301   116%     -   29s
H    0     0                    -10282.00297 1678.66901   116%     -   29s
H    0     0                    -10274.39352 1678.66901   116%     -   29s
H    0     0                    -10238.19408 1678.66901   116%     -   29s
     0     0 1645.78343    0  819 -10238.194 1645.78343   116%     -   30s
     0     0 1633.57056    0  829 -10238.194 1633.57056   116%     -   30s
     0     0 1629.19294    0  832 -10238.194 1629.19294   116%     -   30s
     0     0 1530.24940    0  680 -10238.194 1530.24940   115%     -   32s
     0     0 1499.79362    0  693 -10238.194 1499.79362   115%     -   32s
     0     0 1495.84287    0  693 -10238.194 1495.84287   115%     -   33s
     0     0 1458.73155    0  664 -10238.194 1458.73155   114%     -   33s
H    0     0                    -9932.086111 1458.69869   115%     -   33s
H    0     0                    -9762.667772 1458.69869   115%     -   33s
H    0     0                    -9754.286450 1458.69869   115%     -   33s
     0     0 1438.99150    0  676 -9754.2864 1438.99150   115%     -   34s
     0     0 1435.63560    0  687 -9754.2864 1435.63560   115%     -   34s
     0     0 1397.78312    0  678 -9754.2864 1397.78312   114%     -   35s
     0     0 1397.69702    0  678 -9754.2864 1397.69702   114%     -   35s
H    0     0                    -9719.502583 1397.50786   114%     -   41s
H    0     0                    -9646.682743 1397.50786   114%     -   41s
H    0     0                    -9639.413101 1397.50786   114%     -   42s
     0     2 1397.50786    0  678 -9639.4131 1397.50786   114%     -   42s
     7    16  577.51774    3  429 -9639.4131  816.63932   108%  1567   45s
H   31    64                    -9623.733203  578.89966   106%  1124   48s
H   33    64                    -9154.611363  578.89966   106%  1101   48s
   137   189 -1164.4150    8  390 -9154.6114  556.51071   106%   765   51s
H  181   189                    -9154.163583  556.51071   106%   738   51s
H  213   219                    -9110.917291  556.51071   106%   737   52s
   307   342 -1378.5884    9  397 -9110.9173  556.51071   106%   704   55s
   783   692 -3716.0562   22  333 -9110.9173  472.15473   105%   518   60s
H 1063   887                    -9110.761563  174.64604   102%   469   64s
  1070   982 -5225.0838   27  301 -9110.7616  174.64604   102%   468   65s
H 1560  1226                    -9106.255306   33.26294   100%   406   68s
H 1578  1226                    -9102.006108   33.26294   100%   407   68s
H 1585  1226                    -8496.011432   33.26294   100%   407   68s
  1596  1279 -5622.4796    9  460 -8496.0114   33.26294   100%   407   70s
H 1862  1521                    -8192.686855  -17.26322   100%   391   72s
H 1897  1521                    -8087.429341  -17.26322   100%   390   72s
H 1900  1521                    -7969.660826  -17.26322   100%   390   72s
H 2214  1614                    -7437.714537  -82.92479  98.9%   376   74s
  2228  1674 -1264.1759    9  280 -7437.7145  -82.92479  98.9%   378   75s
  2710  1758 -3558.1913   16  270 -7437.7145 -306.76701  95.9%   373   81s
  3220  1877     cutoff   18      -7437.7145 -528.72815  92.9%   371   86s
H 3227  1742                    -6722.913584 -528.72815  92.1%   371   86s
H 3260  1742                    -6693.450356 -528.72815  92.1%   372   86s
H 3478  1728                    -6681.512706 -528.72815  92.1%   369   89s
H 3509  1728                    -6681.453247 -528.72815  92.1%   372   89s
  3523  1817 -2467.9776    9  458 -6681.4532 -528.72815  92.1%   372   91s
  3898  1995 -5906.1771   15  288 -6681.4532 -657.50480  90.2%   373   95s
  4545  2236 -6577.9944   44  678 -6681.4532 -799.93951  88.0%   364  121s
  4548  2238 -5808.9367   28  639 -6681.4532 -799.93951  88.0%   364  126s
  4551  2240 -3696.2001   11  654 -6681.4532 -799.93951  88.0%   364  130s
  4556  2243 -3361.3876   23  669 -6681.4532 -799.93951  88.0%   363  135s
  4562  2247 -5682.9209   35  677 -6681.4532 -799.93951  88.0%   363  140s
  4566  2250 -1928.3474    7  703 -6681.4532 -799.93951  88.0%   363  145s
  4571  2253 -4730.3536   38  706 -6681.4532 -799.93951  88.0%   362  150s
  4574  2255 -5871.6454   23  698 -6681.4532 -799.93951  88.0%   362  156s
  4576  2260 -799.93951   14  701 -6681.4532 -799.93951  88.0%   373  162s
  4582  2264 -1907.1222   16  688 -6681.4532 -799.93951  88.0%   375  167s
  4598  2288 -2840.0839   18  613 -6681.4532 -1054.6231  84.2%   382  171s
  4739  2338 -3539.7140   22  327 -6681.4532 -1927.1294  71.2%   405  176s
  4991  2269     cutoff   24      -6681.4532 -2305.8410  65.5%   418  181s
  5300  2150 -6596.7147   36   66 -6681.4532 -2511.5616  62.4%   423  185s
  5654  1951 -5349.8283   24  237 -6681.4532 -4233.1254  36.6%   420  190s
H 5789  1823                    -6677.218196 -5461.8294  18.2%   412  190s
H 6237  1670                    -6674.151068 -5582.7021  16.4%   383  192s
H 6248  1563                    -6665.577222 -5582.7021  16.2%   383  192s

Cutting planes:
  MIR: 347
  Flow cover: 801
  Zero half: 18
  RLT: 16
  Relax-and-lift: 60

Explored 7367 nodes (2463784 simplex iterations) in 193.06 seconds (426.56 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -6665.58 -6674.15 -6681.45 ... -8192.69
No other solutions better than -6665.58

Optimal solution found (tolerance 1.00e-04)
Best objective -6.665577222482e+03, best bound -6.665577222482e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 193.06s
  Master Objective (UB) = -6665.58, θ = 109035.09
  Upper Bound (UB) = -6665.58

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 109035.09
  [DEBUG]   ✓ Scenario 0: θ = 109035.09 ≤ Q = 109035.09 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 109035.09 ≤ Q = 109035.09 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x49a9bfbe
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x49a9bfbe
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.426517e+13
Presolve removed 2580 rows and 1874 columns
Presolve time: 0.00s
Presolved: 513 rows, 515 columns, 1446 nonzeros
Found heuristic solution: objective 8131001.1509
Variable types: 347 continuous, 168 integer (168 binary)

Root relaxation: objective -1.171451e+05, 256 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -117145.09    0  126 8131001.15 -117145.09   101%     -    0s
H    0     0                    -78694.73003 -117145.09  48.9%     -    0s
H    0     0                    -81460.96699 -117145.09  43.8%     -    0s
H    0     0                    -91604.85599 -117145.09  27.9%     -    0s
     0     0 -102956.86    0   57 -91604.856 -102956.86  12.4%     -    0s
H    0     0                    -101253.0561 -102868.29  1.60%     -    0s
     0     0 -102633.06    0   55 -101253.06 -102633.06  1.36%     -    0s
     0     0 -102615.82    0   55 -101253.06 -102615.82  1.35%     -    0s
     0     0 -102322.68    0   19 -101253.06 -102322.68  1.06%     -    0s
H    0     0                    -101834.9681 -102306.76  0.46%     -    0s
     0     0 -102179.47    0   21 -101834.97 -102179.47  0.34%     -    0s
     0     0 -102174.82    0   19 -101834.97 -102174.82  0.33%     -    0s
     0     0 -102120.43    0   23 -101834.97 -102120.43  0.28%     -    0s
     0     0 -102120.09    0   23 -101834.97 -102120.09  0.28%     -    0s
H    0     0                    -101974.9983 -102120.09  0.14%     -    0s
     0     0 -102105.60    0    6 -101975.00 -102105.60  0.13%     -    0s
     0     0 -102105.60    0   23 -101975.00 -102105.60  0.13%     -    0s
     0     0 -102105.60    0   23 -101975.00 -102105.60  0.13%     -    0s
     0     0 -102105.60    0   22 -101975.00 -102105.60  0.13%     -    0s
     0     0 -102056.21    0   11 -101975.00 -102056.21  0.08%     -    0s
H    0     0                    -101975.1471 -102052.14  0.08%     -    0s
     0     0 -102047.30    0    8 -101975.15 -102047.30  0.07%     -    0s
     0     0 -102037.13    0    7 -101975.15 -102037.13  0.06%     -    0s
H    0     0                    -102019.4799 -102032.79  0.01%     -    0s
H    0     0                    -102031.6271 -102032.79  0.00%     -    0s

Cutting planes:
  Gomory: 8
  Implied bound: 1
  MIR: 12
  Flow cover: 1
  Relax-and-lift: 1

Explored 1 nodes (729 simplex iterations) in 0.07 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -102032 -102019 -101975 ... -78694.7

Optimal solution found (tolerance 1.00e-04)
Best objective -1.020316270784e+05, best bound -1.020327899400e+05, gap 0.0011%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 84719.04
  Scenario: 23 demand increases, 37 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -102031.63
  [DEBUG]   S×d_nominal = 186750.67
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 186750.67 + -102031.63 = 84719.04
  [DEBUG]   Current θ from Master = 109035.09
  [DEBUG]   ⚠️  Z_SP ≤ θ by 24316.04 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -30981.62
  Lower Bound (LB) = -13018.71
  Gap (UB-LB) = 6353.1366, Absolute Gap = 6353.1366, Relative Gap = 0.953126
  Not converged yet (gap = 6353.14 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 23 increases, 37 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135248 nonzeros
Model fingerprint: 0xa9062777
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve produced solution with objective -30981.6 (0.02s)
MIP start from previous solve produced solution with objective -30981.6 (0.02s)
Loaded MIP start from previous solve with objective -30981.6

Presolve removed 20018 rows and 8128 columns
Presolve time: 0.41s
Presolved: 27235 rows, 12852 columns, 167609 nonzeros
Variable types: 10593 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   37246    6.9864823e+03   0.000000e+00   8.496517e+05      5s
Concurrent spin time: 0.01s

Solved with dual simplex

Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   24021    1.0729908e+04   0.000000e+00   0.000000e+00      7s

Root relaxation: objective 1.072991e+04, 24021 iterations, 6.81 seconds (13.35 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 10729.9077    0  378 -30981.619 10729.9077   135%     -    7s
H    0     0                    -27695.66176 10729.9077   139%     -    7s
H    0     0                    -27369.21922 10729.9077   139%     -    7s
H    0     0                    -19443.14859 6306.86682   132%     -   10s
H    0     0                    -19343.37101 6306.86682   133%     -   10s
     0     0 6306.86682    0  379 -19343.371 6306.86682   133%     -   10s
     0     0 5953.67335    0  475 -19343.371 5953.67335   131%     -   12s
     0     0 5782.18583    0  557 -19343.371 5782.18583   130%     -   12s
     0     0 5781.88514    0  591 -19343.371 5781.88514   130%     -   13s
     0     0 5781.88514    0  594 -19343.371 5781.88514   130%     -   13s
     0     0 5781.88514    0  595 -19343.371 5781.88514   130%     -   13s
H    0     0                    -19305.35221 4064.86139   121%     -   16s
     0     0 4043.49035    0  651 -19305.352 4043.49035   121%     -   16s
H    0     0                    -10886.32482 4043.49035   137%     -   16s
H    0     0                    -10606.07856 4043.49035   138%     -   16s
     0     0 3763.51063    0  613 -10606.079 3763.51063   135%     -   17s
     0     0 3669.61113    0  620 -10606.079 3669.61113   135%     -   18s
     0     0 3645.35109    0  606 -10606.079 3645.35109   134%     -   18s
     0     0 3638.62124    0  615 -10606.079 3638.62124   134%     -   18s
     0     0 3638.55831    0  615 -10606.079 3638.55831   134%     -   18s
     0     0 2676.13519    0  679 -10606.079 2676.13519   125%     -   23s
     0     0 2517.49117    0  638 -10606.079 2517.49117   124%     -   24s
     0     0 2494.26280    0  647 -10606.079 2494.26280   124%     -   24s
     0     0 2483.16085    0  649 -10606.079 2483.16085   123%     -   25s
     0     0 2478.25178    0  651 -10606.079 2478.25178   123%     -   25s
     0     0 2477.90614    0  653 -10606.079 2477.90614   123%     -   25s
     0     0 1967.38144    0  648 -10606.079 1967.38144   119%     -   30s
H    0     0                    -8226.061880 1967.30310   124%     -   30s
H    0     0                    -8080.467680 1967.30310   124%     -   30s
H    0     0                    -8080.324362 1967.30310   124%     -   30s
H    0     0                    -8072.250375 1967.30310   124%     -   30s
H    0     0                    -8067.709410 1967.30310   124%     -   30s
H    0     0                    -8066.354285 1967.30310   124%     -   30s
H    0     0                    -8060.163019 1967.30310   124%     -   30s
H    0     0                    -8054.440485 1967.30310   124%     -   30s
H    0     0                    -8048.895447 1967.30310   124%     -   30s
     0     0 1789.58238    0  643 -8048.8954 1789.58238   122%     -   32s
     0     0 1751.49395    0  658 -8048.8954 1751.49395   122%     -   32s
     0     0 1744.07312    0  653 -8048.8954 1744.07312   122%     -   33s
     0     0 1741.46692    0  659 -8048.8954 1741.46692   122%     -   33s
     0     0 1741.18552    0  660 -8048.8954 1741.18552   122%     -   33s
     0     0 1622.40713    0  656 -8048.8954 1622.40713   120%     -   34s
H    0     0                    -8032.944553 1622.37353   120%     -   34s
     0     0 1594.37049    0  658 -8032.9446 1594.37049   120%     -   35s
     0     0 1585.54682    0  662 -8032.9446 1585.54682   120%     -   35s
     0     0 1583.65471    0  665 -8032.9446 1583.65471   120%     -   35s
     0     0 1581.99395    0  670 -8032.9446 1581.99395   120%     -   36s
     0     0 1581.77691    0  666 -8032.9446 1581.77691   120%     -   36s
     0     0 1505.95281    0  675 -8032.9446 1505.95281   119%     -   37s
H    0     0                    -8007.816554 1505.89219   119%     -   37s
H    0     0                    -8004.241905 1505.89219   119%     -   37s
H    0     0                    -7998.669649 1505.89219   119%     -   37s
H    0     0                    -7998.634447 1505.89219   119%     -   37s
H    0     0                    -7981.064737 1505.89219   119%     -   37s
H    0     0                    -7979.963889 1505.89219   119%     -   37s
     0     0 1474.52257    0  724 -7979.9639 1474.52257   118%     -   38s
     0     0 1466.01487    0  674 -7979.9639 1466.01487   118%     -   38s
H    0     0                    -7978.785575 1463.63402   118%     -   38s
H    0     0                    -7907.977340 1463.63402   119%     -   38s
H    0     0                    -7904.376198 1463.63402   119%     -   38s
H    0     0                    -7807.230882 1463.63402   119%     -   38s
     0     0 1463.63402    0  680 -7807.2309 1463.63402   119%     -   38s
     0     0 1463.07592    0  724 -7807.2309 1463.07592   119%     -   39s
     0     0 1424.46762    0  723 -7807.2309 1424.46762   118%     -   40s
     0     0 1400.18994    0  675 -7807.2309 1400.18994   118%     -   41s
     0     0 1394.01452    0  698 -7807.2309 1394.01452   118%     -   41s
     0     0 1390.92219    0  702 -7807.2309 1390.92219   118%     -   42s
     0     0 1389.59521    0  704 -7807.2309 1389.59521   118%     -   42s
H    0     0                    -7800.322330 1361.04100   117%     -   43s
H    0     0                    -7796.677491 1361.04100   117%     -   43s
     0     0 1361.04100    0  684 -7796.6775 1361.04100   117%     -   43s
H    0     0                    -7778.032259 1361.01817   117%     -   43s
     0     0 1350.49705    0  705 -7778.0323 1350.49705   117%     -   44s
     0     0 1347.54977    0  692 -7778.0323 1347.54977   117%     -   44s
     0     0 1346.46866    0  697 -7778.0323 1346.46866   117%     -   44s
     0     0 1325.94155    0  690 -7778.0323 1325.94155   117%     -   45s
     0     0 1321.63259    0  698 -7778.0323 1321.63259   117%     -   45s
     0     0 1319.80175    0  707 -7778.0323 1319.80175   117%     -   46s
     0     0 1319.74153    0  706 -7778.0323 1319.74153   117%     -   46s
     0     0 1313.10711    0  757 -7778.0323 1313.10711   117%     -   47s
     0     0 1311.10583    0  707 -7778.0323 1311.10583   117%     -   47s
     0     0 1311.06735    0  708 -7778.0323 1311.06735   117%     -   47s
     0     0 1295.83882    0  701 -7778.0323 1295.83882   117%     -   48s
     0     0 1288.47196    0  717 -7778.0323 1288.47196   117%     -   49s
     0     0 1286.75048    0  721 -7778.0323 1286.75048   117%     -   49s
     0     0 1286.30100    0  731 -7778.0323 1286.30100   117%     -   49s
     0     0 1280.44587    0  709 -7778.0323 1280.44587   116%     -   50s
     0     0 1277.44467    0  716 -7778.0323 1277.44467   116%     -   51s
     0     0 1277.28566    0  713 -7778.0323 1277.28566   116%     -   51s
     0     0 1274.34299    0  713 -7778.0323 1274.34299   116%     -   51s
     0     0 1273.71884    0  716 -7778.0323 1273.71884   116%     -   52s
     0     0 1271.23978    0  714 -7778.0323 1271.23978   116%     -   52s
     0     0 1271.20746    0  714 -7778.0323 1271.20746   116%     -   53s
H    0     0                    -7716.738229 1271.12985   116%     -   65s
H    0     0                    -7714.313489 1271.12985   116%     -   65s
H    0     0                    -7700.475457 1271.12985   117%     -   65s
H    0     0                    -7687.325881 1271.12985   117%     -   65s
H    0     0                    -7684.577646 1271.12985   117%     -   65s
H    0     0                    -7654.726652 1271.12985   117%     -   65s
     0     2 1271.12985    0  714 -7654.7267 1271.12985   117%     -   66s
     3     8  922.11334    2  774 -7654.7267 1054.18829   114%  2127   72s
    15    30  716.05129    4  789 -7654.7267  850.96332   111%  1690   77s
    31    58  650.98338    5  789 -7654.7267  715.32872   109%  2718   80s
H   70    90                    -7396.048475  649.77017   109%  1826   84s
    93   121  530.29355    7  752 -7396.0485  629.12138   109%  1673   86s
H   94   121                    -7378.017272  629.12138   109%  1655   86s
H   95   121                    -7332.393394  629.12138   109%  1642   86s
H   98   121                    -7225.936180  629.12138   109%  1641   86s
   166   190  452.82827    9  690 -7225.9362  629.12138   109%  1195   90s
   278   296  215.83101   11  682 -7225.9362  629.12138   109%  1015   97s
   346   342 -1313.0843   11  413 -7225.9362  629.12138   109%   975  101s
   443   430 -1647.2654   12  626 -7225.9362  512.74392   107%  1027  110s
   587   528 -1665.0508   13  554 -7225.9362  512.74392   107%   977  117s
   660   573 -1335.6607   14  806 -7225.9362  512.74392   107%   975  120s
   724   619 -2607.1138   14  574 -7225.9362  512.74392   107%   966  125s
   886   727 -2412.6573   16  749 -7225.9362  397.79129   106%   934  133s
   976   789 -2585.9512   16  633 -7225.9362  397.79129   106%   911  137s
  1075   843 -2421.8893   17  690 -7225.9362  397.79129   106%   887  143s
  1164   888 -3158.2278   18  617 -7225.9362  226.09889   103%   880  146s
  1261   901 -4016.5379   19  613 -7225.9362  226.09889   103%   868  152s
H 1269   901                    -7224.695452  226.09889   103%   865  152s
H 1273   901                    -7221.708808  226.09889   103%   866  152s
H 1286   901                    -7214.998448  137.95426   102%   873  152s
H 1310   901                    -7211.347743 -321.42818  95.5%   876  152s
  1317   961 -3989.6866   19  586 -7211.3477 -321.42818  95.5%   876  157s
  1419  1015 -5490.8273   20  587 -7211.3477 -335.28006  95.4%   868  161s
  1515  1070 -5564.7035   20  518 -7211.3477 -416.86267  94.2%   867  165s
  1638  1146 -6140.5116   21  507 -7211.3477 -416.86267  94.2%   858  170s
H 1805  1190                    -7111.458579 -416.86267  94.1%   847  174s
  1846  1265 -6522.5131   24  527 -7111.4586 -416.86267  94.1%   843  177s
  1971  1332     cutoff   26      -7111.4586 -416.86267  94.1%   840  184s
  2088  1355 -1577.8906   11  349 -7111.4586 -416.86267  94.1%   835  186s
H 2096  1355                    -7101.209447 -416.86267  94.1%   834  186s
  2129  1448 -1934.2665   12  400 -7101.2094 -416.86267  94.1%   838  191s
  2319  1517 -2500.4812   14  219 -7101.2094 -416.86267  94.1%   819  197s
  2473  1596 -3325.7794   18  428 -7101.2094 -737.79436  89.6%   819  203s
H 2615  1596                    -7095.085848 -737.79436  89.6%   811  203s
  2660  1649 -4519.6218   26  177 -7095.0858 -737.79436  89.6%   810  207s
H 2735  1649                    -7094.424110 -737.79436  89.6%   807  207s
  2774  1723 -4666.9093   27  172 -7094.4241 -737.79436  89.6%   802  211s
  2960  1771 -5230.2968   35  186 -7094.4241 -804.26021  88.7%   798  215s
  3095  1830 -5607.3704   41  353 -7094.4241 -804.26021  88.7%   794  221s
  3257  1913 -6619.4172   51  207 -7094.4241 -892.62016  87.4%   792  226s
  3455  1975 -4354.7502   11  556 -7094.4241 -933.22709  86.8%   790  231s
  3604  2015 -5318.3747   15  415 -7094.4241 -1158.7322  83.7%   798  235s
  3692  2077 -6242.7985   17  269 -7094.4241 -1158.7322  83.7%   802  240s
  3903  2188 -2376.5489   11  470 -7094.4241 -1158.7322  83.7%   797  248s
  4120  2309 -4507.6931   14  350 -7094.4241 -1210.2952  82.9%   789  253s
  4351  2423 -5372.7547   21  357 -7094.4241 -1227.3660  82.7%   788  259s
  4591  2424 -3264.5546   20  714 -7094.4241 -1296.3540  81.7%   788  315s
  4593  2425 -6698.6942   21  378 -7094.4241 -1296.3540  81.7%   788  325s
  4594  2426 -6023.0639   26  685 -7094.4241 -1296.3540  81.7%   788  332s
  4595  2427 -6397.0617   55  624 -7094.4241 -1296.3540  81.7%   788  336s
  4597  2428 -5337.2194   21  719 -7094.4241 -1296.3540  81.7%   787  340s
  4602  2431 -7023.9398   70  711 -7094.4241 -1296.3540  81.7%   786  349s
  4603  2432 -4090.4996   23  708 -7094.4241 -1296.3540  81.7%   786  350s
  4606  2434 -4821.6350   16  714 -7094.4241 -1296.3540  81.7%   786  355s
  4610  2437 -5260.0272   19  767 -7094.4241 -1296.3540  81.7%   785  361s
  4614  2439 -5506.9740   40  705 -7094.4241 -1296.3540  81.7%   784  367s
  4615  2440 -6012.8539   11  705 -7094.4241 -1296.3540  81.7%   784  377s
  4616  2441 -2989.7742   18  705 -7094.4241 -1296.3540  81.7%   784  384s
  4617  2444 -1296.3540   12  688 -7094.4241 -1296.3540  81.7%   798  390s
  4619  2448 -1296.3540   13  598 -7094.4241 -1296.3540  81.7%   799  395s
  4623  2452 -1296.3540   14  584 -7094.4241 -1296.3540  81.7%   800  400s
  4631  2464 -2847.4042   15  695 -7094.4241 -1296.3540  81.7%   802  405s
  4645  2473     cutoff   16      -7094.4241 -1296.3540  81.7%   814  411s
  4673  2490 -1296.3540   17  673 -7094.4241 -1296.3540  81.7%   826  418s
  4705  2507 -1296.3540   18  587 -7094.4241 -1296.3540  81.7%   842  424s
  4739  2538 -1301.6246   19  616 -7094.4241 -1296.3540  81.7%   861  430s
  4796  2553 -1720.7601   20  656 -7094.4241 -1296.3540  81.7%   867  435s
  4938  2549 -3944.2805   22  547 -7094.4241 -1296.3540  81.7%   878  447s
  5022  2539 -4014.6104   23  464 -7094.4241 -1296.3540  81.7%   883  451s
  5150  2548 -5492.8701   25  522 -7094.4241 -1296.3540  81.7%   889  460s
  5233  2541 -6415.2125   26  458 -7094.4241 -1296.3540  81.7%   888  465s
  5318  2538 -6313.3016   25  447 -7094.4241 -1296.3540  81.7%   887  470s
  5473  2528 -6485.0560   26  439 -7094.4241 -1721.1637  75.7%   888  478s
  5548  2526 -6593.2540   28  253 -7094.4241 -1721.1637  75.7%   888  484s
  5634  2512 -6670.7870   30  261 -7094.4241 -2332.6003  67.1%   889  488s
  5706  2509     cutoff   31      -7094.4241 -2332.6003  67.1%   891  491s
  5801  2476     cutoff   31      -7094.4241 -3355.1791  52.7%   891  498s
  5912  2438     cutoff   29      -7094.4241 -3466.4261  51.1%   893  502s
  6014  2398 -5543.7116   21  309 -7094.4241 -3583.5552  49.5%   896  509s
  6127  2377 -6436.9746   22  308 -7094.4241 -3823.6501  46.1%   895  517s
  6242  2319     cutoff   25      -7094.4241 -3823.6501  46.1%   896  524s
  6380  2251 infeasible   23      -7094.4241 -4052.6536  42.9%   894  530s
  6558  2171 -5539.6533   23  600 -7094.4241 -4052.6536  42.9%   888  538s
  6722  2104 -5762.5148   24  543 -7094.4241 -4314.3523  39.2%   882  541s
  6885  2023 -6131.1298   26  544 -7094.4241 -4603.3275  35.1%   880  549s
  7036  1916 -6473.2850   27  523 -7094.4241 -4713.9154  33.6%   875  554s
  7230  1778     cutoff   28      -7094.4241 -4773.5762  32.7%   866  559s
  7478  1649     cutoff   48      -7094.4241 -4988.8117  29.7%   850  563s
  7759  1471 -7085.0642   71   48 -7094.4241 -5459.9747  23.0%   829  566s
  8404  1274 -6914.4151   58   74 -7094.4241 -6276.1732  11.5%   771  571s
 10211  1009     cutoff   75      -7094.4241 -7009.7132  1.19%   638  575s
*13189    92              85    -7094.269883 -7072.3551  0.31%   497  577s
*13291    92              94    -7092.363237 -7073.1631  0.27%   494  577s
*13616     0              91    -7091.355186 -7088.3171  0.04%   482  577s

Cutting planes:
  Learned: 1
  MIR: 481
  Flow cover: 1377
  Zero half: 18
  RLT: 24
  Relax-and-lift: 109

Explored 13625 nodes (6628859 simplex iterations) in 577.29 seconds (1399.60 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -7091.36 -7092.36 -7094.27 ... -7221.71
No other solutions better than -7091.36

Optimal solution found (tolerance 1.00e-04)
Best objective -7.091355186324e+03, best bound -7.091355186324e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 577.30s
  Master Objective (UB) = -7091.36, θ = 107978.35
  Upper Bound (UB) = -7091.36

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 107978.35
  [DEBUG]   ✓ Scenario 0: θ = 107978.35 ≤ Q = 107978.35 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 107978.35 ≤ Q = 107978.35 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 107978.35 ≤ Q = 107978.35 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x7728cf35
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x7728cf35
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [9e-17, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-19, 2e+02]
Found heuristic solution: objective 1.431975e+13
Presolve removed 2580 rows and 1874 columns
Presolve time: 0.00s
Presolved: 513 rows, 515 columns, 1446 nonzeros
Found heuristic solution: objective 8152007.3788
Variable types: 347 continuous, 168 integer (168 binary)

Root relaxation: objective -1.100568e+05, 253 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -110056.78    0  124 8152007.38 -110056.78   101%     -    0s
H    0     0                    -75697.85817 -110056.78  45.4%     -    0s
H    0     0                    -77073.90448 -110056.78  42.8%     -    0s
H    0     0                    -87140.41620 -110056.78  26.3%     -    0s
H    0     0                    -93330.07561 -110056.78  17.9%     -    0s
     0     0 -101928.61    0  128 -93330.076 -101928.61  9.21%     -    0s
H    0     0                    -99197.70222 -101915.72  2.74%     -    0s
     0     0 -101488.13    0  123 -99197.702 -101488.13  2.31%     -    0s
H    0     0                    -100111.2026 -101410.53  1.30%     -    0s
     0     0 -101410.53    0  124 -100111.20 -101410.53  1.30%     -    0s
     0     0 -100990.24    0   86 -100111.20 -100990.24  0.88%     -    0s
     0     0 -100897.48    0   53 -100111.20 -100897.48  0.79%     -    0s
     0     0 -100892.72    0   60 -100111.20 -100892.72  0.78%     -    0s
     0     0 -100676.06    0   53 -100111.20 -100676.06  0.56%     -    0s
     0     0 -100671.27    0   53 -100111.20 -100671.27  0.56%     -    0s
     0     0 -100603.70    0   46 -100111.20 -100603.70  0.49%     -    0s
     0     0 -100595.32    0   38 -100111.20 -100595.32  0.48%     -    0s
     0     0 -100474.34    0   32 -100111.20 -100474.34  0.36%     -    0s
H    0     0                    -100158.4882 -100456.12  0.30%     -    0s
     0     0 -100456.12    0   32 -100158.49 -100456.12  0.30%     -    0s
     0     0 -100397.52    0   24 -100158.49 -100397.52  0.24%     -    0s
     0     0 -100363.62    0   20 -100158.49 -100363.62  0.20%     -    0s
     0     0 -100363.62    0   29 -100158.49 -100363.62  0.20%     -    0s
     0     0 -100363.62    0   29 -100158.49 -100363.62  0.20%     -    0s
H    0     0                    -100176.0094 -100353.25  0.18%     -    0s
     0     0 -100353.25    0   12 -100176.01 -100353.25  0.18%     -    0s
     0     0 -100229.03    0   11 -100176.01 -100229.03  0.05%     -    0s
     0     0 -100227.93    0   10 -100176.01 -100227.93  0.05%     -    0s
H    0     0                    -100183.9426 -100227.93  0.04%     -    0s
     0     0          -    0      -100183.94 -100193.20  0.01%     -    0s

Cutting planes:
  Gomory: 11
  Implied bound: 9
  MIR: 8
  Flow cover: 18
  RLT: 4
  Relax-and-lift: 3

Explored 1 nodes (1327 simplex iterations) in 0.08 seconds (0.07 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -100184 -100176 -100158 ... -75697.9

Optimal solution found (tolerance 1.00e-04)
Best objective -1.001839426420e+05, best bound -1.001932008036e+05, gap 0.0092%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 86856.28
  Scenario: 60 demand increases, 0 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -100183.94
  [DEBUG]   S×d_nominal = 187040.22
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 187040.22 + -100183.94 = 86856.28
  [DEBUG]   Current θ from Master = 107978.35
  [DEBUG]   ⚠️  Z_SP ≤ θ by 21122.08 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -28213.43
  Lower Bound (LB) = -13018.71
  Gap (UB-LB) = 5927.3587, Absolute Gap = 5927.3587, Relative Gap = 0.835857
  Not converged yet (gap = 5927.36 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 60 increases, 0 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178491 nonzeros
Model fingerprint: 0xc3295258
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve produced solution with objective -28213.4 (0.05s)
MIP start from previous solve produced solution with objective -28213.4 (0.05s)
Loaded MIP start from previous solve with objective -28213.4

Presolve removed 26684 rows and 10834 columns
Presolve time: 0.54s
Presolved: 35859 rows, 16386 columns, 221659 nonzeros
Variable types: 14127 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 35859 rows, 16386 columns, 221659 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   33728    2.3990258e+03   0.000000e+00   1.935724e+06      5s
   43571    5.2988973e+03   0.000000e+00   2.882950e+06     10s
Concurrent spin time: 3.44s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 8.091907e+03, 34519 iterations, 12.08 seconds (21.99 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 8091.90663    0  450 -28213.434 8091.90663   129%     -   12s
H    0     0                    -27105.26076 8091.90663   130%     -   13s
H    0     0                    -20905.96394 8091.90663   139%     -   13s
H    0     0                    -20841.83569 8091.90663   139%     -   13s
H    0     0                    -20834.71069 8091.90663   139%     -   13s
     0     0 3330.30540    0  467 -20834.711 3330.30540   116%     -   20s
H    0     0                    -17586.40049 3330.30540   119%     -   20s
H    0     0                    -17559.28769 3330.30540   119%     -   20s
     0     0 2887.95179    0  434 -17559.288 2887.95179   116%     -   23s
     0     0 2887.95179    0  437 -17559.288 2887.95179   116%     -   24s
     0     0 2887.95179    0  439 -17559.288 2887.95179   116%     -   24s
     0     0 2887.95179    0  442 -17559.288 2887.95179   116%     -   24s
     0     0 1232.01567    0  521 -17559.288 1232.01567   107%     -   30s
H    0     0                    -17534.76068 1230.45572   107%     -   30s
H    0     0                    -17421.66377 1230.45572   107%     -   30s
H    0     0                    -17416.33505 1230.45572   107%     -   31s
H    0     0                    -17410.26760 1230.45572   107%     -   31s
     0     0 1141.62487    0  614 -17410.268 1141.62487   107%     -   32s
     0     0  994.99500    0  624 -17410.268  994.99500   106%     -   34s
     0     0  987.59795    0  634 -17410.268  987.59795   106%     -   34s
     0     0  933.55102    0  619 -17410.268  933.55102   105%     -   35s
     0     0  923.62927    0  626 -17410.268  923.62927   105%     -   35s
     0     0  914.59786    0  635 -17410.268  914.59786   105%     -   35s
     0     0  913.77355    0  630 -17410.268  913.77355   105%     -   35s
     0     0  913.77355    0  630 -17410.268  913.77355   105%     -   35s
H    0     0                    -12884.34179  -22.91592   100%     -   46s
     0     0  -22.91592    0  597 -12884.342  -22.91592   100%     -   46s
H    0     0                    -12312.79393  -23.72138   100%     -   46s
H    0     0                    -11919.23639  -23.72138   100%     -   46s
H    0     0                    -11784.20216  -23.72138   100%     -   46s
H    0     0                    -11568.35074 -436.12605  96.2%     -   50s
H    0     0                    -11549.50595 -436.12605  96.2%     -   50s
H    0     0                    -11473.56855 -436.12605  96.2%     -   50s
     0     0 -436.12605    0  590 -11473.569 -436.12605  96.2%     -   50s
     0     0 -526.91349    0  597 -11473.569 -526.91349  95.4%     -   52s
     0     0 -558.05135    0  600 -11473.569 -558.05135  95.1%     -   52s
     0     0 -563.86058    0  609 -11473.569 -563.86058  95.1%     -   53s
     0     0 -566.41285    0  608 -11473.569 -566.41285  95.1%     -   53s
     0     0 -566.51401    0  611 -11473.569 -566.51401  95.1%     -   53s
     0     0 -933.23461    0  633 -11473.569 -933.23461  91.9%     -   62s
     0     0 -1172.4155    0  610 -11473.569 -1172.4155  89.8%     -   66s
     0     0 -1245.3458    0  629 -11473.569 -1245.3458  89.1%     -   67s
     0     0 -1299.9101    0  693 -11473.569 -1299.9101  88.7%     -   68s
     0     0 -1333.3344    0  653 -11473.569 -1333.3344  88.4%     -   69s
     0     0 -1345.5702    0  643 -11473.569 -1345.5702  88.3%     -   70s
     0     0 -1347.8382    0  657 -11473.569 -1347.8382  88.3%     -   70s
     0     0 -1353.7855    0  650 -11473.569 -1353.7855  88.2%     -   71s
     0     0 -1358.5423    0  652 -11473.569 -1358.5423  88.2%     -   71s
     0     0 -1359.7739    0  647 -11473.569 -1359.7739  88.1%     -   71s
     0     0 -1473.6925    0  668 -11473.569 -1473.6925  87.2%     -   74s
H    0     0                    -11465.10138 -1506.5515  86.9%     -   76s
H    0     0                    -11463.94186 -1506.5515  86.9%     -   76s
H    0     0                    -11456.73262 -1506.5515  86.9%     -   76s
     0     0 -1506.5515    0  675 -11456.733 -1506.5515  86.9%     -   76s
     0     0 -1526.4152    0  755 -11456.733 -1526.4152  86.7%     -   77s
H    0     0                    -11410.83025 -1541.5798  86.5%     -   77s
H    0     0                    -11402.46148 -1541.5798  86.5%     -   77s
     0     0 -1541.5798    0  685 -11402.461 -1541.5798  86.5%     -   77s
     0     0 -1544.1992    0  698 -11402.461 -1544.1992  86.5%     -   77s
     0     0 -1545.3837    0  696 -11402.461 -1545.3837  86.4%     -   78s
     0     0 -1599.4846    0  716 -11402.461 -1599.4846  86.0%     -   80s
     0     0 -1629.4894    0  672 -11402.461 -1629.4894  85.7%     -   82s
     0     0 -1635.5228    0  666 -11402.461 -1635.5228  85.7%     -   82s
     0     0 -1639.5648    0  681 -11402.461 -1639.5648  85.6%     -   82s
     0     0 -1639.8786    0  688 -11402.461 -1639.8786  85.6%     -   83s
     0     0 -1686.9925    0  716 -11402.461 -1686.9925  85.2%     -   85s
     0     0 -1692.6202    0  679 -11402.461 -1692.6202  85.2%     -   85s
     0     0 -1694.1675    0  687 -11402.461 -1694.1675  85.1%     -   86s
     0     0 -1694.4395    0  694 -11402.461 -1694.4395  85.1%     -   86s
H    0     0                    -11324.17079 -1714.8485  84.9%     -   87s
H    0     0                    -11303.45365 -1714.8485  84.8%     -   87s
H    0     0                    -11263.47471 -1714.8485  84.8%     -   87s
H    0     0                    -11247.72419 -1714.8485  84.8%     -   87s
H    0     0                    -11240.88106 -1714.8485  84.7%     -   87s
H    0     0                    -11238.80733 -1714.8485  84.7%     -   87s
     0     0 -1714.8485    0  709 -11238.807 -1714.8485  84.7%     -   87s
H    0     0                    -11204.12080 -1715.1252  84.7%     -   88s
H    0     0                    -11164.98322 -1715.1252  84.6%     -   88s
H    0     0                    -11164.86372 -1715.1252  84.6%     -   88s
     0     0 -1720.5303    0  713 -11164.864 -1720.5303  84.6%     -   88s
     0     0 -1725.1717    0  721 -11164.864 -1725.1717  84.5%     -   89s
     0     0 -1726.4722    0  729 -11164.864 -1726.4722  84.5%     -   89s
     0     0 -1734.1000    0  743 -11164.864 -1734.1000  84.5%     -   90s
H    0     0                    -10826.61342 -1734.1884  84.0%     -   90s
H    0     0                    -10704.20391 -1734.1884  83.8%     -   90s
H    0     0                    -10647.73749 -1734.1884  83.7%     -   90s
H    0     0                    -10605.77057 -1734.1884  83.6%     -   90s
     0     0 -1735.8693    0  704 -10605.771 -1735.8693  83.6%     -   91s
     0     0 -1736.7728    0  707 -10605.771 -1736.7728  83.6%     -   91s
     0     0 -1741.4651    0  693 -10605.771 -1741.4651  83.6%     -   92s
H    0     0                    -10604.29657 -1741.8514  83.6%     -   93s
H    0     0                    -10600.20109 -1741.8514  83.6%     -   93s
     0     0 -1743.4263    0  697 -10600.201 -1743.4263  83.6%     -   93s
     0     0 -1743.9211    0  749 -10600.201 -1743.9211  83.5%     -   93s
     0     0 -1751.7999    0  745 -10600.201 -1751.7999  83.5%     -   95s
     0     0 -1752.0376    0  745 -10600.201 -1752.0376  83.5%     -   96s
H    0     0                    -10553.40650 -1752.0376  83.4%     -  110s
     0     2 -1752.0376    0  745 -10553.407 -1752.0376  83.4%     -  110s
     7    16 -2100.3544    3  766 -10553.407 -1843.6449  82.5%  2339  118s
    15    32 -2122.8929    4  775 -10553.407 -2101.4472  80.1%  2542  125s
    31    64 -2213.0033    5  725 -10553.407 -2123.1553  79.9%  3986  131s
H   32    64                    -10531.85864 -2123.1553  79.8%  3861  131s
H   33    64                    -10517.32324 -2123.1553  79.8%  3777  131s
H   40    64                    -10507.12459 -2123.1553  79.8%  3359  131s
    95   157 -2305.3195    7  721 -10507.125 -2213.1148  78.9%  2512  135s
   231   270 -2460.2188    9  633 -10507.125 -2213.1148  78.9%  1635  143s
   296   318 -2492.6496   10  660 -10507.125 -2251.5773  78.6%  1619  147s
   358   366 -2961.4539   10  620 -10507.125 -2251.5773  78.6%  1598  153s
   421   404 -2602.3081   11  699 -10507.125 -2251.5773  78.6%  1620  159s
   484   452 -3899.8309   10  673 -10507.125 -2251.5773  78.6%  1655  165s
   541   507 -2716.4331   12  660 -10507.125 -2274.7878  78.4%  1661  170s
   604   561 -3091.1652   13  598 -10507.125 -2274.7878  78.4%  1659  175s
   677   584 -3500.8035   14  584 -10507.125 -2274.7878  78.4%  1612  181s
   736   618 -3946.2216   15  390 -10507.125 -2274.7878  78.4%  1629  187s
   787   666 -4526.0062   16  457 -10507.125 -2339.8004  77.7%  1637  192s
   843   698 -5649.8443   16  452 -10507.125 -2339.8004  77.7%  1636  196s
   918   716 -6661.3325   17  493 -10507.125 -2339.8004  77.7%  1598  203s
   975   738 -4998.8376   17  525 -10507.125 -2339.8004  77.7%  1606  207s
H 1022   738                    -10426.86574 -2339.8004  77.6%  1611  207s
  1034   762 -6250.2540   18  506 -10426.866 -2339.8004  77.6%  1613  214s
H 1042   762                    -10409.89580 -2339.8004  77.5%  1605  214s
H 1067   762                    -10347.29206 -2339.8004  77.4%  1585  214s
  1108   796 -7154.0288   19  500 -10347.292 -2339.8004  77.4%  1600  219s
  1199   827 -9888.8112   19  416 -10347.292 -2495.1707  75.9%  1578  225s
  1252   862 -9006.8504   20  382 -10347.292 -2495.1707  75.9%  1577  230s
  1420   931 infeasible   28      -10347.292 -2733.3952  73.6%  1537  240s
H 1447   931                    -10344.83596 -2733.3952  73.6%  1532  240s
  1478   979 -6598.7431   13  407 -10344.836 -2733.3952  73.6%  1534  245s
  1574  1004 -9542.8152   15  315 -10344.836 -2733.3952  73.6%  1529  253s
H 1575  1004                    -10296.57574 -2733.3952  73.5%  1528  253s
H 1593  1004                    -10288.91203 -2733.3952  73.4%  1536  253s
  1611  1072 -10231.192   16  301 -10288.912 -2733.3952  73.4%  1540  258s
  1726  1117 -4933.1084    8  532 -10288.912 -2753.1258  73.2%  1518  265s
  1952  1175 -5575.4909   10  473 -10288.912 -2799.6381  72.8%  1465  278s
  2101  1202 -6467.0598   11  530 -10288.912 -2939.7670  71.4%  1442  284s
  2188  1231 -6889.8122   12  523 -10288.912 -3045.6821  70.4%  1443  292s
  2306  1289 -7391.5724   14  504 -10288.912 -3045.6821  70.4%  1435  299s
  2438  1311 -8801.3813   19  322 -10288.912 -3045.6821  70.4%  1434  307s
  2612  1349 -8763.1351   12  111 -10288.912 -3045.6821  70.4%  1420  316s
  2733  1387     cutoff   22      -10288.912 -3127.2800  69.6%  1434  324s
  2884  1432 -7558.5002   15  515 -10288.912 -3127.2800  69.6%  1430  331s
  3066  1486 -8988.2258   18  324 -10288.912 -3385.4740  67.1%  1423  340s
  3238  1521 -6589.3057   12  276 -10288.912 -3511.6944  65.9%  1427  347s
  3405  1569 -8390.5097   15  187 -10288.912 -3511.6944  65.9%  1411  355s
  3621  1596 -9789.6352   18  281 -10288.912 -3511.6944  65.9%  1400  362s
  3683  1628 -10107.074   19  139 -10288.912 -3511.6944  65.9%  1399  372s
  3871  1686 -6474.7480    9  601 -10288.912 -3511.6944  65.9%  1390  380s
  4079  1709 -9761.6412   12  219 -10288.912 -3659.4080  64.4%  1388  385s
  4120  1728 infeasible   13      -10288.912 -3802.7809  63.0%  1391  393s
  4219  1753     cutoff   13      -10288.912 -3802.7809  63.0%  1392  402s
  4469  1761 -7571.0949   13  414 -10288.912 -3922.8845  61.9%  1378  412s
  4705  1789     cutoff   23      -10288.912 -3940.7430  61.7%  1382  423s
  4949  1838 -5918.4588    9  464 -10288.912 -3953.2123  61.6%  1386  436s
  5215  1914 -7526.6274   13  414 -10288.912 -4130.1894  59.9%  1382  445s
  5519  1978 -9471.1967   24  374 -10288.912 -4244.2469  58.7%  1373  456s
  5857  2028     cutoff   12      -10288.912 -4247.5510  58.7%  1363  466s
  6150  2048 infeasible   12      -10288.912 -4398.5780  57.2%  1364  478s
  6479  2090     cutoff   19      -10288.912 -4541.7942  55.9%  1363  490s
  6794  2120     cutoff   13      -10288.912 -4584.5754  55.4%  1367  502s
  7193  2175 -7536.8278   18  363 -10288.912 -4726.2971  54.1%  1360  515s
  7553  2229     cutoff   13      -10288.912 -4733.5703  54.0%  1359  529s
  8014  2247 infeasible   15      -10288.912 -5034.9709  51.1%  1347  543s
  8370  2296 -9573.6579   17  285 -10288.912 -5152.9987  49.9%  1350  557s
  8750  2312 -9079.9378   19  363 -10288.912 -5202.0139  49.4%  1354  571s
  9149  2309 -9903.3259   16  108 -10288.912 -5415.0620  47.4%  1353  582s
  9215  2324     cutoff   17      -10288.912 -5457.3662  47.0%  1354  596s
  9412  2324 -10188.367   18  278 -10288.912 -5536.4340  46.2%  1354  610s
  9811  2320 -7668.6958   13  269 -10288.912 -5539.8508  46.2%  1358  627s
 10262  2309 -7073.2090   11  596 -10288.912 -5758.5589  44.0%  1361  643s
 10783  2282 -10215.436   22  229 -10288.912 -5871.0055  42.9%  1356  661s
 11312  2239 -9909.9090   21  356 -10288.912 -6203.4333  39.7%  1355  678s
 11684  2212 -7712.3866   15  139 -10288.912 -6304.1149  38.7%  1350  695s
 12198  2149     cutoff   12      -10288.912 -6473.0343  37.1%  1348  714s
 12750  1999 -8189.5609   22  338 -10288.912 -6645.3878  35.4%  1353  732s
 13385  1895     cutoff   35      -10288.912 -6887.1754  33.1%  1350  754s
 14093  1741 -10080.895   27   35 -10288.912 -7153.0798  30.5%  1344  775s
 14945  1538     cutoff   31      -10288.912 -7363.1844  28.4%  1326  795s
 15755  1491 -9105.9815   25  192 -10288.912 -7753.2194  24.6%  1315  812s
 15946  1181     cutoff   26      -10288.912 -7813.3859  24.1%  1311  834s
 16894   691 -9626.4395   36  228 -10288.912 -8070.7989  21.6%  1285  856s
*17881   691              40    -10288.76459 -8190.7408  20.4%  1254  856s
 18367   159 -9469.2841   23  441 -10288.765 -8612.9878  16.3%  1236  875s
*18413   159              43    -10287.22979 -8612.9878  16.3%  1234  875s
H18598   159                    -10264.03217 -8676.3227  15.5%  1224  875s
H18601   159                    -10254.92276 -8676.3227  15.4%  1224  875s
*20327    71              47    -10251.82585 -9223.0727  10.0%  1152  877s
*20337    71              45    -10250.62694 -9223.0727  10.0%  1152  877s
*20420    71              44    -10250.56678 -9223.0727  10.0%  1147  877s
*20445    71              46    -10244.49742 -9276.9461  9.44%  1146  877s
*20458    71              44    -10231.90855 -9276.9461  9.33%  1145  877s

Cutting planes:
  Learned: 3
  Implied bound: 12
  MIR: 460
  Flow cover: 1306
  Zero half: 7
  RLT: 69
  Relax-and-lift: 60

Explored 21117 nodes (23597787 simplex iterations) in 877.26 seconds (2761.01 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -10231.9 -10244.5 -10250.6 ... -10288.9
No other solutions better than -10231.9

Optimal solution found (tolerance 1.00e-04)
Warning: max constraint violation (1.8408e-09) exceeds tolerance
Best objective -1.023190855266e+04, best bound -1.023190855266e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 877.31s
  Master Objective (UB) = -10231.91, θ = 119532.42
  Upper Bound (UB) = -10231.91

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 119532.42
  [DEBUG]   ✓ Scenario 0: θ = 119532.42 ≤ Q = 119532.42 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 119532.42 ≤ Q = 119532.42 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 119532.42 ≤ Q = 119532.42 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 119532.42 ≤ Q = 119532.42 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x5ef43289
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x5ef43289
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [3e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [2e-14, 2e+02]
Found heuristic solution: objective 1.233242e+13
Presolve removed 2590 rows and 1881 columns
Presolve time: 0.00s
Presolved: 503 rows, 508 columns, 1420 nonzeros
Found heuristic solution: objective 6668468.6130
Variable types: 342 continuous, 166 integer (166 binary)

Root relaxation: objective -1.166333e+05, 245 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -116633.29    0  130 6668468.61 -116633.29   102%     -    0s
H    0     0                    -80867.01184 -116633.29  44.2%     -    0s
H    0     0                    -81213.71160 -116633.29  43.6%     -    0s
H    0     0                    -89100.71490 -116633.29  30.9%     -    0s
H    0     0                    -93238.31624 -116633.29  25.1%     -    0s
H    0     0                    -97220.05071 -99222.125  2.06%     -    0s
     0     0 -99222.125    0   89 -97220.051 -99222.125  2.06%     -    0s
H    0     0                    -98451.48542 -99218.808  0.78%     -    0s
     0     0 -98772.753    0   82 -98451.485 -98772.753  0.33%     -    0s
     0     0 -98681.980    0   68 -98451.485 -98681.980  0.23%     -    0s
     0     0 -98664.855    0   61 -98451.485 -98664.855  0.22%     -    0s
     0     0 -98663.627    0   60 -98451.485 -98663.627  0.22%     -    0s
     0     0 -98635.829    0    9 -98451.485 -98635.829  0.19%     -    0s
H    0     0                    -98596.71309 -98630.512  0.03%     -    0s
     0     0 -98612.997    0    8 -98596.713 -98612.997  0.02%     -    0s
     0     0          -    0      -98596.713 -98605.480  0.01%     -    0s

Cutting planes:
  Gomory: 15
  Implied bound: 2
  MIR: 82
  Flow cover: 1
  RLT: 42
  Relax-and-lift: 4

Explored 1 nodes (502 simplex iterations) in 0.03 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -98596.7 -98451.5 -97220.1 ... 1.23324e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -9.859671309223e+04, best bound -9.860548032909e+04, gap 0.0089%
  Subproblem solved in 0.04s
  Worst-case operational profit (Z_SP) = 101956.56
  Scenario: 15 demand increases, 45 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -98596.71
  [DEBUG]   S×d_nominal = 200553.27
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 200553.27 + -98596.71 = 101956.56
  [DEBUG]   Current θ from Master = 119532.42
  [DEBUG]   ⚠️  Z_SP ≤ θ by 17575.86 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -27807.77
  Lower Bound (LB) = -13018.71
  Gap (UB-LB) = 2786.8053, Absolute Gap = 2786.8053, Relative Gap = 0.272364
  Not converged yet (gap = 2786.81 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 15 increases, 45 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221734 nonzeros
Model fingerprint: 0x2d048e53
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 33350 rows and 13540 columns
Presolve time: 0.68s
Presolved: 44483 rows, 19920 columns, 275709 nonzeros
Variable types: 17661 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -383874.0427
Found heuristic solution: objective -190756.9345

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 44483 rows, 19920 columns, 275709 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   33241   -1.1353435e+04   0.000000e+00   5.627026e+06      5s
   45232   -8.3263167e+02   0.000000e+00   1.211056e+06     10s
   54996    4.8539266e+03   0.000000e+00   5.912412e+05     15s
Concurrent spin time: 2.55s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 8.091907e+03, 46713 iterations, 15.76 seconds (31.91 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 8091.90663    0  450 -190756.93 8091.90663   104%     -   16s
H    0     0                    -177417.5634 8091.90663   105%     -   16s
H    0     0                    -127788.6347 8091.90663   106%     -   17s
H    0     0                    -124610.3007 8091.90663   106%     -   17s
H    0     0                    -124374.8735 8091.90663   107%     -   17s
H    0     0                    -123432.9534 8091.90663   107%     -   17s
H    0     0                    -123351.6110 8091.90663   107%     -   17s
H    0     0                    -123201.7418 8091.90663   107%     -   17s
H    0     0                    -116063.7880 8091.90663   107%     -   17s
H    0     0                    -115906.0693 8091.90663   107%     -   17s
H    0     0                    -115584.9061 8091.90663   107%     -   17s
H    0     0                    -114437.9403 8091.90663   107%     -   17s
H    0     0                    -114437.5277 8091.90663   107%     -   17s
H    0     0                    -77221.69073 8091.90663   110%     -   17s
H    0     0                    -77178.69377 8091.90663   110%     -   17s
H    0     0                    -70152.35226 8091.90663   112%     -   17s
H    0     0                    -59461.29464 8091.90663   114%     -   17s
H    0     0                    -59117.76043 8091.90663   114%     -   17s
H    0     0                    -48994.21760 8091.90663   117%     -   18s
H    0     0                    -48736.47542 8091.90663   117%     -   18s
H    0     0                    -41457.75782 8091.90663   120%     -   18s
H    0     0                    -38533.98597 8091.90663   121%     -   18s
H    0     0                    -38435.51785 8091.90663   121%     -   18s
     0     0 3562.66379    0  488 -38435.518 3562.66379   109%     -   25s
H    0     0                    -37211.51245 3562.14084   110%     -   26s
H    0     0                    -37207.59076 3562.14084   110%     -   26s
     0     0 2917.23707    0  512 -37207.591 2917.23707   108%     -   29s
     0     0 2829.83838    0  520 -37207.591 2829.83838   108%     -   30s
     0     0 2829.35736    0  451 -37207.591 2829.35736   108%     -   32s
     0     0 2829.35736    0  458 -37207.591 2829.35736   108%     -   33s
     0     0 2829.35736    0  457 -37207.591 2829.35736   108%     -   33s
     0     0 2829.29867    0  458 -37207.591 2829.29867   108%     -   34s
H    0     0                    -32963.62978 1254.73148   104%     -   42s
     0     0 1245.92997    0  646 -32963.630 1245.92997   104%     -   42s
H    0     0                    -32924.12833 1245.92997   104%     -   42s
H    0     0                    -30093.39486 1245.92997   104%     -   42s
H    0     0                    -30077.67365 1245.92997   104%     -   42s
     0     0 1015.37552    0  633 -30077.674 1015.37552   103%     -   45s
     0     0  991.48836    0  635 -30077.674  991.48836   103%     -   46s
     0     0  886.02478    0  636 -30077.674  886.02478   103%     -   48s
     0     0  774.82678    0  645 -30077.674  774.82678   103%     -   50s
     0     0  763.61097    0  646 -30077.674  763.61097   103%     -   50s
     0     0  759.95348    0  642 -30077.674  759.95348   103%     -   50s
     0     0  759.39280    0  647 -30077.674  759.39280   103%     -   51s
H    0     0                    -30063.01126 -264.71855  99.1%     -   62s
H    0     0                    -29945.20605 -264.71855  99.1%     -   62s
H    0     0                    -29860.20097 -264.71855  99.1%     -   62s
H    0     0                    -29852.99173 -264.71855  99.1%     -   62s
H    0     0                    -23577.67486 -264.71855  98.9%     -   62s
H    0     0                    -13008.38427 -264.71855  98.0%     -   62s
H    0     0                    -12991.56708 -264.71855  98.0%     -   62s
H    0     0                    -12990.98251 -264.71855  98.0%     -   62s
H    0     0                    -12989.82299 -264.71855  98.0%     -   62s
     0     0 -264.71855    0  613 -12989.823 -264.71855  98.0%     -   62s
     0     0 -392.00002    0  624 -12989.823 -392.00002  97.0%     -   65s
     0     0 -445.56937    0  627 -12989.823 -445.56937  96.6%     -   67s
H    0     0                    -12989.66726 -508.00029  96.1%     -   70s
H    0     0                    -12988.34687 -508.00029  96.1%     -   70s
     0     0 -508.00029    0  622 -12988.347 -508.00029  96.1%     -   70s
     0     0 -527.77332    0  631 -12988.347 -527.77332  95.9%     -   71s
     0     0 -540.34353    0  634 -12988.347 -540.34353  95.8%     -   72s
     0     0 -542.98505    0  639 -12988.347 -542.98505  95.8%     -   72s
     0     0 -543.18611    0  640 -12988.347 -543.18611  95.8%     -   72s
H    0     0                    -12867.77633 -978.62032  92.4%     -   87s
H    0     0                    -12861.19342 -978.62032  92.4%     -   87s
H    0     0                    -12855.92591 -978.62032  92.4%     -   87s
H    0     0                    -12850.48312 -978.62032  92.4%     -   87s
H    0     0                    -12843.76608 -978.62032  92.4%     -   87s
     0     0 -978.62032    0  647 -12843.766 -978.62032  92.4%     -   87s
H    0     0                    -12833.30173 -978.86775  92.4%     -   88s
H    0     0                    -11977.39381 -1221.9886  89.8%     -   92s
H    0     0                    -11904.08336 -1221.9886  89.7%     -   92s
     0     0 -1221.9886    0  651 -11904.083 -1221.9886  89.7%     -   94s
     0     0 -1352.8685    0  655 -11904.083 -1352.8685  88.6%     -   97s
     0     0 -1378.6123    0  657 -11904.083 -1378.6123  88.4%     -   98s
     0     0 -1386.8550    0  658 -11904.083 -1386.8550  88.3%     -   99s
     0     0 -1390.0721    0  658 -11904.083 -1390.0721  88.3%     -  100s
H    0     0                    -11667.68382 -1412.4517  87.9%     -  101s
H    0     0                    -11655.39337 -1412.4517  87.9%     -  101s
H    0     0                    -11652.71413 -1412.4517  87.9%     -  101s
     0     0 -1412.4517    0  651 -11652.714 -1412.4517  87.9%     -  101s
     0     0 -1417.9695    0  659 -11652.714 -1417.9695  87.8%     -  102s
     0     0 -1419.8139    0  663 -11652.714 -1419.8139  87.8%     -  102s
     0     0 -1421.5895    0  662 -11652.714 -1421.5895  87.8%     -  103s
     0     0 -1421.7334    0  661 -11652.714 -1421.7334  87.8%     -  103s
     0     0 -1526.4086    0  662 -11652.714 -1526.4086  86.9%     -  108s
     0     0 -1578.6511    0  720 -11652.714 -1578.6511  86.5%     -  112s
     0     0 -1584.8418    0  680 -11652.714 -1584.8418  86.4%     -  114s
     0     0 -1588.3081    0  680 -11652.714 -1588.3081  86.4%     -  115s
     0     0 -1589.5707    0  686 -11652.714 -1589.5707  86.4%     -  115s
     0     0 -1677.2898    0  672 -11652.714 -1677.2898  85.6%     -  121s
     0     0 -1694.0243    0  713 -11652.714 -1694.0243  85.5%     -  125s
     0     0 -1699.0914    0  664 -11652.714 -1699.0914  85.4%     -  126s
     0     0 -1700.8051    0  731 -11652.714 -1700.8051  85.4%     -  126s
     0     0 -1701.8619    0  685 -11652.714 -1701.8619  85.4%     -  127s
     0     0 -1765.1483    0  724 -11652.714 -1765.1483  84.9%     -  130s
     0     0 -1795.2842    0  710 -11652.714 -1795.2842  84.6%     -  132s
     0     0 -1801.7472    0  666 -11652.714 -1801.7472  84.5%     -  133s
     0     0 -1805.7714    0  713 -11652.714 -1805.7714  84.5%     -  134s
     0     0 -1808.6884    0  670 -11652.714 -1808.6884  84.5%     -  135s
     0     0 -1810.5932    0  673 -11652.714 -1810.5932  84.5%     -  135s
     0     0 -1811.1150    0  676 -11652.714 -1811.1150  84.5%     -  135s
     0     0 -1849.1738    0  720 -11652.714 -1849.1738  84.1%     -  139s
     0     0 -1857.4598    0  719 -11652.714 -1857.4598  84.1%     -  141s
     0     0 -1862.0449    0  719 -11652.714 -1862.0449  84.0%     -  142s
     0     0 -1864.3729    0  727 -11652.714 -1864.3729  84.0%     -  144s
     0     0 -1864.9572    0  731 -11652.714 -1864.9572  84.0%     -  144s
     0     0 -1874.8797    0  680 -11652.714 -1874.8797  83.9%     -  147s
     0     0 -1877.1619    0  767 -11652.714 -1877.1619  83.9%     -  148s
     0     0 -1878.0534    0  771 -11652.714 -1878.0534  83.9%     -  148s
     0     0 -1894.3525    0  773 -11652.714 -1894.3525  83.7%     -  151s
     0     0 -1898.9216    0  760 -11652.714 -1898.9216  83.7%     -  153s
     0     0 -1900.5929    0  767 -11652.714 -1900.5929  83.7%     -  153s
     0     0 -1901.7162    0  778 -11652.714 -1901.7162  83.7%     -  154s
     0     0 -1908.3693    0  703 -11652.714 -1908.3693  83.6%     -  155s
     0     0 -1909.5318    0  782 -11652.714 -1909.5318  83.6%     -  156s
     0     0 -1911.2246    0  695 -11652.714 -1911.2246  83.6%     -  158s
H    0     0                    -11467.93162 -1911.2897  83.3%     -  161s
     0     0 -1912.3113    0  698 -11467.932 -1912.3113  83.3%     -  161s
     0     0 -1916.5051    0  786 -11467.932 -1916.5051  83.3%     -  163s
H    0     0                    -11465.54367 -1916.6115  83.3%     -  163s
     0     0 -1917.4138    0  702 -11465.544 -1917.4138  83.3%     -  163s
     0     0 -1919.8446    0  774 -11465.544 -1919.8446  83.3%     -  164s
     0     0 -1920.3860    0  774 -11465.544 -1920.3860  83.3%     -  166s
H    0     0                    -11358.78278 -1920.3860  83.1%     -  172s
H    0     0                    -11256.59056 -1920.3860  82.9%     -  172s
H    0     0                    -11218.25016 -1920.3860  82.9%     -  172s
H    0     0                    -11147.17176 -1920.3860  82.8%     -  172s
H    0     0                    -11102.96974 -1920.4695  82.7%     -  193s
H    0     0                    -11054.70953 -1920.4695  82.6%     -  195s
     0     2 -1920.4695    0  774 -11054.710 -1920.4695  82.6%     -  196s
     1     4 -2052.6515    1  671 -11054.710 -1920.4695  82.6%  4341  206s
     3     8 -2162.8960    2  684 -11054.710 -2053.1058  81.4%  6516  211s
     7    16 -2339.3917    3  684 -11054.710 -2163.5154  80.4%  5119  217s
    15    32 -2404.7473    4  671 -11054.710 -2339.4047  78.8%  5630  228s
    31    54 -4224.0352    5  602 -11054.710 -2404.7481  78.2%  6843  246s
H   32    54                    -10995.80508 -2404.7481  78.1%  6629  246s
H   53    86                    -10994.64555 -2404.7481  78.1%  8339  253s
H   56    86                    -10986.98184 -2404.7481  78.1%  8174  253s
    85   214 -3840.9826    7  645 -10986.982 -2404.7481  78.1%  6536  262s
   217   312 -4022.5828   10  606 -10986.982 -2404.7481  78.1%  3198  269s
   323   346 -3892.2352    8  622 -10986.982 -2404.7481  78.1%  2582  272s
   367   403 -4059.9210   11  552 -10986.982 -2404.7481  78.1%  2421  279s
   442   427 -4495.6303   12  519 -10986.982 -2404.7481  78.1%  2194  286s
   528   446 -5497.5841   11  419 -10986.982 -2404.7481  78.1%  2036  294s
   597   478 -5218.4044   13  527 -10986.982 -2404.7481  78.1%  2004  300s
   653   487 -7194.2343   20  442 -10986.982 -2404.7481  78.1%  1980  308s
   719   511 -6257.5554   13  497 -10986.982 -2404.7481  78.1%  1913  315s
   775   542 -6623.2360   14  433 -10986.982 -2404.7481  78.1%  1914  322s
   838   586 -5547.8879   14  511 -10986.982 -2404.7481  78.1%  1886  329s
   900   627     cutoff   29      -10986.982 -2404.7481  78.1%  1896  337s
   973   653 -6801.3521   15  433 -10986.982 -2404.7481  78.1%  1861  345s
  1068   686 -6156.3934   15  302 -10986.982 -2404.7481  78.1%  1818  352s
  1130   737 -7291.1213   16  285 -10986.982 -2404.7481  78.1%  1804  360s
  1223   779 -7607.5460   17  305 -10986.982 -2404.7481  78.1%  1756  367s
  1305   831 -7906.5921   19  206 -10986.982 -2447.4987  77.7%  1757  375s
  1391   876 -8486.5593   21  556 -10986.982 -2447.8868  77.7%  1749  383s
  1476   914 infeasible   20      -10986.982 -2447.8868  77.7%  1739  391s
  1587   981 -8783.5844   24  514 -10986.982 -2447.8868  77.7%  1720  399s
  1703  1008     cutoff   25      -10986.982 -2447.8868  77.7%  1694  408s
  1803  1060 -9187.3819   27  490 -10986.982 -2702.4625  75.4%  1673  417s
  1901  1076 -9831.6673   29  445 -10986.982 -2702.5613  75.4%  1652  427s
  1993  1112 -10031.694   31  323 -10986.982 -2702.5613  75.4%  1649  436s
  2077  1165 -10861.230   35  162 -10986.982 -2702.5613  75.4%  1657  445s
  2208  1213     cutoff   42      -10986.982 -2702.5613  75.4%  1649  455s
  2326  1239 -9599.5080   11  275 -10986.982 -3006.9341  72.6%  1627  464s
  2406  1284 -9633.9477   12  197 -10986.982 -3006.9341  72.6%  1622  474s
  2537  1337     cutoff   14      -10986.982 -3006.9341  72.6%  1618  484s
  2649  1417 -7945.3277    7  405 -10986.982 -3006.9341  72.6%  1617  495s
  2783  1504 -9635.4061   10  336 -10986.982 -3006.9341  72.6%  1615  506s
  2960  1600     cutoff   15      -10986.982 -3006.9341  72.6%  1592  516s
  3178  1647 -6777.0981    9  561 -10986.982 -3006.9341  72.6%  1561  527s
  3351  1668 -7253.5771   12  436 -10986.982 -3006.9341  72.6%  1558  539s
  3488  1718 -7979.6030   17  477 -10986.982 -3266.9908  70.3%  1562  551s
  3649  1796 -9581.1044   21  400 -10986.982 -3266.9908  70.3%  1574  564s
  3833  1858     cutoff   31      -10986.982 -4745.1954  56.8%  1580  577s
  4074  1872 -9267.3335   14  395 -10986.982 -4991.6921  54.6%  1576  585s
  4123  1897 -10115.871   15  594 -10986.982 -4991.6921  54.6%  1579  597s
  4179  1913 -10724.308   16  408 -10986.982 -4991.6921  54.6%  1578  607s
  4227  1968     cutoff   17      -10986.982 -4991.6921  54.6%  1582  619s
  4370  2033     cutoff   17      -10986.982 -4991.6921  54.6%  1570  633s
  4579  2153 -9390.6235   10  261 -10986.982 -4991.6921  54.6%  1574  649s
  4857  2227     cutoff   12      -10986.982 -5455.2386  50.3%  1569  661s
  5116  2301 -8502.2824    9  414 -10986.982 -5455.2386  50.3%  1569  675s
  5409  2364 -10371.117   15  290 -10986.982 -5668.1586  48.4%  1566  690s
  5737  2485     cutoff   12      -10986.982 -5815.7525  47.1%  1567  705s
  6073  2486 -9976.7944   20  774 -10986.982 -5945.4924  45.9%  1551  756s
  6075  2487 -8867.7924   12  450 -10986.982 -5945.4924  45.9%  1551  780s
  6076  2488 -7218.5756   14  590 -10986.982 -5945.4924  45.9%  1550  796s
  6077  2489 -10239.252   27  684 -10986.982 -5945.4924  45.9%  1550  811s
  6078  2489 -8382.5393   17  627 -10986.982 -5945.4924  45.9%  1550  820s
  6079  2490 -7471.1671   14  707 -10986.982 -5945.4924  45.9%  1550  828s
  6080  2491 -10467.744   27  751 -10986.982 -5945.4924  45.9%  1549  831s
  6081  2491 -6369.9632   11  742 -10986.982 -5945.4924  45.9%  1549  835s
  6083  2493 -10178.061   22  663 -10986.982 -5945.4924  45.9%  1549  842s
  6084  2493 -9149.4342   25  725 -10986.982 -5945.4924  45.9%  1548  851s
  6086  2495 -6940.1962   11  767 -10986.982 -5945.4924  45.9%  1548  856s
  6088  2496 -7589.6039   10  698 -10986.982 -5945.4924  45.9%  1547  866s
  6090  2497 -10350.798   15  687 -10986.982 -5945.4924  45.9%  1547  871s
  6091  2498 -6622.7980    6  803 -10986.982 -5945.4924  45.9%  1547  879s
  6092  2499 -9300.6180   15  801 -10986.982 -5945.4924  45.9%  1546  883s
  6093  2499 -6296.2690   10  765 -10986.982 -5945.4924  45.9%  1546  888s
  6094  2500 -10097.305   19  765 -10986.982 -5945.4924  45.9%  1546  911s
  6095  2501 -9152.8300   18  765 -10986.982 -5945.4924  45.9%  1546  925s
  6096  2504 -5945.4924   12  812 -10986.982 -5945.4924  45.9%  1571  944s
  6098  2508 -5945.4924   13  806 -10986.982 -5945.4924  45.9%  1572  954s
  6102  2514 -5945.4924   14  739 -10986.982 -5945.4924  45.9%  1574  968s
  6110  2528 -5945.4924   15  740 -10986.982 -5945.4924  45.9%  1580  983s
  6126  2537 -8941.9282   16  145 -10986.982 -5945.4924  45.9%  1597 1055s
  6143  2562 -5945.4924   17  546 -10986.982 -5945.4924  45.9%  1633 1065s
  6175  2605 -5945.4924   18  528 -10986.982 -5945.4924  45.9%  1639 1078s
  6272  2607 -6810.7727   21  539 -10986.982 -5945.4924  45.9%  1659 1088s
  6354  2585 -10210.765   21  145 -10986.982 -5945.4924  45.9%  1668 1099s
  6401  2584 -6076.5572   20  437 -10986.982 -5945.4924  45.9%  1673 1108s
  6463  2576 -6925.7828   22  536 -10986.982 -5945.4924  45.9%  1690 1117s
  6508  2580 -10742.716   22  171 -10986.982 -5945.4924  45.9%  1699 1129s
  6564  2576 -6116.7796   21  434 -10986.982 -5945.4924  45.9%  1710 1138s
  6625  2566 -6591.3134   23  362 -10986.982 -5945.4924  45.9%  1730 1147s
  6694  2564 -9338.8186   23  203 -10986.982 -5945.4924  45.9%  1744 1156s
H 6732  2425                    -10909.17958 -5945.4924  45.5%  1744 1156s
H 6763  2314                    -10871.32665 -5945.4924  45.3%  1750 1166s
H 6786  2193                    -10832.89814 -5945.4924  45.1%  1755 1166s
H 6813  2076                    -10825.80512 -5945.4924  45.1%  1756 1166s
  6839  2088     cutoff   25      -10825.805 -5945.4924  45.1%  1762 1175s
  6899  2101 -7234.8872   29  407 -10825.805 -5945.4924  45.1%  1788 1186s
H 6900  1998                    -10821.39251 -5945.4924  45.1%  1787 1186s
H 6908  1899                    -10775.44810 -5945.4924  44.8%  1787 1186s
  6965  1910 -7266.1560   30  315 -10775.448 -5945.4924  44.8%  1795 1196s
  7035  1917 -8100.5021   33  209 -10775.448 -5945.4924  44.8%  1814 1205s
  7121  1908     cutoff   34      -10775.448 -5945.4924  44.8%  1818 1213s
  7187  1906     cutoff   33      -10775.448 -5945.4924  44.8%  1818 1222s
  7271  1914 -10208.355   33  136 -10775.448 -5945.4924  44.8%  1821 1232s
  7357  1923 -6314.6421   19  482 -10775.448 -5945.4924  44.8%  1823 1243s
  7444  1934 -7054.1409   21  381 -10775.448 -5945.4924  44.8%  1827 1253s
  7540  1940 -8948.7173   25  440 -10775.448 -5945.4924  44.8%  1831 1264s
  7651  1930 -10609.625   27  184 -10775.448 -5945.4924  44.8%  1831 1278s
  7777  1910 -5945.4924   21  494 -10775.448 -5945.4924  44.8%  1830 1290s
  7900  1911 -7246.8558   22  425 -10775.448 -5945.4924  44.8%  1831 1301s
  8015  1891 -8742.2300   23  434 -10775.448 -5945.4924  44.8%  1833 1312s
  8136  1854 -8071.7565   21  489 -10775.448 -5945.4924  44.8%  1832 1325s
  8231  1845     cutoff   22      -10775.448 -5945.4924  44.8%  1834 1339s
  8321  1859     cutoff   27      -10775.448 -5945.4924  44.8%  1832 1351s
  8445  1846 -7607.3421   22  268 -10775.448 -5945.4924  44.8%  1835 1365s
  8594  1843 infeasible   26      -10775.448 -5945.4924  44.8%  1838 1379s
  8750  1811 -9353.2495   22  620 -10775.448 -5945.4924  44.8%  1843 1397s
  8925  1787     cutoff   24      -10775.448 -5945.4924  44.8%  1845 1412s
  9094  1763 -10371.615   25  456 -10775.448 -5945.4924  44.8%  1851 1427s
  9275  1730     cutoff   32      -10775.448 -6117.0942  43.2%  1850 1442s
  9478  1674 infeasible   25      -10775.448 -6287.2858  41.7%  1849 1457s
  9662  1633 -9226.1683   21  444 -10775.448 -6565.4496  39.1%  1848 1472s
  9888  1590 -8522.8582   23  343 -10775.448 -6565.4496  39.1%  1847 1489s
 10111  1553 -10678.496   28  463 -10775.448 -6624.6560  38.5%  1848 1506s
 10334  1507 -10638.088   31   91 -10775.448 -6797.6737  36.9%  1853 1523s
 10570  1436     cutoff   26      -10775.448 -6933.9581  35.7%  1857 1541s
 10807  1385 -9280.0864   25  553 -10775.448 -7136.9352  33.8%  1862 1559s
 11088  1280     cutoff   30      -10775.448 -7226.7856  32.9%  1857 1578s
 11415  1173 -9898.5640   27  336 -10775.448 -7390.8998  31.4%  1850 1596s
 11653  1085 -9631.4632   27  143 -10775.448 -7528.2056  30.1%  1843 1615s
*11766  1085              57    -10766.98206 -7528.2056  30.1%  1841 1615s
 11986  1051 infeasible   28      -10766.982 -7709.4803  28.4%  1839 1636s
 12316  1004 -10558.194   29  131 -10766.982 -7857.1496  27.0%  1839 1659s
 12742   844 -9657.6891   33  444 -10766.982 -8128.2698  24.5%  1825 1681s
H12798   844                    -10755.62424 -8213.7188  23.6%  1824 1681s
 13192   578 -10110.683   27  341 -10755.624 -8300.0350  22.8%  1809 1700s
 13737   307     cutoff   25      -10755.624 -8744.7647  18.7%  1777 1721s
*14079   307              30    -10738.93107 -8801.3443  18.0%  1755 1721s
 14349    36 -9984.0342   33  518 -10738.931 -9228.5275  14.1%  1742 1737s
*14414    36              55    -10713.69655 -9228.9184  13.9%  1736 1737s
H14876     0                    -10703.37774 -10645.877  0.54%  1699 1738s
H14889     0                    -10701.30401 -10694.756  0.06%  1697 1738s

Cutting planes:
  Learned: 2
  MIR: 833
  Flow cover: 1992
  GUB cover: 1
  Zero half: 14
  RLT: 41
  Relax-and-lift: 101

Explored 14947 nodes (25449256 simplex iterations) in 1738.43 seconds (4704.08 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -10701.3 -10703.4 -10713.7 ... -10832.9
No other solutions better than -10701.3

Optimal solution found (tolerance 1.00e-04)
Best objective -1.070130400762e+04, best bound -1.070130400762e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1738.44s
  Master Objective (UB) = -10701.30, θ = 119259.68
  Upper Bound (UB) = -10701.30

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 119259.68
  [DEBUG]   ✓ Scenario 0: θ = 119259.68 ≤ Q = 119259.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 119259.68 ≤ Q = 119259.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 119259.68 ≤ Q = 119259.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 119259.68 ≤ Q = 119270.04 (slack: 10.36)
  [DEBUG]   ✓ Scenario 4: θ = 119259.68 ≤ Q = 119259.68 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x571c6399
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x571c6399
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.225027e+13
Presolve removed 2590 rows and 1881 columns
Presolve time: 0.00s
Presolved: 503 rows, 508 columns, 1420 nonzeros
Found heuristic solution: objective 6504429.3346
Variable types: 342 continuous, 166 integer (166 binary)

Root relaxation: objective -1.175888e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -117588.83    0  123 6504429.33 -117588.83   102%     -    0s
H    0     0                    -83616.92423 -117588.83  40.6%     -    0s
H    0     0                    -86466.27877 -117588.83  36.0%     -    0s
H    0     0                    -95418.46835 -117588.83  23.2%     -    0s
     0     0 -102427.32    0   87 -95418.468 -102427.32  7.35%     -    0s
H    0     0                    -100171.7839 -102370.60  2.20%     -    0s
     0     0 -101975.86    0   87 -100171.78 -101975.86  1.80%     -    0s
     0     0 -101962.26    0   87 -100171.78 -101962.26  1.79%     -    0s
H    0     0                    -100682.0583 -101962.26  1.27%     -    0s
     0     0 -101696.62    0   71 -100682.06 -101696.62  1.01%     -    0s
     0     0 -101636.97    0   72 -100682.06 -101636.97  0.95%     -    0s
     0     0 -101619.91    0   77 -100682.06 -101619.91  0.93%     -    0s
     0     0 -101618.83    0   77 -100682.06 -101618.83  0.93%     -    0s
H    0     0                    -100882.9306 -101618.83  0.73%     -    0s
     0     0 -101408.85    0   53 -100882.93 -101408.85  0.52%     -    0s
H    0     0                    -100884.2990 -101408.72  0.52%     -    0s
     0     0 -101388.60    0   51 -100884.30 -101388.60  0.50%     -    0s
     0     0 -101384.68    0   52 -100884.30 -101384.68  0.50%     -    0s
     0     0 -101149.80    0   21 -100884.30 -101149.80  0.26%     -    0s
     0     0 -101149.73    0   21 -100884.30 -101149.73  0.26%     -    0s
     0     0 -101137.89    0   19 -100884.30 -101137.89  0.25%     -    0s
     0     0 -101066.80    0   23 -100884.30 -101066.80  0.18%     -    0s
     0     0 -101066.80    0   19 -100890.83 -101066.80  0.17%     -    0s
     0     0 -100987.69    0    9 -100890.83 -100987.69  0.10%     -    0s
     0     0 -100985.47    0    8 -100890.83 -100985.47  0.09%     -    0s
H    0     0                    -100941.6659 -100985.47  0.04%     -    0s
     0     0 -100966.29    0    3 -100941.67 -100966.29  0.02%     -    0s
     0     0 -100959.78    0    4 -100941.67 -100959.78  0.02%     -    0s
H    0     0                    -100958.2969 -100959.78  0.00%     -    0s

Explored 1 nodes (956 simplex iterations) in 0.08 seconds (0.06 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -100958 -100942 -100939 ... -83616.9

Optimal solution found (tolerance 1.00e-04)
Best objective -1.009582969232e+05, best bound -1.009597797835e+05, gap 0.0015%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 101400.30
  Scenario: 40 demand increases, 20 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -100958.30
  [DEBUG]   S×d_nominal = 202358.59
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 202358.59 + -100958.30 = 101400.30
  [DEBUG]   Current θ from Master = 119259.68
  [DEBUG]   ⚠️  Z_SP ≤ θ by 17859.39 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -28560.69
  Lower Bound (LB) = -13018.71
  Gap (UB-LB) = 2317.4099, Absolute Gap = 2317.4099, Relative Gap = 0.216554
  Not converged yet (gap = 2317.41 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 40 increases, 20 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 264977 nonzeros
Model fingerprint: 0xb5dc041a
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 40016 rows and 16246 columns
Presolve time: 0.83s
Presolved: 53107 rows, 23454 columns, 329759 nonzeros
Variable types: 21195 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -383874.0427
Found heuristic solution: objective -190756.9345

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 53107 rows, 23454 columns, 329759 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   34826   -2.7379175e+04   0.000000e+00   8.236279e+06      5s
   47193   -4.9008851e+03   0.000000e+00   1.349039e+11     10s
   55291   -1.9938789e+03   0.000000e+00   3.050926e+06     15s
   62885    1.9370514e+03   0.000000e+00   6.189141e+05     20s
Concurrent spin time: 5.77s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 8.091907e+03, 47088 iterations, 23.20 seconds (42.89 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 8091.90663    0  450 -190756.93 8091.90663   104%     -   24s
H    0     0                    -178948.8193 8091.90663   105%     -   24s
H    0     0                    -159861.7244 8091.90663   105%     -   24s
H    0     0                    -152650.3912 8091.90663   105%     -   24s
H    0     0                    -128157.9088 8091.90663   106%     -   24s
H    0     0                    -118489.1300 8091.90663   107%     -   24s
H    0     0                    -79983.72784 8091.90663   110%     -   24s
H    0     0                    -79940.73087 8091.90663   110%     -   25s
H    0     0                    -70615.71958 8091.90663   111%     -   25s
H    0     0                    -70568.33639 8091.90663   111%     -   25s
H    0     0                    -63147.31482 8091.90663   113%     -   25s
H    0     0                    -59801.26668 8091.90663   114%     -   25s
H    0     0                    -47330.02988 8091.90663   117%     -   26s
H    0     0                    -46293.27574 8091.90663   117%     -   26s
H    0     0                    -46289.24191 8091.90663   117%     -   26s
H    0     0                    -46281.61016 8091.90663   117%     -   26s
H    0     0                    -46266.26314 8091.90663   117%     -   26s
H    0     0                    -46258.63140 8091.90663   117%     -   26s
H    0     0                    -46250.19703 8091.90663   117%     -   26s
     0     0 3319.89952    0  450 -46250.197 3319.89952   107%     -   37s
H    0     0                    -46159.81128 3319.31878   107%     -   39s
     0     0 2907.92992    0  443 -46159.811 2907.92992   106%     -   42s
     0     0 2876.40908    0  513 -46159.811 2876.40908   106%     -   44s
     0     0 2876.40908    0  514 -46159.811 2876.40908   106%     -   46s
     0     0 2876.40908    0  437 -46159.811 2876.40908   106%     -   47s
     0     0 2876.40908    0  444 -46159.811 2876.40908   106%     -   49s
     0     0 2876.40908    0  441 -46159.811 2876.40908   106%     -   50s
     0     0 2876.40908    0  443 -46159.811 2876.40908   106%     -   50s
     0     0 1262.26101    0  613 -46159.811 1262.26101   103%     -   62s
H    0     0                    -33763.15305 1262.26101   104%     -   63s
H    0     0                    -33588.90167 1262.26101   104%     -   63s
H    0     0                    -33543.78650 1262.26101   104%     -   63s
H    0     0                    -33535.38244 1262.26101   104%     -   63s
H    0     0                    -33318.86670 1262.26101   104%     -   63s
H    0     0                    -33314.94501 1262.26101   104%     -   63s
H    0     0                    -33306.71712 1262.26101   104%     -   63s
H    0     0                    -33298.65631 1262.26101   104%     -   63s
H    0     0                    -33111.69224 1262.26101   104%     -   63s
H    0     0                    -33066.57707 1262.26101   104%     -   63s
H    0     0                    -33041.26205 1262.26101   104%     -   63s
     0     0 1151.01081    0  601 -33041.262 1151.01081   103%     -   67s
     0     0  953.73868    0  614 -33041.262  953.73868   103%     -   72s
     0     0  925.07426    0  622 -33041.262  925.07426   103%     -   74s
     0     0  882.01700    0  632 -33041.262  882.01700   103%     -   76s
H    0     0                    -13913.37523  825.62793   106%     -   79s
H    0     0                    -12095.43218  825.62793   107%     -   79s
H    0     0                    -11812.70650  825.62793   107%     -   79s
     0     0  825.62793    0  627 -11812.706  825.62793   107%     -   79s
     0     0  823.88124    0  629 -11812.706  823.88124   107%     -   79s
     0     0  817.66688    0  635 -11812.706  817.66688   107%     -   80s
     0     0  817.64749    0  635 -11812.706  817.64749   107%     -   80s
     0     0 -130.35236    0  652 -11812.706 -130.35236  98.9%     -   97s
H    0     0                    -11808.20024 -130.36288  98.9%     -   98s
     0     0 -294.34375    0  614 -11808.200 -294.34375  97.5%     -  102s
     0     0 -410.99437    0  614 -11808.200 -410.99437  96.5%     -  106s
     0     0 -424.74977    0  674 -11808.200 -424.74977  96.4%     -  108s
     0     0 -430.79736    0  617 -11808.200 -430.79736  96.4%     -  109s
     0     0 -435.70494    0  623 -11808.200 -435.70494  96.3%     -  110s
     0     0 -436.99407    0  676 -11808.200 -436.99407  96.3%     -  110s
     0     0 -437.98623    0  623 -11808.200 -437.98623  96.3%     -  111s
H    0     0                    -11801.57556 -437.98623  96.3%     -  119s
H    0     0                    -11800.99100 -1064.9510  91.0%     -  133s
     0     0 -1064.9510    0  677 -11800.991 -1064.9510  91.0%     -  133s
     0     0 -1236.6044    0  685 -11800.991 -1236.6044  89.5%     -  140s
     0     0 -1315.4366    0  667 -11800.991 -1315.4366  88.9%     -  144s
     0     0 -1402.8944    0  663 -11800.991 -1402.8944  88.1%     -  148s
     0     0 -1420.2182    0  689 -11800.991 -1420.2182  88.0%     -  151s
     0     0 -1431.4927    0  689 -11800.991 -1431.4927  87.9%     -  154s
     0     0 -1435.3853    0  690 -11800.991 -1435.3853  87.8%     -  155s
     0     0 -1437.0169    0  692 -11800.991 -1437.0169  87.8%     -  156s
     0     0 -1442.1659    0  696 -11800.991 -1442.1659  87.8%     -  157s
     0     0 -1442.5584    0  698 -11800.991 -1442.5584  87.8%     -  157s
     0     0 -1571.9327    0  725 -11800.991 -1571.9327  86.7%     -  165s
     0     0 -1595.7585    0  742 -11800.991 -1595.7585  86.5%     -  168s
     0     0 -1602.4089    0  729 -11800.991 -1602.4089  86.4%     -  170s
     0     0 -1604.4670    0  742 -11800.991 -1604.4670  86.4%     -  171s
     0     0 -1605.6748    0  737 -11800.991 -1605.6748  86.4%     -  171s
     0     0 -1679.6052    0  733 -11800.991 -1679.6052  85.8%     -  180s
H    0     0                    -11707.21384 -1680.0160  85.6%     -  182s
H    0     0                    -11698.78589 -1680.0160  85.6%     -  182s
H    0     0                    -11675.21353 -1680.0160  85.6%     -  182s
     0     0 -1704.4529    0  740 -11675.214 -1704.4529  85.4%     -  185s
     0     0 -1711.1069    0  746 -11675.214 -1711.1069  85.3%     -  187s
     0     0 -1713.9993    0  757 -11675.214 -1713.9993  85.3%     -  187s
     0     0 -1715.2785    0  763 -11675.214 -1715.2785  85.3%     -  188s
     0     0 -1729.5674    0  680 -11675.214 -1729.5674  85.2%     -  191s
     0     0 -1733.9680    0  689 -11675.214 -1733.9680  85.1%     -  192s
     0     0 -1735.5512    0  696 -11675.214 -1735.5512  85.1%     -  193s
     0     0 -1736.1330    0  702 -11675.214 -1736.1330  85.1%     -  194s
     0     0 -1748.5061    0  696 -11675.214 -1748.5061  85.0%     -  197s
H    0     0                    -11668.26839 -1748.5256  85.0%     -  198s
     0     0 -1750.5667    0  691 -11668.268 -1750.5667  85.0%     -  198s
     0     0 -1751.6872    0  692 -11668.268 -1751.6872  85.0%     -  199s
     0     0 -1763.5434    0  699 -11668.268 -1763.5434  84.9%     -  201s
     0     0 -1766.4125    0  706 -11668.268 -1766.4125  84.9%     -  202s
     0     0 -1769.4585    0  701 -11668.268 -1769.4585  84.8%     -  203s
     0     0 -1769.7487    0  704 -11668.268 -1769.7487  84.8%     -  204s
     0     0 -1778.0810    0  687 -11668.268 -1778.0810  84.8%     -  206s
     0     0 -1781.7990    0  704 -11668.268 -1781.7990  84.7%     -  210s
     0     0 -1782.6371    0  704 -11668.268 -1782.6371  84.7%     -  211s
     0     0 -1789.9556    0  701 -11668.268 -1789.9556  84.7%     -  213s
     0     0 -1792.0647    0  700 -11668.268 -1792.0647  84.6%     -  214s
     0     0 -1792.9254    0  715 -11668.268 -1792.9254  84.6%     -  214s
     0     0 -1809.0064    0  710 -11668.268 -1809.0064  84.5%     -  218s
     0     0 -1814.1729    0  703 -11668.268 -1814.1729  84.5%     -  220s
     0     0 -1817.0510    0  705 -11668.268 -1817.0510  84.4%     -  222s
     0     0 -1818.1875    0  710 -11668.268 -1818.1875  84.4%     -  223s
     0     0 -1828.4328    0  768 -11668.268 -1828.4328  84.3%     -  226s
     0     0 -1830.2387    0  710 -11668.268 -1830.2387  84.3%     -  227s
     0     0 -1831.1116    0  712 -11668.268 -1831.1116  84.3%     -  227s
     0     0 -1839.8359    0  713 -11668.268 -1839.8359  84.2%     -  231s
     0     0 -1841.8668    0  714 -11668.268 -1841.8668  84.2%     -  233s
     0     0 -1843.2854    0  728 -11668.268 -1843.2854  84.2%     -  233s
     0     0 -1844.4530    0  724 -11668.268 -1844.4530  84.2%     -  235s
     0     0 -1844.6741    0  725 -11668.268 -1844.6741  84.2%     -  235s
     0     0 -1846.8274    0  727 -11668.268 -1846.8274  84.2%     -  237s
     0     0 -1846.9400    0  727 -11668.268 -1846.9400  84.2%     -  239s
     0     2 -1846.9493    0  727 -11668.268 -1846.9493  84.2%     -  279s
     1     4 -1940.7549    1  692 -11668.268 -1847.0599  84.2%  4255  287s
     3     8 -2143.2185    2  686 -11668.268 -1941.8644  83.4%  4927  298s
     7    16 -2266.1097    3  673 -11668.268 -2144.3796  81.6%  5341  308s
    15    32 -2379.3401    4  693 -11668.268 -2267.6073  80.6%  4961  322s
H   31    53                    -11662.27135 -2379.3409  79.6%  6281  340s
    52    85 -5161.8206    6  505 -11662.271 -2379.3632  79.6%  7116  351s
H   84   200                    -11638.95084 -2379.3632  79.6%  5836  361s
H  111   200                    -11312.35684 -2379.3632  79.0%  4756  361s
H  192   200                    -11312.18762 -2379.3632  79.0%  3277  361s
H  207   230                    -11291.67188 -2379.3632  78.9%  3076  369s
H  210   230                    -11286.62923 -2379.3632  78.9%  3055  369s
H  213   230                    -11266.90931 -2379.3632  78.9%  3027  369s
H  218   230                    -11266.11349 -2379.3632  78.9%  2980  369s
   284   263 -5609.9990   10  450 -11266.113 -2379.3632  78.9%  2570  377s
   343   307 infeasible    8      -11266.113 -2379.3632  78.9%  2399  386s
   411   329 -7126.2203   12  394 -11266.113 -2379.3632  78.9%  2298  393s
   464   355 infeasible   12      -11266.113 -2379.3632  78.9%  2210  400s
   521   387 -7520.1114   13  296 -11266.113 -2379.3632  78.9%  2207  408s
   559   418 -7498.8380   14  308 -11266.113 -2379.3632  78.9%  2206  416s
   608   455 -7592.2686   15  248 -11266.113 -2379.3632  78.9%  2200  423s
   663   487 -7880.4843   16  541 -11266.113 -2379.3632  78.9%  2193  431s
   715   540 infeasible   14      -11266.113 -2379.3632  78.9%  2156  438s
   780   585 -8463.0141   17  341 -11266.113 -2379.3632  78.9%  2133  446s
   858   606 -8590.5717   18  356 -11266.113 -2379.3632  78.9%  2084  453s
   897   638 -8738.7935   19  303 -11266.113 -2379.3632  78.9%  2090  469s
   945   668 -9023.3175   20  272 -11266.113 -2379.3632  78.9%  2091  476s
   999   689 -8981.5014   20  291 -11266.113 -2379.3632  78.9%  2057  485s
  1051   720 -10963.315   21  266 -11266.113 -2379.3632  78.9%  2037  494s
  1112   763 -10104.804   21  320 -11266.113 -2379.3632  78.9%  2017  503s
  1177   810 -10347.436   22  250 -11266.113 -2379.3632  78.9%  2000  512s
  1254   869 -11024.553   26  173 -11266.113 -2379.3632  78.9%  1972  521s
  1353   904 infeasible   29      -11266.113 -2379.3632  78.9%  1936  530s
  1440   939 -5391.6038   10  505 -11266.113 -2379.3632  78.9%  1933  541s
  1529   976 -9149.3792   11  133 -11266.113 -2379.3632  78.9%  1931  551s
  1604  1028 infeasible   12      -11266.113 -2379.3632  78.9%  1933  562s
  1713  1070 -10658.199   22  100 -11266.113 -2379.3632  78.9%  1926  572s
  1862  1087 infeasible   31      -11266.113 -2379.3632  78.9%  1875  582s
  1907  1121 -4807.0959    8  668 -11266.113 -2467.5186  78.1%  1904  593s
  1960  1150 -4900.8266   10  655 -11266.113 -2468.0726  78.1%  1915  604s
  2027  1197 -5574.0519   12  560 -11266.113 -2468.0726  78.1%  1926  615s
  2135  1245 -5949.5761   13  621 -11266.113 -2468.0726  78.1%  1909  628s
  2245  1303 -9978.4128   14  674 -11266.113 -2468.0726  78.1%  1909  641s
  2380  1353 -10104.013   15  613 -11266.113 -2468.0726  78.1%  1885  653s
  2494  1414 -10801.432   17  567 -11266.113 -2468.0726  78.1%  1881  666s
  2644  1457 -11256.518   20  529 -11266.113 -3076.7710  72.7%  1866  679s
  2729  1509 infeasible   21      -11266.113 -3076.7710  72.7%  1871  693s
  2865  1561 -6725.8583   18  393 -11266.113 -3076.7710  72.7%  1866  708s
  2997  1607 -9097.8373   19  346 -11266.113 -3076.7710  72.7%  1873  723s
  3105  1699 -9705.4792   21  244 -11266.113 -3076.7710  72.7%  1880  739s
  3281  1783 -10736.448   27  389 -11266.113 -4018.5701  64.3%  1871  755s
  3488  1893 -7446.5381    9  498 -11266.113 -4108.8812  63.5%  1858  769s
  3741  1970 -5562.4576    9  492 -11266.113 -4108.8812  63.5%  1833  785s
  3968  2075 infeasible   12      -11266.113 -4397.4122  61.0%  1799  801s
  4174  2180 -10551.499   12  213 -11266.113 -4453.9767  60.5%  1802  819s
  4408  2262 -8617.0199   12  186 -11266.113 -4510.6210  60.0%  1795  838s
  4661  2413 -7741.2219   11  481 -11266.113 -4719.4478  58.1%  1791  855s
  4927  2414 -10526.887   40  727 -11266.113 -4766.1929  57.7%  1782  920s
  4929  2415 -8109.1966   16  450 -11266.113 -4766.1929  57.7%  1782  946s
  4930  2416 -8851.9313   16  703 -11266.113 -4766.1929  57.7%  1781  971s
  4931  2417 -10429.226   16  624 -11266.113 -4766.1929  57.7%  1781  991s
  4932  2417 -7768.2622   17  666 -11266.113 -4766.1929  57.7%  1781 1006s
  4933  2418 -8436.5826   14  799 -11266.113 -4766.1929  57.7%  1780 1020s
  4934  2419 -9380.2892   29  707 -11266.113 -4766.1929  57.7%  1780 1026s
  4935  2419 -7016.3719   13  772 -11266.113 -4766.1929  57.7%  1779 1031s
  4936  2420 -10014.545   34  731 -11266.113 -4766.1929  57.7%  1779 1038s
  4937  2421 -6647.4219    8  704 -11266.113 -4766.1929  57.7%  1779 1041s
  4939  2422 -9256.3025   34  719 -11266.113 -4766.1929  57.7%  1778 1048s
  4940  2423 -5340.1642    8  708 -11266.113 -4766.1929  57.7%  1778 1061s
  4941  2423 -7997.1808   30  816 -11266.113 -4766.1929  57.7%  1777 1067s
  4942  2424 -9399.8393   24  716 -11266.113 -4766.1929  57.7%  1777 1071s
  4944  2425 -8603.4918   17  768 -11266.113 -4766.1929  57.7%  1776 1078s
  4945  2426 -10467.776   37  815 -11266.113 -4766.1929  57.7%  1776 1094s
  4946  2427 -6577.7346   16  753 -11266.113 -4766.1929  57.7%  1775 1099s
  4947  2427 -10725.225   39  765 -11266.113 -4766.1929  57.7%  1775 1102s
  4948  2428 -9461.8349   27  766 -11266.113 -4766.1929  57.7%  1775 1105s
  4949  2429 -10696.948   17  830 -11266.113 -4766.1929  57.7%  1774 1113s
  4950  2429 -8906.1030   19  821 -11266.113 -4766.1929  57.7%  1774 1119s
  4951  2430 -8523.2399   25  861 -11266.113 -4766.1929  57.7%  1774 1127s
  4952  2431 -10323.906   48  727 -11266.113 -4766.1929  57.7%  1773 1132s
  4953  2431 -6084.9402   12  705 -11266.113 -4766.1929  57.7%  1773 1136s
  4954  2432 -8872.6701   18  838 -11266.113 -4766.1929  57.7%  1773 1143s
  4955  2433 -9819.8653   29  848 -11266.113 -4766.1929  57.7%  1772 1147s
  4956  2433 -5257.3088   12  835 -11266.113 -4766.1929  57.7%  1772 1153s
  4957  2434 -8120.7896   18  835 -11266.113 -4766.1929  57.7%  1772 1177s
H 4957  2311                    -11146.14634 -4766.1929  57.2%  1772 1199s
H 4957  2195                    -11114.55187 -4766.1929  57.1%  1772 1199s
H 4957  2085                    -11069.92970 -4766.1929  56.9%  1772 1200s
H 4958  1983                    -11052.77659 -4766.1929  56.9%  1816 1201s
  4959  1984 -4766.1929   15  737 -11052.777 -4766.1929  56.9%  1817 1213s
  4961  1988 -4766.1929   16  727 -11052.777 -4766.1929  56.9%  1820 1226s
  4965  1994 -4766.1929   17  748 -11052.777 -4766.1929  56.9%  1822 1245s
  4973  2008 -4766.1929   18  768 -11052.777 -4766.1929  56.9%  1829 1266s
  4989  2021 -7104.0660   19  226 -11052.777 -4766.1929  56.9%  1857 1305s
  5008  2039 -7958.9474   20  740 -11052.777 -4766.1929  56.9%  1912 1323s
H 5040  2029                    -11051.61707 -4766.1929  56.9%  1947 1344s
H 5041  1934                    -11032.60101 -4766.1929  56.8%  1950 1344s
H 5046  1842                    -11004.39526 -4766.1929  56.7%  1953 1344s
H 5102  1739                    -10996.01707 -4766.1929  56.7%  1989 1344s
H 5133  1647                    -10988.14137 -4766.1929  56.6%  1994 1344s
  5155  1677 -8499.3319   22  775 -10988.141 -4766.1929  56.6%  2002 1354s
  5232  1660 -8553.3019   23  746 -10988.141 -4766.1929  56.6%  2035 1365s
H 5244  1579                    -10986.98184 -4766.1929  56.6%  2038 1365s
  5267  1569 -6626.5352   26  533 -10986.982 -4766.1929  56.6%  2047 1375s
  5299  1570 -8674.0778   24  739 -10986.982 -4766.1929  56.6%  2065 1387s
  5333  1567 -8787.9550   26  427 -10986.982 -4766.1929  56.6%  2090 1397s
  5377  1553 -9411.0228   27  328 -10986.982 -4766.1929  56.6%  2105 1408s
  5420  1554 -10091.896   28  436 -10986.982 -4766.1929  56.6%  2126 1422s
  5460  1547 -8154.8638   31  393 -10986.982 -4766.1929  56.6%  2151 1434s
  5512  1544 -8557.4734   34  169 -10986.982 -4766.1929  56.6%  2181 1446s
  5564  1542     cutoff   36      -10986.982 -4766.1929  56.6%  2210 1456s
  5613  1540 -9263.7238   36  310 -10986.982 -4766.1929  56.6%  2237 1466s
  5672  1540 -9361.4049   38  163 -10986.982 -4766.1929  56.6%  2267 1483s
  5726  1540 -9608.6232   41  223 -10986.982 -4766.1929  56.6%  2289 1494s
  5785  1537     cutoff   42      -10986.982 -4766.1929  56.6%  2315 1505s
  5850  1526 -10331.888   42  330 -10986.982 -4766.1929  56.6%  2334 1521s
  5916  1509 infeasible   47      -10986.982 -4766.1929  56.6%  2358 1533s
  5972  1500 -7152.1193   25  328 -10986.982 -4766.1929  56.6%  2394 1550s
  6007  1502 -7883.2124   26  218 -10986.982 -4766.1929  56.6%  2413 1566s
  6059  1514 -9084.6685   28  273 -10986.982 -4766.1929  56.6%  2444 1579s
  6128  1509 -9262.0307   31  261 -10986.982 -4766.1929  56.6%  2473 1598s
  6188  1509 -10231.178   35  499 -10986.982 -4766.1929  56.6%  2505 1617s
  6274  1490 -10629.246   40  213 -10986.982 -4766.1929  56.6%  2539 1632s
  6350  1501 infeasible   28      -10986.982 -4766.1929  56.6%  2572 1646s
  6420  1519 -5632.8700   22  710 -10986.982 -4766.1929  56.6%  2618 1660s
  6515  1520 -6031.1687   23  730 -10986.982 -4766.1929  56.6%  2649 1680s
  6603  1498 -7197.2449   24  624 -10986.982 -4766.1929  56.6%  2685 1698s
  6699  1520 -10410.595   25  524 -10986.982 -4766.1929  56.6%  2737 1713s
  6802  1528 -10415.412   26  458 -10986.982 -4766.1929  56.6%  2771 1729s
  6896  1533     cutoff   27      -10986.982 -4766.1929  56.6%  2819 1750s
  7004  1518 -9536.2482   25  228 -10986.982 -4766.1929  56.6%  2849 1766s
  7126  1480     cutoff   26      -10986.982 -4766.1929  56.6%  2888 1786s
  7248  1485 infeasible   36      -10986.982 -4766.1929  56.6%  2936 1809s
  7364  1486 -6058.2073   24  651 -10986.982 -4766.1929  56.6%  2986 1829s
  7528  1466 -6604.9950   26  671 -10986.982 -4766.1929  56.6%  3019 1850s
  7664  1444 -7837.7621   27  442 -10986.982 -4766.1929  56.6%  3070 1876s
  7825  1424 -10541.657   28  362 -10986.982 -5224.8653  52.4%  3112 1898s
  7987  1394 -9338.6035   28  414 -10986.982 -5224.8653  52.4%  3171 1921s
  8136  1332 -10726.796   30  315 -10986.982 -5661.9595  48.5%  3231 1944s
  8199  1333     cutoff   29      -10986.982 -5661.9595  48.5%  3269 1967s
  8285  1327 -10884.864   32  196 -10986.982 -6717.8655  38.9%  3298 1988s
  8389  1291     cutoff   33      -10986.982 -6717.8655  38.9%  3326 2012s
  8521  1244 infeasible   32      -10986.982 -6966.4905  36.6%  3376 2040s
  8671  1208 -9964.7505   35  355 -10986.982 -6966.4905  36.6%  3423 2066s
  8899  1161 -10603.849   36  347 -10986.982 -6966.4905  36.6%  3479 2092s
  9129  1064 -8858.2404   34  324 -10986.982 -7645.7779  30.4%  3536 2123s
  9378   980 infeasible   43      -10986.982 -7645.7779  30.4%  3591 2149s
  9474   953 -10376.105   43  183 -10986.982 -7645.7779  30.4%  3620 2178s
  9736   931 -10805.603   37  407 -10986.982 -8049.4398  26.7%  3653 2211s
* 9766   931              38    -10986.30886 -8059.3519  26.6%  3648 2211s
 10044   835 -10454.948   28  146 -10986.309 -8272.8758  24.7%  3683 2246s
 10421   718 -9720.6050   34  347 -10986.309 -8497.2824  22.7%  3700 2279s
*10581   718              50    -10959.20163 -8661.7720  21.0%  3711 2279s
*10721   718              82    -10928.24955 -8692.3986  20.5%  3705 2279s
 10835   406 infeasible   27      -10928.250 -8740.8232  20.0%  3705 2315s
H11191   406                    -10927.48053 -8912.5639  18.4%  3673 2315s
*11194   406              46    -10925.31910 -8912.5639  18.4%  3672 2315s
 11399    78 infeasible   37      -10925.319 -9004.7285  17.6%  3662 2345s
*11627    78              48    -10924.41398 -9271.4818  15.1%  3629 2345s
*11740    78              36    -10738.93107 -9271.4818  13.7%  3622 2345s
 11843     2 -10165.753   22  586 -10738.931 -9271.4818  13.7%  3609 2375s

Cutting planes:
  Learned: 2
  MIR: 1049
  Mixing: 1
  Flow cover: 2355
  Zero half: 9
  RLT: 50
  Relax-and-lift: 149

Explored 11939 nodes (43126475 simplex iterations) in 2376.06 seconds (6769.91 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -10738.9 -10924.4 -10925.3 ... -10996
No other solutions better than -10738.9

Optimal solution found (tolerance 1.00e-04)
Best objective -1.073893106756e+04, best bound -1.073893106756e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2376.11s
  Master Objective (UB) = -10738.93, θ = 110891.57
  Upper Bound (UB) = -10738.93

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 110891.57
  [DEBUG]   ✓ Scenario 0: θ = 110891.57 ≤ Q = 110891.57 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 110891.57 ≤ Q = 110891.57 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 110891.57 ≤ Q = 110891.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 110891.57 ≤ Q = 110891.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 110891.57 ≤ Q = 110891.57 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 110891.57 ≤ Q = 110891.57 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x62f57847
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x62f57847
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.316569e+13
Presolve removed 2584 rows and 1876 columns
Presolve time: 0.00s
Presolved: 509 rows, 513 columns, 1436 nonzeros
Found heuristic solution: objective 6779943.4603
Variable types: 346 continuous, 167 integer (167 binary)

Root relaxation: objective -1.282362e+05, 250 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -128236.23    0  131 6779943.46 -128236.23   102%     -    0s
H    0     0                    -90240.64333 -128236.23  42.1%     -    0s
H    0     0                    -101346.7894 -128236.23  26.5%     -    0s
     0     0 -107840.63    0   37 -101346.79 -107840.63  6.41%     -    0s
H    0     0                    -107209.8969 -107771.60  0.52%     -    0s
H    0     0                    -107310.4588 -107491.39  0.17%     -    0s
     0     0 -107491.39    0   33 -107310.46 -107491.39  0.17%     -    0s
     0     0 -107392.01    0   11 -107310.46 -107392.01  0.08%     -    0s
     0     0 -107390.73    0   11 -107310.46 -107390.73  0.07%     -    0s
     0     0 -107390.54    0   11 -107310.46 -107390.54  0.07%     -    0s
     0     0 -107370.61    0    6 -107310.46 -107370.61  0.06%     -    0s
     0     0 -107370.61    0   16 -107310.46 -107370.61  0.06%     -    0s
     0     0 -107337.77    0    2 -107310.46 -107337.77  0.03%     -    0s
H    0     0                    -107337.3063 -107337.31  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 8
  Flow cover: 4

Explored 1 nodes (562 simplex iterations) in 0.04 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 6: -107337 -107310 -101347 ... 1.31657e+13
No other solutions better than -107337

Optimal solution found (tolerance 1.00e-04)
Best objective -1.073373063188e+05, best bound -1.073373063188e+05, gap 0.0000%
  Subproblem solved in 0.06s
  Worst-case operational profit (Z_SP) = 95930.87
  Scenario: 13 demand increases, 47 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -107337.31
  [DEBUG]   S×d_nominal = 203268.18
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 203268.18 + -107337.31 = 95930.87
  [DEBUG]   Current θ from Master = 110891.57
  [DEBUG]   ⚠️  Z_SP ≤ θ by 14960.70 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -25699.63
  Lower Bound (LB) = -13018.71
  Gap (UB-LB) = 2279.7828, Absolute Gap = 2279.7828, Relative Gap = 0.212291
  Not converged yet (gap = 2279.78 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 13 increases, 47 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308220 nonzeros
Model fingerprint: 0x5d4f4d91
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 46702 rows and 18962 columns
Presolve time: 0.98s
Presolved: 61711 rows, 26978 columns, 383749 nonzeros
Variable types: 24719 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -383874.0427
Found heuristic solution: objective -190756.9345

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 61711 rows, 26978 columns, 383749 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   33247   -4.6084396e+04   0.000000e+00   2.616395e+10      5s
   43879   -9.0920770e+03   0.000000e+00   1.423397e+07     10s
   50791   -1.1490239e+03   0.000000e+00   6.842863e+07     15s
   58147    1.2363035e+03   0.000000e+00   1.772921e+07     20s
   64471    2.0922447e+03   0.000000e+00   3.497602e+06     25s
   70319    2.3466190e+03   0.000000e+00   4.600492e+06     30s
   76673    4.3418409e+03   0.000000e+00   8.160466e+05     35s
Concurrent spin time: 11.34s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 8.091907e+03, 74189 iterations, 48.70 seconds (86.72 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 8091.90663    0  450 -190756.93 8091.90663   104%     -   50s
H    0     0                    -179650.1956 8091.90663   105%     -   50s
H    0     0                    -136360.1387 8091.90663   106%     -   50s
H    0     0                    -134503.8068 8091.90663   106%     -   50s
H    0     0                    -124851.4231 8091.90663   106%     -   50s
H    0     0                    -124496.7364 8091.90663   106%     -   50s
H    0     0                    -112229.2262 8091.90663   107%     -   50s
H    0     0                    -103854.2447 8091.90663   108%     -   50s
H    0     0                    -103699.5279 8091.90663   108%     -   50s
H    0     0                    -80223.30881 8091.90663   110%     -   50s
H    0     0                    -63530.67715 8091.90663   113%     -   50s
H    0     0                    -59945.70670 8091.90663   113%     -   50s
H    0     0                    -48936.85345 8091.90663   117%     -   51s
H    0     0                    -48889.47025 8091.90663   117%     -   51s
H    0     0                    -48679.11126 8091.90663   117%     -   51s
H    0     0                    -41400.39367 8091.90663   120%     -   51s
H    0     0                    -38378.15369 8091.90663   121%     -   51s
     0     0 3610.23938    0  494 -38378.154 3610.23938   109%     -   66s
     0     0 3104.78052    0  448 -38378.154 3104.78052   108%     -   73s
     0     0 2975.09124    0  509 -38378.154 2975.09124   108%     -   75s
     0     0 2929.76007    0  524 -38378.154 2929.76007   108%     -   78s
     0     0 2923.51356    0  517 -38378.154 2923.51356   108%     -   80s
     0     0 2866.11942    0  520 -38378.154 2866.11942   107%     -   81s
     0     0 2865.50935    0  512 -38378.154 2865.50935   107%     -   85s
     0     0 2865.50935    0  455 -38378.154 2865.50935   107%     -   86s
     0     0 2865.50935    0  454 -38378.154 2865.50935   107%     -   87s
     0     0 1292.22744    0  622 -38378.154 1292.22744   103%     -  107s
H    0     0                    -30686.20067 1292.22744   104%     -  107s
H    0     0                    -30620.09604 1292.22744   104%     -  107s
H    0     0                    -30594.60875 1292.22744   104%     -  107s
H    0     0                    -30586.09678 1292.22744   104%     -  107s
H    0     0                    -30582.18913 1292.22744   104%     -  107s
H    0     0                    -30581.05727 1292.22744   104%     -  107s
H    0     0                    -30562.04120 1292.22744   104%     -  107s
     0     0 1159.89001    0  632 -30562.041 1159.89001   104%     -  113s
     0     0 1098.61878    0  633 -30562.041 1098.61878   104%     -  115s
     0     0  915.12259    0  635 -30562.041  915.12259   103%     -  118s
     0     0  890.04810    0  631 -30562.041  890.04810   103%     -  120s
     0     0  885.13090    0  638 -30562.041  885.13090   103%     -  121s
     0     0  884.49030    0  637 -30562.041  884.49030   103%     -  121s
H    0     0                    -25857.15975  884.49030   103%     -  131s
H    0     0                    -22315.27199  884.49030   104%     -  131s
H    0     0                    -22255.92850  884.49030   104%     -  131s
H    0     0                    -22207.66828  884.49030   104%     -  131s
     0     0  -83.90889    0  595 -22207.668  -83.90889   100%     -  144s
H    0     0                    -19887.28174  -83.97589   100%     -  144s
H    0     0                    -19447.79462  -83.97589   100%     -  144s
     0     0 -229.20239    0  612 -19447.795 -229.20239  98.8%     -  151s
     0     0 -308.33791    0  606 -19447.795 -308.33791  98.4%     -  158s
H    0     0                    -12493.40840 -360.41183  97.1%     -  163s
H    0     0                    -12485.74469 -360.41183  97.1%     -  163s
     0     0 -360.41183    0  618 -12485.745 -360.41183  97.1%     -  163s
     0     0 -411.53167    0  624 -12485.745 -411.53167  96.7%     -  165s
H    0     0                    -12047.07580 -442.24301  96.3%     -  167s
H    0     0                    -11928.29670 -442.24301  96.3%     -  167s
H    0     0                    -11872.23499 -442.24301  96.3%     -  167s
     0     0 -442.24301    0  615 -11872.235 -442.24301  96.3%     -  167s
     0     0 -448.43904    0  625 -11872.235 -448.43904  96.2%     -  168s
     0     0 -452.77044    0  628 -11872.235 -452.77044  96.2%     -  169s
     0     0 -453.88895    0  622 -11872.235 -453.88895  96.2%     -  170s
     0     0 -454.13739    0  624 -11872.235 -454.13739  96.2%     -  170s
     0     0 -873.90527    0  671 -11872.235 -873.90527  92.6%     -  191s
H    0     0                    -11868.88826 -873.92450  92.6%     -  192s
H    0     0                    -11867.72874 -1100.3398  90.7%     -  202s
H    0     0                    -11831.81593 -1100.3398  90.7%     -  202s
     0     0 -1100.3398    0  645 -11831.816 -1100.3398  90.7%     -  202s
     0     0 -1228.6238    0  639 -11831.816 -1228.6238  89.6%     -  209s
H    0     0                    -11816.71325 -1267.9909  89.3%     -  213s
H    0     0                    -11687.90942 -1267.9909  89.2%     -  213s
H    0     0                    -11687.33449 -1267.9909  89.2%     -  213s
H    0     0                    -11681.26325 -1267.9909  89.1%     -  213s
H    0     0                    -11674.77257 -1267.9909  89.1%     -  213s
H    0     0                    -11668.26839 -1267.9909  89.1%     -  213s
     0     0 -1267.9909    0  649 -11668.268 -1267.9909  89.1%     -  213s
     0     0 -1280.3196    0  654 -11668.268 -1280.3196  89.0%     -  216s
     0     0 -1282.5528    0  668 -11668.268 -1282.5528  89.0%     -  217s
     0     0 -1286.9257    0  664 -11668.268 -1286.9257  89.0%     -  218s
     0     0 -1287.4725    0  663 -11668.268 -1287.4725  89.0%     -  219s
     0     0 -1415.0673    0  652 -11668.268 -1415.0673  87.9%     -  228s
     0     0 -1515.4548    0  658 -11668.268 -1515.4548  87.0%     -  235s
     0     0 -1528.7476    0  670 -11668.268 -1528.7476  86.9%     -  239s
     0     0 -1541.6927    0  677 -11668.268 -1541.6927  86.8%     -  240s
     0     0 -1544.3382    0  672 -11668.268 -1544.3382  86.8%     -  241s
     0     0 -1544.9929    0  669 -11668.268 -1544.9929  86.8%     -  242s
     0     0 -1654.7461    0  753 -11668.268 -1654.7461  85.8%     -  252s
     0     0 -1679.0532    0  776 -11668.268 -1679.0532  85.6%     -  258s
     0     0 -1693.2370    0  769 -11668.268 -1693.2370  85.5%     -  260s
     0     0 -1694.9624    0  723 -11668.268 -1694.9624  85.5%     -  262s
     0     0 -1695.9654    0  715 -11668.268 -1695.9654  85.5%     -  262s
     0     0 -1749.7878    0  736 -11668.268 -1749.7878  85.0%     -  267s
     0     0 -1756.9372    0  741 -11668.268 -1756.9372  84.9%     -  269s
     0     0 -1760.7064    0  735 -11668.268 -1760.7064  84.9%     -  270s
     0     0 -1764.7180    0  685 -11668.268 -1764.7180  84.9%     -  271s
     0     0 -1765.9009    0  738 -11668.268 -1765.9009  84.9%     -  272s
     0     0 -1790.9082    0  668 -11668.268 -1790.9082  84.7%     -  276s
H    0     0                    -11664.21660 -1790.9198  84.6%     -  278s
     0     0 -1794.0381    0  691 -11664.217 -1794.0381  84.6%     -  279s
     0     0 -1794.4676    0  684 -11664.217 -1794.4676  84.6%     -  280s
     0     0 -1811.8805    0  736 -11664.217 -1811.8805  84.5%     -  284s
     0     0 -1819.6055    0  692 -11664.217 -1819.6055  84.4%     -  288s
     0     0 -1821.8750    0  701 -11664.217 -1821.8750  84.4%     -  289s
     0     0 -1823.3979    0  708 -11664.217 -1823.3979  84.4%     -  290s
     0     0 -1823.9930    0  713 -11664.217 -1823.9930  84.4%     -  291s
     0     0 -1832.8676    0  686 -11664.217 -1832.8676  84.3%     -  294s
     0     0 -1838.5297    0  675 -11664.217 -1838.5297  84.2%     -  296s
     0     0 -1840.4466    0  690 -11664.217 -1840.4466  84.2%     -  297s
     0     0 -1840.9530    0  688 -11664.217 -1840.9530  84.2%     -  298s
     0     0 -1843.2126    0  689 -11664.217 -1843.2126  84.2%     -  300s
     0     0 -1843.7125    0  691 -11664.217 -1843.7125  84.2%     -  301s
     0     0 -1846.1698    0  690 -11664.217 -1846.1698  84.2%     -  303s
     0     0 -1847.5330    0  692 -11664.217 -1847.5330  84.2%     -  306s
     0     0 -1852.1391    0  705 -11664.217 -1852.1391  84.1%     -  308s
     0     0 -1852.5749    0  705 -11664.217 -1852.5749  84.1%     -  311s
H    0     0                    -11562.86303 -1852.5749  84.0%     -  354s
H    0     0                    -11546.01530 -1852.5749  84.0%     -  357s
H    0     0                    -11469.17141 -1852.5749  83.8%     -  358s
H    0     0                    -11457.33104 -1852.5749  83.8%     -  358s
H    0     2                    -11408.82320 -1852.5749  83.8%     -  359s
     0     2 -1852.5749    0  705 -11408.823 -1852.5749  83.8%     -  359s
     1     3 -2185.1360    1  657 -11408.823 -1852.5749  83.8%  7250  367s
     2     5 -2462.1610    2  659 -11408.823 -1852.5749  83.8%  6568  375s
     4     9 -2514.9259    3  645 -11408.823 -1909.2999  83.3%  4369  385s
     8    18 -3057.4844    3  602 -11408.823 -1909.3141  83.3%  4975  396s
    17    36 -3217.9829    4  599 -11408.823 -2074.0239  81.8%  5452  413s
H   35    53                    -11110.38970 -2109.3101  81.0%  7352  436s
H   36    53                    -11106.46800 -2109.3101  81.0%  7565  436s
    52    85 -4872.8046    6  542 -11106.468 -2109.3442  81.0%  8513  450s
H   84   164                    -10986.98184 -2109.3442  80.8%  5974  459s
   167   268 -5185.6603    8  490 -10986.982 -2109.3442  80.8%  3864  468s
   287   308 -5636.7610   10  535 -10986.982 -2109.3442  80.8%  2734  477s
   369   341 -5325.1534   12  316 -10986.982 -2109.3442  80.8%  2359  484s
   447   374 -6487.1871   12  457 -10986.982 -2109.3442  80.8%  2182  492s
   529   402 -6614.6742   13  526 -10986.982 -2109.3442  80.8%  1997  499s
   614   414 -6625.0611   14  526 -10986.982 -2109.3442  80.8%  1831  507s
   686   418 -6893.8077   16  460 -10986.982 -2109.3442  80.8%  1745  515s
   747   428 -7107.8803   17  382 -10986.982 -2109.3442  80.8%  1702  523s
   797   457 -8936.8728   17  330 -10986.982 -2109.3442  80.8%  1691  531s
   853   487 -9522.4533   18  338 -10986.982 -2109.3442  80.8%  1708  539s
   922   507 -9623.9974   19  331 -10986.982 -2109.3442  80.8%  1696  547s
   960   539 -10381.559   20  371 -10986.982 -2109.3442  80.8%  1712  555s
  1010   552 infeasible   21      -10986.982 -2109.3442  80.8%  1706  563s
  1059   589     cutoff   21      -10986.982 -2109.3442  80.8%  1698  572s
  1116   634 -8122.2082   14  251 -10986.982 -2109.3442  80.8%  1697  581s
  1197   639     cutoff   15      -10986.982 -2109.3442  80.8%  1674  591s
  1278   677     cutoff   15      -10986.982 -2109.3442  80.8%  1680  600s
  1366   706 -8753.8868    9  135 -10986.982 -2109.3442  80.8%  1661  610s
  1454   743 -8987.3226   10  108 -10986.982 -2109.3442  80.8%  1639  620s
  1559   783 -9610.0513   11   67 -10986.982 -2109.3442  80.8%  1624  630s
  1661   831 -10441.993   14   67 -10986.982 -2109.3442  80.8%  1595  639s
  1778   869 -4633.5215    9  482 -10986.982 -2238.9448  79.6%  1587  650s
  1865   907 -4650.6906   10  482 -10986.982 -2238.9562  79.6%  1596  662s
  1959   929 -6407.5221   13  200 -10986.982 -2238.9562  79.6%  1604  672s
  1997   954 -6650.3475   14  276 -10986.982 -2238.9562  79.6%  1623  685s
  2038   970 -6822.9644   15  385 -10986.982 -2295.9562  79.1%  1652  696s
  2076   989 -6890.2618   16  197 -10986.982 -2295.9562  79.1%  1661  708s
  2143  1015 -7291.2460   17  313 -10986.982 -2295.9562  79.1%  1671  718s
  2197  1038 -7370.4591   18  373 -10986.982 -2941.2375  73.2%  1667  728s
  2253  1061 -7424.0462   19  364 -10986.982 -3027.4127  72.4%  1676  741s
  2292  1075 -7498.4712   20  188 -10986.982 -3027.4127  72.4%  1685  750s
  2364  1122 -7529.8236   21  367 -10986.982 -3027.4127  72.4%  1686  762s
  2461  1149 -7532.2556   22  301 -10986.982 -3027.4127  72.4%  1681  775s
  2572  1195     cutoff   27      -10986.982 -3027.4127  72.4%  1697  790s
  2674  1247 -8693.0436   30  168 -10986.982 -3379.1415  69.2%  1715  804s
  2806  1276 infeasible   13      -10986.982 -3735.5831  66.0%  1724  819s
  3013  1306 -10251.935   17   81 -10986.982 -3916.4231  64.4%  1706  836s
  3194  1353 -6300.5855   13  188 -10986.982 -3981.6496  63.8%  1719  851s
  3333  1390 -10408.253   16  328 -10986.982 -4075.2809  62.9%  1730  868s
  3461  1478 -8762.8956   17  539 -10986.982 -4075.2809  62.9%  1759  885s
  3638  1530 infeasible   20      -10986.982 -4075.2809  62.9%  1772  902s
  3882  1581 -10529.640   22  195 -10986.982 -4818.1886  56.1%  1772  921s
  4099  1609     cutoff    9      -10986.982 -4818.1886  56.1%  1781  942s
  4361  1655 -10035.682   14  236 -10986.982 -5007.7205  54.4%  1778  962s
  4589  1674 -9337.1283   18  107 -10986.982 -5188.1488  52.8%  1789  982s
  4758  1706 -7481.0519   15  396 -10986.982 -5440.6173  50.5%  1807 1003s
  4963  1733     cutoff   20      -10986.982 -5440.6173  50.5%  1825 1025s
  5230  1788 -10108.422   19  407 -10986.982 -5440.6173  50.5%  1830 1047s
  5540  1803 -10017.025   21  266 -10986.982 -5724.6250  47.9%  1830 1068s
  5827  1823 -10365.834   13  284 -10986.982 -5912.7141  46.2%  1843 1090s
  6021  1889 -8332.7626   14  479 -10986.982 -6010.9566  45.3%  1861 1115s
  6266  1954     cutoff   18      -10986.982 -6115.1007  44.3%  1878 1139s
  6646  1970 -10554.961   13   91 -10986.982 -6180.4537  43.7%  1872 1165s
  7005  1989     cutoff   29      -10986.982 -6393.5592  41.8%  1877 1202s
  7353  2015 -10444.075   38  170 -10986.982 -6520.0949  40.7%  1877 1229s
  7769  2050 -9676.5234   18  280 -10986.982 -6617.8918  39.8%  1876 1258s
  8207  2018 -9344.5068   13  381 -10986.982 -6617.8918  39.8%  1874 1288s
  8673  2037     cutoff   22      -10986.982 -6880.5636  37.4%  1873 1317s
  9005  2051 -10870.218   15  348 -10986.982 -7033.2340  36.0%  1882 1347s
  9330  2047 -9023.0956   13  136 -10986.982 -7100.0913  35.4%  1887 1379s
  9883  2072 -10778.886   15  126 -10986.982 -7300.6718  33.6%  1877 1416s
 10519  2076 -10005.812   14  436 -10986.982 -7416.4507  32.5%  1863 1451s
 11110  2045     cutoff   25      -10986.982 -7677.8863  30.1%  1856 1487s
 11656  1911     cutoff   17      -10986.982 -7849.9125  28.6%  1856 1525s
 12264  1806 infeasible   22      -10986.982 -8008.4578  27.1%  1858 1563s
 12966  1683 -10746.660   18  409 -10986.982 -8275.0766  24.7%  1845 1601s
 13793  1620 -10979.113   30  164 -10986.982 -8420.2312  23.4%  1822 1638s
 14296  1391     cutoff   27      -10986.982 -8616.6370  21.6%  1806 1680s
 15414   905 -10684.720   11  408 -10986.982 -8968.2927  18.4%  1760 1719s
 16789    90 -9984.7174   30  265 -10986.982 -9394.6253  14.5%  1696 1749s
 18861     0     cutoff   29      -10986.982 -10492.326  4.50%  1558 1751s

Cutting planes:
  Learned: 4
  Implied bound: 5
  MIR: 778
  Flow cover: 2107
  Zero half: 20
  RLT: 82
  Relax-and-lift: 50

Explored 19099 nodes (29723314 simplex iterations) in 1751.65 seconds (5204.27 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -10987 -11106.5 -11110.4 ... -11668.3
No other solutions better than -10987

Optimal solution found (tolerance 1.00e-04)
Best objective -1.098698184469e+04, best bound -1.098698184469e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1751.72s
  Master Objective (UB) = -10986.98, θ = 119337.93
  Upper Bound (UB) = -10986.98

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 119337.93
  [DEBUG]   ✓ Scenario 0: θ = 119337.93 ≤ Q = 119337.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 119337.93 ≤ Q = 119337.93 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 119337.93 ≤ Q = 119337.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 119337.93 ≤ Q = 119337.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 119337.93 ≤ Q = 119337.93 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 119337.93 ≤ Q = 119337.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 119337.93 ≤ Q = 119337.93 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x5af4c508
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xa50b3af8
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [3e-01, 2e+02]
Found heuristic solution: objective 1.246165e+13
Presolve removed 2577 rows and 1870 columns
Presolve time: 0.00s
Presolved: 516 rows, 519 columns, 1455 nonzeros
Found heuristic solution: objective 6743634.5840
Variable types: 351 continuous, 168 integer (168 binary)

Root relaxation: objective -1.173472e+05, 261 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -117347.17    0  136 6743634.58 -117347.17   102%     -    0s
H    0     0                    -83394.89633 -117347.17  40.7%     -    0s
H    0     0                    -85249.93312 -117347.17  37.7%     -    0s
H    0     0                    -91813.08259 -100208.44  9.14%     -    0s
H    0     0                    -95106.14845 -100208.44  5.36%     -    0s
     0     0 -100208.44    0   93 -95106.148 -100208.44  5.36%     -    0s
H    0     0                    -97719.21908 -100107.67  2.44%     -    0s
     0     0 -100107.67    0   91 -97719.219 -100107.67  2.44%     -    0s
H    0     0                    -98861.79663 -100107.67  1.26%     -    0s
     0     0 -99762.595    0   93 -98861.797 -99762.595  0.91%     -    0s
     0     0 -99722.902    0   92 -98861.797 -99722.902  0.87%     -    0s
     0     0 -99722.902    0   92 -98861.797 -99722.902  0.87%     -    0s
     0     0 -99383.695    0   59 -98861.797 -99383.695  0.53%     -    0s
H    0     0                    -98876.20328 -99350.106  0.48%     -    0s
     0     0 -99350.106    0   58 -98876.203 -99350.106  0.48%     -    0s
     0     0 -99340.348    0   62 -98876.203 -99340.348  0.47%     -    0s
     0     0 -99134.828    0   35 -98876.203 -99134.828  0.26%     -    0s
     0     0 -99132.021    0   32 -98876.203 -99132.021  0.26%     -    0s
     0     0 -99131.976    0   31 -98876.203 -99131.976  0.26%     -    0s
     0     0 -99102.931    0   27 -98876.203 -99102.931  0.23%     -    0s
     0     0 -99067.289    0   27 -98876.203 -99067.289  0.19%     -    0s
     0     0 -99067.138    0   27 -98876.203 -99067.138  0.19%     -    0s
     0     0 -98986.287    0   22 -98876.203 -98986.287  0.11%     -    0s
     0     0 -98986.287    0   18 -98876.203 -98986.287  0.11%     -    0s
     0     0 -98900.841    0   13 -98876.203 -98900.841  0.02%     -    0s
     0     0 -98900.301    0   12 -98876.203 -98900.301  0.02%     -    0s
H    0     0                    -98878.13974 -98897.086  0.02%     -    0s
     0     0 -98893.924    0    9 -98878.140 -98893.924  0.02%     -    0s
     0     0 -98893.380    0    8 -98878.140 -98893.380  0.02%     -    0s
     0     0 -98893.370    0    8 -98878.140 -98893.370  0.02%     -    0s
     0     0 -98892.903    0    8 -98878.140 -98892.903  0.01%     -    0s
     0     0 -98892.463    0    8 -98878.140 -98892.463  0.01%     -    0s
     0     0 -98892.402    0    8 -98878.140 -98892.402  0.01%     -    0s
H    0     0                    -98881.22589 -98892.402  0.01%     -    0s

Cutting planes:
  Gomory: 5
  Implied bound: 8
  MIR: 9
  Flow cover: 10
  Relax-and-lift: 1

Explored 1 nodes (906 simplex iterations) in 0.11 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -98881.2 -98878.1 -98876.2 ... 6.74363e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -9.888122589134e+04, best bound -9.888792115729e+04, gap 0.0068%
  Subproblem solved in 0.13s
  Worst-case operational profit (Z_SP) = 104040.62
  Scenario: 39 demand increases, 21 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -98881.23
  [DEBUG]   S×d_nominal = 202921.85
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 202921.85 + -98881.23 = 104040.62
  [DEBUG]   Current θ from Master = 119337.93
  [DEBUG]   ⚠️  Z_SP ≤ θ by 15297.31 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -26284.29
  Lower Bound (LB) = -13018.71
  Gap (UB-LB) = 2031.7320, Absolute Gap = 2031.7320, Relative Gap = 0.184922
  Not converged yet (gap = 2031.73 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 39 increases, 21 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351463 nonzeros
Model fingerprint: 0xd888d3f6
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 53388 rows and 21678 columns
Presolve time: 1.10s
Presolved: 70315 rows, 30502 columns, 437739 nonzeros
Variable types: 28243 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -383874.0427
Found heuristic solution: objective -190756.9345

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 70315 rows, 30502 columns, 437739 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   34128   -4.8690415e+04   0.000000e+00   3.116677e+09      5s
   44664   -6.9060424e+03   0.000000e+00   9.658627e+06     10s
   52044   -4.8183423e+03   0.000000e+00   4.296322e+06     15s
   58917   -3.8601275e+03   0.000000e+00   7.209034e+10     20s
   65745   -2.7648702e+03   0.000000e+00   2.327700e+06     25s
   72881   -1.3691271e+03   0.000000e+00   1.643448e+06     30s
   78848   -1.5467304e+01   0.000000e+00   4.180132e+07     35s
   84338    2.2478098e+03   0.000000e+00   3.392524e+07     40s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 8.091907e+03, 73917 iterations, 41.15 seconds (91.06 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 8091.90663    0  450 -190756.93 8091.90663   104%     -   42s
H    0     0                    -182098.2188 8091.90663   104%     -   42s
H    0     0                    -133002.7478 8091.90663   106%     -   43s
H    0     0                    -132700.2343 8091.90663   106%     -   43s
H    0     0                    -80182.58388 8091.90663   110%     -   43s
H    0     0                    -80139.58691 8091.90663   110%     -   43s
H    0     0                    -72692.89778 8091.90663   111%     -   43s
H    0     0                    -58986.90501 8091.90663   114%     -   43s
H    0     0                    -45752.14029 8091.90663   118%     -   44s
H    0     0                    -39643.35044 8091.90663   120%     -   44s
H    0     0                    -39058.34864 8091.90663   121%     -   44s
H    0     0                    -39047.51945 8091.90663   121%     -   44s
H    0     0                    -39039.88771 8091.90663   121%     -   44s
H    0     0                    -39038.54619 8091.90663   121%     -   44s
     0     0 3280.55834    0  471 -39038.546 3280.55834   108%     -   61s
     0     0 3002.82667    0  554 -39038.546 3002.82667   108%     -   68s
     0     0 2884.02382    0  569 -39038.546 2884.02382   107%     -   70s
     0     0 2840.25344    0  568 -39038.546 2840.25344   107%     -   71s
     0     0 2799.91597    0  513 -39038.546 2799.91597   107%     -   77s
     0     0 2799.91597    0  515 -39038.546 2799.91597   107%     -   78s
     0     0 2799.91597    0  518 -39038.546 2799.91597   107%     -   78s
     0     0 2799.91597    0  436 -39038.546 2799.91597   107%     -   80s
     0     0 2799.91597    0  560 -39038.546 2799.91597   107%     -   82s
     0     0 2799.91597    0  552 -39038.546 2799.91597   107%     -   83s
     0     0 2799.91597    0  554 -39038.546 2799.91597   107%     -   83s
H    0     0                    -36505.60246 1123.47368   103%     -  104s
H    0     0                    -36019.24795 1123.47368   103%     -  104s
     0     0 1112.70027    0  668 -36019.248 1112.70027   103%     -  104s
H    0     0                    -32291.77811 1112.70027   103%     -  105s
H    0     0                    -30397.23733 1112.70027   104%     -  105s
     0     0  880.58324    0  609 -30397.237  880.58324   103%     -  116s
     0     0  826.45592    0  620 -30397.237  826.45592   103%     -  119s
     0     0  725.90534    0  625 -30397.237  725.90534   102%     -  123s
H    0     0                    -28001.37459  589.76247   102%     -  129s
H    0     0                    -27953.11437  589.76247   102%     -  129s
H    0     0                    -25252.14873  589.76247   102%     -  129s
H    0     0                    -25150.76871  589.76247   102%     -  129s
H    0     0                    -24844.38701  589.76247   102%     -  129s
H    0     0                    -24447.55226  589.76247   102%     -  129s
H    0     0                    -24419.56401  589.76247   102%     -  129s
     0     0  589.76247    0  630 -24419.564  589.76247   102%     -  129s
     0     0  508.70374    0  644 -24419.564  508.70374   102%     -  133s
     0     0  491.36561    0  642 -24419.564  491.36561   102%     -  136s
     0     0  490.57694    0  640 -24419.564  490.57694   102%     -  136s
H    0     0                    -15021.23749  490.57694   103%     -  147s
H    0     0                    -14706.98355  490.57694   103%     -  147s
H    0     0                    -14464.00488  490.57694   103%     -  147s
H    0     0                    -14310.25640  490.57694   103%     -  147s
H    0     0                    -14072.21512 -448.27341  96.8%     -  168s
     0     0 -448.27341    0  727 -14072.215 -448.27341  96.8%     -  168s
H    0     0                    -13719.37006 -448.68273  96.7%     -  169s
H    0     0                    -13609.57806 -448.68273  96.7%     -  169s
H    0     0                    -13579.43559 -448.68273  96.7%     -  169s
H    0     0                    -13578.05516 -448.68273  96.7%     -  169s
     0     0 -677.41117    0  707 -13578.055 -677.41117  95.0%     -  178s
     0     0 -724.04292    0  644 -13578.055 -724.04292  94.7%     -  182s
     0     0 -841.19782    0  637 -13578.055 -841.19782  93.8%     -  191s
     0     0 -852.79587    0  642 -13578.055 -852.79587  93.7%     -  193s
     0     0 -858.23363    0  643 -13578.055 -858.23363  93.7%     -  194s
     0     0 -859.24726    0  646 -13578.055 -859.24726  93.7%     -  195s
H    0     0                    -11721.68539 -859.24726  92.7%     -  205s
H    0     0                    -11716.60417 -859.24726  92.7%     -  205s
H    0     0                    -11709.39493 -859.24726  92.7%     -  205s
     0     0 -1241.9641    0  653 -11709.395 -1241.9641  89.4%     -  224s
     0     0 -1523.3260    0  628 -11709.395 -1523.3260  87.0%     -  236s
     0     0 -1587.7867    0  634 -11709.395 -1587.7867  86.4%     -  244s
     0     0 -1622.9740    0  637 -11709.395 -1622.9740  86.1%     -  251s
     0     0 -1681.5281    0  636 -11709.395 -1681.5281  85.6%     -  257s
     0     0 -1686.4229    0  652 -11709.395 -1686.4229  85.6%     -  259s
     0     0 -1693.4097    0  637 -11709.395 -1693.4097  85.5%     -  261s
     0     0 -1696.6750    0  650 -11709.395 -1696.6750  85.5%     -  263s
     0     0 -1698.4739    0  652 -11709.395 -1698.4739  85.5%     -  265s
     0     0 -1698.9839    0  654 -11709.395 -1698.9839  85.5%     -  266s
     0     0 -1756.0655    0  653 -11709.395 -1756.0655  85.0%     -  274s
     0     0 -1775.1280    0  665 -11709.395 -1775.1280  84.8%     -  278s
     0     0 -1782.9448    0  671 -11709.395 -1782.9448  84.8%     -  281s
     0     0 -1786.8246    0  669 -11709.395 -1786.8246  84.7%     -  283s
     0     0 -1790.8670    0  669 -11709.395 -1790.8670  84.7%     -  286s
     0     0 -1792.5496    0  669 -11709.395 -1792.5496  84.7%     -  286s
     0     0 -1792.8876    0  669 -11709.395 -1792.8876  84.7%     -  287s
     0     0 -1837.4790    0  659 -11709.395 -1837.4790  84.3%     -  296s
     0     0 -1852.3628    0  662 -11709.395 -1852.3628  84.2%     -  304s
     0     0 -1854.0194    0  670 -11709.395 -1854.0194  84.2%     -  306s
     0     0 -1856.6984    0  671 -11709.395 -1856.6984  84.1%     -  307s
     0     0 -1857.4546    0  673 -11709.395 -1857.4546  84.1%     -  308s
     0     0 -1900.5901    0  665 -11709.395 -1900.5901  83.8%     -  314s
     0     0 -1911.3089    0  676 -11709.395 -1911.3089  83.7%     -  317s
     0     0 -1913.0208    0  682 -11709.395 -1913.0208  83.7%     -  319s
     0     0 -1913.6361    0  681 -11709.395 -1913.6361  83.7%     -  320s
     0     0 -1942.0188    0  663 -11709.395 -1942.0188  83.4%     -  326s
     0     0 -1951.8551    0  662 -11709.395 -1951.8551  83.3%     -  331s
     0     0 -1961.4175    0  673 -11709.395 -1961.4175  83.2%     -  334s
     0     0 -1964.3562    0  676 -11709.395 -1964.3562  83.2%     -  336s
     0     0 -1964.8694    0  680 -11709.395 -1964.8694  83.2%     -  337s
     0     0 -1979.2128    0  668 -11709.395 -1979.2128  83.1%     -  341s
     0     0 -1981.5968    0  675 -11709.395 -1981.5968  83.1%     -  343s
     0     0 -1982.2076    0  678 -11709.395 -1982.2076  83.1%     -  344s
     0     0 -1989.2818    0  669 -11709.395 -1989.2818  83.0%     -  348s
     0     0 -1991.5679    0  682 -11709.395 -1991.5679  83.0%     -  350s
     0     0 -1993.5814    0  692 -11709.395 -1993.5814  83.0%     -  351s
     0     0 -1994.1697    0  693 -11709.395 -1994.1697  83.0%     -  352s
     0     0 -1998.5414    0  684 -11709.395 -1998.5414  82.9%     -  354s
     0     0 -1999.3331    0  691 -11709.395 -1999.3331  82.9%     -  355s
     0     0 -2012.5815    0  682 -11709.395 -2012.5815  82.8%     -  360s
     0     0 -2012.8150    0  682 -11709.395 -2012.8150  82.8%     -  362s
     0     2 -2013.3870    0  682 -11709.395 -2013.3870  82.8%     -  443s
     1     4 -2149.7872    1  647 -11709.395 -2013.3870  82.8%  5045  453s
     3     8 -2187.7435    2  711 -11709.395 -2150.1279  81.6%  5781  465s
     7    16 -2401.8873    3  724 -11709.395 -2188.3613  81.3%  7362  480s
    15    32 -2514.2163    4  663 -11709.395 -2401.9546  79.5%  8134  493s
    31    48 -3820.7342    5  567 -11709.395 -2514.3409  78.5% 10925  526s
    47    80 -4308.9313    6  566 -11709.395 -2514.3409  78.5% 12493  536s
    79   205 -4359.3483    7  609 -11709.395 -2514.3409  78.5%  9306  549s
   204   235 -4560.5258   10  519 -11709.395 -2514.3409  78.5%  4509  557s
   234   265 -4657.7605   10  581 -11709.395 -2514.3409  78.5%  4122  565s
   264   297 -4447.4042    8  551 -11709.395 -2514.3409  78.5%  3889  573s
   304   331 -4720.7493    9  585 -11709.395 -2514.3409  78.5%  3594  583s
   350   371 -4701.9274   11  591 -11709.395 -2514.3409  78.5%  3349  592s
   418   398 -5239.8885   15  573 -11709.395 -2514.3409  78.5%  2966  600s
   485   417 -4960.3854   10  594 -11709.395 -2514.3409  78.5%  2713  610s
   543   443 -6784.9084   10  540 -11709.395 -2514.3409  78.5%  2619  620s
   593   483 -6586.1032   12  370 -11709.395 -2514.3409  78.5%  2594  628s
   669   507 -6826.4534   13  382 -11709.395 -2514.3409  78.5%  2460  637s
   727   533 -6958.9719   14  394 -11709.395 -2514.3409  78.5%  2388  646s
   785   567 -7130.5884   15  509 -11709.395 -2514.3409  78.5%  2328  654s
   847   600 -8116.4540   15  172 -11709.395 -2514.3409  78.5%  2256  662s
   920   661 -7226.1988   16  508 -11709.395 -2514.3409  78.5%  2182  671s
  1017   724 -8240.0686   16  172 -11709.395 -2514.3409  78.5%  2069  680s
  1129   763 -7281.6895   17  517 -11709.395 -2514.3409  78.5%  1949  689s
  1249   766     cutoff   17      -11709.395 -2514.3409  78.5%  1857  699s
  1347   815 -7340.0203   18  520 -11709.395 -2514.3409  78.5%  1816  709s
  1423   885 -7361.9461   19  488 -11709.395 -2514.3409  78.5%  1830  719s
  1507   928 -7425.6588   20  419 -11709.395 -2514.3409  78.5%  1826  731s
  1590   972 -7480.5571   21  367 -11709.395 -2514.3409  78.5%  1850  742s
  1679  1015 -8348.5694   22  444 -11709.395 -2514.3409  78.5%  1846  754s
  1773  1052     cutoff   21      -11709.395 -2514.3409  78.5%  1849  765s
  1874  1091 -8605.0016   24  383 -11709.395 -2514.3409  78.5%  1863  777s
  1967  1128 infeasible   23      -11709.395 -2514.3409  78.5%  1868  789s
  2038  1180 -8908.3381   26  166 -11709.395 -2514.3409  78.5%  1886  802s
H 2084  1180                    -11151.61083 -2514.3409  77.5%  1894  802s
  2125  1202 -9358.0134   27  291 -11151.611 -2514.3409  77.5%  1915  816s
  2235  1258     cutoff   28      -11151.611 -2514.3409  77.5%  1916  830s
  2355  1292 -10893.085   34  348 -11151.611 -2514.3409  77.5%  1904  848s
  2493  1312 -11021.299   36  330 -11151.611 -2514.3409  77.5%  1897  864s
  2578  1358 -6188.9648   13  439 -11151.611 -2514.3409  77.5%  1925  882s
  2662  1398 -7916.7207   15  451 -11151.611 -2514.3409  77.5%  1969  897s
  2779  1435 -8440.7527   16  402 -11151.611 -2514.3409  77.5%  1997  914s
  2905  1479 -9630.5079   22  342 -11151.611 -2514.3409  77.5%  2012  932s
  3052  1515     cutoff   10      -11151.611 -2514.3409  77.5%  2001  950s
  3166  1568 -7130.3421   12  547 -11151.611 -2514.3409  77.5%  2028  968s
  3307  1631 -7237.5510   14  539 -11151.611 -2514.3409  77.5%  2049  986s
H 3461  1640                    -11136.51584 -2795.6844  74.9%  2067 1004s
H 3467  1640                    -11135.07406 -2795.6844  74.9%  2065 1004s
  3512  1716 -8432.0996   23  300 -11135.074 -2795.6844  74.9%  2074 1024s
  3700  1777 -10053.684   26  385 -11135.074 -2795.6844  74.9%  2078 1044s
  3905  1775 infeasible    8      -11135.074 -2795.6844  74.9%  2075 1066s
  4066  1794     cutoff   31      -11135.074 -3386.9378  69.6%  2090 1085s
  4197  1835 -5648.9812    8  593 -11135.074 -3670.5479  67.0%  2095 1108s
  4336  1877 -6880.2809   10  442 -11135.074 -4969.1285  55.4%  2118 1132s
  4507  1924 -7930.2500   12  347 -11135.074 -5182.1694  53.5%  2148 1156s
  4692  1962     cutoff   15      -11135.074 -5182.1694  53.5%  2166 1179s
  4880  2045 -9482.0669   10  154 -11135.074 -5217.9018  53.1%  2193 1205s
  5067  2072 -9276.3227   12  318 -11135.074 -5217.9018  53.1%  2199 1234s
  5313  2092     cutoff   16      -11135.074 -5467.5467  50.9%  2213 1255s
  5390  2135 -6129.7669   11  536 -11135.074 -5548.0512  50.2%  2219 1280s
  5537  2201 -8874.8630   12  463 -11135.074 -5548.0512  50.2%  2229 1309s
  5731  2291 -7484.9407   11  521 -11135.074 -5647.1813  49.3%  2253 1338s
  6060  2353 -8702.0258   16  279 -11135.074 -5653.9593  49.2%  2244 1369s
  6386  2454 -9441.6175   21  453 -11135.074 -5862.5257  47.4%  2245 1401s
  6725  2455 -9967.3125   29  682 -11135.074 -6002.5320  46.1%  2247 1492s
  6727  2456 -6500.3278   14  450 -11135.074 -6002.5320  46.1%  2246 1524s
  6728  2457 -8907.0594   20  711 -11135.074 -6002.5320  46.1%  2246 1571s
  6729  2458 -9314.5508   18  750 -11135.074 -6002.5320  46.1%  2245 1605s
  6730  2458 -6947.5884   22  692 -11135.074 -6002.5320  46.1%  2245 1629s
  6731  2459 -9482.1213   21  751 -11135.074 -6002.5320  46.1%  2245 1647s
  6732  2460 -8530.1439   13  661 -11135.074 -6002.5320  46.1%  2244 1661s
  6733  2460 -7628.5149   19  645 -11135.074 -6002.5320  46.1%  2244 1671s
  6734  2461 -6862.0875   27  715 -11135.074 -6002.5320  46.1%  2244 1678s
  6735  2462 -10085.247   38  667 -11135.074 -6002.5320  46.1%  2243 1685s
  6736  2462 -7636.5242   28  657 -11135.074 -6002.5320  46.1%  2243 1702s
  6737  2463 -9666.2874   16  666 -11135.074 -6002.5320  46.1%  2243 1710s
  6738  2464 -6157.3077   11  722 -11135.074 -6002.5320  46.1%  2242 1720s
  6739  2464 -7412.1067   13  788 -11135.074 -6002.5320  46.1%  2242 1726s
  6740  2465 -9144.4513   19  740 -11135.074 -6002.5320  46.1%  2242 1732s
  6741  2466 -8492.4225   21  758 -11135.074 -6002.5320  46.1%  2241 1749s
  6742  2466 -10093.908   29  681 -11135.074 -6002.5320  46.1%  2241 1756s
  6743  2467 -8051.6217   13  665 -11135.074 -6002.5320  46.1%  2241 1762s
  6744  2468 -9573.8873   23  678 -11135.074 -6002.5320  46.1%  2240 1775s
  6745  2468 -10594.249   30  666 -11135.074 -6002.5320  46.1%  2240 1780s
  6746  2469 -8412.1164    9  684 -11135.074 -6002.5320  46.1%  2240 1786s
  6747  2470 -7210.1390   15  764 -11135.074 -6002.5320  46.1%  2239 1802s
  6748  2470 -8661.8803   15  686 -11135.074 -6002.5320  46.1%  2239 1808s
  6749  2471 -8324.7872   14  755 -11135.074 -6002.5320  46.1%  2239 1818s
  6750  2472 -9129.0007   18  768 -11135.074 -6002.5320  46.1%  2238 1825s
  6751  2472 -9231.8228   19  714 -11135.074 -6002.5320  46.1%  2238 1833s
  6752  2473 -7329.9732   11  699 -11135.074 -6002.5320  46.1%  2238 1838s
  6753  2474 -8159.5353   14  695 -11135.074 -6002.5320  46.1%  2237 1848s
  6754  2474 -6649.2423   15  695 -11135.074 -6002.5320  46.1%  2237 1878s
  6755  2475 -8709.8915   12  695 -11135.074 -6002.5320  46.1%  2237 1924s
  6756  2478 -6002.5320   12  619 -11135.074 -6002.5320  46.1%  2284 1942s
  6757  2480 -6002.5320   13  565 -11135.074 -6002.5320  46.1%  2285 1962s
  6760  2485 -6002.5320   14  554 -11135.074 -6002.5320  46.1%  2286 1989s
  6766  2495 -6002.5320   15  536 -11135.074 -6002.5320  46.1%  2293 2007s
  6778  2505 -6002.5320   16  544 -11135.074 -6002.5320  46.1%  2323 2053s
  6792  2526 -6973.8970   17  579 -11135.074 -6002.5320  46.1%  2337 2109s
  6824  2589 -7101.4028   18  503 -11135.074 -6002.5320  46.1%  2388 2137s
  6907  2635 -7124.3815   19  505 -11135.074 -6002.5320  46.1%  2440 2157s
  6986  2682 -7305.1586   20  443 -11135.074 -6002.5320  46.1%  2458 2174s
  7075  2699 -7359.9152   21  421 -11135.074 -6002.5320  46.1%  2484 2197s
  7153  2691 -8440.3394   22  395 -11135.074 -6002.5320  46.1%  2511 2212s
  7219  2689 -8611.8560   23  323 -11135.074 -6002.5320  46.1%  2531 2228s
  7250  2689 -11015.516   23   50 -11135.074 -6002.5320  46.1%  2550 2244s
  7303  2683 -9365.2959   24  326 -11135.074 -6002.5320  46.1%  2572 2258s
  7342  2689     cutoff   24      -11135.074 -6002.5320  46.1%  2589 2275s
  7390  2679 infeasible   26      -11135.074 -6002.5320  46.1%  2600 2290s
  7451  2673 -10339.666   27  496 -11135.074 -6002.5320  46.1%  2628 2304s
  7500  2670     cutoff   27      -11135.074 -6002.5320  46.1%  2633 2318s
  7550  2674 -10426.863   29  475 -11135.074 -6002.5320  46.1%  2662 2332s
  7593  2692 -10633.498   30  395 -11135.074 -6002.5320  46.1%  2674 2344s
  7645  2704     cutoff   30      -11135.074 -6002.5320  46.1%  2696 2360s
  7714  2692 infeasible   31      -11135.074 -6002.5320  46.1%  2709 2376s
  7796  2688 -10706.496   33  291 -11135.074 -6002.5320  46.1%  2720 2404s
  7893  2683     cutoff   22      -11135.074 -6002.5320  46.1%  2728 2425s
  7967  2674 -8015.7308   20  698 -11135.074 -6002.5320  46.1%  2759 2446s
  8056  2671 -8668.9787   22  690 -11135.074 -6002.5320  46.1%  2782 2466s
  8127  2676     cutoff   23      -11135.074 -6002.5320  46.1%  2818 2484s
  8207  2704 -9749.0877   22  471 -11135.074 -6002.5320  46.1%  2852 2504s
  8303  2686     cutoff   23      -11135.074 -6002.5320  46.1%  2870 2524s
  8420  2691     cutoff   26      -11135.074 -6002.5320  46.1%  2885 2545s
  8532  2703 -10519.174   28  364 -11135.074 -6002.5320  46.1%  2912 2567s
  8660  2694     cutoff   36      -11135.074 -6002.5320  46.1%  2921 2589s
  8800  2680 -10477.072   24  678 -11135.074 -6002.5320  46.1%  2936 2612s
  8922  2678     cutoff   25      -11135.074 -6002.5320  46.1%  2949 2637s
  9056  2709 -8905.7102   32  607 -11135.074 -6002.5320  46.1%  2977 2669s
  9200  2685 -10699.464   33  547 -11135.074 -6002.5320  46.1%  3002 2694s
  9308  2714 -10803.088   34  517 -11135.074 -6002.5320  46.1%  3020 2720s
  9441  2751 -10927.366   36  434 -11135.074 -6027.3628  45.9%  3036 2746s
  9626  2784 -8909.8723   21  479 -11135.074 -6027.3628  45.9%  3052 2776s
  9809  2774 -9661.2717   30  129 -11135.074 -6027.3628  45.9%  3063 2804s
 10005  2759 -8022.2097   22  566 -11135.074 -6208.5662  44.2%  3090 2833s
 10199  2754 -8726.6394   24  411 -11135.074 -6208.5662  44.2%  3121 2865s
 10400  2759 -10148.602   26  402 -11135.074 -6225.2442  44.1%  3140 2901s
 10621  2733 -9715.5755   29  379 -11135.074 -6467.1537  41.9%  3159 2934s
 10837  2698     cutoff   22      -11135.074 -6610.0490  40.6%  3191 2967s
 11068  2691     cutoff   28      -11135.074 -6613.4931  40.6%  3219 3000s
 11327  2652 -10271.439   22  520 -11135.074 -6936.4352  37.7%  3243 3036s
 11575  2633     cutoff   25      -11135.074 -6936.4352  37.7%  3263 3069s
 11794  2626 -10941.338   29  361 -11135.074 -6936.4352  37.7%  3284 3108s
 12122  2589     cutoff   34      -11135.074 -7120.5990  36.1%  3292 3146s
 12375  2537 -9709.6355   23  465 -11135.074 -7224.4302  35.1%  3327 3182s
 12528  2507 -10588.031   29  214 -11135.074 -7295.5507  34.5%  3332 3225s
 12873  2404 -10654.015   27  242 -11135.074 -7295.5507  34.5%  3355 3267s
 13154  2304 -9788.3950   23  525 -11135.074 -7690.0803  30.9%  3364 3313s
 13524  2198     cutoff   26      -11135.074 -7825.1331  29.7%  3388 3360s
 13920  2061 -10396.124   31  426 -11135.074 -7976.1919  28.4%  3414 3407s
 14405  1879 -10057.362   28  346 -11135.074 -8159.6322  26.7%  3422 3452s
 14796  1780     cutoff   28      -11135.074 -8319.7687  25.3%  3435 3502s
 15272  1607     cutoff   24      -11135.074 -8529.0703  23.4%  3447 3555s
 15952  1407     cutoff   32      -11135.074 -8692.0148  21.9%  3422 3600s

Cutting planes:
  Learned: 2
  MIR: 1122
  Mixing: 1
  Flow cover: 2891
  Zero half: 9
  RLT: 39
  Relax-and-lift: 181

Explored 16622 nodes (56742339 simplex iterations) in 3600.05 seconds (10238.84 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -11135.1 -11136.5 -11151.6 ... -13719.4

Time limit reached
Best objective -1.113507405722e+04, best bound -8.972447635109e+03, gap 19.4218%
  WARNING: Time limit reached. Using best solution found (gap: 19.42%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.05s
  Master Objective (UB) = -11135.07, θ = 119054.93
  Upper Bound (UB) = -11135.07

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 119054.93
  [DEBUG]   ✓ Scenario 0: θ = 119054.93 ≤ Q = 119054.93 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 119054.93 ≤ Q = 119054.93 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 119054.93 ≤ Q = 119054.93 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 119054.93 ≤ Q = 119054.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 119054.93 ≤ Q = 119054.93 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 119054.93 ≤ Q = 119054.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 119054.93 ≤ Q = 119054.93 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 119054.93 ≤ Q = 119054.93 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x3c7f8b5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xfc38074b
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [3e-01, 2e+02]
Found heuristic solution: objective 1.248874e+13
Presolve removed 2577 rows and 1870 columns
Presolve time: 0.00s
Presolved: 516 rows, 519 columns, 1455 nonzeros
Found heuristic solution: objective 6761446.0956
Variable types: 351 continuous, 168 integer (168 binary)

Root relaxation: objective -1.177822e+05, 259 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -117782.19    0  136 6761446.10 -117782.19   102%     -    0s
H    0     0                    -83798.20816 -117782.19  40.6%     -    0s
H    0     0                    -85653.24495 -117782.19  37.5%     -    0s
H    0     0                    -92431.83528 -98900.747  7.00%     -    0s
H    0     0                    -96039.92997 -98900.747  2.98%     -    0s
     0     0 -98900.747    0   43 -96039.930 -98900.747  2.98%     -    0s
H    0     0                    -98325.68366 -98899.560  0.58%     -    0s
     0     0 -98828.904    0   35 -98325.684 -98828.904  0.51%     -    0s
     0     0 -98821.569    0   34 -98325.684 -98821.569  0.50%     -    0s
     0     0 -98814.630    0   41 -98325.684 -98814.630  0.50%     -    0s
     0     0 -98655.649    0   16 -98325.684 -98655.649  0.34%     -    0s
H    0     0                    -98582.23078 -98652.367  0.07%     -    0s
     0     0 -98623.177    0    6 -98582.231 -98623.177  0.04%     -    0s
H    0     0                    -98582.56663 -98623.177  0.04%     -    0s
     0     0 -98604.244    0    4 -98582.567 -98604.244  0.02%     -    0s
H    0     0                    -98583.23228 -98604.244  0.02%     -    0s
     0     0 -98594.474    0    3 -98583.232 -98594.474  0.01%     -    0s

Cutting planes:
  Gomory: 1
  Implied bound: 2
  MIR: 1
  Flow cover: 1

Explored 1 nodes (521 simplex iterations) in 0.04 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -98583.2 -98582.6 -98582.2 ... 1.24887e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -9.858323228495e+04, best bound -9.859218219651e+04, gap 0.0091%
  Subproblem solved in 0.06s
  Worst-case operational profit (Z_SP) = 104405.97
  Scenario: 13 demand increases, 47 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -98583.23
  [DEBUG]   S×d_nominal = 202989.21
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 202989.21 + -98583.23 = 104405.97
  [DEBUG]   Current θ from Master = 119054.93
  [DEBUG]   ⚠️  Z_SP ≤ θ by 14648.95 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -25784.03
  Lower Bound (LB) = -13018.71
  Gap (UB-LB) = 1883.6398, Absolute Gap = 1883.6398, Relative Gap = 0.169163
  Not converged yet (gap = 1883.64 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 13 increases, 47 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394706 nonzeros
Model fingerprint: 0xa6bfc431
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 60074 rows and 24394 columns
Presolve time: 1.09s
Presolved: 78919 rows, 34026 columns, 484007 nonzeros
Variable types: 31767 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -383874.0427
Found heuristic solution: objective -190756.9345

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 78919 rows, 34026 columns, 484007 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   36031   -6.8191695e+04   0.000000e+00   9.816229e+06      5s
   48443   -6.4716925e+03   0.000000e+00   9.726105e+06     10s
   55762   -4.0383762e+03   0.000000e+00   2.151945e+06     15s
   62543   -8.9514193e+01   0.000000e+00   1.045229e+06     20s
   68143    1.8944484e+03   0.000000e+00   5.951073e+06     25s
   74249    2.9912963e+03   0.000000e+00   1.739060e+06     30s
   79369    3.3818482e+03   0.000000e+00   4.396443e+06     35s
   84739    4.6564575e+03   0.000000e+00   1.792976e+09     40s
   90223    6.1628669e+03   0.000000e+00   9.849560e+05     45s
Concurrent spin time: 3.53s

Solved with dual simplex

Root relaxation: objective 1.111190e+04, 76630 iterations, 48.10 seconds (104.08 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 11111.9011    0  469 -190756.93 11111.9011   106%     -   49s
H    0     0                    -177417.5634 11111.9011   106%     -   49s
H    0     0                    -120894.2263 11111.9011   109%     -   50s
H    0     0                    -120843.4537 11111.9011   109%     -   50s
H    0     0                    -108197.4950 11111.9011   110%     -   50s
H    0     0                    -107806.0245 11111.9011   110%     -   50s
H    0     0                    -107780.8976 11111.9011   110%     -   50s
H    0     0                    -107159.8225 11111.9011   110%     -   50s
H    0     0                    -107151.7989 11111.9011   110%     -   50s
H    0     0                    -107137.5108 11111.9011   110%     -   50s
H    0     0                    -92287.93194 11111.9011   112%     -   50s
H    0     0                    -92157.38818 11111.9011   112%     -   50s
H    0     0                    -61051.38290 11111.9011   118%     -   50s
H    0     0                    -54367.24416 11111.9011   120%     -   50s
H    0     0                    -53562.63798 11111.9011   121%     -   50s
H    0     0                    -48910.52731 5276.07181   111%     -   71s
H    0     0                    -46894.10944 5276.07181   111%     -   71s
H    0     0                    -46738.67825 5276.07181   111%     -   71s
H    0     0                    -45125.18350 5276.07181   112%     -   71s
H    0     0                    -45041.35551 5276.07181   112%     -   71s
H    0     0                    -45033.53789 5276.07181   112%     -   71s
H    0     0                    -45028.59755 5276.07181   112%     -   71s
     0     0 4915.03907    0  549 -45028.598 4915.03907   111%     -   71s
H    0     0                    -45024.67586 4915.03907   111%     -   71s
     0     0 4789.31493    0  550 -45024.676 4789.31493   111%     -   75s
     0     0 4751.30663    0  563 -45024.676 4751.30663   111%     -   76s
     0     0 4751.30663    0  563 -45024.676 4751.30663   111%     -   78s
     0     0 4751.30663    0  555 -45024.676 4751.30663   111%     -   79s
     0     0 4751.30663    0  553 -45024.676 4751.30663   111%     -   80s
     0     0 4751.30663    0  574 -45024.676 4751.30663   111%     -   81s
     0     0 4751.30663    0  578 -45024.676 4751.30663   111%     -   82s
     0     0 4751.30663    0  580 -45024.676 4751.30663   111%     -   83s
H    0     0                    -41019.84780 2913.43751   107%     -   98s
     0     0 2913.43751    0  593 -41019.848 2913.43751   107%     -   98s
H    0     0                    -36631.58039 2913.27209   108%     -   99s
H    0     0                    -36401.79550 2913.27209   108%     -   99s
H    0     0                    -36305.61623 2913.27209   108%     -   99s
H    0     0                    -36232.39151 2913.27209   108%     -   99s
H    0     0                    -36160.32396 2913.27209   108%     -   99s
H    0     0                    -36140.05950 2913.27209   108%     -   99s
H    0     0                    -36105.79094 2913.27209   108%     -   99s
H    0     0                    -36061.36632 2913.27209   108%     -   99s
H    0     0                    -36055.10116 2913.27209   108%     -   99s
H    0     0                    -36019.14515 2913.27209   108%     -   99s
H    0     0                    -36005.14584 2913.27209   108%     -   99s
H    0     0                    -35998.88069 2913.27209   108%     -   99s
     0     0 2619.87607    0  629 -35998.881 2619.87607   107%     -  109s
     0     0 2588.35998    0  638 -35998.881 2588.35998   107%     -  113s
     0     0 2551.21273    0  634 -35998.881 2551.21273   107%     -  116s
     0     0 2524.48176    0  641 -35998.881 2524.48176   107%     -  119s
     0     0 2434.75637    0  685 -35998.881 2434.75637   107%     -  125s
     0     0 2408.25968    0  682 -35998.881 2408.25968   107%     -  128s
     0     0 2375.88850    0  692 -35998.881 2375.88850   107%     -  130s
     0     0 2374.62055    0  689 -35998.881 2374.62055   107%     -  130s
     0     0 2366.52488    0  689 -35998.881 2366.52488   107%     -  131s
     0     0 2365.99568    0  690 -35998.881 2365.99568   107%     -  132s
H    0     0                    -17339.46842 2365.99568   114%     -  142s
H    0     0                    -17157.67230 2365.99568   114%     -  142s
H    0     0                    -17072.02587 2365.99568   114%     -  142s
     0     0  693.59632    0  638 -17072.026  693.59632   104%     -  183s
H    0     0                    -15259.39173  693.37530   105%     -  183s
H    0     0                    -15212.18811  693.37530   105%     -  183s
H    0     0                    -15177.89718  693.37530   105%     -  183s
     0     0  406.04606    0  655 -15177.897  406.04606   103%     -  195s
     0     0  331.90548    0  688 -15177.897  331.90548   102%     -  202s
     0     0  247.16061    0  682 -15177.897  247.16061   102%     -  207s
     0     0  228.49026    0  681 -15177.897  228.49026   102%     -  212s
     0     0  222.40391    0  685 -15177.897  222.40391   101%     -  214s
     0     0  218.54380    0  690 -15177.897  218.54380   101%     -  216s
     0     0  215.96754    0  691 -15177.897  215.96754   101%     -  217s
     0     0  136.55923    0  691 -15177.897  136.55923   101%     -  224s
H    0     0                    -14467.86752  102.44400   101%     -  228s
H    0     0                    -14141.30548  102.44400   101%     -  228s
H    0     0                    -14063.62499  102.44400   101%     -  228s
H    0     0                    -13896.21524  102.44400   101%     -  228s
H    0     0                    -13884.22653  102.44400   101%     -  228s
H    0     0                    -13880.87980  102.44400   101%     -  228s
     0     0  102.44400    0  694 -13880.880  102.44400   101%     -  228s
     0     0   96.50730    0  697 -13880.880   96.50730   101%     -  230s
     0     0   94.83702    0  705 -13880.880   94.83702   101%     -  231s
H    0     0                    -13831.88436   94.83702   101%     -  241s
H    0     0                    -13760.94386   94.83702   101%     -  241s
H    0     0                    -13752.71598   94.83702   101%     -  241s
H    0     0                    -13742.48177   94.83702   101%     -  241s
H    0     0                    -13736.37530   94.83702   101%     -  241s
     0     0 -605.39179    0  647 -13736.375 -605.39179  95.6%     -  262s
     0     0 -778.00461    0  659 -13736.375 -778.00461  94.3%     -  275s
     0     0 -804.83808    0  670 -13736.375 -804.83808  94.1%     -  281s
     0     0 -814.08721    0  672 -13736.375 -814.08721  94.1%     -  285s
     0     0 -826.80088    0  667 -13736.375 -826.80088  94.0%     -  290s
     0     0 -834.34769    0  655 -13736.375 -834.34769  93.9%     -  293s
     0     0 -835.09204    0  651 -13736.375 -835.09204  93.9%     -  294s
H    0     0                    -13244.41871 -999.34876  92.5%     -  311s
H    0     0                    -13236.75500 -999.34876  92.5%     -  311s
H    0     0                    -12991.55722 -999.34876  92.3%     -  311s
H    0     0                    -12979.40764 -999.34876  92.3%     -  311s
H    0     0                    -12927.81512 -999.34876  92.3%     -  311s
     0     0 -999.34876    0  664 -12927.815 -999.34876  92.3%     -  311s
H    0     0                    -12923.89342 -1035.2697  92.0%     -  319s
H    0     0                    -12903.21935 -1035.2697  92.0%     -  319s
     0     0 -1035.2697    0  667 -12903.219 -1035.2697  92.0%     -  319s
     0     0 -1048.0029    0  672 -12903.219 -1048.0029  91.9%     -  325s
     0     0 -1051.0836    0  680 -12903.219 -1051.0836  91.9%     -  331s
     0     0 -1052.0214    0  673 -12903.219 -1052.0214  91.8%     -  332s
     0     0 -1183.0078    0  705 -12903.219 -1183.0078  90.8%     -  347s
H    0     0                    -12407.76206 -1183.0582  90.5%     -  350s
H    0     0                    -12221.39121 -1183.0582  90.3%     -  352s
     0     0 -1218.8839    0  681 -12221.391 -1218.8839  90.0%     -  360s
     0     0 -1227.5280    0  675 -12221.391 -1227.5280  90.0%     -  365s
     0     0 -1230.1251    0  672 -12221.391 -1230.1251  89.9%     -  367s
     0     0 -1234.4610    0  677 -12221.391 -1234.4610  89.9%     -  369s
     0     0 -1235.6428    0  681 -12221.391 -1235.6428  89.9%     -  370s
     0     0 -1302.3648    0  685 -12221.391 -1302.3648  89.3%     -  386s
H    0     0                    -12218.83061 -1302.4738  89.3%     -  387s
     0     0 -1320.3885    0  691 -12218.831 -1320.3885  89.2%     -  392s
     0     0 -1326.0232    0  695 -12218.831 -1326.0232  89.1%     -  395s
     0     0 -1328.8460    0  698 -12218.831 -1328.8460  89.1%     -  398s
     0     0 -1329.6821    0  689 -12218.831 -1329.6821  89.1%     -  400s
     0     0 -1368.4944    0  688 -12218.831 -1368.4944  88.8%     -  410s
H    0     0                    -12088.93588 -1368.5198  88.7%     -  412s
H    0     0                    -12040.67567 -1368.5198  88.6%     -  412s
H    0     0                    -12033.01196 -1368.5198  88.6%     -  412s
H    0     0                    -11989.32855 -1368.5198  88.6%     -  412s
H    0     0                    -11970.09651 -1368.5198  88.6%     -  412s
H    0     0                    -11917.16659 -1368.5198  88.5%     -  412s
     0     0 -1377.6657    0  684 -11917.167 -1377.6657  88.4%     -  415s
     0     0 -1381.7149    0  697 -11917.167 -1381.7149  88.4%     -  417s
     0     0 -1384.0800    0  701 -11917.167 -1384.0800  88.4%     -  419s
     0     0 -1385.0135    0  701 -11917.167 -1385.0135  88.4%     -  420s
     0     0 -1401.6551    0  690 -11917.167 -1401.6551  88.2%     -  429s
H    0     0                    -11906.58447 -1401.8027  88.2%     -  429s
     0     0 -1406.8459    0  700 -11906.584 -1406.8459  88.2%     -  432s
     0     0 -1408.0352    0  700 -11906.584 -1408.0352  88.2%     -  435s
     0     0 -1424.5083    0  699 -11906.584 -1424.5083  88.0%     -  441s
     0     0 -1427.4675    0  702 -11906.584 -1427.4675  88.0%     -  451s
     0     0 -1428.7832    0  704 -11906.584 -1428.7832  88.0%     -  452s
     0     0 -1433.2324    0  697 -11906.584 -1433.2324  88.0%     -  455s
     0     0 -1433.2679    0  697 -11906.584 -1433.2679  88.0%     -  459s
     0     2 -1433.2679    0  697 -11906.584 -1433.2679  88.0%     -  532s
     1     3 -2356.8086    1  608 -11906.584 -1433.2679  88.0% 13120  550s
     2     4 -1611.1415    1  682 -11906.584 -1611.1415  86.5% 10682  560s
     3     6 -1770.1302    2  671 -11906.584 -1611.6728  86.5%  9503  572s
     5    12 -2349.6839    3  650 -11906.584 -1611.6728  86.5%  8819  586s
    11    24 -2471.6334    4  628 -11906.584 -1835.0183  84.6%  8468  618s
    23    36 -2581.7301    5  623 -11906.584 -1880.6520  84.2% 13298  915s
H   35    68                    -11905.42495 -1880.6520  84.2% 12640  977s
H   40    68                    -11886.76431 -1880.6520  84.2% 12561  977s
H   41    68                    -11884.00214 -1880.6520  84.2% 12302  977s
    67   175 -2880.4639    7  625 -11884.002 -2007.9524  83.1% 14235 1012s
   174   258 -3128.9946   11  598 -11884.002 -2007.9524  83.1%  7902 1029s
   259   342 -3931.6005   13  632 -11884.002 -2007.9524  83.1%  6473 1043s
   360   409 -3978.2419   14  626 -11884.002 -2007.9524  83.1%  5363 1058s
   451   461 -4483.4878   16  568 -11884.002 -2007.9524  83.1%  4753 1071s
   538   486     cutoff   27      -11884.002 -2007.9524  83.1%  4334 1082s
   603   521 -4449.3574   16  563 -11884.002 -2007.9524  83.1%  4266 1094s
   662   539 -5500.7864   17  535 -11884.002 -2007.9524  83.1%  4231 1105s
   692   590 -5523.0439   18  477 -11884.002 -2007.9524  83.1%  4194 1114s
   754   619 -5839.3008   20  382 -11884.002 -2007.9524  83.1%  4023 1124s
H  760   619                    -11555.13317 -2007.9524  82.6%  3998 1124s
   797   712 -6476.9428   21  503 -11555.133 -2007.9524  82.6%  3921 1135s
   909   825 -6650.0705   22  494 -11555.133 -2007.9524  82.6%  3642 1145s
  1046   938 -6787.6044   23  547 -11555.133 -2007.9524  82.6%  3345 1155s
H 1091   938                    -11469.08484 -2007.9524  82.5%  3234 1155s
  1206   994 -7033.6980   24  497 -11469.085 -2007.9524  82.5%  3050 1165s
  1376  1050 -7110.6307   25  410 -11469.085 -2007.9524  82.5%  2813 1175s
  1528  1110 -7211.9263   27  500 -11469.085 -2090.1518  81.8%  2648 1187s
  1689  1170 -7696.5406   29  458 -11469.085 -2090.1518  81.8%  2481 1197s
  1883  1152 -8340.4036   30  450 -11469.085 -2090.1518  81.8%  2318 1210s
  1985  1161     cutoff   30      -11469.085 -2090.1518  81.8%  2274 1222s
  2018  1185 -6879.0165    8  567 -11469.085 -2090.1518  81.8%  2358 1235s
  2054  1199 -6665.2872   14  287 -11469.085 -2090.1518  81.8%  2415 1247s
H 2058  1199                    -11318.59005 -2090.1518  81.5%  2423 1247s
  2086  1249 -4127.3190   12  528 -11318.590 -2090.1518  81.5%  2451 1259s
  2196  1280 -4236.7330   13  461 -11318.590 -2090.1518  81.5%  2490 1272s
H 2208  1280                    -11299.45668 -2090.1518  81.5%  2513 1272s
H 2217  1280                    -11291.84714 -2090.1518  81.5%  2527 1272s
  2251  1330 -4261.4379   14  461 -11291.847 -2090.1518  81.5%  2521 1285s
  2408  1350 -7014.8457   16  174 -11291.847 -2090.1518  81.5%  2480 1299s
  2486  1386     cutoff   20      -11291.847 -2090.1518  81.5%  2564 1312s
  2583  1403     cutoff   22      -11291.847 -2090.1518  81.5%  2609 1327s
  2712  1451 -4061.5438    9  572 -11291.847 -2344.3847  79.2%  2632 1341s
  2810  1481 -4138.2554   10  526 -11291.847 -2344.3847  79.2%  2684 1356s
H 2865  1481                    -11272.71377 -2344.3847  79.2%  2691 1356s
  2896  1520 -10644.435   12  240 -11272.714 -2344.3847  79.2%  2704 1371s
  3012  1544 -5168.2422   10  458 -11272.714 -2344.3847  79.2%  2716 1387s
  3086  1596 -5256.7026   11  395 -11272.714 -2344.3847  79.2%  2800 1403s
  3190  1621 -6102.5735   12  380 -11272.714 -3117.8222  72.3%  2898 1419s
  3245  1646 -6119.3446   13  385 -11272.714 -3194.4705  71.7%  2942 1436s
  3344  1665 -7014.4249   14  272 -11272.714 -3194.4705  71.7%  2971 1453s
  3387  1682 -7432.6465   15  404 -11272.714 -3194.4705  71.7%  3039 1472s
  3444  1711 -7517.2060   16  380 -11272.714 -3194.4705  71.7%  3094 1488s
  3505  1740 -7655.9788   17  331 -11272.714 -3194.4705  71.7%  3131 1505s
  3570  1759 -7708.7666   18  232 -11272.714 -3194.4705  71.7%  3176 1523s
  3665  1775 -8538.9641   20  265 -11272.714 -3310.9648  70.6%  3218 1543s
  3769  1785 -10993.363   24  305 -11272.714 -3310.9648  70.6%  3257 1563s
  3845  1815     cutoff   24      -11272.714 -3578.3593  68.3%  3275 1584s
  3968  1875     cutoff   21      -11272.714 -3712.3608  67.1%  3275 1605s
  4105  1922 -7987.4291    8  245 -11272.714 -3712.3608  67.1%  3323 1628s
  4237  1983 -6182.7936    8  348 -11272.714 -3712.3608  67.1%  3387 1651s
  4416  2026 -6561.9507   10  388 -11272.714 -3776.0690  66.5%  3420 1675s
  4533  2100 -8877.0096   10   70 -11272.714 -3874.2948  65.6%  3465 1700s
  4719  2161 -7691.9845   12  378 -11272.714 -3876.3240  65.6%  3479 1725s
  4895  2203 -10159.717   14  316 -11272.714 -4022.8892  64.3%  3539 1752s
  5068  2293 -4733.7936   12  525 -11272.714 -4022.8892  64.3%  3620 1778s
  5293  2363 -6425.3720   16  367 -11272.714 -4044.4912  64.1%  3654 1806s
  5528  2404 -10223.694   32   32 -11272.714 -4077.0754  63.8%  3694 1834s
  5759  2436     cutoff   11      -11272.714 -4077.0754  63.8%  3709 1865s
  5989  2503     cutoff   24      -11272.714 -4155.4214  63.1%  3754 1896s
  6282  2566     cutoff   12      -11272.714 -4180.3147  62.9%  3763 1932s
  6550  2608 -4457.1847    9  412 -11272.714 -4354.8749  61.4%  3793 1965s
  6771  2663 -8587.8096   11   79 -11272.714 -4387.8428  61.1%  3864 1997s
  7019  2714 -6400.1831   13  396 -11272.714 -4441.7899  60.6%  3893 2032s
  7307  2808     cutoff   16      -11272.714 -4441.7899  60.6%  3951 2067s
  7615  2809 -9186.8131   11  697 -11272.714 -4529.9556  59.8%  3995 2200s
  7617  2810 -9768.8134   23  487 -11272.714 -4529.9556  59.8%  3994 2268s
  7618  2811 -7646.7569   19  690 -11272.714 -4529.9556  59.8%  3993 2312s
  7619  2812 -8812.8611   18  692 -11272.714 -4529.9556  59.8%  3993 2353s
  7620  2812 -7316.4504   14  786 -11272.714 -4529.9556  59.8%  3992 2380s
  7621  2813 -6214.8898   12  663 -11272.714 -4529.9556  59.8%  3992 2397s
  7622  2814 -7091.3921   14  672 -11272.714 -4529.9556  59.8%  3991 2410s
  7623  2814 -5300.7471   12  734 -11272.714 -4529.9556  59.8%  3991 2424s
  7624  2815 -10356.906   14  675 -11272.714 -4529.9556  59.8%  3990 2439s
  7625  2816 -11048.363   20  678 -11272.714 -4529.9556  59.8%  3990 2451s
  7626  2816 -9693.5056   16  674 -11272.714 -4529.9556  59.8%  3989 2457s
  7627  2817 -11070.748   28  673 -11272.714 -4529.9556  59.8%  3988 2463s
  7628  2818 -7976.8091   14  668 -11272.714 -4529.9556  59.8%  3988 2491s
  7629  2818 -10328.395   39  777 -11272.714 -4529.9556  59.8%  3987 2512s
  7630  2819 -10254.774   24  690 -11272.714 -4529.9556  59.8%  3987 2522s
  7631  2820 -8348.6348   16  697 -11272.714 -4529.9556  59.8%  3986 2532s
  7632  2820 -8211.4201   16  755 -11272.714 -4529.9556  59.8%  3986 2555s
  7633  2821 -5218.4685   10  755 -11272.714 -4529.9556  59.8%  3985 2566s
  7634  2822 -9452.1623   21  761 -11272.714 -4529.9556  59.8%  3985 2574s
  7635  2822 -11185.189   29  765 -11272.714 -4529.9556  59.8%  3984 2596s
  7636  2823 -10016.775   27  685 -11272.714 -4529.9556  59.8%  3984 2605s
  7637  2824 -9913.0151   25  696 -11272.714 -4529.9556  59.8%  3983 2615s
  7638  2824 -9602.1073   29  667 -11272.714 -4529.9556  59.8%  3983 2627s
  7639  2825 -8858.5910   16  671 -11272.714 -4529.9556  59.8%  3982 2636s
  7640  2826 -11184.261   25  669 -11272.714 -4529.9556  59.8%  3982 2642s
  7641  2826 -9419.7968   28  737 -11272.714 -4529.9556  59.8%  3981 2662s
  7642  2827 -10950.687   34  739 -11272.714 -4529.9556  59.8%  3981 2669s
  7643  2828 -5359.7394   14  697 -11272.714 -4529.9556  59.8%  3980 2675s
  7644  2828 -9998.3260   23  678 -11272.714 -4529.9556  59.8%  3980 2685s
  7645  2829 -10670.140   14  683 -11272.714 -4529.9556  59.8%  3979 2693s
  7646  2830 -9623.6551   15  689 -11272.714 -4529.9556  59.8%  3979 2699s
  7647  2830 -9900.3242   21  800 -11272.714 -4529.9556  59.8%  3978 2714s
  7648  2831 -8057.0264   20  800 -11272.714 -4529.9556  59.8%  3978 2782s
  7649  2832 -6401.3874   14  800 -11272.714 -4529.9556  59.8%  3977 2833s
  7650  2835 -4529.9556   13  783 -11272.714 -4529.9556  59.8%  4029 2874s
  7652  2839 -4529.9556   14  794 -11272.714 -4529.9556  59.8%  4030 2911s
  7656  2845 -4529.9556   15  796 -11272.714 -4529.9556  59.8%  4034 2929s
  7664  2859 -4529.9556   16  798 -11272.714 -4529.9556  59.8%  4039 2961s
  7680  2865 -10665.292   17  136 -11272.714 -4529.9556  59.8%  4054 2998s
  7699  2873 -5067.2651   18  484 -11272.714 -4529.9556  59.8%  4097 3020s
  7730  2886 -5270.9942   19  485 -11272.714 -4529.9556  59.8%  4094 3058s
  7802  2887 -6515.4514   20  498 -11272.714 -4529.9556  59.8%  4080 3079s
  7855  2895 -7431.7528   21  327 -11272.714 -4529.9556  59.8%  4090 3096s
  7889  2919 -8864.6057   22  492 -11272.714 -4529.9556  59.8%  4121 3115s
  7941  2954 -7620.4651   21  557 -11272.714 -4529.9556  59.8%  4122 3133s
  8015  2975 -7733.6716   22  560 -11272.714 -4529.9556  59.8%  4114 3153s
  8083  2977     cutoff   22      -11272.714 -4529.9556  59.8%  4104 3172s
  8179  2971 -9039.3605   23  490 -11272.714 -4529.9556  59.8%  4083 3188s
  8272  2952 -9350.4776   25  469 -11272.714 -4529.9556  59.8%  4059 3209s
  8350  2922 infeasible   27      -11272.714 -4529.9556  59.8%  4039 3224s
  8427  2909 -7952.1409   20  381 -11272.714 -4529.9556  59.8%  4025 3238s
  8481  2909 -8619.6478   21  310 -11272.714 -4529.9556  59.8%  4015 3253s
  8542  2896 -8841.0758   23  426 -11272.714 -4529.9556  59.8%  4005 3267s
  8581  2903 -8854.6737   24  418 -11272.714 -4529.9556  59.8%  3999 3281s
  8635  2907 -8885.0341   25  424 -11272.714 -4529.9556  59.8%  3989 3296s
  8693  2921 -10676.098   30  207 -11272.714 -4529.9556  59.8%  3979 3310s
  8751  2924 -9720.6093   26  505 -11272.714 -4529.9556  59.8%  3974 3326s
  8825  2935 -9885.7350   27  298 -11272.714 -4529.9556  59.8%  3964 3341s
  8907  2930 -10388.448   28  389 -11272.714 -4529.9556  59.8%  3952 3372s
  8996  2929 -10531.440   29  407 -11272.714 -4529.9556  59.8%  3938 3390s
  9087  2936     cutoff   34      -11272.714 -4529.9556  59.8%  3926 3414s
  9178  2934 -4940.8209   20  495 -11272.714 -4529.9556  59.8%  3916 3440s
  9244  2923 -5220.0289   21  494 -11272.714 -4529.9556  59.8%  3909 3462s
  9340  2912 -5549.2084   22  488 -11272.714 -4529.9556  59.8%  3897 3482s
  9424  2917 -5797.3271   23  527 -11272.714 -4529.9556  59.8%  3895 3506s
  9520  2932 -7712.9643   24  341 -11272.714 -4529.9556  59.8%  3886 3529s
  9632  2932 -9640.6836   26  412 -11272.714 -4529.9556  59.8%  3879 3560s
  9749  2931 -11101.373   26  360 -11272.714 -4529.9556  59.8%  3866 3589s
  9875  2896     cutoff   27      -11272.714 -4529.9556  59.8%  3855 3600s

Cutting planes:
  Learned: 1
  Gomory: 1
  Projected implied bound: 73
  MIR: 1853
  Flow cover: 2589
  Zero half: 7
  RLT: 46
  Relax-and-lift: 215

Explored 9934 nodes (38617467 simplex iterations) in 3600.03 seconds (9105.38 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -11272.7 -11291.8 -11299.5 ... -11906.6

Time limit reached
Best objective -1.127271377137e+04, best bound -4.529955593214e+03, gap 59.8149%
  WARNING: Time limit reached. Using best solution found (gap: 59.81%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.05s
  Master Objective (UB) = -11272.71, θ = 116839.98
  Upper Bound (UB) = -11272.71

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 116839.98
  [DEBUG]   ✓ Scenario 0: θ = 116839.98 ≤ Q = 116839.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 116839.98 ≤ Q = 116839.98 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 116839.98 ≤ Q = 116839.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 116839.98 ≤ Q = 116839.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 116839.98 ≤ Q = 116839.98 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 116839.98 ≤ Q = 116839.98 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 116839.98 ≤ Q = 116839.98 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 116839.98 ≤ Q = 116839.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 116839.98 ≤ Q = 116839.98 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x500e38d3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x500e38d3
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.329312e+13
Presolve removed 2577 rows and 1870 columns
Presolve time: 0.00s
Presolved: 516 rows, 519 columns, 1455 nonzeros
Found heuristic solution: objective 7034682.0885
Variable types: 351 continuous, 168 integer (168 binary)

Root relaxation: objective -1.199924e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -119992.42    0  122 7034682.09 -119992.42   102%     -    0s
H    0     0                    -85489.75535 -119992.42  40.4%     -    0s
H    0     0                    -86019.10934 -119992.42  39.5%     -    0s
     0     0 -98884.085    0   39 -86019.109 -98884.085  15.0%     -    0s
H    0     0                    -98021.94768 -98857.496  0.85%     -    0s
H    0     0                    -98265.17683 -98857.496  0.60%     -    0s
     0     0 -98627.602    0   21 -98265.177 -98627.602  0.37%     -    0s
     0     0 -98597.690    0   11 -98265.177 -98597.690  0.34%     -    0s
H    0     0                    -98296.26380 -98553.372  0.26%     -    0s
     0     0 -98483.192    0   15 -98296.264 -98483.192  0.19%     -    0s
     0     0 -98463.484    0   15 -98296.264 -98463.484  0.17%     -    0s
     0     0 -98410.553    0    8 -98296.264 -98410.553  0.12%     -    0s
     0     0 -98410.553    0   16 -98296.264 -98410.553  0.12%     -    0s
H    0     0                    -98301.26796 -98410.553  0.11%     -    0s
*    0     0               0    -98367.13235 -98367.132  0.00%     -    0s

Cutting planes:
  Gomory: 9
  MIR: 7
  Flow cover: 8

Explored 1 nodes (586 simplex iterations) in 0.04 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -98367.1 -98301.3 -98296.3 ... 1.32931e+13
No other solutions better than -98367.1

Optimal solution found (tolerance 1.00e-04)
Best objective -9.836713235406e+04, best bound -9.836713235406e+04, gap 0.0000%
  Subproblem solved in 0.06s
  Worst-case operational profit (Z_SP) = 107054.58
  Scenario: 10 demand increases, 50 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -98367.13
  [DEBUG]   S×d_nominal = 205421.71
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 205421.71 + -98367.13 = 107054.58
  [DEBUG]   Current θ from Master = 116839.98
  [DEBUG]   ⚠️  Z_SP ≤ θ by 9785.40 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -21058.11
  Lower Bound (LB) = -13018.71
  Gap (UB-LB) = 1746.0001, Absolute Gap = 1746.0001, Relative Gap = 0.154887
  Not converged yet (gap = 1746.00 > ε = 200)

  [DEBUG] Adding NEW scenario 9 to Master Problem...
  [DEBUG] New scenario pattern: 10 increases, 50 decreases
    [DEBUG] Scenario 9 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 9 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 9]
    [DEBUG]   - Total constraints in model: 154283
    [DEBUG]   - Total variables in model: 64660
  [DEBUG] Total scenarios in Master: 10
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 10
================================================================================
[Iteration 10] Solving Master Problem...
  Current scenarios in Master: 10
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 154283 rows, 64660 columns and 437949 nonzeros
Model fingerprint: 0x577c338f
Variable types: 62401 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 66760 rows and 27110 columns
Presolve time: 1.25s
Presolved: 87523 rows, 37550 columns, 533019 nonzeros
Variable types: 35291 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -384051.3542
Found heuristic solution: objective -190756.9345

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.17s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.755e+06
 Factor NZ  : 8.145e+06 (roughly 120 MB of memory)
 Factor Ops : 1.399e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.65388861e+07  1.46888351e+08  8.63e+04 1.95e+01  6.91e+04     2s
   1  -1.22757220e+07  1.27517910e+08  5.87e+04 6.20e+01  4.65e+04     2s
   2  -4.44007016e+06  1.01216082e+08  2.07e+04 1.03e-11  1.74e+04     2s
   3  -7.56789193e+05  6.73934681e+07  1.48e+03 9.63e-01  1.58e+03     2s
   4  -4.68335004e+05  2.45808098e+07  3.13e+02 1.31e-01  3.70e+02     2s
   5  -3.68715564e+05  1.81490977e+07  1.35e+02 8.98e-02  2.01e+02     3s
   6  -2.64484107e+05  1.43237729e+07  5.84e+01 6.77e-02  1.25e+02     3s
   7  -1.48976960e+05  1.07579729e+07  8.94e+00 4.83e-02  7.23e+01     3s
   8  -1.09205537e+05  6.12187909e+06  5.85e+00 2.65e-02  4.06e+01     3s
   9  -8.79874044e+04  2.87121951e+06  3.83e+00 1.20e-02  1.90e+01     3s
  10  -6.38787898e+04  1.38776832e+06  2.19e+00 5.47e-03  9.22e+00     3s
  11  -2.83840607e+04  4.43441224e+05  7.77e-01 1.43e-03  2.96e+00     3s
  12  -1.82246493e+04  1.98836351e+05  3.84e-01 8.79e-04  1.36e+00     3s
  13  -1.31725919e+04  1.19367118e+05  2.61e-01 6.85e-04  8.27e-01     3s
  14  -1.02614227e+04  7.92854641e+04  2.16e-01 6.60e-04  5.59e-01     3s
  15  -6.53083452e+03  6.58021242e+04  1.66e-01 7.94e-04  4.51e-01     3s
  16  -3.04004222e+03  5.11073493e+04  1.32e-01 1.20e-03  3.38e-01     3s
  17   1.18994200e+01  4.11232472e+04  1.04e-01 1.26e-03  2.56e-01     3s
  18   2.48456828e+03  3.53243116e+04  8.26e-02 1.12e-03  2.05e-01     3s
  19   3.80856380e+03  2.75468152e+04  7.13e-02 1.40e-03  1.48e-01     3s
  20   6.28784030e+03  2.35381441e+04  5.23e-02 1.56e-03  1.08e-01     3s
  21   7.80917560e+03  2.12798116e+04  4.13e-02 1.09e-03  8.40e-02     3s
  22   8.30081034e+03  1.99115203e+04  3.71e-02 1.23e-03  7.24e-02     3s
  23   9.62639880e+03  1.84973500e+04  2.71e-02 9.59e-04  5.53e-02     3s
  24   1.03666833e+04  1.76209470e+04  2.17e-02 9.58e-04  4.52e-02     3s
  25   1.07061230e+04  1.62652408e+04  1.92e-02 8.37e-04  3.47e-02     3s
  26   1.11866897e+04  1.55708751e+04  1.58e-02 6.78e-04  2.73e-02     3s
  27   1.18172955e+04  1.49839328e+04  1.15e-02 6.51e-04  1.97e-02     3s
  28   1.22908613e+04  1.47766315e+04  8.44e-03 5.55e-04  1.55e-02     3s
  29   1.26064350e+04  1.46046581e+04  6.37e-03 4.69e-04  1.25e-02     3s
  30   1.28909579e+04  1.43307860e+04  4.56e-03 3.83e-04  8.97e-03     3s
  31   1.30841711e+04  1.41996944e+04  3.34e-03 3.09e-04  6.95e-03     3s
  32   1.32487378e+04  1.40711943e+04  2.34e-03 2.33e-04  5.12e-03     3s
  33   1.32632628e+04  1.40292523e+04  2.26e-03 2.12e-04  4.77e-03     3s
  34   1.33092069e+04  1.40057501e+04  1.98e-03 1.99e-04  4.34e-03     3s
  35   1.34041143e+04  1.39362626e+04  1.43e-03 1.38e-04  3.32e-03     4s
  36   1.34443222e+04  1.38307150e+04  1.19e-03 1.29e-04  2.41e-03     4s
  37   1.35360007e+04  1.37384827e+04  6.56e-04 6.32e-05  1.26e-03     4s
  38   1.35465484e+04  1.36896818e+04  5.95e-04 3.05e-05  8.92e-04     4s
  39   1.35716318e+04  1.36786361e+04  4.60e-04 1.97e-05  6.67e-04     4s
  40   1.35761729e+04  1.36684759e+04  4.36e-04 9.33e-06  5.76e-04     4s
  41   1.35969021e+04  1.36665378e+04  3.21e-04 7.73e-06  4.34e-04     4s
  42   1.36351849e+04  1.36647699e+04  1.18e-04 5.66e-06  1.84e-04     4s
  43   1.36523920e+04  1.36626516e+04  2.30e-05 5.91e-06  6.39e-05     4s
  44   1.36545380e+04  1.36583596e+04  1.27e-05 8.38e-07  2.38e-05     4s
  45   1.36560857e+04  1.36580265e+04  5.79e-06 5.28e-07  1.21e-05     4s
  46   1.36563326e+04  1.36578196e+04  4.68e-06 3.33e-07  9.27e-06     4s
  47   1.36573966e+04  1.36574515e+04  9.52e-08 2.24e-07  3.41e-07     4s
  48   1.36574262e+04  1.36574276e+04  9.85e-09 1.43e-09  9.08e-09     4s
  49   1.36574266e+04  1.36574275e+04  3.40e-07 2.57e-10  5.46e-09     4s
  50   1.36574274e+04  1.36574275e+04  5.95e-08 1.20e-11  2.03e-10     4s

Barrier solved model in 50 iterations and 4.13 seconds (7.81 work units)
Optimal objective 1.36574274e+04


Root crossover log...

       0 DPushes remaining with DInf 0.0000000e+00                 6s

    5987 PPushes remaining with PInf 6.1435729e-05                 6s
       0 PPushes remaining with PInf 0.0000000e+00                 6s

  Push phase complete: Pinf 0.0000000e+00, Dinf 8.2287335e+02      6s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   33392    1.3657427e+04   0.000000e+00   8.228734e+02      6s
   33406    1.3657427e+04   0.000000e+00   0.000000e+00      6s
   33406    1.3657427e+04   0.000000e+00   0.000000e+00      6s
Concurrent spin time: 0.12s

Solved with barrier

Root relaxation: objective 1.365743e+04, 33406 iterations, 4.41 seconds (10.23 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 13657.4275    0  550 -190756.93 13657.4275   107%     -    6s
H    0     0                    -179443.4956 13657.4275   108%     -    6s
H    0     0                    -169618.2648 13657.4275   108%     -    6s
H    0     0                    -169587.1671 13657.4275   108%     -    6s
H    0     0                    -144485.5223 13657.4275   109%     -    7s
H    0     0                    -143673.8362 13657.4275   110%     -    7s
H    0     0                    -142465.5427 13657.4275   110%     -    7s
H    0     0                    -126076.2211 13657.4275   111%     -    7s
H    0     0                    -126019.0491 13657.4275   111%     -    7s
H    0     0                    -125989.8166 13657.4275   111%     -    7s
H    0     0                    -108798.7016 13657.4275   113%     -    7s
H    0     0                    -75749.72981 13657.4275   118%     -    7s
H    0     0                    -74554.89491 13657.4275   118%     -    7s
H    0     0                    -65909.04238 8211.64749   112%     -   32s
H    0     0                    -65783.39005 8211.64749   112%     -   32s
H    0     0                    -65763.25821 8211.64749   112%     -   32s
     0     0 8129.26542    0  726 -65763.258 8129.26542   112%     -   33s
H    0     0                    -65670.47452 8129.26542   112%     -   33s
H    0     0                    -65635.66961 8129.26542   112%     -   33s
     0     0 7563.35787    0  711 -65635.670 7563.35787   112%     -   41s
     0     0 7246.79487    0  715 -65635.670 7246.79487   111%     -   45s
     0     0 7147.52763    0  708 -65635.670 7147.52763   111%     -   49s
     0     0 7147.52763    0  704 -65635.670 7147.52763   111%     -   54s
     0     0 7147.52763    0  704 -65635.670 7147.52763   111%     -   56s
     0     0 7147.52763    0  707 -65635.670 7147.52763   111%     -   58s
     0     0 7147.52763    0  702 -65635.670 7147.52763   111%     -   60s
     0     0 7147.52763    0  700 -65635.670 7147.52763   111%     -   61s
     0     0 7147.52763    0  700 -65635.670 7147.52763   111%     -   61s
H    0     0                    -63409.51272 4049.46861   106%     -   85s
H    0     0                    -62217.60727 4049.46861   107%     -   85s
H    0     0                    -62043.68988 4049.46861   107%     -   85s
H    0     0                    -61773.48174 4049.46861   107%     -   85s
     0     0 4049.46861    0  624 -61773.482 4049.46861   107%     -   85s
H    0     0                    -61603.49828 4048.97431   107%     -   86s
H    0     0                    -61195.36391 4048.97431   107%     -   86s
H    0     0                    -61039.38932 4048.97431   107%     -   86s
     0     0 3257.73115    0  612 -61039.389 3257.73115   105%     -  110s
     0     0 3183.80486    0  673 -61039.389 3183.80486   105%     -  122s
     0     0 3155.86670    0  657 -61039.389 3155.86670   105%     -  130s
     0     0 3075.80772    0  654 -61039.389 3075.80772   105%     -  138s
     0     0 3058.05107    0  651 -61039.389 3058.05107   105%     -  143s
     0     0 3054.41327    0  649 -61039.389 3054.41327   105%     -  146s
     0     0 3032.28989    0  654 -61039.389 3032.28989   105%     -  150s
H    0     0                    -57569.52768 2998.36282   105%     -  156s
H    0     0                    -57040.12927 2998.36282   105%     -  156s
     0     0 2998.36282    0  656 -57040.129 2998.36282   105%     -  156s
     0     0 2990.75673    0  644 -57040.129 2990.75673   105%     -  158s
H    0     0                    -54643.31585 2988.93823   105%     -  159s
     0     0 2988.93823    0  644 -54643.316 2988.93823   105%     -  159s
     0     0 2988.74493    0  645 -54643.316 2988.74493   105%     -  160s
H    0     0                    -46675.66626 1222.34801   103%     -  221s
H    0     0                    -44795.82089 1222.34801   103%     -  221s
H    0     0                    -31681.86487 1222.34801   104%     -  221s
H    0     0                    -16304.09334 1222.34801   107%     -  221s
H    0     0                    -16163.77870 1222.34801   108%     -  221s
H    0     0                    -15100.82301 1222.34801   108%     -  221s
H    0     0                    -14525.52321 1222.34801   108%     -  221s
H    0     0                    -14505.69286 1222.34801   108%     -  221s
     0     0 1222.34801    0  600 -14505.693 1222.34801   108%     -  221s
H    0     0                    -14486.45230 1222.22291   108%     -  221s
H    0     0                    -14377.51064 1222.22291   109%     -  221s
H    0     0                    -14356.24883 1222.22291   109%     -  221s
H    0     0                    -14353.66492 1222.22291   109%     -  221s
     0     0  817.56310    0  598 -14353.665  817.56310   106%     -  247s
     0     0  624.97511    0  619 -14353.665  624.97511   104%     -  263s
     0     0  589.91963    0  680 -14353.665  589.91963   104%     -  270s
     0     0  577.54925    0  622 -14353.665  577.54925   104%     -  275s
     0     0  529.38335    0  630 -14353.665  529.38335   104%     -  285s
     0     0  514.12737    0  632 -14353.665  514.12737   104%     -  292s
     0     0  511.64936    0  630 -14353.665  511.64936   104%     -  296s
     0     0  476.15516    0  619 -14353.665  476.15516   103%     -  303s
     0     0  464.96171    0  628 -14353.665  464.96171   103%     -  307s
     0     0  455.35165    0  639 -14353.665  455.35165   103%     -  310s
     0     0  439.76560    0  630 -14353.665  439.76560   103%     -  314s
     0     0  435.21572    0  641 -14353.665  435.21572   103%     -  317s
     0     0  431.68835    0  645 -14353.665  431.68835   103%     -  319s
     0     0  431.27214    0  644 -14353.665  431.27214   103%     -  319s
     0     0 -611.64864    0  762 -14353.665 -611.64864  95.7%     -  378s
H    0     0                    -14336.85335 -611.70383  95.7%     -  379s
     0     0 -738.33732    0  712 -14336.853 -738.33732  94.9%     -  396s
     0     0 -771.84987    0  729 -14336.853 -771.84987  94.6%     -  409s
     0     0 -799.02635    0  665 -14336.853 -799.02635  94.4%     -  417s
     0     0 -806.26083    0  661 -14336.853 -806.26083  94.4%     -  419s
     0     0 -813.39743    0  647 -14336.853 -813.39743  94.3%     -  421s
     0     0 -848.20216    0  667 -14336.853 -848.20216  94.1%     -  429s
     0     0 -852.88916    0  664 -14336.853 -852.88916  94.1%     -  432s
     0     0 -857.88858    0  741 -14336.853 -857.88858  94.0%     -  435s
     0     0 -860.90937    0  739 -14336.853 -860.90937  94.0%     -  437s
     0     0 -862.36134    0  738 -14336.853 -862.36134  94.0%     -  439s
     0     0 -1044.9421    0  654 -14336.853 -1044.9421  92.7%     -  455s
H    0     0                    -13498.75321 -1045.0292  92.3%     -  455s
H    0     0                    -13422.64032 -1045.0292  92.2%     -  455s
H    0     0                    -13336.19397 -1045.0292  92.2%     -  455s
H    0     0                    -13144.65665 -1045.0292  92.0%     -  455s
H    0     0                    -13144.63739 -1045.0292  92.0%     -  455s
H    0     0                    -13077.69290 -1045.0292  92.0%     -  455s
H    0     0                    -13059.45250 -1045.0292  92.0%     -  455s
H    0     0                    -12961.80927 -1045.0292  91.9%     -  455s
     0     0 -1092.6393    0  654 -12961.809 -1092.6393  91.6%     -  466s
     0     0 -1111.4901    0  673 -12961.809 -1111.4901  91.4%     -  474s
     0     0 -1119.4979    0  673 -12961.809 -1119.4979  91.4%     -  481s
     0     0 -1121.4755    0  681 -12961.809 -1121.4755  91.3%     -  484s
     0     0 -1229.7175    0  733 -12961.809 -1229.7175  90.5%     -  507s
H    0     0                    -12847.49824 -1229.7215  90.4%     -  509s
H    0     0                    -12808.80718 -1229.7215  90.4%     -  510s
H    0     0                    -12711.39487 -1229.7215  90.3%     -  511s
H    0     0                    -12672.06188 -1229.7215  90.3%     -  511s
H    0     0                    -12593.16727 -1229.7215  90.2%     -  511s
H    0     0                    -12512.60876 -1229.7215  90.2%     -  511s
H    0     0                    -12451.93246 -1229.7215  90.1%     -  511s
H    0     0                    -12447.42621 -1229.7215  90.1%     -  511s
     0     0 -1265.5788    0  824 -12447.426 -1265.5788  89.8%     -  521s
     0     0 -1277.2281    0  742 -12447.426 -1277.2281  89.7%     -  529s
     0     0 -1279.8573    0  819 -12447.426 -1279.8573  89.7%     -  535s
     0     0 -1320.4315    0  751 -12447.426 -1320.4315  89.4%     -  553s
H    0     0                    -12391.77583 -1320.4485  89.3%     -  553s
H    0     0                    -12259.61949 -1320.4485  89.2%     -  553s
     0     0 -1353.6159    0  745 -12259.619 -1353.6159  89.0%     -  567s
     0     0 -1363.6394    0  753 -12259.619 -1363.6394  88.9%     -  575s
     0     0 -1366.7142    0  765 -12259.619 -1366.7142  88.9%     -  580s
     0     0 -1413.3187    0  775 -12259.619 -1413.3187  88.5%     -  597s
H    0     0                    -12256.27278 -1413.3774  88.5%     -  598s
     0     0 -1427.8025    0  849 -12256.273 -1427.8025  88.4%     -  606s
     0     0 -1434.4781    0  845 -12256.273 -1434.4781  88.3%     -  611s
     0     0 -1436.8743    0  713 -12256.273 -1436.8743  88.3%     -  613s
     0     0 -1456.8000    0  714 -12256.273 -1456.8000  88.1%     -  624s
H    0     0                    -12165.70496 -1456.8382  88.0%     -  625s
     0     0 -1463.2110    0  719 -12165.705 -1463.2110  88.0%     -  628s
     0     0 -1465.2661    0  710 -12165.705 -1465.2661  88.0%     -  630s
     0     0 -1486.1747    0  707 -12165.705 -1486.1747  87.8%     -  642s
H    0     0                    -12143.22564 -1486.3951  87.8%     -  643s
H    0     0                    -12130.24177 -1486.3951  87.7%     -  643s
H    0     0                    -12078.46445 -1486.3951  87.7%     -  643s
H    0     0                    -12078.23273 -1486.3951  87.7%     -  643s
     0     0 -1489.2164    0  716 -12078.233 -1489.2164  87.7%     -  647s
     0     0 -1497.9645    0  770 -12078.233 -1497.9645  87.6%     -  655s
     0     0 -1498.0218    0  770 -12078.233 -1498.0218  87.6%     -  660s
H    0     0                    -12077.06857 -1498.0218  87.6%     -  693s
H    0     0                    -12039.15355 -1498.0218  87.6%     -  719s
H    0     0                    -12000.13191 -1498.0218  87.5%     -  720s
H    0     0                    -11989.30273 -1498.0218  87.5%     -  720s
H    0     0                    -11970.64209 -1498.0218  87.5%     -  720s
H    0     0                    -11955.76914 -1498.0218  87.5%     -  721s
     0     2 -1498.0218    0  770 -11955.769 -1498.0218  87.5%     -  722s
     1     3 -2412.2719    1  605 -11955.769 -1498.0218  87.5% 30250  771s
     2     4 -1541.7096    1  710 -11955.769 -1541.7096  87.1% 16390  784s
     3     7 -2691.6974    2  651 -11955.769 -1541.8130  87.1% 12612  801s
     6    13 -3122.9566    3  585 -11955.769 -1542.5041  87.1%  9575  822s
    12    25 -3377.7845    4  642 -11955.769 -1635.1610  86.3% 10640  867s
    24    38 -3768.7547    5  665 -11955.769 -1768.2718  85.2% 16220  946s
H   37    67                    -11951.84745 -1782.0420  85.1% 15531 1049s
H   43    67                    -11927.37245 -1782.0420  85.1% 15705 1049s
H   49    67                    -11926.21293 -1782.0420  85.1% 14977 1049s
H   56    67                    -11895.10932 -1782.0420  85.0% 13776 1049s
H   67    67                    -11887.92383 -1916.2996  83.9% 16308 1049s
    68   199 -3798.9263    6  535 -11887.924 -1916.2996  83.9% 16280 1151s
   200   278 -4181.2579   11  509 -11887.924 -1955.5331  83.6%  8895 1179s
H  206   278                    -11886.76431 -1955.5331  83.5%  9037 1179s
   279   360 -4391.9892   14  488 -11886.764 -1955.5331  83.5%  8297 1201s
   363   413 -4982.1143   17  337 -11886.764 -1955.5331  83.5%  7247 1219s
H  405   413                    -11884.00214 -1955.5331  83.5%  6900 1219s
   424   474 -5203.3162   21  318 -11884.002 -1955.5331  83.5%  6732 1237s
   509   496 -6037.5125   23  334 -11884.002 -1955.5331  83.5%  6129 1253s
   552   498 -6579.0240   17  462 -11884.002 -1955.5331  83.5%  5880 1272s
   587   513 -6288.7228   24  231 -11884.002 -1955.5331  83.5%  5790 1291s
   620   532 -7551.8028   25  138 -11884.002 -1955.5331  83.5%  6006 1309s
   647   567 -7955.6366   26  141 -11884.002 -1955.5331  83.5%  6038 1327s
   698   610 -9774.6801   27  149 -11884.002 -1955.5331  83.5%  6079 1346s
   755   656 -10055.552   32  126 -11884.002 -1955.5331  83.5%  6071 1364s
   825   683     cutoff   36      -11884.002 -1955.5331  83.5%  5986 1381s
   894   707 -9201.8378   33  271 -11884.002 -1955.5331  83.5%  5856 1398s
   954   722 -9474.2526   34  147 -11884.002 -1955.5331  83.5%  5835 1417s
  1021   739 -11844.862   36  235 -11884.002 -2026.6843  82.9%  5847 1437s
  1091   806 infeasible   36      -11884.002 -2179.6274  81.7%  5862 1456s
  1191   858 -4511.1874   10  501 -11884.002 -2179.7453  81.7%  5740 1476s
  1299   923 -4963.8384   11  501 -11884.002 -2179.7453  81.7%  5595 1497s
  1426   962 -4929.8221   14  256 -11884.002 -2179.7453  81.7%  5409 1517s
  1540  1004 -7727.8408   15  108 -11884.002 -2179.7453  81.7%  5265 1541s
  1655  1122 -8430.7784   19   83 -11884.002 -2179.7453  81.7%  5195 1562s
  1828  1222 -9584.5363   28   58 -11884.002 -2179.7453  81.7%  4983 1583s
  2055  1228 -11264.431   37   56 -11884.002 -2179.7453  81.7%  4635 1606s
  2182  1259 -5614.1692   11  406 -11884.002 -2179.7453  81.7%  4589 1630s
  2253  1293 -5848.1713   12  392 -11884.002 -2179.7453  81.7%  4697 1654s
  2343  1324 -6679.7317   14  424 -11884.002 -2179.7453  81.7%  4778 1680s
  2418  1373 -7569.0273   15  539 -11884.002 -2179.7453  81.7%  4912 1706s
  2499  1441 -8253.7451   16  520 -11884.002 -2444.5814  79.4%  5011 1732s
  2637  1495 -9259.6391   18  519 -11884.002 -2444.5814  79.4%  5047 1760s
  2816  1545 -10101.641   19  384 -11884.002 -2444.5814  79.4%  4992 1790s
  2961  1598 -11585.273   22  387 -11884.002 -2444.5814  79.4%  5024 1823s
  3088  1647 -9391.5248   20  510 -11884.002 -2609.2611  78.0%  5078 1856s
  3179  1716 -9644.8908   21  436 -11884.002 -2609.2611  78.0%  5104 1891s
  3298  1774 -10973.567   22  403 -11884.002 -2609.2611  78.0%  5110 1924s
  3409  1821     cutoff   23      -11884.002 -2609.2611  78.0%  5166 1958s
  3536  1829     cutoff   24      -11884.002 -2609.2611  78.0%  5213 1992s
  3582  1851     cutoff   23      -11884.002 -3044.0501  74.4%  5278 2027s
  3644  1868 -7201.5713   15  783 -11884.002 -3469.2796  70.8%  5354 2062s
  3725  1892 -5861.1409   18  573 -11884.002 -3494.1618  70.6%  5429 2092s
  3769  1930 -7505.7129   16  764 -11884.002 -3494.1618  70.6%  5494 2127s
  3878  1955 -7992.2759   17  773 -11884.002 -3534.3922  70.3%  5534 2166s
  4025  2009 -8583.9543   18  750 -11884.002 -3589.9834  69.8%  5572 2209s
  4160  2076 -8711.2421   19  745 -11884.002 -3589.9834  69.8%  5654 2253s
  4341  2113 -10002.562   21  698 -11884.002 -3589.9834  69.8%  5723 2300s
  4504  2181 -11069.636   22  694 -11884.002 -3589.9834  69.8%  5802 2349s
  4709  2256     cutoff   25      -11884.002 -3703.2041  68.8%  5847 2399s
  4946  2312 -7765.3019   10  441 -11884.002 -3703.2041  68.8%  5883 2447s
  5122  2388 -9995.8316   14  292 -11884.002 -3703.2041  68.8%  6007 2501s
  5300  2461 -11804.692   16  370 -11884.002 -3739.1095  68.5%  6126 2548s
H 5361  2435                    -11679.33620 -3739.1095  68.0%  6160 2548s
H 5476  2425                    -11666.36762 -3739.1095  67.9%  6155 2575s
H 5476  2417                    -11641.60504 -3739.1095  67.9%  6155 2575s
H 5476  2400                    -11595.48249 -3739.1095  67.8%  6155 2581s
  5477  2391 -5169.1363   17  770 -11595.482 -3739.1095  67.8%  6154 2867s
H 5478  2272                    -11561.26469 -3739.1095  67.7%  6153 2874s
  5479  2272 -9664.4480   33  537 -11561.265 -3739.1095  67.7%  6152 2877s
H 5479  2158                    -11529.74546 -3739.1095  67.6%  6152 2957s
H 5479  2050                    -11513.83681 -3739.1095  67.5%  6152 2957s
H 5480  1949                    -11493.32107 -3739.1095  67.5%  6150 3028s
  5481  1950 -11493.321   38  751 -11493.321 -3739.1095  67.5%  6149 3030s
  5482  1950 -4809.7117   17  720 -11493.321 -3739.1095  67.5%  6148 3079s
  5483  1951 -9767.9600   33  780 -11493.321 -3739.1095  67.5%  6147 3122s
  5484  1952 -6060.5882   19  738 -11493.321 -3739.1095  67.5%  6146 3149s
  5485  1952 -3920.0461   12  751 -11493.321 -3739.1095  67.5%  6145 3173s
  5486  1953 -7692.4731   15  758 -11493.321 -3739.1095  67.5%  6144 3195s
  5487  1954 -4511.5624   11  757 -11493.321 -3739.1095  67.5%  6143 3204s
  5488  1954 -10015.961   38  765 -11493.321 -3739.1095  67.5%  6141 3216s
  5489  1955 -4075.3241    7  773 -11493.321 -3739.1095  67.5%  6140 3260s
  5490  1956 -5472.9158   20  697 -11493.321 -3739.1095  67.5%  6139 3296s
  5491  1956 -10490.641   35  739 -11493.321 -3739.1095  67.5%  6138 3317s
  5492  1957 -10859.978   25  757 -11493.321 -3739.1095  67.5%  6137 3331s
  5493  1958 -8875.3982   15  831 -11493.321 -3739.1095  67.5%  6136 3349s
  5494  1958 -6304.4328   14  754 -11493.321 -3739.1095  67.5%  6135 3364s
  5495  1959 -10406.821   34  758 -11493.321 -3739.1095  67.5%  6134 3380s
  5496  1960 -9452.3179   30  754 -11493.321 -3739.1095  67.5%  6133 3391s
  5497  1960 -4719.0242   15  744 -11493.321 -3739.1095  67.5%  6131 3421s
  5498  1961 -7214.3615   17  762 -11493.321 -3739.1095  67.5%  6130 3436s
  5499  1962 -5129.8456   15  771 -11493.321 -3739.1095  67.5%  6129 3443s
  5500  1962 -5114.5158   11  717 -11493.321 -3739.1095  67.5%  6128 3451s
  5501  1963 -10782.513   35  720 -11493.321 -3739.1095  67.5%  6127 3468s
  5502  1964 -10059.823   33  725 -11493.321 -3739.1095  67.5%  6126 3477s
  5503  1964 -10877.595   20  834 -11493.321 -3739.1095  67.5%  6125 3489s
  5504  1965 -10476.159   41  778 -11493.321 -3739.1095  67.5%  6124 3505s
  5505  1966 -10604.450   37  723 -11493.321 -3739.1095  67.5%  6122 3513s
  5506  1966 -7166.3125   13  718 -11493.321 -3739.1095  67.5%  6121 3526s
  5507  1967 -8282.2973   14  801 -11493.321 -3739.1095  67.5%  6120 3536s
  5508  1968 -5037.6935   10  801 -11493.321 -3739.1095  67.5%  6119 3553s
  5509  1968 -6651.7602   17  737 -11493.321 -3739.1095  67.5%  6118 3561s
  5510  1969 -11187.751   33  726 -11493.321 -3739.1095  67.5%  6117 3568s
  5511  1970 -6780.8081   29  713 -11493.321 -3739.1095  67.5%  6116 3585s
  5512  1970 -5653.8823   12  713 -11493.321 -3739.1095  67.5%  6115 3596s

Cutting planes:
  Implied bound: 27
  Projected implied bound: 308
  MIR: 1625
  Flow cover: 1486
  Zero half: 3
  RLT: 70
  Relax-and-lift: 203

Explored 5512 nodes (34661508 simplex iterations) in 3600.02 seconds (8751.66 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -11493.3 -11513.8 -11529.7 ... -11886.8

Time limit reached
Best objective -1.149332107382e+04, best bound -3.739109484186e+03, gap 67.4671%
  WARNING: Time limit reached. Using best solution found (gap: 67.47%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.11s
  Master Objective (UB) = -11493.32, θ = 116382.22
  Upper Bound (UB) = -11493.32

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 116382.22
  [DEBUG]   ✓ Scenario 0: θ = 116382.22 ≤ Q = 116382.22 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 116382.22 ≤ Q = 116382.22 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 116382.22 ≤ Q = 116382.22 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 116382.22 ≤ Q = 116382.22 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 116382.22 ≤ Q = 116382.22 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 116382.22 ≤ Q = 116382.22 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 116382.22 ≤ Q = 116382.22 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 116382.22 ≤ Q = 116382.22 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 116382.22 ≤ Q = 116382.22 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 116382.22 ≤ Q = 116382.22 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 10] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x7913b843
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x86ec47bd
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.324640e+13
Presolve removed 2577 rows and 1870 columns
Presolve time: 0.00s
Presolved: 516 rows, 519 columns, 1455 nonzeros
Found heuristic solution: objective 6966214.1032
Variable types: 351 continuous, 168 integer (168 binary)

Root relaxation: objective -1.204282e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -120428.23    0  122 6966214.10 -120428.23   102%     -    0s
H    0     0                    -85876.04419 -120428.23  40.2%     -    0s
H    0     0                    -86405.39818 -120428.23  39.4%     -    0s
     0     0 -92647.397    0   76 -86405.398 -92647.397  7.22%     -    0s
H    0     0                    -90160.74229 -92618.588  2.73%     -    0s
     0     0 -92219.722    0   80 -90160.742 -92219.722  2.28%     -    0s
     0     0 -92207.213    0   78 -90160.742 -92207.213  2.27%     -    0s
H    0     0                    -91110.71218 -92207.213  1.20%     -    0s
H    0     0                    -91156.74554 -92207.213  1.15%     -    0s
     0     0 -92079.424    0   77 -91156.746 -92079.424  1.01%     -    0s
     0     0 -92078.228    0   77 -91156.746 -92078.228  1.01%     -    0s
H    0     0                    -91472.09175 -92077.914  0.66%     -    0s
H    0     0                    -91628.95062 -92077.914  0.49%     -    0s
     0     0 -92077.914    0   79 -91628.951 -92077.914  0.49%     -    0s
     0     0 -92077.914    0   68 -91628.951 -92077.914  0.49%     -    0s
     0     0 -91974.640    0   52 -91628.951 -91974.640  0.38%     -    0s
     0     0 -91972.774    0   51 -91628.951 -91972.774  0.38%     -    0s
     0     0 -91970.530    0   51 -91628.951 -91970.530  0.37%     -    0s
     0     0 -91826.598    0   46 -91628.951 -91826.598  0.22%     -    0s
H    0     0                    -91800.12074 -91823.740  0.03%     -    0s
H    0     0                    -91803.48019 -91813.985  0.01%     -    0s
     0     0 -91813.985    0    8 -91803.480 -91813.985  0.01%     -    0s
     0     0          -    0      -91803.480 -91811.297  0.01%     -    0s

Cutting planes:
  Gomory: 27
  Implied bound: 3
  MIR: 76
  Flow cover: 11
  RLT: 4
  Relax-and-lift: 2

Explored 1 nodes (980 simplex iterations) in 0.08 seconds (0.06 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -91803.5 -91800.1 -91629 ... 1.32464e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -9.180348019045e+04, best bound -9.181129688576e+04, gap 0.0085%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 113618.23
  Scenario: 8 demand increases, 52 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -91803.48
  [DEBUG]   S×d_nominal = 205421.71
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 205421.71 + -91803.48 = 113618.23
  [DEBUG]   Current θ from Master = 116382.22
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2763.98 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -14257.31
  Lower Bound (LB) = -13018.71
  Gap (UB-LB) = 1525.3928, Absolute Gap = 1525.3928, Relative Gap = 0.132720
  Not converged yet (gap = 1525.39 > ε = 200)

  [DEBUG] Adding NEW scenario 10 to Master Problem...
  [DEBUG] New scenario pattern: 8 increases, 52 decreases
    [DEBUG] Scenario 10 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 10 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 10]
    [DEBUG]   - Total constraints in model: 169573
    [DEBUG]   - Total variables in model: 70900
  [DEBUG] Total scenarios in Master: 11
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 11
================================================================================
[Iteration 11] Solving Master Problem...
  Current scenarios in Master: 11
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 169573 rows, 70900 columns and 481192 nonzeros
Model fingerprint: 0x29712021
Variable types: 68641 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 73446 rows and 29826 columns
Presolve time: 1.35s
Presolved: 96127 rows, 41074 columns, 583121 nonzeros
Variable types: 38815 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -384705.7937
Found heuristic solution: objective -190756.9345

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.21s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 4.332e+06
 Factor NZ  : 9.496e+06 (roughly 130 MB of memory)
 Factor Ops : 1.733e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.66075698e+07  1.60338195e+08  8.67e+04 1.95e+01  6.89e+04     3s
   1  -1.23748416e+07  1.39059385e+08  5.90e+04 5.97e+01  4.64e+04     3s
   2  -3.94875241e+06  1.10401628e+08  1.81e+04 8.16e-12  1.51e+04     3s
   3  -8.67116014e+05  7.39176627e+07  1.92e+03 2.40e-01  1.91e+03     3s
   4  -4.93953121e+05  4.10590377e+07  3.22e+02 7.48e-02  4.65e+02     3s
   5  -4.24454652e+05  2.61578534e+07  1.61e+02 4.37e-02  2.55e+02     3s
   6  -3.28850749e+05  1.96050485e+07  5.37e+01 3.07e-02  1.45e+02     3s
   7  -2.04359155e+05  1.42819912e+07  6.20e+00 2.12e-02  8.52e+01     3s
   8  -1.14565722e+05  6.12222099e+06  5.53e-01 9.45e-03  3.55e+01     3s
   9  -8.75462012e+04  4.60081042e+06  3.47e-01 7.04e-03  2.67e+01     3s
  10  -6.74879234e+04  2.16908336e+06  2.33e-01 3.42e-03  1.27e+01     3s
  11  -4.44953528e+04  5.73616210e+05  1.33e-01 8.01e-04  3.51e+00     3s
  12  -2.58970366e+04  2.94817540e+05  7.70e-02 5.97e-04  1.82e+00     3s
  13  -1.60020793e+04  1.52520512e+05  4.71e-02 5.77e-04  9.56e-01     3s
  14  -1.18364739e+04  9.89152180e+04  3.80e-02 1.22e-03  6.28e-01     3s
  15  -7.56337086e+03  8.07025348e+04  2.95e-02 1.24e-03  5.01e-01     3s
  16  -2.06457940e+03  5.49626613e+04  2.07e-02 1.90e-03  3.24e-01     3s
  17   1.14054424e+03  4.29109735e+04  1.61e-02 1.33e-03  2.37e-01     3s
  18   3.53860334e+03  3.53026773e+04  1.30e-02 9.76e-04  1.80e-01     3s
  19   6.56181862e+03  2.70068034e+04  9.05e-03 4.95e-04  1.16e-01     3s
  20   8.07447734e+03  2.22652207e+04  7.21e-03 3.10e-04  8.05e-02     3s
  21   9.21502244e+03  1.93315221e+04  5.82e-03 2.76e-04  5.74e-02     3s
  22   1.01960920e+04  1.81086495e+04  4.60e-03 2.26e-04  4.49e-02     3s
  23   1.12920495e+04  1.72229733e+04  3.35e-03 1.70e-04  3.36e-02     3s
  24   1.16858128e+04  1.65127225e+04  2.90e-03 1.27e-04  2.74e-02     3s
  25   1.20516950e+04  1.64582907e+04  2.48e-03 1.23e-04  2.50e-02     4s
  26   1.23245825e+04  1.62330716e+04  2.17e-03 1.10e-04  2.22e-02     4s
  27   1.27480425e+04  1.57140002e+04  1.67e-03 8.17e-05  1.68e-02     4s
  28   1.30303032e+04  1.52968072e+04  1.36e-03 5.44e-05  1.29e-02     4s
  29   1.35025759e+04  1.50766669e+04  8.56e-04 4.13e-05  8.93e-03     4s
  30   1.36504886e+04  1.49456829e+04  6.99e-04 3.36e-05  7.35e-03     4s
  31   1.38239279e+04  1.47044466e+04  5.22e-04 1.94e-05  5.00e-03     4s
  32   1.39397417e+04  1.46450976e+04  4.10e-04 1.59e-05  4.00e-03     4s
  33   1.39828230e+04  1.46228433e+04  3.68e-04 1.46e-05  3.63e-03     4s
  34   1.40864684e+04  1.45660470e+04  2.60e-04 1.13e-05  2.72e-03     4s
  35   1.41598081e+04  1.44856802e+04  1.88e-04 6.76e-06  1.85e-03     4s
  36   1.42031382e+04  1.44571000e+04  1.46e-04 5.18e-06  1.44e-03     4s
  37   1.42803605e+04  1.44184197e+04  7.15e-05 3.06e-06  7.83e-04     4s
  38   1.43041098e+04  1.43867055e+04  4.91e-05 1.35e-06  4.69e-04     4s
  39   1.43245684e+04  1.43800700e+04  3.04e-05 1.01e-06  3.15e-04     4s
  40   1.43361474e+04  1.43764925e+04  1.99e-05 8.36e-07  2.29e-04     4s
  41   1.43457499e+04  1.43715075e+04  1.17e-05 5.84e-07  1.46e-04     4s
  42   1.43516314e+04  1.43691900e+04  6.64e-06 4.68e-07  9.96e-05     4s
  43   1.43529167e+04  1.43664409e+04  5.56e-06 3.30e-07  7.67e-05     4s
  44   1.43544491e+04  1.43630713e+04  4.20e-06 1.70e-07  4.89e-05     4s
  45   1.43577114e+04  1.43625768e+04  1.49e-06 1.45e-07  2.76e-05     5s
  46   1.43587968e+04  1.43602037e+04  5.70e-07 3.20e-08  7.98e-06     5s
  47   1.43592234e+04  1.43599810e+04  2.18e-07 2.22e-08  4.30e-06     5s
  48   1.43593400e+04  1.43598072e+04  1.14e-07 1.46e-08  2.65e-06     5s
  49   1.43594152e+04  1.43595997e+04  5.57e-08 5.19e-09  1.05e-06     5s
  50   1.43594597e+04  1.43594852e+04  6.80e-08 3.06e-08  1.44e-07     5s
  51   1.43594762e+04  1.43594845e+04  5.66e-07 1.15e-08  4.66e-08     5s
  52   1.43594834e+04  1.43594845e+04  9.42e-08 1.63e-09  6.39e-09     5s
  53   1.43594845e+04  1.43594845e+04  8.70e-10 5.37e-11  4.38e-12     5s

Barrier solved model in 53 iterations and 4.98 seconds (10.20 work units)
Optimal objective 1.43594845e+04


Root crossover log...

   68194 DPushes remaining with DInf 0.0000000e+00                 5s
       0 DPushes remaining with DInf 0.0000000e+00                 7s

    4410 PPushes remaining with PInf 5.8242870e-07                 7s
       0 PPushes remaining with PInf 0.0000000e+00                 7s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.5898155e-10      7s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   30987    1.4359485e+04   0.000000e+00   0.000000e+00      7s
   30987    1.4359485e+04   0.000000e+00   0.000000e+00      7s
Concurrent spin time: 1.18s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 1.435948e+04, 30987 iterations, 6.16 seconds (12.58 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 14359.4845    0  613 -190756.93 14359.4845   108%     -    8s
H    0     0                    -184338.3233 14359.4845   108%     -    8s
H    0     0                    -142013.2452 14359.4845   110%     -    9s
H    0     0                    -133408.1935 14359.4845   111%     -    9s
H    0     0                    -128325.3610 14359.4845   111%     -    9s
H    0     0                    -128259.2685 14359.4845   111%     -    9s
H    0     0                    -121962.0688 14359.4845   112%     -    9s
H    0     0                    -121930.9711 14359.4845   112%     -    9s
H    0     0                    -120933.5192 14359.4845   112%     -    9s
H    0     0                    -119747.2922 14359.4845   112%     -    9s
H    0     0                    -119600.7923 14359.4845   112%     -    9s
H    0     0                    -117526.3115 14359.4845   112%     -    9s
H    0     0                    -116546.4023 14359.4845   112%     -    9s
H    0     0                    -106694.8861 14359.4845   113%     -    9s
H    0     0                    -93797.29329 14359.4845   115%     -   12s
H    0     0                    -93116.27741 14359.4845   115%     -   12s
H    0     0                    -90651.91054 14359.4845   116%     -   12s
H    0     0                    -69545.67077 9192.72296   113%     -   51s
H    0     0                    -67330.53680 9192.72296   114%     -   51s
H    0     0                    -66111.45609 9192.72296   114%     -   51s
H    0     0                    -66008.01652 9192.72296   114%     -   51s
H    0     0                    -66003.09427 9192.72296   114%     -   51s
     0     0 9158.84562    0  820 -66003.094 9158.84562   114%     -   51s
H    0     0                    -65770.10960 9158.84562   114%     -   52s
H    0     0                    -65648.34993 9158.84562   114%     -   52s
H    0     0                    -65591.45824 9158.84562   114%     -   52s
H    0     0                    -65586.53598 9158.84562   114%     -   52s
     0     0 8550.06214    0  873 -65586.536 8550.06214   113%     -   66s
     0     0 8279.23961    0  861 -65586.536 8279.23961   113%     -   73s
     0     0 8255.91529    0  876 -65586.536 8255.91529   113%     -   78s
     0     0 8255.91529    0  872 -65586.536 8255.91529   113%     -   79s
     0     0 8255.91529    0  875 -65586.536 8255.91529   113%     -   80s
     0     0 8213.66007    0  875 -65586.536 8213.66007   113%     -   80s
H    0     0                    -61086.73499 5348.68253   109%     -  129s
H    0     0                    -61074.42969 5348.68253   109%     -  129s
H    0     0                    -43527.57932 5348.68253   112%     -  129s
H    0     0                    -42802.90268 5348.68253   112%     -  129s
     0     0 5348.68253    0  667 -42802.903 5348.68253   112%     -  129s
H    0     0                    -33226.82537 5348.62171   116%     -  130s
H    0     0                    -33209.80047 5348.62171   116%     -  130s
H    0     0                    -31638.90351 5348.62171   117%     -  130s
     0     0 4564.28407    0  838 -31638.904 4564.28407   114%     -  165s
     0     0 4250.13155    0  770 -31638.904 4250.13155   113%     -  196s
     0     0 4096.37507    0  745 -31638.904 4096.37507   113%     -  213s
     0     0 4046.15327    0  749 -31638.904 4046.15327   113%     -  221s
     0     0 3949.54147    0  743 -31638.904 3949.54147   112%     -  228s
     0     0 3775.24776    0  757 -31638.904 3775.24776   112%     -  248s
H    0     0                    -31546.86043 3761.25459   112%     -  255s
H    0     0                    -30932.46641 3761.25459   112%     -  255s
H    0     0                    -30164.20327 3761.25459   112%     -  255s
H    0     0                    -29777.57848 3761.25459   113%     -  255s
     0     0 3761.25459    0  776 -29777.578 3761.25459   113%     -  255s
     0     0 3756.52265    0  781 -29777.578 3756.52265   113%     -  259s
     0     0 3749.25889    0  793 -29777.578 3749.25889   113%     -  262s
H    0     0                    -29428.17328 3716.55266   113%     -  271s
H    0     0                    -29408.09206 3716.55266   113%     -  271s
H    0     0                    -29397.64105 3716.55266   113%     -  271s
H    0     0                    -24596.89710 3716.55266   115%     -  271s
H    0     0                    -24173.52764 3716.55266   115%     -  271s
H    0     0                    -24027.59517 3716.55266   115%     -  271s
H    0     0                    -24015.39251 3716.55266   115%     -  271s
     0     0 3716.55266    0  788 -24015.393 3716.55266   115%     -  271s
     0     0 3701.12624    0  776 -24015.393 3701.12624   115%     -  276s
     0     0 3697.05495    0  768 -24015.393 3697.05495   115%     -  280s
     0     0 3693.76466    0  777 -24015.393 3693.76466   115%     -  283s
H    0     0                    -22326.93474 3689.46995   117%     -  285s
H    0     0                    -22309.61236 3689.46995   117%     -  285s
     0     0 3689.46995    0  771 -22309.612 3689.46995   117%     -  285s
     0     0 3687.65535    0  770 -22309.612 3687.65535   117%     -  286s
     0     0 3686.35882    0  770 -22309.612 3686.35882   117%     -  288s
     0     0 1934.14962    0  629 -22309.612 1934.14962   109%     -  373s
H    0     0                    -21936.50177 1934.09854   109%     -  373s
H    0     0                    -20969.81668 1203.07075   106%     -  419s
H    0     0                    -20040.66240 1203.07075   106%     -  419s
H    0     0                    -19947.42621 1203.07075   106%     -  420s
     0     0 1203.07075    0  668 -19947.426 1203.07075   106%     -  420s
     0     0 1046.72001    0  787 -19947.426 1046.72001   105%     -  445s
H    0     0                    -19942.76172  954.20794   105%     -  474s
H    0     0                    -19884.69897  954.20794   105%     -  474s
H    0     0                    -19768.49864  954.20794   105%     -  474s
     0     0  954.20794    0  691 -19768.499  954.20794   105%     -  474s
H    0     0                    -19720.46837  927.60686   105%     -  491s
H    0     0                    -19513.09274  927.60686   105%     -  491s
H    0     0                    -19501.59477  927.60686   105%     -  491s
H    0     0                    -19500.83651  927.60686   105%     -  491s
H    0     0                    -19355.19307  927.60686   105%     -  491s
H    0     0                    -19354.43480  927.60686   105%     -  491s
     0     0  927.60686    0  686 -19354.435  927.60686   105%     -  491s
H    0     0                    -19342.97671  910.97758   105%     -  504s
H    0     0                    -19335.03081  910.97758   105%     -  504s
     0     0  910.97758    0  686 -19335.031  910.97758   105%     -  504s
H    0     0                    -19322.59067  877.51190   105%     -  517s
H    0     0                    -19317.72909  877.51190   105%     -  517s
H    0     0                    -19300.55582  877.51190   105%     -  517s
     0     0  877.51190    0  674 -19300.556  877.51190   105%     -  517s
     0     0  861.25597    0  673 -19300.556  861.25597   104%     -  526s
     0     0  851.97771    0  669 -19300.556  851.97771   104%     -  532s
     0     0  845.06918    0  672 -19300.556  845.06918   104%     -  538s
     0     0  839.56822    0  672 -19300.556  839.56822   104%     -  542s
     0     0  838.84340    0  668 -19300.556  838.84340   104%     -  544s
H    0     0                    -19260.18299  838.84340   104%     -  577s
H    0     0                    -18994.67669  838.84340   104%     -  577s
H    0     0                    -18950.02414  838.84340   104%     -  577s
H    0     0                    -18209.30262  838.84340   105%     -  577s
H    0     0                    -18196.99731  838.84340   105%     -  577s
H    0     0                    -18186.37946    2.19509   100%     -  654s
H    0     0                    -18146.42884    2.19509   100%     -  654s
H    0     0                    -17216.10604    2.19509   100%     -  654s
H    0     0                    -17089.54907    2.19509   100%     -  654s
     0     0    2.19509    0  676 -17089.549    2.19509   100%     -  654s
H    0     0                    -17079.36177    2.07485   100%     -  654s
     0     0 -301.88021    0  703 -17079.362 -301.88021  98.2%     -  703s
     0     0 -372.35145    0  703 -17079.362 -372.35145  97.8%     -  727s
     0     0 -403.83120    0  699 -17079.362 -403.83120  97.6%     -  741s
H    0     0                    -17045.05825 -419.89617  97.5%     -  751s
     0     0 -419.89617    0  696 -17045.058 -419.89617  97.5%     -  751s
     0     0 -445.76619    0  703 -17045.058 -445.76619  97.4%     -  762s
     0     0 -453.74317    0  708 -17045.058 -453.74317  97.3%     -  770s
     0     0 -468.88063    0  694 -17045.058 -468.88063  97.2%     -  780s
     0     0 -477.70019    0  696 -17045.058 -477.70019  97.2%     -  788s
     0     0 -491.34964    0  688 -17045.058 -491.34964  97.1%     -  802s
     0     0 -494.07544    0  691 -17045.058 -494.07544  97.1%     -  807s
H    0     0                    -16574.77861 -853.80938  94.8%     -  854s
H    0     0                    -16567.04258 -853.80938  94.8%     -  854s
H    0     0                    -16544.16359 -853.80938  94.8%     -  854s
H    0     0                    -15869.18929 -853.80938  94.6%     -  854s
     0     0 -853.80938    0  725 -15869.189 -853.80938  94.6%     -  854s
     0     0 -921.95037    0  740 -15869.189 -921.95037  94.2%     -  876s
     0     0 -940.41926    0  757 -15869.189 -940.41926  94.1%     -  890s
     0     0 -949.29384    0  697 -15869.189 -949.29384  94.0%     -  898s
     0     0 -951.47275    0  760 -15869.189 -951.47275  94.0%     -  902s
     0     0 -1070.3740    0  700 -15869.189 -1070.3740  93.3%     -  935s
H    0     0                    -15822.62953 -1070.3824  93.2%     -  939s
H    0     0                    -13628.83229 -1070.3824  92.1%     -  939s
H    0     0                    -11903.69354 -1070.3824  91.0%     -  941s
H    0     0                    -11829.90822 -1070.3824  91.0%     -  941s
H    0     0                    -11803.59925 -1070.3824  90.9%     -  941s
H    0     0                    -11745.00228 -1070.3824  90.9%     -  941s
H    0     0                    -11723.65350 -1070.3824  90.9%     -  941s
     0     0 -1103.2473    0  783 -11723.653 -1103.2473  90.6%     -  959s
     0     0 -1113.3505    0  710 -11723.653 -1113.3505  90.5%     -  970s
     0     0 -1117.3493    0  704 -11723.653 -1117.3493  90.5%     -  976s
     0     0 -1119.3317    0  704 -11723.653 -1119.3317  90.5%     -  980s
     0     0 -1217.2226    0  724 -11723.653 -1217.2226  89.6%     - 1014s
     0     0 -1233.2737    0  720 -11723.653 -1233.2737  89.5%     - 1025s
     0     0 -1240.0814    0  731 -11723.653 -1240.0814  89.4%     - 1033s
     0     0 -1243.5804    0  722 -11723.653 -1243.5804  89.4%     - 1038s
     0     0 -1248.5179    0  729 -11723.653 -1248.5179  89.4%     - 1042s
     0     0 -1249.4753    0  724 -11723.653 -1249.4753  89.3%     - 1044s
     0     0 -1275.7304    0  717 -11723.653 -1275.7304  89.1%     - 1058s
H    0     0                    -11610.14916 -1275.7329  89.0%     - 1059s
     0     0 -1286.7371    0  709 -11610.149 -1286.7371  88.9%     - 1067s
     0     0 -1292.2953    0  736 -11610.149 -1292.2953  88.9%     - 1074s
     0     0 -1294.7496    0  731 -11610.149 -1294.7496  88.8%     - 1078s
     0     0 -1315.5522    0  732 -11610.149 -1315.5522  88.7%     - 1089s
H    0     0                    -11594.24051 -1315.7747  88.7%     - 1090s
     0     0 -1322.6607    0  732 -11594.241 -1322.6607  88.6%     - 1100s
     0     0 -1326.2526    0  731 -11594.241 -1326.2526  88.6%     - 1104s
     0     0 -1328.0941    0  730 -11594.241 -1328.0941  88.5%     - 1108s
     0     0 -1342.5076    0  712 -11594.241 -1342.5076  88.4%     - 1122s
H    0     0                    -11581.47998 -1342.5232  88.4%     - 1123s
     0     0 -1346.7590    0  717 -11581.480 -1346.7590  88.4%     - 1128s
     0     0 -1347.6901    0  715 -11581.480 -1347.6901  88.4%     - 1130s
     0     0 -1366.3864    0  732 -11581.480 -1366.3864  88.2%     - 1140s
     0     0 -1366.4321    0  732 -11581.480 -1366.4321  88.2%     - 1147s
     0     2 -1366.4340    0  732 -11581.480 -1366.4340  88.2%     - 1327s
     1     3 -1926.3562    1  630 -11581.480 -1366.4340  88.2% 12319 1347s
     2     4 -1409.3436    1  730 -11581.480 -1409.3436  87.8%  8045 1357s
     3     6 -2142.0075    2  641 -11581.480 -1409.4398  87.8%  7634 1375s
     5    12 -2599.3878    3  452 -11581.480 -1409.4398  87.8%  9603 1401s
    11    23 -2858.5003    4  362 -11581.480 -1579.1809  86.4% 10242 1482s
    22    34 -3751.1848    5  379 -11581.480 -1637.4846  85.9% 18428 1537s
    33    65 -3266.1304    4  643 -11581.480 -1637.4846  85.9% 16578 1701s
    64    97 -3273.3729    5  643 -11581.480 -1637.4846  85.9% 18876 1792s
    96   210 -3326.9267    6  633 -11581.480 -1637.4846  85.9% 14985 1844s
   209   322 -3449.2891    8  629 -11581.480 -1637.4846  85.9%  9510 1872s
   323   382 -3557.8810   13  644 -11581.480 -1637.4846  85.9%  7714 1894s
   407   406 -3825.2271   14  607 -11581.480 -1637.4846  85.9%  7184 1914s
   462   426 -7160.3807   13  474 -11581.480 -1637.4846  85.9%  7173 1935s
   521   451 -8642.0730   14  461 -11581.480 -1637.4846  85.9%  7245 1955s
   568   485 -7950.1909   14  295 -11581.480 -1637.4846  85.9%  7330 1975s
   628   515 -8461.6980   15  283 -11581.480 -1637.4846  85.9%  7115 1994s
   709   553 -9034.6069   18  268 -11581.480 -1637.4846  85.9%  6948 2011s
   781   582 -9757.1710   22  189 -11581.480 -1637.4846  85.9%  6866 2039s
   822   622 -9813.9067   23  173 -11581.480 -1637.4846  85.9%  6831 2060s
   887   649 -10001.420   24  184 -11581.480 -1637.4846  85.9%  6618 2078s
   958   703 -10014.186   25  193 -11581.480 -1637.4846  85.9%  6431 2109s
  1048   753 -10099.876   27  185 -11581.480 -1637.4846  85.9%  6174 2128s
  1164   809 -10479.802   31  179 -11581.480 -1637.4846  85.9%  5919 2148s
  1274   866 -11031.980   39  159 -11581.480 -1637.4846  85.9%  5723 2167s
  1407   923 -11273.987   44  155 -11581.480 -1637.4846  85.9%  5493 2188s
  1542   963 infeasible   19      -11581.480 -1637.4846  85.9%  5325 2209s
  1672  1021 -10140.302   37   64 -11581.480 -1637.4846  85.9%  5140 2229s
  1813  1085 -10394.221   45   63 -11581.480 -1637.4846  85.9%  4959 2253s
  1966  1099 infeasible   52      -11581.480 -1637.4846  85.9%  4747 2277s
  2064  1136 -4982.9527    9  486 -11581.480 -1637.4846  85.9%  4768 2303s
  2146  1183 -5012.2109   10  514 -11581.480 -1637.4846  85.9%  4847 2325s
  2225  1222 -6323.0580   11  454 -11581.480 -1637.4846  85.9%  4946 2350s
  2362  1277 -7969.3612   13  507 -11581.480 -1637.4846  85.9%  4969 2379s
  2477  1314 infeasible   14      -11581.480 -1637.4846  85.9%  5015 2407s
  2592  1357 -7921.8169   14  410 -11581.480 -1637.4846  85.9%  5056 2446s
  2752  1413 infeasible   18      -11581.480 -1637.4846  85.9%  5024 2477s
  2864  1481     cutoff   28      -11581.480 -1637.4846  85.9%  5079 2510s
  2988  1528 -7631.7411   21  268 -11581.480 -1637.4846  85.9%  5123 2542s
  3135  1599 infeasible   26      -11581.480 -1637.4846  85.9%  5157 2579s
  3296  1683 infeasible   11      -11581.480 -1637.4846  85.9%  5171 2613s
  3417  1781 infeasible   23      -11581.480 -1637.4846  85.9%  5295 2647s
  3599  1799 infeasible   30      -11581.480 -1714.5321  85.2%  5357 2699s
  3653  1834 -1895.0932    5  679 -11581.480 -1715.2225  85.2%  5416 2809s
  3726  1855 infeasible   13      -11581.480 -1715.2225  85.2%  5476 2868s
  3823  1889 -1943.5687    6  597 -11581.480 -1715.2225  85.2%  5542 2908s
  3959  1946 -2231.1621    7  573 -11581.480 -1715.2225  85.2%  5596 2948s
  4097  2004 -2538.0543    8  497 -11581.480 -1715.2225  85.2%  5681 2995s
  4255  2087 -2783.4842    9  550 -11581.480 -1715.2225  85.2%  5725 3037s
  4453  2125 -3984.0195   10  418 -11581.480 -1715.2225  85.2%  5731 3082s
  4625  2135 -4077.8361   11  415 -11581.480 -1715.2225  85.2%  5782 3168s
  4679  2160 -4535.0944   12  326 -11581.480 -1715.2225  85.2%  5828 3263s
  4754  2195 -5122.1096   13  453 -11581.480 -1943.8451  83.2%  5889 3337s
  4861  2229 -6750.7899   14  436 -11581.480 -1943.8451  83.2%  5947 3391s
  4965  2308 -8164.7963   15  190 -11581.480 -2544.4472  78.0%  6000 3443s

Cutting planes:
  Learned: 2
  Gomory: 3
  Implied bound: 188
  MIR: 4660
  Flow cover: 4172
  Inf proof: 1
  Zero half: 8
  RLT: 284
  Relax-and-lift: 1529

Explored 5106 nodes (31742207 simplex iterations) in 3600.06 seconds (8690.43 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -11581.5 -11594.2 -11610.1 ... -15822.6

Time limit reached
Best objective -1.158147997846e+04, best bound -2.783486002338e+03, gap 75.9661%
  WARNING: Time limit reached. Using best solution found (gap: 75.97%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.11s
  Master Objective (UB) = -11581.48, θ = 116580.31
  Upper Bound (UB) = -11581.48

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 116580.31
  [DEBUG]   ✓ Scenario 0: θ = 116580.31 ≤ Q = 116580.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 116580.31 ≤ Q = 116580.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 116580.31 ≤ Q = 116580.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 116580.31 ≤ Q = 116580.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 116580.31 ≤ Q = 116580.31 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 116580.31 ≤ Q = 116580.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 116580.31 ≤ Q = 116580.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 116580.31 ≤ Q = 116580.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 116580.31 ≤ Q = 116580.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 116580.31 ≤ Q = 116580.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 116580.31 ≤ Q = 116580.31 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 11] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0xd57d82
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x00d57d82
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.330069e+13
Presolve removed 2577 rows and 1870 columns
Presolve time: 0.00s
Presolved: 516 rows, 519 columns, 1455 nonzeros
Found heuristic solution: objective 7014840.7473
Variable types: 351 continuous, 168 integer (168 binary)

Root relaxation: objective -1.202055e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -120205.46    0  122 7014840.75 -120205.46   102%     -    0s
H    0     0                    -85677.95626 -120205.46  40.3%     -    0s
H    0     0                    -86207.31025 -120205.46  39.4%     -    0s
     0     0 -89796.024    0   39 -86207.310 -89796.024  4.16%     -    0s
H    0     0                    -88566.93957 -89754.638  1.34%     -    0s
H    0     0                    -88578.88845 -89754.638  1.33%     -    0s
H    0     0                    -88835.15594 -89754.638  1.04%     -    0s
H    0     0                    -88847.10481 -89754.638  1.02%     -    0s
     0     0 -89570.537    0   40 -88847.105 -89570.537  0.81%     -    0s
     0     0 -89490.601    0   41 -88847.105 -89490.601  0.72%     -    0s
H    0     0                    -89130.22755 -89490.601  0.40%     -    0s
     0     0 -89467.118    0   41 -89130.228 -89467.118  0.38%     -    0s
     0     0 -89467.118    0   61 -89130.228 -89467.118  0.38%     -    0s
     0     0 -89467.118    0   38 -89130.228 -89467.118  0.38%     -    0s
     0     0 -89467.118    0   40 -89130.228 -89467.118  0.38%     -    0s
     0     0 -89467.118    0   40 -89130.228 -89467.118  0.38%     -    0s
H    0     0                    -89193.78104 -89454.618  0.29%     -    0s
     0     0 -89454.618    0   38 -89193.781 -89454.618  0.29%     -    0s
     0     0 -89431.814    0   39 -89193.781 -89431.814  0.27%     -    0s
     0     0 -89429.409    0   39 -89193.781 -89429.409  0.26%     -    0s
     0     2 -89429.409    0   39 -89193.781 -89429.409  0.26%     -    0s
*   84    13              17    -89207.61663 -89276.644  0.08%   3.7    0s
*   98    13              16    -89212.89774 -89264.334  0.06%   3.5    0s
*  109     9              19    -89215.01610 -89263.493  0.05%   3.3    0s
*  113     9              18    -89220.29721 -89263.493  0.05%   3.3    0s
*  134     0              21    -89231.01831 -89258.534  0.03%   3.2    0s

Cutting planes:
  Gomory: 10
  Implied bound: 6
  MIR: 83
  Flow cover: 4
  RLT: 3

Explored 144 nodes (1260 simplex iterations) in 0.11 seconds (0.08 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -89231 -89220.3 -89215 ... -85678
No other solutions better than -89231

Optimal solution found (tolerance 1.00e-04)
Best objective -8.923101831238e+04, best bound -8.923101831238e+04, gap 0.0000%
  Subproblem solved in 0.12s
  Worst-case operational profit (Z_SP) = 116190.70
  Scenario: 9 demand increases, 51 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -89231.02
  [DEBUG]   S×d_nominal = 205421.71
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 205421.71 + -89231.02 = 116190.70
  [DEBUG]   Current θ from Master = 116580.31
  [DEBUG]   ⚠️  Z_SP ≤ θ by 389.61 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -11971.09
  Lower Bound (LB) = -11971.09
  Gap (UB-LB) = 389.6103, Absolute Gap = 389.6103, Relative Gap = 0.033641
  Not converged yet (gap = 389.61 > ε = 200)

  [DEBUG] Adding NEW scenario 11 to Master Problem...
  [DEBUG] New scenario pattern: 9 increases, 51 decreases
    [DEBUG] Scenario 11 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 11 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 11]
    [DEBUG]   - Total constraints in model: 184863
    [DEBUG]   - Total variables in model: 77140
  [DEBUG] Total scenarios in Master: 12
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 12
================================================================================
[Iteration 12] Solving Master Problem...
  Current scenarios in Master: 12
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 184863 rows, 77140 columns and 524435 nonzeros
Model fingerprint: 0xc3acb41b
Variable types: 74881 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 80132 rows and 32542 columns
Presolve time: 1.51s
Presolved: 104731 rows, 44598 columns, 632459 nonzeros
Variable types: 42339 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -384568.2121
Found heuristic solution: objective -190756.9345

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.20s

Barrier statistics:
 Dense cols : 650
 AA' NZ     : 3.614e+06
 Factor NZ  : 8.663e+06 (roughly 130 MB of memory)
 Factor Ops : 1.650e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.66498488e+07  1.72543334e+08  8.70e+04 1.97e+01  6.86e+04     3s
   1  -1.25426208e+07  1.49805830e+08  5.98e+04 5.77e+01  4.67e+04     3s
   2  -4.16265494e+06  1.19078256e+08  1.93e+04 2.05e+00  1.60e+04     3s
   3  -9.55131013e+05  9.10385348e+07  2.41e+03 1.93e-01  2.35e+03     3s
   4  -4.81371461e+05  3.67633637e+07  3.19e+02 5.34e-01  4.14e+02     3s
   5  -4.00382323e+05  2.45708081e+07  1.66e+02 1.97e-01  2.35e+02     3s
   6  -2.76706525e+05  1.70998240e+07  4.51e+01 1.57e-02  1.16e+02     3s
   7  -1.71712401e+05  1.27621727e+07  9.81e+00 1.12e-02  7.21e+01     3s
   8  -1.10874393e+05  6.50925285e+06  4.80e+00 5.34e-03  3.58e+01     3s
   9  -8.30017774e+04  3.66010652e+06  2.96e+00 2.94e-03  2.00e+01     3s
  10  -6.53545832e+04  1.73157928e+06  2.01e+00 1.33e-03  9.54e+00     3s
  11  -3.26042292e+04  4.52493579e+05  9.05e-01 3.54e-04  2.55e+00     3s
  12  -2.04301686e+04  1.69483439e+05  5.02e-01 1.31e-04  9.96e-01     3s
  13  -1.26372003e+04  1.05794116e+05  3.26e-01 1.47e-04  6.20e-01     3s
  14  -9.31562376e+03  7.70696585e+04  2.67e-01 1.74e-04  4.52e-01     3s
  15  -4.49858699e+03  6.27830944e+04  2.03e-01 6.16e-04  3.52e-01     3s
  16  -1.11453699e+03  4.40612640e+04  1.65e-01 9.25e-04  2.36e-01     3s
  17   2.82720895e+03  3.38943214e+04  1.22e-01 1.65e-03  1.62e-01     3s
  18   3.64834173e+03  2.73865039e+04  1.13e-01 1.18e-03  1.24e-01     3s
  19   5.23986213e+03  2.47497515e+04  9.58e-02 1.55e-03  1.02e-01     3s
  20   7.67513005e+03  2.20060442e+04  7.08e-02 1.20e-03  7.50e-02     3s
  21   8.93528747e+03  1.94388685e+04  5.80e-02 9.42e-04  5.49e-02     3s
  22   1.00168901e+04  1.82906521e+04  4.73e-02 8.70e-04  4.33e-02     4s
  23   1.07223993e+04  1.74491259e+04  4.00e-02 1.05e-03  3.52e-02     4s
  24   1.11572656e+04  1.65068006e+04  3.55e-02 8.27e-04  2.80e-02     4s
  25   1.15220161e+04  1.61257376e+04  3.18e-02 6.67e-04  2.41e-02     4s
  26   1.24523149e+04  1.59752742e+04  2.26e-02 5.59e-04  1.84e-02     4s
  27   1.27372331e+04  1.56789473e+04  1.98e-02 9.54e-04  1.54e-02     4s
  28   1.33044672e+04  1.54694424e+04  1.43e-02 1.16e-03  1.13e-02     4s
  29   1.36120146e+04  1.53047573e+04  1.14e-02 8.51e-04  8.86e-03     4s
  30   1.38625465e+04  1.51391353e+04  8.96e-03 5.55e-04  6.68e-03     4s
  31   1.40765947e+04  1.50733527e+04  6.94e-03 3.52e-04  5.22e-03     4s
  32   1.41580539e+04  1.50174280e+04  6.18e-03 2.51e-04  4.50e-03     4s
  33   1.43019217e+04  1.49639181e+04  4.83e-03 2.06e-04  3.46e-03     4s
  34   1.43975826e+04  1.49157614e+04  3.91e-03 1.84e-04  2.71e-03     4s
  35   1.45330008e+04  1.48961686e+04  2.67e-03 1.43e-04  1.90e-03     4s
  36   1.45983739e+04  1.48816055e+04  2.07e-03 1.36e-04  1.48e-03     4s
  37   1.46140302e+04  1.48701073e+04  1.93e-03 8.51e-05  1.34e-03     4s
  38   1.46855423e+04  1.48563459e+04  1.28e-03 5.51e-05  8.94e-04     4s
  39   1.47432984e+04  1.48464389e+04  7.39e-04 3.49e-05  5.40e-04     4s
  40   1.47934326e+04  1.48296015e+04  2.93e-04 1.01e-05  1.89e-04     4s
  41   1.48168910e+04  1.48278420e+04  8.32e-05 8.61e-06  5.73e-05     4s
  42   1.48230635e+04  1.48266807e+04  2.97e-05 4.54e-06  1.89e-05     4s
  43   1.48264674e+04  1.48265044e+04  3.09e-07 9.51e-07  1.93e-07     4s
  44   1.48265033e+04  1.48265033e+04  3.31e-10 1.31e-10  3.60e-11     4s

Barrier solved model in 44 iterations and 4.43 seconds (8.03 work units)
Optimal objective 1.48265033e+04


Root crossover log...

       0 DPushes remaining with DInf 0.0000000e+00                 6s

    5078 PPushes remaining with PInf 5.1172117e-06                 6s
       0 PPushes remaining with PInf 0.0000000e+00                 6s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.3195671e+00      6s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   34348    1.4826503e+04   0.000000e+00   1.319567e+00      6s
   34353    1.4826503e+04   0.000000e+00   0.000000e+00      6s
   34353    1.4826503e+04   0.000000e+00   0.000000e+00      6s
Concurrent spin time: 0.16s

Solved with barrier

Root relaxation: objective 1.482650e+04, 34353 iterations, 4.53 seconds (10.19 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 14826.5033    0  599 -190756.93 14826.5033   108%     -    7s
H    0     0                    -184317.8478 14826.5033   108%     -    7s
H    0     0                    -170331.1063 14826.5033   109%     -    7s
H    0     0                    -170076.6592 14826.5033   109%     -    7s
H    0     0                    -151669.6157 14826.5033   110%     -    7s
H    0     0                    -151601.7121 14826.5033   110%     -    7s
H    0     0                    -120219.5767 14826.5033   112%     -    7s
H    0     0                    -113389.7287 14826.5033   113%     -    7s
H    0     0                    -111331.9807 14826.5033   113%     -    7s
H    0     0                    -89379.34425 14826.5033   117%     -    7s
H    0     0                    -89205.76680 14826.5033   117%     -    7s
H    0     0                    -65773.82038 14826.5033   123%     -    8s
     0     0 10258.8660    0  828 -65773.820 10258.8660   116%     -   44s
H    0     0                    -56171.55158 10258.7407   118%     -   45s
H    0     0                    -55910.22802 10258.7407   118%     -   45s
H    0     0                    -54133.57864 10258.7407   119%     -   45s
H    0     0                    -54023.69782 10258.7407   119%     -   45s
H    0     0                    -53103.50625 10258.7407   119%     -   45s
H    0     0                    -52967.49011 10258.7407   119%     -   45s
H    0     0                    -52924.29105 10258.7407   119%     -   45s
H    0     0                    -52126.26343 10258.7407   120%     -   45s
H    0     0                    -52086.30405 10258.7407   120%     -   45s
H    0     0                    -52075.53731 10258.7407   120%     -   45s
H    0     0                    -51949.84921 9589.11701   118%     -   64s
H    0     0                    -51891.16968 9589.11701   118%     -   64s
H    0     0                    -51861.85822 9589.11701   118%     -   64s
H    0     0                    -51787.79248 9589.11701   119%     -   64s
H    0     0                    -51729.11296 9589.11701   119%     -   64s
     0     0 9589.11701    0  829 -51729.113 9589.11701   119%     -   64s
     0     0 9513.60864    0  887 -51729.113 9513.60864   118%     -   72s
     0     0 9438.09597    0  884 -51729.113 9438.09597   118%     -   78s
     0     0 9432.69724    0  896 -51729.113 9432.69724   118%     -   81s
     0     0 9415.59274    0  885 -51729.113 9415.59274   118%     -   84s
     0     0 9414.73394    0  892 -51729.113 9414.73394   118%     -   86s
     0     0 9414.62677    0  891 -51729.113 9414.62677   118%     -   86s
H    0     0                    -46522.47803 6605.96955   114%     -  143s
H    0     0                    -45985.42917 6605.96955   114%     -  143s
H    0     0                    -45531.61762 6605.96955   115%     -  143s
     0     0 6605.96955    0  855 -45531.618 6605.96955   115%     -  143s
H    0     0                    -34841.07376 6605.18713   119%     -  144s
H    0     0                    -34258.05492 6605.18713   119%     -  144s
H    0     0                    -34195.59873 6605.18713   119%     -  144s
H    0     0                    -34040.45852 6605.18713   119%     -  144s
H    0     0                    -34010.69600 6605.18713   119%     -  144s
H    0     0                    -33709.59527 5144.54562   115%     -  194s
H    0     0                    -33029.32813 5144.54562   116%     -  194s
H    0     0                    -32588.41516 5144.54562   116%     -  194s
H    0     0                    -32565.51515 5144.54562   116%     -  194s
     0     0 5144.54562    0  812 -32565.515 5144.54562   116%     -  195s
H    0     0                    -18417.44370 4941.91654   127%     -  217s
H    0     0                    -18232.95006 4941.91654   127%     -  217s
H    0     0                    -18231.68962 4941.91654   127%     -  217s
H    0     0                    -18231.53703 4941.91654   127%     -  217s
H    0     0                    -18230.27659 4941.91654   127%     -  217s
H    0     0                    -18224.92453 4941.91654   127%     -  217s
H    0     0                    -18223.51150 4941.91654   127%     -  217s
     0     0 4941.91654    0  807 -18223.512 4941.91654   127%     -  217s
H    0     0                    -17551.97569 4862.67223   128%     -  237s
H    0     0                    -17360.00452 4862.67223   128%     -  237s
H    0     0                    -16904.75269 4862.67223   129%     -  237s
H    0     0                    -16902.11714 4862.67223   129%     -  237s
     0     0 4862.67223    0  808 -16902.117 4862.67223   129%     -  237s
     0     0 4788.61012    0  788 -16902.117 4788.61012   128%     -  259s
     0     0 4750.07571    0  791 -16902.117 4750.07571   128%     -  277s
     0     0 4731.21658    0  790 -16902.117 4731.21658   128%     -  287s
     0     0 4710.54621    0  799 -16902.117 4710.54621   128%     -  294s
     0     0 4701.56967    0  799 -16902.117 4701.56967   128%     -  299s
     0     0 4699.45297    0  791 -16902.117 4699.45297   128%     -  302s
     0     0 4654.62640    0  788 -16902.117 4654.62640   128%     -  314s
     0     0 4579.30497    0  765 -16902.117 4579.30497   127%     -  331s
     0     0 4514.64357    0  782 -16902.117 4514.64357   127%     -  348s
     0     0 4486.33111    0  763 -16902.117 4486.33111   127%     -  358s
     0     0 4482.71972    0  768 -16902.117 4482.71972   127%     -  362s
     0     0 4482.15544    0  781 -16902.117 4482.15544   127%     -  363s
H    0     0                    -16315.97338 1522.58941   109%     -  473s
H    0     0                    -16314.56035 1522.58941   109%     -  473s
     0     0 1522.58941    0  667 -16314.560 1522.58941   109%     -  473s
     0     0  951.59926    0  705 -16314.560  951.59926   106%     -  529s
     0     0  750.13768    0  856 -16314.560  750.13768   105%     -  569s
     0     0  578.10308    0  762 -16314.560  578.10308   104%     -  594s
     0     0  526.12330    0  751 -16314.560  526.12330   103%     -  611s
     0     0  507.85686    0  741 -16314.560  507.85686   103%     -  621s
     0     0  499.74565    0  744 -16314.560  499.74565   103%     -  629s
H    0     0                    -16258.40724  485.60617   103%     -  641s
H    0     0                    -16086.55638  485.60617   103%     -  641s
     0     0  485.60617    0  763 -16086.556  485.60617   103%     -  641s
     0     0  471.95568    0  773 -16086.556  471.95568   103%     -  650s
     0     0  445.98126    0  697 -16086.556  445.98126   103%     -  660s
H    0     0                    -14697.99036  424.75239   103%     -  670s
H    0     0                    -14573.53490  424.75239   103%     -  670s
     0     0  424.75239    0  706 -14573.535  424.75239   103%     -  670s
     0     0  421.20795    0  699 -14573.535  421.20795   103%     -  675s
     0     0  415.12368    0  708 -14573.535  415.12368   103%     -  679s
H    0     0                    -14211.21061  401.05514   103%     -  686s
     0     0  401.05514    0  684 -14211.211  401.05514   103%     -  686s
     0     0  399.73924    0  693 -14211.211  399.73924   103%     -  688s
     0     0 -563.58841    0  750 -14211.211 -563.58841  96.0%     -  786s
H    0     0                    -13982.66655 -563.65188  96.0%     -  786s
     0     0 -835.86254    0  672 -13982.667 -835.86254  94.0%     -  827s
     0     0 -973.31262    0  740 -13982.667 -973.31262  93.0%     -  868s
     0     0 -1007.4120    0  687 -13982.667 -1007.4120  92.8%     -  886s
     0     0 -1044.6027    0  686 -13982.667 -1044.6027  92.5%     -  905s
     0     0 -1072.0528    0  695 -13982.667 -1072.0528  92.3%     -  919s
     0     0 -1085.9926    0  695 -13982.667 -1085.9926  92.2%     -  928s
     0     0 -1105.6271    0  692 -13982.667 -1105.6271  92.1%     -  940s
     0     0 -1107.9181    0  775 -13982.667 -1107.9181  92.1%     -  945s
     0     0 -1412.4934    0  671 -13982.667 -1412.4934  89.9%     -  987s
H    0     0                    -13384.98880 -1412.6845  89.4%     -  987s
     0     0 -1503.2582    0  685 -13384.989 -1503.2582  88.8%     - 1008s
     0     0 -1530.1404    0  697 -13384.989 -1530.1404  88.6%     - 1019s
     0     0 -1540.3758    0  746 -13384.989 -1540.3758  88.5%     - 1026s
     0     0 -1545.2364    0  692 -13384.989 -1545.2364  88.5%     - 1030s
     0     0 -1549.0485    0  756 -13384.989 -1549.0485  88.4%     - 1037s
     0     0 -1553.9357    0  752 -13384.989 -1553.9357  88.4%     - 1040s
     0     0 -1554.2381    0  754 -13384.989 -1554.2381  88.4%     - 1042s
     0     0 -1665.5121    0  680 -13384.989 -1665.5121  87.6%     - 1068s
H    0     0                    -13128.92377 -1665.5997  87.3%     - 1072s
H    0     0                    -12891.42396 -1665.5997  87.1%     - 1073s
H    0     0                    -12317.10488 -1665.5997  86.5%     - 1073s
H    0     0                    -12309.15140 -1665.5997  86.5%     - 1078s
     0     0 -1695.3436    0  696 -12309.151 -1695.3436  86.2%     - 1094s
     0     0 -1710.3484    0  714 -12309.151 -1710.3484  86.1%     - 1103s
     0     0 -1712.7897    0  711 -12309.151 -1712.7897  86.1%     - 1107s
     0     0 -1763.1460    0  766 -12309.151 -1763.1460  85.7%     - 1126s
     0     0 -1775.8310    0  769 -12309.151 -1775.8310  85.6%     - 1137s
     0     0 -1778.4377    0  710 -12309.151 -1778.4377  85.6%     - 1142s
     0     0 -1802.3381    0  713 -12309.151 -1802.3381  85.4%     - 1156s
     0     0 -1805.4098    0  723 -12309.151 -1805.4098  85.3%     - 1162s
     0     0 -1822.5646    0  787 -12309.151 -1822.5646  85.2%     - 1175s
     0     0 -1825.1166    0  727 -12309.151 -1825.1166  85.2%     - 1180s
     0     0 -1869.3504    0  703 -12309.151 -1869.3504  84.8%     - 1201s
     0     0 -1881.7785    0  713 -12309.151 -1881.7785  84.7%     - 1211s
     0     0 -1886.1334    0  783 -12309.151 -1886.1334  84.7%     - 1217s
     0     0 -1887.6113    0  780 -12309.151 -1887.6113  84.7%     - 1220s
     0     0 -1909.8452    0  719 -12309.151 -1909.8452  84.5%     - 1235s
     0     0 -1913.5488    0  711 -12309.151 -1913.5488  84.5%     - 1240s
     0     0 -1915.5011    0  713 -12309.151 -1915.5011  84.4%     - 1244s
     0     0 -1927.8117    0  704 -12309.151 -1927.8117  84.3%     - 1254s
H    0     0                    -11960.94173 -1928.2155  83.9%     - 1310s
H    0     0                    -11945.03308 -1928.2155  83.9%     - 1319s
H    0     0                    -11934.20389 -1928.2155  83.8%     - 1319s
H    0     0                    -11865.40972 -1928.2155  83.7%     - 1322s
     0     0 -1930.8358    0  714 -11865.410 -1930.8358  83.7%     - 1329s
     0     0 -1943.6000    0  720 -11865.410 -1943.6000  83.6%     - 1340s
     0     0 -1943.6437    0  720 -11865.410 -1943.6437  83.6%     - 1348s
H    0     0                    -11864.63816 -1943.6615  83.6%     - 1570s
H    0     0                    -11858.71340 -1943.6615  83.6%     - 1570s
H    0     0                    -11841.94810 -1943.6615  83.6%     - 1570s
H    0     0                    -11732.72855 -1943.6615  83.4%     - 1570s
     0     2 -1943.6615    0  720 -11732.729 -1943.6615  83.4%     - 1573s
     1     3 -2373.9940    1  660 -11732.729 -1943.6615  83.4% 15136 1598s
     2     4 -2000.8459    1  695 -11732.729 -2000.8459  82.9%  9086 1612s
     3     7 -2657.7079    2  676 -11732.729 -2001.0020  82.9%  7910 1641s
     6    13 -2749.0127    3  669 -11732.729 -2001.0980  82.9%  9780 1666s
    12    24 -2813.5684    4  670 -11732.729 -2114.0485  82.0% 10345 1704s
    23    35 -3619.7135    5  593 -11732.729 -2119.6969  81.9% 17967 1782s
    34    65 -3328.7956    5  581 -11732.729 -2134.6492  81.8% 16116 2218s
H   36    65                    -11708.14501 -2134.6492  81.8% 15604 2218s
    64    96 -3371.6928    6  574 -11708.145 -2134.6492  81.8% 21634 2330s
H   72    96                    -11704.85571 -2134.6492  81.8% 20409 2330s
H   82    96                    -11692.22768 -2134.6492  81.7% 19623 2330s
H   95   168                    -11678.38233 -2134.6492  81.7% 18466 2393s
H  103   168                    -11668.71266 -2134.6492  81.7% 17629 2393s
H  139   168                    -11655.06686 -2134.6492  81.7% 14376 2393s
   167   293 -3430.6248    8  578 -11655.067 -2134.6492  81.7% 13136 2443s
   292   379 -3692.5734   13  551 -11655.067 -2134.6492  81.7%  9933 2476s
   378   436 -3733.2234   15  592 -11655.067 -2134.6492  81.7%  9081 2502s
   450   485 -8298.1339   16  145 -11655.067 -2134.6492  81.7%  8782 2526s
   524   529 -10162.877   15  207 -11655.067 -2134.6492  81.7%  8306 2550s
   590   562     cutoff   16      -11655.067 -2134.6492  81.7%  8073 2572s
   655   597     cutoff   17      -11655.067 -2134.6492  81.7%  8102 2595s
   716   610 -7718.4089   14  204 -11655.067 -2134.6492  81.7%  8005 2616s
   787   623 -9345.1389   15  162 -11655.067 -2134.6492  81.7%  7956 2636s
   854   649 infeasible   17      -11655.067 -2134.6492  81.7%  7846 2658s
   967   673 -10608.883   17  155 -11655.067 -2134.6492  81.7%  7376 2679s
  1100   700 infeasible   17      -11655.067 -2134.6492  81.7%  6815 2701s
  1219   791 infeasible   19      -11655.067 -2134.6492  81.7%  6305 2723s
  1384   757 -11340.382   47   25 -11655.067 -2134.6492  81.7%  5747 2746s
  1513   770 -5992.4090   13  325 -11655.067 -2134.6492  81.7%  5442 2772s
  1534   790 -6269.6790   14  315 -11655.067 -2134.6492  81.7%  5569 2796s
  1572   804 -8224.0403   11  223 -11655.067 -2134.6492  81.7%  5667 2832s
  1629   815 infeasible    9      -11655.067 -2134.6492  81.7%  5686 2857s
  1721   843 -6951.0429    8  214 -11655.067 -2134.6492  81.7%  5569 2904s
  1810   852 -7778.8284    9  149 -11655.067 -2134.6492  81.7%  5597 2939s
  1905   859 -10265.567    9  155 -11655.067 -2134.6492  81.7%  5597 2969s
  1948   876     cutoff   10      -11655.067 -2134.6492  81.7%  5662 3000s
  2019   903 -6577.6446   13  655 -11655.067 -2134.6492  81.7%  5703 3029s
  2086   930 -7477.1366    9  348 -11655.067 -2134.6492  81.7%  5804 3061s
  2177   966     cutoff   10      -11655.067 -2134.6492  81.7%  5834 3095s
  2255   984 -10422.537   13  232 -11655.067 -2134.6492  81.7%  5933 3143s
  2295  1012     cutoff   14      -11655.067 -2134.6492  81.7%  6012 3204s
  2337  1046 -11123.114   17  105 -11655.067 -2134.6492  81.7%  6094 3235s
  2385  1075 -11413.593   18   77 -11655.067 -2134.6492  81.7%  6151 3267s
  2462  1120 -11642.326   19   46 -11655.067 -2134.6492  81.7%  6160 3301s
  2549  1154     cutoff   20      -11655.067 -2134.6492  81.7%  6199 3335s
  2671  1196 -11508.693   19   81 -11655.067 -2134.6492  81.7%  6144 3379s
  2840  1226     cutoff   20      -11655.067 -2134.6492  81.7%  6072 3422s
  2956  1276 infeasible   23      -11655.067 -2272.9307  80.5%  6105 3467s
  3019  1334 -2417.1660    6  675 -11655.067 -2273.0245  80.5%  6203 3508s
  3109  1351 -2527.7247    7  664 -11655.067 -2273.0245  80.5%  6185 3559s
  3199  1361     cutoff   33      -11655.067 -2273.0245  80.5%  6194 3600s

Cutting planes:
  Learned: 7
  Gomory: 2
  Implied bound: 175
  MIR: 5240
  Flow cover: 4062
  Zero half: 14
  RLT: 319
  Relax-and-lift: 1535

Explored 3305 nodes (21489304 simplex iterations) in 3600.05 seconds (8676.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -11655.1 -11668.7 -11678.4 ... -11864.6

Time limit reached
Best objective -1.165506685593e+04, best bound -2.273024538568e+03, gap 80.4975%
  WARNING: Time limit reached. Using best solution found (gap: 80.50%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = -11655.07, θ = 118406.61
  Upper Bound (UB) = -11655.07

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 118406.61
  [DEBUG]   ✓ Scenario 0: θ = 118406.61 ≤ Q = 118406.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 118406.61 ≤ Q = 118406.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 118406.61 ≤ Q = 118406.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 118406.61 ≤ Q = 118406.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 118406.61 ≤ Q = 118406.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 118406.61 ≤ Q = 118406.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 118406.61 ≤ Q = 118406.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 118406.61 ≤ Q = 118406.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 118406.61 ≤ Q = 118406.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 118406.61 ≤ Q = 118406.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 118406.61 ≤ Q = 118406.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 118406.61 ≤ Q = 118406.61 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 12] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x22a40f82
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xdd5bf07e
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [8e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [3e-01, 2e+02]
Found heuristic solution: objective 1.239529e+13
Presolve removed 2577 rows and 1870 columns
Presolve time: 0.00s
Presolved: 516 rows, 519 columns, 1455 nonzeros
Found heuristic solution: objective 6656583.6434
Variable types: 351 continuous, 168 integer (168 binary)

Root relaxation: objective -1.156667e+05, 248 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -115666.72    0  121 6656583.64 -115666.72   102%     -    0s
H    0     0                    -81229.66481 -115666.72  42.4%     -    0s
H    0     0                    -81720.32746 -115666.72  41.5%     -    0s
     0     0 -88934.551    0   42 -81720.327 -88934.551  8.83%     -    0s
H    0     0                    -87993.04062 -88893.315  1.02%     -    0s
     0     0 -88692.335    0   18 -87993.041 -88692.335  0.79%     -    0s
     0     0 -88593.913    0   13 -87993.041 -88593.913  0.68%     -    0s
H    0     0                    -88396.72469 -88593.913  0.22%     -    0s
H    0     0                    -88419.74277 -88535.890  0.13%     -    0s
     0     0 -88535.890    0   16 -88419.743 -88535.890  0.13%     -    0s
     0     0 -88531.711    0   11 -88419.743 -88531.711  0.13%     -    0s
     0     0 -88528.023    0   11 -88419.743 -88528.023  0.12%     -    0s
     0     0 -88462.720    0   10 -88419.743 -88462.720  0.05%     -    0s
     0     0 -88441.177    0    8 -88419.743 -88441.177  0.02%     -    0s
     0     0 -88435.619    0    7 -88419.743 -88435.619  0.02%     -    0s
     0     0 -88431.632    0    7 -88419.743 -88431.632  0.01%     -    0s
     0     0 -88429.947    0    6 -88419.743 -88429.947  0.01%     -    0s

Cutting planes:
  MIR: 2
  Flow cover: 1
  Relax-and-lift: 1

Explored 1 nodes (544 simplex iterations) in 0.04 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 7: -88419.7 -88396.7 -87993 ... 1.23953e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -8.841974277074e+04, best bound -8.842429575314e+04, gap 0.0051%
  Subproblem solved in 0.06s
  Worst-case operational profit (Z_SP) = 114578.44
  Scenario: 9 demand increases, 51 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -88419.74
  [DEBUG]   S×d_nominal = 202998.19
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 202998.19 + -88419.74 = 114578.44
  [DEBUG]   Current θ from Master = 118406.61
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3828.17 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -15483.23
  Lower Bound (LB) = -11971.09
  Gap (UB-LB) = 316.0234, Absolute Gap = 316.0234, Relative Gap = 0.027115
  Not converged yet (gap = 316.02 > ε = 200)

  [DEBUG] Adding NEW scenario 12 to Master Problem...
  [DEBUG] New scenario pattern: 9 increases, 51 decreases
    [DEBUG] Scenario 12 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 12 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 12]
    [DEBUG]   - Total constraints in model: 200153
    [DEBUG]   - Total variables in model: 83380
  [DEBUG] Total scenarios in Master: 13
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 13
================================================================================
[Iteration 13] Solving Master Problem...
  Current scenarios in Master: 13
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 200153 rows, 83380 columns and 567678 nonzeros
Model fingerprint: 0x3d32e33f
Variable types: 81121 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 86818 rows and 35258 columns
Presolve time: 1.66s
Presolved: 113335 rows, 48122 columns, 683535 nonzeros
Variable types: 45863 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -384568.2121
Found heuristic solution: objective -190756.9345

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.25s

Barrier statistics:
 Dense cols : 642
 AA' NZ     : 4.171e+06
 Factor NZ  : 1.078e+07 (roughly 150 MB of memory)
 Factor Ops : 3.224e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.66857581e+07  1.84481534e+08  8.71e+04 1.86e+01  6.83e+04     3s
   1  -1.26226198e+07  1.60322245e+08  6.01e+04 5.63e+01  4.67e+04     3s
   2  -5.20825196e+06  1.28548087e+08  2.44e+04 1.05e+00  2.01e+04     3s
   3  -8.25153789e+05  9.12843265e+07  1.64e+03 1.19e+00  1.71e+03     3s
   4  -4.92633736e+05  6.64067583e+07  3.58e+02 7.09e-01  5.84e+02     3s
   5  -4.23122800e+05  3.77862282e+07  1.77e+02 3.60e-01  2.99e+02     3s
   6  -3.69656219e+05  2.67455297e+07  8.06e+01 2.36e-01  1.78e+02     3s
   7  -2.72001647e+05  2.22715426e+07  1.05e+01 1.90e-01  1.14e+02     3s
   8  -1.80466666e+05  1.05627754e+07  1.80e-01 9.34e-02  5.19e+01     3s
   9  -1.21597282e+05  4.94548674e+06  1.03e-01 4.31e-02  2.44e+01     3s
  10  -6.28421065e+04  1.78540180e+06  4.45e-02 1.46e-02  8.92e+00     3s
  11  -4.18368776e+04  5.43292442e+05  3.06e-02 4.07e-03  2.82e+00     3s
  12  -2.20710428e+04  2.77415374e+05  1.48e-02 2.23e-03  1.44e+00     3s
  13  -1.28576114e+04  1.58978378e+05  9.16e-03 1.39e-03  8.29e-01     4s
  14  -9.31449867e+03  1.07261310e+05  7.34e-03 9.66e-04  5.62e-01     4s
  15  -4.53955543e+03  7.79916052e+04  5.49e-03 6.62e-04  3.98e-01     4s
  16   3.71071944e+02  5.47844328e+04  3.87e-03 5.29e-04  2.62e-01     4s
  17   3.82110760e+03  3.96505718e+04  2.90e-03 3.27e-04  1.73e-01     4s
  18   6.18358723e+03  3.39639948e+04  2.22e-03 2.53e-04  1.34e-01     4s
  19   8.13338742e+03  2.80779063e+04  1.68e-03 1.74e-04  9.62e-02     4s
  20   9.58090352e+03  2.27505003e+04  1.31e-03 1.03e-04  6.35e-02     4s
  21   1.10415592e+04  2.05820077e+04  9.50e-04 7.32e-05  4.60e-02     4s
  22   1.19717603e+04  1.90849697e+04  7.05e-04 5.36e-05  3.43e-02     4s
  23   1.24396464e+04  1.76829104e+04  5.89e-04 3.60e-05  2.53e-02     4s
  24   1.30766585e+04  1.72517594e+04  4.42e-04 3.02e-05  2.01e-02     4s
  25   1.34303923e+04  1.67359176e+04  3.61e-04 2.28e-05  1.59e-02     4s
  26   1.37870120e+04  1.64690748e+04  2.79e-04 1.90e-05  1.29e-02     4s
  27   1.39035165e+04  1.61853124e+04  2.50e-04 1.53e-05  1.10e-02     4s
  28   1.44177857e+04  1.58066570e+04  1.38e-04 9.86e-06  6.70e-03     4s
  29   1.46997612e+04  1.56257482e+04  7.87e-05 7.26e-06  4.47e-03     4s
  30   1.47182544e+04  1.54558302e+04  7.50e-05 4.94e-06  3.56e-03     5s
  31   1.47993653e+04  1.53483944e+04  5.79e-05 3.35e-06  2.65e-03     5s
  32   1.49177787e+04  1.52726125e+04  3.45e-05 2.29e-06  1.71e-03     5s
  33   1.49750655e+04  1.52413359e+04  2.32e-05 1.86e-06  1.28e-03     5s
  34   1.50335747e+04  1.51688680e+04  1.23e-05 8.70e-07  6.52e-04     5s
  35   1.50363390e+04  1.51514393e+04  1.18e-05 6.38e-07  5.55e-04     5s
  36   1.50611588e+04  1.51337638e+04  7.32e-06 3.96e-07  3.50e-04     5s
  37   1.50644815e+04  1.51264110e+04  6.75e-06 2.93e-07  2.99e-04     5s
  38   1.50737775e+04  1.51248021e+04  5.10e-06 2.71e-07  2.46e-04     5s
  39   1.50868462e+04  1.51086453e+04  2.85e-06 5.50e-08  1.05e-04     5s
  40   1.50972125e+04  1.51078713e+04  1.10e-06 4.46e-08  5.14e-05     5s
  41   1.51021891e+04  1.51052147e+04  2.51e-07 8.65e-09  1.46e-05     5s
  42   1.51039602e+04  1.51042420e+04  1.46e-08 2.70e-09  1.36e-06     5s
  43   1.51041153e+04  1.51041316e+04  5.85e-10 3.48e-10  7.87e-08     5s
  44   1.51041159e+04  1.51041159e+04  2.00e-09 2.46e-11  3.16e-10     5s

Barrier solved model in 44 iterations and 5.31 seconds (10.28 work units)
Optimal objective 1.51041159e+04


Root crossover log...

   81365 DPushes remaining with DInf 0.0000000e+00                 5s
       0 DPushes remaining with DInf 0.0000000e+00                 9s

    9491 PPushes remaining with PInf 5.6526907e-05                 9s
       0 PPushes remaining with PInf 0.0000000e+00                 9s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.2964980e-10      9s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   43231    1.5104116e+04   0.000000e+00   0.000000e+00      9s
   43231    1.5104116e+04   0.000000e+00   0.000000e+00      9s
Concurrent spin time: 2.25s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 1.510412e+04, 43231 iterations, 8.96 seconds (17.10 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 15104.1159    0  599 -190756.93 15104.1159   108%     -   11s
H    0     0                    -184317.8478 15104.1159   108%     -   11s
H    0     0                    -158152.3794 15104.1159   110%     -   12s
H    0     0                    -156140.8405 15104.1159   110%     -   12s
H    0     0                    -156109.7428 15104.1159   110%     -   12s
H    0     0                    -150610.6055 15104.1159   110%     -   12s
H    0     0                    -150171.3783 15104.1159   110%     -   12s
H    0     0                    -149902.4283 15104.1159   110%     -   12s
H    0     0                    -92040.69500 15104.1159   116%     -   12s
H    0     0                    -88975.60689 15104.1159   117%     -   12s
H    0     0                    -86893.27018 15104.1159   117%     -   12s
H    0     0                    -71038.38096 15104.1159   121%     -   13s
H    0     0                    -70890.65112 10234.1136   114%     -   52s
H    0     0                    -69437.36646 10234.1136   115%     -   52s
H    0     0                    -69432.35432 10234.1136   115%     -   52s
H    0     0                    -69373.01083 10234.1136   115%     -   52s
H    0     0                    -61823.95395 10234.1136   117%     -   52s
H    0     0                    -60542.40433 10234.1136   117%     -   52s
H    0     0                    -59016.16438 10234.1136   117%     -   52s
H    0     0                    -58998.80642 10234.1136   117%     -   52s
H    0     0                    -56517.35598 10234.1136   118%     -   52s
H    0     0                    -56089.94016 10234.1136   118%     -   52s
H    0     0                    -55969.72503 10234.1136   118%     -   52s
H    0     0                    -55901.96929 10234.1136   118%     -   52s
H    0     0                    -55865.58527 10234.1136   118%     -   52s
H    0     0                    -55823.77158 10234.1136   118%     -   52s
H    0     0                    -55818.91585 10234.1136   118%     -   52s
H    0     0                    -55777.10215 10234.1136   118%     -   52s
H    0     0                    -55762.58025 10234.1136   118%     -   52s
H    0     0                    -55722.16147 10234.1136   118%     -   52s
H    0     0                    -55715.64527 10234.1136   118%     -   52s
H    0     0                    -55685.07337 10234.1136   118%     -   52s
     0     0 10234.1136    0  745 -55685.073 10234.1136   118%     -   52s
H    0     0                    -54559.44722 10233.5370   119%     -   53s
H    0     0                    -54323.68504 10233.5370   119%     -   53s
H    0     0                    -53978.54966 10233.5370   119%     -   53s
H    0     0                    -52895.25319 10233.5370   119%     -   53s
H    0     0                    -52879.15567 10233.5370   119%     -   53s
H    0     0                    -52826.83451 10233.5370   119%     -   53s
H    0     0                    -52816.54105 10233.5370   119%     -   53s
H    0     0                    -52800.44353 10233.5370   119%     -   53s
     0     0 9623.32166    0  740 -52800.444 9623.32166   118%     -   65s
     0     0 9555.67749    0  742 -52800.444 9555.67749   118%     -   70s
     0     0 9505.41855    0  737 -52800.444 9505.41855   118%     -   74s
     0     0 9482.80701    0  748 -52800.444 9482.80701   118%     -   77s
     0     0 9482.80701    0  748 -52800.444 9482.80701   118%     -   78s
     0     0 9482.80701    0  745 -52800.444 9482.80701   118%     -   80s
     0     0 9482.80701    0  748 -52800.444 9482.80701   118%     -   84s
     0     0 9482.80701    0  743 -52800.444 9482.80701   118%     -   86s
     0     0 9482.80701    0  753 -52800.444 9482.80701   118%     -   88s
     0     0 9482.80701    0  734 -52800.444 9482.80701   118%     -   92s
     0     0 9482.80701    0  742 -52800.444 9482.80701   118%     -   93s
     0     0 9473.43001    0  733 -52800.444 9473.43001   118%     -   94s
     0     0 9439.75799    0  746 -52800.444 9439.75799   118%     -   96s
     0     0 9439.73325    0  746 -52800.444 9439.73325   118%     -   97s
H    0     0                    -48443.14452 6559.75283   114%     -  134s
H    0     0                    -46772.48312 6559.75283   114%     -  134s
H    0     0                    -46769.84757 6559.75283   114%     -  134s
H    0     0                    -46732.52374 6559.75283   114%     -  134s
H    0     0                    -46729.88819 6559.75283   114%     -  134s
H    0     0                    -46641.97417 6559.75283   114%     -  134s
     0     0 6559.75283    0  839 -46641.974 6559.75283   114%     -  134s
H    0     0                    -42643.57477 6559.72831   115%     -  135s
H    0     0                    -42580.44849 6559.72831   115%     -  135s
H    0     0                    -41973.00780 6559.72831   116%     -  135s
H    0     0                    -41885.91379 6559.72831   116%     -  135s
H    0     0                    -41826.69766 6559.72831   116%     -  135s
H    0     0                    -41818.58141 6559.72831   116%     -  135s
H    0     0                    -41817.82314 6559.72831   116%     -  135s
H    0     0                    -41809.08262 6559.72831   116%     -  135s
H    0     0                    -41808.32436 6559.72831   116%     -  135s
H    0     0                    -41763.94724 6559.72831   116%     -  135s
H    0     0                    -41745.13307 6559.72831   116%     -  135s
H    0     0                    -41735.58990 6559.72831   116%     -  135s
H    0     0                    -41734.83163 6559.72831   116%     -  135s
     0     0 5060.22273    0  876 -41734.832 5060.22273   112%     -  178s
     0     0 4787.36640    0  868 -41734.832 4787.36640   111%     -  200s
H    0     0                    -36646.89541 4631.44826   113%     -  216s
H    0     0                    -36275.99596 4631.44826   113%     -  216s
H    0     0                    -33959.32398 4631.44826   114%     -  216s
H    0     0                    -33775.86978 4631.44826   114%     -  216s
H    0     0                    -33651.41432 4631.44826   114%     -  216s
H    0     0                    -33623.09151 4631.44826   114%     -  216s
H    0     0                    -33580.16638 4631.44826   114%     -  216s
H    0     0                    -33570.56037 4631.44826   114%     -  216s
H    0     0                    -33515.95191 4631.44826   114%     -  216s
H    0     0                    -33502.83647 4631.44826   114%     -  216s
H    0     0                    -33491.23024 4631.44826   114%     -  216s
H    0     0                    -16966.96424 4631.44826   127%     -  216s
H    0     0                    -16837.15356 4631.44826   128%     -  216s
H    0     0                    -16835.89313 4631.44826   128%     -  216s
H    0     0                    -16835.74053 4631.44826   128%     -  216s
H    0     0                    -16834.48009 4631.44826   128%     -  216s
     0     0 4631.44826    0  872 -16834.480 4631.44826   128%     -  216s
     0     0 4567.60980    0  856 -16834.480 4567.60980   127%     -  228s
     0     0 4530.51112    0  855 -16834.480 4530.51112   127%     -  236s
     0     0 4490.16996    0  855 -16834.480 4490.16996   127%     -  242s
     0     0 4484.34689    0  857 -16834.480 4484.34689   127%     -  245s
     0     0 4472.08868    0  852 -16834.480 4472.08868   127%     -  248s
     0     0 4438.37065    0  862 -16834.480 4438.37065   126%     -  254s
     0     0 4434.39046    0  864 -16834.480 4434.39046   126%     -  256s
     0     0 4430.78071    0  862 -16834.480 4430.78071   126%     -  259s
     0     0 4301.62126    0  881 -16834.480 4301.62126   126%     -  275s
     0     0 4277.21289    0  874 -16834.480 4277.21289   125%     -  282s
     0     0 4272.50860    0  876 -16834.480 4272.50860   125%     -  287s
     0     0 4270.66426    0  879 -16834.480 4270.66426   125%     -  289s
     0     0 4268.93582    0  875 -16834.480 4268.93582   125%     -  291s
     0     0 4266.52670    0  881 -16834.480 4266.52670   125%     -  292s
     0     0 4252.89290    0  878 -16834.480 4252.89290   125%     -  297s
     0     0 4249.92853    0  877 -16834.480 4249.92853   125%     -  299s
     0     0 4249.40471    0  879 -16834.480 4249.40471   125%     -  300s
     0     0 1528.34531    0  707 -16834.480 1528.34531   109%     -  384s
H    0     0                    -16476.38486  732.41670   104%     -  433s
H    0     0                    -16474.97183  732.41670   104%     -  433s
H    0     0                    -16446.39287  732.41670   104%     -  433s
H    0     0                    -16401.76548  732.41670   104%     -  433s
H    0     0                    -16329.92575  732.41670   104%     -  433s
H    0     0                    -16325.00350  732.41670   104%     -  433s
H    0     0                    -16295.69462  732.41670   104%     -  433s
H    0     0                    -16276.34896  732.41670   104%     -  433s
H    0     0                    -16236.17186  732.41670   105%     -  433s
H    0     0                    -16234.91142  732.41670   105%     -  433s
H    0     0                    -16123.18828  732.41670   105%     -  433s
H    0     0                    -16069.10298  732.41670   105%     -  433s
     0     0  732.41670    0  788 -16069.103  732.41670   105%     -  433s
     0     0  545.89327    0  749 -16069.103  545.89327   103%     -  472s
     0     0  461.16814    0  738 -16069.103  461.16814   103%     -  497s
H    0     0                    -15371.72620  374.49592   102%     -  531s
H    0     0                    -15082.40474  374.49592   102%     -  531s
H    0     0                    -15049.83255  374.49592   102%     -  531s
H    0     0                    -15021.60058  374.49592   102%     -  531s
H    0     0                    -14658.72480  374.49592   103%     -  531s
H    0     0                    -14368.53165  374.49592   103%     -  531s
H    0     0                    -13909.41494  374.49592   103%     -  531s
     0     0  374.49592    0  775 -13909.415  374.49592   103%     -  531s
     0     0  361.55750    0  796 -13909.415  361.55750   103%     -  543s
H    0     0                    -13889.15048  315.55577   102%     -  559s
     0     0  315.55577    0  795 -13889.150  315.55577   102%     -  559s
     0     0  293.51996    0  759 -13889.150  293.51996   102%     -  569s
     0     0  274.03105    0  753 -13889.150  274.03105   102%     -  583s
     0     0  268.79352    0  850 -13889.150  268.79352   102%     -  591s
     0     0  263.24778    0  801 -13889.150  263.24778   102%     -  599s
     0     0  260.23750    0  801 -13889.150  260.23750   102%     -  607s
     0     0  214.48773    0  806 -13889.150  214.48773   102%     -  626s
     0     0  209.65465    0  802 -13889.150  209.65465   102%     -  633s
     0     0  186.93360    0  808 -13889.150  186.93360   101%     -  643s
     0     0  180.32207    0  798 -13889.150  180.32207   101%     -  652s
     0     0  169.32465    0  807 -13889.150  169.32465   101%     -  662s
     0     0  168.47155    0  805 -13889.150  168.47155   101%     -  666s
     0     0 -734.94506    0  812 -13889.150 -734.94506  94.7%     -  775s
H    0     0                    -12329.69577 -735.16091  94.0%     -  787s
H    0     0                    -12255.45374 -735.16091  94.0%     -  788s
H    0     0                    -11996.65296 -735.16091  93.9%     -  788s
H    0     0                    -11938.05599 -735.16091  93.8%     -  788s
     0     0 -976.19695    0  838 -11938.056 -976.19695  91.8%     -  822s
     0     0 -1109.9616    0  904 -11938.056 -1109.9616  90.7%     -  854s
     0     0 -1171.5941    0  785 -11938.056 -1171.5941  90.2%     -  875s
     0     0 -1203.9645    0  729 -11938.056 -1203.9645  89.9%     -  893s
     0     0 -1216.8693    0  885 -11938.056 -1216.8693  89.8%     -  904s
     0     0 -1233.1759    0  720 -11938.056 -1233.1759  89.7%     -  919s
     0     0 -1249.3908    0  722 -11938.056 -1249.3908  89.5%     -  932s
     0     0 -1254.1449    0  724 -11938.056 -1254.1449  89.5%     -  940s
     0     0 -1255.4447    0  732 -11938.056 -1255.4447  89.5%     -  942s
     0     0 -1443.5083    0  809 -11938.056 -1443.5083  87.9%     -  990s
     0     0 -1465.8798    0  739 -11938.056 -1465.8798  87.7%     - 1009s
     0     0 -1486.0714    0  798 -11938.056 -1486.0714  87.6%     - 1023s
     0     0 -1490.8527    0  800 -11938.056 -1490.8527  87.5%     - 1031s
     0     0 -1494.9612    0  810 -11938.056 -1494.9612  87.5%     - 1039s
     0     0 -1498.3770    0  804 -11938.056 -1498.3770  87.4%     - 1042s
     0     0 -1506.3181    0  803 -11938.056 -1506.3181  87.4%     - 1048s
     0     0 -1507.9427    0  802 -11938.056 -1507.9427  87.4%     - 1052s
     0     0 -1621.4347    0  782 -11938.056 -1621.4347  86.4%     - 1080s
     0     0 -1648.9041    0  866 -11938.056 -1648.9041  86.2%     - 1099s
     0     0 -1664.1231    0  855 -11938.056 -1664.1231  86.1%     - 1109s
     0     0 -1669.6443    0  855 -11938.056 -1669.6443  86.0%     - 1115s
     0     0 -1674.5458    0  870 -11938.056 -1674.5458  86.0%     - 1120s
     0     0 -1675.9249    0  863 -11938.056 -1675.9249  86.0%     - 1124s
     0     0 -1738.8688    0  778 -11938.056 -1738.8688  85.4%     - 1148s
     0     0 -1785.0593    0  784 -11938.056 -1785.0593  85.0%     - 1165s
     0     0 -1795.0359    0  888 -11938.056 -1795.0359  85.0%     - 1176s
     0     0 -1806.2881    0  881 -11938.056 -1806.2881  84.9%     - 1186s
     0     0 -1809.1730    0  885 -11938.056 -1809.1730  84.8%     - 1192s
     0     0 -1875.5185    0  814 -11938.056 -1875.5185  84.3%     - 1216s
     0     0 -1892.9707    0  829 -11938.056 -1892.9707  84.1%     - 1227s
     0     0 -1898.7413    0  746 -11938.056 -1898.7413  84.1%     - 1235s
     0     0 -1902.1162    0  838 -11938.056 -1902.1162  84.1%     - 1241s
     0     0 -1920.5921    0  826 -11938.056 -1920.5921  83.9%     - 1254s
     0     0 -1923.0701    0  824 -11938.056 -1923.0701  83.9%     - 1261s
     0     0 -1931.5127    0  833 -11938.056 -1931.5127  83.8%     - 1272s
H    0     0                    -11838.84286 -1931.6173  83.7%     - 1273s
H    0     0                    -11802.99707 -1931.6173  83.6%     - 1273s
     0     0 -1933.4385    0  831 -11802.997 -1933.4385  83.6%     - 1282s
     0     0 -1937.4647    0  840 -11802.997 -1937.4647  83.6%     - 1291s
     0     0 -1937.6608    0  840 -11802.997 -1937.6608  83.6%     - 1301s
H    0     0                    -11597.38863 -1937.7501  83.3%     - 1360s
     0     2 -1937.7501    0  840 -11597.389 -1937.7501  83.3%     - 1463s
     1     3 -2294.3912    1  640 -11597.389 -1937.7501  83.3% 13343 1483s
     2     4 -1951.2088    1  740 -11597.389 -1951.2088  83.2%  8661 1492s
     3     6 -2643.1335    2  667 -11597.389 -1951.2151  83.2%  7676 1508s
     5    10 -2764.9442    3  678 -11597.389 -1951.2151  83.2%  9908 1532s
     9    17 -2919.3957    4  765 -11597.389 -2036.8976  82.4% 10061 1563s
    16    32 -3023.0104    5  810 -11597.389 -2036.8976  82.4% 10937 1598s
    31    47 -5509.2871    4  547 -11597.389 -2109.8713  81.8% 15470 2546s
    46    76 -5417.5060    5  555 -11597.389 -2109.8713  81.8% 23324 2603s
    75   211 -5497.4312    6  526 -11597.389 -2109.8713  81.8% 18040 2649s
   218   258 -5982.3550    9  475 -11597.389 -2109.8713  81.8%  8733 2668s
   265   311 -6157.0992   10  455 -11597.389 -2109.8713  81.8%  8049 2686s
   333   330 -4873.8323   11  547 -11597.389 -2109.8713  81.8%  7528 2701s
   380   345 -6306.3687   11  468 -11597.389 -2109.8713  81.8%  7156 2717s
   435   356 infeasible   13      -11597.389 -2109.8713  81.8%  6712 2734s
   467   374 -4850.3409   11  541 -11597.389 -2109.8713  81.8%  6695 2748s
   509   385 infeasible   13      -11597.389 -2109.8713  81.8%  6562 2765s
   548   407 -8917.5883   12  140 -11597.389 -2109.8713  81.8%  6481 2780s
   618   413 -9906.0002   15  107 -11597.389 -2109.8713  81.8%  6167 2795s
   689   433 -10002.014   19   76 -11597.389 -2109.8713  81.8%  5876 2811s
   763   468 -10190.699   23   57 -11597.389 -2109.8713  81.8%  5685 2824s
   840   549 -10601.634   27   71 -11597.389 -2109.8713  81.8%  5409 2839s
   960   552     cutoff   30      -11597.389 -2109.8713  81.8%  4982 2854s
  1007   530 infeasible   29      -11597.389 -2109.8713  81.8%  4908 2870s
  1069   522 -8728.7985   33  186 -11597.389 -2109.8713  81.8%  4788 2887s
  1117   534 -5068.7266    8  358 -11597.389 -2109.8713  81.8%  4711 2904s
  1155   572 -5193.2025    9  351 -11597.389 -2109.8713  81.8%  4755 2922s
  1208   614 -5462.9768   10  352 -11597.389 -2109.8713  81.8%  4744 2938s
  1266   631 -5506.3956   11  363 -11597.389 -2109.8713  81.8%  4771 2957s
  1323   629 -5618.9668   12  356 -11597.389 -2109.8713  81.8%  4803 2975s
  1367   638 infeasible   39      -11597.389 -2109.8713  81.8%  4854 2994s
  1424   644 -5514.9198   11  431 -11597.389 -2109.8713  81.8%  4943 3015s
  1476   664 infeasible   39      -11597.389 -2109.8713  81.8%  4988 3038s
  1535   679 -11050.321   14  122 -11597.389 -2109.8713  81.8%  5021 3060s
  1584   713 -11118.612   15  115 -11597.389 -2109.8713  81.8%  5108 3083s
  1686   736 -11255.394   42  331 -11597.389 -2109.8713  81.8%  5079 3109s
  1788   746 -11352.034   43  285 -11597.389 -2109.8713  81.8%  5044 3136s
  1870   752 infeasible   44      -11597.389 -2109.8713  81.8%  5034 3161s
  1910   781 -8330.9309   12  206 -11597.389 -2109.8713  81.8%  5124 3187s
  1994   795 infeasible   15      -11597.389 -2109.8713  81.8%  5194 3250s
  2054   832 -11002.895   14  106 -11597.389 -2109.9373  81.8%  5266 3276s
  2125   877 -11497.750   19   74 -11597.389 -2109.9373  81.8%  5348 3305s
  2231   900 infeasible   19      -11597.389 -2109.9373  81.8%  5368 3336s
  2332   907 -5845.1988    8  530 -11597.389 -2109.9373  81.8%  5406 3369s
  2439   936 -7093.9461    9  207 -11597.389 -2109.9373  81.8%  5451 3404s
  2518   964 -8273.9445   10  179 -11597.389 -2109.9373  81.8%  5561 3437s
  2594   990 -8597.8735   13  169 -11597.389 -2109.9373  81.8%  5622 3474s
  2678  1023 -10924.463   20   43 -11597.389 -2109.9373  81.8%  5718 3510s
  2783  1080 -7070.6329    9  259 -11597.389 -2109.9373  81.8%  5833 3547s
  2892  1103 -7902.3910   10  207 -11597.389 -2109.9373  81.8%  5938 3583s
  2929  1110 -10091.354   11   63 -11597.389 -2109.9373  81.8%  6031 3600s

Cutting planes:
  Learned: 8
  Implied bound: 299
  MIR: 6230
  Flow cover: 4354
  Inf proof: 1
  Zero half: 8
  RLT: 358
  Relax-and-lift: 1527

Explored 2962 nodes (18923018 simplex iterations) in 3600.05 seconds (7768.20 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -11597.4 -11803 -11838.8 ... -14368.5

Time limit reached
Best objective -1.159738862964e+04, best bound -2.109937280789e+03, gap 81.8068%
  WARNING: Time limit reached. Using best solution found (gap: 81.81%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.10s
  Master Objective (UB) = -11597.39, θ = 116575.32
  Upper Bound (UB) = -11597.39

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 116575.32
  [DEBUG]   ✓ Scenario 0: θ = 116575.32 ≤ Q = 116575.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 116575.32 ≤ Q = 116575.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 116575.32 ≤ Q = 116575.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 116575.32 ≤ Q = 116575.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 116575.32 ≤ Q = 116575.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 116575.32 ≤ Q = 116575.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 116575.32 ≤ Q = 116575.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 116575.32 ≤ Q = 116575.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 116575.32 ≤ Q = 116575.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 116575.32 ≤ Q = 116575.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 116575.32 ≤ Q = 116575.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 116575.32 ≤ Q = 116575.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 116575.32 ≤ Q = 116575.32 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 13] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x5ae6ff37
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x5ae6ff37
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.325396e+13
Presolve removed 2577 rows and 1870 columns
Presolve time: 0.00s
Presolved: 516 rows, 519 columns, 1455 nonzeros
Found heuristic solution: objective 6995164.3696
Variable types: 351 continuous, 168 integer (168 binary)

Root relaxation: objective -1.202154e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -120215.35    0  122 6995164.37 -120215.35   102%     -    0s
H    0     0                    -85682.93997 -120215.35  40.3%     -    0s
H    0     0                    -86212.29396 -120215.35  39.4%     -    0s
     0     0 -88998.914    0   32 -86212.294 -88998.914  3.23%     -    0s
H    0     0                    -88868.26698 -88988.892  0.14%     -    0s
     0     0 -88955.237    0   31 -88868.267 -88955.237  0.10%     -    0s
H    0     0                    -88918.97989 -88955.237  0.04%     -    0s
     0     0 -88955.237    0   30 -88918.980 -88955.237  0.04%     -    0s
H    0     0                    -88953.38443 -88953.384  0.00%     -    0s
     0     0          -    0      -88953.384 -88953.384  0.00%     -    0s

Cutting planes:
  Gomory: 1
  Implied bound: 9
  MIR: 27

Explored 1 nodes (479 simplex iterations) in 0.05 seconds (0.02 work units)
Thread count was 32 (of 64 available processors)

Solution count 8: -88953.4 -88919 -88868.3 ... 1.3254e+13
No other solutions better than -88953.4

Optimal solution found (tolerance 1.00e-04)
Best objective -8.895338443168e+04, best bound -8.895338443168e+04, gap 0.0000%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 116468.33
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -88953.38
  [DEBUG]   S×d_nominal = 205421.71
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 205421.71 + -88953.38 = 116468.33
  [DEBUG]   Current θ from Master = 116575.32
  [DEBUG]   ⚠️  Z_SP ≤ θ by 106.99 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -11704.38
  Lower Bound (LB) = -11704.38
  Gap (UB-LB) = 106.9927, Absolute Gap = 106.9927, Relative Gap = 0.009226
  *** CONVERGED (gap within tolerance) ***

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 13
Total Time: 29162.00s
Converged: True
Final Lower Bound: -11704.3813
Final Upper Bound: -11597.3886
Final Gap: 106.992694
Number of Critical Scenarios: 13
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [0] (1/3)
Product 1 Plants: [1] (1/3)
Product 2 Plants: [2] (1/3)
Total Plant Openings: 3
DCs Opened: [0, 7, 9] (3/10)
Active Routes (Plant→DC): 9
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 3 customers  Mode 1: 12 customers  Mode 2: 35 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 13
Start Time: 2026-01-04 12:30:56
End Time: 2026-01-04 20:36:58
Total Time: 29162.00s
Optimal Value: -11704.38
Lower Bound: -11704.38
Upper Bound: -11597.39
Gap: 106.992694
Plants Opened: {0: [0], 1: [1], 2: [2]} (3 plants)
DCs Opened: [0, 7, 9] (3 DCs)
================================================================================

Results saved to: result/DH_single_full_seed21_LD_gamma20_20260104_203659.csv

Total Execution Time: 29162.33 seconds
End Time: 2026-01-04 20:36:59

All tasks completed successfully!

