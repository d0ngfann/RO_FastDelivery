
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 11
DI Scenario: LD
Start Time: 2026-01-04 12:31:02
================================================================================
Loading data from data/DH_data_full_seed11.pkl...

Applying DI scenario: LD
DI values:
  Product 0: ['1.000', '1.088', '1.185'] (k=0.209)
  Product 1: ['1.000', '1.107', '1.225'] (k=0.250)
  Product 2: ['1.000', '1.144', '1.308'] (k=0.331)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=996, max=1696
  DC capacity (MC): min=421, max=894

Demand Structure (s_rk matrix):
  Total customer-product pairs: 80/150 (46.7% sparse)
  Average products per customer: 1.60

Demand (only non-zero entries):
  Nominal (μ): min=8.73, max=34.94, count=80
  Deviation (μ̂): min=4.00, max=9.94

Costs:
  Plant fixed cost: min=5262, max=9018
  DC fixed cost: min=3188, max=5349
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.432', '2.050'] (k=0.885)
    Product 1: ['1.000', '1.380', '1.906'] (k=0.795)
    Product 2: ['1.000', '1.426', '2.034'] (k=0.876)
  MD:
    Product 0: ['1.000', '1.162', '1.351'] (k=0.371)
    Product 1: ['1.000', '1.277', '1.630'] (k=0.603)
    Product 2: ['1.000', '1.221', '1.491'] (k=0.493)
  LD:
    Product 0: ['1.000', '1.088', '1.185'] (k=0.209)
    Product 1: ['1.000', '1.107', '1.225'] (k=0.250)
    Product 2: ['1.000', '1.144', '1.308'] (k=0.331)
  Mixed:
    Product 0: ['1.000', '1.432', '2.050'] (k=0.885)
    Product 1: ['1.000', '1.277', '1.630'] (k=0.603)
    Product 2: ['1.000', '1.144', '1.308'] (k=0.331)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48750 nonzeros
Model fingerprint: 0xe0b06001
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [9e-02, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11871 rows and 2871 columns
Presolve time: 0.07s
Presolved: 4802 rows, 5629 columns, 33384 nonzeros
Variable types: 3370 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -307443.6440
Found heuristic solution: objective -179154.5947

Root relaxation: objective 7.002843e+04, 4533 iterations, 0.15 seconds (0.26 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 70028.4307    0  634 -179154.59 70028.4307   139%     -    0s
H    0     0                    -142934.6878 70028.4307   149%     -    0s
     0     0 65886.2317    0  884 -142934.69 65886.2317   146%     -    0s
H    0     0                    -125072.9028 65883.8082   153%     -    0s
     0     0 65837.5478    0  883 -125072.90 65837.5478   153%     -    0s
     0     0 65826.5497    0  884 -125072.90 65826.5497   153%     -    0s
     0     0 65825.7300    0  887 -125072.90 65825.7300   153%     -    0s
     0     0 65825.1650    0  895 -125072.90 65825.1650   153%     -    0s
     0     0 61759.7824    0 1106 -125072.90 61759.7824   149%     -    1s
     0     0 61673.0604    0 1098 -125072.90 61673.0604   149%     -    1s
     0     0 61652.1825    0 1122 -125072.90 61652.1825   149%     -    1s
     0     0 61651.3984    0 1125 -125072.90 61651.3984   149%     -    1s
H    0     0                    -123427.4018 58395.8329   147%     -    3s
H    0     0                    -121634.1544 58395.8329   148%     -    3s
H    0     0                    -102659.7030 58395.8329   157%     -    3s
H    0     0                    -38958.57038 58395.8329   250%     -    3s
     0     0 58395.8329    0 1129 -38958.570 58395.8329   250%     -    3s
     0     0 58248.6263    0 1129 -38958.570 58248.6263   250%     -    3s
     0     2 58248.6263    0 1129 -38958.570 58248.6263   250%     -    4s
     3     8 58076.2402    2 1029 -38958.570 58248.6263   250%  1863    5s
   364   405 50406.5343   11  801 -38958.570 53416.0991   237%   688   10s
H  426   448                    18192.796731 53416.0991   194%   663   10s
H  628   718                    18294.435290 53416.0991   192%   558   11s
H  632   718                    19229.877771 53416.0991   178%   559   11s
H  639   718                    19553.720722 53416.0991   173%   557   11s
H  654   718                    20162.782491 53416.0991   165%   557   11s
H  817   870                    20307.104691 52959.3960   161%   493   11s
H  821   870                    20533.043567 52959.3960   158%   494   11s
H  838   870                    20756.753798 52959.3960   155%   491   11s
H  989   991                    20782.933849 52900.9165   155%   458   12s
H  996   991                    20785.213361 52900.9165   155%   458   12s
H  999   991                    20856.288771 52900.9165   154%   459   12s
H 1011   991                    20884.637169 52900.9165   153%   460   12s
H 1022   991                    20892.696496 52900.9165   153%   461   12s
H 1149  1145                    20918.876546 52662.2364   152%   445   13s
H 1151  1145                    20921.044894 52662.2364   152%   445   13s
H 1166  1145                    20925.204275 52662.2364   152%   444   13s
H 1386  1320                    22066.636132 52355.4827   137%   444   14s
  1537  1540 31771.5935   27  598 22066.6361 52355.4827   137%   429   15s
H 1538  1540                    22093.763892 52355.4827   137%   428   15s
H 1545  1540                    22105.117114 52355.4827   137%   428   15s
H 1551  1540                    22198.904479 52355.4827   136%   427   15s
H 1647  1540                    22211.325120 52355.4827   136%   417   15s
H 1807  1757                    22214.335747 52196.7473   135%   406   15s
H 1811  1757                    22232.987758 52196.7473   135%   405   15s
H 2066  1927                    22248.299317 51066.4161   130%   395   16s
H 3347  2778                    22294.265994 51066.4161   129%   340   19s
H 3394  2996                    22333.176186 51066.4161   129%   340   19s
H 3416  2995                    22366.341817 51066.4161   128%   338   19s
H 3540  2995                    22373.249894 50506.3894   126%   334   19s
H 3670  2995                    22379.761240 50506.3894   126%   328   19s
H 3677  2993                    22458.598057 50506.3894   125%   328   23s
  3678  2994 28375.0462   29 1129 22458.5981 50506.3894   125%   328   26s
  3694  3005 24357.8703   21  552 22458.5981 31826.8321  41.7%   326   30s
  4037  2966 24640.4824   19  186 22458.5981 27035.9756  20.4%   326   35s
H 4159  2741                    22463.151253 27035.9756  20.4%   321   35s
H 4333  2576                    22463.211023 24168.2278  7.59%   310   35s
H 4336  2439                    22466.067842 24168.2278  7.58%   310   35s
* 4582  2285              36    22628.099591 23757.2755  4.99%   295   36s
H 4760  2201                    22644.315063 23757.2755  4.91%   285   36s
H 4782  2077                    22772.577157 23757.2755  4.32%   283   36s
H 4790  1963                    22868.586469 23757.2755  3.89%   283   36s
H 4794  1857                    22997.796798 23757.2755  3.30%   283   36s
H 4881  1682                    23091.003040 23757.2755  2.89%   278   36s
H 4930  1570                    23102.658724 23174.9410  0.31%   275   36s

Cutting planes:
  Gomory: 1
  Implied bound: 1
  Projected implied bound: 76
  MIR: 131
  Flow cover: 310
  Zero half: 4
  RLT: 37
  Relax-and-lift: 63

Explored 5272 nodes (1376975 simplex iterations) in 36.31 seconds (85.49 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: 23102.7 23091 22997.8 ... 22463.2

Optimal solution found (tolerance 1.00e-04)
Best objective 2.310265872384e+04, best bound 2.310265872384e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 36.31s
  Master Objective (UB) = 23102.66, θ = 146255.07
  Upper Bound (UB) = 23102.66

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 146255.07
  [DEBUG]   ✓ Scenario 0: θ = 146255.07 ≤ Q = 146255.07 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x39a07a20
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x39a07a20
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [3e-01, 2e+02]
Found heuristic solution: objective 1.290455e+13
Presolve removed 2602 rows and 1895 columns
Presolve time: 0.00s
Presolved: 491 rows, 494 columns, 1384 nonzeros
Found heuristic solution: objective 6778141.4016
Variable types: 334 continuous, 160 integer (160 binary)

Root relaxation: objective -1.183786e+05, 232 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -118378.55    0  122 6778141.40 -118378.55   102%     -    0s
H    0     0                    -85830.72657 -118378.55  37.9%     -    0s
H    0     0                    -86638.98922 -118378.55  36.6%     -    0s
*    0     0               0    -88835.84206 -88835.842  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 202

Explored 1 nodes (355 simplex iterations) in 0.01 seconds (0.01 work units)
Thread count was 32 (of 256 available processors)

Solution count 5: -88835.8 -86639 -85830.7 ... 1.29045e+13
No other solutions better than -88835.8

Optimal solution found (tolerance 1.00e-04)
Best objective -8.883584205512e+04, best bound -8.883584205512e+04, gap 0.0000%
  Subproblem solved in 0.02s
  Worst-case operational profit (Z_SP) = 112863.79
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -88835.84
  [DEBUG]   S×d_nominal = 201699.63
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 201699.63 + -88835.84 = 112863.79
  [DEBUG]   Current θ from Master = 146255.07
  [DEBUG]   ⚠️  Z_SP ≤ θ by 33391.28 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -10288.62
  Lower Bound (LB) = -10288.62
  Gap (UB-LB) = 33391.2824, Absolute Gap = 33391.2824, Relative Gap = 1.445344
  Not converged yet (gap = 33391.28 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 91981 nonzeros
Model fingerprint: 0x16a1b429
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [9e-02, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -10288.6 (0.01s)
MIP start from previous solve produced solution with objective -10288.6 (0.01s)
Loaded MIP start from previous solve with objective -10288.6

Presolve removed 14201 rows and 5760 columns
Presolve time: 0.27s
Presolved: 17762 rows, 8980 columns, 98298 nonzeros
Variable types: 6721 continuous, 2259 integer (2259 binary)

Root relaxation: objective 2.448267e+04, 10822 iterations, 1.51 seconds (3.47 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 24482.6728    0  554 -10288.624 24482.6728   338%     -    1s
H    0     0                    -7709.463542 24482.6728   418%     -    1s
H    0     0                    -7027.739935 24482.6728   448%     -    2s
H    0     0                    -6953.511592 24482.6728   452%     -    2s
H    0     0                    -6760.571083 24482.6728   462%     -    2s
     0     0 15090.8440    0  588 -6760.5711 15090.8440   323%     -    3s
H    0     0                    -6663.505129 15089.8071   326%     -    3s
     0     0 14786.8727    0  608 -6663.5051 14786.8727   322%     -    3s
     0     0 14761.5213    0  605 -6663.5051 14761.5213   322%     -    3s
     0     0 14751.2089    0  605 -6663.5051 14751.2089   321%     -    3s
H    0     0                    -6464.609685 14751.2089   328%     -    4s
H    0     0                    -6447.148608 14751.2089   329%     -    4s
     0     0 10523.4057    0  602 -6447.1486 10523.4057   263%     -    5s
H    0     0                    -6330.685895 10520.9286   266%     -    5s
H    0     0                    -6300.380044 9548.25169   252%     -    6s
H    0     0                    -6182.909055 9548.25169   254%     -    6s
     0     0 9548.25169    0  683 -6182.9091 9548.25169   254%     -    6s
     0     0 9456.51986    0  690 -6182.9091 9456.51986   253%     -    6s
H    0     0                    -3353.929420 9446.89321   382%     -    7s
H    0     0                    -3348.238528 9446.89321   382%     -    7s
     0     0 9446.89321    0  677 -3348.2385 9446.89321   382%     -    7s
     0     0 9444.95254    0  682 -3348.2385 9444.95254   382%     -    7s
H    0     0                    -3273.899544 9444.95254   388%     -    8s
H    0     0                    -3234.265661 9444.95254   392%     -    8s
H    0     0                    -3155.250327 7059.03884   324%     -    9s
     0     0 7059.03884    0  553 -3155.2503 7059.03884   324%     -    9s
     0     0 6564.06183    0  647 -3155.2503 6564.06183   308%     -   10s
     0     0 6427.22532    0  637 -3155.2503 6427.22532   304%     -   10s
     0     0 6403.32794    0  661 -3155.2503 6403.32794   303%     -   10s
     0     0 6391.34735    0  665 -3155.2503 6391.34735   303%     -   10s
     0     0 6387.51222    0  667 -3155.2503 6387.51222   302%     -   10s
     0     0 5507.33682    0  514 -3155.2503 5507.33682   275%     -   13s
     0     0 5334.83528    0  548 -3155.2503 5334.83528   269%     -   14s
     0     0 5279.65341    0  726 -3155.2503 5279.65341   267%     -   14s
     0     0 5270.89918    0  572 -3155.2503 5270.89918   267%     -   14s
     0     0 5265.59508    0  557 -3155.2503 5265.59508   267%     -   15s
     0     0 5017.48786    0  621 -3155.2503 5017.48786   259%     -   16s
     0     0 4939.23968    0  545 -3155.2503 4939.23968   257%     -   16s
     0     0 4906.33897    0  621 -3155.2503 4906.33897   255%     -   16s
     0     0 4898.48938    0  617 -3155.2503 4898.48938   255%     -   17s
     0     0 4896.64145    0  621 -3155.2503 4896.64145   255%     -   17s
     0     0 4692.85861    0  636 -3155.2503 4692.85861   249%     -   18s
H    0     0                    -2704.557870 4689.88244   273%     -   19s
H    0     0                    -2438.476242 4689.88244   292%     -   19s
H    0     0                    -2435.623535 4689.88244   293%     -   19s
     0     0 4663.18080    0  651 -2435.6235 4663.18080   291%     -   20s
     0     0 4655.95105    0  653 -2435.6235 4655.95105   291%     -   20s
     0     0 4653.43955    0  657 -2435.6235 4653.43955   291%     -   20s
     0     0 4582.59368    0  551 -2435.6235 4582.59368   288%     -   21s
     0     0 4572.75578    0  629 -2435.6235 4572.75578   288%     -   21s
     0     0 4569.32731    0  531 -2435.6235 4569.32731   288%     -   21s
     0     0 4513.70452    0  543 -2435.6235 4513.70452   285%     -   22s
     0     0 4497.27815    0  538 -2435.6235 4497.27815   285%     -   22s
     0     0 4495.78571    0  546 -2435.6235 4495.78571   285%     -   22s
     0     0 4475.17249    0  638 -2435.6235 4475.17249   284%     -   23s
     0     0 4474.75537    0  638 -2435.6235 4474.75537   284%     -   23s
H    0     0                    -2416.544991 4474.69093   285%     -   28s
H    0     0                    -2404.142409 4474.69093   286%     -   28s
     0     2 4474.69093    0  638 -2404.1424 4474.69093   286%     -   28s
     3     8 1275.76437    2  427 -2404.1424 4283.74435   278%  1506   30s
   205   172 -1162.8537   10  328 -2404.1424 1242.30369   152%   750   35s
   782   502 -297.40069   12  334 -2404.1424 1014.16457   142%   418   40s
  1352   718     cutoff   20      -2404.1424  670.04099   128%   338   45s
  2235  1142 -1280.5196   16  358 -2404.1424  319.76437   113%   273   50s
  3828  1667     cutoff   26      -2404.1424  -64.83835  97.3%   231   55s
  5828  2099 -1396.7563   24  291 -2404.1424 -496.25780  79.4%   208   60s
  7318  1974     cutoff   26      -2404.1424 -930.57452  61.3%   208   65s
  9197  1502 -2369.2007   42  209 -2404.1424 -1260.5233  47.6%   205   70s
 12283    32     cutoff   19      -2404.1424 -1842.1881  23.4%   194   76s

Cutting planes:
  Gomory: 14
  Implied bound: 17
  MIR: 1682
  Flow cover: 930
  Zero half: 12
  RLT: 85
  Relax-and-lift: 336

Explored 13182 nodes (2499586 simplex iterations) in 76.10 seconds (200.19 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -2404.14 -2416.54 -2435.62 ... -3353.93
No other solutions better than -2404.14

Optimal solution found (tolerance 1.00e-04)
Best objective -2.404142409135e+03, best bound -2.404142409135e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 76.11s
  Master Objective (UB) = -2404.14, θ = 113240.10
  Upper Bound (UB) = -2404.14

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 113240.10
  [DEBUG]   ✓ Scenario 0: θ = 113240.10 ≤ Q = 113240.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 113240.10 ≤ Q = 113240.10 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x5f48f2bb
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x5f48f2bb
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.219053e+13
Presolve removed 2602 rows and 1895 columns
Presolve time: 0.00s
Presolved: 491 rows, 494 columns, 1384 nonzeros
Found heuristic solution: objective 6137239.4528
Variable types: 334 continuous, 160 integer (160 binary)

Root relaxation: objective -1.321556e+05, 240 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -132155.56    0  126 6137239.45 -132155.56   102%     -    0s
H    0     0                    -96689.02873 -132155.56  36.7%     -    0s
H    0     0                    -103709.3200 -132155.56  27.4%     -    0s
H    0     0                    -104650.9996 -119278.18  14.0%     -    0s
     0     0 -119278.18    0   93 -104651.00 -119278.18  14.0%     -    0s
H    0     0                    -115564.5829 -119179.60  3.13%     -    0s
     0     0 -118683.14    0   89 -115564.58 -118683.14  2.70%     -    0s
     0     0 -118666.79    0   89 -115564.58 -118666.79  2.68%     -    0s
H    0     0                    -116182.0289 -118666.79  2.14%     -    0s
     0     0 -118148.53    0   91 -116182.03 -118148.53  1.69%     -    0s
     0     0 -117989.50    0   76 -116182.03 -117989.50  1.56%     -    0s
     0     0 -117989.50    0   91 -116182.03 -117989.50  1.56%     -    0s
H    0     0                    -116266.7798 -117989.50  1.48%     -    0s
     0     0 -117252.93    0   32 -116266.78 -117252.93  0.85%     -    0s
H    0     0                    -116306.8038 -117249.09  0.81%     -    0s
     0     0 -117147.15    0   38 -116306.80 -117147.15  0.72%     -    0s
     0     0 -117144.11    0   38 -116306.80 -117144.11  0.72%     -    0s
     0     0 -116835.49    0   25 -116306.80 -116835.49  0.45%     -    0s
     0     0 -116800.55    0   26 -116306.80 -116800.55  0.42%     -    0s
     0     0 -116626.23    0   18 -116306.80 -116626.23  0.27%     -    0s
     0     0 -116610.14    0   25 -116306.80 -116610.14  0.26%     -    0s
     0     0 -116472.24    0   12 -116306.80 -116472.24  0.14%     -    0s
H    0     0                    -116357.9420 -116464.19  0.09%     -    0s
     0     0 -116464.19    0    8 -116357.94 -116464.19  0.09%     -    0s
     0     0 -116427.57    0    7 -116357.94 -116427.57  0.06%     -    0s
     0     0 -116415.22    0    9 -116357.94 -116415.22  0.05%     -    0s
*    0     0               0    -116386.1299 -116386.13  0.00%     -    0s

Cutting planes:
  Gomory: 2
  Implied bound: 6
  MIR: 2
  Flow cover: 5
  Relax-and-lift: 2

Explored 1 nodes (880 simplex iterations) in 0.17 seconds (0.06 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -116386 -116358 -116307 ... 1.21905e+13
No other solutions better than -116386

Optimal solution found (tolerance 1.00e-04)
Best objective -1.163861299477e+05, best bound -1.163861299477e+05, gap 0.0000%
  Subproblem solved in 0.18s
  Worst-case operational profit (Z_SP) = 92521.37
  Scenario: 46 demand increases, 14 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -116386.13
  [DEBUG]   S×d_nominal = 208907.50
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 208907.50 + -116386.13 = 92521.37
  [DEBUG]   Current θ from Master = 113240.10
  [DEBUG]   ⚠️  Z_SP ≤ θ by 20718.73 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -23122.87
  Lower Bound (LB) = -10288.62
  Gap (UB-LB) = 7884.4813, Absolute Gap = 7884.4813, Relative Gap = 3.279540
  Not converged yet (gap = 7884.48 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 46 increases, 14 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135212 nonzeros
Model fingerprint: 0x63de8888
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [9e-02, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -23122.9 (0.02s)
Loaded MIP start from previous solve with objective -23122.9

Presolve removed 21270 rows and 8640 columns
Presolve time: 0.34s
Presolved: 25983 rows, 12340 columns, 159869 nonzeros
Variable types: 10081 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...

Concurrent spin time: 0.11s

Solved with dual simplex

Root relaxation: objective 1.266800e+04, 16707 iterations, 3.49 seconds (7.20 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 12667.9989    0  268 -23122.871 12667.9989   155%     -    3s
H    0     0                    -19207.77345 12667.9989   166%     -    4s
H    0     0                    -19079.00405 12667.9989   166%     -    4s
H    0     0                    -19072.57629 12667.9989   166%     -    4s
H    0     0                    -17695.70094 12667.9989   172%     -    4s
H    0     0                    -15630.77940 12667.9989   181%     -    4s
H    0     0                    -15590.41553 12667.9989   181%     -    4s
H    0     0                    -15571.29971 12667.9989   181%     -    4s
H    0     0                    -11550.26790 12667.9989   210%     -    4s
H    0     0                    -11491.71216 12667.9989   210%     -    4s
H    0     0                    -9681.033100 12667.9989   231%     -    4s
     0     0 8574.43201    0  358 -9681.0331 8574.43201   189%     -    6s
H    0     0                    -9151.880397 8574.29308   194%     -    6s
H    0     0                    -8857.986420 8574.29308   197%     -    6s
     0     0 7908.29521    0  359 -8857.9864 7908.29521   189%     -    6s
     0     0 7823.15082    0  355 -8857.9864 7823.15082   188%     -    6s
     0     0 7821.43304    0  359 -8857.9864 7821.43304   188%     -    6s
     0     0 7820.37944    0  360 -8857.9864 7820.37944   188%     -    7s
     0     0 6119.04018    0  445 -8857.9864 6119.04018   169%     -    8s
H    0     0                    -6957.285675 6118.50729   188%     -    8s
H    0     0                    -6950.549269 6118.50729   188%     -    8s
     0     0 5675.70143    0  426 -6950.5493 5675.70143   182%     -    9s
     0     0 5616.56912    0  426 -6950.5493 5616.56912   181%     -   10s
     0     0 5593.54343    0  445 -6950.5493 5593.54343   180%     -   10s
     0     0 5551.95506    0  446 -6950.5493 5551.95506   180%     -   10s
     0     0 5542.83665    0  442 -6950.5493 5542.83665   180%     -   11s
     0     0 5541.88079    0  435 -6950.5493 5541.88079   180%     -   11s
     0     0 5541.71120    0  446 -6950.5493 5541.71120   180%     -   11s
     0     0 4659.15338    0  485 -6950.5493 4659.15338   167%     -   13s
H    0     0                    -6721.584180 4659.03888   169%     -   14s
H    0     0                    -4524.158309 4320.55678   195%     -   15s
     0     0 4320.55678    0  480 -4524.1583 4320.55678   195%     -   15s
     0     0 4180.24834    0  479 -4524.1583 4180.24834   192%     -   15s
     0     0 4163.36831    0  483 -4524.1583 4163.36831   192%     -   15s
     0     0 4135.79214    0  478 -4524.1583 4135.79214   191%     -   16s
     0     0 4127.24468    0  487 -4524.1583 4127.24468   191%     -   16s
     0     0 4126.30546    0  484 -4524.1583 4126.30546   191%     -   16s
     0     0 3582.49120    0  512 -4524.1583 3582.49120   179%     -   19s
H    0     0                    -4477.580146 3581.81467   180%     -   19s
H    0     0                    -4477.449721 3581.81467   180%     -   19s
     0     0 3375.38323    0  559 -4477.4497 3375.38323   175%     -   20s
     0     0 3350.40397    0  564 -4477.4497 3350.40397   175%     -   20s
     0     0 3325.28693    0  511 -4477.4497 3325.28693   174%     -   20s
     0     0 3312.46291    0  520 -4477.4497 3312.46291   174%     -   21s
     0     0 3310.63285    0  509 -4477.4497 3310.63285   174%     -   21s
     0     0 3308.96328    0  514 -4477.4497 3308.96328   174%     -   21s
     0     0 3308.81530    0  519 -4477.4497 3308.81530   174%     -   21s
     0     0 3216.67079    0  574 -4477.4497 3216.67079   172%     -   22s
H    0     0                    -4318.421869 3215.52360   174%     -   22s
     0     0 3189.33984    0  575 -4318.4219 3189.33984   174%     -   22s
     0     0 3159.33982    0  586 -4318.4219 3159.33982   173%     -   23s
     0     0 3155.18394    0  587 -4318.4219 3155.18394   173%     -   23s
     0     0 3153.71435    0  580 -4318.4219 3153.71435   173%     -   23s
H    0     0                    -4204.278813 3151.75489   175%     -   23s
     0     0 3151.75489    0  586 -4204.2788 3151.75489   175%     -   23s
H    0     0                    -4134.428959 3151.18160   176%     -   23s
H    0     0                    -4111.968400 3151.18160   177%     -   23s
H    0     0                    -4095.987683 3151.18160   177%     -   23s
     0     0 3151.18160    0  586 -4095.9877 3151.18160   177%     -   23s
     0     0 3092.26113    0  581 -4095.9877 3092.26113   175%     -   24s
H    0     0                    -3994.673946 3092.05047   177%     -   24s
H    0     0                    -3960.680172 3092.05047   178%     -   24s
     0     0 3079.52779    0  528 -3960.6802 3079.52779   178%     -   25s
     0     0 3075.87622    0  524 -3960.6802 3075.87622   178%     -   25s
     0     0 3074.56326    0  535 -3960.6802 3074.56326   178%     -   25s
     0     0 3073.83165    0  533 -3960.6802 3073.83165   178%     -   25s
     0     0 3031.86341    0  534 -3960.6802 3031.86341   177%     -   25s
     0     0 3028.69011    0  538 -3960.6802 3028.69011   176%     -   26s
     0     0 3027.97939    0  537 -3960.6802 3027.97939   176%     -   26s
     0     0 2952.50306    0  602 -3960.6802 2952.50306   175%     -   27s
     0     0 2916.37530    0  601 -3960.6802 2916.37530   174%     -   28s
     0     0 2910.66802    0  607 -3960.6802 2910.66802   173%     -   28s
     0     0 2904.22030    0  598 -3960.6802 2904.22030   173%     -   28s
     0     0 2901.68518    0  602 -3960.6802 2901.68518   173%     -   28s
     0     0 2900.60129    0  603 -3960.6802 2900.60129   173%     -   28s
     0     0 2846.95819    0  655 -3960.6802 2846.95819   172%     -   29s
     0     0 2835.99650    0  660 -3960.6802 2835.99650   172%     -   30s
     0     0 2832.31974    0  667 -3960.6802 2832.31974   172%     -   30s
     0     0 2831.53622    0  619 -3960.6802 2831.53622   171%     -   30s
     0     0 2821.25798    0  619 -3960.6802 2821.25798   171%     -   30s
     0     0 2812.07680    0  623 -3960.6802 2812.07680   171%     -   31s
     0     0 2811.58530    0  625 -3960.6802 2811.58530   171%     -   31s
     0     0 2786.29005    0  626 -3960.6802 2786.29005   170%     -   31s
     0     0 2780.20725    0  628 -3960.6802 2780.20725   170%     -   32s
     0     0 2777.62164    0  629 -3960.6802 2777.62164   170%     -   32s
     0     0 2776.95837    0  635 -3960.6802 2776.95837   170%     -   32s
     0     0 2733.64162    0  616 -3960.6802 2733.64162   169%     -   32s
     0     0 2727.75673    0  612 -3960.6802 2727.75673   169%     -   33s
     0     0 2726.56525    0  620 -3960.6802 2726.56525   169%     -   33s
     0     0 2723.30626    0  623 -3960.6802 2723.30626   169%     -   34s
     0     0 2722.59339    0  623 -3960.6802 2722.59339   169%     -   34s
     0     0 2719.28502    0  620 -3960.6802 2719.28502   169%     -   34s
     0     0 2718.26100    0  623 -3960.6802 2718.26100   169%     -   34s
     0     0 2715.94552    0  622 -3960.6802 2715.94552   169%     -   35s
     0     0 2715.27909    0  622 -3960.6802 2715.27909   169%     -   35s
     0     2 2715.27909    0  622 -3960.6802 2715.27909   169%     -   41s
    15    32 2035.89734    4  655 -3960.6802 2277.54679   158%  2361   47s
H   33    56                    -3924.081623 2024.25127   152%  2399   49s
H   48    56                    -3879.296442 1829.54697   147%  2163   49s
    63    88 1619.62165    6  660 -3879.2964 1828.49834   147%  2203   51s
H  133   166                    -3873.605551 1618.60993   142%  1881   54s
   175   227  814.67096    9  576 -3873.6056 1618.60993   142%  1647   56s
H  191   227                    -3835.136814 1618.60993   142%  1660   56s
   326   305   95.57942   10  546 -3835.1368 1551.81456   140%  1548   62s
H  329   305                    -3831.277831 1551.81456   141%  1567   62s
H  338   305                    -3818.186528 1551.81456   141%  1561   62s
H  346   305                    -3801.293394 1551.81456   141%  1581   62s
   460   374 -1239.3771   11  474 -3801.2934 1551.81456   141%  1515   67s
   604   427 -1268.8235   12  478 -3801.2934  849.11348   122%  1546   72s
   750   502     cutoff   14      -3801.2934  808.21060   121%  1518   75s
   934   580 -2029.1189   17  445 -3801.2934  764.38931   120%  1386   81s
  1102   625 -2184.7878   21  341 -3801.2934  687.00619   118%  1285   85s
  1396   628     cutoff   27      -3801.2934  643.96679   117%  1189   92s
  1579   646     cutoff   12      -3801.2934  643.96679   117%  1169   96s
  1796   671 -3514.0831   11  288 -3801.2934  643.96679   117%  1133  102s
  1889   669 -3643.0090   12  168 -3801.2934  378.81735   110%  1128  105s
  2119   673 -3626.1326   10  295 -3801.2934  244.38765   106%  1099  111s
  2291   648 -2970.3332   10  334 -3801.2934 -106.88233  97.2%  1088  117s
  2444   649     cutoff   17      -3801.2934 -157.52963  95.9%  1069  121s
  2811   565 infeasible   17      -3801.2934 -562.48153  85.2%  1030  128s
  2984   528 -3585.3395   14  354 -3801.2934 -1001.8441  73.6%  1021  132s
  3212   426 infeasible   15      -3801.2934 -1001.8441  73.6%   996  135s
  3716   201 -2268.2879   19  445 -3801.2934 -1795.5797  52.8%   935  142s
  4340     0     cutoff   14      -3801.2934 -2306.4163  39.3%   854  145s

Cutting planes:
  Learned: 2
  Cover: 1
  Implied bound: 15
  MIR: 387
  Flow cover: 631
  Zero half: 13
  RLT: 31
  Relax-and-lift: 15

Explored 4372 nodes (3791540 simplex iterations) in 145.32 seconds (412.04 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -3801.29 -3818.19 -3831.28 ... -4095.99
No other solutions better than -3801.29

Optimal solution found (tolerance 1.00e-04)
Best objective -3.801293393558e+03, best bound -3.801293393558e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 145.33s
  Master Objective (UB) = -3801.29, θ = 112494.41
  Upper Bound (UB) = -3801.29

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 112494.41
  [DEBUG]   ✓ Scenario 0: θ = 112494.41 ≤ Q = 112494.41 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 112494.41 ≤ Q = 112494.41 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 112494.41 ≤ Q = 112494.41 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0xa3212a4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x0a3212a4
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.189887e+13
Presolve removed 2602 rows and 1895 columns
Presolve time: 0.00s
Presolved: 491 rows, 494 columns, 1384 nonzeros
Found heuristic solution: objective 5992172.4704
Variable types: 334 continuous, 160 integer (160 binary)

Root relaxation: objective -1.291002e+05, 244 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -129100.18    0  128 5992172.47 -129100.18   102%     -    0s
H    0     0                    -93278.51426 -129100.18  38.4%     -    0s
H    0     0                    -101252.9917 -129100.18  27.5%     -    0s
H    0     0                    -113073.3730 -129100.18  14.2%     -    0s
     0     0 -116957.44    0   67 -113073.37 -116957.44  3.43%     -    0s
H    0     0                    -115001.9824 -116895.12  1.65%     -    0s
     0     0 -116541.63    0   62 -115001.98 -116541.63  1.34%     -    0s
     0     0 -116516.40    0   62 -115001.98 -116516.40  1.32%     -    0s
     0     0 -116099.48    0   39 -115001.98 -116099.48  0.95%     -    0s
H    0     0                    -115526.1243 -116083.13  0.48%     -    0s
     0     0 -115944.15    0   42 -115526.12 -115944.15  0.36%     -    0s
     0     0 -115934.54    0   42 -115526.12 -115934.54  0.35%     -    0s
     0     0 -115921.99    0   41 -115526.12 -115921.99  0.34%     -    0s
     0     0 -115708.44    0   16 -115526.12 -115708.44  0.16%     -    0s
     0     0 -115707.32    0   14 -115526.12 -115707.32  0.16%     -    0s
H    0     0                    -115559.1405 -115698.55  0.12%     -    0s
     0     0 -115650.20    0    8 -115559.14 -115650.20  0.08%     -    0s
     0     0 -115624.28    0    8 -115559.14 -115624.28  0.06%     -    0s
     0     0 -115624.28    0    9 -115559.14 -115624.28  0.06%     -    0s
H    0     0                    -115612.2737 -115624.28  0.01%     -    0s

Cutting planes:
  Implied bound: 4
  MIR: 3
  RLT: 3

Explored 1 nodes (681 simplex iterations) in 0.10 seconds (0.04 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -115612 -115559 -115526 ... 1.18989e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.156122737071e+05, best bound -1.156198646694e+05, gap 0.0066%
  Subproblem solved in 0.12s
  Worst-case operational profit (Z_SP) = 91003.56
  Scenario: 36 demand increases, 24 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -115612.27
  [DEBUG]   S×d_nominal = 206615.83
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 206615.83 + -115612.27 = 91003.56
  [DEBUG]   Current θ from Master = 112494.41
  [DEBUG]   ⚠️  Z_SP ≤ θ by 21490.85 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -25292.14
  Lower Bound (LB) = -10288.62
  Gap (UB-LB) = 6487.3303, Absolute Gap = 6487.3303, Relative Gap = 1.706611
  Not converged yet (gap = 6487.33 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 36 increases, 24 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178443 nonzeros
Model fingerprint: 0xdc96edd3
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [9e-02, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -25292.1 (0.04s)
Loaded MIP start from previous solve with objective -25292.1

Presolve removed 28340 rows and 11510 columns
Presolve time: 0.45s
Presolved: 34203 rows, 15710 columns, 211379 nonzeros
Variable types: 13451 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 34203 rows, 15710 columns, 211379 nonzeros

Concurrent spin time: 0.16s

Solved with dual simplex

Root relaxation: objective 1.266800e+04, 21124 iterations, 4.50 seconds (9.87 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 12667.9989    0  268 -25292.144 12667.9989   150%     -    5s
H    0     0                    -17757.78916 12667.9989   171%     -    5s
H    0     0                    -15358.29703 12667.9989   182%     -    5s
H    0     0                    -15142.96536 12667.9989   184%     -    5s
H    0     0                    -13705.35562 12667.9989   192%     -    5s
H    0     0                    -13607.50314 12667.9989   193%     -    5s
H    0     0                    -6785.848186 12667.9989   287%     -    5s
H    0     0                    -4754.761417 12667.9989   366%     -    5s
H    0     0                    -4740.692918 8255.93146   274%     -    9s
H    0     0                    -4729.765054 8255.93146   275%     -    9s
     0     0 8255.93146    0  354 -4729.7651 8255.93146   275%     -    9s
H    0     0                    -4576.157124 8245.74335   280%     -    9s
     0     0 7890.81369    0  292 -4576.1571 7890.81369   272%     -    9s
     0     0 7784.88048    0  353 -4576.1571 7784.88048   270%     -   10s
     0     0 7784.88048    0  349 -4576.1571 7784.88048   270%     -   10s
     0     0 7748.32486    0  359 -4576.1571 7748.32486   269%     -   10s
     0     0 7748.32486    0  357 -4576.1571 7748.32486   269%     -   10s
     0     0 7748.32486    0  357 -4576.1571 7748.32486   269%     -   11s
     0     0 6143.72974    0  419 -4576.1571 6143.72974   234%     -   13s
H    0     0                    -4566.607249 6143.06561   235%     -   13s
     0     0 6014.97918    0  423 -4566.6072 6014.97918   232%     -   14s
     0     0 5952.16372    0  428 -4566.6072 5952.16372   230%     -   15s
     0     0 5922.16738    0  435 -4566.6072 5922.16738   230%     -   15s
     0     0 5913.53025    0  439 -4566.6072 5913.53025   229%     -   15s
     0     0 5886.27466    0  439 -4566.6072 5886.27466   229%     -   15s
     0     0 5883.59758    0  441 -4566.6072 5883.59758   229%     -   16s
     0     0 5883.47865    0  439 -4566.6072 5883.47865   229%     -   16s
     0     0 4916.04826    0  455 -4566.6072 4916.04826   208%     -   20s
H    0     0                    -4482.358101 4420.36807   199%     -   22s
H    0     0                    -4476.667209 4420.36807   199%     -   22s
H    0     0                    -4472.808226 4420.36807   199%     -   22s
H    0     0                    -4420.893907 4420.36807   200%     -   22s
H    0     0                    -4417.034923 4420.36807   200%     -   22s
H    0     0                    -4415.203015 4420.36807   200%     -   22s
H    0     0                    -4411.344031 4420.36807   200%     -   22s
     0     0 4420.36807    0  466 -4411.3440 4420.36807   200%     -   22s
     0     0 4351.98942    0  461 -4411.3440 4351.98942   199%     -   23s
     0     0 4315.62149    0  464 -4411.3440 4315.62149   198%     -   24s
     0     0 4303.77967    0  473 -4411.3440 4303.77967   198%     -   24s
     0     0 4298.41471    0  478 -4411.3440 4298.41471   197%     -   24s
     0     0 4292.90933    0  472 -4411.3440 4292.90933   197%     -   24s
     0     0 4292.64488    0  472 -4411.3440 4292.64488   197%     -   24s
H    0     0                    -4376.091042 3726.67271   185%     -   28s
     0     0 3726.67271    0  503 -4376.0910 3726.67271   185%     -   28s
H    0     0                    -4342.677277 3724.17927   186%     -   28s
H    0     0                    -4336.986385 3724.17927   186%     -   28s
H    0     0                    -4331.907919 3724.17927   186%     -   28s
H    0     0                    -4316.374870 3724.17927   186%     -   28s
H    0     0                    -4305.626828 3411.67995   179%     -   30s
H    0     0                    -4272.563600 3411.67995   180%     -   30s
H    0     0                    -4261.517631 3411.67995   180%     -   30s
     0     0 3411.67995    0  499 -4261.5176 3411.67995   180%     -   30s
     0     0 3315.95574    0  509 -4261.5176 3315.95574   178%     -   31s
     0     0 3295.04373    0  505 -4261.5176 3295.04373   177%     -   31s
     0     0 3277.84840    0  507 -4261.5176 3277.84840   177%     -   32s
     0     0 3274.20999    0  503 -4261.5176 3274.20999   177%     -   32s
     0     0 3272.89028    0  512 -4261.5176 3272.89028   177%     -   32s
     0     0 3272.04253    0  507 -4261.5176 3272.04253   177%     -   32s
     0     0 3118.69844    0  501 -4261.5176 3118.69844   173%     -   34s
H    0     0                    -4169.550017 3117.84935   175%     -   34s
H    0     0                    -4137.323417 3117.84935   175%     -   34s
     0     0 3086.43277    0  508 -4137.3234 3086.43277   175%     -   35s
     0     0 3072.24592    0  502 -4137.3234 3072.24592   174%     -   35s
     0     0 3069.99030    0  509 -4137.3234 3069.99030   174%     -   35s
     0     0 3069.09804    0  512 -4137.3234 3069.09804   174%     -   35s
     0     0 2901.38555    0  570 -4137.3234 2901.38555   170%     -   37s
     0     0 2880.85158    0  568 -4137.3234 2880.85158   170%     -   38s
     0     0 2865.81432    0  572 -4137.3234 2865.81432   169%     -   38s
     0     0 2843.84601    0  576 -4137.3234 2843.84601   169%     -   38s
     0     0 2839.43342    0  578 -4137.3234 2839.43342   169%     -   39s
     0     0 2838.01056    0  589 -4137.3234 2838.01056   169%     -   39s
     0     0 2837.48435    0  593 -4137.3234 2837.48435   169%     -   39s
     0     0 2806.11287    0  585 -4137.3234 2806.11287   168%     -   40s
     0     0 2792.68532    0  592 -4137.3234 2792.68532   167%     -   40s
     0     0 2787.25502    0  599 -4137.3234 2787.25502   167%     -   40s
     0     0 2786.21546    0  599 -4137.3234 2786.21546   167%     -   40s
     0     0 2742.13774    0  598 -4137.3234 2742.13774   166%     -   42s
     0     0 2729.70170    0  606 -4137.3234 2729.70170   166%     -   43s
     0     0 2725.00594    0  615 -4137.3234 2725.00594   166%     -   43s
     0     0 2724.20594    0  616 -4137.3234 2724.20594   166%     -   43s
     0     0 2709.64237    0  606 -4137.3234 2709.64237   165%     -   44s
     0     0 2706.58296    0  617 -4137.3234 2706.58296   165%     -   45s
     0     0 2704.24856    0  617 -4137.3234 2704.24856   165%     -   45s
     0     0 2703.66674    0  622 -4137.3234 2703.66674   165%     -   45s
     0     0 2683.88017    0  620 -4137.3234 2683.88017   165%     -   46s
     0     0 2681.03141    0  556 -4137.3234 2681.03141   165%     -   47s
     0     0 2680.36770    0  554 -4137.3234 2680.36770   165%     -   47s
     0     0 2667.06361    0  559 -4137.3234 2667.06361   164%     -   48s
     0     0 2665.13133    0  566 -4137.3234 2665.13133   164%     -   48s
     0     0 2664.91118    0  561 -4137.3234 2664.91118   164%     -   48s
     0     0 2659.95960    0  560 -4137.3234 2659.95960   164%     -   49s
H    0     0                    -4107.206141 2659.40450   165%     -   50s
     0     0 2659.23835    0  567 -4107.2061 2659.23835   165%     -   50s
     0     0 2652.13232    0  560 -4107.2061 2652.13232   165%     -   51s
     0     0 2649.73601    0  549 -4107.2061 2649.73601   165%     -   52s
     0     0 2649.05959    0  560 -4107.2061 2649.05959   164%     -   52s
     0     0 2643.55738    0  563 -4107.2061 2643.55738   164%     -   52s
     0     0 2643.37594    0  563 -4107.2061 2643.37594   164%     -   53s
     0     2 2643.13197    0  563 -4107.2061 2643.13197   164%     -   69s
     1     4 2584.61147    1  558 -4107.2061 2642.37774   164%  1568   70s
    15    30 2404.92748    4  544 -4107.2061 2433.94101   159%  2471   77s
    31    56 2120.26822    5  616 -4107.2061 2404.89631   159%  3456   80s
    93   152 1835.26209    7  611 -4107.2061 1892.28440   146%  2342   86s
   234   272 1103.22206    9  510 -4107.2061 1892.28440   146%  2103   91s
   303   295     cutoff    9      -4107.2061 1892.28440   146%  1868   95s
   376   368 -433.76526   11  463 -4107.2061 1892.28440   146%  1772  101s
   477   446 -531.12736   13  389 -4107.2061 1892.28440   146%  1597  107s
   588   522 -750.35396   15  394 -4107.2061 1892.28440   146%  1466  112s
   654   550 -1099.4917   16  431 -4107.2061 1892.28440   146%  1398  116s
   803   624 -2472.8747   17  222 -4107.2061 1593.75375   139%  1326  122s
   877   674 -2002.2753   17  401 -4107.2061 1593.75375   139%  1299  125s
  1018   712 -2196.9262   19  339 -4107.2061 1593.75375   139%  1259  131s
  1087   737 -3352.5086   20  313 -4107.2061 1354.51562   133%  1255  135s
  1209   809     cutoff   21      -4107.2061 1201.34221   129%  1234  142s
  1295   861     cutoff   19      -4107.2061 1201.34221   129%  1220  147s
  1395   928 infeasible   12      -4107.2061 1067.63619   126%  1202  151s
  1521   974  411.31351    9  599 -4107.2061  958.55530   123%  1172  156s
  1660  1047  165.50012   11  495 -4107.2061  958.55530   123%  1161  161s
  1809  1093  -71.80507   13  439 -4107.2061  958.55530   123%  1136  166s
  1978  1181 -1039.1287   16  253 -4107.2061  685.32039   117%  1113  170s
  2214  1275 -1714.1450   21  319 -4107.2061  685.32039   117%  1094  178s
  2370  1381 -2552.1670   29  314 -4107.2061  685.32039   117%  1078  181s
  2542  1449 -3165.0041   32  254 -4107.2061  685.32039   117%  1057  186s
  2751  1500 -1022.8001   12  465 -4107.2061  321.36855   108%  1034  190s
  3085  1642 -2391.7924   17  366 -4107.2061   61.51342   101%  1021  200s
  3445  1734 -2926.1458   15  172 -4107.2061 -131.75762  96.8%  1001  209s
  3645  1771     cutoff   20      -4107.2061 -166.41629  95.9%   998  213s
  3836  1840 -1146.8122   20  396 -4107.2061 -217.02600  94.7%   994  218s
  4042  1881 -2236.3589   24  380 -4107.2061 -244.38085  94.0%   989  223s
  4275  1990 -3137.1994   30  271 -4107.2061 -315.01814  92.3%   983  229s
  4490  2044     cutoff   40      -4107.2061 -440.03896  89.3%   985  234s
  4725  2095 -1418.8632   18  412 -4107.2061 -487.79646  88.1%   976  239s
  4939  2158 -2273.2379   22  348 -4107.2061 -510.05390  87.6%   979  245s
  5201  2222 -3198.0875   29  407 -4107.2061 -609.11332  85.2%   979  252s
  5483  2231 -2592.0855   16  126 -4107.2061 -665.23764  83.8%   976  256s
  5538  2243 -3759.9871   17  234 -4107.2061 -747.25212  81.8%   978  260s
  5599  2274     cutoff   18      -4107.2061 -747.25212  81.8%   978  265s
  5666  2321     cutoff   18      -4107.2061 -747.25212  81.8%   979  270s
  5802  2361 -2459.7875   17  266 -4107.2061 -747.25212  81.8%   976  276s
  5964  2453 infeasible   18      -4107.2061 -752.02484  81.7%   977  283s
  6300  2454 -1928.5014   18  563 -4107.2061 -812.52905  80.2%   968  302s
  6302  2455 -3332.6012   19  268 -4107.2061 -812.52905  80.2%   967  311s
  6303  2456 -2878.5833   22  461 -4107.2061 -812.52905  80.2%   967  318s
  6304  2457 -2392.1568   18  514 -4107.2061 -812.52905  80.2%   967  322s
  6305  2457 -3934.2779   23  506 -4107.2061 -812.52905  80.2%   967  326s
  6307  2459 -1327.5864   18  614 -4107.2061 -812.52905  80.2%   967  331s
  6310  2461 -1288.4486   11  518 -4107.2061 -812.52905  80.2%   966  335s
  6314  2463 -3660.6994   19  582 -4107.2061 -812.52905  80.2%   966  340s
  6317  2465 -3034.1180   12  620 -4107.2061 -812.52905  80.2%   965  345s
  6321  2468 -2971.5582   23  667 -4107.2061 -812.52905  80.2%   965  350s
  6324  2470 -3362.3500   13  635 -4107.2061 -812.52905  80.2%   964  356s
  6326  2471 -3443.8591   21  626 -4107.2061 -812.52905  80.2%   964  368s
  6327  2472 -1014.0334   14  626 -4107.2061 -812.52905  80.2%   964  374s
  6328  2476 -812.52905   12  546 -4107.2061 -812.52905  80.2%   980  378s
  6330  2479 -812.52905   13  552 -4107.2061 -812.52905  80.2%   981  383s
  6334  2486 -812.52905   14  555 -4107.2061 -812.52905  80.2%   982  386s
  6358  2524 -812.52905   16  479 -4107.2061 -812.52905  80.2%   997  394s
  6390  2545 -812.52905   17  538 -4107.2061 -812.52905  80.2%  1002  397s
  6422  2526 -2378.0606   18  512 -4107.2061 -812.52905  80.2%  1018  403s
  6471  2538 -2632.7168   19  513 -4107.2061 -812.52905  80.2%  1049  406s
  6589  2539 -3050.6099   21  450 -4107.2061 -812.52905  80.2%  1062  414s
  6677  2523 -3091.0213   22  530 -4107.2061 -812.52905  80.2%  1064  417s
  6747  2520 -3452.1425   22  505 -4107.2061 -812.52905  80.2%  1071  421s
  6905  2475 -3939.7346   24  346 -4107.2061 -812.52905  80.2%  1073  427s
  6986  2455     cutoff   25      -4107.2061 -812.52905  80.2%  1073  431s
  7101  2448 -3853.4016   25  453 -4107.2061 -812.52905  80.2%  1079  437s
  7152  2442     cutoff   25      -4107.2061 -812.52905  80.2%  1082  440s
  7286  2404 -2318.8323   19  349 -4107.2061 -1190.4037  71.0%  1085  446s
  7460  2343 -3492.6988   21  371 -4107.2061 -1190.4037  71.0%  1084  453s
  7564  2291 -3567.1445   22  373 -4107.2061 -1190.4037  71.0%  1082  457s
  7669  2209     cutoff   24      -4107.2061 -1190.4037  71.0%  1084  461s
  7775  2152 -3277.8597   33  233 -4107.2061 -1190.4037  71.0%  1079  465s
  7998  2007 -3561.5719   23  343 -4107.2061 -2161.9011  47.4%  1073  473s
  8132  1911     cutoff   24      -4107.2061 -2300.4739  44.0%  1068  476s
  8457  1762 -4085.0006   42    8 -4107.2061 -4083.3877  0.58%  1040  480s

Cutting planes:
  MIR: 334
  Flow cover: 673
  Zero half: 8
  RLT: 19
  Relax-and-lift: 29

Explored 8470 nodes (8909959 simplex iterations) in 480.35 seconds (1327.82 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -4107.21 -4137.32 -4169.55 ... -4342.68
No other solutions better than -4107.21

Optimal solution found (tolerance 1.00e-04)
Best objective -4.107206141309e+03, best bound -4.107206141309e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 480.36s
  Master Objective (UB) = -4107.21, θ = 112108.00
  Upper Bound (UB) = -4107.21

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 112108.00
  [DEBUG]   ✓ Scenario 0: θ = 112108.00 ≤ Q = 112108.00 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 112108.00 ≤ Q = 112108.00 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 112108.00 ≤ Q = 112108.00 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 112108.00 ≤ Q = 112108.00 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x116dcd85
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xee92327b
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.183916e+13
Presolve removed 2608 rows and 1900 columns
Presolve time: 0.00s
Presolved: 485 rows, 489 columns, 1368 nonzeros
Found heuristic solution: objective 5865558.8416
Variable types: 330 continuous, 159 integer (159 binary)

Root relaxation: objective -1.252339e+05, 231 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -125233.93    0  120 5865558.84 -125233.93   102%     -    0s
H    0     0                    -93053.86024 -125233.93  34.6%     -    0s
H    0     0                    -93756.66603 -124990.98  33.3%     -    0s
     0     0 -107633.77    0  121 -93756.666 -107633.77  14.8%     -    0s
H    0     0                    -103345.6595 -107506.81  4.03%     -    0s
H    0     0                    -104138.3184 -107506.81  3.23%     -    0s
     0     0 -106551.88    0  123 -104138.32 -106551.88  2.32%     -    0s
H    0     0                    -104320.2904 -106524.05  2.11%     -    0s
     0     0 -106080.20    0  126 -104320.29 -106080.20  1.69%     -    0s
H    0     0                    -104343.4187 -106049.89  1.64%     -    0s
     0     0 -106019.69    0  126 -104343.42 -106019.69  1.61%     -    0s
     0     0 -105714.38    0  110 -104343.42 -105714.38  1.31%     -    0s
     0     0 -105669.63    0  109 -104343.42 -105669.63  1.27%     -    0s
     0     0 -105554.90    0  112 -104343.42 -105554.90  1.16%     -    0s
     0     0 -105521.92    0  112 -104343.42 -105521.92  1.13%     -    0s
     0     2 -105513.57    0  112 -104343.42 -105513.57  1.12%     -    0s
H   47    42                    -104356.5967 -104997.70  0.61%  15.0    0s
H  494   209                    -104365.6828 -104843.57  0.46%   6.3    0s
H  500   209                    -104391.2561 -104843.57  0.43%   6.3    0s
H 1680   276                    -104417.3556 -104638.36  0.21%   5.8    0s

Cutting planes:
  Gomory: 67
  Implied bound: 3
  MIR: 221
  RLT: 12
  BQP: 2

Explored 2306 nodes (13241 simplex iterations) in 0.23 seconds (0.23 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -104417 -104391 -104366 ... 5.86556e+06
No other solutions better than -104417

Optimal solution found (tolerance 1.00e-04)
Best objective -1.044173555966e+05, best bound -1.044173555966e+05, gap 0.0000%
  Subproblem solved in 0.25s
  Worst-case operational profit (Z_SP) = 102547.63
  Scenario: 32 demand increases, 28 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -104417.36
  [DEBUG]   S×d_nominal = 206964.98
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 206964.98 + -104417.36 = 102547.63
  [DEBUG]   Current θ from Master = 112108.00
  [DEBUG]   ⚠️  Z_SP ≤ θ by 9560.37 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -13667.57
  Lower Bound (LB) = -10288.62
  Gap (UB-LB) = 6181.4175, Absolute Gap = 6181.4175, Relative Gap = 1.505018
  Not converged yet (gap = 6181.42 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 32 increases, 28 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221674 nonzeros
Model fingerprint: 0x530568a7
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [9e-02, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 35430 rows and 14390 columns
Presolve time: 0.57s
Presolved: 42403 rows, 19070 columns, 262829 nonzeros
Variable types: 16811 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -371500.8959
Found heuristic solution: objective -161448.0454

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 42403 rows, 19070 columns, 262829 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   31326    6.0734469e+03   0.000000e+00   3.292306e+05      5s
   42636    1.0667170e+04   0.000000e+00   9.215749e+07     10s
Concurrent spin time: 2.32s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 1.266800e+04, 34810 iterations, 10.77 seconds (22.95 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 12667.9989    0  268 -161448.05 12667.9989   108%     -   11s
H    0     0                    -143693.2064 12667.9989   109%     -   11s
H    0     0                    -33757.15234 12667.9989   138%     -   11s
H    0     0                    -33713.99920 12667.9989   138%     -   11s
H    0     0                    -33620.69796 12667.9989   138%     -   11s
H    0     0                    -12217.63831 12667.9989   204%     -   11s
H    0     0                    -11593.86542 12667.9989   209%     -   11s
H    0     0                    -11390.28735 8549.80358   175%     -   16s
H    0     0                    -10687.76274 8549.80358   180%     -   16s
     0     0 8546.36380    0  367 -10687.763 8546.36380   180%     -   16s
     0     0 7995.63355    0  356 -10687.763 7995.63355   175%     -   19s
     0     0 7930.07944    0  350 -10687.763 7930.07944   174%     -   19s
     0     0 7930.07944    0  349 -10687.763 7930.07944   174%     -   20s
     0     0 7930.07944    0  352 -10687.763 7930.07944   174%     -   20s
     0     0 7930.07944    0  352 -10687.763 7930.07944   174%     -   20s
H    0     0                    -10128.76679 6072.49395   160%     -   24s
H    0     0                    -9927.447256 6072.49395   161%     -   24s
     0     0 6072.49395    0  423 -9927.4473 6072.49395   161%     -   24s
H    0     0                    -9710.729107 6072.42416   163%     -   25s
     0     0 5727.84423    0  408 -9710.7291 5727.84423   159%     -   27s
     0     0 5682.05060    0  417 -9710.7291 5682.05060   159%     -   27s
     0     0 5628.76421    0  422 -9710.7291 5628.76421   158%     -   28s
     0     0 5617.11886    0  426 -9710.7291 5617.11886   158%     -   28s
     0     0 5615.52144    0  426 -9710.7291 5615.52144   158%     -   28s
     0     0 5615.38891    0  427 -9710.7291 5615.38891   158%     -   28s
     0     0 4407.72535    0  470 -9710.7291 4407.72535   145%     -   35s
     0     0 4179.22980    0  480 -9710.7291 4179.22980   143%     -   37s
     0     0 4108.40634    0  484 -9710.7291 4108.40634   142%     -   38s
     0     0 4076.20093    0  488 -9710.7291 4076.20093   142%     -   39s
     0     0 4054.48943    0  494 -9710.7291 4054.48943   142%     -   40s
     0     0 4049.96180    0  493 -9710.7291 4049.96180   142%     -   40s
     0     0 4046.27598    0  490 -9710.7291 4046.27598   142%     -   40s
     0     0 4045.14171    0  495 -9710.7291 4045.14171   142%     -   40s
     0     0 4044.83685    0  494 -9710.7291 4044.83685   142%     -   40s
     0     0 3421.51437    0  499 -9710.7291 3421.51437   135%     -   45s
H    0     0                    -9700.190979 3421.37790   135%     -   45s
     0     0 3242.56321    0  517 -9700.1910 3242.56321   133%     -   47s
H    0     0                    -9668.709853 3137.81751   132%     -   49s
     0     0 3137.81751    0  523 -9668.7099 3137.81751   132%     -   49s
     0     0 3097.88104    0  540 -9668.7099 3097.88104   132%     -   50s
     0     0 3063.16929    0  572 -9668.7099 3063.16929   132%     -   51s
     0     0 3044.63554    0  587 -9668.7099 3044.63554   131%     -   52s
     0     0 3036.25325    0  575 -9668.7099 3036.25325   131%     -   52s
     0     0 3029.41391    0  588 -9668.7099 3029.41391   131%     -   53s
     0     0 3026.22101    0  588 -9668.7099 3026.22101   131%     -   53s
     0     0 3025.97089    0  588 -9668.7099 3025.97089   131%     -   53s
H    0     0                    -8483.804972 2887.05278   134%     -   56s
H    0     0                    -8231.211731 2887.05278   135%     -   56s
H    0     0                    -7950.010400 2887.05278   136%     -   56s
H    0     0                    -5947.593090 2887.05278   149%     -   56s
H    0     0                    -5947.213521 2887.05278   149%     -   56s
H    0     0                    -5816.282803 2887.05278   150%     -   56s
H    0     0                    -5738.590029 2887.05278   150%     -   56s
H    0     0                    -5613.427875 2887.05278   151%     -   56s
H    0     0                    -5611.595967 2887.05278   151%     -   56s
H    0     0                    -5598.944903 2887.05278   152%     -   56s
     0     0 2887.05278    0  535 -5598.9449 2887.05278   152%     -   56s
H    0     0                    -5514.467377 2886.80708   152%     -   56s
H    0     0                    -5462.320283 2886.80708   153%     -   56s
H    0     0                    -5450.463413 2886.80708   153%     -   56s
     0     0 2855.32778    0  592 -5450.4634 2855.32778   152%     -   57s
     0     0 2818.33358    0  590 -5450.4634 2818.33358   152%     -   58s
     0     0 2792.27446    0  540 -5450.4634 2792.27446   151%     -   60s
     0     0 2784.83611    0  540 -5450.4634 2784.83611   151%     -   61s
     0     0 2783.69071    0  534 -5450.4634 2783.69071   151%     -   61s
     0     0 2671.70941    0  537 -5450.4634 2671.70941   149%     -   63s
H    0     0                    -5419.088833 2671.65902   149%     -   64s
H    0     0                    -5406.183118 2671.65902   149%     -   64s
     0     0 2660.88957    0  531 -5406.1831 2660.88957   149%     -   65s
     0     0 2657.58811    0  546 -5406.1831 2657.58811   149%     -   65s
     0     0 2656.26440    0  539 -5406.1831 2656.26440   149%     -   65s
     0     0 2655.96621    0  536 -5406.1831 2655.96621   149%     -   66s
     0     0 2564.81989    0  533 -5406.1831 2564.81989   147%     -   68s
     0     0 2520.05960    0  540 -5406.1831 2520.05960   147%     -   69s
     0     0 2514.11317    0  548 -5406.1831 2514.11317   147%     -   69s
     0     0 2512.09185    0  546 -5406.1831 2512.09185   146%     -   69s
     0     0 2511.79273    0  553 -5406.1831 2511.79273   146%     -   69s
     0     0 2500.79034    0  548 -5406.1831 2500.79034   146%     -   70s
H    0     0                    -5403.920691 2500.36080   146%     -   70s
H    0     0                    -5306.854737 2500.36080   147%     -   70s
H    0     0                    -5292.430443 2500.36080   147%     -   70s
     0     0 2494.46596    0  603 -5292.4304 2494.46596   147%     -   71s
     0     0 2493.50481    0  542 -5292.4304 2493.50481   147%     -   71s
     0     0 2485.96689    0  544 -5292.4304 2485.96689   147%     -   71s
     0     0 2482.22325    0  619 -5292.4304 2482.22325   147%     -   72s
     0     0 2479.31409    0  625 -5292.4304 2479.31409   147%     -   72s
     0     0 2476.44905    0  623 -5292.4304 2476.44905   147%     -   72s
     0     0 2476.32658    0  624 -5292.4304 2476.32658   147%     -   72s
     0     0 2472.03413    0  546 -5292.4304 2472.03413   147%     -   73s
     0     0 2471.19595    0  553 -5292.4304 2471.19595   147%     -   74s
     0     0 2467.45865    0  559 -5292.4304 2467.45865   147%     -   75s
     0     0 2466.82253    0  682 -5292.4304 2466.82253   147%     -   75s
     0     0 2465.08461    0  678 -5292.4304 2465.08461   147%     -   76s
H    0     0                    -5145.465104 2464.91146   148%     -   77s
     0     0 2463.74725    0  680 -5145.4651 2463.74725   148%     -   77s
     0     0 2463.52685    0  682 -5145.4651 2463.52685   148%     -   78s
     0     0 2460.32723    0  619 -5145.4651 2460.32723   148%     -   79s
     0     0 2460.05468    0  619 -5145.4651 2460.05468   148%     -   79s
H    0     0                    -5074.123083 2459.97036   148%     -   88s
H    0     0                    -5043.878504 2459.97036   149%     -   88s
H    0     0                    -4690.708221 2459.97036   152%     -   88s
H    0     2                    -4469.782129 2459.97036   155%     -   89s
     0     2 2459.97036    0  619 -4469.7821 2459.97036   155%     -   89s
     1     4 2384.04691    1  648 -4469.7821 2459.58302   155%  2371   90s
     7    16 1811.99715    3  578 -4469.7821 2329.86227   152%  3856   96s
    15    32 1578.01811    4  596 -4469.7821 2085.06906   147%  3875  102s
    31    46  602.53544    5  538 -4469.7821 1598.68592   136%  6600  111s
    47    66 -273.28380    6  398 -4469.7821 1598.68592   136%  5557  120s
H   56    66                    -4465.923146 1598.68592   136%  5367  120s
H   57    66                    -4460.232254 1598.68592   136%  5299  120s
H   58    66                    -4452.673865 1598.68592   136%  5283  120s
H   64    66                    -4410.624909 1574.30085   136%  5215  120s
H   68    66                    -4370.261036 1574.30085   136%  5128  120s
    79   142 -344.44444    7  400 -4370.2610 1483.35697   134%  4797  130s
   157   268 -658.50363    8  400 -4370.2610 1483.35697   134%  3078  137s
H  215   268                    -4339.609197 1483.35697   134%  2565  137s
   293   346     cutoff   10      -4339.6092 1483.35697   134%  2283  141s
   389   368 -739.67471   11  389 -4339.6092 1483.35697   134%  2032  147s
H  396   368                    -4335.750214 1483.35697   134%  2033  147s
H  405   368                    -4333.918306 1483.35697   134%  2004  147s
H  420   368                    -4292.900610 1483.35697   135%  2007  147s
   425   396     cutoff   11      -4292.9006 1483.35697   135%  1993  151s
   491   452 -3237.4217   11  436 -4292.9006 1483.35697   135%  1967  157s
H  511   452                    -4287.209718 1483.35697   135%  1940  157s
   585   479 -1128.6854   12  452 -4287.2097 1483.35697   135%  1868  163s
   666   499     cutoff   12      -4287.2097 1483.35697   135%  1827  168s
H  703   499                    -4261.656455 1064.92041   125%  1820  168s
   724   535 -1379.3427   14  443 -4261.6565  978.09720   123%  1829  173s
   784   563 -1850.2240   17  398 -4261.6565  978.09720   123%  1821  177s
   820   603 -1874.2928   18  295 -4261.6565  978.09720   123%  1828  182s
   882   623 -1900.2862   18  375 -4261.6565  948.11649   122%  1795  187s
   928   647 -1920.7316   19  227 -4261.6565  948.11649   122%  1785  191s
  1016   738 -2188.5826   21  356 -4261.6565  948.11649   122%  1773  200s
  1109   802 -2287.6449   23  359 -4261.6565  799.81119   119%  1728  205s
  1214   830 -2948.2282   25  273 -4261.6565  769.09568   118%  1668  210s
  1340   883 -3200.2451   27  314 -4261.6565  769.09568   118%  1604  216s
  1463   911     cutoff   27      -4261.6565  676.86038   116%  1580  222s
  1543   928     cutoff   30      -4261.6565  612.62324   114%  1574  226s
  1590   965 infeasible   30      -4261.6565  612.62324   114%  1577  232s
  1667  1018 -117.34852   11  321 -4261.6565  612.62324   114%  1568  239s
  1764  1062 -1135.6813   12  270 -4261.6565  612.62324   114%  1556  246s
  1908  1131 -1410.8757   14  278 -4261.6565  595.37531   114%  1530  251s
  2063  1205 -2802.3950   17  114 -4261.6565  408.24281   110%  1497  259s
  2210  1256     cutoff   23      -4261.6565  365.13427   109%  1487  266s
  2364  1326     cutoff   22      -4261.6565  365.13427   109%  1473  273s
  2532  1386 -1825.4140   16  339 -4261.6565  365.13427   109%  1462  279s
  2670  1505 -2840.5965   17  273 -4261.6565  272.11939   106%  1445  285s
  2869  1600 -1562.0327   17  268 -4261.6565  245.83774   106%  1410  292s
  3160  1643 -2182.7160   21  409 -4261.6565  245.83774   106%  1349  301s
  3418  1671 -3342.7938   24   86 -4261.6565  223.62866   105%  1314  309s
  3618  1701     cutoff   13      -4261.6565  223.62866   105%  1314  317s
  3795  1712     cutoff   14      -4261.6565  223.62866   105%  1321  324s
  3958  1720 infeasible   14      -4261.6565  223.62866   105%  1319  334s
  4112  1772 -2478.5943   15  352 -4261.6565   66.04839   102%  1333  342s
  4274  1783     cutoff   54      -4261.6565  -45.15420  98.9%  1347  348s
  4327  1786 -200.33487   10  423 -4261.6565  -45.15420  98.9%  1355  354s
  4396  1807 -579.67635   11  312 -4261.6565  -45.15420  98.9%  1361  359s
  4463  1834 -1643.4356   12  289 -4261.6565  -45.15420  98.9%  1365  369s
  4580  1832 -2472.6329   13  369 -4261.6565  -45.15420  98.9%  1364  379s
  4780  1869 -3969.5502   14  150 -4261.6565 -106.63402  97.5%  1358  388s
  5001  1882 -3943.8354   12  335 -4261.6565 -117.48444  97.2%  1364  398s
  5186  1905 -2061.5197    9  355 -4261.6565 -145.88020  96.6%  1364  408s
  5407  1957 -2506.4984   13  253 -4261.6565 -272.92295  93.6%  1374  418s
  5673  1973     cutoff   26      -4261.6565 -272.92295  93.6%  1377  429s
  5940  1980 -1717.1486   13  297 -4261.6565 -295.50883  93.1%  1382  440s
  6105  1995 -2975.5755   16  287 -4261.6565 -295.50883  93.1%  1389  452s
  6359  2049 -3035.7919   10  444 -4261.6565 -477.64811  88.8%  1402  464s
  6642  2050 -2632.1646   15  243 -4261.6565 -610.74538  85.7%  1409  477s
  6943  2039 -2438.1127   16  276 -4261.6565 -671.90621  84.2%  1419  490s
  7258  2022     cutoff   17      -4261.6565 -768.43026  82.0%  1423  503s
  7548  1996 -3009.6827   13  241 -4261.6565 -1025.0849  75.9%  1426  518s
  7910  1926 -3240.9919   12  140 -4261.6565 -1166.4405  72.6%  1427  533s
  8362  1886 infeasible   16      -4261.6565 -1348.0310  68.4%  1420  548s
  8766  1840 -2743.0715   18  338 -4261.6565 -1511.1719  64.5%  1421  562s
  9202  1841 -4251.0302   22  147 -4261.6565 -1636.2184  61.6%  1413  577s
  9788  1844     cutoff   15      -4261.6565 -1826.0863  57.2%  1392  594s
 10419  1804 -3505.6040   20  195 -4261.6565 -2066.9239  51.5%  1370  611s
 11215  1787 -3693.9150   27  202 -4261.6565 -2303.6965  45.9%  1335  628s
 12066  1657 -4148.3250   17  210 -4261.6565 -2554.1771  40.1%  1302  645s
 13108  1422     cutoff   24      -4261.6565 -2815.2858  33.9%  1256  660s
 14381  1160     cutoff   21      -4261.6565 -3023.8236  29.0%  1200  674s
 15839  1108     cutoff   23      -4261.6565 -3317.6801  22.2%  1140  686s
 15988   709 -4205.5379   24  256 -4261.6565 -3317.6801  22.2%  1136  698s
 17179     3     cutoff   22      -4261.6565 -3422.7504  19.7%  1086  709s

Cutting planes:
  Learned: 1
  Implied bound: 5
  MIR: 607
  Flow cover: 990
  Zero half: 11
  RLT: 42
  Relax-and-lift: 55

Explored 18543 nodes (19246065 simplex iterations) in 709.28 seconds (2149.93 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -4261.66 -4287.21 -4292.9 ... -4460.23
No other solutions better than -4261.66

Optimal solution found (tolerance 1.00e-04)
Best objective -4.261656454772e+03, best bound -4.261656454772e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 709.29s
  Master Objective (UB) = -4261.66, θ = 111902.54
  Upper Bound (UB) = -4261.66

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 111902.54
  [DEBUG]   ✓ Scenario 0: θ = 111902.54 ≤ Q = 111902.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 111902.54 ≤ Q = 111902.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 111902.54 ≤ Q = 111902.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 111902.54 ≤ Q = 111902.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 111902.54 ≤ Q = 111902.54 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x1707c27e
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x1707c27e
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [6e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.174194e+13
Presolve removed 2608 rows and 1900 columns
Presolve time: 0.00s
Presolved: 485 rows, 489 columns, 1368 nonzeros
Found heuristic solution: objective 5855630.4974
Variable types: 330 continuous, 159 integer (159 binary)

Root relaxation: objective -1.246533e+05, 231 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -124653.28    0  120 5855630.50 -124653.28   102%     -    0s
H    0     0                    -92107.98944 -124653.28  35.3%     -    0s
H    0     0                    -92328.09688 -124653.28  35.0%     -    0s
H    0     0                    -93612.64590 -124410.49  32.9%     -    0s
H    0     0                    -93792.79070 -108678.66  15.9%     -    0s
     0     0 -108678.66    0   73 -93792.791 -108678.66  15.9%     -    0s
H    0     0                    -106638.7821 -108569.43  1.81%     -    0s
     0     0 -107904.76    0   62 -106638.78 -107904.76  1.19%     -    0s
H    0     0                    -107077.9869 -107848.99  0.72%     -    0s
H    0     0                    -107190.3233 -107848.99  0.61%     -    0s
     0     0 -107846.99    0   55 -107190.32 -107846.99  0.61%     -    0s
     0     0 -107520.00    0   22 -107190.32 -107520.00  0.31%     -    0s
     0     0 -107518.81    0   20 -107190.32 -107518.81  0.31%     -    0s
     0     0 -107456.95    0   15 -107190.32 -107456.95  0.25%     -    0s
     0     0 -107456.65    0   14 -107190.32 -107456.65  0.25%     -    0s
     0     0 -107422.45    0   20 -107190.32 -107422.45  0.22%     -    0s
     0     0 -107422.28    0   19 -107190.32 -107422.28  0.22%     -    0s
     0     0 -107422.24    0   19 -107190.32 -107422.24  0.22%     -    0s
     0     0 -107329.93    0    9 -107190.32 -107329.93  0.13%     -    0s
     0     0 -107298.49    0    7 -107190.32 -107298.49  0.10%     -    0s
     0     0 -107298.26    0    7 -107190.32 -107298.26  0.10%     -    0s
     0     0 -107271.61    0    5 -107190.32 -107271.61  0.08%     -    0s
     0     0 -107271.61    0   13 -107190.32 -107271.61  0.08%     -    0s
H    0     0                    -107196.2724 -107271.61  0.07%     -    0s
H    0     0                    -107229.3645 -107271.61  0.04%     -    0s
     0     0 -107254.10    0    5 -107229.36 -107254.10  0.02%     -    0s
H    0     0                    -107242.0954 -107249.77  0.01%     -    0s

Cutting planes:
  Gomory: 2
  Implied bound: 6
  MIR: 3
  Flow cover: 6
  RLT: 2
  Relax-and-lift: 1

Explored 1 nodes (690 simplex iterations) in 0.09 seconds (0.04 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -107242 -107229 -107196 ... -93612.6

Optimal solution found (tolerance 1.00e-04)
Best objective -1.072420954422e+05, best bound -1.072497680103e+05, gap 0.0072%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 98970.63
  Scenario: 34 demand increases, 26 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -107242.10
  [DEBUG]   S×d_nominal = 206212.72
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 206212.72 + -107242.10 = 98970.63
  [DEBUG]   Current θ from Master = 111902.54
  [DEBUG]   ⚠️  Z_SP ≤ θ by 12931.91 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -17193.57
  Lower Bound (LB) = -10288.62
  Gap (UB-LB) = 6026.9672, Absolute Gap = 6026.9672, Relative Gap = 1.414231
  Not converged yet (gap = 6026.97 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 34 increases, 26 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 264905 nonzeros
Model fingerprint: 0x7d4c6dda
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [9e-02, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 42500 rows and 17260 columns
Presolve time: 0.67s
Presolved: 50623 rows, 22440 columns, 314339 nonzeros
Variable types: 20181 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -371500.8959
Found heuristic solution: objective -161448.0454

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 50623 rows, 22440 columns, 314339 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   32827   -2.1543826e+03   0.000000e+00   1.459238e+07      5s
   44688    3.2490122e+03   0.000000e+00   4.339345e+06     10s
Concurrent spin time: 3.20s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 1.266800e+04, 42263 iterations, 13.54 seconds (28.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 12667.9989    0  268 -161448.05 12667.9989   108%     -   14s
H    0     0                    -155731.6580 12667.9989   108%     -   14s
H    0     0                    -85144.20070 12667.9989   115%     -   14s
H    0     0                    -66135.98136 12667.9989   119%     -   14s
H    0     0                    -65158.40838 12667.9989   119%     -   14s
H    0     0                    -64962.39791 12667.9989   120%     -   14s
H    0     0                    -52477.07788 12667.9989   124%     -   14s
H    0     0                    -45425.93059 12667.9989   128%     -   14s
H    0     0                    -44798.44252 12667.9989   128%     -   14s
H    0     0                    -41559.92842 12667.9989   130%     -   15s
H    0     0                    -40742.96274 12667.9989   131%     -   15s
H    0     0                    -10134.82385 8531.58578   184%     -   22s
     0     0 8000.88896    0  367 -10134.824 8000.88896   179%     -   23s
H    0     0                    -9825.881178 8000.88896   181%     -   23s
     0     0 7777.58242    0  366 -9825.8812 7777.58242   179%     -   27s
     0     0 7777.58242    0  352 -9825.8812 7777.58242   179%     -   29s
     0     0 7777.58242    0  354 -9825.8812 7777.58242   179%     -   29s
     0     0 7777.58242    0  352 -9825.8812 7777.58242   179%     -   30s
     0     0 7777.58242    0  359 -9825.8812 7777.58242   179%     -   30s
     0     0 5924.89133    0  429 -9825.8812 5924.89133   160%     -   35s
H    0     0                    -9794.400053 5924.89133   160%     -   36s
     0     0 5789.00812    0  446 -9794.4001 5789.00812   159%     -   37s
     0     0 5618.92453    0  447 -9794.4001 5618.92453   157%     -   39s
     0     0 5486.51221    0  440 -9794.4001 5486.51221   156%     -   41s
     0     0 5465.55321    0  438 -9794.4001 5465.55321   156%     -   41s
     0     0 5458.41018    0  445 -9794.4001 5458.41018   156%     -   41s
     0     0 5457.57803    0  445 -9794.4001 5457.57803   156%     -   41s
     0     0 5439.69843    0  445 -9794.4001 5439.69843   156%     -   42s
     0     0 5439.66985    0  447 -9794.4001 5439.66985   156%     -   42s
     0     0 4460.30326    0  469 -9794.4001 4460.30326   146%     -   47s
H    0     0                    -9471.268814 4455.25115   147%     -   47s
H    0     0                    -8883.219208 4455.25115   150%     -   47s
H    0     0                    -7787.697968 4037.55557   152%     -   50s
H    0     0                    -7636.365167 4037.55557   153%     -   50s
     0     0 4037.55557    0  542 -7636.3652 4037.55557   153%     -   50s
H    0     0                    -7544.373949 3914.34040   152%     -   52s
     0     0 3914.34040    0  542 -7544.3739 3914.34040   152%     -   52s
     0     0 3820.90189    0  554 -7544.3739 3820.90189   151%     -   53s
     0     0 3803.06817    0  546 -7544.3739 3803.06817   150%     -   54s
     0     0 3790.93131    0  539 -7544.3739 3790.93131   150%     -   55s
     0     0 3773.56047    0  545 -7544.3739 3773.56047   150%     -   56s
     0     0 3772.50279    0  551 -7544.3739 3772.50279   150%     -   56s
     0     0 3771.85575    0  549 -7544.3739 3771.85575   150%     -   56s
H    0     0                    -7279.440569 3447.58468   147%     -   61s
H    0     0                    -6831.851723 3447.58468   150%     -   61s
     0     0 3447.58468    0  523 -6831.8517 3447.58468   150%     -   61s
     0     0 3283.26350    0  531 -6831.8517 3283.26350   148%     -   63s
     0     0 3198.73429    0  536 -6831.8517 3198.73429   147%     -   65s
H    0     0                    -6784.084682 3125.75271   146%     -   67s
H    0     0                    -6730.472076 3125.75271   146%     -   67s
H    0     0                    -6679.811761 3125.75271   147%     -   67s
     0     0 3125.75271    0  528 -6679.8118 3125.75271   147%     -   67s
H    0     0                    -6524.159357 3097.58391   147%     -   68s
H    0     0                    -6460.395360 3097.58391   148%     -   68s
H    0     0                    -6456.536376 3097.58391   148%     -   68s
H    0     0                    -6424.199175 3097.58391   148%     -   68s
H    0     0                    -6402.539851 3097.58391   148%     -   68s
     0     0 3097.58391    0  534 -6402.5399 3097.58391   148%     -   68s
H    0     0                    -6382.970371 3083.93639   148%     -   69s
H    0     0                    -6294.561517 3083.93639   149%     -   69s
     0     0 3083.93639    0  599 -6294.5615 3083.93639   149%     -   69s
     0     0 3081.28105    0  600 -6294.5615 3081.28105   149%     -   69s
     0     0 3074.90304    0  602 -6294.5615 3074.90304   149%     -   70s
     0     0 3073.28961    0  607 -6294.5615 3073.28961   149%     -   71s
     0     0 3070.01818    0  603 -6294.5615 3070.01818   149%     -   71s
     0     0 3069.03819    0  604 -6294.5615 3069.03819   149%     -   71s
H    0     0                    -6017.711208 2996.29008   150%     -   73s
     0     0 2996.29008    0  603 -6017.7112 2996.29008   150%     -   73s
H    0     0                    -5964.853020 2995.49890   150%     -   73s
H    0     0                    -5744.407771 2995.49890   152%     -   73s
H    0     0                    -5681.048325 2995.49890   153%     -   73s
H    0     0                    -5672.231527 2995.49890   153%     -   73s
     0     0 2963.87407    0  521 -5672.2315 2963.87407   152%     -   75s
     0     0 2943.32573    0  605 -5672.2315 2943.32573   152%     -   75s
     0     0 2934.77700    0  550 -5672.2315 2934.77700   152%     -   76s
     0     0 2934.21901    0  547 -5672.2315 2934.21901   152%     -   76s
     0     0 2802.73627    0  618 -5672.2315 2802.73627   149%     -   79s
H    0     0                    -5570.236278 2802.65415   150%     -   79s
H    0     0                    -5496.019752 2802.65415   151%     -   79s
H    0     0                    -5459.538884 2802.65415   151%     -   79s
H    0     0                    -5453.836369 2802.65415   151%     -   79s
H    0     0                    -5412.822045 2802.65415   152%     -   79s
H    0     0                    -5408.876882 2802.65415   152%     -   79s
H    0     0                    -5380.695853 2802.65415   152%     -   79s
     0     0 2756.36755    0  613 -5380.6959 2756.36755   151%     -   81s
     0     0 2744.29823    0  626 -5380.6959 2744.29823   151%     -   82s
     0     0 2740.05645    0  631 -5380.6959 2740.05645   151%     -   82s
     0     0 2737.05655    0  638 -5380.6959 2737.05655   151%     -   83s
     0     0 2735.33917    0  636 -5380.6959 2735.33917   151%     -   83s
     0     0 2734.78010    0  566 -5380.6959 2734.78010   151%     -   83s
     0     0 2683.97335    0  544 -5380.6959 2683.97335   150%     -   85s
     0     0 2670.44969    0  628 -5380.6959 2670.44969   150%     -   87s
     0     0 2653.40537    0  624 -5380.6959 2653.40537   149%     -   87s
     0     0 2652.55486    0  619 -5380.6959 2652.55486   149%     -   88s
     0     0 2630.35050    0  569 -5380.6959 2630.35050   149%     -   89s
H    0     0                    -5359.705582 2628.94717   149%     -   89s
H    0     0                    -5326.253805 2628.94717   149%     -   89s
H    0     0                    -5317.069522 2628.94717   149%     -   90s
     0     0 2625.28027    0  640 -5317.0695 2625.28027   149%     -   90s
     0     0 2624.83958    0  639 -5317.0695 2624.83958   149%     -   90s
     0     0 2614.89048    0  578 -5317.0695 2614.89048   149%     -   92s
     0     0 2611.54613    0  565 -5317.0695 2611.54613   149%     -   92s
     0     0 2608.83559    0  575 -5317.0695 2608.83559   149%     -   93s
     0     0 2608.28198    0  645 -5317.0695 2608.28198   149%     -   93s
     0     0 2595.97960    0  645 -5317.0695 2595.97960   149%     -   95s
H    0     0                    -5302.624104 2593.46081   149%     -   95s
H    0     0                    -5285.091949 2593.46081   149%     -   95s
     0     0 2593.46081    0  591 -5285.0919 2593.46081   149%     -   96s
     0     0 2593.46081    0  591 -5285.0919 2593.46081   149%     -   96s
     0     0 2590.28081    0  578 -5285.0919 2590.28081   149%     -   97s
     0     0 2586.75778    0  650 -5285.0919 2586.75778   149%     -   98s
     0     0 2584.96428    0  649 -5285.0919 2584.96428   149%     -   98s
     0     0 2584.31896    0  652 -5285.0919 2584.31896   149%     -   98s
     0     0 2528.51364    0  641 -5285.0919 2528.51364   148%     -  101s
     0     0 2519.74957    0  660 -5285.0919 2519.74957   148%     -  103s
     0     0 2516.18085    0  659 -5285.0919 2516.18085   148%     -  103s
     0     0 2513.86447    0  659 -5285.0919 2513.86447   148%     -  104s
     0     0 2513.18355    0  658 -5285.0919 2513.18355   148%     -  104s
     0     0 2462.94189    0  571 -5285.0919 2462.94189   147%     -  106s
     0     0 2455.98079    0  583 -5285.0919 2455.98079   146%     -  107s
     0     0 2454.68452    0  583 -5285.0919 2454.68452   146%     -  107s
     0     0 2451.45236    0  587 -5285.0919 2451.45236   146%     -  107s
     0     0 2450.85669    0  587 -5285.0919 2450.85669   146%     -  108s
     0     0 2426.89563    0  575 -5285.0919 2426.89563   146%     -  110s
H    0     0                    -5261.575211 2426.45913   146%     -  114s
H    0     0                    -5124.192075 2426.45913   147%     -  114s
     0     0 2422.59365    0  592 -5124.1921 2422.59365   147%     -  115s
     0     0 2420.76051    0  593 -5124.1921 2420.76051   147%     -  115s
     0     0 2420.34651    0  597 -5124.1921 2420.34651   147%     -  116s
     0     0 2394.18033    0  593 -5124.1921 2394.18033   147%     -  117s
H    0     0                    -5061.615536 2394.04687   147%     -  117s
     0     0 2391.17479    0  590 -5061.6155 2391.17479   147%     -  118s
     0     0 2389.96647    0  593 -5061.6155 2389.96647   147%     -  118s
     0     0 2371.92778    0  657 -5061.6155 2371.92778   147%     -  120s
     0     0 2358.31627    0  658 -5061.6155 2358.31627   147%     -  121s
     0     0 2354.89055    0  594 -5061.6155 2354.89055   147%     -  121s
     0     0 2353.60650    0  599 -5061.6155 2353.60650   146%     -  122s
     0     0 2348.69107    0  595 -5061.6155 2348.69107   146%     -  123s
     0     0 2348.21481    0  593 -5061.6155 2348.21481   146%     -  123s
     0     0 2347.28151    0  589 -5061.6155 2347.28151   146%     -  124s
     0     0 2346.36415    0  595 -5061.6155 2346.36415   146%     -  124s
     0     0 2346.36415    0  598 -5061.6155 2346.36415   146%     -  125s
     0     0 2346.01255    0  598 -5061.6155 2346.01255   146%     -  126s
     0     0 2345.38034    0  673 -5061.6155 2345.38034   146%     -  126s
     0     0 2345.22150    0  673 -5061.6155 2345.22150   146%     -  127s
H    0     0                    -4710.539245 2345.22150   150%     -  146s
H    0     0                    -4605.483480 2345.22150   151%     -  146s
     0     2 2345.22150    0  673 -4605.4835 2345.22150   151%     -  147s
     3     8 2190.97199    2  592 -4605.4835 2246.71024   149%  3831  152s
     7    16 2143.46752    3  575 -4605.4835 2188.19059   148%  3698  156s
    15    32 2074.74953    4  570 -4605.4835 2143.43003   147%  4359  160s
    31    44 1616.09937    5  554 -4605.4835 2074.61538   145%  6195  173s
H   47    68                    -4580.331035 2074.61538   145%  6074  184s
H   47    68                    -4551.805273 2074.61538   146%  6074  184s
H   49    68                    -4551.069943 2074.61538   146%  5957  184s
H   62    68                    -4541.799588 2074.61538   146%  5280  184s
H   65    68                    -4521.385155 2074.61538   146%  5262  184s
    75   140 1033.12874    7  521 -4521.3852 2074.61538   146%  4839  192s
   153   172 1010.35143    8  521 -4521.3852 2074.61538   146%  3520  196s
H  154   172                    -4511.770852 2074.61538   146%  3497  196s
H  170   172                    -4506.079960 2074.61538   146%  3339  196s
   185   275  184.64390    8  443 -4506.0800 2074.61538   146%  3450  203s
   298   351  876.63352   10  429 -4506.0800 2074.61538   146%  2950  209s
   384   437  861.57293   11  414 -4506.0800 1985.90314   144%  2794  215s
   527   492  652.55833   14  432 -4506.0800 1985.17179   144%  2494  222s
H  539   492                    -4474.960060 1985.17179   144%  2478  222s
   568   542  621.85745   13  504 -4474.9601 1985.17179   144%  2488  228s
   656   595 -846.59143   12  412 -4474.9601 1985.17179   144%  2406  234s
   737   630  565.91702   15  425 -4474.9601 1715.54515   138%  2438  240s
   808   665  556.99471   14  502 -4474.9601 1714.94014   138%  2455  245s
   877   714  226.79601   16  404 -4474.9601 1714.94014   138%  2512  250s
   942   776 -364.69363   16  421 -4474.9601 1714.94014   138%  2578  255s
  1018   823     cutoff   15      -4474.9601 1714.94014   138%  2608  261s
  1081   862     cutoff   15      -4474.9601 1714.94014   138%  2659  265s
  1154   911 -183.09859   18  551 -4474.9601 1714.94014   138%  2666  271s
  1229   961 -2476.2560   17  419 -4474.9601 1714.94014   138%  2734  278s
  1307   985 -306.52636   19  552 -4474.9601 1714.94014   138%  2771  283s
H 1327   985                    -4451.766781 1714.94014   139%  2781  283s
  1355   998 -455.59422   18  227 -4451.7668 1714.94014   139%  2820  290s
  1438  1028 -527.03765   19  235 -4451.7668 1714.94014   139%  2849  296s
  1514  1096 -1070.0967   20  315 -4451.7668 1714.94014   139%  2893  303s
  1608  1126 -888.99774   20  213 -4451.7668 1204.04858   127%  2919  308s
H 1614  1126                    -4424.133029 1204.04858   127%  2925  308s
  1642  1201 -1386.4221   21  221 -4424.1330 1204.04858   127%  2944  314s
  1760  1222 -1815.8816   22  219 -4424.1330 1204.04858   127%  2909  321s
H 1762  1222                    -4421.811824 1204.04858   127%  2911  321s
* 1792  1222              42    -4392.888874  998.64748   123%  2920  321s
  1803  1324 -1618.5317   22  349 -4392.8889  998.64748   123%  2930  329s
  1954  1377 -1551.4557   21  230 -4392.8889  998.64748   123%  2875  335s
  2101  1418     cutoff   23      -4392.8889  998.64748   123%  2830  343s
  2230  1484 -1701.9468   23  343 -4392.8889  998.64748   123%  2835  351s
  2343  1566 -2148.4373   26  345 -4392.8889  945.88139   122%  2848  360s
  2493  1606 -2389.8855   29  332 -4392.8889  916.80448   121%  2846  366s
  2561  1649 -2402.1356   30  316 -4392.8889  913.27999   121%  2839  375s
  2683  1663 -2675.8502   32  319 -4392.8889  913.27999   121%  2823  382s
  2733  1692 -2808.2561   32  257 -4392.8889  913.27999   121%  2842  389s
  2774  1723 -2959.9110   33  256 -4392.8889  818.81541   119%  2866  398s
  2841  1765 -3048.3263   34  205 -4392.8889  818.81541   119%  2874  407s
  2917  1850 -3228.3831   36  208 -4392.8889  786.65044   118%  2895  416s
  3056  1938 -3420.2966   38  203 -4392.8889  726.05570   117%  2888  424s
  3237  2019 -4122.3481   45  181 -4392.8889  726.05570   117%  2856  434s
  3428  2123     cutoff   54      -4392.8889  726.05570   117%  2835  445s
  3622  2244     cutoff   35      -4392.8889  682.51471   116%  2826  456s
  3872  2357  413.82232    6  369 -4392.8889  682.51471   116%  2797  466s
  4073  2485 -712.96293    8  340 -4392.8889  596.24263   114%  2800  477s
  4306  2486 -2169.0494   20  673 -4392.8889  596.24263   114%  2793  513s
  4308  2487 -2428.9727   47  268 -4392.8889  596.24263   114%  2791  527s
  4309  2488 -1860.7206   15  515 -4392.8889  596.24263   114%  2791  540s
  4310  2489   33.16047    7  509 -4392.8889  596.24263   114%  2790  548s
  4311  2489 -540.92921   13  603 -4392.8889  596.24263   114%  2789  551s
  4312  2490 -1988.7025   40  608 -4392.8889  596.24263   114%  2789  556s
  4314  2491  596.24263   10  560 -4392.8889  596.24263   114%  2787  562s
  4315  2492 -866.41146   14  672 -4392.8889  596.24263   114%  2787  565s
  4318  2494  225.50216   12  639 -4392.8889  596.24263   114%  2785  571s
  4319  2495 -1593.5171   13  676 -4392.8889  596.24263   114%  2784  577s
  4322  2497 -2714.1612   17  696 -4392.8889  596.24263   114%  2782  582s
  4323  2497 -2516.1162   30  641 -4392.8889  596.24263   114%  2782  587s
  4326  2499 -279.00467   13  646 -4392.8889  596.24263   114%  2780  592s
  4329  2501 -2911.3345   17  652 -4392.8889  596.24263   114%  2778  596s
  4331  2503 -2385.2575   15  695 -4392.8889  596.24263   114%  2776  601s
  4332  2503 -749.39048   15  772 -4392.8889  596.24263   114%  2776  605s
  4334  2505 -3233.0568   17  763 -4392.8889  596.24263   114%  2775  612s
  4336  2506 -3996.0856   23  747 -4392.8889  596.24263   114%  2773  617s
  4338  2507 -1396.9221   23  748 -4392.8889  596.24263   114%  2772  621s
  4340  2509 -3290.2310   18  651 -4392.8889  596.24263   114%  2771  626s
  4341  2509 -966.52549   21  651 -4392.8889  596.24263   114%  2770  641s
  4342  2510 -3139.9942   44  651 -4392.8889  596.24263   114%  2769  653s
  4343  2514  596.24263   14  649 -4392.8889  596.24263   114%  2806  661s
  4345  2517  596.24263   15  637 -4392.8889  596.24263   114%  2807  669s
  4349  2522  596.24263   16  646 -4392.8889  596.24263   114%  2810  675s
  4357  2531  596.24263   17  584 -4392.8889  596.24263   114%  2814  683s
  4371  2535   45.53249   18  342 -4392.8889  596.24263   114%  2820  693s
  4384  2544     cutoff   19      -4392.8889  596.24263   114%  2842  708s
  4413  2607  292.78089   19  479 -4392.8889  596.24263   114%  2886  724s
  4490  2613 -190.39337   20  494 -4392.8889  596.24263   114%  2918  734s
  4527  2645 -408.12783   21  492 -4392.8889  596.24263   114%  2935  743s
  4585  2671 -637.78432   22  485 -4392.8889  596.24263   114%  2944  753s
  4659  2673 -1005.1426   24  464 -4392.8889  596.24263   114%  2946  761s
  4742  2664 -1603.5382   27  523 -4392.8889  596.24263   114%  2943  770s
  4822  2656 -2784.6020   28  513 -4392.8889  596.24263   114%  2935  779s
  4888  2660 -3795.9184   29  231 -4392.8889  596.24263   114%  2924  787s
  4956  2656     cutoff   30      -4392.8889  596.24263   114%  2920  795s
  5034  2664 -3723.3800   30  547 -4392.8889  292.41926   107%  2912  804s
  5102  2663 -4141.7658   32  483 -4392.8889  292.41926   107%  2904  812s
  5177  2667     cutoff   35      -4392.8889  292.41926   107%  2895  821s
  5254  2648 -2785.5252   23  388 -4392.8889  -33.86230  99.2%  2887  830s
  5347  2631 -3385.6724   24  431 -4392.8889 -158.70199  96.4%  2871  837s
  5403  2614     cutoff   25      -4392.8889 -158.70199  96.4%  2866  845s
  5452  2619 -2171.6783   24  493 -4392.8889 -158.70199  96.4%  2865  853s
  5519  2612 -2197.0637   25  456 -4392.8889 -158.70199  96.4%  2858  863s
  5581  2596 -2773.6348   26  413 -4392.8889 -158.70199  96.4%  2855  873s
  5658  2587 -2777.0042   27  419 -4392.8889 -158.70199  96.4%  2843  882s
  5739  2579     cutoff   32      -4392.8889 -158.70199  96.4%  2833  890s
  5813  2573 -2696.2330   22  363 -4392.8889 -614.94698  86.0%  2830  900s
  5891  2540     cutoff   25      -4392.8889 -657.05582  85.0%  2827  910s
  5994  2491     cutoff   25      -4392.8889 -805.48921  81.7%  2817  920s
  6099  2470 -3213.2339   25  475 -4392.8889 -937.07488  78.7%  2811  930s
  6207  2412 -3680.2325   27  268 -4392.8889 -937.07488  78.7%  2803  941s
  6354  2344 -4248.6969   32  272 -4392.8889 -937.07488  78.7%  2787  953s
  6497  2289     cutoff   27      -4392.8889 -1535.9310  65.0%  2781  964s
  6615  2240 -2773.6572   21  147 -4392.8889 -1535.9310  65.0%  2774  977s
  6769  2182     cutoff   23      -4392.8889 -1714.8572  61.0%  2762  989s
  6930  2125 -3481.4224   36  276 -4392.8889 -1899.7697  56.8%  2752 1002s
  7147  1985     cutoff   22      -4392.8889 -1899.7697  56.8%  2722 1015s
  7388  1853 -3487.8231   24  351 -4392.8889 -2154.5250  51.0%  2686 1028s
  7614  1736     cutoff   30      -4392.8889 -2364.9825  46.2%  2660 1042s
  7837  1525     cutoff   25      -4392.8889 -2675.1251  39.1%  2621 1052s
  8177  1323 infeasible   27      -4392.8889 -3134.7873  28.6%  2555 1063s
  8549  1131     cutoff   31      -4392.8889 -3383.7709  23.0%  2474 1069s
  8937  1006 -4339.3572   41   24 -4392.8889 -4274.3581  2.70%  2376 1070s

Cutting planes:
  Learned: 3
  MIR: 550
  Flow cover: 1226
  Zero half: 6
  RLT: 15
  Relax-and-lift: 32

Explored 9295 nodes (21500391 simplex iterations) in 1072.44 seconds (3071.12 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -4392.89 -4421.81 -4424.13 ... -4551.07
No other solutions better than -4392.89

Optimal solution found (tolerance 1.00e-04)
Warning: max constraint violation (1.9515e-09) exceeds tolerance
Best objective -4.392888874430e+03, best bound -4.392888874430e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 1072.45s
  Master Objective (UB) = -4392.89, θ = 111890.24
  Upper Bound (UB) = -4392.89

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 111890.24
  [DEBUG]   ✓ Scenario 0: θ = 111890.24 ≤ Q = 111890.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 111890.24 ≤ Q = 111890.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 111890.24 ≤ Q = 111890.24 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 111890.24 ≤ Q = 111890.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 111890.24 ≤ Q = 111890.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 111890.24 ≤ Q = 111890.24 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x17d71a8d
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x17d71a8d
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [3e-12, 2e+02]
Found heuristic solution: objective 1.183916e+13
Presolve removed 2608 rows and 1900 columns
Presolve time: 0.00s
Presolved: 485 rows, 489 columns, 1368 nonzeros
Found heuristic solution: objective 5917595.2735
Variable types: 330 continuous, 159 integer (159 binary)

Root relaxation: objective -1.246579e+05, 231 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -124657.91    0  120 5917595.27 -124657.91   102%     -    0s
H    0     0                    -93145.67223 -124657.91  33.8%     -    0s
H    0     0                    -93537.44811 -124414.27  33.0%     -    0s
     0     0 -106359.26    0  124 -93537.448 -106359.26  13.7%     -    0s
H    0     0                    -102284.6667 -106278.96  3.91%     -    0s
H    0     0                    -103140.9171 -106278.96  3.04%     -    0s
     0     0 -105615.33    0  127 -103140.92 -105615.33  2.40%     -    0s
H    0     0                    -103330.6204 -105595.23  2.19%     -    0s
     0     0 -105127.68    0  132 -103330.62 -105127.68  1.74%     -    0s
H    0     0                    -103345.8982 -105106.80  1.70%     -    0s
     0     0 -105106.80    0  132 -103345.90 -105106.80  1.70%     -    0s
     0     0 -104725.53    0  108 -103345.90 -104725.53  1.33%     -    0s
H    0     0                    -103348.0860 -104680.18  1.29%     -    0s
     0     0 -104680.18    0  100 -103348.09 -104680.18  1.29%     -    0s
     0     0 -104494.22    0  105 -103348.09 -104494.22  1.11%     -    0s
     0     0 -104420.34    0  105 -103348.09 -104420.34  1.04%     -    0s
     0     0 -104257.16    0   98 -103348.09 -104257.16  0.88%     -    0s
     0     0 -104223.63    0   98 -103348.09 -104223.63  0.85%     -    0s
     0     0 -104147.78    0   73 -103348.09 -104147.78  0.77%     -    0s
     0     0 -104120.82    0   75 -103348.09 -104120.82  0.75%     -    0s
     0     0 -104069.46    0   75 -103348.09 -104069.46  0.70%     -    0s
     0     0 -104060.86    0   75 -103348.09 -104060.86  0.69%     -    0s
     0     2 -104060.25    0   75 -103348.09 -104060.25  0.69%     -    0s
H  236    40                    -103351.5114 -103580.32  0.22%   6.6    0s
*  674    78              26    -103353.0712 -103470.40  0.11%   5.0    0s
*  753    78              29    -103354.2665 -103470.40  0.11%   4.8    0s
*  774    78              28    -103359.2516 -103470.40  0.11%   4.7    0s

Cutting planes:
  Gomory: 46
  Implied bound: 2
  MIR: 155
  Flow cover: 6
  RLT: 49
  Relax-and-lift: 7
  BQP: 3

Explored 1095 nodes (5491 simplex iterations) in 0.24 seconds (0.15 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -103359 -103354 -103353 ... -93145.7

Optimal solution found (tolerance 1.00e-04)
Best objective -1.033592516115e+05, best bound -1.033609316621e+05, gap 0.0016%
  Subproblem solved in 0.26s
  Worst-case operational profit (Z_SP) = 102853.47
  Scenario: 60 demand increases, 0 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -103359.25
  [DEBUG]   S×d_nominal = 206212.72
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 206212.72 + -103359.25 = 102853.47
  [DEBUG]   Current θ from Master = 111890.24
  [DEBUG]   ⚠️  Z_SP ≤ θ by 9036.77 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -13429.66
  Lower Bound (LB) = -10288.62
  Gap (UB-LB) = 5895.7348, Absolute Gap = 5895.7348, Relative Gap = 1.342109
  Not converged yet (gap = 5895.73 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 60 increases, 0 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308136 nonzeros
Model fingerprint: 0xc8f5d14a
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [9e-02, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 49570 rows and 20130 columns
Presolve time: 0.79s
Presolved: 58843 rows, 25810 columns, 365849 nonzeros
Variable types: 23551 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -371500.8959
Found heuristic solution: objective -172304.4497

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 58843 rows, 25810 columns, 365849 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   34566   -1.9985705e+04   0.000000e+00   3.540790e+07      5s
   45771   -5.1931682e+02   0.000000e+00   2.092276e+06     10s
   55392    5.3132616e+03   0.000000e+00   3.137921e+06     15s
Concurrent spin time: 1.35s

Solved with dual simplex

Root relaxation: objective 1.178511e+04, 48545 iterations, 17.17 seconds (39.64 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 11785.1144    0  270 -172304.45 11785.1144   107%     -   18s
H    0     0                    -166588.0623 11785.1144   107%     -   18s
H    0     0                    -153103.1063 11785.1144   108%     -   18s
H    0     0                    -89614.62392 11785.1144   113%     -   18s
H    0     0                    -64430.68750 11785.1144   118%     -   18s
H    0     0                    -61768.29302 11785.1144   119%     -   18s
H    0     0                    -59931.49650 11785.1144   120%     -   18s
H    0     0                    -27788.78940 11785.1144   142%     -   18s
H    0     0                    -10015.48634 11785.1144   218%     -   19s
H    0     0                    -9923.518723 11785.1144   219%     -   19s
H    0     0                    -9525.465528 7490.45569   179%     -   24s
H    0     0                    -9511.104065 7490.45569   179%     -   24s
H    0     0                    -9478.877465 7490.45569   179%     -   24s
H    0     0                    -9420.285697 7490.45569   180%     -   24s
     0     0 7490.45569    0  360 -9420.2857 7490.45569   180%     -   24s
     0     0 7319.71371    0  361 -9420.2857 7319.71371   178%     -   25s
     0     0 7239.40652    0  350 -9420.2857 7239.40652   177%     -   26s
     0     0 7239.40652    0  350 -9420.2857 7239.40652   177%     -   26s
     0     0 5121.95785    0  380 -9420.2857 5121.95785   154%     -   31s
H    0     0                    -9281.263446 5121.82243   155%     -   31s
H    0     0                    -9179.866582 4796.79487   152%     -   34s
     0     0 4796.79487    0  406 -9179.8666 4796.79487   152%     -   34s
     0     0 4633.09101    0  418 -9179.8666 4633.09101   150%     -   36s
     0     0 4613.32120    0  430 -9179.8666 4613.32120   150%     -   37s
     0     0 4522.66089    0  414 -9179.8666 4522.66089   149%     -   39s
     0     0 4488.03001    0  420 -9179.8666 4488.03001   149%     -   40s
     0     0 4475.74920    0  431 -9179.8666 4475.74920   149%     -   40s
     0     0 4474.64377    0  428 -9179.8666 4474.64377   149%     -   41s
     0     0 4470.93221    0  425 -9179.8666 4470.93221   149%     -   41s
     0     0 4469.00803    0  435 -9179.8666 4469.00803   149%     -   41s
     0     0 4468.98787    0  435 -9179.8666 4468.98787   149%     -   42s
H    0     0                    -8915.946274 4468.98787   150%     -   44s
H    0     0                    -8696.243018 4468.98787   151%     -   44s
H    0     0                    -8688.091032 4468.98787   151%     -   44s
H    0     0                    -8505.183569 4468.98787   153%     -   44s
H    0     0                    -8499.492677 4468.98787   153%     -   44s
     0     0 3317.66231    0  498 -8499.4927 3317.66231   139%     -   59s
     0     0 2990.92005    0  506 -8499.4927 2990.92005   135%     -   65s
     0     0 2870.66688    0  518 -8499.4927 2870.66688   134%     -   69s
     0     0 2766.54228    0  508 -8499.4927 2766.54228   133%     -   71s
H    0     0                    -8340.919060 2722.39395   133%     -   73s
H    0     0                    -7435.113265 2722.39395   137%     -   73s
H    0     0                    -7274.771262 2722.39395   137%     -   73s
     0     0 2722.39395    0  503 -7274.7713 2722.39395   137%     -   73s
     0     0 2694.94907    0  501 -7274.7713 2694.94907   137%     -   75s
     0     0 2681.71320    0  500 -7274.7713 2681.71320   137%     -   77s
     0     0 2673.22720    0  503 -7274.7713 2673.22720   137%     -   78s
     0     0 2672.47565    0  503 -7274.7713 2672.47565   137%     -   78s
     0     0 2238.29883    0  530 -7274.7713 2238.29883   131%     -   88s
     0     0 2065.60217    0  533 -7274.7713 2065.60217   128%     -   92s
     0     0 2002.20811    0  546 -7274.7713 2002.20811   128%     -   95s
     0     0 1975.76599    0  543 -7274.7713 1975.76599   127%     -   97s
     0     0 1965.07716    0  541 -7274.7713 1965.07716   127%     -   98s
     0     0 1951.85937    0  543 -7274.7713 1951.85937   127%     -   99s
     0     0 1943.29343    0  544 -7274.7713 1943.29343   127%     -  100s
     0     0 1942.26550    0  544 -7274.7713 1942.26550   127%     -  100s
     0     0 1789.87619    0  547 -7274.7713 1789.87619   125%     -  105s
     0     0 1767.77048    0  558 -7274.7713 1767.77048   124%     -  107s
     0     0 1757.23870    0  567 -7274.7713 1757.23870   124%     -  107s
     0     0 1748.26358    0  560 -7274.7713 1748.26358   124%     -  108s
     0     0 1746.66502    0  574 -7274.7713 1746.66502   124%     -  108s
     0     0 1743.76998    0  564 -7274.7713 1743.76998   124%     -  109s
     0     0 1743.58299    0  564 -7274.7713 1743.58299   124%     -  109s
     0     0 1704.63679    0  582 -7274.7713 1704.63679   123%     -  111s
     0     0 1692.75962    0  576 -7274.7713 1692.75962   123%     -  116s
     0     0 1689.44443    0  580 -7274.7713 1689.44443   123%     -  116s
     0     0 1683.75371    0  582 -7274.7713 1683.75371   123%     -  117s
     0     0 1683.58289    0  587 -7274.7713 1683.58289   123%     -  117s
     0     0 1663.44397    0  558 -7274.7713 1663.44397   123%     -  119s
     0     0 1644.62591    0  556 -7274.7713 1644.62591   123%     -  121s
     0     0 1642.44721    0  556 -7274.7713 1642.44721   123%     -  121s
     0     0 1641.71285    0  563 -7274.7713 1641.71285   123%     -  122s
     0     0 1591.58177    0  557 -7274.7713 1591.58177   122%     -  124s
     0     0 1588.18547    0  620 -7274.7713 1588.18547   122%     -  125s
     0     0 1586.30025    0  625 -7274.7713 1586.30025   122%     -  126s
     0     0 1584.71531    0  633 -7274.7713 1584.71531   122%     -  126s
     0     0 1584.32060    0  632 -7274.7713 1584.32060   122%     -  126s
     0     0 1560.88995    0  640 -7274.7713 1560.88995   121%     -  129s
     0     0 1556.89334    0  651 -7274.7713 1556.89334   121%     -  130s
     0     0 1555.49931    0  652 -7274.7713 1555.49931   121%     -  130s
     0     0 1554.79711    0  649 -7274.7713 1554.79711   121%     -  131s
     0     0 1550.35608    0  657 -7274.7713 1550.35608   121%     -  132s
     0     0 1549.13191    0  654 -7274.7713 1549.13191   121%     -  133s
     0     0 1526.22703    0  655 -7274.7713 1526.22703   121%     -  135s
     0     0 1522.90706    0  601 -7274.7713 1522.90706   121%     -  136s
     0     0 1522.18620    0  663 -7274.7713 1522.18620   121%     -  136s
     0     0 1506.89813    0  644 -7274.7713 1506.89813   121%     -  138s
     0     0 1499.10848    0  594 -7274.7713 1499.10848   121%     -  140s
     0     0 1496.42845    0  597 -7274.7713 1496.42845   121%     -  140s
     0     0 1495.21579    0  598 -7274.7713 1495.21579   121%     -  141s
     0     0 1490.77612    0  590 -7274.7713 1490.77612   120%     -  142s
     0     0 1489.21502    0  588 -7274.7713 1489.21502   120%     -  142s
     0     0 1487.93436    0  592 -7274.7713 1487.93436   120%     -  143s
     0     0 1484.31828    0  590 -7274.7713 1484.31828   120%     -  144s
     0     0 1483.83428    0  593 -7274.7713 1483.83428   120%     -  144s
     0     0 1481.43630    0  591 -7274.7713 1481.43630   120%     -  145s
     0     0 1480.98095    0  587 -7274.7713 1480.98095   120%     -  146s
     0     0 1480.19058    0  588 -7274.7713 1480.19058   120%     -  147s
     0     0 1479.58266    0  588 -7274.7713 1479.58266   120%     -  148s
     0     2 1479.52010    0  588 -7274.7713 1479.52010   120%     -  173s
     1     4 1410.79740    1  575 -7274.7713 1478.22241   120%  3520  175s
     3     8 1344.54141    2  568 -7274.7713 1408.61810   119%  4306  181s
     7    16 1033.24567    3  564 -7274.7713 1344.28716   118%  5435  186s
    15    30  969.74841    4  564 -7274.7713 1033.19192   114%  5608  191s
    31    42   40.28261    5  465 -7274.7713  969.69203   113%  7432  204s
    45    69 -308.68995    6  438 -7274.7713  969.69203   113%  7994  225s
    74   101 -332.81524    7  445 -7274.7713  969.57886   113%  7394  233s
   106   132 -366.05277    8  439 -7274.7713  969.57886   113%  7177  242s
   139   163 -383.61549    9  428 -7274.7713  969.57886   113%  6093  250s
H  158   163                    -7254.894377  969.57886   113%  5594  250s
H  172   285                    -6771.767106  969.57886   114%  5342  262s
H  174   285                    -6504.088658  969.57886   115%  5335  262s
H  179   285                    -6407.734836  969.57886   115%  5261  262s
H  245   285                    -6370.642855  969.57886   115%  4380  262s
   300   353 -4518.7357   12  181 -6370.6429  969.57886   115%  3960  272s
   398   397     cutoff   16      -6370.6429  969.57886   115%  3687  280s
H  402   397                    -5985.908515  969.57886   116%  3721  280s
H  421   397                    -5893.641014  969.57886   116%  3624  280s
   478   443 -2559.9783   12  347 -5893.6410  969.57886   116%  3540  289s
   551   475 -2297.2334    8  219 -5893.6410  969.57886   116%  3434  296s
H  552   475                    -5881.653127  969.57886   116%  3428  296s
H  569   475                    -5854.450429  969.57886   117%  3451  296s
   595   566 -4546.2391    9  260 -5854.4504  969.57886   117%  3461  304s
   688   611 -2531.0994    9  226 -5854.4504  969.57886   117%  3381  311s
H  689   611                    -5777.495448  969.57886   117%  3376  311s
   747   694 -2594.0692   10  218 -5777.4954  969.57886   117%  3290  318s
   838   761 -3205.1716   13  201 -5777.4954  652.13657   111%  3229  325s
H  844   761                    -5753.677385  652.13657   111%  3228  325s
H  897   761                    -5753.239765  652.13657   111%  3173  325s
H  901   761                    -5752.146962  652.13657   111%  3173  325s
   923   841 -3496.7365   15  205 -5752.1470  652.13657   111%  3169  332s
  1026   861 -3907.3787   19  182 -5752.1470  652.13657   111%  3088  339s
H 1048   861                    -5742.927087  652.13657   111%  3088  339s
  1066   946 -4172.9797   19  175 -5742.9271  519.97259   109%  3092  346s
  1182  1043 -4442.0876   21  193 -5742.9271  519.97259   109%  2991  353s
  1331  1098 -4375.2147   22  186 -5742.9271  519.97259   109%  2840  360s
  1456  1154 -4592.8588   25  175 -5742.9271  519.97259   109%  2817  368s
  1586  1212 -5115.5616   30  255 -5742.9271 -111.98530  98.1%  2765  377s
  1709  1273 -2903.8112    8  272 -5742.9271 -111.98530  98.1%  2749  385s
  1827  1325 -3381.4891   13  266 -5742.9271 -224.29900  96.1%  2754  394s
  1931  1348 -3748.7177   16  159 -5742.9271 -224.29900  96.1%  2810  401s
  1982  1399 -3993.6435   18  230 -5742.9271 -374.77900  93.5%  2846  410s
  2072  1469 -5307.7604   25  336 -5742.9271 -374.77900  93.5%  2872  417s
  2176  1522 -5334.8189   26  246 -5742.9271 -420.28854  92.7%  2905  427s
  2323  1601     cutoff    9      -5742.9271 -427.89405  92.5%  2932  436s
  2444  1632 -4937.1652    9  185 -5742.9271 -494.23265  91.4%  2977  444s
  2523  1675 -4802.6704   16  252 -5742.9271 -494.23265  91.4%  2989  453s
  2632  1714 -5535.3174   19  252 -5742.9271 -494.23265  91.4%  3001  463s
  2757  1781 -5220.4563   19  237 -5742.9271 -504.06173  91.2%  3026  473s
  2900  1857 -3396.5141    9  369 -5742.9271 -587.95007  89.8%  3052  482s
  3061  1944 -4102.4607   12  407 -5742.9271 -611.53054  89.4%  3043  494s
  3267  2032 -4648.3084   15  421 -5742.9271 -611.53054  89.4%  3016  506s
  3460  2062 -5606.7471   26  186 -5742.9271 -722.56626  87.4%  3009  518s
  3621  2151 infeasible    8      -5742.9271 -821.24638  85.7%  3052  530s
  3790  2243 infeasible   11      -5742.9271 -821.24638  85.7%  3073  544s
  3983  2319 -4260.9342   14  416 -5742.9271 -897.95944  84.4%  3080  556s
  4192  2397 infeasible   15      -5742.9271 -1032.7578  82.0%  3088  569s
  4393  2493 -5283.9906   19  416 -5742.9271 -1083.5776  81.1%  3115  583s
  4576  2657 -1666.7467   11  412 -5742.9271 -1083.5776  81.1%  3102  598s
  4851  2658 -4965.4012   24  588 -5742.9271 -1101.0507  80.8%  3072  634s
  4853  2659 -5548.8495   19  270 -5742.9271 -1101.0507  80.8%  3071  657s
  4854  2660 -4553.8402   11  461 -5742.9271 -1101.0507  80.8%  3070  673s
  4855  2661 -4215.9860   38  577 -5742.9271 -1101.0507  80.8%  3069  685s
  4856  2661 -4134.0829   43  520 -5742.9271 -1101.0507  80.8%  3069  695s
  4858  2663 -3902.1781   23  536 -5742.9271 -1101.0507  80.8%  3068  702s
  4859  2663 -2620.7885   24  539 -5742.9271 -1101.0507  80.8%  3067  705s
  4862  2665 -5215.5399   17  599 -5742.9271 -1101.0507  80.8%  3065  712s
  4863  2666 -3461.2981   12  603 -5742.9271 -1101.0507  80.8%  3064  719s
H 4863  2532                    -5740.222735 -1101.0507  80.8%  3064  721s
  4867  2535 -3480.1958   39  555 -5740.2227 -1101.0507  80.8%  3062  730s
  4869  2536 -5580.9091   76  725 -5740.2227 -1101.0507  80.8%  3061  737s
  4870  2537 -5037.4330   20  570 -5740.2227 -1101.0507  80.8%  3060  743s
  4871  2537 -2797.0640   15  696 -5740.2227 -1101.0507  80.8%  3059  745s
  4873  2539 -4206.7401   38  643 -5740.2227 -1101.0507  80.8%  3058  752s
  4875  2540 -4118.8467   36  571 -5740.2227 -1101.0507  80.8%  3057  758s
  4876  2541 -4735.8655   27  565 -5740.2227 -1101.0507  80.8%  3056  760s
  4878  2542 -3783.1253   22  571 -5740.2227 -1101.0507  80.8%  3055  766s
  4879  2543 -4434.9752   23  562 -5740.2227 -1101.0507  80.8%  3054  771s
  4881  2544 -2763.6360   15  645 -5740.2227 -1101.0507  80.8%  3053  777s
  4883  2545 -3292.0207   43  647 -5740.2227 -1101.0507  80.8%  3052  782s
  4884  2546 -2673.0528   20  647 -5740.2227 -1101.0507  80.8%  3051  805s
H 4884  2418                    -5736.628888 -1101.0507  80.8%  3051  818s
  4886  2422 -1101.0507   16  685 -5736.6289 -1101.0507  80.8%  3097  827s
  4888  2426 -1101.0507   17  678 -5736.6289 -1101.0507  80.8%  3098  836s
  4892  2432 -1101.0507   18  685 -5736.6289 -1101.0507  80.8%  3102  848s
  4900  2445 -1101.0507   19  688 -5736.6289 -1101.0507  80.8%  3108  861s
  4916  2446     cutoff   20      -5736.6289 -1101.0507  80.8%  3134  879s
  4932  2459 -1666.7131   21  436 -5736.6289 -1101.0507  80.8%  3164  898s
  4960  2502 -2830.5089   22  426 -5736.6289 -1101.0507  80.8%  3193  913s
  5038  2513 -3845.8310   24  317 -5736.6289 -1101.0507  80.8%  3263  929s
  5099  2489 -5126.3145   25  436 -5736.6289 -1101.0507  80.8%  3287  942s
  5170  2487 infeasible   26      -5736.6289 -1101.0507  80.8%  3307  954s
  5223  2499 -3899.4578   27  245 -5736.6289 -1101.0507  80.8%  3344  969s
  5299  2501 -4034.2359   28  244 -5736.6289 -1101.0507  80.8%  3344  981s
  5374  2501 -4752.4084   31  340 -5736.6289 -1101.0507  80.8%  3334  992s
  5442  2497 -4837.5046   34  156 -5736.6289 -1101.0507  80.8%  3332 1002s
  5512  2483     cutoff   35      -5736.6289 -1101.0507  80.8%  3322 1012s
  5591  2451 -3416.0306   24  540 -5736.6289 -1101.0507  80.8%  3308 1023s
  5644  2453 -3731.7507   25  506 -5736.6289 -1101.0507  80.8%  3311 1033s
  5698  2447 -3703.4261   25  528 -5736.6289 -1101.0507  80.8%  3314 1043s
  5769  2431 -5216.3608   26  411 -5736.6289 -1101.0507  80.8%  3312 1055s
  5837  2412 -4039.2790   26  447 -5736.6289 -1101.0507  80.8%  3310 1065s
  5877  2410 -4282.0876   27  436 -5736.6289 -1101.0507  80.8%  3314 1075s
  5916  2400 -4637.3224   28  438 -5736.6289 -1101.0507  80.8%  3317 1085s
  5952  2391     cutoff   29      -5736.6289 -1101.0507  80.8%  3323 1096s
  5990  2387 -5619.8518   28  391 -5736.6289 -1101.0507  80.8%  3326 1107s
  6037  2364     cutoff   29      -5736.6289 -1101.0507  80.8%  3327 1119s
  6098  2333     cutoff   29      -5736.6289 -2166.5553  62.2%  3334 1131s
  6143  2321     cutoff   31      -5736.6289 -2166.5553  62.2%  3349 1143s
  6194  2314 -4899.2953   31  366 -5736.6289 -2166.5553  62.2%  3356 1155s
H 6203  2190                    -5734.631092 -2166.5553  62.2%  3356 1155s
  6252  2184 -5574.3451   32  207 -5734.6311 -2166.5553  62.2%  3363 1168s
  6344  2135 -5559.9154   33  262 -5734.6311 -2190.8844  61.8%  3369 1182s
  6397  2120 -5585.5024   33  196 -5734.6311 -2962.7102  48.3%  3381 1195s
  6452  2107     cutoff   34      -5734.6311 -2962.7102  48.3%  3391 1212s
  6537  2070     cutoff   22      -5734.6311 -2962.7102  48.3%  3389 1226s
  6607  2045 -4806.2278   23  481 -5734.6311 -2998.3645  47.7%  3397 1242s
  6706  1992     cutoff   26      -5734.6311 -2998.3645  47.7%  3401 1258s
  6805  1940 -5474.9152   28  427 -5734.6311 -3476.9402  39.4%  3410 1273s
  6938  1867 -5144.7853   32  403 -5734.6311 -3730.5029  34.9%  3392 1290s
  7111  1774     cutoff   37      -5734.6311 -3730.5029  34.9%  3357 1309s
  7277  1678 -5050.0258   32  479 -5734.6311 -3730.5029  34.9%  3324 1325s
  7516  1558     cutoff   33      -5734.6311 -3927.4438  31.5%  3262 1343s
  7829  1411 -5699.9529   63  135 -5734.6311 -4374.7847  23.7%  3173 1354s
  8266  1290 -5685.1962   65   46 -5734.6311 -5077.3745  11.5%  3031 1363s
  8827  1109 infeasible   77      -5734.6311 -5339.9780  6.88%  2848 1370s

Cutting planes:
  Learned: 2
  MIR: 569
  Mixing: 1
  Flow cover: 1368
  Zero half: 3
  RLT: 22
  Relax-and-lift: 45

Explored 9774 nodes (25544627 simplex iterations) in 1373.34 seconds (3810.52 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -5734.63 -5736.63 -5740.22 ... -5881.65
No other solutions better than -5734.63

Optimal solution found (tolerance 1.00e-04)
Best objective -5.734631091647e+03, best bound -5.734631091647e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 1373.35s
  Master Objective (UB) = -5734.63, θ = 110323.42
  Upper Bound (UB) = -5734.63

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 110323.42
  [DEBUG]   ✓ Scenario 0: θ = 110323.42 ≤ Q = 110323.42 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 110323.42 ≤ Q = 110327.90 (slack: 4.48)
  [DEBUG]   ✓ Scenario 2: θ = 110323.42 ≤ Q = 110323.42 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 110323.42 ≤ Q = 110323.42 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 110323.42 ≤ Q = 110323.42 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 110323.42 ≤ Q = 110323.42 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 110323.42 ≤ Q = 110323.42 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x661777ed
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x99e88813
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.191763e+13
Presolve removed 2602 rows and 1895 columns
Presolve time: 0.00s
Presolved: 491 rows, 494 columns, 1384 nonzeros
Found heuristic solution: objective 6136048.6247
Variable types: 334 continuous, 160 integer (160 binary)

Root relaxation: objective -1.183004e+05, 232 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -118300.38    0  122 6136048.62 -118300.38   102%     -    0s
H    0     0                    -85677.39526 -118300.38  38.1%     -    0s
H    0     0                    -86271.76118 -118300.38  37.1%     -    0s
H    0     0                    -93987.16054 -95553.602  1.67%     -    0s
     0     0 -95553.602    0   43 -93987.161 -95553.602  1.67%     -    0s
H    0     0                    -94391.13687 -95504.879  1.18%     -    0s
     0     0 -95039.863    0   27 -94391.137 -95039.863  0.69%     -    0s
     0     0 -94877.667    0   23 -94391.137 -94877.667  0.52%     -    0s
     0     0 -94875.821    0   23 -94391.137 -94875.821  0.51%     -    0s
     0     0 -94587.910    0   12 -94391.137 -94587.910  0.21%     -    0s
H    0     0                    -94403.29956 -94545.926  0.15%     -    0s
     0     0 -94528.942    0   18 -94403.300 -94528.942  0.13%     -    0s
     0     0 -94515.836    0   18 -94403.300 -94515.836  0.12%     -    0s
     0     0 -94512.906    0   18 -94403.300 -94512.906  0.12%     -    0s
     0     0 -94509.615    0   18 -94403.300 -94509.615  0.11%     -    0s
     0     0 -94508.040    0   18 -94403.300 -94508.040  0.11%     -    0s
     0     0 -94428.522    0    6 -94403.300 -94428.522  0.03%     -    0s
     0     0 -94414.262    0    5 -94403.300 -94414.262  0.01%     -    0s

Cutting planes:
  Implied bound: 5
  MIR: 4
  Flow cover: 1
  RLT: 1

Explored 1 nodes (534 simplex iterations) in 0.08 seconds (0.03 work units)
Thread count was 32 (of 256 available processors)

Solution count 7: -94403.3 -94391.1 -94159.3 ... 1.19176e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -9.440329956476e+04, best bound -9.441038559324e+04, gap 0.0075%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 104443.64
  Scenario: 18 demand increases, 42 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -94403.30
  [DEBUG]   S×d_nominal = 198846.94
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 198846.94 + -94403.30 = 104443.64
  [DEBUG]   Current θ from Master = 110323.42
  [DEBUG]   ⚠️  Z_SP ≤ θ by 5879.78 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -11614.42
  Lower Bound (LB) = -10288.62
  Gap (UB-LB) = 4553.9926, Absolute Gap = 4553.9926, Relative Gap = 0.794121
  Not converged yet (gap = 4553.99 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 18 increases, 42 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351367 nonzeros
Model fingerprint: 0xf5e067fb
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [9e-02, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 56660 rows and 23010 columns
Presolve time: 0.90s
Presolved: 67043 rows, 29170 columns, 417299 nonzeros
Variable types: 26911 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -371500.8959
Found heuristic solution: objective -172304.4497

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 67043 rows, 29170 columns, 417299 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   34566   -7.4850899e+03   0.000000e+00   1.659184e+09      5s
   46367    1.9093634e+03   0.000000e+00   1.092499e+07     10s
   54280    4.0671773e+03   0.000000e+00   5.084244e+05     15s
   62436    5.1407375e+03   0.000000e+00   8.327566e+05     20s
   69954    6.0664383e+03   0.000000e+00   8.497472e+05     25s
Concurrent spin time: 2.55s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 1.178383e+04, 61774 iterations, 24.79 seconds (58.63 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 11783.8309    0  271 -172304.45 11783.8309   107%     -   26s
H    0     0                    -161687.3541 11783.8309   107%     -   26s
H    0     0                    -71510.84765 11783.8309   116%     -   26s
H    0     0                    -48756.39392 11783.8309   124%     -   26s
H    0     0                    -48578.42296 11783.8309   124%     -   26s
H    0     0                    -48107.43400 11783.8309   124%     -   26s
H    0     0                    -42647.36953 11783.8309   128%     -   26s
H    0     0                    -35581.03119 11783.8309   133%     -   26s
H    0     0                    -34855.20359 11783.8309   134%     -   26s
H    0     0                    -30934.26595 11783.8309   138%     -   26s
H    0     0                    -10548.31154 11783.8309   212%     -   27s
H    0     0                    -10373.04269 11783.8309   214%     -   27s
H    0     0                    -10051.41387 11783.8309   217%     -   27s
     0     0 7547.30142    0  306 -10051.414 7547.30142   175%     -   34s
     0     0 7061.59062    0  309 -10051.414 7061.59062   170%     -   37s
     0     0 6868.03542    0  301 -10051.414 6868.03542   168%     -   39s
H    0     0                    -8406.866322 6868.03542   182%     -   41s
H    0     0                    -7792.312070 6868.03542   188%     -   41s
H    0     0                    -7751.542000 6868.03542   189%     -   41s
H    0     0                    -7741.003872 6868.03542   189%     -   41s
     0     0 6781.27704    0  349 -7741.0039 6781.27704   188%     -   41s
     0     0 6781.27704    0  358 -7741.0039 6781.27704   188%     -   42s
     0     0 6781.27704    0  356 -7741.0039 6781.27704   188%     -   43s
     0     0 6781.27704    0  367 -7741.0039 6781.27704   188%     -   43s
     0     0 6781.27704    0  374 -7741.0039 6781.27704   188%     -   44s
     0     0 6781.27704    0  361 -7741.0039 6781.27704   188%     -   44s
     0     0 4943.86493    0  427 -7741.0039 4943.86493   164%     -   50s
     0     0 4703.34376    0  437 -7741.0039 4703.34376   161%     -   54s
     0     0 4580.47172    0  434 -7741.0039 4580.47172   159%     -   56s
     0     0 4555.98126    0  434 -7741.0039 4555.98126   159%     -   58s
     0     0 4525.60765    0  431 -7741.0039 4525.60765   158%     -   59s
     0     0 4502.12460    0  419 -7741.0039 4502.12460   158%     -   60s
     0     0 4434.64509    0  422 -7741.0039 4434.64509   157%     -   61s
     0     0 4425.59474    0  434 -7741.0039 4425.59474   157%     -   62s
     0     0 4403.90763    0  429 -7741.0039 4403.90763   157%     -   62s
     0     0 4340.99307    0  436 -7741.0039 4340.99307   156%     -   63s
     0     0 4336.98186    0  433 -7741.0039 4336.98186   156%     -   63s
     0     0 4336.27349    0  440 -7741.0039 4336.27349   156%     -   64s
     0     0 3324.33966    0  484 -7741.0039 3324.33966   143%     -   72s
H    0     0                    -7658.113602 3324.31532   143%     -   72s
H    0     0                    -7405.180170 3324.31532   145%     -   72s
H    0     0                    -7379.275158 3324.31532   145%     -   72s
     0     0 3139.77068    0  478 -7379.2752 3139.77068   143%     -   76s
     0     0 3073.89870    0  495 -7379.2752 3073.89870   142%     -   77s
     0     0 3009.12086    0  432 -7379.2752 3009.12086   141%     -   79s
     0     0 2935.70704    0  437 -7379.2752 2935.70704   140%     -   81s
     0     0 2892.64951    0  444 -7379.2752 2892.64951   139%     -   83s
     0     0 2859.79376    0  438 -7379.2752 2859.79376   139%     -   85s
     0     0 2858.00794    0  439 -7379.2752 2858.00794   139%     -   86s
     0     0 2850.79406    0  431 -7379.2752 2850.79406   139%     -   87s
     0     0 2842.89480    0  433 -7379.2752 2842.89480   139%     -   87s
     0     0 2841.78715    0  437 -7379.2752 2841.78715   139%     -   88s
     0     0 2828.50397    0  502 -7379.2752 2828.50397   138%     -   90s
     0     0 2827.91324    0  435 -7379.2752 2827.91324   138%     -   90s
     0     0 2354.26876    0  535 -7379.2752 2354.26876   132%     -   98s
     0     0 2154.50897    0  524 -7379.2752 2154.50897   129%     -  103s
     0     0 2067.00829    0  534 -7379.2752 2067.00829   128%     -  106s
     0     0 1994.68604    0  524 -7379.2752 1994.68604   127%     -  110s
     0     0 1972.51418    0  526 -7379.2752 1972.51418   127%     -  111s
     0     0 1892.71346    0  532 -7379.2752 1892.71346   126%     -  113s
     0     0 1876.60293    0  530 -7379.2752 1876.60293   125%     -  114s
     0     0 1871.91298    0  538 -7379.2752 1871.91298   125%     -  114s
     0     0 1868.56831    0  536 -7379.2752 1868.56831   125%     -  115s
     0     0 1868.26461    0  539 -7379.2752 1868.26461   125%     -  115s
     0     0 1695.63370    0  590 -7379.2752 1695.63370   123%     -  119s
     0     0 1661.96745    0  531 -7379.2752 1661.96745   123%     -  121s
     0     0 1629.93479    0  526 -7379.2752 1629.93479   122%     -  123s
     0     0 1623.24245    0  535 -7379.2752 1623.24245   122%     -  124s
     0     0 1621.59052    0  535 -7379.2752 1621.59052   122%     -  124s
     0     0 1615.39994    0  536 -7379.2752 1615.39994   122%     -  125s
     0     0 1613.86162    0  595 -7379.2752 1613.86162   122%     -  125s
     0     0 1612.45906    0  594 -7379.2752 1612.45906   122%     -  126s
     0     0 1612.00084    0  533 -7379.2752 1612.00084   122%     -  126s
     0     0 1497.48571    0  600 -7379.2752 1497.48571   120%     -  130s
     0     0 1477.38163    0  613 -7379.2752 1477.38163   120%     -  134s
     0     0 1461.04778    0  608 -7379.2752 1461.04778   120%     -  135s
     0     0 1457.65246    0  621 -7379.2752 1457.65246   120%     -  135s
     0     0 1454.81752    0  616 -7379.2752 1454.81752   120%     -  136s
     0     0 1452.95739    0  620 -7379.2752 1452.95739   120%     -  136s
     0     0 1452.77650    0  617 -7379.2752 1452.77650   120%     -  136s
     0     0 1409.44895    0  528 -7379.2752 1409.44895   119%     -  140s
     0     0 1389.77219    0  534 -7379.2752 1389.77219   119%     -  141s
     0     0 1385.42952    0  601 -7379.2752 1385.42952   119%     -  142s
     0     0 1382.79083    0  608 -7379.2752 1382.79083   119%     -  143s
     0     0 1381.97752    0  601 -7379.2752 1381.97752   119%     -  143s
     0     0 1350.85596    0  613 -7379.2752 1350.85596   118%     -  145s
H    0     0                    -7374.556450 1347.94827   118%     -  149s
     0     0 1340.34036    0  618 -7374.5565 1340.34036   118%     -  149s
     0     0 1333.94647    0  609 -7374.5565 1333.94647   118%     -  150s
     0     0 1330.87541    0  615 -7374.5565 1330.87541   118%     -  150s
     0     0 1329.11857    0  609 -7374.5565 1329.11857   118%     -  151s
     0     0 1328.13487    0  549 -7374.5565 1328.13487   118%     -  151s
     0     0 1314.62363    0  611 -7374.5565 1314.62363   118%     -  153s
     0     0 1302.46364    0  614 -7374.5565 1302.46364   118%     -  154s
     0     0 1301.18210    0  616 -7374.5565 1301.18210   118%     -  154s
     0     0 1301.10618    0  614 -7374.5565 1301.10618   118%     -  154s
     0     0 1298.09783    0  614 -7374.5565 1298.09783   118%     -  156s
     0     0 1296.86731    0  625 -7374.5565 1296.86731   118%     -  157s
     0     0 1294.19300    0  636 -7374.5565 1294.19300   118%     -  158s
     0     0 1293.80442    0  632 -7374.5565 1293.80442   118%     -  158s
     0     0 1286.15884    0  629 -7374.5565 1286.15884   117%     -  160s
     0     0 1284.98223    0  635 -7374.5565 1284.98223   117%     -  160s
     0     0 1273.60077    0  625 -7374.5565 1273.60077   117%     -  163s
     0     0 1272.83444    0  625 -7374.5565 1272.83444   117%     -  164s
     0     2 1272.78783    0  625 -7374.5565 1272.78783   117%     -  191s
     1     4 1172.04815    1  617 -7374.5565 1272.01943   117%  3929  197s
     3     8 1114.05311    2  617 -7374.5565 1170.18938   116%  6180  202s
     7    16 1013.22826    3  610 -7374.5565 1114.02160   115%  6769  205s
    15    32  829.02456    4  539 -7374.5565 1093.94796   115%  5558  212s
    31    42  314.29466    5  406 -7374.5565  834.42422   111%  8435  228s
    47    62 -178.34461    6  274 -7374.5565  834.42422   111%  8093  241s
H   55    62                    -7090.038898  834.42422   112%  7532  241s
    73   161 -293.71432    7  320 -7090.0389  834.42422   112%  6427  254s
   186   258 -4267.3888   10  136 -7090.0389  834.42422   112%  3837  263s
H  206   258                    -7055.092693  834.42422   112%  3702  263s
   283   309 -665.28455   10  466 -7055.0927  834.42422   112%  3439  270s
   380   333 -4121.0725    8  180 -7055.0927  834.42422   112%  3094  278s
   420   355 -370.76433    9  255 -7055.0927  834.42422   112%  3084  285s
   481   376 -1692.4985   10  279 -7055.0927  834.42422   112%  3063  293s
   550   407 -2054.1132   10  323 -7055.0927  834.42422   112%  3077  301s
   607   439 -2098.2912   11  374 -7055.0927  834.42422   112%  3058  308s
   661   467 -5961.0798   11  160 -7055.0927  834.42422   112%  3032  315s
   707   499 -2280.6838   12  361 -7055.0927  834.42422   112%  3064  322s
   769   532 -2374.9677   13  294 -7055.0927  834.42422   112%  3015  329s
   838   569     cutoff   13      -7055.0927  834.42422   112%  2924  336s
   901   622 -2552.0537   15  469 -7055.0927  834.42422   112%  2958  342s
   968   642 -3906.0241   15  136 -7055.0927  834.42422   112%  2962  350s
  1048   662 -2558.8256   16  464 -7055.0927  834.42422   112%  2982  359s
  1129   681 -2949.5524   19  373 -7055.0927  834.42422   112%  2992  367s
  1208   711 -4439.5883   20  348 -7055.0927  834.42422   112%  3107  375s
  1283   743 -3877.1759   20  366 -7055.0927  376.54989   105%  3176  383s
  1393   782 -3487.8072   20  318 -7055.0927  376.54989   105%  3175  389s
  1472   817 -5017.6910   22  254 -7055.0927  376.54989   105%  3194  397s
  1551   846 -5075.6977   22  175 -7055.0927  376.54989   105%  3228  406s
  1632   871 -4522.8524   21  108 -7055.0927  376.54989   105%  3271  415s
  1713   899 -6106.8497   20  361 -7055.0927  178.47797   103%  3337  424s
  1811   947 -6268.6460   22  105 -7055.0927  178.47797   103%  3362  433s
  1923   989 -6267.7426   22   89 -7055.0927 -250.78298  96.4%  3371  444s
  2053  1057 -5459.5030   24  218 -7055.0927 -254.90845  96.4%  3382  454s
  2179  1108 -5949.7584   27  195 -7055.0927 -254.90845  96.4%  3411  466s
H 2303  1108                    -6778.530579 -254.90845  96.2%  3379  466s
  2332  1124 -6356.8031   31  188 -6778.5306 -254.90845  96.2%  3384  476s
  2477  1210     cutoff   33      -6778.5306 -700.15344  89.7%  3384  487s
H 2596  1210                    -6376.036991 -700.15344  89.0%  3393  487s
  2658  1220 -2437.2512   10  317 -6376.0370 -700.15344  89.0%  3359  498s
H 2659  1220                    -6145.161628 -700.15344  88.6%  3358  498s
H 2703  1220                    -6125.058166 -700.15344  88.6%  3387  498s
H 2703  1220                    -6052.404411 -700.15344  88.4%  3387  498s
  2742  1248 -2679.2679   11  249 -6052.4044 -700.15344  88.4%  3380  511s
  2870  1295 -4548.9590   14  191 -6052.4044 -834.71968  86.2%  3435  524s
H 3017  1311                    -6036.051057 -834.71968  86.2%  3429  535s
H 3062  1311                    -6026.346622 -834.71968  86.1%  3455  535s
  3064  1355     cutoff   19      -6026.3466 -834.71968  86.1%  3455  547s
H 3105  1355                    -6021.748393 -834.71968  86.1%  3437  547s
  3189  1384 -5831.3501   20  248 -6021.7484 -834.71968  86.1%  3447  562s
  3410  1412 -4249.2803   12  426 -6021.7484 -980.76275  83.7%  3399  576s
  3598  1431 -4295.2212   10  208 -6021.7484 -1211.0641  79.9%  3400  589s
  3763  1498 -5417.7837   14  173 -6021.7484 -1211.0641  79.9%  3414  603s
  4001  1538 -4345.9699   15  431 -6021.7484 -1671.5518  72.2%  3375  618s
H 4016  1538                    -6003.472935 -1671.5518  72.2%  3374  618s
H 4028  1538                    -5981.790059 -1671.5518  72.1%  3376  618s
H 4038  1538                    -5942.426850 -1671.5518  71.9%  3374  618s
H 4104  1538                    -5861.937074 -1671.5518  71.5%  3362  618s
  4161  1572 -4596.6547   16  328 -5861.9371 -1671.5518  71.5%  3354  634s
  4375  1575     cutoff   40      -5861.9371 -1974.1600  66.3%  3355  649s
  4571  1549 -4271.3721   15  228 -5861.9371 -2120.5426  63.8%  3388  665s
  4784  1546     cutoff   20      -5861.9371 -2224.1104  62.1%  3412  685s
  5009  1566 -4746.2489   18  359 -5861.9371 -2233.2745  61.9%  3430  704s
  5257  1569 -5541.7639   18  320 -5861.9371 -2660.3626  54.6%  3399  718s
  5334  1573 -5587.4605   19  323 -5861.9371 -2660.3626  54.6%  3414  732s
H 5345  1573                    -5857.615809 -2660.3626  54.6%  3414  732s
  5395  1530 -5668.7936   20  318 -5857.6158 -2703.2290  53.9%  3414  751s
  5723  1480     cutoff   20      -5857.6158 -2912.5757  50.3%  3389  772s
  5979  1409     cutoff   23      -5857.6158 -3298.3054  43.7%  3412  793s
  6300  1250 -5524.3176   16  491 -5857.6158 -3458.6548  41.0%  3390  812s
  6686  1193     cutoff   18      -5857.6158 -3921.5638  33.1%  3364  835s
  6857  1105     cutoff   13      -5857.6158 -4121.8838  29.6%  3347  855s
  7206  1088 -5168.6527   13  221 -5857.6158 -4274.8120  27.0%  3278  874s
  8224  1398 -5664.0256   18  185 -5857.6158 -4784.6680  18.3%  2990  889s
  9851  2123     cutoff   41      -5857.6158 -5172.0907  11.7%  2545  896s
 11836  1791 -5814.0407   60  625 -5857.6158 -5541.1418  5.40%  2142 1007s
 11838  1792 -5673.1144   35  271 -5857.6158 -5541.1418  5.40%  2142 1029s
 11839  1793 -5706.6710   48  447 -5857.6158 -5541.1418  5.40%  2142 1046s
 11840  1794 -5737.7258   38  545 -5857.6158 -5541.1418  5.40%  2141 1058s
 11841  1794 -5800.7146   57  511 -5857.6158 -5541.1418  5.40%  2141 1064s
 11842  1795 -5739.7533   50  588 -5857.6158 -5541.1418  5.40%  2141 1068s
 11843  1796 -5804.0135   48  613 -5857.6158 -5541.1418  5.40%  2141 1073s
 11844  1796 -5691.8679   41  652 -5857.6158 -5541.1418  5.40%  2141 1077s
 11846  1798 -5821.3722   46  630 -5857.6158 -5541.1418  5.40%  2140 1083s
 11847  1798 -5848.1367   41  634 -5857.6158 -5541.1418  5.40%  2140 1089s
 11848  1799 -5755.7479   19  656 -5857.6158 -5541.1418  5.40%  2140 1094s
 11849  1800 -5572.1344   34  663 -5857.6158 -5541.1418  5.40%  2140 1101s
 11850  1800 -5680.0136   41  673 -5857.6158 -5541.1418  5.40%  2140 1105s
 11851  1801 -5748.8247   37  663 -5857.6158 -5541.1418  5.40%  2139 1112s
 11852  1802 -5774.9459   39  640 -5857.6158 -5541.1418  5.40%  2139 1116s
 11853  1802 -5648.8260   37  651 -5857.6158 -5541.1418  5.40%  2139 1123s
 11854  1803 -5740.2766   38  544 -5857.6158 -5541.1418  5.40%  2139 1126s
 11855  1804 -5647.5825   46  628 -5857.6158 -5541.1418  5.40%  2139 1132s
 11856  1804 -5792.7968   35  628 -5857.6158 -5541.1418  5.40%  2139 1154s
 11857  1805 -5705.2262   48  628 -5857.6158 -5541.1418  5.40%  2138 1169s
 11858  1809 -5541.1418   10  624 -5857.6158 -5541.1418  5.40%  2154 1179s
 11860  1812 -5541.1418   11  617 -5857.6158 -5541.1418  5.40%  2155 1191s
 11864  1819 -5541.1418   12  626 -5857.6158 -5541.1418  5.40%  2158 1200s
 11872  1830 -5541.1418   13  617 -5857.6158 -5541.1418  5.40%  2159 1210s
 11888  1835 -5541.1418   14  512 -5857.6158 -5541.1418  5.40%  2172 1231s
 11902  1851 -5541.1418   15  295 -5857.6158 -5541.1418  5.40%  2178 1259s
 11931  1911 -5541.1418   16  278 -5857.6158 -5541.1418  5.40%  2195 1277s
 12032  1903 -5541.1418   20  225 -5857.6158 -5541.1418  5.40%  2230 1284s
 12066  1908     cutoff   21      -5857.6158 -5541.1418  5.40%  2241 1295s
 12122  1900     cutoff   17      -5857.6158 -5541.1418  5.40%  2248 1309s
 12190  1878     cutoff   19      -5857.6158 -5541.1418  5.40%  2260 1322s
 12252  1871 -5541.1418   16  324 -5857.6158 -5541.1418  5.40%  2281 1332s
 12309  1865     cutoff   18      -5857.6158 -5541.1418  5.40%  2303 1342s
 12362  1855 -5754.9089   18  272 -5857.6158 -5541.1418  5.40%  2313 1352s
 12440  1839     cutoff   19      -5857.6158 -5541.1418  5.40%  2323 1362s
 12515  1821 -5541.1418   17  346 -5857.6158 -5541.1418  5.40%  2338 1374s
 12579  1818 -5541.1418   18  284 -5857.6158 -5541.1418  5.40%  2352 1384s
 12651  1813 -5541.1418   19  270 -5857.6158 -5541.1418  5.40%  2360 1394s
 12721  1806 -5541.1418   21  264 -5857.6158 -5541.1418  5.40%  2369 1403s
 12787  1801 -5541.1418   23  228 -5857.6158 -5541.1418  5.40%  2377 1414s
 12860  1777 -5541.1418   25  227 -5857.6158 -5541.1418  5.40%  2381 1426s
 12959  1761 -5541.1418   27  279 -5857.6158 -5541.1418  5.40%  2386 1438s
 13040  1754 -5610.8497   30  151 -5857.6158 -5541.1418  5.40%  2400 1450s
 13137  1716 -5786.8038   36   68 -5857.6158 -5541.1418  5.40%  2409 1462s
 13256  1692     cutoff   44      -5857.6158 -5541.1418  5.40%  2413 1475s
 13351  1665 -5541.1418   19  333 -5857.6158 -5541.1418  5.40%  2421 1487s
 13467  1641 -5541.1418   22  286 -5857.6158 -5541.1418  5.40%  2431 1501s
 13581  1602     cutoff   24      -5857.6158 -5541.1418  5.40%  2437 1513s
 13719  1539     cutoff   26      -5857.6158 -5541.1418  5.40%  2447 1525s
 13864  1465 -5541.1418   23  399 -5857.6158 -5541.1418  5.40%  2456 1538s
 14013  1363 -5615.6618   24  243 -5857.6158 -5541.1418  5.40%  2463 1551s
 14196  1258 -5541.1418   23  381 -5857.6158 -5541.1418  5.40%  2471 1563s
 14353  1133 -5678.3402   25  322 -5857.6158 -5541.1418  5.40%  2475 1575s
 14608   963     cutoff   24      -5857.6158 -5541.1418  5.40%  2466 1588s
 14897   829     cutoff   23      -5857.6158 -5541.1418  5.40%  2440 1597s
 15188   768 -5829.9487   22  195 -5857.6158 -5541.1418  5.40%  2401 1600s
 16080   635     cutoff   55      -5857.6158 -5687.7655  2.90%  2273 1605s
 18569    51     cutoff   68      -5857.6158 -5786.8829  1.21%  1975 1611s
 19204    15 -5827.4575   73   34 -5857.6158 -5827.4575  0.51%  1911 1616s
*19262    15              83    -5855.117608 -5834.0957  0.36%  1905 1616s

Cutting planes:
  Learned: 1
  MIR: 610
  Flow cover: 1514
  Zero half: 3
  RLT: 18
  Relax-and-lift: 60

Explored 19332 nodes (37000478 simplex iterations) in 1616.82 seconds (4569.37 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -5855.12 -5857.62 -5861.94 ... -6052.4
No other solutions better than -5855.12

Optimal solution found (tolerance 1.00e-04)
Best objective -5.855117607826e+03, best bound -5.855117607826e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 1616.84s
  Master Objective (UB) = -5855.12, θ = 109836.88
  Upper Bound (UB) = -5855.12

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 109836.88
  [DEBUG]   ✓ Scenario 0: θ = 109836.88 ≤ Q = 109836.88 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 109836.88 ≤ Q = 109836.88 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 109836.88 ≤ Q = 109836.88 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 109836.88 ≤ Q = 109836.88 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 109836.88 ≤ Q = 109836.88 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 109836.88 ≤ Q = 109836.88 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 109836.88 ≤ Q = 109836.88 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 109836.88 ≤ Q = 109836.88 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0xf6ce031
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x0f6ce031
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.191763e+13
Presolve removed 2608 rows and 1900 columns
Presolve time: 0.00s
Presolved: 485 rows, 489 columns, 1368 nonzeros
Found heuristic solution: objective 6048331.1230
Variable types: 330 continuous, 159 integer (159 binary)

Root relaxation: objective -1.190150e+05, 229 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -119015.01    0  120 6048331.12 -119015.01   102%     -    0s
H    0     0                    -75466.10717 -119015.01  57.7%     -    0s
H    0     0                    -75841.99772 -119015.01  56.9%     -    0s
H    0     0                    -76511.82894 -119015.01  55.6%     -    0s
H    0     0                    -77601.00219 -118807.62  53.1%     -    0s
     0     0 -94493.816    0   44 -77601.002 -94493.816  21.8%     -    0s
H    0     0                    -92892.05844 -94387.102  1.61%     -    0s
     0     0 -94052.011    0   44 -92892.058 -94052.011  1.25%     -    0s
H    0     0                    -93432.28106 -94037.175  0.65%     -    0s
     0     0 -93766.296    0   24 -93432.281 -93766.296  0.36%     -    0s
     0     0 -93758.385    0   22 -93432.281 -93758.385  0.35%     -    0s
H    0     0                    -93443.61015 -93705.383  0.28%     -    0s
     0     0 -93686.435    0   11 -93443.610 -93686.435  0.26%     -    0s
     0     0 -93607.081    0   17 -93443.610 -93607.081  0.17%     -    0s
     0     0 -93486.223    0    5 -93443.610 -93486.223  0.05%     -    0s
     0     0 -93481.126    0    8 -93443.610 -93481.126  0.04%     -    0s
     0     0          -    0      -93443.610 -93450.154  0.01%     -    0s

Cutting planes:
  Gomory: 1
  Implied bound: 5
  MIR: 6
  Flow cover: 4
  BQP: 1
  PSD: 1

Explored 1 nodes (489 simplex iterations) in 0.07 seconds (0.03 work units)
Thread count was 32 (of 256 available processors)

Solution count 9: -93443.6 -93432.3 -92892.1 ... 1.19176e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -9.344361014868e+04, best bound -9.345015353739e+04, gap 0.0070%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 105268.15
  Scenario: 19 demand increases, 41 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -93443.61
  [DEBUG]   S×d_nominal = 198711.76
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 198711.76 + -93443.61 = 105268.15
  [DEBUG]   Current θ from Master = 109836.88
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4568.73 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -10423.85
  Lower Bound (LB) = -10288.62
  Gap (UB-LB) = 4433.5061, Absolute Gap = 4433.5061, Relative Gap = 0.757202
  Not converged yet (gap = 4433.51 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 19 increases, 41 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394598 nonzeros
Model fingerprint: 0x6b02503b
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [9e-02, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 63750 rows and 25890 columns
Presolve time: 1.03s
Presolved: 75243 rows, 32530 columns, 468749 nonzeros
Variable types: 30271 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -371500.8959
Found heuristic solution: objective -172304.4497

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 75243 rows, 32530 columns, 468749 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   35929   -5.2059492e+04   0.000000e+00   1.790838e+08      5s
   49982   -2.0347901e+04   0.000000e+00   2.798818e+07     10s
   59670   -2.3241656e+03   0.000000e+00   2.731378e+08     15s
   68105    2.5794998e+03   0.000000e+00   1.627304e+08     20s
   76286    5.3931740e+03   0.000000e+00   2.118464e+06     25s
Concurrent spin time: 4.04s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 1.175607e+04, 62721 iterations, 29.03 seconds (65.10 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 11756.0715    0  277 -172304.45 11756.0715   107%     -   30s
H    0     0                    -161774.7015 11756.0715   107%     -   30s
H    0     0                    -114630.4089 11756.0715   110%     -   30s
H    0     0                    -99184.78632 11756.0715   112%     -   30s
H    0     0                    -96856.35015 11756.0715   112%     -   30s
H    0     0                    -96846.53043 11756.0715   112%     -   30s
H    0     0                    -65242.64476 11756.0715   118%     -   30s
H    0     0                    -36115.11117 11756.0715   133%     -   31s
H    0     0                    -35809.55070 11756.0715   133%     -   31s
H    0     0                    -35741.29798 11756.0715   133%     -   31s
H    0     0                    -10655.67391 11756.0715   210%     -   32s
H    0     0                    -10209.59078 11756.0715   215%     -   32s
     0     0 7591.24281    0  356 -10209.591 7591.24281   174%     -   42s
     0     0 6720.74579    0  369 -10209.591 6720.74579   166%     -   50s
     0     0 6720.74579    0  363 -10209.591 6720.74579   166%     -   55s
     0     0 6720.74579    0  360 -10209.591 6720.74579   166%     -   56s
     0     0 6720.74579    0  308 -10209.591 6720.74579   166%     -   57s
     0     0 5087.44711    0  359 -10209.591 5087.44711   150%     -   59s
     0     0 5087.44711    0  366 -10209.591 5087.44711   150%     -   59s
     0     0 5087.44711    0  358 -10209.591 5087.44711   150%     -   60s
     0     0 5087.44711    0  355 -10209.591 5087.44711   150%     -   61s
     0     0 5087.44711    0  358 -10209.591 5087.44711   150%     -   61s
     0     0 5023.21831    0  437 -10209.591 5023.21831   149%     -   72s
H    0     0                    -10174.46821 5023.00577   149%     -   72s
H    0     0                    -9824.157595 4792.63897   149%     -   76s
     0     0 4792.63897    0  445 -9824.1576 4792.63897   149%     -   76s
     0     0 4704.37321    0  435 -9824.1576 4704.37321   148%     -   79s
     0     0 4683.34263    0  441 -9824.1576 4683.34263   148%     -   80s
     0     0 4634.57896    0  442 -9824.1576 4634.57896   147%     -   82s
     0     0 4631.85696    0  450 -9824.1576 4631.85696   147%     -   82s
     0     0 4626.20203    0  451 -9824.1576 4626.20203   147%     -   83s
     0     0 4600.82847    0  450 -9824.1576 4600.82847   147%     -   85s
     0     0 4587.48028    0  459 -9824.1576 4587.48028   147%     -   85s
     0     0 4587.18116    0  455 -9824.1576 4587.18116   147%     -   86s
     0     0 3537.29693    0  468 -9824.1576 3537.29693   136%     -  100s
     0     0 3377.32030    0  474 -9824.1576 3377.32030   134%     -  106s
     0     0 3243.16856    0  472 -9824.1576 3243.16856   133%     -  109s
     0     0 3168.35578    0  490 -9824.1576 3168.35578   132%     -  112s
     0     0 3111.80649    0  480 -9824.1576 3111.80649   132%     -  114s
     0     0 3089.63165    0  480 -9824.1576 3089.63165   131%     -  115s
     0     0 3066.80447    0  486 -9824.1576 3066.80447   131%     -  116s
     0     0 3058.45894    0  482 -9824.1576 3058.45894   131%     -  117s
     0     0 3058.14627    0  483 -9824.1576 3058.14627   131%     -  117s
     0     0 2497.28936    0  517 -9824.1576 2497.28936   125%     -  128s
     0     0 2339.55982    0  519 -9824.1576 2339.55982   124%     -  132s
     0     0 2261.41662    0  522 -9824.1576 2261.41662   123%     -  135s
     0     0 2235.64697    0  523 -9824.1576 2235.64697   123%     -  137s
     0     0 2218.83631    0  523 -9824.1576 2218.83631   123%     -  139s
     0     0 2211.75969    0  528 -9824.1576 2211.75969   123%     -  140s
     0     0 2209.27979    0  519 -9824.1576 2209.27979   122%     -  141s
     0     0 2208.38357    0  515 -9824.1576 2208.38357   122%     -  141s
     0     0 2006.09126    0  597 -9824.1576 2006.09126   120%     -  145s
H    0     0                    -9783.861925 2004.51289   120%     -  146s
H    0     0                    -8498.099899 2004.51289   124%     -  146s
H    0     0                    -8462.977335 2004.51289   124%     -  146s
H    0     0                    -8431.496209 2004.51289   124%     -  146s
     0     0 1921.82977    0  601 -8431.4962 1921.82977   123%     -  148s
     0     0 1895.16723    0  587 -8431.4962 1895.16723   122%     -  150s
     0     0 1883.38079    0  593 -8431.4962 1883.38079   122%     -  152s
     0     0 1872.38907    0  601 -8431.4962 1872.38907   122%     -  153s
     0     0 1867.41315    0  603 -8431.4962 1867.41315   122%     -  154s
     0     0 1862.85334    0  608 -8431.4962 1862.85334   122%     -  155s
     0     0 1861.34011    0  607 -8431.4962 1861.34011   122%     -  155s
     0     0 1860.18876    0  603 -8431.4962 1860.18876   122%     -  155s
     0     0 1859.77550    0  604 -8431.4962 1859.77550   122%     -  156s
     0     0 1716.27217    0  611 -8431.4962 1716.27217   120%     -  160s
H    0     0                    -8186.298717 1716.04421   121%     -  163s
     0     0 1696.10203    0  612 -8186.2987 1696.10203   121%     -  164s
     0     0 1691.88969    0  601 -8186.2987 1691.88969   121%     -  165s
     0     0 1691.05278    0  607 -8186.2987 1691.05278   121%     -  165s
     0     0 1609.43243    0  622 -8186.2987 1609.43243   120%     -  169s
H    0     0                    -7984.400376 1608.98916   120%     -  169s
H    0     0                    -7970.813230 1608.98916   120%     -  169s
     0     0 1601.65797    0  624 -7970.8132 1601.65797   120%     -  170s
     0     0 1598.30623    0  630 -7970.8132 1598.30623   120%     -  171s
     0     0 1597.52078    0  579 -7970.8132 1597.52078   120%     -  172s
     0     0 1560.86406    0  632 -7970.8132 1560.86406   120%     -  174s
H    0     0                    -7955.556394 1560.19436   120%     -  175s
     0     0 1546.40311    0  635 -7955.5564 1546.40311   119%     -  177s
     0     0 1537.46590    0  631 -7955.5564 1537.46590   119%     -  178s
     0     0 1534.41977    0  640 -7955.5564 1534.41977   119%     -  178s
     0     0 1533.50085    0  641 -7955.5564 1533.50085   119%     -  179s
     0     0 1492.43441    0  569 -7955.5564 1492.43441   119%     -  181s
H    0     0                    -7524.315369 1491.52160   120%     -  182s
     0     0 1486.93966    0  576 -7524.3154 1486.93966   120%     -  183s
     0     0 1486.09204    0  638 -7524.3154 1486.09204   120%     -  183s
     0     0 1467.89005    0  634 -7524.3154 1467.89005   120%     -  186s
H    0     0                    -7374.556450 1466.62764   120%     -  190s
     0     0 1462.57241    0  579 -7374.5565 1462.57241   120%     -  191s
     0     0 1462.05760    0  575 -7374.5565 1462.05760   120%     -  192s
     0     0 1449.81535    0  642 -7374.5565 1449.81535   120%     -  194s
     0     0 1443.24097    0  580 -7374.5565 1443.24097   120%     -  195s
     0     0 1441.02555    0  580 -7374.5565 1441.02555   120%     -  196s
     0     0 1440.79717    0  585 -7374.5565 1440.79717   120%     -  196s
     0     0 1434.55567    0  571 -7374.5565 1434.55567   119%     -  198s
     0     0 1433.44880    0  637 -7374.5565 1433.44880   119%     -  199s
     0     0 1423.97252    0  575 -7374.5565 1423.97252   119%     -  201s
     0     0 1422.98603    0  581 -7374.5565 1422.98603   119%     -  201s
     0     0 1409.81445    0  573 -7374.5565 1409.81445   119%     -  203s
     0     0 1408.30864    0  642 -7374.5565 1408.30864   119%     -  203s
     0     0 1407.70922    0  638 -7374.5565 1407.70922   119%     -  204s
     0     0 1398.02310    0  576 -7374.5565 1398.02310   119%     -  206s
     0     0 1397.30132    0  575 -7374.5565 1397.30132   119%     -  206s
     0     0 1383.56346    0  572 -7374.5565 1383.56346   119%     -  208s
     0     0 1382.02282    0  570 -7374.5565 1382.02282   119%     -  208s
     0     0 1380.69810    0  581 -7374.5565 1380.69810   119%     -  209s
     0     0 1380.29341    0  579 -7374.5565 1380.29341   119%     -  209s
     0     0 1376.32227    0  578 -7374.5565 1376.32227   119%     -  210s
     0     0 1374.47362    0  579 -7374.5565 1374.47362   119%     -  211s
     0     0 1352.75091    0  636 -7374.5565 1352.75091   118%     -  214s
     0     0 1344.10626    0  657 -7374.5565 1344.10626   118%     -  217s
     0     0 1338.40355    0  657 -7374.5565 1338.40355   118%     -  217s
     0     0 1337.67904    0  591 -7374.5565 1337.67904   118%     -  218s
     0     0 1332.35350    0  577 -7374.5565 1332.35350   118%     -  220s
     0     0 1330.53662    0  650 -7374.5565 1330.53662   118%     -  220s
     0     0 1329.89851    0  656 -7374.5565 1329.89851   118%     -  220s
     0     0 1321.31180    0  655 -7374.5565 1321.31180   118%     -  222s
     0     0 1319.80042    0  657 -7374.5565 1319.80042   118%     -  223s
     0     0 1319.44940    0  659 -7374.5565 1319.44940   118%     -  223s
     0     0 1305.37297    0  653 -7374.5565 1305.37297   118%     -  225s
     0     0 1303.32490    0  578 -7374.5565 1303.32490   118%     -  226s
     0     0 1303.32490    0  586 -7374.5565 1303.32490   118%     -  226s
     0     0 1293.95579    0  586 -7374.5565 1293.95579   118%     -  228s
     0     0 1293.20192    0  595 -7374.5565 1293.20192   118%     -  229s
     0     0 1289.61402    0  592 -7374.5565 1289.61402   117%     -  230s
     0     0 1288.08823    0  592 -7374.5565 1288.08823   117%     -  231s
     0     0 1284.29848    0  581 -7374.5565 1284.29848   117%     -  232s
     0     0 1284.16162    0  581 -7374.5565 1284.16162   117%     -  234s
H    0     2                    -6484.220787 1283.77782   120%     -  371s
     0     2 1283.77782    0  581 -6484.2208 1283.77782   120%     -  371s
     1     4 1056.30124    1  579 -6484.2208 1283.65853   120%  6370  376s
     3     8  996.20480    2  570 -6484.2208 1095.51459   117%  6052  382s
     7    16  830.58847    3  591 -6484.2208  993.42394   115%  7832  391s
    15    32  783.46742    4  588 -6484.2208  830.04272   113%  8357  397s
    31    46 -156.45151    5  545 -6484.2208  782.66357   112%  8562  424s
    47    76 -888.77746    6  447 -6484.2208  782.66357   112% 10934  440s
H   50    76                    -6305.189344  782.66357   112% 10924  440s
H   72    76                    -6138.268347  782.66357   113% 10090  440s
    77   145 -1127.7467    7  432 -6138.2683  782.66357   113% 10213  458s
H  162   210                    -6109.413919  782.66357   113%  6480  470s
H  165   210                    -6101.348232  782.66357   113%  6428  470s
H  173   210                    -6056.912636  782.66357   113%  6318  470s
H  214   210                    -6050.492651  782.66357   113%  5670  470s
   243   296 -1369.5219    9  424 -6050.4927  782.66357   113%  5322  481s
   331   372 -1689.6757   11  329 -6050.4927  782.66357   113%  4644  491s
H  336   372                    -6042.691494  782.66357   113%  4625  491s
H  349   372                    -6011.006656  782.66357   113%  4529  491s
   422   450 -1932.6384   12  343 -6011.0067  782.66357   113%  4091  499s
H  514   533                    -5985.573685  782.66357   113%  3645  506s
H  538   533                    -5979.502905  782.66357   113%  3550  506s
H  566   533                    -5967.893451  782.66357   113%  3466  506s
   609   606 -1984.4894   13  243 -5967.8935  782.66357   113%  3298  514s
   703   637 -5056.4884   12  201 -5967.8935  782.66357   113%  3042  522s
H  715   637                    -5959.965573  782.66357   113%  3012  522s
   756   682 -2149.4576   13  389 -5959.9656  782.66357   113%  2955  528s
   823   713 -2304.2813   14  330 -5959.9656  782.66357   113%  2872  538s
   904   732 -2520.7485   14  399 -5959.9656  782.66357   113%  2784  547s
   967   764 -2318.5729   14  248 -5959.9656  782.66357   113%  2743  556s
  1032   779 -2635.7926   15  412 -5959.9656  782.66357   113%  2727  565s
  1067   816 -5737.1807   15  147 -5959.9656  782.66357   113%  2724  574s
  1130   874 -5512.0269   15  175 -5959.9656  782.66357   113%  2688  583s
  1230   939 -2726.2815   16  404 -5959.9656  782.66357   113%  2571  592s
  1333  1007 -3070.2596   19  396 -5959.9656  712.57624   112%  2485  603s
  1443  1067 -3468.6602   20  376 -5959.9656  586.14170   110%  2401  614s
  1539  1120 -3840.4016   18  363 -5959.9656  586.14170   110%  2376  624s
  1636  1173 -3696.7555   21  276 -5959.9656  586.14170   110%  2342  635s
  1748  1207 -3878.0359   22  324 -5959.9656  586.14170   110%  2296  647s
  1862  1250     cutoff   22      -5959.9656  586.14170   110%  2267  661s
  1965  1299 -4401.2114   24  405 -5959.9656  586.14170   110%  2263  673s
  2066  1344 -4652.0780   25  371 -5959.9656  586.14170   110%  2272  686s
  2150  1389 infeasible   28      -5959.9656  586.14170   110%  2286  701s
  2254  1416 -5595.6747   32  352 -5959.9656  477.98930   108%  2291  712s
  2287  1455 -5620.4052   32  313 -5959.9656  477.98930   108%  2325  723s
  2348  1480 infeasible   35      -5959.9656  477.98930   108%  2350  734s
H 2366  1480                    -5950.446378  477.98930   108%  2357  734s
  2385  1558 -498.70414   10  442 -5950.4464  477.98930   108%  2359  749s
  2501  1701 -2344.1074    9  516 -5950.4464  477.98930   108%  2375  763s
  2674  1814 -2369.3909   10  513 -5950.4464  477.98930   108%  2325  777s
  2855  1867 -2410.5832   11  502 -5950.4464  477.98930   108%  2282  793s
  3016  1914 -4199.9633   13  337 -5950.4464  127.14488   102%  2270  810s
  3152  2012 -4617.7065   14  342 -5950.4464  127.14488   102%  2282  827s
  3314  2028 -5201.3921   16  443 -5950.4464  127.14488   102%  2281  840s
H 3324  2028                    -5948.357279 -326.28058  94.5%  2278  840s
  3362  2111 infeasible   17      -5948.3573 -326.28058  94.5%  2287  857s
  3555  2188 infeasible   21      -5948.3573 -326.28058  94.5%  2289  876s
  3700  2278 -1131.5058    6  452 -5948.3573 -326.28058  94.5%  2318  894s
  3876  2372 -1640.0901   10  325 -5948.3573 -326.28058  94.5%  2325  915s
  4037  2442 -2596.0616   13  308 -5948.3573 -545.12341  90.8%  2342  935s
  4224  2445 -4805.4529   17  302 -5948.3573 -588.26777  90.1%  2350  953s
  4281  2474 -4872.9873   18  291 -5948.3573 -616.57376  89.6%  2366  971s
  4354  2497 -4959.7877   19  292 -5948.3573 -616.57376  89.6%  2375  985s
  4395  2522 -5000.0860   20  292 -5948.3573 -616.57376  89.6%  2383 1000s
  4440  2617 -5104.5739   21  264 -5948.3573 -616.57376  89.6%  2389 1022s
  4673  2694 -5146.1666   11  201 -5948.3573 -616.57376  89.6%  2350 1045s
  4890  2711 infeasible   15      -5948.3573 -778.06579  86.9%  2349 1072s
  4938  2712 -4724.7489   32  581 -5948.3573 -791.26167  86.7%  2359 1137s
  4940  2713 -4562.9349   16  277 -5948.3573 -791.26167  86.7%  2358 1169s
  4941  2714 -5129.6841   45  468 -5948.3573 -791.26167  86.7%  2358 1189s
  4942  2715 -2357.6566   12  562 -5948.3573 -791.26167  86.7%  2357 1201s
  4943  2715 -3610.5052   19  526 -5948.3573 -791.26167  86.7%  2357 1212s
  4944  2716 -1967.9483   16  589 -5948.3573 -791.26167  86.7%  2356 1221s
  4945  2717 -5782.5268   39  646 -5948.3573 -791.26167  86.7%  2356 1225s
  4946  2717 -3178.5406   10  623 -5948.3573 -791.26167  86.7%  2355 1230s
  4948  2719 -5109.1744   36  647 -5948.3573 -791.26167  86.7%  2354 1236s
  4950  2720 -3214.4989   21  564 -5948.3573 -791.26167  86.7%  2353 1241s
  4953  2722 -2582.2004   13  577 -5948.3573 -791.26167  86.7%  2352 1246s
  4954  2723 -5024.1083   21  659 -5948.3573 -791.26167  86.7%  2351 1256s
  4957  2725 -4522.3525   29  655 -5948.3573 -791.26167  86.7%  2350 1262s
  4958  2725 -2882.8475   12  648 -5948.3573 -791.26167  86.7%  2350 1271s
  4960  2727 -5499.0201   48  572 -5948.3573 -791.26167  86.7%  2349 1275s
  4961  2727 -3195.7130   17  633 -5948.3573 -791.26167  86.7%  2348 1281s
  4962  2728 -5553.8744   14  650 -5948.3573 -791.26167  86.7%  2348 1285s
  4963  2729 -4629.7465   19  647 -5948.3573 -791.26167  86.7%  2347 1294s
  4964  2729 -4113.8433   33  634 -5948.3573 -791.26167  86.7%  2347 1296s
  4966  2731 -3238.6473   19  633 -5948.3573 -791.26167  86.7%  2346 1305s
  4968  2732 -5553.2372    7  625 -5948.3573 -791.26167  86.7%  2345 1314s
  4969  2733 -5819.5854   42  633 -5948.3573 -791.26167  86.7%  2344 1317s
  4970  2733 -1362.8861    8  687 -5948.3573 -791.26167  86.7%  2344 1323s
  4971  2734 -2954.1246   11  678 -5948.3573 -791.26167  86.7%  2343 1326s
  4972  2735 -5779.9206   32  637 -5948.3573 -791.26167  86.7%  2343 1331s
  4973  2735 -5335.7681   34  637 -5948.3573 -791.26167  86.7%  2342 1365s
  4974  2736 -5742.4427   51  637 -5948.3573 -791.26167  86.7%  2342 1395s
  4975  2740 -791.26167   11  621 -5948.3573 -791.26167  86.7%  2390 1403s
  4977  2743 -791.26167   12  537 -5948.3573 -791.26167  86.7%  2391 1411s
  4981  2748 -791.26167   13  530 -5948.3573 -791.26167  86.7%  2395 1422s
  4989  2757 -791.26167   14  546 -5948.3573 -791.26167  86.7%  2398 1441s
  5003  2762 -791.26167   15  448 -5948.3573 -791.26167  86.7%  2421 1460s
  5015  2783 -1577.1905   16  420 -5948.3573 -791.26167  86.7%  2443 1507s
  5044  2853 -1648.8567   17  332 -5948.3573 -791.26167  86.7%  2497 1526s
  5139  2874 -1800.6918   18  411 -5948.3573 -791.26167  86.7%  2558 1538s
  5203  2912 -1859.8212   19  414 -5948.3573 -791.26167  86.7%  2574 1551s
  5291  2913 -2151.6600   20  414 -5948.3573 -791.26167  86.7%  2591 1562s
  5360  2914 -2941.2039   21  303 -5948.3573 -791.26167  86.7%  2620 1573s
  5419  2907 -3093.0967   22  304 -5948.3573 -791.26167  86.7%  2663 1593s
  5480  2908 -3865.9585   23  416 -5948.3573 -791.26167  86.7%  2704 1604s
  5549  2888 -4166.2507   24  411 -5948.3573 -791.26167  86.7%  2746 1614s
  5602  2874 -4251.4951   25  411 -5948.3573 -791.26167  86.7%  2773 1625s
  5671  2860 -4286.5691   26  402 -5948.3573 -791.26167  86.7%  2785 1636s
  5742  2835 -4410.6401   30  404 -5948.3573 -791.26167  86.7%  2813 1647s
  5797  2832 -5740.3146   32  359 -5948.3573 -791.26167  86.7%  2836 1658s
  5833  2832 -5833.3996   33  352 -5948.3573 -791.26167  86.7%  2859 1667s
  5890  2822 -2596.2098   20  495 -5948.3573 -791.26167  86.7%  2880 1680s
  5935  2822     cutoff   21      -5948.3573 -791.26167  86.7%  2907 1692s
  5998  2805 -2728.2313   21  498 -5948.3573 -791.26167  86.7%  2930 1703s
  6052  2800 -2837.6373   22  483 -5948.3573 -791.26167  86.7%  2946 1722s
  6120  2789 -2853.3606   23  489 -5948.3573 -791.26167  86.7%  2975 1739s
  6201  2758 -3298.0808   24  409 -5948.3573 -791.26167  86.7%  3003 1753s
  6283  2738 -3457.3817   26  403 -5948.3573 -791.26167  86.7%  3045 1772s
  6345  2733 -4476.8754   27  270 -5948.3573 -791.26167  86.7%  3081 1792s
  6425  2721 infeasible   28      -5948.3573 -791.26167  86.7%  3117 1806s
  6518  2687 -4932.4558   32  265 -5948.3573 -816.14419  86.3%  3158 1820s
  6574  2669 -5034.1866   33  233 -5948.3573 -816.14419  86.3%  3188 1835s
  6655  2645 -5758.5836   35  234 -5948.3573 -1615.3422  72.8%  3220 1850s
  6766  2623     cutoff   38      -5948.3573 -1740.3370  70.7%  3244 1868s
  6865  2580 -2175.3588   18  270 -5948.3573 -1740.3370  70.7%  3278 1886s
  6966  2553 -3631.4038   19  195 -5948.3573 -1930.1962  67.6%  3325 1904s
  7072  2520     cutoff   20      -5948.3573 -1930.1962  67.6%  3371 1923s
  7190  2476 -4657.3966   21  312 -5948.3573 -2175.8387  63.4%  3420 1942s
  7313  2433 -4775.5338   22  297 -5948.3573 -2485.4948  58.2%  3467 1961s
  7430  2395     cutoff   22      -5948.3573 -2647.3792  55.5%  3506 1979s
  7489  2370     cutoff   23      -5948.3573 -2919.2429  50.9%  3539 1997s
  7560  2341 -5665.1527   24  538 -5948.3573 -2919.2429  50.9%  3563 2016s
  7653  2305     cutoff   25      -5948.3573 -2919.2429  50.9%  3595 2036s
  7761  2233 -5264.4399   23  245 -5948.3573 -3104.1359  47.8%  3625 2058s
  7938  2159 -5525.2766   24  318 -5948.3573 -3104.1359  47.8%  3641 2082s
  8138  2077 -5545.7815   25  356 -5948.3573 -3181.7513  46.5%  3651 2106s
  8336  2006 -5575.6632   26  362 -5948.3573 -3442.6108  42.1%  3673 2132s
  8638  1874 -5482.2139   23  397 -5948.3573 -3442.6108  42.1%  3643 2151s
  8907  1708 -5824.0415   25  281 -5948.3573 -4142.0530  30.4%  3610 2171s
  9178  1550 infeasible   35      -5948.3573 -4142.0530  30.4%  3572 2195s
  9656  1315 infeasible   36      -5948.3573 -4889.1664  17.8%  3465 2212s
 10314  1171 -5818.5836   59   54 -5948.3573 -5140.8855  13.6%  3298 2220s
 11285   871 -5908.7404   70   44 -5948.3573 -5770.4080  2.99%  3040 2229s
 12318   761 -5930.6643   64   36 -5948.3573 -5860.8087  1.47%  2807 2233s
H12415   591                    -5944.442883 -5860.8087  1.41%  2786 2233s
*12554   473              86    -5931.618373 -5863.1802  1.15%  2757 2233s
 13671   490     cutoff   66      -5931.6184 -5882.5480  0.83%  2542 2237s
H13769   490                    -5926.085496 -5885.0632  0.69%  2525 2237s
H13976   490                    -5917.938426 -5886.8220  0.53%  2490 2237s
H14212   490                    -5904.372283 -5889.1336  0.26%  2451 2237s

Cutting planes:
  MIR: 801
  Flow cover: 1637
  Zero half: 5
  RLT: 12
  Relax-and-lift: 52

Explored 15598 nodes (35316043 simplex iterations) in 2239.15 seconds (6268.55 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -5904.37 -5917.94 -5926.09 ... -5979.5
No other solutions better than -5904.37

Optimal solution found (tolerance 1.00e-04)
Best objective -5.904372283067e+03, best bound -5.904372283067e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 2239.17s
  Master Objective (UB) = -5904.37, θ = 110217.70
  Upper Bound (UB) = -5904.37

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 110217.70
  [DEBUG]   ✓ Scenario 0: θ = 110217.70 ≤ Q = 110217.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 110217.70 ≤ Q = 110217.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 110217.70 ≤ Q = 110217.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 110217.70 ≤ Q = 110217.70 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 110217.70 ≤ Q = 110217.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 110217.70 ≤ Q = 110217.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 110217.70 ≤ Q = 110217.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 110217.70 ≤ Q = 110217.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 110217.70 ≤ Q = 110217.70 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x1ef2df57
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xe10d20a9
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.193638e+13
Presolve removed 2602 rows and 1895 columns
Presolve time: 0.00s
Presolved: 491 rows, 494 columns, 1384 nonzeros
Found heuristic solution: objective 6131615.4152
Variable types: 334 continuous, 160 integer (160 binary)

Root relaxation: objective -1.182956e+05, 232 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -118295.58    0  122 6131615.42 -118295.58   102%     -    0s
H    0     0                    -85675.70260 -118295.58  38.1%     -    0s
H    0     0                    -86270.06852 -118295.58  37.1%     -    0s
     0     0 -94657.626    0   99 -86270.069 -94657.626  9.72%     -    0s
H    0     0                    -90572.66019 -94627.269  4.48%     -    0s
H    0     0                    -90874.58985 -94627.269  4.13%     -    0s
H    0     0                    -91514.13129 -94627.269  3.40%     -    0s
H    0     0                    -91816.06094 -94627.269  3.06%     -    0s
     0     0 -94003.064    0  100 -91816.061 -94003.064  2.38%     -    0s
     0     0 -93963.276    0   99 -91816.061 -93963.276  2.34%     -    0s
H    0     0                    -92028.55398 -93963.276  2.10%     -    0s
     0     0 -93697.062    0   99 -92028.554 -93697.062  1.81%     -    0s
     0     0 -93679.516    0   98 -92028.554 -93679.516  1.79%     -    0s
     0     0 -93678.084    0   98 -92028.554 -93678.084  1.79%     -    0s
     0     0 -93313.648    0   88 -92028.554 -93313.648  1.40%     -    0s
     0     0 -93291.070    0   95 -92028.554 -93291.070  1.37%     -    0s
     0     0 -93279.727    0   92 -92028.554 -93279.727  1.36%     -    0s
     0     0 -93093.853    0   89 -92028.554 -93093.853  1.16%     -    0s
     0     0 -93067.112    0   89 -92028.554 -93067.112  1.13%     -    0s
     0     0 -92985.376    0   67 -92028.554 -92985.376  1.04%     -    0s
     0     0 -92959.274    0   79 -92028.554 -92959.274  1.01%     -    0s
     0     0 -92940.092    0   81 -92028.554 -92940.092  0.99%     -    0s
     0     0 -92839.255    0   62 -92028.554 -92839.255  0.88%     -    0s
     0     0 -92836.128    0   60 -92028.554 -92836.128  0.88%     -    0s
     0     2 -92836.016    0   60 -92028.554 -92836.016  0.88%     -    0s
*  256   177              13    -92287.89216 -92462.690  0.19%   8.6    0s
*  270   177              11    -92315.79606 -92462.690  0.16%   8.6    0s

Cutting planes:
  Gomory: 21
  Implied bound: 6
  MIR: 160
  Flow cover: 3
  RLT: 58
  Relax-and-lift: 8
  BQP: 1

Explored 548 nodes (3970 simplex iterations) in 0.14 seconds (0.09 work units)
Thread count was 32 (of 256 available processors)

Solution count 9: -92315.8 -92287.9 -92028.6 ... 1.19364e+13
No other solutions better than -92315.8

Optimal solution found (tolerance 1.00e-04)
Best objective -9.231579605923e+04, best bound -9.231579605923e+04, gap 0.0000%
  Subproblem solved in 0.16s
  Worst-case operational profit (Z_SP) = 106423.71
  Scenario: 17 demand increases, 43 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -92315.80
  [DEBUG]   S×d_nominal = 198739.51
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 198739.51 + -92315.80 = 106423.71
  [DEBUG]   Current θ from Master = 110217.70
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3793.98 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -9698.36
  Lower Bound (LB) = -9698.36
  Gap (UB-LB) = 3793.9849, Absolute Gap = 3793.9849, Relative Gap = 0.642572
  Not converged yet (gap = 3793.98 > ε = 200)

  [DEBUG] Adding NEW scenario 9 to Master Problem...
  [DEBUG] New scenario pattern: 17 increases, 43 decreases
    [DEBUG] Scenario 9 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 9 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 9]
    [DEBUG]   - Total constraints in model: 154283
    [DEBUG]   - Total variables in model: 64660
  [DEBUG] Total scenarios in Master: 10
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 10
================================================================================
[Iteration 10] Solving Master Problem...
  Current scenarios in Master: 10
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 154283 rows, 64660 columns and 437829 nonzeros
Model fingerprint: 0x2decae08
Variable types: 62401 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [9e-02, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 70840 rows and 28770 columns
Presolve time: 1.02s
Presolved: 83443 rows, 35890 columns, 512239 nonzeros
Variable types: 33631 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -372311.6712
Found heuristic solution: objective -319975.6300
Found heuristic solution: objective -172304.4497

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.15s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.579e+06
 Factor NZ  : 7.628e+06 (roughly 100 MB of memory)
 Factor Ops : 1.295e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.66934710e+07  1.39216313e+08  8.59e+04 2.11e+01  6.95e+04     2s
   1  -1.23485239e+07  1.21163434e+08  5.93e+04 6.53e+01  4.78e+04     2s
   2  -3.49693638e+06  9.58438525e+07  1.60e+04 1.76e+01  1.35e+04     2s
   3  -6.62803403e+05  6.76230136e+07  7.11e+02 4.07e-01  1.00e+03     2s
   4  -5.13147971e+05  4.65772640e+07  2.46e+02 2.64e-01  4.84e+02     2s
   5  -4.41839803e+05  3.05075217e+07  1.05e+02 1.62e-01  2.70e+02     2s
   6  -3.78909462e+05  2.08297502e+07  2.81e+01 1.05e-01  1.54e+02     2s
   7  -3.53693894e+05  1.48675494e+07  1.75e+01 7.32e-02  1.07e+02     2s
   8  -2.84072623e+05  8.09115051e+06  9.39e+00 4.04e-02  5.76e+01     2s
   9  -1.56167845e+05  4.11123728e+06  3.92e+00 1.90e-02  2.86e+01     2s
  10  -1.18240726e+05  2.00045763e+06  2.51e+00 9.30e-03  1.41e+01     2s
  11  -7.51885073e+04  1.38866192e+06  1.27e+00 6.45e-03  9.64e+00     2s
  12  -5.75000128e+04  8.48258933e+05  8.59e-01 4.03e-03  5.95e+00     2s
  13  -3.79145214e+04  3.39774038e+05  4.86e-01 1.53e-03  2.48e+00     2s
  14  -2.12809226e+04  1.87187011e+05  2.61e-01 7.71e-04  1.36e+00     2s
  15  -1.58606572e+04  1.39135395e+05  2.07e-01 4.75e-04  1.01e+00     2s
  16  -9.06502259e+03  1.05799764e+05  1.42e-01 4.57e-04  7.51e-01     2s
  17  -3.97438551e+03  8.30174051e+04  1.03e-01 4.06e-04  5.69e-01     2s
  18   2.06705480e+02  6.32126214e+04  7.47e-02 7.60e-04  4.12e-01     3s
  19   3.59372463e+03  5.00363139e+04  5.46e-02 1.23e-03  3.03e-01     3s
  20   6.09424579e+03  3.75557086e+04  4.10e-02 9.46e-04  2.06e-01     3s
  21   8.43893691e+03  3.29499079e+04  2.96e-02 7.55e-04  1.60e-01     3s
  22   9.51513036e+03  2.57091454e+04  2.47e-02 9.40e-04  1.06e-01     3s
  23   1.09848801e+04  2.37360661e+04  1.88e-02 7.51e-04  8.33e-02     3s
  24   1.19135439e+04  2.27403978e+04  1.51e-02 6.62e-04  7.08e-02     3s
  25   1.25653808e+04  2.12267155e+04  1.26e-02 5.32e-04  5.66e-02     3s
  26   1.32935443e+04  1.93875955e+04  9.90e-03 3.38e-04  3.98e-02     3s
  27   1.40266100e+04  1.83379192e+04  7.19e-03 2.84e-04  2.82e-02     3s
  28   1.41311949e+04  1.81180547e+04  6.80e-03 2.50e-04  2.61e-02     3s
  29   1.47059533e+04  1.76408292e+04  4.71e-03 1.96e-04  1.92e-02     3s
  30   1.48405700e+04  1.72388049e+04  4.24e-03 1.44e-04  1.57e-02     3s
  31   1.50559205e+04  1.71054049e+04  3.53e-03 1.26e-04  1.34e-02     3s
  32   1.51770324e+04  1.68544173e+04  3.10e-03 9.47e-05  1.10e-02     3s
  33   1.53707258e+04  1.67783136e+04  2.45e-03 1.24e-04  9.20e-03     3s
  34   1.55034128e+04  1.67145216e+04  2.00e-03 1.11e-04  7.92e-03     3s
  35   1.58202645e+04  1.64297798e+04  9.28e-04 6.20e-05  3.98e-03     3s
  36   1.59909556e+04  1.62854949e+04  4.11e-04 3.14e-05  1.92e-03     3s
  37   1.60343053e+04  1.62348697e+04  2.84e-04 2.08e-05  1.31e-03     3s
  38   1.60537340e+04  1.61897786e+04  2.23e-04 1.15e-05  8.89e-04     3s
  39   1.61147280e+04  1.61363345e+04  4.32e-05 5.92e-07  1.41e-04     3s
  40   1.61292373e+04  1.61314539e+04  5.52e-06 1.73e-06  1.45e-05     3s
  41   1.61314073e+04  1.61314207e+04  1.61e-08 1.90e-08  8.79e-08     3s
  42   1.61314173e+04  1.61314173e+04  4.66e-10 3.19e-11  9.23e-11     3s

Barrier solved model in 42 iterations and 3.30 seconds (6.70 work units)
Optimal objective 1.61314173e+04

Concurrent spin time: 0.13s

Solved with barrier

Root relaxation: objective 1.613142e+04, 30400 iterations, 3.32 seconds (8.75 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 16131.4173    0  407 -172304.45 16131.4173   109%     -    5s
H    0     0                    -161774.7015 16131.4173   110%     -    5s
H    0     0                    -99154.42926 16131.4173   116%     -    5s
H    0     0                    -74559.94786 16131.4173   122%     -    5s
H    0     0                    -33925.01611 16131.4173   148%     -    5s
H    0     0                    -30440.03710 16131.4173   153%     -    5s
H    0     0                    -29452.54845 16131.4173   155%     -    5s
H    0     0                    -29096.59652 16131.4173   155%     -    5s
H    0     0                    -18007.02124 16131.4173   190%     -    6s
H    0     0                    -17831.75240 16131.4173   190%     -    6s
H    0     0                    -17578.81896 16131.4173   192%     -    6s
H    0     0                    -12606.69170 16125.3293   228%     -    6s
H    0     0                    -12386.02540 16125.3293   230%     -    6s
     0     0 9138.76270    0  423 -12386.025 9138.76270   174%     -   19s
     0     0 8691.80639    0  415 -12386.025 8691.80639   170%     -   25s
     0     0 8527.56808    0  407 -12386.025 8527.56808   169%     -   29s
     0     0 8443.47346    0  412 -12386.025 8443.47346   168%     -   31s
     0     0 8411.08060    0  407 -12386.025 8411.08060   168%     -   32s
     0     0 8411.08060    0  415 -12386.025 8411.08060   168%     -   34s
     0     0 8411.08060    0  415 -12386.025 8411.08060   168%     -   35s
     0     0 8411.08060    0  414 -12386.025 8411.08060   168%     -   37s
     0     0 8410.23022    0  421 -12386.025 8410.23022   168%     -   39s
     0     0 8364.63797    0  417 -12386.025 8364.63797   168%     -   40s
     0     0 8363.82814    0  420 -12386.025 8363.82814   168%     -   40s
H    0     0                    -12184.81356 6285.00011   152%     -   57s
     0     0 6285.00011    0  418 -12184.814 6285.00011   152%     -   58s
H    0     0                    -12118.20987 6283.61318   152%     -   58s
     0     0 6056.61362    0  415 -12118.210 6056.61362   150%     -   65s
     0     0 5957.48988    0  382 -12118.210 5957.48988   149%     -   70s
     0     0 5841.92466    0  389 -12118.210 5841.92466   148%     -   74s
     0     0 5805.81953    0  387 -12118.210 5805.81953   148%     -   77s
     0     0 5800.80145    0  386 -12118.210 5800.80145   148%     -   79s
     0     0 5666.10796    0  379 -12118.210 5666.10796   147%     -   85s
     0     0 5650.56497    0  374 -12118.210 5650.56497   147%     -   88s
     0     0 5632.07081    0  379 -12118.210 5632.07081   146%     -   89s
     0     0 5630.99639    0  376 -12118.210 5630.99639   146%     -   90s
H    0     0                    -12112.51238 4117.60879   134%     -  111s
H    0     0                    -11973.69248 4117.60879   134%     -  111s
H    0     0                    -11695.95770 4117.60879   135%     -  111s
H    0     0                    -11648.27435 4117.60879   135%     -  111s
     0     0 4117.60879    0  419 -11648.274 4117.60879   135%     -  111s
     0     0 3764.16578    0  490 -11648.274 3764.16578   132%     -  120s
     0     0 3710.19366    0  496 -11648.274 3710.19366   132%     -  125s
     0     0 3597.53136    0  495 -11648.274 3597.53136   131%     -  132s
     0     0 3563.66513    0  556 -11648.274 3563.66513   131%     -  136s
     0     0 3556.00571    0  564 -11648.274 3556.00571   131%     -  139s
     0     0 3544.71477    0  492 -11648.274 3544.71477   130%     -  140s
     0     0 3543.00900    0  491 -11648.274 3543.00900   130%     -  141s
     0     0 3532.55331    0  487 -11648.274 3532.55331   130%     -  142s
     0     0 3525.09711    0  488 -11648.274 3525.09711   130%     -  143s
     0     0 3510.16177    0  493 -11648.274 3510.16177   130%     -  145s
     0     0 3500.61755    0  496 -11648.274 3500.61755   130%     -  146s
     0     0 3496.55011    0  498 -11648.274 3496.55011   130%     -  148s
     0     0 3495.59465    0  499 -11648.274 3495.59465   130%     -  148s
     0     0 2949.04035    0  455 -11648.274 2949.04035   125%     -  161s
     0     0 2752.06543    0  583 -11648.274 2752.06543   124%     -  168s
H    0     0                    -11573.95765 2657.43444   123%     -  172s
H    0     0                    -11547.32376 2657.43444   123%     -  172s
     0     0 2657.43444    0  528 -11547.324 2657.43444   123%     -  172s
     0     0 2624.60693    0  528 -11547.324 2624.60693   123%     -  177s
     0     0 2611.93585    0  595 -11547.324 2611.93585   123%     -  179s
     0     0 2601.25381    0  596 -11547.324 2601.25381   123%     -  181s
     0     0 2597.83297    0  591 -11547.324 2597.83297   122%     -  181s
     0     0 2596.66990    0  599 -11547.324 2596.66990   122%     -  182s
     0     0 2324.00611    0  597 -11547.324 2324.00611   120%     -  190s
     0     0 2219.41732    0  615 -11547.324 2219.41732   119%     -  195s
     0     0 2201.70432    0  610 -11547.324 2201.70432   119%     -  197s
     0     0 2183.93526    0  611 -11547.324 2183.93526   119%     -  200s
     0     0 2174.96341    0  606 -11547.324 2174.96341   119%     -  201s
     0     0 2173.98906    0  611 -11547.324 2173.98906   119%     -  201s
     0     0 1980.64080    0  543 -11547.324 1980.64080   117%     -  209s
     0     0 1944.62334    0  544 -11547.324 1944.62334   117%     -  213s
H    0     0                    -10925.88209 1924.30619   118%     -  217s
H    0     0                    -10047.10632 1924.30619   119%     -  217s
H    0     0                    -9983.581663 1924.30619   119%     -  217s
H    0     0                    -9928.491102 1924.30619   119%     -  217s
     0     0 1924.30619    0  541 -9928.4911 1924.30619   119%     -  217s
     0     0 1914.90531    0  543 -9928.4911 1914.90531   119%     -  219s
     0     0 1909.47058    0  553 -9928.4911 1909.47058   119%     -  221s
     0     0 1905.01093    0  555 -9928.4911 1905.01093   119%     -  223s
H    0     0                    -9823.768063 1902.15510   119%     -  225s
H    0     0                    -9818.284562 1902.15510   119%     -  225s
     0     0 1902.15510    0  557 -9818.2846 1902.15510   119%     -  225s
     0     0 1901.68180    0  556 -9818.2846 1901.68180   119%     -  226s
     0     0 1822.70567    0  612 -9818.2846 1822.70567   119%     -  232s
     0     0 1813.67488    0  601 -9818.2846 1813.67488   118%     -  235s
     0     0 1811.27760    0  603 -9818.2846 1811.27760   118%     -  236s
     0     0 1808.97880    0  612 -9818.2846 1808.97880   118%     -  237s
     0     0 1808.10983    0  615 -9818.2846 1808.10983   118%     -  237s
     0     0 1756.53254    0  602 -9818.2846 1756.53254   118%     -  242s
H    0     0                    -9797.697451 1755.87940   118%     -  242s
H    0     0                    -9793.208205 1755.87940   118%     -  242s
     0     0 1749.86115    0  606 -9793.2082 1749.86115   118%     -  244s
     0     0 1744.75773    0  624 -9793.2082 1744.75773   118%     -  246s
     0     0 1735.95380    0  614 -9793.2082 1735.95380   118%     -  248s
     0     0 1734.55659    0  631 -9793.2082 1734.55659   118%     -  249s
     0     0 1718.39474    0  624 -9793.2082 1718.39474   118%     -  253s
H    0     0                    -9789.968179 1718.32025   118%     -  253s
     0     0 1715.48090    0  629 -9789.9682 1715.48090   118%     -  254s
     0     0 1712.00732    0  640 -9789.9682 1712.00732   117%     -  255s
     0     0 1711.54681    0  634 -9789.9682 1711.54681   117%     -  256s
     0     0 1700.52612    0  634 -9789.9682 1700.52612   117%     -  259s
H    0     0                    -9771.807329 1699.21362   117%     -  260s
     0     0 1697.87709    0  561 -9771.8073 1697.87709   117%     -  260s
     0     0 1697.04655    0  569 -9771.8073 1697.04655   117%     -  261s
     0     0 1686.88285    0  563 -9771.8073 1686.88285   117%     -  264s
H    0     0                    -9763.221427 1686.78780   117%     -  264s
H    0     0                    -9688.292139 1686.78780   117%     -  264s
     0     0 1686.66776    0  558 -9688.2921 1686.66776   117%     -  265s
     0     0 1679.60065    0  577 -9688.2921 1679.60065   117%     -  268s
     0     0 1673.98132    0  577 -9688.2921 1673.98132   117%     -  270s
H    0     0                    -9536.319332 1673.98132   118%     -  289s
H    0     0                    -9532.836726 1673.98132   118%     -  289s
H    0     0                    -9526.562652 1673.98132   118%     -  308s
H    0     0                    -9490.738066 1673.98132   118%     -  310s
H    0     0                    -8925.176117 1673.98132   119%     -  311s
H    0     0                    -8676.706039 1673.98132   119%     -  311s
H    0     0                    -8232.791924 1673.98132   120%     -  311s
H    0     0                    -8165.580747 1673.98132   121%     -  312s
H    0     0                    -7875.087212 1673.98132   121%     -  312s
     0     2 1673.98132    0  577 -7875.0872 1673.98132   121%     -  313s
     1     4 1635.24481    1  537 -7875.0872 1673.98132   121%  4949  319s
     3     8 1595.95647    2  542 -7875.0872 1634.24583   121%  5008  324s
     7    16 1459.41266    3  548 -7875.0872 1594.60295   120%  6923  334s
    15    31 1060.22025    4  444 -7875.0872 1459.38856   119%  8257  342s
    30    40  526.17500    5  534 -7875.0872 1459.23789   119%  8379  558s
    45    59 -474.19669    6  421 -7875.0872 1082.08810   114% 11379  599s
    70   157   40.34689    6  497 -7875.0872 1080.30776   114% 12106  621s
   180   249 -276.93117    7  497 -7875.0872 1080.30776   114%  6579  633s
   272   309 -338.14790    9  493 -7875.0872 1080.30776   114%  5181  645s
   342   339 -551.30845   12  430 -7875.0872 1080.30776   114%  4663  653s
H  349   339                    -7824.307121 1080.30776   114%  4621  653s
H  373   339                    -7763.230513 1080.30776   114%  4528  653s
   379   378 -619.85355   13  418 -7763.2305 1080.30776   114%  4503  666s
   445   391 -1022.6588   15  410 -7763.2305 1080.30776   114%  4211  677s
H  454   391                    -7551.175941 1080.30776   114%  4179  677s
H  454   391                    -7466.158394 1080.30776   114%  4179  677s
H  457   391                    -7372.931231 1080.30776   115%  4152  677s
   484   419 -3517.8834   16  263 -7372.9312 1057.23788   114%  4103  689s
H  485   419                    -7322.671419 1057.23788   114%  4095  689s
H  488   419                    -7188.798542 1057.23788   115%  4086  689s
H  512   419                    -7161.041078 1057.23788   115%  4028  689s
H  520   419                    -7121.407195 1057.23788   115%  4070  689s
   536   434 -3571.0448   17  264 -7121.4072 1057.23788   115%  4040  701s
   573   462 -1408.3074   16  368 -7121.4072 1057.23788   115%  4001  712s
H  586   462                    -7110.291072 1057.23788   115%  3961  712s
H  599   462                    -6934.434976 1057.23788   115%  3945  712s
   618   496 -3734.8503   17  248 -6934.4350 1057.23788   115%  3940  725s
   678   509 -6003.3863   19  247 -6934.4350 1057.23788   115%  3803  737s
H  685   509                    -6525.709246 1057.23788   116%  3797  737s
H  704   509                    -6359.640242 1057.23788   117%  3786  737s
   709   511     cutoff   20      -6359.6402 1057.23788   117%  3775  750s
   781   525     cutoff   20      -6359.6402 1057.23788   117%  3615  765s
H  788   525                    -6334.410789 1057.23788   117%  3615  765s
H  800   525                    -6333.749766 1057.23788   117%  3594  765s
H  803   525                    -6184.158761 1057.23788   117%  3582  765s
   837   549 -5945.4044   19  197 -6184.1588 1057.23788   117%  3590  777s
H  840   549                    -6152.545770 1057.23788   117%  3584  777s
H  864   549                    -6109.248957 1057.23788   117%  3580  777s
   875   575     cutoff   20      -6109.2490 1057.23788   117%  3590  792s
H  895   575                    -6107.134091 1057.23788   117%  3580  792s
H  909   575                    -6091.985809 1057.23788   117%  3558  792s
H  910   575                    -6078.217215 1057.23788   117%  3555  792s
   935   603 -2324.2776    6  403 -6078.2172 1057.23788   117%  3500  808s
  1015   621 -3263.6001    7  360 -6078.2172  965.19150   116%  3460  822s
H 1031   621                    -6005.409693  736.51421   112%  3464  822s
  1055   639 -4467.6465    8  339 -6005.4097  650.63492   111%  3481  836s
H 1079   639                    -6000.448078  650.63492   111%  3486  836s
H 1093   639                    -5979.507884  650.63492   111%  3499  836s
  1095   670 -2654.7050   14  333 -5979.5079  650.63492   111%  3500  849s
H 1098   670                    -5956.236072  650.63492   111%  3503  849s
H 1110   670                    -5948.357279  650.63492   111%  3481  849s
  1158   695     cutoff    9      -5948.3573  650.63492   111%  3424  864s
  1201   716 -5417.3611   16  178 -5948.3573  650.63492   111%  3433  878s
  1256   734 -5594.9108   18  167 -5948.3573  650.63492   111%  3403  895s
  1338   778 -4108.5050   12  200 -5948.3573  650.63492   111%  3338  913s
  1429   824     cutoff   13      -5948.3573  650.63492   111%  3271  930s
  1523   872     cutoff   15      -5948.3573  650.63492   111%  3217  947s
  1637   900     cutoff   16      -5948.3573  650.63492   111%  3155  967s
  1746   957 infeasible   15      -5948.3573  650.63492   111%  3101  987s
  1843   982 -5363.9713   11  418 -5948.3573  650.63492   111%  3105 1004s
  1882  1019 infeasible   12      -5948.3573  650.63492   111%  3113 1023s
  1949  1056     cutoff   17      -5948.3573 -101.86965  98.3%  3110 1040s
  2038  1108     cutoff   11      -5948.3573 -101.86965  98.3%  3061 1057s
  2122  1150     cutoff    8      -5948.3573 -101.86965  98.3%  3029 1077s
  2216  1198     cutoff   13      -5948.3573 -236.50694  96.0%  2992 1097s
  2316  1271 -4188.0945    9  306 -5948.3573 -431.33352  92.7%  2952 1116s
  2433  1323 -4932.1150   13  281 -5948.3573 -431.33352  92.7%  2900 1139s
  2588  1348 -5562.0584   22  210 -5948.3573 -431.33352  92.7%  2831 1164s
  2735  1369     cutoff   32      -5948.3573 -432.90873  92.7%  2808 1189s
  2813  1436 -4284.7934   18  504 -5948.3573 -432.90873  92.7%  2838 1215s
  2909  1500 -5119.6381   20  383 -5948.3573 -432.90873  92.7%  2858 1243s
  3053  1538 -5768.9661   24  334 -5948.3573 -552.42867  90.7%  2866 1276s
  3238  1584 -4785.6203   13  404 -5948.3573 -582.37610  90.2%  2867 1302s
  3368  1639 -5248.2880   14  382 -5948.3573 -582.37610  90.2%  2860 1336s
  3519  1682 infeasible   16      -5948.3573 -582.37610  90.2%  2872 1372s
  3692  1766     cutoff   17      -5948.3573 -772.84208  87.0%  2877 1411s
  3894  1852 infeasible   12      -5948.3573 -881.37249  85.2%  2874 1450s
  4164  1955     cutoff   13      -5948.3573 -881.37249  85.2%  2831 1490s
  4430  2035     cutoff   31      -5948.3573 -963.86863  83.8%  2808 1523s
  4642  2129 -1659.1056   11  413 -5948.3573 -1036.0755  82.6%  2775 1565s
  4918  2212 -2118.1212   14  540 -5948.3573 -1036.0755  82.6%  2760 1606s
  5167  2291 -3482.3795   18  516 -5948.3573 -1057.7378  82.2%  2754 1654s
  5439  2401 -5171.5081   23  502 -5948.3573 -1151.4716  80.6%  2757 1704s
  5711  2402 -5460.3651   43  577 -5948.3573 -1158.5398  80.5%  2766 1772s
  5713  2403 -4533.5002   23  407 -5948.3573 -1158.5398  80.5%  2765 1782s
  5714  2404 -2111.1450   17  504 -5948.3573 -1158.5398  80.5%  2765 1830s
  5715  2405 -4873.5124   22  513 -5948.3573 -1158.5398  80.5%  2764 1861s
  5716  2405 -3153.8618   16  564 -5948.3573 -1158.5398  80.5%  2764 1877s
  5717  2406 -2703.2260   13  523 -5948.3573 -1158.5398  80.5%  2763 1886s
  5718  2407 -5487.6330   39  515 -5948.3573 -1158.5398  80.5%  2763 1895s
  5719  2407 -5131.4392   29  588 -5948.3573 -1158.5398  80.5%  2762 1901s
  5720  2408 -5780.9998   44  601 -5948.3573 -1158.5398  80.5%  2762 1905s
  5721  2409 -4290.7577   27  611 -5948.3573 -1158.5398  80.5%  2762 1912s
  5722  2409 -2132.7345   16  621 -5948.3573 -1158.5398  80.5%  2761 1915s
  5723  2410 -4051.5136   31  631 -5948.3573 -1158.5398  80.5%  2761 1921s
  5724  2411 -5237.8234   24  624 -5948.3573 -1158.5398  80.5%  2760 1931s
  5725  2411 -4959.3620   16  561 -5948.3573 -1158.5398  80.5%  2760 1936s
  5727  2413 -3493.7768   17  568 -5948.3573 -1158.5398  80.5%  2759 1944s
  5728  2413 -5806.6239   47  568 -5948.3573 -1158.5398  80.5%  2758 1953s
  5729  2414 -5018.0985   18  544 -5948.3573 -1158.5398  80.5%  2758 1959s
  5730  2415 -4819.5179   31  665 -5948.3573 -1158.5398  80.5%  2757 1962s
  5731  2415 -5725.6693   39  628 -5948.3573 -1158.5398  80.5%  2757 1965s
  5733  2417 -4903.8577   42  610 -5948.3573 -1158.5398  80.5%  2756 1978s
  5734  2417 -5064.1803   44  588 -5948.3573 -1158.5398  80.5%  2755 1981s
  5735  2418 -5229.4086   28  625 -5948.3573 -1158.5398  80.5%  2755 1987s
  5736  2419 -5605.1033   37  551 -5948.3573 -1158.5398  80.5%  2754 1995s
  5737  2419 -4944.6454   32  632 -5948.3573 -1158.5398  80.5%  2754 2001s
  5738  2420 -2753.0530   22  678 -5948.3573 -1158.5398  80.5%  2753 2008s
  5739  2421 -5779.2778   19  686 -5948.3573 -1158.5398  80.5%  2753 2015s
  5740  2421 -5540.0719   23  687 -5948.3573 -1158.5398  80.5%  2752 2024s
  5741  2422 -5328.4881   31  616 -5948.3573 -1158.5398  80.5%  2752 2030s
  5742  2423 -5046.7277   27  615 -5948.3573 -1158.5398  80.5%  2751 2037s
  5743  2423 -2671.0193   16  603 -5948.3573 -1158.5398  80.5%  2751 2041s
  5744  2424 -2920.9665    9  611 -5948.3573 -1158.5398  80.5%  2750 2047s
  5745  2425 -5243.1912    8  608 -5948.3573 -1158.5398  80.5%  2750 2050s
  5746  2425 -1704.1015   15  610 -5948.3573 -1158.5398  80.5%  2750 2057s
  5747  2426 -4687.6941   13  610 -5948.3573 -1158.5398  80.5%  2749 2067s
  5748  2427 -1794.2898   11  610 -5948.3573 -1158.5398  80.5%  2749 2094s
  5749  2430 -1158.5398   12  544 -5948.3573 -1158.5398  80.5%  2799 2112s
  5751  2434 -1158.5398   13  591 -5948.3573 -1158.5398  80.5%  2802 2133s
  5755  2440 -1158.5398   14  589 -5948.3573 -1158.5398  80.5%  2806 2154s
  5763  2452 -1158.5398   15  592 -5948.3573 -1158.5398  80.5%  2821 2172s
  5779  2452 -1158.5398   16  450 -5948.3573 -1158.5398  80.5%  2838 2198s
  5793  2465     cutoff   17      -5948.3573 -1158.5398  80.5%  2868 2223s
  5816  2542 -2975.3054   17  383 -5948.3573 -1158.5398  80.5%  2897 2254s
  5923  2530 -3269.7991   20  377 -5948.3573 -1158.5398  80.5%  2915 2276s
  5959  2534 -5443.6972   21  393 -5948.3573 -1158.5398  80.5%  2918 2293s
  6001  2530     cutoff   22      -5948.3573 -1158.5398  80.5%  2934 2308s
  6053  2525 -5581.2801   21  376 -5948.3573 -1158.5398  80.5%  2940 2324s
  6109  2514     cutoff   22      -5948.3573 -1158.5398  80.5%  2942 2350s
  6174  2504 -5057.5779   22  356 -5948.3573 -1158.5398  80.5%  2948 2366s
  6235  2484     cutoff   24      -5948.3573 -1158.5398  80.5%  2948 2386s
  6288  2472 -5783.6760   27  257 -5948.3573 -1158.5398  80.5%  2946 2405s
  6338  2455     cutoff   20      -5948.3573 -1158.5398  80.5%  2964 2427s
  6383  2449 -3032.2004   24  402 -5948.3573 -1158.5398  80.5%  2974 2443s
  6438  2442 -3236.9018   25  266 -5948.3573 -1158.5398  80.5%  3001 2462s
  6483  2438     cutoff   26      -5948.3573 -1158.5398  80.5%  3010 2481s
  6538  2435 -5806.3914   26  362 -5948.3573 -1158.5398  80.5%  3017 2503s
  6593  2430 -1158.5398   19  660 -5948.3573 -1158.5398  80.5%  3028 2523s
  6660  2415 -1578.0203   19  384 -5948.3573 -1158.5398  80.5%  3039 2546s
  6724  2407 -1158.5398   20  413 -5948.3573 -1158.5398  80.5%  3041 2565s
  6789  2413 -1651.8859   20  656 -5948.3573 -1158.5398  80.5%  3046 2585s
  6860  2398 -1665.6595   21  398 -5948.3573 -1158.5398  80.5%  3050 2607s
  6942  2395 -1980.7769   22  397 -5948.3573 -1158.5398  80.5%  3057 2630s
  7021  2396 -3304.7268   23  512 -5948.3573 -1158.5398  80.5%  3063 2655s
  7099  2379 -2217.4211   23  370 -5948.3573 -1158.5398  80.5%  3070 2678s
  7185  2355 -4836.5986   25  376 -5948.3573 -1158.5398  80.5%  3078 2708s
  7295  2321 -4980.7537   26  381 -5948.3573 -1158.5398  80.5%  3079 2728s
  7351  2305     cutoff   26      -5948.3573 -1158.5398  80.5%  3089 2751s
  7448  2296 -5453.7567   29  355 -5948.3573 -1927.2794  67.6%  3089 2787s
  7555  2245     cutoff   31      -5948.3573 -1927.2794  67.6%  3090 2816s
  7705  2191     cutoff   27      -5948.3573 -2218.9426  62.7%  3084 2844s
  7834  2125 infeasible   30      -5948.3573 -3096.6993  47.9%  3081 2881s
  7974  2056 -5650.4374   25  487 -5948.3573 -3096.6993  47.9%  3081 2916s
  8101  1970     cutoff   27      -5948.3573 -3096.6993  47.9%  3082 2947s
  8279  1856     cutoff   29      -5948.3573 -3249.2053  45.4%  3072 2979s
  8491  1742     cutoff   23      -5948.3573 -3979.7042  33.1%  3057 3011s
  8741  1572     cutoff   25      -5948.3573 -4135.5079  30.5%  3026 3038s
  9061  1388 -5641.6715   23  287 -5948.3573 -4135.5079  30.5%  2963 3056s
  9353  1360     cutoff   39      -5948.3573 -4336.3159  27.1%  2886 3073s
  9850  1294 -5822.2052   59   59 -5948.3573 -5477.9571  7.91%  2756 3088s
 10619  1107 -5929.7560   65   43 -5948.3573 -5613.7983  5.62%  2568 3098s
 11564   825 -5897.7833   62   37 -5948.3573 -5764.5600  3.09%  2370 3107s
 12669   364 -5944.7975   59   28 -5948.3573 -5850.3911  1.65%  2172 3114s
 13977    15 -5902.1328   67   38 -5948.3573 -5860.9827  1.47%  1976 3116s

Cutting planes:
  Learned: 1
  Gomory: 3
  Implied bound: 19
  Projected implied bound: 222
  MIR: 1277
  Mixing: 1
  Flow cover: 1805
  Zero half: 6
  RLT: 57
  Relax-and-lift: 134

Explored 14859 nodes (28061033 simplex iterations) in 3116.96 seconds (7511.05 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -5948.36 -5956.24 -5979.51 ... -6152.55
No other solutions better than -5948.36

Optimal solution found (tolerance 1.00e-04)
Best objective -5.948357278762e+03, best bound -5.948357278762e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 3116.99s
  Master Objective (UB) = -5948.36, θ = 110076.58
  Upper Bound (UB) = -5948.36

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 110076.58
  [DEBUG]   ✓ Scenario 0: θ = 110076.58 ≤ Q = 110076.58 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 110076.58 ≤ Q = 110076.58 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 110076.58 ≤ Q = 110076.58 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 110076.58 ≤ Q = 110076.58 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 110076.58 ≤ Q = 110076.58 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 110076.58 ≤ Q = 110076.58 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 110076.58 ≤ Q = 110076.58 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 110076.58 ≤ Q = 110076.58 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 110076.58 ≤ Q = 110076.58 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 110076.58 ≤ Q = 110076.58 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 10] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x21a29e35
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xde5d61cb
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.183916e+13
Presolve removed 2608 rows and 1900 columns
Presolve time: 0.00s
Presolved: 485 rows, 489 columns, 1368 nonzeros
Found heuristic solution: objective 6049824.0514
Variable types: 330 continuous, 159 integer (159 binary)

Root relaxation: objective -1.189287e+05, 229 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -118928.74    0  120 6049824.05 -118928.74   102%     -    0s
H    0     0                    -76877.02269 -118928.74  54.7%     -    0s
H    0     0                    -77594.87471 -118692.33  53.0%     -    0s
     0     0 -94493.025    0   94 -77594.875 -94493.025  21.8%     -    0s
H    0     0                    -90885.57159 -94468.017  3.94%     -    0s
     0     0 -93960.127    0   96 -90885.572 -93960.127  3.38%     -    0s
H    0     0                    -91903.90609 -93911.460  2.18%     -    0s
H    0     0                    -91978.16143 -93911.460  2.10%     -    0s
     0     0 -93713.908    0   99 -91978.161 -93713.908  1.89%     -    0s
     0     0 -93645.692    0   99 -91978.161 -93645.692  1.81%     -    0s
     0     0 -93536.308    0   99 -91978.161 -93536.308  1.69%     -    0s
     0     0 -93528.956    0   99 -91978.161 -93528.956  1.69%     -    0s
     0     2 -93527.946    0   99 -91978.161 -93527.946  1.68%     -    0s
H   47    51                    -92480.05121 -93291.671  0.88%   8.7    0s
*  730    43              35    -92492.39702 -92663.676  0.19%   4.3    0s
H  755    43                    -92522.14942 -92663.676  0.15%   4.3    0s
*  829     0              33    -92528.54638 -92599.387  0.08%   4.4    0s

Cutting planes:
  Gomory: 42
  Implied bound: 1
  MIR: 202
  RLT: 2

Explored 856 nodes (4196 simplex iterations) in 0.15 seconds (0.09 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -92528.5 -92522.1 -92492.4 ... 1.18392e+13
No other solutions better than -92528.5

Optimal solution found (tolerance 1.00e-04)
Best objective -9.252854638136e+04, best bound -9.252854638136e+04, gap 0.0000%
  Subproblem solved in 0.16s
  Worst-case operational profit (Z_SP) = 106367.61
  Scenario: 15 demand increases, 45 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -92528.55
  [DEBUG]   S×d_nominal = 198896.15
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 198896.15 + -92528.55 = 106367.61
  [DEBUG]   Current θ from Master = 110076.58
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3708.97 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -9657.33
  Lower Bound (LB) = -9657.33
  Gap (UB-LB) = 3708.9721, Absolute Gap = 3708.9721, Relative Gap = 0.623529
  Not converged yet (gap = 3708.97 > ε = 200)

  [DEBUG] Adding NEW scenario 10 to Master Problem...
  [DEBUG] New scenario pattern: 15 increases, 45 decreases
    [DEBUG] Scenario 10 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 10 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 10]
    [DEBUG]   - Total constraints in model: 169573
    [DEBUG]   - Total variables in model: 70900
  [DEBUG] Total scenarios in Master: 11
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 11
================================================================================
[Iteration 11] Solving Master Problem...
  Current scenarios in Master: 11
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 169573 rows, 70900 columns and 481060 nonzeros
Model fingerprint: 0x67313061
Variable types: 68641 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [9e-02, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 77950 rows and 31660 columns
Presolve time: 1.11s
Presolved: 91623 rows, 39240 columns, 558037 nonzeros
Variable types: 36981 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -373815.4650
Found heuristic solution: objective -172304.4497

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.16s

Barrier statistics:
 Dense cols : 617
 AA' NZ     : 3.183e+06
 Factor NZ  : 7.299e+06 (roughly 110 MB of memory)
 Factor Ops : 1.310e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.67469105e+07  1.52296550e+08  8.62e+04 2.22e+01  6.93e+04     2s
   1  -1.24233417e+07  1.32671079e+08  5.96e+04 6.34e+01  4.77e+04     2s
   2  -4.60051710e+06  1.06002548e+08  2.14e+04 2.22e+01  1.77e+04     2s
   3  -7.00273759e+05  7.96793584e+07  1.06e+03 2.47e+00  1.32e+03     2s
   4  -5.77746633e+05  5.39226590e+07  6.02e+02 1.31e+00  7.65e+02     2s
   5  -5.44138970e+05  3.16952742e+07  5.01e+02 5.48e-02  5.30e+02     2s
   6  -3.96612283e+05  2.36333515e+07  1.27e+02 3.72e-02  2.24e+02     2s
   7  -3.03538514e+05  1.55573805e+07  2.06e+01 2.28e-02  1.06e+02     2s
   8  -2.41103103e+05  1.13745842e+07  9.33e+00 1.69e-02  7.33e+01     2s
   9  -1.51334465e+05  9.35488665e+06  4.27e+00 1.37e-02  5.82e+01     2s
  10  -1.01841420e+05  5.27286490e+06  2.49e+00 7.55e-03  3.25e+01     2s
  11  -7.28490779e+04  1.59707001e+06  1.33e+00 2.23e-03  1.00e+01     2s
  12  -4.10058360e+04  4.93634389e+05  7.97e-01 6.33e-04  3.21e+00     2s
  13  -3.04777182e+04  3.10077626e+05  5.44e-01 4.04e-04  2.04e+00     2s
  14  -1.65796112e+04  1.65233344e+05  2.81e-01 2.13e-04  1.08e+00     2s
  15  -9.98588125e+03  1.14197091e+05  2.01e-01 1.36e-04  7.41e-01     2s
  16  -4.33390292e+03  7.38038673e+04  1.44e-01 1.28e-04  4.66e-01     3s
  17  -1.19952617e+02  5.94600855e+04  1.11e-01 5.04e-04  3.55e-01     3s
  18   4.13549559e+03  4.77263033e+04  8.11e-02 5.21e-04  2.60e-01     3s
  19   6.92559832e+03  4.22300828e+04  6.03e-02 5.72e-04  2.10e-01     3s
  20   9.16883955e+03  3.42749947e+04  4.54e-02 6.39e-04  1.50e-01     3s
  21   1.06225045e+04  3.06852917e+04  3.60e-02 4.79e-04  1.20e-01     3s
  22   1.21835890e+04  2.64880147e+04  2.70e-02 5.26e-04  8.52e-02     3s
  23   1.36360810e+04  2.36501307e+04  1.91e-02 7.22e-04  5.96e-02     3s
  24   1.49287538e+04  2.22947823e+04  1.24e-02 7.28e-04  4.39e-02     3s
  25   1.52043789e+04  2.01944436e+04  1.10e-02 5.84e-04  2.97e-02     3s
  26   1.57767831e+04  1.96350713e+04  8.24e-03 4.62e-04  2.30e-02     3s
  27   1.62788171e+04  1.91311322e+04  5.96e-03 3.27e-04  1.70e-02     3s
  28   1.67177749e+04  1.87301198e+04  3.92e-03 2.47e-04  1.20e-02     3s
  29   1.68710103e+04  1.82290145e+04  3.22e-03 1.84e-04  8.09e-03     3s
  30   1.71796541e+04  1.80775699e+04  1.89e-03 1.33e-04  5.35e-03     3s
  31   1.72465515e+04  1.79620572e+04  1.59e-03 9.96e-05  4.26e-03     3s
  32   1.72900058e+04  1.79266302e+04  1.40e-03 8.87e-05  3.79e-03     3s
  33   1.73544666e+04  1.77972110e+04  1.11e-03 4.99e-05  2.64e-03     3s
  34   1.74647755e+04  1.77386350e+04  6.47e-04 5.22e-05  1.63e-03     3s
  35   1.75102552e+04  1.77037151e+04  4.59e-04 3.48e-05  1.15e-03     3s
  36   1.76118159e+04  1.76638583e+04  4.44e-05 1.90e-05  3.10e-04     3s
  37   1.76165952e+04  1.76537851e+04  3.02e-05 1.39e-05  2.21e-04     3s
  38   1.76216034e+04  1.76397988e+04  1.44e-05 6.43e-06  1.08e-04     3s
  39   1.76267073e+04  1.76280764e+04  5.49e-07 4.81e-07  8.15e-06     3s
  40   1.76268753e+04  1.76271635e+04  2.35e-07 7.18e-08  1.72e-06     3s
  41   1.76270087e+04  1.76270199e+04  1.28e-09 7.19e-07  6.62e-08     3s
  42   1.76270097e+04  1.76270098e+04  9.54e-10 1.44e-08  6.66e-10     3s

Barrier solved model in 42 iterations and 3.33 seconds (7.21 work units)
Optimal objective 1.76270097e+04


Root crossover log...

       0 DPushes remaining with DInf 0.0000000e+00                 5s

    6297 PPushes remaining with PInf 2.8677121e-05                 5s
       0 PPushes remaining with PInf 0.0000000e+00                 5s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.4518589e+01      5s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   36276    1.7627010e+04   0.000000e+00   2.451859e+01      5s
   36277    1.7627010e+04   0.000000e+00   0.000000e+00      5s
   36277    1.7627010e+04   0.000000e+00   0.000000e+00      5s
Concurrent spin time: 0.36s

Solved with barrier

Root relaxation: objective 1.762701e+04, 36277 iterations, 4.12 seconds (10.56 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 17627.0098    0  502 -172304.45 17627.0098   110%     -    6s
H    0     0                    -165019.0142 17627.0098   111%     -    6s
H    0     0                    -132942.4515 17627.0098   113%     -    7s
H    0     0                    -132722.5420 17627.0098   113%     -    7s
H    0     0                    -130972.0847 17627.0098   113%     -    7s
H    0     0                    -130745.0843 17627.0098   113%     -    7s
H    0     0                    -125452.5736 17627.0098   114%     -    7s
H    0     0                    -110742.3481 17627.0098   116%     -    7s
H    0     0                    -83435.00291 17627.0098   121%     -    7s
H    0     0                    -83337.12170 17627.0098   121%     -    7s
H    0     0                    -83300.35009 17627.0098   121%     -    7s
H    0     0                    -68915.69408 17627.0098   126%     -    8s
H    0     0                    -62741.48278 17627.0098   128%     -    8s
H    0     0                    -61110.82674 17627.0098   129%     -    8s
H    0     0                    -60037.77049 17627.0098   129%     -    8s
H    0     0                    -60033.03362 17627.0098   129%     -    8s
H    0     0                    -60009.97884 17627.0098   129%     -    8s
H    0     0                    -59979.79056 17627.0098   129%     -    8s
H    0     0                    -51335.68894 11884.3718   123%     -   29s
H    0     0                    -39994.79703 11884.3718   130%     -   29s
     0     0 11737.2093    0  631 -39994.797 11737.2093   129%     -   30s
H    0     0                    -22417.76701 11737.2093   152%     -   30s
H    0     0                    -22364.73369 11737.2093   152%     -   30s
H    0     0                    -22120.18047 11737.2093   153%     -   30s
H    0     0                    -22050.22552 11737.2093   153%     -   30s
     0     0 11129.0690    0  615 -22050.226 11129.0690   150%     -   40s
     0     0 11044.6814    0  630 -22050.226 11044.6814   150%     -   44s
     0     0 10993.5056    0  626 -22050.226 10993.5056   150%     -   46s
     0     0 10853.3567    0  629 -22050.226 10853.3567   149%     -   48s
     0     0 10820.1809    0  618 -22050.226 10820.1809   149%     -   51s
     0     0 10817.3181    0  621 -22050.226 10817.3181   149%     -   52s
     0     0 10809.4696    0  622 -22050.226 10809.4696   149%     -   52s
H    0     0                    -21898.98446 8142.69958   137%     -   82s
     0     0 8019.35158    0  599 -21898.984 8019.35158   137%     -   82s
H    0     0                    -21766.88626 8019.35158   137%     -   83s
H    0     0                    -16081.42894 7666.24173   148%     -  100s
H    0     0                    -15798.32703 7666.24173   149%     -  100s
H    0     0                    -15313.17174 7666.24173   150%     -  100s
H    0     0                    -15131.95725 7666.24173   151%     -  100s
H    0     0                    -15095.02423 7666.24173   151%     -  100s
H    0     0                    -15065.76011 7666.24173   151%     -  100s
     0     0 7666.24173    0  562 -15065.760 7666.24173   151%     -  100s
     0     0 7514.11217    0  549 -15065.760 7514.11217   150%     -  113s
     0     0 7441.41257    0  560 -15065.760 7441.41257   149%     -  122s
     0     0 7407.33887    0  559 -15065.760 7407.33887   149%     -  129s
     0     0 7380.23320    0  563 -15065.760 7380.23320   149%     -  133s
H    0     0                    -12804.90010 7365.84505   158%     -  136s
H    0     0                    -12427.22003 7365.84505   159%     -  136s
     0     0 7365.84505    0  563 -12427.220 7365.84505   159%     -  137s
     0     0 7351.51662    0  576 -12427.220 7351.51662   159%     -  139s
     0     0 7327.66894    0  577 -12427.220 7327.66894   159%     -  142s
     0     0 7273.67259    0  568 -12427.220 7273.67259   159%     -  145s
     0     0 7272.84374    0  572 -12427.220 7272.84374   159%     -  146s
H    0     0                    -12086.91262 5015.63319   141%     -  198s
H    0     0                    -12070.68360 5015.63319   142%     -  198s
     0     0 5015.63319    0  590 -12070.684 5015.63319   142%     -  198s
     0     0 4562.70611    0  474 -12070.684 4562.70611   138%     -  213s
     0     0 4460.10909    0  476 -12070.684 4460.10909   137%     -  219s
     0     0 4362.52346    0  478 -12070.684 4362.52346   136%     -  226s
     0     0 4321.61151    0  477 -12070.684 4321.61151   136%     -  231s
     0     0 4311.83768    0  477 -12070.684 4311.83768   136%     -  235s
     0     0 4277.27292    0  487 -12070.684 4277.27292   135%     -  239s
     0     0 4259.71668    0  476 -12070.684 4259.71668   135%     -  243s
     0     0 4239.59265    0  481 -12070.684 4239.59265   135%     -  247s
     0     0 4212.69057    0  485 -12070.684 4212.69057   135%     -  251s
     0     0 4199.29946    0  491 -12070.684 4199.29946   135%     -  253s
     0     0 4188.24053    0  491 -12070.684 4188.24053   135%     -  255s
     0     0 4168.03502    0  496 -12070.684 4168.03502   135%     -  259s
     0     0 4153.06013    0  493 -12070.684 4153.06013   134%     -  261s
     0     0 4151.69724    0  492 -12070.684 4151.69724   134%     -  262s
H    0     0                    -12028.27841 3042.33321   125%     -  291s
     0     0 3042.33321    0  591 -12028.278 3042.33321   125%     -  291s
     0     0 2732.56150    0  664 -12028.278 2732.56150   123%     -  302s
     0     0 2601.98207    0  674 -12028.278 2601.98207   122%     -  311s
     0     0 2559.17337    0  677 -12028.278 2559.17337   121%     -  315s
     0     0 2538.33504    0  688 -12028.278 2538.33504   121%     -  317s
     0     0 2529.05347    0  686 -12028.278 2529.05347   121%     -  319s
     0     0 2472.06890    0  675 -12028.278 2472.06890   121%     -  322s
     0     0 2469.87932    0  679 -12028.278 2469.87932   121%     -  323s
     0     0 2273.19966    0  628 -12028.278 2273.19966   119%     -  334s
     0     0 2182.53189    0  626 -12028.278 2182.53189   118%     -  339s
H    0     0                    -12010.08447 2142.28712   118%     -  342s
H    0     0                    -11892.35747 2142.28712   118%     -  342s
     0     0 2142.28712    0  639 -11892.357 2142.28712   118%     -  342s
     0     0 2131.24969    0  539 -11892.357 2131.24969   118%     -  344s
     0     0 2119.14316    0  546 -11892.357 2119.14316   118%     -  346s
     0     0 2114.12324    0  548 -11892.357 2114.12324   118%     -  348s
     0     0 2113.66436    0  548 -11892.357 2113.66436   118%     -  348s
     0     0 1952.76022    0  520 -11892.357 1952.76022   116%     -  358s
H    0     0                    -10485.87943 1952.69435   119%     -  365s
H    0     0                    -8286.846747 1952.69435   124%     -  365s
H    0     0                    -8041.535528 1952.69435   124%     -  365s
H    0     0                    -7981.219728 1952.69435   124%     -  365s
H    0     0                    -7674.663667 1952.69435   125%     -  365s
H    0     0                    -7672.971884 1952.69435   125%     -  365s
H    0     0                    -7637.892063 1952.69435   126%     -  365s
H    0     0                    -7527.704694 1952.69435   126%     -  365s
     0     0 1917.82562    0  632 -7527.7047 1917.82562   125%     -  370s
     0     0 1902.46924    0  626 -7527.7047 1902.46924   125%     -  372s
     0     0 1897.51489    0  619 -7527.7047 1897.51489   125%     -  373s
     0     0 1895.78209    0  623 -7527.7047 1895.78209   125%     -  376s
     0     0 1848.72638    0  625 -7527.7047 1848.72638   125%     -  382s
     0     0 1815.30564    0  538 -7527.7047 1815.30564   124%     -  386s
     0     0 1811.59809    0  543 -7527.7047 1811.59809   124%     -  388s
     0     0 1803.16442    0  631 -7527.7047 1803.16442   124%     -  391s
     0     0 1797.57394    0  551 -7527.7047 1797.57394   124%     -  392s
     0     0 1796.70815    0  554 -7527.7047 1796.70815   124%     -  393s
     0     0 1783.47443    0  557 -7527.7047 1783.47443   124%     -  403s
     0     0 1780.32136    0  561 -7527.7047 1780.32136   124%     -  405s
     0     0 1777.94123    0  567 -7527.7047 1777.94123   124%     -  407s
     0     0 1756.49864    0  572 -7527.7047 1756.49864   123%     -  411s
H    0     0                    -7526.100328 1756.31699   123%     -  411s
     0     0 1752.75794    0  572 -7526.1003 1752.75794   123%     -  413s
     0     0 1751.59410    0  573 -7526.1003 1751.59410   123%     -  414s
     0     0 1732.90744    0  572 -7526.1003 1732.90744   123%     -  418s
H    0     0                    -7441.247903 1732.85146   123%     -  433s
H    0     0                    -7374.556450 1732.85146   123%     -  433s
H    0     0                    -7204.644049 1732.85146   124%     -  434s
H    0     0                    -7121.407195 1732.85146   124%     -  434s
H    0     0                    -7110.490164 1732.85146   124%     -  434s
H    0     0                    -7110.291072 1732.85146   124%     -  436s
     0     0 1722.25583    0  583 -7110.2911 1722.25583   124%     -  439s
     0     0 1720.01303    0  581 -7110.2911 1720.01303   124%     -  440s
     0     0 1661.84229    0  657 -7110.2911 1661.84229   123%     -  447s
     0     0 1627.36160    0  661 -7110.2911 1627.36160   123%     -  451s
     0     0 1612.73709    0  668 -7110.2911 1612.73709   123%     -  454s
     0     0 1609.89321    0  660 -7110.2911 1609.89321   123%     -  455s
     0     0 1608.14271    0  670 -7110.2911 1608.14271   123%     -  455s
     0     0 1577.42321    0  654 -7110.2911 1577.42321   122%     -  461s
     0     0 1573.10562    0  563 -7110.2911 1573.10562   122%     -  472s
     0     0 1571.04536    0  657 -7110.2911 1571.04536   122%     -  473s
     0     0 1538.10120    0  668 -7110.2911 1538.10120   122%     -  478s
     0     0 1523.36034    0  731 -7110.2911 1523.36034   121%     -  482s
     0     0 1521.63703    0  716 -7110.2911 1521.63703   121%     -  483s
     0     0 1510.42098    0  713 -7110.2911 1510.42098   121%     -  486s
     0     0 1506.80552    0  724 -7110.2911 1506.80552   121%     -  488s
     0     0 1506.51706    0  718 -7110.2911 1506.51706   121%     -  488s
     0     0 1499.52098    0  723 -7110.2911 1499.52098   121%     -  491s
     0     0 1495.19498    0  657 -7110.2911 1495.19498   121%     -  494s
     0     0 1494.50524    0  654 -7110.2911 1494.50524   121%     -  494s
     0     0 1489.63889    0  593 -7110.2911 1489.63889   121%     -  498s
     0     0 1489.09394    0  664 -7110.2911 1489.09394   121%     -  499s
     0     0 1466.88634    0  656 -7110.2911 1466.88634   121%     -  503s
     0     0 1466.68762    0  656 -7110.2911 1466.68762   121%     -  506s
     0     2 1466.16777    0  656 -7110.2911 1466.16777   121%     -  559s
     1     3  513.27056    1  494 -7110.2911 1466.16777   121% 30800  569s
     2     5  356.97571    2  482 -7110.2911 1466.16777   121% 17721  575s
     4     9   93.60538    3  479 -7110.2911 1376.63773   119% 12879  582s
     8    17 -272.38780    4  388 -7110.2911 1376.63773   119%  9753  592s
    16    33 -422.35528    5  380 -7110.2911 1315.99085   119%  9536  605s
    32    48  338.48356    4  496 -7110.2911 1152.51025   116% 10806  625s
    47    76 -1789.6046    7  389 -7110.2911 1152.51025   116% 10849  646s
    75   157 -3202.1213    6  242 -7110.2911 1085.77761   115%  9641  666s
   162   202 -3735.6531    7  219 -7110.2911 1085.77761   115%  7219  679s
   219   251 -3978.2248    8  206 -7110.2911 1085.77761   115%  6638  692s
   277   281 -4937.0032   11  189 -7110.2911 1085.77761   115%  6328  706s
   319   343 -4995.0669   13  186 -7110.2911 1085.77761   115%  6111  720s
   395   365 -6295.8331   17  146 -7110.2911 1085.77761   115%  5814  731s
   429   390 -6804.8684   18  148 -7110.2911 1085.77761   115%  5730  742s
   471   419 -6953.3236   19  143 -7110.2911 1085.77761   115%  5666  755s
   525   447 infeasible   20      -7110.2911 1085.77761   115%  5638  766s
   573   469 -5277.2969   15  207 -7110.2911 1085.77761   115%  5551  776s
   611   492 -5304.6707   16  200 -7110.2911 1085.77761   115%  5527  785s
   663   530 infeasible   20      -7110.2911 1085.77761   115%  5404  795s
   715   573 -6319.2004   23  164 -7110.2911 1085.77761   115%  5370  805s
   790   589 -6909.4895   27  151 -7110.2911 1085.77761   115%  5257  815s
   860   609 infeasible   28      -7110.2911 1085.77761   115%  5147  827s
   932   651 -2593.6495   10  439 -7110.2911 1028.13226   114%  5184  839s
  1000   666 -2741.1069   12  435 -7110.2911 1028.13226   114%  5238  853s
  1052   704 -2829.2379   13  499 -7110.2911 1028.13226   114%  5231  866s
  1125   746 -1260.2466   10  674 -7110.2911 1028.13226   114%  5241  878s
  1193   790 -2959.7116   14  394 -7110.2911 1028.13226   114%  5231  891s
  1273   853 -3426.2108   16  374 -7110.2911 1028.13226   114%  5217  904s
  1365   910 -4586.1152   19  357 -7110.2911  989.71815   114%  5221  917s
  1467   947 -5238.5772   21  325 -7110.2911  554.14918   108%  5135  931s
  1538  1004 -5750.7431   23  255 -7110.2911  554.14918   108%  5143  947s
  1661  1032 -6706.4904   30  299 -7110.2911  554.14918   108%  5039  963s
  1785  1070     cutoff   32      -7110.2911  554.14918   108%  4984  981s
  1892  1121 -5630.0858   16  462 -7110.2911  554.14918   108%  5019  999s
  1974  1182 -5657.7561   17  369 -7110.2911  554.14918   108%  5066 1016s
  2085  1262 -6573.4498   19  527 -7110.2911  554.14918   108%  5082 1032s
  2203  1314 -6751.1457   21  518 -7110.2911  445.14051   106%  5079 1052s
  2325  1368 infeasible   22      -7110.2911  331.52101   105%  5104 1072s
  2419  1426 infeasible   21      -7110.2911  331.52101   105%  5144 1092s
  2534  1459 -1937.7770    8  405 -7110.2911  331.52101   105%  5172 1111s
  2601  1505 -2029.3172    9  399 -7110.2911  281.44969   104%  5275 1132s
  2707  1594 -2846.9458    9  371 -7110.2911 -423.06110  94.1%  5289 1151s
H 2806  1594                    -6454.709676 -423.06110  93.4%  5268 1151s
  2831  1627 -2362.5076   11  408 -6454.7097 -423.06110  93.4%  5292 1178s
  2966  1753 -3341.6278   12  352 -6454.7097 -423.06110  93.4%  5335 1199s
  3151  1838 -4829.9975   15  408 -6454.7097 -423.06110  93.4%  5331 1224s
  3374  1759 -3825.2260   15  302 -6454.7097 -423.06110  93.4%  5238 1251s
  3513  1725 -5521.2110   19  358 -6454.7097 -423.06110  93.4%  5314 1285s
  3660  1747 -5206.3002   20  443 -6454.7097 -423.06110  93.4%  5367 1314s
  3768  1765 -5909.3896   23  233 -6454.7097 -423.06110  93.4%  5460 1341s
H 3784  1722                    -6336.943908 -1148.7549  81.9%  5448 1341s
H 3804  1714                    -6326.434768 -1148.7549  81.8%  5462 1341s
H 3833  1703                    -6274.648684 -1148.7549  81.7%  5493 1341s
  3846  1709     cutoff   28      -6274.6487 -1148.7549  81.7%  5514 1375s
  3998  1774 -4240.3835   10  398 -6274.6487 -1148.7549  81.7%  5588 1408s
  4167  1790 -4552.3870   12  376 -6274.6487 -1148.7549  81.7%  5649 1445s
  4307  1843 -5528.6892   14  409 -6274.6487 -1427.3421  77.3%  5753 1483s
  4460  1896 -5919.7312   17  374 -6274.6487 -1609.2410  74.4%  5834 1521s
  4607  1964 -6202.3990   19  379 -6274.6487 -1659.7333  73.5%  5922 1561s
  4790  2028 -4106.8238   17  392 -6274.6487 -1673.5872  73.3%  5969 1603s
H 4985  1956                    -6184.157786 -1673.5872  72.9%  6018 1645s
H 4997  1913                    -6125.990392 -1673.5872  72.7%  6023 1645s
H 5041  1898                    -6097.482347 -1673.5872  72.6%  6027 1645s
H 5067  1892                    -6088.940323 -1673.5872  72.5%  6017 1645s
  5118  1978 infeasible   20      -6088.9403 -1673.5872  72.5%  6027 1687s
  5332  2042 -5807.3327   13  376 -6088.9403 -1673.5872  72.5%  6087 1739s
H 5546  2046                    -6081.822617 -1939.4579  68.1%  6081 1774s
H 5549  2015                    -6035.762141 -1939.4579  67.9%  6094 1774s
H 5567  1974                    -5984.732036 -1939.4579  67.6%  6106 1774s
  5615  2004 -3235.8110   13  493 -5984.7320 -1939.4579  67.6%  6135 1823s
  5815  2024 -5955.3258   17  406 -5984.7320 -1939.4579  67.6%  6216 1875s
  6025  2070 -3774.3886   15  260 -5984.7320 -1939.4579  67.6%  6288 1928s
  6253  2078 -4726.3628   19  303 -5984.7320 -2313.7707  61.3%  6352 1971s
H 6254  2063                    -5968.891143 -2313.7707  61.2%  6351 1971s
H 6255  2058                    -5964.762143 -2313.7707  61.2%  6354 1971s
H 6259  2057                    -5958.444795 -2313.7707  61.2%  6354 1971s
H 6283  2047                    -5949.535200 -2313.7707  61.1%  6361 1971s
  6309  2123 -5041.1966   20  442 -5949.5352 -2313.7707  61.1%  6384 2026s
  6593  2145 -5532.0457   22  189 -5949.5352 -2313.7707  61.1%  6402 2086s
  6876  2158 -5089.7819   12  358 -5949.5352 -2625.6693  55.9%  6420 2139s
  7069  2182 -3306.8507   12  219 -5949.5352 -2629.5784  55.8%  6451 2199s
  7332  2184 infeasible   16      -5949.5352 -2810.0270  52.8%  6522 2263s
  7608  2203 infeasible   18      -5949.5352 -2935.6190  50.7%  6588 2330s
  7950  2243 infeasible    9      -5949.5352 -3025.4642  49.1%  6598 2398s
  8271  2276     cutoff   15      -5949.5352 -3063.8649  48.5%  6646 2460s
  8563  2284 -5742.1205   14  406 -5949.5352 -3170.8721  46.7%  6628 2535s
  8869  2301 infeasible   16      -5949.5352 -3392.8170  43.0%  6679 2625s
  9251  2268 -5727.7166   26  455 -5949.5352 -3456.0281  41.9%  6608 2713s
  9675  2280 -5680.9190   25  331 -5949.5352 -3517.2854  40.9%  6613 2800s
 10108  2297 -5099.7907   11  372 -5949.5352 -3697.3973  37.9%  6610 2894s
 10596  2338 infeasible   15      -5949.5352 -3808.7787  36.0%  6583 2989s
 11162  2312 -5430.7710   25  251 -5949.5352 -3896.3866  34.5%  6542 3090s
 11689  2287 -5578.2133   29  264 -5949.5352 -4053.9776  31.9%  6516 3195s
 12271  2217 infeasible   34      -5949.5352 -4218.9159  29.1%  6488 3302s
 12933  2140 infeasible   35      -5949.5352 -4407.7154  25.9%  6425 3403s
 13675  2024 -5858.4042   29  179 -5949.5352 -4525.2785  23.9%  6345 3503s
 14284  1858 -5361.2722   25  214 -5949.5352 -4657.4913  21.7%  6296 3600s

Cutting planes:
  Learned: 2
  Gomory: 6
  Implied bound: 281
  MIR: 2967
  Flow cover: 3299
  Zero half: 9
  RLT: 170
  Relax-and-lift: 1123

Explored 14994 nodes (94063975 simplex iterations) in 3600.05 seconds (9786.88 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -5949.54 -5958.44 -5964.76 ... -6125.99

Time limit reached
Best objective -5.949535200150e+03, best bound -4.832454626398e+03, gap 18.7759%
  WARNING: Time limit reached. Using best solution found (gap: 18.78%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = -5949.54, θ = 110355.13
  Upper Bound (UB) = -5949.54

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 110355.13
  [DEBUG]   ✓ Scenario 0: θ = 110355.13 ≤ Q = 110355.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 110355.13 ≤ Q = 110355.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 110355.13 ≤ Q = 110355.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 110355.13 ≤ Q = 110355.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 110355.13 ≤ Q = 110355.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 110355.13 ≤ Q = 110355.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 110355.13 ≤ Q = 110355.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 110355.13 ≤ Q = 110355.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 110355.13 ≤ Q = 110355.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 110355.13 ≤ Q = 110355.13 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 110355.13 ≤ Q = 110355.13 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 11] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x3d45bb30
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xc2ba44d0
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.193638e+13
Presolve removed 2602 rows and 1895 columns
Presolve time: 0.00s
Presolved: 491 rows, 494 columns, 1384 nonzeros
Found heuristic solution: objective 6144688.6698
Variable types: 334 continuous, 160 integer (160 binary)

Root relaxation: objective -1.183514e+05, 232 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -118351.44    0  122 6144688.67 -118351.44   102%     -    0s
H    0     0                    -85678.36097 -118351.44  38.1%     -    0s
H    0     0                    -86272.72690 -118351.44  37.2%     -    0s
     0     0 -94598.930    0   99 -86272.727 -94598.930  9.65%     -    0s
H    0     0                    -90744.89840 -94481.762  4.12%     -    0s
H    0     0                    -91046.82806 -94481.762  3.77%     -    0s
H    0     0                    -91448.60569 -94481.762  3.32%     -    0s
H    0     0                    -91750.53534 -94481.762  2.98%     -    0s
     0     0 -94034.189    0   98 -91750.535 -94034.189  2.49%     -    0s
H    0     0                    -91952.45968 -93719.066  1.92%     -    0s
     0     0 -93719.066    0   97 -91952.460 -93719.066  1.92%     -    0s
     0     0 -93633.329    0   97 -91952.460 -93633.329  1.83%     -    0s
     0     0 -93369.449    0  101 -91952.460 -93369.449  1.54%     -    0s
     0     0 -93345.334    0  101 -91952.460 -93345.334  1.51%     -    0s
     0     0 -93182.024    0   81 -91952.460 -93182.024  1.34%     -    0s
     0     0 -93150.309    0   92 -91952.460 -93150.309  1.30%     -    0s
     0     0 -92986.293    0   79 -91952.460 -92986.293  1.12%     -    0s
     0     0 -92974.537    0   79 -91952.460 -92974.537  1.11%     -    0s
     0     2 -92973.106    0   79 -91952.460 -92973.106  1.11%     -    0s
*  966   349              34    -91952.63865 -92401.240  0.49%   6.6    0s
H 2202   360                    -91957.29504 -92169.154  0.23%   6.2    0s

Cutting planes:
  Gomory: 40
  Implied bound: 2
  MIR: 268
  RLT: 10
  BQP: 2

Explored 3407 nodes (21904 simplex iterations) in 0.18 seconds (0.17 work units)
Thread count was 32 (of 256 available processors)

Solution count 9: -91957.3 -91952.6 -91952.5 ... 1.19364e+13
No other solutions better than -91957.3

Optimal solution found (tolerance 1.00e-04)
Best objective -9.195729503986e+04, best bound -9.195729503986e+04, gap 0.0000%
  Subproblem solved in 0.19s
  Worst-case operational profit (Z_SP) = 107006.26
  Scenario: 42 demand increases, 18 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -91957.30
  [DEBUG]   S×d_nominal = 198963.56
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 198963.56 + -91957.30 = 107006.26
  [DEBUG]   Current θ from Master = 110355.13
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3348.87 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -9298.40
  Lower Bound (LB) = -9298.40
  Gap (UB-LB) = 3348.8680, Absolute Gap = 3348.8680, Relative Gap = 0.562879
  Not converged yet (gap = 3348.87 > ε = 200)

  [DEBUG] Adding NEW scenario 11 to Master Problem...
  [DEBUG] New scenario pattern: 42 increases, 18 decreases
    [DEBUG] Scenario 11 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 11 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 11]
    [DEBUG]   - Total constraints in model: 184863
    [DEBUG]   - Total variables in model: 77140
  [DEBUG] Total scenarios in Master: 12
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 12
================================================================================
[Iteration 12] Solving Master Problem...
  Current scenarios in Master: 12
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 184863 rows, 77140 columns and 524291 nonzeros
Model fingerprint: 0xa7a8baf7
Variable types: 74881 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [9e-02, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 85040 rows and 34540 columns
Presolve time: 1.24s
Presolved: 99823 rows, 42600 columns, 605543 nonzeros
Variable types: 40341 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -374625.1499
Found heuristic solution: objective -172304.4497

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.19s

Barrier statistics:
 Dense cols : 614
 AA' NZ     : 3.618e+06
 Factor NZ  : 8.429e+06 (roughly 130 MB of memory)
 Factor Ops : 1.574e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.67830019e+07  1.64533740e+08  8.65e+04 2.35e+01  6.89e+04     2s
   1  -1.26212744e+07  1.43538794e+08  6.03e+04 6.02e+01  4.77e+04     2s
   2  -3.07224075e+06  1.14778691e+08  1.46e+04 5.78e-01  1.24e+04     2s
   3  -7.84405563e+05  7.43225066e+07  2.07e+03 7.36e-01  2.01e+03     2s
   4  -4.33702023e+05  2.74172075e+07  4.75e+02 2.76e-02  4.69e+02     2s
   5  -2.87407833e+05  1.85129086e+07  1.48e+02 1.44e-02  1.95e+02     2s
   6  -1.82871810e+05  1.32485203e+07  5.90e+01 9.07e-03  1.06e+02     2s
   7  -1.13204313e+05  8.91007625e+06  2.38e+01 5.67e-03  6.00e+01     2s
   8  -9.15589816e+04  6.36316009e+06  1.06e+01 3.82e-03  3.90e+01     3s
   9  -7.62963645e+04  4.52085258e+06  7.02e+00 2.64e-03  2.70e+01     3s
  10  -5.77455268e+04  1.16882954e+06  4.14e+00 5.92e-04  7.06e+00     3s
  11  -3.33924465e+04  4.34354806e+05  2.17e+00 1.94e-04  2.64e+00     3s
  12  -2.47935473e+04  1.51702453e+05  1.31e+00 1.22e-04  9.85e-01     3s
  13  -1.59154416e+04  9.37440152e+04  7.90e-01 8.12e-05  6.08e-01     3s
  14  -1.27518962e+04  7.45598270e+04  6.68e-01 6.25e-04  4.83e-01     3s
  15  -8.54777292e+03  5.66573636e+04  5.52e-01 1.90e-03  3.61e-01     3s
  16  -3.64278015e+03  4.44608380e+04  4.36e-01 1.31e-03  2.66e-01     3s
  17  -8.76700327e+01  3.85132494e+04  3.62e-01 1.09e-03  2.13e-01     3s
  18   2.22761354e+03  3.39509027e+04  3.13e-01 1.39e-03  1.75e-01     3s
  19   5.40499587e+03  3.04391781e+04  2.46e-01 1.29e-03  1.38e-01     3s
  20   7.00592093e+03  2.58021680e+04  2.13e-01 1.32e-03  1.04e-01     3s
  21   8.78258641e+03  2.45882645e+04  1.77e-01 1.04e-03  8.73e-02     3s
  22   1.04287340e+04  2.35932138e+04  1.44e-01 1.02e-03  7.27e-02     3s
  23   1.14427506e+04  2.27173925e+04  1.25e-01 1.25e-03  6.22e-02     3s
  24   1.21897344e+04  2.09458255e+04  1.11e-01 1.78e-03  4.84e-02     3s
  25   1.30489957e+04  2.02320026e+04  9.54e-02 1.50e-03  3.97e-02     3s
  26   1.42314732e+04  1.98892096e+04  7.32e-02 1.38e-03  3.13e-02     3s
  27   1.53114478e+04  1.95427225e+04  5.28e-02 1.10e-03  2.34e-02     3s
  28   1.61147388e+04  1.92149265e+04  3.86e-02 1.02e-03  1.71e-02     3s
  29   1.64386768e+04  1.90690885e+04  3.27e-02 7.67e-04  1.45e-02     3s
  30   1.67807831e+04  1.88041225e+04  2.67e-02 6.33e-04  1.12e-02     3s
  31   1.70994832e+04  1.87013065e+04  2.11e-02 4.74e-04  8.85e-03     3s
  32   1.73711084e+04  1.86621580e+04  1.63e-02 5.80e-04  7.13e-03     3s
  33   1.76399305e+04  1.85619389e+04  1.16e-02 4.51e-04  5.09e-03     3s
  34   1.78589860e+04  1.85268504e+04  7.90e-03 3.82e-04  3.68e-03     3s
  35   1.79853504e+04  1.84488211e+04  5.76e-03 2.88e-04  2.56e-03     3s
  36   1.81054464e+04  1.84342997e+04  3.77e-03 2.31e-04  1.81e-03     3s
  37   1.81858726e+04  1.83980973e+04  2.47e-03 2.03e-04  1.17e-03     3s
  38   1.82438931e+04  1.83740110e+04  1.55e-03 1.29e-04  7.18e-04     3s
  39   1.82730956e+04  1.83681552e+04  1.10e-03 1.07e-04  5.24e-04     3s
  40   1.83010094e+04  1.83645168e+04  6.73e-04 8.84e-05  3.50e-04     3s
  41   1.83044412e+04  1.83601500e+04  6.23e-04 6.66e-05  3.07e-04     3s
  42   1.83139647e+04  1.83567022e+04  4.83e-04 4.76e-05  2.36e-04     3s
  43   1.83175087e+04  1.83536607e+04  4.30e-04 3.27e-05  1.99e-04     4s
  44   1.83306895e+04  1.83506884e+04  2.31e-04 2.70e-05  1.10e-04     4s
  45   1.83451555e+04  1.83482161e+04  2.21e-05 1.37e-05  1.68e-05     4s
  46   1.83461412e+04  1.83479604e+04  9.93e-06 1.09e-05  9.99e-06     4s
  47   1.83468596e+04  1.83470212e+04  8.00e-07 7.67e-07  8.87e-07     4s
  48   1.83469429e+04  1.83469601e+04  4.82e-08 8.82e-08  9.42e-08     4s
  49   1.83469498e+04  1.83469499e+04  1.57e-09 2.37e-10  5.06e-10     4s

Barrier solved model in 49 iterations and 3.71 seconds (7.96 work units)
Optimal objective 1.83469498e+04


Root crossover log...

       0 DPushes remaining with DInf 0.0000000e+00                 6s

    6479 PPushes remaining with PInf 1.5946182e-05                 6s
       0 PPushes remaining with PInf 0.0000000e+00                 6s

  Push phase complete: Pinf 0.0000000e+00, Dinf 4.1623513e+01      6s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   39184    1.8346950e+04   0.000000e+00   4.162351e+01      6s
   39185    1.8346950e+04   0.000000e+00   0.000000e+00      6s
   39185    1.8346950e+04   0.000000e+00   0.000000e+00      6s
Concurrent spin time: 0.48s

Solved with barrier

Root relaxation: objective 1.834695e+04, 39185 iterations, 5.25 seconds (13.61 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 18346.9499    0  487 -172304.45 18346.9499   111%     -    7s
H    0     0                    -164638.8009 18346.9499   111%     -    7s
H    0     0                    -164419.2445 18346.9499   111%     -    8s
H    0     0                    -139248.1599 18346.9499   113%     -    8s
H    0     0                    -137814.0635 18346.9499   113%     -    8s
H    0     0                    -137336.1997 18346.9499   113%     -    8s
H    0     0                    -137139.2648 18346.9499   113%     -    8s
H    0     0                    -131846.7540 18346.9499   114%     -    8s
H    0     0                    -117272.3506 18346.9499   116%     -    8s
H    0     0                    -112828.2764 18346.9499   116%     -    9s
H    0     0                    -109502.1943 18346.9499   117%     -    9s
H    0     0                    -105598.4666 18346.9499   117%     -    9s
H    0     0                    -104883.7497 18346.9499   117%     -    9s
H    0     0                    -104848.6271 18346.9499   117%     -    9s
H    0     0                    -64942.62080 18346.9499   128%     -   10s
H    0     0                    -62505.89178 18346.9499   129%     -   10s
H    0     0                    -49041.29275 18346.9499   137%     -   10s
H    0     0                    -48960.31792 18346.9499   137%     -   10s
H    0     0                    -39853.54201 18346.9499   146%     -   10s
H    0     0                    -39807.11862 18346.9499   146%     -   10s
H    0     0                    -39530.00028 18346.9499   146%     -   10s
H    0     0                    -22041.68081 12129.7868   155%     -   32s
H    0     0                    -21740.61348 12129.7868   156%     -   32s
H    0     0                    -21331.63659 12129.7868   157%     -   32s
H    0     0                    -21293.50073 12129.7868   157%     -   32s
H    0     0                    -21245.69035 12129.7868   157%     -   32s
     0     0 12129.7868    0  629 -21245.690 12129.7868   157%     -   32s
H    0     0                    -21239.09617 12129.5354   157%     -   33s
H    0     0                    -21147.24471 12129.5354   157%     -   33s
H    0     0                    -21040.83657 12129.5354   158%     -   33s
H    0     0                    -20610.11599 12129.5354   159%     -   33s
H    0     0                    -20503.70785 12129.5354   159%     -   33s
H    0     0                    -20433.75291 12129.5354   159%     -   33s
     0     0 11724.2252    0  606 -20433.753 11724.2252   157%     -   39s
     0     0 11614.5382    0  611 -20433.753 11614.5382   157%     -   42s
     0     0 11505.2266    0  614 -20433.753 11505.2266   156%     -   45s
     0     0 11456.9086    0  604 -20433.753 11456.9086   156%     -   47s
     0     0 11449.6944    0  609 -20433.753 11449.6944   156%     -   52s
     0     0 11449.6944    0  615 -20433.753 11449.6944   156%     -   53s
     0     0 11424.8907    0  624 -20433.753 11424.8907   156%     -   56s
     0     0 11420.5657    0  617 -20433.753 11420.5657   156%     -   57s
     0     0 11362.9333    0  615 -20433.753 11362.9333   156%     -   59s
     0     0 11362.6310    0  614 -20433.753 11362.6310   156%     -   60s
     0     0 8441.88574    0  545 -20433.753 8441.88574   141%     -   89s
H    0     0                    -13352.54409 8436.27906   163%     -   90s
H    0     0                    -13335.08302 8436.27906   163%     -   90s
H    0     0                    -12930.05872 8436.27906   165%     -   90s
     0     0 7314.20268    0  610 -12930.059 7314.20268   157%     -  115s
     0     0 7160.58407    0  549 -12930.059 7160.58407   155%     -  127s
     0     0 7109.75844    0  598 -12930.059 7109.75844   155%     -  133s
     0     0 7078.83725    0  597 -12930.059 7078.83725   155%     -  136s
     0     0 6919.77636    0  606 -12930.059 6919.77636   154%     -  142s
     0     0 6882.33992    0  580 -12930.059 6882.33992   153%     -  146s
     0     0 6841.29557    0  578 -12930.059 6841.29557   153%     -  149s
     0     0 6740.02394    0  589 -12930.059 6740.02394   152%     -  153s
     0     0 6735.81309    0  587 -12930.059 6735.81309   152%     -  155s
     0     0 6702.89497    0  590 -12930.059 6702.89497   152%     -  159s
     0     0 6700.90416    0  591 -12930.059 6700.90416   152%     -  160s
     0     0 6645.18138    0  583 -12930.059 6645.18138   151%     -  165s
     0     0 6641.36371    0  588 -12930.059 6641.36371   151%     -  167s
     0     0 6632.25296    0  591 -12930.059 6632.25296   151%     -  170s
     0     0 6630.47037    0  591 -12930.059 6630.47037   151%     -  170s
     0     0 6593.25233    0  591 -12930.059 6593.25233   151%     -  172s
     0     0 6586.14611    0  592 -12930.059 6586.14611   151%     -  173s
     0     0 6581.35582    0  593 -12930.059 6581.35582   151%     -  174s
     0     0 6579.99751    0  596 -12930.059 6579.99751   151%     -  175s
H    0     0                    -12878.86211 4551.18342   135%     -  212s
H    0     0                    -12793.47973 4551.18342   136%     -  212s
     0     0 4551.18342    0  467 -12793.480 4551.18342   136%     -  212s
H    0     0                    -12557.04636 4550.93909   136%     -  212s
H    0     0                    -12509.10547 4550.93909   136%     -  212s
H    0     0                    -12437.69556 3862.44328   131%     -  231s
H    0     0                    -12315.28204 3862.44328   131%     -  231s
H    0     0                    -12221.31637 3862.44328   132%     -  231s
H    0     0                    -12171.05656 3862.44328   132%     -  231s
     0     0 3862.44328    0  571 -12171.057 3862.44328   132%     -  231s
     0     0 3648.81939    0  567 -12171.057 3648.81939   130%     -  241s
     0     0 3538.96225    0  582 -12171.057 3538.96225   129%     -  247s
     0     0 3462.21004    0  590 -12171.057 3462.21004   128%     -  256s
     0     0 3417.72507    0  596 -12171.057 3417.72507   128%     -  262s
     0     0 3404.58511    0  610 -12171.057 3404.58511   128%     -  265s
     0     0 3377.88905    0  595 -12171.057 3377.88905   128%     -  269s
     0     0 3362.82972    0  601 -12171.057 3362.82972   128%     -  273s
     0     0 3347.00489    0  589 -12171.057 3347.00489   127%     -  276s
     0     0 3345.71867    0  476 -12171.057 3345.71867   127%     -  278s
H    0     0                    -11700.27782 2612.40372   122%     -  305s
H    0     0                    -11692.32534 2612.40372   122%     -  305s
     0     0 2612.40372    0  598 -11692.325 2612.40372   122%     -  305s
     0     0 2361.62634    0  608 -11692.325 2361.62634   120%     -  317s
     0     0 2303.27299    0  625 -11692.325 2303.27299   120%     -  324s
     0     0 2257.29030    0  609 -11692.325 2257.29030   119%     -  330s
     0     0 2242.09774    0  606 -11692.325 2242.09774   119%     -  334s
     0     0 2237.87598    0  606 -11692.325 2237.87598   119%     -  340s
     0     0 2236.40206    0  604 -11692.325 2236.40206   119%     -  342s
     0     0 2120.17483    0  647 -11692.325 2120.17483   118%     -  353s
H    0     0                    -11625.11416 2120.12622   118%     -  354s
     0     0 2083.75357    0  603 -11625.114 2083.75357   118%     -  360s
     0     0 2059.07052    0  531 -11625.114 2059.07052   118%     -  365s
     0     0 2047.96121    0  523 -11625.114 2047.96121   118%     -  367s
     0     0 2038.43467    0  631 -11625.114 2038.43467   118%     -  371s
     0     0 1994.98866    0  628 -11625.114 1994.98866   117%     -  377s
     0     0 1993.58088    0  633 -11625.114 1993.58088   117%     -  378s
     0     0 1925.60053    0  511 -11625.114 1925.60053   117%     -  385s
H    0     0                    -10484.21577 1925.46804   118%     -  399s
H    0     0                    -8919.633712 1925.46804   122%     -  399s
H    0     0                    -8703.603615 1925.46804   122%     -  399s
H    0     0                    -8681.435190 1925.46804   122%     -  399s
H    0     0                    -8063.918494 1925.46804   124%     -  400s
H    0     0                    -7962.304412 1925.46804   124%     -  401s
H    0     0                    -7950.005682 1925.46804   124%     -  401s
H    0     0                    -7925.311858 1925.46804   124%     -  401s
     0     0 1907.43673    0  646 -7925.3119 1907.43673   124%     -  405s
     0     0 1901.58910    0  658 -7925.3119 1901.58910   124%     -  408s
     0     0 1899.62351    0  659 -7925.3119 1899.62351   124%     -  409s
     0     0 1875.09839    0  528 -7925.3119 1875.09839   124%     -  417s
     0     0 1871.91362    0  471 -7925.3119 1871.91362   124%     -  420s
     0     0 1870.89707    0  533 -7925.3119 1870.89707   124%     -  423s
     0     0 1859.66710    0  558 -7925.3119 1859.66710   123%     -  430s
H    0     0                    -7823.765754 1859.18903   124%     -  431s
     0     0 1851.20468    0  478 -7823.7658 1851.20468   124%     -  434s
     0     0 1850.08324    0  473 -7823.7658 1850.08324   124%     -  434s
     0     0 1838.68862    0  550 -7823.7658 1838.68862   124%     -  438s
     0     0 1834.28076    0  395 -7823.7658 1834.28076   123%     -  441s
     0     0 1833.97531    0  461 -7823.7658 1833.97531   123%     -  442s
     0     0 1828.86891    0  617 -7823.7658 1828.86891   123%     -  445s
     0     0 1828.31892    0  617 -7823.7658 1828.31892   123%     -  448s
H    0     0                    -7795.165469 1824.37865   123%     -  456s
H    0     0                    -7718.049490 1824.37865   124%     -  456s
H    0     0                    -7709.400210 1824.37865   124%     -  456s
H    0     0                    -7647.808746 1824.37865   124%     -  456s
H    0     0                    -7635.694946 1824.37865   124%     -  456s
H    0     0                    -7629.071808 1824.37865   124%     -  493s
H    0     0                    -7549.189561 1824.37865   124%     -  498s
H    0     0                    -7533.932725 1824.37865   124%     -  500s
H    0     0                    -7389.813286 1824.37865   125%     -  500s
H    0     0                    -7374.556450 1824.37865   125%     -  508s
     0     2 1824.37865    0  617 -7374.5565 1824.37865   125%     -  509s
     1     3 1733.77940    1  608 -7374.5565 1824.37865   125%  6214  514s
     2     5 1510.42974    2  533 -7374.5565 1824.37865   125%  7098  522s
     4     9 1411.91509    3  623 -7374.5565 1733.01681   123%  8760  531s
     8    17 1337.10077    4  624 -7374.5565 1617.22124   122%  7502  543s
    16    34  825.02205    5  616 -7374.5565 1459.08434   120%  8906  555s
    33    46     cutoff    6      -7374.5565 1284.91177   117%  9439  589s
    49    60  343.78746    7  482 -7374.5565 1284.91177   117% 12899  608s
    77   112 -252.20783    8  566 -7374.5565 1284.91177   117% 10902  630s
   149   135 -361.69895   10  505 -7374.5565 1284.91177   117%  9367  647s
   182   164 -658.01527   11  491 -7374.5565 1284.91177   117%  8479  671s
   213   206 -842.53513   12  488 -7374.5565 1284.91177   117%  8176  683s
   257   253 -1040.5378   13  461 -7374.5565 1284.91177   117%  8213  698s
   308   281 -1154.9377   14  455 -7374.5565 1284.91177   117%  7678  714s
   348   315 -2154.9711   11  479 -7374.5565 1284.91177   117%  7420  731s
   396   361 -1214.5067   15  457 -7374.5565 1284.91177   117%  7232  746s
   458   408 infeasible   15      -7374.5565 1284.91177   117%  7151  761s
   530   452 -2974.8743   12  305 -7374.5565 1284.91177   117%  6993  774s
   590   494 -1420.8763   14  466 -7374.5565 1284.91177   117%  7025  788s
   650   530 -6624.2457   13  178 -7374.5565 1284.91177   117%  6948  802s
   724   564 -3202.3287   14  395 -7374.5565 1284.91177   117%  6848  816s
   782   598 -6477.6193   22  247 -7374.5565 1284.91177   117%  6775  830s
   844   620 -6498.1645   23  151 -7374.5565 1284.91177   117%  6697  844s
   922   658 -6664.1792   24  144 -7374.5565 1284.91177   117%  6540  860s
  1007   734 -6977.8348   24  155 -7374.5565 1284.91177   117%  6334  871s
  1122   793 -6813.5222   25  148 -7374.5565 1284.91177   117%  6007  886s
H 1189   793                    -6677.720357 1284.91177   119%  5796  886s
  1252   755 infeasible   25      -6677.7204 1284.91177   119%  5689  904s
  1359   775 -3074.2641   12  511 -6677.7204 1284.91177   119%  5557  921s
  1415   801 -4242.4687   13  402 -6677.7204 1284.91177   119%  5713  939s
  1467   812 -4497.9039   15  269 -6677.7204 1284.91177   119%  5851  958s
  1532   839     cutoff   14      -6677.7204 1284.91177   119%  5929  978s
  1623   842 -4182.7295   13  454 -6677.7204 1284.91177   119%  5941  997s
  1710   859 -5572.9011   14  424 -6677.7204 1284.91177   119%  5923 1018s
  1779   876     cutoff   15      -6677.7204 1284.91177   119%  6050 1051s
  1818   895 infeasible   15      -6677.7204 1284.91177   119%  6167 1100s
H 1841   895                    -6616.535032 1284.91177   119%  6223 1100s
H 1850   895                    -6610.378172 1284.91177   119%  6230 1100s
  1857   916 -6323.1124   17  432 -6610.3782 1284.91177   119%  6277 1122s
  1944   934 infeasible   19      -6610.3782 1284.91177   119%  6399 1146s
  2032   962 -3032.0475   14  449 -6610.3782 1036.19984   116%  6523 1173s
  2141   967 infeasible   15      -6610.3782 1036.19984   116%  6584 1200s
  2230  1009 infeasible   15      -6610.3782  979.75364   115%  6637 1227s
  2300  1021 -1318.6334    7  334 -6610.3782  979.75364   115%  6837 1251s
H 2304  1021                    -6571.562434  979.75364   115%  6852 1251s
H 2318  1021                    -6544.084346  979.75364   115%  6854 1251s
H 2333  1021                    -6472.097422  979.75364   115%  6860 1251s
H 2342  1021                    -6143.952359  979.75364   116%  6878 1251s
  2378  1040 -1341.0885    8  324 -6143.9524  979.75364   116%  6882 1283s
  2469  1069 -4342.3608   11  362 -6143.9524  666.36428   111%  7031 1313s
  2544  1100 -5441.0901   12  190 -6143.9524  666.36428   111%  7159 1345s
  2632  1137     cutoff   14      -6143.9524  640.15975   110%  7247 1381s
  2716  1180 infeasible   12      -6143.9524 -448.49227  92.7%  7310 1419s
  2821  1221 -3509.1005   10  456 -6143.9524 -448.49227  92.7%  7406 1453s
  2934  1246 -4273.5773   12  483 -6143.9524 -448.49227  92.7%  7537 1485s
H 2939  1246                    -6114.482279 -448.49227  92.7%  7542 1485s
H 2940  1246                    -6091.589816 -448.49227  92.6%  7540 1485s
H 2978  1246                    -6078.491334 -448.49227  92.6%  7575 1486s
  2981  1264 -3998.4404   24  494 -6078.4913 -448.49227  92.6%  7587 1522s
  3148  1326 -5122.6676   13  484 -6078.4913 -1162.7360  80.9%  7548 1561s
  3287  1351 infeasible   17      -6078.4913 -1162.7360  80.9%  7601 1597s
  3450  1389 -5799.8004    8  178 -6078.4913 -1230.0535  79.8%  7648 1638s
  3586  1447 -5304.2616   22  467 -6078.4913 -1230.0535  79.8%  7752 1676s
  3810  1472 infeasible   25      -6078.4913 -1230.0535  79.8%  7671 1718s
H 3977  1496                    -6076.394130 -1230.0535  79.8%  7737 1755s
H 3978  1496                    -6043.155289 -1230.0535  79.6%  7738 1755s
H 4022  1496                    -6032.196012 -1230.0535  79.6%  7731 1755s
  4116  1566 -5117.4938   29  500 -6032.1960 -1230.0535  79.6%  7717 1802s
  4344  1584 infeasible   51      -6032.1960 -1629.6936  73.0%  7684 1850s
  4512  1623 infeasible   17      -6032.1960 -1932.9611  68.0%  7777 1901s
  4679  1631 infeasible   18      -6032.1960 -2065.7418  65.8%  7884 1957s
  4835  1662 -5139.7699   15  296 -6032.1960 -2215.1604  63.3%  7960 2011s
  5013  1718 -4741.7279   11  250 -6032.1960 -2215.1604  63.3%  8047 2078s
H 5236  1687                    -5976.399241 -2222.8382  62.8%  7936 2119s
  5301  1696 -5475.3955   15  261 -5976.3992 -2374.9906  60.3%  7962 2181s
  5514  1718 -5057.2270   15  342 -5976.3992 -2400.7955  59.8%  8010 2246s
  5773  1670 -3696.6053   12  232 -5976.3992 -2400.7955  59.8%  8042 2317s
  6014  1726 infeasible   17      -5976.3992 -2400.7955  59.8%  8077 2384s
  6264  1723 -5737.7381   23  264 -5976.3992 -2557.5773  57.2%  8144 2468s
H 6534  1655                    -5960.273811 -2693.3366  54.8%  8064 2535s
  6660  1696 -5097.9902   22  242 -5960.2738 -2693.3366  54.8%  8081 2613s
  6888  1717 -5571.1980   24  340 -5960.2738 -2693.3366  54.8%  8138 2704s
H 7109  1713                    -5957.187191 -2768.6244  53.5%  8048 2788s
  7399  1757 -4238.0487   18  582 -5957.1872 -2768.6244  53.5%  8037 2869s
  7736  1755 infeasible   23      -5957.1872 -3180.7794  46.6%  8043 2953s
  8095  1755 -5322.1763   29  449 -5957.1872 -3218.4134  46.0%  8061 3043s
  8472  1752 infeasible   46      -5957.1872 -3451.6378  42.1%  8073 3126s
  8742  1803     cutoff   21      -5957.1872 -3509.5643  41.1%  8060 3228s
  9138  1840 -5887.5188   19  254 -5957.1872 -3722.6757  37.5%  8077 3324s
  9539  1808 infeasible   26      -5957.1872 -3815.0508  36.0%  8100 3427s
  9978  1816 infeasible   19      -5957.1872 -3932.7407  34.0%  8108 3507s
 10083  1797 -5072.3959   17  261 -5957.1872 -4079.4868  31.5%  8112 3600s

Cutting planes:
  Learned: 3
  Gomory: 17
  Implied bound: 525
  MIR: 3551
  Flow cover: 3070
  Zero half: 5
  RLT: 210
  Relax-and-lift: 1325

Explored 10466 nodes (85105237 simplex iterations) in 3600.06 seconds (9732.81 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -5957.19 -5960.27 -5976.4 ... -6143.95

Time limit reached
Best objective -5.957187191289e+03, best bound -4.113442390844e+03, gap 30.9499%
  WARNING: Time limit reached. Using best solution found (gap: 30.95%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = -5957.19, θ = 110439.99
  Upper Bound (UB) = -5957.19

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 110439.99
  [DEBUG]   ✓ Scenario 0: θ = 110439.99 ≤ Q = 110439.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 110439.99 ≤ Q = 110439.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 110439.99 ≤ Q = 110439.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 110439.99 ≤ Q = 110439.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 110439.99 ≤ Q = 110439.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 110439.99 ≤ Q = 110439.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 110439.99 ≤ Q = 110460.69 (slack: 20.70)
  [DEBUG]   ✓ Scenario 7: θ = 110439.99 ≤ Q = 110439.99 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 110439.99 ≤ Q = 110439.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 110439.99 ≤ Q = 110439.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 110439.99 ≤ Q = 110439.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 110439.99 ≤ Q = 110439.99 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 12] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x54c1472f
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xab3eb8d1
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [1e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [3e-14, 2e+02]
Found heuristic solution: objective 1.201485e+13
Presolve removed 2602 rows and 1895 columns
Presolve time: 0.00s
Presolved: 491 rows, 494 columns, 1384 nonzeros
Found heuristic solution: objective 6183566.6509
Variable types: 334 continuous, 160 integer (160 binary)

Root relaxation: objective -1.180626e+05, 232 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -118062.58    0  122 6183566.65 -118062.58   102%     -    0s
H    0     0                    -85457.88640 -118062.58  38.2%     -    0s
H    0     0                    -86052.25233 -118062.58  37.2%     -    0s
     0     0 -94024.449    0   98 -86052.252 -94024.449  9.26%     -    0s
H    0     0                    -90258.67412 -93907.281  4.04%     -    0s
     0     0 -93479.735    0  100 -90258.674 -93479.735  3.57%     -    0s
     0     0 -93423.924    0  100 -90258.674 -93423.924  3.51%     -    0s
H    0     0                    -91278.50043 -93423.924  2.35%     -    0s
H    0     0                    -91416.35553 -93170.298  1.92%     -    0s
     0     0 -93170.298    0  100 -91416.356 -93170.298  1.92%     -    0s
     0     0 -93125.845    0  104 -91416.356 -93125.845  1.87%     -    0s
     0     0 -93125.845    0  104 -91416.356 -93125.845  1.87%     -    0s
     0     0 -92868.175    0   98 -91416.356 -92868.175  1.59%     -    0s
     0     0 -92844.528    0  102 -91416.356 -92844.528  1.56%     -    0s
     0     0 -92671.237    0   93 -91416.356 -92671.237  1.37%     -    0s
     0     0 -92658.000    0   93 -91416.356 -92658.000  1.36%     -    0s
     0     0 -92547.517    0   93 -91416.356 -92547.517  1.24%     -    0s
     0     0 -92531.780    0   93 -91416.356 -92531.780  1.22%     -    0s
     0     2 -92528.120    0   93 -91416.356 -92528.120  1.22%     -    0s
H   39    42                    -91423.74157 -92235.421  0.89%  14.9    0s
*  312   178              11    -91454.82048 -92142.399  0.75%   7.8    0s

Cutting planes:
  Gomory: 31
  Implied bound: 4
  MIR: 222
  Flow cover: 1
  RLT: 6
  BQP: 2

Explored 3411 nodes (19289 simplex iterations) in 0.26 seconds (0.15 work units)
Thread count was 32 (of 256 available processors)

Solution count 8: -91454.8 -91423.7 -91416.4 ... 1.20148e+13
No other solutions better than -91454.8

Optimal solution found (tolerance 1.00e-04)
Best objective -9.145482048132e+04, best bound -9.145482048132e+04, gap 0.0000%
  Subproblem solved in 0.28s
  Worst-case operational profit (Z_SP) = 107306.71
  Scenario: 17 demand increases, 43 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -91454.82
  [DEBUG]   S×d_nominal = 198761.54
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 198761.54 + -91454.82 = 107306.71
  [DEBUG]   Current θ from Master = 110439.99
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3133.27 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -9090.46
  Lower Bound (LB) = -9090.46
  Gap (UB-LB) = 3133.2703, Absolute Gap = 3133.2703, Relative Gap = 0.525965
  Not converged yet (gap = 3133.27 > ε = 200)

  [DEBUG] Adding NEW scenario 12 to Master Problem...
  [DEBUG] New scenario pattern: 17 increases, 43 decreases
    [DEBUG] Scenario 12 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 12 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 12]
    [DEBUG]   - Total constraints in model: 200153
    [DEBUG]   - Total variables in model: 83380
  [DEBUG] Total scenarios in Master: 13
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 13
================================================================================
[Iteration 13] Solving Master Problem...
  Current scenarios in Master: 13
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 200153 rows, 83380 columns and 567522 nonzeros
Model fingerprint: 0x7b4a6de6
Variable types: 81121 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [9e-02, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 92130 rows and 37420 columns
Presolve time: 1.36s
Presolved: 108023 rows, 45960 columns, 652727 nonzeros
Variable types: 43701 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -376110.7958
Found heuristic solution: objective -172304.4497

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.24s

Barrier statistics:
 Dense cols : 611
 AA' NZ     : 4.083e+06
 Factor NZ  : 9.933e+06 (roughly 140 MB of memory)
 Factor Ops : 2.265e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.69596855e+07  1.77037409e+08  8.74e+04 2.13e+01  6.93e+04     3s
   1  -1.28467817e+07  1.54396246e+08  6.09e+04 5.91e+01  4.77e+04     3s
   2  -3.69126005e+06  1.19373965e+08  1.68e+04 6.34e-01  1.40e+04     3s
   3  -8.80027014e+05  7.64167724e+07  2.08e+03 2.96e-01  1.99e+03     3s
   4  -5.03401310e+05  3.26954287e+07  4.37e+02 7.08e-02  4.66e+02     3s
   5  -3.71714372e+05  2.35734528e+07  1.52e+02 4.14e-02  2.18e+02     3s
   6  -2.81783785e+05  1.64368702e+07  5.43e+01 2.60e-02  1.15e+02     3s
   7  -1.71185509e+05  1.18771403e+07  1.75e+01 1.75e-02  6.92e+01     3s
   8  -1.02648789e+05  8.80565770e+06  7.92e+00 1.27e-02  4.80e+01     3s
   9  -9.17847448e+04  5.04335390e+06  5.77e+00 7.03e-03  2.73e+01     3s
  10  -6.93017825e+04  3.08415992e+06  3.24e+00 4.29e-03  1.64e+01     3s
  11  -4.68074105e+04  7.27977297e+05  1.63e+00 9.08e-04  4.00e+00     3s
  12  -3.24736190e+04  3.43024317e+05  1.06e+00 3.86e-04  1.92e+00     3s
  13  -1.78937212e+04  1.75082100e+05  5.25e-01 4.05e-04  9.83e-01     3s
  14  -1.09824533e+04  1.03704332e+05  3.40e-01 5.17e-04  5.83e-01     3s
  15  -7.29599402e+03  9.13417480e+04  2.83e-01 6.72e-04  5.01e-01     3s
  16  -2.78179342e+03  6.73148916e+04  2.22e-01 1.04e-03  3.56e-01     3s
  17   1.92931015e+02  5.74248891e+04  1.87e-01 1.07e-03  2.91e-01     3s
  18   2.99984184e+03  4.44685182e+04  1.57e-01 1.77e-03  2.11e-01     3s
  19   6.29986443e+03  4.01356130e+04  1.22e-01 1.26e-03  1.72e-01     3s
  20   8.33169215e+03  3.70362009e+04  1.01e-01 1.08e-03  1.46e-01     3s
  21   1.03919980e+04  3.26544636e+04  8.19e-02 1.58e-03  1.13e-01     3s
  22   1.18762508e+04  2.80338379e+04  6.84e-02 1.03e-03  8.20e-02     3s
  23   1.28243103e+04  2.64613032e+04  6.03e-02 9.09e-04  6.92e-02     3s
  24   1.37602180e+04  2.53196370e+04  5.21e-02 8.33e-04  5.87e-02     3s
  25   1.51609893e+04  2.44421728e+04  4.03e-02 1.29e-03  4.71e-02     3s
  26   1.56981827e+04  2.40892465e+04  3.59e-02 1.57e-03  4.26e-02     3s
  27   1.62884438e+04  2.31379403e+04  3.11e-02 1.08e-03  3.48e-02     3s
  28   1.68858625e+04  2.24874524e+04  2.62e-02 7.99e-04  2.84e-02     3s
  29   1.72685339e+04  2.17634572e+04  2.27e-02 9.16e-04  2.28e-02     4s
  30   1.74139926e+04  2.14091513e+04  2.15e-02 7.80e-04  2.03e-02     4s
  31   1.79581325e+04  2.11996693e+04  1.71e-02 8.11e-04  1.65e-02     4s
  32   1.82337640e+04  2.10730626e+04  1.49e-02 7.50e-04  1.44e-02     4s
  33   1.84007915e+04  2.09620477e+04  1.35e-02 6.91e-04  1.30e-02     4s
  34   1.86360587e+04  2.08836546e+04  1.17e-02 6.67e-04  1.14e-02     4s
  35   1.87474479e+04  2.08010684e+04  1.08e-02 6.06e-04  1.04e-02     4s
  36   1.88510964e+04  2.07260730e+04  9.91e-03 5.02e-04  9.52e-03     4s
  37   1.89938563e+04  2.05886549e+04  8.78e-03 3.47e-04  8.10e-03     4s
  38   1.91314591e+04  2.04674676e+04  7.66e-03 4.29e-04  6.78e-03     4s
  39   1.93407105e+04  2.03620557e+04  6.05e-03 3.01e-04  5.19e-03     4s
  40   1.95321628e+04  2.02992631e+04  4.52e-03 2.24e-04  3.89e-03     4s
  41   1.96235459e+04  2.02369516e+04  3.76e-03 1.36e-04  3.12e-03     4s
  42   1.97736711e+04  2.02099116e+04  2.56e-03 9.97e-05  2.21e-03     4s
  43   1.98219389e+04  2.02046589e+04  2.19e-03 9.41e-05  1.94e-03     4s
  44   1.99012328e+04  2.01761344e+04  1.59e-03 5.98e-05  1.40e-03     4s
  45   1.99656538e+04  2.01687488e+04  1.10e-03 5.18e-05  1.03e-03     4s
  46   2.00024295e+04  2.01490477e+04  8.37e-04 3.55e-05  7.44e-04     4s
  47   2.00410738e+04  2.01383940e+04  5.48e-04 2.45e-05  4.94e-04     4s
  48   2.00524570e+04  2.01311971e+04  4.65e-04 1.63e-05  4.00e-04     4s
  49   2.00573631e+04  2.01289280e+04  4.30e-04 1.52e-05  3.63e-04     4s
  50   2.00831705e+04  2.01268711e+04  2.44e-04 1.24e-05  2.22e-04     4s
  51   2.00870309e+04  2.01254111e+04  2.15e-04 1.07e-05  1.95e-04     4s
  52   2.00965098e+04  2.01238997e+04  1.45e-04 8.63e-06  1.39e-04     4s
  53   2.01030438e+04  2.01217414e+04  9.86e-05 5.86e-06  9.49e-05     4s
  54   2.01055811e+04  2.01207483e+04  8.08e-05 4.59e-06  7.70e-05     4s
  55   2.01058552e+04  2.01202455e+04  7.89e-05 3.97e-06  7.30e-05     5s
  56   2.01065962e+04  2.01192424e+04  7.33e-05 2.61e-06  6.42e-05     5s
  57   2.01103388e+04  2.01180786e+04  4.68e-05 1.14e-06  3.93e-05     5s
  58   2.01144768e+04  2.01176775e+04  1.57e-05 7.41e-07  1.62e-05     5s
  59   2.01149805e+04  2.01170134e+04  1.24e-05 3.93e-07  1.03e-05     5s
  60   2.01158501e+04  2.01170035e+04  6.82e-06 3.35e-07  5.86e-06     5s
  61   2.01159135e+04  2.01169539e+04  6.42e-06 8.07e-08  5.28e-06     5s
  62   2.01160084e+04  2.01169536e+04  5.81e-06 5.53e-08  4.80e-06     5s
  63   2.01169246e+04  2.01169415e+04  8.50e-07 2.00e-07  8.55e-08     5s
  64   2.01169378e+04  2.01169379e+04  3.25e-09 1.19e-09  8.56e-11     5s

Barrier solved model in 64 iterations and 4.90 seconds (10.88 work units)
Optimal objective 2.01169378e+04


Root crossover log...

       0 DPushes remaining with DInf 0.0000000e+00                 7s

    4506 PPushes remaining with PInf 6.2729651e-06                 7s
       0 PPushes remaining with PInf 0.0000000e+00                 7s

  Push phase complete: Pinf 0.0000000e+00, Dinf 7.9654970e-11      7s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   34100    2.0116938e+04   0.000000e+00   0.000000e+00      7s
   34100    2.0116938e+04   0.000000e+00   0.000000e+00      7s
Concurrent spin time: 0.88s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 2.011694e+04, 34100 iterations, 6.03 seconds (14.29 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 20116.9379    0  566 -172304.45 20116.9379   112%     -    8s
H    0     0                    -138166.4272 20116.9379   115%     -    9s
H    0     0                    -137229.4199 20116.9379   115%     -    9s
H    0     0                    -132956.3820 20116.9379   115%     -    9s
H    0     0                    -130846.6579 20116.9379   115%     -    9s
H    0     0                    -130714.6980 20116.9379   115%     -    9s
H    0     0                    -130584.3316 20116.9379   115%     -    9s
H    0     0                    -130252.3864 20116.9379   115%     -    9s
H    0     0                    -129515.9626 20116.9379   116%     -    9s
H    0     0                    -129385.5963 20116.9379   116%     -    9s
H    0     0                    -73792.94554 20116.9379   127%     -    9s
H    0     0                    -55281.00349 20116.9379   136%     -    9s
H    0     0                    -54729.46699 20116.9379   137%     -    9s
H    0     0                    -44975.65140 20116.9379   145%     -    9s
H    0     0                    -44958.22740 20116.9379   145%     -   10s
H    0     0                    -44956.29923 20116.9379   145%     -   10s
H    0     0                    -44913.37525 20116.9379   145%     -   10s
H    0     0                    -19978.31305 20116.9379   201%     -   11s
H    0     0                    -18998.65372 20116.9379   206%     -   11s
H    0     0                    -18874.94794 20116.9379   207%     -   11s
H    0     0                    -18839.02204 20116.9379   207%     -   11s
H    0     0                    -18771.00736 20116.9379   207%     -   11s
H    0     0                    -18769.16672 20116.9379   207%     -   11s
H    0     0                    -18765.06799 20116.9379   207%     -   11s
     0     0 13973.1595    0  616 -18765.068 13973.1595   174%     -   35s
H    0     0                    -18720.70263 13973.1190   175%     -   36s
H    0     0                    -18639.20487 13973.1190   175%     -   36s
H    0     0                    -18572.38126 13973.1190   175%     -   36s
H    0     0                    -18568.05024 13973.1190   175%     -   36s
H    0     0                    -18528.25581 13973.1190   175%     -   36s
     0     0 13222.6898    0  637 -18528.256 13222.6898   171%     -   43s
     0     0 13094.9894    0  627 -18528.256 13094.9894   171%     -   47s
     0     0 12915.6048    0  620 -18528.256 12915.6048   170%     -   51s
     0     0 12837.2400    0  623 -18528.256 12837.2400   169%     -   54s
     0     0 12837.2400    0  610 -18528.256 12837.2400   169%     -   57s
     0     0 12837.2400    0  617 -18528.256 12837.2400   169%     -   58s
     0     0 12837.2400    0  618 -18528.256 12837.2400   169%     -   59s
     0     0 12837.2400    0  635 -18528.256 12837.2400   169%     -   61s
     0     0 12837.2400    0  638 -18528.256 12837.2400   169%     -   61s
     0     0 12837.2400    0  637 -18528.256 12837.2400   169%     -   62s
     0     0 12837.2400    0  637 -18528.256 12837.2400   169%     -   62s
H    0     0                    -16867.28072 9291.79649   155%     -   97s
H    0     0                    -15371.77325 9291.79649   160%     -   97s
H    0     0                    -14890.76043 9291.79649   162%     -   97s
H    0     0                    -14831.92161 9291.79649   163%     -   97s
H    0     0                    -13207.28867 9291.79649   170%     -   97s
H    0     0                    -13192.03184 9291.79649   170%     -   97s
H    0     0                    -13190.03539 9291.79649   170%     -   97s
H    0     0                    -13189.82760 9291.79649   170%     -   97s
H    0     0                    -12817.28463 9291.79649   172%     -   97s
H    0     0                    -12770.44592 9291.79649   173%     -   97s
     0     0 9291.79649    0  611 -12770.446 9291.79649   173%     -   97s
H    0     0                    -12685.51765 9291.12545   173%     -   97s
H    0     0                    -12670.26081 8043.38629   163%     -  137s
H    0     0                    -12668.41414 8043.38629   163%     -  137s
H    0     0                    -12517.06959 8043.38629   164%     -  137s
H    0     0                    -12029.52359 8043.38629   167%     -  137s
     0     0 8043.38629    0  621 -12029.524 8043.38629   167%     -  137s
     0     0 7813.54863    0  606 -12029.524 7813.54863   165%     -  157s
     0     0 7561.41738    0  608 -12029.524 7561.41738   163%     -  172s
     0     0 7389.44652    0  607 -12029.524 7389.44652   161%     -  186s
     0     0 7364.15057    0  606 -12029.524 7364.15057   161%     -  192s
     0     0 7316.51808    0  605 -12029.524 7316.51808   161%     -  200s
H    0     0                    -11892.35747 7230.90889   161%     -  209s
     0     0 7230.90889    0  591 -11892.357 7230.90889   161%     -  209s
     0     0 7191.93098    0  616 -11892.357 7191.93098   160%     -  214s
     0     0 7175.57763    0  624 -11892.357 7175.57763   160%     -  219s
     0     0 7170.27574    0  608 -11892.357 7170.27574   160%     -  221s
     0     0 7155.71654    0  606 -11892.357 7155.71654   160%     -  223s
     0     0 7142.80289    0  603 -11892.357 7142.80289   160%     -  227s
     0     0 7132.36587    0  602 -11892.357 7132.36587   160%     -  231s
     0     0 7127.91655    0  614 -11892.357 7127.91655   160%     -  235s
     0     0 7127.29198    0  608 -11892.357 7127.29198   160%     -  236s
H    0     0                    -11203.21481 5102.14431   146%     -  292s
H    0     0                    -11137.63815 5102.14431   146%     -  292s
H    0     0                    -11037.74370 5102.14431   146%     -  292s
H    0     0                    -10944.31792 5102.14431   147%     -  292s
H    0     0                    -10853.11770 5102.14431   147%     -  292s
H    0     0                    -9144.697852 5102.14431   156%     -  292s
H    0     0                    -8995.330687 5102.14431   157%     -  292s
H    0     0                    -8978.915506 5102.14431   157%     -  292s
H    0     0                    -8975.229673 5102.14431   157%     -  292s
H    0     0                    -8945.687088 5102.14431   157%     -  292s
H    0     0                    -8931.481954 5102.14431   157%     -  292s
H    0     0                    -8930.976936 5102.14431   157%     -  292s
H    0     0                    -8918.855117 5102.14431   157%     -  292s
H    0     0                    -8908.741581 5102.14431   157%     -  292s
H    0     0                    -8896.619763 5102.14431   157%     -  292s
H    0     0                    -8871.009525 5102.14431   158%     -  292s
H    0     0                    -8695.921359 5102.14431   159%     -  292s
H    0     0                    -8487.578340 5102.14431   160%     -  292s
     0     0 5102.14431    0  610 -8487.5783 5102.14431   160%     -  292s
     0     0 4542.00983    0  489 -8487.5783 4542.00983   154%     -  321s
     0     0 4463.88389    0  643 -8487.5783 4463.88389   153%     -  333s
     0     0 4400.18329    0  659 -8487.5783 4400.18329   152%     -  343s
     0     0 4214.83863    0  665 -8487.5783 4214.83863   150%     -  360s
     0     0 4180.54232    0  664 -8487.5783 4180.54232   149%     -  368s
     0     0 4174.25441    0  719 -8487.5783 4174.25441   149%     -  373s
     0     0 4162.06692    0  706 -8487.5783 4162.06692   149%     -  377s
     0     0 4152.47032    0  709 -8487.5783 4152.47032   149%     -  380s
     0     0 4142.90304    0  671 -8487.5783 4142.90304   149%     -  383s
     0     0 4137.86840    0  720 -8487.5783 4137.86840   149%     -  387s
     0     0 4131.24810    0  725 -8487.5783 4131.24810   149%     -  390s
     0     0 4125.69616    0  711 -8487.5783 4125.69616   149%     -  393s
     0     0 4115.50466    0  710 -8487.5783 4115.50466   148%     -  396s
     0     0 4114.68961    0  709 -8487.5783 4114.68961   148%     -  397s
     0     0 3208.80599    0  632 -8487.5783 3208.80599   138%     -  435s
H    0     0                    -8179.327325 3208.30830   139%     -  435s
     0     0 2927.77533    0  620 -8179.3273 2927.77533   136%     -  453s
     0     0 2855.92423    0  610 -8179.3273 2855.92423   135%     -  465s
     0     0 2836.01110    0  609 -8179.3273 2836.01110   135%     -  469s
H    0     0                    -8129.208363 2776.97441   134%     -  477s
H    0     0                    -8129.139245 2776.97441   134%     -  477s
H    0     0                    -8090.649618 2776.97441   134%     -  477s
     0     0 2776.97441    0  603 -8090.6496 2776.97441   134%     -  477s
     0     0 2763.82054    0  597 -8090.6496 2763.82054   134%     -  480s
     0     0 2712.47690    0  615 -8090.6496 2712.47690   134%     -  489s
     0     0 2708.26045    0  615 -8090.6496 2708.26045   133%     -  491s
     0     0 2700.41234    0  614 -8090.6496 2700.41234   133%     -  493s
     0     0 2698.65511    0  609 -8090.6496 2698.65511   133%     -  495s
H    0     0                    -7998.339639 2479.91755   131%     -  512s
H    0     0                    -7874.105933 2479.91755   131%     -  512s
     0     0 2479.91755    0  498 -7874.1059 2479.91755   131%     -  512s
     0     0 2442.35979    0  439 -7874.1059 2442.35979   131%     -  521s
H    0     0                    -7852.982131 2401.77107   131%     -  530s
H    0     0                    -7844.131929 2401.77107   131%     -  530s
H    0     0                    -7816.131442 2401.77107   131%     -  530s
H    0     0                    -7789.897652 2401.77107   131%     -  530s
     0     0 2401.77107    0  485 -7789.8977 2401.77107   131%     -  530s
     0     0 2378.99476    0  442 -7789.8977 2378.99476   131%     -  538s
     0     0 2375.35609    0  433 -7789.8977 2375.35609   130%     -  540s
     0     0 2366.24057    0  439 -7789.8977 2366.24057   130%     -  545s
     0     0 2365.57546    0  524 -7789.8977 2365.57546   130%     -  548s
     0     0 2229.71559    0  527 -7789.8977 2229.71559   129%     -  562s
H    0     0                    -7727.341970 2228.85405   129%     -  566s
H    0     0                    -7722.646217 2228.85405   129%     -  566s
     0     0 2210.61075    0  528 -7722.6462 2210.61075   129%     -  575s
     0     0 2207.96172    0  535 -7722.6462 2207.96172   129%     -  578s
     0     0 2115.32184    0  541 -7722.6462 2115.32184   127%     -  589s
     0     0 2104.79630    0  540 -7722.6462 2104.79630   127%     -  593s
     0     0 2071.44576    0  643 -7722.6462 2071.44576   127%     -  599s
     0     0 2068.50217    0  540 -7722.6462 2068.50217   127%     -  602s
     0     0 2021.92552    0  536 -7722.6462 2021.92552   126%     -  612s
H    0     0                    -7716.003664 2021.62545   126%     -  613s
H    0     0                    -7698.429161 2021.62545   126%     -  613s
     0     0 1980.18347    0  532 -7698.4292 1980.18347   126%     -  623s
     0     0 1954.80907    0  699 -7698.4292 1954.80907   125%     -  628s
     0     0 1950.86118    0  709 -7698.4292 1950.86118   125%     -  631s
     0     0 1947.77924    0  710 -7698.4292 1947.77924   125%     -  633s
     0     0 1907.07064    0  713 -7698.4292 1907.07064   125%     -  645s
     0     0 1895.46934    0  727 -7698.4292 1895.46934   125%     -  652s
     0     0 1893.90562    0  734 -7698.4292 1893.90562   125%     -  655s
     0     0 1870.86899    0  738 -7698.4292 1870.86899   124%     -  665s
     0     0 1849.32102    0  569 -7698.4292 1849.32102   124%     -  672s
     0     0 1845.98772    0  686 -7698.4292 1845.98772   124%     -  676s
     0     0 1845.18525    0  684 -7698.4292 1845.18525   124%     -  678s
     0     0 1820.37539    0  556 -7698.4292 1820.37539   124%     -  690s
     0     0 1814.38890    0  724 -7698.4292 1814.38890   124%     -  694s
     0     0 1811.31785    0  724 -7698.4292 1811.31785   124%     -  697s
     0     0 1756.36687    0  720 -7698.4292 1756.36687   123%     -  708s
     0     0 1734.37001    0  718 -7698.4292 1734.37001   123%     -  717s
     0     0 1732.64541    0  718 -7698.4292 1732.64541   123%     -  719s
     0     0 1647.81630    0  731 -7698.4292 1647.81630   121%     -  727s
     0     0 1642.34616    0  721 -7698.4292 1642.34616   121%     -  731s
     0     0 1640.96528    0  731 -7698.4292 1640.96528   121%     -  732s
     0     0 1609.79921    0  711 -7698.4292 1609.79921   121%     -  739s
     0     0 1587.34710    0  549 -7698.4292 1587.34710   121%     -  745s
     0     0 1577.63322    0  706 -7698.4292 1577.63322   120%     -  751s
     0     0 1575.02280    0  714 -7698.4292 1575.02280   120%     -  753s
     0     0 1544.99027    0  670 -7698.4292 1544.99027   120%     -  761s
     0     0 1540.60664    0  562 -7698.4292 1540.60664   120%     -  764s
     0     0 1539.20552    0  562 -7698.4292 1539.20552   120%     -  765s
     0     0 1510.14110    0  708 -7698.4292 1510.14110   120%     -  774s
     0     0 1502.16297    0  685 -7698.4292 1502.16297   120%     -  779s
     0     0 1499.42287    0  711 -7698.4292 1499.42287   119%     -  782s
     0     0 1484.48449    0  708 -7698.4292 1484.48449   119%     -  788s
     0     0 1481.62878    0  661 -7698.4292 1481.62878   119%     -  792s
     0     0 1474.75689    0  667 -7698.4292 1474.75689   119%     -  796s
     0     0 1473.68197    0  667 -7698.4292 1473.68197   119%     -  801s
H    0     0                    -7688.572040 1473.68197   119%     -  818s
H    0     0                    -7679.910267 1473.64548   119%     -  902s
H    0     0                    -7674.240457 1473.64548   119%     -  911s
H    0     0                    -7615.237491 1473.64548   119%     -  911s
H    0     0                    -7586.896761 1473.64548   119%     -  915s
H    0     0                    -7498.750664 1473.64548   120%     -  915s
     0     2 1473.64548    0  667 -7498.7507 1473.64548   120%     -  919s
     1     4 1468.52983    1  658 -7498.7507 1473.64548   120%  3887  928s
     3     8 1308.53078    2  663 -7498.7507 1468.09570   120%  7674  944s
     7    15  902.65876    3  452 -7498.7507 1308.40330   117% 10636  957s
    14    30  566.69574    4  351 -7498.7507 1308.40330   117% 11458  967s
    29    45 1064.42174    5  543 -7498.7507 1138.67890   115% 11915 1001s
    44    67 -1101.6080    6  327 -7498.7507 1138.67890   115% 15315 1167s
    76   136 -1212.2923    7  329 -7498.7507 1016.99618   114% 19472 1196s
   159   165 -1891.4341    8  299 -7498.7507  971.19386   113% 11323 1219s
   192   209 -2180.8698    9  295 -7498.7507  971.19386   113% 10195 1242s
   240   228 -2189.9691   10  291 -7498.7507  971.19386   113%  8863 1259s
   300   245 -2373.6031   14  296 -7498.7507  971.19386   113%  7723 1277s
   329   275 -2446.6386   15  296 -7498.7507  856.29538   111%  7389 1294s
   375   302 -2505.8228   16  298 -7498.7507  856.29538   111%  6998 1316s
   418   339 -4244.9823   17  398 -7498.7507  856.29538   111%  6734 1336s
   464   378 -4401.5016   18  417 -7498.7507  856.29538   111%  6444 1355s
   529   417 -4990.0600   22  154 -7498.7507  856.29538   111%  6155 1373s
   593   458 -5434.6636   24  403 -7498.7507  856.29538   111%  5854 1391s
   656   483 -5877.3267   28  396 -7498.7507  856.29538   111%  5600 1408s
   717   526 -5968.0479   31  334 -7498.7507  856.29538   111%  5354 1426s
   785   545 -6357.0260   35  395 -7498.7507  856.29538   111%  5179 1442s
   854   578 -6668.7062   39  255 -7498.7507  856.29538   111%  4981 1458s
   919   602 -7209.8750   43  117 -7498.7507  856.29538   111%  4828 1476s
   986   638     cutoff   48      -7498.7507  856.29538   111%  4661 1494s
  1044   686 -5810.8021   13  184 -7498.7507  856.29538   111%  4648 1510s
  1111   710 -5684.3083   14  182 -7498.7507  856.29538   111%  4543 1527s
  1190   763 -6104.3484   16  113 -7498.7507  856.29538   111%  4421 1544s
  1285   805 -6207.3389   23   73 -7498.7507  856.29538   111%  4261 1565s
H 1342   805                    -6975.776219  856.29538   112%  4161 1565s
  1375   855 -6340.4166   31   26 -6975.7762  856.29538   112%  4141 1587s
  1482   893 -6425.0187   38   23 -6975.7762  856.29538   112%  4020 1611s
  1576   956 -4992.0953    9  216 -6975.7762  856.29538   112%  3990 1637s
  1657  1038 -6239.3519   11  101 -6975.7762  856.29538   112%  4014 1660s
  1789  1101 -5789.5701   21  184 -6975.7762  856.29538   112%  3923 1686s
  1919  1159 -2898.8399   16  577 -6975.7762  856.29538   112%  3847 1712s
  2063  1192 -3728.6152   18  479 -6975.7762  856.29538   112%  3753 1741s
  2177  1244 -5219.3078   21  466 -6975.7762  856.29538   112%  3733 1771s
  2287  1300 -5678.1203   24  459 -6975.7762  856.29538   112%  3740 1804s
  2389  1325 -6722.5670   30  331 -6975.7762  856.29538   112%  3753 1839s
  2479  1373     cutoff   31      -6975.7762  856.29538   112%  3749 1873s
  2577  1409     cutoff   30      -6975.7762  381.02842   105%  3770 1908s
H 2583  1409                    -6814.517284  381.02842   106%  3776 1908s
H 2584  1409                    -6739.108186  381.02842   106%  3775 1908s
H 2679  1409                    -6691.304555  381.02842   106%  3750 1908s
  2705  1439 -2660.4141    9  215 -6691.3046  381.02842   106%  3747 1946s
H 2795  1488                    -6684.654884  381.02842   106%  3783 1989s
H 2796  1488                    -6676.729062  381.02842   106%  3785 1989s
H 2804  1488                    -6668.433925  381.02842   106%  3793 1989s
H 2838  1488                    -6668.112233  381.02842   106%  3797 1989s
H 2854  1488                    -6656.918275  381.02842   106%  3815 1989s
H 2863  1488                    -6625.963567  381.02842   106%  3819 1989s
  2882  1580 -3483.6104   11  210 -6625.9636  381.02842   106%  3821 2031s
H 3022  1630                    -6622.957085  381.02842   106%  3824 2075s
H 3027  1630                    -6611.225123  381.02842   106%  3824 2075s
H 3038  1630                    -6601.169429  381.02842   106%  3824 2075s
H 3066  1630                    -6594.036823  381.02842   106%  3834 2075s
  3157  1648     cutoff   14      -6594.0368 -127.83261  98.1%  3815 2114s
H 3159  1648                    -6339.327616 -128.02580  98.0%  3819 2114s
H 3181  1648                    -6211.027734 -128.02580  97.9%  3820 2114s
  3244  1670 -623.95376    7  611 -6211.0277 -129.74816  97.9%  3847 2162s
  3362  1714 -1185.7353    9  601 -6211.0277 -129.74816  97.9%  3887 2214s
  3484  1734 -2587.3939   11  554 -6211.0277 -129.74816  97.9%  3921 2268s
H 3531  1734                    -6202.228873 -881.13344  85.8%  3907 2268s
H 3581  1734                    -6201.770820 -928.73960  85.0%  3914 2268s
  3643  1765 -3179.0719   12  572 -6201.7708 -928.73960  85.0%  3943 2324s
  3795  1754 -4060.8914   14  534 -6201.7708 -963.90167  84.5%  3966 2381s
H 3812  1754                    -6144.771112 -963.90167  84.3%  3958 2381s
  3959  1737     cutoff   15      -6144.7711 -963.90167  84.3%  3961 2440s
  4121  1732 -5701.8759   18  463 -6144.7711 -1087.8212  82.3%  3976 2504s
H 4140  1732                    -6144.035986 -1198.5595  80.5%  3974 2504s
H 4150  1732                    -6107.447508 -1198.5595  80.4%  3981 2504s
H 4197  1732                    -6089.839741 -1198.5595  80.3%  3991 2504s
  4266  1708 -4266.5883   13  460 -6089.8397 -1198.5595  80.3%  4010 2551s
H 4277  1708                    -6072.946610 -1198.5595  80.3%  4016 2551s
  4336  1768 -4368.3834   14  435 -6072.9466 -1198.5595  80.3%  4026 2616s
  4482  1771 -5114.0853   16  392 -6072.9466 -1198.5595  80.3%  4047 2687s
  4692  1758     cutoff   28      -6072.9466 -1198.5595  80.3%  4022 2761s
  4843  1777 -4905.5070    7  290 -6072.9466 -1198.5595  80.3%  4077 2863s
  4986  1798 -6018.4141   15  444 -6072.9466 -1407.9485  76.8%  4148 2945s
  5148  1845 -5436.3730   18  373 -6072.9466 -1495.2497  75.4%  4168 3023s
  5331  1876 -5308.7004   17  295 -6072.9466 -1635.0206  73.1%  4195 3090s
H 5358  1859                    -6050.826105 -1635.0206  73.0%  4216 3090s
  5442  1868 infeasible   18      -6050.8261 -1650.3035  72.7%  4226 3175s
  5625  1929 -4138.6021    8  278 -6050.8261 -1724.9764  71.5%  4275 3261s
  5840  1957 -3689.3123   15  349 -6050.8261 -1761.6669  70.9%  4306 3351s
  6022  1962     cutoff   24      -6050.8261 -1900.5264  68.6%  4364 3442s
  6206  2030 infeasible   18      -6050.8261 -2018.4082  66.6%  4422 3534s
  6458  2070 -3823.0059   12  350 -6050.8261 -2040.6062  66.3%  4449 3600s

Cutting planes:
  Learned: 2
  Gomory: 11
  Implied bound: 505
  MIR: 4533
  Flow cover: 4267
  Zero half: 8
  RLT: 249
  Relax-and-lift: 1353

Explored 6658 nodes (30469299 simplex iterations) in 3600.05 seconds (7873.19 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -6050.83 -6072.95 -6089.84 ... -6339.33

Time limit reached
Best objective -6.050826105106e+03, best bound -2.096238353118e+03, gap 65.3562%
  WARNING: Time limit reached. Using best solution found (gap: 65.36%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = -6050.83, θ = 110390.62
  Upper Bound (UB) = -6050.83

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 110390.62
  [DEBUG]   ✓ Scenario 0: θ = 110390.62 ≤ Q = 110390.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 110390.62 ≤ Q = 110390.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 110390.62 ≤ Q = 110554.62 (slack: 164.01)
  [DEBUG]   ✓ Scenario 3: θ = 110390.62 ≤ Q = 110390.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 110390.62 ≤ Q = 110390.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 110390.62 ≤ Q = 110390.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 110390.62 ≤ Q = 110395.34 (slack: 4.72)
  [DEBUG]   ✓ Scenario 7: θ = 110390.62 ≤ Q = 110390.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 110390.62 ≤ Q = 110390.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 110390.62 ≤ Q = 110390.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 110390.62 ≤ Q = 110390.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 110390.62 ≤ Q = 110390.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 110390.62 ≤ Q = 110427.54 (slack: 36.92)
  [DEBUG] All optimality cuts satisfied.
[Iteration 13] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x46053b0e
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xb9fac4f2
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.201485e+13
Presolve removed 2602 rows and 1895 columns
Presolve time: 0.00s
Presolved: 491 rows, 494 columns, 1384 nonzeros
Found heuristic solution: objective 6180045.1487
Variable types: 334 continuous, 160 integer (160 binary)

Root relaxation: objective -1.181291e+05, 232 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -118129.10    0  122 6180045.15 -118129.10   102%     -    0s
H    0     0                    -85503.53277 -118129.10  38.2%     -    0s
H    0     0                    -86097.89869 -118129.10  37.2%     -    0s
     0     0 -93772.664    0  101 -86097.899 -93772.664  8.91%     -    0s
H    0     0                    -89693.59353 -93655.496  4.42%     -    0s
H    0     0                    -89981.50463 -93655.496  4.08%     -    0s
H    0     0                    -90737.43332 -93655.496  3.22%     -    0s
H    0     0                    -91025.34442 -93655.496  2.89%     -    0s
     0     0 -93181.952    0  101 -91025.344 -93181.952  2.37%     -    0s
H    0     0                    -91208.24962 -93094.751  2.07%     -    0s
     0     0 -93088.668    0  101 -91208.250 -93088.668  2.06%     -    0s
     0     0 -92883.858    0  104 -91208.250 -92883.858  1.84%     -    0s
     0     0 -92854.988    0  104 -91208.250 -92854.988  1.81%     -    0s
     0     0 -92698.217    0  104 -91208.250 -92698.217  1.63%     -    0s
     0     0 -92628.148    0  104 -91208.250 -92628.148  1.56%     -    0s
     0     0 -92452.058    0  103 -91208.250 -92452.058  1.36%     -    0s
     0     0 -92418.824    0  103 -91208.250 -92418.824  1.33%     -    0s
     0     0 -92175.411    0   93 -91208.250 -92175.411  1.06%     -    0s
     0     0 -92118.471    0  107 -91208.250 -92118.471  1.00%     -    0s
     0     0 -92117.629    0  107 -91208.250 -92117.629  1.00%     -    0s
     0     0 -92033.122    0  107 -91208.250 -92033.122  0.90%     -    0s
     0     0 -92015.649    0  107 -91208.250 -92015.649  0.89%     -    0s
     0     2 -92015.649    0  107 -91208.250 -92015.649  0.89%     -    0s
H  120   136                    -91209.51673 -91683.831  0.52%  14.0    0s
H  225   136                    -91212.56079 -91636.353  0.46%  10.5    0s
H 2029   264                    -91215.03301 -91338.338  0.14%   6.1    0s
H 2412   103                    -91227.44772 -91295.981  0.08%   5.8    0s

Cutting planes:
  Gomory: 40
  Implied bound: 7
  MIR: 279
  Flow cover: 2
  RLT: 7
  BQP: 2

Explored 2889 nodes (16882 simplex iterations) in 0.23 seconds (0.15 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -91227.4 -91215 -91212.6 ... 6.18005e+06
No other solutions better than -91227.4

Optimal solution found (tolerance 1.00e-04)
Best objective -9.122744771876e+04, best bound -9.122744771876e+04, gap 0.0000%
  Subproblem solved in 0.24s
  Worst-case operational profit (Z_SP) = 107577.64
  Scenario: 43 demand increases, 17 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -91227.45
  [DEBUG]   S×d_nominal = 198805.08
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 198805.08 + -91227.45 = 107577.64
  [DEBUG]   Current θ from Master = 110390.62
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2812.98 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -8863.81
  Lower Bound (LB) = -8863.81
  Gap (UB-LB) = 2812.9801, Absolute Gap = 2812.9801, Relative Gap = 0.464892
  Not converged yet (gap = 2812.98 > ε = 200)

  [DEBUG] Adding NEW scenario 13 to Master Problem...
  [DEBUG] New scenario pattern: 43 increases, 17 decreases
    [DEBUG] Scenario 13 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 13 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 13]
    [DEBUG]   - Total constraints in model: 215443
    [DEBUG]   - Total variables in model: 89620
  [DEBUG] Total scenarios in Master: 14
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 14
================================================================================
[Iteration 14] Solving Master Problem...
  Current scenarios in Master: 14
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 215443 rows, 89620 columns and 610753 nonzeros
Model fingerprint: 0x9d403558
Variable types: 87361 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [9e-02, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 99220 rows and 40300 columns
Presolve time: 1.60s
Presolved: 116223 rows, 49320 columns, 700039 nonzeros
Variable types: 47061 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -375071.0416
Found heuristic solution: objective -172304.4497

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.25s

Barrier statistics:
 Dense cols : 602
 AA' NZ     : 4.632e+06
 Factor NZ  : 1.106e+07 (roughly 160 MB of memory)
 Factor Ops : 2.244e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.69760157e+07  1.90038033e+08  8.75e+04 2.13e+01  6.90e+04     3s
   1  -1.28284544e+07  1.65744529e+08  6.08e+04 5.65e+01  4.74e+04     3s
   2  -3.97400149e+06  1.28129200e+08  1.82e+04 6.46e-01  1.51e+04     3s
   3  -1.01998358e+06  8.43931450e+07  2.81e+03 2.20e-01  2.55e+03     3s
   4  -5.06504058e+05  4.06483883e+07  4.63e+02 8.67e-02  5.16e+02     3s
   5  -3.86773280e+05  2.71208285e+07  1.73e+02 5.51e-02  2.41e+02     3s
   6  -2.81265915e+05  1.94817160e+07  5.88e+01 3.10e-02  1.27e+02     3s
   7  -1.75916111e+05  1.34619881e+07  1.61e+01 1.99e-02  7.18e+01     3s
   8  -9.71191907e+04  9.12581520e+06  4.97e+00 1.30e-02  4.51e+01     3s
   9  -8.34861978e+04  5.01011131e+06  3.43e+00 7.02e-03  2.47e+01     3s
  10  -6.36056917e+04  2.18524367e+06  1.95e+00 3.00e-03  1.08e+01     3s
  11  -3.68678620e+04  4.76404565e+05  1.02e+00 7.48e-04  2.44e+00     3s
  12  -2.08417808e+04  2.69065909e+05  4.92e-01 3.71e-04  1.37e+00     3s
  13  -9.84681316e+03  1.34108784e+05  2.45e-01 5.98e-04  6.79e-01     3s
  14  -5.90360865e+03  8.88338855e+04  1.97e-01 7.46e-04  4.47e-01     3s
  15  -4.06246720e+03  6.75664489e+04  1.77e-01 5.79e-04  3.38e-01     3s
  16   1.88547039e+03  5.61419086e+04  1.20e-01 9.48e-04  2.56e-01     4s
  17   4.01495577e+03  5.07905123e+04  1.05e-01 8.62e-04  2.21e-01     4s
  18   5.81858393e+03  3.97889117e+04  9.20e-02 1.30e-03  1.60e-01     4s
  19   7.47885460e+03  3.65722260e+04  8.11e-02 1.38e-03  1.37e-01     4s
  20   1.00052232e+04  3.40663553e+04  6.51e-02 1.78e-03  1.13e-01     4s
  21   1.13053744e+04  2.99785590e+04  5.71e-02 8.05e-04  8.81e-02     4s
  22   1.22825989e+04  2.84214264e+04  5.09e-02 7.28e-04  7.61e-02     4s
  23   1.45572955e+04  2.66964996e+04  3.66e-02 1.10e-03  5.72e-02     4s
  24   1.55106122e+04  2.58370616e+04  3.10e-02 9.73e-04  4.87e-02     4s
  25   1.58558338e+04  2.50161688e+04  2.90e-02 6.51e-04  4.32e-02     4s
  26   1.67686763e+04  2.37741058e+04  2.36e-02 1.21e-03  3.30e-02     4s
  27   1.75048747e+04  2.31868592e+04  1.94e-02 1.00e-03  2.68e-02     4s
  28   1.76871997e+04  2.30243312e+04  1.83e-02 9.26e-04  2.52e-02     4s
  29   1.79436534e+04  2.27257175e+04  1.69e-02 7.56e-04  2.26e-02     4s
  30   1.84586165e+04  2.22637351e+04  1.41e-02 5.10e-04  1.79e-02     4s
  31   1.88258167e+04  2.20724541e+04  1.21e-02 4.34e-04  1.53e-02     4s
  32   1.90739358e+04  2.18301256e+04  1.07e-02 3.38e-04  1.30e-02     4s
  33   1.92629275e+04  2.17831523e+04  9.64e-03 3.14e-04  1.19e-02     4s
  34   1.94054752e+04  2.15887702e+04  8.80e-03 2.22e-04  1.03e-02     4s
  35   1.96127036e+04  2.14263144e+04  7.60e-03 1.62e-04  8.56e-03     4s
  36   1.98082802e+04  2.13689507e+04  6.53e-03 1.80e-04  7.36e-03     4s
  37   1.99518593e+04  2.13548719e+04  5.73e-03 1.72e-04  6.62e-03     4s
  38   2.01037795e+04  2.12461968e+04  4.84e-03 2.09e-04  5.39e-03     4s
  39   2.02366145e+04  2.12129593e+04  4.12e-03 1.75e-04  4.61e-03     5s
  40   2.03708907e+04  2.11213196e+04  3.41e-03 8.35e-05  3.54e-03     5s
  41   2.04980003e+04  2.10927625e+04  2.71e-03 8.12e-05  2.81e-03     5s
  42   2.05676272e+04  2.10892398e+04  2.35e-03 7.73e-05  2.46e-03     5s
  43   2.06503200e+04  2.10728229e+04  1.91e-03 6.16e-05  1.99e-03     5s
  44   2.06700054e+04  2.10688734e+04  1.81e-03 5.75e-05  1.88e-03     5s
  45   2.07358315e+04  2.10592966e+04  1.45e-03 4.86e-05  1.53e-03     5s
  46   2.08013196e+04  2.10459992e+04  1.09e-03 3.17e-05  1.15e-03     5s
  47   2.08176967e+04  2.10435756e+04  1.01e-03 3.00e-05  1.07e-03     5s
  48   2.08728394e+04  2.10363234e+04  7.06e-04 2.41e-05  7.71e-04     5s
  49   2.09068487e+04  2.10340824e+04  5.26e-04 2.20e-05  6.00e-04     5s
  50   2.09509640e+04  2.10242165e+04  2.91e-04 1.40e-05  3.46e-04     5s
  51   2.09626242e+04  2.10189052e+04  2.30e-04 8.54e-06  2.65e-04     5s
  52   2.09755063e+04  2.10160295e+04  1.64e-04 6.57e-06  1.91e-04     5s
  53   2.09817868e+04  2.10154682e+04  1.35e-04 5.96e-06  1.59e-04     5s
  54   2.09848310e+04  2.10127372e+04  1.19e-04 3.37e-06  1.32e-04     5s
  55   2.09977535e+04  2.10120059e+04  5.50e-05 7.68e-06  6.72e-05     5s
  56   2.10026990e+04  2.10103374e+04  3.12e-05 3.36e-06  3.60e-05     5s
  57   2.10037988e+04  2.10101224e+04  2.58e-05 2.58e-06  2.98e-05     5s
  58   2.10073202e+04  2.10098815e+04  8.63e-06 1.76e-06  1.21e-05     5s
  59   2.10092046e+04  2.10095448e+04  2.13e-07 7.92e-07  1.60e-06     5s
  60   2.10092623e+04  2.10092711e+04  1.25e-08 8.71e-09  4.17e-08     5s
  61   2.10092671e+04  2.10092671e+04  3.06e-10 2.84e-09  1.11e-11     6s

Barrier solved model in 61 iterations and 5.51 seconds (11.80 work units)
Optimal objective 2.10092671e+04


Root crossover log...

   92237 DPushes remaining with DInf 0.0000000e+00                 6s
       0 DPushes remaining with DInf 0.0000000e+00                 7s

    3319 PPushes remaining with PInf 3.2715632e-06                 7s
       0 PPushes remaining with PInf 0.0000000e+00                 7s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.6627368e-02      7s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   36137    2.1009267e+04   0.000000e+00   2.662737e-02      7s
   36138    2.1009267e+04   0.000000e+00   0.000000e+00      7s
   36138    2.1009267e+04   0.000000e+00   0.000000e+00      7s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 2.100927e+04, 36138 iterations, 4.59 seconds (10.67 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 21009.2671    0  446 -172304.45 21009.2671   112%     -    7s
H    0     0                    -167714.5927 21009.2671   113%     -    7s
H    0     0                    -157907.4784 21009.2671   113%     -    7s
H    0     0                    -148193.5525 21009.2671   114%     -    7s
H    0     0                    -115221.5547 21009.2671   118%     -    7s
H    0     0                    -67154.18410 21009.2671   131%     -    7s
H    0     0                    -63585.88591 21009.2671   133%     -    7s
H    0     0                    -37357.17462 21009.2671   156%     -    7s
H    0     0                    -32669.41623 21009.2671   164%     -    7s
H    0     0                    -32241.02677 21009.2671   165%     -    7s
H    0     0                    -19040.67700 21009.2671   210%     -    9s
H    0     0                    -13376.47672 21009.2671   257%     -    9s
H    0     0                    -13373.94281 21009.2671   257%     -    9s
     0     0 14868.2018    0  648 -13373.943 14868.2018   211%     -   34s
     0     0 14571.2995    0  662 -13373.943 14571.2995   209%     -   40s
     0     0 14525.5945    0  647 -13373.943 14525.5945   209%     -   43s
     0     0 14487.4061    0  641 -13373.943 14487.4061   208%     -   45s
     0     0 14487.4061    0  647 -13373.943 14487.4061   208%     -   48s
     0     0 14487.4061    0  655 -13373.943 14487.4061   208%     -   49s
     0     0 14487.4061    0  658 -13373.943 14487.4061   208%     -   50s
     0     0 14487.4061    0  657 -13373.943 14487.4061   208%     -   50s
     0     0 11038.7483    0  701 -13373.943 11038.7483   183%     -   80s
H    0     0                    -13295.59812 11033.7248   183%     -   80s
     0     0 9709.64445    0  694 -13295.598 9709.64445   173%     -  120s
H    0     0                    -12828.11294 9345.65605   173%     -  148s
H    0     0                    -12813.12420 9345.65605   173%     -  148s
     0     0 9345.65605    0  666 -12813.124 9345.65605   173%     -  148s
     0     0 9218.92035    0  674 -12813.124 9218.92035   172%     -  161s
     0     0 9131.65820    0  687 -12813.124 9131.65820   171%     -  175s
     0     0 9068.04048    0  691 -12813.124 9068.04048   171%     -  187s
     0     0 9033.07749    0  703 -12813.124 9033.07749   170%     -  192s
     0     0 8906.07067    0  690 -12813.124 8906.07067   170%     -  204s
     0     0 8852.63885    0  688 -12813.124 8852.63885   169%     -  211s
     0     0 8810.24483    0  687 -12813.124 8810.24483   169%     -  218s
     0     0 8808.00622    0  687 -12813.124 8808.00622   169%     -  219s
     0     0 8800.14974    0  683 -12813.124 8800.14974   169%     -  222s
     0     0 8798.61018    0  687 -12813.124 8798.61018   169%     -  224s
     0     0 8797.53200    0  697 -12813.124 8797.53200   169%     -  226s
H    0     0                    -10821.18496 6511.50144   160%     -  301s
H    0     0                    -10741.53765 6511.50144   161%     -  301s
H    0     0                    -10504.70816 6511.50144   162%     -  301s
     0     0 6511.50144    0  641 -10504.708 6511.50144   162%     -  301s
H    0     0                    -10444.07806 6511.32205   162%     -  301s
H    0     0                    -9951.571830 6511.32205   165%     -  301s
H    0     0                    -9920.827296 6511.32205   166%     -  301s
     0     0 5847.22034    0  613 -9920.8273 5847.22034   159%     -  332s
H    0     0                    -9894.618267 5628.27307   157%     -  358s
H    0     0                    -9712.314791 5628.27307   158%     -  358s
     0     0 5628.27307    0  645 -9712.3148 5628.27307   158%     -  358s
     0     0 5573.23797    0  622 -9712.3148 5573.23797   157%     -  374s
     0     0 5460.33297    0  616 -9712.3148 5460.33297   156%     -  392s
     0     0 5389.50624    0  613 -9712.3148 5389.50624   155%     -  403s
     0     0 5368.83613    0  631 -9712.3148 5368.83613   155%     -  411s
     0     0 5328.28650    0  645 -9712.3148 5328.28650   155%     -  420s
     0     0 5279.45227    0  647 -9712.3148 5279.45227   154%     -  427s
     0     0 5271.04584    0  645 -9712.3148 5271.04584   154%     -  431s
     0     0 5257.59106    0  621 -9712.3148 5257.59106   154%     -  435s
     0     0 5249.24935    0  624 -9712.3148 5249.24935   154%     -  438s
     0     0 5243.42322    0  625 -9712.3148 5243.42322   154%     -  442s
     0     0 5232.57089    0  626 -9712.3148 5232.57089   154%     -  448s
     0     0 5225.76981    0  654 -9712.3148 5225.76981   154%     -  452s
     0     0 5224.06335    0  642 -9712.3148 5224.06335   154%     -  454s
H    0     0                    -9557.708485 5224.06335   155%     -  464s
     0     0 4133.96805    0  422 -9557.7085 4133.96805   143%     -  500s
     0     0 3814.65011    0  636 -9557.7085 3814.65011   140%     -  530s
     0     0 3664.50034    0  525 -9557.7085 3664.50034   138%     -  551s
     0     0 3634.42348    0  511 -9557.7085 3634.42348   138%     -  560s
     0     0 3508.06284    0  519 -9557.7085 3508.06284   137%     -  575s
     0     0 3473.49791    0  524 -9557.7085 3473.49791   136%     -  583s
     0     0 3457.96755    0  673 -9557.7085 3457.96755   136%     -  588s
     0     0 3323.32642    0  518 -9557.7085 3323.32642   135%     -  598s
     0     0 3299.23349    0  531 -9557.7085 3299.23349   135%     -  602s
     0     0 3243.90527    0  525 -9557.7085 3243.90527   134%     -  609s
     0     0 3240.05122    0  535 -9557.7085 3240.05122   134%     -  612s
     0     0 3235.48100    0  547 -9557.7085 3235.48100   134%     -  614s
     0     0 3226.98574    0  539 -9557.7085 3226.98574   134%     -  618s
     0     0 3214.98501    0  540 -9557.7085 3214.98501   134%     -  622s
     0     0 3187.83193    0  543 -9557.7085 3187.83193   133%     -  626s
     0     0 3178.75390    0  547 -9557.7085 3178.75390   133%     -  628s
     0     0 3174.39692    0  542 -9557.7085 3174.39692   133%     -  630s
     0     0 3167.39747    0  544 -9557.7085 3167.39747   133%     -  634s
     0     0 3145.55780    0  547 -9557.7085 3145.55780   133%     -  638s
     0     0 3140.83410    0  532 -9557.7085 3140.83410   133%     -  640s
     0     0 3138.82045    0  525 -9557.7085 3138.82045   133%     -  644s
     0     0 2915.37605    0  529 -9557.7085 2915.37605   131%     -  661s
     0     0 2728.92280    0  533 -9557.7085 2728.92280   129%     -  675s
     0     0 2680.82272    0  752 -9557.7085 2680.82272   128%     -  683s
     0     0 2648.24122    0  560 -9557.7085 2648.24122   128%     -  687s
     0     0 2646.70127    0  563 -9557.7085 2646.70127   128%     -  690s
     0     0 2486.87080    0  637 -9557.7085 2486.87080   126%     -  705s
H    0     0                    -9523.853882 2486.76684   126%     -  707s
H    0     0                    -9492.372756 2486.76684   126%     -  707s
     0     0 2348.64843    0  676 -9492.3728 2348.64843   125%     -  722s
     0     0 2338.64557    0  530 -9492.3728 2338.64557   125%     -  728s
     0     0 2333.37025    0  546 -9492.3728 2333.37025   125%     -  731s
     0     0 2327.47963    0  681 -9492.3728 2327.47963   125%     -  736s
     0     0 2314.89653    0  666 -9492.3728 2314.89653   124%     -  741s
     0     0 2313.44219    0  665 -9492.3728 2313.44219   124%     -  743s
     0     0 2242.05554    0  527 -9492.3728 2242.05554   124%     -  754s
     0     0 2223.01531    0  525 -9492.3728 2223.01531   123%     -  760s
     0     0 2196.98929    0  541 -9492.3728 2196.98929   123%     -  765s
     0     0 2195.07807    0  528 -9492.3728 2195.07807   123%     -  767s
     0     0 2144.48636    0  546 -9492.3728 2144.48636   123%     -  779s
H    0     0                    -9476.891159 2144.46988   123%     -  779s
     0     0 2132.42471    0  644 -9476.8912 2132.42471   123%     -  787s
     0     0 2130.94504    0  646 -9476.8912 2130.94504   122%     -  789s
     0     0 2110.48532    0  658 -9476.8912 2110.48532   122%     -  799s
     0     0 2104.45287    0  653 -9476.8912 2104.45287   122%     -  803s
     0     0 2093.02627    0  648 -9476.8912 2093.02627   122%     -  809s
     0     0 2087.19251    0  562 -9476.8912 2087.19251   122%     -  813s
     0     0 2085.32777    0  562 -9476.8912 2085.32777   122%     -  815s
     0     0 2059.60158    0  570 -9476.8912 2059.60158   122%     -  823s
H    0     0                    -8388.506845 2059.56878   125%     -  826s
H    0     0                    -8374.768700 2059.56878   125%     -  826s
H    0     0                    -8314.901549 2059.56878   125%     -  826s
     0     0 2054.58487    0  559 -8314.9015 2054.58487   125%     -  829s
     0     0 2049.06297    0  567 -8314.9015 2049.06297   125%     -  832s
     0     0 2044.39032    0  565 -8314.9015 2044.39032   125%     -  835s
     0     0 2044.02681    0  570 -8314.9015 2044.02681   125%     -  836s
     0     0 2025.89297    0  655 -8314.9015 2025.89297   124%     -  846s
H    0     0                    -8266.350838 2025.87919   125%     -  847s
H    0     0                    -8246.171564 2025.87919   125%     -  847s
     0     0 2021.15983    0  659 -8246.1716 2021.15983   125%     -  852s
     0     0 2019.26951    0  662 -8246.1716 2019.26951   124%     -  857s
     0     0 2010.68773    0  679 -8246.1716 2010.68773   124%     -  865s
     0     0 2010.67595    0  679 -8246.1716 2010.67595   124%     -  870s
H    0     0                    -8092.739755 2010.67595   125%     -  892s
H    0     0                    -7995.088158 2010.67595   125%     -  892s
H    0     0                    -7980.031598 2010.67595   125%     -  892s
H    0     0                    -7967.398629 2010.67595   125%     -  892s
H    0     0                    -7916.535735 2010.67595   125%     -  936s
H    0     0                    -7877.061843 2010.67595   126%     -  937s
     0     2 2010.67595    0  679 -7877.0618 2010.67595   126%     -  951s
     1     4 1950.46078    1  566 -7877.0618 2010.38889   126%  9851  969s
     3     8 1944.03763    2  660 -7877.0618 1950.18551   125% 11749  985s
     7    15 1901.92255    3  663 -7877.0618 1944.03059   125% 11852 1014s
    14    28 1753.72972    4  665 -7877.0618 1901.54051   124% 14746 1043s
    27    41 -2089.0304    5  295 -7877.0618 1901.54051   124% 19512 1523s
    40    65 -2406.3227    5  320 -7877.0618 1753.67595   122% 21574 1648s
H   41    65                    -7838.084605 1753.67595   122% 21048 1648s
H   44    65                    -7836.236466 1753.67595   122% 20390 1648s
    70   187 -2504.5659    6  316 -7836.2365 1753.67595   122% 20131 1709s
   208   237     cutoff   11      -7836.2365 1753.67595   122% 12251 1737s
H  211   237                    -7669.003132 1753.67595   123% 12153 1737s
   268   275     cutoff   12      -7669.0031 1753.67595   123% 11670 1766s
   328   300 -7101.3564   13  229 -7669.0031 1753.67595   123% 10904 1785s
   365   326 -7119.3505   14  216 -7669.0031 1753.67595   123% 10853 1805s
   393   347     cutoff   15      -7669.0031 1753.67595   123% 10654 1827s
   418   373     cutoff   15      -7669.0031 1753.65148   123% 10536 1848s
   452   406 -2632.2978   15  223 -7669.0031 1753.65148   123% 10626 1871s
   500   433 -2647.8436   16  213 -7669.0031 1753.65148   123% 10398 1893s
   531   470 infeasible   17      -7669.0031 1753.65148   123% 10189 1918s
   591   527 -2744.9691   16  400 -7669.0031 1753.65148   123%  9840 1938s
   668   591 -3198.0345   17  337 -7669.0031 1753.65148   123%  9343 1955s
   759   650 -3397.8869   18  328 -7669.0031 1753.65148   123%  8840 1971s
   840   715 -3753.8018   20  306 -7669.0031 1753.65148   123%  8442 1990s
   939   751 -4305.9794   23  283 -7669.0031 1753.65148   123%  8146 2009s
  1020   822 -4343.4443   24  290 -7669.0031 1753.65148   123%  8060 2030s
  1121   901 -5715.7187   29  290 -7669.0031 1753.65148   123%  7844 2048s
  1235   976 -6161.3550   32  255 -7669.0031 1753.65148   123%  7583 2069s
  1362  1047 -6751.6152   33  255 -7669.0031 1753.65148   123%  7359 2087s
  1493  1060 -6936.1929   35  228 -7669.0031 1753.65148   123%  7113 2111s
  1599  1105 -4509.3420   18  251 -7669.0031 1753.65148   123%  7050 2135s
  1692  1180 -4708.7677   19  304 -7669.0031 1753.65148   123%  7067 2157s
  1815  1234 -5015.2957   22  303 -7669.0031 1753.65148   123%  6975 2178s
H 1857  1234                    -7545.250929 1753.65148   123%  6957 2178s
  1928  1270 -5103.8450   23  182 -7545.2509 1753.65148   123%  6878 2203s
  2053  1335 -5331.2692   22  169 -7545.2509 1753.65148   123%  6817 2229s
  2191  1373 -6882.5076   25  154 -7545.2509 1753.65148   123%  6781 2258s
  2321  1431 -5834.4202   25  130 -7545.2509 1753.65148   123%  6751 2285s
  2472  1484 -6025.9404   26  127 -7545.2509 1753.65148   123%  6756 2315s
  2634  1497 -7210.4554   34   91 -7545.2509 1753.65148   123%  6708 2342s
  2679  1519 -6897.8941   32   64 -7545.2509 1753.65148   123%  6734 2370s
  2719  1544 -7284.4293   33   88 -7545.2509 1753.65148   123%  6812 2399s
  2760  1559 infeasible   33      -7545.2509 1753.65148   123%  6888 2428s
  2803  1574 -7331.9677   35   91 -7545.2509 1753.65148   123%  6909 2456s
  2846  1594 infeasible   36      -7545.2509 1753.65148   123%  6976 2483s
  2902  1611 infeasible   16      -7545.2509  897.14650   112%  6981 2514s
  2946  1664 -5952.1093   11  170 -7545.2509   -9.41577   100%  7022 2545s
  3034  1707 -6433.1176   14  142 -7545.2509  -12.33832   100%  7016 2577s
  3147  1744 infeasible   16      -7545.2509  -12.33832   100%  7006 2613s
  3245  1769 -2199.2144    6  216 -7545.2509  -12.33832   100%  7072 2655s
  3342  1810     cutoff    7      -7545.2509  -12.33832   100%  7181 2696s
  3432  1854 infeasible   24      -7545.2509 -625.23803  91.7%  7286 2741s
  3537  1886 -2298.5446   10  375 -7545.2509 -625.23803  91.7%  7426 2785s
  3614  1968 -2316.2394   11  373 -7545.2509 -625.23803  91.7%  7533 2828s
  3746  2039 -3400.3060   15  274 -7545.2509 -905.31462  88.0%  7595 2876s
  3903  2102 -6261.0378   18  448 -7545.2509 -968.64797  87.2%  7678 2925s
  4062  2171 infeasible   19      -7545.2509 -986.14266  86.9%  7790 2977s
  4237  2242 -2825.3403    7  172 -7545.2509 -1086.3024  85.6%  7889 3044s
  4439  2317 -3798.3442   11  362 -7545.2509 -1086.3024  85.6%  7960 3106s
  4652  2340 -5230.7521   15  279 -7545.2509 -1112.0190  85.3%  7997 3170s
  4792  2398 -6516.8210   21  207 -7545.2509 -1315.4956  82.6%  8043 3238s
  4959  2478 -7332.4932   25  314 -7545.2509 -1373.8697  81.8%  8127 3305s
  5148  2607 -2939.1997   13  366 -7545.2509 -1418.6268  81.2%  8267 3368s

Cutting planes:
  Learned: 1
  Gomory: 3
  Implied bound: 671
  MIR: 5561
  Flow cover: 4047
  Inf proof: 1
  Zero half: 8
  RLT: 305
  Relax-and-lift: 1725

Explored 5373 nodes (45930679 simplex iterations) in 3600.02 seconds (8720.16 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -7545.25 -7669 -7836.24 ... -8092.74

Time limit reached
Best objective -7.545250929115e+03, best bound -1.418626784025e+03, gap 81.1984%
  WARNING: Time limit reached. Using best solution found (gap: 81.20%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = -7545.25, θ = 112102.00
  Upper Bound (UB) = -7545.25

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 112102.00
  [DEBUG]   ✓ Scenario 0: θ = 112102.00 ≤ Q = 112102.00 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 112102.00 ≤ Q = 112102.00 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 112102.00 ≤ Q = 112102.00 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 112102.00 ≤ Q = 112102.00 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 112102.00 ≤ Q = 112102.00 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 112102.00 ≤ Q = 112102.00 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 112102.00 ≤ Q = 112102.00 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 112102.00 ≤ Q = 112102.00 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 112102.00 ≤ Q = 112102.00 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 112102.00 ≤ Q = 112102.00 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 112102.00 ≤ Q = 112102.00 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 112102.00 ≤ Q = 112102.00 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 112102.00 ≤ Q = 112102.00 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 112102.00 ≤ Q = 112102.00 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 14] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x60d8d5ed
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x9f272a13
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.397168e+13
Presolve removed 2611 rows and 1904 columns
Presolve time: 0.00s
Presolved: 482 rows, 485 columns, 1359 nonzeros
Found heuristic solution: objective 6915500.7288
Variable types: 326 continuous, 159 integer (159 binary)
Found heuristic solution: objective 6915182.7465

Root relaxation: objective -1.314161e+05, 262 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -131416.11    0  128 6915182.75 -131416.11   102%     -    0s
H    0     0                    -87079.09875 -131416.11  50.9%     -    0s
H    0     0                    -87834.95010 -131416.11  49.6%     -    0s
H    0     0                    -111742.3817 -131416.11  17.6%     -    0s
     0     0 -114568.78    0   48 -111742.38 -114568.78  2.53%     -    0s
H    0     0                    -113314.9676 -114521.97  1.07%     -    0s
     0     0 -114399.01    0   48 -113314.97 -114399.01  0.96%     -    0s
H    0     0                    -113703.6151 -114399.01  0.61%     -    0s
     0     0 -114133.04    0   45 -113703.62 -114133.04  0.38%     -    0s
     0     0 -113936.78    0   21 -113703.62 -113936.78  0.21%     -    0s
     0     0 -113914.18    0   21 -113703.62 -113914.18  0.19%     -    0s
     0     0 -113914.08    0   21 -113703.62 -113914.08  0.19%     -    0s
     0     0 -113906.02    0   22 -113703.62 -113906.02  0.18%     -    0s
     0     0 -113786.38    0    5 -113703.62 -113786.38  0.07%     -    0s
     0     0 -113765.11    0    5 -113703.62 -113765.11  0.05%     -    0s
H    0     0                    -113753.4858 -113765.11  0.01%     -    0s

Cutting planes:
  Implied bound: 1
  MIR: 3
  RLT: 2

Explored 1 nodes (619 simplex iterations) in 0.07 seconds (0.03 work units)
Thread count was 32 (of 256 available processors)

Solution count 8: -113753 -113704 -113298 ... 1.39717e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.137534857737e+05, best bound -1.137557545743e+05, gap 0.0020%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 94465.79
  Scenario: 23 demand increases, 37 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -113753.49
  [DEBUG]   S×d_nominal = 208219.27
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 208219.27 + -113753.49 = 94465.79
  [DEBUG]   Current θ from Master = 112102.00
  [DEBUG]   ⚠️  Z_SP ≤ θ by 17636.21 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -25181.46
  Lower Bound (LB) = -8863.81
  Gap (UB-LB) = 1318.5553, Absolute Gap = 1318.5553, Relative Gap = 0.174753
  Not converged yet (gap = 1318.56 > ε = 200)

  [DEBUG] Adding NEW scenario 14 to Master Problem...
  [DEBUG] New scenario pattern: 23 increases, 37 decreases
    [DEBUG] Scenario 14 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 14 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 14]
    [DEBUG]   - Total constraints in model: 230733
    [DEBUG]   - Total variables in model: 95860
  [DEBUG] Total scenarios in Master: 15
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 15
================================================================================
[Iteration 15] Solving Master Problem...
  Current scenarios in Master: 15
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 230733 rows, 95860 columns and 653984 nonzeros
Model fingerprint: 0xc760991e
Variable types: 93601 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [9e-02, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 106330 rows and 43190 columns
Presolve time: 1.65s
Presolved: 124403 rows, 52670 columns, 767381 nonzeros
Variable types: 50411 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -371500.8959
Found heuristic solution: objective -172304.4497

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.29s

Barrier statistics:
 Dense cols : 635
 AA' NZ     : 5.743e+06
 Factor NZ  : 1.280e+07 (roughly 180 MB of memory)
 Factor Ops : 2.791e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.67307882e+07  1.96815731e+08  8.72e+04 2.27e+01  6.74e+04     3s
   1  -1.23692466e+07  1.71248567e+08  6.01e+04 4.99e+01  4.64e+04     3s
   2  -3.73538232e+06  1.37459150e+08  1.88e+04 1.45e+01  1.50e+04     3s
   3  -9.19956057e+05  1.31773234e+08  2.31e+03 2.20e+01  2.35e+03     3s
   4  -5.69129510e+05  6.03517726e+07  7.36e+02 6.14e+00  7.85e+02     3s
   5  -4.37444552e+05  3.68609160e+07  2.81e+02 2.67e+00  3.46e+02     3s
   6  -3.76686157e+05  2.82458144e+07  1.63e+02 1.47e+00  2.25e+02     3s
   7  -2.80969272e+05  2.06797988e+07  5.79e+01 2.85e-02  1.25e+02     3s
   8  -1.62948080e+05  1.28843150e+07  1.77e+01 1.62e-02  6.52e+01     3s
   9  -1.35511712e+05  9.98674730e+06  1.21e+01 1.22e-02  4.90e+01     3s
  10  -1.15504278e+05  4.00664549e+06  7.19e+00 4.37e-03  1.95e+01     4s
  11  -9.06445355e+04  1.58375822e+06  3.66e+00 1.09e-02  7.70e+00     4s
  12  -6.71887523e+04  6.32811005e+05  1.78e+00 2.19e-02  3.16e+00     4s
  13  -4.19529758e+04  2.30985282e+05  7.12e-01 2.25e-04  1.22e+00     4s
  14  -3.29231529e+04  1.46682493e+05  5.64e-01 1.44e-04  8.00e-01     4s
  15  -2.77482304e+04  1.14824736e+05  4.86e-01 1.28e-04  6.35e-01     4s
  16  -1.67922025e+04  8.39156033e+04  3.52e-01 2.68e-04  4.48e-01     4s
  17  -1.38650672e+04  7.05533858e+04  3.14e-01 5.13e-04  3.76e-01     4s
  18  -7.29913832e+03  4.94697994e+04  2.33e-01 1.24e-03  2.53e-01     4s
  19  -3.82102445e+03  4.22747012e+04  1.90e-01 8.56e-04  2.05e-01     4s
  20  -1.98774293e+03  3.68600086e+04  1.68e-01 8.62e-04  1.73e-01     4s
  21  -1.00022712e+03  3.36078702e+04  1.56e-01 7.31e-04  1.54e-01     4s
  22   9.40705640e+02  2.65688556e+04  1.35e-01 1.08e-03  1.14e-01     4s
  23   3.58238097e+03  2.44788423e+04  1.07e-01 1.25e-03  9.31e-02     4s
  24   6.16056945e+03  2.26270874e+04  8.05e-02 1.15e-03  7.33e-02     4s
  25   6.95718731e+03  2.14440050e+04  7.30e-02 1.09e-03  6.45e-02     4s
  26   8.70991393e+03  2.02414737e+04  5.62e-02 8.93e-04  5.13e-02     4s
  27   9.60799383e+03  1.84860757e+04  4.82e-02 2.07e-03  3.96e-02     4s
  28   1.09790492e+04  1.76804657e+04  3.59e-02 1.72e-03  2.99e-02     4s
  29   1.13203401e+04  1.67684582e+04  3.29e-02 1.37e-03  2.43e-02     4s
  30   1.22827981e+04  1.64709433e+04  2.46e-02 1.20e-03  1.87e-02     4s
  31   1.26654180e+04  1.62750508e+04  2.14e-02 1.04e-03  1.61e-02     4s
  32   1.33691911e+04  1.61528218e+04  1.53e-02 9.25e-04  1.24e-02     4s
  33   1.35718463e+04  1.59623432e+04  1.36e-02 7.34e-04  1.07e-02     4s
  34   1.40120910e+04  1.57458495e+04  9.65e-03 5.12e-04  7.73e-03     4s
  35   1.41753205e+04  1.55279603e+04  8.13e-03 3.27e-04  6.04e-03     5s
  36   1.43899279e+04  1.54403107e+04  6.33e-03 3.46e-04  4.69e-03     5s
  37   1.44903021e+04  1.53705494e+04  5.46e-03 2.61e-04  3.93e-03     5s
  38   1.46936262e+04  1.53308269e+04  3.81e-03 2.02e-04  2.84e-03     5s
  39   1.48643687e+04  1.53115366e+04  2.42e-03 1.80e-04  1.99e-03     5s
  40   1.49422762e+04  1.52569249e+04  1.77e-03 1.09e-04  1.40e-03     5s
  41   1.49583193e+04  1.52278895e+04  1.63e-03 7.44e-05  1.20e-03     5s
  42   1.49853536e+04  1.52236271e+04  1.42e-03 6.92e-05  1.06e-03     5s
  43   1.49986643e+04  1.52193954e+04  1.31e-03 6.45e-05  9.85e-04     5s
  44   1.50153897e+04  1.51989678e+04  1.18e-03 3.89e-05  8.20e-04     5s
  45   1.50834638e+04  1.51810298e+04  6.19e-04 1.91e-05  4.36e-04     5s
  46   1.51007611e+04  1.51754161e+04  4.83e-04 1.23e-05  3.33e-04     5s
  47   1.51181748e+04  1.51732164e+04  3.43e-04 1.00e-05  2.46e-04     5s
  48   1.51431236e+04  1.51686950e+04  1.54e-04 5.70e-06  1.14e-04     5s
  49   1.51541411e+04  1.51657060e+04  7.17e-05 1.61e-06  5.16e-05     5s
  50   1.51622877e+04  1.51642977e+04  1.26e-05 4.52e-07  8.98e-06     5s
  51   1.51640370e+04  1.51641633e+04  3.65e-07 1.84e-07  5.61e-07     5s
  52   1.51640861e+04  1.51641159e+04  1.13e-06 1.23e-09  1.33e-07     5s
  53   1.51641081e+04  1.51641159e+04  1.46e-06 1.59e-07  3.40e-08     5s
  54   1.51641147e+04  1.51641159e+04  2.28e-07 3.54e-08  5.22e-09     5s
  55   1.51641149e+04  1.51641159e+04  1.24e-06 1.78e-08  4.25e-09     5s
  56   1.51641153e+04  1.51641159e+04  6.57e-07 1.06e-08  2.26e-09     6s
  57   1.51641159e+04  1.51641159e+04  1.45e-09 1.49e-08  5.02e-12     6s

Barrier solved model in 57 iterations and 5.56 seconds (12.15 work units)
Optimal objective 1.51641159e+04


Root crossover log...

  101589 DPushes remaining with DInf 0.0000000e+00                 6s
       0 DPushes remaining with DInf 0.0000000e+00                 8s

    2968 PPushes remaining with PInf 7.9650936e-07                 8s
       0 PPushes remaining with PInf 0.0000000e+00                 8s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.8491493e-10      8s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   46456    1.5164116e+04   0.000000e+00   0.000000e+00      8s
   46456    1.5164116e+04   0.000000e+00   0.000000e+00      8s
Concurrent spin time: 1.06s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 1.516412e+04, 46456 iterations, 6.99 seconds (16.53 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 15164.1159    0  369 -172304.45 15164.1159   109%     -    9s
H    0     0                    -97638.51566 15164.1159   116%     -   10s
H    0     0                    -80253.11184 15164.1159   119%     -   10s
H    0     0                    -79296.15423 15164.1159   119%     -   10s
H    0     0                    -77027.81064 15164.1159   120%     -   10s
H    0     0                    -47156.12157 15164.1159   132%     -   10s
H    0     0                    -45983.10615 15164.1159   133%     -   10s
H    0     0                    -45818.23592 15164.1159   133%     -   10s
H    0     0                    -44599.92278 15164.1159   134%     -   12s
H    0     0                    -43549.62408 15164.1159   135%     -   12s
     0     0 8529.20004    0  399 -43549.624 8529.20004   120%     -   33s
     0     0 8335.82489    0  398 -43549.624 8335.82489   119%     -   45s
     0     0 8314.27511    0  397 -43549.624 8314.27511   119%     -   49s
     0     0 8252.88984    0  390 -43549.624 8252.88984   119%     -   53s
     0     0 8252.88984    0  392 -43549.624 8252.88984   119%     -   54s
     0     0 8231.18132    0  403 -43549.624 8231.18132   119%     -   58s
     0     0 8179.70890    0  397 -43549.624 8179.70890   119%     -   60s
     0     0 8178.88642    0  388 -43549.624 8178.88642   119%     -   62s
     0     0 8137.89102    0  404 -43549.624 8137.89102   119%     -   65s
     0     0 8083.93237    0  395 -43549.624 8083.93237   119%     -   71s
     0     0 8083.93237    0  393 -43549.624 8083.93237   119%     -   72s
     0     0 8082.93027    0  393 -43549.624 8082.93027   119%     -   73s
     0     0 8082.92503    0  393 -43549.624 8082.92503   119%     -   73s
H    0     0                    -41475.69309 6177.79709   115%     -  100s
H    0     0                    -40969.44919 6177.79709   115%     -  100s
     0     0 6177.79709    0  420 -40969.449 6177.79709   115%     -  100s
H    0     0                    -35950.83790 6177.24475   117%     -  101s
H    0     0                    -33538.05401 6177.24475   118%     -  101s
H    0     0                    -33198.14465 6177.24475   119%     -  101s
     0     0 5878.72389    0  412 -33198.145 5878.72389   118%     -  120s
     0     0 5713.10740    0  424 -33198.145 5713.10740   117%     -  140s
     0     0 5576.86354    0  423 -33198.145 5576.86354   117%     -  152s
     0     0 5543.57172    0  433 -33198.145 5543.57172   117%     -  159s
H    0     0                    -32216.48684 5414.00136   117%     -  169s
H    0     0                    -28215.28847 5414.00136   119%     -  169s
H    0     0                    -28090.14223 5414.00136   119%     -  169s
H    0     0                    -27532.64034 5414.00136   120%     -  169s
H    0     0                    -27524.05309 5414.00136   120%     -  169s
H    0     0                    -27342.05864 5414.00136   120%     -  169s
     0     0 5414.00136    0  438 -27342.059 5414.00136   120%     -  169s
H    0     0                    -17470.09360 5392.53611   131%     -  175s
H    0     0                    -15756.65915 5392.53611   134%     -  175s
H    0     0                    -15486.33738 5392.53611   135%     -  175s
     0     0 5392.53611    0  437 -15486.337 5392.53611   135%     -  175s
     0     0 5374.75108    0  442 -15486.337 5374.75108   135%     -  180s
     0     0 5370.10930    0  441 -15486.337 5370.10930   135%     -  183s
     0     0 5190.58192    0  439 -15486.337 5190.58192   134%     -  196s
     0     0 5172.45706    0  441 -15486.337 5172.45706   133%     -  200s
     0     0 5166.37463    0  451 -15486.337 5166.37463   133%     -  203s
     0     0 5148.15096    0  445 -15486.337 5148.15096   133%     -  209s
     0     0 5144.17548    0  442 -15486.337 5144.17548   133%     -  211s
     0     0 5142.06228    0  446 -15486.337 5142.06228   133%     -  211s
     0     0 5142.06228    0  446 -15486.337 5142.06228   133%     -  212s
     0     0 4298.59787    0  450 -15486.337 4298.59787   128%     -  237s
H    0     0                    -15486.31637 4063.30062   126%     -  248s
     0     0 4063.30062    0  445 -15486.316 4063.30062   126%     -  248s
H    0     0                    -14354.74688 3972.40531   128%     -  254s
H    0     0                    -14092.50858 3972.40531   128%     -  254s
H    0     0                    -14033.66976 3972.40531   128%     -  254s
H    0     0                    -13695.22941 3972.40531   129%     -  254s
     0     0 3972.40531    0  448 -13695.229 3972.40531   129%     -  254s
     0     0 3893.67436    0  460 -13695.229 3893.67436   128%     -  260s
     0     0 3865.85093    0  458 -13695.229 3865.85093   128%     -  263s
     0     0 3812.15577    0  457 -13695.229 3812.15577   128%     -  268s
     0     0 3797.91415    0  457 -13695.229 3797.91415   128%     -  270s
     0     0 3792.18356    0  457 -13695.229 3792.18356   128%     -  271s
     0     0 3784.74068    0  465 -13695.229 3784.74068   128%     -  273s
     0     0 3755.32942    0  462 -13695.229 3755.32942   127%     -  276s
     0     0 3746.67184    0  471 -13695.229 3746.67184   127%     -  277s
     0     0 3724.57355    0  453 -13695.229 3724.57355   127%     -  280s
     0     0 3717.36688    0  466 -13695.229 3717.36688   127%     -  284s
     0     0 3712.28333    0  457 -13695.229 3712.28333   127%     -  286s
     0     0 3710.23560    0  469 -13695.229 3710.23560   127%     -  287s
     0     0 3696.94597    0  469 -13695.229 3696.94597   127%     -  289s
     0     0 3688.12704    0  460 -13695.229 3688.12704   127%     -  292s
     0     0 3686.70631    0  471 -13695.229 3686.70631   127%     -  293s
H    0     0                    -13372.26200 3686.70631   128%     -  298s
H    0     0                    -12242.56035 3686.70631   130%     -  298s
H    0     0                    -12131.29482 3686.70631   130%     -  298s
H    0     0                    -12098.03434 3686.70631   130%     -  298s
     0     0 3271.12560    0  491 -12098.034 3271.12560   127%     -  316s
H    0     0                    -12081.65919 3271.07457   127%     -  317s
H    0     0                    -12069.41943 3114.05479   126%     -  327s
H    0     0                    -12045.20237 3114.05479   126%     -  327s
H    0     0                    -12029.72078 3114.05479   126%     -  327s
H    0     0                    -11972.37890 3114.05479   126%     -  327s
     0     0 3114.05479    0  571 -11972.379 3114.05479   126%     -  327s
     0     0 2996.60985    0  491 -11972.379 2996.60985   125%     -  335s
H    0     0                    -10476.68380 2928.17316   128%     -  341s
H    0     0                    -10458.81216 2928.17316   128%     -  341s
H    0     0                    -10424.52121 2928.17316   128%     -  341s
     0     0 2928.17316    0  504 -10424.521 2928.17316   128%     -  341s
     0     0 2901.66426    0  495 -10424.521 2901.66426   128%     -  347s
     0     0 2882.51982    0  490 -10424.521 2882.51982   128%     -  351s
     0     0 2876.29794    0  496 -10424.521 2876.29794   128%     -  352s
     0     0 2869.34476    0  658 -10424.521 2869.34476   128%     -  355s
     0     0 2869.03490    0  657 -10424.521 2869.03490   128%     -  356s
     0     0 2747.25363    0  500 -10424.521 2747.25363   126%     -  371s
H    0     0                    -10266.69982 2747.09331   127%     -  372s
     0     0 2670.07921    0  577 -10266.700 2670.07921   126%     -  379s
     0     0 2643.15603    0  570 -10266.700 2643.15603   126%     -  383s
     0     0 2635.06237    0  581 -10266.700 2635.06237   126%     -  386s
     0     0 2628.89073    0  578 -10266.700 2628.89073   126%     -  390s
     0     0 2623.12290    0  497 -10266.700 2623.12290   126%     -  392s
     0     0 2619.65455    0  444 -10266.700 2619.65455   126%     -  395s
     0     0 2616.25620    0  440 -10266.700 2616.25620   125%     -  397s
     0     0 2611.98374    0  446 -10266.700 2611.98374   125%     -  398s
     0     0 2611.75337    0  510 -10266.700 2611.75337   125%     -  399s
     0     0 2359.70098    0  569 -10266.700 2359.70098   123%     -  414s
H    0     0                    -10181.90430 2359.24625   123%     -  428s
H    0     0                    -9894.206681 2359.24625   124%     -  428s
H    0     0                    -9510.639441 2359.24625   125%     -  430s
H    0     0                    -8368.373598 2359.24625   128%     -  430s
     0     0 2295.07301    0  595 -8368.3736 2295.07301   127%     -  441s
     0     0 2265.25833    0  590 -8368.3736 2265.25833   127%     -  449s
     0     0 2256.74432    0  609 -8368.3736 2256.74432   127%     -  453s
     0     0 2250.23541    0  599 -8368.3736 2250.23541   127%     -  455s
     0     0 2213.27700    0  524 -8368.3736 2213.27700   126%     -  462s
H    0     0                    -8367.505020 2203.27363   126%     -  466s
     0     0 2203.27363    0  531 -8367.5050 2203.27363   126%     -  466s
     0     0 2197.11780    0  536 -8367.5050 2197.11780   126%     -  469s
     0     0 2196.31078    0  539 -8367.5050 2196.31078   126%     -  470s
H    0     0                    -8178.657869 2062.52673   125%     -  483s
H    0     0                    -7985.899997 2062.52673   126%     -  483s
H    0     0                    -7968.438920 2062.52673   126%     -  483s
     0     0 2062.52673    0  540 -7968.4389 2062.52673   126%     -  483s
     0     0 2024.67672    0  608 -7968.4389 2024.67672   125%     -  491s
     0     0 1991.57162    0  544 -7968.4389 1991.57162   125%     -  496s
     0     0 1966.09462    0  473 -7968.4389 1966.09462   125%     -  500s
     0     0 1958.12710    0  620 -7968.4389 1958.12710   125%     -  503s
     0     0 1956.89709    0  635 -7968.4389 1956.89709   125%     -  505s
     0     0 1921.40168    0  612 -7968.4389 1921.40168   124%     -  513s
     0     0 1913.86514    0  555 -7968.4389 1913.86514   124%     -  517s
     0     0 1910.93407    0  554 -7968.4389 1910.93407   124%     -  519s
     0     0 1910.03866    0  555 -7968.4389 1910.03866   124%     -  520s
     0     0 1890.33887    0  544 -7968.4389 1890.33887   124%     -  525s
     0     0 1886.06203    0  549 -7968.4389 1886.06203   124%     -  528s
     0     0 1883.47082    0  556 -7968.4389 1883.47082   124%     -  531s
     0     0 1881.34720    0  553 -7968.4389 1881.34720   124%     -  533s
     0     0 1880.80102    0  561 -7968.4389 1880.80102   124%     -  534s
     0     0 1862.72479    0  551 -7968.4389 1862.72479   123%     -  540s
H    0     0                    -7954.016157 1862.19642   123%     -  541s
     0     0 1856.15977    0  557 -7954.0162 1856.15977   123%     -  544s
     0     0 1855.10672    0  556 -7954.0162 1855.10672   123%     -  546s
     0     0 1839.05380    0  561 -7954.0162 1839.05380   123%     -  551s
     0     0 1832.64415    0  550 -7954.0162 1832.64415   123%     -  555s
     0     0 1831.37455    0  554 -7954.0162 1831.37455   123%     -  556s
     0     0 1811.13012    0  556 -7954.0162 1811.13012   123%     -  562s
H    0     0                    -7498.669705 1810.62220   124%     -  574s
H    0     0                    -7459.035821 1810.62220   124%     -  574s
H    0     0                    -7407.294643 1810.62220   124%     -  574s
     0     0 1808.21818    0  556 -7407.2946 1808.21818   124%     -  576s
     0     0 1806.29257    0  559 -7407.2946 1806.29257   124%     -  577s
     0     0 1805.97121    0  630 -7407.2946 1805.97121   124%     -  578s
     0     0 1792.72334    0  561 -7407.2946 1792.72334   124%     -  583s
     0     0 1781.03641    0  552 -7407.2946 1781.03641   124%     -  587s
     0     0 1778.07705    0  568 -7407.2946 1778.07705   124%     -  588s
     0     0 1776.84828    0  561 -7407.2946 1776.84828   124%     -  589s
     0     0 1767.65601    0  629 -7407.2946 1767.65601   124%     -  594s
     0     0 1764.51459    0  565 -7407.2946 1764.51459   124%     -  595s
     0     0 1763.89707    0  571 -7407.2946 1763.89707   124%     -  596s
     0     0 1747.60877    0  474 -7407.2946 1747.60877   124%     -  601s
     0     0 1745.38314    0  577 -7407.2946 1745.38314   124%     -  604s
     0     0 1744.40576    0  572 -7407.2946 1744.40576   124%     -  604s
     0     0 1740.83429    0  567 -7407.2946 1740.83429   124%     -  608s
     0     0 1740.19814    0  571 -7407.2946 1740.19814   123%     -  609s
     0     0 1713.22085    0  630 -7407.2946 1713.22085   123%     -  616s
     0     0 1707.95235    0  700 -7407.2946 1707.95235   123%     -  621s
     0     0 1701.66181    0  695 -7407.2946 1701.66181   123%     -  624s
     0     0 1698.77185    0  639 -7407.2946 1698.77185   123%     -  627s
     0     0 1696.48949    0  635 -7407.2946 1696.48949   123%     -  630s
     0     0 1693.79228    0  630 -7407.2946 1693.79228   123%     -  632s
     0     0 1691.05629    0  640 -7407.2946 1691.05629   123%     -  634s
     0     0 1689.74478    0  642 -7407.2946 1689.74478   123%     -  635s
     0     0 1647.19500    0  631 -7407.2946 1647.19500   122%     -  645s
     0     0 1641.69811    0  625 -7407.2946 1641.69811   122%     -  649s
     0     0 1638.13224    0  639 -7407.2946 1638.13224   122%     -  651s
     0     0 1634.98967    0  646 -7407.2946 1634.98967   122%     -  656s
     0     0 1634.13962    0  639 -7407.2946 1634.13962   122%     -  658s
     0     0 1623.66694    0  562 -7407.2946 1623.66694   122%     -  664s
     0     0 1621.97490    0  554 -7407.2946 1621.97490   122%     -  667s
     0     0 1595.93348    0  626 -7407.2946 1595.93348   122%     -  676s
     0     0 1593.04304    0  575 -7407.2946 1593.04304   122%     -  679s
     0     0 1591.62318    0  680 -7407.2946 1591.62318   121%     -  682s
     0     0 1569.19556    0  685 -7407.2946 1569.19556   121%     -  688s
     0     0 1567.38089    0  579 -7407.2946 1567.38089   121%     -  691s
     0     0 1561.49175    0  578 -7407.2946 1561.49175   121%     -  695s
     0     0 1560.08486    0  583 -7407.2946 1560.08486   121%     -  698s
     0     0 1555.19194    0  587 -7407.2946 1555.19194   121%     -  704s
     0     0 1553.06128    0  587 -7407.2946 1553.06128   121%     -  708s
     0     0 1552.44447    0  580 -7407.2946 1552.44447   121%     -  709s
     0     0 1548.66216    0  581 -7407.2946 1548.66216   121%     -  713s
     0     0 1548.62204    0  581 -7407.2946 1548.62204   121%     -  718s
H    0     0                    -7380.358257 1548.58181   121%     -  836s
H    0     0                    -7309.115762 1548.58181   121%     -  858s
     0     2 1548.58181    0  581 -7309.1158 1548.58181   121%     -  934s
     1     3 1455.13880    1  513 -7309.1158 1548.58181   121%  9727  942s
     2     4 1526.85785    1  572 -7309.1158 1526.85785   121%  5667  948s
     3     7 1089.73572    2  447 -7309.1158 1526.57221   121%  4759  956s
     6    13 1005.93310    3  450 -7309.1158 1525.48505   121%  6015  970s
    12    26 -692.90620    4  397 -7309.1158 1494.68995   120%  9757  984s
    25    35 1029.87511    5  630 -7309.1158 1223.12384   117% 12397 1017s
    38    58 -2469.4257    6  378 -7309.1158 1223.12384   117% 11622 1106s
    65   142 -2489.3865    7  471 -7309.1158 1223.12384   117% 15358 1160s
H  151   179                    -7303.424870 1223.12384   117% 11266 1182s
   188   238 -2775.4059   15  462 -7303.4249 1223.12384   117% 10820 1211s
   254   266 -116.14511   10  463 -7303.4249 1223.12384   117%  9715 1230s
   282   315 -3075.2741   16  335 -7303.4249 1223.12384   117%  9558 1252s
   333   370 -5512.9088   17  260 -7303.4249 1223.12384   117%  9137 1272s
   396   420 -5789.0909   18  250 -7303.4249 1223.12384   117%  8806 1293s
H  463   420                    -6995.019241 1223.12384   117%  8288 1293s
   475   444 -5954.2499   20  192 -6995.0192 1223.12384   117%  8292 1317s
   540   496 -5978.8654   22  190 -6995.0192 1223.12384   117%  7982 1334s
   618   545     cutoff   25      -6995.0192 1223.12384   117%  7797 1351s
   711   571 infeasible   25      -6995.0192 1223.12384   117%  7423 1367s
   787   600 infeasible   25      -6995.0192 1223.12384   117%  7259 1386s
   855   636 infeasible   13      -6995.0192 1223.12384   117%  7242 1403s
   936   674 infeasible   18      -6995.0192 1223.12384   117%  7111 1420s
  1018   686 infeasible   21      -6995.0192 1223.12384   117%  7012 1435s
H 1027   686                    -6802.581812 1223.12384   118%  7002 1435s
H 1060   686                    -6582.010843 1223.12384   119%  6996 1435s
  1062   695 -4053.5179   17  289 -6582.0108 1223.12384   119%  7012 1453s
H 1065   695                    -6371.200786 1223.12384   119%  7008 1453s
  1117   722 -4114.2050   18  286 -6371.2008 1223.12384   119%  6922 1473s
  1208   735     cutoff   19      -6371.2008 1223.12384   119%  6796 1492s
H 1213   735                    -6278.669222 1223.12384   119%  6780 1492s
H 1218   735                    -6206.744678 1223.12384   120%  6767 1492s
  1249   776     cutoff   17      -6206.7447 1223.12384   120%  6838 1514s
  1338   801 -5300.4123   27  366 -6206.7447 1223.12384   120%  6801 1534s
  1434   853 -5489.9055   29  289 -6206.7447 1223.12384   120%  6757 1555s
  1527   874 -5929.6102   36  174 -6206.7447 1223.12384   120%  6774 1573s
H 1560   908                    -6162.367017 1223.12384   120%  6796 1590s
H 1570   908                    -6157.011504 1223.12384   120%  6786 1590s
H 1572   908                    -6153.157547 1223.12384   120%  6779 1590s
H 1574   908                    -6116.596170 1223.12384   120%  6780 1590s
  1614   967 -5951.8324   38  183 -6116.5962 1223.12384   120%  6760 1612s
  1735  1024 -1299.7291    8  287 -6116.5962 1223.12384   120%  6705 1635s
  1848  1041 -2323.0991    9  217 -6116.5962 1223.12384   120%  6675 1658s
H 1856  1041                    -6099.154264 1223.12384   120%  6683 1658s
  1889  1087 -3026.7317   10  230 -6099.1543 1223.12384   120%  6742 1683s
  1995  1134 infeasible   11      -6099.1543 1110.07113   118%  6733 1722s
  2092  1202 -1403.4751    9  286 -6099.1543 1110.07113   118%  6720 1748s
  2201  1262 -1969.4198   12  247 -6099.1543 1110.07113   118%  6737 1776s
  2326  1299 -2727.2441   16  247 -6099.1543 1110.07113   118%  6737 1808s
  2477  1331 -4226.4521   18  216 -6099.1543 1110.07113   118%  6710 1842s
  2581  1380 -1007.5608   11  349 -6099.1543  807.52724   113%  6794 1878s
  2670  1416 -1302.7084   10  625 -6099.1543  807.52724   113%  6927 1912s
  2760  1446 -2635.0789   13  331 -6099.1543  807.52724   113%  7005 1947s
  2855  1489 infeasible   15      -6099.1543  807.52724   113%  7150 1985s
  2954  1509 -5971.7725   16  367 -6099.1543  631.01885   110%  7286 2020s
H 2990  1509                    -6029.228647  631.01885   110%  7370 2020s
  2994  1547 infeasible   17      -6029.2286  631.01885   110%  7372 2074s
  3070  1581 infeasible   17      -6029.2286 -405.06643  93.3%  7383 2114s
  3184  1627 -5855.0263   17  129 -6029.2286 -527.41241  91.3%  7485 2159s
  3322  1662 -2423.5397    9  467 -6029.2286 -575.69598  90.5%  7564 2206s
  3466  1718 -3879.4169   11  437 -6029.2286 -575.69598  90.5%  7626 2257s
  3590  1751 -4119.2878   13  443 -6029.2286 -575.69598  90.5%  7752 2307s
  3735  1765 -4420.5619   16  414 -6029.2286 -575.69598  90.5%  7787 2354s
  3913  1754 -5068.5472   19  405 -6029.2286 -575.69598  90.5%  7834 2392s
  3962  1794 -5178.5579   20  416 -6029.2286 -575.69598  90.5%  7873 2436s
  4052  1865 -5384.4356   21  451 -6029.2286 -575.69598  90.5%  7909 2488s
  4225  1917 -5617.5763   25  449 -6029.2286 -748.08907  87.6%  7924 2545s
  4436  1973 infeasible   28      -6029.2286 -1018.2246  83.1%  7939 2602s
  4616  2027 -3601.2696   10  502 -6029.2286 -1021.9363  83.1%  8005 2666s
  4848  2073 -5753.8702   13  433 -6029.2286 -1021.9363  83.1%  8014 2733s
  5052  2151     cutoff   11      -6029.2286 -1204.9033  80.0%  8095 2798s
  5296  2193 -3398.6980   10  293 -6029.2286 -1204.9033  80.0%  8111 2859s
  5384  2252 -3556.5346   11  294 -6029.2286 -1349.4940  77.6%  8133 2934s
  5577  2340 -5833.1133   17  358 -6029.2286 -1349.4940  77.6%  8197 3013s
  5792  2341 -4068.1777   15  581 -6029.2286 -1421.6809  76.4%  8259 3212s
  5794  2342 -4594.9590   13  383 -6029.2286 -1421.6809  76.4%  8256 3228s
  5795  2343 -4230.5375   20  493 -6029.2286 -1421.6809  76.4%  8254 3305s
  5796  2344 -4604.7923   12  552 -6029.2286 -1421.6809  76.4%  8253 3350s
  5797  2344 -4419.4507   26  524 -6029.2286 -1421.6809  76.4%  8251 3376s
  5798  2345 -3559.7820   14  531 -6029.2286 -1421.6809  76.4%  8250 3399s
  5799  2346 -4709.8741   24  615 -6029.2286 -1421.6809  76.4%  8249 3422s
  5800  2346 -4897.6902   18  539 -6029.2286 -1421.6809  76.4%  8247 3438s
  5801  2347 -4041.2093   19  545 -6029.2286 -1421.6809  76.4%  8246 3454s
  5802  2348 -3152.5629   19  558 -6029.2286 -1421.6809  76.4%  8244 3467s
  5803  2348 -3899.9820   16  546 -6029.2286 -1421.6809  76.4%  8243 3474s
  5804  2349 -2068.5581   12  626 -6029.2286 -1421.6809  76.4%  8241 3483s
  5805  2350 -1589.0579   10  643 -6029.2286 -1421.6809  76.4%  8240 3491s
  5806  2350 -4305.0745    9  526 -6029.2286 -1421.6809  76.4%  8239 3506s
  5807  2351 -5974.1050   49  649 -6029.2286 -1421.6809  76.4%  8237 3516s
  5808  2352 -5209.1338   30  574 -6029.2286 -1421.6809  76.4%  8236 3525s
  5809  2352 -2957.7959   12  531 -6029.2286 -1421.6809  76.4%  8234 3537s
  5810  2353 -1788.2864   12  586 -6029.2286 -1421.6809  76.4%  8233 3542s
  5811  2354 -5613.6735   26  589 -6029.2286 -1421.6809  76.4%  8232 3549s
  5812  2354 -5326.1058   42  605 -6029.2286 -1421.6809  76.4%  8230 3563s
  5813  2355 -3898.9118   19  595 -6029.2286 -1421.6809  76.4%  8229 3571s
  5814  2356 -2195.4676   13  603 -6029.2286 -1421.6809  76.4%  8227 3580s
  5815  2356 -3907.5022   20  534 -6029.2286 -1421.6809  76.4%  8226 3595s

Cutting planes:
  Learned: 1
  Gomory: 3
  Implied bound: 6
  Projected implied bound: 189
  MIR: 1161
  Mixing: 1
  Flow cover: 1281
  Zero half: 6
  RLT: 32
  Relax-and-lift: 106

Explored 5816 nodes (49051854 simplex iterations) in 3600.03 seconds (9265.53 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -6029.23 -6099.15 -6116.6 ... -6582.01

Time limit reached
Best objective -6.029228646641e+03, best bound -1.421680896563e+03, gap 76.4202%
  WARNING: Time limit reached. Using best solution found (gap: 76.42%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3600.10s
  Master Objective (UB) = -6029.23, θ = 110050.68
  Upper Bound (UB) = -6029.23

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 110050.68
  [DEBUG]   ✓ Scenario 0: θ = 110050.68 ≤ Q = 110050.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 110050.68 ≤ Q = 110050.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 110050.68 ≤ Q = 110050.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 110050.68 ≤ Q = 110050.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 110050.68 ≤ Q = 110050.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 110050.68 ≤ Q = 110050.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 110050.68 ≤ Q = 110050.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 110050.68 ≤ Q = 110050.68 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 110050.68 ≤ Q = 110050.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 110050.68 ≤ Q = 110050.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 110050.68 ≤ Q = 110050.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 110050.68 ≤ Q = 110050.68 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 110050.68 ≤ Q = 110050.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 110050.68 ≤ Q = 110050.68 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 110050.68 ≤ Q = 111182.58 (slack: 1131.90)
  [DEBUG] All optimality cuts satisfied.
[Iteration 15] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x3f0b8729
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x3f0b8729
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.183916e+13
Presolve removed 2608 rows and 1900 columns
Presolve time: 0.00s
Presolved: 485 rows, 489 columns, 1368 nonzeros
Found heuristic solution: objective 6049184.5349
Variable types: 330 continuous, 159 integer (159 binary)

Root relaxation: objective -1.189742e+05, 229 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -118974.19    0  120 6049184.53 -118974.19   102%     -    0s
H    0     0                    -76100.80672 -118974.19  56.3%     -    0s
H    0     0                    -76297.18355 -118974.19  55.9%     -    0s
H    0     0                    -78052.94037 -118830.05  52.2%     -    0s
H    0     0                    -78428.83092 -118830.05  51.5%     -    0s
     0     0 -95177.727    0   42 -78428.831 -95177.727  21.4%     -    0s
H    0     0                    -93745.61449 -95173.555  1.52%     -    0s
H    0     0                    -94007.66442 -95173.555  1.24%     -    0s
     0     0 -94824.098    0   38 -94007.664 -94824.098  0.87%     -    0s
H    0     0                    -94026.25360 -94805.227  0.83%     -    0s
     0     0 -94520.942    0   24 -94026.254 -94520.942  0.53%     -    0s
     0     0 -94520.727    0   24 -94026.254 -94520.727  0.53%     -    0s
     0     0 -94245.133    0   14 -94026.254 -94245.133  0.23%     -    0s
     0     0 -94161.602    0   18 -94026.254 -94161.602  0.14%     -    0s
     0     0 -94035.737    0    4 -94026.254 -94035.737  0.01%     -    0s
     0     0          -    0      -94026.254 -94032.515  0.01%     -    0s

Explored 1 nodes (534 simplex iterations) in 0.07 seconds (0.03 work units)
Thread count was 32 (of 256 available processors)

Solution count 9: -94026.3 -94007.7 -93936.4 ... 1.18392e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -9.402625360078e+04, best bound -9.403251546286e+04, gap 0.0067%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 104831.42
  Scenario: 19 demand increases, 41 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -94026.25
  [DEBUG]   S×d_nominal = 198857.67
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 198857.67 + -94026.25 = 104831.42
  [DEBUG]   Current θ from Master = 110050.68
  [DEBUG]   ⚠️  Z_SP ≤ θ by 5219.26 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -11248.49
  Lower Bound (LB) = -8863.81
  Gap (UB-LB) = 2834.5776, Absolute Gap = 2834.5776, Relative Gap = 0.470139
  Not converged yet (gap = 2834.58 > ε = 200)

  [DEBUG] Adding NEW scenario 15 to Master Problem...
  [DEBUG] New scenario pattern: 19 increases, 41 decreases
    [DEBUG] Scenario 15 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 15 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 15]
    [DEBUG]   - Total constraints in model: 246023
    [DEBUG]   - Total variables in model: 102100
  [DEBUG] Total scenarios in Master: 16
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 16
================================================================================
[Iteration 16] Solving Master Problem...
  Current scenarios in Master: 16
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 246023 rows, 102100 columns and 697215 nonzeros
Model fingerprint: 0x0f3c6bf3
Variable types: 99841 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [9e-02, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 113420 rows and 46070 columns
Presolve time: 1.90s
Presolved: 132603 rows, 56030 columns, 818212 nonzeros
Variable types: 53771 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -371500.8959
Found heuristic solution: objective -172304.4497

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.08s

Barrier statistics:
 Dense cols : 635
 AA' NZ     : 6.457e+06
 Factor NZ  : 1.412e+07 (roughly 200 MB of memory)
 Factor Ops : 3.085e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.67421064e+07  2.07648598e+08  8.72e+04 2.27e+01  6.70e+04     4s
   1  -1.24404992e+07  1.80575155e+08  6.04e+04 4.82e+01  4.64e+04     4s
   2  -5.17251656e+06  1.45764969e+08  2.59e+04 1.51e+01  2.03e+04     4s
   3  -1.46083616e+06  1.45047914e+08  5.16e+03 2.59e+01  4.54e+03     4s
   4  -6.84185872e+05  8.98646770e+07  1.10e+03 5.95e+00  1.16e+03     4s
   5  -5.08960878e+05  4.51179466e+07  4.41e+02 1.84e+00  4.70e+02     4s
   6  -4.39350177e+05  3.29746018e+07  2.48e+02 7.35e-01  2.87e+02     4s
   7  -3.43918139e+05  2.41165559e+07  8.16e+01 1.54e-02  1.47e+02     4s
   8  -2.09941532e+05  1.55372190e+07  1.91e+01 8.88e-03  7.39e+01     5s
   9  -1.57280986e+05  1.16755714e+07  1.14e+01 6.49e-03  5.32e+01     5s
  10  -1.31027791e+05  6.12419100e+06  7.73e+00 3.21e-03  2.76e+01     5s
  11  -1.05819790e+05  3.66055558e+06  3.72e+00 1.83e-03  1.61e+01     5s
  12  -9.30023725e+04  2.39760693e+06  2.46e+00 1.20e-03  1.06e+01     5s
  13  -7.16682776e+04  1.30764809e+06  1.05e+00 1.29e-02  5.77e+00     5s
  14  -5.19106993e+04  4.93035833e+05  5.18e-01 2.56e-04  2.27e+00     5s
  15  -3.56882065e+04  2.25416930e+05  3.01e-01 1.87e-04  1.08e+00     5s
  16  -2.63015201e+04  1.48059415e+05  2.32e-01 1.86e-04  7.24e-01     5s
  17  -2.50803731e+04  1.30107491e+05  2.24e-01 2.06e-04  6.44e-01     5s
  18  -1.65247702e+04  8.74417532e+04  1.70e-01 2.78e-04  4.32e-01     5s
  19  -1.31065206e+04  6.96882688e+04  1.49e-01 1.78e-04  3.44e-01     5s
  20  -7.71766001e+03  5.39441133e+04  1.17e-01 3.84e-04  2.56e-01     5s
  21  -3.90441929e+03  4.26194367e+04  9.44e-02 8.32e-04  1.93e-01     5s
  22  -1.40718330e+03  3.75374512e+04  7.96e-02 4.88e-04  1.62e-01     5s
  23   1.23762058e+03  3.14211647e+04  6.50e-02 5.33e-04  1.25e-01     5s
  24   3.95388464e+03  2.62402332e+04  5.05e-02 6.19e-04  9.26e-02     5s
  25   4.70823580e+03  2.34872798e+04  4.69e-02 6.47e-04  7.80e-02     5s
  26   6.36112781e+03  2.20012396e+04  3.91e-02 6.06e-04  6.50e-02     5s
  27   7.86689253e+03  2.00165752e+04  3.22e-02 9.58e-04  5.05e-02     5s
  28   8.76811564e+03  1.86491358e+04  2.80e-02 1.11e-03  4.11e-02     5s
  29   1.01609101e+04  1.77827141e+04  2.19e-02 1.05e-03  3.17e-02     5s
  30   1.05197041e+04  1.71910365e+04  2.03e-02 6.06e-04  2.78e-02     5s
  31   1.19397300e+04  1.68164162e+04  1.40e-02 6.03e-04  2.03e-02     6s
  32   1.25080050e+04  1.64999214e+04  1.15e-02 5.33e-04  1.66e-02     6s
  33   1.29437798e+04  1.62901691e+04  9.59e-03 4.46e-04  1.39e-02     6s
  34   1.31222575e+04  1.61383647e+04  8.77e-03 3.82e-04  1.25e-02     6s
  35   1.36993190e+04  1.58280426e+04  6.15e-03 2.59e-04  8.85e-03     6s
  36   1.38065850e+04  1.57527119e+04  5.66e-03 2.40e-04  8.09e-03     6s
  37   1.39924586e+04  1.56587337e+04  4.82e-03 1.99e-04  6.93e-03     6s
  38   1.42633855e+04  1.54730083e+04  3.61e-03 1.26e-04  5.03e-03     6s
  39   1.45339143e+04  1.54278560e+04  2.46e-03 1.10e-04  3.72e-03     6s
  40   1.47094779e+04  1.52942038e+04  1.71e-03 5.53e-05  2.43e-03     6s
  41   1.48522066e+04  1.52378021e+04  1.11e-03 3.50e-05  1.60e-03     6s
  42   1.49094161e+04  1.52292101e+04  8.77e-04 3.21e-05  1.33e-03     6s
  43   1.49585182e+04  1.51952833e+04  6.84e-04 2.05e-05  9.84e-04     6s
  44   1.50137282e+04  1.51718602e+04  4.72e-04 1.30e-05  6.58e-04     6s
  45   1.50430521e+04  1.51546096e+04  3.53e-04 7.28e-06  4.64e-04     6s
  46   1.50696328e+04  1.51479293e+04  2.44e-04 4.97e-06  3.26e-04     6s
  47   1.50758438e+04  1.51359793e+04  2.20e-04 6.14e-07  2.50e-04     6s
  48   1.50959383e+04  1.51350612e+04  1.38e-04 4.65e-07  1.63e-04     6s
  49   1.51067242e+04  1.51349145e+04  9.73e-05 4.36e-07  1.17e-04     7s
  50   1.51215537e+04  1.51339354e+04  3.88e-05 2.71e-07  5.15e-05     7s
  51   1.51321415e+04  1.51323632e+04  4.50e-07 6.64e-07  9.21e-07     7s
  52   1.51321705e+04  1.51323514e+04  1.61e-06 5.28e-07  7.51e-07     7s
  53   1.51322969e+04  1.51323113e+04  1.32e-07 3.50e-08  5.97e-08     7s
  54   1.51323071e+04  1.51323087e+04  1.47e-07 1.09e-07  6.41e-09     7s
  55   1.51323086e+04  1.51323086e+04  7.42e-08 1.71e-08  1.18e-10     7s

Barrier solved model in 55 iterations and 6.84 seconds (14.01 work units)
Optimal objective 1.51323086e+04


Root crossover log...

  108267 DPushes remaining with DInf 0.0000000e+00                 7s
    1400 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                10s

    4423 PPushes remaining with PInf 2.8763134e-05                10s
       0 PPushes remaining with PInf 0.0000000e+00                11s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.9657854e+01     11s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   51221    1.5132309e+04   0.000000e+00   1.965785e+01     11s
   51232    1.5132309e+04   0.000000e+00   0.000000e+00     11s
   51232    1.5132309e+04   0.000000e+00   0.000000e+00     11s
Concurrent spin time: 2.57s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 1.513231e+04, 51232 iterations, 10.74 seconds (22.77 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 15132.3087    0  368 -172304.45 15132.3087   109%     -   13s
H    0     0                    -167714.5927 15132.3087   109%     -   13s
H    0     0                    -97461.06953 15132.3087   116%     -   14s
H    0     0                    -80608.48366 15132.3087   119%     -   14s
H    0     0                    -80288.40094 15132.3087   119%     -   14s
H    0     0                    -79593.10421 15132.3087   119%     -   14s
H    0     0                    -79566.28987 15132.3087   119%     -   14s
H    0     0                    -79423.31610 15132.3087   119%     -   14s
H    0     0                    -79176.48329 15132.3087   119%     -   14s
H    0     0                    -45840.06691 15132.3087   133%     -   14s
H    0     0                    -44498.42945 15132.3087   134%     -   14s
     0     0 8382.84161    0  378 -44498.429 8382.84161   119%     -   40s
H    0     0                    -34465.56324 8380.05075   124%     -   41s
H    0     0                    -32473.63705 8380.05075   126%     -   41s
     0     0 8257.45375    0  385 -32473.637 8257.45375   125%     -   46s
     0     0 8239.63675    0  382 -32473.637 8239.63675   125%     -   50s
     0     0 8233.70461    0  386 -32473.637 8233.70461   125%     -   53s
     0     0 8220.16893    0  384 -32473.637 8220.16893   125%     -   56s
     0     0 8141.14818    0  392 -32473.637 8141.14818   125%     -   61s
     0     0 8021.69638    0  391 -32473.637 8021.69638   125%     -   67s
     0     0 8019.31518    0  390 -32473.637 8019.31518   125%     -   69s
     0     0 8006.74447    0  389 -32473.637 8006.74447   125%     -   70s
     0     0 7959.26773    0  394 -32473.637 7959.26773   125%     -   73s
     0     0 7959.16136    0  394 -32473.637 7959.16136   125%     -   74s
     0     0 6366.66026    0  365 -32473.637 6366.66026   120%     -  101s
H    0     0                    -26752.10703 6366.49378   124%     -  102s
H    0     0                    -25852.33427 6366.49378   125%     -  102s
H    0     0                    -25612.06779 6366.49378   125%     -  102s
     0     0 5910.32049    0  431 -25612.068 5910.32049   123%     -  120s
     0     0 5699.00629    0  448 -25612.068 5699.00629   122%     -  133s
     0     0 5600.99981    0  457 -25612.068 5600.99981   122%     -  144s
     0     0 5569.33485    0  452 -25612.068 5569.33485   122%     -  151s
     0     0 5549.70299    0  452 -25612.068 5549.70299   122%     -  156s
     0     0 5521.52537    0  449 -25612.068 5521.52537   122%     -  162s
     0     0 5507.00930    0  447 -25612.068 5507.00930   122%     -  166s
     0     0 5496.70141    0  454 -25612.068 5496.70141   121%     -  169s
     0     0 5440.12498    0  435 -25612.068 5440.12498   121%     -  174s
     0     0 5404.28426    0  449 -25612.068 5404.28426   121%     -  181s
     0     0 5395.46134    0  448 -25612.068 5395.46134   121%     -  184s
     0     0 5394.24252    0  446 -25612.068 5394.24252   121%     -  185s
     0     0 5393.21183    0  446 -25612.068 5393.21183   121%     -  186s
     0     0 4454.45499    0  545 -25612.068 4454.45499   117%     -  224s
H    0     0                    -24607.00743 4454.11867   118%     -  224s
H    0     0                    -24556.74761 4454.11867   118%     -  224s
H    0     0                    -24539.28654 4454.11867   118%     -  224s
     0     0 3932.98031    0  572 -24539.287 3932.98031   116%     -  250s
     0     0 3849.53991    0  572 -24539.287 3849.53991   116%     -  260s
     0     0 3824.11912    0  578 -24539.287 3824.11912   116%     -  271s
     0     0 3794.91551    0  586 -24539.287 3794.91551   115%     -  280s
     0     0 3785.74477    0  577 -24539.287 3785.74477   115%     -  283s
     0     0 3780.64222    0  578 -24539.287 3780.64222   115%     -  286s
     0     0 3775.03020    0  584 -24539.287 3775.03020   115%     -  287s
     0     0 3773.11725    0  584 -24539.287 3773.11725   115%     -  289s
     0     0 3768.66358    0  585 -24539.287 3768.66358   115%     -  292s
     0     0 3766.04574    0  662 -24539.287 3766.04574   115%     -  296s
     0     0 3762.51645    0  659 -24539.287 3762.51645   115%     -  299s
     0     0 3730.51115    0  637 -24539.287 3730.51115   115%     -  306s
     0     0 3723.82463    0  647 -24539.287 3723.82463   115%     -  310s
     0     0 3721.46560    0  652 -24539.287 3721.46560   115%     -  312s
     0     0 3720.04854    0  643 -24539.287 3720.04854   115%     -  313s
     0     0 3695.99718    0  657 -24539.287 3695.99718   115%     -  318s
     0     0 3695.81648    0  656 -24539.287 3695.81648   115%     -  319s
     0     0 3337.80325    0  563 -24539.287 3337.80325   114%     -  352s
H    0     0                    -24533.59565 3337.32376   114%     -  352s
     0     0 3211.41345    0  583 -24533.596 3211.41345   113%     -  371s
     0     0 3162.98702    0  520 -24533.596 3162.98702   113%     -  381s
     0     0 3143.54815    0  513 -24533.596 3143.54815   113%     -  387s
     0     0 3122.58450    0  513 -24533.596 3122.58450   113%     -  393s
     0     0 3117.81466    0  517 -24533.596 3117.81466   113%     -  396s
     0     0 3054.96716    0  520 -24533.596 3054.96716   112%     -  403s
     0     0 3053.62224    0  519 -24533.596 3053.62224   112%     -  406s
     0     0 2905.28261    0  523 -24533.596 2905.28261   112%     -  422s
H    0     0                    -24503.79324 2905.16176   112%     -  422s
H    0     0                    -23871.33753 2905.16176   112%     -  422s
     0     0 2845.00047    0  525 -23871.338 2845.00047   112%     -  432s
     0     0 2812.84980    0  520 -23871.338 2812.84980   112%     -  439s
     0     0 2789.16864    0  585 -23871.338 2789.16864   112%     -  445s
     0     0 2781.72606    0  605 -23871.338 2781.72606   112%     -  449s
     0     0 2776.33032    0  605 -23871.338 2776.33032   112%     -  452s
     0     0 2773.42740    0  649 -23871.338 2773.42740   112%     -  455s
     0     0 2773.09362    0  639 -23871.338 2773.09362   112%     -  457s
     0     0 2661.16824    0  632 -23871.338 2661.16824   111%     -  471s
H    0     0                    -10437.21053 2660.75546   125%     -  475s
H    0     0                    -10379.97746 2660.75546   126%     -  475s
H    0     0                    -10375.01276 2660.75546   126%     -  476s
H    0     0                    -10299.42917 2660.75546   126%     -  476s
H    0     0                    -10207.46156 2660.75546   126%     -  478s
H    0     0                    -10196.92343 2660.75546   126%     -  478s
H    0     0                    -10050.29023 2660.75546   126%     -  480s
H    0     0                    -10009.99456 2660.75546   127%     -  480s
     0     0 2616.57936    0  587 -10009.995 2616.57936   126%     -  489s
     0     0 2605.17090    0  586 -10009.995 2605.17090   126%     -  493s
     0     0 2590.42673    0  528 -10009.995 2590.42673   126%     -  496s
     0     0 2581.36527    0  636 -10009.995 2581.36527   126%     -  498s
     0     0 2578.73469    0  643 -10009.995 2578.73469   126%     -  501s
     0     0 2575.82464    0  649 -10009.995 2575.82464   126%     -  503s
     0     0 2570.77182    0  533 -10009.995 2570.77182   126%     -  507s
     0     0 2568.32745    0  536 -10009.995 2568.32745   126%     -  509s
     0     0 2568.12180    0  532 -10009.995 2568.12180   126%     -  510s
     0     0 2501.90378    0  642 -10009.995 2501.90378   125%     -  520s
     0     0 2486.00626    0  609 -10009.995 2486.00626   125%     -  526s
     0     0 2476.36617    0  610 -10009.995 2476.36617   125%     -  530s
     0     0 2474.14718    0  608 -10009.995 2474.14718   125%     -  531s
     0     0 2471.82774    0  607 -10009.995 2471.82774   125%     -  532s
     0     0 2467.86228    0  607 -10009.995 2467.86228   125%     -  535s
     0     0 2465.93859    0  610 -10009.995 2465.93859   125%     -  537s
     0     0 2465.65976    0  618 -10009.995 2465.65976   125%     -  537s
     0     0 2393.27671    0  600 -10009.995 2393.27671   124%     -  551s
H    0     0                    -10006.35312 2393.09762   124%     -  553s
H    0     0                    -9974.871997 2393.09762   124%     -  554s
     0     0 2372.01670    0  656 -9974.8720 2372.01670   124%     -  561s
     0     0 2365.96389    0  657 -9974.8720 2365.96389   124%     -  566s
     0     0 2359.87099    0  652 -9974.8720 2359.87099   124%     -  570s
     0     0 2358.81856    0  661 -9974.8720 2358.81856   124%     -  571s
     0     0 2315.87885    0  609 -9974.8720 2315.87885   123%     -  581s
     0     0 2296.91201    0  665 -9974.8720 2296.91201   123%     -  587s
     0     0 2290.00498    0  667 -9974.8720 2290.00498   123%     -  590s
     0     0 2289.28066    0  622 -9974.8720 2289.28066   123%     -  592s
     0     0 2239.97374    0  537 -9974.8720 2239.97374   122%     -  602s
     0     0 2226.35179    0  610 -9974.8720 2226.35179   122%     -  609s
     0     0 2218.86461    0  615 -9974.8720 2218.86461   122%     -  612s
     0     0 2210.84137    0  615 -9974.8720 2210.84137   122%     -  617s
     0     0 2209.53234    0  616 -9974.8720 2209.53234   122%     -  618s
     0     0 2178.42115    0  551 -9974.8720 2178.42115   122%     -  625s
H    0     0                    -9225.598679 2178.18272   124%     -  626s
H    0     0                    -8921.996927 2178.18272   124%     -  626s
H    0     0                    -8565.672216 2178.18272   125%     -  626s
H    0     0                    -8002.643645 2178.18272   127%     -  626s
     0     0 2172.88141    0  551 -8002.6436 2172.88141   127%     -  629s
     0     0 2170.35851    0  566 -8002.6436 2170.35851   127%     -  631s
     0     0 2164.59179    0  680 -8002.6436 2164.59179   127%     -  635s
     0     0 2163.87350    0  686 -8002.6436 2163.87350   127%     -  636s
     0     0 2146.58080    0  562 -8002.6436 2146.58080   127%     -  644s
H    0     0                    -7920.526531 2146.30982   127%     -  654s
H    0     0                    -7905.269695 2146.30982   127%     -  654s
H    0     0                    -7783.391658 2146.30982   128%     -  654s
     0     0 2139.18121    0  563 -7783.3917 2139.18121   127%     -  658s
     0     0 2136.56794    0  568 -7783.3917 2136.56794   127%     -  660s
     0     0 2136.03135    0  565 -7783.3917 2136.03135   127%     -  661s
     0     0 2050.63561    0  634 -7783.3917 2050.63561   126%     -  673s
H    0     0                    -7780.164989 2050.36242   126%     -  674s
H    0     0                    -7740.024492 2050.36242   126%     -  674s
     0     0 2045.75144    0  577 -7740.0245 2045.75144   126%     -  678s
     0     0 2043.93850    0  647 -7740.0245 2043.93850   126%     -  679s
     0     0 2027.50702    0  629 -7740.0245 2027.50702   126%     -  686s
H    0     0                    -7703.523161 2027.07902   126%     -  688s
     0     0 2025.71187    0  658 -7703.5232 2025.71187   126%     -  690s
     0     0 1999.97182    0  639 -7703.5232 1999.97182   126%     -  699s
     0     0 1987.45403    0  592 -7703.5232 1987.45403   126%     -  705s
     0     0 1984.50661    0  583 -7703.5232 1984.50661   126%     -  708s
     0     0 1980.96904    0  584 -7703.5232 1980.96904   126%     -  711s
     0     0 1978.76069    0  593 -7703.5232 1978.76069   126%     -  714s
     0     0 1976.79036    0  589 -7703.5232 1976.79036   126%     -  717s
     0     0 1976.24969    0  578 -7703.5232 1976.24969   126%     -  718s
     0     0 1969.78083    0  572 -7703.5232 1969.78083   126%     -  723s
H    0     0                    -7669.003132 1969.42459   126%     -  742s
     0     0 1966.41665    0  579 -7669.0031 1966.41665   126%     -  751s
     0     0 1966.06190    0  570 -7669.0031 1966.06190   126%     -  751s
     0     0 1962.22113    0  577 -7669.0031 1962.22113   126%     -  756s
     0     0 1961.34992    0  581 -7669.0031 1961.34992   126%     -  758s
     0     0 1940.39010    0  558 -7669.0031 1940.39010   125%     -  768s
     0     0 1938.96153    0  576 -7669.0031 1938.96153   125%     -  770s
     0     0 1934.44566    0  569 -7669.0031 1934.44566   125%     -  776s
     0     0 1932.77728    0  588 -7669.0031 1932.77728   125%     -  779s
     0     0 1925.78242    0  571 -7669.0031 1925.78242   125%     -  785s
     0     0 1925.25349    0  571 -7669.0031 1925.25349   125%     -  791s
     0     2 1925.25349    0  571 -7669.0031 1925.25349   125%     -  857s
     1     3 1776.04201    1  654 -7669.0031 1925.25349   125% 12268  867s
     2     4 1907.53513    1  557 -7669.0031 1907.53513   125%  8558  874s
     3     6 1569.19477    2  620 -7669.0031 1907.14597   125%  7918  886s
     5    11 1548.24349    3  619 -7669.0031 1907.14597   125%  8347  900s
    10    21 1439.43839    4  609 -7669.0031 1662.27976   122%  7806  917s
    20    31  675.25348    5  454 -7669.0031 1662.27976   122% 13268  971s
    30    61  -70.05478    6  445 -7669.0031 1486.41646   119% 14289 1125s
    60    93 -210.13020    7  452 -7669.0031 1486.41646   119% 21551 1167s
    92   136 -246.01795    8  447 -7669.0031 1486.41646   119% 19277 1235s
   135   214 -414.20949    9  578 -7669.0031 1486.41646   119% 15246 1286s
   217   279 -471.32899   10  578 -7669.0031 1486.41646   119% 11520 1321s
   292   355 -5011.9778   21  192 -7669.0031 1486.41646   119% 10549 1347s
   382   382 -573.66368   11  581 -7669.0031 1486.41646   119%  9563 1374s
   418   423 -671.21917   12  573 -7669.0031 1486.41646   119%  9487 1396s
   470   447 -898.98877   14  553 -7669.0031 1486.41646   119%  9305 1413s
   507   478 -1274.7343   15  459 -7669.0031 1486.41646   119%  9292 1433s
   548   513 -1280.5115   16  242 -7669.0031 1176.08321   115%  9321 1451s
   592   561 -1429.9665   17  452 -7669.0031 1176.08321   115%  9141 1469s
   649   608 -1473.8909   18  316 -7669.0031 1176.08321   115%  8901 1487s
   712   642 -2049.5256   19  298 -7669.0031 1176.08321   115%  8729 1504s
   788   676 -2150.6138   20  312 -7669.0031 1176.08321   115%  8427 1520s
   850   698 -2444.6304   21  298 -7669.0031 1176.08321   115%  8326 1540s
   922   751 -2582.4670   22  291 -7669.0031 1176.08321   115%  8147 1559s
  1003   787 -2677.4272   23  301 -7669.0031 1176.08321   115%  7994 1587s
  1069   829 -2854.3986   24  272 -7669.0031 1176.08321   115%  7871 1604s
  1166   889 -2927.0254   25  278 -7669.0031 1013.68061   113%  7688 1623s
  1265   942 -3542.7788   26  271 -7669.0031  880.63260   111%  7574 1645s
  1360   998 -3590.5033   27  204 -7669.0031  880.63260   111%  7586 1665s
  1462  1081 infeasible   28      -7669.0031  880.63260   111%  7579 1687s
  1585  1160 -4346.5260   29  253 -7669.0031  880.63260   111%  7527 1710s
  1700  1249 -4493.1524   30  339 -7669.0031  811.64712   111%  7506 1734s
  1829  1370 -4925.3349   33  271 -7669.0031  479.53662   106%  7458 1757s
  1988  1433 -6056.0480   38  321 -7669.0031  479.53662   106%  7337 1784s
  2159  1507 infeasible   40      -7669.0031  479.53662   106%  7152 1811s
  2324  1536 infeasible   43      -7669.0031  479.53662   106%  7076 1840s
  2465  1583 -6190.8101   25  368 -7669.0031  479.53662   106%  7129 1873s
  2558  1660 -6192.0475   26  361 -7669.0031  479.53662   106%  7265 1905s
  2661  1745 -7168.3613   29  335 -7669.0031  479.53662   106%  7382 1936s
  2820  1825 infeasible   27      -7669.0031  479.53662   106%  7346 1973s
  2966  1903 infeasible   29      -7669.0031  252.52370   103%  7324 2011s
  3110  1989 -3663.8280   12  317 -7669.0031   20.60131   100%  7355 2048s
  3280  2084 infeasible   14      -7669.0031   20.60131   100%  7350 2085s
  3506  2141 -6547.8030   18  289 -7669.0031   20.60131   100%  7214 2129s
  3687  2200 -7097.4038   21  240 -7669.0031   20.60131   100%  7212 2173s
  3851  2273 -3120.2410   14  191 -7669.0031   20.60131   100%  7256 2222s
  4005  2349 -4420.7149   17  257 -7669.0031  -79.29044  99.0%  7332 2273s
  4142  2415 -4684.7072   19  402 -7669.0031  -85.94155  98.9%  7457 2329s
  4285  2502 infeasible   21      -7669.0031  -85.94155  98.9%  7540 2377s
  4462  2593 -7618.9882   25  305 -7669.0031  -85.94155  98.9%  7616 2428s
  4636  2594 -5537.6495   22  571 -7669.0031  -85.94155  98.9%  7665 2638s
  4638  2595 -7237.7551   11  334 -7669.0031  -85.94155  98.9%  7662 2652s
  4639  2596 -6112.5715   31  486 -7669.0031  -85.94155  98.9%  7660 2720s
  4640  2597 -4997.2313   19  572 -7669.0031  -85.94155  98.9%  7659 2772s
  4641  2597 -6124.7050   33  580 -7669.0031  -85.94155  98.9%  7657 2801s
  4642  2598 -7313.1362   76  608 -7669.0031  -85.94155  98.9%  7655 2825s
  4643  2599 -4743.1135   14  619 -7669.0031  -85.94155  98.9%  7654 2842s
  4644  2599 -3563.4885   23  614 -7669.0031  -85.94155  98.9%  7652 2859s
  4645  2600 -1430.8632   13  627 -7669.0031  -85.94155  98.9%  7650 2878s
  4646  2601 -1568.6476    9  618 -7669.0031  -85.94155  98.9%  7649 2894s
  4647  2601 -2113.5181   20  613 -7669.0031  -85.94155  98.9%  7647 2907s
  4648  2602 -4660.8636   18  629 -7669.0031  -85.94155  98.9%  7645 2915s
  4649  2603 -2111.4798    8  643 -7669.0031  -85.94155  98.9%  7644 2924s
  4650  2603 -4084.3520   48  636 -7669.0031  -85.94155  98.9%  7642 2930s
  4651  2604 -1256.3301   14  637 -7669.0031  -85.94155  98.9%  7640 2937s
  4652  2605 -427.09676    9  567 -7669.0031  -85.94155  98.9%  7639 2963s
  4653  2605 -2203.2181   15  680 -7669.0031  -85.94155  98.9%  7637 2973s
  4654  2606 -4538.4326   41  566 -7669.0031  -85.94155  98.9%  7636 2979s
  4655  2607 -7047.3212   26  639 -7669.0031  -85.94155  98.9%  7634 2987s
  4656  2607 -4121.0722   26  576 -7669.0031  -85.94155  98.9%  7632 2997s
  4657  2608 -1704.5120   12  555 -7669.0031  -85.94155  98.9%  7631 3013s
  4658  2609 -7237.7551   11  631 -7669.0031  -85.94155  98.9%  7629 3020s
  4659  2609 -7176.5599   24  567 -7669.0031  -85.94155  98.9%  7627 3026s
  4660  2610 -2335.1238   14  653 -7669.0031  -85.94155  98.9%  7626 3032s
  4661  2611 -6056.1480   39  651 -7669.0031  -85.94155  98.9%  7624 3038s
  4662  2611 -3086.5435   16  657 -7669.0031  -85.94155  98.9%  7622 3043s
  4663  2612 -3788.4406   20  645 -7669.0031  -85.94155  98.9%  7621 3051s
  4664  2613 -3123.1242   18  620 -7669.0031  -85.94155  98.9%  7619 3068s
  4665  2613 -448.01273   11  634 -7669.0031  -85.94155  98.9%  7618 3074s
  4666  2614 -6805.6693   31  621 -7669.0031  -85.94155  98.9%  7616 3080s
  4667  2615 -900.78491   15  627 -7669.0031  -85.94155  98.9%  7614 3088s
  4668  2615 -2682.1067    9  636 -7669.0031  -85.94155  98.9%  7613 3096s
  4669  2616 -6889.7797   15  662 -7669.0031  -85.94155  98.9%  7611 3110s
  4670  2617 -3436.2801   18  655 -7669.0031  -85.94155  98.9%  7609 3115s
  4671  2617 -1708.8036    9  636 -7669.0031  -85.94155  98.9%  7608 3123s
  4672  2618 -3983.2657   16  657 -7669.0031  -85.94155  98.9%  7606 3143s
  4673  2619 -1344.8987   20  655 -7669.0031  -85.94155  98.9%  7605 3150s
  4674  2619 -1558.9003   16  686 -7669.0031  -85.94155  98.9%  7603 3161s
  4675  2620 -5268.7162   36  689 -7669.0031  -85.94155  98.9%  7601 3168s
  4676  2621 -2284.5016   15  684 -7669.0031  -85.94155  98.9%  7600 3181s
  4677  2621 -5294.2683   68  679 -7669.0031  -85.94155  98.9%  7598 3186s
  4678  2622 -1853.5749   17  684 -7669.0031  -85.94155  98.9%  7596 3192s
  4679  2623 -1039.3187   12  656 -7669.0031  -85.94155  98.9%  7595 3203s
  4680  2623 -6556.8822   49  639 -7669.0031  -85.94155  98.9%  7593 3211s
  4681  2624 -6103.7087   31  655 -7669.0031  -85.94155  98.9%  7592 3222s
  4682  2625 -1455.9474   13  655 -7669.0031  -85.94155  98.9%  7590 3238s
  4683  2625 -6767.4725   18  655 -7669.0031  -85.94155  98.9%  7588 3298s
  4684  2629  -85.94155   10  634 -7669.0031  -85.94155  98.9%  7705 3351s
  4686  2632  -85.94155   11  642 -7669.0031  -85.94155  98.9%  7709 3369s
  4690  2639  -85.94155   12  669 -7669.0031  -85.94155  98.9%  7713 3400s
  4698  2649  -85.94155   13  636 -7669.0031  -85.94155  98.9%  7713 3436s
  4714  2648 infeasible   14      -7669.0031  -85.94155  98.9%  7750 3478s
  4728  2665 -1409.2131   15  433 -7669.0031  -85.94155  98.9%  7787 3567s
  4750  2697 -2123.2997   16  360 -7669.0031  -85.94155  98.9%  7832 3600s

Cutting planes:
  Learned: 1
  Gomory: 1
  Implied bound: 9
  Projected implied bound: 181
  MIR: 1795
  Mixing: 1
  Flow cover: 2439
  GUB cover: 1
  Zero half: 2
  RLT: 34
  Relax-and-lift: 138

Explored 4789 nodes (38752857 simplex iterations) in 3600.10 seconds (9444.49 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -7669 -7703.52 -7740.02 ... -8922

Time limit reached
Best objective -7.669003131842e+03, best bound -8.594155123639e+01, gap 98.8794%
  WARNING: Time limit reached. Using best solution found (gap: 98.88%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.11s
  Master Objective (UB) = -7669.00, θ = 113536.18
  Upper Bound (UB) = -7669.00

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 113536.18
  [DEBUG]   ✓ Scenario 0: θ = 113536.18 ≤ Q = 113536.18 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 113536.18 ≤ Q = 113536.18 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 113536.18 ≤ Q = 113536.18 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 113536.18 ≤ Q = 113536.18 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 113536.18 ≤ Q = 113536.18 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 113536.18 ≤ Q = 113536.18 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 113536.18 ≤ Q = 113536.18 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 113536.18 ≤ Q = 113536.18 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 113536.18 ≤ Q = 113536.18 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 113536.18 ≤ Q = 113536.18 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 113536.18 ≤ Q = 113536.18 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 113536.18 ≤ Q = 113536.18 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 113536.18 ≤ Q = 113536.18 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 113536.18 ≤ Q = 113536.18 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 113536.18 ≤ Q = 113536.18 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 113536.18 ≤ Q = 113536.18 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 16] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x7e7592f5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x818a6d0b
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.382091e+13
Presolve removed 2602 rows and 1895 columns
Presolve time: 0.00s
Presolved: 491 rows, 494 columns, 1384 nonzeros
Found heuristic solution: objective 6863750.6858
Variable types: 334 continuous, 160 integer (160 binary)

Root relaxation: objective -1.254356e+05, 233 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -125435.56    0  123 6863750.69 -125435.56   102%     -    0s
H    0     0                    -92518.39072 -125435.56  35.6%     -    0s
H    0     0                    -93153.82350 -125435.56  34.7%     -    0s
     0     0 -108552.81    0   96 -93153.824 -108552.81  16.5%     -    0s
H    0     0                    -104751.1581 -108442.98  3.52%     -    0s
H    0     0                    -105565.3713 -108442.98  2.73%     -    0s
     0     0 -107595.64    0   95 -105565.37 -107595.64  1.92%     -    0s
H    0     0                    -105749.7045 -107505.07  1.66%     -    0s
     0     0 -106870.30    0   69 -105749.70 -106870.30  1.06%     -    0s
     0     0 -106735.05    0   80 -105749.70 -106735.05  0.93%     -    0s
     0     0 -106722.32    0   80 -105749.70 -106722.32  0.92%     -    0s
     0     0 -106443.75    0   40 -105749.70 -106443.75  0.66%     -    0s
H    0     0                    -105752.3725 -106372.09  0.59%     -    0s
     0     0 -106366.78    0   55 -105752.37 -106366.78  0.58%     -    0s
     0     0 -106354.40    0   58 -105752.37 -106354.40  0.57%     -    0s
     0     0 -106052.12    0   16 -105752.37 -106052.12  0.28%     -    0s
     0     0 -106011.41    0   27 -105752.37 -106011.41  0.24%     -    0s
     0     0 -105998.65    0   30 -105752.37 -105998.65  0.23%     -    0s
     0     0 -105910.64    0   16 -105752.37 -105910.64  0.15%     -    0s
     0     0 -105896.26    0   19 -105752.37 -105896.26  0.14%     -    0s
     0     0 -105867.69    0   18 -105752.37 -105867.69  0.11%     -    0s
     0     0 -105769.48    0    6 -105752.37 -105769.48  0.02%     -    0s
     0     0 -105766.46    0    4 -105752.37 -105766.46  0.01%     -    0s

Cutting planes:
  Gomory: 5
  Implied bound: 7
  MIR: 5
  Flow cover: 16
  Relax-and-lift: 5

Explored 1 nodes (927 simplex iterations) in 0.09 seconds (0.05 work units)
Thread count was 32 (of 256 available processors)

Solution count 8: -105752 -105750 -105721 ... 1.38209e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.057523724902e+05, best bound -1.057615086263e+05, gap 0.0086%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 103250.93
  Scenario: 45 demand increases, 15 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -105752.37
  [DEBUG]   S×d_nominal = 209003.30
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 209003.30 + -105752.37 = 103250.93
  [DEBUG]   Current θ from Master = 113536.18
  [DEBUG]   ⚠️  Z_SP ≤ θ by 10285.25 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -17954.25
  Lower Bound (LB) = -8863.81
  Gap (UB-LB) = 1194.8031, Absolute Gap = 1194.8031, Relative Gap = 0.155796
  Not converged yet (gap = 1194.80 > ε = 200)

  [DEBUG] Adding NEW scenario 16 to Master Problem...
  [DEBUG] New scenario pattern: 45 increases, 15 decreases
    [DEBUG] Scenario 16 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 16 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 16]
    [DEBUG]   - Total constraints in model: 261313
    [DEBUG]   - Total variables in model: 108340
  [DEBUG] Total scenarios in Master: 17
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 17
================================================================================
[Iteration 17] Solving Master Problem...
  Current scenarios in Master: 17
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 261313 rows, 108340 columns and 740446 nonzeros
Model fingerprint: 0xb13ce5a7
Variable types: 106081 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [9e-02, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 120510 rows and 48950 columns
Presolve time: 2.13s
Presolved: 140803 rows, 59390 columns, 868495 nonzeros
Variable types: 57131 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -371500.8959
Found heuristic solution: objective -360483.0300
Found heuristic solution: objective -172304.4497

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.35s

Barrier statistics:
 Dense cols : 633
 AA' NZ     : 7.211e+06
 Factor NZ  : 1.662e+07 (roughly 200 MB of memory)
 Factor Ops : 5.174e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.67667844e+07  2.19275621e+08  8.73e+04 2.26e+01  6.68e+04     4s
   1  -1.25982222e+07  1.90650878e+08  6.08e+04 4.60e+01  4.62e+04     4s
   2  -4.19335324e+06  1.54582632e+08  1.92e+04 8.67e+00  1.53e+04     4s
   3  -6.40723445e+05  1.10011832e+08  7.01e+02 1.14e+00  9.57e+02     4s
   4  -5.29156625e+05  8.07151545e+07  3.03e+02 7.63e-01  5.29e+02     4s
   5  -4.76060679e+05  5.40692760e+07  1.57e+02 4.72e-01  3.14e+02     4s
   6  -4.22159772e+05  3.85192629e+07  5.49e+01 3.19e-01  1.83e+02     4s
   7  -3.77589582e+05  2.66899542e+07  2.02e+01 2.12e-01  1.15e+02     4s
   8  -2.97837445e+05  1.91114783e+07  5.53e+00 1.48e-01  7.77e+01     4s
   9  -2.10158782e+05  8.47809400e+06  1.33e+00 6.46e-02  3.41e+01     4s
  10  -1.46859570e+05  3.44621715e+06  7.46e-01 2.56e-02  1.40e+01     4s
  11  -1.32485689e+05  3.18476136e+06  6.40e-01 2.37e-02  1.30e+01     4s
  12  -1.01423622e+05  2.00577581e+06  3.99e-01 1.54e-02  8.22e+00     5s
  13  -8.45865235e+04  1.57371195e+06  2.79e-01 1.22e-02  6.47e+00     5s
  14  -7.18709877e+04  1.20474685e+06  2.07e-01 9.36e-03  4.98e+00     5s
  15  -4.05268973e+04  8.75847460e+05  5.91e-02 6.49e-03  3.57e+00     5s
  16  -2.65197112e+04  3.19974774e+05  3.11e-02 2.59e-03  1.35e+00     5s
  17  -1.89486950e+04  1.72729003e+05  2.23e-02 1.89e-03  7.46e-01     5s
  18  -1.41929924e+04  1.29805456e+05  1.81e-02 1.51e-03  5.61e-01     5s
  19  -8.48152022e+03  9.12233534e+04  1.35e-02 1.01e-03  3.88e-01     5s
  20  -3.26807971e+03  6.27107652e+04  9.89e-03 6.63e-04  2.57e-01     5s
  21  -6.43192409e+02  5.20452472e+04  8.11e-03 5.17e-04  2.05e-01     5s
  22   2.31105919e+03  4.65330776e+04  6.28e-03 4.47e-04  1.72e-01     5s
  23   4.92976442e+03  3.62991796e+04  4.69e-03 3.11e-04  1.22e-01     5s
  24   7.04860940e+03  3.08333232e+04  3.52e-03 2.35e-04  9.26e-02     5s
  25   8.76356797e+03  2.81463753e+04  2.67e-03 1.95e-04  7.54e-02     5s
  26   9.90678965e+03  2.28146533e+04  2.15e-03 3.53e-04  5.02e-02     5s
  27   1.11297650e+04  2.11217966e+04  1.62e-03 2.75e-04  3.89e-02     5s
  28   1.18087260e+04  1.93165941e+04  1.32e-03 1.91e-04  2.92e-02     6s
  29   1.23469966e+04  1.81466773e+04  1.10e-03 1.37e-04  2.26e-02     6s
  30   1.30659096e+04  1.74094461e+04  8.01e-04 1.03e-04  1.69e-02     6s
  31   1.35514630e+04  1.65513390e+04  6.05e-04 6.22e-05  1.17e-02     6s
  32   1.38071251e+04  1.60990634e+04  5.04e-04 4.14e-05  8.92e-03     6s
  33   1.41099252e+04  1.59083102e+04  3.87e-04 3.26e-05  7.00e-03     6s
  34   1.43397048e+04  1.57336050e+04  2.95e-04 2.48e-05  5.43e-03     6s
  35   1.44668302e+04  1.55796285e+04  2.46e-04 1.82e-05  4.33e-03     6s
  36   1.46726660e+04  1.53955541e+04  1.73e-04 9.83e-06  2.81e-03     6s
  37   1.48213085e+04  1.53231869e+04  1.19e-04 6.66e-06  1.95e-03     6s
  38   1.49547924e+04  1.52790627e+04  7.28e-05 4.80e-06  1.26e-03     6s
  39   1.50201173e+04  1.52547727e+04  4.85e-05 3.74e-06  9.13e-04     6s
  40   1.50230125e+04  1.52453605e+04  4.75e-05 3.35e-06  8.66e-04     6s
  41   1.50410384e+04  1.52245744e+04  4.14e-05 2.47e-06  7.15e-04     6s
  42   1.50573939e+04  1.51828797e+04  3.58e-05 6.90e-07  4.89e-04     7s
  43   1.50736319e+04  1.51733110e+04  3.02e-05 2.49e-07  3.88e-04     7s
  44   1.50943004e+04  1.51726672e+04  2.33e-05 2.30e-07  3.05e-04     7s
  45   1.51596721e+04  1.51683536e+04  9.12e-07 5.46e-07  3.38e-05     7s
  46   1.51599261e+04  1.51668812e+04  8.49e-07 3.56e-07  2.71e-05     7s
  47   1.51623874e+04  1.51643420e+04  3.35e-07 2.28e-08  7.61e-06     7s
  48   1.51624177e+04  1.51643379e+04  4.39e-07 2.24e-08  7.48e-06     7s
  49   1.51624648e+04  1.51643313e+04  7.99e-07 1.95e-07  7.27e-06     7s
  50   1.51632172e+04  1.51642255e+04  7.14e-07 9.45e-06  3.93e-06     7s
  51   1.51633287e+04  1.51641708e+04  5.92e-07 4.39e-06  3.28e-06     7s
  52   1.51636818e+04  1.51641598e+04  4.11e-07 3.32e-06  1.86e-06     7s
  53   1.51637302e+04  1.51641436e+04  4.29e-07 1.99e-06  1.61e-06     7s
  54   1.51637904e+04  1.51641415e+04  3.42e-06 5.53e-06  1.37e-06     7s
  55   1.51638329e+04  1.51641374e+04  3.92e-06 4.58e-06  1.19e-06     7s
  56   1.51638714e+04  1.51641359e+04  3.41e-06 4.26e-06  1.03e-06     7s
  57   1.51638793e+04  1.51641355e+04  3.86e-06 4.17e-06  9.97e-07     8s
  58   1.51639231e+04  1.51641301e+04  7.33e-06 2.99e-06  8.09e-07     8s
  59   1.51640598e+04  1.51641182e+04  2.04e-06 1.89e-07  2.28e-07     8s
  60   1.51640834e+04  1.51641161e+04  8.36e-07 1.67e-08  1.28e-07     8s
  61   1.51640901e+04  1.51641160e+04  1.03e-06 9.02e-09  1.01e-07     8s
  62   1.51641117e+04  1.51641159e+04  2.43e-07 1.78e-07  1.64e-08     8s
  63   1.51641131e+04  1.51641159e+04  1.94e-07 8.75e-08  1.10e-08     8s
  64   1.51641154e+04  1.51641159e+04  7.80e-07 2.67e-08  1.82e-09     8s
  65   1.51641159e+04  1.51641159e+04  3.50e-08 2.48e-08  2.34e-11     8s

Barrier solved model in 65 iterations and 7.97 seconds (18.36 work units)
Optimal objective 1.51641159e+04


Root crossover log...

  114853 DPushes remaining with DInf 0.0000000e+00                 8s
    7719 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                11s

    3646 PPushes remaining with PInf 4.9183951e-06                11s
       0 PPushes remaining with PInf 0.0000000e+00                11s

  Push phase complete: Pinf 0.0000000e+00, Dinf 8.5334851e-01     11s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   52304    1.5164116e+04   0.000000e+00   8.533485e-01     11s
   52305    1.5164116e+04   0.000000e+00   0.000000e+00     11s
   52305    1.5164116e+04   0.000000e+00   0.000000e+00     11s
Concurrent spin time: 4.02s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 1.516412e+04, 52305 iterations, 12.34 seconds (24.43 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 15164.1159    0  369 -172304.45 15164.1159   109%     -   15s
H    0     0                    -102865.7001 15164.1159   115%     -   16s
H    0     0                    -101971.0283 15164.1159   115%     -   16s
H    0     0                    -98747.74880 15164.1159   115%     -   16s
H    0     0                    -79357.04551 15164.1159   119%     -   16s
H    0     0                    -79214.07174 15164.1159   119%     -   16s
H    0     0                    -78967.23893 15164.1159   119%     -   16s
H    0     0                    -62423.71788 15164.1159   124%     -   16s
H    0     0                    -56751.63969 15164.1159   127%     -   16s
H    0     0                    -45786.06818 15164.1159   133%     -   16s
H    0     0                    -44444.43072 15164.1159   134%     -   16s
     0     0 8376.28218    0  385 -44444.431 8376.28218   119%     -   49s
H    0     0                    -32243.03490 8375.46891   126%     -   50s
     0     0 8265.44030    0  379 -32243.035 8265.44030   126%     -   61s
     0     0 8262.78395    0  377 -32243.035 8262.78395   126%     -   63s
     0     0 8165.52924    0  391 -32243.035 8165.52924   125%     -   69s
     0     0 8102.57754    0  400 -32243.035 8102.57754   125%     -   75s
     0     0 8100.42129    0  400 -32243.035 8100.42129   125%     -   76s
     0     0 8091.16119    0  398 -32243.035 8091.16119   125%     -   77s
     0     0 8055.87903    0  388 -32243.035 8055.87903   125%     -   83s
     0     0 8047.98652    0  395 -32243.035 8047.98652   125%     -   85s
     0     0 8045.73353    0  394 -32243.035 8045.73353   125%     -   87s
     0     0 8038.10688    0  392 -32243.035 8038.10688   125%     -   92s
     0     0 8037.87497    0  392 -32243.035 8037.87497   125%     -   94s
     0     0 6295.32074    0  454 -32243.035 6295.32074   120%     -  139s
H    0     0                    -25307.91874 6295.30705   125%     -  140s
H    0     0                    -25275.20083 6295.30705   125%     -  140s
     0     0 5925.08665    0  502 -25275.201 5925.08665   123%     -  166s
     0     0 5616.12019    0  435 -25275.201 5616.12019   122%     -  193s
     0     0 5552.28785    0  444 -25275.201 5552.28785   122%     -  204s
     0     0 5479.81329    0  428 -25275.201 5479.81329   122%     -  219s
     0     0 5400.75675    0  423 -25275.201 5400.75675   121%     -  231s
     0     0 5383.84368    0  427 -25275.201 5383.84368   121%     -  238s
     0     0 5375.37500    0  445 -25275.201 5375.37500   121%     -  242s
     0     0 5348.21814    0  434 -25275.201 5348.21814   121%     -  248s
     0     0 5292.29968    0  436 -25275.201 5292.29968   121%     -  258s
     0     0 5286.66509    0  434 -25275.201 5286.66509   121%     -  262s
     0     0 5282.41536    0  442 -25275.201 5282.41536   121%     -  265s
     0     0 5281.81573    0  440 -25275.201 5281.81573   121%     -  267s
     0     0 4134.80608    0  530 -25275.201 4134.80608   116%     -  311s
H    0     0                    -24565.50735 4134.06465   117%     -  312s
H    0     0                    -24297.11721 4134.06465   117%     -  312s
H    0     0                    -24246.85740 4134.06465   117%     -  312s
     0     0 3939.51336    0  555 -24246.857 3939.51336   116%     -  326s
     0     0 3874.02028    0  511 -24246.857 3874.02028   116%     -  339s
     0     0 3829.37035    0  560 -24246.857 3829.37035   116%     -  348s
     0     0 3780.15110    0  558 -24246.857 3780.15110   116%     -  353s
     0     0 3757.66565    0  557 -24246.857 3757.66565   115%     -  357s
     0     0 3750.13859    0  556 -24246.857 3750.13859   115%     -  359s
     0     0 3741.49161    0  553 -24246.857 3741.49161   115%     -  363s
     0     0 3726.35889    0  588 -24246.857 3726.35889   115%     -  367s
     0     0 3718.69223    0  640 -24246.857 3718.69223   115%     -  371s
     0     0 3713.20066    0  638 -24246.857 3713.20066   115%     -  374s
     0     0 3706.91346    0  647 -24246.857 3706.91346   115%     -  376s
     0     0 3695.01854    0  640 -24246.857 3695.01854   115%     -  381s
     0     0 3690.89998    0  636 -24246.857 3690.89998   115%     -  383s
     0     0 3690.40107    0  636 -24246.857 3690.40107   115%     -  384s
     0     0 3246.05064    0  523 -24246.857 3246.05064   113%     -  409s
H    0     0                    -24241.16650 3245.55631   113%     -  410s
     0     0 3110.51942    0  454 -24241.167 3110.51942   113%     -  428s
     0     0 3066.75877    0  525 -24241.167 3066.75877   113%     -  442s
     0     0 3046.96678    0  534 -24241.167 3046.96678   113%     -  452s
     0     0 3018.49713    0  528 -24241.167 3018.49713   112%     -  460s
     0     0 3009.93456    0  468 -24241.167 3009.93456   112%     -  463s
     0     0 2997.63901    0  402 -24241.167 2997.63901   112%     -  467s
     0     0 2994.49052    0  397 -24241.167 2994.49052   112%     -  470s
     0     0 2988.70092    0  525 -24241.167 2988.70092   112%     -  474s
     0     0 2986.53635    0  394 -24241.167 2986.53635   112%     -  476s
     0     0 2984.19725    0  514 -24241.167 2984.19725   112%     -  479s
     0     0 2981.38257    0  396 -24241.167 2981.38257   112%     -  483s
     0     0 2974.61915    0  459 -24241.167 2974.61915   112%     -  486s
     0     0 2919.93130    0  524 -24241.167 2919.93130   112%     -  494s
     0     0 2916.20638    0  527 -24241.167 2916.20638   112%     -  497s
     0     0 2915.28215    0  526 -24241.167 2915.28215   112%     -  499s
     0     0 2736.24037    0  603 -24241.167 2736.24037   111%     -  515s
H    0     0                    -23484.30356 2735.94082   112%     -  516s
     0     0 2676.70893    0  587 -23484.304 2676.70893   111%     -  525s
     0     0 2667.44338    0  591 -23484.304 2667.44338   111%     -  529s
     0     0 2662.23911    0  606 -23484.304 2662.23911   111%     -  534s
     0     0 2589.29793    0  531 -23484.304 2589.29793   111%     -  545s
     0     0 2551.81730    0  596 -23484.304 2551.81730   111%     -  556s
     0     0 2516.82987    0  620 -23484.304 2516.82987   111%     -  569s
     0     0 2510.61488    0  617 -23484.304 2510.61488   111%     -  575s
     0     0 2507.58534    0  614 -23484.304 2507.58534   111%     -  578s
     0     0 2503.44391    0  615 -23484.304 2503.44391   111%     -  582s
     0     0 2497.90111    0  605 -23484.304 2497.90111   111%     -  586s
     0     0 2494.71293    0  620 -23484.304 2494.71293   111%     -  590s
     0     0 2493.03905    0  623 -23484.304 2493.03905   111%     -  592s
     0     0 2492.72289    0  623 -23484.304 2492.72289   111%     -  594s
     0     0 2317.13779    0  610 -23484.304 2317.13779   110%     -  608s
H    0     0                    -12790.72702 2316.86726   118%     -  610s
H    0     0                    -11585.33481 2316.86726   120%     -  612s
H    0     0                    -11496.51758 2316.86726   120%     -  612s
H    0     0                    -10543.03498 2316.86726   122%     -  612s
H    0     0                    -10497.29986 2316.86726   122%     -  613s
H    0     0                    -10418.19559 2316.86726   122%     -  614s
H    0     0                    -10388.35273 2316.86726   122%     -  614s
     0     0 2256.35028    0  621 -10388.353 2256.35028   122%     -  626s
     0     0 2244.64403    0  547 -10388.353 2244.64403   122%     -  631s
     0     0 2238.35795    0  553 -10388.353 2238.35795   122%     -  634s
     0     0 2233.42854    0  561 -10388.353 2233.42854   121%     -  638s
     0     0 2230.92440    0  550 -10388.353 2230.92440   121%     -  641s
     0     0 2229.20418    0  552 -10388.353 2229.20418   121%     -  643s
     0     0 2172.64970    0  645 -10388.353 2172.64970   121%     -  656s
     0     0 2153.67771    0  663 -10388.353 2153.67771   121%     -  664s
     0     0 2150.20431    0  663 -10388.353 2150.20431   121%     -  667s
     0     0 2142.54611    0  667 -10388.353 2142.54611   121%     -  671s
     0     0 2129.09643    0  676 -10388.353 2129.09643   120%     -  676s
     0     0 2125.55747    0  680 -10388.353 2125.55747   120%     -  679s
     0     0 2124.68454    0  684 -10388.353 2124.68454   120%     -  682s
     0     0 2026.80824    0  551 -10388.353 2026.80824   120%     -  695s
     0     0 2010.95602    0  552 -10388.353 2010.95602   119%     -  701s
     0     0 2005.97044    0  562 -10388.353 2005.97044   119%     -  705s
     0     0 2005.26735    0  565 -10388.353 2005.26735   119%     -  708s
     0     0 1973.51617    0  557 -10388.353 1973.51617   119%     -  722s
     0     0 1968.68145    0  576 -10388.353 1968.68145   119%     -  730s
     0     0 1966.85827    0  569 -10388.353 1966.85827   119%     -  736s
     0     0 1950.63001    0  575 -10388.353 1950.63001   119%     -  750s
     0     0 1940.52710    0  569 -10388.353 1940.52710   119%     -  759s
     0     0 1938.23993    0  581 -10388.353 1938.23993   119%     -  762s
     0     0 1936.96794    0  582 -10388.353 1936.96794   119%     -  765s
     0     0 1920.84780    0  580 -10388.353 1920.84780   118%     -  772s
     0     0 1916.84687    0  583 -10388.353 1916.84687   118%     -  778s
     0     0 1914.95276    0  582 -10388.353 1914.95276   118%     -  780s
     0     0 1882.31001    0  660 -10388.353 1882.31001   118%     -  787s
     0     0 1877.28224    0  630 -10388.353 1877.28224   118%     -  791s
     0     0 1874.06558    0  571 -10388.353 1874.06558   118%     -  793s
     0     0 1873.56325    0  574 -10388.353 1873.56325   118%     -  795s
     0     0 1846.12139    0  605 -10388.353 1846.12139   118%     -  804s
H    0     0                    -10327.33164 1845.63735   118%     -  814s
H    0     0                    -10164.48131 1845.63735   118%     -  814s
H    0     0                    -9863.698307 1845.63735   119%     -  814s
H    0     0                    -9834.695723 1845.63735   119%     -  814s
H    0     0                    -9140.244818 1845.63735   120%     -  818s
H    0     0                    -8048.041261 1845.63735   123%     -  818s
H    0     0                    -7944.627860 1845.63735   123%     -  820s
     0     0 1826.46665    0  672 -7944.6279 1826.46665   123%     -  828s
     0     0 1825.13025    0  565 -7944.6279 1825.13025   123%     -  831s
     0     0 1815.06309    0  620 -7944.6279 1815.06309   123%     -  836s
H    0     0                    -7941.343755 1815.04875   123%     -  837s
     0     0 1808.40365    0  682 -7941.3438 1808.40365   123%     -  841s
     0     0 1805.88646    0  624 -7941.3438 1805.88646   123%     -  845s
     0     0 1805.61795    0  641 -7941.3438 1805.61795   123%     -  847s
     0     0 1798.24759    0  682 -7941.3438 1798.24759   123%     -  855s
     0     0 1797.03108    0  692 -7941.3438 1797.03108   123%     -  911s
     0     0 1790.54161    0  689 -7941.3438 1790.54161   123%     -  916s
     0     0 1789.50886    0  761 -7941.3438 1789.50886   123%     -  919s
     0     0 1767.74309    0  571 -7941.3438 1767.74309   122%     -  927s
     0     0 1757.65198    0  585 -7941.3438 1757.65198   122%     -  931s
     0     0 1756.13012    0  582 -7941.3438 1756.13012   122%     -  932s
     0     0 1748.98487    0  587 -7941.3438 1748.98487   122%     -  938s
     0     0 1739.86401    0  661 -7941.3438 1739.86401   122%     -  943s
     0     0 1736.59287    0  686 -7941.3438 1736.59287   122%     -  946s
     0     0 1735.39314    0  687 -7941.3438 1735.39314   122%     -  948s
     0     0 1724.05138    0  689 -7941.3438 1724.05138   122%     -  955s
     0     0 1715.00807    0  609 -7941.3438 1715.00807   122%     -  960s
     0     0 1712.52198    0  603 -7941.3438 1712.52198   122%     -  963s
     0     0 1712.20176    0  607 -7941.3438 1712.20176   122%     -  964s
     0     0 1701.85472    0  600 -7941.3438 1701.85472   121%     -  970s
     0     0 1692.95284    0  613 -7941.3438 1692.95284   121%     -  974s
     0     0 1691.56924    0  612 -7941.3438 1691.56924   121%     -  975s
     0     0 1684.87916    0  665 -7941.3438 1684.87916   121%     -  980s
     0     0 1678.54958    0  667 -7941.3438 1678.54958   121%     -  983s
     0     0 1674.89384    0  658 -7941.3438 1674.89384   121%     -  986s
     0     0 1674.50252    0  597 -7941.3438 1674.50252   121%     -  987s
     0     0 1670.81566    0  666 -7941.3438 1670.81566   121%     -  991s
     0     0 1670.67632    0  666 -7941.3438 1670.67632   121%     -  998s
H    0     0                    -7916.493173 1670.42219   121%     - 1069s
     0     2 1670.42219    0  666 -7916.4932 1670.42219   121%     - 1071s
     1     3 1515.35815    1  626 -7916.4932 1670.42219   121%  9260 1079s
     2     4 1636.16824    1  632 -7916.4932 1636.16824   121%  9254 1086s
     3     5 1344.29404    2  576 -7916.4932 1636.13899   121% 10318 1097s
     4     9 1454.44094    2  663 -7916.4932 1635.29172   121% 11058 1112s
     8    18  516.28410    3  525 -7916.4932 1453.68060   118% 11209 1125s
    17    36  366.55898    4  451 -7916.4932 1400.66165   118% 10276 1148s
    35    50 1245.16694    5  644 -7916.4932 1390.05251   118% 12384 1193s
    49    75  202.27858    6  394 -7916.4932 1390.05251   118% 16657 1226s
    74   127 -230.32061    7  388 -7916.4932 1390.05251   118% 13850 1266s
   138   165 -435.25964    9  379 -7916.4932 1390.05251   118% 12303 1298s
   184   231 -735.79773    9  244 -7916.4932 1390.05251   118% 10711 1333s
H  221   231                    -7304.013761 1390.05251   119%  9437 1333s
   256   241     cutoff   13      -7304.0138 1390.05251   119%  8702 1357s
H  259   241                    -7222.079547 1390.05251   119%  8609 1357s
H  263   241                    -7155.358358 1390.05251   119%  8600 1357s
H  264   241                    -6866.563975 1390.05251   120%  8573 1357s
H  266   241                    -6788.650796 1390.05251   120%  8542 1357s
H  290   241                    -6768.692458 1390.05251   121%  8217 1357s
   298   291 -488.29181    9  387 -6768.6925 1390.05251   121%  8049 1386s
   375   308 infeasible    8      -6768.6925 1390.05251   121%  7089 1428s
H  380   308                    -6740.080162 1390.05251   121%  7013 1428s
H  385   308                    -6521.684492 1390.05251   121%  6932 1428s
H  392   308                    -6487.893651 1390.05251   121%  6859 1428s
   420   344 -3958.0231   20  290 -6487.8937 1390.05251   121%  6732 1459s
   496   355 -2123.8940   12  341 -6487.8937 1390.05251   121%  6166 1482s
H  498   355                    -6457.012739 1390.05251   122%  6165 1482s
H  499   355                    -6371.364895 1390.05251   122%  6156 1482s
   531   404 -2301.2382   13  408 -6371.3649 1390.05251   122%  6044 1508s
   604   438 infeasible   28      -6371.3649 1390.05251   122%  5769 1529s
   661   462 -2266.2780   13  334 -6371.3649 1390.05251   122%  5502 1561s
H  665   462                    -6369.734186 1390.05251   122%  5486 1561s
   713   476 -2405.2096   14  399 -6369.7342 1390.05251   122%  5308 1581s
H  714   476                    -6268.105936 1390.05251   122%  5301 1581s
H  714   476                    -6262.449025 1390.05251   122%  5301 1581s
H  724   476                    -6046.718045 1390.05251   123%  5263 1581s
   762   481 -2608.7254   15  389 -6046.7180 1390.05251   123%  5135 1607s
   832   496     cutoff   17      -6046.7180 1390.05251   123%  4975 1630s
   869   544 -2526.8543   15  388 -6046.7180 1390.05251   123%  4894 1654s
   931   582 -2868.6924   17  376 -6046.7180 1390.05251   123%  4780 1675s
  1003   610 -3130.0824   19  316 -6046.7180 1390.05251   123%  4614 1701s
  1045   653 -4324.0037   20  362 -6046.7180 1390.05251   123%  4587 1730s
  1105   671 -4823.0778   21  364 -6046.7180 1390.05251   123%  4528 1758s
  1143   708 -4914.9319   22  341 -6046.7180 1390.05251   123%  4492 1794s
  1188   750 -5140.4314   23  216 -6046.7180 1390.05251   123%  4442 1816s
  1248   804     cutoff   25      -6046.7180 1390.05251   123%  4387 1839s
H 1284   804                    -6041.361358 1390.05251   123%  4324 1839s
  1317   899     cutoff   24      -6041.3614 1390.05251   123%  4272 1872s
  1500   967 infeasible   31      -6041.3614 1390.05251   123%  3976 1903s
  1672  1027 -3445.7396   30  301 -6041.3614 1390.05251   123%  3785 1935s
  1828  1030 -3876.2555   34  276 -6041.3614 1390.05251   123%  3654 1973s
  1933  1066 -4140.2671   35  284 -6041.3614 1390.05251   123%  3603 2016s
  2009  1086 infeasible   38      -6041.3614 1390.05251   123%  3623 2059s
  2100  1102 -5754.8380   41  166 -6041.3614 1390.05251   123%  3633 2095s
  2134  1120 -5795.4725   42  174 -6041.3614 1390.05251   123%  3699 2125s
  2177  1146 infeasible   43      -6041.3614 1390.05251   123%  3737 2160s
  2217  1163 -2597.0542   15  215 -6041.3614 1390.05251   123%  3786 2200s
  2262  1174 -2672.1945   16  207 -6041.3614 1390.05251   123%  3810 2238s
  2319  1203 -2798.8311   17  211 -6041.3614 1390.05251   123%  3810 2274s
  2364  1253 -3026.8551   18  258 -6041.3614 1390.05251   123%  3849 2319s
  2436  1290 -3348.8560   19  268 -6041.3614 1270.34637   121%  3841 2365s
  2524  1342 -3819.6209   21  269 -6041.3614 1270.34637   121%  3846 2414s
  2624  1391 -4274.8272   25  275 -6041.3614 1270.34637   121%  3879 2476s
  2746  1452 -4818.0263   35  164 -6041.3614 1270.34637   121%  3885 2532s
  2849  1511 -5988.4850   48  135 -6041.3614 1270.34637   121%  3940 2586s
  3014  1575 -4684.7305    7  541 -6041.3614  527.13641   109%  3940 2649s
  3144  1651 -5460.1775    9  485 -6041.3614  527.13641   109%  3970 2712s
  3278  1703 infeasible   12      -6041.3614  527.13641   109%  4006 2778s
  3425  1759 -2564.9696   11  206 -6041.3614  527.13641   109%  4053 2849s
  3588  1773 -3603.0399   16  254 -6041.3614 -351.35170  94.2%  4070 2925s
  3784  1839 -5507.9051   23  271 -6041.3614 -351.35170  94.2%  4072 3006s
  3936  1875     cutoff   44      -6041.3614 -736.39935  87.8%  4109 3086s
  4056  1931 -2931.2460   10  438 -6041.3614 -836.31130  86.2%  4176 3156s
  4197  1992     cutoff   12      -6041.3614 -836.31130  86.2%  4214 3232s
  4360  2019 infeasible   12      -6041.3614 -1068.2027  82.3%  4235 3316s
  4507  2051 -4063.6910   10  303 -6041.3614 -1068.2027  82.3%  4308 3403s
  4695  2064 infeasible   12      -6041.3614 -1068.2027  82.3%  4349 3488s
H 4764  2064                    -6037.541159 -1154.3298  80.9%  4360 3488s
  4786  2106 -3192.4491   11  259 -6037.5412 -1154.3298  80.9%  4376 3580s
  4938  2117 infeasible   15      -6037.5412 -1341.2892  77.8%  4460 3600s

Cutting planes:
  Learned: 5
  Gomory: 3
  Implied bound: 259
  MIR: 3686
  Flow cover: 3680
  Zero half: 13
  RLT: 78
  Relax-and-lift: 442

Explored 4997 nodes (23181971 simplex iterations) in 3600.05 seconds (8069.34 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -6037.54 -6041.36 -6046.72 ... -6521.68

Time limit reached
Best objective -6.037541158510e+03, best bound -1.341289195597e+03, gap 77.7842%
  WARNING: Time limit reached. Using best solution found (gap: 77.78%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = -6037.54, θ = 109981.92
  Upper Bound (UB) = -6037.54

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 109981.92
  [DEBUG]   ✓ Scenario 0: θ = 109981.92 ≤ Q = 109981.92 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 109981.92 ≤ Q = 109981.92 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 109981.92 ≤ Q = 109981.92 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 109981.92 ≤ Q = 109981.92 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 109981.92 ≤ Q = 109981.92 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 109981.92 ≤ Q = 109981.92 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 109981.92 ≤ Q = 109981.92 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 109981.92 ≤ Q = 109981.92 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 109981.92 ≤ Q = 109981.92 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 109981.92 ≤ Q = 109981.92 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 109981.92 ≤ Q = 109981.92 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 109981.92 ≤ Q = 109981.92 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 109981.92 ≤ Q = 109981.92 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 109981.92 ≤ Q = 109981.92 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 109981.92 ≤ Q = 109981.92 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 109981.92 ≤ Q = 109981.92 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 109981.92 ≤ Q = 109981.92 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 17] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x6b6f9b7b
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x94906485
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.185791e+13
Presolve removed 2608 rows and 1900 columns
Presolve time: 0.00s
Presolved: 485 rows, 489 columns, 1368 nonzeros
Found heuristic solution: objective 6014365.4378
Variable types: 330 continuous, 159 integer (159 binary)

Root relaxation: objective -1.190596e+05, 229 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -119059.63    0  120 6014365.44 -119059.63   102%     -    0s
H    0     0                    -77034.42117 -119059.63  54.6%     -    0s
H    0     0                    -77853.93104 -118822.37  52.6%     -    0s
     0     0 -93411.676    0   95 -77853.931 -93411.676  20.0%     -    0s
H    0     0                    -89634.55255 -93294.508  4.08%     -    0s
H    0     0                    -89936.48221 -93294.508  3.73%     -    0s
H    0     0                    -90310.34683 -93294.508  3.30%     -    0s
H    0     0                    -90612.27649 -93294.508  2.96%     -    0s
     0     0 -92821.523    0   96 -90612.276 -92821.523  2.44%     -    0s
H    0     0                    -90805.03938 -92766.540  2.16%     -    0s
     0     0 -92523.810    0   96 -90805.039 -92523.810  1.89%     -    0s
     0     0 -92486.730    0   96 -90805.039 -92486.730  1.85%     -    0s
     0     0 -92484.847    0   96 -90805.039 -92484.847  1.85%     -    0s
     0     0 -92220.914    0   96 -90805.039 -92220.914  1.56%     -    0s
     0     0 -92193.558    0   95 -90805.039 -92193.558  1.53%     -    0s
     0     0 -92191.578    0   96 -90805.039 -92191.578  1.53%     -    0s
     0     0 -92088.113    0   96 -90805.039 -92088.113  1.41%     -    0s
     0     0 -92086.924    0   96 -90805.039 -92086.924  1.41%     -    0s
     0     2 -92086.310    0   96 -90805.039 -92086.310  1.41%     -    0s
H  338   214                    -90857.57691 -91511.637  0.72%   7.8    0s
H  423   281                    -90879.51739 -91511.637  0.70%   6.9    0s
H  428   281                    -90953.60856 -91402.010  0.49%   6.8    0s
H 1630    75                    -90974.68041 -91088.703  0.13%   5.2    0s
* 1914     0              33    -90980.36366 -91052.158  0.08%   5.2    0s

Cutting planes:
  Gomory: 60
  Implied bound: 2
  MIR: 247
  RLT: 5
  BQP: 1

Explored 1954 nodes (10614 simplex iterations) in 0.10 seconds (0.11 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -90980.4 -90953.6 -90879.5 ... 6.01437e+06
No other solutions better than -90980.4

Optimal solution found (tolerance 1.00e-04)
Best objective -9.098036366035e+04, best bound -9.098036366035e+04, gap 0.0000%
  Subproblem solved in 0.12s
  Worst-case operational profit (Z_SP) = 107914.54
  Scenario: 15 demand increases, 45 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -90980.36
  [DEBUG]   S×d_nominal = 198894.90
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 198894.90 + -90980.36 = 107914.54
  [DEBUG]   Current θ from Master = 109981.92
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2067.38 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -8104.92
  Lower Bound (LB) = -8104.92
  Gap (UB-LB) = 2067.3813, Absolute Gap = 2067.3813, Relative Gap = 0.342421
  Not converged yet (gap = 2067.38 > ε = 200)

  [DEBUG] Adding NEW scenario 17 to Master Problem...
  [DEBUG] New scenario pattern: 15 increases, 45 decreases
    [DEBUG] Scenario 17 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 17 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 17]
    [DEBUG]   - Total constraints in model: 276603
    [DEBUG]   - Total variables in model: 114580
  [DEBUG] Total scenarios in Master: 18
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 18
================================================================================
[Iteration 18] Solving Master Problem...
  Current scenarios in Master: 18
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 276603 rows, 114580 columns and 783677 nonzeros
Model fingerprint: 0x54970408
Variable types: 112321 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [9e-02, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 127620 rows and 51840 columns
Presolve time: 2.05s
Presolved: 148983 rows, 62740 columns, 919059 nonzeros
Variable types: 60481 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -371500.8959
Found heuristic solution: objective -172304.4497

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.39s

Barrier statistics:
 Dense cols : 632
 AA' NZ     : 8.013e+06
 Factor NZ  : 1.785e+07 (roughly 230 MB of memory)
 Factor Ops : 4.422e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.67654793e+07  2.29784197e+08  8.73e+04 2.26e+01  6.64e+04     4s
   1  -1.26102451e+07  1.99625448e+08  6.09e+04 4.48e+01  4.60e+04     4s
   2  -4.21326051e+06  1.62057435e+08  1.92e+04 1.02e+01  1.53e+04     4s
   3  -6.88788573e+05  1.14599850e+08  9.41e+02 1.45e+00  1.13e+03     4s
   4  -5.27855906e+05  8.24771993e+07  3.19e+02 9.73e-01  5.28e+02     4s
   5  -4.70260476e+05  5.40836628e+07  1.52e+02 5.86e-01  2.98e+02     4s
   6  -4.20917106e+05  4.01862295e+07  5.59e+01 4.15e-01  1.82e+02     4s
   7  -3.76662195e+05  2.75416156e+07  1.93e+01 2.73e-01  1.12e+02     4s
   8  -3.00546669e+05  2.03155474e+07  5.50e+00 1.97e-01  7.80e+01     4s
   9  -2.18577189e+05  9.57247150e+06  1.42e+00 9.09e-02  3.63e+01     4s
  10  -1.50046732e+05  3.37881043e+06  7.48e-01 3.13e-02  1.30e+01     4s
  11  -1.11777323e+05  2.57008334e+06  4.53e-01 2.38e-02  9.90e+00     4s
  12  -8.65001400e+04  1.98491789e+06  2.39e-01 1.84e-02  7.63e+00     4s
  13  -7.79002079e+04  1.54271237e+06  1.93e-01 1.41e-02  5.97e+00     4s
  14  -5.00809545e+04  8.59305415e+05  7.28e-02 7.52e-03  3.35e+00     4s
  15  -3.01817213e+04  2.57734611e+05  3.18e-02 2.11e-03  1.06e+00     5s
  16  -2.33952777e+04  1.68468387e+05  2.54e-02 1.65e-03  7.06e-01     5s
  17  -1.92363101e+04  1.18463271e+05  2.20e-02 1.55e-03  5.07e-01     5s
  18  -1.05535350e+04  8.95557315e+04  1.49e-02 1.13e-03  3.68e-01     5s
  19  -3.90494914e+03  5.93004505e+04  1.01e-02 6.73e-04  2.33e-01     5s
  20  -2.02459856e+03  4.64636880e+04  8.92e-03 5.22e-04  1.78e-01     5s
  21   4.92359785e+02  4.13298883e+04  7.34e-03 4.39e-04  1.50e-01     5s
  22   2.84993154e+03  3.69498208e+04  5.90e-03 3.74e-04  1.26e-01     5s
  23   4.99069821e+03  3.09670236e+04  4.69e-03 2.71e-04  9.56e-02     5s
  24   6.18761687e+03  2.61866849e+04  4.08e-03 1.91e-04  7.36e-02     5s
  25   8.69194413e+03  2.34279718e+04  2.83e-03 1.62e-04  5.42e-02     5s
  26   9.84123400e+03  2.15323595e+04  2.29e-03 1.20e-04  4.30e-02     5s
  27   1.11343225e+04  1.97108053e+04  1.69e-03 8.51e-05  3.16e-02     5s
  28   1.21546780e+04  1.87862262e+04  1.24e-03 6.82e-05  2.44e-02     5s
  29   1.25994750e+04  1.78673670e+04  1.05e-03 5.22e-05  1.94e-02     5s
  30   1.30879005e+04  1.72020261e+04  8.43e-04 3.94e-05  1.51e-02     6s
  31   1.35580188e+04  1.64325162e+04  6.45e-04 2.39e-05  1.06e-02     6s
  32   1.38709134e+04  1.60120846e+04  5.12e-04 1.62e-05  7.88e-03     6s
  33   1.41640681e+04  1.57660333e+04  3.96e-04 1.14e-05  5.90e-03     6s
  34   1.42958396e+04  1.56543391e+04  3.42e-04 9.23e-06  5.00e-03     6s
  35   1.44186669e+04  1.55212825e+04  2.91e-04 6.49e-06  4.06e-03     6s
  36   1.46203142e+04  1.54611853e+04  2.09e-04 5.26e-06  3.10e-03     6s
  37   1.46758809e+04  1.53378271e+04  1.88e-04 3.18e-06  2.44e-03     6s
  38   1.49117313e+04  1.52895914e+04  9.31e-05 2.23e-06  1.39e-03     6s
  39   1.49710169e+04  1.52551985e+04  6.95e-05 1.51e-06  1.05e-03     6s
  40   1.50142459e+04  1.52382457e+04  5.34e-05 1.22e-06  8.25e-04     6s
  41   1.50711148e+04  1.52097713e+04  3.32e-05 7.55e-07  5.10e-04     6s
  42   1.50911285e+04  1.51804852e+04  2.57e-05 2.72e-07  3.29e-04     6s
  43   1.51467794e+04  1.51746400e+04  5.29e-06 1.76e-07  1.03e-04     6s
  44   1.51562978e+04  1.51668354e+04  2.37e-06 4.68e-08  3.88e-05     6s
  45   1.51599122e+04  1.51648781e+04  1.25e-06 1.18e-08  1.83e-05     7s
  46   1.51630916e+04  1.51642405e+04  2.86e-07 1.41e-09  4.23e-06     7s
  47   1.51638065e+04  1.51641311e+04  8.55e-08 6.39e-08  1.20e-06     7s
  48   1.51638079e+04  1.51641310e+04  5.91e-06 6.64e-08  1.19e-06     7s
  49   1.51638323e+04  1.51641779e+04  4.87e-06 2.49e-08  1.27e-06     7s
  50   1.51639952e+04  1.51641171e+04  2.07e-06 2.46e-09  4.48e-07     7s
  51   1.51640261e+04  1.51641162e+04  1.54e-06 1.15e-09  3.31e-07     7s
  52   1.51640313e+04  1.51641161e+04  2.52e-06 5.44e-09  3.11e-07     7s
  53   1.51640338e+04  1.51641161e+04  3.70e-06 3.72e-09  3.02e-07     7s
  54   1.51641114e+04  1.51641159e+04  2.03e-07 1.06e-07  1.65e-08     7s
  55   1.51641159e+04  1.51641159e+04  6.03e-09 1.86e-08  5.45e-11     7s

Barrier solved model in 55 iterations and 7.03 seconds (16.82 work units)
Optimal objective 1.51641159e+04


Root crossover log...

  121468 DPushes remaining with DInf 0.0000000e+00                 7s
    2352 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                11s

    4373 PPushes remaining with PInf 1.3149585e-05                11s
       0 PPushes remaining with PInf 0.0000000e+00                11s

  Push phase complete: Pinf 0.0000000e+00, Dinf 4.4942558e-01     11s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   56474    1.5164116e+04   0.000000e+00   4.494256e-01     11s
   56477    1.5164116e+04   0.000000e+00   0.000000e+00     11s
   56477    1.5164116e+04   0.000000e+00   0.000000e+00     11s
Concurrent spin time: 2.90s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 1.516412e+04, 56477 iterations, 10.98 seconds (24.81 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 15164.1159    0  369 -172304.45 15164.1159   109%     -   14s
H    0     0                    -169934.6952 15164.1159   109%     -   14s
H    0     0                    -120691.5904 15164.1159   113%     -   14s
H    0     0                    -120613.6382 15164.1159   113%     -   14s
H    0     0                    -116877.3757 15164.1159   113%     -   14s
H    0     0                    -114628.7756 15164.1159   113%     -   14s
H    0     0                    -113935.5650 15164.1159   113%     -   14s
H    0     0                    -79357.04551 15164.1159   119%     -   14s
H    0     0                    -79214.07174 15164.1159   119%     -   15s
H    0     0                    -78967.23893 15164.1159   119%     -   15s
H    0     0                    -44444.43072 15164.1159   134%     -   15s
     0     0 8378.52982    0  330 -44444.431 8378.52982   119%     -   52s
H    0     0                    -38978.29918 8377.60224   121%     -   53s
H    0     0                    -36950.07051 8377.60224   123%     -   53s
H    0     0                    -36300.93344 8377.60224   123%     -   53s
     0     0 8263.63240    0  380 -36300.933 8263.63240   123%     -   63s
     0     0 8240.68682    0  401 -36300.933 8240.68682   123%     -   70s
     0     0 8237.12428    0  379 -36300.933 8237.12428   123%     -   74s
     0     0 8189.75689    0  394 -36300.933 8189.75689   123%     -   82s
     0     0 8163.17826    0  395 -36300.933 8163.17826   122%     -   88s
     0     0 8111.76529    0  389 -36300.933 8111.76529   122%     -   93s
     0     0 8045.15522    0  329 -36300.933 8045.15522   122%     -   97s
     0     0 8043.08127    0  331 -36300.933 8043.08127   122%     -   98s
     0     0 8035.82835    0  328 -36300.933 8035.82835   122%     -  102s
     0     0 7996.59146    0  375 -36300.933 7996.59146   122%     -  107s
     0     0 7982.99360    0  391 -36300.933 7982.99360   122%     -  112s
     0     0 7894.99587    0  380 -36300.933 7894.99587   122%     -  122s
     0     0 7885.04191    0  395 -36300.933 7885.04191   122%     -  126s
     0     0 7821.63476    0  379 -36300.933 7821.63476   122%     -  136s
     0     0 7818.24093    0  382 -36300.933 7818.24093   122%     -  139s
     0     0 7816.77668    0  382 -36300.933 7816.77668   122%     -  140s
     0     0 7816.77622    0  382 -36300.933 7816.77622   122%     -  140s
     0     0 6348.17047    0  425 -36300.933 6348.17047   117%     -  179s
H    0     0                    -27949.05423 6348.16207   123%     -  179s
H    0     0                    -17087.61681 6348.16207   137%     -  179s
H    0     0                    -16987.13848 6348.16207   137%     -  179s
     0     0 5862.56224    0  490 -16987.138 5862.56224   135%     -  209s
     0     0 5586.79225    0  416 -16987.138 5586.79225   133%     -  230s
     0     0 5570.05906    0  424 -16987.138 5570.05906   133%     -  236s
     0     0 5487.84184    0  416 -16987.138 5487.84184   132%     -  244s
     0     0 5481.76380    0  422 -16987.138 5481.76380   132%     -  250s
     0     0 5475.31425    0  424 -16987.138 5475.31425   132%     -  253s
     0     0 5439.69559    0  434 -16987.138 5439.69559   132%     -  262s
     0     0 5430.57153    0  443 -16987.138 5430.57153   132%     -  269s
     0     0 5394.13399    0  439 -16987.138 5394.13399   132%     -  278s
     0     0 5385.92504    0  434 -16987.138 5385.92504   132%     -  285s
     0     0 5380.24478    0  442 -16987.138 5380.24478   132%     -  287s
     0     0 5369.00506    0  448 -16987.138 5369.00506   132%     -  290s
     0     0 5354.56613    0  447 -16987.138 5354.56613   132%     -  295s
     0     0 5337.28337    0  444 -16987.138 5337.28337   131%     -  301s
     0     0 5337.15510    0  446 -16987.138 5337.15510   131%     -  302s
     0     0 4264.79616    0  555 -16987.138 4264.79616   125%     -  360s
H    0     0                    -16849.88487 4263.68920   125%     -  361s
H    0     0                    -16799.62506 4263.68920   125%     -  361s
H    0     0                    -16723.18816 4263.68920   125%     -  361s
     0     0 3965.43161    0  505 -16723.188 3965.43161   124%     -  379s
     0     0 3878.06446    0  514 -16723.188 3878.06446   123%     -  397s
     0     0 3832.31840    0  571 -16723.188 3832.31840   123%     -  411s
     0     0 3806.83550    0  502 -16723.188 3806.83550   123%     -  421s
     0     0 3785.81448    0  569 -16723.188 3785.81448   123%     -  429s
     0     0 3771.69951    0  505 -16723.188 3771.69951   123%     -  435s
     0     0 3756.53994    0  568 -16723.188 3756.53994   122%     -  441s
     0     0 3746.74042    0  565 -16723.188 3746.74042   122%     -  448s
     0     0 3733.26035    0  569 -16723.188 3733.26035   122%     -  453s
     0     0 3727.84494    0  569 -16723.188 3727.84494   122%     -  458s
     0     0 3710.86886    0  571 -16723.188 3710.86886   122%     -  467s
     0     0 3707.04531    0  578 -16723.188 3707.04531   122%     -  472s
     0     0 3695.51264    0  582 -16723.188 3695.51264   122%     -  478s
     0     0 3686.62894    0  577 -16723.188 3686.62894   122%     -  483s
     0     0 3686.41522    0  578 -16723.188 3686.41522   122%     -  484s
     0     0 3198.48256    0  509 -16723.188 3198.48256   119%     -  517s
     0     0 3095.52539    0  515 -16723.188 3095.52539   119%     -  528s
     0     0 3076.92783    0  533 -16723.188 3076.92783   118%     -  534s
     0     0 3046.02857    0  534 -16723.188 3046.02857   118%     -  540s
     0     0 3026.44235    0  531 -16723.188 3026.44235   118%     -  544s
     0     0 3022.09472    0  536 -16723.188 3022.09472   118%     -  546s
     0     0 3001.57971    0  525 -16723.188 3001.57971   118%     -  551s
     0     0 2959.36187    0  507 -16723.188 2959.36187   118%     -  556s
     0     0 2942.95475    0  531 -16723.188 2942.95475   118%     -  562s
     0     0 2929.80319    0  534 -16723.188 2929.80319   118%     -  567s
     0     0 2925.64507    0  540 -16723.188 2925.64507   117%     -  571s
     0     0 2923.64054    0  536 -16723.188 2923.64054   117%     -  574s
     0     0 2920.19040    0  543 -16723.188 2920.19040   117%     -  578s
     0     0 2919.05176    0  538 -16723.188 2919.05176   117%     -  579s
     0     0 2758.57799    0  533 -16723.188 2758.57799   116%     -  595s
     0     0 2696.73663    0  611 -16723.188 2696.73663   116%     -  609s
     0     0 2666.29457    0  624 -16723.188 2666.29457   116%     -  617s
     0     0 2653.20599    0  617 -16723.188 2653.20599   116%     -  622s
     0     0 2649.01738    0  617 -16723.188 2649.01738   116%     -  625s
     0     0 2645.40699    0  611 -16723.188 2645.40699   116%     -  629s
     0     0 2635.63417    0  619 -16723.188 2635.63417   116%     -  633s
     0     0 2631.97860    0  619 -16723.188 2631.97860   116%     -  635s
     0     0 2629.92940    0  623 -16723.188 2629.92940   116%     -  637s
     0     0 2627.17354    0  620 -16723.188 2627.17354   116%     -  639s
     0     0 2601.80959    0  630 -16723.188 2601.80959   116%     -  643s
     0     0 2594.09989    0  632 -16723.188 2594.09989   116%     -  649s
     0     0 2590.63473    0  628 -16723.188 2590.63473   115%     -  651s
     0     0 2586.79879    0  626 -16723.188 2586.79879   115%     -  653s
     0     0 2586.57515    0  626 -16723.188 2586.57515   115%     -  655s
     0     0 2439.20547    0  596 -16723.188 2439.20547   115%     -  669s
H    0     0                    -10537.06020 2438.85434   123%     -  681s
H    0     0                    -10409.36678 2438.85434   123%     -  681s
H    0     0                    -10374.24421 2438.85434   124%     -  682s
H    0     0                    -10352.02490 2438.85434   124%     -  682s
H    0     0                    -10211.18670 2438.85434   124%     -  682s
H    0     0                    -10188.96739 2438.85434   124%     -  682s
H    0     0                    -10179.70557 2438.85434   124%     -  682s
H    0     0                    -10141.28648 2438.85434   124%     -  682s
H    0     0                    -9915.058294 2438.85434   125%     -  683s
H    0     0                    -9479.354071 2438.85434   126%     -  683s
     0     0 2391.96621    0  542 -9479.3541 2391.96621   125%     -  692s
     0     0 2364.52530    0  531 -9479.3541 2364.52530   125%     -  697s
     0     0 2271.64727    0  547 -9479.3541 2271.64727   124%     -  705s
     0     0 2266.89728    0  548 -9479.3541 2266.89728   124%     -  709s
     0     0 2266.44261    0  551 -9479.3541 2266.44261   124%     -  710s
     0     0 2117.74593    0  602 -9479.3541 2117.74593   122%     -  723s
H    0     0                    -9231.921202 2116.55578   123%     -  724s
     0     0 2100.51883    0  605 -9231.9212 2100.51883   123%     -  730s
     0     0 2093.58269    0  610 -9231.9212 2093.58269   123%     -  733s
     0     0 2090.91492    0  605 -9231.9212 2090.91492   123%     -  736s
     0     0 2089.78801    0  606 -9231.9212 2089.78801   123%     -  738s
     0     0 2053.74983    0  605 -9231.9212 2053.74983   122%     -  749s
H    0     0                    -9167.847194 2052.83316   122%     -  752s
H    0     0                    -9117.896836 2052.83316   123%     -  752s
H    0     0                    -9112.226485 2052.83316   123%     -  753s
     0     0 2027.20929    0  606 -9112.2265 2027.20929   122%     -  763s
     0     0 2022.03466    0  618 -9112.2265 2022.03466   122%     -  767s
     0     0 2017.70344    0  617 -9112.2265 2017.70344   122%     -  771s
     0     0 2014.47770    0  617 -9112.2265 2014.47770   122%     -  775s
     0     0 2008.19398    0  624 -9112.2265 2008.19398   122%     -  778s
     0     0 2005.50349    0  628 -9112.2265 2005.50349   122%     -  781s
     0     0 2002.90052    0  628 -9112.2265 2002.90052   122%     -  783s
     0     0 2002.46699    0  630 -9112.2265 2002.46699   122%     -  783s
     0     0 1967.25315    0  630 -9112.2265 1967.25315   122%     -  796s
     0     0 1959.52110    0  632 -9112.2265 1959.52110   122%     -  801s
     0     0 1958.14265    0  573 -9112.2265 1958.14265   121%     -  803s
     0     0 1921.64478    0  605 -9112.2265 1921.64478   121%     -  813s
H    0     0                    -9019.082854 1921.47479   121%     -  829s
H    0     0                    -9003.826018 1921.47479   121%     -  830s
H    0     0                    -8999.967035 1921.47479   121%     -  830s
H    0     0                    -8744.417201 1921.47479   122%     -  830s
H    0     0                    -8595.559928 1921.47479   122%     -  830s
H    0     0                    -8502.692757 1921.47479   123%     -  830s
H    0     0                    -8498.833773 1921.47479   123%     -  831s
H    0     0                    -8497.001865 1921.47479   123%     -  831s
H    0     0                    -8315.763804 1921.47479   123%     -  831s
     0     0 1914.89784    0  617 -8315.7638 1914.89784   123%     -  836s
     0     0 1912.89728    0  568 -8315.7638 1912.89728   123%     -  839s
     0     0 1911.90439    0  618 -8315.7638 1911.90439   123%     -  841s
     0     0 1900.80669    0  614 -8315.7638 1900.80669   123%     -  848s
H    0     0                    -8301.750453 1900.59067   123%     -  849s
H    0     0                    -8296.059562 1900.59067   123%     -  849s
     0     0 1897.76597    0  575 -8296.0596 1897.76597   123%     -  851s
     0     0 1897.66534    0  571 -8296.0596 1897.66534   123%     -  854s
     0     0 1888.87593    0  609 -8296.0596 1888.87593   123%     -  859s
H    0     0                    -8286.493617 1888.75550   123%     -  860s
H    0     0                    -8282.634634 1888.75550   123%     -  863s
H    0     0                    -8280.802726 1888.75550   123%     -  863s
     0     0 1872.06441    0  602 -8280.8027 1872.06441   123%     -  867s
     0     0 1869.92297    0  565 -8280.8027 1869.92297   123%     -  869s
     0     0 1869.11645    0  566 -8280.8027 1869.11645   123%     -  870s
     0     0 1858.59480    0  680 -8280.8027 1858.59480   122%     -  875s
     0     0 1856.96030    0  675 -8280.8027 1856.96030   122%     -  877s
     0     0 1852.38470    0  631 -8280.8027 1852.38470   122%     -  882s
     0     0 1850.12176    0  570 -8280.8027 1850.12176   122%     -  883s
     0     0 1850.09447    0  572 -8280.8027 1850.09447   122%     -  884s
     0     0 1842.80833    0  568 -8280.8027 1842.80833   122%     -  888s
     0     0 1834.59988    0  562 -8280.8027 1834.59988   122%     -  891s
     0     0 1834.02213    0  569 -8280.8027 1834.02213   122%     -  892s
     0     0 1833.16866    0  563 -8280.8027 1833.16866   122%     -  896s
     0     0 1832.58714    0  561 -8280.8027 1832.58714   122%     -  897s
     0     0 1831.12067    0  568 -8280.8027 1831.12067   122%     -  902s
     0     0 1831.07211    0  568 -8280.8027 1831.07211   122%     -  908s
H    0     0                    -8178.927109 1831.07211   122%     -  926s
H    0     0                    -8149.350763 1831.07211   122%     -  973s
H    0     0                    -8146.927142 1831.07211   122%     -  987s
H    0     0                    -8077.642394 1831.07211   123%     -  987s
H    0     0                    -8035.157762 1831.07211   123%     -  989s
     0     2 1831.07211    0  568 -8035.1578 1831.07211   123%     -  990s
     1     4 1812.76248    1  564 -8035.1578 1831.07211   123%  2431  998s
     3     7 1429.21558    2  534 -8035.1578 1811.45559   123%  6651 1011s
     6    12 1272.95963    3  532 -8035.1578 1810.55530   123%  9417 1022s
    11    23 1129.26010    4  538 -8035.1578 1657.69628   121% 10165 1038s
    22    34 1067.15578    4  542 -8035.1578 1657.69628   121% 13504 1084s
    33    66   20.34612    5  443 -8035.1578 1288.46650   116% 16653 1231s
    65   149  -79.24057    6  502 -8035.1578 1239.35995   115% 24819 1292s
   150   176  -95.31495    9  491 -8035.1578 1229.18927   115% 15497 1321s
   181   214 -121.80285   10  482 -8035.1578 1229.18927   115% 14632 1350s
H  184   214                    -8019.900926 1229.18927   115% 14491 1350s
H  192   214                    -8009.481899 1229.18927   115% 14030 1350s
   223   251 -664.68477   11  379 -8009.4819 1229.18927   115% 13545 1383s
H  224   251                    -6911.488701 1229.18927   118% 13485 1383s
H  246   251                    -6517.286571 1229.18927   119% 13141 1383s
   266   326 -696.89540   12  388 -6517.2866 1229.18927   119% 12926 1416s
H  341   362                    -6488.630212 1229.18927   119% 12581 1442s
H  342   362                    -6393.043022 1229.18927   119% 12548 1442s
H  350   362                    -6265.566266 1229.18927   120% 12348 1442s
   381   411 -1129.8793   17  365 -6265.5663 1229.18927   120% 12343 1482s
   442   494 -1375.5340   19  376 -6265.5663 1229.18927   120% 11965 1509s
H  534   543                    -6248.448532 1229.18927   120% 11135 1531s
H  536   543                    -6188.676694 1229.18927   120% 11105 1531s
H  540   543                    -6179.200111 1229.18927   120% 11068 1531s
   602   603 -1697.0384   24  441 -6179.2001 1229.18927   120% 10709 1551s
   679   657 -1728.2204   27  359 -6179.2001 1229.18927   120% 10416 1574s
   750   719 -2000.0592   28  367 -6179.2001 1229.18927   120% 10095 1593s
   836   757 -2216.6836   30  272 -6179.2001 1085.95228   118%  9727 1615s
H  849   757                    -6173.339248 1085.95228   118%  9685 1615s
H  865   757                    -6115.806068 1085.95228   118%  9577 1615s
   914   791 -2475.5750   33  350 -6115.8061 1085.95228   118%  9512 1636s
   988   821 -3087.5531   36  287 -6115.8061 1085.95228   118%  9212 1659s
  1062   859 -4641.8372   40  260 -6115.8061 1085.95228   118%  9121 1692s
  1116   912 -5171.0741   47  175 -6115.8061  850.83940   114%  9105 1742s
  1183   981 -5942.6201   51  300 -6115.8061  841.26620   114%  9167 1767s
H 1264   981                    -6114.153446  841.26620   114%  8958 1767s
  1273  1066 -3604.9189   26  173 -6114.1534  841.26620   114%  8963 1795s
  1380  1152 -4954.4823   30  337 -6114.1534  841.26620   114%  8767 1821s
  1494  1236 -5635.5704   36  225 -6114.1534  841.26620   114%  8594 1848s
  1626  1344     cutoff   45      -6114.1534  841.26620   114%  8342 1877s
  1780  1430 infeasible   25      -6114.1534  841.26620   114%  8117 1906s
  1940  1451 infeasible   26      -6114.1534  696.66562   111%  7884 1949s
  1980  1477 -1514.3257   10  401 -6114.1534  696.66562   111%  7884 1972s
H 1984  1477                    -6110.392537  696.66562   111%  7876 1972s
H 1990  1477                    -6085.804393  696.66562   111%  7873 1972s
  2018  1550 -1541.1005   11  409 -6085.8044  696.66562   111%  7886 2004s
  2183  1610 -2032.1916   14  459 -6085.8044  696.66562   111%  7746 2038s
  2331  1677 -2308.2682   13  296 -6085.8044  696.66562   111%  7642 2073s
  2493  1772 -2032.9138   12  471 -6085.8044  696.66562   111%  7586 2111s
  2636  1857 infeasible   16      -6085.8044  276.56032   105%  7556 2150s
  2798  1922 -2455.5377    8  373 -6085.8044  276.56032   105%  7567 2193s
  2940  2004 -3148.9569   10  269 -6085.8044   72.98955   101%  7624 2234s
  3098  2017 -3921.2961   14  264 -6085.8044   72.98955   101%  7607 2271s
  3141  2044 -4318.3924   15  259 -6085.8044    3.53767   100%  7670 2306s
  3180  2071 -4330.2130   16  258 -6085.8044 -102.58703  98.3%  7695 2347s
  3227  2097 -4911.1594   17  242 -6085.8044 -126.14566  97.9%  7732 2384s
  3281  2141 -5037.8324   18  218 -6085.8044 -134.85432  97.8%  7769 2421s
  3390  2200 -5118.0049   19  217 -6085.8044 -168.47354  97.2%  7722 2466s
  3507  2258 -5198.8078   20  206 -6085.8044 -221.33253  96.4%  7735 2518s
  3641  2353 -5215.2692   21  204 -6085.8044 -221.33253  96.4%  7722 2571s
  3806  2365     cutoff   36      -6085.8044 -226.09164  96.3%  7727 2627s
H 3824  2363                    -6079.100817 -226.09164  96.3%  7744 2627s
H 3852  2361                    -6067.345691 -257.12880  95.8%  7797 2627s
  3853  2459 -1277.1913    8  421 -6067.3457 -257.12880  95.8%  7800 2683s
  4065  2555 -2791.3660   13  185 -6067.3457 -277.10355  95.4%  7795 2739s
  4253  2629 -3794.8295   16  180 -6067.3457 -297.16155  95.1%  7843 2798s
  4442  2708 -5849.9923   19  207 -6067.3457 -297.16155  95.1%  7906 2864s
  4614  2709 -1588.7836   11  568 -6067.3457 -297.16155  95.1%  7980 3148s
  4616  2710 -2209.6244   14  394 -6067.3457 -297.16155  95.1%  7977 3172s
  4617  2711 -4671.6645   26  505 -6067.3457 -297.16155  95.1%  7975 3274s
  4618  2712 -5049.5932   25  521 -6067.3457 -297.16155  95.1%  7973 3326s
  4619  2712 -6026.3118   28  579 -6067.3457 -297.16155  95.1%  7972 3359s
  4620  2713 -5567.3350   36  529 -6067.3457 -297.16155  95.1%  7970 3381s
  4621  2714 -4314.5965   20  545 -6067.3457 -297.16155  95.1%  7968 3399s
  4622  2714 -4327.5127   35  548 -6067.3457 -297.16155  95.1%  7966 3412s
  4623  2715 -1871.2269   15  610 -6067.3457 -297.16155  95.1%  7965 3427s
  4624  2716 -5095.1181   24  613 -6067.3457 -297.16155  95.1%  7963 3435s
  4625  2716 -2187.0710   18  610 -6067.3457 -297.16155  95.1%  7961 3445s
  4626  2717 -4662.0875   42  622 -6067.3457 -297.16155  95.1%  7960 3454s
  4627  2718 -4039.7957   14  620 -6067.3457 -297.16155  95.1%  7958 3462s
  4628  2718 -5194.9303   38  610 -6067.3457 -297.16155  95.1%  7956 3468s
  4629  2719 -1244.7356    9  622 -6067.3457 -297.16155  95.1%  7954 3476s
  4630  2720 -3394.4633   13  575 -6067.3457 -297.16155  95.1%  7953 3503s
  4631  2720 -4997.2011   21  556 -6067.3457 -297.16155  95.1%  7951 3512s
  4632  2721 -4142.5549   30  563 -6067.3457 -297.16155  95.1%  7949 3518s
  4633  2722 -937.63491   14  561 -6067.3457 -297.16155  95.1%  7948 3526s
  4634  2722 -4599.2815   32  568 -6067.3457 -297.16155  95.1%  7946 3546s
  4635  2723 -1889.6920   22  555 -6067.3457 -297.16155  95.1%  7944 3555s
  4636  2724 -3668.0982   22  571 -6067.3457 -297.16155  95.1%  7942 3562s
  4637  2724 -4332.5331   17  626 -6067.3457 -297.16155  95.1%  7941 3587s
  4638  2725 -1701.8288   19  556 -6067.3457 -297.16155  95.1%  7939 3595s

Cutting planes:
  Gomory: 1
  Implied bound: 2
  Projected implied bound: 264
  MIR: 1320
  Mixing: 3
  Flow cover: 1259
  Zero half: 7
  RLT: 25
  Relax-and-lift: 137

Explored 4638 nodes (38121676 simplex iterations) in 3600.06 seconds (8929.31 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -6067.35 -6079.1 -6085.8 ... -6248.45

Time limit reached
Best objective -6.067345690523e+03, best bound -2.971615496691e+02, gap 95.1023%
  WARNING: Time limit reached. Using best solution found (gap: 95.10%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3600.21s
  Master Objective (UB) = -6067.35, θ = 109979.70
  Upper Bound (UB) = -6067.35

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 109979.70
  [DEBUG]   ✓ Scenario 0: θ = 109979.70 ≤ Q = 109979.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 109979.70 ≤ Q = 109979.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 109979.70 ≤ Q = 109979.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 109979.70 ≤ Q = 109979.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 109979.70 ≤ Q = 109979.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 109979.70 ≤ Q = 109979.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 109979.70 ≤ Q = 109979.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 109979.70 ≤ Q = 109979.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 109979.70 ≤ Q = 109979.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 109979.70 ≤ Q = 109979.70 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 109979.70 ≤ Q = 109979.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 109979.70 ≤ Q = 109979.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 109979.70 ≤ Q = 109979.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 109979.70 ≤ Q = 109979.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 109979.70 ≤ Q = 109979.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 109979.70 ≤ Q = 109979.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 109979.70 ≤ Q = 109979.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 109979.70 ≤ Q = 109979.70 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 18] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x540be891
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x540be891
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.185791e+13
Presolve removed 2608 rows and 1900 columns
Presolve time: 0.00s
Presolved: 485 rows, 489 columns, 1368 nonzeros
Found heuristic solution: objective 6016060.8044
Variable types: 330 continuous, 159 integer (159 binary)

Root relaxation: objective -1.191368e+05, 229 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -119136.79    0  120 6016060.80 -119136.79   102%     -    0s
H    0     0                    -76266.45569 -119136.79  56.2%     -    0s
H    0     0                    -76812.45414 -119136.79  55.1%     -    0s
H    0     0                    -77916.77222 -118899.27  52.6%     -    0s
     0     0 -92462.783    0  129 -77916.772 -92462.783  18.7%     -    0s
H    0     0                    -83866.41800 -92461.101  10.2%     -    0s
H    0     0                    -88297.15821 -92461.101  4.72%     -    0s
     0     0 -91898.013    0  129 -88297.158 -91898.013  4.08%     -    0s
     0     0 -91889.527    0  129 -88297.158 -91889.527  4.07%     -    0s
     0     0 -91614.428    0  128 -88297.158 -91614.428  3.76%     -    0s
H    0     0                    -89008.38885 -91574.755  2.88%     -    0s
     0     0 -91574.755    0  128 -89008.389 -91574.755  2.88%     -    0s
     0     0 -91505.868    0  126 -89008.389 -91505.868  2.81%     -    0s
     0     0 -91453.033    0  126 -89008.389 -91453.033  2.75%     -    0s
H    0     0                    -90180.50393 -91445.214  1.40%     -    0s
H    0     0                    -90378.68653 -91445.214  1.18%     -    0s
H    0     0                    -90412.44103 -91445.214  1.14%     -    0s
     0     2 -91445.214    0  126 -90412.441 -91445.214  1.14%     -    0s
H   33    40                    -90444.67887 -91316.869  0.96%  17.2    0s
H   47    33                    -90788.39964 -91316.869  0.58%  16.1    0s

Cutting planes:
  Gomory: 49
  MIR: 187
  RLT: 1

Explored 266 nodes (2933 simplex iterations) in 0.12 seconds (0.08 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -90788.4 -90444.7 -90412.4 ... -76266.5
No other solutions better than -90788.4

Optimal solution found (tolerance 1.00e-04)
Best objective -9.078839963886e+04, best bound -9.078839963886e+04, gap 0.0000%
  Subproblem solved in 0.13s
  Worst-case operational profit (Z_SP) = 108189.02
  Scenario: 17 demand increases, 43 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -90788.40
  [DEBUG]   S×d_nominal = 198977.42
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 198977.42 + -90788.40 = 108189.02
  [DEBUG]   Current θ from Master = 109979.70
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1790.68 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -7858.03
  Lower Bound (LB) = -7858.03
  Gap (UB-LB) = 1790.6810, Absolute Gap = 1790.6810, Relative Gap = 0.295134
  Not converged yet (gap = 1790.68 > ε = 200)

  [DEBUG] Adding NEW scenario 18 to Master Problem...
  [DEBUG] New scenario pattern: 17 increases, 43 decreases
    [DEBUG] Scenario 18 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 18 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 18]
    [DEBUG]   - Total constraints in model: 291893
    [DEBUG]   - Total variables in model: 120820
  [DEBUG] Total scenarios in Master: 19
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 19
================================================================================
[Iteration 19] Solving Master Problem...
  Current scenarios in Master: 19
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 291893 rows, 120820 columns and 826908 nonzeros
Model fingerprint: 0xe5b936c2
Variable types: 118561 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [9e-02, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 134710 rows and 54720 columns
Presolve time: 2.43s
Presolved: 157183 rows, 66100 columns, 969744 nonzeros
Variable types: 63841 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -371500.8959
Found heuristic solution: objective -172304.4497

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.44s

Barrier statistics:
 Dense cols : 632
 AA' NZ     : 8.846e+06
 Factor NZ  : 1.964e+07 (roughly 250 MB of memory)
 Factor Ops : 5.061e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.67085395e+07  2.39434149e+08  8.69e+04 2.25e+01  6.57e+04     4s
   1  -1.25691365e+07  2.07874562e+08  6.05e+04 4.36e+01  4.55e+04     4s
   2  -4.38689958e+06  1.68483600e+08  2.00e+04 2.69e+01  1.56e+04     5s
   3  -9.93079902e+05  1.20478318e+08  1.72e+03 3.65e-01  1.69e+03     5s
   4  -6.56146194e+05  6.42547560e+07  4.15e+02 1.25e-01  5.04e+02     5s
   5  -5.24403927e+05  3.94427334e+07  2.06e+02 6.96e-02  2.64e+02     5s
   6  -4.22008691e+05  2.67675499e+07  7.12e+01 4.35e-02  1.34e+02     5s
   7  -3.29265386e+05  1.98650317e+07  3.37e+01 3.08e-02  8.65e+01     5s
   8  -2.13515741e+05  1.52584379e+07  1.19e+01 2.28e-02  5.88e+01     5s
   9  -1.61262963e+05  9.62510596e+06  6.17e+00 1.40e-02  3.59e+01     5s
  10  -1.34238984e+05  5.21068029e+06  4.33e+00 7.36e-03  1.94e+01     5s
  11  -1.05417069e+05  3.05534478e+06  2.06e+00 4.17e-03  1.13e+01     5s
  12  -9.12217273e+04  1.74862014e+06  1.36e+00 2.37e-03  6.51e+00     5s
  13  -6.71942297e+04  7.80690708e+05  5.53e-01 1.01e-03  2.98e+00     5s
  14  -5.29504864e+04  3.26320643e+05  3.21e-01 4.19e-04  1.33e+00     5s
  15  -2.80086583e+04  1.90000533e+05  1.52e-01 5.29e-04  7.63e-01     5s
  16  -1.73466014e+04  1.16440003e+05  1.03e-01 1.72e-03  4.68e-01     5s
  17  -1.27393179e+04  9.02663748e+04  8.43e-02 1.29e-03  3.60e-01     5s
  18  -8.81060781e+03  6.16250566e+04  6.96e-02 3.27e-03  2.46e-01     5s
  19  -5.32118399e+03  5.13933726e+04  5.78e-02 2.98e-03  1.98e-01     5s
  20  -2.76442083e+03  3.94769372e+04  4.91e-02 2.55e-03  1.48e-01     5s
  21   6.13626054e+02  3.33466572e+04  3.78e-02 2.26e-03  1.15e-01     5s
  22   2.15975588e+03  3.16529484e+04  3.27e-02 1.95e-03  1.03e-01     6s
  23   4.46320690e+03  2.68842960e+04  2.59e-02 1.82e-03  7.85e-02     6s
  24   5.71542041e+03  2.45068092e+04  2.24e-02 1.41e-03  6.58e-02     6s
  25   7.54823035e+03  2.23199923e+04  1.75e-02 1.11e-03  5.17e-02     6s
  26   8.60223692e+03  1.94985930e+04  1.49e-02 7.15e-04  3.81e-02     6s
  27   9.47214980e+03  1.84121284e+04  1.27e-02 5.33e-04  3.13e-02     6s
  28   1.05121589e+04  1.75504185e+04  1.03e-02 4.19e-04  2.46e-02     6s
  29   1.16290602e+04  1.67700405e+04  7.55e-03 4.14e-04  1.80e-02     6s
  30   1.19198055e+04  1.62972966e+04  6.82e-03 3.09e-04  1.53e-02     6s
  31   1.23498524e+04  1.59213401e+04  5.81e-03 2.20e-04  1.25e-02     6s
  32   1.31153391e+04  1.56117771e+04  4.09e-03 1.25e-04  8.75e-03     6s
  33   1.33782111e+04  1.54590847e+04  3.50e-03 9.77e-05  7.29e-03     6s
  34   1.37242852e+04  1.53383766e+04  2.70e-03 7.54e-05  5.65e-03     6s
  35   1.38513818e+04  1.51947083e+04  2.39e-03 5.15e-05  4.71e-03     6s
  36   1.40417545e+04  1.51457366e+04  1.95e-03 4.13e-05  3.87e-03     6s
  37   1.42781033e+04  1.50720754e+04  1.41e-03 2.77e-05  2.78e-03     7s
  38   1.44118173e+04  1.50264380e+04  1.10e-03 7.09e-05  2.15e-03     7s
  39   1.44881005e+04  1.49903073e+04  9.21e-04 4.63e-05  1.76e-03     7s
  40   1.46306987e+04  1.49828128e+04  6.16e-04 4.18e-05  1.23e-03     7s
  41   1.47059080e+04  1.49608746e+04  4.41e-04 3.02e-05  8.93e-04     7s
  42   1.47360146e+04  1.49381335e+04  3.73e-04 1.82e-05  7.08e-04     7s
  43   1.47535856e+04  1.49333347e+04  3.33e-04 1.56e-05  6.30e-04     7s
  44   1.48089925e+04  1.49232495e+04  2.10e-04 9.87e-06  4.00e-04     7s
  45   1.48554162e+04  1.49096090e+04  1.00e-04 5.82e-06  1.90e-04     7s
  46   1.48748432e+04  1.49089342e+04  6.04e-05 4.82e-06  1.19e-04     7s
  47   1.48924290e+04  1.49064191e+04  2.32e-05 1.99e-06  4.90e-05     7s
  48   1.48978521e+04  1.49046215e+04  1.20e-05 5.58e-07  2.37e-05     7s
  49   1.49018836e+04  1.49043958e+04  4.09e-06 6.65e-07  8.81e-06     7s
  50   1.49027048e+04  1.49043266e+04  2.57e-06 5.72e-07  5.68e-06     7s
  51   1.49032738e+04  1.49042474e+04  1.52e-06 3.35e-07  3.41e-06     7s
  52   1.49040368e+04  1.49042173e+04  1.11e-07 3.33e-07  6.31e-07     8s
  53   1.49040643e+04  1.49041998e+04  2.17e-07 1.30e-06  4.74e-07     8s
  54   1.49040872e+04  1.49041016e+04  8.16e-08 1.09e-06  5.04e-08     8s
  55   1.49040994e+04  1.49041014e+04  2.22e-07 1.05e-07  7.02e-09     8s
  56   1.49041013e+04  1.49041014e+04  1.15e-07 4.46e-08  2.99e-10     8s

Barrier solved model in 56 iterations and 7.80 seconds (18.14 work units)
Optimal objective 1.49041013e+04


Root crossover log...

  128444 DPushes remaining with DInf 0.0000000e+00                 8s
   37265 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                13s

    9740 PPushes remaining with PInf 8.6434112e-05                13s
       0 PPushes remaining with PInf 0.0000000e+00                14s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.4155640e+02     14s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   68988    1.4904078e+04   0.000000e+00   2.415564e+02     14s
   68993    1.4904101e+04   0.000000e+00   0.000000e+00     14s
   68993    1.4904101e+04   0.000000e+00   0.000000e+00     14s
Concurrent spin time: 4.82s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 1.490410e+04, 68993 iterations, 15.34 seconds (33.23 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 14904.1014    0  369 -172304.45 14904.1014   109%     -   19s
H    0     0                    -164372.8439 14904.1014   109%     -   20s
H    0     0                    -149301.7680 14904.1014   110%     -   21s
H    0     0                    -148337.0513 14904.1014   110%     -   21s
H    0     0                    -148326.8480 14904.1014   110%     -   21s
H    0     0                    -81080.22810 14904.1014   118%     -   21s
H    0     0                    -80937.25433 14904.1014   118%     -   21s
H    0     0                    -80690.42151 14904.1014   118%     -   21s
H    0     0                    -49006.70741 14904.1014   130%     -   21s
H    0     0                    -47192.10205 14904.1014   132%     -   21s
H    0     0                    -46627.10086 14904.1014   132%     -   21s
     0     0 8122.60207    0  391 -46627.101 8122.60207   117%     -   58s
H    0     0                    -37597.32478 8106.62526   122%     -   58s
H    0     0                    -27079.96336 8106.62526   130%     -   58s
     0     0 7800.44625    0  388 -27079.963 7800.44625   129%     -   72s
     0     0 7726.15377    0  385 -27079.963 7726.15377   129%     -   82s
     0     0 7723.74957    0  388 -27079.963 7723.74957   129%     -   85s
     0     0 7704.40332    0  391 -27079.963 7704.40332   128%     -   92s
     0     0 7701.24145    0  389 -27079.963 7701.24145   128%     -   96s
     0     0 7692.00695    0  386 -27079.963 7692.00695   128%     -   99s
     0     0 7602.30513    0  381 -27079.963 7602.30513   128%     -  106s
     0     0 7598.92715    0  384 -27079.963 7598.92715   128%     -  108s
     0     0 7559.52078    0  386 -27079.963 7559.52078   128%     -  114s
     0     0 7556.66983    0  384 -27079.963 7556.66983   128%     -  116s
     0     0 7556.66983    0  384 -27079.963 7556.66983   128%     -  117s
     0     0 6135.66434    0  362 -27079.963 6135.66434   123%     -  147s
H    0     0                    -18927.99139 6134.98418   132%     -  148s
H    0     0                    -18533.98985 6134.98418   133%     -  148s
     0     0 5846.14393    0  382 -18533.990 5846.14393   132%     -  168s
     0     0 5813.02106    0  386 -18533.990 5813.02106   131%     -  176s
     0     0 5783.68128    0  383 -18533.990 5783.68128   131%     -  182s
     0     0 5440.42510    0  379 -18533.990 5440.42510   129%     -  197s
     0     0 5396.02515    0  391 -18533.990 5396.02515   129%     -  204s
     0     0 5369.22339    0  368 -18533.990 5369.22339   129%     -  216s
     0     0 5359.43754    0  375 -18533.990 5359.43754   129%     -  221s
     0     0 5349.10636    0  380 -18533.990 5349.10636   129%     -  225s
     0     0 5288.33418    0  370 -18533.990 5288.33418   129%     -  236s
     0     0 5277.86582    0  376 -18533.990 5277.86582   128%     -  241s
     0     0 5265.27745    0  379 -18533.990 5265.27745   128%     -  246s
     0     0 5265.05247    0  377 -18533.990 5265.05247   128%     -  248s
     0     0 4142.21494    0  497 -18533.990 4142.21494   122%     -  301s
     0     0 3904.04981    0  557 -18533.990 3904.04981   121%     -  324s
     0     0 3849.77910    0  554 -18533.990 3849.77910   121%     -  333s
     0     0 3831.24504    0  560 -18533.990 3831.24504   121%     -  338s
     0     0 3813.62286    0  563 -18533.990 3813.62286   121%     -  347s
     0     0 3779.64145    0  560 -18533.990 3779.64145   120%     -  353s
     0     0 3770.70889    0  550 -18533.990 3770.70889   120%     -  356s
     0     0 3754.34915    0  555 -18533.990 3754.34915   120%     -  359s
     0     0 3740.29446    0  560 -18533.990 3740.29446   120%     -  363s
     0     0 3731.45123    0  560 -18533.990 3731.45123   120%     -  366s
     0     0 3730.32959    0  556 -18533.990 3730.32959   120%     -  368s
     0     0 3326.74004    0  497 -18533.990 3326.74004   118%     -  395s
H    0     0                    -18471.22027 3326.18968   118%     -  396s
     0     0 3254.75069    0  508 -18471.220 3254.75069   118%     -  406s
     0     0 3202.39858    0  445 -18471.220 3202.39858   117%     -  419s
     0     0 3169.92217    0  458 -18471.220 3169.92217   117%     -  428s
     0     0 3139.13462    0  524 -18471.220 3139.13462   117%     -  436s
     0     0 3129.75296    0  527 -18471.220 3129.75296   117%     -  441s
     0     0 3092.50301    0  534 -18471.220 3092.50301   117%     -  447s
     0     0 3085.96822    0  465 -18471.220 3085.96822   117%     -  452s
     0     0 3080.83474    0  535 -18471.220 3080.83474   117%     -  456s
     0     0 3075.53331    0  470 -18471.220 3075.53331   117%     -  458s
     0     0 3072.38159    0  453 -18471.220 3072.38159   117%     -  461s
     0     0 3012.72895    0  442 -18471.220 3012.72895   116%     -  471s
     0     0 2991.53265    0  522 -18471.220 2991.53265   116%     -  476s
     0     0 2984.61409    0  528 -18471.220 2984.61409   116%     -  479s
     0     0 2982.88033    0  523 -18471.220 2982.88033   116%     -  480s
     0     0 2977.64319    0  533 -18471.220 2977.64319   116%     -  481s
     0     0 2977.23563    0  529 -18471.220 2977.23563   116%     -  482s
     0     0 2794.60876    0  519 -18471.220 2794.60876   115%     -  500s
     0     0 2743.88171    0  545 -18471.220 2743.88171   115%     -  511s
     0     0 2713.38797    0  551 -18471.220 2713.38797   115%     -  519s
     0     0 2701.70532    0  555 -18471.220 2701.70532   115%     -  525s
     0     0 2684.35253    0  533 -18471.220 2684.35253   115%     -  531s
     0     0 2585.94344    0  533 -18471.220 2585.94344   114%     -  543s
     0     0 2577.21311    0  534 -18471.220 2577.21311   114%     -  548s
     0     0 2573.95325    0  534 -18471.220 2573.95325   114%     -  551s
     0     0 2572.39192    0  539 -18471.220 2572.39192   114%     -  554s
     0     0 2396.29256    0  522 -18471.220 2396.29256   113%     -  574s
H    0     0                    -10543.03498 2395.17377   123%     -  581s
H    0     0                    -10006.35312 2395.17377   124%     -  584s
H    0     0                    -9286.570577 2395.17377   126%     -  584s
H    0     0                    -8113.827254 2395.17377   130%     -  586s
H    0     0                    -7942.288136 2395.17377   130%     -  586s
     0     0 2352.76333    0  601 -7942.2881 2352.76333   130%     -  597s
     0     0 2338.88678    0  604 -7942.2881 2338.88678   129%     -  604s
     0     0 2318.74910    0  600 -7942.2881 2318.74910   129%     -  610s
     0     0 2289.44146    0  537 -7942.2881 2289.44146   129%     -  618s
     0     0 2274.21396    0  540 -7942.2881 2274.21396   129%     -  627s
     0     0 2260.55042    0  535 -7942.2881 2260.55042   128%     -  633s
     0     0 2257.63241    0  550 -7942.2881 2257.63241   128%     -  636s
     0     0 2253.63309    0  544 -7942.2881 2253.63309   128%     -  638s
     0     0 2249.85750    0  550 -7942.2881 2249.85750   128%     -  641s
     0     0 2245.29132    0  534 -7942.2881 2245.29132   128%     -  644s
     0     0 2244.62305    0  540 -7942.2881 2244.62305   128%     -  647s
     0     0 2115.78779    0  595 -7942.2881 2115.78779   127%     -  665s
     0     0 2083.11197    0  601 -7942.2881 2083.11197   126%     -  675s
     0     0 2063.16798    0  610 -7942.2881 2063.16798   126%     -  683s
     0     0 2042.30482    0  605 -7942.2881 2042.30482   126%     -  694s
     0     0 2035.83318    0  603 -7942.2881 2035.83318   126%     -  698s
     0     0 2033.39268    0  600 -7942.2881 2033.39268   126%     -  702s
     0     0 2020.28684    0  589 -7942.2881 2020.28684   125%     -  707s
     0     0 2017.98472    0  598 -7942.2881 2017.98472   125%     -  709s
     0     0 2016.46802    0  603 -7942.2881 2016.46802   125%     -  711s
     0     0 1904.20450    0  640 -7942.2881 1904.20450   124%     -  728s
H    0     0                    -7931.750008 1903.86691   124%     -  730s
H    0     0                    -7916.493173 1903.86691   124%     -  730s
     0     0 1846.26176    0  663 -7916.4932 1846.26176   123%     -  750s
     0     0 1836.11680    0  663 -7916.4932 1836.11680   123%     -  760s
     0     0 1824.24039    0  563 -7916.4932 1824.24039   123%     -  771s
     0     0 1819.24019    0  573 -7916.4932 1819.24019   123%     -  776s
     0     0 1814.23764    0  581 -7916.4932 1814.23764   123%     -  780s
     0     0 1809.22727    0  572 -7916.4932 1809.22727   123%     -  784s
     0     0 1807.60254    0  579 -7916.4932 1807.60254   123%     -  786s
     0     0 1778.36232    0  665 -7916.4932 1778.36232   122%     -  799s
     0     0 1761.06112    0  626 -7916.4932 1761.06112   122%     -  808s
     0     0 1740.59024    0  633 -7916.4932 1740.59024   122%     -  814s
     0     0 1687.17135    0  558 -7916.4932 1687.17135   121%     -  819s
     0     0 1683.40713    0  564 -7916.4932 1683.40713   121%     -  822s
     0     0 1681.80309    0  664 -7916.4932 1681.80309   121%     -  825s
     0     0 1668.34061    0  606 -7916.4932 1668.34061   121%     -  833s
     0     0 1665.07681    0  573 -7916.4932 1665.07681   121%     -  838s
     0     0 1663.40197    0  566 -7916.4932 1663.40197   121%     -  840s
     0     0 1641.22218    0  583 -7916.4932 1641.22218   121%     -  849s
     0     0 1634.41436    0  579 -7916.4932 1634.41436   121%     -  854s
     0     0 1632.94421    0  627 -7916.4932 1632.94421   121%     -  858s
     0     0 1625.61334    0  585 -7916.4932 1625.61334   121%     -  865s
     0     0 1620.75793    0  622 -7916.4932 1620.75793   120%     -  886s
     0     0 1620.47344    0  623 -7916.4932 1620.47344   120%     -  887s
     0     0 1604.80225    0  609 -7916.4932 1604.80225   120%     -  893s
     0     0 1597.72358    0  571 -7916.4932 1597.72358   120%     -  898s
     0     0 1597.72358    0  576 -7916.4932 1597.72358   120%     -  898s
     0     0 1582.26371    0  604 -7916.4932 1582.26371   120%     -  907s
     0     0 1577.11207    0  612 -7916.4932 1577.11207   120%     -  914s
     0     0 1575.01931    0  619 -7916.4932 1575.01931   120%     -  917s
     0     0 1574.04207    0  619 -7916.4932 1574.04207   120%     -  919s
     0     0 1557.90755    0  622 -7916.4932 1557.90755   120%     -  930s
     0     0 1554.90152    0  623 -7916.4932 1554.90152   120%     -  935s
     0     0 1551.30874    0  618 -7916.4932 1551.30874   120%     -  939s
     0     0 1549.87282    0  628 -7916.4932 1549.87282   120%     -  941s
     0     0 1530.21370    0  672 -7916.4932 1530.21370   119%     -  950s
     0     0 1525.87800    0  680 -7916.4932 1525.87800   119%     -  959s
     0     0 1524.55703    0  640 -7916.4932 1524.55703   119%     -  963s
     0     0 1516.21174    0  717 -7916.4932 1516.21174   119%     -  969s
     0     0 1512.77769    0  661 -7916.4932 1512.77769   119%     -  973s
     0     0 1511.38351    0  719 -7916.4932 1511.38351   119%     -  975s
     0     0 1506.10076    0  724 -7916.4932 1506.10076   119%     -  981s
     0     0 1504.06983    0  723 -7916.4932 1504.06983   119%     - 1025s
     0     0 1502.78247    0  725 -7916.4932 1502.78247   119%     - 1027s
     0     0 1498.86751    0  725 -7916.4932 1498.86751   119%     - 1033s
     0     0 1498.08090    0  725 -7916.4932 1498.08090   119%     - 1043s
     0     2 1498.03195    0  725 -7916.4932 1498.03195   119%     - 1243s
     1     4 1483.67121    1  719 -7916.4932 1498.03195   119%  2962 1255s
     3     7 1160.91760    2  454 -7916.4932 1483.27089   119%  8342 1273s
     6    12 1147.07587    3  456 -7916.4932 1483.10706   119%  9777 1290s
    11    23  908.85989    4  477 -7916.4932 1447.46553   118% 10554 1309s
    22    34  547.64197    5  294 -7916.4932 1324.47308   117% 15040 1348s
    33    63 -3320.7104    6  239 -7916.4932 1252.11910   116% 16569 1526s
    63    91 -3770.8271    7  243 -7916.4932 1252.11910   116% 22452 1568s
    95   140 -4185.8140    8  235 -7916.4932 1252.11910   116% 18643 1609s
   146   183 -4572.7514   13  231 -7916.4932 1252.11910   116% 15591 1646s
   209   232 -5474.1724   16  213 -7916.4932 1252.11910   116% 14498 1679s
   276   301 -5559.2389   17  209 -7916.4932 1252.11910   116% 13036 1711s
   347   339     cutoff   21      -7916.4932 1252.11910   116% 12323 1738s
   393   407 -6457.0950   24  163 -7916.4932 1252.11910   116% 12157 1765s
   467   456     cutoff   28      -7916.4932 1252.11910   116% 11420 1787s
   530   521     cutoff   29      -7916.4932 1252.11910   116% 11049 1811s
   605   582     cutoff   14      -7916.4932 1252.11910   116% 10742 1832s
H  630   582                    -6920.760765 1252.11910   118% 10533 1832s
   687   595 infeasible   14      -6920.7608 1252.11910   118% 10329 1858s
   772   598 -554.84864   11  420 -6920.7608 1252.11910   118%  9921 1882s
   813   609 infeasible   14      -6920.7608 1252.11910   118%  9856 1905s
H  826   609                    -6567.144446 1252.11910   119%  9811 1905s
   844   619 -860.80451   13  337 -6567.1444 1252.11910   119%  9894 1930s
H  865   619                    -6453.131254 1252.11910   119% 10016 1930s
   886   641 -3569.8389   14  398 -6453.1313 1252.11910   119%  9971 1958s
   945   661 -5117.0888   12  395 -6453.1313 1252.11910   119%  9991 1983s
   981   682 -5266.2627   13  387 -6453.1313 1252.11910   119% 10146 2018s
H  997   682                    -6318.466490 1252.11910   120% 10111 2018s
H 1015   682                    -6309.319505 1252.11910   120% 10106 2018s
  1029   685 infeasible   13      -6309.3195 1252.11910   120% 10254 2043s
  1072   707 -5786.3466   15  372 -6309.3195 1252.11910   120% 10195 2068s
H 1082   707                    -6301.127430 1252.11910   120% 10203 2068s
H 1088   707                    -6280.586634 1252.11910   120% 10217 2068s
  1110   761 -5832.7445   16  373 -6280.5866 1252.11910   120% 10266 2099s
  1200   822 infeasible   18      -6280.5866 1252.11910   120% 10157 2129s
  1296   894     cutoff   18      -6280.5866 1252.11910   120%  9970 2160s
  1420   922     cutoff   22      -6280.5866 1252.11910   120%  9683 2197s
  1544   941 -3545.6061   21  538 -6280.5866 1252.11910   120%  9463 2229s
  1585   960 -3667.8942   22  440 -6280.5866 1252.11910   120%  9450 2259s
H 1587   960                    -6259.755020 1252.11910   120%  9442 2259s
H 1588   960                    -6197.446904 1252.11910   120%  9438 2259s
H 1601   960                    -6178.211934 1252.11910   120%  9396 2259s
  1638  1003 infeasible   23      -6178.2119 1252.11910   120%  9356 2298s
  1721  1035 -3606.7370   22  561 -6178.2119 1252.11910   120%  9398 2338s
  1835  1094 -3986.7125   24  505 -6178.2119 1252.11910   120%  9270 2385s
  1932  1175 -4246.6692   27  422 -6178.2119 1252.11910   120%  9319 2427s
  2061  1270 -4683.3779   30  428 -6178.2119 1252.11910   120%  9165 2473s
  2214  1298 -5034.1642   34  322 -6178.2119 1252.11910   120%  8966 2512s
H 2249  1298                    -6173.769417 1252.11910   120%  8924 2512s
  2311  1311 -5126.4054   35  319 -6173.7694 1252.11910   120%  8869 2563s
  2458  1324 infeasible   37      -6173.7694 1252.11910   120%  8807 2616s
  2551  1371 infeasible   36      -6173.7694  855.64976   114%  8943 2669s
  2662  1396 -313.90630    5  646 -6173.7694  851.60763   114%  9066 2726s
  2795  1427 -914.20316    6  705 -6173.7694  851.60763   114%  9112 2788s
  2892  1470 -2393.8912    7  396 -6173.7694  851.60763   114%  9305 2855s
  2991  1490 -4390.8854    8  204 -6173.7694  851.60763   114%  9464 2998s
  3065  1543     cutoff   12      -6173.7694  851.60763   114%  9567 3066s
  3220  1584 -5546.0782   11  222 -6173.7694  851.60763   114%  9578 3137s
  3374  1606 -3882.4928   10  438 -6173.7694  851.60763   114%  9578 3205s
  3504  1645 -3915.7371   11  444 -6173.7694 -455.84078  92.6%  9644 3277s
  3650  1645 infeasible   15      -6173.7694 -455.84078  92.6%  9728 3345s
  3762  1660 -4414.4438   13  425 -6173.7694 -463.88067  92.5%  9777 3414s
  3870  1689 infeasible   14      -6173.7694 -484.67526  92.1%  9898 3483s
  3969  1703 -4063.5917   12  533 -6173.7694 -496.28996  92.0% 10056 3549s
  4122  1685 infeasible   14      -6173.7694 -630.26737  89.8% 10109 3600s

Cutting planes:
  Learned: 1
  Gomory: 2
  Implied bound: 274
  MIR: 3931
  Flow cover: 4241
  Zero half: 9
  RLT: 73
  Relax-and-lift: 438

Explored 4240 nodes (44263907 simplex iterations) in 3600.08 seconds (8493.23 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -6173.77 -6178.21 -6197.45 ... -6567.14

Time limit reached
Best objective -6.173769417385e+03, best bound -6.302673740844e+02, gap 89.7912%
  WARNING: Time limit reached. Using best solution found (gap: 89.79%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3600.09s
  Master Objective (UB) = -6173.77, θ = 109698.53
  Upper Bound (UB) = -6173.77

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 109698.53
  [DEBUG]   ✓ Scenario 0: θ = 109698.53 ≤ Q = 109698.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 109698.53 ≤ Q = 109698.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 109698.53 ≤ Q = 109698.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 109698.53 ≤ Q = 109698.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 109698.53 ≤ Q = 109698.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 109698.53 ≤ Q = 109698.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 109698.53 ≤ Q = 109698.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 109698.53 ≤ Q = 109698.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 109698.53 ≤ Q = 109698.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 109698.53 ≤ Q = 109698.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 109698.53 ≤ Q = 109698.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 109698.53 ≤ Q = 109698.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 109698.53 ≤ Q = 109698.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 109698.53 ≤ Q = 109698.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 109698.53 ≤ Q = 109698.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 109698.53 ≤ Q = 109698.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 109698.53 ≤ Q = 109698.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 109698.53 ≤ Q = 109698.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 109698.53 ≤ Q = 109698.53 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 19] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x43c22e8d
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xbc3dd173
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.185791e+13
Presolve removed 2608 rows and 1900 columns
Presolve time: 0.00s
Presolved: 485 rows, 489 columns, 1368 nonzeros
Found heuristic solution: objective 6010535.3534
Variable types: 330 continuous, 159 integer (159 binary)

Root relaxation: objective -1.192927e+05, 229 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -119292.73    0  120 6010535.35 -119292.73   102%     -    0s
H    0     0                    -77465.01311 -119292.73  54.0%     -    0s
H    0     0                    -77946.58592 -119057.10  52.7%     -    0s
     0     0 -92504.390    0  128 -77946.586 -92504.390  18.7%     -    0s
H    0     0                    -86876.79116 -92480.455  6.45%     -    0s
     0     0 -91994.904    0  130 -86876.791 -91994.904  5.89%     -    0s
     0     0 -91982.293    0  130 -86876.791 -91982.293  5.88%     -    0s
H    0     0                    -88988.08765 -91982.293  3.36%     -    0s
H    0     0                    -89239.88554 -91982.293  3.07%     -    0s
     0     0 -91868.790    0  127 -89239.886 -91868.790  2.95%     -    0s
     0     0 -91863.217    0  127 -89239.886 -91863.217  2.94%     -    0s
H    0     0                    -89412.32988 -91863.217  2.74%     -    0s
H    0     0                    -89700.24097 -91863.217  2.41%     -    0s
     0     2 -91863.217    0  127 -89700.241 -91863.217  2.41%     -    0s
H   31    64                    -90139.86737 -91662.183  1.69%  11.5    0s
H   34    64                    -90231.54423 -91662.183  1.59%  11.1    0s
H   48    64                    -90384.86687 -91504.791  1.24%   9.3    0s
H   51    64                    -90416.46672 -91479.847  1.18%   9.0    0s
H  760   490                    -90454.30802 -91456.811  1.11%   3.6    0s
H 1992  1007                    -90466.56259 -91266.570  0.88%   3.5    0s
* 2182  1007              40    -90526.53272 -91225.899  0.77%   3.5    0s
H 2318  1121                    -90577.64618 -91225.899  0.72%   3.5    0s
H 2423  1121                    -90765.64932 -91225.899  0.51%   3.5    0s
H 2708  1121                    -90789.34353 -91215.131  0.47%   3.5    0s
* 4128   815              33    -90790.51420 -91002.890  0.23%   3.8    0s
* 4341   815              35    -90821.76097 -90935.594  0.13%   3.8    0s
* 4700   815              29    -90826.61179 -90924.483  0.11%   3.8    0s
H 5237     8                    -90827.78246 -90861.947  0.04%   3.6    0s

Cutting planes:
  Gomory: 42
  MIR: 196
  RLT: 2

Explored 5705 nodes (19416 simplex iterations) in 0.23 seconds (0.17 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -90827.8 -90826.6 -90821.8 ... -90454.3
No other solutions better than -90827.8

Optimal solution found (tolerance 1.00e-04)
Best objective -9.082778246142e+04, best bound -9.082778246142e+04, gap 0.0000%
  Subproblem solved in 0.25s
  Worst-case operational profit (Z_SP) = 108077.18
  Scenario: 17 demand increases, 43 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -90827.78
  [DEBUG]   S×d_nominal = 198904.96
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 198904.96 + -90827.78 = 108077.18
  [DEBUG]   Current θ from Master = 109698.53
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1621.35 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -7795.12
  Lower Bound (LB) = -7795.12
  Gap (UB-LB) = 1621.3495, Absolute Gap = 1621.3495, Relative Gap = 0.262619
  Not converged yet (gap = 1621.35 > ε = 200)

  [DEBUG] Adding NEW scenario 19 to Master Problem...
  [DEBUG] New scenario pattern: 17 increases, 43 decreases
    [DEBUG] Scenario 19 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 19 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 19]
    [DEBUG]   - Total constraints in model: 307183
    [DEBUG]   - Total variables in model: 127060
  [DEBUG] Total scenarios in Master: 20
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 20
================================================================================
[Iteration 20] Solving Master Problem...
  Current scenarios in Master: 20
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 307183 rows, 127060 columns and 870139 nonzeros
Model fingerprint: 0x042ba386
Variable types: 124801 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [9e-02, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 141820 rows and 57610 columns
Presolve time: 2.69s
Presolved: 165363 rows, 69450 columns, 1020037 nonzeros
Variable types: 67191 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -371713.5761
Found heuristic solution: objective -172304.4497

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.40s

Barrier statistics:
 Dense cols : 1160
 AA' NZ     : 3.952e+06
 Factor NZ  : 1.112e+07 (roughly 200 MB of memory)
 Factor Ops : 3.850e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.67191774e+07  2.49613306e+08  8.69e+04 2.15e+01  6.53e+04     5s
   1  -1.25912640e+07  2.16610816e+08  6.05e+04 4.26e+01  4.53e+04     5s
   2  -4.56266911e+06  1.75389626e+08  2.07e+04 2.64e+01  1.60e+04     5s
   3  -7.67538949e+05  1.26482099e+08  1.02e+03 2.09e+00  1.17e+03     5s
   4  -5.90313364e+05  7.40600697e+07  3.83e+02 1.04e+00  5.02e+02     5s
   5  -5.31074653e+05  4.84419668e+07  2.25e+02 6.08e-01  3.00e+02     5s
   6  -4.55769203e+05  3.96286180e+07  7.11e+01 4.79e-01  1.74e+02     5s
   7  -4.13094628e+05  2.69958087e+07  3.17e+01 3.07e-01  1.07e+02     5s
   8  -3.49156892e+05  1.92481186e+07  1.20e+01 2.15e-01  6.99e+01     5s
   9  -1.95677126e+05  1.17092614e+07  2.82e+00 1.29e-01  4.03e+01     5s
  10  -1.48835654e+05  5.43644590e+06  1.53e+00 5.68e-02  1.88e+01     5s
  11  -1.22552439e+05  4.34211059e+06  1.05e+00 4.47e-02  1.49e+01     5s
  12  -1.03502734e+05  3.04294833e+06  6.78e-01 3.10e-02  1.05e+01     5s
  13  -9.01188449e+04  1.92571694e+06  4.74e-01 1.95e-02  6.72e+00     5s
  14  -6.54096574e+04  5.41073945e+05  2.34e-01 5.35e-03  2.02e+00     5s
  15  -2.91238847e+04  2.73459765e+05  7.22e-02 2.77e-03  1.01e+00     5s
  16  -2.20224237e+04  1.65866734e+05  5.65e-02 1.66e-03  6.24e-01     5s
  17  -1.82128337e+04  1.31272772e+05  4.90e-02 1.60e-03  4.97e-01     5s
  18  -1.15352484e+04  8.36551977e+04  3.64e-02 1.57e-03  3.16e-01     6s
  19  -6.48481927e+03  5.79603171e+04  2.83e-02 1.07e-03  2.14e-01     6s
  20  -2.88588915e+03  4.96068363e+04  2.28e-02 8.66e-04  1.74e-01     6s
  21  -1.13008446e+03  3.92468695e+04  2.01e-02 6.34e-04  1.34e-01     6s
  22   1.61633038e+03  3.73506705e+04  1.60e-02 5.92e-04  1.19e-01     6s
  23   4.19698881e+03  3.13326590e+04  1.22e-02 4.60e-04  9.01e-02     6s
  24   6.17746028e+03  2.80258564e+04  9.62e-03 3.69e-04  7.26e-02     6s
  25   6.95182538e+03  2.52210506e+04  8.65e-03 2.93e-04  6.07e-02     6s
  26   8.24688701e+03  2.22998089e+04  7.09e-03 2.16e-04  4.67e-02     6s
  27   8.86928003e+03  2.14841223e+04  6.39e-03 1.92e-04  4.19e-02     6s
  28   1.02439204e+04  1.93604240e+04  4.89e-03 1.37e-04  3.03e-02     6s
  29   1.10881753e+04  1.80938839e+04  3.97e-03 1.43e-04  2.33e-02     6s
  30   1.15734830e+04  1.72465139e+04  3.46e-03 1.04e-04  1.89e-02     6s
  31   1.19564963e+04  1.65329447e+04  3.04e-03 8.05e-05  1.52e-02     6s
  32   1.26687303e+04  1.60634374e+04  2.28e-03 1.89e-04  1.13e-02     6s
  33   1.31682659e+04  1.56051497e+04  1.74e-03 1.65e-04  8.10e-03     7s
  34   1.36767000e+04  1.53461466e+04  1.21e-03 1.03e-04  5.55e-03     7s
  35   1.39315223e+04  1.51841107e+04  9.43e-04 6.38e-05  4.16e-03     7s
  36   1.44169586e+04  1.51008454e+04  4.52e-04 4.11e-05  2.27e-03     7s
  37   1.45374509e+04  1.50511546e+04  3.40e-04 3.08e-05  1.71e-03     7s
  38   1.45880437e+04  1.50225531e+04  2.91e-04 2.49e-05  1.44e-03     7s
  39   1.46807986e+04  1.49991337e+04  2.02e-04 1.96e-05  1.06e-03     7s
  40   1.47533754e+04  1.49612130e+04  1.34e-04 1.27e-05  6.91e-04     7s
  41   1.47770490e+04  1.49431599e+04  1.13e-04 9.30e-06  5.52e-04     7s
  42   1.48300116e+04  1.49355230e+04  6.57e-05 7.68e-06  3.51e-04     7s
  43   1.48880142e+04  1.49130036e+04  1.14e-05 2.68e-06  8.30e-05     7s
  44   1.48920275e+04  1.49091931e+04  8.44e-06 1.56e-06  5.70e-05     7s
  45   1.48968347e+04  1.49085392e+04  4.92e-06 1.37e-06  3.89e-05     7s
  46   1.49016850e+04  1.49068513e+04  1.51e-06 8.31e-07  1.72e-05     7s
  47   1.49027490e+04  1.49050494e+04  8.16e-07 2.68e-07  7.65e-06     7s
  48   1.49038246e+04  1.49043908e+04  1.57e-07 7.18e-08  1.88e-06     8s
  49   1.49038380e+04  1.49043789e+04  3.86e-07 4.77e-07  1.80e-06     8s
  50   1.49039103e+04  1.49042357e+04  2.80e-07 5.04e-07  1.08e-06     8s
  51   1.49039277e+04  1.49042166e+04  2.54e-07 4.29e-07  9.61e-07     8s
  52   1.49039510e+04  1.49042066e+04  2.22e-07 3.92e-07  8.50e-07     8s
  53   1.49040842e+04  1.49041027e+04  1.52e-07 1.12e-08  6.18e-08     8s
  54   1.49040988e+04  1.49041014e+04  3.29e-07 1.66e-10  8.51e-09     8s
  55   1.49041013e+04  1.49041014e+04  6.29e-08 8.14e-08  3.16e-10     8s

Barrier solved model in 55 iterations and 8.12 seconds (16.57 work units)
Optimal objective 1.49041013e+04


Root crossover log...

  135119 DPushes remaining with DInf 0.0000000e+00                 8s
   47766 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                13s

   11787 PPushes remaining with PInf 8.1096652e-05                13s
       0 PPushes remaining with PInf 0.0000000e+00                14s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.3133646e+00     14s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   74503    1.4904101e+04   0.000000e+00   1.313365e+00     14s
   74505    1.4904101e+04   0.000000e+00   0.000000e+00     14s
   74505    1.4904101e+04   0.000000e+00   0.000000e+00     14s
Concurrent spin time: 1.51s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 1.490410e+04, 74505 iterations, 11.99 seconds (29.41 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 14904.1014    0  369 -172304.45 14904.1014   109%     -   16s
H    0     0                    -151219.9403 14904.1014   110%     -   17s
H    0     0                    -151177.6972 14904.1014   110%     -   17s
H    0     0                    -142221.2612 14904.1014   110%     -   17s
H    0     0                    -138089.8793 14904.1014   111%     -   18s
H    0     0                    -137798.2573 14904.1014   111%     -   18s
H    0     0                    -137743.4210 14904.1014   111%     -   18s
H    0     0                    -137145.9267 14904.1014   111%     -   18s
H    0     0                    -136422.3451 14904.1014   111%     -   18s
H    0     0                    -136421.5840 14904.1014   111%     -   18s
H    0     0                    -81289.47245 14904.1014   118%     -   18s
H    0     0                    -81146.49868 14904.1014   118%     -   18s
H    0     0                    -80899.66587 14904.1014   118%     -   18s
H    0     0                    -49077.69205 14904.1014   130%     -   18s
H    0     0                    -47884.11660 14904.1014   131%     -   18s
H    0     0                    -46681.09960 14904.1014   132%     -   18s
     0     0 8096.65551    0  333 -46681.100 8096.65551   117%     -   63s
H    0     0                    -15835.64405 8095.54315   151%     -   64s
H    0     0                    -15465.12566 8095.54315   152%     -   64s
H    0     0                    -15224.60279 8095.54315   153%     -   64s
     0     0 7757.18463    0  389 -15224.603 7757.18463   151%     -   79s
     0     0 7722.38935    0  388 -15224.603 7722.38935   151%     -   86s
     0     0 7691.99956    0  387 -15224.603 7691.99956   151%     -   93s
     0     0 7669.38413    0  395 -15224.603 7669.38413   150%     -   97s
     0     0 7667.22492    0  395 -15224.603 7667.22492   150%     -   99s
     0     0 7664.15888    0  395 -15224.603 7664.15888   150%     -  101s
     0     0 7568.96467    0  399 -15224.603 7568.96467   150%     -  114s
     0     0 7511.63554    0  381 -15224.603 7511.63554   149%     -  121s
     0     0 7421.74568    0  383 -15224.603 7421.74568   149%     -  130s
     0     0 7407.73508    0  382 -15224.603 7407.73508   149%     -  133s
     0     0 7369.89335    0  387 -15224.603 7369.89335   148%     -  142s
     0     0 7279.95393    0  396 -15224.603 7279.95393   148%     -  152s
     0     0 7278.30826    0  398 -15224.603 7278.30826   148%     -  154s
     0     0 7260.74927    0  396 -15224.603 7260.74927   148%     -  162s
     0     0 7259.00664    0  393 -15224.603 7259.00664   148%     -  165s
     0     0 7255.46533    0  396 -15224.603 7255.46533   148%     -  167s
     0     0 7254.48656    0  395 -15224.603 7254.48656   148%     -  167s
     0     0 7254.45412    0  397 -15224.603 7254.45412   148%     -  168s
     0     0 6012.87814    0  372 -15224.603 6012.87814   139%     -  195s
H    0     0                    -13250.09772 6012.04889   145%     -  196s
H    0     0                    -12375.45786 6012.04889   149%     -  196s
     0     0 5777.28526    0  368 -12375.458 5777.28526   147%     -  214s
     0     0 5735.03490    0  370 -12375.458 5735.03490   146%     -  221s
     0     0 5515.84887    0  387 -12375.458 5515.84887   145%     -  230s
     0     0 5506.02320    0  386 -12375.458 5506.02320   144%     -  233s
     0     0 5383.81016    0  373 -12375.458 5383.81016   144%     -  243s
     0     0 5377.99633    0  371 -12375.458 5377.99633   143%     -  249s
     0     0 5319.69847    0  375 -12375.458 5319.69847   143%     -  256s
     0     0 5318.43923    0  372 -12375.458 5318.43923   143%     -  258s
     0     0 5318.16541    0  372 -12375.458 5318.16541   143%     -  259s
     0     0 4141.02346    0  536 -12375.458 4141.02346   133%     -  311s
H    0     0                    -12099.87206 4140.35947   134%     -  312s
H    0     0                    -11754.21776 4140.35947   135%     -  312s
H    0     0                    -11107.99929 4140.35947   137%     -  312s
H    0     0                    -11090.56941 4140.35947   137%     -  312s
H    0     0                    -11071.76259 4140.35947   137%     -  312s
     0     0 3910.97239    0  472 -11071.763 3910.97239   135%     -  336s
     0     0 3827.57500    0  540 -11071.763 3827.57500   135%     -  346s
     0     0 3672.85094    0  530 -11071.763 3672.85094   133%     -  358s
     0     0 3648.38552    0  539 -11071.763 3648.38552   133%     -  363s
     0     0 3635.16193    0  539 -11071.763 3635.16193   133%     -  366s
     0     0 3626.24009    0  537 -11071.763 3626.24009   133%     -  369s
     0     0 3622.85763    0  540 -11071.763 3622.85763   133%     -  371s
     0     0 3620.45452    0  541 -11071.763 3620.45452   133%     -  373s
     0     0 3613.55966    0  545 -11071.763 3613.55966   133%     -  374s
     0     0 3503.40769    0  536 -11071.763 3503.40769   132%     -  382s
     0     0 3487.29608    0  537 -11071.763 3487.29608   131%     -  387s
     0     0 3481.67612    0  552 -11071.763 3481.67612   131%     -  390s
     0     0 3479.23390    0  545 -11071.763 3479.23390   131%     -  392s
     0     0 3478.54887    0  553 -11071.763 3478.54887   131%     -  393s
     0     0 3097.79962    0  568 -11071.763 3097.79962   128%     -  429s
H    0     0                    -11047.54554 3097.56307   128%     -  430s
     0     0 3005.62390    0  585 -11047.546 3005.62390   127%     -  445s
     0     0 2969.46134    0  582 -11047.546 2969.46134   127%     -  453s
     0     0 2967.03425    0  589 -11047.546 2967.03425   127%     -  456s
     0     0 2930.50781    0  591 -11047.546 2930.50781   127%     -  467s
     0     0 2880.62307    0  579 -11047.546 2880.62307   126%     -  478s
     0     0 2843.44701    0  506 -11047.546 2843.44701   126%     -  484s
     0     0 2839.61772    0  576 -11047.546 2839.61772   126%     -  488s
     0     0 2837.93362    0  582 -11047.546 2837.93362   126%     -  490s
     0     0 2751.31650    0  576 -11047.546 2751.31650   125%     -  500s
     0     0 2740.86519    0  578 -11047.546 2740.86519   125%     -  505s
     0     0 2738.56393    0  581 -11047.546 2738.56393   125%     -  508s
     0     0 2737.86596    0  582 -11047.546 2737.86596   125%     -  510s
     0     0 2593.14818    0  569 -11047.546 2593.14818   123%     -  527s
     0     0 2553.69536    0  584 -11047.546 2553.69536   123%     -  533s
     0     0 2536.16705    0  523 -11047.546 2536.16705   123%     -  540s
     0     0 2507.83790    0  525 -11047.546 2507.83790   123%     -  546s
     0     0 2489.95024    0  515 -11047.546 2489.95024   123%     -  552s
     0     0 2487.65907    0  523 -11047.546 2487.65907   123%     -  555s
     0     0 2464.18783    0  515 -11047.546 2464.18783   122%     -  561s
     0     0 2455.91236    0  515 -11047.546 2455.91236   122%     -  566s
     0     0 2441.32381    0  517 -11047.546 2441.32381   122%     -  572s
     0     0 2432.47746    0  523 -11047.546 2432.47746   122%     -  575s
     0     0 2415.94394    0  530 -11047.546 2415.94394   122%     -  582s
     0     0 2415.19605    0  530 -11047.546 2415.19605   122%     -  584s
     0     0 2255.44320    0  527 -11047.546 2255.44320   120%     -  597s
H    0     0                    -10493.69962 2254.45707   121%     -  606s
H    0     0                    -10271.30248 2254.45707   122%     -  611s
H    0     0                    -10179.33487 2254.45707   122%     -  611s
H    0     0                    -10168.79674 2254.45707   122%     -  611s
H    0     0                    -9266.978178 2254.45707   124%     -  614s
H    0     0                    -8979.558383 2254.45707   125%     -  615s
     0     0 2207.85887    0  545 -8979.5584 2207.85887   125%     -  622s
     0     0 2134.69134    0  527 -8979.5584 2134.69134   124%     -  629s
     0     0 2129.81073    0  531 -8979.5584 2129.81073   124%     -  632s
     0     0 2126.87077    0  534 -8979.5584 2126.87077   124%     -  633s
     0     0 2124.52375    0  536 -8979.5584 2124.52375   124%     -  634s
     0     0 2123.99246    0  536 -8979.5584 2123.99246   124%     -  637s
     0     0 1996.65481    0  603 -8979.5584 1996.65481   122%     -  648s
H    0     0                    -8762.843762 1996.50865   123%     -  648s
H    0     0                    -8660.269023 1996.50865   123%     -  648s
H    0     0                    -8623.497419 1996.50865   123%     -  648s
     0     0 1983.29264    0  539 -8623.4974 1983.29264   123%     -  653s
     0     0 1973.51333    0  534 -8623.4974 1973.51333   123%     -  657s
     0     0 1956.81637    0  544 -8623.4974 1956.81637   123%     -  662s
     0     0 1921.59335    0  530 -8623.4974 1921.59335   122%     -  667s
     0     0 1917.20282    0  535 -8623.4974 1917.20282   122%     -  670s
     0     0 1915.55763    0  542 -8623.4974 1915.55763   122%     -  671s
     0     0 1867.23872    0  514 -8623.4974 1867.23872   122%     -  679s
H    0     0                    -8580.300801 1867.18033   122%     -  681s
H    0     0                    -8499.533464 1867.18033   122%     -  682s
H    0     0                    -8337.089847 1867.18033   122%     -  682s
H    0     0                    -8326.551719 1867.18033   122%     -  682s
H    0     0                    -8311.294883 1867.18033   122%     -  682s
     0     0 1851.93204    0  613 -8311.2949 1851.93204   122%     -  688s
     0     0 1839.92680    0  668 -8311.2949 1839.92680   122%     -  692s
     0     0 1837.22505    0  682 -8311.2949 1837.22505   122%     -  694s
     0     0 1833.49218    0  622 -8311.2949 1833.49218   122%     -  696s
     0     0 1830.72899    0  624 -8311.2949 1830.72899   122%     -  697s
     0     0 1828.92895    0  626 -8311.2949 1828.92895   122%     -  697s
     0     0 1828.05758    0  625 -8311.2949 1828.05758   122%     -  698s
     0     0 1816.34990    0  560 -8311.2949 1816.34990   122%     -  704s
     0     0 1811.87439    0  613 -8311.2949 1811.87439   122%     -  708s
     0     0 1809.96281    0  608 -8311.2949 1809.96281   122%     -  711s
     0     0 1808.21188    0  611 -8311.2949 1808.21188   122%     -  714s
     0     0 1795.58935    0  518 -8311.2949 1795.58935   122%     -  721s
     0     0 1784.45793    0  635 -8311.2949 1784.45793   121%     -  726s
     0     0 1782.99858    0  529 -8311.2949 1782.99858   121%     -  728s
     0     0 1780.85064    0  643 -8311.2949 1780.85064   121%     -  734s
     0     0 1777.01711    0  652 -8311.2949 1777.01711   121%     -  738s
     0     0 1772.77744    0  614 -8311.2949 1772.77744   121%     -  743s
     0     0 1771.55905    0  615 -8311.2949 1771.55905   121%     -  745s
     0     0 1747.45670    0  612 -8311.2949 1747.45670   121%     -  750s
H    0     0                    -8166.037611 1741.51758   121%     -  780s
H    0     0                    -8098.570418 1741.51758   122%     -  780s
     0     0 1741.48070    0  608 -8098.5704 1741.48070   122%     -  788s
     0     0 1736.38242    0  610 -8098.5704 1736.38242   121%     -  790s
     0     0 1733.78146    0  603 -8098.5704 1733.78146   121%     -  792s
     0     0 1733.26267    0  616 -8098.5704 1733.26267   121%     -  793s
     0     0 1725.35975    0  612 -8098.5704 1725.35975   121%     -  799s
     0     0 1722.55997    0  613 -8098.5704 1722.55997   121%     -  802s
     0     0 1697.22773    0  606 -8098.5704 1697.22773   121%     -  805s
     0     0 1695.84064    0  617 -8098.5704 1695.84064   121%     -  806s
     0     0 1684.46396    0  615 -8098.5704 1684.46396   121%     -  812s
     0     0 1680.81540    0  614 -8098.5704 1680.81540   121%     -  815s
     0     0 1680.07556    0  617 -8098.5704 1680.07556   121%     -  816s
     0     0 1673.83634    0  618 -8098.5704 1673.83634   121%     -  821s
     0     0 1672.81831    0  623 -8098.5704 1672.81831   121%     -  823s
     0     0 1662.75608    0  543 -8098.5704 1662.75608   121%     -  829s
     0     0 1657.63911    0  560 -8098.5704 1657.63911   120%     -  834s
     0     0 1653.78352    0  562 -8098.5704 1653.78352   120%     -  836s
     0     0 1652.91651    0  569 -8098.5704 1652.91651   120%     -  840s
     0     0 1645.28267    0  559 -8098.5704 1645.28267   120%     -  848s
     0     0 1642.17220    0  560 -8098.5704 1642.17220   120%     -  851s
     0     0 1637.47293    0  549 -8098.5704 1637.47293   120%     -  856s
     0     0 1636.55286    0  549 -8098.5704 1636.55286   120%     -  864s
     0     2 1636.55286    0  549 -8098.5704 1636.55286   120%     -  952s
     1     4 1620.75765    1  539 -8098.5704 1636.55286   120%  3838  962s
     3     7 1584.93328    2  539 -8098.5704 1619.67061   120% 12640  989s
     6    12 1136.69413    3  518 -8098.5704 1584.87692   120% 18393 1014s
    11    23 1096.65696    4  593 -8098.5704 1584.87692   120% 14520 1032s
    22    34  578.25910    4  460 -8098.5704 1295.26044   116% 16877 1086s
    33    62  333.32010    5  448 -8098.5704 1295.26044   116% 19341 1378s
H   38    62                    -7956.858936 1295.26044   116% 18455 1378s
H   61    94                    -7918.462567 1295.26044   116% 26891 1416s
    93   154  630.07586    6  458 -7918.4626 1295.26044   116% 22310 1478s
   156   223  425.98829    8  422 -7918.4626 1295.26044   116% 16049 1517s
   244   277  350.13505   10  424 -7918.4626 1295.26044   116% 12886 1550s
   314   334  162.35329   11  461 -7918.4626 1295.26044   116% 12383 1582s
   387   351  133.43479   12  398 -7918.4626 1295.26044   116% 11849 1608s
H  398   351                    -7050.948223 1295.26044   118% 11763 1608s
   412   397 -104.27438   13  403 -7050.9482 1295.26044   118% 11754 1636s
H  490   444                    -6897.535915 1295.26044   119% 10933 1659s
H  491   444                    -6766.743734 1295.26044   119% 10922 1659s
H  492   444                    -6609.197574 1295.26044   120% 10908 1659s
H  511   444                    -6376.831105 1295.26044   120% 10893 1659s
   547   479 -236.40057   15  415 -6376.8311 1295.26044   120% 10822 1687s
H  624   519                    -6338.155026 1295.26044   120% 10417 1709s
   687   543 infeasible   15      -6338.1550 1295.26044   120% 10300 1732s
   745   559 infeasible   17      -6338.1550 1295.26044   120% 10199 1753s
   781   574 -479.33831   18  411 -6338.1550 1295.26044   120% 10127 1771s
   818   592 -1348.9571   18  321 -6338.1550 1295.26044   120% 10034 1793s
H  822   592                    -6334.490300 1295.26044   120% 10007 1793s
   852   615 -1407.0982   19  335 -6334.4903 1295.26044   120%  9992 1834s
   893   628 infeasible   19      -6334.4903 1295.26044   120% 10025 1855s
   934   657 -1650.4219   21  399 -6334.4903 1295.26044   120%  9998 1878s
H  935   657                    -6333.545689 1295.26044   120%  9987 1878s
H  950   657                    -6232.856548 1295.26044   121%  9967 1878s
H  980   657                    -6229.502577 1295.26044   121%  9947 1878s
   985   671 infeasible   21      -6229.5026 1295.26044   121%  9966 1900s
  1035   698 -1734.4393   22  396 -6229.5026 1295.26044   121%  9955 1921s
  1076   728 -1817.5200   23  319 -6229.5026 1295.26044   121% 10004 1945s
H 1078   728                    -6220.701949 1295.26044   121%  9986 1945s
  1120   796 -2339.7583   23  397 -6220.7019 1295.26044   121%  9982 1969s
  1218   884 -2416.5588   25  396 -6220.7019 1295.26044   121%  9698 1997s
  1324   947 -6091.0479   26  282 -6220.7019 1295.26044   121%  9526 2026s
  1429   972 -6172.3062   28  323 -6220.7019 1181.16522   119%  9422 2057s
  1508  1006 infeasible   27      -6220.7019 1181.16522   119%  9412 2091s
  1580  1044 infeasible   29      -6220.7019  803.52355   113%  9501 2127s
  1675  1070     cutoff   29      -6220.7019  803.52355   113%  9489 2162s
  1755  1102 -4972.7181   43  181 -6220.7019  574.77009   109%  9496 2200s
  1853  1161 -5059.3326   45  282 -6220.7019  574.77009   109%  9566 2237s
  1950  1230 -6059.3406   57   58 -6220.7019  574.77009   109%  9489 2273s
  2086  1284 -5339.0503   10  158 -6220.7019  574.77009   109%  9270 2316s
  2245  1331 infeasible   20      -6220.7019  377.06013   106%  9053 2365s
  2373  1374 -4754.7405   10  427 -6220.7019  377.06013   106%  9016 2404s
  2448  1398     cutoff   11      -6220.7019  377.06013   106%  9128 2448s
  2522  1431 infeasible   12      -6220.7019  132.88337   102%  9168 2490s
H 2532  1431                    -6184.332258  132.88337   102%  9165 2490s
  2602  1488 -5597.5925   11  328 -6184.3323  132.88337   102%  9240 2537s
  2735  1505 infeasible   13      -6184.3323  128.87711   102%  9258 2583s
H 2745  1505                    -6177.418245  128.87711   102%  9259 2583s
H 2746  1505                    -6174.685194  128.87711   102%  9258 2583s
H 2758  1505                    -6174.309793  128.87711   102%  9276 2583s
  2782  1612 -6166.0477   13  271 -6174.3098  128.87711   102%  9332 2630s
  2969  1675 -5493.6969   12  476 -6174.3098  -45.06036  99.3%  9242 2681s
  3172  1729     cutoff   13      -6174.3098  -51.08424  99.2%  9121 2739s
  3341  1745 infeasible   16      -6174.3098  -51.08424  99.2%  9060 2793s
  3477  1786 infeasible   31      -6174.3098 -173.02083  97.2%  9202 2855s
  3657  1819     cutoff   14      -6174.3098 -180.91161  97.1%  9196 2919s
  3784  1842 -5023.9238   14  364 -6174.3098 -340.13434  94.5%  9307 2986s
H 3847  1842                    -6174.189387 -340.13434  94.5%  9368 2986s
H 3931  1856                    -6171.823416 -340.13434  94.5%  9413 3069s
H 3940  1851                    -6115.125510 -340.13434  94.4%  9431 3069s
H 4015  1848                    -6104.642365 -340.13434  94.4%  9462 3069s
  4044  1864 infeasible   16      -6104.6424 -340.13434  94.4%  9438 3145s
  4168  1880     cutoff   13      -6104.6424 -644.30830  89.4%  9590 3225s
  4318  1914     cutoff   24      -6104.6424 -666.80946  89.1%  9732 3306s
  4458  1933 -2101.6399   11  515 -6104.6424 -674.96547  88.9%  9878 3402s
  4618  1973     cutoff   13      -6104.6424 -674.96547  88.9%  9969 3487s
  4780  2051     cutoff   14      -6104.6424 -674.96547  88.9% 10102 3571s
  5007  2046 -5818.4819   11  351 -6104.6424 -674.96547  88.9% 10166 3600s

Cutting planes:
  Learned: 1
  Implied bound: 309
  MIR: 4784
  Flow cover: 4193
  Zero half: 12
  RLT: 78
  Relax-and-lift: 571

Explored 5095 nodes (52562381 simplex iterations) in 3600.09 seconds (8315.32 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -6104.64 -6115.13 -6171.82 ... -6232.86

Time limit reached
Best objective -6.104642364830e+03, best bound -9.954509431680e+02, gap 83.6935%
  WARNING: Time limit reached. Using best solution found (gap: 83.69%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 3600.11s
  Master Objective (UB) = -6104.64, θ = 110261.38
  Upper Bound (UB) = -6104.64

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 110261.38
  [DEBUG]   ✓ Scenario 0: θ = 110261.38 ≤ Q = 110261.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 110261.38 ≤ Q = 110261.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 110261.38 ≤ Q = 110261.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 110261.38 ≤ Q = 110261.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 110261.38 ≤ Q = 110261.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 110261.38 ≤ Q = 110261.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 110261.38 ≤ Q = 110261.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 110261.38 ≤ Q = 110261.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 110261.38 ≤ Q = 110261.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 110261.38 ≤ Q = 110261.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 110261.38 ≤ Q = 110261.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 110261.38 ≤ Q = 110261.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 110261.38 ≤ Q = 110261.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 110261.38 ≤ Q = 110261.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 110261.38 ≤ Q = 110261.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 110261.38 ≤ Q = 110261.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 110261.38 ≤ Q = 110261.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 110261.38 ≤ Q = 110261.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 110261.38 ≤ Q = 110261.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 110261.38 ≤ Q = 110261.38 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 20] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x698648f8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x698648f8
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.193638e+13
Presolve removed 2602 rows and 1895 columns
Presolve time: 0.00s
Presolved: 491 rows, 494 columns, 1384 nonzeros
Found heuristic solution: objective 6145423.1276
Variable types: 334 continuous, 160 integer (160 binary)

Root relaxation: objective -1.183715e+05, 232 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -118371.50    0  122 6145423.13 -118371.50   102%     -    0s
H    0     0                    -85759.91604 -118371.50  38.0%     -    0s
H    0     0                    -86354.28197 -118371.50  37.1%     -    0s
     0     0 -93302.100    0   99 -86354.282 -93302.100  8.05%     -    0s
H    0     0                    -88952.60532 -93184.932  4.76%     -    0s
H    0     0                    -89254.53497 -93184.932  4.40%     -    0s
H    0     0                    -89989.60093 -93184.932  3.55%     -    0s
H    0     0                    -90291.53059 -93184.932  3.20%     -    0s
     0     0 -92706.776    0  102 -90291.531 -92706.776  2.67%     -    0s
H    0     0                    -90484.29348 -92615.671  2.36%     -    0s
     0     0 -92418.442    0  102 -90484.293 -92418.442  2.14%     -    0s
     0     0 -92401.871    0  100 -90484.293 -92401.871  2.12%     -    0s
     0     0 -92093.434    0  104 -90484.293 -92093.434  1.78%     -    0s
     0     0 -92079.019    0  104 -90484.293 -92079.019  1.76%     -    0s
     0     0 -91935.131    0   94 -90484.293 -91935.131  1.60%     -    0s
     0     0 -91934.064    0   94 -90484.293 -91934.064  1.60%     -    0s
     0     2 -91934.064    0   94 -90484.293 -91934.064  1.60%     -    0s
H   38    54                    -90568.16731 -91603.451  1.14%  11.5    0s
H   49    54                    -90637.46537 -91603.451  1.07%  12.6    0s
H   50    53                    -90785.16722 -91603.451  0.90%  13.0    0s
H  393   156                    -90809.83804 -91388.004  0.64%   7.1    0s
H  447   156                    -90844.16556 -91388.004  0.60%   7.1    0s
* 1253    22              20    -90848.76141 -91111.367  0.29%   6.5    0s
* 1342     4              17    -90849.17329 -90889.555  0.04%   6.5    0s

Cutting planes:
  Gomory: 34
  MIR: 253
  RLT: 7
  BQP: 1

Explored 1350 nodes (9237 simplex iterations) in 0.20 seconds (0.10 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -90849.2 -90848.8 -90844.2 ... -89989.6

Optimal solution found (tolerance 1.00e-04)
Best objective -9.084917328705e+04, best bound -9.085196131190e+04, gap 0.0031%
  Subproblem solved in 0.22s
  Worst-case operational profit (Z_SP) = 108041.94
  Scenario: 16 demand increases, 44 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -90849.17
  [DEBUG]   S×d_nominal = 198891.11
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 198891.11 + -90849.17 = 108041.94
  [DEBUG]   Current θ from Master = 110261.38
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2219.45 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -8324.09
  Lower Bound (LB) = -7795.12
  Gap (UB-LB) = 1690.4766, Absolute Gap = 1690.4766, Relative Gap = 0.276917
  Not converged yet (gap = 1690.48 > ε = 200)

  [DEBUG] Adding NEW scenario 20 to Master Problem...
  [DEBUG] New scenario pattern: 16 increases, 44 decreases
    [DEBUG] Scenario 20 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 20 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 20]
    [DEBUG]   - Total constraints in model: 322473
    [DEBUG]   - Total variables in model: 133300
  [DEBUG] Total scenarios in Master: 21
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 21
================================================================================
[Iteration 21] Solving Master Problem...
  Current scenarios in Master: 21
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 322473 rows, 133300 columns and 913370 nonzeros
Model fingerprint: 0x64156fe8
Variable types: 131041 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [9e-02, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 148910 rows and 60490 columns
Presolve time: 3.12s
Presolved: 173563 rows, 72810 columns, 1070331 nonzeros
Variable types: 70551 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -371500.8959
Found heuristic solution: objective -172304.4497

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.44s

Barrier statistics:
 Dense cols : 1159
 AA' NZ     : 4.281e+06
 Factor NZ  : 1.200e+07 (roughly 200 MB of memory)
 Factor Ops : 4.177e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.67287147e+07  2.59632829e+08  8.69e+04 2.14e+01  6.50e+04     5s
   1  -1.26009666e+07  2.25179182e+08  6.05e+04 4.17e+01  4.50e+04     5s
   2  -4.70548673e+06  1.82088959e+08  2.14e+04 2.58e+01  1.64e+04     6s
   3  -7.97910112e+05  1.33566342e+08  1.06e+03 1.40e+00  1.20e+03     6s
   4  -5.99128690e+05  7.42640423e+07  3.98e+02 5.93e-01  4.98e+02     6s
   5  -5.33880680e+05  5.59138158e+07  2.05e+02 2.79e-01  3.06e+02     6s
   6  -4.63399130e+05  4.24451732e+07  6.83e+01 1.07e-01  1.75e+02     6s
   7  -4.22991403e+05  3.02886894e+07  3.11e+01 7.26e-02  1.13e+02     6s
   8  -3.49164160e+05  2.10309698e+07  1.12e+01 4.96e-02  7.21e+01     6s
   9  -2.24916044e+05  7.97243568e+06  5.20e+00 1.87e-02  2.70e+01     6s
  10  -1.42140502e+05  4.08179009e+06  2.75e+00 9.25e-03  1.37e+01     6s
  11  -1.27019059e+05  3.39296587e+06  2.07e+00 7.61e-03  1.13e+01     6s
  12  -1.00541404e+05  2.10353404e+06  1.19e+00 4.69e-03  7.05e+00     6s
  13  -8.70671028e+04  1.54427644e+06  8.73e-01 3.46e-03  5.21e+00     6s
  14  -5.74259012e+04  8.23939693e+05  3.03e-01 1.77e-03  2.80e+00     6s
  15  -3.28707586e+04  2.98546102e+05  1.13e-01 8.61e-04  1.05e+00     6s
  16  -2.08299079e+04  1.66678457e+05  7.27e-02 3.84e-04  5.94e-01     6s
  17  -1.73389291e+04  1.23363658e+05  6.34e-02 6.05e-04  4.46e-01     6s
  18  -1.09506112e+04  8.42582760e+04  4.76e-02 1.30e-03  3.02e-01     7s
  19  -4.34424260e+03  5.75334814e+04  3.25e-02 2.25e-03  1.96e-01     7s
  20  -1.74723265e+03  4.86706063e+04  2.72e-02 1.86e-03  1.60e-01     7s
  21   4.18864673e+02  4.32726991e+04  2.27e-02 1.71e-03  1.36e-01     7s
  22   1.31358468e+03  4.01855334e+04  2.09e-02 1.54e-03  1.23e-01     7s
  23   3.29870652e+03  3.67378721e+04  1.72e-02 1.34e-03  1.06e-01     7s
  24   5.33941366e+03  3.05170880e+04  1.35e-02 9.78e-04  7.98e-02     7s
  25   6.86920128e+03  2.62065804e+04  1.09e-02 7.40e-04  6.13e-02     7s
  26   8.03633175e+03  2.33615570e+04  9.14e-03 5.89e-04  4.85e-02     7s
  27   9.43481738e+03  2.15806714e+04  7.14e-03 4.62e-04  3.85e-02     7s
  28   1.02590058e+04  1.98223922e+04  6.01e-03 5.09e-04  3.03e-02     7s
  29   1.12482546e+04  1.85719183e+04  4.67e-03 3.65e-04  2.32e-02     8s
  30   1.16427504e+04  1.73224454e+04  4.14e-03 2.24e-04  1.80e-02     8s
  31   1.22276145e+04  1.66835241e+04  3.40e-03 1.66e-04  1.41e-02     8s
  32   1.29201606e+04  1.63817271e+04  2.52e-03 1.37e-04  1.10e-02     8s
  33   1.31830082e+04  1.61738684e+04  2.18e-03 1.19e-04  9.48e-03     8s
  34   1.36310725e+04  1.58257853e+04  1.57e-03 1.27e-04  6.95e-03     8s
  35   1.40301535e+04  1.55025303e+04  1.05e-03 8.25e-05  4.67e-03     8s
  36   1.43467370e+04  1.52755757e+04  6.42e-04 5.07e-05  2.94e-03     8s
  37   1.45767912e+04  1.51606811e+04  3.67e-04 4.34e-05  1.85e-03     8s
  38   1.46142630e+04  1.50403456e+04  3.21e-04 2.30e-05  1.35e-03     8s
  39   1.46640892e+04  1.50133052e+04  2.64e-04 1.73e-05  1.11e-03     8s
  40   1.47404377e+04  1.49821376e+04  1.76e-04 1.30e-05  7.66e-04     9s
  41   1.48171932e+04  1.49571368e+04  9.36e-05 7.53e-06  4.43e-04     9s
  42   1.48266910e+04  1.49469990e+04  8.29e-05 7.21e-06  3.81e-04     9s
  43   1.48462572e+04  1.49295231e+04  6.23e-05 4.27e-06  2.64e-04     9s
  44   1.48534658e+04  1.49263448e+04  5.46e-05 3.74e-06  2.31e-04     9s
  45   1.48610628e+04  1.49178301e+04  4.64e-05 2.24e-06  1.80e-04     9s
  46   1.48852825e+04  1.49097842e+04  2.02e-05 8.44e-07  7.77e-05     9s
  47   1.48864555e+04  1.49090232e+04  1.89e-05 7.31e-07  7.15e-05     9s
  48   1.48955019e+04  1.49068651e+04  8.88e-06 4.08e-07  3.60e-05     9s
  49   1.48989230e+04  1.49061976e+04  5.22e-06 2.83e-07  2.31e-05     9s
  50   1.49030300e+04  1.49055681e+04  8.53e-07 2.18e-07  8.04e-06    10s
  51   1.49033954e+04  1.49052822e+04  5.64e-07 1.86e-07  5.98e-06    10s
  52   1.49038371e+04  1.49042587e+04  2.02e-07 1.15e-07  1.34e-06    10s
  53   1.49038500e+04  1.49042512e+04  2.88e-07 2.21e-06  1.27e-06    10s
  54   1.49040383e+04  1.49041120e+04  1.64e-07 2.81e-06  2.34e-07    10s
  55   1.49040624e+04  1.49041050e+04  1.85e-07 9.71e-07  1.36e-07    10s
  56   1.49040944e+04  1.49041014e+04  2.04e-07 2.99e-07  2.21e-08    10s
  57   1.49040998e+04  1.49041014e+04  1.53e-06 2.79e-08  4.81e-09    10s
  58   1.49041012e+04  1.49041014e+04  1.54e-07 1.94e-08  3.51e-10    10s

Barrier solved model in 58 iterations and 10.45 seconds (18.12 work units)
Optimal objective 1.49041012e+04


Root crossover log...

  141721 DPushes remaining with DInf 0.0000000e+00                11s
   56408 DPushes remaining with DInf 0.0000000e+00                15s
   31036 DPushes remaining with DInf 0.0000000e+00                20s
    3416 DPushes remaining with DInf 0.0000000e+00                25s
       0 DPushes remaining with DInf 0.0000000e+00                27s

   14257 PPushes remaining with PInf 2.4754000e-04                27s
       0 PPushes remaining with PInf 0.0000000e+00                28s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.8502946e+03     28s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   81348    1.4904101e+04   0.000000e+00   3.850295e+03     29s
   81518    1.4904101e+04   0.000000e+00   0.000000e+00     29s
   81518    1.4904101e+04   0.000000e+00   0.000000e+00     29s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 1.490410e+04, 81518 iterations, 24.75 seconds (39.57 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 14904.1014    0  369 -172304.45 14904.1014   109%     -   30s
H    0     0                    -88130.78557 14904.1014   117%     -   33s
H    0     0                    -87892.22047 14904.1014   117%     -   33s
H    0     0                    -87645.38766 14904.1014   117%     -   33s
H    0     0                    -49077.69205 14904.1014   130%     -   33s
H    0     0                    -47884.11660 14904.1014   131%     -   33s
H    0     0                    -47578.27806 14904.1014   131%     -   34s
H    0     0                    -46681.09960 14904.1014   132%     -   34s
     0     0 8352.64993    0  409 -46681.100 8352.64993   118%     -   92s
H    0     0                    -19889.44847 8350.66070   142%     -   93s
H    0     0                    -19599.79961 8350.66070   143%     -   93s
     0     0 7743.61897    0  404 -19599.800 7743.61897   140%     -  128s
     0     0 7711.19725    0  390 -19599.800 7711.19725   139%     -  140s
     0     0 7700.22396    0  390 -19599.800 7700.22396   139%     -  147s
     0     0 7687.39101    0  387 -19599.800 7687.39101   139%     -  155s
     0     0 7687.03737    0  387 -19599.800 7687.03737   139%     -  158s
     0     0 6431.19530    0  372 -19599.800 6431.19530   133%     -  221s
H    0     0                    -17818.89594 6427.42804   136%     -  222s
H    0     0                    -17412.13028 6427.42804   137%     -  222s
     0     0 6142.33891    0  429 -17412.130 6142.33891   135%     -  253s
     0     0 6065.44263    0  389 -17412.130 6065.44263   135%     -  273s
     0     0 5855.78716    0  446 -17412.130 5855.78716   134%     -  298s
     0     0 5709.81223    0  422 -17412.130 5709.81223   133%     -  321s
     0     0 5635.90531    0  406 -17412.130 5635.90531   132%     -  340s
     0     0 5622.06115    0  416 -17412.130 5622.06115   132%     -  350s
     0     0 5568.25401    0  420 -17412.130 5568.25401   132%     -  366s
     0     0 5528.72961    0  433 -17412.130 5528.72961   132%     -  374s
     0     0 5451.77398    0  424 -17412.130 5451.77398   131%     -  386s
     0     0 5316.84264    0  424 -17412.130 5316.84264   131%     -  413s
     0     0 5292.79890    0  418 -17412.130 5292.79890   130%     -  425s
     0     0 5288.39372    0  423 -17412.130 5288.39372   130%     -  430s
     0     0 5280.58422    0  379 -17412.130 5280.58422   130%     -  440s
     0     0 5277.36687    0  382 -17412.130 5277.36687   130%     -  444s
     0     0 5235.11747    0  385 -17412.130 5235.11747   130%     -  454s
     0     0 5218.91682    0  370 -17412.130 5218.91682   130%     -  462s
     0     0 5201.27943    0  383 -17412.130 5201.27943   130%     -  471s
     0     0 5193.50578    0  382 -17412.130 5193.50578   130%     -  477s
     0     0 5176.34594    0  451 -17412.130 5176.34594   130%     -  491s
     0     0 5174.13720    0  451 -17412.130 5174.13720   130%     -  495s
     0     0 5173.27084    0  457 -17412.130 5173.27084   130%     -  499s
     0     0 3957.37622    0  468 -17412.130 3957.37622   123%     -  595s
H    0     0                    -14433.66185 3957.16674   127%     -  595s
H    0     0                    -12066.73613 3957.16674   133%     -  595s
H    0     0                    -10837.53479 3957.16674   137%     -  595s
H    0     0                    -9724.501295 3957.16674   141%     -  595s
H    0     0                    -9607.563880 3957.16674   141%     -  596s
     0     0 3819.73286    0  546 -9607.5639 3819.73286   140%     -  620s
     0     0 3720.03225    0  407 -9607.5639 3720.03225   139%     -  633s
     0     0 3601.96120    0  555 -9607.5639 3601.96120   137%     -  649s
     0     0 3489.77710    0  554 -9607.5639 3489.77710   136%     -  667s
     0     0 3477.64617    0  561 -9607.5639 3477.64617   136%     -  674s
     0     0 3429.22386    0  571 -9607.5639 3429.22386   136%     -  687s
     0     0 3384.16863    0  576 -9607.5639 3384.16863   135%     -  700s
     0     0 3376.33033    0  578 -9607.5639 3376.33033   135%     -  704s
     0     0 3375.09905    0  583 -9607.5639 3375.09905   135%     -  706s
     0     0 2973.39728    0  499 -9607.5639 2973.39728   131%     -  742s
     0     0 2867.15554    0  493 -9607.5639 2867.15554   130%     -  763s
     0     0 2822.50107    0  512 -9607.5639 2822.50107   129%     -  775s
     0     0 2790.57364    0  502 -9607.5639 2790.57364   129%     -  782s
     0     0 2761.59582    0  502 -9607.5639 2761.59582   129%     -  792s
     0     0 2682.86543    0  515 -9607.5639 2682.86543   128%     -  804s
     0     0 2660.90183    0  510 -9607.5639 2660.90183   128%     -  812s
     0     0 2636.72549    0  510 -9607.5639 2636.72549   127%     -  819s
     0     0 2626.49786    0  512 -9607.5639 2626.49786   127%     -  823s
     0     0 2621.39478    0  506 -9607.5639 2621.39478   127%     -  829s
     0     0 2619.78967    0  508 -9607.5639 2619.78967   127%     -  833s
     0     0 2616.98451    0  586 -9607.5639 2616.98451   127%     -  837s
     0     0 2600.07631    0  515 -9607.5639 2600.07631   127%     -  849s
     0     0 2596.01936    0  515 -9607.5639 2596.01936   127%     -  853s
     0     0 2594.80977    0  517 -9607.5639 2594.80977   127%     -  854s
     0     0 2440.42634    0  642 -9607.5639 2440.42634   125%     -  884s
H    0     0                    -9560.243626 2438.97699   126%     -  885s
     0     0 2365.73559    0  642 -9560.2436 2365.73559   125%     -  903s
     0     0 2354.47451    0  555 -9560.2436 2354.47451   125%     -  913s
     0     0 2350.93981    0  640 -9560.2436 2350.93981   125%     -  919s
     0     0 2347.79906    0  642 -9560.2436 2347.79906   125%     -  923s
     0     0 2337.20897    0  627 -9560.2436 2337.20897   124%     -  933s
     0     0 2331.64397    0  647 -9560.2436 2331.64397   124%     -  940s
     0     0 2298.53691    0  635 -9560.2436 2298.53691   124%     -  949s
     0     0 2292.70472    0  643 -9560.2436 2292.70472   124%     -  955s
     0     0 2279.44050    0  636 -9560.2436 2279.44050   124%     -  961s
     0     0 2277.67840    0  647 -9560.2436 2277.67840   124%     -  964s
     0     0 2273.52904    0  648 -9560.2436 2273.52904   124%     -  968s
     0     0 2270.77054    0  638 -9560.2436 2270.77054   124%     -  970s
     0     0 2268.72045    0  642 -9560.2436 2268.72045   124%     -  972s
     0     0 2260.16518    0  644 -9560.2436 2260.16518   124%     -  976s
     0     0 2254.25843    0  646 -9560.2436 2254.25843   124%     -  979s
     0     0 2253.60806    0  645 -9560.2436 2253.60806   124%     -  981s
     0     0 2184.48469    0  527 -9560.2436 2184.48469   123%     - 1004s
H    0     0                    -9103.809801 2183.33343   124%     - 1020s
H    0     0                    -8197.128481 2183.33343   127%     - 1020s
H    0     0                    -8113.827254 2183.33343   127%     - 1023s
     0     0 2163.99817    0  541 -8113.8273 2163.99817   127%     - 1036s
     0     0 2159.74569    0  552 -8113.8273 2159.74569   127%     - 1041s
     0     0 2151.08018    0  544 -8113.8273 2151.08018   127%     - 1046s
     0     0 2137.38826    0  542 -8113.8273 2137.38826   126%     - 1052s
     0     0 2124.69279    0  543 -8113.8273 2124.69279   126%     - 1056s
     0     0 2122.23130    0  547 -8113.8273 2122.23130   126%     - 1060s
     0     0 2120.35632    0  547 -8113.8273 2120.35632   126%     - 1063s
     0     0 2120.15544    0  550 -8113.8273 2120.15544   126%     - 1065s
     0     0 2022.16147    0  545 -8113.8273 2022.16147   125%     - 1087s
     0     0 1964.29051    0  597 -8113.8273 1964.29051   124%     - 1101s
     0     0 1945.34262    0  598 -8113.8273 1945.34262   124%     - 1112s
     0     0 1933.58033    0  603 -8113.8273 1933.58033   124%     - 1121s
     0     0 1930.66958    0  610 -8113.8273 1930.66958   124%     - 1124s
     0     0 1915.81929    0  606 -8113.8273 1915.81929   124%     - 1132s
     0     0 1914.55172    0  602 -8113.8273 1914.55172   124%     - 1135s
     0     0 1845.13571    0  557 -8113.8273 1845.13571   123%     - 1157s
H    0     0                    -8098.570418 1844.59626   123%     - 1161s
     0     0 1826.86444    0  559 -8098.5704 1826.86444   123%     - 1173s
     0     0 1817.58683    0  559 -8098.5704 1817.58683   122%     - 1178s
     0     0 1814.62610    0  573 -8098.5704 1814.62610   122%     - 1183s
     0     0 1809.44984    0  562 -8098.5704 1809.44984   122%     - 1194s
     0     0 1808.55826    0  566 -8098.5704 1808.55826   122%     - 1197s
     0     0 1749.08873    0  549 -8098.5704 1749.08873   122%     - 1216s
     0     0 1737.29320    0  556 -8098.5704 1737.29320   121%     - 1225s
     0     0 1730.14098    0  561 -8098.5704 1730.14098   121%     - 1235s
     0     0 1723.81973    0  554 -8098.5704 1723.81973   121%     - 1244s
     0     0 1721.44444    0  560 -8098.5704 1721.44444   121%     - 1251s
     0     0 1713.26374    0  617 -8098.5704 1713.26374   121%     - 1261s
     0     0 1709.00252    0  567 -8098.5704 1709.00252   121%     - 1266s
     0     0 1708.51418    0  573 -8098.5704 1708.51418   121%     - 1268s
     0     0 1665.11516    0  574 -8098.5704 1665.11516   121%     - 1279s
H    0     0                    -7956.858936 1662.86734   121%     - 1301s
H    0     0                    -7953.944256 1662.86734   121%     - 1302s
H    0     0                    -7933.977748 1662.86734   121%     - 1302s
     0     0 1657.71762    0  575 -7933.9777 1657.71762   121%     - 1307s
     0     0 1652.52501    0  579 -7933.9777 1652.52501   121%     - 1312s
     0     0 1651.62400    0  574 -7933.9777 1651.62400   121%     - 1313s
     0     0 1640.10535    0  573 -7933.9777 1640.10535   121%     - 1321s
H    0     0                    -7918.462567 1639.25607   121%     - 1322s
     0     0 1638.90178    0  575 -7918.4626 1638.90178   121%     - 1326s
     0     0 1632.34731    0  560 -7918.4626 1632.34731   121%     - 1334s
     0     0 1623.69773    0  556 -7918.4626 1623.69773   121%     - 1351s
     0     0 1623.22423    0  563 -7918.4626 1623.22423   120%     - 1354s
     0     0 1615.43692    0  559 -7918.4626 1615.43692   120%     - 1364s
     0     0 1611.11070    0  620 -7918.4626 1611.11070   120%     - 1370s
     0     0 1609.16560    0  554 -7918.4626 1609.16560   120%     - 1373s
     0     0 1608.28918    0  559 -7918.4626 1608.28918   120%     - 1378s
     0     0 1605.76489    0  559 -7918.4626 1605.76489   120%     - 1388s
     0     0 1604.73174    0  559 -7918.4626 1604.73174   120%     - 1401s
     0     2 1604.67202    0  559 -7918.4626 1604.67202   120%     - 2109s
     1     4 1595.32672    1  558 -7918.4626 1604.67202   120%  2793 2117s
     3     8 1549.82982    2  549 -7918.4626 1595.04695   120% 12603 2142s
     7    15 1517.96392    3  558 -7918.4626 1549.43472   120% 15789 2178s
    14    30 1366.95417    4  585 -7918.4626 1517.89623   119% 18230 2207s
    29    46 -7533.5177    5  166 -7918.4626 1366.82519   117% 20772 2273s
    45    73 -1968.6083    6  294 -7918.4626 1366.72409   117% 22543 2319s
    75   128 -2393.4600    7  267 -7918.4626 1366.72409   117% 17146 2382s
   144   160 -2522.6296   10  264 -7918.4626 1366.72409   117% 13585 2406s
   176   186 -2671.7539   11  268 -7918.4626 1366.72409   117% 12578 2436s
   216   212 -2786.8985   12  260 -7918.4626 1366.72409   117% 11271 2467s
   261   287 -3750.3047   14  174 -7918.4626 1366.72409   117% 10278 2497s
   336   364 -4197.0791   19  180 -7918.4626 1366.72409   117%  9310 2525s
   418   415 -4321.6108   24  176 -7918.4626 1366.72409   117%  8800 2548s
   497   459 -4615.9419   25  235 -7918.4626 1366.72409   117%  8222 2567s
H  502   459                    -7650.206297 1366.72409   118%  8229 2567s
   572   499 -5200.9769   27  155 -7650.2063 1366.72409   118%  7944 2596s
   652   550 -5716.7511   30  242 -7650.2063 1366.72409   118%  7665 2619s
   717   579 -6532.9278   32  320 -7650.2063 1366.72409   118%  7525 2642s
   798   618 -7167.6828   35  286 -7650.2063 1366.72409   118%  7405 2664s
   860   659 -7223.6133   40  222 -7650.2063 1366.72409   118%  7314 2688s
   942   715 -7444.8538   44  286 -7650.2063 1366.72409   118%  7132 2709s
  1022   765 infeasible   47      -7650.2063 1366.72409   118%  6955 2732s
  1124   804 -4860.7009   21  304 -7650.2063 1366.72409   118%  6749 2756s
  1216   842 -7610.4783   22  139 -7650.2063 1366.72409   118%  6648 2781s
  1310   867 -5268.0413   22  365 -7650.2063 1366.72409   118%  6529 2809s
  1401   893 -5635.9629   24  363 -7650.2063 1366.72409   118%  6419 2838s
  1480   978 infeasible   26      -7650.2063 1366.72409   118%  6413 2868s
  1591  1052     cutoff   17      -7650.2063 1366.72409   118%  6304 2897s
  1702  1174 -6922.9688   14  165 -7650.2063 1366.72409   118%  6237 2925s
  1879  1169 -7302.5257   16  163 -7650.2063 1366.72409   118%  5991 2957s
  2010  1197 infeasible   17      -7650.2063 1366.72409   118%  5912 2991s
  2105  1210 -1464.7014   10  480 -7650.2063 1366.72409   118%  5962 3025s
H 2199  1218                    -7632.072635 1366.72409   118%  5980 3061s
H 2201  1218                    -7174.035384 1366.72409   119%  5983 3061s
H 2230  1218                    -6856.929432 1366.72409   120%  6083 3061s
  2237  1234 -2585.3665   12  356 -6856.9294 1366.72409   120%  6110 3099s
  2307  1274 -5482.6235   14  307 -6856.9294 1366.72409   120%  6240 3138s
  2361  1305 -6024.0168   15  291 -6856.9294 1366.72409   120%  6461 3182s
  2422  1311     cutoff   20      -6856.9294 1366.72409   120%  6653 3225s
  2482  1335 -4408.1188   19  272 -6856.9294 1366.72409   120%  6744 3270s
  2569  1349     cutoff   20      -6856.9294 1168.57463   117%  6865 3314s
H 2572  1349                    -6801.277156 1168.57463   117%  6865 3314s
H 2574  1349                    -6621.341815 1168.57463   118%  6875 3314s
H 2577  1349                    -6500.105345 1168.57463   118%  6883 3314s
H 2585  1349                    -6461.851420 1168.57463   118%  6892 3315s
  2623  1380 1051.55377    6  570 -6461.8514 1168.57463   118%  6931 3359s
  2721  1405 -1268.0716    8  522 -6461.8514 1168.57463   118%  7084 3408s
  2796  1434 -1585.9316    9  567 -6461.8514 1168.57463   118%  7248 3457s
  2883  1468 -2490.8275    9  394 -6461.8514 1168.57463   118%  7396 3505s
  2985  1487 -2872.3786   11  406 -6461.8514 1116.42779   117%  7502 3567s
  3078  1504 -3554.7833   13  429 -6461.8514 1116.42779   117%  7663 3600s

Cutting planes:
  Learned: 1
  Implied bound: 258
  MIR: 4040
  Flow cover: 3559
  Zero half: 12
  RLT: 62
  Relax-and-lift: 541

Explored 3140 nodes (25342726 simplex iterations) in 3600.09 seconds (8046.87 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -6461.85 -6500.11 -6621.34 ... -7933.98

Time limit reached
Best objective -6.461851419630e+03, best bound 1.116427790498e+03, gap 117.2772%
  WARNING: Time limit reached. Using best solution found (gap: 117.28%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 3600.10s
  Master Objective (UB) = -6461.85, θ = 110021.39
  Upper Bound (UB) = -6461.85

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 110021.39
  [DEBUG]   ✓ Scenario 0: θ = 110021.39 ≤ Q = 110021.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 110021.39 ≤ Q = 110021.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 110021.39 ≤ Q = 110021.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 110021.39 ≤ Q = 110021.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 110021.39 ≤ Q = 110021.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 110021.39 ≤ Q = 110021.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 110021.39 ≤ Q = 110021.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 110021.39 ≤ Q = 110021.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 110021.39 ≤ Q = 110021.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 110021.39 ≤ Q = 110021.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 110021.39 ≤ Q = 110021.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 110021.39 ≤ Q = 110021.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 110021.39 ≤ Q = 110021.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 110021.39 ≤ Q = 110021.39 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 110021.39 ≤ Q = 110021.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 110021.39 ≤ Q = 110021.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 110021.39 ≤ Q = 110021.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 110021.39 ≤ Q = 110021.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 110021.39 ≤ Q = 110021.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 110021.39 ≤ Q = 110021.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 20: θ = 110021.39 ≤ Q = 110021.39 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 21] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x41c1fdfb
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xbe3e0205
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.195513e+13
Presolve removed 2602 rows and 1895 columns
Presolve time: 0.01s
Presolved: 491 rows, 494 columns, 1384 nonzeros
Found heuristic solution: objective 6159912.8484
Variable types: 334 continuous, 160 integer (160 binary)

Root relaxation: objective -1.185026e+05, 232 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -118502.60    0  122 6159912.85 -118502.60   102%     -    0s
H    0     0                    -85837.68270 -118502.60  38.1%     -    0s
H    0     0                    -86421.78985 -118502.60  37.1%     -    0s
     0     0 -92513.485    0   98 -86421.790 -92513.485  7.05%     -    0s
H    0     0                    -88694.94415 -92428.699  4.21%     -    0s
H    0     0                    -88996.87381 -92428.699  3.86%     -    0s
H    0     0                    -89363.31014 -92428.699  3.43%     -    0s
H    0     0                    -89665.23980 -92428.699  3.08%     -    0s
     0     0 -91986.491    0   96 -89665.240 -91986.491  2.59%     -    0s
     0     0 -91912.878    0   93 -89665.240 -91912.878  2.51%     -    0s
H    0     0                    -89867.47201 -91912.878  2.28%     -    0s
     0     0 -91780.152    0   91 -89867.472 -91780.152  2.13%     -    0s
H    0     0                    -90500.78328 -91778.568  1.41%     -    0s
H    0     0                    -90569.00976 -91778.568  1.34%     -    0s
H    0     0                    -90692.32487 -91778.568  1.20%     -    0s
     0     0 -91776.885    0   90 -90692.325 -91776.885  1.20%     -    0s
     0     0 -91621.674    0   92 -90692.325 -91621.674  1.02%     -    0s
     0     0 -91610.850    0   92 -90692.325 -91610.850  1.01%     -    0s
H    0     0                    -91067.54518 -91610.850  0.60%     -    0s
H    0     0                    -91099.55685 -91610.850  0.56%     -    0s
H    0     0                    -91109.45027 -91610.850  0.55%     -    0s
H    0     2                    -91117.55055 -91610.850  0.54%     -    0s
     0     2 -91610.850    0   92 -91117.551 -91610.850  0.54%     -    0s

Cutting planes:
  Gomory: 24
  MIR: 140

Explored 156 nodes (1322 simplex iterations) in 0.15 seconds (0.07 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -91117.6 -91109.5 -91099.6 ... -89363.3
No other solutions better than -91117.6

Optimal solution found (tolerance 1.00e-04)
Best objective -9.111755054784e+04, best bound -9.111755054784e+04, gap 0.0000%
  Subproblem solved in 0.17s
  Worst-case operational profit (Z_SP) = 107612.76
  Scenario: 16 demand increases, 44 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -91117.55
  [DEBUG]   S×d_nominal = 198730.31
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 198730.31 + -91117.55 = 107612.76
  [DEBUG]   Current θ from Master = 110021.39
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2408.62 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -8870.47
  Lower Bound (LB) = -7795.12
  Gap (UB-LB) = 1333.2675, Absolute Gap = 1333.2675, Relative Gap = 0.206329
  Not converged yet (gap = 1333.27 > ε = 200)

  [DEBUG] Adding NEW scenario 21 to Master Problem...
  [DEBUG] New scenario pattern: 16 increases, 44 decreases
    [DEBUG] Scenario 21 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 21 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 21]
    [DEBUG]   - Total constraints in model: 337763
    [DEBUG]   - Total variables in model: 139540
  [DEBUG] Total scenarios in Master: 22
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 22
================================================================================
[Iteration 22] Solving Master Problem...
  Current scenarios in Master: 22
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 337763 rows, 139540 columns and 956601 nonzeros
Model fingerprint: 0xe4d7d93b
Variable types: 137281 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [9e-02, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 156020 rows and 63380 columns
Presolve time: 4.03s
Presolved: 181743 rows, 76160 columns, 1120752 nonzeros
Variable types: 73901 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -371500.8959
Found heuristic solution: objective -172304.4497

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.56s

Barrier statistics:
 Dense cols : 1159
 AA' NZ     : 4.617e+06
 Factor NZ  : 1.284e+07 (roughly 200 MB of memory)
 Factor Ops : 4.430e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.67379896e+07  2.69610000e+08  8.70e+04 2.14e+01  6.47e+04     8s
   1  -1.26084844e+07  2.33683135e+08  6.05e+04 4.08e+01  4.47e+04     8s
   2  -4.83485435e+06  1.88686249e+08  2.20e+04 2.52e+01  1.68e+04     8s
   3  -8.18138833e+05  1.42650928e+08  1.09e+03 2.96e+00  1.23e+03     8s
   4  -6.06051918e+05  8.77134426e+07  3.77e+02 1.54e+00  5.17e+02     8s
   5  -5.37340755e+05  6.51675302e+07  2.05e+02 9.97e-01  3.26e+02     8s
   6  -4.81551132e+05  4.99408005e+07  6.99e+01 6.37e-01  1.93e+02     8s
   7  -4.44074482e+05  3.59161345e+07  3.37e+01 3.53e-01  1.27e+02     8s
   8  -3.74622880e+05  2.60336224e+07  9.37e+00 1.68e-01  8.38e+01     8s
   9  -3.00367918e+05  9.79489303e+06  3.36e+00 1.71e-02  3.12e+01     8s
  10  -1.54967634e+05  4.87882513e+06  1.69e+00 8.25e-03  1.54e+01     8s
  11  -1.44475739e+05  3.56329661e+06  1.40e+00 6.03e-03  1.13e+01     8s
  12  -1.29104488e+05  3.05552832e+06  1.11e+00 5.18e-03  9.71e+00     8s
  13  -1.04891546e+05  2.08869054e+06  6.96e-01 3.51e-03  6.67e+00     8s
  14  -8.98841512e+04  1.75542037e+06  5.22e-01 2.96e-03  5.60e+00     8s
  15  -6.17322601e+04  1.15734722e+06  2.14e-01 3.02e-03  3.69e+00     9s
  16  -3.81798254e+04  3.69892651e+05  8.39e-02 6.18e-04  1.23e+00     9s
  17  -1.99810445e+04  1.92838941e+05  4.20e-02 6.41e-04  6.44e-01     9s
  18  -1.64522381e+04  1.55782027e+05  3.61e-02 6.05e-04  5.21e-01     9s
  19  -1.10101200e+04  1.05449275e+05  2.72e-02 1.38e-03  3.52e-01     9s
  20  -7.63714454e+03  7.74767331e+04  2.26e-02 1.82e-03  2.57e-01     9s
  21  -2.79956361e+03  5.61514243e+04  1.67e-02 2.60e-03  1.78e-01     9s
  22  -6.69442877e+02  4.03575543e+04  1.43e-02 2.84e-03  1.24e-01     9s
  23   1.12130399e+03  3.72713419e+04  1.24e-02 2.52e-03  1.09e-01     9s
  24   1.68138066e+03  3.35649090e+04  1.19e-02 2.14e-03  9.65e-02     9s
  25   4.72708327e+03  2.96219384e+04  8.71e-03 1.70e-03  7.53e-02     9s
  26   6.34575532e+03  2.64174976e+04  7.15e-03 1.34e-03  6.07e-02    10s
  27   6.99716794e+03  2.42030410e+04  6.53e-03 1.12e-03  5.21e-02    10s
  28   9.56522766e+03  2.27539737e+04  4.21e-03 9.40e-04  3.99e-02    10s
  29   1.04447660e+04  2.12736651e+04  3.46e-03 7.60e-04  3.28e-02    10s
  30   1.09974757e+04  1.89419266e+04  3.00e-03 4.46e-04  2.40e-02    10s
  31   1.19008932e+04  1.82956483e+04  2.26e-03 3.77e-04  1.93e-02    10s
  32   1.22266887e+04  1.73778525e+04  2.00e-03 2.77e-04  1.56e-02    10s
  33   1.27921353e+04  1.65700697e+04  1.56e-03 1.87e-04  1.14e-02    10s
  34   1.33867677e+04  1.60441466e+04  1.09e-03 1.27e-04  8.04e-03    10s
  35   1.35067156e+04  1.56491111e+04  1.00e-03 8.35e-05  6.48e-03    10s
  36   1.39072574e+04  1.53568644e+04  7.01e-04 5.04e-05  4.39e-03    11s
  37   1.42267580e+04  1.52790364e+04  4.77e-04 4.15e-05  3.18e-03    11s
  38   1.44368948e+04  1.51882145e+04  3.21e-04 3.11e-05  2.27e-03    11s
  39   1.46507128e+04  1.50320026e+04  1.71e-04 1.39e-05  1.15e-03    11s
  40   1.46864188e+04  1.49939255e+04  1.46e-04 9.75e-06  9.30e-04    11s
  41   1.48010556e+04  1.49784981e+04  6.24e-05 8.05e-06  5.37e-04    11s
  42   1.48163339e+04  1.49583651e+04  5.23e-05 5.94e-06  4.30e-04    11s
  43   1.48236750e+04  1.49548066e+04  4.74e-05 5.58e-06  3.97e-04    11s
  44   1.48488818e+04  1.49423458e+04  3.00e-05 4.36e-06  2.83e-04    11s
  45   1.48548733e+04  1.49275244e+04  2.62e-05 4.26e-06  2.20e-04    11s
  46   1.48824909e+04  1.49064017e+04  8.74e-06 2.32e-06  7.23e-05    12s
  47   1.48963073e+04  1.48999217e+04  1.59e-06 1.33e-07  1.09e-05    12s
  48   1.48992156e+04  1.48997241e+04  9.01e-08 6.44e-08  1.54e-06    12s
  49   1.48994589e+04  1.48994810e+04  1.96e-09 4.82e-09  6.67e-08    12s
  50   1.48994609e+04  1.48994609e+04  2.02e-10 6.79e-11  1.40e-11    12s

Barrier solved model in 50 iterations and 11.99 seconds (18.06 work units)
Optimal objective 1.48994609e+04


Root crossover log...

  148652 DPushes remaining with DInf 0.0000000e+00                12s
   43563 DPushes remaining with DInf 0.0000000e+00                15s
     147 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                20s

    4735 PPushes remaining with PInf 2.5456550e-06                20s
       0 PPushes remaining with PInf 0.0000000e+00                21s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.4874549e+00     21s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   65923    1.4899461e+04   0.000000e+00   2.487455e+00     21s
   65925    1.4899461e+04   0.000000e+00   0.000000e+00     21s
   65925    1.4899461e+04   0.000000e+00   0.000000e+00     21s
Concurrent spin time: 1.21s

Solved with barrier

Root relaxation: objective 1.489946e+04, 65925 iterations, 16.81 seconds (24.13 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 14899.4609    0  369 -172304.45 14899.4609   109%     -   22s
H    0     0                    -109662.2553 14899.4609   114%     -   23s
H    0     0                    -104030.1029 14899.4609   114%     -   23s
H    0     0                    -104009.3116 14899.4609   114%     -   23s
H    0     0                    -88142.94548 14899.4609   117%     -   23s
H    0     0                    -88078.95226 14899.4609   117%     -   27s
H    0     0                    -44515.41536 14899.4609   133%     -   27s
H    0     0                    -44498.42945 14899.4609   133%     -   28s
     0     0 8019.09483    0  394 -44498.429 8019.09483   118%     -   90s
H    0     0                    -39909.27680 8018.83384   120%     -   92s
H    0     0                    -35050.07613 8018.83384   123%     -   92s
     0     0 7850.21035    0  389 -35050.076 7850.21035   122%     -  119s
     0     0 7845.12607    0  394 -35050.076 7845.12607   122%     -  125s
     0     0 7837.70245    0  393 -35050.076 7837.70245   122%     -  131s
     0     0 7828.22528    0  380 -35050.076 7828.22528   122%     -  144s
     0     0 7824.50533    0  380 -35050.076 7824.50533   122%     -  149s
     0     0 7793.46347    0  393 -35050.076 7793.46347   122%     -  165s
     0     0 7791.29688    0  395 -35050.076 7791.29688   122%     -  167s
     0     0 7791.19746    0  389 -35050.076 7791.19746   122%     -  170s
     0     0 5977.08389    0  382 -35050.076 5977.08389   117%     -  243s
H    0     0                    -25182.42523 5977.00715   124%     -  244s
H    0     0                    -25176.73434 5977.00715   124%     -  244s
H    0     0                    -24989.17703 5977.00715   124%     -  244s
     0     0 5484.70600    0  422 -24989.177 5484.70600   122%     -  278s
     0     0 5351.92607    0  428 -24989.177 5351.92607   121%     -  302s
     0     0 5314.62080    0  417 -24989.177 5314.62080   121%     -  332s
     0     0 5275.61713    0  418 -24989.177 5275.61713   121%     -  346s
     0     0 5257.65056    0  429 -24989.177 5257.65056   121%     -  359s
     0     0 5205.55406    0  438 -24989.177 5205.55406   121%     -  378s
     0     0 5194.82597    0  439 -24989.177 5194.82597   121%     -  389s
     0     0 5129.30567    0  443 -24989.177 5129.30567   121%     -  403s
     0     0 5110.52365    0  447 -24989.177 5110.52365   120%     -  417s
     0     0 5105.01414    0  455 -24989.177 5105.01414   120%     -  425s
     0     0 5103.25754    0  462 -24989.177 5103.25754   120%     -  430s
     0     0 5071.18701    0  450 -24989.177 5071.18701   120%     -  441s
     0     0 5068.54543    0  439 -24989.177 5068.54543   120%     -  446s
     0     0 4963.58314    0  449 -24989.177 4963.58314   120%     -  474s
     0     0 4946.05011    0  452 -24989.177 4946.05011   120%     -  486s
     0     0 4945.02201    0  453 -24989.177 4945.02201   120%     -  490s
     0     0 3934.04256    0  545 -24989.177 3934.04256   116%     -  560s
H    0     0                    -16240.70405 3932.43701   124%     -  561s
H    0     0                    -15862.84612 3932.43701   125%     -  561s
H    0     0                    -15801.84823 3932.43701   125%     -  561s
H    0     0                    -15780.13932 3932.43701   125%     -  561s
H    0     0                    -15762.67825 3932.43701   125%     -  561s
     0     0 3758.51636    0  470 -15762.678 3758.51636   124%     -  592s
     0     0 3556.58338    0  552 -15762.678 3556.58338   123%     -  620s
     0     0 3495.61501    0  555 -15762.678 3495.61501   122%     -  634s
     0     0 3449.74090    0  553 -15762.678 3449.74090   122%     -  651s
     0     0 3444.04683    0  550 -15762.678 3444.04683   122%     -  655s
     0     0 3441.58560    0  545 -15762.678 3441.58560   122%     -  659s
     0     0 3429.80639    0  550 -15762.678 3429.80639   122%     -  667s
     0     0 3425.67607    0  555 -15762.678 3425.67607   122%     -  672s
     0     0 3421.75157    0  548 -15762.678 3421.75157   122%     -  676s
     0     0 3418.81136    0  556 -15762.678 3418.81136   122%     -  680s
     0     0 3418.41253    0  554 -15762.678 3418.41253   122%     -  682s
     0     0 3106.08085    0  498 -15762.678 3106.08085   120%     -  725s
H    0     0                    -14492.37126 3105.90155   121%     -  726s
H    0     0                    -14331.06082 3105.90155   122%     -  726s
     0     0 2895.49771    0  558 -14331.061 2895.49771   120%     -  776s
     0     0 2759.45794    0  478 -14331.061 2759.45794   119%     -  804s
     0     0 2731.67726    0  494 -14331.061 2731.67726   119%     -  813s
     0     0 2725.19093    0  496 -14331.061 2725.19093   119%     -  821s
     0     0 2706.96649    0  495 -14331.061 2706.96649   119%     -  830s
     0     0 2703.30243    0  495 -14331.061 2703.30243   119%     -  836s
     0     0 2701.36069    0  503 -14331.061 2701.36069   119%     -  841s
     0     0 2685.97184    0  582 -14331.061 2685.97184   119%     -  853s
     0     0 2673.63523    0  511 -14331.061 2673.63523   119%     -  862s
     0     0 2669.67922    0  508 -14331.061 2669.67922   119%     -  870s
     0     0 2641.86119    0  621 -14331.061 2641.86119   118%     -  885s
     0     0 2639.98103    0  622 -14331.061 2639.98103   118%     -  889s
     0     0 2618.16779    0  545 -14331.061 2618.16779   118%     -  896s
     0     0 2611.55396    0  550 -14331.061 2611.55396   118%     -  900s
     0     0 2595.74762    0  616 -14331.061 2595.74762   118%     -  907s
     0     0 2584.67203    0  554 -14331.061 2584.67203   118%     -  916s
     0     0 2578.10957    0  562 -14331.061 2578.10957   118%     -  922s
     0     0 2577.13742    0  557 -14331.061 2577.13742   118%     -  928s
     0     0 2476.67287    0  597 -14331.061 2476.67287   117%     -  957s
H    0     0                    -14204.69653 2476.50129   117%     -  958s
H    0     0                    -14069.10625 2476.50129   118%     -  958s
H    0     0                    -13750.81288 2476.50129   118%     -  958s
H    0     0                    -13615.67986 2476.50129   118%     -  958s
H    0     0                    -13519.83737 2476.50129   118%     -  958s
H    0     0                    -13462.70075 2476.50129   118%     -  958s
     0     0 2429.82798    0  610 -13462.701 2429.82798   118%     -  976s
     0     0 2281.41578    0  538 -13462.701 2281.41578   117%     -  991s
     0     0 2272.01113    0  540 -13462.701 2272.01113   117%     -  999s
     0     0 2268.64074    0  544 -13462.701 2268.64074   117%     - 1004s
     0     0 2262.80235    0  552 -13462.701 2262.80235   117%     - 1011s
     0     0 2253.79224    0  608 -13462.701 2253.79224   117%     - 1017s
     0     0 2251.59090    0  607 -13462.701 2251.59090   117%     - 1019s
     0     0 2248.23561    0  604 -13462.701 2248.23561   117%     - 1024s
     0     0 2245.82147    0  615 -13462.701 2245.82147   117%     - 1030s
     0     0 2245.11075    0  616 -13462.701 2245.11075   117%     - 1032s
     0     0 2148.58362    0  620 -13462.701 2148.58362   116%     - 1054s
H    0     0                    -10543.89945 2147.85110   120%     - 1069s
H    0     0                    -10397.78395 2147.85110   121%     - 1070s
H    0     0                    -10382.79888 2147.85110   121%     - 1070s
H    0     0                    -10352.02490 2147.85110   121%     - 1070s
H    0     0                    -10206.83811 2147.85110   121%     - 1070s
H    0     0                    -10182.14025 2147.85110   121%     - 1074s
H    0     0                    -9860.388641 2147.85110   122%     - 1074s
     0     0 2096.77885    0  539 -9860.3886 2096.77885   121%     - 1086s
     0     0 2083.10368    0  606 -9860.3886 2083.10368   121%     - 1094s
     0     0 2073.79542    0  549 -9860.3886 2073.79542   121%     - 1099s
     0     0 2071.03224    0  536 -9860.3886 2071.03224   121%     - 1103s
     0     0 2068.26622    0  541 -9860.3886 2068.26622   121%     - 1104s
     0     0 2067.13757    0  549 -9860.3886 2067.13757   121%     - 1106s
     0     0 2013.97134    0  526 -9860.3886 2013.97134   120%     - 1121s
H    0     0                    -8129.024585 2010.06312   125%     - 1122s
H    0     0                    -8107.037132 2010.06312   125%     - 1123s
H    0     0                    -8079.289125 2010.06312   125%     - 1123s
     0     0 2000.07366    0  656 -8079.2891 2000.07366   125%     - 1135s
     0     0 1992.69572    0  666 -8079.2891 1992.69572   125%     - 1143s
     0     0 1990.10475    0  665 -8079.2891 1990.10475   125%     - 1146s
     0     0 1988.73192    0  546 -8079.2891 1988.73192   125%     - 1149s
     0     0 1860.02829    0  614 -8079.2891 1860.02829   123%     - 1170s
H    0     0                    -8051.801230 1859.65728   123%     - 1174s
H    0     0                    -8044.791844 1859.65728   123%     - 1192s
     0     0 1829.65018    0  628 -8044.7918 1829.65018   123%     - 1202s
     0     0 1810.95555    0  624 -8044.7918 1810.95555   123%     - 1213s
     0     0 1806.53895    0  637 -8044.7918 1806.53895   122%     - 1219s
     0     0 1805.64786    0  640 -8044.7918 1805.64786   122%     - 1221s
     0     0 1752.96354    0  684 -8044.7918 1752.96354   122%     - 1238s
     0     0 1746.75876    0  666 -8044.7918 1746.75876   122%     - 1245s
     0     0 1745.16870    0  697 -8044.7918 1745.16870   122%     - 1248s
     0     0 1724.59819    0  737 -8044.7918 1724.59819   121%     - 1261s
H    0     0                    -8019.267575 1723.59733   121%     - 1271s
     0     0 1717.26167    0  702 -8019.2676 1717.26167   121%     - 1277s
     0     0 1716.02897    0  703 -8019.2676 1716.02897   121%     - 1281s
     0     0 1695.40136    0  559 -8019.2676 1695.40136   121%     - 1297s
     0     0 1683.26672    0  558 -8019.2676 1683.26672   121%     - 1306s
     0     0 1678.72487    0  561 -8019.2676 1678.72487   121%     - 1311s
     0     0 1673.10090    0  556 -8019.2676 1673.10090   121%     - 1318s
     0     0 1673.03781    0  565 -8019.2676 1673.03781   121%     - 1320s
     0     0 1663.69135    0  646 -8019.2676 1663.69135   121%     - 1331s
     0     0 1660.98103    0  598 -8019.2676 1660.98103   121%     - 1378s
     0     0 1659.73803    0  674 -8019.2676 1659.73803   121%     - 1382s
     0     0 1654.34026    0  560 -8019.2676 1654.34026   121%     - 1392s
     0     0 1651.65403    0  635 -8019.2676 1651.65403   121%     - 1396s
     0     0 1636.45082    0  699 -8019.2676 1636.45082   120%     - 1403s
     0     0 1635.56209    0  637 -8019.2676 1635.56209   120%     - 1405s
     0     0 1627.63910    0  565 -8019.2676 1627.63910   120%     - 1412s
     0     0 1627.30070    0  560 -8019.2676 1627.30070   120%     - 1414s
     0     0 1618.84052    0  556 -8019.2676 1618.84052   120%     - 1422s
     0     0 1615.76939    0  638 -8019.2676 1615.76939   120%     - 1427s
     0     0 1615.20828    0  605 -8019.2676 1615.20828   120%     - 1431s
     0     0 1609.75120    0  604 -8019.2676 1609.75120   120%     - 1439s
     0     0 1608.46493    0  607 -8019.2676 1608.46493   120%     - 1442s
     0     0 1599.75263    0  605 -8019.2676 1599.75263   120%     - 1458s
     0     0 1599.71966    0  605 -8019.2676 1599.71966   120%     - 1472s
H    0     0                    -7163.870016 1599.70020   122%     - 1616s
H    0     0                    -7086.554413 1599.70020   123%     - 1618s
     0     2 1599.70020    0  605 -7086.5544 1599.70020   123%     - 1620s
     1     4 1593.50802    1  597 -7086.5544 1599.70020   123%  2194 1649s
     3     6 1440.78610    2  479 -7086.5544 1593.05716   122% 16064 1687s
     5    10 -943.01190    3  226 -7086.5544 1593.05716   122% 16245 1710s
     9    19 -1251.1584    4  223 -7086.5544 1535.38681   122% 12322 1737s
    18    37 -1565.5513    5  209 -7086.5544 1535.06900   122% 12959 1770s
    36    50 -5908.4962    5  471 -7086.5544 1311.55641   119% 14785 1848s
    49    78 -875.79819    6  269 -7086.5544 1311.55641   119% 16579 1894s
    77   142 -933.11837    7  288 -7086.5544 1304.91264   118% 15236 1946s
   143   166 -1158.4559   11  262 -7086.5544 1304.91264   118% 10215 1976s
H  173   194                    -7078.690528 1304.91264   118% 10057 2007s
   209   246 -1923.3330    9  473 -7078.6905 1304.91264   118%  9824 2041s
   269   275 -974.00665    9  281 -7078.6905 1304.91264   118%  8978 2073s
H  272   275                    -7064.208130 1304.91264   118%  8947 2073s
H  280   275                    -6981.524109 1304.91264   119%  8853 2073s
H  286   275                    -6772.149715 1304.91264   119%  8838 2073s
   298   343 -1194.3831   10  263 -6772.1497 1304.91264   119%  8720 2102s
   394   393 -1218.2299   11  262 -6772.1497 1304.91264   119%  8223 2129s
   459   463 -4824.2020   12  204 -6772.1497 1304.91264   119%  8105 2153s
   541   515 -1277.3283   12  261 -6772.1497 1304.91264   119%  7829 2176s
   616   533 -1735.9955   14  307 -6772.1497 1304.91264   119%  7752 2198s
   669   558 -1434.1459   13  257 -6772.1497 1304.91264   119%  7626 2219s
   730   581 -1758.7776   14  240 -6772.1497 1304.91264   119%  7584 2245s
   787   598 -2182.7547   15  323 -6772.1497 1304.91264   119%  7637 2285s
   818   615 -2321.5450   16  313 -6772.1497 1304.91264   119%  7720 2334s
   858   641 -2623.1921   17  310 -6772.1497 1304.91264   119%  7711 2368s
H  902   641                    -6710.206339 1304.91264   119%  7737 2368s
   908   650 -3853.7852   18  226 -6710.2063 1304.91264   119%  7731 2397s
   950   670 infeasible   19      -6710.2063 1304.91264   119%  7769 2423s
  1006   679 -4633.0443   20  316 -6710.2063 1304.91264   119%  7797 2449s
H 1013   679                    -6657.214079 1304.91264   120%  7768 2450s
  1057   693 -4891.9939   21  376 -6657.2141 1304.91264   120%  7750 2478s
  1151   733 -4900.9501   21  287 -6657.2141 1304.91264   120%  7628 2505s
  1236   764 -5204.7148   22  367 -6657.2141 1304.91264   120%  7573 2534s
  1346   778 -4790.8706   23  289 -6657.2141 1304.91264   120%  7390 2566s
  1432   814 -5545.9753   26  287 -6657.2141 1304.91264   120%  7377 2601s
  1511   855     cutoff   26      -6657.2141 1304.91264   120%  7380 2636s
  1598   910 infeasible   28      -6657.2141 1304.91264   120%  7400 2670s
  1700   978 -4383.5976   14  499 -6657.2141 1304.91264   120%  7406 2704s
  1803  1052 -4743.8523   16  392 -6657.2141 1304.91264   120%  7397 2738s
  1941  1087 -4697.2528   16  380 -6657.2141 1304.91264   120%  7306 2771s
H 1956  1087                    -6602.778757 1304.91264   120%  7268 2771s
H 1957  1087                    -6509.557913 1304.91264   120%  7267 2771s
  2022  1136     cutoff   17      -6509.5579 1304.91264   120%  7254 2813s
  2142  1198 -4755.1120   17  374 -6509.5579 1304.91264   120%  7307 2852s
  2258  1214     cutoff   18      -6509.5579 1304.91264   120%  7375 2891s
H 2260  1214                    -6452.971139 1304.91264   120%  7381 2891s
  2300  1266 -5872.1589   19  436 -6452.9711 1304.91264   120%  7443 2927s
  2402  1332 -4466.3361   15  484 -6452.9711 1304.91264   120%  7513 2974s
  2532  1413 -1277.7674   10  439 -6452.9711 1189.75228   118%  7572 3021s
  2660  1457 -1308.7102   11  431 -6452.9711 1189.75228   118%  7644 3065s
  2864  1492 -1440.5501   12  328 -6452.9711 1189.75228   118%  7506 3114s
  2989  1532 -1955.7779   17  303 -6452.9711 1177.58306   118%  7605 3198s
  3095  1600 -2484.8990   20  299 -6452.9711 1157.95119   118%  7699 3246s
  3216  1700 -5034.4609   24  359 -6452.9711 1157.95119   118%  7822 3294s
  3367  1754 -5318.8652   26  354 -6452.9711 1157.95119   118%  7856 3347s
H 3419  1754                    -6379.775049 1157.95119   118%  7872 3347s
  3480  1782 -5972.5647   30  200 -6379.7750 1157.95119   118%  7902 3403s
  3630  1860 -4848.1536    9  398 -6379.7750 1157.95119   118%  7984 3461s
  3790  1991 -5056.0784   10  449 -6379.7750 1157.95119   118%  8045 3524s
  3976  2136 infeasible   11      -6379.7750 -146.38419  97.7%  8092 3586s

Cutting planes:
  Learned: 1
  Gomory: 1
  Implied bound: 271
  MIR: 4343
  Flow cover: 4045
  Zero half: 12
  RLT: 72
  Relax-and-lift: 496

Explored 4208 nodes (34728386 simplex iterations) in 3600.13 seconds (7409.17 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -6379.78 -6452.97 -6509.56 ... -7078.69

Time limit reached
Best objective -6.379775049132e+03, best bound -1.463841946797e+02, gap 97.7055%
  WARNING: Time limit reached. Using best solution found (gap: 97.71%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3600.17s
  Master Objective (UB) = -6379.78, θ = 110246.93
  Upper Bound (UB) = -6379.78

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 110246.93
  [DEBUG]   ✓ Scenario 0: θ = 110246.93 ≤ Q = 110246.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 110246.93 ≤ Q = 110246.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 110246.93 ≤ Q = 110246.93 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 110246.93 ≤ Q = 110246.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 110246.93 ≤ Q = 110246.93 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 110246.93 ≤ Q = 110246.93 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 110246.93 ≤ Q = 110246.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 110246.93 ≤ Q = 110246.93 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 110246.93 ≤ Q = 110246.93 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 110246.93 ≤ Q = 110246.93 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 110246.93 ≤ Q = 110246.93 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 110246.93 ≤ Q = 110246.93 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 110246.93 ≤ Q = 110246.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 110246.93 ≤ Q = 110246.93 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 110246.93 ≤ Q = 110246.93 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 110246.93 ≤ Q = 110246.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 110246.93 ≤ Q = 110246.93 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 110246.93 ≤ Q = 110246.93 (slack: 0.00)
  [DEBUG]   ✓ Scenario 18: θ = 110246.93 ≤ Q = 110246.93 (slack: 0.00)
  [DEBUG]   ✓ Scenario 19: θ = 110246.93 ≤ Q = 110246.93 (slack: 0.00)
  [DEBUG]   ✓ Scenario 20: θ = 110246.93 ≤ Q = 110246.93 (slack: 0.00)
  [DEBUG]   ✓ Scenario 21: θ = 110246.93 ≤ Q = 110246.93 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 22] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x358961b4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x358961b4
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [5e-15, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e-16, 2e+02]
Found heuristic solution: objective 1.191763e+13
Presolve removed 2602 rows and 1895 columns
Presolve time: 0.00s
Presolved: 491 rows, 494 columns, 1384 nonzeros
Found heuristic solution: objective 6137231.3785
Variable types: 334 continuous, 160 integer (160 binary)

Root relaxation: objective -1.184574e+05, 232 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -118457.35    0  122 6137231.38 -118457.35   102%     -    0s
H    0     0                    -85805.52061 -118457.35  38.1%     -    0s
H    0     0                    -86420.43585 -118457.35  37.1%     -    0s
     0     0 -92230.815    0  131 -86420.436 -92230.815  6.72%     -    0s
H    0     0                    -88251.85596 -92137.134  4.40%     -    0s
     0     0 -91486.125    0  133 -88251.856 -91486.125  3.66%     -    0s
H    0     0                    -88453.48202 -91483.802  3.43%     -    0s
H    0     0                    -88723.61289 -91208.168  2.80%     -    0s
     0     0 -91208.168    0  134 -88723.613 -91208.168  2.80%     -    0s
     0     0 -91179.699    0  136 -88723.613 -91179.699  2.77%     -    0s
     0     0 -91144.182    0  136 -88723.613 -91144.182  2.73%     -    0s
     0     0 -91143.008    0  136 -88723.613 -91143.008  2.73%     -    0s
     0     0 -90827.289    0  137 -88723.613 -90827.289  2.37%     -    0s
     0     0 -90761.684    0  139 -88723.613 -90761.684  2.30%     -    0s
     0     0 -90760.196    0  139 -88723.613 -90760.196  2.30%     -    0s
     0     0 -90659.788    0  139 -88723.613 -90659.788  2.18%     -    0s
     0     2 -90651.483    0  139 -88723.613 -90651.483  2.17%     -    0s
H   38    64                    -88807.31626 -90498.693  1.90%  15.5    0s
H   55    64                    -89169.63257 -90403.871  1.38%  14.4    0s
H  430   458                    -89184.34108 -90325.440  1.28%   8.5    0s
* 1302   771              30    -89262.34909 -90207.583  1.06%   6.9    0s
* 2072  1038              25    -89299.75024 -89975.025  0.76%   6.7    0s
* 2456  1097              26    -89315.19663 -89956.801  0.72%   6.8    0s
* 2485  1097              26    -89317.53046 -89956.801  0.72%   6.7    0s
* 2565  1097              25    -89349.55030 -89956.801  0.68%   6.7    0s
* 3541  1244              24    -89351.88412 -89869.822  0.58%   6.5    0s
H 4369  1310                    -89377.72643 -89755.295  0.42%   6.4    0s
H 4707  1310                    -89389.16116 -89735.165  0.39%   6.4    0s
H 4894  1318                    -89415.00346 -89700.945  0.32%   6.4    0s

Cutting planes:
  Gomory: 67
  Implied bound: 1
  MIR: 244
  RLT: 4

Explored 9194 nodes (56943 simplex iterations) in 0.39 seconds (0.28 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -89415 -89389.2 -89377.7 ... -89184.3
No other solutions better than -89415

Optimal solution found (tolerance 1.00e-04)
Best objective -8.941500346336e+04, best bound -8.941500346336e+04, gap 0.0000%
  Subproblem solved in 0.40s
  Worst-case operational profit (Z_SP) = 109516.34
  Scenario: 16 demand increases, 44 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -89415.00
  [DEBUG]   S×d_nominal = 198931.34
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 198931.34 + -89415.00 = 109516.34
  [DEBUG]   Current θ from Master = 110246.93
  [DEBUG]   ⚠️  Z_SP ≤ θ by 730.59 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -7110.37
  Lower Bound (LB) = -7110.37
  Gap (UB-LB) = 730.5908, Absolute Gap = 730.5908, Relative Gap = 0.114517
  Not converged yet (gap = 730.59 > ε = 200)

  [DEBUG] Adding NEW scenario 22 to Master Problem...
  [DEBUG] New scenario pattern: 16 increases, 44 decreases
    [DEBUG] Scenario 22 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 22 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 22]
    [DEBUG]   - Total constraints in model: 353053
    [DEBUG]   - Total variables in model: 145780
  [DEBUG] Total scenarios in Master: 23
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 23
================================================================================
[Iteration 23] Solving Master Problem...
  Current scenarios in Master: 23
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 353053 rows, 145780 columns and 999832 nonzeros
Model fingerprint: 0x8842967a
Variable types: 143521 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [9e-02, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 163110 rows and 66260 columns
Presolve time: 3.70s
Presolved: 189943 rows, 79520 columns, 1171356 nonzeros
Variable types: 77261 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -371500.8959
Found heuristic solution: objective -172304.4497

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.67s

Barrier statistics:
 Dense cols : 1159
 AA' NZ     : 4.967e+06
 Factor NZ  : 1.389e+07 (roughly 200 MB of memory)
 Factor Ops : 5.013e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.67602688e+07  2.79682760e+08  8.71e+04 2.13e+01  6.44e+04     7s
   1  -1.26287965e+07  2.42205960e+08  6.06e+04 4.01e+01  4.45e+04     8s
   2  -4.96972208e+06  1.95304947e+08  2.26e+04 2.46e+01  1.71e+04     8s
   3  -1.10342520e+06  1.48843807e+08  2.18e+03 2.50e+00  2.01e+03     8s
   4  -6.75168019e+05  7.37791850e+07  4.70e+02 6.83e-01  5.21e+02     8s
   5  -5.90277598e+05  4.75025471e+07  3.48e+02 2.18e-01  3.48e+02     8s
   6  -4.60188119e+05  4.09167855e+07  1.10e+02 6.92e-02  1.84e+02     8s
   7  -4.06349136e+05  2.87054501e+07  5.71e+01 3.53e-02  1.13e+02     8s
   8  -3.15265531e+05  1.97927846e+07  2.06e+01 2.28e-02  6.68e+01     8s
   9  -1.67200871e+05  1.31891063e+07  3.84e+00 1.45e-02  3.99e+01     8s
  10  -1.45461451e+05  6.69538950e+06  2.96e+00 7.20e-03  2.03e+01     8s
  11  -1.23368908e+05  4.93891807e+06  1.93e+00 5.24e-03  1.49e+01     8s
  12  -1.07406019e+05  3.82096614e+06  1.29e+00 4.02e-03  1.15e+01     8s
  13  -9.85985280e+04  2.97785012e+06  9.41e-01 3.11e-03  8.98e+00     8s
  14  -7.69866605e+04  1.76678881e+06  3.53e-01 1.82e-03  5.35e+00     8s
  15  -6.23395038e+04  5.02863887e+05  2.07e-01 5.14e-04  1.64e+00     8s
  16  -3.74034141e+04  2.99139993e+05  1.10e-01 3.05e-04  9.75e-01     8s
  17  -2.33661646e+04  1.59829140e+05  6.89e-02 3.63e-04  5.31e-01     8s
  18  -1.83961705e+04  1.14259292e+05  5.86e-02 4.73e-04  3.84e-01     9s
  19  -1.21464039e+04  7.75325802e+04  4.59e-02 2.34e-03  2.60e-01     9s
  20  -8.49473823e+03  5.70845609e+04  3.88e-02 2.16e-03  1.90e-01     9s
  21  -5.48812962e+03  4.76440208e+04  3.32e-02 2.21e-03  1.54e-01     9s
  22  -3.07492095e+03  4.09167339e+04  2.87e-02 2.22e-03  1.27e-01     9s
  23  -1.86158751e+02  3.63911067e+04  2.34e-02 1.78e-03  1.06e-01     9s
  24   1.17897153e+03  3.24937907e+04  2.08e-02 1.48e-03  9.07e-02     9s
  25   3.89897827e+03  2.86446000e+04  1.61e-02 1.19e-03  7.17e-02     9s
  26   5.69060244e+03  2.57048296e+04  1.31e-02 9.47e-04  5.80e-02     9s
  27   6.55062511e+03  2.39240627e+04  1.18e-02 8.22e-04  5.03e-02     9s
  28   8.40497341e+03  2.12053826e+04  8.92e-03 5.63e-04  3.71e-02     9s
  29   8.73947650e+03  1.94678045e+04  8.44e-03 4.03e-04  3.11e-02     9s
  30   1.02596165e+04  1.80696041e+04  6.35e-03 2.93e-04  2.26e-02     9s
  31   1.05601211e+04  1.72860707e+04  5.92e-03 2.19e-04  1.95e-02    10s
  32   1.18989046e+04  1.67502593e+04  4.09e-03 1.67e-04  1.41e-02    10s
  33   1.21851024e+04  1.63629512e+04  3.69e-03 1.34e-04  1.21e-02    10s
  34   1.26925265e+04  1.58563199e+04  2.99e-03 8.50e-05  9.17e-03    10s
  35   1.31725432e+04  1.56948263e+04  2.31e-03 7.03e-05  7.31e-03    10s
  36   1.35098645e+04  1.55917889e+04  1.86e-03 5.99e-05  6.03e-03    10s
  37   1.36568457e+04  1.52577265e+04  1.65e-03 3.15e-05  4.64e-03    10s
  38   1.39167879e+04  1.51909266e+04  1.31e-03 2.59e-05  3.69e-03    10s
  39   1.40469281e+04  1.51614878e+04  1.14e-03 2.31e-05  3.23e-03    10s
  40   1.41694272e+04  1.50732364e+04  9.66e-04 1.54e-05  2.62e-03    10s
  41   1.44116654e+04  1.50010427e+04  6.38e-04 8.63e-06  1.71e-03    10s
  42   1.45080198e+04  1.49874862e+04  5.12e-04 7.23e-06  1.39e-03    11s
  43   1.46382063e+04  1.49607728e+04  3.37e-04 1.69e-05  9.35e-04    11s
  44   1.46691384e+04  1.49452186e+04  2.96e-04 1.42e-05  8.01e-04    11s
  45   1.46958683e+04  1.49419985e+04  2.61e-04 1.34e-05  7.14e-04    11s
  46   1.48120270e+04  1.49295074e+04  1.05e-04 9.98e-06  3.41e-04    11s
  47   1.48504357e+04  1.49161129e+04  5.75e-05 5.40e-06  1.90e-04    11s
  48   1.48715406e+04  1.49067179e+04  3.20e-05 6.12e-06  1.02e-04    11s
  49   1.48881389e+04  1.49037887e+04  1.35e-05 2.32e-06  4.54e-05    11s
  50   1.48927379e+04  1.49020779e+04  8.76e-06 2.37e-07  2.71e-05    11s
  51   1.48998267e+04  1.49019767e+04  1.78e-06 1.99e-07  6.23e-06    11s
  52   1.48998791e+04  1.49019680e+04  1.73e-06 2.08e-07  6.06e-06    11s
  53   1.49006197e+04  1.49017419e+04  9.98e-07 2.03e-07  3.25e-06    12s
  54   1.49006675e+04  1.49017365e+04  9.43e-07 5.21e-06  3.10e-06    12s
  55   1.49008136e+04  1.49017084e+04  8.00e-07 4.11e-06  2.60e-06    12s
  56   1.49014826e+04  1.49016749e+04  1.52e-07 1.73e-06  5.58e-07    12s
  57   1.49014940e+04  1.49016379e+04  1.53e-07 1.18e-05  4.18e-07    12s
  58   1.49015173e+04  1.49016379e+04  2.16e-06 9.21e-06  3.51e-07    12s
  59   1.49015260e+04  1.49016378e+04  5.53e-06 8.32e-06  3.25e-07    12s
  60   1.49015335e+04  1.49016378e+04  7.81e-06 7.95e-06  3.03e-07    12s
  61   1.49015335e+04  1.49016378e+04  7.81e-06 7.96e-06  3.03e-07    12s
  62   1.49015377e+04  1.49016428e+04  7.32e-06 6.49e-06  3.05e-07    12s
  63   1.49016367e+04  1.49016371e+04  3.53e-08 1.39e-06  1.41e-09    13s
  64   1.49016366e+04  1.49016371e+04  5.51e-06 7.37e-08  8.11e-10    13s
  65   1.49016371e+04  1.49016371e+04  1.73e-07 2.01e-07  2.50e-11    13s

Barrier solved model in 65 iterations and 12.67 seconds (23.00 work units)
Optimal objective 1.49016371e+04


Root crossover log...

  155002 DPushes remaining with DInf 0.0000000e+00                13s
   35986 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                18s

    5110 PPushes remaining with PInf 1.5379418e-05                18s
       0 PPushes remaining with PInf 0.0000000e+00                19s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.0023796e+00     19s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   69342    1.4901637e+04   0.000000e+00   1.002380e+00     19s
   69343    1.4901637e+04   0.000000e+00   0.000000e+00     19s
   69343    1.4901637e+04   0.000000e+00   0.000000e+00     19s
Concurrent spin time: 12.74s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 1.490164e+04, 69343 iterations, 26.57 seconds (37.37 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 14901.6371    0  369 -172304.45 14901.6371   109%     -   32s
H    0     0                    -118151.8472 14901.6371   113%     -   32s
H    0     0                    -117633.8736 14901.6371   113%     -   32s
H    0     0                    -88142.94548 14901.6371   117%     -   32s
H    0     0                    -88078.95226 14901.6371   117%     -   36s
H    0     0                    -44515.41536 14901.6371   133%     -   36s
H    0     0                    -44498.42945 14901.6371   133%     -   36s
     0     0 7776.64038    0  391 -44498.429 7776.64038   117%     -   89s
H    0     0                    -40472.41450 7776.62330   119%     -   90s
H    0     0                    -32473.63705 7776.62330   124%     -   90s
     0     0 7700.25209    0  394 -32473.637 7700.25209   124%     -  100s
     0     0 7674.15379    0  404 -32473.637 7674.15379   124%     -  105s
     0     0 7671.46144    0  404 -32473.637 7671.46144   124%     -  110s
     0     0 7671.35268    0  404 -32473.637 7671.35268   124%     -  112s
     0     0 5859.52579    0  394 -32473.637 5859.52579   118%     -  173s
H    0     0                    -25624.21698 5856.76003   123%     -  174s
H    0     0                    -25521.05981 5856.76003   123%     -  174s
H    0     0                    -25504.83079 5856.76003   123%     -  174s
     0     0 5599.01807    0  407 -25504.831 5599.01807   122%     -  199s
     0     0 5396.51378    0  398 -25504.831 5396.51378   121%     -  221s
     0     0 5373.39950    0  456 -25504.831 5373.39950   121%     -  236s
     0     0 5209.07246    0  396 -25504.831 5209.07246   120%     -  265s
     0     0 5179.63376    0  396 -25504.831 5179.63376   120%     -  274s
     0     0 5171.17021    0  449 -25504.831 5171.17021   120%     -  282s
     0     0 5091.89341    0  396 -25504.831 5091.89341   120%     -  302s
     0     0 5088.10845    0  400 -25504.831 5088.10845   120%     -  308s
     0     0 5075.54918    0  441 -25504.831 5075.54918   120%     -  315s
     0     0 5063.89925    0  446 -25504.831 5063.89925   120%     -  320s
     0     0 5058.31147    0  438 -25504.831 5058.31147   120%     -  323s
     0     0 5057.91864    0  447 -25504.831 5057.91864   120%     -  324s
     0     0 4282.06569    0  449 -25504.831 4282.06569   117%     -  374s
H    0     0                    -24567.75623 4281.73123   117%     -  375s
     0     0 3931.23259    0  452 -24567.756 3931.23259   116%     -  397s
     0     0 3821.13038    0  550 -24567.756 3821.13038   116%     -  419s
     0     0 3789.39210    0  540 -24567.756 3789.39210   115%     -  430s
     0     0 3634.61012    0  538 -24567.756 3634.61012   115%     -  449s
     0     0 3610.12649    0  543 -24567.756 3610.12649   115%     -  456s
     0     0 3606.98771    0  495 -24567.756 3606.98771   115%     -  459s
     0     0 3599.88516    0  553 -24567.756 3599.88516   115%     -  464s
     0     0 3587.12216    0  544 -24567.756 3587.12216   115%     -  471s
     0     0 3586.42506    0  552 -24567.756 3586.42506   115%     -  472s
     0     0 3216.87257    0  423 -24567.756 3216.87257   113%     -  495s
H    0     0                    -24348.72075 3216.10699   113%     -  495s
     0     0 3089.13495    0  491 -24348.721 3089.13495   113%     -  512s
     0     0 3039.66390    0  502 -24348.721 3039.66390   112%     -  522s
     0     0 2992.82312    0  502 -24348.721 2992.82312   112%     -  531s
     0     0 2909.75203    0  502 -24348.721 2909.75203   112%     -  541s
     0     0 2907.95118    0  499 -24348.721 2907.95118   112%     -  546s
     0     0 2906.47208    0  504 -24348.721 2906.47208   112%     -  550s
     0     0 2783.78497    0  522 -24348.721 2783.78497   111%     -  570s
H    0     0                    -24256.75314 2782.80957   111%     -  571s
     0     0 2744.16888    0  527 -24256.753 2744.16888   111%     -  586s
     0     0 2724.41468    0  542 -24256.753 2724.41468   111%     -  596s
     0     0 2704.19159    0  536 -24256.753 2704.19159   111%     -  602s
     0     0 2696.27039    0  544 -24256.753 2696.27039   111%     -  607s
     0     0 2680.43009    0  533 -24256.753 2680.43009   111%     -  615s
     0     0 2650.71833    0  588 -24256.753 2650.71833   111%     -  623s
     0     0 2645.57081    0  525 -24256.753 2645.57081   111%     -  628s
     0     0 2643.60102    0  534 -24256.753 2643.60102   111%     -  632s
     0     0 2637.09621    0  591 -24256.753 2637.09621   111%     -  636s
     0     0 2636.18677    0  593 -24256.753 2636.18677   111%     -  639s
     0     0 2412.35589    0  525 -24256.753 2412.35589   110%     -  662s
H    0     0                    -14283.75664 2412.04663   117%     -  669s
H    0     0                    -11609.11453 2412.04663   121%     -  669s
H    0     0                    -10602.87017 2412.04663   123%     -  669s
H    0     0                    -9533.433429 2412.04663   125%     -  669s
H    0     0                    -9400.499306 2412.04663   126%     -  671s
     0     0 2314.34019    0  535 -9400.4993 2314.34019   125%     -  686s
     0     0 2290.65383    0  548 -9400.4993 2290.65383   124%     -  699s
     0     0 2249.10951    0  535 -9400.4993 2249.10951   124%     -  714s
     0     0 2203.37271    0  536 -9400.4993 2203.37271   123%     -  729s
     0     0 2202.13397    0  526 -9400.4993 2202.13397   123%     -  732s
     0     0 2102.08692    0  599 -9400.4993 2102.08692   122%     -  754s
H    0     0                    -9060.051547 2101.81483   123%     -  755s
H    0     0                    -9018.372118 2101.81483   123%     -  755s
H    0     0                    -8834.053696 2101.81483   124%     -  755s
H    0     0                    -8721.902805 2101.81483   124%     -  755s
H    0     0                    -8686.780241 2101.81483   124%     -  755s
H    0     0                    -8602.890403 2101.81483   124%     -  755s
H    0     0                    -8567.767839 2101.81483   125%     -  755s
     0     0 2079.65470    0  549 -8567.7678 2079.65470   124%     -  764s
     0     0 2070.13813    0  542 -8567.7678 2070.13813   124%     -  769s
     0     0 2061.86585    0  538 -8567.7678 2061.86585   124%     -  774s
     0     0 2058.83224    0  553 -8567.7678 2058.83224   124%     -  778s
     0     0 2057.13352    0  557 -8567.7678 2057.13352   124%     -  780s
     0     0 1973.25863    0  516 -8567.7678 1973.25863   123%     -  805s
H    0     0                    -8530.956095 1973.13147   123%     -  806s
H    0     0                    -8495.833531 1973.13147   123%     -  807s
     0     0 1865.53973    0  517 -8495.8335 1865.53973   122%     -  826s
     0     0 1860.55144    0  524 -8495.8335 1860.55144   122%     -  831s
     0     0 1856.09154    0  525 -8495.8335 1856.09154   122%     -  835s
     0     0 1853.23210    0  530 -8495.8335 1853.23210   122%     -  837s
     0     0 1851.98131    0  531 -8495.8335 1851.98131   122%     -  841s
     0     0 1792.26964    0  578 -8495.8335 1792.26964   121%     -  856s
H    0     0                    -8265.076580 1792.20023   122%     -  857s
H    0     0                    -8223.788163 1792.20023   122%     -  857s
H    0     0                    -8113.827254 1792.20023   122%     -  857s
     0     0 1773.73454    0  533 -8113.8273 1773.73454   122%     -  865s
     0     0 1766.82493    0  530 -8113.8273 1766.82493   122%     -  871s
     0     0 1763.10747    0  619 -8113.8273 1763.10747   122%     -  874s
     0     0 1760.35239    0  538 -8113.8273 1760.35239   122%     -  877s
     0     0 1759.28285    0  536 -8113.8273 1759.28285   122%     -  879s
     0     0 1739.47525    0  595 -8113.8273 1739.47525   121%     -  889s
H    0     0                    -8098.570418 1738.92206   121%     -  891s
     0     0 1727.14746    0  596 -8098.5704 1727.14746   121%     -  899s
     0     0 1723.10719    0  598 -8098.5704 1723.10719   121%     -  905s
     0     0 1721.50828    0  592 -8098.5704 1721.50828   121%     -  908s
     0     0 1701.12774    0  606 -8098.5704 1701.12774   121%     -  921s
     0     0 1693.40793    0  561 -8098.5704 1693.40793   121%     -  927s
     0     0 1691.21579    0  633 -8098.5704 1691.21579   121%     -  931s
     0     0 1691.03652    0  632 -8098.5704 1691.03652   121%     -  932s
     0     0 1683.99504    0  562 -8098.5704 1683.99504   121%     -  940s
H    0     0                    -7956.858936 1683.61959   121%     -  969s
H    0     0                    -7933.977748 1683.61959   121%     -  972s
     0     0 1682.79285    0  571 -7933.9777 1682.79285   121%     -  974s
     0     0 1676.17264    0  556 -7933.9777 1676.17264   121%     -  980s
     0     0 1674.23359    0  566 -7933.9777 1674.23359   121%     -  983s
     0     0 1673.11780    0  645 -7933.9777 1673.11780   121%     -  986s
     0     0 1650.20087    0  636 -7933.9777 1650.20087   121%     -  995s
H    0     0                    -7918.462567 1649.59743   121%     -  999s
     0     0 1640.52569    0  637 -7918.4626 1640.52569   121%     - 1006s
     0     0 1637.26574    0  569 -7918.4626 1637.26574   121%     - 1009s
     0     0 1637.00699    0  571 -7918.4626 1637.00699   121%     - 1010s
     0     0 1622.75547    0  643 -7918.4626 1622.75547   120%     - 1019s
     0     0 1620.13402    0  650 -7918.4626 1620.13402   120%     - 1022s
     0     0 1619.74044    0  653 -7918.4626 1619.74044   120%     - 1024s
     0     0 1611.22966    0  649 -7918.4626 1611.22966   120%     - 1033s
     0     0 1605.92671    0  647 -7918.4626 1605.92671   120%     - 1039s
     0     0 1604.14912    0  648 -7918.4626 1604.14912   120%     - 1042s
     0     0 1598.84834    0  646 -7918.4626 1598.84834   120%     - 1050s
     0     0 1597.18367    0  647 -7918.4626 1597.18367   120%     - 1055s
     0     0 1594.89525    0  571 -7918.4626 1594.89525   120%     - 1062s
     0     0 1592.53225    0  641 -7918.4626 1592.53225   120%     - 1088s
     0     0 1592.47530    0  643 -7918.4626 1592.47530   120%     - 1089s
     0     0 1592.40692    0  641 -7918.4626 1592.40692   120%     - 1093s
     0     0 1589.88878    0  641 -7918.4626 1589.88878   120%     - 1106s
     0     2 1589.85684    0  641 -7918.4626 1589.85684   120%     - 1362s
     1     3 1320.27599    1  446 -7918.4626 1589.85684   120% 28073 1397s
     2     4 1569.78464    1  638 -7918.4626 1569.78464   120% 15036 1410s
     3     7  827.06522    2  453 -7918.4626 1566.91211   120% 10843 1426s
     6    14 -682.96687    3  491 -7918.4626 1566.36905   120% 15546 1449s
    13    28 -917.24723    4  486 -7918.4626 1248.06496   116% 13926 1468s
    27    38  120.31739    5  439 -7918.4626 1241.24087   116% 18115 1528s
    41    58 -616.93275    6  430 -7918.4626 1241.24087   116% 20413 1773s
    65   126   48.15383    5  453 -7918.4626 1241.24087   116% 22123 1836s
   133   161 -103.84844    8  494 -7918.4626 1241.24087   116% 16354 1872s
   170   198 -152.15920    9  571 -7918.4626 1241.24087   116% 15392 1915s
H  175   198                    -6938.970743 1241.24087   118% 15116 1916s
   215   248 -374.28737   10  438 -6938.9707 1241.24087   118% 13681 1964s
   281   297 -6282.1507   18  157 -6938.9707 1241.24087   118% 12572 2058s
   340   339     cutoff   20      -6938.9707 1241.24087   118% 12585 2104s
   396   390 -320.86555    9  409 -6938.9707 1241.24087   118% 12013 2142s
   473   440 -1316.2095   10  294 -6938.9707 1241.24087   118% 11744 2183s
   554   498 -2224.3131   12  200 -6938.9707 1241.24087   118% 11424 2217s
H  633   534                    -6733.963141 1241.24087   118% 11098 2252s
H  662   534                    -6711.406387 1241.24087   118% 10941 2252s
   706   554     cutoff   17      -6711.4064 1241.24087   118% 10701 2285s
   792   581 -3244.5891   19  336 -6711.4064 1241.24087   118% 10165 2310s
H  838   581                    -6708.974928 1241.24087   119% 10061 2310s
   847   612 -4169.4592   20  371 -6708.9749 1241.24087   119% 10069 2341s
   925   627 -4607.3412   21  337 -6708.9749 1241.24087   119%  9830 2369s
H  955   627                    -6670.817093 1241.24087   119%  9698 2369s
H  986   627                    -6564.406762 1241.24087   119%  9534 2369s
H  994   639                    -6505.398431 1241.24087   119%  9559 2399s
  1039   695 -3761.5053   22  325 -6505.3984 1241.24087   119%  9544 2429s
  1132   727 -4437.6903   24  305 -6505.3984 1241.24087   119%  9358 2460s
  1240   765 -4734.0277   28  375 -6505.3984 1241.24087   119%  9101 2492s
H 1249   765                    -6500.310671 1241.24087   119%  9075 2492s
  1319   814 -4953.3036   30  376 -6500.3107 1241.24087   119%  8988 2522s
  1424   852 -5324.3851   34  241 -6500.3107 1241.24087   119%  8785 2560s
H 1547   868                    -6461.813313 1241.24087   119%  8539 2598s
H 1555   868                    -6378.404535 1241.24087   119%  8544 2598s
  1585   895 -5778.8433   40  240 -6378.4045 1241.24087   119%  8585 2635s
  1690   913 infeasible   25      -6378.4045 1241.24087   119%  8467 2674s
  1798   918     cutoff   14      -6378.4045 1241.24087   119%  8474 2716s
H 1805   918                    -6341.100929 1241.24087   120%  8470 2716s
  1895   958 -2057.7030   10  244 -6341.1009 1241.24087   120%  8469 2759s
H 1980   967                    -6333.714255 1241.24087   120%  8572 2803s
H 1991   967                    -6274.348757 1241.24087   120%  8595 2803s
  2065   982 infeasible   13      -6274.3488 1241.24087   120%  8578 2847s
  2130   990 infeasible   13      -6274.3488 1241.24087   120%  8660 2974s
  2173  1006 -5848.2519   12  130 -6274.3488 1241.24087   120%  8730 3144s
  2213  1032 -5895.1506   13  129 -6274.3488 1241.24087   120%  8898 3257s
H 2253  1032                    -6230.105273 1241.24087   120%  8892 3257s
  2261  1106 -6008.3656   14  138 -6230.1053 1241.24087   120%  8925 3312s
  2397  1151     cutoff   14      -6230.1053 1241.24087   120%  8884 3367s
  2540  1219 infeasible   15      -6230.1053 1048.68489   117%  8848 3424s
  2678  1330 -1972.4709    6  536 -6230.1053 1048.68489   117%  8831 3489s
  2827  1435 -3325.0221    7  537 -6230.1053 1048.68489   117%  8818 3553s
  2981  1505     cutoff    8      -6230.1053 1048.68489   117%  8792 3600s

Cutting planes:
  Learned: 3
  Implied bound: 343
  MIR: 4524
  Flow cover: 4256
  Zero half: 9
  RLT: 76
  Relax-and-lift: 484

Explored 3115 nodes (28442151 simplex iterations) in 3600.08 seconds (7777.94 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -6230.11 -6274.35 -6333.71 ... -6670.82

Time limit reached
Best objective -6.230105272810e+03, best bound 1.048684890454e+03, gap 116.8325%
  WARNING: Time limit reached. Using best solution found (gap: 116.83%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3600.11s
  Master Objective (UB) = -6230.11, θ = 109649.07
  Upper Bound (UB) = -6230.11

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 109649.07
  [DEBUG]   ✓ Scenario 0: θ = 109649.07 ≤ Q = 109649.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 109649.07 ≤ Q = 109649.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 109649.07 ≤ Q = 109649.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 109649.07 ≤ Q = 109649.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 109649.07 ≤ Q = 109649.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 109649.07 ≤ Q = 109649.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 109649.07 ≤ Q = 109649.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 109649.07 ≤ Q = 109649.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 109649.07 ≤ Q = 109649.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 109649.07 ≤ Q = 109649.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 109649.07 ≤ Q = 109649.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 109649.07 ≤ Q = 109649.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 109649.07 ≤ Q = 109649.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 109649.07 ≤ Q = 109649.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 109649.07 ≤ Q = 109649.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 109649.07 ≤ Q = 109649.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 109649.07 ≤ Q = 109649.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 109649.07 ≤ Q = 109649.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 109649.07 ≤ Q = 109649.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 109649.07 ≤ Q = 109649.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 20: θ = 109649.07 ≤ Q = 109649.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 21: θ = 109649.07 ≤ Q = 109649.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 22: θ = 109649.07 ≤ Q = 109649.07 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 23] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x1c04e3ac
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xe3fb1c54
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [7e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.182041e+13
Presolve removed 2608 rows and 1900 columns
Presolve time: 0.00s
Presolved: 485 rows, 489 columns, 1368 nonzeros
Found heuristic solution: objective 6007014.2453
Variable types: 330 continuous, 159 integer (159 binary)

Root relaxation: objective -1.193236e+05, 229 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -119323.58    0  120 6007014.25 -119323.58   102%     -    0s
H    0     0                    -78002.87872 -119323.58  53.0%     -    0s
     0     0 -94424.288    0   73 -78002.879 -94424.288  21.1%     -    0s
H    0     0                    -91088.77994 -94397.782  3.63%     -    0s
H    0     0                    -91399.51288 -94397.782  3.28%     -    0s
H    0     0                    -92117.36352 -94397.782  2.48%     -    0s
H    0     0                    -92428.09647 -94397.782  2.13%     -    0s
     0     0 -93700.124    0   71 -92428.096 -93700.124  1.38%     -    0s
     0     0 -93680.782    0   71 -92428.096 -93680.782  1.36%     -    0s
H    0     0                    -92624.42444 -93680.782  1.14%     -    0s
     0     0 -93388.379    0   57 -92624.424 -93388.379  0.82%     -    0s
     0     0 -93360.796    0   69 -92624.424 -93360.796  0.80%     -    0s
     0     0 -93353.126    0   69 -92624.424 -93353.126  0.79%     -    0s
     0     0 -93151.744    0   42 -92624.424 -93151.744  0.57%     -    0s
     0     0 -93069.559    0   44 -92624.424 -93069.559  0.48%     -    0s
     0     0 -93068.483    0   44 -92624.424 -93068.483  0.48%     -    0s
     0     0 -92956.631    0   37 -92624.424 -92956.631  0.36%     -    0s
     0     0 -92940.537    0   38 -92624.424 -92940.537  0.34%     -    0s
     0     0 -92922.308    0   38 -92624.424 -92922.308  0.32%     -    0s
     0     0 -92904.292    0   38 -92624.424 -92904.292  0.30%     -    0s
     0     0 -92901.165    0   67 -92624.424 -92901.165  0.30%     -    0s
H    0     0                    -92663.75871 -92901.165  0.26%     -    0s
     0     0 -92901.165    0   44 -92663.759 -92901.165  0.26%     -    0s
     0     0 -92901.165    0   36 -92663.759 -92901.165  0.26%     -    0s
     0     0 -92865.422    0   37 -92663.759 -92865.422  0.22%     -    0s
     0     0 -92851.839    0   37 -92663.759 -92851.839  0.20%     -    0s
     0     0 -92837.086    0   39 -92663.759 -92837.086  0.19%     -    0s
     0     0 -92815.590    0   38 -92663.759 -92815.590  0.16%     -    0s
     0     0 -92815.590    0   38 -92663.759 -92815.590  0.16%     -    0s
     0     0 -92815.590    0   38 -92663.759 -92815.590  0.16%     -    0s
     0     0 -92812.600    0   40 -92663.759 -92812.600  0.16%     -    0s
     0     0 -92812.600    0   35 -92663.759 -92812.600  0.16%     -    0s
     0     0 -92812.600    0   29 -92663.759 -92812.600  0.16%     -    0s
     0     0 -92748.881    0   14 -92663.759 -92748.881  0.09%     -    0s
     0     0 -92680.276    0    4 -92663.759 -92680.276  0.02%     -    0s
     0     0 -92675.390    0    2 -92663.759 -92675.390  0.01%     -    0s

Cutting planes:
  Gomory: 10
  Implied bound: 12
  MIR: 43
  Flow cover: 12

Explored 1 nodes (1320 simplex iterations) in 0.17 seconds (0.09 work units)
Thread count was 32 (of 256 available processors)

Solution count 9: -92663.8 -92624.4 -92593.3 ... 1.18204e+13
No other solutions better than -92663.8

Optimal solution found (tolerance 1.00e-04)
Best objective -9.266375870847e+04, best bound -9.266375870847e+04, gap 0.0000%
  Subproblem solved in 0.18s
  Worst-case operational profit (Z_SP) = 106158.08
  Scenario: 32 demand increases, 28 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -92663.76
  [DEBUG]   S×d_nominal = 198821.83
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 198821.83 + -92663.76 = 106158.08
  [DEBUG]   Current θ from Master = 109649.07
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3491.00 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -9721.10
  Lower Bound (LB) = -7110.37
  Gap (UB-LB) = 880.2606, Absolute Gap = 880.2606, Relative Gap = 0.141291
  Not converged yet (gap = 880.26 > ε = 200)

  [DEBUG] Adding NEW scenario 23 to Master Problem...
  [DEBUG] New scenario pattern: 32 increases, 28 decreases
    [DEBUG] Scenario 23 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 23 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 23]
    [DEBUG]   - Total constraints in model: 368343
    [DEBUG]   - Total variables in model: 152020
  [DEBUG] Total scenarios in Master: 24
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 24
================================================================================
[Iteration 24] Solving Master Problem...
  Current scenarios in Master: 24
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 368343 rows, 152020 columns and 1043063 nonzeros
Model fingerprint: 0xd13615c5
Variable types: 149761 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [9e-02, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 170180 rows and 69130 columns
Presolve time: 3.34s
Presolved: 198163 rows, 82890 columns, 1221797 nonzeros
Variable types: 80631 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -371500.8959
Found heuristic solution: objective -172304.4497

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.33s

Barrier statistics:
 Dense cols : 1158
 AA' NZ     : 5.325e+06
 Factor NZ  : 1.486e+07 (roughly 230 MB of memory)
 Factor Ops : 5.406e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.68084585e+07  2.90659184e+08  8.75e+04 2.00e+01  6.42e+04     6s
   1  -1.26624300e+07  2.51553369e+08  6.08e+04 3.86e+01  4.44e+04     7s
   2  -5.06060654e+06  2.01647040e+08  2.31e+04 2.26e+01  1.74e+04     7s
   3  -1.00313090e+06  1.49604343e+08  1.78e+03 2.11e+00  1.70e+03     7s
   4  -6.61164101e+05  7.61406098e+07  4.56e+02 6.35e-01  5.07e+02     7s
   5  -6.09269931e+05  4.85463494e+07  2.43e+02 3.52e-01  2.80e+02     7s
   6  -4.51528998e+05  3.56298076e+07  8.16e+01 2.39e-01  1.45e+02     7s
   7  -3.79066939e+05  2.68170846e+07  4.36e+01 1.70e-01  9.65e+01     7s
   8  -2.57431207e+05  1.88117965e+07  1.57e+01 1.12e-01  5.91e+01     7s
   9  -1.60467753e+05  8.49234527e+06  4.91e+00 4.59e-02  2.51e+01     7s
  10  -1.44494100e+05  4.60665588e+06  4.10e+00 2.47e-02  1.37e+01     7s
  11  -1.21090141e+05  3.50517254e+06  2.70e+00 1.85e-02  1.03e+01     7s
  12  -1.05555502e+05  2.58430849e+06  1.86e+00 1.36e-02  7.61e+00     7s
  13  -9.27212547e+04  1.99921207e+06  1.32e+00 1.05e-02  5.89e+00     8s
  14  -7.09003156e+04  1.44358115e+06  5.23e-01 7.54e-03  4.23e+00     8s
  15  -5.76321735e+04  3.93486482e+05  2.96e-01 2.15e-03  1.26e+00     8s
  16  -3.35659757e+04  1.91072863e+05  1.33e-01 1.17e-03  6.24e-01     8s
  17  -2.42956430e+04  1.15424093e+05  9.56e-02 1.82e-03  3.88e-01     8s
  18  -1.54122728e+04  9.21385215e+04  6.94e-02 1.53e-03  2.99e-01     8s
  19  -9.16689058e+03  6.09168802e+04  5.27e-02 2.09e-03  1.95e-01     8s
  20  -5.00852926e+03  4.69128910e+04  4.19e-02 1.72e-03  1.44e-01     8s
  21  -2.37426694e+03  4.03675100e+04  3.55e-02 1.85e-03  1.19e-01     8s
  22  -2.37466041e+02  3.67187277e+04  3.03e-02 1.64e-03  1.03e-01     8s
  23   7.42962414e+02  3.35628087e+04  2.79e-02 1.54e-03  9.12e-02     8s
  24   1.68184159e+03  3.10541893e+04  2.58e-02 1.24e-03  8.16e-02     8s
  25   4.05998799e+03  2.69065306e+04  2.04e-02 1.21e-03  6.35e-02     8s
  26   5.93784793e+03  2.45044503e+04  1.65e-02 1.33e-03  5.16e-02     9s
  27   6.75562604e+03  2.32689396e+04  1.48e-02 1.18e-03  4.59e-02     9s
  28   8.33244618e+03  2.09158838e+04  1.16e-02 8.89e-04  3.50e-02     9s
  29   9.40712298e+03  1.97329102e+04  9.62e-03 7.06e-04  2.87e-02     9s
  30   9.89507196e+03  1.78384900e+04  8.74e-03 4.38e-04  2.21e-02     9s
  31   1.08482084e+04  1.72009250e+04  7.09e-03 3.25e-04  1.77e-02     9s
  32   1.14831470e+04  1.65864929e+04  6.00e-03 2.54e-04  1.42e-02     9s
  33   1.21813783e+04  1.64030797e+04  4.82e-03 2.21e-04  1.17e-02     9s
  34   1.24642918e+04  1.61011889e+04  4.32e-03 1.75e-04  1.01e-02     9s
  35   1.27515657e+04  1.59475837e+04  3.83e-03 1.51e-04  8.89e-03     9s
  36   1.29785945e+04  1.59202708e+04  3.45e-03 1.54e-04  8.18e-03     9s
  37   1.32831669e+04  1.56778284e+04  2.93e-03 1.25e-04  6.66e-03    10s
  38   1.36820797e+04  1.55344052e+04  2.20e-03 9.91e-05  5.15e-03    10s
  39   1.38778089e+04  1.53501389e+04  1.86e-03 1.81e-04  4.10e-03    10s
  40   1.39391605e+04  1.53048220e+04  1.76e-03 1.56e-04  3.80e-03    10s
  41   1.41965603e+04  1.52889611e+04  1.34e-03 1.45e-04  3.04e-03    10s
  42   1.42897785e+04  1.52083976e+04  1.18e-03 9.93e-05  2.56e-03    10s
  43   1.43880692e+04  1.52005040e+04  1.03e-03 9.41e-05  2.26e-03    10s
  44   1.44328496e+04  1.51733313e+04  9.53e-04 7.98e-05  2.06e-03    10s
  45   1.45678846e+04  1.51150565e+04  7.26e-04 4.88e-05  1.52e-03    11s
  46   1.47060987e+04  1.50848805e+04  5.03e-04 3.31e-05  1.05e-03    11s
  47   1.48046601e+04  1.50503712e+04  3.41e-04 1.37e-05  6.84e-04    11s
  48   1.48107581e+04  1.50440392e+04  3.32e-04 1.07e-05  6.49e-04    11s
  49   1.49119375e+04  1.50336163e+04  1.65e-04 1.32e-05  3.39e-04    11s
  50   1.49367952e+04  1.50291389e+04  1.25e-04 7.85e-06  2.57e-04    11s
  51   1.50009053e+04  1.50235260e+04  2.66e-05 1.67e-06  6.29e-05    11s
  52   1.50061001e+04  1.50225013e+04  1.94e-05 1.01e-06  4.56e-05    11s
  53   1.50181712e+04  1.50210752e+04  3.55e-06 9.73e-07  8.08e-06    11s
  54   1.50207883e+04  1.50209568e+04  1.43e-07 2.30e-07  4.69e-07    12s
  55   1.50209288e+04  1.50209289e+04  7.30e-10 1.63e-10  1.28e-10    12s

Barrier solved model in 55 iterations and 11.61 seconds (20.90 work units)
Optimal objective 1.50209288e+04


Root crossover log...

  162025 DPushes remaining with DInf 0.0000000e+00                12s
   46965 DPushes remaining with DInf 0.0000000e+00                15s
     974 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                20s

    8579 PPushes remaining with PInf 3.6557809e-05                20s
       0 PPushes remaining with PInf 0.0000000e+00                21s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.0721584e+04     21s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   79458    1.5020929e+04   0.000000e+00   3.072158e+04     21s
   79609    1.5020929e+04   0.000000e+00   0.000000e+00     21s
   79609    1.5020929e+04   0.000000e+00   0.000000e+00     21s
Concurrent spin time: 6.77s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 1.502093e+04, 79609 iterations, 23.71 seconds (44.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 15020.9289    0  369 -172304.45 15020.9289   109%     -   29s
H    0     0                    -159427.9714 15020.9289   109%     -   29s
H    0     0                    -113180.2450 15020.9289   113%     -   29s
H    0     0                    -108448.8783 15020.9289   114%     -   30s
H    0     0                    -107912.4171 15020.9289   114%     -   30s
H    0     0                    -107896.6306 15020.9289   114%     -   30s
H    0     0                    -88142.94548 15020.9289   117%     -   30s
H    0     0                    -88078.95226 15020.9289   117%     -   35s
H    0     0                    -44515.41536 15020.9289   134%     -   35s
H    0     0                    -44498.42945 15020.9289   134%     -   35s
     0     0 8395.20231    0  328 -44498.429 8395.20231   119%     -  105s
H    0     0                    -35437.76580 8393.76546   124%     -  106s
H    0     0                    -21825.04504 8393.76546   138%     -  106s
H    0     0                    -21715.12312 8393.76546   139%     -  106s
     0     0 8219.69587    0  406 -21715.123 8219.69587   138%     -  134s
     0     0 8207.45788    0  385 -21715.123 8207.45788   138%     -  145s
     0     0 8177.80170    0  385 -21715.123 8177.80170   138%     -  148s
     0     0 8177.76224    0  385 -21715.123 8177.76224   138%     -  149s
     0     0 6392.11379    0  382 -21715.123 6392.11379   129%     -  225s
H    0     0                    -14324.84875 6392.04581   145%     -  226s
H    0     0                    -13434.46855 6392.04581   148%     -  226s
     0     0 6175.93905    0  430 -13434.469 6175.93905   146%     -  267s
     0     0 6070.20403    0  441 -13434.469 6070.20403   145%     -  290s
     0     0 5920.12060    0  444 -13434.469 5920.12060   144%     -  321s
     0     0 5858.64260    0  452 -13434.469 5858.64260   144%     -  344s
     0     0 5717.71142    0  444 -13434.469 5717.71142   143%     -  374s
     0     0 5610.94272    0  465 -13434.469 5610.94272   142%     -  397s
     0     0 5586.76413    0  450 -13434.469 5586.76413   142%     -  416s
     0     0 5570.11788    0  457 -13434.469 5570.11788   141%     -  423s
     0     0 5568.17675    0  458 -13434.469 5568.17675   141%     -  428s
     0     0 5567.73023    0  457 -13434.469 5567.73023   141%     -  430s
     0     0 4242.73495    0  559 -13434.469 4242.73495   132%     -  510s
H    0     0                    -12488.08472 4242.55369   134%     -  511s
H    0     0                    -11679.42539 4242.55369   136%     -  511s
H    0     0                    -11647.94426 4242.55369   136%     -  511s
     0     0 4006.41836    0  556 -11647.944 4006.41836   134%     -  541s
     0     0 3935.92174    0  494 -11647.944 3935.92174   134%     -  555s
     0     0 3900.63594    0  562 -11647.944 3900.63594   133%     -  567s
     0     0 3880.58600    0  562 -11647.944 3880.58600   133%     -  574s
     0     0 3870.75459    0  513 -11647.944 3870.75459   133%     -  581s
     0     0 3853.71920    0  562 -11647.944 3853.71920   133%     -  589s
     0     0 3828.72931    0  566 -11647.944 3828.72931   133%     -  596s
     0     0 3684.13812    0  561 -11647.944 3684.13812   132%     -  612s
     0     0 3668.40406    0  569 -11647.944 3668.40406   131%     -  621s
     0     0 3665.62855    0  571 -11647.944 3665.62855   131%     -  625s
     0     0 3658.75795    0  563 -11647.944 3658.75795   131%     -  630s
     0     0 3647.97999    0  566 -11647.944 3647.97999   131%     -  636s
     0     0 3627.49987    0  576 -11647.944 3627.49987   131%     -  645s
     0     0 3625.07538    0  580 -11647.944 3625.07538   131%     -  648s
     0     0 3624.83530    0  576 -11647.944 3624.83530   131%     -  649s
     0     0 3182.69900    0  485 -11647.944 3182.69900   127%     -  696s
H    0     0                    -11505.85132 3182.61582   128%     -  697s
     0     0 3008.01205    0  495 -11505.851 3008.01205   126%     -  729s
     0     0 2964.76038    0  512 -11505.851 2964.76038   126%     -  743s
     0     0 2948.26550    0  508 -11505.851 2948.26550   126%     -  751s
     0     0 2940.16450    0  515 -11505.851 2940.16450   126%     -  755s
     0     0 2924.66715    0  524 -11505.851 2924.66715   125%     -  764s
     0     0 2902.37939    0  507 -11505.851 2902.37939   125%     -  773s
     0     0 2895.44044    0  508 -11505.851 2895.44044   125%     -  778s
     0     0 2894.23474    0  509 -11505.851 2894.23474   125%     -  782s
     0     0 2737.52525    0  597 -11505.851 2737.52525   124%     -  812s
H    0     0                    -10566.86430 2734.96205   126%     -  813s
H    0     0                    -10417.22100 2734.96205   126%     -  813s
H    0     0                    -9222.453590 2734.96205   130%     -  813s
H    0     0                    -9184.657773 2734.96205   130%     -  813s
H    0     0                    -9168.639847 2734.96205   130%     -  813s
     0     0 2696.75700    0  618 -9168.6398 2696.75700   129%     -  827s
     0     0 2663.90903    0  522 -9168.6398 2663.90903   129%     -  840s
     0     0 2649.95663    0  531 -9168.6398 2649.95663   129%     -  847s
     0     0 2633.93714    0  542 -9168.6398 2633.93714   129%     -  857s
     0     0 2623.96106    0  540 -9168.6398 2623.96106   129%     -  867s
     0     0 2618.42895    0  541 -9168.6398 2618.42895   129%     -  874s
     0     0 2612.48666    0  544 -9168.6398 2612.48666   128%     -  881s
     0     0 2610.84531    0  536 -9168.6398 2610.84531   128%     -  885s
     0     0 2435.73257    0  630 -9168.6398 2435.73257   127%     -  918s
H    0     0                    -8794.473374 2435.59796   128%     -  939s
H    0     0                    -8474.903001 2435.59796   129%     -  941s
     0     0 2384.46874    0  709 -8474.9030 2384.46874   128%     -  967s
     0     0 2372.55107    0  630 -8474.9030 2372.55107   128%     -  985s
     0     0 2362.75390    0  695 -8474.9030 2362.75390   128%     -  997s
     0     0 2353.90689    0  632 -8474.9030 2353.90689   128%     - 1005s
     0     0 2347.14662    0  705 -8474.9030 2347.14662   128%     - 1014s
     0     0 2345.24628    0  704 -8474.9030 2345.24628   128%     - 1018s
     0     0 2344.71025    0  638 -8474.9030 2344.71025   128%     - 1021s
     0     0 2287.92767    0  692 -8474.9030 2287.92767   127%     - 1040s
H    0     0                    -8444.738451 2287.66089   127%     - 1041s
H    0     0                    -8391.601774 2287.66089   127%     - 1041s
H    0     0                    -8329.237299 2287.66089   127%     - 1041s
     0     0 2251.80406    0  627 -8329.2373 2251.80406   127%     - 1058s
     0     0 2241.60236    0  627 -8329.2373 2241.60236   127%     - 1072s
     0     0 2238.42315    0  633 -8329.2373 2238.42315   127%     - 1076s
     0     0 2236.74602    0  635 -8329.2373 2236.74602   127%     - 1081s
     0     0 2192.17938    0  664 -8329.2373 2192.17938   126%     - 1109s
H    0     0                    -8323.902920 2191.10592   126%     - 1112s
H    0     0                    -8322.464350 2191.10592   126%     - 1112s
     0     0 2184.95955    0  684 -8322.4643 2184.95955   126%     - 1126s
     0     0 2174.97379    0  691 -8322.4643 2174.97379   126%     - 1134s
     0     0 2172.83719    0  690 -8322.4643 2172.83719   126%     - 1139s
     0     0 2145.40519    0  668 -8322.4643 2145.40519   126%     - 1151s
     0     0 2138.02896    0  678 -8322.4643 2138.02896   126%     - 1159s
     0     0 2131.14319    0  682 -8322.4643 2131.14319   126%     - 1168s
     0     0 2124.05640    0  663 -8322.4643 2124.05640   126%     - 1176s
     0     0 2121.25206    0  677 -8322.4643 2121.25206   125%     - 1180s
     0     0 2115.44103    0  601 -8322.4643 2115.44103   125%     - 1189s
     0     0 2113.58607    0  601 -8322.4643 2113.58607   125%     - 1192s
     0     0 2113.16254    0  606 -8322.4643 2113.16254   125%     - 1193s
     0     0 2089.62633    0  547 -8322.4643 2089.62633   125%     - 1203s
     0     0 2082.48800    0  543 -8322.4643 2082.48800   125%     - 1208s
     0     0 2077.78178    0  542 -8322.4643 2077.78178   125%     - 1210s
     0     0 2075.45988    0  549 -8322.4643 2075.45988   125%     - 1213s
     0     0 2075.04510    0  549 -8322.4643 2075.04510   125%     - 1215s
     0     0 2055.27379    0  550 -8322.4643 2055.27379   125%     - 1225s
H    0     0                    -8319.432936 2055.07753   125%     - 1227s
     0     0 2047.62172    0  560 -8319.4329 2047.62172   125%     - 1232s
     0     0 2046.16160    0  556 -8319.4329 2046.16160   125%     - 1235s
     0     0 2024.73620    0  557 -8319.4329 2024.73620   124%     - 1245s
     0     0 2023.62543    0  559 -8319.4329 2023.62543   124%     - 1250s
     0     0 2010.80470    0  544 -8319.4329 2010.80470   124%     - 1259s
H    0     0                    -8238.616569 2010.14158   124%     - 1278s
H    0     0                    -8223.959440 2010.14158   124%     - 1283s
H    0     0                    -8170.816101 2010.14158   125%     - 1283s
H    0     0                    -8151.862137 2010.14158   125%     - 1285s
H    0     0                    -8115.271384 2010.14158   125%     - 1285s
     0     0 2005.32819    0  555 -8115.2714 2005.32819   125%     - 1289s
     0     0 2001.86784    0  568 -8115.2714 2001.86784   125%     - 1292s
     0     0 2000.97267    0  574 -8115.2714 2000.97267   125%     - 1294s
     0     0 1980.85689    0  566 -8115.2714 1980.85689   124%     - 1305s
H    0     0                    -8100.642919 1980.67194   124%     - 1306s
     0     0 1976.97863    0  571 -8100.6429 1976.97863   124%     - 1309s
     0     0 1973.94465    0  566 -8100.6429 1973.94465   124%     - 1312s
     0     0 1969.54084    0  582 -8100.6429 1969.54084   124%     - 1314s
     0     0 1963.72906    0  581 -8100.6429 1963.72906   124%     - 1318s
     0     0 1953.81041    0  577 -8100.6429 1953.81041   124%     - 1322s
     0     0 1935.39991    0  570 -8100.6429 1935.39991   124%     - 1330s
     0     0 1928.45225    0  573 -8100.6429 1928.45225   124%     - 1335s
     0     0 1928.04249    0  584 -8100.6429 1928.04249   124%     - 1337s
     0     0 1911.61159    0  580 -8100.6429 1911.61159   124%     - 1348s
H    0     0                    -8085.386083 1911.41621   124%     - 1352s
     0     0 1909.94487    0  588 -8085.3861 1909.94487   124%     - 1355s
     0     0 1883.47123    0  567 -8085.3861 1883.47123   123%     - 1364s
     0     0 1858.21360    0  566 -8085.3861 1858.21360   123%     - 1374s
     0     0 1848.99263    0  757 -8085.3861 1848.99263   123%     - 1385s
     0     0 1844.99929    0  639 -8085.3861 1844.99929   123%     - 1388s
     0     0 1841.89993    0  580 -8085.3861 1841.89993   123%     - 1395s
     0     0 1840.98295    0  580 -8085.3861 1840.98295   123%     - 1398s
     0     0 1836.45695    0  635 -8085.3861 1836.45695   123%     - 1407s
     0     0 1832.13538    0  634 -8085.3861 1832.13538   123%     - 1417s
     0     0 1831.27361    0  640 -8085.3861 1831.27361   123%     - 1420s
     0     0 1823.83411    0  625 -8085.3861 1823.83411   123%     - 1432s
     0     0 1821.42230    0  573 -8085.3861 1821.42230   123%     - 1438s
     0     0 1820.18038    0  571 -8085.3861 1820.18038   123%     - 1441s
     0     0 1815.74191    0  761 -8085.3861 1815.74191   122%     - 1451s
H    0     0                    -8071.798937 1815.25722   122%     - 1486s
H    0     0                    -8060.080427 1815.25722   123%     - 1498s
H    0     0                    -8056.742376 1815.25722   123%     - 1498s
     0     0 1813.78959    0  654 -8056.7424 1813.78959   123%     - 1506s
     0     0 1810.16775    0  649 -8056.7424 1810.16775   122%     - 1514s
     0     0 1807.85455    0  573 -8056.7424 1807.85455   122%     - 1517s
     0     0 1806.15517    0  571 -8056.7424 1806.15517   122%     - 1521s
     0     0 1800.99215    0  647 -8056.7424 1800.99215   122%     - 1531s
     0     0 1800.91057    0  647 -8056.7424 1800.91057   122%     - 1549s
H    0     0                    -8048.648335 1800.91057   122%     - 1572s
H    0     0                    -7204.605755 1800.84857   125%     - 1791s
H    0     2                    -7018.482373 1800.84857   126%     - 1794s
     0     2 1800.84857    0  647 -7018.4824 1800.84857   126%     - 1794s
     1     3 1718.63736    1  464 -7018.4824 1800.84857   126% 16925 1813s
     2     4 1786.10486    1  740 -7018.4824 1786.10486   125% 13889 1823s
     3     5 1248.73766    2  463 -7018.4824 1785.94348   125% 12944 1839s
     4    10  773.92292    3  451 -7018.4824 1785.94348   125% 13908 1861s
     9    18   54.90859    4  399 -7018.4824 1723.35131   125% 12581 1910s
    17    35  -95.67652    5  414 -7018.4824 1708.92262   124% 15903 1958s
    34    45     cutoff    6      -7018.4824 1708.43047   124% 21156 2053s
    48    64 -6767.0458    6  173 -7018.4824 1708.43047   124% 24137 2278s
H   56    64                    -7000.780369 1708.43047   124% 22994 2278s
H   71    91                    -6546.285688 1705.41116   126% 21201 2344s
H   76    91                    -6524.047363 1705.41116   126% 21346 2345s
H   80    91                    -6439.923366 1705.41116   126% 21377 2345s
H   81    91                    -6417.090377 1705.41116   127% 21319 2345s
   105   199     cutoff    8      -6417.0904 1705.41116   127% 19508 2437s
H  188   199                    -6345.222283 1705.41116   127% 14459 2437s
H  198   199                    -6267.005264 1705.41116   127% 14049 2437s
   243   225 -966.74015   11  457 -6267.0053 1705.41116   127% 13193 2483s
   308   223 -5460.7910    9  162 -6267.0053 1705.41116   127% 12106 2528s
   360   251 -2173.8457   11  353 -6267.0053 1705.41116   127% 12128 2570s
   411   277 -2656.5362   12  360 -6267.0053 1705.41116   127% 12204 2610s
   449   314 -2836.6562   13  368 -6267.0053 1705.41116   127% 12311 2667s
   512   341 -2997.8934   15  268 -6267.0053 1705.41116   127% 12020 2705s
   561   383 -3108.9442   17  342 -6267.0053 1705.41116   127% 12078 2746s
   625   412 -3353.3339   21  325 -6267.0053 1705.41116   127% 11784 2783s
   686   418 infeasible   21      -6267.0053 1705.41116   127% 11433 2819s
   746   431 infeasible   21      -6267.0053 1705.41116   127% 11299 2852s
   780   442     cutoff   17      -6267.0053 1705.41116   127% 11339 2882s
   827   451 infeasible   19      -6267.0053 1705.41116   127% 11055 2919s
   866   480 -4041.9693   11  174 -6267.0053 1705.41116   127% 11117 2949s
   915   512 -4271.9849   13  163 -6267.0053 1705.41116   127% 11074 2984s
   973   544 -5365.3995   16  277 -6267.0053 1705.41116   127% 10972 3021s
H 1058   544                    -6239.478776 1705.41116   127% 10716 3021s
  1063   558 -5705.0790   20  155 -6239.4788 1705.41116   127% 10686 3054s
  1123   577 infeasible   24      -6239.4788 1705.41116   127% 10476 3090s
  1205   598 -5833.1995   21  267 -6239.4788 1705.41116   127% 10285 3128s
H 1211   598                    -6223.452334 1705.41116   127% 10271 3128s
H 1236   598                    -6191.477831 1705.41116   128% 10258 3128s
  1270   614 infeasible   25      -6191.4778 1705.41116   128% 10154 3168s
H 1375   629                    -6173.959636 1705.41116   128%  9922 3215s
H 1421   629                    -6172.234195 1705.41116   128%  9875 3215s
  1460   657 -2381.8459   14  405 -6172.2342 1705.41116   128%  9853 3259s
  1538   729 -2820.5825   16  541 -6172.2342 1705.41116   128%  9974 3303s
  1657   756 -2593.0301   16  393 -6172.2342 1705.41116   128%  9845 3348s
  1782   768 -4653.2851   18  257 -6172.2342 1705.41116   128%  9718 3389s
  1821   786 -4846.3644   19  159 -6172.2342 1705.41116   128%  9842 3430s
  1880   811 -5048.4359   20  254 -6172.2342 1498.91354   124%  9878 3473s
  1951   832 infeasible   21      -6172.2342 1498.46667   124%  9984 3518s
  2038   873 infeasible   24      -6172.2342 1496.88417   124%  9976 3575s
  2138   891 -5948.2951   26  146 -6172.2342 1496.88417   124% 10014 3600s

Cutting planes:
  Implied bound: 339
  MIR: 4882
  Flow cover: 4414
  Inf proof: 1
  Zero half: 11
  RLT: 91
  Relax-and-lift: 684

Explored 2198 nodes (23040439 simplex iterations) in 3600.10 seconds (7978.34 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -6172.23 -6173.96 -6191.48 ... -6524.05

Time limit reached
Best objective -6.172234194944e+03, best bound 1.402221362928e+03, gap 122.7182%
  WARNING: Time limit reached. Using best solution found (gap: 122.72%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3600.12s
  Master Objective (UB) = -6172.23, θ = 109971.36
  Upper Bound (UB) = -6172.23

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 109971.36
  [DEBUG]   ✓ Scenario 0: θ = 109971.36 ≤ Q = 109971.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 109971.36 ≤ Q = 109971.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 109971.36 ≤ Q = 109971.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 109971.36 ≤ Q = 109971.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 109971.36 ≤ Q = 109971.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 109971.36 ≤ Q = 109971.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 109971.36 ≤ Q = 109971.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 109971.36 ≤ Q = 109971.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 109971.36 ≤ Q = 109971.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 109971.36 ≤ Q = 109971.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 109971.36 ≤ Q = 109971.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 109971.36 ≤ Q = 109971.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 109971.36 ≤ Q = 109971.36 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 109971.36 ≤ Q = 109971.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 109971.36 ≤ Q = 109971.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 109971.36 ≤ Q = 109971.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 109971.36 ≤ Q = 109971.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 109971.36 ≤ Q = 109971.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 109971.36 ≤ Q = 109971.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 109971.36 ≤ Q = 109971.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 20: θ = 109971.36 ≤ Q = 109971.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 21: θ = 109971.36 ≤ Q = 109971.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 22: θ = 109971.36 ≤ Q = 109971.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 23: θ = 109971.36 ≤ Q = 109971.36 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 24] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x71c8621b
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x71c8621b
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.185791e+13
Presolve removed 2608 rows and 1900 columns
Presolve time: 0.00s
Presolved: 485 rows, 489 columns, 1368 nonzeros
Found heuristic solution: objective 6050868.8146
Variable types: 330 continuous, 159 integer (159 binary)

Root relaxation: objective -1.190496e+05, 229 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -119049.64    0  120 6050868.81 -119049.64   102%     -    0s
H    0     0                    -76294.56163 -119049.64  56.0%     -    0s
H    0     0                    -76587.48398 -119049.64  55.4%     -    0s
H    0     0                    -77673.23357 -118814.02  53.0%     -    0s
     0     0 -92597.130    0   99 -77673.234 -92597.130  19.2%     -    0s
H    0     0                    -88371.82552 -92479.962  4.65%     -    0s
H    0     0                    -88659.73661 -92479.962  4.31%     -    0s
H    0     0                    -89517.17738 -92479.962  3.31%     -    0s
H    0     0                    -89805.08847 -92479.962  2.98%     -    0s
     0     0 -91996.700    0   97 -89805.088 -91996.700  2.44%     -    0s
H    0     0                    -90002.14349 -91792.094  1.99%     -    0s
     0     0 -91792.094    0   98 -90002.143 -91792.094  1.99%     -    0s
     0     0 -91775.772    0   98 -90002.143 -91775.772  1.97%     -    0s
     0     0 -91654.934    0   91 -90002.143 -91654.934  1.84%     -    0s
     0     0 -91651.740    0   91 -90002.143 -91651.740  1.83%     -    0s
H    0     0                    -91100.13653 -91632.585  0.58%     -    0s
H    0     0                    -91113.63161 -91632.585  0.57%     -    0s
     0     2 -91632.585    0   91 -91113.632 -91632.585  0.57%     -    0s
*   41     5               9    -91148.32231 -91197.209  0.05%   9.8    0s

Cutting planes:
  Gomory: 35
  MIR: 150
  RLT: 2

Explored 59 nodes (957 simplex iterations) in 0.14 seconds (0.06 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -91148.3 -91113.6 -91100.1 ... 6.05087e+06
No other solutions better than -91148.3

Optimal solution found (tolerance 1.00e-04)
Best objective -9.114832231318e+04, best bound -9.114832231318e+04, gap 0.0000%
  Subproblem solved in 0.15s
  Worst-case operational profit (Z_SP) = 107819.08
  Scenario: 19 demand increases, 41 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -91148.32
  [DEBUG]   S×d_nominal = 198967.40
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 198967.40 + -91148.32 = 107819.08
  [DEBUG]   Current θ from Master = 109971.36
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2152.28 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -8324.51
  Lower Bound (LB) = -7110.37
  Gap (UB-LB) = 938.1317, Absolute Gap = 938.1317, Relative Gap = 0.151992
  Not converged yet (gap = 938.13 > ε = 200)

  [DEBUG] Adding NEW scenario 24 to Master Problem...
  [DEBUG] New scenario pattern: 19 increases, 41 decreases
    [DEBUG] Scenario 24 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 24 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 24]
    [DEBUG]   - Total constraints in model: 383633
    [DEBUG]   - Total variables in model: 158260
  [DEBUG] Total scenarios in Master: 25
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 25
================================================================================
[Iteration 25] Solving Master Problem...
  Current scenarios in Master: 25
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 383633 rows, 158260 columns and 1086294 nonzeros
Model fingerprint: 0xc9290416
Variable types: 156001 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [9e-02, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 177270 rows and 72010 columns
Presolve time: 3.51s
Presolved: 206363 rows, 86250 columns, 1272198 nonzeros
Variable types: 83991 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -371500.8959
Found heuristic solution: objective -172304.4497

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.70s

Barrier statistics:
 Dense cols : 1156
 AA' NZ     : 5.715e+06
 Factor NZ  : 1.584e+07 (roughly 250 MB of memory)
 Factor Ops : 5.712e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.68157218e+07  3.00662807e+08  8.75e+04 1.98e+01  6.39e+04     7s
   1  -1.26638364e+07  2.59959194e+08  6.08e+04 3.79e+01  4.42e+04     7s
   2  -5.08752950e+06  2.08428465e+08  2.32e+04 2.19e+01  1.73e+04     8s
   3  -6.69590139e+05  1.52713881e+08  7.14e+02 2.64e+00  9.18e+02     8s
   4  -5.58049993e+05  8.23532844e+07  3.07e+02 1.18e+00  4.19e+02     8s
   5  -4.81754951e+05  6.62033947e+07  1.29e+02 9.04e-01  2.57e+02     8s
   6  -4.41440869e+05  4.90277676e+07  5.46e+01 6.36e-01  1.62e+02     8s
   7  -4.05350749e+05  3.51610539e+07  2.70e+01 4.39e-01  1.08e+02     8s
   8  -3.40743520e+05  2.83395313e+07  1.09e+01 3.47e-01  8.09e+01     8s
   9  -2.12749097e+05  9.29834660e+06  2.16e+00 1.05e-01  2.57e+01     8s
  10  -1.50722896e+05  4.97615995e+06  1.08e+00 5.48e-02  1.38e+01     8s
  11  -1.27497485e+05  3.87612060e+06  8.03e-01 4.23e-02  1.07e+01     8s
  12  -1.11817995e+05  2.90580831e+06  5.88e-01 3.14e-02  8.08e+00     8s
  13  -9.52356480e+04  2.20205571e+06  4.05e-01 2.36e-02  6.14e+00     8s
  14  -6.65702157e+04  1.50220436e+06  1.73e-01 1.64e-02  4.19e+00     8s
  15  -4.62566427e+04  2.92727033e+05  7.62e-02 2.85e-03  9.04e-01     8s
  16  -2.45486402e+04  1.81727245e+05  4.03e-02 1.70e-03  5.50e-01     8s
  17  -2.06950024e+04  1.38744191e+05  3.58e-02 2.62e-03  4.25e-01     9s
  18  -1.29072278e+04  9.50037660e+04  2.66e-02 2.21e-03  2.88e-01     9s
  19  -7.79485127e+03  6.66351464e+04  2.08e-02 1.51e-03  1.98e-01     9s
  20  -3.54994746e+03  5.13755547e+04  1.63e-02 1.10e-03  1.46e-01     9s
  21  -2.35815852e+03  3.97096600e+04  1.51e-02 8.10e-04  1.12e-01     9s
  22   1.80874876e+02  3.73438036e+04  1.26e-02 7.41e-04  9.91e-02     9s
  23   1.41360022e+03  3.08329253e+04  1.14e-02 4.66e-04  7.84e-02     9s
  24   3.98759387e+03  2.75730918e+04  8.97e-03 3.42e-04  6.29e-02     9s
  25   5.19690638e+03  2.40644969e+04  7.86e-03 2.58e-04  5.03e-02     9s
  26   6.80145907e+03  2.25741988e+04  6.50e-03 2.15e-04  4.21e-02     9s
  27   8.31409619e+03  2.05662621e+04  5.23e-03 1.59e-04  3.27e-02     9s
  28   9.11502670e+03  1.84404354e+04  4.62e-03 1.27e-04  2.49e-02    10s
  29   1.05473843e+04  1.75043706e+04  3.48e-03 9.64e-05  1.86e-02    10s
  30   1.18691370e+04  1.67800316e+04  2.43e-03 6.65e-05  1.31e-02    10s
  31   1.24479238e+04  1.64133658e+04  2.00e-03 5.33e-05  1.06e-02    10s
  32   1.28662371e+04  1.61008364e+04  1.66e-03 4.07e-05  8.63e-03    10s
  33   1.32070460e+04  1.58418589e+04  1.38e-03 3.04e-05  7.03e-03    10s
  34   1.36594569e+04  1.56320087e+04  1.02e-03 2.28e-05  5.26e-03    10s
  35   1.38071522e+04  1.55609901e+04  9.04e-04 4.02e-05  4.68e-03    10s
  36   1.39012673e+04  1.54645755e+04  8.33e-04 3.21e-05  4.17e-03    10s
  37   1.42275705e+04  1.53392145e+04  5.89e-04 2.28e-05  2.96e-03    10s
  38   1.44013986e+04  1.52721111e+04  4.56e-04 1.77e-05  2.32e-03    10s
  39   1.45134313e+04  1.52342871e+04  3.70e-04 1.50e-05  1.92e-03    11s
  40   1.47106902e+04  1.51605257e+04  2.21e-04 9.96e-06  1.20e-03    11s
  41   1.47294713e+04  1.51370810e+04  2.08e-04 8.27e-06  1.09e-03    11s
  42   1.48959606e+04  1.51014779e+04  8.50e-05 5.62e-06  5.48e-04    11s
  43   1.49315486e+04  1.50390035e+04  5.91e-05 1.10e-06  2.87e-04    11s
  44   1.50010129e+04  1.50267834e+04  1.07e-05 1.44e-06  6.87e-05    11s
  45   1.50122328e+04  1.50248417e+04  4.33e-06 9.59e-07  3.36e-05    11s
  46   1.50198184e+04  1.50210715e+04  5.15e-07 5.89e-07  3.35e-06    11s
  47   1.50208554e+04  1.50209296e+04  6.69e-08 4.91e-09  1.98e-07    11s
  48   1.50209158e+04  1.50209289e+04  1.16e-07 3.05e-10  3.52e-08    11s
  49   1.50209210e+04  1.50209289e+04  2.07e-06 4.20e-08  2.11e-08    12s
  50   1.50209280e+04  1.50209289e+04  1.47e-07 5.06e-08  2.23e-09    12s
  51   1.50209286e+04  1.50209289e+04  6.22e-08 1.88e-08  6.06e-10    12s
  52   1.50209289e+04  1.50209289e+04  3.80e-10 5.58e-11  1.06e-12    12s

Barrier solved model in 52 iterations and 11.77 seconds (21.82 work units)
Optimal objective 1.50209289e+04


Root crossover log...

  168338 DPushes remaining with DInf 0.0000000e+00                12s
   27467 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                18s

    5350 PPushes remaining with PInf 4.7315663e-07                18s
       0 PPushes remaining with PInf 0.0000000e+00                19s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.4991123e-10     19s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   74293    1.5020929e+04   0.000000e+00   0.000000e+00     19s
   74293    1.5020929e+04   0.000000e+00   0.000000e+00     19s
Concurrent spin time: 3.72s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 1.502093e+04, 74293 iterations, 17.96 seconds (36.10 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 15020.9289    0  369 -172304.45 15020.9289   109%     -   23s
H    0     0                    -124714.4731 15020.9289   112%     -   24s
H    0     0                    -124636.5209 15020.9289   112%     -   24s
H    0     0                    -123106.9439 15020.9289   112%     -   24s
H    0     0                    -122370.9323 15020.9289   112%     -   24s
H    0     0                    -87933.70112 15020.9289   117%     -   24s
H    0     0                    -87869.70790 15020.9289   117%     -   27s
H    0     0                    -44444.43072 15020.9289   134%     -   28s
     0     0 8006.61594    0  396 -44444.431 8006.61594   118%     -   88s
H    0     0                    -39448.12152 8005.35695   120%     -   89s
H    0     0                    -36648.03272 8005.35695   122%     -   89s
H    0     0                    -36180.20969 8005.35695   122%     -   90s
H    0     0                    -35698.22288 8005.35695   122%     -   90s
     0     0 7967.42154    0  397 -35698.223 7967.42154   122%     -   99s
     0     0 7963.77845    0  397 -35698.223 7963.77845   122%     -  106s
     0     0 7957.67315    0  401 -35698.223 7957.67315   122%     -  112s
     0     0 7938.81098    0  394 -35698.223 7938.81098   122%     -  125s
     0     0 7938.12833    0  399 -35698.223 7938.12833   122%     -  127s
     0     0 6020.19475    0  388 -35698.223 6020.19475   117%     -  184s
H    0     0                    -19919.24115 6017.58793   130%     -  186s
H    0     0                    -17718.79708 6017.58793   134%     -  187s
H    0     0                    -16726.28045 6017.58793   136%     -  187s
H    0     0                    -16592.40766 6017.58793   136%     -  187s
H    0     0                    -16577.15083 6017.58793   136%     -  188s
     0     0 5666.19144    0  404 -16577.151 5666.19144   134%     -  228s
     0     0 5532.39266    0  407 -16577.151 5532.39266   133%     -  253s
     0     0 5415.36062    0  519 -16577.151 5415.36062   133%     -  280s
     0     0 5398.42672    0  520 -16577.151 5398.42672   133%     -  287s
     0     0 5391.30895    0  512 -16577.151 5391.30895   133%     -  293s
     0     0 5389.67822    0  512 -16577.151 5389.67822   133%     -  296s
     0     0 5360.98151    0  519 -16577.151 5360.98151   132%     -  301s
     0     0 5347.48336    0  529 -16577.151 5347.48336   132%     -  318s
     0     0 5337.73275    0  537 -16577.151 5337.73275   132%     -  326s
     0     0 5336.97630    0  540 -16577.151 5336.97630   132%     -  330s
     0     0 4139.82795    0  399 -16577.151 4139.82795   125%     -  446s
H    0     0                    -16094.32867 4139.36251   126%     -  447s
     0     0 3941.43990    0  412 -16094.329 3941.43990   124%     -  479s
     0     0 3880.20416    0  407 -16094.329 3880.20416   124%     -  505s
     0     0 3847.48321    0  463 -16094.329 3847.48321   124%     -  518s
     0     0 3838.14099    0  415 -16094.329 3838.14099   124%     -  525s
     0     0 3829.90617    0  461 -16094.329 3829.90617   124%     -  533s
     0     0 3816.01684    0  484 -16094.329 3816.01684   124%     -  542s
     0     0 3803.51217    0  493 -16094.329 3803.51217   124%     -  549s
     0     0 3797.89094    0  488 -16094.329 3797.89094   124%     -  554s
     0     0 3796.13321    0  490 -16094.329 3796.13321   124%     -  557s
     0     0 3792.57281    0  488 -16094.329 3792.57281   124%     -  560s
     0     0 3791.14471    0  492 -16094.329 3791.14471   124%     -  563s
     0     0 3261.70207    0  589 -16094.329 3261.70207   120%     -  619s
H    0     0                    -16082.94921 3261.64423   120%     -  620s
     0     0 3177.00604    0  536 -16082.949 3177.00604   120%     -  648s
     0     0 3116.37533    0  520 -16082.949 3116.37533   119%     -  667s
     0     0 3099.12670    0  529 -16082.949 3099.12670   119%     -  678s
     0     0 3040.79079    0  523 -16082.949 3040.79079   119%     -  692s
     0     0 3022.01157    0  535 -16082.949 3022.01157   119%     -  702s
     0     0 3014.87596    0  535 -16082.949 3014.87596   119%     -  710s
     0     0 2966.51272    0  521 -16082.949 2966.51272   118%     -  721s
     0     0 2954.40467    0  534 -16082.949 2954.40467   118%     -  733s
     0     0 2950.31932    0  526 -16082.949 2950.31932   118%     -  739s
     0     0 2944.62534    0  529 -16082.949 2944.62534   118%     -  747s
     0     0 2920.90768    0  617 -16082.949 2920.90768   118%     -  766s
     0     0 2917.85895    0  527 -16082.949 2917.85895   118%     -  776s
     0     0 2883.60503    0  524 -16082.949 2883.60503   118%     -  791s
     0     0 2865.41190    0  524 -16082.949 2865.41190   118%     -  810s
     0     0 2855.94675    0  531 -16082.949 2855.94675   118%     -  817s
     0     0 2854.29479    0  522 -16082.949 2854.29479   118%     -  820s
     0     0 2852.84245    0  516 -16082.949 2852.84245   118%     -  824s
     0     0 2670.89139    0  598 -16082.949 2670.89139   117%     -  861s
H    0     0                    -16057.70921 2670.85964   117%     -  862s
     0     0 2623.64818    0  613 -16057.709 2623.64818   116%     -  883s
     0     0 2603.92006    0  616 -16057.709 2603.92006   116%     -  894s
     0     0 2548.91149    0  583 -16057.709 2548.91149   116%     -  912s
     0     0 2516.50374    0  595 -16057.709 2516.50374   116%     -  923s
     0     0 2509.66125    0  607 -16057.709 2509.66125   116%     -  930s
     0     0 2507.51229    0  606 -16057.709 2507.51229   116%     -  934s
     0     0 2433.99940    0  658 -16057.709 2433.99940   115%     -  952s
     0     0 2427.90813    0  674 -16057.709 2427.90813   115%     -  958s
     0     0 2424.68759    0  672 -16057.709 2424.68759   115%     -  964s
     0     0 2423.84769    0  678 -16057.709 2423.84769   115%     -  969s
     0     0 2228.39703    0  601 -16057.709 2228.39703   114%     -  994s
H    0     0                    -12324.98836 2227.79528   118%     -  996s
H    0     0                    -12258.93476 2227.79528   118%     -  998s
H    0     0                    -12248.19783 2227.79528   118%     -  998s
H    0     0                    -12230.73675 2227.79528   118%     -  998s
H    0     0                    -12125.10328 2227.79528   118%     -  998s
     0     0 2211.49514    0  608 -12125.103 2211.49514   118%     - 1006s
     0     0 2195.22295    0  616 -12125.103 2195.22295   118%     - 1015s
     0     0 2185.98426    0  523 -12125.103 2185.98426   118%     - 1021s
     0     0 2183.97507    0  529 -12125.103 2183.97507   118%     - 1026s
     0     0 2174.50004    0  519 -12125.103 2174.50004   118%     - 1031s
     0     0 2171.10966    0  515 -12125.103 2171.10966   118%     - 1034s
     0     0 2170.52941    0  514 -12125.103 2170.52941   118%     - 1037s
     0     0 2089.23883    0  523 -12125.103 2089.23883   117%     - 1052s
H    0     0                    -11919.90055 2089.16447   118%     - 1052s
H    0     0                    -11559.14712 2089.16447   118%     - 1052s
     0     0 2074.78855    0  608 -11559.147 2074.78855   118%     - 1060s
     0     0 2069.21296    0  617 -11559.147 2069.21296   118%     - 1067s
     0     0 2065.14528    0  605 -11559.147 2065.14528   118%     - 1071s
     0     0 2063.42794    0  602 -11559.147 2063.42794   118%     - 1073s
     0     0 1935.70128    0  508 -11559.147 1935.70128   117%     - 1096s
H    0     0                    -11542.91810 1935.02431   117%     - 1097s
     0     0 1899.76695    0  539 -11542.918 1899.76695   116%     - 1106s
     0     0 1884.34738    0  532 -11542.918 1884.34738   116%     - 1112s
     0     0 1879.14451    0  520 -11542.918 1879.14451   116%     - 1119s
     0     0 1878.50649    0  519 -11542.918 1878.50649   116%     - 1121s
     0     0 1861.18629    0  569 -11542.918 1861.18629   116%     - 1133s
     0     0 1858.13692    0  575 -11542.918 1858.13692   116%     - 1137s
     0     0 1855.35475    0  528 -11542.918 1855.35475   116%     - 1140s
     0     0 1854.55731    0  532 -11542.918 1854.55731   116%     - 1141s
     0     0 1837.87650    0  548 -11542.918 1837.87650   116%     - 1152s
H    0     0                    -11525.45702 1837.86649   116%     - 1154s
     0     0 1835.12427    0  552 -11525.457 1835.12427   116%     - 1159s
     0     0 1831.78343    0  548 -11525.457 1831.78343   116%     - 1164s
     0     0 1822.19547    0  543 -11525.457 1822.19547   116%     - 1169s
     0     0 1821.37645    0  551 -11525.457 1821.37645   116%     - 1172s
     0     0 1809.89153    0  554 -11525.457 1809.89153   116%     - 1182s
     0     0 1806.39386    0  604 -11525.457 1806.39386   116%     - 1189s
     0     0 1803.71517    0  618 -11525.457 1803.71517   116%     - 1194s
     0     0 1803.04024    0  571 -11525.457 1803.04024   116%     - 1197s
     0     0 1786.62754    0  551 -11525.457 1786.62754   116%     - 1209s
H    0     0                    -10352.02490 1786.24102   117%     - 1218s
H    0     0                    -10271.47662 1786.24102   117%     - 1220s
H    0     0                    -10233.27674 1786.24102   117%     - 1220s
H    0     0                    -10030.39608 1786.24102   118%     - 1222s
     0     0 1781.95122    0  546 -10030.396 1781.95122   118%     - 1227s
     0     0 1780.32782    0  605 -10030.396 1780.32782   118%     - 1231s
     0     0 1772.89950    0  552 -10030.396 1772.89950   118%     - 1239s
H    0     0                    -9872.032299 1771.60849   118%     - 1240s
H    0     0                    -9761.379848 1771.60849   118%     - 1241s
H    0     0                    -9745.210547 1771.60849   118%     - 1241s
     0     0 1768.50092    0  549 -9745.2105 1768.50092   118%     - 1244s
     0     0 1764.45706    0  604 -9745.2105 1764.45706   118%     - 1250s
     0     0 1760.87685    0  560 -9745.2105 1760.87685   118%     - 1255s
     0     0 1759.72171    0  563 -9745.2105 1759.72171   118%     - 1257s
     0     0 1752.51265    0  553 -9745.2105 1752.51265   118%     - 1265s
H    0     0                    -9546.290492 1751.82590   118%     - 1267s
     0     0 1750.85124    0  549 -9546.2905 1750.85124   118%     - 1270s
     0     0 1748.65148    0  561 -9546.2905 1748.65148   118%     - 1276s
H    0     0                    -8463.255767 1748.50892   121%     - 1277s
H    0     0                    -8449.668621 1748.50892   121%     - 1277s
     0     0 1746.21029    0  561 -8449.6686 1746.21029   121%     - 1281s
     0     0 1746.02397    0  567 -8449.6686 1746.02397   121%     - 1282s
     0     0 1741.82260    0  576 -8449.6686 1741.82260   121%     - 1290s
H    0     0                    -8299.909702 1741.74354   121%     - 1293s
     0     0 1740.07922    0  564 -8299.9097 1740.07922   121%     - 1298s
     0     0 1736.52428    0  566 -8299.9097 1736.52428   121%     - 1307s
     0     0 1736.23370    0  566 -8299.9097 1736.23370   121%     - 1322s
H    0     0                    -8255.209150 1735.41440   121%     - 1361s
H    0     0                    -8208.531327 1735.41440   121%     - 1361s
H    0     0                    -8098.570418 1735.41440   121%     - 1361s
     0     2 1735.41440    0  566 -8098.5704 1735.41440   121%     - 1460s
     1     3 1595.25230    1  534 -8098.5704 1735.41440   121% 29044 1471s
     2     4 1718.72472    1  567 -8098.5704 1718.72472   121% 17382 1480s
     3     5 1417.87030    2  546 -8098.5704 1718.66651   121% 16636 1499s
     4     8 1675.09701    2  562 -8098.5704 1718.66651   121% 14755 1536s
     7    14 1646.28711    3  558 -8098.5704 1718.66651   121% 15134 1565s
    13    27 -151.19791    4  413 -8098.5704 1672.69882   121% 15215 1608s
    26    40  963.94871    6  525 -8098.5704 1538.46823   119% 21419 1698s
    39    66  312.83455    7  447 -8098.5704 1538.46823   119% 20549 2443s
H   40    66                    -7941.343755 1538.46823   119% 20035 2443s
    68   147  -46.24480    8  444 -7941.3438 1538.46823   119% 29907 2565s
   165   195 -143.20412    9  438 -7941.3438 1538.46823   119% 19215 2612s
H  169   195                    -7918.462567 1538.46823   119% 18891 2612s
   227   261 -217.23831   10  432 -7918.4626 1538.46823   119% 16767 2662s
   303   314 -4613.6140   15  177 -7918.4626 1538.46823   119% 15693 2702s
   372   357 -3990.7380   11  176 -7918.4626 1538.46823   119% 14747 2741s
   445   374 -4997.3541   12  149 -7918.4626 1538.46823   119% 13776 2771s
   489   375 -5270.7751   12  159 -7918.4626 1538.46823   119% 13494 2809s
   555   394 -5129.3867   13  142 -7918.4626 1538.46823   119% 12943 2841s
   604   410 -5443.3828   16  139 -7918.4626 1538.46823   119% 12788 2873s
   639   427 -6089.0194   17  139 -7918.4626 1538.46823   119% 12917 2904s
   679   447 -6159.9716   18  132 -7918.4626 1538.46823   119% 12607 2940s
   734   480 -6622.9539   19  126 -7918.4626 1538.46823   119% 12336 2973s
   812   514 -6922.6660   19  130 -7918.4626 1538.46823   119% 11789 3005s
   902   536 -6922.9982   20  128 -7918.4626 1538.46823   119% 11252 3035s
   994   540 -7360.3445   23  104 -7918.4626 1538.46823   119% 10675 3070s
  1062   559 infeasible   26      -7918.4626 1538.46823   119% 10367 3108s
  1114   596 -7830.1680   30   31 -7918.4626 1538.46823   119% 10329 3141s
  1179   606 -2664.4965    9  191 -7918.4626 1538.46823   119% 10207 3177s
  1237   638 -3091.3240   10  192 -7918.4626 1538.46823   119% 10098 3208s
  1315   680 -5927.5183   12  135 -7918.4626 1538.46823   119%  9866 3247s
  1422   724 -7200.4827   20   89 -7918.4626 1538.46823   119%  9651 3280s
  1504   760     cutoff   29      -7918.4626 1538.46823   119%  9455 3322s
  1597   812 -4363.1303   12  414 -7918.4626 1538.46823   119%  9442 3363s
  1719   863 -4391.2094   13  404 -7918.4626 1538.46823   119%  9267 3407s
  1834   920 -4718.6656   14  364 -7918.4626 1538.46823   119%  9179 3452s
  1940   970 -4875.6730   16  368 -7918.4626 1538.46823   119%  9165 3500s
  2032  1024 -5171.7562   19  363 -7918.4626 1538.46823   119%  9235 3550s
  2144  1078 -6254.3312   23  101 -7918.4626 1538.46823   119%  9285 3594s
H 2243  1078                    -7796.594279 1538.46823   120%  9230 3594s
  2258  1068 infeasible   38      -7796.5943 1538.46823   120%  9223 3600s

Cutting planes:
  Learned: 1
  Implied bound: 353
  MIR: 5426
  Flow cover: 4509
  Zero half: 6
  RLT: 83
  Relax-and-lift: 594

Explored 2282 nodes (21989088 simplex iterations) in 3600.08 seconds (8180.95 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -7796.59 -7918.46 -7941.34 ... -9546.29

Time limit reached
Best objective -7.796594278784e+03, best bound 1.538468227387e+03, gap 119.7326%
  WARNING: Time limit reached. Using best solution found (gap: 119.73%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3600.09s
  Master Objective (UB) = -7796.59, θ = 107652.51
  Upper Bound (UB) = -7796.59

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 107652.51
  [DEBUG]   ✓ Scenario 0: θ = 107652.51 ≤ Q = 107652.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 107652.51 ≤ Q = 107652.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 107652.51 ≤ Q = 107652.51 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 107652.51 ≤ Q = 107652.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 107652.51 ≤ Q = 107652.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 107652.51 ≤ Q = 107652.51 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 107652.51 ≤ Q = 107652.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 107652.51 ≤ Q = 107652.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 107652.51 ≤ Q = 107652.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 107652.51 ≤ Q = 107652.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 107652.51 ≤ Q = 107652.51 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 107652.51 ≤ Q = 107652.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 107652.51 ≤ Q = 107652.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 107652.51 ≤ Q = 107652.51 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 107652.51 ≤ Q = 107652.51 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 107652.51 ≤ Q = 107652.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 107652.51 ≤ Q = 107652.51 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 107652.51 ≤ Q = 107652.51 (slack: 0.00)
  [DEBUG]   ✓ Scenario 18: θ = 107652.51 ≤ Q = 107652.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 107652.51 ≤ Q = 107652.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 20: θ = 107652.51 ≤ Q = 107652.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 21: θ = 107652.51 ≤ Q = 107652.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 22: θ = 107652.51 ≤ Q = 107652.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 23: θ = 107652.51 ≤ Q = 107652.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 24: θ = 107652.51 ≤ Q = 107652.51 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 25] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x71956809
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x71956809
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.193638e+13
Presolve removed 2614 rows and 1905 columns
Presolve time: 0.00s
Presolved: 479 rows, 484 columns, 1352 nonzeros
Found heuristic solution: objective 5963355.4625
Variable types: 326 continuous, 158 integer (158 binary)
Found heuristic solution: objective 5963075.3709

Root relaxation: objective -1.222117e+05, 231 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -122211.69    0  120 5963075.37 -122211.69   102%     -    0s
H    0     0                    -80261.50383 -122211.69  52.3%     -    0s
H    0     0                    -80541.59537 -122211.69  51.7%     -    0s
H    0     0                    -80575.50638 -122064.02  51.5%     -    0s
H    0     0                    -80632.21660 -97684.717  21.1%     -    0s
     0     0 -97684.717    0   44 -80632.217 -97684.717  21.1%     -    0s
H    0     0                    -96149.95564 -97655.202  1.57%     -    0s
     0     0 -97413.218    0   33 -96149.956 -97413.218  1.31%     -    0s
     0     0 -97217.631    0   23 -96149.956 -97217.631  1.11%     -    0s
     0     0 -97217.555    0   23 -96149.956 -97217.555  1.11%     -    0s
H    0     0                    -96665.90842 -97217.555  0.57%     -    0s
H    0     0                    -96675.53799 -97217.555  0.56%     -    0s
     0     0 -96892.466    0   22 -96675.538 -96892.466  0.22%     -    0s
     0     0 -96890.518    0   20 -96675.538 -96890.518  0.22%     -    0s
     0     0 -96875.994    0   19 -96675.538 -96875.994  0.21%     -    0s
     0     0 -96847.367    0   14 -96675.538 -96847.367  0.18%     -    0s
     0     0 -96710.422    0    4 -96675.538 -96710.422  0.04%     -    0s
     0     0 -96710.162    0    3 -96675.538 -96710.162  0.04%     -    0s
H    0     0                    -96685.71457 -96707.962  0.02%     -    0s
     0     0 -96702.839    0    2 -96685.715 -96702.839  0.02%     -    0s
     0     0          -    0      -96685.715 -96691.987  0.01%     -    0s

Cutting planes:
  Gomory: 2
  Implied bound: 1
  MIR: 132
  Flow cover: 8
  RLT: 20

Explored 1 nodes (521 simplex iterations) in 0.03 seconds (0.03 work units)
Thread count was 32 (of 256 available processors)

Solution count 9: -96685.7 -96675.5 -80632.2 ... 1.19364e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -9.668571457251e+04, best bound -9.669198734673e+04, gap 0.0065%
  Subproblem solved in 0.04s
  Worst-case operational profit (Z_SP) = 103638.64
  Scenario: 19 demand increases, 41 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -96685.71
  [DEBUG]   S×d_nominal = 200324.35
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 200324.35 + -96685.71 = 103638.64
  [DEBUG]   Current θ from Master = 107652.51
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4013.87 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -11810.47
  Lower Bound (LB) = -7110.37
  Gap (UB-LB) = -686.2284, Absolute Gap = 686.2284, Relative Gap = -0.088016
  ⚠️  WARNING: NEGATIVE GAP detected!
  UB = -7796.59, LB = -7110.37, Gap = -686.23
  Possible causes:
    1. Subproblem returned suboptimal Z_SP (too large → LB over-estimated)
    2. Master Problem returned suboptimal θ (too small → UB under-estimated)
    3. Numerical precision issues in bound calculations
  Algorithm will continue to search for better solutions...

  [DEBUG] Adding NEW scenario 25 to Master Problem...
  [DEBUG] New scenario pattern: 19 increases, 41 decreases
    [DEBUG] Scenario 25 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 25 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 25]
    [DEBUG]   - Total constraints in model: 398923
    [DEBUG]   - Total variables in model: 164500
  [DEBUG] Total scenarios in Master: 26
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 26
================================================================================
[Iteration 26] Solving Master Problem...
  Current scenarios in Master: 26
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 398923 rows, 164500 columns and 1129525 nonzeros
Model fingerprint: 0x965439a0
Variable types: 162241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [9e-02, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 184360 rows and 74890 columns
Presolve time: 3.57s
Presolved: 214563 rows, 89610 columns, 1322683 nonzeros
Variable types: 87351 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -371500.8959
Found heuristic solution: objective -172304.4497

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.74s

Barrier statistics:
 Dense cols : 1155
 AA' NZ     : 6.112e+06
 Factor NZ  : 1.693e+07 (roughly 260 MB of memory)
 Factor Ops : 6.210e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.68226224e+07  3.10603928e+08  8.76e+04 1.97e+01  6.36e+04     7s
   1  -1.26640377e+07  2.68342644e+08  6.08e+04 3.77e+01  4.39e+04     8s
   2  -5.15305168e+06  2.16488226e+08  2.35e+04 2.16e+01  1.75e+04     8s
   3  -6.67643133e+05  1.59178608e+08  7.03e+02 2.19e+00  9.09e+02     8s
   4  -5.55682641e+05  9.21119146e+07  2.91e+02 1.15e+00  4.27e+02     8s
   5  -4.82228306e+05  7.68287103e+07  1.17e+02 9.27e-01  2.72e+02     8s
   6  -4.49345094e+05  5.54312726e+07  5.51e+01 6.35e-01  1.74e+02     8s
   7  -4.15954681e+05  3.89543525e+07  2.58e+01 4.28e-01  1.13e+02     8s
   8  -3.45279127e+05  3.24039804e+07  6.48e+00 3.51e-01  8.67e+01     8s
   9  -2.11405521e+05  1.14269611e+07  1.64e+00 1.19e-01  3.01e+01     8s
  10  -1.59059667e+05  3.98791484e+06  8.34e-01 4.06e-02  1.07e+01     8s
  11  -1.34872550e+05  3.62662159e+06  6.42e-01 3.68e-02  9.68e+00     8s
  12  -1.20737030e+05  2.82309445e+06  5.08e-01 2.87e-02  7.57e+00     8s
  13  -1.09115481e+05  2.36999973e+06  4.13e-01 2.40e-02  6.37e+00     8s
  14  -8.68632013e+04  1.97434507e+06  2.58e-01 2.01e-02  5.29e+00     8s
  15  -6.73591821e+04  1.14829122e+06  1.35e-01 1.22e-02  3.12e+00     9s
  16  -3.81499741e+04  3.04539260e+05  5.13e-02 3.05e-03  8.79e-01     9s
  17  -2.09591278e+04  1.71338971e+05  2.54e-02 2.04e-03  4.93e-01     9s
  18  -1.68833872e+04  1.34359429e+05  2.14e-02 1.93e-03  3.88e-01     9s
  19  -1.24887291e+04  1.02011149e+05  1.75e-02 1.72e-03  2.94e-01     9s
  20  -9.24936520e+03  8.61607578e+04  1.49e-02 1.41e-03  2.45e-01     9s
  21  -4.37735980e+03  6.17842461e+04  1.12e-02 9.81e-04  1.70e-01     9s
  22  -1.66435882e+03  5.00028800e+04  9.29e-03 7.43e-04  1.32e-01     9s
  23  -7.78526368e+02  4.63599948e+04  8.69e-03 6.68e-04  1.21e-01     9s
  24   1.94123553e+03  4.10017355e+04  6.92e-03 5.61e-04  1.00e-01     9s
  25   3.46140798e+03  3.39455556e+04  5.95e-03 4.25e-04  7.82e-02     9s
  26   5.13984734e+03  2.85534895e+04  4.94e-03 3.13e-04  6.00e-02    10s
  27   6.55312501e+03  2.62084945e+04  4.15e-03 2.61e-04  5.04e-02    10s
  28   7.22566503e+03  2.32148929e+04  3.78e-03 1.97e-04  4.10e-02    10s
  29   8.72054049e+03  2.16646760e+04  3.01e-03 1.59e-04  3.32e-02    10s
  30   1.00134738e+04  1.97435636e+04  2.36e-03 1.75e-04  2.49e-02    10s
  31   1.11964138e+04  1.88068254e+04  1.79e-03 1.38e-04  1.95e-02    10s
  32   1.19366031e+04  1.79835284e+04  1.41e-03 1.09e-04  1.55e-02    10s
  33   1.25534655e+04  1.68641490e+04  1.11e-03 2.00e-04  1.11e-02    10s
  34   1.29376261e+04  1.66222238e+04  9.27e-04 1.73e-04  9.45e-03    10s
  35   1.33138781e+04  1.60898918e+04  7.44e-04 1.12e-04  7.12e-03    10s
  36   1.36179994e+04  1.57222521e+04  6.04e-04 7.21e-05  5.40e-03    11s
  37   1.39914030e+04  1.55122923e+04  4.35e-04 5.02e-05  3.90e-03    11s
  38   1.42406094e+04  1.54111226e+04  3.27e-04 3.95e-05  3.00e-03    11s
  39   1.44597570e+04  1.52944651e+04  2.37e-04 2.71e-05  2.14e-03    11s
  40   1.46214676e+04  1.51540408e+04  1.70e-04 1.25e-05  1.37e-03    11s
  41   1.47544773e+04  1.51123962e+04  1.11e-04 8.51e-06  9.18e-04    11s
  42   1.49084395e+04  1.50789565e+04  4.49e-05 5.39e-06  4.37e-04    11s
  43   1.49168019e+04  1.50708878e+04  4.14e-05 4.64e-06  3.95e-04    11s
  44   1.49559341e+04  1.50570371e+04  2.52e-05 3.30e-06  2.59e-04    11s
  45   1.50033418e+04  1.50312403e+04  5.97e-06 8.95e-07  7.15e-05    11s
  46   1.50170420e+04  1.50224192e+04  1.21e-06 1.15e-07  1.38e-05    12s
  47   1.50207629e+04  1.50209664e+04  3.92e-08 1.35e-07  5.23e-07    12s
  48   1.50209286e+04  1.50209289e+04  2.10e-09 8.61e-11  7.27e-10    12s
  49   1.50209289e+04  1.50209289e+04  7.90e-08 2.77e-08  6.77e-12    12s

Barrier solved model in 49 iterations and 11.79 seconds (22.39 work units)
Optimal objective 1.50209289e+04


Root crossover log...

  174989 DPushes remaining with DInf 0.0000000e+00                12s
   70003 DPushes remaining with DInf 0.0000000e+00                15s
   29099 DPushes remaining with DInf 0.0000000e+00                20s
    2535 DPushes remaining with DInf 0.0000000e+00                25s
       0 DPushes remaining with DInf 0.0000000e+00                27s

    5626 PPushes remaining with PInf 3.4252350e-06                27s
       0 PPushes remaining with PInf 0.0000000e+00                27s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.2826777e-10     27s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   75564    1.5020929e+04   0.000000e+00   0.000000e+00     27s
   75564    1.5020929e+04   0.000000e+00   0.000000e+00     27s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 1.502093e+04, 75564 iterations, 22.56 seconds (38.15 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 15020.9289    0  369 -172304.45 15020.9289   109%     -   28s
H    0     0                    -170084.3471 15020.9289   109%     -   28s
H    0     0                    -138273.2237 15020.9289   111%     -   29s
H    0     0                    -135760.9116 15020.9289   111%     -   29s
H    0     0                    -135331.8071 15020.9289   111%     -   29s
H    0     0                    -87933.70112 15020.9289   117%     -   29s
H    0     0                    -87869.70790 15020.9289   117%     -   34s
H    0     0                    -44444.43072 15020.9289   134%     -   34s
     0     0 8395.15714    0  390 -44444.431 8395.15714   119%     -  137s
H    0     0                    -40824.81943 8394.09254   121%     -  139s
H    0     0                    -39159.33268 8394.09254   121%     -  139s
H    0     0                    -37817.48670 8394.09254   122%     -  139s
     0     0 8087.56734    0  386 -37817.487 8087.56734   121%     -  165s
     0     0 8066.13152    0  391 -37817.487 8066.13152   121%     -  175s
     0     0 8063.66793    0  391 -37817.487 8063.66793   121%     -  178s
     0     0 8063.33456    0  391 -37817.487 8063.33456   121%     -  180s
     0     0 6260.38049    0  360 -37817.487 6260.38049   117%     -  263s
H    0     0                    -29180.20286 6259.99696   121%     -  264s
H    0     0                    -29149.88582 6259.99696   121%     -  264s
     0     0 6023.41330    0  371 -29149.886 6023.41330   121%     -  305s
     0     0 5572.75348    0  385 -29149.886 5572.75348   119%     -  351s
     0     0 5524.83602    0  374 -29149.886 5524.83602   119%     -  371s
     0     0 5519.76625    0  374 -29149.886 5519.76625   119%     -  380s
     0     0 5495.36499    0  379 -29149.886 5495.36499   119%     -  388s
     0     0 5457.49164    0  381 -29149.886 5457.49164   119%     -  399s
     0     0 5455.45883    0  376 -29149.886 5455.45883   119%     -  404s
     0     0 5453.63940    0  374 -29149.886 5453.63940   119%     -  408s
     0     0 5447.92334    0  388 -29149.886 5447.92334   119%     -  419s
     0     0 5441.38157    0  385 -29149.886 5441.38157   119%     -  423s
     0     0 5440.67521    0  382 -29149.886 5440.67521   119%     -  426s
     0     0 4294.70849    0  380 -29149.886 4294.70849   115%     -  507s
H    0     0                    -28502.31168 4294.56104   115%     -  508s
     0     0 4035.50626    0  539 -28502.312 4035.50626   114%     -  551s
     0     0 3793.33307    0  489 -28502.312 3793.33307   113%     -  594s
     0     0 3740.49345    0  618 -28502.312 3740.49345   113%     -  620s
     0     0 3730.02800    0  627 -28502.312 3730.02800   113%     -  637s
     0     0 3727.10840    0  626 -28502.312 3727.10840   113%     -  644s
     0     0 3685.80718    0  637 -28502.312 3685.80718   113%     -  660s
     0     0 3678.13523    0  643 -28502.312 3678.13523   113%     -  672s
     0     0 3676.83328    0  640 -28502.312 3676.83328   113%     -  676s
     0     0 3256.80006    0  494 -28502.312 3256.80006   111%     -  736s
H    0     0                    -28397.58122 3256.76946   111%     -  737s
     0     0 3112.13539    0  504 -28397.581 3112.13539   111%     -  780s
     0     0 3077.60978    0  503 -28397.581 3077.60978   111%     -  804s
     0     0 3055.22677    0  497 -28397.581 3055.22677   111%     -  820s
     0     0 3043.70003    0  511 -28397.581 3043.70003   111%     -  831s
     0     0 3032.84189    0  506 -28397.581 3032.84189   111%     -  841s
     0     0 3030.56615    0  510 -28397.581 3030.56615   111%     -  847s
     0     0 3019.05013    0  504 -28397.581 3019.05013   111%     -  856s
     0     0 3014.48237    0  515 -28397.581 3014.48237   111%     -  868s
     0     0 3013.79925    0  518 -28397.581 3013.79925   111%     -  871s
     0     0 2836.82468    0  512 -28397.581 2836.82468   110%     -  914s
H    0     0                    -28305.61360 2836.57178   110%     -  915s
     0     0 2763.71791    0  593 -28305.614 2763.71791   110%     -  949s
     0     0 2735.88318    0  523 -28305.614 2735.88318   110%     -  975s
     0     0 2728.81161    0  527 -28305.614 2728.81161   110%     -  982s
     0     0 2620.83141    0  512 -28305.614 2620.83141   109%     - 1002s
     0     0 2609.26594    0  524 -28305.614 2609.26594   109%     - 1013s
     0     0 2592.22024    0  532 -28305.614 2592.22024   109%     - 1029s
     0     0 2588.96651    0  531 -28305.614 2588.96651   109%     - 1037s
     0     0 2586.82342    0  535 -28305.614 2586.82342   109%     - 1044s
     0     0 2570.56056    0  538 -28305.614 2570.56056   109%     - 1058s
     0     0 2565.54912    0  534 -28305.614 2565.54912   109%     - 1062s
     0     0 2562.69177    0  531 -28305.614 2562.69177   109%     - 1065s
     0     0 2562.37136    0  537 -28305.614 2562.37136   109%     - 1068s
     0     0 2442.82785    0  600 -28305.614 2442.82785   109%     - 1102s
H    0     0                    -13901.27070 2442.17792   118%     - 1119s
H    0     0                    -10565.25429 2442.17792   123%     - 1119s
H    0     0                    -10329.25826 2442.17792   124%     - 1119s
H    0     0                    -10052.69771 2442.17792   124%     - 1120s
H    0     0                    -10021.21658 2442.17792   124%     - 1123s
H    0     0                    -9331.985860 2442.17792   126%     - 1127s
H    0     0                    -9300.504734 2442.17792   126%     - 1128s
H    0     0                    -9265.382170 2442.17792   126%     - 1128s
H    0     0                    -9169.542243 2442.17792   127%     - 1128s
     0     0 2419.91659    0  601 -9169.5422 2419.91659   126%     - 1150s
     0     0 2402.69902    0  585 -9169.5422 2402.69902   126%     - 1167s
     0     0 2379.81973    0  583 -9169.5422 2379.81973   126%     - 1177s
     0     0 2376.39506    0  587 -9169.5422 2376.39506   126%     - 1182s
     0     0 2373.63970    0  593 -9169.5422 2373.63970   126%     - 1185s
     0     0 2368.80438    0  587 -9169.5422 2368.80438   126%     - 1189s
     0     0 2364.73065    0  586 -9169.5422 2364.73065   126%     - 1196s
     0     0 2355.12645    0  596 -9169.5422 2355.12645   126%     - 1207s
     0     0 2354.18008    0  598 -9169.5422 2354.18008   126%     - 1213s
     0     0 2301.58704    0  529 -9169.5422 2301.58704   125%     - 1241s
     0     0 2270.99989    0  528 -9169.5422 2270.99989   125%     - 1257s
     0     0 2268.83635    0  528 -9169.5422 2268.83635   125%     - 1263s
     0     0 2263.70870    0  525 -9169.5422 2263.70870   125%     - 1270s
     0     0 2259.39887    0  531 -9169.5422 2259.39887   125%     - 1274s
     0     0 2258.13891    0  526 -9169.5422 2258.13891   125%     - 1276s
     0     0 2194.61655    0  538 -9169.5422 2194.61655   124%     - 1300s
     0     0 2136.64085    0  542 -9169.5422 2136.64085   123%     - 1323s
     0     0 2125.42575    0  545 -9169.5422 2125.42575   123%     - 1332s
     0     0 2104.92756    0  539 -9169.5422 2104.92756   123%     - 1346s
     0     0 2098.12813    0  535 -9169.5422 2098.12813   123%     - 1354s
     0     0 2095.31669    0  535 -9169.5422 2095.31669   123%     - 1358s
     0     0 2093.11457    0  539 -9169.5422 2093.11457   123%     - 1369s
     0     0 2083.74914    0  536 -9169.5422 2083.74914   123%     - 1378s
     0     0 2082.07556    0  546 -9169.5422 2082.07556   123%     - 1382s
     0     0 2002.50525    0  603 -9169.5422 2002.50525   122%     - 1408s
     0     0 1986.77554    0  622 -9169.5422 1986.77554   122%     - 1422s
     0     0 1981.20230    0  632 -9169.5422 1981.20230   122%     - 1430s
     0     0 1977.53408    0  634 -9169.5422 1977.53408   122%     - 1436s
     0     0 1976.25911    0  633 -9169.5422 1976.25911   122%     - 1441s
     0     0 1946.47012    0  706 -9169.5422 1946.47012   121%     - 1460s
H    0     0                    -9084.553351 1946.01680   121%     - 1467s
H    0     0                    -8887.340833 1946.01680   122%     - 1467s
H    0     0                    -8852.218269 1946.01680   122%     - 1468s
H    0     0                    -8820.737143 1946.01680   122%     - 1468s
H    0     0                    -8806.309242 1946.01680   122%     - 1469s
     0     0 1938.58035    0  574 -8806.3092 1938.58035   122%     - 1479s
     0     0 1932.97049    0  572 -8806.3092 1932.97049   122%     - 1487s
     0     0 1928.50630    0  565 -8806.3092 1928.50630   122%     - 1494s
     0     0 1926.30661    0  571 -8806.3092 1926.30661   122%     - 1502s
     0     0 1925.99075    0  573 -8806.3092 1925.99075   122%     - 1504s
     0     0 1894.11123    0  559 -8806.3092 1894.11123   122%     - 1523s
     0     0 1888.05600    0  569 -8806.3092 1888.05600   121%     - 1532s
     0     0 1886.04902    0  569 -8806.3092 1886.04902   121%     - 1535s
     0     0 1885.11257    0  575 -8806.3092 1885.11257   121%     - 1539s
     0     0 1837.65207    0  626 -8806.3092 1837.65207   121%     - 1565s
H    0     0                    -8555.952561 1837.24611   121%     - 1595s
H    0     0                    -7999.930732 1837.24611   123%     - 1600s
H    0     0                    -7984.447822 1837.24611   123%     - 1602s
H    0     0                    -7908.601387 1837.24611   123%     - 1602s
H    0     0                    -7882.820501 1837.24611   123%     - 1602s
H    0     0                    -7881.987959 1837.24611   123%     - 1602s
H    0     0                    -7874.607613 1837.24611   123%     - 1602s
H    0     0                    -7867.261685 1837.24611   123%     - 1608s
H    0     0                    -7824.550062 1837.24611   123%     - 1608s
     0     0 1819.08223    0  632 -7824.5501 1819.08223   123%     - 1619s
     0     0 1806.97660    0  642 -7824.5501 1806.97660   123%     - 1628s
     0     0 1803.82859    0  572 -7824.5501 1803.82859   123%     - 1633s
     0     0 1801.90166    0  583 -7824.5501 1801.90166   123%     - 1638s
     0     0 1801.42387    0  577 -7824.5501 1801.42387   123%     - 1641s
     0     0 1786.49555    0  715 -7824.5501 1786.49555   123%     - 1662s
     0     0 1780.84671    0  650 -7824.5501 1780.84671   123%     - 1672s
     0     0 1779.65551    0  736 -7824.5501 1779.65551   123%     - 1676s
     0     0 1764.94747    0  582 -7824.5501 1764.94747   123%     - 1693s
     0     0 1759.13373    0  659 -7824.5501 1759.13373   122%     - 1700s
     0     0 1757.11495    0  597 -7824.5501 1757.11495   122%     - 1703s
     0     0 1756.52364    0  594 -7824.5501 1756.52364   122%     - 1706s
     0     0 1745.27516    0  671 -7824.5501 1745.27516   122%     - 1720s
     0     0 1743.06507    0  654 -7824.5501 1743.06507   122%     - 1729s
     0     0 1742.27372    0  656 -7824.5501 1742.27372   122%     - 1734s
     0     0 1737.96884    0  585 -7824.5501 1737.96884   122%     - 1745s
     0     0 1735.31597    0  588 -7824.5501 1735.31597   122%     - 1754s
     0     0 1732.85345    0  586 -7824.5501 1732.85345   122%     - 1761s
     0     0 1731.81685    0  589 -7824.5501 1731.81685   122%     - 1765s
     0     0 1728.36616    0  648 -7824.5501 1728.36616   122%     - 1774s
     0     0 1727.29472    0  663 -7824.5501 1727.29472   122%     - 1783s
     0     0 1726.19131    0  660 -7824.5501 1726.19131   122%     - 1792s
     0     0 1723.77934    0  657 -7824.5501 1723.77934   122%     - 1794s
     0     0 1723.77934    0  657 -7824.5501 1723.77934   122%     - 1804s
     0     0 1723.77934    0  657 -7824.5501 1723.77934   122%     - 1825s
H    0     0                    -7817.204134 1723.57242   122%     - 2160s
     0     2 1723.57242    0  657 -7817.2041 1723.57242   122%     - 2204s
     1     3 1550.57770    1  468 -7817.2041 1723.57242   122% 23910 2231s
     2     4 1706.52539    1  774 -7817.2041 1706.52539   122% 13486 2248s
     3     7 1326.13271    2  553 -7817.2041 1706.20847   122% 12422 2273s
     6    13 1140.22020    3  556 -7817.2041 1706.20847   122% 13461 2323s
    12    26  933.00590    3  476 -7817.2041 1626.94501   121% 20294 2361s
    25    37 -1801.2158    4  334 -7817.2041 1281.30560   116% 26891 2470s
    38    53 -1213.5312    5  512 -7817.2041 1281.30560   116% 29439 2793s
H   39    53                    -7565.799508 1281.30560   117% 28684 2793s
    66   145  535.45839    6  537 -7565.7995 1281.30560   117% 32688 2912s
   166   209  440.20303    9  531 -7565.7995 1281.30560   117% 20082 2963s
H  173   209                    -7428.655885 1281.30560   117% 19724 2963s
   234   270 -6885.1183    9  158 -7428.6559 1281.30560   117% 17357 3008s
   316   311  160.06542   10  441 -7428.6559 1281.30560   117% 15069 3050s
   383   355   48.65414    9  407 -7428.6559 1281.30560   117% 14231 3090s
   449   364  105.43219   11  437 -7428.6559 1281.30560   117% 13644 3126s
   483   384 -4994.0430   12  160 -7428.6559 1281.30560   117% 13523 3168s
   507   409     cutoff   10      -7428.6559 1281.30560   117% 13574 3199s
   542   426 infeasible   11      -7428.6559 1281.30560   117% 13662 3227s
   575   451 -6593.4630   15  167 -7428.6559 1281.30560   117% 13561 3260s
H  579   451                    -7421.017495 1281.30560   117% 13483 3260s
   616   529 -7077.4117   19  156 -7421.0175 1281.30560   117% 13302 3293s
   723   579 -3120.9899   10  192 -7421.0175 1281.30560   117% 12351 3318s
   809   619 -3474.7624   11  287 -7421.0175 1281.30560   117% 11799 3349s
   885   631 -3486.7311   13  358 -7421.0175 1281.30560   117% 11520 3399s
   924   657 -3512.1300   14  282 -7421.0175 1281.30560   117% 11486 3470s
H  951   657                    -7411.755680 1281.30560   117% 11496 3470s
   966   735 -3525.6845   15  362 -7411.7557 1281.30560   117% 11386 3501s
  1086   822 -3833.3987   19  169 -7411.7557 1281.30560   117% 10832 3530s
  1215   906 -4259.6880   24  161 -7411.7557 1281.30560   117% 10283 3563s
  1342   952 -4509.7669   26  303 -7411.7557 1281.30560   117%  9962 3594s
  1417   964 -4512.0389   27  299 -7411.7557 1281.30560   117%  9765 3600s

Cutting planes:
  Implied bound: 356
  MIR: 4906
  Flow cover: 4344
  Zero half: 5
  RLT: 67
  Relax-and-lift: 705

Explored 1439 nodes (15118605 simplex iterations) in 3600.08 seconds (7317.56 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -7411.76 -7421.02 -7428.66 ... -7882.82

Time limit reached
Best objective -7.411755679585e+03, best bound 1.281305603011e+03, gap 117.2875%
  WARNING: Time limit reached. Using best solution found (gap: 117.29%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3600.10s
  Master Objective (UB) = -7411.76, θ = 109451.57
  Upper Bound (UB) = -7411.76

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 109451.57
  [DEBUG]   ✓ Scenario 0: θ = 109451.57 ≤ Q = 109451.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 109451.57 ≤ Q = 109451.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 109451.57 ≤ Q = 109451.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 109451.57 ≤ Q = 109451.57 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 109451.57 ≤ Q = 109451.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 109451.57 ≤ Q = 109451.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 109451.57 ≤ Q = 109451.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 109451.57 ≤ Q = 109451.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 109451.57 ≤ Q = 109451.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 109451.57 ≤ Q = 109451.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 109451.57 ≤ Q = 109451.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 109451.57 ≤ Q = 109451.57 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 109451.57 ≤ Q = 109451.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 109451.57 ≤ Q = 109451.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 109451.57 ≤ Q = 109451.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 109451.57 ≤ Q = 109451.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 109451.57 ≤ Q = 109451.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 109451.57 ≤ Q = 109451.57 (slack: 0.00)
  [DEBUG]   ✓ Scenario 18: θ = 109451.57 ≤ Q = 109451.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 109451.57 ≤ Q = 109451.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 20: θ = 109451.57 ≤ Q = 109451.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 21: θ = 109451.57 ≤ Q = 109451.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 22: θ = 109451.57 ≤ Q = 109451.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 23: θ = 109451.57 ≤ Q = 109451.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 24: θ = 109451.57 ≤ Q = 109451.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 25: θ = 109451.57 ≤ Q = 109451.57 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 26] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x66261c44
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x99d9e3bc
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.306224e+13
Presolve removed 2608 rows and 1900 columns
Presolve time: 0.01s
Presolved: 485 rows, 489 columns, 1368 nonzeros
Found heuristic solution: objective 6482794.5617
Variable types: 330 continuous, 159 integer (159 binary)

Root relaxation: objective -1.305703e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -130570.33    0  126 6482794.56 -130570.33   102%     -    0s
H    0     0                    -90099.05608 -130570.33  44.9%     -    0s
H    0     0                    -99744.08897 -111944.10  12.2%     -    0s
H    0     0                    -105978.4774 -111944.10  5.63%     -    0s
     0     0 -111944.10    0   47 -105978.48 -111944.10  5.63%     -    0s
H    0     0                    -110150.9932 -111842.64  1.54%     -    0s
     0     0 -111341.67    0   48 -110150.99 -111341.67  1.08%     -    0s
     0     0 -111058.82    0   18 -110150.99 -111058.82  0.82%     -    0s
H    0     0                    -110586.7242 -111052.82  0.42%     -    0s
H    0     0                    -110617.2116 -110802.56  0.17%     -    0s
     0     0 -110802.56    0   12 -110617.21 -110802.56  0.17%     -    0s
     0     0 -110786.32    0   13 -110617.21 -110786.32  0.15%     -    0s
     0     0 -110785.09    0   14 -110617.21 -110785.09  0.15%     -    0s
     0     0 -110773.27    0   11 -110617.21 -110773.27  0.14%     -    0s
     0     0 -110773.27    0   15 -110617.21 -110773.27  0.14%     -    0s
H    0     0                    -110658.9487 -110773.27  0.10%     -    0s
     0     0 -110752.81    0    5 -110658.95 -110752.81  0.08%     -    0s
H    0     0                    -110705.1791 -110749.11  0.04%     -    0s
H    0     0                    -110717.3728 -110744.92  0.02%     -    0s
     0     0 -110744.92    0    3 -110717.37 -110744.92  0.02%     -    0s
     0     0 -110743.41    0    4 -110717.37 -110743.41  0.02%     -    0s
H    0     0                    -110739.9826 -110743.41  0.00%     -    0s

Cutting planes:
  Gomory: 7
  Implied bound: 3
  MIR: 9
  Flow cover: 3
  RLT: 2
  Relax-and-lift: 2

Explored 1 nodes (678 simplex iterations) in 0.08 seconds (0.04 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -110740 -110717 -110705 ... -90099.1
No other solutions better than -110740

Optimal solution found (tolerance 1.00e-04)
Best objective -1.107399825761e+05, best bound -1.107399825761e+05, gap 0.0000%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 96957.35
  Scenario: 22 demand increases, 38 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -110739.98
  [DEBUG]   S×d_nominal = 207697.34
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 207697.34 + -110739.98 = 96957.35
  [DEBUG]   Current θ from Master = 109451.57
  [DEBUG]   ⚠️  Z_SP ≤ θ by 12494.22 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -19905.98
  Lower Bound (LB) = -7110.37
  Gap (UB-LB) = -301.3898, Absolute Gap = 301.3898, Relative Gap = -0.040664
  ⚠️  WARNING: NEGATIVE GAP detected!
  UB = -7411.76, LB = -7110.37, Gap = -301.39
  Possible causes:
    1. Subproblem returned suboptimal Z_SP (too large → LB over-estimated)
    2. Master Problem returned suboptimal θ (too small → UB under-estimated)
    3. Numerical precision issues in bound calculations
  Algorithm will continue to search for better solutions...

  [DEBUG] Adding NEW scenario 26 to Master Problem...
  [DEBUG] New scenario pattern: 22 increases, 38 decreases
    [DEBUG] Scenario 26 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 26 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 26]
    [DEBUG]   - Total constraints in model: 414213
    [DEBUG]   - Total variables in model: 170740
  [DEBUG] Total scenarios in Master: 27
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 27
================================================================================
[Iteration 27] Solving Master Problem...
  Current scenarios in Master: 27
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 414213 rows, 170740 columns and 1172756 nonzeros
Model fingerprint: 0x611f6f4d
Variable types: 168481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [9e-02, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 191470 rows and 77780 columns
Presolve time: 4.36s
Presolved: 222743 rows, 92960 columns, 1372983 nonzeros
Variable types: 90701 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -371500.8959
Found heuristic solution: objective -172304.4497

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.95s

Barrier statistics:
 Dense cols : 1153
 AA' NZ     : 6.537e+06
 Factor NZ  : 1.822e+07 (roughly 300 MB of memory)
 Factor Ops : 6.951e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.68297461e+07  3.20328744e+08  8.76e+04 1.97e+01  6.33e+04     9s
   1  -1.26625962e+07  2.76562813e+08  6.08e+04 3.75e+01  4.37e+04     9s
   2  -5.24448822e+06  2.24411498e+08  2.39e+04 2.12e+01  1.77e+04     9s
   3  -6.67564988e+05  1.65360980e+08  6.98e+02 1.92e+00  9.04e+02     9s
   4  -5.58017826e+05  9.51274703e+07  2.93e+02 9.92e-01  4.26e+02     9s
   5  -4.84417742e+05  7.79118156e+07  1.19e+02 7.84e-01  2.67e+02     9s
   6  -4.49444963e+05  5.78872283e+07  5.29e+01 5.56e-01  1.74e+02     9s
   7  -4.19907947e+05  4.18909228e+07  2.74e+01 3.89e-01  1.18e+02     9s
   8  -3.52129268e+05  3.41355141e+07  6.33e+00 3.12e-01  8.78e+01     9s
   9  -2.59931326e+05  1.15256199e+07  1.95e+00 1.01e-01  2.94e+01     9s
  10  -1.62258463e+05  4.75372731e+06  8.59e-01 4.02e-02  1.22e+01     9s
  11  -1.33753248e+05  4.08155519e+06  6.14e-01 3.43e-02  1.05e+01     9s
  12  -1.14252385e+05  3.32791385e+06  4.16e-01 2.78e-02  8.52e+00     9s
  13  -1.01057921e+05  2.32305676e+06  3.11e-01 1.95e-02  6.00e+00    10s
  14  -8.99387444e+04  1.92161592e+06  2.44e-01 1.64e-02  4.98e+00    10s
  15  -6.01042226e+04  1.46402134e+06  1.01e-01 1.30e-02  3.77e+00    10s
  16  -4.06047414e+04  4.11276052e+05  3.88e-02 3.50e-03  1.12e+00    10s
  17  -2.19895426e+04  2.12755673e+05  1.93e-02 1.74e-03  5.80e-01    10s
  18  -1.70187995e+04  1.58956487e+05  1.58e-02 1.48e-03  4.35e-01    10s
  19  -1.12709365e+04  1.14791290e+05  1.19e-02 1.04e-03  3.11e-01    10s
  20  -7.66243713e+03  8.68696681e+04  9.72e-03 7.64e-04  2.33e-01    10s
  21  -2.95090303e+03  5.80456233e+04  7.16e-03 4.95e-04  1.51e-01    10s
  22  -3.81962460e+02  5.20033496e+04  5.93e-03 4.26e-04  1.29e-01    10s
  23   4.84222891e+02  4.60535127e+04  5.52e-03 3.63e-04  1.13e-01    10s
  24   1.33281781e+03  4.17191347e+04  5.13e-03 3.16e-04  9.98e-02    11s
  25   3.69562274e+03  3.73327484e+04  4.05e-03 2.66e-04  8.31e-02    11s
  26   5.35731525e+03  3.05487418e+04  3.32e-03 1.97e-04  6.22e-02    11s
  27   7.13558603e+03  2.84955376e+04  2.62e-03 1.71e-04  5.28e-02    11s
  28   7.75054578e+03  2.57425456e+04  2.39e-03 1.34e-04  4.44e-02    11s
  29   9.20942194e+03  2.39200140e+04  1.87e-03 1.11e-04  3.63e-02    11s
  30   1.03339002e+04  2.03572334e+04  1.48e-03 6.83e-05  2.48e-02    11s
  31   1.13232098e+04  1.89044742e+04  1.15e-03 4.94e-05  1.87e-02    11s
  32   1.16842955e+04  1.80626881e+04  1.03e-03 3.90e-05  1.58e-02    11s
  33   1.22893457e+04  1.75524101e+04  8.46e-04 3.21e-05  1.30e-02    12s
  34   1.24080221e+04  1.69781210e+04  8.04e-04 2.49e-05  1.13e-02    12s
  35   1.30037890e+04  1.65515361e+04  6.13e-04 1.93e-05  8.76e-03    12s
  36   1.34950506e+04  1.58594518e+04  4.51e-04 1.02e-05  5.84e-03    12s
  37   1.38603893e+04  1.56285706e+04  3.42e-04 7.35e-06  4.37e-03    12s
  38   1.39250490e+04  1.55398222e+04  3.22e-04 6.28e-06  3.99e-03    12s
  39   1.41733921e+04  1.54688303e+04  2.46e-04 5.47e-06  3.20e-03    12s
  40   1.43532296e+04  1.53974161e+04  1.91e-04 4.59e-06  2.58e-03    12s
  41   1.44531261e+04  1.53338933e+04  1.61e-04 3.86e-06  2.18e-03    13s
  42   1.45807282e+04  1.52748785e+04  1.23e-04 4.04e-06  1.71e-03    13s
  43   1.47129988e+04  1.51641706e+04  8.48e-05 4.53e-06  1.11e-03    13s
  44   1.47210237e+04  1.51218146e+04  8.26e-05 3.11e-06  9.90e-04    13s
  45   1.48403041e+04  1.50990023e+04  4.88e-05 2.36e-06  6.39e-04    13s
  46   1.48911916e+04  1.50571387e+04  3.51e-05 1.22e-06  4.10e-04    13s
  47   1.49453855e+04  1.50348338e+04  2.01e-05 9.11e-07  2.21e-04    13s
  48   1.49981648e+04  1.50233334e+04  5.39e-06 1.44e-06  6.22e-05    13s
  49   1.50147884e+04  1.50214204e+04  1.39e-06 1.88e-07  1.64e-05    13s
  50   1.50206258e+04  1.50209527e+04  6.48e-08 6.72e-08  8.08e-07    13s
  51   1.50209262e+04  1.50209289e+04  3.91e-08 6.42e-11  6.56e-09    14s
  52   1.50209288e+04  1.50209289e+04  5.88e-08 3.75e-08  1.36e-10    14s

Barrier solved model in 52 iterations and 13.66 seconds (24.07 work units)
Optimal objective 1.50209288e+04


Root crossover log...

  181629 DPushes remaining with DInf 0.0000000e+00                14s
   80226 DPushes remaining with DInf 0.0000000e+00                15s
   26834 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                23s

   10833 PPushes remaining with PInf 8.2824436e-05                23s
       0 PPushes remaining with PInf 0.0000000e+00                24s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.5630265e+02     24s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   91507    1.5020929e+04   0.000000e+00   1.563027e+02     24s
   91543    1.5020929e+04   0.000000e+00   0.000000e+00     24s
   91543    1.5020929e+04   0.000000e+00   0.000000e+00     24s
Concurrent spin time: 20.24s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 1.502093e+04, 91543 iterations, 38.55 seconds (53.35 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 15020.9289    0  369 -172304.45 15020.9289   109%     -   45s
H    0     0                    -88142.94548 15020.9289   117%     -   47s
H    0     0                    -88078.95226 15020.9289   117%     -   52s
H    0     0                    -44515.41536 15020.9289   134%     -   52s
H    0     0                    -44498.42945 15020.9289   134%     -   52s
     0     0 8511.61067    0  331 -44498.429 8511.61067   119%     -  114s
H    0     0                    -22553.91807 8504.44420   138%     -  115s
H    0     0                    -22333.10216 8504.44420   138%     -  116s
H    0     0                    -22128.83684 8504.44420   138%     -  116s
H    0     0                    -21067.39202 8504.44420   140%     -  116s
     0     0 8036.17920    0  383 -21067.392 8036.17920   138%     -  156s
     0     0 8019.24834    0  390 -21067.392 8019.24834   138%     -  167s
     0     0 8003.26498    0  396 -21067.392 8003.26498   138%     -  176s
     0     0 7986.87030    0  403 -21067.392 7986.87030   138%     -  185s
     0     0 7980.86614    0  406 -21067.392 7980.86614   138%     -  189s
     0     0 7974.05326    0  408 -21067.392 7974.05326   138%     -  194s
     0     0 7972.97739    0  412 -21067.392 7972.97739   138%     -  197s
     0     0 7972.91727    0  412 -21067.392 7972.91727   138%     -  199s
     0     0 6208.66881    0  380 -21067.392 6208.66881   129%     -  270s
H    0     0                    -14299.38940 6208.60497   143%     -  271s
H    0     0                    -13084.75694 6208.60497   147%     -  272s
H    0     0                    -12877.82386 6208.60497   148%     -  272s
     0     0 5876.15798    0  395 -12877.824 5876.15798   146%     -  313s
     0     0 5754.19024    0  378 -12877.824 5754.19024   145%     -  348s
     0     0 5728.99298    0  395 -12877.824 5728.99298   144%     -  363s
     0     0 5689.88169    0  398 -12877.824 5689.88169   144%     -  379s
     0     0 5608.02864    0  388 -12877.824 5608.02864   144%     -  393s
     0     0 5582.47727    0  393 -12877.824 5582.47727   143%     -  400s
     0     0 5580.56799    0  397 -12877.824 5580.56799   143%     -  405s
     0     0 5557.68541    0  399 -12877.824 5557.68541   143%     -  410s
     0     0 5556.11002    0  403 -12877.824 5556.11002   143%     -  413s
     0     0 5548.31984    0  402 -12877.824 5548.31984   143%     -  419s
     0     0 5545.21854    0  406 -12877.824 5545.21854   143%     -  423s
     0     0 5544.85500    0  402 -12877.824 5544.85500   143%     -  424s
     0     0 4625.43288    0  465 -12877.824 4625.43288   136%     -  508s
H    0     0                    -10865.13504 4625.38849   143%     -  509s
H    0     0                    -10862.76594 4625.38849   143%     -  510s
H    0     0                    -10264.16879 4625.38849   145%     -  510s
H    0     0                    -10237.73005 4625.38849   145%     -  510s
H    0     0                    -10211.99918 4625.38849   145%     -  510s
     0     0 4286.18796    0  487 -10211.999 4286.18796   142%     -  551s
     0     0 4080.56850    0  477 -10211.999 4080.56850   140%     -  592s
     0     0 4042.46775    0  479 -10211.999 4042.46775   140%     -  610s
     0     0 4002.92555    0  482 -10211.999 4002.92555   139%     -  629s
     0     0 4000.04484    0  482 -10211.999 4000.04484   139%     -  635s
     0     0 3996.06134    0  484 -10211.999 3996.06134   139%     -  638s
     0     0 3995.21151    0  485 -10211.999 3995.21151   139%     -  642s
     0     0 3409.67464    0  482 -10211.999 3409.67464   133%     -  725s
H    0     0                    -10201.46105 3409.36432   133%     -  726s
     0     0 3217.02992    0  483 -10201.461 3217.02992   132%     -  754s
     0     0 3085.92349    0  486 -10201.461 3085.92349   130%     -  770s
     0     0 3076.87316    0  494 -10201.461 3076.87316   130%     -  783s
     0     0 3060.37291    0  487 -10201.461 3060.37291   130%     -  801s
     0     0 3056.14419    0  490 -10201.461 3056.14419   130%     -  809s
     0     0 3043.26336    0  485 -10201.461 3043.26336   130%     -  818s
     0     0 3032.39249    0  499 -10201.461 3032.39249   130%     -  828s
     0     0 2958.43913    0  488 -10201.461 2958.43913   129%     -  855s
     0     0 2913.58001    0  483 -10201.461 2913.58001   129%     -  879s
     0     0 2902.78518    0  504 -10201.461 2902.78518   128%     -  893s
     0     0 2898.35338    0  501 -10201.461 2898.35338   128%     -  901s
     0     0 2896.41797    0  499 -10201.461 2896.41797   128%     -  910s
     0     0 2887.86088    0  499 -10201.461 2887.86088   128%     -  919s
     0     0 2886.71923    0  499 -10201.461 2886.71923   128%     -  923s
     0     0 2698.77618    0  570 -10201.461 2698.77618   126%     -  970s
H    0     0                    -10075.68246 2698.73025   127%     -  971s
H    0     0                    -9957.458593 2698.73025   127%     -  971s
H    0     0                    -9876.325828 2698.73025   127%     -  971s
     0     0 2671.19556    0  580 -9876.3258 2671.19556   127%     -  984s
     0     0 2599.53357    0  522 -9876.3258 2599.53357   126%     - 1007s
     0     0 2580.36806    0  524 -9876.3258 2580.36806   126%     - 1018s
     0     0 2573.67668    0  539 -9876.3258 2573.67668   126%     - 1025s
     0     0 2561.31960    0  528 -9876.3258 2561.31960   126%     - 1034s
     0     0 2556.37874    0  527 -9876.3258 2556.37874   126%     - 1039s
     0     0 2555.08513    0  534 -9876.3258 2555.08513   126%     - 1044s
     0     0 2432.70086    0  608 -9876.3258 2432.70086   125%     - 1084s
H    0     0                    -8458.861938 2432.66476   129%     - 1109s
H    0     0                    -8316.675461 2432.66476   129%     - 1110s
H    0     0                    -8198.134341 2432.66476   130%     - 1111s
H    0     0                    -8157.862927 2432.66476   130%     - 1111s
     0     0 2380.70383    0  717 -8157.8629 2380.70383   129%     - 1128s
     0     0 2370.05352    0  652 -8157.8629 2370.05352   129%     - 1140s
     0     0 2362.05401    0  718 -8157.8629 2362.05401   129%     - 1149s
     0     0 2352.86473    0  715 -8157.8629 2352.86473   129%     - 1156s
     0     0 2350.25099    0  656 -8157.8629 2350.25099   129%     - 1160s
     0     0 2345.28489    0  658 -8157.8629 2345.28489   129%     - 1168s
     0     0 2344.19497    0  658 -8157.8629 2344.19497   129%     - 1171s
     0     0 2190.23628    0  538 -8157.8629 2190.23628   127%     - 1199s
H    0     0                    -8133.752442 2190.00137   127%     - 1200s
H    0     0                    -8133.463407 2190.00137   127%     - 1200s
     0     0 2137.10158    0  550 -8133.4634 2137.10158   126%     - 1219s
     0     0 2120.27952    0  611 -8133.4634 2120.27952   126%     - 1227s
     0     0 2117.56982    0  549 -8133.4634 2117.56982   126%     - 1232s
     0     0 2108.52227    0  551 -8133.4634 2108.52227   126%     - 1238s
     0     0 2101.17267    0  562 -8133.4634 2101.17267   126%     - 1243s
     0     0 2090.81787    0  541 -8133.4634 2090.81787   126%     - 1253s
     0     0 2089.62565    0  553 -8133.4634 2089.62565   126%     - 1256s
     0     0 2034.95029    0  536 -8133.4634 2034.95029   125%     - 1268s
H    0     0                    -8127.772515 2034.86000   125%     - 1278s
H    0     0                    -8118.206571 2034.86000   125%     - 1278s
     0     0 2022.67402    0  538 -8118.2066 2022.67402   125%     - 1283s
     0     0 2019.41534    0  541 -8118.2066 2019.41534   125%     - 1288s
     0     0 2014.89825    0  539 -8118.2066 2014.89825   125%     - 1293s
     0     0 2011.99903    0  547 -8118.2066 2011.99903   125%     - 1296s
     0     0 2011.32213    0  546 -8118.2066 2011.32213   125%     - 1298s
     0     0 1985.56288    0  605 -8118.2066 1985.56288   124%     - 1310s
     0     0 1981.53077    0  611 -8118.2066 1981.53077   124%     - 1318s
     0     0 1975.07308    0  596 -8118.2066 1975.07308   124%     - 1326s
     0     0 1974.34205    0  607 -8118.2066 1974.34205   124%     - 1330s
     0     0 1959.31860    0  605 -8118.2066 1959.31860   124%     - 1343s
     0     0 1956.09721    0  624 -8118.2066 1956.09721   124%     - 1352s
     0     0 1940.35219    0  624 -8118.2066 1940.35219   124%     - 1357s
     0     0 1928.46996    0  546 -8118.2066 1928.46996   124%     - 1363s
     0     0 1924.90817    0  549 -8118.2066 1924.90817   124%     - 1369s
     0     0 1924.32996    0  552 -8118.2066 1924.32996   124%     - 1371s
     0     0 1911.19511    0  557 -8118.2066 1911.19511   124%     - 1382s
     0     0 1905.90801    0  554 -8118.2066 1905.90801   123%     - 1388s
     0     0 1903.97206    0  563 -8118.2066 1903.97206   123%     - 1393s
     0     0 1903.03027    0  569 -8118.2066 1903.03027   123%     - 1395s
     0     0 1893.33446    0  567 -8118.2066 1893.33446   123%     - 1406s
H    0     0                    -8066.044832 1893.30751   123%     - 1428s
H    0     0                    -8061.477491 1893.30751   123%     - 1430s
H    0     0                    -8056.742376 1893.30751   123%     - 1430s
     0     0 1891.48171    0  554 -8056.7424 1891.48171   123%     - 1437s
     0     0 1847.23477    0  648 -8056.7424 1847.23477   123%     - 1451s
     0     0 1833.69897    0  661 -8056.7424 1833.69897   123%     - 1458s
     0     0 1830.67889    0  630 -8056.7424 1830.67889   123%     - 1463s
     0     0 1826.42770    0  643 -8056.7424 1826.42770   123%     - 1468s
     0     0 1823.69823    0  631 -8056.7424 1823.69823   123%     - 1476s
     0     0 1822.83652    0  635 -8056.7424 1822.83652   123%     - 1479s
     0     0 1814.61947    0  596 -8056.7424 1814.61947   123%     - 1491s
     0     0 1810.31017    0  667 -8056.7424 1810.31017   122%     - 1501s
     0     0 1808.71895    0  675 -8056.7424 1808.71895   122%     - 1505s
     0     0 1803.17532    0  568 -8056.7424 1803.17532   122%     - 1516s
     0     0 1800.12930    0  602 -8056.7424 1800.12930   122%     - 1523s
     0     0 1798.85171    0  669 -8056.7424 1798.85171   122%     - 1527s
     0     0 1789.74367    0  677 -8056.7424 1789.74367   122%     - 1542s
     0     0 1789.06903    0  671 -8056.7424 1789.06903   122%     - 1548s
     0     0 1785.58113    0  687 -8056.7424 1785.58113   122%     - 1557s
     0     0 1785.53660    0  687 -8056.7424 1785.53660   122%     - 1576s
H    0     0                    -8036.047845 1785.51887   122%     - 1753s
H    0     0                    -8009.481899 1785.51887   122%     - 1758s
     0     2 1785.51887    0  687 -8009.4819 1785.51887   122%     - 1762s
     1     3 1700.55296    1  526 -8009.4819 1785.51887   122% 19715 1774s
     2     4 1759.51194    1  691 -8009.4819 1759.51194   122% 16645 1791s
     3     6 1707.59404    2  658 -8009.4819 1759.36486   122% 19676 1809s
     5    10 -420.08005    3  289 -8009.4819 1759.36486   122% 16712 1828s
     9    18 1154.90903    3  504 -8009.4819 1707.46996   121% 14171 1871s
    17    26  891.64813    4  394 -8009.4819 1551.14304   119% 17139 1947s
    25    50  892.98774    4  472 -8009.4819 1551.14304   119% 17029 2157s
    49    81  683.25000    5  458 -8009.4819 1551.14304   119% 51471 2260s
H   61    81                    -7900.123736 1551.14304   120% 43347 2260s
    80   126 -183.54732    6  473 -7900.1237 1551.14304   120% 37047 2468s
   133   152 -200.38467    7  472 -7900.1237 1551.14304   120% 25241 2535s
H  136   152                    -7880.014455 1551.14304   120% 24829 2535s
H  141   152                    -7564.883448 1551.14304   121% 24026 2535s
H  142   152                    -7341.001132 1551.14304   121% 23869 2535s
   175   208 -601.48323    7  442 -7341.0011 1551.14304   121% 21190 2656s
   239   246 -3032.9559    8  484 -7341.0011 1551.14304   121% 18761 2787s
   285   306 -4058.5407    9  459 -7341.0011 1551.14304   121% 17630 2873s
   355   371 -1320.6741   14  292 -7341.0011 1551.14304   121% 15835 2945s
   434   427 -4594.1799   10  411 -7341.0011 1551.14304   121% 14131 3011s
   514   445 -5536.3948   11  389 -7341.0011 1551.14304   121% 13010 3059s
H  527   445                    -7326.576839 1551.14304   121% 12863 3059s
H  531   445                    -7309.115762 1551.14304   121% 12797 3059s
H  537   445                    -7303.424870 1551.14304   121% 12756 3059s
   550   487 -5655.2548   12  309 -7303.4249 1551.14304   121% 12736 3123s
   616   535 -5774.4321   12  312 -7303.4249 1551.14304   121% 12185 3176s
   692   561 -6499.8869   13  301 -7303.4249 1551.14304   121% 11420 3226s
   763   598 infeasible   14      -7303.4249 1551.14304   121% 10865 3278s
   842   649 -554.29632    9  263 -7303.4249 1551.14304   121% 10280 3322s
   940   660 infeasible   22      -7303.4249 1551.14304   121%  9588 3366s
   977   688     cutoff   13      -7303.4249 1551.14304   121%  9408 3410s
  1027   741 -2135.7244   12  233 -7303.4249 1551.14304   121%  9123 3453s
  1122   808 -2429.4859   14  209 -7303.4249 1551.14304   121%  8564 3499s
  1242   842     cutoff   14      -7303.4249 1551.14304   121%  8016 3549s
  1368   872 -3106.1592   25  181 -7303.4249 1551.14304   121%  7547 3600s

Cutting planes:
  Implied bound: 372
  MIR: 5477
  Flow cover: 4458
  Zero half: 7
  RLT: 85
  Relax-and-lift: 530

Explored 1460 nodes (12147886 simplex iterations) in 3600.05 seconds (8364.03 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -7303.42 -7309.12 -7326.58 ... -8056.74

Time limit reached
Best objective -7.303424870155e+03, best bound 1.551143040972e+03, gap 121.2386%
  WARNING: Time limit reached. Using best solution found (gap: 121.24%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = -7303.42, θ = 114776.36
  Upper Bound (UB) = -7303.42

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 114776.36
  [DEBUG]   ✓ Scenario 0: θ = 114776.36 ≤ Q = 114776.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 114776.36 ≤ Q = 114776.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 114776.36 ≤ Q = 114776.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 114776.36 ≤ Q = 114776.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 114776.36 ≤ Q = 114776.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 114776.36 ≤ Q = 114776.36 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 114776.36 ≤ Q = 114776.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 114776.36 ≤ Q = 114776.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 114776.36 ≤ Q = 114776.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 114776.36 ≤ Q = 114776.36 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 114776.36 ≤ Q = 114776.36 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 114776.36 ≤ Q = 114776.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 114776.36 ≤ Q = 114776.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 114776.36 ≤ Q = 114776.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 114776.36 ≤ Q = 114776.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 114776.36 ≤ Q = 114776.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 114776.36 ≤ Q = 114776.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 114776.36 ≤ Q = 114776.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 114776.36 ≤ Q = 114776.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 114776.36 ≤ Q = 114776.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 20: θ = 114776.36 ≤ Q = 114776.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 21: θ = 114776.36 ≤ Q = 114776.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 22: θ = 114776.36 ≤ Q = 114776.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 23: θ = 114776.36 ≤ Q = 114776.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 24: θ = 114776.36 ≤ Q = 114776.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 25: θ = 114776.36 ≤ Q = 114776.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 26: θ = 114776.36 ≤ Q = 114776.36 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 27] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x38d4a72b
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xc72b58d5
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [3e-01, 2e+02]
Found heuristic solution: objective 1.304344e+13
Presolve removed 2602 rows and 1895 columns
Presolve time: 0.00s
Presolved: 491 rows, 494 columns, 1384 nonzeros
Found heuristic solution: objective 6756489.7598
Variable types: 334 continuous, 160 integer (160 binary)

Root relaxation: objective -1.228217e+05, 232 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -122821.67    0  122 6756489.76 -122821.67   102%     -    0s
H    0     0                    -90174.70263 -122821.67  36.2%     -    0s
H    0     0                    -90771.70011 -122821.67  35.3%     -    0s
H    0     0                    -98760.16263 -100329.49  1.59%     -    0s
     0     0 -100329.49    0   41 -98760.163 -100329.49  1.59%     -    0s
     0     0 -99793.009    0   20 -98760.163 -99793.009  1.05%     -    0s
H    0     0                    -99193.74252 -99793.009  0.60%     -    0s
H    0     0                    -99243.91697 -99771.944  0.53%     -    0s
     0     0 -99710.312    0   25 -99243.917 -99710.312  0.47%     -    0s
H    0     0                    -99282.77210 -99710.312  0.43%     -    0s
     0     0 -99710.312    0   19 -99282.772 -99710.312  0.43%     -    0s
H    0     0                    -99305.89602 -99710.312  0.41%     -    0s
     0     0 -99546.830    0   13 -99305.896 -99546.830  0.24%     -    0s
     0     0 -99529.567    0   17 -99305.896 -99529.567  0.23%     -    0s
     0     0 -99411.281    0    8 -99305.896 -99411.281  0.11%     -    0s
     0     0 -99403.271    0    7 -99305.896 -99403.271  0.10%     -    0s
H    0     0                    -99316.66739 -99403.271  0.09%     -    0s
     0     0 -99386.131    0   10 -99316.667 -99386.131  0.07%     -    0s
     0     0 -99355.464    0    8 -99316.667 -99355.464  0.04%     -    0s
     0     0 -99334.965    0    5 -99316.667 -99334.965  0.02%     -    0s
H    0     0                    -99319.60280 -99334.965  0.02%     -    0s

Cutting planes:
  Gomory: 2
  Implied bound: 3
  MIR: 3
  Flow cover: 2
  RLT: 1

Explored 1 nodes (539 simplex iterations) in 0.15 seconds (0.04 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -99319.6 -99316.7 -99305.9 ... 6.75649e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -9.931960280297e+04, best bound -9.932639962979e+04, gap 0.0068%
  Subproblem solved in 0.16s
  Worst-case operational profit (Z_SP) = 108378.42
  Scenario: 16 demand increases, 44 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -99319.60
  [DEBUG]   S×d_nominal = 207698.03
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 207698.03 + -99319.60 = 108378.42
  [DEBUG]   Current θ from Master = 114776.36
  [DEBUG]   ⚠️  Z_SP ≤ θ by 6397.94 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -13701.36
  Lower Bound (LB) = -7110.37
  Gap (UB-LB) = -193.0590, Absolute Gap = 193.0590, Relative Gap = -0.026434
  *** CONVERGED (small negative gap: -193.06 within tolerance ε=200) ***
  Note: Negative gap likely due to numerical precision or solver tolerance

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 27
Total Time: 72083.22s
Converged: True
Final Lower Bound: -7110.3658
Final Upper Bound: -7303.4249
Final Gap: -193.059023
Number of Critical Scenarios: 27
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [1] (1/3)
Product 1 Plants: [0] (1/3)
Product 2 Plants: [0] (1/3)
Total Plant Openings: 3
DCs Opened: [2, 4, 9] (3/10)
Active Routes (Plant→DC): 8
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 0 customers  Mode 1: 6 customers  Mode 2: 44 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 27
Start Time: 2026-01-04 12:31:02
End Time: 2026-01-05 08:32:25
Total Time: 72083.22s
Optimal Value: -7110.37
Lower Bound: -7110.37
Upper Bound: -7303.42
Gap: -193.059023
Plants Opened: {0: [1], 1: [0], 2: [0]} (3 plants)
DCs Opened: [2, 4, 9] (3 DCs)
================================================================================

Results saved to: result/DH_single_full_seed11_LD_gamma20_20260105_083226.csv

Total Execution Time: 72083.56 seconds
End Time: 2026-01-05 08:32:26

All tasks completed successfully!

