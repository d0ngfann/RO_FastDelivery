
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 19
DI Scenario: MD
Start Time: 2026-01-04 12:30:56
================================================================================
Loading data from data/DH_data_full_seed19.pkl...

Applying DI scenario: MD
DI values:
  Product 0: ['1.000', '1.286', '1.654'] (k=0.620)
  Product 1: ['1.000', '1.273', '1.620'] (k=0.595)
  Product 2: ['1.000', '1.177', '1.385'] (k=0.402)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=927, max=1790
  DC capacity (MC): min=401, max=818

Demand Structure (s_rk matrix):
  Total customer-product pairs: 78/150 (48.0% sparse)
  Average products per customer: 1.56

Demand (only non-zero entries):
  Nominal (μ): min=8.20, max=34.38, count=78
  Deviation (μ̂): min=4.15, max=10.00

Costs:
  Plant fixed cost: min=5642, max=9474
  DC fixed cost: min=3448, max=5966
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.369', '1.874'] (k=0.775)
    Product 1: ['1.000', '1.331', '1.773'] (k=0.706)
    Product 2: ['1.000', '1.311', '1.720'] (k=0.669)
  MD:
    Product 0: ['1.000', '1.286', '1.654'] (k=0.620)
    Product 1: ['1.000', '1.273', '1.620'] (k=0.595)
    Product 2: ['1.000', '1.177', '1.385'] (k=0.402)
  LD:
    Product 0: ['1.000', '1.042', '1.086'] (k=0.102)
    Product 1: ['1.000', '1.040', '1.081'] (k=0.096)
    Product 2: ['1.000', '1.028', '1.058'] (k=0.069)
  Mixed:
    Product 0: ['1.000', '1.369', '1.874'] (k=0.775)
    Product 1: ['1.000', '1.273', '1.620'] (k=0.595)
    Product 2: ['1.000', '1.028', '1.058'] (k=0.069)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48744 nonzeros
Model fingerprint: 0x1c61d88c
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11953 rows and 2953 columns
Presolve time: 0.08s
Presolved: 4720 rows, 5547 columns, 32846 nonzeros
Variable types: 3288 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -293471.1183
Found heuristic solution: objective -185609.9094

Root relaxation: objective 9.846366e+04, 4976 iterations, 0.21 seconds (0.37 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 98463.6555    0  465 -185609.91 98463.6555   153%     -    0s
H    0     0                    -182444.3799 98463.6555   154%     -    0s
     0     0 89122.3252    0  733 -182444.38 89122.3252   149%     -    0s
H    0     0                    -161029.5996 89117.2774   155%     -    0s
     0     0 88818.3035    0  757 -161029.60 88818.3035   155%     -    0s
     0     0 88771.2634    0  772 -161029.60 88771.2634   155%     -    0s
     0     0 88771.2132    0  772 -161029.60 88771.2132   155%     -    0s
     0     0 84434.5360    0  911 -161029.60 84434.5360   152%     -    1s
     0     0 84144.8407    0  910 -161029.60 84144.8407   152%     -    1s
     0     0 84090.2401    0  919 -161029.60 84090.2401   152%     -    1s
     0     0 84069.2326    0  922 -161029.60 84069.2326   152%     -    1s
     0     0 84065.6149    0  928 -161029.60 84065.6149   152%     -    1s
     0     0 84065.2151    0  934 -161029.60 84065.2151   152%     -    1s
H    0     0                    -157161.1119 80860.5607   151%     -    2s
     0     0 80860.5607    0 1024 -157161.11 80860.5607   151%     -    2s
     0     0 80603.7713    0 1041 -157161.11 80603.7713   151%     -    3s
     0     0 80573.6106    0 1035 -157161.11 80573.6106   151%     -    3s
     0     0 80572.8855    0 1043 -157161.11 80572.8855   151%     -    3s
H    0     0                    -139691.6013 80572.8855   158%     -    3s
H    0     0                    -134049.3190 80572.8855   160%     -    3s
H    0     0                    21357.108339 80572.8855   277%     -    3s
H    0     0                    21668.194399 80572.8855   272%     -    3s
H    0     0                    21680.744523 80572.8855   272%     -    3s
H    0     0                    21905.557395 80572.8855   268%     -    3s
     0     0 77129.8543    0 1134 21905.5574 77129.8543   252%     -    4s
H    0     0                    22684.742872 76654.1708   238%     -    5s
H    0     0                    22753.902073 76654.1708   237%     -    5s
H    0     0                    22777.039198 76654.1708   237%     -    5s
H    0     0                    22789.457667 76654.1708   236%     -    5s
H    0     0                    22804.941604 76654.1708   236%     -    5s
H    0     0                    24962.672606 76654.1708   207%     -    5s
H    0     0                    24999.413327 76654.1708   207%     -    5s
H    0     0                    25129.063749 76654.1708   205%     -    5s
H    0     0                    25475.346656 76654.1708   201%     -    5s
     0     0 76654.1708    0 1153 25475.3467 76654.1708   201%     -    5s
     0     0 76569.3114    0 1167 25475.3467 76569.3114   201%     -    5s
     0     0 76552.1294    0 1188 25475.3467 76552.1294   200%     -    5s
     0     0 76546.3654    0 1190 25475.3467 76546.3654   200%     -    5s
H    0     0                    25982.503157 74888.7620   188%     -    6s
     0     0 74888.7620    0 1163 25982.5032 74888.7620   188%     -    6s
H    0     0                    26265.193266 74666.0981   184%     -    6s
     0     0 74666.0981    0 1186 26265.1933 74666.0981   184%     -    6s
H    0     0                    26706.959373 74621.4838   179%     -    6s
H    0     0                    26903.283448 74621.4838   177%     -    6s
H    0     0                    26953.306051 74621.4838   177%     -    6s
H    0     0                    27055.828134 74621.4838   176%     -    6s
     0     0 74621.4838    0 1209 27055.8281 74621.4838   176%     -    6s
     0     0 74609.0765    0 1200 27055.8281 74609.0765   176%     -    6s
     0     0 74608.0023    0 1200 27055.8281 74608.0023   176%     -    7s
     0     0 73533.0950    0 1133 27055.8281 73533.0950   172%     -    8s
H    0     0                    27161.536817 73325.6095   170%     -    8s
     0     0 73325.6095    0 1204 27161.5368 73325.6095   170%     -    8s
H    0     0                    27227.267422 73274.7196   169%     -    8s
H    0     0                    27462.647721 73274.7196   167%     -    8s
     0     0 73274.7196    0 1209 27462.6477 73274.7196   167%     -    8s
     0     0 73264.4179    0 1234 27462.6477 73264.4179   167%     -    8s
H    0     0                    27517.499654 71375.1560   159%     -   10s
     0     0 71375.1560    0 1139 27517.4997 71375.1560   159%     -   10s
     0     0 71158.5182    0 1170 27517.4997 71158.5182   159%     -   11s
     0     0 71127.7142    0 1200 27517.4997 71127.7142   158%     -   11s
     0     0 71115.2266    0 1188 27517.4997 71115.2266   158%     -   11s
H    0     0                    27816.390318 67008.1557   141%     -   13s
     0     0 67008.1557    0 1054 27816.3903 67008.1557   141%     -   13s
H    0     0                    29120.897685 66246.8965   127%     -   14s
     0     0 66246.8965    0 1107 29120.8977 66246.8965   127%     -   14s
     0     0 66123.4110    0 1122 29120.8977 66123.4110   127%     -   14s
     0     0 66098.7810    0 1128 29120.8977 66098.7810   127%     -   14s
     0     0 66094.6677    0 1136 29120.8977 66094.6677   127%     -   15s
H    0     0                    29280.912298 63035.2530   115%     -   17s
H    0     0                    29308.201434 63035.2530   115%     -   17s
H    0     0                    29346.921502 63035.2530   115%     -   17s
     0     0 63035.2530    0 1031 29346.9215 63035.2530   115%     -   17s
H    0     0                    29434.613753 62594.5691   113%     -   17s
     0     0 62594.5691    0 1037 29434.6138 62594.5691   113%     -   17s
     0     0 62507.8731    0 1078 29434.6138 62507.8731   112%     -   17s
     0     0 62474.6567    0 1104 29434.6138 62474.6567   112%     -   17s
     0     0 62468.7397    0 1100 29434.6138 62468.7397   112%     -   18s
H    0     0                    29435.190135 56923.7823  93.4%     -   20s
H    0     0                    29752.482307 56923.7823  91.3%     -   20s
     0     0 56923.7823    0  706 29752.4823 56923.7823  91.3%     -   20s
     0     0 56260.0226    0  745 29752.4823 56260.0226  89.1%     -   20s
     0     0 56108.7522    0  783 29752.4823 56108.7522  88.6%     -   21s
     0     0 56024.5684    0  795 29752.4823 56024.5684  88.3%     -   21s
     0     0 56008.2440    0  791 29752.4823 56008.2440  88.2%     -   21s
     0     0 54885.2682    0  858 29752.4823 54885.2682  84.5%     -   22s
H    0     0                    29853.465726 54560.3748  82.8%     -   23s
H    0     0                    29979.749115 54560.3748  82.0%     -   23s
     0     0 54560.3748    0  915 29979.7491 54560.3748  82.0%     -   23s
     0     0 54475.3073    0  947 29979.7491 54475.3073  81.7%     -   23s
     0     0 54454.6870    0  954 29979.7491 54454.6870  81.6%     -   23s
     0     0 53063.4597    0  743 29979.7491 53063.4597  77.0%     -   24s
H    0     0                    30451.955473 52586.5534  72.7%     -   25s
H    0     0                    30460.507585 52586.5534  72.6%     -   25s
H    0     0                    30500.128252 52586.5534  72.4%     -   25s
     0     0 52586.5534    0  758 30500.1283 52586.5534  72.4%     -   25s
     0     0 52511.5467    0  778 30500.1283 52511.5467  72.2%     -   25s
     0     0 52472.7676    0  739 30500.1283 52472.7676  72.0%     -   26s
     0     0 52052.2108    0  812 30500.1283 52052.2108  70.7%     -   26s
     0     0 51887.5426    0  789 30500.1283 51887.5426  70.1%     -   27s
     0     0 51788.8684    0  805 30500.1283 51788.8684  69.8%     -   27s
     0     0 51760.3733    0  795 30500.1283 51760.3733  69.7%     -   28s
     0     0 51412.4396    0  769 30500.1283 51412.4396  68.6%     -   28s
     0     0 51265.2892    0  788 30500.1283 51265.2892  68.1%     -   29s
     0     0 51216.4955    0  906 30500.1283 51216.4955  67.9%     -   29s
     0     0 51193.7378    0  811 30500.1283 51193.7378  67.8%     -   29s
     0     0 50950.0970    0  884 30500.1283 50950.0970  67.0%     -   30s
     0     0 50865.8405    0  902 30500.1283 50865.8405  66.8%     -   30s
     0     0 50840.6193    0  901 30500.1283 50840.6193  66.7%     -   31s
     0     0 50548.0606    0  795 30500.1283 50548.0606  65.7%     -   31s
     0     0 50481.8713    0  874 30500.1283 50481.8713  65.5%     -   32s
     0     0 50457.8803    0  917 30500.1283 50457.8803  65.4%     -   32s
     0     0 50295.0758    0  702 30500.1283 50295.0758  64.9%     -   33s
     0     0 50215.0636    0  852 30500.1283 50215.0636  64.6%     -   33s
H    0     0                    30520.524004 50196.3021  64.5%     -   33s
     0     0 50196.3021    0  812 30520.5240 50196.3021  64.5%     -   33s
     0     0 49966.6159    0  827 30520.5240 49966.6159  63.7%     -   34s
     0     0 49966.5520    0  827 30520.5240 49966.5520  63.7%     -   34s
     0     2 49966.1731    0  827 30520.5240 49966.1731  63.7%     -   36s
    15    32 48371.1185    4  556 30520.5240 49003.6094  60.6%  2554   40s
H   46    64                    30596.372239 48595.0824  58.8%  2551   41s
H  108   198                    30602.771591 48488.7348  58.4%  1896   43s
H  114   198                    30729.823526 48488.7348  57.8%  1837   43s
H  124   198                    31150.236994 48488.7348  55.7%  1751   43s
H  149   198                    32080.817057 48488.7348  51.1%  1550   43s
   365   400 46326.5211   13  433 32080.8171 48488.7348  51.1%   858   45s
H  454   475                    32493.509857 48488.7348  49.2%   796   45s
H  470   475                    32523.688025 48488.7348  49.1%   777   45s
  1248  1237 43348.5136   21  400 32523.6880 47825.4827  47.0%   467   50s
H 1619  1507                    32608.917726 47617.4354  46.0%   452   52s
  2015  1858 33954.1750   27  315 32608.9177 47548.4386  45.8%   445   55s
H 2681  2278                    32782.020493 47520.6219  45.0%   432   59s
H 2693  2278                    32811.450837 47520.6219  44.8%   433   59s
  2710  2432 34729.8502   24  271 32811.4508 47520.6219  44.8%   436   60s
H 3221  2652                    32828.395789 47181.0347  43.7%   431   62s
H 3231  2650                    32953.097758 47181.0347  43.2%   431   62s
H 3299  2632                    33061.231194 46911.0888  41.9%   433   62s
H 3688  2895                    33176.282278 46911.0888  41.4%   434   66s
  3689  2896 37274.4994   19  827 33176.2823 46911.0888  41.4%   434   73s
  3699  2903 45322.1127   20  455 33176.2823 46911.0888  41.4%   432   75s
  3735  2944 42873.3087   19  380 33176.2823 44546.9715  34.3%   436   80s
H 4033  2823                    33776.064251 41934.4567  24.2%   435   81s
H 4039  2682                    33849.586501 41934.4567  23.9%   435   81s
H 4434  2462                    34394.551487 39435.8203  14.7%   416   83s
H 4477  2322                    34480.562721 39435.8203  14.4%   415   83s
H 4791  2051                    34673.812947 38356.6567  10.6%   400   83s
H 5033  1821                    34701.612926 37708.4584  8.66%   385   84s
H 5033  1714                    34823.017208 37708.4584  8.29%   385   84s
H 5045  1607                    34975.668520 37708.4584  7.81%   385   84s
H 5292  1449                    35002.306244 37033.6957  5.80%   369   84s
H 5441  1307                    35045.885858 37033.6957  5.67%   359   84s
  5857  1229 35139.3093   55   16 35045.8859 37033.6957  5.67%   336   85s

Cutting planes:
  Gomory: 2
  Implied bound: 4
  Projected implied bound: 26
  MIR: 174
  Flow cover: 442
  RLT: 11
  Relax-and-lift: 93
  BQP: 1

Explored 9967 nodes (2165121 simplex iterations) in 86.28 seconds (177.40 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 35045.9 35002.3 34975.7 ... 33776.1

Optimal solution found (tolerance 1.00e-04)
Best objective 3.504588585833e+04, best bound 3.504588585833e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 86.29s
  Master Objective (UB) = 35045.89, θ = 172352.32
  Upper Bound (UB) = 35045.89

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 172352.32
  [DEBUG]   ✓ Scenario 0: θ = 172352.32 ≤ Q = 172352.32 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x48a89bc7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x48a89bc7
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.201439e+13
Presolve removed 2613 rows and 1904 columns
Presolve time: 0.00s
Presolved: 480 rows, 485 columns, 1318 nonzeros
Found heuristic solution: objective 5612363.3693
Variable types: 329 continuous, 156 integer (156 binary)

Root relaxation: objective -1.420437e+05, 229 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -142043.66    0  121 5612363.37 -142043.66   103%     -    0s
H    0     0                    -108599.7782 -142043.66  30.8%     -    0s
H    0     0                    -109476.8278 -142043.66  29.7%     -    0s
*    0     0               0    -110516.3146 -110516.31  0.00%     -    0s

Cutting planes:
  Gomory: 2
  MIR: 199

Explored 1 nodes (355 simplex iterations) in 0.01 seconds (0.01 work units)
Thread count was 32 (of 64 available processors)

Solution count 5: -110516 -109477 -108600 ... 1.20144e+13
No other solutions better than -110516

Optimal solution found (tolerance 1.00e-04)
Best objective -1.105163145805e+05, best bound -1.105163145805e+05, gap 0.0000%
  Subproblem solved in 0.03s
  Worst-case operational profit (Z_SP) = 141413.49
  Scenario: 0 demand increases, 59 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -110516.31
  [DEBUG]   S×d_nominal = 251929.81
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 251929.81 + -110516.31 = 141413.49
  [DEBUG]   Current θ from Master = 172352.32
  [DEBUG]   ⚠️  Z_SP ≤ θ by 30938.83 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 4107.05
  Lower Bound (LB) = 4107.05
  Gap (UB-LB) = 30938.8315, Absolute Gap = 30938.8315, Relative Gap = 0.882809
  Not converged yet (gap = 30938.83 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 59 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 91969 nonzeros
Model fingerprint: 0xf8125c3f
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 4107.05 (0.01s)
Loaded MIP start from previous solve with objective 4107.05

Presolve removed 14605 rows and 5924 columns
Presolve time: 0.30s
Presolved: 17358 rows, 8816 columns, 95998 nonzeros
Variable types: 6557 continuous, 2259 integer (2259 binary)

Root relaxation: objective 4.381949e+04, 9802 iterations, 1.30 seconds (2.71 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 43819.4950    0  267 4107.05440 43819.4950   967%     -    1s
H    0     0                    7364.2946585 43819.4950   495%     -    1s
H    0     0                    7582.5753117 43819.4950   478%     -    1s
     0     0 38039.8534    0  489 7582.57531 38039.8534   402%     -    2s
H    0     0                    8041.1645321 38039.4725   373%     -    2s
     0     0 37869.2382    0  495 8041.16453 37869.2382   371%     -    2s
     0     0 37868.5079    0  491 8041.16453 37868.5079   371%     -    2s
     0     0 32134.2310    0  538 8041.16453 32134.2310   300%     -    4s
     0     0 31666.2710    0  527 8041.16453 31666.2710   294%     -    4s
     0     0 31562.8828    0  527 8041.16453 31562.8828   293%     -    5s
     0     0 31561.6000    0  539 8041.16453 31561.6000   293%     -    5s
     0     0 28279.3453    0  543 8041.16453 28279.3453   252%     -    7s
     0     0 27451.6590    0  621 8041.16453 27451.6590   241%     -    7s
     0     0 27250.4697    0  565 8041.16453 27250.4697   239%     -    8s
     0     0 27225.3072    0  576 8041.16453 27225.3072   239%     -    8s
     0     0 27217.7412    0  530 8041.16453 27217.7412   238%     -    8s
     0     0 27216.2093    0  577 8041.16453 27216.2093   238%     -    8s
H    0     0                    8121.0343987 27216.2093   235%     -    9s
H    0     0                    8257.7609082 24678.2062   199%     -   11s
     0     0 24678.2062    0  503 8257.76091 24678.2062   199%     -   11s
H    0     0                    8281.2383581 24152.1809   192%     -   11s
     0     0 24152.1809    0  587 8281.23836 24152.1809   192%     -   11s
     0     0 23910.0005    0  609 8281.23836 23910.0005   189%     -   12s
     0     0 23811.9900    0  555 8281.23836 23811.9900   188%     -   12s
     0     0 23779.5904    0  571 8281.23836 23779.5904   187%     -   12s
     0     0 23772.2297    0  562 8281.23836 23772.2297   187%     -   12s
     0     0 23771.8119    0  564 8281.23836 23771.8119   187%     -   13s
     0     0 23033.6120    0  546 8281.23836 23033.6120   178%     -   14s
     0     0 22868.1378    0  559 8281.23836 22868.1378   176%     -   14s
     0     0 22806.5423    0  571 8281.23836 22806.5423   175%     -   15s
     0     0 22789.3248    0  574 8281.23836 22789.3248   175%     -   15s
     0     0 22779.7036    0  533 8281.23836 22779.7036   175%     -   15s
     0     0 22775.0594    0  522 8281.23836 22775.0594   175%     -   15s
     0     0 22483.2302    0  515 8281.23836 22483.2302   171%     -   16s
     0     0 22413.2758    0  521 8281.23836 22413.2758   171%     -   16s
     0     0 22386.9179    0  598 8281.23836 22386.9179   170%     -   17s
     0     0 22379.0412    0  592 8281.23836 22379.0412   170%     -   17s
     0     0 22374.9835    0  591 8281.23836 22374.9835   170%     -   17s
     0     0 22147.4055    0  492 8281.23836 22147.4055   167%     -   18s
     0     0 22079.8438    0  652 8281.23836 22079.8438   167%     -   18s
     0     0 22048.8944    0  584 8281.23836 22048.8944   166%     -   19s
     0     0 22028.6983    0  532 8281.23836 22028.6983   166%     -   19s
     0     0 22026.3708    0  576 8281.23836 22026.3708   166%     -   19s
     0     0 21946.4616    0  531 8281.23836 21946.4616   165%     -   20s
     0     0 21930.3854    0  530 8281.23836 21930.3854   165%     -   20s
     0     0 21922.8079    0  550 8281.23836 21922.8079   165%     -   20s
     0     0 21920.2817    0  555 8281.23836 21920.2817   165%     -   20s
     0     0 21884.7802    0  468 8281.23836 21884.7802   164%     -   21s
     0     0 21878.7200    0  590 8281.23836 21878.7200   164%     -   21s
     0     0 21836.5235    0  478 8281.23836 21836.5235   164%     -   22s
     0     0 21820.5511    0  481 8281.23836 21820.5511   163%     -   22s
     0     0 21817.0965    0  536 8281.23836 21817.0965   163%     -   22s
     0     0 21782.2684    0  445 8281.23836 21782.2684   163%     -   22s
     0     0 21781.5562    0  445 8281.23836 21781.5562   163%     -   23s
     0     2 21781.5562    0  445 8281.23836 21781.5562   163%     -   27s
    31    64 20786.0312    5  448 8281.23836 20939.2087   153%  1208   31s
H  111   128                    8970.8329136 20785.5792   132%  1115   33s
H  112   128                    10208.582946 20785.5792   104%  1111   33s
H  114   128                    10362.734075 20785.5792   101%  1101   33s
H  118   128                    10775.655920 20785.5792  92.9%  1077   33s
H  126   128                    11245.353862 20785.5792  84.8%  1032   33s
   176   206 19085.8096    8  503 11245.3539 20785.5792  84.8%  1052   35s
H  198   206                    11692.035905 20785.5792  77.8%  1077   35s
H  358   333                    11939.000075 20634.4900  72.8%   946   38s
H  359   333                    12074.244008 20634.4900  70.9%   945   38s
   374   408 17315.1152   12  605 12074.2440 20634.4900  70.9%   940   40s
H  590   511                    12320.471445 20634.4900  67.5%   768   42s
H  707   617                    12376.292465 20569.4830  66.2%   711   44s
   726   699 15397.5163   16  395 12376.2925 20569.4830  66.2%   706   45s
H  820   727                    12400.242785 20569.4830  65.9%   660   46s
H  824   727                    12498.657747 20569.4830  64.6%   658   46s
  1050   886 15679.4748   24  487 12498.6577 20569.4830  64.6%   591   50s
H 1093   886                    12550.705508 20162.9017  60.7%   592   50s
  1420  1037 15279.6648   26  476 12550.7055 20096.7386  60.1%   557   55s
H 1522  1118                    12577.608392 20096.7386  59.8%   558   59s
  1635  1201 14487.4995   29  293 12577.6084 20096.7386  59.8%   543   60s
  2029  1362 15105.1959    8  283 12577.6084 19868.3222  58.0%   509   66s
  2394  1458 infeasible   13      12577.6084 19535.5502  55.3%   510   70s
  2786  1629     cutoff   12      12577.6084 19120.7940  52.0%   496   76s
  3120  1660 14281.2189    8  247 12577.6084 18816.0314  49.6%   499   80s
H 3153  1660                    12589.978809 18816.0314  49.5%   500   80s
  3504  1747 14596.6496   12  426 12589.9788 18816.0314  49.5%   506   86s
H 3508  1747                    12591.101202 18816.0314  49.4%   506   86s
  3869  1887     cutoff   15      12591.1012 18031.3576  43.2%   501   91s
  4356  1966 13141.9861   21  148 12591.1012 17841.8541  41.7%   493   95s
  5019  2104 14720.7448   11  442 12591.1012 17236.3379  36.9%   486  100s
  5554  2335     cutoff   17      12591.1012 17036.6827  35.3%   480  105s
  5936  2336 13051.7625   16  445 12591.1012 16799.5311  33.4%   472  113s
  5938  2337 12850.6789   24   75 12591.1012 16799.5311  33.4%   472  115s
H 5939  2221                    12604.709814 16799.5311  33.3%   472  117s
  5948  2227 13757.1195   56  507 12604.7098 16799.5311  33.3%   471  120s
  5958  2234 13009.2064   25  482 12604.7098 16799.5311  33.3%   470  125s
H 5958  2121                    12605.804248 16799.5311  33.3%   470  125s
  5964  2125 13689.4643   22  542 12605.8042 16799.5311  33.3%   470  131s
  5979  2144 14705.2484   15  387 12605.8042 16799.5311  33.3%   475  135s
  6170  2184 14683.6362   21  266 12605.8042 16799.5311  33.3%   480  140s
  6710  1956 13105.8268   22  254 12605.8042 15387.3605  22.1%   470  145s
* 7271  1661              51    12638.333393 13731.9023  8.65%   441  147s
* 7436  1523              59    12688.112498 13698.2435  7.96%   431  147s
* 7603  1371              64    12727.322163 13698.2435  7.63%   422  147s
* 7730  1197              66    12728.418094 13539.9551  6.38%   416  147s
* 7803  1087              60    12730.632669 13539.9551  6.36%   412  147s
* 7913   973              64    12764.918683 13517.5805  5.90%   407  148s
* 8071   790              68    12767.680783 13437.2387  5.24%   399  148s
* 8080   713              64    12777.355536 13437.2387  5.16%   399  148s

Cutting planes:
  MIR: 259
  Mixing: 1
  Flow cover: 506
  RLT: 2
  Relax-and-lift: 51

Explored 8216 nodes (3269690 simplex iterations) in 148.84 seconds (364.26 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 12777.4 12767.7 12764.9 ... 12604.7

Optimal solution found (tolerance 1.00e-04)
Best objective 1.277735553638e+04, best bound 1.277735553638e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 148.85s
  Master Objective (UB) = 12777.36, θ = 142951.66
  Upper Bound (UB) = 12777.36

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 142951.66
  [DEBUG]   ✓ Scenario 0: θ = 142951.66 ≤ Q = 142951.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 142951.66 ≤ Q = 142951.66 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x1bf10a4a
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xe40ef5b6
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.389664e+13
Presolve removed 2615 rows and 1907 columns
Presolve time: 0.00s
Presolved: 478 rows, 482 columns, 1312 nonzeros
Found heuristic solution: objective 6518237.0175
Variable types: 326 continuous, 156 integer (156 binary)

Root relaxation: objective -1.507538e+05, 225 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -150753.84    0  118 6518237.02 -150753.84   102%     -    0s
H    0     0                    -115918.3154 -150753.84  30.1%     -    0s
H    0     0                    -116959.2310 -150753.84  28.9%     -    0s
H    0     0                    -130178.4236 -150753.84  15.8%     -    0s
     0     0 -138612.53    0   75 -130178.42 -138612.53  6.48%     -    0s
H    0     0                    -136722.8413 -138595.06  1.37%     -    0s
H    0     0                    -137079.9772 -138595.06  1.11%     -    0s
     0     0 -138351.45    0   77 -137079.98 -138351.45  0.93%     -    0s
     0     0 -138326.01    0   77 -137079.98 -138326.01  0.91%     -    0s
H    0     0                    -137280.2507 -138326.01  0.76%     -    0s
     0     0 -137538.66    0   42 -137280.25 -137538.66  0.19%     -    0s
     0     0 -137480.91    0   21 -137280.25 -137480.91  0.15%     -    0s
     0     0 -137469.29    0   20 -137280.25 -137469.29  0.14%     -    0s
     0     0 -137442.28    0   18 -137280.25 -137442.28  0.12%     -    0s
     0     0 -137429.84    0   13 -137280.25 -137429.84  0.11%     -    0s
     0     0 -137417.27    0   12 -137280.25 -137417.27  0.10%     -    0s
     0     0 -137408.40    0   11 -137280.25 -137408.40  0.09%     -    0s
     0     0 -137401.48    0   10 -137280.25 -137401.48  0.09%     -    0s
     0     0 -137351.62    0    8 -137280.25 -137351.62  0.05%     -    0s
     0     0 -137351.62    0   10 -137280.25 -137351.62  0.05%     -    0s
H    0     0                    -137291.1824 -137351.62  0.04%     -    0s
     0     0          -    0      -137291.18 -137302.83  0.01%     -    0s

Cutting planes:
  Implied bound: 3
  MIR: 4
  Flow cover: 6
  Relax-and-lift: 3

Explored 1 nodes (623 simplex iterations) in 0.05 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -137291 -137280 -136975 ... 1.38966e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.372911823729e+05, best bound -1.373028282712e+05, gap 0.0085%
  Subproblem solved in 0.06s
  Worst-case operational profit (Z_SP) = 118594.29
  Scenario: 39 demand increases, 20 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -137291.18
  [DEBUG]   S×d_nominal = 255885.48
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 255885.48 + -137291.18 = 118594.29
  [DEBUG]   Current θ from Master = 142951.66
  [DEBUG]   ⚠️  Z_SP ≤ θ by 24357.37 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -11580.01
  Lower Bound (LB) = 4107.05
  Gap (UB-LB) = 8670.3011, Absolute Gap = 8670.3011, Relative Gap = 0.678568
  Not converged yet (gap = 8670.30 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 39 increases, 20 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135194 nonzeros
Model fingerprint: 0x75de60f9
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -11580 (0.02s)
Loaded MIP start from previous solve with objective -11580

Presolve removed 21876 rows and 8876 columns
Presolve time: 0.40s
Presolved: 25377 rows, 12104 columns, 141859 nonzeros
Variable types: 9845 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...

Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 4.279207e+04, 20191 iterations, 4.01 seconds (7.75 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 42792.0701    0  279 -11580.010 42792.0701   470%     -    4s
H    0     0                    -11253.77705 42792.0701   480%     -    4s
H    0     0                    -8166.451316 42792.0701   624%     -    4s
H    0     0                    -7505.988762 42792.0701   670%     -    4s
H    0     0                    -7326.171543 42792.0701   684%     -    4s
H    0     0                    -6097.771564 42792.0701   802%     -    4s
H    0     0                    -5849.060329 42792.0701   832%     -    4s
H    0     0                    -5809.839637 42792.0701   837%     -    4s
H    0     0                    -4305.034504 42792.0701  1094%     -    4s
H    0     0                    -2299.652388 37102.0519  1713%     -    6s
     0     0 37065.4115    0  497 -2299.6524 37065.4115  1712%     -    6s
H    0     0                    -1988.037270 37065.4115  1964%     -    6s
H    0     0                    -1190.564454 37065.4115  3213%     -    6s
     0     0 36961.9301    0  480 -1190.5645 36961.9301  3205%     -    7s
     0     0 36914.6429    0  490 -1190.5645 36914.6429  3201%     -    7s
     0     0 36914.6429    0  488 -1190.5645 36914.6429  3201%     -    7s
     0     0 30939.4179    0  426 -1190.5645 30939.4179  2699%     -   10s
H    0     0                    -1177.311516 30939.4179  2728%     -   10s
H    0     0                    -1133.655250 30939.4179  2829%     -   10s
     0     0 30273.0416    0  549 -1133.6552 30273.0416  2770%     -   11s
     0     0 30171.4040    0  483 -1133.6552 30171.4040  2761%     -   11s
     0     0 30148.0751    0  499 -1133.6552 30148.0751  2759%     -   12s
     0     0 30146.1794    0  547 -1133.6552 30146.1794  2759%     -   12s
H    0     0                    -804.5104661 26202.7725  3357%     -   16s
     0     0 26202.7725    0  575 -804.51047 26202.7725  3357%     -   16s
     0     0 25446.9425    0  578 -804.51047 25446.9425  3263%     -   17s
     0     0 25285.7772    0  574 -804.51047 25285.7772  3243%     -   18s
     0     0 25242.8155    0  582 -804.51047 25242.8155  3238%     -   18s
     0     0 25210.7767    0  591 -804.51047 25210.7767  3234%     -   18s
     0     0 25199.0582    0  599 -804.51047 25199.0582  3232%     -   18s
     0     0 25198.5703    0  598 -804.51047 25198.5703  3232%     -   18s
     0     0 23240.7873    0  539 -804.51047 23240.7873  2989%     -   23s
     0     0 22770.0811    0  546 -804.51047 22770.0811  2930%     -   24s
H    0     0                    -748.6733066 22703.4817  3132%     -   25s
     0     0 22703.4817    0  552 -748.67331 22703.4817  3132%     -   25s
     0     0 22637.6815    0  557 -748.67331 22637.6815  3124%     -   25s
     0     0 22611.9261    0  556 -748.67331 22611.9261  3120%     -   25s
     0     0 22608.9954    0  558 -748.67331 22608.9954  3120%     -   26s
     0     0 22058.8240    0  549 -748.67331 22058.8240  3046%     -   28s
     0     0 21938.2027    0  559 -748.67331 21938.2027  3030%     -   29s
     0     0 21854.8439    0  562 -748.67331 21854.8439  3019%     -   29s
     0     0 21801.9598    0  570 -748.67331 21801.9598  3012%     -   30s
     0     0 21774.3044    0  634 -748.67331 21774.3044  3008%     -   31s
     0     0 21766.3805    0  655 -748.67331 21766.3805  3007%     -   31s
     0     0 21762.0925    0  640 -748.67331 21762.0925  3007%     -   31s
     0     0 21535.2701    0  513 -748.67331 21535.2701  2976%     -   33s
H    0     0                    -448.5058509 21534.7870  4901%     -   33s
H    0     0                    -262.6697307 21534.7870  8298%     -   33s
     0     0 21447.3314    0  535 -262.66973 21447.3314  8265%     -   34s
     0     0 21419.7277    0  522 -262.66973 21419.7277  8255%     -   35s
     0     0 21410.0207    0  595 -262.66973 21410.0207  8251%     -   35s
     0     0 21406.8730    0  523 -262.66973 21406.8730  8250%     -   35s
     0     0 21191.5788    0  444 -262.66973 21191.5788  8168%     -   37s
     0     0 21154.3771    0  456 -262.66973 21154.3771  8154%     -   38s
     0     0 21141.2993    0  461 -262.66973 21141.2993  8149%     -   38s
     0     0 21123.8440    0  513 -262.66973 21123.8440  8142%     -   38s
     0     0 21122.3942    0  509 -262.66973 21122.3942  8141%     -   38s
     0     0 21043.4404    0  526 -262.66973 21043.4404  8111%     -   40s
H    0     0                    -191.0441566 21043.3087      -     -   40s
     0     0 20966.3279    0  528 -191.04416 20966.3279      -     -   40s
     0     0 20946.3127    0  628 -191.04416 20946.3127      -     -   41s
     0     0 20934.9078    0  630 -191.04416 20934.9078      -     -   41s
     0     0 20932.1050    0  627 -191.04416 20932.1050      -     -   41s
     0     0 20914.6025    0  626 -191.04416 20914.6025      -     -   42s
     0     0 20909.1137    0  476 -191.04416 20909.1137      -     -   43s
     0     0 20897.0159    0  419 -191.04416 20897.0159      -     -   43s
H    0     0                     316.8542950 20892.6255  6494%     -   43s
H    0     0                     350.3725109 20892.6255  5863%     -   43s
H    0     0                    1473.3811555 20892.6255  1318%     -   43s
H    0     0                    1670.2321064 20892.6255  1151%     -   43s
H    0     0                    1727.8247670 20892.6255  1109%     -   43s
H    0     0                    1733.6005849 20892.6255  1105%     -   43s
     0     0 20892.2453    0  414 1733.60058 20892.2453  1105%     -   44s
     0     0 20852.3251    0  632 1733.60058 20852.3251  1103%     -   44s
H    0     0                    1879.4222826 20851.4583  1009%     -   45s
H    0     0                    2278.8816764 20851.4583   815%     -   45s
H    0     0                    2406.3184716 20851.4583   767%     -   45s
     0     0 20842.8490    0  553 2406.31847 20842.8490   766%     -   45s
     0     0 20839.0360    0  619 2406.31847 20839.0360   766%     -   45s
     0     0 20830.4732    0  556 2406.31847 20830.4732   766%     -   46s
     0     0 20830.4647    0  556 2406.31847 20830.4647   766%     -   46s
H    0     0                    2451.9858584 20830.4647   750%     -   49s
H    0     0                    2473.4247745 20830.4647   742%     -   49s
H    0     0                    2507.6765584 20830.4647   731%     -   49s
H    0     0                    2526.6270867 20830.4647   724%     -   49s
H    0     0                    2530.5539341 20830.4647   723%     -   49s
H    0     0                    2532.1455488 20830.4647   723%     -   49s
H    0     0                    2541.9107165 20830.4647   719%     -   52s
H    0     0                    2573.1809952 20830.4647   710%     -   52s
H    0     0                    2615.2352131 20830.4647   697%     -   52s
H    0     0                    4202.3012350 20830.4647   396%     -   52s
H    0     0                    4281.5229139 20830.4647   387%     -   52s
H    0     0                    5151.7582284 20830.4647   304%     -   52s
H    0     0                    5840.0161049 20830.4647   257%     -   52s
H    0     0                    6401.3113141 20830.4647   225%     -   52s
H    0     2                    7334.5716747 20830.4647   184%     -   54s
     0     2 20830.4647    0  556 7334.57167 20830.4647   184%     -   54s
     1     4 20778.9413    1  427 7334.57167 20830.3724   184%   895   56s
     3     8 20630.4297    2  465 7334.57167 20777.8830   183%  2359   60s
    31    60 20123.7845    5  465 7334.57167 20254.1216   176%  4511   76s
    59    92 19840.9551    6  458 7334.57167 20123.0608   174%  4878   80s
H   88    92                    7350.6296153 19840.5602   170%  3906   80s
   231   300 19060.1815   10  409 7350.62962 19840.5154   170%  2408   87s
H  256   300                    7358.1296221 19840.5154   170%  2426   87s
   301   367 16873.5115   11  465 7358.12962 19840.5154   170%  2348   92s
   384   415 15733.0472   11  476 7358.12962 19840.5154   170%  2132   95s
   530   498 14649.8335   13  365 7358.12962 19840.5154   170%  1882  102s
   661   596 15461.5296   14  342 7358.12962 19598.9354   166%  1770  106s
   804   671 13878.9895   18  224 7358.12962 19598.9354   166%  1655  111s
H  810   671                    7370.8367175 19598.9354   166%  1656  111s
   914   764 12518.3055   20  208 7370.83672 19598.9354   166%  1640  115s
H  925   764                    7374.8906154 19598.9354   166%  1630  115s
  1082   923 11541.9305   25  198 7374.89062 19598.9354   166%  1521  121s
  1284  1010 10449.6650   29  173 7374.89062 19340.7217   162%  1410  126s
H 1391  1056                    7487.3782717 19340.7217   158%  1376  128s
  1397  1132 10364.0726   30  191 7487.37827 19340.7217   158%  1374  131s
H 1400  1132                    7639.2585256 19340.7217   153%  1372  131s
H 1441  1132                    7646.3827235 19340.7217   153%  1349  131s
H 1487  1132                    7739.0982512 19340.7217   150%  1324  131s
  1724  1262 9284.26286   37  137 7739.09825 19213.4540   148%  1238  135s
H 1727  1262                    7746.2224491 19213.4540   148%  1238  135s
  1941  1465     cutoff   44      7746.22245 19180.2291   148%  1190  141s
  2315  1676 13746.3120   12  219 7746.22245 19112.9048   147%  1110  146s
  2513  1738 8939.43566   21   93 7746.22245 19112.9048   147%  1082  151s
  2795  1875 14165.7825   13  197 7746.22245 19087.8874   146%  1045  156s
  2874  1957 11818.6368   14  175 7746.22245 19087.8874   146%  1046  161s
  3103  2098 9599.88591   15  179 7746.22245 19087.8874   146%  1015  168s
  3277  2208 9557.09150   16  155 7746.22245 19058.0435   146%  1001  171s
  3487  2335     cutoff   24      7746.22245 19030.8618   146%   980  175s
  3942  2622 infeasible   18      7746.22245 18988.6752   145%   956  182s
H 4152  2621                    7750.5004557 18862.3949   143%   934  182s
  4196  2622 9437.97435   31  556 7750.50046 18862.3949   143%   934  194s
  4198  2623 8780.99845   36  211 7750.50046 18862.3949   143%   933  200s
  4199  2624 9219.67158   50  418 7750.50046 18862.3949   143%   933  206s
  4204  2627 9274.59566   34  496 7750.50046 18862.3949   143%   932  210s
  4215  2635 8439.40500   27  511 7750.50046 18862.3949   143%   930  216s
  4223  2640 16772.2590    8  482 7750.50046 18862.3949   143%   928  220s
  4229  2644 10552.0484   28  520 7750.50046 18862.3949   143%   926  225s
  4235  2648 9357.42486   20  485 7750.50046 18862.3949   143%   925  230s
  4240  2651 11197.1350   14  533 7750.50046 18862.3949   143%   924  235s
  4247  2656 8617.55209   26  503 7750.50046 18862.3949   143%   923  240s
  4252  2659 8439.40500   27  491 7750.50046 18862.3949   143%   921  249s
  4253  2660 11759.0887   17  491 7750.50046 18862.3949   143%   921  254s
  4254  2664 16461.7959   11  417 7750.50046 18862.3949   143%   941  259s
  4256  2667 15424.4501   12  357 7750.50046 18002.0047   132%   942  260s
  4268  2679 14141.3100   14  407 7750.50046 17152.5951   121%   945  265s
  4308  2714     cutoff   16      7750.50046 16297.5063   110%   966  271s
  4376  2757 9337.61730   18  394 7750.50046 14778.2887  90.7%  1000  276s
  4469  2772     cutoff   19      7750.50046 14778.2887  90.7%  1012  280s
H 4480  2634                    9480.1835972 14778.2887  55.9%  1012  280s
H 4642  2430                    9501.7909883 14778.2887  55.5%  1007  284s
H 4658  2304                    9512.9447934 14778.2887  55.3%  1006  284s
H 4675  2184                    9882.2303872 14778.2887  49.5%  1006  284s
  4730  2160 11736.8068   21  221 9882.23039 14778.2887  49.5%  1005  286s
  4889  2087     cutoff   25      9882.23039 12758.5955  29.1%  1002  290s
  5135  1937 11234.0672   23  422 9882.23039 12481.2931  26.3%   992  295s
H 5323  1765                    9892.0761028 11688.6928  18.2%   973  298s
H 5335  1658                    9903.9250323 11688.6928  18.0%   971  298s
  5749  1533 9992.89010   36   39 9903.92503 10705.0258  8.09%   910  300s

Cutting planes:
  Learned: 1
  MIR: 277
  Mixing: 2
  Flow cover: 701
  RLT: 16
  Relax-and-lift: 48

Explored 7234 nodes (5363611 simplex iterations) in 301.27 seconds (736.50 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 9903.93 9892.08 9882.23 ... 7646.38

Optimal solution found (tolerance 1.00e-04)
Best objective 9.903925032281e+03, best bound 9.903925032281e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 301.28s
  Master Objective (UB) = 9903.93, θ = 140103.01
  Upper Bound (UB) = 9903.93

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 140103.01
  [DEBUG]   ✓ Scenario 0: θ = 140103.01 ≤ Q = 140103.01 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 140103.01 ≤ Q = 140103.01 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 140103.01 ≤ Q = 140103.01 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x773c383e
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x88c3c7c2
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.401297e+13
Presolve removed 2614 rows and 1906 columns
Presolve time: 0.00s
Presolved: 479 rows, 483 columns, 1315 nonzeros
Found heuristic solution: objective 6627550.1474
Variable types: 327 continuous, 156 integer (156 binary)

Root relaxation: objective -1.460264e+05, 228 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -146026.36    0  122 6627550.15 -146026.36   102%     -    0s
H    0     0                    -112038.3616 -146026.36  30.3%     -    0s
H    0     0                    -113661.7398 -146026.36  28.5%     -    0s
H    0     0                    -118835.8134 -146026.36  22.9%     -    0s
H    0     0                    -119138.0180 -132821.59  11.5%     -    0s
     0     0 -132821.59    0   73 -119138.02 -132821.59  11.5%     -    0s
H    0     0                    -130168.7938 -132760.55  1.99%     -    0s
H    0     0                    -130516.9120 -132760.55  1.72%     -    0s
H    0     0                    -130778.9498 -132760.55  1.52%     -    0s
H    0     0                    -131127.0680 -132760.55  1.25%     -    0s
     0     0 -132217.60    0   72 -131127.07 -132217.60  0.83%     -    0s
     0     0 -131498.90    0   30 -131127.07 -131498.90  0.28%     -    0s
     0     0 -131497.06    0   29 -131127.07 -131497.06  0.28%     -    0s
H    0     0                    -131155.7521 -131411.53  0.20%     -    0s
     0     0 -131411.53    0   25 -131155.75 -131411.53  0.20%     -    0s
     0     0 -131371.29    0   23 -131155.75 -131371.29  0.16%     -    0s
     0     0 -131361.63    0   21 -131155.75 -131361.63  0.16%     -    0s
     0     0 -131361.31    0   21 -131155.75 -131361.31  0.16%     -    0s
     0     0 -131354.25    0   22 -131155.75 -131354.25  0.15%     -    0s
     0     0 -131353.88    0   22 -131155.75 -131353.88  0.15%     -    0s
     0     0 -131303.58    0   15 -131155.75 -131303.58  0.11%     -    0s
     0     0 -131303.58    0   17 -131155.75 -131303.58  0.11%     -    0s
     0     0 -131200.55    0   11 -131155.75 -131200.55  0.03%     -    0s
H    0     0                    -131189.2856 -131196.85  0.01%     -    0s

Cutting planes:
  Gomory: 7
  Implied bound: 1
  MIR: 2
  Flow cover: 5
  Relax-and-lift: 5

Explored 1 nodes (663 simplex iterations) in 0.05 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -131189 -131156 -131127 ... 6.62755e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.311892856336e+05, best bound -1.311968500351e+05, gap 0.0058%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 118423.23
  Scenario: 37 demand increases, 22 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -131189.29
  [DEBUG]   S×d_nominal = 249612.52
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 249612.52 + -131189.29 = 118423.23
  [DEBUG]   Current θ from Master = 140103.01
  [DEBUG]   ⚠️  Z_SP ≤ θ by 21679.77 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -11775.85
  Lower Bound (LB) = 4107.05
  Gap (UB-LB) = 5796.8706, Absolute Gap = 5796.8706, Relative Gap = 0.585310
  Not converged yet (gap = 5796.87 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 37 increases, 22 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178419 nonzeros
Model fingerprint: 0x0395929e
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -11775.8 (0.02s)
MIP start from previous solve produced solution with objective -11775.8 (0.02s)
Loaded MIP start from previous solve with objective -11775.8

Presolve removed 29128 rows and 11828 columns
Presolve time: 0.52s
Presolved: 33415 rows, 15392 columns, 206359 nonzeros
Variable types: 13133 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 33415 rows, 15392 columns, 206359 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   50472    2.7601476e+04   0.000000e+00   1.637201e+08      5s
Concurrent spin time: 0.01s

Solved with dual simplex

Root relaxation: objective 3.251337e+04, 17489 iterations, 4.71 seconds (9.21 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 32513.3684    0  207 -11775.849 32513.3684   376%     -    5s
H    0     0                    -4002.757926 32513.3684   912%     -    5s
H    0     0                    -2997.255164 32513.3684  1185%     -    5s
H    0     0                    -2124.992019 32513.3684  1630%     -    5s
     0     0 29327.4721    0  246 -2124.9920 29327.4721  1480%     -    8s
     0     0 29079.0965    0  203 -2124.9920 29079.0965  1468%     -    9s
     0     0 28985.3684    0  264 -2124.9920 28985.3684  1464%     -    9s
     0     0 28960.8824    0  264 -2124.9920 28960.8824  1463%     -    9s
     0     0 28960.8280    0  266 -2124.9920 28960.8280  1463%     -    9s
     0     0 25474.8018    0  320 -2124.9920 25474.8018  1299%     -   13s
H    0     0                    -2061.774194 25473.5030  1336%     -   13s
     0     0 25155.4420    0  335 -2061.7742 25155.4420  1320%     -   14s
     0     0 25005.7038    0  374 -2061.7742 25005.7038  1313%     -   15s
     0     0 24864.8186    0  348 -2061.7742 24864.8186  1306%     -   16s
     0     0 24847.2199    0  392 -2061.7742 24847.2199  1305%     -   16s
     0     0 24827.4816    0  391 -2061.7742 24827.4816  1304%     -   17s
     0     0 24822.8427    0  396 -2061.7742 24822.8427  1304%     -   17s
     0     0 24822.4591    0  396 -2061.7742 24822.4591  1304%     -   17s
     0     0 23165.0404    0  454 -2061.7742 23165.0404  1224%     -   22s
H    0     0                    -1470.972386 23163.6482  1675%     -   22s
H    0     0                    -1466.088578 23163.6482  1680%     -   22s
H    0     0                    -1244.452834 22551.7802  1912%     -   24s
H    0     0                    -1160.856835 22551.7802  2043%     -   24s
H    0     0                    -1151.015183 22551.7802  2059%     -   24s
     0     0 22551.7802    0  422 -1151.0152 22551.7802  2059%     -   24s
     0     0 22392.2355    0  429 -1151.0152 22392.2355  2045%     -   25s
     0     0 22246.2361    0  395 -1151.0152 22246.2361  2033%     -   26s
     0     0 22179.0090    0  408 -1151.0152 22179.0090  2027%     -   26s
     0     0 22161.4701    0  411 -1151.0152 22161.4701  2025%     -   27s
     0     0 22138.4379    0  407 -1151.0152 22138.4379  2023%     -   27s
     0     0 22132.8363    0  412 -1151.0152 22132.8363  2023%     -   27s
     0     0 22131.9131    0  416 -1151.0152 22131.9131  2023%     -   27s
H    0     0                    -1096.601805 22131.9131  2118%     -   30s
H    0     0                    -968.9016892 22131.9131  2384%     -   30s
H    0     0                    -345.2637265 22131.9131  6510%     -   30s
H    0     0                    -143.5327074 22131.9131      -     -   30s
     0     0 21346.6038    0  504 -143.53271 21346.6038      -     -   32s
H    0     0                     406.1084528 21345.9205  5156%     -   32s
     0     0 21123.3498    0  518  406.10845 21123.3498  5101%     -   33s
     0     0 20992.4695    0  467  406.10845 20992.4695  5069%     -   34s
     0     0 20951.2302    0  451  406.10845 20951.2302  5059%     -   35s
     0     0 20896.2927    0  459  406.10845 20896.2927  5045%     -   35s
     0     0 20887.1349    0  457  406.10845 20887.1349  5043%     -   35s
     0     0 20881.0399    0  464  406.10845 20881.0399  5042%     -   36s
     0     0 20877.3367    0  467  406.10845 20877.3367  5041%     -   36s
     0     0 20875.5197    0  521  406.10845 20875.5197  5040%     -   36s
     0     0 20873.5084    0  524  406.10845 20873.5084  5040%     -   36s
     0     0 20872.8878    0  458  406.10845 20872.8878  5040%     -   36s
     0     0 20629.5792    0  462  406.10845 20629.5792  4980%     -   38s
H    0     0                     835.6638767 20628.4838  2369%     -   38s
     0     0 20518.4648    0  521  835.66388 20518.4648  2355%     -   39s
     0     0 20498.0229    0  527  835.66388 20498.0229  2353%     -   40s
     0     0 20487.9916    0  523  835.66388 20487.9916  2352%     -   40s
     0     0 20483.2043    0  514  835.66388 20483.2043  2351%     -   40s
     0     0 20481.2567    0  514  835.66388 20481.2567  2351%     -   40s
     0     0 20480.9819    0  522  835.66388 20480.9819  2351%     -   40s
     0     0 20444.1786    0  516  835.66388 20444.1786  2346%     -   41s
H    0     0                     917.9152125 20443.0441  2127%     -   42s
H    0     0                    2742.1272389 20443.0441   646%     -   42s
H    0     0                    4504.5626354 20443.0441   354%     -   42s
H    0     0                    4678.8455277 20443.0441   337%     -   42s
     0     0 20424.0344    0  529 4678.84553 20424.0344   337%     -   42s
     0     0 20420.5969    0  529 4678.84553 20420.5969   336%     -   43s
     0     0 20419.9474    0  530 4678.84553 20419.9474   336%     -   43s
     0     0 20392.0893    0  535 4678.84553 20392.0893   336%     -   43s
     0     0 20388.0169    0  543 4678.84553 20388.0169   336%     -   44s
     0     0 20385.7090    0  532 4678.84553 20385.7090   336%     -   44s
     0     0 20385.5782    0  538 4678.84553 20385.5782   336%     -   44s
     0     0 20381.2862    0  533 4678.84553 20381.2862   336%     -   45s
     0     0 20379.0166    0  539 4678.84553 20379.0166   336%     -   45s
     0     0 20377.6828    0  473 4678.84553 20377.6828   336%     -   46s
     0     0 20376.9852    0  476 4678.84553 20376.9852   336%     -   46s
     0     0 20369.3094    0  481 4678.84553 20369.3094   335%     -   46s
H    0     0                    5549.1629297 20368.3507   267%     -   47s
H    0     0                    5563.2497362 20368.3507   266%     -   47s
H    0     0                    5706.3872382 20368.3507   257%     -   47s
     0     0 20366.3050    0  477 5706.38724 20366.3050   257%     -   47s
     0     0 20366.2742    0  477 5706.38724 20366.2742   257%     -   47s
     0     0 20356.2106    0  542 5706.38724 20356.2106   257%     -   48s
     0     0 20355.7347    0  542 5706.38724 20355.7347   257%     -   48s
H    0     0                    6301.1498942 20355.7347   223%     -   55s
H    0     0                    7192.5018930 20355.7347   183%     -   56s
H    0     0                    7478.6515448 20355.7347   172%     -   56s
H    0     2                    7500.9565487 20355.7347   171%     -   56s
     0     2 20355.7347    0  542 7500.95655 20355.7347   171%     -   56s
     7    16 19698.1042    3  467 7500.95655 19943.2913   166%  3169   61s
    15    32 19224.2914    4  472 7500.95655 19696.0861   163%  4293   65s
    31    61 19151.5589    5  467 7500.95655 19368.5038   158%  5475   72s
    60    93 18937.6395    6  490 7500.95655 19151.2707   155%  5353   75s
H   94   134                    7511.5007955 19039.8950   153%  4254   79s
   133   240 18693.3476    8  468 7511.50080 19039.8950   153%  3378   85s
H  141   240                    7517.4362714 19039.8950   153%  3308   85s
   323   360 17417.0610   10  445 7517.43627 19039.8950   153%  2739   93s
H  356   360                    7529.2513180 19039.8950   153%  2709   93s
   361   422 14830.3232   11  495 7529.25132 19039.8950   153%  2695  100s
   439   451 13746.6834   11  396 7529.25132 19039.8950   153%  2602  106s
H  466   451                    7648.0269565 19039.8950   149%  2643  106s
   474   505 14789.3260   12  496 7648.02696 19039.8950   149%  2674  111s
   541   556 12967.3131   13  519 7648.02696 19039.8950   149%  2639  115s
   650   606 13303.5180   14  523 7648.02696 19039.8950   149%  2554  122s
H  661   606                    8079.3237416 19039.8950   136%  2559  122s
   697   664 12514.4541   15  509 8079.32374 19019.7254   135%  2506  127s
   789   737 12496.1968   16  510 8079.32374 19019.7254   135%  2376  131s
   872   784 12224.0858   19  362 8079.32374 19019.7254   135%  2289  135s
   969   837 11432.0892   21  281 8079.32374 18959.8782   135%  2194  140s
  1163   990 11465.7065   26  389 8079.32374 18919.4777   134%  2085  150s
  1360  1099 9232.39132   32  326 8079.32374 18919.4777   134%  1987  158s
  1478  1189 10103.3076   34  371 8079.32374 18919.4777   134%  1920  163s
  1608  1292 9675.85967   37  279 8079.32374 18714.1101   132%  1857  168s
  1779  1363 8546.75260   45  288 8079.32374 18714.1101   132%  1762  172s
  1908  1434 8856.00839   48  297 8079.32374 18675.7661   131%  1730  177s
  2039  1550 16178.9963   10  458 8079.32374 18675.7661   131%  1707  183s
  2209  1599 15146.2002   10  388 8079.32374 18675.7661   131%  1662  187s
  2270  1690 14450.1231   11  384 8079.32374 18672.6565   131%  1653  190s
  2395  1805 12475.9700   13  468 8079.32374 18672.6565   131%  1617  195s
  2582  1912 13120.0116   11  422 8079.32374 18672.6565   131%  1556  200s
  2766  2040 8981.11716   12  405 8079.32374 18672.6565   131%  1513  205s
  2966  2151 12770.3514   12  418 8079.32374 18672.6565   131%  1474  210s
  3191  2303 11759.9503   14  429 8079.32374 18672.6565   131%  1440  217s
  3429  2469 9792.06248   14  348 8079.32374 18672.6565   131%  1406  222s
  3715  2589 10771.9779   15  371 8079.32374 18672.6565   131%  1359  229s
  3973  2713 9619.10687   17  312 8079.32374 18672.6565   131%  1339  235s
  4202  2714 10519.7551   18  542 8079.32374 18672.6565   131%  1329  252s
  4204  2715 8639.19917   61  207 8079.32374 18672.6565   131%  1329  259s
  4205  2716 10428.7465   23  372 8079.32374 18672.6565   131%  1328  265s
  4207  2717 9932.55189   20  501 8079.32374 18672.6565   131%  1328  272s
  4209  2719 12135.6514   14  505 8079.32374 18672.6565   131%  1327  275s
  4215  2723 11841.1311   14  477 8079.32374 18672.6565   131%  1325  280s
  4220  2726 12140.7995   16  523 8079.32374 18672.6565   131%  1324  287s
  4224  2729 12735.4912   14  486 8079.32374 18672.6565   131%  1322  292s
  4228  2731 11072.6848   28  475 8079.32374 18672.6565   131%  1321  297s
  4231  2733 14762.4715   10  479 8079.32374 18672.6565   131%  1320  302s
  4234  2735 9654.83266   22  532 8079.32374 18672.6565   131%  1319  305s
  4237  2737 9970.23659   26  514 8079.32374 18672.6565   131%  1318  310s
  4240  2739 9360.08279   11  551 8079.32374 18672.6565   131%  1317  315s
  4242  2741 13206.1882   24  582 8079.32374 18672.6565   131%  1317  325s
  4243  2741 9066.63968   16  582 8079.32374 18672.6565   131%  1316  333s
  4244  2745 18672.6565   12  535 8079.32374 18672.6565   131%  1340  339s
  4246  2748 18672.6565   13  504 8079.32374 18672.6565   131%  1341  347s
  4250  2755 18672.6565   14  476 8079.32374 18672.6565   131%  1345  352s
  4258  2768 18672.6565   15  441 8079.32374 18672.6565   131%  1352  361s
  4274  2781 17002.9610   16  408 8079.32374 18672.6565   131%  1372  372s
  4296  2806 16627.0567   17  333 8079.32374 18672.6565   131%  1411  378s
  4328  2873 14860.0312   18  324 8079.32374 18672.6565   131%  1434  385s
  4411  2893 13110.8856   19  336 8079.32374 18672.6565   131%  1490  392s
  4496  2904 12623.6619   20  287 8079.32374 18672.6565   131%  1506  400s
  4562  2930 13130.5228   21  322 8079.32374 18672.6565   131%  1514  407s
  4654  2922 10639.2005   21  283 8079.32374 18672.6565   131%  1515  415s
  4733  2928     cutoff   21      8079.32374 18365.4703   127%  1526  422s
  4817  2929 11141.1176   22  293 8079.32374 18365.4703   127%  1529  426s
  4886  2945 10161.2103   23  243 8079.32374 18365.4703   127%  1534  432s
  4970  2951 9679.42073   24  225 8079.32374 18365.4703   127%  1532  436s
  5027  2963 9069.33972   25  273 8079.32374 18365.4703   127%  1531  443s
  5095  2964 9451.38833   25  213 8079.32374 17888.9393   121%  1534  448s
  5159  2970 8349.14258   27  211 8079.32374 17888.9393   121%  1534  452s
  5237  2961 8938.59860   27  205 8079.32374 17888.9393   121%  1533  458s
  5296  2994     cutoff   29      8079.32374 16800.1692   108%  1535  464s
  5382  3014 11578.5710   19  307 8079.32374 16800.1692   108%  1532  469s
  5481  3016 10732.0487   22  218 8079.32374 16800.1692   108%  1527  475s
  5597  3002 9619.38857   24  302 8079.32374 16310.2755   102%  1520  480s
  5634  3011     cutoff   25      8079.32374 16301.5563   102%  1527  486s
H 5676  2859                    8885.2569990 16301.5563  83.5%  1532  486s
  5678  2874     cutoff   24      8885.25700 16301.5563  83.5%  1532  491s
  5788  2881 12747.4727   18  319 8885.25700 16301.5563  83.5%  1535  499s
H 5789  2750                    9363.4709900 16301.5563  74.1%  1535  499s
  5883  2703 12613.5244   19  318 9363.47099 15347.3830  63.9%  1538  505s
  6015  2670 9445.64244   21  273 9363.47099 15137.8094  61.7%  1536  512s
H 6020  2544                    9385.9529008 15137.8094  61.3%  1536  512s
H 6022  2424                    9545.4498709 15137.8094  58.6%  1537  512s
  6128  2393     cutoff   22      9545.44987 14926.0664  56.4%  1536  519s
  6240  2392 12127.0500   22  353 9545.44987 14545.7051  52.4%  1542  526s
H 6246  2278                    9552.5740688 14545.7051  52.3%  1543  526s
H 6306  2152                    9585.0967399 14545.7051  51.8%  1544  526s
  6357  2148 11025.5527   23  242 9585.09674 14545.7051  51.8%  1544  531s
H 6360  2045                    9592.2209378 14545.7051  51.6%  1544  531s
H 6363  1948                    9607.5432420 14545.7051  51.4%  1545  531s
  6485  1953 9704.40761   25  306 9607.54324 14335.6874  49.2%  1538  536s
  6655  1919     cutoff   30      9607.54324 14128.0843  47.1%  1527  542s
  6840  1878     cutoff   22      9607.54324 14062.5291  46.4%  1517  549s
H 6881  1773                    9608.6376765 13733.5004  42.9%  1517  549s
  7036  1739 10888.1636   24  283 9608.63768 13556.7827  41.1%  1508  558s
  7234  1700 10095.9384   32  190 9608.63768 13556.7827  41.1%  1498  566s
  7454  1660     cutoff   23      9608.63768 13357.6158  39.0%  1486  573s
  7702  1600 11828.0530   21  288 9608.63768 13357.6158  39.0%  1472  580s
  7956  1524     cutoff   25      9608.63768 13357.6158  39.0%  1458  588s
  8246  1425     cutoff   24      9608.63768 13357.6158  39.0%  1437  596s
  8582  1407 infeasible   29      9608.63768 12213.0487  27.1%  1412  603s
  9126  1207 9630.08478   56   90 9608.63768 11982.3073  24.7%  1358  609s
  9717  1054 10827.8377   32   63 9608.63768 11762.9316  22.4%  1304  615s
H 9988  1054                    9608.9853537 11625.1371  21.0%  1279  615s
H10208  1054                    9614.9134682 11625.1371  20.9%  1262  615s
 10281   749 10808.7776   27  197 9614.91347 11564.7540  20.3%  1256  620s
 11302   382 infeasible   31      9614.91347 10977.6282  14.2%  1169  625s

Cutting planes:
  Learned: 1
  MIR: 527
  Mixing: 2
  Flow cover: 1093
  RLT: 24
  Relax-and-lift: 93

Explored 14151 nodes (13580442 simplex iterations) in 628.33 seconds (1790.64 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 9614.91 9608.99 9608.64 ... 9363.47

Optimal solution found (tolerance 1.00e-04)
Best objective 9.614913468227e+03, best bound 9.614913468227e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 628.33s
  Master Objective (UB) = 9614.91, θ = 140902.50
  Upper Bound (UB) = 9614.91

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 140902.50
  [DEBUG]   ✓ Scenario 0: θ = 140902.50 ≤ Q = 140902.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 140902.50 ≤ Q = 140902.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 140902.50 ≤ Q = 140920.82 (slack: 18.32)
  [DEBUG]   ✓ Scenario 3: θ = 140902.50 ≤ Q = 140902.50 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x142b61f4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x142b61f4
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.394011e+13
Presolve removed 2614 rows and 1906 columns
Presolve time: 0.00s
Presolved: 479 rows, 483 columns, 1315 nonzeros
Found heuristic solution: objective 6661218.4035
Variable types: 327 continuous, 156 integer (156 binary)

Root relaxation: objective -1.377335e+05, 227 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -137733.46    0  120 6661218.40 -137733.46   102%     -    0s
H    0     0                    -104439.8472 -137733.46  31.9%     -    0s
H    0     0                    -104913.7292 -137733.46  31.3%     -    0s
H    0     0                    -111498.4364 -137733.46  23.5%     -    0s
H    0     0                    -112443.7840 -122328.92  8.79%     -    0s
H    0     0                    -113238.9602 -122328.92  8.03%     -    0s
     0     0 -122328.92    0  120 -113238.96 -122328.92  8.03%     -    0s
H    0     0                    -118151.8820 -122245.27  3.46%     -    0s
     0     0 -121475.82    0  121 -118151.88 -121475.82  2.81%     -    0s
H    0     0                    -120008.4276 -121450.35  1.20%     -    0s
H    0     0                    -120196.9255 -121450.35  1.04%     -    0s
     0     0 -121153.40    0  120 -120196.93 -121153.40  0.80%     -    0s
     0     0 -121117.59    0  120 -120196.93 -121117.59  0.77%     -    0s
     0     0 -120763.17    0   58 -120196.93 -120763.17  0.47%     -    0s
     0     0 -120595.95    0   60 -120196.93 -120595.95  0.33%     -    0s
     0     0 -120593.76    0   70 -120196.93 -120593.76  0.33%     -    0s
     0     0 -120398.89    0   22 -120196.93 -120398.89  0.17%     -    0s
     0     0 -120398.46    0   14 -120196.93 -120398.46  0.17%     -    0s
     0     0 -120277.21    0    9 -120196.93 -120277.21  0.07%     -    0s
     0     0 -120242.60    0    8 -120196.93 -120242.60  0.04%     -    0s
     0     0 -120242.60    0   11 -120196.93 -120242.60  0.04%     -    0s
     0     0          -    0      -120196.93 -120206.83  0.01%     -    0s

Cutting planes:
  Gomory: 5
  Implied bound: 3
  MIR: 3
  Flow cover: 6
  Relax-and-lift: 3

Explored 1 nodes (789 simplex iterations) in 0.08 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -120197 -119503 -119156 ... 1.39401e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.201969254815e+05, best bound -1.202068272245e+05, gap 0.0082%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 127053.28
  Scenario: 59 demand increases, 0 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -120196.93
  [DEBUG]   S×d_nominal = 247250.20
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 247250.20 + -120196.93 = 127053.28
  [DEBUG]   Current θ from Master = 140902.50
  [DEBUG]   ⚠️  Z_SP ≤ θ by 13849.22 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -4234.30
  Lower Bound (LB) = 4107.05
  Gap (UB-LB) = 5507.8591, Absolute Gap = 5507.8591, Relative Gap = 0.572845
  Not converged yet (gap = 5507.86 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 59 increases, 0 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221644 nonzeros
Model fingerprint: 0xe91e5220
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 36400 rows and 14780 columns
Presolve time: 0.65s
Presolved: 41433 rows, 18680 columns, 256599 nonzeros
Variable types: 16421 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -333055.8495
Found heuristic solution: objective -217726.0351

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 41433 rows, 18680 columns, 256599 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   33347    4.6325023e+03   0.000000e+00   4.906795e+06      5s
   50285    2.4878359e+04   0.000000e+00   1.037605e+06     10s
Concurrent spin time: 0.39s

Solved with dual simplex

Root relaxation: objective 3.025491e+04, 31105 iterations, 9.66 seconds (19.39 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 30254.9087    0  196 -217726.04 30254.9087   114%     -   10s
H    0     0                    -209819.7884 30254.9087   114%     -   10s
H    0     0                    -110008.0526 30254.9087   128%     -   10s
H    0     0                    -109175.9623 30254.9087   128%     -   10s
H    0     0                    -91500.36754 30254.9087   133%     -   10s
H    0     0                    -75124.15541 30254.9087   140%     -   10s
H    0     0                    -74860.72590 30254.9087   140%     -   10s
H    0     0                    -71403.30210 30254.9087   142%     -   10s
H    0     0                    -70561.91617 30254.9087   143%     -   10s
H    0     0                    -68358.95969 30254.9087   144%     -   10s
H    0     0                    -62590.21288 30254.9087   148%     -   11s
H    0     0                    -26479.73808 30254.9087   214%     -   11s
H    0     0                    -26284.47654 30254.9087   215%     -   11s
H    0     0                    -26169.64888 30254.9087   216%     -   11s
H    0     0                    -18531.38940 30254.9087   263%     -   11s
H    0     0                    -14955.14469 30254.9087   302%     -   11s
     0     0 26577.1634    0  210 -14955.145 26577.1634   278%     -   14s
H    0     0                    -12439.86057 26575.1003   314%     -   14s
H    0     0                    -10500.11110 26575.1003   353%     -   14s
     0     0 26181.4069    0  220 -10500.111 26181.4069   349%     -   15s
     0     0 25955.2745    0  215 -10500.111 25955.2745   347%     -   15s
     0     0 25955.2745    0  219 -10500.111 25955.2745   347%     -   16s
     0     0 25955.2745    0  219 -10500.111 25955.2745   347%     -   16s
     0     0 25955.2745    0  219 -10500.111 25955.2745   347%     -   16s
H    0     0                    -7164.152992 23011.3966   421%     -   19s
     0     0 22892.6141    0  315 -7164.1530 22892.6141   420%     -   19s
H    0     0                    -1824.589329 22892.6141  1355%     -   19s
H    0     0                    -1700.780080 22892.6141  1446%     -   19s
H    0     0                    -1584.327279 22892.6141  1545%     -   19s
H    0     0                    -1450.443887 22892.6141  1678%     -   19s
H    0     0                    -1156.643719 22892.6141  2079%     -   19s
     0     0 22365.3216    0  338 -1156.6437 22365.3216  2034%     -   21s
     0     0 22239.2655    0  335 -1156.6437 22239.2655  2023%     -   23s
     0     0 22172.8587    0  346 -1156.6437 22172.8587  2017%     -   23s
     0     0 22158.2439    0  341 -1156.6437 22158.2439  2016%     -   23s
     0     0 22149.6168    0  342 -1156.6437 22149.6168  2015%     -   24s
     0     0 22148.2863    0  348 -1156.6437 22148.2863  2015%     -   24s
     0     0 22132.9057    0  343 -1156.6437 22132.9057  2014%     -   24s
     0     0 22131.1866    0  339 -1156.6437 22131.1866  2013%     -   24s
     0     0 22130.8118    0  341 -1156.6437 22130.8118  2013%     -   24s
     0     0 20626.3730    0  404 -1156.6437 20626.3730  1883%     -   31s
H    0     0                    -1154.583730 20626.0635  1886%     -   31s
H    0     0                    -1006.260465 20626.0635  2150%     -   31s
H    0     0                    -990.8247075 20626.0635  2182%     -   31s
H    0     0                    -921.4172786 20626.0635  2339%     -   31s
H    0     0                    -866.6008536 20626.0635  2480%     -   31s
H    0     0                    -861.6427826 20626.0635  2494%     -   31s
H    0     0                    -858.0618952 20626.0635  2504%     -   31s
H    0     0                    -413.8013389 20013.2867  4936%     -   34s
H    0     0                       9.3492283 20013.2867      -     -   34s
H    0     0                      89.9237765 20013.2867      -     -   34s
H    0     0                     108.3261131 20013.2867      -     -   34s
H    0     0                     512.0038837 20013.2867  3809%     -   34s
H    0     0                     519.1280816 20013.2867  3755%     -   34s
     0     0 20013.2867    0  457  519.12808 20013.2867  3755%     -   34s
     0     0 19693.5411    0  453  519.12808 19693.5411  3694%     -   36s
     0     0 19524.3612    0  457  519.12808 19524.3612  3661%     -   38s
     0     0 19456.6914    0  457  519.12808 19456.6914  3648%     -   38s
     0     0 19430.3348    0  466  519.12808 19430.3348  3643%     -   39s
     0     0 19409.5265    0  461  519.12808 19409.5265  3639%     -   39s
H    0     0                     638.9205605 19408.6221  2938%     -   39s
H    0     0                     640.0087878 19408.6221  2933%     -   39s
H    0     0                     668.0388432 19408.6221  2805%     -   39s
H    0     0                     671.8249431 19408.6221  2789%     -   39s
H    0     0                     694.9897557 19408.6221  2693%     -   39s
H    0     0                     711.4718121 19408.6221  2628%     -   39s
H    0     0                     714.5974848 19408.6221  2616%     -   39s
     0     0 19408.6221    0  472  714.59748 19408.6221  2616%     -   39s
H    0     0                     717.1585443 19408.6221  2606%     -   42s
     0     0 18868.4506    0  439  717.15854 18868.4506  2531%     -   46s
H    0     0                     762.1176599 18868.1281  2376%     -   46s
H    0     0                     766.1267979 18868.1281  2363%     -   46s
     0     0 18702.1430    0  488  766.12680 18702.1430  2341%     -   48s
     0     0 18640.8369    0  503  766.12680 18640.8369  2333%     -   49s
     0     0 18601.4204    0  446  766.12680 18601.4204  2328%     -   50s
     0     0 18593.8213    0  450  766.12680 18593.8213  2327%     -   50s
     0     0 18587.0586    0  450  766.12680 18587.0586  2326%     -   50s
     0     0 18584.3382    0  451  766.12680 18584.3382  2326%     -   50s
     0     0 18579.3236    0  456  766.12680 18579.3236  2325%     -   50s
     0     0 18575.6636    0  458  766.12680 18575.6636  2325%     -   51s
     0     0 18575.2280    0  458  766.12680 18575.2280  2325%     -   51s
     0     0 18474.7771    0  502  766.12680 18474.7771  2311%     -   52s
H    0     0                     767.1499434 18469.6548  2308%     -   53s
H    0     0                     775.5950017 18469.6548  2281%     -   53s
H    0     0                     782.7191997 18469.6548  2260%     -   53s
H    0     0                    1927.9316693 18408.9144   855%     -   54s
H    0     0                    2382.6553555 18408.9144   673%     -   54s
H    0     0                    2508.1928749 18408.9144   634%     -   54s
H    0     0                    3236.0898892 18408.9144   469%     -   54s
H    0     0                    3297.0134083 18408.9144   458%     -   54s
H    0     0                    3317.5426466 18408.9144   455%     -   54s
H    0     0                    3390.7594072 18408.9144   443%     -   54s
     0     0 18408.9144    0  520 3390.75941 18408.9144   443%     -   54s
     0     0 18399.7957    0  513 3390.75941 18399.7957   443%     -   54s
     0     0 18394.7419    0  517 3390.75941 18394.7419   442%     -   54s
     0     0 18385.7307    0  511 3390.75941 18385.7307   442%     -   55s
     0     0 18384.2515    0  512 3390.75941 18384.2515   442%     -   55s
     0     0 18383.6310    0  518 3390.75941 18383.6310   442%     -   55s
     0     0 18327.0042    0  448 3390.75941 18327.0042   440%     -   56s
H    0     0                    3425.9949472 18325.3725   435%     -   57s
     0     0 18312.5408    0  449 3425.99495 18312.5408   435%     -   57s
     0     0 18310.2413    0  452 3425.99495 18310.2413   434%     -   57s
     0     0 18309.5559    0  451 3425.99495 18309.5559   434%     -   57s
H    0     0                    3433.0376252 18293.4529   433%     -   58s
H    0     0                    3485.8613992 18293.4529   425%     -   58s
     0     0 18293.4529    0  448 3485.86140 18293.4529   425%     -   58s
H    0     0                    3513.8793742 18291.0675   421%     -   58s
H    0     0                    3555.1202910 18291.0675   414%     -   58s
     0     0 18288.8697    0  454 3555.12029 18288.8697   414%     -   58s
     0     0 18288.6812    0  453 3555.12029 18288.6812   414%     -   58s
     0     0 18280.9529    0  446 3555.12029 18280.9529   414%     -   59s
H    0     0                    3555.2907857 18280.1527   414%     -   59s
     0     0 18279.8703    0  453 3555.29079 18279.8703   414%     -   59s
     0     0 18273.4742    0  445 3555.29079 18273.4742   414%     -   60s
     0     0 18261.8075    0  447 3555.29079 18261.8075   414%     -   60s
     0     0 18260.2498    0  489 3555.29079 18260.2498   414%     -   60s
     0     0 18259.8168    0  483 3555.29079 18259.8168   414%     -   60s
     0     0 18258.3083    0  480 3555.29079 18258.3083   414%     -   61s
H    0     0                    3569.7119524 18256.8479   411%     -   61s
     0     0 18256.8479    0  483 3569.71195 18256.8479   411%     -   61s
     0     0 18256.8479    0  473 3569.71195 18256.8479   411%     -   62s
     0     0 18256.7265    0  486 3569.71195 18256.7265   411%     -   62s
     0     0 18256.5514    0  486 3569.71195 18256.5514   411%     -   63s
     0     0 18256.2997    0  488 3569.71195 18256.2997   411%     -   63s
     0     0 18253.0239    0  483 3569.71195 18253.0239   411%     -   64s
     0     0 18252.1189    0  483 3569.71195 18252.1189   411%     -   64s
H    0     0                    3634.4908879 18250.6150   402%     -   72s
H    0     0                    4360.9635608 18250.6150   318%     -   72s
H    0     0                    6019.0545234 18250.6150   203%     -   72s
H    0     2                    6028.6308305 18250.6150   203%     -   73s
     0     2 18250.6150    0  483 6028.63083 18250.6150   203%     -   73s
     1     4 18145.9761    1  434 6028.63083 18243.9520   203%  1068   76s
     7    16 17803.6831    3  445 6028.63083 18070.3650   200%  2753   82s
    31    48 15711.7018    5  376 6028.63083 17678.9298   193%  5418   93s
    47    80 13743.7228    6  377 6028.63083 17678.9298   193%  6855   96s
H   48    80                    6131.9423777 17678.9298   188%  6712   96s
H   48    80                    6203.6515096 17678.9298   185%  6712   96s
H   51    80                    6504.8688553 17678.9298   172%  6598   96s
    79   144 13682.6328    7  355 6504.86886 17678.9298   172%  5323  103s
H  143   261                    6517.3330378 17678.9298   171%  4092  109s
H  143   261                    6525.3556608 17678.9298   171%  4092  109s
H  175   261                    6641.6774084 17678.9298   166%  3627  109s
   260   330 13124.6835   11  344 6641.67741 17678.9298   166%  2920  112s
   329   381 10379.9798   12  241 6641.67741 17678.9298   166%  2800  116s
   384   438 12024.4115   12  340 6641.67741 17678.9298   166%  2680  120s
   457   472 12704.4098   12  343 6641.67741 17678.9298   166%  2514  125s
   518   510 11241.9776   13  319 6641.67741 17678.9298   166%  2474  131s
   600   543 9630.72348   13  328 6641.67741 17593.8944   165%  2351  138s
   672   604 7083.17380   13  334 6641.67741 17593.8944   165%  2291  142s
   751   646 10777.0567   13  315 6641.67741 17160.7337   158%  2254  147s
   829   705 9222.25251   14  308 6641.67741 17160.7337   158%  2194  152s
   912   728     cutoff   14      6641.67741 17160.7337   158%  2156  155s
   951   750 6660.43788   15  202 6641.67741 17160.7337   158%  2165  160s
  1033   791     cutoff   16      6641.67741 16239.5044   145%  2148  168s
  1076   812 12779.0759    8  380 6641.67741 16238.3756   144%  2160  171s
  1129   830 11064.8625    8  333 6641.67741 16238.3756   144%  2124  177s
  1202   852 12715.8020    9  366 6641.67741 16238.3756   144%  2075  182s
  1252   877 11904.9781   10  289 6641.67741 16044.6411   142%  2082  187s
  1305   918 11119.7254   11  255 6641.67741 16044.6411   142%  2093  191s
  1372   962 9548.39474   13  219 6641.67741 16044.6411   142%  2081  197s
  1458  1010 9287.11020   16  205 6641.67741 16044.6411   142%  2063  201s
  1584  1068 8847.36496   21  197 6641.67741 16044.6411   142%  2000  206s
  1719  1147 8698.48840   22  191 6641.67741 15989.7345   141%  1940  211s
  1858  1178 8236.87562   24  190 6641.67741 15989.7345   141%  1889  218s
  1919  1227 8201.37389   25  179 6641.67741 15781.1472   138%  1903  224s
  2040  1299     cutoff   26      6641.67741 15707.0994   136%  1880  232s
  2162  1379 7265.51097   32  169 6641.67741 15528.9548   134%  1876  237s
  2329  1442 13292.6069   10  308 6641.67741 15528.9548   134%  1838  242s
  2509  1543 12242.4073   12  246 6641.67741 15528.9548   134%  1803  248s
  2701  1649 11325.1679   15  236 6641.67741 15528.9548   134%  1766  253s
  2941  1781 10652.3608   23  190 6641.67741 15528.9548   134%  1710  259s
  3201  1870 9735.73362   32  254 6641.67741 15528.9548   134%  1656  266s
  3435  1915 7082.83382   53  124 6641.67741 15357.7169   131%  1633  273s
  3621  1999 10395.8810   12  276 6641.67741 15330.7570   131%  1635  279s
H 3732  1983                    6902.0232654 15330.7570   122%  1624  279s
  3791  2061 8928.58481   14  253 6902.02327 15330.7570   122%  1619  286s
  4022  2137 7320.14341   18  274 6902.02327 15330.7570   122%  1603  293s
  4248  2226 12281.6188   10  285 6902.02327 15330.7570   122%  1601  300s
  4478  2335 8932.98171   12  244 6902.02327 15244.2860   121%  1595  307s
  4724  2427 7183.38745   18  166 6902.02327 15177.2734   120%  1592  315s
H 4983  2073                    7768.5952210 15156.8626  95.1%  1586  322s
H 5022  2049                    7827.6942264 15156.8626  93.6%  1589  326s
  5023  2033 11657.5336   16  483 7827.69423 15156.8626  93.6%  1589  343s
  5025  2034 8444.45027   18  196 7827.69423 15156.8626  93.6%  1588  361s
  5026  2035 9373.57113   29  359 7827.69423 15156.8626  93.6%  1588  370s
  5027  2036 10994.6534   17  406 7827.69423 15156.8626  93.6%  1588  377s
  5028  2036 9595.24967   24  439 7827.69423 15156.8626  93.6%  1587  381s
  5031  2038 11406.3008    8  444 7827.69423 15156.8626  93.6%  1586  386s
  5036  2042 8023.91019   42  442 7827.69423 15156.8626  93.6%  1585  391s
  5038  2043 9251.75243   12  464 7827.69423 15156.8626  93.6%  1584  395s
  5042  2046 10701.4206   15  499 7827.69423 15156.8626  93.6%  1583  400s
  5044  2047 9119.43333   17  499 7827.69423 15156.8626  93.6%  1582  405s
  5047  2049 9431.05236   23  517 7827.69423 15156.8626  93.6%  1581  411s
  5050  2051 8887.46777   18  508 7827.69423 15156.8626  93.6%  1580  417s
  5053  2053 10333.3888   17  457 7827.69423 15156.8626  93.6%  1579  422s
  5055  2054 9075.98327   17  453 7827.69423 15156.8626  93.6%  1579  426s
  5058  2056 9801.10672   14  459 7827.69423 15156.8626  93.6%  1578  446s
  5059  2057 11727.2447    9  459 7827.69423 15156.8626  93.6%  1578  455s
  5060  2061 15156.8626   12  509 7827.69423 15156.8626  93.6%  1606  478s
  5062  2064 15156.8626   13  502 7827.69423 15156.8626  93.6%  1607  487s
  5066  2071 15156.8626   14  499 7827.69423 15156.8626  93.6%  1611  494s
  5074  2084 15156.8626   15  546 7827.69423 15156.8626  93.6%  1618  499s
  5090  2099 15156.8626   16  495 7827.69423 15156.8626  93.6%  1641  511s
  5112  2121 13754.2251   17  344 7827.69423 15156.8626  93.6%  1669  515s
  5144  2173 12816.4295   18  332 7827.69423 15156.8626  93.6%  1688  522s
  5208  2216 12140.8562   19  321 7827.69423 15156.8626  93.6%  1727  528s
  5288  2233 11495.6471   20  229 7827.69423 15156.8626  93.6%  1753  535s
H 5347  2109                    7916.2657576 15156.8626  91.5%  1761  535s
  5364  2123 10573.4193   22  249 7916.26576 15156.8626  91.5%  1762  540s
  5405  2127 10140.2980   23  179 7916.26576 15156.8626  91.5%  1764  546s
  5447  2122     cutoff   24      7916.26576 15156.8626  91.5%  1776  555s
  5507  2090     cutoff   22      7916.26576 15156.8626  91.5%  1781  563s
  5572  2066 8932.17720   23  269 7916.26576 15156.8626  91.5%  1786  570s
  5631  2057     cutoff   25      7916.26576 15156.8626  91.5%  1801  577s
  5677  2058 9175.86499   27  268 7916.26576 15156.8626  91.5%  1809  584s
  5724  2063 8837.25185   29  239 7916.26576 15156.8626  91.5%  1817  590s
  5763  2052     cutoff   30      7916.26576 15156.8626  91.5%  1822  597s
  5819  2034     cutoff   29      7916.26576 15156.8626  91.5%  1831  603s
  5886  2028 13169.6793   18  356 7916.26576 15156.8626  91.5%  1838  607s
  5947  2009 12758.6283   19  274 7916.26576 15156.8626  91.5%  1847  613s
  6016  2007 10669.7672   20  210 7916.26576 15156.8626  91.5%  1858  620s
  6089  2014 10220.9854   22  234 7916.26576 14727.4269  86.0%  1867  626s
  6158  1992 10051.3795   24  174 7916.26576 13571.2688  71.4%  1877  633s
  6268  1956     cutoff   26      7916.26576 13489.8544  70.4%  1883  641s
  6343  1951 8681.84197   28   81 7916.26576 13489.8544  70.4%  1888  649s
  6435  1935     cutoff   30      7916.26576 13468.3580  70.1%  1896  657s
  6551  1894 10752.8837   19  311 7916.26576 13468.3580  70.1%  1899  666s
  6659  1864 8004.72743   20  270 7916.26576 13468.3580  70.1%  1905  673s
  6773  1825     cutoff   21      7916.26576 12283.8875  55.2%  1913  681s
  6886  1792 10435.7008   21  258 7916.26576 12260.9730  54.9%  1924  689s
  7004  1757     cutoff   24      7916.26576 12152.8561  53.5%  1932  699s
  7159  1691 8684.85342   22  324 7916.26576 12152.8561  53.5%  1931  708s
  7233  1656     cutoff   23      7916.26576 12152.8561  53.5%  1935  715s
  7332  1608 infeasible   24      7916.26576 11443.9969  44.6%  1939  724s
  7474  1510     cutoff   23      7916.26576 11266.4656  42.3%  1944  733s
  7679  1398     cutoff   29      7916.26576 10751.3447  35.8%  1941  740s
  7887  1225     cutoff   26      7916.26576 10737.3944  35.6%  1931  749s
  8184   947     cutoff   30      7916.26576 10023.2027  26.6%  1901  755s

Cutting planes:
  Learned: 1
  MIR: 339
  Mixing: 2
  Flow cover: 829
  RLT: 20
  Relax-and-lift: 106

Explored 8563 nodes (15971108 simplex iterations) in 759.55 seconds (2217.18 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 7916.27 7827.69 7768.6 ... 6131.94

Optimal solution found (tolerance 1.00e-04)
Best objective 7.916265757630e+03, best bound 7.916265757630e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 759.56s
  Master Objective (UB) = 7916.27, θ = 145410.17
  Upper Bound (UB) = 7916.27

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 145410.17
  [DEBUG]   ✓ Scenario 0: θ = 145410.17 ≤ Q = 145410.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 145410.17 ≤ Q = 145410.17 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 145410.17 ≤ Q = 145410.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 145410.17 ≤ Q = 145410.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 145410.17 ≤ Q = 145410.17 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x30373063
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x30373063
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [8e-13, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [2e-14, 2e+02]
Found heuristic solution: objective 1.196870e+13
Presolve removed 2613 rows and 1904 columns
Presolve time: 0.00s
Presolved: 480 rows, 485 columns, 1318 nonzeros
Found heuristic solution: objective 5524348.1796
Variable types: 329 continuous, 156 integer (156 binary)

Root relaxation: objective -1.475215e+05, 228 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -147521.49    0  121 5524348.18 -147521.49   103%     -    0s
H    0     0                    -114002.7942 -147521.49  29.4%     -    0s
H    0     0                    -114867.6146 -147521.49  28.4%     -    0s
     0     0 -119979.24    0   77 -114867.61 -119979.24  4.45%     -    0s
H    0     0                    -117034.3330 -119944.78  2.49%     -    0s
     0     0 -119357.41    0   82 -117034.33 -119357.41  1.98%     -    0s
H    0     0                    -117190.4264 -119342.16  1.84%     -    0s
     0     0 -119342.16    0   82 -117190.43 -119342.16  1.84%     -    0s
H    0     0                    -117583.8464 -119155.59  1.34%     -    0s
     0     0 -119155.59    0   57 -117583.85 -119155.59  1.34%     -    0s
H    0     0                    -117824.1167 -119139.50  1.12%     -    0s
H    0     0                    -118261.1589 -119139.50  0.74%     -    0s
     0     0 -119037.68    0   50 -118261.16 -119037.68  0.66%     -    0s
H    0     0                    -118609.1208 -119021.88  0.35%     -    0s
     0     0 -118999.57    0   36 -118609.12 -118999.57  0.33%     -    0s
     0     0 -118973.36    0   36 -118609.12 -118973.36  0.31%     -    0s
     0     0 -118953.94    0   36 -118609.12 -118953.94  0.29%     -    0s
     0     2 -118953.94    0   36 -118609.12 -118953.94  0.29%     -    0s
*    8     6               3    -118668.2215 -118915.66  0.21%  11.9    0s

Cutting planes:
  Gomory: 28
  Implied bound: 3
  MIR: 166
  Flow cover: 7
  RLT: 17
  Relax-and-lift: 5

Explored 31 nodes (756 simplex iterations) in 0.09 seconds (0.06 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -118668 -118609 -118261 ... 5.52435e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.186682214990e+05, best bound -1.186764074800e+05, gap 0.0069%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 142516.37
  Scenario: 6 demand increases, 53 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -118668.22
  [DEBUG]   S×d_nominal = 261184.59
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 261184.59 + -118668.22 = 142516.37
  [DEBUG]   Current θ from Master = 145410.17
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2893.80 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 5022.47
  Lower Bound (LB) = 5022.47
  Gap (UB-LB) = 2893.7974, Absolute Gap = 2893.7974, Relative Gap = 0.365551
  Not converged yet (gap = 2893.80 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 6 increases, 53 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 264869 nonzeros
Model fingerprint: 0xb1b946df
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 43712 rows and 17752 columns
Presolve time: 0.78s
Presolved: 49411 rows, 21948 columns, 306719 nonzeros
Variable types: 19689 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -333055.8495
Found heuristic solution: objective -217726.0351

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 49411 rows, 21948 columns, 306719 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   34187    3.7968090e+03   0.000000e+00   2.244276e+07      5s
   45170    8.1860196e+03   0.000000e+00   4.990024e+08     10s
   56379    1.5034723e+04   0.000000e+00   8.109468e+05     15s
Concurrent spin time: 2.15s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 3.025156e+04, 47791 iterations, 17.27 seconds (35.81 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 30251.5582    0  198 -217726.04 30251.5582   114%     -   18s
H    0     0                    -214356.3729 30251.5582   114%     -   18s
H    0     0                    -105232.0474 30251.5582   129%     -   18s
H    0     0                    -79100.64716 30251.5582   138%     -   18s
H    0     0                    -77652.50277 30251.5582   139%     -   18s
H    0     0                    -75198.50930 30251.5582   140%     -   18s
H    0     0                    -69429.76249 30251.5582   144%     -   18s
H    0     0                    -31415.94654 30251.5582   196%     -   18s
H    0     0                    -9997.373414 30251.5582   403%     -   18s
H    0     0                    -6310.715033 30251.5582   579%     -   18s
H    0     0                    -5558.026611 30251.5582   644%     -   19s
H    0     0                    -5444.651928 30251.5582   656%     -   19s
H    0     0                    -5424.965518 30251.5582   658%     -   19s
     0     0 27220.9859    0  231 -5424.9655 27220.9859   602%     -   23s
     0     0 26483.5701    0  243 -5424.9655 26483.5701   588%     -   26s
     0     0 26477.2977    0  235 -5424.9655 26477.2977   588%     -   27s
     0     0 26477.2977    0  242 -5424.9655 26477.2977   588%     -   27s
     0     0 26477.2977    0  249 -5424.9655 26477.2977   588%     -   27s
     0     0 26477.2977    0  243 -5424.9655 26477.2977   588%     -   27s
     0     0 26477.2977    0  246 -5424.9655 26477.2977   588%     -   28s
     0     0 26477.2977    0  246 -5424.9655 26477.2977   588%     -   28s
     0     0 23286.5797    0  336 -5424.9655 23286.5797   529%     -   37s
H    0     0                    -3421.480844 23286.3950   781%     -   37s
H    0     0                    -2936.930631 23286.3950   893%     -   37s
H    0     0                    -2899.557229 23286.3950   903%     -   37s
H    0     0                    -2864.965268 23286.3950   913%     -   37s
H    0     0                    -2855.643305 23286.3950   915%     -   37s
H    0     0                    -2854.490251 23286.3950   916%     -   37s
H    0     0                    -2815.455923 23286.3950   927%     -   37s
H    0     0                    -2802.665975 23286.3950   931%     -   37s
     0     0 22817.9758    0  344 -2802.6660 22817.9758   914%     -   41s
     0     0 22638.2609    0  346 -2802.6660 22638.2609   908%     -   43s
     0     0 22594.4650    0  354 -2802.6660 22594.4650   906%     -   45s
     0     0 22557.3120    0  342 -2802.6660 22557.3120   905%     -   45s
     0     0 22554.3087    0  341 -2802.6660 22554.3087   905%     -   46s
     0     0 22552.2311    0  335 -2802.6660 22552.2311   905%     -   46s
     0     0 22533.5486    0  346 -2802.6660 22533.5486   904%     -   46s
     0     0 22519.3846    0  343 -2802.6660 22519.3846   903%     -   47s
     0     0 22513.1375    0  341 -2802.6660 22513.1375   903%     -   47s
     0     0 22511.9363    0  344 -2802.6660 22511.9363   903%     -   47s
     0     0 22511.8610    0  342 -2802.6660 22511.8610   903%     -   47s
H    0     0                    -1018.383942 20988.1955  2161%     -   58s
H    0     0                    -608.7613517 20988.1955  3548%     -   58s
H    0     0                    -369.9351633 20988.1955  5773%     -   58s
H    0     0                    -351.9813076 20988.1955  6063%     -   58s
H    0     0                    -319.0267753 20988.1955  6679%     -   58s
H    0     0                    -289.6276547 20988.1955  7347%     -   58s
     0     0 20988.1955    0  401 -289.62765 20988.1955  7347%     -   58s
H    0     0                     602.0157104 20988.1389  3386%     -   58s
H    0     0                     607.8000071 20988.1389  3353%     -   58s
H    0     0                     748.7204692 20988.1389  2703%     -   58s
     0     0 20546.2983    0  409  748.72047 20546.2983  2644%     -   62s
     0     0 20333.4127    0  410  748.72047 20333.4127  2616%     -   65s
     0     0 20240.2349    0  389  748.72047 20240.2349  2603%     -   66s
     0     0 20169.3583    0  387  748.72047 20169.3583  2594%     -   67s
     0     0 20157.1641    0  389  748.72047 20157.1641  2592%     -   68s
     0     0 20100.3623    0  388  748.72047 20100.3623  2585%     -   68s
     0     0 20072.6690    0  417  748.72047 20072.6690  2581%     -   69s
     0     0 20068.1820    0  426  748.72047 20068.1820  2580%     -   70s
     0     0 20060.3981    0  428  748.72047 20060.3981  2579%     -   70s
     0     0 20058.8497    0  429  748.72047 20058.8497  2579%     -   70s
     0     0 20058.6107    0  431  748.72047 20058.6107  2579%     -   70s
     0     0 19311.7244    0  399  748.72047 19311.7244  2479%     -   78s
H    0     0                     859.2254521 19311.2294  2148%     -   78s
H    0     0                     881.2191050 19311.2294  2091%     -   78s
H    0     0                     959.3372304 19311.2294  1913%     -   78s
     0     0 19111.2649    0  450  959.33723 19111.2649  1892%     -   80s
     0     0 18998.4964    0  501  959.33723 18998.4964  1880%     -   82s
     0     0 18963.2157    0  464  959.33723 18963.2157  1877%     -   82s
     0     0 18885.1465    0  508  959.33723 18885.1465  1869%     -   84s
     0     0 18869.9401    0  509  959.33723 18869.9401  1867%     -   84s
     0     0 18862.4081    0  516  959.33723 18862.4081  1866%     -   84s
     0     0 18860.5820    0  508  959.33723 18860.5820  1866%     -   85s
     0     0 18856.7282    0  516  959.33723 18856.7282  1866%     -   85s
     0     0 18848.3274    0  506  959.33723 18848.3274  1865%     -   85s
     0     0 18843.3574    0  506  959.33723 18843.3574  1864%     -   86s
     0     0 18841.3918    0  508  959.33723 18841.3918  1864%     -   86s
     0     0 18840.2863    0  504  959.33723 18840.2863  1864%     -   86s
     0     0 18674.8182    0  495  959.33723 18674.8182  1847%     -   89s
     0     0 18562.8701    0  438  959.33723 18562.8701  1835%     -   91s
     0     0 18542.4609    0  503  959.33723 18542.4609  1833%     -   91s
     0     0 18535.0331    0  503  959.33723 18535.0331  1832%     -   92s
     0     0 18529.1229    0  508  959.33723 18529.1229  1831%     -   92s
     0     0 18527.1265    0  508  959.33723 18527.1265  1831%     -   92s
     0     0 18525.0599    0  515  959.33723 18525.0599  1831%     -   93s
     0     0 18524.3181    0  510  959.33723 18524.3181  1831%     -   93s
     0     0 18456.1701    0  460  959.33723 18456.1701  1824%     -   95s
H    0     0                    1321.0228104 18456.0894  1297%     -   95s
H    0     0                    1943.5639749 18456.0894   850%     -   95s
H    0     0                    2034.3613872 18456.0894   807%     -   95s
H    0     0                    2078.8646140 18456.0894   788%     -   95s
     0     0 18449.1330    0  517 2078.86461 18449.1330   787%     -   96s
     0     0 18438.3837    0  518 2078.86461 18438.3837   787%     -   96s
     0     0 18434.9693    0  520 2078.86461 18434.9693   787%     -   96s
     0     0 18433.3855    0  522 2078.86461 18433.3855   787%     -   97s
     0     0 18433.0541    0  526 2078.86461 18433.0541   787%     -   97s
     0     0 18389.5172    0  519 2078.86461 18389.5172   785%     -   99s
     0     0 18380.3053    0  519 2078.86461 18380.3053   784%     -   99s
     0     0 18376.1181    0  514 2078.86461 18376.1181   784%     -  100s
     0     0 18375.2728    0  511 2078.86461 18375.2728   784%     -  100s
     0     0 18334.5183    0  445 2078.86461 18334.5183   782%     -  102s
H    0     0                    2144.4915140 18334.4721   755%     -  102s
H    0     0                    2247.9446713 18334.4721   716%     -  102s
     0     0 18309.7250    0  444 2247.94467 18309.7250   715%     -  102s
     0     0 18303.4388    0  441 2247.94467 18303.4388   714%     -  103s
     0     0 18300.1137    0  449 2247.94467 18300.1137   714%     -  103s
     0     0 18299.6483    0  453 2247.94467 18299.6483   714%     -  103s
     0     0 18231.8177    0  513 2247.94467 18231.8177   711%     -  105s
     0     0 18214.8206    0  518 2247.94467 18214.8206   710%     -  106s
     0     0 18209.4168    0  518 2247.94467 18209.4168   710%     -  107s
     0     0 18206.0266    0  519 2247.94467 18206.0266   710%     -  107s
     0     0 18204.1093    0  522 2247.94467 18204.1093   710%     -  107s
     0     0 18203.3159    0  528 2247.94467 18203.3159   710%     -  107s
     0     0 18172.3275    0  518 2247.94467 18172.3275   708%     -  109s
H    0     0                    2295.9501786 18172.2607   691%     -  109s
H    0     0                    2343.1496302 18172.2607   676%     -  109s
     0     0 18164.8172    0  522 2343.14963 18164.8172   675%     -  109s
     0     0 18163.4010    0  521 2343.14963 18163.4010   675%     -  110s
     0     0 18160.9284    0  519 2343.14963 18160.9284   675%     -  111s
     0     0 18159.3655    0  525 2343.14963 18159.3655   675%     -  111s
     0     0 18159.2907    0  527 2343.14963 18159.2907   675%     -  111s
     0     0 18156.5069    0  525 2343.14963 18156.5069   675%     -  112s
H    0     0                    2428.2348760 18156.4443   648%     -  113s
H    0     0                    2437.2617309 18156.4443   645%     -  113s
H    0     0                    2446.3225194 18156.4443   642%     -  113s
     0     0 18154.9546    0  531 2446.32252 18154.9546   642%     -  113s
     0     0 18154.7231    0  536 2446.32252 18154.7231   642%     -  113s
     0     0 18150.3819    0  527 2446.32252 18150.3819   642%     -  114s
     0     0 18149.9329    0  527 2446.32252 18149.9329   642%     -  115s
H    0     0                    2467.9346910 18149.7709   635%     -  127s
H    0     0                    2490.4222809 18149.7709   629%     -  127s
H    0     0                    2520.0884137 18149.7709   620%     -  127s
H    0     0                    2523.6801439 18149.7709   619%     -  127s
H    0     0                    2651.1876483 18149.7709   585%     -  129s
H    0     0                    3083.4230576 18149.7709   489%     -  129s
H    0     0                    3216.7874604 18149.7709   464%     -  129s
H    0     0                    3417.9208981 18149.7709   431%     -  130s
     0     2 18149.7709    0  527 3417.92090 18149.7709   431%     -  130s
     3     8 17965.2797    2  495 3417.92090 17978.0622   426%  2175  137s
     7    16 17747.5842    3  522 3417.92090 17964.4782   426%  3767  142s
    15    32 17609.1803    4  525 3417.92090 17747.3394   419%  4939  148s
    31    48 16183.9355    5  447 3417.92090 17608.9867   415%  8147  162s
H   47    80                    3506.0769567 17608.9867   402%  7010  168s
H   48    80                    3510.6269993 17608.9867   402%  6988  168s
H   52    80                    3599.3136540 17608.9867   389%  6969  168s
H   53    80                    3616.8339970 17608.9867   387%  6946  168s
H   64    80                    3643.1295261 17608.9867   383%  6629  168s
H   71    80                    3646.7259866 17608.9867   383%  6326  168s
H   75    80                    3687.1748367 17608.9867   378%  6121  168s
    79   145 15457.7669    7  436 3687.17484 17608.9867   378%  5967  184s
   144   247 15341.8621    9  433 3687.17484 17608.9867   378%  4100  193s
H  162   247                    3718.3175461 17608.9867   374%  3764  193s
H  167   247                    3726.0761325 17608.9867   373%  3697  193s
H  194   247                    3736.3677074 17608.9867   371%  3437  193s
H  226   247                    3809.6730563 17608.9867   362%  3254  193s
H  233   247                    3820.8269712 17608.9867   361%  3232  193s
   246   334 15026.8370   10  392 3820.82697 17608.9867   361%  3199  199s
   333   420 14971.7206   12  415 3820.82697 17608.9867   361%  2971  206s
H  358   420                    3835.3167472 17608.9867   359%  2876  206s
H  389   420                    4002.7083865 17608.9867   340%  2830  206s
H  410   420                    4015.4369216 17608.9867   339%  2816  206s
   419   494 14890.8298   11  383 4015.43692 17608.9867   339%  2806  211s
   495   565 13875.2481   12  343 4015.43692 17608.9867   339%  2753  216s
H  500   565                    4019.9965523 17608.9867   338%  2738  216s
H  527   565                    4061.9315824 17608.9867   334%  2687  216s
   571   651 14327.7270   13  347 4061.93158 17608.9867   334%  2649  221s
   667   733 13738.9753   13  333 4061.93158 17608.9867   334%  2488  228s
   761   814 14647.9297   15  407 4061.93158 17608.9867   334%  2343  231s
   846   874 14142.8601   16  299 4061.93158 17608.9867   334%  2254  236s
   938   907 14285.5464   16  398 4061.93158 17608.9867   334%  2176  243s
  1026   931 13556.5845   16  284 4061.93158 17608.9867   334%  2133  249s
  1064   953 13873.4291   16  333 4061.93158 17608.9867   334%  2158  257s
H 1066   953                    4063.3148251 17608.9867   333%  2157  257s
  1108   974 13401.4588   17  284 4063.31483 17608.9867   333%  2170  264s
  1145   999 10575.7046   17  272 4063.31483 17608.9867   333%  2196  270s
  1190  1022 10791.1045   17  361 4063.31483 17608.9867   333%  2217  275s
  1231  1049 13520.9557   17  392 4063.31483 17608.9867   333%  2244  282s
H 1248  1049                    4113.1631351 17608.9867   328%  2247  282s
  1268  1107 11185.7701   18  292 4113.16314 17608.9867   328%  2267  290s
  1366  1120 12643.7302   17  277 4113.16314 17608.9867   328%  2250  297s
  1415  1140 10550.0789   18  272 4113.16314 17386.6738   323%  2274  307s
  1471  1169 9864.73524   18  255 4113.16314 17386.6738   323%  2302  313s
H 1508  1169                    5412.5899273 17386.6738   221%  2298  313s
  1534  1200 8811.70535   18  260 5412.58993 17386.6738   221%  2315  322s
  1639  1262     cutoff   19      5412.58993 17386.6738   221%  2315  330s
  1749  1334 8288.64988   19  259 5412.58993 17386.6738   221%  2307  339s
  1873  1381 6353.32178   21  288 5412.58993 17386.6738   221%  2276  348s
  2000  1440 5976.39431   21  359 5412.58993 17386.6738   221%  2259  357s
  2145  1540 6018.32533   24  278 5412.58993 17386.6738   221%  2231  367s
  2297  1657 12003.1941    8  385 5412.58993 17386.6738   221%  2203  376s
H 2458  1677                    6243.1430513 16293.5593   161%  2159  384s
  2500  1742 11053.0034   10  312 6243.14305 16293.5593   161%  2175  393s
  2703  1807     cutoff   12      6243.14305 16293.5593   161%  2117  403s
  2891  1783 8405.74350   14  282 6243.14305 15687.3686   151%  2094  412s
  3069  1799 7983.57714   15  288 6243.14305 15593.9843   150%  2084  422s
  3226  1844 6992.73309   19  221 6243.14305 15593.9843   150%  2089  432s
H 3232  1832                    6320.2953594 15593.9843   147%  2088  432s
H 3235  1825                    6394.1019026 15593.9843   144%  2089  432s
H 3250  1786                    6576.2228460 15593.9843   137%  2085  432s
H 3291  1769                    6684.3911891 15593.9843   133%  2091  432s
  3325  1816 6979.58702   13  331 6684.39119 15474.3212   131%  2108  441s
  3482  1877 12907.2069    7  382 6684.39119 15368.5196   130%  2117  454s
  3620  1926 10645.6713    9  288 6684.39119 15325.2857   129%  2147  464s
  3757  1994 9662.52906   12  285 6684.39119 15325.2857   129%  2172  478s
  3953  2105 7968.19158   18  210 6684.39119 15250.6857   128%  2166  489s
H 4160  2094                    6742.0989511 15193.8677   125%  2165  497s
H 4199  1803                    7622.6627389 15193.8677  99.3%  2165  497s
  4214  1862 12730.1562   15  398 7622.66274 15193.8677  99.3%  2166  510s
H 4246  1824                    7794.4279430 15193.8677  94.9%  2165  510s
  4406  1875 11266.6014   16  307 7794.42794 15193.8677  94.9%  2177  523s
  4560  1888 10079.6357   19  277 7794.42794 15193.8677  94.9%  2207  537s
H 4602  1880                    7820.9615092 15193.8677  94.3%  2210  537s
  4766  1937 9951.19800   21  246 7820.96151 14912.8787  90.7%  2216  551s
  4980  1945 8612.64849   28  296 7820.96151 14912.8787  90.7%  2225  562s
  5044  1977 8721.27344   29  225 7820.96151 14906.0167  90.6%  2228  575s
  5220  1975 9912.99480   11  382 7820.96151 14906.0167  90.6%  2235  590s
  5472  2023 9041.10890   13  286 7820.96151 14890.0461  90.4%  2241  605s
H 5564  2012                    7866.9679198 14813.5497  88.3%  2245  605s
  5669  2098 10640.6650    8  315 7866.96792 14813.5497  88.3%  2249  626s
  5909  2185 8645.10287   11  224 7866.96792 14633.7514  86.0%  2263  642s
  6216  2221 11934.1901   18  345 7866.96792 14633.7514  86.0%  2262  659s
  6476  2254     cutoff   23      7866.96792 14508.3498  84.4%  2277  676s
  6732  2270     cutoff   12      7866.96792 14184.5435  80.3%  2300  692s
  6958  2301 10094.8894   13  265 7866.96792 14166.6593  80.1%  2295  712s
  7297  2333     cutoff   13      7866.96792 14121.7718  79.5%  2293  730s
  7635  2370     cutoff   12      7866.96792 14107.5200  79.3%  2297  749s
  7938  2411 infeasible   14      7866.96792 14049.8876  78.6%  2318  770s
  8235  2446     cutoff   11      7866.96792 13875.1166  76.4%  2335  792s
  8551  2501 10269.4116   14  334 7866.96792 13866.3949  76.3%  2347  815s
  8899  2567     cutoff    8      7866.96792 13792.9878  75.3%  2365  834s
  9059  2568 8871.68774   15  527 7866.96792 13673.2097  73.8%  2362  872s
  9061  2569 12802.7822   22  198 7866.96792 13673.2097  73.8%  2362  897s
  9062  2570 12915.4502   17  424 7866.96792 13673.2097  73.8%  2362  911s
  9063  2571 11503.5987   18  406 7866.96792 13673.2097  73.8%  2361  919s
  9064  2571 10442.5648   10  551 7866.96792 13673.2097  73.8%  2361  925s
  9066  2573 8892.93008   15  524 7866.96792 13673.2097  73.8%  2361  931s
  9068  2574 12914.5770   15  502 7866.96792 13673.2097  73.8%  2360  937s
  9071  2576 12332.0999   13  506 7866.96792 13673.2097  73.8%  2359  941s
  9073  2577 8600.71930   34  512 7866.96792 13673.2097  73.8%  2359  946s
  9075  2579 10831.5370   23  547 7866.96792 13673.2097  73.8%  2358  951s
  9077  2580 8144.88786   15  462 7866.96792 13673.2097  73.8%  2358  957s
  9080  2582 7943.87823   19  519 7866.96792 13673.2097  73.8%  2357  963s
  9081  2583 11871.2137   13  530 7866.96792 13673.2097  73.8%  2357  965s
  9082  2583 11287.3786    8  526 7866.96792 13673.2097  73.8%  2357  971s
  9084  2585 11932.2683   14  455 7866.96792 13673.2097  73.8%  2356  975s
  9085  2585 12680.3356   16  455 7866.96792 13673.2097  73.8%  2356  999s
  9086  2586 12846.1020   17  455 7866.96792 13673.2097  73.8%  2355 1011s
  9087  2590 13673.2097   12  447 7866.96792 13673.2097  73.8%  2373 1019s
  9089  2593 13673.2097   13  457 7866.96792 13673.2097  73.8%  2373 1029s
  9093  2600 13673.2097   14  510 7866.96792 13673.2097  73.8%  2373 1038s
  9101  2613 13673.2097   15  503 7866.96792 13673.2097  73.8%  2377 1045s
  9117  2627 13673.2097   16  527 7866.96792 13673.2097  73.8%  2394 1063s
  9136  2651 11661.3210   17  441 7866.96792 13673.2097  73.8%  2403 1078s
  9168  2673 11447.6113   18  439 7866.96792 13673.2097  73.8%  2432 1088s
  9200  2687 10235.0431   19  355 7866.96792 13673.2097  73.8%  2434 1105s
  9243  2677 8522.41412   19  341 7866.96792 13673.2097  73.8%  2453 1117s
  9299  2656     cutoff   20      7866.96792 13673.2097  73.8%  2484 1132s
  9367  2640     cutoff   20      7866.96792 13673.2097  73.8%  2499 1144s
  9420  2621 infeasible   18      7866.96792 13673.2097  73.8%  2513 1154s
  9490  2614     cutoff   19      7866.96792 13673.2097  73.8%  2537 1164s
  9539  2604 10230.1694   18  446 7866.96792 13673.2097  73.8%  2564 1174s
  9604  2593 8587.63467   19  354 7866.96792 13673.2097  73.8%  2588 1185s
  9656  2588 8586.01481   20  319 7866.96792 13673.2097  73.8%  2603 1193s
  9722  2580 8552.65816   21  366 7866.96792 13673.2097  73.8%  2615 1203s
  9774  2576     cutoff   22      7866.96792 13673.2097  73.8%  2630 1212s
  9836  2566 8810.76377   19  275 7866.96792 13673.2097  73.8%  2641 1222s
  9904  2559     cutoff   20      7866.96792 13673.2097  73.8%  2651 1230s
  9974  2536 9004.70143   19  397 7866.96792 13673.2097  73.8%  2661 1240s
 10053  2513     cutoff   20      7866.96792 13673.2097  73.8%  2669 1250s
 10132  2512 11880.6859   18  412 7866.96792 13673.2097  73.8%  2684 1260s
 10211  2504 10067.2285   19  367 7866.96792 13673.2097  73.8%  2696 1270s
 10291  2490 9970.33957   20  356 7866.96792 13673.2097  73.8%  2714 1280s
 10380  2478 9367.90693   21  311 7866.96792 13673.2097  73.8%  2724 1291s
 10471  2438 9246.78367   22  294 7866.96792 13673.2097  73.8%  2737 1304s
 10598  2421 9080.71395   24  287 7866.96792 13068.9111  66.1%  2747 1315s
 10701  2394     cutoff   29      7866.96792 13031.4514  65.6%  2766 1327s
 10851  2357 8867.40571   21  312 7866.96792 12946.6145  64.6%  2777 1338s
 10913  2365     cutoff   22      7866.96792 12946.6145  64.6%  2784 1348s
 11016  2361     cutoff   23      7866.96792 12064.4341  53.4%  2789 1359s
 11171  2303 9822.44547   22  459 7866.96792 11889.8507  51.1%  2791 1372s
 11357  2254     cutoff   23      7866.96792 11889.8507  51.1%  2788 1385s
 11579  2232 9303.64561   22  393 7866.96792 11493.0260  46.1%  2787 1397s
 11823  2213     cutoff   25      7866.96792 11493.0260  46.1%  2778 1409s
 12152  2155 infeasible   29      7866.96792 10214.3422  29.8%  2749 1419s
 12515  1989 8683.84768   31  243 7866.96792 9868.62963  25.4%  2716 1429s
 13035  1670 8622.39709   30  165 7866.96792 9739.07875  23.8%  2656 1439s
 13707  1136     cutoff   43      7866.96792 9368.51537  19.1%  2566 1446s
 14304   847     cutoff   44      7866.96792 8754.39743  11.3%  2481 1452s

Cutting planes:
  MIR: 440
  Mixing: 1
  Flow cover: 1090
  RLT: 16
  Relax-and-lift: 91

Explored 14441 nodes (35720972 simplex iterations) in 1452.17 seconds (4388.82 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 7866.97 7820.96 7794.43 ... 6243.14

Optimal solution found (tolerance 1.00e-04)
Best objective 7.866967919777e+03, best bound 7.866967919777e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1452.18s
  Master Objective (UB) = 7866.97, θ = 145588.44
  Upper Bound (UB) = 7866.97

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 145588.44
  [DEBUG]   ✓ Scenario 0: θ = 145588.44 ≤ Q = 145588.44 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 145588.44 ≤ Q = 145588.44 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 145588.44 ≤ Q = 145588.44 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 145588.44 ≤ Q = 145588.44 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 145588.44 ≤ Q = 145588.44 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 145588.44 ≤ Q = 145588.44 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x583e6901
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x583e6901
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [1e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.205159e+13
Presolve removed 2613 rows and 1904 columns
Presolve time: 0.00s
Presolved: 480 rows, 485 columns, 1318 nonzeros
Found heuristic solution: objective 5554544.1955
Variable types: 329 continuous, 156 integer (156 binary)

Root relaxation: objective -1.472781e+05, 230 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -147278.14    0  121 5554544.20 -147278.14   103%     -    0s
H    0     0                    -113795.6256 -147278.14  29.4%     -    0s
H    0     0                    -114714.2035 -147278.14  28.4%     -    0s
     0     0 -121649.54    0   54 -114714.20 -121649.54  6.05%     -    0s
H    0     0                    -119344.1293 -121588.68  1.88%     -    0s
H    0     0                    -119742.8106 -121588.68  1.54%     -    0s
H    0     0                    -120054.8522 -121588.68  1.28%     -    0s
     0     0 -121214.35    0   56 -120054.85 -121214.35  0.97%     -    0s
     0     0 -121202.09    0   56 -120054.85 -121202.09  0.96%     -    0s
     0     0 -120905.72    0    9 -120054.85 -120905.72  0.71%     -    0s
H    0     0                    -120661.3032 -120842.55  0.15%     -    0s
     0     0 -120842.55    0   16 -120661.30 -120842.55  0.15%     -    0s
     0     0 -120842.55    0   14 -120661.30 -120842.55  0.15%     -    0s
     0     0 -120842.55    0   14 -120661.30 -120842.55  0.15%     -    0s
     0     0 -120842.55    0   12 -120661.30 -120842.55  0.15%     -    0s
     0     0 -120709.34    0    2 -120661.30 -120709.34  0.04%     -    0s
     0     0 -120709.34    0   25 -120661.30 -120709.34  0.04%     -    0s
H    0     0                    -120707.4662 -120709.34  0.00%     -    0s
     0     0 -120709.34    0    2 -120707.47 -120709.34  0.00%     -    0s

Cutting planes:
  Gomory: 5
  Implied bound: 8
  MIR: 24
  RLT: 1
  Relax-and-lift: 2

Explored 1 nodes (543 simplex iterations) in 0.04 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -120707 -120661 -120055 ... 1.20516e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.207074661953e+05, best bound -1.207093398490e+05, gap 0.0016%
  Subproblem solved in 0.05s
  Worst-case operational profit (Z_SP) = 140477.13
  Scenario: 11 demand increases, 48 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -120707.47
  [DEBUG]   S×d_nominal = 261184.59
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 261184.59 + -120707.47 = 140477.13
  [DEBUG]   Current θ from Master = 145588.44
  [DEBUG]   ⚠️  Z_SP ≤ θ by 5111.31 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 2755.66
  Lower Bound (LB) = 5022.47
  Gap (UB-LB) = 2844.4996, Absolute Gap = 2844.4996, Relative Gap = 0.361575
  Not converged yet (gap = 2844.50 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 11 increases, 48 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308094 nonzeros
Model fingerprint: 0x2afb3948
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 51004 rows and 20714 columns
Presolve time: 0.93s
Presolved: 57409 rows, 25226 columns, 356899 nonzeros
Variable types: 22967 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -333055.8495
Found heuristic solution: objective -217726.0351

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 57409 rows, 25226 columns, 356899 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   32034   -3.1278015e+04   0.000000e+00   9.149502e+06      5s
   45508    8.9017213e+03   0.000000e+00   6.271521e+06     10s
   56596    1.8153484e+04   0.000000e+00   5.634301e+08     15s
   68113    2.5779565e+04   0.000000e+00   1.037359e+06     20s
   79381    2.8992727e+04   0.000000e+00   5.063181e+05     25s
Concurrent spin time: 6.20s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 3.025156e+04, 65151 iterations, 29.93 seconds (53.41 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 30251.5582    0  198 -217726.04 30251.5582   114%     -   31s
H    0     0                    -214356.3729 30251.5582   114%     -   31s
H    0     0                    -150528.7051 30251.5582   120%     -   31s
H    0     0                    -150188.1138 30251.5582   120%     -   31s
H    0     0                    -99984.47368 30251.5582   130%     -   31s
H    0     0                    -99670.90488 30251.5582   130%     -   31s
H    0     0                    -98641.71806 30251.5582   131%     -   31s
H    0     0                    -98451.12034 30251.5582   131%     -   31s
H    0     0                    -61757.06587 30251.5582   149%     -   31s
H    0     0                    -51260.93115 30251.5582   159%     -   31s
H    0     0                    -33681.27293 30251.5582   190%     -   31s
H    0     0                    -25276.24147 30251.5582   220%     -   31s
H    0     0                    -20109.45900 26874.7970   234%     -   39s
H    0     0                    -13634.64431 26874.7970   297%     -   39s
H    0     0                    -10378.71754 26874.7970   359%     -   39s
H    0     0                    -7114.393967 26874.7970   478%     -   39s
     0     0 26874.7970    0  193 -7114.3940 26874.7970   478%     -   39s
     0     0 26270.9218    0  218 -7114.3940 26270.9218   469%     -   44s
     0     0 26270.9218    0  210 -7114.3940 26270.9218   469%     -   44s
     0     0 26229.9531    0  218 -7114.3940 26229.9531   469%     -   45s
     0     0 26229.9530    0  218 -7114.3940 26229.9530   469%     -   45s
H    0     0                    -6501.031844 23170.1951   456%     -   54s
     0     0 23170.1951    0  320 -6501.0318 23170.1951   456%     -   54s
H    0     0                     867.4783261 23170.0497  2571%     -   55s
H    0     0                     879.7927560 23170.0497  2534%     -   55s
     0     0 22802.5941    0  326  879.79276 22802.5941  2492%     -   58s
     0     0 22728.5842    0  344  879.79276 22728.5842  2483%     -   60s
     0     0 22628.3525    0  340  879.79276 22628.3525  2472%     -   62s
     0     0 22610.7487    0  340  879.79276 22610.7487  2470%     -   63s
     0     0 22534.7150    0  348  879.79276 22534.7150  2461%     -   63s
     0     0 22518.4723    0  346  879.79276 22518.4723  2460%     -   64s
     0     0 22517.9496    0  344  879.79276 22517.9496  2459%     -   64s
     0     0 20724.6523    0  396  879.79276 20724.6523  2256%     -   76s
H    0     0                     992.6586547 20724.0671  1988%     -   76s
H    0     0                    1183.6624423 20724.0671  1651%     -   77s
H    0     0                    1314.7538072 20724.0671  1476%     -   77s
H    0     0                    1419.7849197 20724.0671  1360%     -   77s
     0     0 20392.9947    0  412 1419.78492 20392.9947  1336%     -   80s
     0     0 20221.9757    0  422 1419.78492 20221.9757  1324%     -   82s
     0     0 20178.8960    0  420 1419.78492 20178.8960  1321%     -   83s
     0     0 20080.5140    0  436 1419.78492 20080.5140  1314%     -   85s
     0     0 20060.5975    0  422 1419.78492 20060.5975  1313%     -   86s
     0     0 20002.2542    0  443 1419.78492 20002.2542  1309%     -   87s
H    0     0                    1467.4322463 19961.6920  1260%     -   88s
     0     0 19961.6920    0  439 1467.43225 19961.6920  1260%     -   88s
     0     0 19941.6511    0  445 1467.43225 19941.6511  1259%     -   89s
     0     0 19920.2339    0  437 1467.43225 19920.2339  1257%     -   90s
     0     0 19873.8095    0  441 1467.43225 19873.8095  1254%     -   92s
     0     0 19865.4250    0  440 1467.43225 19865.4250  1254%     -   92s
     0     0 19857.6829    0  442 1467.43225 19857.6829  1253%     -   93s
     0     0 19857.3556    0  443 1467.43225 19857.3556  1253%     -   93s
H    0     0                    1871.2451171 19236.4034   928%     -  101s
     0     0 19236.4034    0  493 1871.24512 19236.4034   928%     -  101s
     0     0 19046.2378    0  497 1871.24512 19046.2378   918%     -  104s
     0     0 18904.4336    0  504 1871.24512 18904.4336   910%     -  106s
     0     0 18855.1563    0  504 1871.24512 18855.1563   908%     -  108s
     0     0 18834.9762    0  508 1871.24512 18834.9762   907%     -  109s
     0     0 18822.4810    0  515 1871.24512 18822.4810   906%     -  109s
     0     0 18817.0054    0  504 1871.24512 18817.0054   906%     -  110s
     0     0 18812.6227    0  513 1871.24512 18812.6227   905%     -  110s
     0     0 18811.3746    0  509 1871.24512 18811.3746   905%     -  110s
     0     0 18692.5615    0  511 1871.24512 18692.5615   899%     -  114s
     0     0 18670.2806    0  510 1871.24512 18670.2806   898%     -  115s
     0     0 18653.7404    0  500 1871.24512 18653.7404   897%     -  116s
     0     0 18648.5572    0  511 1871.24512 18648.5572   897%     -  116s
     0     0 18645.2163    0  518 1871.24512 18645.2163   896%     -  117s
     0     0 18639.6685    0  512 1871.24512 18639.6685   896%     -  117s
     0     0 18637.5267    0  511 1871.24512 18637.5267   896%     -  117s
     0     0 18637.2211    0  513 1871.24512 18637.2211   896%     -  118s
     0     0 18523.5230    0  462 1871.24512 18523.5230   890%     -  120s
     0     0 18480.5158    0  503 1871.24512 18480.5158   888%     -  124s
     0     0 18471.8679    0  508 1871.24512 18471.8679   887%     -  125s
     0     0 18470.5908    0  464 1871.24512 18470.5908   887%     -  125s
     0     0 18405.2120    0  525 1871.24512 18405.2120   884%     -  128s
     0     0 18387.8315    0  462 1871.24512 18387.8315   883%     -  130s
     0     0 18384.6114    0  469 1871.24512 18384.6114   882%     -  130s
     0     0 18381.0693    0  473 1871.24512 18381.0693   882%     -  130s
     0     0 18379.6466    0  478 1871.24512 18379.6466   882%     -  131s
     0     0 18377.8682    0  472 1871.24512 18377.8682   882%     -  131s
     0     0 18377.5148    0  467 1871.24512 18377.5148   882%     -  131s
     0     0 18338.5591    0  524 1871.24512 18338.5591   880%     -  133s
H    0     0                    1956.5908580 18335.4799   837%     -  134s
H    0     0                    2081.9388929 18335.4799   781%     -  134s
     0     0 18318.1534    0  526 2081.93889 18318.1534   780%     -  136s
     0     0 18311.1481    0  527 2081.93889 18311.1481   780%     -  136s
     0     0 18304.8566    0  532 2081.93889 18304.8566   779%     -  137s
     0     0 18302.6762    0  533 2081.93889 18302.6762   779%     -  137s
     0     0 18302.2183    0  531 2081.93889 18302.2183   779%     -  137s
     0     0 18282.9483    0  460 2081.93889 18282.9483   778%     -  139s
H    0     0                    3454.2770395 18282.8613   429%     -  139s
H    0     0                    3541.6275107 18282.8613   416%     -  139s
H    0     0                    3543.0033360 18282.8613   416%     -  139s
     0     0 18279.6109    0  527 3543.00334 18279.6109   416%     -  140s
     0     0 18278.0595    0  522 3543.00334 18278.0595   416%     -  140s
     0     0 18277.6743    0  527 3543.00334 18277.6743   416%     -  141s
     0     0 18257.4104    0  529 3543.00334 18257.4104   415%     -  143s
     0     0 18251.2311    0  525 3543.00334 18251.2311   415%     -  144s
     0     0 18247.6203    0  519 3543.00334 18247.6203   415%     -  145s
     0     0 18247.0698    0  521 3543.00334 18247.0698   415%     -  145s
     0     0 18233.9829    0  473 3543.00334 18233.9829   415%     -  146s
H    0     0                    3596.4882894 18233.5217   407%     -  147s
     0     0 18228.6618    0  480 3596.48829 18228.6618   407%     -  147s
     0     0 18226.3579    0  475 3596.48829 18226.3579   407%     -  147s
     0     0 18225.0962    0  472 3596.48829 18225.0962   407%     -  148s
     0     0 18223.6469    0  470 3596.48829 18223.6469   407%     -  149s
     0     0 18222.6427    0  469 3596.48829 18222.6427   407%     -  149s
     0     0 18211.7189    0  475 3596.48829 18211.7189   406%     -  150s
     0     0 18207.6047    0  469 3596.48829 18207.6047   406%     -  151s
     0     0 18206.2971    0  466 3596.48829 18206.2971   406%     -  151s
     0     0 18200.0575    0  475 3596.48829 18200.0575   406%     -  152s
     0     0 18199.7210    0  475 3596.48829 18199.7210   406%     -  153s
H    0     0                    3633.4117894 18199.3194   401%     -  181s
H    0     0                    3651.3075111 18199.3194   398%     -  181s
H    0     0                    3662.5293891 18199.3194   397%     -  181s
H    0     0                    3854.8294974 18199.3194   372%     -  183s
H    0     0                    4938.9567660 18199.3194   268%     -  183s
H    0     0                    5091.2348390 18199.3194   257%     -  184s
H    0     0                    5513.1095330 18199.3194   230%     -  184s
H    0     2                    5617.2602047 18199.3194   224%     -  187s
     0     2 18199.3194    0  475 5617.26020 18199.3194   224%     -  187s
     3     8 17966.8355    2  506 5617.26020 18029.3918   221%  2701  195s
     7    16 17849.0180    3  470 5617.26020 17957.8658   220%  4282  203s
    15    32 17485.9143    4  457 5617.26020 17844.8076   218%  6214  210s
    31    48 15817.7021    5  504 5617.26020 17485.9062   211%  8362  225s
H   47    80                    5689.2146191 17485.9062   207% 10674  237s
H   71    80                    6001.7141593 17485.9062   191%  8414  237s
    79   150 15243.0936    7  432 6001.71416 17485.9062   191%  7727  253s
H  149   294                    6130.1327822 17485.9062   185%  4949  262s
H  210   294                    6506.9459383 17485.9062   169%  4101  262s
   293   363 15058.2372   11  427 6506.94594 17485.9062   169%  3519  268s
   366   401 9484.57956   12  167 6506.94594 17485.9062   169%  3430  275s
H  377   401                    6623.9190856 17485.9062   164%  3424  275s
H  402   401                    6625.7178029 17485.9062   164%  3434  275s
   410   442 14063.5307   10  354 6625.71780 17485.9062   164%  3451  284s
   473   461 14716.7186   12  375 6625.71780 17485.9062   164%  3484  292s
   524   495 14557.5167   13  369 6625.71780 17485.9062   164%  3529  301s
   583   535 13637.4294   12  452 6625.71780 17485.9062   164%  3514  309s
   641   572 13578.8249   13  444 6625.71780 17485.9062   164%  3396  317s
   722   611 13812.5080   13  381 6625.71780 17485.9062   164%  3248  325s
   806   654 12568.6187   14  426 6625.71780 17485.9062   164%  3116  333s
   869   673 12570.5347   14  388 6625.71780 17485.9062   164%  3104  341s
   938   682 11524.7151   15  377 6625.71780 17335.2106   162%  3071  349s
   989   699 9430.80277   15  312 6625.71780 17335.2106   162%  3068  358s
  1042   742 10624.7139   16  371 6625.71780 17335.2106   162%  3115  366s
  1102   762 9736.10545   13  394 6625.71780 17335.2106   162%  3134  376s
  1166   812 8556.79003   17  389 6625.71780 17335.2106   162%  3128  385s
  1238   871 8576.90580   16  383 6625.71780 17335.2106   162%  3119  394s
  1345   930 7732.11319   16  302 6625.71780 17335.2106   162%  3017  402s
  1453   971     cutoff   17      6625.71780 16551.7543   150%  2965  412s
  1551  1015     cutoff   17      6625.71780 16551.6299   150%  2934  423s
  1646  1030     cutoff   18      6625.71780 16551.6299   150%  2924  433s
  1751  1066 13033.5901   13  366 6625.71780 16551.6299   150%  2927  444s
  1839  1110 12188.1786   14  399 6625.71780 16551.6299   150%  2947  454s
  1917  1149 11583.2049   15  328 6625.71780 16551.6299   150%  2971  465s
  2008  1180 10107.1427   17  428 6625.71780 15302.8148   131%  2975  476s
  2101  1240 9136.73967   18  422 6625.71780 15296.7100   131%  2945  486s
  2207  1274 8786.69848   19  429 6625.71780 15296.7100   131%  2939  498s
  2312  1339 8425.23951   20  419 6625.71780 15296.7100   131%  2928  509s
  2427  1392 8216.10342   22  407 6625.71780 15296.7100   131%  2932  522s
  2567  1453 7733.30004   26  414 6625.71780 15296.7100   131%  2911  534s
  2738  1475     cutoff   32      6625.71780 15296.7100   131%  2886  543s
  2778  1518 6973.17495   31  392 6625.71780 14809.9004   124%  2896  555s
  2867  1539 12035.0052    9  370 6625.71780 14809.9004   124%  2872  564s
  2938  1588 9774.61837   10  383 6625.71780 14809.9004   124%  2864  577s
  3109  1665 8742.00919   11  335 6625.71780 14809.9004   124%  2813  591s
  3334  1732 7598.28143   14  295 6625.71780 14809.9004   124%  2748  605s
  3558  1795 6719.74878   21  204 6625.71780 14621.2785   121%  2721  621s
  3730  1849 11513.1082   16  439 6625.71780 14447.3963   118%  2740  636s
  3925  1940     cutoff   19      6625.71780 14345.8074   117%  2746  653s
  4153  2047 7675.26567   21  321 6625.71780 14345.8074   117%  2729  669s
  4407  2119 8110.87027    8  348 6625.71780 14345.8074   117%  2707  686s
  4581  2207 infeasible   11      6625.71780 14235.7048   115%  2737  704s
  4842  2327 9377.90879   11  336 6625.71780 14230.6361   115%  2721  722s
  5130  2328 7265.58622   34  475 6625.71780 14230.6361   115%  2693  761s
  5132  2329 7690.17139   27  198 6625.71780 14230.6361   115%  2692  797s
  5133  2330 9191.24311   13  388 6625.71780 14230.6361   115%  2691  815s
  5134  2331 7536.45187   28  417 6625.71780 14230.6361   115%  2691  824s
  5135  2331 8861.01751   14  499 6625.71780 14230.6361   115%  2690  833s
  5136  2332 7921.45169   13  520 6625.71780 14230.6361   115%  2690  838s
  5137  2333 13634.6471   13  536 6625.71780 14230.6361   115%  2689  842s
  5138  2333 10055.2397   16  559 6625.71780 14230.6361   115%  2689  845s
  5140  2335 8509.71072   10  518 6625.71780 14230.6361   115%  2688  850s
  5143  2337 12790.7043   13  512 6625.71780 14230.6361   115%  2686  855s
  5144  2337 8994.87590   17  555 6625.71780 14230.6361   115%  2686  860s
  5148  2340 13651.2026   11  531 6625.71780 14230.6361   115%  2684  869s
  5149  2341 7152.42794   28  529 6625.71780 14230.6361   115%  2683  870s
  5151  2342 7495.82539   35  463 6625.71780 14230.6361   115%  2682  876s
  5153  2343 7740.16459   24  527 6625.71780 14230.6361   115%  2681  880s
  5154  2344 8935.30916   16  561 6625.71780 14230.6361   115%  2680  885s
  5156  2345 7990.16938   13  535 6625.71780 14230.6361   115%  2679  892s
  5158  2347 7747.27454   17  531 6625.71780 14230.6361   115%  2678  899s
  5159  2347 7091.30479   50  527 6625.71780 14230.6361   115%  2678  901s
  5161  2349 11607.3062   12  528 6625.71780 14230.6361   115%  2677  907s
  5162  2349 7441.42213   34  538 6625.71780 14230.6361   115%  2676  910s
  5164  2351 13539.3968   10  581 6625.71780 14230.6361   115%  2675  945s
  5165  2351 12449.2899   12  581 6625.71780 14230.6361   115%  2675  972s
  5166  2355 14230.6361   12  568 6625.71780 14230.6361   115%  2714  982s
  5168  2358 14230.6361   13  525 6625.71780 14230.6361   115%  2715  991s
  5172  2365 14230.6361   14  529 6625.71780 14230.6361   115%  2718 1001s
  5180  2378 14230.6361   15  468 6625.71780 14230.6361   115%  2723 1013s
  5196  2391 14230.6361   16  466 6625.71780 14230.6361   115%  2759 1039s
  5214  2411 9984.76944   17  376 6625.71780 14230.6361   115%  2777 1049s
  5246  2443 9040.97990   18  394 6625.71780 14230.6361   115%  2799 1061s
  5293  2471 7769.38976   20  387 6625.71780 14230.6361   115%  2824 1072s
  5360  2489 8746.05655   19  395 6625.71780 14230.6361   115%  2842 1084s
  5441  2478     cutoff   21      6625.71780 14230.6361   115%  2870 1095s
H 5477  2347                    6790.1589130 14230.6361   110%  2879 1095s
H 5511  2224                    7790.3030629 14230.6361  82.7%  2887 1095s
  5522  2216     cutoff   22      7790.30306 14230.6361  82.7%  2886 1107s
  5605  2203 infeasible   19      7790.30306 14230.6361  82.7%  2903 1116s
H 5619  2091                    7797.4840592 14230.6361  82.5%  2909 1116s
  5671  2088     cutoff   20      7797.48406 14230.6361  82.5%  2928 1127s
  5760  2057 14230.6361   17  534 7797.48406 14230.6361  82.5%  2931 1137s
  5826  2049 14230.6361   18  538 7797.48406 14230.6361  82.5%  2950 1148s
  5903  2035 14230.6361   20  518 7797.48406 14230.6361  82.5%  2970 1156s
  5950  2039 13673.6916   21  484 7797.48406 14230.6361  82.5%  2983 1166s
  6007  2024 10555.4145   22  344 7797.48406 14230.6361  82.5%  3006 1175s
  6054  2021 13045.3731   22  494 7797.48406 14230.6361  82.5%  3020 1183s
  6103  2018 12402.1636   23  436 7797.48406 14230.6361  82.5%  3047 1191s
  6152  2005 9853.06073   24  434 7797.48406 14230.6361  82.5%  3074 1201s
  6216  1996 9600.85182   25  416 7797.48406 14230.6361  82.5%  3087 1211s
  6263  1976 8824.19809   26  456 7797.48406 14230.6361  82.5%  3107 1219s
  6337  1954 8134.57487   27  385 7797.48406 14230.6361  82.5%  3123 1230s
  6406  1937 8133.33705   28  387 7797.48406 14230.6361  82.5%  3142 1240s
  6479  1940 9746.26198   19  376 7797.48406 14230.6361  82.5%  3169 1251s
  6554  1930     cutoff   22      7797.48406 14230.6361  82.5%  3185 1262s
  6629  1915 infeasible   25      7797.48406 14230.6361  82.5%  3198 1273s
  6741  1897     cutoff   30      7797.48406 14230.6361  82.5%  3208 1284s
  6877  1853 8232.19419   36   95 7797.48406 14230.6361  82.5%  3209 1295s
  7000  1800     cutoff   29      7797.48406 14230.6361  82.5%  3228 1308s
  7112  1768 8313.67982   31  327 7797.48406 14230.6361  82.5%  3256 1320s
  7222  1718     cutoff   34      7797.48406 14230.6361  82.5%  3269 1332s
  7320  1703 10233.8318   23  360 7797.48406 14230.6361  82.5%  3291 1345s
  7425  1677 9191.03074   26  264 7797.48406 14230.6361  82.5%  3301 1358s
  7586  1622 8194.58462   32  167 7797.48406 14230.6361  82.5%  3297 1368s
  7648  1595 7959.25789   33  253 7797.48406 14230.6361  82.5%  3301 1378s
  7721  1576     cutoff   34      7797.48406 14230.6361  82.5%  3306 1389s
  7804  1578 8963.75944   29  299 7797.48406 14230.6361  82.5%  3304 1401s
  7961  1543 8642.36254   30  340 7797.48406 13395.8787  71.8%  3278 1416s
  8221  1499     cutoff   26      7797.48406 12540.0812  60.8%  3239 1431s
  8527  1413 8427.10543   21  360 7797.48406 12538.5542  60.8%  3201 1444s
  8881  1252     cutoff   22      7797.48406 12538.5542  60.8%  3137 1457s
  9399   972 8340.61882   22  280 7797.48406 12538.5542  60.8%  3031 1469s
  9982   518     cutoff   22      7797.48406 10783.6192  38.3%  2920 1479s
 10538   252 8601.65218   21  381 7797.48406 10783.4461  38.3%  2810 1488s
 10776   143     cutoff   22      7797.48406 8895.45864  14.1%  2766 1490s

Cutting planes:
  Learned: 1
  MIR: 509
  Flow cover: 1545
  RLT: 18
  Relax-and-lift: 144

Explored 10825 nodes (30083563 simplex iterations) in 1491.00 seconds (4337.13 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 7797.48 7790.3 6790.16 ... 5617.26

Optimal solution found (tolerance 1.00e-04)
Best objective 7.797484059210e+03, best bound 7.797484059210e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1491.01s
  Master Objective (UB) = 7797.48, θ = 144918.86
  Upper Bound (UB) = 7797.48

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 144918.86
  [DEBUG]   ✓ Scenario 0: θ = 144918.86 ≤ Q = 144918.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 144918.86 ≤ Q = 144918.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 144918.86 ≤ Q = 144918.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 144918.86 ≤ Q = 144918.86 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 144918.86 ≤ Q = 144918.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 144918.86 ≤ Q = 144918.86 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 144918.86 ≤ Q = 144918.86 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x4234ba43
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xbdcb45bd
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e-13, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-15, 2e+02]
Found heuristic solution: objective 1.199668e+13
Presolve removed 2613 rows and 1904 columns
Presolve time: 0.01s
Presolved: 480 rows, 485 columns, 1318 nonzeros
Found heuristic solution: objective 5526768.6978
Variable types: 329 continuous, 156 integer (156 binary)

Root relaxation: objective -1.480057e+05, 228 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -148005.65    0  121 5526768.70 -148005.65   103%     -    0s
H    0     0                    -114468.1278 -148005.65  29.3%     -    0s
H    0     0                    -115385.3324 -148005.65  28.3%     -    0s
     0     0 -122793.22    0   55 -115385.33 -122793.22  6.42%     -    0s
H    0     0                    -120429.9044 -122731.07  1.91%     -    0s
H    0     0                    -120828.5857 -122731.07  1.57%     -    0s
H    0     0                    -120866.1287 -122731.07  1.54%     -    0s
H    0     0                    -121264.8100 -122731.07  1.21%     -    0s
     0     0 -122229.80    0   46 -121264.81 -122229.80  0.80%     -    0s
     0     0 -122146.51    0   42 -121264.81 -122146.51  0.73%     -    0s
     0     0 -122146.20    0   44 -121264.81 -122146.20  0.73%     -    0s
H    0     0                    -121361.8982 -122146.20  0.65%     -    0s
     0     0 -121649.53    0   32 -121361.90 -121649.53  0.24%     -    0s
     0     0 -121644.58    0   26 -121361.90 -121644.58  0.23%     -    0s
     0     0 -121636.73    0   25 -121361.90 -121636.73  0.23%     -    0s
     0     0 -121535.42    0   23 -121361.90 -121535.42  0.14%     -    0s
     0     0 -121534.34    0   22 -121361.90 -121534.34  0.14%     -    0s
     0     0 -121516.67    0   29 -121361.90 -121516.67  0.13%     -    0s
     0     0 -121498.00    0   19 -121361.90 -121498.00  0.11%     -    0s
     0     0 -121495.06    0    8 -121361.90 -121495.06  0.11%     -    0s
     0     0 -121430.03    0    4 -121361.90 -121430.03  0.06%     -    0s
     0     0 -121430.03    0    6 -121361.90 -121430.03  0.06%     -    0s
H    0     0                    -121364.4160 -121430.03  0.05%     -    0s
H    0     0                    -121404.7010 -121430.03  0.02%     -    0s
     0     0 -121429.63    0    2 -121404.70 -121429.63  0.02%     -    0s
H    0     0                    -121425.4974 -121425.50  0.00%     -    0s
     0     0          -    0      -121425.50 -121425.50  0.00%     -    0s

Cutting planes:
  Gomory: 2
  MIR: 3
  Flow cover: 3

Explored 1 nodes (686 simplex iterations) in 0.05 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -121425 -121405 -121364 ... 5.52677e+06
No other solutions better than -121425

Optimal solution found (tolerance 1.00e-04)
Best objective -1.214254974403e+05, best bound -1.214254974403e+05, gap 0.0000%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 139759.09
  Scenario: 24 demand increases, 35 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -121425.50
  [DEBUG]   S×d_nominal = 261184.59
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 261184.59 + -121425.50 = 139759.09
  [DEBUG]   Current θ from Master = 144918.86
  [DEBUG]   ⚠️  Z_SP ≤ θ by 5159.76 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 2637.72
  Lower Bound (LB) = 5022.47
  Gap (UB-LB) = 2775.0157, Absolute Gap = 2775.0157, Relative Gap = 0.355886
  Not converged yet (gap = 2775.02 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 24 increases, 35 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351319 nonzeros
Model fingerprint: 0x6aa285b2
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 58276 rows and 23666 columns
Presolve time: 1.06s
Presolved: 65427 rows, 28514 columns, 407139 nonzeros
Variable types: 26255 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -333055.8495
Found heuristic solution: objective -217726.0351

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 65427 rows, 28514 columns, 407139 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   34246   -4.7383894e+04   0.000000e+00   2.954765e+09      5s
   46729   -2.3463895e+04   0.000000e+00   1.855274e+07     10s
   56296   -5.7138095e+03   0.000000e+00   3.137687e+07     15s
   64520    2.8181077e+03   0.000000e+00   6.069203e+06     20s
   73134    6.9565683e+03   0.000000e+00   1.370787e+07     25s
   81364    1.0218897e+04   0.000000e+00   1.032950e+06     30s
Concurrent spin time: 4.64s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 3.025156e+04, 77479 iterations, 32.79 seconds (59.43 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 30251.5582    0  198 -217726.04 30251.5582   114%     -   34s
H    0     0                    -209393.3525 30251.5582   114%     -   34s
H    0     0                    -126102.5255 30251.5582   124%     -   34s
H    0     0                    -120335.2331 30251.5582   125%     -   34s
H    0     0                    -118753.4370 30251.5582   125%     -   34s
H    0     0                    -94348.61665 30251.5582   132%     -   34s
H    0     0                    -94225.24648 30251.5582   132%     -   34s
H    0     0                    -94149.24088 30251.5582   132%     -   34s
H    0     0                    -92588.58901 30251.5582   133%     -   34s
H    0     0                    -92290.39439 30251.5582   133%     -   34s
H    0     0                    -47497.72623 30251.5582   164%     -   34s
H    0     0                    -31640.95046 30251.5582   196%     -   35s
H    0     0                    -30446.79593 30251.5582   199%     -   35s
H    0     0                    -29990.28279 30251.5582   201%     -   35s
H    0     0                    -29727.99723 30251.5582   202%     -   35s
H    0     0                    -28652.07321 30251.5582   206%     -   36s
H    0     0                    -28572.20959 30251.5582   206%     -   36s
H    0     0                    -26200.72557 30251.5582   215%     -   36s
H    0     0                    -26192.49408 30251.5582   215%     -   36s
H    0     0                    -24198.79945 30250.9425   225%     -   36s
H    0     0                    -8895.161490 27101.5171   405%     -   43s
H    0     0                    -8895.054598 27101.5171   405%     -   43s
H    0     0                    -8529.041928 27101.5171   418%     -   43s
     0     0 27101.5171    0  208 -8529.0419 27101.5171   418%     -   43s
     0     0 26229.7063    0  214 -8529.0419 26229.7063   408%     -   48s
     0     0 26229.7063    0  210 -8529.0419 26229.7063   408%     -   48s
     0     0 26229.7063    0  203 -8529.0419 26229.7063   408%     -   49s
     0     0 26229.7063    0  212 -8529.0419 26229.7063   408%     -   49s
     0     0 26229.7063    0  212 -8529.0419 26229.7063   408%     -   49s
H    0     0                    -8478.431573 23554.0794   378%     -   59s
H    0     0                    -8347.790410 23554.0794   382%     -   59s
     0     0 23293.0574    0  313 -8347.7904 23293.0574   379%     -   59s
H    0     0                    -5742.070893 23293.0574   506%     -   59s
H    0     0                    -5687.890463 23293.0574   510%     -   59s
H    0     0                    -5667.080845 23293.0574   511%     -   59s
H    0     0                    -5592.500743 23293.0574   517%     -   59s
H    0     0                    -5536.419580 23293.0574   521%     -   59s
H    0     0                    -5445.549678 23293.0574   528%     -   59s
H    0     0                    -5387.343057 23293.0574   532%     -   59s
H    0     0                    -5132.938723 23293.0574   554%     -   59s
H    0     0                    -4930.622600 23293.0574   572%     -   59s
H    0     0                    -4820.571387 23293.0574   583%     -   60s
H    0     0                    -4763.145166 23293.0574   589%     -   60s
H    0     0                    -4739.983246 23293.0574   591%     -   60s
H    0     0                    -4689.910123 23293.0574   597%     -   60s
H    0     0                    -4664.993198 23293.0574   599%     -   60s
     0     0 22695.4619    0  337 -4664.9932 22695.4619   587%     -   67s
     0     0 22571.2843    0  351 -4664.9932 22571.2843   584%     -   71s
     0     0 22490.2672    0  353 -4664.9932 22490.2672   582%     -   74s
     0     0 22465.5449    0  350 -4664.9932 22465.5449   582%     -   75s
     0     0 22455.1403    0  345 -4664.9932 22455.1403   581%     -   76s
     0     0 22450.0297    0  348 -4664.9932 22450.0297   581%     -   76s
     0     0 22448.2246    0  351 -4664.9932 22448.2246   581%     -   76s
     0     0 22428.2175    0  357 -4664.9932 22428.2175   581%     -   77s
     0     0 22425.6413    0  354 -4664.9932 22425.6413   581%     -   77s
     0     0 22404.0195    0  352 -4664.9932 22404.0195   580%     -   79s
     0     0 22392.2451    0  363 -4664.9932 22392.2451   580%     -   80s
     0     0 22375.2908    0  353 -4664.9932 22375.2908   580%     -   80s
     0     0 22370.3553    0  358 -4664.9932 22370.3553   580%     -   81s
     0     0 22369.7297    0  362 -4664.9932 22369.7297   580%     -   81s
H    0     0                    -4620.875654 21067.0657   556%     -   98s
H    0     0                    -4391.791845 21067.0657   580%     -   98s
     0     0 21067.0657    0  397 -4391.7918 21067.0657   580%     -   98s
H    0     0                    -4290.657708 21067.0567   591%     -   98s
H    0     0                    -4215.881292 21067.0567   600%     -   98s
     0     0 20623.1014    0  433 -4215.8813 20623.1014   589%     -  106s
H    0     0                    -1015.491312 20342.8730  2103%     -  111s
     0     0 20342.8730    0  432 -1015.4913 20342.8730  2103%     -  111s
H    0     0                    -732.7599848 20228.6397  2861%     -  114s
     0     0 20228.6397    0  433 -732.75998 20228.6397  2861%     -  114s
     0     0 20134.8100    0  444 -732.75998 20134.8100  2848%     -  117s
H    0     0                    -678.0426817 20087.3487  3063%     -  119s
H    0     0                    -625.4218241 20087.3487  3312%     -  119s
H    0     0                    -620.0515618 20087.3487  3340%     -  119s
H    0     0                    -602.3711307 20087.3487  3435%     -  119s
H    0     0                    -275.1527211 20087.3487  7400%     -  119s
H    0     0                    -184.4716101 20087.3487      -     -  119s
H    0     0                     -18.8012148 20087.3487      -     -  119s
H    0     0                      17.8875540 20087.3487      -     -  119s
H    0     0                      29.9069025 20087.3487      -     -  119s
H    0     0                      30.2972411 20087.3487      -     -  119s
H    0     0                      90.1925589 20087.3487      -     -  119s
     0     0 20087.3487    0  436   90.19256 20087.3487      -     -  119s
H    0     0                     787.3557265 20079.1740  2450%     -  120s
H    0     0                     799.8535708 20079.1740  2410%     -  120s
     0     0 20079.1740    0  440  799.85357 20079.1740  2410%     -  120s
     0     0 20036.6872    0  426  799.85357 20036.6872  2405%     -  121s
     0     0 20034.0403    0  428  799.85357 20034.0403  2405%     -  121s
H    0     0                     822.4491709 20033.5120  2336%     -  122s
H    0     0                     850.1748528 20033.5120  2256%     -  122s
H    0     0                     872.2139162 20033.5120  2197%     -  122s
H    0     0                     893.4290043 20033.5120  2142%     -  122s
     0     0 20033.5120    0  429  893.42900 20033.5120  2142%     -  122s
     0     0 19252.2984    0  467  893.42900 19252.2984  2055%     -  132s
H    0     0                     937.9622417 19252.0842  1953%     -  133s
H    0     0                    1029.9895455 19252.0842  1769%     -  133s
H    0     0                    1048.3256814 19252.0842  1736%     -  133s
H    0     0                    1074.3898998 19252.0842  1692%     -  133s
     0     0 19141.8590    0  464 1074.38990 19141.8590  1682%     -  137s
     0     0 19094.3644    0  524 1074.38990 19094.3644  1677%     -  140s
     0     0 19047.7331    0  477 1074.38990 19047.7331  1673%     -  141s
     0     0 19039.7384    0  478 1074.38990 19039.7384  1672%     -  142s
     0     0 18942.3245    0  455 1074.38990 18942.3245  1663%     -  144s
     0     0 18899.7392    0  521 1074.38990 18899.7392  1659%     -  146s
     0     0 18890.5208    0  517 1074.38990 18890.5208  1658%     -  147s
     0     0 18885.6598    0  465 1074.38990 18885.6598  1658%     -  147s
     0     0 18883.6566    0  463 1074.38990 18883.6566  1658%     -  148s
     0     0 18879.7915    0  461 1074.38990 18879.7915  1657%     -  148s
     0     0 18874.0962    0  466 1074.38990 18874.0962  1657%     -  149s
     0     0 18873.9336    0  464 1074.38990 18873.9336  1657%     -  149s
     0     0 18644.4734    0  511 1074.38990 18644.4734  1635%     -  153s
H    0     0                    1731.2476434 18637.9620   977%     -  153s
H    0     0                    1865.2739801 18637.9620   899%     -  153s
     0     0 18539.2406    0  508 1865.27398 18539.2406   894%     -  156s
     0     0 18501.8730    0  518 1865.27398 18501.8730   892%     -  158s
     0     0 18481.8424    0  520 1865.27398 18481.8424   891%     -  159s
     0     0 18478.1309    0  521 1865.27398 18478.1309   891%     -  159s
     0     0 18476.4571    0  521 1865.27398 18476.4571   891%     -  159s
     0     0 18475.6637    0  521 1865.27398 18475.6637   891%     -  160s
     0     0 18369.5800    0  513 1865.27398 18369.5800   885%     -  163s
     0     0 18353.1482    0  524 1865.27398 18353.1482   884%     -  165s
     0     0 18328.8224    0  476 1865.27398 18328.8224   883%     -  166s
     0     0 18312.1182    0  480 1865.27398 18312.1182   882%     -  167s
     0     0 18300.0582    0  476 1865.27398 18300.0582   881%     -  168s
     0     0 18297.5805    0  484 1865.27398 18297.5805   881%     -  168s
     0     0 18295.7362    0  483 1865.27398 18295.7362   881%     -  168s
     0     0 18295.3269    0  482 1865.27398 18295.3269   881%     -  169s
     0     0 18258.1746    0  519 1865.27398 18258.1746   879%     -  171s
     0     0 18253.0751    0  473 1865.27398 18253.0751   879%     -  172s
     0     0 18249.5393    0  475 1865.27398 18249.5393   878%     -  172s
     0     0 18246.5272    0  520 1865.27398 18246.5272   878%     -  173s
     0     0 18244.6740    0  481 1865.27398 18244.6740   878%     -  173s
     0     0 18244.2328    0  479 1865.27398 18244.2328   878%     -  173s
     0     0 18219.9199    0  516 1865.27398 18219.9199   877%     -  175s
     0     0 18217.8262    0  506 1865.27398 18217.8262   877%     -  176s
     0     0 18216.9281    0  514 1865.27398 18216.9281   877%     -  177s
     0     0 18212.2405    0  474 1865.27398 18212.2405   876%     -  178s
     0     0 18209.7787    0  527 1865.27398 18209.7787   876%     -  178s
     0     0 18209.5084    0  525 1865.27398 18209.5084   876%     -  178s
     0     0 18208.6545    0  530 1865.27398 18208.6545   876%     -  179s
H    0     0                    1927.4376662 18208.2237   845%     -  181s
     0     0 18208.2237    0  529 1927.43767 18208.2237   845%     -  181s
     0     0 18206.4941    0  525 1927.43767 18206.4941   845%     -  182s
     0     0 18206.4734    0  525 1927.43767 18206.4734   845%     -  183s
H    0     0                    2009.1266339 18206.4632   806%     -  218s
H    0     0                    2033.3357880 18206.4632   795%     -  219s
H    0     0                    2035.8414637 18206.4632   794%     -  219s
     0     2 18206.4632    0  525 2035.84146 18206.4632   794%     -  220s
     3     8 17888.5513    2  454 2035.84146 17901.4618   779%  4004  229s
     7    16 17841.3531    3  452 2035.84146 17887.2971   779%  4211  235s
    15    32 17792.2595    4  452 2035.84146 17840.3043   776%  4997  241s
    31    48 16440.1100    5  451 2035.84146 17792.2197   774%  7681  259s
    47    80 15577.0824    6  429 2035.84146 17792.2197   774%  8145  266s
H   52    80                    2036.9533400 17792.2197   773%  7951  266s
H   55    80                    2069.0966333 17792.2197   760%  7783  266s
H   66    80                    2134.9421668 17792.2197   733%  7248  266s
H   71    80                    2141.6234933 17792.2197   731%  6964  266s
    79   178 15489.0793    7  425 2141.62349 17792.2197   731%  6539  275s
   177   280 15316.4614   10  422 2141.62349 17792.2197   731%  4255  283s
H  261   280                    2226.2108560 17792.2197   699%  3537  283s
   279   356 15179.6815   12  412 2226.21086 17792.2197   699%  3429  290s
   355   422 14559.1403   13  340 2226.21086 17792.2197   699%  3139  296s
H  359   422                    2438.6656273 17792.2197   630%  3137  296s
   421   486 14745.4250   14  358 2438.66563 17792.2197   630%  3089  302s
   485   536 14922.6572   15  383 2438.66563 17792.2197   630%  3022  309s
H  495   536                    2441.7702049 17792.2197   629%  3015  309s
H  502   536                    2471.0812760 17792.2197   620%  3031  309s
H  520   536                    2472.0434392 17792.2197   620%  3019  309s
H  528   536                    2520.2039624 17792.2197   606%  3015  309s
   535   616 12574.9696   14  243 2520.20396 17792.2197   606%  3008  315s
   615   672 14380.9787   14  402 2520.20396 17792.2197   606%  2989  320s
H  621   672                    3462.6572111 17792.2197   414%  2976  320s
   680   737 14721.0485   15  363 3462.65721 17792.2197   414%  2993  328s
   757   788 14785.0184   16  388 3462.65721 17792.2197   414%  3065  333s
H  759   788                    3492.0292720 17792.2197   410%  3062  333s
H  774   788                    3541.2279632 17792.2197   402%  3056  333s
H  777   788                    3702.1498657 17792.2197   381%  3064  333s
   826   827 13636.6442   15  267 3702.14987 17792.2197   381%  3091  341s
   903   867 14520.9165   16  386 3702.14987 17792.2197   381%  3116  349s
H  905   867                    3718.9556242 17792.2197   378%  3116  349s
H  957   867                    3753.5661025 17792.2197   374%  3226  349s
   963   898 14240.0174   16  390 3753.56610 17792.2197   374%  3233  355s
  1040   922 13151.5422   16  380 3753.56610 17792.2197   374%  3336  363s
H 1063   922                    3808.8982179 17792.2197   367%  3407  363s
  1078   976 13611.2711   16  371 3808.89822 17792.2197   367%  3456  371s
  1154  1010 13956.8058   17  374 3808.89822 17792.2197   367%  3546  380s
H 1190  1010                    3813.2731691 17792.2197   367%  3552  380s
  1228  1072 13109.8020   17  248 3813.27317 17506.4039   359%  3583  388s
  1290  1142 12368.0945   17  382 3813.27317 17506.4039   359%  3704  396s
H 1304  1142                    3906.2575237 17506.4039   348%  3701  396s
  1366  1171 11853.6235   18  379 3906.25752 17506.4039   348%  3718  401s
H 1386  1171                    3949.3009154 17506.4039   343%  3723  401s
  1401  1225 10973.2091   18  372 3949.30092 17506.4039   343%  3737  408s
H 1432  1225                    3958.6933547 17506.4039   342%  3741  408s
  1485  1285 11073.1304   18  309 3958.69335 17506.4039   342%  3753  417s
  1583  1323 9732.02332   18  284 3958.69335 17506.4039   342%  3771  427s
  1675  1372 9973.06203   18  217 3958.69335 17506.4039   342%  3800  438s
  1780  1399 10045.7058   19  395 3958.69335 17506.4039   342%  3798  448s
H 1782  1399                    3973.7597274 17506.4039   341%  3797  448s
H 1851  1399                    4024.4964360 17506.4039   335%  3776  448s
  1857  1472 9365.29995   19  347 4024.49644 17506.4039   335%  3775  459s
  1964  1562     cutoff   20      4024.49644 17506.4039   335%  3787  467s
  2084  1595 8038.90555   23  369 4024.49644 17506.4039   335%  3802  474s
H 2096  1595                    6112.5578836 17506.4039   186%  3812  474s
  2153  1601 7795.84865   22  280 6112.55788 17506.4039   186%  3828  486s
  2281  1646     cutoff   24      6112.55788 17506.4039   186%  3846  497s
  2368  1713 7087.96765   25  270 6112.55788 17506.4039   186%  3939  507s
  2459  1772     cutoff   30      6112.55788 17506.4039   186%  4052  520s
  2546  1867 10019.4950   13  278 6112.55788 17506.4039   186%  4160  531s
  2673  1885 9997.60860   14  266 6112.55788 17506.4039   186%  4216  544s
  2807  1898 9389.07783   17  208 6112.55788 17506.4039   186%  4251  556s
  2952  1922 8394.27545   20  199 6112.55788 17506.4039   186%  4275  568s
H 2958  1919                    6169.1656656 17506.4039   184%  4272  568s
  3125  2042 8162.66162   23  249 6169.16567 17506.4039   184%  4257  581s
H 3314  2057                    6177.8392542 17506.4039   183%  4251  593s
H 3332  2057                    6180.2807429 17506.4039   183%  4263  593s
H 3335  2028                    6335.5427081 17506.4039   176%  4264  593s
H 3350  2004                    6463.7883388 16905.4349   162%  4269  593s
H 3362  2093                    6497.4748668 16905.4349   160%  4273  606s
H 3525  2101                    6625.7178029 16905.4349   155%  4264  615s
  3587  2227 7075.06884   37  236 6625.71780 16905.4349   155%  4261  628s
  3799  2353 11088.0072   13  336 6625.71780 16905.4349   155%  4260  643s
  4054  2354 14597.9077    8  525 6625.71780 16905.4349   155%  4205  769s
  4056  2355 12829.2619   20  198 6625.71780 16905.4349   155%  4203  800s
  4057  2356 10233.0768   27  351 6625.71780 16905.4349   155%  4202  817s
  4058  2357 7350.42323   20  438 6625.71780 16905.4349   155%  4201  829s
  4059  2357 13268.4333   23  505 6625.71780 16905.4349   155%  4200  838s
  4060  2358 13647.7749   20  488 6625.71780 16905.4349   155%  4199  843s
  4061  2359 6902.83281   15  512 6625.71780 16905.4349   155%  4198  848s
  4062  2359 9574.50861   35  516 6625.71780 16905.4349   155%  4197  850s
  4064  2361 14328.5939    8  507 6625.71780 16905.4349   155%  4195  855s
  4068  2363 11834.1382   20  453 6625.71780 16905.4349   155%  4191  860s
  4070  2365 9351.10135   12  477 6625.71780 16905.4349   155%  4189  866s
  4073  2367 12871.5918   18  477 6625.71780 16905.4349   155%  4185  870s
  4076  2369 8601.54556   17  458 6625.71780 16905.4349   155%  4182  876s
  4080  2371 12162.0230   15  461 6625.71780 16905.4349   155%  4178  883s
  4082  2373 7178.84837   30  452 6625.71780 16905.4349   155%  4176  885s
  4084  2374 8542.43399   27  517 6625.71780 16905.4349   155%  4174  893s
  4086  2375 8780.34044   17  456 6625.71780 16905.4349   155%  4172  895s
  4087  2376 7933.20816   51  510 6625.71780 16905.4349   155%  4171  901s
  4090  2378 11402.2527   11  485 6625.71780 16905.4349   155%  4168  908s
  4092  2379 12511.5971   20  456 6625.71780 16905.4349   155%  4166  910s
  4094  2381 14012.0032   13  521 6625.71780 16905.4349   155%  4164  917s
  4096  2382 6975.21799   16  532 6625.71780 16905.4349   155%  4162  921s
  4097  2383 7518.63520   20  556 6625.71780 16905.4349   155%  4161  926s
  4099  2384 8317.95959   22  561 6625.71780 16905.4349   155%  4159  930s
  4101  2385 14245.4177   10  523 6625.71780 16905.4349   155%  4157  965s
  4102  2386 10018.3688   14  523 6625.71780 16905.4349   155%  4156  989s
  4103  2390 16905.4349   10  515 6625.71780 16905.4349   155%  4207 1045s
  4105  2393 16905.4349   11  515 6625.71780 16905.4349   155%  4207 1064s
  4109  2400 16836.3909   12  533 6625.71780 16905.4349   155%  4215 1083s
  4117  2413 16394.1244   13  531 6625.71780 16835.4640   154%  4221 1094s
  4133  2423 14558.0463   14  464 6625.71780 16394.1052   147%  4270 1121s
  4149  2447 12754.1772   15  389 6625.71780 16394.1052   147%  4287 1143s
  4181  2559 12634.3117   16  380 6625.71780 16065.8556   142%  4327 1161s
  4311  2564 12193.0852   18  491 6625.71780 16065.8556   142%  4339 1173s
H 4331  2437                    7030.8724553 16065.8556   129%  4336 1173s
H 4338  2320                    7443.1851049 16065.8556   116%  4337 1173s
  4366  2333 9996.21029   19  238 7443.18510 16065.8556   116%  4339 1185s
  4421  2334 8262.22965   18  220 7443.18510 16065.8556   116%  4348 1196s
  4456  2330 10169.1902   20  282 7443.18510 16065.8556   116%  4368 1207s
  4499  2323 9891.75884   21  502 7443.18510 16065.8556   116%  4407 1219s
H 4501  2214                    7779.5392482 16065.8556   107%  4407 1219s
  4534  2211 9314.56588   21  333 7779.53925 16065.8556   107%  4420 1235s
  4573  2195 8937.08336   20  243 7779.53925 16065.8556   107%  4424 1245s
  4623  2189 8791.06370   21  248 7779.53925 16065.8556   107%  4409 1256s
  4662  2185 8451.91108   22  246 7779.53925 16065.8556   107%  4407 1267s
  4707  2180 8449.66357   23  253 7779.53925 16065.8556   107%  4416 1278s
  4759  2174     cutoff   24      7779.53925 15603.4346   101%  4414 1292s
  4813  2163 13999.2875   15  475 7779.53925 15603.4346   101%  4411 1303s
  4876  2164 13209.7688   16  407 7779.53925 15542.9910   100%  4396 1315s
  4936  2169 10722.2670   17  299 7779.53925 15542.9910   100%  4391 1327s
  5003  2159 9274.35795   19  276 7779.53925 15542.9910   100%  4386 1338s
  5069  2151 8129.38127   20  186 7779.53925 15270.8182  96.3%  4384 1350s
  5130  2142     cutoff   21      7779.53925 14494.3058  86.3%  4389 1365s
  5200  2125 9038.20541   19  328 7779.53925 14494.3058  86.3%  4390 1379s
  5255  2127 8973.99481   20  326 7779.53925 14494.3058  86.3%  4393 1392s
  5310  2120 8121.73401   22  320 7779.53925 14494.3058  86.3%  4402 1405s
  5373  2112 8120.35700   23  324 7779.53925 14494.3058  86.3%  4403 1419s
  5446  2085     cutoff   24      7779.53925 13950.6497  79.3%  4408 1435s
  5523  2053 10442.8479   17  473 7779.53925 13743.8991  76.7%  4417 1451s
  5590  2036 12027.6121   17  482 7779.53925 13743.8991  76.7%  4431 1469s
  5664  2034 11626.4676   18  384 7779.53925 13397.2516  72.2%  4456 1485s
  5738  2027 9783.04837   18  424 7779.53925 13397.2516  72.2%  4470 1502s
  5836  2005 9861.15113   19  409 7779.53925 13397.2516  72.2%  4475 1521s
  5945  1968 9186.40338   21  387 7779.53925 13222.8362  70.0%  4469 1539s
  5994  1975 9398.99596   21  370 7779.53925 13046.5612  67.7%  4484 1556s
  6060  1954 9161.75678   22  383 7779.53925 13046.5612  67.7%  4480 1570s
  6119  1943 9076.34576   23  335 7779.53925 12867.2721  65.4%  4481 1589s
  6189  1932 8923.03223   24  330 7779.53925 12867.2721  65.4%  4484 1607s
  6274  1912 8540.89408   25  306 7779.53925 12690.6115  63.1%  4475 1627s
  6363  1897     cutoff   29      7779.53925 12506.3428  60.8%  4471 1651s
  6462  1882 infeasible   20      7779.53925 12500.5602  60.7%  4476 1671s
  6579  1854 7832.42428   22  314 7779.53925 12373.8597  59.1%  4471 1693s
  6722  1791     cutoff   28      7779.53925 12231.0940  57.2%  4468 1719s
  6856  1744 9351.97344   16  306 7779.53925 12195.1391  56.8%  4477 1743s
  7016  1692     cutoff   17      7779.53925 11858.3132  52.4%  4479 1769s
  7120  1678 9083.33055   17  373 7779.53925 11858.3132  52.4%  4484 1795s
  7284  1640 infeasible   18      7779.53925 11858.3132  52.4%  4469 1823s
  7491  1557 9618.05622   26  166 7779.53925 11572.4519  48.8%  4447 1853s
  7657  1469 9216.00715   27  112 7779.53925 11572.4519  48.8%  4460 1881s
  7852  1447     cutoff   28      7779.53925 11064.5351  42.2%  4464 1911s
  8095  1378 9429.53093   26  338 7779.53925 10614.5361  36.4%  4439 1943s
  8422  1234 9179.57540   27  218 7779.53925 10614.5361  36.4%  4379 1975s
  8798  1037 8962.43456   28  251 7779.53925 10064.6818  29.4%  4308 2009s
  9274   732 infeasible   33      7779.53925 9709.53141  24.8%  4209 2039s
  9834   350 infeasible   28      7779.53925 9340.48132  20.1%  4082 2066s
 10395    17 8589.87182   27  233 7779.53925 9265.41271  19.1%  3946 2088s
 10819     0 infeasible   32      7779.53925 8326.03204  7.02%  3836 2092s

Cutting planes:
  MIR: 625
  Flow cover: 1682
  RLT: 24
  Relax-and-lift: 165

Explored 10836 nodes (41796022 simplex iterations) in 2092.57 seconds (6414.79 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 7779.54 7443.19 7030.87 ... 6169.17

Optimal solution found (tolerance 1.00e-04)
Best objective 7.779539248181e+03, best bound 7.779539248181e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2092.65s
  Master Objective (UB) = 7779.54, θ = 145097.96
  Upper Bound (UB) = 7779.54

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 145097.96
  [DEBUG]   ✓ Scenario 0: θ = 145097.96 ≤ Q = 145097.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 145097.96 ≤ Q = 145097.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 145097.96 ≤ Q = 145097.96 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 145097.96 ≤ Q = 145097.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 145097.96 ≤ Q = 145097.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 145097.96 ≤ Q = 145097.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 145097.96 ≤ Q = 145097.96 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 145097.96 ≤ Q = 145097.96 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x6b688e50
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x6b688e50
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [5e-14, 2e+02]
Found heuristic solution: objective 1.205159e+13
Presolve removed 2613 rows and 1904 columns
Presolve time: 0.00s
Presolved: 480 rows, 485 columns, 1318 nonzeros
Found heuristic solution: objective 5550568.7773
Variable types: 329 continuous, 156 integer (156 binary)

Root relaxation: objective -1.478071e+05, 229 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -147807.10    0  121 5550568.78 -147807.10   103%     -    0s
H    0     0                    -114261.2441 -147807.10  29.4%     -    0s
H    0     0                    -115179.8220 -147807.10  28.3%     -    0s
     0     0 -119897.25    0  102 -115179.82 -119897.25  4.10%     -    0s
H    0     0                    -117078.6752 -119862.79  2.38%     -    0s
H    0     0                    -117424.1928 -119862.79  2.08%     -    0s
     0     0 -119171.28    0   68 -117424.19 -119171.28  1.49%     -    0s
H    0     0                    -117805.5344 -119159.28  1.15%     -    0s
H    0     0                    -118151.0519 -119159.28  0.85%     -    0s
     0     0 -119159.28    0   68 -118151.05 -119159.28  0.85%     -    0s
     0     0 -118929.90    0   54 -118151.05 -118929.90  0.66%     -    0s
     0     0 -118861.92    0   62 -118151.05 -118861.92  0.60%     -    0s
     0     0 -118859.91    0   59 -118151.05 -118859.91  0.60%     -    0s
     0     0 -118799.49    0   45 -118151.05 -118799.49  0.55%     -    0s
H    0     0                    -118155.0393 -118794.41  0.54%     -    0s
     0     0 -118794.41    0   42 -118155.04 -118794.41  0.54%     -    0s
     0     0 -118776.80    0   41 -118155.04 -118776.80  0.53%     -    0s
     0     0 -118775.87    0   41 -118155.04 -118775.87  0.53%     -    0s
H    0     0                    -118252.5304 -118775.61  0.44%     -    0s
     0     2 -118775.61    0   41 -118252.53 -118775.61  0.44%     -    0s
*   32    13               6    -118645.0109 -118645.01  0.00%   8.8    0s

Cutting planes:
  Gomory: 22
  Implied bound: 3
  MIR: 153
  Flow cover: 20
  RLT: 32
  Relax-and-lift: 9
  BQP: 1

Explored 43 nodes (859 simplex iterations) in 0.08 seconds (0.06 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -118645 -118253 -118155 ... 5.55057e+06
No other solutions better than -118645

Optimal solution found (tolerance 1.00e-04)
Best objective -1.186450109133e+05, best bound -1.186450109133e+05, gap 0.0000%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 142539.58
  Scenario: 13 demand increases, 46 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -118645.01
  [DEBUG]   S×d_nominal = 261184.59
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 261184.59 + -118645.01 = 142539.58
  [DEBUG]   Current θ from Master = 145097.96
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2558.38 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 5221.16
  Lower Bound (LB) = 5221.16
  Gap (UB-LB) = 2558.3794, Absolute Gap = 2558.3794, Relative Gap = 0.328860
  Not converged yet (gap = 2558.38 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 13 increases, 46 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394544 nonzeros
Model fingerprint: 0x9f9acc44
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 65588 rows and 26638 columns
Presolve time: 1.23s
Presolved: 73405 rows, 31782 columns, 457259 nonzeros
Variable types: 29523 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -333055.8495
Found heuristic solution: objective -217726.0351

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 73405 rows, 31782 columns, 457259 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   31017   -7.5381202e+04   0.000000e+00   1.228365e+08      5s
   43108   -2.2722096e+04   0.000000e+00   2.615003e+08     10s
   54469   -5.5948553e+02   0.000000e+00   2.228367e+08     15s
   61552    3.5969221e+03   0.000000e+00   2.645991e+06     20s
Concurrent spin time: 0.36s

Solved with dual simplex

Root relaxation: objective 3.025156e+04, 47947 iterations, 22.55 seconds (46.72 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 30251.5582    0  198 -217726.04 30251.5582   114%     -   24s
H    0     0                    -214277.6555 30251.5582   114%     -   24s
H    0     0                    -142226.2365 30251.5582   121%     -   24s
H    0     0                    -94625.56425 30251.5582   132%     -   24s
H    0     0                    -91330.44133 30251.5582   133%     -   24s
H    0     0                    -89791.75191 30251.5582   134%     -   24s
H    0     0                    -88670.73917 30251.5582   134%     -   24s
H    0     0                    -88370.91182 30251.5582   134%     -   24s
H    0     0                    -81115.90948 30251.5582   137%     -   24s
H    0     0                    -17999.49803 30251.5582   268%     -   25s
H    0     0                    -14301.83807 30251.5582   312%     -   25s
H    0     0                    -9575.558297 30251.5582   416%     -   25s
H    0     0                    -8730.996154 30251.5582   446%     -   25s
     0     0 26672.1913    0  205 -8730.9962 26672.1913   405%     -   31s
     0     0 26151.0066    0  244 -8730.9962 26151.0066   400%     -   34s
     0     0 26109.6359    0  243 -8730.9962 26109.6359   399%     -   34s
     0     0 26109.5873    0  245 -8730.9962 26109.5873   399%     -   35s
     0     0 26108.9129    0  243 -8730.9962 26108.9129   399%     -   35s
     0     0 26107.2097    0  245 -8730.9962 26107.2097   399%     -   36s
     0     0 26107.2097    0  245 -8730.9962 26107.2097   399%     -   36s
H    0     0                    -8465.226569 23195.5965   374%     -   44s
     0     0 23195.5965    0  322 -8465.2266 23195.5965   374%     -   44s
H    0     0                    -7219.072998 23195.4100   421%     -   45s
H    0     0                    -7012.214964 23195.4100   431%     -   45s
H    0     0                    -7007.428700 23195.4100   431%     -   45s
H    0     0                    -6972.989863 23195.4100   433%     -   45s
H    0     0                    -6881.118928 23195.4100   437%     -   45s
H    0     0                    -6706.328219 23195.4100   446%     -   45s
H    0     0                    -6628.298006 23195.4100   450%     -   45s
H    0     0                    -6600.358504 23195.4100   451%     -   45s
     0     0 22624.7671    0  340 -6600.3585 22624.7671   443%     -   53s
     0     0 22229.4001    0  329 -6600.3585 22229.4001   437%     -   58s
     0     0 22181.0167    0  330 -6600.3585 22181.0167   436%     -   60s
     0     0 22145.4698    0  335 -6600.3585 22145.4698   436%     -   61s
     0     0 22101.7280    0  343 -6600.3585 22101.7280   435%     -   63s
     0     0 22079.4490    0  342 -6600.3585 22079.4490   435%     -   64s
     0     0 22076.7999    0  341 -6600.3585 22076.7999   434%     -   65s
     0     0 22076.4661    0  344 -6600.3585 22076.4661   434%     -   65s
H    0     0                    -1229.083613 20447.0803  1764%     -   80s
H    0     0                    -1106.442007 20447.0803  1948%     -   80s
H    0     0                    -326.4286818 20447.0803  6364%     -   80s
     0     0 20447.0803    0  404 -326.42868 20447.0803  6364%     -   80s
H    0     0                     238.3635988 20446.7327  8478%     -   80s
H    0     0                     282.8740465 20446.7327  7128%     -   80s
H    0     0                     542.4954100 20446.7327  3669%     -   80s
H    0     0                     881.0134146 20446.7327  2221%     -   80s
H    0     0                    1070.4495497 20446.7327  1810%     -   80s
H    0     0                    1372.4841267 20446.7327  1390%     -   80s
H    0     0                    1405.0468431 20446.7327  1355%     -   80s
H    0     0                    1444.6827597 20446.7327  1315%     -   80s
H    0     0                    1472.3141137 20446.7327  1289%     -   80s
     0     0 20139.8884    0  409 1472.31411 20139.8884  1268%     -   85s
     0     0 19912.2528    0  425 1472.31411 19912.2528  1252%     -   89s
     0     0 19894.9636    0  423 1472.31411 19894.9636  1251%     -   91s
     0     0 19838.5496    0  428 1472.31411 19838.5496  1247%     -   93s
     0     0 19802.1778    0  436 1472.31411 19802.1778  1245%     -   94s
     0     0 19782.5977    0  437 1472.31411 19782.5977  1244%     -   95s
     0     0 19772.5503    0  436 1472.31411 19772.5503  1243%     -   96s
     0     0 19770.7365    0  443 1472.31411 19770.7365  1243%     -   96s
     0     0 19761.1470    0  446 1472.31411 19761.1470  1242%     -   97s
     0     0 19751.5934    0  441 1472.31411 19751.5934  1242%     -   98s
     0     0 19747.2335    0  442 1472.31411 19747.2335  1241%     -   99s
     0     0 19746.4534    0  444 1472.31411 19746.4534  1241%     -   99s
     0     0 19235.4153    0  510 1472.31411 19235.4153  1206%     -  108s
     0     0 19046.8454    0  460 1472.31411 19046.8454  1194%     -  112s
     0     0 18916.6801    0  459 1472.31411 18916.6801  1185%     -  114s
     0     0 18847.6880    0  454 1472.31411 18847.6880  1180%     -  116s
     0     0 18814.1902    0  450 1472.31411 18814.1902  1178%     -  117s
     0     0 18798.9217    0  462 1472.31411 18798.9217  1177%     -  118s
     0     0 18790.0868    0  452 1472.31411 18790.0868  1176%     -  119s
     0     0 18752.7194    0  443 1472.31411 18752.7194  1174%     -  120s
     0     0 18746.1563    0  443 1472.31411 18746.1563  1173%     -  120s
     0     0 18742.3254    0  445 1472.31411 18742.3254  1173%     -  121s
     0     0 18741.7134    0  497 1472.31411 18741.7134  1173%     -  121s
     0     0 18637.3001    0  476 1472.31411 18637.3001  1166%     -  125s
     0     0 18599.7397    0  484 1472.31411 18599.7397  1163%     -  127s
     0     0 18576.6650    0  490 1472.31411 18576.6650  1162%     -  128s
     0     0 18572.5398    0  545 1472.31411 18572.5398  1161%     -  128s
     0     0 18571.1775    0  540 1472.31411 18571.1775  1161%     -  129s
     0     0 18570.8163    0  547 1472.31411 18570.8163  1161%     -  129s
     0     0 18499.6383    0  540 1472.31411 18499.6383  1157%     -  133s
H    0     0                    1504.7236195 18499.3539  1129%     -  134s
     0     0 18476.8544    0  538 1504.72362 18476.8544  1128%     -  136s
     0     0 18452.7188    0  490 1504.72362 18452.7188  1126%     -  137s
     0     0 18442.9707    0  492 1504.72362 18442.9707  1126%     -  138s
     0     0 18440.9582    0  490 1504.72362 18440.9582  1126%     -  138s
     0     0 18440.2311    0  490 1504.72362 18440.2311  1125%     -  138s
     0     0 18396.4235    0  480 1504.72362 18396.4235  1123%     -  141s
     0     0 18359.1413    0  540 1504.72362 18359.1413  1120%     -  143s
     0     0 18349.1155    0  512 1504.72362 18349.1155  1119%     -  144s
     0     0 18341.9024    0  516 1504.72362 18341.9024  1119%     -  145s
     0     0 18340.9130    0  513 1504.72362 18340.9130  1119%     -  145s
     0     0 18312.1517    0  485 1504.72362 18312.1517  1117%     -  148s
H    0     0                    1568.4369146 18312.0171  1068%     -  149s
H    0     0                    1594.0652571 18312.0171  1049%     -  149s
H    0     0                    1681.4618449 18312.0171   989%     -  149s
H    0     0                    1713.4053210 18312.0171   969%     -  149s
H    0     0                    1958.3990818 18312.0171   835%     -  149s
     0     0 18297.1624    0  544 1958.39908 18297.1624   834%     -  150s
     0     0 18291.5555    0  497 1958.39908 18291.5555   834%     -  150s
     0     0 18286.5056    0  494 1958.39908 18286.5056   834%     -  151s
     0     0 18284.9778    0  498 1958.39908 18284.9778   834%     -  152s
     0     0 18284.8914    0  502 1958.39908 18284.8914   834%     -  152s
     0     0 18253.8351    0  558 1958.39908 18253.8351   832%     -  154s
H    0     0                    1965.4178972 18253.6787   829%     -  154s
     0     0 18247.2366    0  567 1965.41790 18247.2366   828%     -  155s
     0     0 18246.0719    0  529 1965.41790 18246.0719   828%     -  156s
     0     0 18230.0311    0  563 1965.41790 18230.0311   828%     -  158s
     0     0 18224.0618    0  564 1965.41790 18224.0618   827%     -  162s
     0     0 18219.5625    0  574 1965.41790 18219.5625   827%     -  163s
     0     0 18217.8447    0  568 1965.41790 18217.8447   827%     -  163s
     0     0 18217.5997    0  576 1965.41790 18217.5997   827%     -  163s
     0     0 18204.8997    0  558 1965.41790 18204.8997   826%     -  165s
     0     0 18199.6287    0  571 1965.41790 18199.6287   826%     -  166s
     0     0 18199.0634    0  565 1965.41790 18199.0634   826%     -  167s
     0     0 18195.7073    0  566 1965.41790 18195.7073   826%     -  168s
H    0     0                    2269.2459131 18195.5736   702%     -  169s
H    0     0                    2322.9613704 18195.5736   683%     -  170s
H    0     0                    2380.3135489 18195.5736   664%     -  170s
H    0     0                    2424.3366990 18195.5736   651%     -  170s
H    0     0                    2451.9801813 18195.5736   642%     -  170s
H    0     0                    2576.7598840 18195.5736   606%     -  170s
H    0     0                    2590.6113091 18195.5736   602%     -  171s
H    0     0                    2609.0446647 18195.5736   597%     -  171s
     0     0 18194.3274    0  567 2609.04466 18194.3274   597%     -  171s
     0     0 18192.3496    0  505 2609.04466 18192.3496   597%     -  172s
H    0     0                    2616.1688626 18192.0946   595%     -  173s
     0     0 18190.7379    0  557 2616.16886 18190.7379   595%     -  173s
     0     0 18190.4256    0  557 2616.16886 18190.4256   595%     -  174s
     0     0 18188.2902    0  549 2616.16886 18188.2902   595%     -  175s
     0     0 18188.2749    0  549 2616.16886 18188.2749   595%     -  176s
H    0     0                    2682.3678749 18188.2459   578%     -  211s
H    0     0                    2723.8780066 18188.2459   568%     -  212s
H    0     0                    2748.5268905 18188.2459   562%     -  220s
H    0     0                    2788.9217518 18188.2459   552%     -  224s
H    0     0                    2855.7571583 18188.2459   537%     -  224s
H    0     0                    3434.6339995 18188.2459   430%     -  229s
H    0     0                    3679.7294344 18188.2459   394%     -  232s
H    0     2                    3750.8072034 18188.2459   385%     -  235s
     0     2 18188.2459    0  549 3750.80720 18188.2459   385%     -  235s
     3     8 17957.4184    2  554 3750.80720 18160.2348   384%  3584  244s
     7    16 17851.7351    3  549 3750.80720 17957.2033   379%  5300  258s
    15    32 17564.4772    4  486 3750.80720 17845.9071   376%  7577  265s
    31    48 16123.8781    5  513 3750.80720 17563.8560   368%  9959  282s
    47    80 15610.9200    6  506 3750.80720 17563.8560   368% 10542  291s
H   48    80                    3849.1583242 17563.8560   356% 10322  291s
H   53    80                    3911.5193049 17563.8560   349% 10034  291s
H   68    80                    3916.5643850 17563.8560   348%  9189  291s
    79   145 15568.6841    7  495 3916.56438 17563.8560   348%  8382  317s
H  144   271                    3925.4188541 17563.8560   347%  6230  330s
   270   368 15360.4970   10  433 3925.41885 17563.8560   347%  4693  339s
   367   445 15271.6485   11  432 3925.41885 17563.8560   347%  4343  347s
H  392   445                    3944.6470358 17563.8560   345%  4265  347s
   444   529 15247.1931   12  441 3944.64704 17563.8560   345%  4106  355s
   528   591 13764.6527   12  312 3944.64704 17563.8560   345%  3920  362s
H  530   591                    3948.2092847 17563.8560   345%  3913  362s
   590   676 15142.9694   13  439 3948.20928 17563.8560   345%  3818  367s
   675   763 15096.8604   14  430 3948.20928 17563.8560   345%  3717  374s
H  680   763                    3974.9539108 17563.8560   342%  3705  374s
   768   839 15085.5097   15  408 3974.95391 17563.8560   342%  3606  380s
   849   887 14257.9659   16  328 3974.95391 17563.8560   342%  3635  388s
H  898   887                    3995.2923869 17563.8560   340%  3651  388s
   905   950 14720.8106   17  397 3995.29239 17563.8560   340%  3639  395s
   993   991 13576.4271   18  446 3995.29239 17563.8560   340%  3653  402s
H 1016   991                    4024.4964360 17563.8560   336%  3649  402s
  1048  1086 12362.1379   17  310 4024.49644 17563.8560   336%  3671  410s
  1155  1167 13988.4123   17  321 4024.49644 17563.8560   336%  3642  417s
  1274  1225 11108.7047   18  387 4024.49644 17563.8560   336%  3600  426s
  1390  1249 13391.5873   19  439 4024.49644 17563.8560   336%  3551  438s
H 1400  1249                    5902.6695511 17563.8560   198%  3579  438s
  1428  1279 13332.9061   19  271 5902.66955 17563.8560   198%  3621  447s
  1519  1322 12702.3685   20  253 5902.66955 17563.8560   198%  3688  457s
  1602  1371 9986.37883   22  186 5902.66955 17563.8560   198%  3807  467s
  1673  1414 6513.42215   21  199 5902.66955 17563.8560   198%  3892  477s
  1774  1489 9520.48840   23  183 5902.66955 17563.8560   198%  3910  487s
  1907  1576 8916.60169   27  214 5902.66955 17403.0451   195%  3902  497s
  2045  1661 8654.81425   31  163 5902.66955 17403.0451   195%  3879  508s
  2173  1756 8284.36249   35  286 5902.66955 17403.0451   195%  3878  519s
  2309  1789 7959.85685   37  195 5902.66955 17269.7420   193%  3879  530s
  2459  1744 7701.49371   40  192 5902.66955 17269.7420   193%  3893  542s
  2500  1768 7013.39965   40  141 5902.66955 17029.1968   188%  3957  555s
  2548  1794 7622.63733   39  189 5902.66955 17023.9633   188%  4020  567s
  2605  1843 8009.69438   41  211 5902.66955 17023.9633   188%  4082  578s
  2712  1911 7944.41725   42  206 5902.66955 17023.9633   188%  4086  590s
  2838  1929 7636.39884   49  224 5902.66955 16397.2477   178%  4092  604s
H 2841  1923                    5968.0720552 16397.2477   175%  4096  604s
H 2848  1922                    6021.1240905 16397.2477   172%  4090  604s
H 2865  1918                    6100.2632603 16397.2477   169%  4117  604s
  2880  1932 7621.60136   50  224 6100.26326 16397.2477   169%  4141  618s
H 2896  1845                    6625.7178029 16247.6486   145%  4151  618s
H 2915  1751                    6985.6259514 16247.6486   133%  4157  618s
  2952  1749 7607.97744   51  221 6985.62595 16247.6486   133%  4156  629s
H 3001  1763                    7334.4174876 16247.6486   122%  4183  641s
  3043  1798     cutoff   50      7334.41749 16247.6486   122%  4227  654s
  3189  1826 12775.6074    9  392 7334.41749 16247.6486   122%  4267  670s
  3346  1881 11164.1830   11  289 7334.41749 16247.6486   122%  4307  684s
  3518  2012 10063.4087   14  234 7334.41749 16247.6486   122%  4342  698s
  3724  2030     cutoff   21      7334.41749 16247.6486   122%  4342  716s
  3920  2105 12201.1072   11  376 7334.41749 16104.1738   120%  4330  731s
  4078  2188 10557.8303   14  335 7334.41749 16104.1738   120%  4400  748s
  4207  2311 10252.2354   16  339 7334.41749 15771.0852   115%  4472  763s
H 4409  2307                    7347.9723287 15771.0852   115%  4509  777s
H 4409  2305                    7370.8860713 15771.0852   114%  4509  781s
H 4409  2260                    7581.8147323 15771.0852   108%  4509  782s
  4410  2261 7805.16503   28  549 7581.81473 15771.0852   108%  4508  839s
  4412  2262 12598.3568   13  198 7581.81473 15771.0852   108%  4506  880s
  4413  2263 9770.84855   20  356 7581.81473 15771.0852   108%  4505  902s
  4414  2264 7800.62813   20  444 7581.81473 15771.0852   108%  4504  918s
  4415  2264 10818.5575   38  528 7581.81473 15771.0852   108%  4503  928s
  4416  2265 13859.5299   12  454 7581.81473 15771.0852   108%  4502  934s
  4417  2266 9205.47557   31  550 7581.81473 15771.0852   108%  4501  940s
  4419  2267 8506.59445   28  532 7581.81473 15771.0852   108%  4499  946s
  4420  2268 13364.3692   16  532 7581.81473 15771.0852   108%  4498  950s
  4422  2269 9122.30380   29  554 7581.81473 15771.0852   108%  4496  955s
  4424  2270 8556.29726   34  531 7581.81473 15771.0852   108%  4494  960s
  4427  2272 13204.8244    8  547 7581.81473 15771.0852   108%  4491  966s
  4428  2273 8387.02759   32  546 7581.81473 15771.0852   108%  4490  973s
  4429  2274 13482.3401   12  544 7581.81473 15771.0852   108%  4489  975s
  4431  2275 10207.5364   22  519 7581.81473 15771.0852   108%  4487  984s
  4432  2276 10599.4941   25  524 7581.81473 15771.0852   108%  4486  987s
  4433  2276 13604.1001   15  521 7581.81473 15771.0852   108%  4485  990s
  4434  2277 14718.3702    7  548 7581.81473 15771.0852   108%  4484  996s
  4436  2278 10603.7863   17  519 7581.81473 15771.0852   108%  4482 1001s
  4437  2279 9931.01992   14  512 7581.81473 15771.0852   108%  4481 1008s
  4438  2280 9543.04373   27  462 7581.81473 15771.0852   108%  4480 1010s
  4441  2282 10614.4622   14  513 7581.81473 15771.0852   108%  4477 1021s
  4443  2283 10609.0899   21  521 7581.81473 15771.0852   108%  4475 1026s
  4444  2284 14137.4256   19  492 7581.81473 15771.0852   108%  4474 1032s
  4445  2284 12409.1032   22  439 7581.81473 15771.0852   108%  4473 1035s
  4447  2286 14241.4705    9  509 7581.81473 15771.0852   108%  4471 1044s
  4448  2286 10422.6868   14  514 7581.81473 15771.0852   108%  4470 1046s
  4450  2288 9531.80006   25  528 7581.81473 15771.0852   108%  4468 1052s
  4451  2288 11858.1923   10  529 7581.81473 15771.0852   108%  4467 1059s
  4452  2289 9896.38226   11  538 7581.81473 15771.0852   108%  4466 1061s
  4454  2290 9493.86812   21  542 7581.81473 15771.0852   108%  4464 1070s
  4457  2292 10660.7692   15  549 7581.81473 15771.0852   108%  4461 1079s
  4458  2293 8608.85058   26  483 7581.81473 15771.0852   108%  4460 1081s
  4459  2294 14766.6765    8  540 7581.81473 15771.0852   108%  4459 1088s
  4460  2294 7767.97704   35  536 7581.81473 15771.0852   108%  4458 1091s
  4461  2295 12466.4676    9  546 7581.81473 15771.0852   108%  4457 1096s
  4462  2296 7662.47139   41  546 7581.81473 15771.0852   108%  4456 1132s
  4463  2296 13590.1630   11  546 7581.81473 15771.0852   108%  4455 1168s
  4464  2300 15771.0852   12  483 7581.81473 15771.0852   108%  4521 1182s
  4466  2303 15771.0852   13  452 7581.81473 15771.0852   108%  4522 1194s
  4470  2310 15771.0852   14  446 7581.81473 15771.0852   108%  4525 1209s
  4478  2323 15771.0852   15  458 7581.81473 15771.0852   108%  4533 1233s
  4494  2326 15771.0852   16  344 7581.81473 15771.0852   108%  4566 1259s
  4510  2343 14625.2276   17  424 7581.81473 15771.0852   108%  4610 1280s
  4534  2430 14516.7314   18  421 7581.81473 15771.0852   108%  4634 1308s
  4634  2434 13944.3075   20  426 7581.81473 15771.0852   108%  4669 1322s
  4673  2470 12910.7442   21  366 7581.81473 15771.0852   108%  4688 1337s
  4744  2477 10263.1861   24  269 7581.81473 15771.0852   108%  4685 1350s
  4807  2501 12391.2392   21  503 7581.81473 15771.0852   108%  4674 1363s
  4883  2492 9959.37217   28  262 7581.81473 15771.0852   108%  4660 1376s
  4926  2508 11151.0689   20  286 7581.81473 15771.0852   108%  4652 1387s
  4977  2515 12334.4630   22  446 7581.81473 15771.0852   108%  4654 1402s
  5050  2505 10930.1088   22  283 7581.81473 15771.0852   108%  4629 1413s
  5134  2490 10815.7033   21  372 7581.81473 15771.0852   108%  4594 1432s
  5202  2489 9594.47851   22  276 7581.81473 15771.0852   108%  4571 1443s
  5269  2499 9570.84657   23  276 7581.81473 15771.0852   108%  4557 1454s
  5334  2504     cutoff   27      7581.81473 15771.0852   108%  4544 1465s
  5406  2505 9167.43927   31  310 7581.81473 15338.3222   102%  4526 1481s
  5475  2496     cutoff   33      7581.81473 14266.9962  88.2%  4508 1493s
  5560  2491 11802.9717   20  375 7581.81473 14266.9962  88.2%  4490 1505s
  5629  2485 11558.1178   21  348 7581.81473 14229.0297  87.7%  4481 1519s
  5725  2490 11246.7141   23  342 7581.81473 14075.0045  85.6%  4455 1532s
  5818  2477 10654.0066   25  190 7581.81473 14075.0045  85.6%  4440 1545s
  5889  2477 8087.69459   27  265 7581.81473 14075.0045  85.6%  4422 1558s
  5974  2487 10032.9776   21  252 7581.81473 14075.0045  85.6%  4404 1572s
  6060  2477 8952.42704   23  282 7581.81473 14075.0045  85.6%  4389 1588s
  6168  2465 8237.66494   26  209 7581.81473 13195.1410  74.0%  4368 1603s
  6282  2467 7783.26164   21  291 7581.81473 13150.5987  73.4%  4347 1620s
  6397  2478 10778.5138   20  308 7581.81473 13150.5987  73.4%  4334 1637s
  6531  2483 10342.8665   21  363 7581.81473 12729.7692  67.9%  4311 1654s
  6694  2445 infeasible   24      7581.81473 12721.7129  67.8%  4269 1672s
  6837  2448 9723.76885   27   91 7581.81473 12581.5261  65.9%  4246 1691s
  6978  2434 9327.63828   33  183 7581.81473 12581.5261  65.9%  4228 1708s
  7090  2436 8995.45466   36  115 7581.81473 12581.5261  65.9%  4203 1732s
  7259  2404 7990.83621   47  145 7581.81473 12581.5261  65.9%  4165 1752s
  7426  2342     cutoff   20      7581.81473 12308.3704  62.3%  4142 1772s
  7631  2309 7648.72147   23  262 7581.81473 11963.5614  57.8%  4097 1794s
  7806  2307 9274.77448   23  321 7581.81473 11963.5614  57.8%  4078 1817s
  8024  2257     cutoff   29      7581.81473 11963.5614  57.8%  4040 1840s
  8308  2112 9209.27331   22  259 7581.81473 11500.0630  51.7%  3976 1863s
  8574  1984     cutoff   25      7581.81473 11001.4195  45.1%  3918 1888s
  8859  1881     cutoff   24      7581.81473 11001.4195  45.1%  3871 1912s
  9191  1731 7717.33623   29  241 7581.81473 10473.6666  38.1%  3813 1937s
  9592  1647     cutoff   29      7581.81473 10227.8601  34.9%  3738 1963s
  9983  1496 8915.40217   28  353 7581.81473 9922.61655  30.9%  3666 1991s
 10414  1244 infeasible   37      7581.81473 9733.50846  28.4%  3596 2016s
 10985   852     cutoff   26      7581.81473 9538.95065  25.8%  3489 2043s
 11679   389     cutoff   27      7581.81473 9150.42617  20.7%  3362 2067s
*12584   389              37    7618.0451267 9058.38748  18.9%  3187 2067s
 12647    15     cutoff   32      7618.04513 8839.95524  16.0%  3175 2084s
H12955    15                    7619.6276623 8666.92909  13.7%  3111 2084s
 13394     0     cutoff   33      7619.62766 7887.63802  3.52%  3026 2085s

Cutting planes:
  MIR: 598
  Mixing: 4
  Flow cover: 1619
  RLT: 16
  Relax-and-lift: 146

Explored 13417 nodes (40781378 simplex iterations) in 2085.17 seconds (6152.14 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 7619.63 7618.05 7581.81 ... 6021.12

Optimal solution found (tolerance 1.00e-04)
Best objective 7.619627662339e+03, best bound 7.619627662339e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2085.18s
  Master Objective (UB) = 7619.63, θ = 145041.46
  Upper Bound (UB) = 7619.63

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 145041.46
  [DEBUG]   ✓ Scenario 0: θ = 145041.46 ≤ Q = 145041.46 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 145041.46 ≤ Q = 145041.46 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 145041.46 ≤ Q = 145041.46 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 145041.46 ≤ Q = 145041.46 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 145041.46 ≤ Q = 145041.46 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 145041.46 ≤ Q = 145041.46 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 145041.46 ≤ Q = 145041.46 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 145041.46 ≤ Q = 145041.46 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 145041.46 ≤ Q = 145041.46 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x1a494009
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xe5b6bff7
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.201439e+13
Presolve removed 2613 rows and 1904 columns
Presolve time: 0.00s
Presolved: 480 rows, 485 columns, 1318 nonzeros
Found heuristic solution: objective 5538354.3895
Variable types: 329 continuous, 156 integer (156 binary)

Root relaxation: objective -1.478390e+05, 228 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -147839.01    0  121 5538354.39 -147839.01   103%     -    0s
H    0     0                    -114326.4708 -147839.01  29.3%     -    0s
H    0     0                    -115245.0487 -147839.01  28.3%     -    0s
     0     0 -120144.96    0   60 -115245.05 -120144.96  4.25%     -    0s
H    0     0                    -118295.2220 -120085.55  1.51%     -    0s
H    0     0                    -118640.7395 -120085.55  1.22%     -    0s
H    0     0                    -118948.0512 -119709.25  0.64%     -    0s
     0     0 -119709.25    0   58 -118948.05 -119709.25  0.64%     -    0s
     0     0 -119643.78    0   56 -118948.05 -119643.78  0.58%     -    0s
     0     0 -119459.50    0   41 -118948.05 -119459.50  0.43%     -    0s
H    0     0                    -119014.5015 -119444.25  0.36%     -    0s
     0     0 -119433.65    0   45 -119014.50 -119433.65  0.35%     -    0s
     0     0 -119410.82    0   43 -119014.50 -119410.82  0.33%     -    0s
     0     0 -119395.65    0   40 -119014.50 -119395.65  0.32%     -    0s
     0     0 -119308.81    0   38 -119014.50 -119308.81  0.25%     -    0s
     0     0 -119301.59    0   38 -119014.50 -119301.59  0.24%     -    0s
H    0     0                    -119092.8133 -119301.59  0.18%     -    0s
     0     0 -119301.59    0   70 -119092.81 -119301.59  0.18%     -    0s
     0     0 -119301.59    0   22 -119092.81 -119301.59  0.18%     -    0s
H    0     0                    -119104.5095 -119301.59  0.17%     -    0s
     0     0 -119301.59    0   45 -119104.51 -119301.59  0.17%     -    0s
     0     0 -119270.17    0   40 -119104.51 -119270.17  0.14%     -    0s
     0     0 -119265.31    0   40 -119104.51 -119265.31  0.14%     -    0s
H    0     0                    -119121.2813 -119265.31  0.12%     -    0s
     0     0 -119237.06    0   41 -119121.28 -119237.06  0.10%     -    0s
     0     0 -119225.81    0   41 -119121.28 -119225.81  0.09%     -    0s
     0     0 -119225.81    0   41 -119121.28 -119225.81  0.09%     -    0s
     0     0 -119225.81    0   41 -119121.28 -119225.81  0.09%     -    0s
H    0     0                    -119128.3274 -119225.81  0.08%     -    0s
     0     0 -119225.81    0   38 -119128.33 -119225.81  0.08%     -    0s
     0     0 -119225.81    0   36 -119128.33 -119225.81  0.08%     -    0s
     0     0 -119221.70    0   36 -119128.33 -119221.70  0.08%     -    0s
     0     0 -119215.12    0   30 -119128.33 -119215.12  0.07%     -    0s
H    0     0                    -119162.4505 -119208.26  0.04%     -    0s
     0     0 -119208.26    0   29 -119162.45 -119208.26  0.04%     -    0s
     0     0 -119208.10    0   29 -119162.45 -119208.10  0.04%     -    0s

Cutting planes:
  Gomory: 3
  Implied bound: 6
  MIR: 41
  Flow cover: 11
  RLT: 2

Explored 1 nodes (1113 simplex iterations) in 0.10 seconds (0.07 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -119162 -119128 -119121 ... -114326
No other solutions better than -119162

Optimal solution found (tolerance 1.00e-04)
Best objective -1.191624504520e+05, best bound -1.191624504520e+05, gap 0.0000%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 142022.14
  Scenario: 7 demand increases, 52 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -119162.45
  [DEBUG]   S×d_nominal = 261184.59
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 261184.59 + -119162.45 = 142022.14
  [DEBUG]   Current θ from Master = 145041.46
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3019.31 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 4600.31
  Lower Bound (LB) = 5221.16
  Gap (UB-LB) = 2398.4678, Absolute Gap = 2398.4678, Relative Gap = 0.314775
  Not converged yet (gap = 2398.47 > ε = 200)

  [DEBUG] Adding NEW scenario 9 to Master Problem...
  [DEBUG] New scenario pattern: 7 increases, 52 decreases
    [DEBUG] Scenario 9 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 9 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 9]
    [DEBUG]   - Total constraints in model: 154283
    [DEBUG]   - Total variables in model: 64660
  [DEBUG] Total scenarios in Master: 10
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 10
================================================================================
[Iteration 10] Solving Master Problem...
  Current scenarios in Master: 10
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 154283 rows, 64660 columns and 437769 nonzeros
Model fingerprint: 0xdac5f731
Variable types: 62401 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 72880 rows and 29600 columns
Presolve time: 1.17s
Presolved: 81403 rows, 35060 columns, 500179 nonzeros
Variable types: 32801 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -333493.2105
Found heuristic solution: objective -217726.0351

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.17s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.385e+06
 Factor NZ  : 7.251e+06 (roughly 100 MB of memory)
 Factor Ops : 1.202e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.71980339e+07  1.39439302e+08  1.05e+05 2.21e+01  7.51e+04     2s
   1  -1.25412000e+07  1.24541296e+08  7.10e+04 9.02e+01  5.04e+04     2s
   2  -4.42539471e+06  9.77733286e+07  2.47e+04 2.26e-11  1.83e+04     2s
   3  -9.49770814e+05  6.86958305e+07  2.49e+03 9.86e-01  2.19e+03     2s
   4  -5.29496503e+05  4.28489289e+07  4.71e+02 4.10e-01  5.93e+02     2s
   5  -4.23267385e+05  1.98308286e+07  1.78e+02 1.34e-01  2.34e+02     2s
   6  -3.60969417e+05  1.48625385e+07  8.46e+01 9.34e-02  1.45e+02     2s
   7  -2.30247290e+05  1.19391287e+07  3.01e+01 7.28e-02  9.51e+01     2s
   8  -1.48613975e+05  9.01778298e+06  1.12e+01 5.32e-02  6.55e+01     2s
   9  -1.25340371e+05  5.68227388e+06  7.98e+00 3.26e-02  4.09e+01     2s
  10  -1.04184086e+05  4.08647323e+06  4.05e+00 2.29e-02  2.88e+01     2s
  11  -8.02866273e+04  1.20427435e+06  1.71e+00 6.53e-03  8.71e+00     3s
  12  -5.45447128e+04  4.27746226e+05  6.87e-01 2.28e-03  3.24e+00     3s
  13  -2.87310495e+04  2.31779471e+05  3.87e-01 1.33e-03  1.75e+00     3s
  14  -1.93447260e+04  1.56622125e+05  3.08e-01 1.56e-03  1.18e+00     3s
  15  -9.80069334e+03  1.18417787e+05  2.46e-01 1.44e-03  8.61e-01     3s
  16  -6.96099370e+02  9.75871759e+04  1.91e-01 1.09e-03  6.60e-01     3s
  17   3.34987372e+03  8.25050825e+04  1.67e-01 1.83e-03  5.32e-01     3s
  18   9.45133349e+03  7.04443160e+04  1.31e-01 1.68e-03  4.10e-01     3s
  19   1.10483910e+04  6.58874048e+04  1.21e-01 1.62e-03  3.68e-01     3s
  20   1.55385155e+04  5.56730175e+04  9.49e-02 1.73e-03  2.70e-01     3s
  21   1.96592195e+04  4.96871266e+04  7.15e-02 1.34e-03  2.02e-01     3s
  22   2.42087090e+04  4.38186348e+04  4.65e-02 1.64e-03  1.32e-01     3s
  23   2.63349017e+04  4.18968537e+04  3.55e-02 1.68e-03  1.05e-01     3s
  24   2.86887427e+04  3.93315887e+04  2.38e-02 1.14e-03  7.15e-02     3s
  25   2.98622704e+04  3.73853243e+04  1.81e-02 7.52e-04  5.06e-02     3s
  26   3.08653580e+04  3.64581529e+04  1.35e-02 5.47e-04  3.76e-02     3s
  27   3.15912822e+04  3.57746844e+04  1.03e-02 4.02e-04  2.81e-02     3s
  28   3.22780839e+04  3.52463602e+04  7.19e-03 2.96e-04  1.99e-02     3s
  29   3.27565318e+04  3.49733500e+04  5.09e-03 2.14e-04  1.49e-02     3s
  30   3.29085891e+04  3.46409861e+04  4.37e-03 2.16e-04  1.16e-02     3s
  31   3.31699684e+04  3.43742816e+04  3.23e-03 2.08e-04  8.10e-03     3s
  32   3.33203281e+04  3.42389752e+04  2.60e-03 1.45e-04  6.18e-03     3s
  33   3.34855414e+04  3.42117227e+04  1.95e-03 1.75e-04  4.88e-03     3s
  34   3.36110222e+04  3.41347099e+04  1.43e-03 1.27e-04  3.52e-03     3s
  35   3.36812505e+04  3.40758074e+04  1.14e-03 1.16e-04  2.65e-03     3s
  36   3.38258629e+04  3.40282515e+04  5.81e-04 5.75e-05  1.36e-03     3s
  37   3.38533208e+04  3.40035137e+04  4.74e-04 3.11e-05  1.01e-03     3s
  38   3.38946941e+04  3.39978865e+04  3.14e-04 2.52e-05  6.95e-04     4s
  39   3.39106077e+04  3.39924853e+04  2.48e-04 1.82e-05  5.51e-04     4s
  40   3.39412398e+04  3.39888385e+04  1.37e-04 1.02e-05  3.20e-04     4s
  41   3.39495905e+04  3.39846995e+04  1.07e-04 9.72e-06  2.36e-04     4s
  42   3.39618539e+04  3.39809008e+04  6.29e-05 1.11e-05  1.28e-04     4s
  43   3.39628154e+04  3.39802911e+04  5.87e-05 7.08e-06  1.18e-04     4s
  44   3.39677616e+04  3.39799991e+04  4.07e-05 4.59e-06  8.24e-05     4s
  45   3.39776514e+04  3.39798286e+04  5.40e-06 3.57e-06  1.46e-05     4s
  46   3.39778634e+04  3.39797833e+04  4.82e-06 2.87e-06  1.29e-05     4s
  47   3.39792355e+04  3.39797125e+04  9.80e-07 1.66e-06  3.20e-06     4s
  48   3.39795868e+04  3.39796237e+04  1.32e-08 2.44e-07  2.47e-07     4s
  49   3.39796028e+04  3.39796033e+04  2.47e-09 1.26e-09  3.15e-09     4s
  50   3.39796030e+04  3.39796031e+04  3.41e-07 2.72e-09  8.70e-10     4s

Barrier solved model in 50 iterations and 4.10 seconds (7.64 work units)
Optimal objective 3.39796030e+04


Root crossover log...

       0 DPushes remaining with DInf 0.0000000e+00                 6s

    4323 PPushes remaining with PInf 2.2366650e-05                 6s
       0 PPushes remaining with PInf 0.0000000e+00                 6s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.2990597e+04      6s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   40594    3.3979603e+04   0.000000e+00   3.299060e+04      6s
   40717    3.3979603e+04   0.000000e+00   0.000000e+00      6s
   40717    3.3979603e+04   0.000000e+00   0.000000e+00      6s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 3.397960e+04, 40717 iterations, 4.57 seconds (9.58 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 33979.6031    0  171 -217726.04 33979.6031   116%     -    6s
H    0     0                    -214277.6555 33979.6031   116%     -    6s
H    0     0                    -160255.1133 33979.6031   121%     -    6s
H    0     0                    -157906.2792 33979.6031   122%     -    6s
H    0     0                    -157113.9918 33979.6031   122%     -    7s
H    0     0                    -157044.3715 33979.6031   122%     -    7s
H    0     0                    -155557.9745 33979.6031   122%     -    7s
H    0     0                    -155507.2544 33979.6031   122%     -    7s
H    0     0                    -76857.18487 33979.6031   144%     -    7s
H    0     0                    -15553.35234 33979.6031   318%     -    7s
H    0     0                    -7124.629857 33979.6031   577%     -    7s
H    0     0                    -7038.883288 33979.6031   583%     -    8s
H    0     0                    -7038.369786 33979.6031   583%     -    8s
H    0     0                    -6972.048458 33979.6031   587%     -    8s
H    0     0                    -6925.402781 33979.6031   591%     -    8s
H    0     0                    -5785.109460 27977.5492   584%     -   21s
H    0     0                    -5724.409598 27977.5492   589%     -   21s
H    0     0                    -5540.137248 27977.5492   605%     -   21s
H    0     0                    -4858.484604 27977.5492   676%     -   21s
     0     0 27977.5492    0  255 -4858.4846 27977.5492   676%     -   21s
     0     0 27555.1486    0  266 -4858.4846 27555.1486   667%     -   28s
     0     0 27479.1279    0  277 -4858.4846 27479.1279   666%     -   33s
     0     0 27476.9855    0  279 -4858.4846 27476.9855   666%     -   36s
     0     0 27476.9080    0  279 -4858.4846 27476.9080   666%     -   36s
H    0     0                    -4680.055050 24057.1685   614%     -   58s
H    0     0                    -4662.269997 24057.1685   616%     -   58s
     0     0 24057.1685    0  312 -4662.2700 24057.1685   616%     -   58s
H    0     0                    -4217.511354 24056.2690   670%     -   59s
H    0     0                    -4015.536909 24056.2690   699%     -   59s
H    0     0                    -3792.536359 24056.2690   734%     -   59s
H    0     0                    -3599.856144 24056.2690   768%     -   59s
H    0     0                    -3373.867224 24056.2690   813%     -   59s
H    0     0                    -3290.944517 24056.2690   831%     -   59s
H    0     0                    -3158.686316 24056.2690   862%     -   59s
H    0     0                    -3022.047758 24056.2690   896%     -   59s
H    0     0                    -2815.254375 24056.2690   954%     -   59s
     0     0 23501.7716    0  348 -2815.2544 23501.7716   935%     -   70s
     0     0 23400.2025    0  373 -2815.2544 23400.2025   931%     -   75s
     0     0 23331.4020    0  370 -2815.2544 23331.4020   929%     -   80s
     0     0 23206.4349    0  386 -2815.2544 23206.4349   924%     -   87s
     0     0 23189.9926    0  435 -2815.2544 23189.9926   924%     -   90s
     0     0 23186.8419    0  398 -2815.2544 23186.8419   924%     -   92s
     0     0 23185.2854    0  388 -2815.2544 23185.2854   924%     -   92s
     0     0 23184.4955    0  397 -2815.2544 23184.4955   924%     -   93s
H    0     0                    -1014.697509 21669.2187  2236%     -  117s
H    0     0                     -62.7344782 21669.2187      -     -  117s
H    0     0                      75.3178748 21669.2187      -     -  117s
H    0     0                     342.1747216 21669.2187  6233%     -  117s
H    0     0                     365.2870628 21669.2187  5832%     -  117s
H    0     0                     382.9782116 21669.2187  5558%     -  117s
H    0     0                     506.7694170 21669.2187  4176%     -  117s
H    0     0                     529.8817582 21669.2187  3989%     -  117s
H    0     0                     570.5628590 21669.2187  3698%     -  117s
H    0     0                     609.2628948 21669.2187  3457%     -  117s
H    0     0                     618.7001663 21669.2187  3402%     -  117s
H    0     0                     662.2400309 21669.2187  3172%     -  117s
     0     0 21669.2187    0  444  662.24003 21669.2187  3172%     -  117s
     0     0 21283.1270    0  447  662.24003 21283.1270  3114%     -  127s
     0     0 21117.0229    0  460  662.24003 21117.0229  3089%     -  134s
     0     0 21001.2878    0  458  662.24003 21001.2878  3071%     -  139s
     0     0 20914.9348    0  467  662.24003 20914.9348  3058%     -  143s
     0     0 20832.3404    0  472  662.24003 20832.3404  3046%     -  147s
     0     0 20764.6262    0  486  662.24003 20764.6262  3036%     -  151s
     0     0 20761.6281    0  475  662.24003 20761.6281  3035%     -  152s
     0     0 20747.8044    0  481  662.24003 20747.8044  3033%     -  153s
     0     0 20746.8736    0  483  662.24003 20746.8736  3033%     -  153s
     0     0 19830.7229    0  441  662.24003 19830.7229  2894%     -  171s
H    0     0                     675.1440827 19830.2042  2837%     -  172s
     0     0 19444.2097    0  498  675.14408 19444.2097  2780%     -  181s
     0     0 19337.9811    0  463  675.14408 19337.9811  2764%     -  185s
     0     0 19278.2350    0  505  675.14408 19278.2350  2755%     -  189s
     0     0 19212.3430    0  468  675.14408 19212.3430  2746%     -  192s
H    0     0                     794.9572059 19162.8796  2311%     -  194s
     0     0 19162.8796    0  512  794.95721 19162.8796  2311%     -  194s
H    0     0                     968.6173899 19147.1709  1877%     -  195s
     0     0 19147.1709    0  525  968.61739 19147.1709  1877%     -  195s
     0     0 19141.3196    0  523  968.61739 19141.3196  1876%     -  197s
     0     0 19138.3398    0  509  968.61739 19138.3398  1876%     -  198s
     0     0 19132.5183    0  511  968.61739 19132.5183  1875%     -  199s
     0     0 19126.2460    0  521  968.61739 19126.2460  1875%     -  200s
     0     0 19124.3576    0  517  968.61739 19124.3576  1874%     -  200s
     0     0 18952.9104    0  467  968.61739 18952.9104  1857%     -  207s
     0     0 18904.6581    0  471  968.61739 18904.6581  1852%     -  211s
     0     0 18854.4623    0  457  968.61739 18854.4623  1847%     -  213s
     0     0 18830.0106    0  475  968.61739 18830.0106  1844%     -  216s
     0     0 18823.3597    0  466  968.61739 18823.3597  1843%     -  217s
     0     0 18802.3736    0  485  968.61739 18802.3736  1841%     -  218s
     0     0 18795.6943    0  480  968.61739 18795.6943  1840%     -  219s
     0     0 18793.8165    0  478  968.61739 18793.8165  1840%     -  219s
     0     0 18692.6346    0  527  968.61739 18692.6346  1830%     -  227s
     0     0 18672.5189    0  511  968.61739 18672.5189  1828%     -  230s
     0     0 18662.9322    0  521  968.61739 18662.9322  1827%     -  232s
     0     0 18661.1933    0  520  968.61739 18661.1933  1827%     -  233s
     0     0 18616.5400    0  513  968.61739 18616.5400  1822%     -  238s
     0     0 18602.1882    0  554  968.61739 18602.1882  1820%     -  240s
     0     0 18596.1674    0  548  968.61739 18596.1674  1820%     -  242s
H    0     0                    1003.4040757 18580.3450  1752%     -  243s
     0     0 18580.3450    0  561 1003.40408 18580.3450  1752%     -  243s
     0     0 18575.1879    0  558 1003.40408 18575.1879  1751%     -  244s
H    0     0                    1025.8573052 18573.6479  1711%     -  245s
     0     0 18573.6479    0  563 1025.85731 18573.6479  1711%     -  246s
     0     0 18559.0496    0  516 1025.85731 18559.0496  1709%     -  248s
H    0     0                    1059.7053509 18558.8104  1651%     -  249s
H    0     0                    1150.2464932 18558.8104  1513%     -  249s
     0     0 18549.5919    0  526 1150.24649 18549.5919  1513%     -  251s
     0     0 18542.2445    0  528 1150.24649 18542.2445  1512%     -  252s
     0     0 18538.8810    0  445 1150.24649 18538.8810  1512%     -  252s
     0     0 18534.7505    0  522 1150.24649 18534.7505  1511%     -  254s
     0     0 18534.2279    0  521 1150.24649 18534.2279  1511%     -  255s
     0     0 18522.6516    0  528 1150.24649 18522.6516  1510%     -  257s
     0     0 18519.1643    0  461 1150.24649 18519.1643  1510%     -  259s
     0     0 18518.3965    0  453 1150.24649 18518.3965  1510%     -  259s
     0     0 18508.1111    0  529 1150.24649 18508.1111  1509%     -  261s
H    0     0                    1168.9626706 18507.6749  1483%     -  263s
H    0     0                    1181.4403588 18507.6749  1467%     -  263s
     0     0 18498.3546    0  525 1181.44036 18498.3546  1466%     -  264s
     0     0 18495.2264    0  520 1181.44036 18495.2264  1465%     -  266s
     0     0 18494.2969    0  538 1181.44036 18494.2969  1465%     -  266s
     0     0 18484.5416    0  539 1181.44036 18484.5416  1465%     -  268s
     0     0 18481.5908    0  530 1181.44036 18481.5908  1464%     -  269s
     0     0 18480.0736    0  523 1181.44036 18480.0736  1464%     -  270s
     0     0 18474.3124    0  523 1181.44036 18474.3124  1464%     -  273s
H    0     0                    1182.1329917 18474.2669  1463%     -  274s
H    0     0                    1223.3047279 18474.2669  1410%     -  274s
H    0     0                    1223.5391964 18474.2669  1410%     -  274s
     0     0 18472.0729    0  450 1223.53920 18472.0729  1410%     -  275s
     0     0 18471.3864    0  520 1223.53920 18471.3864  1410%     -  276s
     0     0 18466.6700    0  534 1223.53920 18466.6700  1409%     -  278s
     0     0 18463.8443    0  544 1223.53920 18463.8443  1409%     -  279s
     0     0 18463.6031    0  546 1223.53920 18463.6031  1409%     -  279s
     0     0 18462.0451    0  539 1223.53920 18462.0451  1409%     -  281s
     0     0 18461.9282    0  539 1223.53920 18461.9282  1409%     -  283s
H    0     0                    1344.6494247 18461.9272  1273%     -  348s
H    0     0                    5882.2614744 18461.9272   214%     -  353s
H    0     0                    5969.2109723 18461.9272   209%     -  355s
H    0     0                    5981.6751548 18461.9272   209%     -  355s
H    0     0                    6110.6939657 18461.9272   202%     -  355s
H    0     0                    6171.7630196 18461.9272   199%     -  355s
H    0     0                    6251.6190875 18461.9272   195%     -  355s
     0     2 18461.9272    0  539 6251.61909 18461.9272   195%     -  357s
     1     4 18403.4161    1  520 6251.61909 18461.9005   195%  4832  361s
     3     8 18317.2287    2  493 6251.61909 18409.3740   194%  3857  368s
     7    16 18117.8626    3  440 6251.61909 18309.9276   193%  5154  377s
    15    32 17913.4837    4  524 6251.61909 18111.7401   190%  6943  390s
    31    48 16934.2438    5  449 6251.61909 17912.1933   187% 11510  421s
    47    79 15470.5227    6  474 6251.61909 17912.1933   187% 10860  440s
H   52    79                    6263.1274309 17912.1933   186% 10567  440s
H   68    79                    6336.4399944 17912.1933   183%  9657  440s
H   77    79                    6392.5067055 17912.1933   180%  8873  440s
    78   153 15384.9509    7  415 6392.50671 17912.1933   180%  8815  474s
   152   260 15070.9271   10  486 6392.50671 17912.1933   180%  5856  489s
H  215   260                    6398.7093510 17912.1933   180%  5225  489s
   259   292 14385.7871   11  402 6398.70935 17912.1933   180%  4976  497s
   291   328 14853.8447   11  435 6398.70935 17912.1933   180%  4769  508s
   327   367 14769.1791   12  443 6398.70935 17912.1933   180%  4551  519s
   366   413 14612.8097   15  333 6398.70935 17912.1933   180%  4378  530s
H  380   413                    6603.2172491 17912.1933   171%  4309  530s
   413   490 14591.2821   14  427 6603.21725 17912.1933   171%  4219  542s
   492   568 14581.8683   16  336 6603.21725 17912.1933   171%  3973  552s
   570   638 8494.33721   16  185 6603.21725 17912.1933   171%  3809  562s
   641   677 14235.5888   17  334 6603.21725 17912.1933   171%  3799  572s
   690   721 14169.3136   17  405 6603.21725 17912.1933   171%  3941  583s
   742   775 14086.9827   17  416 6603.21725 17912.1933   171%  4147  593s
   803   830 14091.6917   17  415 6603.21725 17912.1933   171%  4241  604s
   874   883 14009.5005   18  343 6603.21725 17912.1933   171%  4257  614s
   939   936 7851.68003   18  372 6603.21725 17912.1933   171%  4333  626s
  1006   953 7764.99034   31  270 6603.21725 17912.1933   171%  4383  636s
  1061   991 11704.2916   19  311 6603.21725 17912.1933   171%  4387  649s
  1135  1059 9855.13825   20  325 6603.21725 17912.1933   171%  4309  662s
  1227  1106 10657.2320   21  306 6603.21725 17912.1933   171%  4261  676s
  1324  1129 9216.71155   23  248 6603.21725 17912.1933   171%  4274  689s
  1369  1166 8573.86213   23  262 6603.21725 17912.1933   171%  4327  703s
  1442  1203 8471.36697   24  263 6603.21725 17912.1933   171%  4298  716s
  1540  1263 8244.83939   24  261 6603.21725 17912.1933   171%  4250  732s
  1651  1333 7406.76882   24  238 6603.21725 17912.1933   171%  4229  748s
  1773  1372 8287.68941   25  280 6603.21725 17912.1933   171%  4231  765s
  1875  1388 7666.32681   27  225 6603.21725 17912.1933   171%  4288  782s
  1925  1443 7409.20940   28  196 6603.21725 17912.1933   171%  4358  805s
  1994  1482 7124.61743   30  149 6603.21725 17912.1933   171%  4473  825s
  2061  1508 infeasible   32      6603.21725 17912.1933   171%  4513  842s
  2139  1552 10780.7650   12  474 6603.21725 17912.1933   171%  4576  858s
  2230  1611 9108.45527   13  356 6603.21725 17912.1933   171%  4616  876s
  2319  1673 7989.37393   15  290 6603.21725 17912.1933   171%  4710  892s
  2417  1716 7268.48843   17  225 6603.21725 17912.1933   171%  4786  912s
  2512  1753 infeasible   20      6603.21725 17651.3712   167%  4878  931s
  2599  1806 13840.7337    8  412 6603.21725 17651.3712   167%  4957  950s
  2686  1856 11433.0394   10  281 6603.21725 17651.3712   167%  5027  971s
H 2741  1825                    6826.3184106 17651.3712   159%  5076  971s
  2786  1906 9915.62196   15  259 6826.31841 17651.3712   159%  5094  991s
  2952  1997 8899.76661   19  305 6826.31841 17651.3712   159%  5141 1014s
  3095  2082 7665.72779   24  264 6826.31841 17311.1579   154%  5214 1038s
  3230  2182 7167.00689   29  277 6826.31841 17311.1579   154%  5287 1061s
  3454  2286 13521.4110   11  360 6826.31841 16144.6832   137%  5275 1086s
H 3463  2280                    6846.8052161 16144.6832   136%  5288 1086s
H 3577  2213                    7117.0180649 16144.6832   127%  5355 1086s
  3590  2328 12695.9444   14  323 7117.01806 16144.6832   127%  5364 1110s
  3785  2447 10398.9655   16  282 7117.01806 15959.6838   124%  5406 1136s
  4001  2586 8592.62336   19  297 7117.01806 15879.4287   123%  5421 1163s
  4268  2587 9851.93269   19  539 7117.01806 15849.1206   123%  5367 1241s
  4270  2588 7765.36623   37  245 7117.01806 15849.1206   123%  5364 1248s
  4271  2589 7185.45302   41  345 7117.01806 15849.1206   123%  5363 1281s
  4272  2590 14446.9267   14  402 7117.01806 15849.1206   123%  5362 1311s
  4273  2590 11663.0465   10  448 7117.01806 15849.1206   123%  5360 1330s
  4274  2591 10733.2940   15  441 7117.01806 15849.1206   123%  5359 1345s
  4275  2592 10324.3692   18  513 7117.01806 15849.1206   123%  5358 1355s
  4276  2592 8852.61371   22  548 7117.01806 15849.1206   123%  5357 1365s
  4277  2593 9937.41784   17  536 7117.01806 15849.1206   123%  5355 1373s
  4278  2594 14393.5746   14  489 7117.01806 15849.1206   123%  5354 1379s
  4279  2594 15343.2593   11  492 7117.01806 15849.1206   123%  5353 1382s
  4280  2595 13777.2686   18  522 7117.01806 15849.1206   123%  5352 1396s
  4281  2596 12211.2866   21  518 7117.01806 15849.1206   123%  5350 1400s
  4283  2597 11716.7437   11  521 7117.01806 15849.1206   123%  5348 1406s
  4284  2598 10513.4699   15  529 7117.01806 15849.1206   123%  5347 1410s
  4285  2598 14438.7131   12  571 7117.01806 15849.1206   123%  5345 1422s
  4286  2599 9602.04271   17  467 7117.01806 15849.1206   123%  5344 1426s
  4289  2601 9851.93269   19  533 7117.01806 15849.1206   123%  5340 1432s
  4290  2602 7578.46672   29  533 7117.01806 15849.1206   123%  5339 1440s
  4293  2604 9578.14978   32  527 7117.01806 15849.1206   123%  5335 1446s
  4294  2604 9266.29434   10  525 7117.01806 15849.1206   123%  5334 1454s
  4295  2605 14429.0400   17  546 7117.01806 15849.1206   123%  5333 1457s
  4296  2606 12024.8297    8  541 7117.01806 15849.1206   123%  5332 1460s
  4297  2606 7232.42876   23  579 7117.01806 15849.1206   123%  5330 1474s
  4298  2607 12724.1467   22  540 7117.01806 15849.1206   123%  5329 1477s
  4299  2608 7157.77993   43  545 7117.01806 15849.1206   123%  5328 1480s
  4300  2608 14338.7228   15  553 7117.01806 15849.1206   123%  5327 1487s
  4301  2609 7485.62419   36  537 7117.01806 15849.1206   123%  5325 1490s
  4302  2610 8626.77267   25  466 7117.01806 15849.1206   123%  5324 1497s
  4303  2610 7339.18184   38  467 7117.01806 15849.1206   123%  5323 1500s
  4304  2611 10295.2845   26  550 7117.01806 15849.1206   123%  5322 1510s
  4306  2612 8601.12638   34  511 7117.01806 15849.1206   123%  5319 1519s
  4307  2613 9959.40688   31  511 7117.01806 15849.1206   123%  5318 1533s
  4308  2614 15337.4445   12  511 7117.01806 15849.1206   123%  5317 1582s
  4309  2617 15849.1206   12  435 7117.01806 15849.1206   123%  5374 1600s
  4311  2621 15849.1206   13  429 7117.01806 15849.1206   123%  5373 1618s
  4315  2627 15849.1206   14  444 7117.01806 15849.1206   123%  5376 1639s
  4323  2641 15849.1206   15  482 7117.01806 15849.1206   123%  5383 1652s
  4339  2650 8148.90549   16  208 7117.01806 15849.1206   123%  5428 1694s
  4356  2663 12435.7272   17  419 7117.01806 15849.1206   123%  5451 1720s
  4386  2705 12360.2719   18  391 7117.01806 15849.1206   123%  5503 1758s
H 4394  2570                    7290.0445639 15849.1206   117%  5504 1758s
H 4419  2437                    7386.5677617 15849.1206   115%  5501 1758s
  4438  2519 11995.8524   22  391 7386.56776 15849.1206   115%  5495 1782s
  4535  2533 11408.4194   23  367 7386.56776 15849.1206   115%  5542 1802s
  4587  2557 11396.7324   23  411 7386.56776 15849.1206   115%  5555 1820s
  4644  2568 11160.8687   23  378 7386.56776 15849.1206   115%  5593 1836s
  4702  2576 11483.4010   22  449 7386.56776 15849.1206   115%  5633 1853s
  4762  2566 9800.15160   24  340 7386.56776 15849.1206   115%  5673 1870s
  4819  2554 9702.27069   24  333 7386.56776 15849.1206   115%  5722 1885s
  4875  2550 9329.30597   24  368 7386.56776 15849.1206   115%  5755 1906s
H 4928  2414                    7618.0451267 15849.1206   108%  5790 1906s
  4930  2409 9655.35651   24  392 7618.04513 15849.1206   108%  5794 1923s
  5004  2383 9399.72420   24  359 7618.04513 15849.1206   108%  5814 1945s
  5051  2377 9167.73686   25  333 7618.04513 15849.1206   108%  5843 1969s
  5112  2369 8781.57755   27  388 7618.04513 15849.1206   108%  5869 1984s
  5166  2393 8779.60423   28  390 7618.04513 15849.1206   108%  5891 2000s
  5232  2388 7995.10217   30  364 7618.04513 15849.1206   108%  5930 2017s
  5285  2377 infeasible   30      7618.04513 15849.1206   108%  5962 2036s
  5362  2361 infeasible   33      7618.04513 15849.1206   108%  5983 2052s
  5412  2354 infeasible   23      7618.04513 15849.1206   108%  6014 2073s
  5467  2359 12572.1657   17  449 7618.04513 15849.1206   108%  6048 2095s
  5526  2358 12282.4156   18  443 7618.04513 15849.1206   108%  6092 2113s
  5585  2363 9358.41308   19  439 7618.04513 15849.1206   108%  6133 2131s
  5627  2368 8938.92812   20  411 7618.04513 15849.1206   108%  6158 2151s
  5691  2372 8387.38594   22  352 7618.04513 14823.4034  94.6%  6201 2174s
  5782  2383 7778.13199   25  365 7618.04513 14348.1750  88.3%  6243 2195s
  5889  2390 10064.3675   24  390 7618.04513 14348.1750  88.3%  6255 2218s
  5999  2381 9951.29274   26  136 7618.04513 14348.1750  88.3%  6273 2242s
  6110  2381 8369.66735   29  158 7618.04513 14348.1750  88.3%  6311 2269s
  6215  2380 infeasible   35      7618.04513 14348.1750  88.3%  6354 2294s
  6340  2369 9451.08175   22  134 7618.04513 13371.7948  75.5%  6392 2326s
  6468  2355 infeasible   27      7618.04513 13288.1234  74.4%  6423 2352s
  6557  2344 infeasible   28      7618.04513 13091.2798  71.8%  6442 2377s
  6665  2330 10771.9898   19  338 7618.04513 13091.2798  71.8%  6472 2408s
  6771  2342 8425.38697   23  399 7618.04513 12772.6891  67.7%  6524 2438s
  6925  2336 infeasible   21      7618.04513 12581.5840  65.2%  6545 2469s
  7097  2315     cutoff   24      7618.04513 12413.0320  62.9%  6570 2502s
  7252  2278 9779.23364   20  463 7618.04513 12202.0453  60.2%  6606 2534s
  7406  2238     cutoff   22      7618.04513 12197.7107  60.1%  6661 2565s
  7474  2229 8634.00626   22  339 7618.04513 12197.7107  60.1%  6719 2599s
  7596  2182     cutoff   25      7618.04513 12197.7107  60.1%  6758 2633s
  7719  2179 10119.1808   26  352 7618.04513 12197.7107  60.1%  6800 2670s
  7851  2133     cutoff   30      7618.04513 11749.1289  54.2%  6844 2707s
  8038  2075 infeasible   30      7618.04513 11749.1289  54.2%  6895 2748s
  8235  2018 8230.46521   24  424 7618.04513 11631.5436  52.7%  6959 2790s
  8441  1957     cutoff   29      7618.04513 11420.5282  49.9%  7005 2834s
  8627  1896 8028.58285   22  311 7618.04513 11365.8575  49.2%  7067 2880s
  8881  1797     cutoff   24      7618.04513 11057.8719  45.2%  7100 2925s
  9090  1732 7817.26293   21  381 7618.04513 10926.2045  43.4%  7125 2971s
  9323  1658     cutoff   23      7618.04513 10919.5784  43.3%  7153 3024s
  9588  1571 7702.67074   22  434 7618.04513 10567.1691  38.7%  7179 3075s
  9954  1443 8207.00966   26  197 7618.04513 10330.1595  35.6%  7170 3128s
 10345  1274 9009.42782   24  345 7618.04513 10021.1039  31.5%  7154 3182s
 10857  1057 8079.28423   27  271 7618.04513 9721.46683  27.6%  7082 3236s
 11449   925 infeasible   28      7618.04513 9551.73721  25.4%  6974 3289s
 12251   664 infeasible   29      7618.04513 9249.01319  21.4%  6769 3339s
 13340   152 infeasible   25      7618.04513 8828.66515  15.9%  6444 3383s
 14534     0 7742.31506   27  195 7618.04513 8379.71127  10.0%  6076 3397s

Cutting planes:
  Projected implied bound: 66
  MIR: 1096
  Mixing: 2
  Flow cover: 2097
  RLT: 30
  Relax-and-lift: 218

Explored 14880 nodes (89124397 simplex iterations) in 3397.52 seconds (10442.89 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 7618.05 7386.57 7290.04 ... 6336.44

Optimal solution found (tolerance 1.00e-04)
Best objective 7.618045126670e+03, best bound 7.618045126670e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3397.57s
  Master Objective (UB) = 7618.05, θ = 145133.68
  Upper Bound (UB) = 7618.05

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 145133.68
  [DEBUG]   ✓ Scenario 0: θ = 145133.68 ≤ Q = 145133.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 145133.68 ≤ Q = 145133.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 145133.68 ≤ Q = 145133.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 145133.68 ≤ Q = 145133.68 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 145133.68 ≤ Q = 145133.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 145133.68 ≤ Q = 145133.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 145133.68 ≤ Q = 145133.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 145133.68 ≤ Q = 145133.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 145133.68 ≤ Q = 145133.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 145133.68 ≤ Q = 145133.68 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 10] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x3e6c52d
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xfc193ad3
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.205159e+13
Presolve removed 2613 rows and 1904 columns
Presolve time: 0.00s
Presolved: 480 rows, 485 columns, 1318 nonzeros
Found heuristic solution: objective 5554871.6103
Variable types: 329 continuous, 156 integer (156 binary)

Root relaxation: objective -1.477539e+05, 228 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -147753.90    0  121 5554871.61 -147753.90   103%     -    0s
H    0     0                    -114226.8574 -147753.90  29.4%     -    0s
H    0     0                    -115145.4352 -147753.90  28.3%     -    0s
     0     0 -118940.64    0  126 -115145.44 -118940.64  3.30%     -    0s
H    0     0                    -115630.5125 -118925.65  2.85%     -    0s
     0     0 -118288.30    0  126 -115630.51 -118288.30  2.30%     -    0s
     0     0 -118286.81    0  126 -115630.51 -118286.81  2.30%     -    0s
H    0     0                    -116400.9268 -118286.81  1.62%     -    0s
H    0     0                    -116407.9990 -118286.81  1.61%     -    0s
     0     0 -118059.61    0   98 -116408.00 -118059.61  1.42%     -    0s
H    0     0                    -116768.6145 -118048.51  1.10%     -    0s
     0     0 -118048.51    0   98 -116768.61 -118048.51  1.10%     -    0s
     0     0 -117987.77    0   95 -116768.61 -117987.77  1.04%     -    0s
     0     0 -117985.45    0   95 -116768.61 -117985.45  1.04%     -    0s
H    0     0                    -116907.8523 -117985.45  0.92%     -    0s
H    0     0                    -117289.6545 -117985.45  0.59%     -    0s
H    0     0                    -117308.5026 -117985.45  0.58%     -    0s
     0     2 -117985.45    0   95 -117308.50 -117985.45  0.58%     -    0s
*  375    22              33    -117320.5625 -117365.09  0.04%   5.9    0s

Cutting planes:
  Gomory: 41
  Implied bound: 2
  MIR: 259
  Flow cover: 5
  RLT: 2

Explored 495 nodes (3097 simplex iterations) in 0.10 seconds (0.09 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -117321 -117309 -117290 ... 5.55487e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.173205624928e+05, best bound -1.173291072154e+05, gap 0.0073%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 143864.03
  Scenario: 20 demand increases, 39 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -117320.56
  [DEBUG]   S×d_nominal = 261184.59
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 261184.59 + -117320.56 = 143864.03
  [DEBUG]   Current θ from Master = 145133.68
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1269.66 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 6348.39
  Lower Bound (LB) = 6348.39
  Gap (UB-LB) = 1269.6553, Absolute Gap = 1269.6553, Relative Gap = 0.166664
  Not converged yet (gap = 1269.66 > ε = 200)

  [DEBUG] Adding NEW scenario 10 to Master Problem...
  [DEBUG] New scenario pattern: 20 increases, 39 decreases
    [DEBUG] Scenario 10 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 10 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 10]
    [DEBUG]   - Total constraints in model: 169573
    [DEBUG]   - Total variables in model: 70900
  [DEBUG] Total scenarios in Master: 11
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 11
================================================================================
[Iteration 11] Solving Master Problem...
  Current scenarios in Master: 11
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 169573 rows, 70900 columns and 480994 nonzeros
Model fingerprint: 0x7d1d14df
Variable types: 68641 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 80172 rows and 32562 columns
Presolve time: 1.32s
Presolved: 89401 rows, 38338 columns, 545167 nonzeros
Variable types: 36079 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -340827.5351
Found heuristic solution: objective -217726.0351

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.17s

Barrier statistics:
 Dense cols : 572
 AA' NZ     : 3.307e+06
 Factor NZ  : 7.426e+06 (roughly 110 MB of memory)
 Factor Ops : 1.290e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.72309884e+07  1.51818291e+08  1.05e+05 2.05e+01  7.48e+04     2s
   1  -1.25847337e+07  1.35881130e+08  7.13e+04 8.81e+01  5.04e+04     2s
   2  -5.00660431e+06  1.06779799e+08  2.82e+04 7.01e-01  2.08e+04     2s
   3  -1.06396030e+06  8.52233149e+07  2.65e+03 1.57e+00  2.36e+03     3s
   4  -5.92768509e+05  6.02248687e+07  7.79e+02 7.46e-01  8.81e+02     3s
   5  -4.60309631e+05  2.27727872e+07  3.06e+02 3.03e-02  3.16e+02     3s
   6  -3.12095845e+05  1.69271101e+07  8.52e+01 1.98e-02  1.50e+02     3s
   7  -1.90216795e+05  1.16870785e+07  2.88e+01 1.29e-02  8.53e+01     3s
   8  -1.37490327e+05  9.15450065e+06  1.44e+01 9.82e-03  6.21e+01     3s
   9  -1.11716877e+05  6.22576058e+06  9.84e+00 6.46e-03  4.14e+01     3s
  10  -9.28447226e+04  3.77538034e+06  5.72e+00 3.82e-03  2.47e+01     3s
  11  -5.80181111e+04  1.26811994e+06  1.62e+00 1.18e-03  8.21e+00     3s
  12  -4.16165090e+04  3.97377340e+05  9.96e-01 3.55e-04  2.71e+00     3s
  13  -1.80535035e+04  3.01769778e+05  6.17e-01 2.72e-04  1.96e+00     3s
  14  -1.01624994e+04  1.97365328e+05  4.53e-01 1.76e-04  1.27e+00     3s
  15  -5.55266613e+03  1.41686275e+05  3.76e-01 2.69e-04  9.02e-01     3s
  16   7.55778467e+02  1.01322870e+05  2.96e-01 1.81e-03  6.16e-01     3s
  17   8.34926375e+03  8.25799426e+04  2.21e-01 1.20e-03  4.54e-01     3s
  18   1.38110994e+04  7.14523861e+04  1.69e-01 1.08e-03  3.53e-01     3s
  19   1.77504552e+04  5.99918777e+04  1.37e-01 1.64e-03  2.59e-01     3s
  20   1.98004794e+04  5.43096887e+04  1.21e-01 1.60e-03  2.11e-01     3s
  21   2.30809768e+04  5.04598248e+04  9.57e-02 1.61e-03  1.68e-01     3s
  22   2.65503957e+04  4.78625509e+04  6.99e-02 1.64e-03  1.30e-01     3s
  23   2.85313537e+04  4.40703250e+04  5.59e-02 1.88e-03  9.51e-02     3s
  24   3.00079539e+04  4.26603554e+04  4.53e-02 1.72e-03  7.74e-02     3s
  25   3.10693082e+04  4.13835016e+04  3.78e-02 1.62e-03  6.31e-02     3s
  26   3.15499991e+04  4.12936119e+04  3.45e-02 1.59e-03  5.96e-02     3s
  27   3.23115246e+04  4.06919105e+04  2.88e-02 1.53e-03  5.13e-02     3s
  28   3.27371993e+04  3.97917623e+04  2.58e-02 1.36e-03  4.32e-02     3s
  29   3.36363589e+04  3.90630241e+04  1.97e-02 1.03e-03  3.32e-02     3s
  30   3.38268645e+04  3.86541191e+04  1.84e-02 8.62e-04  2.95e-02     3s
  31   3.44609400e+04  3.82264011e+04  1.43e-02 6.59e-04  2.30e-02     3s
  32   3.49855566e+04  3.80759239e+04  1.10e-02 5.86e-04  1.89e-02     4s
  33   3.50728165e+04  3.78401953e+04  1.04e-02 4.85e-04  1.69e-02     4s
  34   3.52603016e+04  3.76040508e+04  9.16e-03 3.83e-04  1.43e-02     4s
  35   3.56398834e+04  3.75494921e+04  6.83e-03 3.56e-04  1.17e-02     4s
  36   3.57222519e+04  3.73107618e+04  6.31e-03 2.49e-04  9.72e-03     4s
  37   3.58234600e+04  3.72628357e+04  5.66e-03 2.27e-04  8.81e-03     4s
  38   3.60193014e+04  3.71828386e+04  4.46e-03 1.89e-04  7.12e-03     4s
  39   3.61026484e+04  3.71648292e+04  3.98e-03 1.81e-04  6.50e-03     4s
  40   3.62348333e+04  3.69921189e+04  3.17e-03 1.31e-04  4.64e-03     4s
  41   3.63594730e+04  3.68951408e+04  2.42e-03 6.29e-05  3.28e-03     4s
  42   3.64970365e+04  3.68368212e+04  1.59e-03 4.84e-05  2.08e-03     4s
  43   3.66234134e+04  3.68211238e+04  8.43e-04 3.56e-05  1.21e-03     4s
  44   3.66588091e+04  3.68077451e+04  6.43e-04 2.57e-05  9.12e-04     4s
  45   3.66844197e+04  3.68005125e+04  4.95e-04 2.02e-05  7.11e-04     4s
  46   3.67183060e+04  3.67951927e+04  2.97e-04 1.75e-05  4.70e-04     4s
  47   3.67400164e+04  3.67901144e+04  1.79e-04 1.35e-05  3.06e-04     4s
  48   3.67426491e+04  3.67877361e+04  1.64e-04 1.10e-05  2.76e-04     4s
  49   3.67516001e+04  3.67830865e+04  1.17e-04 9.97e-06  1.93e-04     4s
  50   3.67552375e+04  3.67786836e+04  9.62e-05 5.59e-06  1.43e-04     4s
  51   3.67585665e+04  3.67776359e+04  7.72e-05 4.53e-06  1.17e-04     4s
  52   3.67639176e+04  3.67757712e+04  4.81e-05 2.62e-06  7.25e-05     4s
  53   3.67689535e+04  3.67738286e+04  2.21e-05 3.80e-07  2.99e-05     4s
  54   3.67708869e+04  3.67734040e+04  1.12e-05 9.67e-08  1.54e-05     5s
  55   3.67720383e+04  3.67733771e+04  5.63e-06 6.56e-08  8.19e-06     5s
  56   3.67731661e+04  3.67732425e+04  2.41e-07 3.84e-09  4.67e-07     5s
  57   3.67732321e+04  3.67732328e+04  2.26e-09 1.86e-10  4.02e-09     5s
  58   3.67732323e+04  3.67732323e+04  6.29e-10 8.64e-11  1.50e-12     5s

Barrier solved model in 58 iterations and 4.67 seconds (8.70 work units)
Optimal objective 3.67732323e+04


Root crossover log...

       0 DPushes remaining with DInf 0.0000000e+00                 6s

    1276 PPushes remaining with PInf 2.7212222e-07                 6s
       0 PPushes remaining with PInf 0.0000000e+00                 6s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.0096477e-10      6s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   30902    3.6773232e+04   0.000000e+00   0.000000e+00      6s
   30902    3.6773232e+04   0.000000e+00   0.000000e+00      6s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 3.677323e+04, 30902 iterations, 4.16 seconds (8.58 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 36773.2323    0  250 -217726.04 36773.2323   117%     -    6s
H    0     0                    -213685.3044 36773.2323   117%     -    6s
H    0     0                    -81455.34610 36773.2323   145%     -    6s
H    0     0                    -74324.99161 36773.2323   149%     -    6s
H    0     0                    -71366.44962 36773.2323   152%     -    6s
H    0     0                    -68769.03496 36773.2323   153%     -    6s
H    0     0                    -16877.02872 36773.2323   318%     -    6s
H    0     0                    -15033.04287 36773.2323   345%     -    6s
H    0     0                    -14644.10479 36773.2323   351%     -    7s
H    0     0                    -14271.85218 36773.2323   358%     -    7s
H    0     0                    -13871.05056 36773.2323   365%     -    7s
H    0     0                    -13827.55394 36773.2323   366%     -    7s
H    0     0                    -12308.70042 36773.2323   399%     -    8s
H    0     0                    -11522.75242 36773.2323   419%     -    8s
H    0     0                    -10617.02910 36773.2323   446%     -    8s
H    0     0                    -10387.86541 36773.2323   454%     -    8s
H    0     0                    -10385.59540 36773.2323   454%     -    8s
H    0     0                    -10383.16529 36773.2323   454%     -    8s
H    0     0                    -10165.83927 29218.1054   387%     -   25s
H    0     0                    -8714.923357 29218.1054   435%     -   25s
H    0     0                    -8274.345177 29218.1054   453%     -   25s
H    0     0                    -8137.580009 29218.1054   459%     -   25s
H    0     0                    -8116.626310 29218.1054   460%     -   25s
     0     0 29094.5377    0  327 -8116.6263 29094.5377   458%     -   25s
H    0     0                    -7015.983881 29094.5377   515%     -   25s
H    0     0                    -5409.204383 29094.5377   638%     -   25s
H    0     0                    -3671.155628 29094.5377   893%     -   25s
H    0     0                    -3498.139710 29094.5377   932%     -   25s
H    0     0                    -3471.702804 29094.5377   938%     -   25s
H    0     0                    -3454.616528 29094.5377   942%     -   25s
     0     0 28824.8357    0  352 -3454.6165 28824.8357   934%     -   35s
     0     0 28768.7930    0  362 -3454.6165 28768.7930   933%     -   39s
     0     0 28768.7930    0  366 -3454.6165 28768.7930   933%     -   40s
     0     0 28549.6227    0  359 -3454.6165 28549.6227   926%     -   45s
     0     0 28469.0103    0  372 -3454.6165 28469.0103   924%     -   50s
     0     0 28440.3480    0  371 -3454.6165 28440.3480   923%     -   53s
     0     0 28440.3480    0  378 -3454.6165 28440.3480   923%     -   54s
     0     0 28440.3480    0  378 -3454.6165 28440.3480   923%     -   54s
H    0     0                    -3061.597173 25204.6422   923%     -   88s
H    0     0                    -2708.668552 25204.6422  1031%     -   88s
H    0     0                    -2656.649597 25204.6422  1049%     -   88s
H    0     0                    -2587.876275 25204.6422  1074%     -   88s
H    0     0                    -2507.401512 25204.6422  1105%     -   88s
H    0     0                    -2427.340278 25204.6422  1138%     -   88s
H    0     0                    -2418.877017 25204.6422  1142%     -   88s
H    0     0                    -2417.934895 25204.6422  1142%     -   88s
     0     0 25204.6422    0  364 -2417.9349 25204.6422  1142%     -   88s
H    0     0                    -2360.199752 25203.9347  1168%     -   89s
H    0     0                    -2334.913964 25203.9347  1179%     -   89s
     0     0 24646.4713    0  370 -2334.9140 24646.4713  1156%     -  101s
     0     0 24474.7595    0  415 -2334.9140 24474.7595  1148%     -  109s
     0     0 24372.9452    0  372 -2334.9140 24372.9452  1144%     -  114s
     0     0 24345.1562    0  419 -2334.9140 24345.1562  1143%     -  119s
     0     0 24260.0621    0  419 -2334.9140 24260.0621  1139%     -  123s
H    0     0                    -447.7515250 24237.9060  5513%     -  125s
H    0     0                    -374.1278324 24237.9060  6579%     -  125s
H    0     0                    -245.7184548 24237.9060  9964%     -  125s
     0     0 24237.9060    0  415 -245.71845 24237.9060  9964%     -  125s
     0     0 24232.3007    0  387 -245.71845 24232.3007  9962%     -  126s
     0     0 24222.9544    0  385 -245.71845 24222.9544  9958%     -  128s
H    0     0                     -94.2472018 24182.6273      -     -  131s
H    0     0                      25.5401976 24182.6273      -     -  131s
H    0     0                      42.6264728 24182.6273      -     -  131s
H    0     0                      77.1292581 24182.6273      -     -  131s
H    0     0                      81.6592896 24182.6273      -     -  131s
H    0     0                     103.6893434 24182.6273      -     -  131s
     0     0 24182.6273    0  422  103.68934 24182.6273      -     -  131s
     0     0 24182.1314    0  425  103.68934 24182.1314      -     -  132s
H    0     0                     198.7787012 21836.5781      -     -  178s
H    0     0                     376.3755325 21836.5781  5702%     -  178s
     0     0 21836.5781    0  470  376.37553 21836.5781  5702%     -  178s
H    0     0                     464.4507290 21836.2240  4602%     -  179s
     0     0 21460.4060    0  438  464.45073 21460.4060  4521%     -  193s
     0     0 21257.0576    0  449  464.45073 21257.0576  4477%     -  203s
     0     0 21170.6033    0  442  464.45073 21170.6033  4458%     -  210s
     0     0 21109.0082    0  453  464.45073 21109.0082  4445%     -  216s
     0     0 21067.2687    0  482  464.45073 21067.2687  4436%     -  222s
     0     0 21056.2817    0  476  464.45073 21056.2817  4434%     -  224s
     0     0 21030.1544    0  470  464.45073 21030.1544  4428%     -  229s
     0     0 21024.6352    0  466  464.45073 21024.6352  4427%     -  232s
     0     0 21020.9964    0  463  464.45073 21020.9964  4426%     -  235s
     0     0 21020.5411    0  463  464.45073 21020.5411  4426%     -  236s
H    0     0                     688.6408391 19982.5957  2802%     -  266s
H    0     0                     703.4904492 19982.5957  2740%     -  266s
     0     0 19982.5957    0  460  703.49045 19982.5957  2740%     -  266s
H    0     0                     758.4125512 19742.5385  2503%     -  276s
     0     0 19742.5385    0  470  758.41255 19742.5385  2503%     -  276s
     0     0 19697.8934    0  522  758.41255 19697.8934  2497%     -  281s
     0     0 19661.2048    0  467  758.41255 19661.2048  2492%     -  285s
     0     0 19622.8881    0  528  758.41255 19622.8881  2487%     -  289s
     0     0 19610.3230    0  537  758.41255 19610.3230  2486%     -  291s
     0     0 19600.0716    0  467  758.41255 19600.0716  2484%     -  294s
     0     0 19578.1334    0  455  758.41255 19578.1334  2481%     -  296s
     0     0 19561.6594    0  461  758.41255 19561.6594  2479%     -  299s
     0     0 19546.4297    0  457  758.41255 19546.4297  2477%     -  302s
     0     0 19539.4300    0  458  758.41255 19539.4300  2476%     -  304s
     0     0 19536.7969    0  472  758.41255 19536.7969  2476%     -  305s
H    0     0                     788.7081635 19402.8644  2360%     -  315s
H    0     0                     841.5418419 19402.8644  2206%     -  315s
     0     0 19402.8644    0  511  841.54184 19402.8644  2206%     -  315s
H    0     0                     854.7538803 19402.6060  2170%     -  315s
H    0     0                     861.8780783 19402.6060  2151%     -  315s
     0     0 19356.4099    0  507  861.87808 19356.4099  2146%     -  320s
     0     0 19309.9715    0  532  861.87808 19309.9715  2140%     -  324s
H    0     0                    1025.0518013 19301.1224  1783%     -  325s
     0     0 19301.1224    0  490 1025.05180 19301.1224  1783%     -  325s
     0     0 19297.0353    0  492 1025.05180 19297.0353  1783%     -  326s
H    0     0                    1714.6728184 19255.8228  1023%     -  331s
     0     0 19255.8228    0  479 1714.67282 19255.8228  1023%     -  331s
     0     0 19243.0767    0  471 1714.67282 19243.0767  1022%     -  333s
     0     0 19235.4535    0  477 1714.67282 19235.4535  1022%     -  335s
     0     0 19210.5908    0  476 1714.67282 19210.5908  1020%     -  337s
     0     0 19201.2099    0  484 1714.67282 19201.2099  1020%     -  339s
H    0     0                    1867.9223507 19197.7731   928%     -  341s
H    0     0                    2062.8492473 19197.7731   831%     -  341s
     0     0 19197.7731    0  487 2062.84925 19197.7731   831%     -  341s
H    0     0                    2063.5702106 19182.8332   830%     -  344s
H    0     0                    2154.4700433 19182.8332   790%     -  344s
     0     0 19182.8332    0  480 2154.47004 19182.8332   790%     -  344s
H    0     0                    2283.0826633 19167.9034   740%     -  347s
H    0     0                    2283.1295546 19167.9034   740%     -  347s
     0     0 19167.9034    0  480 2283.12955 19167.9034   740%     -  347s
     0     0 19165.3927    0  480 2283.12955 19165.3927   739%     -  349s
     0     0 19061.9289    0  489 2283.12955 19061.9289   735%     -  359s
     0     0 19021.3837    0  503 2283.12955 19021.3837   733%     -  365s
     0     0 19000.1378    0  459 2283.12955 19000.1378   732%     -  368s
     0     0 18994.8406    0  455 2283.12955 18994.8406   732%     -  371s
     0     0 18975.9593    0  461 2283.12955 18975.9593   731%     -  374s
     0     0 18967.1296    0  465 2283.12955 18967.1296   731%     -  375s
     0     0 18964.8553    0  472 2283.12955 18964.8553   731%     -  376s
     0     0 18896.1261    0  450 2283.12955 18896.1261   728%     -  384s
     0     0 18869.0164    0  511 2283.12955 18869.0164   726%     -  390s
     0     0 18854.7472    0  499 2283.12955 18854.7472   726%     -  393s
     0     0 18851.2171    0  532 2283.12955 18851.2171   726%     -  394s
     0     0 18849.1088    0  515 2283.12955 18849.1088   726%     -  395s
     0     0 18786.0131    0  507 2283.12955 18786.0131   723%     -  401s
H    0     0                    2410.8974805 18785.9593   679%     -  403s
H    0     0                    2441.6296854 18785.9593   669%     -  403s
     0     0 18762.5505    0  519 2441.62969 18762.5505   668%     -  407s
     0     0 18757.8967    0  518 2441.62969 18757.8967   668%     -  409s
     0     0 18756.3918    0  511 2441.62969 18756.3918   668%     -  409s
     0     0 18722.6974    0  509 2441.62969 18722.6974   667%     -  414s
     0     0 18713.3778    0  476 2441.62969 18713.3778   666%     -  417s
     0     0 18705.1274    0  479 2441.62969 18705.1274   666%     -  419s
     0     0 18703.3500    0  481 2441.62969 18703.3500   666%     -  420s
     0     0 18682.9438    0  453 2441.62969 18682.9438   665%     -  425s
H    0     0                    2533.5770402 18682.8993   637%     -  427s
H    0     0                    2562.0890042 18682.8993   629%     -  427s
     0     0 18675.9216    0  454 2562.08900 18675.9216   629%     -  428s
     0     0 18673.1442    0  505 2562.08900 18673.1442   629%     -  429s
     0     0 18660.3373    0  492 2562.08900 18660.3373   628%     -  432s
     0     0 18655.3304    0  452 2562.08900 18655.3304   628%     -  434s
     0     0 18650.8367    0  466 2562.08900 18650.8367   628%     -  436s
     0     0 18649.1579    0  480 2562.08900 18649.1579   628%     -  437s
     0     0 18600.3197    0  472 2562.08900 18600.3197   626%     -  442s
H    0     0                    2655.9576772 18599.2109   600%     -  444s
     0     0 18586.5792    0  458 2655.95768 18586.5792   600%     -  447s
H    0     0                    2695.7690279 18575.1336   589%     -  448s
     0     0 18575.1336    0  449 2695.76903 18575.1336   589%     -  448s
     0     0 18572.9499    0  456 2695.76903 18572.9499   589%     -  449s
     0     0 18548.1579    0  456 2695.76903 18548.1579   588%     -  453s
     0     0 18544.9167    0  503 2695.76903 18544.9167   588%     -  456s
     0     0 18541.9336    0  459 2695.76903 18541.9336   588%     -  457s
     0     0 18540.0064    0  456 2695.76903 18540.0064   588%     -  458s
     0     0 18536.4987    0  458 2695.76903 18536.4987   588%     -  460s
H    0     0                    2810.4579378 18536.4366   560%     -  462s
H    0     0                    2924.3056112 18536.4366   534%     -  463s
H    0     0                    2927.5657882 18536.4366   533%     -  464s
H    0     0                    2943.1487801 18536.4366   530%     -  464s
     0     0 18530.3944    0  503 2943.14878 18530.3944   530%     -  465s
     0     0 18526.8497    0  550 2943.14878 18526.8497   529%     -  466s
     0     0 18526.5070    0  547 2943.14878 18526.5070   529%     -  467s
     0     0 18524.7099    0  515 2943.14878 18524.7099   529%     -  469s
     0     0 18524.6402    0  515 2943.14878 18524.6402   529%     -  472s
     0     2 18524.3580    0  515 2943.14878 18524.3580   529%     -  534s
     1     3 18325.3587    1  436 2943.14878 18524.0955   529%  7519  540s
     2     4 18306.9583    1  516 2943.14878 18325.3277   523%  6510  547s
     3     6 17783.5557    2  432 2943.14878 18324.6601   523%  7480  556s
     5    11 17045.5032    3  478 2943.14878 18306.6970   522%  8133  569s
    10    22 16540.0752    4  452 2943.14878 17968.7111   511%  8992  581s
    21    33 16720.6130    4  418 2943.14878 17797.5201   505% 13828  641s
H   32    65                    2967.9563863 17797.5201   500% 13237  710s
H   37    65                    2989.4171502 17797.5201   495% 12474  710s
H   49    65                    2989.8704728 17797.5201   495% 11490  710s
    64    97 16160.5512    6  412 2989.87047 17580.9952   488% 17801  775s
    96   237 16090.4572    7  414 2989.87047 17579.8410   488% 14954  807s
   236   328 14756.5180   12  337 2989.87047 17579.8410   488%  8732  824s
   327   359 14348.2051   16  318 2989.87047 17579.8410   488%  7224  837s
   358   397 14261.0695   17  294 2989.87047 17579.8410   488%  7157  850s
H  366   397                    3020.5740566 17579.8410   482%  7099  850s
   396   474 13975.2407   18  292 3020.57406 17579.8410   482%  6923  864s
   473   559 13176.4375   21  285 3020.57406 17579.8410   482%  6471  877s
   558   642 12658.5234   22  266 3020.57406 17579.8410   482%  6154  890s
   641   716 12367.1466   26  245 3020.57406 17579.8410   482%  5947  904s
   715   811 11911.1232   29  290 3020.57406 17579.8410   482%  5879  913s
   812   898 11436.9920   32  272 3020.57406 17579.8410   482%  5683  923s
   905   975 11081.2450   34  219 3020.57406 17579.8410   482%  5473  933s
  1002  1030 10882.1983   36  264 3020.57406 17579.8410   482%  5332  946s
  1075  1090 8925.44492   37  323 3020.57406 17579.8410   482%  5342  957s
  1157  1149 8685.13871   38  243 3020.57406 17579.8410   482%  5369  969s
  1248  1253 7650.28553   43  200 3020.57406 17434.9995   477%  5359  982s
  1362  1348 7422.49837   49  253 3020.57406 17434.9995   477%  5249  995s
  1475  1375 5839.02515   53  216 3020.57406 17434.9995   477%  5176 1007s
  1512  1379 infeasible   54      3020.57406 17155.9504   468%  5211 1023s
  1560  1383 infeasible   54      3020.57406 17155.9504   468%  5324 1037s
  1606  1403 13767.1492    9  354 3020.57406 17155.9504   468%  5347 1053s
  1642  1419 5400.63447   30  355 3020.57406 17155.9504   468%  5464 1067s
H 1682  1419                    3066.7468029 17155.9504   459%  5483 1067s
  1684  1478 13273.7008   10  360 3066.74680 17155.9504   459%  5489 1084s
  1797  1497 12069.4313   11  388 3066.74680 17155.9504   459%  5472 1101s
H 1815  1497                    3068.7168227 17155.9504   459%  5483 1101s
  1834  1548 10886.7694   12  347 3068.71682 17155.9504   459%  5563 1118s
H 1840  1548                    3154.2841116 17155.9504   444%  5576 1118s
  1911  1606 10198.3853   13  340 3154.28411 17155.9504   444%  5607 1137s
  2007  1691 8794.56414   14  299 3154.28411 17045.3784   440%  5628 1154s
  2110  1773 8506.27291   15  291 3154.28411 17045.3784   440%  5671 1173s
  2218  1872 8294.06849   18  142 3154.28411 17045.3784   440%  5720 1191s
  2341  2008 8124.94383   23  198 3154.28411 17045.3784   440%  5693 1210s
H 2501  2041                    3196.0818351 17045.3784   433%  5646 1226s
  2536  2069 7443.73000   30  125 3196.08184 16728.7517   423%  5678 1243s
  2570  2101 7438.93716   31  123 3196.08184 16728.7517   423%  5704 1261s
  2604  2135 7416.62894   32  117 3196.08184 16728.7517   423%  5724 1282s
H 2605  2135                    3198.2695903 16728.7517   423%  5721 1282s
  2642  2299 7280.29510   33  114 3198.26959 16728.7517   423%  5722 1302s
  2911  2435 5502.18898   42  124 3198.26959 16728.7517   423%  5493 1324s
  3148  2552 4236.47503   53  125 3198.26959 16716.8673   423%  5378 1349s
  3355  2665 3633.91873   62  105 3198.26959 16716.8673   423%  5323 1373s
  3532  2784 12957.3651   11  412 3198.26959 16463.5771   415%  5326 1398s
  3699  2863 4376.59448   14  310 3198.26959 16463.5771   415%  5356 1424s
  3825  2864 7317.87357   30  515 3198.26959 16404.5377   413%  5381 1618s
  3827  2865 13401.9010   11  245 3198.26959 16404.5377   413%  5378 1628s
  3828  2866 5565.71673   32  452 3198.26959 16404.5377   413%  5377 1693s
  3829  2867 13751.4406   10  432 3198.26959 16404.5377   413%  5375 1737s
  3830  2867 12786.0041   29  484 3198.26959 16404.5377   413%  5374 1762s
  3831  2868 11297.3432   22  500 3198.26959 16404.5377   413%  5373 1781s
  3832  2869 4216.26252   31  497 3198.26959 16404.5377   413%  5371 1797s
  3833  2869 5994.74561   53  501 3198.26959 16404.5377   413%  5370 1810s
  3834  2870 11923.2804   25  453 3198.26959 16404.5377   413%  5368 1821s
  3835  2871 6252.02894   18  458 3198.26959 16404.5377   413%  5367 1835s
  3836  2871 5790.17196   76  401 3198.26959 16404.5377   413%  5366 1843s
  3837  2872 6769.06973   21  462 3198.26959 16404.5377   413%  5364 1849s
  3838  2873 11659.9664   14  456 3198.26959 16404.5377   413%  5363 1853s
  3839  2873 12566.9974   18  435 3198.26959 16404.5377   413%  5361 1857s
  3840  2874 5813.65713   74  452 3198.26959 16404.5377   413%  5360 1873s
  3841  2875 8428.20554   47  481 3198.26959 16404.5377   413%  5359 1879s
  3842  2875 7712.15276   58  447 3198.26959 16404.5377   413%  5357 1885s
  3844  2877 4617.47342   88  449 3198.26959 16404.5377   413%  5354 1893s
  3845  2877 4414.12571   13  499 3198.26959 16404.5377   413%  5353 1911s
  3846  2878 7528.50755   24  508 3198.26959 16404.5377   413%  5352 1915s
  3848  2879 11635.3217   49  508 3198.26959 16404.5377   413%  5349 1923s
  3849  2880 5581.42447   58  553 3198.26959 16404.5377   413%  5348 1939s
  3850  2881 7032.28505   17  513 3198.26959 16404.5377   413%  5346 1944s
  3851  2881 9380.91992   13  514 3198.26959 16404.5377   413%  5345 1950s
  3852  2882 4648.01889   13  553 3198.26959 16404.5377   413%  5343 1964s
  3853  2883 5994.90566   46  520 3198.26959 16404.5377   413%  5342 1969s
  3854  2883 4623.56935   71  517 3198.26959 16404.5377   413%  5341 1975s
  3855  2884 12033.6764   23  524 3198.26959 16404.5377   413%  5339 1989s
  3856  2885 10804.9359   16  541 3198.26959 16404.5377   413%  5338 1995s
  3857  2885 4715.77556   37  562 3198.26959 16404.5377   413%  5336 2002s
  3858  2886 13429.7527   20  564 3198.26959 16404.5377   413%  5335 2015s
  3859  2887 11297.3432   22  549 3198.26959 16404.5377   413%  5334 2021s
  3860  2887 13310.6448   16  586 3198.26959 16404.5377   413%  5332 2031s
  3861  2888 8760.48510   23  538 3198.26959 16404.5377   413%  5331 2037s
  3862  2889 13861.4713   13  539 3198.26959 16404.5377   413%  5330 2048s
  3863  2889 6340.20614   37  519 3198.26959 16404.5377   413%  5328 2053s
  3864  2890 14646.7553    9  522 3198.26959 16404.5377   413%  5327 2056s
  3865  2891 9357.27562   16  533 3198.26959 16404.5377   413%  5325 2062s
  3866  2891 6002.51665   49  499 3198.26959 16404.5377   413%  5324 2073s
  3867  2892 10247.2793   21  499 3198.26959 16404.5377   413%  5323 2084s
  3868  2893 5878.46771   34  499 3198.26959 16404.5377   413%  5321 2147s
  3869  2896 16404.5377   14  480 3198.26959 16404.5377   413%  5411 2180s
  3871  2900 16404.5377   15  500 3198.26959 16404.5377   413%  5414 2222s
  3875  2906 16404.5377   16  501 3198.26959 16404.5377   413%  5423 2258s
  3883  2920 16404.5377   17  508 3198.26959 16404.5377   413%  5444 2290s
  3899  2930 14890.7510   18  518 3198.26959 16404.5377   413%  5498 2356s
  3915  2957 12737.4391   19  279 3198.26959 16404.5377   413%  5586 2385s
  3947  3026 11501.2136   20  359 3198.26959 16404.5377   413%  5597 2424s
  4042  3054 10689.3506   21  305 3198.26959 16404.5377   413%  5698 2454s
  4112  3072 10860.5613   22  399 3198.26959 16404.5377   413%  5689 2491s
  4158  3080 8323.75814   22  409 3198.26959 16404.5377   413%  5713 2514s
  4193  3089 8433.45851   23  291 3198.26959 16404.5377   413%  5739 2535s
  4227  3104 4412.38929   29  270 3198.26959 16404.5377   413%  5755 2557s
  4259  3117 9502.25522   23  435 3198.26959 16404.5377   413%  5757 2577s
  4298  3117 8032.16764   23  231 3198.26959 16404.5377   413%  5764 2598s
H 4309  2968                    3212.0852385 16404.5377   411%  5760 2598s
  4338  2973 6378.04381   23  310 3212.08524 16404.5377   411%  5762 2622s
  4394  2962 5460.73601   23  268 3212.08524 16404.5377   411%  5765 2646s
  4433  2967 8649.24585   27  372 3212.08524 16404.5377   411%  5775 2669s
  4482  2964 6713.70687   28  323 3212.08524 16404.5377   411%  5766 2697s
  4541  2950 4001.55381   24  239 3212.08524 16404.5377   411%  5762 2725s
  4604  2950 3967.00043   25  230 3212.08524 16404.5377   411%  5740 2762s
  4670  2942     cutoff   27      3212.08524 16404.5377   411%  5726 2787s
  4735  2923 9965.89595   20  368 3212.08524 16404.5377   411%  5710 2821s
  4787  2932 8525.87776   21  274 3212.08524 16404.5377   411%  5713 2857s
  4822  2961 6575.58565   23  256 3212.08524 16404.5377   411%  5741 2892s
  4872  2993     cutoff   25      3212.08524 16404.5377   411%  5752 2919s
  4941  3017 6108.89929   25  233 3212.08524 16404.5377   411%  5759 2946s
  5014  3040 5466.05527   28  226 3212.08524 16404.5377   411%  5756 2979s
  5094  3059 4519.34073   29  195 3212.08524 16404.5377   411%  5751 3020s
  5194  3071 infeasible   32      3212.08524 16404.5377   411%  5725 3051s
  5313  3040 3398.84133   35   96 3212.08524 15885.4840   395%  5690 3081s
  5360  3045 3249.16913   36   84 3212.08524 15885.4840   395%  5685 3103s
  5397  3055     cutoff   37      3212.08524 15885.4840   395%  5675 3133s
  5433  3058 8266.85043   35   82 3212.08524 15885.4840   395%  5677 3156s
H 5468  2908                    4797.0613523 15885.4840   231%  5678 3156s
H 5473  2764                    4860.3041476 15885.4840   227%  5677 3189s
H 5477  2637                    5018.8520223 15885.4840   217%  5673 3189s
H 5481  2518                    5732.6911565 15885.4840   177%  5672 3189s
H 5523  2391                    5878.5461370 15885.4840   170%  5665 3189s
  5540  2422 8054.53235   37   70 5878.54614 15885.4840   170%  5661 3226s
  5661  2434     cutoff   40      5878.54614 15885.4840   170%  5651 3263s
  5763  2442     cutoff   47      5878.54614 15885.4840   170%  5659 3303s
  5873  2419 infeasible   51      5878.54614 14966.5263   155%  5660 3346s
  6007  2423 6044.29520   62  171 5878.54614 14312.5572   143%  5657 3389s
  6123  2458 12916.6408   21  458 5878.54614 14312.5572   143%  5663 3433s
  6268  2429 11676.4459   24  480 5878.54614 13446.5848   129%  5652 3467s
H 6271  2322                    6026.5983927 13446.5848   123%  5653 3467s
H 6278  2217                    6556.9192921 13446.5848   105%  5655 3467s
  6306  2226 10924.0168   25  427 6556.91929 13446.5848   105%  5669 3510s
  6427  2233 6656.40550   28  426 6556.91929 13446.5848   105%  5693 3561s
  6552  2185     cutoff   29      6556.91929 13327.4011   103%  5710 3600s

Cutting planes:
  Learned: 1
  Gomory: 11
  Implied bound: 22
  Projected implied bound: 194
  MIR: 1444
  Mixing: 4
  Flow cover: 2646
  RLT: 74
  Relax-and-lift: 337

Explored 6654 nodes (38690775 simplex iterations) in 3600.04 seconds (8956.75 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 6556.92 6026.6 5878.55 ... 3196.08

Time limit reached
Best objective 6.556919292054e+03, best bound 1.332740109590e+04, gap 103.2571%
  WARNING: Time limit reached. Using best solution found (gap: 103.26%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = 6556.92, θ = 145382.07
  Upper Bound (UB) = 6556.92

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 145382.07
  [DEBUG]   ✓ Scenario 0: θ = 145382.07 ≤ Q = 145382.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 145382.07 ≤ Q = 145382.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 145382.07 ≤ Q = 150041.55 (slack: 4659.48)
  [DEBUG]   ✓ Scenario 3: θ = 145382.07 ≤ Q = 145382.07 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 145382.07 ≤ Q = 145382.07 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 145382.07 ≤ Q = 145382.07 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 145382.07 ≤ Q = 145382.07 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 145382.07 ≤ Q = 145382.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 145382.07 ≤ Q = 145382.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 145382.07 ≤ Q = 146329.64 (slack: 947.57)
  [DEBUG]   ✓ Scenario 10: θ = 145382.07 ≤ Q = 145382.07 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 11] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x4cbd7ab
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x04cbd7ab
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.188072e+13
Presolve removed 2619 rows and 1910 columns
Presolve time: 0.01s
Presolved: 474 rows, 479 columns, 1303 nonzeros
Found heuristic solution: objective 5415671.8921
Variable types: 325 continuous, 154 integer (154 binary)

Root relaxation: objective -1.469576e+05, 223 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -146957.62    0  119 5415671.89 -146957.62   103%     -    0s
H    0     0                    -113866.3815 -146957.62  29.1%     -    0s
H    0     0                    -114782.1295 -146957.62  28.0%     -    0s
     0     0 -124999.25    0   52 -114782.13 -124999.25  8.90%     -    0s
H    0     0                    -122974.6799 -124963.55  1.62%     -    0s
H    0     0                    -123346.6517 -124963.55  1.31%     -    0s
H    0     0                    -123616.0908 -124963.55  1.09%     -    0s
     0     0 -124384.19    0   38 -123616.09 -124384.19  0.62%     -    0s
H    0     0                    -123623.6702 -124371.46  0.60%     -    0s
     0     0 -124320.27    0   39 -123623.67 -124320.27  0.56%     -    0s
     0     0 -124318.62    0   39 -123623.67 -124318.62  0.56%     -    0s
     0     0 -124038.32    0   30 -123623.67 -124038.32  0.34%     -    0s
     0     0 -123940.14    0   26 -123623.67 -123940.14  0.26%     -    0s
     0     0 -123871.34    0   27 -123623.67 -123871.34  0.20%     -    0s
     0     0 -123871.34    0   30 -123623.67 -123871.34  0.20%     -    0s
     0     0 -123871.34    0   24 -123623.67 -123871.34  0.20%     -    0s
H    0     0                    -123645.4283 -123871.34  0.18%     -    0s
H    0     0                    -123699.3659 -123871.34  0.14%     -    0s
     0     0 -123871.34    0   22 -123699.37 -123871.34  0.14%     -    0s
     0     0 -123871.34    0   22 -123699.37 -123871.34  0.14%     -    0s
     0     0 -123771.02    0    7 -123699.37 -123771.02  0.06%     -    0s
     0     0 -123765.40    0    7 -123699.37 -123765.40  0.05%     -    0s
H    0     0                    -123711.5191 -123765.40  0.04%     -    0s
     0     0 -123754.51    0    4 -123711.52 -123754.51  0.03%     -    0s
     0     0 -123754.51    0    5 -123711.98 -123754.51  0.03%     -    0s
H    0     0                    -123751.9524 -123754.51  0.00%     -    0s

Explored 1 nodes (758 simplex iterations) in 0.05 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -123752 -123712 -123712 ... -114782

Optimal solution found (tolerance 1.00e-04)
Best objective -1.237519523559e+05, best bound -1.237545100248e+05, gap 0.0021%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 136421.03
  Scenario: 22 demand increases, 37 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -123751.95
  [DEBUG]   S×d_nominal = 260172.99
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 260172.99 + -123751.95 = 136421.03
  [DEBUG]   Current θ from Master = 145382.07
  [DEBUG]   ⚠️  Z_SP ≤ θ by 8961.04 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -2404.12
  Lower Bound (LB) = 6348.39
  Gap (UB-LB) = 208.5295, Absolute Gap = 208.5295, Relative Gap = 0.031803
  Not converged yet (gap = 208.53 > ε = 200)

  [DEBUG] Adding NEW scenario 11 to Master Problem...
  [DEBUG] New scenario pattern: 22 increases, 37 decreases
    [DEBUG] Scenario 11 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 11 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 11]
    [DEBUG]   - Total constraints in model: 184863
    [DEBUG]   - Total variables in model: 77140
  [DEBUG] Total scenarios in Master: 12
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 12
================================================================================
[Iteration 12] Solving Master Problem...
  Current scenarios in Master: 12
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 184863 rows, 77140 columns and 524219 nonzeros
Model fingerprint: 0xed7a8ea2
Variable types: 74881 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 87464 rows and 35524 columns
Presolve time: 1.72s
Presolved: 97399 rows, 41616 columns, 592247 nonzeros
Variable types: 39357 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -343652.9877
Found heuristic solution: objective -217726.0351

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.19s

Barrier statistics:
 Dense cols : 572
 AA' NZ     : 3.778e+06
 Factor NZ  : 8.563e+06 (roughly 130 MB of memory)
 Factor Ops : 1.558e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.72616065e+07  1.63838512e+08  1.05e+05 2.15e+01  7.45e+04     3s
   1  -1.25964280e+07  1.46685273e+08  7.12e+04 8.55e+01  5.01e+04     3s
   2  -4.10929336e+06  1.15463211e+08  2.30e+04 6.21e-01  1.69e+04     3s
   3  -1.20218845e+06  9.85845416e+07  2.86e+03 4.84e+00  2.55e+03     3s
   4  -7.27650719e+05  6.40895706e+07  4.91e+02 2.10e+00  6.83e+02     3s
   5  -4.83443073e+05  3.23818602e+07  2.31e+02 7.69e-01  3.16e+02     3s
   6  -3.89874831e+05  2.37939549e+07  8.08e+01 4.37e-02  1.78e+02     3s
   7  -2.88693720e+05  1.73532098e+07  2.50e+01 3.03e-02  1.10e+02     3s
   8  -1.67542052e+05  1.24808422e+07  7.30e+00 2.12e-02  7.35e+01     3s
   9  -1.34443534e+05  6.64175088e+06  5.27e+00 1.10e-02  3.91e+01     3s
  10  -9.63038071e+04  3.92010221e+06  3.14e+00 6.35e-03  2.30e+01     3s
  11  -5.45869104e+04  1.49370943e+06  1.12e+00 2.34e-03  8.74e+00     3s
  12  -2.23874201e+04  4.76903701e+05  3.38e-01 6.39e-04  2.81e+00     3s
  13  -1.42133080e+04  2.65568494e+05  2.33e-01 3.58e-04  1.57e+00     3s
  14  -5.86064192e+03  1.68286716e+05  1.49e-01 2.40e-04  9.77e-01     3s
  15  -8.69737990e+02  1.47474705e+05  1.23e-01 2.01e-04  8.32e-01     3s
  16   6.02845398e+03  1.03744842e+05  9.04e-02 1.41e-04  5.48e-01     3s
  17   8.18060284e+03  9.46211943e+04  8.25e-02 1.23e-04  4.85e-01     3s
  18   1.40738367e+04  7.71484306e+04  6.23e-02 4.35e-04  3.54e-01     4s
  19   1.94343848e+04  6.97890246e+04  4.58e-02 9.41e-04  2.82e-01     4s
  20   2.11134742e+04  5.60086243e+04  4.08e-02 7.74e-04  1.96e-01     4s
  21   2.47681535e+04  5.33987620e+04  3.12e-02 1.06e-03  1.61e-01     4s
  22   2.76028215e+04  4.71071384e+04  2.37e-02 6.36e-04  1.09e-01     4s
  23   2.90338279e+04  4.50331734e+04  1.97e-02 5.07e-04  8.97e-02     4s
  24   3.02807653e+04  4.29498952e+04  1.64e-02 4.44e-04  7.11e-02     4s
  25   3.19032957e+04  4.19291103e+04  1.22e-02 3.04e-04  5.62e-02     4s
  26   3.23839530e+04  4.08501231e+04  1.09e-02 2.41e-04  4.75e-02     4s
  27   3.29338420e+04  3.98272817e+04  9.48e-03 2.01e-04  3.87e-02     4s
  28   3.35251165e+04  3.93980561e+04  8.01e-03 1.70e-04  3.29e-02     4s
  29   3.38987202e+04  3.88336526e+04  7.05e-03 1.40e-04  2.77e-02     4s
  30   3.45444696e+04  3.85069941e+04  5.49e-03 1.14e-04  2.22e-02     4s
  31   3.49177410e+04  3.81565551e+04  4.60e-03 8.84e-05  1.82e-02     4s
  32   3.53973822e+04  3.79831070e+04  3.50e-03 7.45e-05  1.45e-02     4s
  33   3.56213034e+04  3.78716288e+04  2.99e-03 6.69e-05  1.26e-02     4s
  34   3.57899020e+04  3.75909758e+04  2.60e-03 5.43e-05  1.01e-02     4s
  35   3.60823383e+04  3.74666106e+04  1.92e-03 4.29e-05  7.76e-03     4s
  36   3.62724760e+04  3.73749783e+04  1.52e-03 3.57e-05  6.18e-03     4s
  37   3.64268778e+04  3.72422233e+04  1.18e-03 2.25e-05  4.57e-03     4s
  38   3.65185330e+04  3.71566580e+04  9.81e-04 1.51e-05  3.58e-03     4s
  39   3.65806290e+04  3.71208717e+04  8.46e-04 1.28e-05  3.03e-03     5s
  40   3.67236427e+04  3.70879467e+04  5.37e-04 1.45e-05  2.04e-03     5s
  41   3.67914026e+04  3.70662004e+04  3.96e-04 1.16e-05  1.54e-03     5s
  42   3.68138809e+04  3.70423174e+04  3.46e-04 8.35e-06  1.28e-03     5s
  43   3.68497608e+04  3.70252592e+04  2.68e-04 5.89e-06  9.84e-04     5s
  44   3.68981022e+04  3.70083401e+04  1.65e-04 3.57e-06  6.18e-04     5s
  45   3.69177588e+04  3.69982636e+04  1.24e-04 2.27e-06  4.52e-04     5s
  46   3.69303709e+04  3.69928876e+04  9.73e-05 1.62e-06  3.51e-04     5s
  47   3.69486087e+04  3.69902689e+04  6.09e-05 1.30e-06  2.34e-04     5s
  48   3.69518460e+04  3.69890544e+04  5.39e-05 1.16e-06  2.09e-04     5s
  49   3.69643044e+04  3.69816854e+04  2.94e-05 2.51e-07  9.75e-05     5s
  50   3.69679581e+04  3.69811653e+04  2.19e-05 1.80e-07  7.41e-05     5s
  51   3.69685096e+04  3.69805005e+04  2.08e-05 1.17e-07  6.73e-05     5s
  52   3.69748965e+04  3.69797401e+04  8.32e-06 1.90e-07  2.72e-05     5s
  53   3.69792364e+04  3.69793571e+04  8.25e-08 1.07e-08  6.76e-07     5s
  54   3.69793042e+04  3.69793275e+04  1.38e-08 2.87e-09  1.30e-07     5s
  55   3.69793157e+04  3.69793248e+04  9.68e-09 2.16e-09  5.12e-08     5s
  56   3.69793165e+04  3.69793167e+04  3.64e-09 2.90e-10  1.17e-09     5s

Barrier solved model in 56 iterations and 5.43 seconds (9.89 work units)
Optimal objective 3.69793165e+04


Root crossover log...

   79732 DPushes remaining with DInf 7.8335370e-07                 5s
       0 DPushes remaining with DInf 0.0000000e+00                 6s

    4794 PPushes remaining with PInf 4.2813424e-05                 6s
       0 PPushes remaining with PInf 0.0000000e+00                 6s

  Push phase complete: Pinf 0.0000000e+00, Dinf 4.3685730e+00      6s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   37938    3.6979317e+04   0.000000e+00   4.368573e+00      6s
   37940    3.6979317e+04   0.000000e+00   0.000000e+00      6s
   37940    3.6979317e+04   0.000000e+00   0.000000e+00      7s
Concurrent spin time: 0.81s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 3.697932e+04, 37940 iterations, 5.10 seconds (8.39 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 36979.3166    0  345 -217726.04 36979.3166   117%     -    7s
H    0     0                    -125945.5280 36979.3166   129%     -    8s
H    0     0                    -121379.0432 36979.3166   130%     -    8s
H    0     0                    -81076.11234 36979.3166   146%     -    8s
H    0     0                    -80396.81467 36979.3166   146%     -    8s
H    0     0                    -80103.87646 36979.3166   146%     -    8s
H    0     0                    -80053.17756 36979.3166   146%     -    8s
H    0     0                    -79982.06147 36979.3166   146%     -    8s
H    0     0                    -79933.67593 36979.3166   146%     -    8s
H    0     0                    -34903.55770 36979.3166   206%     -    8s
H    0     0                    -23094.33312 36979.3166   260%     -    8s
H    0     0                    -21572.90044 36979.3166   271%     -    9s
H    0     0                    -19611.15180 36979.3166   289%     -    9s
H    0     0                    -19057.79282 36979.3166   294%     -    9s
H    0     0                    -19028.72770 36979.3166   294%     -    9s
H    0     0                    -15112.13760 36979.3166   345%     -   11s
H    0     0                    -14060.79546 36979.3166   363%     -   11s
H    0     0                    -14045.93133 36979.3166   363%     -   11s
H    0     0                    -14039.42713 36979.3166   363%     -   11s
H    0     0                    -14030.76892 36979.3166   364%     -   11s
H    0     0                    -14010.59915 36979.3166   364%     -   11s
H    0     0                    -10109.17053 29768.6297   394%     -   39s
H    0     0                    -3157.979639 29768.6297  1043%     -   39s
H    0     0                    -3155.258000 29768.6297  1043%     -   39s
H    0     0                    -3138.832194 29768.6297  1048%     -   39s
     0     0 29768.6297    0  370 -3138.8322 29768.6297  1048%     -   39s
H    0     0                    -3049.929654 29767.6256  1076%     -   41s
H    0     0                    -3048.331116 29767.6256  1077%     -   41s
H    0     0                    -3011.102967 29767.6256  1089%     -   41s
H    0     0                    -2978.394161 29767.6256  1099%     -   41s
     0     0 29140.8462    0  414 -2978.3942 29140.8462  1078%     -   57s
     0     0 29140.8462    0  372 -2978.3942 29140.8462  1078%     -   60s
     0     0 29140.8462    0  369 -2978.3942 29140.8462  1078%     -   64s
     0     0 29140.8462    0  366 -2978.3942 29140.8462  1078%     -   66s
     0     0 29140.8462    0  365 -2978.3942 29140.8462  1078%     -   68s
     0     0 29140.8462    0  365 -2978.3942 29140.8462  1078%     -   69s
H    0     0                    -1432.375328 25831.3175  1903%     -  112s
H    0     0                    -1230.701751 25831.3175  2199%     -  112s
H    0     0                    -1188.698356 25831.3175  2273%     -  112s
H    0     0                    -1162.492206 25831.3175  2322%     -  112s
H    0     0                    -782.1425068 25831.3175  3403%     -  112s
H    0     0                    -576.4486131 25831.3175  4581%     -  112s
H    0     0                    -174.3709300 25831.3175      -     -  112s
H    0     0                    -156.7491252 25831.3175      -     -  112s
H    0     0                    -138.6911749 25831.3175      -     -  112s
H    0     0                    -104.5347360 25831.3175      -     -  112s
H    0     0                     -70.4070197 25831.3175      -     -  112s
H    0     0                     -10.9803197 25831.3175      -     -  112s
H    0     0                      -1.1265190 25831.3175      -     -  112s
H    0     0                       4.0700422 25831.3175      -     -  112s
     0     0 25831.3175    0  454    4.07004 25831.3175      -     -  117s
H    0     0                       6.1014718 25830.9676      -     -  117s
     0     0 25171.3187    0  462    6.10147 25171.3187      -     -  140s
H    0     0                      84.5043698 24834.9164      -     -  159s
     0     0 24834.9164    0  468   84.50437 24834.9164      -     -  161s
     0     0 24716.1007    0  484   84.50437 24716.1007      -     -  172s
H    0     0                     173.0008873 24601.0962      -     -  185s
H    0     0                     314.6610548 24601.0962  7718%     -  185s
H    0     0                     392.4653452 24601.0962  6168%     -  185s
H    0     0                     403.5421571 24601.0962  5996%     -  185s
H    0     0                     416.7191019 24601.0962  5804%     -  185s
     0     0 24601.0962    0  524  416.71910 24601.0962  5804%     -  186s
H    0     0                     450.2663528 24467.2924  5334%     -  201s
H    0     0                     460.3006306 24467.2924  5216%     -  201s
H    0     0                     468.9943465 24467.2924  5117%     -  201s
     0     0 24467.2924    0  515  468.99435 24467.2924  5117%     -  201s
     0     0 24454.9325    0  514  468.99435 24454.9325  5114%     -  207s
     0     0 24446.5977    0  532  468.99435 24446.5977  5113%     -  210s
     0     0 24437.9066    0  514  468.99435 24437.9066  5111%     -  212s
     0     0 24342.7919    0  541  468.99435 24342.7919  5090%     -  219s
H    0     0                     474.3322540 24333.4793  5030%     -  222s
H    0     0                     491.4140455 24333.4793  4852%     -  222s
     0     0 24333.4793    0  529  491.41405 24333.4793  4852%     -  222s
     0     0 24320.9855    0  537  491.41405 24320.9855  4849%     -  224s
     0     0 24313.1346    0  530  491.41405 24313.1346  4848%     -  226s
H    0     0                     565.9852360 24312.4730  4196%     -  227s
     0     0 24312.4730    0  532  565.98524 24312.4730  4196%     -  227s
H    0     0                     575.2779445 21743.0206  3680%     -  266s
     0     0 21743.0206    0  436  575.27794 21743.0206  3680%     -  267s
H    0     0                     645.4841730 21742.7939  3268%     -  267s
     0     0 21195.0165    0  433  645.48417 21195.0165  3184%     -  285s
     0     0 21083.0688    0  447  645.48417 21083.0688  3166%     -  294s
     0     0 20959.9132    0  443  645.48417 20959.9132  3147%     -  299s
     0     0 20884.7441    0  449  645.48417 20884.7441  3136%     -  308s
     0     0 20853.1928    0  448  645.48417 20853.1928  3131%     -  313s
     0     0 20800.5582    0  444  645.48417 20800.5582  3122%     -  319s
     0     0 20785.4480    0  448  645.48417 20785.4480  3120%     -  323s
     0     0 20774.1906    0  449  645.48417 20774.1906  3118%     -  326s
     0     0 20758.0835    0  449  645.48417 20758.0835  3116%     -  330s
     0     0 20752.3519    0  460  645.48417 20752.3519  3115%     -  332s
H    0     0                     669.7173170 20745.9523  2998%     -  334s
     0     0 20745.9523    0  467  669.71732 20745.9523  2998%     -  334s
H    0     0                     697.8447393 20734.8866  2871%     -  336s
H    0     0                     704.2941319 20734.8866  2844%     -  336s
     0     0 20734.8866    0  467  704.29413 20734.8866  2844%     -  337s
     0     0 20723.6004    0  468  704.29413 20723.6004  2842%     -  339s
     0     0 20722.1165    0  466  704.29413 20722.1165  2842%     -  340s
     0     0 19961.2394    0  533  704.29413 19961.2394  2734%     -  370s
H    0     0                     731.2684928 19779.7528  2605%     -  381s
H    0     0                     923.7712196 19779.7528  2041%     -  381s
H    0     0                     938.8215815 19779.7528  2007%     -  381s
     0     0 19779.7528    0  528  938.82158 19779.7528  2007%     -  383s
H    0     0                     942.3092081 19710.0104  1992%     -  388s
H    0     0                    1067.3546792 19710.0104  1747%     -  388s
H    0     0                    1124.5197217 19710.0104  1653%     -  388s
     0     0 19710.0104    0  520 1124.51972 19710.0104  1653%     -  389s
     0     0 19670.9421    0  522 1124.51972 19670.9421  1649%     -  395s
     0     0 19637.5394    0  544 1124.51972 19637.5394  1646%     -  400s
     0     0 19628.7112    0  530 1124.51972 19628.7112  1646%     -  403s
     0     0 19579.9131    0  537 1124.51972 19579.9131  1641%     -  407s
H    0     0                    1129.0843281 19560.4660  1632%     -  411s
     0     0 19560.4660    0  549 1129.08433 19560.4660  1632%     -  411s
     0     0 19545.6940    0  560 1129.08433 19545.6940  1631%     -  415s
     0     0 19529.9556    0  527 1129.08433 19529.9556  1630%     -  418s
     0     0 19511.7014    0  530 1129.08433 19511.7014  1628%     -  420s
     0     0 19507.2771    0  549 1129.08433 19507.2771  1628%     -  421s
     0     0 19498.4996    0  542 1129.08433 19498.4996  1627%     -  423s
     0     0 19495.0544    0  544 1129.08433 19495.0544  1627%     -  424s
     0     0 19491.0081    0  543 1129.08433 19491.0081  1626%     -  425s
     0     0 19490.3645    0  545 1129.08433 19490.3645  1626%     -  426s
     0     0 19221.0625    0  496 1129.08433 19221.0625  1602%     -  438s
H    0     0                    1151.8959288 19220.9357  1569%     -  439s
H    0     0                    1205.3210656 19220.9357  1495%     -  439s
     0     0 19105.4670    0  505 1205.32107 19105.4670  1485%     -  446s
     0     0 19062.8135    0  519 1205.32107 19062.8135  1482%     -  451s
     0     0 19045.1264    0  536 1205.32107 19045.1264  1480%     -  454s
     0     0 19027.9980    0  552 1205.32107 19027.9980  1479%     -  459s
     0     0 19007.2281    0  526 1205.32107 19007.2281  1477%     -  462s
     0     0 19003.6213    0  546 1205.32107 19003.6213  1477%     -  464s
     0     0 19000.5115    0  540 1205.32107 19000.5115  1476%     -  466s
     0     0 18997.6984    0  531 1205.32107 18997.6984  1476%     -  469s
     0     0 18871.7477    0  511 1205.32107 18871.7477  1466%     -  481s
     0     0 18828.3838    0  530 1205.32107 18828.3838  1462%     -  487s
     0     0 18823.2995    0  534 1205.32107 18823.2995  1462%     -  489s
     0     0 18811.7197    0  517 1205.32107 18811.7197  1461%     -  492s
     0     0 18805.5202    0  510 1205.32107 18805.5202  1460%     -  493s
     0     0 18792.7385    0  511 1205.32107 18792.7385  1459%     -  495s
     0     0 18791.7419    0  529 1205.32107 18791.7419  1459%     -  496s
     0     0 18733.1257    0  520 1205.32107 18733.1257  1454%     -  505s
H    0     0                    1213.2279565 18733.0707  1444%     -  505s
     0     0 18719.9580    0  583 1213.22796 18719.9580  1443%     -  508s
     0     0 18714.2234    0  527 1213.22796 18714.2234  1443%     -  510s
     0     0 18711.2561    0  531 1213.22796 18711.2561  1442%     -  511s
     0     0 18709.5288    0  532 1213.22796 18709.5288  1442%     -  512s
     0     0 18655.8911    0  465 1213.22796 18655.8911  1438%     -  517s
     0     0 18644.2865    0  476 1213.22796 18644.2865  1437%     -  522s
     0     0 18639.4914    0  482 1213.22796 18639.4914  1436%     -  524s
     0     0 18628.1878    0  508 1213.22796 18628.1878  1435%     -  526s
     0     0 18625.1784    0  467 1213.22796 18625.1784  1435%     -  527s
     0     0 18621.6887    0  480 1213.22796 18621.6887  1435%     -  528s
     0     0 18621.3902    0  476 1213.22796 18621.3902  1435%     -  528s
     0     0 18589.8576    0  527 1213.22796 18589.8576  1432%     -  533s
     0     0 18579.4161    0  538 1213.22796 18579.4161  1431%     -  535s
     0     0 18574.9665    0  488 1213.22796 18574.9665  1431%     -  536s
     0     0 18571.6825    0  490 1213.22796 18571.6825  1431%     -  537s
     0     0 18570.9325    0  545 1213.22796 18570.9325  1431%     -  537s
     0     0 18519.9764    0  473 1213.22796 18519.9764  1427%     -  543s
H    0     0                    1241.4037211 18519.8888  1392%     -  545s
     0     0 18493.3326    0  541 1241.40372 18493.3326  1390%     -  550s
     0     0 18487.7046    0  548 1241.40372 18487.7046  1389%     -  551s
     0     0 18485.3874    0  540 1241.40372 18485.3874  1389%     -  552s
     0     0 18459.6829    0  554 1241.40372 18459.6829  1387%     -  556s
     0     0 18455.0188    0  502 1241.40372 18455.0188  1387%     -  559s
     0     0 18451.6311    0  488 1241.40372 18451.6311  1386%     -  560s
     0     0 18450.1739    0  493 1241.40372 18450.1739  1386%     -  561s
     0     0 18418.7004    0  586 1241.40372 18418.7004  1384%     -  568s
H    0     0                    1269.9511683 18418.5959  1350%     -  574s
     0     0 18408.4715    0  525 1269.95117 18408.4715  1350%     -  579s
     0     0 18405.5962    0  524 1269.95117 18405.5962  1349%     -  580s
     0     0 18399.8975    0  462 1269.95117 18399.8975  1349%     -  584s
H    0     0                    1285.7331932 18399.5736  1331%     -  584s
     0     0 18396.1934    0  529 1285.73319 18396.1934  1331%     -  586s
     0     0 18395.1158    0  534 1285.73319 18395.1158  1331%     -  586s
     0     0 18391.4623    0  525 1285.73319 18391.4623  1330%     -  589s
H    0     0                    1303.8479812 18390.9846  1311%     -  590s
H    0     0                    1319.3146949 18390.9846  1294%     -  591s
H    0     0                    1415.2774598 18390.9846  1199%     -  591s
     0     0 18390.2107    0  532 1415.27746 18390.2107  1199%     -  592s
     0     0 18388.9954    0  473 1415.27746 18388.9954  1199%     -  594s
     0     0 18388.9550    0  473 1415.27746 18388.9550  1199%     -  597s
H    0     0                    1438.0188507 18388.8488  1179%     -  664s
H    0     0                    1476.5076950 18388.8488  1145%     -  664s
H    0     2                    1523.4615828 18388.8488  1107%     -  666s
     0     2 18388.8488    0  473 1523.46158 18388.8488  1107%     -  666s
     1     3 18193.3785    1  463 1523.46158 18387.3133  1107%  6877  673s
     2     4 18186.4276    1  467 1523.46158 18192.8318  1094%  5927  682s
     3     8 18025.0821    2  428 1523.46158 18192.8318  1094%  5960  691s
     7    15 16768.1933    3  439 1523.46158 18159.1214  1092%  7101  705s
    14    30 17335.2371    4  450 1523.46158 18035.0799  1084%  9860  716s
    29    45 17389.1813    5  455 1523.46158 17802.5870  1069% 12244  745s
    44    75 16613.7499    6  438 1523.46158 17802.5870  1069% 15563  818s
H   46    75                    1540.6996998 17802.5870  1055% 15134  818s
H   47    75                    1553.7067531 17802.5870  1046% 15050  818s
H   59    75                    1591.9934694 17802.5870  1018% 14027  818s
    74   137 16517.6042    7  440 1591.99347 17516.2406  1000% 14001  853s
   136   169 16229.4686    9  324 1591.99347 17400.9512   993% 11003  870s
   168   205 16146.6982   10  330 1591.99347 17400.9512   993% 10540  886s
   204   235 15899.6484   11  437 1591.99347 17400.9512   993%  9924  902s
H  216   235                    1925.8670464 17400.9512   804%  9554  902s
   234   339 16007.3045   11  313 1925.86705 17400.9512   804%  9136  925s
   340   440 15638.1912   13  328 1925.86705 17400.9512   804%  7290  942s
   443   514 15428.6239   15  416 1925.86705 17400.9512   804%  6225  958s
   521   545 14063.1710   17  293 1925.86705 17400.9512   804%  5840  971s
H  523   545                    1963.1062820 17400.9512   786%  5836  971s
H  526   545                    2039.1444598 17400.9512   753%  5821  971s
H  532   545                    2107.7051681 17400.9512   726%  5772  971s
H  534   545                    2230.3626831 17400.9512   680%  5755  971s
H  536   545                    2479.7640126 17400.9512   602%  5736  971s
   554   610 14036.5486   18  328 2479.76401 17400.9512   602%  5656  986s
   628   665 13848.8958   20  377 2479.76401 17400.9512   602%  5348  999s
   699   705 13417.0548   21  352 2479.76401 17400.9512   602%  5159 1012s
   765   740 12992.1636   22  379 2479.76401 17400.9512   602%  4978 1025s
   822   765 12744.9297   23  366 2479.76401 17400.9512   602%  4864 1041s
   875   789 12498.3618   25  292 2479.76401 17400.9512   602%  4840 1058s
   917   811 10172.1082   27  281 2479.76401 17400.9512   602%  4820 1076s
   943   841 infeasible   28      2479.76401 17400.9512   602%  4914 1094s
   975   875 infeasible   29      2479.76401 17400.9512   602%  5019 1112s
  1015   923 5293.38204   28  255 2479.76401 17400.9512   602%  5072 1130s
  1063   982 7812.95961   30  429 2479.76401 17400.9512   602%  5068 1149s
  1134  1049 7711.69705   33  397 2479.76401 17400.9512   602%  5008 1169s
  1221  1113 7143.58319   38  309 2479.76401 17400.9512   602%  4919 1187s
  1321  1235 7462.57410   37  341 2479.76401 17400.9512   602%  4738 1207s
  1467  1294 7079.43386   39  400 2479.76401 17400.9512   602%  4501 1231s
  1578  1315 7475.91892   35  398 2479.76401 17400.9512   602%  4400 1247s
H 1593  1315                    2495.8219532 17400.9512   597%  4413 1247s
  1615  1403 7173.78546   35  423 2495.82195 17400.9512   597%  4394 1267s
  1753  1469 6388.04995   40  366 2495.82195 17400.9512   597%  4260 1287s
H 1761  1469                    4252.7749493 17400.9512   309%  4254 1287s
H 1816  1469                    5143.2744194 17400.9512   238%  4248 1287s
  1846  1488 infeasible   36      5143.27442 17400.9512   238%  4211 1312s
  1992  1523 6155.21716   40  300 5143.27442 17334.9703   237%  4092 1336s
  2075  1596 6239.58759   41  349 5143.27442 17334.9703   237%  4115 1360s
  2201  1684 5612.33980   50  189 5143.27442 17334.9703   237%  4092 1386s
  2330  1747 infeasible   52      5143.27442 17259.1418   236%  4072 1417s
  2444  1777     cutoff   50      5143.27442 17253.4738   235%  4062 1447s
  2549  1816 12012.9237   10  376 5143.27442 17253.4738   235%  4096 1476s
H 2665  1782                    5156.9100335 17048.9297   231%  4090 1500s
H 2666  1782                    5192.5786262 17048.9297   228%  4094 1500s
H 2669  1782                    5892.6400019 17048.9297   189%  4103 1500s
H 2692  1782                    5906.8126542 17048.9297   189%  4093 1500s
H 2697  1782                    6443.2405055 17048.9297   165%  4099 1500s
H 2716  1782                    6560.7510236 17048.9297   160%  4089 1500s
  2723  1792 11507.9651   10  262 6560.75102 17048.9297   160%  4106 1533s
  2830  1781 11030.2510   13  315 6560.75102 17048.9297   160%  4117 1565s
  2925  1830 10308.5981   16  235 6560.75102 17048.9297   160%  4146 1595s
  3086  1797     cutoff   30      6560.75102 17048.9297   160%  4115 1626s
  3208  1778     cutoff   28      6560.75102 17048.9297   160%  4107 1663s
  3366  1774 9930.68072   19  350 6560.75102 17048.9297   160%  4091 1707s
  3488  1858 9447.19358   21  228 6560.75102 17048.9297   160%  4129 1745s
  3626  1885 8898.56449   26  319 6560.75102 16762.2065   155%  4184 1775s
  3663  1928 8859.93884   27  331 6560.75102 16673.9569   154%  4224 1808s
  3718  2015 8770.21728   28  368 6560.75102 16673.9569   154%  4234 1848s
  3854  2016 8199.03442   28  473 6560.75102 16673.9569   154%  4201 2050s
  3856  2017 15164.3978   18  241 6560.75102 16673.9569   154%  4198 2062s
  3857  2018 7671.74292   24  423 6560.75102 16673.9569   154%  4197 2148s
  3858  2019 12652.5754   20  511 6560.75102 16673.9569   154%  4196 2215s
  3859  2019 7228.44952   18  479 6560.75102 16673.9569   154%  4195 2251s
  3860  2020 7462.26710   43  518 6560.75102 16673.9569   154%  4194 2275s
  3861  2021 10027.1125   19  460 6560.75102 16673.9569   154%  4193 2295s
  3862  2021 13487.2698   10  508 6560.75102 16673.9569   154%  4192 2307s
  3863  2022 8405.34906   33  523 6560.75102 16673.9569   154%  4191 2313s
  3864  2023 16082.0200    6  496 6560.75102 16673.9569   154%  4190 2321s
  3865  2023 11193.1777   11  535 6560.75102 16673.9569   154%  4189 2326s
  3866  2024 10448.0166   31  466 6560.75102 16673.9569   154%  4187 2333s
  3867  2025 13936.6122    7  516 6560.75102 16673.9569   154%  4186 2340s
  3868  2025 9869.21608   22  516 6560.75102 16673.9569   154%  4185 2347s
  3870  2027 13554.7028   25  465 6560.75102 16673.9569   154%  4183 2354s
  3871  2027 8288.98359    9  507 6560.75102 16673.9569   154%  4182 2373s
  3872  2028 12832.7056    9  513 6560.75102 16673.9569   154%  4181 2378s
  3873  2029 7516.98440   42  461 6560.75102 16673.9569   154%  4180 2384s
  3874  2029 8162.23178   50  464 6560.75102 16673.9569   154%  4179 2389s
  3875  2030 9964.78870   12  521 6560.75102 16673.9569   154%  4178 2403s
  3876  2031 14015.4788    7  472 6560.75102 16673.9569   154%  4177 2411s
  3878  2032 7819.64043   35  450 6560.75102 16673.9569   154%  4175 2417s
  3879  2033 14982.5631   25  530 6560.75102 16673.9569   154%  4173 2431s
  3880  2033 7378.68147   21  517 6560.75102 16673.9569   154%  4172 2439s
  3881  2034 6758.89181   34  513 6560.75102 16673.9569   154%  4171 2445s
  3883  2035 12029.0907   21  506 6560.75102 16673.9569   154%  4169 2462s
  3884  2036 11391.1668   10  528 6560.75102 16673.9569   154%  4168 2469s
  3885  2037 8634.30931   13  528 6560.75102 16673.9569   154%  4167 2473s
  3886  2037 13181.9508   13  532 6560.75102 16673.9569   154%  4166 2478s
  3887  2038 8135.23507   36  473 6560.75102 16673.9569   154%  4165 2492s
  3888  2039 15678.5893    8  523 6560.75102 16673.9569   154%  4164 2499s
  3889  2039 6691.89639   30  571 6560.75102 16673.9569   154%  4163 2504s
  3890  2040 12472.7564   10  471 6560.75102 16673.9569   154%  4162 2509s
  3891  2041 8753.52043   24  587 6560.75102 16673.9569   154%  4161 2527s
  3892  2041 9172.19818   26  545 6560.75102 16673.9569   154%  4160 2533s
  3893  2042 7466.87059   32  545 6560.75102 16673.9569   154%  4158 2538s
  3894  2043 11010.4915   14  476 6560.75102 16673.9569   154%  4157 2556s
  3895  2043 7806.38845   34  486 6560.75102 16673.9569   154%  4156 2566s
  3896  2044 9940.93430   25  594 6560.75102 16673.9569   154%  4155 2573s
  3897  2045 6913.21647   22  589 6560.75102 16673.9569   154%  4154 2577s
  3898  2045 14487.2971   30  606 6560.75102 16673.9569   154%  4153 2586s
  3899  2046 16615.0685    5  603 6560.75102 16673.9569   154%  4152 2590s
  3900  2047 13375.2632   17  602 6560.75102 16673.9569   154%  4151 2595s
  3901  2047 13537.2269   21  605 6560.75102 16673.9569   154%  4150 2608s
  3902  2048 13554.7028   25  601 6560.75102 16673.9569   154%  4149 2612s
  3903  2049 10416.8298   27  517 6560.75102 16673.9569   154%  4148 2617s
  3904  2049 8523.45001   34  513 6560.75102 16673.9569   154%  4147 2625s
  3905  2050 7916.83443   33  572 6560.75102 16673.9569   154%  4146 2630s
  3906  2051 9267.81133   20  610 6560.75102 16673.9569   154%  4145 2664s
  3907  2051 14429.6410   21  549 6560.75102 16673.9569   154%  4144 2688s
  3908  2052 11235.1916   20  566 6560.75102 16673.9569   154%  4142 2698s
  3909  2053 9964.78870   12  566 6560.75102 16673.9569   154%  4141 2716s
  3910  2053 9750.28218   28  566 6560.75102 16673.9569   154%  4140 2765s
  3911  2057 16673.9569   10  533 6560.75102 16673.9569   154%  4255 2796s
  3913  2059 16673.9569   11  531 6560.75102 16673.9569   154%  4257 2815s
  3916  2064 16673.9569   12  495 6560.75102 16673.9569   154%  4263 2848s
  3922  2075 16529.9547   13  531 6560.75102 16673.9569   154%  4273 2882s
  3935  2084 15048.3862   14  485 6560.75102 16529.9041   152%  4355 2948s
  3948  2106 14273.3240   15  516 6560.75102 16529.9041   152%  4387 3033s
H 3967  1994                    6823.1376457 16529.9041   142%  4432 3033s
  3980  2065 13790.2284   16  588 6823.13765 16286.7323   139%  4574 3078s
H 4059  1966                    6963.5242559 16133.5474   132%  4722 3112s
H 4060  1872                    7209.9840993 16133.5474   124%  4722 3112s
  4093  1894 9742.15479   20  333 7209.98410 16133.5474   124%  4760 3146s
  4131  1925 10391.6815   19  495 7209.98410 15812.8662   119%  4794 3180s
H 4161  1826                    7443.1851049 15812.8662   112%  4825 3180s
  4184  1853 10255.2066   20  505 7443.18510 15812.8662   112%  4840 3212s
  4243  1865 9421.94238   22  370 7443.18510 15791.9113   112%  4873 3244s
  4302  1868 8548.58158   24  302 7443.18510 15791.9113   112%  4892 3273s
  4368  1863     cutoff   26      7443.18510 15791.9113   112%  4921 3302s
  4421  1879 8198.37590   26  254 7443.18510 15791.9113   112%  4942 3329s
  4481  1872     cutoff   27      7443.18510 15791.9113   112%  4951 3360s
  4533  1878 infeasible   22      7443.18510 15566.9793   109%  4966 3398s
  4597  1858 12980.6711   18  563 7443.18510 15012.9890   102%  4984 3440s
  4640  1848 11757.6412   18  527 7443.18510 15012.9890   102%  5004 3468s
  4685  1841 7702.45988   26  246 7443.18510 15012.9890   102%  5019 3494s
  4710  1851 11492.9414   19  541 7443.18510 15012.9890   102%  5039 3521s
H 4743  1756                    7484.9689725 15012.9890   101%  5056 3521s
  4755  1769 11274.4851   20  531 7484.96897 15012.9890   101%  5061 3546s
  4786  1781 10719.4843   20  504 7484.96897 14583.8014  94.8%  5086 3572s
  4827  1787 10429.5926   21  457 7484.96897 14583.8014  94.8%  5110 3600s

Cutting planes:
  Gomory: 3
  Implied bound: 34
  Projected implied bound: 304
  MIR: 1188
  Mixing: 1
  Flow cover: 2372
  Inf proof: 1
  RLT: 89
  Relax-and-lift: 290

Explored 4862 nodes (25590809 simplex iterations) in 3600.04 seconds (8494.76 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 7484.97 7443.19 7209.98 ... 5192.58

Time limit reached
Best objective 7.484968972484e+03, best bound 1.458380142335e+04, gap 94.8412%
  WARNING: Time limit reached. Using best solution found (gap: 94.84%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.05s
  Master Objective (UB) = 7484.97, θ = 145205.85
  Upper Bound (UB) = 7484.97

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 145205.85
  [DEBUG]   ✓ Scenario 0: θ = 145205.85 ≤ Q = 145205.85 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 145205.85 ≤ Q = 145205.85 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 145205.85 ≤ Q = 145205.85 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 145205.85 ≤ Q = 145205.85 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 145205.85 ≤ Q = 145205.85 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 145205.85 ≤ Q = 145205.85 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 145205.85 ≤ Q = 145205.85 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 145205.85 ≤ Q = 145205.85 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 145205.85 ≤ Q = 145205.85 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 145205.85 ≤ Q = 145205.85 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 145205.85 ≤ Q = 145205.85 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 145205.85 ≤ Q = 145205.85 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 12] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x4394ac8d
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xbc6b5373
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.196870e+13
Presolve removed 2613 rows and 1904 columns
Presolve time: 0.00s
Presolved: 480 rows, 485 columns, 1318 nonzeros
Found heuristic solution: objective 5553903.5974
Variable types: 329 continuous, 156 integer (156 binary)

Root relaxation: objective -1.477328e+05, 230 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -147732.84    0  121 5553903.60 -147732.84   103%     -    0s
H    0     0                    -114187.1222 -147732.84  29.4%     -    0s
H    0     0                    -115071.9294 -147732.84  28.4%     -    0s
     0     0 -118949.51    0  126 -115071.93 -118949.51  3.37%     -    0s
H    0     0                    -115633.2123 -118905.91  2.83%     -    0s
     0     0 -118062.63    0   97 -115633.21 -118062.63  2.10%     -    0s
H    0     0                    -116420.0176 -118054.44  1.40%     -    0s
     0     0 -118054.44    0   97 -116420.02 -118054.44  1.40%     -    0s
     0     0 -117818.61    0   93 -116420.02 -117818.61  1.20%     -    0s
     0     0 -117816.85    0   93 -116420.02 -117816.85  1.20%     -    0s
H    0     0                    -116501.2717 -117794.50  1.11%     -    0s
     0     2 -117794.50    0   93 -116501.27 -117794.50  1.11%     -    0s
H   30    47                    -116561.2347 -117700.11  0.98%  13.9    0s
H   30    47                    -116760.5230 -117700.11  0.80%  13.9    0s
H   31    47                    -116946.0650 -117700.11  0.64%  13.6    0s
H   35    47                    -117112.9028 -117700.11  0.50%  12.3    0s
H   44    38                    -117400.2240 -117700.11  0.26%  10.9    0s

Cutting planes:
  Gomory: 52
  Implied bound: 2
  MIR: 202

Explored 133 nodes (1424 simplex iterations) in 0.07 seconds (0.06 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -117400 -117113 -116946 ... -114187
No other solutions better than -117400

Optimal solution found (tolerance 1.00e-04)
Best objective -1.174002239536e+05, best bound -1.174002239536e+05, gap 0.0000%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 143784.37
  Scenario: 20 demand increases, 39 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -117400.22
  [DEBUG]   S×d_nominal = 261184.59
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 261184.59 + -117400.22 = 143784.37
  [DEBUG]   Current θ from Master = 145205.85
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1421.49 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 6063.48
  Lower Bound (LB) = 6348.39
  Gap (UB-LB) = 1136.5791, Absolute Gap = 1136.5791, Relative Gap = 0.151848
  Not converged yet (gap = 1136.58 > ε = 200)

  [DEBUG] Adding NEW scenario 12 to Master Problem...
  [DEBUG] New scenario pattern: 20 increases, 39 decreases
    [DEBUG] Scenario 12 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 12 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 12]
    [DEBUG]   - Total constraints in model: 200153
    [DEBUG]   - Total variables in model: 83380
  [DEBUG] Total scenarios in Master: 13
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 13
================================================================================
[Iteration 13] Solving Master Problem...
  Current scenarios in Master: 13
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 200153 rows, 83380 columns and 567444 nonzeros
Model fingerprint: 0x686fbf59
Variable types: 81121 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 94776 rows and 38496 columns
Presolve time: 1.61s
Presolved: 105377 rows, 44884 columns, 639745 nonzeros
Variable types: 42625 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -351014.5925
Found heuristic solution: objective -217726.0351

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.22s

Barrier statistics:
 Dense cols : 566
 AA' NZ     : 4.351e+06
 Factor NZ  : 9.905e+06 (roughly 140 MB of memory)
 Factor Ops : 1.888e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.73630090e+07  1.75648091e+08  1.06e+05 2.06e+01  7.45e+04     3s
   1  -1.27617702e+07  1.57261737e+08  7.22e+04 8.27e+01  5.05e+04     3s
   2  -4.63654016e+06  1.23875896e+08  2.60e+04 7.20e-01  1.90e+04     3s
   3  -1.03276550e+06  1.13975924e+08  2.88e+03 6.97e+00  2.61e+03     3s
   4  -6.35043410e+05  7.36980462e+07  1.02e+03 3.55e+00  1.06e+03     3s
   5  -4.88747616e+05  3.14126960e+07  3.46e+02 7.24e-02  3.68e+02     3s
   6  -3.52493870e+05  2.23717335e+07  7.18e+01 4.70e-02  1.57e+02     3s
   7  -2.74196685e+05  1.60110706e+07  3.66e+01 3.18e-02  1.01e+02     3s
   8  -1.45310523e+05  1.30618485e+07  1.29e+01 2.53e-02  7.38e+01     3s
   9  -1.15091000e+05  7.47311838e+06  8.22e+00 1.38e-02  4.16e+01     3s
  10  -9.33823202e+04  4.03175962e+06  4.62e+00 3.06e-02  2.21e+01     3s
  11  -7.08512630e+04  1.66925653e+06  2.68e+00 3.07e-03  9.24e+00     3s
  12  -3.36728320e+04  4.70425753e+05  1.21e+00 4.98e-03  2.65e+00     3s
  13  -2.07860011e+04  2.99051346e+05  8.31e-01 3.48e-03  1.68e+00     3s
  14  -1.11644775e+04  2.07318515e+05  5.61e-01 3.18e-04  1.14e+00     3s
  15  -5.57847095e+03  1.53432834e+05  4.49e-01 2.21e-04  8.30e-01     3s
  16   1.73655849e+03  1.16140655e+05  3.38e-01 1.92e-04  5.96e-01     3s
  17   7.58840449e+03  8.51614541e+04  2.73e-01 3.73e-04  4.04e-01     4s
  18   1.13139914e+04  7.15615385e+04  2.31e-01 5.96e-04  3.14e-01     4s
  19   1.79298355e+04  6.52763052e+04  1.59e-01 9.73e-04  2.47e-01     4s
  20   2.21317428e+04  5.91364221e+04  1.21e-01 1.10e-03  1.93e-01     4s
  21   2.31223069e+04  5.62876060e+04  1.11e-01 1.03e-03  1.73e-01     4s
  22   2.51752767e+04  5.07822927e+04  9.37e-02 1.19e-03  1.33e-01     4s
  23   2.66237530e+04  4.69813716e+04  8.25e-02 1.42e-03  1.06e-01     4s
  24   2.84787519e+04  4.46468490e+04  6.74e-02 1.11e-03  8.42e-02     4s
  25   3.02487060e+04  4.29652807e+04  5.44e-02 9.88e-04  6.63e-02     4s
  26   3.10566540e+04  4.19735710e+04  4.79e-02 1.06e-03  5.69e-02     4s
  27   3.24020250e+04  4.10767308e+04  3.75e-02 1.04e-03  4.52e-02     4s
  28   3.29565561e+04  4.08806965e+04  3.34e-02 9.78e-04  4.13e-02     4s
  29   3.36483132e+04  3.98764133e+04  2.83e-02 7.64e-04  3.25e-02     4s
  30   3.40707620e+04  3.92970310e+04  2.51e-02 5.59e-04  2.72e-02     4s
  31   3.47335509e+04  3.89690718e+04  2.03e-02 4.14e-04  2.21e-02     4s
  32   3.49390331e+04  3.87152055e+04  1.86e-02 7.18e-04  1.97e-02     4s
  33   3.52376081e+04  3.83760445e+04  1.63e-02 5.20e-04  1.64e-02     4s
  34   3.54603073e+04  3.82923387e+04  1.48e-02 4.68e-04  1.48e-02     4s
  35   3.56936405e+04  3.82076359e+04  1.32e-02 4.15e-04  1.31e-02     4s
  36   3.61236396e+04  3.81122586e+04  1.02e-02 3.45e-04  1.04e-02     4s
  37   3.61728893e+04  3.80311661e+04  9.81e-03 2.98e-04  9.69e-03     4s
  38   3.62647465e+04  3.79745927e+04  9.13e-03 2.63e-04  8.91e-03     5s
  39   3.63930451e+04  3.79356764e+04  8.24e-03 2.39e-04  8.04e-03     5s
  40   3.64699801e+04  3.78356043e+04  7.65e-03 1.76e-04  7.12e-03     5s
  41   3.66065489e+04  3.78029037e+04  6.69e-03 1.99e-04  6.24e-03     5s
  42   3.68327986e+04  3.77747386e+04  5.16e-03 1.74e-04  4.91e-03     5s
  43   3.68879175e+04  3.77200849e+04  4.77e-03 1.27e-04  4.34e-03     5s
  44   3.69671557e+04  3.77041301e+04  4.23e-03 1.16e-04  3.84e-03     5s
  45   3.70035238e+04  3.76939456e+04  3.99e-03 1.04e-04  3.60e-03     5s
  46   3.71707877e+04  3.76779938e+04  2.80e-03 8.63e-05  2.64e-03     5s
  47   3.72138061e+04  3.76697747e+04  2.49e-03 7.79e-05  2.38e-03     5s
  48   3.72490332e+04  3.76471110e+04  2.25e-03 5.25e-05  2.08e-03     5s
  49   3.73830741e+04  3.76254661e+04  1.33e-03 5.02e-05  1.26e-03     5s
  50   3.74020450e+04  3.76074309e+04  1.20e-03 2.77e-05  1.07e-03     5s
  51   3.74602352e+04  3.75999627e+04  7.97e-04 1.68e-05  7.29e-04     5s
  52   3.75098815e+04  3.75932276e+04  4.69e-04 9.19e-06  4.35e-04     5s
  53   3.75399875e+04  3.75892701e+04  2.76e-04 4.34e-06  2.57e-04     5s
  54   3.75410141e+04  3.75889308e+04  2.69e-04 4.02e-06  2.50e-04     5s
  55   3.75491003e+04  3.75868152e+04  2.20e-04 2.09e-06  1.97e-04     5s
  56   3.75521651e+04  3.75866716e+04  2.00e-04 1.92e-06  1.80e-04     6s
  57   3.75679748e+04  3.75855007e+04  1.03e-04 4.69e-07  9.14e-05     6s
  58   3.75800952e+04  3.75851113e+04  2.66e-05 8.64e-07  2.61e-05     6s
  59   3.75829799e+04  3.75849086e+04  1.14e-05 1.15e-06  1.01e-05     6s
  60   3.75848376e+04  3.75848455e+04  9.76e-08 4.95e-08  4.11e-08     6s
  61   3.75848440e+04  3.75848440e+04  2.97e-10 3.31e-11  3.88e-11     6s

Barrier solved model in 61 iterations and 5.73 seconds (10.74 work units)
Optimal objective 3.75848440e+04


Root crossover log...

   90186 DPushes remaining with DInf 0.0000000e+00                 6s
       0 DPushes remaining with DInf 0.0000000e+00                 7s

    1967 PPushes remaining with PInf 8.5672187e-06                 8s
       0 PPushes remaining with PInf 0.0000000e+00                 8s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.2001017e+00      8s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   37528    3.7584844e+04   0.000000e+00   2.200102e+00      8s
   37531    3.7584844e+04   0.000000e+00   0.000000e+00      8s
   37531    3.7584844e+04   0.000000e+00   0.000000e+00      8s
Concurrent spin time: 0.33s

Solved with barrier

Root relaxation: objective 3.758484e+04, 37531 iterations, 5.88 seconds (12.23 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 37584.8440    0  289 -217726.04 37584.8440   117%     -    8s
H    0     0                    -167262.9601 37584.8440   122%     -    8s
H    0     0                    -157457.0466 37584.8440   124%     -    8s
H    0     0                    -81758.70741 37584.8440   146%     -    8s
H    0     0                    -80087.85174 37584.8440   147%     -    8s
H    0     0                    -79218.87999 37584.8440   147%     -    9s
H    0     0                    -79061.65198 37584.8440   148%     -    9s
H    0     0                    -78968.47886 37584.8440   148%     -    9s
H    0     0                    -73199.73205 37584.8440   151%     -    9s
H    0     0                    -55956.11094 37584.8440   167%     -    9s
H    0     0                    -37520.87294 37584.8440   200%     -    9s
H    0     0                    -37403.85879 37584.8440   200%     -    9s
H    0     0                    -37384.79633 37584.8440   201%     -    9s
H    0     0                    -35272.89439 37584.8440   207%     -   11s
H    0     0                    -35269.88046 37584.8440   207%     -   11s
H    0     0                    -35031.28379 37584.8440   207%     -   11s
H    0     0                    -34950.80306 30891.9729   188%     -   44s
H    0     0                    -10283.45809 30891.9729   400%     -   44s
H    0     0                    -10200.03782 30891.9729   403%     -   44s
H    0     0                    -9705.878073 30891.9729   418%     -   44s
H    0     0                    -9659.194902 30891.9729   420%     -   44s
H    0     0                    -9454.900201 30891.9729   427%     -   44s
H    0     0                    -9450.348470 30891.9729   427%     -   44s
H    0     0                    -9440.078745 30891.9729   427%     -   44s
H    0     0                    -9411.721277 30891.9729   428%     -   44s
     0     0 30645.1831    0  377 -9411.7213 30645.1831   426%     -   44s
H    0     0                    -8459.797621 30645.1831   462%     -   45s
H    0     0                    -8325.889113 30645.1831   468%     -   45s
H    0     0                    -8307.825985 30645.1831   469%     -   45s
H    0     0                    -8226.625165 30645.1831   473%     -   45s
H    0     0                    -8177.641641 30421.0135   472%     -   61s
H    0     0                    -8166.495077 30421.0135   473%     -   61s
H    0     0                    -8152.178514 30421.0135   473%     -   61s
     0     0 30261.2088    0  379 -8152.1785 30261.2088   471%     -   63s
H    0     0                    -8056.581882 30261.2088   476%     -   68s
H    0     0                    -8038.374573 30261.2088   476%     -   68s
     0     0 30261.2088    0  380 -8038.3746 30261.2088   476%     -   68s
     0     0 30261.2088    0  373 -8038.3746 30261.2088   476%     -   69s
     0     0 30261.2088    0  388 -8038.3746 30261.2088   476%     -   72s
     0     0 30261.2088    0  387 -8038.3746 30261.2088   476%     -   72s
     0     0 30261.2088    0  387 -8038.3746 30261.2088   476%     -   72s
H    0     0                    -4523.457776 27196.3197   701%     -  110s
H    0     0                    -4140.034124 27196.3197   757%     -  110s
H    0     0                    -2926.640967 27196.3197  1029%     -  110s
H    0     0                    -2882.592964 27196.3197  1043%     -  110s
H    0     0                    -2580.814124 27196.3197  1154%     -  110s
H    0     0                    -2459.505178 27196.3197  1206%     -  110s
H    0     0                    -2458.364342 27196.3197  1206%     -  110s
H    0     0                    -2454.020974 27196.3197  1208%     -  110s
H    0     0                    -2420.161573 27196.3197  1224%     -  110s
H    0     0                    -2384.964425 27196.3197  1240%     -  110s
H    0     0                    -2382.396171 27196.3197  1242%     -  110s
H    0     0                    -2366.860450 27196.3197  1249%     -  110s
H    0     0                    -2295.003409 27196.3197  1285%     -  110s
H    0     0                    -2292.564618 27196.3197  1286%     -  110s
H    0     0                    -2269.651375 27196.3197  1298%     -  110s
H    0     0                    -2211.363347 27196.3197  1330%     -  110s
H    0     0                    -2191.350689 27196.3197  1341%     -  110s
H    0     0                    -2162.183985 27196.3197  1358%     -  110s
     0     0 27196.3197    0  364 -2162.1840 27196.3197  1358%     -  110s
H    0     0                    -2137.816171 27196.2262  1372%     -  110s
H    0     0                    -2136.362040 27196.2262  1373%     -  110s
H    0     0                    -2132.418311 27196.2262  1375%     -  110s
H    0     0                    -2130.240724 27196.2262  1377%     -  110s
     0     0 26744.2940    0  393 -2130.2407 26744.2940  1355%     -  130s
H    0     0                     481.3202914 26558.0252  5418%     -  145s
H    0     0                     519.4358274 26558.0252  5013%     -  145s
H    0     0                     525.5304811 26558.0252  4954%     -  145s
H    0     0                     744.5582594 26558.0252  3467%     -  145s
     0     0 26558.0252    0  395  744.55826 26558.0252  3467%     -  145s
     0     0 26456.4347    0  423  744.55826 26456.4347  3453%     -  157s
     0     0 26300.8417    0  407  744.55826 26300.8417  3432%     -  169s
H    0     0                     754.1759785 26263.6360  3382%     -  176s
H    0     0                     756.3253282 26263.6360  3373%     -  176s
H    0     0                     758.0921588 26263.6360  3364%     -  176s
     0     0 26263.6360    0  411  758.09216 26263.6360  3364%     -  176s
     0     0 26097.3637    0  344  758.09216 26097.3637  3343%     -  188s
     0     0 25856.6846    0  375  758.09216 25856.6846  3311%     -  200s
     0     0 25834.7237    0  340  758.09216 25834.7237  3308%     -  204s
     0     0 25832.7994    0  343  758.09216 25832.7994  3308%     -  206s
     0     0 25832.2579    0  340  758.09216 25832.2579  3308%     -  207s
H    0     0                     784.7629029 25832.2579  3192%     -  218s
H    0     0                     987.1485110 25832.2579  2517%     -  218s
H    0     0                    1045.4419950 25832.2579  2371%     -  218s
H    0     0                    1050.3514253 25832.2579  2359%     -  218s
H    0     0                    1060.4923569 25832.2579  2336%     -  218s
H    0     0                    1072.7154869 25832.2579  2308%     -  218s
H    0     0                    1079.6919733 25832.2579  2293%     -  218s
H    0     0                    1080.6468157 23435.1030  2069%     -  268s
H    0     0                    1081.9806405 23435.1030  2066%     -  268s
     0     0 23435.1030    0  488 1081.98064 23435.1030  2066%     -  268s
H    0     0                    1260.1346712 23434.9751  1760%     -  268s
     0     0 23129.6805    0  474 1260.13467 23129.6805  1735%     -  288s
     0     0 22916.8786    0  493 1260.13467 22916.8786  1719%     -  299s
     0     0 22848.5236    0  485 1260.13467 22848.5236  1713%     -  307s
     0     0 22828.9539    0  479 1260.13467 22828.9539  1712%     -  312s
     0     0 22807.7162    0  488 1260.13467 22807.7162  1710%     -  318s
     0     0 22756.7885    0  484 1260.13467 22756.7885  1706%     -  328s
     0     0 22679.2665    0  504 1260.13467 22679.2665  1700%     -  336s
H    0     0                    1264.5567703 22668.3699  1693%     -  340s
H    0     0                    1271.3985377 22668.3699  1683%     -  340s
H    0     0                    1296.4457455 22668.3699  1649%     -  340s
H    0     0                    1297.9131492 22668.3699  1647%     -  340s
     0     0 22668.3699    0  502 1297.91315 22668.3699  1647%     -  340s
     0     0 22664.1075    0  495 1297.91315 22664.1075  1646%     -  342s
     0     0 22658.7439    0  499 1297.91315 22658.7439  1646%     -  344s
     0     0 22657.2965    0  502 1297.91315 22657.2965  1646%     -  345s
     0     0 21203.6776    0  468 1297.91315 21203.6776  1534%     -  407s
     0     0 20682.8377    0  454 1297.91315 20682.8377  1494%     -  426s
     0     0 20520.0789    0  414 1297.91315 20520.0789  1481%     -  437s
     0     0 20455.2722    0  491 1297.91315 20455.2722  1476%     -  445s
     0     0 20435.3399    0  484 1297.91315 20435.3399  1474%     -  450s
     0     0 20410.2867    0  445 1297.91315 20410.2867  1473%     -  455s
     0     0 20399.2246    0  448 1297.91315 20399.2246  1472%     -  458s
     0     0 20395.6859    0  501 1297.91315 20395.6859  1471%     -  461s
     0     0 20392.9268    0  499 1297.91315 20392.9268  1471%     -  463s
     0     0 20379.3435    0  445 1297.91315 20379.3435  1470%     -  467s
     0     0 20377.4439    0  446 1297.91315 20377.4439  1470%     -  468s
     0     0 19982.8499    0  530 1297.91315 19982.8499  1440%     -  489s
H    0     0                    1553.8175179 19981.9612  1186%     -  490s
     0     0 19875.8706    0  514 1553.81752 19875.8706  1179%     -  500s
     0     0 19854.2505    0  513 1553.81752 19854.2505  1178%     -  505s
     0     0 19776.4136    0  509 1553.81752 19776.4136  1173%     -  511s
     0     0 19732.0196    0  507 1553.81752 19732.0196  1170%     -  516s
     0     0 19716.8944    0  511 1553.81752 19716.8944  1169%     -  521s
     0     0 19701.9582    0  504 1553.81752 19701.9582  1168%     -  525s
     0     0 19690.9121    0  501 1553.81752 19690.9121  1167%     -  528s
     0     0 19682.9959    0  496 1553.81752 19682.9959  1167%     -  530s
     0     0 19666.8606    0  503 1553.81752 19666.8606  1166%     -  533s
     0     0 19650.1344    0  501 1553.81752 19650.1344  1165%     -  537s
     0     0 19646.6282    0  503 1553.81752 19646.6282  1164%     -  539s
     0     0 19644.2860    0  501 1553.81752 19644.2860  1164%     -  540s
     0     0 19409.4795    0  460 1553.81752 19409.4795  1149%     -  555s
H    0     0                    1578.5980084 19409.4662  1130%     -  558s
     0     0 19325.8411    0  469 1578.59801 19325.8411  1124%     -  565s
     0     0 19306.1943    0  457 1578.59801 19306.1943  1123%     -  569s
     0     0 19290.1452    0  463 1578.59801 19290.1452  1122%     -  572s
     0     0 19284.9229    0  464 1578.59801 19284.9229  1122%     -  573s
     0     0 19278.8664    0  453 1578.59801 19278.8664  1121%     -  575s
     0     0 19273.4469    0  476 1578.59801 19273.4469  1121%     -  577s
     0     0 19250.0573    0  449 1578.59801 19250.0573  1119%     -  580s
     0     0 19246.3982    0  497 1578.59801 19246.3982  1119%     -  581s
     0     0 19243.9645    0  465 1578.59801 19243.9645  1119%     -  582s
     0     0 19106.4557    0  477 1578.59801 19106.4557  1110%     -  596s
     0     0 19088.0810    0  481 1578.59801 19088.0810  1109%     -  602s
     0     0 19077.4129    0  473 1578.59801 19077.4129  1109%     -  605s
     0     0 19062.7321    0  488 1578.59801 19062.7321  1108%     -  608s
     0     0 19055.4611    0  491 1578.59801 19055.4611  1107%     -  610s
     0     0 19045.9710    0  495 1578.59801 19045.9710  1107%     -  613s
     0     0 19043.3984    0  492 1578.59801 19043.3984  1106%     -  614s
     0     0 18923.5079    0  521 1578.59801 18923.5079  1099%     -  625s
     0     0 18895.0017    0  530 1578.59801 18895.0017  1097%     -  632s
     0     0 18877.0049    0  537 1578.59801 18877.0049  1096%     -  635s
     0     0 18865.4775    0  524 1578.59801 18865.4775  1095%     -  638s
     0     0 18856.1984    0  518 1578.59801 18856.1984  1094%     -  640s
     0     0 18850.3812    0  525 1578.59801 18850.3812  1094%     -  642s
     0     0 18842.6345    0  533 1578.59801 18842.6345  1094%     -  643s
     0     0 18841.0567    0  531 1578.59801 18841.0567  1094%     -  644s
     0     0 18792.8039    0  471 1578.59801 18792.8039  1090%     -  652s
     0     0 18782.9396    0  471 1578.59801 18782.9396  1090%     -  656s
     0     0 18778.4193    0  472 1578.59801 18778.4193  1090%     -  658s
     0     0 18775.6408    0  474 1578.59801 18775.6408  1089%     -  659s
     0     0 18715.2714    0  477 1578.59801 18715.2714  1086%     -  667s
     0     0 18705.5317    0  498 1578.59801 18705.5317  1085%     -  682s
     0     0 18702.4948    0  499 1578.59801 18702.4948  1085%     -  684s
     0     0 18679.9467    0  465 1578.59801 18679.9467  1083%     -  691s
     0     0 18672.2500    0  505 1578.59801 18672.2500  1083%     -  695s
     0     0 18669.2479    0  475 1578.59801 18669.2479  1083%     -  697s
     0     0 18653.1167    0  476 1578.59801 18653.1167  1082%     -  702s
H    0     0                    1596.6664633 18653.0774  1068%     -  708s
H    0     0                    1625.6417949 18653.0774  1047%     -  708s
     0     0 18629.1481    0  488 1625.64179 18629.1481  1046%     -  714s
     0     0 18622.3658    0  492 1625.64179 18622.3658  1046%     -  716s
     0     0 18621.1937    0  502 1625.64179 18621.1937  1045%     -  717s
     0     0 18608.6923    0  483 1625.64179 18608.6923  1045%     -  722s
     0     0 18589.3984    0  483 1625.64179 18589.3984  1044%     -  726s
     0     0 18587.0579    0  487 1625.64179 18587.0579  1043%     -  728s
     0     0 18574.2527    0  480 1625.64179 18574.2527  1043%     -  732s
     0     0 18571.6047    0  477 1625.64179 18571.6047  1042%     -  738s
     0     0 18562.4211    0  477 1625.64179 18562.4211  1042%     -  742s
     0     0 18555.7957    0  482 1625.64179 18555.7957  1041%     -  746s
     0     0 18554.4138    0  481 1625.64179 18554.4138  1041%     -  748s
     0     0 18552.1599    0  478 1625.64179 18552.1599  1041%     -  751s
     0     0 18552.1225    0  478 1625.64179 18552.1225  1041%     -  754s
     0     2 18552.1089    0  478 1625.64179 18552.1089  1041%     -  941s
     1     4 18528.2441    1  457 1625.64179 18551.8579  1041%  3334  952s
     3     8 18469.1005    2  477 1625.64179 18527.7519  1040%  6704  984s
     7    15 18409.5679    3  506 1625.64179 18431.8448  1034% 11884 1008s
    14    30 18168.4270    4  516 1625.64179 18409.2396  1032% 12661 1030s
    29    45 17321.2760    5  490 1625.64179 18168.2331  1018% 19794 1100s
    44    77 16155.8988    6  470 1625.64179 18168.2331  1018% 18014 1697s
    76   206 16091.7924    7  430 1625.64179 17960.6060  1005% 20677 1770s
   205   287 15528.6293   10  358 1625.64179 17960.6060  1005% 12229 1794s
   286   318 15162.8788   11  445 1625.64179 17960.6060  1005% 10466 1813s
   317   344 15048.7698   12  458 1625.64179 17960.6060  1005% 10296 1833s
H  319   344                    1628.1619980 17960.6060  1003% 10252 1833s
H  323   344                    1630.7132085 17960.6060  1001% 10236 1833s
   343   410 14598.4688   14  395 1630.71321 17960.6060  1001% 10234 1855s
H  409   478                    1649.4902374 17960.6060   989%  9859 1874s
H  415   478                    2565.1577332 17960.6060   600%  9873 1874s
   477   555 13982.9346   20  447 2565.15773 17960.6060   600%  9391 1892s
   559   616 13731.6805   22  437 2565.15773 17960.6060   600%  8926 1908s
H  563   616                    2571.7670247 17960.6060   598%  8902 1908s
H  596   616                    2766.4392973 17960.6060   549%  8845 1908s
H  624   616                    2904.7700294 17960.6060   518%  8669 1908s
   626   668 13697.2525   23  457 2904.77003 17960.6060   518%  8661 1924s
   690   732 13286.8066   26  396 2904.77003 17960.6060   518%  8712 1939s
   764   804 13103.1795   28  428 2904.77003 17960.6060   518%  8562 1956s
   844   830 12945.7573   31  461 2904.77003 17960.6060   518%  8401 1972s
H  854   830                    3164.0934938 17960.6060   468%  8411 1972s
   874   906 11254.7812   32  378 3164.09349 17679.7542   459%  8438 1988s
   966   932 8702.93824   33  401 3164.09349 17679.7542   459%  8318 2003s
   998   948 8566.38763   34  306 3164.09349 17679.7542   459%  8356 2019s
H 1010   948                    3245.2062139 17679.7542   445%  8353 2019s
  1036  1002 8561.52936   35  308 3245.20621 17679.7542   445%  8329 2037s
  1143  1093 8306.58647   40  348 3245.20621 17679.7542   445%  8112 2056s
  1252  1187 8066.29286   44  275 3245.20621 17679.7542   445%  7892 2074s
  1388  1251 7752.88766   49  275 3245.20621 17679.7542   445%  7607 2093s
  1510  1331 7101.02123   57  224 3245.20621 17523.9408   440%  7419 2117s
  1628  1433 6520.52260   67  180 3245.20621 17523.9408   440%  7292 2138s
  1755  1535 6138.55559   78  205 3245.20621 17523.9408   440%  7190 2157s
  1890  1628 5594.08410   89  171 3245.20621 17523.9408   440%  7099 2177s
  2040  1658 infeasible  100      3245.20621 17523.9408   440%  6964 2199s
  2084  1697 infeasible  100      3245.20621 17523.9408   440%  7014 2223s
H 2091  1697                    3683.6348322 17523.9408   376%  7013 2223s
  2148  1763 infeasible  101      3683.63483 17523.9408   376%  6994 2247s
  2275  1840 16106.2921   13  481 3683.63483 17523.9408   376%  6963 2270s
  2413  1950 13220.7649   14  422 3683.63483 17523.9408   376%  6945 2297s
  2566  2049 7639.87217   15  321 3683.63483 17523.9408   376%  6918 2324s
  2705  2194 6240.29491   17  302 3683.63483 17523.9408   376%  6922 2348s
  2884  2357 5883.68475   20  296 3683.63483 17523.9408   376%  6877 2375s
H 3127  2403                    3896.6717218 17523.9408   350%  6702 2401s
H 3153  2317                    4238.0937650 17523.9408   313%  6680 2401s
H 3197  2298                    4282.7216462 17523.9408   309%  6681 2401s
  3254  2391 infeasible   23      4282.72165 17523.9408   309%  6666 2433s
  3470  2464 infeasible   31      4282.72165 16457.7245   284%  6589 2466s
  3643  2481 14320.7342    6  353 4282.72165 16457.7245   284%  6581 2499s
H 3645  2326                    4737.8908448 16457.7245   247%  6584 2499s
H 3651  2145                    5220.2434734 16418.0740   215%  6596 2499s
H 3651  2102                    5366.0938635 16418.0740   206%  6596 2499s
H 3655  2063                    5468.0813794 16418.0740   200%  6598 2499s
H 3657  1943                    5775.6187264 16418.0740   184%  6601 2499s
  3695  2005 14123.9467    7  371 5775.61873 16418.0740   184%  6650 2532s
H 3818  2091                    5776.0978643 16418.0740   184%  6746 2567s
H 3820  2069                    5838.2722167 16418.0740   181%  6754 2567s
H 3865  2055                    5862.8800090 16418.0740   180%  6789 2567s
H 3870  1981                    6121.2638716 16418.0740   168%  6790 2567s
  3932  2092 10888.9109   10  350 6121.26387 16418.0740   168%  6866 2601s
H 4083  2092                    6122.0397888 16278.5193   166%  6932 2634s
H 4083  2089                    6127.6172063 16278.5193   166%  6932 2657s
H 4083  2071                    6180.6390810 16278.5193   163%  6932 2678s
  4084  2072 11739.4139   11  478 6180.63908 16278.5193   163%  6931 3031s
  4086  2073 8316.03863   60  243 6180.63908 16278.5193   163%  6927 3041s
  4087  2074 8190.10380   44  406 6180.63908 16278.5193   163%  6926 3112s
  4088  2075 11240.7120   20  430 6180.63908 16278.5193   163%  6924 3161s
  4089  2075 14968.0968   10  501 6180.63908 16278.5193   163%  6922 3197s
  4090  2076 8065.88504   45  451 6180.63908 16278.5193   163%  6921 3219s
  4091  2077 6208.04060   10  530 6180.63908 16278.5193   163%  6919 3237s
  4092  2077 6751.63041   62  454 6180.63908 16278.5193   163%  6917 3256s
  4093  2078 12184.0142   18  467 6180.63908 16278.5193   163%  6915 3275s
  4094  2079 7054.31948   21  468 6180.63908 16278.5193   163%  6914 3287s
  4095  2079 14417.4253    9  462 6180.63908 16278.5193   163%  6912 3295s
  4096  2080 11993.7928   15  479 6180.63908 16278.5193   163%  6910 3304s
  4097  2081 8569.43392   28  473 6180.63908 16278.5193   163%  6909 3311s
  4098  2081 11322.2278   15  464 6180.63908 16278.5193   163%  6907 3320s
  4100  2083 13418.5810   19  468 6180.63908 16278.5193   163%  6904 3329s
  4101  2083 7831.45713   51  484 6180.63908 16278.5193   163%  6902 3346s
  4102  2084 15209.7160   12  471 6180.63908 16278.5193   163%  6900 3356s
  4103  2085 11359.0877   15  498 6180.63908 16278.5193   163%  6899 3360s
  4104  2085 15468.1316    9  532 6180.63908 16278.5193   163%  6897 3365s
  4105  2086 14520.9766   13  533 6180.63908 16278.5193   163%  6895 3370s
  4106  2087 14333.3090    8  573 6180.63908 16278.5193   163%  6894 3383s
H 4106  1982                    6260.5441644 16278.5193   160%  6894 3391s
  4108  1983 10509.6400   18  514 6260.54416 16278.5193   160%  6890 3398s
  4109  1984 7010.82068   25  572 6260.54416 16278.5193   160%  6889 3405s
  4110  1984 12956.9616   25  527 6260.54416 16278.5193   160%  6887 3418s
  4111  1985 12528.3511   18  549 6260.54416 16278.5193   160%  6885 3424s
  4112  1986 6576.71677   60  566 6260.54416 16278.5193   160%  6884 3428s
  4113  1986 14504.2132   15  542 6260.54416 16278.5193   160%  6882 3432s
  4114  1987 13393.1632   24  499 6260.54416 16278.5193   160%  6880 3435s
  4115  1988 14995.4887    7  499 6260.54416 16278.5193   160%  6879 3440s
  4116  1988 9218.70662   15  529 6260.54416 16278.5193   160%  6877 3455s
  4117  1989 7568.87877   13  580 6260.54416 16278.5193   160%  6875 3463s
  4118  1990 14511.6650   15  577 6260.54416 16278.5193   160%  6874 3468s
  4119  1990 12434.6379   23  540 6260.54416 16278.5193   160%  6872 3474s
  4120  1991 12628.7506   11  481 6260.54416 16278.5193   160%  6870 3486s
  4121  1992 7857.24512   48  503 6260.54416 16278.5193   160%  6869 3492s
  4122  1992 6562.35142   37  598 6260.54416 16278.5193   160%  6867 3497s
  4123  1993 10079.6889   28  560 6260.54416 16278.5193   160%  6865 3503s
  4124  1994 6451.57977   35  547 6260.54416 16278.5193   160%  6864 3518s
  4125  1994 14786.6037   13  501 6260.54416 16278.5193   160%  6862 3524s
  4126  1995 7047.91439   64  499 6260.54416 16278.5193   160%  6860 3529s
  4127  1996 8240.88880   18  501 6260.54416 16278.5193   160%  6859 3532s
  4128  1996 7147.65506   61  506 6260.54416 16278.5193   160%  6857 3542s
  4129  1997 8646.55524   20  521 6260.54416 16278.5193   160%  6855 3546s
  4130  1998 14073.9031   10  565 6260.54416 16278.5193   160%  6854 3553s
  4131  1998 8740.57189   24  496 6260.54416 16278.5193   160%  6852 3566s
  4132  1999 9402.08184   18  512 6260.54416 16278.5193   160%  6850 3571s
  4133  2000 15037.4766   11  554 6260.54416 16278.5193   160%  6849 3578s
  4134  2000 7462.86224   37  511 6260.54416 16278.5193   160%  6847 3583s
  4135  2001 12513.3732   27  509 6260.54416 16278.5193   160%  6845 3588s

Cutting planes:
  Learned: 1
  Gomory: 13
  Implied bound: 24
  Projected implied bound: 279
  MIR: 888
  Mixing: 3
  Flow cover: 1198
  RLT: 37
  Relax-and-lift: 192

Explored 4135 nodes (29544196 simplex iterations) in 3600.11 seconds (8761.60 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 6260.54 6180.64 6127.62 ... 5366.09

Time limit reached
Best objective 6.260544164439e+03, best bound 1.627851931235e+04, gap 160.0176%
  WARNING: Time limit reached. Using best solution found (gap: 160.02%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.20s
  Master Objective (UB) = 6260.54, θ = 146522.25
  Upper Bound (UB) = 6260.54

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 146522.25
  [DEBUG]   ✓ Scenario 0: θ = 146522.25 ≤ Q = 146522.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 146522.25 ≤ Q = 146522.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 146522.25 ≤ Q = 146522.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 146522.25 ≤ Q = 146522.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 146522.25 ≤ Q = 146522.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 146522.25 ≤ Q = 146522.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 146522.25 ≤ Q = 146522.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 146522.25 ≤ Q = 146522.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 146522.25 ≤ Q = 146522.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 146522.25 ≤ Q = 146522.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 146522.25 ≤ Q = 146522.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 146522.25 ≤ Q = 146522.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 146522.25 ≤ Q = 146522.25 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 13] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x519a97dd
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x519a97dd
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.188072e+13
Presolve removed 2613 rows and 1904 columns
Presolve time: 0.00s
Presolved: 480 rows, 485 columns, 1318 nonzeros
Found heuristic solution: objective 5508798.8242
Variable types: 329 continuous, 156 integer (156 binary)

Root relaxation: objective -1.447322e+05, 229 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -144732.25    0  121 5508798.82 -144732.25   103%     -    0s
H    0     0                    -111194.5412 -144732.25  30.2%     -    0s
H    0     0                    -112110.2893 -144732.25  29.1%     -    0s
     0     0 -119251.77    0   58 -112110.29 -119251.77  6.37%     -    0s
H    0     0                    -116543.1993 -119193.39  2.27%     -    0s
H    0     0                    -116915.1711 -119193.39  1.95%     -    0s
H    0     0                    -117373.0967 -119193.39  1.55%     -    0s
H    0     0                    -117745.0685 -119193.39  1.23%     -    0s
     0     0 -118570.06    0   55 -117745.07 -118570.06  0.70%     -    0s
     0     0 -118390.78    0   53 -117745.07 -118390.78  0.55%     -    0s
H    0     0                    -117762.1909 -118390.78  0.53%     -    0s
H    0     0                    -117778.0997 -118148.74  0.31%     -    0s
     0     0 -118148.74    0   28 -117778.10 -118148.74  0.31%     -    0s
     0     0 -118065.58    0   26 -117778.10 -118065.58  0.24%     -    0s
     0     0 -118027.39    0   27 -117778.10 -118027.39  0.21%     -    0s
     0     0 -118019.27    0   27 -117778.10 -118019.27  0.20%     -    0s
H    0     0                    -117828.3661 -118019.27  0.16%     -    0s
     0     0 -118019.27    0   40 -117828.37 -118019.27  0.16%     -    0s
     0     0 -118019.27    0   22 -117828.37 -118019.27  0.16%     -    0s
     0     0 -118014.39    0   22 -117828.37 -118014.39  0.16%     -    0s
     0     0 -118004.15    0   22 -117828.37 -118004.15  0.15%     -    0s
     0     0 -117969.81    0   20 -117828.37 -117969.81  0.12%     -    0s
     0     0 -117918.37    0    8 -117828.37 -117918.37  0.08%     -    0s
     0     0 -117883.70    0    7 -117828.37 -117883.70  0.05%     -    0s
     0     0 -117872.88    0    7 -117828.37 -117872.88  0.04%     -    0s
     0     0 -117852.22    0    5 -117828.37 -117852.22  0.02%     -    0s
H    0     0                    -117829.6610 -117852.22  0.02%     -    0s
     0     0 -117852.22    0    6 -117829.66 -117852.22  0.02%     -    0s
H    0     0                    -117851.6090 -117852.22  0.00%     -    0s

Explored 1 nodes (793 simplex iterations) in 0.06 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -117852 -117830 -117828 ... -111195

Optimal solution found (tolerance 1.00e-04)
Best objective -1.178516089870e+05, best bound -1.178522227309e+05, gap 0.0005%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 141766.94
  Scenario: 21 demand increases, 38 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -117851.61
  [DEBUG]   S×d_nominal = 259618.55
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 259618.55 + -117851.61 = 141766.94
  [DEBUG]   Current θ from Master = 146522.25
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4755.31 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 1505.24
  Lower Bound (LB) = 6348.39
  Gap (UB-LB) = -87.8457, Absolute Gap = 87.8457, Relative Gap = -0.014032
  *** CONVERGED (small negative gap: -87.85 within tolerance ε=200) ***
  Note: Negative gap likely due to numerical precision or solver tolerance

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 13
Total Time: 23249.05s
Converged: True
Final Lower Bound: 6348.3898
Final Upper Bound: 6260.5442
Final Gap: -87.845666
Number of Critical Scenarios: 13
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [1] (1/3)
Product 1 Plants: [2] (1/3)
Product 2 Plants: [2] (1/3)
Total Plant Openings: 3
DCs Opened: [1, 4, 5, 8] (4/10)
Active Routes (Plant→DC): 10
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 0 customers  Mode 1: 2 customers  Mode 2: 48 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 13
Start Time: 2026-01-04 12:30:56
End Time: 2026-01-04 18:58:26
Total Time: 23249.05s
Optimal Value: 6348.39
Lower Bound: 6348.39
Upper Bound: 6260.54
Gap: -87.845666
Plants Opened: {0: [1], 1: [2], 2: [2]} (3 plants)
DCs Opened: [1, 4, 5, 8] (4 DCs)
================================================================================

Results saved to: result/DH_single_full_seed19_MD_gamma20_20260104_185826.csv

Total Execution Time: 23250.05 seconds
End Time: 2026-01-04 18:58:27

All tasks completed successfully!

