
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 20
DI Scenario: HD
Start Time: 2026-01-04 12:30:56
================================================================================
Loading data from data/DH_data_full_seed20.pkl...

Applying DI scenario: HD
DI values:
  Product 0: ['1.000', '1.452', '2.108'] (k=0.920)
  Product 1: ['1.000', '1.340', '1.796'] (k=0.722)
  Product 2: ['1.000', '1.438', '2.069'] (k=0.896)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=943, max=1737
  DC capacity (MC): min=437, max=799

Demand Structure (s_rk matrix):
  Total customer-product pairs: 88/150 (41.3% sparse)
  Average products per customer: 1.76

Demand (only non-zero entries):
  Nominal (μ): min=8.03, max=34.72, count=88
  Deviation (μ̂): min=4.13, max=9.94

Costs:
  Plant fixed cost: min=6305, max=9991
  DC fixed cost: min=3078, max=5751
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.452', '2.108'] (k=0.920)
    Product 1: ['1.000', '1.340', '1.796'] (k=0.722)
    Product 2: ['1.000', '1.438', '2.069'] (k=0.896)
  MD:
    Product 0: ['1.000', '1.194', '1.425'] (k=0.437)
    Product 1: ['1.000', '1.149', '1.319'] (k=0.342)
    Product 2: ['1.000', '1.168', '1.363'] (k=0.382)
  LD:
    Product 0: ['1.000', '1.028', '1.057'] (k=0.068)
    Product 1: ['1.000', '1.119', '1.252'] (k=0.277)
    Product 2: ['1.000', '1.010', '1.020'] (k=0.024)
  Mixed:
    Product 0: ['1.000', '1.452', '2.108'] (k=0.920)
    Product 1: ['1.000', '1.149', '1.319'] (k=0.342)
    Product 2: ['1.000', '1.010', '1.020'] (k=0.024)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48774 nonzeros
Model fingerprint: 0x2e85a09e
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11543 rows and 2543 columns
Presolve time: 0.08s
Presolved: 5130 rows, 5957 columns, 35527 nonzeros
Variable types: 3698 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -263036.2666
Found heuristic solution: objective -207781.0263

Root relaxation: objective 1.901656e+05, 7591 iterations, 0.43 seconds (0.70 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 190165.569    0  552 -207781.03 190165.569   192%     -    0s
H    0     0                    -198004.2549 190165.569   196%     -    0s
     0     0 163317.904    0  745 -198004.25 163317.904   182%     -    1s
     0     0 162629.366    0  756 -198004.25 162629.366   182%     -    1s
     0     0 162470.611    0  758 -198004.25 162470.611   182%     -    1s
     0     0 162420.581    0  757 -198004.25 162420.581   182%     -    1s
     0     0 162420.215    0  757 -198004.25 162420.215   182%     -    1s
     0     0 139575.134    0  619 -198004.25 139575.134   170%     -    2s
H    0     0                    -191281.4732 139000.132   173%     -    3s
     0     0 139000.132    0  616 -191281.47 139000.132   173%     -    3s
     0     0 138889.266    0  622 -191281.47 138889.266   173%     -    3s
     0     0 138873.102    0  628 -191281.47 138873.102   173%     -    3s
     0     0 138868.669    0  633 -191281.47 138868.669   173%     -    3s
H    0     0                    -191213.6936 121174.602   163%     -    4s
H    0     0                    -133651.0738 121174.602   191%     -    4s
H    0     0                    -132472.6761 121174.602   191%     -    4s
H    0     0                    -131519.4729 121174.602   192%     -    4s
H    0     0                    -130279.0340 121174.602   193%     -    4s
H    0     0                    -128448.4089 121174.602   194%     -    4s
H    0     0                    -125665.3527 121174.602   196%     -    4s
     0     0 121174.602    0  539 -125665.35 121174.602   196%     -    4s
H    0     0                    -91734.90960 119967.353   231%     -    4s
H    0     0                    -83400.74177 119967.353   244%     -    4s
H    0     0                    48628.513426 119967.353   147%     -    4s
H    0     0                    50006.741019 119967.353   140%     -    4s
     0     0 119967.353    0  555 50006.7410 119967.353   140%     -    4s
     0     0 119725.824    0  588 50006.7410 119725.824   139%     -    4s
     0     0 119696.601    0  582 50006.7410 119696.601   139%     -    4s
     0     0 119685.338    0  593 50006.7410 119685.338   139%     -    4s
H    0     0                    50632.842083 114174.990   125%     -    6s
     0     0 114174.990    0  520 50632.8421 114174.990   125%     -    6s
H    0     0                    51064.472701 113052.771   121%     -    6s
H    0     0                    51132.050711 113052.771   121%     -    6s
     0     0 113052.771    0  552 51132.0507 113052.771   121%     -    6s
H    0     0                    51496.945681 112812.272   119%     -    6s
H    0     0                    51667.267826 112812.272   118%     -    6s
H    0     0                    52679.065462 112812.272   114%     -    6s
H    0     0                    52846.660229 112812.272   113%     -    6s
H    0     0                    53219.954023 112812.272   112%     -    6s
H    0     0                    54640.084917 112812.272   106%     -    6s
     0     0 112812.272    0  620 54640.0849 112812.272   106%     -    6s
H    0     0                    54711.346578 112730.377   106%     -    6s
H    0     0                    55183.333307 112730.377   104%     -    6s
H    0     0                    55200.672466 112730.377   104%     -    6s
H    0     0                    55237.818906 112730.377   104%     -    6s
     0     0 112730.377    0  576 55237.8189 112730.377   104%     -    6s
     0     0 112723.457    0  584 55237.8189 112723.457   104%     -    6s
H    0     0                    55415.841851 112723.457   103%     -    6s
H    0     0                    55591.215834 111113.459   100%     -    7s
H    0     0                    55747.983912 111113.459  99.3%     -    7s
H    0     0                    56213.751201 111113.459  97.7%     -    7s
     0     0 111113.459    0  501 56213.7512 111113.459  97.7%     -    7s
H    0     0                    56227.489136 110633.867  96.8%     -    7s
H    0     0                    56228.278437 110633.867  96.8%     -    7s
H    0     0                    56801.006332 110633.867  94.8%     -    7s
     0     0 110633.867    0  507 56801.0063 110633.867  94.8%     -    7s
H    0     0                    56825.468238 110497.162  94.5%     -    7s
H    0     0                    56954.805593 110497.162  94.0%     -    7s
H    0     0                    57187.264895 110497.162  93.2%     -    7s
     0     0 110497.162    0  686 57187.2649 110497.162  93.2%     -    7s
     0     0 110431.437    0  615 57187.2649 110431.437  93.1%     -    7s
     0     0 110413.572    0  631 57187.2649 110413.572  93.1%     -    8s
     0     0 109372.864    0  629 57187.2649 109372.864  91.3%     -    8s
     0     0 109124.670    0  632 57187.2649 109124.670  90.8%     -    9s
     0     0 108994.095    0  534 57187.2649 108994.095  90.6%     -    9s
     0     0 108943.910    0  550 57187.2649 108943.910  90.5%     -    9s
     0     0 108925.928    0  570 57187.2649 108925.928  90.5%     -    9s
H    0     0                    57373.122790 108437.075  89.0%     -   10s
H    0     0                    57730.926003 108437.075  87.8%     -   10s
H    0     0                    58156.223788 108437.075  86.5%     -   10s
H    0     0                    59938.638209 108437.075  80.9%     -   10s
H    0     0                    60133.969802 108437.075  80.3%     -   10s
H    0     0                    60503.046598 108437.075  79.2%     -   10s
     0     0 108437.075    0  654 60503.0466 108437.075  79.2%     -   10s
     0     0 108221.949    0  692 60503.0466 108221.949  78.9%     -   10s
     0     0 108174.039    0  695 60503.0466 108174.039  78.8%     -   10s
     0     0 107602.210    0  691 60503.0466 107602.210  77.8%     -   11s
H    0     0                    60974.186742 107481.032  76.3%     -   11s
H    0     0                    61023.176112 107481.032  76.1%     -   11s
     0     0 107481.032    0  777 61023.1761 107481.032  76.1%     -   11s
     0     0 107444.072    0  815 61023.1761 107444.072  76.1%     -   11s
     0     0 107134.687    0  638 61023.1761 107134.687  75.6%     -   12s
     0     0 107134.231    0  638 61023.1761 107134.231  75.6%     -   12s
     0     2 107134.231    0  638 61023.1761 107134.231  75.6%     -   13s
     7    16 106463.855    3  607 61023.1761 106994.323  75.3%  1453   15s
H   32    64                    61619.358741 105920.498  71.9%  2228   18s
H   57    64                    62058.660473 105724.365  70.4%  1992   18s
    95   185 104307.062    7  530 62058.6605 105675.911  70.3%  1642   20s
H  107   185                    63599.691249 105675.911  66.2%  1523   20s
   362   399 102064.951   12  452 63599.6912 105675.911  66.2%  1036   25s
H  366   399                    67249.318795 105675.911  57.1%  1036   25s
H  378   399                    72642.602749 105675.911  45.5%  1044   25s
H  402   491                    72668.866437 105675.911  45.4%  1060   26s
H  412   491                    73702.336764 105675.911  43.4%  1063   26s
H  431   491                    74295.160153 105675.911  42.2%  1057   26s
H  575   669                    74989.190106 105675.911  40.9%   941   28s
   760   854 95917.1219   15  356 74989.1901 105675.911  40.9%   849   30s
H 1008  1036                    76825.554025 105655.334  37.5%   736   31s
H 1184  1265                    77168.822829 105655.334  36.9%   670   32s
H 1187  1265                    77973.116512 105655.334  35.5%   669   32s
H 1190  1265                    78505.880503 105655.334  34.6%   668   32s
H 1198  1265                    79094.296662 105655.334  33.6%   665   32s
  1660  1706 93011.1774   25  346 79094.2967 105646.455  33.6%   596   35s
H 2238  2144                    79116.942067 105437.166  33.3%   513   37s
H 2254  2139                    79388.527704 105437.166  32.8%   510   37s
  2933  2956 86593.0211   46  268 79388.5277 105437.166  32.8%   435   40s
H 3282  3037                    79542.701542 105437.166  32.6%   408   41s
H 3392  3065                    80027.294780 105437.166  31.8%   406   43s
H 3693  3181                    80403.488914 105377.380  31.1%   402   49s
  3694  3182 88251.7923   25  638 80403.4889 105377.380  31.1%   402   53s
  3706  3190 86961.6863   54  347 80403.4889 101636.271  26.4%   401   55s
  3749  3236 88407.1950   16  328 80403.4889 95420.0936  18.7%   403   60s
H 4114  3239                    80447.215366 93456.3797  16.2%   398   63s
H 4439  3137                    80649.334567 93342.2107  15.7%   386   64s
  4500  3150     cutoff   28      80649.3346 93342.2107  15.7%   384   65s
H 4777  3011                    81098.379349 92435.7967  14.0%   374   66s
  6022  2979 84729.1704   26  179 81098.3793 90382.9184  11.4%   338   70s
H 6900  2751                    81235.129601 88923.7972  9.46%   319   73s
H 7379  2546                    81276.771358 88742.5365  9.19%   310   73s
H 7782  2278                    81377.015777 88281.6456  8.48%   304   74s
  8105  2183 infeasible   24      81377.0158 88053.9834  8.20%   300   75s
H 8610  1943                    82019.133686 88024.4880  7.32%   295   79s
  8653  1866     cutoff   30      82019.1337 88024.4880  7.32%   294   80s

Cutting planes:
  Gomory: 10
  Lift-and-project: 4
  Implied bound: 25
  Projected implied bound: 20
  MIR: 236
  Mixing: 3
  Flow cover: 343
  RLT: 22
  Relax-and-lift: 58

Explored 13645 nodes (3280655 simplex iterations) in 83.94 seconds (186.33 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 82019.1 81377 81276.8 ... 79542.7

Optimal solution found (tolerance 1.00e-04)
Best objective 8.201913368591e+04, best bound 8.201913368591e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 83.94s
  Master Objective (UB) = 82019.13, θ = 280524.89
  Upper Bound (UB) = 82019.13

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 280524.89
  [DEBUG]   ✓ Scenario 0: θ = 280524.89 ≤ Q = 280524.89 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x604347e3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x604347e3
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-01, 2e+02]
Found heuristic solution: objective 1.288126e+13
Presolve removed 2550 rows and 1840 columns
Presolve time: 0.00s
Presolved: 543 rows, 549 columns, 1535 nonzeros
Found heuristic solution: objective 6686480.4378
Variable types: 373 continuous, 176 integer (176 binary)

Root relaxation: objective -1.745948e+05, 248 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -174594.85    0  123 6686480.44 -174594.85   103%     -    0s
H    0     0                    -138130.0625 -174594.85  26.4%     -    0s
H    0     0                    -139787.6893 -174594.85  24.9%     -    0s
*    0     0               0    -141961.6033 -141961.60  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 211

Explored 1 nodes (372 simplex iterations) in 0.01 seconds (0.02 work units)
Thread count was 32 (of 64 available processors)

Solution count 5: -141962 -139788 -138130 ... 1.28813e+13
No other solutions better than -141962

Optimal solution found (tolerance 1.00e-04)
Best objective -1.419616032740e+05, best bound -1.419616032740e+05, gap 0.0000%
  Subproblem solved in 0.03s
  Worst-case operational profit (Z_SP) = 247179.66
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -141961.60
  [DEBUG]   S×d_nominal = 389141.26
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 389141.26 + -141961.60 = 247179.66
  [DEBUG]   Current θ from Master = 280524.89
  [DEBUG]   ⚠️  Z_SP ≤ θ by 33345.23 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 48673.91
  Lower Bound (LB) = 48673.91
  Gap (UB-LB) = 33345.2254, Absolute Gap = 33345.2254, Relative Gap = 0.406554
  Not converged yet (gap = 33345.23 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 92029 nonzeros
Model fingerprint: 0x133dda92
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 48673.9 (0.01s)
MIP start from previous solve produced solution with objective 48673.9 (0.01s)
Loaded MIP start from previous solve with objective 48673.9

Presolve removed 12525 rows and 5084 columns
Presolve time: 0.31s
Presolved: 19438 rows, 9656 columns, 107838 nonzeros
Variable types: 7397 continuous, 2259 integer (2259 binary)

Root relaxation: objective 1.031787e+05, 8524 iterations, 0.84 seconds (1.76 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 103178.726    0  282 48673.9082 103178.726   112%     -    1s
H    0     0                    49381.330646 103178.726   109%     -    1s
H    0     0                    49446.633662 103178.726   109%     -    1s
H    0     0                    49630.356430 103178.726   108%     -    1s
H    0     0                    50449.442584 103178.726   105%     -    1s
H    0     0                    50478.150962 103178.726   104%     -    1s
     0     0 94695.5100    0  284 50478.1510 94695.5100  87.6%     -    2s
H    0     0                    50667.279400 94673.3364  86.9%     -    2s
     0     0 94437.2372    0  294 50667.2794 94437.2372  86.4%     -    2s
     0     0 94436.5443    0  290 50667.2794 94436.5443  86.4%     -    2s
     0     0 88911.5902    0  343 50667.2794 88911.5902  75.5%     -    3s
     0     0 88054.8903    0  375 50667.2794 88054.8903  73.8%     -    4s
     0     0 87837.0082    0  397 50667.2794 87837.0082  73.4%     -    4s
     0     0 87791.5210    0  397 50667.2794 87791.5210  73.3%     -    4s
     0     0 87748.9592    0  400 50667.2794 87748.9592  73.2%     -    4s
     0     0 87747.0779    0  405 50667.2794 87747.0779  73.2%     -    4s
H    0     0                    52761.583240 87747.0779  66.3%     -    5s
H    0     0                    53359.830869 87747.0779  64.4%     -    5s
H    0     0                    53497.315131 87747.0779  64.0%     -    5s
H    0     0                    57128.032731 87747.0779  53.6%     -    5s
H    0     0                    57363.572069 87747.0779  53.0%     -    5s
H    0     0                    57537.183319 87747.0779  52.5%     -    5s
     0     0 84230.1873    0  355 57537.1833 84230.1873  46.4%     -    5s
H    0     0                    57672.661005 84229.1441  46.0%     -    6s
H    0     0                    57747.765101 84229.1441  45.9%     -    6s
     0     0 83549.6522    0  377 57747.7651 83549.6522  44.7%     -    6s
     0     0 83318.8299    0  391 57747.7651 83318.8299  44.3%     -    7s
     0     0 83270.8359    0  395 57747.7651 83270.8359  44.2%     -    7s
     0     0 83233.9770    0  387 57747.7651 83233.9770  44.1%     -    7s
     0     0 83230.4555    0  392 57747.7651 83230.4555  44.1%     -    7s
H    0     0                    57760.259193 83230.4555  44.1%     -    8s
H    0     0                    58245.245642 83230.4555  42.9%     -    8s
     0     0 80942.7439    0  397 58245.2456 80942.7439  39.0%     -    9s
     0     0 80681.0511    0  427 58245.2456 80681.0511  38.5%     -   10s
     0     0 80565.7852    0  437 58245.2456 80565.7852  38.3%     -   10s
     0     0 80530.8156    0  431 58245.2456 80530.8156  38.3%     -   10s
     0     0 80527.2336    0  438 58245.2456 80527.2336  38.3%     -   10s
     0     0 79837.7690    0  375 58245.2456 79837.7690  37.1%     -   11s
     0     0 79638.1164    0  426 58245.2456 79638.1164  36.7%     -   12s
     0     0 79508.5021    0  416 58245.2456 79508.5021  36.5%     -   12s
     0     0 79395.9655    0  489 58245.2456 79395.9655  36.3%     -   12s
     0     0 79372.9395    0  435 58245.2456 79372.9395  36.3%     -   13s
     0     0 79368.6802    0  445 58245.2456 79368.6802  36.3%     -   13s
     0     0 79088.1051    0  472 58245.2456 79088.1051  35.8%     -   14s
     0     0 78990.6450    0  426 58245.2456 78990.6450  35.6%     -   14s
     0     0 78952.0945    0  503 58245.2456 78952.0945  35.6%     -   15s
     0     0 78945.1118    0  393 58245.2456 78945.1118  35.5%     -   15s
     0     0 78943.3889    0  494 58245.2456 78943.3889  35.5%     -   15s
     0     0 78868.3963    0  384 58245.2456 78868.3963  35.4%     -   15s
     0     0 78815.8517    0  436 58245.2456 78815.8517  35.3%     -   16s
     0     0 78804.0164    0  382 58245.2456 78804.0164  35.3%     -   16s
     0     0 78801.5825    0  390 58245.2456 78801.5825  35.3%     -   16s
     0     0 78774.5941    0  383 58245.2456 78774.5941  35.2%     -   16s
H    0     0                    58635.018595 78773.9122  34.3%     -   17s
     0     0 78765.8099    0  389 58635.0186 78765.8099  34.3%     -   17s
     0     0 78763.6179    0  384 58635.0186 78763.6179  34.3%     -   17s
     0     0 78745.6370    0  380 58635.0186 78745.6370  34.3%     -   17s
     0     0 78730.8512    0  394 58635.0186 78730.8512  34.3%     -   18s
     0     0 78729.1619    0  441 58635.0186 78729.1619  34.3%     -   18s
     0     0 78722.3223    0  373 58635.0186 78722.3223  34.3%     -   18s
     0     0 78722.2127    0  373 58635.0186 78722.2127  34.3%     -   18s
     0     2 78722.1628    0  373 58635.0186 78722.1628  34.3%     -   22s
     7    16 77848.7573    3  492 58635.0186 78219.3838  33.4%  1009   25s
H   42    64                    58640.608059 77758.9411  32.6%  1238   27s
    95   188 77319.7288    7  455 58640.6081 77686.1916  32.5%  1330   31s
H  130   188                    58671.252108 77686.1916  32.4%  1136   31s
H  223   259                    58676.458076 77686.1916  32.4%   950   33s
   258   327 72088.2573   11  452 58676.4581 77686.1916  32.4%   944   35s
H  358   396                    58686.503759 77686.1916  32.4%   902   37s
H  523   519                    58789.409314 77686.1916  32.1%   767   39s
   555   614 70813.8427   13  386 58789.4093 77686.1916  32.1%   736   40s
   924   942 70622.7093   18  382 58789.4093 77403.4560  31.7%   560   45s
H 1314  1230                    58808.661681 77325.8220  31.5%   473   49s
  1350  1382 68899.1504   26  365 58808.6617 77325.8220  31.5%   471   50s
  1876  1847 66380.0820   35  341 58808.6617 77257.7263  31.4%   396   55s
  2537  2391 62876.0843   42  264 58808.6617 77016.1416  31.0%   362   60s
  3117  2679 60305.2537   64  220 58808.6617 76727.2923  30.5%   347   65s
H 3119  2678                    58853.827061 76727.2923  30.4%   347   65s
  3396  2875 60394.0546   36  373 58853.8271 76717.2495  30.4%   352   75s
  3403  2880 67411.9645   32  359 58853.8271 76717.2495  30.4%   352   80s
H 3416  2743                    58858.191723 76717.2495  30.3%   350   85s
H 3416  2605                    59110.248625 76717.2495  29.8%   350   85s
H 3424  2480                    59112.773685 76717.2495  29.8%   349   92s
H 3425  2358                    59216.295403 76717.2495  29.6%   357   92s
  3432  2370 71503.6913   13  360 59216.2954 73947.6009  24.9%   359   95s
H 3456  2291                    59305.948270 72952.5690  23.0%   366   97s
H 3457  2179                    59413.629634 72952.5690  22.8%   366   97s
H 3458  2071                    59654.080097 72952.4880  22.3%   367   97s
H 3479  1963                    59722.024608 72580.2828  21.5%   372   97s
H 3520  1940                    59928.924371 72580.2828  21.1%   385   99s
H 3536  1843                    59932.564104 72580.2828  21.1%   387   99s
H 3555  1750                    59948.500427 72580.2828  21.1%   388   99s
H 3563  1664                    59965.398584 72580.2828  21.0%   389   99s
  3584  1708 65441.1405   18  245 59965.3986 72580.2828  21.0%   390  101s
H 3689  1627                    60046.142874 72580.2828  20.9%   396  101s
H 3770  1591                    60126.819511 72580.2828  20.7%   400  103s
H 3804  1509                    60227.535696 72580.2828  20.5%   400  103s
  3914  1518 infeasible   23      60227.5357 72580.2828  20.5%   401  105s
H 3990  1431                    60239.674896 71471.1865  18.6%   401  106s
H 4014  1359                    60244.907714 71471.1865  18.6%   402  106s
  4183  1403     cutoff   28      60244.9077 70520.3650  17.1%   405  110s
H 4460  1278                    60279.807186 69438.7704  15.2%   411  114s
  4461  1303 64078.2560   19  282 60279.8072 69438.7704  15.2%   411  115s
H 4843  1179                    60301.608848 68443.4304  13.5%   419  119s
  4886  1180 64877.9419   22  278 60301.6088 68405.6746  13.4%   419  121s
  5224  1095 63808.6542   20  235 60301.6088 68018.2968  12.8%   424  125s
H 5482   965                    60307.202438 67535.3788  12.0%   427  127s
  5684   907     cutoff   18      60307.2024 67535.3788  12.0%   429  130s
  6219   710     cutoff   27      60307.2024 66239.5477  9.84%   433  136s
H 6734   577                    60346.708370 65443.4570  8.45%   434  139s
  6760   496     cutoff   18      60346.7084 65443.4570  8.45%   435  140s
  7773   144 61237.8875   31  166 60346.7084 63272.1331  4.85%   426  145s

Cutting planes:
  MIR: 223
  Flow cover: 442
  RLT: 4
  Relax-and-lift: 56

Explored 12150 nodes (3556881 simplex iterations) in 149.76 seconds (367.13 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 60346.7 60307.2 60279.8 ... 59948.5

Optimal solution found (tolerance 1.00e-04)
Best objective 6.034670837048e+04, best bound 6.034670837048e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 149.76s
  Master Objective (UB) = 60346.71, θ = 233897.77
  Upper Bound (UB) = 60346.71

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 233897.77
  [DEBUG]   ✓ Scenario 0: θ = 233897.77 ≤ Q = 233897.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 233897.77 ≤ Q = 233897.77 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x27512d3c
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x27512d3c
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.313791e+13
Presolve removed 2556 rows and 1846 columns
Presolve time: 0.00s
Presolved: 537 rows, 543 columns, 1516 nonzeros
Found heuristic solution: objective 6799691.4753
Variable types: 368 continuous, 175 integer (175 binary)
Found heuristic solution: objective 6799343.9898

Root relaxation: objective -1.786181e+05, 274 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -178618.05    0  133 6799343.99 -178618.05   103%     -    0s
H    0     0                    -157510.8316 -178618.05  13.4%     -    0s
H    0     0                    -157603.4038 -178009.84  12.9%     -    0s
H    0     0                    -159422.9804 -165465.34  3.79%     -    0s
H    0     0                    -160287.3049 -165465.34  3.23%     -    0s
     0     0 -165465.34    0   94 -160287.30 -165465.34  3.23%     -    0s
H    0     0                    -162908.4875 -165425.02  1.54%     -    0s
H    0     0                    -163412.8978 -164829.76  0.87%     -    0s
     0     0 -164829.76    0   90 -163412.90 -164829.76  0.87%     -    0s
     0     0 -164809.83    0   90 -163412.90 -164809.83  0.85%     -    0s
     0     0 -164809.03    0   91 -163412.90 -164809.03  0.85%     -    0s
     0     0 -164401.38    0   20 -163412.90 -164401.38  0.60%     -    0s
H    0     0                    -163972.1652 -164397.51  0.26%     -    0s
     0     0 -164365.20    0    8 -163972.17 -164365.20  0.24%     -    0s
     0     0 -164362.30    0    7 -163972.17 -164362.30  0.24%     -    0s
H    0     0                    -163982.6261 -164362.30  0.23%     -    0s
H    0     0                    -164300.4686 -164362.30  0.04%     -    0s
     0     0 -164356.05    0    6 -164300.47 -164356.05  0.03%     -    0s
     0     0 -164356.05    0   36 -164300.47 -164356.05  0.03%     -    0s
H    0     0                    -164336.1865 -164356.05  0.01%     -    0s
     0     0          -    0      -164336.19 -164350.02  0.01%     -    0s

Cutting planes:
  Gomory: 8
  Implied bound: 13
  MIR: 22
  Flow cover: 13
  RLT: 3

Explored 1 nodes (729 simplex iterations) in 0.06 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -164336 -164300 -164193 ... 6.79934e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.643361865350e+05, best bound -1.643500227684e+05, gap 0.0084%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 209696.20
  Scenario: 28 demand increases, 32 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -164336.19
  [DEBUG]   S×d_nominal = 374032.38
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 374032.38 + -164336.19 = 209696.20
  [DEBUG]   Current θ from Master = 233897.77
  [DEBUG]   ⚠️  Z_SP ≤ θ by 24201.58 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 36145.13
  Lower Bound (LB) = 48673.91
  Gap (UB-LB) = 11672.8001, Absolute Gap = 11672.8001, Relative Gap = 0.193429
  Not converged yet (gap = 11672.80 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 28 increases, 32 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135284 nonzeros
Model fingerprint: 0x7d360b50
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 36145.1 (0.03s)
Loaded MIP start from previous solve with objective 36145.1

Presolve removed 18786 rows and 7626 columns
Presolve time: 0.49s
Presolved: 28467 rows, 13354 columns, 175289 nonzeros
Variable types: 11095 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...

Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 9.124442e+04, 14015 iterations, 3.60 seconds (6.84 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 91244.4220    0   75 36145.1293 91244.4220   152%     -    4s
H    0     0                    43483.425745 91244.4220   110%     -    4s
H    0     0                    47082.827922 91244.4220  93.8%     -    4s
H    0     0                    48746.036669 91244.4220  87.2%     -    4s
H    0     0                    49859.640309 91244.4220  83.0%     -    4s
H    0     0                    49900.190108 91244.4220  82.9%     -    4s
H    0     0                    53869.334836 91244.4220  69.4%     -    4s
H    0     0                    54735.482144 91244.4220  66.7%     -    4s
H    0     0                    55675.041116 91244.4220  63.9%     -    4s
H    0     0                    56055.649700 91244.4220  62.8%     -    4s
H    0     0                    57128.749052 85494.8712  49.7%     -    6s
H    0     0                    57323.041131 85494.8712  49.1%     -    6s
     0     0 85494.8712    0  150 57323.0411 85494.8712  49.1%     -    6s
H    0     0                    57345.343119 85493.9916  49.1%     -    6s
H    0     0                    57387.588101 85493.9916  49.0%     -    6s
     0     0 84977.4881    0  162 57387.5881 84977.4881  48.1%     -    6s
     0     0 84968.7213    0  163 57387.5881 84968.7213  48.1%     -    6s
     0     0 84966.0488    0  157 57387.5881 84966.0488  48.1%     -    6s
     0     0 84965.8407    0  159 57387.5881 84965.8407  48.1%     -    6s
     0     0 82487.1368    0  206 57387.5881 82487.1368  43.7%     -    8s
H    0     0                    57457.239659 82486.8678  43.6%     -    8s
H    0     0                    57541.714373 82486.8678  43.4%     -    8s
     0     0 82041.2690    0  221 57541.7144 82041.2690  42.6%     -    9s
     0     0 81962.8383    0  259 57541.7144 81962.8383  42.4%     -    9s
     0     0 81918.4951    0  229 57541.7144 81918.4951  42.4%     -    9s
     0     0 81910.8100    0  233 57541.7144 81910.8100  42.4%     -    9s
     0     0 81899.8786    0  239 57541.7144 81899.8786  42.3%     -    9s
     0     0 81898.2884    0  234 57541.7144 81898.2884  42.3%     -    9s
     0     0 81897.1996    0  234 57541.7144 81897.1996  42.3%     -   10s
     0     0 81897.1187    0  240 57541.7144 81897.1187  42.3%     -   10s
     0     0 80570.7750    0  318 57541.7144 80570.7750  40.0%     -   12s
H    0     0                    57644.899941 80565.8702  39.8%     -   12s
     0     0 80319.2303    0  318 57644.8999 80319.2303  39.3%     -   12s
     0     0 80188.7721    0  319 57644.8999 80188.7721  39.1%     -   13s
H    0     0                    57825.005631 80103.3536  38.5%     -   13s
     0     0 80103.3536    0  328 57825.0056 80103.3536  38.5%     -   13s
     0     0 80053.4708    0  322 57825.0056 80053.4708  38.4%     -   13s
     0     0 80043.6048    0  320 57825.0056 80043.6048  38.4%     -   13s
     0     0 80031.9328    0  322 57825.0056 80031.9328  38.4%     -   13s
     0     0 80030.8618    0  326 57825.0056 80030.8618  38.4%     -   14s
     0     0 79491.7076    0  330 57825.0056 79491.7076  37.5%     -   16s
     0     0 79357.2752    0  341 57825.0056 79357.2752  37.2%     -   17s
     0     0 79324.8664    0  346 57825.0056 79324.8664  37.2%     -   17s
     0     0 79304.9208    0  347 57825.0056 79304.9208  37.1%     -   17s
     0     0 79294.6387    0  347 57825.0056 79294.6387  37.1%     -   17s
     0     0 79291.9740    0  349 57825.0056 79291.9740  37.1%     -   17s
     0     0 79291.2713    0  347 57825.0056 79291.2713  37.1%     -   17s
     0     0 79184.1070    0  336 57825.0056 79184.1070  36.9%     -   18s
     0     0 79145.6784    0  347 57825.0056 79145.6784  36.9%     -   19s
     0     0 79134.6767    0  350 57825.0056 79134.6767  36.9%     -   19s
     0     0 79113.1062    0  354 57825.0056 79113.1062  36.8%     -   19s
     0     0 79107.4323    0  358 57825.0056 79107.4323  36.8%     -   19s
     0     0 79101.4745    0  358 57825.0056 79101.4745  36.8%     -   19s
     0     0 79098.0113    0  358 57825.0056 79098.0113  36.8%     -   19s
     0     0 79094.7332    0  356 57825.0056 79094.7332  36.8%     -   19s
     0     0 79094.1102    0  355 57825.0056 79094.1102  36.8%     -   19s
H    0     0                    57917.383727 79009.2340  36.4%     -   20s
     0     0 79009.2340    0  364 57917.3837 79009.2340  36.4%     -   20s
     0     0 78977.9900    0  363 57917.3837 78977.9900  36.4%     -   21s
     0     0 78965.5706    0  373 57917.3837 78965.5706  36.3%     -   21s
     0     0 78958.9194    0  376 57917.3837 78958.9194  36.3%     -   21s
     0     0 78954.5333    0  377 57917.3837 78954.5333  36.3%     -   21s
     0     0 78949.9120    0  376 57917.3837 78949.9120  36.3%     -   21s
     0     0 78949.5049    0  375 57917.3837 78949.5049  36.3%     -   21s
     0     0 78883.7028    0  369 57917.3837 78883.7028  36.2%     -   22s
     0     0 78860.1640    0  370 57917.3837 78860.1640  36.2%     -   22s
     0     0 78856.5467    0  382 57917.3837 78856.5467  36.2%     -   22s
     0     0 78854.2506    0  388 57917.3837 78854.2506  36.1%     -   23s
     0     0 78852.4676    0  371 57917.3837 78852.4676  36.1%     -   23s
     0     0 78851.0887    0  389 57917.3837 78851.0887  36.1%     -   23s
     0     0 78830.4182    0  374 57917.3837 78830.4182  36.1%     -   23s
     0     0 78828.6492    0  387 57917.3837 78828.6492  36.1%     -   23s
     0     0 78828.5608    0  387 57917.3837 78828.5608  36.1%     -   23s
     0     0 78821.3157    0  366 57917.3837 78821.3157  36.1%     -   24s
     0     0 78820.8426    0  371 57917.3837 78820.8426  36.1%     -   24s
     0     0 78816.8078    0  369 57917.3837 78816.8078  36.1%     -   24s
     0     0 78813.9249    0  371 57917.3837 78813.9249  36.1%     -   25s
     0     0 78813.6530    0  374 57917.3837 78813.6530  36.1%     -   25s
     0     0 78812.5464    0  371 57917.3837 78812.5464  36.1%     -   25s
     0     0 78810.6103    0  371 57917.3837 78810.6103  36.1%     -   25s
     0     2 78810.6103    0  371 57917.3837 78810.6103  36.1%     -   30s
    31    64 77610.0568    5  345 57917.3837 77834.9999  34.4%  1476   35s
H   64    96                    58012.509181 77610.0346  33.8%  1287   37s
    95   160 76989.3507    7  351 58012.5092 77610.0346  33.8%   996   41s
   349   435 76504.9827   12  340 58012.5092 77610.0346  33.8%   638   45s
   579   645 75029.7045   15  319 58012.5092 77610.0346  33.8%   594   50s
   868   867 74295.2723   18  340 58012.5092 77297.5111  33.2%   565   55s
  1002   964 73148.8061   20  305 58012.5092 77129.4242  33.0%   594   60s
  1144  1091 69315.9747   23  298 58012.5092 76932.8475  32.6%   626   66s
  1309  1259 61523.1655   25  311 58012.5092 76932.8475  32.6%   616   70s
  1528  1446 63788.5005   27  275 58012.5092 76932.8475  32.6%   599   75s
  1883  1786 61164.8948   29  209 58012.5092 76797.6294  32.4%   561   80s
  2392  2160 60796.8597   30  166 58012.5092 76436.1336  31.8%   522   88s
  2557  2275 59946.4984   32  175 58012.5092 76434.2681  31.8%   520   91s
  2755  2340 59716.3322   33  160 58012.5092 76351.3926  31.6%   525   96s
H 2762  2339                    58083.491858 76351.3926  31.5%   525   96s
H 2784  2339                    58086.342860 76351.3926  31.4%   527   96s
  2993  2685 59123.5255   38  150 58086.3429 76351.3926  31.4%   523  100s
  3317  2884 69260.2592   13  267 58086.3429 76351.3926  31.4%   509  105s
  3527  2885 70532.8312   13  371 58086.3429 76317.5158  31.4%   499  113s
  3529  2886 69135.2353   16   75 58086.3429 76317.5158  31.4%   499  115s
  3532  2888 60524.1041   33  320 58086.3429 76317.5158  31.4%   498  120s
  3540  2894 61321.7520   34  362 58086.3429 76317.5158  31.4%   497  125s
  3548  2899 62088.1192   37  368 58086.3429 75594.9279  30.1%   496  131s
  3552  2902 60129.6652   33  461 58086.3429 75136.4148  29.4%   495  135s
  3559  2906 59591.5307   56  447 58086.3429 74782.3363  28.7%   494  140s
  3566  2911 59621.8414   31  410 58086.3429 74721.9064  28.6%   493  145s
  3570  2914 58833.8351   40  396 58086.3429 74694.3177  28.6%   493  153s
  3571  2917 74563.2941   13  387 58086.3429 74689.2242  28.6%   505  155s
  3577  2927 70903.7081   15  363 58086.3429 74343.4444  28.0%   507  160s
  3601  2967 69898.6181   17  392 58086.3429 72260.2530  24.4%   517  166s
  3665  3023 69138.1763   19  376 58086.3429 71808.0328  23.6%   540  171s
  3757  3074 66463.2068   20  289 58086.3429 71808.0328  23.6%   547  176s
  3849  3169 68016.0394   21  339 58086.3429 71808.0328  23.6%   557  182s
  3923  3200 66345.7572   22  321 58086.3429 71808.0328  23.6%   565  185s
  4071  3250 62341.0917   23  301 58086.3429 71432.1158  23.0%   576  190s
  4306  3305 61846.7618   26  293 58086.3429 70809.2801  21.9%   584  196s
  4535  3360 59456.8971   29  238 58086.3429 70538.6868  21.4%   592  203s
  4710  3371 58701.3511   33  239 58086.3429 70337.4739  21.1%   594  208s
  4777  3364     cutoff   33      58086.3429 70177.4356  20.8%   595  211s
  4961  3368 infeasible   35      58086.3429 69724.8242  20.0%   597  215s
  5198  3401 67938.6110   21  312 58086.3429 69724.8242  20.0%   598  221s
  5424  3478 60277.6654   22  280 58086.3429 69594.1923  19.8%   601  225s
  5726  3509 60976.9017   23  294 58086.3429 69309.9766  19.3%   601  231s
H 5921  3319                    58454.885320 69090.8934  18.2%   607  233s
  5945  3382 59358.4247   27  214 58454.8853 69090.8934  18.2%   608  236s
  6240  3425 63831.4338   19  281 58454.8853 69090.8934  18.2%   620  243s
  6448  3416     cutoff   23      58454.8853 69090.8934  18.2%   623  246s
  6625  3463 65675.5517   22  286 58454.8853 69090.8934  18.2%   628  250s
  7049  3369 61569.9040   21  337 58454.8853 68813.5782  17.7%   637  256s
H 7069  3209                    58575.612824 68813.5782  17.5%   638  256s
  7092  3282 61366.5214   22  337 58575.6128 68813.5782  17.5%   640  261s
  7299  3311     cutoff   25      58575.6128 68688.3620  17.3%   645  265s
  7844  3336 63151.9167   28  101 58575.6128 68273.8631  16.6%   642  273s
  8080  3332 60501.7599   35   73 58575.6128 68047.5350  16.2%   648  277s
  8202  3365 59405.7145   50   36 58575.6128 68047.5350  16.2%   654  282s
  8459  3331 59946.7488   23  252 58575.6128 68047.5350  16.2%   660  286s
  8741  3278 60781.0247   24  253 58575.6128 67862.9559  15.9%   661  290s
H 8770  3112                    58660.687994 67862.9559  15.7%   661  290s
H 8782  2924                    58903.854227 67846.8507  15.2%   662  290s
H 8853  2773                    58949.550099 67674.8584  14.8%   662  290s
  9223  2810     cutoff   24      58949.5501 67617.4309  14.7%   666  299s
  9598  2793 64336.3090   22  280 58949.5501 67572.5227  14.6%   666  304s
  9911  2787 59231.3171   26  159 58949.5501 67250.9446  14.1%   670  308s
 10227  2744 63564.4966   26  246 58949.5501 67242.0703  14.1%   670  313s
 10508  2762 61408.2943   28  117 58949.5501 67242.0703  14.1%   675  318s
 10866  2818     cutoff   24      58949.5501 66832.0432  13.4%   681  324s
 11217  2903 60019.5908   28  120 58949.5501 66599.4882  13.0%   684  330s
 11585  2974 63783.2076   23  287 58949.5501 66585.1991  13.0%   690  336s
 11988  3057 62954.0613   24  172 58949.5501 66585.1991  13.0%   695  341s
 12373  3128     cutoff   25      58949.5501 66513.8545  12.8%   700  347s
H12690  3154                    59006.703779 66513.8545  12.7%   705  353s
H12785  3127                    59044.261754 66513.8545  12.7%   704  353s
 13026  3170 61019.8543   28  163 59044.2618 66231.4238  12.2%   704  359s
 13475  3210 59841.1943   27  246 59044.2618 66029.6581  11.8%   707  365s
 13942  3293 60087.2663   24  275 59044.2618 65794.8021  11.4%   709  372s
 14474  3372 61688.8878   28  148 59044.2618 65711.5951  11.3%   710  379s
 15011  3422 59894.9147   29  179 59044.2618 65574.0137  11.1%   713  386s
 15597  3472     cutoff   34      59044.2618 65539.5027  11.0%   714  393s
 16073  3578 59828.9618   25  335 59044.2618 65295.1628  10.6%   716  401s
 16768  3668 60866.5055   28  184 59044.2618 65100.7708  10.3%   715  408s
 17453  3745 59792.7816   25  283 59044.2618 64960.9603  10.0%   715  417s
 18183  3782     cutoff   28      59044.2618 64609.2541  9.43%   716  425s
 18958  3799 60170.2675   29  175 59044.2618 64441.0760  9.14%   714  433s
H18973  3769                    59113.939587 64441.0760  9.01%   714  433s
 19047  3782 60023.0644   30  132 59113.9396 64411.0540  8.96%   715  440s
 19645  3845 61688.8448   30  176 59113.9396 64292.9272  8.76%   715  449s
 20294  3863 59990.8698   30  190 59113.9396 64206.3735  8.61%   716  458s
 21166  3861     cutoff   27      59113.9396 63843.0177  8.00%   715  468s
 22060  3811 61469.7745   26  254 59113.9396 63579.2617  7.55%   715  477s
 23048  3742 59133.7948   28  144 59113.9396 63384.8567  7.22%   714  487s
 24070  3624 59494.0310   27  197 59113.9396 63105.3152  6.75%   712  497s
 25155  3550 infeasible   31      59113.9396 62953.6259  6.50%   710  508s
 26240  3330 59778.6887   27  278 59113.9396 62580.0995  5.86%   710  519s
 27449  3026     cutoff   27      59113.9396 62269.9135  5.34%   707  530s
 28642  2551     cutoff   28      59113.9396 62004.1668  4.89%   706  542s
 29926  1786 60399.9249   31  211 59113.9396 61596.5487  4.20%   703  552s
 31582  1127     cutoff   30      59113.9396 61268.8968  3.65%   694  563s
 35767  2894 59312.8872   73   18 59113.9396 60145.0316  1.74%   636  569s
*35863  2894              79    59139.226953 60145.0316  1.70%   635  569s
H35894  2894                    59163.403468 60145.0316  1.66%   635  569s
*35951  2894              74    59214.340119 60145.0316  1.57%   634  569s
H38725  2894                    59338.800313 60087.4789  1.26%   595  569s
 42231  1771     cutoff   80      59338.8003 59764.9164  0.72%   552  585s
H42244  1771                    59353.854416 59764.9164  0.69%   552  585s
H42287  1771                    59428.593536 59759.6694  0.56%   552  585s
H42345  1771                    59438.984852 59759.6694  0.54%   551  585s

Cutting planes:
  Gomory: 1
  MIR: 520
  Mixing: 3
  Flow cover: 972
  RLT: 7
  Relax-and-lift: 85

Explored 44531 nodes (23428123 simplex iterations) in 586.72 seconds (1819.08 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 59439 59439 59428.6 ... 59044.3

Optimal solution found (tolerance 1.00e-04)
Best objective 5.943898485248e+04, best bound 5.943898485248e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 586.75s
  Master Objective (UB) = 59438.98, θ = 239134.71
  Upper Bound (UB) = 59438.98

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 239134.71
  [DEBUG]   ✓ Scenario 0: θ = 239134.71 ≤ Q = 239134.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 239134.71 ≤ Q = 239134.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 239134.71 ≤ Q = 239134.71 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x731665ad
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x731665ad
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-01, 2e+02]
Found heuristic solution: objective 1.316141e+13
Presolve removed 2550 rows and 1841 columns
Presolve time: 0.00s
Presolved: 543 rows, 548 columns, 1532 nonzeros
Found heuristic solution: objective 6971234.1494
Variable types: 372 continuous, 176 integer (176 binary)

Root relaxation: objective -1.716580e+05, 279 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -171658.02    0  137 6971234.15 -171658.02   102%     -    0s
H    0     0                    -132357.0577 -171658.02  29.7%     -    0s
H    0     0                    -133960.4009 -171658.02  28.1%     -    0s
H    0     0                    -148242.3898 -171658.02  15.8%     -    0s
H    0     0                    -148630.2174 -159914.29  7.59%     -    0s
H    0     0                    -151703.5805 -159914.29  5.41%     -    0s
     0     0 -159914.29    0   97 -151703.58 -159914.29  5.41%     -    0s
H    0     0                    -157412.4375 -159876.02  1.57%     -    0s
H    0     0                    -157595.7578 -158983.29  0.88%     -    0s
     0     0 -158983.29    0   95 -157595.76 -158983.29  0.88%     -    0s
     0     0 -158942.86    0   95 -157595.76 -158942.86  0.85%     -    0s
     0     0 -158159.76    0   52 -157595.76 -158159.76  0.36%     -    0s
     0     0 -158020.95    0   56 -157595.76 -158020.95  0.27%     -    0s
     0     0 -158015.05    0   55 -157595.76 -158015.05  0.27%     -    0s
     0     0 -157973.32    0   41 -157595.76 -157973.32  0.24%     -    0s
     0     0 -157962.29    0   40 -157595.76 -157962.29  0.23%     -    0s
     0     0 -157932.30    0   37 -157595.76 -157932.30  0.21%     -    0s
     0     0 -157916.60    0   35 -157595.76 -157916.60  0.20%     -    0s
     0     0 -157909.96    0   35 -157595.76 -157909.96  0.20%     -    0s
     0     0 -157893.00    0   37 -157595.76 -157893.00  0.19%     -    0s
     0     0 -157892.56    0   36 -157595.76 -157892.56  0.19%     -    0s
     0     0 -157886.26    0   41 -157595.76 -157886.26  0.18%     -    0s
     0     0 -157884.07    0   40 -157595.76 -157884.07  0.18%     -    0s
     0     0 -157799.25    0   11 -157595.76 -157799.25  0.13%     -    0s
     0     0 -157799.25    0   25 -157595.76 -157799.25  0.13%     -    0s
     0     0 -157732.69    0    5 -157595.76 -157732.69  0.09%     -    0s
H    0     0                    -157709.2939 -157730.99  0.01%     -    0s
     0     0 -157728.32    0    2 -157709.29 -157728.32  0.01%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 7
  Flow cover: 18
  Relax-and-lift: 5

Explored 1 nodes (918 simplex iterations) in 0.06 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -157709 -157596 -153426 ... 6.97123e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.577092938984e+05, best bound -1.577243990429e+05, gap 0.0096%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 215698.65
  Scenario: 41 demand increases, 19 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -157709.29
  [DEBUG]   S×d_nominal = 373407.95
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 373407.95 + -157709.29 = 215698.65
  [DEBUG]   Current θ from Master = 239134.71
  [DEBUG]   ⚠️  Z_SP ≤ θ by 23436.06 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 36002.93
  Lower Bound (LB) = 48673.91
  Gap (UB-LB) = 10765.0766, Absolute Gap = 10765.0766, Relative Gap = 0.181111
  Not converged yet (gap = 10765.08 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 41 increases, 19 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178539 nonzeros
Model fingerprint: 0x98c7198d
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 36002.9 (0.04s)
MIP start from previous solve produced solution with objective 36002.9 (0.04s)
Loaded MIP start from previous solve with objective 36002.9

Presolve removed 25048 rows and 10168 columns
Presolve time: 0.58s
Presolved: 37495 rows, 17052 columns, 231879 nonzeros
Variable types: 14793 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 37495 rows, 17052 columns, 231879 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   56164    4.8051551e+04   0.000000e+00   6.269139e+08      5s
Concurrent spin time: 1.45s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 8.954991e+04, 34985 iterations, 7.42 seconds (14.40 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 89549.9077    0   75 36002.9269 89549.9077   149%     -    8s
H    0     0                    48771.796409 89549.9077  83.6%     -    8s
H    0     0                    48976.466727 89549.9077  82.8%     -    8s
H    0     0                    49133.306982 89549.9077  82.3%     -    8s
H    0     0                    49776.392894 89549.9077  79.9%     -    8s
H    0     0                    50845.733756 89549.9077  76.1%     -    8s
H    0     0                    51514.916734 89549.9077  73.8%     -    8s
H    0     0                    51542.143911 89549.9077  73.7%     -    8s
H    0     0                    52325.065341 89549.9077  71.1%     -    8s
     0     0 84083.7026    0  135 52325.0653 84083.7026  60.7%     -   12s
     0     0 83424.9971    0  163 52325.0653 83424.9971  59.4%     -   14s
     0     0 83424.9971    0  194 52325.0653 83424.9971  59.4%     -   15s
     0     0 83424.9971    0  194 52325.0653 83424.9971  59.4%     -   15s
     0     0 80513.9266    0  266 52325.0653 80513.9266  53.9%     -   18s
     0     0 79961.6509    0  283 52325.0653 79961.6509  52.8%     -   20s
     0     0 79732.6966    0  291 52325.0653 79732.6966  52.4%     -   21s
     0     0 79650.4888    0  296 52325.0653 79650.4888  52.2%     -   21s
     0     0 79632.2193    0  302 52325.0653 79632.2193  52.2%     -   22s
     0     0 79630.0034    0  298 52325.0653 79630.0034  52.2%     -   22s
     0     0 79628.3661    0  300 52325.0653 79628.3661  52.2%     -   22s
     0     0 79627.1257    0  305 52325.0653 79627.1257  52.2%     -   22s
     0     0 79626.5939    0  308 52325.0653 79626.5939  52.2%     -   22s
     0     0 78398.3738    0  290 52325.0653 78398.3738  49.8%     -   27s
     0     0 78087.1486    0  308 52325.0653 78087.1486  49.2%     -   29s
     0     0 77931.5405    0  319 52325.0653 77931.5405  48.9%     -   30s
     0     0 77911.0023    0  320 52325.0653 77911.0023  48.9%     -   31s
     0     0 77883.2097    0  326 52325.0653 77883.2097  48.8%     -   31s
     0     0 77873.8046    0  332 52325.0653 77873.8046  48.8%     -   32s
     0     0 77871.6468    0  325 52325.0653 77871.6468  48.8%     -   32s
     0     0 77869.1279    0  327 52325.0653 77869.1279  48.8%     -   32s
     0     0 77868.6985    0  327 52325.0653 77868.6985  48.8%     -   32s
     0     0 77489.9706    0  349 52325.0653 77489.9706  48.1%     -   35s
H    0     0                    52516.565122 77488.2201  47.6%     -   35s
H    0     0                    52853.860361 77372.7248  46.4%     -   37s
H    0     0                    53647.308420 77372.7248  44.2%     -   37s
H    0     0                    53690.291869 77372.7248  44.1%     -   37s
     0     0 77372.7248    0  351 53690.2919 77372.7248  44.1%     -   37s
H    0     0                    53862.172037 77328.9171  43.6%     -   38s
     0     0 77328.9171    0  359 53862.1720 77328.9171  43.6%     -   38s
     0     0 77306.0095    0  358 53862.1720 77306.0095  43.5%     -   38s
     0     0 77297.2967    0  348 53862.1720 77297.2967  43.5%     -   38s
     0     0 77287.3818    0  342 53862.1720 77287.3818  43.5%     -   38s
     0     0 77284.9702    0  340 53862.1720 77284.9702  43.5%     -   39s
     0     0 77280.9542    0  350 53862.1720 77280.9542  43.5%     -   39s
     0     0 77279.7860    0  353 53862.1720 77279.7860  43.5%     -   39s
     0     0 77237.0332    0  350 53862.1720 77237.0332  43.4%     -   40s
H    0     0                    53876.411140 77236.7129  43.4%     -   40s
     0     0 77214.3346    0  358 53876.4111 77214.3346  43.3%     -   40s
     0     0 77195.3309    0  362 53876.4111 77195.3309  43.3%     -   41s
     0     0 77183.8093    0  361 53876.4111 77183.8093  43.3%     -   41s
     0     0 77179.2521    0  358 53876.4111 77179.2521  43.3%     -   41s
     0     0 77178.5303    0  358 53876.4111 77178.5303  43.3%     -   41s
     0     0 77159.6755    0  351 53876.4111 77159.6755  43.2%     -   42s
H    0     0                    53965.931061 77158.5287  43.0%     -   42s
     0     0 77156.2555    0  351 53965.9311 77156.2555  43.0%     -   42s
     0     0 77155.6091    0  350 53965.9311 77155.6091  43.0%     -   42s
     0     0 77131.9834    0  353 53965.9311 77131.9834  42.9%     -   43s
     0     0 77123.0642    0  354 53965.9311 77123.0642  42.9%     -   44s
     0     0 77121.1215    0  365 53965.9311 77121.1215  42.9%     -   44s
     0     0 77119.6244    0  366 53965.9311 77119.6244  42.9%     -   44s
     0     0 77083.6478    0  401 53965.9311 77083.6478  42.8%     -   45s
H    0     0                    54038.127254 77083.1258  42.6%     -   45s
     0     0 77081.5448    0  355 54038.1273 77081.5448  42.6%     -   45s
     0     0 77080.3912    0  369 54038.1273 77080.3912  42.6%     -   45s
     0     0 77074.6820    0  360 54038.1273 77074.6820  42.6%     -   45s
     0     0 77069.6636    0  362 54038.1273 77069.6636  42.6%     -   46s
     0     0 77063.2428    0  355 54038.1273 77063.2428  42.6%     -   46s
     0     0 77059.2236    0  368 54038.1273 77059.2236  42.6%     -   46s
     0     0 77059.2236    0  370 54038.1273 77059.2236  42.6%     -   47s
     0     0 77059.2236    0  358 54038.1273 77059.2236  42.6%     -   47s
     0     0 77059.2236    0  370 54038.1273 77059.2236  42.6%     -   47s
     0     0 77059.2236    0  370 54038.1273 77059.2236  42.6%     -   48s
H    0     0                    54265.011565 77059.2236  42.0%     -   55s
     0     2 77059.2236    0  370 54265.0116 77059.2236  42.0%     -   55s
     3     8 76788.7449    2  354 54265.0116 76960.1950  41.8%  5079   63s
     7    16 76479.1309    3  355 54265.0116 76776.5906  41.5%  5407   65s
    31    62 76039.6631    5  356 54265.0116 76412.8722  40.8%  6107   76s
    61    94 76011.6154    6  355 54265.0116 76152.7606  40.3%  7040   80s
H   66    94                    54290.058839 76150.8209  40.3%  6695   80s
H   78    94                    54409.539127 76011.4537  39.7%  6198   80s
    93   157 75792.2501    7  346 54409.5391 76011.4537  39.7%  5524   89s
H  156   253                    54587.141164 76011.4537  39.2%  4176   94s
H  174   253                    54762.313549 76011.4537  38.8%  4040   94s
H  185   253                    54951.774295 76011.4537  38.3%  3952   94s
H  238   253                    54955.833464 76011.4537  38.3%  3489   94s
   252   334 75052.9171    9  331 54955.8335 76011.4537  38.3%  3355   97s
H  339   366                    54956.207553 76011.4537  38.3%  2970   99s
H  349   366                    54956.952817 76011.4537  38.3%  2981   99s
   365   455 72922.0558   10  327 54956.9528 76011.4537  38.3%  2935  105s
   486   530 73446.3036   12  311 54956.9528 76011.4537  38.3%  2619  112s
   529   569 74488.2392   12  366 54956.9528 76011.4537  38.3%  2539  115s
   572   610 73956.4947   13  371 54956.9528 76011.4537  38.3%  2469  120s
   664   702 73761.8032   14  341 54956.9528 75953.9893  38.2%  2372  127s
   709   750 73614.6316   15  325 54956.9528 75953.9893  38.2%  2307  131s
   802   835 72998.5539   17  322 54956.9528 75953.9893  38.2%  2203  138s
   850   870 72785.9103   18  315 54956.9528 75953.9893  38.2%  2157  141s
   926   937 71686.7263   19  314 54956.9528 75953.9893  38.2%  2097  145s
  1011  1058 71849.2188   21  339 54956.9528 75953.9893  38.2%  2008  150s
  1188  1215 71695.1553   22  345 54956.9528 75787.9422  37.9%  1838  158s
  1277  1315 70704.9454   25  287 54956.9528 75767.9702  37.9%  1795  161s
  1385  1344 65802.5598   25  322 54956.9528 75767.9702  37.9%  1744  166s
  1420  1383 70697.4700   26  288 54956.9528 75676.0999  37.7%  1745  170s
  1568  1587 64671.1159   32  228 54956.9528 75676.0999  37.7%  1697  177s
  1691  1737 68401.0308   33  312 54956.9528 75676.0999  37.7%  1635  180s
  1851  1892 67814.0141   39  230 54956.9528 75676.0999  37.7%  1569  185s
  2025  1982 58091.3144   44  189 54956.9528 75676.0999  37.7%  1514  192s
  2147  2051 65194.9106   46  240 54956.9528 75676.0999  37.7%  1523  197s
  2233  2150 60275.9390   47  234 54956.9528 75578.4030  37.5%  1559  203s
  2352  2286 59185.4978   48  236 54956.9528 75578.4030  37.5%  1568  208s
  2506  2314 58218.3501   51  184 54956.9528 75578.4030  37.5%  1556  212s
H 2525  2313                    55196.716763 75578.4030  36.9%  1560  212s
  2544  2519 57561.6283   52  232 55196.7168 75578.4030  36.9%  1559  216s
  2774  2708 56477.4307   60  184 55196.7168 75578.4030  36.9%  1504  224s
  3009  2913 73669.6274   10  328 55196.7168 75578.4030  36.9%  1465  229s
  3294  3076 71168.6570   12  333 55196.7168 75578.4030  36.9%  1417  237s
  3498  3077 68311.8273   34  370 55196.7168 75325.5273  36.5%  1406  268s
  3500  3078 69250.5938   29   75 55196.7168 75325.5273  36.5%  1405  276s
  3501  3079 56926.6248   68  280 55196.7168 75325.5273  36.5%  1405  282s
  3503  3080 60591.1546   65  381 55196.7168 75325.5273  36.5%  1404  288s
  3505  3082 59300.8300   46  356 55196.7168 75325.5273  36.5%  1403  291s
  3510  3085 66330.2159   14  371 55196.7168 75325.5273  36.5%  1401  295s
  3514  3088 57314.8735   46  399 55196.7168 75325.5273  36.5%  1400  300s
  3518  3090 58134.1007   84  357 55196.7168 75325.5273  36.5%  1398  305s
  3524  3094 73965.5580    9  398 55196.7168 75325.5273  36.5%  1396  310s
  3529  3098 59206.2694   59  380 55196.7168 75325.5273  36.5%  1394  315s
  3534  3101 55973.3571   81  381 55196.7168 75325.5273  36.5%  1392  320s
  3539  3104 65450.8732   23  386 55196.7168 75325.5273  36.5%  1390  325s
  3540  3105 58515.1852   77  386 55196.7168 75325.5273  36.5%  1389  334s
  3541  3106 56822.6287   64  386 55196.7168 75325.5273  36.5%  1389  347s
  3542  3109 75325.5273   16  371 55196.7168 75325.5273  36.5%  1416  353s
  3544  3113 75277.4818   17  370 55196.7168 75325.5273  36.5%  1416  358s
  3548  3119 75092.3701   18  356 55196.7168 75274.1254  36.4%  1420  365s
  3572  3158 74167.9461   20  352 55196.7168 74501.9225  35.0%  1462  377s
  3603  3180 73588.7194   21  416 55196.7168 74166.9287  34.4%  1503  385s
H 3635  3095                    55229.753256 73647.1064  33.3%  1521  391s
H 3673  2934                    55395.336057 73647.1064  32.9%  1532  391s
  3717  2981 70586.7387   23  352 55395.3361 73647.1064  32.9%  1538  396s
H 3779  2874                    55428.568820 73647.1064  32.9%  1567  402s
  3833  2908 72269.7451   25  395 55428.5688 73647.1064  32.9%  1583  407s
  3888  2925 68726.5593   25  360 55428.5688 73647.1064  32.9%  1601  413s
  3940  2953 70773.2287   26  355 55428.5688 73647.1064  32.9%  1621  419s
  4005  2961 70752.8986   26  359 55428.5688 73588.3328  32.8%  1636  423s
  4042  2976 62882.3141   27  275 55428.5688 73588.3328  32.8%  1646  430s
  4087  2989 66234.0812   27  328 55428.5688 72614.2671  31.0%  1657  435s
  4121  3010 64448.6117   28  316 55428.5688 72607.3183  31.0%  1672  442s
  4164  3019 63623.4838   28  292 55428.5688 72607.3183  31.0%  1688  446s
  4202  3038 64151.8414   29  307 55428.5688 72607.3183  31.0%  1696  452s
  4238  3055 63204.4990   30  313 55428.5688 72607.3183  31.0%  1706  456s
  4271  3074 62495.2970   30  317 55428.5688 72607.3183  31.0%  1716  461s
  4305  3098 63154.7118   31  261 55428.5688 72607.3183  31.0%  1719  468s
  4357  3112 61961.5385   31  286 55428.5688 72493.4400  30.8%  1726  474s
  4423  3111 62016.7817   32  232 55428.5688 72259.0278  30.4%  1730  479s
  4510  3107 61772.0062   32  249 55428.5688 72248.7781  30.3%  1728  486s
  4590  3123 61237.0514   33  231 55428.5688 72154.5166  30.2%  1729  493s
  4669  3145 60430.4245   33  226 55428.5688 72154.5166  30.2%  1738  501s
  4763  3164 58040.0363   34  238 55428.5688 72154.5166  30.2%  1743  507s
  4861  3176 55775.4768   37  218 55428.5688 71624.8202  29.2%  1749  513s
  4958  3209 65285.3203   24  273 55428.5688 71624.8202  29.2%  1754  522s
  5069  3225 62596.3903   27  231 55428.5688 71170.0893  28.4%  1760  528s
  5183  3250 60504.5363   31  152 55428.5688 71168.7502  28.4%  1764  536s
  5314  3269 59036.9988   36  128 55428.5688 71168.7502  28.4%  1764  543s
  5469  3286 57652.3142   41  125 55428.5688 71168.7502  28.4%  1759  549s
  5621  3296 55887.8964   48   94 55428.5688 70849.3591  27.8%  1754  558s
  5750  3304 64230.8304   24  259 55428.5688 70849.3591  27.8%  1765  565s
  5828  3317 63194.9399   25  235 55428.5688 70849.3591  27.8%  1766  573s
H 5922  3152                    55524.547696 70688.1672  27.3%  1767  573s
  5954  3226 61848.3170   26  261 55524.5477 70688.1672  27.3%  1766  581s
  6086  3287 60135.8268   30  153 55524.5477 70688.1672  27.3%  1776  591s
  6259  3342 57582.8179   37  152 55524.5477 70312.4134  26.6%  1775  599s
  6473  3369 56202.1410   52  133 55524.5477 70312.4134  26.6%  1763  609s
  6728  3369 55801.6748   71   92 55524.5477 69589.7098  25.3%  1743  618s
  6918  3420 65981.4848   26  274 55524.5477 69415.3546  25.0%  1747  627s
  7125  3395 60479.3235   33  118 55524.5477 69276.7725  24.8%  1746  637s
H 7155  3258                    55552.404731 69276.7725  24.7%  1745  637s
H 7158  3115                    55921.618968 69276.7725  23.9%  1744  637s
H 7232  2964                    56039.849525 69276.7725  23.6%  1738  637s
  7287  2962     cutoff   45      56039.8495 69276.7725  23.6%  1737  645s
H 7328  2838                    56049.938809 69276.7725  23.6%  1743  645s
  7332  2943 64676.6345   25  278 56049.9388 69174.8944  23.4%  1744  655s
  7548  2997 59899.4160   30  207 56049.9388 69174.8944  23.4%  1751  666s
  7833  3009     cutoff   33      56049.9388 69174.8944  23.4%  1744  677s
  8059  3034 60860.5348   30  227 56049.9388 69174.8944  23.4%  1755  687s
  8271  3053 65539.1662   26  263 56049.9388 68794.7782  22.7%  1769  700s
  8528  3059 61310.3078   32  197 56049.9388 68758.1707  22.7%  1780  712s
  8743  3122 56364.4423   64   36 56049.9388 68758.1707  22.7%  1781  723s
  9031  3090 63568.4305   30  265 56049.9388 68677.7160  22.5%  1786  735s
  9341  3047 57617.9072   36  156 56049.9388 68276.3289  21.8%  1788  746s
  9636  3077 61636.1331   28  241 56049.9388 67862.4698  21.1%  1795  759s
  9978  3124 63118.6520   29  215 56049.9388 67528.0404  20.5%  1800  771s
 10265  3256 65684.0207   25  295 56049.9388 67259.4668  20.0%  1800  785s
 10619  3376 59515.8888   33  203 56049.9388 67243.4334  20.0%  1804  801s
 11043  3533 60496.3115   27  243 56049.9388 67243.4334  20.0%  1800  814s
 11452  3656 61467.1263   24  244 56049.9388 66943.1738  19.4%  1800  830s
 11904  3824 56755.3928   33  171 56049.9388 66943.1738  19.4%  1798  844s
 12378  3984 63167.7971   27  280 56049.9388 66943.1738  19.4%  1794  861s
 12838  4159 56330.1879   39  144 56049.9388 66121.2741  18.0%  1795  878s
 13336  4316 infeasible   32      56049.9388 66072.0735  17.9%  1792  894s
 13854  4391 57091.0340   31  167 56049.9388 65778.0703  17.4%  1789  910s
 14446  4474 60736.3942   26  219 56049.9388 65590.9221  17.0%  1780  929s
 14985  4630 56671.1679   28  299 56049.9388 65399.0431  16.7%  1779  948s
 15590  4708 56450.6086   33  200 56049.9388 65309.0913  16.5%  1775  965s
 16020  4821 58608.3611   25  223 56049.9388 65280.1638  16.5%  1776  985s
 16618  5026     cutoff   33      56049.9388 65107.9350  16.2%  1777 1004s
 17208  5043 infeasible   31      56049.9388 64749.3124  15.5%  1781 1024s
H17211  5042                    56064.462027 64749.3124  15.5%  1781 1024s
H17226  5028                    56113.017825 64749.3124  15.4%  1781 1024s
 17260  5199 59543.7060   30  230 56113.0178 64749.3124  15.4%  1781 1044s
 18008  5278 60324.8578   29  152 56113.0178 64574.4736  15.1%  1773 1065s
 18764  5431     cutoff   35      56113.0178 64442.5677  14.8%  1770 1087s
 19419  5614 58928.5097   27  262 56113.0178 64217.3059  14.4%  1778 1110s
 20097  5798 56465.0612   32  173 56113.0178 64073.5971  14.2%  1785 1133s
 20880  5974 60305.1011   30  238 56113.0178 63916.6704  13.9%  1784 1159s
 21689  6155 61167.2641   30  267 56113.0178 63738.7021  13.6%  1785 1183s
 22458  6309     cutoff   27      56113.0178 63638.8833  13.4%  1783 1208s
 23295  6477 61795.9952   28  194 56113.0178 63521.1621  13.2%  1786 1236s
 24171  6706     cutoff   29      56113.0178 63345.9763  12.9%  1789 1265s
 25130  6875     cutoff   33      56113.0178 63199.0697  12.6%  1788 1298s
 26163  7039 59555.3638   29  225 56113.0178 63003.1757  12.3%  1786 1329s
 27162  7224 57560.6138   27  318 56113.0178 62905.1682  12.1%  1788 1361s
 28187  7359 60128.7905   34  262 56113.0178 62748.3243  11.8%  1790 1400s
 29290  7520 60045.4818   33  225 56113.0178 62600.6665  11.6%  1790 1435s
 30391  7615     cutoff   32      56113.0178 62474.1535  11.3%  1796 1471s
 31634  7734 56429.2739   33  204 56113.0178 62381.9090  11.2%  1797 1507s
 32829  7751     cutoff   27      56113.0178 62155.9755  10.8%  1797 1539s
 33027  7789 59014.6699   30  319 56113.0178 62142.3240  10.7%  1799 1579s
 34260  7837 56358.8310   34  221 56113.0178 62067.6351  10.6%  1797 1620s
 35705  7882 58136.6478   28  242 56113.0178 61888.5531  10.3%  1796 1663s
 37212  7888 59364.8385   31  262 56113.0178 61668.7828  9.90%  1794 1705s
 38671  7920     cutoff   32      56113.0178 61538.4428  9.67%  1796 1750s
 40233  7837 58013.8466   31  144 56113.0178 61394.0055  9.41%  1795 1800s
 41868  7793 58317.4348   29  177 56113.0178 61197.3829  9.06%  1794 1847s
 43431  7729     cutoff   31      56113.0178 61021.3365  8.75%  1795 1896s
 45236  7584     cutoff   33      56113.0178 60845.4496  8.43%  1792 1945s
 46915  7392     cutoff   33      56113.0178 60655.7761  8.10%  1792 1996s
 48865  7014 56876.8911   32  235 56113.0178 60442.8169  7.72%  1788 2050s
 50846  6599 59189.9600   30  266 56113.0178 60282.3857  7.43%  1784 2108s
 52995  6098 56195.1406   32  216 56113.0178 60000.7776  6.93%  1777 2165s
 55128  5216 57436.0163   35  273 56113.0178 59705.9699  6.40%  1770 2223s
 57650  4138 56861.2562   28  270 56113.0178 59410.4099  5.88%  1757 2285s
 60385  2668     cutoff   35      56113.0178 58982.8513  5.11%  1740 2347s
 63149   849     cutoff   31      56113.0178 58452.5575  4.17%  1716 2404s
 66189  1655     cutoff   37      56113.0178 57342.0951  2.19%  1676 2417s
*66394  1655              70    56115.528862 57342.0951  2.19%  1671 2417s
*68889  1655              83    56151.763715 57227.8613  1.92%  1613 2417s
 75611   150     cutoff   62      56151.7637 56435.1073  0.50%  1476 2424s
*75841   150              85    56156.427258 56435.1073  0.50%  1471 2424s
H77035   150                    56185.397171 56415.2052  0.41%  1449 2424s
 82158     0     cutoff   70      56185.3972 56255.7147  0.13%  1361 2425s

Cutting planes:
  Learned: 1
  Gomory: 4
  MIR: 785
  Mixing: 4
  Flow cover: 1288
  RLT: 18
  Relax-and-lift: 99

Explored 82380 nodes (111934711 simplex iterations) in 2425.32 seconds (8419.31 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 56185.4 56185.4 56156.4 ... 55921.6

Optimal solution found (tolerance 1.00e-04)
Best objective 5.618539717083e+04, best bound 5.618539717083e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2425.39s
  Master Objective (UB) = 56185.40, θ = 235757.57
  Upper Bound (UB) = 56185.40

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 235757.57
  [DEBUG]   ✓ Scenario 0: θ = 235757.57 ≤ Q = 235757.57 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 235757.57 ≤ Q = 235757.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 235757.57 ≤ Q = 235779.56 (slack: 21.99)
  [DEBUG]   ✓ Scenario 3: θ = 235757.57 ≤ Q = 235757.57 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x9161726
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xf6e9e8da
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-01, 2e+02]
Found heuristic solution: objective 1.303478e+13
Presolve removed 2550 rows and 1841 columns
Presolve time: 0.00s
Presolved: 543 rows, 548 columns, 1532 nonzeros
Found heuristic solution: objective 6965155.6301
Variable types: 372 continuous, 176 integer (176 binary)

Root relaxation: objective -1.658698e+05, 263 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -165869.77    0  128 6965155.63 -165869.77   102%     -    0s
H    0     0                    -129477.3997 -165869.77  28.1%     -    0s
H    0     0                    -131804.3696 -165869.77  25.8%     -    0s
H    0     0                    -137155.6120 -150411.06  9.66%     -    0s
H    0     0                    -138974.8936 -150411.06  8.23%     -    0s
     0     0 -150408.85    0  112 -138974.89 -150408.85  8.23%     -    0s
H    0     0                    -146271.0012 -150372.57  2.80%     -    0s
H    0     0                    -148277.0844 -150372.57  1.41%     -    0s
H    0     0                    -148304.3527 -150372.57  1.39%     -    0s
     0     0 -150349.10    0  112 -148304.35 -150349.10  1.38%     -    0s
     0     0 -149316.33    0   92 -148304.35 -149316.33  0.68%     -    0s
     0     0 -149245.39    0   92 -148304.35 -149245.39  0.63%     -    0s
     0     0 -149244.95    0   92 -148304.35 -149244.95  0.63%     -    0s
     0     0 -148848.44    0   58 -148304.35 -148848.44  0.37%     -    0s
     0     0 -148813.48    0   61 -148304.35 -148813.48  0.34%     -    0s
     0     0 -148672.78    0   41 -148304.35 -148672.78  0.25%     -    0s
     0     0 -148656.56    0   44 -148304.35 -148656.56  0.24%     -    0s
H    0     0                    -148345.6815 -148656.56  0.21%     -    0s
H    0     0                    -148354.0186 -148579.28  0.15%     -    0s
     0     0 -148579.28    0   19 -148354.02 -148579.28  0.15%     -    0s
     0     0 -148569.92    0   16 -148354.02 -148569.92  0.15%     -    0s
     0     0 -148542.86    0   14 -148354.02 -148542.86  0.13%     -    0s
     0     0 -148540.95    0   15 -148354.02 -148540.95  0.13%     -    0s
     0     0 -148519.90    0   13 -148354.02 -148519.90  0.11%     -    0s
     0     0 -148519.90    0   35 -148354.02 -148519.90  0.11%     -    0s
     0     0 -148443.61    0    5 -148354.02 -148443.61  0.06%     -    0s
H    0     0                    -148433.5952 -148439.65  0.00%     -    0s

Cutting planes:
  Gomory: 7
  MIR: 8
  Flow cover: 26
  Relax-and-lift: 6

Explored 1 nodes (1023 simplex iterations) in 0.07 seconds (0.06 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -148434 -148354 -148346 ... -129477

Optimal solution found (tolerance 1.00e-04)
Best objective -1.484335952462e+05, best bound -1.484396489032e+05, gap 0.0041%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 218413.07
  Scenario: 45 demand increases, 15 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -148433.60
  [DEBUG]   S×d_nominal = 366846.66
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 366846.66 + -148433.60 = 218413.07
  [DEBUG]   Current θ from Master = 235757.57
  [DEBUG]   ⚠️  Z_SP ≤ θ by 17344.50 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 38840.90
  Lower Bound (LB) = 48673.91
  Gap (UB-LB) = 7511.4889, Absolute Gap = 7511.4889, Relative Gap = 0.133691
  Not converged yet (gap = 7511.49 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 45 increases, 15 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221794 nonzeros
Model fingerprint: 0xbb138462
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 31310 rows and 12710 columns
Presolve time: 0.72s
Presolved: 46523 rows, 20750 columns, 288469 nonzeros
Variable types: 18491 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -285874.8191
Found heuristic solution: objective -222366.7828

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 46523 rows, 20750 columns, 288469 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   33106    3.6243217e+04   0.000000e+00   6.126053e+07      5s
   48888    6.7985841e+04   0.000000e+00   4.081013e+07     10s
Concurrent spin time: 2.49s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 8.889662e+04, 43734 iterations, 11.04 seconds (21.96 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 88896.6161    0   78 -222366.78 88896.6161   140%     -   12s
H    0     0                    -209806.0628 88896.6161   142%     -   12s
H    0     0                    -185209.7837 88896.6161   148%     -   12s
H    0     0                    -181639.9506 88896.6161   149%     -   12s
H    0     0                    -163618.2277 88896.6161   154%     -   12s
H    0     0                    -86100.99076 88896.6161   203%     -   12s
H    0     0                    -84434.69699 88896.6161   205%     -   12s
H    0     0                    -78166.13629 88896.6161   214%     -   12s
H    0     0                    -70991.57136 88896.6161   225%     -   12s
H    0     0                    -64153.91892 88896.6161   239%     -   12s
H    0     0                    -61985.22232 88896.6161   243%     -   12s
H    0     0                    -41006.24509 88896.6161   317%     -   12s
H    0     0                    20727.331528 88896.6161   329%     -   12s
H    0     0                    24711.612687 88896.6161   260%     -   12s
H    0     0                    38233.554971 88896.6161   133%     -   12s
H    0     0                    39759.166138 88896.6161   124%     -   12s
H    0     0                    44447.517328 88896.6161   100%     -   12s
H    0     0                    45848.290986 88896.6161  93.9%     -   12s
H    0     0                    45956.047628 88896.6161  93.4%     -   12s
H    0     0                    46339.792275 88896.6161  91.8%     -   12s
H    0     0                    46493.011069 88896.6161  91.2%     -   12s
H    0     0                    48156.333697 88896.6161  84.6%     -   13s
H    0     0                    48160.503991 88896.5394  84.6%     -   13s
H    0     0                    48435.785800 88896.5394  83.5%     -   13s
H    0     0                    48540.943611 83869.4751  72.8%     -   17s
H    0     0                    48876.703889 83869.4751  71.6%     -   17s
H    0     0                    48952.827349 83869.4751  71.3%     -   17s
     0     0 83869.4751    0  160 48952.8273 83869.4751  71.3%     -   17s
     0     0 83342.2367    0  158 48952.8273 83342.2367  70.3%     -   20s
     0     0 83342.2085    0  172 48952.8273 83342.2085  70.3%     -   21s
     0     0 83342.2085    0  173 48952.8273 83342.2085  70.3%     -   21s
     0     0 83342.2085    0  173 48952.8273 83342.2085  70.3%     -   21s
     0     0 80317.7942    0  248 48952.8273 80317.7942  64.1%     -   26s
H    0     0                    49953.841369 80317.7673  60.8%     -   27s
H    0     0                    49992.935791 80317.7673  60.7%     -   27s
H    0     0                    50027.098217 80317.7673  60.5%     -   27s
H    0     0                    50245.969328 80317.7673  59.8%     -   27s
H    0     0                    50278.409088 80317.7673  59.7%     -   27s
H    0     0                    50306.509500 80317.7673  59.7%     -   27s
     0     0 79701.1988    0  256 50306.5095 79701.1988  58.4%     -   29s
     0     0 79471.8962    0  288 50306.5095 79471.8962  58.0%     -   30s
     0     0 79420.9174    0  284 50306.5095 79420.9174  57.9%     -   32s
     0     0 79397.5101    0  284 50306.5095 79397.5101  57.8%     -   32s
     0     0 79393.9088    0  285 50306.5095 79393.9088  57.8%     -   32s
     0     0 79393.5763    0  285 50306.5095 79393.5763  57.8%     -   32s
H    0     0                    50346.025264 78202.4546  55.3%     -   40s
H    0     0                    50358.885386 78202.4546  55.3%     -   40s
H    0     0                    50571.833134 78202.4546  54.6%     -   40s
     0     0 78202.4546    0  315 50571.8331 78202.4546  54.6%     -   40s
H    0     0                    50624.438115 78202.4233  54.5%     -   41s
     0     0 77815.7097    0  324 50624.4381 77815.7097  53.7%     -   44s
     0     0 77712.3903    0  331 50624.4381 77712.3903  53.5%     -   45s
     0     0 77636.1258    0  330 50624.4381 77636.1258  53.4%     -   47s
     0     0 77620.4145    0  357 50624.4381 77620.4145  53.3%     -   48s
     0     0 77564.2411    0  333 50624.4381 77564.2411  53.2%     -   49s
     0     0 77539.8614    0  335 50624.4381 77539.8614  53.2%     -   49s
     0     0 77497.4314    0  328 50624.4381 77497.4314  53.1%     -   50s
     0     0 77471.9378    0  331 50624.4381 77471.9378  53.0%     -   50s
     0     0 77468.8711    0  333 50624.4381 77468.8711  53.0%     -   51s
     0     0 77467.9300    0  336 50624.4381 77467.9300  53.0%     -   51s
     0     0 76931.0489    0  335 50624.4381 76931.0489  52.0%     -   56s
H    0     0                    50863.343587 76930.2513  51.2%     -   56s
H    0     0                    50865.191964 76930.2513  51.2%     -   56s
     0     0 76570.0009    0  347 50865.1920 76570.0009  50.5%     -   60s
     0     0 76504.1967    0  354 50865.1920 76504.1967  50.4%     -   61s
     0     0 76482.9533    0  365 50865.1920 76482.9533  50.4%     -   62s
     0     0 76452.1952    0  359 50865.1920 76452.1952  50.3%     -   63s
H    0     0                    51037.196448 76442.1187  49.8%     -   64s
     0     0 76442.1187    0  367 51037.1964 76442.1187  49.8%     -   64s
     0     0 76438.3628    0  372 51037.1964 76438.3628  49.8%     -   64s
     0     0 76434.5950    0  373 51037.1964 76434.5950  49.8%     -   64s
     0     0 76434.2777    0  374 51037.1964 76434.2777  49.8%     -   64s
     0     0 76370.1531    0  370 51037.1964 76370.1531  49.6%     -   66s
     0     0 76346.8440    0  372 51037.1964 76346.8440  49.6%     -   67s
     0     0 76335.6428    0  376 51037.1964 76335.6428  49.6%     -   68s
     0     0 76332.3196    0  374 51037.1964 76332.3196  49.6%     -   69s
     0     0 76329.1369    0  375 51037.1964 76329.1369  49.6%     -   69s
     0     0 76328.0066    0  379 51037.1964 76328.0066  49.6%     -   69s
     0     0 76311.4176    0  367 51037.1964 76311.4176  49.5%     -   70s
H    0     0                    51073.480022 76310.2386  49.4%     -   71s
     0     0 76301.7614    0  376 51073.4800 76301.7614  49.4%     -   71s
     0     0 76297.0904    0  377 51073.4800 76297.0904  49.4%     -   72s
     0     0 76295.2151    0  369 51073.4800 76295.2151  49.4%     -   72s
     0     0 76293.4407    0  369 51073.4800 76293.4407  49.4%     -   72s
     0     0 76292.1276    0  370 51073.4800 76292.1276  49.4%     -   72s
     0     0 76276.6720    0  378 51073.4800 76276.6720  49.3%     -   74s
     0     0 76275.0576    0  370 51073.4800 76275.0576  49.3%     -   74s
     0     0 76271.1095    0  370 51073.4800 76271.1095  49.3%     -   75s
     0     0 76270.7080    0  385 51073.4800 76270.7080  49.3%     -   75s
     0     0 76263.2940    0  384 51073.4800 76263.2940  49.3%     -   76s
H    0     0                    52124.716033 76263.2799  46.3%     -   76s
     0     0 76261.8237    0  385 52124.7160 76261.8237  46.3%     -   77s
     0     0 76261.8143    0  385 52124.7160 76261.8143  46.3%     -   77s
     0     0 76261.5955    0  385 52124.7160 76261.5955  46.3%     -   78s
     0     0 76261.5955    0  385 52124.7160 76261.5955  46.3%     -   78s
     0     0 76261.3566    0  385 52124.7160 76261.3566  46.3%     -   79s
H    0     0                    52140.699910 76261.3566  46.3%     -   89s
H    0     0                    52228.158038 76261.3566  46.0%     -   89s
     0     2 76261.3566    0  385 52228.1580 76261.3566  46.0%     -   96s
     3     8 76032.4447    2  364 52228.1580 76133.1639  45.8%  2318  104s
     7    16 75932.5939    3  353 52228.1580 76030.9369  45.6%  3938  110s
    15    32 75677.5284    4  367 52228.1580 75931.8470  45.4%  5907  116s
    31    58 72434.2861    5  340 52228.1580 75677.4682  44.9%  7653  129s
H   57    90                    52484.784206 75677.4682  44.2%  9455  136s
H   75    90                    52726.977775 75677.4682  43.5%  8145  136s
    89   158 73908.8456    7  326 52726.9778 75677.4682  43.5%  7224  144s
   157   282 73301.1349    8  298 52726.9778 75677.4682  43.5%  4990  151s
   281   359 73429.4436   12  308 52726.9778 75677.4682  43.5%  3861  159s
   358   391 73195.0240   13  310 52726.9778 75677.4682  43.5%  3521  164s
   390   433 72365.5190   11  309 52726.9778 75677.4682  43.5%  3444  170s
   464   499 72177.8201   13  280 52726.9778 75677.4682  43.5%  3267  179s
H  490   499                    52731.454380 75677.4682  43.5%  3250  179s
   498   587 72391.5039   13  274 52731.4544 75677.4682  43.5%  3232  186s
   586   672 72958.2037   14  305 52731.4544 75677.4682  43.5%  3034  191s
   675   761 72924.3411   14  303 52731.4544 75677.4682  43.5%  2889  197s
   768   847 72503.9028   15  308 52731.4544 75677.4682  43.5%  2742  204s
   858   952 71984.4188   14  271 52731.4544 75677.4682  43.5%  2598  209s
   977  1068 71114.5048   14  273 52731.4544 75677.4682  43.5%  2409  213s
  1093  1115 72334.6573   16  296 52731.4544 75677.4682  43.5%  2278  217s
H 1095  1115                    52767.037854 75677.4682  43.4%  2275  217s
H 1140  1115                    52868.303015 75677.4682  43.1%  2223  217s
  1154  1176 68299.6261   16  283 52868.3030 75677.4682  43.1%  2213  225s
  1250  1268 72116.4307   17  296 52868.3030 75677.4682  43.1%  2167  231s
  1354  1360 71275.6677   16  281 52868.3030 75677.4682  43.1%  2133  238s
  1470  1470 71454.7850   18  292 52868.3030 75677.4682  43.1%  2080  245s
  1593  1580 65155.9860   19  237 52868.3030 75677.4682  43.1%  2026  253s
  1728  1674 66419.2448   18  240 52868.3030 74885.4882  41.6%  1964  261s
  1858  1779 70586.7553   18  263 52868.3030 74885.4882  41.6%  1936  267s
  1999  1870 67282.0366   19  256 52868.3030 74885.4882  41.6%  1890  277s
  2090  1996 66249.3792   19  241 52868.3030 74885.4882  41.6%  1889  283s
  2246  2027 63655.3950   20  223 52868.3030 74885.4882  41.6%  1846  287s
  2279  2064 65335.8453   20  245 52868.3030 74885.4882  41.6%  1843  291s
  2320  2109 64859.6441   21  236 52868.3030 74885.4882  41.6%  1841  295s
  2365  2163 64544.4282   22  248 52868.3030 74885.4882  41.6%  1833  300s
  2429  2246 64174.3916   23  246 52868.3030 74885.4882  41.6%  1810  305s
  2516  2369 64319.3096   23  248 52868.3030 74885.4882  41.6%  1775  312s
H 2632  2369                    52886.136347 74885.4882  41.6%  1730  312s
  2680  2606 64089.6284   24  214 52886.1363 74885.4882  41.6%  1709  321s
  2967  2778 62908.5371   29  220 52886.1363 74759.9298  41.4%  1622  331s
  3226  2914 62883.0821   29  195 52886.1363 74759.9298  41.4%  1575  340s
  3442  3101 60696.0141   32  208 52886.1363 74759.9298  41.4%  1558  347s
  3674  3102 69757.2328   13  385 52886.1363 74759.9298  41.4%  1543  371s
H 3675  2947                    52934.331326 74759.9298  41.2%  1542  379s
  3677  2948 67211.4336   14  278 52934.3313 74759.9298  41.2%  1542  389s
  3678  2949 57760.7277   75  323 52934.3313 74759.9298  41.2%  1541  395s
  3679  2949 56873.3220   64  316 52934.3313 74759.9298  41.2%  1541  401s
  3681  2951 54184.3137   35  335 52934.3313 74759.9298  41.2%  1540  407s
  3683  2952 57862.5146   89  404 52934.3313 74759.9298  41.2%  1539  411s
H 3686  2806                    52944.563417 74759.9298  41.2%  1538  418s
  3688  2807 55518.0714   55  416 52944.5634 74759.9298  41.2%  1537  421s
  3692  2810 53441.9325   90  389 52944.5634 74759.9298  41.2%  1535  426s
  3695  2812 71273.7180   14  384 52944.5634 74759.9298  41.2%  1534  431s
  3698  2814 67967.6284    8  435 52944.5634 74759.9298  41.2%  1533  436s
  3701  2816 63737.0822   41  424 52944.5634 74759.9298  41.2%  1532  440s
H 3702  2676                    52947.414419 74759.9298  41.2%  1531  444s
  3704  2677 58469.6682   23  420 52947.4144 74759.9298  41.2%  1530  445s
  3708  2680 70062.4862   19  454 52947.4144 74759.9298  41.2%  1529  450s
  3710  2681 67934.9118   24  454 52947.4144 74759.9298  41.2%  1528  462s
H 3710  2546                    53077.621974 74759.9298  40.9%  1528  473s
H 3711  2421                    53115.763287 74759.9298  40.7%  1559  474s
  3712  2422 74759.9298   10  390 53115.7633 74759.9298  40.7%  1560  482s
  3714  2426 74759.9298   11  387 53115.7633 74759.9298  40.7%  1562  497s
  3718  2432 74759.9298   12  391 53115.7633 74759.9298  40.7%  1566  506s
  3726  2446 74339.1697   13  394 53115.7633 74759.9298  40.7%  1581  514s
  3742  2457 74088.0818   14  388 53115.7633 74338.2798  40.0%  1612  531s
  3759  2484 73803.3991   15  374 53115.7633 74264.9872  39.8%  1673  541s
  3791  2581 73427.4998   16  371 53115.7633 74264.9872  39.8%  1712  554s
  3899  2633 71308.4255   17  297 53115.7633 74264.9872  39.8%  1816  564s
  3987  2662 68507.1364   18  360 53115.7633 74264.9872  39.8%  1838  575s
  4059  2667 67689.6778   19  335 53115.7633 74264.9872  39.8%  1849  584s
  4093  2685 66392.2419   19  299 53115.7633 73829.5360  39.0%  1859  593s
  4137  2700 66763.4723   20  333 53115.7633 73828.7799  39.0%  1869  600s
  4182  2708 66670.1162   21  318 53115.7633 73828.7799  39.0%  1877  609s
  4234  2716 66306.3712   22  317 53115.7633 73828.7799  39.0%  1879  617s
  4283  2722 65559.6935   23  320 53115.7633 73828.7799  39.0%  1892  626s
  4337  2731 63652.5137   24  297 53115.7633 73253.4598  37.9%  1896  634s
  4403  2746 63423.5085   25  267 53115.7633 73253.4598  37.9%  1902  642s
  4467  2759 62675.7762   26  274 53115.7633 73253.4598  37.9%  1905  649s
  4535  2782 61546.3174   27  237 53115.7633 72778.3280  37.0%  1919  657s
  4616  2790 61118.6481   28  232 53115.7633 72759.3342  37.0%  1929  667s
  4691  2807     cutoff   29      53115.7633 72759.3342  37.0%  1940  674s
  4760  2822 58697.5468   32  215 53115.7633 72759.3342  37.0%  1960  681s
  4807  2855 55779.6025   32  235 53115.7633 72759.3342  37.0%  1966  689s
H 4849  2720                    53248.090570 72759.3342  36.6%  1970  689s
  4870  2761 58590.3050   33  189 53248.0906 72759.3342  36.6%  1973  698s
  4989  2773 57941.9210   35  160 53248.0906 72517.8446  36.2%  1969  707s
  5101  2794     cutoff   37      53248.0906 72357.7862  35.9%  1971  716s
  5223  2814 54720.7771   40   86 53248.0906 72357.7862  35.9%  1974  728s
  5367  2827     cutoff   46      53248.0906 71202.6898  33.7%  1970  737s
  5494  2852 68870.3368   17  334 53248.0906 71087.9450  33.5%  1979  745s
* 5572  2710              63    53297.905815 71087.9450  33.4%  1988  745s
  5608  2783 63157.7064   19  285 53297.9058 71024.6989  33.3%  1990  755s
  5740  2813 57268.9628   22  204 53297.9058 70874.9508  33.0%  2001  765s
  5890  2849     cutoff   25      53297.9058 70874.9508  33.0%  2000  773s
  6052  2859 54536.0309   24  168 53297.9058 70414.7683  32.1%  2001  785s
  6232  2870 61625.5552   19  268 53297.9058 70414.7683  32.1%  2004  797s
  6360  2925 60495.4471   21  248 53297.9058 69820.8995  31.0%  2020  807s
  6513  2981 55170.6177   24  192 53297.9058 69820.8995  31.0%  2029  818s
  6710  3025 53613.6219   26   90 53297.9058 69642.9332  30.7%  2024  831s
  6954  2964 65400.3281   15  394 53297.9058 69642.9332  30.7%  2007  838s
H 6959  2853                    53299.008428 69642.9332  30.7%  2008  838s
H 6964  2745                    53377.592517 69043.6364  29.3%  2009  838s
H 6965  2638                    53467.082364 69043.6364  29.1%  2009  838s
  6996  2733 63986.2136   16  301 53467.0824 68915.6378  28.9%  2014  852s
  7183  2792 62167.1655   19  321 53467.0824 68783.5202  28.6%  2016  865s
H 7372  2493                    54376.557515 68195.9010  25.4%  2016  865s
  7401  2522 58985.3733   25  250 54376.5575 68195.9010  25.4%  2014  879s
  7614  2540 56017.3894   31  184 54376.5575 67856.5346  24.8%  2022  893s
  7804  2514 61833.6803   23  320 54376.5575 67841.1472  24.8%  2032  907s
H 7839  2384                    54489.294846 67841.1472  24.5%  2032  907s
  7940  2430 60574.0427   24  268 54489.2948 67841.1472  24.5%  2036  921s
  8154  2452     cutoff   33      54489.2948 67409.4443  23.7%  2048  935s
  8363  2451 63272.4855   20  382 54489.2948 67409.4443  23.7%  2062  951s
  8601  2466 56671.6211   23  239 54489.2948 67409.4443  23.7%  2075  967s
  8818  2500 64479.7187   19  295 54489.2948 67189.6948  23.3%  2098  984s
  9042  2575 59803.1922   25  191 54489.2948 66873.1496  22.7%  2117 1001s
  9348  2601     cutoff   49      54489.2948 66829.3678  22.6%  2122 1018s
  9574  2669 56910.8557   24  307 54489.2948 66526.2556  22.1%  2121 1037s
  9911  2726     cutoff   30      54489.2948 66207.8346  21.5%  2126 1057s
 10207  2785 59490.8331   24  287 54489.2948 65912.1966  21.0%  2143 1078s
 10489  2861 54698.7208   27  232 54489.2948 65702.2591  20.6%  2168 1099s
 10798  2916 57693.4157   21  238 54489.2948 65702.2591  20.6%  2187 1119s
 11122  2952     cutoff   24      54489.2948 65687.1850  20.6%  2205 1143s
H11165  2921                    54615.211724 65686.3924  20.3%  2207 1143s
 11263  3006     cutoff   27      54615.2117 65497.6113  19.9%  2213 1162s
 11657  3126 55313.0240   36  107 54615.2117 65126.6511  19.2%  2221 1184s
 12098  3202 54667.9310   22  291 54615.2117 64933.7252  18.9%  2227 1209s
 12484  3317     cutoff   22      54615.2117 64862.2033  18.8%  2243 1231s
 12901  3417 56903.9731   20  329 54615.2117 64386.3782  17.9%  2253 1256s
 13343  3438 59494.2576   21  366 54615.2117 64386.3782  17.9%  2264 1281s
 13922  3476 55609.1840   30  233 54615.2117 64054.4991  17.3%  2263 1309s
 14393  3562     cutoff   26      54615.2117 63748.8842  16.7%  2277 1335s
H14595  3542                    54658.172366 63748.8842  16.6%  2282 1335s
H14715  3517                    54752.988239 63741.7329  16.4%  2283 1335s
 14856  3592 58080.3143   24  223 54752.9882 63741.7329  16.4%  2282 1363s
 15302  3659     cutoff   23      54752.9882 63726.8302  16.4%  2285 1389s
 15873  3703 58162.3827   22  332 54752.9882 63292.3791  15.6%  2292 1420s
 16084  3780 56205.9511   23  286 54752.9882 63256.3320  15.5%  2298 1450s
 16621  3805     cutoff   22      54752.9882 63151.5301  15.3%  2316 1489s
 17228  3908 55294.7221   25  317 54752.9882 62917.6382  14.9%  2327 1519s
 17890  4001 57209.2810   22  274 54752.9882 62646.7195  14.4%  2335 1555s
 18598  4035 55272.8999   25  168 54752.9882 62456.4750  14.1%  2337 1595s
 19297  4081 56693.4060   23  202 54752.9882 62332.2000  13.8%  2345 1632s
 20063  4163     cutoff   21      54752.9882 62026.7941  13.3%  2349 1668s
 20815  4163 57963.2696   24  280 54752.9882 61810.7815  12.9%  2354 1702s
H20860  4157                    54767.003188 61785.0561  12.8%  2355 1702s
 20878  4155 57303.8485   25  299 54767.0032 61785.0561  12.8%  2355 1738s
 21819  4206 57069.5257   23  312 54767.0032 61605.0588  12.5%  2349 1777s
 22744  4185 infeasible   24      54767.0032 61363.1256  12.0%  2346 1818s
H22977  4184                    54773.881664 61319.2065  11.9%  2348 1818s
 23290  4212     cutoff   19      54773.8817 61185.8331  11.7%  2348 1861s
H24296  4219                    54822.064223 60992.7206  11.3%  2346 1902s
 24880  4140 55997.4132   25  260 54822.0642 60829.8640  11.0%  2348 1950s
 25881  4099 infeasible   29      54822.0642 60536.6083  10.4%  2351 1997s
 26593  4064 56190.1863   25  246 54822.0642 60345.1365  10.1%  2351 2046s
 27841  3976     cutoff   23      54822.0642 60042.0828  9.52%  2342 2094s
 29048  3823 56499.8820   22  282 54822.0642 59778.7365  9.04%  2340 2146s
 30449  3636     cutoff   23      54822.0642 59427.3826  8.40%  2326 2198s
 31868  3303 56814.0244   25  361 54822.0642 59055.6693  7.72%  2314 2259s
 33348  2880 55626.9230   26  303 54822.0642 58716.3240  7.10%  2302 2315s
 34988  2285 56349.1028   30  237 54822.0642 58290.9579  6.33%  2282 2369s
 36912  1138 infeasible   31      54822.0642 57697.0567  5.24%  2249 2426s
 39401   776     cutoff   22      54822.0642 56748.9305  3.51%  2184 2473s
H39405   776                    55013.452771 56748.9305  3.15%  2184 2473s
H39514   776                    55016.853034 56659.5450  2.99%  2181 2473s
H39545   776                    55074.558876 56658.1983  2.88%  2180 2473s
H39730   776                    55162.291347 56583.9701  2.58%  2173 2473s
 39942   407     cutoff   23      55162.2913 56385.0700  2.22%  2166 2491s
 43016    73 55289.6724   48   29 55162.2913 55382.6546  0.40%  2018 2499s

Cutting planes:
  Learned: 2
  Gomory: 1
  MIR: 925
  Mixing: 2
  Flow cover: 1663
  RLT: 18
  Relax-and-lift: 141

Explored 46614 nodes (87159815 simplex iterations) in 2499.76 seconds (8355.18 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 55162.3 55162.3 55074.6 ... 54658.2

Optimal solution found (tolerance 1.00e-04)
Best objective 5.516229134729e+04, best bound 5.516229134729e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 2499.77s
  Master Objective (UB) = 55162.29, θ = 216288.44
  Upper Bound (UB) = 55162.29

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 216288.44
  [DEBUG]   ✓ Scenario 0: θ = 216288.44 ≤ Q = 216288.44 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 216288.44 ≤ Q = 216288.44 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 216288.44 ≤ Q = 216288.44 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 216288.44 ≤ Q = 216288.44 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 216288.44 ≤ Q = 216288.44 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0xdca2b69
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x0dca2b69
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [7e-01, 2e+02]
Found heuristic solution: objective 1.251932e+13
Presolve removed 2555 rows and 1845 columns
Presolve time: 0.00s
Presolved: 538 rows, 544 columns, 1519 nonzeros
Found heuristic solution: objective 6573220.1127
Variable types: 369 continuous, 175 integer (175 binary)
Found heuristic solution: objective 6572856.8603

Root relaxation: objective -1.637109e+05, 267 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -163710.86    0  133 6572856.86 -163710.86   102%     -    0s
H    0     0                    -129965.9609 -163710.86  26.0%     -    0s
H    0     0                    -131033.3219 -163710.86  24.9%     -    0s
H    0     0                    -131178.0884 -163449.25  24.6%     -    0s
     0     0 -144972.77    0   97 -131178.09 -144972.77  10.5%     -    0s
H    0     0                    -142595.9300 -144971.82  1.67%     -    0s
     0     0 -144518.14    0   79 -142595.93 -144518.14  1.35%     -    0s
     0     0 -144373.87    0   69 -142595.93 -144373.87  1.25%     -    0s
H    0     0                    -143245.7000 -144298.93  0.74%     -    0s
     0     0 -144298.93    0   68 -143245.70 -144298.93  0.74%     -    0s
     0     0 -144113.43    0   73 -143245.70 -144113.43  0.61%     -    0s
     0     0 -144107.38    0   71 -143245.70 -144107.38  0.60%     -    0s
H    0     0                    -143257.2701 -144071.94  0.57%     -    0s
     0     0 -144071.94    0   71 -143257.27 -144071.94  0.57%     -    0s
     0     0 -144063.94    0   71 -143257.27 -144063.94  0.56%     -    0s
     0     2 -144051.97    0   71 -143257.27 -144051.97  0.55%     -    0s
H   98   100                    -143273.8542 -143626.03  0.25%  10.4    0s
H  110   100                    -143294.5382 -143608.11  0.22%  10.1    0s
*  884   160              34    -143313.2861 -143518.18  0.14%   5.9    0s
*  938   100              32    -143338.1626 -143518.18  0.13%   5.7    0s

Cutting planes:
  Gomory: 47
  MIR: 113
  Flow cover: 21
  RLT: 45

Explored 1245 nodes (6865 simplex iterations) in 0.16 seconds (0.11 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -143338 -143313 -143295 ... -129966

Optimal solution found (tolerance 1.00e-04)
Best objective -1.433381626163e+05, best bound -1.433420634645e+05, gap 0.0027%
  Subproblem solved in 0.18s
  Worst-case operational profit (Z_SP) = 200447.94
  Scenario: 21 demand increases, 39 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -143338.16
  [DEBUG]   S×d_nominal = 343786.10
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 343786.10 + -143338.16 = 200447.94
  [DEBUG]   Current θ from Master = 216288.44
  [DEBUG]   ⚠️  Z_SP ≤ θ by 15840.50 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 39321.79
  Lower Bound (LB) = 48673.91
  Gap (UB-LB) = 6488.3831, Absolute Gap = 6488.3831, Relative Gap = 0.117624
  Not converged yet (gap = 6488.38 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 21 increases, 39 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 265049 nonzeros
Model fingerprint: 0xe266eeec
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 37572 rows and 15252 columns
Presolve time: 0.89s
Presolved: 55551 rows, 24448 columns, 345059 nonzeros
Variable types: 22189 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -285874.8191
Found heuristic solution: objective -222366.7828

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 55551 rows, 24448 columns, 345059 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   36259    5.5694855e+04   0.000000e+00   4.837458e+06      5s
   52170    7.8136315e+04   0.000000e+00   4.088514e+07     10s
   66230    8.5443409e+04   0.000000e+00   1.804296e+06     15s
   80333    8.7830855e+04   0.000000e+00   1.915353e+08     20s
Concurrent spin time: 0.50s

Solved with dual simplex

Root relaxation: objective 8.821577e+04, 49331 iterations, 20.47 seconds (42.66 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 88215.7738    0   82 -222366.78 88215.7738   140%     -   21s
H    0     0                    -215817.5746 88215.7738   141%     -   21s
H    0     0                    -134310.9899 88215.7738   166%     -   21s
H    0     0                    -127925.0988 88215.7738   169%     -   22s
H    0     0                    -127822.7915 88215.7738   169%     -   22s
H    0     0                    -127203.1983 88215.7738   169%     -   22s
H    0     0                    -126434.1582 88215.7738   170%     -   22s
H    0     0                    -39003.84381 88215.7738   326%     -   22s
H    0     0                    -38686.78942 88215.7738   328%     -   22s
H    0     0                    8138.0353220 88215.7738   984%     -   22s
H    0     0                    23401.347597 88215.7738   277%     -   22s
H    0     0                    23488.147915 88215.7738   276%     -   22s
H    0     0                    33270.281121 88215.7738   165%     -   22s
H    0     0                    36633.889855 88215.7738   141%     -   22s
H    0     0                    43012.811142 88215.7738   105%     -   22s
H    0     0                    43204.756699 88215.7738   104%     -   22s
H    0     0                    43280.031242 88215.7738   104%     -   22s
H    0     0                    43900.080983 88215.7738   101%     -   22s
H    0     0                    43939.490233 88215.7738   101%     -   22s
H    0     0                    44324.354790 88215.7738  99.0%     -   22s
H    0     0                    44998.943681 88215.7738  96.0%     -   22s
H    0     0                    45538.780301 88215.7738  93.7%     -   22s
H    0     0                    47831.982657 88215.7738  84.4%     -   22s
H    0     0                    48044.754228 88215.7738  83.6%     -   23s
H    0     0                    48338.913822 88215.7738  82.5%     -   23s
H    0     0                    48489.706515 82861.6981  70.9%     -   30s
H    0     0                    48494.223344 82861.6981  70.9%     -   30s
H    0     0                    48499.651264 82861.6981  70.9%     -   30s
     0     0 82853.1776    0  133 48499.6513 82853.1776  70.8%     -   30s
     0     0 82210.6183    0  205 48499.6513 82210.6183  69.5%     -   34s
     0     0 82210.6183    0  201 48499.6513 82210.6183  69.5%     -   35s
     0     0 82210.6183    0  205 48499.6513 82210.6183  69.5%     -   35s
H    0     0                    48553.123389 79274.3979  63.3%     -   43s
     0     0 79273.6303    0  252 48553.1234 79273.6303  63.3%     -   43s
     0     0 78615.6989    0  282 48553.1234 78615.6989  61.9%     -   50s
     0     0 78476.3880    0  274 48553.1234 78476.3880  61.6%     -   52s
     0     0 78464.4636    0  283 48553.1234 78464.4636  61.6%     -   52s
     0     0 78458.2378    0  284 48553.1234 78458.2378  61.6%     -   53s
     0     0 78457.2845    0  285 48553.1234 78457.2845  61.6%     -   53s
H    0     0                    48784.532968 77337.0375  58.5%     -   66s
     0     0 77337.0375    0  334 48784.5330 77337.0375  58.5%     -   66s
     0     0 76847.8657    0  338 48784.5330 76847.8657  57.5%     -   70s
     0     0 76753.1777    0  315 48784.5330 76753.1777  57.3%     -   72s
     0     0 76725.6827    0  340 48784.5330 76725.6827  57.3%     -   74s
     0     0 76713.4220    0  336 48784.5330 76713.4220  57.2%     -   74s
     0     0 76703.6009    0  333 48784.5330 76703.6009  57.2%     -   75s
     0     0 76701.6845    0  334 48784.5330 76701.6845  57.2%     -   75s
     0     0 76700.0933    0  341 48784.5330 76700.0933  57.2%     -   76s
     0     0 76699.1123    0  342 48784.5330 76699.1123  57.2%     -   76s
     0     0 76187.4991    0  356 48784.5330 76187.4991  56.2%     -   84s
     0     0 76053.5655    0  374 48784.5330 76053.5655  55.9%     -   87s
     0     0 75975.3572    0  335 48784.5330 75975.3572  55.7%     -   90s
     0     0 75925.1670    0  339 48784.5330 75925.1670  55.6%     -   92s
     0     0 75903.6742    0  350 48784.5330 75903.6742  55.6%     -   94s
     0     0 75890.9197    0  346 48784.5330 75890.9197  55.6%     -   95s
     0     0 75886.3237    0  352 48784.5330 75886.3237  55.6%     -   95s
H    0     0                    50218.831594 75884.3313  51.1%     -   95s
H    0     0                    50357.941431 75884.3313  50.7%     -   95s
     0     0 75884.3313    0  354 50357.9414 75884.3313  50.7%     -   95s
H    0     0                    51101.471493 75882.7661  48.5%     -   96s
     0     0 75882.7661    0  344 51101.4715 75882.7661  48.5%     -   96s
     0     0 75882.1825    0  351 51101.4715 75882.1825  48.5%     -   96s
H    0     0                    51243.456094 75882.1825  48.1%     -   96s
H    0     0                    51332.986942 75801.6413  47.7%     -   99s
H    0     0                    51657.523027 75801.6413  46.7%     -   99s
     0     0 75801.6413    0  340 51657.5230 75801.6413  46.7%     -   99s
H    0     0                    51721.636302 75799.8040  46.6%     -   99s
     0     0 75786.8311    0  354 51721.6363 75786.8311  46.5%     -  101s
     0     0 75781.7875    0  353 51721.6363 75781.7875  46.5%     -  101s
H    0     0                    51744.924053 75780.6180  46.5%     -  102s
H    0     0                    51910.043137 75780.6180  46.0%     -  102s
     0     0 75780.6180    0  362 51910.0431 75780.6180  46.0%     -  102s
     0     0 75738.0004    0  361 51910.0431 75738.0004  45.9%     -  104s
H    0     0                    51998.782179 75734.5559  45.6%     -  106s
H    0     0                    52106.487389 75734.5559  45.3%     -  106s
H    0     0                    52120.351473 75734.5559  45.3%     -  106s
     0     0 75710.2532    0  341 52120.3515 75710.2532  45.3%     -  107s
     0     0 75707.6906    0  367 52120.3515 75707.6906  45.3%     -  108s
     0     0 75707.1933    0  350 52120.3515 75707.1933  45.3%     -  108s
     0     0 75677.1590    0  360 52120.3515 75677.1590  45.2%     -  109s
     0     0 75669.0468    0  366 52120.3515 75669.0468  45.2%     -  110s
     0     0 75667.3544    0  372 52120.3515 75667.3544  45.2%     -  111s
     0     0 75666.7372    0  360 52120.3515 75666.7372  45.2%     -  111s
     0     0 75595.1781    0  363 52120.3515 75595.1781  45.0%     -  113s
     0     0 75592.9375    0  365 52120.3515 75592.9375  45.0%     -  116s
     0     0 75591.5223    0  364 52120.3515 75591.5223  45.0%     -  116s
     0     0 75586.4386    0  367 52120.3515 75586.4386  45.0%     -  117s
     0     0 75584.5904    0  374 52120.3515 75584.5904  45.0%     -  118s
     0     0 75584.2945    0  376 52120.3515 75584.2945  45.0%     -  118s
     0     0 75576.4666    0  365 52120.3515 75576.4666  45.0%     -  119s
     0     0 75574.7076    0  374 52120.3515 75574.7076  45.0%     -  120s
     0     0 75574.4650    0  374 52120.3515 75574.4650  45.0%     -  120s
     0     0 75573.2587    0  372 52120.3515 75573.2587  45.0%     -  120s
     0     0 75570.9862    0  372 52120.3515 75570.9862  45.0%     -  121s
     0     2 75570.9862    0  372 52120.3515 75570.9862  45.0%     -  137s
     1     4 75364.7102    1  355 52120.3515 75570.9862  45.0%  4002  140s
     7    16 75135.7220    3  365 52120.3515 75231.8866  44.3%  3811  148s
    15    32 75084.2441    4  364 52120.3515 75134.9011  44.2%  4075  155s
    31    49 74034.1317    5  330 52120.3515 75084.1190  44.1%  5823  167s
    48    81 74413.9231    6  347 52120.3515 75084.1190  44.1%  5488  175s
H   49    81                    52196.396511 75084.1190  43.8%  5376  175s
H   57    81                    52305.056449 75084.1190  43.6%  5292  175s
H   78    81                    52325.689008 75084.1190  43.5%  4272  175s
    80   113 74388.6874    7  338 52325.6890 75084.1190  43.5%  4213  196s
   112   250 74302.4918    8  333 52325.6890 75084.1190  43.5%  3471  208s
   249   345 73950.7292   10  321 52325.6890 75084.1190  43.5%  2716  215s
   344   426 73985.9153   11  314 52325.6890 75084.1190  43.5%  2582  222s
   425   505 73864.2972   11  319 52325.6890 75084.1190  43.5%  2418  229s
   504   591 73814.0201   13  314 52325.6890 75084.1190  43.5%  2357  236s
   590   657 73659.5160   13  320 52325.6890 75084.1190  43.5%  2258  243s
   656   689 72462.7506   13  294 52325.6890 75084.1190  43.5%  2271  248s
   688   726 72649.9071   12  294 52325.6890 75084.1190  43.5%  2273  255s
   725   758 73564.0581   14  315 52325.6890 75084.1190  43.5%  2280  262s
   757   791 72048.7812   14  297 52325.6890 75084.1190  43.5%  2343  269s
H  761   791                    52367.536924 75084.1190  43.4%  2342  269s
   790   823 72374.8332   13  300 52367.5369 75084.1190  43.4%  2349  274s
   822   857 72462.1917   15  346 52367.5369 75084.1190  43.4%  2335  282s
   856   893 68673.1709   15  290 52367.5369 75084.1190  43.4%  2318  286s
   892   932 72142.5097   14  286 52367.5369 75084.1190  43.4%  2297  293s
   931   970 70606.7947   16  283 52367.5369 75084.1190  43.4%  2278  299s
   969  1009 71050.5660   16  313 52367.5369 75084.1190  43.4%  2252  306s
  1008  1046 71314.9852   15  310 52367.5369 75084.1190  43.4%  2237  313s
H 1018  1046                    52417.205480 75084.1190  43.2%  2237  313s
  1047  1185 69135.7897   15  288 52417.2055 75084.1190  43.2%  2219  321s
  1200  1277 70577.5488   17  301 52417.2055 75084.1190  43.2%  2045  329s
  1364  1362 69655.2463   17  327 52417.2055 75084.1190  43.2%  1911  338s
  1514  1435 66257.9422   18  318 52417.2055 75084.1190  43.2%  1828  348s
  1633  1540 62899.6981   17  287 52417.2055 75084.1190  43.2%  1812  356s
  1759  1619 70242.3884   18  288 52417.2055 75084.1190  43.2%  1789  366s
  1903  1702 60008.1374   19  231 52417.2055 75084.1190  43.2%  1762  377s
  2035  1722 63259.1389   20  218 52417.2055 75084.1190  43.2%  1740  385s
  2077  1752 62112.0954   19  264 52417.2055 75084.1190  43.2%  1764  394s
  2109  1785 55479.4245   23  250 52417.2055 75084.1190  43.2%  1779  403s
H 2144  1821                    52429.317070 75084.1190  43.2%  1799  410s
H 2173  1821                    52434.381496 75084.1190  43.2%  1809  410s
  2181  1944 54413.4596   21  224 52434.3815 75084.1190  43.2%  1811  418s
  2322  2072 60932.7145   23  246 52434.3815 75084.1190  43.2%  1791  429s
  2498  2116 54998.6993   22  219 52434.3815 74985.0795  43.0%  1759  435s
H 2499  2115                    52627.810361 74985.0795  42.5%  1758  435s
H 2512  2115                    52664.565141 74985.0795  42.4%  1760  435s
  2547  2289 60794.9132   24  243 52664.5651 74985.0795  42.4%  1760  446s
  2769  2504 59261.7760   24  225 52664.5651 74985.0795  42.4%  1701  457s
  3038  2739 56073.8184   25  187 52664.5651 74985.0795  42.4%  1633  468s
H 3336  2739                    52664.571455 74985.0795  42.4%  1563  472s
H 3336  2738                    52690.578737 74985.0795  42.3%  1563  472s
  3337  2739 71779.7067   13  372 52690.5787 74985.0795  42.3%  1563  498s
  3339  2740 59193.3973   49   82 52690.5787 74985.0795  42.3%  1562  518s
  3340  2741 54690.1849   53  276 52690.5787 74985.0795  42.3%  1561  532s
  3341  2742 65236.2547   17  333 52690.5787 74985.0795  42.3%  1561  541s
  3342  2742 55496.0268   69  326 52690.5787 74985.0795  42.3%  1560  546s
  3343  2743 55698.5442   62  337 52690.5787 74985.0795  42.3%  1560  552s
  3344  2744 71341.7678   15  354 52690.5787 74985.0795  42.3%  1559  556s
  3346  2745 68809.4094   10  370 52690.5787 74985.0795  42.3%  1558  560s
  3349  2747 64172.5046   40  402 52690.5787 74985.0795  42.3%  1557  566s
  3353  2750 56532.1866   59  368 52690.5787 74985.0795  42.3%  1555  570s
  3356  2752 56565.8290   56  404 52690.5787 74985.0795  42.3%  1554  576s
  3360  2754 61696.1938   10  395 52690.5787 74985.0795  42.3%  1552  580s
  3364  2757 64183.4918   10  364 52690.5787 74985.0795  42.3%  1550  587s
  3366  2758 60389.9248   23  359 52690.5787 74985.0795  42.3%  1549  590s
  3370  2761 71038.7379   19  369 52690.5787 74985.0795  42.3%  1547  595s
  3373  2763 61398.6073   21  357 52690.5787 74985.0795  42.3%  1546  600s
  3376  2765 54128.3005   29  368 52690.5787 74985.0795  42.3%  1545  621s
  3377  2766 71022.0704   14  368 52690.5787 74985.0795  42.3%  1544  634s
  3378  2769 74985.0795   12  349 52690.5787 74985.0795  42.3%  1580  657s
  3380  2773 74985.0795   13  349 52690.5787 74985.0795  42.3%  1585  668s
  3384  2779 74895.2056   14  355 52690.5787 74985.0795  42.3%  1589  681s
  3392  2793 74421.0239   15  357 52690.5787 74894.7537  42.1%  1603  696s
  3408  2807 70559.2854   16  298 52690.5787 74420.8465  41.2%  1659  718s
  3428  2833 70530.9245   17  338 52690.5787 74420.8465  41.2%  1705  736s
  3460  2917 70185.8123   18  387 52690.5787 74420.8465  41.2%  1745  757s
  3555  2972 68971.3038   20  317 52690.5787 74420.8465  41.2%  1818  770s
  3642  3025 69615.5062   20  318 52690.5787 74420.8465  41.2%  1877  782s
  3729  3022 65943.3364   21  267 52690.5787 74420.8465  41.2%  1910  792s
  3764  3044 68830.0273   21  289 52690.5787 74420.8465  41.2%  1927  802s
  3815  3058 65415.0107   22  268 52690.5787 74420.8465  41.2%  1937  813s
H 3819  2917                    52720.140687 74420.8465  41.2%  1936  813s
  3856  2990 58802.9113   22  261 52720.1407 74420.8465  41.2%  1942  823s
  3964  3010 69097.5638   21  305 52720.1407 74420.8465  41.2%  1942  835s
  4053  3039 68418.9370   22  312 52720.1407 74420.8465  41.2%  1949  846s
  4150  3068 64022.2123   22  249 52720.1407 73869.5050  40.1%  1942  862s
  4247  3083 67906.0999   22  299 52720.1407 73666.7559  39.7%  1944  876s
  4335  3105 63392.8400   23  286 52720.1407 73032.0306  38.5%  1952  886s
  4418  3117 65181.1155   22  285 52720.1407 73032.0306  38.5%  1962  896s
  4501  3130 63005.0214   24  271 52720.1407 72886.2627  38.3%  1965  908s
  4583  3151 62275.8612   24  232 52720.1407 72886.2627  38.3%  1973  920s
  4662  3181 62395.1561   27  235 52720.1407 72886.2627  38.3%  1994  932s
  4750  3203 61032.1504   27  186 52720.1407 72531.3791  37.6%  2014  943s
  4841  3198 60471.9361   31  188 52720.1407 72531.3791  37.6%  2028  953s
  4878  3220 59927.9680   32  183 52720.1407 72531.3791  37.6%  2042  962s
  4928  3243 58390.5312   33  195 52720.1407 72531.3791  37.6%  2055  971s
  5001  3275 58835.5201   31  161 52720.1407 72531.3791  37.6%  2062  982s
  5098  3316 58297.6025   32  175 52720.1407 72531.3791  37.6%  2070  997s
  5231  3292 57403.6755   37  162 52720.1407 72531.3791  37.6%  2072 1012s
  5325  3312 55621.0674   41  149 52720.1407 72531.3791  37.6%  2069 1024s
  5431  3343 54376.5671   44  148 52720.1407 72336.5735  37.2%  2087 1037s
  5546  3374     cutoff   48      52720.1407 72336.5735  37.2%  2104 1052s
  5689  3408 58292.3578   24  337 52720.1407 72336.5735  37.2%  2112 1066s
  5861  3439 54465.0012   26  331 52720.1407 72336.5735  37.2%  2114 1080s
  6058  3445     cutoff   29      52720.1407 72336.5735  37.2%  2104 1095s
  6254  3469 53429.7871   31  291 52720.1407 70530.6247  33.8%  2104 1111s
  6406  3474 61634.5745   21  316 52720.1407 70503.5365  33.7%  2119 1126s
H 6484  3261                    53907.508467 70503.5365  30.8%  2129 1126s
  6509  3296 57397.4690   22  295 53907.5085 70503.5365  30.8%  2127 1144s
  6683  3295 infeasible   23      53907.5085 69796.8910  29.5%  2141 1167s
  6863  3297 57382.0356   23  272 53907.5085 69489.5844  28.9%  2154 1187s
  7059  3297 56182.8862   24  267 53907.5085 69438.4084  28.8%  2167 1205s
  7251  3343 55870.3402   25  254 53907.5085 68926.5722  27.9%  2178 1225s
  7435  3374 infeasible   26      53907.5085 68456.4561  27.0%  2201 1244s
  7689  3346 63136.9800   19  259 53907.5085 68352.9399  26.8%  2211 1263s
H 7692  3202                    54068.698129 68352.9399  26.4%  2211 1263s
H 7709  3057                    54185.121690 68352.9399  26.1%  2211 1263s
  7773  3125 63046.4129   20  247 54185.1217 68256.2829  26.0%  2218 1284s
  7991  3078 infeasible   24      54185.1217 68207.2442  25.9%  2235 1301s
H 7997  2947                    54314.214511 68207.2442  25.6%  2234 1301s
H 8001  2820                    54383.486958 68207.2442  25.4%  2234 1301s
  8029  2938 60375.6936   24  159 54383.4870 68207.2442  25.4%  2240 1322s
  8302  2930 57265.9661   33  103 54383.4870 68207.2442  25.4%  2247 1346s
  8570  2949     cutoff   33      54383.4870 67863.1353  24.8%  2261 1369s
  8846  2980 62131.5576   24  238 54383.4870 67863.1353  24.8%  2272 1393s
  9105  3002 58486.7587   29  239 54383.4870 67397.4456  23.9%  2287 1417s
  9403  2985 54526.4274   24  213 54383.4870 66545.0890  22.4%  2296 1442s
H 9409  2946                    54470.985840 66545.0890  22.2%  2296 1442s
  9624  3073 63356.6531   22  279 54470.9858 66437.0344  22.0%  2309 1471s
  9899  3226 62807.3396   23  299 54470.9858 66425.2702  21.9%  2335 1499s
 10259  3420 60393.5631   25  236 54470.9858 66294.5899  21.7%  2342 1530s
 10642  3559 56188.0909   32  142 54470.9858 65876.3011  20.9%  2346 1558s
 11014  3703 57348.3206   20  308 54470.9858 65569.1538  20.4%  2359 1588s
 11392  3859     cutoff   27      54470.9858 65494.2114  20.2%  2364 1619s
 11795  3966 56175.5298   31  152 54470.9858 64961.3071  19.3%  2374 1651s
 12130  4087 57346.1090   24  293 54470.9858 64829.0864  19.0%  2387 1682s
 12475  4290 55992.3816   26  213 54470.9858 64829.0864  19.0%  2397 1721s
 12952  4431 61265.1776   25  321 54470.9858 64549.8496  18.5%  2404 1758s
 13402  4638     cutoff   34      54470.9858 64344.2562  18.1%  2412 1793s
 13916  4786 57538.8935   29  206 54470.9858 64085.1644  17.7%  2415 1828s
H14286  4710                    54741.127105 63929.3368  16.8%  2422 1828s
 14413  4852 57349.9907   20  277 54741.1271 63920.0480  16.8%  2425 1866s
 14975  4987 infeasible   23      54741.1271 63829.7786  16.6%  2432 1911s
 15474  5127 56145.1829   28  241 54741.1271 63779.0348  16.5%  2438 1952s
H15520  5127                    54749.385368 63779.0348  16.5%  2440 1952s
 15981  5332 58182.1793   20  284 54749.3854 63569.8126  16.1%  2451 1995s
 16623  5487 60604.9510   25  222 54749.3854 63316.0951  15.6%  2453 2039s
 17179  5634 59562.4617   24  266 54749.3854 63275.4301  15.6%  2452 2084s
 17915  5835 58276.2063   25  185 54749.3854 62992.1434  15.1%  2451 2133s
 18609  6045 56642.5899   31  269 54749.3854 62882.2672  14.9%  2458 2187s
 19433  6185 58061.3682   25  325 54749.3854 62663.7935  14.5%  2453 2235s
H19916  6183                    54758.224119 62658.8910  14.4%  2460 2235s
 19968  6337 57000.2260   27  180 54758.2241 62658.8910  14.4%  2460 2289s
 20715  6513 55980.6133   25  355 54758.2241 62430.8182  14.0%  2470 2343s
 21560  6652 56388.8107   26  244 54758.2241 62281.0545  13.7%  2473 2399s
 22431  6758 55255.5812   23  240 54758.2241 62124.9925  13.5%  2475 2457s
 23308  6835 60569.1144   26  277 54758.2241 61958.6286  13.1%  2479 2515s
H23529  6826                    54781.708225 61940.7291  13.1%  2481 2515s
H23632  6818                    54802.661123 61940.7291  13.0%  2481 2515s
 23933  6880 58732.6334   29  215 54802.6611 61849.6703  12.9%  2484 2584s
 24933  6930 55074.9891   26  296 54802.6611 61684.9542  12.6%  2482 2658s
 25860  7000     cutoff   33      54802.6611 61545.1052  12.3%  2491 2726s
 26764  7070     cutoff   27      54802.6611 61357.3825  12.0%  2498 2805s
 27867  7076 57268.8678   24  280 54802.6611 61134.3352  11.6%  2500 2881s
 28985  7042 57096.4451   24  238 54802.6611 60979.6512  11.3%  2501 2964s
 30145  7074 infeasible   28      54802.6611 60885.3147  11.1%  2505 3047s
 31385  7030 infeasible   27      54802.6611 60699.8672  10.8%  2504 3134s
 32703  7070 55681.1341   26  299 54802.6611 60570.0873  10.5%  2506 3212s
 33808  7030 55747.3945   27  310 54802.6611 60377.9483  10.2%  2510 3307s
 35205  6900 infeasible   31      54802.6611 60178.0268  9.81%  2507 3397s
 36597  6790 56524.7824   34  130 54802.6611 59924.0801  9.35%  2503 3496s
 38027  6616     cutoff   33      54802.6611 59707.8683  8.95%  2501 3587s
 39625  6616 54960.0314   23  258 54802.6611 59471.0848  8.52%  2491 3600s

Cutting planes:
  Learned: 1
  Gomory: 1
  MIR: 863
  Mixing: 2
  Flow cover: 1577
  RLT: 21
  Relax-and-lift: 152

Explored 39687 nodes (99066424 simplex iterations) in 3600.03 seconds (11207.46 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 54802.7 54781.7 54758.2 ... 54068.7

Time limit reached
Best objective 5.480266112328e+04, best bound 5.947108478533e+04, gap 8.5186%
  WARNING: Time limit reached. Using best solution found (gap: 8.52%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.03s
  Master Objective (UB) = 54802.66, θ = 229518.30
  Upper Bound (UB) = 54802.66

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 229518.30
  [DEBUG]   ✓ Scenario 0: θ = 229518.30 ≤ Q = 229518.30 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 229518.30 ≤ Q = 229639.89 (slack: 121.59)
  [DEBUG]   ✓ Scenario 2: θ = 229518.30 ≤ Q = 229518.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 229518.30 ≤ Q = 229518.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 229518.30 ≤ Q = 229518.30 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 229518.30 ≤ Q = 229518.30 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x2208bbc1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x2208bbc1
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.318892e+13
Presolve removed 2556 rows and 1846 columns
Presolve time: 0.00s
Presolved: 537 rows, 543 columns, 1516 nonzeros
Found heuristic solution: objective 6865240.3048
Variable types: 368 continuous, 175 integer (175 binary)
Found heuristic solution: objective 6864892.8193

Root relaxation: objective -1.707299e+05, 264 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -170729.88    0  129 6864892.82 -170729.88   102%     -    0s
H    0     0                    -136679.5479 -170729.88  24.9%     -    0s
H    0     0                    -147124.1193 -170729.88  16.0%     -    0s
H    0     0                    -148799.5705 -156227.34  4.99%     -    0s
H    0     0                    -153127.1143 -156227.34  2.02%     -    0s
     0     0 -156227.34    0  104 -153127.11 -156227.34  2.02%     -    0s
H    0     0                    -153464.2417 -156145.20  1.75%     -    0s
H    0     0                    -153610.8352 -156145.20  1.65%     -    0s
H    0     0                    -153947.9626 -156145.20  1.43%     -    0s
     0     0 -155670.91    0  103 -153947.96 -155670.91  1.12%     -    0s
     0     0 -154560.12    0   82 -153947.96 -154560.12  0.40%     -    0s
H    0     0                    -153969.8027 -154559.29  0.38%     -    0s
     0     0 -154518.13    0   89 -153969.80 -154518.13  0.36%     -    0s
     0     0 -154516.21    0   87 -153969.80 -154516.21  0.35%     -    0s
H    0     0                    -153974.6033 -154503.61  0.34%     -    0s
     0     0 -154503.61    0   71 -153974.60 -154503.61  0.34%     -    0s
H    0     0                    -153984.6387 -154503.61  0.34%     -    0s
     0     0 -154276.69    0   29 -153984.64 -154276.69  0.19%     -    0s
     0     0 -154267.77    0   23 -153984.64 -154267.77  0.18%     -    0s
     0     0 -154158.99    0   28 -153984.64 -154158.99  0.11%     -    0s
     0     0 -154158.28    0   16 -153984.64 -154158.28  0.11%     -    0s
     0     0 -154158.07    0   17 -153984.64 -154158.07  0.11%     -    0s
     0     0 -154112.97    0   25 -153984.64 -154112.97  0.08%     -    0s
     0     0 -154112.97    0   24 -153984.64 -154112.97  0.08%     -    0s
     0     0 -154112.97    0   23 -153984.64 -154112.97  0.08%     -    0s
     0     0 -154079.34    0    2 -153984.64 -154079.34  0.06%     -    0s
H    0     0                    -154054.7306 -154078.57  0.02%     -    0s
     0     0          -    0      -154054.73 -154068.94  0.01%     -    0s

Cutting planes:
  Gomory: 6
  Implied bound: 1
  MIR: 5
  Flow cover: 15
  Relax-and-lift: 4

Explored 1 nodes (985 simplex iterations) in 0.08 seconds (0.06 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -154055 -153985 -153975 ... 6.86489e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.540547306399e+05, best bound -1.540689365803e+05, gap 0.0092%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 211751.58
  Scenario: 44 demand increases, 16 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -154054.73
  [DEBUG]   S×d_nominal = 365806.31
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 365806.31 + -154054.73 = 211751.58
  [DEBUG]   Current θ from Master = 229518.30
  [DEBUG]   ⚠️  Z_SP ≤ θ by 17766.72 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 37035.94
  Lower Bound (LB) = 48673.91
  Gap (UB-LB) = 6128.7529, Absolute Gap = 6128.7529, Relative Gap = 0.111833
  Not converged yet (gap = 6128.75 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 44 increases, 16 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308304 nonzeros
Model fingerprint: 0x2cf4eadb
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 43834 rows and 17794 columns
Presolve time: 1.03s
Presolved: 64579 rows, 28146 columns, 401649 nonzeros
Variable types: 25887 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -285874.8191
Found heuristic solution: objective -222366.7828

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 64579 rows, 28146 columns, 401649 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   32202   -6.9822984e+03   0.000000e+00   1.586733e+08      5s
   50669    6.1318126e+04   0.000000e+00   3.862190e+07     10s
   64362    7.0729999e+04   0.000000e+00   3.955847e+07     15s
   77670    7.8181870e+04   0.000000e+00   1.059016e+08     20s
Concurrent spin time: 0.41s

Solved with dual simplex

Root relaxation: objective 8.812996e+04, 49019 iterations, 23.23 seconds (47.63 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 88129.9625    0   82 -222366.78 88129.9625   140%     -   24s
H    0     0                    -218351.7406 88129.9625   140%     -   24s
H    0     0                    -153704.7919 88129.9625   157%     -   24s
H    0     0                    -152401.5277 88129.9625   158%     -   24s
H    0     0                    -77344.50726 88129.9625   214%     -   24s
H    0     0                    -77025.65686 88129.9625   214%     -   25s
H    0     0                    -76452.06120 88129.9625   215%     -   25s
H    0     0                    -55209.71674 88129.9625   260%     -   25s
H    0     0                    16627.146973 88129.9625   430%     -   25s
H    0     0                    23159.827706 88129.9625   281%     -   25s
H    0     0                    32691.564230 88129.9625   170%     -   25s
H    0     0                    33372.302578 88129.9625   164%     -   25s
H    0     0                    48336.062820 88129.9625  82.3%     -   25s
     0     0 82849.4852    0  182 48336.0628 82849.4852  71.4%     -   35s
H    0     0                    48567.634580 82849.4276  70.6%     -   36s
     0     0 82220.9619    0  178 48567.6346 82220.9619  69.3%     -   39s
     0     0 82208.1105    0  181 48567.6346 82208.1105  69.3%     -   40s
     0     0 82208.1105    0  179 48567.6346 82208.1105  69.3%     -   40s
     0     0 82208.1105    0  179 48567.6346 82208.1105  69.3%     -   41s
     0     0 82208.1105    0  179 48567.6346 82208.1105  69.3%     -   41s
H    0     0                    48590.704044 79047.1026  62.7%     -   54s
     0     0 79047.1026    0  278 48590.7040 79047.1026  62.7%     -   54s
     0     0 78525.2864    0  300 48590.7040 78525.2864  61.6%     -   59s
     0     0 78404.7735    0  306 48590.7040 78404.7735  61.4%     -   63s
     0     0 78381.7261    0  296 48590.7040 78381.7261  61.3%     -   64s
     0     0 78378.8634    0  294 48590.7040 78378.8634  61.3%     -   64s
     0     0 78375.8315    0  296 48590.7040 78375.8315  61.3%     -   64s
     0     0 78374.7992    0  296 48590.7040 78374.7992  61.3%     -   65s
     0     0 78373.1969    0  291 48590.7040 78373.1969  61.3%     -   65s
     0     0 78373.1298    0  291 48590.7040 78373.1298  61.3%     -   65s
H    0     0                    48650.999009 77306.1589  58.9%     -   80s
     0     0 77306.1589    0  337 48650.9990 77306.1589  58.9%     -   80s
H    0     0                    49085.239872 77305.7684  57.5%     -   80s
     0     0 77131.1684    0  348 49085.2399 77131.1684  57.1%     -   84s
     0     0 76996.6167    0  358 49085.2399 76996.6167  56.9%     -   88s
     0     0 76948.1773    0  355 49085.2399 76948.1773  56.8%     -   91s
     0     0 76900.9035    0  346 49085.2399 76900.9035  56.7%     -   93s
     0     0 76863.5906    0  364 49085.2399 76863.5906  56.6%     -   94s
     0     0 76847.3567    0  360 49085.2399 76847.3567  56.6%     -   96s
     0     0 76843.3370    0  363 49085.2399 76843.3370  56.6%     -   97s
     0     0 76837.4154    0  366 49085.2399 76837.4154  56.5%     -   97s
     0     0 76836.0702    0  368 49085.2399 76836.0702  56.5%     -   98s
     0     0 76835.5305    0  366 49085.2399 76835.5305  56.5%     -   98s
     0     0 76319.7009    0  337 49085.2399 76319.7009  55.5%     -  107s
     0     0 76055.5671    0  368 49085.2399 76055.5671  54.9%     -  112s
     0     0 75953.1046    0  348 49085.2399 75953.1046  54.7%     -  115s
     0     0 75906.0996    0  350 49085.2399 75906.0996  54.6%     -  117s
     0     0 75890.2736    0  351 49085.2399 75890.2736  54.6%     -  119s
     0     0 75879.9803    0  357 49085.2399 75879.9803  54.6%     -  119s
     0     0 75875.7142    0  350 49085.2399 75875.7142  54.6%     -  120s
     0     0 75872.5676    0  351 49085.2399 75872.5676  54.6%     -  120s
     0     0 75871.1246    0  349 49085.2399 75871.1246  54.6%     -  120s
     0     0 75870.9293    0  348 49085.2399 75870.9293  54.6%     -  121s
     0     0 75810.8375    0  387 49085.2399 75810.8375  54.4%     -  124s
H    0     0                    49237.641631 75810.3513  54.0%     -  125s
     0     0 75792.0092    0  388 49237.6416 75792.0092  53.9%     -  127s
     0     0 75786.5014    0  393 49237.6416 75786.5014  53.9%     -  127s
     0     0 75783.4381    0  398 49237.6416 75783.4381  53.9%     -  128s
     0     0 75776.8205    0  372 49237.6416 75776.8205  53.9%     -  129s
     0     0 75775.9244    0  371 49237.6416 75775.9244  53.9%     -  129s
     0     0 75753.6515    0  396 49237.6416 75753.6515  53.9%     -  132s
H    0     0                    49484.911812 75752.9732  53.1%     -  134s
     0     0 75743.6520    0  397 49484.9118 75743.6520  53.1%     -  136s
     0     0 75742.9400    0  397 49484.9118 75742.9400  53.1%     -  136s
     0     0 75722.8569    0  367 49484.9118 75722.8569  53.0%     -  138s
H    0     0                    49609.586230 75722.2248  52.6%     -  138s
     0     0 75713.6254    0  383 49609.5862 75713.6254  52.6%     -  139s
     0     0 75710.8688    0  390 49609.5862 75710.8688  52.6%     -  139s
     0     0 75709.8878    0  386 49609.5862 75709.8878  52.6%     -  140s
     0     0 75697.8364    0  379 49609.5862 75697.8364  52.6%     -  141s
H    0     0                    49915.897527 75697.7541  51.7%     -  145s
     0     0 75692.9351    0  376 49915.8975 75692.9351  51.6%     -  145s
     0     0 75691.7594    0  378 49915.8975 75691.7594  51.6%     -  146s
     0     0 75686.8744    0  379 49915.8975 75686.8744  51.6%     -  147s
H    0     0                    49959.519196 75686.7400  51.5%     -  147s
     0     0 75685.7006    0  378 49959.5192 75685.7006  51.5%     -  148s
     0     0 75683.7039    0  364 49959.5192 75683.7039  51.5%     -  149s
     0     0 75682.8076    0  367 49959.5192 75682.8076  51.5%     -  149s
     0     0 75677.7838    0  367 49959.5192 75677.7838  51.5%     -  150s
     0     0 75677.7117    0  367 49959.5192 75677.7117  51.5%     -  151s
     0     2 75677.7117    0  367 49959.5192 75677.7117  51.5%     -  182s
     1     4 75626.1537    1  363 49959.5192 75674.2360  51.5%  2526  190s
     3     8 75439.6199    2  362 49959.5192 75622.9111  51.4%  6297  201s
     7    16 75248.6030    3  346 49959.5192 75436.4870  51.0%  7260  210s
    15    32 74691.8644    4  355 49959.5192 75248.5254  50.6%  7753  222s
    31    52 74523.8744    5  334 49959.5192 74690.9097  49.5% 11666  241s
    51    84 73070.6611    6  300 49959.5192 74690.9097  49.5% 10168  260s
H   70    84                    49999.640000 74690.9097  49.4%  9054  260s
H   82    84                    50183.176035 74690.9097  48.8%  8104  260s
    83   222 72981.5965    7  276 50183.1760 74690.9097  48.8%  8091  275s
   221   305 72283.2249   10  270 50183.1760 74690.9097  48.8%  4841  284s
   304   380 72193.8393   11  266 50183.1760 74690.9097  48.8%  4261  292s
   379   412 71857.4893   11  250 50183.1760 74690.9097  48.8%  3880  298s
   411   453 71925.2158   12  286 50183.1760 74690.9097  48.8%  3851  306s
   452   497 71474.5464   11  243 50183.1760 74690.9097  48.8%  3859  314s
   496   543 71891.7493   12  282 50183.1760 74690.9097  48.8%  3739  322s
H  502   543                    50194.894539 74690.9097  48.8%  3713  322s
   542   613 71919.5683   12  270 50194.8945 74690.9097  48.8%  3623  329s
H  596   613                    50228.861835 74690.9097  48.7%  3508  329s
   612   715 71896.7318   12  250 50228.8618 74690.9097  48.7%  3464  337s
   714   807 71668.4567   13  276 50228.8618 74690.9097  48.7%  3185  345s
   810   889 71861.7192   13  285 50228.8618 74690.9097  48.7%  2957  353s
   900   919 71622.8657   13  263 50228.8618 74690.9097  48.7%  2812  360s
   930   952 70239.0099   13  256 50228.8618 74690.9097  48.7%  2778  367s
   963   984 71541.4061   13  283 50228.8618 74690.9097  48.7%  2764  374s
H  993   984                    50234.183937 74690.9097  48.7%  2754  374s
   995  1016 69411.1113   13  211 50234.1839 74690.9097  48.7%  2760  380s
H 1001  1016                    50256.409272 74690.9097  48.6%  2751  380s
  1027  1048 71563.6054   13  278 50256.4093 74690.9097  48.6%  2740  387s
  1059  1082 71231.5924   14  274 50256.4093 74690.9097  48.6%  2717  394s
  1093  1120 71495.3418   14  280 50256.4093 74690.9097  48.6%  2693  399s
H 1100  1120                    50323.315404 74690.9097  48.4%  2680  399s
  1131  1272 71225.3834   14  280 50323.3154 74690.9097  48.4%  2649  408s
  1287  1413 71205.7323   15  272 50323.3154 74690.9097  48.4%  2464  416s
  1433  1540 70824.7760   16  275 50323.3154 74589.1122  48.2%  2342  425s
  1592  1629 70728.6715   17  267 50323.3154 74589.1122  48.2%  2217  434s
  1744  1702 68324.1354   16  240 50323.3154 74589.1122  48.2%  2136  445s
  1859  1791 70402.5720   18  283 50323.3154 74589.1122  48.2%  2112  455s
  1978  1893 65308.2427   18  256 50323.3154 74589.1122  48.2%  2105  466s
  2102  1929 70083.8969   19  269 50323.3154 74589.1122  48.2%  2095  476s
  2138  1978 69338.8597   19  253 50323.3154 74589.1122  48.2%  2114  484s
  2194  2081 69884.4337   19  253 50323.3154 74589.1122  48.2%  2110  495s
  2321  2111 69819.1394   20  301 50323.3154 74589.1122  48.2%  2057  504s
  2355  2147 67824.0054   20  200 50323.3154 74330.3698  47.7%  2068  513s
  2391  2190 69654.4415   21  292 50323.3154 74330.3698  47.7%  2091  525s
  2452  2251 68075.2540   23  220 50323.3154 74330.3698  47.7%  2092  534s
  2545  2321 68162.1603   22  254 50323.3154 74330.3698  47.7%  2081  546s
  2671  2434 65430.9891   24  207 50323.3154 74330.3698  47.7%  2078  558s
  2796  2595 65279.7948   23  204 50323.3154 74330.3698  47.7%  2077  571s
  2989  2694 66551.6619   25  304 50323.3154 74330.3698  47.7%  2043  587s
  3114  2852 64894.5859   28  194 50323.3154 74330.3698  47.7%  2042  601s
  3318  3001 64221.2601   28  211 50323.3154 74330.3698  47.7%  2019  617s
  3511  3002 59287.1078   47  367 50323.3154 74330.3698  47.7%  2010  655s
  3513  3003 67890.0047   22   82 50323.3154 74330.3698  47.7%  2009  687s
  3514  3004 61218.8026   53  284 50323.3154 74330.3698  47.7%  2008  711s
  3515  3005 66134.0169   33  336 50323.3154 74330.3698  47.7%  2008  719s
  3516  3005 70563.7959   26  336 50323.3154 74330.3698  47.7%  2007  726s
  3517  3006 65931.8863   45  334 50323.3154 74330.3698  47.7%  2006  731s
  3518  3007 68804.1858   16  340 50323.3154 74330.3698  47.7%  2006  735s
  3520  3008 63124.8706   32  361 50323.3154 74330.3698  47.7%  2005  742s
  3522  3009 54846.0930   53  383 50323.3154 74330.3698  47.7%  2004  747s
  3524  3011 67291.0770   14  374 50323.3154 74330.3698  47.7%  2002  751s
  3527  3013 64835.4722   30  372 50323.3154 74330.3698  47.7%  2001  755s
  3529  3014 69963.2580   11  372 50323.3154 74330.3698  47.7%  2000  760s
  3531  3015 72634.8182    9  384 50323.3154 74330.3698  47.7%  1999  765s
  3534  3017 51732.4158   60  372 50323.3154 74330.3698  47.7%  1997  770s
  3535  3018 70217.0734   15  373 50323.3154 74330.3698  47.7%  1996  775s
  3537  3019 60393.5275   42  375 50323.3154 74330.3698  47.7%  1995  780s
  3540  3021 66125.1600   41  367 50323.3154 74330.3698  47.7%  1993  785s
  3542  3023 71707.6346   21  371 50323.3154 74330.3698  47.7%  1992  790s
H 3542  2871                    50343.024149 74330.3698  47.6%  1992  791s
H 3542  2727                    50351.382146 74330.3698  47.6%  1992  791s
H 3542  2590                    50404.822683 74330.3698  47.5%  1992  791s
H 3543  2460                    50471.683618 74330.3698  47.3%  1992  794s
H 3543  2336                    50501.507752 74330.3698  47.2%  1992  794s
  3545  2338 67377.9070   17  388 50501.5078 74330.3698  47.2%  1991  796s
  3547  2339 62255.6480   29  373 50501.5078 74330.3698  47.2%  1989  828s
  3548  2340 68485.4154   24  373 50501.5078 74330.3698  47.2%  1989  852s
  3549  2343 74330.3698   16  396 50501.5078 74330.3698  47.2%  2034  910s
  3551  2347 74330.3698   17  348 50501.5078 74330.3698  47.2%  2036  926s
  3555  2353 74330.3698   18  351 50501.5078 74330.3698  47.2%  2041  958s
  3563  2367 74330.3698   19  399 50501.5078 74330.3698  47.2%  2063  974s
  3579  2390 71791.0891   20  312 50501.5078 74330.3698  47.2%  2138 1070s
  3608  2413 68072.1053   21  335 50501.5078 74330.3698  47.2%  2245 1094s
  3640  2483 65591.3168   22  330 50501.5078 74330.3698  47.2%  2318 1114s
  3721  2539 64666.7320   23  343 50501.5078 74330.3698  47.2%  2444 1131s
  3804  2543 60583.0844   24  303 50501.5078 74330.3698  47.2%  2485 1143s
  3836  2571 64534.8218   24  334 50501.5078 74330.3698  47.2%  2507 1155s
  3874  2595 60383.4256   24  303 50501.5078 74330.3698  47.2%  2528 1168s
  3911  2623 60156.9111   25  294 50501.5078 74330.3698  47.2%  2551 1181s
  3952  2654 57258.9198   25  266 50501.5078 74330.3698  47.2%  2572 1194s
  4002  2691 53497.1801   25  253 50501.5078 74330.3698  47.2%  2586 1212s
  4072  2717 56204.9461   25  290 50501.5078 73989.4017  46.5%  2597 1225s
  4131  2755 56940.7310   25  299 50501.5078 73883.8729  46.3%  2599 1238s
  4202  2773 60801.7949   25  291 50501.5078 73883.8729  46.3%  2611 1252s
  4274  2775 60354.8072   26  276 50501.5078 73883.8729  46.3%  2629 1267s
  4341  2780 59981.8118   27  272 50501.5078 73883.8729  46.3%  2634 1280s
  4372  2796 59864.4553   28  254 50501.5078 73883.8729  46.3%  2656 1293s
H 4407  2667                    50748.109901 73883.8729  45.6%  2679 1293s
  4408  2721 59465.4299   27  279 50748.1099 73883.8729  45.6%  2681 1307s
  4489  2737 59420.4728   28  248 50748.1099 73883.8729  45.6%  2692 1323s
  4573  2771 58579.3015   30  226 50748.1099 73883.8729  45.6%  2700 1342s
  4670  2786 57664.0216   35  132 50748.1099 73883.8729  45.6%  2709 1358s
  4771  2812 55415.5333   35  162 50748.1099 73838.7970  45.5%  2720 1374s
  4865  2826 54398.3638   37  125 50748.1099 73838.7970  45.5%  2730 1387s
H 4876  2710                    51053.318473 73838.7970  44.6%  2734 1387s
H 4885  2601                    51168.206839 73838.7970  44.3%  2730 1387s
H 4886  2500                    51397.397493 73838.7970  43.7%  2731 1387s
H 4930  2389                    51398.077721 73838.7970  43.7%  2726 1387s
  4945  2447     cutoff   38      51398.0777 73838.7970  43.7%  2735 1401s
  5077  2468 53016.9054   38  115 51398.0777 73838.7970  43.7%  2729 1418s
  5224  2501     cutoff   40      51398.0777 73838.7970  43.7%  2715 1434s
  5390  2481 54294.1979   42  197 51398.0777 72738.2822  41.5%  2699 1448s
H 5393  2389                    52284.206661 72738.2822  39.1%  2698 1448s
  5443  2415 53513.2000   43  201 52284.2067 72738.2822  39.1%  2695 1469s
  5618  2423 52760.2480   44  173 52284.2067 72738.2822  39.1%  2674 1485s
  5767  2440 65403.2471   23  293 52284.2067 72033.5347  37.8%  2676 1507s
  5909  2466 63610.6502   25  229 52284.2067 72033.5347  37.8%  2686 1527s
H 5971  2359                    52407.259640 70762.6330  35.0%  2689 1527s
H 6059  2287                    53065.370926 70762.6330  33.3%  2694 1547s
H 6060  2208                    53337.446990 70762.6330  32.7%  2694 1547s
H 6094  2123                    53686.813755 70762.6330  31.8%  2695 1547s
  6114  2152 61892.9180   30  146 53686.8138 70762.6330  31.8%  2702 1569s
  6234  2190 59396.1331   33  111 53686.8138 70691.9761  31.7%  2718 1591s
  6366  2228 57538.0835   38  105 53686.8138 70691.9761  31.7%  2740 1615s
  6528  2231 54849.0121   42  125 53686.8138 70691.9761  31.7%  2747 1641s
  6721  2151 59942.2349   33  179 53686.8138 70019.5147  30.4%  2743 1668s
  6947  2037 57819.6588   35  169 53686.8138 70019.5147  30.4%  2727 1695s
  7155  1979     cutoff   39      53686.8138 69745.9689  29.9%  2728 1716s
H 7156  1909                    53837.352378 69745.9689  29.5%  2728 1716s
H 7247  1812                    53867.135988 69570.7233  29.2%  2731 1716s
H 7271  1786                    53900.645185 69570.7233  29.1%  2729 1716s
  7275  1823 54133.0053   42  123 53900.6452 69570.7233  29.1%  2731 1740s
  7439  1885 64463.3525   24  298 53900.6452 69570.7233  29.1%  2761 1768s
  7631  1972 63621.3221   25  338 53900.6452 69570.7233  29.1%  2785 1794s
  7836  2053 63523.8531   26  290 53900.6452 69209.9694  28.4%  2803 1825s
  8076  2135 61610.4993   27  290 53900.6452 69209.9694  28.4%  2819 1860s
H 8292  2153                    53933.495726 68951.8990  27.8%  2844 1885s
  8390  2266 55576.6166   29  250 53933.4957 68197.5278  26.4%  2861 1917s
  8563  2447 58188.8813   32  170 53933.4957 68197.5278  26.4%  2897 1952s
  8855  2494     cutoff   37      53933.4957 68197.5278  26.4%  2900 1979s
  8990  2602 56362.2833   37   99 53933.4957 67741.1892  25.6%  2910 2019s
  9232  2722     cutoff   39      53933.4957 67597.2368  25.3%  2920 2052s
  9481  2879 60527.6030   27  240 53933.4957 67597.2368  25.3%  2948 2090s
  9775  3005 56222.7284   33  139 53933.4957 67193.9644  24.6%  2967 2126s
H10025  3003                    53948.879082 66951.2898  24.1%  2975 2126s
 10054  3137 62884.5953   27  280 53948.8791 66951.2898  24.1%  2978 2168s
 10390  3278 58153.4918   32  112 53948.8791 66951.2898  24.1%  2991 2211s
 10744  3433     cutoff   37      53948.8791 66379.4842  23.0%  3004 2258s
 11063  3601 61692.2371   28  279 53948.8791 66028.1332  22.4%  3029 2302s
 11355  3723 55607.5916   34  173 53948.8791 66028.1332  22.4%  3060 2349s
 11878  3935 62347.7706   28  219 53948.8791 66017.5408  22.4%  3036 2399s
 12383  4082 54617.0404   39  118 53948.8791 65609.7843  21.6%  3023 2452s
 12835  4232 55623.5141   32  122 53948.8791 65609.7843  21.6%  3028 2502s
 13254  4372 57239.1437   32  145 53948.8791 65609.7843  21.6%  3044 2555s
 13695  4511 55550.5994   29  348 53948.8791 65074.1900  20.6%  3061 2611s
 14093  4526     cutoff   29      53948.8791 64734.1789  20.0%  3087 2651s
H14097  4514                    54007.502796 64734.1789  19.9%  3087 2651s
H14099  4483                    54126.269341 64734.1789  19.6%  3087 2651s
H14117  4440                    54245.966080 64734.1789  19.3%  3089 2651s
 14142  4727 59256.4667   29  232 54245.9661 64734.1789  19.3%  3090 2715s
 14687  4973     cutoff   33      54245.9661 64734.1789  19.3%  3091 2781s
 15288  5217 60042.0726   33  191 54245.9661 64721.7238  19.3%  3084 2842s
H15366  5206                    54269.967361 64721.7238  19.3%  3075 2842s
H15494  5180                    54322.844238 64721.7238  19.1%  3070 2842s
 15875  5513 54490.0320   27  252 54322.8442 64142.0136  18.1%  3071 2913s
 16575  5748 58972.8936   31  178 54322.8442 64142.0136  18.1%  3052 2988s
 17195  5949 61679.6617   27  240 54322.8442 63841.5403  17.5%  3053 3066s
 17792  6110 61532.9258   30  272 54322.8442 63650.8602  17.2%  3064 3146s
 18358  6328 58686.2340   28  196 54322.8442 63485.0205  16.9%  3086 3228s
 18967  6543 60313.6011   27  241 54322.8442 63216.9183  16.4%  3104 3303s
 19760  6724 60803.0864   29  242 54322.8442 63130.6139  16.2%  3100 3390s
 20506  6962 54670.3326   34  141 54322.8442 63048.5584  16.1%  3104 3481s
H21196  6912                    54389.647212 62808.3501  15.5%  3100 3481s
 21229  7208 55404.3617   31  268 54389.6472 62725.1080  15.3%  3103 3570s
 22009  7301 56614.5673   36  151 54389.6472 62561.1027  15.0%  3099 3600s

Cutting planes:
  Learned: 1
  MIR: 1062
  Mixing: 3
  Flow cover: 1799
  RLT: 24
  Relax-and-lift: 162

Explored 22377 nodes (69291094 simplex iterations) in 3600.03 seconds (10332.51 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 54389.6 54322.8 54270 ... 53867.1

Time limit reached
Best objective 5.438964721202e+04, best bound 6.256110272535e+04, gap 15.0239%
  WARNING: Time limit reached. Using best solution found (gap: 15.02%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.05s
  Master Objective (UB) = 54389.65, θ = 233173.39
  Upper Bound (UB) = 54389.65

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 233173.39
  [DEBUG]   ✓ Scenario 0: θ = 233173.39 ≤ Q = 233173.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 233173.39 ≤ Q = 233173.39 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 233173.39 ≤ Q = 233173.39 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 233173.39 ≤ Q = 233173.39 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 233173.39 ≤ Q = 233173.39 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 233173.39 ≤ Q = 233173.39 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 233173.39 ≤ Q = 233173.39 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x6098d012
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x6098d012
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-01, 2e+02]
Found heuristic solution: objective 1.315174e+13
Presolve removed 2550 rows and 1841 columns
Presolve time: 0.00s
Presolved: 543 rows, 548 columns, 1532 nonzeros
Found heuristic solution: objective 7016342.5078
Variable types: 372 continuous, 176 integer (176 binary)

Root relaxation: objective -1.643258e+05, 265 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -164325.81    0  132 7016342.51 -164325.81   102%     -    0s
H    0     0                    -129440.7963 -164325.81  27.0%     -    0s
H    0     0                    -131278.0956 -164325.81  25.2%     -    0s
H    0     0                    -134262.6092 -164325.81  22.4%     -    0s
H    0     0                    -140592.0147 -164325.81  16.9%     -    0s
     0     0 -148119.30    0   80 -140592.01 -148119.30  5.35%     -    0s
H    0     0                    -145370.9362 -148083.81  1.87%     -    0s
H    0     0                    -145655.9570 -148083.81  1.67%     -    0s
H    0     0                    -146228.9218 -148083.81  1.27%     -    0s
H    0     0                    -146513.9427 -148083.81  1.07%     -    0s
H    0     0                    -146572.2192 -148023.09  0.99%     -    0s
     0     0 -148023.09    0   74 -146572.22 -148023.09  0.99%     -    0s
     0     0 -147359.35    0   58 -146572.22 -147359.35  0.54%     -    0s
H    0     0                    -146596.0333 -147354.47  0.52%     -    0s
H    0     0                    -146623.5233 -147241.17  0.42%     -    0s
     0     0 -147195.87    0   42 -146623.52 -147195.87  0.39%     -    0s
     0     0 -147195.87    0   42 -146623.52 -147195.87  0.39%     -    0s
H    0     0                    -146631.9123 -147195.87  0.38%     -    0s
     0     0 -146909.00    0   30 -146631.91 -146909.00  0.19%     -    0s
     0     0 -146899.43    0   27 -146631.91 -146899.43  0.18%     -    0s
     0     0 -146817.08    0   19 -146631.91 -146817.08  0.13%     -    0s
     0     0 -146816.55    0   13 -146631.91 -146816.55  0.13%     -    0s
     0     0 -146786.53    0   20 -146631.91 -146786.53  0.11%     -    0s
     0     0 -146777.90    0   20 -146631.91 -146777.90  0.10%     -    0s
     0     0 -146725.60    0   10 -146631.91 -146725.60  0.06%     -    0s
     0     0 -146725.60    0   22 -146631.91 -146725.60  0.06%     -    0s
     0     0 -146674.26    0    5 -146631.91 -146674.26  0.03%     -    0s
H    0     0                    -146647.4578 -146670.32  0.02%     -    0s
     0     0 -146668.48    0    4 -146647.46 -146668.48  0.01%     -    0s
     0     0 -146668.48    0    6 -146647.46 -146668.48  0.01%     -    0s
H    0     0                    -146667.7001 -146668.48  0.00%     -    0s

Explored 1 nodes (866 simplex iterations) in 0.07 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -146668 -146647 -146632 ... -134263

Optimal solution found (tolerance 1.00e-04)
Best objective -1.466677000960e+05, best bound -1.466684839424e+05, gap 0.0005%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 218079.57
  Scenario: 33 demand increases, 27 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -146667.70
  [DEBUG]   S×d_nominal = 364747.27
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 364747.27 + -146667.70 = 218079.57
  [DEBUG]   Current θ from Master = 233173.39
  [DEBUG]   ⚠️  Z_SP ≤ θ by 15093.81 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 39295.84
  Lower Bound (LB) = 48673.91
  Gap (UB-LB) = 5715.7390, Absolute Gap = 5715.7390, Relative Gap = 0.105089
  Not converged yet (gap = 5715.74 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 33 increases, 27 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351559 nonzeros
Model fingerprint: 0x598cce05
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 50096 rows and 20336 columns
Presolve time: 1.19s
Presolved: 73607 rows, 31844 columns, 458239 nonzeros
Variable types: 29585 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -285874.8191
Found heuristic solution: objective -222366.7828

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 73607 rows, 31844 columns, 458239 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   32477   -8.2762440e+04   0.000000e+00   6.499244e+07      5s
   48248    3.9197133e+04   0.000000e+00   1.549687e+07     10s
   60915    5.8989553e+04   0.000000e+00   6.108320e+06     15s
   72332    6.4368209e+04   0.000000e+00   1.219999e+08     20s
   82419    6.9951115e+04   0.000000e+00   2.097928e+07     25s
   94604    7.4545947e+04   0.000000e+00   6.641078e+06     30s
Concurrent spin time: 0.01s

Solved with dual simplex

Root relaxation: objective 8.812996e+04, 56074 iterations, 28.77 seconds (60.03 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 88129.9625    0   82 -222366.78 88129.9625   140%     -   30s
H    0     0                    -211830.2858 88129.9625   142%     -   30s
H    0     0                    -109279.2868 88129.9625   181%     -   30s
H    0     0                    -105695.2915 88129.9625   183%     -   30s
H    0     0                    -105088.3267 88129.9625   184%     -   30s
H    0     0                    -102247.1358 88129.9625   186%     -   31s
H    0     0                    -99348.50996 88129.9625   189%     -   31s
H    0     0                    -77795.47489 88129.9625   213%     -   31s
H    0     0                    -74371.41572 88129.9625   218%     -   31s
H    0     0                    -55209.71674 88129.9625   260%     -   31s
H    0     0                    -26847.09211 88129.9625   428%     -   31s
H    0     0                    -26559.15853 88129.9625   432%     -   31s
H    0     0                    23293.205570 88129.9625   278%     -   31s
H    0     0                    24275.901070 88129.9625   263%     -   31s
H    0     0                    34647.966632 88129.9625   154%     -   31s
H    0     0                    38388.082588 88129.9625   130%     -   31s
H    0     0                    48336.062820 88129.9625  82.3%     -   31s
H    0     0                    48499.651264 82983.3627  71.1%     -   45s
H    0     0                    48565.852274 82983.3627  70.9%     -   45s
     0     0 82983.3627    0  177 48565.8523 82983.3627  70.9%     -   45s
     0     0 82363.5784    0  187 48565.8523 82363.5784  69.6%     -   52s
     0     0 82363.5784    0  191 48565.8523 82363.5784  69.6%     -   54s
     0     0 82363.5784    0  189 48565.8523 82363.5784  69.6%     -   55s
     0     0 82363.5784    0  189 48565.8523 82363.5784  69.6%     -   55s
     0     0 78994.7354    0  284 48565.8523 78994.7354  62.7%     -   72s
H    0     0                    48731.328158 78710.4825  61.5%     -   79s
     0     0 78710.4825    0  282 48731.3282 78710.4825  61.5%     -   79s
     0     0 78587.0560    0  253 48731.3282 78587.0560  61.3%     -   83s
     0     0 78526.2793    0  291 48731.3282 78526.2793  61.1%     -   87s
     0     0 78506.5076    0  296 48731.3282 78506.5076  61.1%     -   88s
     0     0 78503.1637    0  290 48731.3282 78503.1637  61.1%     -   88s
     0     0 78497.9712    0  293 48731.3282 78497.9712  61.1%     -   89s
     0     0 78495.8895    0  291 48731.3282 78495.8895  61.1%     -   89s
     0     0 78495.1578    0  296 48731.3282 78495.1578  61.1%     -   90s
     0     0 77334.7992    0  308 48731.3282 77334.7992  58.7%     -  107s
     0     0 76995.9805    0  315 48731.3282 76995.9805  58.0%     -  116s
     0     0 76884.6651    0  328 48731.3282 76884.6651  57.8%     -  119s
     0     0 76859.2797    0  334 48731.3282 76859.2797  57.7%     -  121s
     0     0 76845.4433    0  326 48731.3282 76845.4433  57.7%     -  123s
     0     0 76841.9021    0  328 48731.3282 76841.9021  57.7%     -  124s
     0     0 76838.0056    0  329 48731.3282 76838.0056  57.7%     -  124s
     0     0 76822.4951    0  327 48731.3282 76822.4951  57.6%     -  126s
     0     0 76814.1537    0  329 48731.3282 76814.1537  57.6%     -  127s
     0     0 76807.8748    0  332 48731.3282 76807.8748  57.6%     -  127s
     0     0 76806.2020    0  330 48731.3282 76806.2020  57.6%     -  128s
     0     0 76804.3281    0  333 48731.3282 76804.3281  57.6%     -  128s
     0     0 76804.0831    0  334 48731.3282 76804.0831  57.6%     -  129s
     0     0 76359.8752    0  344 48731.3282 76359.8752  56.7%     -  138s
     0     0 76246.3023    0  348 48731.3282 76246.3023  56.5%     -  142s
     0     0 76192.8095    0  340 48731.3282 76192.8095  56.4%     -  144s
     0     0 76176.4927    0  342 48731.3282 76176.4927  56.3%     -  146s
     0     0 76166.5713    0  350 48731.3282 76166.5713  56.3%     -  147s
     0     0 76162.9478    0  351 48731.3282 76162.9478  56.3%     -  148s
     0     0 76160.7138    0  349 48731.3282 76160.7138  56.3%     -  149s
     0     0 76159.0321    0  352 48731.3282 76159.0321  56.3%     -  149s
     0     0 76153.4625    0  354 48731.3282 76153.4625  56.3%     -  150s
     0     0 76152.3339    0  349 48731.3282 76152.3339  56.3%     -  150s
     0     0 75921.0767    0  376 48731.3282 75921.0767  55.8%     -  156s
     0     0 75865.1990    0  382 48731.3282 75865.1990  55.7%     -  159s
     0     0 75835.9353    0  386 48731.3282 75835.9353  55.6%     -  162s
     0     0 75829.4404    0  386 48731.3282 75829.4404  55.6%     -  163s
     0     0 75822.4103    0  389 48731.3282 75822.4103  55.6%     -  163s
     0     0 75817.7489    0  386 48731.3282 75817.7489  55.6%     -  164s
     0     0 75816.0824    0  357 48731.3282 75816.0824  55.6%     -  164s
     0     0 75815.2533    0  359 48731.3282 75815.2533  55.6%     -  164s
     0     0 75783.2132    0  393 48731.3282 75783.2132  55.5%     -  167s
     0     0 75772.0884    0  400 48731.3282 75772.0884  55.5%     -  169s
     0     0 75770.4456    0  396 48731.3282 75770.4456  55.5%     -  169s
     0     0 75769.3270    0  404 48731.3282 75769.3270  55.5%     -  170s
     0     0 75747.7307    0  366 48731.3282 75747.7307  55.4%     -  172s
     0     0 75740.1577    0  369 48731.3282 75740.1577  55.4%     -  173s
     0     0 75736.6864    0  371 48731.3282 75736.6864  55.4%     -  174s
     0     0 75735.9092    0  372 48731.3282 75735.9092  55.4%     -  174s
     0     0 75725.9067    0  366 48731.3282 75725.9067  55.4%     -  176s
H    0     0                    49055.629070 75725.6422  54.4%     -  178s
     0     0 75719.8078    0  377 49055.6291 75719.8078  54.4%     -  179s
     0     0 75718.4478    0  378 49055.6291 75718.4478  54.4%     -  179s
     0     0 75716.0806    0  378 49055.6291 75716.0806  54.3%     -  180s
H    0     0                    49709.987276 75709.9346  52.3%     -  181s
     0     0 75709.9346    0  374 49709.9873 75709.9346  52.3%     -  181s
     0     0 75677.7699    0  367 49709.9873 75677.7699  52.2%     -  183s
     0     0 75675.9031    0  374 49709.9873 75675.9031  52.2%     -  186s
     0     0 75675.6327    0  372 49709.9873 75675.6327  52.2%     -  186s
     0     0 75674.3400    0  375 49709.9873 75674.3400  52.2%     -  187s
     0     0 75672.7738    0  374 49709.9873 75672.7738  52.2%     -  188s
     0     0 75672.7355    0  374 49709.9873 75672.7355  52.2%     -  188s
     0     0 75669.5378    0  374 49709.9873 75669.5378  52.2%     -  189s
     0     0 75669.1706    0  371 49709.9873 75669.1706  52.2%     -  191s
     0     0 75665.7051    0  373 49709.9873 75665.7051  52.2%     -  192s
     0     0 75665.6922    0  373 49709.9873 75665.6922  52.2%     -  193s
     0     2 75665.6558    0  373 49709.9873 75665.6558  52.2%     -  233s
     1     4 75609.9544    1  371 49709.9873 75653.7438  52.2%  3527  242s
     3     7 75474.4643    2  365 49709.9873 75602.1370  52.1%  6432  258s
     6    14 75382.2590    3  353 49709.9873 75471.5262  51.8%  9238  265s
    13    28 75001.1318    4  356 49709.9873 75382.1603  51.6%  8162  277s
    27    42 73991.2239    5  390 49709.9873 74999.6015  50.9% 12163  300s
    41    74 73675.6983    6  339 49709.9873 74999.6015  50.9% 10840  332s
H   42    74                    49976.030839 74999.6015  50.1% 10582  332s
    73   168 73448.6024    7  354 49976.0308 74781.5228  49.6% 10364  356s
   167   200 73294.0776   10  373 49976.0308 74780.9742  49.6%  7035  367s
   199   232 73095.5426   11  365 49976.0308 74780.9742  49.6%  6350  378s
H  206   232                    50232.794158 74780.9742  48.9%  6263  378s
   231   318 72874.6947   12  367 50232.7942 74780.9742  48.9%  6040  390s
   317   405 72466.1835   14  350 50232.7942 74780.9742  48.9%  5584  404s
   404   498 72088.2498   17  348 50232.7942 74780.9742  48.9%  5011  417s
   497   581 71534.5990   19  303 50232.7942 74780.9742  48.9%  4540  426s
   580   655 71488.8697   20  305 50232.7942 74780.9742  48.9%  4249  437s
   656   737 71120.7759   23  302 50232.7942 74780.9742  48.9%  4065  446s
   740   820 70777.7395   26  285 50232.7942 74780.9742  48.9%  3834  455s
   823   919 70416.6095   30  279 50232.7942 74780.9742  48.9%  3654  464s
   922  1028 70127.1475   31  277 50232.7942 74780.9742  48.9%  3422  473s
  1035  1123 69683.2091   36  250 50232.7942 74780.9742  48.9%  3201  484s
  1150  1218 68465.1074   38  227 50232.7942 74499.3962  48.3%  3044  495s
  1257  1247 61538.8227   40  193 50232.7942 74498.9214  48.3%  2944  506s
H 1279  1247                    50298.969499 74498.9214  48.1%  2941  506s
  1286  1342 54058.9251   64  128 50298.9695 74498.9214  48.1%  2948  518s
  1405  1451 59464.1744   41  174 50298.9695 74223.1290  47.6%  2812  528s
  1540  1563 59450.6346   42  166 50298.9695 74222.8442  47.6%  2684  541s
  1666  1697 52383.3864   46  147 50298.9695 74208.7701  47.5%  2612  552s
  1812  1849     cutoff   52      50298.9695 73998.4766  47.1%  2520  565s
  1978  1990 72920.9476    8  305 50298.9695 73998.4766  47.1%  2423  579s
  2158  2115 71857.8235   10  269 50298.9695 73998.4766  47.1%  2335  591s
  2307  2145 71124.6423   12  250 50298.9695 73720.2320  46.6%  2292  599s
  2341  2188 69295.8014   13  233 50298.9695 73720.2320  46.6%  2304  610s
  2389  2265 69028.4915   14  227 50298.9695 73703.2610  46.5%  2319  623s
  2486  2368 68925.9381   15  231 50298.9695 73703.2610  46.5%  2295  638s
  2637  2452 68740.2601   16  227 50298.9695 73703.2610  46.5%  2259  651s
  2733  2529 67382.1633   17  254 50298.9695 73595.4212  46.3%  2294  665s
  2824  2649 66411.4011   18  255 50298.9695 73595.4212  46.3%  2329  681s
  2965  2808 66039.0849   21  256 50298.9695 73595.4212  46.3%  2330  695s
  3142  3015 65200.6534   24  190 50298.9695 73595.4212  46.3%  2304  712s
  3392  3016 68362.4019   15  373 50298.9695 73595.4212  46.3%  2229  915s
H 3393  2866                    50323.315404 73595.4212  46.2%  2229  941s
  3395  2867 67659.5972   17  273 50323.3154 73595.4212  46.2%  2227  961s
  3396  2868 66503.4323   14  323 50323.3154 73595.4212  46.2%  2227  980s
  3397  2868 55223.6586   62  319 50323.3154 73595.4212  46.2%  2226  988s
  3398  2869 72019.8516   14  344 50323.3154 73595.4212  46.2%  2225  996s
  3399  2870 67425.7845    8  345 50323.3154 73595.4212  46.2%  2225 1000s
  3401  2871 52553.0227   41  347 50323.3154 73595.4212  46.2%  2223 1008s
  3402  2872 72308.4751    9  366 50323.3154 73595.4212  46.2%  2223 1011s
  3404  2873 60779.1615   32  365 50323.3154 73595.4212  46.2%  2221 1015s
  3407  2875 68485.5561   10  373 50323.3154 73595.4212  46.2%  2220 1020s
  3409  2876 51967.9081   46  370 50323.3154 73595.4212  46.2%  2218 1029s
  3410  2877 62250.7561   32  383 50323.3154 73595.4212  46.2%  2218 1031s
  3412  2878 71117.3707    9  367 50323.3154 73595.4212  46.2%  2216 1039s
  3413  2879 55768.7946   85  371 50323.3154 73595.4212  46.2%  2216 1041s
  3414  2880 68976.3274   17  390 50323.3154 73595.4212  46.2%  2215 1048s
  3415  2880 64538.1170   57  380 50323.3154 73595.4212  46.2%  2214 1051s
  3416  2881 59034.2094   99  432 50323.3154 73595.4212  46.2%  2214 1056s
  3418  2882 70634.0458   16  372 50323.3154 73595.4212  46.2%  2212 1063s
  3419  2883 52519.0954  111  375 50323.3154 73595.4212  46.2%  2212 1065s
  3421  2884 71994.7160   17  374 50323.3154 73595.4212  46.2%  2210 1071s
H 3421  2739                    50501.507752 73595.4212  45.7%  2210 1077s
  3424  2741 61735.9094   98  369 50501.5078 73595.4212  45.7%  2209 1082s
  3426  2743 71917.4863   13  375 50501.5078 73595.4212  45.7%  2207 1088s
  3427  2743 51823.9113  116  375 50501.5078 73595.4212  45.7%  2207 1115s
  3428  2744 53831.6506   87  375 50501.5078 73595.4212  45.7%  2206 1144s
  3429  2748 73595.4212   10  354 50501.5078 73595.4212  45.7%  2261 1174s
  3431  2751 73595.4212   11  364 50501.5078 73595.4212  45.7%  2264 1190s
  3435  2758 73595.4212   12  360 50501.5078 73595.4212  45.7%  2271 1219s
  3439  2756 73379.9660   12  334 50501.5078 73595.4212  45.7%  2281 1220s
  3443  2771 73595.4212   13  397 50501.5078 73595.4212  45.7%  2295 1240s
  3459  2782 73154.4354   14  352 50501.5078 73595.4212  45.7%  2381 1289s
  3475  2808 71398.9155   15  352 50501.5078 73595.4212  45.7%  2422 1319s
  3507  2833 70741.8106   16  300 50501.5078 73595.4212  45.7%  2487 1344s
  3542  2892 70705.6266   17  306 50501.5078 73595.4212  45.7%  2538 1378s
H 3549  2752                    51539.519630 73595.4212  42.8%  2544 1378s
  3613  2844 69735.2074   18  382 51539.5196 73595.4212  42.8%  2604 1410s
  3727  2846 68771.2343   19  372 51539.5196 73595.4212  42.8%  2673 1431s
H 3729  2715                    51891.356138 73595.4212  41.8%  2676 1431s
  3773  2767 67368.4732   20  316 51891.3561 73595.4212  41.8%  2696 1452s
  3851  2807 68142.8835   20  324 51891.3561 73595.4212  41.8%  2743 1472s
  3936  2845 64519.5809   21  265 51891.3561 73595.4212  41.8%  2769 1490s
  4046  2848 66408.1120   20  317 51891.3561 73595.4212  41.8%  2762 1505s
H 4048  2723                    51893.024288 73595.4212  41.8%  2762 1505s
  4110  2775 66233.3078   21  294 51893.0243 73595.4212  41.8%  2760 1520s
  4210  2799 62864.7785   22  251 51893.0243 73595.4212  41.8%  2754 1538s
  4297  2839 62828.8255   23  235 51893.0243 73595.4212  41.8%  2748 1554s
  4392  2872 61024.9579   24  230 51893.0243 73595.4212  41.8%  2745 1571s
  4486  2882 60715.3194   25  226 51893.0243 73595.4212  41.8%  2742 1583s
  4552  2909 58925.8340   25  201 51893.0243 73595.4212  41.8%  2738 1598s
H 4618  2769                    51913.810006 73322.9759  41.2%  2732 1598s
  4639  2827 60643.3206   26  214 51913.8100 73322.9759  41.2%  2733 1616s
  4746  2844 59096.7296   27  192 51913.8100 73320.8180  41.2%  2730 1635s
  4855  2874 58762.4478   29  188 51913.8100 73320.8180  41.2%  2732 1655s
  4975  2896 58117.0754   34  145 51913.8100 73320.8180  41.2%  2724 1674s
  5088  2923 57553.9945   37  102 51913.8100 73320.8180  41.2%  2726 1694s
  5225  2947     cutoff   43      51913.8100 73320.8180  41.2%  2721 1716s
  5362  2976 54708.4797   47   96 51913.8100 72448.4221  39.6%  2715 1736s
  5483  3026 53604.1900   56  108 51913.8100 71904.5527  38.5%  2714 1758s
H 5602  2926                    52306.345460 71904.5527  37.5%  2718 1774s
H 5602  2820                    52756.089390 71904.5527  36.3%  2718 1774s
H 5654  2701                    53965.832715 71904.5527  33.2%  2728 1774s
H 5654  2605                    54077.338153 71904.5527  33.0%  2728 1774s
  5673  2640     cutoff   67      54077.3382 71904.5527  33.0%  2724 1798s
  5799  2664 63395.8815   21  267 54077.3382 71904.5527  33.0%  2736 1819s
  5883  2707 61894.0546   23  193 54077.3382 71904.5527  33.0%  2757 1844s
  6009  2745 60561.1994   26  154 54077.3382 71904.5527  33.0%  2774 1868s
  6158  2696 59570.4853   30  158 54077.3382 71719.8676  32.6%  2783 1896s
  6289  2599 57159.3862   35  164 54077.3382 71340.9853  31.9%  2800 1922s
H 6307  2502                    54100.560228 71340.9853  31.9%  2811 1922s
  6326  2563 56981.9811   36  177 54100.5602 71340.9853  31.9%  2817 1954s
  6511  2513 54575.3268   46  113 54100.5602 71340.9853  31.9%  2816 1983s
  6664  2561     cutoff   57      54100.5602 70737.9668  30.8%  2833 2014s
  6831  2556 63993.3616   18  299 54100.5602 70702.4872  30.7%  2854 2041s
  6933  2620 63004.3331   19  267 54100.5602 70162.0502  29.7%  2871 2072s
  7096  2661 62603.8945   19  274 54100.5602 69817.1195  29.1%  2885 2118s
H 7208  2536                    54118.571578 69817.1195  29.0%  2910 2118s
  7251  2598 60496.1015   22  223 54118.5716 69817.1195  29.0%  2916 2155s
  7433  2648 59390.5499   25  174 54118.5716 69817.1195  29.0%  2943 2188s
  7680  2647 57416.5245   32  120 54118.5716 69673.8874  28.7%  2947 2222s
  7926  2649     cutoff   35      54118.5716 69673.8874  28.7%  2954 2261s
  8135  2654 61051.0249   19  252 54118.5716 68893.2090  27.3%  2975 2297s
  8363  2653 58159.8120   23  187 54118.5716 68832.5672  27.2%  2993 2334s
H 8449  2652                    54137.979067 68780.3837  27.0%  3010 2334s
  8518  2749 56135.5996   27  167 54137.9791 68780.3837  27.0%  3014 2378s
  8780  2841 58301.4222   19  269 54137.9791 68532.5814  26.6%  3031 2421s
  8990  2929 62063.3411   20  254 54137.9791 68532.5814  26.6%  3067 2463s
  9262  3024 59160.1025   24  144 54137.9791 68223.6182  26.0%  3088 2508s
  9562  3071 57558.8251   31  101 54137.9791 68129.1594  25.8%  3102 2545s
H 9579  3069                    54145.328656 68129.1594  25.8%  3101 2545s
  9713  3216 54509.9367   22  302 54145.3287 68129.1594  25.8%  3106 2594s
 10018  3341 59209.6833   24  116 54145.3287 67604.6408  24.9%  3125 2645s
 10336  3576 54288.6365   35   96 54145.3287 67580.8665  24.8%  3129 2699s
 10733  3753 56474.2498   24  288 54145.3287 67174.5469  24.1%  3132 2752s
 11142  3903 55746.3215   22  264 54145.3287 67052.6092  23.8%  3136 2814s
 11539  4068 63389.5726   20  292 54145.3287 67043.3814  23.8%  3144 2875s
 11830  4196 60193.2799   24  182 54145.3287 66739.5696  23.3%  3184 2946s
 12246  4327 55551.9832   33  165 54145.3287 66456.6614  22.7%  3200 3029s
 12655  4572 59553.4769   24  203 54145.3287 66305.6092  22.5%  3215 3095s
 13116  4778 61956.2692   19  269 54145.3287 66174.1450  22.2%  3227 3169s
 13615  4885 56021.5574   31  172 54145.3287 66174.1450  22.2%  3235 3242s
 14037  5062 61989.3618   21  275 54145.3287 66174.1450  22.2%  3264 3319s
 14525  5267 56180.7455   30  161 54145.3287 66174.1450  22.2%  3282 3391s
 15031  5500 60335.9120   27  202 54145.3287 65166.9556  20.4%  3295 3475s
 15574  5670 55767.5287   25  273 54145.3287 65042.5632  20.1%  3307 3546s
H15705  5665                    54163.146004 64841.3365  19.7%  3306 3546s
 16014  5884     cutoff   25      54163.1460 64841.3365  19.7%  3322 3600s

Cutting planes:
  Learned: 1
  MIR: 1089
  Flow cover: 2272
  RLT: 31
  Relax-and-lift: 133

Explored 16494 nodes (54992635 simplex iterations) in 3600.06 seconds (9798.61 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 54163.1 54145.3 54138 ... 51913.8

Time limit reached
Best objective 5.416314600371e+04, best bound 6.471945936249e+04, gap 19.4898%
  WARNING: Time limit reached. Using best solution found (gap: 19.49%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = 54163.15, θ = 229935.56
  Upper Bound (UB) = 54163.15

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 229935.56
  [DEBUG]   ✓ Scenario 0: θ = 229935.56 ≤ Q = 229935.56 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 229935.56 ≤ Q = 229935.56 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 229935.56 ≤ Q = 229935.56 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 229935.56 ≤ Q = 229935.56 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 229935.56 ≤ Q = 229935.56 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 229935.56 ≤ Q = 229935.56 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 229935.56 ≤ Q = 229935.56 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 229935.56 ≤ Q = 229935.56 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x5d554604
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x5d554604
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.320882e+13
Presolve removed 2550 rows and 1841 columns
Presolve time: 0.00s
Presolved: 543 rows, 548 columns, 1532 nonzeros
Found heuristic solution: objective 6961589.7687
Variable types: 372 continuous, 176 integer (176 binary)

Root relaxation: objective -1.669261e+05, 257 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -166926.11    0  123 6961589.77 -166926.11   102%     -    0s
H    0     0                    -130124.6945 -166926.11  28.3%     -    0s
H    0     0                    -131777.7612 -166926.11  26.7%     -    0s
H    0     0                    -134948.3631 -146999.65  8.93%     -    0s
     0     0 -146999.65    0  134 -134948.36 -146999.65  8.93%     -    0s
H    0     0                    -142986.6208 -146917.51  2.75%     -    0s
H    0     0                    -143684.9820 -146917.51  2.25%     -    0s
     0     0 -145417.63    0  135 -143684.98 -145417.63  1.21%     -    0s
H    0     0                    -144035.0426 -145413.67  0.96%     -    0s
     0     0 -144976.90    0   91 -144035.04 -144976.90  0.65%     -    0s
     0     0 -144771.64    0  128 -144035.04 -144771.64  0.51%     -    0s
     0     0 -144613.13    0   84 -144035.04 -144613.13  0.40%     -    0s
H    0     0                    -144044.0069 -144608.73  0.39%     -    0s
     0     0 -144597.87    0   84 -144044.01 -144597.87  0.38%     -    0s
     0     0 -144527.39    0   40 -144044.01 -144527.39  0.34%     -    0s
H    0     0                    -144150.8529 -144497.86  0.24%     -    0s
     0     0 -144497.86    0   41 -144150.85 -144497.86  0.24%     -    0s
     0     0 -144497.86    0   40 -144150.85 -144497.86  0.24%     -    0s
     0     0 -144495.06    0   40 -144150.85 -144495.06  0.24%     -    0s
     0     2 -144478.26    0   40 -144150.85 -144478.26  0.23%     -    0s
H   40    47                    -144228.9819 -144320.54  0.06%  10.2    0s
H   57    39                    -144234.0948 -144320.54  0.06%   8.7    0s
H   58    38                    -144242.0695 -144310.67  0.05%   8.8    0s
*  251   106              13    -144250.9977 -144276.31  0.02%   4.3    0s
*  541    40              17    -144253.1844 -144276.31  0.02%   3.5    0s

Cutting planes:
  Gomory: 53
  Implied bound: 2
  MIR: 170
  Flow cover: 17
  RLT: 70
  Relax-and-lift: 6
  BQP: 1

Explored 654 nodes (3045 simplex iterations) in 0.12 seconds (0.09 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -144253 -144251 -144242 ... -134948

Optimal solution found (tolerance 1.00e-04)
Best objective -1.442531843732e+05, best bound -1.442652776154e+05, gap 0.0084%
  Subproblem solved in 0.14s
  Worst-case operational profit (Z_SP) = 219929.14
  Scenario: 29 demand increases, 31 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -144253.18
  [DEBUG]   S×d_nominal = 364182.32
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 364182.32 + -144253.18 = 219929.14
  [DEBUG]   Current θ from Master = 229935.56
  [DEBUG]   ⚠️  Z_SP ≤ θ by 10006.42 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 44156.73
  Lower Bound (LB) = 48673.91
  Gap (UB-LB) = 5489.2378, Absolute Gap = 5489.2378, Relative Gap = 0.101346
  Not converged yet (gap = 5489.24 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 29 increases, 31 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394814 nonzeros
Model fingerprint: 0x4d48c4e1
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 56358 rows and 22878 columns
Presolve time: 1.22s
Presolved: 82635 rows, 35542 columns, 505019 nonzeros
Variable types: 33283 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -285874.8191
Found heuristic solution: objective -222366.7828

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.16s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.430e+06
 Factor NZ  : 7.396e+06 (roughly 100 MB of memory)
 Factor Ops : 1.199e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.49890757e+07  1.55750630e+08  1.19e+05 2.27e+01  7.37e+04     2s
   1  -1.11573557e+07  1.40297545e+08  8.19e+04 9.48e+01  5.00e+04     2s
   2  -4.97919958e+06  1.10543608e+08  3.56e+04 4.63e+00  2.25e+04     2s
   3  -1.02978785e+06  8.30459480e+07  3.38e+03 1.89e+00  2.57e+03     2s
   4  -5.56591068e+05  3.21254410e+07  5.88e+02 1.63e-01  5.23e+02     3s
   5  -3.81052710e+05  2.14929163e+07  2.65e+02 9.71e-02  2.72e+02     3s
   6  -2.87542568e+05  1.60525018e+07  9.14e+01 6.70e-02  1.48e+02     3s
   7  -1.92456300e+05  1.13276154e+07  4.64e+01 4.47e-02  9.32e+01     3s
   8  -1.08358294e+05  8.16782388e+06  1.74e+01 3.10e-02  5.98e+01     3s
   9  -8.48346500e+04  4.85253373e+06  8.44e+00 1.74e-02  3.42e+01     3s
  10  -4.17951324e+04  1.73597060e+06  1.28e+00 5.82e-03  1.18e+01     3s
  11  -3.42787536e+03  4.39100695e+05  4.78e-01 1.45e-03  2.93e+00     3s
  12   1.16391397e+04  2.54417811e+05  3.63e-01 1.10e-03  1.61e+00     3s
  13   2.53931497e+04  2.28345410e+05  2.88e-01 8.78e-04  1.34e+00     3s
  14   3.49247798e+04  1.90325858e+05  2.38e-01 9.26e-04  1.03e+00     3s
  15   4.59704845e+04  1.55387760e+05  1.85e-01 1.20e-03  7.23e-01     3s
  16   5.70005984e+04  1.39517465e+05  1.35e-01 1.35e-03  5.45e-01     3s
  17   6.24256455e+04  1.22401524e+05  1.09e-01 1.60e-03  3.96e-01     3s
  18   6.51183197e+04  1.19085551e+05  9.78e-02 1.61e-03  3.57e-01     3s
  19   7.05947508e+04  1.10809181e+05  7.64e-02 1.89e-03  2.66e-01     3s
  20   7.65609054e+04  1.05531425e+05  5.34e-02 1.47e-03  1.91e-01     3s
  21   7.78746542e+04  1.02919684e+05  4.88e-02 1.25e-03  1.66e-01     3s
  22   8.08997629e+04  1.01509358e+05  3.80e-02 1.14e-03  1.36e-01     3s
  23   8.34471248e+04  1.00200797e+05  2.89e-02 9.79e-04  1.11e-01     3s
  24   8.44615888e+04  9.95796383e+04  2.54e-02 9.05e-04  9.99e-02     3s
  25   8.55556856e+04  9.78017166e+04  2.16e-02 6.96e-04  8.09e-02     4s
  26   8.58260497e+04  9.70044826e+04  2.06e-02 5.98e-04  7.39e-02     4s
  27   8.75098150e+04  9.54375136e+04  1.49e-02 4.01e-04  5.24e-02     4s
  28   8.84651665e+04  9.44790299e+04  1.18e-02 3.01e-04  3.98e-02     4s
  29   8.96138937e+04  9.37709910e+04  8.15e-03 2.56e-04  2.75e-02     4s
  30   9.03256004e+04  9.33777787e+04  6.02e-03 1.82e-04  2.02e-02     4s
  31   9.07379380e+04  9.29357016e+04  4.75e-03 1.26e-04  1.45e-02     4s
  32   9.14047908e+04  9.26652026e+04  2.77e-03 8.24e-05  8.34e-03     4s
  33   9.16499160e+04  9.25605689e+04  2.07e-03 4.33e-05  6.03e-03     4s
  34   9.18727513e+04  9.25032319e+04  1.42e-03 2.76e-05  4.17e-03     4s
  35   9.20571811e+04  9.24710346e+04  9.02e-04 1.93e-05  2.74e-03     4s
  36   9.20852173e+04  9.24475350e+04  8.23e-04 1.34e-05  2.40e-03     4s
  37   9.22032036e+04  9.24289625e+04  5.01e-04 8.66e-06  1.49e-03     4s
  38   9.22819558e+04  9.24258509e+04  2.97e-04 7.70e-06  9.52e-04     4s
  39   9.23554327e+04  9.24108388e+04  9.34e-05 4.15e-06  3.66e-04     4s
  40   9.23725743e+04  9.23960648e+04  5.08e-05 1.03e-06  1.55e-04     4s
  41   9.23889503e+04  9.23950762e+04  1.13e-05 5.70e-07  4.05e-05     5s
  42   9.23938603e+04  9.23948028e+04  7.30e-07 4.11e-07  6.22e-06     5s
  43   9.23942649e+04  9.23942815e+04  7.21e-09 1.66e-08  1.10e-07     5s
  44   9.23942673e+04  9.23942673e+04  2.62e-10 6.96e-11  8.53e-12     5s

Barrier solved model in 44 iterations and 4.66 seconds (6.57 work units)
Optimal objective 9.23942673e+04


Root crossover log...

       0 DPushes remaining with DInf 0.0000000e+00                 7s

     520 PPushes remaining with PInf 5.5355841e-07                 7s
       0 PPushes remaining with PInf 0.0000000e+00                 7s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.2334408e-10      7s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   34351    9.2394267e+04   0.000000e+00   0.000000e+00      7s
   34351    9.2394267e+04   0.000000e+00   0.000000e+00      7s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 9.239427e+04, 34351 iterations, 5.20 seconds (9.98 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 92394.2673    0  189 -222366.78 92394.2673   142%     -    7s
H    0     0                    -215088.9874 92394.2673   143%     -    7s
H    0     0                    -74914.60006 92394.2673   223%     -    7s
H    0     0                    -74634.36974 92394.2673   224%     -    7s
H    0     0                    -46562.68688 92394.2673   298%     -    7s
H    0     0                    -46407.62591 92394.2673   299%     -    7s
H    0     0                    38322.653519 92394.2673   141%     -    7s
H    0     0                    47800.348766 92394.2673  93.3%     -    8s
H    0     0                    49753.035756 92394.2673  85.7%     -    8s
H    0     0                    49856.562470 92394.2673  85.3%     -    8s
H    0     0                    50100.318665 92394.2673  84.4%     -    8s
H    0     0                    50597.695848 85735.9314  69.4%     -   34s
     0     0 85735.9314    0  256 50597.6958 85735.9314  69.4%     -   34s
     0     0 84711.4298    0  243 50597.6958 84711.4298  67.4%     -   51s
     0     0 84702.4757    0  261 50597.6958 84702.4757  67.4%     -   58s
     0     0 84655.6592    0  238 50597.6958 84655.6592  67.3%     -   66s
     0     0 84650.0261    0  239 50597.6958 84650.0261  67.3%     -   67s
     0     0 84647.1405    0  234 50597.6958 84647.1405  67.3%     -   68s
     0     0 84647.1405    0  234 50597.6958 84647.1405  67.3%     -   69s
H    0     0                    50853.179106 81288.9514  59.9%     -  108s
     0     0 81288.9514    0  273 50853.1791 81288.9514  59.9%     -  108s
H    0     0                    51123.738689 81288.7208  59.0%     -  108s
     0     0 80745.1014    0  304 51123.7387 80745.1014  57.9%     -  122s
     0     0 80602.1371    0  290 51123.7387 80602.1371  57.7%     -  132s
     0     0 80586.9134    0  294 51123.7387 80586.9134  57.6%     -  134s
     0     0 80562.2927    0  286 51123.7387 80562.2927  57.6%     -  137s
     0     0 80553.6181    0  293 51123.7387 80553.6181  57.6%     -  140s
     0     0 80551.9755    0  287 51123.7387 80551.9755  57.6%     -  140s
     0     0 80550.9166    0  288 51123.7387 80550.9166  57.6%     -  141s
     0     0 78900.3382    0  303 51123.7387 78900.3382  54.3%     -  171s
     0     0 78553.6695    0  323 51123.7387 78553.6695  53.7%     -  184s
     0     0 78403.0734    0  352 51123.7387 78403.0734  53.4%     -  193s
     0     0 78310.8398    0  358 51123.7387 78310.8398  53.2%     -  201s
     0     0 78168.1821    0  354 51123.7387 78168.1821  52.9%     -  210s
     0     0 78094.8766    0  391 51123.7387 78094.8766  52.8%     -  216s
     0     0 78042.7233    0  361 51123.7387 78042.7233  52.7%     -  223s
     0     0 78028.7199    0  362 51123.7387 78028.7199  52.6%     -  226s
     0     0 78024.1694    0  366 51123.7387 78024.1694  52.6%     -  228s
H    0     0                    51218.500870 77983.8421  52.3%     -  234s
     0     0 77983.8421    0  357 51218.5009 77983.8421  52.3%     -  234s
     0     0 77965.8387    0  364 51218.5009 77965.8387  52.2%     -  237s
     0     0 77959.2784    0  362 51218.5009 77959.2784  52.2%     -  239s
     0     0 77942.8310    0  392 51218.5009 77942.8310  52.2%     -  242s
     0     0 77922.9972    0  354 51218.5009 77922.9972  52.1%     -  245s
     0     0 77918.2830    0  352 51218.5009 77918.2830  52.1%     -  247s
     0     0 77913.5955    0  360 51218.5009 77913.5955  52.1%     -  248s
     0     0 77909.1005    0  363 51218.5009 77909.1005  52.1%     -  249s
     0     0 77900.0748    0  366 51218.5009 77900.0748  52.1%     -  252s
     0     0 77899.7655    0  368 51218.5009 77899.7655  52.1%     -  253s
     0     0 76964.4795    0  334 51218.5009 76964.4795  50.3%     -  281s
H    0     0                    51265.195225 76964.3344  50.1%     -  282s
H    0     0                    51269.696543 76964.3344  50.1%     -  282s
H    0     0                    51306.975723 76964.3344  50.0%     -  282s
     0     0 76752.5352    0  340 51306.9757 76752.5352  49.6%     -  291s
     0     0 76656.0082    0  346 51306.9757 76656.0082  49.4%     -  297s
     0     0 76600.3436    0  367 51306.9757 76600.3436  49.3%     -  302s
     0     0 76586.4385    0  365 51306.9757 76586.4385  49.3%     -  305s
     0     0 76524.4772    0  366 51306.9757 76524.4772  49.2%     -  309s
     0     0 76482.1841    0  363 51306.9757 76482.1841  49.1%     -  313s
     0     0 76471.8865    0  360 51306.9757 76471.8865  49.0%     -  315s
     0     0 76462.8812    0  356 51306.9757 76462.8812  49.0%     -  316s
H    0     0                    51349.689790 76460.2299  48.9%     -  317s
     0     0 76460.2299    0  366 51349.6898 76460.2299  48.9%     -  317s
     0     0 76456.6650    0  361 51349.6898 76456.6650  48.9%     -  318s
     0     0 76451.6121    0  362 51349.6898 76451.6121  48.9%     -  319s
     0     0 76442.6464    0  362 51349.6898 76442.6464  48.9%     -  321s
     0     0 76440.9044    0  367 51349.6898 76440.9044  48.9%     -  322s
     0     0 76241.1662    0  398 51349.6898 76241.1662  48.5%     -  331s
     0     0 76203.8388    0  373 51349.6898 76203.8388  48.4%     -  337s
     0     0 76185.7467    0  377 51349.6898 76185.7467  48.4%     -  341s
     0     0 76179.9998    0  380 51349.6898 76179.9998  48.4%     -  343s
     0     0 76178.5648    0  410 51349.6898 76178.5648  48.4%     -  344s
     0     0 76096.2648    0  378 51349.6898 76096.2648  48.2%     -  352s
H    0     0                    51419.155724 76096.1677  48.0%     -  353s
H    0     0                    51527.327915 76096.1677  47.7%     -  353s
     0     0 76068.8346    0  397 51527.3279 76068.8346  47.6%     -  357s
     0     0 76045.4439    0  382 51527.3279 76045.4439  47.6%     -  360s
     0     0 76039.5985    0  380 51527.3279 76039.5985  47.6%     -  362s
     0     0 76036.0586    0  385 51527.3279 76036.0586  47.6%     -  364s
     0     0 76034.9940    0  392 51527.3279 76034.9940  47.6%     -  364s
     0     0 75910.4121    0  358 51527.3279 75910.4121  47.3%     -  376s
     0     0 75889.0730    0  376 51527.3279 75889.0730  47.3%     -  381s
     0     0 75883.9114    0  403 51527.3279 75883.9114  47.3%     -  383s
     0     0 75879.5802    0  405 51527.3279 75879.5802  47.3%     -  384s
     0     0 75878.9766    0  408 51527.3279 75878.9766  47.3%     -  385s
     0     0 75807.8192    0  369 51527.3279 75807.8192  47.1%     -  392s
     0     0 75774.1484    0  369 51527.3279 75774.1484  47.1%     -  397s
     0     0 75768.2262    0  370 51527.3279 75768.2262  47.0%     -  400s
     0     0 75767.3227    0  372 51527.3279 75767.3227  47.0%     -  401s
     0     0 75751.8597    0  361 51527.3279 75751.8597  47.0%     -  404s
     0     0 75749.0322    0  364 51527.3279 75749.0322  47.0%     -  405s
     0     0 75727.2059    0  364 51527.3279 75727.2059  47.0%     -  408s
H    0     0                    51544.978121 75726.9377  46.9%     -  410s
     0     0 75723.9450    0  370 51544.9781 75723.9450  46.9%     -  411s
     0     0 75723.2232    0  372 51544.9781 75723.2232  46.9%     -  412s
     0     0 75720.1464    0  365 51544.9781 75720.1464  46.9%     -  413s
     0     0 75719.6729    0  365 51544.9781 75719.6729  46.9%     -  414s
H    0     0                    51703.363169 75719.6729  46.5%     -  481s
     0     2 75719.6729    0  365 51703.3632 75719.6729  46.5%     -  482s
     1     3 75590.3690    1  349 51703.3632 75719.6729  46.5%  5719  487s
     2     4 75563.9542    1  382 51703.3632 75589.7193  46.2%  4185  494s
     3     7 75394.6229    2  373 51703.3632 75589.7193  46.2%  4887  506s
     6    13 74971.9753    3  364 51703.3632 75589.7193  46.2%  7571  531s
    12    26 74478.9609    4  372 51703.3632 75339.5025  45.7% 11037  547s
    25    39 74307.8649    4  380 51703.3632 75004.6784  45.1% 14372  589s
    38    71 72378.1462    5  392 51703.3632 75004.6784  45.1% 14612  676s
    70   119 72078.9490    6  363 51703.3632 74537.2328  44.2% 15639  704s
   118   151 71902.5369    9  371 51703.3632 74536.0963  44.2% 12225  724s
H  127   151                    51974.734590 74536.0963  43.4% 11594  724s
   150   295 71813.2021   10  324 51974.7346 74536.0963  43.4% 10545  753s
   294   326 71358.8515   15  321 51974.7346 74536.0963  43.4%  7286  766s
   325   361 71308.6203   16  318 51974.7346 74536.0963  43.4%  6983  783s
   360   410 71107.3255   17  314 51974.7346 74536.0963  43.4%  6909  796s
   409   469 71015.5317   18  311 51974.7346 74536.0963  43.4%  6592  812s
   468   540 70864.8058   19  300 51974.7346 74536.0963  43.4%  6299  856s
   539   629 70667.5663   22  327 51974.7346 74536.0963  43.4%  5981  871s
   628   720 70449.4808   24  312 51974.7346 74536.0963  43.4%  5633  886s
   719   798 70174.0749   27  303 51974.7346 74536.0963  43.4%  5368  900s
   797   877 70062.1514   29  301 51974.7346 74536.0963  43.4%  5271  912s
   876   966 69904.1283   32  261 51974.7346 74536.0963  43.4%  5163  925s
   965  1040 69637.0595   35  248 51974.7346 74536.0963  43.4%  5039  936s
  1039  1075 68976.1490   37  247 51974.7346 74536.0963  43.4%  5023  948s
  1074  1136 68883.2820   11  309 51974.7346 74536.0963  43.4%  5017  961s
  1141  1188 68962.1591   38  245 51974.7346 74536.0963  43.4%  4981  978s
  1215  1251 68775.3191   39  225 51974.7346 74536.0963  43.4%  4895  993s
  1300  1330 68679.4435   40  220 51974.7346 74536.0963  43.4%  4827 1010s
  1407  1400 59523.7253   42  211 51974.7346 74536.0963  43.4%  4770 1028s
  1499  1486     cutoff   43      51974.7346 74536.0963  43.4%  4721 1045s
  1609  1608 57514.1442   46  191 51974.7346 74536.0963  43.4%  4690 1063s
  1737  1708 56958.0606   50  172 51974.7346 74536.0963  43.4%  4559 1081s
  1867  1838 55643.4433   59  149 51974.7346 74536.0963  43.4%  4463 1100s
  2011  1925     cutoff   68      51974.7346 74536.0963  43.4%  4391 1119s
  2144  1973 71306.3054   13  311 51974.7346 74536.0963  43.4%  4341 1140s
  2216  2021 68380.0764   13  304 51974.7346 73780.6943  42.0%  4379 1164s
  2306  2061     cutoff   71      51974.7346 73780.6943  42.0%  4404 1188s
  2396  2128 68161.5324   14  293 51974.7346 73780.6943  42.0%  4434 1214s
  2483  2203 67830.3521   15  284 51974.7346 73780.6943  42.0%  4498 1241s
  2582  2312 66977.8371   19  272 51974.7346 73780.6943  42.0%  4575 1266s
  2697  2438 66928.0798   22  290 51974.7346 73780.6943  42.0%  4652 1295s
  2833  2596 66408.5107   25  269 51974.7346 73780.6943  42.0%  4704 1320s
  2995  2715 66014.6991   30  278 51974.7346 73780.6943  42.0%  4689 1352s
  3126  2880 66013.4207   31  282 51974.7346 73780.6943  42.0%  4701 1378s
  3306  2881 58067.5073   45  365 51974.7346 73780.6943  42.0%  4698 1448s
H 3307  2737                    52067.994279 73780.6943  41.7%  4696 1460s
  3309  2738 59379.6871   55  309 52067.9943 73780.6943  41.7%  4693 1505s
  3310  2739 68678.9839   41  346 52067.9943 73780.6943  41.7%  4692 1551s
  3311  2739 55626.7366   39  381 52067.9943 73780.6943  41.7%  4691 1591s
  3312  2740 53856.7298   75  345 52067.9943 73780.6943  41.7%  4689 1605s
  3313  2741 52435.8186  116  359 52067.9943 73780.6943  41.7%  4688 1622s
  3314  2741 56312.3616   60  371 52067.9943 73780.6943  41.7%  4686 1631s
H 3314  2604                    52150.480675 73780.6943  41.5%  4686 1637s
  3316  2606 70900.8685    9  366 52150.4807 73780.6943  41.5%  4683 1644s
  3317  2606 58866.7298   38  371 52150.4807 73780.6943  41.5%  4682 1649s
  3318  2607 64031.8552   24  379 52150.4807 73780.6943  41.5%  4681 1654s
  3319  2608 66928.0432   23  370 52150.4807 73780.6943  41.5%  4679 1660s
  3321  2609 56306.6625   69  365 52150.4807 73780.6943  41.5%  4676 1665s
  3322  2610 65533.9327   42  367 52150.4807 73780.6943  41.5%  4675 1671s
  3323  2610 67358.9924   16  382 52150.4807 73780.6943  41.5%  4674 1675s
H 3324  2480                    52306.147851 73780.6943  41.1%  4672 1685s
  3326  2481 54585.5114  114  367 52306.1479 73780.6943  41.1%  4669 1690s
  3328  2483 69595.4170   20  385 52306.1479 73780.6943  41.1%  4667 1698s
  3329  2483 63047.1534   38  378 52306.1479 73780.6943  41.1%  4665 1701s
  3330  2484 67059.6745   20  376 52306.1479 73780.6943  41.1%  4664 1706s
  3332  2485 65415.1372   36  371 52306.1479 73780.6943  41.1%  4661 1720s
  3334  2487 69998.3382    8  377 52306.1479 73780.6943  41.1%  4658 1725s
  3335  2487 61170.0085   67  366 52306.1479 73780.6943  41.1%  4657 1730s
  3337  2489 67155.7110   20  367 52306.1479 73780.6943  41.1%  4654 1738s
  3338  2489 62180.1502   48  358 52306.1479 73780.6943  41.1%  4653 1740s
  3340  2491 71811.8402   11  364 52306.1479 73780.6943  41.1%  4650 1746s
H 3340  2366                    52349.442911 73780.6943  40.9%  4650 1754s
H 3340  2247                    52408.816734 73780.6943  40.8%  4650 1754s
  3342  2248 63109.7451   58  362 52408.8167 73780.6943  40.8%  4647 1756s
  3344  2249 70834.8594   10  362 52408.8167 73780.6943  40.8%  4644 1762s
  3345  2250 55351.3088   67  362 52408.8167 73780.6943  40.8%  4643 1778s
H 3345  2137                    52411.667736 73780.6943  40.8%  4643 1831s
H 3346  2032                    52604.947328 73780.6943  40.3%  4724 1840s
  3347  2033 73780.6943   16  333 52604.9473 73780.6943  40.3%  4725 1868s
  3349  2037 73780.6943   17  329 52604.9473 73780.6943  40.3%  4726 1899s
  3353  2043 73780.6943   18  337 52604.9473 73780.6943  40.3%  4735 1976s
  3361  2057 73780.6943   19  337 52604.9473 73780.6943  40.3%  4770 2014s
  3377  2067 73256.6934   20  389 52604.9473 73780.6943  40.3%  4845 2080s
  3393  2094 71798.4317   21  350 52604.9473 73780.6943  40.3%  4940 2132s
H 3405  1988                    52624.004463 73780.6943  40.2%  4972 2132s
  3425  2112 71076.4708   22  335 52624.0045 73780.6943  40.2%  5011 2190s
  3556  2148 70540.0724   24  329 52624.0045 73780.6943  40.2%  5124 2218s
  3635  2193 70497.0425   25  301 52624.0045 73780.6943  40.2%  5099 2246s
  3707  2199 70512.6116   25  331 52624.0045 73780.6943  40.2%  5074 2269s
  3737  2223 69770.3926   26  322 52624.0045 73780.6943  40.2%  5085 2290s
  3771  2243 70271.4117   26  305 52624.0045 73780.6943  40.2%  5095 2314s
  3803  2272 57782.2683   35  232 52624.0045 73780.6943  40.2%  5121 2338s
  3849  2299 68570.7938   26  288 52624.0045 73780.6943  40.2%  5107 2362s
  3901  2318 68687.2377   27  306 52624.0045 73780.6943  40.2%  5098 2384s
H 3915  2216                    52683.927193 73780.6943  40.0%  5092 2384s
  3944  2252 54384.6556   44  168 52683.9272 73780.6943  40.0%  5085 2411s
  4005  2283 65433.0882   27  291 52683.9272 73780.6943  40.0%  5060 2445s
  4069  2312 64904.9268   27  327 52683.9272 73780.6943  40.0%  5058 2468s
  4131  2338     cutoff   47      52683.9272 73780.6943  40.0%  5053 2489s
  4191  2361 57724.1391   34  278 52683.9272 73780.6943  40.0%  5039 2518s
  4250  2374 65222.0608   28  286 52683.9272 73780.6943  40.0%  5030 2541s
  4316  2393 63854.3064   29  251 52683.9272 73780.6943  40.0%  5035 2567s
  4381  2400 60188.2661   30  198 52683.9272 73780.6943  40.0%  5019 2597s
  4459  2405 63888.0080   28  286 52683.9272 73569.5967  39.6%  5005 2627s
  4537  2422 64283.0479   30  301 52683.9272 73569.2018  39.6%  4998 2659s
  4619  2430 62276.6392   31  240 52683.9272 73569.2018  39.6%  4983 2695s
  4706  2440 60253.7364   32  257 52683.9272 73300.2852  39.1%  4968 2734s
  4789  2426 59318.8695   33  251 52683.9272 73300.2852  39.1%  4965 2763s
  4849  2442 58865.0031   33  229 52683.9272 73300.2852  39.1%  4969 2804s
  4908  2457 58655.2453   34  256 52683.9272 73300.2852  39.1%  4984 2843s
  4990  2444 57993.1656   35  246 52683.9272 73300.2852  39.1%  4978 2874s
  5027  2460 53565.4398   34  243 52683.9272 73300.2852  39.1%  4992 2905s
  5071  2493 57247.0037   36  265 52683.9272 73300.2852  39.1%  5007 2938s
  5138  2525 53703.1123   36  156 52683.9272 73300.2852  39.1%  5017 2982s
  5225  2526 56601.8126   38  173 52683.9272 72317.0962  37.3%  5024 3016s
H 5231  2432                    52749.593433 72317.0962  37.1%  5026 3016s
  5258  2527 56504.2021   39  169 52749.5934 72317.0962  37.1%  5037 3058s
  5384  2589 55706.6167   42  136 52749.5934 72317.0962  37.1%  5039 3112s
  5510  2659 54488.3957   43  143 52749.5934 72317.0962  37.1%  5022 3161s
  5687  2684 53180.2206   46   79 52749.5934 72317.0962  37.1%  4985 3215s
  5850  2695     cutoff   46      52749.5934 71705.4497  35.9%  4961 3272s
  6006  2702 59138.1741   25  298 52749.5934 71336.2349  35.2%  4951 3330s
  6137  2719 59656.4833   26  290 52749.5934 71208.6866  35.0%  4960 3382s
  6243  2725 58224.5232   27  253 52749.5934 70911.0895  34.4%  4962 3420s
  6296  2821 57184.2259   27  303 52749.5934 70911.0895  34.4%  4976 3473s
  6455  2833 56448.3564   28  306 52749.5934 70911.0895  34.4%  4978 3561s
  6599  2813 infeasible   32      52749.5934 70544.3703  33.7%  5006 3600s

Cutting planes:
  Gomory: 28
  Implied bound: 47
  Projected implied bound: 111
  MIR: 1588
  Mixing: 12
  Flow cover: 2326
  RLT: 22
  Relax-and-lift: 257

Explored 6643 nodes (33735260 simplex iterations) in 3600.09 seconds (9183.75 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 52749.6 52683.9 52624 ... 52068

Time limit reached
Best objective 5.274959343272e+04, best bound 7.054437034307e+04, gap 33.7344%
  WARNING: Time limit reached. Using best solution found (gap: 33.73%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.10s
  Master Objective (UB) = 52749.59, θ = 232626.65
  Upper Bound (UB) = 52749.59

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 232626.65
  [DEBUG]   ✓ Scenario 0: θ = 232626.65 ≤ Q = 232626.65 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 232626.65 ≤ Q = 232626.65 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 232626.65 ≤ Q = 232626.65 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 232626.65 ≤ Q = 232626.65 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 232626.65 ≤ Q = 232626.65 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 232626.65 ≤ Q = 232626.65 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 232626.65 ≤ Q = 232626.65 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 232626.65 ≤ Q = 232626.65 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 232626.65 ≤ Q = 232626.65 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x16be7b11
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xe94184ef
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-01, 2e+02]
Found heuristic solution: objective 1.319271e+13
Presolve removed 2549 rows and 1840 columns
Presolve time: 0.00s
Presolved: 544 rows, 549 columns, 1538 nonzeros
Found heuristic solution: objective 6979244.5030
Variable types: 373 continuous, 176 integer (176 binary)

Root relaxation: objective -1.651572e+05, 271 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -165157.24    0  128 6979244.50 -165157.24   102%     -    0s
H    0     0                    -129240.9665 -165157.24  27.8%     -    0s
H    0     0                    -132189.3627 -165157.24  24.9%     -    0s
H    0     0                    -136376.3703 -146974.59  7.77%     -    0s
     0     0 -146974.59    0  101 -136376.37 -146974.59  7.77%     -    0s
H    0     0                    -142292.2232 -146846.84  3.20%     -    0s
     0     0 -146846.84    0  100 -142292.22 -146846.84  3.20%     -    0s
H    0     0                    -143978.9702 -146846.84  1.99%     -    0s
H    0     0                    -144523.0276 -145900.57  0.95%     -    0s
     0     0 -145900.57    0   84 -144523.03 -145900.57  0.95%     -    0s
     0     0 -145867.97    0   77 -144523.03 -145867.97  0.93%     -    0s
     0     0 -145862.80    0   85 -144523.03 -145862.80  0.93%     -    0s
     0     0 -145526.22    0   46 -144523.03 -145526.22  0.69%     -    0s
     0     0 -145461.54    0   78 -144523.03 -145461.54  0.65%     -    0s
     0     0 -145460.99    0   78 -144523.03 -145460.99  0.65%     -    0s
     0     0 -145333.91    0   77 -144523.03 -145333.91  0.56%     -    0s
     0     0 -145316.64    0   77 -144523.03 -145316.64  0.55%     -    0s
     0     0 -145225.23    0   85 -144523.03 -145225.23  0.49%     -    0s
     0     0 -145201.18    0   85 -144523.03 -145201.18  0.47%     -    0s
     0     2 -145193.37    0   85 -144523.03 -145193.37  0.46%     -    0s
H  284    43                    -144530.2772 -144702.49  0.12%   5.9    0s
* 1013    35              44    -144533.4404 -144570.80  0.03%   3.8    0s

Cutting planes:
  Gomory: 20
  Implied bound: 6
  MIR: 170
  Flow cover: 12
  RLT: 38
  Relax-and-lift: 3
  BQP: 1

Explored 1098 nodes (4789 simplex iterations) in 0.12 seconds (0.12 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -144533 -144530 -144523 ... 1.31927e+13
No other solutions better than -144533

Optimal solution found (tolerance 1.00e-04)
Best objective -1.445334404466e+05, best bound -1.445334404466e+05, gap 0.0000%
  Subproblem solved in 0.14s
  Worst-case operational profit (Z_SP) = 220365.44
  Scenario: 42 demand increases, 18 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -144533.44
  [DEBUG]   S×d_nominal = 364898.88
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 364898.88 + -144533.44 = 220365.44
  [DEBUG]   Current θ from Master = 232626.65
  [DEBUG]   ⚠️  Z_SP ≤ θ by 12261.22 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 40488.38
  Lower Bound (LB) = 48673.91
  Gap (UB-LB) = 4075.6852, Absolute Gap = 4075.6852, Relative Gap = 0.077265
  Not converged yet (gap = 4075.69 > ε = 200)

  [DEBUG] Adding NEW scenario 9 to Master Problem...
  [DEBUG] New scenario pattern: 42 increases, 18 decreases
    [DEBUG] Scenario 9 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 9 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 9]
    [DEBUG]   - Total constraints in model: 154283
    [DEBUG]   - Total variables in model: 64660
  [DEBUG] Total scenarios in Master: 10
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 10
================================================================================
[Iteration 10] Solving Master Problem...
  Current scenarios in Master: 10
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 154283 rows, 64660 columns and 438069 nonzeros
Model fingerprint: 0xdc7999ee
Variable types: 62401 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 62620 rows and 25420 columns
Presolve time: 1.28s
Presolved: 91663 rows, 39240 columns, 556559 nonzeros
Variable types: 36981 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -300591.2529
Found heuristic solution: objective -222366.7828

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.19s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.989e+06
 Factor NZ  : 8.640e+06 (roughly 120 MB of memory)
 Factor Ops : 1.489e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.49875268e+07  1.71388703e+08  1.19e+05 2.17e+01  7.34e+04     2s
   1  -1.12317693e+07  1.54509205e+08  8.24e+04 9.19e+01  5.00e+04     2s
   2  -4.27061203e+06  1.23144487e+08  3.12e+04 6.97e+00  1.97e+04     2s
   3  -1.15031388e+06  9.00843278e+07  3.56e+03 1.35e+00  2.65e+03     3s
   4  -6.70983583e+05  4.15209566e+07  6.01e+02 3.00e-01  5.69e+02     3s
   5  -3.73044614e+05  2.51220570e+07  1.94e+02 1.53e-01  2.44e+02     3s
   6  -2.71496701e+05  1.89006679e+07  6.91e+01 1.06e-01  1.44e+02     3s
   7  -1.65305404e+05  1.18914009e+07  3.48e+01 6.24e-02  8.36e+01     3s
   8  -1.18762930e+05  6.36385209e+06  2.20e+01 3.08e-02  4.35e+01     3s
   9  -7.81798879e+04  3.63851205e+06  1.33e+01 1.65e-02  2.41e+01     3s
  10  -1.46000098e+04  1.13762191e+06  3.57e+00 4.50e-03  7.06e+00     3s
  11   2.21314637e+03  3.89616807e+05  2.55e+00 1.17e-03  2.37e+00     3s
  12   2.28542474e+04  2.52386959e+05  1.74e+00 1.29e-03  1.40e+00     3s
  13   3.30105473e+04  1.87552071e+05  1.37e+00 9.08e-04  9.37e-01     3s
  14   4.12427034e+04  1.58387027e+05  1.15e+00 1.21e-03  7.10e-01     3s
  15   5.21018625e+04  1.44289491e+05  8.78e-01 1.12e-03  5.58e-01     3s
  16   5.94437785e+04  1.30861368e+05  6.76e-01 1.04e-03  4.31e-01     3s
  17   6.34876746e+04  1.26666997e+05  5.79e-01 9.33e-04  3.81e-01     3s
  18   6.79975079e+04  1.19168420e+05  4.76e-01 1.04e-03  3.09e-01     3s
  19   7.22731659e+04  1.12271223e+05  3.84e-01 1.13e-03  2.41e-01     3s
  20   7.60757401e+04  1.07946832e+05  3.06e-01 1.18e-03  1.92e-01     3s
  21   7.91721264e+04  1.04410491e+05  2.45e-01 1.09e-03  1.52e-01     3s
  22   8.19470639e+04  1.03191650e+05  1.91e-01 1.26e-03  1.28e-01     3s
  23   8.30899925e+04  1.01362502e+05  1.68e-01 1.08e-03  1.10e-01     4s
  24   8.54075214e+04  9.91232591e+04  1.25e-01 9.86e-04  8.25e-02     4s
  25   8.75918341e+04  9.69113970e+04  8.71e-02 1.16e-03  5.61e-02     4s
  26   8.89331431e+04  9.56615825e+04  6.48e-02 1.22e-03  4.05e-02     4s
  27   9.01135261e+04  9.52374629e+04  4.55e-02 1.20e-03  3.08e-02     4s
  28   9.09294172e+04  9.43606840e+04  3.24e-02 1.34e-03  2.06e-02     4s
  29   9.17638851e+04  9.40927109e+04  1.96e-02 1.08e-03  1.40e-02     4s
  30   9.19824372e+04  9.38141525e+04  1.63e-02 8.26e-04  1.10e-02     4s
  31   9.21220824e+04  9.35792106e+04  1.42e-02 6.89e-04  8.77e-03     4s
  32   9.23843502e+04  9.34407839e+04  1.05e-02 5.30e-04  6.36e-03     4s
  33   9.26626908e+04  9.33709143e+04  6.48e-03 4.27e-04  4.26e-03     4s
  34   9.29217031e+04  9.32903851e+04  2.97e-03 2.36e-04  2.21e-03     4s
  35   9.30159973e+04  9.32052459e+04  1.79e-03 8.34e-05  1.14e-03     4s
  36   9.30748668e+04  9.31954762e+04  1.02e-03 6.64e-05  7.24e-04     4s
  37   9.30957059e+04  9.31773997e+04  7.61e-04 3.33e-05  4.91e-04     4s
  38   9.31237068e+04  9.31726867e+04  4.12e-04 2.34e-05  2.94e-04     4s
  39   9.31460056e+04  9.31652408e+04  1.46e-04 1.05e-05  1.15e-04     4s
  40   9.31569723e+04  9.31600821e+04  1.80e-05 1.22e-06  1.86e-05     4s
  41   9.31591482e+04  9.31592438e+04  6.73e-07 5.75e-07  5.73e-07     4s
  42   9.31592364e+04  9.31592364e+04  2.10e-09 5.39e-10  2.48e-10     5s

Barrier solved model in 42 iterations and 4.54 seconds (6.75 work units)
Optimal objective 9.31592364e+04


Root crossover log...

       0 DPushes remaining with DInf 0.0000000e+00                 6s

    1939 PPushes remaining with PInf 1.2736266e-05                 6s
       0 PPushes remaining with PInf 0.0000000e+00                 7s

  Push phase complete: Pinf 0.0000000e+00, Dinf 7.9197791e+01      7s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   33818    9.3159236e+04   0.000000e+00   7.919779e+01      7s
   33840    9.3159236e+04   0.000000e+00   0.000000e+00      7s
   33840    9.3159236e+04   0.000000e+00   0.000000e+00      7s
Concurrent spin time: 0.01s

Solved with barrier

Root relaxation: objective 9.315924e+04, 33840 iterations, 5.04 seconds (9.56 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 93159.2364    0  220 -222366.78 93159.2364   142%     -    7s
H    0     0                    -213190.7884 93159.2364   144%     -    7s
H    0     0                    -134660.9250 93159.2364   169%     -    7s
H    0     0                    -127577.9508 93159.2364   173%     -    7s
H    0     0                    -122047.5557 93159.2364   176%     -    7s
H    0     0                    -121991.6503 93159.2364   176%     -    7s
H    0     0                    -88835.72295 93159.2364   205%     -    7s
H    0     0                    -88680.66198 93159.2364   205%     -    7s
H    0     0                    -88451.11012 93159.2364   205%     -    7s
H    0     0                    -4458.444077 93159.2364  2190%     -    7s
H    0     0                    -4397.669820 93159.2364  2218%     -    7s
H    0     0                    20894.909301 93159.2364   346%     -    7s
H    0     0                    27912.043107 93159.2364   234%     -    8s
H    0     0                    35312.974820 93159.2364   164%     -    9s
H    0     0                    35401.589215 93159.2364   163%     -    9s
H    0     0                    35813.354098 93159.2364   160%     -    9s
H    0     0                    35848.563250 93159.2364   160%     -    9s
H    0     0                    36073.047569 93159.2364   158%     -    9s
H    0     0                    36144.498232 93159.2364   158%     -    9s
H    0     0                    36203.284614 93159.2364   157%     -    9s
H    0     0                    37400.656851 93159.0160   149%     -    9s
     0     0 86658.7778    0  288 37400.6569 86658.7778   132%     -   38s
H    0     0                    37685.668053 86658.6599   130%     -   39s
H    0     0                    37718.834425 86658.6599   130%     -   39s
H    0     0                    37886.059043 86164.1864   127%     -   54s
     0     0 86164.1864    0  294 37886.0590 86164.1864   127%     -   54s
     0     0 86110.3006    0  291 37886.0590 86110.3006   127%     -   63s
     0     0 86081.9161    0  292 37886.0590 86081.9161   127%     -   66s
     0     0 86046.2956    0  289 37886.0590 86046.2956   127%     -   70s
     0     0 86029.7342    0  311 37886.0590 86029.7342   127%     -   73s
     0     0 86029.7342    0  306 37886.0590 86029.7342   127%     -   73s
     0     0 82875.7218    0  340 37886.0590 82875.7218   119%     -  123s
H    0     0                    38425.456414 82875.5104   116%     -  123s
H    0     0                    38458.761552 82875.5104   115%     -  123s
H    0     0                    38595.475366 82875.5104   115%     -  123s
H    0     0                    39759.243159 82875.5104   108%     -  123s
H    0     0                    39822.462465 82517.9444   107%     -  145s
     0     0 82517.9444    0  394 39822.4625 82517.9444   107%     -  145s
     0     0 82350.8795    0  388 39822.4625 82350.8795   107%     -  155s
     0     0 82305.7816    0  396 39822.4625 82305.7816   107%     -  160s
     0     0 82225.2842    0  382 39822.4625 82225.2842   106%     -  167s
     0     0 82187.6379    0  360 39822.4625 82187.6379   106%     -  175s
     0     0 82177.7565    0  372 39822.4625 82177.7565   106%     -  177s
     0     0 82175.1721    0  372 39822.4625 82175.1721   106%     -  178s
     0     0 82169.1064    0  376 39822.4625 82169.1064   106%     -  180s
     0     0 82168.2724    0  372 39822.4625 82168.2724   106%     -  181s
H    0     0                    41318.089583 82168.2724  98.9%     -  192s
H    0     0                    41319.588119 82168.2724  98.9%     -  192s
H    0     0                    44249.888186 82168.2724  85.7%     -  192s
H    0     0                    45239.736827 79165.0174  75.0%     -  235s
     0     0 79165.0174    0  328 45239.7368 79165.0174  75.0%     -  235s
H    0     0                    45536.392817 79164.8118  73.8%     -  235s
H    0     0                    45539.483637 79164.8118  73.8%     -  236s
H    0     0                    45668.768323 79164.8118  73.3%     -  236s
H    0     0                    45679.252307 79164.8118  73.3%     -  236s
H    0     0                    45769.694906 79164.8118  73.0%     -  236s
H    0     0                    45794.974038 79164.8118  72.9%     -  236s
H    0     0                    45803.729101 79164.8118  72.8%     -  236s
H    0     0                    46150.712807 79164.8118  71.5%     -  236s
     0     0 78429.0401    0  399 46150.7128 78429.0401  69.9%     -  258s
     0     0 78274.5575    0  340 46150.7128 78274.5575  69.6%     -  269s
     0     0 78220.1225    0  356 46150.7128 78220.1225  69.5%     -  277s
H    0     0                    46188.514243 78139.0900  69.2%     -  286s
H    0     0                    48988.719038 78139.0900  59.5%     -  286s
H    0     0                    48990.918083 78139.0900  59.5%     -  286s
H    0     0                    49352.609919 78139.0900  58.3%     -  286s
H    0     0                    49412.460194 78139.0900  58.1%     -  286s
     0     0 78139.0900    0  416 49412.4602 78139.0900  58.1%     -  286s
     0     0 78111.8283    0  370 49412.4602 78111.8283  58.1%     -  290s
     0     0 78068.5374    0  373 49412.4602 78068.5374  58.0%     -  297s
     0     0 78049.7852    0  375 49412.4602 78049.7852  58.0%     -  301s
     0     0 78027.3996    0  378 49412.4602 78027.3996  57.9%     -  305s
     0     0 78012.5482    0  380 49412.4602 78012.5482  57.9%     -  307s
     0     0 78001.7995    0  353 49412.4602 78001.7995  57.9%     -  312s
     0     0 77984.7968    0  374 49412.4602 77984.7968  57.8%     -  319s
     0     0 77975.6306    0  385 49412.4602 77975.6306  57.8%     -  321s
     0     0 77973.0810    0  353 49412.4602 77973.0810  57.8%     -  322s
     0     0 77967.9267    0  383 49412.4602 77967.9267  57.8%     -  324s
     0     0 77958.1584    0  379 49412.4602 77958.1584  57.8%     -  327s
     0     0 77951.8888    0  352 49412.4602 77951.8888  57.8%     -  328s
     0     0 77943.8701    0  383 49412.4602 77943.8701  57.7%     -  330s
     0     0 77943.4917    0  383 49412.4602 77943.4917  57.7%     -  330s
H    0     0                    49424.455805 77040.0678  55.9%     -  362s
     0     0 77040.0678    0  369 49424.4558 77040.0678  55.9%     -  362s
H    0     0                    49427.388703 77039.4088  55.9%     -  362s
H    0     0                    49486.831163 77039.4088  55.7%     -  362s
H    0     0                    49768.278544 76881.4772  54.5%     -  374s
H    0     0                    50202.011317 76881.4772  53.1%     -  374s
     0     0 76881.4772    0  390 50202.0113 76881.4772  53.1%     -  374s
     0     0 76821.6582    0  398 50202.0113 76821.6582  53.0%     -  384s
     0     0 76805.2850    0  407 50202.0113 76805.2850  53.0%     -  391s
     0     0 76792.3768    0  378 50202.0113 76792.3768  53.0%     -  394s
     0     0 76766.7619    0  365 50202.0113 76766.7619  52.9%     -  400s
     0     0 76754.3673    0  393 50202.0113 76754.3673  52.9%     -  404s
     0     0 76748.0370    0  393 50202.0113 76748.0370  52.9%     -  406s
     0     0 76743.6461    0  368 50202.0113 76743.6461  52.9%     -  409s
     0     0 76741.3732    0  363 50202.0113 76741.3732  52.9%     -  410s
     0     0 76491.6261    0  375 50202.0113 76491.6261  52.4%     -  427s
     0     0 76406.0265    0  421 50202.0113 76406.0265  52.2%     -  437s
     0     0 76387.1062    0  459 50202.0113 76387.1062  52.2%     -  443s
     0     0 76376.7676    0  434 50202.0113 76376.7676  52.1%     -  447s
     0     0 76370.7699    0  478 50202.0113 76370.7699  52.1%     -  450s
     0     0 76367.7951    0  484 50202.0113 76367.7951  52.1%     -  452s
     0     0 76363.3451    0  490 50202.0113 76363.3451  52.1%     -  454s
     0     0 76362.6206    0  455 50202.0113 76362.6206  52.1%     -  455s
     0     0 76245.2314    0  455 50202.0113 76245.2314  51.9%     -  467s
     0     0 76220.4540    0  461 50202.0113 76220.4540  51.8%     -  474s
     0     0 76208.5838    0  422 50202.0113 76208.5838  51.8%     -  477s
     0     0 76196.4895    0  408 50202.0113 76196.4895  51.8%     -  481s
     0     0 76192.3260    0  441 50202.0113 76192.3260  51.8%     -  482s
H    0     0                    50275.686228 76186.7872  51.5%     -  486s
H    0     0                    50362.211853 76186.7872  51.3%     -  486s
     0     0 76186.7872    0  406 50362.2119 76186.7872  51.3%     -  486s
     0     0 76183.4382    0  408 50362.2119 76183.4382  51.3%     -  487s
     0     0 76182.6002    0  415 50362.2119 76182.6002  51.3%     -  488s
     0     0 76070.2514    0  449 50362.2119 76070.2514  51.0%     -  498s
H    0     0                    50608.176059 76069.9783  50.3%     -  498s
     0     0 76046.5178    0  414 50608.1761 76046.5178  50.3%     -  502s
     0     0 76036.0775    0  462 50608.1761 76036.0775  50.2%     -  506s
     0     0 76027.8546    0  479 50608.1761 76027.8546  50.2%     -  509s
     0     0 76023.1923    0  484 50608.1761 76023.1923  50.2%     -  511s
     0     0 76019.4647    0  433 50608.1761 76019.4647  50.2%     -  512s
     0     0 76017.3706    0  447 50608.1761 76017.3706  50.2%     -  514s
     0     0 75960.9016    0  494 50608.1761 75960.9016  50.1%     -  522s
     0     0 75946.6042    0  457 50608.1761 75946.6042  50.1%     -  528s
     0     0 75918.0660    0  466 50608.1761 75918.0660  50.0%     -  533s
     0     0 75896.3268    0  454 50608.1761 75896.3268  50.0%     -  535s
     0     0 75891.4935    0  461 50608.1761 75891.4935  50.0%     -  538s
     0     0 75890.8787    0  463 50608.1761 75890.8787  50.0%     -  539s
     0     0 75863.8721    0  448 50608.1761 75863.8721  49.9%     -  548s
     0     0 75854.4608    0  430 50608.1761 75854.4608  49.9%     -  552s
     0     0 75845.1560    0  449 50608.1761 75845.1560  49.9%     -  557s
     0     0 75838.2274    0  447 50608.1761 75838.2274  49.9%     -  560s
     0     0 75836.5340    0  448 50608.1761 75836.5340  49.9%     -  560s
     0     0 75813.8158    0  440 50608.1761 75813.8158  49.8%     -  567s
     0     0 75807.2713    0  435 50608.1761 75807.2713  49.8%     -  573s
     0     0 75806.1040    0  442 50608.1761 75806.1040  49.8%     -  575s
     0     0 75801.4925    0  424 50608.1761 75801.4925  49.8%     -  578s
     0     0 75798.0789    0  434 50608.1761 75798.0789  49.8%     -  580s
     0     0 75795.1473    0  426 50608.1761 75795.1473  49.8%     -  582s
     0     0 75794.8236    0  427 50608.1761 75794.8236  49.8%     -  583s
     0     0 75788.9461    0  421 50608.1761 75788.9461  49.8%     -  586s
     0     0 75784.9891    0  421 50608.1761 75784.9891  49.7%     -  587s
H    0     0                    51222.258784 75784.9891  48.0%     -  707s
H    0     0                    51245.487637 75784.9891  47.9%     -  708s
H    0     2                    51888.431174 75784.9891  46.1%     -  734s
     0     2 75784.9891    0  421 51888.4312 75784.9891  46.1%     -  734s
     1     4 75717.2113    1  410 51888.4312 75784.9891  46.1%  5135  745s
     3     8 75676.6693    2  415 51888.4312 75716.7161  45.9%  6578  773s
     7    16 75448.2830    3  394 51888.4312 75675.4561  45.8% 10263  815s
    15    32 75267.6487    4  385 51888.4312 75448.1448  45.4% 14665  842s
    31    48 72747.6759    5  353 51888.4312 75267.5868  45.1% 19847 1443s
    47    80 72262.6705    6  336 51888.4312 75267.5868  45.1% 21754 1480s
H   50    80                    52152.315369 75267.5868  44.3% 20884 1480s
    79   144 72194.7027    7  326 52152.3154 75267.5868  44.3% 16526 1595s
H  143   241                    52171.773632 75267.5868  44.3% 11392 1632s
   240   358 71617.8602   10  325 52171.7736 75267.5868  44.3%  9194 1663s
   357   435 71209.6230   10  270 52171.7736 75267.5868  44.3%  7601 1686s
   434   513 71387.2821   11  334 52171.7736 75267.5868  44.3%  7045 1709s
   512   542 70751.6033   11  288 52171.7736 75267.5868  44.3%  6656 1730s
   541   578 69849.2994   11  263 52171.7736 75267.5868  44.3%  6561 1755s
   577   616 70958.3988   12  316 52171.7736 75267.5868  44.3%  6420 1778s
   615   659 69871.6881   12  305 52171.7736 75267.5868  44.3%  6304 1798s
   658   706 70536.9768   13  328 52171.7736 75267.5868  44.3%  6253 1815s
   705   755 70028.9879   13  321 52171.7736 75267.5868  44.3%  6107 1832s
   754   805 70230.6739   14  321 52171.7736 75267.5868  44.3%  5880 1849s
   804   853 69901.3407   15  308 52171.7736 75267.5868  44.3%  5675 1865s
H  827   853                    52190.495656 75267.5868  44.2%  5624 1865s
   852  1001 69594.4721   16  322 52190.4957 75267.5868  44.2%  5528 1882s
  1000  1152 69047.7001   16  307 52190.4957 75267.5868  44.2%  5007 1900s
  1154  1295 69470.7491   17  315 52190.4957 75267.5868  44.2%  4573 1915s
  1305  1432 68915.3019   17  304 52190.4957 75267.5868  44.2%  4240 1932s
  1466  1589 68663.0423   17  293 52190.4957 75267.5868  44.2%  3946 1951s
  1639  1702 68462.0384   17  289 52190.4957 75267.5868  44.2%  3702 1972s
  1799  1841 69117.7503   19  319 52190.4957 75267.5868  44.2%  3515 1994s
  1948  1866 68932.2911   20  319 52190.4957 75267.5868  44.2%  3397 2012s
  1977  1889 68038.2603   20  296 52190.4957 75267.5868  44.2%  3397 2034s
  2010  1906 68593.6966   21  303 52190.4957 75267.5868  44.2%  3405 2053s
  2059  1960 68513.8949   22  379 52190.4957 75267.5868  44.2%  3385 2073s
  2149  2013 64191.9619   23  321 52190.4957 75267.5868  44.2%  3318 2096s
  2260  2109 68238.6066   21  316 52190.4957 75267.5868  44.2%  3258 2120s
  2406  2196 68312.0206   23  351 52190.4957 75267.5868  44.2%  3173 2145s
  2572  2289 67901.0144   24  373 52190.4957 75267.5868  44.2%  3095 2171s
  2739  2368 65870.2156   22  371 52190.4957 75051.7771  43.8%  3065 2202s
  2884  2428 66984.7857   24  312 52190.4957 75051.6704  43.8%  3061 2231s
  3020  2486 65791.2648   25  288 52190.4957 75051.6704  43.8%  3067 2264s
  3120  2583 73658.4211    6  358 52190.4957 75051.6704  43.8%  3112 2299s
  3257  2607 66149.2313   25  302 52190.4957 75051.6704  43.8%  3140 2330s
  3297  2642 66693.9542   25  308 52190.4957 75051.6704  43.8%  3177 2362s
  3336  2680 66629.5172   26  303 52190.4957 75051.6704  43.8%  3199 2383s
H 3340  2680                    52271.991886 75051.6704  43.6%  3200 2383s
  3374  2790 66515.6605   27  342 52271.9919 75051.6704  43.6%  3225 2419s
  3521  2923 65919.1285   29  309 52271.9919 74895.3784  43.3%  3244 2459s
  3661  2924 68487.4047   14  421 52271.9919 74895.3784  43.3%  3284 2576s
  3663  2925 69845.1535    9  129 52271.9919 74895.3784  43.3%  3283 2588s
  3664  2926 67474.4704   20  322 52271.9919 74895.3784  43.3%  3282 2646s
H 3664  2779                    52395.302184 74895.3784  42.9%  3282 2696s
  3666  2780 73713.3616    7  350 52395.3022 74895.3784  42.9%  3280 2735s
  3667  2781 66291.7392   11  408 52395.3022 74895.3784  42.9%  3279 2758s
  3668  2782 54050.8623   32  398 52395.3022 74895.3784  42.9%  3278 2776s
  3669  2782 70553.0092   10  369 52395.3022 74895.3784  42.9%  3277 2787s
  3670  2783 53903.4572   61  449 52395.3022 74895.3784  42.9%  3276 2798s
  3671  2784 54451.8991   54  381 52395.3022 74895.3784  42.9%  3275 2807s
  3672  2784 68204.7156   24  403 52395.3022 74895.3784  42.9%  3275 2813s
  3673  2785 69758.8785   15  417 52395.3022 74895.3784  42.9%  3274 2822s
  3674  2786 55864.8119   91  423 52395.3022 74895.3784  42.9%  3273 2829s
  3675  2786 54217.3444  107  427 52395.3022 74895.3784  42.9%  3272 2835s
  3677  2788 57250.3434   38  386 52395.3022 74895.3784  42.9%  3270 2853s
  3678  2788 61374.9648   32  461 52395.3022 74895.3784  42.9%  3269 2860s
  3680  2790 53251.8056   93  385 52395.3022 74895.3784  42.9%  3267 2865s
  3682  2791 59809.8571   62  392 52395.3022 74895.3784  42.9%  3266 2878s
  3683  2792 53389.0856  138  399 52395.3022 74895.3784  42.9%  3265 2880s
H 3683  2652                    52452.705916 74895.3784  42.8%  3265 2888s
  3684  2652 54493.6442  111  421 52452.7059 74895.3784  42.8%  3264 2893s
  3685  2653 68685.3769   13  385 52452.7059 74895.3784  42.8%  3263 2897s
  3687  2654 54471.8968   50  394 52452.7059 74895.3784  42.8%  3261 2902s
  3688  2655 68798.5612   18  385 52452.7059 74895.3784  42.8%  3260 2914s
  3689  2656 70241.6250    7  417 52452.7059 74895.3784  42.8%  3259 2920s
  3691  2657 53000.6885   90  385 52452.7059 74895.3784  42.8%  3258 2925s
H 3692  2525                    52521.353251 74895.3784  42.6%  3257 2939s
  3694  2526 68806.9837   11  378 52521.3533 74895.3784  42.6%  3255 2942s
  3695  2527 55578.1852   91  386 52521.3533 74895.3784  42.6%  3254 2945s
  3696  2527 65436.0218   31  376 52521.3533 74895.3784  42.6%  3253 2951s
  3697  2528 55335.8171   54  372 52521.3533 74895.3784  42.6%  3252 2957s
  3698  2529 67474.4704   20  371 52521.3533 74895.3784  42.6%  3252 2960s
  3699  2529 55458.7161   88  382 52521.3533 74895.3784  42.6%  3251 2973s
  3700  2530 70958.9912   12  376 52521.3533 74895.3784  42.6%  3250 2979s
  3701  2531 63154.0384   33  376 52521.3533 74895.3784  42.6%  3249 2983s
  3702  2531 64163.4219   15  384 52521.3533 74895.3784  42.6%  3248 2985s
  3703  2532 66219.2225   33  385 52521.3533 74895.3784  42.6%  3247 2990s
  3705  2533 66590.5638   10  381 52521.3533 74895.3784  42.6%  3245 2998s
  3706  2534 61658.2375   22  381 52521.3533 74895.3784  42.6%  3245 3015s
  3707  2535 56301.4771   33  381 52521.3533 74895.3784  42.6%  3244 3090s
  3708  2538 74895.3784   13  373 52521.3533 74895.3784  42.6%  3339 3138s
  3710  2542 74895.3784   14  371 52521.3533 74895.3784  42.6%  3342 3175s
  3714  2548 74895.3784   15  365 52521.3533 74895.3784  42.6%  3351 3238s
  3722  2562 74665.7750   16  364 52521.3533 74895.3784  42.6%  3382 3280s
  3738  2572 72902.0735   17  385 52521.3533 74665.7414  42.2%  3482 3403s
  3754  2599 70716.5265   18  392 52521.3533 74665.7414  42.2%  3532 3463s
H 3755  2471                    52588.261563 74665.7414  42.0%  3531 3463s
  3786  2604 70564.0304   19  368 52588.2616 74665.7414  42.0%  3657 3528s
  3930  2587 69151.3906   21  308 52588.2616 74665.7414  42.0%  3788 3550s
  3961  2614 68856.6215   22  346 52588.2616 74665.7414  42.0%  3802 3573s
  3998  2644 68690.8834   23  298 52588.2616 74665.7414  42.0%  3806 3598s
  4040  2629     cutoff   27      52588.2616 74665.7414  42.0%  3830 3600s

Cutting planes:
  Learned: 4
  Gomory: 29
  Implied bound: 45
  Projected implied bound: 148
  MIR: 1363
  Mixing: 7
  Flow cover: 1580
  RLT: 40
  Relax-and-lift: 335

Explored 4041 nodes (16028251 simplex iterations) in 3600.02 seconds (8200.83 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 52588.3 52521.4 52452.7 ... 51245.5

Time limit reached
Best objective 5.258826156314e+04, best bound 7.466574139202e+04, gap 41.9818%
  WARNING: Time limit reached. Using best solution found (gap: 41.98%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3600.03s
  Master Objective (UB) = 52588.26, θ = 232300.41
  Upper Bound (UB) = 52588.26

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 232300.41
  [DEBUG]   ✓ Scenario 0: θ = 232300.41 ≤ Q = 232300.41 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 232300.41 ≤ Q = 232300.41 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 232300.41 ≤ Q = 232300.41 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 232300.41 ≤ Q = 232300.41 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 232300.41 ≤ Q = 232300.41 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 232300.41 ≤ Q = 232300.41 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 232300.41 ≤ Q = 232300.41 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 232300.41 ≤ Q = 232300.41 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 232300.41 ≤ Q = 232300.41 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 232300.41 ≤ Q = 232300.41 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 10] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x665e7aa4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x99a1855c
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.321054e+13
Presolve removed 2548 rows and 1839 columns
Presolve time: 0.00s
Presolved: 545 rows, 550 columns, 1538 nonzeros
Found heuristic solution: objective 6973427.6664
Variable types: 374 continuous, 176 integer (176 binary)

Root relaxation: objective -1.655348e+05, 275 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -165534.81    0  133 6973427.67 -165534.81   102%     -    0s
H    0     0                    -127762.2549 -165534.81  29.6%     -    0s
H    0     0                    -129935.1422 -165534.81  27.4%     -    0s
     0     0 -145509.19    0  101 -129935.14 -145509.19  12.0%     -    0s
H    0     0                    -142058.6534 -145441.33  2.38%     -    0s
H    0     0                    -142376.9381 -145441.33  2.15%     -    0s
H    0     0                    -142918.7158 -145441.33  1.77%     -    0s
H    0     0                    -143237.0004 -145441.33  1.54%     -    0s
H    0     0                    -143244.9938 -145432.04  1.53%     -    0s
     0     0 -145432.04    0   98 -143244.99 -145432.04  1.53%     -    0s
     0     0 -144372.94    0  101 -143244.99 -144372.94  0.79%     -    0s
H    0     0                    -143283.6431 -144296.46  0.71%     -    0s
H    0     0                    -143303.5848 -144264.43  0.67%     -    0s
     0     0 -144264.43    0   70 -143303.58 -144264.43  0.67%     -    0s
     0     0 -144043.62    0   66 -143303.58 -144043.62  0.52%     -    0s
H    0     0                    -143507.4205 -144031.26  0.37%     -    0s
     0     0 -144001.25    0   61 -143507.42 -144001.25  0.34%     -    0s
     0     0 -143994.46    0   71 -143507.42 -143994.46  0.34%     -    0s
     0     0 -143961.43    0   33 -143507.42 -143961.43  0.32%     -    0s
     0     0 -143961.23    0   33 -143507.42 -143961.23  0.32%     -    0s
H    0     0                    -143730.5011 -143955.88  0.16%     -    0s
H    0     0                    -143848.9448 -143955.88  0.07%     -    0s
     0     0 -143955.88    0   33 -143848.94 -143955.88  0.07%     -    0s
     0     0 -143928.04    0   30 -143848.94 -143928.04  0.05%     -    0s
     0     0 -143911.15    0   30 -143848.94 -143911.15  0.04%     -    0s
     0     0 -143911.15    0   61 -143848.94 -143911.15  0.04%     -    0s
     0     0 -143911.15    0   61 -143848.94 -143911.15  0.04%     -    0s
     0     0 -143911.15    0   49 -143848.94 -143911.15  0.04%     -    0s
     0     0 -143911.15    0   46 -143848.94 -143911.15  0.04%     -    0s
     0     0 -143911.15    0   31 -143848.94 -143911.15  0.04%     -    0s
     0     0 -143911.15    0   28 -143848.94 -143911.15  0.04%     -    0s
     0     0 -143873.97    0   10 -143848.94 -143873.97  0.02%     -    0s
H    0     0                    -143852.1081 -143872.59  0.01%     -    0s
     0     0 -143872.59    0   10 -143852.11 -143872.59  0.01%     -    0s
     0     0          -    0      -143852.11 -143863.03  0.01%     -    0s

Cutting planes:
  Gomory: 10
  Implied bound: 12
  MIR: 51
  Flow cover: 3
  Relax-and-lift: 3

Explored 1 nodes (911 simplex iterations) in 0.11 seconds (0.07 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -143852 -143849 -143731 ... -142919

Optimal solution found (tolerance 1.00e-04)
Best objective -1.438521080935e+05, best bound -1.438630328161e+05, gap 0.0076%
  Subproblem solved in 0.13s
  Worst-case operational profit (Z_SP) = 220615.13
  Scenario: 28 demand increases, 32 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -143852.11
  [DEBUG]   S×d_nominal = 364467.24
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 364467.24 + -143852.11 = 220615.13
  [DEBUG]   Current θ from Master = 232300.41
  [DEBUG]   ⚠️  Z_SP ≤ θ by 11685.28 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 40902.98
  Lower Bound (LB) = 48673.91
  Gap (UB-LB) = 3914.3533, Absolute Gap = 3914.3533, Relative Gap = 0.074434
  Not converged yet (gap = 3914.35 > ε = 200)

  [DEBUG] Adding NEW scenario 10 to Master Problem...
  [DEBUG] New scenario pattern: 28 increases, 32 decreases
    [DEBUG] Scenario 10 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 10 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 10]
    [DEBUG]   - Total constraints in model: 169573
    [DEBUG]   - Total variables in model: 70900
  [DEBUG] Total scenarios in Master: 11
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 11
================================================================================
[Iteration 11] Solving Master Problem...
  Current scenarios in Master: 11
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 169573 rows, 70900 columns and 481324 nonzeros
Model fingerprint: 0xac538f81
Variable types: 68641 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 68882 rows and 27962 columns
Presolve time: 1.44s
Presolved: 100691 rows, 42938 columns, 607109 nonzeros
Variable types: 40679 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -306019.7200
Found heuristic solution: objective -222366.7828

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.21s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 4.524e+06
 Factor NZ  : 1.006e+07 (roughly 140 MB of memory)
 Factor Ops : 1.834e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.56027812e+07  1.86338906e+08  1.24e+05 2.09e+01  7.59e+04     3s
   1  -1.17529282e+07  1.69598307e+08  8.58e+04 9.23e+01  5.18e+04     3s
   2  -5.58423885e+06  1.34723221e+08  4.02e+04 5.37e+00  2.50e+04     3s
   3  -1.25557629e+06  1.03174327e+08  4.62e+03 1.52e+00  3.30e+03     3s
   4  -6.37309144e+05  4.38788876e+07  6.79e+02 3.05e-01  6.03e+02     3s
   5  -3.71441455e+05  2.99050352e+07  2.20e+02 1.72e-01  2.72e+02     3s
   6  -3.15261419e+05  2.44348984e+07  1.04e+02 1.34e-01  1.82e+02     3s
   7  -2.41110772e+05  2.12513895e+07  6.27e+01 1.14e-01  1.43e+02     3s
   8  -1.25528474e+05  1.40978911e+07  1.95e+01 7.11e-02  8.38e+01     3s
   9  -8.73185851e+04  1.17064745e+07  1.12e+01 5.79e-02  6.72e+01     3s
  10  -6.78084834e+04  4.75344130e+06  7.88e+00 2.19e-02  2.73e+01     3s
  11  -8.68304784e+03  6.35818840e+05  1.84e+00 2.03e-03  3.55e+00     3s
  12   2.13718546e+04  3.86880637e+05  1.09e+00 1.14e-03  2.00e+00     3s
  13   3.16138904e+04  2.75661613e+05  8.20e-01 1.02e-03  1.34e+00     3s
  14   4.04992835e+04  2.13707027e+05  6.22e-01 7.66e-04  9.46e-01     3s
  15   4.88232535e+04  1.80980172e+05  4.66e-01 8.25e-04  7.21e-01     3s
  16   5.70041295e+04  1.48226127e+05  3.56e-01 2.40e-03  4.97e-01     4s
  17   6.18997465e+04  1.34610947e+05  3.00e-01 2.05e-03  3.96e-01     4s
  18   6.86835140e+04  1.22186390e+05  2.28e-01 1.47e-03  2.92e-01     4s
  19   7.06909357e+04  1.12237816e+05  2.07e-01 1.11e-03  2.27e-01     4s
  20   7.49530772e+04  1.07831570e+05  1.67e-01 1.48e-03  1.79e-01     4s
  21   7.82841972e+04  1.05594352e+05  1.37e-01 1.14e-03  1.49e-01     4s
  22   8.11494921e+04  1.02633889e+05  1.10e-01 1.22e-03  1.17e-01     4s
  23   8.37132827e+04  1.00965825e+05  8.73e-02 9.48e-04  9.41e-02     4s
  24   8.68831141e+04  9.91984467e+04  5.95e-02 1.30e-03  6.71e-02     4s
  25   8.81495938e+04  9.72523444e+04  4.87e-02 1.24e-03  4.96e-02     4s
  26   8.99936837e+04  9.63098483e+04  3.40e-02 1.01e-03  3.44e-02     4s
  27   9.10259829e+04  9.62007005e+04  2.61e-02 9.05e-04  2.82e-02     4s
  28   9.22338881e+04  9.55455725e+04  1.67e-02 6.49e-04  1.81e-02     4s
  29   9.27719973e+04  9.53168802e+04  1.26e-02 5.71e-04  1.39e-02     4s
  30   9.33368455e+04  9.50093120e+04  8.35e-03 3.75e-04  9.12e-03     4s
  31   9.35748438e+04  9.49201727e+04  6.57e-03 3.10e-04  7.33e-03     4s
  32   9.36706589e+04  9.48498997e+04  5.86e-03 3.17e-04  6.43e-03     4s
  33   9.38975958e+04  9.47985430e+04  4.18e-03 3.12e-04  4.91e-03     4s
  34   9.40240343e+04  9.46749028e+04  3.27e-03 1.76e-04  3.55e-03     5s
  35   9.41859604e+04  9.45877412e+04  2.06e-03 1.27e-04  2.19e-03     5s
  36   9.42462906e+04  9.45754940e+04  1.66e-03 1.09e-04  1.79e-03     5s
  37   9.43148054e+04  9.45458752e+04  1.21e-03 6.70e-05  1.26e-03     5s
  38   9.43736471e+04  9.45318294e+04  8.01e-04 6.10e-05  8.62e-04     5s
  39   9.43915825e+04  9.45301756e+04  6.80e-04 5.79e-05  7.55e-04     5s
  40   9.44108451e+04  9.45240083e+04  5.49e-04 4.70e-05  6.17e-04     5s
  41   9.44451753e+04  9.45041897e+04  3.20e-04 1.27e-05  3.22e-04     5s
  42   9.44684338e+04  9.45022133e+04  1.69e-04 9.07e-06  1.84e-04     5s
  43   9.44690547e+04  9.45000297e+04  1.65e-04 5.96e-06  1.69e-04     5s
  44   9.44834805e+04  9.44972107e+04  7.43e-05 1.75e-06  7.49e-05     5s
  45   9.44945253e+04  9.44969457e+04  4.10e-06 1.32e-06  1.31e-05     5s
  46   9.44956015e+04  9.44962317e+04  6.54e-07 4.58e-07  3.42e-06     5s
  47   9.44958381e+04  9.44958479e+04  3.85e-08 1.18e-08  5.34e-08     5s
  48   9.44958421e+04  9.44958421e+04  5.88e-10 1.64e-10  5.34e-11     5s

Barrier solved model in 48 iterations and 5.41 seconds (8.47 work units)
Optimal objective 9.44958421e+04


Root crossover log...

   86705 DPushes remaining with DInf 1.3441840e-08                 5s
       0 DPushes remaining with DInf 0.0000000e+00                 7s

    1451 PPushes remaining with PInf 1.7416003e-06                 7s
       0 PPushes remaining with PInf 0.0000000e+00                 7s

  Push phase complete: Pinf 0.0000000e+00, Dinf 9.3256304e-11      7s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   32181    9.4495842e+04   0.000000e+00   0.000000e+00      7s
   32181    9.4495842e+04   0.000000e+00   0.000000e+00      7s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 9.449584e+04, 32181 iterations, 5.49 seconds (9.95 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 94495.8421    0  241 -222366.78 94495.8421   142%     -    7s
H    0     0                    -217715.7736 94495.8421   143%     -    7s
H    0     0                    -121872.4187 94495.8421   178%     -    8s
H    0     0                    -121162.3273 94495.8421   178%     -    8s
H    0     0                    -109432.7899 94495.8421   186%     -    8s
H    0     0                    -109395.1171 94495.8421   186%     -    8s
H    0     0                    -57607.97024 94495.8421   264%     -    8s
H    0     0                    33026.695553 94495.8421   186%     -    8s
H    0     0                    39172.264126 94495.8421   141%     -    9s
H    0     0                    39398.310309 94495.8421   140%     -    9s
H    0     0                    39419.925087 94495.8421   140%     -    9s
H    0     0                    39487.921566 94495.8421   139%     -    9s
H    0     0                    39755.303860 94495.8421   138%     -    9s
H    0     0                    47521.823405 94495.8421  98.8%     -   10s
H    0     0                    48449.966508 94495.8421  95.0%     -   10s
H    0     0                    48664.503413 94495.8421  94.2%     -   10s
H    0     0                    48920.291569 94495.8421  93.2%     -   10s
H    0     0                    49132.254737 94495.8421  92.3%     -   10s
H    0     0                    49289.324743 94495.8421  91.7%     -   10s
H    0     0                    49874.505535 86829.2859  74.1%     -   43s
H    0     0                    50163.748845 86829.2859  73.1%     -   43s
H    0     0                    50640.849875 86829.2859  71.5%     -   43s
     0     0 86829.2859    0  281 50640.8499 86829.2859  71.5%     -   44s
H    0     0                    50658.529764 86829.1883  71.4%     -   45s
H    0     0                    50661.380767 86829.1883  71.4%     -   45s
     0     0 86274.2770    0  284 50661.3808 86274.2770  70.3%     -   62s
     0     0 86156.4577    0  320 50661.3808 86156.4577  70.1%     -   75s
     0     0 86021.9473    0  313 50661.3808 86021.9473  69.8%     -   86s
     0     0 86012.7067    0  318 50661.3808 86012.7067  69.8%     -   90s
     0     0 86012.2943    0  321 50661.3808 86012.2943  69.8%     -   91s
     0     0 82286.6212    0  369 50661.3808 82286.6212  62.4%     -  140s
H    0     0                    50684.468628 81456.7474  60.7%     -  170s
H    0     0                    50792.893755 81456.7474  60.4%     -  170s
H    0     0                    50891.815798 81456.7474  60.1%     -  170s
     0     0 81456.7474    0  383 50891.8158 81456.7474  60.1%     -  170s
     0     0 81247.6805    0  382 50891.8158 81247.6805  59.6%     -  189s
     0     0 81176.7840    0  382 50891.8158 81176.7840  59.5%     -  199s
     0     0 81147.7206    0  388 50891.8158 81147.7206  59.5%     -  205s
     0     0 81130.6500    0  388 50891.8158 81130.6500  59.4%     -  209s
     0     0 81092.1478    0  393 50891.8158 81092.1478  59.3%     -  216s
     0     0 81055.9254    0  430 50891.8158 81055.9254  59.3%     -  223s
     0     0 81040.1166    0  391 50891.8158 81040.1166  59.2%     -  228s
     0     0 80990.9941    0  430 50891.8158 80990.9941  59.1%     -  241s
     0     0 80978.3625    0  425 50891.8158 80978.3625  59.1%     -  247s
     0     0 80971.5416    0  430 50891.8158 80971.5416  59.1%     -  250s
     0     0 80971.1218    0  432 50891.8158 80971.1218  59.1%     -  251s
H    0     0                    51041.313017 78719.4912  54.2%     -  329s
H    0     0                    51344.451630 78719.4912  53.3%     -  329s
H    0     0                    51392.053963 78719.4912  53.2%     -  329s
H    0     0                    51435.944040 78719.4912  53.0%     -  329s
     0     0 78719.4912    0  383 51435.9440 78719.4912  53.0%     -  329s
     0     0 78338.5579    0  405 51435.9440 78338.5579  52.3%     -  354s
     0     0 78121.4839    0  371 51435.9440 78121.4839  51.9%     -  371s
     0     0 78030.8095    0  366 51435.9440 78030.8095  51.7%     -  384s
     0     0 77997.7761    0  370 51435.9440 77997.7761  51.6%     -  392s
     0     0 77867.5907    0  357 51435.9440 77867.5907  51.4%     -  404s
     0     0 77856.1852    0  386 51435.9440 77856.1852  51.4%     -  409s
     0     0 77846.6736    0  437 51435.9440 77846.6736  51.3%     -  414s
     0     0 77839.8794    0  386 51435.9440 77839.8794  51.3%     -  417s
     0     0 77838.2818    0  388 51435.9440 77838.2818  51.3%     -  420s
     0     0 77067.8744    0  424 51435.9440 77067.8744  49.8%     -  463s
H    0     0                    51459.118234 76891.5174  49.4%     -  481s
     0     0 76891.5174    0  455 51459.1182 76891.5174  49.4%     -  481s
     0     0 76703.1956    0  413 51459.1182 76703.1956  49.1%     -  494s
     0     0 76674.2827    0  363 51459.1182 76674.2827  49.0%     -  501s
     0     0 76664.2030    0  351 51459.1182 76664.2030  49.0%     -  504s
     0     0 76650.0261    0  373 51459.1182 76650.0261  49.0%     -  507s
     0     0 76635.8282    0  366 51459.1182 76635.8282  48.9%     -  510s
     0     0 76619.2949    0  381 51459.1182 76619.2949  48.9%     -  516s
     0     0 76596.7393    0  423 51459.1182 76596.7393  48.8%     -  522s
     0     0 76584.5701    0  421 51459.1182 76584.5701  48.8%     -  525s
     0     0 76581.1006    0  419 51459.1182 76581.1006  48.8%     -  527s
     0     0 76572.2801    0  414 51459.1182 76572.2801  48.8%     -  531s
     0     0 76567.6726    0  421 51459.1182 76567.6726  48.8%     -  533s
     0     0 76567.3389    0  417 51459.1182 76567.3389  48.8%     -  534s
     0     0 76432.1175    0  365 51459.1182 76432.1175  48.5%     -  551s
     0     0 76376.5324    0  394 51459.1182 76376.5324  48.4%     -  565s
     0     0 76334.8762    0  436 51459.1182 76334.8762  48.3%     -  575s
     0     0 76325.7665    0  400 51459.1182 76325.7665  48.3%     -  579s
     0     0 76298.8871    0  399 51459.1182 76298.8871  48.3%     -  585s
     0     0 76285.9470    0  438 51459.1182 76285.9470  48.2%     -  589s
     0     0 76271.4150    0  426 51459.1182 76271.4150  48.2%     -  594s
     0     0 76264.7109    0  434 51459.1182 76264.7109  48.2%     -  597s
     0     0 76263.6041    0  425 51459.1182 76263.6041  48.2%     -  598s
     0     0 76150.6022    0  369 51459.1182 76150.6022  48.0%     -  613s
H    0     0                    51846.418179 76150.5723  46.9%     -  622s
     0     0 76109.9218    0  411 51846.4182 76109.9218  46.8%     -  634s
     0     0 76086.3355    0  405 51846.4182 76086.3355  46.8%     -  641s
     0     0 76075.9170    0  384 51846.4182 76075.9170  46.7%     -  645s
     0     0 76070.6181    0  362 51846.4182 76070.6181  46.7%     -  649s
     0     0 76065.1873    0  368 51846.4182 76065.1873  46.7%     -  653s
     0     0 76061.9431    0  360 51846.4182 76061.9431  46.7%     -  655s
     0     0 76060.9947    0  362 51846.4182 76060.9947  46.7%     -  656s
     0     0 75988.9232    0  370 51846.4182 75988.9232  46.6%     -  667s
     0     0 75952.4930    0  403 51846.4182 75952.4930  46.5%     -  678s
     0     0 75930.1207    0  349 51846.4182 75930.1207  46.5%     -  684s
     0     0 75914.4987    0  364 51846.4182 75914.4987  46.4%     -  687s
     0     0 75910.3855    0  380 51846.4182 75910.3855  46.4%     -  690s
     0     0 75909.3206    0  381 51846.4182 75909.3206  46.4%     -  691s
     0     0 75869.0258    0  376 51846.4182 75869.0258  46.3%     -  702s
     0     0 75863.7317    0  387 51846.4182 75863.7317  46.3%     -  716s
     0     0 75862.1436    0  384 51846.4182 75862.1436  46.3%     -  719s
     0     0 75844.4928    0  374 51846.4182 75844.4928  46.3%     -  725s
     0     0 75833.2648    0  377 51846.4182 75833.2648  46.3%     -  731s
     0     0 75831.2485    0  376 51846.4182 75831.2485  46.3%     -  732s
     0     0 75826.4508    0  376 51846.4182 75826.4508  46.3%     -  735s
     0     0 75826.3753    0  376 51846.4182 75826.3753  46.3%     -  737s
     0     2 75826.2398    0  376 51846.4182 75826.2398  46.3%     -  913s
     1     4 75514.3445    1  355 51846.4182 75826.2270  46.3%  9468  939s
     3     8 75097.7426    2  361 51846.4182 75513.4033  45.6% 13570  959s
     7    16 74637.7706    3  356 51846.4182 75097.4337  44.8% 14019  991s
    15    31 74486.6898    4  360 51846.4182 74635.1360  44.0% 16210 1022s
    30    46 73797.3055    5  349 51846.4182 74486.5884  43.7% 29148 2245s
    45    77 73189.2794    6  369 51846.4182 74486.5884  43.7% 25907 2427s
    76   226 72643.9886    7  350 51846.4182 74486.5884  43.7% 22689 2486s
   225   258 71808.3969   11  336 51846.4182 74486.5884  43.7% 12332 2511s
   257   288 71780.7279   12  329 51846.4182 74486.5884  43.7% 11968 2535s
   287   315 71720.2612   13  324 51846.4182 74486.5884  43.7% 11404 2559s
H  297   315                    52003.056037 74486.5884  43.2% 11248 2559s
   314   376 71662.2829   14  323 52003.0560 74486.5884  43.2% 10955 2586s
   375   405 71236.7978   12  323 52003.0560 74486.5884  43.2%  9974 2609s
   404   438 71481.2879   17  311 52003.0560 74486.5884  43.2%  9873 2632s
   437   470 71442.2962   18  320 52003.0560 74486.5884  43.2%  9517 2654s
H  460   470                    52010.029834 74486.5884  43.2%  9363 2654s
   469   543 71374.3049   20  308 52010.0298 74486.5884  43.2%  9297 2678s
   542   605 70965.5182   23  296 52010.0298 74486.5884  43.2%  8936 2701s
   604   670 70813.8029   26  281 52010.0298 74486.5884  43.2%  8906 2722s
   669   733 70550.9326   29  288 52010.0298 74486.5884  43.2%  8842 2744s
   732   793 70377.7284   32  291 52010.0298 74486.5884  43.2%  8860 2767s
   792   855 70217.9332   33  295 52010.0298 74486.5884  43.2%  8877 2787s
   854   917 69679.4478   34  279 52010.0298 74486.5884  43.2%  8810 2810s
   916   986 69511.6683   35  273 52010.0298 74486.5884  43.2%  8747 2831s
   985  1070 69292.4675   38  255 52010.0298 74486.5884  43.2%  8715 2851s
  1073  1144 68945.8119   43  266 52010.0298 74486.5884  43.2%  8597 2873s
  1151  1222 68275.7649   45  252 52010.0298 74486.5884  43.2%  8490 2897s
  1235  1317 61065.9698   47  184 52010.0298 74486.5884  43.2%  8442 2920s
  1330  1428 61065.7745   48  185 52010.0298 74486.5884  43.2%  8330 2944s
  1445  1549 60492.1613   55  191 52010.0298 74486.5884  43.2%  8155 2967s
  1596  1576 59742.7317   65  151 52010.0298 74486.5884  43.2%  7896 2995s
  1627  1605 54352.5191   66  143 52010.0298 74486.5884  43.2%  7886 3020s
  1666  1653 54268.0578   67  141 52010.0298 74486.5884  43.2%  8092 3050s
  1718  1700 54224.3513   68  138 52010.0298 74486.5884  43.2%  8052 3078s
  1767  1749 54198.0425   69  138 52010.0298 74486.5884  43.2%  8037 3104s
  1816  1819 54076.3101   70  129 52010.0298 74486.5884  43.2%  8034 3127s
  1890  1938 53204.0647   71  122 52010.0298 74486.5884  43.2%  7935 3153s
  2037  2072 infeasible   66      52010.0298 74486.5884  43.2%  7685 3187s
  2201  2106 54215.5162   66  120 52010.0298 74486.5884  43.2%  7462 3221s
  2277  2246 57561.2988   35  219 52010.0298 74486.5884  43.2%  7436 3254s
  2445  2397 52763.6751   36  170 52010.0298 74266.1583  42.8%  7304 3291s
  2648  2495 73256.7193    6  331 52010.0298 74266.1583  42.8%  7174 3334s
  2846  2640 72576.6085    7  366 52010.0298 74266.1583  42.8%  7021 3375s
  3040  2764 70582.7308    8  324 52010.0298 74266.1583  42.8%  6968 3420s
  3215  2843 68185.9329    9  300 52010.0298 74266.1583  42.8%  6966 3467s
  3367  2944 67833.7107   10  309 52010.0298 74266.1583  42.8%  7013 3522s
  3524  3082 62638.4655   13  287 52010.0298 74266.1583  42.8%  7103 3576s

Cutting planes:
  Learned: 1
  Gomory: 31
  Implied bound: 340
  MIR: 2808
  Flow cover: 2412
  RLT: 136
  Relax-and-lift: 930

Explored 3717 nodes (26999102 simplex iterations) in 3600.08 seconds (7799.37 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 52010 52003.1 51846.4 ... 50792.9

Time limit reached
Best objective 5.201002983419e+04, best bound 7.426615826945e+04, gap 42.7920%
  WARNING: Time limit reached. Using best solution found (gap: 42.79%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.10s
  Master Objective (UB) = 52010.03, θ = 231720.46
  Upper Bound (UB) = 52010.03

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 231720.46
  [DEBUG]   ✓ Scenario 0: θ = 231720.46 ≤ Q = 231720.46 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 231720.46 ≤ Q = 231720.46 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 231720.46 ≤ Q = 231720.46 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 231720.46 ≤ Q = 231720.46 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 231720.46 ≤ Q = 231720.46 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 231720.46 ≤ Q = 231720.46 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 231720.46 ≤ Q = 231720.46 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 231720.46 ≤ Q = 231720.46 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 231720.46 ≤ Q = 231720.46 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 231720.46 ≤ Q = 231720.46 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 231720.46 ≤ Q = 231720.46 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 11] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x23e4b52
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x023e4b52
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.329999e+13
Presolve removed 2548 rows and 1839 columns
Presolve time: 0.00s
Presolved: 545 rows, 550 columns, 1538 nonzeros
Found heuristic solution: objective 6992965.9415
Variable types: 374 continuous, 176 integer (176 binary)

Root relaxation: objective -1.659785e+05, 269 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -165978.52    0  129 6992965.94 -165978.52   102%     -    0s
H    0     0                    -127617.1734 -165978.52  30.1%     -    0s
H    0     0                    -130726.8163 -165978.52  27.0%     -    0s
H    0     0                    -132303.8821 -147183.76  11.2%     -    0s
H    0     0                    -136702.1596 -147183.76  7.67%     -    0s
     0     0 -147183.76    0   79 -136702.16 -147183.76  7.67%     -    0s
H    0     0                    -144976.2513 -147169.40  1.51%     -    0s
     0     0 -147163.99    0   99 -144976.25 -147163.99  1.51%     -    0s
     0     0 -146591.96    0   69 -144976.25 -146591.96  1.11%     -    0s
H    0     0                    -146029.0758 -146582.07  0.38%     -    0s
     0     0 -146582.07    0   57 -146029.08 -146582.07  0.38%     -    0s
H    0     0                    -146049.1597 -146582.07  0.36%     -    0s
     0     0 -146432.02    0   33 -146049.16 -146432.02  0.26%     -    0s
     0     0 -146414.02    0   32 -146049.16 -146414.02  0.25%     -    0s
     0     0 -146318.05    0   29 -146049.16 -146318.05  0.18%     -    0s
     0     0 -146304.06    0   22 -146049.16 -146304.06  0.17%     -    0s
     0     0 -146295.86    0   20 -146049.16 -146295.86  0.17%     -    0s
     0     0 -146231.97    0   15 -146049.16 -146231.97  0.13%     -    0s
H    0     0                    -146079.7273 -146231.35  0.10%     -    0s
     0     0 -146221.33    0   12 -146079.73 -146221.33  0.10%     -    0s
     0     0 -146191.93    0   20 -146079.73 -146191.93  0.08%     -    0s
     0     0 -146191.93    0   41 -146079.73 -146191.93  0.08%     -    0s
     0     0 -146191.93    0   40 -146079.73 -146191.93  0.08%     -    0s
H    0     0                    -146118.3179 -146191.93  0.05%     -    0s
     0     0 -146140.54    0    3 -146118.32 -146140.54  0.02%     -    0s
H    0     0                    -146134.5433 -146136.68  0.00%     -    0s

Cutting planes:
  Gomory: 3
  Implied bound: 2
  MIR: 25
  Flow cover: 16

Explored 1 nodes (860 simplex iterations) in 0.11 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -146135 -146118 -146080 ... -127617

Optimal solution found (tolerance 1.00e-04)
Best objective -1.461345433422e+05, best bound -1.461366832581e+05, gap 0.0015%
  Subproblem solved in 0.13s
  Worst-case operational profit (Z_SP) = 218542.19
  Scenario: 26 demand increases, 34 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -146134.54
  [DEBUG]   S×d_nominal = 364676.74
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 364676.74 + -146134.54 = 218542.19
  [DEBUG]   Current θ from Master = 231720.46
  [DEBUG]   ⚠️  Z_SP ≤ θ by 13178.27 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 38831.76
  Lower Bound (LB) = 48673.91
  Gap (UB-LB) = 3336.1216, Absolute Gap = 3336.1216, Relative Gap = 0.064144
  Not converged yet (gap = 3336.12 > ε = 200)

  [DEBUG] Adding NEW scenario 11 to Master Problem...
  [DEBUG] New scenario pattern: 26 increases, 34 decreases
    [DEBUG] Scenario 11 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 11 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 11]
    [DEBUG]   - Total constraints in model: 184863
    [DEBUG]   - Total variables in model: 77140
  [DEBUG] Total scenarios in Master: 12
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 12
================================================================================
[Iteration 12] Solving Master Problem...
  Current scenarios in Master: 12
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 184863 rows, 77140 columns and 524579 nonzeros
Model fingerprint: 0x10f5208c
Variable types: 74881 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 75144 rows and 30504 columns
Presolve time: 1.59s
Presolved: 109719 rows, 46636 columns, 659903 nonzeros
Variable types: 44377 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -307560.2778
Found heuristic solution: objective -222366.7828

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.22s

Barrier statistics:
 Dense cols : 665
 AA' NZ     : 3.767e+06
 Factor NZ  : 9.135e+06 (roughly 140 MB of memory)
 Factor Ops : 1.748e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.62841001e+07  2.01127425e+08  1.29e+05 2.03e+01  7.88e+04     3s
   1  -1.22987317e+07  1.84717601e+08  8.95e+04 9.15e+01  5.38e+04     3s
   2  -5.91357789e+06  1.46797248e+08  4.26e+04 6.08e+00  2.64e+04     3s
   3  -1.38086796e+06  1.14542355e+08  4.80e+03 1.41e+00  3.42e+03     3s
   4  -7.68060834e+05  5.35234449e+07  6.66e+02 2.33e-01  6.24e+02     3s
   5  -4.78685726e+05  3.53503714e+07  3.60e+02 1.38e-01  3.55e+02     3s
   6  -3.38629963e+05  2.82858813e+07  1.37e+02 1.04e-01  2.06e+02     3s
   7  -2.69265552e+05  2.05139922e+07  7.25e+01 6.98e-02  1.33e+02     3s
   8  -1.24143882e+05  1.52810362e+07  6.37e+00 4.92e-02  7.89e+01     3s
   9  -9.72496660e+04  8.75030622e+06  4.43e+00 2.76e-02  4.50e+01     3s
  10  -6.54103396e+04  4.48874484e+06  2.77e+00 1.39e-02  2.30e+01     3s
  11  -1.01524236e+04  1.98035952e+06  7.62e-01 5.81e-03  9.95e+00     3s
  12   1.69303355e+04  6.40388492e+05  4.10e-01 1.92e-03  3.11e+00     4s
  13   3.14733642e+04  4.08681592e+05  2.62e-01 1.13e-03  1.88e+00     4s
  14   3.80600157e+04  3.18767644e+05  2.14e-01 9.36e-04  1.40e+00     4s
  15   4.55910121e+04  2.49595980e+05  1.62e-01 8.15e-04  1.02e+00     4s
  16   5.58561705e+04  1.82068721e+05  1.11e-01 1.97e-03  6.29e-01     4s
  17   6.24966645e+04  1.61212779e+05  8.75e-02 1.58e-03  4.92e-01     4s
  18   6.95406600e+04  1.39831828e+05  6.43e-02 1.76e-03  3.50e-01     4s
  19   7.49607817e+04  1.27709341e+05  4.83e-02 1.97e-03  2.63e-01     4s
  20   7.78081766e+04  1.20333570e+05  4.07e-02 1.75e-03  2.12e-01     4s
  21   8.11179235e+04  1.15492996e+05  3.23e-02 1.41e-03  1.71e-01     4s
  22   8.33569536e+04  1.11421779e+05  2.68e-02 1.12e-03  1.40e-01     4s
  23   8.57539961e+04  1.07520247e+05  2.10e-02 8.42e-04  1.08e-01     4s
  24   8.78356151e+04  1.05350142e+05  1.61e-02 6.97e-04  8.73e-02     4s
  25   9.00227052e+04  1.02332213e+05  1.12e-02 4.96e-04  6.13e-02     4s
  26   9.17132150e+04  1.00377531e+05  7.57e-03 3.51e-04  4.32e-02     4s
  27   9.29473355e+04  9.91907455e+04  5.09e-03 2.61e-04  3.11e-02     4s
  28   9.32022566e+04  9.82899051e+04  4.58e-03 1.95e-04  2.54e-02     5s
  29   9.38047054e+04  9.75162746e+04  3.40e-03 1.38e-04  1.85e-02     5s
  30   9.42571843e+04  9.70595789e+04  2.53e-03 1.02e-04  1.40e-02     5s
  31   9.45700651e+04  9.66203426e+04  1.94e-03 7.02e-05  1.02e-02     5s
  32   9.47227566e+04  9.65476963e+04  1.66e-03 6.46e-05  9.09e-03     5s
  33   9.51221970e+04  9.62991734e+04  9.65e-04 4.68e-05  5.86e-03     5s
  34   9.52698923e+04  9.61260423e+04  6.98e-04 3.98e-05  4.27e-03     5s
  35   9.54359495e+04  9.60234429e+04  4.07e-04 3.01e-05  2.93e-03     5s
  36   9.54603463e+04  9.59520601e+04  3.65e-04 2.41e-05  2.45e-03     5s
  37   9.55279122e+04  9.58872530e+04  2.53e-04 1.81e-05  1.79e-03     5s
  38   9.55899309e+04  9.58241397e+04  1.53e-04 2.02e-05  1.17e-03     5s
  39   9.56120677e+04  9.57846466e+04  1.17e-04 1.40e-05  8.60e-04     5s
  40   9.56472458e+04  9.57455060e+04  6.31e-05 8.16e-06  4.90e-04     5s
  41   9.56660329e+04  9.57312412e+04  3.44e-05 5.91e-06  3.25e-04     5s
  42   9.56699451e+04  9.57252583e+04  2.89e-05 5.00e-06  2.76e-04     6s
  43   9.56795903e+04  9.57101416e+04  1.59e-05 2.65e-06  1.52e-04     6s
  44   9.56858390e+04  9.57044550e+04  8.11e-06 1.81e-06  9.27e-05     6s
  45   9.56874698e+04  9.56958018e+04  5.84e-06 4.30e-07  4.15e-05     6s
  46   9.56920609e+04  9.56942330e+04  2.74e-07 2.20e-07  1.08e-05     6s
  47   9.56923114e+04  9.56936860e+04  9.49e-08 1.50e-07  6.84e-06     6s
  48   9.56924780e+04  9.56925179e+04  1.73e-08 3.67e-09  1.99e-07     6s
  49   9.56924922e+04  9.56924922e+04  4.26e-10 1.35e-09  3.22e-10     6s

Barrier solved model in 49 iterations and 6.11 seconds (9.67 work units)
Optimal objective 9.56924922e+04


Root crossover log...

   93122 DPushes remaining with DInf 0.0000000e+00                 6s
       0 DPushes remaining with DInf 0.0000000e+00                 9s

    2890 PPushes remaining with PInf 1.4511443e-05                 9s
       0 PPushes remaining with PInf 0.0000000e+00                 9s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.7218258e+00      9s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   37236    9.5692492e+04   0.000000e+00   2.721826e+00      9s
   37264    9.5692492e+04   0.000000e+00   0.000000e+00      9s
   37264    9.5692492e+04   0.000000e+00   0.000000e+00      9s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 9.569249e+04, 37264 iterations, 6.94 seconds (13.56 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 95692.4922    0  285 -222366.78 95692.4922   143%     -    9s
H    0     0                    -216759.8304 95692.4922   144%     -   10s
H    0     0                    -216677.9344 95692.4922   144%     -   10s
H    0     0                    -211978.7990 95692.4922   145%     -   10s
H    0     0                    -57004.75957 95692.4922   268%     -   10s
H    0     0                    10451.796105 95692.4922   816%     -   10s
H    0     0                    10907.299972 95692.4922   777%     -   11s
H    0     0                    11013.275816 95692.4922   769%     -   11s
H    0     0                    12355.557100 95692.4922   674%     -   11s
H    0     0                    12847.296960 95692.4922   645%     -   11s
H    0     0                    13174.214056 95692.4922   626%     -   11s
H    0     0                    45506.790550 95692.4922   110%     -   12s
H    0     0                    46502.196261 95692.4922   106%     -   12s
H    0     0                    48385.116221 95692.4922  97.8%     -   12s
H    0     0                    48570.486983 95692.4922  97.0%     -   12s
H    0     0                    48626.299905 95692.4922  96.8%     -   12s
H    0     0                    48634.732014 87129.0189  79.1%     -   60s
     0     0 87108.6549    0  332 48634.7320 87108.6549  79.1%     -   61s
H    0     0                    48648.746635 87108.6549  79.1%     -   63s
H    0     0                    48680.172711 87108.6549  78.9%     -   63s
H    0     0                    48821.525348 87108.6549  78.4%     -   63s
H    0     0                    50152.468772 87108.6549  73.7%     -   63s
     0     0 86679.4240    0  315 50152.4688 86679.4240  72.8%     -   82s
     0     0 86561.9078    0  333 50152.4688 86561.9078  72.6%     -   91s
     0     0 86556.4601    0  335 50152.4688 86556.4601  72.6%     -   95s
     0     0 86556.4601    0  328 50152.4688 86556.4601  72.6%     -  104s
     0     0 86556.4601    0  287 50152.4688 86556.4601  72.6%     -  111s
     0     0 86556.4601    0  326 50152.4688 86556.4601  72.6%     -  114s
     0     0 86556.4601    0  326 50152.4688 86556.4601  72.6%     -  115s
H    0     0                    50260.256150 83433.1563  66.0%     -  170s
     0     0 83433.1563    0  351 50260.2561 83433.1563  66.0%     -  170s
H    0     0                    50345.467409 83432.9895  65.7%     -  171s
H    0     0                    50450.546509 83432.9895  65.4%     -  172s
H    0     0                    50523.069445 83432.9895  65.1%     -  172s
     0     0 82436.4061    0  374 50523.0694 82436.4061  63.2%     -  215s
     0     0 82225.0652    0  392 50523.0694 82225.0652  62.7%     -  237s
     0     0 82104.5845    0  378 50523.0694 82104.5845  62.5%     -  254s
     0     0 82023.1412    0  387 50523.0694 82023.1412  62.3%     -  266s
     0     0 81970.7472    0  415 50523.0694 81970.7472  62.2%     -  278s
     0     0 81945.5545    0  406 50523.0694 81945.5545  62.2%     -  286s
     0     0 81927.0107    0  401 50523.0694 81927.0107  62.2%     -  292s
     0     0 81923.8521    0  406 50523.0694 81923.8521  62.2%     -  295s
     0     0 81911.7358    0  408 50523.0694 81911.7358  62.1%     -  305s
     0     0 81900.2760    0  429 50523.0694 81900.2760  62.1%     -  311s
     0     0 81898.4175    0  409 50523.0694 81898.4175  62.1%     -  313s
     0     0 79128.2283    0  367 50523.0694 79128.2283  56.6%     -  395s
     0     0 78723.7561    0  375 50523.0694 78723.7561  55.8%     -  420s
     0     0 78574.0401    0  374 50523.0694 78574.0401  55.5%     -  440s
     0     0 78460.8579    0  430 50523.0694 78460.8579  55.3%     -  460s
     0     0 78408.8376    0  440 50523.0694 78408.8376  55.2%     -  472s
     0     0 78392.2656    0  442 50523.0694 78392.2656  55.2%     -  478s
     0     0 78345.3229    0  437 50523.0694 78345.3229  55.1%     -  490s
     0     0 78291.2134    0  427 50523.0694 78291.2134  55.0%     -  498s
     0     0 78240.8794    0  433 50523.0694 78240.8794  54.9%     -  508s
     0     0 78187.6560    0  426 50523.0694 78187.6560  54.8%     -  517s
     0     0 78175.3053    0  448 50523.0694 78175.3053  54.7%     -  523s
     0     0 78131.0507    0  389 50523.0694 78131.0507  54.6%     -  531s
     0     0 78102.5510    0  439 50523.0694 78102.5510  54.6%     -  538s
     0     0 78090.1974    0  445 50523.0694 78090.1974  54.6%     -  543s
     0     0 78089.6144    0  447 50523.0694 78089.6144  54.6%     -  544s
     0     0 77194.4443    0  372 50523.0694 77194.4443  52.8%     -  595s
     0     0 76853.8704    0  477 50523.0694 76853.8704  52.1%     -  621s
     0     0 76757.7719    0  402 50523.0694 76757.7719  51.9%     -  636s
     0     0 76722.1787    0  393 50523.0694 76722.1787  51.9%     -  642s
     0     0 76689.9650    0  389 50523.0694 76689.9650  51.8%     -  650s
     0     0 76670.6547    0  458 50523.0694 76670.6547  51.8%     -  656s
     0     0 76656.9750    0  416 50523.0694 76656.9750  51.7%     -  663s
     0     0 76644.9591    0  407 50523.0694 76644.9591  51.7%     -  668s
     0     0 76625.9693    0  411 50523.0694 76625.9693  51.7%     -  672s
     0     0 76621.8507    0  409 50523.0694 76621.8507  51.7%     -  674s
     0     0 76619.1376    0  416 50523.0694 76619.1376  51.7%     -  676s
     0     0 76420.6078    0  387 50523.0694 76420.6078  51.3%     -  693s
     0     0 76362.7971    0  398 50523.0694 76362.7971  51.1%     -  707s
     0     0 76333.6597    0  393 50523.0694 76333.6597  51.1%     -  715s
     0     0 76314.2506    0  442 50523.0694 76314.2506  51.0%     -  722s
     0     0 76303.8913    0  401 50523.0694 76303.8913  51.0%     -  727s
     0     0 76298.1419    0  399 50523.0694 76298.1419  51.0%     -  730s
     0     0 76283.7076    0  417 50523.0694 76283.7076  51.0%     -  735s
     0     0 76252.5727    0  408 50523.0694 76252.5727  50.9%     -  741s
     0     0 76248.6658    0  410 50523.0694 76248.6658  50.9%     -  744s
     0     0 76244.3567    0  408 50523.0694 76244.3567  50.9%     -  747s
     0     0 76241.5464    0  408 50523.0694 76241.5464  50.9%     -  749s
     0     0 76113.5936    0  451 50523.0694 76113.5936  50.7%     -  765s
H    0     0                    50906.867034 76059.9086  49.4%     -  774s
     0     0 76059.9086    0  429 50906.8670 76059.9086  49.4%     -  774s
     0     0 76046.2838    0  447 50906.8670 76046.2838  49.4%     -  780s
H    0     0                    51051.860079 76029.8599  48.9%     -  786s
H    0     0                    51058.262748 76029.8599  48.9%     -  786s
     0     0 76029.8599    0  383 51058.2627 76029.8599  48.9%     -  786s
     0     0 76026.9527    0  500 51058.2627 76026.9527  48.9%     -  790s
H    0     0                    51262.910278 75965.2152  48.2%     -  806s
     0     0 75965.2152    0  405 51262.9103 75965.2152  48.2%     -  806s
     0     0 75947.0211    0  441 51262.9103 75947.0211  48.2%     -  814s
     0     0 75944.4659    0  446 51262.9103 75944.4659  48.1%     -  816s
     0     0 75924.8993    0  390 51262.9103 75924.8993  48.1%     -  823s
     0     0 75919.5778    0  445 51262.9103 75919.5778  48.1%     -  828s
     0     0 75910.9680    0  486 51262.9103 75910.9680  48.1%     -  833s
     0     0 75906.1900    0  502 51262.9103 75906.1900  48.1%     -  836s
     0     0 75904.1596    0  454 51262.9103 75904.1596  48.1%     -  839s
     0     0 75877.5307    0  411 51262.9103 75877.5307  48.0%     -  847s
     0     0 75853.2579    0  417 51262.9103 75853.2579  48.0%     -  853s
     0     0 75847.7579    0  431 51262.9103 75847.7579  48.0%     -  857s
     0     0 75846.7233    0  429 51262.9103 75846.7233  48.0%     -  859s
     0     0 75834.5106    0  401 51262.9103 75834.5106  47.9%     -  867s
     0     0 75826.5684    0  402 51262.9103 75826.5684  47.9%     -  873s
     0     0 75824.0693    0  472 51262.9103 75824.0693  47.9%     -  876s
     0     0 75816.0024    0  438 51262.9103 75816.0024  47.9%     -  881s
     0     0 75813.4670    0  392 51262.9103 75813.4670  47.9%     -  884s
     0     0 75803.5272    0  400 51262.9103 75803.5272  47.9%     -  888s
     0     0 75803.5105    0  400 51262.9103 75803.5105  47.9%     -  891s
H    0     0                    51343.984853 75803.5026  47.6%     - 1017s
H    0     2                    51347.432842 75803.5026  47.6%     - 1034s
     0     2 75803.5026    0  400 51347.4328 75803.5026  47.6%     - 1034s
     1     4 75706.5910    1  392 51347.4328 75803.3221  47.6%  8086 1047s
     3     8 75563.0152    2  380 51347.4328 75706.5858  47.4% 10482 1072s
     7    16 75256.4158    3  464 51347.4328 75562.1124  47.2% 13484 1107s
    15    31 74996.3120    4  464 51347.4328 75255.8268  46.6% 16746 1158s
    30    45 74111.0520    5  404 51347.4328 74996.1077  46.1% 26878 3600s

Cutting planes:
  Learned: 2
  Gomory: 41
  Implied bound: 367
  MIR: 3225
  Flow cover: 2394
  RLT: 128
  Relax-and-lift: 869

Explored 44 nodes (2177866 simplex iterations) in 3600.13 seconds (6012.71 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 51347.4 51344 51262.9 ... 50152.5

Time limit reached
Best objective 5.134743284163e+04, best bound 7.499610770505e+04, gap 46.0562%
  WARNING: Time limit reached. Using best solution found (gap: 46.06%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.14s
  Master Objective (UB) = 51347.43, θ = 231633.05
  Upper Bound (UB) = 51347.43

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 231633.05
  [DEBUG]   ✓ Scenario 0: θ = 231633.05 ≤ Q = 231633.05 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 231633.05 ≤ Q = 231633.05 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 231633.05 ≤ Q = 231633.05 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 231633.05 ≤ Q = 231633.05 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 231633.05 ≤ Q = 231633.05 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 231633.05 ≤ Q = 231633.05 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 231633.05 ≤ Q = 231633.05 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 231633.05 ≤ Q = 231633.05 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 231633.05 ≤ Q = 231633.05 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 231633.05 ≤ Q = 231633.05 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 231633.05 ≤ Q = 231633.05 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 231633.05 ≤ Q = 231633.05 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 12] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x295f57
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x00295f57
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.318511e+13
Presolve removed 2549 rows and 1840 columns
Presolve time: 0.00s
Presolved: 544 rows, 549 columns, 1538 nonzeros
Found heuristic solution: objective 6945891.6791
Variable types: 373 continuous, 176 integer (176 binary)

Root relaxation: objective -1.661962e+05, 275 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -166196.25    0  132 6945891.68 -166196.25   102%     -    0s
H    0     0                    -129697.2938 -166196.25  28.1%     -    0s
H    0     0                    -131944.9003 -166196.25  26.0%     -    0s
H    0     0                    -132310.8518 -166196.25  25.6%     -    0s
H    0     0                    -140746.1331 -166196.25  18.1%     -    0s
H    0     0                    -146771.3540 -150223.54  2.35%     -    0s
     0     0 -150223.54    0   77 -146771.35 -150223.54  2.35%     -    0s
H    0     0                    -147132.4227 -150175.84  2.07%     -    0s
H    0     0                    -148338.4527 -150175.84  1.24%     -    0s
H    0     0                    -148699.5214 -150175.84  0.99%     -    0s
     0     0 -149936.04    0   60 -148699.52 -149936.04  0.83%     -    0s
     0     0 -149310.07    0   70 -148699.52 -149310.07  0.41%     -    0s
     0     0 -149308.69    0   64 -148699.52 -149308.69  0.41%     -    0s
     0     0 -149232.25    0   55 -148699.52 -149232.25  0.36%     -    0s
     0     0 -149231.60    0   56 -148699.52 -149231.60  0.36%     -    0s
     0     0 -148972.28    0   35 -148699.52 -148972.28  0.18%     -    0s
     0     0 -148938.67    0   17 -148699.52 -148938.67  0.16%     -    0s
     0     0 -148907.90    0   28 -148699.52 -148907.90  0.14%     -    0s
     0     0 -148825.24    0   16 -148699.52 -148825.24  0.08%     -    0s
     0     0 -148825.24    0   21 -148699.52 -148825.24  0.08%     -    0s
     0     0 -148764.18    0    5 -148699.52 -148764.18  0.04%     -    0s
H    0     0                    -148750.1765 -148758.12  0.01%     -    0s

Cutting planes:
  Gomory: 4
  MIR: 8
  Flow cover: 11
  Relax-and-lift: 2

Explored 1 nodes (787 simplex iterations) in 0.06 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -148750 -148700 -148577 ... 6.94589e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.487501765157e+05, best bound -1.487581249974e+05, gap 0.0053%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 216030.79
  Scenario: 30 demand increases, 30 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -148750.18
  [DEBUG]   S×d_nominal = 364780.96
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 364780.96 + -148750.18 = 216030.79
  [DEBUG]   Current θ from Master = 231633.05
  [DEBUG]   ⚠️  Z_SP ≤ θ by 15602.26 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 35745.17
  Lower Bound (LB) = 48673.91
  Gap (UB-LB) = 2673.5246, Absolute Gap = 2673.5246, Relative Gap = 0.052067
  Not converged yet (gap = 2673.52 > ε = 200)

  [DEBUG] Adding NEW scenario 12 to Master Problem...
  [DEBUG] New scenario pattern: 30 increases, 30 decreases
    [DEBUG] Scenario 12 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 12 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 12]
    [DEBUG]   - Total constraints in model: 200153
    [DEBUG]   - Total variables in model: 83380
  [DEBUG] Total scenarios in Master: 13
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 13
================================================================================
[Iteration 13] Solving Master Problem...
  Current scenarios in Master: 13
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 200153 rows, 83380 columns and 567834 nonzeros
Model fingerprint: 0x7da3568f
Variable types: 81121 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 81406 rows and 33046 columns
Presolve time: 1.66s
Presolved: 118747 rows, 50334 columns, 728993 nonzeros
Variable types: 48075 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -285874.8191
Found heuristic solution: objective -222366.7828

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.25s

Barrier statistics:
 Dense cols : 701
 AA' NZ     : 4.700e+06
 Factor NZ  : 1.105e+07 (roughly 160 MB of memory)
 Factor Ops : 2.611e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.72313418e+07  2.16732026e+08  1.37e+05 2.00e+01  8.29e+04     3s
   1  -1.31438212e+07  1.99982569e+08  9.63e+04 8.43e+01  5.76e+04     3s
   2  -5.80289087e+06  1.56698303e+08  4.14e+04 6.24e-01  2.58e+04     3s
   3  -1.14922619e+06  1.21214601e+08  4.28e+03 1.71e+00  3.11e+03     3s
   4  -5.80458063e+05  4.65652637e+07  6.36e+02 2.03e-01  5.53e+02     3s
   5  -4.36642502e+05  3.11045042e+07  2.99e+02 1.15e-01  2.91e+02     3s
   6  -3.69782002e+05  2.38715917e+07  1.19e+02 8.12e-02  1.66e+02     3s
   7  -2.58398813e+05  1.76331258e+07  5.22e+01 5.68e-02  1.03e+02     3s
   8  -1.66534499e+05  1.21438277e+07  2.35e+01 3.73e-02  6.43e+01     3s
   9  -1.11794335e+05  9.01344510e+06  1.26e+01 2.68e-02  4.53e+01     4s
  10  -1.02612397e+05  4.44682566e+06  6.63e+00 1.27e-02  2.19e+01     4s
  11  -5.08161206e+04  3.02192321e+06  1.25e+00 8.49e-03  1.43e+01     4s
  12  -2.48623827e+04  1.69258519e+06  4.22e-01 4.60e-03  7.93e+00     4s
  13  -2.11291127e+04  9.01285061e+05  3.76e-01 2.47e-03  4.26e+00     4s
  14   8.41069651e+03  5.05025243e+05  1.54e-01 1.43e-03  2.29e+00     4s
  15   1.88148131e+04  2.99312205e+05  1.20e-01 1.31e-03  1.29e+00     4s
  16   3.08178627e+04  2.32831151e+05  9.23e-02 1.24e-03  9.32e-01     4s
  17   3.79757368e+04  1.94244829e+05  7.80e-02 1.05e-03  7.21e-01     4s
  18   4.95696845e+04  1.67762931e+05  5.86e-02 2.34e-03  5.45e-01     4s
  19   5.95912050e+04  1.46083946e+05  4.17e-02 1.69e-03  3.99e-01     4s
  20   6.45690924e+04  1.35949042e+05  3.38e-02 1.36e-03  3.29e-01     4s
  21   6.90962273e+04  1.24588949e+05  2.69e-02 1.04e-03  2.56e-01     4s
  22   7.26017114e+04  1.14861375e+05  2.19e-02 7.46e-04  1.95e-01     4s
  23   7.55228004e+04  1.09480258e+05  1.82e-02 5.73e-04  1.57e-01     5s
  24   8.03137227e+04  1.06988819e+05  1.22e-02 4.96e-04  1.23e-01     5s
  25   8.18366130e+04  1.02135077e+05  1.04e-02 3.37e-04  9.36e-02     5s
  26   8.46592735e+04  9.98986052e+04  7.17e-03 2.64e-04  7.03e-02     5s
  27   8.69474310e+04  9.77831247e+04  4.75e-03 1.94e-04  5.00e-02     5s
  28   8.80315777e+04  9.60010979e+04  3.64e-03 1.34e-04  3.67e-02     5s
  29   8.91598429e+04  9.50159896e+04  2.57e-03 1.01e-04  2.70e-02     5s
  30   8.93461400e+04  9.44403465e+04  2.39e-03 8.22e-05  2.35e-02     5s
  31   9.00121388e+04  9.38067879e+04  1.78e-03 6.02e-05  1.75e-02     5s
  32   9.08380578e+04  9.31592155e+04  1.02e-03 3.80e-05  1.07e-02     5s
  33   9.13479183e+04  9.27850670e+04  5.85e-04 2.43e-05  6.62e-03     5s
  34   9.15975618e+04  9.25333381e+04  3.67e-04 1.61e-05  4.31e-03     5s
  35   9.18346297e+04  9.23264199e+04  1.67e-04 9.19e-06  2.27e-03     5s
  36   9.19302674e+04  9.22512270e+04  8.97e-05 6.59e-06  1.48e-03     6s
  37   9.19665177e+04  9.21699905e+04  6.00e-05 3.87e-06  9.38e-04     6s
  38   9.19801177e+04  9.21457866e+04  5.04e-05 3.06e-06  7.63e-04     6s
  39   9.20018773e+04  9.21053375e+04  3.50e-05 1.69e-06  4.77e-04     6s
  40   9.20161992e+04  9.20661750e+04  2.45e-05 4.35e-07  2.30e-04     6s
  41   9.20236879e+04  9.20610422e+04  1.90e-05 2.82e-07  1.72e-04     6s
  42   9.20401873e+04  9.20544116e+04  7.78e-06 2.65e-06  6.56e-05     6s
  43   9.20461961e+04  9.20524301e+04  3.59e-06 6.36e-07  2.88e-05     6s
  44   9.20501235e+04  9.20520937e+04  8.78e-07 4.96e-07  9.09e-06     6s
  45   9.20511083e+04  9.20517942e+04  3.25e-07 1.67e-07  3.17e-06     6s
  46   9.20515685e+04  9.20516922e+04  6.63e-08 2.35e-09  5.71e-07     6s
  47   9.20516191e+04  9.20516900e+04  7.86e-07 5.70e-09  3.28e-07     7s
  48   9.20516198e+04  9.20516900e+04  5.12e-06 3.12e-08  3.24e-07     7s
  49   9.20516752e+04  9.20516899e+04  1.08e-06 3.91e-09  6.82e-08     7s
  50   9.20516811e+04  9.20516899e+04  1.19e-06 1.83e-07  4.05e-08     7s
  51   9.20516891e+04  9.20516899e+04  1.18e-07 1.75e-07  4.04e-09     7s

Barrier solved model in 51 iterations and 6.85 seconds (10.90 work units)
Optimal objective 9.20516891e+04


Root crossover log...

  105351 DPushes remaining with DInf 0.0000000e+00                 7s
   28901 DPushes remaining with DInf 0.0000000e+00                10s
    1780 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                16s

   24098 PPushes remaining with PInf 8.8992876e-05                16s
       0 PPushes remaining with PInf 0.0000000e+00                18s

  Push phase complete: Pinf 0.0000000e+00, Dinf 7.4884378e+04     18s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   81599    9.2051690e+04   0.000000e+00   7.488438e+04     18s
   82497    9.2051690e+04   0.000000e+00   0.000000e+00     19s
   82497    9.2051690e+04   0.000000e+00   0.000000e+00     20s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 9.205169e+04, 82497 iterations, 17.38 seconds (29.03 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 92051.6899    0  182 -222366.78 92051.6899   141%     -   20s
H    0     0                    -217715.7736 92051.6899   142%     -   20s
H    0     0                    -58516.12418 92051.6899   257%     -   20s
H    0     0                    -58192.28561 92051.6899   258%     -   21s
H    0     0                    -12035.70238 92051.6899   865%     -   21s
H    0     0                    -3191.068915 92051.6899  2985%     -   21s
H    0     0                    18772.906021 92051.6899   390%     -   21s
H    0     0                    18927.966993 92051.6899   386%     -   21s
H    0     0                    41730.584018 92051.6899   121%     -   21s
H    0     0                    43711.268477 85356.3908  95.3%     -   86s
H    0     0                    43953.397256 85356.3908  94.2%     -   86s
H    0     0                    46807.820646 85356.3908  82.4%     -   86s
H    0     0                    47143.838002 85356.3908  81.1%     -   86s
H    0     0                    47272.432073 85356.3908  80.6%     -   86s
H    0     0                    47313.869561 85356.3908  80.4%     -   86s
H    0     0                    47684.564730 85356.3908  79.0%     -   86s
H    0     0                    47978.122279 85356.3908  77.9%     -   86s
H    0     0                    47978.293512 85356.3908  77.9%     -   86s
H    0     0                    48052.154547 85356.3908  77.6%     -   86s
     0     0 85194.9303    0  219 48052.1545 85194.9303  77.3%     -   86s
H    0     0                    49003.160019 85194.9303  73.9%     -   88s
H    0     0                    49223.659345 85194.9303  73.1%     -   88s
     0     0 84192.9270    0  229 49223.6593 84192.9270  71.0%     -  128s
     0     0 84192.9270    0  251 49223.6593 84192.9270  71.0%     -  142s
     0     0 84192.9270    0  261 49223.6593 84192.9270  71.0%     -  146s
     0     0 84192.9270    0  256 49223.6593 84192.9270  71.0%     -  149s
     0     0 84192.9270    0  255 49223.6593 84192.9270  71.0%     -  154s
     0     0 84192.9270    0  259 49223.6593 84192.9270  71.0%     -  163s
     0     0 84192.9270    0  261 49223.6593 84192.9270  71.0%     -  164s
     0     0 84192.9270    0  259 49223.6593 84192.9270  71.0%     -  166s
     0     0 84192.9270    0  259 49223.6593 84192.9270  71.0%     -  167s
     0     0 80860.2532    0  303 49223.6593 80860.2532  64.3%     -  257s
H    0     0                    49847.909891 80860.1102  62.2%     -  258s
H    0     0                    50276.689471 80860.1102  60.8%     -  258s
H    0     0                    50306.756247 80860.1102  60.7%     -  258s
H    0     0                    50360.282238 80860.1102  60.6%     -  258s
H    0     0                    50403.765788 80860.1102  60.4%     -  258s
     0     0 80309.8124    0  326 50403.7658 80309.8124  59.3%     -  290s
     0     0 80187.9781    0  335 50403.7658 80187.9781  59.1%     -  305s
     0     0 80141.5749    0  338 50403.7658 80141.5749  59.0%     -  313s
     0     0 80117.4056    0  326 50403.7658 80117.4056  59.0%     -  319s
     0     0 80104.0111    0  325 50403.7658 80104.0111  58.9%     -  325s
     0     0 80083.9838    0  333 50403.7658 80083.9838  58.9%     -  330s
     0     0 80075.9757    0  340 50403.7658 80075.9757  58.9%     -  335s
     0     0 80027.3687    0  322 50403.7658 80027.3687  58.8%     -  345s
     0     0 80015.3457    0  334 50403.7658 80015.3457  58.7%     -  350s
     0     0 79738.7888    0  325 50403.7658 79738.7888  58.2%     -  380s
     0     0 79700.1187    0  341 50403.7658 79700.1187  58.1%     -  392s
     0     0 79686.0150    0  357 50403.7658 79686.0150  58.1%     -  396s
     0     0 79677.4776    0  354 50403.7658 79677.4776  58.1%     -  398s
     0     0 79677.1638    0  363 50403.7658 79677.1638  58.1%     -  399s
     0     0 77816.9779    0  353 50403.7658 77816.9779  54.4%     -  472s
     0     0 77451.6665    0  357 50403.7658 77451.6665  53.7%     -  499s
     0     0 77289.9367    0  374 50403.7658 77289.9367  53.3%     -  517s
     0     0 77254.3798    0  341 50403.7658 77254.3798  53.3%     -  526s
     0     0 77228.0592    0  337 50403.7658 77228.0592  53.2%     -  532s
     0     0 77204.8076    0  343 50403.7658 77204.8076  53.2%     -  537s
     0     0 77181.6282    0  344 50403.7658 77181.6282  53.1%     -  545s
     0     0 77167.9936    0  339 50403.7658 77167.9936  53.1%     -  550s
     0     0 77149.7803    0  344 50403.7658 77149.7803  53.1%     -  555s
     0     0 77140.8460    0  340 50403.7658 77140.8460  53.0%     -  559s
     0     0 77123.5172    0  373 50403.7658 77123.5172  53.0%     -  566s
     0     0 77110.4018    0  349 50403.7658 77110.4018  53.0%     -  570s
     0     0 77107.7436    0  348 50403.7658 77107.7436  53.0%     -  571s
     0     0 77106.3568    0  351 50403.7658 77106.3568  53.0%     -  573s
     0     0 76472.8840    0  371 50403.7658 76472.8840  51.7%     -  615s
H    0     0                    50404.539777 76472.6254  51.7%     -  617s
H    0     0                    50479.818655 76472.6254  51.5%     -  617s
H    0     0                    50497.430775 76472.6254  51.4%     -  617s
     0     0 76269.2918    0  344 50497.4308 76269.2918  51.0%     -  636s
     0     0 76172.4708    0  372 50497.4308 76172.4708  50.8%     -  652s
     0     0 76149.1890    0  375 50497.4308 76149.1890  50.8%     -  659s
     0     0 76136.2791    0  375 50497.4308 76136.2791  50.8%     -  664s
     0     0 76123.7553    0  378 50497.4308 76123.7553  50.7%     -  669s
     0     0 76116.3982    0  375 50497.4308 76116.3982  50.7%     -  674s
     0     0 76105.3990    0  377 50497.4308 76105.3990  50.7%     -  680s
     0     0 76098.6240    0  390 50497.4308 76098.6240  50.7%     -  684s
     0     0 76097.2048    0  395 50497.4308 76097.2048  50.7%     -  685s
     0     0 75925.1982    0  367 50497.4308 75925.1982  50.4%     -  701s
     0     0 75878.2555    0  403 50497.4308 75878.2555  50.3%     -  712s
     0     0 75857.0814    0  376 50497.4308 75857.0814  50.2%     -  721s
     0     0 75846.2725    0  366 50497.4308 75846.2725  50.2%     -  726s
     0     0 75836.7454    0  371 50497.4308 75836.7454  50.2%     -  730s
     0     0 75832.5889    0  372 50497.4308 75832.5889  50.2%     -  734s
     0     0 75829.7534    0  370 50497.4308 75829.7534  50.2%     -  738s
     0     0 75824.8592    0  380 50497.4308 75824.8592  50.2%     -  740s
     0     0 75819.6769    0  378 50497.4308 75819.6769  50.1%     -  744s
     0     0 75815.6367    0  371 50497.4308 75815.6367  50.1%     -  746s
     0     0 75813.8827    0  371 50497.4308 75813.8827  50.1%     -  748s
     0     0 75746.4115    0  354 50497.4308 75746.4115  50.0%     -  763s
     0     0 75725.9991    0  362 50497.4308 75725.9991  50.0%     -  775s
     0     0 75722.8680    0  371 50497.4308 75722.8680  50.0%     -  778s
     0     0 75718.2689    0  369 50497.4308 75718.2689  49.9%     -  780s
     0     0 75717.9331    0  378 50497.4308 75717.9331  49.9%     -  782s
     0     0 75697.9859    0  363 50497.4308 75697.9859  49.9%     -  788s
     0     0 75692.3192    0  371 50497.4308 75692.3192  49.9%     -  794s
     0     0 75691.3521    0  369 50497.4308 75691.3521  49.9%     -  795s
     0     0 75685.7270    0  376 50497.4308 75685.7270  49.9%     -  800s
     0     0 75683.2654    0  380 50497.4308 75683.2654  49.9%     -  806s
     0     0 75683.0978    0  370 50497.4308 75683.0978  49.9%     -  806s
     0     0 75678.7602    0  377 50497.4308 75678.7602  49.9%     -  810s
H    0     0                    50555.201003 75678.5858  49.7%     -  811s
     0     0 75673.3440    0  375 50555.2010 75673.3440  49.7%     -  813s
     0     0 75673.1849    0  375 50555.2010 75673.1849  49.7%     -  813s
     0     0 75668.0941    0  376 50555.2010 75668.0941  49.7%     -  817s
     0     0 75667.6447    0  376 50555.2010 75667.6447  49.7%     -  820s
H    0     0                    50622.606305 75666.8467  49.5%     -  995s
H    0     0                    50645.064475 75666.8467  49.4%     - 1002s
H    0     0                    50787.197976 75666.8467  49.0%     - 1002s
H    0     2                    51084.983846 75666.8467  48.1%     - 1040s
     0     2 75666.8467    0  376 51084.9838 75666.8467  48.1%     - 1040s
     1     4 75596.8019    1  363 51084.9838 75666.8467  48.1%  6656 1057s
     3     8 75336.8569    2  396 51084.9838 75596.7975  48.0% 11793 1099s
     7    16 75212.6001    3  360 51084.9838 75419.9241  47.6% 14538 1179s
    15    31 73654.7391    4  343 51084.9838 75212.5957  47.2% 17576 1219s
    30    46 72352.6437    5  347 51084.9838 75212.5957  47.2% 24020 1321s
    45    77 72475.4102    5  352 51084.9838 74602.6750  46.0% 22176 1405s
H   46    77                    51096.376594 74602.6750  46.0% 21694 1405s
H   47    77                    51236.209155 74602.6750  45.6% 21502 1405s
H   52    77                    51324.959725 74602.6750  45.4% 20486 1405s
    76   198 72440.2835    6  350 51324.9597 74412.3782  45.0% 17113 1542s
   197   308 71898.2036   10  384 51324.9597 74412.3782  45.0% 10660 1581s
   307   387 71517.2855   13  367 51324.9597 74412.3782  45.0%  9066 1614s
   386   413 71274.8738   16  335 51324.9597 74412.3782  45.0%  8299 1645s
H  402   413                    51363.868876 74412.3782  44.9%  8104 1645s
   412   480 71128.4547   17  331 51363.8689 74412.3782  44.9%  8069 1676s
   479   541 70855.9947   18  340 51363.8689 74412.3782  44.9%  7598 1701s
   540   593 69419.4622   12  300 51363.8689 74412.3782  44.9%  7421 1728s
   592   654 70603.9608   20  309 51363.8689 74412.3782  44.9%  7276 1759s
   653   707 70232.7233   22  297 51363.8689 74412.3782  44.9%  7369 1782s
   706   750 70385.0918   12  338 51363.8689 74412.3782  44.9%  7385 1806s
   749   772 69380.9256   22  306 51363.8689 74412.3782  44.9%  7488 1837s
   775   811 69033.2683   23  293 51363.8689 74412.3782  44.9%  7621 1893s
   814   852 68968.4741   24  298 51363.8689 74412.3782  44.9%  7728 1958s
   859   911 68815.5751   27  304 51363.8689 74412.3782  44.9%  8027 1980s
   918   973 67954.8703   29  261 51363.8689 74412.3782  44.9%  8022 2003s
   982  1035 67660.1019   31  257 51363.8689 74412.3782  44.9%  8022 2026s
  1045  1097 67573.8365   33  279 51363.8689 74412.3782  44.9%  8019 2051s
  1108  1162 69214.5359   16  291 51363.8689 74412.3782  44.9%  7927 2081s
  1187  1225 66885.3126   33  240 51363.8689 74412.3782  44.9%  7928 2106s
  1270  1281 66199.1613   34  260 51363.8689 74412.3782  44.9%  7862 2139s
  1346  1361 58341.8417   35  267 51363.8689 74412.3782  44.9%  7857 2170s
  1430  1386 infeasible   36      51363.8689 74412.3782  44.9%  7823 2199s
  1467  1414 65199.1683   36  257 51363.8689 74412.3782  44.9%  7818 2225s
  1501  1446 65034.5938   37  245 51363.8689 74412.3782  44.9%  7856 2258s
  1537  1476 64828.7745   38  247 51363.8689 74412.3782  44.9%  7870 2291s
H 1551  1476                    51527.707965 74412.3782  44.4%  7866 2291s
  1573  1633 64826.9259   39  247 51527.7080 74412.3782  44.4%  7869 2326s
  1744  1770 64152.2170   45  241 51527.7080 74412.3782  44.4%  7626 2363s
  1914  1912 63719.4568   50  303 51527.7080 74412.3782  44.4%  7453 2406s
  2095  2054 61383.5401   55  287 51527.7080 74184.6273  44.0%  7283 2450s
  2279  2215 56852.1563   62  170 51527.7080 74184.6273  44.0%  7131 2491s
  2480  2345 56014.0813   68  169 51527.7080 74184.6273  44.0%  6971 2534s
  2668  2372     cutoff   27      51527.7080 73978.4361  43.6%  6879 2578s
H 2672  2371                    51606.457847 73978.4361  43.4%  6886 2578s
  2703  2463 71849.1780    8  331 51606.4578 73978.4361  43.4%  6996 2628s
  2875  2539 67715.8011    9  292 51606.4578 73654.1808  42.7%  6984 2676s
  3026  2623 67539.4213   10  298 51606.4578 73654.1808  42.7%  6955 2731s
  3180  2705 65833.6012   12  244 51606.4578 73654.1808  42.7%  6992 2782s
  3308  2822 59945.2604   14  205 51606.4578 73654.1808  42.7%  7097 2834s
  3471  2992 59283.2856   20  200 51606.4578 73654.1808  42.7%  7163 2885s
H 3665  2992                    51650.377123 73476.1347  42.3%  7206 2938s
  3666  2993 68687.0744   19  376 51650.3771 73476.1347  42.3%  7204 3051s
  3668  2994 66471.6922   43  139 51650.3771 73476.1347  42.3%  7200 3068s
  3669  2995 57413.4167   34  340 51650.3771 73476.1347  42.3%  7198 3181s
H 3669  2845                    51665.853234 73476.1347  42.2%  7198 3234s
H 3669  2702                    51738.444329 73476.1347  42.0%  7198 3234s
  3670  2703 64034.5644   32  330 51738.4443 73476.1347  42.0%  7196 3235s
  3671  2703 61025.8976   36  347 51738.4443 73476.1347  42.0%  7194 3265s
  3672  2704 65531.9592   15  344 51738.4443 73476.1347  42.0%  7192 3280s
  3673  2705 59458.2006   19  363 51738.4443 73476.1347  42.0%  7190 3295s
  3674  2705 63241.6292   19  351 51738.4443 73476.1347  42.0%  7188 3311s
  3675  2706 51957.2734   96  360 51738.4443 73476.1347  42.0%  7187 3321s
  3676  2707 55361.1603  125  364 51738.4443 73476.1347  42.0%  7185 3335s
  3677  2707 64964.6697   50  368 51738.4443 73476.1347  42.0%  7183 3345s
  3678  2708 69073.8424    7  390 51738.4443 73476.1347  42.0%  7181 3351s
  3679  2709 65403.0407   33  355 51738.4443 73476.1347  42.0%  7179 3355s
  3680  2709 68453.1543   15  372 51738.4443 73476.1347  42.0%  7177 3361s
  3681  2710 71519.0121    9  377 51738.4443 73476.1347  42.0%  7175 3367s
  3682  2711 55015.1442   76  374 51738.4443 73476.1347  42.0%  7173 3388s
  3683  2711 55384.8836   54  415 51738.4443 73476.1347  42.0%  7171 3399s
  3684  2712 55623.6022  117  410 51738.4443 73476.1347  42.0%  7169 3407s
  3685  2713 53861.6796   98  408 51738.4443 73476.1347  42.0%  7167 3412s
  3686  2713 53753.7400   68  366 51738.4443 73476.1347  42.0%  7165 3417s
  3687  2714 67948.1554   17  372 51738.4443 73476.1347  42.0%  7163 3428s
  3688  2715 65804.0293   38  367 51738.4443 73476.1347  42.0%  7161 3435s
  3690  2716 58795.2038   32  402 51738.4443 73476.1347  42.0%  7157 3449s
  3691  2717 55624.9400  118  406 51738.4443 73476.1347  42.0%  7155 3454s
  3692  2717 73285.7640    5  431 51738.4443 73476.1347  42.0%  7153 3469s
  3693  2718 62557.7955   31  361 51738.4443 73476.1347  42.0%  7151 3474s
  3694  2719 59441.8841   81  353 51738.4443 73476.1347  42.0%  7150 3480s
H 3695  2583                    51751.087556 73476.1347  42.0%  7148 3488s
H 3695  2453                    51792.314506 73476.1347  41.9%  7148 3488s
  3696  2454 52371.8357   38  357 51792.3145 73476.1347  41.9%  7146 3492s
  3697  2455 55929.0726   57  411 51792.3145 73476.1347  41.9%  7144 3498s
H 3697  2332                    51891.761549 73476.1347  41.6%  7144 3509s
  3698  2332 67940.9640   17  365 51891.7615 73476.1347  41.6%  7142 3510s
  3699  2333 68815.4379   28  372 51891.7615 73476.1347  41.6%  7140 3516s
H 3699  2216                    51953.518203 73476.1347  41.4%  7140 3524s
  3701  2217 57317.8205   93  372 51953.5182 73476.1347  41.4%  7136 3528s
  3702  2218 51980.6605   57  373 51953.5182 73476.1347  41.4%  7134 3536s
  3703  2219 56879.6711   66  373 51953.5182 73476.1347  41.4%  7132 3555s

Cutting planes:
  Learned: 1
  Gomory: 23
  Implied bound: 46
  Projected implied bound: 82
  MIR: 782
  Mixing: 1
  Flow cover: 773
  RLT: 7
  Relax-and-lift: 125

Explored 3703 nodes (27348683 simplex iterations) in 3600.03 seconds (8436.43 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 51953.5 51891.8 51792.3 ... 51363.9

Time limit reached
Best objective 5.195351820277e+04, best bound 7.347613469383e+04, gap 41.4267%
  WARNING: Time limit reached. Using best solution found (gap: 41.43%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.12s
  Master Objective (UB) = 51953.52, θ = 229052.62
  Upper Bound (UB) = 51953.52

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 229052.62
  [DEBUG]   ✓ Scenario 0: θ = 229052.62 ≤ Q = 229052.62 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 229052.62 ≤ Q = 229052.62 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 229052.62 ≤ Q = 229052.62 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 229052.62 ≤ Q = 229052.62 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 229052.62 ≤ Q = 229052.62 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 229052.62 ≤ Q = 229052.62 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 229052.62 ≤ Q = 229052.62 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 229052.62 ≤ Q = 229052.62 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 229052.62 ≤ Q = 229052.62 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 229052.62 ≤ Q = 229052.62 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 229052.62 ≤ Q = 229052.62 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 229052.62 ≤ Q = 229052.62 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 229052.62 ≤ Q = 229052.62 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 13] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x67d11fd9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x67d11fd9
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [6e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [8e-14, 2e+02]
Found heuristic solution: objective 1.321398e+13
Presolve removed 2557 rows and 1847 columns
Presolve time: 0.00s
Presolved: 536 rows, 542 columns, 1519 nonzeros
Found heuristic solution: objective 6873560.2657
Variable types: 367 continuous, 175 integer (175 binary)
Found heuristic solution: objective 6873212.7802

Root relaxation: objective -1.698684e+05, 253 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -169868.43    0  122 6873212.78 -169868.43   102%     -    0s
H    0     0                    -132054.8554 -169868.43  28.6%     -    0s
H    0     0                    -135334.5358 -169868.43  25.5%     -    0s
H    0     0                    -136034.5210 -169840.09  24.9%     -    0s
     0     0 -150494.00    0  131 -136034.52 -150494.00  10.6%     -    0s
H    0     0                    -144470.5641 -150466.63  4.15%     -    0s
     0     0 -150440.34    0  131 -144470.56 -150440.34  4.13%     -    0s
H    0     0                    -146728.9879 -150440.34  2.53%     -    0s
     0     0 -149275.48    0  127 -146728.99 -149275.48  1.74%     -    0s
H    0     0                    -146767.3787 -149259.83  1.70%     -    0s
     0     0 -149256.45    0  127 -146767.38 -149256.45  1.70%     -    0s
H    0     0                    -147176.4447 -149256.45  1.41%     -    0s
     0     0 -148587.71    0   96 -147176.44 -148587.71  0.96%     -    0s
H    0     0                    -147566.5588 -148586.79  0.69%     -    0s
     0     0 -148577.33    0   96 -147566.56 -148577.33  0.68%     -    0s
     0     0 -148402.21    0   80 -147566.56 -148402.21  0.57%     -    0s
     0     0 -148383.97    0   77 -147566.56 -148383.97  0.55%     -    0s
     0     0 -148332.13    0   78 -147566.56 -148332.13  0.52%     -    0s
     0     0 -148326.62    0   78 -147566.56 -148326.62  0.52%     -    0s
     0     2 -148326.62    0   78 -147566.56 -148326.62  0.52%     -    0s
H  207   143                    -147587.8044 -147939.52  0.24%   7.5    0s
H  265   143                    -147604.0894 -147939.52  0.23%   7.9    0s
H 1814   142                    -147607.1664 -147732.71  0.09%   6.3    0s
H 1824   142                    -147624.5406 -147732.71  0.07%   6.3    0s
* 2203     9              46    -147631.9719 -147701.30  0.05%   5.9    0s

Cutting planes:
  Gomory: 29
  Implied bound: 4
  MIR: 247
  Flow cover: 6
  RLT: 36
  Relax-and-lift: 4

Explored 2326 nodes (13916 simplex iterations) in 0.15 seconds (0.14 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -147632 -147625 -147607 ... -136035
No other solutions better than -147632

Optimal solution found (tolerance 1.00e-04)
Best objective -1.476319718532e+05, best bound -1.476319718532e+05, gap 0.0000%
  Subproblem solved in 0.17s
  Worst-case operational profit (Z_SP) = 218391.07
  Scenario: 44 demand increases, 16 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -147631.97
  [DEBUG]   S×d_nominal = 366023.04
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 366023.04 + -147631.97 = 218391.07
  [DEBUG]   Current θ from Master = 229052.62
  [DEBUG]   ⚠️  Z_SP ≤ θ by 10661.56 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 41291.96
  Lower Bound (LB) = 48673.91
  Gap (UB-LB) = 3279.6100, Absolute Gap = 3279.6100, Relative Gap = 0.063126
  Not converged yet (gap = 3279.61 > ε = 200)

  [DEBUG] Adding NEW scenario 13 to Master Problem...
  [DEBUG] New scenario pattern: 44 increases, 16 decreases
    [DEBUG] Scenario 13 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 13 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 13]
    [DEBUG]   - Total constraints in model: 215443
    [DEBUG]   - Total variables in model: 89620
  [DEBUG] Total scenarios in Master: 14
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 14
================================================================================
[Iteration 14] Solving Master Problem...
  Current scenarios in Master: 14
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 215443 rows, 89620 columns and 611089 nonzeros
Model fingerprint: 0xd4ae34c0
Variable types: 87361 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 87668 rows and 35588 columns
Presolve time: 2.10s
Presolved: 127775 rows, 54032 columns, 784527 nonzeros
Variable types: 51773 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -285874.8191
Found heuristic solution: objective -222814.0110

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.32s

Barrier statistics:
 Dense cols : 701
 AA' NZ     : 5.356e+06
 Factor NZ  : 1.236e+07 (roughly 170 MB of memory)
 Factor Ops : 2.687e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.78603703e+07  2.31962291e+08  1.43e+05 1.98e+01  8.55e+04     4s
   1  -1.36755889e+07  2.15576038e+08  1.00e+05 8.24e+01  5.96e+04     4s
   2  -6.11415939e+06  1.68168480e+08  4.38e+04 1.42e+00  2.71e+04     4s
   3  -1.33300399e+06  1.31403780e+08  5.31e+03 1.75e+00  3.72e+03     4s
   4  -6.38831173e+05  5.51451258e+07  7.74e+02 2.54e-01  6.53e+02     4s
   5  -4.39672752e+05  3.27630362e+07  3.07e+02 1.25e-01  2.91e+02     4s
   6  -3.55217979e+05  2.56261334e+07  9.92e+01 9.12e-02  1.56e+02     4s
   7  -2.63180498e+05  1.96472857e+07  4.73e+01 6.68e-02  1.04e+02     4s
   8  -1.51574529e+05  1.29818098e+07  1.33e+01 4.19e-02  6.05e+01     4s
   9  -1.06897311e+05  8.33156435e+06  7.16e+00 2.60e-02  3.77e+01     4s
  10  -9.28791710e+04  4.02068171e+06  3.23e+00 1.23e-02  1.80e+01     4s
  11  -3.74542433e+04  7.53689903e+05  5.48e-01 1.68e-03  3.41e+00     4s
  12  -1.76765028e+04  4.52101578e+05  3.69e-01 9.84e-04  2.02e+00     5s
  13   6.29977844e+03  2.98582810e+05  2.19e-01 1.02e-03  1.26e+00     5s
  14   2.70643235e+04  2.59405514e+05  1.51e-01 1.02e-03  9.97e-01     5s
  15   3.77659046e+04  2.15142961e+05  1.16e-01 1.22e-03  7.61e-01     5s
  16   4.62574741e+04  1.71677111e+05  9.45e-02 2.88e-03  5.38e-01     5s
  17   5.55514734e+04  1.48526778e+05  7.16e-02 1.94e-03  3.99e-01     5s
  18   6.25690556e+04  1.29763641e+05  5.42e-02 1.88e-03  2.88e-01     5s
  19   6.69857291e+04  1.20728545e+05  4.45e-02 2.08e-03  2.31e-01     5s
  20   6.75804236e+04  1.14802723e+05  4.32e-02 1.70e-03  2.03e-01     5s
  21   7.13756672e+04  1.11036137e+05  3.54e-02 1.42e-03  1.70e-01     5s
  22   7.67684455e+04  1.06852021e+05  2.48e-02 1.12e-03  1.29e-01     5s
  23   7.78528330e+04  1.04493659e+05  2.29e-02 9.58e-04  1.14e-01     5s
  24   8.02388332e+04  1.01343456e+05  1.87e-02 6.98e-04  9.06e-02     5s
  25   8.22743838e+04  9.84389510e+04  1.52e-02 4.82e-04  6.94e-02     6s
  26   8.45421118e+04  9.65210954e+04  1.15e-02 3.49e-04  5.14e-02     6s
  27   8.49702178e+04  9.51278158e+04  1.07e-02 2.61e-04  4.36e-02     6s
  28   8.72044848e+04  9.45276625e+04  7.18e-03 2.11e-04  3.14e-02     6s
  29   8.82610025e+04  9.37848212e+04  5.51e-03 1.45e-04  2.37e-02     6s
  30   8.92750254e+04  9.34148109e+04  3.93e-03 1.15e-04  1.78e-02     6s
  31   8.99902781e+04  9.29883949e+04  2.84e-03 7.91e-05  1.29e-02     6s
  32   9.06562751e+04  9.26457375e+04  1.85e-03 1.04e-04  8.54e-03     6s
  33   9.11425815e+04  9.24063303e+04  1.17e-03 6.70e-05  5.43e-03     6s
  34   9.14092644e+04  9.22780053e+04  7.91e-04 4.66e-05  3.73e-03     6s
  35   9.15449258e+04  9.21367947e+04  6.01e-04 2.22e-05  2.54e-03     6s
  36   9.17537525e+04  9.20988301e+04  3.17e-04 1.60e-05  1.48e-03     6s
  37   9.18580155e+04  9.20497824e+04  1.73e-04 7.92e-06  8.23e-04     7s
  38   9.18884357e+04  9.20292532e+04  1.35e-04 4.54e-06  6.05e-04     7s
  39   9.19334014e+04  9.20204205e+04  8.03e-05 3.27e-06  3.74e-04     7s
  40   9.19811684e+04  9.20120536e+04  1.97e-05 1.96e-06  1.33e-04     7s
  41   9.19852795e+04  9.20055939e+04  1.49e-05 9.79e-07  8.72e-05     7s
  42   9.19933982e+04  9.20023774e+04  5.88e-06 4.62e-07  3.85e-05     7s
  43   9.19972891e+04  9.20003374e+04  1.80e-06 1.62e-07  1.31e-05     7s
  44   9.19988256e+04  9.19992367e+04  2.89e-07 7.82e-09  1.77e-06     7s
  45   9.19991592e+04  9.19991644e+04  3.68e-09 1.60e-09  2.24e-08     7s
  46   9.19991596e+04  9.19991614e+04  6.43e-09 1.16e-09  7.74e-09     7s
  47   9.19991608e+04  9.19991614e+04  1.29e-06 5.96e-08  2.55e-09     7s

Barrier solved model in 47 iterations and 7.46 seconds (11.68 work units)
Optimal objective 9.19991608e+04


Root crossover log...

  114862 DPushes remaining with DInf 0.0000000e+00                 7s
   26810 DPushes remaining with DInf 0.0000000e+00                10s
    1213 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                16s

   21022 PPushes remaining with PInf 7.9985465e-05                16s
       0 PPushes remaining with PInf 0.0000000e+00                19s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.4603277e+04     19s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   86531    9.1999161e+04   0.000000e+00   2.460328e+04     19s
   87570    9.1999161e+04   0.000000e+00   9.811542e+01     20s
   88409    9.1999161e+04   0.000000e+00   0.000000e+00     21s
   88409    9.1999161e+04   0.000000e+00   0.000000e+00     21s
Concurrent spin time: 1.40s

Solved with barrier

Root relaxation: objective 9.199916e+04, 88409 iterations, 19.55 seconds (41.24 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 91999.1614    0  178 -222814.01 91999.1614   141%     -   23s
H    0     0                    -168370.9819 91999.1614   155%     -   23s
H    0     0                    -164366.9141 91999.1614   156%     -   23s
H    0     0                    -72329.17746 91999.1614   227%     -   23s
H    0     0                    -71890.56502 91999.1614   228%     -   24s
H    0     0                    3727.3123303 91999.1614  2368%     -   24s
H    0     0                    10858.232886 91999.1614   747%     -   24s
H    0     0                    23565.742432 91999.1614   290%     -   25s
H    0     0                    35814.088869 91999.1614   157%     -   25s
H    0     0                    37246.956541 91999.1614   147%     -   25s
H    0     0                    38060.187146 91999.1614   142%     -   25s
H    0     0                    38754.415443 91999.1614   137%     -   27s
H    0     0                    39093.912743 91999.1614   135%     -   27s
H    0     0                    39261.684312 91999.1614   134%     -   27s
H    0     0                    39700.441126 91999.0787   132%     -   27s
H    0     0                    40735.319982 85515.7748   110%     -   92s
H    0     0                    40822.046296 85515.7748   109%     -   92s
H    0     0                    41173.496737 85515.7748   108%     -   92s
H    0     0                    41238.085348 85515.7748   107%     -   92s
H    0     0                    41362.604298 85515.7748   107%     -   92s
H    0     0                    41362.842961 85515.7748   107%     -   92s
H    0     0                    41365.693963 85515.7748   107%     -   92s
H    0     0                    41850.575617 85515.7748   104%     -   92s
     0     0 85515.7748    0  203 41850.5756 85515.7748   104%     -   92s
H    0     0                    43205.070274 85515.4123  97.9%     -   94s
H    0     0                    43347.591228 85515.4123  97.3%     -   94s
     0     0 84897.3518    0  215 43347.5912 84897.3518  95.9%     -  113s
     0     0 84796.6110    0  220 43347.5912 84796.6110  95.6%     -  126s
     0     0 84717.5267    0  217 43347.5912 84717.5267  95.4%     -  135s
     0     0 84717.5267    0  239 43347.5912 84717.5267  95.4%     -  142s
     0     0 84717.5267    0  214 43347.5912 84717.5267  95.4%     -  145s
     0     0 84717.5267    0  211 43347.5912 84717.5267  95.4%     -  147s
     0     0 84717.5267    0  213 43347.5912 84717.5267  95.4%     -  148s
     0     0 84717.5267    0  213 43347.5912 84717.5267  95.4%     -  149s
     0     0 80967.9156    0  328 43347.5912 80967.9156  86.8%     -  195s
H    0     0                    47155.190499 80967.8981  71.7%     -  195s
H    0     0                    48094.663218 80967.8981  68.4%     -  196s
H    0     0                    48147.388857 80967.8981  68.2%     -  196s
H    0     0                    48425.110358 80967.8981  67.2%     -  196s
H    0     0                    48508.343895 80967.8981  66.9%     -  196s
H    0     0                    48674.049842 80967.8981  66.3%     -  196s
     0     0 80746.8641    0  346 48674.0498 80746.8641  65.9%     -  214s
     0     0 80628.3389    0  341 48674.0498 80628.3389  65.6%     -  227s
     0     0 80565.6835    0  337 48674.0498 80565.6835  65.5%     -  239s
     0     0 80549.9255    0  345 48674.0498 80549.9255  65.5%     -  244s
     0     0 80540.8312    0  354 48674.0498 80540.8312  65.5%     -  246s
     0     0 80537.4303    0  352 48674.0498 80537.4303  65.5%     -  248s
     0     0 80521.2574    0  350 48674.0498 80521.2574  65.4%     -  252s
     0     0 80515.8019    0  344 48674.0498 80515.8019  65.4%     -  256s
     0     0 80510.3465    0  347 48674.0498 80510.3465  65.4%     -  259s
     0     0 80505.5460    0  339 48674.0498 80505.5460  65.4%     -  260s
     0     0 80504.0042    0  346 48674.0498 80504.0042  65.4%     -  261s
     0     0 80503.6586    0  348 48674.0498 80503.6586  65.4%     -  261s
     0     0 78519.5067    0  328 48674.0498 78519.5067  61.3%     -  313s
     0     0 78152.4017    0  338 48674.0498 78152.4017  60.6%     -  337s
     0     0 78036.7345    0  352 48674.0498 78036.7345  60.3%     -  350s
     0     0 77987.1505    0  354 48674.0498 77987.1505  60.2%     -  360s
     0     0 77957.2909    0  376 48674.0498 77957.2909  60.2%     -  368s
     0     0 77950.6712    0  378 48674.0498 77950.6712  60.1%     -  374s
     0     0 77946.3688    0  383 48674.0498 77946.3688  60.1%     -  377s
     0     0 77944.5189    0  380 48674.0498 77944.5189  60.1%     -  378s
     0     0 77927.6815    0  374 48674.0498 77927.6815  60.1%     -  383s
     0     0 77908.3054    0  372 48674.0498 77908.3054  60.1%     -  390s
     0     0 77903.3570    0  346 48674.0498 77903.3570  60.1%     -  394s
     0     0 77888.3091    0  357 48674.0498 77888.3091  60.0%     -  397s
     0     0 77886.1391    0  357 48674.0498 77886.1391  60.0%     -  399s
     0     0 77884.8948    0  359 48674.0498 77884.8948  60.0%     -  400s
     0     0 77078.0071    0  326 48674.0498 77078.0071  58.4%     -  445s
H    0     0                    48680.117900 77077.0686  58.3%     -  447s
     0     0 76794.5321    0  379 48680.1179 76794.5321  57.8%     -  468s
     0     0 76673.2659    0  347 48680.1179 76673.2659  57.5%     -  488s
     0     0 76601.5377    0  352 48680.1179 76601.5377  57.4%     -  503s
     0     0 76556.1548    0  396 48680.1179 76556.1548  57.3%     -  521s
     0     0 76539.5209    0  398 48680.1179 76539.5209  57.2%     -  528s
     0     0 76519.9120    0  368 48680.1179 76519.9120  57.2%     -  536s
     0     0 76511.9880    0  364 48680.1179 76511.9880  57.2%     -  543s
     0     0 76499.9718    0  371 48680.1179 76499.9718  57.1%     -  552s
     0     0 76494.9833    0  366 48680.1179 76494.9833  57.1%     -  556s
     0     0 76492.0196    0  367 48680.1179 76492.0196  57.1%     -  558s
     0     0 76486.4542    0  365 48680.1179 76486.4542  57.1%     -  564s
     0     0 76483.7386    0  376 48680.1179 76483.7386  57.1%     -  567s
     0     0 76482.0437    0  367 48680.1179 76482.0437  57.1%     -  570s
     0     0 76285.2465    0  345 48680.1179 76285.2465  56.7%     -  595s
     0     0 76210.9618    0  352 48680.1179 76210.9618  56.6%     -  613s
     0     0 76185.1979    0  358 48680.1179 76185.1979  56.5%     -  624s
     0     0 76177.4764    0  366 48680.1179 76177.4764  56.5%     -  630s
     0     0 76167.6787    0  360 48680.1179 76167.6787  56.5%     -  640s
     0     0 76163.8536    0  361 48680.1179 76163.8536  56.5%     -  643s
     0     0 76156.4804    0  364 48680.1179 76156.4804  56.4%     -  651s
     0     0 76148.6087    0  364 48680.1179 76148.6087  56.4%     -  659s
     0     0 76140.4457    0  360 48680.1179 76140.4457  56.4%     -  665s
     0     0 76139.1291    0  365 48680.1179 76139.1291  56.4%     -  666s
     0     0 76008.0083    0  385 48680.1179 76008.0083  56.1%     -  679s
     0     0 75968.9406    0  403 48680.1179 75968.9406  56.1%     -  695s
     0     0 75950.5977    0  400 48680.1179 75950.5977  56.0%     -  702s
     0     0 75943.0417    0  406 48680.1179 75943.0417  56.0%     -  706s
     0     0 75938.9321    0  401 48680.1179 75938.9321  56.0%     -  707s
     0     0 75935.8124    0  404 48680.1179 75935.8124  56.0%     -  710s
     0     0 75934.9868    0  407 48680.1179 75934.9868  56.0%     -  712s
     0     0 75879.0785    0  363 48680.1179 75879.0785  55.9%     -  725s
H    0     0                    48714.314955 75878.5394  55.8%     -  726s
H    0     0                    48760.066869 75878.5394  55.6%     -  726s
     0     0 75838.3322    0  350 48760.0669 75838.3322  55.5%     -  735s
     0     0 75824.4749    0  355 48760.0669 75824.4749  55.5%     -  738s
     0     0 75820.6293    0  369 48760.0669 75820.6293  55.5%     -  741s
     0     0 75819.5244    0  363 48760.0669 75819.5244  55.5%     -  743s
     0     0 75810.8284    0  378 48760.0669 75810.8284  55.5%     -  749s
H    0     0                    48959.280291 75810.7463  54.8%     -  753s
H    0     0                    49250.143362 75810.7463  53.9%     -  753s
     0     0 75809.5682    0  384 49250.1434 75809.5682  53.9%     -  755s
     0     0 75786.5827    0  378 49250.1434 75786.5827  53.9%     -  763s
     0     0 75780.1833    0  381 49250.1434 75780.1833  53.9%     -  766s
     0     0 75777.6949    0  365 49250.1434 75777.6949  53.9%     -  768s
     0     0 75776.7163    0  372 49250.1434 75776.7163  53.9%     -  769s
     0     0 75772.7015    0  360 49250.1434 75772.7015  53.9%     -  772s
H    0     0                    49589.728513 75772.5145  52.8%     -  776s
H    0     0                    50022.881991 75772.5145  51.5%     -  776s
     0     0 75771.3829    0  367 50022.8820 75771.3829  51.5%     -  778s
     0     0 75770.7107    0  367 50022.8820 75770.7107  51.5%     -  780s
     0     0 75770.2098    0  367 50022.8820 75770.2098  51.5%     -  783s
H    0     0                    50025.732993 75769.7513  51.5%     -  924s
     0     2 75769.7513    0  367 50025.7330 75769.7513  51.5%     -  928s
     1     3 74517.3042    1  311 50025.7330 75768.1024  51.5% 17901  947s
     2     4 75620.6837    1  361 50025.7330 75620.6837  51.2% 10996  954s
     3     5 74106.5856    2  328 50025.7330 75620.4065  51.2%  9199  968s
     4     9 75047.7829    2  357 50025.7330 75620.1508  51.2%  9846  984s
     8    17 74668.5801    3  354 50025.7330 75100.8148  50.1%  9556 1005s
    16    34 73204.0992    4  370 50025.7330 75100.8148  50.1% 13067 1049s
    33    49 73352.9503    5  348 50025.7330 74320.1916  48.6% 19963 1169s
    48    77 71476.4007    6  372 50025.7330 74320.1916  48.6% 20073 1218s
H   50    77                    50180.065829 74320.1916  48.1% 19661 1218s
H   56    77                    50788.178003 74320.1916  46.3% 19321 1218s
    76   190 70301.7214    7  289 50788.1780 74320.1916  46.3% 17285 1271s
   189   218 70490.3956    8  317 50788.1780 74320.1916  46.3% 11590 1298s
   217   260 70238.9982   10  323 50788.1780 74320.1916  46.3% 10761 1328s
   259   311 69893.0718   12  279 50788.1780 74320.1916  46.3%  9803 1371s
H  291   311                    51355.453402 74320.1916  44.7%  9147 1371s
   310   367 69538.1073   14  282 51355.4534 74320.1916  44.7%  8982 1408s
   366   411 67731.1411   16  277 51355.4534 74320.1916  44.7%  8446 1443s
   410   463 67501.2366   17  287 51355.4534 74320.1916  44.7%  8093 1484s
   462   499 67149.0903   20  252 51355.4534 74320.1916  44.7%  7784 1527s
   498   538 65912.6524   21  241 51355.4534 74320.1916  44.7%  7746 1562s
   537   579 68358.3989   17  278 51355.4534 74320.1916  44.7%  7992 1605s
   578   620 69419.7147   19  287 51355.4534 74320.1916  44.7%  7907 1644s
   619   668 66907.3322   20  301 51355.4534 74320.1916  44.7%  7728 1676s
   667   720 66615.3439   21  301 51355.4534 74320.1916  44.7%  7587 1707s
   721   785 64755.9670   23  208 51355.4534 74320.1916  44.7%  7399 1734s
   786   852 64065.1783   24  242 51355.4534 74320.1916  44.7%  7072 1765s
   855   946 63762.2240   25  261 51355.4534 74320.1916  44.7%  6752 1792s
   951  1011 63474.2145   27  245 51355.4534 74320.1916  44.7%  6397 1820s
  1036  1098 63147.6944   29  230 51355.4534 74320.1916  44.7%  6160 1847s
  1131  1209 62638.4754   34  227 51355.4534 74320.1916  44.7%  5923 1876s
  1256  1359 62261.4578   38  213 51355.4534 74320.1916  44.7%  5634 1902s
  1412  1451 62110.7405   44  242 51355.4534 74320.1916  44.7%  5231 1932s
  1536  1540 60582.7318   50  199 51355.4534 74320.1916  44.7%  5068 1965s
  1671  1657 59301.6923   53  187 51355.4534 74320.1916  44.7%  4910 1998s
  1835  1800 58861.6834   64  206 51355.4534 74320.1916  44.7%  4677 2030s
  2028  1847 58646.5136   71  203 51355.4534 74320.1916  44.7%  4454 2058s
  2105  1859 58312.1240   72  195 51355.4534 74320.1916  44.7%  4384 2093s
  2210  1899     cutoff   73      51355.4534 74320.1916  44.7%  4286 2145s
  2310  1922 52683.5182   74  173 51355.4534 74320.1916  44.7%  4221 2182s
  2417  1978 infeasible   75      51355.4534 74177.9765  44.4%  4155 2224s
  2549  2067     cutoff   76      51355.4534 74177.9765  44.4%  4095 2268s
  2690  2083 70902.9124   10  305 51355.4534 73893.2831  43.9%  4048 2306s
H 2708  2083                    51355.604588 73893.2128  43.9%  4080 2306s
H 2709  2083                    51364.705097 73893.2128  43.9%  4082 2306s
H 2731  2083                    51369.799425 73893.2128  43.8%  4098 2306s
  2734  2182 64289.8489    8  290 51369.7994 73893.2128  43.8%  4110 2351s
  2871  2253 63100.2837   10  327 51369.7994 73893.2128  43.8%  4115 2398s
  2972  2328 67896.8808   10  274 51369.7994 73508.9264  43.1%  4162 2451s
  3077  2417 67207.3312   11  272 51369.7994 73508.9264  43.1%  4205 2504s
  3180  2526 67141.1247   12  274 51369.7994 73508.9264  43.1%  4259 2563s
  3319  2699 66524.4352   16  253 51369.7994 73508.9264  43.1%  4295 2614s
  3519  2700 53264.2732   97  367 51369.7994 73508.9264  43.1%  4242 2963s
  3521  2701 70791.9147   19  141 51369.7994 73508.9264  43.1%  4240 2988s
  3522  2702 71937.9305   13  305 51369.7994 73508.9264  43.1%  4238 3132s
  3523  2703 67726.4815   10  359 51369.7994 73508.9264  43.1%  4237 3236s
  3524  2703 66131.6239   41  341 51369.7994 73508.9264  43.1%  4236 3288s
  3525  2704 71324.9196    7  330 51369.7994 73508.9264  43.1%  4235 3319s
  3526  2705 59425.5507   22  359 51369.7994 73508.9264  43.1%  4234 3335s
  3527  2705 65456.7474   17  343 51369.7994 73508.9264  43.1%  4232 3352s
  3528  2706 56156.1720   85  386 51369.7994 73508.9264  43.1%  4231 3369s
  3529  2707 56882.5760   41  399 51369.7994 73508.9264  43.1%  4230 3378s
  3530  2707 65484.0678   21  395 51369.7994 73508.9264  43.1%  4229 3389s
  3531  2708 64315.5480   39  396 51369.7994 73508.9264  43.1%  4228 3398s
  3532  2709 58164.3559   44  407 51369.7994 73508.9264  43.1%  4226 3407s
  3533  2709 62271.9475   13  410 51369.7994 73508.9264  43.1%  4225 3427s
  3534  2710 69775.1468   26  409 51369.7994 73508.9264  43.1%  4224 3436s
  3535  2711 56748.5648   26  380 51369.7994 73508.9264  43.1%  4223 3443s
  3536  2711 64422.9870   39  452 51369.7994 73508.9264  43.1%  4222 3458s
  3537  2712 58038.4911   26  450 51369.7994 73508.9264  43.1%  4220 3466s
  3538  2713 65921.4246   39  420 51369.7994 73508.9264  43.1%  4219 3485s
  3539  2713 58952.0297   24  410 51369.7994 73508.9264  43.1%  4218 3491s
  3540  2714 64256.7430   12  424 51369.7994 73508.9264  43.1%  4217 3501s
  3541  2715 57962.1349   39  433 51369.7994 73508.9264  43.1%  4216 3507s
  3542  2715 56672.1373   66  390 51369.7994 73508.9264  43.1%  4214 3533s
  3543  2716 53331.3718   70  384 51369.7994 73508.9264  43.1%  4213 3539s
  3544  2717 55744.3715   72  387 51369.7994 73508.9264  43.1%  4212 3544s
  3545  2717 53732.5022   61  380 51369.7994 73508.9264  43.1%  4211 3557s
  3546  2718 65278.1371   51  379 51369.7994 73508.9264  43.1%  4210 3562s
  3547  2719 61501.3386   65  371 51369.7994 73508.9264  43.1%  4208 3581s
  3548  2719 66080.1020   15  372 51369.7994 73508.9264  43.1%  4207 3586s
  3549  2720 59727.1652   45  421 51369.7994 73508.9264  43.1%  4206 3596s

Cutting planes:
  Learned: 1
  Gomory: 12
  Implied bound: 53
  Projected implied bound: 81
  MIR: 827
  Flow cover: 853
  RLT: 11
  Relax-and-lift: 128

Explored 3549 nodes (15876148 simplex iterations) in 3600.05 seconds (7665.42 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 51369.8 51364.7 51355.6 ... 49250.1

Time limit reached
Best objective 5.136979942474e+04, best bound 7.350892636995e+04, gap 43.0976%
  WARNING: Time limit reached. Using best solution found (gap: 43.10%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.17s
  Master Objective (UB) = 51369.80, θ = 232480.67
  Upper Bound (UB) = 51369.80

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 232480.67
  [DEBUG]   ✓ Scenario 0: θ = 232480.67 ≤ Q = 232480.67 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 232480.67 ≤ Q = 232480.67 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 232480.67 ≤ Q = 232480.67 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 232480.67 ≤ Q = 232480.67 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 232480.67 ≤ Q = 232480.67 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 232480.67 ≤ Q = 232480.67 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 232480.67 ≤ Q = 232480.67 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 232480.67 ≤ Q = 232480.67 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 232480.67 ≤ Q = 232480.67 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 232480.67 ≤ Q = 232480.67 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 232480.67 ≤ Q = 232480.67 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 232480.67 ≤ Q = 232480.67 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 232480.67 ≤ Q = 232480.67 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 232480.67 ≤ Q = 232480.67 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 14] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x60734616
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x9f8cb9ea
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.331174e+13
Presolve removed 2549 rows and 1840 columns
Presolve time: 0.01s
Presolved: 544 rows, 549 columns, 1538 nonzeros
Found heuristic solution: objective 7031375.8814
Variable types: 373 continuous, 176 integer (176 binary)

Root relaxation: objective -1.640462e+05, 264 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -164046.18    0  122 7031375.88 -164046.18   102%     -    0s
H    0     0                    -127283.0802 -164046.18  28.9%     -    0s
H    0     0                    -128972.6966 -164046.18  27.2%     -    0s
     0     0 -143797.09    0  105 -128972.70 -143797.09  11.5%     -    0s
H    0     0                    -140104.9398 -143778.77  2.62%     -    0s
H    0     0                    -141475.7257 -143778.77  1.63%     -    0s
     0     0 -142928.32    0   97 -141475.73 -142928.32  1.03%     -    0s
     0     0 -142668.00    0   65 -141475.73 -142668.00  0.84%     -    0s
H    0     0                    -141617.4735 -142538.50  0.65%     -    0s
     0     0 -142538.50    0   67 -141617.47 -142538.50  0.65%     -    0s
     0     0 -142515.56    0   72 -141617.47 -142515.56  0.63%     -    0s
     0     0 -142515.51    0   72 -141617.47 -142515.51  0.63%     -    0s
H    0     0                    -141693.7123 -142515.51  0.58%     -    0s
     0     0 -142394.59    0   67 -141693.71 -142394.59  0.49%     -    0s
     0     0 -142394.05    0   67 -141693.71 -142394.05  0.49%     -    0s
     0     0 -142308.67    0   67 -141693.71 -142308.67  0.43%     -    0s
     0     0 -142289.67    0   67 -141693.71 -142289.67  0.42%     -    0s
     0     2 -142289.67    0   67 -141693.71 -142289.67  0.42%     -    0s
H  351   123                    -141710.2558 -141971.93  0.18%   5.6    0s
H  379   123                    -141713.3932 -141971.93  0.18%   5.4    0s
* 2685   452              47    -141714.6856 -141829.62  0.08%   3.8    0s
* 4119     0              44    -141715.2739 -141735.55  0.01%   3.5    0s
* 4260     0              45    -141719.5311 -141731.96  0.01%   3.5    0s

Cutting planes:
  Gomory: 22
  Implied bound: 3
  MIR: 176
  Flow cover: 8
  RLT: 47
  Relax-and-lift: 2
  BQP: 1

Explored 4522 nodes (16479 simplex iterations) in 0.24 seconds (0.17 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -141720 -141715 -141715 ... -127283
No other solutions better than -141720

Optimal solution found (tolerance 1.00e-04)
Best objective -1.417195311149e+05, best bound -1.417195311149e+05, gap 0.0000%
  Subproblem solved in 0.26s
  Worst-case operational profit (Z_SP) = 222080.47
  Scenario: 45 demand increases, 15 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -141719.53
  [DEBUG]   S×d_nominal = 363800.00
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 363800.00 + -141719.53 = 222080.47
  [DEBUG]   Current θ from Master = 232480.67
  [DEBUG]   ⚠️  Z_SP ≤ θ by 10400.21 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 40969.59
  Lower Bound (LB) = 48673.91
  Gap (UB-LB) = 2695.8912, Absolute Gap = 2695.8912, Relative Gap = 0.052480
  Not converged yet (gap = 2695.89 > ε = 200)

  [DEBUG] Adding NEW scenario 14 to Master Problem...
  [DEBUG] New scenario pattern: 45 increases, 15 decreases
    [DEBUG] Scenario 14 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 14 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 14]
    [DEBUG]   - Total constraints in model: 230733
    [DEBUG]   - Total variables in model: 95860
  [DEBUG] Total scenarios in Master: 15
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 15
================================================================================
[Iteration 15] Solving Master Problem...
  Current scenarios in Master: 15
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 230733 rows, 95860 columns and 654344 nonzeros
Model fingerprint: 0x1fc209a5
Variable types: 93601 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 93930 rows and 38130 columns
Presolve time: 2.67s
Presolved: 136803 rows, 57730 columns, 839807 nonzeros
Variable types: 55471 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -285874.8191
Found heuristic solution: objective -222814.0110

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.35s

Barrier statistics:
 Dense cols : 695
 AA' NZ     : 6.101e+06
 Factor NZ  : 1.405e+07 (roughly 200 MB of memory)
 Factor Ops : 3.189e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.83748901e+07  2.46754129e+08  1.47e+05 1.94e+01  8.76e+04     4s
   1  -1.41185421e+07  2.30612548e+08  1.04e+05 8.08e+01  6.11e+04     4s
   2  -6.31137869e+06  1.79544979e+08  4.51e+04 2.84e+00  2.78e+04     5s
   3  -1.32438770e+06  1.41469001e+08  4.74e+03 1.63e+00  3.38e+03     5s
   4  -7.11950230e+05  6.39156071e+07  7.70e+02 2.78e-01  6.69e+02     5s
   5  -5.14037183e+05  3.96548078e+07  3.80e+02 1.51e-01  3.46e+02     5s
   6  -3.79211726e+05  3.13218861e+07  1.46e+02 1.15e-01  1.94e+02     5s
   7  -3.02559589e+05  2.29688950e+07  6.65e+01 7.94e-02  1.20e+02     5s
   8  -1.65526835e+05  1.72612747e+07  1.85e+01 5.66e-02  7.62e+01     5s
   9  -1.20359528e+05  1.12065090e+07  1.00e+01 3.55e-02  4.79e+01     5s
  10  -1.03143917e+05  5.91274018e+06  7.15e+00 1.80e-02  2.51e+01     5s
  11  -6.05492130e+04  1.67106988e+06  1.36e+00 4.46e-03  7.00e+00     5s
  12  -2.53608358e+04  6.81359676e+05  6.52e-01 1.81e-03  2.85e+00     5s
  13  -8.88899604e+03  3.29314440e+05  4.90e-01 9.51e-04  1.36e+00     5s
  14   1.49239634e+04  2.45196183e+05  3.21e-01 2.82e-03  9.26e-01     5s
  15   3.27616039e+04  2.16462159e+05  2.39e-01 2.11e-03  7.38e-01     5s
  16   4.52043922e+04  1.68834415e+05  1.83e-01 1.84e-03  4.97e-01     5s
  17   5.16013509e+04  1.50599176e+05  1.55e-01 2.39e-03  3.98e-01     6s
  18   5.88636175e+04  1.33326406e+05  1.21e-01 2.89e-03  2.99e-01     6s
  19   6.47479600e+04  1.27721073e+05  9.66e-02 2.23e-03  2.53e-01     6s
  20   6.81155978e+04  1.16605841e+05  8.27e-02 2.39e-03  1.95e-01     6s
  21   7.17164833e+04  1.12670080e+05  6.85e-02 2.15e-03  1.65e-01     6s
  22   7.58153480e+04  1.06517969e+05  5.29e-02 2.19e-03  1.23e-01     6s
  23   7.97618149e+04  1.04638564e+05  3.92e-02 1.93e-03  1.00e-01     6s
  24   8.11653709e+04  9.95888656e+04  3.43e-02 1.29e-03  7.41e-02     6s
  25   8.37187439e+04  9.78732105e+04  2.61e-02 1.25e-03  5.69e-02     6s
  26   8.54501336e+04  9.64221868e+04  2.06e-02 9.23e-04  4.41e-02     6s
  27   8.63770677e+04  9.56756160e+04  1.76e-02 7.57e-04  3.74e-02     6s
  28   8.74420222e+04  9.46412407e+04  1.42e-02 5.44e-04  2.90e-02     6s
  29   8.79471514e+04  9.42320612e+04  1.27e-02 4.71e-04  2.53e-02     7s
  30   8.85861885e+04  9.39419373e+04  1.07e-02 4.03e-04  2.16e-02     7s
  31   8.93816623e+04  9.36947239e+04  8.23e-03 3.47e-04  1.74e-02     7s
  32   8.98120367e+04  9.32438229e+04  6.90e-03 2.46e-04  1.38e-02     7s
  33   9.04744541e+04  9.30380710e+04  4.89e-03 1.92e-04  1.03e-02     7s
  34   9.08624166e+04  9.29061340e+04  3.73e-03 1.62e-04  8.22e-03     7s
  35   9.10845313e+04  9.27196834e+04  3.09e-03 1.21e-04  6.58e-03     7s
  36   9.14489482e+04  9.24773729e+04  2.02e-03 6.37e-05  4.14e-03     7s
  37   9.16334846e+04  9.24301661e+04  1.50e-03 5.30e-05  3.21e-03     7s
  38   9.17656282e+04  9.23722744e+04  1.13e-03 4.29e-05  2.44e-03     7s
  39   9.19500617e+04  9.23300448e+04  6.36e-04 3.24e-05  1.53e-03     7s
  40   9.20100093e+04  9.22741052e+04  4.72e-04 1.91e-05  1.06e-03     7s
  41   9.20371254e+04  9.22299845e+04  3.99e-04 9.02e-06  7.76e-04     8s
  42   9.21330434e+04  9.22098501e+04  1.41e-04 4.12e-06  3.09e-04     8s
  43   9.21588304e+04  9.22031738e+04  7.59e-05 2.70e-06  1.78e-04     8s
  44   9.21777394e+04  9.22010898e+04  2.85e-05 2.24e-06  9.38e-05     8s
  45   9.21797579e+04  9.21940883e+04  2.37e-05 8.12e-07  5.76e-05     8s
  46   9.21868062e+04  9.21934292e+04  7.36e-06 6.71e-07  2.66e-05     8s
  47   9.21881457e+04  9.21930646e+04  4.23e-06 5.96e-07  1.97e-05     8s
  48   9.21888477e+04  9.21919457e+04  2.67e-06 3.68e-07  1.24e-05     8s
  49   9.21891704e+04  9.21911511e+04  1.94e-06 2.08e-07  7.96e-06     8s
  50   9.21893057e+04  9.21906917e+04  1.65e-06 1.16e-07  5.57e-06     8s
  51   9.21901056e+04  9.21901402e+04  3.42e-08 3.41e-07  1.39e-07     8s
  52   9.21901325e+04  9.21901326e+04  1.27e-08 3.27e-09  4.06e-10     9s

Barrier solved model in 52 iterations and 8.58 seconds (13.15 work units)
Optimal objective 9.21901325e+04


Root crossover log...

  121038 DPushes remaining with DInf 0.0000000e+00                 9s
   26114 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                12s

    3973 PPushes remaining with PInf 2.5932030e-05                12s
       0 PPushes remaining with PInf 0.0000000e+00                12s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.3406303e+00     12s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   60227    9.2190133e+04   0.000000e+00   1.340630e+00     12s
   60236    9.2190133e+04   0.000000e+00   0.000000e+00     12s
   60236    9.2190133e+04   0.000000e+00   0.000000e+00     12s
Concurrent spin time: 3.19s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 9.219013e+04, 60236 iterations, 12.10 seconds (18.03 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 92190.1326    0  185 -222814.01 92190.1326   141%     -   16s
H    0     0                    -165767.5879 92190.1326   156%     -   16s
H    0     0                    -144715.3851 92190.1326   164%     -   16s
H    0     0                    -141053.6834 92190.1326   165%     -   16s
H    0     0                    -139794.2514 92190.1326   166%     -   17s
H    0     0                    -139588.5424 92190.1326   166%     -   17s
H    0     0                    -85093.79599 92190.1326   208%     -   17s
H    0     0                    -84740.61603 92190.1326   209%     -   17s
H    0     0                    -32695.70887 92190.1326   382%     -   17s
H    0     0                    -32497.58988 92190.1326   384%     -   17s
H    0     0                    -628.3935278 92190.1326      -     -   17s
H    0     0                    25735.828862 92190.1326   258%     -   18s
H    0     0                    33733.205543 92190.1326   173%     -   19s
H    0     0                    33777.641300 92190.1326   173%     -   19s
H    0     0                    34858.931281 92190.1326   164%     -   19s
H    0     0                    39053.209149 92190.1326   136%     -   19s
H    0     0                    39749.965687 92190.1326   132%     -   19s
     0     0 85078.5520    0  218 39749.9657 85078.5520   114%     -   80s
H    0     0                    43102.577044 85078.5502  97.4%     -   82s
H    0     0                    43508.058213 85078.5502  95.5%     -   82s
H    0     0                    43536.934746 85078.5502  95.4%     -   82s
H    0     0                    44482.586178 85078.5502  91.3%     -   82s
     0     0 84513.4533    0  256 44482.5862 84513.4533  90.0%     -  122s
     0     0 84393.0094    0  254 44482.5862 84393.0094  89.7%     -  143s
     0     0 84263.9524    0  265 44482.5862 84263.9524  89.4%     -  161s
     0     0 84224.9425    0  272 44482.5862 84224.9425  89.3%     -  171s
     0     0 84213.2914    0  272 44482.5862 84213.2914  89.3%     -  176s
     0     0 84212.0447    0  274 44482.5862 84212.0447  89.3%     -  176s
     0     0 84212.0447    0  274 44482.5862 84212.0447  89.3%     -  177s
     0     0 81450.4344    0  286 44482.5862 81450.4344  83.1%     -  256s
H    0     0                    45757.436923 81450.4108  78.0%     -  257s
H    0     0                    45888.457787 81450.4108  77.5%     -  257s
H    0     0                    45929.873334 81450.4108  77.3%     -  257s
H    0     0                    46014.907441 81450.4108  77.0%     -  257s
     0     0 80335.1474    0  322 46014.9074 80335.1474  74.6%     -  307s
     0     0 80174.7720    0  349 46014.9074 80174.7720  74.2%     -  330s
     0     0 80067.1801    0  356 46014.9074 80067.1801  74.0%     -  346s
     0     0 79936.1138    0  350 46014.9074 79936.1138  73.7%     -  362s
     0     0 79926.0962    0  360 46014.9074 79926.0962  73.7%     -  369s
     0     0 79913.5831    0  359 46014.9074 79913.5831  73.7%     -  375s
     0     0 79912.3690    0  359 46014.9074 79912.3690  73.7%     -  376s
     0     0 77762.2446    0  304 46014.9074 77762.2446  69.0%     -  451s
     0     0 77408.4040    0  311 46014.9074 77408.4040  68.2%     -  481s
     0     0 77266.5429    0  320 46014.9074 77266.5429  67.9%     -  497s
     0     0 77204.7587    0  322 46014.9074 77204.7587  67.8%     -  510s
     0     0 77156.0998    0  360 46014.9074 77156.0998  67.7%     -  520s
     0     0 77139.5970    0  333 46014.9074 77139.5970  67.6%     -  527s
     0     0 77130.8054    0  339 46014.9074 77130.8054  67.6%     -  532s
     0     0 77123.6463    0  342 46014.9074 77123.6463  67.6%     -  536s
     0     0 77120.3826    0  332 46014.9074 77120.3826  67.6%     -  539s
     0     0 77119.6576    0  330 46014.9074 77119.6576  67.6%     -  541s
     0     0 76354.0882    0  388 46014.9074 76354.0882  65.9%     -  575s
     0     0 76241.5812    0  397 46014.9074 76241.5812  65.7%     -  589s
     0     0 76190.9362    0  358 46014.9074 76190.9362  65.6%     -  599s
     0     0 76179.9297    0  370 46014.9074 76179.9297  65.6%     -  603s
     0     0 76157.2986    0  360 46014.9074 76157.2986  65.5%     -  608s
     0     0 76115.1981    0  418 46014.9074 76115.1981  65.4%     -  616s
     0     0 76111.8108    0  377 46014.9074 76111.8108  65.4%     -  619s
     0     0 76106.1189    0  381 46014.9074 76106.1189  65.4%     -  620s
     0     0 76095.9733    0  386 46014.9074 76095.9733  65.4%     -  623s
     0     0 76092.7166    0  385 46014.9074 76092.7166  65.4%     -  625s
     0     0 76089.8064    0  379 46014.9074 76089.8064  65.4%     -  626s
     0     0 76089.3757    0  385 46014.9074 76089.3757  65.4%     -  627s
     0     0 75913.5749    0  404 46014.9074 75913.5749  65.0%     -  642s
     0     0 75892.2627    0  378 46014.9074 75892.2627  64.9%     -  648s
     0     0 75884.1388    0  374 46014.9074 75884.1388  64.9%     -  650s
     0     0 75882.8919    0  371 46014.9074 75882.8919  64.9%     -  652s
     0     0 75826.3051    0  402 46014.9074 75826.3051  64.8%     -  662s
     0     0 75806.1537    0  367 46014.9074 75806.1537  64.7%     -  667s
     0     0 75801.0783    0  404 46014.9074 75801.0783  64.7%     -  670s
     0     0 75795.4494    0  400 46014.9074 75795.4494  64.7%     -  673s
     0     0 75790.1235    0  405 46014.9074 75790.1235  64.7%     -  677s
     0     0 75788.5489    0  411 46014.9074 75788.5489  64.7%     -  678s
     0     0 75766.7690    0  400 46014.9074 75766.7690  64.7%     -  689s
H    0     0                    46204.013969 75766.6475  64.0%     -  690s
     0     0 75761.3144    0  408 46204.0140 75761.3144  64.0%     -  692s
     0     0 75758.2642    0  407 46204.0140 75758.2642  64.0%     -  695s
     0     0 75750.9122    0  374 46204.0140 75750.9122  63.9%     -  698s
     0     0 75749.1071    0  368 46204.0140 75749.1071  63.9%     -  699s
     0     0 75728.6472    0  411 46204.0140 75728.6472  63.9%     -  708s
     0     0 75722.0685    0  407 46204.0140 75722.0685  63.9%     -  710s
     0     0 75719.0638    0  434 46204.0140 75719.0638  63.9%     -  713s
     0     0 75714.7929    0  401 46204.0140 75714.7929  63.9%     -  715s
     0     0 75712.4929    0  368 46204.0140 75712.4929  63.9%     -  718s
     0     0 75697.9175    0  437 46204.0140 75697.9175  63.8%     -  725s
     0     0 75695.5745    0  438 46204.0140 75695.5745  63.8%     -  728s
     0     0 75692.4269    0  432 46204.0140 75692.4269  63.8%     -  733s
     0     0 75690.9959    0  399 46204.0140 75690.9959  63.8%     -  736s
     0     0 75689.8087    0  407 46204.0140 75689.8087  63.8%     -  739s
     0     0 75688.5786    0  409 46204.0140 75688.5786  63.8%     -  741s
     0     0 75656.2884    0  404 46204.0140 75656.2884  63.7%     -  748s
     0     0 75646.2967    0  380 46204.0140 75646.2967  63.7%     -  753s
     0     0 75621.1854    0  383 46204.0140 75621.1854  63.7%     -  757s
     0     0 75615.5354    0  421 46204.0140 75615.5354  63.7%     -  759s
     0     0 75614.1231    0  386 46204.0140 75614.1231  63.7%     -  761s
     0     0 75603.8312    0  384 46204.0140 75603.8312  63.6%     -  765s
     0     0 75602.5146    0  389 46204.0140 75602.5146  63.6%     -  767s
     0     0 75589.3393    0  384 46204.0140 75589.3393  63.6%     -  773s
     0     0 75589.1199    0  422 46204.0140 75589.1199  63.6%     -  775s
     0     0 75583.1839    0  393 46204.0140 75583.1839  63.6%     -  779s
     0     0 75582.1954    0  386 46204.0140 75582.1954  63.6%     -  782s
     0     0 75581.2919    0  382 46204.0140 75581.2919  63.6%     -  784s
     0     0 75581.2847    0  382 46204.0140 75581.2847  63.6%     -  787s
H    0     0                    47197.467904 75581.2847  60.1%     -  955s
H    0     0                    47366.205260 75581.2847  59.6%     -  956s
H    0     2                    47501.156641 75581.2847  59.1%     -  965s
     0     2 75581.2847    0  382 47501.1566 75581.2847  59.1%     -  965s
     1     3 75187.3991    1  361 47501.1566 75581.0205  59.1% 14402  985s
     2     5 74875.2855    2  346 47501.1566 75581.0205  59.1% 13546 1002s
     4     9 74779.1170    3  354 47501.1566 75221.4945  58.4% 12258 1024s
     8    17 74663.5864    4  346 47501.1566 75221.4945  58.4% 11800 1071s
    16    34 74258.5024    4  416 47501.1566 75020.0157  57.9% 15823 1111s
    33    49 74000.7278    5  393 47501.1566 74595.7937  57.0% 22338 1216s
    48    75 72056.3480    7  312 47501.1566 74595.7937  57.0% 21886 1285s
H   50    75                    47821.485803 74595.7937  56.0% 21569 1285s
H   53    75                    48249.516247 74595.7937  54.6% 21612 1285s
    74   136 70850.8844    7  343 48249.5162 74595.7937  54.6% 21612 1382s
H  135   237                    48282.879083 74595.7937  54.5% 18165 1441s
H  138   237                    48330.505427 74595.7937  54.3% 17925 1441s
   236   295 70418.8467    9  322 48330.5054 74595.7937  54.3% 12959 1491s
   294   344 69165.0019   10  309 48330.5054 74595.7937  54.3% 11726 1537s
H  303   344                    48333.356430 74595.7937  54.3% 11502 1537s
H  322   344                    48458.251628 74595.7937  53.9% 11143 1537s
   343   370 70042.6887   11  333 48458.2516 74595.7937  53.9% 10914 1584s
   369   410 67980.6149   11  261 48458.2516 74595.7937  53.9% 10757 1645s
   409   452 68612.7981   20  247 48458.2516 74595.7937  53.9% 10538 1679s
   451   480 69069.2532   11  311 48458.2516 74595.7937  53.9% 10628 1710s
H  456   480                    49096.887498 74595.7937  51.9% 10558 1710s
H  465   480                    49856.123370 74595.7937  49.6% 10494 1710s
   479   573 67956.9740   12  256 49856.1234 74595.7937  49.6% 10410 1748s
   572   604 67706.5889   14  257 49856.1234 74595.7937  49.6%  9931 1775s
H  577   604                    49993.620156 74595.7937  49.2%  9895 1775s
H  588   604                    50072.424318 74595.7937  49.0%  9932 1775s
   603   684 67686.1426   15  262 50072.4243 74595.7937  49.0% 10021 1813s
   683   717 67559.9641   16  257 50072.4243 74595.7937  49.0%  9904 1835s
   716   765 67401.3869   17  243 50072.4243 74595.7937  49.0%  9909 1860s
H  721   765                    50108.371696 74595.7937  48.9%  9918 1860s
   764   795 67325.8694   17  263 50108.3717 74595.7937  48.9%  9903 1883s
H  771   795                    50172.660845 74595.7937  48.7%  9922 1883s
H  792   795                    50236.576870 74595.7937  48.5%  9893 1883s
   794   875 67433.7530   17  255 50236.5769 74595.7937  48.5%  9894 1916s
   874   959 67257.6336   18  235 50236.5769 74595.7937  48.5%  9777 1949s
   958  1010 67074.0574   18  227 50236.5769 74595.7937  48.5%  9586 1975s
H  974  1010                    50289.069460 74595.7937  48.3%  9607 1975s
H  983  1010                    50355.966745 74595.7937  48.1%  9547 1975s
  1011  1121 67242.9774   19  234 50355.9667 74595.7937  48.1%  9495 2013s
  1132  1231 63003.2569   22  266 50355.9667 74595.7937  48.1%  9163 2045s
  1256  1271 66544.7226   23  234 50355.9667 74595.7937  48.1%  8839 2074s
H 1267  1271                    50471.683618 74595.7937  47.8%  8794 2074s
  1315  1346 60395.7776   23  195 50471.6836 74595.7937  47.8%  8706 2108s
  1444  1404 58821.3143   25  190 50471.6836 74595.7937  47.8%  8514 2144s
  1544  1452     cutoff   26      50471.6836 74595.7937  47.8%  8581 2182s
  1647  1479     cutoff   26      50471.6836 74595.7937  47.8%  8630 2224s
  1728  1533 56707.2274   28  171 50471.6836 74595.7937  47.8%  8649 2263s
  1800  1581 51403.2769   29  124 50471.6836 74595.7937  47.8%  8872 2304s
  1882  1652 58517.0226   23  253 50471.6836 74595.7937  47.8%  9032 2343s
  1987  1736 55793.5717   24  260 50471.6836 74595.7937  47.8%  9020 2392s
  2101  1777 53710.3048   25  256 50471.6836 74595.7937  47.8%  9036 2433s
H 2102  1777                    50501.507752 74595.7937  47.7%  9032 2433s
  2195  1841 infeasible   26      50501.5078 74595.7937  47.7%  8904 2479s
  2315  1918 infeasible   26      50501.5078 74595.7937  47.7%  8911 2535s
  2460  1953 67365.9801   12  321 50501.5078 74595.7937  47.7%  8888 2589s
  2528  2093 67265.5506   13  318 50501.5078 74595.7937  47.7%  8900 2635s
  2716  2229 67020.6830   14  303 50501.5078 74595.7937  47.7%  8726 2685s
  2906  2335 65118.7838   15  277 50501.5078 74595.7937  47.7%  8565 2737s
  3072  2420 64639.8322   16  257 50501.5078 74595.7937  47.7%  8455 2798s
  3234  2555 63668.8442   19  215 50501.5078 74595.7937  47.7%  8516 2856s
  3399  2692 62842.2902   23  197 50501.5078 74595.7937  47.7%  8519 2921s
  3604  2781 61623.9869   26  168 50501.5078 74595.7937  47.7%  8461 2998s
  3754  2782 54361.6722   67  382 50501.5078 74595.7937  47.7%  8561 3399s
  3756  2783 70349.4788    9  148 50501.5078 74595.7937  47.7%  8557 3421s
  3757  2784 68197.1512   15  318 50501.5078 74595.7937  47.7%  8554 3573s

Cutting planes:
  Gomory: 16
  Implied bound: 34
  Projected implied bound: 187
  MIR: 1038
  Mixing: 4
  Flow cover: 917
  RLT: 14
  Relax-and-lift: 200

Explored 3757 nodes (32882448 simplex iterations) in 3600.04 seconds (8808.10 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 50501.5 50471.7 50356 ... 49856.1

Time limit reached
Best objective 5.050150775195e+04, best bound 7.459579372879e+04, gap 47.7100%
  WARNING: Time limit reached. Using best solution found (gap: 47.71%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.10s
  Master Objective (UB) = 50501.51, θ = 246596.79
  Upper Bound (UB) = 50501.51

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 246596.79
  [DEBUG]   ✓ Scenario 0: θ = 246596.79 ≤ Q = 246596.79 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 246596.79 ≤ Q = 246596.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 246596.79 ≤ Q = 246596.79 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 246596.79 ≤ Q = 246596.79 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 246596.79 ≤ Q = 246596.79 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 246596.79 ≤ Q = 246596.79 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 246596.79 ≤ Q = 246596.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 246596.79 ≤ Q = 246596.79 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 246596.79 ≤ Q = 246596.79 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 246596.79 ≤ Q = 246596.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 246596.79 ≤ Q = 246596.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 246596.79 ≤ Q = 246596.79 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 246596.79 ≤ Q = 246596.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 246596.79 ≤ Q = 246596.79 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 246596.79 ≤ Q = 246596.79 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 15] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x3ca8885e
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x3ca8885e
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [7e-01, 2e+02]
Found heuristic solution: objective 1.282370e+13
Presolve removed 2550 rows and 1840 columns
Presolve time: 0.01s
Presolved: 543 rows, 549 columns, 1538 nonzeros
Found heuristic solution: objective 6613902.2360
Variable types: 373 continuous, 176 integer (176 binary)

Root relaxation: objective -1.780307e+05, 273 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -178030.74    0  131 6613902.24 -178030.74   103%     -    0s
H    0     0                    -138973.8042 -178030.74  28.1%     -    0s
H    0     0                    -140143.2413 -178030.74  27.0%     -    0s
H    0     0                    -150193.1152 -159427.33  6.15%     -    0s
H    0     0                    -153085.8397 -159427.33  4.14%     -    0s
     0     0 -159427.33    0   72 -153085.84 -159427.33  4.14%     -    0s
H    0     0                    -157154.0301 -159414.32  1.44%     -    0s
H    0     0                    -158169.8502 -159414.32  0.79%     -    0s
H    0     0                    -158448.6302 -159414.32  0.61%     -    0s
     0     0 -159195.72    0   57 -158448.63 -159195.72  0.47%     -    0s
     0     0 -159184.79    0   63 -158448.63 -159184.79  0.46%     -    0s
     0     0 -158591.98    0   21 -158448.63 -158591.98  0.09%     -    0s
     0     0 -158559.04    0   12 -158448.63 -158559.04  0.07%     -    0s
     0     0 -158546.93    0   14 -158448.63 -158546.93  0.06%     -    0s
     0     0 -158528.68    0   12 -158448.63 -158528.68  0.05%     -    0s
     0     0 -158528.68    0   17 -158448.63 -158528.68  0.05%     -    0s
H    0     0                    -158455.7448 -158528.68  0.05%     -    0s
     0     0 -158504.64    0    7 -158455.74 -158504.64  0.03%     -    0s
H    0     0                    -158488.8565 -158502.38  0.01%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 7
  Flow cover: 7

Explored 1 nodes (677 simplex iterations) in 0.07 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -158489 -158456 -158449 ... -140143

Optimal solution found (tolerance 1.00e-04)
Best objective -1.584888564633e+05, best bound -1.585023830218e+05, gap 0.0085%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 230652.41
  Scenario: 25 demand increases, 35 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -158488.86
  [DEBUG]   S×d_nominal = 389141.26
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 389141.26 + -158488.86 = 230652.41
  [DEBUG]   Current θ from Master = 246596.79
  [DEBUG]   ⚠️  Z_SP ≤ θ by 15944.39 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 34557.12
  Lower Bound (LB) = 48673.91
  Gap (UB-LB) = 1827.5995, Absolute Gap = 1827.5995, Relative Gap = 0.036189
  Not converged yet (gap = 1827.60 > ε = 200)

  [DEBUG] Adding NEW scenario 15 to Master Problem...
  [DEBUG] New scenario pattern: 25 increases, 35 decreases
    [DEBUG] Scenario 15 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 15 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 15]
    [DEBUG]   - Total constraints in model: 246023
    [DEBUG]   - Total variables in model: 102100
  [DEBUG] Total scenarios in Master: 16
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 16
================================================================================
[Iteration 16] Solving Master Problem...
  Current scenarios in Master: 16
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 246023 rows, 102100 columns and 697599 nonzeros
Model fingerprint: 0xe29d403f
Variable types: 99841 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 100192 rows and 40672 columns
Presolve time: 2.90s
Presolved: 145831 rows, 61428 columns, 895693 nonzeros
Variable types: 59169 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -285874.8191
Found heuristic solution: objective -222814.0110

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.21s

Barrier statistics:
 Dense cols : 695
 AA' NZ     : 6.852e+06
 Factor NZ  : 1.540e+07 (roughly 200 MB of memory)
 Factor Ops : 3.473e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.88655862e+07  2.60496546e+08  1.50e+05 1.93e+01  8.94e+04     6s
   1  -1.45540300e+07  2.44502813e+08  1.06e+05 8.01e+01  6.26e+04     6s
   2  -6.60297782e+06  1.89860280e+08  4.69e+04 3.75e+00  2.89e+04     6s
   3  -1.23834593e+06  1.51184878e+08  3.58e+03 2.55e+00  2.69e+03     6s
   4  -7.99727163e+05  7.28324629e+07  6.77e+02 4.59e-01  6.34e+02     6s
   5  -5.04770805e+05  4.79905995e+07  4.29e+02 2.67e-01  3.92e+02     6s
   6  -4.09729815e+05  3.98153886e+07  1.63e+02 2.10e-01  2.27e+02     6s
   7  -3.55339198e+05  2.92348320e+07  7.84e+01 1.45e-01  1.44e+02     6s
   8  -2.52204190e+05  2.07056327e+07  2.37e+01 9.72e-02  8.71e+01     6s
   9  -1.68474360e+05  1.61333671e+07  9.94e+00 7.43e-02  6.42e+01     6s
  10  -1.12347873e+05  9.16765516e+06  4.00e+00 4.08e-02  3.56e+01     6s
  11  -7.92973756e+04  2.49937642e+06  1.57e+00 1.05e-02  9.78e+00     6s
  12  -3.47571199e+04  7.82214716e+05  4.87e-01 3.42e-03  3.08e+00     7s
  13  -1.44530490e+04  5.05839558e+05  3.32e-01 2.24e-03  1.96e+00     7s
  14   1.08715982e+04  3.60681799e+05  1.94e-01 1.21e-03  1.32e+00     7s
  15   2.70839250e+04  2.63571478e+05  1.45e-01 2.12e-03  8.90e-01     7s
  16   3.47645729e+04  2.00536149e+05  1.25e-01 1.63e-03  6.24e-01     7s
  17   4.68591529e+04  1.73303140e+05  9.69e-02 1.40e-03  4.76e-01     7s
  18   5.59653599e+04  1.43634508e+05  7.47e-02 2.34e-03  3.30e-01     7s
  19   6.25946488e+04  1.32955314e+05  5.90e-02 2.36e-03  2.65e-01     7s
  20   6.76277547e+04  1.22666403e+05  4.72e-02 1.74e-03  2.07e-01     7s
  21   7.10901757e+04  1.13262828e+05  3.95e-02 1.22e-03  1.59e-01     7s
  22   7.68209196e+04  1.08773320e+05  2.75e-02 1.14e-03  1.20e-01     7s
  23   7.98945436e+04  1.03705981e+05  2.15e-02 7.68e-04  8.97e-02     7s
  24   8.10722294e+04  1.00825606e+05  1.93e-02 5.94e-04  7.44e-02     7s
  25   8.31438082e+04  9.93413509e+04  1.55e-02 4.96e-04  6.10e-02     8s
  26   8.48684160e+04  9.78113734e+04  1.24e-02 3.96e-04  4.88e-02     8s
  27   8.58400226e+04  9.62096331e+04  1.07e-02 2.77e-04  3.91e-02     8s
  28   8.68600293e+04  9.51758617e+04  8.84e-03 2.05e-04  3.13e-02     8s
  29   8.75878584e+04  9.44420333e+04  7.59e-03 1.54e-04  2.58e-02     8s
  30   8.89997326e+04  9.40361204e+04  5.21e-03 1.27e-04  1.90e-02     8s
  31   8.91781240e+04  9.38967164e+04  4.91e-03 1.17e-04  1.78e-02     8s
  32   8.98383897e+04  9.35249346e+04  3.77e-03 9.15e-05  1.39e-02     8s
  33   9.05369299e+04  9.30079577e+04  2.58e-03 1.31e-04  9.31e-03     8s
  34   9.12406041e+04  9.27849154e+04  1.41e-03 9.79e-05  5.82e-03     9s
  35   9.13928289e+04  9.24814849e+04  1.16e-03 1.15e-04  4.10e-03     9s
  36   9.16142251e+04  9.24387374e+04  8.24e-04 9.90e-05  3.11e-03     9s
  37   9.17118762e+04  9.23455975e+04  6.64e-04 6.46e-05  2.39e-03     9s
  38   9.17965659e+04  9.22649201e+04  5.36e-04 3.49e-05  1.77e-03     9s
  39   9.19227602e+04  9.22161374e+04  3.43e-04 1.77e-05  1.11e-03     9s
  40   9.20650961e+04  9.21933580e+04  1.36e-04 1.23e-05  4.83e-04     9s
  41   9.20964042e+04  9.21872935e+04  8.98e-05 9.94e-06  3.42e-04     9s
  42   9.21453171e+04  9.21663674e+04  1.93e-05 3.94e-06  7.93e-05     9s
  43   9.21585574e+04  9.21606526e+04  1.85e-06 2.65e-06  7.90e-06     9s
  44   9.21602272e+04  9.21602819e+04  9.16e-08 1.55e-08  2.07e-07    10s
  45   9.21602494e+04  9.21602810e+04  4.79e-06 2.70e-07  1.19e-07    10s
  46   9.21602697e+04  9.21602810e+04  1.71e-06 1.71e-07  4.26e-08    10s
  47   9.21602809e+04  9.21602810e+04  3.39e-08 4.72e-08  5.81e-10    10s

Barrier solved model in 47 iterations and 9.76 seconds (13.80 work units)
Optimal objective 9.21602809e+04


Root crossover log...

  128966 DPushes remaining with DInf 0.0000000e+00                10s
   64394 DPushes remaining with DInf 0.0000000e+00                10s
    1419 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                16s

    6637 PPushes remaining with PInf 3.5461533e-05                16s
       0 PPushes remaining with PInf 0.0000000e+00                17s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.7880889e+02     17s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   68394    9.2160281e+04   0.000000e+00   3.788089e+02     17s
   68517    9.2160281e+04   0.000000e+00   0.000000e+00     17s
   68517    9.2160281e+04   0.000000e+00   0.000000e+00     17s
Concurrent spin time: 3.45s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 9.216028e+04, 68517 iterations, 16.87 seconds (29.82 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 92160.2810    0  187 -222814.01 92160.2810   141%     -   21s
H    0     0                    -205836.9341 92160.2810   145%     -   22s
H    0     0                    -200278.1599 92160.2810   146%     -   23s
H    0     0                    -199540.3146 92160.2810   146%     -   23s
H    0     0                    -198948.2248 92160.2810   146%     -   24s
H    0     0                    -188673.8716 92160.2810   149%     -   24s
H    0     0                    -188362.5508 92160.2810   149%     -   24s
H    0     0                    -177431.3949 92160.2810   152%     -   24s
H    0     0                    -39589.18830 92160.2810   333%     -   24s
H    0     0                    -19977.21350 92160.2810   561%     -   24s
H    0     0                    -1403.504907 92160.2810  6666%     -   24s
H    0     0                    2939.2892836 92160.2810  3035%     -   25s
H    0     0                    3559.2997574 92160.2810  2489%     -   25s
     0     0 85254.3648    0  243 3559.29976 85254.3648  2295%     -   93s
H    0     0                    3714.3607291 85254.2663  2195%     -   93s
H    0     0                    6017.2671585 85254.2663  1317%     -   94s
H    0     0                    15734.688385 85254.2663   442%     -   94s
H    0     0                    16047.943691 85254.2663   431%     -   95s
     0     0 84461.9422    0  252 16047.9437 84461.9422   426%     -  138s
     0     0 84412.4274    0  254 16047.9437 84412.4274   426%     -  158s
     0     0 84376.4474    0  254 16047.9437 84376.4474   426%     -  173s
     0     0 84306.9036    0  279 16047.9437 84306.9036   425%     -  181s
     0     0 84238.4816    0  246 16047.9437 84238.4816   425%     -  193s
     0     0 84227.8526    0  284 16047.9437 84227.8526   425%     -  201s
     0     0 84219.3497    0  291 16047.9437 84219.3497   425%     -  207s
     0     0 84210.5180    0  291 16047.9437 84210.5180   425%     -  212s
     0     0 84202.5806    0  253 16047.9437 84202.5806   425%     -  220s
     0     0 84196.2721    0  255 16047.9437 84196.2721   425%     -  225s
     0     0 84194.6596    0  258 16047.9437 84194.6596   425%     -  227s
     0     0 84192.9401    0  258 16047.9437 84192.9401   425%     -  228s
     0     0 84187.9669    0  261 16047.9437 84187.9669   425%     -  232s
     0     0 84187.0392    0  261 16047.9437 84187.0392   425%     -  234s
     0     0 84186.9303    0  261 16047.9437 84186.9303   425%     -  235s
     0     0 81364.9703    0  303 16047.9437 81364.9703   407%     -  300s
H    0     0                    27120.113382 81364.9146   200%     -  301s
H    0     0                    27241.286526 81364.9146   199%     -  301s
H    0     0                    28262.765201 81364.9146   188%     -  301s
     0     0 80478.3576    0  300 28262.7652 80478.3576   185%     -  340s
     0     0 80355.6014    0  316 28262.7652 80355.6014   184%     -  370s
     0     0 80265.7837    0  356 28262.7652 80265.7837   184%     -  390s
     0     0 80172.0214    0  327 28262.7652 80172.0214   184%     -  406s
     0     0 80124.5067    0  341 28262.7652 80124.5067   183%     -  418s
     0     0 80062.9059    0  330 28262.7652 80062.9059   183%     -  432s
     0     0 80037.8223    0  354 28262.7652 80037.8223   183%     -  443s
     0     0 80023.1524    0  355 28262.7652 80023.1524   183%     -  449s
     0     0 80009.0590    0  354 28262.7652 80009.0590   183%     -  453s
     0     0 79986.6542    0  359 28262.7652 79986.6542   183%     -  460s
     0     0 79931.1029    0  360 28262.7652 79931.1029   183%     -  467s
     0     0 79926.6990    0  363 28262.7652 79926.6990   183%     -  470s
     0     0 79898.6243    0  368 28262.7652 79898.6243   183%     -  478s
     0     0 79895.1164    0  372 28262.7652 79895.1164   183%     -  482s
     0     0 79893.0779    0  366 28262.7652 79893.0779   183%     -  483s
     0     0 79892.2139    0  375 28262.7652 79892.2139   183%     -  484s
     0     0 77695.8668    0  310 28262.7652 77695.8668   175%     -  554s
H    0     0                    40489.983090 77695.6279  91.9%     -  556s
H    0     0                    40862.046745 77695.6279  90.1%     -  556s
H    0     0                    45263.783579 77695.6279  71.7%     -  556s
H    0     0                    45326.912470 77695.6279  71.4%     -  556s
H    0     0                    46593.929379 77695.6279  66.8%     -  556s
     0     0 77316.2959    0  316 46593.9294 77316.2959  65.9%     -  583s
     0     0 77186.3284    0  330 46593.9294 77186.3284  65.7%     -  601s
     0     0 77145.1754    0  325 46593.9294 77145.1754  65.6%     -  610s
     0     0 77123.5163    0  355 46593.9294 77123.5163  65.5%     -  618s
     0     0 77106.9239    0  340 46593.9294 77106.9239  65.5%     -  622s
     0     0 77102.2641    0  343 46593.9294 77102.2641  65.5%     -  626s
     0     0 77095.2716    0  345 46593.9294 77095.2716  65.5%     -  631s
     0     0 77088.9239    0  347 46593.9294 77088.9239  65.4%     -  634s
     0     0 77088.5624    0  350 46593.9294 77088.5624  65.4%     -  635s
     0     0 76241.0859    0  375 46593.9294 76241.0859  63.6%     -  675s
H    0     0                    46706.349932 76240.8202  63.2%     -  676s
H    0     0                    46782.020404 76240.8202  63.0%     -  676s
H    0     0                    48370.159962 76240.8202  57.6%     -  676s
H    0     0                    48536.873408 76240.8202  57.1%     -  677s
H    0     0                    48589.796849 76240.8202  56.9%     -  677s
     0     0 76118.0765    0  432 48589.7968 76118.0765  56.7%     -  687s
     0     0 76094.1240    0  400 48589.7968 76094.1240  56.6%     -  693s
     0     0 76007.8036    0  432 48589.7968 76007.8036  56.4%     -  704s
     0     0 75990.1554    0  434 48589.7968 75990.1554  56.4%     -  708s
     0     0 75983.3509    0  434 48589.7968 75983.3509  56.4%     -  712s
     0     0 75982.1745    0  434 48589.7968 75982.1745  56.4%     -  714s
     0     0 75855.4797    0  347 48589.7968 75855.4797  56.1%     -  732s
     0     0 75798.9679    0  352 48589.7968 75798.9679  56.0%     -  739s
     0     0 75780.6854    0  366 48589.7968 75780.6854  56.0%     -  746s
     0     0 75767.4548    0  364 48589.7968 75767.4548  55.9%     -  750s
     0     0 75761.8186    0  370 48589.7968 75761.8186  55.9%     -  753s
     0     0 75760.8651    0  366 48589.7968 75760.8651  55.9%     -  755s
     0     0 75707.7771    0  375 48589.7968 75707.7771  55.8%     -  764s
     0     0 75703.9575    0  376 48589.7968 75703.9575  55.8%     -  773s
     0     0 75698.4951    0  365 48589.7968 75698.4951  55.8%     -  777s
     0     0 75696.8899    0  413 48589.7968 75696.8899  55.8%     -  779s
     0     0 75679.8395    0  373 48589.7968 75679.8395  55.8%     -  785s
     0     0 75673.4443    0  371 48589.7968 75673.4443  55.7%     -  788s
     0     0 75671.0000    0  369 48589.7968 75671.0000  55.7%     -  789s
     0     0 75664.7590    0  372 48589.7968 75664.7590  55.7%     -  791s
     0     0 75662.9699    0  372 48589.7968 75662.9699  55.7%     -  792s
     0     0 75657.8222    0  377 48589.7968 75657.8222  55.7%     -  795s
H    0     0                    48727.655116 75656.0709  55.3%     -  799s
H    0     0                    49330.950951 75656.0709  53.4%     -  800s
     0     0 75656.0709    0  383 49330.9510 75656.0709  53.4%     -  801s
     0     0 75650.1558    0  372 49330.9510 75650.1558  53.4%     -  806s
     0     0 75642.1681    0  385 49330.9510 75642.1681  53.3%     -  812s
     0     0 75641.9763    0  383 49330.9510 75641.9763  53.3%     -  813s
     0     0 75633.5133    0  373 49330.9510 75633.5133  53.3%     -  820s
     0     0 75633.0550    0  373 49330.9510 75633.0550  53.3%     -  823s
H    0     0                    49346.738684 75633.0550  53.3%     -  982s
H    0     0                    49429.398659 75633.0550  53.0%     -  982s
H    0     0                    49456.582536 75633.0550  52.9%     -  987s
H    0     0                    49576.456888 75633.0550  52.6%     -  987s
H    0     2                    49601.158912 75633.0550  52.5%     - 1005s
     0     2 75633.0550    0  373 49601.1589 75633.0550  52.5%     - 1005s
     1     4 75521.8984    1  368 49601.1589 75632.3326  52.5%  8995 1029s
     3     8 75341.6529    2  359 49601.1589 75512.4030  52.2% 12128 1060s
     7    15 74756.4320    3  368 49601.1589 75340.4690  51.9% 16521 1107s
    14    30 74326.7508    4  405 49601.1589 74948.7853  51.1% 19981 1143s
    29    45 72911.1204    5  357 49601.1589 74326.4451  49.8% 25465 1246s
    44    77 71832.3839    6  336 49601.1589 74326.4451  49.8% 28746 1405s
H   46    77                    50095.819878 74326.4451  48.4% 27972 1405s
H   58    77                    50181.434801 74326.4451  48.1% 25745 1405s
    76   215 71755.0531    7  337 50181.4348 74126.8033  47.7% 24162 1488s
   214   265 71258.5328   10  310 50181.4348 74126.8033  47.7% 12887 1526s
   264   303 70945.9780   10  299 50181.4348 74126.8033  47.7% 12031 1565s
   302   329 71063.5195   11  295 50181.4348 74126.8033  47.7% 11658 1598s
H  314   329                    50184.826397 74126.8033  47.7% 11540 1598s
   328   384 70900.9210   10  325 50184.8264 74126.8033  47.7% 11736 1634s
   383   435 70712.8923   12  290 50184.8264 74126.8033  47.7% 10830 1671s
   434   464 70454.6057   14  287 50184.8264 74126.8033  47.7% 10117 1716s
   463   502 70390.5376   15  281 50184.8264 74126.8033  47.7%  9942 1783s
   501   545 70278.1748   16  268 50184.8264 74126.8033  47.7%  9594 1815s
   544   587 68886.7229   17  277 50184.8264 74126.8033  47.7%  9245 1846s
   586   625 68033.3335   18  263 50184.8264 74126.8033  47.7%  8928 1880s
   624   672 70637.9614   13  279 50184.8264 74126.8033  47.7%  8707 1917s
   671   725 70496.8533   13  274 50184.8264 74126.8033  47.7%  8464 1947s
   724   772 70426.3414   14  266 50184.8264 74126.8033  47.7%  8152 1986s
   771   815 70435.0951   14  277 50184.8264 74126.8033  47.7%  7933 2017s
   814   859 65748.6512   56  237 50184.8264 74126.8033  47.7%  7713 2048s
   858   912 68509.8541   14  249 50184.8264 74126.8033  47.7%  7505 2078s
   911   958 68033.5361   17  286 50184.8264 74126.8033  47.7%  7291 2122s
   957  1016 66854.8269   18  270 50184.8264 74126.8033  47.7%  7178 2161s
  1015  1075 66842.9494   19  273 50184.8264 74126.8033  47.7%  7034 2195s
H 1070  1075                    50320.020931 74126.8033  47.3%  6855 2195s
  1074  1194 66666.3260   20  261 50320.0209 74126.8033  47.3%  6861 2235s
  1197  1280 66193.6409   23  261 50320.0209 74126.8033  47.3%  6525 2291s
  1302  1386 64235.5867   25  250 50320.0209 74126.8033  47.3%  6333 2344s
  1418  1476 63503.6551   28  245 50320.0209 74126.8033  47.3%  6118 2394s
  1538  1573 62642.9784   35  243 50320.0209 74126.8033  47.3%  5934 2447s
  1659  1652 62191.9590   37  217 50320.0209 74126.8033  47.3%  5838 2504s
  1760  1778 55991.2632   40  180 50320.0209 74126.8033  47.3%  5812 2561s
  1902  1934 53920.6634   51  110 50320.0209 74126.8033  47.3%  5649 2618s
  2070  1965 51965.0397   62  125 50320.0209 74126.8033  47.3%  5462 2670s
  2103  1998 51899.7887   63  116 50320.0209 74126.8033  47.3%  5485 2718s
  2138  2063 51894.5443   64  121 50320.0209 74126.8033  47.3%  5505 2763s
  2211  2146 51741.3172   65   98 50320.0209 74126.8033  47.3%  5432 2813s
  2340  2305 infeasible   73      50320.0209 74126.8033  47.3%  5297 2880s
  2542  2438     cutoff   82      50320.0209 74126.8033  47.3%  5101 2935s
  2739  2532 69019.6515    9  322 50320.0209 74126.8033  47.3%  4977 2994s
  2919  2627 68851.8214   10  327 50320.0209 74126.8033  47.3%  4894 3063s
  3086  2770 67432.5783   13  288 50320.0209 74126.8033  47.3%  4880 3151s
H 3265  2836                    50605.654486 74126.8033  46.5%  4829 3215s
H 3324  2830                    50671.789377 73925.0890  45.9%  4834 3215s
H 3373  2828                    50689.283193 73925.0890  45.8%  4817 3215s
  3374  2991 63491.9502   16  282 50689.2832 73925.0890  45.8%  4824 3294s
  3596  2992 57870.7217   71  373 50689.2832 73925.0890  45.8%  4773 3484s
  3598  2993 69071.8659   23  139 50689.2832 73925.0890  45.8%  4771 3513s

Cutting planes:
  Gomory: 24
  Implied bound: 41
  Projected implied bound: 136
  MIR: 1035
  Mixing: 18
  Flow cover: 863
  RLT: 17
  Relax-and-lift: 226

Explored 3598 nodes (17928463 simplex iterations) in 3600.05 seconds (8245.00 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 50689.3 50671.8 50605.7 ... 49429.4

Time limit reached
Best objective 5.068928319289e+04, best bound 7.392508901633e+04, gap 45.8397%
  WARNING: Time limit reached. Using best solution found (gap: 45.84%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.16s
  Master Objective (UB) = 50689.28, θ = 232447.66
  Upper Bound (UB) = 50689.28

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 232447.66
  [DEBUG]   ✓ Scenario 0: θ = 232447.66 ≤ Q = 232447.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 232447.66 ≤ Q = 232447.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 232447.66 ≤ Q = 232447.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 232447.66 ≤ Q = 232447.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 232447.66 ≤ Q = 232447.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 232447.66 ≤ Q = 232447.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 232447.66 ≤ Q = 232447.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 232447.66 ≤ Q = 232447.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 232447.66 ≤ Q = 232447.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 232447.66 ≤ Q = 232447.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 232447.66 ≤ Q = 232447.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 232447.66 ≤ Q = 232447.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 232447.66 ≤ Q = 232447.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 232447.66 ≤ Q = 232447.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 232447.66 ≤ Q = 232447.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 232447.66 ≤ Q = 232447.66 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 16] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x10001c00
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xefffe400
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.322229e+13
Presolve removed 2548 rows and 1839 columns
Presolve time: 0.01s
Presolved: 545 rows, 550 columns, 1538 nonzeros
Found heuristic solution: objective 6969929.6484
Variable types: 374 continuous, 176 integer (176 binary)

Root relaxation: objective -1.640821e+05, 255 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -164082.13    0  122 6969929.65 -164082.13   102%     -    0s
H    0     0                    -127496.5883 -164082.13  28.7%     -    0s
H    0     0                    -129070.0991 -164082.13  27.1%     -    0s
H    0     0                    -130966.7092 -144927.15  10.7%     -    0s
     0     0 -144927.15    0  113 -130966.71 -144927.15  10.7%     -    0s
H    0     0                    -138742.1742 -144887.30  4.43%     -    0s
H    0     0                    -141867.5280 -144887.30  2.13%     -    0s
H    0     0                    -142277.4365 -143925.62  1.16%     -    0s
     0     0 -143925.62    0   99 -142277.44 -143925.62  1.16%     -    0s
H    0     0                    -142379.7583 -143845.09  1.03%     -    0s
     0     0 -143845.09    0   99 -142379.76 -143845.09  1.03%     -    0s
H    0     0                    -142416.0337 -143407.09  0.70%     -    0s
     0     0 -143407.09    0   79 -142416.03 -143407.09  0.70%     -    0s
H    0     0                    -142493.3948 -143403.55  0.64%     -    0s
H    0     0                    -142621.6499 -143340.34  0.50%     -    0s
     0     0 -143340.34    0   58 -142621.65 -143340.34  0.50%     -    0s
     0     0 -143322.74    0   63 -142621.65 -143322.74  0.49%     -    0s
H    0     0                    -142630.8715 -143151.82  0.37%     -    0s
     0     0 -143151.82    0   68 -142630.87 -143151.82  0.37%     -    0s
H    0     0                    -142635.1351 -143150.30  0.36%     -    0s
     0     0 -143144.76    0   64 -142635.14 -143144.76  0.36%     -    0s
     0     0 -143103.33    0   61 -142635.14 -143103.33  0.33%     -    0s
     0     0 -143069.13    0   62 -142635.14 -143069.13  0.30%     -    0s
     0     0 -143060.05    0   67 -142635.14 -143060.05  0.30%     -    0s
     0     0 -143029.18    0   61 -142635.14 -143029.18  0.28%     -    0s
     0     0 -143027.85    0   61 -142635.14 -143027.85  0.28%     -    0s
H    0     0                    -142668.8641 -143027.68  0.25%     -    0s
     0     2 -143013.04    0   60 -142668.86 -143013.04  0.24%     -    0s
H   30    12                    -142675.3446 -142932.27  0.18%  13.5    0s
H   32    12                    -142686.5212 -142932.27  0.17%  13.1    0s
H   33    12                    -142733.0505 -142932.27  0.14%  12.8    0s
H   94    41                    -142762.4203 -142911.85  0.10%   7.4    0s
H  417    59                    -142772.4621 -142854.77  0.06%   4.2    0s
H  458    59                    -142798.4890 -142854.77  0.04%   4.1    0s
H  519    36                    -142809.0074 -142850.11  0.03%   3.9    0s
H  670    15                    -142814.4708 -142838.83  0.02%   3.5    0s

Cutting planes:
  Gomory: 30
  Implied bound: 8
  MIR: 161
  Flow cover: 18
  RLT: 77
  Relax-and-lift: 6
  BQP: 2

Explored 729 nodes (3355 simplex iterations) in 0.14 seconds (0.10 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -142814 -142809 -142798 ... -142635

Optimal solution found (tolerance 1.00e-04)
Best objective -1.428144707637e+05, best bound -1.428222016101e+05, gap 0.0054%
  Subproblem solved in 0.16s
  Worst-case operational profit (Z_SP) = 220981.03
  Scenario: 44 demand increases, 16 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -142814.47
  [DEBUG]   S×d_nominal = 363795.50
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 363795.50 + -142814.47 = 220981.03
  [DEBUG]   Current θ from Master = 232447.66
  [DEBUG]   ⚠️  Z_SP ≤ θ by 11466.63 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 39222.66
  Lower Bound (LB) = 48673.91
  Gap (UB-LB) = 2015.3750, Absolute Gap = 2015.3750, Relative Gap = 0.039759
  Not converged yet (gap = 2015.37 > ε = 200)

  [DEBUG] Adding NEW scenario 16 to Master Problem...
  [DEBUG] New scenario pattern: 44 increases, 16 decreases
    [DEBUG] Scenario 16 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 16 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 16]
    [DEBUG]   - Total constraints in model: 261313
    [DEBUG]   - Total variables in model: 108340
  [DEBUG] Total scenarios in Master: 17
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 17
================================================================================
[Iteration 17] Solving Master Problem...
  Current scenarios in Master: 17
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 261313 rows, 108340 columns and 740854 nonzeros
Model fingerprint: 0x25433528
Variable types: 106081 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 106454 rows and 43214 columns
Presolve time: 3.06s
Presolved: 154859 rows, 65126 columns, 951154 nonzeros
Variable types: 62867 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -285874.8191
Found heuristic solution: objective -222814.0110

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.43s

Barrier statistics:
 Dense cols : 695
 AA' NZ     : 7.642e+06
 Factor NZ  : 1.757e+07 (roughly 230 MB of memory)
 Factor Ops : 4.349e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.93918867e+07  2.75471600e+08  1.55e+05 1.89e+01  9.15e+04     5s
   1  -1.50014210e+07  2.59983884e+08  1.10e+05 7.94e+01  6.42e+04     5s
   2  -6.90037117e+06  2.01495759e+08  4.92e+04 5.62e+00  3.01e+04     5s
   3  -1.76366791e+06  1.63327548e+08  7.00e+03 1.60e+00  4.70e+03     5s
   4  -8.92544355e+05  8.28454846e+07  1.18e+03 4.11e-01  9.28e+02     5s
   5  -6.96591344e+05  7.20663655e+07  6.00e+02 3.46e-01  5.70e+02     5s
   6  -4.65921520e+05  4.63697879e+07  2.26e+02 1.90e-01  2.74e+02     6s
   7  -3.79539288e+05  3.95178589e+07  9.88e+01 1.57e-01  1.86e+02     6s
   8  -3.25963942e+05  2.59419484e+07  3.97e+01 9.65e-02  1.08e+02     6s
   9  -2.12365251e+05  2.06858119e+07  1.19e+01 7.50e-02  7.79e+01     6s
  10  -1.34900359e+05  1.05967358e+07  5.92e+00 3.65e-02  3.91e+01     6s
  11  -9.68756336e+04  5.39861057e+06  2.91e+00 1.78e-02  1.98e+01     6s
  12  -5.40552504e+04  2.34735141e+06  5.95e-01 7.38e-03  8.53e+00     6s
  13  -2.86874927e+04  8.53367350e+05  3.08e-01 2.64e-03  3.13e+00     6s
  14   7.26505496e+02  6.59600298e+05  1.57e-01 1.95e-03  2.34e+00     6s
  15   2.05994803e+04  3.95083359e+05  9.76e-02 1.36e-03  1.33e+00     6s
  16   3.66414431e+04  2.70701916e+05  6.53e-02 1.80e-03  8.30e-01     6s
  17   4.95434553e+04  2.12418722e+05  4.55e-02 1.57e-03  5.77e-01     6s
  18   5.58909312e+04  1.72613080e+05  3.66e-02 1.62e-03  4.14e-01     7s
  19   5.89672145e+04  1.61409935e+05  3.24e-02 1.43e-03  3.63e-01     7s
  20   6.58082367e+04  1.44413610e+05  2.40e-02 1.11e-03  2.79e-01     7s
  21   7.06468415e+04  1.26385566e+05  1.86e-02 8.01e-04  1.98e-01     7s
  22   7.10968169e+04  1.21483704e+05  1.81e-02 7.01e-04  1.79e-01     7s
  23   7.52005504e+04  1.16376170e+05  1.40e-02 5.80e-04  1.46e-01     7s
  24   7.68173660e+04  1.13214818e+05  1.24e-02 5.08e-04  1.29e-01     7s
  25   8.06229977e+04  1.05877167e+05  9.03e-03 3.36e-04  8.95e-02     7s
  26   8.26915337e+04  1.03114557e+05  7.31e-03 2.67e-04  7.24e-02     7s
  27   8.41412657e+04  1.00081022e+05  6.10e-03 2.03e-04  5.65e-02     8s
  28   8.60926636e+04  9.96369727e+04  4.57e-03 1.93e-04  4.80e-02     8s
  29   8.67148251e+04  9.77187992e+04  4.04e-03 1.46e-04  3.90e-02     8s
  30   8.76946380e+04  9.60428124e+04  3.27e-03 1.01e-04  2.96e-02     8s
  31   8.87540457e+04  9.54234536e+04  2.49e-03 8.79e-05  2.36e-02     8s
  32   8.93110406e+04  9.48539096e+04  2.06e-03 7.15e-05  1.96e-02     8s
  33   8.97501327e+04  9.41116641e+04  1.73e-03 5.17e-05  1.55e-02     8s
  34   9.03821330e+04  9.33175672e+04  1.27e-03 6.67e-05  1.04e-02     8s
  35   9.08056746e+04  9.29910404e+04  9.62e-04 4.63e-05  7.75e-03     8s
  36   9.12555422e+04  9.28501954e+04  6.39e-04 3.76e-05  5.65e-03     9s
  37   9.16236053e+04  9.26997601e+04  3.91e-04 2.85e-05  3.81e-03     9s
  38   9.18033993e+04  9.26470335e+04  2.66e-04 2.53e-05  2.99e-03     9s
  39   9.18493980e+04  9.25239285e+04  2.34e-04 1.81e-05  2.39e-03     9s
  40   9.19673872e+04  9.24501175e+04  1.55e-04 1.36e-05  1.71e-03     9s
  41   9.20374895e+04  9.23814739e+04  1.12e-04 9.15e-06  1.22e-03     9s
  42   9.20492287e+04  9.23607404e+04  1.05e-04 7.98e-06  1.10e-03     9s
  43   9.20860224e+04  9.23057016e+04  8.09e-05 4.82e-06  7.79e-04     9s
  44   9.21068443e+04  9.22664475e+04  6.79e-05 2.59e-06  5.66e-04    10s
  45   9.21573666e+04  9.22472929e+04  3.63e-05 1.58e-06  3.19e-04    10s
  46   9.21696721e+04  9.22455519e+04  2.90e-05 1.48e-06  2.69e-04    10s
  47   9.21940287e+04  9.22267396e+04  1.41e-05 3.88e-07  1.16e-04    10s
  48   9.22110326e+04  9.22226939e+04  4.14e-06 1.83e-07  4.13e-05    10s
  49   9.22176830e+04  9.22191398e+04  5.06e-07 9.54e-09  5.17e-06    10s
  50   9.22188427e+04  9.22188453e+04  6.55e-09 1.15e-08  9.16e-09    10s
  51   9.22188450e+04  9.22188451e+04  1.52e-07 2.74e-10  1.61e-10    10s

Barrier solved model in 51 iterations and 10.29 seconds (15.92 work units)
Optimal objective 9.22188450e+04


Root crossover log...

  137012 DPushes remaining with DInf 3.9843796e-09                10s
    1736 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                16s

    3030 PPushes remaining with PInf 1.5026838e-05                16s
       0 PPushes remaining with PInf 0.0000000e+00                16s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.8586301e+00     16s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   64062    9.2218845e+04   0.000000e+00   2.858630e+00     17s
   64077    9.2218845e+04   0.000000e+00   0.000000e+00     17s
   64077    9.2218845e+04   0.000000e+00   0.000000e+00     17s
Concurrent spin time: 3.72s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 9.221885e+04, 64077 iterations, 16.49 seconds (28.19 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 92218.8451    0  188 -222814.01 92218.8451   141%     -   21s
H    0     0                    -171727.4679 92218.8451   154%     -   21s
H    0     0                    -171638.5138 92218.8451   154%     -   21s
H    0     0                    -140844.0901 92218.8451   165%     -   21s
H    0     0                    -129161.4223 92218.8451   171%     -   21s
H    0     0                    -128703.7462 92218.8451   172%     -   22s
H    0     0                    -128459.9643 92218.8451   172%     -   22s
H    0     0                    -126963.8249 92218.8451   173%     -   22s
H    0     0                    -85093.79599 92218.8451   208%     -   22s
H    0     0                    -84895.67700 92218.8451   209%     -   22s
H    0     0                    12864.475714 92218.8451   617%     -   22s
H    0     0                    24824.522417 92218.8451   271%     -   23s
H    0     0                    39749.965687 92218.8451   132%     -   24s
     0     0 84977.1905    0  250 39749.9657 84977.1905   114%     -   96s
H    0     0                    41016.056936 84976.9709   107%     -   98s
H    0     0                    41601.927491 84976.9709   104%     -   98s
H    0     0                    41883.080920 84976.9709   103%     -   98s
H    0     0                    42284.956211 84976.9709   101%     -   98s
H    0     0                    43775.225597 84976.9709  94.1%     -   98s
     0     0 84452.9694    0  243 43775.2256 84452.9694  92.9%     -  143s
     0     0 84347.6248    0  255 43775.2256 84347.6248  92.7%     -  165s
     0     0 84291.8515    0  259 43775.2256 84291.8515  92.6%     -  185s
     0     0 84220.6813    0  264 43775.2256 84220.6813  92.4%     -  201s
     0     0 84140.9340    0  269 43775.2256 84140.9340  92.2%     -  215s
     0     0 84107.1114    0  260 43775.2256 84107.1114  92.1%     -  227s
     0     0 83981.7686    0  267 43775.2256 83981.7686  91.8%     -  242s
     0     0 83979.9907    0  262 43775.2256 83979.9907  91.8%     -  245s
     0     0 83975.4461    0  267 43775.2256 83975.4461  91.8%     -  250s
     0     0 83975.1170    0  267 43775.2256 83975.1170  91.8%     -  252s
     0     0 80795.5287    0  312 43775.2256 80795.5287  84.6%     -  325s
     0     0 80167.5351    0  327 43775.2256 80167.5351  83.1%     -  374s
     0     0 79902.2021    0  314 43775.2256 79902.2021  82.5%     -  402s
     0     0 79738.6695    0  334 43775.2256 79738.6695  82.2%     -  428s
     0     0 79672.1346    0  330 43775.2256 79672.1346  82.0%     -  445s
     0     0 79644.8249    0  338 43775.2256 79644.8249  81.9%     -  459s
     0     0 79619.7673    0  336 43775.2256 79619.7673  81.9%     -  467s
     0     0 79581.5377    0  347 43775.2256 79581.5377  81.8%     -  480s
     0     0 79559.6888    0  339 43775.2256 79559.6888  81.7%     -  488s
     0     0 79556.4557    0  345 43775.2256 79556.4557  81.7%     -  494s
     0     0 79554.5442    0  339 43775.2256 79554.5442  81.7%     -  500s
     0     0 79553.7941    0  345 43775.2256 79553.7941  81.7%     -  501s
     0     0 77668.4762    0  323 43775.2256 77668.4762  77.4%     -  585s
H    0     0                    44050.103489 77668.3190  76.3%     -  586s
     0     0 77399.1690    0  361 44050.1035 77399.1690  75.7%     -  625s
     0     0 77347.0026    0  376 44050.1035 77347.0026  75.6%     -  637s
     0     0 77317.4635    0  378 44050.1035 77317.4635  75.5%     -  646s
     0     0 77303.9783    0  376 44050.1035 77303.9783  75.5%     -  654s
     0     0 77293.7424    0  380 44050.1035 77293.7424  75.5%     -  659s
     0     0 77284.7993    0  376 44050.1035 77284.7993  75.4%     -  663s
     0     0 77269.4078    0  375 44050.1035 77269.4078  75.4%     -  670s
     0     0 77240.0717    0  367 44050.1035 77240.0717  75.3%     -  679s
     0     0 77210.7649    0  360 44050.1035 77210.7649  75.3%     -  689s
     0     0 77206.8575    0  356 44050.1035 77206.8575  75.3%     -  691s
     0     0 77177.1951    0  365 44050.1035 77177.1951  75.2%     -  699s
     0     0 77175.1394    0  358 44050.1035 77175.1394  75.2%     -  702s
     0     0 77174.5074    0  360 44050.1035 77174.5074  75.2%     -  703s
     0     0 76547.8286    0  381 44050.1035 76547.8286  73.8%     -  759s
     0     0 76397.9857    0  362 44050.1035 76397.9857  73.4%     -  776s
     0     0 76320.9824    0  364 44050.1035 76320.9824  73.3%     -  789s
     0     0 76279.1095    0  362 44050.1035 76279.1095  73.2%     -  798s
     0     0 76248.3636    0  401 44050.1035 76248.3636  73.1%     -  806s
     0     0 76241.4450    0  377 44050.1035 76241.4450  73.1%     -  810s
     0     0 76234.3793    0  416 44050.1035 76234.3793  73.1%     -  813s
     0     0 76230.9657    0  418 44050.1035 76230.9657  73.1%     -  815s
     0     0 76221.4484    0  379 44050.1035 76221.4484  73.0%     -  820s
     0     0 76218.4111    0  377 44050.1035 76218.4111  73.0%     -  822s
     0     0 76215.8884    0  388 44050.1035 76215.8884  73.0%     -  825s
     0     0 76215.3232    0  389 44050.1035 76215.3232  73.0%     -  828s
     0     0 76082.5330    0  372 44050.1035 76082.5330  72.7%     -  846s
H    0     0                    44052.954491 76082.4138  72.7%     -  847s
     0     0 76034.3283    0  405 44052.9545 76034.3283  72.6%     -  857s
     0     0 75969.6655    0  404 44052.9545 75969.6655  72.5%     -  866s
     0     0 75960.1682    0  380 44052.9545 75960.1682  72.4%     -  870s
     0     0 75957.3342    0  408 44052.9545 75957.3342  72.4%     -  873s
     0     0 75955.8453    0  416 44052.9545 75955.8453  72.4%     -  874s
     0     0 75896.1259    0  375 44052.9545 75896.1259  72.3%     -  887s
     0     0 75872.5776    0  368 44052.9545 75872.5776  72.2%     -  899s
     0     0 75860.4580    0  366 44052.9545 75860.4580  72.2%     -  902s
     0     0 75855.0194    0  368 44052.9545 75855.0194  72.2%     -  906s
     0     0 75853.9924    0  370 44052.9545 75853.9924  72.2%     -  908s
     0     0 75799.2962    0  376 44052.9545 75799.2962  72.1%     -  921s
     0     0 75786.6435    0  381 44052.9545 75786.6435  72.0%     -  929s
     0     0 75784.4499    0  379 44052.9545 75784.4499  72.0%     -  931s
     0     0 75773.1226    0  419 44052.9545 75773.1226  72.0%     -  937s
H    0     0                    45138.613169 75773.0282  67.9%     -  956s
H    0     0                    46535.054257 75773.0282  62.8%     -  956s
     0     0 75771.6539    0  428 46535.0543 75771.6539  62.8%     -  958s
     0     0 75763.4760    0  390 46535.0543 75763.4760  62.8%     -  964s
H    0     0                    47587.504858 75762.0620  59.2%     -  965s
     0     0 75762.0620    0  382 47587.5049 75762.0620  59.2%     -  968s
     0     0 75757.8479    0  379 47587.5049 75757.8479  59.2%     -  972s
     0     0 75756.9238    0  383 47587.5049 75756.9238  59.2%     -  977s
     0     0 75753.4313    0  380 47587.5049 75753.4313  59.2%     -  981s
     0     0 75753.2792    0  380 47587.5049 75753.2792  59.2%     -  984s
H    0     0                    48011.540871 75752.4522  57.8%     - 1104s
H    0     0                    48368.936039 75752.4522  56.6%     - 1104s
H    0     0                    48371.787042 75752.4522  56.6%     - 1104s
H    0     0                    48413.476286 75752.4522  56.5%     - 1104s
     0     2 75752.4522    0  380 48413.4763 75752.4522  56.5%     - 1202s
     1     3 75464.5168    1  411 48413.4763 75752.4522  56.5% 11539 1218s
     2     4 75686.8705    1  370 48413.4763 75686.8705  56.3%  8234 1231s
     3     5 74517.7434    2  359 48413.4763 75686.7597  56.3% 10074 1250s
     4     9 74017.6398    3  353 48413.4763 75686.7597  56.3% 11614 1277s
     8    16 73673.5432    4  346 48413.4763 75686.7597  56.3% 10504 1306s
    15    31 73610.5702    5  343 48413.4763 75276.9969  55.5% 11643 1343s
    30    46 73822.8110    4  348 48413.4763 74783.7044  54.5% 17179 1432s
    45    75 72848.2384    6  318 48413.4763 74783.7044  54.5% 17517 1603s
H   68    75                    48422.567655 74783.7044  54.4% 16867 1603s
    74   198 72640.2952    7  310 48422.5677 74783.7044  54.4% 17669 1675s
   197   245 72325.9374   10  376 48422.5677 74783.7044  54.4% 11206 1721s
H  224   245                    48519.233709 74783.7044  54.1% 10527 1721s
H  229   245                    48737.079978 74783.7044  53.4% 10398 1721s
   244   294 71367.8357   12  289 48737.0800 74783.7044  53.4% 10271 1755s
   293   324 72055.3009   12  362 48737.0800 74783.7044  53.4% 10072 1799s
   323   356 71913.3533   13  367 48737.0800 74783.7044  53.4%  9845 1850s
   355   390 71776.3028   14  380 48737.0800 74783.7044  53.4%  9560 1889s
   389   420 71034.9436   15  285 48737.0800 74783.7044  53.4%  9327 1922s
   419   450 71492.6333   15  376 48737.0800 74783.7044  53.4%  9191 1959s
   449   476 71477.6638   16  367 48737.0800 74783.7044  53.4%  9102 2005s
   475   508 71473.7712   17  367 48737.0800 74783.7044  53.4%  9003 2041s
   507   536 71405.7789   18  399 48737.0800 74783.7044  53.4%  9325 2073s
   535   566 70335.5882   19  263 48737.0800 74783.7044  53.4%  9271 2104s
   565   597 71013.8389   19  361 48737.0800 74783.7044  53.4%  9439 2167s
H  567   597                    48739.930981 74783.7044  53.4%  9431 2167s
   596   669 70815.1023   20  371 48739.9310 74783.7044  53.4%  9460 2206s
   668   735 70041.5587   21  261 48739.9310 74783.7044  53.4%  9416 2244s
   734   799 69743.4140   23  265 48739.9310 74783.7044  53.4%  9399 2276s
   798   833 69268.3048   25  248 48739.9310 74783.7044  53.4%  9446 2303s
   832   871 67708.3645   26  242 48739.9310 74783.7044  53.4%  9526 2342s
   870   917 67682.0624   27  246 48739.9310 74783.7044  53.4%  9817 2374s
   916   984 67636.7370   28  241 48739.9310 74783.7044  53.4%  9605 2407s
   985  1066 67627.6431   29  239 48739.9310 74783.7044  53.4%  9214 2444s
  1069  1158 66371.5843   30  248 48739.9310 74783.7044  53.4%  8802 2483s
  1165  1277 66028.5721   32  221 48739.9310 74783.7044  53.4%  8368 2522s
  1284  1401 65205.1115   36  217 48739.9310 74783.7044  53.4%  7898 2563s
  1420  1487 64943.1930   41  225 48739.9310 74783.7044  53.4%  7429 2613s
  1528  1594 64036.9964   44  285 48739.9310 74783.7044  53.4%  7191 2653s
  1656  1639 63815.9230   46  274 48739.9310 74783.7044  53.4%  6919 2692s
  1727  1712 63769.9461   47  210 48739.9310 74783.7044  53.4%  6833 2735s
  1826  1850 61788.9891   48  219 48739.9310 74783.7044  53.4%  6707 2779s
  1982  2028 61168.5358   50  181 48739.9310 74783.7044  53.4%  6450 2828s
  2172  2214 60934.3475   53  242 48739.9310 74783.7044  53.4%  6133 2873s
  2406  2301 60530.9643   62  182 48739.9310 74783.7044  53.4%  5774 2923s
  2625  2415 52722.2805   71   42 48739.9310 74783.7044  53.4%  5565 2973s
  2839  2503 51930.7493   88   45 48739.9310 74783.7044  53.4%  5340 3034s
  3006  2564 50039.9985  106   27 48739.9310 74767.4482  53.4%  5243 3103s
  3135  2678 71295.0042   10  318 48739.9310 74767.4482  53.4%  5208 3168s
  3299  2797 67608.3780   11  267 48739.9310 74767.4482  53.4%  5144 3255s
  3475  2895 67166.0357   12  298 48739.9310 74767.4482  53.4%  5084 3326s
  3643  2970 66920.9825   13  308 48739.9310 74767.4482  53.4%  5054 3399s

Cutting planes:
  Learned: 1
  Gomory: 8
  Implied bound: 180
  MIR: 3842
  Flow cover: 3041
  RLT: 44
  Relax-and-lift: 556

Explored 3742 nodes (19600786 simplex iterations) in 3600.03 seconds (8104.72 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 48739.9 48737.1 48519.2 ... 46535.1

Time limit reached
Best objective 4.873993098068e+04, best bound 7.476744820877e+04, gap 53.4008%
  WARNING: Time limit reached. Using best solution found (gap: 53.40%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = 48739.93, θ = 246944.66
  Upper Bound (UB) = 48739.93

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 246944.66
  [DEBUG]   ✓ Scenario 0: θ = 246944.66 ≤ Q = 246944.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 246944.66 ≤ Q = 246944.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 246944.66 ≤ Q = 246944.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 246944.66 ≤ Q = 246944.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 246944.66 ≤ Q = 246944.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 246944.66 ≤ Q = 246944.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 246944.66 ≤ Q = 246944.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 246944.66 ≤ Q = 246944.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 246944.66 ≤ Q = 246944.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 246944.66 ≤ Q = 246944.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 246944.66 ≤ Q = 246944.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 246944.66 ≤ Q = 246944.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 246944.66 ≤ Q = 246944.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 246944.66 ≤ Q = 246944.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 246944.66 ≤ Q = 246944.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 246944.66 ≤ Q = 246944.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 246944.66 ≤ Q = 246944.66 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 17] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x76be4255
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x76be4255
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-01, 2e+02]
Found heuristic solution: objective 1.311171e+13
Presolve removed 2550 rows and 1848 columns
Presolve time: 0.00s
Presolved: 543 rows, 541 columns, 1530 nonzeros
Found heuristic solution: objective 6362533.5626
Variable types: 365 continuous, 176 integer (176 binary)

Root relaxation: objective -1.751564e+05, 259 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -175156.41    0  123 6362533.56 -175156.41   103%     -    0s
H    0     0                    -138412.1421 -175156.41  26.5%     -    0s
H    0     0                    -140225.8989 -175156.41  24.9%     -    0s
     0     0 -156057.49    0   67 -140225.90 -156057.49  11.3%     -    0s
H    0     0                    -154376.8522 -155937.27  1.01%     -    0s
H    0     0                    -154476.1439 -155254.24  0.50%     -    0s
     0     0 -155254.24    0   63 -154476.14 -155254.24  0.50%     -    0s
H    0     0                    -154490.5643 -155228.25  0.48%     -    0s
     0     0 -155145.07    0   50 -154490.56 -155145.07  0.42%     -    0s
     0     0 -155059.63    0   58 -154490.56 -155059.63  0.37%     -    0s
     0     0 -154820.24    0   25 -154490.56 -154820.24  0.21%     -    0s
     0     0 -154812.99    0   23 -154490.56 -154812.99  0.21%     -    0s
     0     0 -154792.08    0   29 -154490.56 -154792.08  0.20%     -    0s
     0     0 -154696.44    0   19 -154490.56 -154696.44  0.13%     -    0s
     0     0 -154674.08    0   19 -154490.56 -154674.08  0.12%     -    0s
     0     0 -154661.65    0   16 -154490.56 -154661.65  0.11%     -    0s
     0     0 -154661.65    0   30 -154490.56 -154661.65  0.11%     -    0s
     0     0 -154559.10    0    9 -154490.56 -154559.10  0.04%     -    0s
     0     0 -154558.69    0   10 -154490.56 -154558.69  0.04%     -    0s
H    0     0                    -154497.8699 -154556.69  0.04%     -    0s
H    0     0                    -154520.4906 -154556.69  0.02%     -    0s
     0     0 -154552.16    0    9 -154520.49 -154552.16  0.02%     -    0s
     0     0 -154552.00    0    9 -154520.49 -154552.00  0.02%     -    0s
     0     0 -154551.72    0    9 -154520.49 -154551.72  0.02%     -    0s
     0     0 -154547.30    0    3 -154520.49 -154547.30  0.02%     -    0s
     0     0 -154547.30    0    9 -154520.49 -154547.30  0.02%     -    0s
H    0     0                    -154532.5344 -154547.30  0.01%     -    0s

Explored 1 nodes (845 simplex iterations) in 0.08 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -154533 -154520 -154498 ... 1.31117e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.545325343765e+05, best bound -1.545473025816e+05, gap 0.0096%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 234608.73
  Scenario: 26 demand increases, 34 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -154532.53
  [DEBUG]   S×d_nominal = 389141.26
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 389141.26 + -154532.53 = 234608.73
  [DEBUG]   Current θ from Master = 246944.66
  [DEBUG]   ⚠️  Z_SP ≤ θ by 12335.93 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 36404.00
  Lower Bound (LB) = 48673.91
  Gap (UB-LB) = 66.0227, Absolute Gap = 66.0227, Relative Gap = 0.001355
  *** CONVERGED (gap within tolerance) ***

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 17
Total Time: 48956.76s
Converged: True
Final Lower Bound: 48673.9082
Final Upper Bound: 48739.9310
Final Gap: 66.022744
Number of Critical Scenarios: 17
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [0, 1] (2/3)
Product 1 Plants: [1] (1/3)
Product 2 Plants: [1] (1/3)
Total Plant Openings: 4
DCs Opened: [1, 5, 6, 7, 8, 9] (6/10)
Active Routes (Plant→DC): 16
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 0 customers  Mode 1: 0 customers  Mode 2: 50 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 17
Start Time: 2026-01-04 12:30:56
End Time: 2026-01-05 02:06:53
Total Time: 48956.76s
Optimal Value: 48673.91
Lower Bound: 48673.91
Upper Bound: 48739.93
Gap: 66.022744
Plants Opened: {0: [0, 1], 1: [1], 2: [1]} (4 plants)
DCs Opened: [1, 5, 6, 7, 8, 9] (6 DCs)
================================================================================

Results saved to: result/DH_single_full_seed20_HD_gamma20_20260105_020654.csv

Total Execution Time: 48957.40 seconds
End Time: 2026-01-05 02:06:54

All tasks completed successfully!

