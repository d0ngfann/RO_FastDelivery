
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 25
DI Scenario: HD
Start Time: 2026-01-04 12:31:03
================================================================================
Loading data from data/DH_data_full_seed25.pkl...

Applying DI scenario: HD
DI values:
  Product 0: ['1.000', '1.421', '2.021'] (k=0.867)
  Product 1: ['1.000', '1.424', '2.028'] (k=0.872)
  Product 2: ['1.000', '1.372', '1.882'] (k=0.780)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=941, max=1710
  DC capacity (MC): min=405, max=850

Demand Structure (s_rk matrix):
  Total customer-product pairs: 76/150 (49.3% sparse)
  Average products per customer: 1.52

Demand (only non-zero entries):
  Nominal (μ): min=8.28, max=34.84, count=76
  Deviation (μ̂): min=4.00, max=9.95

Costs:
  Plant fixed cost: min=5742, max=9721
  DC fixed cost: min=3176, max=5734
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.421', '2.021'] (k=0.867)
    Product 1: ['1.000', '1.424', '2.028'] (k=0.872)
    Product 2: ['1.000', '1.372', '1.882'] (k=0.780)
  MD:
    Product 0: ['1.000', '1.220', '1.489'] (k=0.491)
    Product 1: ['1.000', '1.185', '1.405'] (k=0.419)
    Product 2: ['1.000', '1.249', '1.560'] (k=0.549)
  LD:
    Product 0: ['1.000', '1.013', '1.025'] (k=0.031)
    Product 1: ['1.000', '1.042', '1.086'] (k=0.102)
    Product 2: ['1.000', '1.116', '1.245'] (k=0.270)
  Mixed:
    Product 0: ['1.000', '1.421', '2.021'] (k=0.867)
    Product 1: ['1.000', '1.185', '1.405'] (k=0.419)
    Product 2: ['1.000', '1.116', '1.245'] (k=0.270)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48738 nonzeros
Model fingerprint: 0x31641912
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 12035 rows and 3035 columns
Presolve time: 0.12s
Presolved: 4638 rows, 5465 columns, 32308 nonzeros
Variable types: 3206 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -267836.0523
Found heuristic solution: objective -182931.6033

Root relaxation: objective 1.319693e+05, 5374 iterations, 0.42 seconds (0.47 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 131969.348    0  668 -182931.60 131969.348   172%     -    0s
H    0     0                    -180863.0308 131969.348   173%     -    0s
H    0     0                    -173758.0596 124202.992   171%     -    1s
     0     0 124202.992    0  774 -173758.06 124202.992   171%     -    1s
     0     0 123928.625    0  764 -173758.06 123928.625   171%     -    1s
     0     0 123904.716    0  770 -173758.06 123904.716   171%     -    2s
     0     0 123888.734    0  773 -173758.06 123888.734   171%     -    2s
     0     0 123888.290    0  770 -173758.06 123888.290   171%     -    2s
     0     0 118742.208    0  920 -173758.06 118742.208   168%     -    3s
     0     0 118377.698    0  917 -173758.06 118377.698   168%     -    3s
     0     0 118217.336    0  923 -173758.06 118217.336   168%     -    3s
     0     0 118189.913    0  920 -173758.06 118189.913   168%     -    3s
     0     0 118184.313    0  924 -173758.06 118184.313   168%     -    3s
     0     0 118184.140    0  929 -173758.06 118184.140   168%     -    3s
H    0     0                    -167597.1723 114064.039   168%     -    5s
     0     0 114064.039    0  976 -167597.17 114064.039   168%     -    5s
     0     0 113706.783    0  959 -167597.17 113706.783   168%     -    6s
     0     0 113658.551    0  952 -167597.17 113658.551   168%     -    6s
     0     0 113644.461    0  962 -167597.17 113644.461   168%     -    6s
     0     0 113643.927    0  966 -167597.17 113643.927   168%     -    6s
H    0     0                    -93792.77955 108669.116   216%     -    9s
H    0     0                    -87832.11468 108669.116   224%     -    9s
H    0     0                    -73710.38078 108669.116   247%     -    9s
H    0     0                    -67899.17725 108669.116   260%     -    9s
H    0     0                    34666.348970 108669.116   213%     -    9s
     0     0 108669.116    0  838 34666.3490 108669.116   213%     -    9s
     0     0 108376.778    0  861 34666.3490 108376.778   213%     -    9s
     0     0 108308.214    0  886 34666.3490 108308.214   212%     -   10s
     0     0 108297.042    0  880 34666.3490 108297.042   212%     -   10s
     0     0 91112.6570    0  574 34666.3490 91112.6570   163%     -   12s
H    0     0                    34896.097207 89217.7042   156%     -   12s
H    0     0                    34969.529519 89217.7042   155%     -   12s
H    0     0                    35432.505484 89217.7042   152%     -   12s
H    0     0                    35456.455352 89217.7042   152%     -   12s
H    0     0                    35700.172865 89217.7042   150%     -   12s
H    0     0                    35843.642237 89217.7042   149%     -   12s
H    0     0                    36234.846260 89217.7042   146%     -   12s
H    0     0                    36378.624942 89217.7042   145%     -   12s
H    0     0                    36390.649586 89217.7042   145%     -   12s
H    0     0                    36446.301260 89217.7042   145%     -   12s
H    0     0                    36579.629949 89217.7042   144%     -   12s
H    0     0                    36709.022804 89217.7042   143%     -   12s
     0     0 89217.7042    0  576 36709.0228 89217.7042   143%     -   12s
H    0     0                    36765.572637 88880.8701   142%     -   13s
H    0     0                    37082.264005 88880.8701   140%     -   13s
     0     0 88880.8701    0  625 37082.2640 88880.8701   140%     -   13s
     0     0 88796.7404    0  677 37082.2640 88796.7404   139%     -   13s
     0     0 88775.5626    0  689 37082.2640 88775.5626   139%     -   13s
     0     0 88769.4051    0  657 37082.2640 88769.4051   139%     -   13s
     0     0 82307.5866    0  645 37082.2640 82307.5866   122%     -   14s
     0     0 81655.0663    0  600 37082.2640 81655.0663   120%     -   15s
     0     0 81375.8049    0  580 37082.2640 81375.8049   119%     -   15s
     0     0 81285.6961    0  602 37082.2640 81285.6961   119%     -   16s
     0     0 81278.7151    0  607 37082.2640 81278.7151   119%     -   16s
H    0     0                    38134.551614 79967.1112   110%     -   17s
     0     0 79967.1112    0  485 38134.5516 79967.1112   110%     -   17s
H    0     0                    38136.209371 79585.2894   109%     -   17s
     0     0 79585.2894    0  614 38136.2094 79585.2894   109%     -   17s
H    0     0                    39838.190848 79453.3371  99.4%     -   17s
H    0     0                    39925.746850 79453.3371  99.0%     -   17s
     0     0 79453.3371    0  645 39925.7468 79453.3371  99.0%     -   17s
H    0     0                    40021.808210 79410.8682  98.4%     -   18s
     0     0 79410.8682    0  684 40021.8082 79410.8682  98.4%     -   18s
     0     0 79402.9156    0  708 40021.8082 79402.9156  98.4%     -   18s
H    0     0                    40070.940775 78349.3962  95.5%     -   19s
H    0     0                    41543.554325 78349.3962  88.6%     -   19s
     0     0 78349.3962    0  634 41543.5543 78349.3962  88.6%     -   19s
H    0     0                    41911.288000 78089.1432  86.3%     -   19s
     0     0 78089.1432    0  695 41911.2880 78089.1432  86.3%     -   19s
H    0     0                    41913.443930 78010.2668  86.1%     -   20s
     0     0 78010.2668    0  686 41913.4439 78010.2668  86.1%     -   20s
H    0     0                    41993.932272 77979.3541  85.7%     -   20s
H    0     0                    42081.454937 77979.3541  85.3%     -   20s
H    0     0                    42199.974093 77979.3541  84.8%     -   20s
     0     0 77979.3541    0  706 42199.9741 77979.3541  84.8%     -   20s
     0     0 77404.5848    0  637 42199.9741 77404.5848  83.4%     -   21s
     0     0 77161.8512    0  723 42199.9741 77161.8512  82.8%     -   21s
     0     0 77080.5865    0  735 42199.9741 77080.5865  82.7%     -   22s
     0     0 77054.7469    0  728 42199.9741 77054.7469  82.6%     -   22s
H    0     0                    42370.900099 76555.1522  80.7%     -   23s
     0     0 76555.1522    0  681 42370.9001 76555.1522  80.7%     -   23s
     0     0 76414.7419    0  720 42370.9001 76414.7419  80.3%     -   24s
     0     0 76391.9336    0  748 42370.9001 76391.9336  80.3%     -   24s
     0     0 76138.2756    0  572 42370.9001 76138.2756  79.7%     -   25s
     0     0 76032.9494    0  701 42370.9001 76032.9494  79.4%     -   25s
     0     0 75968.9102    0  705 42370.9001 75968.9102  79.3%     -   26s
     0     0 75956.0978    0  717 42370.9001 75956.0978  79.3%     -   26s
     0     0 75787.1578    0  673 42370.9001 75787.1578  78.9%     -   27s
     0     0 75786.5698    0  673 42370.9001 75786.5698  78.9%     -   27s
     0     2 75786.1935    0  673 42370.9001 75786.1935  78.9%     -   29s
     1     4 75422.1485    1  558 42370.9001 75786.1935  78.9%  1375   30s
    15    32 73927.7501    4  703 42370.9001 75267.6639  77.6%  2695   35s
H   32    64                    42406.946904 75178.4374  77.3%  2493   37s
H   37    64                    42419.744134 75177.6924  77.2%  2318   37s
H   44    64                    43234.479830 75177.6924  73.9%  2076   37s
H   95   222                    44160.855994 75096.8918  70.1%  1961   40s
H  112   222                    44198.769970 75096.8918  69.9%  1758   40s
H  136   222                    49793.290924 75096.8918  50.8%  1558   40s
H  145   222                    50655.350670 75096.8918  48.3%  1484   40s
   341   381 70879.4427    9  619 50655.3507 75096.8918  48.3%  1002   46s
H  347   381                    50722.680531 75096.8918  48.1%  1000   46s
   561   637 70265.8607   11  471 50722.6805 75096.8918  48.1%   875   50s
H  710   728                    52787.496614 75096.8918  42.3%   819   52s
  1126  1186 67345.1153   18  448 52787.4966 74982.1845  42.0%   627   56s
  1796  1790 65691.9271   24  413 52787.4966 74982.1845  42.0%   519   61s
  2317  2247 57161.5372   32  312 52787.4966 73978.6224  40.1%   481   65s
  2963  2731 65243.4334    8  561 52787.4966 73553.5072  39.3%   452   71s
H 3503  3000                    52796.078436 73553.5072  39.3%   451   85s
  3504  3001 61562.5148   31  673 52796.0784 73553.5072  39.3%   451   94s
  3508  3004 61944.2202   50  267 52796.0784 73553.5072  39.3%   450   95s
  3542  3026 64237.2664   25  441 52796.0784 69674.1013  32.0%   446  100s
  3630  3124 65865.9094   20  381 52796.0784 67535.1366  27.9%   454  105s
H 3798  3024                    53222.028759 66407.0313  24.8%   452  106s
H 4058  2937                    54121.276658 66407.0313  22.7%   440  108s
H 4060  2800                    54575.643598 66407.0313  21.7%   440  108s
H 4061  2668                    54649.646385 66407.0313  21.5%   440  108s
H 4086  2537                    55173.515975 66391.5068  20.3%   439  108s
H 4180  2407                    55308.138872 65430.6565  18.3%   434  108s
H 4193  2290                    55406.914262 65430.6565  18.1%   434  108s
H 4202  2181                    55446.382965 65430.6565  18.0%   433  108s
  4409  2209 56423.1845   29  344 55446.3830 65430.6565  18.0%   426  110s
H 4415  2106                    55471.080378 65430.6565  18.0%   426  110s
H 4416  2010                    55511.304014 65430.6565  17.9%   426  110s
H 4443  1910                    55751.107361 64653.4596  16.0%   424  110s
H 4794  1794                    55767.676197 64653.0357  15.9%   411  112s
  5504  1691 61582.5076   29  163 55767.6762 63524.5092  13.9%   383  115s
H 5528  1601                    55803.628626 63524.5092  13.8%   382  115s
H 5946  1439                    55885.718843 62347.6933  11.6%   368  116s
  7248  1011 56749.2329   26  163 55885.7188 60600.2961  8.44%   337  120s
*15727  2445              79    55885.821394 56122.2990  0.42%   187  124s
H17105  2437                    55889.849377 56104.8638  0.38%   173  124s
 17717  2604     cutoff   73      55889.8494 56073.8329  0.33%   168  125s
H19566  2575                    55899.541909 56061.2361  0.29%   154  125s

Cutting planes:
  Gomory: 1
  Implied bound: 6
  Projected implied bound: 8
  MIR: 372
  Mixing: 1
  Flow cover: 411
  RLT: 8
  Relax-and-lift: 45

Explored 28003 nodes (3251265 simplex iterations) in 127.48 seconds (170.86 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 55899.5 55889.8 55885.8 ... 55446.4

Optimal solution found (tolerance 1.00e-04)
Best objective 5.589954190914e+04, best bound 5.589954190914e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 127.49s
  Master Objective (UB) = 55899.54, θ = 205373.05
  Upper Bound (UB) = 55899.54

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 205373.05
  [DEBUG]   ✓ Scenario 0: θ = 205373.05 ≤ Q = 205373.05 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x7bf6b7e6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x8409481a
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.347523e+13
Presolve removed 2631 rows and 1922 columns
Presolve time: 0.01s
Presolved: 462 rows, 467 columns, 1303 nonzeros
Found heuristic solution: objective 6261970.0704
Variable types: 316 continuous, 151 integer (151 binary)
Found heuristic solution: objective 6261640.7261

Root relaxation: objective -1.478597e+05, 228 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -147859.69    0  123 6261640.73 -147859.69   102%     -    0s
H    0     0                    -96556.59872 -147859.69  53.1%     -    0s
H    0     0                    -96885.94308 -147859.69  52.6%     -    0s
H    0     0                    -97147.19216 -147859.69  52.2%     -    0s
H    0     0                    -97476.53651 -147859.69  51.7%     -    0s
H    0     0                    -97774.50084 -147593.31  51.0%     -    0s
H    0     0                    -98558.38470 -119583.64  21.3%     -    0s
H    0     0                    -110758.9634 -119583.64  7.97%     -    0s
H    0     0                    -119583.6385 -119583.64  0.00%     -    0s
     0     0          -    0      -119583.64 -119583.64  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 198

Explored 1 nodes (359 simplex iterations) in 0.02 seconds (0.01 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -119584 -110759 -98558.4 ... 6.26197e+06
No other solutions better than -119584

Optimal solution found (tolerance 1.00e-04)
Best objective -1.195836384589e+05, best bound -1.195836384589e+05, gap 0.0000%
  Subproblem solved in 0.05s
  Worst-case operational profit (Z_SP) = 173387.33
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -119583.64
  [DEBUG]   S×d_nominal = 292970.97
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 292970.97 + -119583.64 = 173387.33
  [DEBUG]   Current θ from Master = 205373.05
  [DEBUG]   ⚠️  Z_SP ≤ θ by 31985.72 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 23913.83
  Lower Bound (LB) = 23913.83
  Gap (UB-LB) = 31985.7160, Absolute Gap = 31985.7160, Relative Gap = 0.572200
  Not converged yet (gap = 31985.72 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 91957 nonzeros
Model fingerprint: 0x9b6e45ad
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 23913.8 (0.02s)
MIP start from previous solve produced solution with objective 23913.8 (0.02s)
Loaded MIP start from previous solve with objective 23913.8

Presolve removed 14949 rows and 6068 columns
Presolve time: 0.45s
Presolved: 17014 rows, 8672 columns, 94038 nonzeros
Variable types: 6413 continuous, 2259 integer (2259 binary)

Root relaxation: objective 6.985466e+04, 8511 iterations, 1.42 seconds (1.81 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 69854.6601    0  246 23913.8259 69854.6601   192%     -    2s
H    0     0                    38635.653461 69854.6601  80.8%     -    2s
     0     0 63001.1850    0  274 38635.6535 63001.1850  63.1%     -    3s
     0     0 62697.8976    0  282 38635.6535 62697.8976  62.3%     -    3s
     0     0 62694.9593    0  284 38635.6535 62694.9593  62.3%     -    4s
     0     0 62694.8556    0  385 38635.6535 62694.8556  62.3%     -    4s
     0     0 56504.4445    0  291 38635.6535 56504.4445  46.2%     -    5s
     0     0 56238.4391    0  336 38635.6535 56238.4391  45.6%     -    6s
     0     0 55990.0989    0  324 38635.6535 55990.0989  44.9%     -    6s
     0     0 55953.9104    0  381 38635.6535 55953.9104  44.8%     -    6s
     0     0 55950.4531    0  383 38635.6535 55950.4531  44.8%     -    7s
     0     0 55950.2478    0  395 38635.6535 55950.2478  44.8%     -    7s
H    0     0                    38679.725437 52973.5883  37.0%     -    9s
     0     0 52973.5883    0  375 38679.7254 52973.5883  37.0%     -    9s
     0     0 52230.2502    0  450 38679.7254 52230.2502  35.0%     -   10s
     0     0 52018.4437    0  409 38679.7254 52018.4437  34.5%     -   10s
     0     0 51867.6538    0  515 38679.7254 51867.6538  34.1%     -   11s
     0     0 51819.7400    0  522 38679.7254 51819.7400  34.0%     -   11s
     0     0 51800.3315    0  483 38679.7254 51800.3315  33.9%     -   11s
     0     0 51778.6074    0  480 38679.7254 51778.6074  33.9%     -   11s
     0     0 51774.5388    0  481 38679.7254 51774.5388  33.9%     -   11s
     0     0 51773.8934    0  482 38679.7254 51773.8934  33.9%     -   11s
     0     0 50125.5884    0  404 38679.7254 50125.5884  29.6%     -   14s
     0     0 49814.7653    0  408 38679.7254 49814.7653  28.8%     -   15s
     0     0 49715.5471    0  415 38679.7254 49715.5471  28.5%     -   15s
     0     0 49664.6106    0  424 38679.7254 49664.6106  28.4%     -   15s
     0     0 49650.4548    0  434 38679.7254 49650.4548  28.4%     -   16s
     0     0 49646.3039    0  428 38679.7254 49646.3039  28.4%     -   16s
     0     0 49360.2616    0  471 38679.7254 49360.2616  27.6%     -   16s
     0     0 49255.5670    0  476 38679.7254 49255.5670  27.3%     -   17s
     0     0 49214.8300    0  490 38679.7254 49214.8300  27.2%     -   17s
     0     0 49198.5999    0  486 38679.7254 49198.5999  27.2%     -   17s
     0     0 49194.0069    0  496 38679.7254 49194.0069  27.2%     -   17s
     0     0 49028.7966    0  496 38679.7254 49028.7966  26.8%     -   18s
     0     0 48945.2997    0  472 38679.7254 48945.2997  26.5%     -   20s
     0     0 48908.9001    0  492 38679.7254 48908.9001  26.4%     -   20s
     0     0 48898.4594    0  494 38679.7254 48898.4594  26.4%     -   20s
     0     0 48894.1133    0  486 38679.7254 48894.1133  26.4%     -   20s
     0     0 48842.8205    0  402 38679.7254 48842.8205  26.3%     -   21s
     0     0 48831.1684    0  408 38679.7254 48831.1684  26.2%     -   21s
     0     0 48825.8867    0  412 38679.7254 48825.8867  26.2%     -   21s
     0     0 48793.2994    0  417 38679.7254 48793.2994  26.1%     -   22s
     0     0 48752.7903    0  402 38679.7254 48752.7903  26.0%     -   22s
     0     0 48745.1367    0  406 38679.7254 48745.1367  26.0%     -   23s
     0     0 48737.4036    0  412 38679.7254 48737.4036  26.0%     -   23s
     0     0 48733.6817    0  418 38679.7254 48733.6817  26.0%     -   23s
     0     0 48703.7263    0  402 38679.7254 48703.7263  25.9%     -   24s
     0     0 48697.4159    0  412 38679.7254 48697.4159  25.9%     -   24s
     0     0 48697.2107    0  406 38679.7254 48697.2107  25.9%     -   24s
     0     0 48688.4795    0  394 38679.7254 48688.4795  25.9%     -   24s
     0     0 48684.7512    0  405 38679.7254 48684.7512  25.9%     -   24s
     0     0 48677.5405    0  405 38679.7254 48677.5405  25.8%     -   25s
     0     0 48674.6355    0  405 38679.7254 48674.6355  25.8%     -   25s
     0     2 48674.6355    0  405 38679.7254 48674.6355  25.8%     -   29s
     1     4 48591.5628    1  387 38679.7254 48671.1989  25.8%   316   30s
    31    64 47579.0001    5  389 38679.7254 47935.5713  23.9%  1579   35s
    95   131 46388.0796    7  393 38679.7254 47578.9912  23.0%  1067   40s
   234   262 45865.9537   10  398 38679.7254 47561.7310  23.0%   772   46s
   402   414 44781.9928   13  374 38679.7254 47483.0816  22.8%   629   51s
H  498   448                    38723.862869 47281.2099  22.1%   609   53s
   499   521 45425.3465   14  553 38723.8629 47281.2099  22.1%   610   55s
   823   725 44681.8420   17  370 38723.8629 46919.7549  21.2%   526   60s
  1128   967 43984.0485   20  363 38723.8629 46919.7549  21.2%   484   65s
  1525  1156 43435.3379   24  475 38723.8629 46897.1345  21.1%   440   71s
  1861  1397 41524.1521   35  269 38723.8629 46893.9970  21.1%   437   76s
  2209  1597 41306.5969   40  314 38723.8629 46893.9970  21.1%   419   81s
  2672  1929 41118.7530   49  327 38723.8629 45844.2964  18.4%   401   87s
  3086  2256     cutoff   56      38723.8629 45652.6313  17.9%   392   91s
  3865  2655     cutoff   22      38723.8629 45627.6776  17.8%   369   98s
  4097  2773 43477.7520   14  279 38723.8629 45543.4700  17.6%   369  100s
  4263  2774 39305.3200   15  405 38723.8629 45528.6980  17.6%   366  108s
  4266  2776 45352.1428    7  272 38723.8629 45528.6980  17.6%   366  111s
  4274  2781 42850.0122   30  385 38723.8629 45528.6980  17.6%   366  115s
  4283  2787 40806.2847   13  399 38723.8629 45528.6980  17.6%   365  120s
  4291  2793 44113.7391   15  415 38723.8629 45528.6980  17.6%   364  125s
  4296  2796 39539.6315   31  467 38723.8629 45528.6980  17.6%   364  130s
  4298  2797 41706.6977   49  467 38723.8629 45528.6980  17.6%   363  135s
  4315  2810 44824.7324   16  310 38723.8629 45528.6980  17.6%   371  140s
  4406  2883 42041.9394   20  300 38723.8629 45528.6980  17.6%   378  145s
  4547  2944 41488.4678   22  319 38723.8629 45528.6980  17.6%   378  150s
  4791  2950 39678.7624   26  253 38723.8629 45243.9415  16.8%   376  155s
  5168  2934 39397.4591   31  324 38723.8629 43997.5598  13.6%   373  161s
  5512  2926     cutoff   24      38723.8629 43647.1237  12.7%   369  165s
  5837  2876 40794.0042   29  216 38723.8629 43410.4875  12.1%   365  170s
  6426  2776 39159.8599   29  288 38723.8629 42920.5711  10.8%   358  175s
  7039  2544     cutoff   27      38723.8629 42516.1379  9.79%   353  180s
  7781  2160 39462.5232   24  205 38723.8629 41574.2307  7.36%   348  185s
  9439  1096     cutoff   46      38723.8629 39013.2677  0.75%   320  190s

Cutting planes:
  Gomory: 2
  MIR: 238
  Mixing: 1
  Flow cover: 420
  RLT: 4
  Relax-and-lift: 36

Explored 9739 nodes (3064988 simplex iterations) in 190.19 seconds (315.99 work units)
Thread count was 32 (of 32 available processors)

Solution count 4: 38723.9 38679.7 38635.7 23913.8 

Optimal solution found (tolerance 1.00e-04)
Best objective 3.872386286888e+04, best bound 3.872386286888e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 190.19s
  Master Objective (UB) = 38723.86, θ = 188328.89
  Upper Bound (UB) = 38723.86

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 188328.89
  [DEBUG]   ✓ Scenario 0: θ = 188328.89 ≤ Q = 188328.89 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 188328.89 ≤ Q = 188328.89 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x8f2c195
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x08f2c195
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.347523e+13
Presolve removed 2631 rows and 1922 columns
Presolve time: 0.01s
Presolved: 462 rows, 467 columns, 1303 nonzeros
Found heuristic solution: objective 6151306.8513
Variable types: 316 continuous, 151 integer (151 binary)
Found heuristic solution: objective 6150977.5070

Root relaxation: objective -1.672198e+05, 231 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -167219.83    0  120 6150977.51 -167219.83   103%     -    0s
H    0     0                    -149710.3012 -167219.83  11.7%     -    0s
H    0     0                    -150039.6455 -167219.83  11.5%     -    0s
H    0     0                    -150308.2515 -156046.33  3.82%     -    0s
     0     0 -156046.33    0  118 -150308.25 -156046.33  3.82%     -    0s
H    0     0                    -152679.2027 -155955.38  2.15%     -    0s
     0     0 -155856.54    0  101 -152679.20 -155856.54  2.08%     -    0s
     0     0 -155080.89    0   98 -152679.20 -155080.89  1.57%     -    0s
H    0     0                    -153491.1243 -155014.67  0.99%     -    0s
     0     0 -154952.58    0   96 -153491.12 -154952.58  0.95%     -    0s
     0     0 -154678.65    0   63 -153491.12 -154678.65  0.77%     -    0s
     0     0 -154622.55    0   74 -153491.12 -154622.55  0.74%     -    0s
     0     0 -154617.01    0   52 -153491.12 -154617.01  0.73%     -    0s
     0     0 -154465.70    0   52 -153491.12 -154465.70  0.63%     -    0s
     0     0 -154437.43    0   44 -153491.12 -154437.43  0.62%     -    0s
     0     0 -154432.81    0   73 -153491.12 -154432.81  0.61%     -    0s
     0     0 -154381.08    0   64 -153491.12 -154381.08  0.58%     -    0s
     0     0 -154366.47    0   64 -153491.12 -154366.47  0.57%     -    0s
     0     2 -154366.47    0   64 -153491.12 -154366.47  0.57%     -    0s
H  867    11                    -153502.9239 -153705.86  0.13%   7.5    0s

Cutting planes:
  Gomory: 44
  Implied bound: 6
  MIR: 122
  Flow cover: 38
  RLT: 88
  Relax-and-lift: 8
  BQP: 3

Explored 944 nodes (7548 simplex iterations) in 0.27 seconds (0.09 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -153503 -153491 -152679 ... 1.34752e+13
No other solutions better than -153503

Optimal solution found (tolerance 1.00e-04)
Best objective -1.535029239389e+05, best bound -1.535029239389e+05, gap 0.0000%
  Subproblem solved in 0.31s
  Worst-case operational profit (Z_SP) = 167490.10
  Scenario: 60 demand increases, 0 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -153502.92
  [DEBUG]   S×d_nominal = 320993.02
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 320993.02 + -153502.92 = 167490.10
  [DEBUG]   Current θ from Master = 188328.89
  [DEBUG]   ⚠️  Z_SP ≤ θ by 20838.79 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 17885.07
  Lower Bound (LB) = 23913.83
  Gap (UB-LB) = 14810.0369, Absolute Gap = 14810.0369, Relative Gap = 0.382452
  Not converged yet (gap = 14810.04 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 60 increases, 0 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135176 nonzeros
Model fingerprint: 0xf3f1bbdb
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 17885.1 (0.03s)
Loaded MIP start from previous solve with objective 17885.1

Presolve removed 22422 rows and 9102 columns
Presolve time: 0.57s
Presolved: 24831 rows, 11878 columns, 138749 nonzeros
Variable types: 9619 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   32580    5.9839095e+04   0.000000e+00   2.316458e+05      5s
Concurrent spin time: 0.05s

Solved with dual simplex

Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   19894    6.6298494e+04   0.000000e+00   0.000000e+00      7s

Root relaxation: objective 6.629849e+04, 19894 iterations, 6.85 seconds (8.77 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 66298.4943    0  234 17885.0705 66298.4943   271%     -    7s
H    0     0                    18083.462317 66298.4943   267%     -    7s
H    0     0                    19123.300062 66298.4943   247%     -    7s
H    0     0                    19321.691882 66298.4943   243%     -    7s
H    0     0                    26330.726142 66298.4943   152%     -    8s
H    0     0                    26904.073836 66298.4943   146%     -    8s
H    0     0                    29031.465313 66298.4943   128%     -    8s
H    0     0                    29143.533265 66298.4943   127%     -    8s
H    0     0                    29646.773812 66298.4943   124%     -    8s
H    0     0                    29748.865647 66298.4943   123%     -    8s
H    0     0                    29932.203814 66298.4943   121%     -    8s
H    0     0                    29991.230516 66298.4943   121%     -    8s
H    0     0                    30060.594085 66298.4943   121%     -    8s
     0     0 58903.3542    0  359 30060.5941 58903.3542  95.9%     -   11s
     0     0 58903.3542    0  362 30060.5941 58903.3542  95.9%     -   11s
     0     0 58903.3542    0  376 30060.5941 58903.3542  95.9%     -   12s
     0     0 58903.3542    0  369 30060.5941 58903.3542  95.9%     -   12s
     0     0 58903.3542    0  369 30060.5941 58903.3542  95.9%     -   12s
     0     0 52892.6464    0  265 30060.5941 52892.6464  76.0%     -   17s
H    0     0                    30062.697610 52891.6983  75.9%     -   17s
     0     0 51954.7822    0  301 30062.6976 51954.7822  72.8%     -   18s
H    0     0                    30071.809327 51451.9259  71.1%     -   20s
     0     0 51451.9259    0  296 30071.8093 51451.9259  71.1%     -   20s
     0     0 51432.9139    0  436 30071.8093 51432.9139  71.0%     -   20s
     0     0 51407.8549    0  289 30071.8093 51407.8549  71.0%     -   20s
     0     0 51400.9394    0  404 30071.8093 51400.9394  70.9%     -   20s
     0     0 51399.3276    0  361 30071.8093 51399.3276  70.9%     -   21s
H    0     0                    30118.822037 49143.5844  63.2%     -   26s
H    0     0                    30127.520615 49143.5844  63.1%     -   26s
H    0     0                    30135.037120 49143.5844  63.1%     -   26s
H    0     0                    30166.552116 49143.5844  62.9%     -   26s
     0     0 49143.5844    0  368 30166.5521 49143.5844  62.9%     -   26s
     0     0 48279.0278    0  398 30166.5521 48279.0278  60.0%     -   28s
     0     0 48103.7342    0  452 30166.5521 48103.7342  59.5%     -   29s
     0     0 48039.6142    0  414 30166.5521 48039.6142  59.2%     -   29s
     0     0 48020.8619    0  460 30166.5521 48020.8619  59.2%     -   30s
     0     0 48017.9128    0  455 30166.5521 48017.9128  59.2%     -   30s
     0     0 46438.0189    0  398 30166.5521 46438.0189  53.9%     -   35s
H    0     0                    30188.329551 46436.1274  53.8%     -   35s
H    0     0                    30220.388531 46436.1274  53.7%     -   35s
H    0     0                    30254.526435 46436.1274  53.5%     -   35s
     0     0 46058.9696    0  391 30254.5264 46058.9696  52.2%     -   37s
     0     0 45955.8420    0  398 30254.5264 45955.8420  51.9%     -   38s
     0     0 45870.8168    0  463 30254.5264 45870.8168  51.6%     -   39s
     0     0 45857.6625    0  471 30254.5264 45857.6625  51.6%     -   39s
     0     0 45848.3009    0  476 30254.5264 45848.3009  51.5%     -   40s
     0     0 45844.8115    0  488 30254.5264 45844.8115  51.5%     -   40s
     0     0 45446.8634    0  380 30254.5264 45446.8634  50.2%     -   43s
     0     0 45375.9228    0  393 30254.5264 45375.9228  50.0%     -   44s
     0     0 45355.8633    0  396 30254.5264 45355.8633  49.9%     -   45s
     0     0 45343.0118    0  402 30254.5264 45343.0118  49.9%     -   45s
     0     0 45326.3469    0  408 30254.5264 45326.3469  49.8%     -   45s
     0     0 45319.5975    0  417 30254.5264 45319.5975  49.8%     -   45s
     0     0 45314.4746    0  417 30254.5264 45314.4746  49.8%     -   46s
     0     0 45185.9629    0  387 30254.5264 45185.9629  49.4%     -   47s
     0     0 45142.9473    0  406 30254.5264 45142.9473  49.2%     -   48s
     0     0 45131.4626    0  419 30254.5264 45131.4626  49.2%     -   48s
     0     0 45116.7057    0  417 30254.5264 45116.7057  49.1%     -   49s
     0     0 45113.2558    0  413 30254.5264 45113.2558  49.1%     -   49s
     0     0 44994.2023    0  420 30254.5264 44994.2023  48.7%     -   50s
     0     0 44952.7013    0  531 30254.5264 44952.7013  48.6%     -   52s
     0     0 44941.8094    0  486 30254.5264 44941.8094  48.5%     -   52s
     0     0 44937.8821    0  489 30254.5264 44937.8821  48.5%     -   52s
     0     0 44879.9220    0  422 30254.5264 44879.9220  48.3%     -   53s
     0     0 44866.5048    0  406 30254.5264 44866.5048  48.3%     -   54s
     0     0 44863.3577    0  411 30254.5264 44863.3577  48.3%     -   55s
     0     0 44836.4294    0  395 30254.5264 44836.4294  48.2%     -   56s
     0     0 44827.8487    0  390 30254.5264 44827.8487  48.2%     -   56s
     0     0 44825.8918    0  403 30254.5264 44825.8918  48.2%     -   57s
     0     0 44819.7087    0  387 30254.5264 44819.7087  48.1%     -   57s
     0     0 44818.9392    0  387 30254.5264 44818.9392  48.1%     -   58s
     0     2 44818.9392    0  387 30254.5264 44818.9392  48.1%     -   71s
     3     8 44630.8642    2  387 30254.5264 44790.8983  48.0%  1586   76s
    15    32 44155.0459    4  411 30254.5264 44583.6228  47.4%  2510   83s
    31    64 44038.4911    5  405 30254.5264 44155.0193  45.9%  5129   87s
    63    96 43988.8422    6  406 30254.5264 44036.4417  45.6%  3901   90s
   224   300 43553.5633    8  396 30254.5264 44036.4417  45.6%  1789   96s
H  331   350                    30940.669247 44036.4417  42.3%  1570   99s
H  347   350                    31247.032126 44036.4417  40.9%  1546   99s
   349   392 43181.5400   10  384 31247.0321 44036.4417  40.9%  1545  101s
H  353   392                    31509.099853 44036.4417  39.8%  1548  101s
H  388   392                    32038.155771 44036.4417  37.4%  1498  101s
H  396   455                    32188.485312 44036.4417  36.8%  1506  104s
H  405   455                    32444.858435 44036.4417  35.7%  1509  104s
   454   530 43173.7032   11  383 32444.8584 44036.4417  35.7%  1437  108s
   529   600 42644.9610   13  379 32444.8584 44036.4417  35.7%  1417  110s
H  533   600                    32469.301148 44036.4417  35.6%  1420  110s
   679   742 42509.7950   14  394 32469.3011 44036.4417  35.6%  1312  115s
   825   816 42151.6497   16  388 32469.3011 44036.4417  35.6%  1227  122s
   871   868 41920.9073   17  393 32469.3011 43988.5808  35.5%  1234  125s
  1014   964 41608.0603   19  393 32469.3011 43988.5808  35.5%  1193  130s
  1116  1065 41368.0974   20  371 32469.3011 43915.4884  35.3%  1192  136s
  1200  1121 41106.6414   21  379 32469.3011 43915.4884  35.3%  1178  140s
  1370  1291 40863.4567   22  334 32469.3011 43915.4884  35.3%  1166  146s
  1572  1468 40676.0052   24  330 32469.3011 43915.4884  35.3%  1122  152s
  1693  1551 40377.2342   27  360 32469.3011 43784.1290  34.8%  1094  155s
  1922  1784 37843.3885   29  300 32469.3011 43784.1290  34.8%  1065  162s
  2091  1809 37082.9546   36  250 32469.3011 43497.6853  34.0%  1028  166s
  2212  1926 35893.1072   37  260 32469.3011 43328.9925  33.4%  1019  172s
  2313  1985 35807.8750   39  259 32469.3011 43180.5688  33.0%  1010  176s
  2428  2038 34796.3602   41  197 32469.3011 43180.5688  33.0%  1008  180s
  2527  2091 33032.0127   46  179 32469.3011 43137.6047  32.9%  1012  185s
  2769  2258 38655.6648   12  317 32469.3011 43083.2753  32.7%  1016  199s
  2925  2374 35733.8111   19  272 32469.3011 43083.2753  32.7%  1009  204s
  3081  2520 34707.4074   27  197 32469.3011 43083.2753  32.7%   997  209s
  3327  2598     cutoff   40      32469.3011 43023.5560  32.5%   975  214s
  3469  2744 42509.7489   12  361 32469.3011 43023.5560  32.5%   961  220s
  3710  2845 42268.9167   13  366 32469.3011 42821.6659  31.9%   943  225s
  3866  2846 36531.2555   24  387 32469.3011 42821.6659  31.9%   954  238s
  3868  2847 40948.1307   11   68 32469.3011 42821.6659  31.9%   953  241s
  3870  2849 38591.8712   14  307 32469.3011 42821.6659  31.9%   953  245s
  3874  2851 34002.6676   37  404 32469.3011 42821.6659  31.9%   952  250s
  3883  2857 41613.0359   14  386 32469.3011 42821.6659  31.9%   950  255s
  3890  2862 40199.8267    8  399 32469.3011 42821.6659  31.9%   948  261s
  3896  2866 34686.1344   27  401 32469.3011 42821.6659  31.9%   947  265s
  3902  2870 38600.6405    8  446 32469.3011 42821.6659  31.9%   945  273s
  3903  2871 34023.3080   27  446 32469.3011 42821.6659  31.9%   945  277s
  3904  2874 42821.6659   10  398 32469.3011 42821.6659  31.9%   956  282s
  3910  2884 42821.6659   12  364 32469.3011 42821.6659  31.9%   960  287s
  3918  2898 42821.6659   13  369 32469.3011 42821.6659  31.9%   961  290s
  3966  2941 42813.6847   15  347 32469.3011 42821.6659  31.9%   979  298s
  3998  2993 42517.9008   16  326 32469.3011 42821.6659  31.9%   998  302s
  4124  3046 42212.6292   18  322 32469.3011 42821.6659  31.9%  1018  308s
  4186  3058 39988.0907   19  278 32469.3011 42821.6659  31.9%  1031  311s
  4329  3064 37901.8712   21  187 32469.3011 42140.8647  29.8%  1047  317s
  4388  3060 37815.9777   22  220 32469.3011 42140.8647  29.8%  1058  320s
  4502  3071     cutoff   23      32469.3011 41718.5635  28.5%  1081  327s
  4566  3062     cutoff   24      32469.3011 41718.5635  28.5%  1089  331s
  4677  3051 33081.5940   26  162 32469.3011 41718.5635  28.5%  1112  337s
  4732  3048 34282.9103   26  189 32469.3011 40965.5933  26.2%  1120  340s
  4875  3057     cutoff   27      32469.3011 40465.2187  24.6%  1122  347s
  5016  3062 34102.9490   23  127 32469.3011 40274.7863  24.0%  1126  353s
  5100  3069 35944.2124   23  173 32469.3011 40031.8647  23.3%  1127  356s
  5313  3065 34496.7558   25  152 32469.3011 40031.8647  23.3%  1120  362s
  5407  3055 32567.7043   25  109 32469.3011 39319.3599  21.1%  1123  366s
  5507  3041 33079.5946   27  156 32469.3011 39262.4670  20.9%  1129  370s
  5679  3002 35592.4917   21  190 32469.3011 39262.2996  20.9%  1136  376s
  5767  2990 33410.8887   23  151 32469.3011 39262.2996  20.9%  1139  382s
  5826  2976 infeasible   24      32469.3011 38763.1931  19.4%  1138  386s
  5879  2976     cutoff   24      32469.3011 38642.6670  19.0%  1142  390s
  6023  2967 36383.2044   18  262 32469.3011 38505.7647  18.6%  1145  399s
  6150  2968 35901.8230   19  285 32469.3011 38464.1364  18.5%  1145  403s
  6294  2926     cutoff   20      32469.3011 38334.6084  18.1%  1148  407s
  6471  2893 34183.9911   24  181 32469.3011 38167.5707  17.5%  1148  412s
  6649  2851 34894.7720   21  208 32469.3011 38078.6904  17.3%  1151  417s
  6829  2825 34709.8352   22  256 32469.3011 37754.4059  16.3%  1157  422s
  7051  2758     cutoff   24      32469.3011 37669.7399  16.0%  1153  427s
  7290  2716 34307.1576   24  196 32469.3011 37648.4066  16.0%  1155  433s
  7577  2648 35415.1381   19  266 32469.3011 37079.6344  14.2%  1150  438s
  7851  2563     cutoff   21      32469.3011 36956.3747  13.8%  1149  443s
  8092  2504 33378.5979   20  307 32469.3011 36723.3733  13.1%  1144  449s
  8396  2400 33547.2158   22  301 32469.3011 36654.4710  12.9%  1143  454s
  8722  2286 32767.9006   25  187 32469.3011 36342.6577  11.9%  1140  461s
  9089  2161 33802.3565   22  162 32469.3011 36224.7497  11.6%  1134  466s
  9362  2024 33762.8156   20  251 32469.3011 36097.2384  11.2%  1129  472s
  9774  1823     cutoff   27      32469.3011 35901.5750  10.6%  1124  478s
 10169  1599     cutoff   23      32469.3011 35476.5722  9.26%  1122  484s
 10612  1391 33227.4905   22  298 32469.3011 35259.9173  8.59%  1111  490s
 11105  1003 32600.8012   23  190 32469.3011 34956.2927  7.66%  1101  496s
 11793   471     cutoff   31      32469.3011 34457.3222  6.12%  1075  501s
 12561    52 infeasible   27      32469.3011 34156.1388  5.20%  1033  506s

Cutting planes:
  Gomory: 1
  MIR: 337
  Mixing: 1
  Flow cover: 613
  RLT: 7
  Relax-and-lift: 53

Explored 13240 nodes (13177430 simplex iterations) in 509.80 seconds (926.59 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 32469.3 32444.9 32188.5 ... 30188.3

Optimal solution found (tolerance 1.00e-04)
Best objective 3.246930114829e+04, best bound 3.246930114829e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 509.81s
  Master Objective (UB) = 32469.30, θ = 191232.51
  Upper Bound (UB) = 32469.30

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 191232.51
  [DEBUG]   ✓ Scenario 0: θ = 191232.51 ≤ Q = 191232.51 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 191232.51 ≤ Q = 191232.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 191232.51 ≤ Q = 191232.51 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x23d22a47
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xdc2dd5b9
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.262509e+13
Presolve removed 2623 rows and 1914 columns
Presolve time: 0.01s
Presolved: 470 rows, 475 columns, 1325 nonzeros
Found heuristic solution: objective 5742631.1104
Variable types: 323 continuous, 152 integer (152 binary)

Root relaxation: objective -1.655695e+05, 249 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -165569.52    0  125 5742631.11 -165569.52   103%     -    0s
H    0     0                    -130907.8325 -165569.52  26.5%     -    0s
H    0     0                    -133079.4222 -165569.52  24.4%     -    0s
H    0     0                    -141313.6414 -165569.52  17.2%     -    0s
H    0     0                    -142942.6774 -151610.21  6.06%     -    0s
H    0     0                    -146146.4999 -151610.21  3.74%     -    0s
     0     0 -151610.21    0   67 -146146.50 -151610.21  3.74%     -    0s
H    0     0                    -150211.7534 -151515.10  0.87%     -    0s
     0     0 -150779.40    0   60 -150211.75 -150779.40  0.38%     -    0s
     0     0 -150771.32    0   60 -150211.75 -150771.32  0.37%     -    0s
     0     0 -150758.43    0   59 -150211.75 -150758.43  0.36%     -    0s
H    0     0                    -150235.4831 -150269.21  0.02%     -    0s
     0     0 -150269.21    0   18 -150235.48 -150269.21  0.02%     -    0s
     0     0 -150251.53    0    9 -150235.48 -150251.53  0.01%     -    0s
H    0     0                    -150236.1544 -150251.23  0.01%     -    0s

Cutting planes:
  Gomory: 20
  Implied bound: 4
  MIR: 80
  Flow cover: 2
  RLT: 80
  Relax-and-lift: 3
  BQP: 2

Explored 1 nodes (539 simplex iterations) in 0.05 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -150236 -150235 -150212 ... 1.26251e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.502361543800e+05, best bound -1.502510235503e+05, gap 0.0099%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 170756.87
  Scenario: 24 demand increases, 36 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -150236.15
  [DEBUG]   S×d_nominal = 320993.02
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 320993.02 + -150236.15 = 170756.87
  [DEBUG]   Current θ from Master = 191232.51
  [DEBUG]   ⚠️  Z_SP ≤ θ by 20475.64 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 11993.66
  Lower Bound (LB) = 23913.83
  Gap (UB-LB) = 8555.4752, Absolute Gap = 8555.4752, Relative Gap = 0.263494
  Not converged yet (gap = 8555.48 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 24 increases, 36 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178395 nonzeros
Model fingerprint: 0x08ec89b1
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 11993.7 (0.07s)
Loaded MIP start from previous solve with objective 11993.7

Presolve removed 29896 rows and 12136 columns
Presolve time: 1.01s
Presolved: 32647 rows, 15084 columns, 201399 nonzeros
Variable types: 12825 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 32647 rows, 15084 columns, 201399 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   38076    2.6334329e+04   0.000000e+00   9.069931e+06      5s
Concurrent spin time: 0.35s

Solved with dual simplex

Root relaxation: objective 5.743340e+04, 19082 iterations, 5.62 seconds (7.41 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 57433.3956    0   68 11993.6563 57433.3956   379%     -    6s
H    0     0                    27709.019723 57433.3956   107%     -    7s
H    0     0                    28036.268551 57433.3956   105%     -    7s
H    0     0                    28263.304881 57433.3956   103%     -    7s
H    0     0                    28381.689240 57433.3956   102%     -    7s
H    0     0                    29081.429340 57433.3956  97.5%     -    7s
H    0     0                    29190.160337 57433.3956  96.8%     -    7s
H    0     0                    29646.980039 57433.3956  93.7%     -    7s
H    0     0                    29942.386239 57433.3956  91.8%     -    7s
H    0     0                    29949.354629 57433.3956  91.8%     -    7s
H    0     0                    30023.476157 53481.9146  78.1%     -   10s
H    0     0                    30169.781890 53481.9146  77.3%     -   10s
     0     0 53480.3378    0  172 30169.7819 53480.3378  77.3%     -   10s
     0     0 52731.9056    0  169 30169.7819 52731.9056  74.8%     -   12s
     0     0 52731.9056    0  169 30169.7819 52731.9056  74.8%     -   13s
H    0     0                    30979.379020 50218.4001  62.1%     -   17s
H    0     0                    30980.000168 50218.4001  62.1%     -   17s
     0     0 50218.4001    0  180 30980.0002 50218.4001  62.1%     -   17s
     0     0 49644.7104    0  263 30980.0002 49644.7104  60.2%     -   20s
     0     0 49424.0518    0  260 30980.0002 49424.0518  59.5%     -   21s
     0     0 49318.3142    0  282 30980.0002 49318.3142  59.2%     -   22s
     0     0 49300.7983    0  252 30980.0002 49300.7983  59.1%     -   22s
     0     0 49293.8563    0  288 30980.0002 49293.8563  59.1%     -   22s
     0     0 49293.3404    0  288 30980.0002 49293.3404  59.1%     -   23s
     0     0 47177.6154    0  303 30980.0002 47177.6154  52.3%     -   28s
H    0     0                    31098.740879 47176.9326  51.7%     -   29s
H    0     0                    31138.160128 47176.9326  51.5%     -   29s
     0     0 46872.0544    0  301 31138.1601 46872.0544  50.5%     -   30s
     0     0 46643.9681    0  343 31138.1601 46643.9681  49.8%     -   31s
     0     0 46545.8425    0  314 31138.1601 46545.8425  49.5%     -   32s
     0     0 46450.2730    0  319 31138.1601 46450.2730  49.2%     -   33s
     0     0 46398.1506    0  320 31138.1601 46398.1506  49.0%     -   33s
     0     0 46331.5266    0  321 31138.1601 46331.5266  48.8%     -   34s
     0     0 46318.2641    0  327 31138.1601 46318.2641  48.8%     -   34s
     0     0 46314.5184    0  329 31138.1601 46314.5184  48.7%     -   34s
     0     0 46313.4326    0  329 31138.1601 46313.4326  48.7%     -   34s
H    0     0                    31178.327611 45706.8663  46.6%     -   40s
     0     0 45706.8663    0  294 31178.3276 45706.8663  46.6%     -   40s
     0     0 45453.8027    0  358 31178.3276 45453.8027  45.8%     -   42s
     0     0 45307.3507    0  389 31178.3276 45307.3507  45.3%     -   43s
     0     0 45228.7595    0  396 31178.3276 45228.7595  45.1%     -   44s
     0     0 45181.3073    0  393 31178.3276 45181.3073  44.9%     -   45s
     0     0 45159.9797    0  394 31178.3276 45159.9797  44.8%     -   45s
     0     0 45152.7219    0  402 31178.3276 45152.7219  44.8%     -   46s
     0     0 45152.0286    0  401 31178.3276 45152.0286  44.8%     -   46s
     0     0 45081.5678    0  397 31178.3276 45081.5678  44.6%     -   47s
     0     0 45053.2618    0  372 31178.3276 45053.2618  44.5%     -   48s
     0     0 45043.8458    0  405 31178.3276 45043.8458  44.5%     -   48s
     0     0 45030.4430    0  405 31178.3276 45030.4430  44.4%     -   49s
     0     0 45027.9299    0  408 31178.3276 45027.9299  44.4%     -   49s
     0     0 45027.1037    0  408 31178.3276 45027.1037  44.4%     -   49s
     0     0 44958.0070    0  376 31178.3276 44958.0070  44.2%     -   50s
     0     0 44951.7101    0  379 31178.3276 44951.7101  44.2%     -   51s
     0     0 44948.1236    0  400 31178.3276 44948.1236  44.2%     -   52s
     0     0 44945.2809    0  373 31178.3276 44945.2809  44.2%     -   52s
     0     0 44943.9197    0  403 31178.3276 44943.9197  44.2%     -   52s
     0     0 44915.5617    0  384 31178.3276 44915.5617  44.1%     -   54s
     0     0 44905.5933    0  384 31178.3276 44905.5933  44.0%     -   54s
     0     0 44903.5268    0  378 31178.3276 44903.5268  44.0%     -   54s
     0     0 44902.4100    0  386 31178.3276 44902.4100  44.0%     -   55s
     0     0 44883.4944    0  375 31178.3276 44883.4944  44.0%     -   55s
     0     0 44875.7632    0  385 31178.3276 44875.7632  43.9%     -   57s
     0     0 44874.8731    0  389 31178.3276 44874.8731  43.9%     -   58s
     0     0 44852.7543    0  385 31178.3276 44852.7543  43.9%     -   58s
     0     0 44849.9705    0  418 31178.3276 44849.9705  43.8%     -   59s
     0     0 44849.6469    0  424 31178.3276 44849.6469  43.8%     -   59s
     0     0 44840.9981    0  421 31178.3276 44840.9981  43.8%     -   59s
     0     0 44839.3686    0  420 31178.3276 44839.3686  43.8%     -   60s
     0     0 44836.7106    0  394 31178.3276 44836.7106  43.8%     -   61s
     0     0 44835.9722    0  389 31178.3276 44835.9722  43.8%     -   61s
     0     0 44826.9554    0  393 31178.3276 44826.9554  43.8%     -   62s
     0     0 44824.3889    0  393 31178.3276 44824.3889  43.8%     -   62s
     0     2 44824.3889    0  393 31178.3276 44824.3889  43.8%     -   71s
     7    16 44522.2027    3  377 31178.3276 44635.7973  43.2%  1514   78s
    15    32 44193.5580    4  414 31178.3276 44521.8999  42.8%  3238   86s
    31    64 44074.6889    5  414 31178.3276 44193.1384  41.7%  4969   90s
H   37    64                    31183.453650 44193.1384  41.7%  4319   90s
    63    96 43689.0166    6  403 31183.4537 44073.3426  41.3%  3805   95s
    95   200 43581.0119    7  394 31183.4537 44073.3426  41.3%  3445  100s
   296   379 43092.6115   10  369 31183.4537 44073.3426  41.3%  1941  106s
   378   453 42495.1680   13  377 31183.4537 44073.3426  41.3%  1726  111s
   525   581 40092.8523   14  370 31183.4537 44073.3426  41.3%  1564  120s
   642   664 41646.8375   15  402 31183.4537 44073.3426  41.3%  1495  127s
   710   722 41584.7496   16  345 31183.4537 43487.7792  39.5%  1446  131s
   840   839 41313.3264   18  379 31183.4537 43487.7792  39.5%  1367  139s
   923   904 41201.1429   19  326 31183.4537 43487.7792  39.5%  1313  143s
  1000   933 40525.3015   20  336 31183.4537 43487.7792  39.5%  1300  148s
  1041   965 39286.7927   20  296 31183.4537 43262.6779  38.7%  1298  150s
  1117  1061 40308.1186   22  333 31183.4537 43262.6779  38.7%  1308  157s
  1175  1119 40127.3743   23  295 31183.4537 43262.6779  38.7%  1288  161s
  1243  1146 39493.6747   24  269 31183.4537 43244.2723  38.7%  1282  165s
  1327  1215 39315.9337   25  287 31183.4537 43244.2723  38.7%  1290  173s
  1369  1271 39434.9950   25  261 31183.4537 43244.2723  38.7%  1296  178s
H 1431  1338                    31290.463315 43063.2764  37.6%  1284  182s
  1502  1479 38772.0491   26  221 31290.4633 43063.2764  37.6%  1264  185s
  1667  1630 38465.8341   28  256 31290.4633 43063.2764  37.6%  1201  190s
  2031  1926 37448.3663   33  229 31290.4633 43063.2764  37.6%  1093  199s
  2228  1996 37149.2129   35  220 31290.4633 43063.2764  37.6%  1052  208s
  2394  2075 36726.4912   36  185 31290.4633 42948.1169  37.3%  1046  214s
  2543  2189 35075.8649   39  152 31290.4633 42771.8346  36.7%  1043  220s
H 2697  2233                    31553.750090 42664.1825  35.2%  1043  226s
H 2776  2230                    31614.573182 42664.1825  35.0%  1048  226s
H 2779  2228                    31682.571568 42664.1825  34.7%  1048  226s
  2787  2314 33447.5176   55  116 31682.5716 42516.7968  34.2%  1049  231s
  2891  2407 40136.1891    7  267 31682.5716 42516.7968  34.2%  1069  236s
  2990  2533 38801.5427    9  284 31682.5716 42516.7968  34.2%  1087  241s
  3136  2671 34575.7002   11  292 31682.5716 42516.7968  34.2%  1095  246s
  3302  2864 32589.0877   13  225 31682.5716 42516.7968  34.2%  1095  252s
  3560  2865 33871.6987   58  393 31682.5716 42516.7968  34.2%  1068  268s
  3562  2866 38023.8443   28   68 31682.5716 42516.7968  34.2%  1067  275s
  3563  2867 39078.1255   10  256 31682.5716 42516.7968  34.2%  1067  281s
  3564  2868 35293.5121   19  319 31682.5716 42516.7968  34.2%  1067  286s
  3566  2869 38141.8657   17  383 31682.5716 42516.7968  34.2%  1066  292s
  3568  2870 38280.0813   31  364 31682.5716 42516.7968  34.2%  1065  296s
  3573  2874 40125.7159   16  446 31682.5716 42516.7968  34.2%  1064  302s
  3576  2876 37327.5252   18  383 31682.5716 42516.7968  34.2%  1063  305s
  3582  2880 39962.7716    8  400 31682.5716 42516.7968  34.2%  1061  310s
  3585  2882 33510.0977   24  394 31682.5716 42516.7968  34.2%  1060  316s
  3588  2884 34319.8269   11  408 31682.5716 42516.7968  34.2%  1059  320s
  3591  2886 33657.1833   18  414 31682.5716 42516.7968  34.2%  1059  325s
  3594  2888 34320.3245   11  412 31682.5716 42516.7968  34.2%  1058  330s
  3596  2889 40245.5733   12  457 31682.5716 42516.7968  34.2%  1057  339s
  3597  2890 39038.8850   19  457 31682.5716 42516.7968  34.2%  1057  347s
  3598  2893 42516.7968   15  399 31682.5716 42516.7968  34.2%  1076  351s
  3600  2897 42516.7968   16  398 31682.5716 42516.7968  34.2%  1077  358s
  3604  2903 42516.7968   17  387 31682.5716 42516.7968  34.2%  1077  365s
  3612  2917 42516.7968   18  349 31682.5716 42516.7968  34.2%  1085  372s
  3628  2943 42516.7968   19  338 31682.5716 42516.7968  34.2%  1106  378s
H 3637  2794                    31762.159858 42516.7968  33.9%  1109  378s
  3660  2818 42516.7968   20  373 31762.1599 42516.7968  33.9%  1132  390s
H 3691  2759                    31762.374286 42516.7968  33.9%  1197  402s
  3784  2802 41501.6752   23  302 31762.3743 42516.7968  33.9%  1235  408s
  3872  2812 41300.0289   24  288 31762.3743 42516.7968  33.9%  1249  415s
  3926  2832 38550.8121   24  317 31762.3743 42516.7968  33.9%  1262  421s
  3999  2850 39246.0490   25  368 31762.3743 42516.7968  33.9%  1274  427s
  4070  2862 39126.8267   25  272 31762.3743 42516.7968  33.9%  1287  434s
  4135  2868 38846.9074   26  264 31762.3743 42516.7968  33.9%  1297  445s
  4203  2870 37004.2856   26  221 31762.3743 42516.7968  33.9%  1301  452s
  4261  2884 38388.6233   27  246 31762.3743 42516.7968  33.9%  1315  457s
  4327  2901 36071.4081   27  234 31762.3743 42314.8190  33.2%  1325  462s
  4390  2902 37947.4996   28  235 31762.3743 42314.8190  33.2%  1333  469s
  4426  2922 36094.0825   28  256 31762.3743 41281.4204  30.0%  1339  474s
  4481  2930 36522.5492   29  208 31762.3743 41281.4204  30.0%  1342  479s
  4554  2917     cutoff   29      31762.3743 41213.1275  29.8%  1339  486s
  4637  2906     cutoff   30      31762.3743 41213.1275  29.8%  1338  491s
  4686  2902 32929.2708   31  216 31762.3743 41213.1275  29.8%  1342  498s
  4763  2900 33748.8253   32  208 31762.3743 40902.8514  28.8%  1345  507s
  4850  2900 33416.1643   33  161 31762.3743 40902.8514  28.8%  1350  514s
  4953  2891 32781.1575   36  106 31762.3743 40902.8514  28.8%  1351  521s
  5049  2894 35736.9892   23  225 31762.3743 40563.0162  27.7%  1355  527s
  5158  2873 infeasible   24      31762.3743 40563.0162  27.7%  1358  534s
  5227  2877     cutoff   25      31762.3743 40544.7616  27.7%  1363  540s
  5308  2882 36314.6017   24  264 31762.3743 40388.6739  27.2%  1375  548s
  5426  2881 32376.8968   27  210 31762.3743 40388.6739  27.2%  1374  554s
  5552  2865     cutoff   27      31762.3743 40304.8047  26.9%  1376  565s
  5709  2830 38090.3569   25  282 31762.3743 40096.2500  26.2%  1376  571s
  5754  2833 36680.0722   26  287 31762.3743 40096.2500  26.2%  1381  579s
  5806  2826 35037.7511   27  316 31762.3743 40096.2500  26.2%  1383  586s
  5877  2828 32517.5431   28  261 31762.3743 40096.2500  26.2%  1384  594s
  5946  2833 32501.5354   29  268 31762.3743 40096.2500  26.2%  1387  601s
  6050  2832     cutoff   30      31762.3743 40021.0993  26.0%  1388  612s
  6207  2804 32709.6287   31  147 31762.3743 40021.0993  26.0%  1389  624s
  6368  2761 35682.1981   25  308 31762.3743 39244.3569  23.6%  1394  632s
  6424  2751 34893.4651   26  270 31762.3743 39244.3569  23.6%  1395  641s
  6574  2739     cutoff   29      31762.3743 39129.5166  23.2%  1394  651s
  6817  2699 35644.1822   26  200 31762.3743 39129.5166  23.2%  1387  663s
  7045  2645 36275.4189   23  263 31762.3743 38536.7279  21.3%  1388  673s
  7274  2605 32003.8682   28  166 31762.3743 38536.5770  21.3%  1394  683s
  7576  2513 34210.4004   30  232 31762.3743 38536.5770  21.3%  1386  694s
  7860  2471 35954.2625   29  241 31762.3743 38437.6640  21.0%  1386  705s
  8169  2374     cutoff   37      31762.3743 37733.0514  18.8%  1382  717s
  8478  2303     cutoff   38      31762.3743 37378.0333  17.7%  1379  729s
  8856  2172 34475.4013   26  219 31762.3743 37193.8661  17.1%  1371  739s
  9005  2116 34180.2403   27  214 31762.3743 37193.8661  17.1%  1373  749s
  9255  1986 32892.5436   28  216 31762.3743 37076.8170  16.7%  1367  762s
  9640  1803 33564.8455   27  285 31762.3743 36705.0241  15.6%  1362  774s
 10066  1628     cutoff   28      31762.3743 36088.4451  13.6%  1353  791s
 10521  1394 32512.2479   35  193 31762.3743 35958.2434  13.2%  1348  804s
 10984  1196 33449.4869   28  280 31762.3743 35492.8089  11.7%  1338  817s
 11520   881 32393.8073   25  299 31762.3743 35083.1503  10.5%  1323  830s
 12156   544 32322.7878   27  196 31762.3743 34632.4866  9.04%  1304  845s
 12871    42     cutoff   27      31762.3743 34216.8207  7.73%  1281  856s
 13834     0 32056.3387   42   48 31762.3743 33062.1708  4.09%  1223  862s

Cutting planes:
  Learned: 3
  MIR: 451
  Flow cover: 734
  Inf proof: 1
  RLT: 10
  Relax-and-lift: 80

Explored 13937 nodes (17016667 simplex iterations) in 862.61 seconds (1666.92 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 31762.4 31682.6 31614.6 ... 30980

Optimal solution found (tolerance 1.00e-04)
Best objective 3.176237428612e+04, best bound 3.176237428612e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 862.62s
  Master Objective (UB) = 31762.37, θ = 191455.06
  Upper Bound (UB) = 31762.37

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 191455.06
  [DEBUG]   ✓ Scenario 0: θ = 191455.06 ≤ Q = 191455.06 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 191455.06 ≤ Q = 191455.06 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 191455.06 ≤ Q = 191455.06 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 191455.06 ≤ Q = 191455.06 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x76947c83
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x896b837d
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.245953e+13
Presolve removed 2623 rows and 1914 columns
Presolve time: 0.01s
Presolved: 470 rows, 475 columns, 1325 nonzeros
Found heuristic solution: objective 5610068.1300
Variable types: 323 continuous, 152 integer (152 binary)

Root relaxation: objective -1.652077e+05, 241 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -165207.72    0  125 5610068.13 -165207.72   103%     -    0s
H    0     0                    -128895.4876 -165207.72  28.2%     -    0s
H    0     0                    -129255.7457 -165207.72  27.8%     -    0s
H    0     0                    -142972.7108 -148847.89  4.11%     -    0s
H    0     0                    -146319.3439 -148847.89  1.73%     -    0s
     0     0 -148847.89    0   61 -146319.34 -148847.89  1.73%     -    0s
H    0     0                    -148117.6813 -148817.99  0.47%     -    0s
     0     0 -148710.10    0   54 -148117.68 -148710.10  0.40%     -    0s
     0     0 -148698.03    0   51 -148117.68 -148698.03  0.39%     -    0s
     0     0 -148696.22    0   50 -148117.68 -148696.22  0.39%     -    0s
     0     0 -148685.34    0   71 -148117.68 -148685.34  0.38%     -    0s
     0     0 -148280.39    0   18 -148117.68 -148280.39  0.11%     -    0s
     0     0 -148257.18    0   14 -148117.68 -148257.18  0.09%     -    0s
     0     0 -148252.68    0   13 -148117.68 -148252.68  0.09%     -    0s
     0     0 -148252.67    0   13 -148117.68 -148252.67  0.09%     -    0s
H    0     0                    -148153.6926 -148248.03  0.06%     -    0s
H    0     0                    -148184.0527 -148218.77  0.02%     -    0s
     0     0 -148218.77    0    6 -148184.05 -148218.77  0.02%     -    0s
     0     0 -148200.23    0    2 -148184.05 -148200.23  0.01%     -    0s
     0     0          -    0      -148184.05 -148198.18  0.01%     -    0s

Explored 1 nodes (522 simplex iterations) in 0.08 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -148184 -148154 -148118 ... 1.24595e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.481840526920e+05, best bound -1.481981845349e+05, gap 0.0095%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 172808.97
  Scenario: 24 demand increases, 36 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -148184.05
  [DEBUG]   S×d_nominal = 320993.02
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 320993.02 + -148184.05 = 172808.97
  [DEBUG]   Current θ from Master = 191455.06
  [DEBUG]   ⚠️  Z_SP ≤ θ by 18646.09 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 13116.28
  Lower Bound (LB) = 23913.83
  Gap (UB-LB) = 7848.5483, Absolute Gap = 7848.5483, Relative Gap = 0.247102
  Not converged yet (gap = 7848.55 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 24 increases, 36 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221614 nonzeros
Model fingerprint: 0xad7eb8fd
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 37370 rows and 15170 columns
Presolve time: 1.95s
Presolved: 40463 rows, 18290 columns, 250369 nonzeros
Variable types: 16031 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -310053.6270
Found heuristic solution: objective -171254.7355

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 40463 rows, 18290 columns, 250369 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   19256    1.1227270e+04   0.000000e+00   1.746211e+06      5s
   33911    3.8932198e+04   0.000000e+00   4.277332e+07     10s
   47937    5.2440621e+04   0.000000e+00   2.625831e+05     15s
Concurrent spin time: 2.75s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 5.717762e+04, 40120 iterations, 15.64 seconds (20.27 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 57177.6175    0   69 -171254.74 57177.6175   133%     -   18s
H    0     0                    -168764.3946 57177.6175   134%     -   18s
H    0     0                    -153414.6952 57177.6175   137%     -   18s
H    0     0                    -153238.3036 57177.6175   137%     -   18s
H    0     0                    -152775.3351 57177.6175   137%     -   18s
H    0     0                    -42034.50931 57177.6175   236%     -   18s
H    0     0                    -5126.729130 57177.6175  1215%     -   18s
H    0     0                    -2563.492948 57177.6175  2330%     -   18s
H    0     0                    6493.6610675 57177.6175   781%     -   18s
H    0     0                    12374.718360 57177.6175   362%     -   18s
     0     0 53318.8784    0  176 12374.7184 53318.8784   331%     -   22s
H    0     0                    12434.955111 53318.6153   329%     -   23s
     0     0 52661.9005    0  167 12434.9551 52661.9005   323%     -   25s
     0     0 52653.2966    0  172 12434.9551 52653.2966   323%     -   25s
     0     0 52651.0800    0  167 12434.9551 52651.0800   323%     -   25s
     0     0 50757.9470    0  161 12434.9551 50757.9470   308%     -   31s
H    0     0                    14445.017247 50757.9470   251%     -   31s
H    0     0                    14932.914870 50757.9470   240%     -   31s
H    0     0                    14950.157890 50757.9470   240%     -   31s
H    0     0                    15799.218117 49765.8503   215%     -   35s
     0     0 49765.8503    0  224 15799.2181 49765.8503   215%     -   35s
     0     0 49602.5606    0  238 15799.2181 49602.5606   214%     -   36s
     0     0 49513.3564    0  249 15799.2181 49513.3564   213%     -   37s
     0     0 49486.6885    0  233 15799.2181 49486.6885   213%     -   38s
     0     0 49474.8218    0  233 15799.2181 49474.8218   213%     -   38s
     0     0 49473.5936    0  233 15799.2181 49473.5936   213%     -   38s
     0     0 49473.1403    0  239 15799.2181 49473.1403   213%     -   38s
H    0     0                    16829.261372 49473.1403   194%     -   42s
H    0     0                    23179.126928 47393.7318   104%     -   49s
H    0     0                    23300.695264 47393.7318   103%     -   49s
     0     0 47393.7318    0  303 23300.6953 47393.7318   103%     -   49s
H    0     0                    23399.018015 47393.3150   103%     -   49s
H    0     0                    23495.759867 47393.3150   102%     -   49s
H    0     0                    23639.187094 47393.3150   100%     -   49s
     0     0 46994.7434    0  310 23639.1871 46994.7434  98.8%     -   53s
     0     0 46823.3124    0  302 23639.1871 46823.3124  98.1%     -   54s
     0     0 46722.6361    0  306 23639.1871 46722.6361  97.6%     -   56s
     0     0 46678.5480    0  315 23639.1871 46678.5480  97.5%     -   57s
     0     0 46655.9880    0  312 23639.1871 46655.9880  97.4%     -   58s
     0     0 46647.9980    0  315 23639.1871 46647.9980  97.3%     -   58s
     0     0 46631.8507    0  316 23639.1871 46631.8507  97.3%     -   58s
     0     0 46630.4052    0  324 23639.1871 46630.4052  97.3%     -   58s
     0     0 46630.1136    0  324 23639.1871 46630.1136  97.3%     -   59s
H    0     0                    23739.160304 45421.5226  91.3%     -   70s
     0     0 45421.5226    0  386 23739.1603 45421.5226  91.3%     -   70s
     0     0 45142.0674    0  307 23739.1603 45142.0674  90.2%     -   72s
     0     0 45046.8383    0  346 23739.1603 45046.8383  89.8%     -   74s
     0     0 44961.5752    0  357 23739.1603 44961.5752  89.4%     -   75s
     0     0 44940.9456    0  361 23739.1603 44940.9456  89.3%     -   76s
     0     0 44898.4654    0  364 23739.1603 44898.4654  89.1%     -   77s
     0     0 44880.2978    0  364 23739.1603 44880.2978  89.1%     -   78s
     0     0 44870.5685    0  365 23739.1603 44870.5685  89.0%     -   78s
     0     0 44863.6470    0  361 23739.1603 44863.6470  89.0%     -   79s
     0     0 44861.4909    0  365 23739.1603 44861.4909  89.0%     -   79s
     0     0 44835.5597    0  361 23739.1603 44835.5597  88.9%     -   80s
     0     0 44824.4860    0  359 23739.1603 44824.4860  88.8%     -   80s
     0     0 44820.3414    0  362 23739.1603 44820.3414  88.8%     -   80s
     0     0 44819.0960    0  366 23739.1603 44819.0960  88.8%     -   80s
     0     0 44563.9272    0  370 23739.1603 44563.9272  87.7%     -   83s
H    0     0                    23770.407852 44563.4722  87.5%     -   84s
     0     0 44523.2579    0  379 23770.4079 44523.2579  87.3%     -   85s
     0     0 44500.7433    0  373 23770.4079 44500.7433  87.2%     -   85s
     0     0 44490.6853    0  376 23770.4079 44490.6853  87.2%     -   86s
     0     0 44485.8463    0  374 23770.4079 44485.8463  87.1%     -   86s
     0     0 44484.0320    0  372 23770.4079 44484.0320  87.1%     -   86s
     0     0 44482.7171    0  377 23770.4079 44482.7171  87.1%     -   87s
     0     0 44353.0247    0  378 23770.4079 44353.0247  86.6%     -   89s
H    0     0                    24055.957977 44334.7393  84.3%     -   90s
H    0     0                    24075.206057 44334.7393  84.2%     -   90s
H    0     0                    24106.272574 44334.7393  83.9%     -   90s
     0     0 44334.7393    0  385 24106.2726 44334.7393  83.9%     -   90s
     0     0 44324.2810    0  388 24106.2726 44324.2810  83.9%     -   91s
     0     0 44314.1731    0  388 24106.2726 44314.1731  83.8%     -   91s
     0     0 44312.0849    0  386 24106.2726 44312.0849  83.8%     -   92s
     0     0 44311.6450    0  388 24106.2726 44311.6450  83.8%     -   92s
     0     0 44264.2639    0  381 24106.2726 44264.2639  83.6%     -   93s
H    0     0                    24129.807155 44263.7923  83.4%     -   94s
H    0     0                    24183.708584 44263.7923  83.0%     -   94s
     0     0 44258.7618    0  377 24183.7086 44258.7618  83.0%     -   95s
     0     0 44256.2955    0  386 24183.7086 44256.2955  83.0%     -   95s
     0     0 44252.8971    0  388 24183.7086 44252.8971  83.0%     -   95s
     0     0 44251.6178    0  388 24183.7086 44251.6178  83.0%     -   95s
     0     0 44218.1282    0  389 24183.7086 44218.1282  82.8%     -   96s
     0     0 44211.9343    0  389 24183.7086 44211.9343  82.8%     -   98s
     0     0 44211.4468    0  395 24183.7086 44211.4468  82.8%     -   98s
H    0     0                    25837.874603 44192.9494  71.0%     -   99s
H    0     0                    25912.346195 44192.9494  70.5%     -   99s
H    0     0                    26355.756603 44192.9494  67.7%     -   99s
     0     0 44192.9494    0  405 26355.7566 44192.9494  67.7%     -   99s
H    0     0                    26380.812035 44192.0044  67.5%     -   99s
H    0     0                    27016.743849 44192.0044  63.6%     -  100s
     0     0 44188.3054    0  395 27016.7438 44188.3054  63.6%     -  100s
     0     0 44183.1795    0  403 27016.7438 44183.1795  63.5%     -  100s
     0     0 44181.7954    0  406 27016.7438 44181.7954  63.5%     -  101s
     0     0 44171.7337    0  395 27016.7438 44171.7337  63.5%     -  102s
H    0     0                    27118.675314 44171.6023  62.9%     -  103s
     0     0 44171.3271    0  394 27118.6753 44171.3271  62.9%     -  103s
     0     0 44170.0781    0  394 27118.6753 44170.0781  62.9%     -  104s
     0     0 44168.8371    0  394 27118.6753 44168.8371  62.9%     -  105s
     0     0 44159.1668    0  391 27118.6753 44159.1668  62.8%     -  105s
     0     0 44155.8415    0  384 27118.6753 44155.8415  62.8%     -  106s
     0     0 44155.2474    0  397 27118.6753 44155.2474  62.8%     -  106s
     0     0 44153.7703    0  393 27118.6753 44153.7703  62.8%     -  107s
     0     0 44152.7469    0  393 27118.6753 44152.7469  62.8%     -  107s
     0     2 44152.7469    0  393 27118.6753 44152.7469  62.8%     -  120s
     3     8 43805.2130    2  369 27118.6753 44062.4601  62.5%  3082  130s
     7    16 43634.6348    3  390 27118.6753 43801.4389  61.5%  4454  135s
    15    32 43512.3377    4  387 27118.6753 43633.5878  60.9%  4267  141s
    31    54 40916.9251    5  346 27118.6753 43512.2218  60.5%  5504  181s
    53    86 41869.5740    6  373 27118.6753 43512.1951  60.5%  5954  189s
H   56    86                    27121.490728 43512.1951  60.4%  5841  189s
H   83    86                    27125.048369 43512.1951  60.4%  4642  189s
    85   210 41574.3052    7  358 27125.0484 43512.1951  60.4%  4594  206s
   209   312 41504.1307    8  369 27125.0484 43512.1951  60.4%  2660  214s
H  222   312                    27125.470448 43512.1951  60.4%  2560  214s
   311   404 41182.7876   10  372 27125.4704 43512.1951  60.4%  2432  221s
   403   476 41307.4437   10  349 27125.4704 43512.1951  60.4%  2213  230s
H  423   476                    27145.760346 43512.1951  60.3%  2203  230s
   475   568 41096.7398   11  387 27145.7603 43512.1951  60.3%  2151  236s
   569   665 40986.7938   11  370 27145.7603 43512.1951  60.3%  2006  242s
   666   765 41014.2422   11  344 27145.7603 43512.1951  60.3%  1853  248s
   766   813 40289.5171   11  356 27145.7603 43512.1951  60.3%  1741  254s
   853   887 41242.5845   11  345 27145.7603 43512.1951  60.3%  1668  261s
   943   945 40783.7390   12  375 27145.7603 43512.1951  60.3%  1629  269s
   972   945 38764.4330   17  251 27145.7603 43512.1951  60.3%  1612  270s
  1025   997 41096.7188   12  363 27145.7603 43334.5596  59.6%  1623  278s
  1091  1047 40969.9854   12  385 27145.7603 43334.3165  59.6%  1609  283s
  1167  1103 40611.0044   12  342 27145.7603 43334.3165  59.6%  1595  292s
  1253  1171 40742.6512   12  301 27145.7603 43334.3165  59.6%  1584  298s
  1343  1243 36352.3060   13  370 27145.7603 43334.3165  59.6%  1557  306s
  1444  1275 40382.7421   13  375 27145.7603 43323.7928  59.6%  1533  311s
  1476  1335 36380.3931   13  369 27145.7603 43323.7928  59.6%  1537  319s
  1554  1404 39658.1651   14  357 27145.7603 42779.1651  57.6%  1518  324s
  1639  1489 39297.5045   15  321 27145.7603 42603.3585  56.9%  1498  334s
  1744  1598 38806.3371   16  313 27145.7603 42603.3585  56.9%  1486  342s
  1891  1730 36663.3522   15  334 27145.7603 42603.3585  56.9%  1451  349s
  2064  1885 38673.3725   17  296 27145.7603 42603.3585  56.9%  1399  358s
  2279  2025 38019.6226   20  257 27145.7603 42603.3585  56.9%  1338  365s
  2502  2095 36700.1173   29  154 27145.7603 41913.6576  54.4%  1280  372s
  2612  2162 36961.7538   28  209 27145.7603 41913.6576  54.4%  1263  383s
  2721  2259 36178.1118   29  167 27145.7603 41909.8779  54.4%  1267  395s
  2854  2345 31873.6403   29  193 27145.7603 41909.8779  54.4%  1281  402s
  2968  2472 32882.4651   32  183 27145.7603 41909.8779  54.4%  1295  412s
  3136  2652 32379.3448   33  213 27145.7603 41909.8779  54.4%  1293  423s
  3366  2884 29451.4062   37  167 27145.7603 41676.2758  53.5%  1263  432s
  3651  2885 29518.5384   21  393 27145.7603 41624.5132  53.3%  1226  453s
  3653  2886 31513.7893   17   69 27145.7603 41624.5132  53.3%  1225  466s
  3654  2887 35280.0282   30  280 27145.7603 41624.5132  53.3%  1225  476s
  3655  2888 34207.4074   38  290 27145.7603 41624.5132  53.3%  1225  481s
  3656  2888 31129.7521   17  358 27145.7603 41624.5132  53.3%  1224  486s
  3657  2889 34235.9119   27  359 27145.7603 41624.5132  53.3%  1224  490s
  3660  2891 32038.2613   25  373 27145.7603 41624.5132  53.3%  1223  496s
  3663  2893 31577.3758   39  390 27145.7603 41624.5132  53.3%  1222  500s
  3667  2896 41201.8402    8  375 27145.7603 41624.5132  53.3%  1221  505s
  3670  2898 29601.0176   79  398 27145.7603 41624.5132  53.3%  1220  512s
  3672  2899 37881.4483   27  402 27145.7603 41624.5132  53.3%  1219  515s
  3674  2900 37381.8707   23  397 27145.7603 41624.5132  53.3%  1218  520s
  3677  2902 30632.1053   58  458 27145.7603 41624.5132  53.3%  1217  525s
  3680  2904 32811.0957   37  474 27145.7603 41624.5132  53.3%  1216  530s
  3682  2906 38268.3590   27  441 27145.7603 41624.5132  53.3%  1216  546s
  3683  2906 31536.5100   44  441 27145.7603 41624.5132  53.3%  1215  566s
  3684  2910 41624.5132   12  437 27145.7603 41624.5132  53.3%  1238  575s
  3686  2913 41624.5132   13  426 27145.7603 41624.5132  53.3%  1239  584s
  3690  2920 41624.5132   14  427 27145.7603 41624.5132  53.3%  1240  592s
  3698  2933 41624.5132   15  367 27145.7603 41624.5132  53.3%  1251  605s
  3714  2946 41624.5132   16  359 27145.7603 41624.5132  53.3%  1281  623s
  3732  2972 39378.5202   17  445 27145.7603 41624.5132  53.3%  1302  633s
  3764  3013 29390.1613   18  340 27145.7603 41624.5132  53.3%  1339  649s
  3843  3041 27659.2870   21  331 27145.7603 41624.5132  53.3%  1452  665s
  3923  3050     cutoff   20      27145.7603 41624.5132  53.3%  1491  675s
  4016  3035     cutoff   22      27145.7603 41624.5132  53.3%  1509  684s
  4060  3051 30492.7719   17  312 27145.7603 41624.5132  53.3%  1526  695s
  4131  3049     cutoff   18      27145.7603 41624.5132  53.3%  1540  703s
  4208  3076 37522.3687   18  410 27145.7603 41624.5132  53.3%  1550  714s
  4282  3068 37336.3664   19  417 27145.7603 41624.5132  53.3%  1561  720s
  4333  3084 35983.1577   19  325 27145.7603 41624.5132  53.3%  1562  729s
  4412  3111 37087.0232   20  366 27145.7603 41624.5132  53.3%  1571  738s
H 4462  2949                    27180.505070 41624.5132  53.1%  1574  738s
  4482  2986 37018.6303   21  360 27180.5051 41624.5132  53.1%  1575  745s
  4560  3002 33706.8832   22  352 27180.5051 41624.5132  53.1%  1579  755s
  4636  3035 31738.9765   23  347 27180.5051 41624.5132  53.1%  1584  763s
  4724  3039 33141.0408   22  307 27180.5051 41065.0795  51.1%  1587  770s
H 4739  2895                    27240.456006 41065.0795  50.8%  1586  770s
  4781  2946 31236.8960   24  344 27240.4560 41065.0795  50.8%  1588  779s
  4893  2947 33256.3359   23  380 27240.4560 41065.0795  50.8%  1583  788s
  5009  2957 29752.4546   26  301 27240.4560 40896.2403  50.1%  1578  800s
  5103  2969     cutoff   26      27240.4560 40708.2183  49.4%  1580  809s
  5221  2994     cutoff   29      27240.4560 40620.8318  49.1%  1582  818s
  5324  2978     cutoff   30      27240.4560 40620.8318  49.1%  1586  825s
H 5360  2834                    28455.239615 40620.8318  42.8%  1588  825s
  5366  2853     cutoff   31      28455.2396 40620.8318  42.8%  1589  836s
H 5417  2711                    28487.116100 40620.8318  42.6%  1591  836s
H 5434  2588                    28539.370241 40620.8318  42.3%  1590  836s
H 5441  2472                    28831.926077 40620.8318  40.9%  1591  836s
  5483  2498 37311.1221   20  413 28831.9261 40620.8318  40.9%  1590  847s
  5617  2496 36987.0595   21  380 28831.9261 40620.8318  40.9%  1590  858s
H 5624  2386                    28913.437060 40620.8318  40.5%  1590  858s
  5719  2406 33491.7054   22  275 28913.4371 40620.8318  40.5%  1600  870s
  5833  2414 34138.5753   22  292 28913.4371 40330.1898  39.5%  1611  882s
  5954  2395 29573.4421   23  309 28913.4371 40330.1898  39.5%  1622  894s
H 5977  2286                    28945.309007 40330.1898  39.3%  1622  894s
H 6037  2190                    28983.225798 39833.8079  37.4%  1624  904s
H 6073  2086                    29088.763452 39833.8079  36.9%  1627  904s
H 6081  1996                    29127.019006 39833.8079  36.8%  1628  904s
  6116  2026 35341.3912   23  333 29127.0190 39466.8483  35.5%  1627  917s
  6240  2036 31394.3353   26  208 29127.0190 39322.0320  35.0%  1638  931s
  6406  2014 32178.7619   22  346 29127.0190 39322.0320  35.0%  1643  944s
  6580  1980 32153.4278   23  344 29127.0190 39225.6539  34.7%  1645  957s
  6751  1976     cutoff   27      29127.0190 39225.6539  34.7%  1652  971s
  6910  1944 29989.0717   21  349 29127.0190 38796.7908  33.2%  1664  987s
  7109  1903 33998.0164   21  291 29127.0190 38796.7908  33.2%  1670  998s
  7149  1934     cutoff   22      29127.0190 38640.1609  32.7%  1675 1010s
  7213  1990 33216.8729   22  251 29127.0190 38640.1609  32.7%  1679 1025s
  7391  1951 35389.1591   20  323 29127.0190 38303.7066  31.5%  1686 1040s
  7610  1940 32145.2161   24  281 29127.0190 38303.7066  31.5%  1691 1056s
  7816  1924     cutoff   31      29127.0190 38235.6877  31.3%  1699 1074s
  8034  1891 29201.2235   27  153 29127.0190 37792.0095  29.7%  1705 1089s
  8278  1876 32482.9165   24  362 29127.0190 37576.5138  29.0%  1708 1107s
  8551  1815 29425.9465   27  236 29127.0190 37463.0641  28.6%  1710 1124s
  8842  1837 30530.3682   25  230 29127.0190 37402.4381  28.4%  1708 1144s
  9159  1897 32365.2604   21  285 29127.0190 37083.5711  27.3%  1706 1163s
  9476  1937     cutoff   22      29127.0190 36825.4633  26.4%  1705 1182s
  9803  1950 29380.8239   24  209 29127.0190 36825.4633  26.4%  1707 1201s
H 9825  1920                    29344.074356 36825.4633  25.5%  1706 1201s
  9857  1940     cutoff   25      29344.0744 36786.5862  25.4%  1707 1221s
 10237  2000 32048.2257   23  310 29344.0744 36704.9141  25.1%  1702 1245s
 10604  2039 infeasible   27      29344.0744 36342.7305  23.9%  1704 1266s
 11006  2119 32452.7811   26  233 29344.0744 36182.9730  23.3%  1702 1291s
 11426  2213 32556.2986   24  334 29344.0744 36054.0796  22.9%  1701 1313s
H11463  2193                    29488.922664 36054.0796  22.3%  1697 1313s
 11928  2154     cutoff   26      29488.9227 35980.9898  22.0%  1688 1337s
 12398  2153     cutoff   24      29488.9227 35699.2643  21.1%  1689 1362s
 12853  2121     cutoff   27      29488.9227 35659.4799  20.9%  1694 1387s
 13318  2111     cutoff   25      29488.9227 35258.8304  19.6%  1698 1414s
 13806  2079 infeasible   25      29488.9227 35191.5718  19.3%  1703 1443s
 14392  2044 infeasible   27      29488.9227 34905.4309  18.4%  1701 1472s
 14869  1980     cutoff   29      29488.9227 34499.4830  17.0%  1713 1502s
 15418  1946 29820.2237   25  221 29488.9227 34264.9329  16.2%  1717 1532s
H15432  1885                    29635.592311 34264.9329  15.6%  1717 1532s
H15510  1849                    29753.333226 34264.9329  15.2%  1716 1532s
 15966  1681 31774.7844   28  250 29753.3332 34168.7586  14.8%  1711 1565s
 16592  1502     cutoff   25      29753.3332 33606.2931  12.9%  1713 1599s
 17300  1206     cutoff   27      29753.3332 33197.4223  11.6%  1708 1632s
 18106   575 29955.2380   31  190 29753.3332 32691.6838  9.88%  1697 1663s
 19704   712     cutoff   29      29753.3332 31724.1403  6.62%  1616 1675s
 22383  1669 30057.8706   69   46 29753.3332 30528.6130  2.61%  1437 1680s
 26127  3117 29940.1351   70   30 29753.3332 30220.8328  1.57%  1240 1685s
*29215  3117             110    29793.342549 30160.1303  1.23%  1113 1685s
 30639  3037     cutoff   87      29793.3425 30046.3873  0.85%  1063 1693s
*31108  2909              97    29799.366658 30046.3873  0.83%  1048 1693s
*36564  2162             100    29822.467783 29936.0485  0.38%   898 1694s
 37334  1794     cutoff   97      29822.4678 29912.6940  0.30%   880 1697s
 39732   709 29851.4398   78   20 29822.4678 29886.2723  0.21%   829 1701s
*41686   300             103    29825.973872 29872.7881  0.16%   791 1702s

Cutting planes:
  Learned: 1
  MIR: 925
  Flow cover: 1305
  RLT: 12
  Relax-and-lift: 113

Explored 42092 nodes (33121941 simplex iterations) in 1703.36 seconds (3381.63 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 29826 29826 29822.5 ... 29127

Optimal solution found (tolerance 1.00e-04)
Best objective 2.982597387193e+04, best bound 2.982597387193e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1703.40s
  Master Objective (UB) = 29825.97, θ = 178947.71
  Upper Bound (UB) = 29825.97

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 178947.71
  [DEBUG]   ✓ Scenario 0: θ = 178947.71 ≤ Q = 181527.48 (slack: 2579.77)
  [DEBUG]   ✓ Scenario 1: θ = 178947.71 ≤ Q = 178958.79 (slack: 11.08)
  [DEBUG]   ✓ Scenario 2: θ = 178947.71 ≤ Q = 178947.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 178947.71 ≤ Q = 178947.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 178947.71 ≤ Q = 178947.71 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x36c7b634
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x36c7b634
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.353583e+13
Presolve removed 2631 rows and 1922 columns
Presolve time: 0.01s
Presolved: 462 rows, 467 columns, 1303 nonzeros
Found heuristic solution: objective 6264554.2475
Variable types: 316 continuous, 151 integer (151 binary)
Found heuristic solution: objective 6264224.9032

Root relaxation: objective -1.575265e+05, 231 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -157526.52    0  124 6264224.90 -157526.52   103%     -    0s
H    0     0                    -119348.9981 -157526.52  32.0%     -    0s
H    0     0                    -130923.1231 -157526.52  20.3%     -    0s
H    0     0                    -133651.0457 -144090.12  7.81%     -    0s
     0     0 -144090.12    0   64 -133651.05 -144090.12  7.81%     -    0s
H    0     0                    -141558.2672 -143976.84  1.71%     -    0s
H    0     0                    -141859.7831 -143976.84  1.49%     -    0s
H    0     0                    -142002.1859 -143976.84  1.39%     -    0s
H    0     0                    -142303.7017 -143976.84  1.18%     -    0s
     0     0 -143543.42    0   78 -142303.70 -143543.42  0.87%     -    0s
     0     0 -143059.80    0   41 -142303.70 -143059.80  0.53%     -    0s
H    0     0                    -142309.7001 -143051.45  0.52%     -    0s
     0     0 -142915.45    0   31 -142309.70 -142915.45  0.43%     -    0s
     0     0 -142915.45    0   31 -142309.70 -142915.45  0.43%     -    0s
     0     0 -142864.36    0   32 -142309.70 -142864.36  0.39%     -    0s
     0     0 -142850.97    0   32 -142309.70 -142850.97  0.38%     -    0s
     0     0 -142729.45    0   42 -142309.70 -142729.45  0.29%     -    0s
     0     0 -142682.84    0   39 -142309.70 -142682.84  0.26%     -    0s
     0     0 -142677.50    0   39 -142309.70 -142677.50  0.26%     -    0s
     0     0 -142528.93    0   23 -142309.70 -142528.93  0.15%     -    0s
     0     0 -142528.89    0   22 -142309.70 -142528.89  0.15%     -    0s
     0     0 -142485.61    0   26 -142309.70 -142485.61  0.12%     -    0s
     0     0 -142482.44    0   27 -142309.70 -142482.44  0.12%     -    0s
     0     0 -142366.50    0   11 -142309.70 -142366.50  0.04%     -    0s
     0     0 -142343.36    0   11 -142309.70 -142343.36  0.02%     -    0s
     0     0 -142335.42    0    7 -142309.70 -142335.42  0.02%     -    0s
     0     0          -    0      -142309.70 -142321.62  0.01%     -    0s

Cutting planes:
  Gomory: 1
  Implied bound: 2
  MIR: 1
  Flow cover: 3
  RLT: 1

Explored 1 nodes (810 simplex iterations) in 0.11 seconds (0.05 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -142310 -142304 -142155 ... 1.35358e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.423097000587e+05, best bound -1.423216191167e+05, gap 0.0084%
  Subproblem solved in 0.13s
  Worst-case operational profit (Z_SP) = 160722.14
  Scenario: 30 demand increases, 30 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -142309.70
  [DEBUG]   S×d_nominal = 303031.84
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 303031.84 + -142309.70 = 160722.14
  [DEBUG]   Current θ from Master = 178947.71
  [DEBUG]   ⚠️  Z_SP ≤ θ by 18225.57 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 11600.40
  Lower Bound (LB) = 23913.83
  Gap (UB-LB) = 5912.1479, Absolute Gap = 5912.1479, Relative Gap = 0.198221
  Not converged yet (gap = 5912.15 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 30 increases, 30 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 264833 nonzeros
Model fingerprint: 0x67e3751a
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 44844 rows and 18204 columns
Presolve time: 1.56s
Presolved: 48279 rows, 21496 columns, 299339 nonzeros
Variable types: 19237 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -310053.6270
Found heuristic solution: objective -171254.7355

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 48279 rows, 21496 columns, 299339 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   23055   -7.7440505e+04   0.000000e+00   1.195686e+07      5s
   37377    1.4346604e+04   0.000000e+00   5.090775e+06     10s
   47443    3.5749452e+04   0.000000e+00   4.071839e+08     15s
   56604    4.0560104e+04   0.000000e+00   4.601938e+07     20s
Concurrent spin time: 0.37s

Solved with dual simplex

Root relaxation: objective 5.717431e+04, 29415 iterations, 19.25 seconds (25.26 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 57174.3054    0   69 -171254.74 57174.3054   133%     -   21s
H    0     0                    -167277.2488 57174.3054   134%     -   21s
H    0     0                    -89736.19090 57174.3054   164%     -   23s
H    0     0                    -17238.51640 57174.3054   432%     -   23s
H    0     0                    -4143.500179 57174.3054  1480%     -   23s
H    0     0                    -2275.298911 57174.3054  2613%     -   23s
H    0     0                    -2149.851213 57174.3054  2759%     -   23s
H    0     0                    -359.2282752 57174.3054      -     -   24s
H    0     0                    6387.0488743 57174.3054   795%     -   24s
H    0     0                    9503.9787063 57174.3054   502%     -   24s
H    0     0                    11784.549153 57174.3054   385%     -   24s
H    0     0                    12374.718360 57174.3054   362%     -   25s
     0     0 52305.8516    0  178 12374.7184 52305.8516   323%     -   32s
H    0     0                    12402.415070 52305.8516   322%     -   32s
H    0     0                    12514.274858 52305.8516   318%     -   32s
     0     0 52305.8516    0  189 12514.2749 52305.8516   318%     -   35s
     0     0 49346.2758    0  183 12514.2749 49346.2758   294%     -   35s
H    0     0                    13542.558373 49346.2758   264%     -   35s
     0     0 49346.2758    0  184 13542.5584 49346.2758   264%     -   35s
H    0     0                    14887.160657 49346.2758   231%     -   36s
H    0     0                    14946.259484 49346.2758   230%     -   36s
H    0     0                    15576.094179 49329.0681   217%     -   43s
H    0     0                    15580.525781 49329.0681   217%     -   44s
H    0     0                    16419.591994 49329.0681   200%     -   44s
     0     0 49329.0681    0  195 16419.5920 49329.0681   200%     -   44s
H    0     0                    18308.042895 49329.0293   169%     -   44s
H    0     0                    18596.078087 49329.0293   165%     -   44s
H    0     0                    18931.224184 49329.0293   161%     -   44s
H    0     0                    19312.839875 49329.0293   155%     -   44s
H    0     0                    19338.103756 49329.0293   155%     -   44s
H    0     0                    20094.594741 49329.0293   145%     -   44s
H    0     0                    20111.084756 49329.0293   145%     -   44s
     0     0 48781.1694    0  240 20111.0848 48781.1694   143%     -   47s
     0     0 48738.5200    0  249 20111.0848 48738.5200   142%     -   49s
     0     0 48690.2554    0  247 20111.0848 48690.2554   142%     -   49s
     0     0 48688.3543    0  243 20111.0848 48688.3543   142%     -   50s
     0     0 48688.0092    0  247 20111.0848 48688.0092   142%     -   50s
     0     0 46672.3492    0  308 20111.0848 46672.3492   132%     -   62s
H    0     0                    20417.230552 46671.3612   129%     -   62s
H    0     0                    20677.888851 46671.3612   126%     -   62s
     0     0 46171.8737    0  316 20677.8889 46171.8737   123%     -   66s
     0     0 45972.4770    0  310 20677.8889 45972.4770   122%     -   69s
H    0     0                    21095.058286 45863.5790   117%     -   71s
H    0     0                    22611.399964 45863.5790   103%     -   71s
     0     0 45863.5790    0  306 22611.4000 45863.5790   103%     -   71s
     0     0 45738.7005    0  322 22611.4000 45738.7005   102%     -   74s
     0     0 45695.5515    0  322 22611.4000 45695.5515   102%     -   75s
     0     0 45683.6033    0  322 22611.4000 45683.6033   102%     -   76s
     0     0 45680.8534    0  328 22611.4000 45680.8534   102%     -   77s
     0     0 45674.0264    0  326 22611.4000 45674.0264   102%     -   77s
     0     0 45672.8954    0  326 22611.4000 45672.8954   102%     -   78s
     0     0 44983.0689    0  370 22611.4000 44983.0689  98.9%     -   85s
H    0     0                    22901.465405 44979.6472  96.4%     -   85s
H    0     0                    22917.955420 44979.6472  96.3%     -   85s
     0     0 44802.3647    0  370 22917.9554 44802.3647  95.5%     -   88s
H    0     0                    23850.176121 44749.1561  87.6%     -   90s
H    0     0                    23878.018808 44749.1561  87.4%     -   90s
     0     0 44749.1561    0  364 23878.0188 44749.1561  87.4%     -   90s
     0     0 44695.3347    0  396 23878.0188 44695.3347  87.2%     -   92s
     0     0 44659.5054    0  372 23878.0188 44659.5054  87.0%     -   93s
     0     0 44635.6602    0  369 23878.0188 44635.6602  86.9%     -   94s
H    0     0                    23970.136274 44619.8598  86.1%     -   95s
     0     0 44619.8598    0  406 23970.1363 44619.8598  86.1%     -   95s
     0     0 44609.6257    0  375 23970.1363 44609.6257  86.1%     -   95s
     0     0 44603.3002    0  374 23970.1363 44603.3002  86.1%     -   96s
     0     0 44595.1930    0  376 23970.1363 44595.1930  86.0%     -   97s
     0     0 44591.2326    0  376 23970.1363 44591.2326  86.0%     -   97s
     0     0 44589.3914    0  372 23970.1363 44589.3914  86.0%     -   98s
     0     0 44584.4381    0  376 23970.1363 44584.4381  86.0%     -   98s
     0     0 44581.0720    0  377 23970.1363 44581.0720  86.0%     -   98s
     0     0 44578.5542    0  385 23970.1363 44578.5542  86.0%     -   98s
     0     0 44576.8808    0  385 23970.1363 44576.8808  86.0%     -   99s
     0     0 44576.7895    0  385 23970.1363 44576.7895  86.0%     -   99s
     0     0 44461.0314    0  419 23970.1363 44461.0314  85.5%     -  103s
H    0     0                    24888.349126 44460.7113  78.6%     -  103s
H    0     0                    24929.122553 44460.7113  78.3%     -  103s
H    0     0                    25004.076248 44460.7113  77.8%     -  103s
     0     0 44416.9251    0  417 25004.0762 44416.9251  77.6%     -  105s
     0     0 44410.2731    0  423 25004.0762 44410.2731  77.6%     -  106s
     0     0 44408.3832    0  428 25004.0762 44408.3832  77.6%     -  106s
     0     0 44407.7753    0  427 25004.0762 44407.7753  77.6%     -  106s
     0     0 44295.7965    0  385 25004.0762 44295.7965  77.2%     -  109s
H    0     0                    25813.179304 44295.3160  71.6%     -  110s
H    0     0                    26051.574588 44295.3160  70.0%     -  110s
H    0     0                    26239.274250 44295.3160  68.8%     -  110s
     0     0 44257.2696    0  391 26239.2742 44257.2696  68.7%     -  111s
     0     0 44252.0660    0  390 26239.2742 44252.0660  68.6%     -  112s
     0     0 44247.8952    0  392 26239.2742 44247.8952  68.6%     -  112s
     0     0 44245.8131    0  391 26239.2742 44245.8131  68.6%     -  112s
     0     0 44245.3906    0  392 26239.2742 44245.3906  68.6%     -  112s
     0     0 44208.6753    0  395 26239.2742 44208.6753  68.5%     -  114s
     0     0 44198.6853    0  399 26239.2742 44198.6853  68.4%     -  115s
     0     0 44192.5534    0  409 26239.2742 44192.5534  68.4%     -  115s
     0     0 44189.8848    0  409 26239.2742 44189.8848  68.4%     -  115s
     0     0 44189.0787    0  415 26239.2742 44189.0787  68.4%     -  115s
     0     0 44173.6869    0  404 26239.2742 44173.6869  68.3%     -  117s
H    0     0                    26538.688330 44171.7995  66.4%     -  117s
     0     0 44156.9060    0  403 26538.6883 44156.9060  66.4%     -  118s
     0     0 44155.5658    0  409 26538.6883 44155.5658  66.4%     -  118s
     0     0 44146.9055    0  395 26538.6883 44146.9055  66.3%     -  119s
     0     0 44144.2820    0  408 26538.6883 44144.2820  66.3%     -  119s
     0     0 44143.3946    0  400 26538.6883 44143.3946  66.3%     -  119s
     0     0 44141.9892    0  404 26538.6883 44141.9892  66.3%     -  120s
H    0     0                    26546.417261 44141.9159  66.3%     -  121s
     0     0 44141.5217    0  404 26546.4173 44141.5217  66.3%     -  121s
     0     0 44140.5922    0  414 26546.4173 44140.5922  66.3%     -  122s
     0     0 44139.7818    0  411 26546.4173 44139.7818  66.3%     -  122s
     0     0 44139.7818    0  411 26546.4173 44139.7818  66.3%     -  123s
     0     0 44138.5416    0  411 26546.4173 44138.5416  66.3%     -  124s
H    0     2                    26902.937663 44138.5416  64.1%     -  154s
     0     2 44138.5416    0  411 26902.9377 44138.5416  64.1%     -  154s
     1     4 44069.7778    1  398 26902.9377 44138.5416  64.1%  1235  159s
     3     8 43994.0174    2  393 26902.9377 44068.9068  63.8%  3536  163s
     7    16 43542.8757    3  403 26902.9377 43989.4839  63.5%  4424  171s
    15    32 43319.3189    4  413 26902.9377 43542.2655  61.8%  5778  178s
    31    49 41372.5284    5  346 26902.9377 43318.7768  61.0%  7523  193s
    48    81 41708.6692    6  389 26902.9377 43318.7768  61.0%  6620  202s
H   66    81                    26940.618830 43318.7768  60.8%  6008  202s
H   71    81                    26941.040910 43318.7768  60.8%  5661  202s
    80   145 41615.9936    7  372 26941.0409 43318.7768  60.8%  5230  213s
   144   254 41442.4027    9  365 26941.0409 43318.7768  60.8%  3764  223s
H  162   254                    27048.684108 43318.7768  60.2%  3560  223s
   253   338 41357.0551   10  360 27048.6841 43318.7768  60.2%  3138  232s
   337   425 41184.9012    9  366 27048.6841 43318.7768  60.2%  2914  239s
   424   501 41202.2432   11  359 27048.6841 43318.7768  60.2%  2746  246s
   532   570 39617.0080   11  352 27048.6841 43318.7768  60.2%  2579  254s
   573   600 39372.1069   11  348 27048.6841 43318.7768  60.2%  2530  264s
   605   639 40803.0773   10  362 27048.6841 43318.7768  60.2%  2470  271s
   644   708 40057.5116   12  348 27048.6841 43318.7768  60.2%  2421  277s
   713   791 39813.9682   12  343 27048.6841 43318.7768  60.2%  2299  282s
   802   831 38591.8434   12  327 27048.6841 43318.7768  60.2%  2150  290s
   886   879 39887.0838   13  352 27048.6841 43132.1299  59.5%  2078  297s
   951   912 39707.8868   13  346 27048.6841 43123.3469  59.4%  2080  305s
  1027   976 38556.7522   12  320 27048.6841 43123.3469  59.4%  2061  315s
  1109  1050 37780.1957   12  362 27048.6841 43123.3469  59.4%  2053  324s
H 1164  1050                    27090.028530 43123.3469  59.2%  2037  324s
  1214  1147 39564.7888   14  341 27090.0285 43123.3469  59.2%  2007  336s
  1327  1184 36610.3919   14  337 27090.0285 43123.3469  59.2%  1951  345s
  1436  1234 36297.7834   14  343 27090.0285 42784.2861  57.9%  1941  355s
  1518  1293 38325.0688   13  328 27090.0285 42784.2861  57.9%  1970  366s
  1609  1359 38051.1050   13  314 27090.0285 42784.2861  57.9%  1983  378s
  1693  1448 38990.3887   15  337 27090.0285 42784.2861  57.9%  2008  387s
  1802  1573 37643.6722   15  302 27090.0285 42784.2861  57.9%  1989  397s
  1945  1675 39104.1813   15  344 27090.0285 42784.2861  57.9%  1947  409s
  2117  1780 36116.0825   15  323 27090.0285 42784.2861  57.9%  1882  422s
  2262  1894 36974.4391   16  328 27090.0285 42784.2861  57.9%  1876  434s
  2436  2001 35836.7176   15  331 27090.0285 42784.2861  57.9%  1842  448s
  2617  2120 38518.5944   17  321 27090.0285 42478.5438  56.8%  1805  461s
  2813  2235 34071.9927   18  337 27090.0285 42477.3415  56.8%  1760  472s
  2996  2346 34872.9406   17  336 27090.0285 42477.3415  56.8%  1735  483s
H 3152  2280                    28298.916719 42265.5120  49.4%  1716  493s
  3222  2440 34753.5456   21  267 28298.9167 42265.5120  49.4%  1710  505s
H 3416  2308                    28829.926447 42265.5120  46.6%  1689  514s
H 3424  2261                    29031.829192 42265.5120  45.6%  1690  514s
  3454  2424 32272.7181   22  251 29031.8292 42265.5120  45.6%  1696  526s
H 3701  2415                    29057.230466 42265.5120  45.5%  1653  531s
  3702  2416 40505.9571   11  411 29057.2305 42265.5120  45.5%  1653  564s
  3704  2417 33180.0467   24   69 29057.2305 42265.5120  45.5%  1652  592s
  3705  2418 41412.2061    8  282 29057.2305 42265.5120  45.5%  1651  607s
  3706  2419 37229.5983   16  350 29057.2305 42265.5120  45.5%  1651  616s
  3707  2419 39121.5603   12  397 29057.2305 42265.5120  45.5%  1651  624s
  3708  2420 41271.4444   13  384 29057.2305 42265.5120  45.5%  1650  631s
  3709  2421 37243.5909   17  422 29057.2305 42265.5120  45.5%  1650  636s
  3711  2422 35855.1082   26  401 29057.2305 42265.5120  45.5%  1649  641s
  3714  2424 36794.5745   27  409 29057.2305 42265.5120  45.5%  1647  645s
  3716  2425 29749.3433   47  394 29057.2305 42265.5120  45.5%  1647  650s
  3718  2427 31093.7761   30  419 29057.2305 42265.5120  45.5%  1646  655s
  3720  2428 40625.1114    8  398 29057.2305 42265.5120  45.5%  1645  660s
  3722  2429 39462.0074    9  412 29057.2305 42265.5120  45.5%  1644  665s
  3724  2431 32500.4245   25  438 29057.2305 42265.5120  45.5%  1643  671s
  3726  2432 34621.1233   17  391 29057.2305 42265.5120  45.5%  1642  675s
  3728  2433 32327.4104   29  394 29057.2305 42265.5120  45.5%  1641  681s
  3730  2435 38766.2015   29  400 29057.2305 42265.5120  45.5%  1640  685s
  3732  2436 40282.0815   12  444 29057.2305 42265.5120  45.5%  1639  690s
  3733  2437 33089.1729   22  444 29057.2305 42265.5120  45.5%  1639  717s
  3734  2437 30912.0519   57  444 29057.2305 42265.5120  45.5%  1639  736s
  3735  2441 42265.5120   12  385 29057.2305 42265.5120  45.5%  1672  751s
  3737  2444 42265.5120   13  391 29057.2305 42265.5120  45.5%  1674  769s
  3741  2451 42265.5120   14  382 29057.2305 42265.5120  45.5%  1677  784s
  3749  2464 42265.5120   15  420 29057.2305 42265.5120  45.5%  1691  805s
  3765  2476 36718.8721   16  279 29057.2305 42265.5120  45.5%  1738  832s
  3782  2502 38090.0736   17  357 29057.2305 42265.5120  45.5%  1770  848s
H 3786  2378                    29100.801715 42265.5120  45.2%  1778  848s
  3814  2472 37586.4531   18  348 29100.8017 42265.5120  45.2%  1795  868s
  3928  2480 36517.4409   21  327 29100.8017 42265.5120  45.2%  1839  881s
  3989  2501 32573.0564   20  297 29100.8017 42265.5120  45.2%  1870  897s
  4079  2496 35324.1936   19  300 29100.8017 42265.5120  45.2%  1883  908s
  4117  2512 35864.7334   22  323 29100.8017 42265.5120  45.2%  1894  919s
  4155  2532 29915.0862   21  324 29100.8017 42265.5120  45.2%  1905  929s
  4227  2538 33660.0538   22  326 29100.8017 42265.5120  45.2%  1906  941s
  4286  2554 35423.2516   23  308 29100.8017 42265.5120  45.2%  1907  953s
  4364  2562 34294.4073   25  294 29100.8017 42265.5120  45.2%  1909  961s
  4420  2581 34149.9560   26  251 29100.8017 42265.5120  45.2%  1913  971s
  4480  2596 33770.5043   28  258 29100.8017 40538.2621  39.3%  1921  982s
  4544  2586 33710.8151   29  255 29100.8017 40538.2621  39.3%  1928  994s
  4615  2589 33390.0948   28  217 29100.8017 40538.2621  39.3%  1933 1006s
  4685  2594 32987.7034   30  234 29100.8017 40538.2621  39.3%  1940 1015s
  4727  2598 33386.4714   30  257 29100.8017 40538.2621  39.3%  1953 1024s
  4778  2600     cutoff   29      29100.8017 40250.2313  38.3%  1959 1036s
  4845  2609 32138.9291   31  198 29100.8017 40148.1674  38.0%  1966 1049s
  4920  2608 31556.5340   33  158 29100.8017 40077.2794  37.7%  1976 1060s
  5006  2601     cutoff   37      29100.8017 40077.2794  37.7%  1984 1074s
  5095  2599 29646.1267   37  137 29100.8017 40077.2794  37.7%  1996 1089s
  5189  2597 infeasible   37      29100.8017 40077.2794  37.7%  2008 1102s
  5280  2594     cutoff   19      29100.8017 40077.2794  37.7%  2026 1115s
  5373  2577 34606.0431   20  317 29100.8017 39488.5499  35.7%  2038 1129s
  5418  2577 34563.5233   21  309 29100.8017 39488.5499  35.7%  2044 1145s
  5471  2581 32024.5614   22  316 29100.8017 39488.5499  35.7%  2057 1155s
  5509  2586 30642.2302   23  307 29100.8017 39488.5499  35.7%  2065 1169s
  5555  2592 30007.7317   24  288 29100.8017 39488.5499  35.7%  2071 1179s
  5594  2586 29529.1093   25  235 29100.8017 38862.0095  33.5%  2078 1194s
  5651  2589 29455.0247   26  231 29100.8017 38836.1990  33.5%  2078 1206s
  5697  2605 29338.5128   27  203 29100.8017 38836.1990  33.5%  2085 1218s
  5742  2611 29335.9469   28  203 29100.8017 38531.5739  32.4%  2087 1229s
  5808  2609     cutoff   29      29100.8017 38531.5739  32.4%  2086 1246s
  5878  2607 36313.3609   22  330 29100.8017 38531.5739  32.4%  2090 1262s
H 5928  2474                    29135.791814 38459.7287  32.0%  2091 1262s
  5973  2493 35703.1014   23  284 29135.7918 38459.7287  32.0%  2089 1280s
  6087  2501 30463.8642   24  262 29135.7918 38459.7287  32.0%  2083 1300s
  6225  2484 29759.3635   25  248 29135.7918 38459.7287  32.0%  2089 1320s
  6419  2457 33159.0070   25  237 29135.7918 38260.4114  31.3%  2093 1340s
  6592  2447 30085.3394   27  147 29135.7918 38260.4114  31.3%  2103 1360s
  6777  2445 31790.1220   22  214 29135.7918 37757.9443  29.6%  2117 1380s
  6981  2409 33087.4045   22  307 29135.7918 37757.9443  29.6%  2127 1401s
  7196  2366 31218.2185   24  261 29135.7918 37203.7680  27.7%  2127 1425s
  7416  2337 infeasible   26      29135.7918 36955.7799  26.8%  2136 1446s
  7583  2360     cutoff   24      29135.7918 36554.4450  25.5%  2138 1468s
  7887  2272 33695.6662   28  204 29135.7918 36422.3509  25.0%  2132 1493s
  8129  2203     cutoff   29      29135.7918 36350.5671  24.8%  2147 1522s
  8414  2171     cutoff   31      29135.7918 36112.4585  23.9%  2153 1548s
  8711  2114 29276.0046   21  349 29135.7918 35919.5777  23.3%  2157 1574s
  9022  2076 29387.7374   21  269 29135.7918 35872.2998  23.1%  2160 1601s
  9308  2019 30948.8116   25  236 29135.7918 35742.1133  22.7%  2152 1628s
  9645  1941     cutoff   24      29135.7918 35554.2620  22.0%  2155 1657s
 10006  1872 29271.9152   31  133 29135.7918 35349.3394  21.3%  2157 1687s
 10399  1824     cutoff   19      29135.7918 35300.5721  21.2%  2154 1715s
 10774  1845 29342.6142   29  135 29135.7918 34914.2244  19.8%  2158 1747s
 11191  1883 30815.4477   25  200 29135.7918 34576.4189  18.7%  2158 1779s
 11644  1902     cutoff   25      29135.7918 34441.3117  18.2%  2154 1815s
 12194  1929 29717.0769   31  160 29135.7918 34132.8075  17.2%  2138 1851s
 12761  1917 29142.1274   27  274 29135.7918 34065.5002  16.9%  2121 1890s
 13296  1888 30038.5999   31  126 29135.7918 33784.8296  16.0%  2113 1926s
 13799  1924 30160.5706   27  190 29135.7918 33585.2629  15.3%  2111 1963s
 14477  1892     cutoff   30      29135.7918 33389.1300  14.6%  2089 1999s
 14997  1848     cutoff   27      29135.7918 33105.8520  13.6%  2076 2038s
 15624  1719 30177.8584   27  156 29135.7918 32856.1766  12.8%  2069 2080s
 16349  1646     cutoff   38      29135.7918 32608.7241  11.9%  2056 2124s
 17159  1448 infeasible   34      29135.7918 32259.9944  10.7%  2036 2169s
 18058  1219 29633.8233   30  114 29135.7918 31948.0836  9.65%  2009 2217s
*18963  1219             108    29240.984540 31869.7202  8.99%  1959 2217s
*19205  1219              71    29251.837554 31846.4796  8.87%  1950 2217s
 19423  1841     cutoff   23      29251.8376 31529.1948  7.79%  1938 2250s
H19504  1841                    29289.770903 31529.1948  7.65%  1931 2250s
H19871  1841                    29352.117404 31464.6341  7.20%  1901 2250s
*20312  1841             106    29369.255450 31460.0390  7.12%  1866 2250s
*21182  1841             107    29495.426458 31416.6709  6.51%  1800 2250s
 22492  3327     cutoff  103      29495.4265 30927.5800  4.86%  1712 2265s
*23382  3327             121    29516.112354 30765.6728  4.23%  1650 2265s
H23670  3327                    29727.578421 30715.9747  3.32%  1631 2265s
 26268  2349     cutoff   88      29727.5784 30222.4999  1.66%  1477 2273s
H27983  2349                    29729.724940 30180.0927  1.51%  1390 2273s
*29158  2349             101    29729.816588 30146.9984  1.40%  1336 2273s
*30520  2349             108    29766.339155 30099.7435  1.12%  1279 2273s
 30751  1062     cutoff   79      29766.3392 29986.9844  0.74%  1270 2278s
*30907  1062              95    29782.458172 29986.9844  0.69%  1264 2278s
*31859  1062              91    29791.095136 29969.1297  0.60%  1227 2278s
*32066  1062              92    29814.448098 29969.1297  0.52%  1219 2278s
 35336     0     cutoff   89      29814.4481 29866.2959  0.17%  1110 2280s

Cutting planes:
  MIR: 719
  Mixing: 3
  Flow cover: 1385
  RLT: 11
  Relax-and-lift: 99

Explored 36676 nodes (39371984 simplex iterations) in 2281.13 seconds (4518.95 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 29814.4 29814.4 29791.1 ... 29495.4

Optimal solution found (tolerance 1.00e-04)
Best objective 2.981444809826e+04, best bound 2.981444809826e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2281.18s
  Master Objective (UB) = 29814.45, θ = 179089.56
  Upper Bound (UB) = 29814.45

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 179089.56
  [DEBUG]   ✓ Scenario 0: θ = 179089.56 ≤ Q = 179277.70 (slack: 188.14)
  [DEBUG]   ✓ Scenario 1: θ = 179089.56 ≤ Q = 179089.56 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 179089.56 ≤ Q = 179089.56 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 179089.56 ≤ Q = 179089.56 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 179089.56 ≤ Q = 179089.56 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 179089.56 ≤ Q = 179089.56 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x7e51f3ac
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x7e51f3ac
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.352020e+13
Presolve removed 2631 rows and 1922 columns
Presolve time: 0.01s
Presolved: 462 rows, 467 columns, 1303 nonzeros
Found heuristic solution: objective 6241805.2388
Variable types: 316 continuous, 151 integer (151 binary)
Found heuristic solution: objective 6241475.8945

Root relaxation: objective -1.520355e+05, 232 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -152035.46    0  123 6241475.89 -152035.46   102%     -    0s
H    0     0                    -115458.8650 -152035.46  31.7%     -    0s
H    0     0                    -115788.2094 -152035.46  31.3%     -    0s
H    0     0                    -127117.7468 -132181.04  3.98%     -    0s
     0     0 -132181.04    0   70 -127117.75 -132181.04  3.98%     -    0s
H    0     0                    -130565.7497 -132085.34  1.16%     -    0s
H    0     0                    -130866.3583 -132085.34  0.93%     -    0s
     0     0 -131442.30    0   64 -130866.36 -131442.30  0.44%     -    0s
     0     0 -131400.53    0   62 -130866.36 -131400.53  0.41%     -    0s
     0     0 -131375.28    0   48 -130866.36 -131375.28  0.39%     -    0s
     0     0 -131362.93    0   54 -130866.36 -131362.93  0.38%     -    0s
     0     0 -131162.48    0   34 -130866.36 -131162.48  0.23%     -    0s
     0     0 -131145.51    0   31 -130866.36 -131145.51  0.21%     -    0s
     0     0 -131007.14    0   31 -130866.36 -131007.14  0.11%     -    0s
     0     0 -130984.92    0   19 -130866.36 -130984.92  0.09%     -    0s
     0     0 -130968.24    0   18 -130866.36 -130968.24  0.08%     -    0s
     0     0 -130956.13    0   14 -130866.36 -130956.13  0.07%     -    0s
     0     0 -130948.72    0   15 -130866.36 -130948.72  0.06%     -    0s
     0     0 -130943.90    0   14 -130866.36 -130943.90  0.06%     -    0s
     0     0 -130939.64    0   13 -130866.36 -130939.64  0.06%     -    0s
     0     0 -130903.51    0    6 -130866.36 -130903.51  0.03%     -    0s
     0     0 -130903.51    0    6 -130866.36 -130903.51  0.03%     -    0s
H    0     0                    -130878.5581 -130903.51  0.02%     -    0s
     0     0          -    0      -130878.56 -130891.06  0.01%     -    0s

Cutting planes:
  Gomory: 2
  MIR: 4
  Flow cover: 1
  Relax-and-lift: 2

Explored 1 nodes (615 simplex iterations) in 0.11 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -130879 -130866 -130805 ... 1.35202e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.308785580684e+05, best bound -1.308910641526e+05, gap 0.0096%
  Subproblem solved in 0.14s
  Worst-case operational profit (Z_SP) = 171919.70
  Scenario: 25 demand increases, 35 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -130878.56
  [DEBUG]   S×d_nominal = 302798.26
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 302798.26 + -130878.56 = 171919.70
  [DEBUG]   Current θ from Master = 179089.56
  [DEBUG]   ⚠️  Z_SP ≤ θ by 7169.87 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 22644.58
  Lower Bound (LB) = 23913.83
  Gap (UB-LB) = 5900.6222, Absolute Gap = 5900.6222, Relative Gap = 0.197912
  Not converged yet (gap = 5900.62 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 25 increases, 35 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308052 nonzeros
Model fingerprint: 0xdf5fa3f8
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 52318 rows and 21238 columns
Presolve time: 3.10s
Presolved: 56095 rows, 24702 columns, 348309 nonzeros
Variable types: 22443 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -310053.6270
Found heuristic solution: objective -171254.7355

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 56095 rows, 24702 columns, 348309 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   19928   -2.1429910e+05   0.000000e+00   1.813130e+07      5s
   33305   -1.9953485e+04   0.000000e+00   1.281199e+08     10s
   44436    1.6089774e+04   0.000000e+00   3.669377e+07     15s
   54318    3.2908007e+04   0.000000e+00   4.840104e+07     20s
   63184    4.1057026e+04   0.000000e+00   1.668890e+06     25s
   72078    4.5658331e+04   0.000000e+00   3.170259e+06     30s
Concurrent spin time: 1.53s

Solved with dual simplex

Root relaxation: objective 5.717431e+04, 47424 iterations, 28.07 seconds (39.42 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 57174.3054    0   69 -171254.74 57174.3054   133%     -   31s
H    0     0                    -168764.3946 57174.3054   134%     -   31s
H    0     0                    -146698.9766 57174.3054   139%     -   32s
H    0     0                    -146687.7793 57174.3054   139%     -   32s
H    0     0                    -143464.2193 57174.3054   140%     -   32s
H    0     0                    -140879.6937 57174.3054   141%     -   32s
H    0     0                    -140261.2710 57174.3054   141%     -   32s
H    0     0                    -61039.16985 57174.3054   194%     -   32s
H    0     0                    13662.136323 57174.3054   318%     -   32s
H    0     0                    14556.055951 57174.3054   293%     -   32s
H    0     0                    15178.449727 57174.3054   277%     -   33s
H    0     0                    16681.525549 57174.3054   243%     -   33s
H    0     0                    16902.739751 57174.3054   238%     -   33s
H    0     0                    17858.143534 57174.3054   220%     -   33s
H    0     0                    18105.792014 57174.3054   216%     -   33s
     0     0 54333.1039    0  174 18105.7920 54333.1039   200%     -   39s
H    0     0                    18113.138443 54329.9496   200%     -   40s
H    0     0                    18484.494127 54329.9496   194%     -   40s
H    0     0                    18877.099190 54329.9496   188%     -   40s
H    0     0                    18883.158389 54329.9496   188%     -   40s
     0     0 54182.6792    0  169 18883.1584 54182.6792   187%     -   42s
     0     0 54182.6792    0  172 18883.1584 54182.6792   187%     -   42s
     0     0 50801.2203    0  148 18883.1584 50801.2203   169%     -   54s
     0     0 50216.3336    0  213 18883.1584 50216.3336   166%     -   60s
H    0     0                    18896.664433 50031.3852   165%     -   63s
     0     0 50031.3852    0  234 18896.6644 50031.3852   165%     -   63s
H    0     0                    19634.120844 49863.2108   154%     -   67s
     0     0 49863.2108    0  234 19634.1208 49863.2108   154%     -   67s
     0     0 49733.6424    0  204 19634.1208 49733.6424   153%     -   69s
     0     0 49720.5450    0  207 19634.1208 49720.5450   153%     -   70s
     0     0 49693.1109    0  238 19634.1208 49693.1109   153%     -   72s
     0     0 49692.9359    0  238 19634.1208 49692.9359   153%     -   72s
H    0     0                    20570.261926 47554.2011   131%     -   95s
H    0     0                    20683.638395 47554.2011   130%     -   95s
H    0     0                    20808.619658 47554.2011   129%     -   95s
H    0     0                    21303.481826 47554.2011   123%     -   95s
     0     0 47554.2011    0  282 21303.4818 47554.2011   123%     -   95s
H    0     0                    21425.754044 47554.1685   122%     -   96s
H    0     0                    22370.635907 47554.1685   113%     -   96s
     0     0 46745.0318    0  305 22370.6359 46745.0318   109%     -  104s
     0     0 46360.1612    0  306 22370.6359 46360.1612   107%     -  108s
H    0     0                    25745.502820 46065.1971  78.9%     -  114s
H    0     0                    25756.803525 46065.1971  78.8%     -  114s
     0     0 46065.1971    0  316 25756.8035 46065.1971  78.8%     -  114s
     0     0 46028.9690    0  328 25756.8035 46028.9690  78.7%     -  116s
     0     0 45973.4648    0  326 25756.8035 45973.4648  78.5%     -  119s
     0     0 45923.7123    0  329 25756.8035 45923.7123  78.3%     -  121s
     0     0 45909.5862    0  339 25756.8035 45909.5862  78.2%     -  123s
     0     0 45905.2196    0  339 25756.8035 45905.2196  78.2%     -  124s
     0     0 45877.8442    0  332 25756.8035 45877.8442  78.1%     -  126s
H    0     0                    25995.756034 45859.5301  76.4%     -  128s
     0     0 45859.5301    0  339 25995.7560 45859.5301  76.4%     -  128s
     0     0 45857.4030    0  342 25995.7560 45857.4030  76.4%     -  128s
     0     0 45855.6280    0  342 25995.7560 45855.6280  76.4%     -  129s
     0     0 45855.0560    0  344 25995.7560 45855.0560  76.4%     -  129s
     0     0 45172.7469    0  385 25995.7560 45172.7469  73.8%     -  144s
     0     0 44947.5800    0  375 25995.7560 44947.5800  72.9%     -  150s
     0     0 44819.6555    0  376 25995.7560 44819.6555  72.4%     -  153s
     0     0 44738.3483    0  380 25995.7560 44738.3483  72.1%     -  156s
H    0     0                    26243.201279 44707.4882  70.4%     -  158s
H    0     0                    26279.586502 44707.4882  70.1%     -  158s
     0     0 44707.4882    0  374 26279.5865 44707.4882  70.1%     -  158s
     0     0 44682.5906    0  379 26279.5865 44682.5906  70.0%     -  159s
     0     0 44669.3798    0  387 26279.5865 44669.3798  70.0%     -  161s
     0     0 44663.6227    0  386 26279.5865 44663.6227  70.0%     -  162s
     0     0 44660.6591    0  389 26279.5865 44660.6591  69.9%     -  162s
     0     0 44656.8628    0  391 26279.5865 44656.8628  69.9%     -  163s
     0     0 44654.1795    0  387 26279.5865 44654.1795  69.9%     -  163s
     0     0 44653.3138    0  389 26279.5865 44653.3138  69.9%     -  164s
     0     0 44542.6112    0  389 26279.5865 44542.6112  69.5%     -  169s
H    0     0                    26518.740081 44541.9495  68.0%     -  169s
     0     0 44503.5313    0  415 26518.7401 44503.5313  67.8%     -  172s
     0     0 44496.2923    0  390 26518.7401 44496.2923  67.8%     -  172s
     0     0 44482.6688    0  414 26518.7401 44482.6688  67.7%     -  173s
     0     0 44473.7593    0  414 26518.7401 44473.7593  67.7%     -  173s
     0     0 44467.4872    0  389 26518.7401 44467.4872  67.7%     -  174s
     0     0 44464.6861    0  389 26518.7401 44464.6861  67.7%     -  174s
     0     0 44463.5592    0  392 26518.7401 44463.5592  67.7%     -  174s
     0     0 44413.5630    0  415 26518.7401 44413.5630  67.5%     -  178s
H    0     0                    27026.201350 44413.1466  64.3%     -  179s
     0     0 44365.2981    0  421 27026.2014 44365.2981  64.2%     -  181s
     0     0 44354.1253    0  427 27026.2014 44354.1253  64.1%     -  182s
     0     0 44346.8244    0  423 27026.2014 44346.8244  64.1%     -  183s
     0     0 44343.0082    0  421 27026.2014 44343.0082  64.1%     -  183s
     0     0 44341.2975    0  403 27026.2014 44341.2975  64.1%     -  184s
     0     0 44341.2043    0  404 27026.2014 44341.2043  64.1%     -  184s
     0     0 44316.8332    0  398 27026.2014 44316.8332  64.0%     -  185s
     0     0 44311.7563    0  425 27026.2014 44311.7563  64.0%     -  186s
     0     0 44306.8038    0  400 27026.2014 44306.8038  63.9%     -  187s
     0     0 44306.0080    0  428 27026.2014 44306.0080  63.9%     -  187s
     0     0 44288.3066    0  395 27026.2014 44288.3066  63.9%     -  189s
     0     0 44282.6569    0  406 27026.2014 44282.6569  63.9%     -  191s
     0     0 44280.3528    0  431 27026.2014 44280.3528  63.8%     -  191s
     0     0 44279.1980    0  414 27026.2014 44279.1980  63.8%     -  192s
     0     0 44271.8769    0  414 27026.2014 44271.8769  63.8%     -  193s
     0     0 44270.9221    0  410 27026.2014 44270.9221  63.8%     -  194s
     0     0 44252.1007    0  410 27026.2014 44252.1007  63.7%     -  196s
     0     0 44242.4167    0  406 27026.2014 44242.4167  63.7%     -  198s
     0     0 44240.9431    0  405 27026.2014 44240.9431  63.7%     -  198s
     0     0 44239.5580    0  412 27026.2014 44239.5580  63.7%     -  199s
     0     0 44238.6745    0  417 27026.2014 44238.6745  63.7%     -  200s
     0     0 44232.9658    0  418 27026.2014 44232.9658  63.7%     -  201s
     0     0 44229.2609    0  409 27026.2014 44229.2609  63.7%     -  203s
     0     0 44226.8104    0  406 27026.2014 44226.8104  63.6%     -  203s
     0     0 44226.0650    0  410 27026.2014 44226.0650  63.6%     -  204s
     0     0 44218.8531    0  414 27026.2014 44218.8531  63.6%     -  205s
     0     0 44217.7392    0  414 27026.2014 44217.7392  63.6%     -  206s
     0     2 44217.7392    0  414 27026.2014 44217.7392  63.6%     -  232s
     1     4 43936.4567    1  397 27026.2014 44217.5881  63.6%  4182  239s
     3     8 43873.0748    2  406 27026.2014 43936.4052  62.6%  5177  248s
     7    16 43560.9510    3  404 27026.2014 43872.8421  62.3%  5854  259s
    15    32 43346.6041    4  442 27026.2014 43559.9462  61.2%  6012  270s
    31    49 40116.6919    5  356 27026.2014 43346.2626  60.4%  8897  290s
    48    81 41633.5622    6  331 27026.2014 43344.2231  60.4%  8251  324s
    80   113 41612.4724    7  363 27026.2014 43344.2231  60.4%  6662  340s
H   81   113                    27095.886152 43344.2231  60.0%  6580  340s
   112   264 41570.1741    8  364 27095.8862 43344.2231  60.0%  5246  355s
   263   359 41345.1982   10  301 27095.8862 43344.2231  60.0%  3451  366s
   358   438 41116.3686   12  349 27095.8862 43344.2231  60.0%  3119  375s
   437   513 41123.4534   13  293 27095.8862 43344.2231  60.0%  2969  385s
   527   583 40233.3459   13  333 27095.8862 43344.2231  60.0%  2744  396s
   615   645 39733.8744   13  325 27095.8862 43344.2231  60.0%  2622  407s
   696   689 40280.3853   13  281 27095.8862 43344.2231  60.0%  2555  417s
   772   726 40899.9755   13  343 27095.8862 43344.2231  60.0%  2507  428s
   839   775 40722.5894   14  288 27095.8862 43344.2231  60.0%  2494  439s
   908   828 40356.9501   14  316 27095.8862 43344.2231  60.0%  2477  449s
   983   905 39635.4379   14  282 27095.8862 43202.1427  59.4%  2452  460s
  1080   958 37339.7244   14  229 27095.8862 43202.1427  59.4%  2397  469s
  1143  1012 38637.7323   15  276 27095.8862 43202.1427  59.4%  2376  480s
  1229  1061 40249.4123   15  315 27095.8862 43202.1427  59.4%  2339  490s
  1316  1128 36392.2506   16  158 27095.8862 43202.1427  59.4%  2321  502s
  1406  1203 38424.8547   16  185 27095.8862 42930.2129  58.4%  2315  511s
  1507  1269 38601.1563   16  281 27095.8862 42930.2129  58.4%  2276  524s
  1637  1295 35886.8655   17  196 27095.8862 42930.2129  58.4%  2212  533s
  1675  1334 35708.0496   19  134 27095.8862 42930.2129  58.4%  2229  541s
  1722  1383 34379.1784   18  173 27095.8862 42930.2129  58.4%  2230  551s
  1829  1451 31431.9916   19  136 27095.8862 42930.2129  58.4%  2188  565s
  1943  1552 34364.4969   20  157 27095.8862 42930.2129  58.4%  2154  576s
  2062  1632 33456.5981   20  112 27095.8862 42930.2129  58.4%  2146  587s
  2226  1715 32986.7064   21  114 27095.8862 42845.0219  58.1%  2088  601s
  2366  1820 32780.9407   21   96 27095.8862 42113.0977  55.4%  2072  615s
  2499  1915     cutoff   24      27095.8862 42113.0977  55.4%  2061  628s
  2626  2012 28897.2307   33   55 27095.8862 42006.9850  55.0%  2020  641s
  2805  2150 28553.0429   44   36 27095.8862 41793.8447  54.2%  1970  655s
  3002  2234 infeasible   51      27095.8862 41691.5802  53.9%  1927  669s
  3160  2365 38688.8010   11  277 27095.8862 41691.5802  53.9%  1929  685s
  3343  2532 37184.9387   13  224 27095.8862 41691.5802  53.9%  1922  700s
  3582  2721 35250.9241   16  220 27095.8862 41653.9587  53.7%  1885  716s
  3856  2722 30125.3983   21  414 27095.8862 41566.7703  53.4%  1837  761s
  3858  2723 28038.9949   64   69 27095.8862 41566.7703  53.4%  1836  791s
  3859  2724 31570.9535   33  261 27095.8862 41566.7703  53.4%  1835  811s
  3860  2725 40320.0550    9  355 27095.8862 41566.7703  53.4%  1835  825s
  3861  2725 31105.4364   24  363 27095.8862 41566.7703  53.4%  1834  835s
  3862  2726 38148.8954   11  359 27095.8862 41566.7703  53.4%  1834  843s
  3863  2727 38437.6824   11  405 27095.8862 41566.7703  53.4%  1833  849s
  3864  2727 31065.5854   25  409 27095.8862 41566.7703  53.4%  1833  851s
  3865  2728 32109.7019   48  424 27095.8862 41566.7703  53.4%  1832  855s
  3867  2729 38404.0476   13  427 27095.8862 41566.7703  53.4%  1831  862s
  3869  2731 29407.1384   43  407 27095.8862 41566.7703  53.4%  1830  867s
  3870  2731 28897.9862   55  429 27095.8862 41566.7703  53.4%  1830  874s
  3871  2732 33033.5266   28  434 27095.8862 41566.7703  53.4%  1830  876s
  3873  2733 35183.3835   22  410 27095.8862 41566.7703  53.4%  1829  880s
  3877  2736 31312.6748   41  399 27095.8862 41566.7703  53.4%  1827  889s
  3878  2737 30805.5288   18  396 27095.8862 41566.7703  53.4%  1826  890s
  3880  2738 32482.4383   41  440 27095.8862 41566.7703  53.4%  1825  897s
  3881  2739 34777.4089   17  406 27095.8862 41566.7703  53.4%  1825  901s
  3883  2740 28851.4508   27  416 27095.8862 41566.7703  53.4%  1824  907s
  3885  2741 39957.9940   10  449 27095.8862 41566.7703  53.4%  1823  910s
  3887  2743 30576.0811   59  419 27095.8862 41566.7703  53.4%  1822  915s
  3889  2744 38392.8076    8  456 27095.8862 41566.7703  53.4%  1821  920s
  3891  2745 35201.5475   24  466 27095.8862 41566.7703  53.4%  1820  926s
  3893  2747 30329.0241   20  422 27095.8862 41566.7703  53.4%  1819  933s
  3894  2747 35798.2029   14  422 27095.8862 41566.7703  53.4%  1819  963s
  3895  2748 39358.8465   14  422 27095.8862 41566.7703  53.4%  1818  985s
  3896  2752 41566.7703   14  409 27095.8862 41566.7703  53.4%  1858 1001s
  3898  2755 41566.7703   15  478 27095.8862 41566.7703  53.4%  1859 1015s
  3902  2762 41566.7703   16  490 27095.8862 41566.7703  53.4%  1863 1031s
  3910  2775 41566.7703   17  487 27095.8862 41566.7703  53.4%  1875 1045s
  3926  2792 40051.5525   18  313 27095.8862 41566.7703  53.4%  1917 1083s
  3948  2816 39789.4075   19  394 27095.8862 41566.7703  53.4%  1958 1105s
  3980  2927 39514.6305   20  377 27095.8862 41566.7703  53.4%  2020 1126s
  4101  2941 38493.4816   23  327 27095.8862 41566.7703  53.4%  2083 1141s
  4165  2958 38116.4355   24  309 27095.8862 41566.7703  53.4%  2123 1156s
H 4205  2806                    27145.760346 41566.7703  53.1%  2145 1156s
  4214  2855 36813.1831   24  311 27145.7603 41566.7703  53.1%  2151 1168s
  4291  2867 37190.9867   22  330 27145.7603 41566.7703  53.1%  2175 1182s
  4369  2870 38444.2127   24  320 27145.7603 41566.7703  53.1%  2198 1197s
  4454  2858 38028.3111   25  300 27145.7603 41566.7703  53.1%  2214 1213s
  4501  2873 37802.1933   26  291 27145.7603 41566.7703  53.1%  2243 1227s
  4554  2892 32967.0850   27  284 27145.7603 41566.7703  53.1%  2283 1239s
  4603  2913 33659.9822   26  261 27145.7603 41566.7703  53.1%  2316 1253s
  4667  2917 36520.6216   28  271 27145.7603 41566.7703  53.1%  2349 1268s
  4702  2934 35618.0135   29  268 27145.7603 41566.7703  53.1%  2371 1281s
  4755  2949 35435.6418   30  248 27145.7603 41566.7703  53.1%  2407 1293s
H 4786  2808                    27159.295031 41566.7703  53.0%  2415 1293s
  4813  2841 35053.2986   31  250 27159.2950 41566.7703  53.0%  2424 1307s
  4891  2835 31801.4042   31  247 27159.2950 41566.7703  53.0%  2453 1321s
H 4899  2708                    27269.836589 41566.7703  52.4%  2454 1321s
  4931  2716 33467.7646   33  273 27269.8366 41566.7703  52.4%  2472 1336s
H 4965  2585                    28345.871591 41566.7703  46.6%  2479 1336s
  4982  2591     cutoff   32      28345.8716 41566.7703  46.6%  2480 1355s
H 4985  2478                    28356.750106 41566.7703  46.6%  2479 1355s
H 4994  2368                    28469.258933 41566.7703  46.0%  2480 1355s
H 5001  2264                    28617.919110 41566.7703  45.2%  2479 1355s
  5032  2288 32128.4761   35  264 28617.9191 41566.7703  45.2%  2491 1370s
H 5045  2187                    28781.007514 41566.7703  44.4%  2493 1370s
H 5054  2093                    28788.119889 41566.7703  44.4%  2499 1370s
  5128  2101     cutoff   35      28788.1199 41566.7703  44.4%  2525 1386s
  5221  2118 30392.7056   37  209 28788.1199 41566.7703  44.4%  2540 1402s
  5302  2145 29573.9248   41  214 28788.1199 41459.8643  44.0%  2573 1416s
  5386  2134     cutoff   40      28788.1199 41459.8643  44.0%  2604 1426s
H 5391  2045                    29015.799290 41459.8643  42.9%  2604 1426s
H 5421  1952                    29330.445744 41459.8643  41.4%  2613 1426s
  5428  1978 37848.0108   24  296 29330.4457 41459.8643  41.4%  2615 1444s
H 5480  1882                    29332.647225 41459.8643  41.3%  2623 1444s
  5530  1902 35572.3164   28  250 29332.6472 41459.8643  41.3%  2648 1460s
  5632  1904 33187.4317   31  232 29332.6472 41205.9612  40.5%  2681 1476s
  5736  1904 31450.2715   35  199 29332.6472 40610.0126  38.4%  2711 1498s
  5867  1906 33158.7037   26  272 29332.6472 40610.0126  38.4%  2745 1517s
  5978  1894 30959.0089   28  278 29332.6472 40021.8541  36.4%  2796 1536s
H 6030  1802                    29370.608325 40021.8541  36.3%  2810 1536s
H 6056  1765                    29402.309670 40021.8541  36.1%  2819 1554s
H 6074  1692                    29413.161906 40021.8541  36.1%  2821 1554s
H 6077  1627                    29442.713896 40021.8541  35.9%  2823 1554s
  6191  1638 33624.0333   29  214 29442.7139 39892.4790  35.5%  2847 1575s
  6313  1648 32014.1856   31  211 29442.7139 39715.5087  34.9%  2888 1597s
H 6351  1574                    29482.239661 39715.5087  34.7%  2890 1597s
  6475  1542     cutoff   37      29482.2397 39707.4129  34.7%  2913 1619s
  6637  1527 35179.5537   26  287 29482.2397 38749.4706  31.4%  2941 1641s
  6773  1534 29690.5440   31  153 29482.2397 38749.4706  31.4%  2978 1663s
  6926  1545 30859.2819   23  314 29482.2397 38749.4706  31.4%  3015 1688s
  7089  1511     cutoff   28      29482.2397 37933.8321  28.7%  3057 1708s
H 7121  1443                    29521.131400 37933.8321  28.5%  3065 1708s
H 7140  1435                    29530.681147 37730.9156  27.8%  3068 1708s
  7150  1495 35678.6022   20  397 29530.6811 37730.9156  27.8%  3069 1733s
  7362  1572 34186.3097   24  328 29530.6811 37730.9156  27.8%  3078 1757s
  7568  1623 32237.0473   29  254 29530.6811 37730.9156  27.8%  3106 1783s
H 7667  1623                    29550.443598 37730.9156  27.7%  3105 1783s
  7817  1711 35157.7074   24  246 29550.4436 37600.4467  27.2%  3119 1811s
  8025  1745     cutoff   27      29550.4436 37526.9411  27.0%  3145 1840s
H 8213  1745                    29569.326987 37526.9411  26.9%  3167 1840s
  8275  1739     cutoff   37      29569.3270 37526.9411  26.9%  3167 1868s
  8507  1738     cutoff   25      29569.3270 37526.9411  26.9%  3205 1899s
  8681  1803     cutoff   30      29569.3270 37076.2261  25.4%  3227 1929s
  8947  1818     cutoff   31      29569.3270 36952.1693  25.0%  3263 1960s
  9233  1854 31726.5235   24  283 29569.3270 36952.1693  25.0%  3295 1994s
  9532  1881 32465.6242   28  207 29569.3270 36499.4038  23.4%  3321 2028s
  9838  1900 34779.3104   24  294 29569.3270 36268.1298  22.7%  3348 2057s
 10014  1942 31461.1099   25  276 29569.3270 36107.7420  22.1%  3368 2092s
 10360  1965     cutoff   30      29569.3270 35976.9664  21.7%  3387 2128s
 10725  1981 31421.3398   30  219 29569.3270 35872.8937  21.3%  3415 2166s
 11122  2002 30385.2250   28  235 29569.3270 35760.9216  20.9%  3435 2205s
 11516  2025 30103.0929   23  299 29569.3270 35540.7318  20.2%  3466 2242s
 11810  2041 31683.5484   23  210 29569.3270 35534.9403  20.2%  3479 2284s
 12305  2075 31856.1355   28  248 29569.3270 35331.3658  19.5%  3485 2329s
 12780  2063 30176.0733   32  185 29569.3270 35246.9516  19.2%  3494 2371s
 13182  2078 31935.3025   33  243 29569.3270 34997.0394  18.4%  3525 2413s
 13636  2064     cutoff   27      29569.3270 34858.2482  17.9%  3545 2461s
 14133  2013 31795.6519   28  291 29569.3270 34525.1786  16.8%  3569 2512s
 14640  1984     cutoff   30      29569.3270 34240.3977  15.8%  3569 2567s
 15230  1947     cutoff   27      29569.3270 34030.4499  15.1%  3571 2619s
 15801  1882 infeasible   23      29569.3270 33785.0976  14.3%  3585 2670s
 16444  1741     cutoff   26      29569.3270 33526.1797  13.4%  3586 2727s
 17139  1599 31505.0852   31  225 29569.3270 33342.1175  12.8%  3590 2785s
 17864  1372     cutoff   30      29569.3270 32930.2095  11.4%  3588 2844s
 18594   936 29918.8454   27  303 29569.3270 32660.1911  10.5%  3590 2902s
 19529   633     cutoff   25      29569.3270 32195.8559  8.88%  3560 2961s
 21887  1615 29950.2826   50   51 29569.3270 31154.0253  5.36%  3273 2989s
H22904  1615                    29581.412390 31001.5200  4.80%  3131 2989s
H24486  1615                    29582.842326 30811.6367  4.15%  2936 2989s
 25503  1744 29585.8161   80    8 29582.8423 30037.3040  1.54%  2822 3002s
 29839  1704 29606.6980   60   25 29582.8423 29808.0816  0.76%  2422 3019s
 29904  1355 29603.4112   61   20 29582.8423 29808.0816  0.76%  2417 3034s
 31880  1355 29609.3678   61   18 29582.8423 29782.1239  0.67%  2270 3035s
 31881   721 29590.6041   62   16 29582.8423 29782.1239  0.67%  2270 3048s
 34587   114 29597.1415   66   26 29582.8423 29754.5655  0.58%  2096 3060s
 37264     6     cutoff   66      29582.8423 29720.1400  0.46%  1948 3068s

Cutting planes:
  MIR: 818
  Mixing: 2
  Flow cover: 1849
  RLT: 16
  Relax-and-lift: 115

Explored 37500 nodes (72807789 simplex iterations) in 3068.80 seconds (6188.25 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 29582.8 29582.8 29581.4 ... 29413.2

Optimal solution found (tolerance 1.00e-04)
Best objective 2.958284232574e+04, best bound 2.958284232574e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3068.83s
  Master Objective (UB) = 29582.84, θ = 179198.14
  Upper Bound (UB) = 29582.84

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 179198.14
  [DEBUG]   ✓ Scenario 0: θ = 179198.14 ≤ Q = 179198.14 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 179198.14 ≤ Q = 179198.14 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 179198.14 ≤ Q = 179198.14 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 179198.14 ≤ Q = 179198.14 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 179198.14 ≤ Q = 179485.09 (slack: 286.95)
  [DEBUG]   ✓ Scenario 5: θ = 179198.14 ≤ Q = 179198.14 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 179198.14 ≤ Q = 179198.14 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x46d2d6d8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xb92d2928
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.347523e+13
Presolve removed 2631 rows and 1922 columns
Presolve time: 0.01s
Presolved: 462 rows, 467 columns, 1303 nonzeros
Found heuristic solution: objective 6248604.8363
Variable types: 316 continuous, 151 integer (151 binary)
Found heuristic solution: objective 6248275.4920

Root relaxation: objective -1.520357e+05, 231 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -152035.70    0  123 6248275.49 -152035.70   102%     -    0s
H    0     0                    -113963.7757 -152035.70  33.4%     -    0s
H    0     0                    -114293.1201 -152035.70  33.0%     -    0s
H    0     0                    -114802.2160 -152035.70  32.4%     -    0s
H    0     0                    -115131.5604 -152035.70  32.1%     -    0s
H    0     0                    -121584.4461 -129988.86  6.91%     -    0s
     0     0 -129988.86    0   87 -121584.45 -129988.86  6.91%     -    0s
H    0     0                    -127347.6173 -129879.87  1.99%     -    0s
H    0     0                    -127974.4277 -129879.87  1.49%     -    0s
H    0     0                    -128094.1532 -129879.87  1.39%     -    0s
     0     0 -129109.80    0   91 -128094.15 -129109.80  0.79%     -    0s
H    0     0                    -128094.6306 -129092.86  0.78%     -    0s
     0     0 -129028.19    0   78 -128094.63 -129028.19  0.73%     -    0s
     0     0 -129024.62    0   82 -128094.63 -129024.62  0.73%     -    0s
     0     0 -128923.97    0   66 -128094.63 -128923.97  0.65%     -    0s
     0     0 -128889.30    0   71 -128094.63 -128889.30  0.62%     -    0s
     0     0 -128888.67    0   71 -128094.63 -128888.67  0.62%     -    0s
     0     0 -128838.55    0   84 -128094.63 -128838.55  0.58%     -    0s
     0     0 -128829.33    0   84 -128094.63 -128829.33  0.57%     -    0s
H    0     0                    -128094.6556 -128825.39  0.57%     -    0s
H    0     0                    -128118.8572 -128825.39  0.55%     -    0s
     0     2 -128825.39    0   84 -128118.86 -128825.39  0.55%     -    0s
H   33    10                    -128207.2723 -128655.49  0.35%   9.8    0s
H  620     2                    -128207.7496 -128229.75  0.02%   6.1    0s

Cutting planes:
  Gomory: 31
  Implied bound: 4
  MIR: 149
  Flow cover: 19
  RLT: 17

Explored 627 nodes (4374 simplex iterations) in 0.22 seconds (0.09 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -128208 -128207 -128119 ... -114802
No other solutions better than -128208

Optimal solution found (tolerance 1.00e-04)
Best objective -1.282077496147e+05, best bound -1.282077496147e+05, gap 0.0000%
  Subproblem solved in 0.25s
  Worst-case operational profit (Z_SP) = 174702.16
  Scenario: 14 demand increases, 46 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -128207.75
  [DEBUG]   S×d_nominal = 302909.91
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 302909.91 + -128207.75 = 174702.16
  [DEBUG]   Current θ from Master = 179198.14
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4495.98 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 25086.86
  Lower Bound (LB) = 25086.86
  Gap (UB-LB) = 4495.9810, Absolute Gap = 4495.9810, Relative Gap = 0.151979
  Not converged yet (gap = 4495.98 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 14 increases, 46 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351271 nonzeros
Model fingerprint: 0x99170671
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 59792 rows and 24272 columns
Presolve time: 1.84s
Presolved: 63911 rows, 27908 columns, 397279 nonzeros
Variable types: 25649 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -310053.6270
Found heuristic solution: objective -171254.7355

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 63911 rows, 27908 columns, 397279 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   24431   -1.2428467e+05   0.000000e+00   2.136776e+08      5s
   38176    1.0047229e+04   0.000000e+00   4.412668e+07     10s
   48587    2.9799133e+04   0.000000e+00   4.142830e+07     15s
   56389    3.6809456e+04   0.000000e+00   1.605142e+07     20s
   64285    3.9858067e+04   0.000000e+00   2.030814e+07     25s
   73520    4.3335133e+04   0.000000e+00   1.356257e+06     30s
   80998    4.6519621e+04   0.000000e+00   7.780021e+05     35s
Concurrent spin time: 1.73s

Solved with dual simplex

Root relaxation: objective 5.717431e+04, 51236 iterations, 38.75 seconds (52.89 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 57174.3054    0   69 -171254.74 57174.3054   133%     -   41s
H    0     0                    -168628.1743 57174.3054   134%     -   41s
H    0     0                    -167256.4171 57174.3054   134%     -   41s
H    0     0                    -167111.6715 57174.3054   134%     -   41s
H    0     0                    -114344.0371 57174.3054   150%     -   42s
H    0     0                    -114294.9783 57174.3054   150%     -   42s
H    0     0                    -114259.8438 57174.3054   150%     -   42s
H    0     0                    -114092.3171 57174.3054   150%     -   42s
H    0     0                    -61039.16985 57174.3054   194%     -   42s
H    0     0                    8672.0713863 57174.3054   559%     -   42s
H    0     0                    11784.549153 57174.3054   385%     -   42s
H    0     0                    15846.048944 57174.3054   261%     -   43s
H    0     0                    16849.415857 57174.3054   239%     -   43s
H    0     0                    16868.487233 57174.3054   239%     -   43s
H    0     0                    17292.024082 57174.3054   231%     -   43s
     0     0 52692.1625    0  178 17292.0241 52692.1625   205%     -   55s
H    0     0                    17346.084673 52691.1012   204%     -   55s
H    0     0                    18063.331258 52691.1012   192%     -   55s
     0     0 52240.4692    0  182 18063.3313 52240.4692   189%     -   59s
     0     0 52240.4692    0  188 18063.3313 52240.4692   189%     -   62s
     0     0 52240.4692    0  188 18063.3313 52240.4692   189%     -   62s
     0     0 52240.4692    0  190 18063.3313 52240.4692   189%     -   62s
     0     0 49219.5678    0  205 18063.3313 49219.5678   172%     -   72s
H    0     0                    18213.829731 49217.7510   170%     -   73s
H    0     0                    18232.043447 49217.7510   170%     -   73s
H    0     0                    18260.369204 49217.7510   170%     -   73s
H    0     0                    19111.891562 48587.1603   154%     -   80s
H    0     0                    19114.761649 48587.1603   154%     -   80s
H    0     0                    19752.027710 48587.1603   146%     -   80s
H    0     0                    22778.637047 48587.1603   113%     -   80s
H    0     0                    22792.534825 48587.1603   113%     -   80s
     0     0 48587.1603    0  254 22792.5348 48587.1603   113%     -   80s
     0     0 48517.4566    0  258 22792.5348 48517.4566   113%     -   83s
     0     0 48492.4020    0  259 22792.5348 48492.4020   113%     -   85s
     0     0 48476.5825    0  254 22792.5348 48476.5825   113%     -   88s
     0     0 48468.5525    0  260 22792.5348 48468.5525   113%     -   90s
     0     0 48465.1256    0  263 22792.5348 48465.1256   113%     -   90s
     0     0 48465.0327    0  260 22792.5348 48465.0327   113%     -   90s
     0     0 46722.1178    0  303 22792.5348 46722.1178   105%     -  114s
H    0     0                    23500.210947 46268.7554  96.9%     -  120s
H    0     0                    23528.468048 46268.7554  96.7%     -  120s
     0     0 46268.7554    0  321 23528.4680 46268.7554  96.7%     -  121s
     0     0 46004.4453    0  320 23528.4680 46004.4453  95.5%     -  125s
     0     0 45894.6762    0  329 23528.4680 45894.6762  95.1%     -  129s
     0     0 45853.2038    0  333 23528.4680 45853.2038  94.9%     -  131s
     0     0 45845.4234    0  333 23528.4680 45845.4234  94.9%     -  133s
     0     0 45830.4512    0  333 23528.4680 45830.4512  94.8%     -  135s
     0     0 45758.6798    0  330 23528.4680 45758.6798  94.5%     -  137s
     0     0 45744.0561    0  332 23528.4680 45744.0561  94.4%     -  139s
     0     0 45734.2381    0  335 23528.4680 45734.2381  94.4%     -  139s
     0     0 45728.6088    0  328 23528.4680 45728.6088  94.4%     -  140s
     0     0 45719.6156    0  325 23528.4680 45719.6156  94.3%     -  141s
     0     0 45703.3817    0  337 23528.4680 45703.3817  94.2%     -  142s
     0     0 45698.5140    0  331 23528.4680 45698.5140  94.2%     -  143s
     0     0 45695.3785    0  335 23528.4680 45695.3785  94.2%     -  144s
     0     0 45694.2104    0  336 23528.4680 45694.2104  94.2%     -  144s
H    0     0                    23571.567872 44818.1091  90.1%     -  160s
     0     0 44818.1091    0  402 23571.5679 44818.1091  90.1%     -  160s
H    0     0                    24414.565622 44817.6937  83.6%     -  160s
H    0     0                    24416.426232 44817.6937  83.6%     -  160s
     0     0 44680.0589    0  393 24416.4262 44680.0589  83.0%     -  165s
     0     0 44637.9235    0  405 24416.4262 44637.9235  82.8%     -  167s
     0     0 44618.3939    0  402 24416.4262 44618.3939  82.7%     -  169s
     0     0 44605.2552    0  406 24416.4262 44605.2552  82.7%     -  170s
     0     0 44596.6932    0  408 24416.4262 44596.6932  82.7%     -  171s
     0     0 44587.8315    0  408 24416.4262 44587.8315  82.6%     -  171s
     0     0 44587.4924    0  409 24416.4262 44587.4924  82.6%     -  172s
     0     0 44429.7430    0  405 24416.4262 44429.7430  82.0%     -  176s
H    0     0                    24461.723787 44428.5528  81.6%     -  176s
     0     0 44402.8171    0  407 24461.7238 44402.8171  81.5%     -  178s
     0     0 44388.2043    0  402 24461.7238 44388.2043  81.5%     -  179s
     0     0 44373.6807    0  435 24461.7238 44373.6807  81.4%     -  181s
     0     0 44369.7605    0  437 24461.7238 44369.7605  81.4%     -  181s
     0     0 44343.2421    0  415 24461.7238 44343.2421  81.3%     -  183s
     0     0 44335.6013    0  407 24461.7238 44335.6013  81.2%     -  183s
     0     0 44331.0283    0  406 24461.7238 44331.0283  81.2%     -  184s
     0     0 44329.5614    0  387 24461.7238 44329.5614  81.2%     -  184s
     0     0 44293.0212    0  446 24461.7238 44293.0212  81.1%     -  187s
H    0     0                    24597.668035 44292.8929  80.1%     -  188s
H    0     0                    24662.088558 44292.8929  79.6%     -  188s
     0     0 44266.7104    0  421 24662.0886 44266.7104  79.5%     -  190s
     0     0 44251.3249    0  417 24662.0886 44251.3249  79.4%     -  191s
     0     0 44249.7767    0  447 24662.0886 44249.7767  79.4%     -  192s
     0     0 44249.6537    0  447 24662.0886 44249.6537  79.4%     -  192s
     0     0 44227.0508    0  411 24662.0886 44227.0508  79.3%     -  195s
     0     0 44219.3845    0  419 24662.0886 44219.3845  79.3%     -  196s
     0     0 44218.3661    0  388 24662.0886 44218.3661  79.3%     -  196s
     0     0 44207.2178    0  385 24662.0886 44207.2178  79.3%     -  197s
H    0     0                    24724.014534 44206.5672  78.8%     -  198s
H    0     0                    24746.520496 44206.5672  78.6%     -  198s
H    0     0                    24806.048126 44206.5672  78.2%     -  198s
     0     0 44206.5672    0  387 24806.0481 44206.5672  78.2%     -  198s
     0     0 44205.3812    0  390 24806.0481 44205.3812  78.2%     -  199s
     0     0 44204.4821    0  389 24806.0481 44204.4821  78.2%     -  200s
     0     0 44204.3867    0  427 24806.0481 44204.3867  78.2%     -  201s
     0     0 44202.7680    0  429 24806.0481 44202.7680  78.2%     -  201s
     0     0 44202.7680    0  428 24806.0481 44202.7680  78.2%     -  203s
     0     0 44202.4593    0  428 24806.0481 44202.4593  78.2%     -  204s
H    0     0                    24882.757029 44202.4593  77.6%     -  245s
H    0     0                    25057.013279 44202.4593  76.4%     -  245s
H    0     2                    25319.106377 44202.4593  74.6%     -  247s
     0     2 44202.4593    0  428 25319.1064 44202.4593  74.6%     -  247s
     1     4 43983.0564    1  411 25319.1064 44202.4593  74.6%  5830  255s
     3     8 43885.1510    2  410 25319.1064 43975.5394  73.7%  6424  264s
     7    16 43781.9322    3  412 25319.1064 43884.2533  73.3%  6268  273s
    15    32 43565.9535    4  373 25319.1064 43779.9379  72.9%  6761  282s
    31    49 41113.3346    5  321 25319.1064 43565.2951  72.1%  8967  314s
    48    81 42928.9918    6  398 25319.1064 43565.2951  72.1%  8090  328s
H   57    81                    25643.165491 43565.2951  69.9%  7868  328s
    80   144 42918.0156    7  397 25643.1655 43565.2951  69.9%  6608  343s
   143   176 42781.9050    9  352 25643.1655 43565.2951  69.9%  5511  351s
   175   208 42335.1333    8  397 25643.1655 43565.2951  69.9%  4885  363s
H  180   208                    26691.445344 43565.2951  63.2%  4782  363s
   207   294 42274.8334    9  351 26691.4453 43565.2951  63.2%  4580  377s
H  211   294                    26850.310995 43565.2951  62.3%  4567  377s
H  251   294                    26873.843124 43565.2951  62.1%  4173  377s
H  262   294                    26930.170689 43565.2951  61.8%  4134  377s
   293   381 42709.3996   10  352 26930.1707 43565.2951  61.8%  4003  392s
   380   447 42504.0477   11  346 26930.1707 43565.2951  61.8%  3654  409s
   446   529 42378.1863   12  378 26930.1707 43565.2951  61.8%  3541  423s
   530   615 41936.7109   11  338 26930.1707 43565.2951  61.8%  3409  434s
   622   697 42312.1383   13  372 26930.1707 43565.2951  61.8%  3274  445s
   706   756 39041.6113   12  248 26930.1707 43565.2951  61.8%  3287  454s
   777   802 42088.5941   14  357 26930.1707 43565.2951  61.8%  3311  466s
   839   852 42056.2375   13  361 26930.1707 43565.2951  61.8%  3375  476s
   911   925 29511.7045   32  273 26930.1707 43565.2951  61.8%  3404  487s
  1000   960 41787.0201   14  304 26930.1707 43565.2951  61.8%  3355  504s
H 1002   960                    26939.608691 43565.2951  61.7%  3355  504s
H 1008   960                    27089.112260 43565.2951  60.8%  3355  504s
  1039  1008 29104.4199   35  272 27089.1123 43565.2951  60.8%  3356  515s
H 1105  1008                    27123.018974 43565.2951  60.6%  3327  515s
  1113  1047 41836.2659   14  358 27123.0190 43565.2951  60.6%  3335  523s
  1189  1091 41706.1765   15  275 27123.0190 43565.2951  60.6%  3333  537s
  1277  1152 36478.2192   17  267 27123.0190 43565.2951  60.6%  3381  550s
  1364  1178 36954.1279   16  272 27123.0190 43457.9397  60.2%  3424  563s
  1406  1222 41094.7759   17  270 27123.0190 43457.4501  60.2%  3502  573s
  1456  1284 39767.5860   15  289 27123.0190 43457.4501  60.2%  3578  584s
  1532  1336 40374.2590   18  240 27123.0190 43457.4501  60.2%  3603  598s
  1615  1404 40219.9131   19  228 27123.0190 43457.4501  60.2%  3626  611s
H 1640  1404                    27223.346377 43281.7113  59.0%  3651  611s
  1695  1496 39699.0433   21  196 27223.3464 43281.7113  59.0%  3648  626s
  1811  1587 39287.6328   23  193 27223.3464 43281.7113  59.0%  3645  639s
  1928  1675 37996.1346   23  190 27223.3464 43281.7113  59.0%  3681  653s
  2032  1766 38150.2083   24  197 27223.3464 43170.5212  58.6%  3707  665s
  2151  1843 37125.1555   24  167 27223.3464 43170.5212  58.6%  3716  680s
  2279  1944 34444.5578   24  152 27223.3464 43170.5212  58.6%  3739  696s
  2412  2051 37964.5288   25  200 27223.3464 43170.5212  58.6%  3768  710s
  2543  2181 35888.1304   26  133 27223.3464 42418.0657  55.8%  3788  728s
  2705  2309 35425.7573   27  133 27223.3464 42418.0657  55.8%  3795  745s
  2863  2430 34611.7345   30  164 27223.3464 42418.0657  55.8%  3794  763s
  3024  2551 34348.4820   32  126 27223.3464 42402.2440  55.8%  3802  779s
H 3041  2391                    28413.903639 42402.2440  49.2%  3804  779s
  3159  2510 33536.4624   39  123 28413.9036 42378.2589  49.1%  3772  796s
H 3362  2482                    28833.712319 42346.9537  46.9%  3752  817s
H 3380  2455                    28950.036135 42346.9537  46.3%  3755  817s
H 3393  2441                    29008.724761 42346.9537  46.0%  3760  817s
  3515  2490 infeasible   46      29008.7248 42279.2301  45.7%  3781  839s
  3654  2552 35877.8199   13  294 29008.7248 42245.8177  45.6%  3849  861s
  3772  2633 32611.8041   16  246 29008.7248 42245.8177  45.6%  3942  886s
  3895  2686 30307.5742   20  226 29008.7248 42173.5303  45.4%  4031  907s
  4014  2737 29406.4895   23  188 29008.7248 42079.8430  45.1%  4122  931s
  4197  2772 31349.1578   10  265 29008.7248 42079.8430  45.1%  4173  954s
H 4214  2757                    29100.801715 42079.8430  44.6%  4169  954s
  4292  2839 30117.3737   11  278 29100.8017 42079.8430  44.6%  4208  980s
  4485  2857 37339.1214   13  217 29100.8017 42079.8430  44.6%  4246  999s
  4551  2918 35432.4343   14  219 29100.8017 42079.8430  44.6%  4263 1023s
  4705  2981 34272.4305   15  175 29100.8017 42079.8430  44.6%  4278 1049s
  4886  3002 33641.8713   17  207 29100.8017 41881.6946  43.9%  4332 1081s
H 4921  2996                    29135.791814 41881.6946  43.7%  4341 1081s
  4927  3065 30935.3493   18  188 29135.7918 41881.6946  43.7%  4346 1109s
  5163  3160 33408.0873   18  202 29135.7918 41881.6946  43.7%  4367 1141s
  5409  3161 30339.1655   38  428 29135.7918 41609.1309  42.8%  4386 1291s
  5411  3162 39174.0577    7   69 29135.7918 41609.1309  42.8%  4385 1336s
  5412  3163 32928.6940   36  247 29135.7918 41609.1309  42.8%  4384 1362s
  5413  3164 29551.4168   18  300 29135.7918 41609.1309  42.8%  4383 1379s
  5414  3164 32189.0582   39  355 29135.7918 41609.1309  42.8%  4382 1391s
  5415  3165 39357.1338   12  359 29135.7918 41609.1309  42.8%  4381 1402s
  5416  3166 31401.5173   43  417 29135.7918 41609.1309  42.8%  4380 1410s
  5418  3167 31235.8516   19  401 29135.7918 41609.1309  42.8%  4379 1418s
  5419  3168 35363.9596   26  387 29135.7918 41609.1309  42.8%  4378 1420s
  5422  3170 40061.8575   13  425 29135.7918 41609.1309  42.8%  4376 1426s
  5424  3171 33280.8129   24  418 29135.7918 41609.1309  42.8%  4374 1430s
  5425  3172 40467.4750   11  414 29135.7918 41609.1309  42.8%  4373 1437s
  5427  3173 29253.5755   28  467 29135.7918 41609.1309  42.8%  4372 1441s
  5429  3174 33717.2111   26  410 29135.7918 41609.1309  42.8%  4370 1449s
  5430  3175 35625.9688   25  410 29135.7918 41609.1309  42.8%  4369 1452s
  5431  3176 31946.3895   37  399 29135.7918 41609.1309  42.8%  4368 1458s
  5432  3176 37166.5143   15  473 29135.7918 41609.1309  42.8%  4368 1460s
  5434  3178 39516.6074   13  445 29135.7918 41609.1309  42.8%  4366 1465s
  5435  3178 40724.9880   14  447 29135.7918 41609.1309  42.8%  4365 1470s
  5438  3180 33037.6864   22  502 29135.7918 41609.1309  42.8%  4363 1479s
  5439  3181 33624.4981   20  455 29135.7918 41609.1309  42.8%  4362 1480s
  5441  3182 39567.6462   15  463 29135.7918 41609.1309  42.8%  4360 1489s
  5442  3183 29141.0340   41  480 29135.7918 41609.1309  42.8%  4360 1491s
  5443  3184 33674.7653   39  434 29135.7918 41609.1309  42.8%  4359 1496s
  5445  3185 32870.5031   23  464 29135.7918 41609.1309  42.8%  4357 1502s
  5447  3186 39599.1855   22  426 29135.7918 41609.1309  42.8%  4356 1508s
  5448  3187 35420.0222   28  426 29135.7918 41609.1309  42.8%  4355 1555s
  5449  3188 33410.1757   33  426 29135.7918 41609.1309  42.8%  4354 1585s
  5450  3191 41609.1309   13  412 29135.7918 41609.1309  42.8%  4390 1606s
  5452  3195 41609.1309   14  410 29135.7918 41609.1309  42.8%  4390 1627s
  5456  3201 41609.1309   15  399 29135.7918 41609.1309  42.8%  4395 1645s
  5464  3215 41609.1309   16  400 29135.7918 41609.1309  42.8%  4398 1667s
  5480  3225 41609.1309   17  436 29135.7918 41609.1309  42.8%  4429 1712s
  5496  3252 40748.6550   18  377 29135.7918 41609.1309  42.8%  4445 1740s
  5528  3373 40426.2573   19  364 29135.7918 41609.1309  42.8%  4484 1767s
  5660  3396 39504.0100   23  343 29135.7918 41609.1309  42.8%  4470 1785s
  5728  3433 39211.8403   26  297 29135.7918 41609.1309  42.8%  4457 1803s
  5787  3453 39027.6921   25  328 29135.7918 41609.1309  42.8%  4449 1818s
  5829  3480 37573.2130   24  281 29135.7918 41609.1309  42.8%  4461 1833s
  5883  3489 38539.6987   27  268 29135.7918 41609.1309  42.8%  4465 1847s
  5916  3503 37928.6279   27  262 29135.7918 41609.1309  42.8%  4466 1864s
  5960  3502 38535.9926   26  331 29135.7918 41609.1309  42.8%  4469 1879s
  5995  3521 38329.9848   27  265 29135.7918 41609.1309  42.8%  4473 1893s
  6059  3516 38291.0642   28  263 29135.7918 41609.1309  42.8%  4470 1910s
  6120  3525 35101.7973   29  228 29135.7918 41609.1309  42.8%  4475 1937s
  6191  3521 32900.9965   30  157 29135.7918 41609.1309  42.8%  4472 1952s
  6254  3523 31956.7599   32  140 29135.7918 41609.1309  42.8%  4485 1968s
  6309  3517 30877.3985   33   96 29135.7918 41609.1309  42.8%  4498 1983s
  6350  3531 30746.8501   34  107 29135.7918 41609.1309  42.8%  4504 1999s
  6404  3549 30307.3313   36   92 29135.7918 41609.1309  42.8%  4507 2018s
  6482  3543 29765.8124   41   95 29135.7918 41609.1309  42.8%  4504 2038s
  6552  3539 29570.5849   47   36 29135.7918 41609.1309  42.8%  4493 2055s
  6626  3549 37375.5277   22  258 29135.7918 41609.1309  42.8%  4496 2073s
  6690  3572 35857.3755   24  250 29135.7918 41609.1309  42.8%  4502 2095s
  6765  3585 34547.5349   26  176 29135.7918 41609.1309  42.8%  4510 2113s
  6868  3594 32273.4961   28  157 29135.7918 41609.1309  42.8%  4512 2136s
  6961  3611 30950.6442   32  148 29135.7918 41609.1309  42.8%  4521 2159s
  7058  3615     cutoff   37      29135.7918 41609.1309  42.8%  4534 2184s
  7155  3605 38279.8723   22  311 29135.7918 41609.1309  42.8%  4557 2203s
  7202  3620 37702.1182   23  284 29135.7918 41609.1309  42.8%  4578 2224s
  7285  3618 37452.1237   24  240 29135.7918 41609.1309  42.8%  4602 2239s
  7323  3625 37282.7866   25  246 29135.7918 41609.1309  42.8%  4618 2260s
  7364  3645 36490.0148   26  238 29135.7918 41609.1309  42.8%  4635 2282s
  7432  3666 34588.2647   29  178 29135.7918 41609.1309  42.8%  4649 2304s
  7525  3662 29417.1464   35  127 29135.7918 41609.1309  42.8%  4661 2331s
  7646  3673 35479.3329   24  305 29135.7918 41609.1309  42.8%  4678 2361s
  7760  3650 33124.2961   27  238 29135.7918 41609.1309  42.8%  4707 2387s
  7838  3657 32298.0989   29  264 29135.7918 41609.1309  42.8%  4733 2412s
  7954  3673 31148.5415   32  183 29135.7918 41210.4349  41.4%  4753 2441s
  8065  3692 29217.9304   39  120 29135.7918 40754.8605  39.9%  4785 2470s
  8196  3714 32735.6890   21  202 29135.7918 40754.8605  39.9%  4818 2503s
  8342  3738 31409.5397   24  222 29135.7918 39610.0072  35.9%  4849 2532s
  8497  3743 29539.6316   27  228 29135.7918 39610.0072  35.9%  4879 2567s
  8675  3754 35518.1546   21  328 29135.7918 39379.1773  35.2%  4891 2603s
  8853  3743 30947.7114   26  254 29135.7918 39255.6997  34.7%  4910 2636s
  8950  3742 29376.8377   30  185 29135.7918 39139.4613  34.3%  4930 2670s
  9088  3733 29302.8901   31  187 29135.7918 39139.4613  34.3%  4956 2706s
  9271  3718 29302.0651   32  179 29135.7918 39139.4613  34.3%  4973 2742s
  9477  3710 29388.6829   43  111 29135.7918 39030.7399  34.0%  4991 2779s
  9716  3666 31911.5744   25  301 29135.7918 39030.7399  34.0%  5008 2817s
  9903  3697 infeasible   28      29135.7918 38710.2216  32.9%  5053 2857s
 10159  3690     cutoff   28      29135.7918 38690.3993  32.8%  5076 2901s
 10372  3688 35657.8040   25  337 29135.7918 38495.2168  32.1%  5124 2949s
 10617  3654 infeasible   32      29135.7918 38370.2157  31.7%  5165 2998s
 10917  3663 34555.5581   24  295 29135.7918 38336.6844  31.6%  5192 3046s
 11178  3647 30174.1940   30  191 29135.7918 38137.7797  30.9%  5232 3094s
 11435  3631 36160.2175   23  286 29135.7918 38055.2588  30.6%  5276 3151s
 11715  3612 infeasible   31      29135.7918 38021.4367  30.5%  5317 3203s
 12039  3520 infeasible   31      29135.7918 37889.1622  30.0%  5349 3256s
H12044  3341                    29240.607527 37889.1622  29.6%  5350 3256s
 12199  3397 34232.8124   25  355 29240.6075 37691.9549  28.9%  5363 3311s
 12546  3390     cutoff   36      29240.6075 37603.0456  28.6%  5380 3370s
 12901  3391 30501.7332   33  226 29240.6075 37603.0456  28.6%  5405 3429s
 13259  3381 34264.1672   23  240 29240.6075 37262.2663  27.4%  5437 3488s
 13666  3357 31930.9352   26  209 29240.6075 37115.7844  26.9%  5461 3556s
 14089  3304 29584.1744   39  127 29240.6075 37115.7844  26.9%  5485 3600s

Cutting planes:
  Learned: 1
  MIR: 737
  Mixing: 3
  Flow cover: 1761
  RLT: 19
  Relax-and-lift: 134

Explored 14402 nodes (79313576 simplex iterations) in 3600.07 seconds (7236.40 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 29240.6 29135.8 29100.8 ... 27089.1

Time limit reached
Best objective 2.924060752664e+04, best bound 3.699680497476e+04, gap 26.5254%
  WARNING: Time limit reached. Using best solution found (gap: 26.53%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = 29240.61, θ = 190456.63
  Upper Bound (UB) = 29240.61

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 190456.63
  [DEBUG]   ✓ Scenario 0: θ = 190456.63 ≤ Q = 190456.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 190456.63 ≤ Q = 190456.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 190456.63 ≤ Q = 190456.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 190456.63 ≤ Q = 190456.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 190456.63 ≤ Q = 190456.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 190456.63 ≤ Q = 190456.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 190456.63 ≤ Q = 190456.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 190456.63 ≤ Q = 190456.63 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x667508d
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xf998af73
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.196477e+13
Presolve removed 2622 rows and 1913 columns
Presolve time: 0.01s
Presolved: 471 rows, 476 columns, 1328 nonzeros
Found heuristic solution: objective 5320514.8093
Variable types: 324 continuous, 152 integer (152 binary)

Root relaxation: objective -1.538723e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -153872.27    0  125 5320514.81 -153872.27   103%     -    0s
H    0     0                    -123233.9333 -153872.27  24.9%     -    0s
H    0     0                    -123609.0670 -153872.27  24.5%     -    0s
     0     0 -138193.62    0   86 -123609.07 -138193.62  11.8%     -    0s
H    0     0                    -134296.9207 -138192.88  2.90%     -    0s
     0     0 -138154.34    0   87 -134296.92 -138154.34  2.87%     -    0s
H    0     0                    -136699.0577 -138154.34  1.06%     -    0s
     0     0 -137537.43    0   72 -136699.06 -137537.43  0.61%     -    0s
     0     0 -137450.88    0   72 -136699.06 -137450.88  0.55%     -    0s
     0     0 -137083.55    0   34 -136699.06 -137083.55  0.28%     -    0s
     0     0 -137004.42    0   33 -136699.06 -137004.42  0.22%     -    0s
     0     0 -136979.58    0   34 -136699.06 -136979.58  0.21%     -    0s
     0     0 -136976.78    0   38 -136699.06 -136976.78  0.20%     -    0s
     0     0 -136796.36    0   10 -136699.06 -136796.36  0.07%     -    0s
     0     0 -136766.56    0    8 -136699.06 -136766.56  0.05%     -    0s
     0     0 -136762.10    0    8 -136699.06 -136762.10  0.05%     -    0s
     0     0 -136733.42    0    2 -136699.06 -136733.42  0.03%     -    0s
     0     0 -136729.25    0    5 -136699.06 -136729.25  0.02%     -    0s
H    0     0                    -136718.4677 -136729.25  0.01%     -    0s

Explored 1 nodes (728 simplex iterations) in 0.09 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 6: -136718 -136699 -123609 ... 1.19648e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.367184677219e+05, best bound -1.367292474115e+05, gap 0.0079%
  Subproblem solved in 0.12s
  Worst-case operational profit (Z_SP) = 177705.66
  Scenario: 34 demand increases, 26 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -136718.47
  [DEBUG]   S×d_nominal = 314424.12
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 314424.12 + -136718.47 = 177705.66
  [DEBUG]   Current θ from Master = 190456.63
  [DEBUG]   ⚠️  Z_SP ≤ θ by 12750.97 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 16489.64
  Lower Bound (LB) = 25086.86
  Gap (UB-LB) = 4153.7462, Absolute Gap = 4153.7462, Relative Gap = 0.142054
  Not converged yet (gap = 4153.75 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 34 increases, 26 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394490 nonzeros
Model fingerprint: 0x24719180
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 67266 rows and 27306 columns
Presolve time: 3.00s
Presolved: 71727 rows, 31114 columns, 446249 nonzeros
Variable types: 28855 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -310053.6270
Found heuristic solution: objective -171254.7355

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 71727 rows, 31114 columns, 446249 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   20959   -2.5690648e+05   0.000000e+00   1.008284e+07      5s
   36623   -8.1671901e+04   0.000000e+00   2.092813e+09     10s
   47479   -2.4160386e+04   0.000000e+00   4.590313e+06     15s
   55795   -6.6750779e+02   0.000000e+00   5.783669e+06     20s
   61392    3.9056172e+03   0.000000e+00   1.424421e+07     25s
   67092    1.0389906e+04   0.000000e+00   2.016725e+06     30s
Concurrent spin time: 1.58s

Solved with dual simplex

Root relaxation: objective 5.717431e+04, 52079 iterations, 33.04 seconds (45.99 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 57174.3054    0   69 -171254.74 57174.3054   133%     -   36s
H    0     0                    -162390.2686 57174.3054   135%     -   36s
H    0     0                    -123172.8893 57174.3054   146%     -   37s
H    0     0                    -113051.6290 57174.3054   151%     -   37s
H    0     0                    -98036.64282 57174.3054   158%     -   37s
H    0     0                    -96852.20658 57174.3054   159%     -   37s
H    0     0                    -96809.98135 57174.3054   159%     -   37s
H    0     0                    -61039.16985 57174.3054   194%     -   37s
H    0     0                    -1169.280756 57174.3054  4990%     -   37s
H    0     0                    9865.8972475 57174.3054   480%     -   37s
H    0     0                    10135.274152 57174.3054   464%     -   37s
H    0     0                    11784.549153 57174.3054   385%     -   38s
H    0     0                    14147.338683 57174.2352   304%     -   38s
H    0     0                    16681.525549 57174.2352   243%     -   38s
H    0     0                    17154.510646 54357.0841   217%     -   50s
H    0     0                    17170.322369 54357.0841   217%     -   50s
H    0     0                    17192.388755 54357.0841   216%     -   50s
H    0     0                    17352.102723 54357.0841   213%     -   50s
     0     0 54357.0841    0  170 17352.1027 54357.0841   213%     -   50s
     0     0 54220.1023    0  172 17352.1027 54220.1023   212%     -   55s
     0     0 54220.1023    0  171 17352.1027 54220.1023   212%     -   55s
     0     0 54220.1023    0  172 17352.1027 54220.1023   212%     -   55s
     0     0 51229.4410    0  177 17352.1027 51229.4410   195%     -   69s
H    0     0                    19530.163113 51228.2416   162%     -   70s
H    0     0                    19897.837961 51228.2416   157%     -   70s
H    0     0                    19913.772528 51228.2416   157%     -   70s
H    0     0                    20593.658665 51228.2416   149%     -   70s
H    0     0                    20711.295063 51228.2416   147%     -   70s
H    0     0                    20711.329887 51228.2416   147%     -   70s
H    0     0                    20734.802934 51228.2416   147%     -   70s
H    0     0                    20800.714692 51228.2416   146%     -   70s
     0     0 50467.8594    0  215 20800.7147 50467.8594   143%     -   78s
     0     0 50234.1304    0  215 20800.7147 50234.1304   142%     -   83s
     0     0 50000.1089    0  179 20800.7147 50000.1089   140%     -   88s
     0     0 49975.0773    0  230 20800.7147 49975.0773   140%     -   90s
     0     0 49971.7068    0  234 20800.7147 49971.7068   140%     -   91s
     0     0 49970.9253    0  191 20800.7147 49970.9253   140%     -   92s
     0     0 49970.7380    0  235 20800.7147 49970.7380   140%     -   92s
     0     0 47152.4018    0  286 20800.7147 47152.4018   127%     -  114s
H    0     0                    23148.324120 46383.9946   100%     -  124s
     0     0 46383.9946    0  261 23148.3241 46383.9946   100%     -  124s
     0     0 46137.4352    0  321 23148.3241 46137.4352  99.3%     -  132s
     0     0 46054.8105    0  321 23148.3241 46054.8105  99.0%     -  136s
H    0     0                    23517.618757 45935.6262  95.3%     -  140s
     0     0 45935.6262    0  279 23517.6188 45935.6262  95.3%     -  140s
     0     0 45833.9087    0  283 23517.6188 45833.9087  94.9%     -  144s
     0     0 45795.0770    0  284 23517.6188 45795.0770  94.7%     -  147s
     0     0 45750.7971    0  288 23517.6188 45750.7971  94.5%     -  149s
     0     0 45716.1560    0  327 23517.6188 45716.1560  94.4%     -  151s
     0     0 45709.8589    0  329 23517.6188 45709.8589  94.4%     -  151s
     0     0 45703.8554    0  284 23517.6188 45703.8554  94.3%     -  152s
     0     0 45700.8171    0  323 23517.6188 45700.8171  94.3%     -  153s
     0     0 45699.0642    0  282 23517.6188 45699.0642  94.3%     -  153s
     0     0 45698.5652    0  289 23517.6188 45698.5652  94.3%     -  153s
     0     0 45102.2134    0  363 23517.6188 45102.2134  91.8%     -  164s
     0     0 44980.2152    0  372 23517.6188 44980.2152  91.3%     -  170s
     0     0 44923.0508    0  373 23517.6188 44923.0508  91.0%     -  173s
     0     0 44869.4820    0  382 23517.6188 44869.4820  90.8%     -  176s
     0     0 44848.5038    0  380 23517.6188 44848.5038  90.7%     -  178s
     0     0 44810.7707    0  384 23517.6188 44810.7707  90.5%     -  181s
     0     0 44790.9705    0  379 23517.6188 44790.9705  90.5%     -  183s
     0     0 44784.9776    0  381 23517.6188 44784.9776  90.4%     -  184s
     0     0 44784.4310    0  376 23517.6188 44784.4310  90.4%     -  185s
     0     0 44672.3158    0  385 23517.6188 44672.3158  90.0%     -  191s
H    0     0                    23548.866305 44671.7189  89.7%     -  191s
H    0     0                    23642.598032 44671.7189  88.9%     -  192s
H    0     0                    24073.950133 44671.7189  85.6%     -  192s
H    0     0                    24117.213077 44671.7189  85.2%     -  192s
     0     0 44639.8875    0  393 24117.2131 44639.8875  85.1%     -  193s
     0     0 44623.7544    0  394 24117.2131 44623.7544  85.0%     -  195s
     0     0 44608.5199    0  390 24117.2131 44608.5199  85.0%     -  197s
     0     0 44593.6155    0  389 24117.2131 44593.6155  84.9%     -  198s
     0     0 44591.1815    0  390 24117.2131 44591.1815  84.9%     -  200s
     0     0 44589.6931    0  395 24117.2131 44589.6931  84.9%     -  200s
     0     0 44583.1064    0  390 24117.2131 44583.1064  84.9%     -  202s
     0     0 44576.8584    0  388 24117.2131 44576.8584  84.8%     -  202s
     0     0 44574.2423    0  395 24117.2131 44574.2423  84.8%     -  203s
     0     0 44574.0849    0  396 24117.2131 44574.0849  84.8%     -  204s
     0     0 44518.7567    0  391 24117.2131 44518.7567  84.6%     -  209s
H    0     0                    24525.499345 44517.9117  81.5%     -  211s
     0     0 44487.1430    0  393 24525.4993 44487.1430  81.4%     -  214s
     0     0 44482.1935    0  393 24525.4993 44482.1935  81.4%     -  216s
     0     0 44477.7865    0  398 24525.4993 44477.7865  81.4%     -  217s
     0     0 44475.2588    0  400 24525.4993 44475.2588  81.3%     -  218s
     0     0 44472.8707    0  396 24525.4993 44472.8707  81.3%     -  219s
     0     0 44470.9548    0  395 24525.4993 44470.9548  81.3%     -  219s
     0     0 44470.8402    0  395 24525.4993 44470.8402  81.3%     -  219s
     0     0 44415.0431    0  402 24525.4993 44415.0431  81.1%     -  223s
H    0     0                    24877.981194 44414.7901  78.5%     -  224s
H    0     0                    25129.453113 44414.7901  76.7%     -  224s
H    0     0                    25285.683221 44414.7901  75.7%     -  224s
H    0     0                    25425.938549 44414.7901  74.7%     -  224s
H    0     0                    25505.663419 44414.7901  74.1%     -  224s
H    0     0                    25534.803071 44414.7901  73.9%     -  224s
H    0     0                    25541.684297 44414.7901  73.9%     -  224s
H    0     0                    25556.631414 44414.7901  73.8%     -  224s
H    0     0                    25579.601089 44414.7901  73.6%     -  224s
     0     0 44391.0804    0  401 25579.6011 44391.0804  73.5%     -  226s
     0     0 44387.6624    0  398 25579.6011 44387.6624  73.5%     -  227s
     0     0 44381.5178    0  400 25579.6011 44381.5178  73.5%     -  227s
     0     0 44380.2408    0  401 25579.6011 44380.2408  73.5%     -  228s
     0     0 44341.9676    0  400 25579.6011 44341.9676  73.3%     -  231s
H    0     0                    26245.347588 44341.9647  69.0%     -  232s
H    0     0                    26429.618043 44341.9647  67.8%     -  233s
     0     0 44337.4950    0  409 26429.6180 44337.4950  67.8%     -  234s
     0     0 44330.7508    0  413 26429.6180 44330.7508  67.7%     -  235s
     0     0 44329.1007    0  409 26429.6180 44329.1007  67.7%     -  235s
     0     0 44328.9248    0  413 26429.6180 44328.9248  67.7%     -  236s
     0     0 44325.3743    0  420 26429.6180 44325.3743  67.7%     -  237s
H    0     0                    26519.869718 44324.5854  67.1%     -  237s
     0     0 44324.5854    0  417 26519.8697 44324.5854  67.1%     -  238s
     0     0 44320.0423    0  410 26519.8697 44320.0423  67.1%     -  240s
H    0     0                    26535.769060 44317.9892  67.0%     -  243s
     0     0 44317.9892    0  413 26535.7691 44317.9892  67.0%     -  244s
     0     0 44317.9892    0  415 26535.7691 44317.9892  67.0%     -  245s
H    0     0                    26630.845306 44316.0286  66.4%     -  245s
H    0     0                    26639.856729 44316.0286  66.4%     -  245s
     0     0 44316.0286    0  411 26639.8567 44316.0286  66.4%     -  246s
     0     0 44316.0286    0  411 26639.8567 44316.0286  66.4%     -  247s
     0     0 44315.4837    0  411 26639.8567 44315.4837  66.4%     -  248s
H    0     0                    26737.639856 44315.4776  65.7%     -  293s
H    0     0                    26849.978769 44315.4776  65.0%     -  294s
H    0     2                    27487.739200 44315.4776  61.2%     -  324s
     0     2 44315.4776    0  411 27487.7392 44315.4776  61.2%     -  324s
     1     4 44199.3206    1  401 27487.7392 44315.4776  61.2%  2367  331s
     3     8 44172.0128    2  391 27487.7392 44194.1265  60.8%  3936  339s
     7    16 43908.3548    3  402 27487.7392 44165.1777  60.7%  5327  352s
    15    32 43730.2201    4  395 27487.7392 43905.2030  59.7%  6780  367s
    31    48 42799.0652    5  377 27487.7392 43767.6076  59.2%  9528  398s
H   47    80                    27551.546542 43767.6076  58.9%  9374  419s
H   54    80                    27765.988811 43767.6076  57.6%  9465  419s
H   58    80                    27989.834236 43767.6076  56.4%  9341  419s
    79   171 40869.1578    7  344 27989.8342 43767.6076  56.4%  8528  443s
   170   248 40668.3031    9  328 27989.8342 43767.6076  56.4%  5992  462s
   247   318 40636.3878   10  324 27989.8342 43767.6076  56.4%  5170  480s
   317   379 38870.2668   10  308 27989.8342 43767.6076  56.4%  5067  497s
   378   442 40607.3155   10  324 27989.8342 43767.6076  56.4%  4865  512s
   441   473 40583.4236   11  320 27989.8342 43767.6076  56.4%  4659  525s
   472   522 40399.1464   11  303 27989.8342 43767.6076  56.4%  4553  538s
   523   597 38703.1096   11  303 27989.8342 43767.6076  56.4%  4417  553s
   602   663 40325.0196   11  251 27989.8342 43767.6076  56.4%  4283  568s
   672   694 39624.6643   12  324 27989.8342 43767.6076  56.4%  4357  580s
   710   736 32427.4337   12  240 27989.8342 43767.6076  56.4%  4381  594s
   758   766 39437.6947   12  307 27989.8342 43767.6076  56.4%  4359  608s
   790   820 32012.5537   12  240 27989.8342 43767.6076  56.4%  4397  619s
   856   896 39486.1801   13  307 27989.8342 43767.6076  56.4%  4316  633s
   948   925 30770.9897   12  225 27989.8342 43767.6076  56.4%  4161  647s
   981   950 39197.1646   13  233 27989.8342 43767.6076  56.4%  4166  663s
  1024   981 39080.6076   14  277 27989.8342 43767.6076  56.4%  4134  674s
  1069  1026 38920.2149   16  279 27989.8342 43767.6076  56.4%  4197  683s
  1124  1077 38879.2632   17  287 27989.8342 43767.6076  56.4%  4140  699s
  1189  1130 36976.3558   16  203 27989.8342 43767.6076  56.4%  4087  716s
  1266  1178 38546.0811   18  261 27989.8342 43767.6076  56.4%  4046  733s
  1328  1218 38341.7130   18  213 27989.8342 43767.6076  56.4%  4052  750s
  1404  1262 36877.7927   17  211 27989.8342 43767.6076  56.4%  4083  769s
  1486  1313 38490.9158   19  258 27989.8342 43767.6076  56.4%  4029  786s
  1579  1361 38367.8203   19  280 27989.8342 43767.6076  56.4%  4016  803s
  1655  1426 37111.8698   19  164 27989.8342 43767.6076  56.4%  4082  821s
  1744  1508 37740.4028   20  290 27989.8342 43767.6076  56.4%  4135  837s
  1852  1583 37572.8467   21  288 27989.8342 43767.6076  56.4%  4138  858s
  1979  1607 37673.5033   20  279 27989.8342 43613.5464  55.8%  4112  879s
  2017  1651 37543.4211   22  260 27989.8342 43604.7785  55.8%  4153  896s
  2081  1733 37504.0227   23  225 27989.8342 43604.7785  55.8%  4148  914s
  2210  1828 37453.1220   24  206 27989.8342 43604.7785  55.8%  4072  935s
  2349  1929 35703.8539   26  200 27989.8342 43604.7785  55.8%  4070  955s
  2506  2066 36348.0902   27  202 27989.8342 43604.7785  55.8%  4085  977s
  2685  2171 34859.8291   30  177 27989.8342 42782.2596  52.8%  4099 1002s
  2848  2268 34670.6117   32  171 27989.8342 42782.2596  52.8%  4123 1026s
  3034  2376 33608.0962   34  179 27989.8342 42600.6188  52.2%  4133 1052s
  3226  2513 33138.2634   36  153 27989.8342 42600.6188  52.2%  4160 1077s
  3449  2621 31907.0174   38  138 27989.8342 42600.6188  52.2%  4144 1105s
  3622  2726 30013.6562   41  203 27989.8342 42600.6188  52.2%  4204 1133s
  3815  2860 29884.0841   43  135 27989.8342 42600.6188  52.2%  4251 1157s
  4044  2861 29068.2914   34  411 27989.8342 42263.9599  51.0%  4263 1222s
  4046  2862 37890.7206   14   69 27989.8342 42263.9599  51.0%  4261 1263s
  4047  2863 37116.3974   10  290 27989.8342 42263.9599  51.0%  4260 1285s
  4048  2864 31370.2522    9  267 27989.8342 42263.9599  51.0%  4259 1301s
  4049  2864 33139.0525   33  340 27989.8342 42263.9599  51.0%  4258 1313s
  4050  2865 30870.6471   45  365 27989.8342 42263.9599  51.0%  4257 1321s
  4051  2866 37628.4106   19  374 27989.8342 42263.9599  51.0%  4256 1328s
  4052  2866 30905.2711   29  382 27989.8342 42263.9599  51.0%  4254 1334s
  4053  2867 33046.2812   41  384 27989.8342 42263.9599  51.0%  4253 1338s
  4054  2868 31048.1878   62  391 27989.8342 42263.9599  51.0%  4252 1343s
  4055  2868 32379.2883   23  419 27989.8342 42263.9599  51.0%  4251 1348s
  4056  2869 38368.9196   19  388 27989.8342 42263.9599  51.0%  4250 1351s
  4058  2870 30949.3062   48  394 27989.8342 42263.9599  51.0%  4248 1355s
  4059  2871 31569.0825   41  391 27989.8342 42263.9599  51.0%  4247 1361s
  4062  2873 37472.8994   28  400 27989.8342 42263.9599  51.0%  4244 1366s
  4063  2874 30403.7180   40  425 27989.8342 42263.9599  51.0%  4243 1372s
  4065  2875 31210.2837   57  403 27989.8342 42263.9599  51.0%  4241 1380s
  4068  2877 36528.7553   16  439 27989.8342 42263.9599  51.0%  4238 1390s
  4070  2878 28944.6872   53  448 27989.8342 42263.9599  51.0%  4236 1395s
  4071  2879 37381.5979   15  424 27989.8342 42263.9599  51.0%  4235 1401s
  4073  2880 33556.2204   16  441 27989.8342 42263.9599  51.0%  4233 1412s
  4075  2882 29692.8257   39  439 27989.8342 42263.9599  51.0%  4230 1417s
  4076  2882 30279.1657   74  442 27989.8342 42263.9599  51.0%  4229 1421s
  4078  2884 37242.7414   23  411 27989.8342 42263.9599  51.0%  4227 1429s
  4079  2884 36642.2060   23  392 27989.8342 42263.9599  51.0%  4226 1433s
  4080  2885 31149.8398   36  418 27989.8342 42263.9599  51.0%  4225 1439s
  4081  2886 37066.9266   23  418 27989.8342 42263.9599  51.0%  4224 1482s
  4082  2886 32789.8371   40  418 27989.8342 42263.9599  51.0%  4223 1523s
  4083  2890 42263.9599   11  392 27989.8342 42263.9599  51.0%  4268 1547s
  4085  2893 42263.9599   12  396 27989.8342 42263.9599  51.0%  4269 1580s
  4089  2900 42263.9599   13  394 27989.8342 42263.9599  51.0%  4274 1616s
  4097  2913 42263.9599   14  420 27989.8342 42263.9599  51.0%  4283 1649s
  4113  2924 42263.9599   15  404 27989.8342 42263.9599  51.0%  4323 1702s
  4129  2950 40310.0361   16  377 27989.8342 42263.9599  51.0%  4352 1739s
  4160  3075 40053.2962   17  369 27989.8342 42263.9599  51.0%  4392 1777s
  4296  3087 39593.9373   21  372 27989.8342 42263.9599  51.0%  4403 1798s
  4353  3135 39366.7166   21  331 27989.8342 42263.9599  51.0%  4402 1816s
  4420  3143 39428.1564   22  379 27989.8342 42263.9599  51.0%  4394 1827s
  4452  3165 38332.5038   21  310 27989.8342 42263.9599  51.0%  4402 1844s
  4494  3185 35108.7657   22  361 27989.8342 42263.9599  51.0%  4414 1861s
  4545  3224 39187.4334   22  326 27989.8342 42263.9599  51.0%  4410 1878s
  4615  3242 30531.1153   21  269 27989.8342 42263.9599  51.0%  4402 1895s
  4687  3241 34773.3005   22  339 27989.8342 42263.9599  51.0%  4391 1911s
  4771  3252 37979.1872   22  338 27989.8342 42263.9599  51.0%  4362 1938s
  4845  3232 35780.2632   24  312 27989.8342 42263.9599  51.0%  4356 1960s
  4927  3244 35562.3635   24  335 27989.8342 42263.9599  51.0%  4351 1978s
  4990  3244 35389.6448   25  242 27989.8342 42263.9599  51.0%  4366 2002s
  5053  3257 35136.9917   27  256 27989.8342 42263.9599  51.0%  4381 2029s
  5112  3259 33863.0244   29  219 27989.8342 42263.9599  51.0%  4409 2043s
  5152  3285 33793.3887   30  202 27989.8342 42263.9599  51.0%  4423 2058s
  5206  3297 30335.0702   30  205 27989.8342 42263.9599  51.0%  4437 2081s
  5264  3319 32910.7565   33  217 27989.8342 42263.9599  51.0%  4445 2100s
  5340  3344 31607.9115   35  184 27989.8342 42263.9599  51.0%  4458 2119s
  5426  3350 30623.9021   37  254 27989.8342 42263.9599  51.0%  4449 2139s
  5518  3350 29836.4019   36  174 27989.8342 42263.9599  51.0%  4435 2168s
  5620  3366 30214.7188   38  196 27989.8342 42263.9599  51.0%  4437 2191s
  5722  3366 30614.7330   38  206 27989.8342 42263.9599  51.0%  4436 2213s
  5837  3353     cutoff   41      27989.8342 42263.9599  51.0%  4437 2239s
  5935  3342 36509.3876   21  345 27989.8342 41156.6351  47.0%  4459 2265s
  6040  3360 33111.0447   24  331 27989.8342 40511.4791  44.7%  4481 2289s
  6128  3391 31827.0391   27  271 27989.8342 40511.4791  44.7%  4530 2314s
  6228  3382 30355.3866   30  242 27989.8342 40511.4791  44.7%  4562 2339s
  6267  3397 30309.4534   31  223 27989.8342 40511.4791  44.7%  4582 2364s
  6313  3411 30211.1186   32  195 27989.8342 40511.4791  44.7%  4609 2391s
  6370  3446     cutoff   34      27989.8342 40511.4791  44.7%  4628 2414s
  6467  3455 31766.6216   27  218 27989.8342 40511.4791  44.7%  4649 2444s
  6591  3475 29219.3451   32  173 27989.8342 40511.4791  44.7%  4670 2476s
  6729  3484 34436.6864   23  280 27989.8342 40511.4791  44.7%  4690 2513s
  6877  3507 33245.1920   25  264 27989.8342 40511.4791  44.7%  4716 2549s
  7020  3534 31035.4621   28  265 27989.8342 40059.7778  43.1%  4746 2584s
  7221  3528 28301.4638   34  193 27989.8342 39509.5645  41.2%  4733 2618s
  7412  3513 38213.4974   26  359 27989.8342 39509.5645  41.2%  4725 2656s
  7630  3524 33077.3525   29  383 27989.8342 39509.5645  41.2%  4723 2693s
  7784  3552 32292.6662   30  338 27989.8342 39509.5645  41.2%  4777 2730s
  7937  3605 30858.8682   32  298 27989.8342 39184.7172  40.0%  4826 2768s
  8105  3613     cutoff   33      27989.8342 39184.7172  40.0%  4878 2804s
  8330  3626     cutoff   34      27989.8342 38880.9183  38.9%  4902 2848s
  8558  3639 29311.4226   38  215 27989.8342 38880.9183  38.9%  4928 2890s
  8851  3626 28821.6987   33  195 27989.8342 38541.1438  37.7%  4922 2932s
  9067  3616 30839.8349   24  336 27989.8342 38413.9074  37.2%  4940 2974s
  9181  3652 32984.5381   24  324 27989.8342 38413.9074  37.2%  4948 3016s
  9361  3655     cutoff   27      27989.8342 38413.9074  37.2%  4961 3063s
  9557  3718 35346.9738   22  226 27989.8342 38333.3160  37.0%  4979 3110s
  9840  3777 32579.8713   28  207 27989.8342 38221.6198  36.6%  4980 3158s
 10200  3775 28668.6093   37  173 27989.8342 38024.4591  35.9%  4975 3212s
 10599  3792 30719.8121   28  229 27989.8342 37875.6573  35.3%  4959 3268s
 10956  3848 32075.2896   26  335 27989.8342 37732.1909  34.8%  4975 3323s
 11323  3902     cutoff   29      27989.8342 37637.1787  34.5%  4995 3383s
 11738  3930 33639.4542   25  304 27989.8342 37602.1936  34.3%  4998 3443s
 12169  3945 28566.1785   33  204 27989.8342 37602.1936  34.3%  5009 3499s
 12471  4040 34452.1897   19  202 27989.8342 37332.8484  33.4%  5023 3561s
 12938  4057 29222.8218   31  152 27989.8342 37164.8365  32.8%  5027 3600s

Cutting planes:
  Learned: 1
  Gomory: 1
  MIR: 828
  Flow cover: 1848
  RLT: 13
  Relax-and-lift: 112

Explored 13234 nodes (67062570 simplex iterations) in 3600.04 seconds (7135.55 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 27989.8 27766 27551.5 ... 26519.9

Time limit reached
Best objective 2.798983423580e+04, best bound 3.713280189185e+04, gap 32.6653%
  WARNING: Time limit reached. Using best solution found (gap: 32.67%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.05s
  Master Objective (UB) = 27989.83, θ = 187685.60
  Upper Bound (UB) = 27989.83

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 187685.60
  [DEBUG]   ✓ Scenario 0: θ = 187685.60 ≤ Q = 187685.60 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 187685.60 ≤ Q = 187685.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 187685.60 ≤ Q = 187685.60 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 187685.60 ≤ Q = 187685.60 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 187685.60 ≤ Q = 187919.04 (slack: 233.44)
  [DEBUG]   ✓ Scenario 5: θ = 187685.60 ≤ Q = 187685.60 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 187685.60 ≤ Q = 187685.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 187685.60 ≤ Q = 187685.60 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 187685.60 ≤ Q = 188844.95 (slack: 1159.35)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x1c8c4336
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xe373bcca
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.245953e+13
Presolve removed 2623 rows and 1914 columns
Presolve time: 0.01s
Presolved: 470 rows, 475 columns, 1325 nonzeros
Found heuristic solution: objective 5692704.1749
Variable types: 323 continuous, 152 integer (152 binary)

Root relaxation: objective -1.571120e+05, 241 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -157112.00    0  127 5692704.17 -157112.00   103%     -    0s
H    0     0                    -122633.2531 -157112.00  28.1%     -    0s
H    0     0                    -123315.9782 -157112.00  27.4%     -    0s
     0     0 -135551.28    0   43 -123315.98 -135551.28  9.92%     -    0s
H    0     0                    -129851.9137 -135533.01  4.38%     -    0s
H    0     0                    -131544.1698 -135533.01  3.03%     -    0s
H    0     0                    -131976.2306 -134022.13  1.55%     -    0s
     0     0 -134022.13    0   35 -131976.23 -134022.13  1.55%     -    0s
     0     0 -133890.98    0   40 -131976.23 -133890.98  1.45%     -    0s
     0     0 -133795.93    0   34 -131976.23 -133795.93  1.38%     -    0s
H    0     0                    -132344.9374 -133791.85  1.09%     -    0s
H    0     0                    -133488.3052 -133791.85  0.23%     -    0s
H    0     0                    -133499.8149 -133766.60  0.20%     -    0s
     0     0 -133766.60    0   40 -133499.81 -133766.60  0.20%     -    0s
     0     0 -133766.60    0   40 -133499.81 -133766.60  0.20%     -    0s
     0     0 -133757.75    0   33 -133499.81 -133757.75  0.19%     -    0s
     0     0 -133608.86    0   21 -133499.81 -133608.86  0.08%     -    0s
     0     0 -133581.94    0    7 -133499.81 -133581.94  0.06%     -    0s
     0     0 -133570.38    0    6 -133499.81 -133570.38  0.05%     -    0s
     0     0 -133569.04    0    6 -133499.81 -133569.04  0.05%     -    0s
H    0     0                    -133510.9489 -133569.04  0.04%     -    0s
H    0     0                    -133525.9918 -133569.04  0.03%     -    0s
     0     0 -133540.58    0    7 -133525.99 -133540.58  0.01%     -    0s

Cutting planes:
  Implied bound: 3
  MIR: 4
  Flow cover: 1
  RLT: 5
  Relax-and-lift: 1

Explored 1 nodes (557 simplex iterations) in 0.23 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -133526 -133511 -133500 ... -122633

Optimal solution found (tolerance 1.00e-04)
Best objective -1.335259917528e+05, best bound -1.335386299805e+05, gap 0.0095%
  Subproblem solved in 0.26s
  Worst-case operational profit (Z_SP) = 180718.82
  Scenario: 6 demand increases, 54 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -133525.99
  [DEBUG]   S×d_nominal = 314244.81
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 314244.81 + -133525.99 = 180718.82
  [DEBUG]   Current θ from Master = 187685.60
  [DEBUG]   ⚠️  Z_SP ≤ θ by 6966.79 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 21023.05
  Lower Bound (LB) = 25086.86
  Gap (UB-LB) = 2902.9729, Absolute Gap = 2902.9729, Relative Gap = 0.103715
  Not converged yet (gap = 2902.97 > ε = 200)

  [DEBUG] Adding NEW scenario 9 to Master Problem...
  [DEBUG] New scenario pattern: 6 increases, 54 decreases
    [DEBUG] Scenario 9 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 9 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 9]
    [DEBUG]   - Total constraints in model: 154283
    [DEBUG]   - Total variables in model: 64660
  [DEBUG] Total scenarios in Master: 10
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 10
================================================================================
[Iteration 10] Solving Master Problem...
  Current scenarios in Master: 10
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 154283 rows, 64660 columns and 437709 nonzeros
Model fingerprint: 0x5cb9853c
Variable types: 62401 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 74740 rows and 30340 columns
Presolve time: 2.22s
Presolved: 79543 rows, 34320 columns, 489159 nonzeros
Variable types: 32061 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -310053.6270
Found heuristic solution: objective -171254.7355

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 79543 rows, 34320 columns, 489159 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   26381   -1.7221210e+05   0.000000e+00   4.995304e+06      5s
   39991   -5.7260837e+04   0.000000e+00   7.969716e+07     10s
   48028   -2.0924214e+04   0.000000e+00   1.777215e+07     15s
   54932   -1.4791731e+03   0.000000e+00   4.519611e+06     20s
   58957   -1.0034785e+02   0.000000e+00   2.530091e+07     25s
   65556    2.1661091e+04   0.000000e+00   5.029283e+06     30s
   72026    2.7378102e+04   0.000000e+00   1.794685e+07     35s
   76342    2.8258054e+04   0.000000e+00   4.433932e+06     40s
   80367    2.8540974e+04   0.000000e+00   8.061575e+07     45s
   85468    3.5488768e+04   0.000000e+00   1.536265e+08     50s
Concurrent spin time: 7.79s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 5.714297e+04, 60559 iterations, 59.03 seconds (76.46 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 57142.9679    0   67 -171254.74 57142.9679   133%     -   62s
H    0     0                    -162390.2686 57142.9679   135%     -   62s
H    0     0                    -62138.06829 57142.9679   192%     -   66s
H    0     0                    -60059.72652 57142.9679   195%     -   66s
H    0     0                    -13363.38791 57142.9679   528%     -   66s
H    0     0                    -7929.991809 57142.9679   821%     -   66s
H    0     0                    -5554.037766 57142.9679  1129%     -   66s
H    0     0                    4267.0750648 57142.9679  1239%     -   67s
H    0     0                    9483.4917916 57142.9679   503%     -   67s
H    0     0                    11191.332519 57142.9679   411%     -   67s
H    0     0                    14194.930065 57142.9679   303%     -   67s
H    0     0                    15511.250898 57142.9679   268%     -   68s
H    0     0                    15712.890560 57142.9679   264%     -   68s
H    0     0                    16203.766079 57142.9679   253%     -   68s
     0     0 52746.1220    0  187 16203.7661 52746.1220   226%     -   83s
H    0     0                    16544.752878 52746.0673   219%     -   84s
H    0     0                    16612.444890 52746.0673   218%     -   84s
H    0     0                    16731.667238 52746.0673   215%     -   84s
     0     0 52372.8080    0  191 16731.6672 52372.8080   213%     -   91s
     0     0 52372.8080    0  201 16731.6672 52372.8080   213%     -   93s
     0     0 52372.8080    0  205 16731.6672 52372.8080   213%     -   93s
     0     0 52371.4061    0  194 16731.6672 52371.4061   213%     -   93s
     0     0 52371.3993    0  194 16731.6672 52371.3993   213%     -   93s
     0     0 49735.4466    0  247 16731.6672 49735.4466   197%     -  110s
H    0     0                    17696.622438 49735.4245   181%     -  110s
H    0     0                    18638.520789 49735.4245   167%     -  110s
H    0     0                    20473.927593 49735.4245   143%     -  110s
H    0     0                    20500.590403 49735.4245   143%     -  110s
     0     0 48535.0799    0  355 20500.5904 48535.0799   137%     -  126s
     0     0 48388.7107    0  321 20500.5904 48388.7107   136%     -  135s
     0     0 48350.2736    0  207 20500.5904 48350.2736   136%     -  138s
     0     0 48337.8205    0  205 20500.5904 48337.8205   136%     -  139s
     0     0 48334.3994    0  228 20500.5904 48334.3994   136%     -  141s
     0     0 48333.4106    0  228 20500.5904 48333.4106   136%     -  142s
     0     0 48333.3595    0  227 20500.5904 48333.3595   136%     -  142s
     0     0 46502.6911    0  342 20500.5904 46502.6911   127%     -  173s
H    0     0                    22045.757453 46502.5447   111%     -  173s
H    0     0                    22764.929469 46502.5447   104%     -  173s
H    0     0                    23062.311078 46502.5447   102%     -  173s
H    0     0                    23477.149946 46502.5447  98.1%     -  174s
H    0     0                    23584.569763 46502.5447  97.2%     -  174s
H    0     0                    25129.025603 46502.5447  85.1%     -  174s
H    0     0                    25496.385138 46502.5447  82.4%     -  174s
H    0     0                    25667.618404 46502.5447  81.2%     -  174s
     0     0 46092.4681    0  318 25667.6184 46092.4681  79.6%     -  182s
     0     0 45979.7100    0  354 25667.6184 45979.7100  79.1%     -  189s
     0     0 45934.4030    0  348 25667.6184 45934.4030  79.0%     -  192s
     0     0 45909.4227    0  353 25667.6184 45909.4227  78.9%     -  195s
     0     0 45830.1906    0  364 25667.6184 45830.1906  78.6%     -  200s
     0     0 45808.7360    0  340 25667.6184 45808.7360  78.5%     -  203s
     0     0 45749.1661    0  332 25667.6184 45749.1661  78.2%     -  207s
     0     0 45721.6687    0  335 25667.6184 45721.6687  78.1%     -  210s
     0     0 45715.8456    0  336 25667.6184 45715.8456  78.1%     -  212s
     0     0 45712.7276    0  337 25667.6184 45712.7276  78.1%     -  212s
     0     0 45710.2074    0  332 25667.6184 45710.2074  78.1%     -  213s
     0     0 45710.1644    0  332 25667.6184 45710.1644  78.1%     -  214s
     0     0 45053.3770    0  360 25667.6184 45053.3770  75.5%     -  232s
H    0     0                    25867.264674 45053.2738  74.2%     -  232s
H    0     0                    25917.579271 45053.2738  73.8%     -  232s
     0     0 44905.6474    0  355 25917.5793 44905.6474  73.3%     -  239s
     0     0 44836.6204    0  366 25917.5793 44836.6204  73.0%     -  244s
     0     0 44787.4170    0  372 25917.5793 44787.4170  72.8%     -  249s
     0     0 44753.0800    0  374 25917.5793 44753.0800  72.7%     -  253s
     0     0 44740.1326    0  370 25917.5793 44740.1326  72.6%     -  256s
     0     0 44733.7117    0  374 25917.5793 44733.7117  72.6%     -  258s
     0     0 44718.2378    0  372 25917.5793 44718.2378  72.5%     -  260s
     0     0 44713.2550    0  368 25917.5793 44713.2550  72.5%     -  261s
     0     0 44707.8869    0  371 25917.5793 44707.8869  72.5%     -  263s
     0     0 44704.9247    0  373 25917.5793 44704.9247  72.5%     -  264s
     0     0 44703.9992    0  373 25917.5793 44703.9992  72.5%     -  264s
     0     0 44573.4677    0  376 25917.5793 44573.4677  72.0%     -  271s
H    0     0                    26051.192353 44573.2606  71.1%     -  272s
     0     0 44537.3401    0  385 26051.1924 44537.3401  71.0%     -  275s
     0     0 44521.4377    0  384 26051.1924 44521.4377  70.9%     -  277s
     0     0 44511.0281    0  388 26051.1924 44511.0281  70.9%     -  279s
     0     0 44507.0428    0  387 26051.1924 44507.0428  70.8%     -  280s
     0     0 44492.7211    0  383 26051.1924 44492.7211  70.8%     -  283s
     0     0 44485.5953    0  384 26051.1924 44485.5953  70.8%     -  285s
     0     0 44484.1393    0  386 26051.1924 44484.1393  70.8%     -  286s
     0     0 44421.8138    0  385 26051.1924 44421.8138  70.5%     -  291s
     0     0 44360.5034    0  394 26051.1924 44360.5034  70.3%     -  296s
     0     0 44344.9277    0  394 26051.1924 44344.9277  70.2%     -  298s
     0     0 44339.4581    0  389 26051.1924 44339.4581  70.2%     -  299s
     0     0 44335.6099    0  398 26051.1924 44335.6099  70.2%     -  300s
     0     0 44335.2935    0  395 26051.1924 44335.2935  70.2%     -  301s
     0     0 44297.5878    0  398 26051.1924 44297.5878  70.0%     -  304s
H    0     0                    26517.181133 44297.1486  67.1%     -  305s
     0     0 44287.2294    0  399 26517.1811 44287.2294  67.0%     -  307s
     0     0 44281.8881    0  407 26517.1811 44281.8881  67.0%     -  310s
     0     0 44280.7152    0  406 26517.1811 44280.7152  67.0%     -  311s
     0     0 44272.5100    0  408 26517.1811 44272.5100  67.0%     -  314s
     0     0 44265.7750    0  413 26517.1811 44265.7750  66.9%     -  318s
     0     0 44260.2491    0  407 26517.1811 44260.2491  66.9%     -  320s
     0     0 44257.5081    0  409 26517.1811 44257.5081  66.9%     -  321s
     0     0 44256.7958    0  408 26517.1811 44256.7958  66.9%     -  322s
     0     0 44248.1615    0  403 26517.1811 44248.1615  66.9%     -  325s
     0     0 44244.5049    0  403 26517.1811 44244.5049  66.9%     -  327s
     0     0 44243.0708    0  402 26517.1811 44243.0708  66.8%     -  329s
     0     0 44239.6773    0  405 26517.1811 44239.6773  66.8%     -  331s
     0     0 44237.4295    0  405 26517.1811 44237.4295  66.8%     -  332s
     0     0 44237.0503    0  404 26517.1811 44237.0503  66.8%     -  333s
     0     0 44236.0463    0  407 26517.1811 44236.0463  66.8%     -  334s
     0     0 44235.5016    0  405 26517.1811 44235.5016  66.8%     -  335s
     0     0 44233.3043    0  402 26517.1811 44233.3043  66.8%     -  337s
     0     0 44232.5653    0  402 26517.1811 44232.5653  66.8%     -  339s
     0     2 44232.5653    0  402 26517.1811 44232.5653  66.8%     -  413s
     1     4 44165.0487    1  399 26517.1811 44229.8257  66.8%  5824  424s
     3     8 44114.9508    2  397 26517.1811 44164.8399  66.6%  5932  432s
     7    15 44027.5255    3  388 26517.1811 44124.2126  66.4%  5506  452s
    14    30 43899.7759    4  392 26517.1811 44123.6297  66.4%  7520  469s
    29    45 43742.3438    5  395 26517.1811 43899.6116  65.6% 11484  510s
    44    77 42614.4492    6  360 26517.1811 43899.6116  65.6% 11186  597s
H   45    77                    26544.378395 43899.6116  65.4% 10937  597s
    76   175 42433.2857    7  347 26544.3784 43764.2963  64.9% 10836  623s
   174   240 42054.4479   10  340 26544.3784 43762.6404  64.9%  7653  644s
   239   301 41909.5903   12  335 26544.3784 43762.6404  64.9%  6715  662s
   300   363 41752.9743   13  333 26544.3784 43762.6404  64.9%  6440  681s
   362   436 41700.0266   14  399 26544.3784 43762.6404  64.9%  5952  698s
   435   496 41065.0146   16  309 26544.3784 43762.6404  64.9%  5483  715s
H  458   496                    26626.222928 43762.6404  64.4%  5436  715s
   495   562 40950.8100   17  314 26626.2229 43762.6404  64.4%  5271  733s
   567   594 40481.9822   20  308 26626.2229 43762.6404  64.4%  4964  772s
   599   659 40462.1516   21  302 26626.2229 43762.6404  64.4%  4905  790s
H  612   659                    26705.836444 43762.6404  63.9%  4859  790s
H  622   659                    26729.977650 43762.6404  63.7%  4824  790s
   664   734 40167.4214   23  298 26729.9777 43762.6404  63.7%  4711  806s
   739   802 39296.1651   26  301 26729.9777 43762.6404  63.7%  4552  821s
H  747   802                    26899.179699 43762.6404  62.7%  4524  821s
   807   900 39293.2864   27  296 26899.1797 43762.6404  62.7%  4362  838s
H  907   976                    26900.077880 43762.6404  62.7%  4100  854s
H  910   976                    26969.436362 43762.6404  62.3%  4092  854s
H  917   976                    27089.466823 43762.6404  61.5%  4073  854s
H  952   976                    27103.899976 43762.6404  61.5%  3991  854s
   987  1088 38834.7200   36  270 27103.9000 43762.6404  61.5%  3940  870s
  1105  1119 38552.3147   41  256 27103.9000 43762.6404  61.5%  3710  883s
  1138  1180 38442.8692   42  255 27103.9000 43762.6404  61.5%  3670  900s
  1201  1259 37989.0969   43  253 27103.9000 43762.6404  61.5%  3594  914s
  1286  1342 37965.8130   44  283 27103.9000 43762.6404  61.5%  3464  933s
  1402  1369 37587.4778   46  273 27103.9000 43762.6404  61.5%  3317  946s
  1441  1401 37230.9212   47  254 27103.9000 43762.6404  61.5%  3295  968s
  1497  1439 37203.0036   48  240 27103.9000 43696.6556  61.2%  3267  986s
  1551  1465 37100.1433   49  238 27103.9000 43696.6556  61.2%  3226 1005s
  1581  1514 37006.3136   50  296 27103.9000 43696.6556  61.2%  3226 1026s
  1654  1581 36949.1113   51  240 27103.9000 43521.4606  60.6%  3167 1047s
  1745  1603 36580.5861   52  300 27103.9000 43517.2889  60.6%  3115 1071s
  1825  1685 36354.8251   53  218 27103.9000 43517.2889  60.6%  3109 1096s
  1935  1766 35983.8231   54  209 27103.9000 43517.2889  60.6%  3067 1125s
  2058  1835 35588.7215   56  217 27103.9000 43517.2889  60.6%  3016 1152s
  2179  1942 32349.9818   65  105 27103.9000 43517.2889  60.6%  3007 1180s
  2308  2038 31602.5827   79   91 27103.9000 43517.2889  60.6%  2995 1206s
  2446  2175 39413.3830   24  266 27103.9000 43348.8857  59.9%  2986 1237s
  2608  2326 40551.9510   11  293 27103.9000 43348.8857  59.9%  2934 1264s
  2823  2449 39802.8681   12  272 27103.9000 43348.8857  59.9%  2851 1300s
  3018  2511 38652.5192   15  264 27103.9000 43348.8857  59.9%  2793 1336s
  3141  2610 34839.4124   19  203 27103.9000 43348.8857  59.9%  2833 1371s
  3270  2698 32084.2220   25  265 27103.9000 43348.8857  59.9%  2871 1408s
  3416  2800 30951.3687   29  207 27103.9000 43348.8857  59.9%  2893 1446s
  3568  2912 29000.5028   39  164 27103.9000 43218.6619  59.5%  2899 1485s
  3750  2913 33976.0021   45  402 27103.9000 43218.6619  59.5%  2907 1578s
  3752  2914 29370.1714   30   67 27103.9000 43218.6619  59.5%  2905 1641s
  3753  2915 33095.0694   54  267 27103.9000 43218.6619  59.5%  2904 1680s
  3754  2916 30399.0020   29  319 27103.9000 43218.6619  59.5%  2904 1700s
  3755  2916 35282.6635   18  373 27103.9000 43218.6619  59.5%  2903 1714s
  3756  2917 36891.3531   29  390 27103.9000 43218.6619  59.5%  2902 1727s
  3757  2918 30612.3329   40  402 27103.9000 43218.6619  59.5%  2901 1740s
  3758  2918 39272.6939   29  388 27103.9000 43218.6619  59.5%  2900 1747s
  3759  2919 29613.1489   63  392 27103.9000 43218.6619  59.5%  2900 1751s
  3761  2920 39568.9500   15  393 27103.9000 43218.6619  59.5%  2898 1760s
  3762  2921 29081.3467   65  404 27103.9000 43218.6619  59.5%  2897 1765s
  3764  2922 35473.8731   24  401 27103.9000 43218.6619  59.5%  2896 1770s
  3766  2924 39695.8604   12  408 27103.9000 43218.6619  59.5%  2894 1776s
  3767  2924 38762.3931   23  504 27103.9000 43218.6619  59.5%  2894 1781s
  3769  2926 29546.4056   33  406 27103.9000 43218.6619  59.5%  2892 1785s
  3771  2927 41037.2175   16  410 27103.9000 43218.6619  59.5%  2890 1790s
  3772  2928 28943.1464   17  401 27103.9000 43218.6619  59.5%  2890 1801s
  3774  2929 41368.1557   14  413 27103.9000 43218.6619  59.5%  2888 1806s
  3776  2930 40044.6456   16  416 27103.9000 43218.6619  59.5%  2887 1815s
  3778  2932 39653.0304   35  447 27103.9000 43218.6619  59.5%  2885 1821s
  3780  2933 31326.4969   52  410 27103.9000 43218.6619  59.5%  2884 1832s
  3781  2934 35350.5103   55  442 27103.9000 43218.6619  59.5%  2883 1836s
  3783  2935 29802.6527   57  446 27103.9000 43218.6619  59.5%  2881 1842s
  3784  2936 37527.0751   37  470 27103.9000 43218.6619  59.5%  2881 1849s
  3785  2936 28447.4443   52  518 27103.9000 43218.6619  59.5%  2880 1850s
  3787  2938 28542.4024   23  415 27103.9000 43218.6619  59.5%  2878 1864s
  3788  2938 28254.2198  105  456 27103.9000 43218.6619  59.5%  2878 1868s
  3789  2939 40957.4921   13  459 27103.9000 43218.6619  59.5%  2877 1871s
  3790  2940 39978.9081    7  461 27103.9000 43218.6619  59.5%  2876 1877s
  3791  2940 34408.6777   42  457 27103.9000 43218.6619  59.5%  2875 1880s
  3793  2942 33704.9690   45  452 27103.9000 43218.6619  59.5%  2874 1885s
  3794  2942 37296.0869   21  449 27103.9000 43218.6619  59.5%  2873 1891s
  3796  2944 39100.7217   23  453 27103.9000 43218.6619  59.5%  2871 1897s
  3797  2944 30947.6181   44  451 27103.9000 43218.6619  59.5%  2871 1903s
  3798  2945 41037.2175   16  449 27103.9000 43218.6619  59.5%  2870 1906s
  3799  2946 32207.2064   31  446 27103.9000 43218.6619  59.5%  2869 1911s
  3800  2946 42644.9831    7  446 27103.9000 43218.6619  59.5%  2868 1968s
  3801  2947 41199.1145   14  446 27103.9000 43218.6619  59.5%  2868 2014s
  3802  2950 42589.0523   13  335 27103.9000 43218.6619  59.5%  2938 2052s
  3803  2952 40994.9865   14  335 27103.9000 43218.6619  59.5%  2940 2066s
  3806  2957 40913.5981   15  325 27103.9000 43218.6619  59.5%  2942 2093s
  3812  2967 40259.8830   16  339 27103.9000 43218.6619  59.5%  2948 2129s
  3824  2975 41570.3025   16  391 27103.9000 43218.6619  59.5%  3000 2201s
  3836  3003 40684.6071   17  367 27103.9000 43218.6619  59.5%  3030 2276s
  3868  3098 39358.6128   18  390 27103.9000 43031.4659  58.8%  3155 2321s
  3973  3134 38520.2840   20  366 27103.9000 43031.0793  58.8%  3303 2350s
  4044  3175 38027.6306   21  364 27103.9000 43031.0793  58.8%  3333 2379s
  4111  3200 38393.4536   20  361 27103.9000 43031.0793  58.8%  3342 2404s
  4171  3221 37625.7625   22  307 27103.9000 43031.0793  58.8%  3354 2431s
  4230  3250 32995.2347   23  309 27103.9000 43031.0793  58.8%  3370 2456s
  4294  3258 37301.1058   24  267 27103.9000 43031.0793  58.8%  3374 2481s
  4366  3256     cutoff   23      27103.9000 43031.0793  58.8%  3376 2503s
  4405  3276 27290.9090   33  174 27103.9000 43031.0793  58.8%  3393 2526s
  4448  3285 36612.8170   26  268 27103.9000 43031.0793  58.8%  3395 2547s
  4483  3300 36043.0874   27  219 27103.9000 43031.0793  58.8%  3397 2569s
  4519  3324 35172.3637   28  241 27103.9000 43031.0793  58.8%  3414 2589s
  4567  3335 30407.3412   29  250 27103.9000 43031.0793  58.8%  3414 2610s
  4621  3332     cutoff   30      27103.9000 43031.0793  58.8%  3409 2632s
  4668  3343 31093.0417   28  210 27103.9000 43031.0793  58.8%  3416 2654s
  4712  3353 30274.7332   29  205 27103.9000 43031.0793  58.8%  3431 2679s
  4761  3362 28725.5146   31  220 27103.9000 43031.0793  58.8%  3443 2701s
  4813  3381     cutoff   31      27103.9000 43031.0793  58.8%  3449 2726s
  4867  3402 27236.2038   33  279 27103.9000 41778.8801  54.1%  3460 2757s
  4939  3426     cutoff   33      27103.9000 41778.8801  54.1%  3464 2785s
  5030  3428 29352.3425   29  268 27103.9000 41778.8801  54.1%  3467 2816s
  5121  3441 28691.8437   30  231 27103.9000 41778.8801  54.1%  3468 2845s
  5200  3456 27959.1640   31  236 27103.9000 41778.8801  54.1%  3478 2875s
  5295  3472     cutoff   35      27103.9000 41778.8801  54.1%  3478 2906s
  5408  3482 34841.0032   22  335 27103.9000 41778.8801  54.1%  3482 2935s
H 5517  3297                    27154.608089 41297.4269  52.1%  3479 2935s
  5530  3353 34607.7513   23  293 27154.6081 40838.4926  50.4%  3478 2975s
  5674  3369 33923.2614   24  312 27154.6081 40683.8417  49.8%  3466 3015s
H 5676  3228                    27156.931229 40683.8417  49.8%  3466 3015s
  5830  3244 31832.0079   25  284 27156.9312 40683.8417  49.8%  3457 3054s
  5980  3235 29997.0772   26  237 27156.9312 40683.8417  49.8%  3452 3111s
  6108  3255 33009.7792   24  248 27156.9312 40683.8417  49.8%  3459 3151s
  6250  3288 30095.8049   26  276 27156.9312 40683.8417  49.8%  3469 3190s
H 6299  3137                    27181.037688 40683.8417  49.7%  3466 3190s
  6395  3163 29096.0635   27  150 27181.0377 40683.8417  49.7%  3474 3240s
  6542  3174 infeasible   30      27181.0377 40683.8417  49.7%  3485 3284s
H 6545  3046                    27189.324349 40683.8417  49.6%  3483 3284s
H 6562  2920                    27537.741771 40683.8417  47.7%  3480 3284s
H 6627  2783                    27678.317883 40683.8417  47.0%  3479 3284s
  6696  2820 infeasible   30      27678.3179 40683.8417  47.0%  3487 3329s
  6866  2821 29251.3008   28  285 27678.3179 40459.9247  46.2%  3494 3379s
H 6887  2705                    27714.057149 40459.9247  46.0%  3499 3379s
H 6941  2584                    27999.938726 40459.9247  44.5%  3507 3379s
H 6949  2484                    28644.667384 40459.9247  41.2%  3505 3379s
  6983  2543     cutoff   31      28644.6674 40459.9247  41.2%  3505 3431s
  7149  2506 37665.3802   21  344 28644.6674 39516.3102  38.0%  3513 3472s
H 7151  2411                    28837.933912 39516.3102  37.0%  3513 3472s
H 7159  2320                    28876.481512 39516.3102  36.8%  3516 3472s
  7220  2318 37194.8717   22  325 28876.4815 39516.3102  36.8%  3527 3524s
  7420  2255 34334.3507   24  274 28876.4815 39516.3102  36.8%  3529 3580s
  7588  2169 32771.0748   26  306 28876.4815 39516.3102  36.8%  3550 3600s

Cutting planes:
  Learned: 2
  MIR: 1005
  Mixing: 2
  Flow cover: 2132
  RLT: 13
  Relax-and-lift: 153

Explored 7673 nodes (27522554 simplex iterations) in 3600.05 seconds (5943.78 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 28876.5 28837.9 28644.7 ... 27154.6

Time limit reached
Best objective 2.887648151206e+04, best bound 3.951631022400e+04, gap 36.8460%
  WARNING: Time limit reached. Using best solution found (gap: 36.85%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = 28876.48, θ = 190153.11
  Upper Bound (UB) = 28876.48

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 190153.11
  [DEBUG]   ✓ Scenario 0: θ = 190153.11 ≤ Q = 190153.11 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 190153.11 ≤ Q = 190153.11 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 190153.11 ≤ Q = 190153.11 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 190153.11 ≤ Q = 190153.11 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 190153.11 ≤ Q = 190153.11 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 190153.11 ≤ Q = 190153.11 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 190153.11 ≤ Q = 190153.11 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 190153.11 ≤ Q = 190153.11 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 190153.11 ≤ Q = 190153.11 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 190153.11 ≤ Q = 190153.11 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 10] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x57c5b4ec
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x57c5b4ec
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.197411e+13
Presolve removed 2622 rows and 1913 columns
Presolve time: 0.01s
Presolved: 471 rows, 476 columns, 1328 nonzeros
Found heuristic solution: objective 5315009.5620
Variable types: 324 continuous, 152 integer (152 binary)

Root relaxation: objective -1.529635e+05, 237 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -152963.47    0  123 5315009.56 -152963.47   103%     -    0s
H    0     0                    -121739.3464 -152963.47  25.6%     -    0s
H    0     0                    -122445.0364 -152963.47  24.9%     -    0s
H    0     0                    -123699.0256 -131998.40  6.71%     -    0s
     0     0 -131998.40    0   63 -123699.03 -131998.40  6.71%     -    0s
H    0     0                    -124499.8592 -131945.18  5.98%     -    0s
     0     0 -131563.13    0   51 -124499.86 -131563.13  5.67%     -    0s
H    0     0                    -130228.8469 -131544.56  1.01%     -    0s
H    0     0                    -130536.7973 -131544.56  0.77%     -    0s
     0     0 -131450.80    0   51 -130536.80 -131450.80  0.70%     -    0s
H    0     0                    -130545.5371 -131450.80  0.69%     -    0s
     0     0 -131330.10    0   52 -130545.54 -131330.10  0.60%     -    0s
     0     0 -131320.37    0   52 -130545.54 -131320.37  0.59%     -    0s
     0     0 -131292.48    0   52 -130545.54 -131292.48  0.57%     -    0s
     0     0 -131282.90    0   52 -130545.54 -131282.90  0.56%     -    0s
     0     2 -131282.90    0   52 -130545.54 -131282.90  0.56%     -    0s

Cutting planes:
  Gomory: 23
  Implied bound: 1
  MIR: 154
  Flow cover: 15

Explored 1129 nodes (5527 simplex iterations) in 0.19 seconds (0.09 work units)
Thread count was 32 (of 32 available processors)

Solution count 8: -130546 -130537 -130229 ... 1.19741e+13
No other solutions better than -130546

Optimal solution found (tolerance 1.00e-04)
Best objective -1.305455371279e+05, best bound -1.305455371279e+05, gap 0.0000%
  Subproblem solved in 0.23s
  Worst-case operational profit (Z_SP) = 183939.90
  Scenario: 17 demand increases, 43 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -130545.54
  [DEBUG]   S×d_nominal = 314485.44
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 314485.44 + -130545.54 = 183939.90
  [DEBUG]   Current θ from Master = 190153.11
  [DEBUG]   ⚠️  Z_SP ≤ θ by 6213.21 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 22663.28
  Lower Bound (LB) = 25086.86
  Gap (UB-LB) = 3789.6202, Absolute Gap = 3789.6202, Relative Gap = 0.131236
  Not converged yet (gap = 3789.62 > ε = 200)

  [DEBUG] Adding NEW scenario 10 to Master Problem...
  [DEBUG] New scenario pattern: 17 increases, 43 decreases
    [DEBUG] Scenario 10 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 10 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 10]
    [DEBUG]   - Total constraints in model: 169573
    [DEBUG]   - Total variables in model: 70900
  [DEBUG] Total scenarios in Master: 11
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 11
================================================================================
[Iteration 11] Solving Master Problem...
  Current scenarios in Master: 11
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 169573 rows, 70900 columns and 480928 nonzeros
Model fingerprint: 0xd13cd3bc
Variable types: 68641 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 82214 rows and 33374 columns
Presolve time: 2.72s
Presolved: 87359 rows, 37526 columns, 534487 nonzeros
Variable types: 35267 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -316572.6945
Found heuristic solution: objective -171254.7355

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.24s

Barrier statistics:
 Dense cols : 554
 AA' NZ     : 3.347e+06
 Factor NZ  : 7.393e+06 (roughly 100 MB of memory)
 Factor Ops : 1.273e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.63955042e+07  1.62202270e+08  1.13e+05 2.20e+01  7.87e+04     4s
   1  -1.25396737e+07  1.48577034e+08  7.99e+04 9.34e+01  5.51e+04     4s
   2  -3.77812631e+06  1.13261872e+08  2.41e+04 9.17e-01  1.80e+04     4s
   3  -8.40531902e+05  8.25755825e+07  2.52e+03 1.29e+00  2.27e+03     4s
   4  -4.84298417e+05  4.57744195e+07  5.13e+02 5.31e-01  6.15e+02     5s
   5  -3.77637822e+05  2.50892153e+07  1.64e+02 2.38e-01  2.51e+02     5s
   6  -2.94785293e+05  1.89509306e+07  4.56e+01 1.71e-01  1.43e+02     5s
   7  -2.07646312e+05  1.28652742e+07  1.41e+01 1.11e-01  8.72e+01     5s
   8  -1.56417763e+05  1.03086641e+07  5.68e+00 8.81e-02  6.72e+01     5s
   9  -1.21883371e+05  7.87236087e+06  3.81e+00 6.69e-02  5.08e+01     5s
  10  -8.81236858e+04  2.70549078e+06  2.15e+00 2.18e-02  1.76e+01     5s
  11  -5.81267708e+04  5.76423654e+05  1.11e+00 4.11e-03  3.99e+00     5s
  12  -2.25858102e+04  2.79250567e+05  6.42e-01 1.73e-03  1.89e+00     5s
  13   1.39660818e+02  1.80790797e+05  4.45e-01 1.82e-03  1.13e+00     5s
  14   9.78662816e+03  1.42933026e+05  3.49e-01 2.49e-03  8.34e-01     5s
  15   1.83638436e+04  1.07466418e+05  2.69e-01 1.72e-03  5.58e-01     5s
  16   2.72129462e+04  8.66660672e+04  2.05e-01 4.00e-03  3.73e-01     5s
  17   3.38846634e+04  7.69921060e+04  1.57e-01 3.32e-03  2.70e-01     5s
  18   4.01834674e+04  7.17959390e+04  1.13e-01 3.09e-03  1.98e-01     5s
  19   4.31902523e+04  6.75444411e+04  9.19e-02 2.17e-03  1.53e-01     5s
  20   4.75943173e+04  6.39552091e+04  6.00e-02 1.73e-03  1.03e-01     5s
  21   5.02642398e+04  6.08066425e+04  4.20e-02 1.77e-03  6.61e-02     5s
  22   5.16064500e+04  5.96019262e+04  3.35e-02 1.35e-03  5.01e-02     6s
  23   5.26449612e+04  5.86113396e+04  2.68e-02 7.76e-04  3.74e-02     6s
  24   5.43179631e+04  5.81658169e+04  1.65e-02 7.61e-04  2.41e-02     6s
  25   5.53498310e+04  5.76161104e+04  1.03e-02 8.25e-04  1.42e-02     6s
  26   5.58727803e+04  5.75155147e+04  7.22e-03 6.39e-04  1.03e-02     6s
  27   5.63277682e+04  5.73952298e+04  4.68e-03 4.05e-04  6.70e-03     6s
  28   5.66137155e+04  5.73416510e+04  3.05e-03 3.00e-04  4.56e-03     6s
  29   5.68484019e+04  5.72837671e+04  1.69e-03 1.92e-04  2.73e-03     6s
  30   5.70110044e+04  5.72283208e+04  8.39e-04 9.32e-05  1.36e-03     6s
  31   5.70589028e+04  5.72165509e+04  5.82e-04 7.25e-05  9.88e-04     6s
  32   5.70981258e+04  5.71998906e+04  3.85e-04 4.23e-05  6.38e-04     6s
  33   5.71379671e+04  5.71856142e+04  1.71e-04 1.59e-05  2.98e-04     6s
  34   5.71577764e+04  5.71797898e+04  7.82e-05 7.59e-06  1.38e-04     6s
  35   5.71603921e+04  5.71758651e+04  6.64e-05 9.30e-06  9.70e-05     7s
  36   5.71646861e+04  5.71756817e+04  4.66e-05 4.63e-06  6.90e-05     7s
  37   5.71664307e+04  5.71754800e+04  3.86e-05 2.48e-06  5.68e-05     7s
  38   5.71725282e+04  5.71753196e+04  1.18e-05 2.60e-06  1.75e-05     7s
  39   5.71751599e+04  5.71752735e+04  2.42e-06 4.36e-07  7.11e-07     7s
  40   5.71752315e+04  5.71752609e+04  2.05e-07 2.86e-07  1.83e-07     7s
  41   5.71752342e+04  5.71752434e+04  7.61e-08 7.07e-08  5.74e-08     7s
  42   5.71752372e+04  5.71752372e+04  1.51e-07 1.61e-08  4.34e-10     7s

Barrier solved model in 42 iterations and 7.09 seconds (6.99 work units)
Optimal objective 5.71752372e+04


Root crossover log...

   79218 DPushes remaining with DInf 0.0000000e+00                 7s
    6448 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                12s

    1679 PPushes remaining with PInf 1.8539798e-05                12s
       0 PPushes remaining with PInf 0.0000000e+00                12s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.4892059e-01     12s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   42720    5.7175237e+04   0.000000e+00   3.489206e-01     12s
   42729    5.7175237e+04   0.000000e+00   0.000000e+00     13s
   42729    5.7175237e+04   0.000000e+00   0.000000e+00     13s
Concurrent spin time: 0.39s

Solved with barrier

Root relaxation: objective 5.717524e+04, 42729 iterations, 9.68 seconds (14.84 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 57175.2372    0  157 -171254.74 57175.2372   133%     -   13s
H    0     0                    -164406.5509 57175.2372   135%     -   13s
H    0     0                    -155184.8159 57175.2372   137%     -   14s
H    0     0                    -148167.8614 57175.2372   139%     -   14s
H    0     0                    -146945.2562 57175.2372   139%     -   15s
H    0     0                    -146619.3685 57175.2372   139%     -   15s
H    0     0                    -64339.60796 57175.2372   189%     -   15s
H    0     0                    -64312.93161 57175.2372   189%     -   15s
H    0     0                    -7641.934848 57175.2372   848%     -   15s
H    0     0                    -7558.596543 57175.2372   856%     -   15s
H    0     0                    10549.504208 57175.2372   442%     -   16s
H    0     0                    10655.044588 57175.2372   437%     -   16s
H    0     0                    10676.890849 57175.2372   436%     -   16s
H    0     0                    10796.272981 57175.2372   430%     -   16s
H    0     0                    10908.221102 52548.5396   382%     -   63s
H    0     0                    11886.098668 52548.5396   342%     -   63s
     0     0 52548.5396    0  137 11886.0987 52548.5396   342%     -   63s
H    0     0                    11901.741787 52548.3560   342%     -   64s
     0     0 51810.1475    0  135 11901.7418 51810.1475   335%     -   84s
     0     0 51712.9635    0  123 11901.7418 51712.9635   334%     -   91s
     0     0 51712.1502    0  136 11901.7418 51712.1502   334%     -   96s
     0     0 51712.1502    0  136 11901.7418 51712.1502   334%     -   98s
     0     0 51712.1502    0  136 11901.7418 51712.1502   334%     -   98s
     0     0 51712.1502    0  136 11901.7418 51712.1502   334%     -   98s
H    0     0                    13529.547884 48823.1822   261%     -  159s
H    0     0                    13742.642301 48823.1822   255%     -  159s
H    0     0                    14635.898575 48823.1822   234%     -  159s
H    0     0                    14855.756791 48823.1822   229%     -  159s
H    0     0                    15191.035592 48823.1822   221%     -  159s
H    0     0                    15234.585663 48823.1822   220%     -  159s
H    0     0                    15478.095173 48823.1822   215%     -  159s
H    0     0                    15557.414920 48823.1822   214%     -  159s
     0     0 48823.1822    0  330 15557.4149 48823.1822   214%     -  159s
H    0     0                    16874.988107 48822.7851   189%     -  159s
H    0     0                    18601.535895 48822.7851   162%     -  159s
H    0     0                    20239.191058 48822.7851   141%     -  159s
H    0     0                    20490.676946 48822.7851   138%     -  159s
     0     0 48161.6428    0  341 20490.6769 48161.6428   135%     -  189s
     0     0 48052.5069    0  268 20490.6769 48052.5069   135%     -  201s
     0     0 47977.4769    0  292 20490.6769 47977.4769   134%     -  215s
     0     0 47945.7618    0  353 20490.6769 47945.7618   134%     -  224s
     0     0 47913.7758    0  279 20490.6769 47913.7758   134%     -  231s
     0     0 47909.5372    0  295 20490.6769 47909.5372   134%     -  236s
     0     0 47908.0276    0  358 20490.6769 47908.0276   134%     -  238s
     0     0 47881.2903    0  347 20490.6769 47881.2903   134%     -  243s
     0     0 47873.5214    0  279 20490.6769 47873.5214   134%     -  247s
     0     0 47867.8301    0  281 20490.6769 47867.8301   134%     -  249s
     0     0 47867.2999    0  349 20490.6769 47867.2999   134%     -  250s
     0     0 46637.6856    0  378 20490.6769 46637.6856   128%     -  301s
     0     0 46189.7911    0  347 20490.6769 46189.7911   125%     -  331s
     0     0 46065.1051    0  358 20490.6769 46065.1051   125%     -  344s
     0     0 45943.1029    0  363 20490.6769 45943.1029   124%     -  358s
     0     0 45846.0629    0  402 20490.6769 45846.0629   124%     -  374s
     0     0 45801.4940    0  358 20490.6769 45801.4940   124%     -  382s
     0     0 45776.8022    0  347 20490.6769 45776.8022   123%     -  392s
H    0     0                    23004.558572 45750.1171  98.9%     -  399s
H    0     0                    24052.194268 45750.1171  90.2%     -  399s
H    0     0                    24120.164622 45750.1171  89.7%     -  399s
     0     0 45750.1171    0  363 24120.1646 45750.1171  89.7%     -  399s
     0     0 45674.9494    0  363 24120.1646 45674.9494  89.4%     -  408s
     0     0 45637.4284    0  370 24120.1646 45637.4284  89.2%     -  418s
     0     0 45611.2658    0  365 24120.1646 45611.2658  89.1%     -  427s
     0     0 45562.2034    0  354 24120.1646 45562.2034  88.9%     -  434s
     0     0 45544.9715    0  358 24120.1646 45544.9715  88.8%     -  440s
     0     0 45539.6433    0  358 24120.1646 45539.6433  88.8%     -  443s
     0     0 45538.6583    0  355 24120.1646 45538.6583  88.8%     -  445s
     0     0 44999.3441    0  386 24120.1646 44999.3441  86.6%     -  485s
     0     0 44859.7165    0  391 24120.1646 44859.7165  86.0%     -  503s
     0     0 44811.6908    0  403 24120.1646 44811.6908  85.8%     -  515s
     0     0 44787.3894    0  391 24120.1646 44787.3894  85.7%     -  523s
     0     0 44767.1504    0  389 24120.1646 44767.1504  85.6%     -  529s
     0     0 44745.0363    0  388 24120.1646 44745.0363  85.5%     -  535s
     0     0 44739.2131    0  393 24120.1646 44739.2131  85.5%     -  545s
     0     0 44736.8954    0  389 24120.1646 44736.8954  85.5%     -  547s
     0     0 44716.3611    0  386 24120.1646 44716.3611  85.4%     -  552s
     0     0 44702.3551    0  382 24120.1646 44702.3551  85.3%     -  558s
     0     0 44699.5098    0  384 24120.1646 44699.5098  85.3%     -  562s
     0     0 44694.1797    0  379 24120.1646 44694.1797  85.3%     -  565s
     0     0 44689.9560    0  391 24120.1646 44689.9560  85.3%     -  567s
     0     0 44676.2145    0  384 24120.1646 44676.2145  85.2%     -  570s
     0     0 44658.4382    0  384 24120.1646 44658.4382  85.1%     -  573s
     0     0 44652.4364    0  391 24120.1646 44652.4364  85.1%     -  578s
     0     0 44648.8916    0  393 24120.1646 44648.8916  85.1%     -  580s
     0     0 44639.3834    0  396 24120.1646 44639.3834  85.1%     -  585s
     0     0 44638.0773    0  394 24120.1646 44638.0773  85.1%     -  587s
     0     0 44541.2259    0  510 24120.1646 44541.2259  84.7%     -  608s
     0     0 44506.3238    0  539 24120.1646 44506.3238  84.5%     -  617s
     0     0 44492.8938    0  542 24120.1646 44492.8938  84.5%     -  626s
     0     0 44488.9466    0  527 24120.1646 44488.9466  84.4%     -  629s
     0     0 44478.4494    0  531 24120.1646 44478.4494  84.4%     -  634s
     0     0 44467.4900    0  532 24120.1646 44467.4900  84.4%     -  638s
     0     0 44459.6259    0  532 24120.1646 44459.6259  84.3%     -  641s
     0     0 44454.8765    0  531 24120.1646 44454.8765  84.3%     -  644s
     0     0 44452.4852    0  523 24120.1646 44452.4852  84.3%     -  645s
     0     0 44451.6250    0  521 24120.1646 44451.6250  84.3%     -  646s
     0     0 44370.6015    0  516 24120.1646 44370.6015  84.0%     -  655s
     0     0 44328.1324    0  405 24120.1646 44328.1324  83.8%     -  665s
     0     0 44321.3086    0  407 24120.1646 44321.3086  83.8%     -  668s
     0     0 44318.2110    0  411 24120.1646 44318.2110  83.7%     -  670s
     0     0 44316.8560    0  405 24120.1646 44316.8560  83.7%     -  672s
     0     0 44289.8663    0  408 24120.1646 44289.8663  83.6%     -  680s
     0     0 44283.0844    0  413 24120.1646 44283.0844  83.6%     -  683s
     0     0 44280.2520    0  409 24120.1646 44280.2520  83.6%     -  685s
     0     0 44279.2745    0  410 24120.1646 44279.2745  83.6%     -  687s
     0     0 44273.6466    0  410 24120.1646 44273.6466  83.6%     -  693s
     0     0 44253.9635    0  410 24120.1646 44253.9635  83.5%     -  697s
     0     0 44251.8601    0  412 24120.1646 44251.8601  83.5%     -  699s
     0     0 44250.1396    0  414 24120.1646 44250.1396  83.5%     -  700s
     0     0 44249.6929    0  416 24120.1646 44249.6929  83.5%     -  701s
     0     0 44246.8149    0  405 24120.1646 44246.8149  83.4%     -  705s
     0     0 44245.4343    0  410 24120.1646 44245.4343  83.4%     -  707s
     0     0 44244.1438    0  413 24120.1646 44244.1438  83.4%     -  710s
     0     0 44239.1326    0  509 24120.1646 44239.1326  83.4%     -  714s
     0     0 44234.0721    0  414 24120.1646 44234.0721  83.4%     -  716s
     0     0 44232.0968    0  410 24120.1646 44232.0968  83.4%     -  717s
     0     0 44230.8710    0  409 24120.1646 44230.8710  83.4%     -  718s
     0     0 44225.7563    0  418 24120.1646 44225.7563  83.4%     -  722s
     0     0 44225.3278    0  406 24120.1646 44225.3278  83.4%     -  723s
     0     0 44224.1576    0  413 24120.1646 44224.1576  83.3%     -  728s
     0     0 44222.3989    0  414 24120.1646 44222.3989  83.3%     -  731s
     0     0 44222.2301    0  415 24120.1646 44222.2301  83.3%     -  733s
     0     0 44221.1713    0  416 24120.1646 44221.1713  83.3%     -  734s
     0     0 44221.1713    0  416 24120.1646 44221.1713  83.3%     -  735s
     0     0 44221.1713    0  416 24120.1646 44221.1713  83.3%     -  737s
H    0     2                    24343.089866 44221.1509  81.7%     -  902s
     0     2 44221.1509    0  416 24343.0899 44221.1509  81.7%     -  902s
     1     4 44156.1138    1  400 24343.0899 44221.1509  81.7%  5314  917s
     3     8 43790.7161    2  397 24343.0899 44155.7506  81.4%  9269  959s
     7    15 43490.3757    3  382 24343.0899 43790.6322  79.9% 13448 1015s
    14    30 43383.5617    4  387 24343.0899 43630.6145  79.2% 13609 1043s
    29    45 43115.7222    5  491 24343.0899 43528.3258  78.8% 15448 1110s
H   44    77                    24772.287462 43528.3258  75.7% 19019 1267s
H   45    77                    25414.014949 43528.3258  71.3% 18813 1267s
H   46    77                    25898.903143 43528.3258  68.1% 18737 1267s
H   47    77                    25978.842167 43528.3258  67.6% 18589 1267s
H   54    77                    26775.804877 43528.3258  62.6% 17298 1267s
    76   206 42416.5248    7  360 26775.8049 43235.9414  61.5% 16140 1323s
   205   237 42117.1352   11  363 26775.8049 43235.9414  61.5%  8833 1358s
   236   274 41949.2798   12  359 26775.8049 43235.9414  61.5%  8256 1421s
   273   315 41898.9969   13  352 26775.8049 43235.9414  61.5%  7966 1450s
   314   359 41838.8729   14  344 26775.8049 43235.9414  61.5%  7604 1479s
   358   395 41711.4837   15  353 26775.8049 43235.9414  61.5%  7263 1508s
   394   437 40848.0982   16  423 26775.8049 43235.9414  61.5%  7130 1535s
H  407   437                    27601.615052 43235.9414  56.6%  7045 1535s
   436   507 40468.9339   17  437 27601.6151 43235.9414  56.6%  7006 1567s
   506   581 40326.9450   18  446 27601.6151 43235.9414  56.6%  6629 1595s
   580   652 40057.2978   20  380 27601.6151 43235.9414  56.6%  6478 1621s
   651   698 39286.7659   22  358 27601.6151 43235.9414  56.6%  6377 1651s
   699   749 41225.3358   13  330 27601.6151 43235.9414  56.6%  6462 1674s
   760   814 38541.5251   24  365 27601.6151 43235.9414  56.6%  6454 1697s
   831   881 36780.6004   26  361 27601.6151 43235.9414  56.6%  6393 1720s
   902   947 36639.2306   28  358 27601.6151 43235.9414  56.6%  6292 1746s
   986  1004 36489.6411   30  379 27601.6151 43235.9414  56.6%  6216 1771s
  1071  1039 35447.3828   32  355 27601.6151 43235.9414  56.6%  6237 1795s
  1144  1088 34556.3898   35  354 27601.6151 43235.9414  56.6%  6215 1829s
  1217  1175 28272.2108   37  306 27601.6151 43235.9414  56.6%  6250 1856s
H 1224  1175                    27652.914667 43235.9414  56.4%  6259 1856s
  1314  1224 27995.5775   40  271 27652.9147 43235.9414  56.4%  6260 1887s
  1416  1260 31944.5944   20  274 27652.9147 43235.9414  56.4%  6208 1921s
  1513  1289 29904.1491   21  264 27652.9147 43235.9414  56.4%  6151 1953s
  1590  1321 29613.7204   23  239 27652.9147 43235.9414  56.4%  6275 1987s
H 1599  1321                    27676.431919 43235.9414  56.2%  6336 1987s
  1650  1349     cutoff   24      27676.4319 43235.9414  56.2%  6436 2024s
  1719  1405     cutoff   19      27676.4319 43235.9414  56.2%  6504 2059s
  1799  1437     cutoff   27      27676.4319 43071.7364  55.6%  6620 2092s
  1879  1483 41622.1922    8  286 27676.4319 43071.7364  55.6%  6730 2128s
  1951  1547 35019.7326   10  251 27676.4319 43071.7364  55.6%  6926 2168s
  2091  1605 33615.8162   12  272 27676.4319 43071.7364  55.6%  6898 2210s
  2213  1649 30507.7410   14  244 27676.4319 43071.4966  55.6%  6918 2256s
H 2284  1649                    27677.073950 43071.4966  55.6%  6943 2256s
  2319  1708 infeasible   15      27677.0739 43071.4966  55.6%  6972 2300s
  2422  1755     cutoff   17      27677.0739 43071.4966  55.6%  7078 2350s
  2505  1806     cutoff   17      27677.0739 43071.4966  55.6%  7229 2400s
  2594  1871 40415.1184    9  277 27677.0739 43071.4966  55.6%  7399 2447s
  2693  1982 37378.0030   11  281 27677.0739 43071.4966  55.6%  7510 2494s
  2840  2085 33254.6534   14  255 27677.0739 42595.7714  53.9%  7547 2547s
  3017  2181 31831.1537   17  229 27677.0739 42595.7714  53.9%  7509 2608s
  3185  2285 30527.3519   22  298 27677.0739 42560.6442  53.8%  7490 2663s
H 3238  2285                    27679.535769 42450.6242  53.4%  7509 2663s
H 3278  2285                    27687.038503 42405.9462  53.2%  7491 2663s
  3375  2328 29404.4323   27  317 27687.0385 42405.9462  53.2%  7447 2718s
H 3472  2404                    27701.594504 42405.9462  53.1%  7446 2771s
  3580  2484     cutoff   40      27701.5945 42405.9462  53.1%  7475 2835s
  3700  2599 41527.9340   12  343 27701.5945 42405.9462  53.1%  7594 2902s
  3854  2600 38938.6078   10  416 27701.5945 42405.9462  53.1%  7686 3037s
  3856  2601 29060.8331   38   67 27701.5945 42405.9462  53.1%  7682 3048s
  3857  2602 34930.7342   43  333 27701.5945 42405.9462  53.1%  7680 3134s
  3858  2603 31560.6434   53  364 27701.5945 42405.9462  53.1%  7678 3208s
  3859  2603 41609.2634    7  429 27701.5945 42405.9462  53.1%  7676 3262s
  3860  2604 39854.9149   14  376 27701.5945 42405.9462  53.1%  7674 3298s
  3861  2605 30085.7503   23  392 27701.5945 42405.9462  53.1%  7672 3315s
  3862  2605 34753.5341   22  398 27701.5945 42405.9462  53.1%  7670 3339s
  3863  2606 29082.9915   73  397 27701.5945 42405.9462  53.1%  7668 3366s
  3864  2607 30334.8518   26  405 27701.5945 42405.9462  53.1%  7666 3378s
  3865  2607 33585.0571   18  394 27701.5945 42405.9462  53.1%  7664 3387s
  3866  2608 40524.0454    8  405 27701.5945 42405.9462  53.1%  7662 3396s
  3867  2609 29890.6807   53  395 27701.5945 42405.9462  53.1%  7660 3407s
  3868  2609 31458.7555   18  431 27701.5945 42405.9462  53.1%  7658 3430s
  3869  2610 31572.0939   34  426 27701.5945 42405.9462  53.1%  7656 3446s
  3870  2611 28540.6309   34  411 27701.5945 42405.9462  53.1%  7654 3457s
  3871  2611 33899.4481   43  413 27701.5945 42405.9462  53.1%  7653 3465s
  3872  2612 30225.9946   19  404 27701.5945 42405.9462  53.1%  7651 3472s
  3873  2613 38216.7102   28  538 27701.5945 42405.9462  53.1%  7649 3494s
  3874  2613 29269.5993   27  525 27701.5945 42405.9462  53.1%  7647 3509s
  3875  2614 29683.8008   41  423 27701.5945 42405.9462  53.1%  7645 3517s
  3876  2615 36236.2979   19  399 27701.5945 42405.9462  53.1%  7643 3520s
  3878  2616 35384.9999   34  409 27701.5945 42405.9462  53.1%  7639 3527s
  3879  2617 40217.7213   18  426 27701.5945 42405.9462  53.1%  7637 3542s
  3880  2617 38558.4708   25  461 27701.5945 42405.9462  53.1%  7635 3556s
  3881  2618 40929.4626   17  429 27701.5945 42405.9462  53.1%  7633 3561s
  3882  2619 36178.2205   20  423 27701.5945 42405.9462  53.1%  7631 3565s
  3883  2619 38789.8136   13  429 27701.5945 42405.9462  53.1%  7629 3581s
  3884  2620 40944.1808   12  452 27701.5945 42405.9462  53.1%  7627 3594s

Cutting planes:
  Projected implied bound: 61
  MIR: 280
  Mixing: 1
  Flow cover: 525
  RLT: 4
  Relax-and-lift: 102

Explored 3884 nodes (30398393 simplex iterations) in 3600.14 seconds (5696.95 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 27701.6 27687 27679.5 ... 25898.9

Time limit reached
Best objective 2.770159450440e+04, best bound 4.240594616950e+04, gap 53.0812%
  WARNING: Time limit reached. Using best solution found (gap: 53.08%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.20s
  Master Objective (UB) = 27701.59, θ = 188224.24
  Upper Bound (UB) = 27701.59

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 188224.24
  [DEBUG]   ✓ Scenario 0: θ = 188224.24 ≤ Q = 188224.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 188224.24 ≤ Q = 188224.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 188224.24 ≤ Q = 188224.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 188224.24 ≤ Q = 188224.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 188224.24 ≤ Q = 188224.24 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 188224.24 ≤ Q = 188224.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 188224.24 ≤ Q = 188224.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 188224.24 ≤ Q = 188224.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 188224.24 ≤ Q = 188224.24 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 188224.24 ≤ Q = 188224.24 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 188224.24 ≤ Q = 188224.24 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 11] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0xf4b9f8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x00f4b9f8
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [3e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.259381e+13
Presolve removed 2623 rows and 1914 columns
Presolve time: 0.01s
Presolved: 470 rows, 475 columns, 1325 nonzeros
Found heuristic solution: objective 5766091.4039
Variable types: 323 continuous, 152 integer (152 binary)

Root relaxation: objective -1.550789e+05, 239 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -155078.88    0  123 5766091.40 -155078.88   103%     -    0s
H    0     0                    -123738.6757 -155078.88  25.3%     -    0s
H    0     0                    -124361.7828 -155078.88  24.7%     -    0s
     0     0 -133348.25    0   62 -124361.78 -133348.25  7.23%     -    0s
H    0     0                    -130269.2450 -133280.57  2.31%     -    0s
H    0     0                    -131856.1146 -133280.57  1.08%     -    0s
H    0     0                    -132374.1330 -133280.57  0.68%     -    0s
     0     0 -132627.23    0   44 -132374.13 -132627.23  0.19%     -    0s
     0     0 -132539.99    0   35 -132374.13 -132539.99  0.13%     -    0s
     0     0 -132471.18    0   23 -132374.13 -132471.18  0.07%     -    0s
     0     0 -132414.41    0   11 -132374.13 -132414.41  0.03%     -    0s
     0     0          -    0      -132374.13 -132386.91  0.01%     -    0s

Cutting planes:
  Gomory: 27
  MIR: 168
  Relax-and-lift: 2

Explored 1 nodes (513 simplex iterations) in 0.03 seconds (0.02 work units)
Thread count was 32 (of 32 available processors)

Solution count 6: -132374 -131856 -124362 ... 1.25938e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.323741329931e+05, best bound -1.323869082633e+05, gap 0.0097%
  Subproblem solved in 0.06s
  Worst-case operational profit (Z_SP) = 182196.71
  Scenario: 20 demand increases, 40 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -132374.13
  [DEBUG]   S×d_nominal = 314570.84
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 314570.84 + -132374.13 = 182196.71
  [DEBUG]   Current θ from Master = 188224.24
  [DEBUG]   ⚠️  Z_SP ≤ θ by 6027.52 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 21674.07
  Lower Bound (LB) = 25086.86
  Gap (UB-LB) = 2614.7332, Absolute Gap = 2614.7332, Relative Gap = 0.094389
  Not converged yet (gap = 2614.73 > ε = 200)

  [DEBUG] Adding NEW scenario 11 to Master Problem...
  [DEBUG] New scenario pattern: 20 increases, 40 decreases
    [DEBUG] Scenario 11 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 11 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 11]
    [DEBUG]   - Total constraints in model: 184863
    [DEBUG]   - Total variables in model: 77140
  [DEBUG] Total scenarios in Master: 12
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 12
================================================================================
[Iteration 12] Solving Master Problem...
  Current scenarios in Master: 12
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 184863 rows, 77140 columns and 524147 nonzeros
Model fingerprint: 0xf4a871f6
Variable types: 74881 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 89688 rows and 36408 columns
Presolve time: 3.18s
Presolved: 95175 rows, 40732 columns, 579143 nonzeros
Variable types: 38473 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -322809.5468
Found heuristic solution: objective -171254.7355

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.29s

Barrier statistics:
 Dense cols : 548
 AA' NZ     : 3.821e+06
 Factor NZ  : 8.556e+06 (roughly 120 MB of memory)
 Factor Ops : 1.542e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.68842680e+07  1.74854962e+08  1.16e+05 2.21e+01  8.05e+04     5s
   1  -1.29554444e+07  1.61054420e+08  8.22e+04 9.36e+01  5.64e+04     5s
   2  -4.10147059e+06  1.21919673e+08  2.60e+04 7.72e-01  1.92e+04     5s
   3  -8.24741229e+05  9.04693837e+07  2.24e+03 1.13e+00  2.07e+03     5s
   4  -5.03974319e+05  6.42273783e+07  5.40e+02 5.73e-01  7.20e+02     5s
   5  -4.14689485e+05  3.23109049e+07  2.22e+02 2.35e-01  3.13e+02     5s
   6  -3.54336883e+05  2.37533515e+07  8.33e+01 1.64e-01  1.81e+02     5s
   7  -2.99290112e+05  1.80216834e+07  4.26e+01 1.19e-01  1.24e+02     6s
   8  -1.93828855e+05  1.30294023e+07  1.06e+01 8.30e-02  7.97e+01     6s
   9  -1.62755943e+05  9.01315017e+06  6.60e+00 5.64e-02  5.44e+01     6s
  10  -1.05385221e+05  4.06377981e+06  3.70e+00 2.44e-02  2.44e+01     6s
  11  -6.77928081e+04  1.66994319e+06  1.75e+00 9.59e-03  1.01e+01     6s
  12  -2.52277420e+04  6.12738883e+05  6.08e-01 3.57e-03  3.67e+00     6s
  13  -1.07632413e+04  3.37409444e+05  4.12e-01 1.96e-03  2.00e+00     6s
  14   9.66265069e+02  2.42368487e+05  2.72e-01 1.65e-03  1.39e+00     6s
  15   1.19061378e+04  1.73722381e+05  1.85e-01 2.13e-03  9.29e-01     6s
  16   2.27620938e+04  1.29001572e+05  1.38e-01 1.45e-03  6.10e-01     6s
  17   2.88278711e+04  1.01758565e+05  1.09e-01 2.00e-03  4.19e-01     6s
  18   3.47147778e+04  8.77337232e+04  8.28e-02 1.69e-03  3.04e-01     7s
  19   3.95112852e+04  7.47752989e+04  6.31e-02 1.58e-03  2.02e-01     7s
  20   4.54768764e+04  6.91509568e+04  3.96e-02 1.86e-03  1.36e-01     7s
  21   4.77275611e+04  6.40952043e+04  3.12e-02 1.11e-03  9.40e-02     7s
  22   5.06851208e+04  6.16480980e+04  2.06e-02 6.26e-04  6.29e-02     7s
  23   5.20777539e+04  6.05067096e+04  1.58e-02 4.77e-04  4.84e-02     7s
  24   5.29786454e+04  5.93548789e+04  1.26e-02 3.25e-04  3.66e-02     7s
  25   5.37120232e+04  5.82575274e+04  1.01e-02 3.02e-04  2.61e-02     7s
  26   5.43899870e+04  5.78825275e+04  7.96e-03 2.13e-04  2.01e-02     7s
  27   5.52284031e+04  5.73136753e+04  5.23e-03 9.56e-05  1.20e-02     8s
  28   5.59045077e+04  5.72221853e+04  2.95e-03 7.80e-05  7.57e-03     8s
  29   5.62465921e+04  5.71372877e+04  1.91e-03 5.47e-05  5.12e-03     8s
  30   5.65956053e+04  5.70174121e+04  8.76e-04 4.36e-05  2.42e-03     8s
  31   5.67478827e+04  5.69714411e+04  4.46e-04 2.51e-05  1.28e-03     8s
  32   5.68226458e+04  5.69517564e+04  2.29e-04 1.73e-05  7.41e-04     8s
  33   5.68296285e+04  5.69349509e+04  2.10e-04 1.05e-05  6.05e-04     8s
  34   5.68947138e+04  5.69137861e+04  3.19e-05 2.37e-06  1.09e-04     8s
  35   5.69010906e+04  5.69107357e+04  1.69e-05 1.02e-06  5.54e-05     8s
  36   5.69070248e+04  5.69084484e+04  2.14e-06 5.32e-07  8.17e-06     9s
  37   5.69082604e+04  5.69082622e+04  5.49e-09 1.47e-08  1.00e-08     9s
  38   5.69082617e+04  5.69082617e+04  9.09e-10 1.01e-11  9.67e-12     9s

Barrier solved model in 38 iterations and 8.81 seconds (7.47 work units)
Optimal objective 5.69082617e+04


Root crossover log...

   87952 DPushes remaining with DInf 1.0736378e-09                 9s
   11245 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                11s

     683 PPushes remaining with PInf 1.1603834e-08                11s
       0 PPushes remaining with PInf 0.0000000e+00                12s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.3560846e-10     12s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   38914    5.6908262e+04   0.000000e+00   0.000000e+00     12s
   38914    5.6908262e+04   0.000000e+00   0.000000e+00     12s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 5.690826e+04, 38914 iterations, 7.82 seconds (7.41 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 56908.2617    0   69 -171254.74 56908.2617   133%     -   12s
H    0     0                    -168628.1743 56908.2617   134%     -   12s
H    0     0                    -165466.3070 56908.2617   134%     -   12s
H    0     0                    -165010.8309 56908.2617   134%     -   12s
H    0     0                    -126112.3790 56908.2617   145%     -   12s
H    0     0                    -119866.6476 56908.2617   147%     -   12s
H    0     0                    -115833.6095 56908.2617   149%     -   13s
H    0     0                    -115807.9286 56908.2617   149%     -   13s
H    0     0                    -115678.7717 56908.2617   149%     -   13s
H    0     0                    -115497.5256 56908.2617   149%     -   13s
H    0     0                    -60982.29646 56908.2617   193%     -   13s
H    0     0                    -34836.91538 56908.2617   263%     -   13s
H    0     0                    -30085.33580 56908.2617   289%     -   13s
H    0     0                    -9148.155383 56908.2617   722%     -   13s
H    0     0                    11953.832277 56908.2617   376%     -   14s
H    0     0                    15935.207612 56908.2617   257%     -   15s
H    0     0                    16850.808673 56908.2617   238%     -   15s
     0     0 54037.4948    0  184 16850.8087 54037.4948   221%     -   45s
H    0     0                    16999.266695 54037.1741   218%     -   46s
H    0     0                    17192.388755 54037.1741   214%     -   46s
     0     0 53591.3491    0  197 17192.3888 53591.3491   212%     -   74s
     0     0 53589.5070    0  187 17192.3888 53589.5070   212%     -   82s
     0     0 53583.3322    0  190 17192.3888 53583.3322   212%     -   87s
     0     0 53583.2048    0  190 17192.3888 53583.2048   212%     -   87s
     0     0 50560.4923    0  233 17192.3888 50560.4923   194%     -  151s
H    0     0                    17465.695125 50560.2375   189%     -  152s
H    0     0                    17497.086294 50560.2375   189%     -  152s
H    0     0                    17514.039048 50560.2375   189%     -  152s
H    0     0                    17586.085951 50560.2375   188%     -  152s
H    0     0                    17649.886509 50560.2375   186%     -  152s
H    0     0                    17681.371133 50560.2375   186%     -  152s
     0     0 49814.2795    0  230 17681.3711 49814.2795   182%     -  197s
     0     0 49548.7595    0  309 17681.3711 49548.7595   180%     -  221s
     0     0 49508.8633    0  324 17681.3711 49508.8633   180%     -  233s
     0     0 49483.9950    0  320 17681.3711 49483.9950   180%     -  244s
     0     0 49475.8465    0  324 17681.3711 49475.8465   180%     -  248s
     0     0 49473.6476    0  316 17681.3711 49473.6476   180%     -  250s
     0     0 49473.4939    0  319 17681.3711 49473.4939   180%     -  251s
H    0     0                    20703.935218 46979.3393   127%     -  337s
     0     0 46979.3393    0  436 20703.9352 46979.3393   127%     -  337s
H    0     0                    20827.443009 46979.1843   126%     -  338s
H    0     0                    21578.532409 46535.4270   116%     -  379s
H    0     0                    21607.352081 46535.4270   115%     -  379s
H    0     0                    21775.281153 46535.4270   114%     -  379s
     0     0 46535.4270    0  423 21775.2812 46535.4270   114%     -  379s
     0     0 46263.5587    0  440 21775.2812 46263.5587   112%     -  403s
     0     0 46194.8730    0  435 21775.2812 46194.8730   112%     -  419s
     0     0 46159.8124    0  433 21775.2812 46159.8124   112%     -  432s
     0     0 46117.8478    0  442 21775.2812 46117.8478   112%     -  443s
     0     0 46107.4523    0  447 21775.2812 46107.4523   112%     -  450s
     0     0 46105.4784    0  440 21775.2812 46105.4784   112%     -  452s
     0     0 46102.0278    0  447 21775.2812 46102.0278   112%     -  456s
     0     0 46095.4324    0  445 21775.2812 46095.4324   112%     -  459s
     0     0 46085.9022    0  439 21775.2812 46085.9022   112%     -  463s
     0     0 46081.4169    0  441 21775.2812 46081.4169   112%     -  466s
     0     0 46080.6560    0  439 21775.2812 46080.6560   112%     -  468s
     0     0 45332.3791    0  346 21775.2812 45332.3791   108%     -  542s
     0     0 45045.1501    0  354 21775.2812 45045.1501   107%     -  579s
     0     0 44937.2418    0  315 21775.2812 44937.2418   106%     -  602s
     0     0 44867.1710    0  356 21775.2812 44867.1710   106%     -  621s
     0     0 44667.5964    0  365 21775.2812 44667.5964   105%     -  641s
     0     0 44651.0538    0  357 21775.2812 44651.0538   105%     -  650s
     0     0 44640.8735    0  364 21775.2812 44640.8735   105%     -  654s
     0     0 44627.5398    0  358 21775.2812 44627.5398   105%     -  661s
     0     0 44609.7655    0  365 21775.2812 44609.7655   105%     -  669s
     0     0 44602.2523    0  365 21775.2812 44602.2523   105%     -  673s
     0     0 44598.4571    0  366 21775.2812 44598.4571   105%     -  677s
     0     0 44596.9701    0  365 21775.2812 44596.9701   105%     -  679s
     0     0 44594.2675    0  368 21775.2812 44594.2675   105%     -  682s
     0     0 44592.8798    0  369 21775.2812 44592.8798   105%     -  685s
H    0     0                    21902.980816 44338.9925   102%     -  725s
     0     0 44338.9925    0  563 21902.9808 44338.9925   102%     -  725s
H    0     0                    22235.594493 44338.8902  99.4%     -  726s
H    0     0                    22279.048509 44338.8902  99.0%     -  726s
H    0     0                    22379.021720 44338.8902  98.1%     -  726s
     0     0 44281.2948    0  417 22379.0217 44281.2948  97.9%     -  747s
     0     0 44261.1343    0  535 22379.0217 44261.1343  97.8%     -  761s
     0     0 44241.6637    0  546 22379.0217 44241.6637  97.7%     -  770s
     0     0 44228.3816    0  562 22379.0217 44228.3816  97.6%     -  777s
     0     0 44210.3813    0  545 22379.0217 44210.3813  97.6%     -  791s
     0     0 44199.6412    0  543 22379.0217 44199.6412  97.5%     -  800s
     0     0 44191.1054    0  538 22379.0217 44191.1054  97.5%     -  807s
     0     0 44185.9234    0  532 22379.0217 44185.9234  97.4%     -  812s
     0     0 44182.3575    0  537 22379.0217 44182.3575  97.4%     -  816s
     0     0 44180.2379    0  539 22379.0217 44180.2379  97.4%     -  820s
     0     0 44179.6600    0  534 22379.0217 44179.6600  97.4%     -  821s
     0     0 44057.7595    0  389 22379.0217 44057.7595  96.9%     -  842s
H    0     0                    22611.634833 44057.6626  94.8%     -  845s
H    0     0                    23027.217447 44057.6626  91.3%     -  845s
     0     0 44029.1840    0  388 23027.2174 44029.1840  91.2%     -  855s
     0     0 43993.0579    0  394 23027.2174 43993.0579  91.0%     -  870s
     0     0 43971.2896    0  563 23027.2174 43971.2896  91.0%     -  886s
     0     0 43967.5296    0  398 23027.2174 43967.5296  90.9%     -  894s
     0     0 43966.7693    0  395 23027.2174 43966.7693  90.9%     -  895s
     0     0 43941.0266    0  389 23027.2174 43941.0266  90.8%     -  910s
     0     0 43920.3933    0  397 23027.2174 43920.3933  90.7%     -  924s
     0     0 43916.0693    0  380 23027.2174 43916.0693  90.7%     -  928s
     0     0 43914.4672    0  390 23027.2174 43914.4672  90.7%     -  930s
     0     0 43895.4461    0  413 23027.2174 43895.4461  90.6%     -  945s
H    0     0                    23245.506570 43895.4077  88.8%     -  947s
     0     0 43891.7962    0  414 23245.5066 43891.7962  88.8%     -  953s
     0     0 43889.6759    0  415 23245.5066 43889.6759  88.8%     -  956s
     0     0 43889.2997    0  388 23245.5066 43889.2997  88.8%     -  957s
     0     0 43873.9826    0  418 23245.5066 43873.9826  88.7%     -  963s
     0     0 43869.2196    0  482 23245.5066 43869.2196  88.7%     -  969s
     0     0 43866.2806    0  426 23245.5066 43866.2806  88.7%     -  973s
     0     0 43864.9700    0  417 23245.5066 43864.9700  88.7%     -  974s
     0     0 43860.4655    0  396 23245.5066 43860.4655  88.7%     -  982s
     0     0 43859.6599    0  398 23245.5066 43859.6599  88.7%     -  989s
     0     0 43855.5941    0  397 23245.5066 43855.5941  88.7%     -  996s
     0     0 43854.9036    0  587 23245.5066 43854.9036  88.7%     - 1001s
     0     0 43845.6078    0  600 23245.5066 43845.6078  88.6%     - 1014s
     0     0 43845.4682    0  600 23245.5066 43845.4682  88.6%     - 1017s
     0     2 43845.4682    0  600 23245.5066 43845.4682  88.6%     - 1180s
     1     4 43723.2364    1  598 23245.5066 43844.8248  88.6% 14447 1203s
     3     8 43683.4993    2  560 23245.5066 43723.1783  88.1% 13671 1229s
     7    16 43548.6373    3  406 23245.5066 43683.4202  87.9% 13077 1267s
    15    32 43463.4746    4  398 23245.5066 43548.6328  87.3% 14613 1326s
    31    48 43092.1849    5  392 23245.5066 43463.2730  87.0% 21200 1467s
    47    80 42487.3952    6  389 23245.5066 43463.2730  87.0% 20106 1551s
H   71    80                    23312.149647 43463.2730  86.4% 16948 1551s
    79   144 42223.8570    7  370 23312.1496 43463.2730  86.4% 15706 1750s
   143   175 42057.8148    9  361 23312.1496 43463.2730  86.4% 11355 1808s
   174   225 42124.7052    8  371 23312.1496 43463.2730  86.4% 10237 1864s
H  213   225                    24978.617130 43463.2730  74.0%  9169 1864s
   224   361 41773.3819   10  286 24978.6171 43463.2730  74.0%  8992 1931s
   360   470 41881.6249    9  293 24978.6171 43463.2730  74.0%  7641 1981s
   469   560 41882.6882   11  350 24978.6171 43463.2730  74.0%  6892 2021s
   559   641 41342.8138   11  352 24978.6171 43463.2730  74.0%  6507 2056s
   640   723 41612.5325   10  334 24978.6171 43463.2730  74.0%  6184 2087s
   722   801 41648.4968   12  346 24978.6171 43463.2730  74.0%  5903 2117s
   800   864 41787.5774   12  356 24978.6171 43463.2730  74.0%  5654 2150s
   874   928 41607.4776   12  282 24978.6171 43463.2730  74.0%  5417 2184s
   957   992 41506.1530   13  342 24978.6171 43463.2730  74.0%  5195 2217s
  1040  1057 32575.3654   34  263 24978.6171 43463.2730  74.0%  5042 2255s
  1133  1143 40882.5403   14  289 24978.6171 43463.2730  74.0%  4878 2293s
  1235  1240 31822.1631   38  199 24978.6171 43463.2730  74.0%  4725 2332s
  1350  1359 40527.3051   15  285 24978.6171 43463.2730  74.0%  4592 2371s
  1503  1492 40306.0572   16  286 24978.6171 43463.2730  74.0%  4369 2410s
  1670  1597 39529.7164   20  254 24978.6171 43463.2730  74.0%  4153 2446s
  1817  1663 38943.1732   18  271 24978.6171 43463.2730  74.0%  4014 2486s
  1951  1718 37931.9457   21  228 24978.6171 43463.2730  74.0%  3914 2535s
  2064  1767 37315.7385   22  218 24978.6171 43463.2730  74.0%  3864 2584s
  2165  1824 37104.5037   23  218 24978.6171 43463.2730  74.0%  3856 2637s
  2250  1876 35542.2290   27  326 24978.6171 43463.2730  74.0%  3857 2693s
  2332  1969 34533.2890   28  327 24978.6171 43463.2730  74.0%  3891 2753s
  2447  2086 34377.4479   29  317 24978.6171 43345.7260  73.5%  3916 2809s
  2584  2231 33594.0596   33  270 24978.6171 43079.5413  72.5%  3916 2863s
  2753  2389 33119.5793   35  269 24978.6171 43079.5413  72.5%  3863 2919s
  2953  2538 31844.1119   47  123 24978.6171 43079.5413  72.5%  3789 2981s
  3176  2688 31028.1044   52  143 24978.6171 43079.5413  72.5%  3706 3040s
  3413  2866 31541.5245   59  102 24978.6171 42963.1960  72.0%  3627 3103s
H 3623  2865                    25070.734597 42963.1960  71.4%  3593 3136s
H 3623  2859                    25178.799875 42963.1960  70.6%  3593 3149s
  3624  2859 25943.6623   61  600 25178.7999 42963.1960  70.6%  3592 3259s
  3626  2860 35688.0943   28   69 25178.7999 42963.1960  70.6%  3590 3270s
H 3626  2716                    25205.838856 42963.1960  70.4%  3590 3370s
  3627  2717 33487.4449   44  331 25205.8389 42963.1960  70.4%  3589 3376s
  3628  2718 27216.3876   31  309 25205.8389 42963.1960  70.4%  3588 3468s
  3629  2718 36052.7209   24  345 25205.8389 42963.1960  70.4%  3587 3509s
  3630  2719 27088.4089   36  377 25205.8389 42963.1960  70.4%  3586 3550s
  3631  2720 27838.7473   39  369 25205.8389 42963.1960  70.4%  3585 3569s
  3632  2720 38068.2576   34  395 25205.8389 42963.1960  70.4%  3584 3590s

Cutting planes:
  Implied bound: 11
  MIR: 264
  Flow cover: 342
  RLT: 11
  Relax-and-lift: 100

Explored 3632 nodes (13721805 simplex iterations) in 3600.15 seconds (5063.28 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 25205.8 25178.8 25070.7 ... 22279

Time limit reached
Best objective 2.520583885569e+04, best bound 4.296319599069e+04, gap 70.4494%
  WARNING: Time limit reached. Using best solution found (gap: 70.45%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.20s
  Master Objective (UB) = 25205.84, θ = 184774.72
  Upper Bound (UB) = 25205.84

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 184774.72
  [DEBUG]   ✓ Scenario 0: θ = 184774.72 ≤ Q = 184774.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 184774.72 ≤ Q = 184774.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 184774.72 ≤ Q = 184774.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 184774.72 ≤ Q = 184774.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 184774.72 ≤ Q = 184774.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 184774.72 ≤ Q = 184774.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 184774.72 ≤ Q = 184774.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 184774.72 ≤ Q = 184774.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 184774.72 ≤ Q = 184774.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 184774.72 ≤ Q = 184774.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 184774.72 ≤ Q = 184774.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 184774.72 ≤ Q = 184774.72 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 12] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x5b5674a8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xa4a98b58
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.259521e+13
Presolve removed 2622 rows and 1913 columns
Presolve time: 0.01s
Presolved: 471 rows, 476 columns, 1328 nonzeros
Found heuristic solution: objective 5574442.0500
Variable types: 324 continuous, 152 integer (152 binary)

Root relaxation: objective -1.651434e+05, 245 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -165143.45    0  128 5574442.05 -165143.45   103%     -    0s
H    0     0                    -132589.8656 -165143.45  24.6%     -    0s
H    0     0                    -132964.9993 -165143.45  24.2%     -    0s
     0     0 -145502.58    0   49 -132965.00 -145502.58  9.43%     -    0s
H    0     0                    -144343.8166 -145482.63  0.79%     -    0s
     0     0 -145434.69    0   32 -144343.82 -145434.69  0.76%     -    0s
     0     0 -145429.03    0   50 -144343.82 -145429.03  0.75%     -    0s
     0     0 -145165.73    0   19 -144343.82 -145165.73  0.57%     -    0s
H    0     0                    -144687.9133 -145106.70  0.29%     -    0s
     0     0 -145106.70    0   16 -144687.91 -145106.70  0.29%     -    0s
     0     0 -145106.70    0   16 -144687.91 -145106.70  0.29%     -    0s
     0     0 -144887.54    0   10 -144687.91 -144887.54  0.14%     -    0s
     0     0 -144853.32    0    6 -144687.91 -144853.32  0.11%     -    0s
H    0     0                    -144740.3726 -144853.32  0.08%     -    0s
     0     0 -144808.98    0    5 -144740.37 -144808.98  0.05%     -    0s
     0     0 -144774.94    0    4 -144740.37 -144774.94  0.02%     -    0s
     0     0 -144774.94    0    7 -144740.37 -144774.94  0.02%     -    0s
     0     0 -144774.94    0    6 -144740.37 -144774.94  0.02%     -    0s
H    0     0                    -144762.2660 -144774.94  0.01%     -    0s

Explored 1 nodes (511 simplex iterations) in 0.05 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -144762 -144740 -144688 ... 1.25952e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.447622660082e+05, best bound -1.447749361333e+05, gap 0.0088%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 174521.17
  Scenario: 22 demand increases, 38 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -144762.27
  [DEBUG]   S×d_nominal = 319283.44
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 319283.44 + -144762.27 = 174521.17
  [DEBUG]   Current θ from Master = 184774.72
  [DEBUG]   ⚠️  Z_SP ≤ θ by 10253.55 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 14952.29
  Lower Bound (LB) = 25086.86
  Gap (UB-LB) = 118.9775, Absolute Gap = 118.9775, Relative Gap = 0.004720
  *** CONVERGED (gap within tolerance) ***

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 12
Total Time: 26752.34s
Converged: True
Final Lower Bound: 25086.8613
Final Upper Bound: 25205.8389
Final Gap: 118.977550
Number of Critical Scenarios: 12
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [1] (1/3)
Product 1 Plants: [1] (1/3)
Product 2 Plants: [1] (1/3)
Total Plant Openings: 3
DCs Opened: [0, 2, 4, 6, 7] (5/10)
Active Routes (Plant→DC): 12
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 0 customers  Mode 1: 1 customers  Mode 2: 49 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 12
Start Time: 2026-01-04 12:31:03
End Time: 2026-01-04 19:56:55
Total Time: 26752.34s
Optimal Value: 25086.86
Lower Bound: 25086.86
Upper Bound: 25205.84
Gap: 118.977550
Plants Opened: {0: [1], 1: [1], 2: [1]} (3 plants)
DCs Opened: [0, 2, 4, 6, 7] (5 DCs)
================================================================================

Results saved to: result/DH_single_full_seed25_HD_gamma20_20260104_195655.csv

Total Execution Time: 26752.72 seconds
End Time: 2026-01-04 19:56:55

All tasks completed successfully!

