
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 2
DI Scenario: MD
Start Time: 2026-01-04 23:23:25
================================================================================
Loading data from data/DH_data_full_seed2.pkl...

Applying DI scenario: MD
DI values:
  Product 0: ['1.000', '1.242', '1.542'] (k=0.534)
  Product 1: ['1.000', '1.173', '1.377'] (k=0.394)
  Product 2: ['1.000', '1.211', '1.467'] (k=0.473)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=1012, max=1692
  DC capacity (MC): min=538, max=877

Demand Structure (s_rk matrix):
  Total customer-product pairs: 85/150 (43.3% sparse)
  Average products per customer: 1.70

Demand (only non-zero entries):
  Nominal (μ): min=8.09, max=34.97, count=85
  Deviation (μ̂): min=4.00, max=9.83

Costs:
  Plant fixed cost: min=5209, max=8462
  DC fixed cost: min=3490, max=5712
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.333', '1.778'] (k=0.710)
    Product 1: ['1.000', '1.395', '1.945'] (k=0.820)
    Product 2: ['1.000', '1.386', '1.922'] (k=0.805)
  MD:
    Product 0: ['1.000', '1.242', '1.542'] (k=0.534)
    Product 1: ['1.000', '1.173', '1.377'] (k=0.394)
    Product 2: ['1.000', '1.211', '1.467'] (k=0.473)
  LD:
    Product 0: ['1.000', '1.018', '1.037'] (k=0.045)
    Product 1: ['1.000', '1.093', '1.194'] (k=0.219)
    Product 2: ['1.000', '1.115', '1.244'] (k=0.269)
  Mixed:
    Product 0: ['1.000', '1.333', '1.778'] (k=0.710)
    Product 1: ['1.000', '1.173', '1.377'] (k=0.394)
    Product 2: ['1.000', '1.115', '1.244'] (k=0.269)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48765 nonzeros
Model fingerprint: 0x1034080e
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11666 rows and 2666 columns
Presolve time: 0.08s
Presolved: 5007 rows, 5834 columns, 34720 nonzeros
Variable types: 3575 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -280004.0111
Found heuristic solution: objective -180534.4700

Root relaxation: objective 1.054389e+05, 4821 iterations, 0.16 seconds (0.27 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 105438.879    0  423 -180534.47 105438.879   158%     -    0s
H    0     0                    -157418.8234 105438.879   167%     -    0s
H    0     0                    -154420.0191 97911.0887   163%     -    0s
     0     0 97911.0887    0  731 -154420.02 97911.0887   163%     -    0s
H    0     0                    -151158.1204 97909.7874   165%     -    0s
H    0     0                    -142994.5139 97636.4165   168%     -    1s
     0     0 97636.4165    0  740 -142994.51 97636.4165   168%     -    1s
     0     0 97627.1625    0  749 -142994.51 97627.1625   168%     -    1s
     0     0 97624.0493    0  751 -142994.51 97624.0493   168%     -    1s
     0     0 97623.8514    0  751 -142994.51 97623.8514   168%     -    1s
H    0     0                    -132134.3433 91944.3571   170%     -    2s
     0     0 91944.3571    0  943 -132134.34 91944.3571   170%     -    2s
H    0     0                    -62337.41738 91626.8090   247%     -    2s
     0     0 91626.8090    0  957 -62337.417 91626.8090   247%     -    2s
     0     0 91529.3259    0  969 -62337.417 91529.3259   247%     -    2s
     0     0 91520.5779    0  972 -62337.417 91520.5779   247%     -    2s
     0     0 91519.3205    0  971 -62337.417 91519.3205   247%     -    2s
     0     0 88534.5891    0 1060 -62337.417 88534.5891   242%     -    4s
H    0     0                    -46927.52736 88214.3082   288%     -    4s
H    0     0                    -41175.10413 88214.3082   314%     -    4s
H    0     0                    22281.650439 88214.3082   296%     -    4s
     0     0 88214.3082    0 1075 22281.6504 88214.3082   296%     -    4s
     0     0 88167.5307    0 1085 22281.6504 88167.5307   296%     -    4s
     0     0 88162.3556    0 1088 22281.6504 88162.3556   296%     -    4s
     0     0 85886.7040    0 1150 22281.6504 85886.7040   285%     -    5s
H    0     0                    24578.058722 85646.7361   248%     -    6s
H    0     0                    26764.249215 85646.7361   220%     -    6s
H    0     0                    27226.916963 85646.7361   215%     -    6s
H    0     0                    27334.589466 85646.7361   213%     -    6s
H    0     0                    27485.704877 85646.7361   212%     -    6s
H    0     0                    28156.799593 85646.7361   204%     -    6s
H    0     0                    28190.651494 85646.7361   204%     -    6s
H    0     0                    28228.910112 85646.7361   203%     -    6s
     0     0 85646.7361    0 1156 28228.9101 85646.7361   203%     -    6s
     0     0 85596.8386    0 1165 28228.9101 85596.8386   203%     -    6s
     0     0 85582.0527    0 1160 28228.9101 85582.0527   203%     -    6s
     0     0 85578.1231    0 1167 28228.9101 85578.1231   203%     -    6s
     0     0 84550.4848    0 1180 28228.9101 84550.4848   200%     -    7s
     0     0 84396.4304    0 1184 28228.9101 84396.4304   199%     -    7s
H    0     0                    29243.500098 84358.2988   188%     -    7s
H    0     0                    29248.946922 84358.2988   188%     -    7s
     0     0 84358.2988    0 1212 29248.9469 84358.2988   188%     -    7s
     0     0 84343.5466    0 1213 29248.9469 84343.5466   188%     -    8s
     0     0 84340.2977    0 1224 29248.9469 84340.2977   188%     -    8s
H    0     0                    31975.333696 83363.2301   161%     -    9s
H    0     0                    32374.324493 83363.2301   157%     -    9s
H    0     0                    34279.386315 83363.2301   143%     -    9s
H    0     0                    34578.806733 83363.2301   141%     -    9s
H    0     0                    34915.208074 83363.2301   139%     -    9s
     0     0 83363.2301    0 1196 34915.2081 83363.2301   139%     -    9s
     0     0 83173.7318    0 1220 34915.2081 83173.7318   138%     -    9s
     0     0 83126.9060    0 1231 34915.2081 83126.9060   138%     -    9s
     0     0 83113.7206    0 1219 34915.2081 83113.7206   138%     -   10s
H    0     0                    34937.865853 83113.7206   138%     -   10s
H    0     0                    35007.153272 81902.5053   134%     -   11s
     0     0 81902.5053    0 1154 35007.1533 81902.5053   134%     -   11s
     0     0 81628.6125    0 1189 35007.1533 81628.6125   133%     -   12s
     0     0 81561.3819    0 1218 35007.1533 81561.3819   133%     -   12s
     0     0 81531.9768    0 1220 35007.1533 81531.9768   133%     -   12s
     0     0 81526.6349    0 1235 35007.1533 81526.6349   133%     -   12s
     0     0 80587.2151    0 1149 35007.1533 80587.2151   130%     -   14s
     0     0 80399.7351    0 1183 35007.1533 80399.7351   130%     -   14s
     0     0 80354.4173    0 1200 35007.1533 80354.4173   130%     -   14s
     0     0 80348.0543    0 1191 35007.1533 80348.0543   130%     -   15s
     0     0 79414.3097    0 1182 35007.1533 79414.3097   127%     -   16s
     0     0 79217.0433    0 1215 35007.1533 79217.0433   126%     -   17s
     0     0 79173.2545    0 1241 35007.1533 79173.2545   126%     -   17s
     0     0 79157.2406    0 1249 35007.1533 79157.2406   126%     -   17s
H    0     0                    35240.822938 78468.7930   123%     -   18s
H    0     0                    35258.104680 78468.7930   123%     -   18s
H    0     0                    35325.706120 78468.7930   122%     -   18s
H    0     0                    35330.047691 78468.7930   122%     -   18s
     0     0 78468.7930    0 1160 35330.0477 78468.7930   122%     -   18s
H    0     0                    35504.345309 78301.9990   121%     -   19s
H    0     0                    35546.512385 78301.9990   120%     -   19s
     0     0 78301.9990    0 1194 35546.5124 78301.9990   120%     -   19s
H    0     0                    39229.345154 78257.4393  99.5%     -   19s
H    0     0                    40015.696181 78257.4393  95.6%     -   19s
H    0     0                    40233.681348 78257.4393  94.5%     -   19s
H    0     0                    41865.310349 78257.4393  86.9%     -   19s
H    0     0                    41880.292513 78257.4393  86.9%     -   19s
H    0     0                    41880.343389 78257.4393  86.9%     -   19s
H    0     0                    41887.021384 78257.4393  86.8%     -   19s
H    0     0                    42247.664877 78257.4393  85.2%     -   19s
H    0     0                    42271.376563 78257.4393  85.1%     -   19s
H    0     0                    42456.933935 78257.4393  84.3%     -   19s
H    0     0                    42482.898876 78257.4393  84.2%     -   19s
H    0     0                    42491.691984 78257.4393  84.2%     -   19s
H    0     0                    42540.447554 78257.4393  84.0%     -   19s
H    0     0                    42547.176424 78257.4393  83.9%     -   19s
     0     0 78257.4393    0 1196 42547.1764 78257.4393  83.9%     -   19s
     0     0 78249.3925    0 1206 42547.1764 78249.3925  83.9%     -   20s
H    0     0                    42814.578952 77766.8648  81.6%     -   21s
H    0     0                    43448.134537 77766.8648  79.0%     -   21s
H    0     0                    43561.546767 77766.8648  78.5%     -   21s
H    0     0                    44441.398556 77766.8648  75.0%     -   21s
H    0     0                    44456.047196 77766.8648  74.9%     -   21s
H    0     0                    44631.004253 77766.8648  74.2%     -   21s
H    0     0                    44634.829234 77766.8648  74.2%     -   21s
H    0     0                    44723.467183 77766.8648  73.9%     -   21s
H    0     0                    44746.305489 77766.8648  73.8%     -   21s
H    0     0                    44753.936173 77766.8648  73.8%     -   21s
     0     0 77766.8648    0 1142 44753.9362 77766.8648  73.8%     -   21s
H    0     0                    44758.101660 77663.3769  73.5%     -   22s
H    0     0                    44813.617206 77663.3769  73.3%     -   22s
H    0     0                    44849.786312 77663.3769  73.2%     -   22s
     0     0 77663.3769    0 1177 44849.7863 77663.3769  73.2%     -   22s
     0     0 77626.4646    0 1200 44849.7863 77626.4646  73.1%     -   22s
     0     0 77613.0218    0 1212 44849.7863 77613.0218  73.1%     -   22s
     0     0 77237.1064    0 1154 44849.7863 77237.1064  72.2%     -   23s
     0     0 77144.5389    0 1211 44849.7863 77144.5389  72.0%     -   24s
     0     0 77126.4758    0 1223 44849.7863 77126.4758  72.0%     -   24s
H    0     0                    44899.855746 76810.3437  71.1%     -   25s
H    0     0                    45120.708564 76810.3437  70.2%     -   25s
     0     0 76810.3437    0 1146 45120.7086 76810.3437  70.2%     -   25s
H    0     0                    45133.044475 76703.9425  70.0%     -   26s
     0     0 76703.9425    0 1135 45133.0445 76703.9425  70.0%     -   26s
H    0     0                    45162.516327 76673.8537  69.8%     -   27s
     0     0 76673.8537    0 1156 45162.5163 76673.8537  69.8%     -   27s
     0     0 76665.7030    0 1139 45162.5163 76665.7030  69.8%     -   27s
     0     0 76357.3889    0 1139 45162.5163 76357.3889  69.1%     -   28s
     0     0 76287.7371    0 1183 45162.5163 76287.7371  68.9%     -   29s
H    0     0                    45185.743744 76270.4982  68.8%     -   29s
H    0     0                    45203.322939 76270.4982  68.7%     -   29s
H    0     0                    45486.545149 76270.4982  67.7%     -   29s
H    0     0                    45710.728426 76270.4982  66.9%     -   29s
H    0     0                    45952.595104 76270.4982  66.0%     -   29s
     0     0 76270.4982    0 1165 45952.5951 76270.4982  66.0%     -   29s
H    0     0                    45955.161732 76270.4982  66.0%     -   29s
H    0     0                    46149.790030 76001.0197  64.7%     -   30s
H    0     0                    46171.889790 76001.0197  64.6%     -   30s
H    0     0                    46182.740257 76001.0197  64.6%     -   30s
H    0     0                    46206.803210 76001.0197  64.5%     -   30s
H    0     0                    46229.029845 76001.0197  64.4%     -   30s
     0     0 76001.0197    0 1117 46229.0298 76001.0197  64.4%     -   30s
H    0     0                    46254.036521 75946.7620  64.2%     -   31s
H    0     0                    46256.399576 75946.7620  64.2%     -   31s
     0     0 75946.7620    0 1111 46256.3996 75946.7620  64.2%     -   31s
     0     0 75925.6982    0 1114 46256.3996 75925.6982  64.1%     -   31s
H    0     0                    46321.585990 75646.7119  63.3%     -   32s
     0     0 75646.7119    0 1157 46321.5860 75646.7119  63.3%     -   32s
H    0     0                    46328.685251 75529.4176  63.0%     -   33s
H    0     0                    46355.546991 75529.4176  62.9%     -   33s
     0     0 75529.4176    0 1164 46355.5470 75529.4176  62.9%     -   33s
     0     0 75507.2123    0 1169 46355.5470 75507.2123  62.9%     -   34s
H    0     0                    46365.246836 75337.7892  62.5%     -   35s
     0     0 75337.7892    0 1130 46365.2468 75337.7892  62.5%     -   35s
     0     0 75337.7077    0 1130 46365.2468 75337.7077  62.5%     -   35s
     0     2 75337.7077    0 1130 46365.2468 75337.7077  62.5%     -   37s
     1     4 74650.7236    1 1011 46365.2468 75336.9964  62.5%  4608   40s
    15    32 71965.1070    4  791 46365.2468 73127.9228  57.7%  3927   45s
    63    96 70115.3697    6  584 46365.2468 71187.5730  53.5%  5944   50s
H  101   175                    46460.312030 71186.7694  53.2%  4251   52s
H  107   175                    46524.805199 71186.7694  53.0%  4034   52s
H  113   175                    46528.659779 71186.7694  53.0%  3862   52s
H  160   175                    46554.577228 71186.7694  52.9%  2874   52s
H  162   175                    46568.053667 71186.7694  52.9%  2847   52s
   334   365 68809.6573   11  574 46568.0537 71186.7694  52.9%  1720   55s
H  350   365                    46615.117169 71186.7694  52.7%  1692   55s
H  355   365                    47427.689385 71186.7694  50.1%  1676   55s
H  487   512                    47871.988112 71186.7694  48.7%  1360   57s
H  490   512                    47994.658611 71186.7694  48.3%  1357   57s
H  491   512                    48348.846671 71186.7694  47.2%  1355   57s
H  495   512                    48532.869108 71186.7694  46.7%  1347   57s
H  505   512                    48571.520015 71186.7694  46.6%  1332   57s
H  516   512                    48626.728892 71186.7694  46.4%  1310   57s
H  517   512                    48814.569344 71186.7694  45.8%  1308   57s
H  520   512                    48945.017224 71186.7694  45.4%  1302   57s
   832   871 65877.7282   17  500 48945.0172 70557.7136  44.2%   986   60s
H 1251  1164                    49109.849035 69979.0870  42.5%   789   63s
H 1766  1653                    49243.833410 69978.6451  42.1%   636   65s
H 1797  1653                    49271.370545 69717.3461  41.5%   633   65s
H 1807  1653                    49293.099192 69717.3461  41.4%   631   65s
  2672  2402 50814.7403   24  331 49293.0992 68809.5457  39.6%   515   70s
  3468  2963 60583.7378   24  311 49293.0992 67960.2257  37.9%   456   76s
H 3742  2961                    49340.190948 67807.9525  37.4%   444   96s
  3743  2962 51732.7379   38 1130 49340.1909 67807.9525  37.4%   444  107s
  3761  2974 60004.1271   23  526 49340.1909 60811.5504  23.2%   441  110s
H 3818  2877                    49367.623639 58226.8056  17.9%   449  114s
  4011  2967 53627.4691   20  364 49367.6236 56181.0706  13.8%   443  115s
H 4140  2821                    49393.365613 55790.2639  13.0%   437  116s
H 4648  2608                    49437.999351 55618.3001  12.5%   412  118s
H 4649  2480                    49440.198563 55618.3001  12.5%   412  118s
H 4664  2353                    49499.742226 55618.3001  12.4%   411  118s
  5176  2186 50958.6870   24  195 49499.7422 54470.1922  10.0%   390  120s
* 7813  1037              57    49584.451105 49870.1522  0.58%   295  124s
* 8394   790              60    49598.442303 49857.9040  0.52%   276  124s
H 8467   660                    49646.751977 49857.9040  0.43%   273  124s
*10039   105              74    49647.587521 49808.2541  0.32%   234  124s
 10347    28 49691.3784   60   18 49647.5875 49754.8053  0.22%   227  125s
*10619    28              71    49653.380673 49754.8053  0.20%   222  125s

Cutting planes:
  Gomory: 1
  Implied bound: 5
  Projected implied bound: 25
  MIR: 187
  Flow cover: 522
  RLT: 10
  Relax-and-lift: 116

Explored 10719 nodes (2458847 simplex iterations) in 125.04 seconds (263.41 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 49653.4 49647.6 49646.8 ... 49367.6

Optimal solution found (tolerance 1.00e-04)
Best objective 4.965338067273e+04, best bound 4.965338067273e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 125.04s
  Master Objective (UB) = 49653.38, θ = 179822.36
  Upper Bound (UB) = 49653.38

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 179822.36
  [DEBUG]   ✓ Scenario 0: θ = 179822.36 ≤ Q = 179822.36 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x34d7760b
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x34d7760b
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.549846e+13
Presolve removed 2571 rows and 1864 columns
Presolve time: 0.00s
Presolved: 522 rows, 525 columns, 1472 nonzeros
Found heuristic solution: objective 8320908.0068
Variable types: 355 continuous, 170 integer (170 binary)

Root relaxation: objective -1.376878e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -137687.80    0  124 8320908.01 -137687.80   102%     -    0s
H    0     0                    -102908.6656 -137687.80  33.8%     -    0s
H    0     0                    -103423.0020 -137687.80  33.1%     -    0s
H    0     0                    -106313.9066 -106313.91  0.00%     -    0s
     0     0          -    0      -106313.91 -106313.91  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 209

Explored 1 nodes (375 simplex iterations) in 0.01 seconds (0.02 work units)
Thread count was 32 (of 64 available processors)

Solution count 5: -106314 -103423 -102909 ... 1.54985e+13
No other solutions better than -106314

Optimal solution found (tolerance 1.00e-04)
Best objective -1.063139066384e+05, best bound -1.063139066384e+05, gap 0.0000%
  Subproblem solved in 0.03s
  Worst-case operational profit (Z_SP) = 147299.71
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -106313.91
  [DEBUG]   S×d_nominal = 253613.62
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 253613.62 + -106313.91 = 147299.71
  [DEBUG]   Current θ from Master = 179822.36
  [DEBUG]   ⚠️  Z_SP ≤ θ by 32522.65 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 17130.73
  Lower Bound (LB) = 17130.73
  Gap (UB-LB) = 32522.6488, Absolute Gap = 32522.6488, Relative Gap = 0.654994
  Not converged yet (gap = 32522.65 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 92011 nonzeros
Model fingerprint: 0x881eacaf
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 17130.7 (0.01s)
MIP start from previous solve produced solution with objective 17130.7 (0.01s)
Loaded MIP start from previous solve with objective 17130.7

Presolve removed 13161 rows and 5340 columns
Presolve time: 0.31s
Presolved: 18802 rows, 9400 columns, 104218 nonzeros
Variable types: 7141 continuous, 2259 integer (2259 binary)

Root relaxation: objective 5.626447e+04, 8298 iterations, 0.99 seconds (2.11 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 56264.4679    0  295 17130.7318 56264.4679   228%     -    1s
H    0     0                    18202.024339 56264.4679   209%     -    1s
H    0     0                    18897.525234 56264.4679   198%     -    1s
     0     0 49807.8540    0  421 18897.5252 49807.8540   164%     -    2s
H    0     0                    19156.916723 49805.4224   160%     -    2s
     0     0 49564.5776    0  430 19156.9167 49564.5776   159%     -    2s
     0     0 49556.5695    0  434 19156.9167 49556.5695   159%     -    2s
     0     0 49556.5206    0  435 19156.9167 49556.5206   159%     -    2s
     0     0 44828.2525    0  511 19156.9167 44828.2525   134%     -    4s
H    0     0                    19586.160348 44815.7154   129%     -    4s
H    0     0                    19761.148297 44815.7154   127%     -    4s
H    0     0                    19813.632391 44815.7154   126%     -    4s
     0     0 44422.7310    0  528 19813.6324 44422.7310   124%     -    5s
     0     0 44413.9734    0  521 19813.6324 44413.9734   124%     -    5s
     0     0 44412.6505    0  530 19813.6324 44412.6505   124%     -    5s
H    0     0                    20277.488034 41317.4154   104%     -    7s
H    0     0                    22536.589966 41317.4154  83.3%     -    7s
H    0     0                    23910.594866 41317.4154  72.8%     -    7s
     0     0 41317.4154    0  510 23910.5949 41317.4154  72.8%     -    7s
     0     0 40718.6185    0  456 23910.5949 40718.6185  70.3%     -    8s
     0     0 40635.6089    0  574 23910.5949 40635.6089  69.9%     -    8s
     0     0 40485.8489    0  522 23910.5949 40485.8489  69.3%     -    8s
H    0     0                    25124.088657 40328.6212  60.5%     -    8s
     0     0 40328.6212    0  528 25124.0887 40328.6212  60.5%     -    8s
     0     0 40287.4565    0  534 25124.0887 40287.4565  60.4%     -    9s
     0     0 40284.4605    0  530 25124.0887 40284.4605  60.3%     -    9s
     0     0 37843.8327    0  542 25124.0887 37843.8327  50.6%     -   11s
H    0     0                    26042.069866 37302.9485  43.2%     -   12s
H    0     0                    26063.679086 37302.9485  43.1%     -   12s
H    0     0                    26066.481522 37302.9485  43.1%     -   12s
H    0     0                    26073.261652 37302.9485  43.1%     -   12s
     0     0 37302.9485    0  551 26073.2617 37302.9485  43.1%     -   12s
     0     0 37120.8726    0  653 26073.2617 37120.8726  42.4%     -   13s
     0     0 37081.3092    0  640 26073.2617 37081.3092  42.2%     -   13s
     0     0 37039.8752    0  718 26073.2617 37039.8752  42.1%     -   14s
     0     0 37025.8812    0  716 26073.2617 37025.8812  42.0%     -   14s
     0     0 37021.5060    0  727 26073.2617 37021.5060  42.0%     -   14s
     0     0 36066.0562    0  469 26073.2617 36066.0562  38.3%     -   15s
     0     0 35875.6063    0  470 26073.2617 35875.6063  37.6%     -   16s
     0     0 35810.4590    0  487 26073.2617 35810.4590  37.3%     -   16s
     0     0 35786.3236    0  484 26073.2617 35786.3236  37.3%     -   17s
     0     0 35778.9021    0  490 26073.2617 35778.9021  37.2%     -   17s
     0     0 35775.9698    0  500 26073.2617 35775.9698  37.2%     -   17s
     0     0 35495.5471    0  526 26073.2617 35495.5471  36.1%     -   18s
H    0     0                    26092.239036 35495.4558  36.0%     -   18s
     0     0 35453.0376    0  467 26092.2390 35453.0376  35.9%     -   18s
     0     0 35423.2022    0  550 26092.2390 35423.2022  35.8%     -   19s
     0     0 35412.2821    0  487 26092.2390 35412.2821  35.7%     -   19s
     0     0 35410.3014    0  488 26092.2390 35410.3014  35.7%     -   19s
     0     0 35307.4088    0  482 26092.2390 35307.4088  35.3%     -   20s
     0     0 35269.9234    0  470 26092.2390 35269.9234  35.2%     -   20s
     0     0 35245.9843    0  459 26092.2390 35245.9843  35.1%     -   20s
     0     0 35243.9221    0  472 26092.2390 35243.9221  35.1%     -   20s
     0     0 35146.9852    0  518 26092.2390 35146.9852  34.7%     -   21s
     0     0 35105.9541    0  459 26092.2390 35105.9541  34.5%     -   22s
     0     0 35092.7484    0  467 26092.2390 35092.7484  34.5%     -   22s
     0     0 35083.3281    0  700 26092.2390 35083.3281  34.5%     -   22s
     0     0 35081.7695    0  636 26092.2390 35081.7695  34.5%     -   22s
     0     0 35021.5461    0  476 26092.2390 35021.5461  34.2%     -   23s
     0     0 35021.5461    0  476 26092.2390 35021.5461  34.2%     -   23s
H    0     0                    26106.593839 35021.3966  34.1%     -   23s
     0     0 35003.3032    0  474 26106.5938 35003.3032  34.1%     -   23s
     0     0 34996.9803    0  482 26106.5938 34996.9803  34.1%     -   23s
     0     0 34979.2902    0  463 26106.5938 34979.2902  34.0%     -   24s
     0     0 34971.6666    0  470 26106.5938 34971.6666  34.0%     -   24s
     0     0 34970.4358    0  474 26106.5938 34970.4358  34.0%     -   24s
     0     0 34939.0996    0  534 26106.5938 34939.0996  33.8%     -   25s
     0     0 34938.9132    0  534 26106.5938 34938.9132  33.8%     -   25s
     0     2 34936.8897    0  534 26106.5938 34936.8897  33.8%     -   29s
     3     8 34709.7682    2  428 26106.5938 34868.3342  33.6%   762   30s
    63    94 34034.8405    6  431 26106.5938 34034.8405  30.4%  1159   35s
   229   213 31702.0173    9  343 26106.5938 34006.2136  30.3%   948   40s
   557   386 29268.2368   12  370 26106.5938 33186.9191  27.1%   732   45s
   993   588 27642.2573   16  324 26106.5938 32405.2537  24.1%   573   50s
  1465   763 27509.2838   11  241 26106.5938 31980.2229  22.5%   503   56s
  2124   968 28208.8811   11  321 26106.5938 30801.8055  18.0%   440   61s
  2755  1034 26736.9776   15  294 26106.5938 29814.1981  14.2%   425   65s
  3483  1103 27382.6775   13  285 26106.5938 29374.7495  12.5%   406   70s
  4560  1120     cutoff   12      26106.5938 28927.0684  10.8%   380   75s
  5630  1025     cutoff   18      26106.5938 28277.8528  8.32%   360   80s
  7142   748 26376.6554   10  273 26106.5938 27606.2109  5.74%   330   85s

Cutting planes:
  Learned: 1
  Gomory: 7
  MIR: 1505
  Flow cover: 941
  RLT: 43
  Relax-and-lift: 314

Explored 8958 nodes (2661386 simplex iterations) in 87.26 seconds (218.18 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 26106.6 26092.2 26073.3 ... 20277.5

Optimal solution found (tolerance 1.00e-04)
Best objective 2.610659383854e+04, best bound 2.610659383854e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 87.27s
  Master Objective (UB) = 26106.59, θ = 148766.43
  Upper Bound (UB) = 26106.59

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 148766.43
  [DEBUG]   ✓ Scenario 0: θ = 148766.43 ≤ Q = 148766.43 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 148766.43 ≤ Q = 148766.43 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x2b7f4966
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x2b7f4966
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.454065e+13
Presolve removed 2571 rows and 1864 columns
Presolve time: 0.00s
Presolved: 522 rows, 525 columns, 1472 nonzeros
Found heuristic solution: objective 7592987.7392
Variable types: 355 continuous, 170 integer (170 binary)

Root relaxation: objective -1.496073e+05, 265 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -149607.25    0  134 7592987.74 -149607.25   102%     -    0s
H    0     0                    -113581.9783 -149607.25  31.7%     -    0s
H    0     0                    -128730.8870 -149607.25  16.2%     -    0s
     0     0 -138219.02    0   76 -128730.89 -138219.02  7.37%     -    0s
H    0     0                    -136182.1102 -138095.65  1.41%     -    0s
H    0     0                    -136594.8920 -137468.94  0.64%     -    0s
     0     0 -137468.94    0   63 -136594.89 -137468.94  0.64%     -    0s
     0     0 -137450.54    0   63 -136594.89 -137450.54  0.63%     -    0s
     0     0 -136756.15    0   26 -136594.89 -136756.15  0.12%     -    0s
     0     0 -136711.63    0   19 -136594.89 -136711.63  0.09%     -    0s
     0     0 -136689.55    0   17 -136594.89 -136689.55  0.07%     -    0s
     0     0 -136683.96    0   12 -136594.89 -136683.96  0.07%     -    0s
     0     0 -136654.06    0   13 -136594.89 -136654.06  0.04%     -    0s
     0     0 -136650.79    0   12 -136594.89 -136650.79  0.04%     -    0s
H    0     0                    -136596.7256 -136644.45  0.03%     -    0s
     0     0 -136644.45    0    9 -136596.73 -136644.45  0.03%     -    0s
     0     0 -136617.31    0    4 -136596.73 -136617.31  0.02%     -    0s
     0     0 -136617.31    0    5 -136596.73 -136617.31  0.02%     -    0s
H    0     0                    -136614.1721 -136617.31  0.00%     -    0s

Explored 1 nodes (633 simplex iterations) in 0.04 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 7: -136614 -136597 -136595 ... 1.45406e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.366141721121e+05, best bound -1.366173110417e+05, gap 0.0023%
  Subproblem solved in 0.06s
  Worst-case operational profit (Z_SP) = 124392.20
  Scenario: 34 demand increases, 26 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -136614.17
  [DEBUG]   S×d_nominal = 261006.37
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 261006.37 + -136614.17 = 124392.20
  [DEBUG]   Current θ from Master = 148766.43
  [DEBUG]   ⚠️  Z_SP ≤ θ by 24374.23 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 1732.36
  Lower Bound (LB) = 17130.73
  Gap (UB-LB) = 8975.8620, Absolute Gap = 8975.8620, Relative Gap = 0.343816
  Not converged yet (gap = 8975.86 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 34 increases, 26 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135257 nonzeros
Model fingerprint: 0xd1583a27
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 1732.36 (0.02s)
MIP start from previous solve produced solution with objective 1732.36 (0.02s)
Loaded MIP start from previous solve with objective 1732.36

Presolve removed 19715 rows and 8005 columns
Presolve time: 0.41s
Presolved: 27538 rows, 12975 columns, 169514 nonzeros
Variable types: 10716 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...

Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 4.778322e+04, 17705 iterations, 3.92 seconds (7.82 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 47783.2244    0  198 1732.35951 47783.2244  2658%     -    4s
H    0     0                    10352.674396 47783.2244   362%     -    4s
H    0     0                    11182.117376 47783.2244   327%     -    4s
H    0     0                    11309.797835 47783.2244   322%     -    4s
H    0     0                    11512.262596 47783.2244   315%     -    4s
H    0     0                    11978.937998 47783.2244   299%     -    4s
H    0     0                    12358.569844 47783.2244   287%     -    4s
H    0     0                    12429.863913 47783.2244   284%     -    4s
H    0     0                    13727.769860 47783.2244   248%     -    5s
H    0     0                    14848.066294 47783.2244   222%     -    5s
     0     0 42593.2261    0  163 14848.0663 42593.2261   187%     -    6s
H    0     0                    14861.230755 42593.1762   187%     -    6s
     0     0 42328.1122    0  254 14861.2308 42328.1122   185%     -    6s
     0     0 42328.1122    0  214 14861.2308 42328.1122   185%     -    7s
     0     0 40082.0905    0  278 14861.2308 40082.0905   170%     -    8s
H    0     0                    22226.473375 40079.7983  80.3%     -    8s
H    0     0                    22654.675883 40079.7983  76.9%     -    8s
H    0     0                    22679.810465 40079.7983  76.7%     -    8s
H    0     0                    22745.161014 40079.7983  76.2%     -    8s
H    0     0                    22747.693329 40079.7983  76.2%     -    8s
H    0     0                    22762.059797 40079.7983  76.1%     -    8s
H    0     0                    22774.650382 40079.7983  76.0%     -    8s
H    0     0                    22775.955408 40079.7983  76.0%     -    8s
H    0     0                    22790.274505 40079.7983  75.9%     -    8s
     0     0 39756.1377    0  279 22790.2745 39756.1377  74.4%     -    9s
     0     0 39667.0866    0  244 22790.2745 39667.0866  74.1%     -    9s
     0     0 39627.4647    0  297 22790.2745 39627.4647  73.9%     -    9s
     0     0 39617.8371    0  291 22790.2745 39617.8371  73.8%     -    9s
     0     0 39616.5094    0  299 22790.2745 39616.5094  73.8%     -    9s
     0     0 39615.4733    0  313 22790.2745 39615.4733  73.8%     -    9s
     0     0 39615.4276    0  313 22790.2745 39615.4276  73.8%     -    9s
     0     0 38039.1331    0  316 22790.2745 38039.1331  66.9%     -   11s
H    0     0                    24966.538588 38038.5377  52.4%     -   12s
     0     0 37527.6954    0  329 24966.5386 37527.6954  50.3%     -   12s
     0     0 37365.3091    0  328 24966.5386 37365.3091  49.7%     -   13s
     0     0 37277.8294    0  323 24966.5386 37277.8294  49.3%     -   13s
     0     0 37250.3862    0  377 24966.5386 37250.3862  49.2%     -   13s
     0     0 37241.3476    0  334 24966.5386 37241.3476  49.2%     -   13s
     0     0 37230.4692    0  381 24966.5386 37230.4692  49.1%     -   13s
     0     0 37227.2303    0  383 24966.5386 37227.2303  49.1%     -   14s
     0     0 37221.6602    0  386 24966.5386 37221.6602  49.1%     -   14s
     0     0 37220.7375    0  385 24966.5386 37220.7375  49.1%     -   14s
     0     0 35999.7109    0  372 24966.5386 35999.7109  44.2%     -   16s
     0     0 35374.2470    0  424 24966.5386 35374.2470  41.7%     -   17s
     0     0 35116.5765    0  433 24966.5386 35116.5765  40.7%     -   19s
     0     0 35057.0703    0  450 24966.5386 35057.0703  40.4%     -   19s
     0     0 35016.0381    0  451 24966.5386 35016.0381  40.3%     -   20s
     0     0 34996.4838    0  453 24966.5386 34996.4838  40.2%     -   20s
     0     0 34994.5918    0  452 24966.5386 34994.5918  40.2%     -   20s
     0     0 34993.9204    0  454 24966.5386 34993.9204  40.2%     -   20s
     0     0 34736.8285    0  420 24966.5386 34736.8285  39.1%     -   21s
H    0     0                    24994.927938 34736.4141  39.0%     -   21s
H    0     0                    25045.908265 34736.4141  38.7%     -   21s
     0     0 34654.3503    0  414 25045.9083 34654.3503  38.4%     -   22s
     0     0 34633.8638    0  419 25045.9083 34633.8638  38.3%     -   22s
     0     0 34625.7646    0  418 25045.9083 34625.7646  38.2%     -   22s
     0     0 34623.3055    0  422 25045.9083 34623.3055  38.2%     -   22s
     0     0 34617.7082    0  413 25045.9083 34617.7082  38.2%     -   22s
     0     0 34616.7410    0  414 25045.9083 34616.7410  38.2%     -   22s
     0     0 34541.8844    0  461 25045.9083 34541.8844  37.9%     -   23s
H    0     0                    25051.199092 34541.7848  37.9%     -   24s
     0     0 34514.0159    0  431 25051.1991 34514.0159  37.8%     -   24s
     0     0 34501.9186    0  427 25051.1991 34501.9186  37.7%     -   24s
     0     0 34497.8586    0  434 25051.1991 34497.8586  37.7%     -   24s
     0     0 34496.3892    0  437 25051.1991 34496.3892  37.7%     -   24s
     0     0 34425.6467    0  482 25051.1991 34425.6467  37.4%     -   25s
     0     0 34410.5704    0  487 25051.1991 34410.5704  37.4%     -   26s
     0     0 34404.9224    0  491 25051.1991 34404.9224  37.3%     -   26s
     0     0 34403.9094    0  491 25051.1991 34403.9094  37.3%     -   26s
     0     0 34351.4108    0  440 25051.1991 34351.4108  37.1%     -   27s
     0     0 34335.7140    0  448 25051.1991 34335.7140  37.1%     -   28s
     0     0 34330.3054    0  489 25051.1991 34330.3054  37.0%     -   28s
     0     0 34326.1022    0  481 25051.1991 34326.1022  37.0%     -   28s
     0     0 34324.8113    0  489 25051.1991 34324.8113  37.0%     -   28s
     0     0 34306.0312    0  488 25051.1991 34306.0312  36.9%     -   29s
     0     0 34291.7835    0  494 25051.1991 34291.7835  36.9%     -   30s
     0     0 34287.7435    0  495 25051.1991 34287.7435  36.9%     -   30s
     0     0 34284.0777    0  455 25051.1991 34284.0777  36.9%     -   30s
     0     0 34282.3615    0  459 25051.1991 34282.3615  36.8%     -   30s
     0     0 34270.0717    0  458 25051.1991 34270.0717  36.8%     -   31s
H    0     0                    25080.029548 34269.9554  36.6%     -   31s
     0     0 34256.6906    0  449 25080.0295 34256.6906  36.6%     -   31s
     0     0 34251.7552    0  443 25080.0295 34251.7552  36.6%     -   31s
     0     0 34246.3336    0  453 25080.0295 34246.3336  36.5%     -   32s
     0     0 34243.2400    0  450 25080.0295 34243.2400  36.5%     -   32s
     0     0 34242.6409    0  454 25080.0295 34242.6409  36.5%     -   32s
     0     0 34214.2128    0  504 25080.0295 34214.2128  36.4%     -   33s
     0     0 34201.4192    0  516 25080.0295 34201.4192  36.4%     -   33s
     0     0 34195.1133    0  515 25080.0295 34195.1133  36.3%     -   33s
     0     0 34188.7080    0  505 25080.0295 34188.7080  36.3%     -   33s
     0     0 34187.3937    0  502 25080.0295 34187.3937  36.3%     -   33s
     0     0 34126.8727    0  456 25080.0295 34126.8727  36.1%     -   34s
     0     0 34102.4210    0  468 25080.0295 34102.4210  36.0%     -   35s
     0     0 34091.8964    0  454 25080.0295 34091.8964  35.9%     -   35s
     0     0 34085.8670    0  473 25080.0295 34085.8670  35.9%     -   35s
     0     0 34084.5187    0  466 25080.0295 34084.5187  35.9%     -   35s
     0     0 34047.5269    0  471 25080.0295 34047.5269  35.8%     -   36s
     0     0 34042.7909    0  476 25080.0295 34042.7909  35.7%     -   37s
     0     0 34041.4341    0  468 25080.0295 34041.4341  35.7%     -   37s
     0     0 33999.7548    0  456 25080.0295 33999.7548  35.6%     -   37s
     0     0 33987.3603    0  463 25080.0295 33987.3603  35.5%     -   38s
     0     0 33980.1930    0  469 25080.0295 33980.1930  35.5%     -   38s
     0     0 33977.1694    0  462 25080.0295 33977.1694  35.5%     -   38s
     0     0 33975.9660    0  457 25080.0295 33975.9660  35.5%     -   38s
     0     0 33967.6174    0  481 25080.0295 33967.6174  35.4%     -   39s
     0     0 33964.4896    0  477 25080.0295 33964.4896  35.4%     -   39s
     0     0 33964.2525    0  480 25080.0295 33964.2525  35.4%     -   39s
     0     0 33962.0180    0  474 25080.0295 33962.0180  35.4%     -   39s
     0     0 33961.4114    0  480 25080.0295 33961.4114  35.4%     -   39s
     0     0 33959.4141    0  484 25080.0295 33959.4141  35.4%     -   40s
     0     0 33958.0952    0  483 25080.0295 33958.0952  35.4%     -   40s
     0     0 33952.4342    0  474 25080.0295 33952.4342  35.4%     -   40s
     0     0 33952.1897    0  474 25080.0295 33952.1897  35.4%     -   41s
H    0     0                    25244.197066 33952.1897  34.5%     -   46s
H    0     0                    25245.374508 33952.1897  34.5%     -   46s
H    0     0                    25273.054224 33952.1897  34.3%     -   47s
H    0     0                    25274.208884 33952.1897  34.3%     -   47s
H    0     0                    25279.306772 33952.1897  34.3%     -   47s
H    0     0                    25290.655542 33952.1897  34.2%     -   47s
H    0     0                    25291.217213 33952.1897  34.2%     -   47s
     0     2 33952.1897    0  474 25291.2172 33952.1897  34.2%     -   48s
     1     4 33437.3864    1  447 25291.2172 33951.6408  34.2%  2000   50s
    15    32 32952.2659    4  475 25291.2172 33186.9207  31.2%  3026   55s
    63    96 32646.7016    6  527 25291.2172 32778.2488  29.6%  2796   60s
H  151   190                    25307.121076 32778.2488  29.5%  1631   62s
   273   293 32198.5576    9  520 25307.1211 32778.2488  29.5%  1340   65s
   389   359 31772.3721   10  517 25307.1211 32641.3429  29.0%  1547   71s
   488   423 31295.2053   11  438 25307.1211 31989.3103  26.4%  1779   78s
   544   470 31181.6259   12  434 25307.1211 31850.8360  25.9%  1834   81s
   671   544 30212.4174   14  398 25307.1211 31850.8360  25.9%  1821   86s
H  758   575                    25315.202031 31850.8360  25.8%  1864   89s
   783   599 28496.9337   16  367 25315.2020 31850.8360  25.8%  1867   91s
   894   663 28026.5120   17  437 25315.2020 31770.3863  25.5%  1880   97s
   974   690     cutoff   17      25315.2020 31763.6852  25.5%  1847  100s
  1104   713 26530.2813   21  350 25315.2020 31662.0273  25.1%  1857  106s
  1272   769 25510.4793   22  309 25315.2020 31662.0273  25.1%  1866  112s
  1360   789     cutoff   23      25315.2020 31662.0273  25.1%  1857  115s
  1513   808 27229.1867   11  275 25315.2020 31427.3153  24.1%  1840  121s
  1713   844 infeasible   13      25315.2020 31349.7916  23.8%  1826  127s
  1812   873 27488.3540   13  250 25315.2020 31349.7916  23.8%  1832  131s
  2026   908     cutoff   18      25315.2020 30617.0672  20.9%  1832  138s
  2149   940 25950.4505   13  286 25315.2020 30591.9582  20.8%  1820  141s
  2341   998     cutoff   14      25315.2020 30354.3392  19.9%  1789  147s
  2492   987 28170.8858    9  503 25315.2020 30354.3392  19.9%  1753  151s
  2675   982 27293.2390   12  396 25315.2020 30300.8605  19.7%  1719  155s
  2821   994 26673.6893   15  415 25315.2020 30211.0164  19.3%  1719  161s
  2934  1032     cutoff   18      25315.2020 30095.8986  18.9%  1731  168s
  2996  1046 29004.6135    8  335 25315.2020 30095.8986  18.9%  1727  172s
  3100  1058 27398.3244   11  204 25315.2020 30065.2766  18.8%  1720  176s
  3236  1050 26397.7224   13  403 25315.2020 30028.4926  18.6%  1707  180s
  3402  1074     cutoff   11      25315.2020 30023.5989  18.6%  1700  185s
  3794  1104 26372.3957   13  360 25315.2020 29664.0980  17.2%  1679  194s
  4005  1112 26768.7646   12  215 25315.2020 29592.8514  16.9%  1670  199s
  4275  1134     cutoff   19      25315.2020 29592.8514  16.9%  1647  205s
  4813  1122     cutoff   15      25315.2020 29047.8122  14.7%  1619  214s
  5132  1110     cutoff   13      25315.2020 29026.4681  14.7%  1598  219s
  5394  1107 25796.1984   17  264 25315.2020 28748.0537  13.6%  1583  225s
  5719  1071     cutoff   14      25315.2020 28620.5912  13.1%  1565  230s
  6041  1031 25801.2636   18  180 25315.2020 28440.8505  12.3%  1554  236s
  6381   974 26382.5665   15  369 25315.2020 28368.4539  12.1%  1546  241s
  6717   880 25940.4810   17  489 25315.2020 28086.6092  10.9%  1530  247s
  7114   569     cutoff   13      25315.2020 27679.3864  9.34%  1509  253s
  7714   223     cutoff   13      25315.2020 27198.5192  7.44%  1457  258s
  8299    57 25691.0054   15  348 25315.2020 26805.8045  5.89%  1401  262s
* 8965     0              33    25319.032202 25837.5918  2.05%  1313  263s

Cutting planes:
  Learned: 1
  Implied bound: 4
  MIR: 385
  Flow cover: 848
  RLT: 20
  Relax-and-lift: 78

Explored 9208 nodes (11855676 simplex iterations) in 263.12 seconds (836.61 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 25319 25315.2 25307.1 ... 25051.2

Optimal solution found (tolerance 1.00e-04)
Best objective 2.531903220207e+04, best bound 2.531903220207e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 263.15s
  Master Objective (UB) = 25319.03, θ = 148454.49
  Upper Bound (UB) = 25319.03

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 148454.49
  [DEBUG]   ✓ Scenario 0: θ = 148454.49 ≤ Q = 148454.49 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 148454.49 ≤ Q = 148454.49 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 148454.49 ≤ Q = 148454.49 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x101fcd01
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xefe032ff
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [7e-18, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [8e-14, 2e+02]
Found heuristic solution: objective 1.455662e+13
Presolve removed 2571 rows and 1864 columns
Presolve time: 0.00s
Presolved: 522 rows, 525 columns, 1472 nonzeros
Found heuristic solution: objective 7550957.8626
Variable types: 355 continuous, 170 integer (170 binary)

Root relaxation: objective -1.482328e+05, 259 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -148232.82    0  136 7550957.86 -148232.82   102%     -    0s
H    0     0                    -108166.5552 -148232.82  37.0%     -    0s
H    0     0                    -108937.6774 -148232.82  36.1%     -    0s
H    0     0                    -124477.5137 -148232.82  19.1%     -    0s
H    0     0                    -124881.0552 -147606.68  18.2%     -    0s
H    0     0                    -127700.1210 -137509.76  7.68%     -    0s
     0     0 -137509.76    0   81 -127700.12 -137509.76  7.68%     -    0s
H    0     0                    -134283.7147 -137396.86  2.32%     -    0s
H    0     0                    -134586.7533 -137396.86  2.09%     -    0s
H    0     0                    -135137.0193 -137396.86  1.67%     -    0s
H    0     0                    -135440.0580 -137396.86  1.44%     -    0s
     0     0 -136493.40    0   82 -135440.06 -136493.40  0.78%     -    0s
     0     0 -136003.81    0   43 -135440.06 -136003.81  0.42%     -    0s
H    0     0                    -135507.8442 -135893.86  0.28%     -    0s
     0     0 -135893.86    0   37 -135507.84 -135893.86  0.28%     -    0s
     0     0 -135855.70    0   33 -135507.84 -135855.70  0.26%     -    0s
H    0     0                    -135566.0070 -135834.48  0.20%     -    0s
     0     0 -135834.48    0   35 -135566.01 -135834.48  0.20%     -    0s
     0     0 -135830.04    0   35 -135566.01 -135830.04  0.19%     -    0s
     0     0 -135721.15    0   13 -135566.01 -135721.15  0.11%     -    0s
     0     0 -135721.15    0   14 -135601.21 -135721.15  0.09%     -    0s
H    0     0                    -135614.1530 -135721.15  0.08%     -    0s
     0     0 -135676.85    0    2 -135614.15 -135676.85  0.05%     -    0s
H    0     0                    -135675.7835 -135676.61  0.00%     -    0s

Cutting planes:
  Gomory: 4
  Implied bound: 1
  MIR: 3
  Flow cover: 5
  Relax-and-lift: 2

Explored 1 nodes (874 simplex iterations) in 0.05 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -135676 -135614 -135601 ... -124478

Optimal solution found (tolerance 1.00e-04)
Best objective -1.356757834601e+05, best bound -1.356766050220e+05, gap 0.0006%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 124103.08
  Scenario: 36 demand increases, 24 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -135675.78
  [DEBUG]   S×d_nominal = 259778.86
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 259778.86 + -135675.78 = 124103.08
  [DEBUG]   Current θ from Master = 148454.49
  [DEBUG]   ⚠️  Z_SP ≤ θ by 24351.42 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 967.62
  Lower Bound (LB) = 17130.73
  Gap (UB-LB) = 8188.3004, Absolute Gap = 8188.3004, Relative Gap = 0.323405
  Not converged yet (gap = 8188.30 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 36 increases, 24 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178503 nonzeros
Model fingerprint: 0xecb710f3
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 966.795 (0.03s)
Loaded MIP start from previous solve with objective 966.795

Presolve removed 26280 rows and 10670 columns
Presolve time: 0.55s
Presolved: 36263 rows, 16550 columns, 224199 nonzeros
Variable types: 14291 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 36263 rows, 16550 columns, 224199 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   47079    2.8613438e+04   0.000000e+00   9.333203e+07      5s
Concurrent spin time: 0.05s

Solved with dual simplex

Root relaxation: objective 4.721761e+04, 24375 iterations, 6.88 seconds (13.93 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 47217.6073    0  201  966.79531 47217.6073  4784%     -    7s
H    0     0                    21406.198960 47217.6073   121%     -    7s
H    0     0                    21689.442306 47217.6073   118%     -    7s
H    0     0                    21828.492703 47217.6073   116%     -    7s
H    0     0                    22731.004166 47217.6073   108%     -    8s
     0     0 42014.9688    0  242 22731.0042 42014.9688  84.8%     -   11s
H    0     0                    23015.745147 42014.4094  82.5%     -   12s
H    0     0                    23342.411992 42014.4094  80.0%     -   12s
H    0     0                    23531.378031 42014.4094  78.5%     -   12s
H    0     0                    23553.860676 42014.4094  78.4%     -   12s
H    0     0                    23611.830656 42014.4094  77.9%     -   12s
H    0     0                    23611.838953 42014.4094  77.9%     -   12s
     0     0 41804.5164    0  250 23611.8390 41804.5164  77.0%     -   12s
     0     0 41741.0042    0  245 23611.8390 41741.0042  76.8%     -   13s
     0     0 41731.8431    0  250 23611.8390 41731.8431  76.7%     -   13s
     0     0 41731.4851    0  250 23611.8390 41731.4851  76.7%     -   13s
     0     0 39214.0355    0  292 23611.8390 39214.0355  66.1%     -   17s
H    0     0                    24191.878370 39214.0355  62.1%     -   17s
H    0     0                    24198.208925 39214.0355  62.1%     -   17s
H    0     0                    24298.985201 39214.0355  61.4%     -   17s
H    0     0                    24356.456297 39214.0355  61.0%     -   17s
H    0     0                    24359.975060 39214.0355  61.0%     -   17s
     0     0 38850.3764    0  350 24359.9751 38850.3764  59.5%     -   19s
     0     0 38730.3953    0  396 24359.9751 38730.3953  59.0%     -   20s
     0     0 38696.5835    0  393 24359.9751 38696.5835  58.9%     -   20s
     0     0 38693.0736    0  401 24359.9751 38693.0736  58.8%     -   20s
     0     0 38685.3994    0  353 24359.9751 38685.3994  58.8%     -   21s
     0     0 38684.8547    0  359 24359.9751 38684.8547  58.8%     -   21s
     0     0 36991.0995    0  395 24359.9751 36991.0995  51.9%     -   26s
H    0     0                    24609.331545 36594.7712  48.7%     -   28s
     0     0 36594.7712    0  359 24609.3315 36594.7712  48.7%     -   29s
     0     0 36368.4046    0  420 24609.3315 36368.4046  47.8%     -   30s
     0     0 36242.5561    0  413 24609.3315 36242.5561  47.3%     -   31s
     0     0 36195.9074    0  413 24609.3315 36195.9074  47.1%     -   32s
     0     0 36174.5653    0  420 24609.3315 36174.5653  47.0%     -   32s
     0     0 36164.8265    0  421 24609.3315 36164.8265  47.0%     -   32s
     0     0 36163.1503    0  419 24609.3315 36163.1503  46.9%     -   32s
     0     0 36162.2009    0  419 24609.3315 36162.2009  46.9%     -   33s
     0     0 35510.6287    0  408 24609.3315 35510.6287  44.3%     -   38s
     0     0 35081.1290    0  400 24609.3315 35081.1290  42.6%     -   41s
     0     0 34878.3635    0  414 24609.3315 34878.3635  41.7%     -   42s
     0     0 34771.0059    0  471 24609.3315 34771.0059  41.3%     -   43s
     0     0 34740.0095    0  415 24609.3315 34740.0095  41.2%     -   43s
     0     0 34699.2193    0  418 24609.3315 34699.2193  41.0%     -   44s
     0     0 34680.4202    0  415 24609.3315 34680.4202  40.9%     -   45s
     0     0 34653.4766    0  417 24609.3315 34653.4766  40.8%     -   45s
     0     0 34640.3353    0  413 24609.3315 34640.3353  40.8%     -   46s
     0     0 34636.0349    0  412 24609.3315 34636.0349  40.7%     -   46s
     0     0 34634.5921    0  416 24609.3315 34634.5921  40.7%     -   46s
     0     0 34498.3055    0  422 24609.3315 34498.3055  40.2%     -   48s
H    0     0                    24646.012277 34497.6963  40.0%     -   48s
     0     0 34428.8941    0  434 24646.0123 34428.8941  39.7%     -   49s
     0     0 34401.7939    0  433 24646.0123 34401.7939  39.6%     -   49s
     0     0 34380.7970    0  497 24646.0123 34380.7970  39.5%     -   51s
     0     0 34365.5760    0  442 24646.0123 34365.5760  39.4%     -   51s
     0     0 34358.4532    0  443 24646.0123 34358.4532  39.4%     -   51s
     0     0 34356.1385    0  438 24646.0123 34356.1385  39.4%     -   51s
     0     0 34354.3912    0  441 24646.0123 34354.3912  39.4%     -   52s
     0     0 34349.3973    0  445 24646.0123 34349.3973  39.4%     -   52s
     0     0 34348.4087    0  447 24646.0123 34348.4087  39.4%     -   52s
     0     0 34279.4734    0  436 24646.0123 34279.4734  39.1%     -   54s
     0     0 34255.9035    0  442 24646.0123 34255.9035  39.0%     -   55s
     0     0 34248.1433    0  436 24646.0123 34248.1433  39.0%     -   55s
     0     0 34244.5575    0  440 24646.0123 34244.5575  38.9%     -   55s
     0     0 34244.2985    0  440 24646.0123 34244.2985  38.9%     -   55s
     0     0 34224.8751    0  449 24646.0123 34224.8751  38.9%     -   57s
     0     0 34191.4144    0  447 24646.0123 34191.4144  38.7%     -   57s
     0     0 34182.1869    0  450 24646.0123 34182.1869  38.7%     -   58s
     0     0 34180.9003    0  451 24646.0123 34180.9003  38.7%     -   58s
     0     0 34147.1197    0  443 24646.0123 34147.1197  38.6%     -   59s
     0     0 34138.4773    0  449 24646.0123 34138.4773  38.5%     -   60s
     0     0 34134.0839    0  453 24646.0123 34134.0839  38.5%     -   60s
     0     0 34132.6517    0  457 24646.0123 34132.6517  38.5%     -   61s
     0     0 34125.7462    0  455 24646.0123 34125.7462  38.5%     -   61s
     0     0 34123.2122    0  463 24646.0123 34123.2122  38.5%     -   62s
     0     0 34122.4875    0  457 24646.0123 34122.4875  38.5%     -   62s
     0     0 34112.9123    0  454 24646.0123 34112.9123  38.4%     -   63s
H    0     0                    24651.809935 34112.8706  38.4%     -   63s
     0     0 34109.7498    0  460 24651.8099 34109.7498  38.4%     -   64s
     0     0 34108.5652    0  462 24651.8099 34108.5652  38.4%     -   64s
     0     0 34104.2713    0  452 24651.8099 34104.2713  38.3%     -   65s
     0     0 34102.6968    0  453 24651.8099 34102.6968  38.3%     -   65s
     0     0 34088.8408    0  447 24651.8099 34088.8408  38.3%     -   66s
     0     0 34088.8343    0  447 24651.8099 34088.8343  38.3%     -   66s
H    0     0                    24744.434122 34088.8343  37.8%     -   75s
H    0     0                    24766.045655 34088.8343  37.6%     -   75s
H    0     2                    24770.400416 34088.8343  37.6%     -   81s
     0     2 34088.8343    0  447 24770.4004 34088.8343  37.6%     -   81s
     3     8 33697.5294    2  427 24770.4004 33804.5031  36.5%  2565   86s
     7    16 33397.2147    3  435 24770.4004 33695.7427  36.0%  2726   91s
    15    32 33341.1378    4  431 24770.4004 33396.8417  34.8%  3665   95s
    31    48 30893.5660    5  412 24770.4004 33353.2221  34.6%  4706  104s
    47    80 31202.4327    6  401 24770.4004 33353.2221  34.6%  6141  108s
H   49    80                    24773.658599 33353.2221  34.6%  5980  108s
H   50    80                    24801.536536 33353.2221  34.5%  5918  108s
    79   112 31178.4390    7  396 24801.5365 33353.2221  34.5%  4369  111s
H   80   112                    24843.985963 33353.2221  34.3%  4314  111s
   111   248 31086.7515    8  390 24843.9860 33353.2221  34.3%  3483  116s
   333   351 31011.7090   12  400 24843.9860 33353.2221  34.3%  1786  124s
   403   380 30719.2550   11  380 24843.9860 33353.2221  34.3%  1701  130s
   517   437 26821.7266   13  295 24843.9860 33353.2221  34.3%  1727  141s
   579   467     cutoff   22      24843.9860 33353.2221  34.3%  1710  147s
   638   507     cutoff   14      24843.9860 33353.2221  34.3%  1682  153s
   711   547     cutoff   14      24843.9860 33353.2221  34.3%  1628  159s
   796   595 28039.2737   18  432 24843.9860 33353.2221  34.3%  1577  164s
   879   643 27882.3154   19  386 24843.9860 33353.2221  34.3%  1533  167s
   965   693 27319.2197   21  280 24843.9860 33340.6131  34.2%  1471  171s
  1053   721 26934.1766   25  388 24843.9860 32767.3398  31.9%  1440  175s
  1115   749 26666.0250   26  259 24843.9860 32767.3398  31.9%  1428  182s
  1185   769 25978.0687   27  323 24843.9860 32767.3398  31.9%  1418  186s
  1245   818 25857.6973   28  304 24843.9860 32767.3398  31.9%  1423  191s
  1316   868 25528.5255   32  291 24843.9860 32767.3398  31.9%  1434  196s
  1415   908 infeasible   37      24843.9860 32767.3398  31.9%  1409  202s
  1517   939 27223.6804   11  389 24843.9860 32767.3398  31.9%  1401  208s
  1625   986     cutoff   12      24843.9860 32767.3398  31.9%  1398  212s
  1730  1010 30880.4303   12  473 24843.9860 32327.9732  30.1%  1397  217s
  1780  1065 30472.2410   13  414 24843.9860 32327.9732  30.1%  1405  222s
  1861  1098 30031.1098   14  381 24843.9860 32327.9732  30.1%  1393  227s
  1954  1144 29820.5078   16  371 24843.9860 31283.5023  25.9%  1375  234s
  2061  1206 29384.9312   19  368 24843.9860 31283.5023  25.9%  1381  241s
  2191  1255 26736.2473   23  171 24843.9860 31283.5023  25.9%  1373  247s
  2344  1296 infeasible   34      24843.9860 31027.6450  24.9%  1353  252s
  2467  1332 25987.6553    7  369 24843.9860 31027.6450  24.9%  1336  259s
  2603  1355     cutoff    9      24843.9860 31027.6450  24.9%  1329  267s
  2777  1383     cutoff   10      24843.9860 30853.2937  24.2%  1316  272s
  2925  1437 29418.9396    7  384 24843.9860 30705.8636  23.6%  1311  280s
  3075  1489 25764.9920   10  277 24843.9860 30623.0083  23.3%  1330  287s
  3227  1504 25622.5187   11  325 24843.9860 30623.0083  23.3%  1335  293s
  3293  1523 27856.1808   12  415 24843.9860 30623.0083  23.3%  1337  300s
  3432  1578     cutoff   15      24843.9860 30623.0083  23.3%  1338  306s
  3569  1604     cutoff   14      24843.9860 30623.0083  23.3%  1342  313s
  3731  1636     cutoff   10      24843.9860 30266.4496  21.8%  1342  322s
  3891  1695 27325.1199   11  169 24843.9860 30253.2146  21.8%  1349  329s
  4093  1777 29016.8079   12  335 24843.9860 30218.3634  21.6%  1345  335s
  4288  1874 27318.6285   14  284 24843.9860 30131.7450  21.3%  1346  343s
  4539  1911     cutoff   16      24843.9860 30116.5468  21.2%  1335  353s
  4771  1962 29261.5257    9  396 24843.9860 30028.4348  20.9%  1341  361s
  4932  2044 27508.6163   12  266 24843.9860 29911.9625  20.4%  1337  369s
  5142  2106 26519.9318   17  351 24843.9860 29874.9578  20.3%  1344  381s
  5419  2213     cutoff   23      24843.9860 29850.1254  20.2%  1339  389s
  5729  2275 27595.8725   14  331 24843.9860 29777.1959  19.9%  1326  399s
  6074  2384 25080.2594   19  286 24843.9860 29713.4277  19.6%  1316  408s
  6324  2385 26989.3346   11  447 24843.9860 29609.7495  19.2%  1308  427s
  6326  2386 28007.2350   15  201 24843.9860 29609.7495  19.2%  1308  438s
  6327  2387 25691.5454   24  388 24843.9860 29609.7495  19.2%  1308  445s
  6328  2388 26716.6984   17  407 24843.9860 29609.7495  19.2%  1308  450s
  6330  2389 25738.6351   26  451 24843.9860 29609.7495  19.2%  1307  456s
  6332  2390 29037.1453   11  479 24843.9860 29609.7495  19.2%  1307  461s
  6335  2392 27211.0640   13  502 24843.9860 29609.7495  19.2%  1306  466s
  6337  2394 25531.3270   32  491 24843.9860 29609.7495  19.2%  1306  470s
  6342  2397 28054.0656   12  509 24843.9860 29609.7495  19.2%  1305  477s
  6345  2399 27171.1668   16  513 24843.9860 29609.7495  19.2%  1304  481s
  6347  2400 25333.5458   30  581 24843.9860 29609.7495  19.2%  1304  486s
  6349  2402 26243.7060   15  628 24843.9860 29609.7495  19.2%  1303  491s
  6351  2403 28319.7366   13  587 24843.9860 29609.7495  19.2%  1303  495s
  6352  2404 25378.7287   21  587 24843.9860 29609.7495  19.2%  1303  507s
  6353  2404 25255.6898   37  587 24843.9860 29609.7495  19.2%  1302  514s
  6354  2408 29609.7495   14  568 24843.9860 29609.7495  19.2%  1318  518s
  6356  2411 29609.7495   15  571 24843.9860 29609.7495  19.2%  1319  526s
  6360  2418 29609.7495   16  551 24843.9860 29609.7495  19.2%  1319  530s
  6368  2431 29609.7495   17  572 24843.9860 29609.7495  19.2%  1323  540s
  6384  2445 27068.0811   18  176 24843.9860 29609.7495  19.2%  1329  551s
  6403  2467 29609.7495   19  483 24843.9860 29609.7495  19.2%  1353  556s
  6435  2517 29217.4724   20  516 24843.9860 29609.7495  19.2%  1355  562s
  6538  2498 28497.7452   22  504 24843.9860 29609.7495  19.2%  1358  570s
  6625  2485 26923.9972   21  419 24843.9860 29609.7495  19.2%  1360  575s
  6666  2485 28257.1839   23  429 24843.9860 29609.7495  19.2%  1364  583s
  6722  2481 26664.3813   25  324 24843.9860 29609.7495  19.2%  1368  590s
  6781  2485 25353.9301   26  468 24843.9860 29609.7495  19.2%  1372  596s
  6843  2478 25954.6616   26  309 24843.9860 29609.7495  19.2%  1373  602s
  6914  2476     cutoff   27      24843.9860 29609.7495  19.2%  1375  610s
  6982  2461 26468.4791   23  272 24843.9860 29609.7495  19.2%  1376  616s
  7027  2450 26362.1727   24  271 24843.9860 29609.7495  19.2%  1381  623s
  7103  2447 25893.2454   24  304 24843.9860 29609.7495  19.2%  1382  631s
  7164  2425     cutoff   27      24843.9860 29609.7495  19.2%  1391  637s
  7239  2415     cutoff   25      24843.9860 29609.7495  19.2%  1393  642s
  7283  2406 29609.7495   20  519 24843.9860 29609.7495  19.2%  1397  647s
  7336  2401 29536.1776   21  493 24843.9860 29609.7495  19.2%  1400  651s
  7436  2391 29062.2382   23  448 24843.9860 29609.7495  19.2%  1404  659s
  7482  2388 27748.7343   24  445 24843.9860 29609.7495  19.2%  1407  664s
  7528  2387 26904.1947   25  441 24843.9860 29609.7495  19.2%  1414  669s
  7575  2380 26576.5775   26  434 24843.9860 29609.7495  19.2%  1414  674s
  7634  2363 25610.3430   27  417 24843.9860 29609.7495  19.2%  1417  680s
  7725  2335 25218.9255   28  444 24843.9860 29535.6817  18.9%  1416  687s
  7806  2308     cutoff   30      24843.9860 29479.4536  18.7%  1420  692s
  7893  2283 25086.0866   24  223 24843.9860 29109.3255  17.2%  1425  700s
  7999  2260 24969.4004   25  220 24843.9860 28509.8628  14.8%  1427  705s
  8106  2228 25873.4847   24  452 24843.9860 28509.8628  14.8%  1430  713s
  8264  2134 infeasible   27      24843.9860 27768.5102  11.8%  1425  720s
  8412  2084 25946.0688   22  302 24843.9860 27717.2220  11.6%  1425  727s
  8580  2003     cutoff   24      24843.9860 27540.3734  10.9%  1418  734s
  8743  1913 24938.9427   30  207 24843.9860 27473.3044  10.6%  1415  741s
  8935  1784 25386.4917   21  418 24843.9860 26870.7314  8.16%  1408  748s
  9164  1623     cutoff   21      24843.9860 26730.4067  7.59%  1397  755s
  9594  1338 25331.3223   26  366 24843.9860 26336.9615  6.01%  1363  765s
  9716  1285 24911.0766   29   16 24843.9860 24915.0737  0.29%  1351  770s

Cutting planes:
  Learned: 1
  MIR: 271
  Flow cover: 875
  RLT: 16
  Relax-and-lift: 136

Explored 9762 nodes (13236264 simplex iterations) in 770.13 seconds (2150.61 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 24844 24801.5 24773.7 ... 24360

Optimal solution found (tolerance 1.00e-04)
Best objective 2.484398596303e+04, best bound 2.484398596303e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 770.13s
  Master Objective (UB) = 24843.99, θ = 147589.16
  Upper Bound (UB) = 24843.99

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 147589.16
  [DEBUG]   ✓ Scenario 0: θ = 147589.16 ≤ Q = 147589.16 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 147589.16 ≤ Q = 147605.49 (slack: 16.33)
  [DEBUG]   ✓ Scenario 2: θ = 147589.16 ≤ Q = 147589.16 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 147589.16 ≤ Q = 147589.16 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x327784ec
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x327784ec
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.472381e+13
Presolve removed 2571 rows and 1864 columns
Presolve time: 0.00s
Presolved: 522 rows, 525 columns, 1472 nonzeros
Found heuristic solution: objective 7688694.6556
Variable types: 355 continuous, 170 integer (170 binary)

Root relaxation: objective -1.440162e+05, 263 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -144016.23    0  135 7688694.66 -144016.23   102%     -    0s
H    0     0                    -107023.7809 -144016.23  34.6%     -    0s
H    0     0                    -107511.2252 -144016.23  34.0%     -    0s
H    0     0                    -120606.2550 -144016.23  19.4%     -    0s
     0     0 -133916.94    0   92 -120606.26 -133916.94  11.0%     -    0s
H    0     0                    -131002.3705 -133909.63  2.22%     -    0s
     0     0 -133619.26    0   85 -131002.37 -133619.26  2.00%     -    0s
H    0     0                    -131597.4423 -133619.26  1.54%     -    0s
     0     0 -132924.55    0   73 -131597.44 -132924.55  1.01%     -    0s
H    0     0                    -131845.8425 -132836.13  0.75%     -    0s
     0     0 -132717.43    0   45 -131845.84 -132717.43  0.66%     -    0s
     0     0 -132717.43    0   67 -131845.84 -132717.43  0.66%     -    0s
     0     0 -132582.34    0   46 -131845.84 -132582.34  0.56%     -    0s
     0     0 -132531.82    0   26 -131845.84 -132531.82  0.52%     -    0s
H    0     0                    -131879.0729 -132530.12  0.49%     -    0s
     0     0 -132349.53    0   23 -131879.07 -132349.53  0.36%     -    0s
     0     0 -132349.34    0   23 -131879.07 -132349.34  0.36%     -    0s
     0     0 -132156.81    0   20 -131879.07 -132156.81  0.21%     -    0s
     0     0 -132126.99    0   21 -131879.07 -132126.99  0.19%     -    0s
     0     0 -131975.53    0    9 -131879.07 -131975.53  0.07%     -    0s
     0     0 -131967.30    0   15 -131879.07 -131967.30  0.07%     -    0s
     0     0          -    0      -131879.07 -131890.27  0.01%     -    0s

Cutting planes:
  Gomory: 6
  Implied bound: 6
  MIR: 4
  Flow cover: 7
  Relax-and-lift: 4

Explored 1 nodes (907 simplex iterations) in 0.09 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -131879 -131846 -131759 ... 1.47238e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.318790729264e+05, best bound -1.318902697317e+05, gap 0.0085%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 127078.33
  Scenario: 41 demand increases, 19 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -131879.07
  [DEBUG]   S×d_nominal = 258957.41
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 258957.41 + -131879.07 = 127078.33
  [DEBUG]   Current θ from Master = 147589.16
  [DEBUG]   ⚠️  Z_SP ≤ θ by 20510.82 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 4333.16
  Lower Bound (LB) = 17130.73
  Gap (UB-LB) = 7713.2541, Absolute Gap = 7713.2541, Relative Gap = 0.310468
  Not converged yet (gap = 7713.25 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 41 increases, 19 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221749 nonzeros
Model fingerprint: 0x58cb8bf0
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 32865 rows and 13345 columns
Presolve time: 0.68s
Presolved: 44968 rows, 20115 columns, 278824 nonzeros
Variable types: 17856 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -366999.6780
Found heuristic solution: objective -181250.9741

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 44968 rows, 20115 columns, 278824 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   30785    3.3323749e+04   0.000000e+00   4.793881e+07      5s
   46196    4.5075340e+04   0.000000e+00   7.167415e+05     10s
Concurrent spin time: 1.38s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 4.692402e+04, 34072 iterations, 12.56 seconds (25.70 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 46924.0189    0  204 -181250.97 46924.0189   126%     -   13s
H    0     0                    -162793.1173 46924.0189   129%     -   13s
H    0     0                    -49307.68638 46924.0189   195%     -   13s
H    0     0                    -44482.29676 46924.0189   205%     -   13s
H    0     0                    -44087.01580 46924.0189   206%     -   13s
H    0     0                    -32123.67507 46924.0189   246%     -   13s
H    0     0                    -10520.58219 46924.0189   546%     -   13s
H    0     0                    -3939.228132 46924.0189  1291%     -   13s
H    0     0                    -2410.777567 46924.0189  2046%     -   13s
H    0     0                    2881.7962163 46924.0189  1528%     -   13s
H    0     0                    2906.5529672 46924.0189  1514%     -   13s
H    0     0                    3764.6260420 46924.0189  1146%     -   14s
H    0     0                    3776.1251868 46924.0189  1143%     -   14s
     0     0 41401.4833    0  228 3776.12519 41401.4833   996%     -   20s
H    0     0                    4417.2839301 41401.4833   837%     -   20s
H    0     0                    8286.6999039 41401.4833   400%     -   20s
H    0     0                    8452.5951929 41401.4833   390%     -   20s
     0     0 41367.4206    0  206 8452.59519 41367.4206   389%     -   23s
     0     0 41367.4206    0  199 8452.59519 41367.4206   389%     -   23s
     0     0 41367.4206    0  204 8452.59519 41367.4206   389%     -   23s
     0     0 41367.4206    0  204 8452.59519 41367.4206   389%     -   23s
H    0     0                    21306.671727 39547.3334  85.6%     -   28s
H    0     0                    22122.834732 39547.3334  78.8%     -   28s
H    0     0                    22159.566749 39547.3334  78.5%     -   28s
H    0     0                    23313.991831 39547.3334  69.6%     -   28s
H    0     0                    23319.066856 39547.3334  69.6%     -   28s
     0     0 39542.8634    0  235 23319.0669 39542.8634  69.6%     -   28s
H    0     0                    23509.081436 39542.8634  68.2%     -   28s
H    0     0                    23642.449463 39542.8634  67.3%     -   28s
     0     0 39180.6577    0  291 23642.4495 39180.6577  65.7%     -   30s
     0     0 39001.4743    0  352 23642.4495 39001.4743  65.0%     -   31s
     0     0 38932.5206    0  305 23642.4495 38932.5206  64.7%     -   32s
     0     0 38612.2742    0  303 23642.4495 38612.2742  63.3%     -   34s
     0     0 38599.2878    0  311 23642.4495 38599.2878  63.3%     -   34s
     0     0 38552.4918    0  312 23642.4495 38552.4918  63.1%     -   35s
     0     0 38548.0222    0  321 23642.4495 38548.0222  63.0%     -   35s
     0     0 38546.1159    0  321 23642.4495 38546.1159  63.0%     -   35s
     0     0 38546.1148    0  321 23642.4495 38546.1148  63.0%     -   36s
     0     0 36588.6562    0  338 23642.4495 36588.6562  54.8%     -   43s
     0     0 36304.8439    0  361 23642.4495 36304.8439  53.6%     -   45s
     0     0 35880.2409    0  364 23642.4495 35880.2409  51.8%     -   47s
     0     0 35531.7970    0  423 23642.4495 35531.7970  50.3%     -   49s
     0     0 35424.5439    0  374 23642.4495 35424.5439  49.8%     -   50s
     0     0 35378.5354    0  381 23642.4495 35378.5354  49.6%     -   52s
     0     0 35341.8445    0  389 23642.4495 35341.8445  49.5%     -   52s
     0     0 35309.2570    0  392 23642.4495 35309.2570  49.3%     -   53s
     0     0 35304.8856    0  396 23642.4495 35304.8856  49.3%     -   53s
     0     0 35303.8307    0  395 23642.4495 35303.8307  49.3%     -   54s
     0     0 34470.0059    0  455 23642.4495 34470.0059  45.8%     -   61s
H    0     0                    23668.654167 34468.4098  45.6%     -   61s
H    0     0                    23680.448703 34468.4098  45.6%     -   61s
H    0     0                    23722.415823 34468.4098  45.3%     -   61s
H    0     0                    23755.029387 34468.4098  45.1%     -   61s
     0     0 34175.0713    0  459 23755.0294 34175.0713  43.9%     -   63s
     0     0 34012.5511    0  469 23755.0294 34012.5511  43.2%     -   65s
     0     0 33958.6605    0  486 23755.0294 33958.6605  43.0%     -   66s
     0     0 33912.5144    0  480 23755.0294 33912.5144  42.8%     -   67s
     0     0 33879.0026    0  484 23755.0294 33879.0026  42.6%     -   68s
     0     0 33860.5489    0  485 23755.0294 33860.5489  42.5%     -   68s
     0     0 33852.4153    0  486 23755.0294 33852.4153  42.5%     -   68s
     0     0 33849.4007    0  489 23755.0294 33849.4007  42.5%     -   69s
     0     0 33845.1880    0  483 23755.0294 33845.1880  42.5%     -   69s
     0     0 33844.9617    0  486 23755.0294 33844.9617  42.5%     -   69s
     0     0 33670.3291    0  488 23755.0294 33670.3291  41.7%     -   72s
     0     0 33639.9638    0  492 23755.0294 33639.9638  41.6%     -   73s
     0     0 33601.2460    0  487 23755.0294 33601.2460  41.4%     -   74s
     0     0 33592.3885    0  504 23755.0294 33592.3885  41.4%     -   75s
     0     0 33587.8594    0  509 23755.0294 33587.8594  41.4%     -   75s
     0     0 33583.9826    0  503 23755.0294 33583.9826  41.4%     -   75s
     0     0 33581.6503    0  449 23755.0294 33581.6503  41.4%     -   75s
     0     0 33579.8149    0  506 23755.0294 33579.8149  41.4%     -   76s
     0     0 33579.5993    0  504 23755.0294 33579.5993  41.4%     -   76s
     0     0 33506.4008    0  436 23755.0294 33506.4008  41.0%     -   78s
     0     0 33491.2394    0  493 23755.0294 33491.2394  41.0%     -   80s
     0     0 33472.3378    0  493 23755.0294 33472.3378  40.9%     -   81s
     0     0 33470.1957    0  496 23755.0294 33470.1957  40.9%     -   81s
     0     0 33469.8043    0  492 23755.0294 33469.8043  40.9%     -   81s
     0     0 33445.7116    0  487 23755.0294 33445.7116  40.8%     -   83s
     0     0 33436.8919    0  501 23755.0294 33436.8919  40.8%     -   84s
     0     0 33427.4848    0  507 23755.0294 33427.4848  40.7%     -   84s
     0     0 33422.7875    0  504 23755.0294 33422.7875  40.7%     -   85s
     0     0 33422.0602    0  512 23755.0294 33422.0602  40.7%     -   85s
     0     0 33401.3461    0  507 23755.0294 33401.3461  40.6%     -   86s
H    0     0                    23786.918011 33401.3347  40.4%     -   86s
     0     0 33399.0016    0  513 23786.9180 33399.0016  40.4%     -   87s
     0     0 33396.2346    0  508 23786.9180 33396.2346  40.4%     -   87s
     0     0 33393.4939    0  504 23786.9180 33393.4939  40.4%     -   87s
     0     0 33392.6669    0  504 23786.9180 33392.6669  40.4%     -   88s
     0     0 33389.0209    0  507 23786.9180 33389.0209  40.4%     -   88s
     0     0 33379.3881    0  441 23786.9180 33379.3881  40.3%     -   89s
     0     0 33373.2507    0  508 23786.9180 33373.2507  40.3%     -   90s
     0     0 33371.8322    0  511 23786.9180 33371.8322  40.3%     -   90s
     0     0 33364.2784    0  511 23786.9180 33364.2784  40.3%     -   91s
H    0     0                    23789.082024 33363.3856  40.2%     -   91s
H    0     0                    23801.839133 33363.3856  40.2%     -   91s
H    0     0                    23826.526615 33363.3856  40.0%     -   91s
     0     0 33361.0896    0  517 23826.5266 33361.0896  40.0%     -   92s
     0     0 33360.6053    0  516 23826.5266 33360.6053  40.0%     -   92s
     0     0 33358.0580    0  511 23826.5266 33358.0580  40.0%     -   93s
     0     0 33357.3080    0  517 23826.5266 33357.3080  40.0%     -   93s
     0     0 33356.0167    0  514 23826.5266 33356.0167  40.0%     -   94s
H    0     0                    23828.531783 33355.5920  40.0%     -   94s
     0     0 33355.5202    0  519 23828.5318 33355.5202  40.0%     -   94s
     0     0 33344.7870    0  511 23828.5318 33344.7870  39.9%     -   96s
     0     0 33343.9953    0  511 23828.5318 33343.9953  39.9%     -   97s
     0     2 33343.9090    0  511 23828.5318 33343.9090  39.9%     -  109s
     1     4 33116.9935    1  486 23828.5318 33343.9090  39.9%  3935  113s
     3     8 33067.5731    2  476 23828.5318 33116.1272  39.0%  4239  116s
     7    16 32624.9878    3  493 23828.5318 33067.0538  38.8%  3800  121s
    15    32 32342.0922    4  502 23828.5318 32660.3746  37.1%  5381  128s
    31    48 31998.8454    5  426 23828.5318 32483.7841  36.3%  6566  140s
    47    80 31519.0542    6  524 23828.5318 32483.7841  36.3%  6257  145s
H   48    80                    23868.910247 32483.7841  36.1%  6127  145s
    79   145 31343.9734    7  510 23868.9102 32483.7841  36.1%  5352  160s
   144   291 31016.8481    9  461 23868.9102 32483.7841  36.1%  4349  166s
H  226   291                    23876.229414 32483.7841  36.1%  3183  166s
   392   456 30871.9241   12  458 23876.2294 32483.7841  36.1%  2392  173s
   463   509 30873.1267   13  490 23876.2294 32483.7841  36.1%  2274  180s
   590   603 30480.9881   13  433 23876.2294 32483.7841  36.1%  2168  189s
   661   658 30612.4003   15  439 23876.2294 32483.7841  36.1%  2088  196s
   743   711 29216.0932   15  406 23876.2294 32342.0722  35.5%  2000  201s
   828   727 29535.6921   14  269 23876.2294 32328.1346  35.4%  1948  207s
   871   753 30324.2076   14  485 23876.2294 32328.1346  35.4%  1944  212s
   917   775 28453.1004   16  366 23876.2294 32328.1346  35.4%  1973  219s
   955   804 29639.5559   17  495 23876.2294 32328.1346  35.4%  1984  224s
  1002   827 28934.1534   16  398 23876.2294 32328.1346  35.4%  1973  229s
  1039   848 29623.3228   18  490 23876.2294 32328.1346  35.4%  1972  235s
  1082   898 28393.0014   17  359 23876.2294 32328.1346  35.4%  1971  242s
  1144   925 29389.2880   19  497 23876.2294 32328.1346  35.4%  1933  247s
  1213   965 29137.2367   20  507 23876.2294 32104.8592  34.5%  1898  253s
  1277  1000 28876.4152   20  423 23876.2294 31986.2609  34.0%  1897  259s
  1331  1071 29045.3349   21  502 23876.2294 31986.2609  34.0%  1899  263s
  1410  1127 28773.3490   22  486 23876.2294 31986.2609  34.0%  1878  270s
  1516  1198 27768.6686   22  457 23876.2294 31986.2609  34.0%  1836  276s
  1617  1277 28859.8611   21  433 23876.2294 31986.2609  34.0%  1818  282s
  1731  1342 26373.5036   21  326 23876.2294 31986.2609  34.0%  1781  288s
  1846  1391 28622.2372   23  451 23876.2294 31903.6684  33.6%  1762  296s
  1955  1477 27253.9501   23  230 23876.2294 31584.0332  32.3%  1767  304s
  2079  1569 28300.0420   24  377 23876.2294 31442.4761  31.7%  1744  311s
  2236  1671 26787.2835   25  223 23876.2294 31442.4761  31.7%  1717  317s
  2409  1786 25703.2224   27  235 23876.2294 31244.9687  30.9%  1688  325s
  2571  1894 25859.1556   31  219 23876.2294 31239.3388  30.8%  1670  331s
  2734  1998 25056.8808   34  244 23876.2294 31179.7915  30.6%  1654  339s
  2888  2101     cutoff   36      23876.2294 31179.7915  30.6%  1651  348s
  3087  2220 28410.4722   16  324 23876.2294 31179.7915  30.6%  1635  356s
  3294  2295 27115.6739   19  398 23876.2294 30991.5105  29.8%  1620  364s
  3473  2354 25338.5769   21  360 23876.2294 30991.5105  29.8%  1620  373s
  3663  2421 24240.8532   23  237 23876.2294 30982.9815  29.8%  1619  381s
  3905  2492 29757.5139   14  434 23876.2294 30974.7769  29.7%  1604  389s
  4072  2537 26684.4796   18  285 23876.2294 30942.7079  29.6%  1619  396s
  4173  2628     cutoff   20      23876.2294 30942.7079  29.6%  1632  406s
  4338  2729 28364.8312   19  366 23876.2294 30942.7079  29.6%  1646  417s
H 4546  2728                    23938.962837 30942.7079  29.3%  1651  449s
  4547  2729 25674.5235   29  511 23938.9628 30942.7079  29.3%  1651  525s
  4549  2730 25864.0580   45  204 23938.9628 30942.7079  29.3%  1650  545s
  4550  2731 28947.4232    9  435 23938.9628 30942.7079  29.3%  1649  561s
  4551  2732 25254.0737   29  340 23938.9628 30942.7079  29.3%  1649  571s
  4552  2732 27021.6004   27  410 23938.9628 30942.7079  29.3%  1649  576s
  4554  2734 24981.4560   34  475 23938.9628 30942.7079  29.3%  1648  584s
  4555  2734 27561.0470   14  489 23938.9628 30942.7079  29.3%  1648  589s
  4556  2735 28421.8004   15  503 23938.9628 30942.7079  29.3%  1647  591s
  4558  2736 28318.6859   11  507 23938.9628 30942.7079  29.3%  1647  596s
  4560  2738 27325.5790   19  517 23938.9628 30942.7079  29.3%  1646  600s
  4561  2738 24687.5272   29  440 23938.9628 30942.7079  29.3%  1646  605s
  4565  2741 30551.8521   11  521 23938.9628 30942.7079  29.3%  1644  610s
  4568  2743 26026.6163   23  512 23938.9628 30942.7079  29.3%  1643  616s
  4570  2744 25886.0710   30  518 23938.9628 30942.7079  29.3%  1642  620s
  4572  2746 26676.5071   15  526 23938.9628 30942.7079  29.3%  1642  626s
  4575  2748 25746.7912   19  525 23938.9628 30942.7079  29.3%  1640  631s
  4576  2748 25599.2214   31  528 23938.9628 30942.7079  29.3%  1640  635s
  4579  2750 26702.9235   23  583 23938.9628 30942.7079  29.3%  1639  642s
  4581  2752 24852.2797   18  473 23938.9628 30942.7079  29.3%  1638  645s
  4583  2753 28639.0620    9  464 23938.9628 30942.7079  29.3%  1638  650s
  4584  2754 26125.0769   26  575 23938.9628 30942.7079  29.3%  1637  655s
  4587  2756 25872.7326   15  580 23938.9628 30942.7079  29.3%  1636  661s
  4588  2756 24890.4573   25  580 23938.9628 30942.7079  29.3%  1636  680s
  4589  2757 30589.6219   13  580 23938.9628 30942.7079  29.3%  1635  692s
  4590  2761 30942.7079   16  610 23938.9628 30942.7079  29.3%  1678  704s
  4592  2764 30942.7079   17  518 23938.9628 30942.7079  29.3%  1680  710s
  4596  2771 30942.7079   18  526 23938.9628 30942.7079  29.3%  1682  723s
  4604  2784 30942.7079   19  527 23938.9628 30942.7079  29.3%  1688  733s
  4620  2797 29461.2191   20  428 23938.9628 30942.7079  29.3%  1727  782s
  4638  2819 30696.9064   21  335 23938.9628 30942.7079  29.3%  1743  794s
  4670  2898 30409.9323   22  320 23938.9628 30942.7079  29.3%  1776  804s
  4781  2885 27633.9084   24  287 23938.9628 30942.7079  29.3%  1807  816s
H 4797  2741                    23997.830180 30942.7079  28.9%  1812  816s
  4818  2774 27660.0929   24  355 23997.8302 30942.7079  28.9%  1819  825s
  4906  2764 25525.0109   24  299 23997.8302 30942.7079  28.9%  1850  833s
  4945  2760 26696.7094   25  305 23997.8302 30942.7079  28.9%  1855  839s
  4998  2755     cutoff   25      23997.8302 30942.7079  28.9%  1880  850s
  5053  2744 26259.5143   26  262 23997.8302 30942.7079  28.9%  1897  861s
  5111  2753 27434.6157   25  279 23997.8302 30942.7079  28.9%  1923  870s
  5171  2756 25731.7816   28  237 23997.8302 30942.7079  28.9%  1947  879s
  5255  2734 24850.2144   30  271 23997.8302 30942.7079  28.9%  1957  887s
  5335  2729 24682.8014   29  235 23997.8302 30942.7079  28.9%  1969  895s
  5408  2719     cutoff   30      23997.8302 30942.7079  28.9%  1989  903s
  5487  2714     cutoff   32      23997.8302 30942.7079  28.9%  2016  911s
  5558  2719     cutoff   31      23997.8302 30772.8616  28.2%  2036  920s
  5620  2714 29002.9266   22  352 23997.8302 30772.8616  28.2%  2064  928s
  5671  2722 28841.3156   23  277 23997.8302 30772.8616  28.2%  2082  934s
  5707  2740 27525.8089   24  228 23997.8302 30772.8616  28.2%  2093  943s
  5768  2753     cutoff   25      23997.8302 30772.8616  28.2%  2097  953s
  5842  2743 26690.6253   25  297 23997.8302 30538.9745  27.3%  2114  962s
  5936  2721 26617.0767   26  291 23997.8302 30538.9745  27.3%  2132  972s
  6038  2731 26564.0191   27  286 23997.8302 30538.9745  27.3%  2151  980s
  6123  2733 25960.9584   29  317 23997.8302 30211.9195  25.9%  2169  989s
  6253  2708 25477.7618   31  365 23997.8302 29353.2709  22.3%  2188  997s
  6365  2697 24325.6785   33  312 23997.8302 29353.2709  22.3%  2208 1011s
  6484  2690     cutoff   36      23997.8302 29158.9674  21.5%  2222 1022s
  6599  2665 25679.9847   30  264 23997.8302 28687.7639  19.5%  2253 1029s
  6648  2658     cutoff   31      23997.8302 28619.4584  19.3%  2257 1039s
  6696  2657 25203.4744   31  198 23997.8302 28571.6516  19.1%  2271 1047s
  6741  2653 24795.8088   31  221 23997.8302 28286.5930  17.9%  2276 1057s
  6793  2642 25040.0149   32  381 23997.8302 28286.5930  17.9%  2285 1067s
  6848  2631 24598.3753   33  384 23997.8302 28286.5930  17.9%  2289 1076s
  6932  2609 24324.6402   33  301 23997.8302 28153.6738  17.3%  2306 1089s
  7032  2572     cutoff   32      23997.8302 28153.6738  17.3%  2314 1101s
  7124  2562 24125.2558   35  319 23997.8302 27725.4016  15.5%  2329 1116s
  7285  2510     cutoff   23      23997.8302 27623.7519  15.1%  2345 1130s
  7483  2457 24242.6616   28   92 23997.8302 27494.0736  14.6%  2350 1144s
  7679  2410 25445.6714   27  249 23997.8302 27433.5602  14.3%  2376 1157s
  7895  2344 24093.1952   31  317 23997.8302 27189.6678  13.3%  2387 1171s
  8105  2286 24540.7003   32  221 23997.8302 26951.8956  12.3%  2394 1183s
  8370  2167 24987.6199   32  377 23997.8302 26908.1786  12.1%  2389 1198s
  8631  2020     cutoff   25      23997.8302 26685.1833  11.2%  2396 1212s
  8933  1889     cutoff   32      23997.8302 26411.4400  10.1%  2404 1226s
  9253  1753 24262.0359   33  370 23997.8302 26411.4400  10.1%  2400 1242s
  9556  1575 24372.7578   29  213 23997.8302 26006.5846  8.37%  2392 1255s
  9951  1261     cutoff   30      23997.8302 25697.6323  7.08%  2368 1272s
 10451   923     cutoff   33      23997.8302 25298.4853  5.42%  2324 1287s
 10969   581 24047.3404   27  346 23997.8302 25013.4067  4.23%  2267 1298s
 11730   238     cutoff   32      23997.8302 24575.6069  2.41%  2149 1300s

Cutting planes:
  MIR: 386
  Mixing: 1
  Flow cover: 1263
  RLT: 25
  Relax-and-lift: 145

Explored 11918 nodes (25398307 simplex iterations) in 1300.58 seconds (3609.72 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 23997.8 23939 23876.2 ... 23755

Optimal solution found (tolerance 1.00e-04)
Best objective 2.399783018035e+04, best bound 2.399783018035e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1300.62s
  Master Objective (UB) = 23997.83, θ = 152822.61
  Upper Bound (UB) = 23997.83

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 152822.61
  [DEBUG]   ✓ Scenario 0: θ = 152822.61 ≤ Q = 152822.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 152822.61 ≤ Q = 152822.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 152822.61 ≤ Q = 152822.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 152822.61 ≤ Q = 152822.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 152822.61 ≤ Q = 152822.61 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x4e7fd646
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x4e7fd646
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.468726e+13
Presolve removed 2571 rows and 1864 columns
Presolve time: 0.00s
Presolved: 522 rows, 525 columns, 1472 nonzeros
Found heuristic solution: objective 7860432.8363
Variable types: 355 continuous, 170 integer (170 binary)

Root relaxation: objective -1.408491e+05, 260 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -140849.06    0  130 7860432.84 -140849.06   102%     -    0s
H    0     0                    -105225.0598 -140849.06  33.9%     -    0s
H    0     0                    -105537.8647 -140849.06  33.5%     -    0s
H    0     0                    -108753.7471 -140849.06  29.5%     -    0s
H    0     0                    -110699.2367 -122201.06  10.4%     -    0s
H    0     0                    -114529.2679 -122201.06  6.70%     -    0s
     0     0 -122201.06    0   76 -114529.27 -122201.06  6.70%     -    0s
H    0     0                    -119757.5051 -122091.28  1.95%     -    0s
     0     0 -121901.52    0   77 -119757.51 -121901.52  1.79%     -    0s
H    0     0                    -120473.7568 -121901.52  1.19%     -    0s
     0     0 -121105.23    0   63 -120473.76 -121105.23  0.52%     -    0s
     0     0 -121060.53    0   63 -120473.76 -121060.53  0.49%     -    0s
     0     0 -121045.80    0   62 -120473.76 -121045.80  0.47%     -    0s
     0     0 -121044.36    0   62 -120473.76 -121044.36  0.47%     -    0s
     0     0 -120756.60    0   17 -120473.76 -120756.60  0.23%     -    0s
H    0     0                    -120499.0142 -120742.06  0.20%     -    0s
     0     0 -120575.09    0   19 -120499.01 -120575.09  0.06%     -    0s
     0     0 -120546.84    0   16 -120499.01 -120546.84  0.04%     -    0s
     0     0 -120546.14    0    9 -120499.01 -120546.14  0.04%     -    0s
     0     0          -    0      -120499.01 -120503.76  0.00%     -    0s

Cutting planes:
  Gomory: 25
  Implied bound: 6
  MIR: 99
  Flow cover: 8
  RLT: 79
  Relax-and-lift: 2
  BQP: 1

Explored 1 nodes (683 simplex iterations) in 0.04 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -120499 -120474 -114529 ... 1.46873e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.204990141676e+05, best bound -1.205037596579e+05, gap 0.0039%
  Subproblem solved in 0.06s
  Worst-case operational profit (Z_SP) = 138057.42
  Scenario: 30 demand increases, 30 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -120499.01
  [DEBUG]   S×d_nominal = 258556.44
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 258556.44 + -120499.01 = 138057.42
  [DEBUG]   Current θ from Master = 152822.61
  [DEBUG]   ⚠️  Z_SP ≤ θ by 14765.18 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 9232.65
  Lower Bound (LB) = 17130.73
  Gap (UB-LB) = 6867.0983, Absolute Gap = 6867.0983, Relative Gap = 0.286155
  Not converged yet (gap = 6867.10 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 30 increases, 30 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 264995 nonzeros
Model fingerprint: 0x13832bc2
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 39430 rows and 16010 columns
Presolve time: 0.82s
Presolved: 53693 rows, 23690 columns, 333509 nonzeros
Variable types: 21431 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -366999.6780
Found heuristic solution: objective -181250.9741

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 53693 rows, 23690 columns, 333509 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   34517    1.5632983e+04   0.000000e+00   8.883110e+06      5s
   49451    3.2340939e+04   0.000000e+00   4.857109e+05     10s
   60977    4.0730707e+04   0.000000e+00   7.508121e+06     15s
Concurrent spin time: 0.71s

Solved with dual simplex

Root relaxation: objective 4.687712e+04, 39063 iterations, 14.23 seconds (29.77 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 46877.1166    0  203 -181250.97 46877.1166   126%     -   15s
H    0     0                    -168853.9488 46877.1166   128%     -   15s
H    0     0                    -131056.4782 46877.1166   136%     -   15s
H    0     0                    -127362.2981 46877.1166   137%     -   15s
H    0     0                    -127295.5364 46877.1166   137%     -   15s
H    0     0                    -31668.03796 46877.1166   248%     -   15s
H    0     0                    -25691.23405 46877.1166   282%     -   15s
H    0     0                    -25007.13695 46877.1166   287%     -   15s
H    0     0                    -17889.91919 46877.1166   362%     -   16s
H    0     0                    8337.5876072 46877.1166   462%     -   16s
H    0     0                    9374.6396919 42252.2755   351%     -   23s
H    0     0                    9505.7377167 42252.2755   344%     -   23s
     0     0 42252.2755    0  194 9505.73772 42252.2755   344%     -   23s
     0     0 41199.2593    0  248 9505.73772 41199.2593   333%     -   27s
     0     0 41199.2593    0  247 9505.73772 41199.2593   333%     -   29s
     0     0 41199.2593    0  252 9505.73772 41199.2593   333%     -   29s
     0     0 41199.2593    0  252 9505.73772 41199.2593   333%     -   30s
     0     0 38481.4643    0  384 9505.73772 38481.4643   305%     -   38s
     0     0 38121.9332    0  341 9505.73772 38121.9332   301%     -   42s
H    0     0                    10507.432865 37956.1677   261%     -   45s
H    0     0                    10561.967725 37956.1677   259%     -   45s
H    0     0                    10563.657721 37956.1677   259%     -   45s
H    0     0                    10646.009871 37956.1677   257%     -   45s
H    0     0                    11007.354010 37956.1677   245%     -   45s
H    0     0                    11509.487923 37956.1677   230%     -   45s
H    0     0                    11513.067409 37956.1677   230%     -   45s
     0     0 37956.1677    0  396 11513.0674 37956.1677   230%     -   45s
     0     0 37833.8593    0  356 11513.0674 37833.8593   229%     -   48s
     0     0 37809.9815    0  406 11513.0674 37809.9815   228%     -   48s
     0     0 37806.4280    0  408 11513.0674 37806.4280   228%     -   49s
     0     0 37779.3280    0  405 11513.0674 37779.3280   228%     -   49s
     0     0 37759.7281    0  404 11513.0674 37759.7281   228%     -   50s
     0     0 37757.4858    0  411 11513.0674 37757.4858   228%     -   50s
     0     0 37731.8802    0  410 11513.0674 37731.8802   228%     -   51s
     0     0 37730.4617    0  416 11513.0674 37730.4617   228%     -   51s
     0     0 37726.4333    0  419 11513.0674 37726.4333   228%     -   51s
     0     0 37726.0262    0  421 11513.0674 37726.0262   228%     -   51s
     0     0 36461.4306    0  299 11513.0674 36461.4306   217%     -   62s
H    0     0                    11565.551503 35873.7710   210%     -   69s
H    0     0                    12295.235953 35873.7710   192%     -   69s
H    0     0                    17776.141064 35873.7710   102%     -   69s
H    0     0                    18280.865746 35873.7710  96.2%     -   69s
H    0     0                    18970.455665 35873.7710  89.1%     -   69s
     0     0 35873.7710    0  362 18970.4557 35873.7710  89.1%     -   69s
H    0     0                    19147.407286 35705.9007  86.5%     -   71s
H    0     0                    19359.855245 35705.9007  84.4%     -   71s
     0     0 35705.9007    0  369 19359.8552 35705.9007  84.4%     -   71s
     0     0 35573.5281    0  334 19359.8552 35573.5281  83.7%     -   74s
     0     0 35376.7848    0  336 19359.8552 35376.7848  82.7%     -   76s
     0     0 35286.4190    0  388 19359.8552 35286.4190  82.3%     -   78s
     0     0 35269.3641    0  388 19359.8552 35269.3641  82.2%     -   79s
     0     0 35259.2061    0  394 19359.8552 35259.2061  82.1%     -   80s
     0     0 35253.1530    0  393 19359.8552 35253.1530  82.1%     -   81s
     0     0 35251.0391    0  401 19359.8552 35251.0391  82.1%     -   81s
     0     0 35250.7621    0  403 19359.8552 35250.7621  82.1%     -   81s
     0     0 34440.9872    0  372 19359.8552 34440.9872  77.9%     -   90s
     0     0 34161.6717    0  431 19359.8552 34161.6717  76.5%     -   93s
H    0     0                    19877.476361 34102.8870  71.6%     -   95s
H    0     0                    19928.834462 34102.8870  71.1%     -   95s
H    0     0                    20052.908060 34102.8870  70.1%     -   95s
     0     0 34102.8870    0  419 20052.9081 34102.8870  70.1%     -   95s
     0     0 34087.3055    0  381 20052.9081 34087.3055  70.0%     -   96s
     0     0 34048.1372    0  430 20052.9081 34048.1372  69.8%     -   98s
     0     0 34032.1215    0  381 20052.9081 34032.1215  69.7%     -   99s
     0     0 34026.4039    0  378 20052.9081 34026.4039  69.7%     -  100s
     0     0 34025.7341    0  378 20052.9081 34025.7341  69.7%     -  100s
     0     0 33855.0020    0  444 20052.9081 33855.0020  68.8%     -  104s
     0     0 33755.7361    0  446 20052.9081 33755.7361  68.3%     -  107s
     0     0 33742.5441    0  452 20052.9081 33742.5441  68.3%     -  109s
     0     0 33727.9003    0  455 20052.9081 33727.9003  68.2%     -  110s
     0     0 33714.3574    0  512 20052.9081 33714.3574  68.1%     -  111s
     0     0 33710.8677    0  517 20052.9081 33710.8677  68.1%     -  112s
     0     0 33704.8971    0  457 20052.9081 33704.8971  68.1%     -  112s
     0     0 33700.0571    0  515 20052.9081 33700.0571  68.1%     -  113s
     0     0 33698.8641    0  456 20052.9081 33698.8641  68.0%     -  113s
     0     0 33663.4178    0  516 20052.9081 33663.4178  67.9%     -  115s
     0     0 33643.0481    0  515 20052.9081 33643.0481  67.8%     -  118s
     0     0 33636.9671    0  523 20052.9081 33636.9671  67.7%     -  119s
     0     0 33636.1592    0  515 20052.9081 33636.1592  67.7%     -  119s
     0     0 33581.7599    0  501 20052.9081 33581.7599  67.5%     -  121s
     0     0 33559.5400    0  467 20052.9081 33559.5400  67.4%     -  123s
     0     0 33550.0819    0  465 20052.9081 33550.0819  67.3%     -  124s
     0     0 33545.4076    0  466 20052.9081 33545.4076  67.3%     -  124s
     0     0 33541.4559    0  516 20052.9081 33541.4559  67.3%     -  125s
     0     0 33540.1274    0  509 20052.9081 33540.1274  67.3%     -  125s
     0     0 33461.5511    0  572 20052.9081 33461.5511  66.9%     -  129s
H    0     0                    20200.648756 33461.3902  65.6%     -  131s
     0     0 33439.4166    0  519 20200.6488 33439.4166  65.5%     -  133s
     0     0 33431.6469    0  521 20200.6488 33431.6469  65.5%     -  134s
     0     0 33429.5237    0  519 20200.6488 33429.5237  65.5%     -  134s
     0     0 33427.8930    0  484 20200.6488 33427.8930  65.5%     -  135s
     0     0 33417.5324    0  577 20200.6488 33417.5324  65.4%     -  136s
     0     0 33410.1731    0  517 20200.6488 33410.1731  65.4%     -  137s
     0     0 33404.0212    0  554 20200.6488 33404.0212  65.4%     -  137s
     0     0 33402.9298    0  512 20200.6488 33402.9298  65.4%     -  137s
     0     0 33393.0391    0  500 20200.6488 33393.0391  65.3%     -  139s
     0     0 33391.2890    0  497 20200.6488 33391.2890  65.3%     -  139s
     0     0 33389.9321    0  498 20200.6488 33389.9321  65.3%     -  139s
     0     0 33388.0261    0  502 20200.6488 33388.0261  65.3%     -  140s
     0     0 33379.0839    0  508 20200.6488 33379.0839  65.2%     -  141s
     0     0 33376.5321    0  460 20200.6488 33376.5321  65.2%     -  142s
     0     0 33374.0712    0  464 20200.6488 33374.0712  65.2%     -  143s
     0     0 33372.7185    0  463 20200.6488 33372.7185  65.2%     -  143s
     0     0 33369.1864    0  469 20200.6488 33369.1864  65.2%     -  145s
     0     0 33364.6052    0  468 20200.6488 33364.6052  65.2%     -  145s
     0     0 33361.9396    0  529 20200.6488 33361.9396  65.2%     -  146s
     0     0 33360.5443    0  531 20200.6488 33360.5443  65.1%     -  146s
     0     0 33349.8998    0  554 20200.6488 33349.8998  65.1%     -  148s
H    0     0                    20235.864448 33348.4700  64.8%     -  148s
     0     0 33344.5301    0  514 20235.8644 33344.5301  64.8%     -  148s
     0     0 33343.7869    0  516 20235.8644 33343.7869  64.8%     -  149s
     0     0 33329.4142    0  462 20235.8644 33329.4142  64.7%     -  150s
H    0     0                    20354.268403 33326.2154  63.7%     -  151s
H    0     0                    20475.692554 33326.2154  62.8%     -  151s
H    0     0                    20515.528757 33326.2154  62.4%     -  151s
     0     0 33326.2154    0  465 20515.5288 33326.2154  62.4%     -  151s
     0     0 33324.5405    0  470 20515.5288 33324.5405  62.4%     -  151s
     0     0 33319.2857    0  474 20515.5288 33319.2857  62.4%     -  152s
H    0     0                    20580.240711 33319.0296  61.9%     -  152s
     0     0 33317.3505    0  481 20580.2407 33317.3505  61.9%     -  152s
     0     0 33314.7843    0  479 20580.2407 33314.7843  61.9%     -  153s
     0     0 33313.4483    0  483 20580.2407 33313.4483  61.9%     -  153s
     0     0 33312.4840    0  483 20580.2407 33312.4840  61.9%     -  154s
     0     0 33312.1426    0  484 20580.2407 33312.1426  61.9%     -  154s
     0     0 33312.1426    0  482 20580.2407 33312.1426  61.9%     -  155s
     0     0 33312.0106    0  482 20580.2407 33312.0106  61.9%     -  156s
H    0     0                    20583.884356 33311.9815  61.8%     -  177s
H    0     0                    22368.147514 33311.9815  48.9%     -  178s
H    0     0                    22755.675770 33311.9815  46.4%     -  178s
H    0     0                    22759.980742 33311.9815  46.4%     -  178s
H    0     0                    22925.141055 33311.9815  45.3%     -  178s
H    0     0                    22941.534252 33311.9815  45.2%     -  178s
     0     2 33311.9815    0  482 22941.5343 33311.9815  45.2%     -  178s
     1     4 33031.4841    1  451 22941.5343 33311.9815  45.2%  4240  185s
     7    16 32609.1872    3  565 22941.5343 32911.4816  43.5%  5322  195s
    15    32 32497.4524    4  502 22941.5343 32609.1272  42.1%  6535  204s
    31    48 32111.6601    5  493 22941.5343 32496.2440  41.6%  8896  220s
H   47    80                    23111.620877 32496.2440  40.6%  8301  228s
H   47    80                    23607.739296 32496.2440  37.7%  8301  228s
H   52    80                    23612.501744 32496.2440  37.6%  8057  228s
    79   209 31994.9341    7  547 23612.5017 32496.2440  37.6%  6154  238s
   208   241 31900.6134   10  409 23612.5017 32496.2440  37.6%  3034  240s
   240   275 31579.8627    9  515 23612.5017 32496.2440  37.6%  2796  245s
H  258   275                    23614.731420 32496.2440  37.6%  2670  245s
   274   351 31682.1044   10  479 23614.7314 32496.2440  37.6%  2644  253s
   356   429 31798.7974    8  475 23614.7314 32496.2440  37.6%  2525  260s
   444   498 31736.9956   11  482 23614.7314 32496.2440  37.6%  2365  265s
   536   557 30936.4183   11  296 23614.7314 32496.2440  37.6%  2173  271s
   634   597 31512.4487   10  519 23614.7314 32496.2440  37.6%  2016  277s
   724   613 31340.3942   10  510 23614.7314 32496.2440  37.6%  1896  284s
   806   638 31378.0846   11  457 23614.7314 32496.2440  37.6%  1859  292s
   863   666 31597.1384   12  469 23614.7314 32496.2440  37.6%  1905  298s
   919   709 30365.9730   12  241 23614.7314 32496.2440  37.6%  1963  306s
   985   736 27087.0052   12  215 23614.7314 32496.2440  37.6%  1991  314s
  1036   762 31568.4148   12  470 23614.7314 32496.2440  37.6%  2032  320s
H 1039   762                    23632.475239 32496.2440  37.5%  2031  320s
  1078   820 29304.1563   13  348 23632.4752 32496.2440  37.5%  2082  328s
  1158   882 28318.8849   13  321 23632.4752 32496.2440  37.5%  2059  336s
  1234   948 29242.0579   14  344 23632.4752 32496.2440  37.5%  2074  343s
  1320   995 27509.8234   16  385 23632.4752 32496.2440  37.5%  2066  350s
  1415  1011 26869.5365   16  323 23632.4752 31991.1727  35.4%  2055  358s
  1461  1034 27293.8038   17  380 23632.4752 31987.7841  35.4%  2087  366s
  1498  1053 27236.6580   18  384 23632.4752 31987.7841  35.4%  2127  374s
  1539  1081 27132.8853   19  325 23632.4752 31987.7841  35.4%  2153  382s
  1575  1125 26992.3796   20  264 23632.4752 31987.7841  35.4%  2188  389s
  1637  1153 26959.0344   21  312 23632.4752 31609.9319  33.8%  2187  397s
  1713  1187 26796.9066   23  376 23632.4752 31609.9319  33.8%  2180  405s
  1795  1237 26560.2014   27  317 23632.4752 31587.6584  33.7%  2182  414s
  1881  1281 26386.4485   30  318 23632.4752 31587.6584  33.7%  2181  423s
  1949  1337 26257.2310   31  317 23632.4752 31587.6584  33.7%  2224  433s
  2056  1412 26076.3286   33  430 23632.4752 31568.3625  33.6%  2233  442s
  2157  1503 25832.0453   37  377 23632.4752 31568.3625  33.6%  2234  453s
  2283  1578 25513.1449   43  315 23632.4752 31375.8087  32.8%  2220  463s
  2428  1661 25242.7442   48  295 23632.4752 31375.8087  32.8%  2202  473s
  2555  1759 25186.2530   50  248 23632.4752 31365.9441  32.7%  2211  484s
  2703  1814 24813.1611   58  196 23632.4752 31365.9441  32.7%  2202  497s
  2840  1851     cutoff   59      23632.4752 31365.9441  32.7%  2208  508s
  2923  1878 29069.3541   19  443 23632.4752 31160.6284  31.9%  2221  518s
  2960  1913 28785.9979   20  485 23632.4752 31160.6284  31.9%  2234  530s
  2998  1947 28101.8370   21  405 23632.4752 31160.6284  31.9%  2246  540s
  3060  1973 27790.7050   22  350 23632.4752 31160.6284  31.9%  2257  550s
  3143  2019 27279.4311   23  294 23632.4752 31099.3503  31.6%  2255  561s
  3226  2052 27044.0930   24  295 23632.4752 31099.3503  31.6%  2266  577s
  3337  2134 26743.4965   25  251 23632.4752 31099.3503  31.6%  2261  589s
  3483  2217 25620.0815   28  335 23632.4752 31075.7424  31.5%  2269  606s
  3654  2302 infeasible   15      23632.4752 30855.6750  30.6%  2265  621s
  3862  2457     cutoff   15      23632.4752 30855.6750  30.6%  2261  636s
  4115  2493 27351.1718   19  302 23632.4752 30788.6941  30.3%  2230  651s
  4308  2520 26568.2960   21  364 23632.4752 30788.6941  30.3%  2211  669s
  4484  2568 26509.3073   22  362 23632.4752 30552.3048  29.3%  2221  689s
  4634  2627 24118.6493   23  271 23632.4752 30378.8375  28.5%  2253  706s
  4823  2690 23846.1319   26  302 23632.4752 30378.8375  28.5%  2278  724s
  5099  2780 25891.0931   14  302 23632.4752 30266.0221  28.1%  2266  742s
  5370  2849 23821.7108   16  139 23632.4752 30186.5675  27.7%  2256  759s
  5553  2850 28842.7129   10  482 23632.4752 30184.7687  27.7%  2259  898s
  5555  2851 25379.2938   15  203 23632.4752 30184.7687  27.7%  2258  924s
  5556  2852 29446.7357   12  414 23632.4752 30184.7687  27.7%  2258  942s
  5557  2853 24710.8564   30  403 23632.4752 30184.7687  27.7%  2258  953s
  5558  2853 28703.6780    9  496 23632.4752 30184.7687  27.7%  2257  961s
  5560  2855 28701.3916   10  429 23632.4752 30184.7687  27.7%  2256  967s
  5561  2855 25037.0285   17  479 23632.4752 30184.7687  27.7%  2256  970s
  5563  2857 24448.4553   31  555 23632.4752 30184.7687  27.7%  2255  975s
  5566  2859 24170.1378   50  463 23632.4752 30184.7687  27.7%  2254  980s
  5568  2860 25037.0285   17  517 23632.4752 30184.7687  27.7%  2253  987s
  5570  2861 24962.8453   12  514 23632.4752 30184.7687  27.7%  2252  990s
  5572  2863 25169.0094   16  578 23632.4752 30184.7687  27.7%  2252  997s
  5574  2864 25156.1688   26  490 23632.4752 30184.7687  27.7%  2251 1002s
  5576  2865 24302.7097   29  537 23632.4752 30184.7687  27.7%  2250 1009s
  5577  2866 28004.8337   11  539 23632.4752 30184.7687  27.7%  2250 1011s
  5579  2867 26641.2268    8  528 23632.4752 30184.7687  27.7%  2249 1019s
  5580  2868 25562.5573   30  541 23632.4752 30184.7687  27.7%  2248 1022s
  5581  2869 25466.5434   26  593 23632.4752 30184.7687  27.7%  2248 1026s
  5583  2870 24478.5271   20  560 23632.4752 30184.7687  27.7%  2247 1031s
  5584  2871 27294.5806   10  565 23632.4752 30184.7687  27.7%  2247 1035s
  5586  2872 27393.8146   15  601 23632.4752 30184.7687  27.7%  2246 1040s
  5588  2873 26711.7266   10  603 23632.4752 30184.7687  27.7%  2245 1068s
  5589  2874 26701.8879   12  603 23632.4752 30184.7687  27.7%  2245 1081s
  5590  2878 30184.7687   13  588 23632.4752 30184.7687  27.7%  2282 1088s
  5592  2881 30184.7687   14  584 23632.4752 30184.7687  27.7%  2284 1098s
  5596  2888 30184.7687   15  582 23632.4752 30184.7687  27.7%  2286 1108s
  5604  2901 30184.7687   16  589 23632.4752 30184.7687  27.7%  2295 1123s
  5620  2912 30184.7687   17  511 23632.4752 30184.7687  27.7%  2310 1144s
  5636  2938 29120.0598   18  463 23632.4752 30184.7687  27.7%  2352 1153s
  5668  3018 27560.7972   19  452 23632.4752 30184.7687  27.7%  2367 1167s
  5775  3035 27192.2527   21  438 23632.4752 30184.7687  27.7%  2404 1175s
  5861  3029 26097.4105   22  180 23632.4752 30184.7687  27.7%  2400 1183s
  5941  3016 27168.8922   22  440 23632.4752 30184.7687  27.7%  2393 1191s
  5979  3016 26436.5728   23  377 23632.4752 30184.7687  27.7%  2391 1199s
  6050  3003 25005.4527   23  166 23632.4752 30184.7687  27.7%  2380 1209s
  6114  2999 26320.5738   23  421 23632.4752 30184.7687  27.7%  2373 1221s
  6178  2982 24210.5230   23  135 23632.4752 30184.7687  27.7%  2373 1236s
  6223  2970 25901.8899   24  363 23632.4752 30184.7687  27.7%  2375 1251s
  6273  2968 24577.1773   24  290 23632.4752 30184.7687  27.7%  2376 1264s
  6325  2968     cutoff   25      23632.4752 30184.7687  27.7%  2375 1272s
  6375  2980 26778.6347   21  351 23632.4752 30184.7687  27.7%  2378 1280s
  6437  2983 26346.1169   22  324 23632.4752 30184.7687  27.7%  2378 1289s
  6503  2972 26195.7968   23  328 23632.4752 30184.7687  27.7%  2375 1298s
  6573  2965 26192.6360   24  331 23632.4752 30184.7687  27.7%  2373 1311s
  6652  2933     cutoff   26      23632.4752 30184.7687  27.7%  2372 1320s
  6703  2941     cutoff   26      23632.4752 30184.7687  27.7%  2383 1331s
  6759  2954 24509.0179   26  319 23632.4752 30184.7687  27.7%  2390 1341s
  6838  2931 23662.6569   30  185 23632.4752 30184.7687  27.7%  2391 1351s
  6930  2900 27330.8456   18  371 23632.4752 30184.7687  27.7%  2393 1362s
  7013  2886 26165.9992   19  342 23632.4752 30184.7687  27.7%  2394 1373s
  7095  2889 26046.2796   20  416 23632.4752 30184.7687  27.7%  2396 1383s
  7181  2897 25529.7858   22  323 23632.4752 30184.7687  27.7%  2400 1396s
  7277  2893     cutoff   25      23632.4752 29272.5195  23.9%  2403 1407s
  7376  2888     cutoff   26      23632.4752 29246.2671  23.8%  2409 1424s
  7476  2864 23747.3727   23  371 23632.4752 29198.4528  23.6%  2416 1437s
  7580  2833     cutoff   24      23632.4752 28668.6687  21.3%  2422 1450s
  7687  2838     cutoff   20      23632.4752 28366.5584  20.0%  2427 1463s
  7788  2816 27159.6351   20  372 23632.4752 28272.5376  19.6%  2440 1471s
  7833  2800 26203.2203   21  249 23632.4752 28272.5376  19.6%  2444 1483s
  7940  2775 25831.9549   22  260 23632.4752 28067.2372  18.8%  2444 1496s
  8083  2749 24739.4776   24  283 23632.4752 28028.2012  18.6%  2441 1510s
  8267  2709 23819.3783   26  229 23632.4752 27517.4216  16.4%  2438 1526s
  8461  2706 24608.1962   21  378 23632.4752 27267.2241  15.4%  2429 1541s
  8664  2624 infeasible   33      23632.4752 27191.6561  15.1%  2419 1557s
  8859  2567     cutoff   25      23632.4752 27056.8234  14.5%  2419 1573s
  9033  2491     cutoff   25      23632.4752 27056.8234  14.5%  2421 1589s
  9209  2453 24457.0576   22  147 23632.4752 27014.6988  14.3%  2414 1605s
  9496  2317 25661.3844   23  372 23632.4752 26601.0779  12.6%  2393 1622s
  9773  2206     cutoff   27      23632.4752 26301.9725  11.3%  2376 1640s
 10091  1986     cutoff   23      23632.4752 26190.3080  10.8%  2355 1657s
 10490  1746 24936.8519   23  434 23632.4752 25712.3438  8.80%  2316 1675s
 10964  1467     cutoff   25      23632.4752 25712.3438  8.80%  2264 1696s
 11611  1380     cutoff   38      23632.4752 25341.0328  7.23%  2174 1707s
H12197  1039                    23669.827334 24919.6841  5.28%  2082 1707s
H12501   801                    23706.730295 24814.1263  4.67%  2037 1707s
H12767   975                    23815.796225 24720.9394  3.80%  2000 1716s
 14184   588     cutoff   44      23815.7962 23942.4769  0.53%  1807 1720s
H14275   588                    23835.310714 23939.1684  0.44%  1795 1720s
 15683     0     cutoff   65      23835.3107 23911.8749  0.32%  1637 1725s

Cutting planes:
  MIR: 623
  Mixing: 1
  Flow cover: 1636
  RLT: 21
  Relax-and-lift: 182

Explored 16416 nodes (25911675 simplex iterations) in 1726.11 seconds (4885.58 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 23835.3 23815.8 23706.7 ... 22941.5

Optimal solution found (tolerance 1.00e-04)
Best objective 2.383531071357e+04, best bound 2.383531071357e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1726.12s
  Master Objective (UB) = 23835.31, θ = 147293.95
  Upper Bound (UB) = 23835.31

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 147293.95
  [DEBUG]   ✓ Scenario 0: θ = 147293.95 ≤ Q = 147293.95 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 147293.95 ≤ Q = 147293.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 147293.95 ≤ Q = 147293.95 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 147293.95 ≤ Q = 147293.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 147293.95 ≤ Q = 147293.95 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 147293.95 ≤ Q = 147293.95 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x72730f5d
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x8d8cf0a3
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [3e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.457366e+13
Presolve removed 2571 rows and 1864 columns
Presolve time: 0.00s
Presolved: 522 rows, 525 columns, 1472 nonzeros
Found heuristic solution: objective 7706763.7951
Variable types: 355 continuous, 170 integer (170 binary)

Root relaxation: objective -1.406837e+05, 252 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -140683.73    0  130 7706763.80 -140683.73   102%     -    0s
H    0     0                    -106171.0972 -140683.73  32.5%     -    0s
H    0     0                    -107143.0424 -140683.73  31.3%     -    0s
H    0     0                    -113395.3288 -140683.73  24.1%     -    0s
     0     0 -123647.10    0  133 -113395.33 -123647.10  9.04%     -    0s
H    0     0                    -118244.9047 -123516.58  4.46%     -    0s
     0     0 -123211.59    0  135 -118244.90 -123211.59  4.20%     -    0s
H    0     0                    -119651.9859 -123211.59  2.97%     -    0s
     0     0 -121882.87    0  136 -119651.99 -121882.87  1.86%     -    0s
H    0     0                    -119897.4129 -121877.03  1.65%     -    0s
     0     0 -121493.68    0  115 -119897.41 -121493.68  1.33%     -    0s
H    0     0                    -120061.3560 -121442.56  1.15%     -    0s
H    0     0                    -120110.4303 -121442.56  1.11%     -    0s
     0     0 -121442.56    0  128 -120110.43 -121442.56  1.11%     -    0s
     0     0 -121442.56    0  106 -120110.43 -121442.56  1.11%     -    0s
     0     0 -121104.04    0   90 -120110.43 -121104.04  0.83%     -    0s
     0     0 -121066.84    0  108 -120110.43 -121066.84  0.80%     -    0s
     0     0 -121066.84    0  108 -120110.43 -121066.84  0.80%     -    0s
     0     0 -120867.30    0  109 -120110.43 -120867.30  0.63%     -    0s
     0     0 -120831.75    0  108 -120110.43 -120831.75  0.60%     -    0s
     0     0 -120831.75    0  108 -120110.43 -120831.75  0.60%     -    0s
     0     0 -120514.01    0   57 -120110.43 -120514.01  0.34%     -    0s
     0     0 -120472.87    0   38 -120110.43 -120472.87  0.30%     -    0s
     0     0 -120457.71    0   53 -120110.43 -120457.71  0.29%     -    0s
     0     0 -120313.96    0   23 -120110.43 -120313.96  0.17%     -    0s
     0     0 -120278.28    0   25 -120110.43 -120278.28  0.14%     -    0s
     0     0 -120277.67    0   25 -120110.43 -120277.67  0.14%     -    0s
     0     0 -120234.84    0   19 -120110.43 -120234.84  0.10%     -    0s
     0     0 -120234.84    0   28 -120110.43 -120234.84  0.10%     -    0s
     0     0 -120133.39    0    7 -120110.43 -120133.39  0.02%     -    0s
     0     0 -120131.00    0    8 -120110.43 -120131.00  0.02%     -    0s
     0     0 -120126.55    0    2 -120110.43 -120126.55  0.01%     -    0s
     0     0 -120126.55    0    7 -120110.43 -120126.55  0.01%     -    0s
H    0     0                    -120116.1548 -120126.55  0.01%     -    0s

Explored 1 nodes (1133 simplex iterations) in 0.08 seconds (0.08 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -120116 -120110 -120108 ... -106171

Optimal solution found (tolerance 1.00e-04)
Best objective -1.201161548229e+05, best bound -1.201265473007e+05, gap 0.0087%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 135761.36
  Scenario: 60 demand increases, 0 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -120116.15
  [DEBUG]   S×d_nominal = 255877.51
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 255877.51 + -120116.15 = 135761.36
  [DEBUG]   Current θ from Master = 147293.95
  [DEBUG]   ⚠️  Z_SP ≤ θ by 11532.59 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 12302.72
  Lower Bound (LB) = 17130.73
  Gap (UB-LB) = 6704.5789, Absolute Gap = 6704.5789, Relative Gap = 0.281288
  Not converged yet (gap = 6704.58 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 60 increases, 0 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308241 nonzeros
Model fingerprint: 0x4a8023da
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 45995 rows and 18675 columns
Presolve time: 0.99s
Presolved: 62418 rows, 27265 columns, 388194 nonzeros
Variable types: 25006 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -366999.6780
Found heuristic solution: objective -194531.7474

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 62418 rows, 27265 columns, 388194 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   33076   -8.6569447e+03   0.000000e+00   4.770858e+07      5s
   44513    8.4545104e+03   0.000000e+00   1.904591e+07     10s
   54827    2.0774585e+04   0.000000e+00   9.371773e+06     15s
   63521    2.5367582e+04   0.000000e+00   1.556736e+06     20s
Concurrent spin time: 2.89s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 4.536976e+04, 61868 iterations, 26.26 seconds (52.72 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 45369.7605    0  163 -194531.75 45369.7605   123%     -   27s
H    0     0                    -177361.5346 45369.7605   126%     -   27s
H    0     0                    -166253.3952 45369.7605   127%     -   27s
H    0     0                    -163587.1226 45369.7605   128%     -   27s
H    0     0                    -162393.6652 45369.7605   128%     -   27s
H    0     0                    -120523.8464 45369.7605   138%     -   27s
H    0     0                    -107169.6855 45369.7605   142%     -   28s
H    0     0                    -107148.6065 45369.7605   142%     -   28s
H    0     0                    -42205.89710 45369.7605   207%     -   28s
H    0     0                    -41996.74689 45369.7605   208%     -   28s
H    0     0                    -2663.136444 45369.7605  1804%     -   28s
H    0     0                     180.4222645 45369.7605      -     -   28s
H    0     0                     319.5963218 45369.7605      -     -   28s
H    0     0                     821.0316254 45369.7605  5426%     -   28s
H    0     0                    1136.3516831 45369.7605  3893%     -   28s
H    0     0                    1949.5000008 45369.7605  2227%     -   28s
H    0     0                    5820.7703806 45369.7605   679%     -   29s
H    0     0                    6551.6037530 45369.7605   592%     -   29s
H    0     0                    6561.1576095 45369.7605   591%     -   29s
H    0     0                    6581.1133460 45369.7605   589%     -   29s
H    0     0                    6679.9201937 45369.7605   579%     -   29s
H    0     0                    6725.6887645 45369.7605   575%     -   29s
H    0     0                    6858.7202220 40927.0333   497%     -   36s
H    0     0                    6862.5840060 40927.0333   496%     -   36s
H    0     0                    6989.9793658 40927.0333   486%     -   36s
     0     0 40927.0333    0  209 6989.97937 40927.0333   486%     -   36s
     0     0 40554.1061    0  227 6989.97937 40554.1061   480%     -   37s
     0     0 40554.1061    0  232 6989.97937 40554.1061   480%     -   39s
     0     0 40554.1061    0  114 6989.97937 40554.1061   480%     -   39s
     0     0 40554.1061    0  113 6989.97937 40554.1061   480%     -   39s
     0     0 38122.7706    0  280 6989.97937 38122.7706   445%     -   47s
H    0     0                    9688.8097487 38122.3941   293%     -   47s
     0     0 37787.2200    0  275 9688.80975 37787.2200   290%     -   50s
     0     0 37699.2252    0  283 9688.80975 37699.2252   289%     -   51s
     0     0 37667.4757    0  289 9688.80975 37667.4757   289%     -   51s
     0     0 37665.3202    0  291 9688.80975 37665.3202   289%     -   51s
     0     0 37664.5797    0  291 9688.80975 37664.5797   289%     -   51s
     0     0 35622.4933    0  394 9688.80975 35622.4933   268%     -   59s
H    0     0                    9902.7814822 35620.3957   260%     -   59s
H    0     0                    10016.479812 35620.3957   256%     -   59s
H    0     0                    10044.260109 35620.3957   255%     -   59s
H    0     0                    11333.054127 34611.6624   205%     -   67s
H    0     0                    11356.150432 34611.6624   205%     -   67s
H    0     0                    11454.957279 34611.6624   202%     -   67s
H    0     0                    11500.725850 34611.6624   201%     -   67s
H    0     0                    11512.262596 34611.6624   201%     -   67s
     0     0 34611.6624    0  339 11512.2626 34611.6624   201%     -   67s
     0     0 34214.3887    0  362 11512.2626 34214.3887   197%     -   69s
     0     0 34014.5044    0  417 11512.2626 34014.5044   195%     -   70s
     0     0 33944.9899    0  421 11512.2626 33944.9899   195%     -   72s
     0     0 33868.6361    0  433 11512.2626 33868.6361   194%     -   73s
     0     0 33843.1090    0  432 11512.2626 33843.1090   194%     -   74s
     0     0 33816.2261    0  437 11512.2626 33816.2261   194%     -   75s
     0     0 33811.6521    0  432 11512.2626 33811.6521   194%     -   75s
     0     0 33808.9422    0  442 11512.2626 33808.9422   194%     -   76s
     0     0 33806.9575    0  443 11512.2626 33806.9575   194%     -   76s
     0     0 33806.7081    0  438 11512.2626 33806.7081   194%     -   76s
     0     0 32695.4830    0  477 11512.2626 32695.4830   184%     -   85s
     0     0 32429.0548    0  473 11512.2626 32429.0548   182%     -   87s
     0     0 32339.5709    0  478 11512.2626 32339.5709   181%     -   89s
     0     0 32243.1968    0  493 11512.2626 32243.1968   180%     -   90s
     0     0 32187.2840    0  439 11512.2626 32187.2840   180%     -   92s
     0     0 32158.0368    0  497 11512.2626 32158.0368   179%     -   92s
     0     0 32143.3093    0  493 11512.2626 32143.3093   179%     -   93s
     0     0 32115.1061    0  494 11512.2626 32115.1061   179%     -   94s
     0     0 32107.7071    0  500 11512.2626 32107.7071   179%     -   95s
     0     0 32102.9159    0  496 11512.2626 32102.9159   179%     -   95s
     0     0 32101.6604    0  501 11512.2626 32101.6604   179%     -   95s
H    0     0                    12027.736829 31858.8267   165%     -   98s
H    0     0                    12207.176353 31858.8267   161%     -   98s
     0     0 31858.8267    0  497 12207.1764 31858.8267   161%     -   98s
H    0     0                    12546.736563 31787.6732   153%     -  100s
     0     0 31787.6732    0  509 12546.7366 31787.6732   153%     -  100s
     0     0 31770.6728    0  514 12546.7366 31770.6728   153%     -  101s
     0     0 31762.6300    0  520 12546.7366 31762.6300   153%     -  102s
     0     0 31741.5188    0  515 12546.7366 31741.5188   153%     -  103s
     0     0 31732.5727    0  508 12546.7366 31732.5727   153%     -  103s
     0     0 31713.3504    0  447 12546.7366 31713.3504   153%     -  104s
     0     0 31706.9194    0  450 12546.7366 31706.9194   153%     -  104s
     0     0 31703.1085    0  448 12546.7366 31703.1085   153%     -  105s
     0     0 31701.1139    0  451 12546.7366 31701.1139   153%     -  105s
     0     0 31700.8109    0  456 12546.7366 31700.8109   153%     -  105s
     0     0 31678.0551    0  454 12546.7366 31678.0551   152%     -  107s
H    0     0                    12683.425183 31677.4367   150%     -  108s
H    0     0                    12910.709766 31677.4367   145%     -  109s
H    0     0                    12969.952229 31677.4367   144%     -  109s
     0     0 31668.6240    0  451 12969.9522 31668.6240   144%     -  110s
     0     0 31661.7149    0  462 12969.9522 31661.7149   144%     -  110s
     0     0 31660.2777    0  461 12969.9522 31660.2777   144%     -  111s
     0     0 31628.2584    0  475 12969.9522 31628.2584   144%     -  113s
     0     0 31608.3676    0  473 12969.9522 31608.3676   144%     -  114s
     0     0 31604.1836    0  482 12969.9522 31604.1836   144%     -  114s
     0     0 31602.8701    0  483 12969.9522 31602.8701   144%     -  114s
     0     0 31597.5590    0  482 12969.9522 31597.5590   144%     -  116s
     0     0 31594.8086    0  482 12969.9522 31594.8086   144%     -  117s
     0     0 31594.3753    0  480 12969.9522 31594.3753   144%     -  117s
     0     0 31590.0052    0  484 12969.9522 31590.0052   144%     -  118s
     0     0 31587.7440    0  484 12969.9522 31587.7440   144%     -  118s
     0     0 31587.1902    0  486 12969.9522 31587.1902   144%     -  119s
     0     0 31578.9350    0  474 12969.9522 31578.9350   143%     -  120s
     0     0 31573.7426    0  468 12969.9522 31573.7426   143%     -  122s
     0     0 31567.8016    0  473 12969.9522 31567.8016   143%     -  123s
     0     0 31566.1422    0  468 12969.9522 31566.1422   143%     -  123s
     0     0 31562.8438    0  466 12969.9522 31562.8438   143%     -  124s
     0     0 31561.2029    0  466 12969.9522 31561.2029   143%     -  125s
H    0     0                    13098.263302 31561.2029   141%     -  149s
H    0     0                    13162.786431 31561.2029   140%     -  150s
H    0     2                    13398.872704 31561.2029   136%     -  150s
     0     2 31561.2029    0  466 13398.8727 31561.2029   136%     -  150s
     1     4 31266.8277    1  454 13398.8727 31561.2029   136%  4769  158s
     3     8 30898.0086    2  448 13398.8727 31266.8242   133%  7964  167s
     7    16 30654.1298    3  545 13398.8727 30897.3165   131%  8943  176s
    15    32 30181.1366    4  513 13398.8727 30652.6348   129%  8880  182s
    31    49 28069.4937    5  447 13398.8727 30181.0077   125% 10490  197s
    48    81 28336.8839    6  524 13398.8727 30181.0077   125% 11632  218s
H   52    81                    14963.808611 30181.0077   102% 11047  218s
H   55    81                    15193.389133 30181.0077  98.6% 10753  218s
H   76    81                    15452.096351 30181.0077  95.3%  9103  218s
    80   235 28259.2351    7  512 15452.0964 30181.0077  95.3%  8864  229s
H  234   266                    17298.696697 30181.0077  74.5%  4975  236s
H  241   266                    17305.492748 30181.0077  74.4%  4923  236s
H  245   266                    17501.942182 30181.0077  72.4%  4880  236s
H  259   266                    18164.109154 30181.0077  66.2%  4767  236s
H  260   266                    18285.949192 30181.0077  65.1%  4759  236s
   265   337 26772.9885   11  423 18285.9492 30181.0077  65.1%  4718  244s
   344   398 26707.9442   11  362 18285.9492 30181.0077  65.1%  4209  250s
H  350   398                    18312.628924 30181.0077  64.8%  4203  250s
H  352   398                    18568.364156 30181.0077  62.5%  4224  250s
H  399   398                    18677.952868 30181.0077  61.6%  4094  250s
   409   455 27977.1043   11  438 18677.9529 30181.0077  61.6%  4019  259s
   477   502 27769.0269   12  491 18677.9529 30181.0077  61.6%  3955  267s
H  488   502                    18726.864355 30181.0077  61.2%  3936  267s
H  507   502                    18786.888299 30181.0077  60.6%  3887  267s
   540   524 27607.9749   12  453 18786.8883 30181.0077  60.6%  3884  275s
H  547   524                    18808.500558 30181.0077  60.5%  3883  275s
   576   592 27279.9808   12  478 18808.5006 30181.0077  60.5%  3876  282s
H  646   592                    18820.795889 30181.0077  60.4%  3794  282s
   658   662 26375.9486   12  252 18820.7959 30181.0077  60.4%  3776  290s
   753   708 26404.6852   12  411 18820.7959 30181.0077  60.4%  3616  296s
H  798   708                    18906.519089 30181.0077  59.6%  3614  296s
   822   759 27174.8595   13  497 18906.5191 30181.0077  59.6%  3596  303s
   910   808 26292.0851   14  433 18906.5191 30026.8076  58.8%  3508  311s
H  915   808                    19112.880767 30026.8076  57.1%  3513  311s
   987   848 26060.1583   15  412 19112.8808 30025.6530  57.1%  3511  319s
  1066   874 23671.8869   14  334 19112.8808 30025.6530  57.1%  3577  327s
  1108   921 25600.7545   16  358 19112.8808 30025.6530  57.1%  3657  334s
  1173   957 20262.4822   16  361 19112.8808 29867.3468  56.3%  3747  340s
  1241   995 21653.4205   17  269 19112.8808 29867.3468  56.3%  3810  348s
H 1311   995                    19128.103600 29818.9160  55.9%  3861  348s
  1321  1021     cutoff   17      19128.1036 29818.9160  55.9%  3852  356s
H 1327  1021                    19129.656985 29635.7463  54.9%  3865  356s
  1383  1047 21479.9706   18  271 19129.6570 29635.7463  54.9%  3917  364s
H 1402  1047                    19171.587414 29635.7463  54.6%  3930  364s
H 1418  1047                    19223.559678 29635.7463  54.2%  3952  364s
  1421  1077 20925.5832   18  287 19223.5597 29635.7463  54.2%  3958  373s
  1487  1151 21245.5604   19  259 19223.5597 29635.7463  54.2%  3956  381s
  1579  1205 19705.3372   20  318 19223.5597 29635.7463  54.2%  4015  386s
  1651  1268 19776.7895   21  195 19223.5597 29635.7463  54.2%  4021  395s
  1774  1339 26532.7395   12  406 19223.5597 29635.7463  54.2%  3997  405s
  1904  1455 26445.1751   15  415 19223.5597 29635.7463  54.2%  3927  414s
  2058  1543 25896.2499   19  358 19223.5597 29635.7463  54.2%  3863  421s
H 2225  1602                    19885.792792 29635.7463  49.0%  3798  431s
  2338  1685 25503.0845   22  415 19885.7928 29146.4127  46.6%  3766  442s
  2487  1772 25287.0443   25  412 19885.7928 29146.4127  46.6%  3766  453s
  2628  1819 22282.1988   34  103 19885.7928 29146.4127  46.6%  3798  463s
  2782  1872 26023.1578   13  487 19885.7928 29146.4127  46.6%  3824  475s
  2928  1892 25392.3409   16  377 19885.7928 29146.4127  46.6%  3829  486s
H 2939  1825                    20203.342409 29146.4127  44.3%  3831  486s
  2974  1843 25374.8564   17  378 20203.3424 28384.8435  40.5%  3842  494s
H 3012  1744                    20616.317345 28384.8435  37.7%  3861  494s
  3020  1817 25219.3227   18  318 20616.3173 28384.8435  37.7%  3862  506s
  3179  1905 24760.9091   24  232 20616.3173 28384.8435  37.7%  3889  517s
  3338  2012 23304.2576   38  246 20616.3173 28336.1980  37.4%  3917  528s
  3507  2113 22495.1476   51  182 20616.3173 28336.1980  37.4%  3914  541s
  3720  2206 26412.8657   14  343 20616.3173 28276.2416  37.2%  3891  554s
  3921  2237 24653.6573   19  456 20616.3173 28251.6540  37.0%  3890  565s
  4038  2309 24483.4529   20  447 20616.3173 27975.6918  35.7%  3892  578s
  4172  2368 24090.1939   21  292 20616.3173 27974.7698  35.7%  3929  590s
  4325  2422 22929.2244   22  320 20616.3173 27974.7698  35.7%  3995  603s
  4519  2501 20754.5726   26  310 20616.3173 27919.9441  35.4%  4028  618s
  4744  2563     cutoff   15      20616.3173 27851.4788  35.1%  4039  633s
  4990  2595 24447.2752   11  328 20616.3173 27825.9410  35.0%  4056  649s
  5206  2656 21116.5150   14  273 20616.3173 27690.6617  34.3%  4093  665s
  5405  2750 21691.3658   17  494 20616.3173 27583.7249  33.8%  4142  682s
  5607  2751 21114.4074   29  466 20616.3173 27583.7249  33.8%  4196  724s
  5609  2752 22871.7029   17  163 20616.3173 27583.7249  33.8%  4194  741s
  5610  2753 27279.8608   13  333 20616.3173 27583.7249  33.8%  4194  758s
  5611  2754 24040.1609   12  403 20616.3173 27583.7249  33.8%  4193  770s
  5612  2754 22772.5684   14  430 20616.3173 27583.7249  33.8%  4192  778s
  5613  2755 24446.7577   16  457 20616.3173 27583.7249  33.8%  4191  782s
  5614  2756 25686.2258   10  425 20616.3173 27583.7249  33.8%  4191  785s
  5616  2757 23242.1818   17  504 20616.3173 27583.7249  33.8%  4189  790s
  5619  2759 22649.3919   32  514 20616.3173 27583.7249  33.8%  4187  795s
  5622  2761 21330.2010   30  460 20616.3173 27583.7249  33.8%  4185  802s
  5624  2762 20876.7706   26  450 20616.3173 27583.7249  33.8%  4183  805s
  5626  2764 24329.1682   13  567 20616.3173 27583.7249  33.8%  4182  812s
  5628  2765 23682.0652   28  526 20616.3173 27583.7249  33.8%  4180  815s
  5630  2766 24668.8650   14  520 20616.3173 27583.7249  33.8%  4179  820s
  5632  2768 21460.7877   57  517 20616.3173 27583.7249  33.8%  4177  826s
  5633  2768 27087.0703    9  507 20616.3173 27583.7249  33.8%  4177  830s
  5635  2770 24791.2300   25  511 20616.3173 27583.7249  33.8%  4175  835s
  5637  2771 23215.6764   38  556 20616.3173 27583.7249  33.8%  4174  841s
  5638  2772 24093.6035   20  556 20616.3173 27583.7249  33.8%  4173  859s
  5639  2772 24022.9900   26  556 20616.3173 27583.7249  33.8%  4172  873s
  5640  2776 27583.7249   10  543 20616.3173 27583.7249  33.8%  4203  893s
  5642  2779 27583.7249   11  506 20616.3173 27583.7249  33.8%  4206  909s
  5646  2786 27583.7249   12  464 20616.3173 27583.7249  33.8%  4208  929s
  5654  2799 27583.7249   13  559 20616.3173 27583.7249  33.8%  4215  941s
  5670  2814 27583.7249   14  528 20616.3173 27583.7249  33.8%  4249  963s
  5690  2839 25851.2425   15  353 20616.3173 27583.7249  33.8%  4260  976s
  5722  2885 23866.2192   16  480 20616.3173 27583.7249  33.8%  4288  990s
  5795  2908 23788.0754   17  483 20616.3173 27583.7249  33.8%  4315 1006s
  5894  2889 22627.6185   18  470 20616.3173 27583.7249  33.8%  4307 1019s
  5954  2884     cutoff   19      20616.3173 27583.7249  33.8%  4301 1029s
  6013  2879     cutoff   18      20616.3173 27583.7249  33.8%  4305 1039s
  6057  2889     cutoff   20      20616.3173 27583.7249  33.8%  4298 1048s
  6109  2893     cutoff   22      20616.3173 27583.7249  33.8%  4294 1058s
  6159  2886 25041.9933   17  507 20616.3173 27583.7249  33.8%  4287 1068s
  6231  2874 24651.1571   17  496 20616.3173 27583.7249  33.8%  4270 1076s
  6292  2880 24053.7714   18  464 20616.3173 27583.7249  33.8%  4259 1086s
  6351  2875 23531.7513   19  463 20616.3173 27583.7249  33.8%  4247 1100s
  6396  2872 23383.1151   20  387 20616.3173 27583.7249  33.8%  4242 1111s
  6444  2874 22352.3217   21  374 20616.3173 27583.7249  33.8%  4237 1123s
  6506  2885 22194.0889   22  292 20616.3173 27337.3309  32.6%  4227 1133s
  6557  2895 21715.1715   24  335 20616.3173 27337.3309  32.6%  4227 1142s
  6621  2898 21295.1657   27  139 20616.3173 27337.3309  32.6%  4219 1152s
  6693  2887     cutoff   29      20616.3173 27241.3604  32.1%  4208 1164s
  6735  2904     cutoff   30      20616.3173 27241.3604  32.1%  4205 1173s
  6795  2918 21919.4662   18  406 20616.3173 26761.7235  29.8%  4198 1184s
  6869  2930     cutoff   19      20616.3173 26743.9454  29.7%  4184 1196s
  6978  2921 25294.1828   20  442 20616.3173 26743.9454  29.7%  4161 1207s
  7055  2931 23520.1152   21  415 20616.3173 26616.2111  29.1%  4148 1220s
  7159  2935 23450.7494   22  473 20616.3173 26616.2111  29.1%  4129 1233s
  7271  2927 21647.6476   25  402 20616.3173 26616.2111  29.1%  4112 1248s
  7381  2908 21190.0768   27  314 20616.3173 26357.1649  27.8%  4095 1262s
  7510  2894     cutoff   19      20616.3173 26312.9247  27.6%  4076 1275s
  7620  2871     cutoff   21      20616.3173 26312.9247  27.6%  4069 1289s
  7667  2885     cutoff   21      20616.3173 25935.0494  25.8%  4065 1305s
  7744  2883 21392.0878   21  445 20616.3173 25935.0494  25.8%  4057 1319s
  7787  2889 21303.3298   22  460 20616.3173 25842.5373  25.3%  4054 1334s
  7854  2878 20909.3953   23  364 20616.3173 25682.4253  24.6%  4044 1349s
  7946  2886     cutoff   24      20616.3173 25682.4253  24.6%  4030 1363s
  8051  2891 20731.1819   22  159 20616.3173 25682.4253  24.6%  4010 1380s
  8174  2881 21502.7640   22  150 20616.3173 25662.2253  24.5%  3988 1397s
  8316  2852 21058.1265   29  152 20616.3173 25369.4195  23.1%  3963 1415s
  8468  2826     cutoff   19      20616.3173 25342.4138  22.9%  3945 1432s
  8616  2809 23967.9331   20  246 20616.3173 25172.8781  22.1%  3926 1452s
  8770  2814 22919.9623   25  318 20616.3173 25172.8781  22.1%  3909 1472s
  8955  2783     cutoff   30      20616.3173 25098.6966  21.7%  3882 1491s
  9176  2730     cutoff   40      20616.3173 25008.2106  21.3%  3852 1511s
  9379  2687 21192.2717   21  267 20616.3173 24710.5889  19.9%  3832 1534s
  9613  2670 22202.3635   18  260 20616.3173 24710.5889  19.9%  3807 1556s
  9907  2643     cutoff   23      20616.3173 24398.6343  18.3%  3767 1580s
 10261  2527 22478.8182   21  504 20616.3173 24264.8599  17.7%  3712 1605s
 10561  2415 21106.7703   23  352 20616.3173 24023.8370  16.5%  3683 1629s
 10958  2245 infeasible   18      20616.3173 23893.1461  15.9%  3622 1657s
 11263  2142 21161.5932   25  146 20616.3173 23633.6715  14.6%  3598 1682s
 11642  1987 20845.1024   27  231 20616.3173 23428.8094  13.6%  3561 1708s
 12084  1846     cutoff   22      20616.3173 23212.1255  12.6%  3512 1736s
 12561  1559 21298.4920   26  403 20616.3173 22775.0946  10.5%  3458 1762s
 13147  1123     cutoff   19      20616.3173 22505.0479  9.16%  3383 1789s
 13785   483     cutoff   22      20616.3173 22218.8795  7.77%  3304 1815s
 14788    10     cutoff   23      20616.3173 21861.8537  6.04%  3147 1837s

Cutting planes:
  Learned: 1
  Lift-and-project: 1
  MIR: 573
  Flow cover: 1611
  RLT: 22
  Relax-and-lift: 198

Explored 15567 nodes (47081823 simplex iterations) in 1838.35 seconds (5778.63 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 20616.3 20203.3 19885.8 ... 18820.8

Optimal solution found (tolerance 1.00e-04)
Best objective 2.061631734521e+04, best bound 2.061631734521e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1838.37s
  Master Objective (UB) = 20616.32, θ = 150633.57
  Upper Bound (UB) = 20616.32

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 150633.57
  [DEBUG]   ✓ Scenario 0: θ = 150633.57 ≤ Q = 150633.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 150633.57 ≤ Q = 150633.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 150633.57 ≤ Q = 150633.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 150633.57 ≤ Q = 150633.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 150633.57 ≤ Q = 150633.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 150633.57 ≤ Q = 150633.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 150633.57 ≤ Q = 150633.57 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x61966779
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x9e699887
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [6e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [8e-14, 2e+02]
Found heuristic solution: objective 1.552218e+13
Presolve removed 2571 rows and 1864 columns
Presolve time: 0.00s
Presolved: 522 rows, 525 columns, 1472 nonzeros
Found heuristic solution: objective 8262532.3105
Variable types: 355 continuous, 170 integer (170 binary)

Root relaxation: objective -1.419010e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -141901.03    0  124 8262532.31 -141901.03   102%     -    0s
H    0     0                    -106913.5540 -141901.03  32.7%     -    0s
H    0     0                    -107415.0151 -141901.03  32.1%     -    0s
     0     0 -119997.87    0   88 -107415.02 -119997.87  11.7%     -    0s
H    0     0                    -117283.5790 -119995.43  2.31%     -    0s
     0     0 -119479.90    0   86 -117283.58 -119479.90  1.87%     -    0s
H    0     0                    -118346.6085 -119438.00  0.92%     -    0s
     0     0 -119354.91    0   82 -118346.61 -119354.91  0.85%     -    0s
     0     0 -118905.93    0   67 -118346.61 -118905.93  0.47%     -    0s
     0     0 -118862.09    0   64 -118346.61 -118862.09  0.44%     -    0s
     0     0 -118744.98    0   33 -118346.61 -118744.98  0.34%     -    0s
     0     0 -118715.02    0   39 -118346.61 -118715.02  0.31%     -    0s
     0     0 -118703.09    0   44 -118346.61 -118703.09  0.30%     -    0s
     0     0 -118450.60    0   15 -118346.61 -118450.60  0.09%     -    0s
     0     0 -118450.26    0   14 -118346.61 -118450.26  0.09%     -    0s
     0     0 -118442.93    0   15 -118346.61 -118442.93  0.08%     -    0s
     0     0 -118379.37    0    4 -118346.61 -118379.37  0.03%     -    0s
     0     0          -    0      -118346.61 -118355.94  0.01%     -    0s

Explored 1 nodes (780 simplex iterations) in 0.05 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 6: -118347 -117284 -107415 ... 1.55222e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.183466084827e+05, best bound -1.183559420979e+05, gap 0.0079%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 142659.76
  Scenario: 36 demand increases, 24 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -118346.61
  [DEBUG]   S×d_nominal = 261006.37
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 261006.37 + -118346.61 = 142659.76
  [DEBUG]   Current θ from Master = 150633.57
  [DEBUG]   ⚠️  Z_SP ≤ θ by 7973.81 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 12642.51
  Lower Bound (LB) = 17130.73
  Gap (UB-LB) = 3485.5855, Absolute Gap = 3485.5855, Relative Gap = 0.169069
  Not converged yet (gap = 3485.59 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 36 increases, 24 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351487 nonzeros
Model fingerprint: 0x73ebce5d
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 52580 rows and 21350 columns
Presolve time: 1.14s
Presolved: 71123 rows, 30830 columns, 442819 nonzeros
Variable types: 28571 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -366999.6780
Found heuristic solution: objective -194531.7474

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 71123 rows, 30830 columns, 442819 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   34057   -6.6118606e+04   0.000000e+00   8.510514e+07      5s
   49517    1.5652917e+04   0.000000e+00   9.669298e+06     10s
   58654    2.4897045e+04   0.000000e+00   6.594024e+07     15s
   67713    2.8640610e+04   0.000000e+00   6.258757e+06     20s
   75046    3.3263162e+04   0.000000e+00   9.631593e+06     25s
Concurrent spin time: 1.77s

Solved with dual simplex

Root relaxation: objective 4.536976e+04, 49545 iterations, 26.93 seconds (56.06 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 45369.7605    0  163 -194531.75 45369.7605   123%     -   28s
H    0     0                    -178209.7783 45369.7605   125%     -   28s
H    0     0                    -74800.45592 45369.7605   161%     -   28s
H    0     0                    -58957.09308 45369.7605   177%     -   28s
H    0     0                    -56020.40292 45369.7605   181%     -   28s
H    0     0                    -55172.04135 45369.7605   182%     -   28s
H    0     0                    -42205.89710 45369.7605   207%     -   28s
H    0     0                    -41996.74689 45369.7605   208%     -   28s
H    0     0                    -2663.136444 45369.7605  1804%     -   28s
H    0     0                     185.9310698 45369.7605      -     -   29s
H    0     0                    1118.2397491 45369.7605  3957%     -   29s
H    0     0                    1949.5000008 45369.7605  2227%     -   29s
H    0     0                    5237.5469605 45369.7605   766%     -   29s
H    0     0                    6449.5463370 45369.7605   603%     -   29s
H    0     0                    6548.3531847 45369.7605   593%     -   29s
H    0     0                    6581.1133460 45369.7605   589%     -   29s
H    0     0                    6725.6887645 45369.7605   575%     -   29s
H    0     0                    6922.2352042 40929.8613   491%     -   38s
H    0     0                    7058.1574266 40929.8613   480%     -   38s
     0     0 40929.8613    0  187 7058.15743 40929.8613   480%     -   38s
     0     0 40147.8597    0  230 7058.15743 40147.8597   469%     -   43s
     0     0 40147.8597    0  225 7058.15743 40147.8597   469%     -   44s
     0     0 40147.8597    0  226 7058.15743 40147.8597   469%     -   47s
     0     0 40147.8597    0  230 7058.15743 40147.8597   469%     -   48s
     0     0 37532.3266    0  283 7058.15743 37532.3266   432%     -   59s
H    0     0                    9756.9878095 37532.3266   285%     -   59s
     0     0 36911.5839    0  299 9756.98781 36911.5839   278%     -   63s
     0     0 36669.0168    0  385 9756.98781 36669.0168   276%     -   68s
     0     0 36401.9862    0  307 9756.98781 36401.9862   273%     -   70s
     0     0 36374.9732    0  310 9756.98781 36374.9732   273%     -   71s
     0     0 36299.7754    0  310 9756.98781 36299.7754   272%     -   73s
     0     0 36296.0726    0  307 9756.98781 36296.0726   272%     -   74s
     0     0 36295.8308    0  309 9756.98781 36295.8308   272%     -   74s
H    0     0                    9833.4421850 34613.5746   252%     -   84s
H    0     0                    11500.725850 34613.5746   201%     -   84s
     0     0 34613.5746    0  346 11500.7259 34613.5746   201%     -   84s
     0     0 33963.9956    0  371 11500.7259 33963.9956   195%     -   88s
     0     0 33886.5025    0  418 11500.7259 33886.5025   195%     -   90s
     0     0 33719.4372    0  417 11500.7259 33719.4372   193%     -   92s
     0     0 33634.6171    0  429 11500.7259 33634.6171   192%     -   94s
     0     0 33558.5711    0  479 11500.7259 33558.5711   192%     -   96s
     0     0 33534.9288    0  488 11500.7259 33534.9288   192%     -   97s
     0     0 33523.9155    0  481 11500.7259 33523.9155   191%     -   97s
     0     0 33508.3768    0  487 11500.7259 33508.3768   191%     -   98s
     0     0 33499.8509    0  479 11500.7259 33499.8509   191%     -   98s
     0     0 33498.3764    0  479 11500.7259 33498.3764   191%     -   99s
     0     0 33490.5461    0  483 11500.7259 33490.5461   191%     -   99s
     0     0 33487.4328    0  479 11500.7259 33487.4328   191%     -   99s
     0     0 33486.7866    0  483 11500.7259 33486.7866   191%     -  100s
     0     0 32714.0671    0  472 11500.7259 32714.0671   184%     -  108s
     0     0 32472.5878    0  467 11500.7259 32472.5878   182%     -  111s
H    0     0                    11691.656772 32398.7519   177%     -  112s
H    0     0                    12162.594130 32398.7519   166%     -  112s
H    0     0                    12496.509513 32398.7519   159%     -  112s
     0     0 32398.7519    0  485 12496.5095 32398.7519   159%     -  113s
H    0     0                    12538.760378 32359.2704   158%     -  114s
H    0     0                    12640.285439 32359.2704   156%     -  114s
     0     0 32359.2704    0  490 12640.2854 32359.2704   156%     -  114s
     0     0 32313.9658    0  487 12640.2854 32313.9658   156%     -  115s
     0     0 32306.2549    0  490 12640.2854 32306.2549   156%     -  115s
     0     0 32303.6741    0  498 12640.2854 32303.6741   156%     -  116s
     0     0 32296.3746    0  495 12640.2854 32296.3746   156%     -  116s
     0     0 32293.3322    0  511 12640.2854 32293.3322   155%     -  117s
     0     0 32291.6463    0  511 12640.2854 32291.6463   155%     -  117s
     0     0 32291.2257    0  503 12640.2854 32291.2257   155%     -  117s
     0     0 32057.4879    0  495 12640.2854 32057.4879   154%     -  121s
H    0     0                    17900.504106 31990.1162  78.7%     -  124s
     0     0 31990.1162    0  501 17900.5041 31990.1162  78.7%     -  124s
H    0     0                    17950.126494 31971.7664  78.1%     -  125s
     0     0 31971.7664    0  511 17950.1265 31971.7664  78.1%     -  125s
     0     0 31945.2105    0  460 17950.1265 31945.2105  78.0%     -  127s
     0     0 31928.5943    0  452 17950.1265 31928.5943  77.9%     -  128s
     0     0 31924.0636    0  459 17950.1265 31924.0636  77.8%     -  128s
     0     0 31922.2062    0  455 17950.1265 31922.2062  77.8%     -  128s
     0     0 31921.6984    0  456 17950.1265 31921.6984  77.8%     -  128s
     0     0 31811.2210    0  514 17950.1265 31811.2210  77.2%     -  132s
H    0     0                    18042.372538 31807.0517  76.3%     -  134s
H    0     0                    18043.220194 31807.0517  76.3%     -  135s
H    0     0                    18139.155945 31807.0517  75.4%     -  135s
H    0     0                    18148.716361 31807.0517  75.3%     -  135s
H    0     0                    18418.188725 31807.0517  72.7%     -  135s
H    0     0                    18461.213404 31807.0517  72.3%     -  135s
     0     0 31771.6010    0  526 18461.2134 31771.6010  72.1%     -  137s
     0     0 31761.5411    0  526 18461.2134 31761.5411  72.0%     -  138s
     0     0 31757.7023    0  523 18461.2134 31757.7023  72.0%     -  138s
     0     0 31757.2268    0  526 18461.2134 31757.2268  72.0%     -  138s
     0     0 31714.9516    0  519 18461.2134 31714.9516  71.8%     -  141s
H    0     0                    18588.753322 31714.1285  70.6%     -  141s
     0     0 31704.0062    0  578 18588.7533 31704.0062  70.6%     -  142s
     0     0 31688.5933    0  523 18588.7533 31688.5933  70.5%     -  144s
     0     0 31686.8756    0  531 18588.7533 31686.8756  70.5%     -  144s
     0     0 31685.8812    0  542 18588.7533 31685.8812  70.5%     -  144s
     0     0 31674.8270    0  527 18588.7533 31674.8270  70.4%     -  147s
H    0     0                    18775.216777 31674.5140  68.7%     -  147s
H    0     0                    19023.475298 31674.5140  66.5%     -  148s
H    0     0                    19176.477306 31674.5140  65.2%     -  148s
H    0     0                    19179.534143 31674.5140  65.1%     -  148s
H    0     0                    19204.178522 31674.5140  64.9%     -  148s
     0     0 31672.4734    0  476 19204.1785 31672.4734  64.9%     -  148s
     0     0 31670.9076    0  533 19204.1785 31670.9076  64.9%     -  149s
     0     0 31662.1327    0  529 19204.1785 31662.1327  64.9%     -  150s
H    0     0                    19208.174054 31661.5123  64.8%     -  151s
     0     0 31660.9520    0  471 19208.1741 31660.9520  64.8%     -  151s
     0     0 31649.9885    0  521 19208.1741 31649.9885  64.8%     -  153s
H    0     0                    19259.102906 31648.4651  64.3%     -  158s
H    0     0                    19309.700351 31648.4651  63.9%     -  159s
     0     0 31645.2736    0  532 19309.7004 31645.2736  63.9%     -  159s
     0     0 31643.8564    0  526 19309.7004 31643.8564  63.9%     -  159s
     0     0 31642.5352    0  528 19309.7004 31642.5352  63.9%     -  161s
     0     0 31642.4048    0  528 19309.7004 31642.4048  63.9%     -  162s
H    0     0                    19390.759108 31641.9726  63.2%     -  188s
     0     2 31641.9726    0  528 19390.7591 31641.9726  63.2%     -  189s
     1     4 31323.9401    1  444 19390.7591 31640.9980  63.2%  3537  197s
     3     8 31181.6140    2  439 19390.7591 31321.5423  61.5%  6445  204s
     7    16 30984.6287    3  507 19390.7591 31180.1439  60.8%  6203  210s
    15    32 30695.5540    4  519 19390.7591 31006.2446  59.9%  7039  217s
    31    48 28745.1671    5  292 19390.7591 30694.7765  58.3% 10151  232s
    47    80 28347.0758    6  303 19390.7591 30694.7765  58.3% 11295  239s
H   56    80                    19432.770014 30694.7765  58.0% 10413  239s
H   74    80                    19443.471418 30694.7765  57.9%  8871  239s
    79   112 27301.2882    7  288 19443.4714 30694.7765  57.9%  8721  246s
H   81   112                    19561.829339 30694.7765  56.9%  8662  246s
H   82   112                    19580.961718 30694.7765  56.8%  8640  246s
H   91   112                    19602.255138 30694.7765  56.6%  8335  246s
H   99   112                    19631.038777 30694.7765  56.4%  8250  246s
   111   227 27279.2867    8  288 19631.0388 30694.7765  56.4%  8095  255s
H  153   227                    19665.415000 30694.7765  56.1%  6601  255s
   228   296 26972.9482   11  284 19665.4150 30694.7765  56.1%  5232  262s
   299   358 26957.6799   10  275 19665.4150 30694.7765  56.1%  4720  269s
H  302   358                    19707.007180 30694.7765  55.8%  4691  269s
   369   420 23933.6890   12  279 19707.0072 30694.7765  55.8%  4474  276s
   441   471 26569.2101   12  274 19707.0072 30694.7765  55.8%  4202  283s
H  442   471                    19713.973273 30694.7765  55.7%  4193  283s
H  458   471                    19821.114170 30694.7765  54.9%  4114  283s
   514   540 26690.5176   11  270 19821.1142 30694.7765  54.9%  3921  291s
   595   612 23854.9979   12  266 19821.1142 30694.7765  54.9%  3693  298s
H  621   612                    19832.887389 30694.7765  54.8%  3609  298s
H  663   612                    19865.972735 30694.7765  54.5%  3515  298s
   677   686 26221.3373   13  262 19865.9727 30694.7765  54.5%  3481  304s
   771   758 26279.0358   13  259 19865.9727 30694.7765  54.5%  3237  310s
   855   848 26151.8867   13  257 19865.9727 30694.7765  54.5%  3054  316s
   960   934 23978.2146   14  253 19865.9727 30694.7765  54.5%  2869  323s
  1064   978 infeasible   52      19865.9727 30694.7765  54.5%  2695  331s
  1148  1039 22913.6466   13  226 19865.9727 30694.7765  54.5%  2579  338s
  1246  1106 22632.1233   13  271 19865.9727 30694.7765  54.5%  2460  345s
  1351  1144 23250.4032   15  245 19865.9727 30694.7765  54.5%  2373  353s
H 1439  1144                    19885.659508 30694.7765  54.4%  2305  353s
  1450  1201 20830.7079   15  238 19885.6595 30694.7765  54.4%  2300  361s
  1550  1266 22010.8501   16  219 19885.6595 30426.2096  53.0%  2272  369s
H 1583  1266                    20158.096401 30426.2096  50.9%  2258  369s
  1658  1298 21524.4572   16  233 20158.0964 30426.2096  50.9%  2217  378s
  1758  1349 21645.7799   17  194 20158.0964 30426.2096  50.9%  2197  386s
H 1761  1349                    20485.246507 30426.2096  48.5%  2198  386s
  1841  1424 21425.0800   19  201 20485.2465 30426.2096  48.5%  2197  395s
  1948  1466     cutoff   21      20485.2465 30426.2096  48.5%  2182  405s
  2033  1541 infeasible   22      20485.2465 30426.2096  48.5%  2164  415s
  2136  1592 26176.4017   12  243 20485.2465 30426.2096  48.5%  2154  423s
  2225  1668 infeasible   13      20485.2465 30426.2096  48.5%  2116  433s
  2329  1744 25506.6175   14  413 20485.2465 30426.2096  48.5%  2116  442s
  2449  1809 25467.5740   15  398 20485.2465 30426.2096  48.5%  2093  453s
  2576  1802 24217.5415   18  377 20485.2465 30426.2096  48.5%  2087  463s
  2657  1895 23858.6685   21  404 20485.2465 30426.2096  48.5%  2111  474s
  2796  2003 23607.3875   26  437 20485.2465 28747.3615  40.3%  2099  485s
  2974  2124 22978.7332   38  339 20485.2465 28747.3615  40.3%  2069  497s
  3152  2213     cutoff   52      20485.2465 28747.3615  40.3%  2048  509s
  3318  2269 21294.5763   54  157 20485.2465 27943.8511  36.4%  2031  521s
  3430  2322 25534.9642    7  444 20485.2465 27943.8511  36.4%  2032  533s
  3535  2437 24363.5682    9  419 20485.2465 27851.4486  36.0%  2050  545s
  3688  2469 23251.7481   12  345 20485.2465 27851.4486  36.0%  2048  555s
  3760  2559 23179.2161   13  378 20485.2465 27851.4486  36.0%  2051  569s
  3906  2560 27306.3247    8  528 20485.2465 27851.4486  36.0%  2030  630s
  3908  2561 24940.2759   20  163 20485.2465 27851.4486  36.0%  2029  669s
  3909  2562 21359.9075   68  414 20485.2465 27851.4486  36.0%  2028  691s
  3910  2563 20947.0750   32  388 20485.2465 27851.4486  36.0%  2028  708s
  3911  2563 22459.7096   23  415 20485.2465 27851.4486  36.0%  2027  714s
  3912  2564 22059.3711   30  417 20485.2465 27851.4486  36.0%  2027  718s
  3913  2565 23042.7684   15  471 20485.2465 27851.4486  36.0%  2026  722s
  3914  2565 24875.1023   20  490 20485.2465 27851.4486  36.0%  2025  727s
  3916  2567 22133.0948   58  513 20485.2465 27851.4486  36.0%  2024  731s
  3918  2568 25599.5947   18  447 20485.2465 27851.4486  36.0%  2023  735s
  3921  2570 20639.9437   58  524 20485.2465 27851.4486  36.0%  2022  741s
  3922  2571 21796.6594   50  464 20485.2465 27851.4486  36.0%  2021  746s
  3925  2573 20593.6016   14  535 20485.2465 27851.4486  36.0%  2020  752s
  3926  2573 22019.9207   24  623 20485.2465 27851.4486  36.0%  2019  758s
  3928  2575 25253.3324   24  526 20485.2465 27851.4486  36.0%  2018  761s
  3929  2575 23252.3984   41  526 20485.2465 27851.4486  36.0%  2018  765s
  3931  2577 21633.7692   65  578 20485.2465 27851.4486  36.0%  2017  774s
  3932  2577 24667.0990   22  532 20485.2465 27851.4486  36.0%  2016  777s
  3933  2578 21544.9808   25  541 20485.2465 27851.4486  36.0%  2016  787s
  3934  2579 21823.0836   38  543 20485.2465 27851.4486  36.0%  2015  790s
  3936  2580 23111.7669   31  597 20485.2465 27851.4486  36.0%  2014  796s
  3937  2581 21471.3598   38  541 20485.2465 27851.4486  36.0%  2014  801s
  3939  2582 22350.6609   23  581 20485.2465 27851.4486  36.0%  2013  806s
  3941  2583 21855.0888   11  538 20485.2465 27851.4486  36.0%  2012  849s
  3942  2584 26155.9073    7  538 20485.2465 27851.4486  36.0%  2011  902s
  3943  2587 27851.4486   11  488 20485.2465 27851.4486  36.0%  2071  917s
  3944  2589 27851.4486   12  504 20485.2465 27851.4486  36.0%  2073  926s
  3947  2594 27851.4486   13  441 20485.2465 27851.4486  36.0%  2074  942s
  3953  2604 27851.4486   14  404 20485.2465 27851.4486  36.0%  2081  955s
  3965  2612 27851.4486   14  521 20485.2465 27851.4486  36.0%  2128  981s
  3977  2640 27062.7463   15  417 20485.2465 27851.4486  36.0%  2152 1021s
  4009  2737 26641.4042   16  424 20485.2465 27851.4486  36.0%  2251 1040s
  4118  2732 26607.8293   17  521 20485.2465 27851.4486  36.0%  2362 1048s
  4150  2753 24768.0770   18  237 20485.2465 27851.4486  36.0%  2376 1058s
  4181  2774 22077.9235   19  369 20485.2465 27851.4486  36.0%  2402 1069s
  4213  2795     cutoff   20      20485.2465 27851.4486  36.0%  2429 1077s
  4246  2812 24602.6080   18  271 20485.2465 27851.4486  36.0%  2470 1085s
  4279  2832 24253.2430   19  261 20485.2465 27851.4486  36.0%  2508 1095s
  4321  2842 23927.0218   20  235 20485.2465 27851.4486  36.0%  2537 1107s
  4368  2855 21229.2827   19  253 20485.2465 27851.4486  36.0%  2568 1117s
  4423  2872 23503.1213   21  217 20485.2465 27851.4486  36.0%  2599 1128s
  4488  2874 21710.8932   21  190 20485.2465 27851.4486  36.0%  2614 1139s
  4549  2891     cutoff   20      20485.2465 27851.4486  36.0%  2654 1151s
  4605  2900 23127.5189   22  223 20485.2465 27851.4486  36.0%  2691 1162s
  4668  2908     cutoff   22      20485.2465 27851.4486  36.0%  2711 1173s
  4732  2914 22440.1426   23  237 20485.2465 27851.4486  36.0%  2736 1184s
  4803  2906 21976.2277   24  216 20485.2465 27851.4486  36.0%  2752 1196s
  4882  2905     cutoff   25      20485.2465 27851.4486  36.0%  2785 1207s
  4951  2905     cutoff   24      20485.2465 27851.4486  36.0%  2807 1224s
  5007  2901     cutoff   27      20485.2465 27851.4486  36.0%  2825 1235s
  5065  2915     cutoff   28      20485.2465 27851.4486  36.0%  2859 1247s
  5144  2908 24852.6833   20  361 20485.2465 27134.2309  32.5%  2903 1259s
  5207  2916 23831.6625   21  308 20485.2465 27134.1714  32.5%  2928 1272s
  5272  2914 23728.2975   22  319 20485.2465 27081.3882  32.2%  2974 1286s
  5355  2920 22441.0990   24  250 20485.2465 27081.3882  32.2%  3016 1301s
  5454  2916 22302.1618   26  178 20485.2465 27081.3882  32.2%  3046 1312s
  5515  2910 21936.7094   28  198 20485.2465 27081.3882  32.2%  3085 1326s
  5608  2918 20779.7753   30  300 20485.2465 27081.3882  32.2%  3120 1341s
  5716  2910 20797.3908   31  215 20485.2465 27081.3882  32.2%  3151 1357s
  5835  2927 20615.3169   34  264 20485.2465 27081.3882  32.2%  3197 1379s
  5973  2913 24055.6561   19  267 20485.2465 27081.3882  32.2%  3227 1395s
  6151  2869     cutoff   21      20485.2465 26781.0611  30.7%  3252 1411s
  6280  2877     cutoff   22      20485.2465 26131.5050  27.6%  3261 1427s
  6410  2860 21857.5958   25  179 20485.2465 26131.5050  27.6%  3279 1445s
  6567  2860 22832.4785   21  378 20485.2465 26131.5050  27.6%  3312 1467s
  6734  2866 21968.0054   24  277 20485.2465 26131.5050  27.6%  3334 1485s
  6967  2848     cutoff   29      20485.2465 25910.6738  26.5%  3337 1506s
  7168  2857     cutoff   26      20485.2465 25893.9101  26.4%  3359 1530s
  7389  2846 21750.0977   22  296 20485.2465 25893.9101  26.4%  3373 1553s
  7586  2841 21139.7566   30  196 20485.2465 25629.8770  25.1%  3409 1573s
  7759  2846     cutoff   25      20485.2465 25589.8665  24.9%  3420 1595s
  7999  2829     cutoff   23      20485.2465 25589.8665  24.9%  3438 1617s
  8240  2823     cutoff   22      20485.2465 25383.4140  23.9%  3462 1642s
  8500  2798 21014.7141   20  317 20485.2465 25366.8113  23.8%  3506 1665s
  8791  2781 21014.7082   21  316 20485.2465 25333.2717  23.7%  3528 1689s
  9073  2747 22017.9791   24  226 20485.2465 25333.2717  23.7%  3553 1715s
  9352  2714 21862.9290   28  140 20485.2465 25333.2717  23.7%  3559 1747s
  9642  2655 21780.4928   21  413 20485.2465 24902.0807  21.6%  3591 1775s
  9957  2625     cutoff   26      20485.2465 24731.9810  20.7%  3638 1806s
 10301  2639     cutoff   22      20485.2465 24536.9471  19.8%  3661 1834s
 10708  2577 21582.4051   24  396 20485.2465 24489.5122  19.5%  3681 1862s
 11162  2538 21878.8537   22  169 20485.2465 24284.2005  18.5%  3681 1891s
 11580  2413     cutoff   24      20485.2465 24198.5180  18.1%  3708 1925s
 11971  2470     cutoff   34      20485.2465 23993.7316  17.1%  3740 1959s
 12419  2489     cutoff   33      20485.2465 23914.4834  16.7%  3761 1991s
 12862  2506 21288.3634   23  282 20485.2465 23726.2615  15.8%  3786 2027s
 13310  2525 20749.9117   26  252 20485.2465 23694.1899  15.7%  3822 2062s
 13873  2542     cutoff   29      20485.2465 23489.7421  14.7%  3829 2099s
 14448  2543     cutoff   22      20485.2465 23245.5063  13.5%  3835 2139s
 15126  2506     cutoff   25      20485.2465 23067.6717  12.6%  3824 2178s
 15875  2505     cutoff   26      20485.2465 22856.6844  11.6%  3807 2209s
 15952  2511 20998.6825   26  218 20485.2465 22776.0150  11.2%  3806 2246s
 16466  2454     cutoff   30      20485.2465 22776.0150  11.2%  3768 2291s
 17496  2333     cutoff   36      20485.2465 22347.0527  9.09%  3698 2333s
 18735  2026 20582.1662   32  182 20485.2465 22076.5063  7.77%  3599 2374s
 20441  1276     cutoff   25      20485.2465 21765.8009  6.25%  3435 2410s
 23112    49     cutoff   31      20485.2465 21357.2538  4.26%  3145 2427s

Cutting planes:
  Learned: 3
  MIR: 601
  Flow cover: 2015
  RLT: 15
  Relax-and-lift: 251

Explored 25373 nodes (73734401 simplex iterations) in 2427.33 seconds (7900.94 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 20485.2 20158.1 19885.7 ... 19631

Optimal solution found (tolerance 1.00e-04)
Best objective 2.048524650745e+04, best bound 2.048524650745e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2427.36s
  Master Objective (UB) = 20485.25, θ = 150444.62
  Upper Bound (UB) = 20485.25

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 150444.62
  [DEBUG]   ✓ Scenario 0: θ = 150444.62 ≤ Q = 150444.62 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 150444.62 ≤ Q = 150444.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 150444.62 ≤ Q = 150444.62 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 150444.62 ≤ Q = 150444.62 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 150444.62 ≤ Q = 150444.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 150444.62 ≤ Q = 150444.62 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 150444.62 ≤ Q = 150444.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 150444.62 ≤ Q = 150444.62 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x3572a9b5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xca8d564b
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.548810e+13
Presolve removed 2571 rows and 1864 columns
Presolve time: 0.00s
Presolved: 522 rows, 525 columns, 1472 nonzeros
Found heuristic solution: objective 8224964.1389
Variable types: 355 continuous, 170 integer (170 binary)

Root relaxation: objective -1.421600e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -142159.98    0  124 8224964.14 -142159.98   102%     -    0s
H    0     0                    -107256.7438 -142159.98  32.5%     -    0s
H    0     0                    -107694.2120 -142159.98  32.0%     -    0s
     0     0 -114675.77    0   84 -107694.21 -114675.77  6.48%     -    0s
H    0     0                    -111571.0310 -114673.29  2.78%     -    0s
     0     0 -114163.59    0   84 -111571.03 -114163.59  2.32%     -    0s
H    0     0                    -111874.9682 -114163.22  2.05%     -    0s
     0     0 -114163.22    0   84 -111874.97 -114163.22  2.05%     -    0s
H    0     0                    -112938.7201 -114163.22  1.08%     -    0s
H    0     0                    -112945.5072 -113988.00  0.92%     -    0s
     0     0 -113988.00    0   83 -112945.51 -113988.00  0.92%     -    0s
     0     0 -113982.32    0   83 -112945.51 -113982.32  0.92%     -    0s
     0     2 -113982.32    0   83 -112945.51 -113982.32  0.92%     -    0s
H   40    23                    -113296.0271 -113591.36  0.26%   8.8    0s
H   43    22                    -113326.4865 -113591.36  0.23%   8.5    0s
H   49    19                    -113411.3042 -113567.80  0.14%   8.1    0s
*  148    14              14    -113418.3151 -113469.58  0.05%   5.9    0s
*  153    14              14    -113421.2672 -113469.58  0.04%   5.9    0s
*  202     1              13    -113422.7765 -113426.94  0.00%   5.5    0s
*  204     1              13    -113425.7286 -113425.73  0.00%   5.5    0s

Cutting planes:
  Gomory: 22
  Implied bound: 2
  MIR: 161

Explored 206 nodes (1600 simplex iterations) in 0.09 seconds (0.07 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -113426 -113423 -113421 ... -111571
No other solutions better than -113426

Optimal solution found (tolerance 1.00e-04)
Best objective -1.134257286409e+05, best bound -1.134257286409e+05, gap 0.0000%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 147580.64
  Scenario: 10 demand increases, 50 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -113425.73
  [DEBUG]   S×d_nominal = 261006.37
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 261006.37 + -113425.73 = 147580.64
  [DEBUG]   Current θ from Master = 150444.62
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2863.99 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 17621.26
  Lower Bound (LB) = 17621.26
  Gap (UB-LB) = 2863.9852, Absolute Gap = 2863.9852, Relative Gap = 0.139807
  Not converged yet (gap = 2863.99 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 10 increases, 50 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394733 nonzeros
Model fingerprint: 0x3de2c73d
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 59165 rows and 24025 columns
Presolve time: 1.11s
Presolved: 79828 rows, 34395 columns, 488480 nonzeros
Variable types: 32136 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -366999.6780
Found heuristic solution: objective -194531.7474

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 79828 rows, 34395 columns, 488480 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   35918   -8.7558087e+04   0.000000e+00   3.794545e+07      5s
   53825    2.3833325e+03   0.000000e+00   7.710917e+08     10s
   62802    9.6020367e+03   0.000000e+00   3.351729e+06     15s
   71804    1.6110417e+04   0.000000e+00   3.869801e+06     20s
   79037    2.1143816e+04   0.000000e+00   3.524797e+06     25s
   85415    2.7254796e+04   0.000000e+00   1.205331e+07     30s
Concurrent spin time: 6.10s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 4.912253e+04, 87005 iterations, 36.60 seconds (68.68 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 49122.5286    0  169 -194531.75 49122.5286   125%     -   38s
H    0     0                    -185709.8836 49122.5286   126%     -   38s
H    0     0                    -109399.7749 49122.5286   145%     -   38s
H    0     0                    -105439.1305 49122.5286   147%     -   38s
H    0     0                    -92114.72202 49122.5286   153%     -   38s
H    0     0                    -43358.78551 49122.5286   213%     -   38s
H    0     0                    -6825.137224 49122.5286   820%     -   38s
H    0     0                    -2772.434098 49122.5286  1872%     -   38s
H    0     0                    6327.5178156 49122.5286   676%     -   39s
H    0     0                    7517.8967536 49122.5286   553%     -   39s
H    0     0                    8513.4252030 49122.5286   477%     -   39s
H    0     0                    12388.346062 49122.5286   297%     -   39s
H    0     0                    12590.873328 49122.5286   290%     -   39s
H    0     0                    13338.626497 49122.5286   268%     -   39s
H    0     0                    13814.144226 49122.5286   256%     -   40s
     0     0 42948.5337    0  306 13814.1442 42948.5337   211%     -   51s
     0     0 42528.5802    0  299 13814.1442 42528.5802   208%     -   57s
     0     0 42528.5802    0  275 13814.1442 42528.5802   208%     -   59s
     0     0 42528.5802    0  274 13814.1442 42528.5802   208%     -   59s
     0     0 42528.5802    0  274 13814.1442 42528.5802   208%     -   59s
     0     0 42528.5802    0  274 13814.1442 42528.5802   208%     -   59s
     0     0 39466.8814    0  288 13814.1442 39466.8814   186%     -   74s
H    0     0                    18467.001583 39466.8814   114%     -   74s
H    0     0                    18775.642448 39466.8814   110%     -   74s
H    0     0                    18821.097543 39466.8814   110%     -   74s
H    0     0                    18856.187091 39466.8814   109%     -   74s
H    0     0                    18886.553770 39466.8814   109%     -   74s
     0     0 39002.3384    0  301 18886.5538 39002.3384   107%     -   80s
     0     0 38808.2393    0  301 18886.5538 38808.2393   105%     -   85s
     0     0 38769.0234    0  367 18886.5538 38769.0234   105%     -   87s
     0     0 38617.1114    0  413 18886.5538 38617.1114   104%     -   91s
     0     0 38591.3902    0  369 18886.5538 38591.3902   104%     -   92s
     0     0 38585.7354    0  366 18886.5538 38585.7354   104%     -   93s
     0     0 38585.7206    0  366 18886.5538 38585.7206   104%     -   93s
H    0     0                    19025.677234 36012.0653  89.3%     -  122s
H    0     0                    19062.059538 36012.0653  88.9%     -  122s
H    0     0                    19068.238762 36012.0653  88.9%     -  122s
H    0     0                    19078.563689 36012.0653  88.8%     -  122s
H    0     0                    19093.620453 36012.0653  88.6%     -  122s
H    0     0                    19156.975391 36012.0653  88.0%     -  122s
H    0     0                    19200.194387 36012.0653  87.6%     -  122s
H    0     0                    19243.132156 36012.0653  87.1%     -  122s
H    0     0                    19248.578015 36012.0653  87.1%     -  122s
H    0     0                    19263.616681 36012.0653  86.9%     -  122s
H    0     0                    19309.002808 36012.0653  86.5%     -  122s
     0     0 36012.0653    0  391 19309.0028 36012.0653  86.5%     -  122s
     0     0 35657.8995    0  487 19309.0028 35657.8995  84.7%     -  128s
     0     0 35398.9699    0  338 19309.0028 35398.9699  83.3%     -  133s
     0     0 35267.3740    0  340 19309.0028 35267.3740  82.6%     -  136s
     0     0 35221.6981    0  466 19309.0028 35221.6981  82.4%     -  138s
     0     0 35187.3406    0  385 19309.0028 35187.3406  82.2%     -  140s
     0     0 35168.0916    0  382 19309.0028 35168.0916  82.1%     -  141s
     0     0 35166.9081    0  386 19309.0028 35166.9081  82.1%     -  142s
H    0     0                    19309.384816 33889.6340  75.5%     -  158s
H    0     0                    19315.785449 33889.6340  75.5%     -  158s
     0     0 33889.6340    0  432 19315.7854 33889.6340  75.5%     -  158s
H    0     0                    19337.294575 33889.4095  75.3%     -  159s
H    0     0                    19348.115839 33889.4095  75.2%     -  159s
H    0     0                    19353.278082 33889.4095  75.1%     -  159s
     0     0 33449.2655    0  497 19353.2781 33449.2655  72.8%     -  165s
     0     0 33148.2210    0  482 19353.2781 33148.2210  71.3%     -  170s
     0     0 32931.6089    0  488 19353.2781 32931.6089  70.2%     -  175s
     0     0 32875.7245    0  502 19353.2781 32875.7245  69.9%     -  178s
     0     0 32842.5007    0  509 19353.2781 32842.5007  69.7%     -  180s
     0     0 32819.3285    0  514 19353.2781 32819.3285  69.6%     -  182s
     0     0 32800.9626    0  516 19353.2781 32800.9626  69.5%     -  184s
     0     0 32784.8171    0  519 19353.2781 32784.8171  69.4%     -  185s
     0     0 32781.4391    0  526 19353.2781 32781.4391  69.4%     -  186s
     0     0 32758.4840    0  520 19353.2781 32758.4840  69.3%     -  187s
     0     0 32757.7361    0  519 19353.2781 32757.7361  69.3%     -  187s
     0     0 32489.3977    0  519 19353.2781 32489.3977  67.9%     -  193s
     0     0 32384.1908    0  519 19353.2781 32384.1908  67.3%     -  195s
     0     0 32336.4938    0  525 19353.2781 32336.4938  67.1%     -  197s
     0     0 32313.0937    0  526 19353.2781 32313.0937  67.0%     -  199s
     0     0 32305.7928    0  517 19353.2781 32305.7928  66.9%     -  200s
     0     0 32301.6010    0  526 19353.2781 32301.6010  66.9%     -  200s
     0     0 32297.1024    0  528 19353.2781 32297.1024  66.9%     -  201s
     0     0 32294.7514    0  528 19353.2781 32294.7514  66.9%     -  201s
     0     0 32293.2189    0  529 19353.2781 32293.2189  66.9%     -  202s
     0     0 32052.7839    0  451 19353.2781 32052.7839  65.6%     -  206s
     0     0 31990.0511    0  509 19353.2781 31990.0511  65.3%     -  210s
     0     0 31979.6480    0  459 19353.2781 31979.6480  65.2%     -  212s
     0     0 31973.9942    0  458 19353.2781 31973.9942  65.2%     -  212s
     0     0 31970.8774    0  457 19353.2781 31970.8774  65.2%     -  213s
     0     0 31968.7672    0  453 19353.2781 31968.7672  65.2%     -  213s
     0     0 31908.7304    0  560 19353.2781 31908.7304  64.9%     -  216s
     0     0 31892.0774    0  580 19353.2781 31892.0774  64.8%     -  218s
     0     0 31883.7104    0  505 19353.2781 31883.7104  64.7%     -  219s
     0     0 31880.3688    0  461 19353.2781 31880.3688  64.7%     -  220s
     0     0 31878.6852    0  544 19353.2781 31878.6852  64.7%     -  221s
     0     0 31842.9135    0  470 19353.2781 31842.9135  64.5%     -  224s
     0     0 31827.8984    0  468 19353.2781 31827.8984  64.5%     -  227s
     0     0 31823.3162    0  475 19353.2781 31823.3162  64.4%     -  228s
     0     0 31817.3340    0  466 19353.2781 31817.3340  64.4%     -  229s
     0     0 31816.8417    0  477 19353.2781 31816.8417  64.4%     -  229s
     0     0 31803.5487    0  468 19353.2781 31803.5487  64.3%     -  232s
     0     0 31797.8351    0  471 19353.2781 31797.8351  64.3%     -  233s
     0     0 31796.2896    0  476 19353.2781 31796.2896  64.3%     -  234s
     0     0 31790.7398    0  469 19353.2781 31790.7398  64.3%     -  235s
H    0     0                    19355.208507 31789.6312  64.2%     -  238s
H    0     0                    19373.728046 31789.6312  64.1%     -  238s
H    0     0                    19388.286397 31789.6312  64.0%     -  238s
H    0     0                    19413.208948 31789.6312  63.8%     -  238s
H    0     0                    19415.869783 31789.6312  63.7%     -  238s
H    0     0                    19428.641746 31789.6312  63.6%     -  238s
     0     0 31789.2627    0  474 19428.6417 31789.2627  63.6%     -  239s
     0     0 31783.9267    0  470 19428.6417 31783.9267  63.6%     -  240s
     0     0 31776.2816    0  471 19428.6417 31776.2816  63.6%     -  241s
     0     0 31774.9473    0  465 19428.6417 31774.9473  63.5%     -  242s
     0     0 31759.1324    0  452 19428.6417 31759.1324  63.5%     -  244s
     0     0 31758.7872    0  452 19428.6417 31758.7872  63.5%     -  245s
H    0     0                    19441.457696 31758.7872  63.4%     -  289s
H    0     0                    19484.731776 31758.7872  63.0%     -  289s
H    0     0                    19498.060906 31758.7872  62.9%     -  289s
H    0     2                    19739.184191 31758.7872  60.9%     -  300s
     0     2 31758.7872    0  452 19739.1842 31758.7872  60.9%     -  300s
     1     4 31594.0231    1  448 19739.1842 31758.1721  60.9%  4738  308s
     3     8 31486.8478    2  444 19739.1842 31590.7585  60.0%  8442  317s
     7    16 31164.4869    3  456 19739.1842 31481.2386  59.5%  8544  327s
    15    32 30917.6543    4  510 19739.1842 31164.3809  57.9%  8063  338s
    31    48 30289.4480    5  389 19739.1842 30917.6185  56.6% 13311  365s
    47    80 28425.3419    6  364 19739.1842 30917.6185  56.6% 12873  380s
H   51    80                    19823.663397 30917.6185  56.0% 12678  380s
H   55    80                    19861.278984 30917.6185  55.7% 12427  380s
    79   113 28161.9402    7  343 19861.2790 30917.6185  55.7% 10147  402s
H   84   113                    19868.423709 30917.6185  55.6%  9816  402s
H   87   113                    19920.079196 30917.6185  55.2%  9722  402s
H  104   113                    19972.081893 30917.6185  54.8%  8972  402s
H  105   113                    19989.002640 30917.6185  54.7%  8911  402s
   112   197 27496.6641    8  346 19989.0026 30917.6185  54.7%  8642  417s
H  171   197                    20018.887740 30917.6185  54.4%  7339  417s
   196   264 26724.7215    9  325 20018.8877 30917.6185  54.4%  6885  429s
   263   334 26408.6124    9  354 20018.8877 30917.6185  54.4%  6330  441s
   333   398 26561.0444    9  340 20018.8877 30917.6185  54.4%  5736  453s
   403   447 24684.5140   10  335 20018.8877 30917.6185  54.4%  5290  467s
   456   498 25302.4559   21  238 20018.8877 30917.6185  54.4%  5086  480s
   515   567 26348.3378   10  353 20018.8877 30917.6185  54.4%  4875  490s
   586   638 25437.3958   10  349 20018.8877 30917.6185  54.4%  4680  501s
   665   699 26306.2465   11  358 20018.8877 30917.6185  54.4%  4460  511s
   751   747 26254.7691   12  353 20018.8877 30917.6185  54.4%  4195  526s
   807   788 26106.6570   13  444 20018.8877 30917.6185  54.4%  4084  537s
   876   841 25479.1714   15  310 20018.8877 30917.6185  54.4%  3958  548s
   961   866 25226.0925   16  273 20018.8877 30917.6185  54.4%  3782  557s
   996   892 25018.3456   17  367 20018.8877 30917.6185  54.4%  3764  567s
  1036   923 24749.0661   17  194 20018.8877 30917.6185  54.4%  3732  579s
  1087   961 24671.8280   16  247 20018.8877 30917.6185  54.4%  3668  589s
  1153  1013 25265.9259   16  210 20018.8877 30917.6185  54.4%  3601  601s
  1230  1061 24346.1446   18  209 20018.8877 30917.6185  54.4%  3530  613s
  1312  1108 24730.9772   18  199 20018.8877 30917.6185  54.4%  3465  625s
  1395  1182 24913.6526   18  376 20018.8877 30917.6185  54.4%  3405  638s
  1497  1271 24345.6231   19  183 20018.8877 30917.6185  54.4%  3317  650s
  1612  1348 24133.1604   21  163 20018.8877 30917.6185  54.4%  3223  663s
  1749  1448 24026.7957   23  198 20018.8877 30917.6185  54.4%  3115  677s
  1913  1564 23635.2650   27  192 20018.8877 30917.6185  54.4%  2994  690s
  2103  1677 23193.6065   37  136 20018.8877 30917.6185  54.4%  2860  705s
  2302  1776 22803.6475   42  148 20018.8877 30917.6185  54.4%  2735  722s
  2487  1849 22486.9273   49  122 20018.8877 30917.6185  54.4%  2655  737s
  2660  1940 21713.4172   55  123 20018.8877 30663.9837  53.2%  2626  753s
  2795  2023 21466.0778   65  106 20018.8877 30663.9837  53.2%  2631  771s
  2924  2083 20758.5703   74   80 20018.8877 30663.9837  53.2%  2650  789s
  3055  2104 20848.1560   46  136 20018.8877 30023.6190  50.0%  2669  806s
H 3087  2103                    20061.354960 30023.6190  49.7%  2699  806s
  3092  2166     cutoff   47      20061.3550 30023.6190  49.7%  2704  824s
  3207  2231 infeasible   58      20061.3550 29756.0047  48.3%  2737  843s
H 3208  2230                    20077.683668 29756.0047  48.2%  2736  843s
  3312  2305     cutoff   51      20077.6837 29699.0245  47.9%  2764  864s
  3473  2361 27632.8368    6  333 20077.6837 29436.5337  46.6%  2775  883s
  3554  2438 27377.2107    7  331 20077.6837 29364.9710  46.3%  2789  904s
  3686  2544 20986.6498    9  306 20077.6837 29360.6763  46.2%  2832  927s
  3866  2666 infeasible   11      20077.6837 29360.6763  46.2%  2839  949s
  4076  2667 20709.5464   14  452 20077.6837 29334.0732  46.1%  2833 1008s
  4078  2668 22836.5727   28  144 20077.6837 29334.0732  46.1%  2832 1049s
  4079  2669 26242.6100   14  321 20077.6837 29334.0732  46.1%  2831 1073s
  4080  2670 25590.5957   26  391 20077.6837 29334.0732  46.1%  2831 1084s
  4081  2670 26904.2308    7  379 20077.6837 29334.0732  46.1%  2830 1092s
  4082  2671 27351.6655    8  407 20077.6837 29334.0732  46.1%  2829 1100s
  4083  2672 24126.6265   22  488 20077.6837 29334.0732  46.1%  2829 1107s
  4084  2672 21689.0134   43  439 20077.6837 29334.0732  46.1%  2828 1114s
  4085  2673 21208.8425   19  427 20077.6837 29334.0732  46.1%  2827 1119s
  4086  2674 27160.1658   13  487 20077.6837 29334.0732  46.1%  2826 1124s
  4087  2674 27173.3087    7  499 20077.6837 29334.0732  46.1%  2826 1128s
  4088  2675 25375.1929   10  515 20077.6837 29334.0732  46.1%  2825 1130s
  4092  2678 22756.7242   13  461 20077.6837 29334.0732  46.1%  2822 1136s
  4095  2680 22000.3634   14  458 20077.6837 29334.0732  46.1%  2820 1141s
  4096  2680 24764.4422   16  493 20077.6837 29334.0732  46.1%  2820 1149s
  4097  2681 25743.8414   16  449 20077.6837 29334.0732  46.1%  2819 1151s
  4099  2682 24319.2548   17  443 20077.6837 29334.0732  46.1%  2818 1155s
  4101  2684 24500.4398   26  466 20077.6837 29334.0732  46.1%  2816 1161s
  4103  2685 21195.5698   24  518 20077.6837 29334.0732  46.1%  2815 1165s
  4105  2686 29014.7495    5  466 20077.6837 29334.0732  46.1%  2813 1172s
  4107  2688 23726.3994   24  516 20077.6837 29334.0732  46.1%  2812 1175s
  4109  2689 28060.7260    9  513 20077.6837 29334.0732  46.1%  2811 1182s
  4111  2690 21318.7705   56  579 20077.6837 29334.0732  46.1%  2809 1187s
  4112  2691 24055.1798   18  518 20077.6837 29334.0732  46.1%  2809 1192s
  4114  2692 24426.1830   22  523 20077.6837 29334.0732  46.1%  2807 1196s
  4115  2693 21221.1776   24  471 20077.6837 29334.0732  46.1%  2807 1201s
  4117  2694 28650.5792    7  522 20077.6837 29334.0732  46.1%  2805 1208s
  4118  2695 22376.6048   50  466 20077.6837 29334.0732  46.1%  2805 1210s
  4119  2696 27678.0866    7  500 20077.6837 29334.0732  46.1%  2804 1215s
  4121  2697 28650.5792    7  500 20077.6837 29334.0732  46.1%  2802 1220s
  4122  2698 22632.0453   16  569 20077.6837 29334.0732  46.1%  2802 1225s
  4123  2698 21094.2896   20  569 20077.6837 29334.0732  46.1%  2801 1267s
  4124  2699 22455.5354   31  569 20077.6837 29334.0732  46.1%  2800 1288s
  4125  2702 29334.0732   14  435 20077.6837 29334.0732  46.1%  2873 1313s
  4126  2704 28283.3472   15  503 20077.6837 29334.0732  46.1%  2876 1324s
  4129  2709 27935.9172   16  500 20077.6837 29334.0732  46.1%  2878 1342s
  4135  2719 27682.0622   17  506 20077.6837 29334.0732  46.1%  2892 1363s
  4147  2727 27851.7050   17  385 20077.6837 29334.0732  46.1%  2933 1394s
  4159  2753 26946.8417   18  308 20077.6837 29334.0732  46.1%  2984 1439s
  4191  2853 25264.7193   19  300 20077.6837 29334.0732  46.1%  3072 1465s
  4304  2873 23510.6975   22  285 20077.6837 29059.2932  44.7%  3242 1480s
  4382  2902 23287.3927   23  267 20077.6837 29053.7950  44.7%  3312 1493s
  4444  2906 23956.4618   22  288 20077.6837 29053.7950  44.7%  3367 1504s
  4480  2915 22761.6616   24  248 20077.6837 29053.7950  44.7%  3401 1515s
  4514  2921     cutoff   23      20077.6837 29053.7950  44.7%  3438 1530s
  4552  2926 23474.6398   23  343 20077.6837 29053.7950  44.7%  3464 1542s
  4593  2929     cutoff   25      20077.6837 29053.7950  44.7%  3499 1555s
  4628  2942 20401.4217   26  188 20077.6837 29053.7950  44.7%  3523 1567s
  4674  2958 22301.5784   26  262 20077.6837 29053.7950  44.7%  3556 1579s
  4722  2970     cutoff   27      20077.6837 29053.7950  44.7%  3573 1590s
  4768  2969 20633.2626   28  192 20077.6837 28955.9399  44.2%  3588 1602s
  4831  2970     cutoff   29      20077.6837 28488.5362  41.9%  3598 1613s
  4874  2993     cutoff   30      20077.6837 28488.5362  41.9%  3618 1623s
  4927  2998 21468.9447   29  161 20077.6837 28488.5362  41.9%  3654 1631s
  4969  3008 21233.7972   30  157 20077.6837 28488.5362  41.9%  3664 1644s
  5018  3012 21112.8685   31  211 20077.6837 28488.5362  41.9%  3668 1655s
  5056  3021 20985.8985   31  144 20077.6837 28488.5362  41.9%  3682 1673s
  5108  3026 21061.8370   32  214 20077.6837 28488.5362  41.9%  3686 1688s
  5166  3029 20803.0646   32  144 20077.6837 28488.5362  41.9%  3692 1700s
  5212  3036 20433.2644   33  145 20077.6837 28488.5362  41.9%  3702 1721s
  5255  3041     cutoff   34      20077.6837 28488.5362  41.9%  3719 1735s
  5326  3038 20857.1056   34  314 20077.6837 28488.5362  41.9%  3743 1749s
  5409  3033 20828.6241   35  261 20077.6837 28488.5362  41.9%  3767 1773s
  5509  3038     cutoff   39      20077.6837 28488.5362  41.9%  3787 1791s
  5602  3045 24412.3086   19  282 20077.6837 28488.5362  41.9%  3823 1808s
  5700  3050 23633.7768   21  257 20077.6837 28488.5362  41.9%  3847 1833s
  5807  3045 22989.0073   24  219 20077.6837 28488.5362  41.9%  3872 1855s
  5926  3054 21168.8635   27  205 20077.6837 27087.6323  34.9%  3898 1874s
  6057  3038     cutoff   31      20077.6837 27086.3943  34.9%  3936 1895s
  6206  3044 23983.4148   24  324 20077.6837 27086.3943  34.9%  3957 1916s
  6327  3060 22859.9908   28  199 20077.6837 27086.3943  34.9%  4001 1938s
  6463  3082 22080.7692   30  103 20077.6837 27086.3943  34.9%  4042 1962s
  6620  3090 20219.2276   33  230 20077.6837 26386.1359  31.4%  4073 1983s
  6816  3111 23492.7971   26  413 20077.6837 26250.3577  30.7%  4086 2006s
  7015  3085 20744.8026   27  349 20077.6837 26197.9415  30.5%  4098 2036s
  7202  3079 20318.4907   28  321 20077.6837 26082.8366  29.9%  4120 2060s
  7374  3074 22846.5911   24  361 20077.6837 25872.0638  28.9%  4160 2084s
  7569  3051 20861.3500   28  243 20077.6837 25823.2934  28.6%  4182 2111s
  7759  3052 21435.5213   24  333 20077.6837 25823.2934  28.6%  4207 2136s
  7984  3046     cutoff   26      20077.6837 25352.0707  26.3%  4214 2164s
  8256  3064 infeasible   22      20077.6837 25352.0707  26.3%  4211 2191s
  8554  3045     cutoff   27      20077.6837 25264.4647  25.8%  4221 2230s
  8860  3022     cutoff   22      20077.6837 25250.2345  25.8%  4234 2258s
  9204  3058 20278.7131   28  244 20077.6837 25028.7530  24.7%  4239 2286s
  9614  3041     cutoff   31      20077.6837 24700.5741  23.0%  4210 2320s
 10030  2960 22284.5165   25  311 20077.6837 24657.5552  22.8%  4186 2355s
 10365  2943 20412.8004   30  102 20077.6837 24651.3860  22.8%  4217 2394s
 10764  2910     cutoff   30      20077.6837 24251.1657  20.8%  4217 2429s
 11154  2879 21222.8718   27  202 20077.6837 24251.1657  20.8%  4238 2461s
 11575  2869 20290.0486   24  322 20077.6837 23986.5462  19.5%  4251 2497s
 12090  2750 21010.6134   25  360 20077.6837 23791.9717  18.5%  4244 2534s
 12593  2799 20705.6794   37  118 20077.6837 23641.2473  17.7%  4243 2572s
 13148  2869 infeasible   27      20077.6837 23436.8283  16.7%  4223 2612s
 13638  2913 21541.5335   27  447 20077.6837 23322.9481  16.2%  4237 2652s
 14156  3012 21114.4247   26  390 20077.6837 23189.1661  15.5%  4248 2695s
 14737  3112     cutoff   25      20077.6837 22990.0683  14.5%  4238 2741s
 15381  3126 21307.2873   27  270 20077.6837 22842.2898  13.8%  4207 2784s
 16049  3102 21110.9730   29  460 20077.6837 22702.1463  13.1%  4193 2833s
 16751  3115     cutoff   24      20077.6837 22404.0378  11.6%  4179 2884s
 17467  3122     cutoff   29      20077.6837 22263.2070  10.9%  4156 2921s
 17568  3107     cutoff   31      20077.6837 22186.8148  10.5%  4151 2969s
 18364  3113 20907.4645   38   77 20077.6837 22143.9722  10.3%  4090 3018s
*19116  3011              38    20265.508985 22008.7993  8.60%  4023 3018s
H19716  2715                    20272.778508 21781.6142  7.44%  3966 3066s
H20456  2679                    20300.776266 21749.9604  7.14%  3881 3066s
 21428  1694     cutoff   34      20300.7763 21516.6627  5.99%  3787 3109s
 23751    19 20671.3118   40  175 20300.7763 21120.1650  4.04%  3532 3139s

Cutting planes:
  Learned: 1
  Projected implied bound: 85
  MIR: 1038
  Flow cover: 2987
  RLT: 16
  Relax-and-lift: 345

Explored 26437 nodes (85719789 simplex iterations) in 3139.61 seconds (9835.59 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 20300.8 20272.8 20265.5 ... 19861.3

Optimal solution found (tolerance 1.00e-04)
Best objective 2.030077626558e+04, best bound 2.030077626558e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3139.63s
  Master Objective (UB) = 20300.78, θ = 150362.80
  Upper Bound (UB) = 20300.78

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 150362.80
  [DEBUG]   ✓ Scenario 0: θ = 150362.80 ≤ Q = 150362.80 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 150362.80 ≤ Q = 150362.80 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 150362.80 ≤ Q = 150362.80 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 150362.80 ≤ Q = 150362.80 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 150362.80 ≤ Q = 150362.80 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 150362.80 ≤ Q = 150362.80 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 150362.80 ≤ Q = 150362.80 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 150362.80 ≤ Q = 150362.80 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 150362.80 ≤ Q = 150362.80 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x55c47da5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x55c47da5
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.549846e+13
Presolve removed 2571 rows and 1864 columns
Presolve time: 0.00s
Presolved: 522 rows, 525 columns, 1472 nonzeros
Found heuristic solution: objective 8219523.3853
Variable types: 355 continuous, 170 integer (170 binary)

Root relaxation: objective -1.422852e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -142285.15    0  124 8219523.39 -142285.15   102%     -    0s
H    0     0                    -107338.5714 -142285.15  32.6%     -    0s
H    0     0                    -107776.0396 -142285.15  32.0%     -    0s
     0     0 -114831.74    0   82 -107776.04 -114831.74  6.55%     -    0s
H    0     0                    -111844.2807 -114702.13  2.56%     -    0s
     0     0 -114209.49    0   86 -111844.28 -114209.49  2.11%     -    0s
H    0     0                    -112336.5986 -114197.72  1.66%     -    0s
     0     0 -114160.04    0   86 -112336.60 -114160.04  1.62%     -    0s
H    0     0                    -113053.5748 -114160.04  0.98%     -    0s
H    0     0                    -113117.4782 -114160.04  0.92%     -    0s
     0     0 -113993.96    0   86 -113117.48 -113993.96  0.77%     -    0s
H    0     0                    -113140.9864 -113968.35  0.73%     -    0s
     0     0 -113968.35    0   86 -113140.99 -113968.35  0.73%     -    0s
     0     0 -113961.62    0   86 -113140.99 -113961.62  0.73%     -    0s
     0     0 -113774.51    0   80 -113140.99 -113774.51  0.56%     -    0s
     0     0 -113723.50    0   80 -113140.99 -113723.50  0.51%     -    0s
     0     0 -113723.50    0   80 -113140.99 -113723.50  0.51%     -    0s
     0     0 -113587.45    0   78 -113140.99 -113587.45  0.39%     -    0s
     0     0 -113565.58    0   78 -113140.99 -113565.58  0.38%     -    0s
     0     2 -113565.58    0   78 -113140.99 -113565.58  0.38%     -    0s
H   81    21                    -113150.1864 -113246.31  0.08%  11.0    0s
*  254    11              25    -113151.3293 -113198.88  0.04%   5.8    0s

Cutting planes:
  Gomory: 28
  Implied bound: 12
  MIR: 179
  Flow cover: 8
  RLT: 26

Explored 315 nodes (2220 simplex iterations) in 0.10 seconds (0.08 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -113151 -113150 -113141 ... 1.54985e+13
No other solutions better than -113151

Optimal solution found (tolerance 1.00e-04)
Best objective -1.131513293446e+05, best bound -1.131513293446e+05, gap 0.0000%
  Subproblem solved in 0.12s
  Worst-case operational profit (Z_SP) = 147855.04
  Scenario: 33 demand increases, 27 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -113151.33
  [DEBUG]   S×d_nominal = 261006.37
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 261006.37 + -113151.33 = 147855.04
  [DEBUG]   Current θ from Master = 150362.80
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2507.76 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 17793.02
  Lower Bound (LB) = 17793.02
  Gap (UB-LB) = 2507.7584, Absolute Gap = 2507.7584, Relative Gap = 0.123530
  Not converged yet (gap = 2507.76 > ε = 200)

  [DEBUG] Adding NEW scenario 9 to Master Problem...
  [DEBUG] New scenario pattern: 33 increases, 27 decreases
    [DEBUG] Scenario 9 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 9 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 9]
    [DEBUG]   - Total constraints in model: 154283
    [DEBUG]   - Total variables in model: 64660
  [DEBUG] Total scenarios in Master: 10
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 10
================================================================================
[Iteration 10] Solving Master Problem...
  Current scenarios in Master: 10
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 154283 rows, 64660 columns and 437979 nonzeros
Model fingerprint: 0x2e96c6a4
Variable types: 62401 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 65750 rows and 26700 columns
Presolve time: 1.25s
Presolved: 88533 rows, 37960 columns, 539089 nonzeros
Variable types: 35701 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -370385.6338
Found heuristic solution: objective -194531.7474

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.18s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.885e+06
 Factor NZ  : 8.412e+06 (roughly 120 MB of memory)
 Factor Ops : 1.477e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.26468637e+07  1.52172347e+08  7.12e+04 2.33e+01  5.37e+04     2s
   1  -9.42038822e+06  1.25953532e+08  4.97e+04 5.82e+01  3.72e+04     2s
   2  -3.45598572e+06  9.63605580e+07  1.76e+04 1.51e+00  1.36e+04     2s
   3  -7.26285840e+05  6.31411071e+07  1.47e+03 6.83e-01  1.43e+03     2s
   4  -4.74809774e+05  2.21543574e+07  3.72e+02 7.49e-02  3.72e+02     2s
   5  -3.07563460e+05  1.60894052e+07  1.34e+02 5.37e-02  1.79e+02     2s
   6  -1.77715515e+05  1.13580021e+07  5.24e+01 3.39e-02  9.78e+01     2s
   7  -1.22527637e+05  8.39007459e+06  2.92e+01 2.32e-02  6.49e+01     3s
   8  -9.01282498e+04  6.07172133e+06  1.57e+01 1.59e-02  4.33e+01     3s
   9  -6.71975396e+04  4.17379592e+06  8.32e+00 1.05e-02  2.82e+01     3s
  10  -5.03831292e+04  1.69083593e+06  5.03e+00 3.86e-03  1.13e+01     3s
  11  -1.26452148e+04  6.26812022e+05  2.13e+00 1.35e-03  4.05e+00     3s
  12  -3.83301054e+03  2.94098358e+05  1.47e+00 1.07e-03  1.87e+00     3s
  13   6.09118724e+03  1.75473603e+05  8.65e-01 5.55e-04  1.06e+00     3s
  14   1.07920408e+04  1.28099425e+05  6.67e-01 1.67e-03  7.30e-01     3s
  15   1.58602231e+04  1.00177004e+05  5.48e-01 1.94e-03  5.25e-01     3s
  16   2.07391420e+04  8.08020257e+04  4.55e-01 2.09e-03  3.74e-01     3s
  17   2.47344642e+04  7.50725842e+04  3.86e-01 2.14e-03  3.13e-01     3s
  18   2.73463016e+04  6.90388574e+04  3.40e-01 1.78e-03  2.59e-01     3s
  19   3.26128854e+04  6.28821198e+04  2.53e-01 1.75e-03  1.88e-01     3s
  20   3.63914977e+04  5.99408542e+04  1.97e-01 1.43e-03  1.46e-01     3s
  21   3.91783884e+04  5.68407059e+04  1.56e-01 2.41e-03  1.10e-01     3s
  22   4.13738608e+04  5.48932360e+04  1.24e-01 2.16e-03  8.41e-02     3s
  23   4.29318647e+04  5.41961979e+04  1.01e-01 1.95e-03  7.00e-02     3s
  24   4.38471352e+04  5.31672226e+04  8.72e-02 2.44e-03  5.79e-02     3s
  25   4.48345625e+04  5.24950241e+04  7.23e-02 2.58e-03  4.76e-02     3s
  26   4.58635823e+04  5.18560974e+04  5.70e-02 1.84e-03  3.73e-02     3s
  27   4.72382177e+04  5.14129578e+04  3.78e-02 1.89e-03  2.59e-02     3s
  28   4.78369931e+04  5.10416473e+04  2.97e-02 1.34e-03  1.99e-02     3s
  29   4.80149533e+04  5.10171322e+04  2.73e-02 1.31e-03  1.87e-02     3s
  30   4.80734618e+04  5.09058177e+04  2.65e-02 1.45e-03  1.76e-02     3s
  31   4.84196732e+04  5.07544807e+04  2.21e-02 1.08e-03  1.45e-02     3s
  32   4.90626769e+04  5.06647636e+04  1.36e-02 9.03e-04  9.95e-03     3s
  33   4.93989876e+04  5.05440060e+04  9.30e-03 9.33e-04  7.11e-03     3s
  34   4.94714336e+04  5.04468667e+04  8.36e-03 6.98e-04  6.06e-03     4s
  35   4.96698839e+04  5.03855598e+04  5.84e-03 5.44e-04  4.44e-03     4s
  36   4.98371426e+04  5.03330749e+04  3.76e-03 4.07e-04  3.08e-03     4s
  37   4.99238374e+04  5.02683515e+04  2.71e-03 2.46e-04  2.14e-03     4s
  38   4.99664430e+04  5.02288610e+04  2.22e-03 1.53e-04  1.63e-03     4s
  39   5.00459921e+04  5.01970496e+04  1.27e-03 8.00e-05  9.38e-04     4s
  40   5.00688009e+04  5.01850492e+04  1.01e-03 5.51e-05  7.22e-04     4s
  41   5.00847154e+04  5.01759880e+04  8.18e-04 3.59e-05  5.67e-04     4s
  42   5.01315554e+04  5.01694785e+04  2.85e-04 2.21e-05  2.35e-04     4s
  43   5.01408839e+04  5.01659635e+04  1.86e-04 1.47e-05  1.56e-04     4s
  44   5.01468733e+04  5.01614414e+04  1.23e-04 5.18e-06  9.04e-05     4s
  45   5.01571198e+04  5.01604898e+04  1.25e-05 4.48e-06  2.08e-05     4s
  46   5.01583595e+04  5.01595253e+04  1.53e-06 2.22e-06  7.18e-06     4s
  47   5.01585303e+04  5.01589255e+04  2.07e-07 8.22e-07  2.43e-06     4s
  48   5.01585612e+04  5.01585623e+04  9.01e-09 7.29e-08  7.04e-09     4s
  49   5.01585613e+04  5.01585623e+04  9.93e-08 6.47e-08  6.18e-09     4s
  50   5.01585619e+04  5.01585619e+04  2.00e-08 4.37e-10  1.91e-11     4s

Barrier solved model in 50 iterations and 4.13 seconds (7.41 work units)
Optimal objective 5.01585619e+04


Root crossover log...

       0 DPushes remaining with DInf 0.0000000e+00                 6s

    1407 PPushes remaining with PInf 2.8156105e-06                 6s
       0 PPushes remaining with PInf 0.0000000e+00                 6s

  Push phase complete: Pinf 0.0000000e+00, Dinf 4.5350568e-03      6s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   30412    5.0158562e+04   0.000000e+00   4.535057e-03      6s
   30414    5.0158562e+04   0.000000e+00   0.000000e+00      6s
   30414    5.0158562e+04   0.000000e+00   0.000000e+00      6s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 5.015856e+04, 30414 iterations, 4.29 seconds (9.68 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 50158.5619    0  263 -194531.75 50158.5619   126%     -    6s
H    0     0                    -189619.4216 50158.5619   126%     -    6s
H    0     0                    -128965.1625 50158.5619   139%     -    6s
H    0     0                    -128944.8946 50158.5619   139%     -    6s
H    0     0                    -111112.3758 50158.5619   145%     -    6s
H    0     0                    -110777.4797 50158.5619   145%     -    6s
H    0     0                    -53075.94672 50158.5619   195%     -    6s
H    0     0                    -42594.79765 50158.5619   218%     -    6s
H    0     0                    -38839.86383 50158.5619   229%     -    6s
H    0     0                    -38798.94289 50158.5619   229%     -    6s
H    0     0                    -33400.61853 50158.5619   250%     -    6s
H    0     0                    -19227.32956 50158.5619   361%     -    7s
H    0     0                    3914.2507640 50158.5619  1181%     -    7s
H    0     0                    7875.2311602 43538.1491   453%     -   31s
H    0     0                    8002.7710785 43538.1491   444%     -   31s
H    0     0                    8037.5683427 43538.1491   442%     -   31s
     0     0 43350.6650    0  358 8037.56834 43350.6650   439%     -   31s
     0     0 42827.7892    0  425 8037.56834 42827.7892   433%     -   44s
     0     0 42770.9556    0  413 8037.56834 42770.9556   432%     -   49s
     0     0 42770.9556    0  375 8037.56834 42770.9556   432%     -   52s
     0     0 42770.9556    0  378 8037.56834 42770.9556   432%     -   53s
     0     0 42770.9556    0  418 8037.56834 42770.9556   432%     -   56s
     0     0 42770.7849    0  422 8037.56834 42770.7849   432%     -   56s
     0     0 42767.3764    0  433 8037.56834 42767.3764   432%     -   57s
     0     0 42766.9531    0  433 8037.56834 42766.9531   432%     -   57s
H    0     0                    8056.7471151 38897.4894   383%     -   89s
H    0     0                    8069.7126038 38897.4894   382%     -   89s
H    0     0                    8115.9878587 38897.4894   379%     -   89s
H    0     0                    8139.6912598 38897.4894   378%     -   89s
     0     0 38897.4894    0  369 8139.69126 38897.4894   378%     -   89s
H    0     0                    12824.497428 38897.2466   203%     -   89s
H    0     0                    13180.871443 38574.3264   193%     -  106s
H    0     0                    13779.392411 38574.3264   180%     -  106s
     0     0 38574.3264    0  401 13779.3924 38574.3264   180%     -  106s
     0     0 38409.7064    0  386 13779.3924 38409.7064   179%     -  115s
     0     0 38363.6263    0  403 13779.3924 38363.6263   178%     -  119s
     0     0 38318.1763    0  409 13779.3924 38318.1763   178%     -  125s
     0     0 38195.9673    0  399 13779.3924 38195.9673   177%     -  130s
     0     0 38133.5926    0  412 13779.3924 38133.5926   177%     -  135s
H    0     0                    18338.930192 38126.6479   108%     -  138s
H    0     0                    18504.440068 38126.6479   106%     -  138s
H    0     0                    19089.961463 38126.6479   100%     -  138s
H    0     0                    19093.434944 38126.6479   100%     -  138s
H    0     0                    19095.209272 38126.6479   100%     -  138s
H    0     0                    19122.300747 38126.6479  99.4%     -  138s
     0     0 38126.6479    0  420 19122.3007 38126.6479  99.4%     -  138s
     0     0 38123.7802    0  427 19122.3007 38123.7802  99.4%     -  140s
     0     0 38120.0151    0  424 19122.3007 38120.0151  99.3%     -  141s
     0     0 38118.5177    0  422 19122.3007 38118.5177  99.3%     -  142s
H    0     0                    19187.756602 38118.5177  98.7%     -  149s
H    0     0                    19219.092703 38118.5177  98.3%     -  149s
H    0     0                    19245.843562 38118.5177  98.1%     -  149s
H    0     0                    19249.595891 38118.5177  98.0%     -  149s
H    0     0                    19249.944342 38118.5177  98.0%     -  149s
     0     0 36231.5296    0  392 19249.9443 36231.5296  88.2%     -  179s
H    0     0                    19366.391137 36231.4912  87.1%     -  180s
     0     0 35729.8000    0  396 19366.3911 35729.8000  84.5%     -  191s
     0     0 35489.3877    0  412 19366.3911 35489.3877  83.3%     -  199s
     0     0 35419.3756    0  407 19366.3911 35419.3756  82.9%     -  203s
     0     0 35374.8759    0  424 19366.3911 35374.8759  82.7%     -  207s
     0     0 35365.7125    0  414 19366.3911 35365.7125  82.6%     -  208s
     0     0 35209.0630    0  436 19366.3911 35209.0630  81.8%     -  214s
     0     0 35194.3750    0  428 19366.3911 35194.3750  81.7%     -  215s
     0     0 35185.0507    0  436 19366.3911 35185.0507  81.7%     -  217s
     0     0 35184.7760    0  436 19366.3911 35184.7760  81.7%     -  217s
H    0     0                    19383.224942 35184.7760  81.5%     -  222s
     0     0 33895.8189    0  452 19383.2249 33895.8189  74.9%     -  242s
H    0     0                    19389.868276 33895.7420  74.8%     -  242s
H    0     0                    19396.047500 33895.7420  74.8%     -  242s
     0     0 33584.8371    0  430 19396.0475 33584.8371  73.2%     -  253s
     0     0 33453.5663    0  497 19396.0475 33453.5663  72.5%     -  259s
     0     0 33305.4302    0  528 19396.0475 33305.4302  71.7%     -  265s
     0     0 33227.3326    0  482 19396.0475 33227.3326  71.3%     -  269s
     0     0 33169.5242    0  530 19396.0475 33169.5242  71.0%     -  273s
     0     0 33145.1450    0  531 19396.0475 33145.1450  70.9%     -  275s
     0     0 33125.0210    0  468 19396.0475 33125.0210  70.8%     -  277s
     0     0 33119.3743    0  523 19396.0475 33119.3743  70.8%     -  279s
     0     0 33116.5686    0  527 19396.0475 33116.5686  70.7%     -  279s
     0     0 33113.1951    0  532 19396.0475 33113.1951  70.7%     -  280s
     0     0 33107.7410    0  530 19396.0475 33107.7410  70.7%     -  281s
     0     0 33065.1918    0  528 19396.0475 33065.1918  70.5%     -  284s
     0     0 33058.3423    0  528 19396.0475 33058.3423  70.4%     -  286s
     0     0 33057.4392    0  521 19396.0475 33057.4392  70.4%     -  287s
     0     0 32901.1685    0  513 19396.0475 32901.1685  69.6%     -  294s
H    0     0                    19582.929873 32901.1679  68.0%     -  294s
     0     0 32708.4290    0  522 19582.9299 32708.4290  67.0%     -  301s
     0     0 32660.7343    0  511 19582.9299 32660.7343  66.8%     -  304s
     0     0 32637.9010    0  518 19582.9299 32637.9010  66.7%     -  306s
     0     0 32624.4958    0  517 19582.9299 32624.4958  66.6%     -  308s
     0     0 32580.4591    0  515 19582.9299 32580.4591  66.4%     -  311s
     0     0 32565.7856    0  514 19582.9299 32565.7856  66.3%     -  313s
     0     0 32536.1925    0  506 19582.9299 32536.1925  66.1%     -  316s
     0     0 32508.6276    0  517 19582.9299 32508.6276  66.0%     -  319s
     0     0 32503.6991    0  517 19582.9299 32503.6991  66.0%     -  320s
     0     0 32502.6744    0  511 19582.9299 32502.6744  66.0%     -  321s
     0     0 32388.4165    0  456 19582.9299 32388.4165  65.4%     -  328s
     0     0 32344.6200    0  507 19582.9299 32344.6200  65.2%     -  333s
     0     0 32320.5042    0  510 19582.9299 32320.5042  65.0%     -  336s
     0     0 32303.2406    0  522 19582.9299 32303.2406  65.0%     -  338s
     0     0 32294.5207    0  531 19582.9299 32294.5207  64.9%     -  339s
     0     0 32293.8263    0  535 19582.9299 32293.8263  64.9%     -  340s
     0     0 32209.0584    0  524 19582.9299 32209.0584  64.5%     -  345s
     0     0 32190.6622    0  530 19582.9299 32190.6622  64.4%     -  347s
     0     0 32170.4697    0  530 19582.9299 32170.4697  64.3%     -  349s
     0     0 32161.8087    0  538 19582.9299 32161.8087  64.2%     -  351s
     0     0 32153.8648    0  544 19582.9299 32153.8648  64.2%     -  352s
     0     0 32152.5490    0  540 19582.9299 32152.5490  64.2%     -  353s
     0     0 32093.3453    0  478 19582.9299 32093.3453  63.9%     -  357s
     0     0 32086.1369    0  473 19582.9299 32086.1369  63.8%     -  358s
     0     0 32081.1064    0  467 19582.9299 32081.1064  63.8%     -  360s
     0     0 32078.8963    0  467 19582.9299 32078.8963  63.8%     -  360s
     0     0 32046.5204    0  461 19582.9299 32046.5204  63.6%     -  364s
     0     0 32034.8808    0  479 19582.9299 32034.8808  63.6%     -  366s
     0     0 32027.3521    0  462 19582.9299 32027.3521  63.5%     -  367s
     0     0 32025.3407    0  467 19582.9299 32025.3407  63.5%     -  368s
     0     0 31999.2352    0  475 19582.9299 31999.2352  63.4%     -  371s
     0     0 31987.6843    0  476 19582.9299 31987.6843  63.3%     -  373s
     0     0 31983.8252    0  483 19582.9299 31983.8252  63.3%     -  374s
     0     0 31979.2046    0  472 19582.9299 31979.2046  63.3%     -  376s
     0     0 31978.2358    0  475 19582.9299 31978.2358  63.3%     -  376s
     0     0 31957.4349    0  479 19582.9299 31957.4349  63.2%     -  380s
     0     0 31949.8272    0  475 19582.9299 31949.8272  63.2%     -  382s
     0     0 31948.0675    0  485 19582.9299 31948.0675  63.1%     -  383s
     0     0 31937.1587    0  475 19582.9299 31937.1587  63.1%     -  385s
     0     0 31928.5053    0  474 19582.9299 31928.5053  63.0%     -  387s
     0     0 31925.9645    0  483 19582.9299 31925.9645  63.0%     -  388s
     0     0 31891.8471    0  421 19582.9299 31891.8471  62.9%     -  393s
     0     0 31866.8489    0  493 19582.9299 31866.8489  62.7%     -  395s
     0     0 31859.4494    0  501 19582.9299 31859.4494  62.7%     -  397s
     0     0 31856.4368    0  489 19582.9299 31856.4368  62.7%     -  398s
     0     0 31855.8336    0  501 19582.9299 31855.8336  62.7%     -  398s
     0     0 31843.4006    0  487 19582.9299 31843.4006  62.6%     -  401s
H    0     0                    19651.080647 31843.0532  62.0%     -  402s
H    0     0                    19676.139163 31843.0532  61.8%     -  402s
H    0     0                    19696.201342 31843.0532  61.7%     -  402s
     0     0 31841.1637    0  489 19696.2013 31841.1637  61.7%     -  403s
     0     0 31834.1150    0  476 19696.2013 31834.1150  61.6%     -  406s
     0     0 31821.7822    0  475 19696.2013 31821.7822  61.6%     -  408s
     0     0 31819.7316    0  479 19696.2013 31819.7316  61.6%     -  409s
     0     0 31809.6636    0  482 19696.2013 31809.6636  61.5%     -  412s
     0     0 31808.7703    0  482 19696.2013 31808.7703  61.5%     -  414s
H    0     0                    19710.850867 31808.6899  61.4%     -  483s
H    0     0                    19793.976622 31808.6899  60.7%     -  483s
H    0     2                    19811.494104 31808.6899  60.6%     -  486s
     0     2 31808.6899    0  482 19811.4941 31808.6899  60.6%     -  486s
     1     3 30540.6420    1  444 19811.4941 31807.8025  60.6% 15618  498s
     2     5 30288.6331    2  497 19811.4941 31807.8025  60.6% 11782  509s
     4    10 31018.4864    2  409 19811.4941 31521.4996  59.1%  9092  519s
     9    19 29474.8632    4  470 19811.4941 31238.9529  57.7% 10295  537s
    18    38 30475.9199    4  462 19811.4941 31016.2316  56.6% 13111  551s
    37    51 29886.1000    5  451 19811.4941 30629.4000  54.6% 13988  596s
H   50    76                    19857.457807 30629.4000  54.2% 16715  622s
    75   128 28661.5527    7  311 19857.4578 30629.4000  54.2% 14876  649s
   127   252 28638.6444    8  311 19857.4578 30629.4000  54.2% 11613  670s
H  205   252                    19871.409705 30629.4000  54.1%  8581  670s
   259   324 28076.3715   13  267 19871.4097 30629.4000  54.1%  7766  685s
   339   378 27854.1985   15  248 19871.4097 30629.4000  54.1%  6758  698s
   393   446 27696.7797   17  243 19871.4097 30629.4000  54.1%  6551  712s
   465   470 27101.9689   19  232 19871.4097 30629.4000  54.1%  6442  723s
   497   490 25738.1971   20  229 19871.4097 30629.4000  54.1%  6315  736s
H  510   490                    19903.370671 30629.4000  53.9%  6292  736s
   519   547 25431.6633   20  223 19903.3707 30629.4000  53.9%  6335  753s
   578   573 25383.5221   21  219 19903.3707 30629.4000  53.9%  6273  765s
   608   612 25381.0903   22  219 19903.3707 30629.4000  53.9%  6282  782s
H  651   654                    19919.404292 30629.4000  53.8%  6195  801s
H  659   654                    19929.778369 30629.4000  53.7%  6205  801s
   695   735 25197.1702   24  203 19929.7784 30629.4000  53.7%  6248  814s
   786   763 24277.5914   29  208 19929.7784 30629.4000  53.7%  6029  824s
   818   794 24178.9822   30  199 19929.7784 30629.4000  53.7%  6006  834s
   855   830 24149.1636   31  198 19929.7784 30629.4000  53.7%  5979  847s
   893   867 24128.5186   32  190 19929.7784 30629.4000  53.7%  5963  858s
H  911   867                    19929.962256 30629.4000  53.7%  5947  858s
   932   960 23881.4130   33  193 19929.9623 30629.4000  53.7%  5979  870s
  1039  1041 23779.8495   35  193 19929.9623 30629.4000  53.7%  5769  884s
  1146  1133 23703.2407   41  190 19929.9623 30629.4000  53.7%  5571  895s
  1258  1245 23522.1413   46  195 19929.9623 30629.4000  53.7%  5419  909s
  1396  1365 23225.0475   50  182 19929.9623 30629.4000  53.7%  5240  922s
  1544  1450 22833.6418   59  198 19929.9623 30629.4000  53.7%  5059  938s
  1689  1556 22576.8726   68  187 19929.9623 30629.4000  53.7%  4885  955s
  1859  1622 21749.2226   79  103 19929.9623 30629.4000  53.7%  4666  969s
  2000  1630 infeasible   88      19929.9623 30629.4000  53.7%  4577  986s
  2044  1656 27888.0007   13  414 19929.9623 30629.4000  53.7%  4637 1002s
  2092  1692 26296.0392   14  345 19929.9623 30629.4000  53.7%  4750 1020s
  2144  1745 25399.3550   15  324 19929.9623 30629.4000  53.7%  4812 1038s
  2199  1796 24820.9367   17  325 19929.9623 30629.4000  53.7%  4880 1054s
  2272  1870 24076.8083   19  340 19929.9623 30629.4000  53.7%  4910 1070s
  2381  1965 23765.0459   21  316 19929.9623 30629.4000  53.7%  4874 1085s
  2502  2064 20497.0929   24  226 19929.9623 30629.4000  53.7%  4852 1105s
  2655  2094 20158.0376   30  207 19929.9623 30475.8767  52.9%  4790 1124s
  2689  2114 infeasible   31      19929.9623 30182.3842  51.4%  4835 1143s
H 2700  2114                    20034.989240 30182.3842  50.6%  4835 1143s
  2731  2176 21519.1689   44  254 20034.9892 30182.3842  50.6%  4890 1164s
  2866  2266     cutoff   46      20034.9892 30182.3842  50.6%  4913 1186s
  3020  2359 27412.3865   10  377 20034.9892 30182.3842  50.6%  4948 1209s
  3205  2445 24174.1183   12  373 20034.9892 29854.3290  49.0%  4934 1231s
H 3218  2445                    20056.264936 29854.3290  48.9%  4927 1231s
H 3220  2445                    20070.210703 29854.3290  48.7%  4932 1231s
  3313  2575 23746.8844   13  346 20070.2107 29854.3290  48.7%  4951 1256s
  3515  2646 23064.0909   15  289 20070.2107 29398.2526  46.5%  4922 1281s
  3664  2755 22709.0322   18  389 20070.2107 29246.1343  45.7%  4960 1307s
  3808  2756 23722.5301   40  482 20070.2107 29246.1343  45.7%  5041 1415s
  3810  2757 26659.2439   13  163 20070.2107 29246.1343  45.7%  5038 1422s
  3811  2758 26014.0216   10  408 20070.2107 29246.1343  45.7%  5037 1468s
  3812  2759 24518.1432   27  475 20070.2107 29246.1343  45.7%  5035 1499s
  3813  2759 20873.5494   33  402 20070.2107 29246.1343  45.7%  5034 1518s
  3814  2760 27949.3727   14  441 20070.2107 29246.1343  45.7%  5033 1534s
  3815  2761 27649.2062   15  443 20070.2107 29246.1343  45.7%  5031 1544s
  3816  2761 21834.3785   26  446 20070.2107 29246.1343  45.7%  5030 1553s
  3817  2762 21346.6597   13  509 20070.2107 29246.1343  45.7%  5029 1559s
  3818  2763 23728.3237   21  440 20070.2107 29246.1343  45.7%  5027 1566s
  3819  2763 22824.6114   44  539 20070.2107 29246.1343  45.7%  5026 1573s
  3820  2764 22736.0981   59  435 20070.2107 29246.1343  45.7%  5025 1579s
  3821  2765 27795.9846    8  428 20070.2107 29246.1343  45.7%  5023 1583s
  3822  2765 26771.5639   15  409 20070.2107 29246.1343  45.7%  5022 1586s
  3823  2766 21554.0319   60  411 20070.2107 29246.1343  45.7%  5021 1590s
  3825  2767 27819.1919   17  405 20070.2107 29246.1343  45.7%  5018 1596s
  3826  2768 28432.0413    7  459 20070.2107 29246.1343  45.7%  5017 1600s
H 3828  2630                    20077.683668 29246.1343  45.7%  5014 1614s
  3830  2632 24365.3447   44  470 20077.6837 29246.1343  45.7%  5012 1619s
  3831  2632 25937.5924   31  451 20077.6837 29246.1343  45.7%  5010 1622s
  3832  2633 21080.5312   57  458 20077.6837 29246.1343  45.7%  5009 1625s
  3833  2634 23782.5838   47  463 20077.6837 29246.1343  45.7%  5008 1633s
  3834  2634 22047.0947   48  527 20077.6837 29246.1343  45.7%  5006 1636s
  3835  2635 20911.3948   28  466 20077.6837 29246.1343  45.7%  5005 1640s
  3836  2636 26340.8377   20  467 20077.6837 29246.1343  45.7%  5004 1645s
  3838  2637 22828.4253   23  571 20077.6837 29246.1343  45.7%  5001 1652s
  3839  2638 20428.5909   63  516 20077.6837 29246.1343  45.7%  5000 1657s
  3841  2639 22853.1358   25  523 20077.6837 29246.1343  45.7%  4997 1662s
  3842  2640 25147.3125   16  514 20077.6837 29246.1343  45.7%  4996 1667s
  3843  2640 24507.7099   27  522 20077.6837 29246.1343  45.7%  4995 1671s
  3844  2641 22339.5440   24  498 20077.6837 29246.1343  45.7%  4993 1675s
  3846  2642 23035.1680   32  509 20077.6837 29246.1343  45.7%  4991 1683s
  3847  2643 21993.4445   38  467 20077.6837 29246.1343  45.7%  4989 1686s
  3848  2644 24042.0594   39  460 20077.6837 29246.1343  45.7%  4988 1691s
  3849  2644 26290.8497   18  460 20077.6837 29246.1343  45.7%  4987 1722s
  3850  2645 24743.3370   35  460 20077.6837 29246.1343  45.7%  4986 1780s
  3851  2649 29246.1343   15  452 20077.6837 29246.1343  45.7%  5069 1845s
  3853  2652 29246.1343   16  452 20077.6837 29246.1343  45.7%  5072 1871s
  3857  2659 29246.1343   17  451 20077.6837 29246.1343  45.7%  5077 1887s
  3865  2672 29246.1343   18  444 20077.6837 29246.1343  45.7%  5096 1938s
  3881  2683 29176.6273   19  433 20077.6837 29246.1343  45.7%  5123 2362s
  3897  2707 28830.3737   20  434 20077.6837 29246.1343  45.7%  5229 2402s
  3929  2731 26913.4408   21  423 20077.6837 29246.1343  45.7%  5246 2427s
  3964  2771 26700.9938   22  484 20077.6837 29246.1343  45.7%  5361 2455s
  4030  2801 26297.6685   25  358 20077.6837 29246.1343  45.7%  5384 2484s
  4107  2798 24664.4606   24  469 20077.6837 29246.1343  45.7%  5403 2504s
  4141  2816 24806.9427   26  465 20077.6837 29246.1343  45.7%  5425 2530s
  4186  2830 24418.7089   26  341 20077.6837 29246.1343  45.7%  5465 2551s
  4242  2831 24593.1574   27  457 20077.6837 29246.1343  45.7%  5467 2573s
  4313  2815 23920.0113   28  440 20077.6837 29246.1343  45.7%  5444 2593s
  4369  2801 21388.4227   28  320 20077.6837 29246.1343  45.7%  5433 2621s
  4415  2796     cutoff   27      20077.6837 29246.1343  45.7%  5436 2649s
  4485  2791 22672.8843   27  355 20077.6837 29246.1343  45.7%  5410 2677s
  4546  2793 23651.9210   26  281 20077.6837 29246.1343  45.7%  5392 2697s
  4610  2785 22255.1962   28  355 20077.6837 29246.1343  45.7%  5371 2717s
  4666  2778 21642.1458   29  324 20077.6837 29246.1343  45.7%  5365 2742s
  4721  2777 infeasible   30      20077.6837 29246.1343  45.7%  5353 2762s
  4789  2776 22317.4246   28  418 20077.6837 29246.1343  45.7%  5334 2782s
  4854  2784 21630.9156   28  288 20077.6837 29246.1343  45.7%  5319 2802s
  4941  2786 21564.6444   29  299 20077.6837 29246.1343  45.7%  5287 2823s
  5023  2775 21212.4615   30  277 20077.6837 29246.1343  45.7%  5258 2845s
  5127  2783     cutoff   31      20077.6837 29246.1343  45.7%  5221 2882s
  5203  2789     cutoff   29      20077.6837 29246.1343  45.7%  5215 2914s
  5296  2791 24401.2627   25  433 20077.6837 29246.1343  45.7%  5192 2946s
  5380  2794 23897.2133   26  412 20077.6837 29246.1343  45.7%  5191 2972s
  5478  2807 23816.4078   28  390 20077.6837 29203.1855  45.5%  5190 3002s
  5580  2815 22631.8459   29  376 20077.6837 28230.1149  40.6%  5168 3028s
  5667  2833 21278.8276   30  353 20077.6837 27911.4814  39.0%  5177 3058s
  5769  2840 20509.5346   33  190 20077.6837 27911.4814  39.0%  5185 3094s
  5872  2844 23457.3452   27  327 20077.6837 27911.4814  39.0%  5178 3131s
  5977  2829 21626.5479   29  252 20077.6837 27911.4814  39.0%  5194 3159s
  6069  2831 21067.1199   31  254 20077.6837 27240.5770  35.7%  5186 3194s
  6173  2841 20389.6157   38  251 20077.6837 27137.7830  35.2%  5180 3229s
  6289  2838 25508.9515   20  338 20077.6837 27137.7830  35.2%  5179 3264s
  6401  2873 24841.7846   24  421 20077.6837 27137.7830  35.2%  5190 3300s
  6514  2906 22759.1388   28  217 20077.6837 27137.7830  35.2%  5202 3340s
  6670  2913 22015.3792   37   78 20077.6837 27137.7830  35.2%  5201 3380s
  6868  2893 20694.0353   33  266 20077.6837 26239.6080  30.7%  5174 3420s
  7021  2923     cutoff   35      20077.6837 26239.6080  30.7%  5180 3462s
  7182  2873 20811.6299   26  259 20077.6837 26239.6080  30.7%  5178 3498s
  7228  2882     cutoff   27      20077.6837 26239.6080  30.7%  5191 3537s
  7319  2880 infeasible   29      20077.6837 25895.5428  29.0%  5179 3577s
  7418  2888 21826.5503   28  391 20077.6837 25895.5428  29.0%  5171 3600s

Cutting planes:
  Gomory: 19
  Implied bound: 69
  Projected implied bound: 361
  MIR: 1235
  Mixing: 3
  Flow cover: 2448
  RLT: 65
  Relax-and-lift: 437

Explored 7503 nodes (39170668 simplex iterations) in 3600.04 seconds (9453.88 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 20077.7 20070.2 20056.3 ... 19857.5

Time limit reached
Best objective 2.007768366778e+04, best bound 2.589554277619e+04, gap 28.9767%
  WARNING: Time limit reached. Using best solution found (gap: 28.98%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = 20077.68, θ = 142517.64
  Upper Bound (UB) = 20077.68

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 142517.64
  [DEBUG]   ✓ Scenario 0: θ = 142517.64 ≤ Q = 142517.64 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 142517.64 ≤ Q = 142517.64 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 142517.64 ≤ Q = 142517.64 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 142517.64 ≤ Q = 142517.64 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 142517.64 ≤ Q = 142517.64 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 142517.64 ≤ Q = 142517.64 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 142517.64 ≤ Q = 142517.64 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 142517.64 ≤ Q = 142517.64 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 142517.64 ≤ Q = 142517.64 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 142517.64 ≤ Q = 142517.64 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 10] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x58348d28
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x58348d28
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.448952e+13
Presolve removed 2571 rows and 1864 columns
Presolve time: 0.00s
Presolved: 522 rows, 525 columns, 1472 nonzeros
Found heuristic solution: objective 7725109.5288
Variable types: 355 continuous, 170 integer (170 binary)

Root relaxation: objective -1.381572e+05, 256 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -138157.16    0  129 7725109.53 -138157.16   102%     -    0s
H    0     0                    -103517.5522 -138157.16  33.5%     -    0s
H    0     0                    -103808.1935 -138157.16  33.1%     -    0s
H    0     0                    -103845.8667 -115194.44  10.9%     -    0s
H    0     0                    -110917.5362 -115194.44  3.86%     -    0s
     0     0 -115194.44    0   34 -110917.54 -115194.44  3.86%     -    0s
H    0     0                    -113843.4362 -115147.06  1.15%     -    0s
     0     0 -115022.46    0   30 -113843.44 -115022.46  1.04%     -    0s
     0     0 -115001.33    0   30 -113843.44 -115001.33  1.02%     -    0s
     0     0 -114851.32    0   14 -113843.44 -114851.32  0.89%     -    0s
H    0     0                    -114280.3905 -114838.67  0.49%     -    0s
H    0     0                    -114573.8626 -114838.67  0.23%     -    0s
     0     0 -114796.52    0   16 -114573.86 -114796.52  0.19%     -    0s
     0     0 -114794.97    0   11 -114573.86 -114794.97  0.19%     -    0s
     0     0 -114783.77    0   13 -114573.86 -114783.77  0.18%     -    0s
H    0     0                    -114620.4790 -114783.77  0.14%     -    0s
     0     0 -114769.06    0    8 -114620.48 -114769.06  0.13%     -    0s
     0     0 -114769.06    0   20 -114620.48 -114769.06  0.13%     -    0s
     0     0 -114693.62    0    6 -114620.48 -114693.62  0.06%     -    0s
H    0     0                    -114690.9208 -114690.92  0.00%     -    0s

Cutting planes:
  Gomory: 6
  MIR: 13
  Flow cover: 3

Explored 1 nodes (619 simplex iterations) in 0.04 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -114691 -114620 -114574 ... -103518
No other solutions better than -114691

Optimal solution found (tolerance 1.00e-04)
Best objective -1.146909207519e+05, best bound -1.146909207519e+05, gap 0.0000%
  Subproblem solved in 0.06s
  Worst-case operational profit (Z_SP) = 131628.43
  Scenario: 9 demand increases, 51 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -114690.92
  [DEBUG]   S×d_nominal = 246319.35
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 246319.35 + -114690.92 = 131628.43
  [DEBUG]   Current θ from Master = 142517.64
  [DEBUG]   ⚠️  Z_SP ≤ θ by 10889.20 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 9188.48
  Lower Bound (LB) = 17793.02
  Gap (UB-LB) = 2284.6658, Absolute Gap = 2284.6658, Relative Gap = 0.113791
  Not converged yet (gap = 2284.67 > ε = 200)

  [DEBUG] Adding NEW scenario 10 to Master Problem...
  [DEBUG] New scenario pattern: 9 increases, 51 decreases
    [DEBUG] Scenario 10 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 10 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 10]
    [DEBUG]   - Total constraints in model: 169573
    [DEBUG]   - Total variables in model: 70900
  [DEBUG] Total scenarios in Master: 11
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 11
================================================================================
[Iteration 11] Solving Master Problem...
  Current scenarios in Master: 11
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 169573 rows, 70900 columns and 481225 nonzeros
Model fingerprint: 0xe5d69412
Variable types: 68641 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 72315 rows and 29365 columns
Presolve time: 1.37s
Presolved: 97258 rows, 41535 columns, 588219 nonzeros
Variable types: 39276 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -374421.9226
Found heuristic solution: objective -194531.7474

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.21s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 4.432e+06
 Factor NZ  : 9.778e+06 (roughly 140 MB of memory)
 Factor Ops : 1.822e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.32446513e+07  1.65020055e+08  7.46e+04 2.13e+01  5.59e+04     3s
   1  -9.92536002e+06  1.37461222e+08  5.21e+04 5.40e+01  3.86e+04     3s
   2  -2.98286349e+06  1.03243076e+08  1.49e+04 1.21e+01  1.14e+04     3s
   3  -8.27154465e+05  7.42843593e+07  1.77e+03 1.44e+00  1.66e+03     3s
   4  -4.81236632e+05  3.61067626e+07  3.65e+02 2.30e-01  4.31e+02     3s
   5  -3.73473954e+05  2.14207678e+07  1.46e+02 9.29e-12  2.04e+02     3s
   6  -2.86671590e+05  1.54063428e+07  7.41e+01 1.15e-11  1.25e+02     3s
   7  -1.54317285e+05  1.07664316e+07  2.38e+01 8.97e-12  7.12e+01     3s
   8  -8.40033385e+04  6.27702461e+06  8.55e+00 7.76e-12  3.81e+01     3s
   9  -6.33565713e+04  5.01971300e+06  5.25e+00 8.29e-12  2.97e+01     3s
  10  -4.95309678e+04  2.05261004e+06  3.47e+00 3.34e-12  1.22e+01     3s
  11  -8.48296783e+03  1.01599491e+06  9.20e-01 2.07e-12  5.80e+00     3s
  12  -3.93736977e+02  3.89487915e+05  5.31e-01 1.93e-12  2.20e+00     3s
  13   9.84012269e+03  2.00008374e+05  2.69e-01 7.74e-13  1.07e+00     3s
  14   1.43518183e+04  1.60109163e+05  2.16e-01 7.11e-13  8.20e-01     3s
  15   1.77976635e+04  1.22035757e+05  1.83e-01 9.19e-04  5.86e-01     3s
  16   2.39219453e+04  9.74322539e+04  1.40e-01 1.48e-03  4.13e-01     3s
  17   2.70406995e+04  8.63910800e+04  1.21e-01 1.10e-03  3.34e-01     3s
  18   3.00545850e+04  7.39709762e+04  1.05e-01 2.13e-03  2.47e-01     3s
  19   3.46078459e+04  6.91304705e+04  7.91e-02 1.71e-03  1.94e-01     3s
  20   3.78261225e+04  6.39102200e+04  6.31e-02 2.34e-03  1.47e-01     3s
  21   4.08982913e+04  6.13037761e+04  4.80e-02 2.15e-03  1.15e-01     3s
  22   4.24728865e+04  5.83377948e+04  4.06e-02 2.19e-03  8.92e-02     3s
  23   4.44316782e+04  5.62518053e+04  3.16e-02 1.88e-03  6.65e-02     4s
  24   4.51469208e+04  5.44697347e+04  2.82e-02 2.51e-03  5.24e-02     4s
  25   4.67857322e+04  5.34099266e+04  2.07e-02 1.56e-03  3.73e-02     4s
  26   4.79003512e+04  5.30527858e+04  1.59e-02 1.26e-03  2.90e-02     4s
  27   4.91713371e+04  5.27513471e+04  1.02e-02 9.85e-04  2.01e-02     4s
  28   4.99406130e+04  5.25341585e+04  6.82e-03 7.98e-04  1.46e-02     4s
  29   5.01580065e+04  5.23881098e+04  5.87e-03 6.76e-04  1.25e-02     4s
  30   5.04204057e+04  5.21647150e+04  4.74e-03 4.90e-04  9.81e-03     4s
  31   5.06878485e+04  5.19931299e+04  3.61e-03 3.37e-04  7.34e-03     4s
  32   5.08100289e+04  5.19793456e+04  3.13e-03 3.23e-04  6.58e-03     4s
  33   5.08767564e+04  5.18426098e+04  2.85e-03 2.09e-04  5.43e-03     4s
  34   5.11035069e+04  5.17762350e+04  1.96e-03 1.44e-04  3.78e-03     4s
  35   5.12169196e+04  5.17436684e+04  1.49e-03 1.16e-04  2.96e-03     4s
  36   5.12477341e+04  5.16909160e+04  1.37e-03 6.49e-05  2.49e-03     4s
  37   5.14779049e+04  5.16756695e+04  4.85e-04 5.34e-05  1.11e-03     4s
  38   5.15614123e+04  5.16180817e+04  1.48e-04 8.70e-06  3.19e-04     4s
  39   5.15774071e+04  5.16069576e+04  9.37e-05 6.07e-06  1.66e-04     4s
  40   5.15782304e+04  5.16065387e+04  9.10e-05 3.52e-06  1.59e-04     4s
  41   5.15889845e+04  5.16064482e+04  5.59e-05 7.68e-06  9.82e-05     4s
  42   5.15919412e+04  5.16063582e+04  4.60e-05 6.77e-06  8.11e-05     4s
  43   5.15937038e+04  5.16063316e+04  4.02e-05 6.27e-06  7.10e-05     5s
  44   5.16047453e+04  5.16061145e+04  4.38e-06 8.32e-07  7.70e-06     5s
  45   5.16059232e+04  5.16060622e+04  2.49e-07 3.99e-08  7.81e-07     5s
  46   5.16060403e+04  5.16060413e+04  2.54e-10 3.89e-08  5.43e-09     5s
  47   5.16060404e+04  5.16060404e+04  2.33e-09 2.38e-09  5.97e-12     5s

Barrier solved model in 47 iterations and 4.76 seconds (8.66 work units)
Optimal objective 5.16060404e+04


Root crossover log...

       0 DPushes remaining with DInf 0.0000000e+00                 6s

    1506 PPushes remaining with PInf 7.0500655e-08                 6s
       0 PPushes remaining with PInf 0.0000000e+00                 6s

  Push phase complete: Pinf 0.0000000e+00, Dinf 7.3426001e-11      6s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   31931    5.1606040e+04   0.000000e+00   0.000000e+00      6s
   31931    5.1606040e+04   0.000000e+00   0.000000e+00      6s
Concurrent spin time: 0.01s

Solved with barrier

Root relaxation: objective 5.160604e+04, 31931 iterations, 4.14 seconds (7.97 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 51606.0404    0  249 -194531.75 51606.0404   127%     -    6s
H    0     0                    -184895.7545 51606.0404   128%     -    6s
H    0     0                    -55114.58993 51606.0404   194%     -    6s
H    0     0                    -51272.67491 51606.0404   201%     -    6s
H    0     0                    -40372.50728 51606.0404   228%     -    6s
H    0     0                    -31698.22157 51606.0404   263%     -    6s
H    0     0                    -3689.402495 51606.0404  1499%     -    6s
H    0     0                    -2783.907405 51606.0404  1954%     -    6s
H    0     0                    -2056.299942 51606.0404  2610%     -    6s
H    0     0                    -1553.581596 51606.0404  3422%     -    7s
H    0     0                    -1441.962719 51606.0404  3679%     -    7s
H    0     0                    -1286.633010 44797.9032  3582%     -   31s
H    0     0                    -1282.324313 44797.9032  3593%     -   31s
H    0     0                    -708.1492924 44797.9032  6426%     -   31s
H    0     0                    -645.3671957 44797.9032  7041%     -   31s
     0     0 44791.1577    0  394 -645.36720 44791.1577  7040%     -   31s
     0     0 44544.1139    0  384 -645.36720 44544.1139  7002%     -   39s
     0     0 44415.1456    0  380 -645.36720 44415.1456  6982%     -   45s
     0     0 44400.6553    0  377 -645.36720 44400.6553  6980%     -   49s
     0     0 44393.7548    0  385 -645.36720 44393.7548  6979%     -   49s
     0     0 44342.8896    0  378 -645.36720 44342.8896  6971%     -   52s
     0     0 44340.4709    0  376 -645.36720 44340.4709  6971%     -   53s
     0     0 44340.1402    0  376 -645.36720 44340.1402  6971%     -   54s
H    0     0                    1745.4605099 40739.3305  2234%     -  106s
H    0     0                    5949.1850442 40739.3305   585%     -  106s
H    0     0                    6290.5029756 40739.3305   548%     -  106s
H    0     0                    6379.1663059 40739.3305   539%     -  106s
H    0     0                    6563.3515821 40739.3305   521%     -  106s
     0     0 40739.3305    0  450 6563.35158 40739.3305   521%     -  106s
     0     0 40164.0246    0  499 6563.35158 40164.0246   512%     -  129s
     0     0 39984.4920    0  501 6563.35158 39984.4920   509%     -  143s
     0     0 39921.9763    0  492 6563.35158 39921.9763   508%     -  149s
     0     0 39901.3383    0  488 6563.35158 39901.3383   508%     -  154s
     0     0 39868.9107    0  472 6563.35158 39868.9107   507%     -  161s
     0     0 39829.0570    0  515 6563.35158 39829.0570   507%     -  168s
H    0     0                    11338.388668 39674.3726   250%     -  177s
     0     0 39674.3726    0  517 11338.3887 39674.3726   250%     -  177s
     0     0 39658.9158    0  523 11338.3887 39658.9158   250%     -  181s
     0     0 39651.8635    0  523 11338.3887 39651.8635   250%     -  184s
     0     0 39645.3412    0  512 11338.3887 39645.3412   250%     -  186s
     0     0 39644.2899    0  517 11338.3887 39644.2899   250%     -  187s
H    0     0                    11900.124534 36567.4500   207%     -  238s
H    0     0                    11915.145180 36567.4500   207%     -  238s
H    0     0                    11981.831063 36567.4500   205%     -  238s
H    0     0                    11985.848267 36567.4500   205%     -  238s
H    0     0                    12027.267394 36567.4500   204%     -  238s
H    0     0                    12089.567739 36567.4500   202%     -  238s
H    0     0                    12110.177266 36567.4500   202%     -  238s
     0     0 36567.4500    0  520 12110.1773 36567.4500   202%     -  238s
     0     0 36078.9736    0  561 12110.1773 36078.9736   198%     -  258s
H    0     0                    12596.751176 35827.8512   184%     -  273s
H    0     0                    12624.941503 35827.8512   184%     -  273s
H    0     0                    12656.879553 35827.8512   183%     -  273s
H    0     0                    12883.188357 35827.8512   178%     -  273s
     0     0 35827.8512    0  566 12883.1884 35827.8512   178%     -  273s
H    0     0                    12904.133523 35682.0215   177%     -  285s
H    0     0                    12924.726438 35682.0215   176%     -  285s
H    0     0                    12943.549736 35682.0215   176%     -  285s
H    0     0                    12945.466211 35682.0215   176%     -  285s
     0     0 35682.0215    0  569 12945.4662 35682.0215   176%     -  286s
     0     0 35637.4654    0  570 12945.4662 35637.4654   175%     -  294s
     0     0 35601.6787    0  590 12945.4662 35601.6787   175%     -  300s
     0     0 35497.9536    0  590 12945.4662 35497.9536   174%     -  307s
H    0     0                    12996.164374 35431.6345   173%     -  315s
H    0     0                    12998.516029 35431.6345   173%     -  315s
H    0     0                    13002.037942 35431.6345   173%     -  315s
H    0     0                    13047.712735 35431.6345   172%     -  315s
     0     0 35431.6345    0  598 13047.7127 35431.6345   172%     -  315s
     0     0 35428.5045    0  611 13047.7127 35428.5045   172%     -  318s
     0     0 35427.2361    0  611 13047.7127 35427.2361   172%     -  319s
H    0     0                    13049.923356 35427.2361   171%     -  338s
H    0     0                    13053.513740 35427.2361   171%     -  338s
H    0     0                    13113.568386 34008.4847   159%     -  375s
     0     0 34008.4847    0  524 13113.5684 34008.4847   159%     -  375s
H    0     0                    13151.933882 34008.3417   159%     -  376s
H    0     0                    13162.095732 34008.3417   158%     -  376s
H    0     0                    13163.736756 34008.3417   158%     -  376s
     0     0 33659.9579    0  507 13163.7368 33659.9579   156%     -  391s
     0     0 33524.5973    0  487 13163.7368 33524.5973   155%     -  399s
     0     0 33380.8588    0  505 13163.7368 33380.8588   154%     -  406s
     0     0 33311.2802    0  460 13163.7368 33311.2802   153%     -  411s
     0     0 33273.0433    0  450 13163.7368 33273.0433   153%     -  414s
     0     0 33264.3721    0  457 13163.7368 33264.3721   153%     -  416s
     0     0 33254.9707    0  455 13163.7368 33254.9707   153%     -  418s
     0     0 33190.1226    0  533 13163.7368 33190.1226   152%     -  423s
     0     0 33131.2793    0  515 13163.7368 33131.2793   152%     -  427s
     0     0 33101.5248    0  528 13163.7368 33101.5248   151%     -  431s
     0     0 33087.0987    0  529 13163.7368 33087.0987   151%     -  434s
     0     0 33083.4680    0  532 13163.7368 33083.4680   151%     -  436s
     0     0 33080.6954    0  525 13163.7368 33080.6954   151%     -  436s
     0     0 32908.9980    0  553 13163.7368 32908.9980   150%     -  445s
H    0     0                    13189.763985 32907.8504   149%     -  446s
     0     0 32811.5726    0  496 13189.7640 32811.5726   149%     -  451s
     0     0 32783.1677    0  626 13189.7640 32783.1677   149%     -  456s
     0     0 32764.1812    0  583 13189.7640 32764.1812   148%     -  459s
     0     0 32741.4292    0  572 13189.7640 32741.4292   148%     -  462s
     0     0 32738.0375    0  570 13189.7640 32738.0375   148%     -  463s
     0     0 32734.0467    0  520 13189.7640 32734.0467   148%     -  465s
     0     0 32732.7827    0  527 13189.7640 32732.7827   148%     -  465s
     0     0 32603.1795    0  529 13189.7640 32603.1795   147%     -  474s
     0     0 32551.6261    0  519 13189.7640 32551.6261   147%     -  482s
     0     0 32536.9224    0  525 13189.7640 32536.9224   147%     -  485s
     0     0 32523.1924    0  525 13189.7640 32523.1924   147%     -  487s
     0     0 32519.2908    0  551 13189.7640 32519.2908   147%     -  489s
     0     0 32510.9725    0  535 13189.7640 32510.9725   146%     -  492s
     0     0 32504.7954    0  541 13189.7640 32504.7954   146%     -  493s
     0     0 32503.6478    0  612 13189.7640 32503.6478   146%     -  495s
     0     0 32403.7229    0  455 13189.7640 32403.7229   146%     -  501s
     0     0 32338.9828    0  467 13189.7640 32338.9828   145%     -  505s
     0     0 32308.9879    0  470 13189.7640 32308.9879   145%     -  508s
     0     0 32295.8405    0  473 13189.7640 32295.8405   145%     -  511s
     0     0 32285.0559    0  473 13189.7640 32285.0559   145%     -  513s
     0     0 32283.1438    0  471 13189.7640 32283.1438   145%     -  514s
     0     0 32217.5934    0  542 13189.7640 32217.5934   144%     -  521s
H    0     0                    13199.983022 32216.4903   144%     -  522s
H    0     0                    13204.595789 32216.4903   144%     -  522s
H    0     0                    13242.533033 32216.4903   143%     -  522s
H    0     0                    13244.735631 32216.4903   143%     -  522s
H    0     0                    13262.585065 32216.4903   143%     -  523s
     0     0 32207.0141    0  485 13262.5851 32207.0141   143%     -  526s
     0     0 32196.1366    0  597 13262.5851 32196.1366   143%     -  529s
     0     0 32194.1975    0  536 13262.5851 32194.1975   143%     -  530s
     0     0 32166.6524    0  536 13262.5851 32166.6524   143%     -  535s
H    0     0                    13265.773033 32166.2133   142%     -  536s
     0     0 32110.8855    0  540 13265.7730 32110.8855   142%     -  541s
     0     0 32104.0267    0  536 13265.7730 32104.0267   142%     -  544s
     0     0 32098.0989    0  525 13265.7730 32098.0989   142%     -  546s
     0     0 32095.1969    0  537 13265.7730 32095.1969   142%     -  548s
     0     0 32054.8209    0  467 13265.7730 32054.8209   142%     -  552s
     0     0 32044.6647    0  581 13265.7730 32044.6647   142%     -  556s
     0     0 32041.6658    0  580 13265.7730 32041.6658   142%     -  558s
     0     0 32003.2514    0  480 13265.7730 32003.2514   141%     -  563s
     0     0 31996.5527    0  530 13265.7730 31996.5527   141%     -  566s
     0     0 31992.8623    0  533 13265.7730 31992.8623   141%     -  567s
     0     0 31986.3939    0  541 13265.7730 31986.3939   141%     -  569s
     0     0 31984.9186    0  478 13265.7730 31984.9186   141%     -  571s
     0     0 31978.4626    0  544 13265.7730 31978.4626   141%     -  574s
H    0     0                    13292.645235 31977.6436   141%     -  576s
H    0     0                    13411.917678 31977.6436   138%     -  577s
H    0     0                    13474.323587 31977.6436   137%     -  577s
H    0     0                    13492.454021 31977.6436   137%     -  577s
     0     0 31974.7648    0  540 13492.4540 31974.7648   137%     -  579s
     0     0 31974.4105    0  540 13492.4540 31974.4105   137%     -  580s
     0     0 31967.5560    0  611 13492.4540 31967.5560   137%     -  584s
     0     0 31966.8273    0  611 13492.4540 31966.8273   137%     -  588s
H    0     0                    13537.805705 31966.8273   136%     -  617s
H    0     0                    13559.363528 31966.8273   136%     -  617s
H    0     0                    16154.323738 31966.8273  97.9%     -  659s
H    0     0                    16423.498055 31966.8273  94.6%     -  660s
H    0     0                    16496.410064 31966.8273  93.8%     -  660s
H    0     2                    16720.835467 31966.8273  91.2%     -  661s
     0     2 31966.8273    0  611 16720.8355 31966.8273  91.2%     -  661s
     1     3 30968.5397    1  369 16720.8355 31966.8273  91.2% 15845  675s
     2     4 31475.3143    1  470 16720.8355 31475.3143  88.2% 13120  683s
     3     6 31223.4050    2  469 16720.8355 31473.4609  88.2% 13100  696s
     5    10 30332.4047    3  326 16720.8355 31473.4609  88.2% 12923  724s
     9    19 29792.6791    4  334 16720.8355 31016.5848  85.5% 14872  747s
    18    38 29476.3343    5  329 16720.8355 31016.2728  85.5% 14439  775s
    37    51 29528.3827    6  523 16720.8355 30637.5329  83.2% 17262  830s
    50    76 28605.7870    7  464 16720.8355 30637.5329  83.2% 18815  863s
H   54    76                    17066.626293 30637.5329  79.5% 18482  863s
H   56    76                    17860.476086 30637.5329  71.5% 18419  863s
H   58    76                    18259.191209 30637.5329  67.8% 18106  863s
H   59    76                    18732.855596 30637.5329  63.5% 18046  863s
H   60    76                    19034.559622 30637.5329  61.0% 18031  863s
    75   195 28154.7370    8  386 19034.5596 30637.5329  61.0% 16889  894s
   196   251 26637.7305   13  292 19034.5596 30637.5329  61.0% 10532  912s
   260   291 24788.1059   14  263 19034.5596 30637.5329  61.0%  9780  929s
   310   314 24777.0334   13  322 19034.5596 30637.5329  61.0%  9604  944s
   337   347 26485.4633   13  467 19034.5596 30637.5329  61.0%  9424  961s
H  369   347                    19124.624076 30637.5329  60.2%  9140  961s
H  370   347                    19147.292780 30637.5329  60.0%  9117  961s
   380   370 26083.1362   15  524 19147.2928 30637.5329  60.0%  9190  977s
   409   388 22797.9595   16  233 19147.2928 30637.5329  60.0%  9227  995s
   435   417 26059.1459   16  472 19147.2928 30637.5329  60.0%  9360 1012s
H  443   417                    19159.051206 30637.5329  59.9%  9314 1012s
   466   482 25763.2929   18  354 19159.0512 30637.5329  59.9%  9236 1031s
   551   553 25578.7002   22  366 19159.0512 30637.5329  59.9%  9103 1046s
   628   623 23013.4642   24  381 19159.0512 30637.5329  59.9%  9050 1060s
   706   673 22821.7444   27  393 19159.0512 30637.5329  59.9%  8774 1078s
   768   747 22274.9732   29  383 19159.0512 30637.5329  59.9%  8573 1092s
   860   766 21780.0321   32  303 19159.0512 30637.5329  59.9%  8252 1104s
H  865   766                    19201.475824 30637.5329  59.6%  8244 1104s
H  875   766                    19300.179973 30637.5329  58.7%  8222 1104s
   898   830 20169.7562   33  300 19300.1800 30637.5329  58.7%  8173 1118s
   989   848 19468.8486   37  210 19300.1800 30637.5329  58.7%  7998 1131s
H  991   848                    19346.982034 30637.5329  58.4%  7985 1131s
  1026   873 infeasible   38      19346.9820 30637.5329  58.4%  7918 1148s
  1122   882 19619.4238   39  200 19346.9820 30637.5329  58.4%  7760 1167s
  1185   915 24333.4532   19  275 19346.9820 30637.5329  58.4%  7750 1186s
H 1256   934                    19356.281823 30637.5329  58.3%  7769 1203s
H 1270   934                    19420.136758 30637.5329  57.8%  7750 1203s
  1299   972 20048.5564   20  229 19420.1368 30637.5329  57.8%  7744 1224s
  1381  1028 19708.5181   22  229 19420.1368 30637.5329  57.8%  7675 1243s
  1485  1079 22825.2140   23  230 19420.1368 30637.5329  57.8%  7626 1262s
  1590  1124 22083.0537   24  261 19420.1368 30637.5329  57.8%  7556 1281s
  1709  1159 infeasible   25      19420.1368 30637.5329  57.8%  7472 1303s
H 1811  1219                    19601.342497 30637.5329  56.3%  7433 1325s
H 1813  1219                    19632.045525 30637.5329  56.1%  7435 1325s
  1903  1266 20509.9113   29  270 19632.0455 30279.0060  54.2%  7441 1348s
  2020  1347 20188.1349   31  278 19632.0455 30279.0060  54.2%  7492 1375s
  2129  1355 infeasible   34      19632.0455 30279.0060  54.2%  7571 1398s
  2175  1389 22206.4159   19  341 19632.0455 30279.0060  54.2%  7576 1421s
  2236  1422 21824.1892   21  251 19632.0455 30279.0060  54.2%  7615 1444s
  2306  1470 20219.5582   28  227 19632.0455 30279.0060  54.2%  7607 1471s
H 2341  1470                    19681.844841 30279.0060  53.8%  7590 1471s
  2384  1501 20698.5776   52  269 19681.8448 30279.0060  53.8%  7625 1495s
H 2387  1501                    19683.942543 30279.0060  53.8%  7622 1495s
  2439  1613 20663.6006   53  268 19683.9425 30279.0060  53.8%  7624 1521s
  2631  1689     cutoff   52      19683.9425 30147.4757  53.2%  7531 1551s
  2795  1792 28201.2773    6  506 19683.9425 30147.2425  53.2%  7496 1580s
  2944  1862 25652.1359    7  429 19683.9425 28928.2457  47.0%  7512 1616s
  3099  1967 25067.4012    9  458 19683.9425 28928.2457  47.0%  7508 1651s
  3264  2054 24621.1893   12  500 19683.9425 28928.2457  47.0%  7485 1688s
  3435  2128 24196.9053   15  399 19683.9425 28647.8218  45.5%  7455 1722s
  3541  2278 23795.3960   16  463 19683.9425 28647.8218  45.5%  7515 1761s
  3740  2279 25175.4220   10  611 19683.9425 28647.8218  45.5%  7484 1915s
  3742  2280 20444.2629   22  159 19683.9425 28647.8218  45.5%  7480 1923s
  3743  2281 25863.6534   16  367 19683.9425 28647.8218  45.5%  7478 1973s
  3744  2282 24703.5495   20  389 19683.9425 28647.8218  45.5%  7476 2025s
  3745  2282 22182.2489   26  488 19683.9425 28647.8218  45.5%  7474 2053s
  3746  2283 23061.5989   35  508 19683.9425 28647.8218  45.5%  7472 2072s
  3747  2284 22664.1734   26  482 19683.9425 28647.8218  45.5%  7470 2087s
  3748  2284 21885.5034   46  539 19683.9425 28647.8218  45.5%  7468 2098s
  3749  2285 25667.4695   15  442 19683.9425 28647.8218  45.5%  7466 2108s
  3750  2286 21101.1976   36  544 19683.9425 28647.8218  45.5%  7464 2117s
  3751  2286 19958.8636   33  539 19683.9425 28647.8218  45.5%  7462 2125s
  3753  2288 21628.6057   27  494 19683.9425 28647.8218  45.5%  7458 2133s
  3754  2288 23118.8814   20  504 19683.9425 28647.8218  45.5%  7456 2138s
  3755  2289 21614.4275   24  457 19683.9425 28647.8218  45.5%  7454 2143s
  3756  2290 20875.4708   15  571 19683.9425 28647.8218  45.5%  7452 2147s
  3757  2290 22876.7023   19  511 19683.9425 28647.8218  45.5%  7450 2152s
  3759  2292 20465.1830   21  559 19683.9425 28647.8218  45.5%  7446 2159s
  3760  2292 20276.6121   24  508 19683.9425 28647.8218  45.5%  7444 2169s
  3761  2293 20965.9667   23  520 19683.9425 28647.8218  45.5%  7442 2176s
  3763  2294 25476.8215   15  468 19683.9425 28647.8218  45.5%  7438 2182s
  3764  2295 23119.0546   18  530 19683.9425 28647.8218  45.5%  7436 2189s
  3765  2296 21380.2220   35  399 19683.9425 28647.8218  45.5%  7435 2193s
  3766  2296 26895.3482    5  481 19683.9425 28647.8218  45.5%  7433 2198s
  3767  2297 24219.0652   18  481 19683.9425 28647.8218  45.5%  7431 2202s
  3768  2298 21898.3785   29  473 19683.9425 28647.8218  45.5%  7429 2209s
  3769  2298 25999.3173   23  483 19683.9425 28647.8218  45.5%  7427 2213s
  3770  2299 22219.4270   28  481 19683.9425 28647.8218  45.5%  7425 2218s
  3771  2300 20063.8690   64  482 19683.9425 28647.8218  45.5%  7423 2225s
  3772  2300 22827.9635   33  550 19683.9425 28647.8218  45.5%  7421 2230s
  3773  2301 25164.6481   25  470 19683.9425 28647.8218  45.5%  7419 2236s
  3775  2302 21330.5227   26  484 19683.9425 28647.8218  45.5%  7415 2243s
  3776  2303 20904.8898   44  542 19683.9425 28647.8218  45.5%  7413 2249s
  3777  2304 23674.9955   14  542 19683.9425 28647.8218  45.5%  7411 2265s
  3778  2304 26330.7129   12  542 19683.9425 28647.8218  45.5%  7409 2323s
  3779  2307 28647.8218   10  436 19683.9425 28647.8218  45.5%  7498 2338s
  3780  2309 28647.8218   11  437 19683.9425 28647.8218  45.5%  7498 2357s
  3782  2313 28647.8218   11  432 19683.9425 28647.8218  45.5%  7501 2385s
  3787  2321 28647.8218   12  479 19683.9425 28647.8218  45.5%  7499 2402s
  3797  2338 28647.8218   13  537 19683.9425 28647.8218  45.5%  7517 2447s
  3817  2343 28647.8218   14  343 19683.9425 28647.8218  45.5%  7546 2501s
  3829  2363 28647.8218   15  326 19683.9425 28647.8218  45.5%  7594 2539s
  3853  2462 27705.8202   16  314 19683.9425 28647.8218  45.5%  7617 2585s
  3962  2452 26486.4298   17  315 19683.9425 28647.8218  45.5%  7621 2606s
  3996  2475 25368.1237   18  308 19683.9425 28647.8218  45.5%  7635 2625s
  4030  2500 24590.8136   19  301 19683.9425 28647.8218  45.5%  7650 2644s
H 4051  2377                    19745.786400 28647.8218  45.1%  7645 2644s
  4070  2427 23750.7500   20  318 19745.7864 28647.8218  45.1%  7640 2664s
H 4086  2312                    19780.672793 28647.8218  44.8%  7628 2664s
  4134  2336 23547.3394   21  321 19780.6728 28647.8218  44.8%  7602 2684s
  4206  2354 22566.1143   23  301 19780.6728 28647.8218  44.8%  7543 2705s
  4285  2353 22295.9614   24  316 19780.6728 28647.8218  44.8%  7462 2723s
  4355  2334 21291.2813   28  236 19780.6728 28647.8218  44.8%  7404 2740s
  4412  2311     cutoff   29      19780.6728 28647.8218  44.8%  7357 2756s
  4478  2278     cutoff   28      19780.6728 28647.8218  44.8%  7314 2773s
  4514  2269     cutoff   27      19780.6728 28647.8218  44.8%  7294 2789s
  4547  2261 27310.7309   15  528 19780.6728 28647.8218  44.8%  7283 2817s
  4584  2257 25340.8048   16  463 19780.6728 28647.8218  44.8%  7266 2850s
  4619  2268 24884.7831   17  471 19780.6728 28647.8218  44.8%  7267 2867s
H 4630  2159                    19787.445288 28647.8218  44.8%  7269 2867s
  4657  2182 22692.2713   18  315 19787.4453 28647.8218  44.8%  7264 2895s
  4715  2185 19898.0517   19  325 19787.4453 28647.8218  44.8%  7238 2916s
  4769  2187 20206.4965   19  377 19787.4453 28647.8218  44.8%  7230 2935s
  4807  2194 20045.5979   20  376 19787.4453 28647.8218  44.8%  7231 2958s
H 4838  2085                    19933.302767 28647.8218  43.7%  7219 2958s
H 4842  1989                    19952.179217 28647.8218  43.6%  7216 2958s
  4850  2005     cutoff   22      19952.1792 28647.8218  43.6%  7216 2983s
H 4920  1907                    20293.506743 28647.8218  41.2%  7184 3005s
  4971  1904 22327.4087   25  266 20293.5067 28647.8218  41.2%  7162 3027s
  5035  1899 21359.6890   27  242 20293.5067 28647.8218  41.2%  7150 3055s
  5100  1895     cutoff   29      20293.5067 28647.8218  41.2%  7136 3079s
  5175  1873 22728.3611   20  305 20293.5067 28647.8218  41.2%  7121 3117s
  5236  1870 21808.0781   21  221 20293.5067 28647.8218  41.2%  7102 3146s
  5292  1864 21004.0644   23  243 20293.5067 28647.8218  41.2%  7100 3173s
  5361  1867     cutoff   25      20293.5067 28647.8218  41.2%  7100 3209s
  5428  1863     cutoff   17      20293.5067 28647.8218  41.2%  7099 3237s
  5493  1877 22456.7749   17  268 20293.5067 28647.8218  41.2%  7089 3269s
  5589  1885     cutoff   20      20293.5067 28647.8218  41.2%  7065 3300s
  5698  1876     cutoff   18      20293.5067 28647.8218  41.2%  7031 3339s
  5808  1889 27657.5935   16  402 20293.5067 28647.8218  41.2%  7006 3385s
  5912  1906 27490.5723   17  399 20293.5067 28616.3714  41.0%  6988 3423s
  6030  1917 24888.8051   19  552 20293.5067 28615.5499  41.0%  6959 3460s
  6132  1926 24609.8405   20  486 20293.5067 28445.7921  40.2%  6954 3499s
  6258  1891 23717.7155   23  478 20293.5067 28445.7921  40.2%  6931 3532s
  6314  1913 23320.8604   24  393 20293.5067 27868.0137  37.3%  6928 3569s
  6416  1908 23256.6111   25  394 20293.5067 27868.0137  37.3%  6896 3600s

Cutting planes:
  Learned: 3
  Gomory: 13
  Implied bound: 32
  Projected implied bound: 267
  MIR: 1171
  Mixing: 2
  Flow cover: 2082
  RLT: 48
  Relax-and-lift: 347

Explored 6530 nodes (45485345 simplex iterations) in 3600.05 seconds (9840.87 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 20293.5 19952.2 19933.3 ... 19601.3

Time limit reached
Best objective 2.029350674266e+04, best bound 2.786801372028e+04, gap 37.3248%
  WARNING: Time limit reached. Using best solution found (gap: 37.32%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = 20293.51, θ = 150537.01
  Upper Bound (UB) = 20293.51

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 150537.01
  [DEBUG]   ✓ Scenario 0: θ = 150537.01 ≤ Q = 150537.01 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 150537.01 ≤ Q = 150537.01 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 150537.01 ≤ Q = 150537.01 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 150537.01 ≤ Q = 151276.47 (slack: 739.46)
  [DEBUG]   ✓ Scenario 4: θ = 150537.01 ≤ Q = 150537.01 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 150537.01 ≤ Q = 150537.01 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 150537.01 ≤ Q = 150537.01 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 150537.01 ≤ Q = 150537.01 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 150537.01 ≤ Q = 150537.01 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 150537.01 ≤ Q = 150537.01 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 150537.01 ≤ Q = 150537.01 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 11] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x34273c04
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x34273c04
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.549846e+13
Presolve removed 2571 rows and 1864 columns
Presolve time: 0.00s
Presolved: 522 rows, 525 columns, 1472 nonzeros
Found heuristic solution: objective 8230047.4432
Variable types: 355 continuous, 170 integer (170 binary)

Root relaxation: objective -1.420493e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -142049.28    0  124 8230047.44 -142049.28   102%     -    0s
H    0     0                    -107074.1072 -142049.28  32.7%     -    0s
H    0     0                    -107511.5754 -142049.28  32.1%     -    0s
     0     0 -112382.58    0   75 -107511.58 -112382.58  4.53%     -    0s
H    0     0                    -111554.5332 -112319.78  0.69%     -    0s
     0     0 -111921.57    0   24 -111554.53 -111921.57  0.33%     -    0s
     0     0 -111913.65    0   23 -111554.53 -111913.65  0.32%     -    0s
     0     0 -111911.49    0   22 -111554.53 -111911.49  0.32%     -    0s
     0     0 -111844.78    0   18 -111554.53 -111844.78  0.26%     -    0s
     0     0 -111844.64    0   18 -111554.53 -111844.64  0.26%     -    0s
H    0     0                    -111577.6088 -111844.64  0.24%     -    0s
     0     0 -111672.40    0   10 -111577.61 -111672.40  0.08%     -    0s
     0     0 -111670.40    0   10 -111577.61 -111670.40  0.08%     -    0s
     0     0 -111670.33    0   10 -111577.61 -111670.33  0.08%     -    0s
H    0     0                    -111595.4770 -111663.34  0.06%     -    0s
     0     0 -111652.09    0    9 -111595.48 -111652.09  0.05%     -    0s
     0     0 -111646.85    0    7 -111595.48 -111646.85  0.05%     -    0s
     0     0 -111646.79    0    7 -111595.48 -111646.79  0.05%     -    0s
     0     0 -111616.21    0    5 -111595.48 -111616.21  0.02%     -    0s
     0     0 -111616.21    0    8 -111595.48 -111616.21  0.02%     -    0s
H    0     0                    -111605.3759 -111616.21  0.01%     -    0s

Explored 1 nodes (528 simplex iterations) in 0.04 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -111605 -111595 -111578 ... 1.54985e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.116053759061e+05, best bound -1.116162105183e+05, gap 0.0097%
  Subproblem solved in 0.05s
  Worst-case operational profit (Z_SP) = 149400.99
  Scenario: 8 demand increases, 52 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -111605.38
  [DEBUG]   S×d_nominal = 261006.37
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 261006.37 + -111605.38 = 149400.99
  [DEBUG]   Current θ from Master = 150537.01
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1136.01 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 19157.49
  Lower Bound (LB) = 19157.49
  Gap (UB-LB) = 1136.0144, Absolute Gap = 1136.0144, Relative Gap = 0.055979
  Not converged yet (gap = 1136.01 > ε = 200)

  [DEBUG] Adding NEW scenario 11 to Master Problem...
  [DEBUG] New scenario pattern: 8 increases, 52 decreases
    [DEBUG] Scenario 11 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 11 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 11]
    [DEBUG]   - Total constraints in model: 184863
    [DEBUG]   - Total variables in model: 77140
  [DEBUG] Total scenarios in Master: 12
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 12
================================================================================
[Iteration 12] Solving Master Problem...
  Current scenarios in Master: 12
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 184863 rows, 77140 columns and 524471 nonzeros
Model fingerprint: 0xe4355fa9
Variable types: 74881 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 78900 rows and 32040 columns
Presolve time: 1.53s
Presolved: 105963 rows, 45100 columns, 639287 nonzeros
Variable types: 42841 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -371874.0032
Found heuristic solution: objective -194531.7474

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.21s

Barrier statistics:
 Dense cols : 701
 AA' NZ     : 3.362e+06
 Factor NZ  : 8.279e+06 (roughly 130 MB of memory)
 Factor Ops : 1.639e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.38140528e+07  1.77584614e+08  7.78e+04 2.25e+01  5.80e+04     3s
   1  -1.04318556e+07  1.48679076e+08  5.43e+04 5.58e+01  3.98e+04     3s
   2  -3.19782402e+06  1.12926057e+08  1.61e+04 4.94e-01  1.26e+04     3s
   3  -1.07742599e+06  7.91419407e+07  3.71e+03 1.86e-01  3.05e+03     3s
   4  -4.95025010e+05  4.05668322e+07  5.96e+02 5.01e-02  5.99e+02     3s
   5  -3.99286243e+05  2.41657956e+07  3.25e+02 2.36e-02  3.19e+02     3s
   6  -2.37911133e+05  1.57651555e+07  9.09e+01 1.36e-02  1.31e+02     3s
   7  -1.41344805e+05  1.16863132e+07  4.39e+01 9.23e-03  8.14e+01     3s
   8  -8.26300494e+04  8.14323683e+06  1.90e+01 5.90e-03  4.94e+01     3s
   9  -6.35749167e+04  5.25655093e+06  1.05e+01 3.53e-03  3.02e+01     3s
  10  -4.64154092e+04  2.30174536e+06  6.31e+00 1.41e-03  1.29e+01     3s
  11  -1.17733362e+04  5.33826761e+05  2.25e+00 2.35e-04  2.91e+00     3s
  12  -3.03165132e+03  2.59554775e+05  1.42e+00 1.01e-04  1.38e+00     3s
  13   8.24600517e+03  1.54131947e+05  7.90e-01 1.16e-04  7.62e-01     3s
  14   1.25668753e+04  1.28524636e+05  6.60e-01 3.27e-04  6.05e-01     3s
  15   1.58157846e+04  1.19752726e+05  5.78e-01 3.61e-04  5.42e-01     3s
  16   2.01098859e+04  8.92957442e+04  4.92e-01 1.08e-03  3.61e-01     3s
  17   2.38516288e+04  7.82770100e+04  4.27e-01 1.66e-03  2.84e-01     3s
  18   2.92647192e+04  7.00400883e+04  3.39e-01 2.24e-03  2.13e-01     3s
  19   3.14858328e+04  6.34444352e+04  3.01e-01 2.12e-03  1.67e-01     3s
  20   3.55361444e+04  6.04879911e+04  2.39e-01 1.75e-03  1.30e-01     4s
  21   3.69643008e+04  5.87467974e+04  2.18e-01 1.85e-03  1.14e-01     4s
  22   3.98221144e+04  5.70824769e+04  1.77e-01 2.52e-03  9.00e-02     4s
  23   4.19188521e+04  5.55149187e+04  1.45e-01 2.74e-03  7.09e-02     4s
  24   4.36534504e+04  5.46811379e+04  1.19e-01 1.89e-03  5.75e-02     4s
  25   4.44403054e+04  5.41828416e+04  1.07e-01 1.78e-03  5.08e-02     4s
  26   4.62871149e+04  5.37530470e+04  7.84e-02 1.33e-03  3.89e-02     4s
  27   4.74164643e+04  5.28310057e+04  6.15e-02 1.67e-03  2.83e-02     4s
  28   4.75948717e+04  5.26237799e+04  5.86e-02 1.20e-03  2.63e-02     4s
  29   4.84308053e+04  5.24223790e+04  4.64e-02 1.72e-03  2.08e-02     4s
  30   4.91839002e+04  5.22587405e+04  3.59e-02 1.16e-03  1.61e-02     4s
  31   4.95755187e+04  5.21794214e+04  3.05e-02 9.30e-04  1.36e-02     4s
  32   4.99312745e+04  5.21282432e+04  2.54e-02 7.14e-04  1.15e-02     4s
  33   5.03365157e+04  5.20318017e+04  1.93e-02 1.26e-03  8.85e-03     4s
  34   5.05093070e+04  5.19811852e+04  1.69e-02 1.31e-03  7.68e-03     4s
  35   5.07933208e+04  5.19430289e+04  1.29e-02 1.10e-03  6.00e-03     4s
  36   5.09304053e+04  5.18961200e+04  1.10e-02 1.12e-03  5.04e-03     4s
  37   5.12062644e+04  5.18618878e+04  7.32e-03 6.77e-04  3.42e-03     4s
  38   5.12225427e+04  5.18114617e+04  7.10e-03 3.72e-04  3.07e-03     4s
  39   5.12929875e+04  5.17831944e+04  6.15e-03 3.72e-04  2.56e-03     4s
  40   5.14170713e+04  5.17775327e+04  4.43e-03 2.29e-04  1.88e-03     4s
  41   5.15114176e+04  5.17662196e+04  3.20e-03 3.70e-04  1.33e-03     4s
  42   5.15440112e+04  5.17648369e+04  2.75e-03 3.57e-04  1.15e-03     4s
  43   5.16266566e+04  5.17594885e+04  1.64e-03 2.18e-04  6.94e-04     4s
  44   5.16704604e+04  5.17578899e+04  1.04e-03 1.76e-04  4.56e-04     5s
  45   5.16720034e+04  5.17568281e+04  1.02e-03 1.53e-04  4.43e-04     5s
  46   5.16855608e+04  5.17551437e+04  8.37e-04 1.20e-04  3.63e-04     5s
  47   5.17004723e+04  5.17536437e+04  6.34e-04 8.37e-05  2.78e-04     5s
  48   5.17277929e+04  5.17521132e+04  2.66e-04 5.57e-05  1.27e-04     5s
  49   5.17379769e+04  5.17508680e+04  1.30e-04 2.92e-05  6.72e-05     5s
  50   5.17423481e+04  5.17505302e+04  7.70e-05 2.41e-05  4.26e-05     5s
  51   5.17424729e+04  5.17503347e+04  7.54e-05 2.12e-05  4.09e-05     5s
  52   5.17434138e+04  5.17498524e+04  6.44e-05 1.37e-05  3.35e-05     5s
  53   5.17472972e+04  5.17497041e+04  1.82e-05 1.13e-05  1.25e-05     5s
  54   5.17475196e+04  5.17496558e+04  1.55e-05 1.05e-05  1.11e-05     5s
  55   5.17485426e+04  5.17493440e+04  4.09e-06 6.45e-06  4.15e-06     5s
  56   5.17485988e+04  5.17489556e+04  3.48e-06 3.17e-07  1.86e-06     5s
  57   5.17488853e+04  5.17489130e+04  2.65e-07 1.28e-07  1.44e-07     5s
  58   5.17489109e+04  5.17489109e+04  1.59e-10 3.00e-10  1.61e-11     5s

Barrier solved model in 58 iterations and 5.24 seconds (9.55 work units)
Optimal objective 5.17489109e+04


Root crossover log...

   86460 DPushes remaining with DInf 0.0000000e+00                 5s
       0 DPushes remaining with DInf 0.0000000e+00                 7s

    2262 PPushes remaining with PInf 1.7796334e-06                 7s
       0 PPushes remaining with PInf 0.0000000e+00                 7s

  Push phase complete: Pinf 0.0000000e+00, Dinf 8.1638106e-11      7s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   32760    5.1748911e+04   0.000000e+00   0.000000e+00      7s
   32760    5.1748911e+04   0.000000e+00   0.000000e+00      7s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 5.174891e+04, 32760 iterations, 5.31 seconds (11.94 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 51748.9109    0  362 -194531.75 51748.9109   127%     -    7s
H    0     0                    -190622.2094 51748.9109   127%     -    7s
H    0     0                    -96063.13010 51748.9109   154%     -    8s
H    0     0                    -91702.86232 51748.9109   156%     -    8s
H    0     0                    -76574.45793 51748.9109   168%     -    8s
H    0     0                    -73198.49450 51748.9109   171%     -    8s
H    0     0                    -65617.35607 51748.9109   179%     -    8s
H    0     0                    -59428.87107 51748.9109   187%     -    8s
H    0     0                    -26265.42353 51748.9109   297%     -    8s
H    0     0                    -24649.22842 51748.9109   310%     -    8s
H    0     0                    -11130.71296 51748.9109   565%     -    9s
H    0     0                    -10728.79304 51748.9109   582%     -    9s
H    0     0                    -8854.685574 44718.1643   605%     -   43s
H    0     0                    -8561.250366 44718.1643   622%     -   43s
     0     0 44718.1643    0  413 -8561.2504 44718.1643   622%     -   43s
H    0     0                    -922.9190917 44717.3990  4945%     -   44s
H    0     0                    2694.1468338 44717.3990  1560%     -   44s
     0     0 44193.5817    0  418 2694.14683 44193.5817  1540%     -   60s
     0     0 44091.1382    0  429 2694.14683 44091.1382  1537%     -   68s
     0     0 44091.1382    0  424 2694.14683 44091.1382  1537%     -   72s
     0     0 44091.1382    0  433 2694.14683 44091.1382  1537%     -   75s
     0     0 44085.8759    0  426 2694.14683 44085.8759  1536%     -   79s
     0     0 44042.8187    0  432 2694.14683 44042.8187  1535%     -   82s
     0     0 44042.4180    0  429 2694.14683 44042.4180  1535%     -   83s
H    0     0                    6107.3037798 41042.2429   572%     -  136s
H    0     0                    6165.5713970 41042.2429   566%     -  136s
H    0     0                    6259.0174082 41042.2429   556%     -  136s
H    0     0                    6266.4090776 41042.2429   555%     -  136s
H    0     0                    6352.6443423 41042.2429   546%     -  136s
     0     0 41042.2429    0  306 6352.64434 41042.2429   546%     -  136s
H    0     0                    10357.125053 41042.2382   296%     -  136s
H    0     0                    10757.659872 41042.2382   282%     -  136s
H    0     0                    11052.480181 41042.2382   271%     -  136s
     0     0 40570.6113    0  461 11052.4802 40570.6113   267%     -  161s
     0     0 40356.3436    0  479 11052.4802 40356.3436   265%     -  181s
     0     0 40044.1148    0  473 11052.4802 40044.1148   262%     -  195s
     0     0 39954.0136    0  494 11052.4802 39954.0136   261%     -  210s
     0     0 39926.7475    0  484 11052.4802 39926.7475   261%     -  217s
     0     0 39879.0909    0  478 11052.4802 39879.0909   261%     -  226s
     0     0 39855.4607    0  490 11052.4802 39855.4607   261%     -  234s
     0     0 39850.9615    0  486 11052.4802 39850.9615   261%     -  237s
     0     0 39850.6244    0  481 11052.4802 39850.6244   261%     -  238s
H    0     0                    18789.038815 37487.6857   100%     -  312s
     0     0 37487.6857    0  509 18789.0388 37487.6857   100%     -  312s
H    0     0                    18861.097500 37487.1471  98.8%     -  312s
H    0     0                    18942.795758 37487.1471  97.9%     -  313s
H    0     0                    19148.670034 37030.1536  93.4%     -  338s
H    0     0                    19221.253160 37030.1536  92.7%     -  338s
     0     0 37030.1536    0  537 19221.2532 37030.1536  92.7%     -  338s
     0     0 36848.5988    0  549 19221.2532 36848.5988  91.7%     -  359s
     0     0 36739.0433    0  552 19221.2532 36739.0433  91.1%     -  371s
     0     0 36710.7712    0  596 19221.2532 36710.7712  91.0%     -  378s
     0     0 36687.5694    0  591 19221.2532 36687.5694  90.9%     -  383s
     0     0 36677.3757    0  597 19221.2532 36677.3757  90.8%     -  386s
     0     0 36667.0069    0  559 19221.2532 36667.0069  90.8%     -  391s
H    0     0                    19239.017903 36646.1234  90.5%     -  396s
     0     0 36646.1234    0  603 19239.0179 36646.1234  90.5%     -  396s
     0     0 36600.0539    0  553 19239.0179 36600.0539  90.2%     -  405s
H    0     0                    19246.043141 36590.1589  90.1%     -  410s
H    0     0                    19266.365165 36590.1589  89.9%     -  410s
     0     0 36590.1589    0  575 19266.3652 36590.1589  89.9%     -  410s
     0     0 36583.4051    0  606 19266.3652 36583.4051  89.9%     -  414s
     0     0 36561.0803    0  564 19266.3652 36561.0803  89.8%     -  419s
     0     0 36463.9079    0  544 19266.3652 36463.9079  89.3%     -  430s
     0     0 36423.5821    0  565 19266.3652 36423.5821  89.1%     -  435s
     0     0 36420.9350    0  571 19266.3652 36420.9350  89.0%     -  436s
     0     0 36364.9521    0  538 19266.3652 36364.9521  88.7%     -  443s
     0     0 36349.1661    0  544 19266.3652 36349.1661  88.7%     -  446s
     0     0 36338.0925    0  537 19266.3652 36338.0925  88.6%     -  449s
     0     0 36326.4279    0  568 19266.3652 36326.4279  88.5%     -  452s
     0     0 36324.2994    0  562 19266.3652 36324.2994  88.5%     -  454s
     0     0 34558.9955    0  450 19266.3652 34558.9955  79.4%     -  501s
     0     0 34105.6136    0  551 19266.3652 34105.6136  77.0%     -  525s
     0     0 33901.1447    0  503 19266.3652 33901.1447  76.0%     -  544s
     0     0 33793.3734    0  491 19266.3652 33793.3734  75.4%     -  552s
     0     0 33536.5512    0  520 19266.3652 33536.5512  74.1%     -  568s
     0     0 33489.2018    0  560 19266.3652 33489.2018  73.8%     -  574s
     0     0 33454.8106    0  516 19266.3652 33454.8106  73.6%     -  579s
     0     0 33437.4110    0  529 19266.3652 33437.4110  73.6%     -  583s
     0     0 33427.1291    0  580 19266.3652 33427.1291  73.5%     -  586s
     0     0 33413.0510    0  578 19266.3652 33413.0510  73.4%     -  588s
     0     0 33409.9977    0  521 19266.3652 33409.9977  73.4%     -  590s
     0     0 33387.1704    0  517 19266.3652 33387.1704  73.3%     -  592s
     0     0 33369.0611    0  518 19266.3652 33369.0611  73.2%     -  597s
     0     0 33364.0884    0  509 19266.3652 33364.0884  73.2%     -  599s
     0     0 33362.2425    0  513 19266.3652 33362.2425  73.2%     -  600s
H    0     0                    19407.894531 33068.3134  70.4%     -  617s
H    0     0                    19502.110479 33068.3134  69.6%     -  617s
     0     0 33068.3134    0  562 19502.1105 33068.3134  69.6%     -  617s
H    0     0                    19518.544161 33066.9935  69.4%     -  618s
     0     0 32928.8007    0  526 19518.5442 32928.8007  68.7%     -  628s
     0     0 32876.7491    0  560 19518.5442 32876.7491  68.4%     -  636s
     0     0 32850.4642    0  541 19518.5442 32850.4642  68.3%     -  641s
     0     0 32836.1703    0  550 19518.5442 32836.1703  68.2%     -  644s
     0     0 32828.0721    0  548 19518.5442 32828.0721  68.2%     -  647s
     0     0 32827.2241    0  548 19518.5442 32827.2241  68.2%     -  648s
     0     0 32654.2977    0  589 19518.5442 32654.2977  67.3%     -  663s
     0     0 32587.0994    0  596 19518.5442 32587.0994  67.0%     -  675s
     0     0 32520.3868    0  554 19518.5442 32520.3868  66.6%     -  681s
H    0     0                    19556.957459 32486.1833  66.1%     -  685s
     0     0 32486.1833    0  546 19556.9575 32486.1833  66.1%     -  685s
     0     0 32475.0379    0  599 19556.9575 32475.0379  66.1%     -  689s
     0     0 32453.7584    0  601 19556.9575 32453.7584  65.9%     -  694s
     0     0 32443.1341    0  550 19556.9575 32443.1341  65.9%     -  696s
     0     0 32439.4393    0  555 19556.9575 32439.4393  65.9%     -  698s
     0     0 32437.2962    0  558 19556.9575 32437.2962  65.9%     -  699s
     0     0 32336.7433    0  569 19556.9575 32336.7433  65.3%     -  709s
     0     0 32302.1939    0  582 19556.9575 32302.1939  65.2%     -  715s
     0     0 32296.7198    0  585 19556.9575 32296.7198  65.1%     -  717s
     0     0 32289.0665    0  590 19556.9575 32289.0665  65.1%     -  719s
     0     0 32285.1658    0  601 19556.9575 32285.1658  65.1%     -  720s
     0     0 32271.6265    0  591 19556.9575 32271.6265  65.0%     -  723s
     0     0 32267.4457    0  608 19556.9575 32267.4457  65.0%     -  725s
     0     0 32264.4309    0  561 19556.9575 32264.4309  65.0%     -  727s
     0     0 32175.9824    0  555 19556.9575 32175.9824  64.5%     -  734s
H    0     0                    19572.653717 32175.7700  64.4%     -  736s
     0     0 32137.4017    0  543 19572.6537 32137.4017  64.2%     -  740s
     0     0 32114.7359    0  537 19572.6537 32114.7359  64.1%     -  744s
     0     0 32106.5606    0  622 19572.6537 32106.5606  64.0%     -  747s
     0     0 32101.4884    0  622 19572.6537 32101.4884  64.0%     -  749s
     0     0 32100.4291    0  622 19572.6537 32100.4291  64.0%     -  749s
     0     0 32061.6831    0  548 19572.6537 32061.6831  63.8%     -  756s
     0     0 32054.1236    0  556 19572.6537 32054.1236  63.8%     -  759s
     0     0 32048.2903    0  549 19572.6537 32048.2903  63.7%     -  761s
     0     0 32047.2228    0  537 19572.6537 32047.2228  63.7%     -  763s
     0     0 32018.3495    0  666 19572.6537 32018.3495  63.6%     -  769s
     0     0 31997.0921    0  644 19572.6537 31997.0921  63.5%     -  775s
     0     0 31985.2675    0  650 19572.6537 31985.2675  63.4%     -  778s
     0     0 31980.8554    0  655 19572.6537 31980.8554  63.4%     -  779s
     0     0 31978.0061    0  544 19572.6537 31978.0061  63.4%     -  781s
     0     0 31968.8182    0  648 19572.6537 31968.8182  63.3%     -  785s
H    0     0                    19573.490540 31968.5328  63.3%     -  786s
     0     0 31966.7447    0  659 19573.4905 31966.7447  63.3%     -  788s
H    0     0                    19574.806136 31966.7447  63.3%     -  789s
     0     0 31919.8488    0  583 19574.8061 31919.8488  63.1%     -  793s
H    0     0                    19617.835239 31919.8024  62.7%     -  796s
     0     0 31917.7171    0  595 19617.8352 31917.7171  62.7%     -  799s
     0     0 31876.5118    0  590 19617.8352 31876.5118  62.5%     -  805s
     0     0 31858.7869    0  566 19617.8352 31858.7869  62.4%     -  809s
     0     0 31854.3770    0  552 19617.8352 31854.3770  62.4%     -  812s
     0     0 31848.9793    0  553 19617.8352 31848.9793  62.3%     -  814s
     0     0 31848.0699    0  546 19617.8352 31848.0699  62.3%     -  815s
     0     0 31831.2374    0  542 19617.8352 31831.2374  62.3%     -  818s
     0     0 31823.6475    0  553 19617.8352 31823.6475  62.2%     -  872s
     0     0 31820.5090    0  560 19617.8352 31820.5090  62.2%     -  873s
     0     0 31814.1418    0  592 19617.8352 31814.1418  62.2%     -  877s
     0     0 31808.6379    0  589 19617.8352 31808.6379  62.1%     -  879s
     0     0 31806.9701    0  594 19617.8352 31806.9701  62.1%     -  880s
     0     0 31803.4398    0  552 19617.8352 31803.4398  62.1%     -  882s
     0     0 31803.3478    0  552 19617.8352 31803.3478  62.1%     -  886s
     0     2 31803.3190    0  552 19617.8352 31803.3190  62.1%     -  960s
     1     3 30367.0282    1  597 19617.8352 31801.8911  62.1% 25107  983s
     2     5 30283.8696    2  526 19617.8352 31801.8911  62.1% 15622  991s
     4     9 30100.2766    3  526 19617.8352 31554.8836  60.8% 13773 1011s
     8    17 30719.0152    3  467 19617.8352 31552.7323  60.8% 14321 1048s
    16    34 30269.7337    4  458 19617.8352 31013.5968  58.1% 16359 1074s
    33    49 30482.6607    5  485 19617.8352 30816.8603  57.1% 20635 1140s
    48    77 28518.4875    6  323 19617.8352 30816.8603  57.1% 23246 1256s
    76   210 28372.1694    7  321 19617.8352 30816.8603  57.1% 18064 1304s
   213   255 27928.4799   10  294 19617.8352 30816.8603  57.1% 10844 1327s
H  215   255                    19642.557213 30816.8603  56.9% 10772 1327s
H  223   255                    19649.712029 30816.8603  56.8% 10523 1327s
H  225   255                    19662.109980 30816.8603  56.7% 10465 1327s
H  248   255                    19666.461116 30816.8603  56.7%  9923 1327s
   262   303 26734.2147   11  291 19666.4611 30816.8603  56.7%  9628 1349s
   322   345 26726.0314   11  295 19666.4611 30816.8603  56.7%  8691 1370s
   368   381 25357.1329   13  260 19666.4611 30816.8603  56.7%  8256 1390s
   408   418 25237.4154   12  338 19666.4611 30816.8603  56.7%  8093 1415s
   459   443 26471.2738   12  288 19666.4611 30816.8603  56.7%  7792 1439s
   512   468 26044.0264   13  284 19666.4611 30816.8603  56.7%  7578 1461s
   537   494 24472.6619   14  257 19666.4611 30816.8603  56.7%  7587 1482s
H  553   494                    19684.131601 30816.8603  56.6%  7549 1482s
   573   517 24398.6135   15  259 19684.1316 30816.8603  56.6%  7547 1504s
   602   545 24308.7294   16  255 19684.1316 30816.8603  56.6%  7431 1537s
   646   580 21342.8812   17  235 19684.1316 30816.8603  56.6%  7323 1561s
   697   621 infeasible   18      19684.1316 30816.8603  56.6%  7154 1593s
   756   646 infeasible   20      19684.1316 30816.8603  56.6%  6927 1614s
   814   680 26957.5797   13  426 19684.1316 30816.8603  56.6%  6710 1635s
   867   714 26780.5577   14  344 19684.1316 30816.8603  56.6%  6533 1656s
   939   763 26591.9394   15  385 19684.1316 30816.8603  56.6%  6285 1681s
  1004   829 26487.5283   16  381 19684.1316 30816.8603  56.6%  6105 1702s
  1104   904 20320.1490   17  202 19684.1316 30816.8603  56.6%  5803 1724s
  1215   957 26262.1283   16  253 19684.1316 30816.8603  56.6%  5514 1748s
  1321  1019 24335.8148   18  208 19684.1316 30816.8603  56.6%  5283 1773s
  1429  1076 infeasible   19      19684.1316 30816.8603  56.6%  5121 1799s
  1540  1099 24424.7826   17  234 19684.1316 30816.8603  56.6%  4985 1822s
  1577  1118 23596.9266   18  211 19684.1316 30816.8603  56.6%  4994 1844s
H 1583  1118                    19707.494729 30816.8603  56.4%  4986 1844s
  1622  1223 22593.2044   19  206 19707.4947 30816.8603  56.4%  4981 1873s
  1769  1316 infeasible   21      19707.4947 30816.8603  56.4%  4806 1902s
  1940  1417 21891.6781   26  196 19707.4947 30816.8603  56.4%  4585 1936s
  2080  1493 21337.2900   31  207 19707.4947 30816.8603  56.4%  4480 1971s
  2202  1576 20777.0122   37  129 19707.4947 30816.8603  56.4%  4460 2005s
  2361  1647 infeasible   50      19707.4947 30816.8603  56.4%  4373 2041s
  2525  1675 27219.8666   10  301 19707.4947 30816.8603  56.4%  4281 2080s
  2677  1717 27015.9822   11  288 19707.4947 30816.8603  56.4%  4231 2110s
  2771  1748 24996.8461   13  282 19707.4947 30608.1997  55.3%  4220 2149s
  2870  1771 20335.8596   14  212 19707.4947 30608.1997  55.3%  4251 2189s
  2973  1819 22986.3454   15  237 19707.4947 30608.1997  55.3%  4277 2233s
  3070  1855 21209.8999   17  213 19707.4947 29998.9212  52.2%  4348 2269s
  3157  1862 infeasible   18      19707.4947 29998.9212  52.2%  4335 2310s
  3205  1912 20380.5676   19  164 19707.4947 29819.5174  51.3%  4373 2349s
H 3259  1912                    19712.675713 29819.5174  51.3%  4409 2349s
  3267  1971 19843.9258   24  133 19712.6757 29819.5174  51.3%  4413 2403s
  3433  2026 22893.5268   12  295 19712.6757 29556.9815  49.9%  4416 2451s
  3572  2085 20712.0841   13  277 19712.6757 29556.9815  49.9%  4426 2501s
  3729  2144 27185.1109    8  304 19712.6757 28707.3191  45.6%  4438 2554s
  3890  2200 23807.4846   10  249 19712.6757 28707.3191  45.6%  4473 2608s
  4004  2255 22731.0434   14  217 19712.6757 28707.3191  45.6%  4565 2663s
  4118  2325 21472.5340   14  207 19712.6757 28550.3210  44.8%  4662 2719s
  4291  2407 21330.1957   15  184 19712.6757 28443.9198  44.3%  4690 2770s
H 4317  2406                    19723.919538 28430.0163  44.1%  4689 2770s
  4479  2502 20461.1896   22  234 19723.9195 28408.9752  44.0%  4640 2835s
  4727  2597 26538.0024   11  294 19723.9195 28408.9752  44.0%  4619 2904s
  4941  2598 23534.1432   16  552 19723.9195 28408.9752  44.0%  4645 3165s
H 4942  2469                    19724.411420 28408.9752  44.0%  4644 3173s
H 4942  2345                    19726.900243 28408.9752  44.0%  4644 3173s
  4943  2345 19955.0537   33  172 19726.9002 28408.9752  44.0%  4643 3175s
  4944  2346 20251.2428   51  394 19726.9002 28408.9752  44.0%  4642 3235s
  4945  2347 24782.3462   16  439 19726.9002 28408.9752  44.0%  4641 3294s
  4946  2347 26787.0115   11  388 19726.9002 28408.9752  44.0%  4640 3323s
  4947  2348 24812.6250   14  517 19726.9002 28408.9752  44.0%  4639 3350s
  4948  2349 24280.1192    9  477 19726.9002 28408.9752  44.0%  4638 3379s
H 4948  2232                    19735.919688 28408.9752  43.9%  4638 3396s
  4950  2233 21780.4663   23  485 19735.9197 28408.9752  43.9%  4636 3416s
  4951  2234 24470.6485   15  509 19735.9197 28408.9752  43.9%  4635 3430s
  4952  2234 20499.5667   24  507 19735.9197 28408.9752  43.9%  4634 3438s
  4953  2235 20144.4644   56  462 19735.9197 28408.9752  43.9%  4633 3442s
  4954  2236 20077.2452   55  456 19735.9197 28408.9752  43.9%  4633 3447s
  4955  2236 23108.7179   12  450 19735.9197 28408.9752  43.9%  4632 3453s
  4956  2237 21814.0317   14  500 19735.9197 28408.9752  43.9%  4631 3461s
  4957  2238 20997.5009   55  521 19735.9197 28408.9752  43.9%  4630 3465s
  4958  2238 20010.9165   36  528 19735.9197 28408.9752  43.9%  4629 3470s
H 4959  2126                    19746.232168 28408.9752  43.9%  4628 3484s
H 4959  2020                    19757.053433 28408.9752  43.8%  4628 3490s
  4961  2021 21548.8146   16  469 19757.0534 28408.9752  43.8%  4626 3496s
  4962  2022 27375.4673    9  468 19757.0534 28408.9752  43.8%  4625 3501s
  4963  2023 19762.9992  105  483 19757.0534 28408.9752  43.8%  4624 3506s
  4964  2023 20646.2126   30  513 19757.0534 28408.9752  43.8%  4623 3518s
  4965  2024 24886.4150    7  522 19757.0534 28408.9752  43.8%  4622 3525s
  4966  2025 24968.0270   13  570 19757.0534 28408.9752  43.8%  4621 3530s
  4968  2026 27687.7826   13  464 19757.0534 28408.9752  43.8%  4619 3540s
  4969  2027 21515.6732   47  453 19757.0534 28408.9752  43.8%  4619 3545s
  4970  2027 24315.6403   15  447 19757.0534 28408.9752  43.8%  4618 3553s
  4971  2028 22244.5020   14  456 19757.0534 28408.9752  43.8%  4617 3557s
  4972  2029 24916.0197   17  449 19757.0534 28408.9752  43.8%  4616 3565s
  4974  2030 21534.8491   15  456 19757.0534 28408.9752  43.8%  4614 3577s
  4975  2031 26014.2033   14  466 19757.0534 28408.9752  43.8%  4613 3580s
  4976  2031 25067.7744   14  466 19757.0534 28408.9752  43.8%  4612 3588s
  4977  2032 21337.2807   32  528 19757.0534 28408.9752  43.8%  4611 3593s

Cutting planes:
  Gomory: 19
  Implied bound: 66
  Projected implied bound: 219
  MIR: 853
  Mixing: 2
  Flow cover: 949
  RLT: 66
  Relax-and-lift: 316

Explored 4977 nodes (24193917 simplex iterations) in 3600.04 seconds (8553.10 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 19757.1 19746.2 19735.9 ... 19666.5

Time limit reached
Best objective 1.975705343269e+04, best bound 2.840897523839e+04, gap 43.7916%
  WARNING: Time limit reached. Using best solution found (gap: 43.79%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.10s
  Master Objective (UB) = 19757.05, θ = 142368.89
  Upper Bound (UB) = 19757.05

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 142368.89
  [DEBUG]   ✓ Scenario 0: θ = 142368.89 ≤ Q = 142368.89 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 142368.89 ≤ Q = 142368.89 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 142368.89 ≤ Q = 142368.89 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 142368.89 ≤ Q = 142368.89 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 142368.89 ≤ Q = 142368.89 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 142368.89 ≤ Q = 142368.89 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 142368.89 ≤ Q = 142379.03 (slack: 10.14)
  [DEBUG]   ✓ Scenario 7: θ = 142368.89 ≤ Q = 142368.89 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 142368.89 ≤ Q = 142368.89 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 142368.89 ≤ Q = 142368.89 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 142368.89 ≤ Q = 142368.89 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 142368.89 ≤ Q = 142368.89 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 12] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x7ff10afc
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x800ef504
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [3e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [3e-13, 2e+02]
Found heuristic solution: objective 1.460667e+13
Presolve removed 2571 rows and 1864 columns
Presolve time: 0.00s
Presolved: 522 rows, 525 columns, 1472 nonzeros
Found heuristic solution: objective 7765024.2810
Variable types: 355 continuous, 170 integer (170 binary)

Root relaxation: objective -1.353237e+05, 248 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -135323.70    0  124 7765024.28 -135323.70   102%     -    0s
H    0     0                    -100412.6114 -135323.70  34.8%     -    0s
H    0     0                    -100922.9659 -135323.70  34.1%     -    0s
     0     0 -107960.55    0  138 -100922.97 -107960.55  6.97%     -    0s
H    0     0                    -103163.2826 -107927.59  4.62%     -    0s
     0     0 -107101.66    0  136 -103163.28 -107101.66  3.82%     -    0s
     0     0 -106952.45    0  136 -103163.28 -106952.45  3.67%     -    0s
H    0     0                    -103864.2459 -106952.45  2.97%     -    0s
     0     0 -106729.50    0  134 -103864.25 -106729.50  2.76%     -    0s
H    0     0                    -104643.6179 -106718.19  1.98%     -    0s
     0     0 -106703.97    0  133 -104643.62 -106703.97  1.97%     -    0s
     0     0 -106703.30    0  133 -104643.62 -106703.30  1.97%     -    0s
     0     0 -106426.78    0  130 -104643.62 -106426.78  1.70%     -    0s
H    0     0                    -104674.7983 -106409.57  1.66%     -    0s
     0     0 -106409.57    0  130 -104674.80 -106409.57  1.66%     -    0s
     0     0 -106136.18    0  129 -104674.80 -106136.18  1.40%     -    0s
     0     0 -106119.03    0  129 -104674.80 -106119.03  1.38%     -    0s
     0     0 -106046.80    0   91 -104674.80 -106046.80  1.31%     -    0s
     0     0 -106021.81    0  130 -104674.80 -106021.81  1.29%     -    0s
     0     0 -106017.92    0  130 -104674.80 -106017.92  1.28%     -    0s
     0     0 -105954.91    0   91 -104674.80 -105954.91  1.22%     -    0s
     0     0 -105951.52    0   91 -104674.80 -105951.52  1.22%     -    0s
     0     2 -105951.52    0   91 -104674.80 -105951.52  1.22%     -    0s
H    6     8                    -104737.3532 -105916.90  1.13%  16.8    0s
H   93   115                    -104811.0650 -105703.57  0.85%  16.4    0s
*  918   273              31    -104877.7130 -105321.06  0.42%   7.4    0s
*  920   273              32    -104920.4242 -105321.06  0.38%   7.4    0s
*  984   273              33    -104951.7571 -105321.06  0.35%   7.2    0s
* 1230   263              36    -104955.6191 -105316.39  0.34%   6.9    0s
* 1419   302              31    -104957.7367 -105258.49  0.29%   6.8    0s
* 1424   302              33    -104981.4527 -105258.49  0.26%   6.8    0s

Cutting planes:
  Gomory: 52
  MIR: 241
  RLT: 5
  BQP: 1

Explored 2372 nodes (16624 simplex iterations) in 0.13 seconds (0.15 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -104981 -104958 -104956 ... -104644
No other solutions better than -104981

Optimal solution found (tolerance 1.00e-04)
Best objective -1.049814526837e+05, best bound -1.049814526837e+05, gap 0.0000%
  Subproblem solved in 0.15s
  Worst-case operational profit (Z_SP) = 141302.57
  Scenario: 16 demand increases, 44 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -104981.45
  [DEBUG]   S×d_nominal = 246284.02
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 246284.02 + -104981.45 = 141302.57
  [DEBUG]   Current θ from Master = 142368.89
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1066.32 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 18690.73
  Lower Bound (LB) = 19157.49
  Gap (UB-LB) = 599.5611, Absolute Gap = 599.5611, Relative Gap = 0.030347
  Not converged yet (gap = 599.56 > ε = 200)

  [DEBUG] Adding NEW scenario 12 to Master Problem...
  [DEBUG] New scenario pattern: 16 increases, 44 decreases
    [DEBUG] Scenario 12 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 12 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 12]
    [DEBUG]   - Total constraints in model: 200153
    [DEBUG]   - Total variables in model: 83380
  [DEBUG] Total scenarios in Master: 13
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 13
================================================================================
[Iteration 13] Solving Master Problem...
  Current scenarios in Master: 13
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 200153 rows, 83380 columns and 567717 nonzeros
Model fingerprint: 0xe4a9105d
Variable types: 81121 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 85485 rows and 34715 columns
Presolve time: 1.74s
Presolved: 114668 rows, 48665 columns, 689770 nonzeros
Variable types: 46406 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -375198.6638
Found heuristic solution: objective -194531.7474

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.24s

Barrier statistics:
 Dense cols : 692
 AA' NZ     : 3.820e+06
 Factor NZ  : 1.017e+07 (roughly 150 MB of memory)
 Factor Ops : 2.996e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.43933668e+07  1.90250607e+08  8.11e+04 2.30e+01  6.00e+04     3s
   1  -1.08925753e+07  1.60100017e+08  5.66e+04 5.72e+01  4.12e+04     3s
   2  -3.44208988e+06  1.21291030e+08  1.75e+04 6.55e-01  1.35e+04     3s
   3  -8.48671870e+05  8.12313164e+07  2.27e+03 2.61e-01  2.00e+03     3s
   4  -4.68381983e+05  3.36266355e+07  4.19e+02 8.04e-02  4.29e+02     3s
   5  -3.45356472e+05  2.32576121e+07  1.66e+02 4.37e-02  2.11e+02     3s
   6  -2.27336859e+05  1.70141602e+07  6.77e+01 2.85e-02  1.18e+02     3s
   7  -1.11106365e+05  1.22558315e+07  2.35e+01 1.88e-02  6.94e+01     3s
   8  -7.70925877e+04  8.65836980e+06  1.30e+01 1.27e-02  4.61e+01     3s
   9  -6.01863198e+04  5.13087798e+06  8.08e+00 7.19e-03  2.66e+01     3s
  10  -4.12879399e+04  2.70727882e+06  4.50e+00 3.50e-03  1.37e+01     3s
  11  -8.94330822e+03  5.23916700e+05  1.20e+00 7.16e-04  2.58e+00     4s
  12  -3.39324019e+02  2.74726022e+05  7.59e-01 5.28e-04  1.33e+00     4s
  13   9.87360818e+03  1.62217566e+05  4.46e-01 6.63e-04  7.31e-01     4s
  14   1.38110304e+04  1.37908911e+05  3.79e-01 7.44e-04  5.95e-01     4s
  15   1.76811167e+04  1.25733155e+05  3.22e-01 8.04e-04  5.18e-01     4s
  16   1.98300122e+04  1.02164445e+05  2.90e-01 7.53e-04  3.95e-01     4s
  17   2.81526872e+04  8.77203257e+04  1.99e-01 1.38e-03  2.85e-01     4s
  18   2.96001073e+04  7.50169949e+04  1.84e-01 2.11e-03  2.18e-01     4s
  19   3.25102628e+04  6.86129570e+04  1.58e-01 2.29e-03  1.73e-01     4s
  20   3.60580239e+04  6.47855140e+04  1.25e-01 2.96e-03  1.38e-01     4s
  21   3.87473347e+04  6.24695685e+04  1.02e-01 4.82e-03  1.14e-01     4s
  22   4.01260593e+04  6.08489016e+04  9.06e-02 4.01e-03  9.93e-02     4s
  23   4.16515443e+04  5.87361773e+04  7.86e-02 3.23e-03  8.19e-02     4s
  24   4.29700510e+04  5.71333277e+04  6.84e-02 2.36e-03  6.79e-02     4s
  25   4.32042973e+04  5.65038515e+04  6.66e-02 2.21e-03  6.38e-02     4s
  26   4.45130222e+04  5.58867929e+04  5.65e-02 2.22e-03  5.45e-02     4s
  27   4.59127216e+04  5.54380063e+04  4.56e-02 1.97e-03  4.57e-02     4s
  28   4.64935467e+04  5.42976994e+04  4.10e-02 1.77e-03  3.74e-02     4s
  29   4.71539617e+04  5.38354179e+04  3.56e-02 1.53e-03  3.20e-02     4s
  30   4.84018724e+04  5.32633424e+04  2.60e-02 1.98e-03  2.33e-02     4s
  31   4.92536860e+04  5.29634988e+04  1.96e-02 1.61e-03  1.78e-02     4s
  32   4.97265687e+04  5.27870240e+04  1.61e-02 1.24e-03  1.47e-02     5s
  33   5.02382077e+04  5.25252231e+04  1.23e-02 8.42e-04  1.10e-02     5s
  34   5.05817148e+04  5.24206568e+04  9.73e-03 6.75e-04  8.82e-03     5s
  35   5.07594762e+04  5.23068851e+04  8.41e-03 5.11e-04  7.42e-03     5s
  36   5.10060486e+04  5.22557364e+04  6.70e-03 4.28e-04  5.99e-03     5s
  37   5.12799162e+04  5.21962485e+04  4.73e-03 3.39e-04  4.39e-03     5s
  38   5.14817955e+04  5.21512049e+04  3.26e-03 2.71e-04  3.21e-03     5s
  39   5.16359779e+04  5.20680251e+04  2.20e-03 2.03e-04  2.07e-03     5s
  40   5.16931032e+04  5.20445457e+04  1.83e-03 1.47e-04  1.68e-03     5s
  41   5.17620399e+04  5.20128597e+04  1.36e-03 7.96e-05  1.20e-03     5s
  42   5.18636024e+04  5.19970581e+04  7.07e-04 4.56e-05  6.40e-04     5s
  43   5.18879655e+04  5.19856024e+04  5.51e-04 2.08e-05  4.68e-04     5s
  44   5.18954986e+04  5.19813133e+04  5.00e-04 1.32e-05  4.12e-04     5s
  45   5.19328560e+04  5.19780746e+04  2.63e-04 1.05e-05  2.17e-04     5s
  46   5.19473265e+04  5.19756819e+04  1.69e-04 1.73e-06  1.36e-04     5s
  47   5.19481990e+04  5.19746930e+04  1.63e-04 6.73e-07  1.27e-04     5s
  48   5.19552722e+04  5.19742166e+04  1.16e-04 2.64e-07  9.09e-05     5s
  49   5.19666509e+04  5.19741247e+04  4.37e-05 2.09e-07  3.58e-05     6s
  50   5.19670920e+04  5.19740769e+04  4.09e-05 1.38e-07  3.35e-05     6s
  51   5.19707909e+04  5.19739086e+04  1.78e-05 1.80e-08  1.50e-05     6s
  52   5.19733615e+04  5.19738274e+04  2.44e-06 1.02e-08  2.23e-06     6s
  53   5.19737879e+04  5.19738016e+04  7.64e-08 1.73e-07  6.54e-08     6s
  54   5.19737999e+04  5.19737999e+04  1.86e-08 3.32e-10  9.25e-11     6s

Barrier solved model in 54 iterations and 5.83 seconds (10.42 work units)
Optimal objective 5.19737999e+04


Root crossover log...

   93880 DPushes remaining with DInf 0.0000000e+00                 6s
       0 DPushes remaining with DInf 0.0000000e+00                 8s

    3433 PPushes remaining with PInf 1.7115731e-05                 8s
       0 PPushes remaining with PInf 0.0000000e+00                 8s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.1338027e-10      8s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   38338    5.1973800e+04   0.000000e+00   0.000000e+00      8s
   38338    5.1973800e+04   0.000000e+00   0.000000e+00      8s
Concurrent spin time: 0.01s

Solved with barrier

Root relaxation: objective 5.197380e+04, 38338 iterations, 5.84 seconds (12.90 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 51973.7999    0  363 -194531.75 51973.7999   127%     -    8s
H    0     0                    -189619.4216 51973.7999   127%     -    8s
H    0     0                    -84881.19139 51973.7999   161%     -    9s
H    0     0                    -83696.49426 51973.7999   162%     -    9s
H    0     0                    -81777.25187 51973.7999   164%     -    9s
H    0     0                    -52119.08772 51973.7999   200%     -    9s
H    0     0                    -52062.23052 51973.7999   200%     -    9s
H    0     0                    -26275.49951 51973.7999   298%     -    9s
H    0     0                    -8920.938071 51973.7999   683%     -    9s
H    0     0                    1310.0004785 51973.7999  3867%     -    9s
H    0     0                    3021.7829649 51973.7999  1620%     -    9s
H    0     0                    5998.5703552 51972.9852   766%     -   11s
H    0     0                    6019.4662397 51972.9852   763%     -   11s
H    0     0                    6120.2425159 51972.9852   749%     -   11s
H    0     0                    6259.0174082 51972.9852   730%     -   11s
     0     0 45090.8257    0  446 6259.01741 45090.8257   620%     -   35s
H    0     0                    6352.6443423 45090.7287   610%     -   36s
     0     0 44795.0965    0  427 6352.64434 44795.0965   605%     -   48s
     0     0 44663.8797    0  430 6352.64434 44663.8797   603%     -   55s
     0     0 44589.5538    0  446 6352.64434 44589.5538   602%     -   60s
     0     0 44589.5538    0  447 6352.64434 44589.5538   602%     -   61s
     0     0 44584.5905    0  445 6352.64434 44584.5905   602%     -   62s
     0     0 44581.8531    0  446 6352.64434 44581.8531   602%     -   64s
     0     0 44581.8531    0  445 6352.64434 44581.8531   602%     -   65s
     0     0 44581.8531    0  446 6352.64434 44581.8531   602%     -   67s
     0     0 41413.7734    0  434 6352.64434 41413.7734   552%     -  123s
H    0     0                    6750.9948009 40703.8416   503%     -  166s
H    0     0                    6752.4957228 40703.8416   503%     -  166s
H    0     0                    7608.6755414 40703.8416   435%     -  166s
H    0     0                    8151.4344134 40703.8416   399%     -  166s
     0     0 40703.8416    0  486 8151.43441 40703.8416   399%     -  166s
     0     0 40473.2578    0  453 8151.43441 40473.2578   397%     -  187s
     0     0 40319.4668    0  465 8151.43441 40319.4668   395%     -  204s
     0     0 40261.8213    0  559 8151.43441 40261.8213   394%     -  218s
     0     0 40243.5067    0  496 8151.43441 40243.5067   394%     -  226s
     0     0 40131.9077    0  536 8151.43441 40131.9077   392%     -  245s
     0     0 40096.7549    0  546 8151.43441 40096.7549   392%     -  255s
     0     0 40032.9067    0  562 8151.43441 40032.9067   391%     -  273s
     0     0 40019.5788    0  557 8151.43441 40019.5788   391%     -  279s
     0     0 40010.7710    0  555 8151.43441 40010.7710   391%     -  283s
     0     0 40009.7863    0  553 8151.43441 40009.7863   391%     -  285s
H    0     0                    8172.6338245 37470.5148   358%     -  360s
H    0     0                    11052.480181 37470.5148   239%     -  360s
H    0     0                    12503.841502 37470.5148   200%     -  360s
     0     0 37470.5148    0  502 12503.8415 37470.5148   200%     -  360s
H    0     0                    12510.249416 37470.4891   200%     -  361s
H    0     0                    12558.247492 36974.1178   194%     -  394s
H    0     0                    13122.526205 36974.1178   182%     -  394s
H    0     0                    13952.417149 36974.1178   165%     -  394s
H    0     0                    13972.169265 36974.1178   165%     -  394s
H    0     0                    13975.735743 36974.1178   165%     -  394s
H    0     0                    14152.106195 36974.1178   161%     -  394s
H    0     0                    14220.334762 36974.1178   160%     -  394s
H    0     0                    14227.627587 36974.1178   160%     -  394s
H    0     0                    14468.685798 36974.1178   156%     -  394s
H    0     0                    14475.795779 36974.1178   155%     -  394s
H    0     0                    14498.197705 36974.1178   155%     -  394s
H    0     0                    16593.649542 36974.1178   123%     -  394s
H    0     0                    17420.173091 36974.1178   112%     -  394s
H    0     0                    17636.589725 36974.1178   110%     -  394s
H    0     0                    17862.597791 36974.1178   107%     -  394s
H    0     0                    17866.724964 36974.1178   107%     -  394s
H    0     0                    17876.577136 36974.1178   107%     -  394s
H    0     0                    17963.374067 36974.1178   106%     -  394s
H    0     0                    17966.002311 36974.1178   106%     -  394s
H    0     0                    18030.992244 36974.1178   105%     -  394s
     0     0 36974.1178    0  583 18030.9922 36974.1178   105%     -  395s
H    0     0                    18031.547166 36816.0855   104%     -  415s
H    0     0                    18051.523620 36816.0855   104%     -  415s
     0     0 36816.0855    0  590 18051.5236 36816.0855   104%     -  415s
     0     0 36626.9162    0  577 18051.5236 36626.9162   103%     -  437s
     0     0 36555.3487    0  593 18051.5236 36555.3487   103%     -  451s
     0     0 36510.7528    0  589 18051.5236 36510.7528   102%     -  459s
     0     0 36447.7801    0  598 18051.5236 36447.7801   102%     -  472s
     0     0 36426.0369    0  607 18051.5236 36426.0369   102%     -  479s
     0     0 36416.9862    0  611 18051.5236 36416.9862   102%     -  485s
     0     0 36411.1320    0  616 18051.5236 36411.1320   102%     -  491s
     0     0 36407.8167    0  615 18051.5236 36407.8167   102%     -  495s
H    0     0                    18051.676099 36386.0858   102%     -  503s
     0     0 36386.0858    0  609 18051.6761 36386.0858   102%     -  503s
     0     0 36367.0012    0  617 18051.6761 36367.0012   101%     -  512s
     0     0 36363.3525    0  624 18051.6761 36363.3525   101%     -  517s
     0     0 36252.4043    0  593 18051.6761 36252.4043   101%     -  528s
     0     0 36229.4862    0  596 18051.6761 36229.4862   101%     -  534s
     0     0 36227.7898    0  598 18051.6761 36227.7898   101%     -  535s
H    0     0                    18057.526055 36227.7898   101%     -  544s
H    0     0                    18162.618063 36227.7898  99.5%     -  544s
H    0     0                    18203.576015 34567.4205  89.9%     -  593s
H    0     0                    18370.289854 34567.4205  88.2%     -  593s
H    0     0                    18402.676700 34567.4205  87.8%     -  593s
H    0     0                    18453.641550 34567.4205  87.3%     -  593s
H    0     0                    18565.306100 34567.4205  86.2%     -  593s
H    0     0                    18630.752090 34567.4205  85.5%     -  593s
     0     0 34567.4205    0  523 18630.7521 34567.4205  85.5%     -  593s
     0     0 34313.3379    0  521 18630.7521 34313.3379  84.2%     -  613s
H    0     0                    18928.133871 34235.9058  80.9%     -  629s
H    0     0                    19029.673451 34235.9058  79.9%     -  629s
H    0     0                    19080.547226 34235.9058  79.4%     -  629s
H    0     0                    19088.390749 34235.9058  79.4%     -  629s
H    0     0                    19092.762677 34235.9058  79.3%     -  629s
     0     0 34235.9058    0  522 19092.7627 34235.9058  79.3%     -  629s
     0     0 34087.1567    0  571 19092.7627 34087.1567  78.5%     -  643s
     0     0 34043.0797    0  620 19092.7627 34043.0797  78.3%     -  653s
     0     0 34025.8410    0  532 19092.7627 34025.8410  78.2%     -  659s
     0     0 33969.9925    0  477 19092.7627 33969.9925  77.9%     -  668s
     0     0 33905.4987    0  534 19092.7627 33905.4987  77.6%     -  680s
     0     0 33866.7613    0  542 19092.7627 33866.7613  77.4%     -  687s
     0     0 33850.3669    0  549 19092.7627 33850.3669  77.3%     -  691s
     0     0 33835.1443    0  602 19092.7627 33835.1443  77.2%     -  697s
     0     0 33818.9553    0  564 19092.7627 33818.9553  77.1%     -  701s
     0     0 33794.8843    0  604 19092.7627 33794.8843  77.0%     -  706s
     0     0 33771.8384    0  596 19092.7627 33771.8384  76.9%     -  710s
     0     0 33710.1231    0  542 19092.7627 33710.1231  76.6%     -  720s
     0     0 33697.6176    0  600 19092.7627 33697.6176  76.5%     -  723s
     0     0 33691.3940    0  603 19092.7627 33691.3940  76.5%     -  726s
     0     0 33679.9890    0  553 19092.7627 33679.9890  76.4%     -  730s
     0     0 33677.0024    0  560 19092.7627 33677.0024  76.4%     -  732s
     0     0 33421.5915    0  526 19092.7627 33421.5915  75.0%     -  748s
H    0     0                    19166.657894 33421.3369  74.4%     -  749s
H    0     0                    19219.772103 33421.3369  73.9%     -  749s
H    0     0                    19240.095270 33421.3369  73.7%     -  749s
     0     0 33347.5401    0  538 19240.0953 33347.5401  73.3%     -  757s
     0     0 33323.9933    0  535 19240.0953 33323.9933  73.2%     -  763s
     0     0 33307.5720    0  549 19240.0953 33307.5720  73.1%     -  768s
     0     0 33292.6462    0  531 19240.0953 33292.6462  73.0%     -  771s
     0     0 33290.1312    0  539 19240.0953 33290.1312  73.0%     -  773s
     0     0 33141.4111    0  594 19240.0953 33141.4111  72.3%     -  787s
H    0     0                    19450.411603 33141.3554  70.4%     -  798s
H    0     0                    19457.960787 33141.3554  70.3%     -  800s
     0     0 32997.8790    0  523 19457.9608 32997.8790  69.6%     -  809s
     0     0 32957.5231    0  575 19457.9608 32957.5231  69.4%     -  817s
     0     0 32940.8296    0  578 19457.9608 32940.8296  69.3%     -  821s
     0     0 32932.4477    0  592 19457.9608 32932.4477  69.2%     -  824s
     0     0 32924.6434    0  584 19457.9608 32924.6434  69.2%     -  826s
     0     0 32919.3726    0  583 19457.9608 32919.3726  69.2%     -  828s
     0     0 32916.2522    0  580 19457.9608 32916.2522  69.2%     -  829s
     0     0 32835.0036    0  484 19457.9608 32835.0036  68.7%     -  838s
     0     0 32816.5365    0  480 19457.9608 32816.5365  68.7%     -  843s
     0     0 32796.5519    0  482 19457.9608 32796.5519  68.6%     -  846s
     0     0 32791.7454    0  482 19457.9608 32791.7454  68.5%     -  849s
     0     0 32789.8253    0  481 19457.9608 32789.8253  68.5%     -  851s
     0     0 32698.6295    0  481 19457.9608 32698.6295  68.0%     -  860s
H    0     0                    19462.021619 32698.2755  68.0%     -  876s
     0     0 32671.2193    0  488 19462.0216 32671.2193  67.9%     -  883s
     0     0 32659.4350    0  508 19462.0216 32659.4350  67.8%     -  886s
     0     0 32656.2306    0  481 19462.0216 32656.2306  67.8%     -  889s
     0     0 32605.8616    0  510 19462.0216 32605.8616  67.5%     -  897s
     0     0 32595.8275    0  498 19462.0216 32595.8275  67.5%     -  900s
     0     0 32590.9074    0  493 19462.0216 32590.9074  67.5%     -  903s
     0     0 32583.9383    0  518 19462.0216 32583.9383  67.4%     -  905s
     0     0 32580.1161    0  510 19462.0216 32580.1161  67.4%     -  906s
     0     0 32576.0958    0  514 19462.0216 32576.0958  67.4%     -  909s
     0     0 32575.0762    0  516 19462.0216 32575.0762  67.4%     -  909s
     0     0 32481.9925    0  544 19462.0216 32481.9925  66.9%     -  918s
H    0     0                    19503.116100 32481.5515  66.5%     -  938s
     0     0 32456.0101    0  562 19503.1161 32456.0101  66.4%     -  945s
     0     0 32453.0737    0  560 19503.1161 32453.0737  66.4%     -  947s
     0     0 32397.4313    0  483 19503.1161 32397.4313  66.1%     -  955s
     0     0 32376.4975    0  503 19503.1161 32376.4975  66.0%     -  960s
     0     0 32358.0548    0  523 19503.1161 32358.0548  65.9%     -  964s
     0     0 32354.4525    0  563 19503.1161 32354.4525  65.9%     -  967s
     0     0 32351.4667    0  559 19503.1161 32351.4667  65.9%     -  970s
     0     0 32304.9418    0  581 19503.1161 32304.9418  65.6%     -  978s
     0     0 32298.3224    0  563 19503.1161 32298.3224  65.6%     -  981s
     0     0 32295.3255    0  513 19503.1161 32295.3255  65.6%     -  983s
     0     0 32270.9508    0  518 19503.1161 32270.9508  65.5%     -  990s
     0     0 32263.5043    0  583 19503.1161 32263.5043  65.4%     -  993s
     0     0 32261.0206    0  511 19503.1161 32261.0206  65.4%     -  994s
     0     0 32254.9963    0  577 19503.1161 32254.9963  65.4%     -  998s
     0     0 32252.1756    0  520 19503.1161 32252.1756  65.4%     - 1002s
     0     0 32239.0169    0  601 19503.1161 32239.0169  65.3%     - 1008s
     0     0 32238.9442    0  601 19503.1161 32238.9442  65.3%     - 1012s
     0     2 32238.9442    0  601 19503.1161 32238.9442  65.3%     - 1156s
     1     3 31057.2103    1  543 19503.1161 32238.6856  65.3% 30348 1188s
     2     4 31850.6608    1  648 19503.1161 31850.6608  63.3% 23798 1202s
     3     6 31679.8624    2  488 19503.1161 31850.0062  63.3% 19424 1230s
     5    11 29285.2507    3  555 19503.1161 31850.0062  63.3% 19341 1260s
    10    22 31457.0732    4  575 19503.1161 31669.7849  62.4% 17854 1306s
    21    33 30408.3377    5  568 19503.1161 31454.6286  61.3% 25750 1458s
    32    65 28898.0553    6  465 19503.1161 31454.6286  61.3% 24920 1651s
H   43    65                    19507.564655 31454.6286  61.2% 21206 1651s
    64    97 28853.8699    7  529 19507.5647 31139.5780  59.6% 28152 1672s
    96   126 28556.1723    8  472 19507.5647 31135.0001  59.6% 24761 1783s
   125   157 28488.6549    9  583 19507.5647 31135.0001  59.6% 20564 1821s
H  127   157                    19534.134136 31135.0001  59.4% 20242 1821s
H  130   157                    19574.809324 31135.0001  59.1% 20039 1821s
H  139   157                    19592.426298 31135.0001  58.9% 19264 1821s
   156   291 28452.2566   10  581 19592.4263 31135.0001  58.9% 18734 1866s
   290   351 26785.2637   13  252 19592.4263 31135.0001  58.9% 12952 1892s
   350   397 28077.9895   12  451 19592.4263 31135.0001  58.9% 11935 1917s
   396   442 23372.2719   13  236 19592.4263 31135.0001  58.9% 11557 1937s
   447   501 23193.4598   14  224 19592.4263 31135.0001  58.9% 11464 1961s
   520   545 22978.5699   19  200 19592.4263 31135.0001  58.9% 11148 1982s
   582   588 21955.5445   24  214 19592.4263 31135.0001  58.9% 10838 2004s
H  649   608                    19629.083073 31135.0001  58.6% 10836 2025s
   685   664 21297.8670   26  191 19629.0831 31135.0001  58.6% 10773 2047s
   759   696 20220.7784   31  168 19629.0831 31135.0001  58.6% 10680 2067s
H  808   696                    19649.063599 31135.0001  58.5% 10471 2067s
   811   725 infeasible   34      19649.0636 31135.0001  58.5% 10479 2087s
   884   744 infeasible   34      19649.0636 30825.0665  56.9% 10329 2108s
H  888   744                    19688.468697 30825.0665  56.6% 10299 2108s
   937   787 infeasible   32      19688.4687 30825.0665  56.6% 10230 2128s
  1012   803 19983.0971   31  145 19688.4687 30825.0665  56.6% 10042 2150s
  1054   830 20713.8523   21  263 19688.4687 30825.0665  56.6% 10066 2173s
  1129   858 19966.3561   24  254 19688.4687 30825.0665  56.6%  9871 2196s
  1211   881 infeasible   26      19688.4687 30825.0665  56.6%  9671 2225s
  1291   937 27588.8939    9  589 19688.4687 30825.0665  56.6%  9667 2252s
  1381   993 26810.0214   10  506 19688.4687 30825.0665  56.6%  9705 2279s
  1478  1010 26312.8707   12  410 19688.4687 30825.0665  56.6%  9665 2305s
H 1515  1010                    19697.032949 30825.0665  56.5%  9690 2305s
  1525  1058 26207.7550   13  485 19697.0329 30825.0665  56.5%  9672 2332s
  1622  1117 25795.8107   16  283 19697.0329 30825.0665  56.5%  9568 2360s
  1735  1171 23077.9271   21  199 19697.0329 30419.3801  54.4%  9489 2392s
  1842  1210 19943.4531   31  181 19697.0329 30419.3801  54.4%  9520 2421s
  1940  1264 26854.0695   11  435 19697.0329 30419.3801  54.4%  9512 2459s
  2024  1290 26775.9231   13  380 19697.0329 30419.3801  54.4%  9626 2501s
  2077  1319 26499.4275   14  416 19697.0329 30419.3801  54.4%  9734 2554s
  2140  1365 26466.5314   15  363 19697.0329 30419.3801  54.4%  9811 2595s
  2226  1423 26210.9609   16  353 19697.0329 30419.3801  54.4%  9829 2628s
  2302  1450 26114.6964   17  355 19697.0329 30419.3801  54.4%  9838 2662s
H 2316  1450                    19776.300865 30419.3801  53.8%  9880 2662s
  2337  1510 25998.0768   18  314 19776.3009 30419.3801  53.8%  9937 2705s
  2450  1546 23525.4749   22  299 19776.3009 30127.8812  52.3%  9995 2746s
  2584  1625 21440.4775   27  286 19776.3009 29800.4515  50.7% 10027 2790s
  2713  1711 20907.1178   33  206 19776.3009 29800.4515  50.7% 10102 2836s
  2882  1770     cutoff   42      19776.3009 29800.4515  50.7% 10091 2884s
  3041  1794 27759.9137   10  369 19776.3009 29422.1630  48.8% 10101 2932s
H 3042  1794                    19780.672793 29422.1630  48.7% 10097 2932s
H 3046  1792                    19791.456864 29422.1630  48.7% 10087 2932s
  3103  1867 23141.8910   11  352 19791.4569 29422.1630  48.7% 10179 2982s
  3252  1926 21560.6570   12  286 19791.4569 29270.7468  47.9% 10238 3038s
  3377  1979 27286.5509   12  360 19791.4569 29093.8232  47.0% 10413 3091s
  3535  2074 24975.5391   16  239 19791.4569 29093.8232  47.0% 10512 3146s
  3702  2132 23016.9119   19  277 19791.4569 29093.8232  47.0% 10573 3201s
  3894  2201 20614.7992   26  272 19791.4569 28966.7395  46.4% 10589 3267s
  4069  2254     cutoff   24      19791.4569 28668.5687  44.9% 10652 3340s
  4231  2339 25543.5723   12  436 19791.4569 28562.4386  44.3% 10745 3409s
  4407  2441     cutoff   14      19791.4569 28562.4386  44.3% 10833 3476s
  4615  2534 infeasible   18      19791.4569 28525.6911  44.1% 10903 3536s

Cutting planes:
  Learned: 1
  Gomory: 18
  Implied bound: 382
  MIR: 4386
  Flow cover: 4631
  RLT: 249
  Relax-and-lift: 1656

Explored 4831 nodes (52855720 simplex iterations) in 3600.02 seconds (9582.18 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 19791.5 19780.7 19776.3 ... 19534.1

Time limit reached
Best objective 1.979145686403e+04, best bound 2.852569107105e+04, gap 44.1313%
  WARNING: Time limit reached. Using best solution found (gap: 44.13%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.05s
  Master Objective (UB) = 19791.46, θ = 142408.53
  Upper Bound (UB) = 19791.46

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 142408.53
  [DEBUG]   ✓ Scenario 0: θ = 142408.53 ≤ Q = 142408.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 142408.53 ≤ Q = 142408.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 142408.53 ≤ Q = 142408.53 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 142408.53 ≤ Q = 142408.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 142408.53 ≤ Q = 142408.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 142408.53 ≤ Q = 142408.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 142408.53 ≤ Q = 142408.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 142408.53 ≤ Q = 142408.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 142408.53 ≤ Q = 142408.53 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 142408.53 ≤ Q = 142408.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 142408.53 ≤ Q = 142408.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 142408.53 ≤ Q = 142408.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 142408.53 ≤ Q = 142408.53 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 13] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x503f95c
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xfafc06a4
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.460667e+13
Presolve removed 2571 rows and 1864 columns
Presolve time: 0.00s
Presolved: 522 rows, 525 columns, 1472 nonzeros
Found heuristic solution: objective 7763828.0838
Variable types: 355 continuous, 170 integer (170 binary)

Root relaxation: objective -1.353552e+05, 245 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -135355.24    0  124 7763828.08 -135355.24   102%     -    0s
H    0     0                    -100360.0647 -135355.24  34.9%     -    0s
H    0     0                    -100912.9717 -135355.24  34.1%     -    0s
     0     0 -108112.86    0  138 -100912.97 -108112.86  7.13%     -    0s
H    0     0                    -103150.1783 -108102.14  4.80%     -    0s
     0     0 -107301.74    0  138 -103150.18 -107301.74  4.02%     -    0s
     0     0 -107268.77    0  138 -103150.18 -107268.77  3.99%     -    0s
H    0     0                    -103870.0785 -106769.02  2.79%     -    0s
     0     0 -106769.02    0  130 -103870.08 -106769.02  2.79%     -    0s
H    0     0                    -104685.1329 -106762.60  1.98%     -    0s
     0     0 -106759.40    0  134 -104685.13 -106759.40  1.98%     -    0s
     0     0 -106540.61    0  131 -104685.13 -106540.61  1.77%     -    0s
H    0     0                    -104705.9706 -106526.06  1.74%     -    0s
     0     0 -106526.06    0   90 -104705.97 -106526.06  1.74%     -    0s
     0     0 -106185.03    0  120 -104705.97 -106185.03  1.41%     -    0s
     0     0 -106174.01    0  122 -104705.97 -106174.01  1.40%     -    0s
     0     0 -106085.17    0   83 -104705.97 -106085.17  1.32%     -    0s
     0     0 -106072.44    0   90 -104705.97 -106072.44  1.31%     -    0s
     0     0 -106041.37    0  119 -104705.97 -106041.37  1.28%     -    0s
     0     0 -106041.10    0  119 -104705.97 -106041.10  1.28%     -    0s
     0     2 -106041.04    0  119 -104705.97 -106041.04  1.28%     -    0s
H   41    46                    -104999.8003 -105851.88  0.81%  20.3    0s
H   59    51                    -105190.8555 -105800.54  0.58%  18.3    0s
H   96   106                    -105208.5673 -105798.70  0.56%  18.0    0s
H  101   106                    -105264.1971 -105798.70  0.51%  17.3    0s
H  106   106                    -105425.6010 -105798.70  0.35%  16.7    0s
*  312    95              16    -105629.6546 -105724.83  0.09%   9.6    0s
*  358    33              13    -105660.3255 -105724.83  0.06%   9.1    0s
H  359    33                    -105660.9998 -105724.83  0.06%   9.1    0s

Cutting planes:
  Gomory: 23
  MIR: 245
  RLT: 1

Explored 486 nodes (4378 simplex iterations) in 0.11 seconds (0.11 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -105661 -105660 -105630 ... -104685
No other solutions better than -105661

Optimal solution found (tolerance 1.00e-04)
Best objective -1.056609998446e+05, best bound -1.056609998446e+05, gap 0.0000%
  Subproblem solved in 0.12s
  Worst-case operational profit (Z_SP) = 140658.35
  Scenario: 7 demand increases, 53 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -105661.00
  [DEBUG]   S×d_nominal = 246319.35
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 246319.35 + -105661.00 = 140658.35
  [DEBUG]   Current θ from Master = 142408.53
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1750.18 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 18041.28
  Lower Bound (LB) = 19157.49
  Gap (UB-LB) = 633.9645, Absolute Gap = 633.9645, Relative Gap = 0.032032
  Not converged yet (gap = 633.96 > ε = 200)

  [DEBUG] Adding NEW scenario 13 to Master Problem...
  [DEBUG] New scenario pattern: 7 increases, 53 decreases
    [DEBUG] Scenario 13 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 13 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 13]
    [DEBUG]   - Total constraints in model: 215443
    [DEBUG]   - Total variables in model: 89620
  [DEBUG] Total scenarios in Master: 14
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 14
================================================================================
[Iteration 14] Solving Master Problem...
  Current scenarios in Master: 14
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 215443 rows, 89620 columns and 610963 nonzeros
Model fingerprint: 0x3199d468
Variable types: 87361 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 92050 rows and 37380 columns
Presolve time: 1.96s
Presolved: 123393 rows, 52240 columns, 759228 nonzeros
Variable types: 49981 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -366999.6780
Found heuristic solution: objective -194531.7474

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.29s

Barrier statistics:
 Dense cols : 733
 AA' NZ     : 4.748e+06
 Factor NZ  : 1.108e+07 (roughly 160 MB of memory)
 Factor Ops : 2.448e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.50209871e+07  2.01732639e+08  8.57e+04 2.13e+01  6.22e+04     3s
   1  -1.13582676e+07  1.69810090e+08  6.04e+04 5.46e+01  4.35e+04     3s
   2  -3.98747187e+06  1.31675081e+08  2.05e+04 7.55e+00  1.53e+04     4s
   3  -8.02355452e+05  9.11077973e+07  1.50e+03 1.74e+00  1.45e+03     4s
   4  -5.38245981e+05  3.52056708e+07  3.83e+02 3.86e-01  3.98e+02     4s
   5  -4.39069218e+05  2.53723536e+07  1.89e+02 2.48e-01  2.25e+02     4s
   6  -2.98344986e+05  1.88241216e+07  6.38e+01 1.69e-01  1.19e+02     4s
   7  -1.78192076e+05  1.41596367e+07  2.62e+01 1.21e-01  7.55e+01     4s
   8  -1.22226111e+05  9.79222590e+06  1.04e+01 8.07e-02  4.77e+01     4s
   9  -1.06383999e+05  7.68447336e+06  7.25e+00 6.21e-02  3.67e+01     4s
  10  -9.06636789e+04  3.02930562e+06  4.69e+00 2.33e-02  1.45e+01     4s
  11  -6.48312019e+04  1.28720386e+06  2.03e+00 8.97e-03  6.14e+00     4s
  12  -3.98343077e+04  5.01958020e+05  8.71e-01 3.42e-03  2.43e+00     4s
  13  -1.14135801e+04  2.53554136e+05  4.15e-01 1.67e-03  1.18e+00     4s
  14  -1.80505877e+03  1.81171802e+05  3.04e-01 1.12e-03  8.16e-01     4s
  15   5.96016759e+03  1.47491835e+05  2.47e-01 9.54e-04  6.31e-01     4s
  16   1.36683284e+04  1.14974200e+05  1.94e-01 1.51e-03  4.52e-01     4s
  17   1.66183845e+04  1.02518771e+05  1.75e-01 1.90e-03  3.83e-01     4s
  18   2.14727507e+04  8.56353017e+04  1.45e-01 1.73e-03  2.86e-01     4s
  19   2.60359440e+04  7.53611949e+04  1.16e-01 1.98e-03  2.20e-01     4s
  20   2.75986369e+04  7.22206619e+04  1.07e-01 1.91e-03  1.99e-01     4s
  21   3.12251659e+04  6.62792160e+04  8.64e-02 1.86e-03  1.57e-01     4s
  22   3.20236446e+04  6.54341917e+04  8.17e-02 1.77e-03  1.49e-01     5s
  23   3.33632985e+04  6.13791164e+04  7.46e-02 1.49e-03  1.25e-01     5s
  24   3.63120836e+04  5.95249626e+04  5.93e-02 1.94e-03  1.04e-01     5s
  25   3.79643977e+04  5.67076099e+04  5.08e-02 1.39e-03  8.38e-02     5s
  26   3.97802974e+04  5.43409580e+04  4.20e-02 1.82e-03  6.51e-02     5s
  27   4.15983227e+04  5.26635668e+04  3.32e-02 1.71e-03  4.95e-02     5s
  28   4.32978489e+04  5.13604303e+04  2.53e-02 1.09e-03  3.61e-02     5s
  29   4.45419353e+04  5.09019383e+04  1.97e-02 9.65e-04  2.85e-02     5s
  30   4.54921982e+04  5.04972520e+04  1.55e-02 8.13e-04  2.24e-02     5s
  31   4.64300732e+04  5.00589054e+04  1.13e-02 6.93e-04  1.62e-02     5s
  32   4.69000451e+04  4.98111484e+04  9.18e-03 5.23e-04  1.30e-02     5s
  33   4.75935887e+04  4.96654724e+04  6.14e-03 3.95e-04  9.27e-03     5s
  34   4.80291219e+04  4.95221245e+04  4.32e-03 2.92e-04  6.68e-03     5s
  35   4.84238387e+04  4.93342848e+04  2.57e-03 1.77e-04  4.07e-03     5s
  36   4.88209670e+04  4.92509668e+04  9.92e-04 1.22e-04  1.92e-03     5s
  37   4.89119471e+04  4.91946401e+04  6.41e-04 7.33e-05  1.26e-03     5s
  38   4.89561167e+04  4.91565135e+04  4.82e-04 4.36e-05  8.95e-04     5s
  39   4.89804421e+04  4.91251795e+04  3.96e-04 1.90e-05  6.47e-04     5s
  40   4.90017183e+04  4.91143053e+04  3.20e-04 1.15e-05  5.03e-04     6s
  41   4.90737650e+04  4.91044606e+04  6.10e-05 4.88e-06  1.37e-04     6s
  42   4.90939158e+04  4.90963034e+04  5.72e-06 3.65e-07  1.07e-05     6s
  43   4.90961457e+04  4.90961466e+04  2.34e-10 1.25e-08  4.25e-09     6s
  44   4.90961465e+04  4.90961465e+04  3.95e-09 9.06e-11  1.34e-11     6s

Barrier solved model in 44 iterations and 5.81 seconds (10.09 work units)
Optimal objective 4.90961465e+04


Root crossover log...

  109795 DPushes remaining with DInf 0.0000000e+00                 6s
       0 DPushes remaining with DInf 0.0000000e+00                 9s

    1449 PPushes remaining with PInf 1.4922148e-06                 9s
       0 PPushes remaining with PInf 0.0000000e+00                 9s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.9786463e-10      9s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   48470    4.9096146e+04   0.000000e+00   0.000000e+00      9s
   48470    4.9096146e+04   0.000000e+00   0.000000e+00      9s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 4.909615e+04, 48470 iterations, 6.17 seconds (13.52 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 49096.1465    0  168 -194531.75 49096.1465   125%     -    9s
H    0     0                    -101714.2121 49096.1465   148%     -    9s
H    0     0                    -100588.1858 49096.1465   149%     -    9s
H    0     0                    -87515.75252 49096.1465   156%     -    9s
H    0     0                    -44513.04802 49096.1465   210%     -    9s
H    0     0                    9782.5448840 49096.1465   402%     -    9s
H    0     0                    13698.902023 49096.1465   258%     -   10s
H    0     0                    13721.474214 49096.1465   258%     -   10s
H    0     0                    13808.949243 49096.1465   256%     -   10s
     0     0 42724.9343    0  285 13808.9492 42724.9343   209%     -   39s
H    0     0                    13832.106521 42723.8063   209%     -   40s
     0     0 42614.5610    0  282 13832.1065 42614.5610   208%     -   45s
     0     0 42610.5714    0  284 13832.1065 42610.5714   208%     -   46s
     0     0 42602.2748    0  284 13832.1065 42602.2748   208%     -   48s
     0     0 42516.9638    0  289 13832.1065 42516.9638   207%     -   51s
     0     0 42515.5046    0  293 13832.1065 42515.5046   207%     -   52s
     0     0 42515.5046    0  293 13832.1065 42515.5046   207%     -   52s
     0     0 39239.3008    0  255 13832.1065 39239.3008   184%     -   92s
     0     0 39239.3008    0  255 13832.1065 39239.3008   184%     -   92s
H    0     0                    18304.609273 39234.0247   114%     -   93s
H    0     0                    18536.127300 39234.0247   112%     -   93s
H    0     0                    18806.240165 39234.0247   109%     -   93s
H    0     0                    18806.735946 39234.0247   109%     -   93s
H    0     0                    18808.212836 39234.0247   109%     -   93s
     0     0 38671.5564    0  322 18808.2128 38671.5564   106%     -  113s
     0     0 38671.5564    0  372 18808.2128 38671.5564   106%     -  125s
     0     0 38671.5564    0  374 18808.2128 38671.5564   106%     -  130s
     0     0 38611.5452    0  371 18808.2128 38611.5452   105%     -  144s
     0     0 38497.9060    0  368 18808.2128 38497.9060   105%     -  157s
     0     0 38394.2942    0  388 18808.2128 38394.2942   104%     -  167s
     0     0 38389.3747    0  378 18808.2128 38389.3747   104%     -  170s
     0     0 38388.4165    0  391 18808.2128 38388.4165   104%     -  172s
     0     0 35760.3161    0  375 18808.2128 35760.3161  90.1%     -  222s
H    0     0                    18859.509425 35759.8051  89.6%     -  222s
H    0     0                    18873.242136 35759.8051  89.5%     -  222s
H    0     0                    18966.436688 35154.0675  85.3%     -  244s
     0     0 35154.0675    0  476 18966.4367 35154.0675  85.3%     -  244s
     0     0 34883.9903    0  421 18966.4367 34883.9903  83.9%     -  255s
     0     0 34832.7674    0  464 18966.4367 34832.7674  83.7%     -  261s
     0     0 34760.2716    0  498 18966.4367 34760.2716  83.3%     -  271s
H    0     0                    18991.119998 34672.1967  82.6%     -  279s
H    0     0                    18992.581060 34672.1967  82.6%     -  279s
H    0     0                    19039.206000 34672.1967  82.1%     -  279s
     0     0 34672.1967    0  492 19039.2060 34672.1967  82.1%     -  279s
     0     0 34632.9728    0  498 19039.2060 34632.9728  81.9%     -  285s
     0     0 34585.1718    0  492 19039.2060 34585.1718  81.7%     -  288s
     0     0 34544.5278    0  497 19039.2060 34544.5278  81.4%     -  294s
     0     0 34466.2395    0  497 19039.2060 34466.2395  81.0%     -  303s
     0     0 34431.5622    0  501 19039.2060 34431.5622  80.8%     -  307s
     0     0 34405.3528    0  518 19039.2060 34405.3528  80.7%     -  311s
     0     0 34397.5365    0  508 19039.2060 34397.5365  80.7%     -  314s
     0     0 34352.5817    0  510 19039.2060 34352.5817  80.4%     -  319s
     0     0 34349.6307    0  509 19039.2060 34349.6307  80.4%     -  321s
     0     0 34336.1449    0  517 19039.2060 34336.1449  80.3%     -  325s
     0     0 34335.0393    0  508 19039.2060 34335.0393  80.3%     -  327s
     0     0 33305.8569    0  452 19039.2060 33305.8569  74.9%     -  358s
H    0     0                    19082.345928 33305.8249  74.5%     -  359s
H    0     0                    19102.102727 33305.8249  74.4%     -  359s
H    0     0                    19118.615080 33305.8249  74.2%     -  359s
H    0     0                    19183.122205 33305.8249  73.6%     -  359s
     0     0 33083.0752    0  421 19183.1222 33083.0752  72.5%     -  368s
     0     0 33010.9774    0  425 19183.1222 33010.9774  72.1%     -  376s
     0     0 32898.7493    0  459 19183.1222 32898.7493  71.5%     -  386s
     0     0 32810.3978    0  467 19183.1222 32810.3978  71.0%     -  392s
     0     0 32714.0274    0  414 19183.1222 32714.0274  70.5%     -  397s
     0     0 32676.7920    0  463 19183.1222 32676.7920  70.3%     -  401s
     0     0 32664.3579    0  417 19183.1222 32664.3579  70.3%     -  404s
     0     0 32641.7844    0  418 19183.1222 32641.7844  70.2%     -  407s
     0     0 32638.3245    0  475 19183.1222 32638.3245  70.1%     -  408s
     0     0 32591.8412    0  476 19183.1222 32591.8412  69.9%     -  412s
     0     0 32578.6437    0  478 19183.1222 32578.6437  69.8%     -  415s
     0     0 32576.7101    0  480 19183.1222 32576.7101  69.8%     -  416s
     0     0 32394.6613    0  500 19183.1222 32394.6613  68.9%     -  427s
     0     0 32298.1783    0  504 19183.1222 32298.1783  68.4%     -  434s
     0     0 32262.7031    0  491 19183.1222 32262.7031  68.2%     -  438s
     0     0 32248.9580    0  503 19183.1222 32248.9580  68.1%     -  441s
     0     0 32235.5722    0  495 19183.1222 32235.5722  68.0%     -  444s
     0     0 32231.4147    0  460 19183.1222 32231.4147  68.0%     -  446s
     0     0 32229.5303    0  518 19183.1222 32229.5303  68.0%     -  447s
     0     0 32121.8249    0  547 19183.1222 32121.8249  67.4%     -  456s
     0     0 32062.2422    0  555 19183.1222 32062.2422  67.1%     -  464s
     0     0 32041.8647    0  500 19183.1222 32041.8647  67.0%     -  468s
     0     0 32030.3009    0  493 19183.1222 32030.3009  67.0%     -  470s
     0     0 32025.4389    0  455 19183.1222 32025.4389  66.9%     -  472s
     0     0 32019.6027    0  459 19183.1222 32019.6027  66.9%     -  474s
     0     0 32019.0673    0  465 19183.1222 32019.0673  66.9%     -  474s
     0     0 31985.6924    0  458 19183.1222 31985.6924  66.7%     -  480s
     0     0 31976.2469    0  462 19183.1222 31976.2469  66.7%     -  483s
     0     0 31974.1548    0  465 19183.1222 31974.1548  66.7%     -  484s
     0     0 31950.8311    0  503 19183.1222 31950.8311  66.6%     -  489s
     0     0 31926.3665    0  492 19183.1222 31926.3665  66.4%     -  495s
H    0     0                    19219.073182 31914.1106  66.1%     -  498s
H    0     0                    19256.821200 31914.1106  65.7%     -  498s
     0     0 31914.1106    0  482 19256.8212 31914.1106  65.7%     -  498s
     0     0 31911.8243    0  491 19256.8212 31911.8243  65.7%     -  499s
     0     0 31895.4763    0  454 19256.8212 31895.4763  65.6%     -  504s
H    0     0                    19288.573912 31893.8321  65.4%     -  505s
     0     0 31887.8798    0  465 19288.5739 31887.8798  65.3%     -  507s
     0     0 31885.5550    0  459 19288.5739 31885.5550  65.3%     -  509s
     0     0 31851.1553    0  511 19288.5739 31851.1553  65.1%     -  515s
H    0     0                    19313.339647 31850.1990  64.9%     -  518s
H    0     0                    19374.311006 31850.1990  64.4%     -  518s
     0     0 31838.7481    0  514 19374.3110 31838.7481  64.3%     -  521s
     0     0 31835.4964    0  508 19374.3110 31835.4964  64.3%     -  522s
     0     0 31833.9577    0  509 19374.3110 31833.9577  64.3%     -  524s
     0     0 31810.0198    0  463 19374.3110 31810.0198  64.2%     -  529s
     0     0 31791.6153    0  461 19374.3110 31791.6153  64.1%     -  533s
     0     0 31779.5241    0  464 19374.3110 31779.5241  64.0%     -  534s
     0     0 31769.1204    0  469 19374.3110 31769.1204  64.0%     -  537s
     0     0 31765.6444    0  458 19374.3110 31765.6444  64.0%     -  538s
     0     0 31760.9867    0  460 19374.3110 31760.9867  63.9%     -  538s
     0     0 31760.4870    0  474 19374.3110 31760.4870  63.9%     -  539s
     0     0 31751.5225    0  475 19374.3110 31751.5225  63.9%     -  543s
H    0     0                    19425.007378 31751.1567  63.5%     -  546s
H    0     0                    19446.306573 31751.1567  63.3%     -  547s
     0     0 31746.0715    0  472 19446.3066 31746.0715  63.2%     -  549s
     0     0 31744.7185    0  471 19446.3066 31744.7185  63.2%     -  551s
     0     0 31738.8922    0  461 19446.3066 31738.8922  63.2%     -  554s
     0     0 31735.1838    0  466 19446.3066 31735.1838  63.2%     -  556s
     0     0 31734.1423    0  454 19446.3066 31734.1423  63.2%     -  556s
     0     0 31727.8974    0  466 19446.3066 31727.8974  63.2%     -  560s
H    0     0                    19450.726946 31727.5581  63.1%     -  561s
     0     0 31724.4694    0  457 19450.7269 31724.4694  63.1%     -  564s
     0     0 31722.8758    0  456 19450.7269 31722.8758  63.1%     -  565s
     0     0 31722.4703    0  510 19450.7269 31722.4703  63.1%     -  568s
     0     0 31722.0114    0  510 19450.7269 31722.0114  63.1%     -  572s
H    0     0                    19491.429821 31722.0114  62.7%     -  664s
     0     2 31722.0114    0  510 19491.4298 31722.0114  62.7%     -  666s
     1     3 30147.6701    1  530 19491.4298 31722.0114  62.7% 29032  696s
     2     6 30016.3788    2  485 19491.4298 31722.0114  62.7% 16672  703s
     5    10 31182.2094    2  439 19491.4298 31354.3638  60.9% 11642  725s
     9    19 30791.5968    3  523 19491.4298 31181.5727  60.0% 13554  746s
    18    38 30729.4772    4  507 19491.4298 31078.4810  59.4% 13124  773s
    37    51 28964.8907    5  362 19491.4298 30779.4957  57.9% 18532  839s
    50    77 28083.1887    6  302 19491.4298 30779.4957  57.9% 22390  876s
H   51    77                    19572.289720 30779.4957  57.3% 21951  876s
H   53    77                    19602.594112 30779.4957  57.0% 21613  876s
H   54    77                    19640.910915 30779.4957  56.7% 21301  876s
    76   209 28023.2644    7  292 19640.9109 30779.4957  56.7% 17722  954s
   208   317 27389.3514   12  269 19640.9109 30779.4957  56.7%  9054  978s
   318   392 26931.6305   14  270 19640.9109 30779.4957  56.7%  7731  995s
   395   450 26751.0457   16  274 19640.9109 30779.4957  56.7%  7051 1011s
   455   508 25478.8891   18  234 19640.9109 30779.4957  56.7%  6810 1026s
   513   563 25831.8511   17  241 19640.9109 30779.4957  56.7%  6719 1042s
   574   631 25020.7792   19  251 19640.9109 30779.4957  56.7%  6542 1056s
   645   661 24822.4944   21  254 19640.9109 30779.4957  56.7%  6505 1071s
   675   692 24694.4166   22  255 19640.9109 30779.4957  56.7%  6531 1083s
   706   730 24526.8578   23  237 19640.9109 30779.4957  56.7%  6531 1095s
   744   785 24448.2447   24  227 19640.9109 30779.4957  56.7%  6508 1109s
H  761   785                    19644.925630 30779.4957  56.7%  6417 1109s
   803   874 24247.3028   29  212 19644.9256 30779.4957  56.7%  6342 1122s
   906   966 24021.9805   35  209 19644.9256 30779.4957  56.7%  6075 1135s
  1008  1067 23643.1666   39  269 19644.9256 30779.4957  56.7%  5882 1150s
  1125  1162 23296.6122   46  247 19644.9256 30779.4957  56.7%  5630 1163s
  1240  1255 22837.6243   51  194 19644.9256 30779.4957  56.7%  5480 1179s
  1355  1345 22759.9048   56  180 19644.9256 30779.4957  56.7%  5356 1194s
  1473  1409 21233.6949   60  299 19644.9256 30779.4957  56.7%  5239 1212s
  1587  1448 20423.7989   64  282 19644.9256 30779.4957  56.7%  5196 1229s
  1689  1535 21805.5631   25  231 19644.9256 30779.4957  56.7%  5197 1245s
  1802  1624 21336.5321   26  219 19644.9256 30779.4957  56.7%  5197 1263s
  1933  1715 20546.1462   30  208 19644.9256 30779.4957  56.7%  5161 1282s
  2086  1743     cutoff   31      19644.9256 30779.4957  56.7%  5095 1303s
  2233  1776     cutoff   31      19644.9256 30779.4957  56.7%  5074 1325s
  2342  1829     cutoff   40      19644.9256 30729.0484  56.4%  5103 1347s
  2468  1841 29377.8239    6  462 19644.9256 30729.0484  56.4%  5109 1368s
H 2543  1841                    19655.255818 30729.0484  56.3%  5103 1368s
  2546  1849 29232.7666    7  579 19655.2558 30729.0484  56.3%  5119 1392s
  2648  1870 29014.0841    9  530 19655.2558 30634.3816  55.9%  5143 1419s
  2744  1880 27883.3215   11  432 19655.2558 30634.3816  55.9%  5146 1447s
  2810  1892 27664.6895   12  449 19655.2558 30634.3816  55.9%  5254 1476s
  2880  1913 27363.4445   14  433 19655.2558 30591.9208  55.6%  5367 1505s
  2936  1936 25651.1245   16  265 19655.2558 30591.9208  55.6%  5531 1531s
  2985  1981 24816.0828   18  197 19655.2558 30549.1030  55.4%  5640 1560s
  3047  2031 23865.5979   23  191 19655.2558 30549.1030  55.4%  5749 1589s
  3135  2042 23309.1960   35  165 19655.2558 30549.1030  55.4%  5852 1618s
  3182  2059 23249.5573   36  167 19655.2558 30549.1030  55.4%  5931 1646s
H 3213  2058                    19662.286235 30131.9611  53.2%  5948 1646s
H 3221  2058                    19666.575412 30131.9611  53.2%  5956 1646s
H 3232  2058                    19683.942543 30131.9611  53.1%  5979 1646s
  3235  2078 22991.4370   37  243 19683.9425 30131.9611  53.1%  5991 1679s
  3273  2104 22919.3735   38  189 19683.9425 29357.8991  49.1%  6062 1711s
  3313  2131 22907.2449   39  190 19683.9425 29357.8991  49.1%  6139 1745s
  3348  2157 22876.2230   40  187 19683.9425 29357.8991  49.1%  6183 1775s
  3388  2192 22856.7664   41  204 19683.9425 29357.8991  49.1%  6250 1803s
  3427  2255 22856.5730   42  134 19683.9425 29357.8991  49.1%  6332 1832s
  3502  2352 21789.6353   49  178 19683.9425 29204.1886  48.4%  6371 1863s
  3666  2405 20282.9206   58  234 19683.9425 29204.1886  48.4%  6320 1896s
  3793  2505 27623.1810    9  268 19683.9425 29059.9312  47.6%  6344 1933s
  3913  2646 24155.7968   12  256 19683.9425 29059.9312  47.6%  6411 1968s
  4085  2647 20629.5543   27  510 19683.9425 29059.9312  47.6%  6450 2429s
  4087  2648 23087.8978   20  152 19683.9425 29059.9312  47.6%  6446 2443s
  4088  2649 24799.4152   23  321 19683.9425 29059.9312  47.6%  6445 2527s
  4089  2650 20667.3588   32  392 19683.9425 29059.9312  47.6%  6443 2570s
  4090  2650 24175.9530   34  342 19683.9425 29059.9312  47.6%  6442 2598s
  4091  2651 26789.1030   15  464 19683.9425 29059.9312  47.6%  6440 2622s
  4092  2652 23221.3029    9  473 19683.9425 29059.9312  47.6%  6439 2652s
  4093  2652 25751.0490   21  423 19683.9425 29059.9312  47.6%  6437 2669s
  4094  2653 21791.9269   60  500 19683.9425 29059.9312  47.6%  6435 2684s
  4095  2654 20756.1415   33  475 19683.9425 29059.9312  47.6%  6434 2694s
  4096  2654 27241.1492   13  494 19683.9425 29059.9312  47.6%  6432 2703s
  4097  2655 19902.1613   34  487 19683.9425 29059.9312  47.6%  6431 2709s
  4098  2656 20161.6986   38  501 19683.9425 29059.9312  47.6%  6429 2713s
  4099  2656 22384.3915   72  440 19683.9425 29059.9312  47.6%  6428 2716s
  4100  2657 20786.0814   47  497 19683.9425 29059.9312  47.6%  6426 2721s
  4101  2658 27233.4145   16  503 19683.9425 29059.9312  47.6%  6424 2726s
  4102  2658 23333.5081   32  504 19683.9425 29059.9312  47.6%  6423 2731s
  4103  2659 27167.2567   14  515 19683.9425 29059.9312  47.6%  6421 2736s
  4105  2660 24064.5384   11  463 19683.9425 29059.9312  47.6%  6418 2741s
  4106  2661 23527.1423   36  466 19683.9425 29059.9312  47.6%  6417 2746s
  4107  2662 22382.0056   10  449 19683.9425 29059.9312  47.6%  6415 2756s
  4108  2662 23175.8644   34  516 19683.9425 29059.9312  47.6%  6414 2764s
  4109  2663 22265.3058   39  531 19683.9425 29059.9312  47.6%  6412 2769s
  4110  2664 24356.4960   41  465 19683.9425 29059.9312  47.6%  6410 2782s
  4111  2664 27313.1678   11  508 19683.9425 29059.9312  47.6%  6409 2789s
  4112  2665 23381.3043   14  475 19683.9425 29059.9312  47.6%  6407 2793s
  4113  2666 20524.2351   18  476 19683.9425 29059.9312  47.6%  6406 2802s
  4114  2666 25006.0524    7  486 19683.9425 29059.9312  47.6%  6404 2808s
  4115  2667 25149.1630   15  521 19683.9425 29059.9312  47.6%  6403 2820s
  4116  2668 23267.2884   35  521 19683.9425 29059.9312  47.6%  6401 2826s
  4117  2668 23614.2368   30  555 19683.9425 29059.9312  47.6%  6399 2837s
  4118  2669 21025.6492   53  592 19683.9425 29059.9312  47.6%  6398 2841s
  4119  2670 21005.9978   17  587 19683.9425 29059.9312  47.6%  6396 2851s
  4120  2670 27094.9168   11  492 19683.9425 29059.9312  47.6%  6395 2856s
  4121  2671 23577.7546   26  598 19683.9425 29059.9312  47.6%  6393 2866s
  4122  2672 20484.3812   20  547 19683.9425 29059.9312  47.6%  6392 2871s
  4123  2672 22623.5762   42  594 19683.9425 29059.9312  47.6%  6390 2881s
  4124  2673 26926.0971    7  533 19683.9425 29059.9312  47.6%  6389 2887s
  4125  2674 25442.1615   12  527 19683.9425 29059.9312  47.6%  6387 2897s
  4126  2674 25582.7495   23  527 19683.9425 29059.9312  47.6%  6386 2924s
  4127  2675 21622.5736   64  527 19683.9425 29059.9312  47.6%  6384 3001s
  4128  2678 29059.9312   13  467 19683.9425 29059.9312  47.6%  6492 3026s
  4129  2679 29059.9312   14  508 19683.9425 29059.9312  47.6%  6492 3054s
  4131  2684 29059.9312   14  431 19683.9425 29059.9312  47.6%  6496 3083s
  4136  2692 29059.9312   15  425 19683.9425 29059.9312  47.6%  6506 3143s
  4146  2709 28512.4518   16  421 19683.9425 29059.9312  47.6%  6514 3193s
  4166  2714 28086.9646   17  404 19683.9425 29059.9312  47.6%  6637 3274s
  4178  2732 27239.0037   18  344 19683.9425 29059.9312  47.6%  6660 3330s
  4202  2825 26940.9206   19  347 19683.9425 29059.9312  47.6%  6700 3403s
  4303  2826 24375.2704   21  256 19683.9425 29059.9312  47.6%  6725 3431s
  4338  2870 24351.1760   22  257 19683.9425 29059.9312  47.6%  6785 3457s
  4397  2903 23707.9476   24  214 19683.9425 29059.9312  47.6%  6799 3488s
  4460  2930 20186.4472   27  197 19683.9425 29059.9312  47.6%  6816 3516s
  4530  2918     cutoff   31      19683.9425 29059.9312  47.6%  6864 3540s
  4566  2921 21974.7347   24  263 19683.9425 29059.9312  47.6%  6911 3562s
  4612  2916     cutoff   25      19683.9425 29059.9312  47.6%  6949 3587s
  4644  2916 23693.5115   27  330 19683.9425 29059.9312  47.6%  6997 3600s

Cutting planes:
  Learned: 1
  Gomory: 3
  Implied bound: 13
  Projected implied bound: 208
  MIR: 1269
  Flow cover: 2502
  RLT: 29
  Relax-and-lift: 456

Explored 4670 nodes (33312271 simplex iterations) in 3600.06 seconds (9555.56 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 19683.9 19666.6 19662.3 ... 19450.7

Time limit reached
Best objective 1.968394254286e+04, best bound 2.905993117740e+04, gap 47.6327%
  WARNING: Time limit reached. Using best solution found (gap: 47.63%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = 19683.94, θ = 141894.56
  Upper Bound (UB) = 19683.94

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 141894.56
  [DEBUG]   ✓ Scenario 0: θ = 141894.56 ≤ Q = 141894.56 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 141894.56 ≤ Q = 141894.56 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 141894.56 ≤ Q = 141894.56 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 141894.56 ≤ Q = 141894.56 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 141894.56 ≤ Q = 141894.56 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 141894.56 ≤ Q = 141894.56 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 141894.56 ≤ Q = 141894.56 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 141894.56 ≤ Q = 141894.56 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 141894.56 ≤ Q = 141894.56 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 141894.56 ≤ Q = 141894.56 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 141894.56 ≤ Q = 141894.56 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 141894.56 ≤ Q = 141894.56 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 141894.56 ≤ Q = 141894.56 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 141894.56 ≤ Q = 141894.56 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 14] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x6681c139
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x997e3ec7
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.457366e+13
Presolve removed 2571 rows and 1864 columns
Presolve time: 0.00s
Presolved: 522 rows, 525 columns, 1472 nonzeros
Found heuristic solution: objective 7772587.5611
Variable types: 355 continuous, 170 integer (170 binary)

Root relaxation: objective -1.358034e+05, 245 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -135803.38    0  124 7772587.56 -135803.38   102%     -    0s
H    0     0                    -100840.1332 -135803.38  34.7%     -    0s
H    0     0                    -101393.0402 -135803.38  33.9%     -    0s
     0     0 -108518.31    0  136 -101393.04 -108518.31  7.03%     -    0s
H    0     0                    -103971.6785 -108477.97  4.33%     -    0s
     0     0 -107769.82    0  137 -103971.68 -107769.82  3.65%     -    0s
     0     0 -107669.65    0  136 -103971.68 -107669.65  3.56%     -    0s
     0     0 -107669.65    0  134 -103971.68 -107669.65  3.56%     -    0s
H    0     0                    -104190.3021 -107669.65  3.34%     -    0s
     0     0 -107215.75    0  136 -104190.30 -107215.75  2.90%     -    0s
H    0     0                    -104401.6245 -107214.34  2.69%     -    0s
     0     0 -106961.29    0  128 -104401.62 -106961.29  2.45%     -    0s
H    0     0                    -104794.7509 -106947.45  2.05%     -    0s
     0     0 -106947.45    0  129 -104794.75 -106947.45  2.05%     -    0s
     0     0 -106721.14    0   89 -104794.75 -106721.14  1.84%     -    0s
H    0     0                    -104892.9789 -106721.02  1.74%     -    0s
H    0     0                    -105426.0058 -106721.02  1.23%     -    0s
     0     0 -106717.28    0   90 -105426.01 -106717.28  1.22%     -    0s
     0     0 -106634.33    0  113 -105426.01 -106634.33  1.15%     -    0s
     0     0 -106632.47    0  113 -105426.01 -106632.47  1.14%     -    0s
H    0     0                    -105915.3619 -106632.47  0.68%     -    0s
     0     2 -106632.47    0  113 -105915.36 -106632.47  0.68%     -    0s
H   44    16                    -105930.6998 -106382.87  0.43%  13.3    0s
H   56    15                    -105956.8973 -106382.87  0.40%  11.8    0s
H  145    15                    -105962.9952 -106281.39  0.30%   6.6    0s
H  150    15                    -105966.3619 -106281.39  0.30%   6.5    0s
H  174    15                    -105985.5123 -106281.39  0.28%   6.1    0s
*  397    55              28    -106050.1721 -106087.00  0.03%   5.8    0s
H  399    55                    -106071.7332 -106087.00  0.01%   5.8    0s

Cutting planes:
  Gomory: 53
  Implied bound: 2
  MIR: 202
  RLT: 1

Explored 517 nodes (3488 simplex iterations) in 0.11 seconds (0.11 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -106072 -106050 -105986 ... -104893
No other solutions better than -106072

Optimal solution found (tolerance 1.00e-04)
Best objective -1.060717331715e+05, best bound -1.060717331715e+05, gap 0.0000%
  Subproblem solved in 0.13s
  Worst-case operational profit (Z_SP) = 140264.87
  Scenario: 14 demand increases, 46 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -106071.73
  [DEBUG]   S×d_nominal = 246336.61
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 246336.61 + -106071.73 = 140264.87
  [DEBUG]   Current θ from Master = 141894.56
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1629.69 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 18054.26
  Lower Bound (LB) = 19157.49
  Gap (UB-LB) = 526.4502, Absolute Gap = 526.4502, Relative Gap = 0.026745
  Not converged yet (gap = 526.45 > ε = 200)

  [DEBUG] Adding NEW scenario 14 to Master Problem...
  [DEBUG] New scenario pattern: 14 increases, 46 decreases
    [DEBUG] Scenario 14 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 14 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 14]
    [DEBUG]   - Total constraints in model: 230733
    [DEBUG]   - Total variables in model: 95860
  [DEBUG] Total scenarios in Master: 15
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 15
================================================================================
[Iteration 15] Solving Master Problem...
  Current scenarios in Master: 15
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 230733 rows, 95860 columns and 654209 nonzeros
Model fingerprint: 0x14bfaa69
Variable types: 93601 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 98635 rows and 40055 columns
Presolve time: 2.13s
Presolved: 132098 rows, 55805 columns, 813114 nonzeros
Variable types: 53546 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -368050.8111
Found heuristic solution: objective -194531.7474

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.32s

Barrier statistics:
 Dense cols : 733
 AA' NZ     : 5.372e+06
 Factor NZ  : 1.245e+07 (roughly 180 MB of memory)
 Factor Ops : 2.860e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.55185332e+07  2.13782655e+08  8.85e+04 2.13e+01  6.39e+04     4s
   1  -1.17595631e+07  1.80512887e+08  6.24e+04 5.49e+01  4.48e+04     4s
   2  -4.12734915e+06  1.40527306e+08  2.13e+04 8.07e+00  1.58e+04     4s
   3  -8.76398373e+05  9.88318080e+07  1.63e+03 1.53e+00  1.55e+03     4s
   4  -5.94457365e+05  3.98557592e+07  5.37e+02 4.16e-01  5.05e+02     4s
   5  -4.84772035e+05  2.73802755e+07  2.84e+02 2.34e-01  2.82e+02     4s
   6  -3.31454427e+05  2.00783549e+07  9.84e+01 1.49e-01  1.38e+02     4s
   7  -2.12887756e+05  1.46092035e+07  3.63e+01 9.95e-02  7.87e+01     4s
   8  -1.25257956e+05  1.04237939e+07  1.30e+01 6.67e-02  4.87e+01     4s
   9  -1.10924332e+05  7.91784074e+06  9.51e+00 4.94e-02  3.62e+01     4s
  10  -9.05516905e+04  3.99765614e+06  5.57e+00 2.36e-02  1.79e+01     4s
  11  -6.84068361e+04  1.51740549e+06  2.55e+00 8.36e-03  6.77e+00     4s
  12  -4.16989090e+04  4.59130613e+05  8.91e-01 2.33e-03  2.10e+00     4s
  13  -1.32821018e+04  2.28833774e+05  4.32e-01 1.12e-03  1.01e+00     4s
  14  -3.71393215e+03  1.61801233e+05  3.24e-01 1.42e-03  6.91e-01     4s
  15   5.11711245e+03  1.32616418e+05  2.62e-01 1.56e-03  5.32e-01     4s
  16   1.21319736e+04  1.06232648e+05  2.17e-01 1.78e-03  3.93e-01     5s
  17   1.48869813e+04  9.33067746e+04  1.98e-01 1.80e-03  3.28e-01     5s
  18   2.33308575e+04  8.28875590e+04  1.41e-01 1.80e-03  2.49e-01     5s
  19   2.65312974e+04  7.49903328e+04  1.20e-01 1.69e-03  2.02e-01     5s
  20   2.77460182e+04  6.63396289e+04  1.13e-01 1.69e-03  1.61e-01     5s
  21   3.16613162e+04  6.35228819e+04  8.98e-02 1.94e-03  1.33e-01     5s
  22   3.43890847e+04  5.99984015e+04  7.39e-02 1.77e-03  1.07e-01     5s
  23   3.63590569e+04  5.72634041e+04  6.30e-02 2.61e-03  8.74e-02     5s
  24   3.90322587e+04  5.55775887e+04  4.88e-02 1.91e-03  6.92e-02     5s
  25   3.96681962e+04  5.35305362e+04  4.52e-02 1.87e-03  5.80e-02     5s
  26   4.13101241e+04  5.32029158e+04  3.70e-02 1.73e-03  4.97e-02     5s
  27   4.22622086e+04  5.23305280e+04  3.23e-02 1.39e-03  4.21e-02     5s
  28   4.29285759e+04  5.16603174e+04  2.90e-02 1.10e-03  3.65e-02     5s
  29   4.45445933e+04  5.08292171e+04  2.10e-02 7.42e-04  2.63e-02     5s
  30   4.51912445e+04  5.07014497e+04  1.79e-02 6.85e-04  2.31e-02     5s
  31   4.64060981e+04  5.01884871e+04  1.22e-02 4.81e-04  1.58e-02     5s
  32   4.68498833e+04  4.97373305e+04  1.01e-02 2.90e-04  1.21e-02     5s
  33   4.76126876e+04  4.95333141e+04  6.54e-03 2.01e-04  8.04e-03     6s
  34   4.80933261e+04  4.93771809e+04  4.34e-03 2.06e-04  5.37e-03     6s
  35   4.82488124e+04  4.93037702e+04  3.67e-03 1.49e-04  4.42e-03     6s
  36   4.83545547e+04  4.92903777e+04  3.19e-03 1.40e-04  3.92e-03     6s
  37   4.85105017e+04  4.91906794e+04  2.48e-03 1.54e-04  2.85e-03     6s
  38   4.87897316e+04  4.91795486e+04  1.24e-03 1.35e-04  1.63e-03     6s
  39   4.89756955e+04  4.91413365e+04  4.32e-04 8.03e-05  6.92e-04     6s
  40   4.89967012e+04  4.91078439e+04  3.47e-04 3.15e-05  4.65e-04     6s
  41   4.90183724e+04  4.91040384e+04  2.59e-04 2.60e-05  3.58e-04     6s
  42   4.90311862e+04  4.90994745e+04  2.07e-04 1.94e-05  2.86e-04     6s
  43   4.90675763e+04  4.90970793e+04  6.47e-05 1.60e-05  1.23e-04     6s
  44   4.90847077e+04  4.90888272e+04  1.85e-06 6.85e-06  1.71e-05     6s
  45   4.90857019e+04  4.90858585e+04  9.73e-08 1.63e-07  6.52e-07     6s
  46   4.90857988e+04  4.90858010e+04  3.55e-08 2.55e-08  9.17e-09     6s
  47   4.90858008e+04  4.90858009e+04  8.29e-08 5.75e-10  4.63e-10     6s

Barrier solved model in 47 iterations and 6.49 seconds (11.64 work units)
Optimal objective 4.90858008e+04


Root crossover log...

  118169 DPushes remaining with DInf 0.0000000e+00                 7s
    6694 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                11s

    5863 PPushes remaining with PInf 6.1133780e-05                12s
       0 PPushes remaining with PInf 0.0000000e+00                12s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.0969660e+02     12s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   63485    4.9085801e+04   0.000000e+00   1.096966e+02     12s
   63536    4.9085801e+04   0.000000e+00   0.000000e+00     12s
   63536    4.9085801e+04   0.000000e+00   0.000000e+00     12s
Concurrent spin time: 2.67s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 4.908580e+04, 63536 iterations, 12.29 seconds (23.39 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 49085.8009    0  174 -194531.75 49085.8009   125%     -   15s
H    0     0                    -150030.6473 49085.8009   133%     -   16s
H    0     0                    -141330.4905 49085.8009   135%     -   16s
H    0     0                    -138265.8185 49085.8009   136%     -   17s
H    0     0                    -136971.8381 49085.8009   136%     -   17s
H    0     0                    -136746.2973 49085.8009   136%     -   17s
H    0     0                    -136562.7024 49085.8009   136%     -   18s
H    0     0                    -136549.6986 49085.8009   136%     -   18s
H    0     0                    -136426.7950 49085.8009   136%     -   18s
H    0     0                    -135663.3144 49085.8009   136%     -   18s
H    0     0                    -135622.3934 49085.8009   136%     -   18s
H    0     0                    -7629.194606 49085.8009   743%     -   18s
H    0     0                    -7091.562709 49085.8009   792%     -   18s
H    0     0                    11188.468105 43069.6579   285%     -   71s
H    0     0                    13392.307470 43069.6579   222%     -   71s
     0     0 43039.7257    0  223 13392.3075 43039.7257   221%     -   72s
     0     0 42321.2925    0  287 13392.3075 42321.2925   216%     -   98s
     0     0 42321.2925    0  295 13392.3075 42321.2925   216%     -  106s
     0     0 42321.2925    0  260 13392.3075 42321.2925   216%     -  113s
     0     0 42321.2925    0  258 13392.3075 42321.2925   216%     -  116s
     0     0 42321.2925    0  265 13392.3075 42321.2925   216%     -  118s
     0     0 39608.4006    0  265 13392.3075 39608.4006   196%     -  120s
     0     0 39494.4794    0  331 13392.3075 39494.4794   195%     -  162s
H    0     0                    13439.072177 39494.3478   194%     -  162s
H    0     0                    13472.890794 39494.3478   193%     -  162s
     0     0 39093.9821    0  331 13472.8908 39093.9821   190%     -  181s
     0     0 38915.6490    0  336 13472.8908 38915.6490   189%     -  191s
H    0     0                    13900.844662 38704.1514   178%     -  201s
H    0     0                    13940.458058 38704.1514   178%     -  201s
H    0     0                    13946.811770 38704.1514   178%     -  201s
H    0     0                    13977.169700 38704.1514   177%     -  201s
H    0     0                    13988.942920 38704.1514   177%     -  201s
     0     0 38704.1514    0  324 13988.9429 38704.1514   177%     -  201s
     0     0 38659.2941    0  267 13988.9429 38659.2941   176%     -  206s
     0     0 38654.8942    0  267 13988.9429 38654.8942   176%     -  208s
     0     0 38576.4469    0  331 13988.9429 38576.4469   176%     -  216s
     0     0 38565.9151    0  280 13988.9429 38565.9151   176%     -  219s
     0     0 38564.5224    0  350 13988.9429 38564.5224   176%     -  221s
     0     0 38552.8978    0  347 13988.9429 38552.8978   176%     -  224s
     0     0 38550.1471    0  335 13988.9429 38550.1471   176%     -  226s
     0     0 38549.6259    0  342 13988.9429 38549.6259   176%     -  227s
     0     0 36214.8743    0  311 13988.9429 36214.8743   159%     -  271s
H    0     0                    14015.406864 36214.8573   158%     -  272s
H    0     0                    14868.077141 35444.5530   138%     -  304s
H    0     0                    15440.702656 35444.5530   130%     -  304s
H    0     0                    16408.459234 35444.5530   116%     -  304s
H    0     0                    16432.852266 35444.5530   116%     -  304s
H    0     0                    16445.843285 35444.5530   116%     -  304s
H    0     0                    16511.276078 35444.5530   115%     -  304s
H    0     0                    16518.353945 35444.5530   115%     -  304s
H    0     0                    16540.294892 35444.5530   114%     -  304s
H    0     0                    16597.569902 35444.5530   114%     -  304s
H    0     0                    16794.509219 35444.5530   111%     -  304s
H    0     0                    16896.037337 35444.5530   110%     -  304s
H    0     0                    16975.689362 35444.5530   109%     -  304s
H    0     0                    17215.644135 35444.5530   106%     -  304s
H    0     0                    17234.140791 35444.5530   106%     -  304s
H    0     0                    17243.464436 35444.5530   106%     -  304s
     0     0 35444.5530    0  409 17243.4644 35444.5530   106%     -  304s
     0     0 34822.7802    0  446 17243.4644 34822.7802   102%     -  328s
H    0     0                    17286.530089 34655.9705   100%     -  346s
H    0     0                    18421.500596 34655.9705  88.1%     -  346s
H    0     0                    18811.921238 34655.9705  84.2%     -  346s
H    0     0                    18926.080614 34655.9705  83.1%     -  346s
     0     0 34655.9705    0  399 18926.0806 34655.9705  83.1%     -  346s
     0     0 34602.3542    0  403 18926.0806 34602.3542  82.8%     -  356s
     0     0 34584.6445    0  455 18926.0806 34584.6445  82.7%     -  364s
     0     0 34543.9169    0  449 18926.0806 34543.9169  82.5%     -  371s
     0     0 34519.6699    0  489 18926.0806 34519.6699  82.4%     -  378s
     0     0 34472.5417    0  473 18926.0806 34472.5417  82.1%     -  385s
     0     0 34392.5260    0  521 18926.0806 34392.5260  81.7%     -  392s
     0     0 34353.8035    0  534 18926.0806 34353.8035  81.5%     -  398s
     0     0 34341.5243    0  528 18926.0806 34341.5243  81.5%     -  402s
     0     0 34336.8074    0  541 18926.0806 34336.8074  81.4%     -  405s
     0     0 34328.7207    0  535 18926.0806 34328.7207  81.4%     -  408s
     0     0 34325.6937    0  537 18926.0806 34325.6937  81.4%     -  410s
     0     0 34324.8147    0  539 18926.0806 34324.8147  81.4%     -  411s
     0     0 33496.7471    0  429 18926.0806 33496.7471  77.0%     -  456s
H    0     0                    18939.639174 33496.6337  76.9%     -  457s
H    0     0                    19077.215195 33496.6337  75.6%     -  457s
H    0     0                    19089.625568 33496.6337  75.5%     -  457s
H    0     0                    19096.158793 33496.6337  75.4%     -  457s
H    0     0                    19121.024602 33496.6337  75.2%     -  457s
     0     0 33037.6816    0  424 19121.0246 33037.6816  72.8%     -  479s
     0     0 32883.3553    0  547 19121.0246 32883.3553  72.0%     -  494s
     0     0 32828.6009    0  533 19121.0246 32828.6009  71.7%     -  500s
     0     0 32800.3553    0  528 19121.0246 32800.3553  71.5%     -  506s
     0     0 32757.9093    0  540 19121.0246 32757.9093  71.3%     -  510s
     0     0 32700.3715    0  529 19121.0246 32700.3715  71.0%     -  515s
     0     0 32664.2906    0  533 19121.0246 32664.2906  70.8%     -  521s
     0     0 32635.7610    0  537 19121.0246 32635.7610  70.7%     -  525s
     0     0 32611.8236    0  540 19121.0246 32611.8236  70.6%     -  529s
     0     0 32597.7367    0  545 19121.0246 32597.7367  70.5%     -  531s
     0     0 32591.8481    0  555 19121.0246 32591.8481  70.5%     -  532s
     0     0 32590.6376    0  550 19121.0246 32590.6376  70.4%     -  533s
     0     0 32341.5159    0  493 19121.0246 32341.5159  69.1%     -  544s
H    0     0                    19127.133921 32340.8526  69.1%     -  544s
     0     0 32275.4785    0  463 19127.1339 32275.4785  68.7%     -  550s
     0     0 32264.3436    0  457 19127.1339 32264.3436  68.7%     -  554s
     0     0 32255.5354    0  464 19127.1339 32255.5354  68.6%     -  557s
     0     0 32249.9210    0  510 19127.1339 32249.9210  68.6%     -  559s
     0     0 32240.4888    0  528 19127.1339 32240.4888  68.6%     -  561s
     0     0 32230.8078    0  459 19127.1339 32230.8078  68.5%     -  564s
     0     0 32219.8751    0  461 19127.1339 32219.8751  68.5%     -  566s
     0     0 32171.8847    0  448 19127.1339 32171.8847  68.2%     -  570s
     0     0 32166.0572    0  514 19127.1339 32166.0572  68.2%     -  572s
     0     0 32154.2284    0  518 19127.1339 32154.2284  68.1%     -  575s
     0     0 32147.7184    0  458 19127.1339 32147.7184  68.1%     -  576s
     0     0 32144.8411    0  523 19127.1339 32144.8411  68.1%     -  578s
     0     0 32144.2892    0  573 19127.1339 32144.2892  68.1%     -  579s
     0     0 32002.5151    0  457 19127.1339 32002.5151  67.3%     -  588s
     0     0 31978.5664    0  461 19127.1339 31978.5664  67.2%     -  594s
     0     0 31970.5873    0  463 19127.1339 31970.5873  67.1%     -  596s
H    0     0                    19176.722629 31957.9215  66.6%     -  600s
H    0     0                    19238.934110 31957.9215  66.1%     -  600s
H    0     0                    19241.753807 31957.9215  66.1%     -  600s
H    0     0                    19242.988151 31957.9215  66.1%     -  600s
     0     0 31957.9215    0  481 19242.9882 31957.9215  66.1%     -  600s
     0     0 31949.5847    0  463 19242.9882 31949.5847  66.0%     -  602s
     0     0 31944.8238    0  481 19242.9882 31944.8238  66.0%     -  604s
     0     0 31939.1253    0  471 19242.9882 31939.1253  66.0%     -  606s
     0     0 31937.3826    0  467 19242.9882 31937.3826  66.0%     -  608s
H    0     0                    19333.396508 31889.2479  64.9%     -  614s
     0     0 31889.2479    0  395 19333.3965 31889.2479  64.9%     -  614s
     0     0 31878.7562    0  395 19333.3965 31878.7562  64.9%     -  617s
     0     0 31865.7248    0  457 19333.3965 31865.7248  64.8%     -  620s
     0     0 31859.0945    0  467 19333.3965 31859.0945  64.8%     -  622s
     0     0 31854.1658    0  466 19333.3965 31854.1658  64.8%     -  624s
     0     0 31853.3601    0  472 19333.3965 31853.3601  64.8%     -  625s
     0     0 31840.8944    0  468 19333.3965 31840.8944  64.7%     -  629s
H    0     0                    19354.032451 31840.4527  64.5%     -  631s
     0     0 31837.6544    0  468 19354.0325 31837.6544  64.5%     -  633s
     0     0 31831.5707    0  474 19354.0325 31831.5707  64.5%     -  635s
     0     0 31826.8755    0  477 19354.0325 31826.8755  64.4%     -  636s
     0     0 31825.3215    0  475 19354.0325 31825.3215  64.4%     -  637s
     0     0 31815.7226    0  530 19354.0325 31815.7226  64.4%     -  642s
     0     0 31807.8978    0  520 19354.0325 31807.8978  64.3%     -  646s
     0     0 31803.1081    0  528 19354.0325 31803.1081  64.3%     -  648s
     0     0 31801.1017    0  536 19354.0325 31801.1017  64.3%     -  650s
     0     0 31794.4483    0  532 19354.0325 31794.4483  64.3%     -  653s
     0     0 31792.8975    0  515 19354.0325 31792.8975  64.3%     -  656s
     0     0 31785.9982    0  478 19354.0325 31785.9982  64.2%     -  660s
     0     0 31781.7513    0  482 19354.0325 31781.7513  64.2%     -  662s
     0     0 31780.7760    0  484 19354.0325 31780.7760  64.2%     -  663s
     0     0 31778.5304    0  533 19354.0325 31778.5304  64.2%     -  667s
     0     0 31777.8514    0  533 19354.0325 31777.8514  64.2%     -  672s
H    0     0                    19360.682327 31777.8514  64.1%     -  777s
H    0     0                    19387.906457 31777.8514  63.9%     -  778s
H    0     0                    19389.642912 31777.8514  63.9%     -  778s
H    0     0                    19427.244873 31777.8514  63.6%     -  782s
H    0     0                    19428.582046 31777.8514  63.6%     -  782s
H    0     2                    19457.366663 31777.8514  63.3%     -  808s
     0     2 31777.8514    0  533 19457.3667 31777.8514  63.3%     -  808s
     1     4 31372.3664    1  512 19457.3667 31775.5534  63.3% 19935  827s
     3     8 30949.9584    2  548 19457.3667 31365.6292  61.2% 19737  860s
     7    16 30835.0166    3  573 19457.3667 30947.1824  59.1% 19943  878s
    15    32 30773.6201    4  525 19457.3667 30834.6938  58.5% 14081  903s
    31    48 30419.6535    5  577 19457.3667 30773.5104  58.2% 23950  964s
    47    80 29474.4732    6  452 19457.3667 30773.5104  58.2% 20933 1006s
H   50    80                    19480.107660 30773.5104  58.0% 20505 1006s
H   51    80                    19500.611117 30773.5104  57.8% 20442 1006s
H   53    80                    19514.868986 30773.5104  57.7% 20213 1006s
H   75    80                    19615.880947 30773.5104  56.9% 17949 1006s
    79   137 29420.6885    7  492 19615.8809 30773.5104  56.9% 17741 1143s
   136   259 28928.0320    9  471 19615.8809 30773.5104  56.9% 14037 1180s
   262   340 28728.6449   10  512 19615.8809 30773.5104  56.9%  9704 1205s
   347   391 28511.6384   10  439 19615.8809 30773.5104  56.9%  8654 1228s
   406   449 28607.2088   11  503 19615.8809 30773.5104  56.9%  8277 1248s
   466   476 27742.0506   12  497 19615.8809 30773.5104  56.9%  8228 1266s
   495   512 27820.2741   11  382 19615.8809 30773.5104  56.9%  8230 1287s
   531   545 27722.6924   13  493 19615.8809 30773.5104  56.9%  8130 1304s
   568   583 27362.1180   15  506 19615.8809 30773.5104  56.9%  8144 1320s
   618   622 27339.3910   16  492 19615.8809 30773.5104  56.9%  8129 1335s
   663   667 27105.2662   16  503 19615.8809 30773.5104  56.9%  8085 1351s
   714   710 26644.8458   17  413 19615.8809 30773.5104  56.9%  8047 1367s
   777   751 26248.5633   18  468 19615.8809 30773.5104  56.9%  7846 1380s
   839   785 26464.8948   19  418 19615.8809 30773.5104  56.9%  7708 1398s
   901   821 25866.3552   19  356 19615.8809 30773.5104  56.9%  7600 1414s
   963   856 26315.9107   20  422 19615.8809 30773.5104  56.9%  7472 1434s
  1026   896 26082.3725   21  418 19615.8809 30773.5104  56.9%  7331 1454s
  1090   933 21738.8262   21  287 19615.8809 30773.5104  56.9%  7355 1475s
  1155   960 25759.1564   22  360 19615.8809 30773.5104  56.9%  7288 1493s
  1190   983 22563.5535   22  428 19615.8809 30773.5104  56.9%  7371 1516s
  1239  1017 24533.2559   24  289 19615.8809 30773.5104  56.9%  7373 1535s
  1289  1077 20878.0039   22  284 19615.8809 30773.5104  56.9%  7381 1557s
H 1347  1077                    19681.827312 30773.5104  56.4%  7353 1557s
  1361  1149 infeasible   23      19681.8273 30773.5104  56.4%  7380 1581s
  1473  1196 27230.1038   11  336 19681.8273 30773.5104  56.4%  7337 1608s
  1566  1266 26396.9972   13  390 19681.8273 30773.5104  56.4%  7446 1633s
  1678  1355 21585.6530   15  318 19681.8273 30773.5104  56.4%  7429 1663s
  1802  1409     cutoff   17      19681.8273 30773.5104  56.4%  7359 1693s
  1934  1475 21403.6848   18  352 19681.8273 30773.5104  56.4%  7247 1723s
  2046  1535 infeasible   21      19681.8273 30773.5104  56.4%  7319 1753s
  2195  1599 20485.0026   24  328 19681.8273 30624.3526  55.6%  7317 1787s
  2313  1651 infeasible   32      19681.8273 30612.6193  55.5%  7360 1819s
  2422  1710 23431.3921   13  188 19681.8273 30612.6193  55.5%  7498 1856s
  2542  1765 21098.3996   14  179 19681.8273 30277.4632  53.8%  7581 1892s
  2657  1823 21534.6416   19  205 19681.8273 30277.4632  53.8%  7689 1926s
  2771  1894 27594.9401    7  522 19681.8273 30277.4632  53.8%  7708 1968s
  2896  1953 26410.6587   10  415 19681.8273 30277.4632  53.8%  7782 2007s
  3024  2048 24536.2518   14  243 19681.8273 30277.4632  53.8%  7846 2049s
H 3187  2099                    19755.380616 29876.8837  51.2%  7877 2095s
H 3193  2097                    19766.059709 29876.8837  51.2%  7901 2095s
  3279  2180 22881.7957   20  254 19766.0597 29876.8837  51.2%  7983 2138s
  3402  2269 22257.5508   25  248 19766.0597 29876.8837  51.2%  8123 2185s
  3533  2356 21377.5119   28  432 19766.0597 29876.8837  51.2%  8281 2235s
  3704  2473 20607.8072   33  266 19766.0597 29876.8837  51.2%  8328 2291s
  3880  2601 infeasible   52      19766.0597 28789.3992  45.7%  8345 2343s
  4067  2602 23141.9096   28  533 19766.0597 28174.1734  42.5%  8358 2596s
  4069  2603 21037.9323   33  156 19766.0597 28174.1734  42.5%  8354 2610s
  4070  2604 21326.8907   30  362 19766.0597 28174.1734  42.5%  8352 2708s
  4071  2605 22235.0221   41  459 19766.0597 28174.1734  42.5%  8350 2769s
  4072  2605 21499.5870   40  421 19766.0597 28174.1734  42.5%  8348 2813s
  4073  2606 25853.7192   17  499 19766.0597 28174.1734  42.5%  8346 2846s
  4074  2607 21901.4269   14  424 19766.0597 28174.1734  42.5%  8344 2862s
  4075  2607 26947.6952    7  428 19766.0597 28174.1734  42.5%  8342 2874s
  4076  2608 27921.3552   12  429 19766.0597 28174.1734  42.5%  8340 2885s
  4077  2609 22180.0456   28  446 19766.0597 28174.1734  42.5%  8338 2898s
  4078  2609 21138.3037   39  511 19766.0597 28174.1734  42.5%  8336 2910s
  4079  2610 26960.5852   11  446 19766.0597 28174.1734  42.5%  8334 2919s
  4080  2611 20405.7801   25  449 19766.0597 28174.1734  42.5%  8332 2926s
  4081  2611 25716.7433   19  530 19766.0597 28174.1734  42.5%  8329 2934s
  4082  2612 20991.3357   36  509 19766.0597 28174.1734  42.5%  8327 2941s
  4083  2613 24015.6644   23  471 19766.0597 28174.1734  42.5%  8325 2953s
  4084  2613 21423.9835   26  452 19766.0597 28174.1734  42.5%  8323 2960s
  4086  2615 24991.6896   20  461 19766.0597 28174.1734  42.5%  8319 2969s
  4087  2615 27049.2202    7  483 19766.0597 28174.1734  42.5%  8317 2975s
  4088  2616 20674.3606   23  476 19766.0597 28174.1734  42.5%  8315 2986s
  4089  2617 21427.9620   33  464 19766.0597 28174.1734  42.5%  8313 2991s
  4090  2617 22443.0427   22  555 19766.0597 28174.1734  42.5%  8311 2999s
  4091  2618 23026.8450   11  532 19766.0597 28174.1734  42.5%  8309 3010s
  4092  2619 20276.8592   21  470 19766.0597 28174.1734  42.5%  8307 3015s
  4093  2619 27071.2142   10  566 19766.0597 28174.1734  42.5%  8305 3025s
  4094  2620 21460.2684   24  576 19766.0597 28174.1734  42.5%  8303 3033s
  4095  2621 22512.3449   26  475 19766.0597 28174.1734  42.5%  8301 3047s
  4096  2621 23334.2993   34  539 19766.0597 28174.1734  42.5%  8299 3053s
  4097  2622 21605.5929   36  482 19766.0597 28174.1734  42.5%  8297 3060s
  4098  2623 26384.7633   14  540 19766.0597 28174.1734  42.5%  8295 3074s
  4099  2623 21347.4861   48  532 19766.0597 28174.1734  42.5%  8293 3078s
  4100  2624 25089.8851   25  585 19766.0597 28174.1734  42.5%  8291 3085s
  4101  2625 24531.4983   17  537 19766.0597 28174.1734  42.5%  8289 3096s
  4102  2625 22942.0430   29  582 19766.0597 28174.1734  42.5%  8287 3103s
  4103  2626 22539.3395   32  534 19766.0597 28174.1734  42.5%  8285 3113s
  4104  2627 20391.4952   27  534 19766.0597 28174.1734  42.5%  8283 3128s
  4105  2627 20267.0547   49  534 19766.0597 28174.1734  42.5%  8281 3224s
  4106  2630 28174.1734   16  374 19766.0597 28174.1734  42.5%  8399 3303s
  4107  2632 28174.1734   17  370 19766.0597 28174.1734  42.5%  8400 3331s
  4109  2636 28174.1734   17  534 19766.0597 28174.1734  42.5%  8402 3369s
  4114  2643 28174.1734   19  490 19766.0597 28174.1734  42.5%  8406 3411s
  4123  2659 28174.1734   19  366 19766.0597 28174.1734  42.5%  8438 3447s
  4142  2666 28040.3498   20  328 19766.0597 28174.1734  42.5%  8460 3521s
  4155  2688 27757.4161   21  320 19766.0597 28174.1734  42.5%  8530 3569s
  4181  2720 25436.2834   22  361 19766.0597 28174.1734  42.5%  8607 3600s

Cutting planes:
  Learned: 1
  Implied bound: 7
  Projected implied bound: 140
  MIR: 1416
  Mixing: 1
  Flow cover: 2167
  RLT: 30
  Relax-and-lift: 328

Explored 4222 nodes (36981477 simplex iterations) in 3600.05 seconds (9950.67 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 19766.1 19755.4 19681.8 ... 19427.2

Time limit reached
Best objective 1.976605970893e+04, best bound 2.817417336109e+04, gap 42.5381%
  WARNING: Time limit reached. Using best solution found (gap: 42.54%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.09s
  Master Objective (UB) = 19766.06, θ = 142383.13
  Upper Bound (UB) = 19766.06

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 142383.13
  [DEBUG]   ✓ Scenario 0: θ = 142383.13 ≤ Q = 142383.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 142383.13 ≤ Q = 142383.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 142383.13 ≤ Q = 142383.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 142383.13 ≤ Q = 142383.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 142383.13 ≤ Q = 142383.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 142383.13 ≤ Q = 142383.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 142383.13 ≤ Q = 142383.13 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 142383.13 ≤ Q = 142383.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 142383.13 ≤ Q = 142383.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 142383.13 ≤ Q = 142383.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 142383.13 ≤ Q = 142383.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 142383.13 ≤ Q = 142383.13 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 142383.13 ≤ Q = 142383.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 142383.13 ≤ Q = 142383.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 142383.13 ≤ Q = 142383.13 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 15] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x67764f48
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x67764f48
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.462371e+13
Presolve removed 2571 rows and 1864 columns
Presolve time: 0.00s
Presolved: 522 rows, 525 columns, 1472 nonzeros
Found heuristic solution: objective 7787426.1020
Variable types: 355 continuous, 170 integer (170 binary)

Root relaxation: objective -1.353691e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -135369.12    0  124 7787426.10 -135369.12   102%     -    0s
H    0     0                    -100489.7545 -135369.12  34.7%     -    0s
H    0     0                    -101000.1090 -135369.12  34.0%     -    0s
     0     0 -108806.40    0   76 -101000.11 -108806.40  7.73%     -    0s
H    0     0                    -105640.6270 -108679.89  2.88%     -    0s
H    0     0                    -105934.0991 -108679.89  2.59%     -    0s
H    0     0                    -106241.0861 -108679.89  2.30%     -    0s
H    0     0                    -106534.5582 -108679.89  2.01%     -    0s
     0     0 -107990.25    0   76 -106534.56 -107990.25  1.37%     -    0s
H    0     0                    -106794.5684 -107902.61  1.04%     -    0s
     0     0 -107574.76    0   80 -106794.57 -107574.76  0.73%     -    0s
     0     0 -107264.02    0   47 -106794.57 -107264.02  0.44%     -    0s
     0     0 -107212.77    0   53 -106794.57 -107212.77  0.39%     -    0s
     0     0 -107190.32    0   52 -106794.57 -107190.32  0.37%     -    0s
     0     0 -107076.80    0   42 -106794.57 -107076.80  0.26%     -    0s
     0     0 -107066.25    0   41 -106794.57 -107066.25  0.25%     -    0s
     0     0 -107061.86    0   41 -106794.57 -107061.86  0.25%     -    0s
     0     0 -107048.33    0   41 -106794.57 -107048.33  0.24%     -    0s
H    0     0                    -106822.4425 -107048.33  0.21%     -    0s
     0     0 -107048.33    0   80 -106822.44 -107048.33  0.21%     -    0s
     0     0 -107048.33    0   43 -106822.44 -107048.33  0.21%     -    0s
H    0     0                    -106823.3434 -107048.33  0.21%     -    0s
     0     0 -106987.39    0   39 -106823.34 -106987.39  0.15%     -    0s
     0     0 -106979.35    0   38 -106823.34 -106979.35  0.15%     -    0s
     0     0 -106957.34    0   36 -106823.34 -106957.34  0.13%     -    0s
     0     0 -106954.13    0   36 -106823.34 -106954.13  0.12%     -    0s
     0     0 -106954.13    0   36 -106823.34 -106954.13  0.12%     -    0s
     0     0 -106949.03    0   36 -106823.34 -106949.03  0.12%     -    0s
     0     0 -106949.03    0   45 -106823.34 -106949.03  0.12%     -    0s
     0     0 -106949.03    0   35 -106823.34 -106949.03  0.12%     -    0s
     0     0 -106941.94    0   36 -106823.34 -106941.94  0.11%     -    0s
     0     0 -106931.61    0   24 -106823.34 -106931.61  0.10%     -    0s
     0     0 -106915.46    0   20 -106823.34 -106915.46  0.09%     -    0s
     0     0 -106880.85    0   10 -106823.34 -106880.85  0.05%     -    0s
     0     0 -106855.66    0    9 -106823.34 -106855.66  0.03%     -    0s
     0     0 -106834.95    0    8 -106823.34 -106834.95  0.01%     -    0s

Cutting planes:
  Gomory: 10
  Implied bound: 15
  MIR: 41
  Flow cover: 10
  RLT: 1

Explored 1 nodes (1325 simplex iterations) in 0.12 seconds (0.10 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -106823 -106822 -106795 ... 1.46237e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.068233433946e+05, best bound -1.068309474117e+05, gap 0.0071%
  Subproblem solved in 0.14s
  Worst-case operational profit (Z_SP) = 139641.85
  Scenario: 29 demand increases, 31 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -106823.34
  [DEBUG]   S×d_nominal = 246465.19
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 246465.19 + -106823.34 = 139641.85
  [DEBUG]   Current θ from Master = 142383.13
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2741.28 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 17024.78
  Lower Bound (LB) = 19157.49
  Gap (UB-LB) = 608.5674, Absolute Gap = 608.5674, Relative Gap = 0.030789
  Not converged yet (gap = 608.57 > ε = 200)

  [DEBUG] Adding NEW scenario 15 to Master Problem...
  [DEBUG] New scenario pattern: 29 increases, 31 decreases
    [DEBUG] Scenario 15 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 15 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 15]
    [DEBUG]   - Total constraints in model: 246023
    [DEBUG]   - Total variables in model: 102100
  [DEBUG] Total scenarios in Master: 16
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 16
================================================================================
[Iteration 16] Solving Master Problem...
  Current scenarios in Master: 16
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 246023 rows, 102100 columns and 697455 nonzeros
Model fingerprint: 0x406a4423
Variable types: 99841 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 105200 rows and 42720 columns
Presolve time: 2.41s
Presolved: 140823 rows, 59380 columns, 866632 nonzeros
Variable types: 57121 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -366999.6780
Found heuristic solution: objective -194531.7474

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.13s

Barrier statistics:
 Dense cols : 731
 AA' NZ     : 6.033e+06
 Factor NZ  : 1.373e+07 (roughly 200 MB of memory)
 Factor Ops : 3.131e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.59743979e+07  2.26365540e+08  9.11e+04 2.02e+01  6.54e+04     5s
   1  -1.21288386e+07  1.91750623e+08  6.44e+04 5.49e+01  4.60e+04     5s
   2  -4.32437615e+06  1.49697140e+08  2.24e+04 7.82e+00  1.65e+04     5s
   3  -1.11797418e+06  1.19577372e+08  2.40e+03 3.97e+00  2.14e+03     5s
   4  -6.81985282e+05  8.76500634e+07  5.93e+02 2.43e+00  7.35e+02     5s
   5  -6.16106774e+05  4.43650241e+07  4.33e+02 6.94e-01  4.27e+02     5s
   6  -4.94771891e+05  3.34532870e+07  1.95e+02 3.93e-02  2.40e+02     5s
   7  -3.56873806e+05  2.41893207e+07  5.68e+01 2.69e-02  1.24e+02     5s
   8  -2.39854393e+05  1.54325916e+07  2.35e+01 1.60e-02  7.05e+01     5s
   9  -1.41845780e+05  1.21909851e+07  8.09e+00 1.23e-02  5.08e+01     5s
  10  -1.10377967e+05  7.04220924e+06  4.48e+00 6.75e-03  2.88e+01     5s
  11  -7.97293166e+04  3.27785542e+06  1.67e+00 3.05e-03  1.33e+01     5s
  12  -6.37661557e+04  1.74391571e+06  9.52e-01 1.61e-03  7.10e+00     6s
  13  -3.95069218e+04  6.00476579e+05  3.76e-01 5.56e-04  2.50e+00     6s
  14  -1.30895071e+04  2.92859193e+05  1.88e-01 3.36e-04  1.19e+00     6s
  15  -5.66386794e+03  2.07794954e+05  1.50e-01 2.88e-04  8.33e-01     6s
  16   7.75026671e+03  1.59028730e+05  9.73e-02 1.98e-04  5.90e-01     6s
  17   1.47218778e+04  1.38551723e+05  7.78e-02 1.77e-04  4.83e-01     6s
  18   1.72917991e+04  1.28351054e+05  7.03e-02 2.08e-04  4.33e-01     6s
  19   2.20812042e+04  9.99513054e+04  5.71e-02 1.10e-03  3.04e-01     6s
  20   2.63082171e+04  8.70138305e+04  4.61e-02 1.57e-03  2.37e-01     6s
  21   2.88269124e+04  7.93193802e+04  4.00e-02 1.29e-03  1.97e-01     6s
  22   3.22481961e+04  6.84342327e+04  3.20e-02 1.86e-03  1.41e-01     6s
  23   3.30725888e+04  6.68603392e+04  3.02e-02 1.72e-03  1.32e-01     6s
  24   3.66945055e+04  6.32239128e+04  2.23e-02 1.40e-03  1.03e-01     6s
  25   3.84424044e+04  5.86654773e+04  1.87e-02 9.60e-04  7.89e-02     6s
  26   3.96879330e+04  5.60119981e+04  1.63e-02 7.03e-04  6.37e-02     6s
  27   4.18888692e+04  5.42836029e+04  1.21e-02 5.35e-04  4.84e-02     7s
  28   4.33611083e+04  5.26668614e+04  9.46e-03 3.70e-04  3.63e-02     7s
  29   4.48352184e+04  5.19852594e+04  6.87e-03 3.01e-04  2.79e-02     7s
  30   4.58372330e+04  5.12483049e+04  5.14e-03 2.24e-04  2.11e-02     7s
  31   4.68955227e+04  5.05373684e+04  3.41e-03 1.49e-04  1.42e-02     7s
  32   4.77959038e+04  5.02553046e+04  1.92e-03 1.20e-04  9.59e-03     7s
  33   4.83322371e+04  4.96458933e+04  1.09e-03 5.77e-05  5.12e-03     7s
  34   4.84282659e+04  4.94879086e+04  9.45e-04 4.41e-05  4.13e-03     7s
  35   4.85922665e+04  4.93421867e+04  6.96e-04 2.77e-05  2.93e-03     7s
  36   4.86361554e+04  4.92678490e+04  6.31e-04 1.94e-05  2.47e-03     7s
  37   4.88948971e+04  4.92046142e+04  2.51e-04 1.24e-05  1.21e-03     7s
  38   4.89980688e+04  4.91311444e+04  1.12e-04 4.54e-06  5.19e-04     7s
  39   4.89994556e+04  4.91283683e+04  1.10e-04 4.26e-06  5.03e-04     7s
  40   4.90144718e+04  4.91165962e+04  8.98e-05 3.05e-06  3.98e-04     8s
  41   4.90570086e+04  4.90962774e+04  3.33e-05 9.34e-07  1.53e-04     8s
  42   4.90839482e+04  4.90871117e+04  1.36e-06 6.79e-06  1.23e-05     8s
  43   4.90857740e+04  4.90857800e+04  9.00e-09 1.34e-07  2.33e-08     8s
  44   4.90857775e+04  4.90857776e+04  4.28e-09 1.17e-09  5.70e-10     8s

Barrier solved model in 44 iterations and 7.83 seconds (12.96 work units)
Optimal objective 4.90857775e+04


Root crossover log...

  125853 DPushes remaining with DInf 0.0000000e+00                 8s
   24715 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                13s

    7116 PPushes remaining with PInf 1.3139249e-04                13s
       0 PPushes remaining with PInf 0.0000000e+00                14s

  Push phase complete: Pinf 0.0000000e+00, Dinf 9.4685640e+02     14s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   68615    4.9085778e+04   0.000000e+00   9.468564e+02     14s
   68699    4.9085778e+04   0.000000e+00   0.000000e+00     14s
   68699    4.9085778e+04   0.000000e+00   0.000000e+00     14s
Concurrent spin time: 2.65s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 4.908578e+04, 68699 iterations, 13.45 seconds (24.69 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 49085.7776    0  174 -194531.75 49085.7776   125%     -   17s
H    0     0                    -191857.3415 49085.7776   126%     -   17s
H    0     0                    -159007.1282 49085.7776   131%     -   17s
H    0     0                    -141966.5581 49085.7776   135%     -   17s
H    0     0                    -44548.72900 49085.7776   210%     -   18s
H    0     0                    -44513.04802 49085.7776   210%     -   18s
H    0     0                    7297.6988751 49085.7776   573%     -   18s
H    0     0                    13141.304841 49085.7776   274%     -   18s
H    0     0                    13516.528101 49085.7776   263%     -   18s
H    0     0                    13634.682391 49085.7776   260%     -   18s
H    0     0                    13699.693498 49085.7776   258%     -   18s
H    0     0                    13792.588044 49085.7776   256%     -   18s
H    0     0                    13808.949243 49085.7776   255%     -   18s
     0     0 42441.4191    0  296 13808.9492 42441.4191   207%     -   59s
H    0     0                    13832.106521 42414.5552   207%     -   60s
H    0     0                    13888.578199 42414.5552   205%     -   60s
H    0     0                    13995.204154 42414.5552   203%     -   60s
     0     0 42008.8014    0  304 13995.2042 42008.8014   200%     -   72s
     0     0 41955.1634    0  303 13995.2042 41955.1634   200%     -   78s
     0     0 41951.0375    0  307 13995.2042 41951.0375   200%     -   80s
     0     0 41950.7739    0  275 13995.2042 41950.7739   200%     -   81s
     0     0 38776.9598    0  388 13995.2042 38776.9598   177%     -  130s
H    0     0                    14065.233827 38776.7870   176%     -  130s
H    0     0                    14068.032784 38776.7870   176%     -  130s
H    0     0                    14087.219769 38776.7870   175%     -  130s
H    0     0                    14090.734032 38776.7870   175%     -  130s
H    0     0                    14101.851401 38776.7870   175%     -  130s
H    0     0                    14118.675100 38776.7870   175%     -  130s
H    0     0                    14119.049518 38776.7870   175%     -  130s
H    0     0                    14139.445500 38776.7870   174%     -  130s
     0     0 38513.4609    0  358 14139.4455 38513.4609   172%     -  150s
     0     0 38461.2793    0  357 14139.4455 38461.2793   172%     -  158s
     0     0 38444.5042    0  358 14139.4455 38444.5042   172%     -  162s
     0     0 38439.5060    0  365 14139.4455 38439.5060   172%     -  167s
     0     0 38434.9685    0  366 14139.4455 38434.9685   172%     -  170s
     0     0 38433.3027    0  406 14139.4455 38433.3027   172%     -  173s
     0     0 38433.0236    0  402 14139.4455 38433.0236   172%     -  174s
     0     0 36297.8753    0  324 14139.4455 36297.8753   157%     -  230s
H    0     0                    14148.734175 36297.5086   157%     -  231s
H    0     0                    14154.588279 36297.5086   156%     -  231s
H    0     0                    14217.193930 36297.5086   155%     -  231s
H    0     0                    14286.128025 36297.5086   154%     -  231s
     0     0 35696.8474    0  491 14286.1280 35696.8474   150%     -  253s
     0     0 35462.9291    0  461 14286.1280 35462.9291   148%     -  268s
     0     0 35286.0946    0  498 14286.1280 35286.0946   147%     -  283s
     0     0 35183.1824    0  473 14286.1280 35183.1824   146%     -  296s
     0     0 35153.8455    0  482 14286.1280 35153.8455   146%     -  304s
     0     0 34985.0400    0  466 14286.1280 34985.0400   145%     -  315s
     0     0 34902.4276    0  473 14286.1280 34902.4276   144%     -  327s
     0     0 34885.2086    0  474 14286.1280 34885.2086   144%     -  332s
     0     0 34878.8565    0  472 14286.1280 34878.8565   144%     -  335s
     0     0 34870.1517    0  466 14286.1280 34870.1517   144%     -  340s
     0     0 34861.7104    0  461 14286.1280 34861.7104   144%     -  343s
     0     0 34832.2372    0  470 14286.1280 34832.2372   144%     -  347s
     0     0 34824.5542    0  480 14286.1280 34824.5542   144%     -  350s
     0     0 34801.1532    0  479 14286.1280 34801.1532   144%     -  354s
     0     0 34796.0221    0  487 14286.1280 34796.0221   144%     -  357s
     0     0 34794.3810    0  486 14286.1280 34794.3810   144%     -  358s
     0     0 33543.0367    0  412 14286.1280 33543.0367   135%     -  392s
H    0     0                    19249.227761 33541.9708  74.3%     -  392s
     0     0 33333.1266    0  417 19249.2278 33333.1266  73.2%     -  410s
     0     0 33106.7101    0  417 19249.2278 33106.7101  72.0%     -  427s
     0     0 33073.7040    0  428 19249.2278 33073.7040  71.8%     -  434s
     0     0 33057.8696    0  423 19249.2278 33057.8696  71.7%     -  438s
     0     0 33018.6771    0  418 19249.2278 33018.6771  71.5%     -  445s
     0     0 32985.9577    0  440 19249.2278 32985.9577  71.4%     -  452s
     0     0 32973.5030    0  447 19249.2278 32973.5030  71.3%     -  458s
     0     0 32966.4837    0  438 19249.2278 32966.4837  71.3%     -  460s
     0     0 32960.1381    0  433 19249.2278 32960.1381  71.2%     -  462s
     0     0 32948.5016    0  430 19249.2278 32948.5016  71.2%     -  465s
     0     0 32938.6793    0  427 19249.2278 32938.6793  71.1%     -  469s
     0     0 32934.8008    0  427 19249.2278 32934.8008  71.1%     -  470s
     0     0 32926.3420    0  423 19249.2278 32926.3420  71.1%     -  472s
     0     0 32798.2611    0  497 19249.2278 32798.2611  70.4%     -  481s
     0     0 32773.4465    0  503 19249.2278 32773.4465  70.3%     -  485s
     0     0 32765.9387    0  497 19249.2278 32765.9387  70.2%     -  489s
     0     0 32756.1126    0  430 19249.2278 32756.1126  70.2%     -  492s
     0     0 32753.1626    0  436 19249.2278 32753.1626  70.2%     -  493s
     0     0 32752.0838    0  434 19249.2278 32752.0838  70.1%     -  494s
     0     0 32535.8994    0  544 19249.2278 32535.8994  69.0%     -  510s
     0     0 32500.4114    0  544 19249.2278 32500.4114  68.8%     -  519s
     0     0 32465.8447    0  547 19249.2278 32465.8447  68.7%     -  523s
     0     0 32461.0939    0  542 19249.2278 32461.0939  68.6%     -  525s
     0     0 32454.7005    0  559 19249.2278 32454.7005  68.6%     -  530s
     0     0 32438.4163    0  546 19249.2278 32438.4163  68.5%     -  534s
     0     0 32406.5432    0  553 19249.2278 32406.5432  68.4%     -  540s
     0     0 32401.0910    0  555 19249.2278 32401.0910  68.3%     -  541s
     0     0 32399.7495    0  556 19249.2278 32399.7495  68.3%     -  543s
     0     0 32234.3464    0  448 19249.2278 32234.3464  67.5%     -  557s
     0     0 32185.9508    0  455 19249.2278 32185.9508  67.2%     -  565s
     0     0 32160.3898    0  464 19249.2278 32160.3898  67.1%     -  573s
     0     0 32122.2876    0  530 19249.2278 32122.2876  66.9%     -  579s
     0     0 32111.0728    0  570 19249.2278 32111.0728  66.8%     -  583s
     0     0 32107.9724    0  525 19249.2278 32107.9724  66.8%     -  584s
     0     0 32105.2680    0  473 19249.2278 32105.2680  66.8%     -  586s
     0     0 32104.0071    0  475 19249.2278 32104.0071  66.8%     -  587s
     0     0 32068.1793    0  525 19249.2278 32068.1793  66.6%     -  595s
     0     0 32049.4326    0  523 19249.2278 32049.4326  66.5%     -  599s
     0     0 32035.8836    0  537 19249.2278 32035.8836  66.4%     -  603s
     0     0 32030.2539    0  530 19249.2278 32030.2539  66.4%     -  606s
     0     0 32026.5898    0  543 19249.2278 32026.5898  66.4%     -  607s
     0     0 32024.8179    0  543 19249.2278 32024.8179  66.4%     -  608s
     0     0 31945.3410    0  455 19249.2278 31945.3410  66.0%     -  617s
     0     0 31922.6104    0  462 19249.2278 31922.6104  65.8%     -  623s
     0     0 31896.2343    0  459 19249.2278 31896.2343  65.7%     -  628s
     0     0 31878.5195    0  460 19249.2278 31878.5195  65.6%     -  631s
     0     0 31875.9344    0  462 19249.2278 31875.9344  65.6%     -  633s
     0     0 31874.5248    0  462 19249.2278 31874.5248  65.6%     -  634s
     0     0 31802.8709    0  461 19249.2278 31802.8709  65.2%     -  645s
     0     0 31788.9843    0  520 19249.2278 31788.9843  65.1%     -  650s
     0     0 31779.5909    0  461 19249.2278 31779.5909  65.1%     -  653s
     0     0 31769.8297    0  516 19249.2278 31769.8297  65.0%     -  656s
     0     0 31768.5415    0  456 19249.2278 31768.5415  65.0%     -  657s
     0     0 31756.3106    0  514 19249.2278 31756.3106  65.0%     -  662s
     0     0 31744.4572    0  507 19249.2278 31744.4572  64.9%     -  671s
     0     0 31736.0564    0  453 19249.2278 31736.0564  64.9%     -  673s
     0     0 31730.6947    0  459 19249.2278 31730.6947  64.8%     -  675s
     0     0 31727.5344    0  455 19249.2278 31727.5344  64.8%     -  677s
     0     0 31726.6962    0  463 19249.2278 31726.6962  64.8%     -  677s
     0     0 31712.0801    0  458 19249.2278 31712.0801  64.7%     -  681s
     0     0 31701.1978    0  452 19249.2278 31701.1978  64.7%     -  684s
     0     0 31698.2986    0  456 19249.2278 31698.2986  64.7%     -  685s
     0     0 31689.3058    0  500 19249.2278 31689.3058  64.6%     -  687s
     0     0 31686.0767    0  509 19249.2278 31686.0767  64.6%     -  689s
     0     0 31685.5894    0  457 19249.2278 31685.5894  64.6%     -  689s
     0     0 31661.8914    0  446 19249.2278 31661.8914  64.5%     -  696s
     0     0 31659.1886    0  449 19249.2278 31659.1886  64.5%     -  723s
     0     0 31657.2238    0  504 19249.2278 31657.2238  64.5%     -  725s
     0     0 31651.7909    0  451 19249.2278 31651.7909  64.4%     -  729s
     0     0 31642.5362    0  462 19249.2278 31642.5362  64.4%     -  732s
     0     0 31636.8023    0  453 19249.2278 31636.8023  64.4%     -  733s
     0     0 31635.8331    0  459 19249.2278 31635.8331  64.3%     -  733s
     0     0 31630.9164    0  453 19249.2278 31630.9164  64.3%     -  737s
     0     0 31629.1927    0  451 19249.2278 31629.1927  64.3%     -  739s
     0     0 31622.7040    0  451 19249.2278 31622.7040  64.3%     -  743s
     0     0 31620.3959    0  451 19249.2278 31620.3959  64.3%     -  748s
H    0     0                    19251.594454 31620.3959  64.2%     -  893s
     0     2 31620.3959    0  451 19251.5945 31620.3959  64.2%     -  895s
     1     3 30458.5996    1  439 19251.5945 31620.3959  64.2% 38492  913s
     2     4 31297.1117    1  548 19251.5945 31297.1117  62.6% 26498  925s
     3     5 29612.7963    2  480 19251.5945 31296.4844  62.6% 24022  944s
     4     9 29276.2886    3  583 19251.5945 31296.4844  62.6% 21960  966s
     8    15 28599.2952    4  527 19251.5945 31293.5405  62.6% 18262  999s
    14    30 28579.2376    5  531 19251.5945 30998.5882  61.0% 16730 1020s
    29    45 29524.1076    4  275 19251.5945 30679.6125  59.4% 17327 1073s
    44    75 29185.4828    5  284 19251.5945 30679.6125  59.4% 20097 1260s
H   76   105                    19460.871836 30499.4145  56.7% 24914 1295s
H   77   105                    19483.101350 30499.4145  56.5% 24650 1295s
H   83   105                    19513.737070 30499.4145  56.3% 23603 1295s
H   91   105                    19521.425943 30499.3818  56.2% 22342 1295s
H  103   105                    19532.492988 30499.3818  56.1% 20484 1295s
   108   136 29037.7962    7  269 19532.4930 30324.5538  55.3% 19937 1328s
   139   169 29031.1074    8  279 19532.4930 30323.7416  55.2% 16729 1358s
H  147   169                    19556.385146 30323.7416  55.1% 16074 1358s
   172   281 28916.6388    9  267 19556.3851 30323.7416  55.1% 14450 1395s
   286   354 28658.1835   13  245 19556.3851 30323.7416  55.1% 10349 1421s
   364   414 28613.9131   15  237 19556.3851 30323.7416  55.1%  9123 1449s
   428   457 27560.9680   18  235 19556.3851 30323.7416  55.1%  8391 1473s
   475   502 27407.9604   19  218 19556.3851 30323.7416  55.1%  8115 1510s
   525   549 23777.1099   21  232 19556.3851 30323.7416  55.1%  7786 1533s
   579   590 22228.0117   23  206 19556.3851 30323.7416  55.1%  7533 1563s
   632   622     cutoff   24      19556.3851 30323.7416  55.1%  7272 1597s
   688   669 22918.3565   22  220 19556.3851 30323.7416  55.1%  7085 1620s
   767   707     cutoff   23      19556.3851 30323.7416  55.1%  6704 1642s
   843   759 22339.2999   23  221 19556.3851 30323.7416  55.1%  6391 1665s
   925   796 21723.8130   26  188 19556.3851 30323.7416  55.1%  6098 1687s
  1015   847 infeasible   31      19556.3851 30323.7416  55.1%  5884 1710s
  1105   912 20612.6899   36  141 19556.3851 30323.7416  55.1%  5662 1731s
  1227   930 20014.5379   43  111 19556.3851 30323.7416  55.1%  5344 1754s
  1259   955 20007.3792   44  107 19556.3851 30323.7416  55.1%  5305 1778s
  1306   989 19999.2564   45  103 19556.3851 30323.7416  55.1%  5236 1800s
  1375  1041 19798.8191   50   93 19556.3851 30323.7416  55.1%  5096 1826s
  1509  1076 19706.3799   55   87 19556.3851 30171.7981  54.3%  4823 1850s
  1637  1120 20670.9750   35  108 19556.3851 30171.7981  54.3%  4617 1879s
  1728  1131 infeasible   37      19556.3851 29703.7757  51.9%  4538 1912s
  1809  1175 26262.4869   10  270 19556.3851 29615.6010  51.4%  4527 1946s
  1892  1223 24750.5274   11  270 19556.3851 29615.6010  51.4%  4517 1979s
  1958  1255 24173.7351   13  271 19556.3851 29615.6010  51.4%  4535 2014s
  2038  1291 20334.5745   14  268 19556.3851 29615.6010  51.4%  4571 2051s
H 2094  1320                    19556.432793 29615.6010  51.4%  4627 2083s
H 2106  1320                    19572.217965 29615.6010  51.3%  4628 2083s
H 2126  1320                    19588.361375 29615.6010  51.2%  4659 2083s
H 2134  1320                    19639.792843 29615.6010  50.8%  4663 2083s
  2149  1369     cutoff   19      19639.7928 29615.6010  50.8%  4678 2122s
H 2246  1429                    19640.910915 29123.7810  48.3%  4697 2155s
  2320  1542 20796.1873   31  179 19640.9109 29123.7810  48.3%  4715 2192s
  2489  1601 20269.7848   37  207 19640.9109 29123.7810  48.3%  4611 2233s
  2668  1650 20218.8935   42  190 19640.9109 29123.7810  48.3%  4492 2280s
  2791  1666 infeasible   33      19640.9109 28846.0271  46.9%  4509 2322s
  2831  1710 26826.5100   10  381 19640.9109 28846.0271  46.9%  4593 2365s
  2891  1731 21825.8836   14  240 19640.9109 28846.0271  46.9%  4639 2404s
  2926  1752 25104.2607   11  406 19640.9109 28846.0271  46.9%  4689 2447s
  2970  1788 25058.9027   12  406 19640.9109 28846.0271  46.9%  4722 2491s
  3030  1856 24712.3850   13  360 19640.9109 28846.0271  46.9%  4745 2536s
  3111  1936 23253.2907   14  344 19640.9109 28715.9516  46.2%  4757 2607s
  3242  2016 20075.1637   15  260 19640.9109 28715.9516  46.2%  4744 2681s
  3417  2077 infeasible   16      19640.9109 28654.2122  45.9%  4712 2735s
  3563  2153 23170.2734   15  321 19640.9109 28654.2122  45.9%  4708 2792s
  3742  2220 22344.7125   18  368 19640.9109 28598.9395  45.6%  4688 2841s
  3863  2276 21904.6538   19  311 19640.9109 28577.6413  45.5%  4682 2904s
  4011  2331 19879.0357   21  128 19640.9109 28577.6413  45.5%  4692 2971s
H 4120  2331                    19644.407447 28476.5227  45.0%  4715 2971s
  4148  2412 20265.7932   37  165 19644.4074 28454.9651  44.9%  4736 3043s
  4321  2480 25181.1739   12  274 19644.4074 28423.8992  44.7%  4783 3118s
  4477  2523 23448.7033   15  234 19644.4074 28398.5988  44.6%  4849 3192s
  4667  2585 infeasible   16      19644.4074 28341.5420  44.3%  4905 3271s
  4887  2662 infeasible   19      19644.4074 28341.5420  44.3%  4915 3352s
  5113  2713 22125.0709   15  426 19644.4074 28080.3714  42.9%  4927 3439s
  5282  2804 infeasible   17      19644.4074 28080.3714  42.9%  4993 3527s

Cutting planes:
  Learned: 1
  Implied bound: 192
  MIR: 3306
  Flow cover: 3886
  RLT: 72
  Relax-and-lift: 654

Explored 5509 nodes (28391384 simplex iterations) in 3600.10 seconds (9194.68 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 19644.4 19640.9 19588.4 ... 19483.1

Time limit reached
Best objective 1.964440744670e+04, best bound 2.793531729957e+04, gap 42.2049%
  WARNING: Time limit reached. Using best solution found (gap: 42.20%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.13s
  Master Objective (UB) = 19644.41, θ = 142234.10
  Upper Bound (UB) = 19644.41

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 142234.10
  [DEBUG]   ✓ Scenario 0: θ = 142234.10 ≤ Q = 142234.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 142234.10 ≤ Q = 142234.10 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 142234.10 ≤ Q = 142234.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 142234.10 ≤ Q = 142234.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 142234.10 ≤ Q = 142234.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 142234.10 ≤ Q = 142234.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 142234.10 ≤ Q = 142234.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 142234.10 ≤ Q = 142234.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 142234.10 ≤ Q = 142234.10 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 142234.10 ≤ Q = 142234.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 142234.10 ≤ Q = 142234.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 142234.10 ≤ Q = 142234.10 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 142234.10 ≤ Q = 142234.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 142234.10 ≤ Q = 142234.10 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 142234.10 ≤ Q = 142234.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 142234.10 ≤ Q = 142234.10 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 16] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x3f4a3130
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xc0b5ced0
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [1e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [7e-15, 2e+02]
Found heuristic solution: objective 1.460667e+13
Presolve removed 2571 rows and 1864 columns
Presolve time: 0.00s
Presolved: 522 rows, 525 columns, 1472 nonzeros
Found heuristic solution: objective 7788466.9262
Variable types: 355 continuous, 170 integer (170 binary)

Root relaxation: objective -1.353377e+05, 245 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -135337.67    0  124 7788466.93 -135337.67   102%     -    0s
H    0     0                    -100456.5591 -135337.67  34.7%     -    0s
H    0     0                    -100984.5319 -135337.67  34.0%     -    0s
     0     0 -107930.33    0  137 -100984.53 -107930.33  6.88%     -    0s
H    0     0                    -103479.9045 -107805.89  4.18%     -    0s
     0     0 -106910.05    0  141 -103479.90 -106910.05  3.31%     -    0s
H    0     0                    -103949.9190 -106380.02  2.34%     -    0s
     0     0 -106380.02    0  138 -103949.92 -106380.02  2.34%     -    0s
     0     0 -106341.63    0  138 -103949.92 -106341.63  2.30%     -    0s
     0     0 -106341.53    0  138 -103949.92 -106341.53  2.30%     -    0s
     0     0 -106131.32    0  139 -103949.92 -106131.32  2.10%     -    0s
H    0     0                    -105116.8787 -106120.84  0.96%     -    0s
     0     0 -106102.97    0  127 -105116.88 -106102.97  0.94%     -    0s
     0     0 -106099.64    0  128 -105116.88 -106099.64  0.93%     -    0s
     0     0 -106014.49    0  128 -105116.88 -106014.49  0.85%     -    0s
     0     0 -106012.92    0  128 -105116.88 -106012.92  0.85%     -    0s
H    0     0                    -105162.6975 -106012.92  0.81%     -    0s
     0     2 -106012.92    0  128 -105162.70 -106012.92  0.81%     -    0s
H   33    28                    -105499.9139 -105836.59  0.32%  15.6    0s
H  222    28                    -105508.7908 -105665.28  0.15%   8.1    0s
*  524   118              25    -105533.6492 -105591.72  0.06%   5.9    0s
*  641    35              26    -105541.1996 -105579.32  0.04%   5.6    0s
*  664    35              30    -105542.5261 -105579.32  0.03%   5.5    0s

Cutting planes:
  Gomory: 35
  Implied bound: 8
  MIR: 226
  RLT: 1

Explored 713 nodes (4466 simplex iterations) in 0.10 seconds (0.09 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -105543 -105541 -105534 ... -100985
No other solutions better than -105543

Optimal solution found (tolerance 1.00e-04)
Best objective -1.055425260502e+05, best bound -1.055425260502e+05, gap 0.0000%
  Subproblem solved in 0.12s
  Worst-case operational profit (Z_SP) = 140649.34
  Scenario: 27 demand increases, 33 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -105542.53
  [DEBUG]   S×d_nominal = 246191.87
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 246191.87 + -105542.53 = 140649.34
  [DEBUG]   Current θ from Master = 142234.10
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1584.76 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 18059.65
  Lower Bound (LB) = 19157.49
  Gap (UB-LB) = 486.9151, Absolute Gap = 486.9151, Relative Gap = 0.024786
  Not converged yet (gap = 486.92 > ε = 200)

  [DEBUG] Adding NEW scenario 16 to Master Problem...
  [DEBUG] New scenario pattern: 27 increases, 33 decreases
    [DEBUG] Scenario 16 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 16 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 16]
    [DEBUG]   - Total constraints in model: 261313
    [DEBUG]   - Total variables in model: 108340
  [DEBUG] Total scenarios in Master: 17
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 17
================================================================================
[Iteration 17] Solving Master Problem...
  Current scenarios in Master: 17
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 261313 rows, 108340 columns and 740701 nonzeros
Model fingerprint: 0xdedbf88d
Variable types: 106081 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 111765 rows and 45385 columns
Presolve time: 2.55s
Presolved: 149548 rows, 62955 columns, 920383 nonzeros
Variable types: 60696 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -366999.6780
Found heuristic solution: objective -194531.7474

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.38s

Barrier statistics:
 Dense cols : 731
 AA' NZ     : 6.719e+06
 Factor NZ  : 1.558e+07 (roughly 200 MB of memory)
 Factor Ops : 3.879e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.64096469e+07  2.38799840e+08  9.36e+04 1.91e+01  6.68e+04     4s
   1  -1.25988208e+07  2.02825414e+08  6.65e+04 5.50e+01  4.70e+04     4s
   2  -4.80249082e+06  1.57604071e+08  2.45e+04 6.25e-01  1.81e+04     5s
   3  -1.04160608e+06  1.11873705e+08  2.97e+03 1.43e+00  2.48e+03     5s
   4  -5.45518083e+05  7.55479248e+07  4.93e+02 5.10e-01  6.00e+02     5s
   5  -4.93060737e+05  3.77045980e+07  3.18e+02 1.99e-01  3.21e+02     5s
   6  -3.80784295e+05  2.98295097e+07  1.04e+02 1.48e-01  1.67e+02     5s
   7  -3.10554912e+05  2.03153703e+07  4.34e+01 9.33e-02  9.59e+01     5s
   8  -2.02997324e+05  1.54439214e+07  1.19e+01 6.89e-02  6.22e+01     5s
   9  -1.22703613e+05  1.23842422e+07  4.18e+00 5.44e-02  4.73e+01     5s
  10  -1.01016658e+05  4.92463718e+06  2.75e+00 2.08e-02  1.88e+01     5s
  11  -7.84733980e+04  2.32326598e+06  1.32e+00 9.55e-03  8.91e+00     5s
  12  -5.59576521e+04  1.07772285e+06  7.15e-01 4.32e-03  4.19e+00     5s
  13  -2.84788020e+04  4.13604047e+05  3.50e-01 1.79e-03  1.63e+00     5s
  14  -5.21247903e+03  2.46732355e+05  1.81e-01 1.06e-03  9.26e-01     5s
  15   1.04476547e+03  1.78953067e+05  1.48e-01 8.03e-04  6.54e-01     5s
  16   1.47055574e+04  1.39493069e+05  8.91e-02 1.29e-03  4.59e-01     5s
  17   1.84004134e+04  1.24542625e+05  7.71e-02 1.26e-03  3.90e-01     5s
  18   2.35994320e+04  1.07137902e+05  6.04e-02 1.93e-03  3.07e-01     6s
  19   2.67438658e+04  9.37957616e+04  5.05e-02 1.62e-03  2.46e-01     6s
  20   2.93001568e+04  8.27349164e+04  4.32e-02 1.81e-03  1.96e-01     6s
  21   3.26146335e+04  7.15354019e+04  3.42e-02 1.64e-03  1.43e-01     6s
  22   3.47713664e+04  6.78600853e+04  2.87e-02 1.39e-03  1.22e-01     6s
  23   3.66701325e+04  6.45520841e+04  2.43e-02 1.18e-03  1.02e-01     6s
  24   3.82619343e+04  6.06368263e+04  2.06e-02 9.08e-04  8.22e-02     6s
  25   4.03677981e+04  5.72532234e+04  1.61e-02 6.49e-04  6.21e-02     6s
  26   4.23351879e+04  5.50557628e+04  1.21e-02 4.76e-04  4.68e-02     6s
  27   4.38137871e+04  5.30821799e+04  9.28e-03 3.20e-04  3.41e-02     6s
  28   4.49812817e+04  5.20154686e+04  7.06e-03 2.34e-04  2.59e-02     6s
  29   4.66739104e+04  5.09440541e+04  3.99e-03 1.48e-04  1.57e-02     6s
  30   4.72762112e+04  5.05494902e+04  2.93e-03 1.16e-04  1.20e-02     6s
  31   4.80230791e+04  4.98024032e+04  1.66e-03 5.58e-05  6.54e-03     6s
  32   4.82537216e+04  4.96029221e+04  1.28e-03 3.98e-05  4.96e-03     7s
  33   4.85679977e+04  4.94636989e+04  7.72e-04 2.88e-05  3.29e-03     7s
  34   4.86616358e+04  4.93007331e+04  6.25e-04 1.61e-05  2.35e-03     7s
  35   4.88943760e+04  4.92137797e+04  2.70e-04 9.38e-06  1.17e-03     7s
  36   4.89729047e+04  4.91386386e+04  1.52e-04 3.74e-06  6.09e-04     7s
  37   4.89888942e+04  4.91319299e+04  1.29e-04 3.25e-06  5.26e-04     7s
  38   4.90231831e+04  4.91062034e+04  8.19e-05 1.39e-06  3.05e-04     7s
  39   4.90704470e+04  4.90968959e+04  1.78e-05 7.55e-07  9.72e-05     7s
  40   4.90849504e+04  4.90864976e+04  6.47e-07 3.29e-06  5.68e-06     7s
  41   4.90857768e+04  4.90857783e+04  1.83e-09 2.03e-07  5.75e-09     7s
  42   4.90857768e+04  4.90857783e+04  6.60e-07 1.97e-07  5.48e-09     7s
  43   4.90857776e+04  4.90857776e+04  3.40e-09 5.06e-08  8.11e-12     7s

Barrier solved model in 43 iterations and 7.45 seconds (13.35 work units)
Optimal objective 4.90857776e+04


Root crossover log...

  133555 DPushes remaining with DInf 1.2453349e-07                 7s
   15487 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                12s

    1654 PPushes remaining with PInf 2.3631938e-06                12s
       0 PPushes remaining with PInf 0.0000000e+00                12s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.1272747e-10     12s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   60240    4.9085778e+04   0.000000e+00   0.000000e+00     13s
   60240    4.9085778e+04   0.000000e+00   0.000000e+00     13s
Concurrent spin time: 0.48s

Solved with barrier

Root relaxation: objective 4.908578e+04, 60240 iterations, 9.79 seconds (22.20 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 49085.7776    0  174 -194531.75 49085.7776   125%     -   13s
H    0     0                    -136610.2848 49085.7776   136%     -   14s
H    0     0                    -136188.1836 49085.7776   136%     -   14s
H    0     0                    -135117.0284 49085.7776   136%     -   14s
H    0     0                    -99856.74345 49085.7776   149%     -   14s
H    0     0                    -44548.72900 49085.7776   210%     -   14s
H    0     0                    -44513.04802 49085.7776   210%     -   14s
H    0     0                    13221.507038 49085.7776   271%     -   14s
H    0     0                    13732.976772 49085.7776   257%     -   15s
H    0     0                    13792.588044 49085.7776   256%     -   15s
H    0     0                    13808.949243 49085.7776   255%     -   15s
     0     0 42598.1053    0  284 13808.9492 42598.1053   208%     -   69s
H    0     0                    13833.023971 42597.4966   208%     -   70s
     0     0 42472.1135    0  295 13833.0240 42472.1135   207%     -   79s
     0     0 42424.9787    0  294 13833.0240 42424.9787   207%     -   83s
     0     0 42424.9610    0  295 13833.0240 42424.9610   207%     -   84s
     0     0 38945.7492    0  264 13833.0240 38945.7492   182%     -  132s
     0     0 38945.7492    0  264 13833.0240 38945.7492   182%     -  132s
H    0     0                    18202.852085 38945.7026   114%     -  133s
H    0     0                    18386.391864 38945.7026   112%     -  133s
H    0     0                    18637.711145 38945.7026   109%     -  133s
H    0     0                    18731.333854 38945.7026   108%     -  133s
H    0     0                    18765.522189 38945.7026   108%     -  133s
H    0     0                    18806.451213 38945.7026   107%     -  133s
H    0     0                    18816.438989 38945.7026   107%     -  133s
     0     0 38474.6673    0  352 18816.4390 38474.6673   104%     -  155s
     0     0 38378.2077    0  352 18816.4390 38378.2077   104%     -  164s
     0     0 38306.1669    0  429 18816.4390 38306.1669   104%     -  172s
     0     0 38207.4387    0  404 18816.4390 38207.4387   103%     -  180s
     0     0 38197.1408    0  406 18816.4390 38197.1408   103%     -  184s
     0     0 38136.9545    0  397 18816.4390 38136.9545   103%     -  192s
     0     0 38134.5675    0  404 18816.4390 38134.5675   103%     -  195s
     0     0 38134.0537    0  402 18816.4390 38134.0537   103%     -  196s
     0     0 36078.4807    0  386 18816.4390 36078.4807  91.7%     -  259s
H    0     0                    18868.106086 36078.2770  91.2%     -  260s
     0     0 35576.0940    0  429 18868.1061 35576.0940  88.6%     -  290s
     0     0 35226.3927    0  421 18868.1061 35226.3927  86.7%     -  316s
     0     0 35030.8069    0  395 18868.1061 35030.8069  85.7%     -  332s
     0     0 34900.7101    0  518 18868.1061 34900.7101  85.0%     -  350s
     0     0 34791.5844    0  452 18868.1061 34791.5844  84.4%     -  361s
     0     0 34745.8015    0  500 18868.1061 34745.8015  84.2%     -  369s
     0     0 34723.5632    0  445 18868.1061 34723.5632  84.0%     -  374s
     0     0 34713.9883    0  441 18868.1061 34713.9883  84.0%     -  377s
     0     0 34694.2830    0  439 18868.1061 34694.2830  83.9%     -  381s
     0     0 34679.0099    0  458 18868.1061 34679.0099  83.8%     -  385s
     0     0 34676.6691    0  456 18868.1061 34676.6691  83.8%     -  387s
     0     0 34674.6913    0  453 18868.1061 34674.6913  83.8%     -  389s
     0     0 34652.1121    0  534 18868.1061 34652.1121  83.7%     -  395s
     0     0 34643.4209    0  460 18868.1061 34643.4209  83.6%     -  398s
     0     0 34633.5942    0  525 18868.1061 34633.5942  83.6%     -  400s
     0     0 34629.6402    0  456 18868.1061 34629.6402  83.5%     -  402s
     0     0 34626.3948    0  457 18868.1061 34626.3948  83.5%     -  404s
     0     0 34621.4013    0  457 18868.1061 34621.4013  83.5%     -  405s
     0     0 34620.6158    0  458 18868.1061 34620.6158  83.5%     -  406s
     0     0 33651.8870    0  426 18868.1061 33651.8870  78.4%     -  445s
H    0     0                    18912.561276 33651.8279  77.9%     -  446s
H    0     0                    18933.993108 33651.8279  77.7%     -  446s
H    0     0                    18959.625929 33651.8279  77.5%     -  446s
H    0     0                    18974.072635 33651.8279  77.4%     -  446s
     0     0 33391.5158    0  525 18974.0726 33391.5158  76.0%     -  468s
     0     0 33205.3403    0  494 18974.0726 33205.3403  75.0%     -  479s
     0     0 33096.4068    0  498 18974.0726 33096.4068  74.4%     -  490s
     0     0 33054.8061    0  511 18974.0726 33054.8061  74.2%     -  498s
     0     0 33040.9660    0  512 18974.0726 33040.9660  74.1%     -  502s
     0     0 33032.9826    0  513 18974.0726 33032.9826  74.1%     -  505s
     0     0 33008.2398    0  502 18974.0726 33008.2398  74.0%     -  513s
     0     0 32985.7729    0  496 18974.0726 32985.7729  73.8%     -  517s
     0     0 32978.2920    0  494 18974.0726 32978.2920  73.8%     -  520s
     0     0 32964.5317    0  493 18974.0726 32964.5317  73.7%     -  525s
     0     0 32955.3660    0  505 18974.0726 32955.3660  73.7%     -  530s
     0     0 32948.2151    0  509 18974.0726 32948.2151  73.6%     -  533s
     0     0 32944.1242    0  507 18974.0726 32944.1242  73.6%     -  537s
     0     0 32942.4577    0  507 18974.0726 32942.4577  73.6%     -  538s
     0     0 32646.2953    0  509 18974.0726 32646.2953  72.1%     -  555s
H    0     0                    18983.364150 32645.8504  72.0%     -  556s
H    0     0                    19068.055596 32645.8504  71.2%     -  556s
H    0     0                    19138.683051 32645.8504  70.6%     -  556s
H    0     0                    19211.549428 32645.8504  69.9%     -  556s
     0     0 32555.6748    0  519 19211.5494 32555.6748  69.5%     -  567s
     0     0 32524.4872    0  590 19211.5494 32524.4872  69.3%     -  573s
     0     0 32500.0047    0  555 19211.5494 32500.0047  69.2%     -  577s
     0     0 32471.0731    0  534 19211.5494 32471.0731  69.0%     -  582s
     0     0 32468.1565    0  527 19211.5494 32468.1565  69.0%     -  584s
     0     0 32466.3051    0  530 19211.5494 32466.3051  69.0%     -  586s
     0     0 32265.8205    0  511 19211.5494 32265.8205  68.0%     -  601s
     0     0 32237.5643    0  549 19211.5494 32237.5643  67.8%     -  608s
     0     0 32224.5843    0  488 19211.5494 32224.5843  67.7%     -  612s
     0     0 32215.6280    0  477 19211.5494 32215.6280  67.7%     -  614s
     0     0 32213.9899    0  492 19211.5494 32213.9899  67.7%     -  615s
     0     0 32143.5916    0  568 19211.5494 32143.5916  67.3%     -  624s
     0     0 32124.0372    0  574 19211.5494 32124.0372  67.2%     -  630s
     0     0 32038.5243    0  569 19211.5494 32038.5243  66.8%     -  640s
     0     0 32022.6944    0  490 19211.5494 32022.6944  66.7%     -  643s
     0     0 32016.6834    0  446 19211.5494 32016.6834  66.7%     -  645s
     0     0 32013.0552    0  501 19211.5494 32013.0552  66.6%     -  648s
     0     0 32007.7117    0  451 19211.5494 32007.7117  66.6%     -  649s
     0     0 32006.7390    0  452 19211.5494 32006.7390  66.6%     -  650s
     0     0 31952.8108    0  451 19211.5494 31952.8108  66.3%     -  657s
     0     0 31907.4132    0  446 19211.5494 31907.4132  66.1%     -  665s
     0     0 31897.3388    0  455 19211.5494 31897.3388  66.0%     -  668s
     0     0 31894.1244    0  457 19211.5494 31894.1244  66.0%     -  670s
     0     0 31885.9340    0  456 19211.5494 31885.9340  66.0%     -  671s
     0     0 31883.0420    0  462 19211.5494 31883.0420  66.0%     -  673s
     0     0 31880.3154    0  525 19211.5494 31880.3154  65.9%     -  675s
     0     0 31879.9854    0  524 19211.5494 31879.9854  65.9%     -  676s
     0     0 31856.7600    0  462 19211.5494 31856.7600  65.8%     -  683s
     0     0 31846.7108    0  469 19211.5494 31846.7108  65.8%     -  687s
     0     0 31842.3177    0  512 19211.5494 31842.3177  65.7%     -  689s
     0     0 31840.7181    0  469 19211.5494 31840.7181  65.7%     -  691s
     0     0 31817.2727    0  471 19211.5494 31817.2727  65.6%     -  696s
H    0     0                    19300.466965 31816.9900  64.9%     -  699s
     0     0 31804.1768    0  472 19300.4670 31804.1768  64.8%     -  703s
     0     0 31799.4358    0  478 19300.4670 31799.4358  64.8%     -  705s
     0     0 31797.1164    0  466 19300.4670 31797.1164  64.7%     -  707s
     0     0 31787.7817    0  473 19300.4670 31787.7817  64.7%     -  712s
H    0     0                    19340.737284 31787.2044  64.4%     -  712s
H    0     0                    19403.179343 31787.2044  63.8%     -  712s
H    0     0                    19415.505921 31787.2044  63.7%     -  712s
     0     0 31782.8910    0  465 19415.5059 31782.8910  63.7%     -  714s
     0     0 31781.9164    0  470 19415.5059 31781.9164  63.7%     -  715s
     0     0 31776.1613    0  470 19415.5059 31776.1613  63.7%     -  718s
     0     0 31772.3554    0  481 19415.5059 31772.3554  63.6%     -  725s
     0     0 31771.1576    0  476 19415.5059 31771.1576  63.6%     -  726s
     0     0 31762.3168    0  474 19415.5059 31762.3168  63.6%     -  729s
     0     0 31761.2769    0  486 19415.5059 31761.2769  63.6%     -  731s
     0     0 31757.6845    0  478 19415.5059 31757.6845  63.6%     -  733s
     0     0 31757.3700    0  478 19415.5059 31757.3700  63.6%     -  739s
H    0     0                    19421.685144 31757.3700  63.5%     -  937s
H    0     0                    19478.410330 31757.3700  63.0%     -  954s
H    0     0                    19495.770935 31757.3700  62.9%     - 1050s
     0     2 31757.3700    0  478 19495.7709 31757.3700  62.9%     - 1053s
     1     3 30373.9055    1  356 19495.7709 31757.0929  62.9% 18940 1075s
     2     5 29940.9032    2  417 19495.7709 31757.0929  62.9% 12456 1085s
     4     8 29782.8880    3  360 19495.7709 31467.9169  61.4% 11480 1105s
     7    13 29119.0695    4  469 19495.7709 31467.9169  61.4% 12076 1124s
    12    26 29900.0344    3  565 19495.7709 31244.9618  60.3% 14892 1144s
    25    39 30118.7340    4  535 19495.7709 30797.8875  58.0% 18662 1203s
    38    69 29135.7516    5  393 19495.7709 30797.8875  58.0% 24350 1411s
    68   147 28936.3429    6  361 19495.7709 30535.2909  56.6% 27694 1469s
   146   252 28604.2011    9  419 19495.7709 30369.2370  55.8% 19085 1506s
   251   283 28303.3412   12  425 19495.7709 30369.2370  55.8% 13990 1528s
H  252   283                    19509.126303 30369.2370  55.7% 13935 1528s
H  268   283                    19511.133346 30369.2370  55.7% 13593 1528s
H  269   283                    19520.216243 30369.2370  55.6% 13551 1528s
H  276   283                    19539.101434 30369.2370  55.4% 13417 1528s
   282   342 28121.6013   13  365 19539.1014 30369.2370  55.4% 13278 1555s
   341   397 27904.7817   15  391 19539.1014 30369.2370  55.4% 11877 1581s
   398   454 27808.9157   18  401 19539.1014 30369.2370  55.4% 11392 1605s
   459   500 27639.2412   19  404 19539.1014 30369.2370  55.4% 10733 1628s
   513   542 27099.9433   20  331 19539.1014 30369.2370  55.4% 10592 1649s
   569   607 25318.3711   26  283 19539.1014 29894.1945  53.0% 10521 1672s
   644   662 26584.3485   21  338 19539.1014 29894.1945  53.0% 10220 1693s
   715   702 26513.9614   22  333 19539.1014 29894.1945  53.0% 10004 1713s
   769   741 26157.7172   23  287 19539.1014 29894.1945  53.0% 10077 1730s
   816   771 26130.9169   24  276 19539.1014 29894.1945  53.0% 10071 1748s
   856   825 23781.6678   35  221 19539.1014 29894.1945  53.0% 10076 1769s
   922   883 25875.3357   26  272 19539.1014 29894.1945  53.0% 10043 1787s
   996   919 25691.4314   28  263 19539.1014 29894.1945  53.0%  9883 1807s
  1034   950 24579.3086   29  250 19539.1014 29894.1945  53.0%  9831 1826s
  1065   984 24467.2463   30  254 19539.1014 29894.1945  53.0%  9845 1844s
  1113  1008 23537.2801   31  243 19539.1014 29894.1945  53.0%  9761 1861s
H 1150  1008                    19552.759702 29658.8574  51.7%  9733 1861s
  1165  1029 23172.5401   32  244 19552.7597 29658.8574  51.7%  9710 1909s
  1206  1051 23015.3113   33  360 19552.7597 29602.1976  51.4%  9656 1970s
  1243  1079 22832.5178   34  371 19552.7597 29602.1976  51.4%  9633 2017s
H 1273  1079                    19693.717481 29602.1976  50.3%  9620 2017s
  1286  1154 22646.4565   35  301 19693.7175 29602.1976  50.3%  9628 2045s
  1406  1224 22478.8798   38  311 19693.7175 29589.7473  50.2%  9478 2071s
  1519  1311 22289.7659   40  372 19693.7175 29589.7473  50.2%  9397 2102s
  1665  1345 infeasible   42      19693.7175 29589.7473  50.2%  9130 2133s
  1799  1412 25563.5264   21  503 19693.7175 29501.1503  49.8%  8924 2164s
  1892  1503 24121.3813   22  229 19693.7175 29501.1503  49.8%  9049 2196s
  2009  1646 23643.1748   24  233 19693.7175 29501.1503  49.8%  9090 2230s
  2167  1671 22883.1927   27  228 19693.7175 29335.7980  49.0%  8958 2258s
  2204  1750 infeasible   28      19693.7175 29271.5297  48.6%  8959 2286s
  2307  1828 22721.8478   29  319 19693.7175 29271.5297  48.6%  8843 2315s
  2459  1908 22481.9924   32  327 19693.7175 29271.5297  48.6%  8623 2349s
  2595  1991 22062.7736   36  314 19693.7175 29271.5297  48.6%  8611 2387s
  2739  2053 21539.2209   40  248 19693.7175 29136.7997  47.9%  8580 2427s
  2865  2140 infeasible   44      19693.7175 29092.2503  47.7%  8668 2465s
  3012  2192 infeasible   48      19693.7175 29092.2503  47.7%  8759 2511s
  3162  2294 20147.9111   29  499 19693.7175 28995.2338  47.2%  8820 2556s
  3300  2384     cutoff   31      19693.7175 28995.2338  47.2%  8958 2601s
  3466  2445     cutoff   32      19693.7175 28995.2338  47.2%  9016 2653s
  3633  2533 26637.8162   10  361 19693.7175 28995.2338  47.2%  9107 2705s
  3811  2640 23221.1195   14  295 19693.7175 28995.2338  47.2%  9167 2755s
  4015  2728 22785.4653   15  288 19693.7175 28898.5245  46.7%  9195 2811s
  4169  2811 22518.9148   16  289 19693.7175 28849.6991  46.5%  9315 2867s
  4365  2929 21643.4399   19  248 19693.7175 28849.6991  46.5%  9351 2928s
  4614  2930 25287.5225   16  478 19693.7175 28849.6991  46.5%  9289 3244s
  4616  2931 27645.4513    9  151 19693.7175 28849.6991  46.5%  9285 3264s
  4617  2932 28419.8035   11  331 19693.7175 28849.6991  46.5%  9283 3349s
  4618  2933 22519.9201   19  460 19693.7175 28849.6991  46.5%  9280 3416s
  4619  2933 24098.0816   25  406 19693.7175 28849.6991  46.5%  9278 3465s
  4620  2934 24675.3212   18  523 19693.7175 28849.6991  46.5%  9276 3509s
  4621  2935 22049.4871   21  429 19693.7175 28849.6991  46.5%  9274 3542s
  4622  2935 26189.0584   25  491 19693.7175 28849.6991  46.5%  9272 3561s
  4623  2936 22621.3399   20  541 19693.7175 28849.6991  46.5%  9270 3581s
  4624  2937 21693.2105   43  492 19693.7175 28849.6991  46.5%  9268 3592s

Cutting planes:
  Learned: 2
  Gomory: 3
  Implied bound: 5
  Projected implied bound: 192
  MIR: 757
  Mixing: 2
  Flow cover: 1099
  RLT: 22
  Relax-and-lift: 151

Explored 4624 nodes (43876903 simplex iterations) in 3600.04 seconds (9348.42 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 19693.7 19552.8 19539.1 ... 19415.5

Time limit reached
Best objective 1.969371748090e+04, best bound 2.884969911179e+04, gap 46.4919%
  WARNING: Time limit reached. Using best solution found (gap: 46.49%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.14s
  Master Objective (UB) = 19693.72, θ = 142446.55
  Upper Bound (UB) = 19693.72

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 142446.55
  [DEBUG]   ✓ Scenario 0: θ = 142446.55 ≤ Q = 142446.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 142446.55 ≤ Q = 142446.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 142446.55 ≤ Q = 142581.82 (slack: 135.26)
  [DEBUG]   ✓ Scenario 3: θ = 142446.55 ≤ Q = 142446.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 142446.55 ≤ Q = 142446.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 142446.55 ≤ Q = 142446.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 142446.55 ≤ Q = 142446.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 142446.55 ≤ Q = 142446.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 142446.55 ≤ Q = 142446.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 142446.55 ≤ Q = 142446.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 142446.55 ≤ Q = 143150.71 (slack: 704.15)
  [DEBUG]   ✓ Scenario 11: θ = 142446.55 ≤ Q = 142446.55 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 142446.55 ≤ Q = 142446.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 142446.55 ≤ Q = 142446.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 142446.55 ≤ Q = 142446.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 142446.55 ≤ Q = 142446.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 142446.55 ≤ Q = 142446.55 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 17] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x2a85c499
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xd57a3b67
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.467376e+13
Presolve removed 2571 rows and 1864 columns
Presolve time: 0.01s
Presolved: 522 rows, 525 columns, 1472 nonzeros
Found heuristic solution: objective 7805514.8395
Variable types: 355 continuous, 170 integer (170 binary)

Root relaxation: objective -1.352218e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -135221.83    0  124 7805514.84 -135221.83   102%     -    0s
H    0     0                    -100317.3507 -135221.83  34.8%     -    0s
H    0     0                    -100845.3235 -135221.83  34.1%     -    0s
     0     0 -108863.02    0   74 -100845.32 -108863.02  7.95%     -    0s
H    0     0                    -105909.9936 -108743.41  2.68%     -    0s
H    0     0                    -106203.4657 -108743.41  2.39%     -    0s
H    0     0                    -106393.2380 -108743.41  2.21%     -    0s
H    0     0                    -106686.7101 -108743.41  1.93%     -    0s
     0     0 -108080.33    0   74 -106686.71 -108080.33  1.31%     -    0s
H    0     0                    -106878.4603 -107992.69  1.04%     -    0s
H    0     0                    -106925.7599 -107992.69  1.00%     -    0s
     0     0 -107641.09    0   80 -106925.76 -107641.09  0.67%     -    0s
     0     0 -107620.95    0   79 -106925.76 -107620.95  0.65%     -    0s
     0     0 -107328.11    0   45 -106925.76 -107328.11  0.38%     -    0s
     0     0 -107270.54    0   51 -106925.76 -107270.54  0.32%     -    0s
     0     0 -107260.40    0   50 -106925.76 -107260.40  0.31%     -    0s
     0     0 -107258.71    0   49 -106925.76 -107258.71  0.31%     -    0s
     0     0 -107168.14    0   41 -106925.76 -107168.14  0.23%     -    0s
     0     0 -107142.23    0   41 -106925.76 -107142.23  0.20%     -    0s
     0     0 -107142.23    0   72 -106925.76 -107142.23  0.20%     -    0s
     0     0 -107142.23    0   36 -106925.76 -107142.23  0.20%     -    0s
H    0     0                    -106967.8089 -107142.23  0.16%     -    0s
H    0     0                    -106975.4953 -107109.83  0.13%     -    0s
     0     0 -107092.07    0   32 -106975.50 -107092.07  0.11%     -    0s
     0     0 -107074.13    0   25 -106975.50 -107074.13  0.09%     -    0s
     0     0 -107015.64    0   14 -106975.50 -107015.64  0.04%     -    0s
     0     0          -    0      -106975.50 -106983.75  0.01%     -    0s

Cutting planes:
  Gomory: 10
  Implied bound: 13
  MIR: 61
  Flow cover: 9
  RLT: 3

Explored 1 nodes (979 simplex iterations) in 0.07 seconds (0.07 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -106975 -106968 -106926 ... 7.80551e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.069754952660e+05, best bound -1.069837503557e+05, gap 0.0077%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 139369.32
  Scenario: 28 demand increases, 32 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -106975.50
  [DEBUG]   S×d_nominal = 246344.82
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 246344.82 + -106975.50 = 139369.32
  [DEBUG]   Current θ from Master = 142446.55
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3077.23 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 16616.49
  Lower Bound (LB) = 19157.49
  Gap (UB-LB) = 536.2251, Absolute Gap = 536.2251, Relative Gap = 0.027228
  Not converged yet (gap = 536.23 > ε = 200)

  [DEBUG] Adding NEW scenario 17 to Master Problem...
  [DEBUG] New scenario pattern: 28 increases, 32 decreases
    [DEBUG] Scenario 17 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 17 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 17]
    [DEBUG]   - Total constraints in model: 276603
    [DEBUG]   - Total variables in model: 114580
  [DEBUG] Total scenarios in Master: 18
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 18
================================================================================
[Iteration 18] Solving Master Problem...
  Current scenarios in Master: 18
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 276603 rows, 114580 columns and 783947 nonzeros
Model fingerprint: 0x8ad30289
Variable types: 112321 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 118350 rows and 48060 columns
Presolve time: 2.73s
Presolved: 158253 rows, 66520 columns, 974108 nonzeros
Variable types: 64261 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -368050.8111
Found heuristic solution: objective -194531.7474

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.44s

Barrier statistics:
 Dense cols : 731
 AA' NZ     : 7.447e+06
 Factor NZ  : 1.728e+07 (roughly 230 MB of memory)
 Factor Ops : 4.544e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.68214964e+07  2.51142310e+08  9.60e+04 1.91e+01  6.81e+04     5s
   1  -1.29317532e+07  2.13824557e+08  6.82e+04 5.50e+01  4.79e+04     5s
   2  -5.00570430e+06  1.66422265e+08  2.56e+04 7.07e-01  1.88e+04     5s
   3  -1.06184231e+06  1.19034065e+08  3.05e+03 1.22e+00  2.53e+03     5s
   4  -5.49135850e+05  7.96512969e+07  4.95e+02 4.80e-01  6.00e+02     5s
   5  -4.98381499e+05  4.38796808e+07  3.25e+02 2.09e-01  3.42e+02     5s
   6  -3.95090575e+05  3.38744464e+07  1.08e+02 1.56e-01  1.78e+02     5s
   7  -3.32867999e+05  2.32664593e+07  4.56e+01 9.92e-02  1.03e+02     5s
   8  -2.19471768e+05  2.01750009e+07  1.65e+01 8.42e-02  7.79e+01     5s
   9  -1.27958027e+05  1.27401128e+07  5.41e+00 5.10e-02  4.63e+01     5s
  10  -1.04900909e+05  6.36853590e+06  3.53e+00 2.49e-02  2.31e+01     5s
  11  -8.55003449e+04  2.68163388e+06  1.86e+00 1.06e-02  9.75e+00     5s
  12  -7.12967582e+04  1.48169779e+06  1.29e+00 5.77e-03  5.45e+00     6s
  13  -4.31648066e+04  5.47084673e+05  6.42e-01 1.99e-03  2.06e+00     6s
  14  -1.49238572e+04  2.80681695e+05  3.05e-01 1.02e-03  1.03e+00     6s
  15  -4.79745680e+03  2.16151644e+05  2.29e-01 8.68e-04  7.69e-01     6s
  16   4.07147872e+03  1.46515869e+05  1.84e-01 1.44e-03  4.96e-01     6s
  17   1.02334783e+04  1.30575026e+05  1.54e-01 1.25e-03  4.19e-01     6s
  18   1.80153960e+04  1.17752153e+05  1.18e-01 1.35e-03  3.47e-01     6s
  19   2.35246134e+04  9.37525535e+04  9.25e-02 1.95e-03  2.44e-01     6s
  20   2.75180961e+04  8.07492887e+04  7.50e-02 1.97e-03  1.85e-01     6s
  21   2.96935895e+04  7.49438839e+04  6.59e-02 1.18e-03  1.58e-01     6s
  22   3.25145172e+04  6.79047526e+04  5.49e-02 1.47e-03  1.23e-01     6s
  23   3.50422931e+04  6.37984031e+04  4.55e-02 1.85e-03  1.00e-01     6s
  24   3.71415724e+04  6.07188285e+04  3.78e-02 1.43e-03  8.21e-02     6s
  25   3.87174008e+04  5.77818760e+04  3.23e-02 1.86e-03  6.64e-02     6s
  26   4.00367118e+04  5.51254383e+04  2.78e-02 1.40e-03  5.26e-02     7s
  27   4.20712228e+04  5.35990478e+04  2.11e-02 1.05e-03  4.02e-02     7s
  28   4.32234685e+04  5.22343458e+04  1.74e-02 7.33e-04  3.14e-02     7s
  29   4.46702064e+04  5.14318858e+04  1.30e-02 5.42e-04  2.36e-02     7s
  30   4.55380957e+04  5.05352413e+04  1.03e-02 4.25e-04  1.74e-02     7s
  31   4.65169115e+04  5.01185949e+04  7.43e-03 3.53e-04  1.26e-02     7s
  32   4.76562467e+04  4.98957062e+04  4.10e-03 2.67e-04  7.80e-03     7s
  33   4.82689128e+04  4.96554785e+04  2.26e-03 1.86e-04  4.83e-03     7s
  34   4.84298139e+04  4.94637852e+04  1.78e-03 1.22e-04  3.60e-03     7s
  35   4.85588663e+04  4.93966083e+04  1.41e-03 1.00e-04  2.92e-03     7s
  36   4.86548478e+04  4.92750007e+04  1.14e-03 6.13e-05  2.16e-03     7s
  37   4.88147453e+04  4.92072723e+04  6.98e-04 3.85e-05  1.37e-03     7s
  38   4.89350972e+04  4.91505176e+04  3.81e-04 4.55e-05  7.50e-04     7s
  39   4.89937771e+04  4.91204162e+04  2.28e-04 2.87e-05  4.41e-04     8s
  40   4.90104110e+04  4.91154646e+04  1.85e-04 2.45e-05  3.66e-04     8s
  41   4.90398650e+04  4.90974990e+04  1.07e-04 9.01e-06  2.01e-04     8s
  42   4.90611045e+04  4.90964677e+04  5.65e-05 8.20e-06  1.23e-04     8s
  43   4.90814836e+04  4.90872546e+04  8.72e-06 5.53e-06  2.01e-05     8s
  44   4.90857637e+04  4.90857857e+04  1.42e-08 1.52e-06  7.63e-08     8s
  45   4.90857649e+04  4.90857851e+04  3.45e-07 1.41e-06  6.99e-08     8s
  46   4.90857776e+04  4.90857776e+04  5.31e-10 1.98e-10  1.20e-10     8s

Barrier solved model in 46 iterations and 8.13 seconds (14.45 work units)
Optimal objective 4.90857776e+04


Root crossover log...

  141183 DPushes remaining with DInf 0.0000000e+00                 8s
   32825 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                14s

    2679 PPushes remaining with PInf 2.5584177e-05                14s
       0 PPushes remaining with PInf 0.0000000e+00                14s

  Push phase complete: Pinf 0.0000000e+00, Dinf 4.5274536e-10     14s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   65259    4.9085778e+04   0.000000e+00   0.000000e+00     14s
   65259    4.9085778e+04   0.000000e+00   0.000000e+00     14s
Concurrent spin time: 2.38s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 4.908578e+04, 65259 iterations, 12.94 seconds (25.55 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 49085.7776    0  174 -194531.75 49085.7776   125%     -   17s
H    0     0                    -123725.3785 49085.7776   140%     -   18s
H    0     0                    -121524.5863 49085.7776   140%     -   18s
H    0     0                    -120937.5816 49085.7776   141%     -   18s
H    0     0                    -44548.72900 49085.7776   210%     -   18s
H    0     0                    -44513.04802 49085.7776   210%     -   18s
H    0     0                    -10909.42146 49085.7776   550%     -   18s
H    0     0                    7502.3867452 49085.7776   554%     -   18s
H    0     0                    12197.451674 49085.7776   302%     -   19s
H    0     0                    12234.054512 49085.7776   301%     -   19s
H    0     0                    13516.528101 49085.7776   263%     -   19s
H    0     0                    13617.629023 49085.7776   260%     -   19s
H    0     0                    13623.270926 49085.7776   260%     -   19s
H    0     0                    13698.902023 49085.7776   258%     -   19s
H    0     0                    13699.189656 49085.7776   258%     -   19s
H    0     0                    13783.197758 49085.7776   256%     -   19s
H    0     0                    13808.949243 49085.7776   255%     -   19s
     0     0 42560.3828    0  305 13808.9492 42560.3828   208%     -   75s
H    0     0                    13995.204154 42560.1367   204%     -   76s
     0     0 42094.3786    0  297 13995.2042 42094.3786   201%     -   90s
     0     0 42075.6991    0  295 13995.2042 42075.6991   201%     -   93s
     0     0 42059.2292    0  285 13995.2042 42059.2292   201%     -   97s
     0     0 42050.3443    0  306 13995.2042 42050.3443   200%     -  101s
     0     0 42049.4302    0  303 13995.2042 42049.4302   200%     -  102s
     0     0 42049.3920    0  303 13995.2042 42049.3920   200%     -  102s
     0     0 38487.2152    0  348 13995.2042 38487.2152   175%     -  151s
     0     0 38487.2152    0  348 13995.2042 38487.2152   175%     -  152s
H    0     0                    18935.048265 38487.1400   103%     -  152s
H    0     0                    18949.846432 38487.1400   103%     -  152s
H    0     0                    19035.614064 38487.1400   102%     -  152s
H    0     0                    19058.703729 38487.1400   102%     -  152s
     0     0 38151.8416    0  401 19058.7037 38151.8416   100%     -  176s
     0     0 37782.3993    0  373 19058.7037 37782.3993  98.2%     -  194s
     0     0 37718.6951    0  395 19058.7037 37718.6951  97.9%     -  201s
     0     0 37713.8953    0  429 19058.7037 37713.8953  97.9%     -  205s
     0     0 37705.0584    0  423 19058.7037 37705.0584  97.8%     -  210s
     0     0 37684.4392    0  389 19058.7037 37684.4392  97.7%     -  215s
     0     0 37673.1323    0  388 19058.7037 37673.1323  97.7%     -  219s
     0     0 37668.3936    0  426 19058.7037 37668.3936  97.6%     -  221s
     0     0 37665.3201    0  418 19058.7037 37665.3201  97.6%     -  223s
     0     0 37661.9482    0  393 19058.7037 37661.9482  97.6%     -  225s
     0     0 37640.2439    0  398 19058.7037 37640.2439  97.5%     -  232s
     0     0 37637.9760    0  441 19058.7037 37637.9760  97.5%     -  233s
     0     0 37623.4282    0  385 19058.7037 37623.4282  97.4%     -  237s
     0     0 37621.7765    0  441 19058.7037 37621.7765  97.4%     -  238s
     0     0 37592.2738    0  399 19058.7037 37592.2738  97.2%     -  241s
     0     0 37582.7453    0  438 19058.7037 37582.7453  97.2%     -  244s
     0     0 37560.3802    0  428 19058.7037 37560.3802  97.1%     -  248s
     0     0 37559.7081    0  432 19058.7037 37559.7081  97.1%     -  249s
     0     0 35420.1826    0  390 19058.7037 35420.1826  85.8%     -  294s
H    0     0                    19073.394932 35419.9742  85.7%     -  295s
     0     0 35026.5834    0  435 19073.3949 35026.5834  83.6%     -  318s
     0     0 34772.6275    0  476 19073.3949 34772.6275  82.3%     -  332s
     0     0 34652.8766    0  454 19073.3949 34652.8766  81.7%     -  343s
     0     0 34587.3194    0  494 19073.3949 34587.3194  81.3%     -  352s
     0     0 34573.9840    0  468 19073.3949 34573.9840  81.3%     -  357s
     0     0 34549.8783    0  467 19073.3949 34549.8783  81.1%     -  362s
     0     0 34545.5846    0  464 19073.3949 34545.5846  81.1%     -  365s
     0     0 34529.0227    0  536 19073.3949 34529.0227  81.0%     -  369s
     0     0 34527.3745    0  539 19073.3949 34527.3745  81.0%     -  372s
     0     0 33408.8144    0  466 19073.3949 33408.8144  75.2%     -  410s
H    0     0                    19080.813683 33408.5650  75.1%     -  411s
H    0     0                    19142.699424 33408.5650  74.5%     -  411s
     0     0 32957.7354    0  530 19142.6994 32957.7354  72.2%     -  434s
     0     0 32660.1503    0  522 19142.6994 32660.1503  70.6%     -  449s
     0     0 32608.1531    0  460 19142.6994 32608.1531  70.3%     -  455s
     0     0 32523.4837    0  525 19142.6994 32523.4837  69.9%     -  465s
     0     0 32502.7397    0  524 19142.6994 32502.7397  69.8%     -  468s
     0     0 32461.9184    0  481 19142.6994 32461.9184  69.6%     -  474s
     0     0 32431.3427    0  523 19142.6994 32431.3427  69.4%     -  481s
     0     0 32373.4113    0  483 19142.6994 32373.4113  69.1%     -  489s
     0     0 32358.4774    0  484 19142.6994 32358.4774  69.0%     -  493s
     0     0 32352.8233    0  482 19142.6994 32352.8233  69.0%     -  498s
     0     0 32348.1437    0  486 19142.6994 32348.1437  69.0%     -  500s
     0     0 32345.2446    0  485 19142.6994 32345.2446  69.0%     -  502s
     0     0 32342.8000    0  487 19142.6994 32342.8000  69.0%     -  504s
     0     0 32341.2437    0  491 19142.6994 32341.2437  68.9%     -  506s
     0     0 32129.8471    0  456 19142.6994 32129.8471  67.8%     -  522s
H    0     0                    19166.070581 32129.5214  67.6%     -  523s
H    0     0                    19191.704129 32129.5214  67.4%     -  523s
H    0     0                    19200.752696 32129.5214  67.3%     -  523s
H    0     0                    19210.228398 32129.5214  67.3%     -  523s
     0     0 32082.6562    0  556 19210.2284 32082.6562  67.0%     -  531s
     0     0 32052.4763    0  523 19210.2284 32052.4763  66.9%     -  538s
     0     0 32046.4818    0  531 19210.2284 32046.4818  66.8%     -  541s
     0     0 32025.2031    0  523 19210.2284 32025.2031  66.7%     -  545s
     0     0 32023.4136    0  519 19210.2284 32023.4136  66.7%     -  547s
     0     0 31902.4919    0  437 19210.2284 31902.4919  66.1%     -  560s
     0     0 31871.5550    0  450 19210.2284 31871.5550  65.9%     -  567s
     0     0 31853.3119    0  465 19210.2284 31853.3119  65.8%     -  571s
     0     0 31849.0515    0  464 19210.2284 31849.0515  65.8%     -  574s
     0     0 31847.4782    0  467 19210.2284 31847.4782  65.8%     -  575s
     0     0 31810.3763    0  466 19210.2284 31810.3763  65.6%     -  584s
     0     0 31797.4863    0  462 19210.2284 31797.4863  65.5%     -  588s
     0     0 31793.2462    0  460 19210.2284 31793.2462  65.5%     -  592s
     0     0 31790.8646    0  464 19210.2284 31790.8646  65.5%     -  594s
     0     0 31789.6289    0  460 19210.2284 31789.6289  65.5%     -  596s
     0     0 31768.9878    0  449 19210.2284 31768.9878  65.4%     -  604s
     0     0 31757.1921    0  455 19210.2284 31757.1921  65.3%     -  608s
     0     0 31749.7893    0  462 19210.2284 31749.7893  65.3%     -  610s
     0     0 31743.5694    0  467 19210.2284 31743.5694  65.2%     -  613s
     0     0 31741.3441    0  472 19210.2284 31741.3441  65.2%     -  615s
     0     0 31718.3340    0  464 19210.2284 31718.3340  65.1%     -  622s
     0     0 31708.7303    0  465 19210.2284 31708.7303  65.1%     -  627s
     0     0 31706.3323    0  470 19210.2284 31706.3323  65.0%     -  628s
     0     0 31691.4231    0  460 19210.2284 31691.4231  65.0%     -  631s
     0     0 31688.7877    0  461 19210.2284 31688.7877  65.0%     -  633s
     0     0 31687.3154    0  459 19210.2284 31687.3154  65.0%     -  634s
     0     0 31669.0626    0  459 19210.2284 31669.0626  64.9%     -  641s
H    0     0                    19320.215085 31668.7814  63.9%     -  642s
H    0     0                    19328.355674 31668.7814  63.8%     -  642s
H    0     0                    19343.405739 31668.7814  63.7%     -  642s
     0     0 31663.5874    0  456 19343.4057 31663.5874  63.7%     -  645s
     0     0 31662.4800    0  463 19343.4057 31662.4800  63.7%     -  646s
     0     0 31653.2002    0  479 19343.4057 31653.2002  63.6%     -  652s
H    0     0                    19347.050719 31652.4534  63.6%     -  652s
     0     0 31649.5561    0  471 19347.0507 31649.5561  63.6%     -  655s
     0     0 31649.0294    0  473 19347.0507 31649.0294  63.6%     -  656s
     0     0 31643.1270    0  469 19347.0507 31643.1270  63.6%     -  662s
     0     0 31639.3971    0  471 19347.0507 31639.3971  63.5%     -  666s
     0     0 31638.1729    0  475 19347.0507 31638.1729  63.5%     -  667s
     0     0 31627.3136    0  459 19347.0507 31627.3136  63.5%     -  673s
     0     0 31626.8028    0  459 19347.0507 31626.8028  63.5%     -  679s
     0     2 31626.8028    0  459 19347.0507 31626.8028  63.5%     -  793s
     1     3 30538.9121    1  431 19347.0507 31626.3540  63.5% 22531  815s
     2     4 31299.1691    1  451 19347.0507 31299.1691  61.8% 22308  834s
     3     5 29193.4921    2  400 19347.0507 31299.0553  61.8% 23098  860s
     4     9 29175.1626    3  386 19347.0507 31299.0553  61.8% 18318  877s
     8    16 31022.3099    3  541 19347.0507 31299.0553  61.8% 11727  903s
    15    32 28965.5474    4  500 19347.0507 31114.2384  60.8% 16193  929s
    16    32 28990.8937    4  558 19347.0507 31114.2384  60.8% 17881  930s
    31    48 30037.5168    5  446 19347.0507 30875.4931  59.6% 18573  988s
    47    71 27826.5011    5  329 19347.0507 30875.4931  59.6% 24964 1031s
H   59    71                    19518.725574 30875.4931  58.2% 23189 1031s
    76   187 29528.6679    7  482 19518.7256 30875.4931  58.2% 19727 1114s
   202   238 29444.0951   10  479 19518.7256 30875.4931  58.2% 11245 1141s
   271   269 25874.1324   10  283 19518.7256 30875.4931  58.2% 10673 1164s
   334   308 29220.9865   12  424 19518.7256 30875.4931  58.2%  9995 1190s
   387   357 29076.7891   13  433 19518.7256 30875.4931  58.2%  9816 1213s
   447   425 28812.8723   14  423 19518.7256 30875.4931  58.2%  9818 1235s
   525   473 28297.3650   15  402 19518.7256 30875.4931  58.2%  9403 1256s
   579   497 28201.7217   16  403 19518.7256 30875.4931  58.2%  8923 1279s
   607   525 28196.1272   17  401 19518.7256 30875.4931  58.2%  8695 1297s
   643   558 28191.1816   18  406 19518.7256 30875.4931  58.2%  8442 1317s
   680   592 27225.9885   19  334 19518.7256 30875.4931  58.2%  8256 1337s
   720   641 27064.3890   20  338 19518.7256 30875.4931  58.2%  8089 1358s
   771   692 27021.8340   21  343 19518.7256 30875.4931  58.2%  7811 1375s
   830   741 26791.8696   22  393 19518.7256 30875.4931  58.2%  7478 1392s
   879   793 26707.9720   23  389 19518.7256 30875.4931  58.2%  7226 1408s
   937   846 26683.9653   24  380 19518.7256 30875.4931  58.2%  6956 1427s
H  958   846                    19526.246979 30875.4931  58.1%  6843 1427s
  1004   936 26309.0674   25  380 19526.2470 30875.4931  58.1%  6621 1448s
  1121  1002 25949.7298   29  386 19526.2470 30875.4931  58.1%  6241 1472s
  1219  1092 25624.5083   31  372 19526.2470 30875.4931  58.1%  6040 1496s
  1345  1197 25328.4210   33  367 19526.2470 30875.4931  58.1%  5755 1519s
  1474  1287 25059.0981   35  374 19526.2470 30875.4931  58.1%  5501 1545s
  1613  1339 24932.3563   38  393 19526.2470 30875.4931  58.1%  5273 1571s
  1713  1385 23767.8750   39  315 19526.2470 30875.4931  58.1%  5184 1602s
  1807  1451 23735.7535   40  364 19526.2470 30875.4931  58.1%  5098 1630s
  1906  1548 23629.5212   44  335 19526.2470 30875.4931  58.1%  5038 1660s
  2034  1587 23144.1268   46  377 19526.2470 30875.4931  58.1%  4888 1689s
  2081  1645 22612.8164   50  425 19526.2470 30875.4931  58.1%  4882 1718s
  2143  1699 22285.4658   53  398 19526.2470 30875.4931  58.1%  4820 1747s
  2230  1747 21084.6282   60  433 19526.2470 30875.4931  58.1%  4755 1781s
  2326  1809 20946.0564   61  327 19526.2470 30875.4931  58.1%  4681 1816s
  2450  1857 20184.2189   68  385 19526.2470 30875.4931  58.1%  4576 1854s
  2573  1900 infeasible   76      19526.2470 30875.4931  58.1%  4516 1892s
  2644  1963 26568.9448   17  437 19526.2470 30875.4931  58.1%  4567 1932s
  2726  2039 24956.8245   18  386 19526.2470 30875.4931  58.1%  4629 1975s
  2822  2098 24550.0767   20  398 19526.2470 30609.3626  56.8%  4658 2020s
  2927  2157 20997.5447   23  315 19526.2470 30609.3626  56.8%  4702 2062s
H 2929  2157                    19526.294626 30609.3626  56.8%  4701 2062s
H 2938  2156                    19551.705561 30609.3626  56.6%  4708 2062s
H 2969  2156                    19566.460632 30609.3626  56.4%  4731 2062s
  3010  2229 infeasible   25      19566.4606 30609.3626  56.4%  4723 2108s
  3113  2299 infeasible   24      19566.4606 30609.3626  56.4%  4795 2154s
  3229  2375 20393.7543   39  219 19566.4606 29417.4996  50.3%  4823 2204s
  3343  2394 28228.1235    7  423 19566.4606 29285.5401  49.7%  4876 2249s
  3378  2423 28056.7046    8  420 19566.4606 29285.5401  49.7%  4903 2290s
H 3400  2422                    19593.663138 29285.5401  49.5%  4923 2290s
  3413  2497 27608.9797    9  416 19593.6631 29285.5401  49.5%  4928 2345s
  3532  2525 26205.6837   13  371 19593.6631 29285.5401  49.5%  4955 2394s
  3586  2609 25704.2913   14  279 19593.6631 29285.5401  49.5%  4978 2452s
  3730  2711 24376.3033   17  292 19593.6631 28965.5288  47.8%  4985 2521s
  3895  2712 27409.6886   10  459 19593.6631 28880.5735  47.4%  5004 2853s
  3897  2713 26236.0984   26  162 19593.6631 28880.5735  47.4%  5001 2874s
  3898  2714 23760.6820   24  316 19593.6631 28880.5735  47.4%  5000 2961s
  3899  2715 27001.9047   14  390 19593.6631 28880.5735  47.4%  4999 3052s
  3900  2715 28783.0651   10  469 19593.6631 28880.5735  47.4%  4997 3128s
  3901  2716 24137.8687   41  445 19593.6631 28880.5735  47.4%  4996 3175s
  3902  2717 26377.2542   16  457 19593.6631 28880.5735  47.4%  4995 3207s
  3903  2717 22278.1687   47  495 19593.6631 28880.5735  47.4%  4994 3243s
  3904  2718 26900.4651   15  427 19593.6631 28880.5735  47.4%  4992 3260s
  3905  2719 23907.3371   12  470 19593.6631 28880.5735  47.4%  4991 3285s
  3906  2719 26641.5973   14  477 19593.6631 28880.5735  47.4%  4990 3296s
  3907  2720 23585.2793   31  500 19593.6631 28880.5735  47.4%  4989 3305s
  3908  2721 22898.2540   28  451 19593.6631 28880.5735  47.4%  4987 3310s
  3909  2721 23270.9792   51  452 19593.6631 28880.5735  47.4%  4986 3315s
  3910  2722 21488.4136   43  460 19593.6631 28880.5735  47.4%  4985 3322s
  3911  2723 22211.0349   52  461 19593.6631 28880.5735  47.4%  4983 3328s
  3912  2723 21285.8628   54  505 19593.6631 28880.5735  47.4%  4982 3335s
  3913  2724 21190.4533   26  477 19593.6631 28880.5735  47.4%  4981 3340s
  3915  2725 20030.9298   74  466 19593.6631 28880.5735  47.4%  4978 3349s
  3916  2726 23138.9418   33  513 19593.6631 28880.5735  47.4%  4977 3366s
  3917  2727 26064.4227   19  396 19593.6631 28880.5735  47.4%  4976 3371s
  3918  2727 25994.0929   21  459 19593.6631 28880.5735  47.4%  4975 3378s
  3919  2728 21885.5878   42  461 19593.6631 28880.5735  47.4%  4973 3391s
  3920  2729 20142.3209   17  518 19593.6631 28880.5735  47.4%  4972 3399s
  3921  2729 23820.8088   20  526 19593.6631 28880.5735  47.4%  4971 3407s
  3922  2730 21546.6247   34  529 19593.6631 28880.5735  47.4%  4969 3424s
  3923  2731 19855.7292  110  462 19593.6631 28880.5735  47.4%  4968 3427s
  3924  2731 27265.0705   10  456 19593.6631 28880.5735  47.4%  4967 3434s
  3925  2732 22286.1051   86  463 19593.6631 28880.5735  47.4%  4966 3445s
  3926  2733 26567.1035   20  458 19593.6631 28880.5735  47.4%  4964 3451s
  3927  2733 27340.9303   17  456 19593.6631 28880.5735  47.4%  4963 3463s
  3928  2734 20795.9097   49  463 19593.6631 28880.5735  47.4%  4962 3470s
  3929  2735 22554.6588   33  464 19593.6631 28880.5735  47.4%  4961 3480s
  3930  2735 22286.1051   86  458 19593.6631 28880.5735  47.4%  4959 3487s
  3931  2736 20431.3962  112  506 19593.6631 28880.5735  47.4%  4958 3499s
  3932  2737 19849.4148   26  506 19593.6631 28880.5735  47.4%  4957 3506s
  3933  2737 24823.2786   13  510 19593.6631 28880.5735  47.4%  4956 3516s
  3934  2738 21589.2563   11  516 19593.6631 28880.5735  47.4%  4954 3521s
  3935  2739 20317.3055   97  514 19593.6631 28880.5735  47.4%  4953 3530s
  3936  2739 23370.9437   31  514 19593.6631 28880.5735  47.4%  4952 3552s

Cutting planes:
  Learned: 3
  Gomory: 2
  Implied bound: 2
  Projected implied bound: 184
  MIR: 822
  Mixing: 2
  Flow cover: 1093
  RLT: 11
  Relax-and-lift: 212

Explored 3936 nodes (20794894 simplex iterations) in 3600.03 seconds (9025.60 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 19593.7 19566.5 19551.7 ... 19320.2

Time limit reached
Best objective 1.959366313846e+04, best bound 2.888057346265e+04, gap 47.3975%
  WARNING: Time limit reached. Using best solution found (gap: 47.40%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.19s
  Master Objective (UB) = 19593.66, θ = 141947.21
  Upper Bound (UB) = 19593.66

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 141947.21
  [DEBUG]   ✓ Scenario 0: θ = 141947.21 ≤ Q = 141947.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 141947.21 ≤ Q = 141947.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 141947.21 ≤ Q = 141947.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 141947.21 ≤ Q = 141947.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 141947.21 ≤ Q = 141947.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 141947.21 ≤ Q = 141947.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 141947.21 ≤ Q = 141947.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 141947.21 ≤ Q = 141947.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 141947.21 ≤ Q = 141947.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 141947.21 ≤ Q = 141947.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 141947.21 ≤ Q = 141947.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 141947.21 ≤ Q = 141947.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 141947.21 ≤ Q = 141947.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 141947.21 ≤ Q = 141947.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 141947.21 ≤ Q = 141947.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 141947.21 ≤ Q = 141947.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 141947.21 ≤ Q = 141947.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 141947.21 ≤ Q = 141947.21 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 18] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x1b54db9c
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x1b54db9c
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.457366e+13
Presolve removed 2571 rows and 1864 columns
Presolve time: 0.00s
Presolved: 522 rows, 525 columns, 1472 nonzeros
Found heuristic solution: objective 7771706.7800
Variable types: 355 continuous, 170 integer (170 binary)

Root relaxation: objective -1.355362e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -135536.18    0  124 7771706.78 -135536.18   102%     -    0s
H    0     0                    -100582.5498 -135536.18  34.8%     -    0s
H    0     0                    -101135.4569 -135536.18  34.0%     -    0s
     0     0 -108823.35    0   82 -101135.46 -108823.35  7.60%     -    0s
H    0     0                    -104952.6113 -108820.66  3.69%     -    0s
H    0     0                    -105262.7334 -108820.66  3.38%     -    0s
H    0     0                    -105632.6226 -108820.66  3.02%     -    0s
H    0     0                    -105942.7447 -108820.66  2.72%     -    0s
     0     0 -108330.49    0   83 -105942.74 -108330.49  2.25%     -    0s
     0     0 -107725.04    0   85 -105942.74 -107725.04  1.68%     -    0s
H    0     0                    -106052.8514 -107682.84  1.54%     -    0s
     0     0 -107682.84    0   85 -106052.85 -107682.84  1.54%     -    0s
     0     0 -107391.92    0   84 -106052.85 -107391.92  1.26%     -    0s
     0     0 -107371.80    0   70 -106052.85 -107371.80  1.24%     -    0s
     0     0 -107266.69    0   67 -106052.85 -107266.69  1.14%     -    0s
H    0     0                    -106514.6358 -107263.50  0.70%     -    0s
H    0     0                    -107044.5683 -107263.50  0.20%     -    0s
     0     0 -107259.49    0   67 -107044.57 -107259.49  0.20%     -    0s
     0     0 -107210.33    0   58 -107044.57 -107210.33  0.15%     -    0s
     0     0 -107194.10    0   56 -107044.57 -107194.10  0.14%     -    0s
     0     0 -107127.90    0   10 -107044.57 -107127.90  0.08%     -    0s
     0     0 -107119.10    0    9 -107044.57 -107119.10  0.07%     -    0s
     0     0 -107116.47    0    5 -107044.57 -107116.47  0.07%     -    0s

Explored 1 nodes (662 simplex iterations) in 0.06 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -107106 -107045 -106515 ... 1.45737e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.071058890508e+05, best bound -1.071164690164e+05, gap 0.0099%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 138904.70
  Scenario: 5 demand increases, 55 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -107105.89
  [DEBUG]   S×d_nominal = 246010.59
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 246010.59 + -107105.89 = 138904.70
  [DEBUG]   Current θ from Master = 141947.21
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3042.51 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 16551.16
  Lower Bound (LB) = 19157.49
  Gap (UB-LB) = 436.1708, Absolute Gap = 436.1708, Relative Gap = 0.022261
  Not converged yet (gap = 436.17 > ε = 200)

  [DEBUG] Adding NEW scenario 18 to Master Problem...
  [DEBUG] New scenario pattern: 5 increases, 55 decreases
    [DEBUG] Scenario 18 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 18 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 18]
    [DEBUG]   - Total constraints in model: 291893
    [DEBUG]   - Total variables in model: 120820
  [DEBUG] Total scenarios in Master: 19
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 19
================================================================================
[Iteration 19] Solving Master Problem...
  Current scenarios in Master: 19
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 291893 rows, 120820 columns and 827193 nonzeros
Model fingerprint: 0x61eb973a
Variable types: 118561 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 124915 rows and 50725 columns
Presolve time: 3.11s
Presolved: 166978 rows, 70095 columns, 1027725 nonzeros
Variable types: 67836 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -368050.8111
Found heuristic solution: objective -194531.7474

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.49s

Barrier statistics:
 Dense cols : 731
 AA' NZ     : 8.203e+06
 Factor NZ  : 1.896e+07 (roughly 250 MB of memory)
 Factor Ops : 5.104e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.72063607e+07  2.62592285e+08  9.82e+04 1.81e+01  6.93e+04     5s
   1  -1.32488726e+07  2.24004603e+08  6.98e+04 5.56e+01  4.88e+04     5s
   2  -5.19627987e+06  1.74900461e+08  2.66e+04 7.93e-01  1.94e+04     5s
   3  -1.08281536e+06  1.25784865e+08  3.13e+03 1.38e+00  2.57e+03     6s
   4  -5.54076560e+05  8.92105484e+07  5.01e+02 5.26e-01  6.22e+02     6s
   5  -5.03017014e+05  4.77977739e+07  3.26e+02 2.25e-01  3.46e+02     6s
   6  -4.03963215e+05  3.67803535e+07  1.09e+02 1.60e-01  1.82e+02     6s
   7  -3.34003089e+05  2.49316568e+07  4.70e+01 1.01e-01  1.05e+02     6s
   8  -2.07742280e+05  1.73626826e+07  1.12e+01 6.67e-02  6.21e+01     6s
   9  -1.28755083e+05  1.23026230e+07  3.67e+00 4.62e-02  4.19e+01     6s
  10  -1.04494873e+05  4.71042265e+06  2.45e+00 1.70e-02  1.61e+01     6s
  11  -8.74821680e+04  2.44767719e+06  1.55e+00 8.82e-03  8.45e+00     6s
  12  -6.95464312e+04  1.58809473e+06  9.88e-01 5.59e-03  5.50e+00     6s
  13  -4.24424155e+04  4.91895982e+05  4.11e-01 1.47e-03  1.77e+00     6s
  14  -1.36627154e+04  2.59572858e+05  1.89e-01 8.42e-04  9.01e-01     6s
  15  -4.89944779e+03  2.13016004e+05  1.47e-01 7.06e-04  7.18e-01     6s
  16   6.09593178e+03  1.47262606e+05  1.11e-01 1.82e-03  4.65e-01     6s
  17   1.22109552e+04  1.27833558e+05  9.37e-02 1.58e-03  3.81e-01     7s
  18   1.78311096e+04  1.04891081e+05  7.72e-02 1.90e-03  2.87e-01     7s
  19   2.37766761e+04  8.93550226e+04  6.00e-02 1.58e-03  2.16e-01     7s
  20   2.80836365e+04  7.62034138e+04  4.76e-02 2.16e-03  1.59e-01     7s
  21   2.93983295e+04  7.14703622e+04  4.41e-02 1.55e-03  1.39e-01     7s
  22   3.28818729e+04  6.61849124e+04  3.49e-02 1.18e-03  1.10e-01     7s
  23   3.52681997e+04  6.40310692e+04  2.90e-02 1.14e-03  9.48e-02     7s
  24   3.71475726e+04  6.12040566e+04  2.44e-02 9.41e-04  7.93e-02     7s
  25   3.95663867e+04  5.92677783e+04  1.87e-02 9.66e-04  6.49e-02     7s
  26   4.11831852e+04  5.61941518e+04  1.50e-02 6.87e-04  4.95e-02     7s
  27   4.21062099e+04  5.49187969e+04  1.31e-02 6.32e-04  4.22e-02     7s
  28   4.40058742e+04  5.31394955e+04  9.18e-03 4.43e-04  3.01e-02     8s
  29   4.46946314e+04  5.17475865e+04  7.84e-03 2.88e-04  2.33e-02     8s
  30   4.57421743e+04  5.09623542e+04  5.86e-03 1.99e-04  1.72e-02     8s
  31   4.67255893e+04  5.02859190e+04  4.06e-03 1.31e-04  1.17e-02     8s
  32   4.74458129e+04  5.00052076e+04  2.81e-03 9.57e-05  8.44e-03     8s
  33   4.83215564e+04  4.97042251e+04  1.25e-03 1.02e-04  4.56e-03     8s
  34   4.84348544e+04  4.95307637e+04  1.06e-03 7.27e-05  3.61e-03     8s
  35   4.84438964e+04  4.95117399e+04  1.05e-03 6.96e-05  3.52e-03     8s
  36   4.86683654e+04  4.93943854e+04  6.59e-04 5.00e-05  2.39e-03     8s
  37   4.86889449e+04  4.93462069e+04  6.26e-04 4.24e-05  2.17e-03     8s
  38   4.87370579e+04  4.93303459e+04  5.50e-04 4.06e-05  1.96e-03     8s
  39   4.89080186e+04  4.92363182e+04  2.68e-04 5.67e-05  1.08e-03     9s
  40   4.90148293e+04  4.91423097e+04  1.02e-04 2.07e-05  4.20e-04     9s
  41   4.90187924e+04  4.91335433e+04  9.60e-05 1.74e-05  3.78e-04     9s
  42   4.90205325e+04  4.91293092e+04  9.34e-05 1.59e-05  3.58e-04     9s
  43   4.90300816e+04  4.91106788e+04  7.97e-05 8.95e-06  2.66e-04     9s
  44   4.90603147e+04  4.91030729e+04  3.48e-05 6.13e-06  1.41e-04     9s
  45   4.90836696e+04  4.90884993e+04  1.84e-06 4.05e-06  1.59e-05     9s
  46   4.90856876e+04  4.90858299e+04  5.44e-08 3.09e-07  4.69e-07     9s
  47   4.90857776e+04  4.90857776e+04  2.09e-10 7.99e-10  5.40e-11     9s

Barrier solved model in 47 iterations and 9.33 seconds (16.08 work units)
Optimal objective 4.90857776e+04


Root crossover log...

  148875 DPushes remaining with DInf 0.0000000e+00                 9s
   73638 DPushes remaining with DInf 0.0000000e+00                10s
    1717 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                16s

    2432 PPushes remaining with PInf 1.1182768e-05                16s
       0 PPushes remaining with PInf 0.0000000e+00                16s

  Push phase complete: Pinf 0.0000000e+00, Dinf 4.4349659e-10     16s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   68017    4.9085778e+04   0.000000e+00   0.000000e+00     16s
   68017    4.9085778e+04   0.000000e+00   0.000000e+00     16s
Concurrent spin time: 2.82s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 4.908578e+04, 68017 iterations, 15.10 seconds (29.53 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 49085.7776    0  174 -194531.75 49085.7776   125%     -   19s
H    0     0                    -115599.9924 49085.7776   142%     -   20s
H    0     0                    -78837.75114 49085.7776   162%     -   20s
H    0     0                    -78718.47477 49085.7776   162%     -   20s
H    0     0                    -44548.72900 49085.7776   210%     -   20s
H    0     0                    6078.5822770 49085.7776   708%     -   20s
H    0     0                    13460.893022 49085.7776   265%     -   21s
H    0     0                    13468.545270 49085.7776   264%     -   21s
H    0     0                    13567.268113 49085.7776   262%     -   21s
H    0     0                    13783.197758 49085.7776   256%     -   21s
H    0     0                    13792.588044 49085.7776   256%     -   21s
H    0     0                    13797.176023 49085.7776   256%     -   21s
H    0     0                    13808.949243 49085.7776   255%     -   21s
     0     0 42852.0074    0  228 13808.9492 42852.0074   210%     -   83s
     0     0 42794.7503    0  295 13808.9492 42794.7503   210%     -   97s
     0     0 42792.1274    0  295 13808.9492 42792.1274   210%     -  100s
     0     0 42692.6028    0  283 13808.9492 42692.6028   209%     -  115s
     0     0 42685.0978    0  285 13808.9492 42685.0978   209%     -  120s
     0     0 42685.0431    0  285 13808.9492 42685.0431   209%     -  120s
     0     0 39378.2733    0  391 13808.9492 39378.2733   185%     -  191s
H    0     0                    17342.786285 39378.1243   127%     -  192s
H    0     0                    17863.349618 39378.1243   120%     -  192s
H    0     0                    18229.287916 39378.1243   116%     -  192s
H    0     0                    18467.172272 39378.1243   113%     -  192s
H    0     0                    18570.049972 39378.1243   112%     -  192s
H    0     0                    18570.155076 39378.1243   112%     -  192s
H    0     0                    18578.313778 39378.1243   112%     -  192s
H    0     0                    18604.008486 39378.1243   112%     -  192s
H    0     0                    18710.075992 39378.1243   110%     -  192s
H    0     0                    18719.821695 39378.1243   110%     -  192s
H    0     0                    18720.155087 39378.1243   110%     -  192s
H    0     0                    18739.668875 39378.1243   110%     -  192s
     0     0 39061.9038    0  305 18739.6689 39061.9038   108%     -  231s
     0     0 39017.5571    0  401 18739.6689 39017.5571   108%     -  244s
     0     0 38930.8562    0  404 18739.6689 38930.8562   108%     -  256s
     0     0 38589.6677    0  407 18739.6689 38589.6677   106%     -  277s
     0     0 38562.7278    0  366 18739.6689 38562.7278   106%     -  285s
     0     0 38476.5861    0  412 18739.6689 38476.5861   105%     -  297s
     0     0 38460.7520    0  417 18739.6689 38460.7520   105%     -  304s
     0     0 38458.8477    0  369 18739.6689 38458.8477   105%     -  305s
     0     0 38458.8034    0  367 18739.6689 38458.8034   105%     -  306s
     0     0 36333.7733    0  418 18739.6689 36333.7733  93.9%     -  388s
     0     0 35904.6623    0  455 18739.6689 35904.6623  91.6%     -  431s
     0     0 35533.2728    0  433 18739.6689 35533.2728  89.6%     -  457s
     0     0 35339.8431    0  445 18739.6689 35339.8431  88.6%     -  485s
     0     0 35226.8438    0  392 18739.6689 35226.8438  88.0%     -  504s
     0     0 35195.7559    0  453 18739.6689 35195.7559  87.8%     -  518s
     0     0 35162.8978    0  370 18739.6689 35162.8978  87.6%     -  527s
     0     0 35132.1958    0  444 18739.6689 35132.1958  87.5%     -  537s
     0     0 35026.9824    0  373 18739.6689 35026.9824  86.9%     -  551s
     0     0 34991.6594    0  451 18739.6689 34991.6594  86.7%     -  561s
     0     0 34964.9645    0  504 18739.6689 34964.9645  86.6%     -  570s
     0     0 34957.4568    0  506 18739.6689 34957.4568  86.5%     -  574s
     0     0 34945.7169    0  430 18739.6689 34945.7169  86.5%     -  578s
     0     0 34936.0856    0  505 18739.6689 34936.0856  86.4%     -  582s
     0     0 34931.2453    0  503 18739.6689 34931.2453  86.4%     -  585s
     0     0 34888.4485    0  493 18739.6689 34888.4485  86.2%     -  596s
     0     0 34877.4153    0  507 18739.6689 34877.4153  86.1%     -  602s
     0     0 34868.7804    0  498 18739.6689 34868.7804  86.1%     -  606s
     0     0 34867.8893    0  497 18739.6689 34867.8893  86.1%     -  608s
     0     0 33937.8583    0  349 18739.6689 33937.8583  81.1%     -  657s
H    0     0                    18803.745320 33937.8495  80.5%     -  658s
H    0     0                    18992.201325 33937.8495  78.7%     -  658s
H    0     0                    19037.579198 33937.8495  78.3%     -  658s
H    0     0                    19037.763085 33937.8495  78.3%     -  658s
     0     0 33595.1452    0  404 19037.7631 33595.1452  76.5%     -  682s
     0     0 33476.7366    0  424 19037.7631 33476.7366  75.8%     -  694s
     0     0 33403.4528    0  419 19037.7631 33403.4528  75.5%     -  709s
     0     0 33352.0272    0  498 19037.7631 33352.0272  75.2%     -  719s
     0     0 33329.8655    0  377 19037.7631 33329.8655  75.1%     -  724s
     0     0 33316.1256    0  419 19037.7631 33316.1256  75.0%     -  730s
     0     0 33291.5496    0  423 19037.7631 33291.5496  74.9%     -  734s
     0     0 33282.6070    0  413 19037.7631 33282.6070  74.8%     -  740s
     0     0 33277.1330    0  402 19037.7631 33277.1330  74.8%     -  745s
     0     0 33271.6557    0  405 19037.7631 33271.6557  74.8%     -  748s
     0     0 33266.9853    0  453 19037.7631 33266.9853  74.7%     -  752s
     0     0 33262.1337    0  402 19037.7631 33262.1337  74.7%     -  755s
     0     0 33258.4814    0  454 19037.7631 33258.4814  74.7%     -  759s
     0     0 33211.7571    0  464 19037.7631 33211.7571  74.5%     -  766s
     0     0 33207.4537    0  469 19037.7631 33207.4537  74.4%     -  770s
     0     0 33196.8383    0  463 19037.7631 33196.8383  74.4%     -  776s
     0     0 33192.5616    0  460 19037.7631 33192.5616  74.4%     -  781s
     0     0 33190.3180    0  466 19037.7631 33190.3180  74.3%     -  783s
     0     0 33186.7180    0  462 19037.7631 33186.7180  74.3%     -  785s
     0     0 33113.9256    0  495 19037.7631 33113.9256  73.9%     -  797s
     0     0 33096.0207    0  467 19037.7631 33096.0207  73.8%     -  802s
     0     0 33089.4213    0  575 19037.7631 33089.4213  73.8%     -  807s
     0     0 33087.7068    0  467 19037.7631 33087.7068  73.8%     -  809s
     0     0 32731.9263    0  539 19037.7631 32731.9263  71.9%     -  831s
H    0     0                    19056.415121 32731.4398  71.8%     -  832s
     0     0 32657.0290    0  558 19056.4151 32657.0290  71.4%     -  842s
     0     0 32635.8467    0  550 19056.4151 32635.8467  71.3%     -  849s
     0     0 32630.4132    0  563 19056.4151 32630.4132  71.2%     -  851s
     0     0 32623.2927    0  565 19056.4151 32623.2927  71.2%     -  854s
     0     0 32616.5793    0  556 19056.4151 32616.5793  71.2%     -  857s
     0     0 32597.2781    0  561 19056.4151 32597.2781  71.1%     -  861s
     0     0 32589.6725    0  550 19056.4151 32589.6725  71.0%     -  863s
     0     0 32577.1410    0  569 19056.4151 32577.1410  71.0%     -  868s
     0     0 32575.4201    0  563 19056.4151 32575.4201  70.9%     -  870s
     0     0 32442.5339    0  484 19056.4151 32442.5339  70.2%     -  883s
     0     0 32397.9705    0  443 19056.4151 32397.9705  70.0%     -  896s
     0     0 32379.5689    0  432 19056.4151 32379.5689  69.9%     -  903s
     0     0 32372.2900    0  448 19056.4151 32372.2900  69.9%     -  906s
     0     0 32369.4098    0  451 19056.4151 32369.4098  69.9%     -  908s
     0     0 32365.0769    0  451 19056.4151 32365.0769  69.8%     -  911s
     0     0 32360.7146    0  449 19056.4151 32360.7146  69.8%     -  914s
     0     0 32357.6293    0  445 19056.4151 32357.6293  69.8%     -  917s
     0     0 32348.8031    0  443 19056.4151 32348.8031  69.8%     -  919s
     0     0 32346.1542    0  453 19056.4151 32346.1542  69.7%     -  921s
     0     0 32344.3611    0  454 19056.4151 32344.3611  69.7%     -  922s
     0     0 32237.9644    0  428 19056.4151 32237.9644  69.2%     -  933s
H    0     0                    19086.643989 32236.5427  68.9%     -  934s
H    0     0                    19109.852520 32236.5427  68.7%     -  934s
     0     0 32208.7741    0  441 19109.8525 32208.7741  68.5%     -  939s
     0     0 32204.4198    0  443 19109.8525 32204.4198  68.5%     -  941s
     0     0 32202.7250    0  447 19109.8525 32202.7250  68.5%     -  943s
     0     0 32144.5270    0  435 19109.8525 32144.5270  68.2%     -  953s
     0     0 32132.5038    0  505 19109.8525 32132.5038  68.1%     -  959s
     0     0 32117.2340    0  508 19109.8525 32117.2340  68.1%     -  964s
     0     0 32112.1191    0  510 19109.8525 32112.1191  68.0%     -  966s
     0     0 32099.0305    0  505 19109.8525 32099.0305  68.0%     -  970s
     0     0 32065.7879    0  511 19109.8525 32065.7879  67.8%     -  978s
     0     0 32063.8328    0  507 19109.8525 32063.8328  67.8%     -  981s
     0     0 32054.0426    0  491 19109.8525 32054.0426  67.7%     -  988s
     0     0 32051.8930    0  554 19109.8525 32051.8930  67.7%     -  991s
     0     0 32018.0417    0  457 19109.8525 32018.0417  67.5%     -  998s
H    0     0                    19162.693978 32017.2477  67.1%     - 1004s
H    0     0                    19201.903489 32017.2477  66.7%     - 1004s
     0     0 32012.5566    0  449 19201.9035 32012.5566  66.7%     - 1006s
     0     0 32010.0959    0  454 19201.9035 32010.0959  66.7%     - 1007s
     0     0 32008.8628    0  453 19201.9035 32008.8628  66.7%     - 1009s
     0     0 31992.1299    0  437 19201.9035 31992.1299  66.6%     - 1014s
     0     0 31989.4572    0  493 19201.9035 31989.4572  66.6%     - 1018s
     0     0 31987.2669    0  451 19201.9035 31987.2669  66.6%     - 1021s
     0     0 31977.7364    0  451 19201.9035 31977.7364  66.5%     - 1026s
H    0     0                    19205.525826 31977.0479  66.5%     - 1030s
     0     0 31972.5163    0  481 19205.5258 31972.5163  66.5%     - 1034s
     0     0 31969.7013    0  507 19205.5258 31969.7013  66.5%     - 1037s
     0     0 31967.7766    0  499 19205.5258 31967.7766  66.5%     - 1039s
     0     0 31953.6053    0  524 19205.5258 31953.6053  66.4%     - 1046s
     0     0 31947.0951    0  457 19205.5258 31947.0951  66.3%     - 1049s
     0     0 31947.0951    0  458 19205.5258 31947.0951  66.3%     - 1050s
     0     0 31927.7602    0  459 19205.5258 31927.7602  66.2%     - 1055s
H    0     0                    19225.835661 31927.6247  66.1%     - 1058s
H    0     0                    19280.330794 31927.6247  65.6%     - 1059s
H    0     0                    19281.043869 31927.6247  65.6%     - 1059s
H    0     0                    19283.566442 31927.6247  65.6%     - 1060s
H    0     0                    19317.012046 31927.6247  65.3%     - 1060s
     0     0 31926.1424    0  463 19317.0120 31926.1424  65.3%     - 1061s
     0     0 31923.0175    0  458 19317.0120 31923.0175  65.3%     - 1067s
     0     0 31919.9822    0  461 19317.0120 31919.9822  65.2%     - 1070s
     0     0 31913.4677    0  520 19317.0120 31913.4677  65.2%     - 1075s
H    0     0                    19399.933543 31912.2497  64.5%     - 1084s
     0     0 31908.8824    0  521 19399.9335 31908.8824  64.5%     - 1088s
     0     0 31907.8331    0  522 19399.9335 31907.8331  64.5%     - 1089s
     0     0 31885.0016    0  451 19399.9335 31885.0016  64.4%     - 1096s
     0     0 31875.0083    0  494 19399.9335 31875.0083  64.3%     - 1100s
     0     0 31874.1740    0  506 19399.9335 31874.1740  64.3%     - 1102s
     0     0 31854.9957    0  458 19399.9335 31854.9957  64.2%     - 1108s
H    0     0                    19405.397534 31854.8065  64.2%     - 1137s
H    0     0                    19476.253519 31854.8065  63.6%     - 1138s
H    0     0                    19508.569650 31854.8065  63.3%     - 1138s
     0     0 31853.7215    0  456 19508.5696 31853.7215  63.3%     - 1140s
     0     0 31845.6459    0  513 19508.5696 31845.6459  63.2%     - 1146s
     0     0 31838.6311    0  517 19508.5696 31838.6311  63.2%     - 1149s
     0     0 31838.0490    0  518 19508.5696 31838.0490  63.2%     - 1151s
     0     0 31837.6806    0  451 19508.5696 31837.6806  63.2%     - 1153s
     0     0 31837.0063    0  451 19508.5696 31837.0063  63.2%     - 1162s
H    0     0                    19514.467740 31837.0063  63.1%     - 1329s
     0     2 31837.0063    0  451 19514.4677 31837.0063  63.1%     - 1332s
     1     3 30629.2513    1  484 19514.4677 31837.0063  63.1% 20815 1360s
     2     4 31422.7467    1  484 19514.4677 31422.7467  61.0% 20237 1379s
     3     7 31092.6081    2  501 19514.4677 31419.3677  61.0% 17409 1415s
     6    14 30957.3339    3  547 19514.4677 31233.6441  60.1% 17547 1432s
    13    28 30638.1240    4  493 19514.4677 31203.9096  59.9% 15799 1458s
    27    42 29972.6390    5  375 19514.4677 30910.1360  58.4% 24263 1537s
    41    65 28049.5501    6  320 19514.4677 30910.1360  58.4% 21629 1894s
H   58    65                    19530.820198 30910.1360  58.3% 19399 1894s
    66   131 29648.4922    6  375 19530.8202 30689.6344  57.1% 26930 1984s
H  132   163                    19608.315443 30658.0163  56.4% 19330 2030s
H  135   163                    19664.120315 30658.0163  55.9% 19535 2030s
H  137   163                    19682.289473 30658.0163  55.8% 19531 2030s
H  161   163                    19707.494729 30657.9835  55.6% 19335 2030s
   164   264 28589.3298    9  342 19707.4947 30657.9835  55.6% 19438 2089s
   265   355 28530.5477   10  330 19707.4947 30657.9835  55.6% 14637 2144s
   356   413 28349.0735   12  319 19707.4947 30657.9835  55.6% 12682 2183s
   414   462 27466.3826   13  249 19707.4947 30657.9835  55.6% 12023 2227s
   463   511 26989.3922   19  237 19707.4947 30657.9835  55.6% 11836 2259s
   514   541 27178.9585   14  252 19707.4947 30657.9835  55.6% 11895 2292s
   544   582 26250.6280   15  298 19707.4947 30657.9835  55.6% 11921 2332s
   585   628 26236.2972   16  236 19707.4947 30657.9835  55.6% 11755 2372s
   633   683 25421.0995   17  234 19707.4947 30657.9835  55.6% 11505 2413s
   692   734 25379.3212   18  223 19707.4947 30657.9835  55.6% 11365 2442s
   763   789 25368.8397   19  296 19707.4947 30657.9835  55.6% 11122 2464s
   828   847 25355.2606   20  288 19707.4947 30657.9835  55.6% 10847 2486s
   901   904 25233.9914   21  291 19707.4947 30657.9835  55.6% 10600 2512s
   972   969 25333.4864   29  345 19707.4947 30657.9835  55.6% 10491 2539s
  1045  1045 24890.0451   22  267 19707.4947 30657.9835  55.6% 10441 2563s
  1144  1133 24367.5906   23  270 19707.4947 30604.3187  55.3% 10190 2589s
  1269  1212 24095.7435   24  256 19707.4947 30604.3187  55.3%  9836 2616s
  1389  1284 23863.7945   25  260 19707.4947 30604.3187  55.3%  9528 2647s
  1527  1360 23661.5439   26  262 19707.4947 30604.3187  55.3%  9216 2677s
  1661  1429 23170.4262   27  261 19707.4947 30604.3187  55.3%  8929 2709s
  1779  1485 23101.2800   28  262 19707.4947 30604.3187  55.3%  8869 2742s
  1895  1571 23037.4727   29  190 19707.4947 30080.8928  52.6%  8827 2775s
  2027  1668 infeasible   30      19707.4947 30080.8928  52.6%  8751 2807s
  2156  1758 22526.9075   31  179 19707.4947 29921.9785  51.8%  8646 2841s
  2292  1850 22500.9205   32  175 19707.4947 29921.9785  51.8%  8603 2872s
  2467  1962 22393.9650   33  173 19707.4947 29921.9785  51.8%  8486 2910s
  2609  2081 22361.0266   34  262 19707.4947 29908.3383  51.8%  8488 2944s
  2776  2173 21594.3184   38  325 19707.4947 29908.3383  51.8%  8461 2986s
  2954  2255 21185.2984   41  174 19707.4947 29604.4211  50.2%  8385 3029s
  3091  2364 20137.1351   45  172 19707.4947 29604.4211  50.2%  8481 3072s
  3276  2444 21069.9635   25  215 19707.4947 29604.4211  50.2%  8456 3118s
  3420  2469 20427.1597   30  153 19707.4947 29604.4211  50.2%  8527 3162s
  3455  2519 20391.8191   31  157 19707.4947 29604.4211  50.2%  8592 3204s
  3519  2579 20286.9132   32  210 19707.4947 29604.4211  50.2%  8682 3246s
  3644  2657 20103.1550   36  151 19707.4947 29604.4211  50.2%  8649 3299s
H 3694  2657                    19727.930388 29555.9108  49.8%  8672 3299s
  3770  2802 20873.1417   38  283 19727.9304 29555.9108  49.8%  8723 3355s

Cutting planes:
  Learned: 4
  Gomory: 2
  Implied bound: 233
  MIR: 3236
  Flow cover: 4620
  RLT: 66
  Relax-and-lift: 659

Explored 3945 nodes (35580662 simplex iterations) in 3600.09 seconds (9014.66 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 19727.9 19707.5 19682.3 ... 19405.4

Time limit reached
Best objective 1.972793038784e+04, best bound 2.955591075922e+04, gap 49.8176%
  WARNING: Time limit reached. Using best solution found (gap: 49.82%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.13s
  Master Objective (UB) = 19727.93, θ = 142301.22
  Upper Bound (UB) = 19727.93

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 142301.22
  [DEBUG]   ✓ Scenario 0: θ = 142301.22 ≤ Q = 142301.22 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 142301.22 ≤ Q = 142301.22 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 142301.22 ≤ Q = 142301.22 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 142301.22 ≤ Q = 142301.22 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 142301.22 ≤ Q = 142301.22 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 142301.22 ≤ Q = 142301.22 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 142301.22 ≤ Q = 142301.22 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 142301.22 ≤ Q = 142301.22 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 142301.22 ≤ Q = 142301.22 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 142301.22 ≤ Q = 142301.22 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 142301.22 ≤ Q = 142301.22 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 142301.22 ≤ Q = 142301.22 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 142301.22 ≤ Q = 142301.22 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 142301.22 ≤ Q = 142301.22 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 142301.22 ≤ Q = 142301.22 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 142301.22 ≤ Q = 143855.38 (slack: 1554.16)
  [DEBUG]   ✓ Scenario 16: θ = 142301.22 ≤ Q = 142301.22 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 142301.22 ≤ Q = 142301.22 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 142301.22 ≤ Q = 142301.22 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 19] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x6011dece
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x9fee2132
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.460667e+13
Presolve removed 2571 rows and 1864 columns
Presolve time: 0.00s
Presolved: 522 rows, 525 columns, 1472 nonzeros
Found heuristic solution: objective 7785653.7476
Variable types: 355 continuous, 170 integer (170 binary)

Root relaxation: objective -1.352671e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -135267.12    0  124 7785653.75 -135267.12   102%     -    0s
H    0     0                    -100300.2998 -135267.12  34.9%     -    0s
H    0     0                    -100828.2726 -135267.12  34.2%     -    0s
     0     0 -107785.50    0  138 -100828.27 -107785.50  6.90%     -    0s
H    0     0                    -103342.0413 -107643.24  4.16%     -    0s
     0     0 -107002.37    0  140 -103342.04 -107002.37  3.54%     -    0s
H    0     0                    -103783.0012 -106918.77  3.02%     -    0s
     0     0 -106341.22    0  136 -103783.00 -106341.22  2.46%     -    0s
     0     0 -106291.97    0  137 -103783.00 -106291.97  2.42%     -    0s
     0     0 -106092.46    0  139 -103783.00 -106092.46  2.23%     -    0s
     0     0 -106053.81    0  136 -103783.00 -106053.81  2.19%     -    0s
     0     0 -106049.32    0  140 -103783.00 -106049.32  2.18%     -    0s
     0     0 -105927.79    0  137 -103783.00 -105927.79  2.07%     -    0s
     0     0 -105927.46    0  137 -103783.00 -105927.46  2.07%     -    0s
H    0     0                    -104863.7684 -105927.46  1.01%     -    0s
H    0     0                    -104935.1412 -105927.46  0.95%     -    0s
H    0     0                    -105272.3576 -105927.46  0.62%     -    0s
     0     2 -105927.46    0  137 -105272.36 -105927.46  0.62%     -    0s
*  485   178              23    -105315.8531 -105493.11  0.17%   7.0    0s
*  492   178              22    -105375.6249 -105493.11  0.11%   6.9    0s
*  786    13              22    -105383.8461 -105434.15  0.05%   5.5    0s
H  846     0                    -105396.9118 -105425.33  0.03%   5.3    0s

Cutting planes:
  Gomory: 66
  Implied bound: 1
  MIR: 230
  RLT: 1

Explored 857 nodes (5179 simplex iterations) in 0.13 seconds (0.10 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -105397 -105384 -105376 ... -100300
No other solutions better than -105397

Optimal solution found (tolerance 1.00e-04)
Best objective -1.053969117675e+05, best bound -1.053969117675e+05, gap 0.0000%
  Subproblem solved in 0.15s
  Worst-case operational profit (Z_SP) = 140705.82
  Scenario: 9 demand increases, 51 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -105396.91
  [DEBUG]   S×d_nominal = 246102.73
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 246102.73 + -105396.91 = 140705.82
  [DEBUG]   Current θ from Master = 142301.22
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1595.40 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 18132.53
  Lower Bound (LB) = 19157.49
  Gap (UB-LB) = 570.4380, Absolute Gap = 570.4380, Relative Gap = 0.028915
  Not converged yet (gap = 570.44 > ε = 200)

  [DEBUG] Adding NEW scenario 19 to Master Problem...
  [DEBUG] New scenario pattern: 9 increases, 51 decreases
    [DEBUG] Scenario 19 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 19 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 19]
    [DEBUG]   - Total constraints in model: 307183
    [DEBUG]   - Total variables in model: 127060
  [DEBUG] Total scenarios in Master: 20
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 20
================================================================================
[Iteration 20] Solving Master Problem...
  Current scenarios in Master: 20
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 307183 rows, 127060 columns and 870439 nonzeros
Model fingerprint: 0x2faf3a5c
Variable types: 124801 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 131500 rows and 53400 columns
Presolve time: 3.54s
Presolved: 175683 rows, 73660 columns, 1080747 nonzeros
Variable types: 71401 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -366999.6780
Found heuristic solution: objective -194531.7474

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.63s

Barrier statistics:
 Dense cols : 728
 AA' NZ     : 9.029e+06
 Factor NZ  : 2.055e+07 (roughly 270 MB of memory)
 Factor Ops : 5.509e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.76012599e+07  2.74170960e+08  1.00e+05 1.81e+01  7.05e+04     7s
   1  -1.35627082e+07  2.34373595e+08  7.14e+04 5.63e+01  4.97e+04     7s
   2  -5.38763924e+06  1.83640113e+08  2.76e+04 5.87e-01  2.00e+04     7s
   3  -1.15104371e+06  1.34427194e+08  3.51e+03 1.34e+00  2.83e+03     7s
   4  -5.57923846e+05  1.03526687e+08  5.29e+02 7.55e-01  6.73e+02     7s
   5  -5.04346082e+05  5.06929537e+07  3.36e+02 2.61e-01  3.52e+02     7s
   6  -4.08221165e+05  3.91705758e+07  1.19e+02 1.92e-01  1.88e+02     7s
   7  -3.53880010e+05  2.70145361e+07  5.23e+01 1.22e-01  1.10e+02     7s
   8  -2.53153393e+05  2.32756499e+07  1.94e+01 1.03e-01  8.21e+01     8s
   9  -1.65970674e+05  1.56799408e+07  7.55e+00 6.69e-02  5.20e+01     8s
  10  -1.16998738e+05  6.82736062e+06  2.94e+00 2.74e-02  2.22e+01     8s
  11  -8.52968099e+04  3.80239075e+06  1.35e+00 1.50e-02  1.23e+01     8s
  12  -7.95709530e+04  1.81524674e+06  1.09e+00 7.34e-03  5.98e+00     8s
  13  -5.11876883e+04  1.20160609e+06  5.52e-01 4.78e-03  3.94e+00     8s
  14  -2.67384917e+04  5.24035086e+05  2.40e-01 1.85e-03  1.73e+00     8s
  15  -4.04636748e+03  2.77946219e+05  1.24e-01 9.69e-04  8.83e-01     8s
  16   9.63838345e+03  2.12650624e+05  7.41e-02 1.29e-03  6.35e-01     8s
  17   1.32912491e+04  1.68794601e+05  6.45e-02 9.46e-04  4.87e-01     8s
  18   2.09487143e+04  1.38723706e+05  4.31e-02 1.45e-03  3.68e-01     8s
  19   2.55797788e+04  1.06235747e+05  3.30e-02 1.38e-03  2.52e-01     8s
  20   2.85824417e+04  8.98669290e+04  2.74e-02 1.44e-03  1.92e-01     8s
  21   3.16346071e+04  7.78956671e+04  2.23e-02 1.16e-03  1.45e-01     9s
  22   3.42230643e+04  7.00116164e+04  1.84e-02 8.62e-04  1.12e-01     9s
  23   3.66841109e+04  6.60329917e+04  1.49e-02 7.21e-04  9.19e-02     9s
  24   3.96386298e+04  5.93312633e+04  1.08e-02 5.44e-04  6.16e-02     9s
  25   4.12252335e+04  5.81389734e+04  8.76e-03 4.82e-04  5.29e-02     9s
  26   4.25959482e+04  5.44734707e+04  7.08e-03 2.49e-04  3.72e-02     9s
  27   4.40693546e+04  5.31528230e+04  5.40e-03 1.88e-04  2.84e-02     9s
  28   4.46474323e+04  5.25090820e+04  4.73e-03 1.59e-04  2.46e-02     9s
  29   4.60081757e+04  5.19232838e+04  3.23e-03 1.31e-04  1.85e-02     9s
  30   4.67108523e+04  5.10493390e+04  2.45e-03 9.00e-05  1.36e-02     9s
  31   4.70752166e+04  5.08559367e+04  2.05e-03 8.10e-05  1.18e-02    10s
  32   4.78619364e+04  5.04103182e+04  1.20e-03 6.12e-05  7.97e-03    10s
  33   4.83074857e+04  4.98136947e+04  7.69e-04 7.44e-05  4.71e-03    10s
  34   4.86426560e+04  4.96048304e+04  4.26e-04 5.11e-05  3.01e-03    10s
  35   4.87865919e+04  4.92660439e+04  2.91e-04 3.62e-05  1.50e-03    10s
  36   4.88192316e+04  4.92306585e+04  2.59e-04 2.84e-05  1.29e-03    10s
  37   4.89506005e+04  4.91788339e+04  1.35e-04 1.74e-05  7.14e-04    10s
  38   4.90005283e+04  4.91616696e+04  8.86e-05 1.35e-05  5.04e-04    10s
  39   4.90177522e+04  4.91428340e+04  7.32e-05 9.42e-06  3.92e-04    10s
  40   4.90861355e+04  4.91094810e+04  1.11e-05 1.72e-06  7.31e-05    10s
  41   4.90984606e+04  4.91016516e+04  9.49e-07 4.85e-07  9.99e-06    11s
  42   4.91004720e+04  4.91006121e+04  4.65e-08 4.39e-07  4.38e-07    11s
  43   4.91004830e+04  4.91005832e+04  2.29e-06 7.05e-09  3.13e-07    11s
  44   4.91005108e+04  4.91005831e+04  1.65e-06 3.29e-09  2.26e-07    11s
  45   4.91005327e+04  4.91005831e+04  1.15e-06 1.60e-09  1.57e-07    11s
  46   4.91005356e+04  4.91005831e+04  1.77e-06 9.16e-08  1.48e-07    11s
  47   4.91005496e+04  4.91005831e+04  5.79e-06 6.53e-08  1.04e-07    11s
  48   4.91005646e+04  4.91005830e+04  3.18e-06 3.28e-08  5.75e-08    11s
  49   4.91005682e+04  4.91005830e+04  2.53e-06 2.04e-08  4.62e-08    11s
  50   4.91005766e+04  4.91005830e+04  1.41e-06 1.74e-07  1.99e-08    11s
  51   4.91005795e+04  4.91005830e+04  7.82e-07 8.68e-08  1.11e-08    12s
  52   4.91005830e+04  4.91005830e+04  1.61e-08 9.75e-08  1.13e-11    12s

Barrier solved model in 52 iterations and 11.66 seconds (20.08 work units)
Optimal objective 4.91005830e+04


Root crossover log...

  156459 DPushes remaining with DInf 0.0000000e+00                12s
   14766 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                17s

    2185 PPushes remaining with PInf 3.6175523e-06                17s
       0 PPushes remaining with PInf 0.0000000e+00                18s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.5838028e-10     18s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   66222    4.9100583e+04   0.000000e+00   0.000000e+00     18s
   66222    4.9100583e+04   0.000000e+00   0.000000e+00     18s
Concurrent spin time: 2.16s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 4.910058e+04, 66222 iterations, 15.58 seconds (31.33 work units)
Total elapsed time = 20.28s (DegenMoves)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 49100.5830    0  177 -194531.75 49100.5830   125%     -   20s
H    0     0                    -189758.5599 49100.5830   126%     -   20s
H    0     0                    -111686.3570 49100.5830   144%     -   21s
H    0     0                    -110232.0510 49100.5830   145%     -   21s
H    0     0                    -109965.2996 49100.5830   145%     -   21s
H    0     0                    -106838.4645 49100.5830   146%     -   21s
H    0     0                    -106565.5466 49100.5830   146%     -   21s
H    0     0                    -44548.72900 49100.5830   210%     -   21s
H    0     0                    11271.589733 49100.5830   336%     -   22s
H    0     0                    12410.713677 49100.5830   296%     -   22s
H    0     0                    12627.122568 49100.5830   289%     -   22s
H    0     0                    13401.699378 49100.5830   266%     -   22s
H    0     0                    13497.844345 49100.5830   264%     -   22s
H    0     0                    13699.693498 49100.5830   258%     -   22s
H    0     0                    13792.588044 49100.5830   256%     -   22s
H    0     0                    13808.949243 49100.5830   256%     -   23s
     0     0 42590.7338    0  303 13808.9492 42590.7338   208%     -   82s
H    0     0                    13832.106521 42590.7220   208%     -   84s
H    0     0                    13918.947390 42590.7220   206%     -   84s
     0     0 42522.1308    0  303 13918.9474 42522.1308   205%     -   96s
     0     0 42510.0974    0  301 13918.9474 42510.0974   205%     -  100s
     0     0 42471.2368    0  299 13918.9474 42471.2368   205%     -  112s
     0     0 42448.1280    0  296 13918.9474 42448.1280   205%     -  122s
     0     0 42448.1077    0  296 13918.9474 42448.1077   205%     -  123s
     0     0 39042.2126    0  313 13918.9474 39042.2126   180%     -  185s
H    0     0                    14566.936196 39041.2939   168%     -  186s
H    0     0                    15397.811545 39041.2939   154%     -  186s
H    0     0                    15401.941433 39041.2939   153%     -  186s
H    0     0                    15518.258968 39041.2939   152%     -  186s
H    0     0                    15541.539571 39041.2939   151%     -  186s
H    0     0                    15608.607029 39041.2939   150%     -  186s
H    0     0                    15628.865713 39041.2939   150%     -  187s
     0     0 38388.1002    0  363 15628.8657 38388.1002   146%     -  218s
     0     0 38078.0019    0  366 15628.8657 38078.0019   144%     -  237s
     0     0 38024.1978    0  371 15628.8657 38024.1978   143%     -  244s
     0     0 37979.6069    0  369 15628.8657 37979.6069   143%     -  253s
     0     0 37973.7807    0  367 15628.8657 37973.7807   143%     -  258s
     0     0 37972.7159    0  374 15628.8657 37972.7159   143%     -  261s
     0     0 36300.0330    0  403 15628.8657 36300.0330   132%     -  334s
     0     0 36300.0330    0  403 15628.8657 36300.0330   132%     -  335s
     0     0 35503.1418    0  428 15628.8657 35503.1418   127%     -  397s
     0     0 35202.2550    0  395 15628.8657 35202.2550   125%     -  426s
     0     0 35117.1321    0  397 15628.8657 35117.1321   125%     -  445s
     0     0 35027.5321    0  440 15628.8657 35027.5321   124%     -  461s
     0     0 34968.6190    0  441 15628.8657 34968.6190   124%     -  471s
     0     0 34917.4121    0  447 15628.8657 34917.4121   123%     -  479s
     0     0 34878.1726    0  440 15628.8657 34878.1726   123%     -  495s
     0     0 34847.1661    0  450 15628.8657 34847.1661   123%     -  505s
     0     0 34817.3741    0  458 15628.8657 34817.3741   123%     -  514s
     0     0 34806.8170    0  523 15628.8657 34806.8170   123%     -  520s
     0     0 34784.4812    0  527 15628.8657 34784.4812   123%     -  527s
     0     0 34758.6986    0  458 15628.8657 34758.6986   122%     -  536s
     0     0 34736.5606    0  452 15628.8657 34736.5606   122%     -  542s
     0     0 34726.3661    0  467 15628.8657 34726.3661   122%     -  544s
     0     0 34723.7335    0  471 15628.8657 34723.7335   122%     -  547s
     0     0 34715.9133    0  473 15628.8657 34715.9133   122%     -  549s
     0     0 34615.7848    0  457 15628.8657 34615.7848   121%     -  563s
     0     0 34476.5031    0  450 15628.8657 34476.5031   121%     -  580s
     0     0 34415.7360    0  472 15628.8657 34415.7360   120%     -  591s
     0     0 34406.4331    0  470 15628.8657 34406.4331   120%     -  597s
     0     0 34399.4501    0  477 15628.8657 34399.4501   120%     -  600s
     0     0 34397.9920    0  474 15628.8657 34397.9920   120%     -  602s
     0     0 33658.2510    0  422 15628.8657 33658.2510   115%     -  645s
H    0     0                    15664.825815 33656.8531   115%     -  646s
H    0     0                    15665.347404 33656.8531   115%     -  646s
H    0     0                    15672.531018 33656.8531   115%     -  646s
H    0     0                    15689.906468 33656.8531   115%     -  646s
H    0     0                    15715.754036 33656.8531   114%     -  646s
H    0     0                    15722.896470 33656.8531   114%     -  646s
H    0     0                    15741.777698 33656.8531   114%     -  646s
H    0     0                    15744.287219 33656.8531   114%     -  646s
     0     0 33433.6999    0  425 15744.2872 33433.6999   112%     -  672s
     0     0 33356.0857    0  434 15744.2872 33356.0857   112%     -  688s
     0     0 33302.2113    0  436 15744.2872 33302.2113   112%     -  699s
     0     0 33288.1796    0  541 15744.2872 33288.1796   111%     -  707s
     0     0 33278.2530    0  543 15744.2872 33278.2530   111%     -  714s
     0     0 33247.4172    0  535 15744.2872 33247.4172   111%     -  724s
     0     0 33224.9408    0  548 15744.2872 33224.9408   111%     -  732s
     0     0 33214.5089    0  542 15744.2872 33214.5089   111%     -  738s
     0     0 33185.7621    0  515 15744.2872 33185.7621   111%     -  745s
     0     0 33110.9185    0  543 15744.2872 33110.9185   110%     -  758s
     0     0 33095.5286    0  558 15744.2872 33095.5286   110%     -  764s
     0     0 33092.6385    0  518 15744.2872 33092.6385   110%     -  768s
     0     0 33086.9764    0  561 15744.2872 33086.9764   110%     -  771s
     0     0 33085.5971    0  559 15744.2872 33085.5971   110%     -  773s
     0     0 32856.1519    0  546 15744.2872 32856.1519   109%     -  792s
H    0     0                    15757.212956 32855.8308   109%     -  793s
H    0     0                    15809.326486 32855.8308   108%     -  793s
     0     0 32810.7298    0  553 15809.3265 32810.7298   108%     -  804s
     0     0 32793.5926    0  554 15809.3265 32793.5926   107%     -  810s
     0     0 32768.6147    0  560 15809.3265 32768.6147   107%     -  816s
     0     0 32741.2135    0  553 15809.3265 32741.2135   107%     -  822s
     0     0 32727.1527    0  554 15809.3265 32727.1527   107%     -  827s
     0     0 32717.6298    0  478 15809.3265 32717.6298   107%     -  833s
     0     0 32700.5807    0  550 15809.3265 32700.5807   107%     -  840s
     0     0 32690.4989    0  555 15809.3265 32690.4989   107%     -  845s
     0     0 32668.9025    0  479 15809.3265 32668.9025   107%     -  852s
     0     0 32667.5200    0  478 15809.3265 32667.5200   107%     -  854s
     0     0 32604.5943    0  534 15809.3265 32604.5943   106%     -  868s
H    0     0                    18793.536758 32604.1037  73.5%     -  869s
H    0     0                    19022.204198 32604.1037  71.4%     -  870s
H    0     0                    19035.194139 32604.1037  71.3%     -  871s
     0     0 32595.1592    0  519 19035.1941 32595.1592  71.2%     -  876s
     0     0 32578.8443    0  529 19035.1941 32578.8443  71.2%     -  881s
     0     0 32569.1711    0  509 19035.1941 32569.1711  71.1%     -  886s
     0     0 32565.3364    0  520 19035.1941 32565.3364  71.1%     -  890s
     0     0 32561.9091    0  529 19035.1941 32561.9091  71.1%     -  892s
     0     0 32546.8412    0  524 19035.1941 32546.8412  71.0%     -  897s
     0     0 32545.4640    0  531 19035.1941 32545.4640  71.0%     -  899s
     0     0 32460.2727    0  507 19035.1941 32460.2727  70.5%     -  915s
H    0     0                    19075.449605 32458.8567  70.2%     -  916s
     0     0 32433.0698    0  448 19075.4496 32433.0698  70.0%     -  921s
     0     0 32412.1400    0  455 19075.4496 32412.1400  69.9%     -  928s
     0     0 32404.2165    0  463 19075.4496 32404.2165  69.9%     -  933s
     0     0 32401.7024    0  450 19075.4496 32401.7024  69.9%     -  938s
     0     0 32398.5027    0  461 19075.4496 32398.5027  69.8%     -  942s
     0     0 32392.4757    0  443 19075.4496 32392.4757  69.8%     -  945s
     0     0 32387.5126    0  530 19075.4496 32387.5126  69.8%     -  949s
     0     0 32385.5616    0  443 19075.4496 32385.5616  69.8%     -  953s
     0     0 32339.1249    0  629 19075.4496 32339.1249  69.5%     -  966s
     0     0 32332.4295    0  619 19075.4496 32332.4295  69.5%     -  974s
     0     0 32328.5408    0  618 19075.4496 32328.5408  69.5%     -  978s
     0     0 32326.9578    0  456 19075.4496 32326.9578  69.5%     -  980s
     0     0 32280.0759    0  461 19075.4496 32280.0759  69.2%     -  991s
     0     0 32266.2715    0  461 19075.4496 32266.2715  69.2%     -  996s
     0     0 32260.1107    0  465 19075.4496 32260.1107  69.1%     -  999s
     0     0 32254.9586    0  654 19075.4496 32254.9586  69.1%     - 1006s
     0     0 32252.9836    0  643 19075.4496 32252.9836  69.1%     - 1009s
     0     0 32242.4602    0  476 19075.4496 32242.4602  69.0%     - 1017s
H    0     0                    19091.627471 32242.1757  68.9%     - 1018s
H    0     0                    19109.227547 32242.1757  68.7%     - 1018s
H    0     0                    19161.453278 32242.1757  68.3%     - 1018s
     0     0 32238.3999    0  480 19161.4533 32238.3999  68.2%     - 1022s
     0     0 32235.5577    0  582 19161.4533 32235.5577  68.2%     - 1025s
     0     0 32229.4628    0  494 19161.4533 32229.4628  68.2%     - 1029s
     0     0 32227.9260    0  491 19161.4533 32227.9260  68.2%     - 1031s
     0     0 32215.0763    0  474 19161.4533 32215.0763  68.1%     - 1041s
H    0     0                    19167.632502 32215.0094  68.1%     - 1043s
     0     0 32206.9853    0  473 19167.6325 32206.9853  68.0%     - 1049s
     0     0 32203.3236    0  553 19167.6325 32203.3236  68.0%     - 1053s
     0     0 32201.4367    0  469 19167.6325 32201.4367  68.0%     - 1055s
     0     0 32175.7011    0  526 19167.6325 32175.7011  67.9%     - 1065s
     0     0 32170.6087    0  464 19167.6325 32170.6087  67.8%     - 1074s
     0     0 32168.5400    0  465 19167.6325 32168.5400  67.8%     - 1076s
     0     0 32145.7550    0  570 19167.6325 32145.7550  67.7%     - 1083s
     0     0 32140.9330    0  559 19167.6325 32140.9330  67.7%     - 1088s
     0     0 32136.6014    0  508 19167.6325 32136.6014  67.7%     - 1092s
     0     0 32135.1028    0  509 19167.6325 32135.1028  67.7%     - 1095s
     0     0 32103.5622    0  410 19167.6325 32103.5622  67.5%     - 1103s
H    0     0                    19177.649251 32103.5423  67.4%     - 1105s
H    0     0                    19237.999729 32103.5423  66.9%     - 1106s
H    0     0                    19289.772427 32103.5423  66.4%     - 1106s
     0     0 32095.6560    0  466 19289.7724 32095.6560  66.4%     - 1111s
     0     0 32093.1703    0  471 19289.7724 32093.1703  66.4%     - 1113s
     0     0 32091.7364    0  470 19289.7724 32091.7364  66.4%     - 1115s
     0     0 32078.0135    0  465 19289.7724 32078.0135  66.3%     - 1122s
     0     0 32072.5699    0  415 19289.7724 32072.5699  66.3%     - 1129s
     0     0 32069.5633    0  531 19289.7724 32069.5633  66.3%     - 1134s
     0     0 32069.0263    0  513 19289.7724 32069.0263  66.2%     - 1136s
     0     0 32068.0346    0  472 19289.7724 32068.0346  66.2%     - 1140s
     0     0 32067.1404    0  470 19289.7724 32067.1404  66.2%     - 1144s
     0     0 32064.7167    0  415 19289.7724 32064.7167  66.2%     - 1148s
     0     0 32064.4256    0  479 19289.7724 32064.4256  66.2%     - 1151s
     0     0 32063.4157    0  424 19289.7724 32063.4157  66.2%     - 1155s
H    0     0                    19353.574844 32063.3357  65.7%     - 1163s
H    0     0                    19380.927506 32063.3357  65.4%     - 1163s
     0     0 32062.9689    0  423 19380.9275 32062.9689  65.4%     - 1164s
     0     0 32059.7741    0  423 19380.9275 32059.7741  65.4%     - 1167s
     0     0 32059.4500    0  423 19380.9275 32059.4500  65.4%     - 1176s
H    0     0                    19449.144342 32059.3084  64.8%     - 1381s
H    0     0                    19515.398887 32059.3084  64.3%     - 1450s
H    0     0                    19536.901206 32059.3084  64.1%     - 1450s
H    0     0                    19563.377075 32059.3084  63.9%     - 1456s
     0     2 32059.3084    0  423 19563.3771 32059.3084  63.9%     - 1472s
     1     3 30394.4293    1  403 19563.3771 32057.4486  63.9% 20035 1496s
     2     4 31769.3746    1  542 19563.3771 31769.3746  62.4% 16600 1511s
     3     5 30108.7208    2  480 19563.3771 31769.0871  62.4% 15996 1527s
     4     8 30342.1495    2  475 19563.3771 31768.8026  62.4% 16405 1548s
     7    15 30040.2069    3  479 19563.3771 31257.5295  59.8% 14765 1588s
    14    30 29410.3421    4  419 19563.3771 31257.3259  59.8% 16508 1623s
    29    45 30625.5866    5  454 19563.3771 30849.3030  57.7% 22680 1696s
    44    76 28907.9975    6  471 19563.3771 30849.3030  57.7% 26873 1910s
H   53    76                    19563.379952 30849.3030  57.7% 24920 1910s
    75   181 28562.9069    7  349 19563.3800 30653.2644  56.7% 23783 1971s
   180   236 27034.9868    9  398 19563.3800 30653.2644  56.7% 15528 2005s
   237   300 24046.8209   13  293 19563.3800 30653.2644  56.7% 13778 2036s
   301   328 23865.7280   14  284 19563.3800 30653.2644  56.7% 12626 2065s
   331   362 23817.7416   15  284 19563.3800 30653.2644  56.7% 12826 2093s
   369   390 23754.6998   16  264 19563.3800 30653.2644  56.7% 12533 2119s
   407   421 23519.2062   17  254 19563.3800 30653.2644  56.7% 12520 2148s
   444   455 23505.1942   18  247 19563.3800 30625.5083  56.5% 12418 2176s
   480   499 23459.1133   19  246 19563.3800 30625.5083  56.5% 12387 2200s
   526   562 23399.9284   20  249 19563.3800 30625.5083  56.5% 11891 2228s
   589   612 23395.8074   21  240 19563.3800 30625.5083  56.5% 11526 2251s
   642   654 22812.2100   23  216 19563.3800 30625.5083  56.5% 11244 2273s
   696   689 infeasible   26      19563.3800 30625.5083  56.5% 11022 2300s
   753   721 21463.3599   29  251 19563.3800 30625.5083  56.5% 10896 2335s
   799   776 21436.2534   31  185 19563.3800 30625.5083  56.5% 10890 2358s
   862   840 21364.7643   36  193 19563.3800 30625.5083  56.5% 10640 2384s
   938   911 21320.5390   38  249 19563.3800 30625.5083  56.5% 10345 2410s
  1021  1002 21210.1685   44  225 19563.3800 30625.5083  56.5% 10064 2438s
  1129  1100 21060.7494   51  141 19563.3800 30625.5083  56.5%  9686 2466s
  1259  1188 20541.1072   59  173 19563.3800 30625.5083  56.5%  9145 2491s
  1390  1268 20103.4244   67  147 19563.3800 30625.5083  56.5%  8702 2519s
  1520  1318 infeasible   75      19563.3800 30625.5083  56.5%  8236 2549s
  1667  1349 27374.5654   13  296 19563.3800 30625.5083  56.5%  7784 2578s
  1780  1359 25949.5728   14  331 19563.3800 30435.9785  55.6%  7581 2614s
  1861  1369 26384.0869   14  277 19563.3800 30435.9785  55.6%  7570 2647s
  1898  1388 25628.5426   15  272 19563.3800 30435.9785  55.6%  7697 2680s
  1927  1425 25585.7808   16  266 19563.3800 30435.9785  55.6%  7863 2709s
H 1940  1425                    19570.521801 30435.9785  55.5%  7895 2709s
  1974  1470 25324.6382   17  256 19570.5218 30435.9785  55.5%  7931 2745s
  2031  1521 20169.7642   19  183 19570.5218 30435.9785  55.5%  8011 2780s
  2123  1579 20014.0257   20  169 19570.5218 30435.9785  55.5%  8035 2819s
  2246  1651 infeasible   21      19570.5218 30435.9785  55.5%  8014 2853s
  2379  1753 28379.5903   11  464 19570.5218 30435.9785  55.5%  8034 2894s
  2527  1822 27504.7275   12  456 19570.5218 30435.9785  55.5%  8014 2938s
  2659  1867 27408.4900   13  452 19570.5218 30435.9785  55.5%  7966 2977s
  2761  1908 26978.0458   15  373 19570.5218 30279.0496  54.7%  8022 3024s
  2858  1944 26477.2093   17  489 19570.5218 30279.0496  54.7%  8116 3072s
  2972  2018 24218.9042   18  394 19570.5218 30278.4476  54.7%  8141 3126s
  3120  2077 20380.6970   21  304 19570.5218 29565.4556  51.1%  8127 3180s
H 3235  2115                    19604.373758 29565.0375  50.8%  8261 3237s
H 3284  2114                    19609.476727 29565.0375  50.8%  8290 3237s
H 3299  2111                    19640.910915 29565.0375  50.5%  8285 3237s
  3320  2159 infeasible   25      19640.9109 29565.0375  50.5%  8336 3297s
  3422  2198 20372.6769   58  263 19640.9109 29406.9272  49.7%  8493 3358s
  3525  2248 infeasible   37      19640.9109 29208.8058  48.7%  8708 3422s
  3623  2287 27692.7936    8  395 19640.9109 29208.8058  48.7%  8921 3483s
  3696  2378 25376.1029    9  220 19640.9109 29208.8058  48.7%  9072 3545s
  3845  2491 24514.9296   14  205 19640.9109 29208.8058  48.7%  9178 3600s

Cutting planes:
  Learned: 2
  Implied bound: 241
  MIR: 3864
  Flow cover: 5306
  RLT: 92
  Relax-and-lift: 813

Explored 4026 nodes (37723252 simplex iterations) in 3600.09 seconds (9221.07 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 19640.9 19609.5 19604.4 ... 19380.9

Time limit reached
Best objective 1.964091091487e+04, best bound 2.920880580226e+04, gap 48.7141%
  WARNING: Time limit reached. Using best solution found (gap: 48.71%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.12s
  Master Objective (UB) = 19640.91, θ = 141851.53
  Upper Bound (UB) = 19640.91

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 141851.53
  [DEBUG]   ✓ Scenario 0: θ = 141851.53 ≤ Q = 141851.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 141851.53 ≤ Q = 141851.53 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 141851.53 ≤ Q = 141851.53 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 141851.53 ≤ Q = 141851.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 141851.53 ≤ Q = 141851.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 141851.53 ≤ Q = 141851.53 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 141851.53 ≤ Q = 141851.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 141851.53 ≤ Q = 141851.53 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 141851.53 ≤ Q = 141851.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 141851.53 ≤ Q = 141851.53 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 141851.53 ≤ Q = 141851.53 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 141851.53 ≤ Q = 141851.53 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 141851.53 ≤ Q = 141851.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 141851.53 ≤ Q = 141851.53 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 141851.53 ≤ Q = 141851.53 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 141851.53 ≤ Q = 142288.15 (slack: 436.62)
  [DEBUG]   ✓ Scenario 16: θ = 141851.53 ≤ Q = 141851.53 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 141851.53 ≤ Q = 141851.53 (slack: 0.00)
  [DEBUG]   ✓ Scenario 18: θ = 141851.53 ≤ Q = 141851.53 (slack: 0.00)
  [DEBUG]   ✓ Scenario 19: θ = 141851.53 ≤ Q = 141851.53 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 20] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x416f08aa
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xbe90f756
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [9e-13, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e-14, 2e+02]
Found heuristic solution: objective 1.457366e+13
Presolve removed 2571 rows and 1864 columns
Presolve time: 0.00s
Presolved: 522 rows, 525 columns, 1472 nonzeros
Found heuristic solution: objective 7773837.1648
Variable types: 355 continuous, 170 integer (170 binary)

Root relaxation: objective -1.358115e+05, 248 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -135811.46    0  124 7773837.16 -135811.46   102%     -    0s
H    0     0                    -100915.8472 -135811.46  34.6%     -    0s
H    0     0                    -101427.6224 -135811.46  33.9%     -    0s
     0     0 -108530.10    0  137 -101427.62 -108530.10  7.00%     -    0s
H    0     0                    -103982.6783 -108387.83  4.24%     -    0s
     0     0 -107713.54    0  141 -103982.68 -107713.54  3.59%     -    0s
H    0     0                    -104236.3899 -107657.41  3.28%     -    0s
     0     0 -107012.70    0  141 -104236.39 -107012.70  2.66%     -    0s
H    0     0                    -104455.0135 -106977.02  2.41%     -    0s
     0     0 -106977.02    0  141 -104455.01 -106977.02  2.41%     -    0s
     0     0 -106761.62    0  141 -104455.01 -106761.62  2.21%     -    0s
     0     0 -106723.64    0  142 -104455.01 -106723.64  2.17%     -    0s
     0     0 -106720.78    0  141 -104455.01 -106720.78  2.17%     -    0s
     0     0 -106423.56    0  140 -104455.01 -106423.56  1.88%     -    0s
     0     0 -106398.72    0  140 -104455.01 -106398.72  1.86%     -    0s
     0     0 -106310.62    0  128 -104455.01 -106310.62  1.78%     -    0s
     0     0 -106301.43    0  128 -104455.01 -106301.43  1.77%     -    0s
H    0     0                    -105381.3762 -106301.43  0.87%     -    0s
H    0     0                    -105690.8511 -106301.43  0.58%     -    0s
     0     2 -106301.43    0  128 -105690.85 -106301.43  0.58%     -    0s
H  256    87                    -105713.9201 -105874.50  0.15%   8.8    0s
H  261    87                    -105769.5602 -105874.50  0.10%   8.7    0s
H  412    27                    -105775.2011 -105874.50  0.09%   7.4    0s
H  422    27                    -105777.1106 -105874.50  0.09%   7.3    0s

Cutting planes:
  Gomory: 32
  MIR: 276
  RLT: 2

Explored 527 nodes (4069 simplex iterations) in 0.11 seconds (0.11 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -105777 -105775 -105770 ... -101428
No other solutions better than -105777

Optimal solution found (tolerance 1.00e-04)
Best objective -1.057771106280e+05, best bound -1.057771106280e+05, gap 0.0000%
  Subproblem solved in 0.13s
  Worst-case operational profit (Z_SP) = 140536.32
  Scenario: 29 demand increases, 31 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -105777.11
  [DEBUG]   S×d_nominal = 246313.43
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 246313.43 + -105777.11 = 140536.32
  [DEBUG]   Current θ from Master = 141851.53
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1315.21 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 18325.70
  Lower Bound (LB) = 19157.49
  Gap (UB-LB) = 483.4186, Absolute Gap = 483.4186, Relative Gap = 0.024613
  Not converged yet (gap = 483.42 > ε = 200)

  [DEBUG] Adding NEW scenario 20 to Master Problem...
  [DEBUG] New scenario pattern: 29 increases, 31 decreases
    [DEBUG] Scenario 20 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 20 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 20]
    [DEBUG]   - Total constraints in model: 322473
    [DEBUG]   - Total variables in model: 133300
  [DEBUG] Total scenarios in Master: 21
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 21
================================================================================
[Iteration 21] Solving Master Problem...
  Current scenarios in Master: 21
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 322473 rows, 133300 columns and 913685 nonzeros
Model fingerprint: 0x9a18ff6c
Variable types: 131041 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 138065 rows and 56065 columns
Presolve time: 3.50s
Presolved: 184408 rows, 77235 columns, 1134348 nonzeros
Variable types: 74976 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -366999.6780
Found heuristic solution: objective -194531.7474

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.58s

Barrier statistics:
 Dense cols : 1181
 AA' NZ     : 4.328e+06
 Factor NZ  : 1.222e+07 (roughly 200 MB of memory)
 Factor Ops : 4.231e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.79606433e+07  2.86237885e+08  1.02e+05 1.73e+01  7.16e+04     7s
   1  -1.38448125e+07  2.45138800e+08  7.28e+04 5.61e+01  5.05e+04     7s
   2  -5.58558685e+06  1.92492840e+08  2.87e+04 1.38e+00  2.07e+04     7s
   3  -1.18057608e+06  1.41545066e+08  3.63e+03 2.24e+00  2.91e+03     7s
   4  -5.67361354e+05  1.10052564e+08  5.50e+02 1.15e+00  6.91e+02     7s
   5  -5.08867061e+05  5.31891173e+07  3.52e+02 4.03e-01  3.61e+02     7s
   6  -4.10764581e+05  4.03579955e+07  1.23e+02 2.75e-01  1.88e+02     7s
   7  -3.39312755e+05  2.82323323e+07  4.96e+01 1.79e-01  1.09e+02     7s
   8  -2.26745980e+05  1.96186360e+07  1.23e+01 1.19e-01  6.40e+01     7s
   9  -1.23551113e+05  1.53023657e+07  2.87e+00 9.11e-02  4.69e+01     7s
  10  -1.07047076e+05  6.21850647e+06  2.11e+00 3.61e-02  1.91e+01     8s
  11  -9.42366161e+04  5.40597869e+06  1.43e+00 3.12e-02  1.66e+01     8s
  12  -8.59939609e+04  4.53655454e+06  1.08e+00 2.58e-02  1.39e+01     8s
  13  -7.55693853e+04  2.98116003e+06  7.93e-01 1.64e-02  9.17e+00     8s
  14  -4.74352050e+04  1.56442734e+06  2.38e-01 8.37e-03  4.81e+00     8s
  15  -2.55745990e+04  4.12133031e+05  1.03e-01 2.12e-03  1.31e+00     8s
  16  -8.11137523e+03  2.78347310e+05  6.35e-02 1.24e-03  8.54e-01     8s
  17  -3.26872083e+03  2.12519260e+05  5.50e-02 1.35e-03  6.43e-01     8s
  18   9.19529069e+03  1.78040699e+05  3.68e-02 1.42e-03  5.03e-01     8s
  19   1.60084199e+04  1.44684328e+05  2.91e-02 1.46e-03  3.84e-01     8s
  20   1.89652537e+04  1.15998650e+05  2.59e-02 1.27e-03  2.89e-01     8s
  21   2.24190275e+04  9.99108416e+04  2.24e-02 9.82e-04  2.31e-01     8s
  22   2.59595722e+04  8.61569026e+04  1.89e-02 5.00e-04  1.79e-01     8s
  23   2.95253470e+04  7.98714419e+04  1.54e-02 4.18e-04  1.50e-01     8s
  24   3.27033658e+04  7.37102225e+04  1.24e-02 3.46e-04  1.22e-01     9s
  25   3.49611322e+04  6.83579846e+04  1.04e-02 3.71e-04  9.96e-02     9s
  26   3.75663222e+04  6.64266237e+04  8.09e-03 3.56e-04  8.60e-02     9s
  27   3.97308879e+04  6.11107720e+04  6.29e-03 2.50e-04  6.37e-02     9s
  28   4.13067482e+04  5.93602942e+04  5.06e-03 2.17e-04  5.38e-02     9s
  29   4.24187051e+04  5.61952047e+04  4.22e-03 1.57e-04  4.11e-02     9s
  30   4.30821055e+04  5.49191912e+04  3.76e-03 1.29e-04  3.53e-02     9s
  31   4.42570750e+04  5.29472011e+04  2.95e-03 8.56e-05  2.59e-02     9s
  32   4.49461094e+04  5.19612133e+04  2.51e-03 6.34e-05  2.09e-02     9s
  33   4.65048494e+04  5.14414155e+04  1.52e-03 5.17e-05  1.47e-02     9s
  34   4.68276095e+04  5.07091470e+04  1.32e-03 3.52e-05  1.16e-02    10s
  35   4.72568701e+04  5.02510060e+04  1.05e-03 2.52e-05  8.93e-03    10s
  36   4.78892811e+04  4.98752003e+04  6.71e-04 1.72e-05  5.92e-03    10s
  37   4.84724262e+04  4.95124718e+04  3.32e-04 9.18e-06  3.10e-03    10s
  38   4.86633137e+04  4.94360877e+04  2.26e-04 7.51e-06  2.30e-03    10s
  39   4.87234073e+04  4.93807670e+04  1.94e-04 6.25e-06  1.96e-03    10s
  40   4.88567813e+04  4.93294159e+04  1.21e-04 5.08e-06  1.41e-03    10s
  41   4.89350662e+04  4.92436869e+04  7.87e-05 3.15e-06  9.20e-04    10s
  42   4.89855822e+04  4.91494421e+04  5.33e-05 1.03e-06  4.88e-04    10s
  43   4.90257874e+04  4.91387495e+04  3.44e-05 8.11e-07  3.37e-04    10s
  44   4.90587225e+04  4.91226418e+04  1.81e-05 8.19e-07  1.91e-04    10s
  45   4.90779472e+04  4.91114073e+04  9.57e-06 6.45e-07  9.97e-05    10s
  46   4.90862899e+04  4.91073633e+04  5.90e-06 4.94e-07  6.28e-05    10s
  47   4.90986574e+04  4.91027539e+04  4.82e-07 1.89e-07  1.22e-05    11s
  48   4.91003871e+04  4.91006557e+04  4.11e-08 2.23e-08  8.01e-07    11s
  49   4.91005829e+04  4.91005830e+04  1.11e-09 3.72e-11  4.08e-10    11s

Barrier solved model in 49 iterations and 10.74 seconds (17.79 work units)
Optimal objective 4.91005829e+04


Root crossover log...

  164130 DPushes remaining with DInf 0.0000000e+00                11s
   22522 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                19s

    9691 PPushes remaining with PInf 6.5484871e-05                19s
       0 PPushes remaining with PInf 0.0000000e+00                20s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.9357308e+01     20s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   86497    4.9100583e+04   0.000000e+00   1.935731e+01     20s
   86562    4.9100583e+04   0.000000e+00   0.000000e+00     20s
   86562    4.9100583e+04   0.000000e+00   0.000000e+00     20s
Concurrent spin time: 4.54s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 4.910058e+04, 86562 iterations, 20.12 seconds (37.62 work units)
Total elapsed time = 25.00s (DegenMoves)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 49100.5830    0  177 -194531.75 49100.5830   125%     -   25s
H    0     0                    -189758.5599 49100.5830   126%     -   25s
H    0     0                    -180269.6198 49100.5830   127%     -   26s
H    0     0                    -177654.7549 49100.5830   128%     -   27s
H    0     0                    -177556.4051 49100.5830   128%     -   27s
H    0     0                    -177463.2011 49100.5830   128%     -   29s
H    0     0                    -44548.72900 49100.5830   210%     -   29s
H    0     0                    7774.1113958 49100.5830   532%     -   29s
H    0     0                    13593.761444 49100.5830   261%     -   30s
H    0     0                    13615.900411 49100.5830   261%     -   30s
H    0     0                    13699.693498 49100.5830   258%     -   30s
H    0     0                    13783.197758 49100.5830   256%     -   30s
H    0     0                    13808.949243 49100.5830   256%     -   30s
     0     0 42641.4683    0  232 13808.9492 42641.4683   209%     -  110s
H    0     0                    13871.988822 42639.8664   207%     -  111s
     0     0 42411.5035    0  301 13871.9888 42411.5035   206%     -  131s
     0     0 42397.3418    0  295 13871.9888 42397.3418   206%     -  135s
     0     0 42385.6152    0  293 13871.9888 42385.6152   206%     -  141s
     0     0 42385.3972    0  294 13871.9888 42385.3972   206%     -  141s
     0     0 38803.5634    0  299 13871.9888 38803.5634   180%     -  209s
H    0     0                    18238.452046 38803.5570   113%     -  209s
H    0     0                    18336.631487 38803.5570   112%     -  210s
H    0     0                    18828.426053 38803.5570   106%     -  210s
H    0     0                    18828.834626 38803.5570   106%     -  210s
H    0     0                    18969.070153 38803.5570   105%     -  210s
     0     0 38400.8736    0  380 18969.0702 38400.8736   102%     -  241s
     0     0 38224.8873    0  404 18969.0702 38224.8873   102%     -  260s
     0     0 38111.1514    0  409 18969.0702 38111.1514   101%     -  275s
     0     0 37819.0114    0  376 18969.0702 37819.0114  99.4%     -  296s
     0     0 37724.0690    0  366 18969.0702 37724.0690  98.9%     -  306s
     0     0 37714.9470    0  359 18969.0702 37714.9470  98.8%     -  311s
     0     0 37710.8781    0  375 18969.0702 37710.8781  98.8%     -  314s
     0     0 37710.5519    0  375 18969.0702 37710.5519  98.8%     -  314s
     0     0 35633.9350    0  353 18969.0702 35633.9350  87.9%     -  375s
     0     0 35055.3316    0  389 18969.0702 35055.3316  84.8%     -  416s
     0     0 34882.2158    0  410 18969.0702 34882.2158  83.9%     -  440s
     0     0 34815.4236    0  421 18969.0702 34815.4236  83.5%     -  454s
     0     0 34756.6010    0  459 18969.0702 34756.6010  83.2%     -  467s
     0     0 34728.2955    0  463 18969.0702 34728.2955  83.1%     -  475s
     0     0 34695.5279    0  454 18969.0702 34695.5279  82.9%     -  485s
     0     0 34659.8734    0  517 18969.0702 34659.8734  82.7%     -  492s
     0     0 34555.8739    0  458 18969.0702 34555.8739  82.2%     -  507s
     0     0 34535.4719    0  459 18969.0702 34535.4719  82.1%     -  518s
     0     0 34532.1026    0  460 18969.0702 34532.1026  82.0%     -  526s
     0     0 34430.0587    0  506 18969.0702 34430.0587  81.5%     -  538s
     0     0 34406.4858    0  504 18969.0702 34406.4858  81.4%     -  544s
     0     0 34397.0245    0  439 18969.0702 34397.0245  81.3%     -  551s
     0     0 34392.6464    0  504 18969.0702 34392.6464  81.3%     -  556s
     0     0 34389.7810    0  503 18969.0702 34389.7810  81.3%     -  560s
     0     0 34387.9857    0  502 18969.0702 34387.9857  81.3%     -  562s
     0     0 34387.8912    0  506 18969.0702 34387.8912  81.3%     -  563s
     0     0 33159.2777    0  489 18969.0702 33159.2777  74.8%     -  628s
H    0     0                    18976.100569 33159.2751  74.7%     -  630s
     0     0 32988.9892    0  488 18976.1006 32988.9892  73.8%     -  643s
     0     0 32909.7102    0  446 18976.1006 32909.7102  73.4%     -  650s
     0     0 32841.7488    0  550 18976.1006 32841.7488  73.1%     -  660s
     0     0 32795.6200    0  549 18976.1006 32795.6200  72.8%     -  671s
     0     0 32776.7766    0  489 18976.1006 32776.7766  72.7%     -  676s
     0     0 32772.5693    0  488 18976.1006 32772.5693  72.7%     -  679s
     0     0 32769.7913    0  496 18976.1006 32769.7913  72.7%     -  682s
     0     0 32764.9841    0  491 18976.1006 32764.9841  72.7%     -  683s
     0     0 32763.8605    0  495 18976.1006 32763.8605  72.7%     -  685s
     0     0 32516.2164    0  498 18976.1006 32516.2164  71.4%     -  702s
     0     0 32479.4683    0  437 18976.1006 32479.4683  71.2%     -  711s
     0     0 32443.6894    0  454 18976.1006 32443.6894  71.0%     -  721s
     0     0 32427.3171    0  455 18976.1006 32427.3171  70.9%     -  728s
     0     0 32410.7034    0  522 18976.1006 32410.7034  70.8%     -  733s
     0     0 32389.7449    0  524 18976.1006 32389.7449  70.7%     -  738s
     0     0 32313.3675    0  515 18976.1006 32313.3675  70.3%     -  744s
     0     0 32288.2763    0  519 18976.1006 32288.2763  70.2%     -  749s
     0     0 32279.3129    0  521 18976.1006 32279.3129  70.1%     -  753s
     0     0 32277.3861    0  525 18976.1006 32277.3861  70.1%     -  755s
     0     0 32113.8760    0  440 18976.1006 32113.8760  69.2%     -  770s
     0     0 32059.6000    0  446 18976.1006 32059.6000  68.9%     -  781s
     0     0 32045.2922    0  448 18976.1006 32045.2922  68.9%     -  788s
     0     0 32038.7642    0  454 18976.1006 32038.7642  68.8%     -  793s
     0     0 32037.3347    0  463 18976.1006 32037.3347  68.8%     -  795s
     0     0 31948.0093    0  512 18976.1006 31948.0093  68.4%     -  809s
     0     0 31928.3952    0  515 18976.1006 31928.3952  68.3%     -  815s
     0     0 31912.0362    0  458 18976.1006 31912.0362  68.2%     -  821s
     0     0 31900.1261    0  516 18976.1006 31900.1261  68.1%     -  825s
     0     0 31893.9759    0  473 18976.1006 31893.9759  68.1%     -  830s
     0     0 31892.0647    0  469 18976.1006 31892.0647  68.1%     -  832s
     0     0 31821.5567    0  449 18976.1006 31821.5567  67.7%     -  840s
     0     0 31774.3695    0  508 18976.1006 31774.3695  67.4%     -  850s
     0     0 31767.0542    0  559 18976.1006 31767.0542  67.4%     -  855s
     0     0 31764.6446    0  519 18976.1006 31764.6446  67.4%     -  857s
     0     0 31763.3034    0  460 18976.1006 31763.3034  67.4%     -  859s
     0     0 31714.6348    0  504 18976.1006 31714.6348  67.1%     -  870s
     0     0 31710.1689    0  507 18976.1006 31710.1689  67.1%     -  872s
     0     0 31707.4655    0  444 18976.1006 31707.4655  67.1%     -  874s
     0     0 31694.7774    0  454 18976.1006 31694.7774  67.0%     -  877s
     0     0 31690.0697    0  556 18976.1006 31690.0697  67.0%     -  882s
     0     0 31688.1908    0  515 18976.1006 31688.1908  67.0%     -  885s
     0     0 31665.6834    0  565 18976.1006 31665.6834  66.9%     -  894s
H    0     0                    19040.817443 31665.4544  66.3%     -  899s
     0     0 31660.7906    0  572 19040.8174 31660.7906  66.3%     -  903s
     0     0 31656.9947    0  518 19040.8174 31656.9947  66.3%     -  906s
     0     0 31655.4945    0  459 19040.8174 31655.4945  66.3%     -  908s
     0     0 31639.1957    0  509 19040.8174 31639.1957  66.2%     -  915s
     0     0 31635.2915    0  517 19040.8174 31635.2915  66.1%     -  919s
     0     0 31633.0867    0  526 19040.8174 31633.0867  66.1%     -  920s
     0     0 31628.2842    0  406 19040.8174 31628.2842  66.1%     -  925s
H    0     0                    19139.181049 31628.0525  65.3%     -  928s
H    0     0                    19191.924324 31628.0525  64.8%     -  929s
     0     0 31625.8326    0  460 19191.9243 31625.8326  64.8%     -  933s
     0     0 31623.7743    0  400 19191.9243 31623.7743  64.8%     -  935s
     0     0 31622.8967    0  391 19191.9243 31622.8967  64.8%     -  937s
     0     0 31622.0135    0  393 19191.9243 31622.0135  64.8%     -  939s
     0     0 31622.0037    0  395 19191.9243 31622.0037  64.8%     -  942s
H    0     0                    19319.279549 31621.8523  63.7%     -  947s
H    0     0                    19425.853483 31621.8523  62.8%     -  948s
H    0     0                    19487.237082 31621.8523  62.3%     -  949s
     0     0 31621.8523    0  391 19487.2371 31621.8523  62.3%     -  950s
     0     0 31621.3762    0  393 19487.2371 31621.3762  62.3%     -  953s
     0     0 31620.6741    0  393 19487.2371 31620.6741  62.3%     -  961s
H    0     0                    19623.415562 31620.6741  61.1%     - 1145s
     0     2 31620.6741    0  393 19623.4156 31620.6741  61.1%     - 1148s
     1     3 30501.4432    1  404 19623.4156 31616.0498  61.1% 25889 1179s
     2     4 31200.7671    1  495 19623.4156 31200.7671  59.0% 25570 1191s
     3     5 28637.7051    2  416 19623.4156 31200.2688  59.0% 25632 1228s
     4    10 28541.5797    3  360 19623.4156 31200.2688  59.0% 21977 1248s
     9    17 28277.4320    4  415 19623.4156 30732.6671  56.6% 16032 1301s
    16    33 29228.9883    4  485 19623.4156 30731.9023  56.6% 22657 1352s
    32    48 28877.1395    5  435 19623.4156 30511.9274  55.5% 24115 1451s
    47    73 27356.7668    6  427 19623.4156 30511.9274  55.5% 29604 1514s
H   64    73                    19623.463209 30511.9274  55.5% 25073 1514s
H   69    73                    19632.393934 30511.9274  55.4% 24009 1514s
H   70    73                    19667.218184 30511.9274  55.1% 23845 1514s
    76   179 27348.5087    7  416 19667.2182 30511.9274  55.1% 22624 1580s
   188   230 26999.2757   10  417 19667.2182 30511.9274  55.1% 14227 1615s
   267   252 26961.3681   11  411 19667.2182 30511.9274  55.1% 12246 1647s
   315   287 27306.3260   10  395 19667.2182 30511.9274  55.1% 11566 1676s
   358   322 26681.8977   12  396 19667.2182 30511.9274  55.1% 11287 1709s
   404   358 26390.5305   13  394 19667.2182 30511.9274  55.1% 11684 1747s
   446   393 20166.4341   14  250 19667.2182 30511.9274  55.1% 11221 1777s
   489   421     cutoff   15      19667.2182 30511.9274  55.1% 11299 1805s
   526   454     cutoff   18      19667.2182 30511.9274  55.1% 11386 1836s
   575   495 infeasible   14      19667.2182 30511.9274  55.1% 11142 1862s
   632   563 25683.5723   15  394 19667.2182 30511.9274  55.1% 10752 1889s
   724   622 22897.3169   31  366 19667.2182 30511.9274  55.1% 10356 1913s
   817   699 22896.3629   32  365 19667.2182 30511.9274  55.1%  9737 1938s
   930   760 22788.3230   35  423 19667.2182 30511.9274  55.1%  9017 1959s
  1016   794 22732.3063   36  426 19667.2182 30511.9274  55.1%  8568 1980s
  1095   827 22653.8940   37  417 19667.2182 30511.9274  55.1%  8174 2007s
  1186   812 22007.8407   38  414 19667.2182 30511.9274  55.1%  7868 2034s
  1260   821 22251.4167   37  408 19667.2182 30511.9274  55.1%  7673 2062s
  1303   838 infeasible   38      19667.2182 30511.9274  55.1%  7684 2094s
  1352   865 22170.6134   37  478 19667.2182 30511.9274  55.1%  7732 2122s
  1424   919 21537.0009   38  477 19667.2182 30511.9274  55.1%  7695 2152s
  1504   997 21496.1650   39  463 19667.2182 30511.9274  55.1%  7640 2185s
  1600  1072 21493.1994   40  467 19667.2182 30511.9274  55.1%  7575 2220s
  1720  1084 21410.2363   41  393 19667.2182 30511.9274  55.1%  7400 2255s
  1840  1096 21161.6542   42  353 19667.2182 30511.9274  55.1%  7225 2293s
  1924  1138 20878.5685   43  349 19667.2182 30511.9274  55.1%  7255 2329s
  2017  1154 20694.4654   46  500 19667.2182 30080.7443  52.9%  7323 2364s
  2053  1179 infeasible   47      19667.2182 30080.6862  52.9%  7375 2400s
  2096  1212     cutoff   18      19667.2182 30080.6862  52.9%  7509 2443s
  2143  1247 28939.5441    8  421 19667.2182 30080.6862  52.9%  7576 2477s
  2222  1274 23172.1584   32  400 19667.2182 30080.6862  52.9%  7579 2517s
  2313  1320 23130.1406   33  403 19667.2182 30080.6862  52.9%  7639 2557s
  2399  1366 23039.4303   34  394 19667.2182 30080.6862  52.9%  7757 2600s
  2461  1423 22832.5180   35  392 19667.2182 30080.6862  52.9%  7935 2643s
  2526  1444 22608.4314   36  342 19667.2182 30080.6862  52.9%  8031 2687s
  2565  1478 22572.3010   37  426 19667.2182 30080.6862  52.9%  8142 2732s
  2607  1529 22559.3120   38  431 19667.2182 30080.6862  52.9%  8246 2772s
  2674  1576 22520.4397   39  446 19667.2182 30080.6862  52.9%  8335 2824s
  2771  1637 22353.6361   42  382 19667.2182 30080.6862  52.9%  8471 2878s
  2848  1727 21825.7298   46  435 19667.2182 30080.6862  52.9%  8647 2925s
  2958  1756 21280.2246   53  411 19667.2182 30080.6862  52.9%  8754 2974s
  2995  1868 21194.7228   54  447 19667.2182 30080.6862  52.9%  8826 3029s
  3129  2045 20886.8828   65  319 19667.2182 30080.6862  52.9%  8837 3087s
  3340  2157 19984.4277   85  287 19667.2182 29166.4416  48.3%  8775 3147s
  3553  2214     cutoff   75      19667.2182 29166.4416  48.3%  8737 3209s
  3692  2288 20577.6248   53  145 19667.2182 28953.1247  47.2%  8862 3284s
  3834  2359 22793.8925    9  298 19667.2182 28953.1247  47.2%  9039 3361s
  3959  2428 20885.2261   10  269 19667.2182 28953.1247  47.2%  9257 3436s

Cutting planes:
  Learned: 7
  Implied bound: 316
  MIR: 3758
  Flow cover: 5033
  RLT: 73
  Relax-and-lift: 753

Explored 4112 nodes (39510912 simplex iterations) in 3600.03 seconds (9274.72 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 19667.2 19632.4 19623.5 ... 19040.8

Time limit reached
Best objective 1.966721818386e+04, best bound 2.895312468491e+04, gap 47.2151%
  WARNING: Time limit reached. Using best solution found (gap: 47.22%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = 19667.22, θ = 142535.44
  Upper Bound (UB) = 19667.22

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 142535.44
  [DEBUG]   ✓ Scenario 0: θ = 142535.44 ≤ Q = 142535.44 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 142535.44 ≤ Q = 142535.44 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 142535.44 ≤ Q = 142535.44 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 142535.44 ≤ Q = 142535.44 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 142535.44 ≤ Q = 142535.44 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 142535.44 ≤ Q = 142535.44 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 142535.44 ≤ Q = 142535.44 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 142535.44 ≤ Q = 142535.44 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 142535.44 ≤ Q = 142535.44 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 142535.44 ≤ Q = 142535.44 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 142535.44 ≤ Q = 142535.44 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 142535.44 ≤ Q = 142535.44 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 142535.44 ≤ Q = 142535.44 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 142535.44 ≤ Q = 142535.44 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 142535.44 ≤ Q = 142535.44 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 142535.44 ≤ Q = 142535.44 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 142535.44 ≤ Q = 142535.44 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 142535.44 ≤ Q = 142535.44 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 142535.44 ≤ Q = 142535.44 (slack: 0.00)
  [DEBUG]   ✓ Scenario 19: θ = 142535.44 ≤ Q = 142535.44 (slack: -0.00)
  [DEBUG]   ✓ Scenario 20: θ = 142535.44 ≤ Q = 142535.44 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 21] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x6c7e52bb
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x9381ad45
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.457366e+13
Presolve removed 2571 rows and 1864 columns
Presolve time: 0.00s
Presolved: 522 rows, 525 columns, 1472 nonzeros
Found heuristic solution: objective 7783613.3140
Variable types: 355 continuous, 170 integer (170 binary)

Root relaxation: objective -1.354349e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -135434.90    0  124 7783613.31 -135434.90   102%     -    0s
H    0     0                    -100491.9041 -135434.90  34.8%     -    0s
H    0     0                    -101044.8112 -135434.90  34.0%     -    0s
     0     0 -108909.02    0   84 -101044.81 -108909.02  7.78%     -    0s
H    0     0                    -104516.2509 -108882.32  4.18%     -    0s
H    0     0                    -104826.3730 -108882.32  3.87%     -    0s
H    0     0                    -105439.0597 -108882.32  3.27%     -    0s
H    0     0                    -105749.1817 -108882.32  2.96%     -    0s
     0     0 -108178.42    0   85 -105749.18 -108178.42  2.30%     -    0s
     0     0 -107741.13    0   89 -105749.18 -107741.13  1.88%     -    0s
H    0     0                    -105950.1978 -107732.84  1.68%     -    0s
     0     0 -107732.84    0   89 -105950.20 -107732.84  1.68%     -    0s
     0     0 -107475.18    0   87 -105950.20 -107475.18  1.44%     -    0s
     0     0 -107445.67    0   87 -105950.20 -107445.67  1.41%     -    0s
     0     0 -107252.75    0   58 -105950.20 -107252.75  1.23%     -    0s
H    0     0                    -106701.2381 -107247.31  0.51%     -    0s
     0     0 -107227.75    0   70 -106701.24 -107227.75  0.49%     -    0s
     0     0 -107225.23    0   73 -106701.24 -107225.23  0.49%     -    0s
     0     0 -106986.77    0   16 -106701.24 -106986.77  0.27%     -    0s
H    0     0                    -106704.6086 -106961.41  0.24%     -    0s
     0     0 -106961.41    0   16 -106704.61 -106961.41  0.24%     -    0s
     0     0 -106934.91    0   16 -106704.61 -106934.91  0.22%     -    0s
     0     0 -106934.29    0   15 -106704.61 -106934.29  0.22%     -    0s
     0     0 -106913.15    0   13 -106704.61 -106913.15  0.20%     -    0s
     0     0 -106913.15    0   13 -106704.61 -106913.15  0.20%     -    0s
H    0     0                    -106706.9678 -106913.15  0.19%     -    0s
     0     0 -106913.15    0   75 -106706.97 -106913.15  0.19%     -    0s
     0     0 -106913.15    0   43 -106706.97 -106913.15  0.19%     -    0s
     0     0 -106913.15    0   10 -106706.97 -106913.15  0.19%     -    0s
     0     0 -106868.59    0    4 -106706.97 -106868.59  0.15%     -    0s
     0     0 -106864.10    0    2 -106706.97 -106864.10  0.15%     -    0s
*    0     0               0    -106855.8726 -106855.87  0.00%     -    0s

Cutting planes:
  Gomory: 15
  Implied bound: 4
  MIR: 80
  Flow cover: 4

Explored 1 nodes (1032 simplex iterations) in 0.10 seconds (0.07 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -106856 -106856 -106707 ... -100492
No other solutions better than -106856

Optimal solution found (tolerance 1.00e-04)
Best objective -1.068558725972e+05, best bound -1.068558725972e+05, gap 0.0000%
  Subproblem solved in 0.12s
  Worst-case operational profit (Z_SP) = 139779.77
  Scenario: 15 demand increases, 45 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -106855.87
  [DEBUG]   S×d_nominal = 246635.65
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 246635.65 + -106855.87 = 139779.77
  [DEBUG]   Current θ from Master = 142535.44
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2755.67 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 16911.55
  Lower Bound (LB) = 19157.49
  Gap (UB-LB) = 509.7258, Absolute Gap = 509.7258, Relative Gap = 0.025918
  Not converged yet (gap = 509.73 > ε = 200)

  [DEBUG] Adding NEW scenario 21 to Master Problem...
  [DEBUG] New scenario pattern: 15 increases, 45 decreases
    [DEBUG] Scenario 21 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 21 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 21]
    [DEBUG]   - Total constraints in model: 337763
    [DEBUG]   - Total variables in model: 139540
  [DEBUG] Total scenarios in Master: 22
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 22
================================================================================
[Iteration 22] Solving Master Problem...
  Current scenarios in Master: 22
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 337763 rows, 139540 columns and 956931 nonzeros
Model fingerprint: 0x4ddb85a1
Variable types: 137281 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 144650 rows and 58740 columns
Presolve time: 4.02s
Presolved: 193113 rows, 80800 columns, 1187884 nonzeros
Variable types: 78541 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -366999.6780
Found heuristic solution: objective -194531.7474

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.61s

Barrier statistics:
 Dense cols : 1181
 AA' NZ     : 4.664e+06
 Factor NZ  : 1.320e+07 (roughly 200 MB of memory)
 Factor Ops : 4.713e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.83253102e+07  2.97712624e+08  1.05e+05 1.73e+01  7.27e+04     8s
   1  -1.41404902e+07  2.55394608e+08  7.44e+04 5.65e+01  5.13e+04     8s
   2  -5.71547275e+06  2.00991710e+08  2.94e+04 1.33e+00  2.11e+04     8s
   3  -1.24795398e+06  1.49072533e+08  3.96e+03 1.74e+00  3.12e+03     8s
   4  -5.98235224e+05  1.20616955e+08  6.79e+02 1.01e+00  7.91e+02     8s
   5  -5.49606475e+05  7.94629980e+07  5.04e+02 5.64e-01  5.31e+02     8s
   6  -4.84109164e+05  5.11135462e+07  3.04e+02 3.06e-01  3.15e+02     8s
   7  -3.91673361e+05  3.93336848e+07  1.06e+02 2.20e-01  1.68e+02     8s
   8  -3.37562451e+05  2.58496608e+07  4.87e+01 1.34e-01  9.62e+01     8s
   9  -2.08596977e+05  1.80425457e+07  1.04e+01 8.78e-02  5.58e+01     8s
  10  -1.24134187e+05  8.69944243e+06  3.47e+00 3.93e-02  2.58e+01     8s
  11  -1.10992179e+05  6.04301245e+06  2.56e+00 2.72e-02  1.79e+01     8s
  12  -1.04540306e+05  4.04854248e+06  2.21e+00 1.81e-02  1.20e+01     8s
  13  -8.71326275e+04  3.14818154e+06  1.46e+00 1.40e-02  9.33e+00     9s
  14  -7.66977732e+04  2.10443083e+06  1.08e+00 9.29e-03  6.27e+00     9s
  15  -4.40110738e+04  7.94597412e+05  3.34e-01 3.19e-03  2.40e+00     9s
  16  -1.61386819e+04  3.38440573e+05  1.36e-01 1.29e-03  1.01e+00     9s
  17  -1.85209103e+03  2.30619285e+05  8.76e-02 1.82e-03  6.62e-01     9s
  18   4.07726678e+03  1.95969988e+05  7.53e-02 1.19e-03  5.47e-01     9s
  19   1.26875416e+04  1.65051905e+05  5.67e-02 1.38e-03  4.34e-01     9s
  20   1.64225754e+04  1.39346781e+05  4.91e-02 1.49e-03  3.50e-01     9s
  21   2.07556448e+04  1.15605354e+05  4.05e-02 1.32e-03  2.70e-01     9s
  22   2.45746133e+04  9.14427040e+04  3.38e-02 2.28e-03  1.91e-01     9s
  23   2.87186022e+04  7.85441170e+04  2.68e-02 1.61e-03  1.42e-01     9s
  24   3.05944910e+04  7.00842145e+04  2.39e-02 1.22e-03  1.13e-01     9s
  25   3.22754481e+04  6.53814389e+04  2.15e-02 9.48e-04  9.44e-02     9s
  26   3.40014940e+04  6.38306651e+04  1.90e-02 8.61e-04  8.50e-02    10s
  27   3.71969199e+04  5.95271843e+04  1.46e-02 5.92e-04  6.37e-02    10s
  28   3.86182900e+04  5.75525505e+04  1.27e-02 4.84e-04  5.40e-02    10s
  29   4.11350083e+04  5.47000001e+04  9.45e-03 3.18e-04  3.87e-02    10s
  30   4.22417788e+04  5.29995446e+04  8.04e-03 2.18e-04  3.07e-02    10s
  31   4.33795049e+04  5.26071751e+04  6.65e-03 1.96e-04  2.63e-02    10s
  32   4.40133296e+04  5.17990443e+04  5.87e-03 2.10e-04  2.22e-02    10s
  33   4.51663832e+04  5.12932930e+04  4.51e-03 1.77e-04  1.75e-02    10s
  34   4.57635151e+04  5.07886357e+04  3.82e-03 1.31e-04  1.43e-02    10s
  35   4.60110165e+04  5.03918269e+04  3.52e-03 1.19e-04  1.25e-02    10s
  36   4.67022353e+04  5.01532802e+04  2.70e-03 9.67e-05  9.84e-03    10s
  37   4.73897388e+04  5.00832868e+04  1.90e-03 9.01e-05  7.68e-03    11s
  38   4.75243458e+04  4.99605594e+04  1.75e-03 7.71e-05  6.95e-03    11s
  39   4.80313351e+04  4.95317433e+04  1.16e-03 5.49e-05  4.28e-03    11s
  40   4.85257947e+04  4.94726483e+04  6.26e-04 4.57e-05  2.70e-03    11s
  41   4.86926328e+04  4.94183596e+04  4.35e-04 3.92e-05  2.07e-03    11s
  42   4.87023051e+04  4.93251209e+04  4.24e-04 2.78e-05  1.78e-03    11s
  43   4.87975916e+04  4.92511434e+04  3.22e-04 1.84e-05  1.29e-03    11s
  44   4.89209754e+04  4.92260798e+04  1.87e-04 1.52e-05  8.70e-04    11s
  45   4.89820410e+04  4.91579064e+04  1.21e-04 6.89e-06  5.01e-04    11s
  46   4.89956129e+04  4.91377138e+04  1.06e-04 4.42e-06  4.05e-04    11s
  47   4.90022557e+04  4.91298437e+04  9.88e-05 3.37e-06  3.64e-04    12s
  48   4.90170325e+04  4.91224149e+04  8.32e-05 2.52e-06  3.01e-04    12s
  49   4.90664952e+04  4.91083046e+04  3.05e-05 2.52e-06  1.19e-04    12s
  50   4.90975576e+04  4.91018887e+04  1.96e-06 1.96e-06  1.23e-05    12s
  51   4.91003819e+04  4.91006059e+04  1.23e-07 4.25e-07  6.39e-07    12s
  52   4.91005830e+04  4.91005830e+04  1.49e-09 1.35e-08  2.29e-10    12s

Barrier solved model in 52 iterations and 12.03 seconds (19.28 work units)
Optimal objective 4.91005830e+04


Root crossover log...

  172006 DPushes remaining with DInf 0.0000000e+00                12s
   59685 DPushes remaining with DInf 0.0000000e+00                15s
   16987 DPushes remaining with DInf 0.0000000e+00                20s
     540 DPushes remaining with DInf 0.0000000e+00                25s
       0 DPushes remaining with DInf 0.0000000e+00                26s

    7001 PPushes remaining with PInf 6.0765726e-05                26s
       0 PPushes remaining with PInf 0.0000000e+00                27s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.7723289e+00     27s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   85628    4.9100583e+04   0.000000e+00   2.772329e+00     27s
   85635    4.9100583e+04   0.000000e+00   0.000000e+00     27s
   85635    4.9100583e+04   0.000000e+00   0.000000e+00     27s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 4.910058e+04, 85635 iterations, 21.87 seconds (35.24 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 49100.5830    0  177 -194531.75 49100.5830   125%     -   27s
H    0     0                    -143910.9635 49100.5830   134%     -   28s
H    0     0                    -140632.4938 49100.5830   135%     -   29s
H    0     0                    -44548.72900 49100.5830   210%     -   29s
H    0     0                    -44513.04802 49100.5830   210%     -   29s
H    0     0                    10909.087790 49100.5830   350%     -   29s
H    0     0                    12972.744130 49100.5830   278%     -   30s
H    0     0                    13401.699378 49100.5830   266%     -   31s
H    0     0                    13483.207565 49100.5830   264%     -   31s
H    0     0                    13559.909665 49100.5830   262%     -   31s
H    0     0                    13698.476644 49100.5830   258%     -   31s
H    0     0                    13721.474214 49100.5830   258%     -   31s
H    0     0                    13808.949243 49100.5830   256%     -   31s
     0     0 42546.2600    0  308 13808.9492 42546.2600   208%     -  116s
H    0     0                    13832.106521 42544.0837   208%     -  118s
     0     0 42248.1909    0  308 13832.1065 42248.1909   205%     -  163s
     0     0 42109.1165    0  302 13832.1065 42109.1165   204%     -  177s
     0     0 42102.4709    0  302 13832.1065 42102.4709   204%     -  183s
     0     0 42101.6093    0  304 13832.1065 42101.6093   204%     -  184s
     0     0 42101.5886    0  304 13832.1065 42101.5886   204%     -  184s
     0     0 39146.0408    0  391 13832.1065 39146.0408   183%     -  266s
H    0     0                    17784.202021 39145.7922   120%     -  267s
H    0     0                    18638.992009 39145.7922   110%     -  267s
H    0     0                    18729.669315 39145.7922   109%     -  268s
     0     0 38587.9394    0  377 18729.6693 38587.9394   106%     -  319s
     0     0 38462.9314    0  382 18729.6693 38462.9314   105%     -  349s
     0     0 38452.1621    0  381 18729.6693 38452.1621   105%     -  364s
     0     0 38415.9009    0  375 18729.6693 38415.9009   105%     -  379s
     0     0 38410.7302    0  380 18729.6693 38410.7302   105%     -  386s
     0     0 38408.8649    0  382 18729.6693 38408.8649   105%     -  390s
     0     0 38337.3945    0  353 18729.6693 38337.3945   105%     -  404s
     0     0 38323.7825    0  360 18729.6693 38323.7825   105%     -  414s
     0     0 38298.1832    0  369 18729.6693 38298.1832   104%     -  423s
     0     0 38278.3826    0  363 18729.6693 38278.3826   104%     -  432s
     0     0 38275.4838    0  365 18729.6693 38275.4838   104%     -  435s
     0     0 38275.3531    0  365 18729.6693 38275.3531   104%     -  437s
     0     0 35955.8638    0  398 18729.6693 35955.8638  92.0%     -  563s
H    0     0                    18809.538658 35955.6826  91.2%     -  564s
     0     0 35501.7356    0  488 18809.5387 35501.7356  88.7%     -  602s
     0     0 35230.6527    0  465 18809.5387 35230.6527  87.3%     -  647s
     0     0 35139.2732    0  434 18809.5387 35139.2732  86.8%     -  666s
     0     0 35095.0960    0  441 18809.5387 35095.0960  86.6%     -  680s
     0     0 34998.2582    0  465 18809.5387 34998.2582  86.1%     -  701s
     0     0 34959.7864    0  476 18809.5387 34959.7864  85.9%     -  720s
     0     0 34912.5712    0  509 18809.5387 34912.5712  85.6%     -  735s
     0     0 34838.1126    0  523 18809.5387 34838.1126  85.2%     -  753s
     0     0 34801.6275    0  478 18809.5387 34801.6275  85.0%     -  762s
     0     0 34754.5039    0  461 18809.5387 34754.5039  84.8%     -  777s
     0     0 34726.7693    0  477 18809.5387 34726.7693  84.6%     -  786s
     0     0 34703.6430    0  480 18809.5387 34703.6430  84.5%     -  795s
     0     0 34689.2979    0  493 18809.5387 34689.2979  84.4%     -  802s
     0     0 34681.7627    0  544 18809.5387 34681.7627  84.4%     -  809s
     0     0 34664.1060    0  496 18809.5387 34664.1060  84.3%     -  819s
     0     0 34655.2512    0  487 18809.5387 34655.2512  84.2%     -  826s
     0     0 34642.5396    0  479 18809.5387 34642.5396  84.2%     -  834s
     0     0 34628.2653    0  483 18809.5387 34628.2653  84.1%     -  842s
     0     0 34625.4534    0  484 18809.5387 34625.4534  84.1%     -  845s
     0     0 34618.3587    0  478 18809.5387 34618.3587  84.0%     -  850s
     0     0 34609.9350    0  537 18809.5387 34609.9350  84.0%     -  855s
     0     0 34604.4136    0  541 18809.5387 34604.4136  84.0%     -  860s
     0     0 34602.2914    0  484 18809.5387 34602.2914  84.0%     -  861s
     0     0 34601.2744    0  492 18809.5387 34601.2744  84.0%     -  863s
     0     0 33541.3926    0  413 18809.5387 33541.3926  78.3%     -  932s
H    0     0                    18915.651646 33541.2353  77.3%     -  933s
     0     0 33339.7946    0  464 18915.6516 33339.7946  76.3%     -  965s
     0     0 33261.7246    0  561 18915.6516 33261.7246  75.8%     -  985s
     0     0 33209.1098    0  487 18915.6516 33209.1098  75.6%     - 1002s
     0     0 33167.9523    0  511 18915.6516 33167.9523  75.3%     - 1017s
     0     0 33125.5809    0  449 18915.6516 33125.5809  75.1%     - 1025s
     0     0 33106.1043    0  456 18915.6516 33106.1043  75.0%     - 1033s
     0     0 33103.4238    0  451 18915.6516 33103.4238  75.0%     - 1037s
     0     0 33092.8817    0  449 18915.6516 33092.8817  74.9%     - 1046s
     0     0 33082.7389    0  498 18915.6516 33082.7389  74.9%     - 1054s
     0     0 33071.2697    0  571 18915.6516 33071.2697  74.8%     - 1064s
     0     0 33063.5001    0  451 18915.6516 33063.5001  74.8%     - 1070s
     0     0 33061.9154    0  564 18915.6516 33061.9154  74.8%     - 1075s
     0     0 32796.0187    0  595 18915.6516 32796.0187  73.4%     - 1108s
     0     0 32713.7703    0  427 18915.6516 32713.7703  72.9%     - 1123s
     0     0 32676.4094    0  499 18915.6516 32676.4094  72.7%     - 1136s
     0     0 32654.1793    0  557 18915.6516 32654.1793  72.6%     - 1148s
     0     0 32629.3354    0  553 18915.6516 32629.3354  72.5%     - 1155s
     0     0 32618.5658    0  443 18915.6516 32618.5658  72.4%     - 1161s
     0     0 32545.3727    0  550 18915.6516 32545.3727  72.1%     - 1174s
     0     0 32530.0291    0  488 18915.6516 32530.0291  72.0%     - 1181s
     0     0 32524.9976    0  597 18915.6516 32524.9976  71.9%     - 1186s
     0     0 32520.7400    0  510 18915.6516 32520.7400  71.9%     - 1191s
     0     0 32515.8985    0  551 18915.6516 32515.8985  71.9%     - 1197s
     0     0 32493.4885    0  535 18915.6516 32493.4885  71.8%     - 1204s
     0     0 32490.5426    0  450 18915.6516 32490.5426  71.8%     - 1209s
     0     0 32489.6905    0  443 18915.6516 32489.6905  71.8%     - 1211s
     0     0 32337.8087    0  514 18915.6516 32337.8087  71.0%     - 1238s
     0     0 32288.2027    0  519 18915.6516 32288.2027  70.7%     - 1253s
     0     0 32260.8835    0  548 18915.6516 32260.8835  70.6%     - 1262s
     0     0 32242.9608    0  509 18915.6516 32242.9608  70.5%     - 1271s
     0     0 32219.2861    0  543 18915.6516 32219.2861  70.3%     - 1278s
     0     0 32209.1260    0  549 18915.6516 32209.1260  70.3%     - 1285s
     0     0 32204.5700    0  560 18915.6516 32204.5700  70.3%     - 1289s
     0     0 32201.9001    0  603 18915.6516 32201.9001  70.2%     - 1293s
     0     0 32201.6106    0  560 18915.6516 32201.6106  70.2%     - 1294s
     0     0 32126.6464    0  519 18915.6516 32126.6464  69.8%     - 1310s
     0     0 32095.2993    0  517 18915.6516 32095.2993  69.7%     - 1322s
     0     0 32089.6264    0  453 18915.6516 32089.6264  69.6%     - 1326s
     0     0 32088.0120    0  456 18915.6516 32088.0120  69.6%     - 1328s
     0     0 32041.5778    0  442 18915.6516 32041.5778  69.4%     - 1346s
H    0     0                    18952.624591 32041.5624  69.1%     - 1349s
H    0     0                    18970.747962 32041.5624  68.9%     - 1349s
H    0     0                    18977.034704 32041.5624  68.8%     - 1349s
     0     0 32008.8687    0  613 18977.0347 32008.8687  68.7%     - 1363s
     0     0 31989.2173    0  607 18977.0347 31989.2173  68.6%     - 1372s
     0     0 31985.6467    0  622 18977.0347 31985.6467  68.5%     - 1377s
     0     0 31982.5644    0  516 18977.0347 31982.5644  68.5%     - 1381s
     0     0 31980.9758    0  548 18977.0347 31980.9758  68.5%     - 1383s
     0     0 31952.9841    0  461 18977.0347 31952.9841  68.4%     - 1395s
H    0     0                    19016.332761 31952.3620  68.0%     - 1396s
     0     0 31936.5965    0  458 19016.3328 31936.5965  67.9%     - 1402s
     0     0 31930.8877    0  509 19016.3328 31930.8877  67.9%     - 1409s
     0     0 31913.2590    0  462 19016.3328 31913.2590  67.8%     - 1416s
     0     0 31911.3546    0  458 19016.3328 31911.3546  67.8%     - 1419s
     0     0 31891.4286    0  457 19016.3328 31891.4286  67.7%     - 1429s
     0     0 31887.2381    0  474 19016.3328 31887.2381  67.7%     - 1438s
     0     0 31880.1809    0  501 19016.3328 31880.1809  67.6%     - 1444s
     0     0 31878.9819    0  473 19016.3328 31878.9819  67.6%     - 1447s
     0     0 31865.7509    0  530 19016.3328 31865.7509  67.6%     - 1458s
     0     0 31862.3547    0  465 19016.3328 31862.3547  67.6%     - 1463s
     0     0 31857.3017    0  534 19016.3328 31857.3017  67.5%     - 1468s
     0     0 31850.4981    0  543 19016.3328 31850.4981  67.5%     - 1471s
     0     0 31846.1798    0  474 19016.3328 31846.1798  67.5%     - 1475s
     0     0 31845.2776    0  471 19016.3328 31845.2776  67.5%     - 1476s
     0     0 31828.6135    0  464 19016.3328 31828.6135  67.4%     - 1486s
H    0     0                    19023.363178 31828.2007  67.3%     - 1497s
H    0     0                    19026.864145 31828.2007  67.3%     - 1498s
H    0     0                    19046.253804 31828.2007  67.1%     - 1498s
     0     0 31820.2713    0  540 19046.2538 31820.2713  67.1%     - 1505s
     0     0 31817.7413    0  479 19046.2538 31817.7413  67.1%     - 1508s
     0     0 31816.0982    0  485 19046.2538 31816.0982  67.0%     - 1509s
     0     0 31809.7505    0  481 19046.2538 31809.7505  67.0%     - 1518s
     0     0 31807.5732    0  484 19046.2538 31807.5732  67.0%     - 1523s
     0     0 31805.2888    0  540 19046.2538 31805.2888  67.0%     - 1531s
H    0     0                    19116.467801 31805.2879  66.4%     - 1538s
H    0     0                    19159.357282 31805.2879  66.0%     - 1539s
H    0     0                    19172.710779 31805.2879  65.9%     - 1539s
H    0     0                    19174.541689 31805.2879  65.9%     - 1539s
H    0     0                    19194.506837 31805.2879  65.7%     - 1539s
H    0     0                    19200.686061 31805.2879  65.6%     - 1539s
     0     0 31804.0022    0  558 19200.6861 31804.0022  65.6%     - 1544s
     0     0 31798.4239    0  491 19200.6861 31798.4239  65.6%     - 1550s
     0     0 31793.8837    0  491 19200.6861 31793.8837  65.6%     - 1564s
H    0     0                    19250.403856 31793.8837  65.2%     - 1830s
     0     2 31793.8837    0  491 19250.4039 31793.8837  65.2%     - 1835s
     1     3 30531.4761    1  448 19250.4039 31793.8837  65.2% 26677 1871s
     2     5 30229.6472    2  446 19250.4039 31793.8837  65.2% 17360 1886s
     4     7 28884.9280    3  494 19250.4039 31337.3364  62.8% 20680 1928s
     6    11 31111.2355    2  579 19250.4039 31336.9022  62.8% 17600 1962s
    10    21 28463.9477    3  309 19250.4039 31111.0369  61.6% 19733 2008s
    20    31 27973.5327    4  302 19250.4039 31110.5849  61.6% 28291 2103s
H   30    59                    19315.409188 30761.8051  59.3% 30572 3139s
H   31    59                    19392.937236 30761.8051  58.6% 30171 3139s
H   35    59                    19476.515718 30761.8051  57.9% 29332 3139s
    58    91 29283.7182    5  372 19476.5157 30761.8051  57.9% 45812 3198s
    90   137 29142.9955    6  356 19476.5157 30761.8051  57.9% 39100 3318s
   136   231 28537.6920    7  336 19476.5157 30761.8051  57.9% 29828 3397s
   230   311 28173.3304   11  310 19476.5157 30761.8051  57.9% 21046 3451s
H  259   311                    19504.634855 30761.8051  57.7% 19377 3451s
   310   366 27959.6356   16  310 19504.6349 30761.8051  57.7% 17936 3495s
   365   415 27472.5324   19  243 19504.6349 30761.8051  57.7% 17042 3536s
   414   480 26997.8140   23  244 19504.6349 30761.8051  57.7% 16479 3577s
   479   511     cutoff   28      19504.6349 30761.8051  57.7% 15764 3600s

Cutting planes:
  Learned: 7
  Implied bound: 287
  MIR: 3438
  Flow cover: 4297
  Zero half: 2
  RLT: 71
  Relax-and-lift: 811

Explored 520 nodes (8993515 simplex iterations) in 3600.12 seconds (7186.62 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 19504.6 19476.5 19392.9 ... 19159.4

Time limit reached
Best objective 1.950463485546e+04, best bound 3.076180508671e+04, gap 57.7154%
  WARNING: Time limit reached. Using best solution found (gap: 57.72%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.13s
  Master Objective (UB) = 19504.63, θ = 142184.62
  Upper Bound (UB) = 19504.63

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 142184.62
  [DEBUG]   ✓ Scenario 0: θ = 142184.62 ≤ Q = 142184.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 142184.62 ≤ Q = 142184.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 142184.62 ≤ Q = 142184.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 142184.62 ≤ Q = 142184.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 142184.62 ≤ Q = 142184.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 142184.62 ≤ Q = 142184.62 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 142184.62 ≤ Q = 142184.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 142184.62 ≤ Q = 142184.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 142184.62 ≤ Q = 142184.62 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 142184.62 ≤ Q = 142184.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 142184.62 ≤ Q = 142184.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 142184.62 ≤ Q = 142184.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 142184.62 ≤ Q = 142184.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 142184.62 ≤ Q = 142184.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 142184.62 ≤ Q = 142184.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 142184.62 ≤ Q = 142184.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 142184.62 ≤ Q = 142184.62 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 142184.62 ≤ Q = 142184.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 142184.62 ≤ Q = 142184.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 142184.62 ≤ Q = 142184.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 20: θ = 142184.62 ≤ Q = 142184.62 (slack: 0.00)
  [DEBUG]   ✓ Scenario 21: θ = 142184.62 ≤ Q = 142184.62 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 22] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x22bd0565
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x22bd0565
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.455662e+13
Presolve removed 2571 rows and 1864 columns
Presolve time: 0.01s
Presolved: 522 rows, 525 columns, 1472 nonzeros
Found heuristic solution: objective 7794155.2942
Variable types: 355 continuous, 170 integer (170 binary)

Root relaxation: objective -1.354283e+05, 248 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -135428.32    0  124 7794155.29 -135428.32   102%     -    0s
H    0     0                    -100422.2845 -135428.32  34.9%     -    0s
H    0     0                    -100957.5732 -135428.32  34.1%     -    0s
     0     0 -108564.94    0   84 -100957.57 -108564.94  7.54%     -    0s
H    0     0                    -104366.6515 -108538.23  4.00%     -    0s
H    0     0                    -104676.7736 -108538.23  3.69%     -    0s
H    0     0                    -105400.1752 -108538.23  2.98%     -    0s
H    0     0                    -105710.2973 -108538.23  2.68%     -    0s
     0     0 -107852.10    0   84 -105710.30 -107852.10  2.03%     -    0s
H    0     0                    -105908.4403 -107345.92  1.36%     -    0s
     0     0 -107345.92    0   85 -105908.44 -107345.92  1.36%     -    0s
     0     0 -107335.96    0   85 -105908.44 -107335.96  1.35%     -    0s
     0     0 -107087.38    0   83 -105908.44 -107087.38  1.11%     -    0s
H    0     0                    -106533.2080 -107070.95  0.50%     -    0s
H    0     0                    -106574.7434 -107070.95  0.47%     -    0s
     0     0 -107070.95    0   83 -106574.74 -107070.95  0.47%     -    0s
     0     0 -106886.44    0   16 -106574.74 -106886.44  0.29%     -    0s
     0     0 -106809.18    0   16 -106574.74 -106809.18  0.22%     -    0s
     0     0 -106793.53    0   17 -106574.74 -106793.53  0.21%     -    0s
     0     0 -106708.30    0   10 -106574.74 -106708.30  0.13%     -    0s
H    0     0                    -106669.8686 -106708.22  0.04%     -    0s
     0     0 -106707.76    0   11 -106669.87 -106707.76  0.04%     -    0s
     0     0 -106690.64    0    9 -106669.87 -106690.64  0.02%     -    0s

Cutting planes:
  Gomory: 5
  Implied bound: 2
  MIR: 143
  Flow cover: 6
  RLT: 42
  BQP: 5

Explored 1 nodes (665 simplex iterations) in 0.06 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -106670 -106575 -106533 ... 1.45566e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.066698685737e+05, best bound -1.066803284470e+05, gap 0.0098%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 139467.97
  Scenario: 15 demand increases, 45 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -106669.87
  [DEBUG]   S×d_nominal = 246137.84
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 246137.84 + -106669.87 = 139467.97
  [DEBUG]   Current θ from Master = 142184.62
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2716.65 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 16787.98
  Lower Bound (LB) = 19157.49
  Gap (UB-LB) = 347.1425, Absolute Gap = 347.1425, Relative Gap = 0.017798
  Not converged yet (gap = 347.14 > ε = 200)

  [DEBUG] Adding NEW scenario 22 to Master Problem...
  [DEBUG] New scenario pattern: 15 increases, 45 decreases
    [DEBUG] Scenario 22 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 22 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 22]
    [DEBUG]   - Total constraints in model: 353053
    [DEBUG]   - Total variables in model: 145780
  [DEBUG] Total scenarios in Master: 23
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 23
================================================================================
[Iteration 23] Solving Master Problem...
  Current scenarios in Master: 23
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 353053 rows, 145780 columns and 1000177 nonzeros
Model fingerprint: 0xeb94c861
Variable types: 143521 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 151235 rows and 61415 columns
Presolve time: 4.71s
Presolved: 201818 rows, 84365 columns, 1241363 nonzeros
Variable types: 82106 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -366999.6780
Found heuristic solution: objective -194531.7474

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.59s

Barrier statistics:
 Dense cols : 1180
 AA' NZ     : 5.020e+06
 Factor NZ  : 1.437e+07 (roughly 230 MB of memory)
 Factor Ops : 5.264e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.86740853e+07  3.09066770e+08  1.07e+05 1.74e+01  7.37e+04     7s
   1  -1.44207483e+07  2.65554027e+08  7.58e+04 5.68e+01  5.20e+04     7s
   2  -5.78394516e+06  2.09421962e+08  2.97e+04 9.81e-01  2.12e+04     8s
   3  -1.26650437e+06  1.55444738e+08  3.99e+03 2.94e+00  3.13e+03     8s
   4  -6.08148464e+05  1.26106074e+08  6.95e+02 1.68e+00  8.00e+02     8s
   5  -5.31944220e+05  5.71838339e+07  4.24e+02 4.85e-01  3.98e+02     8s
   6  -4.40607273e+05  4.23386982e+07  1.99e+02 3.36e-01  2.23e+02     8s
   7  -3.39850255e+05  3.26628208e+07  5.80e+01 2.42e-01  1.19e+02     8s
   8  -2.42006445e+05  2.13729583e+07  1.85e+01 1.48e-01  6.63e+01     8s
   9  -1.30980017e+05  1.79808348e+07  5.09e+00 1.22e-01  5.11e+01     8s
  10  -1.13086635e+05  5.91162828e+06  3.81e+00 3.74e-02  1.69e+01     8s
  11  -9.55150099e+04  4.38864392e+06  2.53e+00 2.73e-02  1.25e+01     8s
  12  -7.99956709e+04  3.08394408e+06  1.57e+00 1.90e-02  8.74e+00     8s
  13  -6.79921606e+04  2.02307781e+06  1.02e+00 1.24e-02  5.75e+00     8s
  14  -4.33881359e+04  7.37575759e+05  4.20e-01 4.29e-03  2.14e+00     9s
  15  -1.52575083e+04  3.51294050e+05  1.93e-01 2.14e-03  1.00e+00     9s
  16  -1.02886516e+03  2.12341576e+05  1.27e-01 1.28e-03  5.82e-01     9s
  17   6.26383430e+03  1.75958174e+05  1.05e-01 1.71e-03  4.63e-01     9s
  18   1.57692192e+04  1.50276485e+05  7.52e-02 1.29e-03  3.67e-01     9s
  19   1.96971580e+04  1.18441990e+05  6.38e-02 1.91e-03  2.69e-01     9s
  20   2.33600215e+04  1.04648018e+05  5.43e-02 1.87e-03  2.22e-01     9s
  21   2.64627168e+04  9.11935080e+04  4.61e-02 1.74e-03  1.77e-01     9s
  22   2.86364458e+04  7.78644048e+04  4.06e-02 1.58e-03  1.34e-01     9s
  23   3.21442016e+04  7.20266709e+04  3.26e-02 1.32e-03  1.09e-01     9s
  24   3.43905351e+04  6.71606739e+04  2.75e-02 1.13e-03  8.95e-02     9s
  25   3.78575416e+04  6.47983097e+04  1.99e-02 1.08e-03  7.35e-02     9s
  26   3.94762621e+04  6.20646461e+04  1.66e-02 9.01e-04  6.16e-02    10s
  27   4.06125879e+04  5.83287928e+04  1.43e-02 6.62e-04  4.84e-02    10s
  28   4.19623341e+04  5.55496014e+04  1.18e-02 4.93e-04  3.71e-02    10s
  29   4.32748443e+04  5.37158678e+04  9.43e-03 5.47e-04  2.85e-02    10s
  30   4.40791902e+04  5.24960083e+04  8.03e-03 4.04e-04  2.30e-02    10s
  31   4.56917686e+04  5.17591643e+04  5.32e-03 3.14e-04  1.66e-02    10s
  32   4.63286389e+04  5.08747654e+04  4.27e-03 2.31e-04  1.24e-02    10s
  33   4.65850108e+04  5.06828182e+04  3.85e-03 2.01e-04  1.12e-02    10s
  34   4.72352145e+04  5.02096130e+04  2.81e-03 1.33e-04  8.12e-03    10s
  35   4.78021195e+04  4.98773654e+04  1.95e-03 9.23e-05  5.67e-03    10s
  36   4.83505097e+04  4.96760217e+04  1.09e-03 6.79e-05  3.62e-03    10s
  37   4.86663126e+04  4.95025599e+04  6.12e-04 7.10e-05  2.28e-03    11s
  38   4.86952247e+04  4.92921995e+04  5.70e-04 3.39e-05  1.63e-03    11s
  39   4.88262864e+04  4.92430265e+04  3.72e-04 2.52e-05  1.14e-03    11s
  40   4.89032154e+04  4.91748524e+04  2.68e-04 6.49e-05  7.42e-04    11s
  41   4.89985811e+04  4.91428834e+04  1.36e-04 3.58e-05  3.94e-04    11s
  42   4.90166438e+04  4.91287569e+04  1.11e-04 2.41e-05  3.06e-04    11s
  43   4.90694553e+04  4.91108308e+04  3.94e-05 8.04e-06  1.13e-04    11s
  44   4.90955468e+04  4.91025944e+04  6.16e-06 1.46e-06  1.92e-05    11s
  45   4.91000535e+04  4.91008098e+04  4.95e-07 1.24e-07  2.06e-06    11s
  46   4.91005792e+04  4.91005850e+04  4.67e-09 2.35e-08  1.61e-08    11s
  47   4.91005830e+04  4.91005830e+04  8.65e-10 7.02e-11  2.14e-11    11s

Barrier solved model in 47 iterations and 11.49 seconds (17.62 work units)
Optimal objective 4.91005830e+04


Root crossover log...

  179724 DPushes remaining with DInf 0.0000000e+00                12s
   19635 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                18s

    2722 PPushes remaining with PInf 5.2161624e-06                18s
       0 PPushes remaining with PInf 0.0000000e+00                18s

  Push phase complete: Pinf 0.0000000e+00, Dinf 4.6807851e-01     18s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   74405    4.9100583e+04   0.000000e+00   4.680785e-01     18s
   74407    4.9100583e+04   0.000000e+00   0.000000e+00     18s
   74407    4.9100583e+04   0.000000e+00   0.000000e+00     18s
Concurrent spin time: 7.75s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 4.910058e+04, 74407 iterations, 20.37 seconds (29.29 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 49100.5830    0  177 -194531.75 49100.5830   125%     -   26s
H    0     0                    -89837.72330 49100.5830   155%     -   27s
H    0     0                    -89032.00706 49100.5830   155%     -   27s
H    0     0                    -81455.43541 49100.5830   160%     -   27s
H    0     0                    -80575.95997 49100.5830   161%     -   27s
H    0     0                    -79475.09556 49100.5830   162%     -   27s
H    0     0                    -44548.72900 49100.5830   210%     -   28s
H    0     0                    -13666.52355 49100.5830   459%     -   28s
H    0     0                    6878.3230706 49100.5830   614%     -   29s
H    0     0                    12002.360001 49100.5830   309%     -   29s
H    0     0                    12044.389689 49100.5830   308%     -   29s
H    0     0                    13478.597135 49100.5830   264%     -   29s
H    0     0                    13634.682391 49100.5830   260%     -   29s
H    0     0                    13698.476644 49100.5830   258%     -   29s
H    0     0                    13699.693498 49100.5830   258%     -   29s
H    0     0                    13702.562944 49100.5830   258%     -   29s
H    0     0                    13711.953230 49100.5830   258%     -   30s
H    0     0                    13721.474214 49100.5830   258%     -   30s
H    0     0                    13797.176023 49100.5830   256%     -   30s
H    0     0                    13808.949243 49100.5830   256%     -   30s
     0     0 42624.0000    0  297 13808.9492 42624.0000   209%     -  102s
     0     0 42572.5291    0  295 13808.9492 42572.5291   208%     -  116s
     0     0 42521.4230    0  300 13808.9492 42521.4230   208%     -  121s
     0     0 42520.3690    0  300 13808.9492 42520.3690   208%     -  123s
     0     0 42494.9699    0  302 13808.9492 42494.9699   208%     -  128s
     0     0 42494.9205    0  302 13808.9492 42494.9205   208%     -  131s
     0     0 38903.0090    0  297 13808.9492 38903.0090   182%     -  217s
H    0     0                    17901.337968 38902.9800   117%     -  218s
H    0     0                    18590.800626 38902.9800   109%     -  218s
H    0     0                    18598.309218 38902.9800   109%     -  218s
H    0     0                    18775.615092 38902.9800   107%     -  218s
H    0     0                    18910.926516 38902.9800   106%     -  218s
     0     0 38266.0796    0  324 18910.9265 38266.0796   102%     -  258s
     0     0 38050.1753    0  390 18910.9265 38050.1753   101%     -  285s
     0     0 37921.2101    0  317 18910.9265 37921.2101   101%     -  295s
     0     0 37860.2728    0  380 18910.9265 37860.2728   100%     -  306s
     0     0 37855.9243    0  379 18910.9265 37855.9243   100%     -  310s
     0     0 37790.7596    0  374 18910.9265 37790.7596   100%     -  320s
     0     0 37785.4983    0  372 18910.9265 37785.4983   100%     -  323s
     0     0 37781.1039    0  366 18910.9265 37781.1039   100%     -  325s
     0     0 37777.6984    0  407 18910.9265 37777.6984   100%     -  329s
     0     0 37772.8766    0  408 18910.9265 37772.8766   100%     -  333s
     0     0 37771.4880    0  412 18910.9265 37771.4880   100%     -  335s
     0     0 37771.1370    0  408 18910.9265 37771.1370   100%     -  337s
     0     0 35912.9902    0  341 18910.9265 35912.9902  89.9%     -  400s
     0     0 35284.7949    0  399 18910.9265 35284.7949  86.6%     -  456s
     0     0 35039.1321    0  402 18910.9265 35039.1321  85.3%     -  484s
     0     0 35014.4264    0  403 18910.9265 35014.4264  85.2%     -  497s
     0     0 34944.8800    0  411 18910.9265 34944.8800  84.8%     -  512s
     0     0 34927.7211    0  472 18910.9265 34927.7211  84.7%     -  523s
     0     0 34911.9244    0  471 18910.9265 34911.9244  84.6%     -  532s
     0     0 34893.4728    0  474 18910.9265 34893.4728  84.5%     -  541s
     0     0 34868.2206    0  465 18910.9265 34868.2206  84.4%     -  549s
     0     0 34834.6161    0  471 18910.9265 34834.6161  84.2%     -  556s
     0     0 34798.8682    0  463 18910.9265 34798.8682  84.0%     -  562s
     0     0 34783.8033    0  464 18910.9265 34783.8033  83.9%     -  567s
     0     0 34777.1845    0  470 18910.9265 34777.1845  83.9%     -  573s
     0     0 34666.2980    0  475 18910.9265 34666.2980  83.3%     -  591s
     0     0 34642.4649    0  420 18910.9265 34642.4649  83.2%     -  605s
     0     0 34602.7174    0  481 18910.9265 34602.7174  83.0%     -  616s
     0     0 34564.8085    0  463 18910.9265 34564.8085  82.8%     -  625s
     0     0 34556.8629    0  476 18910.9265 34556.8629  82.7%     -  628s
     0     0 34550.3545    0  482 18910.9265 34550.3545  82.7%     -  632s
     0     0 34549.9499    0  478 18910.9265 34549.9499  82.7%     -  633s
     0     0 33518.1322    0  413 18910.9265 33518.1322  77.2%     -  681s
H    0     0                    18935.925387 33516.9204  77.0%     -  682s
H    0     0                    18942.514172 33516.9204  76.9%     -  682s
     0     0 33162.2856    0  481 18942.5142 33162.2856  75.1%     -  717s
     0     0 33033.2079    0  376 18942.5142 33033.2079  74.4%     -  733s
     0     0 32861.6490    0  460 18942.5142 32861.6490  73.5%     -  755s
     0     0 32819.9362    0  460 18942.5142 32819.9362  73.3%     -  764s
     0     0 32794.2020    0  462 18942.5142 32794.2020  73.1%     -  772s
     0     0 32781.2905    0  469 18942.5142 32781.2905  73.1%     -  778s
     0     0 32747.7463    0  422 18942.5142 32747.7463  72.9%     -  785s
     0     0 32736.4705    0  484 18942.5142 32736.4705  72.8%     -  792s
     0     0 32583.8107    0  471 18942.5142 32583.8107  72.0%     -  811s
     0     0 32530.5526    0  479 18942.5142 32530.5526  71.7%     -  822s
     0     0 32502.6173    0  480 18942.5142 32502.6173  71.6%     -  829s
     0     0 32484.6469    0  481 18942.5142 32484.6469  71.5%     -  835s
     0     0 32480.9440    0  482 18942.5142 32480.9440  71.5%     -  839s
     0     0 32470.0732    0  482 18942.5142 32470.0732  71.4%     -  843s
     0     0 32465.6582    0  482 18942.5142 32465.6582  71.4%     -  845s
     0     0 32443.1565    0  539 18942.5142 32443.1565  71.3%     -  852s
     0     0 32425.4335    0  537 18942.5142 32425.4335  71.2%     -  857s
     0     0 32420.1649    0  549 18942.5142 32420.1649  71.2%     -  859s
     0     0 32403.2129    0  491 18942.5142 32403.2129  71.1%     -  863s
     0     0 32392.5074    0  509 18942.5142 32392.5074  71.0%     -  867s
     0     0 32383.9528    0  504 18942.5142 32383.9528  71.0%     -  871s
     0     0 32373.1311    0  506 18942.5142 32373.1311  70.9%     -  875s
     0     0 32371.3136    0  507 18942.5142 32371.3136  70.9%     -  877s
     0     0 32161.5264    0  465 18942.5142 32161.5264  69.8%     -  895s
H    0     0                    19095.796849 32159.4386  68.4%     -  896s
H    0     0                    19163.992434 32159.4386  67.8%     -  896s
     0     0 32130.3347    0  479 19163.9924 32130.3347  67.7%     -  902s
     0     0 32117.7967    0  483 19163.9924 32117.7967  67.6%     -  908s
     0     0 32109.8705    0  476 19163.9924 32109.8705  67.6%     -  912s
     0     0 32096.8382    0  489 19163.9924 32096.8382  67.5%     -  916s
     0     0 32095.3331    0  489 19163.9924 32095.3331  67.5%     -  919s
     0     0 32010.7525    0  431 19163.9924 32010.7525  67.0%     -  933s
     0     0 31986.3173    0  492 19163.9924 31986.3173  66.9%     -  943s
     0     0 31980.3167    0  495 19163.9924 31980.3167  66.9%     -  947s
     0     0 31978.4611    0  452 19163.9924 31978.4611  66.9%     -  948s
     0     0 31902.5432    0  515 19163.9924 31902.5432  66.5%     -  961s
     0     0 31871.8919    0  521 19163.9924 31871.8919  66.3%     -  968s
     0     0 31860.9213    0  518 19163.9924 31860.9213  66.3%     -  973s
     0     0 31854.7550    0  526 19163.9924 31854.7550  66.2%     -  976s
     0     0 31849.0895    0  469 19163.9924 31849.0895  66.2%     -  980s
     0     0 31847.5650    0  462 19163.9924 31847.5650  66.2%     -  982s
     0     0 31818.1901    0  527 19163.9924 31818.1901  66.0%     -  991s
     0     0 31805.9147    0  512 19163.9924 31805.9147  66.0%     - 1001s
     0     0 31796.4433    0  456 19163.9924 31796.4433  65.9%     - 1005s
     0     0 31793.4637    0  451 19163.9924 31793.4637  65.9%     - 1006s
     0     0 31791.6337    0  456 19163.9924 31791.6337  65.9%     - 1008s
     0     0 31778.1013    0  451 19163.9924 31778.1013  65.8%     - 1014s
     0     0 31763.9911    0  515 19163.9924 31763.9911  65.7%     - 1021s
     0     0 31759.6918    0  527 19163.9924 31759.6918  65.7%     - 1026s
     0     0 31756.9512    0  527 19163.9924 31756.9512  65.7%     - 1027s
     0     0 31746.1791    0  448 19163.9924 31746.1791  65.7%     - 1032s
     0     0 31738.3983    0  454 19163.9924 31738.3983  65.6%     - 1035s
     0     0 31736.9304    0  505 19163.9924 31736.9304  65.6%     - 1038s
     0     0 31710.9077    0  505 19163.9924 31710.9077  65.5%     - 1047s
H    0     0                    19186.275134 31710.4284  65.3%     - 1053s
H    0     0                    19190.721590 31710.4284  65.2%     - 1053s
     0     0 31706.5728    0  466 19190.7216 31706.5728  65.2%     - 1056s
     0     0 31705.1242    0  579 19190.7216 31705.1242  65.2%     - 1059s
     0     0 31699.9580    0  571 19190.7216 31699.9580  65.2%     - 1065s
     0     0 31696.4726    0  570 19190.7216 31696.4726  65.2%     - 1071s
     0     0 31691.7130    0  524 19190.7216 31691.7130  65.1%     - 1075s
     0     0 31690.1727    0  468 19190.7216 31690.1727  65.1%     - 1077s
     0     0 31687.1393    0  523 19190.7216 31687.1393  65.1%     - 1083s
     0     0 31685.7926    0  528 19190.7216 31685.7926  65.1%     - 1094s
     0     0 31679.3682    0  525 19190.7216 31679.3682  65.1%     - 1100s
     0     0 31679.0634    0  525 19190.7216 31679.0634  65.1%     - 1110s
H    0     0                    19427.640586 31678.4519  63.1%     - 1333s
     0     2 31678.4519    0  525 19427.6406 31678.4519  63.1%     - 1337s
     1     3 30126.2751    1  399 19427.6406 31677.4013  63.1% 24260 1377s
     2     4 31263.9832    1  514 19427.6406 31263.9832  60.9% 19386 1395s
     3     6 31112.1135    2  456 19427.6406 31263.8327  60.9% 16662 1421s
     5    10 31010.3698    3  432 19427.6406 31263.8327  60.9% 15737 1458s
     9    18 30554.8332    4  441 19427.6406 31093.1103  60.0% 15379 1502s
    17    36 30457.8824    5  438 19427.6406 31092.4026  60.0% 15955 1555s
    35    50 29324.3923    5  374 19427.6406 30577.0802  57.4% 25761 1651s
    49    77 29070.6927    6  383 19427.6406 30577.0802  57.4% 31120 1719s
    76   116 29017.3486    7  373 19427.6406 30577.0802  57.4% 23612 1785s
H   82   116                    19438.710013 30577.0802  57.3% 22668 1785s
H   86   116                    19446.884531 30577.0802  57.2% 21959 1785s
   115   237 28749.2950    8  373 19446.8845 30577.0802  57.2% 19436 1852s
   238   288 28542.8323   12  298 19446.8845 30577.0802  57.2% 13390 1893s
   289   315 28348.5467   14  286 19446.8845 30577.0802  57.2% 12260 1955s
   316   343 28096.9730   15  289 19446.8845 30577.0802  57.2% 12419 1994s
   344   373 26266.6873   16  338 19446.8845 30577.0802  57.2% 11940 2028s
   374   409 27959.2522   16  335 19446.8845 30577.0802  57.2% 11852 2128s
H  408   409                    19519.608982 30577.0802  56.6% 11376 2128s
   410   498 27755.6182   17  273 19519.6090 30577.0802  56.6% 11372 2172s
   499   588 27646.6924   19  274 19519.6090 30577.0802  56.6% 10655 2204s
   591   654 25299.7838   22  240 19519.6090 30577.0802  56.6% 10375 2233s
   661   684 24117.3528   24  231 19519.6090 30577.0802  56.6% 10194 2291s
   693   773 23711.6519   25  229 19519.6090 30577.0802  56.6% 10230 2321s
   786   852 23449.8601   28  218 19519.6090 30577.0802  56.6%  9923 2345s
   877   933 21865.3272   31  210 19519.6090 30577.0802  56.6%  9602 2369s
   982  1016 21623.3765   33  212 19519.6090 30577.0802  56.6%  9258 2394s
  1085  1083 21194.9635   38  197 19519.6090 30577.0802  56.6%  9076 2426s
  1194  1152 20397.4529   44  176 19519.6090 30577.0802  56.6%  8935 2458s
  1319  1228 19917.6872   50  162 19519.6090 30577.0802  56.6%  8617 2487s
  1431  1243 23827.6402   23  230 19519.6090 30577.0802  56.6%  8536 2540s
  1468  1289 23459.5875   24  196 19519.6090 30577.0802  56.6%  8593 2595s
H 1507  1289                    19524.316192 30577.0802  56.6%  8603 2595s
  1528  1401 23205.2958   25  182 19524.3162 30577.0802  56.6%  8617 2631s
  1683  1495 23074.5516   27  171 19524.3162 30577.0802  56.6%  8355 2668s
  1839  1619 22834.1026   30  174 19524.3162 30577.0802  56.6%  8128 2704s
  2016  1646 22554.9197   34  158 19524.3162 30577.0802  56.6%  7823 2749s
  2121  1689 22458.6178   35  150 19524.3162 30577.0802  56.6%  7783 2785s
  2220  1780 22403.2928   37  206 19524.3162 30577.0802  56.6%  7836 2823s
  2366  1890 22019.2128   40  211 19524.3162 30577.0802  56.6%  7756 2861s
  2536  1897 21933.7913   50  213 19524.3162 30577.0802  56.6%  7619 2920s
  2581  1952 21930.1873   51  219 19524.3162 30577.0802  56.6%  7652 2970s
  2689  1977 21869.5415   52  119 19524.3162 30577.0802  56.6%  7587 3017s
  2791  2042 21783.4330   53  140 19524.3162 30577.0802  56.6%  7681 3065s
  2908  2085 21469.4994   58  137 19524.3162 30577.0802  56.6%  7765 3114s
  3037  2159 20957.0984   66  132 19524.3162 30577.0802  56.6%  7870 3170s
  3179  2234 20488.0237   31  256 19524.3162 30208.7382  54.7%  7930 3222s
  3333  2252 29017.3529    6  427 19524.3162 30148.1068  54.4%  8023 3311s
  3374  2279 29557.7427    6  530 19524.3162 30148.1068  54.4%  8142 3371s
  3421  2306 29476.4010    7  493 19524.3162 30148.1068  54.4%  8262 3425s
  3464  2340 28863.3653    7  395 19524.3162 30148.1068  54.4%  8390 3470s
H 3486  2340                    19537.753941 30148.1068  54.3%  8424 3470s
  3514  2439 21050.3614   18  230 19537.7539 30148.1068  54.3%  8466 3529s
  3663  2496 21940.5112   18  349 19537.7539 30019.1018  53.6%  8583 3590s
  3814  2511 20845.8554   18  201 19537.7539 30019.1018  53.6%  8669 3600s

Cutting planes:
  Learned: 3
  Implied bound: 315
  MIR: 4505
  Flow cover: 5506
  RLT: 72
  Relax-and-lift: 803

Explored 3847 nodes (34156255 simplex iterations) in 3600.09 seconds (9003.66 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 19537.8 19524.3 19519.6 ... 19095.8

Time limit reached
Best objective 1.953775394147e+04, best bound 3.001910184339e+04, gap 53.6466%
  WARNING: Time limit reached. Using best solution found (gap: 53.65%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.13s
  Master Objective (UB) = 19537.75, θ = 141864.86
  Upper Bound (UB) = 19537.75

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 141864.86
  [DEBUG]   ✓ Scenario 0: θ = 141864.86 ≤ Q = 141864.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 141864.86 ≤ Q = 141864.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 141864.86 ≤ Q = 141864.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 141864.86 ≤ Q = 141864.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 141864.86 ≤ Q = 141864.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 141864.86 ≤ Q = 141864.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 141864.86 ≤ Q = 141864.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 141864.86 ≤ Q = 141864.86 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 141864.86 ≤ Q = 141864.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 141864.86 ≤ Q = 141864.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 141864.86 ≤ Q = 141864.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 141864.86 ≤ Q = 141864.86 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 141864.86 ≤ Q = 142024.04 (slack: 159.18)
  [DEBUG]   ✓ Scenario 13: θ = 141864.86 ≤ Q = 141864.86 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 141864.86 ≤ Q = 141864.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 141864.86 ≤ Q = 141864.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 141864.86 ≤ Q = 141864.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 141864.86 ≤ Q = 141864.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 141864.86 ≤ Q = 141864.86 (slack: 0.00)
  [DEBUG]   ✓ Scenario 19: θ = 141864.86 ≤ Q = 141864.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 20: θ = 141864.86 ≤ Q = 141864.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 21: θ = 141864.86 ≤ Q = 141864.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 22: θ = 141864.86 ≤ Q = 141864.86 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 23] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x4097b8c9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x4097b8c9
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.464075e+13
Presolve removed 2571 rows and 1864 columns
Presolve time: 0.00s
Presolved: 522 rows, 525 columns, 1472 nonzeros
Found heuristic solution: objective 7802279.2490
Variable types: 355 continuous, 170 integer (170 binary)

Root relaxation: objective -1.355784e+05, 245 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -135578.42    0  124 7802279.25 -135578.42   102%     -    0s
H    0     0                    -100560.8451 -135578.42  34.8%     -    0s
H    0     0                    -101113.7522 -135578.42  34.1%     -    0s
     0     0 -108112.81    0   95 -101113.75 -108112.81  6.92%     -    0s
H    0     0                    -104959.3295 -107990.42  2.89%     -    0s
H    0     0                    -105522.4663 -107990.42  2.34%     -    0s
     0     0 -107620.98    0   95 -105522.47 -107620.98  1.99%     -    0s
     0     0 -107290.45    0  127 -105522.47 -107290.45  1.68%     -    0s
H    0     0                    -105760.9332 -107278.58  1.43%     -    0s
     0     0 -107278.58    0   99 -105760.93 -107278.58  1.43%     -    0s
     0     0 -107210.84    0   90 -105760.93 -107210.84  1.37%     -    0s
     0     0 -107190.41    0   97 -105760.93 -107190.41  1.35%     -    0s
     0     0 -107073.12    0   92 -105760.93 -107073.12  1.24%     -    0s
     0     0 -107035.63    0   92 -105760.93 -107035.63  1.21%     -    0s
     0     2 -107035.63    0   92 -105760.93 -107035.63  1.21%     -    0s
H  414   379                    -106689.3372 -106756.42  0.06%   6.7    0s
*  735    65              17    -106690.5572 -106709.36  0.02%   5.2    0s
*  740    65              17    -106704.0168 -106709.36  0.01%   5.2    0s

Cutting planes:
  Gomory: 51
  Implied bound: 3
  MIR: 190
  RLT: 1
  BQP: 1

Explored 892 nodes (4489 simplex iterations) in 0.09 seconds (0.08 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -106704 -106691 -106689 ... 1.46407e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.067040167790e+05, best bound -1.067065716628e+05, gap 0.0024%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 139284.06
  Scenario: 10 demand increases, 50 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -106704.02
  [DEBUG]   S×d_nominal = 245988.08
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 245988.08 + -106704.02 = 139284.06
  [DEBUG]   Current θ from Master = 141864.86
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2580.79 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 16956.96
  Lower Bound (LB) = 19157.49
  Gap (UB-LB) = 380.2616, Absolute Gap = 380.2616, Relative Gap = 0.019463
  Not converged yet (gap = 380.26 > ε = 200)

  [DEBUG] Adding NEW scenario 23 to Master Problem...
  [DEBUG] New scenario pattern: 10 increases, 50 decreases
    [DEBUG] Scenario 23 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 23 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 23]
    [DEBUG]   - Total constraints in model: 368343
    [DEBUG]   - Total variables in model: 152020
  [DEBUG] Total scenarios in Master: 24
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 24
================================================================================
[Iteration 24] Solving Master Problem...
  Current scenarios in Master: 24
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 368343 rows, 152020 columns and 1043423 nonzeros
Model fingerprint: 0x78380839
Variable types: 149761 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 157820 rows and 64090 columns
Presolve time: 4.11s
Presolved: 210523 rows, 87930 columns, 1294834 nonzeros
Variable types: 85671 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -368050.8111
Found heuristic solution: objective -194531.7474

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.97s

Barrier statistics:
 Dense cols : 1180
 AA' NZ     : 5.376e+06
 Factor NZ  : 1.506e+07 (roughly 240 MB of memory)
 Factor Ops : 5.411e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.90122165e+07  3.20274327e+08  1.08e+05 1.72e+01  7.47e+04     8s
   1  -1.46927940e+07  2.75530607e+08  7.71e+04 5.71e+01  5.27e+04     8s
   2  -5.86373651e+06  2.17782678e+08  3.01e+04 1.19e+00  2.14e+04     8s
   3  -1.30085687e+06  1.61669320e+08  4.08e+03 1.66e+00  3.18e+03     8s
   4  -6.22001949e+05  1.31213097e+08  7.18e+02 1.05e+00  8.13e+02     8s
   5  -5.45338266e+05  5.90492089e+07  4.33e+02 3.08e-01  4.01e+02     8s
   6  -4.57470687e+05  4.46118871e+07  2.24e+02 2.08e-01  2.38e+02     8s
   7  -3.57997172e+05  3.46682716e+07  7.54e+01 1.49e-01  1.29e+02     8s
   8  -2.63901883e+05  2.34802854e+07  2.81e+01 9.32e-02  7.38e+01     9s
   9  -1.33357093e+05  1.84703566e+07  6.58e+00 7.08e-02  5.10e+01     9s
  10  -1.10988821e+05  9.98286604e+06  4.27e+00 3.70e-02  2.73e+01     9s
  11  -9.98082892e+04  7.71028277e+06  2.97e+00 2.84e-02  2.09e+01     9s
  12  -9.26756291e+04  6.17995680e+06  2.30e+00 2.26e-02  1.67e+01     9s
  13  -8.21878098e+04  4.50766526e+06  1.50e+00 1.63e-02  1.21e+01     9s
  14  -7.04846780e+04  2.44417535e+06  9.30e-01 9.00e-03  6.62e+00     9s
  15  -4.64884839e+04  6.54057067e+05  3.44e-01 2.33e-03  1.84e+00     9s
  16  -1.81283750e+04  3.87686375e+05  1.71e-01 1.52e-03  1.06e+00     9s
  17  -1.91550341e+03  2.60433317e+05  1.11e-01 1.09e-03  6.86e-01     9s
  18   1.15026856e+03  2.04926801e+05  1.02e-01 7.75e-04  5.33e-01     9s
  19   7.04358373e+03  1.60605607e+05  8.52e-02 1.37e-03  4.02e-01     9s
  20   1.40986875e+04  1.34208884e+05  6.96e-02 2.79e-03  3.14e-01     9s
  21   1.69793903e+04  1.06832963e+05  6.31e-02 1.83e-03  2.35e-01    10s
  22   2.21113911e+04  9.34755138e+04  5.18e-02 1.97e-03  1.87e-01    10s
  23   2.59463086e+04  8.07961141e+04  4.33e-02 2.25e-03  1.44e-01    10s
  24   2.80947888e+04  7.37161405e+04  3.87e-02 2.06e-03  1.19e-01    10s
  25   3.09262730e+04  7.00346587e+04  3.30e-02 1.78e-03  1.02e-01    10s
  26   3.28805628e+04  6.41284722e+04  2.89e-02 1.30e-03  8.18e-02    10s
  27   3.59266916e+04  6.23070054e+04  2.28e-02 1.18e-03  6.91e-02    10s
  28   3.75232760e+04  6.00414851e+04  1.98e-02 9.79e-04  5.90e-02    10s
  29   3.88397178e+04  5.83828168e+04  1.73e-02 8.45e-04  5.12e-02    10s
  30   3.99566452e+04  5.67347812e+04  1.52e-02 6.99e-04  4.39e-02    10s
  31   4.22131553e+04  5.51746726e+04  1.11e-02 5.59e-04  3.39e-02    11s
  32   4.31798106e+04  5.36303456e+04  9.42e-03 4.11e-04  2.74e-02    11s
  33   4.39164521e+04  5.24437762e+04  8.15e-03 2.98e-04  2.23e-02    11s
  34   4.46512757e+04  5.15478406e+04  6.93e-03 2.19e-04  1.81e-02    11s
  35   4.56712401e+04  5.11560102e+04  5.30e-03 1.82e-04  1.44e-02    11s
  36   4.65156058e+04  5.04908718e+04  3.92e-03 1.21e-04  1.04e-02    11s
  37   4.69986429e+04  5.00499930e+04  3.15e-03 8.50e-05  7.99e-03    11s
  38   4.76974055e+04  4.96688707e+04  2.06e-03 1.47e-04  5.16e-03    11s
  39   4.82109637e+04  4.95233722e+04  1.30e-03 1.22e-04  3.44e-03    11s
  40   4.84215364e+04  4.94310386e+04  9.86e-04 9.56e-05  2.64e-03    11s
  41   4.85879383e+04  4.93640157e+04  7.36e-04 7.54e-05  2.03e-03    12s
  42   4.86361059e+04  4.93140634e+04  6.64e-04 6.06e-05  1.78e-03    12s
  43   4.87767456e+04  4.92313097e+04  4.57e-04 3.79e-05  1.19e-03    12s
  44   4.88248938e+04  4.92170397e+04  3.87e-04 3.35e-05  1.03e-03    12s
  45   4.88874540e+04  4.91814301e+04  3.00e-04 2.28e-05  7.70e-04    12s
  46   4.89607461e+04  4.91360250e+04  1.95e-04 6.20e-05  4.59e-04    12s
  47   4.89663287e+04  4.91242515e+04  1.86e-04 4.15e-05  4.14e-04    12s
  48   4.90351746e+04  4.91128890e+04  8.75e-05 2.00e-05  2.04e-04    12s
  49   4.90896503e+04  4.91037147e+04  1.33e-05 2.70e-06  3.68e-05    12s
  50   4.90998363e+04  4.91009784e+04  7.47e-07 2.86e-06  2.99e-06    12s
  51   4.91005537e+04  4.91005915e+04  2.26e-08 1.05e-07  9.90e-08    13s
  52   4.91005830e+04  4.91005830e+04  1.94e-10 4.57e-11  5.00e-11    13s

Barrier solved model in 52 iterations and 12.61 seconds (20.90 work units)
Optimal objective 4.91005830e+04


Root crossover log...

  187094 DPushes remaining with DInf 0.0000000e+00                13s
   49231 DPushes remaining with DInf 0.0000000e+00                15s
     935 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                20s

    3235 PPushes remaining with PInf 2.1109471e-05                20s
       0 PPushes remaining with PInf 0.0000000e+00                21s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.2526437e+00     21s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   79945    4.9100583e+04   0.000000e+00   3.252644e+00     21s
   79950    4.9100583e+04   0.000000e+00   0.000000e+00     21s
   79950    4.9100583e+04   0.000000e+00   0.000000e+00     21s
Concurrent spin time: 3.61s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 4.910058e+04, 79950 iterations, 19.51 seconds (37.66 work units)
Total elapsed time = 25.02s (DegenMoves)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 49100.5830    0  177 -194531.75 49100.5830   125%     -   25s
H    0     0                    -107083.9931 49100.5830   146%     -   26s
H    0     0                    -106360.3841 49100.5830   146%     -   26s
H    0     0                    -106038.4462 49100.5830   146%     -   26s
H    0     0                    -44548.72900 49100.5830   210%     -   27s
H    0     0                    -44513.04802 49100.5830   210%     -   27s
H    0     0                    6951.6393252 49100.5830   606%     -   27s
H    0     0                    13703.917067 49100.5830   258%     -   29s
H    0     0                    13783.197758 49100.5830   256%     -   29s
H    0     0                    13808.949243 49100.5830   256%     -   29s
     0     0 42806.9868    0  303 13808.9492 42806.9868   210%     -  108s
     0     0 42709.1347    0  293 13808.9492 42709.1347   209%     -  122s
     0     0 42692.4869    0  294 13808.9492 42692.4869   209%     -  128s
     0     0 42680.1532    0  297 13808.9492 42680.1532   209%     -  131s
     0     0 42678.6537    0  297 13808.9492 42678.6537   209%     -  135s
     0     0 42678.3191    0  297 13808.9492 42678.3191   209%     -  137s
     0     0 39307.2527    0  315 13808.9492 39307.2527   185%     -  204s
H    0     0                    14742.567820 39306.3401   167%     -  205s
H    0     0                    15188.740653 39306.3401   159%     -  205s
H    0     0                    15300.764449 39306.3401   157%     -  205s
H    0     0                    15311.987709 39306.3401   157%     -  205s
H    0     0                    15348.384941 39306.3401   156%     -  205s
     0     0 38968.7862    0  324 15348.3849 38968.7862   154%     -  247s
     0     0 38887.1539    0  305 15348.3849 38887.1539   153%     -  267s
     0     0 38764.4680    0  372 15348.3849 38764.4680   153%     -  290s
     0     0 38616.5533    0  397 15348.3849 38616.5533   152%     -  311s
     0     0 38604.3980    0  392 15348.3849 38604.3980   152%     -  318s
     0     0 38596.4633    0  420 15348.3849 38596.4633   151%     -  323s
     0     0 38589.3509    0  423 15348.3849 38589.3509   151%     -  332s
     0     0 38581.3272    0  381 15348.3849 38581.3272   151%     -  341s
     0     0 38573.6339    0  411 15348.3849 38573.6339   151%     -  346s
     0     0 38545.7829    0  400 15348.3849 38545.7829   151%     -  358s
     0     0 38542.3202    0  364 15348.3849 38542.3202   151%     -  361s
     0     0 38538.5700    0  360 15348.3849 38538.5700   151%     -  364s
     0     0 38536.8672    0  368 15348.3849 38536.8672   151%     -  366s
     0     0 38536.8586    0  371 15348.3849 38536.8586   151%     -  367s
     0     0 36550.7262    0  363 15348.3849 36550.7262   138%     -  460s
H    0     0                    15439.301060 36550.6605   137%     -  462s
H    0     0                    15473.286769 36550.6605   136%     -  462s
     0     0 35850.0259    0  491 15473.2868 35850.0259   132%     -  514s
     0     0 35591.8618    0  404 15473.2868 35591.8618   130%     -  548s
     0     0 35424.7983    0  452 15473.2868 35424.7983   129%     -  569s
     0     0 35247.7950    0  436 15473.2868 35247.7950   128%     -  585s
     0     0 35206.6108    0  443 15473.2868 35206.6108   128%     -  598s
     0     0 35190.3652    0  457 15473.2868 35190.3652   127%     -  607s
     0     0 35155.7644    0  456 15473.2868 35155.7644   127%     -  617s
     0     0 35132.9666    0  460 15473.2868 35132.9666   127%     -  626s
     0     0 35117.6407    0  455 15473.2868 35117.6407   127%     -  632s
     0     0 35089.4926    0  462 15473.2868 35089.4926   127%     -  642s
     0     0 35077.1885    0  462 15473.2868 35077.1885   127%     -  649s
     0     0 35059.2100    0  465 15473.2868 35059.2100   127%     -  654s
     0     0 35057.7832    0  468 15473.2868 35057.7832   127%     -  658s
     0     0 34112.9768    0  400 15473.2868 34112.9768   120%     -  737s
     0     0 33766.4499    0  414 15473.2868 33766.4499   118%     -  787s
     0     0 33700.1099    0  550 15473.2868 33700.1099   118%     -  813s
     0     0 33663.1645    0  478 15473.2868 33663.1645   118%     -  835s
     0     0 33583.0432    0  545 15473.2868 33583.0432   117%     -  865s
     0     0 33563.4231    0  469 15473.2868 33563.4231   117%     -  876s
     0     0 33537.7324    0  467 15473.2868 33537.7324   117%     -  887s
     0     0 33470.5519    0  474 15473.2868 33470.5519   116%     -  901s
     0     0 33451.5228    0  511 15473.2868 33451.5228   116%     -  911s
     0     0 33448.6177    0  480 15473.2868 33448.6177   116%     -  915s
     0     0 33446.8716    0  423 15473.2868 33446.8716   116%     -  919s
     0     0 32996.0828    0  498 15473.2868 32996.0828   113%     -  958s
     0     0 32865.1036    0  554 15473.2868 32865.1036   112%     -  981s
     0     0 32819.8721    0  569 15473.2868 32819.8721   112%     -  994s
     0     0 32799.3983    0  564 15473.2868 32799.3983   112%     - 1002s
     0     0 32793.4764    0  568 15473.2868 32793.4764   112%     - 1008s
     0     0 32785.9659    0  574 15473.2868 32785.9659   112%     - 1013s
     0     0 32781.5687    0  572 15473.2868 32781.5687   112%     - 1020s
     0     0 32765.1834    0  568 15473.2868 32765.1834   112%     - 1025s
     0     0 32744.8296    0  568 15473.2868 32744.8296   112%     - 1032s
     0     0 32742.0531    0  566 15473.2868 32742.0531   112%     - 1036s
     0     0 32740.8735    0  570 15473.2868 32740.8735   112%     - 1040s
     0     0 32586.0673    0  424 15473.2868 32586.0673   111%     - 1067s
H    0     0                    15716.332309 32585.8753   107%     - 1077s
H    0     0                    15982.774997 32585.8753   104%     - 1077s
H    0     0                    16015.556606 32585.8753   103%     - 1078s
     0     0 32541.0786    0  387 16015.5566 32541.0786   103%     - 1092s
     0     0 32518.5532    0  443 16015.5566 32518.5532   103%     - 1098s
     0     0 32513.8401    0  441 16015.5566 32513.8401   103%     - 1104s
     0     0 32508.9105    0  445 16015.5566 32508.9105   103%     - 1110s
     0     0 32497.2190    0  450 16015.5566 32497.2190   103%     - 1117s
     0     0 32493.2584    0  447 16015.5566 32493.2584   103%     - 1120s
     0     0 32490.1628    0  440 16015.5566 32490.1628   103%     - 1123s
     0     0 32489.7833    0  444 16015.5566 32489.7833   103%     - 1124s
     0     0 32402.8837    0  551 16015.5566 32402.8837   102%     - 1143s
H    0     0                    16662.576176 32402.3395  94.5%     - 1144s
     0     0 32291.0165    0  512 16662.5762 32291.0165  93.8%     - 1162s
     0     0 32270.1346    0  456 16662.5762 32270.1346  93.7%     - 1170s
     0     0 32255.8239    0  448 16662.5762 32255.8239  93.6%     - 1177s
     0     0 32246.6513    0  444 16662.5762 32246.6513  93.5%     - 1184s
     0     0 32242.7787    0  440 16662.5762 32242.7787  93.5%     - 1187s
     0     0 32221.2112    0  441 16662.5762 32221.2112  93.4%     - 1192s
     0     0 32214.2133    0  446 16662.5762 32214.2133  93.3%     - 1196s
     0     0 32209.6396    0  454 16662.5762 32209.6396  93.3%     - 1199s
     0     0 32199.3858    0  438 16662.5762 32199.3858  93.2%     - 1209s
     0     0 32196.3643    0  443 16662.5762 32196.3643  93.2%     - 1212s
     0     0 32190.6344    0  455 16662.5762 32190.6344  93.2%     - 1218s
     0     0 32188.6655    0  459 16662.5762 32188.6655  93.2%     - 1222s
     0     0 32108.1219    0  530 16662.5762 32108.1219  92.7%     - 1239s
H    0     0                    16794.089917 32107.6760  91.2%     - 1241s
H    0     0                    18616.665398 32107.6760  72.5%     - 1241s
H    0     0                    18705.765195 32107.6760  71.6%     - 1242s
H    0     0                    19086.628789 32107.6760  68.2%     - 1242s
H    0     0                    19168.310178 32107.6760  67.5%     - 1243s
H    0     0                    19192.958649 32107.6760  67.3%     - 1243s
H    0     0                    19211.876307 32107.6760  67.1%     - 1243s
     0     0 32083.3195    0  450 19211.8763 32083.3195  67.0%     - 1254s
     0     0 32071.9798    0  442 19211.8763 32071.9798  66.9%     - 1259s
     0     0 32067.8060    0  529 19211.8763 32067.8060  66.9%     - 1263s
     0     0 32066.3387    0  454 19211.8763 32066.3387  66.9%     - 1265s
     0     0 32000.8781    0  522 19211.8763 32000.8781  66.6%     - 1279s
H    0     0                    19269.405302 32000.8390  66.1%     - 1280s
     0     0 31968.8079    0  512 19269.4053 31968.8079  65.9%     - 1291s
     0     0 31958.2527    0  527 19269.4053 31958.2527  65.8%     - 1297s
     0     0 31955.6364    0  522 19269.4053 31955.6364  65.8%     - 1300s
     0     0 31950.8017    0  453 19269.4053 31950.8017  65.8%     - 1302s
     0     0 31946.3821    0  547 19269.4053 31946.3821  65.8%     - 1307s
     0     0 31945.9013    0  535 19269.4053 31945.9013  65.8%     - 1309s
     0     0 31921.1856    0  453 19269.4053 31921.1856  65.7%     - 1321s
H    0     0                    19309.305961 31920.6981  65.3%     - 1347s
H    0     0                    19316.768601 31920.6981  65.2%     - 1347s
     0     0 31907.6927    0  532 19316.7686 31907.6927  65.2%     - 1356s
     0     0 31896.3220    0  593 19316.7686 31896.3220  65.1%     - 1362s
     0     0 31891.0011    0  587 19316.7686 31891.0011  65.1%     - 1367s
     0     0 31885.9630    0  550 19316.7686 31885.9630  65.1%     - 1371s
     0     0 31882.2825    0  592 19316.7686 31882.2825  65.0%     - 1374s
     0     0 31880.9644    0  592 19316.7686 31880.9644  65.0%     - 1377s
     0     0 31865.5532    0  463 19316.7686 31865.5532  65.0%     - 1385s
     0     0 31858.4070    0  471 19316.7686 31858.4070  64.9%     - 1394s
     0     0 31857.5531    0  465 19316.7686 31857.5531  64.9%     - 1398s
     0     0 31841.8625    0  465 19316.7686 31841.8625  64.8%     - 1407s
H    0     0                    19445.636489 31840.1626  63.7%     - 1413s
     0     0 31835.5991    0  543 19445.6365 31835.5991  63.7%     - 1419s
     0     0 31833.8515    0  547 19445.6365 31833.8515  63.7%     - 1422s
     0     0 31828.5918    0  469 19445.6365 31828.5918  63.7%     - 1430s
H    0     0                    19451.380952 31828.3494  63.6%     - 1431s
H    0     0                    19454.383710 31828.3494  63.6%     - 1431s
H    0     0                    19519.683387 31828.3494  63.1%     - 1431s
     0     0 31826.1443    0  474 19519.6834 31826.1443  63.0%     - 1434s
     0     0 31819.7974    0  467 19519.6834 31819.7974  63.0%     - 1440s
     0     0 31816.3351    0  467 19519.6834 31816.3351  63.0%     - 1453s
H    0     0                    19524.298505 31816.1833  63.0%     - 1845s
H    0     0                    19560.653951 31816.1833  62.7%     - 1909s
H    0     0                    19574.703708 31816.1833  62.5%     - 1935s
     0     2 31816.1833    0  467 19574.7037 31816.1833  62.5%     - 1963s
     1     3 30455.6008    1  416 19574.7037 31816.1833  62.5% 26672 1998s
     2     4 31340.9019    1  454 19574.7037 31340.9019  60.1% 21946 2017s
     3     5 30150.1986    2  416 19574.7037 31340.8254  60.1% 18085 2034s
     4     8 31205.2760    2  510 19574.7037 31340.7621  60.1% 15666 2064s
     7    15 30674.9433    3  488 19574.7037 31340.7621  60.1% 17834 2122s
    14    30 30224.1294    4  497 19574.7037 30982.6446  58.3% 18262 2177s
    29    45 29909.4289    5  543 19574.7037 30515.1774  55.9% 32515 2328s
    44    77 28505.3549    6  440 19574.7037 30515.1774  55.9% 30311 2625s
H   52    77                    19651.286035 30515.1774  55.3% 29008 2625s
    76   173 28232.7359    7  421 19651.2860 30358.8526  54.5% 28078 2711s
H  172   202                    19691.359770 30358.8526  54.2% 18559 2748s
H  178   202                    19698.250002 30358.8526  54.1% 18441 2748s
   201   264 28069.9245   12  406 19698.2500 30358.8526  54.1% 17553 2800s
   265   296 26650.1640   11  347 19698.2500 30358.8526  54.1% 15243 2847s
   299   344 25624.2013   13  161 19698.2500 30358.8526  54.1% 15188 2888s
   347   367 25345.2240   14  155 19698.2500 30358.8526  54.1% 15209 2928s
   372   399 25098.2192   15  156 19698.2500 30358.8526  54.1% 15220 2974s
   406   428 24679.2599   16  155 19698.2500 30358.8526  54.1% 15034 3021s
   441   445 24645.0090   17  149 19698.2500 30358.8526  54.1% 14849 3058s
   474   473 20638.8847   18  133 19698.2500 30358.8526  54.1% 14777 3106s
   514   505 20569.9570   19  127 19698.2500 30358.8526  54.1% 14712 3152s
   584   540     cutoff   17      19698.2500 30358.8526  54.1% 14311 3192s
   642   584 23151.6143   21  185 19698.2500 30358.8526  54.1% 14328 3230s
   700   615 22870.4884   22  175 19698.2500 30358.8526  54.1% 14314 3272s
   757   625 23097.2067   15  343 19698.2500 30358.8526  54.1% 13984 3310s
   804   643 23031.1415   16  380 19698.2500 30358.8526  54.1% 13773 3348s
   859   662 21153.1936   18  318 19698.2500 30358.8526  54.1% 13658 3392s
   903   688 21084.5124   19  347 19698.2500 30358.8526  54.1% 13906 3437s
   945   716 20690.9632   23  253 19698.2500 30358.8526  54.1% 13976 3487s
   993   772 19783.7273   25  296 19698.2500 30358.8526  54.1% 13955 3565s
  1079   791 24313.5464   16  408 19698.2500 30358.8526  54.1% 13784 3600s
H 1099   791                    19705.242760 30358.8526  54.1% 13770 3600s

Cutting planes:
  Learned: 1
  Implied bound: 270
  MIR: 4330
  Flow cover: 6165
  RLT: 68
  Relax-and-lift: 907
  PSD: 1

Explored 1114 nodes (16379727 simplex iterations) in 3600.08 seconds (8620.75 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 19705.2 19698.3 19691.4 ... 19451.4

Time limit reached
Best objective 1.970524276049e+04, best bound 3.035885257645e+04, gap 54.0648%
  WARNING: Time limit reached. Using best solution found (gap: 54.06%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.10s
  Master Objective (UB) = 19705.24, θ = 142452.84
  Upper Bound (UB) = 19705.24

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 142452.84
  [DEBUG]   ✓ Scenario 0: θ = 142452.84 ≤ Q = 142452.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 142452.84 ≤ Q = 142452.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 142452.84 ≤ Q = 142452.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 142452.84 ≤ Q = 142452.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 142452.84 ≤ Q = 142452.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 142452.84 ≤ Q = 142452.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 142452.84 ≤ Q = 142452.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 142452.84 ≤ Q = 142452.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 142452.84 ≤ Q = 142452.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 142452.84 ≤ Q = 142452.84 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 142452.84 ≤ Q = 142452.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 142452.84 ≤ Q = 142452.84 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 142452.84 ≤ Q = 142452.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 142452.84 ≤ Q = 142452.84 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 142452.84 ≤ Q = 142452.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 142452.84 ≤ Q = 142452.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 142452.84 ≤ Q = 142452.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 142452.84 ≤ Q = 142452.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 142452.84 ≤ Q = 142452.84 (slack: 0.00)
  [DEBUG]   ✓ Scenario 19: θ = 142452.84 ≤ Q = 142452.84 (slack: 0.00)
  [DEBUG]   ✓ Scenario 20: θ = 142452.84 ≤ Q = 142452.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 21: θ = 142452.84 ≤ Q = 142452.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 22: θ = 142452.84 ≤ Q = 142452.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 23: θ = 142452.84 ≤ Q = 142452.84 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 24] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0xa324b16
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xf5cdb4ea
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [3e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.465672e+13
Presolve removed 2571 rows and 1864 columns
Presolve time: 0.00s
Presolved: 522 rows, 525 columns, 1472 nonzeros
Found heuristic solution: objective 7784173.0101
Variable types: 355 continuous, 170 integer (170 binary)

Root relaxation: objective -1.354757e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -135475.69    0  124 7784173.01 -135475.69   102%     -    0s
H    0     0                    -100575.9957 -135475.69  34.7%     -    0s
H    0     0                    -101103.9686 -135475.69  34.0%     -    0s
H    0     0                    -104196.6044 -108712.66  4.33%     -    0s
     0     0 -108712.66    0   87 -104196.60 -108712.66  4.33%     -    0s
H    0     0                    -104506.7264 -108586.59  3.90%     -    0s
H    0     0                    -105111.3197 -108586.59  3.31%     -    0s
H    0     0                    -105421.4417 -108586.59  3.00%     -    0s
     0     0 -108158.51    0   88 -105421.44 -108158.51  2.60%     -    0s
H    0     0                    -105537.0668 -108067.36  2.40%     -    0s
     0     0 -107646.48    0   89 -105537.07 -107646.48  2.00%     -    0s
     0     0 -107598.31    0   89 -105537.07 -107598.31  1.95%     -    0s
     0     0 -107243.47    0   82 -105537.07 -107243.47  1.62%     -    0s
     0     0 -107234.96    0   82 -105537.07 -107234.96  1.61%     -    0s
     0     0 -107140.70    0   90 -105537.07 -107140.70  1.52%     -    0s
     0     0 -107114.57    0   90 -105537.07 -107114.57  1.49%     -    0s
H    0     0                    -105556.6756 -107114.57  1.48%     -    0s
     0     2 -107114.57    0   90 -105556.68 -107114.57  1.48%     -    0s
H  257   352                    -105868.6327 -106787.48  0.87%   8.6    0s
H  415   367                    -105904.7496 -106787.48  0.83%   6.9    0s
H  525   367                    -105916.5218 -106787.48  0.82%   6.5    0s
* 1418   519              14    -105944.5072 -106547.90  0.57%   5.8    0s
H 4007     0                    -105952.6388 -106034.57  0.08%   5.9    0s

Cutting planes:
  Gomory: 42
  Implied bound: 1
  MIR: 230
  RLT: 5
  BQP: 1

Explored 4139 nodes (24883 simplex iterations) in 0.15 seconds (0.14 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -105953 -105953 -105945 ... -105111
No other solutions better than -105953

Optimal solution found (tolerance 1.00e-04)
Best objective -1.059526387454e+05, best bound -1.059526387454e+05, gap 0.0000%
  Subproblem solved in 0.17s
  Worst-case operational profit (Z_SP) = 140598.83
  Scenario: 5 demand increases, 55 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -105952.64
  [DEBUG]   S×d_nominal = 246551.47
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 246551.47 + -105952.64 = 140598.83
  [DEBUG]   Current θ from Master = 142452.84
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1854.01 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 17851.23
  Lower Bound (LB) = 19157.49
  Gap (UB-LB) = 547.7504, Absolute Gap = 547.7504, Relative Gap = 0.027797
  Not converged yet (gap = 547.75 > ε = 200)

  [DEBUG] Adding NEW scenario 24 to Master Problem...
  [DEBUG] New scenario pattern: 5 increases, 55 decreases
    [DEBUG] Scenario 24 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 24 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 24]
    [DEBUG]   - Total constraints in model: 383633
    [DEBUG]   - Total variables in model: 158260
  [DEBUG] Total scenarios in Master: 25
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 25
================================================================================
[Iteration 25] Solving Master Problem...
  Current scenarios in Master: 25
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 383633 rows, 158260 columns and 1086669 nonzeros
Model fingerprint: 0x1867fdc9
Variable types: 156001 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 164405 rows and 66765 columns
Presolve time: 4.38s
Presolved: 219228 rows, 91495 columns, 1348332 nonzeros
Variable types: 89236 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -366999.6780
Found heuristic solution: objective -194531.7474

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 2.02s

Barrier statistics:
 Dense cols : 1180
 AA' NZ     : 5.744e+06
 Factor NZ  : 1.620e+07 (roughly 260 MB of memory)
 Factor Ops : 6.077e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.93131752e+07  3.31093722e+08  1.10e+05 1.72e+01  7.55e+04     9s
   1  -1.49416092e+07  2.85133492e+08  7.84e+04 5.78e+01  5.33e+04     9s
   2  -6.01392470e+06  2.26000960e+08  3.09e+04 1.11e+00  2.18e+04     9s
   3  -1.31840350e+06  1.68321191e+08  4.05e+03 1.92e+00  3.15e+03     9s
   4  -6.36633658e+05  1.36108086e+08  7.27e+02 1.09e+00  8.15e+02     9s
   5  -5.54831541e+05  6.16635632e+07  4.32e+02 3.07e-01  4.00e+02     9s
   6  -4.32016884e+05  4.40114927e+07  1.47e+02 1.93e-01  1.90e+02     9s
   7  -3.60066271e+05  3.25055952e+07  5.41e+01 1.32e-01  1.08e+02     9s
   8  -2.63880972e+05  2.71016970e+07  2.07e+01 1.07e-01  7.78e+01     9s
   9  -1.43664326e+05  1.93598553e+07  6.08e+00 7.42e-02  5.11e+01     9s
  10  -1.11274506e+05  9.45287382e+06  3.65e+00 3.52e-02  2.47e+01     9s
  11  -1.03124893e+05  7.95607001e+06  2.82e+00 2.95e-02  2.07e+01     9s
  12  -9.34652663e+04  5.49524733e+06  2.06e+00 2.00e-02  1.43e+01     9s
  13  -8.14927693e+04  3.58618057e+06  1.36e+00 1.27e-02  9.31e+00    10s
  14  -6.21258719e+04  3.01213672e+06  5.82e-01 1.06e-02  7.75e+00    10s
  15  -4.78306814e+04  6.91115215e+05  3.12e-01 2.37e-03  1.86e+00    10s
  16  -3.51719803e+04  4.12746051e+05  2.30e-01 1.59e-03  1.13e+00    10s
  17  -1.18142026e+04  2.78035706e+05  1.31e-01 1.61e-03  7.28e-01    10s
  18  -6.88063749e+02  1.75242193e+05  9.52e-02 1.67e-03  4.42e-01    10s
  19   1.02336498e+04  1.36125989e+05  7.30e-02 2.07e-03  3.16e-01    10s
  20   1.55752935e+04  1.20019899e+05  6.22e-02 1.81e-03  2.62e-01    10s
  21   1.86349612e+04  1.06454887e+05  5.59e-02 2.15e-03  2.21e-01    10s
  22   2.25356842e+04  8.89192902e+04  4.82e-02 2.30e-03  1.67e-01    10s
  23   2.64180361e+04  7.76042718e+04  4.03e-02 2.37e-03  1.29e-01    10s
  24   2.84779378e+04  6.98624502e+04  3.61e-02 2.53e-03  1.04e-01    11s
  25   3.14565754e+04  6.81629314e+04  3.02e-02 2.34e-03  9.23e-02    11s
  26   3.26626655e+04  6.53824677e+04  2.80e-02 2.03e-03  8.23e-02    11s
  27   3.43988657e+04  6.18649304e+04  2.46e-02 1.61e-03  6.91e-02    11s
  28   3.62559377e+04  5.98021903e+04  2.13e-02 1.34e-03  5.92e-02    11s
  29   3.89619247e+04  5.72464478e+04  1.64e-02 1.01e-03  4.60e-02    11s
  30   3.98898209e+04  5.58033768e+04  1.48e-02 8.26e-04  4.00e-02    11s
  31   4.07340649e+04  5.48821019e+04  1.34e-02 7.16e-04  3.56e-02    11s
  32   4.11017037e+04  5.47385498e+04  1.27e-02 7.00e-04  3.43e-02    11s
  33   4.24676111e+04  5.38350633e+04  1.04e-02 5.88e-04  2.86e-02    11s
  34   4.35697765e+04  5.23803347e+04  8.52e-03 4.20e-04  2.22e-02    12s
  35   4.42660080e+04  5.18026914e+04  7.39e-03 3.46e-04  1.90e-02    12s
  36   4.51524184e+04  5.12320345e+04  5.99e-03 2.71e-04  1.53e-02    12s
  37   4.55786779e+04  5.09882982e+04  5.34e-03 2.39e-04  1.36e-02    12s
  38   4.62872168e+04  5.03956925e+04  4.22e-03 1.60e-04  1.03e-02    12s
  39   4.69616751e+04  5.00700469e+04  3.17e-03 1.19e-04  7.82e-03    12s
  40   4.76473210e+04  4.98663259e+04  2.11e-03 9.37e-05  5.58e-03    12s
  41   4.82055125e+04  4.96191220e+04  1.26e-03 6.23e-05  3.55e-03    12s
  42   4.84930440e+04  4.93918323e+04  8.39e-04 7.30e-05  2.26e-03    12s
  43   4.86261964e+04  4.93047695e+04  6.48e-04 5.11e-05  1.71e-03    12s
  44   4.86494150e+04  4.92742211e+04  6.15e-04 4.34e-05  1.57e-03    13s
  45   4.87978690e+04  4.92266254e+04  4.05e-04 3.11e-05  1.08e-03    13s
  46   4.88174519e+04  4.92036481e+04  3.79e-04 2.19e-05  9.71e-04    13s
  47   4.88848074e+04  4.91625925e+04  2.86e-04 1.27e-05  6.99e-04    13s
  48   4.89705174e+04  4.91477096e+04  1.70e-04 9.47e-06  4.46e-04    13s
  49   4.89720184e+04  4.91347236e+04  1.67e-04 6.86e-06  4.09e-04    13s
  50   4.90524316e+04  4.91144028e+04  5.49e-05 2.46e-06  1.56e-04    13s
  51   4.90928722e+04  4.91029813e+04  8.23e-06 1.62e-06  2.54e-05    13s
  52   4.90999683e+04  4.91007739e+04  5.28e-07 9.41e-08  2.03e-06    13s
  53   4.91005766e+04  4.91005860e+04  6.86e-09 3.68e-08  2.36e-08    14s
  54   4.91005830e+04  4.91005830e+04  4.53e-09 3.42e-11  2.53e-11    14s

Barrier solved model in 54 iterations and 13.63 seconds (22.78 work units)
Optimal objective 4.91005830e+04


Root crossover log...

  194751 DPushes remaining with DInf 0.0000000e+00                14s
   95007 DPushes remaining with DInf 0.0000000e+00                15s
   30611 DPushes remaining with DInf 0.0000000e+00                20s
    3868 DPushes remaining with DInf 0.0000000e+00                25s
       0 DPushes remaining with DInf 0.0000000e+00                27s

    3089 PPushes remaining with PInf 1.1631409e-05                27s
       0 PPushes remaining with PInf 0.0000000e+00                28s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.8654376e-10     28s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   80342    4.9100583e+04   0.000000e+00   0.000000e+00     28s
   80342    4.9100583e+04   0.000000e+00   0.000000e+00     28s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 4.910058e+04, 80342 iterations, 22.34 seconds (36.99 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 49100.5830    0  177 -194531.75 49100.5830   125%     -   28s
H    0     0                    -94657.62127 49100.5830   152%     -   30s
H    0     0                    -44548.72900 49100.5830   210%     -   30s
H    0     0                    10751.290705 49100.5830   357%     -   31s
H    0     0                    13634.682391 49100.5830   260%     -   32s
H    0     0                    13693.055004 49100.5830   259%     -   32s
H    0     0                    13808.949243 49100.5830   256%     -   32s
     0     0 42772.5155    0  297 13808.9492 42772.5155   210%     -  134s
     0     0 42722.3303    0  299 13808.9492 42722.3303   209%     -  150s
     0     0 42716.0694    0  300 13808.9492 42716.0694   209%     -  156s
     0     0 42685.4630    0  298 13808.9492 42685.4630   209%     -  162s
     0     0 42682.5881    0  296 13808.9492 42682.5881   209%     -  166s
     0     0 42650.0280    0  300 13808.9492 42650.0280   209%     -  174s
     0     0 42634.2960    0  304 13808.9492 42634.2960   209%     -  181s
     0     0 42633.2306    0  299 13808.9492 42633.2306   209%     -  184s
     0     0 42633.1788    0  299 13808.9492 42633.1788   209%     -  184s
     0     0 39073.8977    0  350 13808.9492 39073.8977   183%     -  274s
H    0     0                    18180.123358 39073.6841   115%     -  275s
H    0     0                    18442.674260 39073.6841   112%     -  275s
H    0     0                    18468.708363 39073.6841   112%     -  275s
H    0     0                    18565.845173 39073.6841   110%     -  275s
H    0     0                    18578.118109 39073.6841   110%     -  275s
H    0     0                    18640.015087 39073.6841   110%     -  275s
H    0     0                    18710.171973 39073.6841   109%     -  275s
H    0     0                    18763.406415 39073.6841   108%     -  275s
H    0     0                    18767.786485 39073.6841   108%     -  275s
     0     0 38789.5562    0  344 18767.7865 38789.5562   107%     -  304s
     0     0 38665.9530    0  344 18767.7865 38665.9530   106%     -  324s
     0     0 38594.5663    0  383 18767.7865 38594.5663   106%     -  343s
     0     0 38564.9999    0  389 18767.7865 38564.9999   105%     -  358s
     0     0 38479.6076    0  391 18767.7865 38479.6076   105%     -  378s
     0     0 38447.7833    0  431 18767.7865 38447.7833   105%     -  391s
     0     0 38299.4852    0  351 18767.7865 38299.4852   104%     -  410s
     0     0 38291.4875    0  452 18767.7865 38291.4875   104%     -  419s
     0     0 38249.4846    0  393 18767.7865 38249.4846   104%     -  432s
     0     0 38234.3752    0  414 18767.7865 38234.3752   104%     -  438s
     0     0 38231.5857    0  439 18767.7865 38231.5857   104%     -  444s
     0     0 38226.1127    0  404 18767.7865 38226.1127   104%     -  447s
     0     0 38226.0055    0  445 18767.7865 38226.0055   104%     -  450s
     0     0 35977.6182    0  376 18767.7865 35977.6182  91.7%     -  553s
     0     0 35498.7460    0  384 18767.7865 35498.7460  89.1%     -  598s
     0     0 35325.8746    0  394 18767.7865 35325.8746  88.2%     -  630s
     0     0 35269.9778    0  453 18767.7865 35269.9778  87.9%     -  647s
     0     0 35249.1408    0  404 18767.7865 35249.1408  87.8%     -  657s
     0     0 35203.7923    0  439 18767.7865 35203.7923  87.6%     -  680s
     0     0 35163.5171    0  443 18767.7865 35163.5171  87.4%     -  701s
     0     0 35081.6143    0  441 18767.7865 35081.6143  86.9%     -  719s
     0     0 35060.3292    0  431 18767.7865 35060.3292  86.8%     -  730s
     0     0 35040.4587    0  432 18767.7865 35040.4587  86.7%     -  740s
     0     0 34979.2963    0  503 18767.7865 34979.2963  86.4%     -  756s
     0     0 34958.7081    0  433 18767.7865 34958.7081  86.3%     -  765s
     0     0 34949.1628    0  438 18767.7865 34949.1628  86.2%     -  773s
     0     0 34925.0547    0  436 18767.7865 34925.0547  86.1%     -  787s
     0     0 34918.7309    0  515 18767.7865 34918.7309  86.1%     -  798s
     0     0 34907.2602    0  442 18767.7865 34907.2602  86.0%     -  807s
     0     0 34900.7169    0  442 18767.7865 34900.7169  86.0%     -  812s
     0     0 34883.4124    0  436 18767.7865 34883.4124  85.9%     -  822s
     0     0 34880.1160    0  440 18767.7865 34880.1160  85.9%     -  826s
     0     0 34863.8905    0  450 18767.7865 34863.8905  85.8%     -  836s
     0     0 34862.1676    0  456 18767.7865 34862.1676  85.8%     -  840s
     0     0 33827.4189    0  503 18767.7865 33827.4189  80.2%     -  919s
H    0     0                    18929.741872 33827.1295  78.7%     -  921s
H    0     0                    18968.277754 33827.1295  78.3%     -  921s
H    0     0                    18978.886446 33827.1295  78.2%     -  921s
H    0     0                    18998.992340 33827.1295  78.0%     -  921s
H    0     0                    19009.944013 33827.1295  77.9%     -  921s
     0     0 33611.5978    0  502 19009.9440 33611.5978  76.8%     -  952s
     0     0 33533.5430    0  511 19009.9440 33533.5430  76.4%     -  974s
     0     0 33366.2327    0  556 19009.9440 33366.2327  75.5%     - 1002s
     0     0 33353.8792    0  606 19009.9440 33353.8792  75.5%     - 1013s
     0     0 33336.4800    0  611 19009.9440 33336.4800  75.4%     - 1022s
     0     0 33314.0472    0  597 19009.9440 33314.0472  75.2%     - 1033s
     0     0 33279.1753    0  598 19009.9440 33279.1753  75.1%     - 1044s
     0     0 33261.1036    0  598 19009.9440 33261.1036  75.0%     - 1052s
     0     0 33236.9721    0  542 19009.9440 33236.9721  74.8%     - 1067s
     0     0 33224.6302    0  561 19009.9440 33224.6302  74.8%     - 1076s
     0     0 33221.0349    0  562 19009.9440 33221.0349  74.8%     - 1083s
     0     0 33196.2453    0  550 19009.9440 33196.2453  74.6%     - 1090s
     0     0 33167.9964    0  542 19009.9440 33167.9964  74.5%     - 1099s
     0     0 33159.1570    0  554 19009.9440 33159.1570  74.4%     - 1106s
     0     0 33154.4653    0  558 19009.9440 33154.4653  74.4%     - 1112s
     0     0 33152.6076    0  559 19009.9440 33152.6076  74.4%     - 1116s
     0     0 32852.8341    0  432 19009.9440 32852.8341  72.8%     - 1162s
     0     0 32790.9781    0  441 19009.9440 32790.9781  72.5%     - 1189s
     0     0 32774.5386    0  440 19009.9440 32774.5386  72.4%     - 1206s
     0     0 32761.6517    0  520 19009.9440 32761.6517  72.3%     - 1223s
     0     0 32737.9896    0  430 19009.9440 32737.9896  72.2%     - 1245s
     0     0 32698.5550    0  508 19009.9440 32698.5550  72.0%     - 1255s
     0     0 32692.6507    0  509 19009.9440 32692.6507  72.0%     - 1263s
     0     0 32691.0314    0  511 19009.9440 32691.0314  72.0%     - 1268s
     0     0 32546.5754    0  531 19009.9440 32546.5754  71.2%     - 1315s
     0     0 32511.6503    0  498 19009.9440 32511.6503  71.0%     - 1334s
     0     0 32494.5827    0  583 19009.9440 32494.5827  70.9%     - 1344s
     0     0 32486.2883    0  533 19009.9440 32486.2883  70.9%     - 1351s
     0     0 32480.4134    0  538 19009.9440 32480.4134  70.9%     - 1358s
     0     0 32477.8230    0  527 19009.9440 32477.8230  70.8%     - 1362s
     0     0 32477.5991    0  531 19009.9440 32477.5991  70.8%     - 1366s
     0     0 32395.2916    0  397 19009.9440 32395.2916  70.4%     - 1400s
     0     0 32365.8140    0  442 19009.9440 32365.8140  70.3%     - 1418s
     0     0 32357.9245    0  447 19009.9440 32357.9245  70.2%     - 1429s
     0     0 32340.0302    0  521 19009.9440 32340.0302  70.1%     - 1439s
     0     0 32336.4199    0  509 19009.9440 32336.4199  70.1%     - 1447s
     0     0 32334.0717    0  520 19009.9440 32334.0717  70.1%     - 1452s
     0     0 32332.0468    0  525 19009.9440 32332.0468  70.1%     - 1455s
     0     0 32283.7313    0  467 19009.9440 32283.7313  69.8%     - 1478s
     0     0 32270.4348    0  518 19009.9440 32270.4348  69.8%     - 1492s
     0     0 32267.6194    0  522 19009.9440 32267.6194  69.7%     - 1499s
     0     0 32264.0568    0  517 19009.9440 32264.0568  69.7%     - 1506s
     0     0 32262.0021    0  509 19009.9440 32262.0021  69.7%     - 1511s
     0     0 32233.3463    0  475 19009.9440 32233.3463  69.6%     - 1528s
     0     0 32227.1398    0  467 19009.9440 32227.1398  69.5%     - 1536s
     0     0 32220.2677    0  468 19009.9440 32220.2677  69.5%     - 1544s
     0     0 32217.0565    0  478 19009.9440 32217.0565  69.5%     - 1549s
     0     0 32213.5866    0  478 19009.9440 32213.5866  69.5%     - 1556s
     0     0 32211.2549    0  459 19009.9440 32211.2549  69.4%     - 1563s
     0     0 32210.5182    0  541 19009.9440 32210.5182  69.4%     - 1570s
     0     0 32183.2965    0  537 19009.9440 32183.2965  69.3%     - 1589s
H    0     0                    19106.451705 32182.6421  68.4%     - 1600s
H    0     0                    19148.212109 32182.6421  68.1%     - 1600s
     0     0 32152.3738    0  543 19148.2121 32152.3738  67.9%     - 1614s
     0     0 32141.0911    0  485 19148.2121 32141.0911  67.9%     - 1622s
     0     0 32138.0771    0  479 19148.2121 32138.0771  67.8%     - 1628s
     0     0 32135.1798    0  485 19148.2121 32135.1798  67.8%     - 1631s
     0     0 32125.0899    0  545 19148.2121 32125.0899  67.8%     - 1639s
     0     0 32121.3440    0  543 19148.2121 32121.3440  67.8%     - 1643s
     0     0 32120.7208    0  544 19148.2121 32120.7208  67.7%     - 1645s
     0     0 32087.8465    0  471 19148.2121 32087.8465  67.6%     - 1659s
     0     0 32073.3378    0  470 19148.2121 32073.3378  67.5%     - 1670s
     0     0 32070.4165    0  457 19148.2121 32070.4165  67.5%     - 1674s
     0     0 32066.2120    0  469 19148.2121 32066.2120  67.5%     - 1677s
     0     0 32054.1575    0  465 19148.2121 32054.1575  67.4%     - 1688s
     0     0 32053.0194    0  471 19148.2121 32053.0194  67.4%     - 1691s
     0     0 32044.2315    0  535 19148.2121 32044.2315  67.3%     - 1705s
H    0     0                    19210.822570 32041.9562  66.8%     - 1716s
H    0     0                    19223.304034 32041.9562  66.7%     - 1716s
     0     0 32039.0590    0  473 19223.3040 32039.0590  66.7%     - 1722s
     0     0 32037.8181    0  478 19223.3040 32037.8181  66.7%     - 1725s
     0     0 32033.8261    0  475 19223.3040 32033.8261  66.6%     - 1734s
     0     0 32027.0522    0  470 19223.3040 32027.0522  66.6%     - 1742s
     0     0 32025.9799    0  473 19223.3040 32025.9799  66.6%     - 1745s
     0     0 32019.5560    0  535 19223.3040 32019.5560  66.6%     - 1757s
H    0     0                    19225.662535 32019.0289  66.5%     - 1775s
H    0     0                    19249.768829 32019.0289  66.3%     - 1775s
     0     0 32017.7606    0  547 19249.7688 32017.7606  66.3%     - 1780s
     0     0 32012.4661    0  601 19249.7688 32012.4661  66.3%     - 1792s
     0     0 32011.0935    0  603 19249.7688 32011.0935  66.3%     - 1797s
     0     0 32008.1807    0  547 19249.7688 32008.1807  66.3%     - 1807s
     0     0 32008.1163    0  547 19249.7688 32008.1163  66.3%     - 1823s
H    0     0                    19255.948053 32008.1163  66.2%     - 2052s
H    0     2                    19355.167376 32008.1163  65.4%     - 2293s
     0     2 32008.1163    0  547 19355.1674 32008.1163  65.4%     - 2293s
     1     4 31572.5251    1  499 19355.1674 32007.5965  65.4% 17996 2344s
     3     8 31543.4687    2  526 19355.1674 31571.6137  63.1% 21377 2379s
     7    14 31098.5868    3  555 19355.1674 31542.4471  63.0% 22443 2440s
    13    28 30836.5441    4  545 19355.1674 31238.9147  61.4% 27452 2494s
    27    42 30049.2506    5  404 19355.1674 31017.1755  60.3% 33392 2655s
    41    71 28635.9406    6  319 19355.1674 31017.1755  60.3% 43431 3067s
    70   145 28185.2602    7  298 19355.1674 30877.3707  59.5% 41419 3193s
   144   245 27956.7872   10  293 19355.1674 30767.9890  59.0% 28432 3275s
   246   301 27801.2012   13  302 19355.1674 30767.9890  59.0% 21110 3328s
   312   355 27703.3918   14  295 19355.1674 30767.9890  59.0% 18775 3378s
   374   398 22393.0350   14  241 19355.1674 30767.9890  59.0% 17298 3425s
   421   437 25033.2878   17  250 19355.1674 30767.9890  59.0% 16646 3468s
   464   486 24988.7332   18  253 19355.1674 30767.9890  59.0% 16230 3516s
   519   536 20075.8471   20  246 19355.1674 30767.9890  59.0% 15954 3558s
H  553   536                    19355.292190 30767.9890  59.0% 15696 3558s
   575   602 19818.6833   21  258 19355.2922 30767.9890  59.0% 15459 3599s

Cutting planes:
  Learned: 5
  Gomory: 5
  Implied bound: 282
  MIR: 4244
  Flow cover: 5862
  RLT: 69
  Relax-and-lift: 942

Explored 655 nodes (10934001 simplex iterations) in 3600.05 seconds (8181.78 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 19355.3 19355.2 19255.9 ... 19009.9

Time limit reached
Best objective 1.935529219012e+04, best bound 3.076798901756e+04, gap 58.9642%
  WARNING: Time limit reached. Using best solution found (gap: 58.96%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = 19355.29, θ = 141399.10
  Upper Bound (UB) = 19355.29

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 141399.10
  [DEBUG]   ✓ Scenario 0: θ = 141399.10 ≤ Q = 141399.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 141399.10 ≤ Q = 141399.10 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 141399.10 ≤ Q = 141399.10 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 141399.10 ≤ Q = 141399.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 141399.10 ≤ Q = 141399.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 141399.10 ≤ Q = 141399.10 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 141399.10 ≤ Q = 141399.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 141399.10 ≤ Q = 141399.10 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 141399.10 ≤ Q = 141399.10 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 141399.10 ≤ Q = 141399.10 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 141399.10 ≤ Q = 141399.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 141399.10 ≤ Q = 141399.10 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 141399.10 ≤ Q = 141399.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 141399.10 ≤ Q = 141399.10 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 141399.10 ≤ Q = 141399.10 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 141399.10 ≤ Q = 141399.10 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 141399.10 ≤ Q = 141399.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 141399.10 ≤ Q = 141399.10 (slack: 0.00)
  [DEBUG]   ✓ Scenario 18: θ = 141399.10 ≤ Q = 141399.10 (slack: 0.00)
  [DEBUG]   ✓ Scenario 19: θ = 141399.10 ≤ Q = 141399.10 (slack: 0.00)
  [DEBUG]   ✓ Scenario 20: θ = 141399.10 ≤ Q = 141399.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 21: θ = 141399.10 ≤ Q = 141399.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 22: θ = 141399.10 ≤ Q = 141399.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 23: θ = 141399.10 ≤ Q = 141399.10 (slack: 0.00)
  [DEBUG]   ✓ Scenario 24: θ = 141399.10 ≤ Q = 141399.10 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 25] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x490f7062
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x490f7062
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.462371e+13
Presolve removed 2571 rows and 1864 columns
Presolve time: 0.00s
Presolved: 522 rows, 525 columns, 1472 nonzeros
Found heuristic solution: objective 7768003.6338
Variable types: 355 continuous, 170 integer (170 binary)

Root relaxation: objective -1.362224e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -136222.40    0  124 7768003.63 -136222.40   102%     -    0s
H    0     0                    -101326.7883 -136222.40  34.4%     -    0s
H    0     0                    -101917.8158 -136222.40  33.7%     -    0s
     0     0 -108819.54    0  137 -101917.82 -108819.54  6.77%     -    0s
H    0     0                    -104250.4806 -108677.27  4.25%     -    0s
     0     0 -107934.68    0  137 -104250.48 -107934.68  3.53%     -    0s
     0     0 -107922.11    0  137 -104250.48 -107922.11  3.52%     -    0s
H    0     0                    -104717.9092 -107922.11  3.06%     -    0s
     0     0 -107245.75    0  138 -104717.91 -107245.75  2.41%     -    0s
     0     0 -107227.60    0  141 -104717.91 -107227.60  2.40%     -    0s
     0     0 -106961.55    0  139 -104717.91 -106961.55  2.14%     -    0s
     0     0 -106913.81    0  141 -104717.91 -106913.81  2.10%     -    0s
     0     0 -106912.53    0  141 -104717.91 -106912.53  2.10%     -    0s
     0     0 -106723.60    0  138 -104717.91 -106723.60  1.92%     -    0s
     0     0 -106714.55    0  138 -104717.91 -106714.55  1.91%     -    0s
     0     2 -106714.55    0  138 -104717.91 -106714.55  1.91%     -    0s
H   47    64                    -105443.1695 -106270.35  0.78%  16.9    0s
H  415   353                    -105471.0141 -106200.71  0.69%   6.9    0s
H  420   353                    -105496.9170 -106200.71  0.67%   6.9    0s
H  435   353                    -105710.5657 -106200.71  0.46%   6.9    0s
H  450   353                    -105724.9164 -106200.71  0.45%   6.8    0s
H  716   349                    -105778.6639 -106200.71  0.40%   6.4    0s
* 1954   348              32    -105782.1877 -106054.56  0.26%   6.9    0s
* 2002   348              29    -105785.9567 -106054.56  0.25%   6.9    0s
* 2315   219              31    -105800.2849 -106054.56  0.24%   6.8    0s
* 2457   219              32    -105807.5393 -105864.51  0.05%   6.7    0s

Cutting planes:
  Gomory: 69
  MIR: 295
  RLT: 4

Explored 2981 nodes (19077 simplex iterations) in 0.14 seconds (0.14 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -105808 -105800 -105786 ... -105443
No other solutions better than -105808

Optimal solution found (tolerance 1.00e-04)
Best objective -1.058075393205e+05, best bound -1.058075393205e+05, gap 0.0000%
  Subproblem solved in 0.16s
  Worst-case operational profit (Z_SP) = 140314.16
  Scenario: 28 demand increases, 32 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -105807.54
  [DEBUG]   S×d_nominal = 246121.70
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 246121.70 + -105807.54 = 140314.16
  [DEBUG]   Current θ from Master = 141399.10
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1084.94 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 18270.35
  Lower Bound (LB) = 19157.49
  Gap (UB-LB) = 197.7998, Absolute Gap = 197.7998, Relative Gap = 0.010219
  *** CONVERGED (gap within tolerance) ***

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 25
Total Time: 69294.67s
Converged: True
Final Lower Bound: 19157.4924
Final Upper Bound: 19355.2922
Final Gap: 197.799833
Number of Critical Scenarios: 25
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [0] (1/3)
Product 1 Plants: [1] (1/3)
Product 2 Plants: [1] (1/3)
Total Plant Openings: 3
DCs Opened: [0, 4, 9] (3/10)
Active Routes (Plant→DC): 9
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 1 customers  Mode 1: 16 customers  Mode 2: 33 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 25
Start Time: 2026-01-04 23:23:25
End Time: 2026-01-05 18:38:19
Total Time: 69294.67s
Optimal Value: 19157.49
Lower Bound: 19157.49
Upper Bound: 19355.29
Gap: 197.799833
Plants Opened: {0: [0], 1: [1], 2: [1]} (3 plants)
DCs Opened: [0, 4, 9] (3 DCs)
================================================================================

Results saved to: result/DH_single_full_seed2_MD_gamma20_20260105_183820.csv

Total Execution Time: 69295.18 seconds
End Time: 2026-01-05 18:38:20

All tasks completed successfully!

