
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 28
DI Scenario: Mixed
Start Time: 2026-01-04 19:57:42
================================================================================
Loading data from data/DH_data_full_seed28.pkl...

Applying DI scenario: Mixed
DI values:
  Product 0: ['1.000', '1.444', '2.086'] (k=0.907)
  Product 1: ['1.000', '1.145', '1.311'] (k=0.334)
  Product 2: ['1.000', '1.062', '1.127'] (k=0.148)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=901, max=1771
  DC capacity (MC): min=401, max=771

Demand Structure (s_rk matrix):
  Total customer-product pairs: 80/150 (46.7% sparse)
  Average products per customer: 1.60

Demand (only non-zero entries):
  Nominal (μ): min=8.50, max=34.59, count=80
  Deviation (μ̂): min=4.08, max=9.98

Costs:
  Plant fixed cost: min=5810, max=9892
  DC fixed cost: min=3901, max=5911
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.444', '2.086'] (k=0.907)
    Product 1: ['1.000', '1.332', '1.773'] (k=0.707)
    Product 2: ['1.000', '1.380', '1.904'] (k=0.794)
  MD:
    Product 0: ['1.000', '1.242', '1.543'] (k=0.535)
    Product 1: ['1.000', '1.145', '1.311'] (k=0.334)
    Product 2: ['1.000', '1.212', '1.470'] (k=0.475)
  LD:
    Product 0: ['1.000', '1.049', '1.100'] (k=0.117)
    Product 1: ['1.000', '1.032', '1.064'] (k=0.077)
    Product 2: ['1.000', '1.062', '1.127'] (k=0.148)
  Mixed:
    Product 0: ['1.000', '1.444', '2.086'] (k=0.907)
    Product 1: ['1.000', '1.145', '1.311'] (k=0.334)
    Product 2: ['1.000', '1.062', '1.127'] (k=0.148)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48750 nonzeros
Model fingerprint: 0xc88a4669
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11871 rows and 2871 columns
Presolve time: 0.15s
Presolved: 4802 rows, 5629 columns, 33384 nonzeros
Variable types: 3370 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -291858.8607
Found heuristic solution: objective -186122.4392

Root relaxation: objective 9.621041e+04, 5324 iterations, 0.25 seconds (0.43 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 96210.4140    0  626 -186122.44 96210.4140   152%     -    0s
H    0     0                    -185528.2241 96210.4140   152%     -    0s
H    0     0                    -183736.6880 96210.4140   152%     -    0s
H    0     0                    -178442.3770 96210.4140   154%     -    0s
     0     0 85108.7836    0  814 -178442.38 85108.7836   148%     -    2s
H    0     0                    -176221.3847 85106.5376   148%     -    2s
     0     0 84925.4413    0  804 -176221.38 84925.4413   148%     -    2s
     0     0 84910.6232    0  808 -176221.38 84910.6232   148%     -    2s
     0     0 84910.5037    0  811 -176221.38 84910.5037   148%     -    2s
H    0     0                    -105953.4686 78204.1027   174%     -    4s
     0     0 78204.1027    0  754 -105953.47 78204.1027   174%     -    4s
     0     0 77793.6517    0  751 -105953.47 77793.6517   173%     -    4s
     0     0 77738.4218    0  768 -105953.47 77738.4218   173%     -    4s
     0     0 77728.9937    0  771 -105953.47 77728.9937   173%     -    4s
     0     0 77728.6464    0  773 -105953.47 77728.6464   173%     -    4s
H    0     0                    -100955.7615 77728.6464   177%     -    5s
H    0     0                    -100591.2721 72137.5062   172%     -    7s
H    0     0                    -100554.6494 72137.5062   172%     -    7s
H    0     0                    -100290.3430 72137.5062   172%     -    7s
H    0     0                    -99286.82942 72137.5062   173%     -    7s
H    0     0                    -60530.63188 72137.5062   219%     -    7s
H    0     0                    -60294.58087 72137.5062   220%     -    7s
H    0     0                    -59126.07122 72137.5062   222%     -    7s
H    0     0                    18398.362375 72137.5062   292%     -    7s
H    0     0                    24345.785353 72137.5062   196%     -    7s
     0     0 72137.5062    0  847 24345.7854 72137.5062   196%     -    7s
     0     0 71791.0892    0  851 24345.7854 71791.0892   195%     -    7s
     0     0 71711.7664    0  850 24345.7854 71711.7664   195%     -    7s
     0     0 71704.4585    0  866 24345.7854 71704.4585   195%     -    7s
H    0     0                    24453.631508 66726.4905   173%     -    9s
H    0     0                    24554.523815 66726.4905   172%     -    9s
H    0     0                    26347.520369 66726.4905   153%     -    9s
H    0     0                    26514.479409 66726.4905   152%     -    9s
H    0     0                    26591.530583 66726.4905   151%     -    9s
H    0     0                    26843.212723 66726.4905   149%     -    9s
H    0     0                    27066.016518 66726.4905   147%     -    9s
     0     0 66726.4905    0  882 27066.0165 66726.4905   147%     -    9s
H    0     0                    27136.414517 66337.5225   144%     -    9s
H    0     0                    27505.479528 66337.5225   141%     -    9s
H    0     0                    27622.495711 66337.5225   140%     -    9s
H    0     0                    27723.838636 66337.5225   139%     -    9s
H    0     0                    27772.197767 66337.5225   139%     -    9s
H    0     0                    27775.540448 66337.5225   139%     -    9s
H    0     0                    27827.960265 66337.5225   138%     -    9s
H    0     0                    27879.942812 66337.5225   138%     -    9s
H    0     0                    28039.635319 66337.5225   137%     -    9s
     0     0 66337.5225    0  878 28039.6353 66337.5225   137%     -    9s
     0     0 66253.4894    0  835 28039.6353 66253.4894   136%     -    9s
     0     0 66235.2636    0  900 28039.6353 66235.2636   136%     -    9s
     0     0 66232.2878    0  902 28039.6353 66232.2878   136%     -   10s
H    0     0                    28237.005618 63356.3481   124%     -   11s
H    0     0                    28242.107672 63356.3481   124%     -   11s
H    0     0                    29128.073209 63356.3481   118%     -   11s
H    0     0                    30115.140264 63356.3481   110%     -   11s
H    0     0                    30250.019934 63356.3481   109%     -   11s
H    0     0                    30253.063969 63356.3481   109%     -   11s
H    0     0                    30330.516215 63356.3481   109%     -   11s
H    0     0                    30427.367121 63356.3481   108%     -   11s
     0     0 63356.3481    0  822 30427.3671 63356.3481   108%     -   11s
H    0     0                    30526.377046 62962.8408   106%     -   11s
     0     0 62962.8408    0  846 30526.3770 62962.8408   106%     -   11s
     0     0 62902.0826    0  860 30526.3770 62902.0826   106%     -   11s
     0     0 62898.2415    0  852 30526.3770 62898.2415   106%     -   11s
     0     0 60367.6258    0  739 30526.3770 60367.6258  97.8%     -   14s
H    0     0                    30687.101755 59946.9087  95.3%     -   14s
     0     0 59946.9087    0  825 30687.1018 59946.9087  95.3%     -   14s
     0     0 59862.8323    0  799 30687.1018 59862.8323  95.1%     -   14s
     0     0 59839.3083    0  809 30687.1018 59839.3083  95.0%     -   14s
     0     0 59837.3722    0  817 30687.1018 59837.3722  95.0%     -   14s
H    0     0                    31032.061522 57004.9269  83.7%     -   16s
H    0     0                    31759.822622 57004.9269  79.5%     -   16s
H    0     0                    31761.143745 57004.9269  79.5%     -   16s
H    0     0                    32136.516998 57004.9269  77.4%     -   16s
H    0     0                    32144.134790 57004.9269  77.3%     -   16s
     0     0 57004.9269    0  633 32144.1348 57004.9269  77.3%     -   16s
H    0     0                    32400.088703 56377.1260  74.0%     -   16s
H    0     0                    32440.258331 56377.1260  73.8%     -   16s
     0     0 56377.1260    0  790 32440.2583 56377.1260  73.8%     -   16s
     0     0 56246.4752    0  787 32440.2583 56246.4752  73.4%     -   17s
     0     0 56222.2718    0  864 32440.2583 56222.2718  73.3%     -   17s
     0     0 54731.4182    0  824 32440.2583 54731.4182  68.7%     -   19s
H    0     0                    33123.437295 54300.5813  63.9%     -   20s
     0     0 54300.5813    0  897 33123.4373 54300.5813  63.9%     -   20s
     0     0 54212.4085    0  882 33123.4373 54212.4085  63.7%     -   20s
     0     0 54187.6493    0  905 33123.4373 54187.6493  63.6%     -   21s
H    0     0                    33248.181323 53048.1292  59.6%     -   23s
     0     0 53048.1292    0  836 33248.1813 53048.1292  59.6%     -   23s
H    0     0                    33359.938324 52750.5091  58.1%     -   24s
H    0     0                    33391.356546 52750.5091  58.0%     -   24s
H    0     0                    33407.793429 52750.5091  57.9%     -   24s
H    0     0                    33414.264527 52750.5091  57.9%     -   24s
     0     0 52750.5091    0  867 33414.2645 52750.5091  57.9%     -   24s
     0     0 52692.3171    0  886 33414.2645 52692.3171  57.7%     -   24s
     0     0 52679.2123    0  879 33414.2645 52679.2123  57.7%     -   24s
     0     0 51950.7993    0  901 33414.2645 51950.7993  55.5%     -   26s
     0     0 51798.9796    0  941 33414.2645 51798.9796  55.0%     -   26s
     0     0 51758.2934    0  924 33414.2645 51758.2934  54.9%     -   26s
H    0     0                    33497.034644 51742.2057  54.5%     -   26s
H    0     0                    33508.552809 51742.2057  54.4%     -   26s
     0     0 51742.2057    0  946 33508.5528 51742.2057  54.4%     -   26s
H    0     0                    33558.948729 51742.2057  54.2%     -   26s
H    0     0                    33845.784514 51150.6684  51.1%     -   28s
H    0     0                    33861.101643 51150.6684  51.1%     -   28s
H    0     0                    33862.857495 51150.6684  51.1%     -   28s
H    0     0                    33888.194008 51150.6684  50.9%     -   28s
     0     0 51150.6684    0  892 33888.1940 51150.6684  50.9%     -   28s
     0     0 51031.9273    0  918 33888.1940 51031.9273  50.6%     -   29s
     0     0 51006.5445    0  892 33888.1940 51006.5445  50.5%     -   30s
     0     0 50613.2506    0  776 33888.1940 50613.2506  49.4%     -   31s
     0     0 50453.8219    0  855 33888.1940 50453.8219  48.9%     -   32s
     0     0 50411.4043    0  910 33888.1940 50411.4043  48.8%     -   32s
     0     0 50083.9906    0  896 33888.1940 50083.9906  47.8%     -   33s
     0     0 49902.8742    0  878 33888.1940 49902.8742  47.3%     -   35s
     0     0 49830.3993    0  928 33888.1940 49830.3993  47.0%     -   35s
     0     0 49801.2455    0  955 33888.1940 49801.2455  47.0%     -   36s
     0     0 49544.7825    0  838 33888.1940 49544.7825  46.2%     -   37s
     0     0 49466.0222    0  896 33888.1940 49466.0222  46.0%     -   38s
     0     0 49455.0233    0  907 33888.1940 49455.0233  45.9%     -   38s
     0     0 49234.1994    0  778 33888.1940 49234.1994  45.3%     -   39s
     0     0 49233.9808    0  778 33888.1940 49233.9808  45.3%     -   39s
     0     2 49233.8188    0  778 33888.1940 49233.8188  45.3%     -   42s
     1     4 49068.4227    1  712 33888.1940 49233.8188  45.3%  1781   46s
     3     8 48671.9981    2  796 33888.1940 49068.3785  44.8%  2117   53s
     7    16 48352.5410    3  689 33888.1940 48671.8755  43.6%  2604   60s
    15    32 47638.3803    4  735 33888.1940 48352.5376  42.7%  2954   69s
    31    64 47147.5785    5  677 33888.1940 47955.7365  41.5%  3024   80s
    63    96 46987.8298    6  680 33888.1940 47796.5299  41.0%  2692   93s
    95   238 46917.5487    7  675 33888.1940 47796.5299  41.0%  2416  105s
   237   313 46725.6145   11  407 33888.1940 47796.5299  41.0%  1343  115s
   314   339 45469.6508   11  628 33888.1940 47796.5299  41.0%  1250  128s
   350   374 45243.5516   12  477 33888.1940 47796.5299  41.0%  1228  145s
   387   410 45215.5767   12  406 33888.1940 47796.5299  41.0%  1210  154s
   427   456 44775.4872   13  487 33888.1940 47696.4360  40.7%  1202  164s
   475   505 44390.9293   14  409 33888.1940 47696.1684  40.7%  1162  172s
   526   567     cutoff   15      33888.1940 47696.1684  40.7%  1121  180s
   592   619 43879.7679   19  393 33888.1940 47696.1684  40.7%  1059  189s
   650   677 42827.2375   21  455 33888.1940 47696.1684  40.7%  1021  197s
   714   737 42355.2255   26  397 33888.1940 47636.9674  40.6%   989  202s
   776   790 41827.9854   30  370 33888.1940 47636.9674  40.6%   957  207s
   835   861 41165.9727   32  290 33888.1940 47636.9674  40.6%   928  214s
   914   930 40934.1405   37  262 33888.1940 47636.9674  40.6%   880  220s
   995  1008 40516.5969   41  239 33888.1940 47636.9674  40.6%   833  227s
  1083  1093 39903.2068   47  203 33888.1940 47636.9674  40.6%   795  233s
  1170  1190 39734.0011   52  205 33888.1940 47636.9674  40.6%   760  239s
  1275  1273 39202.8670   57  192 33888.1940 47636.9674  40.6%   720  244s
  1378  1370 38463.4971   62  169 33888.1940 47630.7945  40.6%   684  250s
  1487  1469 36128.6688   66  155 33888.1940 47604.2174  40.5%   654  257s
  1602  1566     cutoff   72      33888.1940 47546.4016  40.3%   623  265s
  1725  1641 45724.6353    9  642 33888.1940 47546.4016  40.3%   600  272s
  1841  1714 45676.7603   10  555 33888.1940 47546.4016  40.3%   580  278s
  1936  1801 44086.2943   13  462 33888.1940 47468.0336  40.1%   569  286s
  2041  1860 43008.9942   17  488 33888.1940 47468.0336  40.1%   560  295s
  2144  1935 36203.9649   20  387 33888.1940 47468.0336  40.1%   557  303s
H 2187  1935                    33979.083621 47468.0336  39.7%   557  303s
  2253  2134     cutoff   22      33979.0836 47396.3983  39.5%   552  312s
  2490  2282     cutoff   22      33979.0836 47381.1977  39.4%   530  320s
  2716  2465 46397.9415    8  525 33979.0836 47381.1977  39.4%   518  329s
  2963  2658 44634.4480   10  397 33979.0836 47335.2685  39.3%   505  338s
H 3056  2657                    34002.580244 47335.2685  39.2%   500  338s
  3212  2810 43266.2160   14  471 34002.5802 47335.2685  39.2%   493  346s
H 3446  3012                    34033.994217 47294.6829  39.0%   486  355s
H 3663  3011                    34047.477749 47280.0482  38.9%   478  355s
H 3696  3011                    34055.682607 47280.0482  38.8%   477  355s
  3730  3012 38804.8558   15  778 34055.6826 47280.0482  38.8%   475  380s
  3746  3023 37586.7386   23  436 34055.6826 44930.5425  31.9%   473  385s
  3761  3033 44309.8523   16  415 34055.6826 44309.8523  30.1%   471  390s
  3766  3041 42374.3991   14  307 34055.6826 43157.6529  26.7%   476  396s
  3778  3052 41171.5813   16  311 34055.6826 42528.6869  24.9%   476  401s
  3792  3063 38517.7094   17  346 34055.6826 42161.8204  23.8%   476  405s
  3847  3099 38073.0192   19  210 34055.6826 41331.1875  21.4%   478  411s
  3985  3109 35985.2869   24  246 34055.6826 40500.2179  18.9%   471  416s
H 3993  2953                    34176.474242 40500.2179  18.5%   471  416s
  4140  2893 34915.6134   25  250 34176.4742 40500.2179  18.5%   460  421s
H 4142  2749                    34247.909323 40500.2179  18.3%   460  421s
H 4146  2609                    34281.313605 40500.2179  18.1%   460  421s
H 4182  2467                    34285.468407 40500.2179  18.1%   458  421s
  4277  2409     cutoff   27      34285.4684 40500.2179  18.1%   451  426s
  4427  2336     cutoff   21      34285.4684 40095.4111  16.9%   442  430s
  4554  2253 37832.7397   27  334 34285.4684 40095.4111  16.9%   434  435s
  4671  2190 37238.9695   29  254 34285.4684 40095.4111  16.9%   427  443s
  4763  2142     cutoff   31      34285.4684 36426.0760  6.24%   421  445s

Cutting planes:
  Gomory: 1
  Implied bound: 17
  Projected implied bound: 16
  MIR: 134
  Flow cover: 358
  RLT: 20
  Relax-and-lift: 93

Explored 4799 nodes (2103809 simplex iterations) in 446.42 seconds (204.73 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 34285.5 34281.3 34247.9 ... 33888.2

Optimal solution found (tolerance 1.00e-04)
Best objective 3.428546840664e+04, best bound 3.428546840664e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 446.60s
  Master Objective (UB) = 34285.47, θ = 177023.82
  Upper Bound (UB) = 34285.47

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 177023.82
  [DEBUG]   ✓ Scenario 0: θ = 177023.82 ≤ Q = 177023.82 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x1b6846e
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xfe497b92
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [5e-01, 2e+02]
Found heuristic solution: objective 1.153573e+13
Presolve removed 2598 rows and 1890 columns
Presolve time: 0.00s
Presolved: 495 rows, 499 columns, 1396 nonzeros
Found heuristic solution: objective 5750847.2834
Variable types: 339 continuous, 160 integer (160 binary)

Root relaxation: objective -1.247625e+05, 239 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -124762.54    0  122 5750847.28 -124762.54   102%     -    0s
H    0     0                    -92537.13032 -124762.54  34.8%     -    0s
H    0     0                    -93401.75994 -124762.54  33.6%     -    0s
*    0     0               0    -95587.02522 -95587.025  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 202

Explored 1 nodes (363 simplex iterations) in 0.02 seconds (0.01 work units)
Thread count was 32 (of 64 available processors)

Solution count 5: -95587 -93401.8 -92537.1 ... 1.15357e+13
No other solutions better than -95587

Optimal solution found (tolerance 1.00e-04)
Best objective -9.558702522003e+04, best bound -9.558702522003e+04, gap 0.0000%
  Subproblem solved in 0.03s
  Worst-case operational profit (Z_SP) = 143722.98
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -95587.03
  [DEBUG]   S×d_nominal = 239310.00
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 239310.00 + -95587.03 = 143722.98
  [DEBUG]   Current θ from Master = 177023.82
  [DEBUG]   ⚠️  Z_SP ≤ θ by 33300.84 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 984.62
  Lower Bound (LB) = 984.62
  Gap (UB-LB) = 33300.8436, Absolute Gap = 33300.8436, Relative Gap = 0.971282
  Not converged yet (gap = 33300.84 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 91981 nonzeros
Model fingerprint: 0x233d5e2b
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 984.625 (0.01s)
MIP start from previous solve produced solution with objective 984.625 (0.01s)
Loaded MIP start from previous solve with objective 984.625

Presolve removed 14141 rows and 5740 columns
Presolve time: 0.30s
Presolved: 17822 rows, 9000 columns, 98638 nonzeros
Variable types: 6741 continuous, 2259 integer (2259 binary)

Root relaxation: objective 4.427028e+04, 8013 iterations, 0.65 seconds (1.40 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 44270.2791    0  257  984.62482 44270.2791  4396%     -    1s
H    0     0                    3839.8179370 44270.2791  1053%     -    1s
H    0     0                    4911.6108806 44270.2791   801%     -    1s
H    0     0                    5573.5566179 44270.2791   694%     -    1s
H    0     0                    7237.4237844 44270.2791   512%     -    1s
H    0     0                    9121.8177433 44270.2791   385%     -    1s
     0     0 34575.9885    0  292 9121.81774 34575.9885   279%     -    8s
H    0     0                    9209.6034555 34568.4231   275%     -    8s
H    0     0                    9261.6944621 34568.4231   273%     -    8s
H    0     0                    9610.3264305 34568.4231   260%     -    8s
H    0     0                    9632.2246460 34568.4231   259%     -    8s
     0     0 34316.3764    0  304 9632.22465 34316.3764   256%     -   10s
     0     0 34316.3520    0  304 9632.22465 34316.3520   256%     -   10s
     0     0 29713.3784    0  248 9632.22465 29713.3784   208%     -   17s
     0     0 28921.8768    0  273 9632.22465 28921.8768   200%     -   18s
     0     0 28720.8345    0  292 9632.22465 28720.8345   198%     -   18s
     0     0 28717.3155    0  289 9632.22465 28717.3155   198%     -   18s
     0     0 28717.2602    0  289 9632.22465 28717.2602   198%     -   18s
     0     0 25687.7426    0  443 9632.22465 25687.7426   167%     -   21s
H    0     0                    9685.4197411 25687.3403   165%     -   21s
H    0     0                    10249.122262 25687.3403   151%     -   21s
H    0     0                    10367.318102 25687.3403   148%     -   21s
     0     0 24945.4895    0  385 10367.3181 24945.4895   141%     -   28s
     0     0 24716.5434    0  525 10367.3181 24716.5434   138%     -   28s
     0     0 24680.9614    0  538 10367.3181 24680.9614   138%     -   29s
     0     0 24654.8948    0  486 10367.3181 24654.8948   138%     -   29s
     0     0 24645.6937    0  494 10367.3181 24645.6937   138%     -   30s
     0     0 24644.4464    0  496 10367.3181 24644.4464   138%     -   30s
     0     0 23514.0270    0  530 10367.3181 23514.0270   127%     -   33s
H    0     0                    10399.846144 23513.6371   126%     -   33s
     0     0 23228.6830    0  472 10399.8461 23228.6830   123%     -   35s
     0     0 23164.2907    0  569 10399.8461 23164.2907   123%     -   36s
     0     0 23151.0610    0  492 10399.8461 23151.0610   123%     -   36s
     0     0 23142.7544    0  568 10399.8461 23142.7544   123%     -   36s
     0     0 23141.4782    0  560 10399.8461 23141.4782   123%     -   37s
     0     0 22755.9596    0  583 10399.8461 22755.9596   119%     -   40s
     0     0 22659.6622    0  672 10399.8461 22659.6622   118%     -   45s
     0     0 22645.3877    0  604 10399.8461 22645.3877   118%     -   46s
     0     0 22634.5960    0  599 10399.8461 22634.5960   118%     -   47s
     0     0 22631.4931    0  669 10399.8461 22631.4931   118%     -   47s
     0     0 22351.4688    0  476 10399.8461 22351.4688   115%     -   49s
     0     0 22288.6734    0  400 10399.8461 22288.6734   114%     -   57s
     0     0 22252.9671    0  489 10399.8461 22252.9671   114%     -   58s
     0     0 22248.1608    0  478 10399.8461 22248.1608   114%     -   59s
     0     0 22164.9525    0  491 10399.8461 22164.9525   113%     -   61s
     0     0 22145.9255    0  486 10399.8461 22145.9255   113%     -   65s
     0     0 22136.1702    0  487 10399.8461 22136.1702   113%     -   67s
     0     0 22132.3508    0  492 10399.8461 22132.3508   113%     -   68s
     0     0 21994.4003    0  466 10399.8461 21994.4003   111%     -   69s
     0     0 21967.7861    0  566 10399.8461 21967.7861   111%     -   75s
     0     0 21959.9923    0  424 10399.8461 21959.9923   111%     -   77s
     0     0 21957.0592    0  422 10399.8461 21957.0592   111%     -   77s
     0     0 21905.1789    0  656 10399.8461 21905.1789   111%     -   81s
     0     0 21896.2659    0  625 10399.8461 21896.2659   111%     -   82s
     0     0 21894.3707    0  741 10399.8461 21894.3707   111%     -   82s
     0     0 21877.4330    0  621 10399.8461 21877.4330   110%     -   83s
     0     0 21875.7583    0  513 10399.8461 21875.7583   110%     -   83s
     0     0 21863.1898    0  506 10399.8461 21863.1898   110%     -   84s
     0     0 21858.7722    0  504 10399.8461 21858.7722   110%     -   85s
     0     0 21833.9012    0  425 10399.8461 21833.9012   110%     -   90s
     0     0 21825.2531    0  495 10399.8461 21825.2531   110%     -   91s
     0     0 21819.3549    0  552 10399.8461 21819.3549   110%     -   92s
     0     0 21808.7254    0  538 10399.8461 21808.7254   110%     -   93s
     0     0 21808.3658    0  538 10399.8461 21808.3658   110%     -   93s
     0     2 21808.3658    0  538 10399.8461 21808.3658   110%     -  106s
     1     4 21610.0308    1  477 10399.8461 21808.3658   110%   892  111s
     3     8 21537.9075    2  398 10399.8461 21609.8970   108%   896  118s
     7    16 21304.8852    3  345 10399.8461 21537.9024   107%  1157  127s
    15    32 21223.9730    4  351 10399.8461 21304.1446   105%  1560  136s
    31    64 20475.4410    5  354 10399.8461 21223.4533   104%  1725  147s
    63    96 19866.3153    6  354 10399.8461 20497.9027  97.1%  1363  158s
    95   133 19539.8469    7  350 10399.8461 20496.8812  97.1%  1290  171s
   132   179 19515.8518    8  348 10399.8461 20496.8812  97.1%  1087  183s
   178   235 17142.2554    9  287 10399.8461 20496.8812  97.1%   991  196s
   234   314 17665.5219   10  343 10399.8461 20496.8812  97.1%   991  209s
   315   378 18868.9723   12  496 10399.8461 20496.8812  97.1%   896  220s
   393   444 18496.2368   14  452 10399.8461 20496.8812  97.1%   843  229s
   467   515 18159.5424   16  342 10399.8461 20496.8812  97.1%   800  239s
   555   592 16346.9030   17  317 10399.8461 20496.8812  97.1%   759  245s
   654   668 15277.5676   17  323 10399.8461 20496.8812  97.1%   694  256s
   748   699 16227.9459   19  322 10399.8461 20475.2815  96.9%   658  263s
   781   733 16180.2190   20  324 10399.8461 20433.0857  96.5%   653  272s
   828   815 15956.9952   21  318 10399.8461 20433.0857  96.5%   649  277s
   930   924 15504.2028   24  296 10399.8461 20428.4943  96.4%   599  284s
  1051  1085 15111.8408   29  265 10399.8461 20428.4943  96.4%   552  294s
  1220  1275 14756.5851   35  232 10399.8461 20428.4943  96.4%   497  302s
  1427  1470 14378.1371   40  233 10399.8461 20428.4943  96.4%   441  311s
  1648  1698 14317.3051   47  186 10399.8461 20403.4796  96.2%   400  320s
  1886  1959 13728.9890   55  176 10399.8461 20403.4796  96.2%   366  328s
  2168  2010 13569.5003   65  177 10399.8461 20403.4796  96.2%   332  337s
  2237  2165 13386.0579   65  173 10399.8461 20403.4796  96.2%   327  345s
  2430  2429 12885.0879   74  124 10399.8461 20403.4796  96.2%   310  353s
  2724  2686 12360.8569   84  111 10399.8461 20225.5018  94.5%   287  362s
  3041  2801 13044.0666   44  255 10399.8461 20225.5018  94.5%   269  373s
  3254  2911     cutoff   54      10399.8461 20225.5018  94.5%   265  382s
  3435  2955 17071.5387   10  269 10399.8461 20225.5018  94.5%   263  392s
  3549  3030 13024.6619   12  203 10399.8461 20142.6315  93.7%   267  401s
  3660  3126 10621.8992   16  151 10399.8461 20113.9543  93.4%   270  411s
  3810  3127 12943.3821   80  538 10399.8461 20113.9543  93.4%   273  424s
  3812  3128 18608.7586   12  102 10399.8461 20113.9543  93.4%   273  428s
  3813  3129 12251.9740   83  286 10399.8461 20113.9543  93.4%   273  435s
  3814  3130 14891.4352   49  391 10399.8461 20113.9543  93.4%   273  441s
  3816  3131 16057.2249   40  390 10399.8461 20113.9543  93.4%   273  445s
  3822  3135 15339.1290   42  463 10399.8461 20113.9543  93.4%   272  450s
  3826  3138 15866.9181   20  352 10399.8461 20113.9543  93.4%   272  455s
  3828  3139 14554.6198   34  339 10399.8461 20113.9543  93.4%   272  460s
  3831  3141 14677.2178   31  353 10399.8461 20113.9543  93.4%   271  469s
  3832  3142 19395.6560    8  358 10399.8461 20113.9543  93.4%   271  473s
  3833  3142 18816.2374    9  430 10399.8461 20113.9543  93.4%   271  476s
  3835  3144 15236.9297   35  361 10399.8461 20113.9543  93.4%   271  482s
  3837  3145 12227.5550   79  360 10399.8461 20113.9543  93.4%   271  485s
  3840  3147 12157.5894   67  354 10399.8461 20113.9543  93.4%   271  492s
  3841  3148 19008.9814    9  354 10399.8461 20113.9543  93.4%   271  498s
  3842  3151 20113.9543   12  403 10399.8461 20113.9543  93.4%   278  512s
  3844  3155 20113.9543   13  388 10399.8461 20113.9543  93.4%   278  519s
  3848  3161 20113.9543   14  332 10399.8461 20113.9543  93.4%   279  527s
  3856  3175 20113.9543   15  379 10399.8461 20113.9543  93.4%   281  534s
  3872  3197 20113.9543   16  371 10399.8461 20113.9543  93.4%   285  544s
  3904  3211 19934.7650   17  360 10399.8461 20113.9543  93.4%   289  554s
  3936  3235 19821.3037   18  351 10399.8461 20113.9543  93.4%   298  564s
  3974  3254 19205.0627   19  358 10399.8461 20113.9543  93.4%   304  575s
  4040  3259 19180.1884   19  299 10399.8461 19685.2912  89.3%   310  584s
  4121  3231 16535.5707   20  331 10399.8461 19685.2912  89.3%   315  593s
  4215  3201 17563.6656   21  281 10399.8461 19255.2011  85.1%   318  603s
  4265  3193 15412.7076   21  260 10399.8461 19179.6578  84.4%   323  617s
  4326  3185 15069.9878   22  285 10399.8461 19179.6578  84.4%   327  625s
  4373  3166 11087.6705   22  212 10399.8461 19179.6578  84.4%   330  633s
  4438  3148 14993.3189   23  288 10399.8461 19165.7271  84.3%   331  641s
  4497  3138     cutoff   23      10399.8461 19165.7271  84.3%   333  649s
  4562  3140 12563.5641   25  235 10399.8461 18092.7504  74.0%   334  655s
  4627  3130 11756.9360   25  291 10399.8461 18091.6479  74.0%   334  663s
  4690  3103 12449.2611   26  199 10399.8461 18091.6479  74.0%   334  670s
  4770  3064     cutoff   26      10399.8461 18091.6479  74.0%   335  678s
  4840  3045 12338.4199   27  199 10399.8461 18091.6479  74.0%   337  686s
  4894  3022     cutoff   28      10399.8461 17625.5984  69.5%   338  694s
  4949  2992     cutoff   22      10399.8461 17625.5984  69.5%   341  702s
  5012  2954 11376.7996   19  308 10399.8461 14982.9879  44.1%   343  711s
  5083  2920     cutoff   20      10399.8461 14982.9879  44.1%   342  718s
  5177  2879 10571.6134   21  215 10399.8461 14982.9879  44.1%   342  727s
  5275  2808     cutoff   22      10399.8461 14717.0750  41.5%   343  735s
  5376  2745 10859.8869   26  210 10399.8461 14217.5967  36.7%   344  743s
  5521  2725     cutoff   27      10399.8461 14217.5967  36.7%   341  750s
  5706  2729     cutoff   23      10399.8461 12311.1969  18.4%   334  756s
  5977  2744 10531.9641   38   62 10399.8461 12311.1969  18.4%   321  763s
  6288  2761 10944.9483   35   66 10399.8461 12186.4477  17.2%   307  768s
  6655  2795 10436.5143   43   40 10399.8461 11362.2902  9.25%   292  774s
  7102  2828 10431.6701   50   37 10399.8461 11009.9636  5.87%   275  778s
  7614  2807 10411.4020   41   64 10399.8461 11009.9636  5.87%   258  783s
  8246  2811     cutoff   49      10399.8461 11009.9636  5.87%   239  786s
* 9433  2510              66    10417.025613 11009.9636  5.69%   212  789s
  9847  2645     cutoff   48      10417.0256 10932.5782  4.95%   203  792s
 11055  2267 10421.0876   46   34 10417.0256 10902.1296  4.66%   183  795s
H12157  1996                    10458.208414 10645.3522  1.79%   168  798s
 12571  1805     cutoff   39      10458.2084 10645.3522  1.79%   163  800s
H13494  1805                    10486.198480 10551.8752  0.63%   153  801s
*13495  1805              68    10486.201992 10551.8752  0.63%   153  801s
*14045   545              86    10509.716543 10528.4415  0.18%   147  803s

Cutting planes:
  Gomory: 1
  Lift-and-project: 1
  MIR: 329
  Mixing: 2
  Flow cover: 641
  RLT: 8
  Relax-and-lift: 44

Explored 15752 nodes (2125492 simplex iterations) in 805.95 seconds (277.64 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 10509.7 10486.2 10458.2 ... 9610.33

Optimal solution found (tolerance 1.00e-04)
Best objective 1.050971654273e+04, best bound 1.050971654273e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 806.06s
  Master Objective (UB) = 10509.72, θ = 133525.98
  Upper Bound (UB) = 10509.72

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 133525.98
  [DEBUG]   ✓ Scenario 0: θ = 133525.98 ≤ Q = 133525.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 133525.98 ≤ Q = 133525.98 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x3c576deb
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x3c576deb
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e-13, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-15, 2e+02]
Found heuristic solution: objective 1.211895e+13
Presolve removed 2608 rows and 1900 columns
Presolve time: 0.00s
Presolved: 485 rows, 489 columns, 1368 nonzeros
Found heuristic solution: objective 6282231.6651
Variable types: 330 continuous, 159 integer (159 binary)
Found heuristic solution: objective 6281822.0598

Root relaxation: objective -1.280052e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -128005.18    0  124 6281822.06 -128005.18   102%     -    0s
H    0     0                    -101567.6959 -128005.18  26.0%     -    0s
H    0     0                    -107024.7215 -128005.18  19.6%     -    0s
H    0     0                    -108487.9362 -116352.32  7.25%     -    0s
H    0     0                    -109900.6284 -116352.32  5.87%     -    0s
     0     0 -116352.32    0   93 -109900.63 -116352.32  5.87%     -    0s
H    0     0                    -114047.4436 -116333.60  2.00%     -    0s
     0     0 -116147.64    0   96 -114047.44 -116147.64  1.84%     -    0s
H    0     0                    -114718.2738 -116147.64  1.25%     -    0s
     0     0 -115378.44    0   93 -114718.27 -115378.44  0.58%     -    0s
H    0     0                    -114784.6310 -115364.03  0.50%     -    0s
H    0     0                    -114968.7082 -115364.03  0.34%     -    0s
     0     0 -115300.83    0   79 -114968.71 -115300.83  0.29%     -    0s
     0     0 -115230.61    0   67 -114968.71 -115230.61  0.23%     -    0s
     0     0 -115200.81    0   30 -114968.71 -115200.81  0.20%     -    0s
     0     0 -115197.30    0   28 -114968.71 -115197.30  0.20%     -    0s
     0     0 -115168.00    0   45 -114968.71 -115168.00  0.17%     -    0s
     0     0 -115161.24    0   42 -114968.71 -115161.24  0.17%     -    0s
     0     0 -115159.81    0   32 -114968.71 -115159.81  0.17%     -    0s
     0     0 -115157.15    0   37 -114968.71 -115157.15  0.16%     -    0s
     0     0 -115032.78    0   10 -114968.71 -115032.78  0.06%     -    0s
     0     0 -115000.60    0   10 -114968.71 -115000.60  0.03%     -    0s
     0     0          -    0      -114968.71 -114979.41  0.01%     -    0s

Cutting planes:
  Gomory: 2
  Implied bound: 3
  MIR: 1
  Flow cover: 7
  Relax-and-lift: 1

Explored 1 nodes (779 simplex iterations) in 0.29 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -114969 -114929 -114785 ... 6.28223e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.149687082296e+05, best bound -1.149794082847e+05, gap 0.0093%
  Subproblem solved in 0.33s
  Worst-case operational profit (Z_SP) = 109880.28
  Scenario: 46 demand increases, 14 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -114968.71
  [DEBUG]   S×d_nominal = 224848.99
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 224848.99 + -114968.71 = 109880.28
  [DEBUG]   Current θ from Master = 133525.98
  [DEBUG]   ⚠️  Z_SP ≤ θ by 23645.69 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -13135.98
  Lower Bound (LB) = 984.62
  Gap (UB-LB) = 9525.0917, Absolute Gap = 9525.0917, Relative Gap = 0.906313
  Not converged yet (gap = 9525.09 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 46 increases, 14 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135212 nonzeros
Model fingerprint: 0xfee4cfce
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -13136 (0.02s)
MIP start from previous solve produced solution with objective -13136 (0.02s)
Loaded MIP start from previous solve with objective -13136

Presolve removed 21210 rows and 8610 columns
Presolve time: 0.41s
Presolved: 26043 rows, 12370 columns, 160049 nonzeros
Variable types: 10111 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   43071    3.3500227e+04   0.000000e+00   5.028752e+04      5s
   45441    3.3521278e+04   0.000000e+00   0.000000e+00      5s
Concurrent spin time: 2.41s (can be avoided by choosing Method=3)

Solved with dual simplex

Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   21597    3.3521278e+04   0.000000e+00   0.000000e+00      8s

Root relaxation: objective 3.352128e+04, 21597 iterations, 7.40 seconds (9.75 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 33521.2782    0   99 -13135.976 33521.2782   355%     -    7s
H    0     0                    -5112.704544 33521.2782   756%     -    8s
H    0     0                    -4454.403788 33521.2782   853%     -    8s
H    0     0                    -3424.632572 33521.2782  1079%     -    8s
H    0     0                    1114.3543013 33521.2782  2908%     -    8s
H    0     0                    2046.6151283 33521.2782  1538%     -    8s
H    0     0                    2137.2547512 33521.2782  1468%     -    8s
H    0     0                    2175.3714435 33521.2782  1441%     -    8s
H    0     0                    2181.6339108 33521.2782  1437%     -    8s
H    0     0                    2196.7022440 33521.2782  1426%     -    8s
H    0     0                    2201.6698084 33521.2782  1423%     -    8s
H    0     0                    2205.0504460 33521.2782  1420%     -    8s
H    0     0                    5439.9020469 33521.2782   516%     -   10s
H    0     0                    7588.1107638 33521.2782   342%     -   10s
H    0     0                    7641.6176001 33521.2782   339%     -   10s
H    0     0                    7700.2877125 33521.2782   335%     -   10s
H    0     0                    7715.2846853 33521.2782   334%     -   10s
H    0     0                    7784.3974151 33521.2782   331%     -   10s
     0     0 27096.1865    0  241 7784.39742 27096.1865   248%     -   16s
H    0     0                    8164.6774736 27094.6119   232%     -   16s
H    0     0                    9121.1875259 27094.6119   197%     -   17s
H    0     0                    9272.8435599 27094.6119   192%     -   17s
H    0     0                    9277.8988244 27094.6119   192%     -   17s
H    0     0                    9295.6970636 27094.6119   191%     -   17s
     0     0 26470.4992    0  256 9295.69706 26470.4992   185%     -   25s
     0     0 26470.3158    0  257 9295.69706 26470.3158   185%     -   25s
     0     0 24252.4564    0  257 9295.69706 24252.4564   161%     -   28s
     0     0 23570.4328    0  311 9295.69706 23570.4328   154%     -   38s
     0     0 23323.9335    0  301 9295.69706 23323.9335   151%     -   38s
     0     0 23260.2046    0  300 9295.69706 23260.2046   150%     -   39s
     0     0 23248.2215    0  302 9295.69706 23248.2215   150%     -   39s
     0     0 23241.9304    0  300 9295.69706 23241.9304   150%     -   39s
     0     0 23241.7711    0  301 9295.69706 23241.7711   150%     -   39s
     0     0 22024.7946    0  309 9295.69706 22024.7946   137%     -   42s
H    0     0                    9318.9012031 22023.5114   136%     -   42s
     0     0 21444.4579    0  390 9318.90120 21444.4579   130%     -   50s
     0     0 21267.7386    0  404 9318.90120 21267.7386   128%     -   51s
     0     0 21235.0186    0  403 9318.90120 21235.0186   128%     -   51s
     0     0 21206.8039    0  405 9318.90120 21206.8039   128%     -   52s
     0     0 21192.4575    0  404 9318.90120 21192.4575   127%     -   52s
     0     0 21190.4896    0  407 9318.90120 21190.4896   127%     -   52s
     0     0 21188.4918    0  404 9318.90120 21188.4918   127%     -   52s
     0     0 21187.3516    0  408 9318.90120 21187.3516   127%     -   52s
     0     0 20180.2738    0  467 9318.90120 20180.2738   117%     -   60s
     0     0 19973.2798    0  450 9318.90120 19973.2798   114%     -   63s
H    0     0                    9436.7257585 19908.0778   111%     -   65s
     0     0 19908.0778    0  463 9436.72576 19908.0778   111%     -   65s
     0     0 19873.4176    0  455 9436.72576 19873.4176   111%     -   65s
     0     0 19864.2713    0  471 9436.72576 19864.2713   110%     -   66s
     0     0 19863.2333    0  473 9436.72576 19863.2333   110%     -   66s
     0     0 19765.4606    0  403 9436.72576 19765.4606   109%     -   68s
     0     0 19729.2735    0  473 9436.72576 19729.2735   109%     -   74s
     0     0 19704.2682    0  454 9436.72576 19704.2682   109%     -   75s
     0     0 19702.7126    0  458 9436.72576 19702.7126   109%     -   75s
     0     0 19625.6448    0  464 9436.72576 19625.6448   108%     -   77s
     0     0 19605.2607    0  465 9436.72576 19605.2607   108%     -   85s
     0     0 19597.1554    0  464 9436.72576 19597.1554   108%     -   85s
     0     0 19594.7758    0  464 9436.72576 19594.7758   108%     -   86s
     0     0 19594.1051    0  472 9436.72576 19594.1051   108%     -   86s
     0     0 19568.4427    0  469 9436.72576 19568.4427   107%     -   88s
     0     0 19564.3206    0  509 9436.72576 19564.3206   107%     -   91s
     0     0 19562.1352    0  509 9436.72576 19562.1352   107%     -   93s
     0     0 19561.0986    0  477 9436.72576 19561.0986   107%     -   93s
     0     0 19542.9792    0  413 9436.72576 19542.9792   107%     -   96s
     0     0 19538.6915    0  355 9436.72576 19538.6915   107%     -  103s
     0     0 19536.6906    0  485 9436.72576 19536.6906   107%     -  105s
     0     0 19535.6029    0  360 9436.72576 19535.6029   107%     -  106s
     0     0 19532.1063    0  538 9436.72576 19532.1063   107%     -  107s
     0     0 19531.7598    0  540 9436.72576 19531.7598   107%     -  108s
     0     0 19524.9043    0  531 9436.72576 19524.9043   107%     -  113s
     0     0 19524.5054    0  357 9436.72576 19524.5054   107%     -  117s
     0     0 19523.4746    0  360 9436.72576 19523.4746   107%     -  120s
     0     0 19522.7214    0  359 9436.72576 19522.7214   107%     -  121s
     0     0 19521.9059    0  363 9436.72576 19521.9059   107%     -  124s
     0     0 19521.1273    0  363 9436.72576 19521.1273   107%     -  126s
     0     2 19521.1232    0  363 9436.72576 19521.1232   107%     -  144s
     1     4 19487.1111    1  499 9436.72576 19521.1232   107%   523  151s
     3     8 19320.2166    2  509 9436.72576 19486.8507   107%  1935  159s
     7    16 19306.3533    3  517 9436.72576 19315.9425   105%  1973  167s
    15    32 19062.3714    4  442 9436.72576 19305.2070   105%  1724  180s
    31    64 18775.0496    5  454 9436.72576 19062.2967   102%  2858  197s
    63    96 18753.5009    6  518 9436.72576 18773.7897  98.9%  2422  214s
    95   158 18749.4972    7  516 9436.72576 18773.7897  98.9%  1942  234s
   157   243 18704.9341    9  521 9436.72576 18773.7897  98.9%  1687  251s
   244   313 18703.4229   10  522 9436.72576 18773.7897  98.9%  1453  266s
   327   363 18558.8867   13  519 9436.72576 18773.7897  98.9%  1358  281s
   403   411 18523.2234   15  516 9436.72576 18746.4734  98.7%  1344  295s
   474   479 18301.3670   17  490 9436.72576 18746.4734  98.7%  1306  311s
   562   548 17697.4694   19  388 9436.72576 18573.9611  96.8%  1263  327s
   633   608 16947.6170   20  376 9436.72576 18555.5778  96.6%  1244  340s
   714   639 14981.0629   20  302 9436.72576 18555.5778  96.6%  1205  352s
   747   680 16819.3218   21  373 9436.72576 18555.5778  96.6%  1209  365s
   794   711 16354.5202   22  355 9436.72576 18555.5778  96.6%  1207  377s
   839   754 16172.1554   22  322 9436.72576 18527.2581  96.3%  1215  390s
   896   795 16330.2183   23  355 9436.72576 18527.2581  96.3%  1182  404s
   969   842 16150.2729   25  357 9436.72576 18418.8196  95.2%  1168  418s
  1048   906 15991.5088   26  359 9436.72576 18418.8196  95.2%  1146  430s
  1129   972 15904.2183   27  358 9436.72576 18413.4629  95.1%  1116  444s
  1212  1036 15609.3814   29  343 9436.72576 18413.4629  95.1%  1104  456s
  1318  1121 14966.2168   29  330 9436.72576 18413.4629  95.1%  1085  469s
  1430  1194 15440.5202   30  349 9436.72576 18413.4629  95.1%  1061  484s
  1582  1305 15331.8801   31  337 9436.72576 18413.4629  95.1%  1019  500s
  1764  1382 14598.2622   33  343 9436.72576 18401.9223  95.0%   970  516s
  1889  1474 14378.2121   34  342 9436.72576 18401.9223  95.0%   973  535s
  2037  1531 13992.5504   35  348 9436.72576 18353.9907  94.5%   963  551s
  2178  1594 13547.4294   37  392 9436.72576 18108.8185  91.9%   960  570s
  2299  1704 13060.0918   38  342 9436.72576 18108.7949  91.9%   975  586s
  2457  1826 12873.1720   39  336 9436.72576 18108.7949  91.9%   968  605s
  2656  1932 12658.0591   40  384 9436.72576 18108.7949  91.9%   948  623s
  2851  2044 12372.3017   41  419 9436.72576 18108.7949  91.9%   938  642s
  3035  2134 11770.3001   44  359 9436.72576 17935.7332  90.1%   944  661s
  3203  2228 11486.1602   45  327 9436.72576 17935.7332  90.1%   953  681s
  3443  2329 10723.3098   48  286 9436.72576 17935.7332  90.1%   944  702s
  3603  2437 infeasible   48      9436.72576 17629.4095  86.8%   943  723s
  3865  2567 10587.2964   50  262 9436.72576 17629.4095  86.8%   928  744s
  4125  2671 10058.4004   54  255 9436.72576 17629.4095  86.8%   923  764s
  4346  2849     cutoff   60      9436.72576 17167.8365  81.9%   927  786s
  4610  2850 10159.4008   53  363 9436.72576 17106.2258  81.3%   925  802s
  4612  2851 11360.8776   17   99 9436.72576 17106.2258  81.3%   924  813s
  4613  2852 12934.0412   18  336 9436.72576 17106.2258  81.3%   924  827s
  4614  2853 10574.4727   21  340 9436.72576 17106.2258  81.3%   924  836s
  4615  2853 11267.7233   35  488 9436.72576 17106.2258  81.3%   924  840s
  4618  2855 15275.9682   31  509 9436.72576 17106.2258  81.3%   923  845s
  4623  2859 13271.3480   26  530 9436.72576 17106.2258  81.3%   922  851s
  4624  2859 11488.3260   37  482 9436.72576 17106.2258  81.3%   922  855s
  4627  2861 11931.4262   50  456 9436.72576 17106.2258  81.3%   921  860s
  4628  2862 10219.4417   23  466 9436.72576 17106.2258  81.3%   921  866s
  4629  2863 10966.3611   40  475 9436.72576 17106.2258  81.3%   921  873s
  4630  2863 9756.01631   23  470 9436.72576 17106.2258  81.3%   921  879s
  4631  2864 10227.8648   18  477 9436.72576 17106.2258  81.3%   920  882s
  4632  2865 15725.4232    8  482 9436.72576 17106.2258  81.3%   920  888s
  4633  2865 15240.8809   14  486 9436.72576 17106.2258  81.3%   920  891s
  4634  2866 15321.9042    7  486 9436.72576 17106.2258  81.3%   920  896s
  4635  2867 12536.4816   13  486 9436.72576 17106.2258  81.3%   920  913s
  4636  2870 17106.2258   15  467 9436.72576 17106.2258  81.3%   931  927s
  4638  2874 17106.2258   16  393 9436.72576 17106.2258  81.3%   932  936s
  4642  2880 17106.2258   17  470 9436.72576 17106.2258  81.3%   934  946s
  4650  2894 17106.2258   18  450 9436.72576 17106.2258  81.3%   935  963s
  4666  2918 17106.2258   19  522 9436.72576 17106.2258  81.3%   945  990s
  4698  2931 17106.2258   20  437 9436.72576 17106.2258  81.3%   968 1009s
  4730  2949 17106.2258   21  473 9436.72576 17106.2258  81.3%   989 1033s
  4765  2960 16297.6013   22  312 9436.72576 17106.2258  81.3%   996 1053s
  4804  2973 16606.8712   22  392 9436.72576 17106.2258  81.3%  1000 1074s
  4862  2969 15860.1198   23  376 9436.72576 17106.2258  81.3%  1005 1094s
  4906  2967 14360.5113   23  399 9436.72576 17106.2258  81.3%  1008 1118s
  4962  2969 15705.0232   24  377 9436.72576 16822.3093  78.3%  1010 1139s
  5028  2966 13765.8986   24  212 9436.72576 16822.3093  78.3%  1008 1157s
  5096  2967 15413.5958   25  383 9436.72576 16499.0465  74.8%  1007 1175s
  5183  2974 14332.1191   25  390 9436.72576 16499.0465  74.8%  1004 1192s
  5274  2962 14661.0245   26  329 9436.72576 16411.6723  73.9%   999 1209s
  5372  2940 13962.9218   26  368 9436.72576 16411.6238  73.9%   998 1226s
  5461  2948 14510.9541   27  327 9436.72576 15711.1389  66.5%   996 1240s
  5555  2936 11049.9823   27  207 9436.72576 15711.1389  66.5%   992 1254s
  5655  2920 14035.1247   28  291 9436.72576 15711.1389  66.5%   988 1270s
  5782  2893 12191.3458   28  210 9436.72576 15711.1389  66.5%   980 1284s
  5917  2855 10963.9389   30  316 9436.72576 15711.1389  66.5%   971 1300s
  6013  2862 10944.9206   31  316 9436.72576 15119.2956  60.2%   973 1320s
  6135  2839     cutoff   32      9436.72576 15119.2956  60.2%   968 1336s
  6294  2788     cutoff   28      9436.72576 14781.8075  56.6%   960 1355s
  6449  2738 11441.0285   27  198 9436.72576 14268.7173  51.2%   954 1373s
  6627  2660     cutoff   30      9436.72576 14100.2294  49.4%   944 1393s
  6808  2590     cutoff   30      9436.72576 13038.9549  38.2%   936 1412s
  6993  2501 10583.7834   29  208 9436.72576 13038.9549  38.2%   928 1433s
  7232  2374     cutoff   22      9436.72576 12378.1747  31.2%   916 1451s
  7448  2234 10070.4130   22  220 9436.72576 12378.1747  31.2%   908 1470s
  7720  2058     cutoff   29      9436.72576 11556.8954  22.5%   894 1488s
  8022  1899 infeasible   24      9436.72576 11357.1218  20.4%   877 1501s
  8533  1775 9868.74262   35   49 9436.72576 11006.6276  16.6%   837 1508s
H 8820  1536                    9560.5045276 11006.6276  15.1%   813 1508s
* 9037  1326              47    9599.7981935 11006.6276  14.7%   795 1508s
  9252  1125     cutoff   50      9599.79819 10967.9282  14.3%   778 1513s
  9687   921     cutoff   49      9599.79819 10323.9585  7.54%   744 1516s
* 9882   726              50    9768.2309208 9904.87487  1.40%   730 1516s

Cutting planes:
  Gomory: 2
  MIR: 365
  Flow cover: 745
  RLT: 16
  Relax-and-lift: 75

Explored 9972 nodes (7287249 simplex iterations) in 1517.03 seconds (712.57 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 9768.23 9599.8 9560.5 ... 8164.68

Optimal solution found (tolerance 1.00e-04)
Warning: max constraint violation (1.7916e-09) exceeds tolerance
Best objective 9.768230920802e+03, best bound 9.768230920802e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1517.11s
  Master Objective (UB) = 9768.23, θ = 150771.71
  Upper Bound (UB) = 9768.23

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 150771.71
  [DEBUG]   ✓ Scenario 0: θ = 150771.71 ≤ Q = 150771.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 150771.71 ≤ Q = 150771.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 150771.71 ≤ Q = 150771.71 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x6ed3d885
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x6ed3d885
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.144375e+13
Presolve removed 2617 rows and 1906 columns
Presolve time: 0.00s
Presolved: 476 rows, 483 columns, 1345 nonzeros
Found heuristic solution: objective 5414867.4724
Variable types: 326 continuous, 157 integer (157 binary)
Found heuristic solution: objective 5413980.7890

Root relaxation: objective -1.384905e+05, 240 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -138490.51    0  118 5413980.79 -138490.51   103%     -    0s
H    0     0                    -100676.0175 -138490.51  37.6%     -    0s
H    0     0                    -101007.6522 -138490.51  37.1%     -    0s
H    0     0                    -109194.7723 -138490.51  26.8%     -    0s
H    0     0                    -109692.7346 -138490.51  26.3%     -    0s
H    0     0                    -110384.2343 -138490.51  25.5%     -    0s
H    0     0                    -113673.1962 -138490.51  21.8%     -    0s
     0     0 -122678.44    0   85 -113673.20 -122678.44  7.92%     -    0s
H    0     0                    -119275.2290 -122612.23  2.80%     -    0s
H    0     0                    -120454.6084 -122612.23  1.79%     -    0s
     0     0 -122498.20    0   78 -120454.61 -122498.20  1.70%     -    0s
     0     0 -122497.66    0   78 -120454.61 -122497.66  1.70%     -    0s
     0     0 -121735.37    0   95 -120454.61 -121735.37  1.06%     -    0s
H    0     0                    -120651.7584 -121657.24  0.83%     -    0s
H    0     0                    -120765.7669 -121657.24  0.74%     -    0s
     0     0 -121657.24    0   91 -120765.77 -121657.24  0.74%     -    0s
     0     0 -121657.24    0   91 -120765.77 -121657.24  0.74%     -    0s
     0     0 -121447.27    0   72 -120765.77 -121447.27  0.56%     -    0s
     0     0 -121384.01    0   51 -120765.77 -121384.01  0.51%     -    0s
     0     0 -121381.15    0   51 -120765.77 -121381.15  0.51%     -    0s
     0     0 -121058.90    0   33 -120765.77 -121058.90  0.24%     -    0s
     0     0 -120991.04    0   36 -120765.77 -120991.04  0.19%     -    0s
     0     0 -120988.70    0   34 -120765.77 -120988.70  0.18%     -    0s
     0     0 -120819.14    0   19 -120765.77 -120819.14  0.04%     -    0s
     0     0 -120786.23    0    9 -120765.77 -120786.23  0.02%     -    0s
     0     0          -    0      -120765.77 -120776.46  0.01%     -    0s

Cutting planes:
  Gomory: 23
  Implied bound: 12
  MIR: 82
  Flow cover: 6
  RLT: 103
  Relax-and-lift: 3
  BQP: 3

Explored 1 nodes (808 simplex iterations) in 0.10 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -120766 -120766 -120652 ... -100676

Optimal solution found (tolerance 1.00e-04)
Best objective -1.207657668461e+05, best bound -1.207764630192e+05, gap 0.0089%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 133352.31
  Scenario: 23 demand increases, 37 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -120765.77
  [DEBUG]   S×d_nominal = 254118.07
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 254118.07 + -120765.77 = 133352.31
  [DEBUG]   Current θ from Master = 150771.71
  [DEBUG]   ⚠️  Z_SP ≤ θ by 17419.41 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -7651.18
  Lower Bound (LB) = 984.62
  Gap (UB-LB) = 8783.6061, Absolute Gap = 8783.6061, Relative Gap = 0.899201
  Not converged yet (gap = 8783.61 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 23 increases, 37 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178443 nonzeros
Model fingerprint: 0x385b7ae3
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -7651.18 (0.22s)
MIP start from previous solve produced solution with objective -7651.18 (0.23s)
Loaded MIP start from previous solve with objective -7651.18

Presolve removed 28280 rows and 11480 columns
Presolve time: 4.31s
Presolved: 34263 rows, 15740 columns, 211559 nonzeros
Variable types: 13481 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 34263 rows, 15740 columns, 211559 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
       0   -0.0000000e+00   1.644389e+03   1.271360e+10      5s
   22379   -5.2504727e+05   0.000000e+00   2.139731e+04      6s
   51527    2.8075331e+04   0.000000e+00   1.347645e+06     10s
Concurrent spin time: 2.57s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 3.352126e+04, 29460 iterations, 12.14 seconds (10.10 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 33521.2621    0  103 -7651.1773 33521.2621   538%     -   17s
H    0     0                    -5999.208264 33521.2621   659%     -   17s
H    0     0                    8217.3445511 33521.2621   308%     -   17s
H    0     0                    9132.9555468 33521.2621   267%     -   18s
H    0     0                    9286.7199696 33521.2621   261%     -   18s
H    0     0                    9410.9300800 33521.2621   256%     -   18s
H    0     0                    9502.7539647 26987.7355   184%     -   32s
     0     0 26987.7355    0  241 9502.75396 26987.7355   184%     -   32s
     0     0 26404.3052    0  201 9502.75396 26404.3052   178%     -   40s
     0     0 26403.9569    0  203 9502.75396 26403.9569   178%     -   41s
     0     0 26403.9569    0  209 9502.75396 26403.9569   178%     -   41s
     0     0 26403.9569    0  212 9502.75396 26403.9569   178%     -   41s
     0     0 24177.6263    0  255 9502.75396 24177.6263   154%     -   46s
H    0     0                    9520.1370264 23441.7840   146%     -   57s
     0     0 23441.7840    0  320 9520.13703 23441.7840   146%     -   57s
     0     0 23279.8325    0  285 9520.13703 23279.8325   145%     -   59s
     0     0 23227.3339    0  295 9520.13703 23227.3339   144%     -   60s
     0     0 23210.6720    0  303 9520.13703 23210.6720   144%     -   61s
     0     0 23207.8204    0  301 9520.13703 23207.8204   144%     -   62s
     0     0 23206.2255    0  303 9520.13703 23206.2255   144%     -   62s
     0     0 21178.6949    0  314 9520.13703 21178.6949   122%     -   78s
     0     0 21047.5369    0  345 9520.13703 21047.5369   121%     -   85s
     0     0 20954.0227    0  338 9520.13703 20954.0227   120%     -   89s
     0     0 20909.4395    0  355 9520.13703 20909.4395   120%     -   91s
     0     0 20903.0682    0  354 9520.13703 20903.0682   120%     -   92s
     0     0 20900.7221    0  356 9520.13703 20900.7221   120%     -   93s
     0     0 20896.4824    0  357 9520.13703 20896.4824   119%     -   93s
     0     0 20895.6762    0  414 9520.13703 20895.6762   119%     -   94s
     0     0 20169.4576    0  468 9520.13703 20169.4576   112%     -  109s
     0     0 19871.2164    0  440 9520.13703 19871.2164   109%     -  115s
     0     0 19822.3232    0  461 9520.13703 19822.3232   108%     -  116s
     0     0 19780.2360    0  472 9520.13703 19780.2360   108%     -  117s
     0     0 19768.6343    0  470 9520.13703 19768.6343   108%     -  117s
     0     0 19764.0521    0  476 9520.13703 19764.0521   108%     -  118s
     0     0 19756.3942    0  484 9520.13703 19756.3942   108%     -  118s
     0     0 19754.1866    0  479 9520.13703 19754.1866   107%     -  118s
     0     0 19753.4686    0  482 9520.13703 19753.4686   107%     -  118s
     0     0 19625.1079    0  473 9520.13703 19625.1079   106%     -  120s
     0     0 19604.1058    0  468 9520.13703 19604.1058   106%     -  126s
     0     0 19596.0787    0  472 9520.13703 19596.0787   106%     -  127s
     0     0 19593.5333    0  477 9520.13703 19593.5333   106%     -  128s
     0     0 19590.1780    0  482 9520.13703 19590.1780   106%     -  129s
     0     0 19589.4855    0  483 9520.13703 19589.4855   106%     -  129s
     0     0 19541.9745    0  486 9520.13703 19541.9745   105%     -  132s
     0     0 19521.6713    0  473 9520.13703 19521.6713   105%     -  141s
     0     0 19512.5216    0  477 9520.13703 19512.5216   105%     -  142s
     0     0 19510.2238    0  476 9520.13703 19510.2238   105%     -  143s
     0     0 19509.2721    0  477 9520.13703 19509.2721   105%     -  143s
     0     0 19491.6323    0  482 9520.13703 19491.6323   105%     -  146s
     0     0 19489.2340    0  484 9520.13703 19489.2340   105%     -  149s
     0     0 19488.4869    0  482 9520.13703 19488.4869   105%     -  151s
     0     0 19481.2797    0  486 9520.13703 19481.2797   105%     -  154s
     0     0 19475.3780    0  486 9520.13703 19475.3780   105%     -  159s
     0     0 19474.3058    0  495 9520.13703 19474.3058   105%     -  161s
     0     0 19471.4554    0  485 9520.13703 19471.4554   105%     -  163s
     0     0 19469.6546    0  405 9520.13703 19469.6546   105%     -  164s
     0     0 19467.8186    0  410 9520.13703 19467.8186   104%     -  165s
     0     0 19466.4249    0  400 9520.13703 19466.4249   104%     -  167s
     0     0 19441.1380    0  478 9520.13703 19441.1380   104%     -  173s
     0     0 19434.3999    0  395 9520.13703 19434.3999   104%     -  177s
     0     0 19432.3179    0  406 9520.13703 19432.3179   104%     -  179s
     0     0 19430.8540    0  478 9520.13703 19430.8540   104%     -  180s
     0     0 19427.3997    0  418 9520.13703 19427.3997   104%     -  182s
     0     0 19425.6734    0  491 9520.13703 19425.6734   104%     -  182s
     0     0 19415.9155    0  484 9520.13703 19415.9155   104%     -  183s
     0     0 19415.3666    0  491 9520.13703 19415.3666   104%     -  186s
     0     0 19413.6578    0  491 9520.13703 19413.6578   104%     -  190s
     0     0 19413.0597    0  347 9520.13703 19413.0597   104%     -  194s
     0     0 19412.5618    0  482 9520.13703 19412.5618   104%     -  197s
     0     0 19412.2203    0  482 9520.13703 19412.2203   104%     -  198s
     0     2 19412.2203    0  482 9520.13703 19412.2203   104%     -  238s
     1     4 19280.3716    1  384 9520.13703 19412.2203   104%  1532  246s
     3     8 18875.1861    2  402 9520.13703 19280.1741   103%  2777  254s
     7    16 18477.3727    3  402 9520.13703 19150.5930   101%  2688  269s
    15    32 18258.9435    4  323 9520.13703 18476.6885  94.1%  3453  281s
    31    50 15632.2745    5  293 9520.13703 18370.7563  93.0%  3558  332s
    49    82 16848.5446    6  497 9520.13703 18370.5566  93.0%  5256  354s
    81   200 16793.2996    7  488 9520.13703 18370.5566  93.0%  4014  386s
   199   235 16595.3847    9  466 9520.13703 18370.5566  93.0%  2600  404s
   234   265 16588.3165   10  465 9520.13703 18370.5566  93.0%  2394  426s
   268   310 16200.4171   10  404 9520.13703 18370.5566  93.0%  2338  446s
   317   344 16569.2066   11  454 9520.13703 18370.5566  93.0%  2217  468s
   365   386 15592.0947   10  273 9520.13703 18370.5566  93.0%  2113  486s
   429   416 15639.9898   10  271 9520.13703 18370.5566  93.0%  1949  505s
   497   458 15265.2065   11  276 9520.13703 18370.5566  93.0%  1843  528s
   562   497 16444.0128   12  452 9520.13703 18370.5566  93.0%  1797  547s
   633   527 14404.8993   12  243 9520.13703 18370.5566  93.0%  1711  567s
   705   559 15996.8380   13  399 9520.13703 18370.5566  93.0%  1661  589s
   787   598 14283.6304   14  386 9520.13703 17811.2795  87.1%  1600  613s
   870   647 13423.8365   13  369 9520.13703 17810.4125  87.1%  1563  640s
   951   711 15795.0212   14  383 9520.13703 17810.4125  87.1%  1533  659s
  1029   769 15517.7204   15  373 9520.13703 17810.4125  87.1%  1512  678s
  1118   822 15334.8174   16  284 9520.13703 17642.6573  85.3%  1476  695s
  1217   864 11469.3752   16  133 9520.13703 17642.6573  85.3%  1431  720s
  1309   913 15054.2641   15  377 9520.13703 17642.6573  85.3%  1425  742s
  1407   969 15281.0655   17  269 9520.13703 17642.6573  85.3%  1407  766s
  1498  1027 15162.2199   18  278 9520.13703 17642.6573  85.3%  1416  793s
  1625  1087 15112.7643   19  200 9520.13703 17034.4680  78.9%  1386  819s
  1755  1127 12355.2671   20  154 9520.13703 16993.4224  78.5%  1372  848s
  1888  1161 13348.6279   21  304 9520.13703 16967.2103  78.2%  1357  875s
  1968  1205 12478.4694   19  133 9520.13703 16857.7341  77.1%  1360  901s
  2074  1265 12675.2394   22  296 9520.13703 16857.7341  77.1%  1355  929s
  2177  1330 12584.8309   23  276 9520.13703 16857.7341  77.1%  1350  955s
  2326  1408 11789.0872   25   87 9520.13703 16857.7341  77.1%  1335  984s
  2482  1447 10906.4587   31   70 9520.13703 16857.7341  77.1%  1322 1014s
  2645  1465 12052.6198   14  280 9520.13703 16699.5238  75.4%  1309 1051s
  2805  1492 11798.7670   16  283 9520.13703 16594.4132  74.3%  1312 1079s
  2842  1500 11650.7058   17  280 9520.13703 16594.4132  74.3%  1321 1108s
  2892  1504     cutoff   18      9520.13703 16594.4132  74.3%  1336 1138s
  2969  1531     cutoff   16      9520.13703 16585.2962  74.2%  1339 1166s
  3046  1568 12536.8858   15  181 9520.13703 16585.2962  74.2%  1335 1195s
  3206  1613 9689.40053   20   79 9520.13703 16585.2962  74.2%  1316 1232s
  3426  1690 14717.3018   10  360 9520.13703 16585.2962  74.2%  1292 1275s
  3624  1756     cutoff   12      9520.13703 16585.2962  74.2%  1284 1324s
  3923  1814     cutoff   16      9520.13703 16463.8987  72.9%  1255 1373s
  4197  1844 12596.1001   13  236 9520.13703 16424.2490  72.5%  1240 1416s
  4294  1900     cutoff   14      9520.13703 16328.0684  71.5%  1248 1460s
  4496  1971     cutoff   20      9520.13703 16328.0684  71.5%  1250 1509s
  4772  2068 12885.5307   13  348 9520.13703 16175.8857  69.9%  1243 1555s
  4997  2178 11466.5982   18  328 9520.13703 16175.8857  69.9%  1248 1603s
  5276  2275     cutoff   16      9520.13703 16153.5381  69.7%  1244 1661s
  5603  2276 15084.0022   15  482 9520.13703 15856.4612  66.6%  1230 1683s
  5605  2277 12307.7006   24  103 9520.13703 15856.4612  66.6%  1229 1699s
  5606  2278 13329.0922   16  338 9520.13703 15856.4612  66.6%  1229 1715s
  5607  2279 15248.5110   12  347 9520.13703 15856.4612  66.6%  1229 1731s
  5608  2279 10667.3609   23  450 9520.13703 15856.4612  66.6%  1228 1737s
  5609  2280 13033.9197   10  508 9520.13703 15856.4612  66.6%  1228 1743s
  5610  2281 11007.9495   25  535 9520.13703 15856.4612  66.6%  1228 1747s
  5613  2283 10119.8749   27  493 9520.13703 15856.4612  66.6%  1227 1751s
  5614  2283 10033.9712   29  509 9520.13703 15856.4612  66.6%  1227 1758s
  5616  2285 10301.2940   26  532 9520.13703 15856.4612  66.6%  1227 1762s
  5617  2285 10140.1855   15  515 9520.13703 15856.4612  66.6%  1226 1766s
  5618  2286 11295.6275   20  538 9520.13703 15856.4612  66.6%  1226 1774s
  5619  2287 10664.3760   20  508 9520.13703 15856.4612  66.6%  1226 1776s
  5621  2288 14149.2913    8  477 9520.13703 15856.4612  66.6%  1226 1781s
  5622  2289 14317.2996   16  537 9520.13703 15856.4612  66.6%  1225 1789s
  5623  2289 13607.6197   18  490 9520.13703 15856.4612  66.6%  1225 1804s
  5624  2290 14811.5807    8  494 9520.13703 15856.4612  66.6%  1225 1810s
  5625  2291 13414.0538   13  539 9520.13703 15856.4612  66.6%  1225 1816s
  5626  2291 14022.0959   12  539 9520.13703 15856.4612  66.6%  1225 1824s
  5627  2292 13251.1107    8  539 9520.13703 15856.4612  66.6%  1224 1845s
  5628  2296 15856.4612   11  513 9520.13703 15856.4612  66.6%  1239 1867s
  5630  2299 15856.4612   12  506 9520.13703 15856.4612  66.6%  1240 1881s
  5634  2306 15856.4612   13  514 9520.13703 15856.4612  66.6%  1242 1895s
  5642  2319 15856.4612   14  559 9520.13703 15856.4612  66.6%  1246 1918s
  5658  2346 15856.4612   15  594 9520.13703 15856.4612  66.6%  1260 1948s
  5690  2367 15856.4612   16  478 9520.13703 15856.4612  66.6%  1273 1980s
  5722  2400 15856.4612   17  474 9520.13703 15856.4612  66.6%  1291 2023s
  5768  2414 13384.8001   18  457 9520.13703 15856.4612  66.6%  1322 2064s
  5857  2391 15856.4612   19  482 9520.13703 15856.4612  66.6%  1333 2099s
  5923  2385 15856.4612   20  435 9520.13703 15856.4612  66.6%  1359 2137s
  5997  2375 9772.93907   20  451 9520.13703 15856.4612  66.6%  1384 2172s
  6058  2368 13327.9621   21  419 9520.13703 15856.4612  66.6%  1416 2206s
  6124  2372 12205.2131   22  357 9520.13703 15856.4612  66.6%  1435 2233s
  6192  2372 11024.7390   23  309 9520.13703 15856.4612  66.6%  1456 2261s
  6258  2367     cutoff   23      9520.13703 15856.4612  66.6%  1469 2295s
  6336  2358 10882.1910   25  324 9520.13703 15856.4612  66.6%  1482 2326s
  6421  2340 10822.3974   28  321 9520.13703 15856.4612  66.6%  1491 2355s
  6500  2342 10616.0947   31  193 9520.13703 15856.4612  66.6%  1503 2384s
  6578  2333     cutoff   34      9520.13703 15856.4612  66.6%  1510 2412s
  6652  2314 11664.1946   21  179 9520.13703 15856.4612  66.6%  1523 2446s
  6722  2289 11321.7757   22  137 9520.13703 15856.4612  66.6%  1536 2484s
  6806  2286 11196.3785   24  131 9520.13703 15856.4612  66.6%  1546 2516s
  6891  2289     cutoff   32      9520.13703 15856.4612  66.6%  1557 2549s
  6990  2291 12270.3246   23  164 9520.13703 15856.4612  66.6%  1564 2582s
  7119  2266 10051.9810   30  102 9520.13703 15369.1924  61.4%  1564 2616s
  7174  2256     cutoff   33      9520.13703 15369.1924  61.4%  1573 2644s
  7249  2256 11797.0952   21  210 9520.13703 14840.6313  55.9%  1578 2680s
  7333  2245 11039.0385   26  183 9520.13703 14793.4841  55.4%  1581 2718s
  7441  2223 9989.36349   21  137 9520.13703 14793.4841  55.4%  1587 2766s
  7589  2200 12468.0256   17  281 9520.13703 14793.4841  55.4%  1593 2805s
  7698  2180     cutoff   20      9520.13703 14750.4034  54.9%  1605 2842s
  7739  2165     cutoff   20      9520.13703 14040.2734  47.5%  1612 2883s
  7809  2152 11248.1251   18  252 9520.13703 14040.2734  47.5%  1619 2919s
  7867  2120 11171.5970   19  225 9520.13703 13877.9446  45.8%  1625 2960s
  7972  2076 10926.6888   20  214 9520.13703 13824.0818  45.2%  1629 3009s
  8127  2014     cutoff   20      9520.13703 13686.8145  43.8%  1633 3056s
  8306  1962     cutoff   19      9520.13703 13498.2376  41.8%  1642 3104s
  8473  1851     cutoff   18      9520.13703 13263.0460  39.3%  1656 3154s
  8702  1689 10510.2145   23  391 9520.13703 12988.2696  36.4%  1661 3206s
  9002  1494     cutoff   23      9520.13703 12598.7507  32.3%  1659 3256s
  9357  1214 11504.2099   23  401 9520.13703 12387.7061  30.1%  1645 3298s
  9772   976     cutoff   23      9520.13703 11612.7875  22.0%  1613 3324s
*10064   764              40    9529.3465070 11455.9509  20.2%  1580 3324s
 10148   710     cutoff   26      9529.34651 11428.0431  19.9%  1571 3334s
 10424   610 9672.04543   37   12 9529.34651 9906.33612  3.96%  1532 3340s
 10854   448     cutoff   55      9529.34651 9727.26140  2.08%  1473 3345s

Cutting planes:
  Learned: 3
  Gomory: 1
  MIR: 465
  Mixing: 1
  Flow cover: 839
  RLT: 11
  Relax-and-lift: 94

Explored 11086 nodes (16112304 simplex iterations) in 3347.04 seconds (1876.45 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: 9529.35 9520.14 9502.75 ... -7651.18

Optimal solution found (tolerance 1.00e-04)
Best objective 9.529346506964e+03, best bound 9.529346506964e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3347.09s
  Master Objective (UB) = 9529.35, θ = 151615.46
  Upper Bound (UB) = 9529.35

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 151615.46
  [DEBUG]   ✓ Scenario 0: θ = 151615.46 ≤ Q = 151615.46 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 151615.46 ≤ Q = 151615.46 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 151615.46 ≤ Q = 151615.46 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 151615.46 ≤ Q = 151615.46 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x506cbdef
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xaf934211
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [7e-13, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [5e-15, 2e+02]
Found heuristic solution: objective 1.146367e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.00s
Presolved: 494 rows, 498 columns, 1393 nonzeros
Found heuristic solution: objective 5618881.7269
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.360296e+05, 250 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -136029.57    0  124 5618881.73 -136029.57   102%     -    0s
H    0     0                    -101220.2674 -136029.57  34.4%     -    0s
H    0     0                    -101385.7683 -136029.57  34.2%     -    0s
H    0     0                    -104840.4970 -120516.66  15.0%     -    0s
H    0     0                    -109982.0151 -120516.66  9.58%     -    0s
     0     0 -120516.66    0   85 -109982.02 -120516.66  9.58%     -    0s
H    0     0                    -113807.0295 -120448.59  5.84%     -    0s
H    0     0                    -116382.1737 -120448.59  3.49%     -    0s
     0     0 -118665.24    0   93 -116382.17 -118665.24  1.96%     -    0s
     0     0 -118252.77    0   84 -116382.17 -118252.77  1.61%     -    0s
H    0     0                    -116955.4689 -118250.07  1.11%     -    0s
H    0     0                    -117160.2096 -118250.07  0.93%     -    0s
     0     0 -118235.01    0   85 -117160.21 -118235.01  0.92%     -    0s
     0     0 -118234.98    0   85 -117160.21 -118234.98  0.92%     -    0s
     0     0 -118074.32    0   64 -117160.21 -118074.32  0.78%     -    0s
H    0     0                    -117177.8146 -118041.30  0.74%     -    0s
     0     0 -118041.30    0   59 -117177.81 -118041.30  0.74%     -    0s
     0     0 -118041.30    0   60 -117177.81 -118041.30  0.74%     -    0s
     0     0 -118039.75    0   61 -117177.81 -118039.75  0.74%     -    0s
     0     0 -117748.64    0   57 -117177.81 -117748.64  0.49%     -    0s
     0     0 -117748.32    0   56 -117177.81 -117748.32  0.49%     -    0s
     0     0 -117705.15    0   55 -117177.81 -117705.15  0.45%     -    0s
     0     0 -117482.45    0   31 -117177.81 -117482.45  0.26%     -    0s
H    0     0                    -117183.4300 -117455.62  0.23%     -    0s
     0     0 -117400.67    0   38 -117183.43 -117400.67  0.19%     -    0s
     0     0 -117391.36    0   39 -117183.43 -117391.36  0.18%     -    0s
     0     0 -117297.95    0   22 -117183.43 -117297.95  0.10%     -    0s
     0     0 -117295.55    0   21 -117183.43 -117295.55  0.10%     -    0s
     0     0 -117280.91    0   20 -117183.43 -117280.91  0.08%     -    0s
     0     0 -117267.72    0   16 -117183.43 -117267.72  0.07%     -    0s
     0     0 -117267.72    0   30 -117183.43 -117267.72  0.07%     -    0s
     0     0 -117227.87    0   19 -117183.43 -117227.87  0.04%     -    0s
     0     0 -117216.07    0    5 -117183.43 -117216.07  0.03%     -    0s
     0     0 -117206.52    0    7 -117183.43 -117206.52  0.02%     -    0s
     0     0 -117205.15    0    7 -117183.43 -117205.15  0.02%     -    0s
     0     0          -    0      -117183.43 -117193.05  0.01%     -    0s

Cutting planes:
  Gomory: 1
  MIR: 5
  Flow cover: 4

Explored 1 nodes (922 simplex iterations) in 0.39 seconds (0.07 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -117183 -117178 -117160 ... -101220

Optimal solution found (tolerance 1.00e-04)
Best objective -1.171834300272e+05, best bound -1.171930516525e+05, gap 0.0082%
  Subproblem solved in 0.41s
  Worst-case operational profit (Z_SP) = 136360.37
  Scenario: 24 demand increases, 36 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -117183.43
  [DEBUG]   S×d_nominal = 253543.80
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 253543.80 + -117183.43 = 136360.37
  [DEBUG]   Current θ from Master = 151615.46
  [DEBUG]   ⚠️  Z_SP ≤ θ by 15255.09 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -5725.75
  Lower Bound (LB) = 984.62
  Gap (UB-LB) = 8544.7217, Absolute Gap = 8544.7217, Relative Gap = 0.896674
  Not converged yet (gap = 8544.72 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 24 increases, 36 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221674 nonzeros
Model fingerprint: 0x4e802aaf
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 35350 rows and 14350 columns (presolve time = 5s)...
Presolve removed 35350 rows and 14350 columns
Presolve time: 6.08s
Presolved: 42483 rows, 19110 columns, 263069 nonzeros
Variable types: 16851 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -362494.4633
Found heuristic solution: objective -209555.5527

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 42483 rows, 19110 columns, 263069 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
       0   -0.0000000e+00   1.787280e+03   7.653098e+08      7s
   22542   -2.6628050e+04   0.000000e+00   2.806270e+07     10s
   29259    8.2543563e+03   0.000000e+00   3.515451e+06     15s
   37074    2.2953635e+04   0.000000e+00   2.412375e+06     20s
Concurrent spin time: 4.85s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 3.345250e+04, 34019 iterations, 15.10 seconds (12.60 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 33452.5004    0  112 -209555.55 33452.5004   116%     -   22s
H    0     0                    -203936.7074 33452.5004   116%     -   22s
H    0     0                    -93104.49117 33452.5004   136%     -   22s
H    0     0                    -89312.08189 33452.5004   137%     -   22s
H    0     0                    -89248.01825 33452.5004   137%     -   22s
H    0     0                    -29690.49645 33452.5004   213%     -   22s
H    0     0                    -9718.799871 33452.5004   444%     -   22s
H    0     0                    8424.5751714 33452.5004   297%     -   22s
H    0     0                    8512.4574303 33452.5004   293%     -   23s
H    0     0                    8747.9644615 33452.5004   282%     -   23s
H    0     0                    9102.6165923 33452.5004   268%     -   23s
H    0     0                    9115.9270172 33452.5004   267%     -   23s
     0     0 27355.8623    0  203 9115.92702 27355.8623   200%     -   38s
     0     0 26849.0873    0  187 9115.92702 26849.0873   195%     -   50s
     0     0 26848.4464    0  211 9115.92702 26848.4464   195%     -   51s
     0     0 26848.4464    0  253 9115.92702 26848.4464   195%     -   52s
     0     0 26848.4464    0  204 9115.92702 26848.4464   195%     -   55s
     0     0 26848.4464    0  200 9115.92702 26848.4464   195%     -   56s
     0     0 26848.4464    0  199 9115.92702 26848.4464   195%     -   56s
     0     0 26848.4464    0  199 9115.92702 26848.4464   195%     -   56s
     0     0 24417.6737    0  267 9115.92702 24417.6737   168%     -   62s
     0     0 24011.8157    0  283 9115.92702 24011.8157   163%     -   66s
     0     0 23958.6825    0  283 9115.92702 23958.6825   163%     -   67s
     0     0 23948.8054    0  288 9115.92702 23948.8054   163%     -   68s
     0     0 23938.1473    0  292 9115.92702 23938.1473   163%     -   68s
     0     0 23930.4793    0  304 9115.92702 23930.4793   163%     -   69s
     0     0 23929.3884    0  300 9115.92702 23929.3884   163%     -   69s
     0     0 23927.7833    0  308 9115.92702 23927.7833   162%     -   69s
     0     0 23927.7562    0  308 9115.92702 23927.7562   162%     -   69s
     0     0 22166.3792    0  373 9115.92702 22166.3792   143%     -   83s
     0     0 21877.3575    0  380 9115.92702 21877.3575   140%     -   92s
     0     0 21757.2651    0  388 9115.92702 21757.2651   139%     -   96s
     0     0 21653.7715    0  395 9115.92702 21653.7715   138%     -   98s
     0     0 21576.4447    0  402 9115.92702 21576.4447   137%     -  101s
     0     0 21544.8101    0  404 9115.92702 21544.8101   136%     -  102s
     0     0 21517.3096    0  354 9115.92702 21517.3096   136%     -  103s
     0     0 21465.5149    0  396 9115.92702 21465.5149   135%     -  106s
     0     0 21416.6016    0  409 9115.92702 21416.6016   135%     -  107s
     0     0 21395.3988    0  399 9115.92702 21395.3988   135%     -  107s
     0     0 21391.1886    0  407 9115.92702 21391.1886   135%     -  108s
     0     0 21390.1489    0  395 9115.92702 21390.1489   135%     -  108s
     0     0 20483.4944    0  431 9115.92702 20483.4944   125%     -  118s
     0     0 20143.4041    0  422 9115.92702 20143.4041   121%     -  126s
     0     0 20068.6191    0  436 9115.92702 20068.6191   120%     -  129s
     0     0 20050.6631    0  437 9115.92702 20050.6631   120%     -  130s
     0     0 20025.8932    0  436 9115.92702 20025.8932   120%     -  132s
     0     0 20011.9508    0  420 9115.92702 20011.9508   120%     -  133s
     0     0 19997.6844    0  441 9115.92702 19997.6844   119%     -  134s
     0     0 19992.0881    0  442 9115.92702 19992.0881   119%     -  135s
     0     0 19983.4200    0  446 9115.92702 19983.4200   119%     -  136s
     0     0 19979.2617    0  451 9115.92702 19979.2617   119%     -  137s
     0     0 19978.5592    0  455 9115.92702 19978.5592   119%     -  137s
     0     0 19822.8824    0  457 9115.92702 19822.8824   117%     -  143s
     0     0 19791.0725    0  466 9115.92702 19791.0725   117%     -  152s
     0     0 19786.8389    0  468 9115.92702 19786.8389   117%     -  153s
     0     0 19779.9902    0  468 9115.92702 19779.9902   117%     -  154s
     0     0 19777.2200    0  406 9115.92702 19777.2200   117%     -  154s
     0     0 19775.3215    0  407 9115.92702 19775.3215   117%     -  155s
     0     0 19772.1035    0  464 9115.92702 19772.1035   117%     -  155s
     0     0 19771.3912    0  468 9115.92702 19771.3912   117%     -  156s
     0     0 19689.7967    0  459 9115.92702 19689.7967   116%     -  159s
H    0     0                    9289.1000740 19689.1956   112%     -  171s
     0     0 19664.6537    0  483 9289.10007 19664.6537   112%     -  180s
     0     0 19649.9694    0  418 9289.10007 19649.9694   112%     -  182s
     0     0 19640.8596    0  482 9289.10007 19640.8596   111%     -  182s
     0     0 19638.2315    0  485 9289.10007 19638.2315   111%     -  183s
     0     0 19637.6531    0  488 9289.10007 19637.6531   111%     -  183s
     0     0 19618.4190    0  420 9289.10007 19618.4190   111%     -  185s
     0     0 19613.5724    0  362 9289.10007 19613.5724   111%     -  188s
     0     0 19613.0715    0  364 9289.10007 19613.0715   111%     -  189s
     0     0 19608.1567    0  361 9289.10007 19608.1567   111%     -  190s
     0     0 19605.6719    0  360 9289.10007 19605.6719   111%     -  207s
     0     0 19605.5708    0  365 9289.10007 19605.5708   111%     -  208s
     0     0 19602.5864    0  360 9289.10007 19602.5864   111%     -  210s
     0     0 19601.2906    0  362 9289.10007 19601.2906   111%     -  210s
     0     0 19596.9993    0  424 9289.10007 19596.9993   111%     -  211s
     0     0 19596.0684    0  365 9289.10007 19596.0684   111%     -  211s
     0     0 19593.7575    0  371 9289.10007 19593.7575   111%     -  212s
     0     0 19593.6936    0  371 9289.10007 19593.6936   111%     -  212s
     0     2 19593.4658    0  371 9289.10007 19593.4658   111%     -  251s
     1     4 19571.2690    1  355 9289.10007 19593.4658   111%   841  256s
     3     8 19488.8007    2  353 9289.10007 19574.4930   111%  1107  266s
     7    16 18962.5653    3  337 9289.10007 19557.6887   111%  1764  283s
    15    32 18926.0178    4  326 9289.10007 19323.6697   108%  2775  306s
    31    64 18551.5129    5  322 9289.10007 19316.6089   108%  5340  340s
    63    81 17065.7412    6  415 9289.10007 19066.2756   105%  4695  401s
    80   114 17646.3021    7  363 9289.10007 19066.2756   105%  5217  460s
   113   231 16423.0010    8  362 9289.10007 19066.2756   105%  4720  508s
H  202   231                    9329.0991877 19066.2756   104%  3641  508s
   230   313 17159.2204    8  328 9329.09919 19066.2756   104%  3534  532s
H  324   369                    9375.4667445 19066.2756   103%  3117  560s
H  354   369                    9502.7539647 19066.2756   101%  3179  560s
   398   426 16928.7076    9  413 9502.75396 19066.2756   101%  3009  584s
   482   482 14636.6088   10  236 9502.75396 19066.2756   101%  2819  609s
H  494   482                    9520.1370264 19066.2756   100%  2814  609s
   562   534 16581.1377   10  407 9520.13703 19066.2756   100%  2710  640s
   640   578 16140.8404   10  318 9520.13703 19066.2756   100%  2631  669s
   718   614 15641.2309   10  293 9520.13703 19065.4576   100%  2568  692s
   778   643 15097.7812   10  287 9520.13703 19065.4576   100%  2637  720s
   837   690 14218.0400    9  355 9520.13703 19065.4576   100%  2673  750s
   895   725 16322.8655   11  403 9520.13703 19065.4576   100%  2762  777s
   952   763 15615.3956   11  300 9520.13703 19065.4576   100%  2786  803s
  1032   783 15475.4659   12  285 9520.13703 19065.4576   100%  2810  832s
  1078   811 14444.4443   12  390 9520.13703 19065.4576   100%  2819  864s
  1148   839 15228.8699   13  240 9520.13703 19065.4576   100%  2836  901s
  1232   872 15114.5435   12  211 9520.13703 18937.2947  98.9%  2841  939s
  1304   918 13068.2471   12  207 9520.13703 18937.2181  98.9%  2895  982s
  1384   961 14897.9289   13  207 9520.13703 18937.2181  98.9%  2925 1016s
  1476   992 13117.9848   14  173 9520.13703 18937.2181  98.9%  2929 1062s
  1540  1041 13183.7842   14  271 9520.13703 18937.2181  98.9%  2983 1104s
  1609  1074 12837.7628   15  171 9520.13703 18937.2181  98.9%  3026 1137s
  1661  1103 12219.1138   16  174 9520.13703 18937.2181  98.9%  3060 1172s
  1704  1129 11474.6712   16  110 9520.13703 18937.2181  98.9%  3068 1215s
  1756  1176 infeasible   17      9520.13703 18937.2181  98.9%  3082 1258s
  1836  1232 infeasible   17      9520.13703 18188.0100  91.0%  3080 1305s
  1937  1294 10132.7167   17  125 9520.13703 18179.5256  91.0%  3047 1352s
  2061  1334 10079.7966   19   86 9520.13703 18152.4517  90.7%  3010 1404s
  2159  1444 14389.4803   12  197 9520.13703 18152.4517  90.7%  2976 1451s
  2313  1538 12270.8412   16  101 9520.13703 18152.4517  90.7%  2931 1497s
  2519  1592 9781.04756   28   58 9520.13703 17880.4746  87.8%  2841 1552s
  2649  1614 16065.5600    9  247 9520.13703 17784.2418  86.8%  2867 1602s
  2691  1651 14983.5315   10  226 9520.13703 17784.2418  86.8%  2889 1648s
  2750  1674 13914.3693   11  177 9520.13703 17784.2418  86.8%  2885 1708s
  2839  1715 11632.8749   13  157 9520.13703 17722.9658  86.2%  2886 1765s
  2978  1804 16964.2192    7  408 9520.13703 17722.9658  86.2%  2877 1823s
  3154  1882 12425.4350   11  271 9520.13703 17722.9658  86.2%  2867 1883s
  3357  1940 11197.8847   14  261 9520.13703 17596.7075  84.8%  2847 1949s
  3546  2037 12923.8035   13  183 9520.13703 17439.9470  83.2%  2862 2018s
  3750  2096 16125.5888    9  289 9520.13703 17366.5649  82.4%  2874 2097s
  4002  2174 infeasible   17      9520.13703 17366.5649  82.4%  2862 2171s
  4193  2279 12126.4313   10  360 9520.13703 17287.8942  81.6%  2895 2253s
  4443  2383 11543.0163   13  203 9520.13703 17287.8942  81.6%  2887 2333s
  4716  2415 10067.4865   18  304 9520.13703 17287.8942  81.6%  2878 2402s
  4748  2433 9966.00212   19  294 9520.13703 17287.8942  81.6%  2884 2473s
  4794  2452 9850.80041   20  253 9520.13703 17287.8942  81.6%  2885 2542s
  4845  2496 9796.08145   21  199 9520.13703 17243.8686  81.1%  2883 2615s
  4981  2563 12436.3032   16  169 9520.13703 17243.3718  81.1%  2869 2704s
  5201  2659 13165.6566   11  398 9520.13703 17243.3718  81.1%  2853 2789s
  5471  2660 10460.0574   27  371 9520.13703 17025.3260  78.8%  2843 2817s
  5473  2661 13646.1575   14  112 9520.13703 17025.3260  78.8%  2842 2843s
  5474  2662 16162.0357   13  336 9520.13703 17025.3260  78.8%  2842 2864s
  5475  2663 11748.3154   21  360 9520.13703 17025.3260  78.8%  2841 2881s
  5476  2663 13036.7872   14  376 9520.13703 17025.3260  78.8%  2841 2892s
  5477  2664 11643.4488   36  446 9520.13703 17025.3260  78.8%  2840 2898s
  5478  2665 14660.0655   13  377 9520.13703 17025.3260  78.8%  2840 2903s
  5479  2665 12307.0488   28  457 9520.13703 17025.3260  78.8%  2839 2908s
  5480  2666 10222.5035   20  378 9520.13703 17025.3260  78.8%  2839 2915s
  5482  2667 10643.6148   23  508 9520.13703 17025.3260  78.8%  2838 2923s
  5483  2668 10330.6509   43  387 9520.13703 17025.3260  78.8%  2837 2936s
  5485  2669 14311.6942   17  411 9520.13703 17025.3260  78.8%  2836 2942s
  5486  2670 11006.8678   24  481 9520.13703 17025.3260  78.8%  2836 2946s
  5487  2671 13427.0902   20  481 9520.13703 17025.3260  78.8%  2835 2954s
  5488  2671 10060.9756   26  489 9520.13703 17025.3260  78.8%  2835 2962s
  5489  2672 12679.8686   22  428 9520.13703 17025.3260  78.8%  2834 2967s
  5491  2673 12556.5920   15  410 9520.13703 17025.3260  78.8%  2833 2974s
  5492  2674 13065.5460   13  477 9520.13703 17025.3260  78.8%  2833 2982s
  5493  2675 12731.0601   29  510 9520.13703 17025.3260  78.8%  2832 3003s
  5494  2675 15071.3811   15  459 9520.13703 17025.3260  78.8%  2831 3011s
  5495  2676 15391.2668   18  450 9520.13703 17025.3260  78.8%  2831 3019s
  5496  2677 10849.2504   22  478 9520.13703 17025.3260  78.8%  2830 3029s
  5497  2677 16644.6221    7  474 9520.13703 17025.3260  78.8%  2830 3031s
  5498  2678 14138.5752   12  474 9520.13703 17025.3260  78.8%  2829 3035s
  5499  2679 11738.1833   21  486 9520.13703 17025.3260  78.8%  2829 3040s
  5500  2679 14438.6828   14  486 9520.13703 17025.3260  78.8%  2828 3052s
  5501  2680 16157.4050   19  486 9520.13703 17025.3260  78.8%  2828 3087s
  5502  2684 17025.3260   10  464 9520.13703 17025.3260  78.8%  2852 3104s
  5504  2687 17025.3260   11  443 9520.13703 17025.3260  78.8%  2853 3123s
  5508  2694 17025.3260   12  444 9520.13703 17025.3260  78.8%  2853 3143s
  5516  2707 17025.3260   13  457 9520.13703 17025.3260  78.8%  2856 3167s
  5532  2725 15029.7495   14  339 9520.13703 17025.3260  78.8%  2869 3249s
  5555  2749 15530.3316   15  374 9520.13703 17025.3260  78.8%  2884 3309s
  5587  2780     cutoff   16      9520.13703 17025.3260  78.8%  2888 3374s
  5658  2792 17025.3260   15  335 9520.13703 17025.3260  78.8%  2901 3422s
  5746  2778 17025.3260   16  375 9520.13703 17025.3260  78.8%  2921 3464s
  5852  2757 15750.4670   17  414 9520.13703 17025.3260  78.8%  2912 3501s
  5932  2750 15579.3439   18  431 9520.13703 17025.3260  78.8%  2913 3540s
  6018  2741 14417.2378   19  427 9520.13703 17025.3260  78.8%  2921 3572s
  6058  2742 14360.4096   20  395 9520.13703 17025.3260  78.8%  2932 3599s
  6112  2725 9636.27218   33   16 9520.13703 17025.3260  78.8%  2935 3600s

Cutting planes:
  Learned: 1
  Gomory: 3
  MIR: 399
  Flow cover: 944
  RLT: 17
  Relax-and-lift: 105

Explored 6113 nodes (18071745 simplex iterations) in 3600.30 seconds (2082.91 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 9520.14 9502.75 9375.47 ... 8424.58

Time limit reached
Best objective 9.520137026402e+03, best bound 1.702532604486e+04, gap 78.8349%
  WARNING: Time limit reached. Using best solution found (gap: 78.83%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.33s
  Master Objective (UB) = 9520.14, θ = 151302.20
  Upper Bound (UB) = 9520.14

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 151302.20
  [DEBUG]   ✓ Scenario 0: θ = 151302.20 ≤ Q = 151302.20 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 151302.20 ≤ Q = 151302.20 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 151302.20 ≤ Q = 151302.20 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 151302.20 ≤ Q = 151302.20 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 151302.20 ≤ Q = 151302.20 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x5be59507
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x5be59507
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.165594e+13
Presolve removed 2617 rows and 1906 columns
Presolve time: 0.00s
Presolved: 476 rows, 483 columns, 1345 nonzeros
Found heuristic solution: objective 5571226.6238
Variable types: 326 continuous, 157 integer (157 binary)
Found heuristic solution: objective 5570339.9403

Root relaxation: objective -1.378172e+05, 236 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -137817.17    0  120 5570339.94 -137817.17   102%     -    0s
H    0     0                    -96564.05355 -137817.17  42.7%     -    0s
H    0     0                    -97710.23843 -137817.17  41.0%     -    0s
H    0     0                    -113183.0655 -137817.17  21.8%     -    0s
     0     0 -120549.17    0   87 -113183.07 -120549.17  6.51%     -    0s
H    0     0                    -117143.5741 -120355.00  2.74%     -    0s
H    0     0                    -118273.0847 -120355.00  1.76%     -    0s
     0     0 -120355.00    0  102 -118273.08 -120355.00  1.76%     -    0s
     0     0 -119530.51    0  100 -118273.08 -119530.51  1.06%     -    0s
     0     0 -119513.48    0  100 -118273.08 -119513.48  1.05%     -    0s
     0     0 -119506.45    0  100 -118273.08 -119506.45  1.04%     -    0s
     0     0 -119408.31    0   99 -118273.08 -119408.31  0.96%     -    0s
H    0     0                    -118569.0998 -119408.31  0.71%     -    0s
     0     0 -119408.31    0   99 -118569.10 -119408.31  0.71%     -    0s
     0     2 -119408.31    0   99 -118569.10 -119408.31  0.71%     -    0s
H   37    16                    -118585.1078 -119075.59  0.41%  11.1    0s
*  395     6              42    -118587.7667 -118601.80  0.01%   7.1    0s
*  403     6              41    -118597.4049 -118601.32  0.00%   7.0    0s

Cutting planes:
  Gomory: 32
  Implied bound: 1
  MIR: 150
  Flow cover: 2
  RLT: 33

Explored 416 nodes (3332 simplex iterations) in 0.35 seconds (0.08 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -118597 -118597 -118588 ... 5.57034e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.185974048836e+05, best bound -1.185983291173e+05, gap 0.0008%
  Subproblem solved in 0.36s
  Worst-case operational profit (Z_SP) = 135520.67
  Scenario: 29 demand increases, 31 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -118597.40
  [DEBUG]   S×d_nominal = 254118.07
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 254118.07 + -118597.40 = 135520.67
  [DEBUG]   Current θ from Master = 151302.20
  [DEBUG]   ⚠️  Z_SP ≤ θ by 15781.53 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -6261.39
  Lower Bound (LB) = 984.62
  Gap (UB-LB) = 8535.5122, Absolute Gap = 8535.5122, Relative Gap = 0.896575
  Not converged yet (gap = 8535.51 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 29 increases, 31 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 264905 nonzeros
Model fingerprint: 0x4117b497
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 42420 rows and 17220 columns
Presolve time: 3.36s
Presolved: 50703 rows, 22480 columns, 314579 nonzeros
Variable types: 20221 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -362494.4633
Found heuristic solution: objective -209555.5527

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 50703 rows, 22480 columns, 314579 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   13258   -2.4186103e+05   0.000000e+00   2.070970e+07      5s
   24614   -7.7163027e+04   0.000000e+00   3.395900e+09     10s
   31518   -1.7729705e+03   0.000000e+00   2.209854e+09     15s
   42188    1.5389430e+04   0.000000e+00   1.565139e+07     20s
Concurrent spin time: 6.62s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 3.345250e+04, 38863 iterations, 17.11 seconds (22.97 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 33452.5004    0  112 -209555.55 33452.5004   116%     -   21s
H    0     0                    -204316.2071 33452.5004   116%     -   21s
H    0     0                    -120056.8238 33452.5004   128%     -   21s
H    0     0                    -119731.1952 33452.5004   128%     -   21s
H    0     0                    -119562.2120 33452.5004   128%     -   21s
H    0     0                    -119519.3614 33452.5004   128%     -   21s
H    0     0                    -29697.15395 33452.5004   213%     -   21s
H    0     0                    -3256.384271 33452.5004  1127%     -   22s
H    0     0                    7929.5362163 33452.5004   322%     -   23s
H    0     0                    8893.5841470 33452.5004   276%     -   25s
H    0     0                    9102.6165923 33452.5004   268%     -   25s
H    0     0                    9115.9270172 33452.5004   267%     -   25s
     0     0 27924.9359    0  157 9115.92702 27924.9359   206%     -   35s
     0     0 27511.9794    0  201 9115.92702 27511.9794   202%     -   43s
     0     0 27340.8295    0  157 9115.92702 27340.8295   200%     -   45s
     0     0 27340.8295    0  149 9115.92702 27340.8295   200%     -   46s
     0     0 27340.8295    0  195 9115.92702 27340.8295   200%     -   49s
     0     0 27340.7418    0  198 9115.92702 27340.7418   200%     -   50s
     0     0 24839.0738    0  248 9115.92702 24839.0738   172%     -   60s
     0     0 24352.4277    0  277 9115.92702 24352.4277   167%     -   68s
     0     0 24232.3520    0  327 9115.92702 24232.3520   166%     -   71s
     0     0 24185.7048    0  279 9115.92702 24185.7048   165%     -   74s
     0     0 24182.6488    0  280 9115.92702 24182.6488   165%     -   74s
     0     0 24155.0806    0  285 9115.92702 24155.0806   165%     -   75s
     0     0 24137.8086    0  284 9115.92702 24137.8086   165%     -   76s
     0     0 24130.4255    0  286 9115.92702 24130.4255   165%     -   76s
     0     0 24130.2099    0  285 9115.92702 24130.2099   165%     -   76s
     0     0 22015.9953    0  338 9115.92702 22015.9953   142%     -   93s
     0     0 21487.4373    0  398 9115.92702 21487.4373   136%     -  108s
     0     0 21320.2869    0  351 9115.92702 21320.2869   134%     -  113s
     0     0 21138.7757    0  407 9115.92702 21138.7757   132%     -  119s
     0     0 21098.6437    0  414 9115.92702 21098.6437   131%     -  121s
     0     0 21078.1248    0  404 9115.92702 21078.1248   131%     -  122s
     0     0 21071.6536    0  422 9115.92702 21071.6536   131%     -  123s
     0     0 21061.1337    0  413 9115.92702 21061.1337   131%     -  124s
     0     0 21058.2393    0  426 9115.92702 21058.2393   131%     -  125s
     0     0 21054.4263    0  417 9115.92702 21054.4263   131%     -  126s
     0     0 21052.9500    0  361 9115.92702 21052.9500   131%     -  127s
H    0     0                    9289.1000740 21052.4920   127%     -  127s
     0     0 21052.4920    0  362 9289.10007 21052.4920   127%     -  127s
     0     0 20191.3256    0  457 9289.10007 20191.3256   117%     -  146s
     0     0 20022.6100    0  445 9289.10007 20022.6100   116%     -  155s
     0     0 19945.4612    0  454 9289.10007 19945.4612   115%     -  158s
     0     0 19931.7769    0  459 9289.10007 19931.7769   115%     -  159s
     0     0 19926.9554    0  467 9289.10007 19926.9554   115%     -  160s
     0     0 19922.0050    0  462 9289.10007 19922.0050   114%     -  160s
     0     0 19909.8541    0  454 9289.10007 19909.8541   114%     -  161s
     0     0 19907.8055    0  466 9289.10007 19907.8055   114%     -  162s
     0     0 19906.9664    0  471 9289.10007 19906.9664   114%     -  163s
     0     0 19773.3843    0  398 9289.10007 19773.3843   113%     -  169s
     0     0 19753.1512    0  392 9289.10007 19753.1512   113%     -  175s
     0     0 19746.8858    0  331 9289.10007 19746.8858   113%     -  176s
     0     0 19741.6530    0  391 9289.10007 19741.6530   113%     -  177s
     0     0 19739.1928    0  384 9289.10007 19739.1928   112%     -  177s
     0     0 19736.7950    0  393 9289.10007 19736.7950   112%     -  178s
     0     0 19735.8677    0  386 9289.10007 19735.8677   112%     -  178s
     0     0 19635.7901    0  461 9289.10007 19635.7901   111%     -  181s
     0     0 19617.2433    0  458 9289.10007 19617.2433   111%     -  198s
     0     0 19610.3916    0  457 9289.10007 19610.3916   111%     -  199s
     0     0 19604.4789    0  460 9289.10007 19604.4789   111%     -  199s
     0     0 19594.3524    0  455 9289.10007 19594.3524   111%     -  201s
     0     0 19590.5749    0  463 9289.10007 19590.5749   111%     -  201s
     0     0 19588.6524    0  458 9289.10007 19588.6524   111%     -  201s
     0     0 19587.9845    0  464 9289.10007 19587.9845   111%     -  202s
     0     0 19520.5734    0  412 9289.10007 19520.5734   110%     -  204s
     0     0 19516.2022    0  362 9289.10007 19516.2022   110%     -  210s
     0     0 19514.7753    0  364 9289.10007 19514.7753   110%     -  211s
     0     0 19480.9116    0  410 9289.10007 19480.9116   110%     -  213s
     0     0 19477.0256    0  358 9289.10007 19477.0256   110%     -  237s
     0     0 19476.2570    0  359 9289.10007 19476.2570   110%     -  237s
     0     0 19461.9478    0  364 9289.10007 19461.9478   110%     -  239s
     0     0 19459.9017    0  485 9289.10007 19459.9017   109%     -  240s
     0     0 19459.6585    0  365 9289.10007 19459.6585   109%     -  240s
     0     0 19437.7435    0  418 9289.10007 19437.7435   109%     -  242s
     0     0 19435.0319    0  379 9289.10007 19435.0319   109%     -  242s
     0     0 19434.6362    0  431 9289.10007 19434.6362   109%     -  242s
     0     0 19430.1656    0  380 9289.10007 19430.1656   109%     -  243s
     0     0 19429.1306    0  383 9289.10007 19429.1306   109%     -  246s
     0     0 19422.1899    0  421 9289.10007 19422.1899   109%     -  250s
     0     0 19418.3921    0  430 9289.10007 19418.3921   109%     -  250s
     0     0 19418.3916    0  438 9289.10007 19418.3916   109%     -  251s
     0     0 19418.3337    0  438 9289.10007 19418.3337   109%     -  252s
     0     2 19417.7748    0  438 9289.10007 19417.7748   109%     -  304s
     1     4 19394.4320    1  359 9289.10007 19417.7748   109%  1287  311s
     3     8 19213.8517    2  491 9289.10007 19393.9541   109%  3284  322s
     7    16 19112.7017    3  505 9289.10007 19213.6792   107%  3718  333s
    15    32 19065.5371    4  485 9289.10007 19112.6726   106%  3735  354s
    31    49 16666.1815    5  294 9289.10007 19064.4313   105%  6145  412s
    48    81 17979.3324    6  497 9289.10007 19064.3096   105%  5766  470s
    80   203 17599.9839    7  449 9289.10007 19064.3096   105%  4461  524s
   202   237 17428.7995   10  435 9289.10007 19064.3096   105%  3070  546s
   236   264 17235.3270   11  449 9289.10007 19064.3096   105%  2882  581s
   269   295 15589.0917    9  274 9289.10007 19064.3096   105%  3005  611s
   312   333 17341.4410   11  426 9289.10007 19064.3096   105%  3086  641s
   366   381 16881.6729   12  395 9289.10007 19064.3096   105%  2958  666s
   436   433 16878.3366   12  401 9289.10007 19064.3096   105%  2809  692s
   509   454 14505.5727   11  284 9289.10007 19064.3096   105%  2665  723s
   561   495 15934.9390   12  268 9289.10007 19064.3096   105%  2617  751s
   636   534 16745.9580   13  387 9289.10007 19064.3096   105%  2506  781s
   713   573 16467.3261   14  379 9289.10007 19064.3096   105%  2433  810s
   795   606 16055.2636   16  312 9289.10007 19064.3096   105%  2391  834s
   843   656 15856.6068   17  319 9289.10007 19064.3096   105%  2372  861s
   913   692 15549.6368   19  320 9289.10007 19064.3096   105%  2336  893s
   984   751 15150.4283   21  269 9289.10007 19064.3096   105%  2322  924s
  1074   788 15402.1807   21  246 9289.10007 19064.3096   105%  2270  950s
  1133   821 15333.3273   22  253 9289.10007 19064.3096   105%  2259  989s
  1217   878 15011.0198   23  251 9289.10007 18913.6133   104%  2243 1029s
  1310   933 15001.0819   22  259 9289.10007 18913.6133   104%  2223 1068s
  1409   962 14527.1293   23  229 9289.10007 18913.6133   104%  2175 1101s
  1449  1003 15064.5452   22  257 9289.10007 18913.6133   104%  2174 1140s
  1500  1046 14522.8838   24  257 9289.10007 18913.6133   104%  2193 1180s
  1571  1117 14022.4733   23  239 9289.10007 18913.6133   104%  2178 1222s
  1667  1180 12947.5081   25  201 9289.10007 18913.6133   104%  2169 1265s
  1775  1236 14358.6881   25  258 9289.10007 18913.6133   104%  2153 1313s
  1902  1315 10172.2458   27  143 9289.10007 18913.6133   104%  2140 1355s
  2046  1392 13756.9593   27  265 9289.10007 17777.7834  91.4%  2100 1402s
  2186  1462 13475.1245   29  250 9289.10007 17777.7834  91.4%  2086 1455s
  2322  1569 12979.6425   31  271 9289.10007 17777.7834  91.4%  2086 1505s
  2462  1649 12649.4831   32  263 9289.10007 17777.7834  91.4%  2083 1559s
  2604  1736 12108.3008   37  259 9289.10007 17777.7834  91.4%  2082 1613s
  2800  1836 9955.12917   37  119 9289.10007 17777.7834  91.4%  2054 1669s
  2990  1915 11580.2803   38  206 9289.10007 17664.1380  90.2%  2034 1729s
  3182  2025 15754.5600   17  311 9289.10007 17246.6704  85.7%  2017 1788s
  3379  2076 13741.7835   21  266 9289.10007 17220.0059  85.4%  2009 1842s
  3509  2148 12706.1828   23  215 9289.10007 17094.8481  84.0%  2009 1909s
  3674  2257 infeasible   32      9289.10007 17094.8481  84.0%  2017 1979s
  3913  2339 11238.4630   13  156 9289.10007 17094.8481  84.0%  2000 2063s
  4154  2411 infeasible   14      9289.10007 17035.8506  83.4%  1994 2146s
  4357  2500 11973.0746   12  389 9289.10007 17004.7641  83.1%  2004 2221s
  4577  2617 10331.3753   15  312 9289.10007 16999.1245  83.0%  2003 2294s
  4828  2618 10612.3611   38  438 9289.10007 16859.3664  81.5%  2000 2326s
  4830  2619 10110.4799   31  112 9289.10007 16859.3664  81.5%  1999 2358s
  4831  2620 12391.3660   36  318 9289.10007 16859.3664  81.5%  1999 2378s
  4832  2621 12319.4305    8  345 9289.10007 16859.3664  81.5%  1998 2393s
  4833  2621 16009.5103   12  431 9289.10007 16859.3664  81.5%  1998 2408s
  4834  2622 10265.7639   39  492 9289.10007 16859.3664  81.5%  1997 2414s
  4835  2623 14521.4183   32  518 9289.10007 16859.3664  81.5%  1997 2420s
  4836  2623 10633.9245   18  487 9289.10007 16859.3664  81.5%  1996 2425s
  4838  2625 10889.3299   17  382 9289.10007 16859.3664  81.5%  1996 2430s
  4840  2626 14209.1548   11  499 9289.10007 16859.3664  81.5%  1995 2439s
  4841  2627 15301.6582   20  357 9289.10007 16859.3664  81.5%  1994 2442s
  4842  2627 15506.2777   22  474 9289.10007 16859.3664  81.5%  1994 2449s
  4843  2628 11481.9783   32  405 9289.10007 16859.3664  81.5%  1994 2454s
  4844  2629 9911.66989   21  407 9289.10007 16859.3664  81.5%  1993 2458s
  4845  2629 10287.6507   24  463 9289.10007 16859.3664  81.5%  1993 2465s
  4847  2631 9508.33507   33  324 9289.10007 16859.3664  81.5%  1992 2474s
  4848  2631 12964.1557    8  519 9289.10007 16859.3664  81.5%  1992 2478s
  4849  2632 13675.4034   35  483 9289.10007 16859.3664  81.5%  1991 2504s
  4850  2633 16307.1565   17  490 9289.10007 16859.3664  81.5%  1991 2508s
  4851  2633 12047.6137   14  480 9289.10007 16859.3664  81.5%  1990 2516s
  4852  2634 10555.8786   34  485 9289.10007 16859.3664  81.5%  1990 2520s
  4853  2635 13794.3172   16  336 9289.10007 16859.3664  81.5%  1990 2535s
  4854  2635 12319.4305   11  486 9289.10007 16859.3664  81.5%  1989 2541s
  4855  2636 11978.4944   15  479 9289.10007 16859.3664  81.5%  1989 2547s
  4856  2637 9705.97510   26  487 9289.10007 16859.3664  81.5%  1988 2551s
  4858  2638 10223.4607   35  475 9289.10007 16859.3664  81.5%  1987 2570s
  4859  2639 16048.9564   10  475 9289.10007 16859.3664  81.5%  1987 2611s
  4860  2642 16859.3664   15  479 9289.10007 16859.3664  81.5%  2016 2660s
  4862  2646 16859.3664   16  456 9289.10007 16859.3664  81.5%  2017 2679s
  4866  2652 16859.3664   17  468 9289.10007 16859.3664  81.5%  2021 2693s
  4874  2666 16859.3664   18  462 9289.10007 16859.3664  81.5%  2024 2711s
  4890  2677 15151.8624   19  245 9289.10007 16859.3664  81.5%  2038 2781s
  4907  2704 14418.8304   20  452 9289.10007 16859.3664  81.5%  2056 2833s
  4939  2719 14155.2827   21  460 9289.10007 16859.3664  81.5%  2097 2902s
  4984  2725 13648.7741   22  438 9289.10007 16859.3664  81.5%  2128 2967s
  5078  2697 10085.7273   24  381 9289.10007 16859.3664  81.5%  2153 3000s
  5171  2691 11060.6427   23  394 9289.10007 16859.3664  81.5%  2162 3028s
  5231  2688 10960.5621   24  333 9289.10007 16859.3664  81.5%  2177 3047s
  5269  2696     cutoff   24      9289.10007 16859.3664  81.5%  2185 3066s
  5317  2692 10579.9615   25  323 9289.10007 16859.3664  81.5%  2194 3083s
  5378  2677 9735.05550   26  308 9289.10007 16859.3664  81.5%  2201 3106s
  5457  2655     cutoff   27      9289.10007 16859.3664  81.5%  2200 3127s
  5527  2646     cutoff   27      9289.10007 16859.3664  81.5%  2207 3147s
  5597  2631 infeasible   28      9289.10007 16859.3664  81.5%  2218 3171s
  5667  2603     cutoff   23      9289.10007 16859.3664  81.5%  2229 3203s
  5738  2597 14441.8371   22  222 9289.10007 16859.3664  81.5%  2238 3221s
  5780  2591 13040.2193   23  191 9289.10007 16859.3664  81.5%  2244 3237s
  5837  2583 12968.8896   24  173 9289.10007 16859.3664  81.5%  2246 3256s
  5889  2566 12807.7748   25  186 9289.10007 16859.3664  81.5%  2252 3278s
  5961  2542 12351.0680   27  177 9289.10007 16859.3664  81.5%  2251 3300s
  6034  2515     cutoff   32      9289.10007 16859.3664  81.5%  2261 3322s
  6093  2489 9906.34523   31   82 9289.10007 16859.3664  81.5%  2273 3346s
  6160  2474 9407.05102   35   21 9289.10007 16859.3664  81.5%  2287 3370s
  6205  2468     cutoff   36      9289.10007 16859.3664  81.5%  2293 3392s
  6262  2470 15446.2282   21  409 9289.10007 16859.3664  81.5%  2300 3416s
  6342  2465 15365.4380   22  408 9289.10007 16859.3664  81.5%  2305 3442s
  6442  2433 14985.2435   23  331 9289.10007 15616.4779  68.1%  2297 3468s
  6536  2383     cutoff   23      9289.10007 15616.4779  68.1%  2306 3496s
  6631  2365 14127.8130   23  310 9289.10007 15616.4779  68.1%  2322 3525s
  6732  2336 13735.2752   24  227 9289.10007 15616.4779  68.1%  2333 3557s
  6865  2275 10315.9873   25  283 9289.10007 15616.4779  68.1%  2338 3587s
  7023  2207 10349.5093   32   99 9289.10007 15616.4779  68.1%  2344 3600s

Cutting planes:
  Gomory: 1
  MIR: 599
  Mixing: 1
  Flow cover: 1139
  RLT: 9
  Relax-and-lift: 118

Explored 7125 nodes (16809801 simplex iterations) in 3600.06 seconds (2988.29 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 9289.1 9115.93 9102.62 ... -119731

Time limit reached
Best objective 9.289100074009e+03, best bound 1.561647793464e+04, gap 68.1162%
  WARNING: Time limit reached. Using best solution found (gap: 68.12%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.15s
  Master Objective (UB) = 9289.10, θ = 152540.60
  Upper Bound (UB) = 9289.10

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 152540.60
  [DEBUG]   ✓ Scenario 0: θ = 152540.60 ≤ Q = 152540.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 152540.60 ≤ Q = 152540.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 152540.60 ≤ Q = 152540.60 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 152540.60 ≤ Q = 152540.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 152540.60 ≤ Q = 152540.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 152540.60 ≤ Q = 152540.60 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x57402b9d
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xa8bfd463
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [5e-01, 2e+02]
Found heuristic solution: objective 1.142822e+13
Presolve removed 2598 rows and 1890 columns
Presolve time: 0.00s
Presolved: 495 rows, 499 columns, 1396 nonzeros
Found heuristic solution: objective 5640729.6839
Variable types: 339 continuous, 160 integer (160 binary)

Root relaxation: objective -1.355779e+05, 262 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -135577.86    0  124 5640729.68 -135577.86   102%     -    0s
H    0     0                    -101137.7058 -135577.86  34.1%     -    0s
H    0     0                    -101545.3941 -135577.86  33.5%     -    0s
H    0     0                    -104884.3817 -115691.23  10.3%     -    0s
H    0     0                    -109715.2739 -115691.23  5.45%     -    0s
     0     0 -115691.23    0   61 -109715.27 -115691.23  5.45%     -    0s
     0     0 -114377.27    0   44 -109715.27 -114377.27  4.25%     -    0s
     0     0 -114207.67    0   56 -109715.27 -114207.67  4.09%     -    0s
     0     0 -114121.95    0   57 -109715.27 -114121.95  4.02%     -    0s
     0     0 -114000.68    0   55 -109715.27 -114000.68  3.91%     -    0s
H    0     0                    -113715.5444 -113998.56  0.25%     -    0s
H    0     0                    -113800.4545 -113998.56  0.17%     -    0s
     0     0 -113978.30    0   68 -113800.45 -113978.30  0.16%     -    0s
     0     0 -113957.32    0   34 -113800.45 -113957.32  0.14%     -    0s
     0     0 -113936.92    0   31 -113800.45 -113936.92  0.12%     -    0s
     0     0 -113905.40    0   18 -113800.45 -113905.40  0.09%     -    0s
     0     0 -113886.12    0    8 -113800.45 -113886.12  0.08%     -    0s
H    0     0                    -113817.7853 -113853.24  0.03%     -    0s
     0     0 -113853.24    0    5 -113817.79 -113853.24  0.03%     -    0s
     0     0 -113844.29    0    4 -113817.79 -113844.29  0.02%     -    0s
     0     0 -113844.29    0    8 -113817.79 -113844.29  0.02%     -    0s
H    0     0                    -113828.8348 -113844.29  0.01%     -    0s
     0     0          -    0      -113828.83 -113837.27  0.01%     -    0s

Cutting planes:
  Gomory: 4
  Implied bound: 2
  MIR: 3
  Flow cover: 3
  RLT: 1
  Relax-and-lift: 1

Explored 1 nodes (628 simplex iterations) in 0.17 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -113829 -113818 -113800 ... -101138

Optimal solution found (tolerance 1.00e-04)
Best objective -1.138288348215e+05, best bound -1.138372704714e+05, gap 0.0074%
  Subproblem solved in 0.19s
  Worst-case operational profit (Z_SP) = 140611.52
  Scenario: 20 demand increases, 40 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -113828.83
  [DEBUG]   S×d_nominal = 254440.35
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 254440.35 + -113828.83 = 140611.52
  [DEBUG]   Current θ from Master = 152540.60
  [DEBUG]   ⚠️  Z_SP ≤ θ by 11929.08 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -2639.98
  Lower Bound (LB) = 984.62
  Gap (UB-LB) = 8304.4753, Absolute Gap = 8304.4753, Relative Gap = 0.894002
  Not converged yet (gap = 8304.48 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 20 increases, 40 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308136 nonzeros
Model fingerprint: 0xe22a31c1
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 49490 rows and 20090 columns
Presolve time: 2.43s
Presolved: 58923 rows, 25850 columns, 366089 nonzeros
Variable types: 23591 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -362494.4633
Found heuristic solution: objective -209555.5527

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 58923 rows, 25850 columns, 366089 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   27348   -1.0379256e+05   0.000000e+00   1.795794e+09      5s
   41727    3.2038213e+03   0.000000e+00   2.554892e+07     10s
   53158    1.4172384e+04   0.000000e+00   7.594414e+06     15s
   62487    2.6446120e+04   0.000000e+00   5.180893e+06     20s
Concurrent spin time: 11.55s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 3.223689e+04, 52141 iterations, 28.11 seconds (36.21 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 32236.8914    0  115 -209555.55 32236.8914   115%     -   31s
H    0     0                    -204316.2071 32236.8914   116%     -   31s
H    0     0                    -109994.9691 32236.8914   129%     -   31s
H    0     0                    -103877.5376 32236.8914   131%     -   31s
H    0     0                    -101454.2733 32236.8914   132%     -   31s
H    0     0                    -47172.75311 32236.8914   168%     -   31s
H    0     0                    -40449.09766 32236.8914   180%     -   31s
H    0     0                    -17702.66826 32236.8914   282%     -   32s
H    0     0                    -3133.970688 32236.8914  1129%     -   32s
H    0     0                    -3075.163854 32236.8914  1148%     -   33s
H    0     0                    -2336.901213 32236.8914  1479%     -   34s
H    0     0                    -1575.763848 32236.8914  2146%     -   34s
H    0     0                    -1077.203767 32236.8914  3093%     -   34s
H    0     0                    -583.7509842 32236.8914  5622%     -   34s
H    0     0                    -430.6930775 26328.6875  6213%     -   46s
H    0     0                    -256.3524637 26328.6875      -     -   46s
     0     0 26328.6875    0  216 -256.35246 26328.6875      -     -   46s
     0     0 25714.9027    0  212 -256.35246 25714.9027      -     -   52s
     0     0 25714.9027    0  169 -256.35246 25714.9027      -     -   54s
     0     0 25714.9027    0  176 -256.35246 25714.9027      -     -   55s
     0     0 25714.9027    0  176 -256.35246 25714.9027      -     -   55s
     0     0 23778.1340    0  194 -256.35246 23778.1340  9376%     -   64s
     0     0 22997.4660    0  221 -256.35246 22997.4660  9071%     -   70s
     0     0 22780.6853    0  328 -256.35246 22780.6853  8986%     -   76s
     0     0 22687.6765    0  343 -256.35246 22687.6765  8950%     -   79s
     0     0 22527.9362    0  337 -256.35246 22527.9362  8888%     -   82s
     0     0 22481.6208    0  348 -256.35246 22481.6208  8870%     -   83s
     0     0 22461.3018    0  342 -256.35246 22461.3018  8862%     -   85s
     0     0 22454.9357    0  342 -256.35246 22454.9357  8859%     -   85s
     0     0 22451.5987    0  347 -256.35246 22451.5987  8858%     -   85s
     0     0 22451.2731    0  349 -256.35246 22451.2731  8858%     -   85s
H    0     0                    2262.0578658 22451.2731   893%     -   91s
H    0     0                    2290.6332246 22451.2731   880%     -   91s
H    0     0                    2380.6706133 22451.2731   843%     -   91s
H    0     0                    2437.8271932 22451.2731   821%     -   91s
H    0     0                    2445.8702319 22451.2731   818%     -   91s
H    0     0                    2492.9347282 22451.2731   801%     -   91s
     0     0 20768.8434    0  328 2492.93473 20768.8434   733%     -   99s
H    0     0                    2571.9150848 20768.8022   708%     -   99s
H    0     0                    2817.7602758 20339.7597   622%     -  107s
H    0     0                    2856.5313159 20339.7597   612%     -  107s
H    0     0                    2872.0079842 20339.7597   608%     -  107s
H    0     0                    2886.4131495 20339.7597   605%     -  107s
H    0     0                    2954.5833648 20339.7597   588%     -  107s
H    0     0                    3100.5992306 20339.7597   556%     -  107s
H    0     0                    3121.6124043 20339.7597   552%     -  107s
H    0     0                    3170.0755867 20339.7597   542%     -  107s
     0     0 20339.7597    0  355 3170.07559 20339.7597   542%     -  107s
     0     0 20184.9625    0  395 3170.07559 20184.9625   537%     -  110s
     0     0 20109.6148    0  349 3170.07559 20109.6148   534%     -  112s
     0     0 20060.7487    0  361 3170.07559 20060.7487   533%     -  114s
     0     0 20040.6655    0  363 3170.07559 20040.6655   532%     -  115s
     0     0 20020.6693    0  367 3170.07559 20020.6693   532%     -  116s
     0     0 20012.2041    0  426 3170.07559 20012.2041   531%     -  119s
     0     0 20010.4006    0  428 3170.07559 20010.4006   531%     -  119s
     0     0 19994.5488    0  423 3170.07559 19994.5488   531%     -  120s
     0     0 19986.2720    0  425 3170.07559 19986.2720   530%     -  122s
     0     0 19983.2735    0  429 3170.07559 19983.2735   530%     -  122s
     0     0 19982.1944    0  432 3170.07559 19982.1944   530%     -  123s
H    0     0                    3219.5363919 19063.2063   492%     -  144s
H    0     0                    3343.6114878 19063.2063   470%     -  144s
     0     0 19063.2063    0  459 3343.61149 19063.2063   470%     -  144s
H    0     0                    3366.1227513 19062.9453   466%     -  146s
H    0     0                    3394.6069752 19062.9453   462%     -  146s
     0     0 18862.5752    0  450 3394.60698 18862.5752   456%     -  154s
     0     0 18770.2707    0  454 3394.60698 18770.2707   453%     -  159s
     0     0 18724.9479    0  460 3394.60698 18724.9479   452%     -  163s
     0     0 18687.9354    0  471 3394.60698 18687.9354   451%     -  165s
     0     0 18673.8547    0  465 3394.60698 18673.8547   450%     -  167s
     0     0 18666.4070    0  466 3394.60698 18666.4070   450%     -  168s
     0     0 18661.6129    0  459 3394.60698 18661.6129   450%     -  169s
     0     0 18659.3512    0  462 3394.60698 18659.3512   450%     -  170s
     0     0 18658.4194    0  460 3394.60698 18658.4194   450%     -  170s
     0     0 18552.2440    0  459 3394.60698 18552.2440   447%     -  175s
     0     0 18523.7651    0  475 3394.60698 18523.7651   446%     -  181s
     0     0 18498.9122    0  484 3394.60698 18498.9122   445%     -  183s
     0     0 18487.9343    0  472 3394.60698 18487.9343   445%     -  184s
     0     0 18483.1547    0  487 3394.60698 18483.1547   444%     -  185s
     0     0 18478.9757    0  489 3394.60698 18478.9757   444%     -  186s
     0     0 18477.8280    0  488 3394.60698 18477.8280   444%     -  186s
H    0     0                    3426.6630942 18415.9014   437%     -  190s
     0     0 18415.9014    0  479 3426.66309 18415.9014   437%     -  190s
H    0     0                    3430.3629616 18415.8168   437%     -  195s
     0     0 18401.5104    0  480 3430.36296 18401.5104   436%     -  199s
     0     0 18393.7306    0  482 3430.36296 18393.7306   436%     -  199s
     0     0 18391.1837    0  482 3430.36296 18391.1837   436%     -  200s
     0     0 18389.4605    0  435 3430.36296 18389.4605   436%     -  200s
     0     0 18361.4445    0  427 3430.36296 18361.4445   435%     -  203s
     0     0 18355.0108    0  416 3430.36296 18355.0108   435%     -  207s
     0     0 18346.5416    0  487 3430.36296 18346.5416   435%     -  208s
     0     0 18341.0007    0  502 3430.36296 18341.0007   435%     -  209s
     0     0 18340.2471    0  500 3430.36296 18340.2471   435%     -  210s
     0     0 18324.1901    0  443 3430.36296 18324.1901   434%     -  212s
H    0     0                    3459.3610903 18323.8628   430%     -  213s
     0     0 18311.1487    0  447 3459.36109 18311.1487   429%     -  216s
     0     0 18309.2716    0  454 3459.36109 18309.2716   429%     -  217s
     0     0 18308.3318    0  444 3459.36109 18308.3318   429%     -  217s
     0     0 18295.6322    0  435 3459.36109 18295.6322   429%     -  220s
     0     0 18287.2712    0  485 3459.36109 18287.2712   429%     -  222s
     0     0 18285.0544    0  439 3459.36109 18285.0544   429%     -  223s
     0     0 18284.6882    0  439 3459.36109 18284.6882   429%     -  224s
     0     0 18271.6350    0  443 3459.36109 18271.6350   428%     -  226s
H    0     0                    3501.0121939 18271.5611   422%     -  235s
     0     0 18268.9980    0  445 3501.01219 18268.9980   422%     -  239s
     0     0 18268.2425    0  449 3501.01219 18268.2425   422%     -  240s
     0     0 18266.6715    0  454 3501.01219 18266.6715   422%     -  241s
     0     0 18266.2714    0  449 3501.01219 18266.2714   422%     -  244s
     0     0 18263.2912    0  451 3501.01219 18263.2912   422%     -  246s
     0     0 18261.3652    0  451 3501.01219 18261.3652   422%     -  248s
     0     0 18260.4579    0  457 3501.01219 18260.4579   422%     -  249s
     0     0 18257.4930    0  456 3501.01219 18257.4930   421%     -  251s
     0     0 18257.4689    0  456 3501.01219 18257.4689   421%     -  252s
H    0     0                    3535.5806575 18257.4278   416%     -  301s
H    0     2                    3605.4183769 18257.4278   406%     -  306s
     0     2 18257.4278    0  456 3605.41838 18257.4278   406%     -  306s
     1     4 18235.9622    1  498 3605.41838 18256.9566   406%  1271  312s
     3     8 18021.7491    2  494 3605.41838 18234.5102   406%  3315  321s
     7    16 17818.5016    3  499 3605.41838 18019.5683   400%  4110  332s
    15    32 17712.2619    4  510 3605.41838 17818.0695   394%  4553  361s
    31    49 16028.2785    5  291 3605.41838 17712.0957   391%  9571  427s
    48    81 16771.4552    6  523 3605.41838 17712.0769   391%  8979  494s
    80   224 16213.8915    7  444 3605.41838 17712.0769   391%  7622  541s
   223   254 16134.4601   12  427 3605.41838 17712.0769   391%  4257  564s
H  240   254                    3715.3522834 17712.0769   377%  4092  564s
   253   359 13300.2878   10  246 3715.35228 17712.0769   377%  3992  586s
   358   445 12709.0446   12  250 3715.35228 17712.0769   377%  3283  605s
   452   517 16021.5859   13  515 3715.35228 17712.0769   377%  2935  623s
   549   561 12933.8381   11  228 3715.35228 17712.0769   377%  2623  642s
   639   606 15873.0578   14  449 3715.35228 17712.0769   377%  2409  659s
   714   653 13186.8335   24  470 3715.35228 17712.0769   377%  2299  674s
   786   702 15823.9330   15  459 3715.35228 17712.0769   377%  2222  690s
   884   721 8013.70573   16  424 3715.35228 17712.0769   377%  2127  703s
   933   777 14420.3369   14  266 3715.35228 17712.0769   377%  2111  719s
  1023   806 13353.9242   15  227 3715.35228 17712.0769   377%  2022  729s
  1076   849 13225.7354   16  211 3715.35228 17712.0769   377%  1976  744s
  1169   877 5740.10740   16  218 3715.35228 17712.0769   377%  1909  755s
  1209   931 4965.18637   17  185 3715.35228 17712.0769   377%  1905  772s
  1293  1025 9578.57255   18  244 3715.35228 17712.0769   377%  1860  787s
  1416  1144 9229.75183   19  248 3715.35228 17712.0769   377%  1789  805s
  1551  1178 7903.96961   20  180 3715.35228 17712.0769   377%  1718  823s
  1635  1251 7753.29362   21  186 3715.35228 17712.0769   377%  1685  854s
  1742  1275 7076.77076   21  184 3715.35228 17712.0769   377%  1659  889s
H 1762  1275                    3816.7200638 17712.0769   364%  1655  889s
  1780  1425 7610.28719   22  162 3816.72006 17712.0769   364%  1657  940s
  1994  1441 6756.22159   28  157 3816.72006 17712.0769   364%  1558  991s
H 2003  1441                    3822.8251019 17712.0769   363%  1558  991s
  2060  1577 5230.08684   28  142 3822.82510 17712.0769   363%  1549 1045s
  2256  1644 6568.84977   28  151 3822.82510 17712.0769   363%  1494 1118s
  2413  1702 6666.85686   29  146 3822.82510 17142.2245   348%  1486 1188s
  2542  1783 5162.51933   33  119 3822.82510 17142.2245   348%  1492 1252s
  2685  1878 4619.82664   44   65 3822.82510 17142.2245   348%  1489 1323s
  2832  1976 15482.9555    8  372 3822.82510 17142.2245   348%  1499 1405s
  2962  2106 14879.2315   10  425 3822.82510 16893.3637   342%  1513 1479s
  3138  2210 14492.2231   12  309 3822.82510 16893.3637   342%  1504 1551s
  3306  2330 13561.2177   16  378 3822.82510 16893.3637   342%  1505 1646s
  3484  2363 11880.7849   21  248 3822.82510 16804.9242   340%  1506 1716s
  3567  2449 11701.9066   23  292 3822.82510 16804.9242   340%  1509 1798s
  3729  2537 9975.43573   33  193 3822.82510 16804.9242   340%  1508 1875s
  3895  2629 6460.20200   57  120 3822.82510 16391.8061   329%  1519 1960s
  4057  2630 13806.1438   15  456 3822.82510 16391.8061   329%  1534 2059s
H 4058  2499                    3839.1526412 16391.8061   327%  1533 2098s
  4059  2499 14185.2859   15  115 3839.15264 16391.8061   327%  1533 2103s
  4060  2500 5830.98469   24  358 3839.15264 16391.8061   327%  1532 2136s
  4061  2501 12097.3949   21  348 3839.15264 16391.8061   327%  1532 2175s
  4062  2501 7964.87542   17  383 3839.15264 16391.8061   327%  1532 2185s
  4063  2502 12982.6687   16  466 3839.15264 16391.8061   327%  1531 2194s
  4064  2503 10881.8059   50  504 3839.15264 16391.8061   327%  1531 2200s
  4065  2503 5878.17682   21  515 3839.15264 16391.8061   327%  1531 2205s
  4067  2505 4953.05339   18  435 3839.15264 16391.8061   327%  1530 2211s
  4070  2507 4619.29942   24  490 3839.15264 16391.8061   327%  1529 2216s
  4071  2507 8152.36217   19  405 3839.15264 16391.8061   327%  1528 2224s
  4072  2508 10552.5435   28  487 3839.15264 16391.8061   327%  1528 2236s
  4073  2509 11092.2948   15  341 3839.15264 16391.8061   327%  1528 2241s
  4074  2509 4166.78386   45  459 3839.15264 16391.8061   327%  1527 2254s
  4075  2510 10795.7672   26  485 3839.15264 16391.8061   327%  1527 2263s
  4076  2511 8944.17845   20  340 3839.15264 16391.8061   327%  1526 2268s
  4077  2511 13370.2563   22  485 3839.15264 16391.8061   327%  1526 2274s
  4078  2512 4423.08238   39  339 3839.15264 16391.8061   327%  1526 2276s
  4080  2513 6091.61212   25  450 3839.15264 16391.8061   327%  1525 2282s
  4081  2514 9482.15126   18  537 3839.15264 16391.8061   327%  1525 2291s
  4082  2515 4907.39853   21  336 3839.15264 16391.8061   327%  1524 2300s
  4083  2515 6068.15077   30  467 3839.15264 16391.8061   327%  1524 2309s
  4084  2516 9374.49289   21  453 3839.15264 16391.8061   327%  1523 2313s
  4085  2517 5439.19703   13  496 3839.15264 16391.8061   327%  1523 2320s
  4086  2517 11884.7554   10  481 3839.15264 16391.8061   327%  1523 2347s
  4087  2518 5159.48406   27  484 3839.15264 16391.8061   327%  1522 2352s
  4088  2519 9878.06886   64  517 3839.15264 16391.8061   327%  1522 2356s
  4089  2519 5944.93421   62  532 3839.15264 16391.8061   327%  1522 2361s
  4091  2521 10819.6275   20  565 3839.15264 16391.8061   327%  1521 2366s
  4092  2521 7118.70986   19  565 3839.15264 16391.8061   327%  1520 2388s
H 4092  2394                    3853.7934451 16391.8061   325%  1520 2462s
H 4093  2277                    3860.4801926 16391.8061   325%  1563 2473s
  4094  2279 16391.8061   11  526 3860.48019 16391.8061   325%  1564 2494s
  4096  2282 16391.8061   12  517 3860.48019 16391.8061   325%  1565 2519s
  4100  2289 16391.8061   13  317 3860.48019 16391.8061   325%  1568 2560s
  4108  2302 16242.7535   14  553 3860.48019 16391.8061   325%  1582 2629s
  4124  2314 14306.7730   15  261 3860.48019 16391.8061   325%  1623 2795s
  4141  2340 13567.2607   16  303 3860.48019 16391.8061   325%  1649 2913s
  4173  2392 9823.37185   17  386 3860.48019 16391.8061   325%  1707 3040s
  4239  2440 9626.24462   18  384 3860.48019 16391.8061   325%  1769 3148s
  4340  2446 9277.97672   20  300 3860.48019 16391.8061   325%  1815 3234s
  4427  2455     cutoff   18      3860.48019 16391.8061   325%  1821 3304s
  4514  2440 8376.06223   21  462 3860.48019 16391.8061   325%  1829 3408s
  4600  2432 7493.18744   22  267 3860.48019 16391.8061   325%  1839 3486s
  4688  2426 5039.94300   23  209 3860.48019 16391.8061   325%  1849 3564s
  4754  2417 4331.45387   25  216 3860.48019 16391.8061   325%  1858 3600s

Cutting planes:
  Learned: 1
  Gomory: 2
  MIR: 603
  Flow cover: 1236
  RLT: 20
  Relax-and-lift: 107

Explored 4797 nodes (9119531 simplex iterations) in 3600.23 seconds (2789.26 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 3860.48 3853.79 3839.15 ... 3459.36

Time limit reached
Best objective 3.860480192607e+03, best bound 1.639180606698e+04, gap 324.6054%
  WARNING: Time limit reached. Using best solution found (gap: 324.61%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.30s
  Master Objective (UB) = 3860.48, θ = 145497.29
  Upper Bound (UB) = 3860.48

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 145497.29
  [DEBUG]   ✓ Scenario 0: θ = 145497.29 ≤ Q = 145497.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 145497.29 ≤ Q = 145497.29 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 145497.29 ≤ Q = 145497.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 145497.29 ≤ Q = 145497.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 145497.29 ≤ Q = 145497.29 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 145497.29 ≤ Q = 145497.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 145497.29 ≤ Q = 145497.29 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x5a068522
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xa5f97ade
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [5e-01, 2e+02]
Found heuristic solution: objective 1.150567e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.00s
Presolved: 494 rows, 498 columns, 1393 nonzeros
Found heuristic solution: objective 5696052.0665
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.275164e+05, 245 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -127516.41    0  128 5696052.07 -127516.41   102%     -    0s
H    0     0                    -93028.15208 -127516.41  37.1%     -    0s
H    0     0                    -94490.71322 -127516.41  35.0%     -    0s
H    0     0                    -100462.5001 -105307.10  4.82%     -    0s
     0     0 -105305.05    0   55 -100462.50 -105305.05  4.82%     -    0s
H    0     0                    -102084.7711 -105286.27  3.14%     -    0s
H    0     0                    -103744.9387 -105252.97  1.45%     -    0s
H    0     0                    -105025.5120 -105252.97  0.22%     -    0s
     0     0 -105252.97    0   46 -105025.51 -105252.97  0.22%     -    0s
     0     0 -105226.43    0   31 -105025.51 -105226.43  0.19%     -    0s
     0     0 -105171.60    0    9 -105025.51 -105171.60  0.14%     -    0s
H    0     0                    -105109.0602 -105158.97  0.05%     -    0s
     0     0 -105153.48    0   10 -105109.06 -105153.48  0.04%     -    0s
     0     0 -105130.64    0    5 -105109.06 -105130.64  0.02%     -    0s

Cutting planes:
  Gomory: 10
  MIR: 103
  RLT: 21

Explored 1 nodes (468 simplex iterations) in 0.03 seconds (0.02 work units)
Thread count was 32 (of 64 available processors)

Solution count 8: -105109 -105026 -103745 ... 1.15057e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.051090601947e+05, best bound -1.051185997371e+05, gap 0.0091%
  Subproblem solved in 0.04s
  Worst-case operational profit (Z_SP) = 137115.67
  Scenario: 10 demand increases, 50 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -105109.06
  [DEBUG]   S×d_nominal = 242224.73
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 242224.73 + -105109.06 = 137115.67
  [DEBUG]   Current θ from Master = 145497.29
  [DEBUG]   ⚠️  Z_SP ≤ θ by 8381.62 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -4521.14
  Lower Bound (LB) = 984.62
  Gap (UB-LB) = 2875.8554, Absolute Gap = 2875.8554, Relative Gap = 0.744948
  Not converged yet (gap = 2875.86 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 10 increases, 50 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351367 nonzeros
Model fingerprint: 0x33737060
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 56560 rows and 22960 columns (presolve time = 5s)...
Presolve removed 56560 rows and 22960 columns
Presolve time: 7.53s
Presolved: 67143 rows, 29220 columns, 417599 nonzeros
Variable types: 26961 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -362494.4633
Found heuristic solution: objective -209555.5527

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 67143 rows, 29220 columns, 417599 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
       0   -0.0000000e+00   2.642674e+03   9.766174e+08      9s
   14294   -2.7472754e+05   0.000000e+00   5.587620e+06     10s
   32168   -6.9344616e+04   0.000000e+00   5.956715e+07     15s
   41122   -1.6011516e+04   0.000000e+00   2.965448e+09     20s
   48943    1.0918220e+04   0.000000e+00   4.066745e+06     25s
   54385    1.7426157e+04   0.000000e+00   3.203847e+06     30s
   58794    1.8635453e+04   0.000000e+00   3.894627e+06     35s
   63170    2.1946345e+04   0.000000e+00   2.145708e+07     40s
   70623    2.4712460e+04   0.000000e+00   5.975076e+06     45s
   78175    2.8696473e+04   0.000000e+00   2.387628e+06     50s
Concurrent spin time: 14.01s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 3.223401e+04, 55268 iterations, 49.47 seconds (60.04 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 32234.0127    0  115 -209555.55 32234.0127   115%     -   58s
H    0     0                    -197037.8517 32234.0127   116%     -   58s
H    0     0                    -85215.87925 32234.0127   138%     -   58s
H    0     0                    -85023.64125 32234.0127   138%     -   58s
H    0     0                    -84820.65208 32234.0127   138%     -   58s
H    0     0                    -84428.49249 32234.0127   138%     -   59s
H    0     0                    -47172.75311 32234.0127   168%     -   59s
H    0     0                    -40449.09766 32234.0127   180%     -   59s
H    0     0                    -3415.011409 32234.0127  1044%     -   59s
H    0     0                    -3246.175375 32234.0127  1093%     -   59s
H    0     0                    -1173.910146 32234.0127  2846%     -   61s
H    0     0                    -797.0164914 32234.0127  4144%     -   61s
H    0     0                    -655.3573972 25782.8414  4034%     -   87s
H    0     0                    -626.0894504 25782.8414  4218%     -   87s
H    0     0                    -612.1439218 25782.8414  4312%     -   87s
     0     0 25310.9157    0  211 -612.14392 25310.9157  4235%     -   87s
H    0     0                    -553.0983144 25310.9157  4676%     -   89s
     0     0 25188.7890    0  218 -553.09831 25188.7890  4654%     -  104s
     0     0 25188.7890    0  213 -553.09831 25188.7890  4654%     -  106s
     0     0 25188.7890    0  218 -553.09831 25188.7890  4654%     -  109s
     0     0 25188.7890    0  223 -553.09831 25188.7890  4654%     -  110s
     0     0 25188.7815    0  214 -553.09831 25188.7815  4654%     -  110s
     0     0 25188.7815    0  214 -553.09831 25188.7815  4654%     -  110s
H    0     0                    -471.9900197 23176.5055  5010%     -  123s
     0     0 23176.4742    0  280 -471.99002 23176.4742  5010%     -  123s
H    0     0                    -340.1357118 22939.9757  6844%     -  138s
     0     0 22939.9757    0  281 -340.13571 22939.9757  6844%     -  138s
     0     0 22630.5906    0  337 -340.13571 22630.5906  6753%     -  148s
     0     0 22290.7328    0  307 -340.13571 22290.7328  6653%     -  154s
     0     0 22252.8598    0  309 -340.13571 22252.8598  6642%     -  158s
     0     0 22245.9637    0  313 -340.13571 22245.9637  6640%     -  161s
     0     0 22245.1187    0  313 -340.13571 22245.1187  6640%     -  161s
     0     0 20452.9500    0  360 -340.13571 20452.9500  6113%     -  181s
H    0     0                    1085.9209158 20013.5058  1743%     -  200s
H    0     0                    1185.4485561 20013.5058  1588%     -  200s
H    0     0                    2032.5305016 20013.5058   885%     -  200s
H    0     0                    2123.5822774 20013.5058   842%     -  200s
H    0     0                    2157.4972560 20013.5058   828%     -  200s
H    0     0                    2166.6558307 20013.5058   824%     -  200s
H    0     0                    2394.4670231 20013.5058   736%     -  200s
H    0     0                    2436.0138066 20013.5058   722%     -  200s
H    0     0                    2449.8553268 20013.5058   717%     -  200s
H    0     0                    2515.1967779 20013.5058   696%     -  200s
H    0     0                    2562.1665570 20013.5058   681%     -  200s
H    0     0                    2572.8773354 20013.5058   678%     -  200s
H    0     0                    2632.4848010 20013.5058   660%     -  200s
     0     0 20013.5058    0  373 2632.48480 20013.5058   660%     -  200s
H    0     0                    2741.7758663 19841.3629   624%     -  203s
H    0     0                    2750.1241029 19841.3629   621%     -  203s
H    0     0                    2808.6918233 19841.3629   606%     -  203s
H    0     0                    2813.4311853 19841.3629   605%     -  203s
H    0     0                    2920.2573195 19841.3629   579%     -  203s
     0     0 19841.3629    0  410 2920.25732 19841.3629   579%     -  204s
     0     0 19800.4521    0  363 2920.25732 19800.4521   578%     -  206s
     0     0 19780.4292    0  374 2920.25732 19780.4292   577%     -  208s
     0     0 19751.3944    0  377 2920.25732 19751.3944   576%     -  210s
     0     0 19731.4675    0  375 2920.25732 19731.4675   576%     -  211s
     0     0 19721.7246    0  373 2920.25732 19721.7246   575%     -  212s
     0     0 19710.6467    0  372 2920.25732 19710.6467   575%     -  213s
     0     0 19705.2771    0  381 2920.25732 19705.2771   575%     -  213s
     0     0 19704.1546    0  383 2920.25732 19704.1546   575%     -  214s
     0     0 19100.6930    0  380 2920.25732 19100.6930   554%     -  225s
     0     0 18842.8168    0  458 2920.25732 18842.8168   545%     -  241s
     0     0 18750.1076    0  473 2920.25732 18750.1076   542%     -  245s
     0     0 18706.6205    0  469 2920.25732 18706.6205   541%     -  247s
     0     0 18675.3211    0  468 2920.25732 18675.3211   540%     -  249s
     0     0 18653.2859    0  458 2920.25732 18653.2859   539%     -  251s
     0     0 18647.9353    0  463 2920.25732 18647.9353   539%     -  252s
     0     0 18645.3858    0  468 2920.25732 18645.3858   538%     -  253s
     0     0 18641.3028    0  467 2920.25732 18641.3028   538%     -  254s
     0     0 18640.6625    0  466 2920.25732 18640.6625   538%     -  254s
     0     0 18531.4877    0  473 2920.25732 18531.4877   535%     -  258s
     0     0 18508.3625    0  486 2920.25732 18508.3625   534%     -  270s
H    0     0                    2946.3639981 18496.1334   528%     -  272s
     0     0 18496.1334    0  492 2946.36400 18496.1334   528%     -  272s
     0     0 18488.2816    0  489 2946.36400 18488.2816   527%     -  273s
     0     0 18482.6004    0  479 2946.36400 18482.6004   527%     -  274s
     0     0 18480.7139    0  491 2946.36400 18480.7139   527%     -  274s
     0     0 18471.4394    0  480 2946.36400 18471.4394   527%     -  275s
     0     0 18469.1789    0  488 2946.36400 18469.1789   527%     -  275s
     0     0 18468.5877    0  482 2946.36400 18468.5877   527%     -  275s
     0     0 18390.4842    0  477 2946.36400 18390.4842   524%     -  281s
     0     0 18363.2326    0  479 2946.36400 18363.2326   523%     -  284s
     0     0 18356.8265    0  481 2946.36400 18356.8265   523%     -  287s
     0     0 18353.6188    0  477 2946.36400 18353.6188   523%     -  288s
     0     0 18351.5045    0  478 2946.36400 18351.5045   523%     -  289s
     0     0 18350.5092    0  477 2946.36400 18350.5092   523%     -  290s
     0     0 18322.2692    0  490 2946.36400 18322.2692   522%     -  294s
     0     0 18316.6769    0  494 2946.36400 18316.6769   522%     -  304s
     0     0 18313.9880    0  492 2946.36400 18313.9880   522%     -  305s
     0     0 18312.5543    0  487 2946.36400 18312.5543   522%     -  306s
H    0     0                    3125.4316044 18292.7154   485%     -  309s
     0     0 18292.7154    0  489 3125.43160 18292.7154   485%     -  309s
H    0     0                    3163.8927247 18292.4438   478%     -  312s
H    0     0                    3281.5243947 18285.0953   457%     -  322s
     0     0 18285.0953    0  488 3281.52439 18285.0953   457%     -  322s
     0     0 18282.7332    0  485 3281.52439 18282.7332   457%     -  324s
     0     0 18282.1318    0  489 3281.52439 18282.1318   457%     -  324s
     0     0 18269.4686    0  469 3281.52439 18269.4686   457%     -  328s
H    0     0                    3314.2223908 18268.7792   451%     -  329s
     0     0 18265.7818    0  479 3314.22239 18265.7818   451%     -  339s
     0     0 18264.9897    0  496 3314.22239 18264.9897   451%     -  341s
     0     0 18262.6378    0  493 3314.22239 18262.6378   451%     -  345s
H    0     0                    3314.7821796 18262.3076   451%     -  346s
H    0     0                    3385.5722061 18262.3076   439%     -  346s
     0     0 18260.3317    0  491 3385.57221 18260.3317   439%     -  355s
     0     0 18259.6952    0  496 3385.57221 18259.6952   439%     -  356s
     0     0 18256.2965    0  506 3385.57221 18256.2965   439%     -  359s
H    0     0                    3389.2307727 18255.5270   439%     -  360s
     0     0 18255.5270    0  507 3389.23077 18255.5270   439%     -  367s
     0     0 18254.4518    0  515 3389.23077 18254.4518   439%     -  368s
     0     0 18253.1900    0  515 3389.23077 18253.1900   439%     -  370s
H    0     0                    3430.0479362 18253.1900   432%     -  507s
H    0     0                    3471.2776335 18253.1900   426%     -  518s
H    0     0                    3525.3692477 18253.1900   418%     -  518s
     0     2 18253.1900    0  515 3525.36925 18253.1900   418%     -  529s
     1     4 18132.1273    1  478 3525.36925 18252.7432   418%  2855  540s
     3     8 17990.7044    2  468 3525.36925 18131.1214   414%  3186  558s
     7    16 17571.8192    3  488 3525.36925 17990.0479   410%  5245  583s
    15    32 17146.1023    4  506 3525.36925 17565.3992   398%  6830  629s
    31    49 13553.5562    5  225 3525.36925 17146.0132   386%  8697  800s
    48    81 15279.3641    6  389 3525.36925 17146.0132   386%  9025  964s
H   57    81                    3572.9991529 17146.0132   380%  8585  964s
    80   237 15195.0322    7  405 3572.99915 17146.0132   380%  7189 1067s
   236   268 14998.8455   11  470 3572.99915 17146.0132   380%  3658 1111s
   269   305 14693.9596   10  425 3572.99915 17146.0132   380%  3422 1148s
   306   337 15106.6895    9  390 3572.99915 17146.0132   380%  3204 1184s
H  308   337                    3577.7445174 17146.0132   379%  3193 1184s
   338   410 14709.1504   11  464 3577.74452 17146.0132   379%  3041 1238s
   413   442 14716.3013   12  473 3577.74452 17146.0132   379%  2896 1279s
   445   496 14612.4419   12  375 3577.74452 17146.0132   379%  2789 1318s
H  454   496                    3604.2044225 17146.0132   376%  2768 1318s
   503   563 14687.5564   11  422 3604.20442 17146.0132   376%  2621 1365s
   592   642 13187.6044   11  218 3604.20442 17146.0132   376%  2519 1415s
   682   737 13959.6609   13  357 3604.20442 17146.0132   376%  2399 1454s
   789   832 13820.3890   13  446 3604.20442 17146.0132   376%  2197 1488s
   900   929 13357.5983   13  364 3604.20442 17146.0132   376%  2015 1538s
  1023  1017 13648.8104   13  417 3604.20442 17146.0132   376%  1857 1586s
  1141  1104 13669.9905   13  402 3604.20442 17146.0132   376%  1762 1635s
  1263  1175 13802.0625   13  435 3604.20442 17146.0132   376%  1692 1691s
  1380  1258 13655.8355   14  464 3604.20442 17146.0132   376%  1644 1754s
  1482  1350 13321.2741   15  439 3604.20442 17146.0132   376%  1630 1810s
  1586  1430 13144.3817   16  490 3604.20442 17146.0132   376%  1608 1870s
  1703  1464 12936.8242   17  427 3604.20442 17146.0132   376%  1586 1920s
  1753  1538 13018.7439   17  470 3604.20442 17146.0132   376%  1577 1968s
  1845  1644 12796.6550   18  411 3604.20442 17146.0132   376%  1556 2009s
  1975  1712 12718.1204   19  472 3604.20442 17063.9717   373%  1512 2067s
  2094  1790 12897.7251   18  484 3604.20442 17063.9717   373%  1488 2121s
  2212  1879 12879.0428   18  488 3604.20442 17063.9717   373%  1475 2185s
  2333  1983 12616.8799   20  477 3604.20442 16822.7481   367%  1475 2250s
  2473  2074 12622.3687   20  469 3604.20442 16822.7481   367%  1464 2320s
  2624  2220 12541.4089   21  386 3604.20442 16822.7481   367%  1449 2387s
  2806  2358 12588.2620   21  392 3604.20442 16638.3257   362%  1432 2470s
  3007  2462 12432.4159   22  374 3604.20442 16638.3257   362%  1409 2556s
  3211  2501 11769.9655   28  238 3604.20442 16591.8048   360%  1398 2634s
H 3237  2495                    3666.4102627 16513.8821   350%  1404 2634s
H 3259  2478                    3883.1100134 16513.8821   325%  1406 2634s
  3325  2578 11452.5678   29  245 3883.11001 16513.8821   325%  1397 2728s
  3496  2651 6843.97830   30  150 3883.11001 16513.8821   325%  1409 2831s
  3641  2792 6106.76393   29  176 3883.11001 16513.8821   325%  1435 2929s
  3837  2793 7005.87008   25  515 3883.11001 16147.6092   316%  1443 3003s
  3839  2794 5536.00402   62  115 3883.11001 16147.6092   316%  1442 3066s
H 3839  2654                    3904.3398581 16147.6092   314%  1442 3093s
  3840  2655 5951.82185   28  351 3904.33986 16147.6092   314%  1442 3097s
H 3840  2522                    4138.6259329 16147.6092   290%  1442 3132s
H 3840  2396                    4219.0983668 16147.6092   283%  1442 3132s
H 3840  2276                    4223.2852098 16147.6092   282%  1442 3132s
H 3840  2162                    4223.8773678 16147.6092   282%  1442 3132s
H 3840  2054                    4261.0390369 16147.6092   279%  1442 3132s
H 3840  1951                    4324.4638214 16147.6092   273%  1442 3132s
  3842  1952 5135.27543   50  448 4324.46382 16147.6092   273%  1441 3161s
  3843  1953 11692.1549   38  481 4324.46382 16147.6092   273%  1441 3176s
  3844  1954 13621.7089    7  481 4324.46382 16147.6092   273%  1440 3190s
  3845  1954 5585.42497   92  490 4324.46382 16147.6092   273%  1440 3202s
  3846  1955 10224.7513   46  490 4324.46382 16147.6092   273%  1439 3211s
  3847  1956 4448.42864   32  498 4324.46382 16147.6092   273%  1439 3216s
H 3847  1858                    4341.7990197 16147.6092   272%  1439 3224s
  3848  1858 5790.67700   35  539 4341.79902 16147.6092   272%  1439 3228s
  3849  1859 5934.47634   33  494 4341.79902 16147.6092   272%  1438 3242s
  3850  1860 4537.36653   84  493 4341.79902 16147.6092   272%  1438 3248s
  3851  1860 5513.70285   20  494 4341.79902 16147.6092   272%  1438 3259s
  3852  1861 13537.6275   16  510 4341.79902 16147.6092   272%  1437 3270s
  3854  1862 10087.6524   18  534 4341.79902 16147.6092   272%  1436 3281s
  3855  1863 13382.4902    7  509 4341.79902 16147.6092   272%  1436 3288s
  3856  1864 4341.79902   70  505 4341.79902 16147.6092   272%  1436 3301s
  3857  1864 11023.6562   21  434 4341.79902 16147.6092   272%  1435 3313s
  3858  1865 5249.06659   42  434 4341.79902 16147.6092   272%  1435 3321s
  3859  1866 11030.7835   54  330 4341.79902 16147.6092   272%  1435 3333s
  3860  1866 6051.85560   38  500 4341.79902 16147.6092   272%  1434 3338s
  3861  1867 13537.6275   16  513 4341.79902 16147.6092   272%  1434 3345s
  3862  1868 5661.17591   46  497 4341.79902 16147.6092   272%  1433 3357s
H 3862  1774                    4347.5671248 16147.6092   271%  1433 3366s
  3864  1775 4347.56712   41  491 4347.56712 16147.6092   271%  1433 3380s
H 3864  1686                    4357.7450613 16147.6092   271%  1433 3387s
H 3864  1601                    4361.8699377 16147.6092   270%  1433 3393s
  3866  1602 9652.10250   17  502 4361.86994 16147.6092   270%  1432 3399s
  3867  1603 11062.9895   35  542 4361.86994 16147.6092   270%  1432 3408s
  3868  1604 9555.64841   20  542 4361.86994 16147.6092   270%  1431 3440s
  3869  1604 12154.2029   24  542 4361.86994 16147.6092   270%  1431 3515s
  3870  1608 16147.6092   11  481 4361.86994 16147.6092   270%  1486 3547s
  3872  1611 16147.6092   12  522 4361.86994 16147.6092   270%  1488 3586s
  3876  1611 15883.7231   13  289 4361.86994 16147.6092   270%  1496 3600s

Cutting planes:
  Learned: 1
  Gomory: 4
  MIR: 399
  Flow cover: 739
  RLT: 8
  Relax-and-lift: 67

Explored 3877 nodes (6043160 simplex iterations) in 3600.29 seconds (2324.30 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 4361.87 4347.57 4341.8 ... 3904.34

Time limit reached
Best objective 4.361869937699e+03, best bound 1.614760924314e+04, gap 270.1992%
  WARNING: Time limit reached. Using best solution found (gap: 270.20%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.48s
  Master Objective (UB) = 4361.87, θ = 127878.22
  Upper Bound (UB) = 4361.87

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 127878.22
  [DEBUG]   ✓ Scenario 0: θ = 127878.22 ≤ Q = 127878.22 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 127878.22 ≤ Q = 127878.22 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 127878.22 ≤ Q = 127878.22 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 127878.22 ≤ Q = 127878.22 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 127878.22 ≤ Q = 127878.22 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 127878.22 ≤ Q = 127878.22 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 127878.22 ≤ Q = 127878.22 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 127878.22 ≤ Q = 127878.22 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x373dec20
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x373dec20
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.193681e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.00s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 6249364.7811
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.159953e+05, 239 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -115995.33    0  122 6249364.78 -115995.33   102%     -    0s
H    0     0                    -84170.92974 -115995.33  37.8%     -    0s
H    0     0                    -84827.34141 -115995.33  36.7%     -    0s
H    0     0                    -86980.05611 -115995.33  33.4%     -    0s
H    0     0                    -89008.33278 -115995.33  30.3%     -    0s
H    0     0                    -89608.20262 -103440.60  15.4%     -    0s
     0     0 -103440.60    0   76 -89608.203 -103440.60  15.4%     -    0s
H    0     0                    -92053.31808 -103349.49  12.3%     -    0s
H    0     0                    -101556.3235 -103349.49  1.77%     -    0s
     0     0 -102834.93    0   61 -101556.32 -102834.93  1.26%     -    0s
     0     0 -102783.10    0   50 -101556.32 -102783.10  1.21%     -    0s
     0     0 -102749.76    0   50 -101556.32 -102749.76  1.18%     -    0s
H    0     0                    -102244.1930 -102749.76  0.49%     -    0s
H    0     0                    -102251.2536 -102749.76  0.49%     -    0s
     0     0 -102440.98    0   20 -102251.25 -102440.98  0.19%     -    0s
     0     0 -102439.11    0   17 -102251.25 -102439.11  0.18%     -    0s
     0     0 -102338.18    0   26 -102251.25 -102338.18  0.09%     -    0s
     0     0 -102307.51    0   13 -102251.25 -102307.51  0.06%     -    0s
     0     0 -102288.65    0   11 -102251.25 -102288.65  0.04%     -    0s
     0     0 -102285.97    0    5 -102251.25 -102285.97  0.03%     -    0s
     0     0 -102270.76    0    3 -102251.25 -102270.76  0.02%     -    0s
     0     0 -102265.42    0    2 -102251.25 -102265.42  0.01%     -    0s
H    0     0                    -102254.0705 -102265.42  0.01%     -    0s

Cutting planes:
  Implied bound: 1
  Flow cover: 2

Explored 1 nodes (621 simplex iterations) in 0.25 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -102254 -102251 -102176 ... -84170.9

Optimal solution found (tolerance 1.00e-04)
Best objective -1.022540704978e+05, best bound -1.022615051590e+05, gap 0.0073%
  Subproblem solved in 0.27s
  Worst-case operational profit (Z_SP) = 112487.77
  Scenario: 34 demand increases, 26 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -102254.07
  [DEBUG]   S×d_nominal = 214741.84
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 214741.84 + -102254.07 = 112487.77
  [DEBUG]   Current θ from Master = 127878.22
  [DEBUG]   ⚠️  Z_SP ≤ θ by 15390.45 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -11028.58
  Lower Bound (LB) = 984.62
  Gap (UB-LB) = 3377.2451, Absolute Gap = 3377.2451, Relative Gap = 0.774265
  Not converged yet (gap = 3377.25 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 34 increases, 26 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394598 nonzeros
Model fingerprint: 0xbb51eefe
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 63630 rows and 25830 columns (presolve time = 5s)...
Presolve removed 63630 rows and 25830 columns
Presolve time: 5.51s
Presolved: 75363 rows, 32590 columns, 469109 nonzeros
Variable types: 30331 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -362494.4633
Found heuristic solution: objective -209555.5527

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 75363 rows, 32590 columns, 469109 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
       0   -0.0000000e+00   2.799742e+03   1.016900e+09      7s
   31079   -9.8348690e+04   0.000000e+00   7.655652e+07     10s
   44552   -1.1889358e+04   0.000000e+00   1.742623e+07     15s
   51754    4.5285876e+03   0.000000e+00   1.638611e+07     20s
   59843    8.5661156e+03   0.000000e+00   2.357978e+06     25s
   66337    9.8238795e+03   0.000000e+00   6.887111e+07     30s
   73920    1.3274081e+04   0.000000e+00   3.403408e+06     35s
   80528    1.4410623e+04   0.000000e+00   4.102527e+07     40s
   86944    1.5193301e+04   0.000000e+00   1.886624e+07     45s
   91103    1.9768421e+04   0.000000e+00   1.171895e+08     50s
   93519    2.3010470e+04   0.000000e+00   1.383391e+08     55s
   96278    2.5742974e+04   0.000000e+00   4.498754e+07     60s
   99426    2.6903210e+04   0.000000e+00   6.618990e+07     65s
Concurrent spin time: 12.08s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 3.218833e+04, 86230 iterations, 75.16 seconds (82.05 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 32188.3251    0  106 -209555.55 32188.3251   115%     -   81s
H    0     0                    -203023.8479 32188.3251   116%     -   81s
H    0     0                    -141370.3406 32188.3251   123%     -   82s
H    0     0                    -137406.1622 32188.3251   123%     -   82s
H    0     0                    -87735.72404 32188.3251   137%     -   82s
H    0     0                    -87731.04524 32188.3251   137%     -   82s
H    0     0                    -87123.19246 32188.3251   137%     -   82s
H    0     0                    -87064.94393 32188.3251   137%     -   82s
H    0     0                    -39462.00187 32188.3251   182%     -   83s
H    0     0                    -8369.250156 32188.3251   485%     -   85s
H    0     0                    -3385.144619 32188.3251  1051%     -   86s
H    0     0                    -2965.991526 32188.3251  1185%     -   89s
H    0     0                    -110.6079485 32188.3251      -     -   91s
H    0     0                    -103.4571046 32188.3251      -     -   92s
H    0     0                     -61.2886207 32188.3251      -     -   92s
H    0     0                     181.7046550 32188.3251      -     -   92s
H    0     0                     965.2362764 32188.3251  3235%     -   99s
H    0     0                    1261.8766326 32188.3251  2451%     -   99s
H    0     0                    1317.6048773 26022.4917  1875%     -  118s
     0     0 26022.4917    0  207 1317.60488 26022.4917  1875%     -  118s
H    0     0                    1340.9786308 25621.5262  1811%     -  135s
     0     0 25576.9807    0  255 1340.97863 25576.9807  1807%     -  135s
     0     0 25469.2519    0  234 1340.97863 25469.2519  1799%     -  140s
     0     0 25447.8445    0  237 1340.97863 25447.8445  1798%     -  142s
     0     0 25447.6075    0  238 1340.97863 25447.6075  1798%     -  143s
H    0     0                    1449.2382774 22893.2949  1480%     -  170s
H    0     0                    1662.8569916 22893.2949  1277%     -  170s
     0     0 22862.1424    0  279 1662.85699 22862.1424  1275%     -  170s
H    0     0                    2192.1467898 22862.1424   943%     -  171s
H    0     0                    2206.4152990 22862.1424   936%     -  171s
     0     0 22512.2981    0  335 2206.41530 22512.2981   920%     -  188s
     0     0 22385.9857    0  310 2206.41530 22385.9857   915%     -  190s
     0     0 22372.4571    0  341 2206.41530 22372.4571   914%     -  192s
     0     0 22134.6406    0  334 2206.41530 22134.6406   903%     -  196s
     0     0 22121.8607    0  339 2206.41530 22121.8607   903%     -  197s
     0     0 22118.0819    0  342 2206.41530 22118.0819   902%     -  198s
     0     0 22112.5368    0  337 2206.41530 22112.5368   902%     -  198s
     0     0 22111.9592    0  338 2206.41530 22111.9592   902%     -  199s
H    0     0                    2429.9691281 22111.9592   810%     -  204s
     0     0 20331.8515    0  350 2429.96913 20331.8515   737%     -  229s
     0     0 19915.9540    0  357 2429.96913 19915.9540   720%     -  255s
     0     0 19860.1543    0  358 2429.96913 19860.1543   717%     -  260s
     0     0 19779.4349    0  356 2429.96913 19779.4349   714%     -  268s
     0     0 19762.7067    0  349 2429.96913 19762.7067   713%     -  272s
     0     0 19697.0737    0  357 2429.96913 19697.0737   711%     -  281s
     0     0 19662.9957    0  370 2429.96913 19662.9957   709%     -  285s
     0     0 19654.4521    0  369 2429.96913 19654.4521   709%     -  288s
     0     0 19648.4636    0  369 2429.96913 19648.4636   709%     -  292s
     0     0 19634.1792    0  368 2429.96913 19634.1792   708%     -  295s
     0     0 19630.8155    0  373 2429.96913 19630.8155   708%     -  297s
     0     0 19627.3712    0  369 2429.96913 19627.3712   708%     -  298s
     0     0 19615.6910    0  368 2429.96913 19615.6910   707%     -  300s
     0     0 19613.5936    0  364 2429.96913 19613.5936   707%     -  301s
     0     0 19613.2792    0  366 2429.96913 19613.2792   707%     -  302s
H    0     0                    2506.1926240 18935.6138   656%     -  327s
H    0     0                    2531.0077166 18935.6138   648%     -  327s
H    0     0                    2569.9165844 18935.6138   637%     -  327s
H    0     0                    2630.7062207 18935.6138   620%     -  327s
H    0     0                    2641.1370572 18935.6138   617%     -  327s
H    0     0                    2688.1212730 18935.6138   604%     -  327s
H    0     0                    2740.3194301 18935.6138   591%     -  327s
H    0     0                    2836.8480853 18935.6138   567%     -  327s
H    0     0                    2889.1194168 18935.6138   555%     -  327s
H    0     0                    2982.3227954 18935.6138   535%     -  327s
     0     0 18935.6138    0  434 2982.32280 18935.6138   535%     -  327s
H    0     0                    2985.5352751 18784.2997   529%     -  345s
H    0     0                    2999.0356891 18784.2997   526%     -  345s
     0     0 18784.2997    0  448 2999.03569 18784.2997   526%     -  345s
     0     0 18736.7796    0  459 2999.03569 18736.7796   525%     -  353s
     0     0 18702.5273    0  457 2999.03569 18702.5273   524%     -  356s
     0     0 18684.2524    0  469 2999.03569 18684.2524   523%     -  359s
     0     0 18677.6802    0  470 2999.03569 18677.6802   523%     -  361s
     0     0 18660.7356    0  466 2999.03569 18660.7356   522%     -  363s
     0     0 18631.4861    0  480 2999.03569 18631.4861   521%     -  366s
     0     0 18605.1423    0  475 2999.03569 18605.1423   520%     -  369s
     0     0 18599.1554    0  482 2999.03569 18599.1554   520%     -  370s
     0     0 18596.3617    0  490 2999.03569 18596.3617   520%     -  371s
     0     0 18595.4108    0  488 2999.03569 18595.4108   520%     -  372s
     0     0 18457.7193    0  479 2999.03569 18457.7193   515%     -  383s
     0     0 18438.5549    0  486 2999.03569 18438.5549   515%     -  394s
     0     0 18421.7237    0  483 2999.03569 18421.7237   514%     -  396s
     0     0 18413.8997    0  492 2999.03569 18413.8997   514%     -  398s
     0     0 18410.4929    0  491 2999.03569 18410.4929   514%     -  399s
     0     0 18408.8464    0  495 2999.03569 18408.8464   514%     -  399s
H    0     0                    3004.0236067 18370.2513   512%     -  405s
     0     0 18370.2513    0  477 3004.02361 18370.2513   512%     -  405s
H    0     0                    3292.4467030 18360.2765   458%     -  419s
     0     0 18360.2765    0  477 3292.44670 18360.2765   458%     -  419s
     0     0 18355.2120    0  473 3292.44670 18355.2120   457%     -  423s
H    0     0                    3294.5314751 18351.0299   457%     -  425s
     0     0 18351.0299    0  478 3294.53148 18351.0299   457%     -  425s
     0     0 18343.2498    0  485 3294.53148 18343.2498   457%     -  428s
     0     0 18341.9595    0  486 3294.53148 18341.9595   457%     -  430s
     0     0 18319.6664    0  480 3294.53148 18319.6664   456%     -  438s
H    0     0                    3415.3883763 18309.5906   436%     -  447s
     0     0 18309.5906    0  492 3415.38838 18309.5906   436%     -  447s
H    0     0                    3442.7672857 18307.5858   432%     -  449s
     0     0 18307.5858    0  499 3442.76729 18307.5858   432%     -  449s
     0     0 18307.2471    0  504 3442.76729 18307.2471   432%     -  449s
     0     0 18296.7413    0  495 3442.76729 18296.7413   431%     -  453s
     0     0 18294.0173    0  507 3442.76729 18294.0173   431%     -  455s
     0     0 18292.5820    0  493 3442.76729 18292.5820   431%     -  455s
     0     0 18289.2066    0  496 3442.76729 18289.2066   431%     -  459s
H    0     0                    3505.9884873 18289.1820   422%     -  460s
     0     0 18286.2346    0  489 3505.98849 18286.2346   422%     -  466s
     0     0 18284.8184    0  496 3505.98849 18284.8184   422%     -  467s
     0     0 18280.5911    0  494 3505.98849 18280.5911   421%     -  470s
H    0     0                    3530.7646787 18280.0675   418%     -  472s
H    0     0                    3557.9973093 18280.0675   414%     -  472s
     0     0 18278.3586    0  504 3557.99731 18278.3586   414%     -  478s
     0     0 18277.4632    0  504 3557.99731 18277.4632   414%     -  479s
     0     0 18276.0268    0  503 3557.99731 18276.0268   414%     -  481s
     0     0 18275.9639    0  503 3557.99731 18275.9639   414%     -  482s
     0     2 18275.9639    0  503 3557.99731 18275.9639   414%     -  657s
     1     4 18260.8719    1  493 3557.99731 18275.5478   414%   458  670s
     3     7 18037.9022    2  489 3557.99731 18259.3156   413%  4092  692s
     6    13 17992.2553    3  500 3557.99731 18032.0741   407%  5517  714s
    12    24 17515.5225    4  491 3557.99731 18032.0741   407%  6221  763s
    23    35 15858.9090    5  313 3557.99731 17991.6182   406%  9554  917s
    34    66 16010.0150    5  490 3557.99731 17515.5102   392%  9080 1064s
    65   166 15848.1585    6  478 3557.99731 17515.5102   392%  9899 1235s
   165   273 15832.0116    9  455 3557.99731 17515.5102   392%  6671 1331s
   272   363 15661.9580   11  458 3557.99731 17515.5102   392%  5008 1412s
   364   421 15506.5835   12  407 3557.99731 17515.5102   392%  4247 1494s
   428   499 15403.4335   13  399 3557.99731 17515.5102   392%  4004 1567s
   512   571 13216.6410   14  295 3557.99731 17515.5102   392%  3656 1629s
   598   636 12873.3580   15  269 3557.99731 17515.5102   392%  3407 1681s
H  599   636                    3561.1462947 17515.5102   392%  3402 1681s
H  601   636                    3612.8630275 17515.5102   385%  3394 1681s
   667   712 11815.6725   16  233 3612.86303 17515.5102   385%  3217 1735s
H  668   712                    3618.3875079 17515.5102   384%  3212 1735s
   753   794 11292.5755   17  212 3618.38751 17515.5102   384%  3022 1790s
   846   825 5455.08307   18  201 3618.38751 17515.5102   384%  2850 1856s
H  862   825                    3685.1322627 17515.5102   375%  2846 1856s
   925   867 4740.07231   19  188 3685.13226 17515.5102   375%  2787 1929s
  1017   890 infeasible   20      3685.13226 17515.5102   375%  2686 1988s
H 1019   890                    3693.4504662 17515.5102   374%  2684 1988s
  1075   947 4417.38803   21  191 3693.45047 17313.6809   369%  2656 2068s
  1170  1003 infeasible   22      3693.45047 17313.6809   369%  2574 2145s
  1264  1091 10953.6990   17  298 3693.45047 17313.6809   369%  2497 2221s
  1378  1133 8140.81955   18  255 3693.45047 17313.6809   369%  2437 2277s
H 1381  1133                    3721.8639733 17313.6809   365%  2434 2277s
  1424  1192 7460.09886   19  218 3721.86397 17313.6809   365%  2427 2350s
  1551  1262 5851.87085   20  222 3721.86397 17313.6809   365%  2347 2425s
  1655  1349 5793.56659   21  216 3721.86397 17313.6809   365%  2305 2501s
  1754  1406 infeasible   22      3721.86397 17313.6809   365%  2278 2576s
  1836  1539 5336.30124   26  172 3721.86397 17313.6809   365%  2258 2645s
  2012  1666 infeasible   33      3721.86397 17313.6809   365%  2141 2741s
  2199  1694 12727.0033   11  237 3721.86397 16724.5713   349%  2043 2818s
  2265  1758 9442.71441   12  266 3721.86397 16724.5713   349%  2032 2917s
  2379  1779 5071.24562   13  203 3721.86397 16724.5713   349%  2014 2997s
  2418  1809 4818.34402   14  200 3721.86397 16724.5713   349%  2037 3093s
  2472  1836 4068.96474   29   98 3721.86397 16664.8689   348%  2062 3174s
  2542  1881 12048.4007    8  482 3721.86397 16664.8689   348%  2072 3267s
  2609  1952 8181.36440   14  225 3721.86397 16664.8689   348%  2094 3364s
  2710  2029 4240.09165    9  440 3721.86397 16664.8689   348%  2096 3491s
  2839  2098 4151.88344   10  383 3721.86397 16664.8689   348%  2077 3600s

Cutting planes:
  Gomory: 7
  Cover: 1
  Implied bound: 75
  MIR: 1257
  Flow cover: 1706
  RLT: 30
  Relax-and-lift: 165
  BQP: 2

Explored 2970 nodes (6390121 simplex iterations) in 3600.53 seconds (1884.22 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 3721.86 3693.45 3685.13 ... 3442.77

Time limit reached
Best objective 3.721863973283e+03, best bound 1.666486890958e+04, gap 347.7560%
  WARNING: Time limit reached. Using best solution found (gap: 347.76%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.57s
  Master Objective (UB) = 3721.86, θ = 146110.01
  Upper Bound (UB) = 3721.86

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 146110.01
  [DEBUG]   ✓ Scenario 0: θ = 146110.01 ≤ Q = 146110.01 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 146110.01 ≤ Q = 146110.01 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 146110.01 ≤ Q = 146110.01 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 146110.01 ≤ Q = 146110.01 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 146110.01 ≤ Q = 146110.01 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 146110.01 ≤ Q = 146110.01 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 146110.01 ≤ Q = 146110.01 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 146110.01 ≤ Q = 146110.01 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 146110.01 ≤ Q = 146110.01 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x7ca5dbb8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x7ca5dbb8
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.147591e+13
Presolve removed 2598 rows and 1890 columns
Presolve time: 0.00s
Presolved: 495 rows, 499 columns, 1396 nonzeros
Found heuristic solution: objective 5657374.1386
Variable types: 339 continuous, 160 integer (160 binary)

Root relaxation: objective -1.293794e+05, 249 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -129379.41    0  129 5657374.14 -129379.41   102%     -    0s
H    0     0                    -94652.37659 -129379.41  36.7%     -    0s
H    0     0                    -96056.63376 -129379.41  34.7%     -    0s
     0     0 -107544.73    0   80 -96056.634 -107544.73  12.0%     -    0s
H    0     0                    -104360.1820 -107441.01  2.95%     -    0s
     0     0 -107441.01    0   72 -104360.18 -107441.01  2.95%     -    0s
     0     0 -107441.01    0   78 -104360.18 -107441.01  2.95%     -    0s
H    0     0                    -106068.2189 -107206.70  1.07%     -    0s
     0     0 -107206.70    0   48 -106068.22 -107206.70  1.07%     -    0s
H    0     0                    -106570.4650 -107184.84  0.58%     -    0s
     0     0 -107143.13    0   58 -106570.46 -107143.13  0.54%     -    0s
H    0     0                    -106575.5711 -107143.13  0.53%     -    0s
     0     0 -106931.22    0   65 -106575.57 -106931.22  0.33%     -    0s
     0     0 -106924.44    0   58 -106575.57 -106924.44  0.33%     -    0s
     0     0 -106924.40    0   57 -106575.57 -106924.40  0.33%     -    0s
H    0     0                    -106621.9599 -106918.45  0.28%     -    0s
     0     0 -106918.45    0   57 -106621.96 -106918.45  0.28%     -    0s
     0     0 -106862.46    0   43 -106621.96 -106862.46  0.23%     -    0s
     0     0 -106860.12    0   41 -106621.96 -106860.12  0.22%     -    0s
     0     0 -106840.95    0   41 -106621.96 -106840.95  0.21%     -    0s
     0     0 -106814.79    0   42 -106621.96 -106814.79  0.18%     -    0s
     0     0 -106814.79    0   52 -106621.96 -106814.79  0.18%     -    0s
     0     0 -106814.79    0   42 -106621.96 -106814.79  0.18%     -    0s
H    0     0                    -106628.4005 -106814.79  0.17%     -    0s
     0     0 -106792.48    0   34 -106628.40 -106792.48  0.15%     -    0s
     0     0 -106788.79    0   26 -106628.40 -106788.79  0.15%     -    0s
     0     0 -106776.43    0   25 -106628.40 -106776.43  0.14%     -    0s
     0     0 -106716.82    0   15 -106628.40 -106716.82  0.08%     -    0s
     0     0 -106692.35    0    9 -106628.40 -106692.35  0.06%     -    0s
     0     0 -106691.51    0    8 -106628.40 -106691.51  0.06%     -    0s
     0     0 -106651.36    0    4 -106628.40 -106651.36  0.02%     -    0s
     0     0          -    0      -106628.40 -106637.61  0.01%     -    0s

Explored 1 nodes (911 simplex iterations) in 0.56 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -106628 -106622 -106588 ... 1.14759e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.066284004606e+05, best bound -1.066376071757e+05, gap 0.0086%
  Subproblem solved in 0.62s
  Worst-case operational profit (Z_SP) = 137323.27
  Scenario: 24 demand increases, 36 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -106628.40
  [DEBUG]   S×d_nominal = 243951.67
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 243951.67 + -106628.40 = 137323.27
  [DEBUG]   Current θ from Master = 146110.01
  [DEBUG]   ⚠️  Z_SP ≤ θ by 8786.74 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -5064.88
  Lower Bound (LB) = 984.62
  Gap (UB-LB) = 2737.2392, Absolute Gap = 2737.2392, Relative Gap = 0.735448
  Not converged yet (gap = 2737.24 > ε = 200)

  [DEBUG] Adding NEW scenario 9 to Master Problem...
  [DEBUG] New scenario pattern: 24 increases, 36 decreases
    [DEBUG] Scenario 9 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 9 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 9]
    [DEBUG]   - Total constraints in model: 154283
    [DEBUG]   - Total variables in model: 64660
  [DEBUG] Total scenarios in Master: 10
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 10
================================================================================
[Iteration 10] Solving Master Problem...
  Current scenarios in Master: 10
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 154283 rows, 64660 columns and 437829 nonzeros
Model fingerprint: 0x4d025ca6
Variable types: 62401 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 70700 rows and 28700 columns (presolve time = 5s)...
Presolve removed 70700 rows and 28700 columns
Presolve time: 7.61s
Presolved: 83583 rows, 35960 columns, 511929 nonzeros
Variable types: 33701 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -364152.5596
Found heuristic solution: objective -209555.5527

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.45s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.509e+06
 Factor NZ  : 7.538e+06 (roughly 100 MB of memory)
 Factor Ops : 1.260e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.62025916e+07  1.43581066e+08  9.03e+04 1.99e+01  7.28e+04    11s
   1  -1.23055116e+07  1.27198310e+08  6.35e+04 6.38e+01  5.05e+04    12s
   2  -5.88640243e+06  9.81282715e+07  2.91e+04 2.71e-11  2.42e+04    12s
   3  -1.02159565e+06  7.34921531e+07  2.87e+03 8.06e-01  2.75e+03    13s
   4  -4.86295925e+05  2.75881857e+07  3.85e+02 1.50e-01  4.51e+02    14s
   5  -4.01543414e+05  1.82464265e+07  2.08e+02 8.82e-02  2.55e+02    14s
   6  -2.99976205e+05  1.27137059e+07  7.43e+01 5.79e-02  1.27e+02    14s
   7  -2.01731419e+05  9.76131924e+06  3.22e+01 4.08e-02  8.10e+01    15s
   8  -1.35961525e+05  7.15112464e+06  1.49e+01 2.83e-02  5.35e+01    15s
   9  -1.06597755e+05  4.62289525e+06  7.99e+00 1.75e-02  3.31e+01    16s
  10  -7.95056482e+04  1.74208588e+06  3.02e+00 5.93e-03  1.22e+01    17s
  11  -4.55158565e+04  5.35486192e+05  9.19e-01 1.72e-03  3.83e+00    18s
  12  -2.57706885e+04  2.92710804e+05  5.47e-01 1.22e-03  2.09e+00    18s
  13  -1.86851299e+04  1.94090596e+05  4.46e-01 1.26e-03  1.40e+00    19s
  14  -1.31557330e+04  1.74706039e+05  3.78e-01 1.29e-03  1.23e+00    19s
  15  -7.75122019e+03  1.42435179e+05  3.11e-01 1.67e-03  9.84e-01    20s
  16  -8.02129317e+02  1.10729135e+05  2.38e-01 2.14e-03  7.30e-01    20s
  17   5.16416119e+03  8.02513156e+04  1.89e-01 2.60e-03  4.92e-01    21s
  18   1.20500495e+04  7.41544310e+04  1.34e-01 2.28e-03  4.06e-01    22s
  19   1.48574403e+04  6.68355395e+04  1.15e-01 2.06e-03  3.40e-01    23s
  20   1.89710067e+04  5.53139716e+04  8.82e-02 1.72e-03  2.38e-01    23s
  21   2.03133190e+04  5.27132132e+04  7.99e-02 1.50e-03  2.12e-01    24s
  22   2.31464588e+04  4.85549816e+04  6.34e-02 1.60e-03  1.66e-01    25s
  23   2.54593290e+04  4.59566952e+04  5.06e-02 1.51e-03  1.34e-01    25s
  24   2.70604571e+04  4.47528571e+04  4.14e-02 1.55e-03  1.16e-01    26s
  25   2.79770734e+04  4.21142017e+04  3.65e-02 1.35e-03  9.25e-02    27s
  26   2.87248619e+04  4.04008493e+04  3.25e-02 1.34e-03  7.64e-02    27s
  27   3.08828994e+04  3.94938178e+04  2.15e-02 1.05e-03  5.63e-02    28s
  28   3.17439804e+04  3.89785038e+04  1.73e-02 9.11e-04  4.73e-02    28s
  29   3.26555111e+04  3.81603403e+04  1.31e-02 6.86e-04  3.60e-02    29s
  30   3.32088477e+04  3.77649441e+04  1.05e-02 5.80e-04  2.98e-02    30s
  31   3.39628320e+04  3.71525122e+04  7.25e-03 4.05e-04  2.09e-02    30s
  32   3.41323799e+04  3.70491121e+04  6.53e-03 3.75e-04  1.91e-02    31s
  33   3.44151913e+04  3.67253311e+04  5.30e-03 2.82e-04  1.51e-02    31s
  34   3.45947889e+04  3.64826053e+04  4.52e-03 2.15e-04  1.23e-02    32s
  35   3.49264992e+04  3.61465615e+04  3.06e-03 1.22e-04  7.98e-03    33s
  36   3.51569754e+04  3.59857225e+04  2.12e-03 7.68e-05  5.42e-03    34s
  37   3.53558950e+04  3.59289598e+04  1.33e-03 6.05e-05  3.75e-03    35s
  38   3.54395502e+04  3.58334212e+04  9.98e-04 4.31e-05  2.58e-03    36s
  39   3.55401390e+04  3.58117052e+04  6.21e-04 4.38e-05  1.78e-03    37s
  40   3.55821886e+04  3.57807040e+04  4.69e-04 2.88e-05  1.30e-03    37s
  41   3.56169584e+04  3.57591344e+04  3.44e-04 1.86e-05  9.30e-04    38s
  42   3.56754729e+04  3.57495583e+04  1.44e-04 1.74e-05  4.84e-04    39s
  43   3.56983175e+04  3.57426679e+04  6.63e-05 1.35e-05  2.89e-04    40s
  44   3.57111634e+04  3.57308330e+04  2.11e-05 6.76e-06  1.28e-04    40s
  45   3.57146110e+04  3.57247982e+04  1.02e-05 3.03e-06  6.64e-05    41s
  46   3.57173566e+04  3.57202466e+04  2.13e-06 9.65e-07  1.88e-05    42s
  47   3.57178893e+04  3.57197423e+04  7.36e-07 7.22e-07  1.21e-05    43s
  48   3.57180353e+04  3.57182610e+04  4.08e-07 1.95e-08  1.47e-06    43s
  49   3.57181763e+04  3.57182269e+04  9.54e-08 6.11e-09  3.31e-07    44s
  50   3.57181774e+04  3.57182260e+04  1.44e-06 3.51e-07  3.18e-07    45s
  51   3.57181801e+04  3.57182257e+04  2.44e-06 3.22e-07  2.99e-07    46s
  52   3.57181813e+04  3.57182256e+04  2.05e-06 2.84e-07  2.90e-07    46s
  53   3.57182085e+04  3.57182252e+04  9.31e-07 2.08e-07  1.09e-07    48s
  54   3.57182221e+04  3.57182236e+04  1.47e-07 2.03e-09  1.01e-08    49s
  55   3.57182223e+04  3.57182236e+04  1.58e-05 2.43e-07  9.15e-09    50s
  56   3.57182224e+04  3.57182236e+04  1.52e-05 5.52e-07  8.24e-09    50s
  57   3.57182234e+04  3.57182236e+04  3.84e-06 3.68e-07  2.22e-09    51s

Barrier solved model in 57 iterations and 50.79 seconds (8.17 work units)
Optimal objective 3.57182234e+04


Root crossover log...

   73419 DPushes remaining with DInf 0.0000000e+00                51s
   28027 DPushes remaining with DInf 0.0000000e+00                56s
     463 DPushes remaining with DInf 0.0000000e+00                60s
       0 DPushes remaining with DInf 0.0000000e+00                60s

   12113 PPushes remaining with PInf 7.5443704e-05                60s
       0 PPushes remaining with PInf 0.0000000e+00                64s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.4771629e+04     64s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   47746    3.5718224e+04   0.000000e+00   2.477163e+04     64s
   48079    3.5718224e+04   0.000000e+00   0.000000e+00     64s
   48079    3.5718224e+04   0.000000e+00   0.000000e+00     64s
Concurrent spin time: 0.01s

Solved with barrier

Root relaxation: objective 3.571822e+04, 48079 iterations, 54.36 seconds (11.51 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 35718.2236    0  203 -209555.55 35718.2236   117%     -   64s
H    0     0                    -206165.4752 35718.2236   117%     -   64s
H    0     0                    -158017.8332 35718.2236   123%     -   64s
H    0     0                    -123987.2673 35718.2236   129%     -   64s
H    0     0                    -123897.0832 35718.2236   129%     -   64s
H    0     0                    -44321.73610 35718.2236   181%     -   64s
H    0     0                    -24754.46974 35718.2236   244%     -   64s
H    0     0                    -17036.69994 35718.2236   310%     -   64s
H    0     0                    -16611.44224 35718.2236   315%     -   64s
H    0     0                    -8810.733117 35718.2236   505%     -   65s
H    0     0                    -8716.297791 35718.2236   510%     -   65s
H    0     0                    -8705.592659 35718.2236   510%     -   65s
H    0     0                    -424.6450441 35718.2236  8511%     -   74s
H    0     0                     359.4445129 35718.2236  9837%     -   74s
H    0     0                     670.7552038 35718.2236  5225%     -   74s
     0     0 29683.9216    0  293  670.75520 29683.9216  4325%     -  113s
H    0     0                     818.2063626 29683.9216  3528%     -  115s
H    0     0                     957.4153764 29683.9216  3000%     -  115s
H    0     0                    1348.7048451 29683.9216  2101%     -  115s
H    0     0                    1392.8403839 29683.9216  2031%     -  116s
     0     0 29019.7515    0  294 1392.84038 29019.7515  1983%     -  139s
     0     0 29007.4497    0  285 1392.84038 29007.4497  1983%     -  143s
     0     0 29007.4497    0  275 1392.84038 29007.4497  1983%     -  153s
     0     0 29007.4497    0  274 1392.84038 29007.4497  1983%     -  157s
     0     0 29007.4497    0  276 1392.84038 29007.4497  1983%     -  159s
     0     0 29007.4497    0  279 1392.84038 29007.4497  1983%     -  160s
     0     0 25454.0315    0  237 1392.84038 25454.0315  1727%     -  208s
H    0     0                    1649.7975313 25451.8336  1443%     -  209s
H    0     0                    1775.0171146 25451.8336  1334%     -  209s
H    0     0                    1913.4674986 25451.8336  1230%     -  209s
H    0     0                    1932.7423224 25451.8336  1217%     -  209s
H    0     0                    2136.9732350 25451.8336  1091%     -  209s
     0     0 24823.3930    0  260 2136.97324 24823.3930  1062%     -  248s
     0     0 24673.8822    0  286 2136.97324 24673.8822  1055%     -  259s
     0     0 24646.0803    0  297 2136.97324 24646.0803  1053%     -  263s
     0     0 24488.5502    0  282 2136.97324 24488.5502  1046%     -  273s
     0     0 24294.2094    0  282 2136.97324 24294.2094  1037%     -  281s
     0     0 24279.6666    0  289 2136.97324 24279.6666  1036%     -  283s
     0     0 23971.4615    0  276 2136.97324 23971.4615  1022%     -  288s
     0     0 23897.5498    0  287 2136.97324 23897.5498  1018%     -  293s
     0     0 23886.4221    0  288 2136.97324 23886.4221  1018%     -  294s
     0     0 23885.5925    0  292 2136.97324 23885.5925  1018%     -  295s
     0     0 21852.3518    0  375 2136.97324 21852.3518   923%     -  380s
H    0     0                    2198.3389738 21850.3727   894%     -  382s
     0     0 21075.1902    0  437 2198.33897 21075.1902   859%     -  418s
     0     0 20880.1972    0  442 2198.33897 20880.1972   850%     -  434s
     0     0 20831.5768    0  433 2198.33897 20831.5768   848%     -  445s
     0     0 20793.2002    0  452 2198.33897 20793.2002   846%     -  459s
H    0     0                    3020.6203899 20786.0525   588%     -  464s
     0     0 20786.0525    0  450 3020.62039 20786.0525   588%     -  464s
     0     0 20722.0390    0  455 3020.62039 20722.0390   586%     -  471s
H    0     0                    3231.4248785 20703.7349   541%     -  476s
     0     0 20703.7349    0  451 3231.42488 20703.7349   541%     -  476s
     0     0 20695.4531    0  461 3231.42488 20695.4531   540%     -  479s
     0     0 20694.4346    0  461 3231.42488 20694.4346   540%     -  480s
     0     0 19950.3056    0  385 3231.42488 19950.3056   517%     -  564s
H    0     0                    3342.6541343 19950.0686   497%     -  565s
     0     0 19418.3122    0  398 3342.65413 19418.3122   481%     -  619s
     0     0 19282.9010    0  489 3342.65413 19282.9010   477%     -  636s
     0     0 19228.7085    0  495 3342.65413 19228.7085   475%     -  651s
     0     0 19193.9083    0  482 3342.65413 19193.9083   474%     -  659s
     0     0 19186.2501    0  493 3342.65413 19186.2501   474%     -  664s
     0     0 19181.7333    0  400 3342.65413 19181.7333   474%     -  667s
     0     0 19179.1329    0  494 3342.65413 19179.1329   474%     -  668s
     0     0 19178.6621    0  409 3342.65413 19178.6621   474%     -  669s
     0     0 19007.8576    0  411 3342.65413 19007.8576   469%     -  681s
     0     0 18960.4331    0  482 3342.65413 18960.4331   467%     -  695s
     0     0 18920.9872    0  499 3342.65413 18920.9872   466%     -  699s
     0     0 18902.2852    0  490 3342.65413 18902.2852   465%     -  702s
     0     0 18893.8778    0  501 3342.65413 18893.8778   465%     -  705s
     0     0 18890.6645    0  494 3342.65413 18890.6645   465%     -  707s
     0     0 18887.3330    0  498 3342.65413 18887.3330   465%     -  709s
     0     0 18879.6014    0  487 3342.65413 18879.6014   465%     -  710s
     0     0 18875.0044    0  495 3342.65413 18875.0044   465%     -  712s
     0     0 18874.1834    0  500 3342.65413 18874.1834   465%     -  713s
     0     0 18754.1965    0  399 3342.65413 18754.1965   461%     -  724s
     0     0 18722.7839    0  479 3342.65413 18722.7839   460%     -  735s
     0     0 18709.4392    0  534 3342.65413 18709.4392   460%     -  739s
     0     0 18703.8673    0  477 3342.65413 18703.8673   460%     -  740s
     0     0 18695.9647    0  405 3342.65413 18695.9647   459%     -  742s
     0     0 18693.1210    0  484 3342.65413 18693.1210   459%     -  743s
     0     0 18686.8839    0  578 3342.65413 18686.8839   459%     -  746s
     0     0 18654.3861    0  533 3342.65413 18654.3861   458%     -  750s
     0     0 18649.0297    0  485 3342.65413 18649.0297   458%     -  752s
     0     0 18644.5114    0  530 3342.65413 18644.5114   458%     -  753s
     0     0 18640.2548    0  536 3342.65413 18640.2548   458%     -  755s
     0     0 18638.5256    0  531 3342.65413 18638.5256   458%     -  755s
     0     0 18569.0631    0  482 3342.65413 18569.0631   456%     -  763s
     0     0 18554.2933    0  483 3342.65413 18554.2933   455%     -  776s
     0     0 18549.1640    0  491 3342.65413 18549.1640   455%     -  779s
     0     0 18548.0179    0  491 3342.65413 18548.0179   455%     -  782s
     0     0 18501.4469    0  524 3342.65413 18501.4469   453%     -  802s
     0     0 18485.0787    0  532 3342.65413 18485.0787   453%     -  819s
     0     0 18477.6619    0  525 3342.65413 18477.6619   453%     -  825s
     0     0 18475.7507    0  536 3342.65413 18475.7507   453%     -  828s
     0     0 18458.3084    0  465 3342.65413 18458.3084   452%     -  838s
     0     0 18451.5917    0  500 3342.65413 18451.5917   452%     -  852s
     0     0 18446.9103    0  471 3342.65413 18446.9103   452%     -  857s
     0     0 18444.2634    0  567 3342.65413 18444.2634   452%     -  861s
     0     0 18415.2927    0  432 3342.65413 18415.2927   451%     -  874s
     0     0 18411.3466    0  436 3342.65413 18411.3466   451%     -  879s
     0     0 18410.1574    0  445 3342.65413 18410.1574   451%     -  881s
     0     0 18387.6859    0  546 3342.65413 18387.6859   450%     -  892s
     0     0 18358.7996    0  501 3342.65413 18358.7996   449%     -  908s
     0     0 18353.4897    0  495 3342.65413 18353.4897   449%     -  914s
     0     0 18349.8461    0  499 3342.65413 18349.8461   449%     -  918s
     0     0 18347.2533    0  499 3342.65413 18347.2533   449%     -  923s
     0     0 18335.9716    0  504 3342.65413 18335.9716   449%     -  935s
H    0     0                    3356.5659630 18335.9220   446%     -  942s
     0     0 18333.5815    0  498 3356.56596 18333.5815   446%     -  951s
     0     0 18330.1464    0  499 3356.56596 18330.1464   446%     -  957s
     0     0 18328.0179    0  510 3356.56596 18328.0179   446%     -  967s
     0     0 18324.5386    0  507 3356.56596 18324.5386   446%     -  971s
     0     0 18324.5352    0  507 3356.56596 18324.5352   446%     -  973s
H    0     0                    3365.7336363 18324.5347   444%     -  995s
H    0     0                    3374.1696167 18324.5347   443%     -  995s
H    0     0                    3383.4467490 18324.5347   442%     - 1079s
H    0     0                    3433.5015903 18324.5347   434%     - 1138s
H    0     0                    3634.0307585 18324.5347   404%     - 1168s
H    0     0                    3636.3419435 18324.5347   404%     - 1216s
H    0     0                    3651.0688307 18324.5347   402%     - 1247s
     0     2 18324.5347    0  507 3651.06883 18324.5347   402%     - 1257s
     1     4 18314.7549    1  499 3651.06883 18324.5190   402%  1541 1271s
     3     6 18136.8226    2  346 3651.06883 18313.8750   402%  5481 1296s
     5    10 17837.9152    3  330 3651.06883 18313.8750   402%  7721 1335s
     9    20 17352.1136    3  400 3651.06883 18136.5494   397%  9067 1390s
    19    40 17151.9110    4  388 3651.06883 17570.7152   381%  8876 1506s
    39    52 17135.3280    5  565 3651.06883 17363.6465   376% 14404 1773s
    51    76 16491.7267    6  501 3651.06883 17363.6465   376% 13453 2019s
    75   211 16477.5298    7  532 3651.06883 17363.6465   376% 10768 2254s
H   85   211                    3659.2191567 17363.6465   375%  9862 2254s
   210   280 15847.4486   12  378 3659.21916 17363.6465   375%  5796 2402s
   279   333 15848.8405   12  512 3659.21916 17363.6465   375%  5239 2535s
   332   367 15747.5647   15  450 3659.21916 17363.6465   375%  4882 2618s
   366   436 15698.7386   16  451 3659.21916 17363.6465   375%  4781 2726s
   435   510 14309.2850   18  259 3659.21916 17363.6465   375%  4339 2811s
   511   593 12650.3513   21  188 3659.21916 17363.6465   375%  4061 2903s
   594   660 11509.3051   26  166 3659.21916 17363.6465   375%  3764 2977s
   663   729 10033.2890   27  151 3659.21916 17363.6465   375%  3644 3068s
   732   804 6510.38899   31  100 3659.21916 17363.6465   375%  3516 3158s
   819   855 6099.06277   35  100 3659.21916 17363.6465   375%  3304 3256s
   908   907     cutoff   39      3659.21916 17363.6465   375%  3128 3337s
   994   957     cutoff   39      3659.21916 17363.6465   375%  3016 3425s
  1090   997 14722.2278   34  471 3659.21916 17363.6465   375%  2860 3538s
  1160  1037 14471.4334   37  417 3659.21916 17363.6465   375%  2820 3600s

Cutting planes:
  Gomory: 30
  Implied bound: 70
  MIR: 2396
  Flow cover: 2453
  RLT: 67
  Relax-and-lift: 604

Explored 1218 nodes (3864013 simplex iterations) in 3600.67 seconds (2189.41 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 3659.22 3651.07 3636.34 ... 3342.65

Time limit reached
Best objective 3.659219156730e+03, best bound 1.736364650503e+04, gap 374.5178%
  WARNING: Time limit reached. Using best solution found (gap: 374.52%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.79s
  Master Objective (UB) = 3659.22, θ = 144607.40
  Upper Bound (UB) = 3659.22

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 144607.40
  [DEBUG]   ✓ Scenario 0: θ = 144607.40 ≤ Q = 144607.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 144607.40 ≤ Q = 144607.40 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 144607.40 ≤ Q = 144607.40 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 144607.40 ≤ Q = 144607.40 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 144607.40 ≤ Q = 144607.40 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 144607.40 ≤ Q = 144607.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 144607.40 ≤ Q = 144607.40 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 144607.40 ≤ Q = 144607.40 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 144607.40 ≤ Q = 144607.40 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 144607.40 ≤ Q = 144607.40 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 10] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x482b2ba0
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x482b2ba0
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.139605e+13
Presolve removed 2617 rows and 1906 columns
Presolve time: 0.00s
Presolved: 476 rows, 483 columns, 1345 nonzeros
Found heuristic solution: objective 5479899.1205
Variable types: 326 continuous, 157 integer (157 binary)
Found heuristic solution: objective 5479012.4371

Root relaxation: objective -1.300504e+05, 230 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -130050.41    0  117 5479012.44 -130050.41   102%     -    0s
H    0     0                    -88107.93005 -130050.41  47.6%     -    0s
H    0     0                    -88378.23284 -130050.41  47.2%     -    0s
H    0     0                    -97442.51350 -130050.41  33.5%     -    0s
H    0     0                    -100560.2525 -130050.41  29.3%     -    0s
H    0     0                    -105677.2303 -110704.44  4.76%     -    0s
     0     0 -110704.44    0  117 -105677.23 -110704.44  4.76%     -    0s
H    0     0                    -107806.1307 -110614.52  2.61%     -    0s
H    0     0                    -109080.7972 -110614.52  1.41%     -    0s
     0     0 -109945.52    0  118 -109080.80 -109945.52  0.79%     -    0s
H    0     0                    -109082.2961 -109652.30  0.52%     -    0s
     0     0 -109652.30    0   95 -109082.30 -109652.30  0.52%     -    0s
     0     0 -109605.85    0  102 -109082.30 -109605.85  0.48%     -    0s
     0     0 -109587.49    0   84 -109082.30 -109587.49  0.46%     -    0s
     0     0 -109581.22    0   98 -109082.30 -109581.22  0.46%     -    0s
     0     0 -109576.72    0   97 -109082.30 -109576.72  0.45%     -    0s
     0     0 -109325.63    0   48 -109082.30 -109325.63  0.22%     -    0s
H    0     0                    -109097.6456 -109323.63  0.21%     -    0s
     0     0 -109278.19    0   53 -109097.65 -109278.19  0.17%     -    0s
     0     0 -109276.12    0   55 -109097.65 -109276.12  0.16%     -    0s
     0     0 -109180.85    0   39 -109097.65 -109180.85  0.08%     -    0s
     0     0 -109155.27    0   36 -109097.65 -109155.27  0.05%     -    0s
     0     0 -109151.57    0   36 -109097.65 -109151.57  0.05%     -    0s
     0     0 -109143.08    0   34 -109097.65 -109143.08  0.04%     -    0s
     0     0 -109143.08    0   30 -109097.65 -109143.08  0.04%     -    0s
     0     0 -109143.08    0   32 -109097.65 -109143.08  0.04%     -    0s
     0     0 -109143.08    0   23 -109097.65 -109143.08  0.04%     -    0s
     0     0 -109143.08    0   25 -109097.65 -109143.08  0.04%     -    0s
     0     0 -109143.08    0   15 -109097.65 -109143.08  0.04%     -    0s
     0     0 -109122.58    0    8 -109097.65 -109122.58  0.02%     -    0s
     0     0 -109122.43    0    6 -109097.65 -109122.43  0.02%     -    0s
     0     0 -109110.61    0    5 -109097.65 -109110.61  0.01%     -    0s
     0     0 -109110.61    0    5 -109097.65 -109110.61  0.01%     -    0s
     0     0          -    0      -109097.65 -109108.16  0.01%     -    0s

Cutting planes:
  Gomory: 18
  Implied bound: 1
  MIR: 19
  Flow cover: 2
  RLT: 5
  Relax-and-lift: 2

Explored 1 nodes (947 simplex iterations) in 0.43 seconds (0.06 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -109098 -109082 -108925 ... 5.4799e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.090976456248e+05, best bound -1.091081587248e+05, gap 0.0096%
  Subproblem solved in 0.48s
  Worst-case operational profit (Z_SP) = 135111.41
  Scenario: 47 demand increases, 13 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -109097.65
  [DEBUG]   S×d_nominal = 244209.06
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 244209.06 + -109097.65 = 135111.41
  [DEBUG]   Current θ from Master = 144607.40
  [DEBUG]   ⚠️  Z_SP ≤ θ by 9495.99 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -5836.77
  Lower Bound (LB) = 984.62
  Gap (UB-LB) = 2674.5943, Absolute Gap = 2674.5943, Relative Gap = 0.730919
  Not converged yet (gap = 2674.59 > ε = 200)

  [DEBUG] Adding NEW scenario 10 to Master Problem...
  [DEBUG] New scenario pattern: 47 increases, 13 decreases
    [DEBUG] Scenario 10 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 10 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 10]
    [DEBUG]   - Total constraints in model: 169573
    [DEBUG]   - Total variables in model: 70900
  [DEBUG] Total scenarios in Master: 11
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 11
================================================================================
[Iteration 11] Solving Master Problem...
  Current scenarios in Master: 11
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 169573 rows, 70900 columns and 481060 nonzeros
Model fingerprint: 0xecdc97d9
Variable types: 68641 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 77770 rows and 31570 columns (presolve time = 5s)...
Presolve removed 77770 rows and 31570 columns
Presolve time: 9.11s
Presolved: 91803 rows, 39330 columns, 558929 nonzeros
Variable types: 37071 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -370132.3089
Found heuristic solution: objective -210461.3866

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.41s

Barrier statistics:
 Dense cols : 595
 AA' NZ     : 3.319e+06
 Factor NZ  : 7.510e+06 (roughly 110 MB of memory)
 Factor Ops : 1.324e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.67728540e+07  1.56935626e+08  9.43e+04 2.18e+01  7.48e+04    12s
   1  -1.27641003e+07  1.40059380e+08  6.60e+04 6.57e+01  5.17e+04    12s
   2  -6.21945465e+06  1.08160965e+08  3.10e+04 7.51e-01  2.54e+04    13s
   3  -1.09223367e+06  8.28791210e+07  3.20e+03 1.19e+00  2.99e+03    14s
   4  -4.97189113e+05  3.22800943e+07  4.03e+02 1.87e-01  4.73e+02    15s
   5  -4.18301404e+05  2.02838663e+07  2.29e+02 9.64e-02  2.67e+02    15s
   6  -3.00446298e+05  1.47580856e+07  8.62e+01 6.44e-02  1.39e+02    15s
   7  -2.16704339e+05  1.08870283e+07  4.07e+01 4.42e-02  8.60e+01    16s
   8  -1.32250379e+05  8.15834433e+06  1.81e+01 3.10e-02  5.67e+01    16s
   9  -1.08362195e+05  4.65101917e+06  1.20e+01 1.63e-02  3.15e+01    17s
  10  -7.06855744e+04  2.47455227e+06  4.34e+00 8.34e-03  1.58e+01    18s
  11  -3.73175387e+04  5.50479672e+05  1.51e+00 1.62e-03  3.56e+00    18s
  12  -2.23015967e+04  3.60844337e+05  1.07e+00 1.09e-03  2.31e+00    19s
  13  -2.01928915e+04  2.87014743e+05  9.51e-01 8.95e-04  1.85e+00    19s
  14  -1.50354887e+04  1.85806153e+05  7.13e-01 5.99e-04  1.21e+00    20s
  15  -8.20731156e+03  1.22598413e+05  5.32e-01 1.32e-03  7.84e-01    20s
  16  -2.69485035e+02  1.03218989e+05  4.06e-01 1.75e-03  6.19e-01    21s
  17   5.00660978e+03  8.28163999e+04  3.29e-01 1.43e-03  4.65e-01    21s
  18   9.88731823e+03  7.08541538e+04  2.65e-01 1.55e-03  3.64e-01    22s
  19   1.27865507e+04  6.19016082e+04  2.31e-01 1.73e-03  2.94e-01    23s
  20   1.60179357e+04  5.71970164e+04  1.97e-01 1.28e-03  2.46e-01    23s
  21   2.11073929e+04  5.07356083e+04  1.39e-01 1.46e-03  1.77e-01    24s
  22   2.24045105e+04  4.67279706e+04  1.25e-01 1.81e-03  1.45e-01    25s
  23   2.53571803e+04  4.43542624e+04  9.58e-02 1.30e-03  1.13e-01    25s
  24   2.64851400e+04  4.23413073e+04  8.47e-02 1.68e-03  9.47e-02    26s
  25   2.81908687e+04  4.15431888e+04  6.82e-02 1.60e-03  7.97e-02    26s
  26   2.96403824e+04  4.01741904e+04  5.47e-02 1.06e-03  6.29e-02    27s
  27   3.13462078e+04  3.90700320e+04  3.93e-02 1.28e-03  4.61e-02    28s
  28   3.20576170e+04  3.85404946e+04  3.30e-02 1.30e-03  3.87e-02    28s
  29   3.32730356e+04  3.78281148e+04  2.25e-02 1.04e-03  2.72e-02    29s
  30   3.38401615e+04  3.74420466e+04  1.77e-02 9.05e-04  2.15e-02    30s
  31   3.44028965e+04  3.71741261e+04  1.29e-02 6.48e-04  1.65e-02    30s
  32   3.45940108e+04  3.70541009e+04  1.13e-02 5.61e-04  1.47e-02    31s
  33   3.48901742e+04  3.68038191e+04  8.86e-03 5.27e-04  1.14e-02    31s
  34   3.50920754e+04  3.66634103e+04  7.27e-03 4.27e-04  9.37e-03    32s
  35   3.53450052e+04  3.63474524e+04  5.36e-03 2.98e-04  5.98e-03    32s
  36   3.56401438e+04  3.62616083e+04  3.07e-03 2.02e-04  3.71e-03    33s
  37   3.57572881e+04  3.61757386e+04  2.22e-03 1.11e-04  2.50e-03    34s
  38   3.58718530e+04  3.61415422e+04  1.37e-03 5.49e-05  1.61e-03    34s
  39   3.59136267e+04  3.61115294e+04  1.07e-03 3.22e-05  1.18e-03    35s
  40   3.60058246e+04  3.61026731e+04  4.05e-04 2.57e-05  5.77e-04    36s
  41   3.60285852e+04  3.60862557e+04  2.52e-04 1.36e-05  3.44e-04    36s
  42   3.60434053e+04  3.60801100e+04  1.50e-04 9.49e-06  2.19e-04    36s
  43   3.60538559e+04  3.60761026e+04  7.90e-05 6.60e-06  1.33e-04    37s
  44   3.60642105e+04  3.60727919e+04  1.26e-05 4.31e-06  5.10e-05    37s
  45   3.60661421e+04  3.60682628e+04  1.21e-06 1.17e-06  1.26e-05    38s
  46   3.60665173e+04  3.60665232e+04  1.11e-08 2.27e-07  3.49e-08    38s
  47   3.60665213e+04  3.60665213e+04  1.86e-10 1.29e-10  3.49e-11    39s

Barrier solved model in 47 iterations and 38.75 seconds (7.28 work units)
Optimal objective 3.60665213e+04


Root crossover log...

   79077 DPushes remaining with DInf 0.0000000e+00                39s
   34796 DPushes remaining with DInf 0.0000000e+00                41s
   14464 DPushes remaining with DInf 0.0000000e+00                45s
       0 DPushes remaining with DInf 0.0000000e+00                46s

    1501 PPushes remaining with PInf 1.9409909e-06                46s
       0 PPushes remaining with PInf 0.0000000e+00                47s

  Push phase complete: Pinf 0.0000000e+00, Dinf 8.3865686e-11     47s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   30440    3.6066521e+04   0.000000e+00   0.000000e+00     47s
   30440    3.6066521e+04   0.000000e+00   0.000000e+00     48s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 3.606652e+04, 30440 iterations, 37.50 seconds (6.33 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 36066.5213    0  261 -210461.39 36066.5213   117%     -   49s
H    0     0                    -203562.7961 36066.5213   118%     -   49s
H    0     0                    -166776.3346 36066.5213   122%     -   49s
H    0     0                    -160600.9448 36066.5213   122%     -   49s
H    0     0                    -158495.1996 36066.5213   123%     -   49s
H    0     0                    -39710.99943 36066.5213   191%     -   49s
H    0     0                    -39694.42703 36066.5213   191%     -   49s
H    0     0                    -25532.06717 36066.5213   241%     -   49s
H    0     0                    -4568.082302 36066.5213   890%     -   49s
H    0     0                    -4411.056852 36066.5213   918%     -   50s
H    0     0                    -4273.126665 36066.5213   944%     -   50s
H    0     0                    -482.0452619 36066.5213  7582%     -   60s
H    0     0                    -207.1236937 36066.5213      -     -   60s
H    0     0                    -205.6861043 36066.5213      -     -   60s
H    0     0                     -43.8269250 36066.5213      -     -   60s
H    0     0                     -14.4827501 36066.5213      -     -   60s
H    0     0                     -10.8365766 36066.5213      -     -   60s
H    0     0                       7.7347904 30246.8439      -     -   94s
     0     0 30246.8439    0  362    7.73479 30246.8439      -     -   94s
H    0     0                     660.6853704 30246.6815  4478%     -   97s
H    0     0                     724.5530913 30246.6815  4075%     -   97s
H    0     0                     748.5703997 30246.6815  3941%     -   97s
H    0     0                    1033.4485693 30246.6815  2827%     -   97s
     0     0 29698.3232    0  378 1033.44857 29698.3232  2774%     -  124s
     0     0 29460.1587    0  372 1033.44857 29460.1587  2751%     -  136s
     0     0 29389.4314    0  367 1033.44857 29389.4314  2744%     -  142s
     0     0 29385.0736    0  369 1033.44857 29385.0736  2743%     -  144s
     0     0 29385.0736    0  367 1033.44857 29385.0736  2743%     -  148s
     0     0 29385.0736    0  358 1033.44857 29385.0736  2743%     -  149s
     0     0 29357.5140    0  378 1033.44857 29357.5140  2741%     -  152s
     0     0 29354.1462    0  362 1033.44857 29354.1462  2740%     -  155s
     0     0 29354.1462    0  362 1033.44857 29354.1462  2740%     -  155s
     0     0 25799.5286    0  445 1033.44857 25799.5286  2396%     -  203s
H    0     0                    1467.6999228 25799.4627  1658%     -  204s
     0     0 25246.8942    0  381 1467.69992 25246.8942  1620%     -  235s
     0     0 25167.3351    0  391 1467.69992 25167.3351  1615%     -  249s
     0     0 24976.2704    0  385 1467.69992 24976.2704  1602%     -  277s
     0     0 24917.3089    0  380 1467.69992 24917.3089  1598%     -  288s
     0     0 24859.8167    0  381 1467.69992 24859.8167  1594%     -  303s
     0     0 24856.4528    0  376 1467.69992 24856.4528  1594%     -  309s
H    0     0                    1667.0705770 24748.6609  1385%     -  330s
H    0     0                    1843.4598215 24748.6609  1243%     -  330s
H    0     0                    1995.9691083 24748.6609  1140%     -  330s
H    0     0                    2466.3383608 24748.6609   903%     -  330s
     0     0 24748.6609    0  389 2466.33836 24748.6609   903%     -  330s
     0     0 24697.8530    0  378 2466.33836 24697.8530   901%     -  337s
     0     0 24694.1645    0  386 2466.33836 24694.1645   901%     -  339s
     0     0 24584.2522    0  388 2466.33836 24584.2522   897%     -  352s
     0     0 24578.5387    0  389 2466.33836 24578.5387   897%     -  355s
     0     0 24537.0591    0  391 2466.33836 24537.0591   895%     -  363s
     0     0 24524.8979    0  394 2466.33836 24524.8979   894%     -  367s
     0     0 24523.9831    0  392 2466.33836 24523.9831   894%     -  368s
H    0     0                    2583.1317010 22026.7664   753%     -  455s
H    0     0                    2704.3249724 22026.7664   715%     -  455s
     0     0 22026.7664    0  402 2704.32497 22026.7664   715%     -  456s
H    0     0                    2802.9646062 22026.6931   686%     -  459s
     0     0 21560.3649    0  440 2802.96461 21560.3649   669%     -  520s
     0     0 21281.5232    0  462 2802.96461 21281.5232   659%     -  542s
     0     0 21142.4207    0  457 2802.96461 21142.4207   654%     -  558s
H    0     0                    2882.6275034 21000.4313   629%     -  580s
H    0     0                    3021.7368195 21000.4313   595%     -  580s
H    0     0                    3065.9907716 21000.4313   585%     -  580s
H    0     0                    3111.0566071 21000.4313   575%     -  580s
     0     0 21000.4313    0  472 3111.05661 21000.4313   575%     -  581s
     0     0 20966.9517    0  465 3111.05661 20966.9517   574%     -  593s
     0     0 20951.7492    0  415 3111.05661 20951.7492   573%     -  598s
     0     0 20930.5348    0  528 3111.05661 20930.5348   573%     -  605s
     0     0 20927.1202    0  467 3111.05661 20927.1202   573%     -  609s
     0     0 20922.6281    0  519 3111.05661 20922.6281   573%     -  612s
     0     0 20920.6795    0  522 3111.05661 20920.6795   572%     -  615s
     0     0 19603.9973    0  389 3111.05661 19603.9973   530%     -  695s
H    0     0                    3160.6862348 19603.9228   520%     -  696s
     0     0 19244.0145    0  465 3160.68623 19244.0145   509%     -  724s
     0     0 19152.5433    0  471 3160.68623 19152.5433   506%     -  735s
     0     0 19068.2574    0  472 3160.68623 19068.2574   503%     -  745s
     0     0 19034.5177    0  483 3160.68623 19034.5177   502%     -  752s
     0     0 19008.6156    0  473 3160.68623 19008.6156   501%     -  758s
     0     0 18992.0536    0  495 3160.68623 18992.0536   501%     -  763s
     0     0 18980.2771    0  481 3160.68623 18980.2771   501%     -  767s
     0     0 18966.9319    0  480 3160.68623 18966.9319   500%     -  772s
     0     0 18936.5747    0  488 3160.68623 18936.5747   499%     -  778s
     0     0 18929.2528    0  443 3160.68623 18929.2528   499%     -  781s
     0     0 18920.4778    0  448 3160.68623 18920.4778   499%     -  785s
     0     0 18917.3830    0  440 3160.68623 18917.3830   499%     -  787s
     0     0 18913.8216    0  494 3160.68623 18913.8216   498%     -  789s
     0     0 18913.5925    0  444 3160.68623 18913.5925   498%     -  790s
     0     0 18650.5166    0  482 3160.68623 18650.5166   490%     -  816s
     0     0 18601.1920    0  461 3160.68623 18601.1920   489%     -  835s
     0     0 18591.2246    0  495 3160.68623 18591.2246   488%     -  840s
     0     0 18582.7007    0  424 3160.68623 18582.7007   488%     -  845s
     0     0 18581.6592    0  506 3160.68623 18581.6592   488%     -  847s
     0     0 18493.5547    0  441 3160.68623 18493.5547   485%     -  865s
H    0     0                    3194.6551254 18448.2900   477%     -  889s
H    0     0                    3249.7950428 18448.2900   468%     -  889s
     0     0 18448.2900    0  628 3249.79504 18448.2900   468%     -  889s
     0     0 18428.7956    0  409 3249.79504 18428.7956   467%     -  896s
     0     0 18422.7539    0  486 3249.79504 18422.7539   467%     -  902s
     0     0 18420.6830    0  489 3249.79504 18420.6830   467%     -  904s
H    0     0                    3348.4346766 18420.6830   450%     -  905s
     0     0 18366.8156    0  542 3348.43468 18366.8156   449%     -  935s
     0     0 18340.4357    0  614 3348.43468 18340.4357   448%     -  954s
     0     0 18327.3079    0  577 3348.43468 18327.3079   447%     -  967s
H    0     0                    3370.6607695 18319.7535   444%     -  984s
H    0     0                    3407.5592082 18319.7535   438%     -  984s
H    0     0                    3439.3544084 18319.7535   433%     -  984s
     0     0 18319.7535    0  641 3439.35441 18319.7535   433%     -  984s
     0     0 18318.4860    0  645 3439.35441 18318.4860   433%     -  986s
     0     0 18274.4567    0  424 3439.35441 18274.4567   431%     - 1004s
     0     0 18254.6797    0  427 3439.35441 18254.6797   431%     - 1021s
     0     0 18248.6879    0  426 3439.35441 18248.6879   431%     - 1025s
     0     0 18247.0766    0  430 3439.35441 18247.0766   431%     - 1027s
     0     0 18204.8334    0  556 3439.35441 18204.8334   429%     - 1048s
     0     0 18198.7171    0  444 3439.35441 18198.7171   429%     - 1058s
     0     0 18197.0088    0  446 3439.35441 18197.0088   429%     - 1062s
     0     0 18186.0808    0  514 3439.35441 18186.0808   429%     - 1075s
     0     0 18182.4690    0  513 3439.35441 18182.4690   429%     - 1078s
     0     0 18177.2779    0  427 3439.35441 18177.2779   429%     - 1081s
     0     0 18172.3081    0  436 3439.35441 18172.3081   428%     - 1084s
     0     0 18171.2437    0  433 3439.35441 18171.2437   428%     - 1086s
     0     0 18159.7660    0  448 3439.35441 18159.7660   428%     - 1092s
H    0     0                    3464.0584144 18159.7422   424%     - 1095s
     0     0 18152.0383    0  438 3464.05841 18152.0383   424%     - 1104s
     0     0 18148.6325    0  444 3464.05841 18148.6325   424%     - 1107s
     0     0 18146.3161    0  379 3464.05841 18146.3161   424%     - 1110s
H    0     0                    3473.2097116 18141.6558   422%     - 1120s
H    0     0                    3475.0471988 18141.6558   422%     - 1120s
     0     0 18141.6558    0  448 3475.04720 18141.6558   422%     - 1120s
     0     0 18141.4972    0  448 3475.04720 18141.4972   422%     - 1125s
H    0     0                    3488.2113597 18141.4972   420%     - 1190s
H    0     0                    3669.3417202 18141.4972   394%     - 1308s
H    0     2                    3686.6164727 18141.4972   392%     - 1331s
     0     2 18141.4972    0  448 3686.61647 18141.4972   392%     - 1331s
     1     3 17722.0306    1  417 3686.61647 18141.4972   392% 14011 1354s
     2     4 17953.7276    1  439 3686.61647 17953.7276   387% 10646 1374s
     3     6 16708.9058    2  393 3686.61647 17953.3640   387% 10953 1403s
     5    11 16355.7462    3  391 3686.61647 17953.3640   387%  9360 1435s
    10    21 16223.8221    4  396 3686.61647 17670.8957   379%  8552 1501s
    20    31 16783.8136    4  530 3686.61647 17670.7665   379% 13801 1709s
    30    61 16043.6916    5  490 3686.61647 17435.5245   373% 13313 2051s
H   36    61                    3706.8511415 17435.5245   370% 12901 2051s
H   43    61                    3728.6280528 17435.5245   368% 12273 2051s
    60    93 15888.1203    6  418 3728.62805 17435.5245   368% 18407 2180s
H   92   169                    3796.2687611 17435.5245   359% 16116 2422s
   168   253 13243.5262    9  237 3796.26876 17435.5245   359% 12563 2613s
   252   284 13011.8417   11  228 3796.26876 17435.5245   359% 10065 2827s
   283   316 12529.6505   12  232 3796.26876 17435.5245   359%  9755 3161s
   315   346 12431.5193   13  236 3796.26876 17435.5245   359%  9488 3338s
   345   382 11713.2296   14  225 3796.26876 17435.5245   359%  9182 3482s
   381   411 11513.6324   15  221 3796.26876 17435.5245   359%  8890 3600s

Cutting planes:
  Learned: 3
  Gomory: 21
  Implied bound: 182
  MIR: 2348
  Flow cover: 2473
  RLT: 113
  Relax-and-lift: 899

Explored 412 nodes (4190112 simplex iterations) in 3600.61 seconds (2780.90 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 3796.27 3728.63 3706.85 ... 3439.35

Time limit reached
Best objective 3.796268761149e+03, best bound 1.743552451840e+04, gap 359.2806%
  WARNING: Time limit reached. Using best solution found (gap: 359.28%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.65s
  Master Objective (UB) = 3796.27, θ = 145539.95
  Upper Bound (UB) = 3796.27

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 145539.95
  [DEBUG]   ✓ Scenario 0: θ = 145539.95 ≤ Q = 145539.95 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 145539.95 ≤ Q = 145539.95 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 145539.95 ≤ Q = 145539.95 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 145539.95 ≤ Q = 145539.95 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 145539.95 ≤ Q = 145539.95 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 145539.95 ≤ Q = 145539.95 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 145539.95 ≤ Q = 145539.95 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 145539.95 ≤ Q = 145539.95 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 145539.95 ≤ Q = 145539.95 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 145539.95 ≤ Q = 145539.95 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 145539.95 ≤ Q = 145539.95 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 11] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x3882bd7d
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xc77d4283
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [5e-01, 2e+02]
Found heuristic solution: objective 1.153842e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.00s
Presolved: 494 rows, 498 columns, 1393 nonzeros
Found heuristic solution: objective 5780146.5994
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.270302e+05, 238 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -127030.23    0  122 5780146.60 -127030.23   102%     -    0s
H    0     0                    -94839.90377 -127030.23  33.9%     -    0s
H    0     0                    -95704.53339 -127030.23  32.7%     -    0s
     0     0 -102246.36    0   90 -95704.533 -102246.36  6.84%     -    0s
H    0     0                    -100533.2781 -102225.44  1.68%     -    0s
     0     0 -101716.87    0   93 -100533.28 -101716.87  1.18%     -    0s
     0     0 -101672.45    0   93 -100533.28 -101672.45  1.13%     -    0s
     0     0 -101667.35    0   94 -100533.28 -101667.35  1.13%     -    0s
H    0     0                    -100829.6372 -101667.35  0.83%     -    0s
     0     0 -101397.72    0   75 -100829.64 -101397.72  0.56%     -    0s
     0     0 -101332.31    0   67 -100829.64 -101332.31  0.50%     -    0s
     0     0 -101318.90    0   69 -100829.64 -101318.90  0.49%     -    0s
     0     0 -101156.57    0   48 -100829.64 -101156.57  0.32%     -    0s
     0     0 -101123.35    0   65 -100829.64 -101123.35  0.29%     -    0s
     0     0 -101119.73    0   70 -100829.64 -101119.73  0.29%     -    0s
     0     0 -101071.58    0   46 -100829.64 -101071.58  0.24%     -    0s
     0     0 -101058.65    0   47 -100829.64 -101058.65  0.23%     -    0s
     0     0 -101058.65    0   59 -100829.64 -101058.65  0.23%     -    0s
     0     0 -101058.65    0   77 -100829.64 -101058.65  0.23%     -    0s
     0     0 -101058.65    0   50 -100829.64 -101058.65  0.23%     -    0s
     0     0 -101058.65    0   52 -100829.64 -101058.65  0.23%     -    0s
     0     0 -101023.30    0   50 -100829.64 -101023.30  0.19%     -    0s
     0     0 -101022.30    0   50 -100829.64 -101022.30  0.19%     -    0s
     0     0 -100984.73    0   36 -100829.64 -100984.73  0.15%     -    0s
     0     0 -100956.06    0   47 -100829.64 -100956.06  0.13%     -    0s
     0     0 -100949.72    0   46 -100829.64 -100949.72  0.12%     -    0s
     0     0 -100946.04    0   37 -100829.64 -100946.04  0.12%     -    0s
     0     0 -100939.01    0   36 -100829.64 -100939.01  0.11%     -    0s
     0     0 -100938.22    0   36 -100829.64 -100938.22  0.11%     -    0s
     0     0 -100908.17    0   36 -100829.64 -100908.17  0.08%     -    0s
     0     0 -100900.40    0   36 -100829.64 -100900.40  0.07%     -    0s
     0     0 -100900.12    0   57 -100829.64 -100900.12  0.07%     -    0s
     0     0 -100900.12    0   34 -100829.64 -100900.12  0.07%     -    0s
     0     0 -100900.12    0   32 -100829.64 -100900.12  0.07%     -    0s
     0     0 -100900.12    0   33 -100829.64 -100900.12  0.07%     -    0s
     0     0 -100900.12    0   33 -100829.64 -100900.12  0.07%     -    0s
     0     0 -100897.36    0   33 -100829.64 -100897.36  0.07%     -    0s
     0     0 -100893.11    0   32 -100829.64 -100893.11  0.06%     -    0s
     0     0 -100890.83    0   32 -100829.64 -100890.83  0.06%     -    0s
     0     0 -100890.83    0   42 -100829.64 -100890.83  0.06%     -    1s
     0     0 -100890.83    0   36 -100829.64 -100890.83  0.06%     -    1s
     0     0 -100890.83    0   32 -100829.64 -100890.83  0.06%     -    1s
     0     0 -100890.83    0   33 -100829.64 -100890.83  0.06%     -    1s
     0     0 -100890.83    0   34 -100829.64 -100890.83  0.06%     -    1s
     0     0 -100890.83    0   33 -100829.64 -100890.83  0.06%     -    1s
     0     0 -100890.83    0   32 -100829.64 -100890.83  0.06%     -    1s
     0     0 -100890.83    0   32 -100829.64 -100890.83  0.06%     -    1s
     0     2 -100890.83    0   32 -100829.64 -100890.83  0.06%     -    1s

Cutting planes:
  Gomory: 5
  Implied bound: 2
  MIR: 58
  Flow cover: 10
  RLT: 1

Explored 4 nodes (1842 simplex iterations) in 1.26 seconds (0.13 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -100830 -100793 -100747 ... 1.15384e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.008296371992e+05, best bound -1.008380379287e+05, gap 0.0083%
  Subproblem solved in 1.38s
  Worst-case operational profit (Z_SP) = 142307.63
  Scenario: 31 demand increases, 29 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -100829.64
  [DEBUG]   S×d_nominal = 243137.27
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 243137.27 + -100829.64 = 142307.63
  [DEBUG]   Current θ from Master = 145539.95
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3232.31 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 563.96
  Lower Bound (LB) = 984.62
  Gap (UB-LB) = 2811.6439, Absolute Gap = 2811.6439, Relative Gap = 0.740634
  Not converged yet (gap = 2811.64 > ε = 200)

  [DEBUG] Adding NEW scenario 11 to Master Problem...
  [DEBUG] New scenario pattern: 31 increases, 29 decreases
    [DEBUG] Scenario 11 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 11 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 11]
    [DEBUG]   - Total constraints in model: 184863
    [DEBUG]   - Total variables in model: 77140
  [DEBUG] Total scenarios in Master: 12
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 12
================================================================================
[Iteration 12] Solving Master Problem...
  Current scenarios in Master: 12
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 184863 rows, 77140 columns and 524291 nonzeros
Model fingerprint: 0x90cbc3b8
Variable types: 74881 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 84840 rows and 34440 columns (presolve time = 5s)...
Presolve removed 84840 rows and 34440 columns
Presolve time: 6.89s
Presolved: 100023 rows, 42700 columns, 606239 nonzeros
Variable types: 40441 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -373460.5071
Found heuristic solution: objective -210461.3866

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.46s

Barrier statistics:
 Dense cols : 593
 AA' NZ     : 3.769e+06
 Factor NZ  : 8.671e+06 (roughly 130 MB of memory)
 Factor Ops : 1.595e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.72805919e+07  1.69398130e+08  9.72e+04 2.14e+01  7.66e+04    10s
   1  -1.31363841e+07  1.51902374e+08  6.79e+04 6.41e+01  5.28e+04    11s
   2  -6.42870389e+06  1.17403772e+08  3.20e+04 6.01e-01  2.61e+04    11s
   3  -1.15736627e+06  9.05328184e+07  3.47e+03 1.41e+00  3.19e+03    12s
   4  -5.09003699e+05  3.87214208e+07  4.03e+02 2.43e-01  4.92e+02    12s
   5  -4.37791026e+05  2.31351119e+07  2.38e+02 1.11e-01  2.77e+02    13s
   6  -3.45294791e+05  1.75145772e+07  9.72e+01 7.79e-02  1.54e+02    13s
   7  -2.46177022e+05  1.30387267e+07  4.69e+01 5.40e-02  9.59e+01    14s
   8  -1.44255550e+05  1.05933074e+07  1.59e+01 4.22e-02  6.56e+01    14s
   9  -1.17115981e+05  5.48348470e+06  1.12e+01 2.01e-02  3.36e+01    15s
  10  -7.79535605e+04  2.24826683e+06  4.44e+00 7.72e-03  1.33e+01    15s
  11  -3.69684703e+04  5.19705654e+05  1.56e+00 1.69e-03  3.10e+00    16s
  12  -2.29903958e+04  2.94129984e+05  1.11e+00 1.14e-03  1.76e+00    16s
  13  -1.56705600e+04  1.68749768e+05  8.53e-01 1.12e-03  1.02e+00    16s
  14  -8.95562419e+03  1.24763749e+05  6.72e-01 6.12e-04  7.38e-01    17s
  15  -3.54641638e+03  1.00921989e+05  5.35e-01 1.86e-03  5.76e-01    17s
  16   4.07893874e+03  8.58096550e+04  4.08e-01 2.92e-03  4.50e-01    17s
  17   7.79516260e+03  7.39605129e+04  3.49e-01 3.09e-03  3.64e-01    18s
  18   1.43229787e+04  6.21598600e+04  2.56e-01 2.48e-03  2.63e-01    18s
  19   1.78785952e+04  5.64925407e+04  2.07e-01 2.41e-03  2.12e-01    19s
  20   2.05901662e+04  5.08038014e+04  1.72e-01 3.26e-03  1.66e-01    19s
  21   2.23666476e+04  4.50613512e+04  1.50e-01 2.95e-03  1.25e-01    20s
  22   2.45128479e+04  4.36755477e+04  1.25e-01 2.56e-03  1.05e-01    20s
  23   2.69326169e+04  4.22767708e+04  9.76e-02 2.80e-03  8.43e-02    21s
  24   2.79702618e+04  4.06691783e+04  8.60e-02 1.89e-03  6.98e-02    21s
  25   2.90371548e+04  4.03004796e+04  7.37e-02 1.89e-03  6.19e-02    22s
  26   3.01919929e+04  3.93091768e+04  6.06e-02 2.27e-03  5.01e-02    23s
  27   3.17602290e+04  3.90093136e+04  4.40e-02 2.16e-03  3.98e-02    23s
  28   3.25479869e+04  3.80681936e+04  3.55e-02 1.82e-03  3.03e-02    24s
  29   3.30096519e+04  3.75314958e+04  3.07e-02 1.36e-03  2.48e-02    24s
  30   3.35061782e+04  3.73629828e+04  2.57e-02 1.35e-03  2.12e-02    25s
  31   3.39482317e+04  3.71943952e+04  2.10e-02 1.54e-03  1.78e-02    26s
  32   3.43299785e+04  3.68097603e+04  1.70e-02 1.09e-03  1.36e-02    26s
  33   3.46559085e+04  3.67308995e+04  1.38e-02 9.47e-04  1.14e-02    27s
  34   3.48871560e+04  3.66309485e+04  1.15e-02 7.76e-04  9.58e-03    27s
  35   3.49685036e+04  3.64929314e+04  1.06e-02 6.12e-04  8.38e-03    28s
  36   3.50918156e+04  3.64178029e+04  9.42e-03 5.12e-04  7.29e-03    28s
  37   3.53771847e+04  3.63304135e+04  6.64e-03 4.13e-04  5.24e-03    29s
  38   3.54421917e+04  3.62504083e+04  5.98e-03 2.78e-04  4.44e-03    30s
  39   3.56238416e+04  3.61971825e+04  4.22e-03 2.23e-04  3.15e-03    31s
  40   3.57090749e+04  3.61560101e+04  3.38e-03 1.76e-04  2.46e-03    32s
  41   3.58367921e+04  3.61394025e+04  2.08e-03 1.35e-04  1.66e-03    33s
  42   3.58808649e+04  3.61367510e+04  1.67e-03 1.30e-04  1.41e-03    34s
  43   3.59162730e+04  3.61059526e+04  1.33e-03 9.33e-05  1.04e-03    34s
  44   3.59655172e+04  3.60890761e+04  8.79e-04 5.29e-05  6.79e-04    36s
  45   3.60100153e+04  3.60834754e+04  4.72e-04 4.34e-05  4.03e-04    37s
  46   3.60305566e+04  3.60788172e+04  2.94e-04 3.13e-05  2.65e-04    37s
  47   3.60422387e+04  3.60755073e+04  1.95e-04 2.29e-05  1.83e-04    38s
  48   3.60547392e+04  3.60722373e+04  9.06e-05 1.45e-05  9.60e-05    39s
  49   3.60627638e+04  3.60698567e+04  2.69e-05 8.48e-06  3.88e-05    40s
  50   3.60660148e+04  3.60669924e+04  2.54e-06 1.02e-06  5.35e-06    40s
  51   3.60665192e+04  3.60665221e+04  6.32e-09 7.03e-08  1.60e-08    41s
  52   3.60665213e+04  3.60665213e+04  4.67e-10 4.26e-12  2.34e-12    41s

Barrier solved model in 52 iterations and 41.19 seconds (8.72 work units)
Optimal objective 3.60665213e+04


Root crossover log...

   86002 DPushes remaining with DInf 0.0000000e+00                42s
   36826 DPushes remaining with DInf 0.0000000e+00                45s
    5860 DPushes remaining with DInf 0.0000000e+00                50s
       0 DPushes remaining with DInf 0.0000000e+00                51s

    1526 PPushes remaining with PInf 4.3549383e-07                51s
       0 PPushes remaining with PInf 0.0000000e+00                52s

  Push phase complete: Pinf 0.0000000e+00, Dinf 8.0290418e-11     52s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   32347    3.6066521e+04   0.000000e+00   0.000000e+00     52s
   32347    3.6066521e+04   0.000000e+00   0.000000e+00     52s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 3.606652e+04, 32347 iterations, 44.03 seconds (10.34 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 36066.5213    0  261 -210461.39 36066.5213   117%     -   53s
H    0     0                    -207930.4184 36066.5213   117%     -   53s
H    0     0                    -166973.6706 36066.5213   122%     -   53s
H    0     0                    -145842.5841 36066.5213   125%     -   53s
H    0     0                    -134555.3858 36066.5213   127%     -   53s
H    0     0                    -134447.0017 36066.5213   127%     -   53s
H    0     0                    -119737.5978 36066.5213   130%     -   53s
H    0     0                    -119633.1042 36066.5213   130%     -   53s
H    0     0                    -111387.1548 36066.5213   132%     -   53s
H    0     0                    -108966.1514 36066.5213   133%     -   54s
H    0     0                    -108885.5119 36066.5213   133%     -   54s
H    0     0                    -39710.99943 36066.5213   191%     -   54s
H    0     0                    -39694.42703 36066.5213   191%     -   56s
H    0     0                    -25532.06717 36066.5213   241%     -   56s
H    0     0                    -4568.082302 36066.5213   890%     -   57s
H    0     0                    -4411.056852 36066.5213   918%     -   60s
H    0     0                    -4273.126665 36066.5213   944%     -   61s
H    0     0                    -663.3149967 36066.5213  5537%     -   67s
H    0     0                    -487.7003718 36066.5213  7495%     -   67s
H    0     0                    -391.6996727 36066.5213  9308%     -   67s
H    0     0                    -261.8841013 36066.5213      -     -   67s
H    0     0                     -69.5767390 36066.5213      -     -   67s
H    0     0                     -56.1785689 36066.5213      -     -   67s
H    0     0                     -43.8269250 36066.5213      -     -   67s
H    0     0                     -33.1936993 36066.5213      -     -   67s
H    0     0                      -6.5337188 36066.5213      -     -   67s
H    0     0                       3.7947970 30418.1614      -     -   93s
     0     0 30336.9325    0  304    3.79480 30336.9325      -     -  108s
H    0     0                     765.7142795 30336.9325  3862%     -  110s
H    0     0                     940.1202865 30336.9325  3127%     -  110s
     0     0 29828.9109    0  328  940.12029 29828.9109  3073%     -  131s
     0     0 29739.1153    0  329  940.12029 29739.1153  3063%     -  155s
     0     0 29678.1864    0  326  940.12029 29678.1864  3057%     -  167s
     0     0 29668.1147    0  324  940.12029 29668.1147  3056%     -  175s
     0     0 29668.1147    0  319  940.12029 29668.1147  3056%     -  180s
     0     0 29633.2600    0  327  940.12029 29633.2600  3052%     -  181s
     0     0 29623.8964    0  321  940.12029 29623.8964  3051%     -  184s
     0     0 29623.7910    0  321  940.12029 29623.7910  3051%     -  185s
     0     0 26503.8419    0  351  940.12029 26503.8419  2719%     -  283s
H    0     0                    1021.1592557 26503.6878  2495%     -  285s
H    0     0                    1207.6370280 26503.6878  2095%     -  285s
H    0     0                    1535.1927915 26503.6878  1626%     -  285s
H    0     0                    1550.6694597 26503.6878  1609%     -  285s
H    0     0                    1642.7313079 26503.6878  1513%     -  285s
     0     0 25676.9525    0  463 1642.73131 25676.9525  1463%     -  323s
     0     0 25397.4054    0  409 1642.73131 25397.4054  1446%     -  366s
     0     0 25286.8348    0  412 1642.73131 25286.8348  1439%     -  401s
     0     0 25224.4497    0  401 1642.73131 25224.4497  1436%     -  416s
     0     0 25039.8479    0  410 1642.73131 25039.8479  1424%     -  444s
H    0     0                    1731.0391628 24929.8649  1340%     -  472s
H    0     0                    2051.3188888 24929.8649  1115%     -  472s
H    0     0                    2117.0793302 24929.8649  1078%     -  472s
     0     0 24929.8649    0  471 2117.07933 24929.8649  1078%     -  472s
H    0     0                    2262.0992948 24866.2362   999%     -  482s
H    0     0                    2376.1244381 24866.2362   947%     -  482s
H    0     0                    2397.7533363 24866.2362   937%     -  482s
H    0     0                    2422.4935800 24866.2362   926%     -  482s
H    0     0                    2437.8836204 24866.2362   920%     -  482s
H    0     0                    2553.7952595 24866.2362   874%     -  482s
H    0     0                    2572.3911678 24866.2362   867%     -  482s
H    0     0                    2718.0246684 24866.2362   815%     -  482s
     0     0 24866.2362    0  482 2718.02467 24866.2362   815%     -  482s
     0     0 24860.6242    0  469 2718.02467 24860.6242   815%     -  485s
     0     0 24851.8283    0  474 2718.02467 24851.8283   814%     -  487s
     0     0 24841.3619    0  478 2718.02467 24841.3619   814%     -  490s
     0     0 24750.4114    0  481 2718.02467 24750.4114   811%     -  498s
     0     0 24721.1310    0  476 2718.02467 24721.1310   810%     -  502s
     0     0 24720.0504    0  476 2718.02467 24720.0504   809%     -  503s
H    0     0                    2719.0805195 21931.5337   707%     -  588s
     0     0 21931.5337    0  442 2719.08052 21931.5337   707%     -  588s
H    0     0                    2722.1467547 21931.4647   706%     -  590s
H    0     0                    2869.0639656 21931.4647   664%     -  590s
     0     0 21513.2597    0  480 2869.06397 21513.2597   650%     -  627s
     0     0 21271.1838    0  523 2869.06397 21271.1838   641%     -  651s
     0     0 21200.8567    0  527 2869.06397 21200.8567   639%     -  662s
H    0     0                    3040.3138098 21084.6944   594%     -  680s
     0     0 21084.6944    0  533 3040.31381 21084.6944   594%     -  681s
     0     0 21038.3928    0  543 3040.31381 21038.3928   592%     -  690s
     0     0 20978.5383    0  539 3040.31381 20978.5383   590%     -  701s
     0     0 20967.0610    0  545 3040.31381 20967.0610   590%     -  707s
     0     0 20953.3732    0  545 3040.31381 20953.3732   589%     -  714s
     0     0 20943.7504    0  544 3040.31381 20943.7504   589%     -  718s
     0     0 20941.5334    0  555 3040.31381 20941.5334   589%     -  721s
     0     0 19875.1688    0  547 3040.31381 19875.1688   554%     -  795s
H    0     0                    3101.1711228 19874.9622   541%     -  797s
H    0     0                    3114.1667237 19874.9622   538%     -  798s
H    0     0                    3147.0845242 19874.9622   532%     -  798s
     0     0 19290.0438    0  460 3147.08452 19290.0438   513%     -  837s
     0     0 19117.1992    0  563 3147.08452 19117.1992   507%     -  859s
     0     0 19061.7522    0  476 3147.08452 19061.7522   506%     -  872s
     0     0 19038.7464    0  417 3147.08452 19038.7464   505%     -  877s
     0     0 19005.2347    0  488 3147.08452 19005.2347   504%     -  886s
     0     0 18970.8723    0  483 3147.08452 18970.8723   503%     -  896s
     0     0 18945.8445    0  487 3147.08452 18945.8445   502%     -  901s
     0     0 18941.6732    0  484 3147.08452 18941.6732   502%     -  902s
     0     0 18935.0950    0  418 3147.08452 18935.0950   502%     -  905s
     0     0 18915.4188    0  424 3147.08452 18915.4188   501%     -  909s
     0     0 18911.3888    0  413 3147.08452 18911.3888   501%     -  911s
     0     0 18899.5983    0  507 3147.08452 18899.5983   501%     -  915s
     0     0 18896.8326    0  435 3147.08452 18896.8326   500%     -  917s
     0     0 18895.1913    0  509 3147.08452 18895.1913   500%     -  919s
     0     0 18702.6991    0  635 3147.08452 18702.6991   494%     -  938s
H    0     0                    3167.4894769 18702.1461   490%     -  938s
     0     0 18653.8376    0  590 3167.48948 18653.8376   489%     -  953s
     0     0 18640.9817    0  647 3167.48948 18640.9817   489%     -  957s
     0     0 18618.8925    0  645 3167.48948 18618.8925   488%     -  966s
     0     0 18614.9841    0  682 3167.48948 18614.9841   488%     -  969s
     0     0 18613.3275    0  652 3167.48948 18613.3275   488%     -  971s
     0     0 18520.9315    0  528 3167.48948 18520.9315   485%     -  985s
     0     0 18468.7234    0  580 3167.48948 18468.7234   483%     - 1005s
     0     0 18460.2924    0  581 3167.48948 18460.2924   483%     - 1010s
     0     0 18454.7300    0  511 3167.48948 18454.7300   483%     - 1014s
     0     0 18447.3267    0  518 3167.48948 18447.3267   482%     - 1018s
     0     0 18444.3014    0  520 3167.48948 18444.3014   482%     - 1021s
     0     0 18443.4743    0  524 3167.48948 18443.4743   482%     - 1023s
     0     0 18388.9975    0  523 3167.48948 18388.9975   481%     - 1038s
     0     0 18370.4931    0  575 3167.48948 18370.4931   480%     - 1053s
     0     0 18366.0723    0  523 3167.48948 18366.0723   480%     - 1057s
     0     0 18363.4718    0  518 3167.48948 18363.4718   480%     - 1059s
H    0     0                    3308.1877030 18308.8253   453%     - 1078s
     0     0 18308.8253    0  640 3308.18770 18308.8253   453%     - 1078s
H    0     0                    3332.7982341 18293.6229   449%     - 1090s
     0     0 18293.6229    0  535 3332.79823 18293.6229   449%     - 1091s
     0     0 18286.8770    0  479 3332.79823 18286.8770   449%     - 1096s
     0     0 18282.5580    0  530 3332.79823 18282.5580   449%     - 1100s
     0     0 18280.6415    0  529 3332.79823 18280.6415   449%     - 1102s
H    0     0                    3346.0330675 18259.8235   446%     - 1112s
     0     0 18259.8235    0  636 3346.03307 18259.8235   446%     - 1112s
H    0     0                    3401.6840186 18259.8126   437%     - 1113s
     0     0 18248.1028    0  611 3401.68402 18248.1028   436%     - 1123s
     0     0 18244.5740    0  575 3401.68402 18244.5740   436%     - 1129s
     0     0 18241.8078    0  582 3401.68402 18241.8078   436%     - 1133s
     0     0 18214.2582    0  497 3401.68402 18214.2582   435%     - 1149s
     0     0 18181.4404    0  503 3401.68402 18181.4404   434%     - 1162s
     0     0 18177.4843    0  497 3401.68402 18177.4843   434%     - 1168s
     0     0 18174.0490    0  506 3401.68402 18174.0490   434%     - 1172s
     0     0 18169.4579    0  512 3401.68402 18169.4579   434%     - 1176s
     0     0 18168.5286    0  519 3401.68402 18168.5286   434%     - 1179s
     0     0 18157.6887    0  583 3401.68402 18157.6887   434%     - 1188s
     0     0 18156.4855    0  538 3401.68402 18156.4855   434%     - 1194s
     0     0 18150.9071    0  567 3401.68402 18150.9071   434%     - 1198s
     0     0 18148.3247    0  647 3401.68402 18148.3247   434%     - 1204s
     0     0 18138.3126    0  631 3401.68402 18138.3126   433%     - 1214s
     0     0 18138.2965    0  631 3401.68402 18138.2965   433%     - 1217s
H    0     0                    3447.9311153 18138.2565   426%     - 1378s
H    0     0                    3559.2231394 18138.2565   410%     - 1378s
H    0     0                    3616.2807041 18138.2565   402%     - 1379s
     0     2 18138.2565    0  631 3616.28070 18138.2565   402%     - 1414s
     1     3 17653.4519    1  476 3616.28070 18137.8179   402% 20149 1452s
     2     4 17822.1074    1  562 3616.28070 17822.1074   393% 18037 1478s
     3     6 17129.4363    2  535 3616.28070 17821.9449   393% 15422 1504s
     5    11 16911.1131    3  455 3616.28070 17821.9449   393% 12911 1539s
    10    21 17415.8871    3  518 3616.28070 17662.6590   388% 11585 1596s
    20    31 15493.5076    4  318 3616.28070 17461.8144   383% 14462 1829s
H   30    61                    3652.0205435 17461.8144   378% 13070 2172s
H   47    61                    3678.3707927 17461.8144   375% 11197 2172s
    60    93 15662.0597    6  556 3678.37079 17461.8144   375% 20841 2277s
    92   173 15643.5226    7  487 3678.37079 17461.8144   375% 19779 2459s
H  102   173                    3679.0670286 17461.8144   375% 18341 2459s
H  135   173                    3689.5296426 17461.8144   373% 14784 2459s
   172   278 13746.1543    9  308 3689.52964 17461.8144   373% 13060 2550s
   277   347 12411.0012   15  221 3689.52964 17461.8144   373%  9647 2624s
   346   420 11877.0336   13  214 3689.52964 17461.8144   373%  9128 2682s
   419   495 11753.0186   15  214 3689.52964 17461.8144   373%  8210 2741s
   504   570 10909.7893   18  123 3689.52964 17461.8144   373%  7684 2781s
   585   608 10695.0268   23  115 3689.52964 17461.8144   373%  7200 2817s
   629   678 10619.4567   24  118 3689.52964 17461.8144   373%  6890 2852s
   701   751 10061.8275   29   87 3689.52964 17461.8144   373%  6479 2886s
   786   826 9817.83242   34   65 3689.52964 17461.8144   373%  6138 2917s
   873   858 5892.89321   37  151 3689.52964 17461.8144   373%  5964 2944s
   924   900 5495.34795   38  155 3689.52964 17461.8144   373%  5882 2970s
  1006   953 4840.19059   44  142 3689.52964 17461.8144   373%  5692 3003s
  1095  1003 4639.71384   50  139 3689.52964 17461.8144   373%  5477 3036s
  1203  1050 infeasible   55      3689.52964 17461.8144   373%  5236 3073s
H 1241  1050                    3706.7526739 17461.8144   371%  5209 3073s
  1302  1090 4110.15134   58   94 3706.75267 17461.8144   371%  5118 3113s
  1396  1104     cutoff   63      3706.75267 17461.8144   371%  5076 3156s
H 1419  1104                    3718.7706428 17461.8144   370%  5076 3156s
  1434  1189 3935.68935   60   91 3718.77064 17461.8144   370%  5121 3197s
  1567  1211 6933.01852   22  179 3718.77064 17461.8144   370%  4973 3227s
H 1601  1248                    3734.0158000 17461.8144   368%  4989 3267s
H 1644  1248                    3745.6953349 17461.8144   366%  4944 3267s
  1650  1378 5846.26203   29  172 3745.69533 17461.8144   366%  4947 3317s
  1835  1444 4742.89026   32  139 3745.69533 17461.8144   366%  4741 3361s
H 1850  1444                    3816.4122907 17461.8144   358%  4714 3361s
  1986  1509 3989.61786   37  102 3816.41229 17461.8144   358%  4582 3409s
  2147  1538 14728.5375   11  295 3816.41229 17461.8144   358%  4464 3453s
  2200  1595 4996.77092   46  131 3816.41229 17461.8144   358%  4482 3508s
  2327  1604 7120.62159   12  236 3816.41229 17461.8144   358%  4428 3561s
  2366  1622 6952.90612   13  249 3816.41229 17461.8144   358%  4454 3600s

Cutting planes:
  Learned: 2
  Gomory: 43
  Implied bound: 274
  MIR: 2790
  Flow cover: 3256
  RLT: 114
  Relax-and-lift: 973

Explored 2417 nodes (11451024 simplex iterations) in 3600.15 seconds (4259.32 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 3816.41 3745.7 3734.02 ... 3616.28

Time limit reached
Best objective 3.816412290693e+03, best bound 1.746181437680e+04, gap 357.5453%
  WARNING: Time limit reached. Using best solution found (gap: 357.55%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.21s
  Master Objective (UB) = 3816.41, θ = 145549.96
  Upper Bound (UB) = 3816.41

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 145549.96
  [DEBUG]   ✓ Scenario 0: θ = 145549.96 ≤ Q = 145549.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 145549.96 ≤ Q = 145549.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 145549.96 ≤ Q = 145549.96 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 145549.96 ≤ Q = 145549.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 145549.96 ≤ Q = 145549.96 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 145549.96 ≤ Q = 145549.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 145549.96 ≤ Q = 145549.96 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 145549.96 ≤ Q = 145549.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 145549.96 ≤ Q = 145549.96 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 145549.96 ≤ Q = 145549.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 145549.96 ≤ Q = 145549.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 145549.96 ≤ Q = 145549.96 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 12] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x7d209066
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x82df6f9a
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [2e-13, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [5e-01, 2e+02]
Found heuristic solution: objective 1.150567e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.00s
Presolved: 494 rows, 498 columns, 1393 nonzeros
Found heuristic solution: objective 5767729.3128
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.262302e+05, 240 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -126230.20    0  122 5767729.31 -126230.20   102%     -    0s
H    0     0                    -94161.22030 -126230.20  34.1%     -    0s
H    0     0                    -94967.54595 -126230.20  32.9%     -    0s
     0     0 -102089.82    0   84 -94967.546 -102089.82  7.50%     -    0s
H    0     0                    -97146.39489 -102019.09  5.02%     -    0s
     0     0 -101736.87    0   84 -97146.395 -101736.87  4.73%     -    0s
H    0     0                    -98769.33059 -101708.96  2.98%     -    0s
     0     0 -101708.96    0   84 -98769.331 -101708.96  2.98%     -    0s
     0     0 -101708.96    0   84 -98769.331 -101708.96  2.98%     -    0s
H    0     0                    -101192.9560 -101708.96  0.51%     -    0s
     0     0 -101555.13    0   77 -101192.96 -101555.13  0.36%     -    0s
     0     0 -101521.05    0   71 -101192.96 -101521.05  0.32%     -    0s
     0     0 -101504.33    0   64 -101192.96 -101504.33  0.31%     -    0s
     0     0 -101503.79    0   65 -101192.96 -101503.79  0.31%     -    0s
     0     0 -101451.97    0   42 -101192.96 -101451.97  0.26%     -    0s
     0     0 -101447.42    0   40 -101192.96 -101447.42  0.25%     -    0s
     0     0 -101426.03    0   39 -101192.96 -101426.03  0.23%     -    0s
     0     0 -101426.03    0   38 -101192.96 -101426.03  0.23%     -    0s
     0     0 -101404.01    0   37 -101192.96 -101404.01  0.21%     -    0s
     0     0 -101382.28    0   37 -101192.96 -101382.28  0.19%     -    0s
     0     0 -101382.28    0   53 -101192.96 -101382.28  0.19%     -    0s
     0     0 -101382.28    0   42 -101192.96 -101382.28  0.19%     -    0s
     0     0 -101382.28    0   37 -101192.96 -101382.28  0.19%     -    0s
     0     0 -101382.28    0   35 -101192.96 -101382.28  0.19%     -    0s
     0     0 -101382.28    0   36 -101192.96 -101382.28  0.19%     -    0s
     0     0 -101382.28    0   36 -101192.96 -101382.28  0.19%     -    0s
     0     0 -101375.49    0   36 -101192.96 -101375.49  0.18%     -    0s
     0     0 -101375.49    0   36 -101192.96 -101375.49  0.18%     -    0s
     0     2 -101375.49    0   36 -101192.96 -101375.49  0.18%     -    0s
H    3     5                    -101246.4671 -101310.74  0.06%   8.0    0s

Cutting planes:
  Gomory: 8
  Implied bound: 1
  MIR: 65
  Flow cover: 10

Explored 21 nodes (1007 simplex iterations) in 0.30 seconds (0.08 work units)
Thread count was 32 (of 64 available processors)

Solution count 8: -101246 -101193 -98022.4 ... 1.15057e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.012464670526e+05, best bound -1.012554949319e+05, gap 0.0089%
  Subproblem solved in 0.37s
  Worst-case operational profit (Z_SP) = 141217.17
  Scenario: 7 demand increases, 53 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -101246.47
  [DEBUG]   S×d_nominal = 242463.64
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 242463.64 + -101246.47 = 141217.17
  [DEBUG]   Current θ from Master = 145549.96
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4332.78 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -516.37
  Lower Bound (LB) = 984.62
  Gap (UB-LB) = 2831.7875, Absolute Gap = 2831.7875, Relative Gap = 0.742003
  Not converged yet (gap = 2831.79 > ε = 200)

  [DEBUG] Adding NEW scenario 12 to Master Problem...
  [DEBUG] New scenario pattern: 7 increases, 53 decreases
    [DEBUG] Scenario 12 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 12 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 12]
    [DEBUG]   - Total constraints in model: 200153
    [DEBUG]   - Total variables in model: 83380
  [DEBUG] Total scenarios in Master: 13
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 13
================================================================================
[Iteration 13] Solving Master Problem...
  Current scenarios in Master: 13
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 200153 rows, 83380 columns and 567522 nonzeros
Model fingerprint: 0x641f3143
Variable types: 81121 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 91910 rows and 37310 columns
Presolve time: 3.37s
Presolved: 108243 rows, 46070 columns, 654063 nonzeros
Variable types: 43811 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -372912.9578
Found heuristic solution: objective -210461.3866

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.29s

Barrier statistics:
 Dense cols : 586
 AA' NZ     : 4.305e+06
 Factor NZ  : 1.075e+07 (roughly 150 MB of memory)
 Factor Ops : 3.110e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.78250560e+07  1.80701876e+08  1.00e+05 2.00e+01  7.84e+04     5s
   1  -1.36192858e+07  1.62884041e+08  7.01e+04 6.41e+01  5.41e+04     5s
   2  -6.89673806e+06  1.26198313e+08  3.42e+04 8.87e-01  2.77e+04     6s
   3  -1.21197240e+06  9.81439610e+07  3.69e+03 1.87e+00  3.36e+03     6s
   4  -5.23533479e+05  5.79025322e+07  4.18e+02 3.39e-01  5.94e+02     6s
   5  -4.61494793e+05  3.14768483e+07  2.54e+02 1.48e-01  3.22e+02     6s
   6  -3.82108699e+05  2.38226251e+07  1.00e+02 1.05e-01  1.81e+02     6s
   7  -3.18563917e+05  1.74537020e+07  5.30e+01 7.23e-02  1.17e+02     7s
   8  -2.04389902e+05  1.18186194e+07  1.43e+01 4.58e-02  6.66e+01     7s
   9  -1.52835519e+05  7.42048494e+06  7.39e+00 2.74e-02  4.04e+01     7s
  10  -1.07434810e+05  5.06773084e+06  4.27e+00 1.86e-02  2.70e+01     7s
  11  -7.35628500e+04  2.99200479e+06  1.64e+00 1.07e-02  1.57e+01     7s
  12  -3.81459577e+04  1.43671173e+06  4.09e-01 5.03e-03  7.47e+00     8s
  13  -2.76068257e+04  6.14552816e+05  2.83e-01 2.73e-03  3.25e+00     8s
  14  -1.75198009e+04  3.60441359e+05  1.83e-01 1.58e-03  1.91e+00     8s
  15  -1.10675802e+04  2.27683030e+05  1.42e-01 1.26e-03  1.21e+00     8s
  16  -4.09024299e+03  1.56826687e+05  1.06e-01 1.36e-03  8.13e-01     8s
  17   3.80355857e+03  1.22363874e+05  7.60e-02 2.29e-03  5.99e-01     8s
  18   8.96853066e+03  1.00020145e+05  5.77e-02 1.21e-03  4.60e-01     8s
  19   1.48132626e+04  7.84278016e+04  4.14e-02 1.81e-03  3.21e-01     9s
  20   1.84378571e+04  6.72643803e+04  3.34e-02 2.12e-03  2.47e-01     9s
  21   2.13927179e+04  5.95954451e+04  2.71e-02 1.61e-03  1.93e-01     9s
  22   2.33729474e+04  5.48005357e+04  2.28e-02 1.32e-03  1.59e-01     9s
  23   2.60024841e+04  4.93156114e+04  1.76e-02 9.10e-04  1.18e-01    10s
  24   2.71302157e+04  4.72281223e+04  1.56e-02 7.80e-04  1.01e-01    10s
  25   2.82457894e+04  4.51609835e+04  1.35e-02 6.39e-04  8.54e-02    10s
  26   2.89324136e+04  4.23210371e+04  1.23e-02 4.31e-04  6.76e-02    10s
  27   3.03838126e+04  4.11717332e+04  9.88e-03 3.59e-04  5.45e-02    11s
  28   3.11846376e+04  4.00535604e+04  8.53e-03 2.79e-04  4.48e-02    11s
  29   3.20912648e+04  3.96958566e+04  7.04e-03 2.52e-04  3.84e-02    11s
  30   3.30273185e+04  3.93070838e+04  5.54e-03 2.20e-04  3.17e-02    11s
  31   3.38226501e+04  3.87954490e+04  4.25e-03 1.74e-04  2.51e-02    12s
  32   3.41383575e+04  3.81721835e+04  3.76e-03 1.45e-04  2.04e-02    12s
  33   3.46435916e+04  3.78493375e+04  2.98e-03 1.12e-04  1.62e-02    12s
  34   3.51829466e+04  3.76188042e+04  2.15e-03 8.91e-05  1.23e-02    12s
  35   3.56166651e+04  3.72910829e+04  1.53e-03 5.81e-05  8.45e-03    12s
  36   3.57427346e+04  3.71211696e+04  1.34e-03 5.34e-05  6.96e-03    13s
  37   3.58641112e+04  3.70725995e+04  1.16e-03 4.72e-05  6.10e-03    13s
  38   3.59476928e+04  3.70302246e+04  1.04e-03 4.79e-05  5.47e-03    13s
  39   3.60209654e+04  3.69750823e+04  9.39e-04 3.99e-05  4.82e-03    13s
  40   3.62426208e+04  3.69033272e+04  6.14e-04 3.23e-05  3.34e-03    14s
  41   3.63318142e+04  3.68459193e+04  4.84e-04 2.35e-05  2.60e-03    14s
  42   3.64167283e+04  3.68016191e+04  3.67e-04 1.68e-05  1.94e-03    14s
  43   3.65079699e+04  3.67725680e+04  2.35e-04 1.23e-05  1.34e-03    14s
  44   3.65389033e+04  3.67593874e+04  1.92e-04 1.05e-05  1.11e-03    15s
  45   3.65979455e+04  3.67367279e+04  1.13e-04 7.30e-06  7.01e-04    15s
  46   3.66500087e+04  3.67087600e+04  4.29e-05 3.03e-06  2.97e-04    15s
  47   3.66625863e+04  3.66908449e+04  2.73e-05 4.49e-06  1.43e-04    15s
  48   3.66790665e+04  3.66894423e+04  6.51e-06 3.19e-06  5.24e-05    16s
  49   3.66821516e+04  3.66877436e+04  3.30e-06 1.53e-06  2.82e-05    16s
  50   3.66839117e+04  3.66864679e+04  1.60e-06 6.69e-07  1.29e-05    16s
  51   3.66844934e+04  3.66860267e+04  1.07e-06 2.66e-07  7.74e-06    17s
  52   3.66851883e+04  3.66857688e+04  4.18e-07 4.35e-08  2.93e-06    17s
  53   3.66856512e+04  3.66856855e+04  2.12e-08 1.34e-08  1.73e-07    17s
  54   3.66856781e+04  3.66856785e+04  1.07e-09 4.06e-10  2.28e-09    17s
  55   3.66856785e+04  3.66856785e+04  9.52e-09 3.95e-11  2.22e-11    18s

Barrier solved model in 55 iterations and 17.85 seconds (11.21 work units)
Optimal objective 3.66856785e+04


Root crossover log...

   93140 DPushes remaining with DInf 0.0000000e+00                18s
    2040 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                20s

    1874 PPushes remaining with PInf 2.1670641e-06                20s
       0 PPushes remaining with PInf 0.0000000e+00                20s

  Push phase complete: Pinf 0.0000000e+00, Dinf 6.6770629e-11     20s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   34049    3.6685679e+04   0.000000e+00   0.000000e+00     21s
   34049    3.6685679e+04   0.000000e+00   0.000000e+00     21s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 3.668568e+04, 34049 iterations, 16.47 seconds (10.57 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 36685.6785    0  259 -210461.39 36685.6785   117%     -   21s
H    0     0                    -207930.4184 36685.6785   118%     -   21s
H    0     0                    -173284.4656 36685.6785   121%     -   21s
H    0     0                    -156573.8446 36685.6785   123%     -   21s
H    0     0                    -43108.45948 36685.6785   185%     -   21s
H    0     0                    -43091.88708 36685.6785   185%     -   21s
H    0     0                    -24298.96883 36685.6785   251%     -   21s
H    0     0                    -24013.31589 36685.6785   253%     -   21s
H    0     0                    -7073.820493 36685.6785   619%     -   22s
H    0     0                    -6818.708668 36685.6785   638%     -   22s
H    0     0                    -4341.251952 36685.6785   945%     -   25s
H    0     0                    -4170.532318 36685.6785   980%     -   25s
H    0     0                     826.2826271 36685.6785  4340%     -   25s
H    0     0                     976.8724894 36685.6785  3655%     -   25s
H    0     0                     983.1604492 36685.6785  3631%     -   25s
H    0     0                     991.1409987 36685.6785  3601%     -   25s
     0     0 31178.8779    0  342  991.14100 31178.8779  3046%     -   57s
H    0     0                    1020.2740700 31174.5606  2956%     -   58s
H    0     0                    1505.1350753 31174.5606  1971%     -   59s
H    0     0                    1588.2685390 31174.5606  1863%     -   59s
H    0     0                    1734.2386423 31174.5606  1698%     -   59s
     0     0 30739.1406    0  324 1734.23864 30739.1406  1672%     -   72s
     0     0 30524.0337    0  326 1734.23864 30524.0337  1660%     -   81s
     0     0 30455.4553    0  329 1734.23864 30455.4553  1656%     -   86s
     0     0 30406.3693    0  325 1734.23864 30406.3693  1653%     -   89s
     0     0 30402.4033    0  324 1734.23864 30402.4033  1653%     -   90s
     0     0 30402.1623    0  324 1734.23864 30402.1623  1653%     -   91s
     0     0 26890.8431    0  437 1734.23864 26890.8431  1451%     -  146s
H    0     0                    1870.0318541 26890.8431  1338%     -  147s
H    0     0                    1932.3712233 26890.8431  1292%     -  147s
H    0     0                    2096.0411571 26890.8431  1183%     -  147s
H    0     0                    2100.5850158 26890.8431  1180%     -  147s
     0     0 26510.0055    0  511 2100.58502 26510.0055  1162%     -  175s
     0     0 26405.2065    0  422 2100.58502 26405.2065  1157%     -  189s
     0     0 26281.9812    0  485 2100.58502 26281.9812  1151%     -  203s
     0     0 26206.3034    0  473 2100.58502 26206.3034  1148%     -  213s
     0     0 26056.3574    0  480 2100.58502 26056.3574  1140%     -  227s
     0     0 26042.0162    0  481 2100.58502 26042.0162  1140%     -  232s
     0     0 26022.9339    0  470 2100.58502 26022.9339  1139%     -  239s
     0     0 26016.7150    0  474 2100.58502 26016.7150  1139%     -  242s
     0     0 26006.3868    0  485 2100.58502 26006.3868  1138%     -  246s
     0     0 26005.7017    0  488 2100.58502 26005.7017  1138%     -  247s
H    0     0                    2443.4258639 23315.5521   854%     -  324s
H    0     0                    2501.2355580 23315.5521   832%     -  324s
     0     0 23315.5521    0  441 2501.23556 23315.5521   832%     -  324s
H    0     0                    2657.3096553 22722.7948   755%     -  382s
     0     0 22722.7948    0  438 2657.30966 22722.7948   755%     -  382s
     0     0 22478.3755    0  432 2657.30966 22478.3755   746%     -  415s
     0     0 22359.4861    0  446 2657.30966 22359.4861   741%     -  436s
     0     0 22157.1931    0  426 2657.30966 22157.1931   734%     -  459s
H    0     0                    2900.1555377 21894.2928   655%     -  487s
H    0     0                    2982.9207858 21894.2928   634%     -  487s
H    0     0                    2996.4673540 21894.2928   631%     -  487s
H    0     0                    3037.2072045 21894.2928   621%     -  487s
     0     0 21894.2928    0  511 3037.20720 21894.2928   621%     -  487s
     0     0 21796.1143    0  465 3037.20720 21796.1143   618%     -  500s
     0     0 21778.7842    0  531 3037.20720 21778.7842   617%     -  508s
     0     0 21768.0304    0  517 3037.20720 21768.0304   617%     -  513s
     0     0 21757.5041    0  460 3037.20720 21757.5041   616%     -  518s
     0     0 21750.4747    0  467 3037.20720 21750.4747   616%     -  521s
     0     0 21747.4424    0  468 3037.20720 21747.4424   616%     -  523s
     0     0 21745.9255    0  468 3037.20720 21745.9255   616%     -  525s
H    0     0                    3057.7140684 20045.1916   556%     -  610s
     0     0 20045.1916    0  403 3057.71407 20045.1916   556%     -  610s
H    0     0                    3366.5495441 19719.0093   486%     -  652s
     0     0 19719.0093    0  490 3366.54954 19719.0093   486%     -  652s
H    0     0                    3380.8180533 19512.4413   477%     -  679s
     0     0 19512.4413    0  499 3380.81805 19512.4413   477%     -  679s
     0     0 19435.4343    0  485 3380.81805 19435.4343   475%     -  694s
     0     0 19405.3882    0  492 3380.81805 19405.3882   474%     -  709s
     0     0 19391.3992    0  566 3380.81805 19391.3992   474%     -  723s
     0     0 19365.4969    0  550 3380.81805 19365.4969   473%     -  735s
     0     0 19348.5668    0  549 3380.81805 19348.5668   472%     -  743s
     0     0 19344.2630    0  561 3380.81805 19344.2630   472%     -  749s
     0     0 19341.5088    0  561 3380.81805 19341.5088   472%     -  753s
     0     0 19089.8401    0  576 3380.81805 19089.8401   465%     -  791s
     0     0 18989.2491    0  555 3380.81805 18989.2491   462%     -  819s
     0     0 18932.2508    0  505 3380.81805 18932.2508   460%     -  840s
     0     0 18914.9774    0  575 3380.81805 18914.9774   459%     -  851s
     0     0 18903.9229    0  640 3380.81805 18903.9229   459%     -  861s
     0     0 18899.1896    0  571 3380.81805 18899.1896   459%     -  866s
     0     0 18884.3579    0  575 3380.81805 18884.3579   459%     -  872s
     0     0 18877.5398    0  579 3380.81805 18877.5398   458%     -  878s
     0     0 18867.5504    0  568 3380.81805 18867.5504   458%     -  884s
     0     0 18863.5100    0  572 3380.81805 18863.5100   458%     -  887s
     0     0 18857.9795    0  564 3380.81805 18857.9795   458%     -  892s
     0     0 18857.4583    0  564 3380.81805 18857.4583   458%     -  894s
     0     0 18698.4309    0  664 3380.81805 18698.4309   453%     -  929s
     0     0 18651.9029    0  520 3380.81805 18651.9029   452%     -  944s
     0     0 18636.0327    0  678 3380.81805 18636.0327   451%     -  957s
     0     0 18615.5604    0  675 3380.81805 18615.5604   451%     -  967s
     0     0 18612.8320    0  684 3380.81805 18612.8320   451%     -  974s
     0     0 18573.7971    0  485 3380.81805 18573.7971   449%     -  991s
     0     0 18547.0644    0  578 3380.81805 18547.0644   449%     - 1003s
     0     0 18540.9253    0  575 3380.81805 18540.9253   448%     - 1011s
     0     0 18534.8760    0  620 3380.81805 18534.8760   448%     - 1019s
     0     0 18533.1162    0  510 3380.81805 18533.1162   448%     - 1025s
     0     0 18497.8832    0  574 3380.81805 18497.8832   447%     - 1043s
     0     0 18492.4056    0  511 3380.81805 18492.4056   447%     - 1049s
     0     0 18485.5598    0  497 3380.81805 18485.5598   447%     - 1055s
     0     0 18484.3223    0  498 3380.81805 18484.3223   447%     - 1059s
     0     0 18471.9376    0  443 3380.81805 18471.9376   446%     - 1069s
     0     0 18469.2511    0  625 3380.81805 18469.2511   446%     - 1078s
     0     0 18451.2928    0  568 3380.81805 18451.2928   446%     - 1093s
     0     0 18443.3639    0  508 3380.81805 18443.3639   446%     - 1105s
     0     0 18440.6670    0  503 3380.81805 18440.6670   445%     - 1110s
     0     0 18425.9459    0  518 3380.81805 18425.9459   445%     - 1126s
     0     0 18425.6295    0  518 3380.81805 18425.6295   445%     - 1130s
     0     2 18425.6295    0  518 3380.81805 18425.6295   445%     - 1283s
     1     3 16901.1459    1  289 3380.81805 18425.6295   445% 13216 1308s
     2     6 16778.6956    2  279 3380.81805 18425.6295   445%  8616 1324s
     5     9 18174.2676    2  510 3380.81805 18303.5130   441%  8121 1353s
     8    17 14993.3925    4  308 3380.81805 18303.5130   441% 10900 1378s
    16    31 14329.3756    5  301 3380.81805 18187.9169   438% 10080 1443s
    30    44 14847.3289    5  297 3380.81805 18187.6046   438% 15930 3600s

Cutting planes:
  Gomory: 10
  Implied bound: 196
  MIR: 2753
  Flow cover: 2344
  Inf proof: 1
  RLT: 143
  Relax-and-lift: 1087

Explored 43 nodes (1489685 simplex iterations) in 3600.33 seconds (5321.91 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 3380.82 3366.55 3057.71 ... 2443.43

Time limit reached
Best objective 3.380818053324e+03, best bound 1.807257282133e+04, gap 434.5621%
  WARNING: Time limit reached. Using best solution found (gap: 434.56%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3600.38s
  Master Objective (UB) = 3380.82, θ = 146234.97
  Upper Bound (UB) = 3380.82

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 146234.97
  [DEBUG]   ✓ Scenario 0: θ = 146234.97 ≤ Q = 146234.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 146234.97 ≤ Q = 146234.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 146234.97 ≤ Q = 146234.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 146234.97 ≤ Q = 146234.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 146234.97 ≤ Q = 146234.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 146234.97 ≤ Q = 146234.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 146234.97 ≤ Q = 146234.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 146234.97 ≤ Q = 146234.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 146234.97 ≤ Q = 146234.97 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 146234.97 ≤ Q = 146234.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 146234.97 ≤ Q = 146234.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 146234.97 ≤ Q = 146234.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 146234.97 ≤ Q = 146234.97 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 13] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0xf9424b5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xf06bdb4b
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [2e-13, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [5e-01, 2e+02]
Found heuristic solution: objective 1.150297e+13
Presolve removed 2598 rows and 1890 columns
Presolve time: 0.00s
Presolved: 495 rows, 499 columns, 1396 nonzeros
Found heuristic solution: objective 5749140.3424
Variable types: 339 continuous, 160 integer (160 binary)

Root relaxation: objective -1.265465e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -126546.50    0  123 5749140.34 -126546.50   102%     -    0s
H    0     0                    -94305.79705 -126546.50  34.2%     -    0s
H    0     0                    -95112.12270 -126546.50  33.0%     -    0s
     0     0 -103841.59    0  116 -95112.123 -103841.59  9.18%     -    0s
H    0     0                    -99287.25456 -103729.55  4.47%     -    0s
H    0     0                    -101720.5812 -103729.55  1.97%     -    0s
     0     0 -102984.77    0  102 -101720.58 -102984.77  1.24%     -    0s
H    0     0                    -101972.5985 -102974.46  0.98%     -    0s
     0     0 -102793.65    0  111 -101972.60 -102793.65  0.81%     -    0s
     0     0 -102769.82    0  111 -101972.60 -102769.82  0.78%     -    0s
     0     2 -102763.24    0  111 -101972.60 -102763.24  0.78%     -    0s
H   29    22                    -102003.0104 -102498.04  0.49%  17.4    0s
H  576    54                    -102003.7163 -102234.51  0.23%   6.8    0s
H  608    54                    -102011.2249 -102234.51  0.22%   6.8    0s

Cutting planes:
  Gomory: 31
  Implied bound: 1
  MIR: 213
  Flow cover: 1
  RLT: 6
  BQP: 1

Explored 1084 nodes (7078 simplex iterations) in 0.27 seconds (0.09 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -102011 -102004 -102003 ... 1.1503e+13
No other solutions better than -102011

Optimal solution found (tolerance 1.00e-04)
Best objective -1.020112249089e+05, best bound -1.020112249089e+05, gap 0.0000%
  Subproblem solved in 0.29s
  Worst-case operational profit (Z_SP) = 141490.28
  Scenario: 47 demand increases, 13 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -102011.22
  [DEBUG]   S×d_nominal = 243501.50
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 243501.50 + -102011.22 = 141490.28
  [DEBUG]   Current θ from Master = 146234.97
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4744.69 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -1363.87
  Lower Bound (LB) = 984.62
  Gap (UB-LB) = 2396.1932, Absolute Gap = 2396.1932, Relative Gap = 0.708761
  Not converged yet (gap = 2396.19 > ε = 200)

  [DEBUG] Adding NEW scenario 13 to Master Problem...
  [DEBUG] New scenario pattern: 47 increases, 13 decreases
    [DEBUG] Scenario 13 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 13 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 13]
    [DEBUG]   - Total constraints in model: 215443
    [DEBUG]   - Total variables in model: 89620
  [DEBUG] Total scenarios in Master: 14
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 14
================================================================================
[Iteration 14] Solving Master Problem...
  Current scenarios in Master: 14
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 215443 rows, 89620 columns and 610753 nonzeros
Model fingerprint: 0xff9f0c26
Variable types: 87361 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 98980 rows and 40180 columns
Presolve time: 4.00s
Presolved: 116463 rows, 49440 columns, 702355 nonzeros
Variable types: 47181 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -372912.9578
Found heuristic solution: objective -210461.3866

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.28s

Barrier statistics:
 Dense cols : 578
 AA' NZ     : 4.915e+06
 Factor NZ  : 1.154e+07 (roughly 160 MB of memory)
 Factor Ops : 2.323e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.82692826e+07  1.93226356e+08  1.03e+05 1.92e+01  7.98e+04     6s
   1  -1.40064140e+07  1.74978852e+08  7.19e+04 6.14e+01  5.52e+04     6s
   2  -6.72883796e+06  1.36500210e+08  3.42e+04 6.43e-01  2.75e+04     6s
   3  -1.26459248e+06  1.09029193e+08  3.34e+03 1.55e+00  3.08e+03     7s
   4  -5.94068252e+05  4.07824120e+07  5.69e+02 2.27e-01  5.85e+02     7s
   5  -4.63612933e+05  2.54328082e+07  2.77e+02 1.06e-01  2.96e+02     7s
   6  -3.35502544e+05  1.94588754e+07  9.95e+01 7.18e-02  1.52e+02     7s
   7  -2.39582231e+05  1.45520104e+07  5.28e+01 5.00e-02  9.67e+01     7s
   8  -1.33859319e+05  9.79862033e+06  1.75e+01 3.05e-02  5.38e+01     8s
   9  -1.09897769e+05  6.90700257e+06  1.25e+01 2.03e-02  3.68e+01     8s
  10  -8.30152823e+04  3.65762884e+06  4.97e+00 1.01e-02  1.85e+01     8s
  11  -4.50566473e+04  5.27237560e+05  9.16e-01 1.20e-03  2.72e+00     8s
  12  -2.53457058e+04  2.93413394e+05  6.28e-01 1.42e-03  1.51e+00     9s
  13  -1.75564323e+04  1.90699698e+05  4.97e-01 1.43e-03  9.86e-01     9s
  14  -9.91060997e+03  1.24476339e+05  3.85e-01 8.54e-04  6.35e-01     9s
  15  -4.32634832e+03  1.07981771e+05  3.24e-01 1.64e-03  5.30e-01     9s
  16   4.04800924e+03  8.09405148e+04  2.41e-01 1.47e-03  3.63e-01     9s
  17   8.88078901e+03  6.80273725e+04  2.04e-01 2.09e-03  2.79e-01    10s
  18   1.46349437e+04  5.89691338e+04  1.58e-01 1.99e-03  2.09e-01    10s
  19   1.59220234e+04  5.47365600e+04  1.48e-01 2.00e-03  1.83e-01    10s
  20   1.92010111e+04  5.12228540e+04  1.24e-01 1.61e-03  1.51e-01    10s
  21   2.07781775e+04  4.61405420e+04  1.12e-01 1.83e-03  1.20e-01    10s
  22   2.38740047e+04  4.44409879e+04  8.97e-02 1.67e-03  9.70e-02    11s
  23   2.58110742e+04  4.25631371e+04  7.63e-02 1.67e-03  7.90e-02    11s
  24   2.79912514e+04  4.14411466e+04  6.08e-02 1.51e-03  6.35e-02    11s
  25   2.91309288e+04  4.02371129e+04  5.27e-02 1.34e-03  5.24e-02    11s
  26   3.02148533e+04  3.96985107e+04  4.54e-02 1.47e-03  4.47e-02    11s
  27   3.16423882e+04  3.90644387e+04  3.59e-02 2.35e-03  3.50e-02    12s
  28   3.29951233e+04  3.87034342e+04  2.72e-02 2.13e-03  2.69e-02    12s
  29   3.41054225e+04  3.85487180e+04  2.02e-02 2.12e-03  2.10e-02    12s
  30   3.46261873e+04  3.83841456e+04  1.69e-02 2.04e-03  1.77e-02    12s
  31   3.48143923e+04  3.82518780e+04  1.57e-02 1.96e-03  1.62e-02    13s
  32   3.51835546e+04  3.82074897e+04  1.33e-02 1.85e-03  1.43e-02    13s
  33   3.54797659e+04  3.79382861e+04  1.14e-02 1.42e-03  1.16e-02    13s
  34   3.56649020e+04  3.78696074e+04  1.02e-02 1.28e-03  1.04e-02    13s
  35   3.60029115e+04  3.77959183e+04  8.01e-03 1.12e-03  8.45e-03    14s
  36   3.62198790e+04  3.76828243e+04  6.55e-03 8.87e-04  6.90e-03    14s
  37   3.64185422e+04  3.76381781e+04  5.35e-03 7.86e-04  5.75e-03    14s
  38   3.66002621e+04  3.75644241e+04  4.25e-03 5.98e-04  4.55e-03    14s
  39   3.68383903e+04  3.75169131e+04  2.81e-03 4.82e-04  3.20e-03    14s
  40   3.68654377e+04  3.74975709e+04  2.64e-03 4.40e-04  2.98e-03    15s
  41   3.69745680e+04  3.74666988e+04  1.97e-03 3.75e-04  2.32e-03    15s
  42   3.70016361e+04  3.74488433e+04  1.80e-03 3.36e-04  2.11e-03    15s
  43   3.70401248e+04  3.74264875e+04  1.57e-03 2.83e-04  1.82e-03    15s
  44   3.70624087e+04  3.74110267e+04  1.44e-03 2.44e-04  1.64e-03    16s
  45   3.70733342e+04  3.73744165e+04  1.37e-03 1.47e-04  1.42e-03    16s
  46   3.71822636e+04  3.73617274e+04  7.42e-04 1.14e-04  8.46e-04    16s
  47   3.72093545e+04  3.73461378e+04  5.81e-04 7.66e-05  6.45e-04    16s
  48   3.72563975e+04  3.73417902e+04  3.15e-04 6.59e-05  4.02e-04    17s
  49   3.72723953e+04  3.73340249e+04  2.20e-04 4.81e-05  2.90e-04    17s
  50   3.72776532e+04  3.73282871e+04  1.89e-04 3.57e-05  2.39e-04    17s
  51   3.72883600e+04  3.73237376e+04  1.28e-04 2.54e-05  1.67e-04    17s
  52   3.72993430e+04  3.73186946e+04  6.58e-05 1.46e-05  9.11e-05    17s
  53   3.73095395e+04  3.73139131e+04  1.01e-05 3.99e-06  2.06e-05    18s
  54   3.73104659e+04  3.73132918e+04  5.92e-06 2.69e-06  1.33e-05    18s
  55   3.73117639e+04  3.73122510e+04  6.23e-07 5.11e-07  2.29e-06    18s
  56   3.73119532e+04  3.73119958e+04  3.48e-08 5.18e-08  2.00e-07    18s
  57   3.73119649e+04  3.73119651e+04  1.30e-09 3.14e-10  1.09e-09    19s

Barrier solved model in 57 iterations and 18.60 seconds (11.36 work units)
Optimal objective 3.73119649e+04


Root crossover log...

  100528 DPushes remaining with DInf 0.0000000e+00                19s
   42297 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                23s

    9320 PPushes remaining with PInf 5.1418701e-05                23s
    1273 PPushes remaining with PInf 4.5657172e-05                26s
       0 PPushes remaining with PInf 0.0000000e+00                27s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.1946330e+03     27s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   49151    3.7311965e+04   0.000000e+00   1.194633e+03     27s
   49430    3.7311965e+04   0.000000e+00   0.000000e+00     27s
   49430    3.7311965e+04   0.000000e+00   0.000000e+00     28s
Concurrent spin time: 0.01s

Solved with barrier

Root relaxation: objective 3.731197e+04, 49430 iterations, 22.72 seconds (14.72 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 37311.9650    0  255 -210461.39 37311.9650   118%     -   28s
H    0     0                    -136632.9668 37311.9650   127%     -   28s
H    0     0                    -136138.3757 37311.9650   127%     -   28s
H    0     0                    -133124.1799 37311.9650   128%     -   28s
H    0     0                    -131781.1166 37311.9650   128%     -   29s
H    0     0                    -131725.7490 37311.9650   128%     -   29s
H    0     0                    -130993.4150 37311.9650   128%     -   29s
H    0     0                    -45309.76974 37311.9650   182%     -   29s
H    0     0                    -12961.16660 37311.9650   388%     -   29s
H    0     0                    -4428.528285 37311.9650   943%     -   30s
H    0     0                    -3856.211991 37311.9650  1068%     -   30s
H    0     0                    -3781.094980 37311.9650  1087%     -   30s
H    0     0                    -3726.914770 37311.9650  1101%     -   30s
H    0     0                    -3659.135542 37311.9650  1120%     -   30s
H    0     0                    -1366.535202 37311.9650  2830%     -   32s
H    0     0                    -365.8963021 37311.9650      -     -   32s
H    0     0                     132.4493143 37311.9650      -     -   33s
H    0     0                     144.8901218 37311.9650      -     -   33s
H    0     0                     171.0297272 37311.9650      -     -   33s
     0     0 31888.2389    0  356  171.02973 31888.2389      -     -   69s
H    0     0                     382.4285657 31887.8102  8238%     -   70s
H    0     0                     541.0196980 31887.8102  5794%     -   70s
H    0     0                     887.5947794 31887.8102  3493%     -   70s
H    0     0                    1131.4044723 31887.8102  2718%     -   71s
H    0     0                    1247.7006500 31887.8102  2456%     -   71s
H    0     0                    1276.4178211 31887.8102  2398%     -   71s
H    0     0                    1339.0419646 31887.8102  2281%     -   71s
     0     0 31544.4052    0  339 1339.04196 31544.4052  2256%     -   88s
     0     0 31449.5899    0  338 1339.04196 31449.5899  2249%     -   93s
     0     0 31335.9880    0  328 1339.04196 31335.9880  2240%     -   97s
     0     0 31290.2533    0  344 1339.04196 31290.2533  2237%     -  105s
     0     0 31266.6027    0  343 1339.04196 31266.6027  2235%     -  108s
     0     0 31251.2258    0  342 1339.04196 31251.2258  2234%     -  110s
     0     0 31185.1709    0  340 1339.04196 31185.1709  2229%     -  111s
     0     0 31183.2472    0  340 1339.04196 31183.2472  2229%     -  112s
     0     0 31182.9221    0  332 1339.04196 31182.9221  2229%     -  113s
H    0     0                    1620.5739033 28118.1227  1635%     -  190s
     0     0 27893.6982    0  478 1620.57390 27893.6982  1621%     -  191s
     0     0 27575.7811    0  515 1620.57390 27575.7811  1602%     -  249s
     0     0 27377.7906    0  499 1620.57390 27377.7906  1589%     -  285s
H    0     0                    2004.4269336 27178.2832  1256%     -  313s
     0     0 27178.2832    0  511 2004.42693 27178.2832  1256%     -  313s
     0     0 27085.2779    0  516 2004.42693 27085.2779  1251%     -  331s
     0     0 27033.2236    0  516 2004.42693 27033.2236  1249%     -  343s
     0     0 27005.2413    0  507 2004.42693 27005.2413  1247%     -  355s
     0     0 26997.5315    0  507 2004.42693 26997.5315  1247%     -  361s
     0     0 26987.8313    0  504 2004.42693 26987.8313  1246%     -  367s
     0     0 26966.7328    0  514 2004.42693 26966.7328  1245%     -  374s
     0     0 26965.8423    0  513 2004.42693 26965.8423  1245%     -  375s
H    0     0                    2076.3141385 23789.2839  1046%     -  507s
H    0     0                    2154.2085022 23789.2839  1004%     -  507s
H    0     0                    2330.3150884 23789.2839   921%     -  507s
H    0     0                    2355.5782229 23789.2839   910%     -  507s
H    0     0                    2391.6059491 23789.2839   895%     -  507s
H    0     0                    2543.4753751 23789.2839   835%     -  507s
H    0     0                    2675.7380578 23789.2839   789%     -  507s
     0     0 23789.2839    0  448 2675.73806 23789.2839   789%     -  507s
H    0     0                    2686.6720327 23789.2750   785%     -  509s
     0     0 23033.8751    0  532 2686.67203 23033.8751   757%     -  576s
H    0     0                    2713.5659499 22727.2370   738%     -  605s
     0     0 22727.2370    0  580 2713.56595 22727.2370   738%     -  605s
     0     0 22524.1538    0  533 2713.56595 22524.1538   730%     -  637s
     0     0 22393.3298    0  501 2713.56595 22393.3298   725%     -  657s
     0     0 22356.8802    0  464 2713.56595 22356.8802   724%     -  669s
     0     0 22327.4517    0  453 2713.56595 22327.4517   723%     -  681s
H    0     0                    2733.3857131 22243.8097   714%     -  697s
H    0     0                    2806.9751150 22243.8097   692%     -  697s
     0     0 22243.8097    0  502 2806.97512 22243.8097   692%     -  697s
     0     0 22190.9246    0  442 2806.97512 22190.9246   691%     -  710s
     0     0 22176.6527    0  516 2806.97512 22176.6527   690%     -  718s
     0     0 22147.6193    0  464 2806.97512 22147.6193   689%     -  731s
     0     0 22141.8439    0  465 2806.97512 22141.8439   689%     -  735s
     0     0 22140.5929    0  463 2806.97512 22140.5929   689%     -  740s
H    0     0                    2831.6650256 20907.4421   638%     -  837s
H    0     0                    2860.1492495 20907.4421   631%     -  837s
     0     0 20907.4421    0  509 2860.14925 20907.4421   631%     -  837s
H    0     0                    2916.3372998 20532.8139   604%     -  884s
H    0     0                    3101.4939502 20532.8139   562%     -  884s
     0     0 20532.8139    0  420 3101.49395 20532.8139   562%     -  884s
     0     0 20346.3601    0  436 3101.49395 20346.3601   556%     -  908s
     0     0 20291.4543    0  508 3101.49395 20291.4543   554%     -  924s
     0     0 20237.3560    0  453 3101.49395 20237.3560   553%     -  935s
     0     0 20213.0092    0  456 3101.49395 20213.0092   552%     -  945s
     0     0 20201.2278    0  399 3101.49395 20201.2278   551%     -  952s
     0     0 20194.3011    0  504 3101.49395 20194.3011   551%     -  958s
     0     0 20191.4284    0  401 3101.49395 20191.4284   551%     -  962s
     0     0 20186.8293    0  398 3101.49395 20186.8293   551%     -  967s
     0     0 20185.9402    0  405 3101.49395 20185.9402   551%     -  969s
     0     0 19854.4423    0  538 3101.49395 19854.4423   540%     - 1007s
     0     0 19746.0788    0  516 3101.49395 19746.0788   537%     - 1033s
     0     0 19564.1723    0  626 3101.49395 19564.1723   531%     - 1071s
     0     0 19521.2771    0  610 3101.49395 19521.2771   529%     - 1092s
     0     0 19500.5154    0  539 3101.49395 19500.5154   529%     - 1110s
     0     0 19482.2436    0  538 3101.49395 19482.2436   528%     - 1121s
H    0     0                    3108.9940584 19455.2743   526%     - 1140s
     0     0 19455.2743    0  535 3108.99406 19455.2743   526%     - 1140s
     0     0 19437.2132    0  561 3108.99406 19437.2132   525%     - 1153s
     0     0 19432.3612    0  565 3108.99406 19432.3612   525%     - 1161s
H    0     0                    3190.6804438 19428.3928   509%     - 1167s
     0     0 19428.3928    0  559 3190.68044 19428.3928   509%     - 1167s
     0     0 19426.2845    0  564 3190.68044 19426.2845   509%     - 1173s
     0     0 19245.6312    0  421 3190.68044 19245.6312   503%     - 1229s
     0     0 19170.9050    0  508 3190.68044 19170.9050   501%     - 1253s
     0     0 19138.2182    0  503 3190.68044 19138.2182   500%     - 1272s
     0     0 19101.6514    0  496 3190.68044 19101.6514   499%     - 1288s
     0     0 19084.4236    0  511 3190.68044 19084.4236   498%     - 1302s
     0     0 19073.2087    0  497 3190.68044 19073.2087   498%     - 1311s
     0     0 19071.5862    0  506 3190.68044 19071.5862   498%     - 1315s
     0     0 18920.5528    0  488 3190.68044 18920.5528   493%     - 1356s
     0     0 18890.9380    0  607 3190.68044 18890.9380   492%     - 1387s
     0     0 18876.5714    0  642 3190.68044 18876.5714   492%     - 1400s
     0     0 18869.7212    0  624 3190.68044 18869.7212   491%     - 1411s
     0     0 18863.4218    0  626 3190.68044 18863.4218   491%     - 1420s
     0     0 18851.6878    0  571 3190.68044 18851.6878   491%     - 1430s
     0     0 18843.2815    0  627 3190.68044 18843.2815   491%     - 1440s
     0     0 18837.8386    0  629 3190.68044 18837.8386   490%     - 1450s
     0     0 18836.8175    0  637 3190.68044 18836.8175   490%     - 1454s
     0     0 18765.6970    0  616 3190.68044 18765.6970   488%     - 1490s
H    0     0                    3199.7769314 18765.1948   486%     - 1492s
H    0     0                    3232.8002932 18765.1948   480%     - 1492s
H    0     0                    3354.2344087 18765.1948   459%     - 1492s
H    0     0                    3389.5846593 18765.1948   454%     - 1492s
     0     0 18739.5022    0  601 3389.58466 18739.5022   453%     - 1516s
     0     0 18696.9443    0  620 3389.58466 18696.9443   452%     - 1532s
     0     0 18686.3058    0  617 3389.58466 18686.3058   451%     - 1541s
     0     0 18681.8331    0  637 3389.58466 18681.8331   451%     - 1548s
     0     0 18665.3474    0  615 3389.58466 18665.3474   451%     - 1560s
     0     0 18659.6252    0  604 3389.58466 18659.6252   450%     - 1566s
     0     0 18655.1248    0  621 3389.58466 18655.1248   450%     - 1570s
     0     0 18651.2969    0  618 3389.58466 18651.2969   450%     - 1573s
     0     0 18649.9827    0  631 3389.58466 18649.9827   450%     - 1577s
     0     0 18598.7834    0  481 3389.58466 18598.7834   449%     - 1592s
     0     0 18587.5537    0  588 3389.58466 18587.5537   448%     - 1604s
     0     0 18585.0539    0  495 3389.58466 18585.0539   448%     - 1610s
     0     0 18507.2408    0  603 3389.58466 18507.2408   446%     - 1632s
H    0     0                    3463.5758534 18507.1650   434%     - 1633s
H    0     0                    3467.8741422 18507.1650   434%     - 1633s
     0     0 18487.9053    0  505 3467.87414 18487.9053   433%     - 1645s
     0     0 18482.5242    0  504 3467.87414 18482.5242   433%     - 1650s
     0     0 18478.1883    0  557 3467.87414 18478.1883   433%     - 1658s
     0     0 18475.9064    0  565 3467.87414 18475.9064   433%     - 1662s
     0     0 18423.1458    0  501 3467.87414 18423.1458   431%     - 1681s
H    0     0                    3509.0149485 18422.1777   425%     - 1682s
     0     0 18410.2708    0  506 3509.01495 18410.2708   425%     - 1693s
     0     0 18405.8408    0  504 3509.01495 18405.8408   425%     - 1701s
     0     0 18401.5628    0  520 3509.01495 18401.5628   424%     - 1706s
     0     0 18399.7061    0  520 3509.01495 18399.7061   424%     - 1710s
     0     0 18385.3394    0  549 3509.01495 18385.3394   424%     - 1723s
     0     0 18376.3102    0  519 3509.01495 18376.3102   424%     - 1734s
     0     0 18373.1207    0  560 3509.01495 18373.1207   424%     - 1741s
     0     0 18363.8616    0  507 3509.01495 18363.8616   423%     - 1751s
     0     0 18356.2243    0  568 3509.01495 18356.2243   423%     - 1760s
     0     0 18353.6952    0  520 3509.01495 18353.6952   423%     - 1764s
     0     0 18346.2184    0  573 3509.01495 18346.2184   423%     - 1774s
     0     0 18346.1726    0  573 3509.01495 18346.1726   423%     - 1778s
H    0     0                    3548.2774133 18346.1559   417%     - 2064s
     0     2 18346.1559    0  573 3548.27741 18346.1559   417%     - 2068s
     1     3 18115.1141    1  557 3548.27741 18346.1559   417% 17856 2094s
     2     4 18320.6110    1  556 3548.27741 18320.6110   416% 10816 2109s
     3     6 18290.1446    2  502 3548.27741 18320.5761   416%  8715 2131s
     5     9 18150.1249    3  488 3548.27741 18320.5761   416% 10414 2177s
     8    14 18051.3633    4  499 3548.27741 18290.0612   415% 11932 2231s
    13    27 17486.4802    5  492 3548.27741 18150.0124   412% 14219 2313s
    26    40 15510.7832    5  306 3548.27741 17741.2295   400% 23397 2643s
    39    71 16597.2519    5  554 3548.27741 17741.2295   400% 22725 2873s
    70   145 16555.6741    6  543 3548.27741 17741.2295   400% 23303 3070s
   144   219 16501.9159    8  535 3548.27741 17741.2295   400% 17133 3228s
H  146   219                    3579.9211321 17741.2295   396% 16925 3228s
   218   302 12323.8276   12  215 3579.92113 17741.2295   396% 13435 3339s
   301   389 14194.9154    9  307 3579.92113 17741.2295   396% 11005 3428s
   388   477 9214.58805   17  223 3579.92113 17741.2295   396%  9382 3497s
   478   505 8939.03075   22  188 3579.92113 17741.2295   396%  8324 3549s
   508   540 14430.5211    8  293 3579.92113 17741.2295   396%  8140 3600s

Cutting planes:
  Gomory: 16
  Implied bound: 244
  MIR: 3797
  Flow cover: 3684
  RLT: 163
  Relax-and-lift: 1508

Explored 547 nodes (5511114 simplex iterations) in 3600.26 seconds (5714.56 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 3579.92 3548.28 3509.01 ... 3190.68

Time limit reached
Best objective 3.579921132064e+03, best bound 1.774122951722e+04, gap 395.5760%
  WARNING: Time limit reached. Using best solution found (gap: 395.58%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.28s
  Master Objective (UB) = 3579.92, θ = 145619.54
  Upper Bound (UB) = 3579.92

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 145619.54
  [DEBUG]   ✓ Scenario 0: θ = 145619.54 ≤ Q = 145619.54 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 145619.54 ≤ Q = 145619.54 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 145619.54 ≤ Q = 145619.54 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 145619.54 ≤ Q = 145619.54 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 145619.54 ≤ Q = 145619.54 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 145619.54 ≤ Q = 145619.54 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 145619.54 ≤ Q = 145619.54 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 145619.54 ≤ Q = 145619.54 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 145619.54 ≤ Q = 145619.54 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 145619.54 ≤ Q = 145619.54 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 145619.54 ≤ Q = 145619.54 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 145619.54 ≤ Q = 145619.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 145619.54 ≤ Q = 145619.54 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 145619.54 ≤ Q = 145619.54 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 14] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0xb2babd2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xf4d4542e
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [5e-01, 2e+02]
Found heuristic solution: objective 1.152348e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.00s
Presolved: 494 rows, 498 columns, 1393 nonzeros
Found heuristic solution: objective 5748145.4437
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.272951e+05, 244 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -127295.06    0  122 5748145.44 -127295.06   102%     -    0s
H    0     0                    -95140.54855 -127295.06  33.8%     -    0s
H    0     0                    -95946.87420 -127295.06  32.7%     -    0s
     0     0 -99339.318    0  108 -95946.874 -99339.318  3.54%     -    0s
H    0     0                    -96979.32749 -99328.475  2.42%     -    0s
H    0     0                    -96979.42822 -99328.475  2.42%     -    0s
     0     0 -98831.182    0   88 -96979.428 -98831.182  1.91%     -    0s
H    0     0                    -97274.76635 -98825.312  1.59%     -    0s
H    0     0                    -97274.86708 -98825.312  1.59%     -    0s
     0     0 -98689.976    0   91 -97274.867 -98689.976  1.45%     -    0s
H    0     0                    -97621.91506 -98689.976  1.09%     -    0s
     0     0 -98688.628    0   91 -97621.915 -98688.628  1.09%     -    0s
     0     2 -98685.807    0   91 -97621.915 -98685.807  1.09%     -    0s
H   28    22                    -98023.74139 -98558.753  0.55%  13.3    0s
H  127    54                    -98099.68217 -98476.570  0.38%   7.9    0s
H  427   132                    -98303.14240 -98346.679  0.04%   5.3    0s
H  433   132                    -98314.48440 -98346.679  0.03%   5.3    0s
H  452   132                    -98318.84047 -98346.679  0.03%   5.3    0s

Cutting planes:
  Gomory: 31
  MIR: 159
  RLT: 1

Explored 661 nodes (3491 simplex iterations) in 0.23 seconds (0.10 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -98318.8 -98314.5 -98303.1 ... -96979.3
No other solutions better than -98318.8

Optimal solution found (tolerance 1.00e-04)
Best objective -9.831884047030e+04, best bound -9.831884047030e+04, gap 0.0000%
  Subproblem solved in 0.25s
  Worst-case operational profit (Z_SP) = 145167.23
  Scenario: 11 demand increases, 49 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -98318.84
  [DEBUG]   S×d_nominal = 243486.07
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 243486.07 + -98318.84 = 145167.23
  [DEBUG]   Current θ from Master = 145619.54
  [DEBUG]   ⚠️  Z_SP ≤ θ by 452.31 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 3127.61
  Lower Bound (LB) = 3127.61
  Gap (UB-LB) = 452.3149, Absolute Gap = 452.3149, Relative Gap = 0.126348
  Not converged yet (gap = 452.31 > ε = 200)

  [DEBUG] Adding NEW scenario 14 to Master Problem...
  [DEBUG] New scenario pattern: 11 increases, 49 decreases
    [DEBUG] Scenario 14 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 14 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 14]
    [DEBUG]   - Total constraints in model: 230733
    [DEBUG]   - Total variables in model: 95860
  [DEBUG] Total scenarios in Master: 15
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 15
================================================================================
[Iteration 15] Solving Master Problem...
  Current scenarios in Master: 15
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 230733 rows, 95860 columns and 653984 nonzeros
Model fingerprint: 0x13bc1050
Variable types: 93601 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 106050 rows and 43050 columns
Presolve time: 3.95s
Presolved: 124683 rows, 52810 columns, 767515 nonzeros
Variable types: 50551 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -363238.5703
Found heuristic solution: objective -210461.3866

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.33s

Barrier statistics:
 Dense cols : 600
 AA' NZ     : 6.083e+06
 Factor NZ  : 1.353e+07 (roughly 180 MB of memory)
 Factor Ops : 2.936e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.88885725e+07  2.03845879e+08  1.08e+05 1.95e+01  8.21e+04     6s
   1  -1.45601611e+07  1.84732297e+08  7.71e+04 5.89e+01  5.82e+04     6s
   2  -4.65154633e+06  1.46688911e+08  2.40e+04 6.12e-01  1.92e+04     6s
   3  -1.37223113e+06  1.21482980e+08  3.54e+03 4.71e+00  3.23e+03     7s
   4  -7.17555812e+05  6.87689529e+07  5.02e+02 1.67e+00  6.59e+02     7s
   5  -5.53524052e+05  3.89561235e+07  3.55e+02 5.07e-01  4.00e+02     7s
   6  -4.63275091e+05  3.01558522e+07  1.32e+02 4.23e-02  2.14e+02     7s
   7  -3.57060895e+05  2.15465260e+07  5.74e+01 2.84e-02  1.27e+02     8s
   8  -2.11082285e+05  1.35200727e+07  1.27e+01 1.62e-02  6.56e+01     8s
   9  -1.60239493e+05  1.05954936e+07  7.81e+00 1.25e-02  4.99e+01     8s
  10  -1.33986988e+05  5.06559556e+06  5.12e+00 5.74e-03  2.38e+01     8s
  11  -1.02459842e+05  1.25681687e+06  2.14e+00 9.42e-03  6.10e+00     9s
  12  -7.57974351e+04  6.00165767e+05  1.22e+00 7.56e-04  3.01e+00     9s
  13  -4.87670020e+04  4.22735766e+05  6.72e-01 4.36e-04  2.09e+00     9s
  14  -3.80708725e+04  2.77110024e+05  5.05e-01 2.74e-04  1.39e+00     9s
  15  -2.10513274e+04  1.82368282e+05  3.45e-01 2.64e-04  8.99e-01     9s
  16  -8.35625246e+03  1.30045858e+05  2.56e-01 5.01e-04  6.11e-01    10s
  17  -4.06593257e+02  1.03337175e+05  1.93e-01 1.13e-03  4.58e-01    10s
  18   5.10242997e+03  7.85913059e+04  1.56e-01 1.26e-03  3.25e-01    10s
  19   9.97330006e+03  6.69723796e+04  1.26e-01 1.67e-03  2.52e-01    10s
  20   1.31350260e+04  5.69083577e+04  1.08e-01 3.13e-03  1.93e-01    10s
  21   1.56525964e+04  5.36260291e+04  9.24e-02 2.83e-03  1.68e-01    11s
  22   1.94278002e+04  4.89234714e+04  7.22e-02 3.42e-03  1.30e-01    11s
  23   2.22170117e+04  4.52983851e+04  5.80e-02 2.88e-03  1.02e-01    11s
  24   2.39396830e+04  4.36359173e+04  4.95e-02 2.99e-03  8.70e-02    11s
  25   2.60135028e+04  4.07781895e+04  3.94e-02 2.04e-03  6.53e-02    12s
  26   2.72472836e+04  4.00806869e+04  3.38e-02 2.35e-03  5.67e-02    12s
  27   2.78058447e+04  3.89815451e+04  3.12e-02 2.82e-03  4.94e-02    12s
  28   2.87751531e+04  3.81342987e+04  2.65e-02 2.21e-03  4.14e-02    12s
  29   2.94513638e+04  3.75381339e+04  2.34e-02 1.82e-03  3.58e-02    12s
  30   3.03152585e+04  3.72647816e+04  1.94e-02 1.65e-03  3.07e-02    13s
  31   3.17993184e+04  3.66979371e+04  1.29e-02 1.24e-03  2.16e-02    13s
  32   3.25288023e+04  3.64283752e+04  9.73e-03 1.06e-03  1.72e-02    13s
  33   3.29334236e+04  3.59160451e+04  7.92e-03 7.08e-04  1.32e-02    13s
  34   3.36745496e+04  3.56988669e+04  4.77e-03 5.56e-04  8.94e-03    14s
  35   3.40191394e+04  3.54741346e+04  3.38e-03 3.92e-04  6.43e-03    14s
  36   3.41336801e+04  3.53261066e+04  2.92e-03 2.92e-04  5.27e-03    14s
  37   3.42922801e+04  3.51360123e+04  2.31e-03 1.60e-04  3.73e-03    14s
  38   3.45795059e+04  3.50532083e+04  1.20e-03 9.99e-05  2.09e-03    15s
  39   3.47036250e+04  3.50221787e+04  7.39e-04 7.66e-05  1.41e-03    15s
  40   3.47431110e+04  3.49905179e+04  5.91e-04 5.50e-05  1.09e-03    15s
  41   3.47778626e+04  3.49789535e+04  4.63e-04 4.71e-05  8.88e-04    15s
  42   3.47844991e+04  3.49518009e+04  4.38e-04 2.70e-05  7.39e-04    15s
  43   3.48447593e+04  3.49189516e+04  2.19e-04 7.12e-05  3.28e-04    16s
  44   3.48536920e+04  3.49146253e+04  1.88e-04 3.57e-05  2.70e-04    16s
  45   3.48552746e+04  3.49140314e+04  1.82e-04 3.08e-05  2.60e-04    16s
  46   3.48871442e+04  3.49128237e+04  7.45e-05 1.86e-05  1.14e-04    16s
  47   3.49096443e+04  3.49108220e+04  2.61e-06 4.03e-06  5.20e-06    17s
  48   3.49104722e+04  3.49104737e+04  2.44e-09 3.38e-08  6.58e-09    17s
  49   3.49104731e+04  3.49104731e+04  1.84e-09 4.42e-11  6.72e-11    17s

Barrier solved model in 49 iterations and 17.11 seconds (11.34 work units)
Optimal objective 3.49104731e+04


Root crossover log...

  112549 DPushes remaining with DInf 0.0000000e+00                17s
   13979 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                22s

    1450 PPushes remaining with PInf 5.1829161e-06                22s
       0 PPushes remaining with PInf 0.0000000e+00                22s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.7022825e-10     22s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   52813    3.4910473e+04   0.000000e+00   0.000000e+00     22s
   52813    3.4910473e+04   0.000000e+00   0.000000e+00     22s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 3.491047e+04, 52813 iterations, 17.23 seconds (14.04 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 34910.4731    0  155 -210461.39 34910.4731   117%     -   22s
H    0     0                    -114992.9581 34910.4731   130%     -   23s
H    0     0                    -94130.37581 34910.4731   137%     -   23s
H    0     0                    -88886.57421 34910.4731   139%     -   23s
H    0     0                    -88596.31825 34910.4731   139%     -   23s
H    0     0                    -50613.66430 34910.4731   169%     -   23s
H    0     0                    -4629.692851 34910.4731   854%     -   23s
H    0     0                    -2230.127048 34910.4731  1665%     -   23s
H    0     0                    -1071.737952 34910.4731  3357%     -   24s
H    0     0                    -385.4334490 34910.4731  9157%     -   25s
H    0     0                    -355.3337748 34910.4731  9925%     -   25s
H    0     0                    -278.6708477 34910.4731      -     -   28s
H    0     0                     306.5897047 34910.4731      -     -   28s
H    0     0                     756.8185825 34910.4731  4513%     -   28s
H    0     0                     767.1421502 29623.4718  3762%     -   73s
H    0     0                     901.4879796 29623.4718  3186%     -   73s
H    0     0                     905.9499044 29623.4718  3170%     -   73s
H    0     0                     949.3851347 29623.4718  3020%     -   73s
     0     0 29623.4718    0  315  949.38513 29623.4718  3020%     -   74s
H    0     0                    1253.3172237 29623.4626  2264%     -   75s
H    0     0                    1267.5857330 29623.4626  2237%     -   75s
     0     0 29445.1032    0  323 1267.58573 29445.1032  2223%     -   98s
     0     0 29252.2902    0  318 1267.58573 29252.2902  2208%     -  108s
     0     0 29231.6425    0  318 1267.58573 29231.6425  2206%     -  114s
     0     0 29210.7754    0  321 1267.58573 29210.7754  2204%     -  115s
     0     0 29210.7754    0  321 1267.58573 29210.7754  2204%     -  117s
     0     0 29210.7754    0  321 1267.58573 29210.7754  2204%     -  117s
     0     0 25401.4704    0  228 1267.58573 25401.4704  1904%     -  172s
H    0     0                    1267.8101542 25401.4704  1904%     -  173s
H    0     0                    1272.7760146 25401.4704  1896%     -  173s
H    0     0                    1394.8659812 25401.4704  1721%     -  173s
     0     0 24791.5794    0  366 1394.86598 24791.5794  1677%     -  215s
     0     0 24288.3871    0  300 1394.86598 24288.3871  1641%     -  235s
     0     0 24149.8227    0  389 1394.86598 24149.8227  1631%     -  250s
     0     0 24129.9391    0  377 1394.86598 24129.9391  1630%     -  255s
     0     0 24120.0355    0  380 1394.86598 24120.0355  1629%     -  258s
     0     0 24074.3439    0  308 1394.86598 24074.3439  1626%     -  262s
     0     0 24062.9613    0  326 1394.86598 24062.9613  1625%     -  266s
     0     0 24060.7953    0  324 1394.86598 24060.7953  1625%     -  268s
     0     0 24048.3862    0  323 1394.86598 24048.3862  1624%     -  271s
     0     0 23939.1408    0  374 1394.86598 23939.1408  1616%     -  283s
     0     0 23931.2346    0  381 1394.86598 23931.2346  1616%     -  288s
     0     0 23920.2341    0  392 1394.86598 23920.2341  1615%     -  291s
     0     0 23918.8104    0  387 1394.86598 23918.8104  1615%     -  292s
     0     0 23916.2121    0  394 1394.86598 23916.2121  1615%     -  294s
     0     0 23866.6858    0  325 1394.86598 23866.6858  1611%     -  301s
H    0     0                    1714.2222270 23864.3252  1292%     -  302s
H    0     0                    1761.2064428 23864.3252  1255%     -  302s
H    0     0                    1880.9261780 23864.3252  1169%     -  302s
H    0     0                    2025.7393076 23864.3252  1078%     -  302s
     0     0 23864.3252    0  340 2025.73931 23864.3252  1078%     -  302s
     0     0 23862.2303    0  333 2025.73931 23862.2303  1078%     -  303s
     0     0 23862.1294    0  331 2025.73931 23862.1294  1078%     -  304s
     0     0 21595.5546    0  409 2025.73931 21595.5546   966%     -  377s
H    0     0                    2331.0831152 21595.5220   826%     -  379s
H    0     0                    2373.8741078 21595.5220   810%     -  379s
H    0     0                    2444.7119937 20977.7747   758%     -  408s
H    0     0                    2488.5022198 20977.7747   743%     -  408s
     0     0 20977.7747    0  432 2488.50222 20977.7747   743%     -  408s
     0     0 20751.8247    0  441 2488.50222 20751.8247   734%     -  430s
     0     0 20697.4533    0  446 2488.50222 20697.4533   732%     -  441s
     0     0 20635.4623    0  448 2488.50222 20635.4623   729%     -  454s
     0     0 20437.9062    0  439 2488.50222 20437.9062   721%     -  479s
     0     0 20384.7536    0  451 2488.50222 20384.7536   719%     -  493s
     0     0 20360.2807    0  452 2488.50222 20360.2807   718%     -  501s
     0     0 20355.9603    0  462 2488.50222 20355.9603   718%     -  503s
H    0     0                    2506.4126055 20352.6353   712%     -  507s
H    0     0                    2584.8454128 20352.6353   687%     -  507s
     0     0 20352.6353    0  449 2584.84541 20352.6353   687%     -  507s
     0     0 20327.7498    0  462 2584.84541 20327.7498   686%     -  514s
     0     0 20320.3906    0  462 2584.84541 20320.3906   686%     -  517s
     0     0 20312.1445    0  458 2584.84541 20312.1445   686%     -  520s
     0     0 20304.8232    0  461 2584.84541 20304.8232   686%     -  523s
     0     0 20302.5660    0  460 2584.84541 20302.5660   685%     -  527s
     0     0 20302.2691    0  461 2584.84541 20302.2691   685%     -  528s
H    0     0                    2690.6605373 20302.2691   655%     -  554s
     0     0 19071.0709    0  472 2690.66054 19071.0709   609%     -  617s
H    0     0                    2912.8117531 18834.3990   547%     -  655s
H    0     0                    2913.5235899 18834.3990   546%     -  655s
     0     0 18834.3990    0  484 2913.52359 18834.3990   546%     -  655s
H    0     0                    2938.2654369 18771.9437   539%     -  673s
H    0     0                    3142.9253874 18771.9437   497%     -  673s
     0     0 18771.9437    0  507 3142.92539 18771.9437   497%     -  673s
     0     0 18670.1777    0  490 3142.92539 18670.1777   494%     -  691s
     0     0 18644.5067    0  503 3142.92539 18644.5067   493%     -  700s
     0     0 18638.5897    0  500 3142.92539 18638.5897   493%     -  705s
     0     0 18635.8939    0  425 3142.92539 18635.8939   493%     -  709s
     0     0 18625.8930    0  429 3142.92539 18625.8930   493%     -  712s
     0     0 18621.6887    0  515 3142.92539 18621.6887   492%     -  715s
     0     0 18615.4007    0  497 3142.92539 18615.4007   492%     -  718s
     0     0 18608.4405    0  513 3142.92539 18608.4405   492%     -  722s
     0     0 18607.2804    0  508 3142.92539 18607.2804   492%     -  723s
     0     0 18411.8038    0  414 3142.92539 18411.8038   486%     -  745s
H    0     0                    3189.6624923 18411.5404   477%     -  746s
     0     0 18369.6569    0  436 3189.66249 18369.6569   476%     -  760s
     0     0 18354.6439    0  517 3189.66249 18354.6439   475%     -  765s
H    0     0                    3206.9372448 18348.6848   472%     -  770s
     0     0 18348.6848    0  423 3206.93724 18348.6848   472%     -  770s
     0     0 18346.5301    0  507 3206.93724 18346.5301   472%     -  774s
     0     0 18219.0183    0  522 3206.93724 18219.0183   468%     -  795s
H    0     0                    3289.7120278 18218.7664   454%     -  811s
     0     0 18193.5093    0  573 3289.71203 18193.5093   453%     -  822s
     0     0 18180.0071    0  524 3289.71203 18180.0071   453%     -  828s
     0     0 18169.0727    0  526 3289.71203 18169.0727   452%     -  836s
     0     0 18161.8699    0  519 3289.71203 18161.8699   452%     -  840s
     0     0 18159.8859    0  524 3289.71203 18159.8859   452%     -  843s
     0     0 18132.6236    0  525 3289.71203 18132.6236   451%     -  855s
H    0     0                    3324.3168011 18132.6005   445%     -  856s
     0     0 18119.8419    0  514 3324.31680 18119.8419   445%     -  867s
     0     0 18116.2020    0  510 3324.31680 18116.2020   445%     -  871s
     0     0 18113.5055    0  515 3324.31680 18113.5055   445%     -  874s
     0     0 18112.3653    0  518 3324.31680 18112.3653   445%     -  877s
     0     0 18097.7560    0  600 3324.31680 18097.7560   444%     -  891s
     0     0 18091.9933    0  574 3324.31680 18091.9933   444%     -  901s
     0     0 18089.4923    0  455 3324.31680 18089.4923   444%     -  904s
H    0     0                    3555.4589658 18089.4923   409%     -  906s
     0     0 18083.5639    0  517 3555.45897 18083.5639   409%     -  909s
     0     0 18078.7188    0  509 3555.45897 18078.7188   408%     -  913s
     0     0 18077.8574    0  520 3555.45897 18077.8574   408%     -  915s
     0     0 18065.2245    0  505 3555.45897 18065.2245   408%     -  922s
     0     0 18052.8606    0  510 3555.45897 18052.8606   408%     -  965s
     0     0 18051.6488    0  520 3555.45897 18051.6488   408%     -  968s
     0     0 18046.4342    0  504 3555.45897 18046.4342   408%     -  978s
     0     0 18046.3953    0  504 3555.45897 18046.3953   408%     -  982s
H    0     0                    3612.1900121 18046.3872   400%     - 1028s
H    0     0                    3766.7881900 18046.3872   379%     - 1128s
     0     2 18046.3872    0  504 3766.78819 18046.3872   379%     - 1138s
     1     3 16977.8134    1  389 3766.78819 18046.3413   379% 12910 1161s
     2     4 17880.1988    1  501 3766.78819 17880.1988   375% 12230 1182s
     3     7 16447.3021    2  532 3766.78819 17880.1956   375% 11613 1205s
     6    12 16280.2668    3  501 3766.78819 17880.1956   375% 10883 1235s
    11    22 16114.1892    3  307 3766.78819 17802.4336   373% 12316 1278s
    21    32 15813.2034    5  566 3766.78819 17520.5118   365% 14151 1367s
    31    63 16804.6225    4  523 3766.78819 17428.1928   363% 14986 1527s
H   39    63                    3790.4556731 17428.1928   360% 14218 1527s
H   42    63                    3828.0962167 17428.1928   355% 13653 1527s
    62    95 16753.0028    5  517 3828.09622 17428.1928   355% 18123 1595s
    94   219 16699.4480    6  513 3828.09622 17428.1928   355% 15568 1683s
   218   294 16495.6250    8  557 3828.09622 17428.1928   355%  9465 1744s
   293   317 16493.4122    9  511 3828.09622 17428.1928   355%  8093 1788s
   316   360 16483.6549   10  515 3828.09622 17428.1928   355%  7921 1835s
   359   387 15297.9096   14  431 3828.09622 17428.1928   355%  7579 1879s
   386   413 15279.0508   15  423 3828.09622 17428.1928   355%  7527 1918s
   416   454 16357.8831   10  443 3828.09622 17428.1928   355%  7502 1957s
   459   514 14924.8789   17  360 3828.09622 17428.1928   355%  7209 1992s
   521   583 15852.6765   11  363 3828.09622 17428.1928   355%  6970 2028s
   594   643 5236.45732   27  182 3828.09622 17428.1928   355%  6687 2072s
   667   707 15814.5399   12  358 3828.09622 17428.1928   355%  6419 2104s
   745   763 15652.7647   13  414 3828.09622 17428.1928   355%  6156 2136s
   822   823 5956.74961   18  178 3828.09622 17428.1928   355%  5935 2165s
   913   847 5333.23535   19  162 3828.09622 17428.1928   355%  5649 2195s
   952   873     cutoff   19      3828.09622 17428.1928   355%  5576 2231s
H  955   873                    3856.5804407 17428.1928   352%  5561 2231s
  1006   953 7967.88113   21  167 3856.58044 17428.1928   352%  5440 2266s
  1138  1072 7226.87035   23   84 3856.58044 17428.1928   352%  5068 2292s
  1335  1049 6604.88441   27   64 3856.58044 17428.1928   352%  4520 2333s
  1475  1042 infeasible   28      3856.58044 17428.1928   352%  4287 2382s
  1542  1064 infeasible   26      3856.58044 17428.1928   352%  4263 2434s
  1612  1133 infeasible   15      3856.58044 17428.1928   352%  4239 2476s
  1766  1159 7930.16370   17  280 3856.58044 17428.1928   352%  4009 2525s
  1906  1163 6605.13404   18  270 3856.58044 17428.1928   352%  3835 2587s
  1968  1173 3954.44858   19  262 3856.58044 17428.1928   352%  3810 2662s
  1986  1180 5354.41568   21  215 3856.58044 17428.1928   352%  3845 2723s
  2005  1196     cutoff   22      3856.58044 17428.1928   352%  3898 2788s
  2041  1198 4472.22160   23  204 3856.58044 17428.1928   352%  3961 2853s
  2050  1209 4224.58123   23  213 3856.58044 17428.1928   352%  3976 2917s
  2070  1222     cutoff   25      3856.58044 17428.1928   352%  4043 2984s
  2089  1234 14886.0106    7  302 3856.58044 17142.7557   345%  4076 3056s
  2107  1246 14867.0962    8  304 3856.58044 17142.7557   345%  4149 3126s
  2123  1259 6605.83794    9  210 3856.58044 17142.7557   345%  4203 3202s
  2146  1269 4731.62967   10  179 3856.58044 17121.9723   344%  4288 3273s
  2166  1284 4416.27949   11  178 3856.58044 16606.0999   331%  4385 3348s
  2195  1292     cutoff   12      3856.58044 15581.7080   304%  4472 3419s
  2217  1306 12013.0111   13  448 3856.58044 15581.7080   304%  4585 3494s
  2249  1321 11599.9054   14  481 3856.58044 15576.5161   304%  4650 3573s
  2270  1327 8103.57410   17  501 3856.58044 15526.2935   303%  4753 3600s

Cutting planes:
  Learned: 2
  Gomory: 13
  Implied bound: 264
  MIR: 3376
  Flow cover: 3683
  Inf proof: 1
  RLT: 92
  Relax-and-lift: 739

Explored 2280 nodes (11415757 simplex iterations) in 3600.20 seconds (4979.70 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 3856.58 3828.1 3790.46 ... 3189.66

Time limit reached
Best objective 3.856580440651e+03, best bound 1.550862843325e+04, gap 302.1342%
  WARNING: Time limit reached. Using best solution found (gap: 302.13%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.27s
  Master Objective (UB) = 3856.58, θ = 145200.46
  Upper Bound (UB) = 3856.58

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 145200.46
  [DEBUG]   ✓ Scenario 0: θ = 145200.46 ≤ Q = 145200.46 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 145200.46 ≤ Q = 145200.46 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 145200.46 ≤ Q = 145200.46 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 145200.46 ≤ Q = 145200.46 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 145200.46 ≤ Q = 145200.46 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 145200.46 ≤ Q = 145200.46 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 145200.46 ≤ Q = 145200.46 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 145200.46 ≤ Q = 145200.46 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 145200.46 ≤ Q = 145200.46 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 145200.46 ≤ Q = 145200.46 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 145200.46 ≤ Q = 145200.46 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 145200.46 ≤ Q = 145200.46 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 145200.46 ≤ Q = 145282.53 (slack: 82.07)
  [DEBUG]   ✓ Scenario 13: θ = 145200.46 ≤ Q = 145200.46 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 145200.46 ≤ Q = 145200.46 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 15] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x2b00adf3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xd4ff520d
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [5e-01, 2e+02]
Found heuristic solution: objective 1.153842e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.00s
Presolved: 494 rows, 498 columns, 1393 nonzeros
Found heuristic solution: objective 5744632.5267
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.277282e+05, 241 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -127728.17    0  122 5744632.53 -127728.17   102%     -    0s
H    0     0                    -95636.97038 -127728.17  33.6%     -    0s
H    0     0                    -96201.10863 -127728.17  32.8%     -    0s
     0     0 -101408.55    0   87 -96201.109 -101408.55  5.41%     -    0s
H    0     0                    -99698.07991 -101286.95  1.59%     -    0s
H    0     0                    -99698.18064 -101286.95  1.59%     -    0s
     0     0 -100849.17    0   83 -99698.181 -100849.17  1.15%     -    0s
H    0     0                    -99945.63474 -100838.22  0.89%     -    0s
     0     0 -100718.15    0   83 -99945.635 -100718.15  0.77%     -    0s
     0     0 -100718.15    0   83 -99945.635 -100718.15  0.77%     -    0s
     0     0 -100479.24    0   85 -99945.635 -100479.24  0.53%     -    0s
     0     0 -100447.61    0   85 -99945.635 -100447.61  0.50%     -    0s
     0     0 -100399.69    0   97 -99945.635 -100399.69  0.45%     -    0s
     0     0 -100388.48    0   86 -99945.635 -100388.48  0.44%     -    0s
     0     2 -100386.24    0   86 -99945.635 -100386.24  0.44%     -    0s
H   83    49                    -99953.69013 -100146.65  0.19%  11.8    0s
H   98    49                    -99974.47616 -100146.65  0.17%  11.0    0s
H  273    65                    -99982.26604 -100107.60  0.13%   8.1    0s
*  464    60              26    -99991.20543 -100107.60  0.12%   7.0    0s
H  578    24                    -100000.9071 -100074.26  0.07%   6.4    0s
H  627    24                    -100011.1074 -100074.26  0.06%   6.2    0s

Cutting planes:
  Gomory: 29
  Implied bound: 5
  MIR: 177
  Flow cover: 20
  RLT: 3
  BQP: 1

Explored 661 nodes (4517 simplex iterations) in 0.19 seconds (0.08 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -100011 -100001 -99991.2 ... -95637

Optimal solution found (tolerance 1.00e-04)
Best objective -1.000111074494e+05, best bound -1.000165406494e+05, gap 0.0054%
  Subproblem solved in 0.21s
  Worst-case operational profit (Z_SP) = 143452.57
  Scenario: 30 demand increases, 30 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -100011.11
  [DEBUG]   S×d_nominal = 243463.67
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 243463.67 + -100011.11 = 143452.57
  [DEBUG]   Current θ from Master = 145200.46
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1747.90 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 2108.68
  Lower Bound (LB) = 3127.61
  Gap (UB-LB) = 728.9742, Absolute Gap = 728.9742, Relative Gap = 0.189021
  Not converged yet (gap = 728.97 > ε = 200)

  [DEBUG] Adding NEW scenario 15 to Master Problem...
  [DEBUG] New scenario pattern: 30 increases, 30 decreases
    [DEBUG] Scenario 15 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 15 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 15]
    [DEBUG]   - Total constraints in model: 246023
    [DEBUG]   - Total variables in model: 102100
  [DEBUG] Total scenarios in Master: 16
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 16
================================================================================
[Iteration 16] Solving Master Problem...
  Current scenarios in Master: 16
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 246023 rows, 102100 columns and 697215 nonzeros
Model fingerprint: 0xa2e1d0ac
Variable types: 99841 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 113120 rows and 45920 columns
Presolve time: 3.38s
Presolved: 132903 rows, 56180 columns, 818738 nonzeros
Variable types: 53921 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -364542.2970
Found heuristic solution: objective -210461.3866

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.35s

Barrier statistics:
 Dense cols : 602
 AA' NZ     : 6.839e+06
 Factor NZ  : 1.484e+07 (roughly 200 MB of memory)
 Factor Ops : 3.205e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.93332084e+07  2.16039660e+08  1.11e+05 1.58e+01  8.36e+04     6s
   1  -1.49192842e+07  1.96343483e+08  7.92e+04 5.76e+01  5.93e+04     7s
   2  -4.88396606e+06  1.56381697e+08  2.53e+04 6.65e-01  2.01e+04     7s
   3  -2.86109823e+06  1.51576861e+08  1.11e+04 1.38e+01  9.14e+03     7s
   4  -8.72352078e+05  1.08263261e+08  1.20e+03 3.55e+00  1.34e+03     8s
   5  -6.01988748e+05  6.10090968e+07  5.33e+02 1.27e+00  6.11e+02     8s
   6  -4.74509704e+05  3.27529067e+07  2.09e+02 2.38e-01  2.63e+02     8s
   7  -3.69942883e+05  2.40495506e+07  7.46e+01 2.05e-02  1.42e+02     8s
   8  -2.27697341e+05  1.54266230e+07  2.02e+01 1.18e-02  7.35e+01     8s
   9  -1.76942801e+05  1.05402375e+07  1.02e+01 7.79e-03  4.76e+01     9s
  10  -1.36594847e+05  5.78526195e+06  5.54e+00 4.15e-03  2.56e+01     9s
  11  -9.65748961e+04  2.13121590e+06  1.56e+00 1.42e-03  9.32e+00     9s
  12  -6.84130692e+04  1.12694207e+06  6.86e-01 7.62e-04  4.96e+00     9s
  13  -4.60002574e+04  3.89093315e+05  3.46e-01 3.05e-04  1.80e+00     9s
  14  -2.69275536e+04  2.44654403e+05  2.11e-01 2.22e-04  1.12e+00    10s
  15  -1.46254796e+04  1.79427373e+05  1.58e-01 2.33e-04  8.02e-01    10s
  16  -7.20024054e+03  1.18444990e+05  1.29e-01 5.65e-04  5.19e-01    10s
  17  -2.95973518e+01  9.55409636e+04  1.03e-01 1.31e-03  3.95e-01    10s
  18   4.86822904e+03  8.15227655e+04  8.49e-02 2.46e-03  3.17e-01    10s
  19   1.10072036e+04  6.43456920e+04  6.47e-02 2.30e-03  2.20e-01    11s
  20   1.39900411e+04  5.72388876e+04  5.50e-02 1.94e-03  1.79e-01    11s
  21   1.58055342e+04  5.36145366e+04  4.92e-02 1.83e-03  1.56e-01    11s
  22   2.11451697e+04  5.08798489e+04  3.28e-02 1.84e-03  1.23e-01    11s
  23   2.33058035e+04  4.72305446e+04  2.70e-02 1.36e-03  9.89e-02    12s
  24   2.43167420e+04  4.46259830e+04  2.43e-02 1.10e-03  8.39e-02    12s
  25   2.53570318e+04  4.21237990e+04  2.18e-02 8.22e-04  6.93e-02    12s
  26   2.75771232e+04  4.04232978e+04  1.63e-02 6.01e-04  5.31e-02    12s
  27   2.89040829e+04  3.97540973e+04  1.30e-02 5.26e-04  4.48e-02    13s
  28   2.97292515e+04  3.86461093e+04  1.11e-02 4.17e-04  3.69e-02    13s
  29   3.05971739e+04  3.80619477e+04  9.12e-03 3.55e-04  3.09e-02    13s
  30   3.10350827e+04  3.77712649e+04  8.15e-03 3.22e-04  2.78e-02    13s
  31   3.24651554e+04  3.71416777e+04  4.98e-03 2.50e-04  1.93e-02    14s
  32   3.31427202e+04  3.65085304e+04  3.50e-03 1.96e-04  1.39e-02    14s
  33   3.32842640e+04  3.62605863e+04  3.21e-03 1.67e-04  1.23e-02    14s
  34   3.37354088e+04  3.59842442e+04  2.26e-03 1.34e-04  9.29e-03    14s
  35   3.40824928e+04  3.57223681e+04  1.58e-03 1.02e-04  6.77e-03    15s
  36   3.42401813e+04  3.55065800e+04  1.26e-03 7.41e-05  5.23e-03    15s
  37   3.42889643e+04  3.53112628e+04  1.16e-03 5.16e-05  4.22e-03    15s
  38   3.45126418e+04  3.51908058e+04  7.08e-04 3.58e-05  2.80e-03    16s
  39   3.46747111e+04  3.51189280e+04  4.08e-04 2.63e-05  1.83e-03    16s
  40   3.47680515e+04  3.49994467e+04  2.39e-04 1.13e-05  9.56e-04    16s
  41   3.48140359e+04  3.49854567e+04  1.62e-04 9.47e-06  7.08e-04    16s
  42   3.48491677e+04  3.49432422e+04  9.79e-05 4.01e-06  3.89e-04    17s
  43   3.48525086e+04  3.49316001e+04  9.21e-05 2.58e-06  3.27e-04    17s
  44   3.48831654e+04  3.49224219e+04  4.11e-05 1.45e-06  1.62e-04    17s
  45   3.48942547e+04  3.49161511e+04  2.43e-05 6.56e-07  9.05e-05    17s
  46   3.49028376e+04  3.49145296e+04  1.09e-05 4.61e-07  4.83e-05    17s
  47   3.49101462e+04  3.49105718e+04  3.47e-07 8.49e-07  1.76e-06    18s
  48   3.49102078e+04  3.49105552e+04  6.96e-07 7.07e-07  1.44e-06    18s
  49   3.49104717e+04  3.49104732e+04  4.50e-09 3.90e-09  6.20e-09    18s
  50   3.49104728e+04  3.49104731e+04  8.53e-08 1.35e-10  1.04e-09    18s

Barrier solved model in 50 iterations and 18.44 seconds (13.48 work units)
Optimal objective 3.49104728e+04


Root crossover log...

  119830 DPushes remaining with DInf 0.0000000e+00                19s
   51825 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                24s

   12461 PPushes remaining with PInf 1.3249657e-04                24s
    1975 PPushes remaining with PInf 4.4982076e-05                25s
       0 PPushes remaining with PInf 0.0000000e+00                26s

  Push phase complete: Pinf 0.0000000e+00, Dinf 4.5630345e+03     26s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   72096    3.4910473e+04   0.000000e+00   4.563035e+03     26s
   72602    3.4910473e+04   0.000000e+00   0.000000e+00     26s
   72602    3.4910473e+04   0.000000e+00   0.000000e+00     26s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 3.491047e+04, 72602 iterations, 22.24 seconds (20.03 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 34910.4731    0  155 -210461.39 34910.4731   117%     -   27s
H    0     0                    -205778.9499 34910.4731   117%     -   27s
H    0     0                    -116909.5523 34910.4731   130%     -   27s
H    0     0                    -116607.6839 34910.4731   130%     -   27s
H    0     0                    -50613.66430 34910.4731   169%     -   27s
H    0     0                    -4629.692851 34910.4731   854%     -   27s
H    0     0                    -2891.965994 34910.4731  1307%     -   28s
H    0     0                    -1461.356720 34910.4731  2489%     -   28s
H    0     0                    -746.2791297 34910.4731  4778%     -   30s
H    0     0                    -491.5736716 34910.4731  7202%     -   30s
H    0     0                    -355.3337748 34910.4731  9925%     -   30s
     0     0 28620.8526    0  329 -355.33377 28620.8526  8155%     -   74s
H    0     0                    -298.8453650 28620.7820  9677%     -   76s
H    0     0                    -271.0561097 28620.7820      -     -   76s
H    0     0                     148.7614886 28620.7820      -     -   76s
     0     0 28340.6734    0  318  148.76149 28340.6734      -     -   92s
     0     0 28309.8906    0  325  148.76149 28309.8906      -     -   97s
     0     0 28305.0114    0  327  148.76149 28305.0114      -     -   98s
     0     0 28304.3869    0  331  148.76149 28304.3869      -     -   99s
     0     0 24938.1325    0  292  148.76149 24938.1325      -     -  155s
H    0     0                    1034.8955913 24937.7156  2310%     -  156s
H    0     0                    1290.3769012 24937.7156  1833%     -  156s
H    0     0                    1349.8505646 24937.7156  1747%     -  156s
H    0     0                    2031.0318838 24937.7156  1128%     -  156s
H    0     0                    2361.0960396 24937.7156   956%     -  157s
H    0     0                    2418.9057336 24937.7156   931%     -  157s
H    0     0                    2491.6905367 24937.7156   901%     -  157s
H    0     0                    2549.5002308 24937.7156   878%     -  157s
H    0     0                    2552.7704647 24937.7156   877%     -  157s
H    0     0                    2592.7232721 24937.7156   862%     -  157s
     0     0 24447.8294    0  317 2592.72327 24447.8294   843%     -  185s
     0     0 24225.6356    0  313 2592.72327 24225.6356   834%     -  200s
     0     0 24166.7708    0  320 2592.72327 24166.7708   832%     -  209s
     0     0 24101.0069    0  330 2592.72327 24101.0069   830%     -  221s
     0     0 23973.7296    0  323 2592.72327 23973.7296   825%     -  238s
     0     0 23814.2820    0  313 2592.72327 23814.2820   819%     -  256s
     0     0 23798.9763    0  318 2592.72327 23798.9763   818%     -  263s
     0     0 23611.6139    0  383 2592.72327 23611.6139   811%     -  283s
     0     0 23577.6337    0  401 2592.72327 23577.6337   809%     -  294s
     0     0 23571.7811    0  400 2592.72327 23571.7811   809%     -  297s
     0     0 23540.6490    0  400 2592.72327 23540.6490   808%     -  306s
     0     0 23523.3155    0  396 2592.72327 23523.3155   807%     -  312s
     0     0 23522.8426    0  401 2592.72327 23522.8426   807%     -  316s
     0     0 21579.8294    0  352 2592.72327 21579.8294   732%     -  381s
H    0     0                    2700.3725043 21579.7012   699%     -  382s
     0     0 21160.2073    0  361 2700.37250 21160.2073   684%     -  410s
     0     0 21091.3812    0  363 2700.37250 21091.3812   681%     -  424s
     0     0 21063.5910    0  362 2700.37250 21063.5910   680%     -  432s
     0     0 21015.6893    0  367 2700.37250 21015.6893   678%     -  440s
     0     0 20992.2082    0  376 2700.37250 20992.2082   677%     -  447s
     0     0 20927.8955    0  377 2700.37250 20927.8955   675%     -  457s
     0     0 20869.9629    0  383 2700.37250 20869.9629   673%     -  466s
     0     0 20851.3385    0  387 2700.37250 20851.3385   672%     -  472s
     0     0 20815.1699    0  386 2700.37250 20815.1699   671%     -  480s
     0     0 20813.6819    0  390 2700.37250 20813.6819   671%     -  482s
     0     0 19664.0358    0  381 2700.37250 19664.0358   628%     -  538s
H    0     0                    2986.0672711 19663.9759   559%     -  540s
H    0     0                    3010.9197854 19663.9759   553%     -  540s
     0     0 19368.3976    0  418 3010.91979 19368.3976   543%     -  567s
     0     0 19119.8562    0  458 3010.91979 19119.8562   535%     -  595s
     0     0 19051.4356    0  477 3010.91979 19051.4356   533%     -  610s
     0     0 19024.5764    0  496 3010.91979 19024.5764   532%     -  619s
     0     0 19019.4854    0  507 3010.91979 19019.4854   532%     -  623s
     0     0 19012.7891    0  504 3010.91979 19012.7891   531%     -  627s
     0     0 19000.1472    0  493 3010.91979 19000.1472   531%     -  634s
     0     0 18987.2980    0  493 3010.91979 18987.2980   531%     -  640s
     0     0 18984.7115    0  493 3010.91979 18984.7115   531%     -  643s
     0     0 18976.8018    0  496 3010.91979 18976.8018   530%     -  647s
     0     0 18970.7761    0  491 3010.91979 18970.7761   530%     -  652s
     0     0 18967.1371    0  495 3010.91979 18967.1371   530%     -  657s
     0     0 18966.9320    0  495 3010.91979 18966.9320   530%     -  658s
     0     0 18803.6919    0  355 3010.91979 18803.6919   525%     -  682s
     0     0 18758.9879    0  501 3010.91979 18758.9879   523%     -  697s
     0     0 18738.3317    0  358 3010.91979 18738.3317   522%     -  708s
     0     0 18729.1745    0  435 3010.91979 18729.1745   522%     -  718s
     0     0 18710.0362    0  362 3010.91979 18710.0362   521%     -  726s
     0     0 18702.8129    0  505 3010.91979 18702.8129   521%     -  733s
     0     0 18700.0394    0  367 3010.91979 18700.0394   521%     -  738s
     0     0 18698.0548    0  453 3010.91979 18698.0548   521%     -  742s
     0     0 18583.7857    0  492 3010.91979 18583.7857   517%     -  765s
H    0     0                    3056.1335653 18583.0542   508%     -  770s
H    0     0                    3061.7067266 18583.0542   507%     -  771s
H    0     0                    3067.6978845 18583.0542   506%     -  771s
     0     0 18499.7742    0  592 3067.69788 18499.7742   503%     -  788s
     0     0 18480.2767    0  563 3067.69788 18480.2767   502%     -  794s
     0     0 18476.5048    0  514 3067.69788 18476.5048   502%     -  797s
     0     0 18475.3937    0  564 3067.69788 18475.3937   502%     -  798s
     0     0 18441.7324    0  451 3067.69788 18441.7324   501%     -  809s
     0     0 18433.0211    0  449 3067.69788 18433.0211   501%     -  816s
     0     0 18428.4615    0  512 3067.69788 18428.4615   501%     -  820s
     0     0 18427.1186    0  452 3067.69788 18427.1186   501%     -  822s
     0     0 18387.0696    0  535 3067.69788 18387.0696   499%     -  831s
     0     0 18363.7692    0  536 3067.69788 18363.7692   499%     -  842s
     0     0 18358.0924    0  537 3067.69788 18358.0924   498%     -  845s
     0     0 18350.3594    0  541 3067.69788 18350.3594   498%     -  849s
     0     0 18347.3069    0  538 3067.69788 18347.3069   498%     -  852s
     0     0 18346.1864    0  546 3067.69788 18346.1864   498%     -  855s
     0     0 18313.0863    0  434 3067.69788 18313.0863   497%     -  865s
     0     0 18293.4430    0  446 3067.69788 18293.4430   496%     -  875s
     0     0 18290.9863    0  504 3067.69788 18290.9863   496%     -  878s
     0     0 18290.0524    0  455 3067.69788 18290.0524   496%     -  880s
     0     0 18281.0831    0  445 3067.69788 18281.0831   496%     -  886s
     0     0 18276.5198    0  516 3067.69788 18276.5198   496%     -  893s
     0     0 18274.3818    0  455 3067.69788 18274.3818   496%     -  897s
     0     0 18265.1423    0  552 3067.69788 18265.1423   495%     -  904s
     0     0 18261.4178    0  522 3067.69788 18261.4178   495%     -  910s
     0     0 18260.3948    0  471 3067.69788 18260.3948   495%     -  912s
     0     0 18253.6155    0  457 3067.69788 18253.6155   495%     -  919s
H    0     0                    3278.9943029 18253.3389   457%     -  952s
H    0     0                    3294.2475925 18253.3389   454%     -  954s
     0     0 18252.1656    0  452 3294.24759 18252.1656   454%     -  957s
     0     0 18248.2703    0  459 3294.24759 18248.2703   454%     -  962s
     0     0 18248.0262    0  459 3294.24759 18248.0262   454%     -  966s
H    0     0                    3301.1101936 18248.0262   453%     - 1109s
     0     2 18248.0262    0  459 3301.11019 18248.0262   453%     - 1118s
     1     3 18082.7315    1  401 3301.11019 18248.0262   453%  9548 1133s
     2     4 18203.7704    1  452 3301.11019 18203.7704   451%  7628 1146s
     3     6 17766.9128    2  488 3301.11019 18203.5962   451%  7499 1168s
     5    10 17730.6735    3  420 3301.11019 18203.5962   451%  8535 1194s
     9    19 17413.5731    4  559 3301.11019 17766.8994   438% 10139 1233s
    18    38 17262.2075    5  557 3301.11019 17654.4645   435% 11331 1303s
    37    51 17075.3108    5  519 3301.11019 17425.7878   428% 19007 1486s
    50    76 16583.5751    6  533 3301.11019 17425.7878   428% 18818 1618s
H   54    76                    3536.7411608 17425.7878   393% 18086 1618s
    75   148 16434.5462    7  550 3536.74116 17425.7878   393% 15115 1776s
   147   257 16388.9730    8  507 3536.74116 17425.7878   393%  9634 1906s
   256   331 16271.4984   11  525 3536.74116 17425.7878   393%  7195 1991s
   330   363 15776.4160   13  496 3536.74116 17425.7878   393%  6382 2080s
   362   402 15743.2169   15  429 3536.74116 17425.7878   393%  6252 2163s
   408   421 15420.9055   16  462 3536.74116 17425.7878   393%  6123 2244s
   431   445 15394.5683   17  463 3536.74116 17425.7878   393%  6101 2311s
H  436   445                    3538.8933126 17425.7878   392%  6098 2311s
H  438   445                    3596.1336264 17425.7878   385%  6078 2311s
   465   462 14684.5257   19  440 3596.13363 17425.7878   385%  6079 2376s
   490   491 14494.4876   20  430 3596.13363 17425.7878   385%  6059 2457s
H  507   491                    3688.0520681 17425.7878   372%  5971 2457s
   525   558 14409.8192   22  419 3688.05207 17425.7878   372%  5899 2522s
   621   643 14199.2854   27  413 3688.05207 17425.7878   372%  5485 2577s
   733   743 13749.0138   31  411 3688.05207 17425.7878   372%  5048 2617s
   843   839 13718.6189   32  335 3688.05207 17425.7878   372%  4578 2663s
   967   950 13036.8369   33  264 3688.05207 17425.7878   372%  4286 2702s
  1125  1009 12920.1886   34  258 3688.05207 17425.7878   372%  3852 2743s
  1265  1003 12161.2062   36  333 3688.05207 17425.7878   372%  3585 2796s
  1389  1009 infeasible   44      3688.05207 17425.7878   372%  3402 2849s
  1459  1053 12837.1449   34  318 3688.05207 17425.7878   372%  3398 2915s
  1540  1077 12773.2404   35  316 3688.05207 17425.7878   372%  3376 2963s
  1576  1103 12374.9807   36  307 3688.05207 17425.7878   372%  3394 3059s
  1618  1140 11940.8276   37  301 3688.05207 17425.7878   372%  3390 3148s
  1667  1162 10092.7083   38  192 3688.05207 17425.7878   372%  3373 3237s
  1735  1187 11732.5382   38  211 3688.05207 17425.7878   372%  3333 3332s
  1816  1218 10511.6673   39  189 3688.05207 17425.7878   372%  3323 3452s
  1905  1277 10063.3407   40  175 3688.05207 17425.7878   372%  3290 3559s
  1989  1320 10030.9483   41  173 3688.05207 17425.7878   372%  3279 3600s

Cutting planes:
  Gomory: 11
  Implied bound: 189
  MIR: 3490
  Flow cover: 3497
  RLT: 63
  Relax-and-lift: 633

Explored 2044 nodes (7364980 simplex iterations) in 3600.17 seconds (4862.53 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 3688.05 3596.13 3538.89 ... 3056.13

Time limit reached
Best objective 3.688052068105e+03, best bound 1.742578776135e+04, gap 372.4930%
  WARNING: Time limit reached. Using best solution found (gap: 372.49%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.20s
  Master Objective (UB) = 3688.05, θ = 144667.21
  Upper Bound (UB) = 3688.05

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 144667.21
  [DEBUG]   ✓ Scenario 0: θ = 144667.21 ≤ Q = 144667.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 144667.21 ≤ Q = 144667.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 144667.21 ≤ Q = 144667.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 144667.21 ≤ Q = 144667.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 144667.21 ≤ Q = 144667.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 144667.21 ≤ Q = 144667.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 144667.21 ≤ Q = 144667.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 144667.21 ≤ Q = 144667.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 144667.21 ≤ Q = 144667.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 144667.21 ≤ Q = 144667.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 144667.21 ≤ Q = 144667.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 144667.21 ≤ Q = 144667.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 144667.21 ≤ Q = 144667.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 144667.21 ≤ Q = 144667.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 144667.21 ≤ Q = 144667.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 144667.21 ≤ Q = 144667.21 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 16] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x55f7dd93
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xaa08226d
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.164593e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.00s
Presolved: 494 rows, 498 columns, 1393 nonzeros
Found heuristic solution: objective 5800258.3439
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.271903e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -127190.34    0  122 5800258.34 -127190.34   102%     -    0s
H    0     0                    -95194.29287 -127190.34  33.6%     -    0s
H    0     0                    -95677.36265 -127190.34  32.9%     -    0s
     0     0 -103494.62    0   85 -95677.363 -103494.62  8.17%     -    0s
H    0     0                    -99423.08310 -103457.02  4.06%     -    0s
H    0     0                    -99447.19414 -103457.02  4.03%     -    0s
H    0     0                    -102171.8237 -103457.02  1.26%     -    0s
H    0     0                    -102195.9348 -103457.02  1.23%     -    0s
     0     0 -103122.32    0   86 -102195.93 -103122.32  0.91%     -    0s
     0     0 -103070.80    0   75 -102195.93 -103070.80  0.86%     -    0s
     0     0 -103068.32    0   82 -102195.93 -103068.32  0.85%     -    0s
H    0     0                    -102478.8819 -103068.32  0.58%     -    0s
H    0     0                    -102501.8771 -103068.32  0.55%     -    0s
     0     0 -102700.91    0   43 -102501.88 -102700.91  0.19%     -    0s
     0     0 -102677.55    0   30 -102501.88 -102677.55  0.17%     -    0s
     0     0 -102665.65    0   27 -102501.88 -102665.65  0.16%     -    0s
     0     0 -102659.65    0   17 -102501.88 -102659.65  0.15%     -    0s
     0     0 -102651.42    0   16 -102501.88 -102651.42  0.15%     -    0s
     0     0 -102647.28    0   15 -102501.88 -102647.28  0.14%     -    0s
     0     0 -102600.36    0   19 -102501.88 -102600.36  0.10%     -    0s
     0     0 -102600.36    0   14 -102501.88 -102600.36  0.10%     -    0s
     0     0 -102548.59    0   10 -102501.88 -102548.59  0.05%     -    0s
     0     0 -102534.45    0    4 -102501.88 -102534.45  0.03%     -    0s
H    0     0                    -102508.6093 -102534.45  0.03%     -    0s
H    0     0                    -102522.5084 -102522.51  0.00%     -    0s
     0     0 -102522.51    0    2 -102522.51 -102522.51  0.00%     -    0s

Cutting planes:
  Implied bound: 4
  MIR: 1
  Flow cover: 3
  RLT: 1

Explored 1 nodes (670 simplex iterations) in 0.18 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -102523 -102509 -102502 ... 1.16459e+13
No other solutions better than -102523

Optimal solution found (tolerance 1.00e-04)
Best objective -1.025225083992e+05, best bound -1.025225083992e+05, gap 0.0000%
  Subproblem solved in 0.21s
  Worst-case operational profit (Z_SP) = 139995.15
  Scenario: 24 demand increases, 36 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -102522.51
  [DEBUG]   S×d_nominal = 242517.66
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 242517.66 + -102522.51 = 139995.15
  [DEBUG]   Current θ from Master = 144667.21
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4672.06 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -984.01
  Lower Bound (LB) = 3127.61
  Gap (UB-LB) = 560.4458, Absolute Gap = 560.4458, Relative Gap = 0.151963
  Not converged yet (gap = 560.45 > ε = 200)

  [DEBUG] Adding NEW scenario 16 to Master Problem...
  [DEBUG] New scenario pattern: 24 increases, 36 decreases
    [DEBUG] Scenario 16 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 16 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 16]
    [DEBUG]   - Total constraints in model: 261313
    [DEBUG]   - Total variables in model: 108340
  [DEBUG] Total scenarios in Master: 17
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 17
================================================================================
[Iteration 17] Solving Master Problem...
  Current scenarios in Master: 17
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 261313 rows, 108340 columns and 740446 nonzeros
Model fingerprint: 0x513de0b6
Variable types: 106081 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 120190 rows and 48790 columns
Presolve time: 4.57s
Presolved: 141123 rows, 59550 columns, 868708 nonzeros
Variable types: 57291 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -363238.5703
Found heuristic solution: objective -210461.3866

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.53s

Barrier statistics:
 Dense cols : 597
 AA' NZ     : 7.657e+06
 Factor NZ  : 1.757e+07 (roughly 220 MB of memory)
 Factor Ops : 5.317e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.97520501e+07  2.27451180e+08  1.13e+05 1.82e+01  8.49e+04     7s
   1  -1.53761160e+07  2.07284871e+08  8.11e+04 5.65e+01  6.02e+04     8s
   2  -4.89567525e+06  1.60620587e+08  2.51e+04 1.03e+00  1.98e+04     8s
   3  -1.05409337e+06  1.20192348e+08  2.82e+03 1.79e+00  2.59e+03     8s
   4  -5.76117910e+05  7.20090185e+07  5.96e+02 8.48e-01  6.92e+02     9s
   5  -4.89650800e+05  3.78818621e+07  3.27e+02 3.34e-01  3.50e+02     9s
   6  -3.96013623e+05  2.85719835e+07  1.11e+02 2.34e-01  1.77e+02     9s
   7  -3.27019826e+05  2.09969911e+07  5.71e+01 1.60e-01  1.12e+02     9s
   8  -1.88050474e+05  1.44619736e+07  1.14e+01 1.02e-01  6.16e+01    10s
   9  -1.54345018e+05  1.03408432e+07  7.04e+00 7.10e-02  4.30e+01    10s
  10  -1.24868269e+05  5.32454838e+06  4.12e+00 3.50e-02  2.19e+01    10s
  11  -8.72442970e+04  1.82060502e+06  7.61e-01 1.05e-02  7.46e+00    11s
  12  -5.97943022e+04  5.60574006e+05  3.13e-01 3.37e-03  2.42e+00    11s
  13  -3.89538004e+04  3.01361893e+05  1.77e-01 1.71e-03  1.32e+00    11s
  14  -2.50794673e+04  2.22816384e+05  1.20e-01 1.85e-03  9.64e-01    12s
  15  -1.35667610e+04  1.58985958e+05  9.16e-02 1.70e-03  6.71e-01    12s
  16  -5.89501669e+03  1.18845608e+05  7.39e-02 2.47e-03  4.85e-01    12s
  17  -1.78719017e+03  1.04553253e+05  6.39e-02 2.29e-03  4.14e-01    12s
  18   2.77411905e+03  8.18739031e+04  5.45e-02 2.15e-03  3.08e-01    13s
  19   9.25085983e+03  6.70007011e+04  4.14e-02 1.96e-03  2.25e-01    13s
  20   1.29268438e+04  5.48644615e+04  3.45e-02 1.32e-03  1.63e-01    13s
  21   1.36616414e+04  5.37670384e+04  3.30e-02 1.25e-03  1.56e-01    14s
  22   1.81911010e+04  5.12983333e+04  2.48e-02 9.97e-04  1.29e-01    14s
  23   2.15490493e+04  4.87796337e+04  1.92e-02 8.44e-04  1.06e-01    14s
  24   2.20374051e+04  4.51999294e+04  1.83e-02 6.64e-04  9.01e-02    15s
  25   2.46321604e+04  4.44686242e+04  1.43e-02 6.18e-04  7.71e-02    15s
  26   2.58174707e+04  4.38692989e+04  1.25e-02 5.82e-04  7.02e-02    16s
  27   2.65445574e+04  4.28508654e+04  1.14e-02 5.21e-04  6.34e-02    16s
  28   2.70924109e+04  4.22995854e+04  1.06e-02 4.87e-04  5.91e-02    17s
  29   2.77715373e+04  4.04982654e+04  9.59e-03 3.81e-04  4.95e-02    17s
  30   2.90835739e+04  3.97459635e+04  7.62e-03 3.32e-04  4.15e-02    18s
  31   3.00400285e+04  3.85843546e+04  6.25e-03 2.55e-04  3.32e-02    18s
  32   3.05290598e+04  3.80209492e+04  5.57e-03 2.20e-04  2.91e-02    18s
  33   3.18641403e+04  3.69456719e+04  3.78e-03 1.66e-04  1.98e-02    19s
  34   3.26533857e+04  3.63782942e+04  2.74e-03 1.29e-04  1.45e-02    19s
  35   3.30893408e+04  3.60349195e+04  2.19e-03 1.19e-04  1.15e-02    20s
  36   3.34666520e+04  3.57138446e+04  1.71e-03 9.93e-05  8.74e-03    20s
  37   3.38099093e+04  3.56676166e+04  1.30e-03 9.33e-05  7.22e-03    21s
  38   3.40246403e+04  3.55396665e+04  1.03e-03 7.76e-05  5.89e-03    21s
  39   3.41970850e+04  3.53504270e+04  8.18e-04 5.39e-05  4.48e-03    21s
  40   3.44720880e+04  3.51749036e+04  4.86e-04 3.19e-05  2.73e-03    22s
  41   3.46161666e+04  3.50781542e+04  3.20e-04 2.04e-05  1.80e-03    22s
  42   3.47349169e+04  3.50025235e+04  1.83e-04 1.08e-05  1.04e-03    23s
  43   3.48086494e+04  3.49772154e+04  1.03e-04 7.73e-06  6.55e-04    23s
  44   3.48461887e+04  3.49347294e+04  6.26e-05 2.57e-06  3.44e-04    24s
  45   3.48485848e+04  3.49290306e+04  6.02e-05 1.97e-06  3.13e-04    24s
  46   3.48969273e+04  3.49241083e+04  1.02e-05 1.46e-06  1.06e-04    25s
  47   3.49088271e+04  3.49164071e+04  9.55e-07 6.24e-07  2.94e-05    25s
  48   3.49096566e+04  3.49134676e+04  4.65e-07 3.11e-07  1.48e-05    25s
  49   3.49102727e+04  3.49108276e+04  7.72e-08 3.49e-08  2.16e-06    26s
  50   3.49104365e+04  3.49104733e+04  1.40e-08 3.85e-10  1.43e-07    26s
  51   3.49104672e+04  3.49104731e+04  1.23e-06 1.77e-09  2.32e-08    27s
  52   3.49104695e+04  3.49104731e+04  4.48e-06 5.37e-08  1.43e-08    27s
  53   3.49104731e+04  3.49104731e+04  2.07e-08 4.66e-08  6.53e-11    27s

Barrier solved model in 53 iterations and 27.33 seconds (15.21 work units)
Optimal objective 3.49104731e+04


Root crossover log...

  127139 DPushes remaining with DInf 0.0000000e+00                27s
   43267 DPushes remaining with DInf 0.0000000e+00                30s
       0 DPushes remaining with DInf 0.0000000e+00                34s

    1949 PPushes remaining with PInf 1.5375202e-05                34s
       0 PPushes remaining with PInf 0.0000000e+00                34s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.8770561e+00     34s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   58271    3.4910473e+04   0.000000e+00   3.877056e+00     34s
   58273    3.4910473e+04   0.000000e+00   0.000000e+00     34s
   58273    3.4910473e+04   0.000000e+00   0.000000e+00     34s
Concurrent spin time: 0.96s

Solved with barrier

Root relaxation: objective 3.491047e+04, 58273 iterations, 29.32 seconds (18.79 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 34910.4731    0  155 -210461.39 34910.4731   117%     -   35s
H    0     0                    -103312.7267 34910.4731   134%     -   36s
H    0     0                    -102903.7356 34910.4731   134%     -   36s
H    0     0                    -101972.8646 34910.4731   134%     -   36s
H    0     0                    -50613.66430 34910.4731   169%     -   36s
H    0     0                    -4629.692851 34910.4731   854%     -   36s
H    0     0                    -3739.165537 34910.4731  1034%     -   36s
H    0     0                    -1551.999112 34910.4731  2349%     -   37s
H    0     0                    -491.5736716 34910.4731  7202%     -   40s
H    0     0                    -461.8889536 34910.4731  7658%     -   40s
H    0     0                    -355.3337748 34910.4731  9925%     -   40s
     0     0 28984.2809    0  291 -355.33377 28984.2809  8257%     -   83s
H    0     0                     616.6762359 28969.7456  4598%     -   85s
H    0     0                     721.4586705 28969.7456  3915%     -   85s
     0     0 28744.9245    0  296  721.45867 28744.9245  3884%     -  101s
     0     0 28685.4929    0  283  721.45867 28685.4929  3876%     -  105s
     0     0 28683.9054    0  292  721.45867 28683.9054  3876%     -  106s
     0     0 28614.4706    0  308  721.45867 28614.4706  3866%     -  113s
     0     0 28607.7081    0  308  721.45867 28607.7081  3865%     -  115s
     0     0 28592.2842    0  325  721.45867 28592.2842  3863%     -  118s
     0     0 28591.2837    0  327  721.45867 28591.2837  3863%     -  119s
     0     0 28582.5577    0  326  721.45867 28582.5577  3862%     -  119s
     0     0 28582.4976    0  328  721.45867 28582.4976  3862%     -  119s
     0     0 25127.5383    0  268  721.45867 25127.5383  3383%     -  158s
H    0     0                    1122.8500484 25126.8526  2138%     -  160s
H    0     0                    1254.5653344 25126.8526  1903%     -  160s
H    0     0                    1561.6836290 25126.8526  1509%     -  160s
H    0     0                    1621.3157209 25126.8526  1450%     -  160s
H    0     0                    1712.3674966 25126.8526  1367%     -  160s
H    0     0                    1746.0903784 25126.8526  1339%     -  160s
     0     0 24666.2034    0  291 1746.09038 24666.2034  1313%     -  186s
     0     0 24443.5196    0  290 1746.09038 24443.5196  1300%     -  201s
     0     0 24233.7836    0  236 1746.09038 24233.7836  1288%     -  213s
     0     0 24215.6762    0  294 1746.09038 24215.6762  1287%     -  219s
     0     0 24212.5615    0  245 1746.09038 24212.5615  1287%     -  222s
     0     0 24136.0385    0  246 1746.09038 24136.0385  1282%     -  231s
     0     0 24132.3133    0  303 1746.09038 24132.3133  1282%     -  235s
     0     0 24129.3908    0  318 1746.09038 24129.3908  1282%     -  237s
     0     0 24098.9489    0  313 1746.09038 24098.9489  1280%     -  244s
     0     0 24085.2548    0  307 1746.09038 24085.2548  1279%     -  248s
     0     0 23964.4445    0  291 1746.09038 23964.4445  1272%     -  260s
     0     0 23879.3057    0  298 1746.09038 23879.3057  1268%     -  275s
     0     0 23663.7957    0  295 1746.09038 23663.7957  1255%     -  293s
     0     0 23638.7046    0  300 1746.09038 23638.7046  1254%     -  302s
     0     0 23598.0293    0  316 1746.09038 23598.0293  1251%     -  307s
     0     0 23592.5388    0  311 1746.09038 23592.5388  1251%     -  310s
     0     0 23573.7172    0  387 1746.09038 23573.7172  1250%     -  319s
     0     0 23564.5378    0  325 1746.09038 23564.5378  1250%     -  322s
     0     0 23557.7806    0  329 1746.09038 23557.7806  1249%     -  324s
     0     0 23551.0074    0  328 1746.09038 23551.0074  1249%     -  328s
     0     0 23550.8779    0  328 1746.09038 23550.8779  1249%     -  328s
     0     0 21378.0005    0  351 1746.09038 21378.0005  1124%     -  390s
H    0     0                    2034.0927946 21377.9499   951%     -  392s
H    0     0                    2194.2855818 21377.9499   874%     -  392s
     0     0 20985.7146    0  337 2194.28558 20985.7146   856%     -  422s
     0     0 20846.0294    0  413 2194.28558 20846.0294   850%     -  441s
     0     0 20806.5237    0  353 2194.28558 20806.5237   848%     -  450s
     0     0 20713.1180    0  359 2194.28558 20713.1180   844%     -  467s
     0     0 20697.9295    0  364 2194.28558 20697.9295   843%     -  475s
     0     0 20686.3921    0  376 2194.28558 20686.3921   843%     -  482s
     0     0 20675.7925    0  376 2194.28558 20675.7925   842%     -  487s
     0     0 20668.0592    0  386 2194.28558 20668.0592   842%     -  492s
     0     0 20664.1969    0  382 2194.28558 20664.1969   842%     -  496s
     0     0 20654.6697    0  390 2194.28558 20654.6697   841%     -  502s
     0     0 20653.5906    0  383 2194.28558 20653.5906   841%     -  503s
     0     0 19725.8729    0  382 2194.28558 19725.8729   799%     -  568s
H    0     0                    2414.8781276 19725.7093   717%     -  568s
     0     0 19447.3897    0  473 2414.87813 19447.3897   705%     -  595s
     0     0 19338.4299    0  398 2414.87813 19338.4299   701%     -  614s
     0     0 19311.0962    0  462 2414.87813 19311.0962   700%     -  625s
     0     0 19275.6057    0  471 2414.87813 19275.6057   698%     -  638s
     0     0 19258.9908    0  469 2414.87813 19258.9908   698%     -  648s
     0     0 19238.9876    0  476 2414.87813 19238.9876   697%     -  655s
     0     0 19237.4982    0  481 2414.87813 19237.4982   697%     -  658s
     0     0 18961.7458    0  453 2414.87813 18961.7458   685%     -  694s
H    0     0                    2421.9335496 18961.7232   683%     -  695s
H    0     0                    2762.4123460 18961.7232   586%     -  695s
     0     0 18907.6290    0  477 2762.41235 18907.6290   584%     -  712s
     0     0 18816.9614    0  406 2762.41235 18816.9614   581%     -  723s
     0     0 18765.3302    0  412 2762.41235 18765.3302   579%     -  734s
     0     0 18729.4467    0  415 2762.41235 18729.4467   578%     -  744s
     0     0 18716.2126    0  430 2762.41235 18716.2126   578%     -  750s
     0     0 18710.0263    0  355 2762.41235 18710.0263   577%     -  755s
     0     0 18701.2480    0  348 2762.41235 18701.2480   577%     -  760s
     0     0 18698.1634    0  353 2762.41235 18698.1634   577%     -  763s
     0     0 18693.2402    0  420 2762.41235 18693.2402   577%     -  769s
     0     0 18686.8532    0  425 2762.41235 18686.8532   576%     -  772s
     0     0 18679.8011    0  431 2762.41235 18679.8011   576%     -  776s
     0     0 18675.5762    0  438 2762.41235 18675.5762   576%     -  780s
     0     0 18674.1494    0  438 2762.41235 18674.1494   576%     -  783s
     0     0 18576.8033    0  495 2762.41235 18576.8033   572%     -  805s
     0     0 18551.2095    0  493 2762.41235 18551.2095   572%     -  819s
     0     0 18534.2941    0  546 2762.41235 18534.2941   571%     -  829s
     0     0 18502.8306    0  549 2762.41235 18502.8306   570%     -  841s
     0     0 18494.9985    0  546 2762.41235 18494.9985   570%     -  851s
     0     0 18492.4384    0  603 2762.41235 18492.4384   569%     -  857s
     0     0 18490.4786    0  602 2762.41235 18490.4786   569%     -  859s
     0     0 18416.9453    0  554 2762.41235 18416.9453   567%     -  882s
     0     0 18397.1788    0  500 2762.41235 18397.1788   566%     -  895s
     0     0 18380.5302    0  560 2762.41235 18380.5302   565%     -  906s
     0     0 18373.6343    0  549 2762.41235 18373.6343   565%     -  912s
     0     0 18371.5247    0  553 2762.41235 18371.5247   565%     -  917s
     0     0 18339.4856    0  499 2762.41235 18339.4856   564%     -  931s
H    0     0                    2794.4905611 18339.1768   556%     -  931s
     0     0 18330.9716    0  456 2794.49056 18330.9716   556%     -  939s
     0     0 18324.7202    0  453 2794.49056 18324.7202   556%     -  946s
     0     0 18323.6482    0  510 2794.49056 18323.6482   556%     -  949s
     0     0 18307.5553    0  510 2794.49056 18307.5553   555%     -  961s
     0     0 18302.6161    0  506 2794.49056 18302.6161   555%     -  968s
     0     0 18298.9232    0  504 2794.49056 18298.9232   555%     -  972s
     0     0 18297.0840    0  459 2794.49056 18297.0840   555%     -  974s
     0     0 18284.3223    0  555 2794.49056 18284.3223   554%     -  987s
     0     0 18277.6982    0  503 2794.49056 18277.6982   554%     -  993s
     0     0 18273.5708    0  504 2794.49056 18273.5708   554%     -  997s
     0     0 18272.7103    0  500 2794.49056 18272.7103   554%     -  999s
     0     0 18265.8961    0  503 2794.49056 18265.8961   554%     - 1006s
     0     0 18249.9833    0  550 2794.49056 18249.9833   553%     - 1014s
     0     0 18248.5776    0  498 2794.49056 18248.5776   553%     - 1017s
     0     0 18242.5800    0  495 2794.49056 18242.5800   553%     - 1024s
     0     0 18242.3674    0  495 2794.49056 18242.3674   553%     - 1029s
H    0     0                    2808.6053742 18242.3674   550%     - 1094s
H    0     0                    2988.2151685 18242.3674   510%     - 1095s
H    0     0                    3018.6133631 18242.3674   504%     - 1219s
H    0     0                    3077.5769472 18242.3674   493%     - 1226s
H    0     0                    3157.9227515 18242.3674   478%     - 1226s
H    0     0                    3163.3600874 18242.3674   477%     - 1227s
H    0     0                    3168.7482298 18242.3674   476%     - 1227s
H    0     0                    3171.8578891 18242.3674   475%     - 1227s
     0     2 18242.3674    0  495 3171.85789 18242.3674   475%     - 1235s
     1     3 18108.5828    1  576 3171.85789 18242.3674   475%  8963 1252s
     2     4 18149.6169    1  482 3171.85789 18149.6169   472%  7726 1272s
     3     6 17770.2148    2  482 3171.85789 18149.5744   472%  7492 1301s
     5    12 17304.0696    3  405 3171.85789 18149.5744   472% 10220 1336s
    11    24 17046.9750    4  401 3171.85789 17620.1761   456% 12094 1390s
    23    36 16361.5846    4  336 3171.85789 17324.8130   446% 20301 1520s
    35    68 15668.2007    6  293 3171.85789 17324.8130   446% 17701 1760s
H   36    68                    3307.1099350 17324.8130   424% 17210 1760s
    67   137 15289.2225    7  248 3307.10994 17224.5786   421% 20890 1939s
H  136   226                    3445.9808079 17223.7815   400% 13978 2082s
H  161   226                    3487.7462146 17223.7815   394% 12661 2082s
H  208   226                    3515.6393822 17223.7815   390% 11318 2082s
   225   310 13422.7698   17  197 3515.63938 17223.7815   390% 10972 2193s
   309   355 12899.2813   20  197 3515.63938 17223.7815   390%  9421 2284s
H  336   355                    3532.9141347 17223.7815   388%  9102 2284s
   366   386 4800.47456   25  185 3532.91413 17223.7815   388%  8975 2366s
   419   404 3926.53427   30  152 3532.91413 17223.7815   388%  9054 2434s
   447   421 infeasible   31      3532.91413 17223.7815   388%  9373 2510s
   486   434 infeasible   31      3532.91413 17223.7815   388%  9742 2581s
   521   478 16772.3494    9  499 3532.91413 17223.7815   388%  9904 2642s
H  530   478                    3556.4992120 17223.7815   384%  9841 2642s
   571   554 14392.2670   21  445 3556.49921 17223.7815   384%  9802 2698s
   667   637 14360.4956   23  411 3556.49921 17223.7815   384%  9294 2759s
   760   714 14279.1052   25  404 3556.49921 17223.7815   384%  8928 2806s
   855   792 4865.04803   25  265 3556.49921 17223.7815   384%  8540 2853s
   964   874 4459.36909   26  236 3556.49921 17223.7815   384%  8239 2899s
  1072   970 4263.83071   27  232 3556.49921 17223.7815   384%  7779 2941s
  1200  1085 3937.51680   30  222 3556.49921 17223.7815   384%  7347 2985s
  1357  1191 3772.34510   34  205 3556.49921 17223.7815   384%  6900 3037s
  1523  1283 7362.30131   20  235 3556.49921 17223.7815   384%  6543 3088s
  1695  1333 6064.68307   22  174 3556.49921 17223.7815   384%  6193 3138s
  1843  1378 5262.12788   28  148 3556.49921 17223.7815   384%  5958 3207s
  1984  1436 4576.88828   36  102 3556.49921 17223.7815   384%  5848 3348s
  2138  1479 infeasible   38      3556.49921 17223.7815   384%  5681 3474s
  2262  1538 6342.05453   12  241 3556.49921 17223.7815   384%  5602 3600s

Cutting planes:
  Learned: 1
  Gomory: 7
  Implied bound: 274
  MIR: 3556
  Flow cover: 3657
  RLT: 68
  Relax-and-lift: 838
  BQP: 1

Explored 2366 nodes (13931074 simplex iterations) in 3600.35 seconds (4941.64 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 3556.5 3532.91 3515.64 ... 3157.92

Time limit reached
Best objective 3.556499212000e+03, best bound 1.722378147669e+04, gap 384.2903%
  WARNING: Time limit reached. Using best solution found (gap: 384.29%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.40s
  Master Objective (UB) = 3556.50, θ = 145001.78
  Upper Bound (UB) = 3556.50

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 145001.78
  [DEBUG]   ✓ Scenario 0: θ = 145001.78 ≤ Q = 145001.78 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 145001.78 ≤ Q = 145001.78 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 145001.78 ≤ Q = 145001.78 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 145001.78 ≤ Q = 145001.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 145001.78 ≤ Q = 145001.78 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 145001.78 ≤ Q = 145001.78 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 145001.78 ≤ Q = 145001.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 145001.78 ≤ Q = 145001.78 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 145001.78 ≤ Q = 145001.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 145001.78 ≤ Q = 145001.78 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 145001.78 ≤ Q = 145001.78 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 145001.78 ≤ Q = 145001.78 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 145001.78 ≤ Q = 145001.78 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 145001.78 ≤ Q = 145001.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 145001.78 ≤ Q = 145001.78 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 145001.78 ≤ Q = 145001.78 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 145001.78 ≤ Q = 145001.78 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 17] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x62407ea2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x9dbf815e
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.169080e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.00s
Presolved: 494 rows, 498 columns, 1393 nonzeros
Found heuristic solution: objective 5791716.3242
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.267731e+05, 240 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -126773.11    0  122 5791716.32 -126773.11   102%     -    0s
H    0     0                    -94759.23360 -126773.11  33.8%     -    0s
H    0     0                    -95565.55925 -126773.11  32.7%     -    0s
     0     0 -101313.12    0   85 -95565.559 -101313.12  6.01%     -    0s
H    0     0                    -100096.2905 -101256.04  1.16%     -    0s
     0     0 -100880.21    0   88 -100096.29 -100880.21  0.78%     -    0s
H    0     0                    -100387.3465 -100873.79  0.48%     -    0s
     0     0 -100808.27    0   80 -100387.35 -100808.27  0.42%     -    0s
     0     0 -100800.25    0   58 -100387.35 -100800.25  0.41%     -    0s
     0     0 -100792.67    0   58 -100387.35 -100792.67  0.40%     -    0s
     0     0 -100546.81    0   48 -100387.35 -100546.81  0.16%     -    0s
     0     0 -100481.55    0   18 -100387.35 -100481.55  0.09%     -    0s
     0     0 -100473.46    0   11 -100387.35 -100473.46  0.09%     -    0s
     0     0 -100448.73    0    8 -100387.35 -100448.73  0.06%     -    0s
     0     0 -100445.73    0    4 -100387.35 -100445.73  0.06%     -    0s
     0     0 -100442.29    0    4 -100387.35 -100442.29  0.05%     -    0s
     0     0 -100435.85    0    5 -100387.35 -100435.85  0.05%     -    0s
     0     0 -100435.85    0    7 -100387.35 -100435.85  0.05%     -    0s
H    0     0                    -100388.0778 -100435.85  0.05%     -    0s
     0     0 -100414.86    0    3 -100388.08 -100414.86  0.03%     -    0s
H    0     0                    -100404.2361 -100414.28  0.01%     -    0s
H    0     0                    -100407.9822 -100414.28  0.01%     -    0s
     0     0 -100414.28    0    3 -100407.98 -100414.28  0.01%     -    0s

Cutting planes:
  Gomory: 5
  Implied bound: 3
  MIR: 2
  Flow cover: 3

Explored 1 nodes (655 simplex iterations) in 0.16 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -100408 -100404 -100388 ... 1.16908e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.004079822041e+05, best bound -1.004142827389e+05, gap 0.0063%
  Subproblem solved in 0.19s
  Worst-case operational profit (Z_SP) = 141903.43
  Scenario: 23 demand increases, 37 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -100407.98
  [DEBUG]   S×d_nominal = 242311.41
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 242311.41 + -100407.98 = 141903.43
  [DEBUG]   Current θ from Master = 145001.78
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3098.35 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 458.15
  Lower Bound (LB) = 3127.61
  Gap (UB-LB) = 428.8930, Absolute Gap = 428.8930, Relative Gap = 0.120594
  Not converged yet (gap = 428.89 > ε = 200)

  [DEBUG] Adding NEW scenario 17 to Master Problem...
  [DEBUG] New scenario pattern: 23 increases, 37 decreases
    [DEBUG] Scenario 17 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 17 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 17]
    [DEBUG]   - Total constraints in model: 276603
    [DEBUG]   - Total variables in model: 114580
  [DEBUG] Total scenarios in Master: 18
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 18
================================================================================
[Iteration 18] Solving Master Problem...
  Current scenarios in Master: 18
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 276603 rows, 114580 columns and 783677 nonzeros
Model fingerprint: 0x4ac45afb
Variable types: 112321 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 127260 rows and 51660 columns (presolve time = 5s)...
Presolve removed 127260 rows and 51660 columns
Presolve time: 5.43s
Presolved: 149343 rows, 62920 columns, 919460 nonzeros
Variable types: 60661 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -363844.9763
Found heuristic solution: objective -210461.3866

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.46s

Barrier statistics:
 Dense cols : 597
 AA' NZ     : 8.506e+06
 Factor NZ  : 1.891e+07 (roughly 240 MB of memory)
 Factor Ops : 4.691e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.01003837e+07  2.38724724e+08  1.15e+05 1.78e+01  8.59e+04     8s
   1  -1.56846886e+07  2.17988092e+08  8.27e+04 5.51e+01  6.10e+04     9s
   2  -5.14018006e+06  1.69081449e+08  2.64e+04 3.15e+00  2.07e+04     9s
   3  -1.14185384e+06  1.27515422e+08  3.24e+03 1.33e+00  2.89e+03    10s
   4  -5.89453725e+05  7.67665346e+07  6.55e+02 6.23e-01  7.34e+02    10s
   5  -4.95796680e+05  3.88885220e+07  3.58e+02 2.19e-01  3.63e+02    11s
   6  -3.96222741e+05  2.89754260e+07  1.23e+02 1.50e-01  1.78e+02    11s
   7  -3.20778684e+05  2.15138299e+07  6.02e+01 1.03e-01  1.11e+02    11s
   8  -1.95181897e+05  1.40088428e+07  1.57e+01 6.00e-02  5.86e+01    12s
   9  -1.47603807e+05  1.11350459e+07  9.14e+00 4.66e-02  4.46e+01    12s
  10  -1.26267347e+05  5.71458053e+06  5.93e+00 2.28e-02  2.26e+01    12s
  11  -8.54359143e+04  1.74509191e+06  1.10e+00 6.09e-03  6.80e+00    13s
  12  -6.08644576e+04  5.46495036e+05  4.53e-01 1.89e-03  2.24e+00    13s
  13  -3.76548866e+04  2.93661713e+05  2.35e-01 1.16e-03  1.22e+00    14s
  14  -2.12104847e+04  2.05457703e+05  1.59e-01 1.61e-03  8.34e-01    14s
  15  -1.37359971e+04  1.49692827e+05  1.34e-01 1.92e-03  6.02e-01    14s
  16  -5.92910455e+03  1.09612491e+05  1.08e-01 1.95e-03  4.25e-01    15s
  17  -6.71486063e+02  9.61456945e+04  9.03e-02 1.96e-03  3.56e-01    15s
  18   2.38497551e+03  7.88531631e+04  8.10e-02 1.95e-03  2.81e-01    16s
  19   8.43628651e+03  6.45866649e+04  6.41e-02 1.65e-03  2.07e-01    16s
  20   1.29121960e+04  5.57199489e+04  5.21e-02 1.91e-03  1.58e-01    16s
  21   1.58353233e+04  5.10996698e+04  4.41e-02 1.63e-03  1.30e-01    17s
  22   1.76343320e+04  4.89503191e+04  3.94e-02 1.34e-03  1.15e-01    17s
  23   2.02944570e+04  4.68733890e+04  3.27e-02 1.12e-03  9.79e-02    18s
  24   2.11396838e+04  4.37264079e+04  3.07e-02 8.63e-04  8.32e-02    18s
  25   2.21968785e+04  4.24206032e+04  2.82e-02 7.41e-04  7.45e-02    19s
  26   2.38755827e+04  4.16019389e+04  2.43e-02 6.60e-04  6.53e-02    20s
  27   2.71081631e+04  4.04085476e+04  1.67e-02 5.44e-04  4.90e-02    20s
  28   2.75675043e+04  3.92703761e+04  1.57e-02 4.38e-04  4.31e-02    21s
  29   2.81722044e+04  3.87839843e+04  1.43e-02 3.98e-04  3.91e-02    21s
  30   2.92763545e+04  3.84825151e+04  1.18e-02 3.67e-04  3.39e-02    22s
  31   3.00233356e+04  3.78168703e+04  1.02e-02 3.00e-04  2.87e-02    22s
  32   3.10446640e+04  3.69399706e+04  7.91e-03 2.04e-04  2.17e-02    23s
  33   3.20372575e+04  3.65811872e+04  5.79e-03 1.70e-04  1.67e-02    24s
  34   3.26583638e+04  3.61169385e+04  4.46e-03 1.24e-04  1.27e-02    24s
  35   3.30699378e+04  3.57311243e+04  3.61e-03 8.49e-05  9.80e-03    25s
  36   3.33550209e+04  3.54677508e+04  3.03e-03 9.35e-05  7.78e-03    25s
  37   3.37173108e+04  3.53358277e+04  2.33e-03 7.03e-05  5.96e-03    26s
  38   3.41584279e+04  3.52093373e+04  1.44e-03 4.87e-05  3.87e-03    26s
  39   3.43482614e+04  3.51193603e+04  1.06e-03 3.44e-05  2.84e-03    27s
  40   3.45651379e+04  3.50895963e+04  6.54e-04 2.93e-05  1.93e-03    28s
  41   3.46927115e+04  3.50421988e+04  4.00e-04 2.14e-05  1.29e-03    28s
  42   3.47538033e+04  3.49669831e+04  2.83e-04 8.82e-06  7.85e-04    29s
  43   3.48137469e+04  3.49539594e+04  1.74e-04 6.71e-06  5.16e-04    29s
  44   3.48472118e+04  3.49302879e+04  1.12e-04 2.92e-06  3.06e-04    30s
  45   3.48573469e+04  3.49142183e+04  9.27e-05 2.89e-07  2.10e-04    30s
  46   3.48792361e+04  3.49131778e+04  5.30e-05 1.99e-07  1.25e-04    31s
  47   3.48864712e+04  3.49115891e+04  4.00e-05 6.40e-08  9.26e-05    31s
  48   3.49097424e+04  3.49105795e+04  1.53e-06 2.93e-07  3.08e-06    32s
  49   3.49100600e+04  3.49104964e+04  8.63e-07 6.51e-08  1.61e-06    32s
  50   3.49104731e+04  3.49104731e+04  2.73e-09 2.48e-09  1.27e-10    33s

Barrier solved model in 50 iterations and 32.86 seconds (15.33 work units)
Optimal objective 3.49104731e+04


Root crossover log...

  134449 DPushes remaining with DInf 0.0000000e+00                33s
   57197 DPushes remaining with DInf 0.0000000e+00                35s
    1514 DPushes remaining with DInf 0.0000000e+00                40s
       0 DPushes remaining with DInf 0.0000000e+00                41s

    1781 PPushes remaining with PInf 5.8929996e-06                41s
       0 PPushes remaining with PInf 0.0000000e+00                41s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.1481348e+00     41s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   59856    3.4910473e+04   0.000000e+00   1.148135e+00     41s
   59857    3.4910473e+04   0.000000e+00   0.000000e+00     42s
   59857    3.4910473e+04   0.000000e+00   0.000000e+00     42s
Concurrent spin time: 1.62s

Solved with barrier

Root relaxation: objective 3.491047e+04, 59857 iterations, 36.48 seconds (17.56 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 34910.4731    0  155 -210461.39 34910.4731   117%     -   43s
H    0     0                    -207930.1532 34910.4731   117%     -   43s
H    0     0                    -92197.59904 34910.4731   138%     -   44s
H    0     0                    -87240.22112 34910.4731   140%     -   44s
H    0     0                    -86319.90755 34910.4731   140%     -   44s
H    0     0                    -50613.66430 34910.4731   169%     -   44s
H    0     0                    -4629.692851 34910.4731   854%     -   44s
H    0     0                    -2037.668118 34910.4731  1813%     -   45s
H    0     0                    -1370.918173 34910.4731  2647%     -   45s
H    0     0                    -355.3337748 34910.4731  9925%     -   49s
     0     0 29753.9915    0  314 -355.33377 29753.9915  8474%     -  102s
H    0     0                     967.2934478 29753.7454  2976%     -  106s
     0     0 29466.2418    0  318  967.29345 29466.2418  2946%     -  130s
     0     0 29454.8166    0  304  967.29345 29454.8166  2945%     -  135s
     0     0 29422.9539    0  300  967.29345 29422.9539  2942%     -  140s
     0     0 29414.4026    0  301  967.29345 29414.4026  2941%     -  141s
     0     0 29409.5522    0  302  967.29345 29409.5522  2940%     -  144s
     0     0 29409.5455    0  302  967.29345 29409.5455  2940%     -  144s
     0     0 26270.3289    0  228  967.29345 26270.3289  2616%     -  200s
     0     0 25623.5754    0  354  967.29345 25623.5754  2549%     -  235s
     0     0 25419.6820    0  296  967.29345 25419.6820  2528%     -  254s
     0     0 25395.5002    0  306  967.29345 25395.5002  2525%     -  262s
     0     0 25200.4475    0  367  967.29345 25200.4475  2505%     -  281s
     0     0 25167.0988    0  308  967.29345 25167.0988  2502%     -  288s
     0     0 25156.7952    0  363  967.29345 25156.7952  2501%     -  294s
     0     0 25128.1470    0  369  967.29345 25128.1470  2498%     -  301s
     0     0 25116.0707    0  374  967.29345 25116.0707  2497%     -  306s
     0     0 25072.0775    0  378  967.29345 25072.0775  2492%     -  314s
     0     0 25067.8083    0  369  967.29345 25067.8083  2492%     -  317s
     0     0 25062.4035    0  301  967.29345 25062.4035  2491%     -  320s
     0     0 25061.9044    0  301  967.29345 25061.9044  2491%     -  321s
     0     0 22511.6184    0  400  967.29345 22511.6184  2227%     -  407s
     0     0 22065.6868    0  447  967.29345 22065.6868  2181%     -  451s
     0     0 21922.3227    0  445  967.29345 21922.3227  2166%     -  468s
     0     0 21856.7633    0  450  967.29345 21856.7633  2160%     -  483s
     0     0 21834.8229    0  455  967.29345 21834.8229  2157%     -  492s
     0     0 21788.8684    0  443  967.29345 21788.8684  2153%     -  505s
     0     0 21759.6659    0  450  967.29345 21759.6659  2150%     -  515s
     0     0 21625.2872    0  450  967.29345 21625.2872  2136%     -  535s
     0     0 21580.1944    0  459  967.29345 21580.1944  2131%     -  545s
     0     0 21544.2560    0  466  967.29345 21544.2560  2127%     -  555s
     0     0 21540.2632    0  474  967.29345 21540.2632  2127%     -  559s
     0     0 21524.5230    0  465  967.29345 21524.5230  2125%     -  564s
     0     0 21520.1177    0  469  967.29345 21520.1177  2125%     -  567s
     0     0 21517.8935    0  474  967.29345 21517.8935  2125%     -  568s
     0     0 21517.5750    0  473  967.29345 21517.5750  2125%     -  569s
     0     0 20201.7907    0  494  967.29345 20201.7907  1988%     -  657s
H    0     0                    1711.4340353 20201.5727  1080%     -  657s
H    0     0                    2000.5342909 20201.5727   910%     -  657s
H    0     0                    2041.7742868 20201.5727   889%     -  658s
     0     0 19887.9612    0  506 2041.77429 19887.9612   874%     -  693s
     0     0 19799.4221    0  507 2041.77429 19799.4221   870%     -  710s
     0     0 19625.2148    0  511 2041.77429 19625.2148   861%     -  733s
     0     0 19602.1568    0  496 2041.77429 19602.1568   860%     -  742s
     0     0 19576.9333    0  512 2041.77429 19576.9333   859%     -  751s
     0     0 19562.1181    0  512 2041.77429 19562.1181   858%     -  761s
     0     0 19544.7904    0  512 2041.77429 19544.7904   857%     -  772s
     0     0 19523.4590    0  525 2041.77429 19523.4590   856%     -  784s
     0     0 19508.9590    0  514 2041.77429 19508.9590   855%     -  790s
     0     0 19495.1759    0  548 2041.77429 19495.1759   855%     -  798s
     0     0 19491.4203    0  515 2041.77429 19491.4203   855%     -  802s
     0     0 19489.4497    0  515 2041.77429 19489.4497   855%     -  806s
     0     0 19145.6289    0  590 2041.77429 19145.6289   838%     -  847s
H    0     0                    2134.0015085 19145.5828   797%     -  850s
     0     0 18964.3050    0  556 2134.00151 18964.3050   789%     -  877s
     0     0 18880.4848    0  501 2134.00151 18880.4848   785%     -  895s
     0     0 18870.3750    0  504 2134.00151 18870.3750   784%     -  903s
     0     0 18853.3771    0  518 2134.00151 18853.3771   783%     -  911s
     0     0 18847.8405    0  524 2134.00151 18847.8405   783%     -  917s
     0     0 18843.5639    0  516 2134.00151 18843.5639   783%     -  922s
     0     0 18838.5425    0  575 2134.00151 18838.5425   783%     -  931s
     0     0 18836.9657    0  518 2134.00151 18836.9657   783%     -  935s
     0     0 18615.7640    0  590 2134.00151 18615.7640   772%     -  970s
     0     0 18564.3443    0  619 2134.00151 18564.3443   770%     -  987s
     0     0 18473.8178    0  599 2134.00151 18473.8178   766%     - 1000s
     0     0 18433.4471    0  615 2134.00151 18433.4471   764%     - 1014s
     0     0 18418.4298    0  649 2134.00151 18418.4298   763%     - 1024s
     0     0 18416.6908    0  648 2134.00151 18416.6908   763%     - 1027s
     0     0 18316.6422    0  554 2134.00151 18316.6422   758%     - 1053s
     0     0 18277.9975    0  519 2134.00151 18277.9975   757%     - 1075s
     0     0 18263.2362    0  510 2134.00151 18263.2362   756%     - 1083s
     0     0 18253.9093    0  568 2134.00151 18253.9093   755%     - 1090s
     0     0 18251.0056    0  559 2134.00151 18251.0056   755%     - 1095s
     0     0 18247.4663    0  565 2134.00151 18247.4663   755%     - 1099s
     0     0 18247.1124    0  515 2134.00151 18247.1124   755%     - 1101s
     0     0 18215.7099    0  561 2134.00151 18215.7099   754%     - 1114s
     0     0 18210.8470    0  568 2134.00151 18210.8470   753%     - 1120s
     0     0 18207.0557    0  564 2134.00151 18207.0557   753%     - 1124s
     0     0 18205.6150    0  527 2134.00151 18205.6150   753%     - 1126s
     0     0 18194.1523    0  564 2134.00151 18194.1523   753%     - 1138s
     0     0 18190.8890    0  566 2134.00151 18190.8890   752%     - 1144s
     0     0 18189.9720    0  583 2134.00151 18189.9720   752%     - 1147s
     0     0 18188.3474    0  572 2134.00151 18188.3474   752%     - 1152s
H    0     0                    2324.3443229 18188.2982   683%     - 1155s
H    0     0                    2335.0542955 18188.2982   679%     - 1155s
H    0     0                    2374.3128256 18188.2982   666%     - 1156s
H    0     0                    2381.5803951 18188.2982   664%     - 1156s
H    0     0                    2418.8332474 18188.2982   652%     - 1156s
     0     0 18187.8016    0  569 2418.83325 18187.8016   652%     - 1161s
     0     0 18185.7209    0  532 2418.83325 18185.7209   652%     - 1165s
     0     0 18185.6436    0  532 2418.83325 18185.6436   652%     - 1171s
H    0     0                    2432.5525878 18185.6344   648%     - 1222s
H    0     0                    2474.1552120 18185.6344   635%     - 1222s
H    0     0                    2718.8731672 18185.6344   569%     - 1223s
H    0     0                    2857.5949663 18185.6344   536%     - 1223s
H    0     0                    3064.6534076 18185.6344   493%     - 1389s
H    0     2                    3095.0527123 18185.6344   488%     - 1398s
     0     2 18185.6344    0  532 3095.05271 18185.6344   488%     - 1398s
     1     3 17911.9684    1  484 3095.05271 18185.6010   488% 24381 1438s
     2     4 18108.3542    1  552 3095.05271 18108.3542   485% 15482 1459s
     3     5 17099.4153    2  471 3095.05271 18108.3357   485% 14983 1500s
     4     9 17864.3583    2  502 3095.05271 18107.8569   485% 12914 1534s
     8    16 17183.9697    3  498 3095.05271 17863.2179   477% 11846 1613s
    15    31 17121.0360    4  498 3095.05271 17863.2179   477% 14056 1724s
    30    46 15063.6668    6  330 3095.05271 17183.8180   455% 19887 2067s
    45    77 16474.6551    5  542 3095.05271 17121.0333   453% 18635 2454s
H   55    77                    3171.6358288 17121.0333   440% 18195 2454s
    76   212 16398.4265    6  528 3171.63583 17121.0333   440% 16728 2829s
   211   290 16254.4932   10  496 3171.63583 17121.0333   440% 10692 2995s
H  212   290                    3188.9105813 17121.0333   437% 10642 2995s
H  224   290                    3357.2588164 17121.0333   410% 10290 2995s
   289   361 16178.5869   11  510 3357.25882 17121.0333   410%  8879 3142s
   360   421 10151.4263   22  173 3357.25882 17121.0333   410%  7887 3254s
H  367   421                    3371.3264800 17121.0333   408%  7775 3254s
H  381   421                    3390.4493042 17121.0333   405%  7571 3254s
   424   490 13558.8067   12  273 3390.44930 17121.0333   405%  7168 3360s
   497   508 9493.60139   15  202 3390.44930 17121.0333   405%  6593 3469s
   527   531 9077.69340   16  198 3390.44930 17121.0333   405%  6609 3581s
   572   537 8637.11195   17  186 3390.44930 17121.0333   405%  6463 3600s

Cutting planes:
  Gomory: 15
  Implied bound: 152
  MIR: 3555
  Flow cover: 3937
  RLT: 57
  Relax-and-lift: 863

Explored 580 nodes (4488443 simplex iterations) in 3600.18 seconds (4251.18 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 3390.45 3371.33 3357.26 ... 2474.16

Time limit reached
Best objective 3.390449304226e+03, best bound 1.712103331701e+04, gap 404.9783%
  WARNING: Time limit reached. Using best solution found (gap: 404.98%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.22s
  Master Objective (UB) = 3390.45, θ = 145370.70
  Upper Bound (UB) = 3390.45

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 145370.70
  [DEBUG]   ✓ Scenario 0: θ = 145370.70 ≤ Q = 145370.70 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 145370.70 ≤ Q = 145370.70 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 145370.70 ≤ Q = 145370.70 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 145370.70 ≤ Q = 145370.70 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 145370.70 ≤ Q = 145370.70 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 145370.70 ≤ Q = 145370.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 145370.70 ≤ Q = 145370.70 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 145370.70 ≤ Q = 145370.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 145370.70 ≤ Q = 145370.70 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 145370.70 ≤ Q = 145370.70 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 145370.70 ≤ Q = 145370.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 145370.70 ≤ Q = 145370.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 145370.70 ≤ Q = 145830.84 (slack: 460.14)
  [DEBUG]   ✓ Scenario 13: θ = 145370.70 ≤ Q = 145370.70 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 145370.70 ≤ Q = 145370.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 145370.70 ≤ Q = 145370.70 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 145370.70 ≤ Q = 145370.70 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 145370.70 ≤ Q = 145370.70 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 18] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x767f9416
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x89806bea
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [5e-01, 2e+02]
Found heuristic solution: objective 1.150567e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.00s
Presolved: 494 rows, 498 columns, 1393 nonzeros
Found heuristic solution: objective 5774466.4278
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.267830e+05, 241 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -126782.96    0  122 5774466.43 -126782.96   102%     -    0s
H    0     0                    -94720.92563 -126782.96  33.8%     -    0s
H    0     0                    -95203.99541 -126782.96  33.2%     -    0s
     0     0 -102417.80    0   87 -95203.995 -102417.80  7.58%     -    0s
H    0     0                    -100648.4727 -102295.07  1.64%     -    0s
H    0     0                    -100965.5638 -102295.07  1.32%     -    0s
     0     0 -101818.07    0   88 -100965.56 -101818.07  0.84%     -    0s
H    0     0                    -100988.2716 -101751.34  0.76%     -    0s
     0     0 -101518.40    0   88 -100988.27 -101518.40  0.52%     -    0s
     0     0 -101504.56    0   89 -100988.27 -101504.56  0.51%     -    0s
     0     0 -101230.09    0   45 -100988.27 -101230.09  0.24%     -    0s
     0     0 -101214.35    0   39 -100988.27 -101214.35  0.22%     -    0s
     0     0 -101214.06    0   38 -100988.27 -101214.06  0.22%     -    0s
     0     0 -101188.86    0   23 -100988.27 -101188.86  0.20%     -    0s
     0     0 -101181.13    0   22 -100988.27 -101181.13  0.19%     -    0s
     0     0 -101138.63    0   16 -100988.27 -101138.63  0.15%     -    0s
     0     0 -101125.17    0   15 -100988.27 -101125.17  0.14%     -    0s
     0     0 -101120.95    0   28 -100988.27 -101120.95  0.13%     -    0s
     0     0 -101043.27    0    8 -100988.27 -101043.27  0.05%     -    0s
     0     0 -101017.60    0    5 -100988.27 -101017.60  0.03%     -    0s
H    0     0                    -101003.8078 -101017.60  0.01%     -    0s

Cutting planes:
  Gomory: 1
  Implied bound: 2
  MIR: 1
  Flow cover: 2
  Relax-and-lift: 2

Explored 1 nodes (743 simplex iterations) in 0.25 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -101004 -100988 -100966 ... 1.15057e+13
No other solutions better than -101004

Optimal solution found (tolerance 1.00e-04)
Best objective -1.010038078163e+05, best bound -1.010038078163e+05, gap 0.0000%
  Subproblem solved in 0.27s
  Worst-case operational profit (Z_SP) = 141753.30
  Scenario: 25 demand increases, 35 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -101003.81
  [DEBUG]   S×d_nominal = 242757.10
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 242757.10 + -101003.81 = 141753.30
  [DEBUG]   Current θ from Master = 145370.70
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3617.41 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -226.96
  Lower Bound (LB) = 3127.61
  Gap (UB-LB) = 262.8431, Absolute Gap = 262.8431, Relative Gap = 0.077525
  Not converged yet (gap = 262.84 > ε = 200)

  [DEBUG] Adding NEW scenario 18 to Master Problem...
  [DEBUG] New scenario pattern: 25 increases, 35 decreases
    [DEBUG] Scenario 18 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 18 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 18]
    [DEBUG]   - Total constraints in model: 291893
    [DEBUG]   - Total variables in model: 120820
  [DEBUG] Total scenarios in Master: 19
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 19
================================================================================
[Iteration 19] Solving Master Problem...
  Current scenarios in Master: 19
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 291893 rows, 120820 columns and 826908 nonzeros
Model fingerprint: 0x3692d430
Variable types: 118561 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 134330 rows and 54530 columns (presolve time = 5s)...
Presolve removed 134330 rows and 54530 columns
Presolve time: 6.47s
Presolved: 157563 rows, 66290 columns, 970090 nonzeros
Variable types: 64031 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -363844.9763
Found heuristic solution: objective -210461.3866

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.53s

Barrier statistics:
 Dense cols : 596
 AA' NZ     : 9.411e+06
 Factor NZ  : 2.088e+07 (roughly 260 MB of memory)
 Factor Ops : 5.409e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.04661549e+07  2.49940846e+08  1.17e+05 1.72e+01  8.69e+04     9s
   1  -1.60014823e+07  2.28727780e+08  8.43e+04 5.37e+01  6.18e+04    10s
   2  -5.38939337e+06  1.77612394e+08  2.76e+04 2.54e+00  2.16e+04    10s
   3  -1.22697654e+06  1.34995272e+08  3.60e+03 1.26e+00  3.15e+03    10s
   4  -5.89038206e+05  8.58522268e+07  6.02e+02 4.84e-01  7.18e+02    11s
   5  -5.03100088e+05  4.38282983e+07  3.39e+02 1.87e-01  3.63e+02    11s
   6  -4.15173935e+05  3.25954378e+07  1.32e+02 1.28e-01  1.91e+02    11s
   7  -3.55834281e+05  2.46516477e+07  6.28e+01 8.97e-02  1.20e+02    11s
   8  -2.37866730e+05  1.67172566e+07  1.77e+01 5.60e-02  6.67e+01    12s
   9  -1.72846736e+05  1.10844500e+07  8.23e+00 3.55e-02  4.18e+01    12s
  10  -1.32024254e+05  8.33058695e+06  4.17e+00 2.62e-02  3.05e+01    12s
  11  -9.97217969e+04  2.15363918e+06  1.30e+00 6.44e-03  7.95e+00    13s
  12  -7.38577786e+04  6.55074911e+05  5.78e-01 2.01e-03  2.55e+00    13s
  13  -4.50416094e+04  3.42135434e+05  2.78e-01 1.19e-03  1.35e+00    13s
  14  -2.98843887e+04  2.40368097e+05  1.99e-01 1.09e-03  9.44e-01    14s
  15  -1.73878577e+04  1.71063336e+05  1.52e-01 1.95e-03  6.58e-01    14s
  16  -7.47718361e+03  1.16889237e+05  1.19e-01 3.43e-03  4.34e-01    14s
  17  -2.87515034e+02  9.50838660e+04  9.37e-02 3.15e-03  3.33e-01    15s
  18   4.72233558e+03  7.81217060e+04  7.79e-02 2.24e-03  2.56e-01    15s
  19   1.02155422e+04  6.37425601e+04  6.17e-02 3.43e-03  1.87e-01    16s
  20   1.35499054e+04  5.49388351e+04  5.19e-02 4.09e-03  1.45e-01    16s
  21   1.56742843e+04  4.97954428e+04  4.60e-02 3.30e-03  1.19e-01    17s
  22   1.86407730e+04  4.63243946e+04  3.84e-02 2.56e-03  9.67e-02    17s
  23   2.02200638e+04  4.41146330e+04  3.43e-02 2.14e-03  8.35e-02    18s
  24   2.17569361e+04  4.31828135e+04  3.06e-02 1.90e-03  7.48e-02    18s
  25   2.29437278e+04  4.02872860e+04  2.78e-02 1.33e-03  6.06e-02    18s
  26   2.63118877e+04  3.96804677e+04  1.98e-02 1.18e-03  4.67e-02    19s
  27   2.75620706e+04  3.83447172e+04  1.67e-02 7.32e-04  3.77e-02    19s
  28   2.80848044e+04  3.78831890e+04  1.55e-02 6.50e-04  3.42e-02    20s
  29   2.88649646e+04  3.75316232e+04  1.37e-02 5.68e-04  3.03e-02    20s
  30   2.97679681e+04  3.69969212e+04  1.16e-02 6.05e-04  2.53e-02    21s
  31   3.08284090e+04  3.66171000e+04  9.05e-03 4.72e-04  2.02e-02    21s
  32   3.13670937e+04  3.61295736e+04  7.79e-03 2.80e-04  1.66e-02    22s
  33   3.25496319e+04  3.59463156e+04  5.09e-03 2.56e-04  1.19e-02    22s
  34   3.26980703e+04  3.57583361e+04  4.75e-03 2.10e-04  1.07e-02    23s
  35   3.35165332e+04  3.56785662e+04  2.92e-03 1.89e-04  7.55e-03    23s
  36   3.37863173e+04  3.54271606e+04  2.33e-03 1.06e-04  5.73e-03    24s
  37   3.40426661e+04  3.52938412e+04  1.79e-03 7.75e-05  4.37e-03    24s
  38   3.43558634e+04  3.51862915e+04  1.15e-03 5.92e-05  2.90e-03    24s
  39   3.44569948e+04  3.51403823e+04  9.27e-04 4.88e-05  2.39e-03    25s
  40   3.45750248e+04  3.50660216e+04  6.72e-04 3.32e-05  1.71e-03    26s
  41   3.47173914e+04  3.50097022e+04  3.74e-04 2.26e-05  1.02e-03    26s
  42   3.47821186e+04  3.49769900e+04  2.39e-04 1.52e-05  6.80e-04    27s
  43   3.48393300e+04  3.49332467e+04  1.27e-04 4.80e-06  3.28e-04    27s
  44   3.48563313e+04  3.49273664e+04  9.68e-05 3.58e-06  2.48e-04    28s
  45   3.48947103e+04  3.49191669e+04  2.63e-05 1.72e-06  8.54e-05    28s
  46   3.49069665e+04  3.49138628e+04  5.39e-06 6.43e-07  2.41e-05    29s
  47   3.49084777e+04  3.49121976e+04  2.96e-06 3.20e-07  1.30e-05    29s
  48   3.49104075e+04  3.49105162e+04  6.62e-08 1.06e-07  3.79e-07    30s
  49   3.49104730e+04  3.49104731e+04  1.41e-09 3.50e-10  3.79e-10    30s

Barrier solved model in 49 iterations and 29.97 seconds (16.06 work units)
Optimal objective 3.49104730e+04


Root crossover log...

  141763 DPushes remaining with DInf 0.0000000e+00                30s
   21402 DPushes remaining with DInf 0.0000000e+00                35s
       0 DPushes remaining with DInf 0.0000000e+00                38s

    4799 PPushes remaining with PInf 5.1526658e-05                38s
       0 PPushes remaining with PInf 0.0000000e+00                39s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.1578882e+01     39s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   68312    3.4910473e+04   0.000000e+00   3.157888e+01     39s
   68321    3.4910473e+04   0.000000e+00   0.000000e+00     39s
   68321    3.4910473e+04   0.000000e+00   0.000000e+00     40s
Concurrent spin time: 0.02s

Solved with barrier

Root relaxation: objective 3.491047e+04, 68321 iterations, 31.97 seconds (20.63 work units)
Total elapsed time = 40.07s (DegenMoves)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 34910.4731    0  155 -210461.39 34910.4731   117%     -   40s
H    0     0                    -165390.5317 34910.4731   121%     -   40s
H    0     0                    -50613.66430 34910.4731   169%     -   42s
H    0     0                    -5874.395846 34910.4731   694%     -   45s
H    0     0                    -2108.037081 34910.4731  1756%     -   46s
H    0     0                    -1221.218904 34910.4731  2959%     -   46s
H    0     0                    -475.7372803 34910.4731  7438%     -   50s
H    0     0                    -422.4495048 34910.4731  8364%     -   50s
H    0     0                    -355.3337748 34910.4731  9925%     -   50s
     0     0 29981.5883    0  256 -355.33377 29981.5883  8538%     -  109s
H    0     0                      98.1644508 29980.2732      -     -  111s
H    0     0                     109.7838707 29980.2732      -     -  113s
H    0     0                     207.8621954 29980.2732      -     -  113s
H    0     0                     273.8139838 29980.2732      -     -  113s
H    0     0                     685.1582638 29980.2732  4276%     -  114s
H    0     0                     938.0255011 29980.2732  3096%     -  114s
     0     0 29714.6260    0  277  938.02550 29714.6260  3068%     -  134s
     0     0 29682.8354    0  271  938.02550 29682.8354  3064%     -  140s
     0     0 29626.7045    0  267  938.02550 29626.7045  3058%     -  149s
     0     0 29608.9821    0  274  938.02550 29608.9821  3057%     -  153s
     0     0 29496.3194    0  268  938.02550 29496.3194  3045%     -  161s
     0     0 29482.2468    0  269  938.02550 29482.2468  3043%     -  165s
     0     0 29482.1237    0  270  938.02550 29482.1237  3043%     -  166s
     0     0 26654.2920    0  270  938.02550 26654.2920  2742%     -  199s
H    0     0                    1194.4856332 26653.1594  2131%     -  201s
H    0     0                    1695.4924241 26653.1594  1472%     -  201s
H    0     0                    1740.2940737 26653.1594  1432%     -  202s
H    0     0                    1919.5857515 26653.1594  1288%     -  202s
H    0     0                    1966.1118510 26653.1594  1256%     -  202s
H    0     0                    1974.3209498 26653.1594  1250%     -  203s
H    0     0                    1974.7293809 26653.1594  1250%     -  203s
H    0     0                    2038.2485009 26653.1594  1208%     -  203s
     0     0 26373.2637    0  294 2038.24850 26373.2637  1194%     -  222s
     0     0 26307.5938    0  287 2038.24850 26307.5938  1191%     -  229s
     0     0 26262.8099    0  301 2038.24850 26262.8099  1188%     -  237s
     0     0 26174.6103    0  297 2038.24850 26174.6103  1184%     -  251s
     0     0 26161.9084    0  295 2038.24850 26161.9084  1184%     -  260s
     0     0 26124.6763    0  291 2038.24850 26124.6763  1182%     -  273s
     0     0 26114.8215    0  295 2038.24850 26114.8215  1181%     -  276s
     0     0 26013.9131    0  293 2038.24850 26013.9131  1176%     -  286s
     0     0 26009.2426    0  301 2038.24850 26009.2426  1176%     -  287s
     0     0 26009.1882    0  297 2038.24850 26009.1882  1176%     -  288s
     0     0 22663.9063    0  413 2038.24850 22663.9063  1012%     -  370s
     0     0 21846.0836    0  447 2038.24850 21846.0836   972%     -  423s
     0     0 21689.4070    0  441 2038.24850 21689.4070   964%     -  442s
     0     0 21584.9249    0  458 2038.24850 21584.9249   959%     -  461s
     0     0 21555.6943    0  454 2038.24850 21555.6943   958%     -  470s
     0     0 21534.1145    0  453 2038.24850 21534.1145   957%     -  477s
     0     0 21522.5996    0  460 2038.24850 21522.5996   956%     -  482s
     0     0 21478.5469    0  458 2038.24850 21478.5469   954%     -  490s
     0     0 21464.9108    0  471 2038.24850 21464.9108   953%     -  502s
     0     0 21442.3647    0  454 2038.24850 21442.3647   952%     -  512s
     0     0 21439.6643    0  459 2038.24850 21439.6643   952%     -  516s
     0     0 21420.5841    0  457 2038.24850 21420.5841   951%     -  522s
     0     0 21412.2648    0  456 2038.24850 21412.2648   951%     -  525s
     0     0 21410.3881    0  466 2038.24850 21410.3881   950%     -  527s
     0     0 21367.2006    0  452 2038.24850 21367.2006   948%     -  535s
     0     0 21294.3861    0  456 2038.24850 21294.3861   945%     -  544s
     0     0 21278.7479    0  463 2038.24850 21278.7479   944%     -  548s
     0     0 21277.2677    0  461 2038.24850 21277.2677   944%     -  550s
     0     0 19992.9527    0  496 2038.24850 19992.9527   881%     -  622s
H    0     0                    2417.5908532 19992.6262   727%     -  623s
H    0     0                    2431.8593625 19992.6262   722%     -  623s
     0     0 19564.2696    0  494 2431.85936 19564.2696   704%     -  678s
     0     0 19427.8985    0  501 2431.85936 19427.8985   699%     -  709s
     0     0 19376.4022    0  513 2431.85936 19376.4022   697%     -  724s
     0     0 19341.9357    0  517 2431.85936 19341.9357   695%     -  733s
     0     0 19297.8617    0  523 2431.85936 19297.8617   694%     -  744s
     0     0 19280.8686    0  521 2431.85936 19280.8686   693%     -  754s
     0     0 19275.2113    0  510 2431.85936 19275.2113   693%     -  759s
     0     0 19244.5098    0  508 2431.85936 19244.5098   691%     -  768s
     0     0 19211.6703    0  507 2431.85936 19211.6703   690%     -  778s
     0     0 19204.8612    0  513 2431.85936 19204.8612   690%     -  783s
     0     0 19202.1751    0  508 2431.85936 19202.1751   690%     -  785s
     0     0 19199.3303    0  512 2431.85936 19199.3303   689%     -  788s
     0     0 19196.8359    0  509 2431.85936 19196.8359   689%     -  791s
     0     0 19196.4117    0  520 2431.85936 19196.4117   689%     -  792s
     0     0 18992.0701    0  471 2431.85936 18992.0701   681%     -  825s
H    0     0                    2452.2307489 18991.7664   674%     -  827s
     0     0 18922.1211    0  422 2452.23075 18922.1211   672%     -  853s
     0     0 18897.2906    0  457 2452.23075 18897.2906   671%     -  864s
     0     0 18887.0135    0  456 2452.23075 18887.0135   670%     -  870s
     0     0 18880.9644    0  450 2452.23075 18880.9644   670%     -  875s
     0     0 18876.6796    0  449 2452.23075 18876.6796   670%     -  879s
     0     0 18875.9224    0  452 2452.23075 18875.9224   670%     -  881s
     0     0 18719.0173    0  573 2452.23075 18719.0173   663%     -  918s
     0     0 18661.7876    0  636 2452.23075 18661.7876   661%     -  963s
     0     0 18639.3274    0  562 2452.23075 18639.3274   660%     -  977s
     0     0 18628.4483    0  594 2452.23075 18628.4483   660%     -  989s
     0     0 18626.1403    0  485 2452.23075 18626.1403   660%     -  994s
     0     0 18623.8752    0  602 2452.23075 18623.8752   659%     - 1000s
     0     0 18556.5144    0  365 2452.23075 18556.5144   657%     - 1027s
     0     0 18534.5539    0  499 2452.23075 18534.5539   656%     - 1044s
     0     0 18520.8474    0  558 2452.23075 18520.8474   655%     - 1054s
     0     0 18505.8860    0  508 2452.23075 18505.8860   655%     - 1066s
     0     0 18496.5568    0  599 2452.23075 18496.5568   654%     - 1075s
     0     0 18486.7172    0  570 2452.23075 18486.7172   654%     - 1086s
     0     0 18482.6904    0  575 2452.23075 18482.6904   654%     - 1093s
     0     0 18481.0010    0  611 2452.23075 18481.0010   654%     - 1098s
     0     0 18450.8784    0  549 2452.23075 18450.8784   652%     - 1116s
     0     0 18440.3905    0  545 2452.23075 18440.3905   652%     - 1144s
     0     0 18437.8013    0  599 2452.23075 18437.8013   652%     - 1149s
     0     0 18428.7352    0  595 2452.23075 18428.7352   652%     - 1156s
     0     0 18426.2088    0  561 2452.23075 18426.2088   651%     - 1161s
     0     0 18424.5664    0  557 2452.23075 18424.5664   651%     - 1164s
     0     0 18400.4852    0  455 2452.23075 18400.4852   650%     - 1178s
     0     0 18394.4272    0  518 2452.23075 18394.4272   650%     - 1191s
     0     0 18384.7720    0  516 2452.23075 18384.7720   650%     - 1199s
     0     0 18380.4215    0  456 2452.23075 18380.4215   650%     - 1204s
     0     0 18370.3359    0  551 2452.23075 18370.3359   649%     - 1212s
     0     0 18362.4385    0  501 2452.23075 18362.4385   649%     - 1218s
     0     0 18360.8909    0  494 2452.23075 18360.8909   649%     - 1223s
     0     0 18346.3823    0  570 2452.23075 18346.3823   648%     - 1236s
     0     0 18342.6692    0  574 2452.23075 18342.6692   648%     - 1257s
     0     0 18341.2833    0  542 2452.23075 18341.2833   648%     - 1260s
     0     0 18336.4854    0  487 2452.23075 18336.4854   648%     - 1270s
     0     0 18334.6993    0  494 2452.23075 18334.6993   648%     - 1279s
     0     0 18327.9910    0  550 2452.23075 18327.9910   647%     - 1289s
H    0     0                    2505.1584420 18327.9185   632%     - 1350s
H    0     0                    2644.2450898 18327.9185   593%     - 1350s
H    0     0                    2726.8551224 18327.9185   572%     - 1384s
     0     0 18326.5883    0  494 2726.85512 18326.5883   572%     - 1399s
     0     0 18324.1231    0  494 2726.85512 18324.1231   572%     - 1406s
     0     0 18323.0044    0  608 2726.85512 18323.0044   572%     - 1416s
     0     0 18321.3364    0  609 2726.85512 18321.3364   572%     - 1422s
     0     0 18321.3035    0  609 2726.85512 18321.3035   572%     - 1429s
H    0     0                    3019.8645244 18321.3022   507%     - 1734s
H    0     0                    3117.1535287 18321.3022   488%     - 1871s
H    0     0                    3200.4197608 18321.3022   472%     - 1968s
H    0     0                    3243.5620956 18321.3022   465%     - 1968s
     0     2 18321.3022    0  609 3243.56210 18321.3022   465%     - 2035s
     1     4 18265.7658    1  533 3243.56210 18321.3022   465% 14507 2061s
     3     8 18164.9164    2  591 3243.56210 18265.3381   463% 14180 2124s
     7    15 17691.6021    3  580 3243.56210 18163.8516   460% 17885 2269s
    14    28 16707.9878    4  493 3243.56210 18163.5683   460% 22115 2487s
    27    41 16566.6290    5  405 3243.56210 17691.2992   445% 30923 3037s
    40    64 15048.1684    5  310 3243.56210 17255.5286   432% 26387 3601s

Cutting planes:
  Gomory: 12
  Implied bound: 271
  MIR: 3771
  Flow cover: 3851
  RLT: 84
  Relax-and-lift: 814
  BQP: 2

Explored 63 nodes (2275799 simplex iterations) in 3602.75 seconds (4650.69 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 3243.56 3200.42 3117.15 ... 2417.59

Time limit reached
Best objective 3.243562095638e+03, best bound 1.725552856941e+04, gap 431.9932%
  WARNING: Time limit reached. Using best solution found (gap: 431.99%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3602.82s
  Master Objective (UB) = 3243.56, θ = 145585.55
  Upper Bound (UB) = 3243.56

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 145585.55
  [DEBUG]   ✓ Scenario 0: θ = 145585.55 ≤ Q = 145585.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 145585.55 ≤ Q = 145585.55 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 145585.55 ≤ Q = 145585.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 145585.55 ≤ Q = 145585.55 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 145585.55 ≤ Q = 145585.55 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 145585.55 ≤ Q = 145585.55 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 145585.55 ≤ Q = 145585.55 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 145585.55 ≤ Q = 145585.55 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 145585.55 ≤ Q = 145585.55 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 145585.55 ≤ Q = 145585.55 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 145585.55 ≤ Q = 145585.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 145585.55 ≤ Q = 145585.55 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 145585.55 ≤ Q = 145585.55 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 145585.55 ≤ Q = 145585.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 145585.55 ≤ Q = 145585.55 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 145585.55 ≤ Q = 145585.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 145585.55 ≤ Q = 145585.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 145585.55 ≤ Q = 145585.55 (slack: 0.00)
  [DEBUG]   ✓ Scenario 18: θ = 145585.55 ≤ Q = 145585.55 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 19] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x4309f90
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xfbcf6070
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [5e-01, 2e+02]
Found heuristic solution: objective 1.160106e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.00s
Presolved: 494 rows, 498 columns, 1393 nonzeros
Found heuristic solution: objective 5734782.8030
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.272958e+05, 238 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -127295.76    0  122 5734782.80 -127295.76   102%     -    0s
H    0     0                    -95207.63150 -127295.76  33.7%     -    0s
H    0     0                    -95825.21047 -127295.76  32.8%     -    0s
     0     0 -105881.66    0   67 -95825.210 -105881.66  10.5%     -    0s
H    0     0                    -103405.8859 -105748.24  2.27%     -    0s
H    0     0                    -104425.0598 -105748.24  1.27%     -    0s
     0     0 -105287.15    0   91 -104425.06 -105287.15  0.83%     -    0s
H    0     0                    -104705.4514 -105286.54  0.55%     -    0s
     0     0 -105223.38    0   87 -104705.45 -105223.38  0.49%     -    0s
     0     0 -104951.21    0   48 -104705.45 -104951.21  0.23%     -    0s
     0     0 -104950.21    0   40 -104705.45 -104950.21  0.23%     -    0s
     0     0 -104887.73    0   51 -104705.45 -104887.73  0.17%     -    0s
     0     0 -104867.55    0   45 -104705.45 -104867.55  0.15%     -    0s
     0     0 -104825.82    0   32 -104705.45 -104825.82  0.11%     -    0s
     0     0 -104779.00    0   20 -104705.45 -104779.00  0.07%     -    0s
     0     0 -104742.68    0    6 -104705.45 -104742.68  0.04%     -    0s
     0     0 -104732.66    0    5 -104705.45 -104732.66  0.03%     -    0s
     0     0 -104718.86    0    6 -104705.45 -104718.86  0.01%     -    0s
H    0     0                    -104707.5552 -104718.86  0.01%     -    0s

Cutting planes:
  Implied bound: 2
  MIR: 2
  Flow cover: 1
  RLT: 2

Explored 1 nodes (680 simplex iterations) in 0.38 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 8: -104708 -104705 -104660 ... 1.16011e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.047075551833e+05, best bound -1.047121805894e+05, gap 0.0044%
  Subproblem solved in 0.42s
  Worst-case operational profit (Z_SP) = 139041.86
  Scenario: 27 demand increases, 33 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -104707.56
  [DEBUG]   S×d_nominal = 243749.42
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 243749.42 + -104707.56 = 139041.86
  [DEBUG]   Current θ from Master = 145585.55
  [DEBUG]   ⚠️  Z_SP ≤ θ by 6543.68 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -3300.12
  Lower Bound (LB) = 3127.61
  Gap (UB-LB) = 115.9559, Absolute Gap = 115.9559, Relative Gap = 0.035750
  *** CONVERGED (gap within tolerance) ***

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 19
Total Time: 60140.13s
Converged: True
Final Lower Bound: 3127.6062
Final Upper Bound: 3243.5621
Final Gap: 115.955852
Number of Critical Scenarios: 19
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [2] (1/3)
Product 1 Plants: [1] (1/3)
Product 2 Plants: [1] (1/3)
Total Plant Openings: 3
DCs Opened: [1, 3, 7, 9] (4/10)
Active Routes (Plant→DC): 11
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 2 customers  Mode 1: 7 customers  Mode 2: 41 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 19
Start Time: 2026-01-04 19:57:42
End Time: 2026-01-05 12:40:02
Total Time: 60140.13s
Optimal Value: 3127.61
Lower Bound: 3127.61
Upper Bound: 3243.56
Gap: 115.955852
Plants Opened: {0: [2], 1: [1], 2: [1]} (3 plants)
DCs Opened: [1, 3, 7, 9] (4 DCs)
================================================================================

Results saved to: result/DH_single_full_seed28_Mixed_gamma20_20260105_124002.csv

Total Execution Time: 60140.60 seconds
End Time: 2026-01-05 12:40:02

All tasks completed successfully!

