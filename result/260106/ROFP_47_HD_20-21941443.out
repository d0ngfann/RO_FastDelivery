
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 47
DI Scenario: HD
Start Time: 2026-01-06 02:44:46
================================================================================
Loading data from data/DH_data_full_seed47.pkl...

Applying DI scenario: HD
DI values:
  Product 0: ['1.000', '1.460', '2.133'] (k=0.934)
  Product 1: ['1.000', '1.484', '2.201'] (k=0.973)
  Product 2: ['1.000', '1.467', '2.152'] (k=0.945)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=982, max=1479
  DC capacity (MC): min=405, max=871

Demand Structure (s_rk matrix):
  Total customer-product pairs: 80/150 (46.7% sparse)
  Average products per customer: 1.60

Demand (only non-zero entries):
  Nominal (μ): min=8.18, max=34.85, count=80
  Deviation (μ̂): min=4.02, max=10.00

Costs:
  Plant fixed cost: min=5196, max=9410
  DC fixed cost: min=3328, max=5650
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.460', '2.133'] (k=0.934)
    Product 1: ['1.000', '1.484', '2.201'] (k=0.973)
    Product 2: ['1.000', '1.467', '2.152'] (k=0.945)
  MD:
    Product 0: ['1.000', '1.209', '1.462'] (k=0.468)
    Product 1: ['1.000', '1.310', '1.716'] (k=0.666)
    Product 2: ['1.000', '1.269', '1.609'] (k=0.587)
  LD:
    Product 0: ['1.000', '1.044', '1.090'] (k=0.107)
    Product 1: ['1.000', '1.116', '1.246'] (k=0.271)
    Product 2: ['1.000', '1.067', '1.139'] (k=0.161)
  Mixed:
    Product 0: ['1.000', '1.460', '2.133'] (k=0.934)
    Product 1: ['1.000', '1.310', '1.716'] (k=0.666)
    Product 2: ['1.000', '1.067', '1.139'] (k=0.161)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48750 nonzeros
Model fingerprint: 0xd38fbd2e
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 1e+03]
Presolve removed 11871 rows and 2871 columns
Presolve time: 0.08s
Presolved: 4802 rows, 5629 columns, 33384 nonzeros
Variable types: 3370 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -209144.8745
Found heuristic solution: objective -184137.6522

Root relaxation: objective 1.754556e+05, 5245 iterations, 0.26 seconds (0.47 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 175455.639    0  591 -184137.65 175455.639   195%     -    0s
H    0     0                    -181703.4906 175455.639   197%     -    0s
H    0     0                    -176659.3157 150009.167   185%     -    1s
     0     0 150009.167    0  867 -176659.32 150009.167   185%     -    1s
     0     0 149215.120    0  861 -176659.32 149215.120   184%     -    1s
     0     0 149091.108    0  863 -176659.32 149091.108   184%     -    1s
     0     0 149090.457    0  869 -176659.32 149090.457   184%     -    1s
     0     0 138806.364    0  724 -176659.32 138806.364   179%     -    2s
     0     0 138407.790    0  720 -176659.32 138407.790   178%     -    2s
     0     0 138380.808    0  728 -176659.32 138380.808   178%     -    2s
     0     0 138374.162    0  726 -176659.32 138374.162   178%     -    2s
     0     0 121298.588    0  422 -176659.32 121298.588   169%     -    3s
H    0     0                    -166891.2374 121297.762   173%     -    3s
H    0     0                    -158206.7734 119935.346   176%     -    4s
     0     0 119935.346    0  442 -158206.77 119935.346   176%     -    4s
H    0     0                    -157237.0340 119478.520   176%     -    4s
H    0     0                    -157080.0209 119478.520   176%     -    4s
H    0     0                    -129900.7639 119478.520   192%     -    4s
H    0     0                    -122573.3678 119478.520   197%     -    4s
H    0     0                    -90609.28011 119478.520   232%     -    4s
H    0     0                    -86804.45248 119478.520   238%     -    4s
H    0     0                    -78211.90750 119478.520   253%     -    4s
H    0     0                    -70884.51137 119478.520   269%     -    4s
H    0     0                    -36028.43109 119478.520   432%     -    4s
     0     0 119478.520    0  465 -36028.431 119478.520   432%     -    4s
H    0     0                    43380.236589 119361.344   175%     -    4s
     0     0 119361.344    0  467 43380.2366 119361.344   175%     -    4s
     0     0 119323.057    0  471 43380.2366 119323.057   175%     -    4s
     0     0 119294.667    0  502 43380.2366 119294.667   175%     -    4s
     0     0 119289.695    0  504 43380.2366 119289.695   175%     -    4s
     0     0 113511.833    0  565 43380.2366 113511.833   162%     -    5s
H    0     0                    43521.881009 112513.003   159%     -    5s
H    0     0                    43735.477223 112513.003   157%     -    5s
H    0     0                    43921.399794 112513.003   156%     -    5s
H    0     0                    43922.385451 112513.003   156%     -    5s
     0     0 112513.003    0  604 43922.3855 112513.003   156%     -    5s
H    0     0                    43946.183380 112092.231   155%     -    5s
H    0     0                    45138.134684 112092.231   148%     -    5s
H    0     0                    45429.185248 112092.231   147%     -    5s
H    0     0                    46080.893926 112092.231   143%     -    5s
H    0     0                    46092.803018 112092.231   143%     -    5s
H    0     0                    47007.310211 112092.231   138%     -    5s
H    0     0                    47946.364349 112092.231   134%     -    5s
H    0     0                    50671.933305 112092.231   121%     -    5s
H    0     0                    50837.743703 112092.231   120%     -    5s
H    0     0                    51582.927523 112092.231   117%     -    5s
H    0     0                    52211.111190 112092.231   115%     -    5s
H    0     0                    52315.684807 112092.231   114%     -    5s
H    0     0                    52355.397636 112092.231   114%     -    5s
H    0     0                    52388.247660 112092.231   114%     -    5s
H    0     0                    52519.889585 112092.231   113%     -    5s
H    0     0                    52581.323560 112092.231   113%     -    5s
     0     0 112092.231    0  599 52581.3236 112092.231   113%     -    5s
H    0     0                    52866.539130 112004.929   112%     -    6s
H    0     0                    53017.426058 112004.929   111%     -    6s
H    0     0                    53469.575101 112004.929   109%     -    6s
H    0     0                    53486.585883 112004.929   109%     -    6s
H    0     0                    53750.315894 112004.929   108%     -    6s
H    0     0                    53765.480601 112004.929   108%     -    6s
     0     0 112004.929    0  601 53765.4806 112004.929   108%     -    6s
     0     0 111972.361    0  683 53765.4806 111972.361   108%     -    6s
     0     0 111968.445    0  697 53765.4806 111968.445   108%     -    6s
     0     0 109804.134    0  450 53765.4806 109804.134   104%     -    6s
     0     0 109268.451    0  520 53765.4806 109268.451   103%     -    6s
     0     0 109167.890    0  511 53765.4806 109167.890   103%     -    6s
H    0     0                    54141.695138 109123.279   102%     -    6s
H    0     0                    54249.004839 109123.279   101%     -    6s
H    0     0                    54269.326539 109123.279   101%     -    6s
H    0     0                    54450.022532 109123.279   100%     -    6s
H    0     0                    54705.165061 109123.279  99.5%     -    6s
     0     0 109123.279    0  490 54705.1651 109123.279  99.5%     -    6s
     0     0 109117.354    0  500 54705.1651 109117.354  99.5%     -    6s
     0     0 107569.678    0  638 54705.1651 107569.678  96.6%     -    7s
     0     0 107358.603    0  517 54705.1651 107358.603  96.2%     -    7s
     0     0 107237.885    0  579 54705.1651 107237.885  96.0%     -    7s
     0     0 107213.479    0  550 54705.1651 107213.479  96.0%     -    7s
H    0     0                    55257.306530 106410.850  92.6%     -    8s
H    0     0                    55333.588433 106410.850  92.3%     -    8s
H    0     0                    55542.397867 106410.850  91.6%     -    8s
H    0     0                    55618.571209 106410.850  91.3%     -    8s
H    0     0                    55638.284973 106410.850  91.3%     -    8s
H    0     0                    55719.233778 106410.850  91.0%     -    8s
H    0     0                    55931.477337 106410.850  90.3%     -    8s
     0     0 106410.850    0  623 55931.4773 106410.850  90.3%     -    8s
H    0     0                    56092.972511 106198.586  89.3%     -    8s
H    0     0                    56110.604966 106198.586  89.3%     -    8s
H    0     0                    56124.753532 106198.586  89.2%     -    8s
     0     0 106198.586    0  666 56124.7535 106198.586  89.2%     -    8s
     0     0 106166.326    0  682 56124.7535 106166.326  89.2%     -    8s
     0     0 105403.949    0  604 56124.7535 105403.949  87.8%     -    9s
     0     0 105206.423    0  598 56124.7535 105206.423  87.5%     -    9s
     0     0 105107.213    0  698 56124.7535 105107.213  87.3%     -   10s
     0     0 105080.181    0  633 56124.7535 105080.181  87.2%     -   10s
H    0     0                    56202.373395 104642.336  86.2%     -   10s
H    0     0                    56580.208499 104642.336  84.9%     -   10s
     0     0 104642.336    0  621 56580.2085 104642.336  84.9%     -   10s
     0     0 104460.606    0  577 56580.2085 104460.606  84.6%     -   11s
     0     0 104391.613    0  650 56580.2085 104391.613  84.5%     -   11s
     0     0 104382.575    0  678 56580.2085 104382.575  84.5%     -   11s
     0     0 104092.087    0  579 56580.2085 104092.087  84.0%     -   11s
     0     0 104023.989    0  541 56580.2085 104023.989  83.9%     -   11s
     0     0 103997.562    0  552 56580.2085 103997.562  83.8%     -   12s
     0     0 103754.726    0  646 56580.2085 103754.726  83.4%     -   12s
     0     0 103754.454    0  646 56580.2085 103754.454  83.4%     -   12s
     0     2 103754.168    0  646 56580.2085 103754.168  83.4%     -   13s
    15    32 102606.781    4  672 56580.2085 103326.180  82.6%  1582   15s
H  328   362                    56669.977843 103004.362  81.8%   813   20s
H  361   447                    56738.986166 103004.362  81.5%   788   20s
H  369   447                    56901.881398 103004.362  81.0%   796   20s
H  375   447                    56944.564680 103004.362  80.9%   796   20s
H  396   447                    57057.468488 103004.362  80.5%   789   20s
H  424   447                    57512.252114 103004.362  79.1%   772   20s
H  531   591                    57544.491398 103004.362  79.0%   750   22s
H  533   591                    58275.266324 103004.362  76.8%   749   22s
H  538   591                    58289.610164 103004.362  76.7%   751   22s
H  693   760                    58297.861993 103004.362  76.7%   731   24s
H  694   760                    58802.756613 103004.362  75.2%   731   24s
H  736   760                    58887.066992 103004.362  74.9%   726   24s
   872   995 93458.6536   16  651 58887.0670 103004.362  74.9%   671   25s
H 1163  1283                    59062.810194 103004.362  74.4%   567   26s
H 1169  1283                    59102.257932 103004.362  74.3%   565   26s
H 1245  1283                    59116.333127 103004.362  74.2%   541   26s
  2111  2168 89395.3535   24  564 59116.3331 102603.771  73.6%   446   30s
H 2340  2229                    59118.807586 102403.382  73.2%   446   31s
H 2547  2581                    59129.095913 102403.382  73.2%   443   32s
H 2691  2581                    59166.456793 102359.518  73.0%   431   32s
H 3034  2998                    60313.491420 102359.518  69.7%   416   34s
  3208  3275 84150.3924   32  428 60313.4914 102359.518  69.7%   410   35s
H 3256  3267                    60667.382327 102359.518  68.7%   408   35s
H 3287  3251                    61309.959453 102359.518  67.0%   406   35s
H 3779  3678                    61311.178767 102184.260  66.7%   382   36s
H 3803  3678                    61332.568464 102184.260  66.6%   380   36s
H 3806  3678                    61333.440080 102184.260  66.6%   381   36s
H 3873  3678                    61360.297725 102184.260  66.5%   380   36s
H 3883  3669                    61582.110988 102184.260  65.9%   381   36s
H 3941  3479                    64331.397552 102184.260  58.8%   378   36s
H 3970  3426                    64845.816964 102184.260  57.6%   379   36s
H 4071  3433                    64855.953526 102184.260  57.6%   389   38s
H 4074  3425                    64902.701219 102184.260  57.4%   390   38s
H 4080  3393                    65094.228999 102184.260  57.0%   391   38s
H 4111  3578                    65152.111926 102184.260  56.8%   395   39s
  4304  3759 67839.1548   60  226 65152.1119 102184.260  56.8%   397   41s
H 4306  3751                    65285.669786 102184.260  56.5%   397   41s
H 4333  3744                    65419.589363 102184.260  56.2%   396   41s
H 4402  3730                    65500.920165 102184.260  56.0%   394   41s
H 4557  3820                    65517.641627 102184.260  56.0%   397   42s
H 4663  3817                    65549.325750 101817.347  55.3%   405   43s
H 4663  3808                    65630.974211 101817.347  55.1%   405   44s
H 4663  3779                    65852.977845 101817.347  54.6%   405   44s
H 4663  3123                    69839.955898 101817.347  45.8%   405   44s
H 4663  3123                    69840.096724 101817.347  45.8%   405   44s
  4664  3120 73052.0323   76  646 69840.0967 101817.347  45.8%   405   48s
  4674  3127 73051.2927   27  348 69840.0967 98214.7460  40.6%   404   50s
  4722  3168 90263.1373   17  330 69840.0967 91968.1327  31.7%   404   55s
H 4821  3115                    70539.559764 90049.6682  27.7%   407   55s
H 4829  2961                    74814.548982 90049.6682  20.4%   407   55s
H 4840  2814                    75416.690357 90049.6682  19.4%   407   55s
H 4856  2673                    75953.385669 90049.6682  18.6%   407   55s
H 4952  2558                    76119.779039 88717.0861  16.5%   404   56s
H 4970  2429                    76370.909659 88717.0861  16.2%   403   56s
H 5058  2316                    76516.756686 88717.0861  15.9%   401   56s
H 5058  2205                    77543.196307 88717.0861  14.4%   401   56s
H 5192  2064                    77633.933769 88368.5337  13.8%   396   57s
H 5241  1948                    77881.429330 88368.5337  13.5%   395   57s
H 5309  1868                    77890.982196 88368.5337  13.5%   392   57s
H 5321  1774                    77981.719658 88368.5337  13.3%   391   57s
H 5667  1670                    78001.677806 86824.2056  11.3%   381   58s
  6432  1534 80035.9451   29  222 78001.6778 83223.3828  6.69%   358   60s
H 6755  1338                    78094.726189 82988.3305  6.27%   349   61s
* 8997    43              48    78103.393916 78333.8277  0.30%   286   64s

Cutting planes:
  Gomory: 2
  Implied bound: 15
  Projected implied bound: 11
  MIR: 142
  Mixing: 1
  Flow cover: 337
  RLT: 23
  Relax-and-lift: 55

Explored 9056 nodes (2625307 simplex iterations) in 64.72 seconds (147.07 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 78103.4 78094.7 78001.7 ... 76119.8

Optimal solution found (tolerance 1.00e-04)
Best objective 7.810339391559e+04, best bound 7.810339391559e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 64.72s
  Master Objective (UB) = 78103.39, θ = 258487.16
  Upper Bound (UB) = 78103.39

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 258487.16
  [DEBUG]   ✓ Scenario 0: θ = 258487.16 ≤ Q = 258487.16 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x13cc1b8f
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xec33e471
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 1e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.398198e+13
Presolve removed 2599 rows and 1890 columns
Presolve time: 0.00s
Presolved: 494 rows, 499 columns, 1393 nonzeros
Found heuristic solution: objective 6706386.6874
Variable types: 339 continuous, 160 integer (160 binary)

Root relaxation: objective -1.790869e+05, 250 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -179086.88    0  123 6706386.69 -179086.88   103%     -    0s
H    0     0                    -144749.7006 -179086.88  23.7%     -    0s
H    0     0                    -145044.9314 -179086.88  23.5%     -    0s
H    0     0                    -145663.6793 -179086.88  22.9%     -    0s
H    0     0                    -147835.1062 -147835.11  0.00%     -    0s
     0     0          -    0      -147835.11 -147835.11  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 203

Explored 1 nodes (380 simplex iterations) in 0.01 seconds (0.01 work units)
Thread count was 32 (of 64 available processors)

Solution count 6: -147835 -145664 -145045 ... 1.3982e+13
No other solutions better than -147835

Optimal solution found (tolerance 1.00e-04)
Best objective -1.478351062053e+05, best bound -1.478351062053e+05, gap 0.0000%
  Subproblem solved in 0.03s
  Worst-case operational profit (Z_SP) = 225633.91
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -147835.11
  [DEBUG]   S×d_nominal = 373469.02
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 373469.02 + -147835.11 = 225633.91
  [DEBUG]   Current θ from Master = 258487.16
  [DEBUG]   ⚠️  Z_SP ≤ θ by 32853.25 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 45250.14
  Lower Bound (LB) = 45250.14
  Gap (UB-LB) = 32853.2512, Absolute Gap = 32853.2512, Relative Gap = 0.420638
  Not converged yet (gap = 32853.25 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 91981 nonzeros
Model fingerprint: 0xd1c4bb18
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 45250.1 (0.01s)
MIP start from previous solve produced solution with objective 45250.1 (0.01s)
Loaded MIP start from previous solve with objective 45250.1

Presolve removed 14201 rows and 5760 columns
Presolve time: 0.30s
Presolved: 17762 rows, 8980 columns, 98298 nonzeros
Variable types: 6721 continuous, 2259 integer (2259 binary)

Root relaxation: objective 9.906386e+04, 9601 iterations, 0.96 seconds (1.89 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 99063.8578    0  288 45250.1427 99063.8578   119%     -    1s
H    0     0                    49902.112547 99063.8578  98.5%     -    1s
H    0     0                    51143.121036 99063.8578  93.7%     -    1s
H    0     0                    51409.247138 99063.8578  92.7%     -    1s
H    0     0                    51559.192909 99063.8578  92.1%     -    1s
H    0     0                    51745.814331 99063.8578  91.4%     -    1s
     0     0 89011.3824    0  295 51745.8143 89011.3824  72.0%     -    2s
H    0     0                    51911.962536 89011.1353  71.5%     -    2s
H    0     0                    51974.595557 89011.1353  71.3%     -    2s
H    0     0                    52308.431278 89011.1353  70.2%     -    2s
H    0     0                    52418.989279 89011.1353  69.8%     -    2s
H    0     0                    52559.538024 89011.1353  69.4%     -    2s
     0     0 88544.2682    0  293 52559.5380 88544.2682  68.5%     -    2s
     0     0 88535.8235    0  301 52559.5380 88535.8235  68.4%     -    2s
     0     0 88533.0367    0  305 52559.5380 88533.0367  68.4%     -    2s
     0     0 83598.6094    0  319 52559.5380 83598.6094  59.1%     -    3s
H    0     0                    52813.726498 83577.7876  58.3%     -    3s
H    0     0                    52985.310051 83577.7876  57.7%     -    3s
H    0     0                    53430.693244 83577.7876  56.4%     -    3s
H    0     0                    53675.985171 83577.7876  55.7%     -    3s
H    0     0                    53774.001500 83577.7876  55.4%     -    3s
H    0     0                    53786.085106 83577.7876  55.4%     -    3s
H    0     0                    53803.746429 83577.7876  55.3%     -    3s
H    0     0                    53828.560870 83577.7876  55.3%     -    3s
H    0     0                    53846.222193 83577.7876  55.2%     -    3s
     0     0 82856.8990    0  377 53846.2222 82856.8990  53.9%     -    4s
     0     0 82697.3104    0  325 53846.2222 82697.3104  53.6%     -    4s
     0     0 82620.4419    0  375 53846.2222 82620.4419  53.4%     -    4s
     0     0 82569.0201    0  381 53846.2222 82569.0201  53.3%     -    4s
     0     0 82565.5471    0  331 53846.2222 82565.5471  53.3%     -    4s
     0     0 82562.7871    0  383 53846.2222 82562.7871  53.3%     -    4s
     0     0 79162.3833    0  338 53846.2222 79162.3833  47.0%     -    6s
H    0     0                    54033.281215 79162.2951  46.5%     -    6s
     0     0 78764.2741    0  374 54033.2812 78764.2741  45.8%     -    6s
     0     0 78604.4993    0  375 54033.2812 78604.4993  45.5%     -    6s
     0     0 78559.4641    0  386 54033.2812 78559.4641  45.4%     -    6s
     0     0 78526.7660    0  391 54033.2812 78526.7660  45.3%     -    6s
     0     0 78522.8400    0  384 54033.2812 78522.8400  45.3%     -    6s
     0     0 76712.2115    0  378 54033.2812 76712.2115  42.0%     -    8s
H    0     0                    54263.718648 76711.9518  41.4%     -    8s
H    0     0                    54476.577756 76711.9518  40.8%     -    8s
     0     0 76368.5137    0  403 54476.5778 76368.5137  40.2%     -    9s
     0     0 76309.7001    0  397 54476.5778 76309.7001  40.1%     -    9s
     0     0 76299.7384    0  400 54476.5778 76299.7384  40.1%     -    9s
     0     0 76292.2659    0  402 54476.5778 76292.2659  40.0%     -    9s
     0     0 76288.9236    0  399 54476.5778 76288.9236  40.0%     -    9s
     0     0 75767.5915    0  431 54476.5778 75767.5915  39.1%     -   10s
H    0     0                    54583.517081 75764.6517  38.8%     -   10s
     0     0 75699.1955    0  492 54583.5171 75699.1955  38.7%     -   10s
     0     0 75672.3806    0  503 54583.5171 75672.3806  38.6%     -   10s
     0     0 75669.6743    0  503 54583.5171 75669.6743  38.6%     -   10s
     0     0 75511.4210    0  349 54583.5171 75511.4210  38.3%     -   11s
     0     0 75460.5322    0  340 54583.5171 75460.5322  38.2%     -   11s
     0     0 75436.5079    0  358 54583.5171 75436.5079  38.2%     -   11s
     0     0 75433.7177    0  365 54583.5171 75433.7177  38.2%     -   11s
     0     0 75376.7280    0  362 54583.5171 75376.7280  38.1%     -   12s
H    0     0                    54735.079865 75375.1157  37.7%     -   12s
     0     0 75366.4304    0  379 54735.0799 75366.4304  37.7%     -   12s
     0     0 75361.0886    0  376 54735.0799 75361.0886  37.7%     -   12s
     0     0 75339.6785    0  344 54735.0799 75339.6785  37.6%     -   12s
H    0     0                    54748.121265 75335.3782  37.6%     -   13s
     0     0 75332.1415    0  344 54748.1213 75332.1415  37.6%     -   13s
     0     0 75330.2704    0  354 54748.1213 75330.2704  37.6%     -   13s
     0     0 75300.1013    0  353 54748.1213 75300.1013  37.5%     -   13s
     0     0 75298.6191    0  353 54748.1213 75298.6191  37.5%     -   13s
     0     2 75298.5782    0  353 54748.1213 75298.5782  37.5%     -   17s
    31    64 73550.8280    5  358 54748.1213 74548.7252  36.2%  1149   20s
H   34    64                    54766.873516 74548.7252  36.1%  1100   20s
H   37    64                    54809.703102 74548.7252  36.0%  1077   20s
H   45    64                    54903.718940 74548.7252  35.8%  1008   20s
H   95   188                    54987.579549 73550.5121  33.8%   911   22s
H  159   188                    55019.390606 73550.5121  33.7%   697   22s
H  176   188                    55039.345036 73550.5121  33.6%   657   22s
H  201   241                    55098.151268 73550.5121  33.5%   655   24s
   240   316 71522.2232    9  397 55098.1513 73550.5121  33.5%   616   25s
H  376   405                    55224.579402 73550.5121  33.2%   600   26s
H  496   525                    55593.267777 73550.5121  32.3%   611   27s
H  605   664                    55613.222923 73550.5121  32.3%   598   29s
H  618   664                    55828.491961 73550.5121  31.7%   607   29s
H  633   664                    55888.935088 73550.5121  31.6%   600   29s
H  636   664                    55895.058389 73550.5121  31.6%   600   29s
   673   744 67790.2810   14  483 55895.0584 73550.5121  31.6%   578   30s
  1120  1086 66543.6727   18  404 55895.0584 73362.1840  31.2%   517   35s
H 1578  1479                    55906.079759 73001.0342  30.6%   508   39s
  1619  1605 58489.5343   24  325 55906.0798 73001.0342  30.6%   505   40s
H 1747  1734                    55984.444138 73001.0342  30.4%   490   41s
H 1795  1734                    55999.884526 73001.0342  30.4%   484   41s
H 2093  2000                    56055.583368 73001.0342  30.2%   463   43s
H 2189  2032                    56186.748060 73001.0342  29.9%   455   43s
H 2250  2157                    56186.967858 73001.0342  29.9%   450   44s
H 2269  2157                    56195.841347 73001.0342  29.9%   449   44s
H 2360  2157                    56199.032237 73001.0342  29.9%   443   44s
  2382  2320 60491.2769   33  268 56199.0322 73001.0342  29.9%   441   45s
H 2416  2319                    56205.855227 73001.0342  29.9%   438   45s
H 2642  2429                    56229.681649 73001.0342  29.8%   424   46s
H 2703  2429                    56240.221819 73001.0342  29.8%   423   46s
H 3114  2926                    56265.725995 73001.0342  29.7%   395   48s
H 3122  2926                    56271.307559 73001.0342  29.7%   395   48s
H 3145  2926                    56286.009601 73001.0342  29.7%   394   48s
  3662  3100 60788.9647   51  353 56286.0096 72738.2078  29.2%   365   57s
  3665  3102 67659.6881   16  255 56286.0096 72738.2078  29.2%   365   60s
  3684  3115 68146.9779   18  412 56286.0096 72738.2078  29.2%   363   65s
  3698  3124 59925.5977   25  391 56286.0096 72375.4769  28.6%   362   70s
  3703  3130 71588.4966   10  376 56286.0096 72062.2287  28.0%   369   75s
  3912  3273 62966.8657   17  294 56286.0096 67681.0122  20.2%   383   80s
  4273  3329 58865.7545   22  188 56286.0096 66524.5935  18.2%   387   85s
H 4680  3171                    56467.223469 65339.5027  15.7%   390   89s
  4770  3179 62921.4317   20  223 56467.2235 65277.1655  15.6%   390   90s
  5389  3147     cutoff   26      56467.2235 64344.4173  14.0%   387   95s
H 6213  2876                    56565.065168 63434.3024  12.1%   379   98s
H 6225  2731                    56616.887820 63314.4120  11.8%   379   98s
H 6226  2595                    56763.338353 63314.4120  11.5%   379   98s
H 6283  2448                    57213.906361 63314.4120  10.7%   379   98s
H 6299  2322                    57675.700529 63314.4120  9.78%   380   98s
  6514  2219     cutoff   24      57675.7005 62728.4668  8.76%   379  100s
H 7451  1642                    57810.485676 61668.9241  6.67%   377  103s
  7862  1297     cutoff   24      57810.4857 61126.6637  5.74%   375  105s
H10165  1445                    57915.602244 59336.9006  2.45%   315  107s
*11180  2185              74    57972.547375 59111.9912  1.97%   289  108s
H12230  2750                    58148.842602 58637.5761  0.84%   267  108s
H12536  2750                    58201.678756 58637.5761  0.75%   262  108s
*14200  2367              90    58217.815694 58582.0793  0.63%   234  109s
H15165  2367                    58255.960637 58579.7917  0.56%   221  109s
*16013  2432              71    58307.723729 58492.4928  0.32%   211  109s
*16708  2432              66    58371.513506 58486.8217  0.20%   203  109s
 18057    17 58403.5728   63    4 58371.5135 58438.9659  0.12%   189  110s

Cutting planes:
  Learned: 1
  Gomory: 3
  MIR: 219
  Mixing: 1
  Flow cover: 558
  RLT: 3
  Relax-and-lift: 43

Explored 19870 nodes (3458417 simplex iterations) in 110.30 seconds (295.88 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 58371.5 58307.7 58256 ... 57675.7

Optimal solution found (tolerance 1.00e-04)
Best objective 5.837151350571e+04, best bound 5.837151350571e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 110.31s
  Master Objective (UB) = 58371.51, θ = 203652.21
  Upper Bound (UB) = 58371.51

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 203652.21
  [DEBUG]   ✓ Scenario 0: θ = 203652.21 ≤ Q = 203652.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 203652.21 ≤ Q = 203652.21 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x1d79fcd2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x1d79fcd2
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [8e-13, 1e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e-14, 2e+02]
Found heuristic solution: objective 1.407691e+13
Presolve removed 2606 rows and 1897 columns
Presolve time: 0.00s
Presolved: 487 rows, 492 columns, 1377 nonzeros
Found heuristic solution: objective 6884457.9793
Variable types: 333 continuous, 159 integer (159 binary)
Found heuristic solution: objective 6884007.2368

Root relaxation: objective -1.683472e+05, 239 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -168347.25    0  126 6884007.24 -168347.25   102%     -    0s
H    0     0                    -149496.6343 -168347.25  12.6%     -    0s
H    0     0                    -149674.7043 -168140.58  12.3%     -    0s
H    0     0                    -149932.2185 -156931.80  4.67%     -    0s
     0     0 -156931.80    0   99 -149932.22 -156931.80  4.67%     -    0s
H    0     0                    -152846.8874 -156800.60  2.59%     -    0s
H    0     0                    -153168.3046 -156800.60  2.37%     -    0s
H    0     0                    -154431.7903 -156800.60  1.53%     -    0s
H    0     0                    -154747.3577 -156800.60  1.33%     -    0s
     0     0 -156800.60    0   96 -154747.36 -156800.60  1.33%     -    0s
     0     0 -156367.39    0   93 -154747.36 -156367.39  1.05%     -    0s
     0     0 -156169.87    0   91 -154747.36 -156169.87  0.92%     -    0s
     0     0 -155758.75    0   82 -154747.36 -155758.75  0.65%     -    0s
     0     0 -155737.24    0   81 -154747.36 -155737.24  0.64%     -    0s
     0     0 -155737.24    0   79 -154747.36 -155737.24  0.64%     -    0s
     0     0 -155523.41    0   74 -154747.36 -155523.41  0.50%     -    0s
     0     0 -155441.75    0   79 -154747.36 -155441.75  0.45%     -    0s
     0     0 -155432.75    0   79 -154747.36 -155432.75  0.44%     -    0s
H    0     0                    -154758.9155 -155225.05  0.30%     -    0s
     0     0 -155225.05    0   72 -154758.92 -155225.05  0.30%     -    0s
     0     0 -155209.58    0   50 -154758.92 -155209.58  0.29%     -    0s
     0     0 -155207.01    0   50 -154758.92 -155207.01  0.29%     -    0s
     0     0 -155131.09    0   50 -154758.92 -155131.09  0.24%     -    0s
     0     0 -155108.91    0   48 -154758.92 -155108.91  0.23%     -    0s
     0     0 -155066.49    0   57 -154758.92 -155066.49  0.20%     -    0s
     0     0 -155059.60    0   53 -154758.92 -155059.60  0.19%     -    0s
     0     0 -155056.31    0   52 -154758.92 -155056.31  0.19%     -    0s
     0     0 -155053.80    0   52 -154758.92 -155053.80  0.19%     -    0s
     0     0 -155053.45    0   44 -154758.92 -155053.45  0.19%     -    0s
     0     0 -155051.52    0   61 -154758.92 -155051.52  0.19%     -    0s
     0     0 -155051.52    0   35 -154758.92 -155051.52  0.19%     -    0s
H    0     0                    -154764.6219 -155051.52  0.19%     -    0s
     0     0 -154937.85    0   32 -154764.62 -154937.85  0.11%     -    0s
     0     0 -154934.54    0   31 -154764.62 -154934.54  0.11%     -    0s
     0     0 -154866.82    0   32 -154764.62 -154866.82  0.07%     -    0s
     0     0 -154854.98    0   26 -154764.62 -154854.98  0.06%     -    0s
     0     0 -154852.57    0   25 -154764.62 -154852.57  0.06%     -    0s
     0     0 -154832.07    0   22 -154764.62 -154832.07  0.04%     -    0s
     0     0 -154820.44    0    8 -154764.62 -154820.44  0.04%     -    0s
     0     0 -154817.55    0    8 -154764.62 -154817.55  0.03%     -    0s
H    0     0                    -154793.6220 -154817.55  0.02%     -    0s
     0     0          -    0      -154793.62 -154807.61  0.01%     -    0s

Cutting planes:
  Gomory: 14
  Implied bound: 11
  MIR: 12
  Flow cover: 18
  RLT: 22
  Relax-and-lift: 4

Explored 1 nodes (1304 simplex iterations) in 0.15 seconds (0.09 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -154794 -154765 -154759 ... 6.88401e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.547936219562e+05, best bound -1.548076063461e+05, gap 0.0090%
  Subproblem solved in 0.16s
  Worst-case operational profit (Z_SP) = 181056.25
  Scenario: 43 demand increases, 17 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -154793.62
  [DEBUG]   S×d_nominal = 335849.87
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 335849.87 + -154793.62 = 181056.25
  [DEBUG]   Current θ from Master = 203652.21
  [DEBUG]   ⚠️  Z_SP ≤ θ by 22595.96 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 35775.55
  Lower Bound (LB) = 45250.14
  Gap (UB-LB) = 13121.3708, Absolute Gap = 13121.3708, Relative Gap = 0.224791
  Not converged yet (gap = 13121.37 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 43 increases, 17 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135212 nonzeros
Model fingerprint: 0x6be45c18
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 35775.6 (0.02s)
MIP start from previous solve produced solution with objective 35775.6 (0.02s)
Loaded MIP start from previous solve with objective 35775.6

Presolve removed 21270 rows and 8640 columns
Presolve time: 0.40s
Presolved: 25983 rows, 12340 columns, 159869 nonzeros
Variable types: 10081 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...

Concurrent spin time: 0.07s

Solved with dual simplex

Root relaxation: objective 8.737001e+04, 15181 iterations, 3.03 seconds (6.03 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 87370.0139    0  121 35775.5531 87370.0139   144%     -    3s
H    0     0                    40542.660999 87370.0139   116%     -    3s
H    0     0                    43123.198462 87370.0139   103%     -    3s
H    0     0                    46055.674368 87370.0139  89.7%     -    3s
H    0     0                    46129.858676 87370.0139  89.4%     -    3s
H    0     0                    46265.264229 87370.0139  88.8%     -    3s
     0     0 81627.8673    0  158 46265.2642 81627.8673  76.4%     -    5s
     0     0 81184.5655    0  164 46265.2642 81184.5655  75.5%     -    5s
     0     0 81183.1802    0  171 46265.2642 81183.1802  75.5%     -    5s
     0     0 81183.1802    0  172 46265.2642 81183.1802  75.5%     -    5s
     0     0 81183.1802    0  170 46265.2642 81183.1802  75.5%     -    5s
     0     0 78756.1483    0  225 46265.2642 78756.1483  70.2%     -    6s
H    0     0                    50371.326874 78755.6743  56.4%     -    6s
H    0     0                    50854.382631 78755.6743  54.9%     -    6s
     0     0 78048.8012    0  227 50854.3826 78048.8012  53.5%     -    7s
     0     0 77937.6657    0  220 50854.3826 77937.6657  53.3%     -    7s
     0     0 77911.7957    0  231 50854.3826 77911.7957  53.2%     -    7s
     0     0 77907.8679    0  235 50854.3826 77907.8679  53.2%     -    7s
     0     0 77906.2417    0  234 50854.3826 77906.2417  53.2%     -    7s
     0     0 77905.7616    0  236 50854.3826 77905.7616  53.2%     -    7s
     0     0 76040.2732    0  288 50854.3826 76040.2732  49.5%     -    9s
     0     0 75542.3198    0  292 50854.3826 75542.3198  48.5%     -    9s
     0     0 75313.9687    0  303 50854.3826 75313.9687  48.1%     -   10s
     0     0 75190.1481    0  304 50854.3826 75190.1481  47.9%     -   10s
     0     0 75161.9601    0  306 50854.3826 75161.9601  47.8%     -   10s
     0     0 75145.2306    0  304 50854.3826 75145.2306  47.8%     -   10s
     0     0 75138.0418    0  308 50854.3826 75138.0418  47.8%     -   10s
     0     0 75133.5158    0  302 50854.3826 75133.5158  47.7%     -   10s
     0     0 75133.2177    0  307 50854.3826 75133.2177  47.7%     -   10s
     0     0 74362.6248    0  319 50854.3826 74362.6248  46.2%     -   12s
     0     0 74024.2835    0  323 50854.3826 74024.2835  45.6%     -   13s
     0     0 73877.2906    0  339 50854.3826 73877.2906  45.3%     -   13s
     0     0 73845.2165    0  335 50854.3826 73845.2165  45.2%     -   13s
     0     0 73835.2657    0  329 50854.3826 73835.2657  45.2%     -   13s
     0     0 73834.5890    0  329 50854.3826 73834.5890  45.2%     -   13s
     0     0 73667.1959    0  349 50854.3826 73667.1959  44.9%     -   14s
     0     0 73540.0569    0  346 50854.3826 73540.0569  44.6%     -   14s
     0     0 73518.2537    0  345 50854.3826 73518.2537  44.6%     -   14s
     0     0 73512.2680    0  344 50854.3826 73512.2680  44.6%     -   14s
     0     0 73509.9819    0  349 50854.3826 73509.9819  44.5%     -   14s
     0     0 73505.0464    0  353 50854.3826 73505.0464  44.5%     -   14s
     0     0 73504.2832    0  355 50854.3826 73504.2832  44.5%     -   14s
     0     0 73440.2568    0  357 50854.3826 73440.2568  44.4%     -   15s
     0     0 73407.9432    0  353 50854.3826 73407.9432  44.3%     -   15s
     0     0 73400.9344    0  349 50854.3826 73400.9344  44.3%     -   15s
     0     0 73399.8296    0  351 50854.3826 73399.8296  44.3%     -   15s
     0     0 73284.4401    0  341 50854.3826 73284.4401  44.1%     -   16s
H    0     0                    50914.569194 73260.2740  43.9%     -   16s
H    0     0                    50920.163744 73260.2740  43.9%     -   16s
H    0     0                    50921.976396 73260.2740  43.9%     -   16s
     0     0 73260.2740    0  342 50921.9764 73260.2740  43.9%     -   16s
     0     0 73252.7346    0  350 50921.9764 73252.7346  43.9%     -   16s
     0     0 73250.8668    0  356 50921.9764 73250.8668  43.8%     -   16s
     0     0 73250.1390    0  356 50921.9764 73250.1390  43.8%     -   16s
     0     0 73236.2622    0  360 50921.9764 73236.2622  43.8%     -   17s
     0     0 73229.7695    0  356 50921.9764 73229.7695  43.8%     -   17s
     0     0 73229.7338    0  361 50921.9764 73229.7338  43.8%     -   17s
     0     0 73210.0563    0  360 50921.9764 73210.0563  43.8%     -   18s
     0     0 73196.8404    0  372 50921.9764 73196.8404  43.7%     -   18s
     0     0 73192.8920    0  375 50921.9764 73192.8920  43.7%     -   18s
     0     0 73189.8395    0  373 50921.9764 73189.8395  43.7%     -   18s
     0     0 73189.5191    0  370 50921.9764 73189.5191  43.7%     -   18s
     0     0 73185.4831    0  370 50921.9764 73185.4831  43.7%     -   19s
H    0     0                    51036.277746 73185.3268  43.4%     -   19s
H    0     0                    51123.067320 73185.3268  43.2%     -   19s
H    0     0                    51156.131772 73185.3268  43.1%     -   19s
H    0     0                    51191.090656 73185.3268  43.0%     -   19s
H    0     0                    51193.396489 73185.3268  43.0%     -   19s
     0     0 73184.8355    0  368 51193.3965 73184.8355  43.0%     -   19s
     0     0 73179.8123    0  368 51193.3965 73179.8123  42.9%     -   19s
H    0     0                    51220.130832 73178.8248  42.9%     -   19s
     0     0 73177.2039    0  362 51220.1308 73177.2039  42.9%     -   19s
     0     0 73175.2445    0  377 51220.1308 73175.2445  42.9%     -   19s
     0     0 73174.7618    0  358 51220.1308 73174.7618  42.9%     -   19s
     0     0 73172.1107    0  359 51220.1308 73172.1107  42.9%     -   20s
     0     0 73170.7828    0  361 51220.1308 73170.7828  42.9%     -   20s
     0     0 73165.2361    0  349 51220.1308 73165.2361  42.8%     -   20s
     0     0 73164.8745    0  349 51220.1308 73164.8745  42.8%     -   20s
H    0     0                    51491.810913 73163.9900  42.1%     -   24s
     0     2 73163.9900    0  349 51491.8109 73163.9900  42.1%     -   24s
     1     4 73112.1997    1  339 51491.8109 73160.6099  42.1%  1967   25s
    15    32 72524.3013    4  344 51491.8109 73012.4492  41.8%  2122   30s
H   31    64                    51604.107521 72521.7202  40.5%  2510   31s
H   32    64                    51747.985684 72521.7202  40.1%  2450   31s
H   34    64                    51821.999636 72521.7202  39.9%  2340   31s
   127   168 69336.0709    8  341 51821.9996 72410.6446  39.7%  1322   35s
   308   339 69467.3861   14  335 51821.9996 72410.6446  39.7%   982   41s
H  357   375                    51911.291034 72410.6446  39.5%  1009   43s
   378   433 69440.9086   15  340 51911.2910 72410.6446  39.5%   997   45s
   578   619 65321.5414   18  329 51911.2910 72233.4304  39.1%  1048   51s
   788   747 64643.1987   20  300 51911.2910 71707.0824  38.1%  1079   56s
   910   857 64625.8963   21  295 51911.2910 71707.0824  38.1%  1132   60s
  1318  1224 60258.2376   29  234 51911.2910 71707.0824  38.1%  1009   67s
  1647  1513 57765.4454   33  291 51911.2910 70706.9652  36.2%   928   71s
  1957  1683 52539.9611   36  243 51911.2910 70706.9652  36.2%   870   75s
  2282  1827 62955.3747   10  272 51911.2910 70706.9652  36.2%   851   80s
  2407  1904 60308.8633   13  250 51911.2910 70293.2366  35.4%   848   85s
H 2488  1927                    51941.730218 70289.3375  35.3%   850   86s
  2691  2109 54672.5018   23  174 51941.7302 70289.3375  35.3%   836   91s
  2999  2232 63297.0359   12  307 51941.7302 69632.5714  34.1%   822   95s
  3283  2492 61124.4017   14  280 51941.7302 69616.4721  34.0%   824  100s
  3713  2659 53037.4959   28  349 51941.7302 69438.5246  33.7%   803  110s
  3715  2660 54214.5901   37  121 51941.7302 69438.5246  33.7%   802  115s
  3717  2662 57615.9578   39  335 51941.7302 69438.5246  33.7%   802  120s
  3725  2667 57022.6256   24  351 51941.7302 69438.5246  33.7%   800  125s
  3734  2673 61519.0524   25  378 51941.7302 69438.5246  33.7%   798  130s
H 3734  2539                    51966.712410 69438.5246  33.6%   798  130s
  3740  2543 52812.1132   63  367 51966.7124 69438.5246  33.6%   797  139s
  3741  2544 67141.5581   11  367 51966.7124 69438.5246  33.6%   797  142s
  3744  2551 69438.5246   12  250 51966.7124 69438.5246  33.6%   812  147s
  3756  2571 69438.5246   14  251 51966.7124 69438.5246  33.6%   818  152s
  3804  2619 63542.8212   16  264 51966.7124 68876.7260  32.5%   852  160s
  3868  2667 59728.2459   18  316 51966.7124 68876.7260  32.5%   936  165s
  3953  2733 56392.5594   20  290 51966.7124 68876.7260  32.5%   969  170s
  4102  2779 infeasible   22      51966.7124 68736.0239  32.3%   997  176s
  4265  2795     cutoff   27      51966.7124 67950.6837  30.8%  1019  180s
H 4293  2658                    52046.548920 67950.6837  30.6%  1023  180s
  4482  2675 56130.7923   21  169 52046.5489 67773.6680  30.2%  1028  186s
  4633  2687 53132.4767   22  189 52046.5489 67592.4953  29.9%  1038  191s
  4822  2681 52744.5033   23  137 52046.5489 67592.4953  29.9%  1041  195s
  5011  2690 61319.7924   19  224 52046.5489 67592.4953  29.9%  1048  200s
  5331  2681 57111.9153   24  194 52046.5489 66847.1450  28.4%  1055  207s
H 5446  2550                    52116.804568 66847.1450  28.3%  1059  209s
H 5484  2422                    52117.626457 66847.1450  28.3%  1059  209s
  5513  2453 53331.2143   28  131 52117.6265 65541.8370  25.8%  1060  211s
  5766  2444 55740.3992   21  196 52117.6265 64400.5015  23.6%  1064  215s
  6077  2408 55637.9318   21  234 52117.6265 63536.5199  21.9%  1063  221s
  6388  2367 57748.2720   21  229 52117.6265 62753.2118  20.4%  1066  226s
H 6440  2241                    52124.111694 62520.6178  19.9%  1066  226s
H 6465  2129                    52134.529288 62517.2820  19.9%  1067  226s
  6682  2114     cutoff   27      52134.5293 62382.3373  19.7%  1061  232s
  6909  2062     cutoff   28      52134.5293 62329.2041  19.6%  1053  235s
H 7253  1864                    52194.890837 61637.1594  18.1%  1048  238s
  7271  1898 53979.2598   20  206 52194.8908 61637.1594  18.1%  1047  241s
  7480  1840 59259.3348   22  240 52194.8908 61637.1594  18.1%  1046  245s
  7839  1791 56654.2745   23  256 52194.8908 61448.2426  17.7%  1051  253s
  8102  1731     cutoff   27      52194.8908 61448.2426  17.7%  1050  256s
  8401  1690 57730.2645   24  188 52194.8908 60746.1365  16.4%  1048  260s
  9059  1565 56257.9655   24  255 52194.8908 60231.5034  15.4%  1041  268s
  9400  1505 57152.1427   19  271 52194.8908 60065.0645  15.1%  1039  273s
  9783  1521     cutoff   24      52194.8908 59654.4253  14.3%  1034  277s
H 9869  1521                    52224.314375 59616.2075  14.2%  1034  277s
 10019  1552 53054.8646   27   78 52224.3144 59428.6172  13.8%  1034  281s
 10425  1576 53979.4986   20  253 52224.3144 59232.2340  13.4%  1029  286s
H10435  1576                    52260.257851 59232.2340  13.3%  1029  286s
 10728  1583     cutoff   25      52260.2579 59108.9271  13.1%  1028  291s
 11162  1596 54700.0328   24  224 52260.2579 58671.1770  12.3%  1025  297s
 11589  1603     cutoff   25      52260.2579 58445.6038  11.8%  1024  302s
 12036  1594 54229.0436   23  207 52260.2579 58263.4344  11.5%  1023  307s
 12519  1537 55507.8815   22  222 52260.2579 58160.6347  11.3%  1021  314s
 12976  1548 54002.6931   25  188 52260.2579 58067.3767  11.1%  1017  319s
 13492  1507 53966.6206   25  231 52260.2579 57642.3361  10.3%  1016  325s
 14055  1438 52768.6131   22  230 52260.2579 57399.9076  9.83%  1012  331s
 14655  1359     cutoff   23      52260.2579 57115.1559  9.29%  1007  337s
 15266  1281 infeasible   24      52260.2579 56779.5987  8.65%  1004  343s
H15268  1281                    52287.004753 56779.5987  8.59%  1004  343s
H15382  1281                    52300.937934 56745.0077  8.50%  1002  343s
H15703  1281                    52320.939008 56604.4511  8.19%   999  343s
 15731  1155     cutoff   24      52320.9390 56557.0618  8.10%   999  349s
 16460  1011     cutoff   24      52320.9390 56221.9335  7.46%   992  356s
 17193   771 53638.0035   22  234 52320.9390 55828.4460  6.70%   986  362s
 18023   508     cutoff   22      52320.9390 55516.0733  6.11%   977  368s
 19449  1473     cutoff   31      52320.9390 54590.9166  4.34%   937  373s
*20231  1473              97    52366.508735 54473.6276  4.02%   904  373s
H21532  1473                    52385.307849 54299.3637  3.65%   856  373s
 22566  2972     cutoff   66      52385.3078 53277.1406  1.70%   820  375s
*23155  2972              87    52419.926056 53277.1406  1.64%   800  375s
*25124  2972              46    52746.336460 53236.5552  0.93%   741  375s

Cutting planes:
  Gomory: 1
  MIR: 300
  Mixing: 5
  Flow cover: 807
  RLT: 6
  Relax-and-lift: 63

Explored 28114 nodes (18738449 simplex iterations) in 375.95 seconds (1255.33 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 52746.3 52419.9 52385.3 ... 52134.5

Optimal solution found (tolerance 1.00e-04)
Best objective 5.274633645983e+04, best bound 5.274633645983e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 375.97s
  Master Objective (UB) = 52746.34, θ = 226699.77
  Upper Bound (UB) = 52746.34

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 226699.77
  [DEBUG]   ✓ Scenario 0: θ = 226699.77 ≤ Q = 226699.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 226699.77 ≤ Q = 226699.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 226699.77 ≤ Q = 226699.77 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x6e6c7fd1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x9193802f
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 1e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [5e-14, 2e+02]
Found heuristic solution: objective 1.397694e+13
Presolve removed 2600 rows and 1891 columns
Presolve time: 0.00s
Presolved: 493 rows, 498 columns, 1395 nonzeros
Found heuristic solution: objective 6685849.4225
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.834733e+05, 259 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -183473.28    0  130 6685849.42 -183473.28   103%     -    0s
H    0     0                    -141229.6665 -183473.28  29.9%     -    0s
H    0     0                    -142036.2786 -183473.28  29.2%     -    0s
H    0     0                    -151656.3939 -183473.28  21.0%     -    0s
H    0     0                    -162431.4037 -183473.28  13.0%     -    0s
     0     0 -171530.30    0   93 -162431.40 -171530.30  5.60%     -    0s
H    0     0                    -164008.8775 -171514.04  4.58%     -    0s
     0     0 -170596.54    0   85 -164008.88 -170596.54  4.02%     -    0s
     0     0 -170588.20    0   85 -164008.88 -170588.20  4.01%     -    0s
H    0     0                    -168369.6634 -170588.20  1.32%     -    0s
H    0     0                    -169339.7483 -170588.20  0.74%     -    0s
     0     0 -170245.99    0   75 -169339.75 -170245.99  0.54%     -    0s
H    0     0                    -169369.8146 -170233.03  0.51%     -    0s
     0     0 -170219.91    0   75 -169369.81 -170219.91  0.50%     -    0s
     0     0 -169981.66    0   43 -169369.81 -169981.66  0.36%     -    0s
H    0     0                    -169374.5285 -169942.28  0.34%     -    0s
     0     0 -169863.96    0   35 -169374.53 -169863.96  0.29%     -    0s
     0     0 -169860.91    0   40 -169374.53 -169860.91  0.29%     -    0s
     0     0 -169615.82    0   38 -169374.53 -169615.82  0.14%     -    0s
     0     0 -169604.02    0   31 -169374.53 -169604.02  0.14%     -    0s
     0     0 -169592.75    0   25 -169374.53 -169592.75  0.13%     -    0s
     0     0 -169582.39    0   24 -169374.53 -169582.39  0.12%     -    0s
     0     0 -169546.70    0   22 -169374.53 -169546.70  0.10%     -    0s
     0     0 -169536.15    0   20 -169374.53 -169536.15  0.10%     -    0s
     0     0 -169518.35    0   21 -169374.53 -169518.35  0.08%     -    0s
     0     0 -169497.48    0   18 -169374.53 -169497.48  0.07%     -    0s
     0     0 -169491.49    0   17 -169374.53 -169491.49  0.07%     -    0s
     0     0 -169442.84    0   19 -169374.53 -169442.84  0.04%     -    0s
     0     0 -169442.84    0   16 -169374.53 -169442.84  0.04%     -    0s
     0     0 -169398.45    0   14 -169374.53 -169398.45  0.01%     -    0s
     0     0 -169397.44    0   13 -169374.53 -169397.44  0.01%     -    0s
     0     0 -169395.51    0   12 -169374.53 -169395.51  0.01%     -    0s
     0     0 -169392.83    0   10 -169374.53 -169392.83  0.01%     -    0s

Cutting planes:
  Gomory: 6
  MIR: 7
  Flow cover: 3

Explored 1 nodes (926 simplex iterations) in 0.09 seconds (0.06 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -169375 -169370 -169340 ... 1.39769e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.693745285057e+05, best bound -1.693901569877e+05, gap 0.0092%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 204094.49
  Scenario: 35 demand increases, 25 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -169374.53
  [DEBUG]   S×d_nominal = 373469.02
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 373469.02 + -169374.53 = 204094.49
  [DEBUG]   Current θ from Master = 226699.77
  [DEBUG]   ⚠️  Z_SP ≤ θ by 22605.28 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 30141.05
  Lower Bound (LB) = 45250.14
  Gap (UB-LB) = 7496.1938, Absolute Gap = 7496.1938, Relative Gap = 0.142118
  Not converged yet (gap = 7496.19 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 35 increases, 25 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178443 nonzeros
Model fingerprint: 0x598301a2
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 30141.1 (0.08s)
Loaded MIP start from previous solve with objective 30141.1

Presolve removed 28340 rows and 11510 columns
Presolve time: 0.54s
Presolved: 34203 rows, 15710 columns, 211379 nonzeros
Variable types: 13451 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 34203 rows, 15710 columns, 211379 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   51200    5.9476831e+04   0.000000e+00   1.433643e+07      5s
Concurrent spin time: 0.07s

Solved with dual simplex

Root relaxation: objective 8.735840e+04, 21079 iterations, 5.45 seconds (11.35 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 87358.3982    0  125 30141.0540 87358.3982   190%     -    6s
H    0     0                    44818.428996 87358.3982  94.9%     -    6s
H    0     0                    45425.118676 87358.3982  92.3%     -    6s
H    0     0                    46683.508480 87358.3982  87.1%     -    6s
     0     0 80380.2164    0  163 46683.5085 80380.2164  72.2%     -    8s
     0     0 79974.9925    0  171 46683.5085 79974.9925  71.3%     -    9s
     0     0 79723.2602    0  173 46683.5085 79723.2602  70.8%     -    9s
     0     0 79665.8192    0  170 46683.5085 79665.8192  70.7%     -    9s
     0     0 79663.9637    0  172 46683.5085 79663.9637  70.6%     -   10s
     0     0 76452.0160    0  268 46683.5085 76452.0160  63.8%     -   12s
H    0     0                    48171.968863 76450.9644  58.7%     -   12s
     0     0 75990.4652    0  253 48171.9689 75990.4652  57.7%     -   13s
     0     0 75926.9575    0  250 48171.9689 75926.9575  57.6%     -   13s
     0     0 75893.5727    0  256 48171.9689 75893.5727  57.5%     -   13s
     0     0 75887.0518    0  260 48171.9689 75887.0518  57.5%     -   13s
     0     0 75885.0015    0  260 48171.9689 75885.0015  57.5%     -   13s
     0     0 75884.3770    0  260 48171.9689 75884.3770  57.5%     -   13s
     0     0 73928.7908    0  334 48171.9689 73928.7908  53.5%     -   17s
H    0     0                    48185.084444 73928.4255  53.4%     -   17s
H    0     0                    48802.336011 73640.1231  50.9%     -   18s
H    0     0                    48844.470238 73640.1231  50.8%     -   18s
H    0     0                    49135.730435 73640.1231  49.9%     -   18s
H    0     0                    49178.993505 73640.1231  49.7%     -   18s
     0     0 73640.1231    0  367 49178.9935 73640.1231  49.7%     -   18s
     0     0 73477.6617    0  371 49178.9935 73477.6617  49.4%     -   18s
H    0     0                    49295.976673 73434.2748  49.0%     -   19s
     0     0 73434.2748    0  372 49295.9767 73434.2748  49.0%     -   19s
     0     0 73379.1739    0  383 49295.9767 73379.1739  48.9%     -   19s
     0     0 73367.4749    0  379 49295.9767 73367.4749  48.8%     -   19s
     0     0 73364.6961    0  381 49295.9767 73364.6961  48.8%     -   19s
     0     0 73363.9725    0  385 49295.9767 73363.9725  48.8%     -   19s
     0     0 72454.3746    0  380 49295.9767 72454.3746  47.0%     -   24s
     0     0 72142.9406    0  380 49295.9767 72142.9406  46.3%     -   25s
     0     0 72083.7889    0  386 49295.9767 72083.7889  46.2%     -   26s
     0     0 72057.9322    0  395 49295.9767 72057.9322  46.2%     -   26s
     0     0 72047.3459    0  397 49295.9767 72047.3459  46.2%     -   27s
     0     0 72012.2668    0  394 49295.9767 72012.2668  46.1%     -   27s
     0     0 72002.8114    0  391 49295.9767 72002.8114  46.1%     -   27s
     0     0 71998.8368    0  393 49295.9767 71998.8368  46.1%     -   27s
     0     0 71998.7849    0  396 49295.9767 71998.7849  46.1%     -   27s
     0     0 71626.1492    0  396 49295.9767 71626.1492  45.3%     -   30s
H    0     0                    50611.360103 71461.2825  41.2%     -   32s
     0     0 71461.2825    0  397 50611.3601 71461.2825  41.2%     -   32s
     0     0 71432.0452    0  401 50611.3601 71432.0452  41.1%     -   33s
     0     0 71406.3127    0  405 50611.3601 71406.3127  41.1%     -   33s
     0     0 71389.7404    0  420 50611.3601 71389.7404  41.1%     -   33s
     0     0 71384.3668    0  416 50611.3601 71384.3668  41.0%     -   34s
     0     0 71381.4243    0  416 50611.3601 71381.4243  41.0%     -   34s
     0     0 71381.0514    0  423 50611.3601 71381.0514  41.0%     -   34s
     0     0 71249.6971    0  394 50611.3601 71249.6971  40.8%     -   35s
     0     0 71213.5499    0  394 50611.3601 71213.5499  40.7%     -   37s
     0     0 71201.3011    0  397 50611.3601 71201.3011  40.7%     -   37s
     0     0 71196.7268    0  395 50611.3601 71196.7268  40.7%     -   37s
     0     0 71195.9479    0  397 50611.3601 71195.9479  40.7%     -   37s
     0     0 71159.2200    0  385 50611.3601 71159.2200  40.6%     -   38s
     0     0 71140.5932    0  411 50611.3601 71140.5932  40.6%     -   39s
     0     0 71135.8638    0  410 50611.3601 71135.8638  40.6%     -   40s
     0     0 71133.9945    0  418 50611.3601 71133.9945  40.5%     -   40s
     0     0 71113.4360    0  410 50611.3601 71113.4360  40.5%     -   41s
     0     0 71102.4631    0  441 50611.3601 71102.4631  40.5%     -   41s
     0     0 71100.2823    0  460 50611.3601 71100.2823  40.5%     -   42s
     0     0 71099.4739    0  460 50611.3601 71099.4739  40.5%     -   42s
     0     0 71071.6361    0  446 50611.3601 71071.6361  40.4%     -   43s
     0     0 71066.8912    0  417 50611.3601 71066.8912  40.4%     -   43s
     0     0 71063.4336    0  449 50611.3601 71063.4336  40.4%     -   44s
     0     0 71062.1552    0  457 50611.3601 71062.1552  40.4%     -   44s
H    0     0                    50870.410289 71062.1552  39.7%     -   44s
     0     0 71054.2564    0  468 50870.4103 71054.2564  39.7%     -   45s
     0     0 71047.9561    0  427 50870.4103 71047.9561  39.7%     -   46s
     0     0 71036.4033    0  434 50870.4103 71036.4033  39.6%     -   46s
     0     0 71034.9002    0  429 50870.4103 71034.9002  39.6%     -   47s
     0     0 71030.4571    0  468 50870.4103 71030.4571  39.6%     -   48s
     0     0 71028.9416    0  471 50870.4103 71028.9416  39.6%     -   48s
     0     0 71020.8901    0  504 50870.4103 71020.8901  39.6%     -   49s
H    0     0                    50894.545649 71020.4034  39.5%     -   50s
H    0     0                    51074.603149 71020.4034  39.1%     -   50s
     0     0 71019.5166    0  499 51074.6031 71019.5166  39.1%     -   50s
     0     0 71016.1949    0  506 51074.6031 71016.1949  39.0%     -   50s
     0     0 71014.4171    0  482 51074.6031 71014.4171  39.0%     -   51s
     0     0 71009.3105    0  446 51074.6031 71009.3105  39.0%     -   51s
     0     0 71009.0337    0  446 51074.6031 71009.0337  39.0%     -   52s
H    0     0                    51240.811090 71008.9472  38.6%     -   63s
H    0     0                    51264.946450 71008.9472  38.5%     -   63s
     0     2 71008.9472    0  446 51264.9465 71008.9472  38.5%     -   64s
     1     4 70989.9236    1  425 51264.9465 71008.6140  38.5%  1305   65s
     7    16 70583.0466    3  496 51264.9465 70962.0007  38.4%  3081   71s
    15    32 70410.6922    4  439 51264.9465 70581.7065  37.7%  4462   75s
    31    59 68700.9397    5  422 51264.9465 70409.3086  37.3%  5639   83s
    58    91 67762.6164    6  305 51264.9465 70409.3086  37.3%  6277   86s
    90   123 67599.7167    7  295 51264.9465 70409.3086  37.3%  4787   90s
   122   207 67569.2390    8  291 51264.9465 70409.3086  37.3%  3946   95s
H  224   244                    51610.521058 70409.3086  36.4%  3406   99s
   243   330 65026.1350    9  274 51610.5211 70409.3086  36.4%  3284  103s
H  330   397                    52000.576821 70409.3086  35.4%  2887  106s
   409   451 65541.4552   11  310 52000.5768 70409.3086  35.4%  2656  111s
   501   487 65015.7893   11  306 52000.5768 70409.3086  35.4%  2464  115s
   629   562 62999.6980   12  227 52000.5768 70409.3086  35.4%  2402  125s
   715   655 63275.0629   13  272 52000.5768 70409.3086  35.4%  2416  131s
   837   754 63002.2372   14  223 52000.5768 70409.3086  35.4%  2309  138s
   885   801 62536.9019   15  275 52000.5768 70409.3086  35.4%  2306  143s
   949   861 62076.2469   14  276 52000.5768 70409.3086  35.4%  2279  147s
  1015   900 62672.1376   15  211 52000.5768 69995.9459  34.6%  2246  150s
  1133  1023 59535.4973   16  217 52000.5768 69993.9135  34.6%  2194  157s
  1221  1083 60967.5400   15  254 52000.5768 69993.9135  34.6%  2141  161s
  1311  1164 61097.8556   17  213 52000.5768 69993.9135  34.6%  2110  165s
  1519  1299 59598.7883   22  122 52000.5768 69993.9135  34.6%  2030  172s
  1636  1385 59599.1100   28  128 52000.5768 69993.9135  34.6%  1994  177s
  1794  1411 58812.1245   32  178 52000.5768 68580.3335  31.9%  1925  180s
H 1898  1472                    52088.703112 68580.3335  31.7%  1899  184s
  1915  1599 58253.3508   37  120 52088.7031 68580.3335  31.7%  1888  188s
  2128  1690 57879.9858   41  117 52088.7031 68016.2891  30.6%  1784  194s
  2341  1794 57008.9573   43  178 52088.7031 68016.2891  30.6%  1707  198s
  2531  1822 56450.5941   51  142 52088.7031 68016.2891  30.6%  1659  202s
  2567  1853 56218.1723   53  177 52088.7031 67762.3518  30.1%  1662  207s
  2604  1878 56280.1441   53  177 52088.7031 67762.3518  30.1%  1669  211s
  2647  1899 56426.0399   52  132 52088.7031 67762.3518  30.1%  1669  216s
  2692  1927 56336.8855   53  123 52088.7031 67762.3518  30.1%  1678  221s
  2776  1977 55785.0885   54  136 52088.7031 67762.3518  30.1%  1668  226s
  2866  2046 54632.8778   64  125 52088.7031 67762.3518  30.1%  1663  230s
  2981  2099 53393.1077   72  100 52088.7031 67728.2446  30.0%  1645  236s
  3142  2192 64583.8757    9  251 52088.7031 67728.2446  30.0%  1615  242s
  3303  2332 60309.9441   11  231 52088.7031 67728.2446  30.0%  1606  248s
  3557  2483 58220.6987   14  205 52088.7031 67728.2446  30.0%  1557  253s
  3792  2574 52096.7264   16  119 52088.7031 67583.6029  29.7%  1533  259s
  3957  2703 55525.9417   15  182 52088.7031 67583.6029  29.7%  1509  265s
  4252  2830 55881.2029   18  198 52088.7031 67583.6029  29.7%  1476  272s
  4486  2831 53655.6196   39  446 52088.7031 67544.5906  29.7%  1475  305s
  4488  2832 59949.0941   18  125 52088.7031 67544.5906  29.7%  1474  311s
  4489  2833 55003.3168   38  325 52088.7031 67544.5906  29.7%  1474  318s
  4490  2834 54720.5580   19  334 52088.7031 67544.5906  29.7%  1474  320s
  4493  2836 54741.4055   41  459 52088.7031 67544.5906  29.7%  1473  327s
  4495  2837 54773.1166   18  447 52088.7031 67544.5906  29.7%  1472  331s
  4498  2839 65721.8419   11  379 52088.7031 67544.5906  29.7%  1471  336s
  4502  2842 57742.2824   20  490 52088.7031 67544.5906  29.7%  1470  341s
  4506  2844 55415.6460   27  509 52088.7031 67544.5906  29.7%  1469  345s
  4509  2846 65734.4869    8  513 52088.7031 67544.5906  29.7%  1468  351s
  4513  2849 62622.0329   12  511 52088.7031 67544.5906  29.7%  1466  356s
  4514  2850 65622.9693    9  511 52088.7031 67544.5906  29.7%  1466  363s
  4515  2850 60545.7071   18  511 52088.7031 67544.5906  29.7%  1466  371s
  4516  2854 67544.5906   15  496 52088.7031 67544.5906  29.7%  1484  381s
  4518  2857 67544.5906   16  457 52088.7031 67544.5906  29.7%  1486  387s
  4522  2864 67544.5906   17  497 52088.7031 67544.5906  29.7%  1489  393s
  4530  2877 67544.5906   18  460 52088.7031 67544.5906  29.7%  1495  400s
  4546  2899 67544.5906   19  406 52088.7031 67544.5906  29.7%  1518  410s
  4573  2922 67412.5849   20  375 52088.7031 67544.5906  29.7%  1558  420s
  4605  2945 65902.5546   21  339 52088.7031 67544.5906  29.7%  1578  427s
  4639  2993 65428.6334   22  347 52088.7031 67544.5906  29.7%  1621  435s
  4702  3063 63735.0572   23  255 52088.7031 67544.5906  29.7%  1651  442s
  4803  3114 63016.3609   24  255 52088.7031 67544.5906  29.7%  1675  448s
  4904  3143 62916.9046   24  225 52088.7031 67544.5906  29.7%  1687  454s
  4988  3144 61616.5400   25  212 52088.7031 67544.5906  29.7%  1700  459s
  5070  3139 61347.3524   26  210 52088.7031 67544.5906  29.7%  1708  463s
  5105  3152 61107.4284   27  208 52088.7031 67544.5906  29.7%  1712  467s
  5146  3161 60919.3804   28  261 52088.7031 67342.7122  29.3%  1720  471s
  5184  3171 60877.2338   29  195 52088.7031 67342.7122  29.3%  1722  480s
  5263  3206 55818.5196   30  161 52088.7031 67342.7122  29.3%  1739  488s
  5309  3212 59623.3737   31  176 52088.7031 67342.7122  29.3%  1741  492s
  5363  3216 58898.2212   32  159 52088.7031 67342.7122  29.3%  1742  498s
  5416  3232 54585.6777   31  159 52088.7031 67342.7122  29.3%  1746  506s
  5485  3237 58324.3275   32  169 52088.7031 67301.9343  29.2%  1748  510s
  5553  3241 58322.7214   33  179 52088.7031 67301.9343  29.2%  1751  515s
  5651  3251 56651.0129   35  189 52088.7031 66618.5796  27.9%  1748  522s
  5763  3254 55266.5292   37  224 52088.7031 66356.8973  27.4%  1749  527s
  5870  3273     cutoff   39      52088.7031 66226.9011  27.1%  1748  533s
  5988  3269 52440.8356   47  173 52088.7031 66114.3712  26.9%  1750  537s
  6062  3293 61796.3908   23  276 52088.7031 66114.3712  26.9%  1755  544s
  6158  3315 56700.1087   26  184 52088.7031 66111.0809  26.9%  1767  549s
  6283  3300 52681.2814   29  147 52088.7031 66111.0809  26.9%  1769  556s
  6437  3314 62902.3039   22  282 52088.7031 66056.9629  26.8%  1767  563s
  6557  3346 60494.2333   24  323 52088.7031 65875.4211  26.5%  1775  570s
  6695  3379 55421.6105   28  232 52088.7031 65875.4211  26.5%  1778  576s
  6851  3375     cutoff   30      52088.7031 65329.2316  25.4%  1776  583s
  6999  3381 58076.0194   24  264 52088.7031 65166.1109  25.1%  1785  589s
  7155  3386 54391.5833   28  193 52088.7031 65166.1109  25.1%  1787  598s
  7343  3364     cutoff   29      52088.7031 65166.1109  25.1%  1782  606s
  7550  3357 60424.3994   26  312 52088.7031 64466.5321  23.8%  1782  613s
  7726  3352 53558.6897   30  233 52088.7031 64466.5321  23.8%  1788  621s
  7909  3349 61208.2680   24  327 52088.7031 64431.2722  23.7%  1794  629s
  8113  3326 57716.4330   26  305 52088.7031 64420.2677  23.7%  1798  639s
  8326  3316 55416.5276   30  291 52088.7031 64420.2677  23.7%  1803  648s
  8531  3312     cutoff   27      52088.7031 63748.9258  22.4%  1807  657s
  8806  3305 55050.8693   23  254 52088.7031 63613.5727  22.1%  1801  665s
  9016  3308 52769.6145   25  242 52088.7031 63411.9458  21.7%  1812  674s
  9237  3278 61028.2305   25  323 52088.7031 63411.9458  21.7%  1819  683s
  9526  3240     cutoff   32      52088.7031 63082.9974  21.1%  1820  693s
  9822  3207 53182.0408   28  221 52088.7031 62697.7764  20.4%  1822  704s
 10161  3198 58599.5546   27  282 52088.7031 62305.6234  19.6%  1821  714s
 10465  3172 54161.1068   29  312 52088.7031 62289.1940  19.6%  1826  725s
 10834  3153 57754.5341   26  249 52088.7031 61851.5069  18.7%  1823  735s
 11245  3121 53972.9885   27  240 52088.7031 61532.0939  18.1%  1814  746s
 11672  3029 54938.0593   28  208 52088.7031 61326.2744  17.7%  1807  756s
 12124  2930 55434.8713   26  249 52088.7031 61063.0004  17.2%  1799  767s
 12586  2836 55852.8459   29  308 52088.7031 60652.4071  16.4%  1794  779s
 12991  2775 58018.7012   25  299 52088.7031 60640.3149  16.4%  1798  791s
 13439  2818 52402.9396   30  318 52088.7031 60604.4838  16.3%  1796  804s
 13959  2858     cutoff   32      52088.7031 60234.2365  15.6%  1791  817s
 14337  2933 53137.0387   31  197 52088.7031 60064.1932  15.3%  1790  830s
 14837  2942 55085.7632   26  293 52088.7031 59833.4073  14.9%  1789  845s
 15426  2946     cutoff   28      52088.7031 59659.6433  14.5%  1782  858s
 15489  2959 56800.1088   26  280 52088.7031 59649.5105  14.5%  1784  871s
 15552  2969 54824.6305   27  264 52088.7031 59649.5105  14.5%  1786  885s
 15641  2981 53009.7821   28  190 52088.7031 59649.5105  14.5%  1785  903s
 15817  2982     cutoff   29      52088.7031 59551.4284  14.3%  1785  919s
 16277  2998 53239.6844   30  207 52088.7031 59483.0113  14.2%  1781  935s
 16969  3000 54683.0879   28  183 52088.7031 59069.1702  13.4%  1774  952s
 17662  2984 53137.5372   30  196 52088.7031 58841.1536  13.0%  1770  969s
 18390  2957 54332.2597   27  233 52088.7031 58498.1346  12.3%  1765  987s
 19123  2916 52701.3461   30  204 52088.7031 58345.5219  12.0%  1763 1005s
 19953  2851 53642.3891   27  300 52088.7031 58033.2782  11.4%  1754 1023s
 20757  2713     cutoff   26      52088.7031 57737.9903  10.8%  1749 1041s
 21633  2586     cutoff   30      52088.7031 57374.1794  10.1%  1744 1060s
 22533  2423     cutoff   30      52088.7031 57126.7424  9.67%  1737 1078s
 23480  2211     cutoff   28      52088.7031 56824.4745  9.09%  1731 1099s
 24564  1888 infeasible   37      52088.7031 56377.2489  8.23%  1719 1121s
 25747  1434 52649.1827   29  227 52088.7031 55954.8221  7.42%  1703 1142s
 27181   722 52112.4824   29  267 52088.7031 55432.5502  6.42%  1674 1162s
 29256  2353 53077.4690   26  261 52088.7031 54188.2324  4.03%  1613 1173s
*29524  2353              82    52119.976160 54145.2066  3.89%  1599 1173s
*29654  2353              90    52175.192337 54129.5342  3.75%  1593 1173s
*30156  2353              98    52187.486508 54061.1446  3.59%  1568 1173s
H30325  2353                    52217.865439 54052.0077  3.51%  1560 1173s
*32394  2353             119    52220.817155 53954.8714  3.32%  1470 1173s
H33677  2353                    52312.441244 53900.4610  3.04%  1419 1173s
 34003  4146     cutoff   55      52312.4412 53196.8247  1.69%  1406 1179s
H34377  4146                    52426.635779 53196.8247  1.47%  1392 1179s
H35113  4146                    52457.136339 53196.8247  1.41%  1364 1179s
H35113  4146                    52469.643522 53196.8247  1.39%  1364 1179s
H36410  4146                    52554.028987 53196.8247  1.22%  1318 1179s
H36829  4146                    52554.557367 53166.4084  1.16%  1303 1179s
 39923   628     cutoff   55      52554.5574 52756.9383  0.39%  1207 1180s
*40054   628              73    52558.703783 52756.9383  0.38%  1203 1181s
H41465   628                    52566.008348 52754.6227  0.36%  1163 1181s
*42982    33              72    52568.195398 52636.0955  0.13%  1123 1182s
*43510    33              78    52570.571423 52630.3975  0.11%  1110 1182s
*43877    33              78    52595.928231 52595.9282  0.00%  1101 1182s

Cutting planes:
  Gomory: 4
  MIR: 714
  Mixing: 1
  Flow cover: 1521
  RLT: 19
  Relax-and-lift: 110

Explored 43926 nodes (48374802 simplex iterations) in 1182.48 seconds (4017.07 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 52595.9 52595.9 52570.6 ... 52457.1

Optimal solution found (tolerance 1.00e-04)
Best objective 5.259592823137e+04, best bound 5.259592823137e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1182.51s
  Master Objective (UB) = 52595.93, θ = 197617.14
  Upper Bound (UB) = 52595.93

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 197617.14
  [DEBUG]   ✓ Scenario 0: θ = 197617.14 ≤ Q = 197617.14 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 197617.14 ≤ Q = 197629.68 (slack: 12.54)
  [DEBUG]   ✓ Scenario 2: θ = 197617.14 ≤ Q = 197617.14 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 197617.14 ≤ Q = 197617.14 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x56af1e1e
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xa950e1e2
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 1e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.397582e+13
Presolve removed 2612 rows and 1902 columns
Presolve time: 0.00s
Presolved: 481 rows, 487 columns, 1361 nonzeros
Found heuristic solution: objective 6781874.4550
Variable types: 329 continuous, 158 integer (158 binary)
Found heuristic solution: objective 6780950.4293

Root relaxation: objective -1.646751e+05, 238 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -164675.10    0  127 6780950.43 -164675.10   102%     -    0s
H    0     0                    -135640.1098 -164675.10  21.4%     -    0s
H    0     0                    -136545.4192 -164675.10  20.6%     -    0s
H    0     0                    -143006.7771 -153294.65  7.19%     -    0s
H    0     0                    -144519.5096 -153294.65  6.07%     -    0s
H    0     0                    -150926.5757 -153294.65  1.57%     -    0s
     0     0 -153294.65    0   87 -150926.58 -153294.65  1.57%     -    0s
H    0     0                    -151365.0406 -152724.19  0.90%     -    0s
     0     0 -152724.19    0  100 -151365.04 -152724.19  0.90%     -    0s
     0     0 -152707.42    0  100 -151365.04 -152707.42  0.89%     -    0s
     0     0 -152260.67    0   77 -151365.04 -152260.67  0.59%     -    0s
     0     0 -152208.95    0   61 -151365.04 -152208.95  0.56%     -    0s
     0     0 -152179.44    0   62 -151365.04 -152179.44  0.54%     -    0s
     0     0 -152179.38    0   62 -151365.04 -152179.38  0.54%     -    0s
     0     0 -151859.68    0   30 -151365.04 -151859.68  0.33%     -    0s
     0     0 -151747.71    0   34 -151365.04 -151747.71  0.25%     -    0s
     0     0 -151735.88    0   33 -151365.04 -151735.88  0.24%     -    0s
     0     0 -151506.43    0   27 -151365.04 -151506.43  0.09%     -    0s
     0     0 -151505.78    0   25 -151365.04 -151505.78  0.09%     -    0s
     0     0 -151485.62    0   14 -151365.04 -151485.62  0.08%     -    0s
     0     0 -151485.62    0   19 -151365.04 -151485.62  0.08%     -    0s
     0     0 -151429.16    0    9 -151365.04 -151429.16  0.04%     -    0s
     0     0 -151429.16    0   15 -151365.04 -151429.16  0.04%     -    0s
     0     0 -151381.55    0    4 -151365.04 -151381.55  0.01%     -    0s
H    0     0                    -151372.4945 -151381.09  0.01%     -    0s

Cutting planes:
  Gomory: 6
  Implied bound: 2
  MIR: 2
  Flow cover: 9
  Relax-and-lift: 5

Explored 1 nodes (882 simplex iterations) in 0.09 seconds (0.06 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -151372 -151365 -150612 ... 6.78187e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.513724945229e+05, best bound -1.513810882630e+05, gap 0.0057%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 175046.00
  Scenario: 44 demand increases, 16 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -151372.49
  [DEBUG]   S×d_nominal = 326418.49
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 326418.49 + -151372.49 = 175046.00
  [DEBUG]   Current θ from Master = 197617.14
  [DEBUG]   ⚠️  Z_SP ≤ θ by 22571.14 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 30024.79
  Lower Bound (LB) = 45250.14
  Gap (UB-LB) = 7345.7855, Absolute Gap = 7345.7855, Relative Gap = 0.139665
  Not converged yet (gap = 7345.79 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 44 increases, 16 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221674 nonzeros
Model fingerprint: 0x17ceade5
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 35410 rows and 14380 columns
Presolve time: 0.67s
Presolved: 42423 rows, 19080 columns, 262889 nonzeros
Variable types: 16821 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -275122.5137
Found heuristic solution: objective -152704.5499

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 42423 rows, 19080 columns, 262889 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   33545    5.7489590e+04   0.000000e+00   2.169155e+07      5s
Concurrent spin time: 0.64s

Solved with dual simplex

Root relaxation: objective 8.711021e+04, 27991 iterations, 8.67 seconds (18.27 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 87110.2079    0  132 -152704.55 87110.2079   157%     -    9s
H    0     0                    -146194.4599 87110.2079   160%     -    9s
H    0     0                    -134876.8535 87110.2079   165%     -    9s
H    0     0                    -109006.0930 87110.2079   180%     -    9s
H    0     0                    -108648.4377 87110.2079   180%     -    9s
H    0     0                    -37550.32653 87110.2079   332%     -    9s
H    0     0                    -12172.14355 87110.2079   816%     -    9s
H    0     0                    -11357.73403 87110.2079   867%     -    9s
H    0     0                    43190.555824 87110.2079   102%     -    9s
H    0     0                    43823.140924 87110.2079  98.8%     -   10s
H    0     0                    44137.917953 87110.2079  97.4%     -   10s
H    0     0                    44329.171286 81035.8073  82.8%     -   14s
     0     0 80988.1392    0  173 44329.1713 80988.1392  82.7%     -   14s
     0     0 80214.5661    0  178 44329.1713 80214.5661  81.0%     -   16s
     0     0 80165.2523    0  171 44329.1713 80165.2523  80.8%     -   16s
     0     0 80165.2523    0  176 44329.1713 80165.2523  80.8%     -   16s
     0     0 80158.4910    0  183 44329.1713 80158.4910  80.8%     -   17s
     0     0 80158.4910    0  181 44329.1713 80158.4910  80.8%     -   18s
     0     0 80158.4910    0  188 44329.1713 80158.4910  80.8%     -   18s
     0     0 80158.4910    0  187 44329.1713 80158.4910  80.8%     -   19s
H    0     0                    44571.113550 76784.2879  72.3%     -   22s
H    0     0                    44587.234448 76784.2879  72.2%     -   22s
     0     0 76777.7687    0  248 44587.2344 76777.7687  72.2%     -   22s
H    0     0                    45268.583525 76777.7687  69.6%     -   22s
H    0     0                    45650.600351 76777.7687  68.2%     -   22s
     0     0 76202.1896    0  259 45650.6004 76202.1896  66.9%     -   25s
     0     0 76001.6789    0  268 45650.6004 76001.6789  66.5%     -   26s
     0     0 75945.2389    0  263 45650.6004 75945.2389  66.4%     -   27s
     0     0 75880.3851    0  258 45650.6004 75880.3851  66.2%     -   28s
     0     0 75877.9511    0  261 45650.6004 75877.9511  66.2%     -   29s
     0     0 75877.1192    0  265 45650.6004 75877.1192  66.2%     -   29s
     0     0 73939.8191    0  296 45650.6004 73939.8191  62.0%     -   34s
     0     0 73439.9425    0  306 45650.6004 73439.9425  60.9%     -   39s
     0     0 73045.0836    0  354 45650.6004 73045.0836  60.0%     -   41s
     0     0 72946.2105    0  318 45650.6004 72946.2105  59.8%     -   43s
     0     0 72880.7041    0  355 45650.6004 72880.7041  59.6%     -   45s
     0     0 72852.0650    0  355 45650.6004 72852.0650  59.6%     -   45s
     0     0 72827.8620    0  357 45650.6004 72827.8620  59.5%     -   46s
     0     0 72818.6183    0  354 45650.6004 72818.6183  59.5%     -   47s
     0     0 72813.5517    0  352 45650.6004 72813.5517  59.5%     -   47s
     0     0 72812.9479    0  361 45650.6004 72812.9479  59.5%     -   47s
H    0     0                    47807.687505 72012.1232  50.6%     -   52s
H    0     0                    47977.083543 72012.1232  50.1%     -   52s
H    0     0                    48027.306419 72012.1232  49.9%     -   52s
H    0     0                    48135.703486 72012.1232  49.6%     -   52s
     0     0 72012.1232    0  372 48135.7035 72012.1232  49.6%     -   52s
     0     0 71833.0181    0  414 48135.7035 71833.0181  49.2%     -   55s
     0     0 71750.4552    0  421 48135.7035 71750.4552  49.1%     -   56s
     0     0 71658.2822    0  428 48135.7035 71658.2822  48.9%     -   58s
     0     0 71635.9720    0  429 48135.7035 71635.9720  48.8%     -   59s
     0     0 71631.3838    0  431 48135.7035 71631.3838  48.8%     -   59s
     0     0 71626.7538    0  430 48135.7035 71626.7538  48.8%     -   59s
     0     0 71622.8677    0  435 48135.7035 71622.8677  48.8%     -   59s
     0     0 71612.0106    0  429 48135.7035 71612.0106  48.8%     -   60s
     0     0 71605.7738    0  426 48135.7035 71605.7738  48.8%     -   60s
     0     0 71603.8053    0  429 48135.7035 71603.8053  48.8%     -   60s
     0     0 71599.8118    0  432 48135.7035 71599.8118  48.7%     -   60s
     0     0 71597.3779    0  427 48135.7035 71597.3779  48.7%     -   61s
     0     0 71597.2566    0  428 48135.7035 71597.2566  48.7%     -   61s
H    0     0                    48283.742693 71414.8792  47.9%     -   63s
H    0     0                    48499.931951 71414.8792  47.2%     -   63s
H    0     0                    48533.984771 71414.8792  47.1%     -   63s
H    0     0                    48812.366570 71414.8792  46.3%     -   63s
H    0     0                    49143.777286 71414.8792  45.3%     -   63s
H    0     0                    49177.830105 71414.8792  45.2%     -   63s
     0     0 71414.8792    0  429 49177.8301 71414.8792  45.2%     -   64s
H    0     0                    49372.186298 71414.7359  44.6%     -   64s
H    0     0                    49442.526702 71414.7359  44.4%     -   64s
     0     0 71381.9056    0  403 49442.5267 71381.9056  44.4%     -   65s
     0     0 71367.5918    0  412 49442.5267 71367.5918  44.3%     -   65s
     0     0 71363.2265    0  405 49442.5267 71363.2265  44.3%     -   66s
     0     0 71361.9071    0  405 49442.5267 71361.9071  44.3%     -   66s
     0     0 71303.3119    0  419 49442.5267 71303.3119  44.2%     -   68s
     0     0 71277.7599    0  420 49442.5267 71277.7599  44.2%     -   68s
     0     0 71274.3071    0  410 49442.5267 71274.3071  44.2%     -   69s
     0     0 71272.6261    0  420 49442.5267 71272.6261  44.2%     -   69s
     0     0 71246.1390    0  367 49442.5267 71246.1390  44.1%     -   70s
     0     0 71235.1684    0  389 49442.5267 71235.1684  44.1%     -   71s
     0     0 71230.4454    0  367 49442.5267 71230.4454  44.1%     -   71s
     0     0 71229.0159    0  412 49442.5267 71229.0159  44.1%     -   71s
H    0     0                    49672.391935 71220.9929  43.4%     -   73s
     0     0 71220.9929    0  480 49672.3919 71220.9929  43.4%     -   73s
     0     0 71198.1252    0  446 49672.3919 71198.1252  43.3%     -   73s
     0     0 71193.1809    0  438 49672.3919 71193.1809  43.3%     -   74s
     0     0 71191.8878    0  462 49672.3919 71191.8878  43.3%     -   74s
     0     0 71185.8547    0  478 49672.3919 71185.8547  43.3%     -   75s
H    0     0                    49785.834132 71185.4776  43.0%     -   75s
     0     0 71183.5807    0  453 49785.8341 71183.5807  43.0%     -   75s
     0     0 71181.5007    0  490 49785.8341 71181.5007  43.0%     -   76s
     0     0 71180.6613    0  469 49785.8341 71180.6613  43.0%     -   76s
     0     0 71173.8632    0  448 49785.8341 71173.8632  43.0%     -   77s
     0     0 71173.4297    0  450 49785.8341 71173.4297  43.0%     -   77s
     0     0 71167.2652    0  459 49785.8341 71167.2652  42.9%     -   78s
     0     0 71166.4213    0  426 49785.8341 71166.4213  42.9%     -   78s
     0     0 71165.0016    0  436 49785.8341 71165.0016  42.9%     -   79s
     0     0 71164.8188    0  436 49785.8341 71164.8188  42.9%     -   79s
H    0     0                    50116.887784 71164.6851  42.0%     -   91s
H    0     0                    50170.568011 71164.6851  41.8%     -   91s
H    0     0                    50189.009220 71164.6851  41.8%     -   91s
H    0     0                    50215.841187 71164.6851  41.7%     -   91s
H    0     0                    50370.355957 71164.6851  41.3%     -   91s
H    0     0                    50400.537296 71164.6851  41.2%     -   91s
     0     2 71164.6851    0  436 50400.5373 71164.6851  41.2%     -   91s
     1     4 70720.7659    1  393 50400.5373 71164.6851  41.2%  5949   95s
     3     8 70640.1939    2  387 50400.5373 70720.3863  40.3%  4011  101s
     7    16 70287.2192    3  397 50400.5373 70640.8086  40.2%  5314  107s
    15    32 69975.8744    4  392 50400.5373 70286.8037  39.5%  6693  113s
    31    55 67715.8164    5  326 50400.5373 69975.8597  38.8%  8031  123s
    54    87 68783.6026    6  331 50400.5373 69975.8597  38.8%  8812  129s
H   81    87                    50574.366744 69975.8597  38.4%  7027  129s
    86   242 68675.2727    7  313 50574.3667 69975.8597  38.4%  6776  138s
   241   279 68213.8167   11  312 50574.3667 69975.8597  38.4%  3964  142s
H  264   279                    50601.090656 69975.8597  38.3%  3879  142s
H  266   279                    51003.879132 69975.8597  37.2%  3870  142s
H  267   279                    51040.555126 69975.8597  37.1%  3857  142s
   278   334 67468.7106   10  248 51040.5551 69975.8597  37.1%  3797  148s
   333   385 67783.7781   12  292 51040.5551 69975.8597  37.1%  3749  153s
H  335   385                    51523.807302 69975.8597  35.8%  3743  153s
H  340   385                    51527.517660 69975.8597  35.8%  3734  153s
H  355   385                    51633.396212 69975.8597  35.5%  3770  153s
   384   443 67764.3846   12  312 51633.3962 69975.8597  35.5%  3647  157s
   442   510 67363.9616   12  293 51633.3962 69975.8597  35.5%  3648  162s
H  443   510                    51697.177691 69975.8597  35.4%  3640  162s
H  464   510                    51708.917820 69975.8597  35.3%  3700  162s
H  472   510                    52000.576821 69975.8597  34.6%  3679  162s
   509   587 67207.1234   11  245 52000.5768 69975.8597  34.6%  3596  166s
   592   629 67024.9927   13  299 52000.5768 69975.8597  34.6%  3454  172s
H  619   629                    52088.703112 69975.8597  34.3%  3468  172s
   648   686 67173.1096   13  277 52088.7031 69975.8597  34.3%  3395  179s
   723   717 67119.4291   13  302 52088.7031 69492.7269  33.4%  3354  185s
   813   781 65407.6279   14  307 52088.7031 69490.5117  33.4%  3481  196s
   854   808 65505.5750   14  265 52088.7031 69490.5117  33.4%  3570  200s
   895   846 65441.1071   14  320 52088.7031 69490.5117  33.4%  3678  205s
   941   883 65199.4917   14  275 52088.7031 69490.5117  33.4%  3727  212s
   998   919 65573.4765   14  307 52088.7031 69490.5117  33.4%  3754  216s
  1038   954 65644.9973   14  326 52088.7031 69490.5117  33.4%  3800  221s
  1093   989 65401.2973   14  280 52088.7031 69490.5117  33.4%  3812  227s
  1168  1039 57121.9173   15  233 52088.7031 69490.5117  33.4%  3782  233s
  1238  1074 63275.5009   15  298 52088.7031 69490.5117  33.4%  3832  240s
  1335  1121 63297.7727   15  266 52088.7031 69490.5117  33.4%  3767  247s
  1426  1163 64735.1186   15  289 52088.7031 69490.5117  33.4%  3782  251s
  1510  1231 64483.3948   16  294 52088.7031 69490.5117  33.4%  3788  257s
  1612  1276 62837.6014   16  271 52088.7031 68960.3327  32.4%  3768  262s
  1672  1340 62435.7318   18  244 52088.7031 68960.3327  32.4%  3770  270s
  1754  1364 57824.4066   17  213 52088.7031 68960.3327  32.4%  3741  278s
  1792  1401 56960.9293   18  223 52088.7031 68782.4509  32.0%  3745  283s
  1831  1437 58712.2558   19  206 52088.7031 68782.4509  32.0%  3760  288s
  1879  1504 60298.1969   19  232 52088.7031 68782.4509  32.0%  3762  295s
  1970  1592 60018.1081   20  204 52088.7031 68664.5319  31.8%  3727  302s
  2102  1696 58470.7691   21  185 52088.7031 68664.5319  31.8%  3655  308s
  2262  1805 58081.0985   20  211 52088.7031 68664.5319  31.8%  3592  314s
  2481  1910 57580.2002   23  248 52088.7031 68664.5319  31.8%  3460  322s
  2632  2003 56503.3377   24  192 52088.7031 68172.5440  30.9%  3466  329s
  2799  2085 55439.7585   30  237 52088.7031 68172.5440  30.9%  3452  337s
  2953  2208 54836.1205   34  227 52088.7031 68072.5668  30.7%  3471  344s
  3107  2413 53790.0699   42  138 52088.7031 68051.7916  30.6%  3492  351s
  3342  2630     cutoff   46      52088.7031 67989.1747  30.5%  3412  359s
  3652  2631 61457.1456   21  436 52088.7031 67988.7620  30.5%  3270  380s
  3654  2632 56318.1954   34  132 52088.7031 67988.7620  30.5%  3268  393s
  3655  2633 60731.8506   21  313 52088.7031 67988.7620  30.5%  3267  403s
  3656  2634 56698.9220   16  372 52088.7031 67988.7620  30.5%  3266  408s
  3657  2634 59968.1242   21  385 52088.7031 67988.7620  30.5%  3265  413s
  3658  2635 65081.0568   13  362 52088.7031 67988.7620  30.5%  3265  416s
  3660  2636 56257.0220   29  376 52088.7031 67988.7620  30.5%  3263  421s
  3662  2638 64550.9279   10  441 52088.7031 67988.7620  30.5%  3261  425s
  3665  2640 55573.3875   30  377 52088.7031 67988.7620  30.5%  3258  431s
  3668  2642 54669.0640   48  370 52088.7031 67988.7620  30.5%  3256  436s
  3672  2644 61293.1349   16  373 52088.7031 67988.7620  30.5%  3252  440s
  3676  2647 65147.6078   16  365 52088.7031 67988.7620  30.5%  3249  446s
  3679  2649 53433.4606   40  375 52088.7031 67988.7620  30.5%  3246  463s
  3680  2650 66672.3959    8  375 52088.7031 67988.7620  30.5%  3245  472s
  3681  2653 67988.7620   10  364 52088.7031 67988.7620  30.5%  3277  480s
  3683  2657 67988.7620   11  369 52088.7031 67988.7620  30.5%  3277  485s
  3687  2663 67988.7620   12  362 52088.7031 67988.7620  30.5%  3279  494s
  3695  2677 67988.7620   13  377 52088.7031 67988.7620  30.5%  3282  504s
  3711  2696 65329.5120   14  321 52088.7031 67988.7620  30.5%  3323  518s
  3736  2720 64726.8895   15  288 52088.7031 67988.7620  30.5%  3354  528s
  3768  2779 63327.6833   16  320 52088.7031 67988.7620  30.5%  3401  540s
  3838  2829 61215.2517   18  273 52088.7031 67988.7620  30.5%  3485  548s
  3911  2883 59921.4946   18  299 52088.7031 67988.7620  30.5%  3511  556s
  3997  2903 58237.8577   19  246 52088.7031 67988.7620  30.5%  3505  563s
  4087  2898 59286.1550   19  251 52088.7031 67988.7620  30.5%  3483  572s
  4124  2904 58595.2514   20  261 52088.7031 67988.7620  30.5%  3486  578s
  4166  2920 57858.9638   20  256 52088.7031 67988.7620  30.5%  3484  583s
  4198  2934 57417.9310   21  244 52088.7031 67988.7620  30.5%  3488  590s
  4233  2948 57016.0116   22  234 52088.7031 67988.7620  30.5%  3492  597s
  4268  2960 56280.0907   23  223 52088.7031 67988.7620  30.5%  3490  605s
  4345  2994 54961.3496   25  191 52088.7031 67988.7620  30.5%  3482  614s
  4381  2999 53488.4672   23  231 52088.7031 67988.7620  30.5%  3477  622s
  4431  3011     cutoff   24      52088.7031 67988.7620  30.5%  3460  631s
  4489  3019     cutoff   26      52088.7031 67988.7620  30.5%  3454  637s
  4551  3034 52697.0217   27  215 52088.7031 67988.7620  30.5%  3438  644s
  4610  3026     cutoff   28      52088.7031 67463.7660  29.5%  3428  651s
  4682  3021     cutoff   29      52088.7031 67463.7660  29.5%  3408  661s
  4751  3030 57668.2209   17  306 52088.7031 67463.7660  29.5%  3394  668s
  4813  3054 55739.8717   18  283 52088.7031 67265.0566  29.1%  3395  675s
  4897  3066 54763.9446   19  259 52088.7031 67265.0566  29.1%  3382  685s
  4989  3082 54312.8039   20  201 52088.7031 66316.5951  27.3%  3371  694s
  5091  3089 52429.0810   21  220 52088.7031 66316.5951  27.3%  3357  703s
  5228  3066     cutoff   22      52088.7031 66316.5951  27.3%  3325  712s
  5356  3080 63899.2888   17  276 52088.7031 66112.7349  26.9%  3307  721s
  5455  3114 63189.5501   18  284 52088.7031 66112.7349  26.9%  3308  731s
  5577  3108 62063.0156   19  285 52088.7031 66067.2636  26.8%  3295  740s
  5706  3108 61144.0009   20  274 52088.7031 66067.2636  26.8%  3282  751s
  5834  3122 60653.0383   21  291 52088.7031 66067.2636  26.8%  3277  762s
  5977  3147 60302.3124   22  299 52088.7031 66004.0830  26.7%  3263  773s
  6125  3119 59835.8782   23  277 52088.7031 65651.6873  26.0%  3249  782s
  6164  3122 53811.7638   24  243 52088.7031 65532.7498  25.8%  3249  790s
  6215  3119     cutoff   25      52088.7031 65532.7498  25.8%  3242  800s
  6270  3126 58220.6136   25  278 52088.7031 65532.7498  25.8%  3241  807s
  6309  3125 57439.8683   26  236 52088.7031 65532.7498  25.8%  3242  819s
  6382  3139 55346.4403   31  168 52088.7031 65475.1942  25.7%  3230  829s
  6470  3144 58062.7956   18  291 52088.7031 65475.1942  25.7%  3211  843s
  6608  3120     cutoff   22      52088.7031 65475.1942  25.7%  3185  856s
  6749  3124 52307.4796   25  235 52088.7031 65475.1942  25.7%  3168  868s
  6885  3141 52818.1061   19  193 52088.7031 64793.9011  24.4%  3163  880s
  7028  3135 60058.7516   19  275 52088.7031 64793.9011  24.4%  3164  893s
  7211  3133 59471.2103   20  265 52088.7031 64511.4354  23.8%  3155  906s
  7400  3147 56219.1611   22  264 52088.7031 64511.4354  23.8%  3149  922s
  7654  3127 53364.7384   27  142 52088.7031 64511.4354  23.8%  3131  935s
  7855  3149 55196.7314   22  201 52088.7031 64511.4354  23.8%  3115  952s
  8158  3169 56341.7693   21  248 52088.7031 64511.4354  23.8%  3090  968s
  8404  3175 52288.2962   23  192 52088.7031 63337.1050  21.6%  3084  984s
  8662  3212     cutoff   23      52088.7031 62968.9815  20.9%  3083  999s
  8977  3179 54953.3730   23  243 52088.7031 62968.9815  20.9%  3066 1018s
  9231  3193 58051.0015   21  226 52088.7031 62958.8011  20.9%  3047 1037s
  9609  3182 53805.6029   23  244 52088.7031 62837.9414  20.6%  3022 1055s
  9957  3154 58203.3715   22  294 52088.7031 62528.9846  20.0%  3007 1073s
 10347  3159 56894.2953   22  280 52088.7031 62168.4781  19.4%  2986 1093s
 10766  3114     cutoff   26      52088.7031 62111.2679  19.2%  2963 1113s
 11178  3080 52258.0747   23  268 52088.7031 61587.5162  18.2%  2950 1134s
 11621  3014 53734.9782   23  223 52088.7031 61339.0424  17.8%  2931 1156s
 12075  3120     cutoff   21      52088.7031 61044.3597  17.2%  2917 1177s
 12574  3196 54391.4709   26  216 52088.7031 61013.9703  17.1%  2896 1199s
 13055  3265 53014.6025   26  205 52088.7031 60811.3137  16.7%  2882 1220s
 13561  3312 52580.6730   22  270 52088.7031 60725.6389  16.6%  2869 1246s
 14098  3331 52881.4576   23  201 52088.7031 60514.4479  16.2%  2853 1265s
 14142  3362     cutoff   24      52088.7031 60445.0126  16.0%  2854 1288s
 14442  3464 53541.7433   22  282 52088.7031 60427.9793  16.0%  2847 1312s
 15030  3515     cutoff   29      52088.7031 60423.2127  16.0%  2830 1338s
 15604  3575 55383.1003   22  313 52088.7031 60200.6730  15.6%  2818 1365s
 16264  3643 54119.9194   23  238 52088.7031 59862.0041  14.9%  2800 1395s
 16908  3653 infeasible   24      52088.7031 59670.8544  14.6%  2789 1423s
 17619  3697     cutoff   22      52088.7031 59526.7917  14.3%  2774 1452s
 18319  3727 54385.9296   23  288 52088.7031 59323.9689  13.9%  2764 1483s
 19066  3729     cutoff   26      52088.7031 59078.4660  13.4%  2750 1513s
 19872  3751     cutoff   26      52088.7031 58918.0515  13.1%  2733 1546s
 20674  3748 54263.5449   24  243 52088.7031 58630.3062  12.6%  2721 1579s
 21471  3699     cutoff   27      52088.7031 58508.7067  12.3%  2711 1614s
 22331  3660     cutoff   21      52088.7031 58294.1835  11.9%  2701 1653s
 23368  3624 54137.8770   22  250 52088.7031 58081.2002  11.5%  2676 1692s
 24314  3545 52945.4137   28  200 52088.7031 57893.8971  11.1%  2664 1731s
 25332  3422 53003.7660   23  239 52088.7031 57624.7941  10.6%  2650 1771s
 26312  3268     cutoff   29      52088.7031 57333.7062  10.1%  2643 1813s
 27355  3109 53646.1272   24  294 52088.7031 57035.2533  9.50%  2634 1854s
 28624  2830 53416.0224   22  230 52088.7031 56699.7512  8.85%  2607 1898s
 29930  2466     cutoff   18      52088.7031 56363.4848  8.21%  2583 1942s
 31274  2000     cutoff   23      52088.7031 55930.7595  7.38%  2560 1984s
 32811  1275 52714.4123   22  292 52088.7031 55479.7912  6.51%  2521 2026s
 34762  1217 52658.3153   26  210 52088.7031 54690.7660  5.00%  2463 2064s
 40063  3860 52523.0720   42   92 52088.7031 53130.8854  2.00%  2193 2072s
H40165  3860                    52093.975509 53130.8854  1.99%  2187 2072s
*42138  3860              66    52096.986112 53082.7284  1.89%  2089 2072s
H44363  3860                    52098.845169 52934.4135  1.60%  1989 2072s
H47360  3248                    52165.492863 52607.4326  0.85%  1868 2074s
H47360  3136                    52172.255383 52607.4326  0.83%  1868 2074s
 48183  3476 52198.2976   57   12 52172.2554 52553.9106  0.73%  1838 2076s
H51732  3578                    52193.368726 52418.8713  0.43%  1717 2078s
H53267  3085                    52227.190512 52382.0309  0.30%  1669 2080s
 58541  2762 52268.9886   65   20 52227.1905 52316.5522  0.17%  1524 2085s

Cutting planes:
  Learned: 3
  Gomory: 9
  MIR: 935
  Mixing: 3
  Flow cover: 1802
  RLT: 17
  Relax-and-lift: 149

Explored 69546 nodes (89860318 simplex iterations) in 2089.70 seconds (7346.92 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 52227.2 52227.2 52193.4 ... 52000.6

Optimal solution found (tolerance 1.00e-04)
Best objective 5.222719051193e+04, best bound 5.222719051193e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2089.74s
  Master Objective (UB) = 52227.19, θ = 195895.29
  Upper Bound (UB) = 52227.19

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 195895.29
  [DEBUG]   ✓ Scenario 0: θ = 195895.29 ≤ Q = 195895.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 195895.29 ≤ Q = 195895.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 195895.29 ≤ Q = 195895.29 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 195895.29 ≤ Q = 195895.29 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 195895.29 ≤ Q = 195895.29 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x360efddc
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xc9f10224
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 1e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.393309e+13
Presolve removed 2612 rows and 1902 columns
Presolve time: 0.00s
Presolved: 481 rows, 487 columns, 1358 nonzeros
Found heuristic solution: objective 6829540.3705
Variable types: 329 continuous, 158 integer (158 binary)
Found heuristic solution: objective 6828616.3448

Root relaxation: objective -1.659381e+05, 237 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -165938.12    0  124 6828616.34 -165938.12   102%     -    0s
H    0     0                    -137230.5007 -165938.12  20.9%     -    0s
H    0     0                    -146985.4759 -165938.12  12.9%     -    0s
H    0     0                    -147613.6504 -165938.12  12.4%     -    0s
     0     0 -153061.96    0  102 -147613.65 -153061.96  3.69%     -    0s
H    0     0                    -149470.9521 -152968.23  2.34%     -    0s
     0     0 -152924.97    0   93 -149470.95 -152924.97  2.31%     -    0s
     0     0 -152325.12    0   84 -149470.95 -152325.12  1.91%     -    0s
H    0     0                    -151406.4635 -152308.04  0.60%     -    0s
     0     0 -152262.68    0   83 -151406.46 -152262.68  0.57%     -    0s
     0     0 -151995.97    0   46 -151406.46 -151995.97  0.39%     -    0s
     0     0 -151960.43    0   50 -151406.46 -151960.43  0.37%     -    0s
     0     0 -151956.39    0   45 -151406.46 -151956.39  0.36%     -    0s
     0     0 -151703.10    0   23 -151406.46 -151703.10  0.20%     -    0s
     0     0 -151628.21    0   25 -151406.46 -151628.21  0.15%     -    0s
     0     0 -151625.89    0   23 -151406.46 -151625.89  0.14%     -    0s
     0     0 -151615.70    0   24 -151406.46 -151615.70  0.14%     -    0s
     0     0 -151615.68    0   24 -151406.46 -151615.68  0.14%     -    0s
     0     0 -151615.68    0   24 -151406.46 -151615.68  0.14%     -    0s
     0     0 -151490.62    0   12 -151406.46 -151490.62  0.06%     -    0s
     0     0 -151481.53    0   14 -151406.46 -151481.53  0.05%     -    0s
     0     0          -    0      -151406.46 -151420.77  0.01%     -    0s

Cutting planes:
  Gomory: 6
  Implied bound: 6
  MIR: 6
  Flow cover: 6
  Relax-and-lift: 4

Explored 1 nodes (840 simplex iterations) in 0.08 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -151406 -150683 -149471 ... 1.39331e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.514064634576e+05, best bound -1.514207702418e+05, gap 0.0094%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 175091.76
  Scenario: 48 demand increases, 12 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -151406.46
  [DEBUG]   S×d_nominal = 326498.22
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 326498.22 + -151406.46 = 175091.76
  [DEBUG]   Current θ from Master = 195895.29
  [DEBUG]   ⚠️  Z_SP ≤ θ by 20803.53 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 31423.66
  Lower Bound (LB) = 45250.14
  Gap (UB-LB) = 6977.0478, Absolute Gap = 6977.0478, Relative Gap = 0.133590
  Not converged yet (gap = 6977.05 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 48 increases, 12 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 264905 nonzeros
Model fingerprint: 0x0d3aff5e
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 42480 rows and 17250 columns
Presolve time: 0.94s
Presolved: 50643 rows, 22450 columns, 314399 nonzeros
Variable types: 20191 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -275122.5137
Found heuristic solution: objective -155958.4539

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 50643 rows, 22450 columns, 314399 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   34479    2.4255045e+04   0.000000e+00   1.526036e+07      5s
   51804    6.5224126e+04   0.000000e+00   1.426960e+07     10s
   66579    7.5735670e+04   0.000000e+00   5.912493e+07     15s
Concurrent spin time: 2.22s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 8.644182e+04, 48732 iterations, 16.05 seconds (32.52 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 86441.8205    0  120 -155958.45 86441.8205   155%     -   17s
H    0     0                    -149448.3639 86441.8205   158%     -   17s
H    0     0                    -146455.3899 86441.8205   159%     -   17s
H    0     0                    -144913.1150 86441.8205   160%     -   17s
H    0     0                    -135711.4708 86441.8205   164%     -   17s
H    0     0                    -126290.8765 86441.8205   168%     -   17s
H    0     0                    -124908.3713 86441.8205   169%     -   17s
H    0     0                    -124629.3528 86441.8205   169%     -   17s
H    0     0                    -26830.46882 86441.8205   422%     -   17s
H    0     0                    -26755.99917 86441.8205   423%     -   17s
H    0     0                    -13183.95252 86441.8205   756%     -   17s
H    0     0                    -12369.54300 86441.8205   799%     -   17s
H    0     0                    31594.998222 86441.8205   174%     -   18s
H    0     0                    31669.467872 86441.8205   173%     -   18s
H    0     0                    38280.732525 86441.8205   126%     -   18s
H    0     0                    42964.526880 86441.8205   101%     -   18s
H    0     0                    43462.909632 86441.8205  98.9%     -   18s
     0     0 81098.7262    0  156 43462.9096 81098.7262  86.6%     -   23s
H    0     0                    43704.966928 81098.3898  85.6%     -   23s
H    0     0                    43719.388384 81098.3898  85.5%     -   23s
H    0     0                    43787.383689 81098.3898  85.2%     -   23s
H    0     0                    43906.507915 81098.3898  84.7%     -   23s
     0     0 80569.3070    0  162 43906.5079 80569.3070  83.5%     -   25s
     0     0 80469.2276    0  164 43906.5079 80469.2276  83.3%     -   26s
     0     0 80409.5817    0  160 43906.5079 80409.5817  83.1%     -   27s
     0     0 80365.7642    0  167 43906.5079 80365.7642  83.0%     -   28s
     0     0 80365.7642    0  161 43906.5079 80365.7642  83.0%     -   28s
     0     0 80365.7642    0  161 43906.5079 80365.7642  83.0%     -   28s
H    0     0                    44123.558629 76411.9602  73.2%     -   33s
     0     0 76362.9496    0  223 44123.5586 76362.9496  73.1%     -   33s
H    0     0                    47339.449448 76362.9496  61.3%     -   34s
     0     0 75618.8427    0  234 47339.4494 75618.8427  59.7%     -   36s
     0     0 75410.0136    0  245 47339.4494 75410.0136  59.3%     -   38s
     0     0 75340.8868    0  250 47339.4494 75340.8868  59.2%     -   39s
     0     0 75306.6199    0  252 47339.4494 75306.6199  59.1%     -   39s
     0     0 75268.4604    0  247 47339.4494 75268.4604  59.0%     -   40s
     0     0 75251.8283    0  250 47339.4494 75251.8283  59.0%     -   41s
     0     0 75244.2554    0  252 47339.4494 75244.2554  58.9%     -   41s
     0     0 75243.6143    0  254 47339.4494 75243.6143  58.9%     -   41s
     0     0 73313.0261    0  316 47339.4494 73313.0261  54.9%     -   50s
H    0     0                    47420.115980 73312.7900  54.6%     -   50s
H    0     0                    47440.988659 73312.7900  54.5%     -   50s
H    0     0                    47577.635863 73312.7900  54.1%     -   50s
H    0     0                    47718.746708 72748.3250  52.5%     -   53s
     0     0 72748.3250    0  303 47718.7467 72748.3250  52.5%     -   53s
     0     0 72423.5207    0  315 47718.7467 72423.5207  51.8%     -   56s
     0     0 72143.9973    0  329 47718.7467 72143.9973  51.2%     -   58s
     0     0 72029.2052    0  331 47718.7467 72029.2052  50.9%     -   60s
H    0     0                    47765.187768 71875.9184  50.5%     -   63s
H    0     0                    47767.685022 71875.9184  50.5%     -   63s
     0     0 71875.9184    0  333 47767.6850 71875.9184  50.5%     -   63s
     0     0 71861.1162    0  337 47767.6850 71861.1162  50.4%     -   63s
H    0     0                    47878.364334 71842.7789  50.1%     -   64s
     0     0 71842.7789    0  335 47878.3643 71842.7789  50.1%     -   64s
H    0     0                    47920.019873 71794.5447  49.8%     -   64s
H    0     0                    48281.369563 71794.5447  48.7%     -   64s
     0     0 71794.5447    0  337 48281.3696 71794.5447  48.7%     -   64s
     0     0 71787.3278    0  340 48281.3696 71787.3278  48.7%     -   65s
     0     0 71784.4243    0  341 48281.3696 71784.4243  48.7%     -   65s
H    0     0                    48606.441496 71780.6541  47.7%     -   65s
     0     0 71780.6541    0  341 48606.4415 71780.6541  47.7%     -   65s
     0     0 71779.5788    0  342 48606.4415 71779.5788  47.7%     -   66s
     0     0 71133.9927    0  360 48606.4415 71133.9927  46.3%     -   71s
     0     0 70812.7627    0  357 48606.4415 70812.7627  45.7%     -   75s
     0     0 70753.8150    0  361 48606.4415 70753.8150  45.6%     -   76s
     0     0 70613.5047    0  356 48606.4415 70613.5047  45.3%     -   79s
     0     0 70593.3904    0  361 48606.4415 70593.3904  45.2%     -   80s
     0     0 70566.2815    0  361 48606.4415 70566.2815  45.2%     -   81s
     0     0 70559.5472    0  359 48606.4415 70559.5472  45.2%     -   81s
     0     0 70550.8991    0  369 48606.4415 70550.8991  45.1%     -   82s
     0     0 70548.6090    0  372 48606.4415 70548.6090  45.1%     -   82s
     0     0 70547.6870    0  376 48606.4415 70547.6870  45.1%     -   82s
     0     0 70434.8076    0  356 48606.4415 70434.8076  44.9%     -   85s
H    0     0                    48751.184836 70432.8814  44.5%     -   85s
H    0     0                    48851.213880 70432.8814  44.2%     -   85s
     0     0 70401.0476    0  356 48851.2139 70401.0476  44.1%     -   86s
     0     0 70391.1557    0  365 48851.2139 70391.1557  44.1%     -   86s
     0     0 70383.1316    0  366 48851.2139 70383.1316  44.1%     -   87s
     0     0 70379.6647    0  369 48851.2139 70379.6647  44.1%     -   87s
     0     0 70378.7241    0  362 48851.2139 70378.7241  44.1%     -   87s
     0     0 70330.9149    0  360 48851.2139 70330.9149  44.0%     -   89s
     0     0 70316.6635    0  364 48851.2139 70316.6635  43.9%     -   90s
     0     0 70307.2367    0  367 48851.2139 70307.2367  43.9%     -   91s
     0     0 70303.3464    0  366 48851.2139 70303.3464  43.9%     -   91s
     0     0 70302.3501    0  366 48851.2139 70302.3501  43.9%     -   91s
     0     0 70282.2786    0  371 48851.2139 70282.2786  43.9%     -   92s
     0     0 70274.7280    0  374 48851.2139 70274.7280  43.9%     -   93s
     0     0 70272.9326    0  379 48851.2139 70272.9326  43.9%     -   93s
     0     0 70269.3949    0  385 48851.2139 70269.3949  43.8%     -   94s
     0     0 70269.0088    0  384 48851.2139 70269.0088  43.8%     -   95s
     0     0 70267.5153    0  379 48851.2139 70267.5153  43.8%     -   96s
     0     0 70266.3935    0  377 48851.2139 70266.3935  43.8%     -   96s
     0     0 70258.1818    0  375 48851.2139 70258.1818  43.8%     -   97s
     0     0 70257.4841    0  375 48851.2139 70257.4841  43.8%     -   98s
H    0     2                    50130.521920 70257.4841  40.1%     -  135s
     0     2 70257.4841    0  375 50130.5219 70257.4841  40.1%     -  135s
     3     8 70210.4961    2  372 50130.5219 70231.4081  40.1%  2666  142s
     7    16 70039.9822    3  361 50130.5219 70209.6854  40.1%  4097  148s
    15    32 69933.3008    4  366 50130.5219 70098.3569  39.8%  5434  154s
    31    53 67134.0033    5  355 50130.5219 70013.2154  39.7%  7062  167s
    52    85 67432.2676    6  333 50130.5219 70013.2154  39.7%  7255  173s
H   55    85                    50143.637502 70013.2154  39.6%  7137  173s
H   70    85                    50474.094918 70013.2154  38.7%  6570  173s
    84   193 67400.9110    7  323 50474.0949 70013.2154  38.7%  5805  187s
   192   262 66797.9213    9  322 50474.0949 70013.2154  38.7%  3615  193s
   261   294 66626.3144    9  316 50474.0949 70013.2154  38.7%  3480  198s
H  264   294                    50516.316599 70013.2154  38.6%  3453  198s
H  270   294                    50684.062183 70013.2154  38.1%  3449  198s
   293   373 65423.5689    9  298 50684.0622 70013.2154  38.1%  3403  204s
H  295   373                    50759.857477 70013.2154  37.9%  3391  204s
H  362   373                    50779.036452 70013.2154  37.9%  3162  204s
   372   446 66460.9353   10  294 50779.0365 70013.2154  37.9%  3159  209s
   445   532 66600.4266   11  303 50779.0365 70013.2154  37.9%  3037  215s
H  470   532                    50824.118164 70013.2154  37.8%  2990  215s
   531   612 66531.9746   12  306 50824.1182 70013.2154  37.8%  2830  220s
   674   722 65398.8087   15  287 50824.1182 70013.2154  37.8%  2623  229s
   747   748 64839.4124   15  275 50824.1182 70013.2154  37.8%  2554  234s
   781   787 65059.3933   15  283 50824.1182 70013.2154  37.8%  2546  240s
H  851   823                    50859.256391 70013.2154  37.7%  2541  244s
   874   907 64572.0364   19  269 50859.2564 70013.2154  37.7%  2521  250s
   972   937 64013.2615   19  270 50859.2564 70013.2154  37.7%  2404  255s
H 1034   968                    51314.596984 70013.2154  36.4%  2397  258s
  1037  1064 64415.2231   21  266 51314.5970 70013.2154  36.4%  2400  263s
  1155  1089 64320.0920   22  265 51314.5970 70013.2154  36.4%  2289  267s
H 1170  1089                    51370.716740 70013.2154  36.3%  2279  267s
  1192  1187 63329.2649   21  208 51370.7167 70013.2154  36.3%  2285  272s
  1318  1216 63572.3340   24  256 51370.7167 70013.2154  36.3%  2203  278s
H 1319  1216                    51436.195369 70013.2154  36.1%  2201  278s
H 1345  1216                    51478.417051 69737.9261  35.5%  2200  278s
H 1361  1216                    51510.114875 69737.9261  35.4%  2194  278s
  1373  1313 62334.3997   22  208 51510.1149 69737.9261  35.4%  2191  283s
  1496  1375 63325.5650   23  208 51510.1149 69737.4194  35.4%  2136  290s
  1598  1457 63204.8585   25  248 51510.1149 69737.4194  35.4%  2136  296s
  1720  1552 62350.3278   26  245 51510.1149 69737.4194  35.4%  2126  303s
  1841  1584 62061.1690   26  263 51510.1149 69571.9872  35.1%  2122  309s
  1877  1656 57310.4566   26  176 51510.1149 69571.9872  35.1%  2150  315s
  1996  1716 62320.3888   27  236 51510.1149 69506.1018  34.9%  2150  324s
  2047  1779 60930.3083   28  170 51510.1149 69437.9952  34.8%  2163  329s
  2118  1836 61073.4984   28  199 51510.1149 69437.9952  34.8%  2154  337s
  2199  1874 60527.6950   29  208 51510.1149 69437.9952  34.8%  2141  344s
  2287  1951 57699.4407   29  182 51510.1149 69090.2406  34.1%  2139  351s
  2372  2018 59084.1960   28  151 51510.1149 69090.2406  34.1%  2150  359s
  2465  2110 60292.6913   29  204 51510.1149 69090.2406  34.1%  2146  367s
  2589  2203 59849.0363   30  205 51510.1149 69090.2406  34.1%  2121  375s
  2744  2308 58061.4356   31  166 51510.1149 69090.2406  34.1%  2097  385s
  2897  2440 57834.1817   31  161 51510.1149 68709.0774  33.4%  2076  392s
  3083  2582 57215.8348   32  164 51510.1149 68670.9768  33.3%  2054  400s
  3310  2723 56393.3761   34  182 51510.1149 68670.9768  33.3%  2021  410s
  3529  2886 54604.7344   38  149 51510.1149 68609.7725  33.2%  2005  420s
  3743  2887 54710.4764   28  375 51510.1149 68560.1896  33.1%  1990  443s
  3745  2888 62554.5354   18  120 51510.1149 68560.1896  33.1%  1989  464s
  3746  2889 61807.4795   18  261 51510.1149 68560.1896  33.1%  1988  474s
  3747  2890 62375.1812   23  310 51510.1149 68560.1896  33.1%  1987  483s
  3748  2890 59120.0630   26  351 51510.1149 68560.1896  33.1%  1987  489s
  3749  2891 67691.1392   17  356 51510.1149 68560.1896  33.1%  1986  496s
  3750  2892 66475.2537    8  368 51510.1149 68560.1896  33.1%  1986  502s
  3751  2892 65086.8728   13  367 51510.1149 68560.1896  33.1%  1985  506s
  3753  2894 62642.5440   23  390 51510.1149 68560.1896  33.1%  1984  510s
  3756  2896 54237.9569   22  388 51510.1149 68560.1896  33.1%  1983  515s
  3758  2897 57570.1504   35  386 51510.1149 68560.1896  33.1%  1982  522s
  3761  2899 56929.1013   38  393 51510.1149 68560.1896  33.1%  1980  526s
  3762  2900 64153.3226   16  409 51510.1149 68560.1896  33.1%  1980  530s
  3767  2903 64807.9164   13  402 51510.1149 68560.1896  33.1%  1977  537s
  3769  2904 54556.1120   29  422 51510.1149 68560.1896  33.1%  1976  540s
  3772  2906 61767.5195   22  426 51510.1149 68560.1896  33.1%  1974  545s
  3774  2908 62754.9813   13  399 51510.1149 68560.1896  33.1%  1973  550s
  3777  2910 56638.8571   34  384 51510.1149 68560.1896  33.1%  1972  555s
  3780  2912 61847.5353   18  376 51510.1149 68560.1896  33.1%  1970  560s
  3784  2914 65524.7981   15  389 51510.1149 68560.1896  33.1%  1968  565s
  3786  2916 57389.2043   27  379 51510.1149 68560.1896  33.1%  1967  586s
  3787  2916 57862.1772   33  379 51510.1149 68560.1896  33.1%  1967  602s
  3788  2920 68560.1896   10  372 51510.1149 68560.1896  33.1%  2014  608s
  3790  2923 68560.1896   11  375 51510.1149 68560.1896  33.1%  2016  621s
  3794  2930 68560.1896   12  387 51510.1149 68560.1896  33.1%  2021  634s
  3802  2943 68560.1896   13  380 51510.1149 68560.1896  33.1%  2033  649s
  3818  2957 67069.4485   14  383 51510.1149 68560.1896  33.1%  2096  665s
  3837  2983 66531.2822   15  314 51510.1149 68560.1896  33.1%  2130  682s
  3869  3004 65764.2364   16  312 51510.1149 68560.1896  33.1%  2167  694s
  3901  3028 65247.3230   17  288 51510.1149 68560.1896  33.1%  2218  709s
  3936  3083 65062.8587   18  260 51510.1149 68560.1896  33.1%  2252  721s
H 3982  2920                    51667.066279 68560.1896  32.7%  2267  721s
H 4004  2884                    51719.311410 68560.1896  32.6%  2272  735s
  4134  2909 64607.4828   20  245 51719.3114 68560.1896  32.6%  2296  745s
  4231  2922 63887.6213   20  243 51719.3114 68560.1896  32.6%  2316  757s
  4327  2927 60640.9946   20  189 51719.3114 68153.5820  31.8%  2327  772s
  4417  2918 62236.2128   21  221 51719.3114 68147.9402  31.8%  2340  781s
  4455  2936 61894.4393   21  219 51719.3114 68147.9402  31.8%  2355  788s
  4496  2947 61656.4449   22  213 51719.3114 68147.9402  31.8%  2371  796s
  4529  2960 61103.1340   23  186 51719.3114 68147.9402  31.8%  2377  803s
  4565  2977 60948.2413   24  179 51719.3114 68147.9402  31.8%  2385  811s
  4607  2981 60374.9926   25  141 51719.3114 67959.9078  31.4%  2383  818s
  4656  2997 60201.0163   26  154 51719.3114 67516.9173  30.5%  2386  830s
  4709  2996 59451.3023   27  143 51719.3114 67516.9173  30.5%  2385  837s
  4774  2991 57937.7493   27  136 51719.3114 67011.9618  29.6%  2392  847s
H 4803  2849                    51725.931064 66653.6897  28.9%  2398  847s
  4825  2883 58704.7597   29  145 51725.9311 66618.6416  28.8%  2402  858s
  4923  2885 56983.3638   31  156 51725.9311 66618.6416  28.8%  2414  866s
  4987  2894 58168.5649   30  134 51725.9311 65752.0151  27.1%  2433  875s
  5045  2921 52232.8643   31  103 51725.9311 65724.9077  27.1%  2451  885s
  5127  2946 55432.4449   33  160 51725.9311 65724.9077  27.1%  2461  897s
  5220  2947 53260.5536   35   99 51725.9311 65525.2897  26.7%  2470  906s
  5332  2959 52639.0196   36  121 51725.9311 65359.5078  26.4%  2481  918s
  5444  2952     cutoff   37      51725.9311 65359.5078  26.4%  2496  929s
  5540  2981 56204.6017   15  275 51725.9311 65359.5078  26.4%  2530  944s
  5656  3002 54715.1865   16  183 51725.9311 65359.5078  26.4%  2554  959s
  5779  2986 52069.2531   17  241 51725.9311 65359.5078  26.4%  2579  972s
  5894  2981 infeasible   17      51725.9311 65359.5078  26.4%  2612  984s
  5988  3009 52705.6663   18  261 51725.9311 65359.5078  26.4%  2646  998s
  6119  3012 infeasible   18      51725.9311 64527.4189  24.7%  2674 1013s
  6263  2997 53527.4553   19  210 51725.9311 64446.8124  24.6%  2703 1026s
  6406  3001     cutoff   20      51725.9311 64003.2348  23.7%  2735 1041s
  6533  3012     cutoff   26      51725.9311 63650.1964  23.1%  2777 1055s
  6670  3025 56856.5375   22  300 51725.9311 63415.2735  22.6%  2809 1072s
  6818  3032 54416.0760   24  293 51725.9311 63154.7597  22.1%  2842 1088s
  6923  3050 53384.2331   25  181 51725.9311 63023.7776  21.8%  2862 1102s
  7094  3028 53319.0613   26  202 51725.9311 63023.7776  21.8%  2897 1118s
  7279  3032 infeasible   28      51725.9311 62829.4497  21.5%  2925 1135s
  7472  3030 56123.9843   22  267 51725.9311 62822.6818  21.5%  2947 1153s
  7675  3000 53419.4137   27  279 51725.9311 62654.2694  21.1%  2971 1172s
  7874  2980 infeasible   21      51725.9311 62654.2694  21.1%  3005 1192s
  8065  2950 52515.7235   20  296 51725.9311 62058.8714  20.0%  3041 1210s
  8220  2981     cutoff   22      51725.9311 61922.7822  19.7%  3063 1232s
  8451  2918 54045.7266   22  245 51725.9311 61782.8688  19.4%  3078 1253s
  8676  2933     cutoff   22      51725.9311 61773.4818  19.4%  3115 1274s
  8912  2922 infeasible   25      51725.9311 61545.6048  19.0%  3148 1299s
  9183  2905     cutoff   26      51725.9311 61417.8075  18.7%  3172 1321s
  9484  2854     cutoff   19      51725.9311 61303.0828  18.5%  3190 1348s
  9750  2842     cutoff   31      51725.9311 61179.2945  18.3%  3222 1371s
 10051  2752 53588.2913   28  233 51725.9311 60987.3684  17.9%  3250 1392s
 10104  2746 52992.5747   29  245 51725.9311 60987.3684  17.9%  3256 1415s
 10159  2748 51950.3215   30  217 51725.9311 60987.3684  17.9%  3258 1435s
 10215  2731 51911.1537   31  220 51725.9311 60961.5385  17.9%  3262 1459s
 10323  2724 54040.0569   25  155 51725.9311 60818.5230  17.6%  3268 1484s
 10480  2691 55214.2344   20  251 51725.9311 60818.5230  17.6%  3277 1510s
 10693  2660 infeasible   42      51725.9311 60625.1847  17.2%  3300 1537s
 10962  2601 54032.7710   25  175 51725.9311 60610.0419  17.2%  3332 1568s
 11290  2557 52022.1116   26  157 51725.9311 60553.6498  17.1%  3353 1601s
 11683  2604 51932.0834   25  237 51725.9311 60245.7918  16.5%  3378 1634s
 12090  2675 56177.8542   22  280 51725.9311 60119.4036  16.2%  3410 1668s
 12520  2686 52641.5585   21  237 51725.9311 59963.5524  15.9%  3435 1703s
 12999  2721 infeasible   23      51725.9311 59861.3167  15.7%  3453 1737s
 13490  2779 52527.6833   25  143 51725.9311 59837.4439  15.7%  3475 1773s
 13982  2854 53476.0347   20  287 51725.9311 59620.9645  15.3%  3495 1817s
 14476  2890     cutoff   26      51725.9311 59426.5675  14.9%  3523 1863s
 15021  2942 56025.7338   23  333 51725.9311 59279.6941  14.6%  3539 1904s
 15542  2982     cutoff   24      51725.9311 58980.7140  14.0%  3558 1947s
 16091  3019 53545.9478   26  152 51725.9311 58825.8333  13.7%  3580 1992s
 16715  3066 52788.4925   23  227 51725.9311 58658.1404  13.4%  3592 2037s
 17332  3089 52983.1458   22  311 51725.9311 58461.9190  13.0%  3611 2085s
 17966  3076     cutoff   22      51725.9311 58275.3180  12.7%  3632 2138s
 18624  3084 53939.3663   22  273 51725.9311 58072.4216  12.3%  3656 2183s
 18736  3072 53149.8514   24  283 51725.9311 58041.6097  12.2%  3661 2233s
 19267  3061 53917.0742   25  244 51725.9311 57909.1753  12.0%  3665 2288s
 20008  3042     cutoff   27      51725.9311 57707.6621  11.6%  3681 2346s
 20775  2989 53978.7140   23  283 51725.9311 57522.5085  11.2%  3695 2409s
 21620  2912 infeasible   24      51725.9311 57329.5402  10.8%  3706 2469s
 22464  2820     cutoff   23      51725.9311 57068.1892  10.3%  3722 2534s
 23389  2728 53489.5920   28  226 51725.9311 56807.5319  9.82%  3728 2598s
 24339  2558     cutoff   25      51725.9311 56509.8483  9.25%  3738 2665s
 25285  2384 infeasible   23      51725.9311 56253.7676  8.75%  3751 2730s
 26311  2127 52885.8611   18  265 51725.9311 55980.6980  8.23%  3763 2798s
 27393  1775 infeasible   21      51725.9311 55664.2225  7.61%  3770 2865s
 28601  1324     cutoff   25      51725.9311 55178.4689  6.67%  3767 2932s
 29931   638     cutoff   26      51725.9311 54481.7203  5.33%  3757 3000s
*30494   638              58    51754.664574 54432.5803  5.17%  3743 3000s
*30497   638              60    51791.634401 54432.5803  5.10%  3742 3000s
 31555   128 infeasible   42      51791.6344 53854.3648  3.98%  3720 3062s
H31582   128                    51943.882833 53854.3648  3.68%  3718 3062s
H33326     0                    51972.069285 52058.6849  0.17%  3591 3064s
H33363     0                    52012.907819 52040.7181  0.05%  3587 3064s

Cutting planes:
  Learned: 1
  Gomory: 2
  MIR: 842
  Mixing: 2
  Flow cover: 1732
  Inf proof: 7
  RLT: 32
  Relax-and-lift: 173

Explored 33499 nodes (119886153 simplex iterations) in 3064.86 seconds (10856.56 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 52012.9 52012.9 51972.1 ... 51510.1

Optimal solution found (tolerance 1.00e-04)
Best objective 5.201290781875e+04, best bound 5.201290781875e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3064.87s
  Master Objective (UB) = 52012.91, θ = 225758.00
  Upper Bound (UB) = 52012.91

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 225758.00
  [DEBUG]   ✓ Scenario 0: θ = 225758.00 ≤ Q = 225758.00 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 225758.00 ≤ Q = 225758.00 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 225758.00 ≤ Q = 225758.00 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 225758.00 ≤ Q = 225758.00 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 225758.00 ≤ Q = 225758.00 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 225758.00 ≤ Q = 225771.69 (slack: 13.69)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x674ecbba
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x98b13446
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 1e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.403146e+13
Presolve removed 2599 rows and 1890 columns
Presolve time: 0.00s
Presolved: 494 rows, 499 columns, 1393 nonzeros
Found heuristic solution: objective 6799149.4343
Variable types: 339 continuous, 160 integer (160 binary)

Root relaxation: objective -1.841394e+05, 262 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -184139.43    0  131 6799149.43 -184139.43   103%     -    0s
H    0     0                    -145823.8600 -184139.43  26.3%     -    0s
H    0     0                    -147582.7877 -184139.43  24.8%     -    0s
H    0     0                    -167320.7003 -184139.43  10.1%     -    0s
     0     0 -171234.13    0   71 -167320.70 -171234.13  2.34%     -    0s
H    0     0                    -169558.2900 -171206.34  0.97%     -    0s
H    0     0                    -169990.3756 -170279.43  0.17%     -    0s
     0     0 -170279.43    0   73 -169990.38 -170279.43  0.17%     -    0s
     0     0 -170151.67    0   34 -169990.38 -170151.67  0.09%     -    0s
     0     0 -170130.24    0   17 -169990.38 -170130.24  0.08%     -    0s
     0     0 -170118.62    0   15 -169990.38 -170118.62  0.08%     -    0s
     0     0 -170114.17    0   14 -169990.38 -170114.17  0.07%     -    0s
     0     0 -170040.00    0    6 -169990.38 -170040.00  0.03%     -    0s
     0     0 -170027.56    0    6 -169990.38 -170027.56  0.02%     -    0s
H    0     0                    -170003.5052 -170027.56  0.01%     -    0s

Cutting planes:
  Gomory: 1
  Implied bound: 1
  MIR: 1
  Flow cover: 4
  RLT: 1
  Relax-and-lift: 2

Explored 1 nodes (659 simplex iterations) in 0.05 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 8: -170004 -169990 -168968 ... 1.40315e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.700035052200e+05, best bound -1.700194580145e+05, gap 0.0094%
  Subproblem solved in 0.06s
  Worst-case operational profit (Z_SP) = 203465.51
  Scenario: 35 demand increases, 25 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -170003.51
  [DEBUG]   S×d_nominal = 373469.02
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 373469.02 + -170003.51 = 203465.51
  [DEBUG]   Current θ from Master = 225758.00
  [DEBUG]   ⚠️  Z_SP ≤ θ by 22292.49 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 29720.42
  Lower Bound (LB) = 45250.14
  Gap (UB-LB) = 6762.7651, Absolute Gap = 6762.7651, Relative Gap = 0.130021
  Not converged yet (gap = 6762.77 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 35 increases, 25 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308136 nonzeros
Model fingerprint: 0xaefda838
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 49570 rows and 20130 columns
Presolve time: 0.95s
Presolved: 58843 rows, 25810 columns, 365849 nonzeros
Variable types: 23551 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -275122.5137
Found heuristic solution: objective -155958.4539

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 58843 rows, 25810 columns, 365849 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   32289   -1.7178383e+03   0.000000e+00   3.321120e+08      5s
   46279    3.3493762e+04   0.000000e+00   4.777996e+06     10s
   58085    5.1147452e+04   0.000000e+00   2.999236e+07     15s
   69712    6.3774343e+04   0.000000e+00   4.135380e+06     20s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 8.623093e+04, 49154 iterations, 23.28 seconds (49.70 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 86230.9316    0  126 -155958.45 86230.9316   155%     -   24s
H    0     0                    -150499.3361 86230.9316   157%     -   24s
H    0     0                    -114192.4586 86230.9316   176%     -   24s
H    0     0                    -112948.4280 86230.9316   176%     -   24s
H    0     0                    -95810.84206 86230.9316   190%     -   24s
H    0     0                    -95705.11584 86230.9316   190%     -   24s
H    0     0                    -93836.55468 86230.9316   192%     -   25s
H    0     0                    -93259.42312 86230.9316   192%     -   25s
H    0     0                    -90096.64735 86230.9316   196%     -   25s
H    0     0                    -88118.22381 86230.9316   198%     -   25s
H    0     0                    -86881.59561 86230.9316   199%     -   25s
H    0     0                    -86874.16322 86230.9316   199%     -   25s
H    0     0                    -26830.46882 86230.9316   421%     -   25s
H    0     0                    -13105.93269 86230.9316   758%     -   25s
H    0     0                    -12291.52318 86230.9316   802%     -   25s
H    0     0                    15813.224723 86230.9316   445%     -   25s
H    0     0                    23759.321453 86230.9316   263%     -   25s
H    0     0                    36677.138104 86230.9316   135%     -   25s
H    0     0                    38188.304156 86230.9316   126%     -   25s
H    0     0                    39339.865543 86230.9316   119%     -   25s
H    0     0                    42321.067108 86230.9316   104%     -   25s
H    0     0                    42331.496473 86230.9316   104%     -   25s
H    0     0                    42355.119928 86230.9316   104%     -   25s
H    0     0                    42871.601583 80686.8446  88.2%     -   34s
H    0     0                    43315.534754 80686.8446  86.3%     -   34s
H    0     0                    43392.327247 80686.8446  85.9%     -   34s
H    0     0                    43434.975401 80686.8446  85.8%     -   34s
H    0     0                    43626.258759 80686.8446  85.0%     -   34s
     0     0 80686.8446    0  166 43626.2588 80686.8446  85.0%     -   34s
H    0     0                    44310.195897 80686.7989  82.1%     -   34s
     0     0 80078.6930    0  169 44310.1959 80078.6930  80.7%     -   36s
     0     0 80067.0970    0  163 44310.1959 80067.0970  80.7%     -   37s
     0     0 80067.0970    0  167 44310.1959 80067.0970  80.7%     -   38s
     0     0 80067.0970    0  163 44310.1959 80067.0970  80.7%     -   38s
     0     0 80067.0970    0  175 44310.1959 80067.0970  80.7%     -   39s
     0     0 80067.0970    0  168 44310.1959 80067.0970  80.7%     -   39s
     0     0 80067.0970    0  168 44310.1959 80067.0970  80.7%     -   39s
     0     0 77168.9320    0  217 44310.1959 77168.9320  74.2%     -   48s
H    0     0                    45793.100061 77168.9320  68.5%     -   48s
H    0     0                    45816.191969 77168.9320  68.4%     -   48s
H    0     0                    46163.359099 77168.9320  67.2%     -   48s
H    0     0                    46270.141062 77168.9320  66.8%     -   48s
H    0     0                    46600.846942 77168.9320  65.6%     -   48s
     0     0 76547.2217    0  236 46600.8469 76547.2217  64.3%     -   53s
     0     0 76472.3141    0  249 46600.8469 76472.3141  64.1%     -   55s
     0     0 76445.7943    0  251 46600.8469 76445.7943  64.0%     -   56s
     0     0 76445.0875    0  256 46600.8469 76445.0875  64.0%     -   56s
H    0     0                    47035.479751 74425.8056  58.2%     -   69s
H    0     0                    47162.197521 74425.8056  57.8%     -   69s
     0     0 74425.8056    0  276 47162.1975 74425.8056  57.8%     -   69s
H    0     0                    47336.171486 74425.4032  57.2%     -   69s
H    0     0                    47464.187123 74425.4032  56.8%     -   69s
     0     0 73927.6339    0  287 47464.1871 73927.6339  55.8%     -   75s
     0     0 73766.9273    0  302 47464.1871 73766.9273  55.4%     -   78s
     0     0 73688.3713    0  309 47464.1871 73688.3713  55.3%     -   79s
     0     0 73642.3046    0  308 47464.1871 73642.3046  55.2%     -   80s
     0     0 73610.9429    0  313 47464.1871 73610.9429  55.1%     -   81s
     0     0 73598.7724    0  317 47464.1871 73598.7724  55.1%     -   82s
     0     0 73592.9850    0  318 47464.1871 73592.9850  55.0%     -   82s
     0     0 73587.7453    0  317 47464.1871 73587.7453  55.0%     -   82s
     0     0 73541.4655    0  325 47464.1871 73541.4655  54.9%     -   84s
     0     0 73531.4832    0  326 47464.1871 73531.4832  54.9%     -   84s
     0     0 73528.7823    0  324 47464.1871 73528.7823  54.9%     -   85s
     0     0 73528.4686    0  324 47464.1871 73528.4686  54.9%     -   85s
     0     0 72754.6840    0  324 47464.1871 72754.6840  53.3%     -   95s
     0     0 72569.2886    0  336 47464.1871 72569.2886  52.9%     -   98s
     0     0 72515.5657    0  332 47464.1871 72515.5657  52.8%     -  100s
     0     0 72482.9942    0  341 47464.1871 72482.9942  52.7%     -  101s
     0     0 72450.4019    0  332 47464.1871 72450.4019  52.6%     -  102s
     0     0 72444.8667    0  331 47464.1871 72444.8667  52.6%     -  102s
     0     0 72435.0920    0  310 47464.1871 72435.0920  52.6%     -  103s
     0     0 72426.4319    0  311 47464.1871 72426.4319  52.6%     -  104s
     0     0 72424.5707    0  318 47464.1871 72424.5707  52.6%     -  105s
     0     0 72422.5542    0  318 47464.1871 72422.5542  52.6%     -  105s
     0     0 72421.9498    0  317 47464.1871 72421.9498  52.6%     -  105s
     0     0 72288.7836    0  321 47464.1871 72288.7836  52.3%     -  108s
H    0     0                    47465.952230 72287.6098  52.3%     -  108s
H    0     0                    47501.920675 72287.6098  52.2%     -  108s
     0     0 72226.8176    0  321 47501.9207 72226.8176  52.1%     -  110s
     0     0 72203.4829    0  324 47501.9207 72203.4829  52.0%     -  111s
     0     0 72187.0433    0  332 47501.9207 72187.0433  52.0%     -  111s
     0     0 72178.4062    0  329 47501.9207 72178.4062  51.9%     -  112s
     0     0 72176.9735    0  331 47501.9207 72176.9735  51.9%     -  112s
     0     0 72114.3753    0  321 47501.9207 72114.3753  51.8%     -  114s
H    0     0                    49841.649523 72111.9563  44.7%     -  115s
     0     0 72094.0510    0  330 49841.6495 72094.0510  44.6%     -  116s
     0     0 72091.1023    0  336 49841.6495 72091.1023  44.6%     -  117s
     0     0 72090.4484    0  338 49841.6495 72090.4484  44.6%     -  117s
     0     0 72077.5754    0  348 49841.6495 72077.5754  44.6%     -  118s
H    0     0                    49916.641587 72077.5533  44.4%     -  118s
     0     0 72074.0465    0  339 49916.6416 72074.0465  44.4%     -  119s
     0     0 72073.1667    0  342 49916.6416 72073.1667  44.4%     -  119s
     0     0 72068.0604    0  342 49916.6416 72068.0604  44.4%     -  120s
     0     0 72064.2443    0  341 49916.6416 72064.2443  44.4%     -  121s
     0     0 72063.2418    0  342 49916.6416 72063.2418  44.4%     -  121s
     0     0 72059.1490    0  354 49916.6416 72059.1490  44.4%     -  122s
     0     0 72054.6725    0  344 49916.6416 72054.6725  44.4%     -  123s
     0     0 72053.0523    0  351 49916.6416 72053.0523  44.3%     -  123s
     0     0 72049.1589    0  333 49916.6416 72049.1589  44.3%     -  124s
     0     0 72048.9517    0  333 49916.6416 72048.9517  44.3%     -  125s
H    0     0                    50349.403940 72048.9517  43.1%     -  141s
     0     2 72048.9517    0  333 50349.4039 72048.9517  43.1%     -  145s
     3     8 71804.4627    2  312 50349.4039 71934.1446  42.9%  2766  155s
     7    16 71577.5625    3  320 50349.4039 71800.4213  42.6%  4911  163s
    15    32 71352.9985    4  331 50349.4039 71576.1427  42.2%  5187  173s
    31    48 70196.5941    5  320 50349.4039 71350.9916  41.7% 10405  188s
H   47    80                    50397.186345 71350.9916  41.6%  9569  198s
H   51    80                    51310.263477 71350.9916  39.1%  9633  198s
    79   151 68782.6567    7  322 51310.2635 71350.9916  39.1%  7738  219s
   150   310 68716.6699    9  316 51310.2635 71350.9916  39.1%  4716  228s
   309   399 68577.2762   13  305 51310.2635 71350.9916  39.1%  3100  234s
   398   431 65772.2994   12  278 51310.2635 71350.9916  39.1%  2902  240s
   430   475 68417.6753   14  299 51310.2635 71350.9916  39.1%  2908  247s
   474   507 67833.1963   14  280 51310.2635 71350.9916  39.1%  2950  255s
   506   544 67795.8346   14  222 51310.2635 71350.9916  39.1%  2936  267s
   543   580 67991.9071   15  211 51310.2635 71350.9916  39.1%  2889  272s
   585   610 67486.4566   15  233 51310.2635 71350.9916  39.1%  2836  280s
   619   641 67543.3213   15  293 51310.2635 71350.9916  39.1%  2795  287s
H  638   641                    51393.674760 71350.9916  38.8%  2760  287s
   654   741 67732.8879   15  273 51393.6748 71350.9916  38.8%  2742  295s
   767   789 67664.2238   15  205 51393.6748 71350.9916  38.8%  2563  302s
   862   825 67300.2560   15  192 51393.6748 71350.9916  38.8%  2445  310s
   948   874 65515.2922   16  199 51393.6748 71283.5432  38.7%  2415  318s
  1026   938 66576.7203   16  206 51393.6748 71283.5432  38.7%  2397  327s
  1112  1010 65835.2926   17  195 51393.6748 71283.5432  38.7%  2399  335s
  1209  1081 61391.9312   17  259 51393.6748 71283.5432  38.7%  2349  344s
  1302  1168 62861.0035   18  227 51393.6748 71173.1782  38.5%  2322  353s
  1421  1243 62177.4351   19  213 51393.6748 71173.1782  38.5%  2258  362s
  1528  1334 61904.3987   20  197 51393.6748 71038.3563  38.2%  2236  371s
  1643  1365 60676.3116   21  211 51393.6748 71038.3563  38.2%  2210  380s
  1674  1403 61093.3347   21  193 51393.6748 71038.3563  38.2%  2230  387s
  1716  1449 60841.9064   22  198 51393.6748 71038.3563  38.2%  2232  396s
  1770  1491 60285.4636   23  200 51393.6748 70863.8745  37.9%  2234  405s
  1817  1533 58832.8445   22  192 51393.6748 70863.8745  37.9%  2243  415s
  1890  1593 59926.5486   24  203 51393.6748 70863.8745  37.9%  2243  421s
  1968  1645 59106.4972   25  244 51393.6748 70863.8745  37.9%  2220  430s
  2069  1705 56038.4007   23  166 51393.6748 70863.8745  37.9%  2181  440s
  2149  1807 56804.9531   24  204 51393.6748 70863.8745  37.9%  2172  448s
  2261  1899 55690.6834   25  200 51393.6748 70863.8745  37.9%  2147  459s
  2425  1979 58653.5960   26  234 51393.6748 69835.8642  35.9%  2092  470s
  2557  2068 58831.7339   26  243 51393.6748 69607.5403  35.4%  2081  482s
  2683  2193 58665.7322   27  241 51393.6748 69607.5403  35.4%  2075  494s
  2836  2223 58373.4289   28  229 51393.6748 69600.0898  35.4%  2070  501s
  2870  2252 57818.2380   29  220 51393.6748 69544.6073  35.3%  2077  508s
  2907  2298 57704.8829   29  232 51393.6748 69544.6073  35.3%  2091  516s
  2953  2403 57582.4098   29  227 51393.6748 69544.6073  35.3%  2090  527s
  3090  2505 57593.1906   29  223 51393.6748 69544.6073  35.3%  2059  539s
  3221  2620 57699.3762   30  229 51393.6748 69526.5978  35.3%  2030  552s
  3404  2807 57433.5546   31  194 51393.6748 69526.5978  35.3%  1997  568s
  3668  2808 53899.8146   31  333 51393.6748 69359.8044  35.0%  1940  594s
  3670  2809 61494.5458   12  126 51393.6748 69359.8044  35.0%  1939  624s
  3671  2810 54613.1817   44  272 51393.6748 69359.8044  35.0%  1938  639s
  3672  2811 56517.7004   21  301 51393.6748 69359.8044  35.0%  1938  650s
  3673  2811 64457.3531    9  342 51393.6748 69359.8044  35.0%  1937  656s
  3674  2812 59004.5773   22  336 51393.6748 69359.8044  35.0%  1937  661s
  3676  2813 56993.2108   29  355 51393.6748 69359.8044  35.0%  1936  666s
  3680  2816 55611.1782   27  340 51393.6748 69359.8044  35.0%  1933  670s
  3681  2817 63486.5640   17  386 51393.6748 69359.8044  35.0%  1933  680s
  3683  2818 64143.6953   16  444 51393.6748 69359.8044  35.0%  1932  687s
  3686  2820 56274.1122   35  437 51393.6748 69359.8044  35.0%  1930  691s
  3687  2821 63038.6570    8  371 51393.6748 69359.8044  35.0%  1930  698s
  3688  2821 52423.2322   28  386 51393.6748 69359.8044  35.0%  1929  701s
  3691  2823 62325.6927   13  461 51393.6748 69359.8044  35.0%  1928  705s
  3693  2825 52859.5554   44  387 51393.6748 69359.8044  35.0%  1927  712s
  3695  2826 57666.4988   22  391 51393.6748 69359.8044  35.0%  1926  715s
  3697  2827 53022.3357   56  470 51393.6748 69359.8044  35.0%  1925  721s
  3698  2828 52968.0125   44  446 51393.6748 69359.8044  35.0%  1924  725s
  3700  2829 64006.1215   12  402 51393.6748 69359.8044  35.0%  1923  730s
  3702  2831 58819.9200   28  345 51393.6748 69359.8044  35.0%  1922  735s
  3704  2832 68702.0186    5  389 51393.6748 69359.8044  35.0%  1921  740s
  3707  2834 60537.8224   24  485 51393.6748 69359.8044  35.0%  1919  768s
  3708  2835 56373.7738   45  485 51393.6748 69359.8044  35.0%  1919  785s
  3709  2838 69359.8044   14  421 51393.6748 69359.8044  35.0%  1971  804s
  3711  2842 69359.8044   15  340 51393.6748 69359.8044  35.0%  1973  818s
  3715  2848 69234.7635   16  354 51393.6748 69359.8044  35.0%  1978  832s
  3723  2862 68660.7287   17  390 51393.6748 69270.0453  34.8%  1997  853s
  3739  2872 67903.4543   18  294 51393.6748 69070.5876  34.4%  2037  884s
  3755  2899 64360.1782   19  265 51393.6748 69070.5876  34.4%  2116  899s
  3787  2969 63638.5320   20  250 51393.6748 69070.5876  34.4%  2178  918s
  3868  3038 60440.5993   21  222 51393.6748 69070.5876  34.4%  2319  931s
  3979  3076 59867.4923   23  230 51393.6748 69070.5876  34.4%  2336  943s
  4078  3063 58283.7356   23  235 51393.6748 69070.5876  34.4%  2334  953s
  4113  3083 60141.6689   22  241 51393.6748 69070.5876  34.4%  2343  963s
  4179  3106 59698.3447   24  225 51393.6748 69070.5876  34.4%  2347  975s
  4252  3121 58791.5683   25  231 51393.6748 69070.5876  34.4%  2350  983s
  4330  3102 58878.7390   26  217 51393.6748 69070.5876  34.4%  2351  994s
  4377  3107 58596.6042   27  243 51393.6748 69070.5876  34.4%  2348 1006s
  4416  3105 58025.9760   28  205 51393.6748 69070.5876  34.4%  2358 1018s
  4462  3101 57211.7298   28  189 51393.6748 68671.6527  33.6%  2367 1029s
  4510  3105 56826.6038   29  188 51393.6748 68671.6527  33.6%  2379 1038s
  4549  3103 56282.2574   30  166 51393.6748 68671.6527  33.6%  2388 1052s
  4602  3106 56650.6621   30  182 51393.6748 68671.6527  33.6%  2397 1067s
  4652  3106 56474.4642   31  190 51393.6748 68362.1206  33.0%  2411 1077s
  4706  3116 56222.5493   32  182 51393.6748 68362.1206  33.0%  2424 1089s
  4763  3118 56119.0695   31  168 51393.6748 68290.9068  32.9%  2437 1099s
  4829  3127 infeasible   34      51393.6748 68290.9068  32.9%  2454 1108s
  4890  3124     cutoff   35      51393.6748 68290.9068  32.9%  2469 1119s
  4974  3127 52063.7242   40  208 51393.6748 68290.9068  32.9%  2474 1131s
  5052  3120 52197.2436   40  218 51393.6748 68290.9068  32.9%  2482 1145s
  5140  3124     cutoff   43      51393.6748 68290.9068  32.9%  2493 1157s
  5218  3154 62309.0683   19  221 51393.6748 68290.9068  32.9%  2515 1169s
  5300  3177 54216.5453   21  201 51393.6748 66659.4964  29.7%  2536 1185s
  5396  3168 52390.5766   25  132 51393.6748 66659.4964  29.7%  2547 1199s
  5506  3171 55654.5787   27  186 51393.6748 66211.3436  28.8%  2558 1211s
  5619  3179 57473.5805   21  302 51393.6748 66211.3436  28.8%  2573 1225s
  5728  3181 56200.8712   23  214 51393.6748 65518.6827  27.5%  2588 1240s
  5839  3178 51768.9558   26  222 51393.6748 65518.6827  27.5%  2606 1254s
  5923  3194 54994.4497   22  258 51393.6748 65518.6827  27.5%  2614 1269s
  6047  3216 54514.1875   25  218 51393.6748 65518.6827  27.5%  2625 1285s
  6189  3223 53169.3104   28  232 51393.6748 65518.6827  27.5%  2638 1302s
  6338  3232 51672.4587   32  184 51393.6748 65518.6827  27.5%  2654 1319s
  6498  3251 55679.9401   21  290 51393.6748 65518.6827  27.5%  2667 1338s
  6660  3255 58614.9590   22  288 51393.6748 65183.5511  26.8%  2682 1355s
  6819  3285 52236.8576   23  264 51393.6748 64937.1074  26.4%  2700 1372s
  7002  3265 56887.4189   24  186 51393.6748 64937.1074  26.4%  2706 1389s
  7182  3294 51610.1305   28  185 51393.6748 64937.1074  26.4%  2706 1413s
  7416  3273     cutoff   29      51393.6748 64937.1074  26.4%  2697 1435s
  7624  3292 55292.1082   26  250 51393.6748 64937.1074  26.4%  2713 1458s
  7818  3283 51644.3926   30  218 51393.6748 64937.1074  26.4%  2728 1480s
  8046  3247 52235.2415   29  154 51393.6748 63055.8637  22.7%  2742 1504s
  8259  3191 55409.1955   25  299 51393.6748 62972.5154  22.5%  2766 1523s
  8308  3199 54649.4952   26  273 51393.6748 62250.7524  21.1%  2775 1539s
  8346  3210 54138.3710   27  268 51393.6748 62250.7524  21.1%  2780 1556s
  8386  3206 52885.3963   28  305 51393.6748 62250.7524  21.1%  2789 1574s
  8439  3199 52845.5420   29  300 51393.6748 62250.7524  21.1%  2790 1591s
  8494  3200     cutoff   30      51393.6748 62250.7524  21.1%  2797 1616s
  8648  3236     cutoff   26      51393.6748 62208.0070  21.0%  2795 1641s
  8888  3243 57155.0165   24  297 51393.6748 61977.3820  20.6%  2787 1668s
  9179  3228 55390.4231   26  310 51393.6748 61907.0968  20.5%  2789 1698s
  9517  3131     cutoff   32      51393.6748 61892.0509  20.4%  2795 1724s
  9605  3179     cutoff   31      51393.6748 61740.6312  20.1%  2803 1749s
  9837  3165 56935.4538   28  239 51393.6748 61496.6104  19.7%  2812 1777s
 10042  3122 54747.7615   31  186 51393.6748 61496.6104  19.7%  2813 1805s
 10209  3105 53993.6275   32  208 51393.6748 61496.6104  19.7%  2826 1834s
 10396  3103 52988.0472   33  216 51393.6748 61154.0279  19.0%  2832 1864s
 10600  3117 52764.0786   34  205 51393.6748 61028.5626  18.7%  2841 1897s
 10979  3089 53989.9006   35  215 51393.6748 61025.7550  18.7%  2851 1934s
 11388  3050 51948.9625   26  189 51393.6748 60669.9978  18.0%  2867 1972s
 11802  2956 51748.2135   34  213 51393.6748 60539.3232  17.8%  2890 2010s
 12244  2927     cutoff   29      51393.6748 60338.4851  17.4%  2909 2052s
 12729  3025 57206.0537   28  252 51393.6748 60029.2411  16.8%  2920 2098s
 13198  3072     cutoff   37      51393.6748 59824.8140  16.4%  2936 2148s
 13659  3178 51692.6000   29  265 51393.6748 59543.1473  15.9%  2964 2191s
 14139  3198     cutoff   33      51393.6748 59448.9340  15.7%  2992 2226s
 14186  3227     cutoff   35      51393.6748 59429.1700  15.6%  2997 2267s
 14483  3255     cutoff   28      51393.6748 59429.1700  15.6%  3012 2317s
 15029  3355 53689.8178   28  296 51393.6748 59147.6520  15.1%  3032 2368s
 15576  3399 54071.1773   27  234 51393.6748 59028.4251  14.9%  3056 2422s
 16218  3471     cutoff   27      51393.6748 58948.8101  14.7%  3064 2478s
 16826  3516     cutoff   34      51393.6748 58726.6552  14.3%  3085 2539s
 17494  3578     cutoff   30      51393.6748 58433.7746  13.7%  3099 2598s
 18149  3628     cutoff   30      51393.6748 58262.0777  13.4%  3118 2665s
 18870  3665 54268.0276   25  265 51393.6748 58063.8827  13.0%  3128 2730s
 19587  3712 56138.4747   29  289 51393.6748 57857.2244  12.6%  3145 2794s
 20421  3677 52739.2200   30  207 51393.6748 57714.1616  12.3%  3148 2866s
 21165  3654     cutoff   25      51393.6748 57476.1643  11.8%  3168 2937s
 21992  3605 52018.5272   26  236 51393.6748 57314.0751  11.5%  3182 3008s
 22872  3563 54374.8512   28  260 51393.6748 57083.6365  11.1%  3193 3094s
 23745  3492 52470.9089   31  183 51393.6748 56884.6517  10.7%  3205 3176s
 24711  3381     cutoff   31      51393.6748 56635.2168  10.2%  3210 3260s
 25666  3250 51713.3592   28  178 51393.6748 56481.8355  9.90%  3221 3344s
 26752  3075 infeasible   37      51393.6748 56120.8359  9.20%  3221 3430s
 27795  2824 infeasible   26      51393.6748 55950.5638  8.87%  3230 3520s
 28952  2468 52835.2329   26  257 51393.6748 55608.7597  8.20%  3233 3600s

Cutting planes:
  Learned: 2
  Gomory: 1
  MIR: 812
  Flow cover: 2215
  RLT: 27
  Relax-and-lift: 218

Explored 30258 nodes (97563257 simplex iterations) in 3600.05 seconds (11548.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 51393.7 51310.3 50397.2 ... 47336.2

Time limit reached
Best objective 5.139367475980e+04, best bound 5.511544285668e+04, gap 7.2417%
  WARNING: Time limit reached. Using best solution found (gap: 7.24%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = 51393.67, θ = 225210.25
  Upper Bound (UB) = 51393.67

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 225210.25
  [DEBUG]   ✓ Scenario 0: θ = 225210.25 ≤ Q = 225210.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 225210.25 ≤ Q = 225210.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 225210.25 ≤ Q = 225210.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 225210.25 ≤ Q = 225210.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 225210.25 ≤ Q = 225210.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 225210.25 ≤ Q = 225210.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 225210.25 ≤ Q = 225210.25 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x46004609
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x46004609
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 1e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.405939e+13
Presolve removed 2599 rows and 1890 columns
Presolve time: 0.00s
Presolved: 494 rows, 499 columns, 1393 nonzeros
Found heuristic solution: objective 6809115.2084
Variable types: 339 continuous, 160 integer (160 binary)

Root relaxation: objective -1.822586e+05, 255 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -182258.60    0  125 6809115.21 -182258.60   103%     -    0s
H    0     0                    -143608.8662 -182258.60  26.9%     -    0s
H    0     0                    -146782.2053 -166513.11  13.4%     -    0s
H    0     0                    -155253.3747 -166513.11  7.25%     -    0s
H    0     0                    -158097.7380 -166513.11  5.32%     -    0s
     0     0 -166513.11    0   84 -158097.74 -166513.11  5.32%     -    0s
H    0     0                    -159168.2605 -166509.17  4.61%     -    0s
H    0     0                    -162306.9325 -166509.17  2.59%     -    0s
H    0     0                    -164823.1825 -166509.17  1.02%     -    0s
     0     0 -166418.59    0   69 -164823.18 -166418.59  0.97%     -    0s
H    0     0                    -164834.9338 -166375.20  0.93%     -    0s
     0     0 -166375.20    0   84 -164834.93 -166375.20  0.93%     -    0s
     0     0 -166032.58    0   55 -164834.93 -166032.58  0.73%     -    0s
H    0     0                    -164846.1342 -166013.56  0.71%     -    0s
     0     0 -165918.54    0   74 -164846.13 -165918.54  0.65%     -    0s
     0     0 -165875.15    0   74 -164846.13 -165875.15  0.62%     -    0s
     0     0 -165650.51    0   36 -164846.13 -165650.51  0.49%     -    0s
H    0     0                    -164862.5710 -165585.38  0.44%     -    0s
     0     0 -165585.38    0   46 -164862.57 -165585.38  0.44%     -    0s
     0     0 -165331.82    0   35 -164862.57 -165331.82  0.28%     -    0s
     0     0 -165286.24    0   36 -164862.57 -165286.24  0.26%     -    0s
     0     0 -165279.23    0   37 -164862.57 -165279.23  0.25%     -    0s
     0     0 -165047.60    0   19 -164862.57 -165047.60  0.11%     -    0s
     0     0 -165024.51    0   18 -164862.57 -165024.51  0.10%     -    0s
     0     0 -165024.51    0   17 -164862.57 -165024.51  0.10%     -    0s
     0     0 -164920.55    0   13 -164862.57 -164920.55  0.04%     -    0s
     0     0 -164920.55    0   11 -164862.57 -164920.55  0.04%     -    0s
     0     0 -164884.19    0    5 -164862.57 -164884.19  0.01%     -    0s
H    0     0                    -164876.7390 -164882.29  0.00%     -    0s

Cutting planes:
  Gomory: 2
  Implied bound: 3
  MIR: 5
  Flow cover: 5
  Relax-and-lift: 2

Explored 1 nodes (965 simplex iterations) in 0.09 seconds (0.06 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -164877 -164863 -164846 ... 1.40594e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.648767390030e+05, best bound -1.648822885019e+05, gap 0.0034%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 208592.28
  Scenario: 27 demand increases, 33 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -164876.74
  [DEBUG]   S×d_nominal = 373469.02
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 373469.02 + -164876.74 = 208592.28
  [DEBUG]   Current θ from Master = 225210.25
  [DEBUG]   ⚠️  Z_SP ≤ θ by 16617.97 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 34775.71
  Lower Bound (LB) = 45250.14
  Gap (UB-LB) = 6143.5321, Absolute Gap = 6143.5321, Relative Gap = 0.119539
  Not converged yet (gap = 6143.53 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 27 increases, 33 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351367 nonzeros
Model fingerprint: 0x6edfdc34
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 56660 rows and 23010 columns
Presolve time: 1.09s
Presolved: 67043 rows, 29170 columns, 417299 nonzeros
Variable types: 26911 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -275122.5137
Found heuristic solution: objective -155958.4539

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 67043 rows, 29170 columns, 417299 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   35167    3.1736268e+02   0.000000e+00   3.463502e+06      5s
   48002    5.1466853e+04   0.000000e+00   1.469646e+07     10s
   58207    5.9055228e+04   0.000000e+00   2.755010e+06     15s
   66861    6.3134482e+04   0.000000e+00   1.075679e+07     20s
   76408    7.0168757e+04   0.000000e+00   6.805891e+07     25s
   86798    7.5945288e+04   0.000000e+00   2.289025e+06     30s
   97398    8.3327853e+04   0.000000e+00   3.581363e+05     35s
Concurrent spin time: 10.99s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 8.623093e+04, 82660 iterations, 48.36 seconds (85.08 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 86230.9316    0  126 -155958.45 86230.9316   155%     -   49s
H    0     0                    -143814.5748 86230.9316   160%     -   49s
H    0     0                    -137530.5156 86230.9316   163%     -   50s
H    0     0                    -137260.2795 86230.9316   163%     -   50s
H    0     0                    -122169.6291 86230.9316   171%     -   50s
H    0     0                    -114842.1571 86230.9316   175%     -   50s
H    0     0                    -96602.53549 86230.9316   189%     -   50s
H    0     0                    -90689.82640 86230.9316   195%     -   50s
H    0     0                    -90132.64320 86230.9316   196%     -   50s
H    0     0                    -26830.46882 86230.9316   421%     -   50s
H    0     0                    -23773.49994 86230.9316   463%     -   50s
H    0     0                    -23766.38244 86230.9316   463%     -   50s
H    0     0                    -18725.32752 86230.9316   561%     -   50s
H    0     0                    -3313.397443 86230.9316  2702%     -   50s
H    0     0                    40528.392888 86230.9316   113%     -   50s
H    0     0                    41683.743975 86230.9316   107%     -   50s
H    0     0                    42331.496473 86230.9316   104%     -   50s
H    0     0                    42355.119928 86230.9316   104%     -   50s
     0     0 80175.7181    0  170 42355.1199 80175.7181  89.3%     -   58s
H    0     0                    43183.758479 80175.1852  85.7%     -   59s
H    0     0                    43349.073519 80175.1852  85.0%     -   59s
     0     0 79700.7503    0  178 43349.0735 79700.7503  83.9%     -   62s
     0     0 79599.1291    0  185 43349.0735 79599.1291  83.6%     -   64s
     0     0 79577.2941    0  186 43349.0735 79577.2941  83.6%     -   65s
     0     0 79510.0818    0  190 43349.0735 79510.0818  83.4%     -   66s
     0     0 79475.2645    0  179 43349.0735 79475.2645  83.3%     -   67s
     0     0 79475.2645    0  180 43349.0735 79475.2645  83.3%     -   67s
     0     0 79475.2645    0  180 43349.0735 79475.2645  83.3%     -   68s
     0     0 79475.2645    0  180 43349.0735 79475.2645  83.3%     -   68s
H    0     0                    43557.956633 76907.1836  76.6%     -   78s
     0     0 76823.5515    0  235 43557.9566 76823.5515  76.4%     -   78s
H    0     0                    43912.253063 76823.5515  74.9%     -   79s
H    0     0                    45507.243323 76823.5515  68.8%     -   79s
     0     0 76178.8895    0  251 45507.2433 76178.8895  67.4%     -   88s
     0     0 75930.1480    0  252 45507.2433 75930.1480  66.9%     -   92s
     0     0 75828.5690    0  257 45507.2433 75828.5690  66.6%     -   95s
     0     0 75769.5687    0  251 45507.2433 75769.5687  66.5%     -   98s
     0     0 75746.3530    0  254 45507.2433 75746.3530  66.4%     -   99s
     0     0 75685.8114    0  249 45507.2433 75685.8114  66.3%     -  102s
     0     0 75634.5172    0  260 45507.2433 75634.5172  66.2%     -  104s
     0     0 75599.4442    0  261 45507.2433 75599.4442  66.1%     -  105s
     0     0 75574.9906    0  257 45507.2433 75574.9906  66.1%     -  107s
     0     0 75571.5537    0  256 45507.2433 75571.5537  66.1%     -  108s
     0     0 75563.2400    0  256 45507.2433 75563.2400  66.0%     -  108s
     0     0 75561.4476    0  264 45507.2433 75561.4476  66.0%     -  109s
     0     0 75552.3595    0  262 45507.2433 75552.3595  66.0%     -  109s
     0     0 75545.0011    0  262 45507.2433 75545.0011  66.0%     -  110s
     0     0 75513.9123    0  254 45507.2433 75513.9123  65.9%     -  111s
     0     0 75510.7568    0  258 45507.2433 75510.7568  65.9%     -  111s
     0     0 75510.6887    0  258 45507.2433 75510.6887  65.9%     -  112s
H    0     0                    46110.653315 73672.3909  59.8%     -  129s
H    0     0                    47028.083504 73672.3909  56.7%     -  129s
     0     0 73672.3909    0  295 47028.0835 73672.3909  56.7%     -  129s
H    0     0                    47618.749361 73671.5507  54.7%     -  129s
H    0     0                    47951.617680 73671.5507  53.6%     -  129s
     0     0 73198.3587    0  303 47951.6177 73198.3587  52.7%     -  135s
     0     0 73062.0764    0  320 47951.6177 73062.0764  52.4%     -  137s
     0     0 72971.5807    0  317 47951.6177 72971.5807  52.2%     -  139s
     0     0 72951.7291    0  321 47951.6177 72951.7291  52.1%     -  140s
     0     0 72940.6866    0  320 47951.6177 72940.6866  52.1%     -  141s
     0     0 72928.5724    0  327 47951.6177 72928.5724  52.1%     -  141s
     0     0 72911.6477    0  327 47951.6177 72911.6477  52.1%     -  142s
     0     0 72904.8582    0  323 47951.6177 72904.8582  52.0%     -  142s
     0     0 72904.1719    0  325 47951.6177 72904.1719  52.0%     -  143s
     0     0 72407.9406    0  333 47951.6177 72407.9406  51.0%     -  152s
     0     0 72301.1737    0  327 47951.6177 72301.1737  50.8%     -  155s
     0     0 72226.8475    0  322 47951.6177 72226.8475  50.6%     -  156s
     0     0 72219.6553    0  306 47951.6177 72219.6553  50.6%     -  156s
     0     0 72217.7075    0  309 47951.6177 72217.7075  50.6%     -  157s
     0     0 72217.3696    0  309 47951.6177 72217.3696  50.6%     -  157s
     0     0 72150.0294    0  334 47951.6177 72150.0294  50.5%     -  161s
     0     0 72144.7809    0  348 47951.6177 72144.7809  50.5%     -  161s
     0     0 72129.0344    0  335 47951.6177 72129.0344  50.4%     -  162s
     0     0 72116.7386    0  348 47951.6177 72116.7386  50.4%     -  163s
     0     0 72114.4951    0  350 47951.6177 72114.4951  50.4%     -  163s
     0     0 72113.2043    0  345 47951.6177 72113.2043  50.4%     -  164s
     0     0 72056.6850    0  334 47951.6177 72056.6850  50.3%     -  166s
     0     0 72036.5763    0  327 47951.6177 72036.5763  50.2%     -  167s
     0     0 72028.3304    0  332 47951.6177 72028.3304  50.2%     -  168s
     0     0 72025.5062    0  327 47951.6177 72025.5062  50.2%     -  169s
     0     0 72024.5165    0  323 47951.6177 72024.5165  50.2%     -  169s
     0     0 72020.7918    0  328 47951.6177 72020.7918  50.2%     -  170s
     0     0 72019.8096    0  327 47951.6177 72019.8096  50.2%     -  170s
     0     0 72017.3640    0  327 47951.6177 72017.3640  50.2%     -  171s
     0     0 72016.5272    0  333 47951.6177 72016.5272  50.2%     -  172s
     0     0 72013.5779    0  339 47951.6177 72013.5779  50.2%     -  172s
     0     0 72011.7795    0  340 47951.6177 72011.7795  50.2%     -  173s
     0     0 72010.3553    0  339 47951.6177 72010.3553  50.2%     -  174s
     0     0 72010.1151    0  339 47951.6177 72010.1151  50.2%     -  174s
     0     2 72009.5838    0  339 47951.6177 72009.5838  50.2%     -  206s
     1     4 71974.2787    1  322 47951.6177 72009.0422  50.2%  1406  211s
     3     8 71743.1144    2  313 47951.6177 71974.0459  50.1%  4608  220s
     7    16 71322.9408    3  312 47951.6177 71893.5196  49.9%  6023  226s
    15    32 71275.8895    4  312 47951.6177 71546.2741  49.2%  6078  240s
    31    49 67307.8755    5  265 47951.6177 71459.0182  49.0%  8699  374s
    48    81 70853.5012    6  307 47951.6177 71458.4723  49.0%  9057  399s
    80   230 70516.3148    7  289 47951.6177 71458.4723  49.0%  7063  415s
   229   293 70192.9476   10  292 47951.6177 71458.4723  49.0%  4089  424s
   292   366 69796.6931    8  297 47951.6177 71458.4723  49.0%  4136  432s
   365   451 70172.7217   11  283 47951.6177 71458.4723  49.0%  3890  444s
   450   482 68788.4673   11  262 47951.6177 71458.4723  49.0%  3667  452s
   481   517 69198.5291   10  228 47951.6177 71458.4723  49.0%  3656  460s
   518   547 68387.2650   10  256 47951.6177 71458.4723  49.0%  3598  468s
   550   575 69662.1078   12  229 47951.6177 71458.4723  49.0%  3549  476s
   582   610 69760.6744   12  233 47951.6177 71458.4723  49.0%  3482  483s
   617   640 61920.0471   30  183 47951.6177 71458.4723  49.0%  3452  491s
   647   675 69094.6262   12  299 47951.6177 71458.4723  49.0%  3377  496s
   682   707 69299.3790   13  271 47951.6177 71458.4723  49.0%  3291  500s
   714   747 69029.8576   14  263 47951.6177 71458.4723  49.0%  3233  507s
   760   779 68692.8389   15  272 47951.6177 71458.4723  49.0%  3131  516s
   792   814 68603.3673   15  254 47951.6177 71458.4723  49.0%  3097  520s
   827   859 67381.7040   14  221 47951.6177 71458.4723  49.0%  3080  529s
   883   907 68539.0278   16  242 47951.6177 71458.4723  49.0%  2981  534s
   945   972 67859.2531   16  257 47951.6177 71458.4723  49.0%  2907  541s
  1010  1044 68351.7694   17  255 47951.6177 71458.4723  49.0%  2862  547s
  1096  1121 68055.5346   18  242 47951.6177 71458.4723  49.0%  2773  556s
  1197  1198 62303.5198   18  191 47951.6177 71458.4723  49.0%  2676  564s
  1306  1230 67040.1057   19  240 47951.6177 71458.4723  49.0%  2608  573s
  1414  1268 62389.0920   20  200 47951.6177 71458.4723  49.0%  2574  584s
  1500  1337 66444.7718   20  239 47951.6177 71392.8075  48.9%  2596  594s
  1581  1398 61432.3397   20  195 47951.6177 71392.8075  48.9%  2629  604s
  1670  1458 65682.9041   23  259 47951.6177 71392.8075  48.9%  2654  615s
  1766  1536 60343.1032   23  226 47951.6177 71357.3975  48.8%  2690  626s
  1866  1630 65176.3544   25  237 47951.6177 71357.3975  48.8%  2739  637s
  2003  1689 51277.3969   27  221 47951.6177 71357.3975  48.8%  2708  650s
  2120  1770 58470.0523   25  217 47951.6177 71357.3975  48.8%  2744  662s
  2235  1876 60954.5645   29  248 47951.6177 71357.3975  48.8%  2759  674s
  2386  1992 55287.6371   28  179 47951.6177 71357.3975  48.8%  2747  687s
  2554  2097 54688.2818   30  228 47951.6177 71303.4933  48.7%  2736  700s
  2705  2197 54279.3561   31  267 47951.6177 71303.4933  48.7%  2742  714s
  2868  2309 54944.6147   33  287 47951.6177 71303.4933  48.7%  2744  730s
  3070  2425 53265.0826   35  282 47951.6177 70970.3251  48.0%  2712  745s
  3248  2524 52987.0837   37  235 47951.6177 70970.3251  48.0%  2703  760s
  3402  2668 49709.4562   36  297 47951.6177 70707.3537  47.5%  2732  776s
  3584  2809 51565.9021   38  185 47951.6177 70707.3537  47.5%  2740  792s
  3795  2810 50376.9919   33  339 47951.6177 70707.3537  47.5%  2727  860s
  3797  2811 51822.2437   27  126 47951.6177 70707.3537  47.5%  2726  907s
  3798  2812 49610.9507   62  242 47951.6177 70707.3537  47.5%  2725  927s
  3799  2813 67490.2048   13  289 47951.6177 70707.3537  47.5%  2724  942s
  3800  2813 51273.8362   28  318 47951.6177 70707.3537  47.5%  2724  951s
  3801  2814 59123.0019   27  313 47951.6177 70707.3537  47.5%  2723  957s
  3802  2815 62175.3357   16  329 47951.6177 70707.3537  47.5%  2722  965s
  3804  2816 50144.2728   51  356 47951.6177 70707.3537  47.5%  2721  971s
  3806  2817 56605.7202   27  338 47951.6177 70707.3537  47.5%  2719  975s
  3808  2819 67443.4622   18  332 47951.6177 70707.3537  47.5%  2718  980s
  3811  2821 50654.2419   51  337 47951.6177 70707.3537  47.5%  2716  988s
  3812  2821 49838.9974   39  329 47951.6177 70707.3537  47.5%  2715  991s
  3813  2822 50067.2689   39  346 47951.6177 70707.3537  47.5%  2714  995s
  3816  2824 52007.3553   42  341 47951.6177 70707.3537  47.5%  2712 1002s
  3819  2826 53352.8816   39  349 47951.6177 70707.3537  47.5%  2710 1006s
  3820  2827 50214.9035   46  381 47951.6177 70651.9274  47.3%  2709 1015s
  3823  2829 50659.8000   27  387 47951.6177 70605.0950  47.2%  2707 1021s
  3824  2829 49940.1739   44  373 47951.6177 70511.3047  47.0%  2707 1026s
H 3824  2687                    48004.444304 70511.3047  46.9%  2707 1027s
  3827  2689 50681.0475   45  368 48004.4443 70497.0560  46.9%  2704 1030s
H 3827  2554                    48244.688153 70460.3536  46.0%  2704 1034s
  3829  2556 63802.9551   22  368 48244.6882 70460.3536  46.0%  2703 1035s
H 3830  2427                    48831.058565 70439.8601  44.3%  2702 1040s
  3832  2429 63860.6512   13  372 48831.0586 70428.4492  44.2%  2701 1045s
H 3832  2307                    49071.833144 70417.4698  43.5%  2701 1047s
H 3832  2191                    50150.115096 70417.4698  40.4%  2701 1047s
  3835  2193 55094.1232   50  377 50150.1151 70395.8290  40.4%  2699 1052s
  3837  2194 52742.9202   25  359 50150.1151 70395.8290  40.4%  2697 1057s
  3838  2195 62757.3515   14  359 50150.1151 70385.5771  40.3%  2697 1097s
H 3838  2085                    50294.070031 70385.5771  39.9%  2697 1133s
H 3839  1982                    50430.523127 70385.5771  39.6%  2759 1136s
  3840  1984 70285.0113   10  358 50430.5231 70385.5771  39.6%  2760 1153s
  3842  1987 69902.4863   11  371 50430.5231 70281.5096  39.4%  2761 1172s
  3846  1994 69789.6405   12  346 50430.5231 69901.9255  38.6%  2768 1189s
  3854  2007 69734.2495   13  368 50430.5231 69789.1625  38.4%  2785 1208s
  3870  2018 68884.9942   14  375 50430.5231 69734.0927  38.3%  2815 1235s
  3886  2045 67605.8554   15  354 50430.5231 69734.0927  38.3%  2880 1257s
H 3894  1942                    51103.444642 69734.0927  36.5%  2892 1257s
H 3909  1842                    51186.957081 69734.0927  36.2%  2910 1257s
  3918  1904 65719.5270   16  321 51186.9571 69734.0927  36.2%  2928 1279s
  3984  1946 63982.7178   18  305 51186.9571 69734.0927  36.2%  3096 1299s
  4055  1977 62090.3513   19  304 51186.9571 69734.0927  36.2%  3151 1314s
  4118  2005 62718.4664   19  318 51186.9571 69734.0927  36.2%  3187 1330s
  4195  1991 62180.4284   19  316 51186.9571 69734.0927  36.2%  3212 1344s
  4239  1996 61810.8000   19  248 51186.9571 69734.0927  36.2%  3217 1363s
  4279  2005 61664.8288   19  245 51186.9571 68996.8722  34.8%  3237 1376s
  4322  1998 54534.1812   24  189 51186.9571 68996.8722  34.8%  3255 1389s
  4365  2003 51953.1888   25  182 51186.9571 68996.8722  34.8%  3268 1404s
  4425  2005 61428.9384   20  260 51186.9571 68536.2319  33.9%  3277 1417s
  4481  2005 61193.1246   21  253 51186.9571 68536.2319  33.9%  3296 1430s
  4547  2025 61019.6560   22  259 51186.9571 68536.2319  33.9%  3307 1445s
  4612  2037 59988.9190   24  246 51186.9571 68536.2319  33.9%  3327 1457s
  4680  2035 58789.7087   24  242 51186.9571 68094.3137  33.0%  3346 1469s
  4722  2041 55502.8318   25  256 51186.9571 68094.3137  33.0%  3358 1482s
  4765  2050 55152.1150   25  222 51186.9571 67793.0626  32.4%  3377 1491s
  4803  2048 57391.1767   23  228 51186.9571 67793.0626  32.4%  3392 1504s
  4850  2057 54773.8982   25  204 51186.9571 67793.0626  32.4%  3399 1516s
  4891  2068 56546.6811   24  208 51186.9571 67793.0626  32.4%  3407 1530s
  4952  2078 52605.7617   25  268 51186.9571 67793.0626  32.4%  3427 1546s
  5016  2090 55481.8369   24  190 51186.9571 67793.0626  32.4%  3437 1561s
  5111  2102 52934.3923   26  197 51186.9571 67793.0626  32.4%  3443 1578s
  5211  2100 53781.8359   26  198 51186.9571 67793.0626  32.4%  3449 1595s
  5315  2109 53788.3045   26  237 51186.9571 67793.0626  32.4%  3468 1612s
  5414  2137 52462.6366   27  203 51186.9571 66552.5916  30.0%  3493 1630s
  5525  2144 60134.5425   19  246 51186.9571 66552.5916  30.0%  3514 1653s
  5632  2166 54200.0071   23  199 51186.9571 66552.5916  30.0%  3536 1672s
  5757  2171 52109.9947   26  194 51186.9571 66007.0061  29.0%  3552 1692s
  5903  2176 60129.7557   19  305 51186.9571 65988.3593  28.9%  3561 1716s
  6044  2200 58536.1241   21  274 51186.9571 65988.3593  28.9%  3569 1737s
  6186  2194 56254.8889   24  284 51186.9571 65739.4546  28.4%  3573 1759s
  6349  2205 53248.1502   26  215 51186.9571 65467.0192  27.9%  3573 1785s
  6521  2210 59477.6135   20  230 51186.9571 65467.0192  27.9%  3578 1808s
  6672  2190 54121.4186   25  216 51186.9571 65467.0192  27.9%  3598 1832s
  6772  2200 53439.4497   27  205 51186.9571 65467.0192  27.9%  3601 1855s
  6887  2197 52084.9871   30  217 51186.9571 65279.4206  27.5%  3612 1878s
  6992  2210 51572.5475   34  177 51186.9571 65279.4206  27.5%  3631 1903s
  7107  2225     cutoff   35      51186.9571 64738.6526  26.5%  3654 1929s
  7274  2224 55661.9238   18  256 51186.9571 64738.6526  26.5%  3656 1957s
H 7369  2103                    51199.624907 64457.7042  25.9%  3668 1957s
  7439  2119 55477.4547   19  248 51199.6249 64326.2845  25.6%  3676 1987s
  7644  2122     cutoff   24      51199.6249 64249.7688  25.5%  3688 2020s
  7876  2140 60145.7649   19  302 51199.6249 64035.9075  25.1%  3698 2053s
  8079  2129 58369.1760   22  254 51199.6249 64035.9075  25.1%  3723 2087s
  8307  2113 51582.3856   28  225 51199.6249 64035.9075  25.1%  3746 2121s
  8530  2079 54812.3276   23  265 51199.6249 63438.5372  23.9%  3779 2159s
  8805  2038     cutoff   28      51199.6249 63417.8917  23.9%  3796 2197s
  9087  2030 52787.1761   23  241 51199.6249 62769.0256  22.6%  3812 2229s
H 9100  2030                    51228.437438 62769.0256  22.5%  3809 2229s
H 9106  2025                    51390.456581 62769.0256  22.1%  3812 2229s
  9170  2091 56064.1726   23  270 51390.4566 62769.0256  22.1%  3827 2268s
  9433  2153     cutoff   25      51390.4566 62331.4349  21.3%  3855 2314s
  9754  2186     cutoff   28      51390.4566 62312.6322  21.3%  3868 2352s
  9971  2237 53385.3609   24  224 51390.4566 62294.1564  21.2%  3888 2399s
 10285  2261     cutoff   23      51390.4566 61931.2670  20.5%  3902 2444s
 10718  2311 58464.6313   20  298 51390.4566 61920.3967  20.5%  3895 2490s
 11145  2379     cutoff   27      51390.4566 61771.0237  20.2%  3889 2539s
 11511  2452 54885.3279   23  282 51390.4566 61455.9412  19.6%  3911 2588s
 11934  2525     cutoff   27      51390.4566 61137.8298  19.0%  3919 2644s
 12409  2618 53222.8778   21  231 51390.4566 60799.3369  18.3%  3918 2694s
 12913  2656     cutoff   25      51390.4566 60609.7936  17.9%  3911 2749s
 13426  2723     cutoff   23      51390.4566 60421.4867  17.6%  3912 2809s
 13947  2789     cutoff   20      51390.4566 60134.1686  17.0%  3916 2867s
 14450  2835 53750.6238   20  294 51390.4566 59761.8718  16.3%  3922 2929s
 15025  2883 51706.7291   21  276 51390.4566 59548.0139  15.9%  3924 2994s
 15550  2900     cutoff   23      51390.4566 59276.2711  15.3%  3928 3059s
 16120  2928     cutoff   24      51390.4566 59038.8219  14.9%  3933 3139s
 16768  2926 54131.2160   27  195 51390.4566 58822.0208  14.5%  3936 3213s
 17402  2945 54037.9824   22  252 51390.4566 58580.5667  14.0%  3945 3284s
 18066  2938     cutoff   25      51390.4566 58513.0505  13.9%  3952 3363s
 18868  2929     cutoff   21      51390.4566 58072.6088  13.0%  3941 3467s
 19651  2888     cutoff   27      51390.4566 57783.1568  12.4%  3936 3547s
 20441  2835 52466.3816   22  275 51390.4566 57509.3319  11.9%  3938 3600s

Cutting planes:
  Learned: 1
  Gomory: 2
  MIR: 931
  Mixing: 5
  Flow cover: 2433
  RLT: 15
  Relax-and-lift: 240

Explored 21135 nodes (83072896 simplex iterations) in 3600.02 seconds (10957.14 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 51390.5 51228.4 51199.6 ... 48831.1

Time limit reached
Best objective 5.139045658144e+04, best bound 5.720602950332e+04, gap 11.3164%
  WARNING: Time limit reached. Using best solution found (gap: 11.32%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.03s
  Master Objective (UB) = 51390.46, θ = 225327.85
  Upper Bound (UB) = 51390.46

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 225327.85
  [DEBUG]   ✓ Scenario 0: θ = 225327.85 ≤ Q = 225327.85 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 225327.85 ≤ Q = 225327.85 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 225327.85 ≤ Q = 225327.85 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 225327.85 ≤ Q = 225327.85 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 225327.85 ≤ Q = 225327.85 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 225327.85 ≤ Q = 225327.85 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 225327.85 ≤ Q = 225327.85 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 225327.85 ≤ Q = 225327.85 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x5dd10ec2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x5dd10ec2
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 1e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.396170e+13
Presolve removed 2600 rows and 1891 columns
Presolve time: 0.00s
Presolved: 493 rows, 498 columns, 1396 nonzeros
Found heuristic solution: objective 6630850.6401
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.812635e+05, 244 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -181263.53    0  125 6630850.64 -181263.53   103%     -    0s
H    0     0                    -144233.1740 -181263.53  25.7%     -    0s
H    0     0                    -148521.6001 -161952.98  9.04%     -    0s
H    0     0                    -154318.2056 -161952.98  4.95%     -    0s
     0     0 -161427.80    0   65 -154318.21 -161427.80  4.61%     -    0s
H    0     0                    -156658.5025 -159939.63  2.09%     -    0s
     0     0 -159939.63    0   68 -156658.50 -159939.63  2.09%     -    0s
     0     0 -159925.71    0   69 -156658.50 -159925.71  2.09%     -    0s
     0     0 -159924.38    0   69 -156658.50 -159924.38  2.08%     -    0s
     0     0 -159484.69    0   64 -156658.50 -159484.69  1.80%     -    0s
H    0     0                    -157848.8943 -159479.54  1.03%     -    0s
H    0     0                    -157952.7425 -159479.54  0.97%     -    0s
H    0     0                    -157960.4256 -159479.54  0.96%     -    0s
     0     0 -159317.76    0   63 -157960.43 -159317.76  0.86%     -    0s
     0     0 -159301.49    0   63 -157960.43 -159301.49  0.85%     -    0s
     0     2 -159301.49    0   63 -157960.43 -159301.49  0.85%     -    0s
H   30    30                    -157978.1056 -159064.70  0.69%  15.0    0s
H   36    30                    -158276.9153 -159060.77  0.50%  14.2    0s
H  272   119                    -158377.0623 -158869.94  0.31%   8.4    0s
H  359   108                    -158498.9226 -158869.94  0.23%   7.7    0s
*  641     7              26    -158522.8731 -158687.93  0.10%   6.0    0s
*  674     0              26    -158523.0004 -158539.88  0.01%   5.8    0s
*  683     0              27    -158525.7588 -158525.76  0.00%   5.8    0s

Cutting planes:
  Gomory: 44
  MIR: 142
  RLT: 32

Explored 685 nodes (4465 simplex iterations) in 0.18 seconds (0.08 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -158526 -158523 -158523 ... -157849
No other solutions better than -158526

Optimal solution found (tolerance 1.00e-04)
Best objective -1.585257588112e+05, best bound -1.585257588112e+05, gap 0.0000%
  Subproblem solved in 0.20s
  Worst-case operational profit (Z_SP) = 214943.26
  Scenario: 20 demand increases, 40 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -158525.76
  [DEBUG]   S×d_nominal = 373469.02
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 373469.02 + -158525.76 = 214943.26
  [DEBUG]   Current θ from Master = 225327.85
  [DEBUG]   ⚠️  Z_SP ≤ θ by 10384.60 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 41005.86
  Lower Bound (LB) = 45250.14
  Gap (UB-LB) = 6140.3139, Absolute Gap = 6140.3139, Relative Gap = 0.119484
  Not converged yet (gap = 6140.31 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 20 increases, 40 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394598 nonzeros
Model fingerprint: 0xdbefdde7
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 63750 rows and 25890 columns
Presolve time: 1.25s
Presolved: 75243 rows, 32530 columns, 468749 nonzeros
Variable types: 30271 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -275122.5137
Found heuristic solution: objective -155958.4539

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 75243 rows, 32530 columns, 468749 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   32994   -7.6750810e+04   0.000000e+00   1.412641e+08      5s
   46593    2.0114950e+02   0.000000e+00   1.050160e+08     10s
   56956    1.5338282e+04   0.000000e+00   8.929053e+07     15s
   65724    4.3603571e+04   0.000000e+00   5.099586e+08     20s
   75287    4.9919114e+04   0.000000e+00   3.858325e+06     25s
   82687    5.2113085e+04   0.000000e+00   6.434396e+06     30s
   90421    5.9256596e+04   0.000000e+00   8.338549e+07     35s
Concurrent spin time: 0.02s

Solved with dual simplex

Root relaxation: objective 8.623093e+04, 71848 iterations, 35.63 seconds (78.53 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 86230.9316    0  126 -155958.45 86230.9316   155%     -   37s
H    0     0                    -152023.2305 86230.9316   157%     -   37s
H    0     0                    -26830.46882 86230.9316   421%     -   38s
H    0     0                    -13105.93269 86230.9316   758%     -   38s
H    0     0                    -12291.52318 86230.9316   802%     -   38s
H    0     0                     861.8755480 86230.9316  9905%     -   38s
H    0     0                    2437.7079737 86230.9316  3437%     -   38s
H    0     0                    8886.9286281 86230.9316   870%     -   38s
H    0     0                    26411.208527 86230.9316   226%     -   38s
H    0     0                    33059.331256 86230.9316   161%     -   38s
H    0     0                    36745.852068 86230.9316   135%     -   38s
H    0     0                    36806.724398 86230.9316   134%     -   38s
H    0     0                    36863.287681 86230.9316   134%     -   38s
H    0     0                    38188.304156 86230.9316   126%     -   39s
     0     0 80101.1482    0  169 38188.3042 80101.1482   110%     -   49s
H    0     0                    38297.221415 80101.1482   109%     -   50s
H    0     0                    38453.127519 80101.1482   108%     -   50s
H    0     0                    38690.183050 80101.1482   107%     -   50s
H    0     0                    39036.800878 80101.1482   105%     -   50s
H    0     0                    39139.067592 80101.1482   105%     -   50s
H    0     0                    39510.487518 80101.1482   103%     -   50s
     0     0 79664.5938    0  178 39510.4875 79664.5938   102%     -   54s
     0     0 79496.6774    0  174 39510.4875 79496.6774   101%     -   57s
     0     0 79496.6774    0  175 39510.4875 79496.6774   101%     -   59s
     0     0 79496.6774    0  181 39510.4875 79496.6774   101%     -   59s
     0     0 79496.6774    0  181 39510.4875 79496.6774   101%     -   60s
     0     0 79496.6774    0  183 39510.4875 79496.6774   101%     -   60s
     0     0 79496.6722    0  183 39510.4875 79496.6722   101%     -   60s
     0     0 76588.2504    0  246 39510.4875 76588.2504  93.8%     -   74s
H    0     0                    42313.326526 76587.7349  81.0%     -   74s
H    0     0                    42415.885715 76587.7349  80.6%     -   74s
     0     0 75932.3694    0  249 42415.8857 75932.3694  79.0%     -   81s
     0     0 75809.9894    0  246 42415.8857 75809.9894  78.7%     -   83s
     0     0 75733.8054    0  253 42415.8857 75733.8054  78.6%     -   85s
     0     0 75665.7288    0  254 42415.8857 75665.7288  78.4%     -   87s
     0     0 75543.9429    0  254 42415.8857 75543.9429  78.1%     -   89s
     0     0 75436.5933    0  251 42415.8857 75436.5933  77.8%     -   92s
     0     0 75420.4260    0  254 42415.8857 75420.4260  77.8%     -   93s
     0     0 75409.1490    0  248 42415.8857 75409.1490  77.8%     -   94s
     0     0 75407.3212    0  256 42415.8857 75407.3212  77.8%     -   94s
     0     0 75404.9088    0  255 42415.8857 75404.9088  77.8%     -   95s
     0     0 75403.3940    0  252 42415.8857 75403.3940  77.8%     -   95s
     0     0 75403.2027    0  252 42415.8857 75403.2027  77.8%     -   95s
     0     0 73974.2906    0  294 42415.8857 73974.2906  74.4%     -  115s
     0     0 73687.7294    0  297 42415.8857 73687.7294  73.7%     -  122s
     0     0 73515.7934    0  294 42415.8857 73515.7934  73.3%     -  130s
     0     0 73449.5661    0  309 42415.8857 73449.5661  73.2%     -  136s
     0     0 73330.9164    0  283 42415.8857 73330.9164  72.9%     -  142s
     0     0 73277.9663    0  289 42415.8857 73277.9663  72.8%     -  147s
     0     0 73240.5828    0  309 42415.8857 73240.5828  72.7%     -  149s
     0     0 73229.5109    0  296 42415.8857 73229.5109  72.6%     -  151s
     0     0 73203.6369    0  300 42415.8857 73203.6369  72.6%     -  154s
     0     0 73197.9276    0  300 42415.8857 73197.9276  72.6%     -  155s
     0     0 73194.9663    0  302 42415.8857 73194.9663  72.6%     -  157s
     0     0 73187.9859    0  304 42415.8857 73187.9859  72.5%     -  157s
     0     0 73179.4234    0  301 42415.8857 73179.4234  72.5%     -  159s
     0     0 73168.3801    0  305 42415.8857 73168.3801  72.5%     -  160s
     0     0 73165.2616    0  301 42415.8857 73165.2616  72.5%     -  160s
     0     0 73154.3083    0  296 42415.8857 73154.3083  72.5%     -  161s
     0     0 73149.5923    0  305 42415.8857 73149.5923  72.5%     -  162s
     0     0 73149.3547    0  302 42415.8857 73149.3547  72.5%     -  162s
H    0     0                    43164.993691 72680.9682  68.4%     -  172s
     0     0 72680.9682    0  317 43164.9937 72680.9682  68.4%     -  172s
     0     0 72517.3117    0  328 43164.9937 72517.3117  68.0%     -  176s
     0     0 72457.9410    0  337 43164.9937 72457.9410  67.9%     -  179s
     0     0 72444.2306    0  328 43164.9937 72444.2306  67.8%     -  180s
     0     0 72425.8004    0  326 43164.9937 72425.8004  67.8%     -  181s
     0     0 72415.6890    0  327 43164.9937 72415.6890  67.8%     -  182s
     0     0 72413.8013    0  328 43164.9937 72413.8013  67.8%     -  182s
     0     0 72411.3184    0  320 43164.9937 72411.3184  67.8%     -  183s
     0     0 72403.4640    0  320 43164.9937 72403.4640  67.7%     -  183s
     0     0 72401.4291    0  327 43164.9937 72401.4291  67.7%     -  184s
     0     0 72401.4162    0  327 43164.9937 72401.4162  67.7%     -  184s
     0     0 72335.7583    0  339 43164.9937 72335.7583  67.6%     -  187s
H    0     0                    43253.519361 72335.1972  67.2%     -  187s
     0     0 72311.5580    0  332 43253.5194 72311.5580  67.2%     -  188s
     0     0 72278.3770    0  328 43253.5194 72278.3770  67.1%     -  189s
     0     0 72271.1438    0  325 43253.5194 72271.1438  67.1%     -  190s
     0     0 72270.1584    0  328 43253.5194 72270.1584  67.1%     -  190s
     0     0 72219.0046    0  331 43253.5194 72219.0046  67.0%     -  193s
H    0     0                    43293.973756 72218.9965  66.8%     -  193s
     0     0 72199.7390    0  338 43293.9738 72199.7390  66.8%     -  194s
     0     0 72191.9825    0  346 43293.9738 72191.9825  66.7%     -  195s
     0     0 72191.3194    0  345 43293.9738 72191.3194  66.7%     -  196s
     0     0 72178.3606    0  329 43293.9738 72178.3606  66.7%     -  198s
H    0     0                    43756.307525 72178.2044  65.0%     -  199s
     0     0 72172.1545    0  346 43756.3075 72172.1545  64.9%     -  199s
     0     0 72169.6776    0  345 43756.3075 72169.6776  64.9%     -  200s
     0     0 72169.4019    0  336 43756.3075 72169.4019  64.9%     -  200s
     0     0 72156.8166    0  335 43756.3075 72156.8166  64.9%     -  202s
     0     0 72151.3766    0  350 43756.3075 72151.3766  64.9%     -  203s
     0     0 72147.5569    0  346 43756.3075 72147.5569  64.9%     -  203s
     0     0 72145.9095    0  342 43756.3075 72145.9095  64.9%     -  204s
     0     0 72145.7905    0  344 43756.3075 72145.7905  64.9%     -  204s
     0     0 72126.0217    0  346 43756.3075 72126.0217  64.8%     -  207s
     0     0 72121.4229    0  356 43756.3075 72121.4229  64.8%     -  208s
     0     0 72120.0229    0  357 43756.3075 72120.0229  64.8%     -  209s
     0     0 72114.1541    0  348 43756.3075 72114.1541  64.8%     -  210s
H    0     0                    43855.523206 72110.4679  64.4%     -  211s
H    0     0                    45229.899427 72110.4679  59.4%     -  211s
     0     0 72110.4679    0  354 45229.8994 72110.4679  59.4%     -  212s
     0     0 72110.4679    0  359 45229.8994 72110.4679  59.4%     -  213s
     0     0 72109.8657    0  357 45229.8994 72109.8657  59.4%     -  213s
     0     0 72104.5189    0  358 45229.8994 72104.5189  59.4%     -  214s
     0     0 72103.5704    0  358 45229.8994 72103.5704  59.4%     -  215s
H    0     0                    46530.984690 72103.1199  55.0%     -  235s
     0     2 72103.1199    0  358 46530.9847 72103.1199  55.0%     -  261s
     1     4 72073.8631    1  343 46530.9847 72103.1199  55.0%  1810  268s
     3     8 72018.3731    2  333 46530.9847 72073.6070  54.9%  3811  276s
     7    16 71994.6848    3  333 46530.9847 72018.3156  54.8%  5531  287s
    15    31 69572.0141    4  285 46530.9847 71994.6821  54.7%  6655  299s
    30    46 69962.0378    5  319 46530.9847 71994.3536  54.7% 11999  322s
    45    78 69753.4137    5  322 46530.9847 71146.8845  52.9% 11438  341s
    77   210 69338.2691    6  318 46530.9847 70962.5695  52.5%  8984  358s
   209   271 67783.1773   11  304 46530.9847 70962.2845  52.5%  5001  367s
H  214   271                    47141.660529 70962.2845  50.5%  4986  367s
   270   355 67260.5170   13  232 47141.6605 70962.2845  50.5%  4802  378s
   354   411 65884.7983   15  219 47141.6605 70962.2845  50.5%  4449  387s
   410   487 58142.6624   17  218 47141.6605 70962.2845  50.5%  4450  396s
   488   516 57173.2099   18  206 47141.6605 70962.2845  50.5%  4388  403s
   517   551 56515.1231   19  200 47141.6605 70962.2845  50.5%  4431  411s
   552   579 51843.5261   20  167 47141.6605 70962.2845  50.5%  4494  419s
H  556   579                    47160.101738 70962.2845  50.5%  4501  419s
   582   655 51624.2933   21  179 47160.1017 70962.2845  50.5%  4560  427s
   676   680 51576.0229   23  156 47160.1017 70962.2845  50.5%  4365  436s
   713   711 51215.8664   24  132 47160.1017 70962.2845  50.5%  4371  445s
   744   740 51130.3820   25  130 47160.1017 70962.2845  50.5%  4348  453s
   781   770 50907.6745   26  125 47160.1017 70962.2845  50.5%  4284  461s
   819   806 50722.7819   27  129 47160.1017 70962.2845  50.5%  4265  468s
   860   839 50462.7379   28  136 47160.1017 70962.2845  50.5%  4248  477s
   901   874 48136.3665   29  122 47160.1017 70962.2845  50.5%  4240  485s
   939   904     cutoff   30      47160.1017 70962.2845  50.5%  4223  495s
   987   942 64239.5154   15  312 47160.1017 70962.2845  50.5%  4200  505s
  1055   967 55225.9204   18  154 47160.1017 70962.2845  50.5%  4136  515s
  1114   999 54713.6505   19  148 47160.1017 70962.2845  50.5%  4124  525s
  1172  1021 50357.6613   20  119 47160.1017 70904.7802  50.3%  4170  535s
  1234  1066 53984.3827   20  174 47160.1017 70904.7802  50.3%  4260  547s
  1289  1121 54005.6872   19  171 47160.1017 70904.7802  50.3%  4379  557s
  1353  1150 48885.2100   21  123 47160.1017 70904.7802  50.3%  4438  568s
  1434  1208 51937.6538   21  176 47160.1017 70904.7802  50.3%  4444  580s
  1515  1284 51224.6586   22  206 47160.1017 70904.7802  50.3%  4485  592s
  1608  1360 51771.5704   22  178 47160.1017 70904.7802  50.3%  4484  603s
  1713  1436 51395.7482   25  219 47160.1017 70904.7802  50.3%  4483  616s
  1831  1530 50798.4836   30  153 47160.1017 70904.7802  50.3%  4464  628s
  1986  1587 50550.3451   35  152 47160.1017 70422.9869  49.3%  4377  642s
  2139  1686 49982.3772   40  148 47160.1017 70408.5143  49.3%  4296  656s
  2300  1744     cutoff   44      47160.1017 70408.5143  49.3%  4251  672s
  2427  1823 48378.5784   54  130 47160.1017 70408.5143  49.3%  4263  687s
  2532  1886 48330.9195   61  108 47160.1017 70408.5143  49.3%  4355  703s
  2627  1943     cutoff   68      47160.1017 70179.3904  48.8%  4440  719s
  2726  2006 63358.4702    8  286 47160.1017 70179.3904  48.8%  4550  734s
  2829  2083 61254.8665   10  293 47160.1017 70179.3904  48.8%  4665  751s
  2950  2152 60551.6407   12  266 47160.1017 70162.1548  48.8%  4762  767s
  3078  2247 58397.1291   15  279 47160.1017 70162.1548  48.8%  4867  783s
  3216  2350 57794.4771   17  242 47160.1017 69561.7275  47.5%  4930  801s
H 3242  2349                    47231.889726 69561.7275  47.3%  4955  801s
  3373  2443 55157.4680   24  207 47231.8897 69561.7275  47.3%  4972  820s
  3550  2516 48729.6325   28  148 47231.8897 69561.7275  47.3%  4998  839s
  3720  2590     cutoff   37      47231.8897 69377.5304  46.9%  5029  860s
  3846  2708 67494.9239    6  234 47231.8897 69377.5304  46.9%  5148  879s
H 4024  2708                    47238.147808 69267.2884  46.6%  5199  882s
H 4024  2708                    47269.294228 69267.2884  46.5%  5199  888s
H 4024  2671                    47716.122058 69267.2884  45.2%  5199  890s
H 4024  2633                    48074.781177 69267.2884  44.1%  5199  891s
H 4024  2547                    48367.946293 69267.2884  43.2%  5199  892s
H 4024  2479                    48645.870359 69267.2884  42.4%  5199  895s
  4025  2470 51783.5060   40  358 48645.8704 69267.2884  42.4%  5198  934s
  4027  2471 50693.0703   19  126 48645.8704 69267.2884  42.4%  5195  988s
H 4027  2347                    48735.668498 69267.2884  42.1%  5195 1021s
H 4028  2230                    48915.119366 69267.2884  41.6%  5194 1038s
H 4028  2119                    48948.467971 69267.2884  41.5%  5194 1038s
H 4028  2013                    48965.261292 69267.2884  41.5%  5194 1038s
H 4028  1912                    48967.965394 69267.2884  41.5%  5194 1038s
H 4028  1816                    49064.366947 69267.2884  41.2%  5194 1038s
  4030  1817 49064.3669   42  341 49064.3669 69267.2884  41.2%  5191 1051s
  4031  1818 54180.2178   19  335 49064.3669 69267.2884  41.2%  5190 1061s
  4032  1819 66320.6661    9  326 49064.3669 69267.2884  41.2%  5188 1070s
  4034  1820 49863.7491   22  344 49064.3669 69267.2884  41.2%  5186 1079s
H 4034  1729                    49236.372169 69267.2884  40.7%  5186 1083s
  4036  1730 56181.3378   17  367 49236.3722 69267.2884  40.7%  5183 1085s
H 4037  1644                    49243.195075 69267.2884  40.7%  5182 1096s
  4040  1646 52151.6735   32  356 49243.1951 69267.2884  40.7%  5178 1101s
  4043  1648 57994.2339   15  360 49243.1951 69267.2884  40.7%  5174 1106s
  4044  1649 54336.7963   17  361 49243.1951 69267.2884  40.7%  5173 1110s
H 4046  1568                    49253.727894 69267.2884  40.6%  5171 1117s
  4049  1570 49836.6408   29  348 49253.7279 69267.2884  40.6%  5167 1122s
  4051  1571 57666.3378   15  366 49253.7279 69267.2884  40.6%  5164 1128s
  4053  1573 51635.9042   26  360 49253.7279 69267.2884  40.6%  5162 1133s
  4055  1574 53230.5248   16  364 49253.7279 69267.2884  40.6%  5159 1138s
  4056  1575 60596.7716   18  363 49253.7279 69267.2884  40.6%  5158 1140s
  4058  1576 54373.3678   28  364 49253.7279 69267.2884  40.6%  5155 1145s
  4060  1577 61543.1765   16  358 49253.7279 69267.2884  40.6%  5153 1193s
  4061  1578 62246.6294   20  358 49253.7279 69267.2884  40.6%  5151 1226s
H 4061  1500                    49262.194225 69267.2884  40.6%  5214 1228s
  4062  1501 69267.2884   11  317 49262.1942 69267.2884  40.6%  5215 1248s
  4063  1503 69267.2884   12  293 49262.1942 69267.2884  40.6%  5216 1267s
  4066  1508 69267.2884   13  277 49262.1942 69267.2884  40.6%  5215 1287s
  4072  1518 68192.2603   14  303 49262.1942 69267.2884  40.6%  5222 1310s
  4084  1526 68811.6341   14  344 49262.1942 69267.2884  40.6%  5259 1344s
H 4096  1479                    49359.554010 69267.2884  40.3%  5273 1374s
H 4097  1407                    49530.449798 69267.2884  39.8%  5275 1374s
H 4102  1337                    49556.063065 69267.2884  39.8%  5281 1374s
H 4107  1271                    49561.736035 69267.2884  39.8%  5284 1374s
H 4112  1207                    49601.814089 69267.2884  39.6%  5285 1374s
  4128  1282 67509.0991   16  346 49601.8141 69267.2884  39.6%  5325 1398s
H 4208  1253                    49728.155165 69267.2884  39.3%  5412 1416s
H 4212  1196                    49753.944503 69267.2884  39.2%  5416 1416s
H 4220  1141                    49770.278406 69267.2884  39.2%  5418 1416s
H 4222  1090                    49947.225506 69267.2884  38.7%  5418 1416s
H 4262  1029                    49961.227381 69267.2884  38.6%  5428 1416s
  4264  1075 67259.6931   17  356 49961.2274 69267.2884  38.6%  5431 1435s
  4323  1082 62748.6241   20  281 49961.2274 69267.2884  38.6%  5452 1452s
H 4336  1032                    49990.065892 69267.2884  38.6%  5458 1452s
H 4346   986                    50050.241773 69267.2884  38.4%  5463 1452s
  4365  1023 54669.3755   21  260 50050.2418 68778.8792  37.4%  5472 1473s
  4430  1030 62070.3793   21  314 50050.2418 68778.8792  37.4%  5485 1492s
H 4431   989                    50124.294086 68778.8792  37.2%  5484 1492s
H 4432   949                    50169.211792 68778.8792  37.1%  5484 1492s
H 4439   910                    50171.405820 68778.8792  37.1%  5484 1492s
H 4450   871                    50192.787143 68515.9923  36.5%  5480 1492s
  4481   892 53136.5558   23  278 50192.7871 68515.9923  36.5%  5487 1510s
  4562   889 52270.5149   22  234 50192.7871 68423.4848  36.3%  5469 1525s
  4594   902 51648.1160   23  217 50192.7871 68423.4848  36.3%  5480 1544s
  4647   912     cutoff   24      50192.7871 68423.4848  36.3%  5468 1560s
H 4653   877                    50225.211195 68423.4848  36.2%  5466 1560s
  4681   916 51545.4125   26  280 50225.2112 68423.4848  36.2%  5477 1579s
  4745   918     cutoff   29      50225.2112 68423.4848  36.2%  5471 1594s
  4783   932 62026.4784   18  283 50225.2112 68423.4848  36.2%  5472 1609s
H 4786   900                    50332.382199 68423.4848  35.9%  5472 1609s
  4826   928 61439.8352   18  232 50332.3822 68251.3860  35.6%  5461 1623s
  4887   952 61379.4907   19  241 50332.3822 68251.3860  35.6%  5455 1639s
  4964   953 58627.6875   23  248 50332.3822 68251.3860  35.6%  5437 1653s
H 4965   923                    50349.459702 68251.3860  35.6%  5436 1653s
H 4977   890                    50379.523092 67838.7129  34.7%  5433 1653s
  5005   918 54459.5260   24  213 50379.5231 67838.7129  34.7%  5437 1672s
  5088   916 52537.7280   26  223 50379.5231 67838.7129  34.7%  5413 1685s
  5132   932 52529.0459   27  221 50379.5231 67838.7129  34.7%  5400 1702s
  5195   945 51937.6627   28  205 50379.5231 67838.7129  34.7%  5386 1726s
H 5200   916                    50386.573314 67838.7129  34.6%  5385 1726s
  5279   915 50845.6249   30  193 50386.5733 67838.7129  34.6%  5363 1751s
  5394   916 63720.3764   17  321 50386.5733 67803.9318  34.6%  5332 1772s
  5485   934 62482.9287   19  271 50386.5733 67803.9318  34.6%  5323 1794s
  5572   957 60433.5033   18  309 50386.5733 67752.3665  34.5%  5322 1815s
  5668  1024 59805.6991   19  307 50386.5733 67296.2462  33.6%  5321 1835s
  5776  1057 57634.5507   20  378 50386.5733 67296.2462  33.6%  5304 1861s
H 5837  1057                    50395.742696 67296.2462  33.5%  5301 1861s
  5846  1108 58094.0895   20  224 50395.7427 67296.2462  33.5%  5301 1884s
  5929  1156 55948.4965   21  226 50395.7427 67296.2462  33.5%  5316 1906s
  6049  1236 56248.8189   19  249 50395.7427 67125.0043  33.2%  5301 1931s
  6179  1267 55907.5085   22  294 50395.7427 67125.0043  33.2%  5285 1952s
  6247  1315 54601.5797   20  309 50395.7427 67125.0043  33.2%  5273 1975s
  6353  1367 56918.5027   21  315 50395.7427 67125.0043  33.2%  5265 2000s
  6496  1429 56401.6678   24  299 50395.7427 67125.0043  33.2%  5245 2026s
  6644  1501 53980.7768   22  332 50395.7427 67125.0043  33.2%  5232 2054s
  6817  1543 53688.2547   25  296 50395.7427 67125.0043  33.2%  5204 2080s
H 6826  1543                    50397.172636 67125.0043  33.2%  5202 2080s
H 6837  1543                    50404.020123 67125.0043  33.2%  5195 2080s
H 6849  1543                    50407.877834 67125.0043  33.2%  5197 2080s
  6887  1607 51307.1090   29  245 50407.8778 67125.0043  33.2%  5193 2109s
  7020  1659     cutoff   27      50407.8778 66602.4244  32.1%  5186 2140s
  7178  1744     cutoff   26      50407.8778 66156.0313  31.2%  5159 2170s
  7361  1844 59669.9165   21  285 50407.8778 66125.5235  31.2%  5139 2206s
  7576  1891 57394.3351   23  272 50407.8778 66125.5235  31.2%  5108 2236s
  7694  2000 57471.9788   22  237 50407.8778 66125.5235  31.2%  5101 2269s
  7882  2078 52944.3851   23  227 50407.8778 65968.6508  30.9%  5092 2308s
  8120  2177 51611.5833   26  211 50407.8778 65901.2253  30.7%  5065 2346s
  8338  2301 53768.2290   21  177 50407.8778 65242.8615  29.4%  5055 2382s
  8623  2442     cutoff   22      50407.8778 65157.5775  29.3%  5011 2426s
  8980  2590 57749.3945   20  247 50407.8778 64924.2661  28.8%  4937 2467s
  9230  2676 53636.0961   24  204 50407.8778 64924.2661  28.8%  4930 2506s
H 9273  2674                    50442.388133 64924.2661  28.7%  4923 2506s
  9385  2763 59722.8113   23  264 50442.3881 64924.2661  28.7%  4932 2551s
  9715  2849 52217.7313   27  246 50442.3881 64924.2661  28.7%  4899 2598s
  9973  2996 60239.9706   21  252 50442.3881 64373.7149  27.6%  4908 2644s
 10319  3118 56807.4137   24  302 50442.3881 64287.4776  27.4%  4863 2693s
 10618  3194 53976.5518   28  308 50442.3881 63811.7386  26.5%  4862 2757s
H10949  3224                    50457.584179 63811.7386  26.5%  4855 2812s
H10963  3222                    50503.156981 63811.7386  26.4%  4856 2812s
H11081  3222                    50524.888931 63811.7386  26.3%  4840 2812s
H11122  3222                    50529.008021 63811.7386  26.3%  4838 2812s
 11167  3307 50807.3998   27  266 50529.0080 63638.2901  25.9%  4836 2870s
 11557  3399 50724.3030   22  226 50529.0080 63448.7351  25.6%  4815 2929s
 11921  3469 58406.6276   19  249 50529.0080 62787.0081  24.3%  4817 2986s
 12320  3584 infeasible   23      50529.0080 62724.6577  24.1%  4810 3046s
 12807  3738     cutoff   28      50529.0080 62236.5393  23.2%  4779 3109s
 13293  3886 56657.1005   22  234 50529.0080 61952.9647  22.6%  4753 3191s
 13779  3979 57764.1887   23  258 50529.0080 61717.8822  22.1%  4738 3257s
 14279  4082 52969.8031   28  232 50529.0080 61439.8011  21.6%  4730 3331s
 14777  4183     cutoff   25      50529.0080 61323.4790  21.4%  4723 3420s
 15165  4286 57568.8849   22  287 50529.0080 61082.8455  20.9%  4724 3499s
H15551  4266                    50633.094007 61021.7647  20.5%  4736 3499s
 15620  4345 52402.6243   26  206 50633.0940 61021.7647  20.5%  4737 3587s
 16200  4347 56538.7951   22  271 50633.0940 61021.7647  20.5%  4727 3600s

Cutting planes:
  Gomory: 2
  MIR: 1146
  Mixing: 2
  Flow cover: 2933
  RLT: 19
  Relax-and-lift: 252

Explored 16282 nodes (77155821 simplex iterations) in 3600.05 seconds (10688.76 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 50633.1 50529 50503.2 ... 50386.6

Time limit reached
Best objective 5.063309400652e+04, best bound 6.102176466723e+04, gap 20.5176%
  WARNING: Time limit reached. Using best solution found (gap: 20.52%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.05s
  Master Objective (UB) = 50633.09, θ = 195797.73
  Upper Bound (UB) = 50633.09

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 195797.73
  [DEBUG]   ✓ Scenario 0: θ = 195797.73 ≤ Q = 195797.73 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 195797.73 ≤ Q = 195797.73 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 195797.73 ≤ Q = 195797.73 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 195797.73 ≤ Q = 195797.73 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 195797.73 ≤ Q = 195797.73 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 195797.73 ≤ Q = 195797.73 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 195797.73 ≤ Q = 195797.73 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 195797.73 ≤ Q = 195797.73 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 195797.73 ≤ Q = 195797.73 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x3659167c
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x3659167c
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 1e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.399718e+13
Presolve removed 2612 rows and 1902 columns
Presolve time: 0.00s
Presolved: 481 rows, 487 columns, 1361 nonzeros
Found heuristic solution: objective 6787262.3356
Variable types: 329 continuous, 158 integer (158 binary)
Found heuristic solution: objective 6786338.3100

Root relaxation: objective -1.640818e+05, 236 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -164081.84    0  125 6786338.31 -164081.84   102%     -    0s
H    0     0                    -129179.1944 -164081.84  27.0%     -    0s
H    0     0                    -129615.4846 -164081.84  26.6%     -    0s
H    0     0                    -136847.8602 -145951.79  6.65%     -    0s
H    0     0                    -140210.1431 -145951.79  4.10%     -    0s
     0     0 -145951.79    0   85 -140210.14 -145951.79  4.10%     -    0s
H    0     0                    -142122.6635 -145910.18  2.66%     -    0s
     0     0 -145752.63    0   71 -142122.66 -145752.63  2.55%     -    0s
     0     0 -145752.63    0   69 -142122.66 -145752.63  2.55%     -    0s
     0     0 -145268.27    0   68 -142122.66 -145268.27  2.21%     -    0s
H    0     0                    -142327.3716 -145260.81  2.06%     -    0s
H    0     0                    -142659.2799 -145260.81  1.82%     -    0s
H    0     0                    -142903.1105 -145258.98  1.65%     -    0s
     0     0 -145258.98    0   61 -142903.11 -145258.98  1.65%     -    0s
H    0     0                    -143606.7475 -145258.98  1.15%     -    0s
H    0     0                    -143714.0373 -145258.98  1.08%     -    0s
H    0     0                    -143721.2372 -145258.98  1.07%     -    0s
     0     0 -145166.49    0   60 -143721.24 -145166.49  1.01%     -    0s
     0     0 -145165.65    0   59 -143721.24 -145165.65  1.01%     -    0s
     0     0 -145118.75    0   52 -143721.24 -145118.75  0.97%     -    0s
     0     0 -145116.74    0   52 -143721.24 -145116.74  0.97%     -    0s
     0     0 -145077.13    0   48 -143721.24 -145077.13  0.94%     -    0s
     0     0 -145040.23    0   48 -143721.24 -145040.23  0.92%     -    0s
     0     2 -145040.23    0   48 -143721.24 -145040.23  0.92%     -    0s
H   48    33                    -144594.3678 -144851.78  0.18%  19.8    0s
H  176     6                    -144607.9251 -144672.51  0.04%  11.8    0s

Cutting planes:
  Gomory: 33
  Implied bound: 1
  MIR: 154
  Flow cover: 5
  RLT: 37

Explored 244 nodes (2979 simplex iterations) in 0.11 seconds (0.08 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -144608 -144594 -143721 ... -129615
No other solutions better than -144608

Optimal solution found (tolerance 1.00e-04)
Best objective -1.446079251025e+05, best bound -1.446079251025e+05, gap 0.0000%
  Subproblem solved in 0.13s
  Worst-case operational profit (Z_SP) = 179740.16
  Scenario: 22 demand increases, 38 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -144607.93
  [DEBUG]   S×d_nominal = 324348.09
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 324348.09 + -144607.93 = 179740.16
  [DEBUG]   Current θ from Master = 195797.73
  [DEBUG]   ⚠️  Z_SP ≤ θ by 16057.57 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 34575.52
  Lower Bound (LB) = 45250.14
  Gap (UB-LB) = 5382.9513, Absolute Gap = 5382.9513, Relative Gap = 0.106313
  Not converged yet (gap = 5382.95 > ε = 200)

  [DEBUG] Adding NEW scenario 9 to Master Problem...
  [DEBUG] New scenario pattern: 22 increases, 38 decreases
    [DEBUG] Scenario 9 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 9 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 9]
    [DEBUG]   - Total constraints in model: 154283
    [DEBUG]   - Total variables in model: 64660
  [DEBUG] Total scenarios in Master: 10
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 10
================================================================================
[Iteration 10] Solving Master Problem...
  Current scenarios in Master: 10
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 154283 rows, 64660 columns and 437829 nonzeros
Model fingerprint: 0xa83e5a0d
Variable types: 62401 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 70860 rows and 28780 columns
Presolve time: 1.24s
Presolved: 83423 rows, 35880 columns, 511819 nonzeros
Variable types: 33621 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -278341.1211
Found heuristic solution: objective -155958.4539

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.16s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.599e+06
 Factor NZ  : 7.694e+06 (roughly 100 MB of memory)
 Factor Ops : 1.322e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.62080004e+07  1.57434030e+08  1.29e+05 2.60e+01  7.76e+04     2s
   1  -1.22092768e+07  1.46942636e+08  9.08e+04 8.06e+01  5.43e+04     2s
   2  -4.25290536e+06  1.08775274e+08  3.18e+04 1.33e+00  2.04e+04     2s
   3  -1.43720444e+06  9.09536480e+07  7.96e+03 1.04e+00  5.41e+03     2s
   4  -4.76998702e+05  6.32870527e+07  9.08e+02 3.50e-01  9.33e+02     2s
   5  -3.59380006e+05  2.96016089e+07  3.45e+02 1.24e-01  3.65e+02     2s
   6  -3.05538066e+05  2.33574596e+07  1.47e+02 9.34e-02  2.22e+02     2s
   7  -2.55678496e+05  1.60223286e+07  5.67e+01 6.04e-02  1.29e+02     3s
   8  -1.57517381e+05  1.16862646e+07  1.24e+01 4.30e-02  8.14e+01     3s
   9  -1.14161312e+05  6.90751833e+06  6.54e+00 2.49e-02  4.72e+01     3s
  10  -7.47042891e+04  2.59348485e+06  2.87e+00 8.69e-03  1.77e+01     3s
  11  -2.43589752e+04  5.42448334e+05  8.13e-01 1.54e-03  3.72e+00     3s
  12   4.44183682e+03  2.78281579e+05  5.20e-01 1.11e-03  1.80e+00     3s
  13   2.12240195e+04  2.18348880e+05  3.97e-01 1.93e-03  1.29e+00     3s
  14   3.18734366e+04  1.81349835e+05  3.25e-01 2.24e-03  9.80e-01     3s
  15   3.94526139e+04  1.62623849e+05  2.73e-01 3.63e-03  8.08e-01     3s
  16   4.48192403e+04  1.47632122e+05  2.38e-01 3.06e-03  6.74e-01     3s
  17   5.58804971e+04  1.29050818e+05  1.66e-01 2.60e-03  4.80e-01     3s
  18   6.14651821e+04  1.15774125e+05  1.33e-01 2.48e-03  3.56e-01     3s
  19   6.56888678e+04  1.10565884e+05  1.09e-01 2.35e-03  2.94e-01     3s
  20   6.94147224e+04  1.06416836e+05  8.87e-02 1.74e-03  2.43e-01     3s
  21   7.44077367e+04  1.02968840e+05  6.13e-02 1.48e-03  1.87e-01     3s
  22   7.67401978e+04  9.91635239e+04  4.91e-02 1.22e-03  1.47e-01     3s
  23   7.86331945e+04  9.47396208e+04  3.95e-02 1.09e-03  1.06e-01     3s
  24   7.92566070e+04  9.27569356e+04  3.66e-02 9.21e-04  8.86e-02     3s
  25   8.15701177e+04  9.24583012e+04  2.62e-02 8.70e-04  7.14e-02     3s
  26   8.23123753e+04  9.08705426e+04  2.28e-02 6.00e-04  5.61e-02     3s
  27   8.28807004e+04  9.01987910e+04  2.02e-02 4.80e-04  4.80e-02     3s
  28   8.36643714e+04  9.00886828e+04  1.68e-02 4.57e-04  4.21e-02     3s
  29   8.41689143e+04  8.93438844e+04  1.45e-02 3.95e-04  3.40e-02     3s
  30   8.51909047e+04  8.86577371e+04  9.81e-03 2.41e-04  2.27e-02     3s
  31   8.63425376e+04  8.83032076e+04  5.10e-03 1.58e-04  1.29e-02     3s
  32   8.66858019e+04  8.79867410e+04  3.64e-03 9.04e-05  8.54e-03     3s
  33   8.69842937e+04  8.78823261e+04  2.34e-03 1.05e-04  5.89e-03     3s
  34   8.70415565e+04  8.78074496e+04  2.11e-03 7.76e-05  5.02e-03     4s
  35   8.72913005e+04  8.76974455e+04  1.12e-03 3.56e-05  2.66e-03     4s
  36   8.74281839e+04  8.76268444e+04  6.13e-04 1.85e-05  1.30e-03     4s
  37   8.75209161e+04  8.76111006e+04  2.65e-04 8.63e-06  5.92e-04     4s
  38   8.75580207e+04  8.76026957e+04  1.28e-04 3.47e-06  2.93e-04     4s
  39   8.75912925e+04  8.75996095e+04  1.48e-05 1.47e-06  5.44e-05     4s
  40   8.75963480e+04  8.75969503e+04  1.83e-06 1.10e-06  3.94e-06     4s
  41   8.75968423e+04  8.75968499e+04  5.99e-08 4.33e-08  5.01e-08     4s
  42   8.75968464e+04  8.75968489e+04  3.99e-07 2.16e-07  1.59e-08     4s
  43   8.75968487e+04  8.75968489e+04  1.17e-06 5.64e-09  1.01e-09     4s

Barrier solved model in 43 iterations and 3.91 seconds (6.75 work units)
Optimal objective 8.75968487e+04


Root crossover log...

       0 DPushes remaining with DInf 0.0000000e+00                 7s

    3651 PPushes remaining with PInf 3.5381202e-05                 7s
       0 PPushes remaining with PInf 0.0000000e+00                 7s

  Push phase complete: Pinf 0.0000000e+00, Dinf 4.0949993e+02      7s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   43933    8.7596849e+04   0.000000e+00   4.094999e+02      7s
   44016    8.7596849e+04   0.000000e+00   0.000000e+00      8s
   44016    8.7596849e+04   0.000000e+00   0.000000e+00      8s
Concurrent spin time: 1.07s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 8.759685e+04, 44016 iterations, 6.99 seconds (14.28 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 87596.8489    0  143 -155958.45 87596.8489   156%     -    9s
H    0     0                    -152023.2305 87596.8489   158%     -    9s
H    0     0                    -62527.16189 87596.8489   240%     -    9s
H    0     0                    -62320.70719 87596.8489   241%     -    9s
H    0     0                    -6771.611771 87596.8489  1394%     -    9s
H    0     0                    8810.2536633 87596.8489   894%     -    9s
H    0     0                    28927.100395 87596.8489   203%     -   10s
H    0     0                    29103.678162 87596.8489   201%     -   10s
H    0     0                    29709.778241 87596.8489   195%     -   10s
H    0     0                    31507.351106 87596.8489   178%     -   10s
H    0     0                    34629.501629 87596.8489   153%     -   10s
H    0     0                    38245.017512 87596.8489   129%     -   11s
H    0     0                    38248.905252 87596.8489   129%     -   11s
     0     0 82566.3934    0  206 38248.9053 82566.3934   116%     -   37s
H    0     0                    38337.606499 82566.1937   115%     -   37s
     0     0 81702.0044    0  202 38337.6065 81702.0044   113%     -   53s
     0     0 81642.5030    0  207 38337.6065 81642.5030   113%     -   56s
     0     0 81642.5030    0  214 38337.6065 81642.5030   113%     -   58s
     0     0 81579.3494    0  217 38337.6065 81579.3494   113%     -   59s
     0     0 81415.0762    0  209 38337.6065 81415.0762   112%     -   66s
     0     0 81292.7733    0  213 38337.6065 81292.7733   112%     -   72s
     0     0 81285.2565    0  217 38337.6065 81285.2565   112%     -   73s
     0     0 81285.2565    0  208 38337.6065 81285.2565   112%     -   76s
     0     0 81285.2565    0  204 38337.6065 81285.2565   112%     -   77s
     0     0 81281.4237    0  204 38337.6065 81281.4237   112%     -   80s
     0     0 81280.9507    0  204 38337.6065 81280.9507   112%     -   80s
     0     0 78258.5797    0  232 38337.6065 78258.5797   104%     -  102s
H    0     0                    40359.545117 78258.5797  93.9%     -  103s
H    0     0                    40487.480063 78258.5797  93.3%     -  103s
H    0     0                    40582.516101 78258.5797  92.8%     -  103s
     0     0 77938.8521    0  248 40582.5161 77938.8521  92.1%     -  116s
     0     0 77687.6955    0  255 40582.5161 77687.6955  91.4%     -  128s
     0     0 77570.4182    0  249 40582.5161 77570.4182  91.1%     -  136s
     0     0 77514.3540    0  246 40582.5161 77514.3540  91.0%     -  138s
     0     0 77484.0748    0  241 40582.5161 77484.0748  90.9%     -  141s
     0     0 77439.7728    0  248 40582.5161 77439.7728  90.8%     -  146s
     0     0 77435.9824    0  244 40582.5161 77435.9824  90.8%     -  148s
     0     0 77431.6406    0  248 40582.5161 77431.6406  90.8%     -  151s
     0     0 77406.1496    0  244 40582.5161 77406.1496  90.7%     -  154s
     0     0 77189.1227    0  247 40582.5161 77189.1227  90.2%     -  160s
     0     0 77130.0809    0  249 40582.5161 77130.0809  90.1%     -  163s
     0     0 77125.4749    0  248 40582.5161 77125.4749  90.0%     -  164s
     0     0 77123.0385    0  243 40582.5161 77123.0385  90.0%     -  164s
     0     0 77122.5793    0  245 40582.5161 77122.5793  90.0%     -  165s
     0     0 74985.0466    0  292 40582.5161 74985.0466  84.8%     -  196s
H    0     0                    40848.104732 74984.2968  83.6%     -  196s
H    0     0                    41715.931701 74984.2968  79.7%     -  196s
H    0     0                    41858.078818 74984.2968  79.1%     -  196s
H    0     0                    42121.877867 74984.2968  78.0%     -  196s
H    0     0                    42143.963461 74984.2968  77.9%     -  197s
     0     0 74433.4229    0  316 42143.9635 74433.4229  76.6%     -  210s
     0     0 74170.9163    0  313 42143.9635 74170.9163  76.0%     -  223s
     0     0 74079.9925    0  341 42143.9635 74079.9925  75.8%     -  229s
     0     0 73935.3516    0  334 42143.9635 73935.3516  75.4%     -  237s
     0     0 73920.3954    0  349 42143.9635 73920.3954  75.4%     -  240s
     0     0 73873.0200    0  340 42143.9635 73873.0200  75.3%     -  243s
     0     0 73854.0861    0  343 42143.9635 73854.0861  75.2%     -  246s
     0     0 73802.9635    0  365 42143.9635 73802.9635  75.1%     -  250s
     0     0 73789.1243    0  363 42143.9635 73789.1243  75.1%     -  252s
     0     0 73786.7216    0  355 42143.9635 73786.7216  75.1%     -  253s
     0     0 73756.4084    0  354 42143.9635 73756.4084  75.0%     -  256s
     0     0 73754.1305    0  351 42143.9635 73754.1305  75.0%     -  257s
     0     0 73742.4400    0  362 42143.9635 73742.4400  75.0%     -  259s
     0     0 73740.8341    0  352 42143.9635 73740.8341  75.0%     -  259s
     0     0 72646.7815    0  329 42143.9635 72646.7815  72.4%     -  289s
     0     0 72451.7523    0  340 42143.9635 72451.7523  71.9%     -  299s
     0     0 72370.3746    0  336 42143.9635 72370.3746  71.7%     -  306s
H    0     0                    42206.944154 72299.1893  71.3%     -  309s
     0     0 72299.1893    0  336 42206.9442 72299.1893  71.3%     -  309s
     0     0 72257.9086    0  346 42206.9442 72257.9086  71.2%     -  313s
     0     0 72249.2366    0  337 42206.9442 72249.2366  71.2%     -  314s
     0     0 72235.9101    0  346 42206.9442 72235.9101  71.1%     -  316s
     0     0 72227.2596    0  348 42206.9442 72227.2596  71.1%     -  318s
     0     0 72224.1047    0  350 42206.9442 72224.1047  71.1%     -  319s
     0     0 72221.4115    0  342 42206.9442 72221.4115  71.1%     -  320s
     0     0 72215.1520    0  342 42206.9442 72215.1520  71.1%     -  322s
     0     0 72214.6833    0  342 42206.9442 72214.6833  71.1%     -  322s
     0     0 72078.1081    0  357 42206.9442 72078.1081  70.8%     -  335s
H    0     0                    42602.728480 72078.0455  69.2%     -  336s
H    0     0                    42757.650206 72078.0455  68.6%     -  336s
     0     0 72041.5963    0  370 42757.6502 72041.5963  68.5%     -  340s
     0     0 72023.0202    0  375 42757.6502 72023.0202  68.4%     -  343s
     0     0 72013.2738    0  367 42757.6502 72013.2738  68.4%     -  345s
     0     0 72006.6011    0  371 42757.6502 72006.6011  68.4%     -  347s
     0     0 72002.8391    0  364 42757.6502 72002.8391  68.4%     -  349s
     0     0 71999.6609    0  357 42757.6502 71999.6609  68.4%     -  350s
     0     0 71999.4799    0  368 42757.6502 71999.4799  68.4%     -  350s
     0     0 71917.3541    0  328 42757.6502 71917.3541  68.2%     -  358s
     0     0 71904.0934    0  335 42757.6502 71904.0934  68.2%     -  361s
     0     0 71891.3997    0  352 42757.6502 71891.3997  68.1%     -  363s
     0     0 71886.5601    0  360 42757.6502 71886.5601  68.1%     -  365s
     0     0 71885.1797    0  351 42757.6502 71885.1797  68.1%     -  366s
     0     0 71850.3037    0  355 42757.6502 71850.3037  68.0%     -  370s
     0     0 71846.5980    0  354 42757.6502 71846.5980  68.0%     -  371s
     0     0 71843.7593    0  359 42757.6502 71843.7593  68.0%     -  373s
     0     0 71843.5072    0  357 42757.6502 71843.5072  68.0%     -  373s
     0     0 71817.4439    0  351 42757.6502 71817.4439  68.0%     -  376s
     0     0 71815.2407    0  352 42757.6502 71815.2407  68.0%     -  379s
     0     0 71799.6255    0  350 42757.6502 71799.6255  67.9%     -  383s
H    0     0                    42781.952418 71799.3203  67.8%     -  384s
     0     0 71793.5687    0  377 42781.9524 71793.5687  67.8%     -  386s
     0     0 71790.9040    0  371 42781.9524 71790.9040  67.8%     -  390s
     0     0 71790.3186    0  374 42781.9524 71790.3186  67.8%     -  391s
     0     0 71785.0998    0  363 42781.9524 71785.0998  67.8%     -  394s
H    0     0                    42933.482104 71784.7373  67.2%     -  395s
     0     0 71781.9242    0  357 42933.4821 71781.9242  67.2%     -  396s
     0     0 71779.6328    0  367 42933.4821 71779.6328  67.2%     -  397s
     0     0 71776.5689    0  373 42933.4821 71776.5689  67.2%     -  399s
     0     0 71775.8545    0  373 42933.4821 71775.8545  67.2%     -  400s
H    0     0                    43374.231462 71775.8545  65.5%     -  465s
H    0     0                    43502.813887 71775.8545  65.0%     -  471s
     0     2 71775.8545    0  373 43502.8139 71775.8545  65.0%     -  472s
     1     3 71085.4108    1  304 43502.8139 71775.8545  65.0% 11524  484s
     2     4 71533.1677    1  364 43502.8139 71533.1677  64.4%  7594  492s
     3     8 71266.0882    2  360 43502.8139 71533.1296  64.4%  7980  502s
     7    16 71189.1711    3  396 43502.8139 71420.5237  64.2%  5674  524s
    15    32 71136.2559    4  395 43502.8139 71280.2912  63.9%  7451  549s
    31    48 70078.7638    5  382 43502.8139 71214.1938  63.7% 11337  592s
H   47    80                    44990.072534 71214.1938  58.3% 11968  610s
    79   166 69667.4014    7  335 44990.0725 71214.1938  58.3%  8837  661s
H  165   275                    45061.964852 71214.1938  58.0%  5694  678s
H  221   275                    46120.366566 71214.1938  54.4%  4809  678s
   274   349 69403.4745   13  308 46120.3666 71214.1938  54.4%  4260  692s
H  348   400                    46303.984431 71214.1938  53.8%  3954  705s
H  388   400                    46551.800398 71214.1938  53.0%  3907  705s
   399   461 68649.3057   17  287 46551.8004 71214.1938  53.0%  3921  718s
   460   491 68443.9865   19  287 46551.8004 71214.1938  53.0%  3857  728s
   490   530 68336.7483   20  315 46551.8004 71214.1938  53.0%  3779  739s
   529   561 68327.2095   21  280 46551.8004 71214.1938  53.0%  3716  750s
H  535   561                    46570.241607 71214.1938  52.9%  3692  750s
H  537   561                    46572.365474 71214.1938  52.9%  3686  750s
   560   652 68315.2124   22  276 46572.3655 71214.1938  52.9%  3662  762s
   651   682 67726.1834   27  254 46572.3655 71214.1938  52.9%  3422  772s
   683   724 67721.4156   28  251 46572.3655 71214.1938  52.9%  3411  782s
   725   764 67584.8808   29  247 46572.3655 71214.1938  52.9%  3342  792s
   765   799 66253.3929   30  251 46572.3655 71214.1938  52.9%  3280  810s
   806   834 66215.1586   31  250 46572.3655 71214.1938  52.9%  3308  824s
   848   871 66115.9172   32  246 46572.3655 71214.1938  52.9%  3273  843s
   885   913 66107.1205   33  234 46572.3655 71214.1938  52.9%  3253  855s
H  907   913                    46608.897211 71214.1938  52.8%  3211  855s
H  928   913                    46615.678125 71214.1938  52.8%  3172  855s
   933   994 66101.1260   34  234 46615.6781 71214.1938  52.8%  3166  868s
  1016  1050 65889.2114   40  223 46615.6781 71214.1938  52.8%  3073  883s
  1086  1114 65051.0436   45  245 46615.6781 71214.1938  52.8%  3035  899s
H 1094  1114                    46691.473419 71214.1938  52.5%  3044  899s
  1159  1196 63981.9879   47  246 46691.4734 71214.1938  52.5%  3040  913s
  1253  1278 59932.8433   48  215 46691.4734 71214.1938  52.5%  2973  930s
  1371  1382 59598.7223   49  237 46691.4734 71214.1938  52.5%  2897  946s
  1497  1438 58853.4499   52  248 46691.4734 71214.1938  52.5%  2833  965s
  1591  1494 55411.0089   54  224 46691.4734 71214.1938  52.5%  2810  982s
  1684  1515 55035.6245   56  218 46691.4734 71214.1938  52.5%  2807 1000s
  1763  1558 47837.8671   57  215 46691.4734 71214.1938  52.5%  2808 1020s
  1858  1575 58977.8621   22  286 46691.4734 71214.1938  52.5%  2824 1040s
  1895  1600 58866.3079   23  292 46691.4734 71214.1938  52.5%  2855 1065s
H 1905  1600                    46802.308296 71214.1938  52.2%  2867 1065s
  1946  1678 58087.9363   27  233 46802.3083 71214.1938  52.2%  2904 1087s
  2091  1755 57365.5771   32  297 46802.3083 71214.1938  52.2%  2862 1110s
  2226  1778 56879.0242   38  274 46802.3083 71214.1938  52.2%  2847 1127s
H 2239  1778                    46807.888246 71214.1938  52.1%  2859 1127s
  2264  1833 56391.4617   39  256 46807.8882 71214.1938  52.1%  2898 1149s
  2370  1870 55560.6343   41  275 46807.8882 71214.1938  52.1%  2947 1176s
  2459  1911 54594.4941   45  268 46807.8882 71214.1938  52.1%  2996 1203s
  2546  1959 54113.7188   46  289 46807.8882 71135.9765  52.0%  3052 1231s
  2626  1985 53138.0380   51  300 46807.8882 71135.9765  52.0%  3105 1255s
  2660  2011 53030.6860   52  243 46807.8882 71135.9765  52.0%  3174 1280s
  2698  2053 52724.9223   53  300 46807.8882 71135.9765  52.0%  3214 1307s
H 2720  2053                    46872.648700 71135.9765  51.8%  3239 1307s
  2764  2150 52628.9937   56  241 46872.6487 71135.9765  51.8%  3263 1336s
  2901  2239 50461.5298   69  300 46872.6487 70839.9754  51.1%  3289 1367s
  3034  2339 49403.9442   80  230 46872.6487 70838.9835  51.1%  3316 1397s
  3201  2371 47437.4086   98  182 46872.6487 70838.9835  51.1%  3325 1420s
H 3225  2371                    46894.687705 70838.9835  51.1%  3327 1420s
  3249  2483 67738.6908    8  315 46894.6877 70838.9835  51.1%  3357 1453s
  3397  2565 66664.6935    9  294 46894.6877 70838.9835  51.1%  3397 1487s
  3550  2623 64166.9449   10  290 46894.6877 70838.9835  51.1%  3430 1519s
  3672  2696 66440.1743    9  229 46894.6877 70838.9835  51.1%  3444 1555s
  3839  2791 62193.6073   11  260 46894.6877 70838.9835  51.1%  3474 1595s
  3994  2870 61604.0550   13  197 46894.6877 70838.9835  51.1%  3524 1637s
  4130  2871 68861.5681   14  373 46894.6877 70838.9835  51.1%  3550 1714s
  4132  2872 58276.3498   21  106 46894.6877 70838.9835  51.1%  3548 1724s
  4133  2873 69097.3369    9  284 46894.6877 70838.9835  51.1%  3548 1777s
  4134  2874 61694.2362   36  297 46894.6877 70838.9835  51.1%  3547 1809s
  4135  2874 55797.1859   25  330 46894.6877 70838.9835  51.1%  3546 1837s
  4136  2875 54402.9830   29  351 46894.6877 70838.9835  51.1%  3545 1853s
  4137  2876 64031.1578   21  373 46894.6877 70838.9835  51.1%  3544 1868s
  4138  2876 60900.2878   33  360 46894.6877 70838.9835  51.1%  3543 1883s
  4139  2877 48696.2099   56  354 46894.6877 70838.9835  51.1%  3542 1894s
  4140  2878 50854.2522   48  359 46894.6877 70838.9835  51.1%  3542 1900s
  4142  2879 66283.5437   11  363 46894.6877 70838.9835  51.1%  3540 1907s
  4143  2880 58848.0648   53  342 46894.6877 70838.9835  51.1%  3539 1910s
  4145  2881 58118.8903   33  365 46894.6877 70838.9835  51.1%  3537 1915s
  4146  2882 54682.8406   27  370 46894.6877 70838.9835  51.1%  3536 1926s
  4148  2883 65299.8157   15  378 46894.6877 70838.9835  51.1%  3535 1930s
  4150  2884 52441.6212   34  377 46894.6877 70838.9835  51.1%  3533 1935s
  4151  2885 64628.4276   26  383 46894.6877 70838.9835  51.1%  3532 1943s
  4152  2886 64345.8234   29  374 46894.6877 70838.9835  51.1%  3531 1946s
  4154  2887 66541.8439   16  368 46894.6877 70838.9835  51.1%  3530 1951s
  4157  2889 64587.7260   20  381 46894.6877 70838.9835  51.1%  3527 1961s
  4158  2890 55610.6507   15  379 46894.6877 70838.9835  51.1%  3526 1965s
  4161  2892 51972.2383   26  354 46894.6877 70838.9835  51.1%  3524 1975s
  4162  2892 54799.3140   62  376 46894.6877 70838.9835  51.1%  3523 1980s
  4165  2894 58304.7615   40  379 46894.6877 70838.9835  51.1%  3520 1985s
  4166  2895 65709.3809   15  385 46894.6877 70838.9835  51.1%  3519 1991s
  4168  2896 65854.2759   13  383 46894.6877 70838.9835  51.1%  3518 1995s
  4169  2897 51802.8748   43  385 46894.6877 70838.9835  51.1%  3517 2001s
  4171  2898 48774.4092   54  382 46894.6877 70838.9835  51.1%  3515 2008s
  4172  2899 63241.1046    8  392 46894.6877 70838.9835  51.1%  3514 2010s
  4173  2900 67168.7549    7  389 46894.6877 70838.9835  51.1%  3514 2015s
  4176  2902 51802.8748   43  390 46894.6877 70838.9835  51.1%  3511 2021s
  4177  2902 50344.3921   26  396 46894.6877 70838.9835  51.1%  3510 2026s
  4178  2903 53280.3335   18  398 46894.6877 70838.9835  51.1%  3509 2030s
  4179  2904 52315.0875   58  391 46894.6877 70838.9835  51.1%  3508 2037s
  4180  2904 49104.4957   23  391 46894.6877 70838.9835  51.1%  3508 2054s
  4181  2905 55197.8066   34  391 46894.6877 70838.9835  51.1%  3507 2106s
  4182  2909 70838.9835   12  375 46894.6877 70838.9835  51.1%  3571 2158s
  4184  2912 70838.9835   13  369 46894.6877 70838.9835  51.1%  3577 2207s
  4188  2919 70838.9835   14  417 46894.6877 70838.9835  51.1%  3586 2242s
  4196  2932 70838.9835   15  381 46894.6877 70838.9835  51.1%  3601 2282s
  4212  2943 70724.2743   16  367 46894.6877 70838.9835  51.1%  3662 2354s
  4228  2969 67278.2642   17  289 46894.6877 70838.9835  51.1%  3728 2393s
  4260  3092 66795.0901   18  271 46894.6877 70838.9835  51.1%  3809 2436s
  4393  3104 65944.3662   22  256 46894.6877 70838.9835  51.1%  3872 2459s
  4450  3125 65590.8985   21  269 46894.6877 70838.9835  51.1%  3890 2479s
  4490  3154 65035.3726   23  284 46894.6877 70838.9835  51.1%  3924 2503s
  4533  3179 65835.6261   23  254 46894.6877 70838.9835  51.1%  3982 2534s
  4587  3188 62954.8493   24  296 46894.6877 70838.9835  51.1%  4031 2557s
  4639  3194 64089.8877   24  247 46894.6877 70838.9835  51.1%  4067 2589s
  4684  3195 57319.7561   31  235 46894.6877 70838.9835  51.1%  4113 2615s
  4715  3204 60108.6745   24  249 46894.6877 70838.9835  51.1%  4147 2636s
  4759  3203 60772.2403   24  238 46894.6877 70838.9835  51.1%  4203 2656s
  4796  3210 59665.9588   25  234 46894.6877 70838.9835  51.1%  4262 2675s
  4838  3208 53078.5723   33  201 46894.6877 70838.9835  51.1%  4312 2697s
  4888  3217 57364.7162   26  206 46894.6877 70838.9835  51.1%  4352 2723s
  4937  3216 56827.6169   27  197 46894.6877 70838.9835  51.1%  4427 2752s
  4978  3219 55665.6196   27  177 46894.6877 70838.9835  51.1%  4481 2779s
  5033  3220 55147.8269   28  179 46894.6877 70838.9835  51.1%  4541 2808s
  5083  3218 56421.0410   26  249 46894.6877 70838.9835  51.1%  4597 2839s
  5145  3212 56083.8079   28  203 46894.6877 70838.9835  51.1%  4672 2864s
  5210  3215 53416.6129   29  215 46894.6877 70838.9835  51.1%  4727 2886s
  5252  3234 54002.1214   28  162 46894.6877 70838.9835  51.1%  4767 2915s
  5314  3230 54455.2194   29  213 46894.6877 70838.9835  51.1%  4826 2939s
  5384  3231 52121.3601   30  225 46894.6877 70838.9835  51.1%  4894 2965s
  5454  3233 52030.3192   31  218 46894.6877 70838.9835  51.1%  4952 2995s
  5526  3227 51108.6854   34  194 46894.6877 70838.9835  51.1%  5028 3025s
  5571  3234 49755.6985   35  212 46894.6877 70838.9835  51.1%  5076 3055s
  5637  3253 49418.6379   36  213 46894.6877 70838.9835  51.1%  5145 3089s
  5710  3264 49271.2858   37  208 46894.6877 70614.8760  50.6%  5203 3129s
  5804  3272 infeasible   39      46894.6877 70614.8760  50.6%  5258 3162s
  5890  3295 61714.4264   20  250 46894.6877 70614.8760  50.6%  5334 3203s
  5977  3292 59414.3168   22  243 46894.6877 70614.8760  50.6%  5417 3237s
  6013  3309 56635.9625   23  243 46894.6877 70614.8760  50.6%  5474 3272s
  6047  3325 55449.3061   24  201 46894.6877 70614.8760  50.6%  5531 3304s
  6094  3355 59993.7239   22  282 46894.6877 70614.8760  50.6%  5573 3336s
  6145  3380 55297.2718   25  204 46894.6877 70614.8760  50.6%  5611 3373s
  6225  3424 51166.8067   27  128 46894.6877 70614.8760  50.6%  5654 3415s
  6335  3440 47533.9154   31  107 46894.6877 70614.8760  50.6%  5731 3479s
  6458  3485 50511.8068   32  216 46894.6877 68156.0885  45.3%  5813 3530s
  6586  3501 48002.4723   38  183 46894.6877 68156.0885  45.3%  5903 3583s
  6723  3493 48916.4451   23  236 46894.6877 68156.0885  45.3%  5992 3600s

Cutting planes:
  Learned: 1
  Implied bound: 24
  Projected implied bound: 177
  MIR: 1166
  Mixing: 5
  Flow cover: 2287
  RLT: 28
  Relax-and-lift: 361

Explored 6778 nodes (41079187 simplex iterations) in 3600.03 seconds (9605.91 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 46894.7 46872.6 46807.9 ... 46551.8

Time limit reached
Best objective 4.689468770453e+04, best bound 6.815608850696e+04, gap 45.3386%
  WARNING: Time limit reached. Using best solution found (gap: 45.34%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.04s
  Master Objective (UB) = 46894.69, θ = 225490.63
  Upper Bound (UB) = 46894.69

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 225490.63
  [DEBUG]   ✓ Scenario 0: θ = 225490.63 ≤ Q = 225490.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 225490.63 ≤ Q = 225490.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 225490.63 ≤ Q = 225490.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 225490.63 ≤ Q = 225490.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 225490.63 ≤ Q = 225490.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 225490.63 ≤ Q = 225490.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 225490.63 ≤ Q = 225490.63 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 225490.63 ≤ Q = 225490.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 225490.63 ≤ Q = 225490.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 225490.63 ≤ Q = 225490.63 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 10] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x3b1faa
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x003b1faa
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [1e-11, 1e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.403146e+13
Presolve removed 2600 rows and 1891 columns
Presolve time: 0.00s
Presolved: 493 rows, 498 columns, 1390 nonzeros
Found heuristic solution: objective 6775645.0164
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.823278e+05, 260 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -182327.84    0  129 6775645.02 -182327.84   103%     -    0s
H    0     0                    -143708.6785 -182327.84  26.9%     -    0s
H    0     0                    -144010.0365 -182327.84  26.6%     -    0s
H    0     0                    -144426.1396 -182327.84  26.2%     -    0s
H    0     0                    -146695.5216 -162518.50  10.8%     -    0s
H    0     0                    -154456.1181 -162518.50  5.22%     -    0s
     0     0 -162518.50    0   69 -154456.12 -162518.50  5.22%     -    0s
H    0     0                    -159842.8329 -162445.69  1.63%     -    0s
H    0     0                    -160636.4869 -162445.69  1.13%     -    0s
     0     0 -162356.48    0   54 -160636.49 -162356.48  1.07%     -    0s
     0     0 -162355.41    0   67 -160636.49 -162355.41  1.07%     -    0s
     0     0 -162355.41    0   67 -160636.49 -162355.41  1.07%     -    0s
     0     0 -161482.35    0   45 -160636.49 -161482.35  0.53%     -    0s
     0     0 -161476.69    0   44 -160636.49 -161476.69  0.52%     -    0s
     0     0 -161476.08    0   44 -160636.49 -161476.08  0.52%     -    0s
     0     0 -161301.27    0   31 -160636.49 -161301.27  0.41%     -    0s
H    0     0                    -160689.5366 -161229.15  0.34%     -    0s
     0     0 -161229.15    0   30 -160689.54 -161229.15  0.34%     -    0s
     0     0 -161194.14    0    9 -160689.54 -161194.14  0.31%     -    0s
H    0     0                    -160832.7487 -161182.66  0.22%     -    0s
     0     0 -161011.67    0   34 -160832.75 -161011.67  0.11%     -    0s
     0     0 -161010.75    0   33 -160832.75 -161010.75  0.11%     -    0s
     0     0 -160978.86    0   33 -160832.75 -160978.86  0.09%     -    0s
     0     0 -160954.34    0   33 -160832.75 -160954.34  0.08%     -    0s
     0     0 -160908.37    0   32 -160832.75 -160908.37  0.05%     -    0s
     0     0 -160906.34    0   27 -160832.75 -160906.34  0.05%     -    0s
     0     0 -160890.27    0   25 -160832.75 -160890.27  0.04%     -    0s
     0     0 -160890.27    0   19 -160832.75 -160890.27  0.04%     -    0s
     0     0 -160890.27    0   19 -160832.75 -160890.27  0.04%     -    0s
H    0     0                    -160868.2175 -160890.27  0.01%     -    0s
     0     0 -160890.27    0   21 -160868.22 -160890.27  0.01%     -    0s
     0     0          -    0      -160868.22 -160883.66  0.01%     -    0s

Cutting planes:
  MIR: 23
  Flow cover: 12

Explored 1 nodes (708 simplex iterations) in 0.06 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -160868 -160833 -160690 ... -144426

Optimal solution found (tolerance 1.00e-04)
Best objective -1.608682174826e+05, best bound -1.608836589315e+05, gap 0.0096%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 212600.80
  Scenario: 21 demand increases, 39 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -160868.22
  [DEBUG]   S×d_nominal = 373469.02
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 373469.02 + -160868.22 = 212600.80
  [DEBUG]   Current θ from Master = 225490.63
  [DEBUG]   ⚠️  Z_SP ≤ θ by 12889.83 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 34004.86
  Lower Bound (LB) = 45250.14
  Gap (UB-LB) = 1644.5450, Absolute Gap = 1644.5450, Relative Gap = 0.035069
  Not converged yet (gap = 1644.55 > ε = 200)

  [DEBUG] Adding NEW scenario 10 to Master Problem...
  [DEBUG] New scenario pattern: 21 increases, 39 decreases
    [DEBUG] Scenario 10 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 10 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 10]
    [DEBUG]   - Total constraints in model: 169573
    [DEBUG]   - Total variables in model: 70900
  [DEBUG] Total scenarios in Master: 11
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 11
================================================================================
[Iteration 11] Solving Master Problem...
  Current scenarios in Master: 11
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 169573 rows, 70900 columns and 481060 nonzeros
Model fingerprint: 0x64229ab5
Variable types: 68641 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 77950 rows and 31660 columns
Presolve time: 1.31s
Presolved: 91623 rows, 39240 columns, 557575 nonzeros
Variable types: 36981 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -279161.5038
Found heuristic solution: objective -155958.4539

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.17s

Barrier statistics:
 Dense cols : 642
 AA' NZ     : 3.023e+06
 Factor NZ  : 7.039e+06 (roughly 100 MB of memory)
 Factor Ops : 1.285e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.69308994e+07  1.71106616e+08  1.35e+05 2.48e+01  8.05e+04     2s
   1  -1.29361689e+07  1.60997545e+08  9.53e+04 8.26e+01  5.64e+04     2s
   2  -5.16719148e+06  1.19370212e+08  3.83e+04 3.13e+00  2.42e+04     2s
   3  -9.42480295e+05  9.50998924e+07  3.34e+03 1.41e+00  2.62e+03     2s
   4  -4.43917699e+05  5.50914485e+07  6.43e+02 5.08e-01  6.90e+02     3s
   5  -3.53515530e+05  2.99328649e+07  2.57e+02 2.34e-01  3.06e+02     3s
   6  -2.98711297e+05  2.09360368e+07  9.55e+01 1.52e-01  1.68e+02     3s
   7  -2.41516752e+05  1.54167260e+07  3.87e+01 1.06e-01  1.08e+02     3s
   8  -1.32774543e+05  1.08167025e+07  8.38e+00 7.13e-02  6.76e+01     3s
   9  -8.40156145e+04  5.79681725e+06  4.28e+00 3.70e-02  3.57e+01     3s
  10  -5.00730188e+04  1.41660960e+06  2.12e+00 8.32e-03  8.84e+00     3s
  11  -5.75362651e+03  5.41481662e+05  1.02e+00 2.76e-03  3.28e+00     3s
  12   1.39279814e+04  3.37344170e+05  6.44e-01 1.77e-03  1.93e+00     3s
  13   2.30240640e+04  2.43705990e+05  5.16e-01 1.59e-03  1.32e+00     3s
  14   2.99302793e+04  2.12522607e+05  4.47e-01 1.21e-03  1.09e+00     3s
  15   3.58299198e+04  1.85902010e+05  3.92e-01 1.57e-03  8.97e-01     3s
  16   4.58936650e+04  1.54373578e+05  3.11e-01 2.18e-03  6.48e-01     3s
  17   5.39873672e+04  1.42515042e+05  2.46e-01 2.52e-03  5.29e-01     3s
  18   5.69352932e+04  1.30421823e+05  2.23e-01 2.34e-03  4.39e-01     3s
  19   6.45847515e+04  1.19677575e+05  1.67e-01 2.27e-03  3.29e-01     3s
  20   6.80366282e+04  1.10831212e+05  1.42e-01 2.44e-03  2.56e-01     3s
  21   7.24949132e+04  1.06485109e+05  1.12e-01 2.20e-03  2.03e-01     3s
  22   7.38804007e+04  1.03965758e+05  1.02e-01 2.02e-03  1.80e-01     3s
  23   7.68705314e+04  1.01312399e+05  8.23e-02 1.79e-03  1.46e-01     3s
  24   7.92529451e+04  9.85635580e+04  6.50e-02 1.57e-03  1.15e-01     3s
  25   8.07777654e+04  9.62117898e+04  5.46e-02 1.76e-03  9.22e-02     3s
  26   8.22054813e+04  9.52945921e+04  4.52e-02 1.65e-03  7.82e-02     3s
  27   8.37957154e+04  9.40428531e+04  3.49e-02 1.36e-03  6.12e-02     3s
  28   8.48715679e+04  9.31909263e+04  2.84e-02 1.17e-03  4.97e-02     3s
  29   8.56075029e+04  9.22850996e+04  2.38e-02 7.89e-04  3.99e-02     3s
  30   8.58057876e+04  9.20240783e+04  2.27e-02 7.14e-04  3.71e-02     3s
  31   8.67273212e+04  9.12941559e+04  1.73e-02 8.41e-04  2.73e-02     3s
  32   8.74673263e+04  9.10076072e+04  1.30e-02 6.36e-04  2.11e-02     3s
  33   8.80041830e+04  9.07057221e+04  9.88e-03 4.42e-04  1.61e-02     4s
  34   8.82704887e+04  9.04082924e+04  8.31e-03 3.34e-04  1.28e-02     4s
  35   8.88988687e+04  9.02735918e+04  4.71e-03 2.32e-04  8.21e-03     4s
  36   8.92246647e+04  9.01390989e+04  2.86e-03 1.74e-04  5.46e-03     4s
  37   8.94628088e+04  9.00567541e+04  1.55e-03 1.32e-04  3.54e-03     4s
  38   8.94955696e+04  8.99632233e+04  1.38e-03 8.94e-05  2.79e-03     4s
  39   8.96082753e+04  8.98970666e+04  7.99e-04 5.79e-05  1.72e-03     4s
  40   8.96559935e+04  8.98670431e+04  5.55e-04 4.30e-05  1.26e-03     4s
  41   8.96795380e+04  8.98250096e+04  4.38e-04 3.11e-05  8.68e-04     4s
  42   8.97182274e+04  8.98011667e+04  2.41e-04 1.95e-05  4.95e-04     4s
  43   8.97314007e+04  8.97927926e+04  1.80e-04 1.36e-05  3.66e-04     4s
  44   8.97462508e+04  8.97857460e+04  1.12e-04 8.93e-06  2.36e-04     4s
  45   8.97612926e+04  8.97780659e+04  4.28e-05 3.72e-06  1.00e-04     4s
  46   8.97684607e+04  8.97756690e+04  1.35e-05 2.15e-06  4.30e-05     4s
  47   8.97700002e+04  8.97742211e+04  8.05e-06 1.21e-06  2.52e-05     4s
  48   8.97710686e+04  8.97734684e+04  4.32e-06 8.79e-07  1.43e-05     4s
  49   8.97717492e+04  8.97727780e+04  1.85e-06 3.53e-07  6.13e-06     4s
  50   8.97721828e+04  8.97723361e+04  4.05e-07 7.19e-08  9.14e-07     4s
  51   8.97723092e+04  8.97723124e+04  6.96e-09 9.11e-09  1.89e-08     4s
  52   8.97723115e+04  8.97723115e+04  7.65e-09 5.98e-11  2.63e-10     4s

Barrier solved model in 52 iterations and 4.33 seconds (7.75 work units)
Optimal objective 8.97723115e+04


Root crossover log...

       0 DPushes remaining with DInf 0.0000000e+00                 7s

    2326 PPushes remaining with PInf 1.1291898e-05                 7s
       0 PPushes remaining with PInf 0.0000000e+00                 7s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.1128676e+02      7s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   37652    8.9772312e+04   0.000000e+00   1.112868e+02      7s
   37680    8.9772312e+04   0.000000e+00   0.000000e+00      7s
   37680    8.9772312e+04   0.000000e+00   0.000000e+00      7s
Concurrent spin time: 0.59s

Solved with barrier

Root relaxation: objective 8.977231e+04, 37680 iterations, 6.22 seconds (13.54 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 89772.3115    0  220 -155958.45 89772.3115   158%     -    8s
H    0     0                    -154907.4817 89772.3115   158%     -    8s
H    0     0                    -45724.50168 89772.3115   296%     -    8s
H    0     0                    -45724.42582 89772.3115   296%     -    8s
H    0     0                    -45517.97113 89772.3115   297%     -    8s
H    0     0                    -9535.761655 89772.3115  1041%     -    8s
H    0     0                    10751.634338 89772.3115   735%     -    8s
H    0     0                    19170.822937 89772.3115   368%     -    8s
H    0     0                    26491.006519 89772.3115   239%     -    9s
H    0     0                    30624.357542 89772.3115   193%     -    9s
H    0     0                    31719.677185 89772.3115   183%     -    9s
H    0     0                    31977.471277 89772.3115   181%     -    9s
H    0     0                    31979.926332 89772.3115   181%     -    9s
H    0     0                    32383.291823 82993.3741   156%     -   44s
     0     0 82993.3741    0  256 32383.2918 82993.3741   156%     -   44s
     0     0 81921.0884    0  275 32383.2918 81921.0884   153%     -   65s
     0     0 81625.3597    0  273 32383.2918 81625.3597   152%     -   77s
     0     0 81452.5083    0  300 32383.2918 81452.5083   152%     -   89s
     0     0 81452.5083    0  296 32383.2918 81452.5083   152%     -   93s
     0     0 81452.5083    0  290 32383.2918 81452.5083   152%     -   97s
     0     0 81442.1535    0  271 32383.2918 81442.1535   151%     -  104s
     0     0 81434.3673    0  277 32383.2918 81434.3673   151%     -  106s
     0     0 81434.3673    0  277 32383.2918 81434.3673   151%     -  106s
H    0     0                    34286.784460 78127.6029   128%     -  134s
     0     0 78127.6029    0  292 34286.7845 78127.6029   128%     -  134s
     0     0 77523.2744    0  307 34286.7845 77523.2744   126%     -  150s
     0     0 77278.8462    0  323 34286.7845 77278.8462   125%     -  163s
H    0     0                    35395.066658 77041.0228   118%     -  176s
H    0     0                    36129.701143 77041.0228   113%     -  176s
H    0     0                    37130.457914 77041.0228   107%     -  176s
     0     0 77041.0228    0  292 37130.4579 77041.0228   107%     -  176s
     0     0 76960.7973    0  312 37130.4579 76960.7973   107%     -  183s
     0     0 76886.3178    0  315 37130.4579 76886.3178   107%     -  189s
     0     0 76866.7129    0  313 37130.4579 76866.7129   107%     -  193s
     0     0 76860.9329    0  314 37130.4579 76860.9329   107%     -  195s
     0     0 76851.1054    0  310 37130.4579 76851.1054   107%     -  197s
     0     0 76849.3781    0  312 37130.4579 76849.3781   107%     -  198s
     0     0 76849.3642    0  312 37130.4579 76849.3642   107%     -  198s
H    0     0                    39870.630150 76849.3642  92.7%     -  210s
H    0     0                    41583.001607 76849.3642  84.8%     -  210s
H    0     0                    41617.524937 76849.3642  84.7%     -  210s
H    0     0                    41724.536896 76849.3642  84.2%     -  210s
H    0     0                    42347.355166 76849.3642  81.5%     -  210s
     0     0 74711.3396    0  327 42347.3552 74711.3396  76.4%     -  245s
H    0     0                    43083.187852 74709.0218  73.4%     -  246s
H    0     0                    43822.652316 74709.0218  70.5%     -  246s
     0     0 74216.0605    0  352 43822.6523 74216.0605  69.4%     -  275s
H    0     0                    43868.381328 74014.8999  68.7%     -  291s
H    0     0                    43966.818494 74014.8999  68.3%     -  291s
     0     0 74014.8999    0  362 43966.8185 74014.8999  68.3%     -  291s
     0     0 73902.0054    0  371 43966.8185 73902.0054  68.1%     -  300s
     0     0 73860.2516    0  354 43966.8185 73860.2516  68.0%     -  308s
     0     0 73840.7293    0  353 43966.8185 73840.7293  67.9%     -  311s
     0     0 73802.7337    0  368 43966.8185 73802.7337  67.9%     -  317s
     0     0 73794.9175    0  366 43966.8185 73794.9175  67.8%     -  319s
     0     0 73784.8606    0  370 43966.8185 73784.8606  67.8%     -  323s
     0     0 73756.8230    0  360 43966.8185 73756.8230  67.8%     -  329s
     0     0 73746.6759    0  374 43966.8185 73746.6759  67.7%     -  331s
     0     0 73730.3977    0  361 43966.8185 73730.3977  67.7%     -  335s
     0     0 73723.1166    0  380 43966.8185 73723.1166  67.7%     -  338s
     0     0 73719.8352    0  383 43966.8185 73719.8352  67.7%     -  339s
     0     0 73714.9608    0  372 43966.8185 73714.9608  67.7%     -  341s
     0     0 73713.9849    0  370 43966.8185 73713.9849  67.7%     -  342s
     0     0 72872.0427    0  338 43966.8185 72872.0427  65.7%     -  376s
     0     0 72689.2537    0  349 43966.8185 72689.2537  65.3%     -  392s
     0     0 72622.1954    0  352 43966.8185 72622.1954  65.2%     -  401s
     0     0 72597.0707    0  352 43966.8185 72597.0707  65.1%     -  404s
     0     0 72536.3576    0  352 43966.8185 72536.3576  65.0%     -  408s
     0     0 72507.6583    0  355 43966.8185 72507.6583  64.9%     -  412s
     0     0 72492.0467    0  352 43966.8185 72492.0467  64.9%     -  414s
     0     0 72486.0183    0  362 43966.8185 72486.0183  64.9%     -  415s
     0     0 72481.9874    0  357 43966.8185 72481.9874  64.9%     -  417s
     0     0 72476.2613    0  354 43966.8185 72476.2613  64.8%     -  417s
     0     0 72467.9318    0  365 43966.8185 72467.9318  64.8%     -  419s
     0     0 72467.7128    0  363 43966.8185 72467.7128  64.8%     -  420s
H    0     0                    44500.545709 72467.7128  62.8%     -  420s
H    0     0                    44769.056281 72294.3809  61.5%     -  433s
H    0     0                    45248.340589 72294.3809  59.8%     -  433s
     0     0 72294.3809    0  352 45248.3406 72294.3809  59.8%     -  433s
     0     0 72199.7474    0  336 45248.3406 72199.7474  59.6%     -  440s
     0     0 72172.9812    0  331 45248.3406 72172.9812  59.5%     -  445s
     0     0 72148.6036    0  344 45248.3406 72148.6036  59.5%     -  451s
     0     0 72134.2873    0  336 45248.3406 72134.2873  59.4%     -  453s
     0     0 72129.5824    0  346 45248.3406 72129.5824  59.4%     -  456s
     0     0 72104.2799    0  349 45248.3406 72104.2799  59.4%     -  460s
     0     0 72098.5777    0  359 45248.3406 72098.5777  59.3%     -  464s
     0     0 72092.5342    0  353 45248.3406 72092.5342  59.3%     -  468s
     0     0 72088.4547    0  347 45248.3406 72088.4547  59.3%     -  469s
     0     0 72088.0033    0  358 45248.3406 72088.0033  59.3%     -  470s
     0     0 72054.6735    0  353 45248.3406 72054.6735  59.2%     -  477s
     0     0 72034.9163    0  352 45248.3406 72034.9163  59.2%     -  483s
     0     0 72032.8557    0  354 45248.3406 72032.8557  59.2%     -  484s
     0     0 72015.2119    0  357 45248.3406 72015.2119  59.2%     -  490s
     0     0 72008.5673    0  367 45248.3406 72008.5673  59.1%     -  493s
     0     0 72005.5080    0  363 45248.3406 72005.5080  59.1%     -  494s
     0     0 72004.0827    0  358 45248.3406 72004.0827  59.1%     -  495s
     0     0 71996.1985    0  359 45248.3406 71996.1985  59.1%     -  498s
H    0     0                    45271.749297 71996.1037  59.0%     -  504s
H    0     0                    45805.059800 71993.1970  57.2%     -  506s
     0     0 71993.1970    0  357 45805.0598 71993.1970  57.2%     -  506s
     0     0 71991.3672    0  363 45805.0598 71991.3672  57.2%     -  507s
     0     0 71982.8733    0  369 45805.0598 71982.8733  57.2%     -  510s
H    0     0                    45902.894099 71982.8235  56.8%     -  511s
     0     0 71980.4127    0  369 45902.8941 71980.4127  56.8%     -  512s
     0     0 71975.8624    0  367 45902.8941 71975.8624  56.8%     -  514s
     0     0 71975.6488    0  367 45902.8941 71975.6488  56.8%     -  516s
H    0     0                    46154.401094 71975.5497  55.9%     -  606s
H    0     0                    46620.681400 71975.5497  54.4%     -  606s
H    0     0                    46730.214721 71975.5497  54.0%     -  606s
H    0     0                    46814.107568 71975.5497  53.7%     -  609s
H    0     0                    46831.238845 71975.5497  53.7%     -  609s
H    0     2                    47063.406584 71975.5497  52.9%     -  621s
     0     2 71975.5497    0  367 47063.4066 71975.5497  52.9%     -  621s
     1     4 71905.4640    1  360 47063.4066 71975.5497  52.9%  2474  629s
     3     7 71882.0734    2  361 47063.4066 71904.3912  52.8%  4392  644s
     6    14 71807.0833    3  351 47063.4066 71881.8994  52.7%  6763  667s
    13    26 70736.7235    4  351 47063.4066 71806.8947  52.6%  8823  693s
    25    38 69821.7053    4  333 47063.4066 71806.8947  52.6% 15283  732s
    37    69 70430.2203    5  359 47063.4066 71017.5022  50.9% 13652  774s
H   38    69                    47119.802494 71017.5022  50.7% 13293  774s
H   49    69                    47149.978757 71017.5022  50.6% 13621  774s
H   50    69                    47232.934517 71017.5022  50.4% 13616  774s
H   56    69                    47246.150846 71017.5022  50.3% 12549  774s
    68   178 70248.5034    6  354 47246.1508 70736.7148  49.7% 12981  813s
   177   268 68965.5943    9  331 47246.1508 70736.7148  49.7%  8611  835s
   267   325 68636.9845   12  333 47246.1508 70736.7148  49.7%  6921  857s
   324   382 68393.9330   15  333 47246.1508 70736.7148  49.7%  6571  875s
   381   441 68262.8042   17  335 47246.1508 70736.7148  49.7%  6142  898s
   440   472 67477.3948   19  305 47246.1508 70736.7148  49.7%  5776  915s
   471   508 67425.0722   20  315 47246.1508 70736.7148  49.7%  5727  932s
   507   542 66800.0510   23  273 47246.1508 70736.7148  49.7%  5692  948s
   541   572 68493.1170   21  288 47246.1508 70736.7148  49.7%  5573  964s
   571   614 66227.1992   23  272 47246.1508 70736.7148  49.7%  5460  982s
   613   677 65684.9814   24  256 47246.1508 70736.7148  49.7%  5346 1000s
   678   738 65586.9121   25  274 47246.1508 70736.7148  49.7%  5118 1018s
   741   790 64975.7577   30  269 47246.1508 70736.7148  49.7%  4961 1034s
   801   839 64567.1744   33  256 47246.1508 70736.7148  49.7%  4809 1051s
   864   896 64186.0417   36  282 47246.1508 70736.7148  49.7%  4753 1068s
   939   956 63006.8173   38  282 47246.1508 70736.7148  49.7%  4573 1130s
  1011  1022 62951.0036   39  273 47246.1508 70736.7148  49.7%  4439 1149s
  1117  1087 64086.6589   32  299 47246.1508 70736.7148  49.7%  4231 1168s
  1223  1134 54888.0918   39  248 47246.1508 70736.7148  49.7%  4071 1189s
  1307  1202 53655.2692   41  238 47246.1508 70736.7148  49.7%  4015 1208s
  1414  1256 53212.1664   45  237 47246.1508 70736.7148  49.7%  3956 1228s
  1497  1319     cutoff   50      47246.1508 70736.7148  49.7%  3962 1249s
  1594  1390 48725.4259   51  205 47246.1508 70736.7148  49.7%  3960 1279s
  1688  1475 69948.0125    8  336 47246.1508 70575.5461  49.4%  3898 1304s
  1799  1516 68433.2487   10  312 47246.1508 70575.5461  49.4%  3845 1330s
  1920  1589 61659.7034   11  243 47246.1508 70575.5461  49.4%  3765 1357s
  2023  1711 59960.2085   12  216 47246.1508 70575.5461  49.4%  3784 1383s
  2159  1773 55587.7468   14  196 47246.1508 70575.5461  49.4%  3763 1419s
  2283  1858 53448.1956   16  168 47246.1508 70575.5461  49.4%  3741 1448s
  2410  1923     cutoff   17      47246.1508 70575.5461  49.4%  3722 1478s
  2547  2003 54748.7552   16  169 47246.1508 70424.9605  49.1%  3700 1510s
  2681  2095 49680.4816   20  162 47246.1508 70424.9605  49.1%  3685 1543s
  2829  2160     cutoff   28      47246.1508 70424.9605  49.1%  3670 1576s
  2952  2226 65686.0451    8  284 47246.1508 70424.9605  49.1%  3698 1611s
  3054  2290 61005.2585    9  278 47246.1508 70424.9605  49.1%  3750 1648s
H 3144  2349                    47264.191217 70424.9605  49.0%  3824 1683s
H 3148  2347                    47630.491746 70424.9605  47.9%  3826 1683s
  3247  2458 59634.1702   13  280 47630.4917 70424.9605  47.9%  3831 1721s
  3425  2535 57518.6371   17  277 47630.4917 69905.1907  46.8%  3804 1763s
  3549  2639 56092.8992   18  243 47630.4917 69905.1907  46.8%  3869 1806s
  3715  2789 51922.0116   19  251 47630.4917 69905.1907  46.8%  3893 1849s
  3931  2790 49145.9148   66  367 47630.4917 69905.1907  46.8%  3890 2060s
H 3932  2651                    47784.219344 69905.1907  46.3%  3889 2073s
  3934  2652 65713.4887   13  306 47784.2193 69905.1907  46.3%  3887 2125s
  3935  2653 52080.6059   19  326 47784.2193 69905.1907  46.3%  3886 2165s
  3936  2653 48372.3622   57  355 47784.2193 69905.1907  46.3%  3885 2197s
  3937  2654 56558.6147   37  324 47784.2193 69905.1907  46.3%  3884 2224s
  3938  2655 52889.1141   48  339 47784.2193 69905.1907  46.3%  3883 2243s
  3939  2655 48362.1581   50  344 47784.2193 69905.1907  46.3%  3882 2257s
  3940  2656 55687.0427   44  352 47784.2193 69905.1907  46.3%  3881 2270s
  3941  2657 48110.6706   19  361 47784.2193 69905.1907  46.3%  3880 2285s
  3942  2657 52741.9225   18  367 47784.2193 69905.1907  46.3%  3879 2295s
  3944  2659 49558.5529   35  367 47784.2193 69905.1907  46.3%  3877 2312s
  3945  2659 65360.0231   31  365 47784.2193 69905.1907  46.3%  3876 2319s
  3946  2660 59354.9760   63  366 47784.2193 69905.1907  46.3%  3875 2324s
  3947  2661 67312.8611   18  351 47784.2193 69905.1907  46.3%  3875 2335s
  3948  2661 53659.0404   36  367 47784.2193 69905.1907  46.3%  3874 2340s
  3949  2662 50785.3754   97  369 47784.2193 69905.1907  46.3%  3873 2347s
  3950  2663 67516.3583   20  378 47784.2193 69905.1907  46.3%  3872 2351s
  3951  2663 58407.0055   13  354 47784.2193 69905.1907  46.3%  3871 2359s
  3952  2664 49136.7942   56  360 47784.2193 69905.1907  46.3%  3870 2364s
  3953  2665 49310.9618   51  358 47784.2193 69905.1907  46.3%  3869 2372s
  3954  2665 54629.3986   36  351 47784.2193 69905.1907  46.3%  3868 2375s
  3955  2666 49342.5540   41  353 47784.2193 69905.1907  46.3%  3867 2380s
  3956  2667 60363.8793   24  386 47784.2193 69905.1907  46.3%  3866 2389s
  3957  2667 59026.6292   67  391 47784.2193 69905.1907  46.3%  3865 2392s
  3958  2668 64115.3175   11  385 47784.2193 69905.1907  46.3%  3864 2396s
  3959  2669 58577.1715   15  369 47784.2193 69905.1907  46.3%  3863 2404s
  3960  2669 63528.2390   21  342 47784.2193 69905.1907  46.3%  3862 2407s
  3961  2670 66160.4228   19  349 47784.2193 69905.1907  46.3%  3861 2413s
  3962  2671 59414.7651   41  352 47784.2193 69905.1907  46.3%  3860 2415s
  3963  2671 63580.9168   10  359 47784.2193 69905.1907  46.3%  3859 2421s
  3964  2672 48910.6741   32  359 47784.2193 69905.1907  46.3%  3858 2442s
  3965  2673 68345.5078   16  359 47784.2193 69905.1907  46.3%  3857 2518s
  3966  2675 69905.1907   10  304 47784.2193 69905.1907  46.3%  3935 2579s
  3967  2677 68749.4313   11  312 47784.2193 69905.1907  46.3%  3936 2601s
  3969  2680 68380.2336   12  308 47784.2193 69905.1907  46.3%  3937 2625s
  3973  2688 69668.4017   12  299 47784.2193 69905.1907  46.3%  3941 2674s
  3982  2703 67869.6089   13  321 47784.2193 69905.1907  46.3%  3964 2724s
  4000  2712 66823.9692   13  339 47784.2193 69905.1907  46.3%  4071 2794s
  4015  2738 64903.7601   15  345 47784.2193 69905.1907  46.3%  4120 2853s
  4046  2824 63966.7541   16  320 47784.2193 69905.1907  46.3%  4167 2904s
  4142  2836 62976.6529   19  259 47784.2193 69905.1907  46.3%  4226 2934s
  4186  2855 58414.6570   20  244 47784.2193 69905.1907  46.3%  4291 2966s
  4229  2879 57641.8392   21  269 47784.2193 69905.1907  46.3%  4336 3004s
  4277  2903 55629.4116   22  221 47784.2193 69905.1907  46.3%  4372 3042s
  4345  2924 55234.1307   23  219 47784.2193 69693.3794  45.9%  4398 3084s
  4412  2924 53141.3159   24  214 47784.2193 69690.9801  45.8%  4424 3112s
  4443  2936 52997.8279   25  207 47784.2193 69690.9801  45.8%  4453 3139s
  4483  2946 52760.6408   26  204 47784.2193 69690.9801  45.8%  4467 3162s
  4527  2957 52264.8542   27  205 47784.2193 69690.9801  45.8%  4485 3186s
  4574  2961 56366.0953   24  286 47784.2193 69215.5229  44.9%  4497 3211s
  4622  2964     cutoff   28      47784.2193 69215.5229  44.9%  4519 3236s
  4674  2964 48630.8515   26  211 47784.2193 69215.5229  44.9%  4529 3264s
  4713  2964 48176.1407   27  218 47784.2193 69215.5229  44.9%  4546 3295s
  4760  2974     cutoff   28      47784.2193 69215.5229  44.9%  4565 3322s
  4824  2979 infeasible   27      47784.2193 68935.0008  44.3%  4568 3352s
  4895  2983 67389.1691   14  342 47784.2193 68933.6228  44.3%  4580 3389s
  4956  2988 infeasible   30      47784.2193 68933.6228  44.3%  4579 3422s
  5024  3006 63964.2641   14  324 47784.2193 68194.4937  42.7%  4598 3456s
  5100  2998 52273.8466   27  195 47784.2193 68194.4937  42.7%  4610 3485s
  5141  3016 63103.7360   15  316 47784.2193 68194.4937  42.7%  4613 3515s
  5202  3017 62435.0284   16  300 47784.2193 68194.4937  42.7%  4618 3543s
  5271  3013 61645.4106   17  290 47784.2193 68194.4937  42.7%  4627 3575s
  5342  3016     cutoff   33      47784.2193 68194.4937  42.7%  4643 3600s

Cutting planes:
  Learned: 1
  Gomory: 4
  Implied bound: 43
  Projected implied bound: 316
  MIR: 925
  Mixing: 3
  Flow cover: 1945
  RLT: 35
  Relax-and-lift: 455

Explored 5393 nodes (25588095 simplex iterations) in 3600.06 seconds (9133.18 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 47784.2 47630.5 47264.2 ... 46814.1

Time limit reached
Best objective 4.778421934361e+04, best bound 6.738901146191e+04, gap 41.0278%
  WARNING: Time limit reached. Using best solution found (gap: 41.03%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = 47784.22, θ = 190547.54
  Upper Bound (UB) = 47784.22

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 190547.54
  [DEBUG]   ✓ Scenario 0: θ = 190547.54 ≤ Q = 190547.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 190547.54 ≤ Q = 190547.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 190547.54 ≤ Q = 191113.94 (slack: 566.41)
  [DEBUG]   ✓ Scenario 3: θ = 190547.54 ≤ Q = 190547.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 190547.54 ≤ Q = 190547.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 190547.54 ≤ Q = 190547.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 190547.54 ≤ Q = 190547.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 190547.54 ≤ Q = 190547.54 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 190547.54 ≤ Q = 190547.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 190547.54 ≤ Q = 190547.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 190547.54 ≤ Q = 190547.54 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 11] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x57655ac0
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xa89aa540
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 1e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.357766e+13
Presolve removed 2624 rows and 1912 columns
Presolve time: 0.00s
Presolved: 469 rows, 477 columns, 1328 nonzeros
Found heuristic solution: objective 6428627.7867
Variable types: 321 continuous, 156 integer (156 binary)
Found heuristic solution: objective 6427812.5507

Root relaxation: objective -1.582035e+05, 220 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -158203.53    0  116 6427812.55 -158203.53   102%     -    0s
H    0     0                    -126487.1771 -158203.53  25.1%     -    0s
H    0     0                    -127371.1307 -158203.53  24.2%     -    0s
H    0     0                    -128925.9844 -141142.61  9.48%     -    0s
     0     0 -141142.61    0   84 -128925.98 -141142.61  9.48%     -    0s
H    0     0                    -134077.0760 -141014.54  5.17%     -    0s
H    0     0                    -137094.6079 -141014.54  2.86%     -    0s
H    0     0                    -138401.9676 -139986.13  1.14%     -    0s
     0     0 -139986.13    0  108 -138401.97 -139986.13  1.14%     -    0s
     0     0 -139973.85    0  108 -138401.97 -139973.85  1.14%     -    0s
     0     0 -139750.45    0   78 -138401.97 -139750.45  0.97%     -    0s
H    0     0                    -138694.9374 -139743.33  0.76%     -    0s
     0     0 -139721.05    0   87 -138694.94 -139721.05  0.74%     -    0s
     0     0 -139595.65    0   58 -138694.94 -139595.65  0.65%     -    0s
     0     0 -139535.19    0   72 -138694.94 -139535.19  0.61%     -    0s
     0     0 -139530.95    0   72 -138694.94 -139530.95  0.60%     -    0s
     0     0 -139416.89    0   50 -138694.94 -139416.89  0.52%     -    0s
     0     0 -139373.44    0   52 -138694.94 -139373.44  0.49%     -    0s
     0     0 -139370.81    0   50 -138694.94 -139370.81  0.49%     -    0s
     0     0 -139316.10    0   49 -138694.94 -139316.10  0.45%     -    0s
     0     0 -139312.10    0   49 -138694.94 -139312.10  0.44%     -    0s
     0     2 -139311.21    0   49 -138694.94 -139311.21  0.44%     -    0s
H   34    13                    -138753.4691 -139070.50  0.23%  11.9    0s
H  276   102                    -138755.1534 -138914.98  0.12%   8.7    0s
*  589    88              29    -138759.0446 -138885.75  0.09%   7.9    0s
H  669    88                    -138761.3767 -138875.15  0.08%   7.7    0s
*  743    48              26    -138763.6366 -138875.15  0.08%   7.6    0s

Cutting planes:
  Gomory: 41
  Implied bound: 12
  MIR: 135
  Flow cover: 20
  RLT: 50
  Relax-and-lift: 2
  BQP: 3

Explored 979 nodes (7799 simplex iterations) in 0.19 seconds (0.11 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -138764 -138761 -138759 ... -127371
No other solutions better than -138764

Optimal solution found (tolerance 1.00e-04)
Best objective -1.387636365595e+05, best bound -1.387636365595e+05, gap 0.0000%
  Subproblem solved in 0.20s
  Worst-case operational profit (Z_SP) = 177519.89
  Scenario: 42 demand increases, 18 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -138763.64
  [DEBUG]   S×d_nominal = 316283.53
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 316283.53 + -138763.64 = 177519.89
  [DEBUG]   Current θ from Master = 190547.54
  [DEBUG]   ⚠️  Z_SP ≤ θ by 13027.64 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 34756.57
  Lower Bound (LB) = 45250.14
  Gap (UB-LB) = 2534.0767, Absolute Gap = 2534.0767, Relative Gap = 0.053032
  Not converged yet (gap = 2534.08 > ε = 200)

  [DEBUG] Adding NEW scenario 11 to Master Problem...
  [DEBUG] New scenario pattern: 42 increases, 18 decreases
    [DEBUG] Scenario 11 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 11 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 11]
    [DEBUG]   - Total constraints in model: 184863
    [DEBUG]   - Total variables in model: 77140
  [DEBUG] Total scenarios in Master: 12
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 12
================================================================================
[Iteration 12] Solving Master Problem...
  Current scenarios in Master: 12
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 184863 rows, 77140 columns and 524291 nonzeros
Model fingerprint: 0x0a7837d0
Variable types: 74881 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 85020 rows and 34530 columns
Presolve time: 1.49s
Presolved: 99843 rows, 42610 columns, 605315 nonzeros
Variable types: 40351 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -281940.6902
Found heuristic solution: objective -155958.4539

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.19s

Barrier statistics:
 Dense cols : 638
 AA' NZ     : 3.453e+06
 Factor NZ  : 8.163e+06 (roughly 120 MB of memory)
 Factor Ops : 1.551e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.74572239e+07  1.84891509e+08  1.39e+05 2.27e+01  8.25e+04     3s
   1  -1.33580321e+07  1.74819302e+08  9.81e+04 8.17e+01  5.77e+04     3s
   2  -4.88707042e+06  1.28984450e+08  3.82e+04 3.49e+00  2.39e+04     3s
   3  -1.13849120e+06  1.02181730e+08  4.11e+03 1.73e+00  3.04e+03     3s
   4  -6.54166584e+05  7.28148632e+07  6.92e+02 1.05e+00  7.93e+02     3s
   5  -4.86479092e+05  3.64399569e+07  4.10e+02 4.21e-01  4.05e+02     3s
   6  -4.01627310e+05  3.00395970e+07  1.73e+02 3.29e-01  2.48e+02     3s
   7  -3.14513361e+05  2.19708892e+07  8.94e+01 2.27e-01  1.60e+02     3s
   8  -2.39836552e+05  1.57920751e+07  3.82e+01 1.56e-01  1.01e+02     3s
   9  -1.70281006e+05  1.10757145e+07  1.38e+01 1.05e-01  6.54e+01     3s
  10  -1.08062656e+05  6.25005346e+06  6.28e+00 5.69e-02  3.59e+01     3s
  11  -5.15359220e+04  1.06142286e+06  2.07e+00 6.81e-03  6.18e+00     3s
  12  -9.83618888e+03  4.58917317e+05  1.16e+00 2.26e-03  2.59e+00     3s
  13   8.98921036e+03  4.30681541e+05  8.12e-01 2.17e-03  2.32e+00     3s
  14   1.46940133e+04  3.19236860e+05  6.75e-01 1.76e-03  1.68e+00     3s
  15   2.01770058e+04  2.26453200e+05  5.83e-01 1.17e-03  1.13e+00     3s
  16   3.35403049e+04  1.76222353e+05  4.41e-01 1.83e-03  7.84e-01     3s
  17   4.61600992e+04  1.46456112e+05  3.23e-01 2.15e-03  5.51e-01     3s
  18   5.45658115e+04  1.29334369e+05  2.54e-01 2.05e-03  4.11e-01     3s
  19   6.14787586e+04  1.15101527e+05  2.00e-01 2.03e-03  2.95e-01     3s
  20   6.59927713e+04  1.09139812e+05  1.66e-01 1.60e-03  2.37e-01     3s
  21   7.04602215e+04  1.04400857e+05  1.32e-01 1.40e-03  1.86e-01     3s
  22   7.33726590e+04  1.01733576e+05  1.10e-01 1.26e-03  1.56e-01     3s
  23   7.71293538e+04  9.92409247e+04  8.14e-02 1.41e-03  1.21e-01     3s
  24   7.88462395e+04  9.69862789e+04  6.84e-02 1.25e-03  9.96e-02     3s
  25   8.08948992e+04  9.50240699e+04  5.39e-02 7.72e-04  7.76e-02     3s
  26   8.32246134e+04  9.39485853e+04  3.85e-02 7.13e-04  5.89e-02     4s
  27   8.41399742e+04  9.26132939e+04  3.24e-02 6.00e-04  4.65e-02     4s
  28   8.54731742e+04  9.19496297e+04  2.38e-02 8.13e-04  3.55e-02     4s
  29   8.64584929e+04  9.13623809e+04  1.75e-02 1.03e-03  2.69e-02     4s
  30   8.73204198e+04  9.06469761e+04  1.23e-02 6.20e-04  1.83e-02     4s
  31   8.77732291e+04  9.02310277e+04  9.55e-03 4.32e-04  1.35e-02     4s
  32   8.82219297e+04  8.99731342e+04  6.84e-03 2.49e-04  9.61e-03     4s
  33   8.85502135e+04  8.97881483e+04  4.98e-03 1.71e-04  6.80e-03     4s
  34   8.87650764e+04  8.97338339e+04  3.75e-03 1.45e-04  5.32e-03     4s
  35   8.88626105e+04  8.96988966e+04  3.17e-03 1.55e-04  4.59e-03     4s
  36   8.89246923e+04  8.96118609e+04  2.80e-03 1.05e-04  3.77e-03     4s
  37   8.89971943e+04  8.96022903e+04  2.39e-03 9.85e-05  3.32e-03     4s
  38   8.91007808e+04  8.95453147e+04  1.81e-03 6.48e-05  2.44e-03     4s
  39   8.91843697e+04  8.95290597e+04  1.35e-03 5.79e-05  1.89e-03     4s
  40   8.92841735e+04  8.94821327e+04  7.68e-04 2.95e-05  1.09e-03     4s
  41   8.92907325e+04  8.94587958e+04  7.31e-04 1.90e-05  9.23e-04     4s
  42   8.93257046e+04  8.94551035e+04  5.30e-04 1.69e-05  7.11e-04     4s
  43   8.93489864e+04  8.94457447e+04  3.95e-04 1.45e-05  5.31e-04     4s
  44   8.93797324e+04  8.94434683e+04  2.29e-04 1.27e-05  3.50e-04     4s
  45   8.93897921e+04  8.94313707e+04  1.74e-04 8.67e-06  2.28e-04     4s
  46   8.93997437e+04  8.94290940e+04  1.23e-04 5.56e-06  1.61e-04     4s
  47   8.94120662e+04  8.94275099e+04  6.03e-05 3.41e-06  8.48e-05     4s
  48   8.94179500e+04  8.94253830e+04  3.13e-05 8.19e-07  4.08e-05     4s
  49   8.94238326e+04  8.94252854e+04  2.14e-06 6.71e-07  7.95e-06     5s
  50   8.94241828e+04  8.94249636e+04  1.25e-06 3.01e-07  4.27e-06     5s
  51   8.94242846e+04  8.94249323e+04  9.80e-07 2.67e-07  3.55e-06     5s
  52   8.94245628e+04  8.94249229e+04  2.22e-07 2.57e-07  1.97e-06     5s
  53   8.94246575e+04  8.94247961e+04  2.82e-08 1.21e-07  7.58e-07     5s
  54   8.94246772e+04  8.94246988e+04  5.86e-09 1.87e-08  1.18e-07     5s
  55   8.94246781e+04  8.94246964e+04  4.35e-09 1.55e-07  1.00e-07     5s
  56   8.94246786e+04  8.94246943e+04  7.00e-07 1.17e-06  8.69e-08     5s
  57   8.94246798e+04  8.94246827e+04  2.85e-07 6.08e-07  1.61e-08     5s
  58   8.94246806e+04  8.94246806e+04  5.35e-08 3.11e-08  9.65e-11     5s

Barrier solved model in 58 iterations and 5.10 seconds (9.92 work units)
Optimal objective 8.94246806e+04


Root crossover log...

   86776 DPushes remaining with DInf 0.0000000e+00                 5s
       0 DPushes remaining with DInf 0.0000000e+00                 8s

    1768 PPushes remaining with PInf 4.7995793e-06                 8s
       0 PPushes remaining with PInf 0.0000000e+00                 8s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.9188539e-01      8s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   37671    8.9424681e+04   0.000000e+00   3.918854e-01      8s
   37682    8.9424681e+04   0.000000e+00   0.000000e+00      8s
   37682    8.9424681e+04   0.000000e+00   0.000000e+00      9s
Concurrent spin time: 0.47s

Solved with barrier

Root relaxation: objective 8.942468e+04, 37682 iterations, 7.04 seconds (16.16 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 89424.6806    0  223 -155958.45 89424.6806   157%     -    9s
H    0     0                    -151388.3666 89424.6806   159%     -    9s
H    0     0                    -149219.9135 89424.6806   160%     -    9s
H    0     0                    -149171.3929 89424.6806   160%     -   10s
H    0     0                    -148439.0346 89424.6806   160%     -   10s
H    0     0                    -147317.9269 89424.6806   161%     -   10s
H    0     0                    -45948.69088 89424.6806   295%     -   10s
H    0     0                    -45948.61502 89424.6806   295%     -   10s
H    0     0                    3420.8678566 89424.6806  2514%     -   10s
H    0     0                    13598.898786 89424.6806   558%     -   10s
H    0     0                    26115.121619 89424.6806   242%     -   11s
H    0     0                    32192.991184 89424.6806   178%     -   11s
H    0     0                    33977.845134 89424.6806   163%     -   11s
H    0     0                    34225.282691 89424.6806   161%     -   11s
H    0     0                    34259.791438 89424.6806   161%     -   11s
     0     0 83382.2896    0  262 34259.7914 83382.2896   143%     -   49s
     0     0 82390.6995    0  286 34259.7914 82390.6995   140%     -   79s
     0     0 82310.5224    0  273 34259.7914 82310.5224   140%     -   90s
     0     0 82310.5224    0  281 34259.7914 82310.5224   140%     -   93s
     0     0 82174.3888    0  266 34259.7914 82174.3888   140%     -   97s
     0     0 82174.3888    0  241 34259.7914 82174.3888   140%     -  110s
     0     0 82174.3888    0  253 34259.7914 82174.3888   140%     -  116s
     0     0 82174.3888    0  253 34259.7914 82174.3888   140%     -  117s
     0     0 82158.4709    0  268 34259.7914 82158.4709   140%     -  124s
     0     0 82153.5088    0  266 34259.7914 82153.5088   140%     -  126s
     0     0 82128.0190    0  275 34259.7914 82128.0190   140%     -  129s
     0     0 79195.8859    0  271 34259.7914 79195.8859   131%     -  131s
     0     0 79195.8859    0  271 34259.7914 79195.8859   131%     -  131s
     0     0 78524.5958    0  315 34259.7914 78524.5958   129%     -  175s
H    0     0                    35911.146263 78524.4747   119%     -  176s
H    0     0                    36128.284367 78524.4747   117%     -  176s
H    0     0                    36210.103077 78524.4747   117%     -  176s
H    0     0                    36325.363278 78524.4747   116%     -  176s
     0     0 78007.2025    0  337 36325.3633 78007.2025   115%     -  199s
     0     0 77840.2652    0  342 36325.3633 77840.2652   114%     -  216s
     0     0 77766.8466    0  339 36325.3633 77766.8466   114%     -  225s
     0     0 77549.7260    0  326 36325.3633 77549.7260   113%     -  240s
     0     0 77513.6567    0  327 36325.3633 77513.6567   113%     -  247s
     0     0 77498.0780    0  331 36325.3633 77498.0780   113%     -  250s
     0     0 77487.9687    0  322 36325.3633 77487.9687   113%     -  254s
     0     0 77474.7898    0  321 36325.3633 77474.7898   113%     -  256s
     0     0 77473.6219    0  318 36325.3633 77473.6219   113%     -  258s
     0     0 75673.5135    0  323 36325.3633 75673.5135   108%     -  319s
H    0     0                    36924.938564 75673.1683   105%     -  319s
H    0     0                    38065.912403 75673.1683  98.8%     -  319s
H    0     0                    39025.110726 75673.1683  93.9%     -  319s
H    0     0                    39123.997050 75673.1683  93.4%     -  319s
H    0     0                    39146.878767 75673.1683  93.3%     -  319s
H    0     0                    39330.508851 75673.1683  92.4%     -  319s
H    0     0                    39671.388928 75673.1683  90.7%     -  319s
     0     0 75227.1314    0  337 39671.3889 75227.1314  89.6%     -  341s
     0     0 75072.4156    0  357 39671.3889 75072.4156  89.2%     -  354s
     0     0 74923.6029    0  346 39671.3889 74923.6029  88.9%     -  366s
     0     0 74857.9786    0  352 39671.3889 74857.9786  88.7%     -  374s
     0     0 74830.2151    0  355 39671.3889 74830.2151  88.6%     -  379s
H    0     0                    40294.912535 74761.5692  85.5%     -  386s
H    0     0                    40401.919168 74761.5692  85.0%     -  386s
H    0     0                    40878.916959 74761.5692  82.9%     -  386s
H    0     0                    40879.135621 74761.5692  82.9%     -  386s
     0     0 74761.5692    0  374 40879.1356 74761.5692  82.9%     -  386s
     0     0 74744.8368    0  371 40879.1356 74744.8368  82.8%     -  389s
     0     0 74728.1406    0  366 40879.1356 74728.1406  82.8%     -  393s
     0     0 74715.9578    0  374 40879.1356 74715.9578  82.8%     -  396s
     0     0 74708.9602    0  380 40879.1356 74708.9602  82.8%     -  398s
     0     0 74707.0163    0  382 40879.1356 74707.0163  82.8%     -  399s
     0     0 73382.5610    0  326 40879.1356 73382.5610  79.5%     -  441s
H    0     0                    40974.194616 73382.4496  79.1%     -  442s
H    0     0                    41017.736427 73382.4496  78.9%     -  442s
H    0     0                    41136.253261 73382.4496  78.4%     -  442s
     0     0 73141.5255    0  330 41136.2533 73141.5255  77.8%     -  460s
     0     0 73080.4516    0  370 41136.2533 73080.4516  77.7%     -  475s
     0     0 73040.9455    0  358 41136.2533 73040.9455  77.6%     -  483s
     0     0 72991.5348    0  347 41136.2533 72991.5348  77.4%     -  489s
     0     0 72899.1743    0  350 41136.2533 72899.1743  77.2%     -  497s
     0     0 72878.8035    0  371 41136.2533 72878.8035  77.2%     -  504s
     0     0 72862.5862    0  366 41136.2533 72862.5862  77.1%     -  507s
     0     0 72856.9008    0  361 41136.2533 72856.9008  77.1%     -  509s
     0     0 72852.7564    0  359 41136.2533 72852.7564  77.1%     -  510s
     0     0 72846.0039    0  363 41136.2533 72846.0039  77.1%     -  513s
     0     0 72844.8131    0  364 41136.2533 72844.8131  77.1%     -  514s
     0     0 72622.6291    0  376 41136.2533 72622.6291  76.5%     -  531s
H    0     0                    42084.479135 72622.3369  72.6%     -  532s
     0     0 72514.0219    0  365 42084.4791 72514.0219  72.3%     -  541s
     0     0 72487.7087    0  350 42084.4791 72487.7087  72.2%     -  547s
     0     0 72448.6112    0  357 42084.4791 72448.6112  72.2%     -  553s
     0     0 72432.7410    0  356 42084.4791 72432.7410  72.1%     -  558s
     0     0 72403.5735    0  379 42084.4791 72403.5735  72.0%     -  563s
     0     0 72394.4136    0  380 42084.4791 72394.4136  72.0%     -  566s
     0     0 72388.6259    0  390 42084.4791 72388.6259  72.0%     -  568s
     0     0 72387.1045    0  374 42084.4791 72387.1045  72.0%     -  570s
     0     0 72226.6484    0  339 42084.4791 72226.6484  71.6%     -  586s
H    0     0                    42321.860677 72225.5923  70.7%     -  589s
H    0     0                    42918.390111 72225.5923  68.3%     -  589s
     0     0 72191.6336    0  371 42918.3901 72191.6336  68.2%     -  595s
     0     0 72184.5322    0  371 42918.3901 72184.5322  68.2%     -  598s
     0     0 72182.3418    0  370 42918.3901 72182.3418  68.2%     -  600s
     0     0 72128.5977    0  347 42918.3901 72128.5977  68.1%     -  609s
     0     0 72116.4048    0  339 42918.3901 72116.4048  68.0%     -  614s
     0     0 72110.4994    0  355 42918.3901 72110.4994  68.0%     -  616s
     0     0 72108.4857    0  353 42918.3901 72108.4857  68.0%     -  617s
     0     0 72084.7796    0  335 42918.3901 72084.7796  68.0%     -  624s
H    0     0                    44098.454207 72084.5678  63.5%     -  624s
H    0     0                    44117.749483 72084.5678  63.4%     -  625s
     0     0 72075.9174    0  346 44117.7495 72075.9174  63.4%     -  629s
     0     0 72073.4665    0  344 44117.7495 72073.4665  63.4%     -  630s
     0     0 72036.4971    0  352 44117.7495 72036.4971  63.3%     -  640s
     0     0 72025.6207    0  346 44117.7495 72025.6207  63.3%     -  644s
     0     0 72021.4820    0  342 44117.7495 72021.4820  63.2%     -  646s
     0     0 72019.3774    0  353 44117.7495 72019.3774  63.2%     -  647s
     0     0 72005.1497    0  360 44117.7495 72005.1497  63.2%     -  654s
H    0     0                    44362.488406 72005.0578  62.3%     -  657s
H    0     0                    44382.115282 72005.0578  62.2%     -  658s
H    0     0                    44723.456350 72005.0578  61.0%     -  658s
     0     0 71992.1755    0  347 44723.4564 71992.1755  61.0%     -  663s
     0     0 71991.0544    0  342 44723.4564 71991.0544  61.0%     -  664s
     0     0 71972.7874    0  400 44723.4564 71972.7874  60.9%     -  671s
     0     0 71964.6567    0  353 44723.4564 71964.6567  60.9%     -  674s
     0     0 71960.9690    0  390 44723.4564 71960.9690  60.9%     -  676s
     0     0 71960.6270    0  401 44723.4564 71960.6270  60.9%     -  677s
     0     0 71957.7819    0  347 44723.4564 71957.7819  60.9%     -  680s
H    0     0                    44760.688384 71957.7527  60.8%     -  691s
     0     0 71957.0404    0  347 44760.6884 71957.0404  60.8%     -  692s
     0     0 71952.4157    0  365 44760.6884 71952.4157  60.7%     -  695s
     0     0 71951.3786    0  352 44760.6884 71951.3786  60.7%     -  697s
     0     0 71948.9431    0  353 44760.6884 71948.9431  60.7%     -  699s
     0     0 71948.9413    0  353 44760.6884 71948.9413  60.7%     -  701s
H    0     0                    44775.182831 71948.9287  60.7%     -  857s
H    0     0                    45057.141448 71948.9287  59.7%     -  858s
     0     2 71948.9287    0  353 45057.1414 71948.9287  59.7%     -  890s
     1     4 71445.6839    1  340 45057.1414 71948.9287  59.7%  9743  915s
     3     8 71365.0407    2  345 45057.1414 71445.6792  58.6% 13086  931s
     7    15 71199.8217    3  334 45057.1414 71371.9785  58.4% 12504  955s
    14    27 69763.0986    4  331 45057.1414 71371.9785  58.4% 13763  992s
    26    38 67221.3022    5  282 45057.1414 71199.8062  58.0% 17504 3600s

Cutting planes:
  Learned: 2
  Gomory: 20
  Implied bound: 216
  MIR: 1946
  Flow cover: 2329
  RLT: 74
  Relax-and-lift: 782

Explored 37 nodes (1313028 simplex iterations) in 3600.07 seconds (6271.56 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 45057.1 44775.2 44760.7 ... 42321.9

Time limit reached
Best objective 4.505714144780e+04, best bound 7.080253277453e+04, gap 57.1394%
  WARNING: Time limit reached. Using best solution found (gap: 57.14%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3600.09s
  Master Objective (UB) = 45057.14, θ = 192259.28
  Upper Bound (UB) = 45057.14

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 192259.28
  [DEBUG]   ✓ Scenario 0: θ = 192259.28 ≤ Q = 192259.28 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 192259.28 ≤ Q = 192259.28 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 192259.28 ≤ Q = 192259.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 192259.28 ≤ Q = 192259.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 192259.28 ≤ Q = 192259.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 192259.28 ≤ Q = 192259.28 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 192259.28 ≤ Q = 192259.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 192259.28 ≤ Q = 192259.28 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 192259.28 ≤ Q = 192259.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 192259.28 ≤ Q = 192259.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 192259.28 ≤ Q = 192259.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 192259.28 ≤ Q = 192259.28 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 12] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x41b319da
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x41b319da
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [2e-12, 1e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.364837e+13
Presolve removed 2600 rows and 1892 columns
Presolve time: 0.00s
Presolved: 493 rows, 497 columns, 1396 nonzeros
Found heuristic solution: objective 6754877.0545
Variable types: 337 continuous, 160 integer (160 binary)

Root relaxation: objective -1.512225e+05, 236 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -151222.48    0  122 6754877.05 -151222.48   102%     -    0s
H    0     0                    -117203.7582 -151222.48  29.0%     -    0s
H    0     0                    -117481.9169 -151222.48  28.7%     -    0s
H    0     0                    -118084.7234 -151222.48  28.1%     -    0s
     0     0 -134674.98    0   98 -118084.72 -134674.98  14.0%     -    0s
H    0     0                    -130441.5579 -134636.03  3.22%     -    0s
H    0     0                    -132805.4145 -134636.03  1.38%     -    0s
     0     0 -133750.75    0   92 -132805.41 -133750.75  0.71%     -    0s
     0     0 -133580.75    0  102 -132805.41 -133580.75  0.58%     -    0s
     0     0 -133577.01    0  102 -132805.41 -133577.01  0.58%     -    0s
H    0     0                    -132810.2720 -133252.72  0.33%     -    0s
     0     0 -133252.72    0   48 -132810.27 -133252.72  0.33%     -    0s
     0     0 -133125.50    0   56 -132810.27 -133125.50  0.24%     -    0s
     0     0 -133123.43    0   50 -132810.27 -133123.43  0.24%     -    0s
     0     0 -133093.86    0   40 -132810.27 -133093.86  0.21%     -    0s
     0     0 -133092.73    0   32 -132810.27 -133092.73  0.21%     -    0s
     0     0 -132878.03    0   29 -132810.27 -132878.03  0.05%     -    0s
     0     0 -132878.03    0   13 -132810.27 -132878.03  0.05%     -    0s
     0     0          -    0      -132810.27 -132822.75  0.01%     -    0s

Cutting planes:
  Gomory: 5
  Implied bound: 1
  MIR: 8
  Flow cover: 6
  RLT: 1
  Relax-and-lift: 3

Explored 1 nodes (838 simplex iterations) in 0.08 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 8: -132810 -132805 -130442 ... 1.36484e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.328102720032e+05, best bound -1.328227451367e+05, gap 0.0094%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 179889.97
  Scenario: 41 demand increases, 19 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -132810.27
  [DEBUG]   S×d_nominal = 312700.24
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 312700.24 + -132810.27 = 179889.97
  [DEBUG]   Current θ from Master = 192259.28
  [DEBUG]   ⚠️  Z_SP ≤ θ by 12369.32 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 32687.83
  Lower Bound (LB) = 45250.14
  Gap (UB-LB) = -193.0012, Absolute Gap = 193.0012, Relative Gap = -0.004283
  *** CONVERGED (small negative gap: -193.00 within tolerance ε=200) ***
  Note: Negative gap likely due to numerical precision or solver tolerance

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 12
Total Time: 28494.30s
Converged: True
Final Lower Bound: 45250.1427
Final Upper Bound: 45057.1414
Final Gap: -193.001240
Number of Critical Scenarios: 12
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [2] (1/3)
Product 1 Plants: [2] (1/3)
Product 2 Plants: [1] (1/3)
Total Plant Openings: 3
DCs Opened: [0, 5, 7, 8] (4/10)
Active Routes (Plant→DC): 12
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 4 customers  Mode 1: 21 customers  Mode 2: 25 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 12
Start Time: 2026-01-06 02:44:46
End Time: 2026-01-06 10:39:40
Total Time: 28494.30s
Optimal Value: 45250.14
Lower Bound: 45250.14
Upper Bound: 45057.14
Gap: -193.001240
Plants Opened: {0: [2], 1: [2], 2: [1]} (3 plants)
DCs Opened: [0, 5, 7, 8] (4 DCs)
================================================================================

Results saved to: result/DH_single_full_seed47_HD_gamma20_20260106_103940.csv

Total Execution Time: 28494.41 seconds
End Time: 2026-01-06 10:39:40

All tasks completed successfully!

