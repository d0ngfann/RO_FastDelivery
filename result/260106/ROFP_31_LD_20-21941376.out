
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 31
DI Scenario: LD
Start Time: 2026-01-05 04:55:18
================================================================================
Loading data from data/DH_data_full_seed31.pkl...

Applying DI scenario: LD
DI values:
  Product 0: ['1.000', '1.027', '1.054'] (k=0.065)
  Product 1: ['1.000', '1.079', '1.163'] (k=0.187)
  Product 2: ['1.000', '1.119', '1.251'] (k=0.276)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=953, max=1707
  DC capacity (MC): min=537, max=893

Demand Structure (s_rk matrix):
  Total customer-product pairs: 83/150 (44.7% sparse)
  Average products per customer: 1.66

Demand (only non-zero entries):
  Nominal (μ): min=8.03, max=34.96, count=83
  Deviation (μ̂): min=4.06, max=9.95

Costs:
  Plant fixed cost: min=5416, max=9026
  DC fixed cost: min=3584, max=5357
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.311', '1.718'] (k=0.667)
    Product 1: ['1.000', '1.357', '1.840'] (k=0.752)
    Product 2: ['1.000', '1.369', '1.875'] (k=0.775)
  MD:
    Product 0: ['1.000', '1.211', '1.467'] (k=0.473)
    Product 1: ['1.000', '1.270', '1.614'] (k=0.590)
    Product 2: ['1.000', '1.303', '1.698'] (k=0.653)
  LD:
    Product 0: ['1.000', '1.027', '1.054'] (k=0.065)
    Product 1: ['1.000', '1.079', '1.163'] (k=0.187)
    Product 2: ['1.000', '1.119', '1.251'] (k=0.276)
  Mixed:
    Product 0: ['1.000', '1.311', '1.718'] (k=0.667)
    Product 1: ['1.000', '1.270', '1.614'] (k=0.590)
    Product 2: ['1.000', '1.119', '1.251'] (k=0.276)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48759 nonzeros
Model fingerprint: 0xcddb1cf5
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11748 rows and 2748 columns
Presolve time: 0.06s
Presolved: 4925 rows, 5752 columns, 34182 nonzeros
Variable types: 3493 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -323337.3007
Found heuristic solution: objective -197738.4924

Root relaxation: objective 7.152200e+04, 4685 iterations, 0.16 seconds (0.28 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 71522.0020    0  589 -197738.49 71522.0020   136%     -    0s
H    0     0                    -194959.3856 71522.0020   137%     -    0s
     0     0 69761.6998    0  754 -194959.39 69761.6998   136%     -    0s
H    0     0                    -173694.5833 69761.2367   140%     -    0s
     0     0 69734.2056    0  864 -173694.58 69734.2056   140%     -    0s
     0     0 69733.7571    0  867 -173694.58 69733.7571   140%     -    0s
     0     0 69733.6543    0  868 -173694.58 69733.6543   140%     -    0s
     0     0 67421.7052    0 1018 -173694.58 67421.7052   139%     -    1s
     0     0 66630.8382    0 1107 -173694.58 66630.8382   138%     -    1s
     0     0 66630.8382    0 1118 -173694.58 66630.8382   138%     -    1s
     0     0 66630.8382    0 1117 -173694.58 66630.8382   138%     -    1s
H    0     0                    -153576.3518 64390.4918   142%     -    3s
H    0     0                    -147546.9223 64390.4918   144%     -    3s
H    0     0                    -120637.9686 64390.4918   153%     -    3s
H    0     0                    -112468.1628 64262.1495   157%     -    3s
H    0     0                    -112142.7815 64262.1495   157%     -    3s
H    0     0                    -13817.77094 64262.1495   565%     -    3s
     0     0 64262.1495    0 1292 -13817.771 64262.1495   565%     -    3s
     0     0 63666.1080    0 1183 -13817.771 63666.1080   561%     -    3s
     0     0 63664.7089    0 1289 -13817.771 63664.7089   561%     -    3s
     0     0 62676.0397    0 1305 -13817.771 62676.0397   554%     -    3s
     0     0 62671.2213    0 1309 -13817.771 62671.2213   554%     -    3s
     0     0 62671.2213    0 1304 -13817.771 62671.2213   554%     -    3s
H    0     0                    -13661.97128 60015.0113   539%     -    5s
H    0     0                    -13491.78379 60015.0113   545%     -    5s
H    0     0                    -13010.07101 60015.0113   561%     -    5s
H    0     0                    -12903.42872 60015.0113   565%     -    5s
H    0     0                    -12599.32371 60015.0113   576%     -    5s
H    0     0                    -7751.858661 60015.0113   874%     -    5s
H    0     0                    -7744.071734 60015.0113   875%     -    5s
H    0     0                    -3217.690278 60015.0113  1965%     -    5s
H    0     0                    -3196.029497 60015.0113  1978%     -    5s
H    0     0                    -1755.404810 60015.0113  3519%     -    5s
H    0     0                    -677.4944989 60015.0113  8958%     -    5s
H    0     0                     299.5336883 60015.0113      -     -    5s
H    0     0                     862.1367824 60015.0113  6861%     -    5s
H    0     0                     883.6395360 60015.0113  6692%     -    5s
H    0     0                     949.4131998 60015.0113  6221%     -    5s
     0     0 60015.0113    0 1366  949.41320 60015.0113  6221%     -    5s
     0     0 60015.0113    0 1366  949.41320 60015.0113  6221%     -    5s
     0     2 60015.0113    0 1366  949.41320 60015.0113  6221%     -    6s
    31    64 54590.8393    5  923  949.41320 56700.6589  5872%  2749   10s
H   95   246                    1116.3100695 54627.8881  4794%  1785   11s
H  100   246                    1187.0273478 54627.8881  4502%  1725   11s
H  373   384                    4001.9861280 54627.8881  1265%   762   12s
H  388   470                    11236.460148 54627.8881   386%   756   12s
H  426   470                    13364.749766 54627.8881   309%   724   12s
H  444   470                    13968.644442 54627.8881   291%   709   12s
H  509   531                    17406.406646 54627.8881   214%   666   13s
H  636   670                    18963.187072 54473.2529   187%   613   14s
H  640   670                    19298.879547 54473.2529   182%   614   14s
H  641   670                    21337.010662 54473.2529   155%   614   14s
H  647   670                    22033.667563 54473.2529   147%   614   14s
H  817   794                    22138.020256 54473.2529   146%   553   14s
H  818   794                    22269.746935 54473.2529   145%   553   14s
H  830   794                    22703.490420 54473.2529   140%   548   14s
   859   878 28838.0018   17  426 22703.4904 54473.2529   140%   542   15s
H 1062  1027                    22849.181825 54337.5711   138%   500   16s
H 1090  1027                    23090.764837 54337.5711   135%   493   16s
H 1738  1564                    23156.090618 53125.3016   129%   434   18s
H 1743  1564                    23236.251929 53125.3016   129%   434   18s
H 1748  1564                    23236.456242 53125.3016   129%   434   18s
H 1784  1564                    23301.782023 53125.3016   128%   431   18s
H 1921  1613                    23340.786188 53125.3016   128%   427   19s
  2108  1886 25228.1693   43  243 23340.7862 53125.3016   128%   416   20s
H 2541  2253                    23364.921468 53125.3016   127%   384   20s
H 3801  2902                    23594.745850 50508.9939   114%   353   23s
  4201  3052 39967.4738   21 1366 23594.7458 50508.9939   114%   355   41s
  4215  3061 24965.9986   15  482 23594.7458 33656.5652  42.6%   354   45s
  4316  3123 24358.1976   21  516 23594.7458 29572.0753  25.3%   361   50s
H 4472  2941                    24583.826640 29147.8423  18.6%   356   50s
H 4474  2794                    24698.768923 29147.8423  18.0%   356   50s
H 4484  2652                    25205.951886 29147.8423  15.6%   356   50s
H 4510  2511                    25462.826832 29147.8423  14.5%   354   50s
H 4620  2292                    25466.248636 29069.8943  14.2%   349   50s
H 4629  2170                    25492.510881 29069.8943  14.0%   348   50s
H 4630  2057                    25705.305846 29069.8943  13.1%   348   50s

Cutting planes:
  Implied bound: 2
  Projected implied bound: 53
  MIR: 180
  Flow cover: 350
  Zero half: 5
  RLT: 28
  Relax-and-lift: 67

Explored 4878 nodes (1657257 simplex iterations) in 51.83 seconds (113.89 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 25705.3 25492.5 25466.2 ... 23340.8

Optimal solution found (tolerance 1.00e-04)
Best objective 2.570530584606e+04, best bound 2.570530584606e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 51.83s
  Master Objective (UB) = 25705.31, θ = 153321.67
  Upper Bound (UB) = 25705.31

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 153321.67
  [DEBUG]   ✓ Scenario 0: θ = 153321.67 ≤ Q = 153321.67 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x6101cd33
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x6101cd33
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.314856e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 7056559.4451
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.189826e+05, 244 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -118982.65    0  122 7056559.45 -118982.65   102%     -    0s
H    0     0                    -83789.88213 -118982.65  42.0%     -    0s
H    0     0                    -85181.96356 -118982.65  39.7%     -    0s
H    0     0                    -87430.55877 -87430.559  0.00%     -    0s
     0     0          -    0      -87430.559 -87430.559  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 205

Explored 1 nodes (379 simplex iterations) in 0.01 seconds (0.02 work units)
Thread count was 32 (of 64 available processors)

Solution count 5: -87430.6 -85182 -83789.9 ... 1.31486e+13
No other solutions better than -87430.6

Optimal solution found (tolerance 1.00e-04)
Best objective -8.743055877476e+04, best bound -8.743055877476e+04, gap 0.0000%
  Subproblem solved in 0.03s
  Worst-case operational profit (Z_SP) = 117605.11
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -87430.56
  [DEBUG]   S×d_nominal = 205035.67
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 205035.67 + -87430.56 = 117605.11
  [DEBUG]   Current θ from Master = 153321.67
  [DEBUG]   ⚠️  Z_SP ≤ θ by 35716.56 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -10011.25
  Lower Bound (LB) = -10011.25
  Gap (UB-LB) = 35716.5604, Absolute Gap = 35716.5604, Relative Gap = 1.389463
  Not converged yet (gap = 35716.56 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 91999 nonzeros
Model fingerprint: 0x5f2788cd
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -10011.3 (0.01s)
MIP start from previous solve produced solution with objective -10011.3 (0.01s)
Loaded MIP start from previous solve with objective -10011.3

Presolve removed 13595 rows and 5514 columns
Presolve time: 0.31s
Presolved: 18368 rows, 9226 columns, 101748 nonzeros
Variable types: 6967 continuous, 2259 integer (2259 binary)

Root relaxation: objective 2.478529e+04, 8472 iterations, 1.01 seconds (2.12 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 24785.2935    0  293 -10011.255 24785.2935   348%     -    1s
H    0     0                    -9355.955667 24785.2935   365%     -    1s
H    0     0                    -9009.300402 24785.2935   375%     -    1s
H    0     0                    -8961.557765 24785.2935   377%     -    1s
     0     0 18977.9183    0  559 -8961.5578 18977.9183   312%     -    2s
H    0     0                    -8938.998102 18975.7704   312%     -    3s
H    0     0                    -8872.930462 18975.7704   314%     -    3s
     0     0 18918.4751    0  564 -8872.9305 18918.4751   313%     -    3s
     0     0 18918.4751    0  563 -8872.9305 18918.4751   313%     -    3s
     0     0 13092.0099    0  647 -8872.9305 13092.0099   248%     -    5s
H    0     0                    -8872.676205 13081.6085   247%     -    5s
H    0     0                    -8866.677565 13081.6085   248%     -    5s
     0     0 12782.7356    0  726 -8866.6776 12782.7356   244%     -    5s
     0     0 12753.5486    0  743 -8866.6776 12753.5486   244%     -    5s
     0     0 12753.4439    0  741 -8866.6776 12753.4439   244%     -    5s
     0     0 8022.11403    0  654 -8866.6776 8022.11403   190%     -    9s
H    0     0                    -8822.975414 8020.36446   191%     -    9s
     0     0 7487.17311    0  831 -8822.9754 7487.17311   185%     -   10s
     0     0 7392.68717    0  781 -8822.9754 7392.68717   184%     -   10s
     0     0 7380.36580    0  723 -8822.9754 7380.36580   184%     -   10s
     0     0 7374.63526    0  777 -8822.9754 7374.63526   184%     -   10s
     0     0 7374.22450    0  778 -8822.9754 7374.22450   184%     -   10s
H    0     0                    -8821.165490 7374.22450   184%     -   12s
     0     0 5297.56224    0  753 -8821.1655 5297.56224   160%     -   14s
     0     0 5032.78292    0  842 -8821.1655 5032.78292   157%     -   15s
     0     0 4862.26472    0  859 -8821.1655 4862.26472   155%     -   16s
     0     0 4833.20523    0  865 -8821.1655 4833.20523   155%     -   16s
     0     0 4803.35091    0  859 -8821.1655 4803.35091   154%     -   16s
     0     0 4797.28540    0  864 -8821.1655 4797.28540   154%     -   16s
     0     0 4088.23054    0  582 -8821.1655 4088.23054   146%     -   18s
     0     0 3919.00280    0  689 -8821.1655 3919.00280   144%     -   19s
     0     0 3887.94509    0  680 -8821.1655 3887.94509   144%     -   19s
     0     0 3883.07340    0  604 -8821.1655 3883.07340   144%     -   20s
     0     0 3673.33191    0  693 -8821.1655 3673.33191   142%     -   21s
     0     0 3611.26089    0  668 -8821.1655 3611.26089   141%     -   22s
     0     0 3588.54287    0  681 -8821.1655 3588.54287   141%     -   22s
     0     0 3586.48900    0  679 -8821.1655 3586.48900   141%     -   22s
     0     0 3470.26038    0  745 -8821.1655 3470.26038   139%     -   23s
     0     0 3424.16938    0  602 -8821.1655 3424.16938   139%     -   24s
     0     0 3409.65044    0  741 -8821.1655 3409.65044   139%     -   24s
     0     0 3406.65631    0  600 -8821.1655 3406.65631   139%     -   24s
     0     0 3311.42494    0  728 -8821.1655 3311.42494   138%     -   25s
     0     0 3286.47142    0  841 -8821.1655 3286.47142   137%     -   26s
     0     0 3282.18732    0  838 -8821.1655 3282.18732   137%     -   26s
     0     0 3207.01358    0  673 -8821.1655 3207.01358   136%     -   28s
     0     0 3194.77579    0  667 -8821.1655 3194.77579   136%     -   28s
     0     0 3189.62523    0  664 -8821.1655 3189.62523   136%     -   28s
     0     0 3172.11901    0  573 -8821.1655 3172.11901   136%     -   29s
     0     0 3164.71881    0  585 -8821.1655 3164.71881   136%     -   29s
     0     0 3152.77121    0  584 -8821.1655 3152.77121   136%     -   30s
     0     0 3152.66845    0  584 -8821.1655 3152.66845   136%     -   30s
     0     2 3151.90667    0  584 -8821.1655 3151.90667   136%     -   34s
     1     4 2398.27232    1  737 -8821.1655 3151.90667   136%  2895   36s
    31    64  -62.77052    5  564 -8821.1655 2563.88870   129%  1410   40s
   204   230 -4642.8872    9  434 -8821.1655 2452.08797   128%   825   45s
H  446   322                    -8680.404374 1125.92627   113%   608   47s
H  459   322                    -8607.946585 1125.92627   113%   597   47s
H  511   338                    -8579.390820 1125.92627   113%   587   48s
   624   410 -4468.8855    9  256 -8579.3908  513.11687   106%   564   50s
H  920   511                    -8455.323035  203.98681   102%   501   52s
  1207   694 -7269.0030   11  221 -8455.3230 -1323.1787  84.4%   446   55s
H 1546   762                    -8446.230035 -1450.1798  82.8%   393   56s
H 1551   762                    -8440.999255 -1450.1798  82.8%   393   56s
  1902   860 -5711.7748   13  299 -8440.9993 -2003.6202  76.3%   369   60s
H 2624   928                    -8439.474033 -3104.1975  63.2%   331   63s
H 2626   928                    -8437.121116 -3104.1975  63.2%   331   63s
H 2635   928                    -8436.302096 -3104.1975  63.2%   331   63s
H 2637   928                    -8415.606694 -3104.1975  63.1%   331   63s
  3176  1110     cutoff   39      -8415.6067 -3104.1975  63.1%   307   65s
H 3941  1267                    -8385.077005 -4857.4880  42.1%   290   69s
H 3963  1267                    -8379.598420 -4857.4880  42.0%   289   69s
H 4049  1267                    -8369.332728 -4957.4242  40.8%   288   69s
H 4063  1267                    -8340.493998 -4957.4242  40.6%   287   69s
H 4084  1308                    -8310.624161 -4957.4242  40.3%   286   70s
H 4150  1308                    -8298.750354 -5009.7997  39.6%   284   70s
H 5843  1925                    -8290.246127 -5522.5113  33.4%   233   72s
  5923  1885 -7161.8130   16  584 -8290.2461 -5522.5113  33.4%   231   84s
  5925  1886 -6633.6539   11  126 -8290.2461 -5522.5113  33.4%   231   86s
  5927  1888 -6689.0026   25  692 -8290.2461 -5522.5113  33.4%   231   90s
  5935  1893 -8075.7856   37  657 -8290.2461 -5522.5113  33.4%   231   96s
  5938  1895 -6251.3470   21  585 -8290.2461 -5522.5113  33.4%   231  100s
  5939  1896 -7544.9562   25  585 -8290.2461 -5522.5113  33.4%   231  105s
  5954  1923 -5522.5113   19  495 -8290.2461 -5522.5113  33.4%   238  110s
H 5982  1847                    -8286.535938 -5522.5113  33.4%   243  111s
H 5990  1755                    -8275.436101 -5522.5113  33.3%   244  111s
H 5995  1667                    -8261.248813 -5522.5113  33.2%   244  111s
  6067  1730 -5522.5113   23  349 -8261.2488 -5522.5113  33.2%   252  115s
H 6075  1646                    -8247.660132 -5522.5113  33.0%   253  115s
H 6081  1566                    -8192.383595 -5522.5113  32.6%   253  115s
H 6290  1484                    -8191.185213 -5522.5113  32.6%   264  119s
  6361  1476     cutoff   27      -8191.1852 -5522.5113  32.6%   268  120s
H 6640  1330                    -8188.189918 -5522.5113  32.6%   278  123s
  6733  1305 -5522.5113   25  408 -8188.1899 -5522.5113  32.6%   280  125s
H 6736  1238                    -8187.076458 -5522.5113  32.5%   280  125s
H 6739  1174                    -8163.190999 -5522.5113  32.3%   280  125s
H 6878  1060                    -8159.131536 -5522.5113  32.3%   284  127s
H 6881  1002                    -8157.723418 -5522.5113  32.3%   284  127s
H 6897   942                    -8153.187521 -5522.5113  32.3%   285  127s
  7047   905 -5553.8438   28  353 -8153.1875 -5522.5113  32.3%   289  130s
  7444   658 -5522.5113   24  415 -8153.1875 -5522.5113  32.3%   298  135s
  8031   329 -8140.8942   45   12 -8153.1875 -8116.6583  0.45%   293  140s
* 8046   272              64    -8148.273248 -8116.6583  0.39%   293  140s

Cutting planes:
  MIR: 252
  Flow cover: 495
  Zero half: 4
  RLT: 10
  Relax-and-lift: 36

Explored 8118 nodes (2404655 simplex iterations) in 140.53 seconds (333.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -8148.27 -8153.19 -8157.72 ... -8247.66
No other solutions better than -8148.27

Optimal solution found (tolerance 1.00e-04)
Best objective -8.148273248442e+03, best bound -8.148273248442e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 140.53s
  Master Objective (UB) = -8148.27, θ = 112933.08
  Upper Bound (UB) = -8148.27

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 112933.08
  [DEBUG]   ✓ Scenario 0: θ = 112933.08 ≤ Q = 112933.08 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 112933.08 ≤ Q = 112933.08 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x163374e9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xe9cc8b17
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.525041e+13
Presolve removed 2586 rows and 1880 columns
Presolve time: 0.00s
Presolved: 507 rows, 509 columns, 1429 nonzeros
Found heuristic solution: objective 8483359.2974
Variable types: 343 continuous, 166 integer (166 binary)

Root relaxation: objective -1.293438e+05, 260 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -129343.83    0  127 8483359.30 -129343.83   102%     -    0s
H    0     0                    -89757.43731 -129343.83  44.1%     -    0s
H    0     0                    -91050.36416 -129343.83  42.1%     -    0s
H    0     0                    -105372.7920 -129343.83  22.7%     -    0s
H    0     0                    -110445.5097 -114207.73  3.41%     -    0s
H    0     0                    -111512.2467 -114207.73  2.42%     -    0s
     0     0 -114207.73    0   54 -111512.25 -114207.73  2.42%     -    0s
H    0     0                    -112550.5646 -114178.68  1.45%     -    0s
H    0     0                    -112884.2901 -114178.68  1.15%     -    0s
H    0     0                    -113188.1649 -113949.56  0.67%     -    0s
     0     0 -113949.56    0   52 -113188.16 -113949.56  0.67%     -    0s
     0     0 -113935.72    0   52 -113188.16 -113935.72  0.66%     -    0s
     0     0 -113458.98    0   26 -113188.16 -113458.98  0.24%     -    0s
     0     0 -113443.43    0   24 -113188.16 -113443.43  0.23%     -    0s
     0     0 -113379.81    0   25 -113188.16 -113379.81  0.17%     -    0s
     0     0 -113373.68    0   23 -113188.16 -113373.68  0.16%     -    0s
     0     0 -113366.39    0   24 -113188.16 -113366.39  0.16%     -    0s
     0     0 -113291.75    0   10 -113188.16 -113291.75  0.09%     -    0s
     0     0 -113291.75    0   15 -113188.16 -113291.75  0.09%     -    0s
     0     0 -113231.86    0    9 -113188.16 -113231.86  0.04%     -    0s
H    0     0                    -113194.6865 -113231.86  0.03%     -    0s
     0     0 -113230.48    0    5 -113194.69 -113230.48  0.03%     -    0s
H    0     0                    -113225.3765 -113227.56  0.00%     -    0s
     0     0 -113227.56    0    4 -113225.38 -113227.56  0.00%     -    0s

Cutting planes:
  Gomory: 6
  Implied bound: 1
  MIR: 7
  Flow cover: 9

Explored 1 nodes (676 simplex iterations) in 0.10 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -113225 -113195 -113188 ... -91050.4

Optimal solution found (tolerance 1.00e-04)
Best objective -1.132253765018e+05, best bound -1.132275586282e+05, gap 0.0019%
  Subproblem solved in 0.12s
  Worst-case operational profit (Z_SP) = 88041.04
  Scenario: 25 demand increases, 35 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -113225.38
  [DEBUG]   S×d_nominal = 201266.42
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 201266.42 + -113225.38 = 88041.04
  [DEBUG]   Current θ from Master = 112933.08
  [DEBUG]   ⚠️  Z_SP ≤ θ by 24892.04 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -33040.31
  Lower Bound (LB) = -10011.25
  Gap (UB-LB) = 1862.9813, Absolute Gap = 1862.9813, Relative Gap = 0.228635
  Not converged yet (gap = 1862.98 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 25 increases, 35 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135239 nonzeros
Model fingerprint: 0xc2c1bbf9
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -33040.3 (0.02s)
Loaded MIP start from previous solve with objective -33040.3

Presolve removed 20361 rows and 8271 columns
Presolve time: 0.41s
Presolved: 26892 rows, 12709 columns, 165584 nonzeros
Variable types: 10450 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   36679    1.0493406e+04   0.000000e+00   6.770904e+06      5s
Concurrent spin time: 0.00s

Solved with dual simplex

Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   20516    1.2976113e+04   0.000000e+00   0.000000e+00      7s

Root relaxation: objective 1.297611e+04, 20516 iterations, 6.92 seconds (12.41 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 12976.1131    0  126 -33040.310 12976.1131   139%     -    7s
H    0     0                    -32187.98314 12976.1131   140%     -    7s
H    0     0                    -32166.11945 12976.1131   140%     -    7s
H    0     0                    -14202.66830 12976.1131   191%     -    8s
H    0     0                    -13347.62744 12976.1131   197%     -    8s
H    0     0                    -13289.81215 9550.42870   172%     -   10s
H    0     0                    -13256.32151 9550.42870   172%     -   10s
     0     0 9550.42870    0  430 -13256.322 9550.42870   172%     -   10s
H    0     0                    -11269.80023 9550.03935   185%     -   10s
H    0     0                    -11232.92988 9550.03935   185%     -   10s
H    0     0                    -11027.56861 9550.03935   187%     -   10s
H    0     0                    -10946.38683 9550.03935   187%     -   10s
     0     0 9320.13685    0  421 -10946.387 9320.13685   185%     -   10s
     0     0 9024.90312    0  424 -10946.387 9024.90312   182%     -   11s
     0     0 9024.75950    0  424 -10946.387 9024.75950   182%     -   11s
     0     0 6937.57242    0  528 -10946.387 6937.57242   163%     -   15s
H    0     0                    -9908.210027 6937.57242   170%     -   15s
H    0     0                    -9900.131876 6937.57242   170%     -   15s
     0     0 6331.20758    0  622 -9900.1319 6331.20758   164%     -   17s
     0     0 6268.15256    0  630 -9900.1319 6268.15256   163%     -   18s
     0     0 6246.66524    0  631 -9900.1319 6246.66524   163%     -   18s
     0     0 6233.71441    0  635 -9900.1319 6233.71441   163%     -   18s
     0     0 6232.92513    0  637 -9900.1319 6232.92513   163%     -   18s
     0     0 6232.78313    0  634 -9900.1319 6232.78313   163%     -   18s
H    0     0                    -9619.061144 4859.82242   151%     -   23s
H    0     0                    -9246.712140 4859.82242   153%     -   23s
H    0     0                    -9105.868760 4859.82242   153%     -   23s
H    0     0                    -8901.782090 4859.82242   155%     -   23s
     0     0 4859.82242    0  524 -8901.7821 4859.82242   155%     -   23s
H    0     0                    -8863.442485 4859.41459   155%     -   23s
     0     0 4529.88394    0  519 -8863.4425 4529.88394   151%     -   24s
     0     0 4428.42528    0  527 -8863.4425 4428.42528   150%     -   25s
     0     0 4406.49054    0  535 -8863.4425 4406.49054   150%     -   25s
     0     0 4402.59887    0  538 -8863.4425 4402.59887   150%     -   25s
     0     0 4398.12712    0  540 -8863.4425 4398.12712   150%     -   25s
     0     0 4398.06109    0  542 -8863.4425 4398.06109   150%     -   25s
H    0     0                    -8829.228311 4398.06109   150%     -   28s
     0     0 3891.17947    0  549 -8829.2283 3891.17947   144%     -   29s
     0     0 3741.24454    0  620 -8829.2283 3741.24454   142%     -   31s
     0     0 3703.50292    0  555 -8829.2283 3703.50292   142%     -   31s
     0     0 3696.35714    0  562 -8829.2283 3696.35714   142%     -   32s
     0     0 3693.75721    0  562 -8829.2283 3693.75721   142%     -   32s
     0     0 3692.60892    0  564 -8829.2283 3692.60892   142%     -   32s
     0     0 3592.76044    0  611 -8829.2283 3592.76044   141%     -   33s
     0     0 3560.59121    0  618 -8829.2283 3560.59121   140%     -   33s
     0     0 3546.84892    0  622 -8829.2283 3546.84892   140%     -   34s
     0     0 3543.59495    0  628 -8829.2283 3543.59495   140%     -   34s
     0     0 3539.32630    0  621 -8829.2283 3539.32630   140%     -   34s
     0     0 3535.33955    0  621 -8829.2283 3535.33955   140%     -   34s
     0     0 3534.75650    0  629 -8829.2283 3534.75650   140%     -   34s
     0     0 3466.53546    0  561 -8829.2283 3466.53546   139%     -   35s
H    0     0                    -8827.418387 3466.07383   139%     -   36s
     0     0 3442.21819    0  572 -8827.4184 3442.21819   139%     -   36s
     0     0 3433.35150    0  582 -8827.4184 3433.35150   139%     -   37s
     0     0 3429.57518    0  586 -8827.4184 3429.57518   139%     -   37s
     0     0 3429.33827    0  587 -8827.4184 3429.33827   139%     -   37s
     0     0 3358.12697    0  563 -8827.4184 3358.12697   138%     -   38s
     0     0 3349.99308    0  573 -8827.4184 3349.99308   138%     -   38s
     0     0 3346.14534    0  575 -8827.4184 3346.14534   138%     -   38s
     0     0 3345.13160    0  573 -8827.4184 3345.13160   138%     -   38s
     0     0 3328.24160    0  581 -8827.4184 3328.24160   138%     -   39s
H    0     0                    -8821.165490 3327.61601   138%     -   39s
     0     0 3314.98232    0  654 -8821.1655 3314.98232   138%     -   40s
     0     0 3310.64280    0  582 -8821.1655 3310.64280   138%     -   40s
     0     0 3309.65462    0  586 -8821.1655 3309.65462   138%     -   40s
     0     0 3289.61028    0  580 -8821.1655 3289.61028   137%     -   41s
     0     0 3285.43421    0  589 -8821.1655 3285.43421   137%     -   41s
     0     0 3283.81052    0  587 -8821.1655 3283.81052   137%     -   41s
     0     0 3282.96419    0  591 -8821.1655 3282.96419   137%     -   41s
     0     0 3272.72430    0  584 -8821.1655 3272.72430   137%     -   42s
     0     0 3269.30926    0  587 -8821.1655 3269.30926   137%     -   43s
     0     0 3267.49672    0  595 -8821.1655 3267.49672   137%     -   43s
     0     0 3266.81689    0  590 -8821.1655 3266.81689   137%     -   43s
     0     0 3263.27581    0  597 -8821.1655 3263.27581   137%     -   44s
     0     0 3262.51423    0  607 -8821.1655 3262.51423   137%     -   44s
     0     0 3261.06777    0  609 -8821.1655 3261.06777   137%     -   44s
     0     0 3260.56922    0  609 -8821.1655 3260.56922   137%     -   45s
     0     2 3260.56922    0  609 -8821.1655 3260.56922   137%     -   54s
     1     4 2973.74667    1  664 -8821.1655 3257.76986   137%  1209   55s
    15    32 2667.59761    4  637 -8821.1655 2737.93047   131%  1453   60s
    63    96 2257.50120    6  695 -8821.1655 2510.22485   128%  1660   65s
   230   282  679.37375    8  705 -8821.1655 2510.22485   128%  1067   72s
   303   297 1749.78364    9  754 -8821.1655 2256.87971   126%  1030   75s
   422   373 1668.98831   10  759 -8821.1655 2256.87971   126%  1034   81s
   520   468  259.71816   11  668 -8821.1655 2256.87971   126%  1079   86s
   643   580 -1418.5495   13  619 -8821.1655 1878.35209   121%  1108   91s
   742   658 -1772.0921   14  605 -8821.1655 1878.35209   121%  1081   95s
   828   727 -3372.7138   15  594 -8821.1655 1878.35209   121%  1058  101s
   957   838 -4294.8435   18  520 -8821.1655 1878.35209   121%  1010  106s
  1103  1011 -5802.4862   20  353 -8821.1655 1532.62939   117%   982  110s
  1356  1196 -6065.4430   22  320 -8821.1655 1532.62939   117%   890  115s
  1632  1341 -455.38184   10  457 -8821.1655 1417.36424   116%   828  121s
  1800  1385 -3342.4856   12  309 -8821.1655 1417.36424   116%   805  126s
  1997  1489 -7783.7750   14  173 -8821.1655 1334.50764   115%   788  131s
  2241  1615 -947.61191   12  510 -8821.1655 1201.92158   114%   770  137s
  2363  1698 -3970.4690   14  451 -8821.1655 1024.68237   112%   772  141s
  2654  1869 -8687.7858   17  395 -8821.1655 1024.68237   112%   758  147s
  2799  1989 -8695.4459   18  396 -8821.1655  981.22571   111%   758  151s
  2991  2028 -975.00262   11  326 -8821.1655  827.79150   109%   747  156s
  3292  2306     cutoff   14      -8821.1655  827.79150   109%   730  163s
  3540  2431 -1717.3813   12  212 -8821.1655  827.79150   109%   716  166s
  4021  2575 -7986.3403   20  379 -8821.1655  678.54930   108%   699  171s
  4208  2665 -5400.3585   26  609 -8821.1655  660.00005   107%   697  207s
  4210  2666 -3991.0872   16  126 -8821.1655  660.00005   107%   697  215s
  4211  2667 -1220.8410   13  533 -8821.1655  660.00005   107%   697  220s
  4213  2668 -1002.0256   11  565 -8821.1655  660.00005   107%   697  225s
  4219  2672 -5121.4141   32  601 -8821.1655  660.00005   107%   696  230s
  4225  2676 -7900.3885   32  668 -8821.1655  660.00005   107%   695  235s
  4229  2679 -3293.7865   15  664 -8821.1655  660.00005   107%   694  240s
  4233  2682 -5777.6613   27  578 -8821.1655  660.00005   107%   693  246s
  4236  2684 -776.92194    8  675 -8821.1655  660.00005   107%   693  257s
  4237  2684 -1351.0581   10  675 -8821.1655  660.00005   107%   693  262s
  4238  2688  660.00005   14  378 -8821.1655  660.00005   107%   706  267s
  4240  2691  660.00005   15  552 -8821.1655  660.00005   107%   706  271s
  4244  2698 -976.96338   16  541 -8821.1655  660.00005   107%   707  276s
  4252  2711 -1423.7753   17  484 -8821.1655  660.00005   107%   710  282s
  4268  2731 -6175.3858   18  322 -8821.1655  403.94970   105%   726  286s
  4300  2748 -7901.8242   19  527 -8821.1655  218.43247   102%   734  290s
  4373  2790     cutoff   21      -8821.1655 -494.02966  94.4%   750  297s
  4442  2785 -871.50673   21  497 -8821.1655 -494.02966  94.4%   755  301s
  4525  2787 -1557.2398   22  458 -8821.1655 -494.02966  94.4%   761  305s
  4673  2800     cutoff   25      -8821.1655 -758.86447  91.4%   770  311s
  4832  2807 -3218.7752   29  200 -8821.1655 -871.86954  90.1%   770  316s
  5004  2801 -4374.7586   36  137 -8821.1655 -871.86954  90.1%   768  323s
  5075  2800 -4925.7583   39  170 -8821.1655 -1032.4059  88.3%   771  325s
  5152  2791     cutoff   42      -8821.1655 -1263.9232  85.7%   773  330s
  5310  2796     cutoff   25      -8821.1655 -1421.3595  83.9%   777  336s
  5440  2792 -3481.8466   25  370 -8821.1655 -1429.4501  83.8%   778  342s
  5488  2793 -3820.4325   26  350 -8821.1655 -1429.4501  83.8%   779  346s
  5597  2789 -4019.8863   28  263 -8821.1655 -1429.4501  83.8%   780  352s
  5656  2788 -4428.1252   29  300 -8821.1655 -1998.8541  77.3%   780  357s
  5719  2773 -4598.1639   30  305 -8821.1655 -2018.1453  77.1%   780  362s
  5784  2791 -5021.1809   31  284 -8821.1655 -2018.1453  77.1%   782  365s
  5966  2794 -3641.3245   28  458 -8821.1655 -2018.1453  77.1%   783  372s
  6089  2793 -4291.9551   30  369 -8821.1655 -2166.5709  75.4%   782  376s
  6235  2780     cutoff   33      -8821.1655 -2209.1621  75.0%   780  380s
  6522  2722 -4686.5404   25  558 -8821.1655 -2392.9629  72.9%   777  388s
  6667  2713 -5657.0229   27  192 -8821.1655 -2525.0543  71.4%   780  392s
  6813  2679     cutoff   31      -8821.1655 -2745.3317  68.9%   783  397s
  6960  2661     cutoff   24      -8821.1655 -2815.9033  68.1%   782  402s
  7128  2660     cutoff   35      -8821.1655 -3045.3296  65.5%   783  407s
  7324  2617     cutoff   32      -8821.1655 -3128.1552  64.5%   783  414s
  7504  2582 -6444.6283   30  329 -8821.1655 -3195.1391  63.8%   785  419s
  7738  2506 -7827.9964   28  505 -8821.1655 -3502.0306  60.3%   784  424s
  7962  2409 infeasible   28      -8821.1655 -3791.1392  57.0%   784  428s
  8155  2334 -8102.3451   31  502 -8821.1655 -3872.5480  56.1%   783  433s
  8405  2288     cutoff   35      -8821.1655 -4139.6430  53.1%   779  438s
  8665  2186 -5981.0502   29  335 -8821.1655 -4246.2063  51.9%   777  445s
  8979  2078 -6272.0660   33  266 -8821.1655 -4336.1381  50.8%   773  451s
  9280  1889     cutoff   24      -8821.1655 -4560.7041  48.3%   771  456s
H 9398  1715                    -8803.038214 -4560.7041  48.2%   770  456s
  9588  1549 -7991.7302   25  428 -8803.0382 -4560.7041  48.2%   765  462s
  9980  1315 -8510.8858   30  420 -8803.0382 -5109.4665  42.0%   761  468s
 10383  1031     cutoff   26      -8803.0382 -5441.6192  38.2%   756  474s
 11079   961     cutoff   27      -8803.0382 -6075.2659  31.0%   732  481s
*11293   761              82    -8802.848545 -6075.2659  31.0%   722  481s
*11810   692              86    -8799.505568 -6075.2659  31.0%   700  481s
 11981  1456 -8049.7179   26  447 -8799.5056 -6075.2659  31.0%   695  485s
*12051  1456             112    -8692.468949 -6075.2659  30.1%   691  485s
*12099  1456             112    -8682.504525 -6445.3242  25.8%   689  485s
*12108  1456             115    -8651.091397 -6445.3242  25.5%   688  485s
*12439  1456              90    -8622.646263 -6652.0760  22.9%   671  485s
*13510  2855              81    -8602.338610 -7161.2138  16.8%   624  487s
H13545  2855                    -8571.886493 -7161.2138  16.5%   622  487s
*13588  2855              84    -8511.813498 -7161.2138  15.9%   621  487s
H13603  2855                    -8503.414152 -7161.2138  15.8%   620  487s
*15424  3009              93    -8499.162621 -7904.5596  7.00%   549  488s
*15491  3009              90    -8492.280949 -7904.5596  6.92%   547  488s
H15610  3009                    -8487.595950 -7904.5596  6.87%   543  488s
H17645  2758                    -8485.444050 -8287.8084  2.33%   483  489s
H19157  2729                    -8483.086722 -8316.6382  1.96%   446  489s
*19784  2729              81    -8463.519996 -8322.0547  1.67%   433  489s
 20223  2635     cutoff   56      -8463.5200 -8348.3058  1.36%   424  490s
*20509  2613              90    -8448.987672 -8348.3058  1.19%   418  490s
*28176   413              75    -8446.304885 -8428.1272  0.22%   309  492s

Cutting planes:
  MIR: 446
  Mixing: 1
  Flow cover: 1559
  Zero half: 10
  RLT: 14
  Relax-and-lift: 67

Explored 29963 nodes (8799430 simplex iterations) in 492.46 seconds (1308.56 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -8446.3 -8448.99 -8463.52 ... -8511.81
No other solutions better than -8446.3

Optimal solution found (tolerance 1.00e-04)
Best objective -8.446304885021e+03, best bound -8.446304885021e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 492.47s
  Master Objective (UB) = -8446.30, θ = 108106.61
  Upper Bound (UB) = -8446.30

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 108106.61
  [DEBUG]   ✓ Scenario 0: θ = 108106.61 ≤ Q = 108106.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 108106.61 ≤ Q = 108106.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 108106.61 ≤ Q = 108106.61 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x6f9d6cab
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x6f9d6cab
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.448600e+13
Presolve removed 2586 rows and 1880 columns
Presolve time: 0.00s
Presolved: 507 rows, 509 columns, 1429 nonzeros
Found heuristic solution: objective 8129235.5346
Variable types: 343 continuous, 166 integer (166 binary)

Root relaxation: objective -1.195364e+05, 262 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -119536.44    0  131 8129235.53 -119536.44   101%     -    0s
H    0     0                    -83002.91883 -119536.44  44.0%     -    0s
H    0     0                    -84323.11710 -119536.44  41.8%     -    0s
H    0     0                    -96035.63427 -119536.44  24.5%     -    0s
H    0     0                    -96642.12338 -119536.44  23.7%     -    0s
H    0     0                    -98073.48415 -106794.53  8.89%     -    0s
H    0     0                    -99613.87940 -106794.53  7.21%     -    0s
H    0     0                    -103409.5635 -106794.53  3.27%     -    0s
     0     0 -106794.53    0  121 -103409.56 -106794.53  3.27%     -    0s
     0     0 -106676.08    0  123 -103409.56 -106676.08  3.16%     -    0s
     0     0 -106199.62    0  111 -103409.56 -106199.62  2.70%     -    0s
H    0     0                    -104557.9198 -106166.02  1.54%     -    0s
     0     0 -106166.02    0  112 -104557.92 -106166.02  1.54%     -    0s
     0     0 -106166.02    0  113 -104557.92 -106166.02  1.54%     -    0s
     0     0 -105812.56    0   93 -104557.92 -105812.56  1.20%     -    0s
     0     0 -105704.97    0   89 -104557.92 -105704.97  1.10%     -    0s
     0     0 -105677.89    0   91 -104557.92 -105677.89  1.07%     -    0s
     0     0 -105673.28    0   91 -104557.92 -105673.28  1.07%     -    0s
     0     0 -105494.87    0   92 -104557.92 -105494.87  0.90%     -    0s
     0     0 -105464.34    0   94 -104557.92 -105464.34  0.87%     -    0s
     0     0 -105463.95    0   94 -104557.92 -105463.95  0.87%     -    0s
     0     0 -105337.76    0   88 -104557.92 -105337.76  0.75%     -    0s
     0     0 -105318.69    0   91 -104557.92 -105318.69  0.73%     -    0s
     0     0 -105315.49    0   92 -104557.92 -105315.49  0.72%     -    0s
     0     0 -105271.74    0   87 -104557.92 -105271.74  0.68%     -    0s
     0     0 -105255.59    0   87 -104557.92 -105255.59  0.67%     -    0s
     0     2 -105255.59    0   87 -104557.92 -105255.59  0.67%     -    0s
H  515   182                    -104577.2184 -104897.60  0.31%   6.2    0s
* 1175   142              40    -104577.7301 -104794.10  0.21%   6.0    0s

Cutting planes:
  Gomory: 49
  Implied bound: 10
  MIR: 178
  Flow cover: 11
  RLT: 85
  BQP: 4

Explored 1668 nodes (10966 simplex iterations) in 0.16 seconds (0.13 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -104578 -104558 -103410 ... 8.12924e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.045777301328e+05, best bound -1.045782380656e+05, gap 0.0005%
  Subproblem solved in 0.18s
  Worst-case operational profit (Z_SP) = 86001.59
  Scenario: 60 demand increases, 0 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -104577.73
  [DEBUG]   S×d_nominal = 190579.32
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 190579.32 + -104577.73 = 86001.59
  [DEBUG]   Current θ from Master = 108106.61
  [DEBUG]   ⚠️  Z_SP ≤ θ by 22105.02 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -30551.32
  Lower Bound (LB) = -10011.25
  Gap (UB-LB) = 1564.9497, Absolute Gap = 1564.9497, Relative Gap = 0.185282
  Not converged yet (gap = 1564.95 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 60 increases, 0 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178479 nonzeros
Model fingerprint: 0x7a6e497f
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -30551.3 (0.03s)
Loaded MIP start from previous solve with objective -30551.3

Presolve removed 27128 rows and 11018 columns
Presolve time: 0.54s
Presolved: 35415 rows, 16202 columns, 218999 nonzeros
Variable types: 13943 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 35415 rows, 16202 columns, 218999 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   49663    7.3398740e+03   0.000000e+00   2.027360e+06      5s
Concurrent spin time: 0.32s

Solved with dual simplex

Root relaxation: objective 1.051664e+04, 28216 iterations, 9.35 seconds (18.94 work units)
Total elapsed time = 10.05s (DegenMoves)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 10516.6381    0  303 -30551.323 10516.6381   134%     -   10s
H    0     0                    -30494.85158 10516.6381   134%     -   10s
H    0     0                    -26818.36859 10516.6381   139%     -   11s
H    0     0                    -20160.17503 10516.6381   152%     -   11s
H    0     0                    -19408.94970 10516.6381   154%     -   11s
H    0     0                    -19407.54446 10516.6381   154%     -   11s
H    0     0                    -19404.79836 10516.6381   154%     -   11s
H    0     0                    -19402.29580 10516.6381   154%     -   11s
H    0     0                    -19401.96243 10516.6381   154%     -   11s
H    0     0                    -19383.53085 10516.6381   154%     -   11s
H    0     0                    -18002.97313 7602.34686   142%     -   15s
H    0     0                    -17625.55683 7602.34686   143%     -   15s
H    0     0                    -17619.78712 7602.34686   143%     -   15s
H    0     0                    -17228.11456 7602.34686   144%     -   15s
H    0     0                    -17223.07107 7602.34686   144%     -   15s
H    0     0                    -17218.27040 7602.34686   144%     -   15s
     0     0 7602.34686    0  419 -17218.270 7602.34686   144%     -   15s
     0     0 6886.74089    0  427 -17218.270 6886.74089   140%     -   16s
     0     0 6672.91776    0  429 -17218.270 6672.91776   139%     -   17s
     0     0 6623.27238    0  450 -17218.270 6623.27238   138%     -   19s
     0     0 6623.27238    0  451 -17218.270 6623.27238   138%     -   19s
     0     0 6623.23630    0  453 -17218.270 6623.23630   138%     -   19s
     0     0 4086.76252    0  581 -17218.270 4086.76252   124%     -   24s
H    0     0                    -15153.34118 4086.76252   127%     -   24s
     0     0 3857.78059    0  571 -15153.341 3857.78059   125%     -   26s
     0     0 3388.01435    0  578 -15153.341 3388.01435   122%     -   28s
     0     0 3360.02467    0  577 -15153.341 3360.02467   122%     -   28s
     0     0 3305.65228    0  583 -15153.341 3305.65228   122%     -   29s
     0     0 3300.17089    0  583 -15153.341 3300.17089   122%     -   29s
     0     0 3258.13584    0  581 -15153.341 3258.13584   122%     -   29s
     0     0 3248.74499    0  585 -15153.341 3248.74499   121%     -   30s
     0     0 3245.64041    0  577 -15153.341 3245.64041   121%     -   30s
     0     0 3243.49879    0  576 -15153.341 3243.49879   121%     -   30s
     0     0 3243.14257    0  575 -15153.341 3243.14257   121%     -   30s
H    0     0                    -15061.55514 3243.14257   122%     -   32s
H    0     0                    -14484.52656 3243.14257   122%     -   32s
H    0     0                    -14102.79159 3243.14257   123%     -   32s
H    0     0                    -13308.58567 3243.14257   124%     -   32s
     0     0 1994.44209    0  513 -13308.586 1994.44209   115%     -   35s
H    0     0                    -12798.05733 1992.47428   116%     -   36s
H    0     0                    -12680.46440 1992.47428   116%     -   36s
H    0     0                    -12641.56516 1992.47428   116%     -   36s
     0     0 1667.56044    0  588 -12641.565 1667.56044   113%     -   38s
     0     0 1562.62930    0  542 -12641.565 1562.62930   112%     -   40s
     0     0 1442.18258    0  516 -12641.565 1442.18258   111%     -   41s
     0     0 1424.88956    0  511 -12641.565 1424.88956   111%     -   42s
     0     0 1401.59362    0  567 -12641.565 1401.59362   111%     -   42s
     0     0 1399.10230    0  519 -12641.565 1399.10230   111%     -   42s
     0     0 1395.66934    0  523 -12641.565 1395.66934   111%     -   42s
     0     0 1394.43575    0  535 -12641.565 1394.43575   111%     -   42s
     0     0 1394.34482    0  529 -12641.565 1394.34482   111%     -   43s
H    0     0                    -12354.18197 1086.75344   109%     -   47s
     0     0 1086.75344    0  529 -12354.182 1086.75344   109%     -   47s
     0     0  972.94249    0  583 -12354.182  972.94249   108%     -   48s
H    0     0                    -11339.26680  910.47540   108%     -   49s
H    0     0                    -10906.19416  910.47540   108%     -   49s
H    0     0                    -10903.85421  910.47540   108%     -   49s
H    0     0                    -10881.29454  910.47540   108%     -   49s
     0     0  910.47540    0  537 -10881.295  910.47540   108%     -   49s
     0     0  884.86202    0  629 -10881.295  884.86202   108%     -   49s
     0     0  860.36131    0  545 -10881.295  860.36131   108%     -   50s
     0     0  852.78057    0  543 -10881.295  852.78057   108%     -   51s
     0     0  849.87146    0  550 -10881.295  849.87146   108%     -   51s
     0     0  848.34346    0  551 -10881.295  848.34346   108%     -   51s
     0     0  847.82927    0  550 -10881.295  847.82927   108%     -   51s
     0     0  799.71254    0  607 -10881.295  799.71254   107%     -   52s
H    0     0                    -10359.70713  798.23697   108%     -   52s
     0     0  781.95989    0  681 -10359.707  781.95989   108%     -   53s
     0     0  776.64171    0  628 -10359.707  776.64171   107%     -   53s
     0     0  774.96806    0  620 -10359.707  774.96806   107%     -   53s
     0     0  773.27336    0  625 -10359.707  773.27336   107%     -   54s
     0     0  772.77404    0  630 -10359.707  772.77404   107%     -   54s
H    0     0                    -9337.556818  645.39450   107%     -   56s
H    0     0                    -8917.889054  645.39450   107%     -   56s
     0     0  645.39450    0  564 -8917.8891  645.39450   107%     -   56s
H    0     0                    -8895.329391  644.69928   107%     -   56s
     0     0  625.11951    0  569 -8895.3294  625.11951   107%     -   57s
     0     0  620.60441    0  576 -8895.3294  620.60441   107%     -   57s
     0     0  617.92678    0  570 -8895.3294  617.92678   107%     -   57s
     0     0  616.80371    0  577 -8895.3294  616.80371   107%     -   58s
     0     0  572.81709    0  565 -8895.3294  572.81709   106%     -   59s
     0     0  553.80121    0  560 -8895.3294  553.80121   106%     -   60s
H    0     0                    -8829.228311  549.77535   106%     -   60s
     0     0  549.77535    0  570 -8829.2283  549.77535   106%     -   60s
     0     0  548.85281    0  575 -8829.2283  548.85281   106%     -   60s
     0     0  489.12235    0  555 -8829.2283  489.12235   106%     -   62s
H    0     0                    -8822.975414  488.35918   106%     -   62s
     0     0  476.83608    0  562 -8822.9754  476.83608   105%     -   62s
     0     0  472.81527    0  622 -8822.9754  472.81527   105%     -   62s
     0     0  472.34978    0  624 -8822.9754  472.34978   105%     -   63s
     0     0  450.62446    0  583 -8822.9754  450.62446   105%     -   64s
     0     0  445.66070    0  583 -8822.9754  445.66070   105%     -   64s
     0     0  444.97920    0  583 -8822.9754  444.97920   105%     -   64s
     0     0  422.09676    0  588 -8822.9754  422.09676   105%     -   65s
     0     0  408.32202    0  578 -8822.9754  408.32202   105%     -   68s
     0     0  405.03189    0  584 -8822.9754  405.03189   105%     -   68s
     0     0  404.45890    0  590 -8822.9754  404.45890   105%     -   68s
     0     0  342.92686    0  578 -8822.9754  342.92686   104%     -   69s
     0     0  336.40857    0  651 -8822.9754  336.40857   104%     -   70s
     0     0  334.39255    0  586 -8822.9754  334.39255   104%     -   70s
     0     0  333.45138    0  590 -8822.9754  333.45138   104%     -   70s
     0     0  318.67809    0  598 -8822.9754  318.67809   104%     -   71s
     0     0  313.98109    0  582 -8822.9754  313.98109   104%     -   72s
     0     0  311.73161    0  592 -8822.9754  311.73161   104%     -   72s
     0     0  310.89526    0  601 -8822.9754  310.89526   104%     -   72s
     0     0  306.29088    0  670 -8822.9754  306.29088   103%     -   73s
     0     0  304.24862    0  675 -8822.9754  304.24862   103%     -   73s
     0     0  303.23913    0  678 -8822.9754  303.23913   103%     -   74s
     0     0  296.44339    0  584 -8822.9754  296.44339   103%     -   75s
     0     0  292.43083    0  582 -8822.9754  292.43083   103%     -   75s
     0     0  291.82602    0  595 -8822.9754  291.82602   103%     -   75s
     0     0  290.23135    0  586 -8822.9754  290.23135   103%     -   76s
     0     0  289.76966    0  586 -8822.9754  289.76966   103%     -   76s
     0     2  289.76966    0  586 -8822.9754  289.76966   103%     -   88s
     1     4  220.28562    1  569 -8822.9754  289.76966   103%  1170   90s
     7    16   34.35322    3  687 -8822.9754  156.47541   102%  2690   99s
    15    32    0.26783    4  694 -8822.9754   33.98161   100%  3249  102s
    31    51 -6505.4244    5  212 -8822.9754   -3.32760   100%  3158  108s
    50    83 -2099.0758    6  473 -8822.9754   -3.32760   100%  4608  111s
    82   134 -2105.8191    7  388 -8822.9754   -3.32760   100%  3687  115s
   226   267 -4400.0093    8  190 -8822.9754   -3.32760   100%  2075  122s
   315   293 -2298.0727    9  509 -8822.9754   -3.32760   100%  1719  128s
   396   307 -2545.8381   10  518 -8822.9754   -3.32760   100%  1585  134s
   454   340 -7818.8815    9  157 -8822.9754   -3.32760   100%  1620  139s
   522   367 -2713.9987   10  470 -8822.9754   -3.32760   100%  1639  144s
   584   399 -4440.4874    9  183 -8822.9754   -3.32760   100%  1677  150s
   698   467 -4891.1059   12  483 -8822.9754 -294.49689  96.7%  1780  156s
   755   491 -4112.4114   13  368 -8822.9754 -294.63220  96.7%  1828  160s
   849   554 -3890.0315   11  331 -8822.9754 -294.63220  96.7%  1909  167s
   893   593 -4817.4153   14  359 -8822.9754 -294.63220  96.7%  1947  171s
   958   622 -5054.0825   13  473 -8822.9754 -294.63220  96.7%  1962  176s
  1011   651 -5059.1657   14  424 -8822.9754 -294.63220  96.7%  1997  180s
  1070   686 -8183.8708   15  212 -8822.9754 -294.63220  96.7%  1996  187s
  1137   734 -5332.9969   15  337 -8822.9754 -294.63220  96.7%  2039  192s
  1213   780 -5797.1766   16  285 -8822.9754 -1021.5023  88.4%  2050  196s
  1289   831 -6149.5534   16  331 -8822.9754 -1021.5023  88.4%  2052  201s
  1384   865 -6222.8286   17  254 -8822.9754 -1521.8718  82.8%  2057  207s
  1450   905     cutoff   18      -8822.9754 -1691.3353  80.8%  2066  213s
  1550   939 -7594.2672   23  277 -8822.9754 -1752.4177  80.1%  2054  218s
  1654   990 -8016.3638   26  132 -8822.9754 -1886.9162  78.6%  2073  225s
  1771  1047 -3306.1387   10  390 -8822.9754 -1886.9162  78.6%  2082  230s
  1883  1068 -4642.4365   12  377 -8822.9754 -1886.9162  78.6%  2097  235s
  1936  1100 -4979.1465   13  376 -8822.9754 -1920.0845  78.2%  2095  241s
  2022  1153 -5181.0829   14  362 -8822.9754 -2029.2521  77.0%  2097  247s
  2147  1209 -5232.3883   15  375 -8822.9754 -2079.5303  76.4%  2090  252s
  2294  1257 -5729.7242   19  422 -8822.9754 -2079.5303  76.4%  2065  257s
  2461  1360 -6505.1100   25  440 -8822.9754 -2079.5303  76.4%  2044  263s
  2621  1451 -8114.5344   30  347 -8822.9754 -2164.4127  75.5%  2039  270s
  2830  1552 -4948.1905   12  399 -8822.9754 -2164.4127  75.5%  2001  276s
  3031  1642 -8004.8286   17  183 -8822.9754 -2227.6008  74.8%  1981  281s
  3205  1748     cutoff   11      -8822.9754 -2248.1173  74.5%  1989  288s
  3410  1803     cutoff   12      -8822.9754 -2376.8543  73.1%  1972  294s
  3657  1886 -3831.7138    8  446 -8822.9754 -2376.8543  73.1%  1945  301s
  3849  1953 -5508.7330   15  350 -8822.9754 -2693.6400  69.5%  1954  308s
  3986  1975 -6272.3392   22  326 -8822.9754 -2718.9031  69.2%  1956  315s
  4028  2004 -6480.5253   23  268 -8822.9754 -2729.0728  69.1%  1965  321s
  4079  2022 -6567.2594   24  268 -8822.9754 -2729.0728  69.1%  1967  328s
  4151  2042 -7034.6939   25  306 -8822.9754 -2729.0728  69.1%  1968  335s
  4213  2077 -7135.2087   26  267 -8822.9754 -2729.0728  69.1%  1978  341s
  4310  2124     cutoff   12      -8822.9754 -2859.0924  67.6%  1966  348s
  4429  2217 -4286.2135    8  542 -8822.9754 -2989.4117  66.1%  1961  356s
  4643  2292 -5346.6576   12  517 -8822.9754 -3011.5094  65.9%  1949  363s
  4885  2403 -6707.7599   22  429 -8822.9754 -3159.9183  64.2%  1947  372s
  5160  2404 -5496.3508   12  586 -8822.9754 -3159.9183  64.2%  1933  430s
  5162  2405 -6408.0557   21  303 -8822.9754 -3159.9183  64.2%  1932  442s
  5163  2406 -5376.7806   12  618 -8822.9754 -3159.9183  64.2%  1931  452s
  5164  2407 -4132.0655   11  576 -8822.9754 -3159.9183  64.2%  1931  460s
  5166  2408 -6490.3131   23  626 -8822.9754 -3159.9183  64.2%  1930  466s
  5169  2410 -6120.4196   19  568 -8822.9754 -3159.9183  64.2%  1929  470s
  5172  2412 -4544.7620   22  656 -8822.9754 -3159.9183  64.2%  1928  475s
  5173  2413 -4342.6229   17  726 -8822.9754 -3159.9183  64.2%  1928  480s
  5176  2415 -4752.7248    9  634 -8822.9754 -3159.9183  64.2%  1927  486s
  5179  2417 -4445.1495   10  642 -8822.9754 -3159.9183  64.2%  1925  491s
  5182  2419 -3767.2559   18  764 -8822.9754 -3159.9183  64.2%  1924  497s
  5184  2420 -8584.2736    9  656 -8822.9754 -3159.9183  64.2%  1924  504s
  5185  2421 -4175.3414   12  580 -8822.9754 -3159.9183  64.2%  1923  505s
  5187  2422 -3777.7300   11  634 -8822.9754 -3159.9183  64.2%  1923  512s
  5188  2423 -6762.9217   24  634 -8822.9754 -3159.9183  64.2%  1922  524s
  5189  2423 -7217.6141   16  634 -8822.9754 -3159.9183  64.2%  1922  534s
  5190  2427 -3159.9183   11  682 -8822.9754 -3159.9183  64.2%  1944  543s
  5192  2430 -3159.9183   12  677 -8822.9754 -3159.9183  64.2%  1944  548s
  5196  2437 -3159.9183   13  667 -8822.9754 -3159.9183  64.2%  1947  555s
  5204  2448 -3159.9183   14  703 -8822.9754 -3159.9183  64.2%  1949  560s
  5220  2464 -3159.9183   15  769 -8822.9754 -3159.9183  64.2%  1969  571s
  5246  2477 -3159.9183   16  769 -8822.9754 -3159.9183  64.2%  1985  578s
  5278  2499 -3159.9183   17  768 -8822.9754 -3159.9183  64.2%  1996  588s
  5310  2527 -3159.9183   18  712 -8822.9754 -3159.9183  64.2%  1996  593s
  5357  2563 -3940.6541   18  503 -8822.9754 -3159.9183  64.2%  1994  599s
  5428  2575 -3159.9183   19  693 -8822.9754 -3159.9183  64.2%  1994  605s
  5508  2573 -4283.2812   19  704 -8822.9754 -3159.9183  64.2%  1998  613s
  5575  2583 -3159.9183   20  643 -8822.9754 -3159.9183  64.2%  2004  621s
  5647  2592 -3485.4336   21  723 -8822.9754 -3159.9183  64.2%  2015  625s
  5688  2601 -3664.8225   21  622 -8822.9754 -3159.9183  64.2%  2017  632s
  5761  2600 -5031.8063   22  710 -8822.9754 -3159.9183  64.2%  2015  637s
  5851  2590 -5030.4760   22  670 -8822.9754 -3159.9183  64.2%  2008  643s
  5939  2575 -6289.1871   23  652 -8822.9754 -3159.9183  64.2%  2000  649s
  5995  2585 -6028.8042   23  736 -8822.9754 -3250.5728  63.2%  1997  656s
  6070  2579 infeasible   24      -8822.9754 -3250.5728  63.2%  1992  662s
  6156  2589 -6973.3753   26  557 -8822.9754 -3303.6794  62.6%  1987  669s
  6241  2572 -7561.4282   26  599 -8822.9754 -3303.6794  62.6%  1981  677s
  6296  2579 -7146.0124   27  509 -8822.9754 -3453.9814  60.9%  1978  682s
  6392  2576     cutoff   28      -8822.9754 -3453.9814  60.9%  1967  689s
  6467  2573 -8778.7945   29  214 -8822.9754 -3544.0145  59.8%  1963  694s
  6583  2556     cutoff   30      -8822.9754 -3590.1513  59.3%  1953  702s
  6710  2524     cutoff   32      -8822.9754 -3590.1513  59.3%  1941  709s
  6758  2541     cutoff   33      -8822.9754 -3590.1513  59.3%  1937  716s
  6830  2540 -6092.9922   23  482 -8822.9754 -3590.1513  59.3%  1932  722s
  6950  2549     cutoff   25      -8822.9754 -3767.4113  57.3%  1920  730s
  7075  2550 -7727.6313   28  270 -8822.9754 -4068.6314  53.9%  1911  738s
  7203  2566 -5588.2975   17  512 -8822.9754 -4186.1185  52.6%  1908  747s
  7334  2571 -6164.0831   20  475 -8822.9754 -4268.2786  51.6%  1900  754s
  7479  2585 -6547.0761   23  422 -8822.9754 -4268.2786  51.6%  1891  763s
  7622  2587 -6832.9878   25  275 -8822.9754 -4281.0145  51.5%  1881  772s
  7816  2539 -7506.6960   29  483 -8822.9754 -4281.0145  51.5%  1864  781s
  7988  2513 -8723.7305   36  171 -8822.9754 -4572.9653  48.2%  1856  791s
  8161  2474 -7999.7837   22  231 -8822.9754 -4603.7656  47.8%  1849  798s
  8361  2402     cutoff   21      -8822.9754 -4732.4584  46.4%  1835  809s
  8557  2356 -7932.1316   22  544 -8822.9754 -4908.2284  44.4%  1827  818s
  8700  2347     cutoff   23      -8822.9754 -4908.2284  44.4%  1820  828s
  8904  2315     cutoff   26      -8822.9754 -4908.2284  44.4%  1814  838s
  9122  2273 -8168.0775   27  531 -8822.9754 -5299.0528  39.9%  1805  848s
  9363  2205 -8724.8272   20  188 -8822.9754 -5566.5967  36.9%  1793  858s
  9629  2104 -7905.9468   19  292 -8822.9754 -5699.3211  35.4%  1779  868s
  9937  1977 -7857.0098   25  367 -8822.9754 -5699.3211  35.4%  1758  880s
 10156  1907 -8593.2165   30  264 -8822.9754 -6123.6230  30.6%  1747  890s
 10484  1725 -8729.8471   25  265 -8822.9754 -6144.5606  30.4%  1724  901s
 10885  1491 -7863.9125   32  434 -8822.9754 -6365.0671  27.9%  1695  913s
 11338  1196 -8247.6622   36  309 -8822.9754 -6365.0671  27.9%  1661  925s
 11815   693 -7856.9460   32  435 -8822.9754 -6943.4531  21.3%  1628  935s
 12441   129 -8207.8112   30  580 -8822.9754 -7243.8116  17.9%  1577  945s
 13022     2     cutoff   28      -8822.9754 -7585.8132  14.0%  1528  953s

Cutting planes:
  Learned: 2
  MIR: 548
  Flow cover: 1229
  Zero half: 8
  RLT: 20
  Relax-and-lift: 44

Explored 13209 nodes (20103649 simplex iterations) in 953.48 seconds (2689.20 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -8822.98 -8829.23 -8895.33 ... -11339.3
No other solutions better than -8822.98

Optimal solution found (tolerance 1.00e-04)
Best objective -8.822975414480e+03, best bound -8.822975414480e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 953.49s
  Master Objective (UB) = -8822.98, θ = 118742.27
  Upper Bound (UB) = -8822.98

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 118742.27
  [DEBUG]   ✓ Scenario 0: θ = 118742.27 ≤ Q = 118742.27 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 118742.27 ≤ Q = 118742.27 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 118742.27 ≤ Q = 118742.27 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 118742.27 ≤ Q = 118742.27 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x4e40166b
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x4e40166b
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.312391e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 6961376.4863
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.231742e+05, 245 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -123174.25    0  123 6961376.49 -123174.25   102%     -    0s
H    0     0                    -87675.76419 -123174.25  40.5%     -    0s
H    0     0                    -88921.95777 -123174.25  38.5%     -    0s
     0     0 -102825.79    0   83 -88921.958 -102825.79  15.6%     -    0s
H    0     0                    -100414.5251 -102806.45  2.38%     -    0s
     0     0 -102607.20    0   84 -100414.53 -102607.20  2.18%     -    0s
H    0     0                    -101140.4453 -102573.14  1.42%     -    0s
     0     0 -102573.14    0   84 -101140.45 -102573.14  1.42%     -    0s
     0     0 -102573.14    0   84 -101140.45 -102573.14  1.42%     -    0s
     0     0 -101971.38    0   68 -101140.45 -101971.38  0.82%     -    0s
H    0     0                    -101159.5325 -101860.23  0.69%     -    0s
     0     0 -101860.23    0   56 -101159.53 -101860.23  0.69%     -    0s
     0     0 -101849.12    0   62 -101159.53 -101849.12  0.68%     -    0s
     0     0 -101624.72    0   43 -101159.53 -101624.72  0.46%     -    0s
     0     0 -101492.73    0   47 -101159.53 -101492.73  0.33%     -    0s
     0     0 -101492.72    0   45 -101159.53 -101492.72  0.33%     -    0s
     0     0 -101488.05    0   48 -101159.53 -101488.05  0.32%     -    0s
H    0     0                    -101165.1213 -101488.05  0.32%     -    0s
     0     0 -101387.70    0   23 -101165.12 -101387.70  0.22%     -    0s
     0     0 -101373.46    0   23 -101165.12 -101373.46  0.21%     -    0s
     0     0 -101291.69    0   26 -101165.12 -101291.69  0.13%     -    0s
     0     0 -101269.81    0   14 -101165.12 -101269.81  0.10%     -    0s
     0     0 -101184.62    0    2 -101165.12 -101184.62  0.02%     -    0s
H    0     0                    -101175.4540 -101184.49  0.01%     -    0s

Cutting planes:
  Gomory: 9
  Implied bound: 5
  MIR: 2
  Flow cover: 3
  Relax-and-lift: 5

Explored 1 nodes (885 simplex iterations) in 0.07 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -101175 -101165 -101160 ... 1.31239e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.011754539879e+05, best bound -1.011844906803e+05, gap 0.0089%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 108800.06
  Scenario: 38 demand increases, 22 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -101175.45
  [DEBUG]   S×d_nominal = 209975.52
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 209975.52 + -101175.45 = 108800.06
  [DEBUG]   Current θ from Master = 118742.27
  [DEBUG]   ⚠️  Z_SP ≤ θ by 9942.21 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -18765.18
  Lower Bound (LB) = -10011.25
  Gap (UB-LB) = 1188.2791, Absolute Gap = 1188.2791, Relative Gap = 0.134680
  Not converged yet (gap = 1188.28 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 38 increases, 22 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221719 nonzeros
Model fingerprint: 0x310f061c
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 33915 rows and 13775 columns
Presolve time: 0.68s
Presolved: 43918 rows, 19685 columns, 272354 nonzeros
Variable types: 17426 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -409717.4995
Found heuristic solution: objective -226690.3294

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 43918 rows, 19685 columns, 272354 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   28587    2.2525803e+03   0.000000e+00   9.797322e+05      5s
   39103    7.4249087e+03   0.000000e+00   1.060250e+06     10s
   49051    1.0413538e+04   0.000000e+00   5.683689e+05     15s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 1.051664e+04, 40907 iterations, 18.63 seconds (37.38 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 10516.6381    0  303 -226690.33 10516.6381   105%     -   19s
H    0     0                    -211155.5873 10516.6381   105%     -   19s
H    0     0                    -102277.8191 10516.6381   110%     -   19s
H    0     0                    -102026.5895 10516.6381   110%     -   19s
H    0     0                    -101563.1323 10516.6381   110%     -   20s
H    0     0                    -101374.3841 10516.6381   110%     -   20s
H    0     0                    -70881.92407 10516.6381   115%     -   20s
H    0     0                    -70735.89491 10516.6381   115%     -   20s
H    0     0                    -29256.06307 10516.6381   136%     -   20s
H    0     0                    -19518.34442 10516.6381   154%     -   20s
H    0     0                    -15284.69976 10516.6381   169%     -   20s
H    0     0                    -14720.33400 10516.6381   171%     -   20s
H    0     0                    -9583.843165 7933.34816   183%     -   26s
H    0     0                    -9172.364549 7933.34816   186%     -   26s
H    0     0                    -9103.280763 7933.34816   187%     -   26s
H    0     0                    -9092.999953 7933.34816   187%     -   26s
H    0     0                    -8986.752122 7933.34816   188%     -   26s
H    0     0                    -8964.192459 7933.34816   189%     -   26s
     0     0 7933.34816    0  423 -8964.1925 7933.34816   189%     -   26s
     0     0 7784.49426    0  418 -8964.1925 7784.49426   187%     -   27s
     0     0 7784.49426    0  416 -8964.1925 7784.49426   187%     -   28s
     0     0 7106.16022    0  427 -8964.1925 7106.16022   179%     -   29s
     0     0 7009.58705    0  334 -8964.1925 7009.58705   178%     -   30s
     0     0 7009.58705    0  338 -8964.1925 7009.58705   178%     -   30s
     0     0 7009.58705    0  338 -8964.1925 7009.58705   178%     -   31s
     0     0 7009.58705    0  338 -8964.1925 7009.58705   178%     -   31s
     0     0 4271.09411    0  571 -8964.1925 4271.09411   148%     -   36s
H    0     0                    -8906.778228 4269.76633   148%     -   36s
     0     0 3872.75244    0  573 -8906.7782 3872.75244   143%     -   39s
     0     0 3710.56669    0  578 -8906.7782 3710.56669   142%     -   40s
     0     0 3606.22225    0  564 -8906.7782 3606.22225   140%     -   42s
     0     0 3532.10831    0  572 -8906.7782 3532.10831   140%     -   43s
     0     0 3522.34106    0  513 -8906.7782 3522.34106   140%     -   44s
     0     0 3521.09278    0  566 -8906.7782 3521.09278   140%     -   44s
     0     0 3521.05497    0  567 -8906.7782 3521.05497   140%     -   44s
     0     0 2246.83070    0  510 -8906.7782 2246.83070   125%     -   52s
     0     0 1612.98170    0  525 -8906.7782 1612.98170   118%     -   57s
     0     0 1436.92932    0  526 -8906.7782 1436.92932   116%     -   59s
     0     0 1357.77784    0  529 -8906.7782 1357.77784   115%     -   60s
     0     0 1336.68037    0  540 -8906.7782 1336.68037   115%     -   61s
     0     0 1326.30223    0  549 -8906.7782 1326.30223   115%     -   61s
     0     0 1252.35754    0  534 -8906.7782 1252.35754   114%     -   62s
     0     0 1224.49318    0  611 -8906.7782 1224.49318   114%     -   63s
     0     0 1222.37810    0  553 -8906.7782 1222.37810   114%     -   64s
     0     0 1222.31835    0  557 -8906.7782 1222.31835   114%     -   64s
     0     0  799.11236    0  534 -8906.7782  799.11236   109%     -   70s
     0     0  665.89780    0  532 -8906.7782  665.89780   107%     -   73s
     0     0  614.05808    0  628 -8906.7782  614.05808   107%     -   74s
     0     0  560.35907    0  562 -8906.7782  560.35907   106%     -   75s
     0     0  519.46148    0  572 -8906.7782  519.46148   106%     -   76s
     0     0  510.02844    0  579 -8906.7782  510.02844   106%     -   77s
     0     0  505.60012    0  578 -8906.7782  505.60012   106%     -   77s
     0     0  499.56531    0  566 -8906.7782  499.56531   106%     -   78s
     0     0  495.69379    0  634 -8906.7782  495.69379   106%     -   78s
     0     0  492.72881    0  573 -8906.7782  492.72881   106%     -   78s
     0     0  492.14964    0  576 -8906.7782  492.14964   106%     -   78s
     0     0  433.07613    0  566 -8906.7782  433.07613   105%     -   80s
     0     0  418.93817    0  574 -8906.7782  418.93817   105%     -   81s
     0     0  388.73214    0  549 -8906.7782  388.73214   104%     -   82s
     0     0  379.68268    0  560 -8906.7782  379.68268   104%     -   83s
     0     0  374.45534    0  556 -8906.7782  374.45534   104%     -   84s
     0     0  370.01537    0  610 -8906.7782  370.01537   104%     -   84s
     0     0  366.94610    0  542 -8906.7782  366.94610   104%     -   84s
     0     0  366.62687    0  549 -8906.7782  366.62687   104%     -   84s
     0     0  324.52189    0  549 -8906.7782  324.52189   104%     -   86s
     0     0  317.68364    0  552 -8906.7782  317.68364   104%     -   87s
     0     0  311.46393    0  564 -8906.7782  311.46393   103%     -   87s
     0     0  303.15416    0  559 -8906.7782  303.15416   103%     -   88s
     0     0  298.20111    0  573 -8906.7782  298.20111   103%     -   88s
     0     0  295.70788    0  572 -8906.7782  295.70788   103%     -   88s
     0     0  295.70371    0  572 -8906.7782  295.70371   103%     -   88s
H    0     0                    -8900.545688  220.65903   102%     -   91s
     0     0  220.65903    0  553 -8900.5457  220.65903   102%     -   91s
     0     0  173.74107    0  542 -8900.5457  173.74107   102%     -   92s
     0     0  151.66916    0  568 -8900.5457  151.66916   102%     -   92s
     0     0  147.25913    0  567 -8900.5457  147.25913   102%     -   93s
     0     0  146.55614    0  577 -8900.5457  146.55614   102%     -   93s
     0     0  102.74934    0  571 -8900.5457  102.74934   101%     -   95s
     0     0   94.25936    0  557 -8900.5457   94.25936   101%     -   95s
     0     0   91.96853    0  568 -8900.5457   91.96853   101%     -   95s
     0     0   90.79693    0  576 -8900.5457   90.79693   101%     -   96s
     0     0   24.41272    0  634 -8900.5457   24.41272   100%     -   97s
     0     0   14.79001    0  635 -8900.5457   14.79001   100%     -   98s
     0     0   10.80132    0  567 -8900.5457   10.80132   100%     -   98s
     0     0    8.48333    0  571 -8900.5457    8.48333   100%     -   98s
     0     0    7.03176    0  572 -8900.5457    7.03176   100%     -   99s
     0     0    6.18382    0  574 -8900.5457    6.18382   100%     -   99s
     0     0   -3.41303    0  565 -8900.5457   -3.41303   100%     -  100s
     0     0   -6.91974    0  569 -8900.5457   -6.91974   100%     -  100s
     0     0   -7.17234    0  568 -8900.5457   -7.17234   100%     -  100s
     0     0  -11.29357    0  569 -8900.5457  -11.29357   100%     -  101s
     0     0  -11.66365    0  574 -8900.5457  -11.66365   100%     -  101s
     0     0  -13.03146    0  573 -8900.5457  -13.03146   100%     -  102s
     0     0  -13.48069    0  577 -8900.5457  -13.48069   100%     -  103s
     0     0  -14.16105    0  578 -8900.5457  -14.16105   100%     -  103s
     0     0  -14.54494    0  578 -8900.5457  -14.54494   100%     -  104s
     0     2  -14.54494    0  578 -8900.5457  -14.54494   100%     -  119s
     1     4 -234.07806    1  563 -8900.5457  -14.88235   100%  4134  121s
     3     8 -394.32823    2  685 -8900.5457 -234.32465  97.4%  4082  125s
    15    32 -563.23759    4  671 -8900.5457 -467.74775  94.7%  3898  134s
    31    50 -6887.1921    5  197 -8900.5457 -563.43102  93.7%  4896  147s
    49    82 -3097.5344    6  267 -8900.5457 -563.43102  93.7%  6516  151s
    81   114 -3365.5175    7  270 -8900.5457 -563.43102  93.7%  4685  155s
   113   204 -3490.3358    8  259 -8900.5457 -563.43102  93.7%  3715  160s
   269   296 -3734.8132   10  246 -8900.5457 -563.43102  93.7%  2142  169s
   351   330 -3976.2458   12  234 -8900.5457 -563.43102  93.7%  1885  175s
   425   367 -4198.8158   13  231 -8900.5457 -563.43102  93.7%  1797  181s
   482   408 -4604.7504   13  224 -8900.5457 -563.43102  93.7%  1775  188s
   551   432 -5574.1835   14  228 -8900.5457 -563.43102  93.7%  1744  194s
   625   455     cutoff   15      -8900.5457 -563.43102  93.7%  1702  200s
   700   483 -5936.8064   15  223 -8900.5457 -563.43102  93.7%  1667  205s
   776   495 -6323.5419   15  224 -8900.5457 -563.43102  93.7%  1631  212s
   852   518 infeasible   15      -8900.5457 -563.43102  93.7%  1612  216s
   911   540 -6993.3374   17  199 -8900.5457 -563.43102  93.7%  1602  222s
   975   546 -8009.2197   18  187 -8900.5457 -563.43102  93.7%  1612  229s
  1058   566 -7545.2357   12  191 -8900.5457 -563.43102  93.7%  1631  235s
  1132   589     cutoff   14      -8900.5457 -563.43102  93.7%  1601  241s
  1201   623 -7811.4278   13   88 -8900.5457 -762.10199  91.4%  1628  248s
  1288   645 -3289.8325    6  492 -8900.5457 -762.10199  91.4%  1641  255s
  1360   688 -3688.8396    7  463 -8900.5457 -762.10199  91.4%  1655  260s
  1436   717 -5007.1787    9  428 -8900.5457 -762.10199  91.4%  1668  267s
  1527   757 infeasible   11      -8900.5457 -762.10199  91.4%  1667  274s
  1627   803 -5729.1704   11  374 -8900.5457 -1297.4828  85.4%  1671  281s
  1735   838 -6021.4115   13  415 -8900.5457 -1297.4828  85.4%  1722  288s
  1841   866 -6448.3454   16  544 -8900.5457 -1297.4828  85.4%  1733  294s
  1897   889 -6547.1111   17  497 -8900.5457 -1297.4828  85.4%  1739  302s
  2010   914 -6636.3188   18  499 -8900.5457 -1297.4828  85.4%  1722  310s
  2093   956 -6726.1341   19  490 -8900.5457 -1983.5097  77.7%  1741  315s
  2197  1002 -6811.7760   20  473 -8900.5457 -2087.2860  76.5%  1806  322s
  2295  1061 -7117.3846   21  345 -8900.5457 -2087.2860  76.5%  1826  330s
  2398  1102 -8800.0655   24  354 -8900.5457 -2087.2860  76.5%  1833  339s
  2520  1142     cutoff   25      -8900.5457 -2087.2860  76.5%  1822  347s
  2682  1188 infeasible   19      -8900.5457 -2364.9687  73.4%  1784  356s
  2821  1233 -4021.9951    6  370 -8900.5457 -2459.9875  72.4%  1777  365s
  2984  1290 -4804.2858    7  377 -8900.5457 -2459.9875  72.4%  1757  374s
  3136  1332 -5716.7953   10  227 -8900.5457 -2459.9875  72.4%  1761  383s
  3249  1399 -6547.8609   12  193 -8900.5457 -2926.7892  67.1%  1758  392s
  3432  1465     cutoff   13      -8900.5457 -3013.5782  66.1%  1751  400s
  3617  1492 -5461.0719    8  439 -8900.5457 -3101.6641  65.2%  1748  408s
  3765  1528 -7930.6617    9  340 -8900.5457 -3202.7549  64.0%  1738  417s
  3933  1587 infeasible   11      -8900.5457 -3202.7549  64.0%  1747  428s
  4109  1662 -6931.2903   11  378 -8900.5457 -3390.1361  61.9%  1749  440s
  4342  1722 -8324.2628   16  349 -8900.5457 -3491.2652  60.8%  1740  453s
  4575  1806 -5447.6891   11  190 -8900.5457 -3548.8106  60.1%  1733  465s
  4814  1892 -6388.2866   13  179 -8900.5457 -3735.3324  58.0%  1731  478s
  5086  1942 -7443.4949   13  205 -8900.5457 -3740.5171  58.0%  1726  491s
  5277  2017 -5912.0672   21  311 -8900.5457 -3740.5171  58.0%  1729  504s
  5535  2091     cutoff   27      -8900.5457 -3910.6406  56.1%  1723  516s
  5829  2157 -6228.0888   13  364 -8900.5457 -3990.3332  55.2%  1712  529s
  6144  2212 -7648.0102   19  587 -8900.5457 -4226.3741  52.5%  1702  543s
  6379  2260 -8633.3562   23  278 -8900.5457 -4370.7994  50.9%  1698  558s
  6629  2346 -7053.5998   15  282 -8900.5457 -4512.6269  49.3%  1694  574s
  6966  2347 -8526.4056   43  578 -8900.5457 -4563.1264  48.7%  1687  602s
  6968  2348 -8611.9742   39  303 -8900.5457 -4563.1264  48.7%  1687  616s
  6969  2349 -8045.2484   36  620 -8900.5457 -4563.1264  48.7%  1687  630s
  6970  2350 -5948.7439   12  609 -8900.5457 -4563.1264  48.7%  1687  640s
  6971  2350 -7136.6129    7  584 -8900.5457 -4563.1264  48.7%  1686  645s
  6973  2352 -6713.3323   22  633 -8900.5457 -4563.1264  48.7%  1686  652s
  6975  2353 -5842.0731   12  690 -8900.5457 -4563.1264  48.7%  1685  656s
  6977  2354 -5597.4639   10  650 -8900.5457 -4563.1264  48.7%  1685  660s
  6978  2355 -5779.7615   11  616 -8900.5457 -4563.1264  48.7%  1685  665s
  6981  2357 -6348.5446   18  659 -8900.5457 -4563.1264  48.7%  1684  670s
  6982  2358 -7627.3011   22  717 -8900.5457 -4563.1264  48.7%  1684  675s
  6984  2359 -5611.8638    9  741 -8900.5457 -4563.1264  48.7%  1683  684s
  6985  2360 -5384.9730    9  674 -8900.5457 -4563.1264  48.7%  1683  686s
  6987  2361 -6495.3340   23  749 -8900.5457 -4563.1264  48.7%  1682  693s
  6988  2362 -8035.2971   28  609 -8900.5457 -4563.1264  48.7%  1682  695s
  6990  2363 -7986.8263   21  688 -8900.5457 -4563.1264  48.7%  1682  715s
  6991  2364 -6142.9658   14  688 -8900.5457 -4563.1264  48.7%  1681  728s
  6992  2367 -4563.1264   14  654 -8900.5457 -4563.1264  48.7%  1703  736s
  6994  2371 -4563.1264   15  651 -8900.5457 -4563.1264  48.7%  1704  743s
  6998  2377 -4563.1264   16  703 -8900.5457 -4563.1264  48.7%  1705  750s
  7006  2389 -4563.1264   17  760 -8900.5457 -4563.1264  48.7%  1710  762s
  7022  2398 -8674.7489   18  258 -8900.5457 -4563.1264  48.7%  1724  777s
  7039  2418 -7367.6601   19  234 -8900.5457 -4563.1264  48.7%  1737  784s
  7071  2463 -7473.7903   20  230 -8900.5457 -4563.1264  48.7%  1744  794s
  7159  2460 -8303.5503   22  152 -8900.5457 -4563.1264  48.7%  1748  803s
  7249  2445     cutoff   24      -8900.5457 -4563.1264  48.7%  1748  815s
  7301  2433 -4563.1264   19  490 -8900.5457 -4563.1264  48.7%  1751  824s
  7359  2430 -4563.1264   20  437 -8900.5457 -4563.1264  48.7%  1761  831s
  7406  2422 -4563.1264   21  408 -8900.5457 -4563.1264  48.7%  1767  839s
  7459  2423 -4563.1264   22  404 -8900.5457 -4563.1264  48.7%  1782  847s
  7517  2424 -8542.1319   24  114 -8900.5457 -4563.1264  48.7%  1788  854s
  7573  2424 -6484.2920   22  519 -8900.5457 -4563.1264  48.7%  1795  865s
  7638  2433 -7269.1509   23  444 -8900.5457 -4563.1264  48.7%  1798  872s
  7691  2451 -7774.1064   24  431 -8900.5457 -4563.1264  48.7%  1804  879s
  7760  2453 -8501.6312   26  266 -8900.5457 -4563.1264  48.7%  1804  890s
  7826  2456 -8851.3774   28  290 -8900.5457 -4563.1264  48.7%  1806  898s
  7904  2444     cutoff   39      -8900.5457 -4563.1264  48.7%  1810  906s
  7945  2460 -7027.6477   22  365 -8900.5457 -4563.1264  48.7%  1811  914s
  8003  2458 -7421.9853   23  360 -8900.5457 -4563.1264  48.7%  1814  923s
  8061  2450 -8096.7099   24  174 -8900.5457 -4563.1264  48.7%  1815  931s
  8141  2444 -8325.6579   25  261 -8900.5457 -4563.1264  48.7%  1815  942s
  8231  2417     cutoff   28      -8900.5457 -4563.1264  48.7%  1819  951s
  8291  2409     cutoff   26      -8900.5457 -4563.1264  48.7%  1824  960s
  8371  2398     cutoff   24      -8900.5457 -4563.1264  48.7%  1830  969s
  8474  2373     cutoff   25      -8900.5457 -4563.1264  48.7%  1834  977s
  8563  2347 -8677.9282   20  246 -8900.5457 -4563.1264  48.7%  1836  987s
  8661  2328 -6084.2748   25  431 -8900.5457 -4563.1264  48.7%  1845  997s
  8766  2310 -6384.4376   26  320 -8900.5457 -4563.1264  48.7%  1852 1007s
  8886  2285 -7098.5224   26  369 -8900.5457 -4563.1264  48.7%  1858 1017s
  9020  2244 -7923.0486   29  303 -8900.5457 -4582.1607  48.5%  1862 1028s
  9155  2203     cutoff   29      -8900.5457 -4582.1607  48.5%  1864 1036s
  9227  2182 -7747.9752   30  381 -8900.5457 -5044.0676  43.3%  1866 1047s
  9328  2146     cutoff   31      -8900.5457 -5047.5612  43.3%  1868 1056s
  9476  2094 -8217.8494   32  275 -8900.5457 -5565.8956  37.5%  1868 1068s
  9632  2064 -8473.5919   34  192 -8900.5457 -5685.1879  36.1%  1869 1080s
  9802  1984 infeasible   30      -8900.5457 -5686.8906  36.1%  1870 1091s
 10041  1841 -6922.4097   28  201 -8900.5457 -6008.1963  32.5%  1860 1104s
 10276  1737     cutoff   30      -8900.5457 -6008.1963  32.5%  1853 1114s
 10509  1487 -7673.3392   34  337 -8900.5457 -6465.5885  27.4%  1845 1125s
 10875  1183     cutoff   38      -8900.5457 -7001.7382  21.3%  1816 1137s
 11223   960     cutoff   32      -8900.5457 -7082.7956  20.4%  1785 1145s

Cutting planes:
  Learned: 2
  MIR: 474
  Flow cover: 1100
  Zero half: 8
  RLT: 25
  Relax-and-lift: 65

Explored 11397 nodes (20319966 simplex iterations) in 1149.88 seconds (3394.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -8900.55 -8906.78 -8964.19 ... -15284.7
No other solutions better than -8900.55

Optimal solution found (tolerance 1.00e-04)
Best objective -8.900545687825e+03, best bound -8.900545687825e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1149.89s
  Master Objective (UB) = -8900.55, θ = 118138.07
  Upper Bound (UB) = -8900.55

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 118138.07
  [DEBUG]   ✓ Scenario 0: θ = 118138.07 ≤ Q = 118138.07 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 118138.07 ≤ Q = 118138.07 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 118138.07 ≤ Q = 118138.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 118138.07 ≤ Q = 118138.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 118138.07 ≤ Q = 118138.07 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x4f144f7d
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x4f144f7d
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.307725e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 6924454.4207
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.231205e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -123120.46    0  123 6924454.42 -123120.46   102%     -    0s
H    0     0                    -87675.24809 -123120.46  40.4%     -    0s
H    0     0                    -88994.38245 -123120.46  38.3%     -    0s
     0     0 -95625.905    0   86 -88994.382 -95625.905  7.45%     -    0s
H    0     0                    -92321.37793 -95603.737  3.56%     -    0s
     0     0 -95365.467    0   87 -92321.378 -95365.467  3.30%     -    0s
     0     0 -95318.571    0   87 -92321.378 -95318.571  3.25%     -    0s
     0     0 -95305.057    0   87 -92321.378 -95305.057  3.23%     -    0s
H    0     0                    -93540.18691 -95305.057  1.89%     -    0s
H    0     0                    -93651.50719 -95305.057  1.77%     -    0s
     0     0 -95094.100    0   89 -93651.507 -95094.100  1.54%     -    0s
H    0     0                    -93662.04717 -95054.406  1.49%     -    0s
     0     0 -95054.406    0   89 -93662.047 -95054.406  1.49%     -    0s
     0     0 -94927.791    0   91 -93662.047 -94927.791  1.35%     -    0s
     0     0 -94895.825    0   91 -93662.047 -94895.825  1.32%     -    0s
H    0     0                    -93719.23764 -94884.265  1.24%     -    0s
     0     2 -94884.265    0   91 -93719.238 -94884.265  1.24%     -    0s
H   29    16                    -94404.99399 -94646.235  0.26%  13.1    0s

Cutting planes:
  Gomory: 17
  MIR: 148

Explored 83 nodes (1153 simplex iterations) in 0.10 seconds (0.06 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -94405 -93719.2 -93662 ... 1.30772e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -9.440499399066e+04, best bound -9.440926581132e+04, gap 0.0045%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 114973.32
  Scenario: 8 demand increases, 52 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -94404.99
  [DEBUG]   S×d_nominal = 209378.32
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 209378.32 + -94404.99 = 114973.32
  [DEBUG]   Current θ from Master = 118138.07
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3164.74 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -12065.29
  Lower Bound (LB) = -10011.25
  Gap (UB-LB) = 1110.7089, Absolute Gap = 1110.7089, Relative Gap = 0.124791
  Not converged yet (gap = 1110.71 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 8 increases, 52 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 264959 nonzeros
Model fingerprint: 0x4946fe89
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 40722 rows and 16542 columns
Presolve time: 0.82s
Presolved: 52401 rows, 23158 columns, 325649 nonzeros
Variable types: 20899 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -409717.4995
Found heuristic solution: objective -226690.3294

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 52401 rows, 23158 columns, 325649 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   29234   -7.6438412e+03   0.000000e+00   9.731164e+05      5s
   39074    3.4367225e+03   0.000000e+00   1.957633e+07     10s
   47774    6.3572581e+03   0.000000e+00   3.373826e+05     15s
   56171    7.6876811e+03   0.000000e+00   5.562880e+06     20s
   64417    9.2375891e+03   0.000000e+00   5.773264e+06     25s
   72050    1.0176409e+04   0.000000e+00   5.086207e+07     30s
Concurrent spin time: 0.01s

Solved with dual simplex

Root relaxation: objective 1.030074e+04, 45667 iterations, 29.53 seconds (58.56 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 10300.7430    0  323 -226690.33 10300.7430   105%     -   30s
H    0     0                    -215363.9660 10300.7430   105%     -   30s
H    0     0                    -108484.7603 10300.7430   109%     -   31s
H    0     0                    -104313.9311 10300.7430   110%     -   31s
H    0     0                    -104015.8155 10300.7430   110%     -   31s
H    0     0                    -61158.26165 10300.7430   117%     -   31s
H    0     0                    -42599.24875 10300.7430   124%     -   31s
H    0     0                    -15727.62367 10300.7430   165%     -   31s
H    0     0                    -14802.50820 10300.7430   170%     -   31s
H    0     0                    -9472.174627 7166.55404   176%     -   39s
H    0     0                    -9373.136142 7166.55404   176%     -   39s
H    0     0                    -9070.675448 7166.55404   179%     -   39s
     0     0 7166.55404    0  437 -9070.6754 7166.55404   179%     -   39s
     0     0 6365.08554    0  460 -9070.6754 6365.08554   170%     -   44s
     0     0 6365.08554    0  457 -9070.6754 6365.08554   170%     -   44s
     0     0 6150.34835    0  466 -9070.6754 6150.34835   168%     -   45s
     0     0 6131.38899    0  446 -9070.6754 6131.38899   168%     -   48s
     0     0 6131.38899    0  454 -9070.6754 6131.38899   168%     -   49s
     0     0 6131.38899    0  368 -9070.6754 6131.38899   168%     -   51s
     0     0 6131.38899    0  360 -9070.6754 6131.38899   168%     -   51s
     0     0 6131.38899    0  363 -9070.6754 6131.38899   168%     -   52s
     0     0 6131.38899    0  361 -9070.6754 6131.38899   168%     -   52s
     0     0 6131.38899    0  453 -9070.6754 6131.38899   168%     -   53s
     0     0 6131.38899    0  453 -9070.6754 6131.38899   168%     -   53s
     0     0 3992.12060    0  480 -9070.6754 3992.12060   144%     -   60s
     0     0 3738.30008    0  604 -9070.6754 3738.30008   141%     -   64s
     0     0 3582.32041    0  592 -9070.6754 3582.32041   139%     -   67s
     0     0 3474.92467    0  593 -9070.6754 3474.92467   138%     -   69s
     0     0 3469.32793    0  592 -9070.6754 3469.32793   138%     -   70s
     0     0 3421.12963    0  597 -9070.6754 3421.12963   138%     -   71s
     0     0 3418.21962    0  594 -9070.6754 3418.21962   138%     -   71s
     0     0 3398.97529    0  587 -9070.6754 3398.97529   137%     -   71s
     0     0 3394.65483    0  598 -9070.6754 3394.65483   137%     -   72s
     0     0 3388.90527    0  540 -9070.6754 3388.90527   137%     -   72s
     0     0 3387.99148    0  539 -9070.6754 3387.99148   137%     -   73s
     0     0 3387.22977    0  541 -9070.6754 3387.22977   137%     -   73s
     0     0 3387.20885    0  541 -9070.6754 3387.20885   137%     -   73s
H    0     0                    -9018.673397 3387.20885   138%     -   77s
H    0     0                    -8974.050906 2210.65188   125%     -   84s
     0     0 2210.65188    0  515 -8974.0509 2210.65188   125%     -   84s
H    0     0                    -8962.253561 2210.22262   125%     -   84s
H    0     0                    -8959.936593 2210.22262   125%     -   84s
H    0     0                    -8958.325593 2210.22262   125%     -   84s
     0     0 1736.12631    0  539 -8958.3256 1736.12631   119%     -   93s
     0     0 1600.31775    0  525 -8958.3256 1600.31775   118%     -   98s
     0     0 1434.04192    0  534 -8958.3256 1434.04192   116%     -  102s
     0     0 1326.69937    0  541 -8958.3256 1326.69937   115%     -  104s
     0     0 1319.58348    0  546 -8958.3256 1319.58348   115%     -  105s
     0     0 1303.60633    0  544 -8958.3256 1303.60633   115%     -  107s
     0     0 1296.41411    0  550 -8958.3256 1296.41411   114%     -  108s
     0     0 1281.56280    0  551 -8958.3256 1281.56280   114%     -  108s
     0     0 1281.35294    0  553 -8958.3256 1281.35294   114%     -  109s
     0     0  940.30898    0  559 -8958.3256  940.30898   110%     -  117s
     0     0  771.98668    0  554 -8958.3256  771.98668   109%     -  121s
     0     0  689.89788    0  561 -8958.3256  689.89788   108%     -  124s
     0     0  664.97663    0  558 -8958.3256  664.97663   107%     -  125s
     0     0  644.11891    0  564 -8958.3256  644.11891   107%     -  126s
     0     0  633.67426    0  556 -8958.3256  633.67426   107%     -  127s
     0     0  626.89901    0  571 -8958.3256  626.89901   107%     -  128s
     0     0  623.91579    0  576 -8958.3256  623.91579   107%     -  128s
     0     0  623.67172    0  573 -8958.3256  623.67172   107%     -  128s
     0     0  512.23344    0  569 -8958.3256  512.23344   106%     -  132s
     0     0  483.46110    0  632 -8958.3256  483.46110   105%     -  135s
     0     0  475.64938    0  632 -8958.3256  475.64938   105%     -  136s
     0     0  470.51270    0  635 -8958.3256  470.51270   105%     -  136s
     0     0  468.91624    0  637 -8958.3256  468.91624   105%     -  137s
     0     0  463.24517    0  640 -8958.3256  463.24517   105%     -  137s
     0     0  462.25106    0  641 -8958.3256  462.25106   105%     -  137s
     0     0  312.14192    0  579 -8958.3256  312.14192   103%     -  143s
H    0     0                    -8934.714686  312.10234   103%     -  145s
H    0     0                    -8929.302507  312.10234   103%     -  145s
H    0     0                    -8914.856380  294.60258   103%     -  147s
H    0     0                    -8912.516424  294.60258   103%     -  147s
H    0     0                    -8906.778228  294.60258   103%     -  147s
     0     0  294.60258    0  582 -8906.7782  294.60258   103%     -  147s
     0     0  285.45650    0  591 -8906.7782  285.45650   103%     -  147s
     0     0  282.71343    0  590 -8906.7782  282.71343   103%     -  148s
     0     0  282.27449    0  590 -8906.7782  282.27449   103%     -  148s
     0     0  256.44363    0  594 -8906.7782  256.44363   103%     -  150s
     0     0  242.92486    0  593 -8906.7782  242.92486   103%     -  152s
     0     0  239.81010    0  592 -8906.7782  239.81010   103%     -  152s
     0     0  237.31181    0  596 -8906.7782  237.31181   103%     -  153s
     0     0  236.31242    0  596 -8906.7782  236.31242   103%     -  153s
     0     0  215.36895    0  606 -8906.7782  215.36895   102%     -  155s
     0     0  206.52987    0  608 -8906.7782  206.52987   102%     -  158s
     0     0  205.32404    0  615 -8906.7782  205.32404   102%     -  159s
     0     0  182.13766    0  610 -8906.7782  182.13766   102%     -  161s
     0     0  177.58117    0  615 -8906.7782  177.58117   102%     -  162s
     0     0  173.64092    0  612 -8906.7782  173.64092   102%     -  163s
     0     0  172.53037    0  696 -8906.7782  172.53037   102%     -  164s
     0     0  163.81879    0  601 -8906.7782  163.81879   102%     -  165s
     0     0  161.05491    0  606 -8906.7782  161.05491   102%     -  167s
     0     0  160.23527    0  604 -8906.7782  160.23527   102%     -  167s
     0     0  148.61914    0  596 -8906.7782  148.61914   102%     -  170s
     0     0  145.59671    0  614 -8906.7782  145.59671   102%     -  171s
     0     0  144.77674    0  610 -8906.7782  144.77674   102%     -  171s
     0     0  142.22001    0  602 -8906.7782  142.22001   102%     -  173s
     0     0  139.99701    0  601 -8906.7782  139.99701   102%     -  174s
     0     0  138.67715    0  605 -8906.7782  138.67715   102%     -  174s
     0     0  133.92516    0  690 -8906.7782  133.92516   102%     -  176s
     0     0  132.57967    0  686 -8906.7782  132.57967   101%     -  177s
     0     0  106.21392    0  685 -8906.7782  106.21392   101%     -  180s
     0     0  103.40898    0  625 -8906.7782  103.40898   101%     -  181s
     0     0  103.12437    0  620 -8906.7782  103.12437   101%     -  181s
     0     0  102.49433    0  613 -8906.7782  102.49433   101%     -  182s
     0     0  101.44207    0  619 -8906.7782  101.44207   101%     -  182s
     0     0   99.25087    0  622 -8906.7782   99.25087   101%     -  183s
     0     0   98.65393    0  617 -8906.7782   98.65393   101%     -  189s
     0     0   96.61871    0  622 -8906.7782   96.61871   101%     -  190s
     0     0   96.50410    0  628 -8906.7782   96.50410   101%     -  191s
     0     0   96.16871    0  634 -8906.7782   96.16871   101%     -  192s
     0     0   95.85291    0  634 -8906.7782   95.85291   101%     -  193s
     0     2   95.41307    0  634 -8906.7782   95.41307   101%     -  222s
     1     3 -546.69632    1  377 -8906.7782   95.24726   101%  4010  226s
     5    12 -906.76405    3  388 -8906.7782  -95.98186  98.9%  3711  234s
    11    24 -1179.4507    4  536 -8906.7782 -140.03898  98.4%  4862  239s
    23    36 -906.79558    4  662 -8906.7782 -234.85886  97.4%  7140  255s
    35    68 -2022.9040    5  573 -8906.7782 -234.85886  97.4%  7069  276s
H   39    68                    -8905.017171 -234.85886  97.4%  6931  276s
    67   164 -2034.8176    6  494 -8905.0172 -366.71431  95.9%  8277  287s
   171   231 -3792.6739    8  358 -8905.0172 -366.76758  95.9%  4524  296s
   260   282 -3618.1334    8  365 -8905.0172 -366.76758  95.9%  3742  305s
   333   307 -3978.1770   10  347 -8905.0172 -366.76758  95.9%  3577  312s
   368   339 -8413.4305   10  139 -8905.0172 -366.76758  95.9%  3722  319s
   414   360 -3945.8532   10  413 -8905.0172 -366.76758  95.9%  3963  328s
   451   387 -6112.7993   11  262 -8905.0172 -366.76758  95.9%  4133  336s
   488   414 -7019.1431   12  253 -8905.0172 -366.76758  95.9%  4341  343s
   525   442 -8840.6337   12  262 -8905.0172 -366.76758  95.9%  4377  350s
   572   460     cutoff   13      -8905.0172 -366.76758  95.9%  4347  358s
   624   488     cutoff   13      -8905.0172 -366.76758  95.9%  4321  366s
   676   513 infeasible   15      -8905.0172 -684.24191  92.3%  4374  375s
   719   534     cutoff   17      -8905.0172 -684.24191  92.3%  4451  382s
   768   567 -6991.3143   16  505 -8905.0172 -684.24191  92.3%  4515  390s
   819   606 -7086.3972   17  496 -8905.0172 -684.24191  92.3%  4578  398s
   882   633 -7103.5008   18  502 -8905.0172 -684.24191  92.3%  4499  405s
   939   674 -7180.0834   20  484 -8905.0172 -684.24191  92.3%  4416  413s
  1025   722 -7526.7805   23  411 -8905.0172 -1137.9145  87.2%  4311  423s
  1117   753 -7674.6712   26  398 -8905.0172 -1137.9145  87.2%  4255  432s
  1192   797 -7680.8651   27  393 -8905.0172 -1137.9145  87.2%  4151  441s
  1298   851 -7728.7274   28  392 -8905.0172 -1137.9145  87.2%  4048  450s
  1426   881 -7930.2944   33  296 -8905.0172 -1205.5779  86.5%  3915  461s
  1556   918 -8067.6635   37  228 -8905.0172 -1300.9823  85.4%  3774  470s
  1659   965     cutoff   12      -8905.0172 -1422.2207  84.0%  3746  478s
  1760  1019 -6101.6574    9  266 -8905.0172 -1422.2207  84.0%  3772  488s
  1877  1079 -7278.7617   11  162 -8905.0172 -1528.4032  82.8%  3745  497s
  2023  1098     cutoff   13      -8905.0172 -1686.4162  81.1%  3719  507s
  2083  1150 -8509.9893    8  175 -8905.0172 -1686.4162  81.1%  3728  516s
  2146  1192     cutoff    9      -8905.0172 -1686.4162  81.1%  3732  527s
  2265  1243 -7110.4830   23  191 -8905.0172 -1686.4162  81.1%  3706  539s
  2407  1301 -7641.9954   24  183 -8905.0172 -1686.4162  81.1%  3632  549s
  2547  1348 -8191.9941   29  351 -8905.0172 -1686.4162  81.1%  3616  561s
  2717  1422 -4681.5086    9  283 -8905.0172 -1850.4025  79.2%  3581  572s
  2887  1490 -6706.6857   12  185 -8905.0172 -1850.4025  79.2%  3590  585s
  3041  1537 -7797.1374   14  287 -8905.0172 -1850.4025  79.2%  3616  598s
  3174  1585 -8661.1132   17  382 -8905.0172 -1850.4025  79.2%  3637  612s
  3323  1651 -7093.3909   14  325 -8905.0172 -1850.4025  79.2%  3665  624s
  3487  1699 -5959.8089   14  326 -8905.0172 -1850.4025  79.2%  3689  638s
  3610  1765 -6899.7687   17  261 -8905.0172 -1850.4025  79.2%  3694  652s
  3800  1835 -8332.5572   22  191 -8905.0172 -2002.6910  77.5%  3690  666s
  4082  1889 -5774.9878   12  354 -8905.0172 -2128.2860  76.1%  3631  682s
  4350  1956 -6528.6225   13  312 -8905.0172 -2186.0310  75.5%  3604  698s
  4563  2067 -8143.5749   17  268 -8905.0172 -2543.7972  71.4%  3617  712s
  4814  2130 -8181.8635   12  230 -8905.0172 -2554.8831  71.3%  3606  729s
  5046  2244 -4570.3695   11  487 -8905.0172 -2567.0534  71.2%  3582  744s
  5295  2245 -4669.8436   11  634 -8905.0172 -2635.0914  70.4%  3586  794s
  5297  2246 -7910.6987   35  323 -8905.0172 -2635.0914  70.4%  3585  824s
  5298  2247 -5916.6996   13  557 -8905.0172 -2635.0914  70.4%  3584  843s
  5299  2248 -8655.0340   25  670 -8905.0172 -2635.0914  70.4%  3584  856s
  5300  2248 -7827.3711   14  547 -8905.0172 -2635.0914  70.4%  3583  864s
  5301  2249 -4698.7122   15  588 -8905.0172 -2635.0914  70.4%  3582  870s
  5302  2250 -8568.7589   22  648 -8905.0172 -2635.0914  70.4%  3582  875s
  5303  2250 -8306.7166   23  631 -8905.0172 -2635.0914  70.4%  3581  880s
  5305  2252 -4377.5915   11  654 -8905.0172 -2635.0914  70.4%  3580  886s
  5308  2254 -6993.6166   16  660 -8905.0172 -2635.0914  70.4%  3578  896s
  5310  2255 -5274.5297    9  648 -8905.0172 -2635.0914  70.4%  3576  902s
  5312  2256 -7839.3842   16  590 -8905.0172 -2635.0914  70.4%  3575  906s
  5313  2257 -7413.7349   16  716 -8905.0172 -2635.0914  70.4%  3574  913s
  5314  2258 -7420.5466   24  652 -8905.0172 -2635.0914  70.4%  3574  915s
  5316  2259 -8310.0065   15  733 -8905.0172 -2635.0914  70.4%  3572  924s
  5317  2260 -7899.4869   18  662 -8905.0172 -2635.0914  70.4%  3572  927s
  5319  2261 -6107.3907   17  678 -8905.0172 -2635.0914  70.4%  3570  935s
  5321  2262 -5915.6600   12  604 -8905.0172 -2635.0914  70.4%  3569  943s
  5322  2263 -3874.4873   10  666 -8905.0172 -2635.0914  70.4%  3568  946s
  5323  2264 -3605.4908   10  654 -8905.0172 -2635.0914  70.4%  3568  952s
  5325  2265 -8022.0089   27  677 -8905.0172 -2635.0914  70.4%  3566  958s
  5326  2266 -6709.4997   13  664 -8905.0172 -2635.0914  70.4%  3566  961s
  5327  2266 -3688.1509   13  725 -8905.0172 -2635.0914  70.4%  3565  965s
  5328  2267 -5559.0742   17  725 -8905.0172 -2635.0914  70.4%  3564  995s
  5329  2268 -8139.6948   23  725 -8905.0172 -2635.0914  70.4%  3564 1024s
  5330  2271 -2635.0914   10  644 -8905.0172 -2635.0914  70.4%  3599 1036s
  5332  2275 -2635.0914   11  633 -8905.0172 -2635.0914  70.4%  3599 1043s
  5336  2281 -2635.0914   12  612 -8905.0172 -2635.0914  70.4%  3602 1057s
  5344  2295 -2635.0914   13  630 -8905.0172 -2635.0914  70.4%  3604 1073s
  5360  2306 -4829.5619   14  375 -8905.0172 -2635.0914  70.4%  3631 1139s
  5378  2324 -3261.6405   15  460 -8905.0172 -2635.0914  70.4%  3659 1150s
  5410  2355 -4445.0461   16  592 -8905.0172 -2635.0914  70.4%  3678 1164s
  5478  2387 -4977.0435   17  585 -8905.0172 -2635.0914  70.4%  3687 1176s
  5576  2382 -6063.7523   19  648 -8905.0172 -2635.0914  70.4%  3691 1187s
  5644  2384 -5647.9856   18  620 -8905.0172 -2635.0914  70.4%  3690 1197s
  5702  2381 -6143.7481   17  578 -8905.0172 -2635.0914  70.4%  3713 1209s
  5768  2373 -7597.6141   19  628 -8905.0172 -2635.0914  70.4%  3714 1223s
  5811  2378 -6571.9523   19  580 -8905.0172 -2635.0914  70.4%  3725 1232s
  5851  2369     cutoff   20      -8905.0172 -2635.0914  70.4%  3733 1241s
  5903  2367     cutoff   26      -8905.0172 -2635.0914  70.4%  3726 1250s
  5961  2361 -6422.5295   21  121 -8905.0172 -2635.0914  70.4%  3707 1258s
  6020  2354 -6829.7297   22  424 -8905.0172 -2635.0914  70.4%  3701 1268s
  6073  2357 -7120.2296   23  412 -8905.0172 -2635.0914  70.4%  3699 1276s
  6145  2357     cutoff   26      -8905.0172 -2635.0914  70.4%  3693 1285s
  6205  2351     cutoff   25      -8905.0172 -2635.0914  70.4%  3690 1299s
  6285  2340 -5181.7302   18  591 -8905.0172 -2635.0914  70.4%  3683 1312s
  6356  2327 -5475.7104   19  627 -8905.0172 -2635.0914  70.4%  3682 1321s
  6423  2323     cutoff   20      -8905.0172 -2635.0914  70.4%  3684 1334s
  6477  2305 -4051.5651   17  657 -8905.0172 -2635.0914  70.4%  3685 1335s
  6497  2326 -5895.3722   20  631 -8905.0172 -2635.0914  70.4%  3688 1345s
  6569  2335 -6113.0219   21  614 -8905.0172 -2635.0914  70.4%  3694 1364s
  6663  2337 -8733.6181   24  383 -8905.0172 -2635.0914  70.4%  3683 1375s
  6759  2321     cutoff   25      -8905.0172 -2635.0914  70.4%  3685 1387s
  6857  2311 -6776.1837   25  690 -8905.0172 -2635.0914  70.4%  3687 1398s
  6996  2278 -7062.5238   27  671 -8905.0172 -2635.0914  70.4%  3667 1409s
  7081  2291     cutoff   30      -8905.0172 -2635.0914  70.4%  3659 1424s
  7189  2285 -7689.1714   30  451 -8905.0172 -2635.0914  70.4%  3656 1436s
  7315  2280 -8510.7463   33  604 -8905.0172 -2635.0914  70.4%  3652 1449s
  7466  2229     cutoff   23      -8905.0172 -2635.0914  70.4%  3635 1463s
  7564  2196 -6673.8523   18  703 -8905.0172 -2635.0914  70.4%  3631 1477s
  7659  2189 -8001.8726   19  631 -8905.0172 -2635.0914  70.4%  3648 1491s
  7800  2143 -8047.8156   20  580 -8905.0172 -2635.0914  70.4%  3641 1505s
  7960  2083     cutoff   24      -8905.0172 -3520.8856  60.5%  3625 1520s
  8122  2020     cutoff   22      -8905.0172 -3521.6120  60.5%  3629 1537s
  8290  1977 -8474.3981   28  399 -8905.0172 -3521.6120  60.5%  3631 1551s
  8334  1971 -8491.3781   29  403 -8905.0172 -3521.6120  60.5%  3642 1565s
  8437  1916     cutoff   32      -8905.0172 -3521.6120  60.5%  3634 1581s
  8583  1874     cutoff   19      -8905.0172 -4991.0338  44.0%  3633 1597s
  8743  1813     cutoff   23      -8905.0172 -4991.0338  44.0%  3632 1615s
  8962  1730 -8719.6493   20  508 -8905.0172 -4991.0338  44.0%  3627 1633s
  9187  1685     cutoff   22      -8905.0172 -5915.0238  33.6%  3611 1655s
  9473  1560     cutoff   24      -8905.0172 -5915.0238  33.6%  3580 1677s
  9812  1438     cutoff   27      -8905.0172 -6215.8765  30.2%  3536 1697s
 10151  1313 -7378.7433   24  598 -8905.0172 -6215.8765  30.2%  3493 1714s
 10525  1130 -7746.5716   27  409 -8905.0172 -6697.0346  24.8%  3445 1734s
 10996   820 -8774.4864   32  527 -8905.0172 -7090.6795  20.4%  3373 1752s
 11559   477 -8453.7575   34  235 -8905.0172 -7421.7079  16.7%  3280 1778s
 12157    83     cutoff   30      -8905.0172 -7652.5959  14.1%  3179 1797s
 12632     7     cutoff   34      -8905.0172 -7878.4495  11.5%  3097 1811s

Cutting planes:
  Learned: 1
  Gomory: 1
  MIR: 639
  Flow cover: 1651
  Zero half: 12
  RLT: 32
  Relax-and-lift: 82

Explored 12804 nodes (39523148 simplex iterations) in 1812.12 seconds (5203.85 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -8905.02 -8906.78 -8912.52 ... -8974.05
No other solutions better than -8905.02

Optimal solution found (tolerance 1.00e-04)
Best objective -8.905017171015e+03, best bound -8.905017171015e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1812.13s
  Master Objective (UB) = -8905.02, θ = 118532.35
  Upper Bound (UB) = -8905.02

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 118532.35
  [DEBUG]   ✓ Scenario 0: θ = 118532.35 ≤ Q = 118532.35 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 118532.35 ≤ Q = 118532.35 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 118532.35 ≤ Q = 118532.35 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 118532.35 ≤ Q = 118532.35 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 118532.35 ≤ Q = 118532.35 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 118532.35 ≤ Q = 118532.35 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x163557c1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x163557c1
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.311291e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 6939907.1923
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.234589e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -123458.89    0  123 6939907.19 -123458.89   102%     -    0s
H    0     0                    -87946.16375 -123458.89  40.4%     -    0s
H    0     0                    -89145.37128 -123458.89  38.5%     -    0s
     0     0 -95396.094    0   46 -89145.371 -95396.094  7.01%     -    0s
H    0     0                    -93384.74267 -95371.805  2.13%     -    0s
H    0     0                    -94248.71997 -95371.805  1.19%     -    0s
     0     0 -95249.952    0   44 -94248.720 -95249.952  1.06%     -    0s
     0     0 -95227.389    0   44 -94248.720 -95227.389  1.04%     -    0s
     0     2 -95227.389    0   44 -94248.720 -95227.389  1.04%     -    0s
H  234   101                    -94288.88554 -94828.320  0.57%   4.1    0s
H  291   158                    -94312.31132 -94828.320  0.55%   3.7    0s
H  311   158                    -94333.77440 -94828.320  0.52%   3.8    0s

Cutting planes:
  Gomory: 17
  Implied bound: 11
  MIR: 141

Explored 3683 nodes (13297 simplex iterations) in 0.23 seconds (0.13 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -94333.8 -94312.3 -94288.9 ... 1.31129e+13
No other solutions better than -94333.8

Optimal solution found (tolerance 1.00e-04)
Best objective -9.433377439760e+04, best bound -9.433377439760e+04, gap 0.0000%
  Subproblem solved in 0.25s
  Worst-case operational profit (Z_SP) = 115641.74
  Scenario: 17 demand increases, 43 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -94333.77
  [DEBUG]   S×d_nominal = 209975.52
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 209975.52 + -94333.77 = 115641.74
  [DEBUG]   Current θ from Master = 118532.35
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2890.61 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -11795.62
  Lower Bound (LB) = -10011.25
  Gap (UB-LB) = 1106.2374, Absolute Gap = 1106.2374, Relative Gap = 0.124226
  Not converged yet (gap = 1106.24 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 17 increases, 43 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308199 nonzeros
Model fingerprint: 0x00e45cd8
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 47509 rows and 19299 columns
Presolve time: 0.97s
Presolved: 60904 rows, 26641 columns, 379004 nonzeros
Variable types: 24382 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -409717.4995
Found heuristic solution: objective -226690.3294

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 60904 rows, 26641 columns, 379004 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   28896   -2.0956174e+04   0.000000e+00   3.881198e+07      5s
   39674   -5.6479196e+02   0.000000e+00   7.679221e+06     10s
   47904    3.6702707e+03   0.000000e+00   2.673301e+06     15s
   55249    4.6819224e+03   0.000000e+00   1.604959e+06     20s
   62103    5.9000030e+03   0.000000e+00   3.775656e+07     25s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 1.027470e+04, 54148 iterations, 27.88 seconds (58.36 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 10274.7043    0  327 -226690.33 10274.7043   105%     -   29s
H    0     0                    -217296.4619 10274.7043   105%     -   29s
H    0     0                    -84324.92097 10274.7043   112%     -   29s
H    0     0                    -75487.83435 10274.7043   114%     -   29s
H    0     0                    -75468.77266 10274.7043   114%     -   29s
H    0     0                    -67827.69264 10274.7043   115%     -   29s
H    0     0                    -23287.49821 10274.7043   144%     -   29s
H    0     0                    -15756.42485 10274.7043   165%     -   29s
H    0     0                    -14802.50820 10274.7043   169%     -   29s
H    0     0                    -14017.55461 6419.05314   146%     -   40s
H    0     0                    -9131.574717 6419.05314   170%     -   40s
H    0     0                    -9093.235112 6419.05314   171%     -   40s
     0     0 6419.05314    0  444 -9093.2351 6419.05314   171%     -   40s
     0     0 5995.38059    0  448 -9093.2351 5995.38059   166%     -   45s
     0     0 5995.38059    0  452 -9093.2351 5995.38059   166%     -   46s
     0     0 5995.38059    0  438 -9093.2351 5995.38059   166%     -   48s
     0     0 5995.38059    0  438 -9093.2351 5995.38059   166%     -   49s
     0     0 3777.95805    0  582 -9093.2351 3777.95805   142%     -   60s
H    0     0                    -9090.895155 3777.95805   142%     -   60s
     0     0 3331.61471    0  578 -9090.8952 3331.61471   137%     -   64s
     0     0 3182.01531    0  577 -9090.8952 3182.01531   135%     -   68s
     0     0 3147.63494    0  590 -9090.8952 3147.63494   135%     -   69s
     0     0 3084.90724    0  585 -9090.8952 3084.90724   134%     -   70s
     0     0 3071.98541    0  580 -9090.8952 3071.98541   134%     -   70s
     0     0 3052.73812    0  586 -9090.8952 3052.73812   134%     -   71s
     0     0 3001.92655    0  591 -9090.8952 3001.92655   133%     -   72s
     0     0 3000.70976    0  589 -9090.8952 3000.70976   133%     -   72s
     0     0 2994.29559    0  582 -9090.8952 2994.29559   133%     -   72s
     0     0 2992.18981    0  584 -9090.8952 2992.18981   133%     -   73s
     0     0 2992.16829    0  584 -9090.8952 2992.16829   133%     -   73s
H    0     0                    -8998.950526 1845.11706   121%     -   86s
H    0     0                    -8992.697629 1845.11706   121%     -   86s
     0     0 1845.11706    0  469 -8992.6976 1845.11706   121%     -   86s
     0     0 1554.91407    0  471 -8992.6976 1554.91407   117%     -   90s
     0     0 1458.67766    0  492 -8992.6976 1458.67766   116%     -   93s
     0     0 1427.60637    0  499 -8992.6976 1427.60637   116%     -   94s
     0     0 1420.01225    0  502 -8992.6976 1420.01225   116%     -   95s
     0     0 1402.29949    0  499 -8992.6976 1402.29949   116%     -   95s
     0     0 1372.71298    0  499 -8992.6976 1372.71298   115%     -   96s
     0     0 1363.05901    0  505 -8992.6976 1363.05901   115%     -   97s
     0     0 1350.40185    0  505 -8992.6976 1350.40185   115%     -   98s
     0     0 1342.84338    0  502 -8992.6976 1342.84338   115%     -   99s
     0     0 1339.68118    0  506 -8992.6976 1339.68118   115%     -   99s
     0     0 1339.10446    0  512 -8992.6976 1339.10446   115%     -   99s
H    0     0                    -8990.357673 1339.10446   115%     -  102s
     0     0  989.79316    0  510 -8990.3577  989.79316   111%     -  110s
     0     0  882.07148    0  522 -8990.3577  882.07148   110%     -  112s
     0     0  808.58502    0  520 -8990.3577  808.58502   109%     -  114s
     0     0  802.08916    0  534 -8990.3577  802.08916   109%     -  114s
     0     0  797.65470    0  540 -8990.3577  797.65470   109%     -  115s
     0     0  795.48554    0  539 -8990.3577  795.48554   109%     -  116s
     0     0  795.07674    0  543 -8990.3577  795.07674   109%     -  116s
     0     0  715.45925    0  545 -8990.3577  715.45925   108%     -  119s
     0     0  673.30630    0  543 -8990.3577  673.30630   107%     -  120s
     0     0  658.70041    0  554 -8990.3577  658.70041   107%     -  121s
     0     0  652.96335    0  560 -8990.3577  652.96335   107%     -  122s
     0     0  652.21416    0  559 -8990.3577  652.21416   107%     -  123s
     0     0  619.65388    0  558 -8990.3577  619.65388   107%     -  125s
     0     0  596.36744    0  550 -8990.3577  596.36744   107%     -  128s
     0     0  593.36134    0  558 -8990.3577  593.36134   107%     -  129s
     0     0  590.53335    0  562 -8990.3577  590.53335   107%     -  129s
     0     0  589.41008    0  558 -8990.3577  589.41008   107%     -  129s
     0     0  468.65736    0  626 -8990.3577  468.65736   105%     -  134s
     0     0  454.05304    0  557 -8990.3577  454.05304   105%     -  136s
     0     0  438.26056    0  558 -8990.3577  438.26056   105%     -  137s
     0     0  433.47417    0  564 -8990.3577  433.47417   105%     -  138s
     0     0  431.57030    0  566 -8990.3577  431.57030   105%     -  138s
     0     0  431.21901    0  569 -8990.3577  431.21901   105%     -  138s
     0     0  391.70981    0  563 -8990.3577  391.70981   104%     -  142s
     0     0  376.02216    0  627 -8990.3577  376.02216   104%     -  145s
     0     0  368.40910    0  549 -8990.3577  368.40910   104%     -  146s
     0     0  366.65476    0  556 -8990.3577  366.65476   104%     -  146s
     0     0  365.36877    0  546 -8990.3577  365.36877   104%     -  146s
     0     0  322.81040    0  566 -8990.3577  322.81040   104%     -  149s
     0     0  316.18498    0  559 -8990.3577  316.18498   104%     -  151s
     0     0  311.16096    0  576 -8990.3577  311.16096   103%     -  152s
     0     0  310.81633    0  573 -8990.3577  310.81633   103%     -  152s
     0     0  289.82983    0  563 -8990.3577  289.82983   103%     -  154s
     0     0  287.86307    0  569 -8990.3577  287.86307   103%     -  156s
     0     0  284.38240    0  581 -8990.3577  284.38240   103%     -  157s
     0     0  283.72975    0  581 -8990.3577  283.72975   103%     -  157s
     0     0  273.14931    0  555 -8990.3577  273.14931   103%     -  159s
     0     0  270.64412    0  558 -8990.3577  270.64412   103%     -  160s
     0     0  269.61684    0  557 -8990.3577  269.61684   103%     -  161s
     0     0  265.55630    0  570 -8990.3577  265.55630   103%     -  162s
     0     0  260.51209    0  579 -8990.3577  260.51209   103%     -  174s
     0     0  260.05083    0  578 -8990.3577  260.05083   103%     -  175s
     0     0  253.60150    0  568 -8990.3577  253.60150   103%     -  176s
     0     0  252.45090    0  575 -8990.3577  252.45090   103%     -  176s
     0     0  247.10724    0  580 -8990.3577  247.10724   103%     -  178s
     0     0  246.79685    0  580 -8990.3577  246.79685   103%     -  180s
     0     2  246.75913    0  580 -8990.3577  246.75913   103%     -  230s
     3     8   66.20691    2  582 -8990.3577   96.33585   101%  3991  241s
     7    16  -57.49715    3  699 -8990.3577   66.16567   101%  5029  246s
    15    32 -113.66695    4  699 -8990.3577  -57.75153  99.4%  5559  258s
    31    48 -861.32262    5  548 -8990.3577 -115.96942  98.7%  8046  275s
    47    80 -958.24013    6  516 -8990.3577 -115.96942  98.7%  7582  285s
    79   146 -998.05656    7  524 -8990.3577 -115.96942  98.7%  6231  302s
   145   267 -1133.0148    9  502 -8990.3577 -115.96942  98.7%  4258  313s
   266   372 -1180.7812   10  494 -8990.3577 -115.96942  98.7%  3153  320s
   385   417 -1210.7362   10  474 -8990.3577 -115.96942  98.7%  2608  328s
   475   425 -1364.0776    9  364 -8990.3577 -115.96942  98.7%  2292  336s
   564   441 -1409.3368    9  361 -8990.3577 -115.96942  98.7%  2153  343s
   602   466 -1304.8179   11  475 -8990.3577 -115.96942  98.7%  2184  350s
   641   480 -2111.9983   12  449 -8990.3577 -115.96942  98.7%  2242  357s
   679   506 -2491.5422   12  352 -8990.3577 -115.96942  98.7%  2259  364s
   718   524 -3681.0709   13  363 -8990.3577 -115.96942  98.7%  2307  371s
   750   539 -3177.6137   13  419 -8990.3577 -115.96942  98.7%  2327  378s
   787   558 -3419.4085   14  279 -8990.3577 -115.96942  98.7%  2341  386s
   828   582 -3532.6866   15  346 -8990.3577 -115.96942  98.7%  2334  393s
   868   601 -4300.8397   16  245 -8990.3577 -115.96942  98.7%  2353  401s
   921   622     cutoff   16      -8990.3577 -115.96942  98.7%  2334  408s
   974   655 -5055.4388   17  165 -8990.3577 -115.96942  98.7%  2314  415s
  1021   687 -4464.0055   18  310 -8990.3577 -115.96942  98.7%  2289  423s
  1081   713 -4726.5075   19  257 -8990.3577 -115.96942  98.7%  2267  431s
  1147   754 -6635.7182   19  177 -8990.3577 -115.96942  98.7%  2250  439s
  1234   788 -4738.7559   20  253 -8990.3577 -115.96942  98.7%  2196  448s
  1300   841 -5264.8760   21  247 -8990.3577 -115.96942  98.7%  2193  458s
  1381   899 -5432.7208   22  272 -8990.3577 -115.96942  98.7%  2174  467s
  1477   951     cutoff   23      -8990.3577 -115.96942  98.7%  2138  477s
  1597  1000 -6567.0327   25  218 -8990.3577 -115.96942  98.7%  2087  487s
  1719  1050 -6425.8090   28  250 -8990.3577 -115.96942  98.7%  2052  497s
  1867  1116 -7261.9434   29  253 -8990.3577 -317.74436  96.5%  1989  506s
  2017  1165 -7166.1353   30  241 -8990.3577 -317.74436  96.5%  1960  517s
  2146  1241 -7752.6157   36  226 -8990.3577 -317.74436  96.5%  1968  528s
  2308  1321 -8127.0781   38  224 -8990.3577 -317.74436  96.5%  1955  539s
  2475  1389     cutoff   41      -8990.3577 -1179.5739  86.9%  1938  550s
  2618  1445 -2787.9892    8  562 -8990.3577 -1179.5739  86.9%  1938  561s
  2779  1515 -4281.9844    9  473 -8990.3577 -1271.5744  85.9%  1940  575s
  2934  1588 -4987.5091   10  440 -8990.3577 -1271.5744  85.9%  1940  588s
  3095  1646 -6024.9634   14  432 -8990.3577 -1271.5744  85.9%  1937  601s
  3299  1703 -7992.0979   20  505 -8990.3577 -1421.5572  84.2%  1928  615s
  3446  1763     cutoff   22      -8990.3577 -1501.1315  83.3%  1954  630s
  3588  1844 -3365.6045   12  483 -8990.3577 -1503.8225  83.3%  1982  644s
  3781  1892 -6624.7953   14  465 -8990.3577 -1562.3399  82.6%  1980  660s
  3978  1956 -7763.4523   16  423 -8990.3577 -1562.3399  82.6%  1984  676s
  4168  2017 -5323.4581    8  643 -8990.3577 -1661.5364  81.5%  1999  690s
  4342  2065 -5890.3621    9  575 -8990.3577 -1661.5364  81.5%  1990  707s
  4472  2145 -8831.7953   10  309 -8990.3577 -1781.6411  80.2%  2015  729s
  4641  2194     cutoff   11      -8990.3577 -1781.6411  80.2%  2033  747s
  4835  2257 -6820.8166   10  387 -8990.3577 -2064.0445  77.0%  2057  766s
  5022  2363 -8129.0764   13  360 -8990.3577 -2143.2350  76.2%  2067  784s
  5275  2364 -4172.3948   13  580 -8990.3577 -2207.9245  75.4%  2067  836s
  5277  2365 -7345.5027   23  327 -8990.3577 -2207.9245  75.4%  2067  878s
  5278  2366 -8010.5434   24  473 -8990.3577 -2207.9245  75.4%  2066  899s
  5279  2367 -5809.3073   18  524 -8990.3577 -2207.9245  75.4%  2066  913s
  5280  2367 -7739.3080   22  666 -8990.3577 -2207.9245  75.4%  2065  922s
  5281  2368 -5964.8797   10  543 -8990.3577 -2207.9245  75.4%  2065  930s
  5283  2369 -5709.2893   14  564 -8990.3577 -2207.9245  75.4%  2064  938s
  5284  2370 -7001.6226   13  634 -8990.3577 -2207.9245  75.4%  2064  941s
  5286  2371 -2947.1473   12  586 -8990.3577 -2207.9245  75.4%  2063  945s
  5287  2372 -8792.8847   30  635 -8990.3577 -2207.9245  75.4%  2063  953s
  5288  2373 -2868.8020   11  635 -8990.3577 -2207.9245  75.4%  2062  957s
  5290  2374 -4710.5059   16  629 -8990.3577 -2207.9245  75.4%  2061  960s
  5293  2376 -8084.9104   34  633 -8990.3577 -2207.9245  75.4%  2060  965s
  5295  2377 -2624.4895   10  638 -8990.3577 -2207.9245  75.4%  2060  976s
  5297  2379 -7751.5564   18  783 -8990.3577 -2207.9245  75.4%  2059  982s
  5298  2379 -8354.6127   20  708 -8990.3577 -2207.9245  75.4%  2058  985s
  5299  2380 -7469.3025   19  666 -8990.3577 -2207.9245  75.4%  2058  991s
  5301  2381 -6721.8021   19  673 -8990.3577 -2207.9245  75.4%  2057  996s
  5302  2382 -6010.4895   18  655 -8990.3577 -2207.9245  75.4%  2057 1003s
  5303  2383 -4003.5038   13  802 -8990.3577 -2207.9245  75.4%  2056 1007s
  5304  2383 -4785.2869   17  745 -8990.3577 -2207.9245  75.4%  2056 1013s
  5305  2384 -4868.8413   13  591 -8990.3577 -2207.9245  75.4%  2056 1017s
  5306  2385 -7244.2111   11  584 -8990.3577 -2207.9245  75.4%  2055 1021s
  5308  2386 -8744.9839   31  678 -8990.3577 -2207.9245  75.4%  2055 1028s
  5309  2387 -8716.5863   22  678 -8990.3577 -2207.9245  75.4%  2054 1031s
  5310  2387 -3089.7949   12  667 -8990.3577 -2207.9245  75.4%  2054 1035s
  5312  2389 -6286.3337   11  660 -8990.3577 -2207.9245  75.4%  2053 1042s
  5313  2389 -6324.5985   17  660 -8990.3577 -2207.9245  75.4%  2053 1107s
  5314  2390 -4681.6328   11  660 -8990.3577 -2207.9245  75.4%  2052 1136s
  5315  2394 -2207.9245   16  723 -8990.3577 -2207.9245  75.4%  2092 1160s
  5317  2397 -2207.9245   17  713 -8990.3577 -2207.9245  75.4%  2092 1170s
  5321  2404 -2207.9245   18  714 -8990.3577 -2207.9245  75.4%  2097 1183s
  5329  2417 -2207.9245   19  769 -8990.3577 -2207.9245  75.4%  2103 1198s
  5345  2431 -4886.8606   20  244 -8990.3577 -2207.9245  75.4%  2134 1222s
  5365  2453 -5307.3027   21  272 -8990.3577 -2207.9245  75.4%  2160 1235s
  5397  2522 -5370.4041   22  260 -8990.3577 -2207.9245  75.4%  2178 1252s
  5519  2499 -7864.6744   26  250 -8990.3577 -2207.9245  75.4%  2183 1261s
  5609  2469 -7467.9756   24  273 -8990.3577 -2207.9245  75.4%  2178 1271s
  5658  2475 -8050.1278   27  218 -8990.3577 -2207.9245  75.4%  2179 1279s
  5713  2475 -8950.1590   27  240 -8990.3577 -2207.9245  75.4%  2185 1289s
  5764  2470 -8353.7015   28  226 -8990.3577 -2207.9245  75.4%  2193 1298s
  5819  2465     cutoff   28      -8990.3577 -2207.9245  75.4%  2197 1306s
  5860  2471 -6895.8115   25  526 -8990.3577 -2207.9245  75.4%  2200 1314s
  5904  2463 -6959.2403   26  500 -8990.3577 -2207.9245  75.4%  2201 1323s
  5951  2459     cutoff   27      -8990.3577 -2207.9245  75.4%  2202 1334s
  6001  2457     cutoff   28      -8990.3577 -2207.9245  75.4%  2204 1343s
  6060  2450     cutoff   29      -8990.3577 -2207.9245  75.4%  2203 1352s
  6116  2460 -4801.3071   25  411 -8990.3577 -2207.9245  75.4%  2205 1362s
  6187  2448 -5071.5220   26  468 -8990.3577 -2207.9245  75.4%  2203 1374s
  6254  2443 -5892.1317   27  353 -8990.3577 -2207.9245  75.4%  2199 1392s
  6313  2442 -6533.8751   28  332 -8990.3577 -2207.9245  75.4%  2202 1401s
  6359  2435 -6770.8600   29  315 -8990.3577 -2207.9245  75.4%  2207 1410s
  6399  2442 -6961.0619   30  241 -8990.3577 -2207.9245  75.4%  2212 1420s
  6452  2445 -7061.7431   31  316 -8990.3577 -2207.9245  75.4%  2212 1430s
  6522  2449 -7375.0166   32  255 -8990.3577 -2207.9245  75.4%  2212 1443s
  6608  2429 -7745.7239   33  234 -8990.3577 -2207.9245  75.4%  2212 1456s
  6692  2422 -8658.4227   35  107 -8990.3577 -2207.9245  75.4%  2216 1467s
  6768  2404 -8046.4236   30  264 -8990.3577 -2207.9245  75.4%  2217 1479s
  6851  2390 infeasible   31      -8990.3577 -2207.9245  75.4%  2217 1492s
  6946  2389 -6197.6648   29  488 -8990.3577 -2207.9245  75.4%  2225 1505s
  7054  2384 -6857.7219   31  470 -8990.3577 -2675.9662  70.2%  2228 1518s
  7175  2396     cutoff   34      -8990.3577 -2675.9662  70.2%  2221 1531s
  7292  2361 -7910.7024   35  204 -8990.3577 -2675.9662  70.2%  2225 1543s
  7341  2355 -8060.4480   36  143 -8990.3577 -2675.9662  70.2%  2232 1557s
  7414  2348     cutoff   37      -8990.3577 -2675.9662  70.2%  2236 1570s
  7497  2343 -5993.7539   24  552 -8990.3577 -2675.9662  70.2%  2244 1585s
  7610  2352 -7058.7426   25  483 -8990.3577 -2675.9662  70.2%  2241 1600s
  7735  2308 -6562.2247   24  453 -8990.3577 -4241.1556  52.8%  2250 1623s
  7903  2262 -8682.7467   26  357 -8990.3577 -4241.1556  52.8%  2249 1643s
  8044  2230     cutoff   27      -8990.3577 -4241.1556  52.8%  2258 1660s
  8204  2168 -8751.0651   32  366 -8990.3577 -4241.1556  52.8%  2265 1677s
  8397  2122 infeasible   38      -8990.3577 -5275.8816  41.3%  2265 1695s
  8583  2067     cutoff   27      -8990.3577 -5453.7111  39.3%  2270 1715s
  8781  1971 -7882.5428   24  297 -8990.3577 -5509.1733  38.7%  2274 1738s
  9030  1850 infeasible   23      -8990.3577 -5870.0283  34.7%  2273 1756s
  9290  1726 -8923.7776   42   84 -8990.3577 -5929.3045  34.0%  2270 1777s
  9576  1583     cutoff   31      -8990.3577 -6244.9926  30.5%  2257 1796s
  9674  1527     cutoff   30      -8990.3577 -6244.9926  30.5%  2259 1815s
  9757  1449 -8759.4142   37   99 -8990.3577 -6458.4364  28.2%  2259 1834s
  9900  1300 infeasible   38      -8990.3577 -6458.4364  28.2%  2252 1857s
 10088  1181 -7889.8855   31  447 -8990.3577 -6458.4364  28.2%  2237 1878s
 10294   970     cutoff   32      -8990.3577 -6934.7353  22.9%  2220 1897s
 10620   695 infeasible   35      -8990.3577 -7126.7966  20.7%  2191 1919s
 10968   507 -8901.4536   23  232 -8990.3577 -7282.9838  19.0%  2150 1935s

Cutting planes:
  Learned: 2
  MIR: 659
  Flow cover: 1704
  Zero half: 13
  RLT: 26
  Relax-and-lift: 99

Explored 11125 nodes (23924160 simplex iterations) in 1937.37 seconds (5367.52 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -8990.36 -8992.7 -8998.95 ... -23287.5
No other solutions better than -8990.36

Optimal solution found (tolerance 1.00e-04)
Best objective -8.990357673137e+03, best bound -8.990357673137e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1937.44s
  Master Objective (UB) = -8990.36, θ = 118067.80
  Upper Bound (UB) = -8990.36

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 118067.80
  [DEBUG]   ✓ Scenario 0: θ = 118067.80 ≤ Q = 118067.80 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 118067.80 ≤ Q = 118067.80 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 118067.80 ≤ Q = 118067.80 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 118067.80 ≤ Q = 118067.80 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 118067.80 ≤ Q = 118067.80 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 118067.80 ≤ Q = 118067.80 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 118067.80 ≤ Q = 118067.80 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x2453800a
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x2453800a
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.307725e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 6912950.1954
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.234900e+05, 245 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -123490.01    0  123 6912950.20 -123490.01   102%     -    0s
H    0     0                    -88054.89868 -123490.01  40.2%     -    0s
H    0     0                    -89385.02407 -123490.01  38.2%     -    0s
     0     0 -93626.083    0   88 -89385.024 -93626.083  4.74%     -    0s
H    0     0                    -91455.58074 -93586.423  2.33%     -    0s
     0     0 -93380.173    0   88 -91455.581 -93380.173  2.10%     -    0s
H    0     0                    -91790.85665 -93326.365  1.67%     -    0s
     0     0 -93300.683    0   88 -91790.857 -93300.683  1.64%     -    0s
     0     0 -93217.019    0   88 -91790.857 -93217.019  1.55%     -    0s
     0     0 -93212.870    0   88 -91790.857 -93212.870  1.55%     -    0s
     0     2 -93212.870    0   88 -91790.857 -93212.870  1.55%     -    0s
H   36    64                    -91823.43659 -92858.129  1.13%  12.1    0s
H   45    64                    -91977.35823 -92858.129  0.96%  11.6    0s
H  418   379                    -92052.82063 -92824.806  0.84%   4.6    0s
H  423   379                    -92089.64945 -92824.806  0.80%   4.6    0s
H  438   379                    -92144.02693 -92824.806  0.74%   4.6    0s
H  463   379                    -92146.66719 -92824.806  0.74%   4.5    0s
H  528   379                    -92183.42394 -92824.806  0.70%   4.4    0s
H  941   552                    -92225.88342 -92824.806  0.65%   4.0    0s
H  965   552                    -92237.80137 -92824.806  0.64%   4.0    0s
H  977   552                    -92240.23074 -92824.806  0.63%   4.0    0s
H 2481   684                    -92244.97982 -92456.083  0.23%   4.1    0s
* 2617   684              30    -92270.74236 -92449.911  0.19%   4.2    0s
* 2788   584              29    -92273.52885 -92439.483  0.18%   4.2    0s
* 3816   211              25    -92282.69022 -92366.722  0.09%   4.3    0s

Cutting planes:
  Gomory: 20
  Implied bound: 4
  MIR: 182

Explored 4235 nodes (17898 simplex iterations) in 0.12 seconds (0.14 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -92282.7 -92273.5 -92270.7 ... -92144
No other solutions better than -92282.7

Optimal solution found (tolerance 1.00e-04)
Best objective -9.228269022331e+04, best bound -9.228269022331e+04, gap 0.0000%
  Subproblem solved in 0.14s
  Worst-case operational profit (Z_SP) = 117349.44
  Scenario: 16 demand increases, 44 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -92282.69
  [DEBUG]   S×d_nominal = 209632.13
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 209632.13 + -92282.69 = 117349.44
  [DEBUG]   Current θ from Master = 118067.80
  [DEBUG]   ⚠️  Z_SP ≤ θ by 718.36 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -9708.72
  Lower Bound (LB) = -9708.72
  Gap (UB-LB) = 718.3619, Absolute Gap = 718.3619, Relative Gap = 0.079904
  Not converged yet (gap = 718.36 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 16 increases, 44 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351439 nonzeros
Model fingerprint: 0x98a2aca4
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 54296 rows and 22056 columns
Presolve time: 1.10s
Presolved: 69407 rows, 30124 columns, 432359 nonzeros
Variable types: 27865 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -409717.4995
Found heuristic solution: objective -226690.3294

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 69407 rows, 30124 columns, 432359 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   31990   -5.8602496e+04   0.000000e+00   3.208679e+07      5s
   42291   -1.8312312e+04   0.000000e+00   2.314863e+06     10s
   48530   -1.5231682e+04   0.000000e+00   9.150557e+06     15s
   56165   -7.8536022e+03   0.000000e+00   7.445193e+05     20s
   60997   -7.8160080e+03   0.000000e+00   3.768010e+06     25s
   66246   -7.2370194e+03   0.000000e+00   6.198459e+06     30s
   70927   -7.1826247e+03   0.000000e+00   2.996453e+07     35s
   76061   -1.0829640e+02   0.000000e+00   2.321950e+07     40s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 1.025231e+04, 67039 iterations, 42.42 seconds (88.70 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 10252.3108    0  327 -226690.33 10252.3108   105%     -   44s
H    0     0                    -210558.3658 10252.3108   105%     -   44s
H    0     0                    -137909.8248 10252.3108   107%     -   44s
H    0     0                    -136193.7042 10252.3108   108%     -   44s
H    0     0                    -108169.7794 10252.3108   109%     -   44s
H    0     0                    -105343.6024 10252.3108   110%     -   44s
H    0     0                    -67897.32950 10252.3108   115%     -   44s
H    0     0                    -19236.31650 10252.3108   153%     -   44s
H    0     0                    -18025.75385 10252.3108   157%     -   44s
H    0     0                    -15569.37713 10252.3108   166%     -   44s
H    0     0                    -14802.50820 10252.3108   169%     -   44s
H    0     0                    -9366.678081 6328.04125   168%     -   66s
H    0     0                    -9086.982215 6328.04125   170%     -   66s
     0     0 5968.52350    0  440 -9086.9822 5968.52350   166%     -   66s
     0     0 5968.52350    0  427 -9086.9822 5968.52350   166%     -   73s
     0     0 5968.52350    0  426 -9086.9822 5968.52350   166%     -   73s
     0     0 4480.24701    0  426 -9086.9822 4480.24701   149%     -   73s
     0     0 4480.24701    0  426 -9086.9822 4480.24701   149%     -   74s
     0     0 4212.48036    0  582 -9086.9822 4212.48036   146%     -   85s
     0     0 3675.86231    0  608 -9086.9822 3675.86231   140%     -   91s
     0     0 3550.56484    0  593 -9086.9822 3550.56484   139%     -   93s
     0     0 3502.16921    0  592 -9086.9822 3502.16921   139%     -   96s
     0     0 3427.35117    0  598 -9086.9822 3427.35117   138%     -   98s
     0     0 3387.27604    0  603 -9086.9822 3387.27604   137%     -  100s
     0     0 3366.11209    0  611 -9086.9822 3366.11209   137%     -  101s
     0     0 3271.62385    0  606 -9086.9822 3271.62385   136%     -  103s
     0     0 3259.95729    0  604 -9086.9822 3259.95729   136%     -  104s
     0     0 3258.44199    0  606 -9086.9822 3258.44199   136%     -  104s
     0     0 3239.11879    0  539 -9086.9822 3239.11879   136%     -  105s
     0     0 3237.76363    0  540 -9086.9822 3237.76363   136%     -  105s
     0     0 3199.45273    0  541 -9086.9822 3199.45273   135%     -  107s
     0     0 3196.03587    0  545 -9086.9822 3196.03587   135%     -  107s
     0     0 3195.12151    0  548 -9086.9822 3195.12151   135%     -  108s
     0     0 3195.12151    0  548 -9086.9822 3195.12151   135%     -  108s
H    0     0                    -9044.699681 2196.78003   124%     -  122s
     0     0 2196.78003    0  523 -9044.6997 2196.78003   124%     -  122s
     0     0 1864.82138    0  528 -9044.6997 1864.82138   121%     -  128s
     0     0 1643.52704    0  439 -9044.6997 1643.52704   118%     -  131s
     0     0 1597.08435    0  509 -9044.6997 1597.08435   118%     -  134s
     0     0 1577.20688    0  514 -9044.6997 1577.20688   117%     -  134s
     0     0 1561.59864    0  518 -9044.6997 1561.59864   117%     -  136s
     0     0 1468.54206    0  537 -9044.6997 1468.54206   116%     -  139s
     0     0 1454.32825    0  535 -9044.6997 1454.32825   116%     -  141s
     0     0 1443.57764    0  536 -9044.6997 1443.57764   116%     -  141s
     0     0 1443.03598    0  538 -9044.6997 1443.03598   116%     -  142s
H    0     0                    -9034.059824 1070.36171   112%     -  154s
     0     0 1070.36171    0  555 -9034.0598 1070.36171   112%     -  154s
     0     0  920.75160    0  550 -9034.0598  920.75160   110%     -  159s
     0     0  871.60516    0  553 -9034.0598  871.60516   110%     -  161s
     0     0  843.57854    0  553 -9034.0598  843.57854   109%     -  163s
     0     0  835.98186    0  560 -9034.0598  835.98186   109%     -  164s
     0     0  833.32450    0  570 -9034.0598  833.32450   109%     -  165s
     0     0  824.41144    0  568 -9034.0598  824.41144   109%     -  166s
     0     0  824.13858    0  570 -9034.0598  824.13858   109%     -  166s
     0     0  721.55767    0  559 -9034.0598  721.55767   108%     -  171s
H    0     0                    -9033.480925  721.08572   108%     -  172s
     0     0  693.67607    0  564 -9033.4809  693.67607   108%     -  174s
     0     0  681.99809    0  564 -9033.4809  681.99809   108%     -  176s
     0     0  675.78552    0  567 -9033.4809  675.78552   107%     -  177s
     0     0  670.27919    0  576 -9033.4809  670.27919   107%     -  177s
     0     0  669.05668    0  576 -9033.4809  669.05668   107%     -  178s
     0     0  668.41587    0  576 -9033.4809  668.41587   107%     -  178s
     0     0  596.07477    0  588 -9033.4809  596.07477   107%     -  182s
     0     0  566.41438    0  579 -9033.4809  566.41438   106%     -  188s
     0     0  551.44973    0  644 -9033.4809  551.44973   106%     -  189s
     0     0  545.35203    0  660 -9033.4809  545.35203   106%     -  190s
     0     0  543.39611    0  599 -9033.4809  543.39611   106%     -  191s
     0     0  543.07015    0  601 -9033.4809  543.07015   106%     -  191s
     0     0  412.14739    0  645 -9033.4809  412.14739   105%     -  197s
     0     0  401.92475    0  662 -9033.4809  401.92475   104%     -  199s
     0     0  392.32354    0  665 -9033.4809  392.32354   104%     -  199s
     0     0  388.60623    0  674 -9033.4809  388.60623   104%     -  201s
     0     0  378.73319    0  671 -9033.4809  378.73319   104%     -  201s
     0     0  378.19528    0  671 -9033.4809  378.19528   104%     -  202s
     0     0  316.28461    0  665 -9033.4809  316.28461   104%     -  206s
     0     0  305.22278    0  672 -9033.4809  305.22278   103%     -  213s
     0     0  302.98121    0  611 -9033.4809  302.98121   103%     -  214s
     0     0  296.22122    0  605 -9033.4809  296.22122   103%     -  215s
     0     0  294.07092    0  609 -9033.4809  294.07092   103%     -  216s
     0     0  292.87973    0  606 -9033.4809  292.87973   103%     -  217s
     0     0  248.32034    0  669 -9033.4809  248.32034   103%     -  220s
     0     0  241.05379    0  686 -9033.4809  241.05379   103%     -  222s
     0     0  238.80895    0  683 -9033.4809  238.80895   103%     -  223s
     0     0  235.69701    0  675 -9033.4809  235.69701   103%     -  224s
     0     0  235.25891    0  675 -9033.4809  235.25891   103%     -  224s
     0     0  216.43302    0  611 -9033.4809  216.43302   102%     -  226s
     0     0  209.96825    0  616 -9033.4809  209.96825   102%     -  229s
     0     0  208.63646    0  621 -9033.4809  208.63646   102%     -  230s
     0     0  208.22874    0  625 -9033.4809  208.22874   102%     -  230s
     0     0  159.40536    0  605 -9033.4809  159.40536   102%     -  234s
     0     0  150.63545    0  680 -9033.4809  150.63545   102%     -  236s
     0     0  147.48648    0  669 -9033.4809  147.48648   102%     -  237s
     0     0  146.14296    0  611 -9033.4809  146.14296   102%     -  237s
     0     0  145.83059    0  683 -9033.4809  145.83059   102%     -  237s
     0     0  131.27385    0  676 -9033.4809  131.27385   101%     -  240s
     0     0  126.98856    0  680 -9033.4809  126.98856   101%     -  241s
     0     0  125.91375    0  680 -9033.4809  125.91375   101%     -  241s
     0     0  121.60662    0  622 -9033.4809  121.60662   101%     -  243s
     0     0  120.26252    0  617 -9033.4809  120.26252   101%     -  243s
     0     0  115.14946    0  607 -9033.4809  115.14946   101%     -  245s
     0     0  110.34374    0  693 -9033.4809  110.34374   101%     -  247s
     0     0  109.58177    0  622 -9033.4809  109.58177   101%     -  248s
     0     0  108.40644    0  696 -9033.4809  108.40644   101%     -  249s
     0     0  108.01826    0  620 -9033.4809  108.01826   101%     -  250s
     0     0  105.79722    0  622 -9033.4809  105.79722   101%     -  251s
     0     0  105.67467    0  622 -9033.4809  105.67467   101%     -  254s
     0     2  105.67264    0  622 -9033.4809  105.67264   101%     -  326s
     1     4  -10.18867    1  606 -9033.4809  105.61536   101%  3267  330s
     3     8  -66.30881    2  612 -9033.4809  -10.49337   100%  3513  340s
     7    16 -170.66176    3  606 -9033.4809  -67.69210  99.3%  6148  352s
    15    32 -313.55518    4  673 -9033.4809 -171.97722  98.1%  7332  358s
    31    48 -573.51187    5  581 -9033.4809 -313.92189  96.5%  7668  373s
    47    79 -926.96922    6  568 -9033.4809 -313.92189  96.5%  8961  386s
    78   157 -1119.6675    7  473 -9033.4809 -313.92189  96.5%  7050  400s
   156   233 -1210.4843    8  467 -9033.4809 -313.92189  96.5%  4891  409s
   244   288 -1297.3211    9  455 -9033.4809 -313.92189  96.5%  4097  419s
   323   315 -1708.7017   10  442 -9033.4809 -313.92189  96.5%  3656  428s
   384   344 -1940.2835    9  440 -9033.4809 -313.92189  96.5%  3525  437s
   430   364 -3733.7806   10  466 -9033.4809 -313.92189  96.5%  3572  445s
   474   385 -1872.3049   11  426 -9033.4809 -313.92189  96.5%  3724  454s
   517   411 -2713.9271   12  401 -9033.4809 -313.92189  96.5%  3810  463s
   559   442 -3839.6528   13  341 -9033.4809 -313.92189  96.5%  3943  471s
   605   472 -7855.1796   23  273 -9033.4809 -313.92189  96.5%  3892  480s
   653   506 -3535.5562   12  417 -9033.4809 -313.92189  96.5%  3837  489s
   719   545 -4269.9503   14  328 -9033.4809 -313.92189  96.5%  3787  498s
   801   569 -4825.8932   16  250 -9033.4809 -313.92189  96.5%  3697  507s
   835   580 infeasible   15      -9033.4809 -313.92189  96.5%  3787  515s
   884   594 -6468.6201   16  131 -9033.4809 -313.92189  96.5%  3730  524s
   935   617 -5251.3643   18  167 -9033.4809 -313.92189  96.5%  3701  531s
   982   639 -7620.2665   19  120 -9033.4809 -313.92189  96.5%  3719  541s
  1036   662 -7437.2317   18  246 -9033.4809 -313.92189  96.5%  3733  549s
  1079   685 -7468.2452   19  179 -9033.4809 -313.92189  96.5%  3767  559s
  1128   730 -8520.3828   20  179 -9033.4809 -313.92189  96.5%  3783  569s
  1183   770     cutoff   19      -9033.4809 -313.92189  96.5%  3833  577s
  1255   803 -8831.9260   21  164 -9033.4809 -313.92189  96.5%  3801  584s
  1332   840     cutoff   21      -9033.4809 -313.92189  96.5%  3753  595s
  1459   894 -3147.2896   11  278 -9033.4809 -313.92189  96.5%  3646  605s
  1583   935 -3646.7419   12  257 -9033.4809 -313.92189  96.5%  3629  616s
  1734   975 -3769.4913   13  254 -9033.4809 -420.89050  95.3%  3586  627s
  1866  1033 -4446.1756   14  203 -9033.4809 -421.25779  95.3%  3611  638s
  2016  1115 -8913.7216   18   69 -9033.4809 -421.25779  95.3%  3589  650s
  2181  1160 -2729.0476   10  439 -9033.4809 -421.25779  95.3%  3553  662s
  2337  1212 -3154.7608   12  415 -9033.4809 -421.25779  95.3%  3544  675s
  2466  1259 infeasible   15      -9033.4809 -421.25779  95.3%  3587  688s
  2599  1316 -5886.5096   17  253 -9033.4809 -421.25779  95.3%  3640  701s
  2736  1383 -8736.2245   19  196 -9033.4809 -421.25779  95.3%  3669  715s
  2875  1426 -4999.1463    9  215 -9033.4809 -421.25779  95.3%  3723  730s
  2990  1447 -4395.0434    6  297 -9033.4809 -1422.3167  84.3%  3719  743s
  3033  1518 -4622.5351    7  290 -9033.4809 -1422.3167  84.3%  3735  757s
  3149  1588 -5075.9776    8  256 -9033.4809 -1422.3167  84.3%  3722  772s
  3301  1693 -7045.7629   10  223 -9033.4809 -1422.3167  84.3%  3710  788s
  3479  1772 infeasible   11      -9033.4809 -1702.2895  81.2%  3720  803s
  3658  1855 -6819.1912   10  391 -9033.4809 -1706.6007  81.1%  3758  822s
  3824  1946 -8492.5431   11  301 -9033.4809 -1706.6007  81.1%  3790  840s
  4051  2051 -8864.6992   14  206 -9033.4809 -1911.6400  78.8%  3780  858s
  4293  2143 -7133.0122   14  116 -9033.4809 -1970.3563  78.2%  3774  877s
  4499  2255 -7133.0313   13  248 -9033.4809 -2210.5655  75.5%  3803  895s
  4726  2256 -8422.2241   17  622 -9033.4809 -2263.5617  74.9%  3809  978s
  4728  2257 -5980.0335   18  327 -9033.4809 -2263.5617  74.9%  3807 1023s
  4729  2258 -7575.2696   32  625 -9033.4809 -2263.5617  74.9%  3806 1055s
  4730  2259 -7791.9564   23  598 -9033.4809 -2263.5617  74.9%  3805 1071s
  4731  2259 -5548.9783   15  569 -9033.4809 -2263.5617  74.9%  3805 1082s
  4732  2260 -7033.1585   25  696 -9033.4809 -2263.5617  74.9%  3804 1089s
  4733  2261 -8018.7862   22  715 -9033.4809 -2263.5617  74.9%  3803 1094s
  4734  2261 -7635.8084   30  653 -9033.4809 -2263.5617  74.9%  3802 1098s
  4735  2262 -7885.3398   16  662 -9033.4809 -2263.5617  74.9%  3801 1102s
  4736  2263 -4659.3517   15  722 -9033.4809 -2263.5617  74.9%  3801 1106s
  4737  2263 -8114.1431   18  656 -9033.4809 -2263.5617  74.9%  3800 1111s
  4738  2264 -8327.4719   30  588 -9033.4809 -2263.5617  74.9%  3799 1120s
  4740  2265 -6146.9361   30  611 -9033.4809 -2263.5617  74.9%  3797 1125s
  4742  2267 -5763.2985   11  681 -9033.4809 -2263.5617  74.9%  3796 1138s
  4743  2267 -6499.9337   16  672 -9033.4809 -2263.5617  74.9%  3795 1141s
  4744  2268 -6947.3164   25  683 -9033.4809 -2263.5617  74.9%  3794 1145s
  4745  2269 -3388.8187   14  579 -9033.4809 -2263.5617  74.9%  3793 1151s
  4747  2270 -7890.6376   32  575 -9033.4809 -2263.5617  74.9%  3792 1157s
  4748  2271 -2730.1850   11  671 -9033.4809 -2263.5617  74.9%  3791 1165s
  4750  2272 -7511.4047   26  680 -9033.4809 -2263.5617  74.9%  3789 1177s
  4751  2273 -6369.3939   23  665 -9033.4809 -2263.5617  74.9%  3789 1181s
  4752  2273 -8829.0274   19  589 -9033.4809 -2263.5617  74.9%  3788 1186s
  4754  2275 -6676.5180   19  579 -9033.4809 -2263.5617  74.9%  3786 1194s
  4755  2275 -3053.0663    7  582 -9033.4809 -2263.5617  74.9%  3785 1198s
  4756  2276 -6576.9586   29  662 -9033.4809 -2263.5617  74.9%  3785 1204s
  4757  2277 -6801.8364   27  681 -9033.4809 -2263.5617  74.9%  3784 1207s
  4758  2277 -6240.4660   14  686 -9033.4809 -2263.5617  74.9%  3783 1213s
  4759  2278 -5624.5647   21  686 -9033.4809 -2263.5617  74.9%  3782 1259s
  4760  2279 -6760.6493   22  686 -9033.4809 -2263.5617  74.9%  3781 1293s
  4761  2282 -2263.5617   15  569 -9033.4809 -2263.5617  74.9%  3828 1318s
  4763  2286 -2263.5617   16  628 -9033.4809 -2263.5617  74.9%  3828 1335s
  4767  2292 -2263.5617   17  629 -9033.4809 -2263.5617  74.9%  3830 1355s
  4775  2306 -2263.5617   18  634 -9033.4809 -2263.5617  74.9%  3834 1367s
  4791  2320 -5878.5338   19  198 -9033.4809 -2263.5617  74.9%  3874 1388s
  4811  2344 -3206.2951   20  304 -9033.4809 -2263.5617  74.9%  3892 1403s
  4843  2376 -4688.3526   21  423 -9033.4809 -2263.5617  74.9%  3895 1420s
H 4846  2260                    -9005.486824 -2263.5617  74.9%  3896 1420s
  4934  2273 -5274.0865   22  363 -9005.4868 -2263.5617  74.9%  3894 1442s
  5033  2247 -6213.6808   25  400 -9005.4868 -2263.5617  74.9%  3867 1460s
  5077  2235     cutoff   25      -9005.4868 -2263.5617  74.9%  3858 1477s
  5135  2233 -5539.9472   23  278 -9005.4868 -2263.5617  74.9%  3843 1494s
  5177  2249 -6743.3405   26  325 -9005.4868 -2263.5617  74.9%  3838 1504s
  5234  2259 -7211.2925   27  194 -9005.4868 -2263.5617  74.9%  3827 1515s
  5295  2268 -7542.6833   28  329 -9005.4868 -2263.5617  74.9%  3814 1526s
  5370  2257 -7596.0241   29  324 -9005.4868 -2263.5617  74.9%  3793 1544s
  5452  2220 infeasible   31      -9005.4868 -2263.5617  74.9%  3765 1555s
  5519  2211     cutoff   32      -9005.4868 -2263.5617  74.9%  3748 1565s
  5576  2215 -7811.0863   32  307 -9005.4868 -2263.5617  74.9%  3735 1585s
  5639  2206 -8310.7357   33  403 -9005.4868 -2263.5617  74.9%  3718 1598s
  5675  2217 -7819.6971   32  451 -9005.4868 -2263.5617  74.9%  3716 1616s
  5726  2221     cutoff   33      -9005.4868 -2263.5617  74.9%  3708 1627s
  5784  2220     cutoff   34      -9005.4868 -2263.5617  74.9%  3692 1644s
  5829  2226 -8785.0619   35  230 -9005.4868 -2263.5617  74.9%  3684 1657s
  5893  2230 -8794.1095   36  231 -9005.4868 -2263.5617  74.9%  3671 1677s
  5952  2228     cutoff   36      -9005.4868 -2263.5617  74.9%  3660 1690s
  6029  2228 -8886.3428   38  232 -9005.4868 -2263.5617  74.9%  3640 1703s
  6115  2231 -4230.3754   21  531 -9005.4868 -2263.5617  74.9%  3616 1720s
  6207  2233 -5890.3658   24  311 -9005.4868 -2263.5617  74.9%  3592 1735s
  6303  2238 -6078.3970   27  158 -9005.4868 -2263.5617  74.9%  3567 1749s
  6414  2250 -7227.3953   31  150 -9005.4868 -2263.5617  74.9%  3539 1764s
  6537  2232 -8355.6822   37  145 -9005.4868 -2263.5617  74.9%  3512 1778s
  6591  2238     cutoff   41      -9005.4868 -2263.5617  74.9%  3501 1794s
  6695  2245 -7810.4845   28  113 -9005.4868 -2263.5617  74.9%  3484 1810s
  6802  2253 -8800.9351   35   44 -9005.4868 -2263.5617  74.9%  3469 1827s
  6938  2235 -7090.6373   24  339 -9005.4868 -2263.5617  74.9%  3448 1843s
  7033  2235 -7976.2240   26  406 -9005.4868 -2263.5617  74.9%  3425 1861s
  7173  2204 -8798.3535   29  414 -9005.4868 -2530.6935  71.9%  3396 1883s
  7310  2212 -7044.9307   25  546 -9005.4868 -2530.6935  71.9%  3379 1908s
  7465  2199 -8211.8314   28  449 -9005.4868 -2530.6935  71.9%  3361 1930s
  7643  2165 -7832.5524   24  435 -9005.4868 -2530.6935  71.9%  3329 1951s
  7818  2157     cutoff   28      -9005.4868 -2530.6935  71.9%  3305 1975s
  7987  2106 -8903.6773   26  616 -9005.4868 -2530.6935  71.9%  3289 1999s
  8182  2077 -7965.8087   23  393 -9005.4868 -4632.4230  48.6%  3263 2023s
  8386  2057     cutoff   23      -9005.4868 -5144.0082  42.9%  3238 2046s
  8607  1999 -7151.8362   25  451 -9005.4868 -5144.0082  42.9%  3214 2068s
  8738  1962 -8851.5547   27  371 -9005.4868 -5430.9179  39.7%  3204 2093s
  8949  1920 -8832.8400   30  109 -9005.4868 -5617.6890  37.6%  3184 2120s
  9197  1892 -8396.5662   29  622 -9005.4868 -5617.6890  37.6%  3160 2151s
  9483  1769 -8119.3962   36  363 -9005.4868 -5794.2429  35.7%  3125 2181s
  9755  1656 -7629.9997   23  218 -9005.4868 -6088.9409  32.4%  3104 2210s
 10086  1503 -7718.6742   34  200 -9005.4868 -6215.0455  31.0%  3066 2241s
 10401  1348 infeasible   32      -9005.4868 -6456.8002  28.3%  3041 2272s
 10839  1129 -8327.1863   31  530 -9005.4868 -6740.9442  25.1%  2987 2304s
 11309   925 -8926.3491   32  486 -9005.4868 -6960.9965  22.7%  2930 2335s
 11807   841 -8788.5685   37  303 -9005.4868 -7192.5889  20.1%  2875 2368s
 12413   619 -8963.4871   31  181 -9005.4868 -7387.9971  18.0%  2804 2402s
 13107   221 -8744.9517   34  466 -9005.4868 -7787.2229  13.5%  2719 2433s
 13941     0     cutoff   40      -9005.4868 -8048.2991  10.6%  2612 2453s

Cutting planes:
  Learned: 3
  MIR: 852
  Flow cover: 1836
  Zero half: 7
  RLT: 34
  Relax-and-lift: 114

Explored 14284 nodes (36911309 simplex iterations) in 2453.43 seconds (7159.24 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -9005.49 -9033.48 -9034.06 ... -19236.3
No other solutions better than -9005.49

Optimal solution found (tolerance 1.00e-04)
Best objective -9.005486823818e+03, best bound -9.005486823818e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2453.44s
  Master Objective (UB) = -9005.49, θ = 118426.27
  Upper Bound (UB) = -9005.49

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 118426.27
  [DEBUG]   ✓ Scenario 0: θ = 118426.27 ≤ Q = 118426.27 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 118426.27 ≤ Q = 118426.27 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 118426.27 ≤ Q = 118426.27 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 118426.27 ≤ Q = 118426.27 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 118426.27 ≤ Q = 118426.27 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 118426.27 ≤ Q = 118426.27 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 118426.27 ≤ Q = 118426.27 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 118426.27 ≤ Q = 118426.27 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x6ffdc82e
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x900237d2
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.303058e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 6911482.2125
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.233202e+05, 245 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -123320.21    0  122 6911482.21 -123320.21   102%     -    0s
H    0     0                    -87850.27619 -123320.21  40.4%     -    0s
H    0     0                    -89049.48371 -123320.21  38.5%     -    0s
     0     0 -92649.422    0   46 -89049.484 -92649.422  4.04%     -    0s
H    0     0                    -90104.23236 -92627.311  2.80%     -    0s
H    0     0                    -90415.96124 -92627.311  2.45%     -    0s
H    0     0                    -91086.29002 -92627.311  1.69%     -    0s
H    0     0                    -91398.01890 -92627.311  1.34%     -    0s
     0     0 -92489.449    0   46 -91398.019 -92489.449  1.19%     -    0s
     0     0 -92451.734    0   46 -91398.019 -92451.734  1.15%     -    0s
H    0     0                    -91410.86830 -92447.935  1.13%     -    0s
     0     2 -92447.935    0   46 -91410.868 -92447.935  1.13%     -    0s
H  123   102                    -91451.62130 -92060.537  0.67%   6.7    0s
H  138   102                    -91473.07547 -92060.537  0.64%   6.3    0s
H  184   102                    -91536.45588 -92060.537  0.57%   5.6    0s

Cutting planes:
  Gomory: 16
  Implied bound: 10
  MIR: 149

Explored 1878 nodes (8218 simplex iterations) in 0.20 seconds (0.13 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -91536.5 -91473.1 -91451.6 ... 1.30306e+13
No other solutions better than -91536.5

Optimal solution found (tolerance 1.00e-04)
Best objective -9.153645588196e+04, best bound -9.153645588196e+04, gap 0.0000%
  Subproblem solved in 0.21s
  Worst-case operational profit (Z_SP) = 118216.30
  Scenario: 16 demand increases, 44 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -91536.46
  [DEBUG]   S×d_nominal = 209752.76
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 209752.76 + -91536.46 = 118216.30
  [DEBUG]   Current θ from Master = 118426.27
  [DEBUG]   ⚠️  Z_SP ≤ θ by 209.96 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -9215.45
  Lower Bound (LB) = -9215.45
  Gap (UB-LB) = 209.9648, Absolute Gap = 209.9648, Relative Gap = 0.023315
  Not converged yet (gap = 209.96 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 16 increases, 44 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394679 nonzeros
Model fingerprint: 0x4812757b
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 61083 rows and 24813 columns
Presolve time: 1.07s
Presolved: 77910 rows, 33607 columns, 477884 nonzeros
Variable types: 31348 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -409717.4995
Found heuristic solution: objective -226690.3294

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 77910 rows, 33607 columns, 477884 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   32748   -7.0176315e+04   0.000000e+00   4.210824e+08      5s
   44269   -1.9003813e+03   0.000000e+00   3.141269e+07     10s
   50524   -3.3309159e+01   0.000000e+00   8.155999e+07     15s
   55644    1.3053622e+03   0.000000e+00   5.261313e+06     20s
   60544    3.5826439e+03   0.000000e+00   4.392530e+07     25s
   66615    5.7104610e+03   0.000000e+00   2.152384e+06     30s
   72192    6.8188088e+03   0.000000e+00   1.477297e+06     35s
   77290    7.2243917e+03   0.000000e+00   9.860080e+05     40s
   82938    7.7761794e+03   0.000000e+00   7.689074e+05     45s
   87549    7.8113050e+03   0.000000e+00   2.404919e+07     50s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 1.099494e+04, 74478 iterations, 49.69 seconds (105.81 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 10994.9353    0  480 -226690.33 10994.9353   105%     -   51s
H    0     0                    -210558.3658 10994.9353   105%     -   51s
H    0     0                    -160004.9225 10994.9353   107%     -   51s
H    0     0                    -47738.66202 10994.9353   123%     -   51s
H    0     0                    -47720.53091 10994.9353   123%     -   51s
H    0     0                    -47695.02244 10994.9353   123%     -   51s
H    0     0                    -47683.72919 10994.9353   123%     -   51s
H    0     0                    -47668.92122 10994.9353   123%     -   51s
H    0     0                    -26599.90454 10994.9353   141%     -   51s
H    0     0                    -25689.16255 10994.9353   143%     -   52s
H    0     0                    -25080.50839 10994.9353   144%     -   52s
H    0     0                    -25005.66578 10994.9353   144%     -   52s
H    0     0                    -24995.40923 10994.9353   144%     -   52s
H    0     0                    -24995.24098 10994.9353   144%     -   52s
H    0     0                    -24978.38590 10994.9353   144%     -   52s
H    0     0                    -24961.35917 10994.7900   144%     -   54s
H    0     0                    -23836.87374 7537.95284   132%     -   71s
H    0     0                    -19451.71375 7537.95284   139%     -   71s
H    0     0                    -19414.84339 7537.95284   139%     -   71s
H    0     0                    -19366.97065 7537.95284   139%     -   71s
H    0     0                    -19364.07147 7537.95284   139%     -   71s
H    0     0                    -19353.09192 7537.95284   139%     -   71s
     0     0 7516.31576    0  248 -19353.092 7516.31576   139%     -   71s
     0     0 6774.93734    0  477 -19353.092 6774.93734   135%     -   81s
     0     0 6610.42811    0  485 -19353.092 6610.42811   134%     -   86s
     0     0 6610.42811    0  478 -19353.092 6610.42811   134%     -   89s
     0     0 6610.42811    0  476 -19353.092 6610.42811   134%     -   90s
H    0     0                    -13568.90028 6610.42811   149%     -   93s
H    0     0                    -13506.39900 6610.42811   149%     -   93s
H    0     0                    -13484.33186 6610.42811   149%     -   93s
H    0     0                    -13481.52440 6610.42811   149%     -   93s
H    0     0                    -13480.35591 6610.42811   149%     -   93s
H    0     0                    -13474.07531 6610.42811   149%     -   93s
H    0     0                    -13467.12651 6610.42811   149%     -   93s
H    0     0                    -13465.90060 6610.42811   149%     -   93s
H    0     0                    -13427.08672 6610.42811   149%     -   93s
H    0     0                    -13425.33526 6610.42811   149%     -   93s
H    0     0                    -13416.83017 6610.42811   149%     -   93s
H    0     0                    -13415.57588 6610.42811   149%     -   93s
H    0     0                    -13407.45466 6610.42811   149%     -   93s
     0     0 6610.42811    0  481 -13407.455 6610.42811   149%     -   93s
     0     0 6610.42811    0  481 -13407.455 6610.42811   149%     -   94s
     0     0 6610.42811    0  482 -13407.455 6610.42811   149%     -   95s
     0     0 6610.42811    0  483 -13407.455 6610.42811   149%     -   95s
     0     0 6610.42811    0  479 -13407.455 6610.42811   149%     -   95s
     0     0 6610.42811    0  479 -13407.455 6610.42811   149%     -   95s
     0     0 6610.42811    0  479 -13407.455 6610.42811   149%     -   96s
H    0     0                    -13172.86694 4047.48156   131%     -  110s
H    0     0                    -13089.11537 4047.48156   131%     -  110s
H    0     0                    -13084.31330 4047.48156   131%     -  110s
H    0     0                    -13083.67480 4047.48156   131%     -  110s
H    0     0                    -13078.22643 4047.48156   131%     -  110s
H    0     0                    -13051.41834 4047.48156   131%     -  110s
     0     0 4047.39395    0  517 -13051.418 4047.39395   131%     -  110s
     0     0 3512.45916    0  537 -13051.418 3512.45916   127%     -  116s
     0     0 3443.40911    0  525 -13051.418 3443.40911   126%     -  118s
     0     0 3438.33527    0  537 -13051.418 3438.33527   126%     -  119s
     0     0 3413.86998    0  538 -13051.418 3413.86998   126%     -  119s
     0     0 3396.63636    0  525 -13051.418 3396.63636   126%     -  121s
     0     0 3370.50152    0  528 -13051.418 3370.50152   126%     -  122s
     0     0 3322.90721    0  532 -13051.418 3322.90721   125%     -  123s
     0     0 3277.79086    0  532 -13051.418 3277.79086   125%     -  124s
     0     0 3275.49989    0  535 -13051.418 3275.49989   125%     -  125s
     0     0 3269.50224    0  536 -13051.418 3269.50224   125%     -  125s
     0     0 3269.48857    0  537 -13051.418 3269.48857   125%     -  125s
H    0     0                    -13048.99494 2400.06715   118%     -  138s
H    0     0                    -13044.61792 2400.06715   118%     -  138s
H    0     0                    -13038.16457 2400.06715   118%     -  138s
H    0     0                    -13007.89752 2400.06715   118%     -  138s
H    0     0                    -13002.10460 2400.06715   118%     -  138s
H    0     0                    -12970.83488 2400.06715   119%     -  138s
H    0     0                    -12948.66250 2400.06715   119%     -  138s
H    0     0                    -12941.60896 2400.06715   119%     -  138s
     0     0 2400.06715    0  516 -12941.609 2400.06715   119%     -  139s
     0     0 1833.18027    0  518 -12941.609 1833.18027   114%     -  148s
     0     0 1776.42181    0  522 -12941.609 1776.42181   114%     -  151s
     0     0 1717.43607    0  528 -12941.609 1717.43607   113%     -  154s
     0     0 1700.56845    0  527 -12941.609 1700.56845   113%     -  156s
     0     0 1620.70266    0  609 -12941.609 1620.70266   113%     -  159s
     0     0 1596.16699    0  629 -12941.609 1596.16699   112%     -  163s
     0     0 1590.31905    0  693 -12941.609 1590.31905   112%     -  164s
     0     0 1586.64052    0  553 -12941.609 1586.64052   112%     -  165s
     0     0 1501.84456    0  680 -12941.609 1501.84456   112%     -  168s
     0     0 1437.35531    0  673 -12941.609 1437.35531   111%     -  171s
     0     0 1423.73605    0  683 -12941.609 1423.73605   111%     -  173s
H    0     0                    -12865.86403 1418.91010   111%     -  174s
     0     0 1418.91010    0  684 -12865.864 1418.91010   111%     -  174s
     0     0 1418.54829    0  686 -12865.864 1418.54829   111%     -  174s
H    0     0                    -12863.74432  967.86918   108%     -  187s
H    0     0                    -12845.75596  967.86918   108%     -  187s
H    0     0                    -12814.49654  967.86918   108%     -  187s
     0     0  967.86918    0  527 -12814.497  967.86918   108%     -  187s
H    0     0                    -12788.80265  876.30768   107%     -  192s
     0     0  876.30768    0  526 -12788.803  876.30768   107%     -  192s
     0     0  809.93708    0  618 -12788.803  809.93708   106%     -  196s
     0     0  780.68716    0  621 -12788.803  780.68716   106%     -  198s
     0     0  771.64788    0  687 -12788.803  771.64788   106%     -  200s
     0     0  758.51604    0  542 -12788.803  758.51604   106%     -  201s
     0     0  744.64769    0  611 -12788.803  744.64769   106%     -  203s
     0     0  740.97330    0  554 -12788.803  740.97330   106%     -  204s
     0     0  737.06837    0  622 -12788.803  737.06837   106%     -  205s
     0     0  730.70969    0  557 -12788.803  730.70969   106%     -  205s
     0     0  728.16171    0  554 -12788.803  728.16171   106%     -  206s
     0     0  727.70468    0  557 -12788.803  727.70468   106%     -  206s
     0     0  594.27011    0  552 -12788.803  594.27011   105%     -  213s
     0     0  577.22186    0  561 -12788.803  577.22186   105%     -  216s
     0     0  573.79445    0  631 -12788.803  573.79445   104%     -  216s
     0     0  569.41558    0  569 -12788.803  569.41558   104%     -  217s
     0     0  568.28142    0  570 -12788.803  568.28142   104%     -  218s
     0     0  514.02415    0  727 -12788.803  514.02415   104%     -  224s
     0     0  496.62345    0  652 -12788.803  496.62345   104%     -  227s
     0     0  487.42204    0  729 -12788.803  487.42204   104%     -  230s
     0     0  484.54518    0  733 -12788.803  484.54518   104%     -  231s
     0     0  482.81507    0  658 -12788.803  482.81507   104%     -  231s
     0     0  477.44068    0  658 -12788.803  477.44068   104%     -  232s
     0     0  475.58447    0  664 -12788.803  475.58447   104%     -  233s
     0     0  475.50234    0  812 -12788.803  475.50234   104%     -  233s
     0     0  435.03633    0  558 -12788.803  435.03633   103%     -  238s
     0     0  418.65774    0  582 -12788.803  418.65774   103%     -  240s
     0     0  416.48116    0  588 -12788.803  416.48116   103%     -  241s
     0     0  415.03544    0  592 -12788.803  415.03544   103%     -  241s
     0     0  357.74504    0  581 -12788.803  357.74504   103%     -  245s
H    0     0                    -9378.881574  357.10520   104%     -  252s
H    0     0                    -9292.564410  357.10520   104%     -  254s
     0     0  351.53205    0  664 -9292.5644  351.53205   104%     -  256s
     0     0  350.51635    0  588 -9292.5644  350.51635   104%     -  256s
     0     0  283.95677    0  581 -9292.5644  283.95677   103%     -  262s
H    0     0                    -9237.045775  283.85572   103%     -  263s
H    0     0                    -9193.343624  283.85572   103%     -  263s
     0     0  263.04933    0  580 -9193.3436  263.04933   103%     -  265s
     0     0  255.33666    0  602 -9193.3436  255.33666   103%     -  267s
     0     0  253.71447    0  605 -9193.3436  253.71447   103%     -  268s
     0     0  252.50613    0  686 -9193.3436  252.50613   103%     -  268s
     0     0  209.34327    0  601 -9193.3436  209.34327   102%     -  274s
H    0     0                    -9111.624379  209.18381   102%     -  274s
H    0     0                    -9109.284423  209.18381   102%     -  274s
     0     0  196.33602    0  586 -9109.2844  196.33602   102%     -  277s
     0     0  190.89017    0  599 -9109.2844  190.89017   102%     -  278s
     0     0  188.65609    0  584 -9109.2844  188.65609   102%     -  279s
     0     0  188.28240    0  584 -9109.2844  188.28240   102%     -  279s
     0     0  174.11396    0  664 -9109.2844  174.11396   102%     -  282s
     0     0  172.75010    0  658 -9109.2844  172.75010   102%     -  283s
     0     0  149.74243    0  586 -9109.2844  149.74243   102%     -  287s
H    0     0                    -9104.994184  149.37488   102%     -  288s
     0     0  147.30230    0  655 -9104.9942  147.30230   102%     -  289s
     0     0  146.73280    0  653 -9104.9942  146.73280   102%     -  289s
     0     0  140.73155    0  661 -9104.9942  140.73155   102%     -  292s
     0     0  135.93125    0  599 -9104.9942  135.93125   101%     -  294s
     0     0  135.59764    0  592 -9104.9942  135.59764   101%     -  295s
     0     0  132.75339    0  595 -9104.9942  132.75339   101%     -  297s
     0     0  132.46388    0  595 -9104.9942  132.46388   101%     -  300s
H    0     0                    -9099.582005  132.46388   101%     -  366s
H    0     0                    -9055.048523  132.46388   101%     -  373s
H    0     0                    -9054.263131  132.46388   101%     -  374s
H    0     2                    -9048.010235  132.46388   101%     -  375s
     0     2  132.46388    0  595 -9048.0102  132.46388   101%     -  375s
     1     3  -72.59209    1  505 -9048.0102  132.46388   101%  4645  380s
     2     6 -607.86740    2  411 -9048.0102  132.46388   101%  5383  385s
     5    12 -1088.0173    3  437 -9048.0102   -7.32483   100%  5196  398s
    11    24 -3105.7172    4  274 -9048.0102  -85.93803  99.1%  8345  407s
    23    36 -1646.9497    4  581 -9048.0102 -270.54918  97.0%  9443  430s
    35    68 -1550.2908    6  383 -9048.0102 -270.54918  97.0% 10863  486s
    67   120 -1805.1147    7  388 -9048.0102 -506.41639  94.4% 13407  503s
   119   158 -2251.0406    8  526 -9048.0102 -507.15261  94.4%  9782  514s
   157   211 -1859.9870    8  401 -9048.0102 -507.15261  94.4%  8076  529s
H  200   211                    -9036.104283 -507.15261  94.4%  6929  529s
   210   318 -2299.2038    9  438 -9036.1043 -507.15261  94.4%  6838  542s
   337   389 -8024.4265   11  200 -9036.1043 -507.15261  94.4%  5643  554s
   436   451 -6065.5896   12  307 -9036.1043 -787.59100  91.3%  5194  564s
   520   510 -8720.7040   11  191 -9036.1043 -787.59100  91.3%  5058  575s
   596   556 -3043.1195   12  432 -9036.1043 -787.59100  91.3%  4937  584s
   666   592 -6189.2166   13  311 -9036.1043 -787.59100  91.3%  4992  594s
   720   614 -6606.9993   14  298 -9036.1043 -787.59100  91.3%  5058  604s
   766   637 -7083.5065   16  298 -9036.1043 -787.59100  91.3%  5026  613s
   803   667 -7303.6831   17  258 -9036.1043 -787.59100  91.3%  5131  623s
   837   700 -7948.8288   18  282 -9036.1043 -787.59100  91.3%  5220  632s
   880   736 -8019.4011   20  352 -9036.1043 -787.59100  91.3%  5246  640s
   930   764 infeasible   23      -9036.1043 -787.59100  91.3%  5303  650s
   998   788 -8143.6939   24  298 -9036.1043 -787.59100  91.3%  5270  661s
  1044   802     cutoff   25      -9036.1043 -787.59100  91.3%  5278  672s
  1090   819 -3470.1466   10  271 -9036.1043 -787.59100  91.3%  5339  682s
  1135   832     cutoff   17      -9036.1043 -787.59100  91.3%  5378  694s
  1195   848 -4675.9020   11  322 -9036.1043 -787.59100  91.3%  5459  707s
  1277   897 -4697.6995   12  327 -9036.1043 -787.59100  91.3%  5513  720s
  1363   942 -6756.2892   14  218 -9036.1043 -787.59100  91.3%  5501  733s
  1452   996 -7814.0909   16  183 -9036.1043 -1060.4428  88.3%  5558  747s
  1546  1068 -8329.5620   18  257 -9036.1043 -1060.4428  88.3%  5565  760s
  1650  1136 -8659.3885   23  255 -9036.1043 -1060.4428  88.3%  5506  775s
  1768  1189 -5117.8182   11  458 -9036.1043 -1060.4428  88.3%  5441  790s
  1919  1214 -7973.1660   14  259 -9036.1043 -1060.4428  88.3%  5361  803s
  1958  1244 infeasible   15      -9036.1043 -1515.3102  83.2%  5403  818s
H 1967  1244                    -9035.820881 -1515.3102  83.2%  5405  818s
  2004  1287 -7607.9589   14  341 -9035.8209 -1515.3102  83.2%  5429  832s
  2107  1353 -8794.4562   15  351 -9035.8209 -1515.3102  83.2%  5349  849s
  2255  1409 -6687.1435   15  367 -9035.8209 -1840.4384  79.6%  5295  864s
  2424  1473 -7642.5887   19  347 -9035.8209 -1840.4384  79.6%  5213  881s
  2589  1524 -3871.7181    7  402 -9035.8209 -1892.2288  79.1%  5190  898s
  2760  1601 -4466.1727    9  310 -9035.8209 -1964.7594  78.3%  5154  916s
  2960  1671 -6131.5612   12  178 -9035.8209 -1993.6192  77.9%  5083  934s
  3169  1725 -6983.4163   17  149 -9035.8209 -1993.6192  77.9%  5016  953s
  3335  1780 -5113.0838   10  396 -9035.8209 -1993.6192  77.9%  4991  973s
H 3336  1780                    -9033.480925 -1993.6192  77.9%  4990  973s
  3516  1850 -5568.8052   11  309 -9033.4809 -2035.5403  77.5%  4957  993s
  3762  1922 -7363.0860   17  272 -9033.4809 -2035.5403  77.5%  4904 1015s
  4000  1993 infeasible   26      -9033.4809 -2184.1518  75.8%  4866 1036s
  4235  2055 -8663.2011    8  376 -9033.4809 -2184.1518  75.8%  4850 1059s
  4445  2152 -7322.9727    9  392 -9033.4809 -2300.4391  74.5%  4855 1082s
  4678  2181     cutoff   24      -9033.4809 -2348.5339  74.0%  4850 1108s
  4761  2248 -6704.2967   13  361 -9033.4809 -2389.0246  73.6%  4865 1131s
  4972  2374 -7139.6689   14  414 -9033.4809 -2401.2576  73.4%  4846 1155s
  5175  2375 -2730.2838   12  595 -9033.4809 -2476.6478  72.6%  4891 1245s
  5177  2376 -8928.1952   12  327 -9033.4809 -2476.6478  72.6%  4889 1315s
  5178  2377 -3988.9873   15  620 -9033.4809 -2476.6478  72.6%  4888 1348s
  5179  2378 -7721.3674   24  532 -9033.4809 -2476.6478  72.6%  4887 1379s
  5180  2378 -4700.5872   13  540 -9033.4809 -2476.6478  72.6%  4887 1399s
  5181  2379 -2956.8458   18  569 -9033.4809 -2476.6478  72.6%  4886 1410s
  5182  2380 -5206.0560   17  628 -9033.4809 -2476.6478  72.6%  4885 1418s
  5183  2380 -8212.8881   34  584 -9033.4809 -2476.6478  72.6%  4884 1422s
  5184  2381 -5034.5884   13  570 -9033.4809 -2476.6478  72.6%  4883 1427s
  5185  2382 -4498.4911   13  597 -9033.4809 -2476.6478  72.6%  4882 1430s
  5187  2383 -8803.5643   60  660 -9033.4809 -2476.6478  72.6%  4880 1448s
  5188  2384 -8788.3759   55  595 -9033.4809 -2476.6478  72.6%  4879 1452s
  5189  2384 -7727.3148   21  588 -9033.4809 -2476.6478  72.6%  4878 1457s
  5190  2385 -7851.1485   20  579 -9033.4809 -2476.6478  72.6%  4877 1460s
  5191  2386 -4625.2627   23  589 -9033.4809 -2476.6478  72.6%  4876 1467s
  5192  2386 -6531.2873   23  594 -9033.4809 -2476.6478  72.6%  4875 1477s
  5193  2387 -6152.2286   17  600 -9033.4809 -2476.6478  72.6%  4874 1480s
  5194  2388 -7557.3488   19  601 -9033.4809 -2476.6478  72.6%  4873 1485s
  5195  2388 -6588.2408   17  651 -9033.4809 -2476.6478  72.6%  4872 1497s
  5196  2389 -5159.3273   18  608 -9033.4809 -2476.6478  72.6%  4871 1501s
  5197  2390 -8457.5606   24  586 -9033.4809 -2476.6478  72.6%  4871 1507s
  5198  2390 -6535.7804   22  591 -9033.4809 -2476.6478  72.6%  4870 1511s
  5199  2391 -2739.8383   11  635 -9033.4809 -2476.6478  72.6%  4869 1521s
  5200  2392 -3675.7485   12  588 -9033.4809 -2476.6478  72.6%  4868 1525s
  5201  2392 -3524.2382   12  584 -9033.4809 -2476.6478  72.6%  4867 1532s
  5202  2393 -6754.0792   23  660 -9033.4809 -2476.6478  72.6%  4866 1536s
  5203  2394 -5982.4576   11  659 -9033.4809 -2476.6478  72.6%  4865 1541s
  5204  2394 -7683.2958   21  659 -9033.4809 -2476.6478  72.6%  4864 1612s
  5205  2395 -6083.2943   18  659 -9033.4809 -2476.6478  72.6%  4863 1642s
  5206  2399 -2476.6478   12  641 -9033.4809 -2476.6478  72.6%  4917 1662s
  5208  2402 -2476.6478   13  645 -9033.4809 -2476.6478  72.6%  4917 1672s
  5212  2409 -2476.6478   14  644 -9033.4809 -2476.6478  72.6%  4920 1689s
  5220  2420 -2476.6478   15  651 -9033.4809 -2476.6478  72.6%  4919 1711s
  5236  2428 -2476.6478   16  562 -9033.4809 -2476.6478  72.6%  4952 1751s
  5250  2441 -4602.5596   17  541 -9033.4809 -2476.6478  72.6%  4967 1782s
  5280  2528 -4649.9610   18  527 -9033.4809 -2476.6478  72.6%  4990 1813s
  5384  2535 -5541.4337   22  556 -9033.4809 -2476.6478  72.6%  5028 1830s
  5438  2549 -6217.2600   24  358 -9033.4809 -2476.6478  72.6%  5028 1846s
  5496  2565 -7777.5583   26  354 -9033.4809 -2476.6478  72.6%  5028 1863s
  5559  2569 -8663.4140   29  334 -9033.4809 -2476.6478  72.6%  5009 1881s
  5624  2563 -8289.5276   22  640 -9033.4809 -2476.6478  72.6%  4988 1896s
  5662  2561     cutoff   23      -9033.4809 -2476.6478  72.6%  4983 1912s
  5712  2560 -6367.0601   26  333 -9033.4809 -2476.6478  72.6%  4974 1930s
  5758  2565 -6544.9084   27  159 -9033.4809 -2476.6478  72.6%  4961 1950s
  5821  2548 -6653.3409   28  139 -9033.4809 -2476.6478  72.6%  4939 1965s
  5890  2532 -6685.3952   29  162 -9033.4809 -2476.6478  72.6%  4910 1982s
  5959  2524 -7212.1854   32  217 -9033.4809 -2476.6478  72.6%  4882 1996s
  6029  2522 -7533.3464   35  353 -9033.4809 -2476.6478  72.6%  4857 2012s
  6102  2512 -8273.4412   39  125 -9033.4809 -2476.6478  72.6%  4834 2028s
  6193  2496 -8434.7137   23  199 -9033.4809 -2476.6478  72.6%  4798 2043s
  6277  2474 -8601.2276   24  186 -9033.4809 -2476.6478  72.6%  4773 2059s
  6365  2458     cutoff   26      -9033.4809 -2476.6478  72.6%  4746 2076s
  6444  2461 -5888.3769   21  453 -9033.4809 -2476.6478  72.6%  4731 2094s
  6524  2462 -5918.7291   23  433 -9033.4809 -2476.6478  72.6%  4717 2110s
  6618  2466 -8616.7282   26  227 -9033.4809 -2476.6478  72.6%  4694 2129s
  6697  2473     cutoff   28      -9033.4809 -2476.6478  72.6%  4683 2149s
  6802  2462 -8169.9041   24  297 -9033.4809 -2561.9655  71.6%  4657 2166s
  6895  2453     cutoff   27      -9033.4809 -2561.9655  71.6%  4632 2185s
  6994  2453 -5971.7687   22  595 -9033.4809 -3404.1255  62.3%  4610 2206s
  7102  2451 -8044.2487   24  358 -9033.4809 -3404.1255  62.3%  4589 2225s
  7195  2456 -8048.1195   25  352 -9033.4809 -3404.1255  62.3%  4566 2245s
  7285  2458     cutoff   28      -9033.4809 -3404.1255  62.3%  4560 2267s
  7409  2476     cutoff   24      -9033.4809 -3404.1255  62.3%  4536 2292s
  7560  2453 -7429.4247   21  382 -9033.4809 -3404.1255  62.3%  4500 2320s
  7715  2418 -8669.8867   24  278 -9033.4809 -3404.1255  62.3%  4467 2345s
  7872  2400 -6434.4790   19  383 -9033.4809 -3895.5986  56.9%  4438 2368s
  7950  2381 -8291.0425   21  283 -9033.4809 -3895.5986  56.9%  4435 2390s
  8033  2402     cutoff   22      -9033.4809 -3895.5986  56.9%  4421 2416s
  8181  2398     cutoff   28      -9033.4809 -4109.2217  54.5%  4396 2448s
  8326  2380 -5930.6378   20  596 -9033.4809 -4237.7399  53.1%  4381 2478s
  8512  2334 -7855.5493   23  451 -9033.4809 -4357.4628  51.8%  4354 2503s
  8552  2334 -8164.1717   24  476 -9033.4809 -4477.8586  50.4%  4361 2529s
  8635  2334 -8260.6819   25  455 -9033.4809 -4525.9635  49.9%  4352 2558s
  8792  2332     cutoff   26      -9033.4809 -4609.4199  49.0%  4328 2592s
  9013  2310 -6806.2917   22  676 -9033.4809 -4673.2395  48.3%  4294 2627s
  9244  2235 -8805.2744   24  536 -9033.4809 -4709.0391  47.9%  4264 2654s
  9303  2224     cutoff   25      -9033.4809 -4717.0851  47.8%  4261 2686s
  9408  2231 -9015.3792   24  337 -9033.4809 -4717.0851  47.8%  4245 2724s
  9618  2185     cutoff   23      -9033.4809 -4948.3078  45.2%  4215 2766s
  9847  2117 -8161.7915   23  625 -9033.4809 -4948.3078  45.2%  4202 2808s
 10121  2019 -7612.8984   25  231 -9033.4809 -4948.3078  45.2%  4177 2854s
 10471  1928 -6547.1803   26  371 -9033.4809 -5339.8376  40.9%  4121 2910s
 10775  1845     cutoff   31      -9033.4809 -5339.8376  40.9%  4093 2964s
 11088  1735 -8827.1684   26  363 -9033.4809 -5640.2534  37.6%  4067 3014s
 11407  1605 -8831.9659   26  246 -9033.4809 -5812.7734  35.7%  4047 3065s
 11791  1496 -7395.4367   25  604 -9033.4809 -6016.5956  33.4%  4009 3120s
 12075  1376     cutoff   34      -9033.4809 -6016.5956  33.4%  4006 3176s
 12456  1217 -8164.1946   32  417 -9033.4809 -6349.6256  29.7%  3977 3231s
 12839  1126 infeasible   25      -9033.4809 -6634.3206  26.6%  3956 3289s
 13262  1000     cutoff   29      -9033.4809 -6753.4348  25.2%  3928 3348s
 13735   619     cutoff   31      -9033.4809 -6966.2425  22.9%  3895 3408s
 14390   134     cutoff   26      -9033.4809 -7280.2139  19.4%  3815 3463s
 15174     0     cutoff   29      -9033.4809 -7688.0405  14.9%  3694 3489s

Cutting planes:
  Projected implied bound: 24
  MIR: 1188
  Flow cover: 2369
  Zero half: 6
  RLT: 34
  Relax-and-lift: 157

Explored 15386 nodes (56564581 simplex iterations) in 3489.12 seconds (10207.34 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -9033.48 -9035.82 -9036.1 ... -9111.62
No other solutions better than -9033.48

Optimal solution found (tolerance 1.00e-04)
Best objective -9.033480924887e+03, best bound -9.033480924887e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3489.15s
  Master Objective (UB) = -9033.48, θ = 118024.68
  Upper Bound (UB) = -9033.48

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 118024.68
  [DEBUG]   ✓ Scenario 0: θ = 118024.68 ≤ Q = 118024.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 118024.68 ≤ Q = 118024.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 118024.68 ≤ Q = 118024.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 118024.68 ≤ Q = 118024.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 118024.68 ≤ Q = 118024.68 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 118024.68 ≤ Q = 118024.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 118024.68 ≤ Q = 118024.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 118024.68 ≤ Q = 118024.68 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 118024.68 ≤ Q = 118024.68 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0xd59a7e3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x0d59a7e3
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.307725e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 6933595.0559
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.229061e+05, 244 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -122906.09    0  122 6933595.06 -122906.09   102%     -    0s
H    0     0                    -87504.69046 -122906.09  40.5%     -    0s
H    0     0                    -88870.81088 -122906.09  38.3%     -    0s
     0     0 -92308.678    0   88 -88870.811 -92308.678  3.87%     -    0s
H    0     0                    -90063.80669 -92298.595  2.48%     -    0s
     0     0 -92041.278    0   87 -90063.807 -92041.278  2.20%     -    0s
     0     0 -92012.667    0   86 -90063.807 -92012.667  2.16%     -    0s
     0     0 -91999.802    0   87 -90063.807 -91999.802  2.15%     -    0s
H    0     0                    -90376.32968 -91999.802  1.80%     -    0s
     0     0 -91895.321    0   85 -90376.330 -91895.321  1.68%     -    0s
     0     0 -91894.802    0   85 -90376.330 -91894.802  1.68%     -    0s
H    0     0                    -90401.90640 -91894.697  1.65%     -    0s
     0     2 -91894.697    0   85 -90401.906 -91894.697  1.65%     -    0s
H   31    57                    -90412.66310 -91748.821  1.48%  11.8    0s
H   33    57                    -90561.06361 -91748.821  1.31%  11.7    0s
H   47    50                    -91351.12370 -91706.497  0.39%   9.9    0s
H  186    31                    -91519.23561 -91696.463  0.19%   7.1    0s
*  281    22              21    -91529.92361 -91646.721  0.13%   5.7    0s

Cutting planes:
  Gomory: 26
  Implied bound: 3
  MIR: 156

Explored 342 nodes (2202 simplex iterations) in 0.08 seconds (0.07 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -91529.9 -91351.1 -90561.1 ... 6.9336e+06
No other solutions better than -91529.9

Optimal solution found (tolerance 1.00e-04)
Best objective -9.152992361273e+04, best bound -9.152992361273e+04, gap 0.0000%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 117504.95
  Scenario: 10 demand increases, 50 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -91529.92
  [DEBUG]   S×d_nominal = 209034.88
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 209034.88 + -91529.92 = 117504.95
  [DEBUG]   Current θ from Master = 118024.68
  [DEBUG]   ⚠️  Z_SP ≤ θ by 519.73 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -9553.21
  Lower Bound (LB) = -9215.45
  Gap (UB-LB) = 181.9707, Absolute Gap = 181.9707, Relative Gap = 0.020144
  *** CONVERGED (gap within tolerance) ***

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 9
Total Time: 12484.58s
Converged: True
Final Lower Bound: -9215.4516
Final Upper Bound: -9033.4809
Final Gap: 181.970698
Number of Critical Scenarios: 9
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [1] (1/3)
Product 1 Plants: [2] (1/3)
Product 2 Plants: [0] (1/3)
Total Plant Openings: 3
DCs Opened: [1, 4, 6] (3/10)
Active Routes (Plant→DC): 9
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 5 customers  Mode 1: 11 customers  Mode 2: 34 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 9
Start Time: 2026-01-05 04:55:18
End Time: 2026-01-05 08:23:23
Total Time: 12484.58s
Optimal Value: -9215.45
Lower Bound: -9215.45
Upper Bound: -9033.48
Gap: 181.970698
Plants Opened: {0: [1], 1: [2], 2: [0]} (3 plants)
DCs Opened: [1, 4, 6] (3 DCs)
================================================================================

Results saved to: result/DH_single_full_seed31_LD_gamma20_20260105_082323.csv

Total Execution Time: 12484.79 seconds
End Time: 2026-01-05 08:23:23

All tasks completed successfully!

