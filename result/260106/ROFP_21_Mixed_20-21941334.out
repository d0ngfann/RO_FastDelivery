
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 21
DI Scenario: Mixed
Start Time: 2026-01-04 12:30:56
================================================================================
Loading data from data/DH_data_full_seed21.pkl...

Applying DI scenario: Mixed
DI values:
  Product 0: ['1.000', '1.440', '2.075'] (k=0.900)
  Product 1: ['1.000', '1.288', '1.660'] (k=0.625)
  Product 2: ['1.000', '1.022', '1.044'] (k=0.053)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=943, max=1719
  DC capacity (MC): min=431, max=842

Demand Structure (s_rk matrix):
  Total customer-product pairs: 84/150 (44.0% sparse)
  Average products per customer: 1.68

Demand (only non-zero entries):
  Nominal (μ): min=8.24, max=34.94, count=84
  Deviation (μ̂): min=4.05, max=9.88

Costs:
  Plant fixed cost: min=5672, max=9774
  DC fixed cost: min=3426, max=5483
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.440', '2.075'] (k=0.900)
    Product 1: ['1.000', '1.474', '2.173'] (k=0.957)
    Product 2: ['1.000', '1.444', '2.085'] (k=0.906)
  MD:
    Product 0: ['1.000', '1.180', '1.392'] (k=0.408)
    Product 1: ['1.000', '1.288', '1.660'] (k=0.625)
    Product 2: ['1.000', '1.175', '1.380'] (k=0.398)
  LD:
    Product 0: ['1.000', '1.105', '1.221'] (k=0.246)
    Product 1: ['1.000', '1.060', '1.123'] (k=0.143)
    Product 2: ['1.000', '1.022', '1.044'] (k=0.053)
  Mixed:
    Product 0: ['1.000', '1.440', '2.075'] (k=0.900)
    Product 1: ['1.000', '1.288', '1.660'] (k=0.625)
    Product 2: ['1.000', '1.022', '1.044'] (k=0.053)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48762 nonzeros
Model fingerprint: 0xb9ebc3ae
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11707 rows and 2707 columns
Presolve time: 0.08s
Presolved: 4966 rows, 5793 columns, 34451 nonzeros
Variable types: 3534 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -259068.0970
Found heuristic solution: objective -193271.6795

Root relaxation: objective 1.234778e+05, 4789 iterations, 0.18 seconds (0.30 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 123477.795    0  593 -193271.68 123477.795   164%     -    0s
H    0     0                    -175200.0747 123477.795   170%     -    0s
H    0     0                    -174340.4637 123477.795   171%     -    0s
H    0     0                    -170162.1136 113351.059   167%     -    1s
     0     0 113351.059    0  900 -170162.11 113351.059   167%     -    1s
     0     0 113012.506    0  914 -170162.11 113012.506   166%     -    1s
     0     0 113012.506    0  913 -170162.11 113012.506   166%     -    1s
     0     0 105450.545    0  901 -170162.11 105450.545   162%     -    2s
     0     0 105281.131    0  893 -170162.11 105281.131   162%     -    2s
     0     0 105267.552    0  902 -170162.11 105267.552   162%     -    2s
     0     0 105265.619    0  898 -170162.11 105265.619   162%     -    2s
H    0     0                    -156982.5461 105265.619   167%     -    2s
H    0     0                    -156911.5529 100608.542   164%     -    3s
     0     0 100608.542    0  947 -156911.55 100608.542   164%     -    3s
H    0     0                    -102952.0617 100069.489   197%     -    3s
H    0     0                    -102632.9173 100069.489   198%     -    3s
H    0     0                    -99736.98823 100069.489   200%     -    3s
H    0     0                    -99720.12689 100069.489   200%     -    3s
H    0     0                    -56356.46457 100069.489   278%     -    3s
H    0     0                    18268.069182 100069.489   448%     -    3s
H    0     0                    18316.746571 100069.489   446%     -    3s
H    0     0                    18332.666467 100069.489   446%     -    3s
     0     0 100069.489    0  943 18332.6665 100069.489   446%     -    3s
     0     0 99996.6461    0  969 18332.6665 99996.6461   445%     -    3s
     0     0 99988.4040    0  972 18332.6665 99988.4040   445%     -    3s
     0     0 99988.1093    0  965 18332.6665 99988.1093   445%     -    4s
H    0     0                    19204.811708 84225.9249   339%     -    5s
H    0     0                    21727.273980 84225.9249   288%     -    5s
H    0     0                    25030.967456 84225.9249   236%     -    5s
H    0     0                    25078.702813 84225.9249   236%     -    5s
H    0     0                    25142.570168 84225.9249   235%     -    5s
H    0     0                    25309.307407 84225.9249   233%     -    5s
     0     0 84225.9249    0  556 25309.3074 84225.9249   233%     -    5s
H    0     0                    32267.846530 82502.1924   156%     -    6s
H    0     0                    32310.498216 82502.1924   155%     -    6s
H    0     0                    32452.215102 82502.1924   154%     -    6s
H    0     0                    32517.116230 82502.1924   154%     -    6s
H    0     0                    32525.034893 82502.1924   154%     -    6s
H    0     0                    32593.316810 82502.1924   153%     -    6s
H    0     0                    32672.743133 82502.1924   153%     -    6s
     0     0 82502.1924    0  668 32672.7431 82502.1924   153%     -    6s
     0     0 82233.5963    0  576 32672.7431 82233.5963   152%     -    6s
     0     0 82187.0269    0  630 32672.7431 82187.0269   152%     -    6s
     0     0 82170.2812    0  642 32672.7431 82170.2812   151%     -    6s
     0     0 82166.6636    0  652 32672.7431 82166.6636   151%     -    6s
     0     0 78482.7916    0  814 32672.7431 78482.7916   140%     -    7s
H    0     0                    32838.272021 77861.5678   137%     -    7s
     0     0 77861.5678    0  840 32838.2720 77861.5678   137%     -    7s
H    0     0                    33061.810150 77774.7853   135%     -    8s
H    0     0                    33697.422367 77774.7853   131%     -    8s
H    0     0                    34301.682900 77774.7853   127%     -    8s
H    0     0                    34823.711944 77774.7853   123%     -    8s
H    0     0                    36106.028041 77774.7853   115%     -    8s
H    0     0                    37622.471087 77774.7853   107%     -    8s
H    0     0                    37724.356429 77774.7853   106%     -    8s
H    0     0                    37741.151651 77774.7853   106%     -    8s
H    0     0                    37806.986746 77774.7853   106%     -    8s
     0     0 77774.7853    0  894 37806.9867 77774.7853   106%     -    8s
     0     0 77754.6373    0  892 37806.9867 77754.6373   106%     -    8s
H    0     0                    37807.238877 76135.2984   101%     -    9s
     0     0 76135.2984    0  835 37807.2389 76135.2984   101%     -    9s
     0     0 75800.2907    0  871 37807.2389 75800.2907   100%     -    9s
H    0     0                    37813.741728 75730.1485   100%     -    9s
H    0     0                    38031.666207 75730.1485  99.1%     -    9s
H    0     0                    38083.632491 75730.1485  98.9%     -    9s
H    0     0                    38795.156160 75730.1485  95.2%     -    9s
H    0     0                    41318.281285 75730.1485  83.3%     -    9s
H    0     0                    41334.671951 75730.1485  83.2%     -    9s
H    0     0                    41606.896680 75730.1485  82.0%     -    9s
     0     0 75730.1485    0  898 41606.8967 75730.1485  82.0%     -    9s
     0     0 75711.6793    0  871 41606.8967 75711.6793  82.0%     -    9s
H    0     0                    43043.920597 74439.1403  72.9%     -   10s
H    0     0                    43397.044497 74439.1403  71.5%     -   10s
H    0     0                    44155.059427 74439.1403  68.6%     -   10s
H    0     0                    44278.101772 74439.1403  68.1%     -   10s
H    0     0                    44362.083843 74439.1403  67.8%     -   10s
H    0     0                    44364.278760 74439.1403  67.8%     -   10s
H    0     0                    44479.003993 74439.1403  67.4%     -   10s
     0     0 74439.1403    0  875 44479.0040 74439.1403  67.4%     -   10s
H    0     0                    44767.744565 74235.6866  65.8%     -   11s
     0     0 74235.6866    0  912 44767.7446 74235.6866  65.8%     -   11s
H    0     0                    44870.352327 74160.5120  65.3%     -   11s
H    0     0                    44997.597919 74160.5120  64.8%     -   11s
H    0     0                    45001.199062 74160.5120  64.8%     -   11s
     0     0 74160.5120    0  948 45001.1991 74160.5120  64.8%     -   11s
     0     0 74134.5869    0  953 45001.1991 74134.5869  64.7%     -   11s
H    0     0                    45012.289480 73287.8802  62.8%     -   12s
H    0     0                    45114.602961 73287.8802  62.4%     -   12s
     0     0 73287.8802    0  899 45114.6030 73287.8802  62.4%     -   12s
     0     0 72996.4719    0  890 45114.6030 72996.4719  61.8%     -   13s
     0     0 72944.4872    0  933 45114.6030 72944.4872  61.7%     -   13s
     0     0 72929.4026    0  944 45114.6030 72929.4026  61.7%     -   13s
     0     0 72347.7317    0  841 45114.6030 72347.7317  60.4%     -   14s
     0     0 72095.7803    0  928 45114.6030 72095.7803  59.8%     -   15s
     0     0 72018.9748    0  999 45114.6030 72018.9748  59.6%     -   15s
     0     0 71999.9990    0 1004 45114.6030 71999.9990  59.6%     -   15s
     0     0 71392.6801    0  945 45114.6030 71392.6801  58.2%     -   17s
     0     0 71240.8399    0 1028 45114.6030 71240.8399  57.9%     -   17s
     0     0 71194.0842    0 1026 45114.6030 71194.0842  57.8%     -   18s
     0     0 71174.4683    0 1049 45114.6030 71174.4683  57.8%     -   18s
     0     0 70714.8274    0  954 45114.6030 70714.8274  56.7%     -   19s
     0     0 70509.0649    0  968 45114.6030 70509.0649  56.3%     -   20s
     0     0 70465.9166    0  993 45114.6030 70465.9166  56.2%     -   20s
H    0     0                    45918.159977 70086.2045  52.6%     -   21s
     0     0 70086.2045    0  941 45918.1600 70086.2045  52.6%     -   21s
     0     0 69955.6954    0  954 45918.1600 69955.6954  52.3%     -   22s
     0     0 69905.2370    0  988 45918.1600 69905.2370  52.2%     -   22s
     0     0 69557.7995    0  902 45918.1600 69557.7995  51.5%     -   23s
     0     0 69557.6351    0  902 45918.1600 69557.6351  51.5%     -   23s
     0     2 69557.6351    0  902 45918.1600 69557.6351  51.5%     -   25s
    15    32 67345.4991    4  559 45918.1600 68851.1905  49.9%  3552   31s
    95   250 65341.0319    7  371 45918.1600 68003.4279  48.1%  3945   36s
H  460   491                    46046.435211 68003.4279  47.7%  1338   38s
H  515   595                    46084.656169 68003.4279  47.6%  1262   39s
H  533   595                    46656.470959 68003.4279  45.8%  1239   39s
   600   702 61094.1214   19  265 46656.4710 68003.4279  45.8%  1135   40s
H  798   798                    46689.085886 67974.8312  45.6%   938   40s
H  952   954                    47019.921004 67974.8312  44.6%   835   41s
H 1133  1056                    47119.201893 67771.8749  43.8%   786   43s
  1390  1341 52581.6817   47  150 47119.2019 67771.8749  43.8%   739   45s
H 1731  1517                    47312.701865 67529.7241  42.7%   666   47s
H 1737  1517                    48742.806956 67529.7241  38.5%   664   47s
H 1988  1682                    48747.286403 67267.2535  38.0%   628   49s
  1993  1795 50492.7831   64  116 48747.2864 67267.2535  38.0%   629   50s
H 2213  1748                    49419.808650 67081.1099  35.7%   599   51s
H 2790  2020                    49424.288097 67026.8037  35.6%   564   54s
H 2793  2012                    49468.872711 66601.7726  34.6%   565   54s
  2834  2183 58749.9727   14  171 49468.8727 66535.7415  34.5%   566   55s
H 3072  2252                    49471.239463 66535.7415  34.5%   548   57s
H 3100  2251                    49536.040164 66535.7415  34.3%   546   57s
  3560  2503 62415.6045   13  298 49536.0402 66414.3024  34.1%   537   60s
H 3922  2650                    49630.480377 66401.3918  33.8%   540   63s
H 3927  2648                    49663.668892 66401.3918  33.7%   541   63s
H 3949  2648                    49664.875632 66401.3918  33.7%   542   63s
  4236  2834 51540.8417   27  902 49664.8756 66098.0827  33.1%   531   75s
  4266  2854 57789.1520   13  530 49664.8756 62112.3531  25.1%   527   80s
  4723  2987     cutoff   22      49664.8756 56141.3188  13.0%   516   85s
  5561  2779 52275.3916   20  226 49664.8756 55110.1188  11.0%   486   90s
H 7044  1931                    49927.152257 52524.9527  5.20%   437   94s
H 7666  1617                    49940.853311 51475.9453  3.07%   408   94s
  9305   955     cutoff   82      49940.8533 50226.2870  0.57%   340   95s

Cutting planes:
  Implied bound: 3
  Projected implied bound: 15
  MIR: 179
  Flow cover: 470
  RLT: 23
  Relax-and-lift: 94

Explored 10128 nodes (3260952 simplex iterations) in 95.31 seconds (201.57 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 49940.9 49927.2 49664.9 ... 48742.8

Optimal solution found (tolerance 1.00e-04)
Best objective 4.994085331106e+04, best bound 4.994085331106e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 95.32s
  Master Objective (UB) = 49940.85, θ = 194643.13
  Upper Bound (UB) = 49940.85

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 194643.13
  [DEBUG]   ✓ Scenario 0: θ = 194643.13 ≤ Q = 194643.13 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x45eb0ec3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xba14f13d
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [3e-01, 2e+02]
Found heuristic solution: objective 1.338904e+13
Presolve removed 2575 rows and 1867 columns
Presolve time: 0.00s
Presolved: 518 rows, 522 columns, 1461 nonzeros
Found heuristic solution: objective 6776700.7031
Variable types: 354 continuous, 168 integer (168 binary)

Root relaxation: objective -1.500955e+05, 250 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -150095.52    0  123 6776700.70 -150095.52   102%     -    0s
H    0     0                    -115264.1121 -150095.52  30.2%     -    0s
H    0     0                    -115871.5310 -150095.52  29.5%     -    0s
H    0     0                    -118568.8300 -118568.83  0.00%     -    0s
     0     0          -    0      -118568.83 -118568.83  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 207

Explored 1 nodes (381 simplex iterations) in 0.01 seconds (0.02 work units)
Thread count was 32 (of 64 available processors)

Solution count 5: -118569 -115872 -115264 ... 1.3389e+13
No other solutions better than -118569

Optimal solution found (tolerance 1.00e-04)
Best objective -1.185688299790e+05, best bound -1.185688299790e+05, gap 0.0000%
  Subproblem solved in 0.03s
  Worst-case operational profit (Z_SP) = 163747.10
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -118568.83
  [DEBUG]   S×d_nominal = 282315.93
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 282315.93 + -118568.83 = 163747.10
  [DEBUG]   Current θ from Master = 194643.13
  [DEBUG]   ⚠️  Z_SP ≤ θ by 30896.03 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 19044.82
  Lower Bound (LB) = 19044.82
  Gap (UB-LB) = 30896.0345, Absolute Gap = 30896.0345, Relative Gap = 0.618653
  Not converged yet (gap = 30896.03 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 92005 nonzeros
Model fingerprint: 0x80b67f89
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve produced solution with objective 19044.8 (0.01s)
MIP start from previous solve produced solution with objective 19044.8 (0.02s)
Loaded MIP start from previous solve with objective 19044.8

Presolve removed 13363 rows and 5422 columns
Presolve time: 0.32s
Presolved: 18600 rows, 9318 columns, 103068 nonzeros
Variable types: 7059 continuous, 2259 integer (2259 binary)

Root relaxation: objective 6.146915e+04, 9666 iterations, 1.34 seconds (2.84 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 61469.1456    0  430 19044.8188 61469.1456   223%     -    1s
H    0     0                    21506.554953 61469.1456   186%     -    1s
H    0     0                    21945.638369 61469.1456   180%     -    1s
     0     0 53780.3906    0  512 21945.6384 53780.3906   145%     -    3s
H    0     0                    22062.689741 53779.5912   144%     -    3s
     0     0 53564.0681    0  518 22062.6897 53564.0681   143%     -    3s
     0     0 53543.1769    0  565 22062.6897 53543.1769   143%     -    3s
     0     0 53543.1431    0  565 22062.6897 53543.1431   143%     -    3s
     0     0 47967.2363    0  596 22062.6897 47967.2363   117%     -    5s
H    0     0                    22066.290884 47965.0711   117%     -    5s
H    0     0                    22384.692986 47148.4670   111%     -    6s
H    0     0                    22386.132691 47148.4670   111%     -    6s
H    0     0                    22393.640938 47148.4670   111%     -    6s
     0     0 47148.4670    0  613 22393.6409 47148.4670   111%     -    6s
     0     0 47029.6214    0  632 22393.6409 47029.6214   110%     -    6s
     0     0 47016.9685    0  630 22393.6409 47016.9685   110%     -    6s
     0     0 47014.9502    0  630 22393.6409 47014.9502   110%     -    6s
H    0     0                    22395.802375 43810.7237  95.6%     -    9s
H    0     0                    22400.308632 43810.7237  95.6%     -    9s
H    0     0                    22401.748337 43810.7237  95.6%     -    9s
     0     0 43810.7237    0  546 22401.7483 43810.7237  95.6%     -    9s
H    0     0                    22521.405417 43809.8710  94.5%     -    9s
     0     0 43259.8140    0  550 22521.4054 43259.8140  92.1%     -   10s
     0     0 43083.4999    0  547 22521.4054 43083.4999  91.3%     -   10s
     0     0 43040.4566    0  560 22521.4054 43040.4566  91.1%     -   10s
     0     0 43033.7016    0  556 22521.4054 43033.7016  91.1%     -   10s
     0     0 43031.5263    0  558 22521.4054 43031.5263  91.1%     -   10s
     0     0 41081.0100    0  568 22521.4054 41081.0100  82.4%     -   13s
     0     0 40649.0852    0  565 22521.4054 40649.0852  80.5%     -   14s
     0     0 40436.1605    0  621 22521.4054 40436.1605  79.5%     -   15s
     0     0 40363.9835    0  633 22521.4054 40363.9835  79.2%     -   16s
     0     0 40351.6489    0  630 22521.4054 40351.6489  79.2%     -   16s
     0     0 40338.6402    0  641 22521.4054 40338.6402  79.1%     -   16s
     0     0 40336.1078    0  639 22521.4054 40336.1078  79.1%     -   16s
     0     0 39699.6012    0  588 22521.4054 39699.6012  76.3%     -   18s
     0     0 39511.3908    0  619 22521.4054 39511.3908  75.4%     -   18s
     0     0 39474.1072    0  623 22521.4054 39474.1072  75.3%     -   19s
     0     0 39468.9305    0  628 22521.4054 39468.9305  75.3%     -   19s
     0     0 39254.6190    0  501 22521.4054 39254.6190  74.3%     -   20s
H    0     0                    22570.907833 39254.5991  73.9%     -   21s
H    0     0                    22993.732222 39254.5991  70.7%     -   22s
H    0     0                    23000.241835 39254.5991  70.7%     -   22s
H    0     0                    23000.256885 39254.5991  70.7%     -   22s
H    0     0                    23655.274086 39254.5991  65.9%     -   22s
     0     0 39215.1697    0  512 23655.2741 39215.1697  65.8%     -   22s
     0     0 39206.0300    0  521 23655.2741 39206.0300  65.7%     -   22s
     0     0 39199.3855    0  529 23655.2741 39199.3855  65.7%     -   22s
     0     0 39043.9172    0  549 23655.2741 39043.9172  65.1%     -   23s
H    0     0                    23675.836000 39043.3868  64.9%     -   23s
H    0     0                    23724.947283 39043.3868  64.6%     -   23s
     0     0 38989.4283    0  537 23724.9473 38989.4283  64.3%     -   23s
     0     0 38969.9812    0  498 23724.9473 38969.9812  64.3%     -   24s
     0     0 38964.2796    0  545 23724.9473 38964.2796  64.2%     -   24s
     0     0 38875.0062    0  514 23724.9473 38875.0062  63.9%     -   24s
     0     0 38859.0921    0  509 23724.9473 38859.0921  63.8%     -   25s
     0     0 38848.8395    0  569 23724.9473 38848.8395  63.7%     -   25s
     0     0 38843.7929    0  505 23724.9473 38843.7929  63.7%     -   25s
     0     0 38787.2793    0  554 23724.9473 38787.2793  63.5%     -   26s
H    0     0                    23777.579376 38787.0364  63.1%     -   26s
     0     0 38775.0477    0  546 23777.5794 38775.0477  63.1%     -   26s
     0     0 38766.9895    0  505 23777.5794 38766.9895  63.0%     -   26s
     0     0 38765.3708    0  499 23777.5794 38765.3708  63.0%     -   26s
     0     0 38732.4111    0  492 23777.5794 38732.4111  62.9%     -   27s
     0     0 38725.2940    0  494 23777.5794 38725.2940  62.9%     -   27s
     0     0 38677.3437    0  549 23777.5794 38677.3437  62.7%     -   27s
H    0     0                    23777.899928 38677.3103  62.7%     -   27s
H    0     0                    23781.501070 38677.3103  62.6%     -   27s
     0     0 38658.6051    0  557 23781.5011 38658.6051  62.6%     -   28s
     0     0 38653.2390    0  516 23781.5011 38653.2390  62.5%     -   28s
     0     0 38632.3522    0  506 23781.5011 38632.3522  62.4%     -   28s
     0     0 38631.5729    0  506 23781.5011 38631.5729  62.4%     -   29s
H    0     0                    23802.570049 38631.1608  62.3%     -   35s
H    0     0                    24000.545655 38631.1608  61.0%     -   35s
H    0     0                    24212.907217 38631.1608  59.5%     -   35s
H    0     0                    24554.185520 38631.1608  57.3%     -   35s
     0     2 38631.1608    0  506 24554.1855 38631.1608  57.3%     -   35s
    31    64 36544.9308    5  450 24554.1855 37533.4982  52.9%  1621   40s
H   63    96                    24578.348576 36992.5604  50.5%  1334   41s
H   67    96                    24582.270270 36992.5604  50.5%  1300   41s
H   74    96                    24586.776527 36992.5604  50.5%  1219   41s
H   87    96                    24619.493543 36991.5607  50.3%  1156   41s
H  206   268                    24739.078883 36991.5607  49.5%   775   43s
   345   376 35665.6158   10  497 24739.0789 36991.5607  49.5%   652   45s
   668   697 34643.6756   17  449 24739.0789 36975.2744  49.5%   551   50s
  1004   973 31596.8041   20  430 24739.0789 36950.8723  49.4%   522   55s
H 1373  1250                    24741.510806 36878.9770  49.1%   485   60s
  2230  1970 25465.9158   53  126 24741.5108 36716.8729  48.4%   385   65s
  3148  2474 32552.2786   15  344 24741.5108 36629.4920  48.0%   358   70s
  3725  2850 26156.0289   31  237 24741.5108 36589.9709  47.9%   358   75s
  3903  2851 25332.8458   23  506 24741.5108 36589.9709  47.9%   357   99s
  3905  2852 28187.4360   16  257 24741.5108 36589.9709  47.9%   357  101s
  3908  2854 27036.9011   26  443 24741.5108 36589.9709  47.9%   357  105s
  3921  2863 29109.6318   11  494 24741.5108 36589.9709  47.9%   356  110s
  3932  2870 27939.1444   51  510 24741.5108 36589.9709  47.9%   355  115s
  3936  2873 33122.8124   17  506 24741.5108 36589.9709  47.9%   354  121s
  3943  2887 35223.5460   16  389 24741.5108 36589.9709  47.9%   365  125s
  4065  2984 30979.2607   21  304 24741.5108 35399.2211  43.1%   387  131s
  4225  3028 28723.8852   23  212 24741.5108 35013.3311  41.5%   400  135s
  4638  2992 26181.4824   27  159 24741.5108 33488.8000  35.4%   408  140s
  4862  2961     cutoff   25      24741.5108 32960.6248  33.2%   414  145s
  5369  2890 26603.6318   24  312 24741.5108 32498.3638  31.4%   415  150s
  5723  2889     cutoff   27      24741.5108 32307.8875  30.6%   416  155s
H 5738  2739                    25801.231595 31814.7890  23.3%   416  155s
  6288  2494 28576.2937   23  341 25801.2316 30796.9336  19.4%   418  160s
  6996  2080     cutoff   25      25801.2316 29191.3773  13.1%   420  165s

Cutting planes:
  MIR: 288
  Flow cover: 639
  RLT: 11
  Relax-and-lift: 63

Explored 7845 nodes (3232658 simplex iterations) in 168.86 seconds (407.56 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 25801.2 24741.5 24739.1 ... 24000.5

Optimal solution found (tolerance 1.00e-04)
Best objective 2.580123159481e+04, best bound 2.580123159481e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 168.86s
  Master Objective (UB) = 25801.23, θ = 171870.05
  Upper Bound (UB) = 25801.23

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 171870.05
  [DEBUG]   ✓ Scenario 0: θ = 171870.05 ≤ Q = 171870.05 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 171870.05 ≤ Q = 171870.05 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x496dc547
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xb6923ab9
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.292098e+13
Presolve removed 2575 rows and 1867 columns
Presolve time: 0.00s
Presolved: 518 rows, 522 columns, 1461 nonzeros
Found heuristic solution: objective 6636857.2123
Variable types: 354 continuous, 168 integer (168 binary)

Root relaxation: objective -1.441313e+05, 275 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -144131.27    0  130 6636857.21 -144131.27   102%     -    0s
H    0     0                    -110140.4863 -144131.27  30.9%     -    0s
H    0     0                    -111402.4088 -144131.27  29.4%     -    0s
H    0     0                    -117319.1543 -144131.27  22.9%     -    0s
H    0     0                    -123695.9174 -144131.27  16.5%     -    0s
     0     0 -131180.08    0  120 -123695.92 -131180.08  6.05%     -    0s
H    0     0                    -125219.5125 -131058.87  4.66%     -    0s
H    0     0                    -128846.8868 -131058.87  1.72%     -    0s
     0     0 -131053.56    0  120 -128846.89 -131053.56  1.71%     -    0s
     0     0 -130315.18    0  109 -128846.89 -130315.18  1.14%     -    0s
H    0     0                    -128864.9406 -130310.29  1.12%     -    0s
     0     0 -130304.85    0  111 -128864.94 -130304.85  1.12%     -    0s
     0     0 -129970.49    0   79 -128864.94 -129970.49  0.86%     -    0s
     0     0 -129960.05    0   81 -128864.94 -129960.05  0.85%     -    0s
H    0     0                    -129012.1141 -129960.05  0.73%     -    0s
     0     0 -129814.11    0   74 -129012.11 -129814.11  0.62%     -    0s
     0     0 -129774.90    0   71 -129012.11 -129774.90  0.59%     -    0s
     0     0 -129601.58    0   55 -129012.11 -129601.58  0.46%     -    0s
H    0     0                    -129077.6831 -129584.52  0.39%     -    0s
     0     0 -129521.36    0   74 -129077.68 -129521.36  0.34%     -    0s
     0     0 -129516.82    0   63 -129077.68 -129516.82  0.34%     -    0s
     0     0 -129390.14    0   17 -129077.68 -129390.14  0.24%     -    0s
     0     0 -129359.07    0   26 -129077.68 -129359.07  0.22%     -    0s
     0     0 -129356.44    0   23 -129077.68 -129356.44  0.22%     -    0s
     0     0 -129339.80    0   22 -129077.68 -129339.80  0.20%     -    0s
     0     0 -129338.80    0   22 -129077.68 -129338.80  0.20%     -    0s
H    0     0                    -129101.1256 -129338.80  0.18%     -    0s
H    0     0                    -129101.3684 -129338.80  0.18%     -    0s
H    0     0                    -129168.0219 -129338.80  0.13%     -    0s
H    0     0                    -129198.8439 -129338.80  0.11%     -    0s
     0     0 -129338.80    0   52 -129198.84 -129338.80  0.11%     -    0s
     0     0 -129285.05    0   19 -129198.84 -129285.05  0.07%     -    0s
     0     0 -129233.47    0   14 -129198.84 -129233.47  0.03%     -    0s
     0     0 -129219.49    0    8 -129198.84 -129219.49  0.02%     -    0s
     0     0 -129219.49    0    9 -129198.84 -129219.49  0.02%     -    0s
H    0     0                    -129211.3264 -129219.49  0.01%     -    0s

Explored 1 nodes (1263 simplex iterations) in 0.11 seconds (0.09 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -129211 -129199 -129168 ... -123696

Optimal solution found (tolerance 1.00e-04)
Best objective -1.292113264121e+05, best bound -1.292194867419e+05, gap 0.0063%
  Subproblem solved in 0.13s
  Worst-case operational profit (Z_SP) = 149974.04
  Scenario: 51 demand increases, 9 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -129211.33
  [DEBUG]   S×d_nominal = 279185.36
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 279185.36 + -129211.33 = 149974.04
  [DEBUG]   Current θ from Master = 171870.05
  [DEBUG]   ⚠️  Z_SP ≤ θ by 21896.01 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 3905.22
  Lower Bound (LB) = 19044.82
  Gap (UB-LB) = 6756.4128, Absolute Gap = 6756.4128, Relative Gap = 0.261864
  Not converged yet (gap = 6756.41 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 51 increases, 9 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135248 nonzeros
Model fingerprint: 0xe2bff3f1
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve produced solution with objective 3905.22 (0.02s)
Loaded MIP start from previous solve with objective 3905.22

Presolve removed 20018 rows and 8128 columns
Presolve time: 0.42s
Presolved: 27235 rows, 12852 columns, 167609 nonzeros
Variable types: 10593 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...

Concurrent spin time: 0.10s

Solved with dual simplex

Root relaxation: objective 4.928006e+04, 17641 iterations, 3.44 seconds (7.08 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 49280.0573    0  258 3905.21952 49280.0573  1162%     -    4s
H    0     0                    4746.1934178 49280.0573   938%     -    4s
H    0     0                    6176.3694118 49280.0573   698%     -    4s
     0     0 43828.2851    0  287 6176.36941 43828.2851   610%     -    7s
H    0     0                    6204.6155988 43828.2851   606%     -    7s
H    0     0                    6434.2567502 43828.2851   581%     -    7s
H    0     0                    6701.6575170 43828.2851   554%     -    7s
     0     0 43680.7241    0  297 6701.65752 43680.7241   552%     -    8s
     0     0 43680.7241    0  311 6701.65752 43680.7241   552%     -    8s
     0     0 43680.7241    0  308 6701.65752 43680.7241   552%     -    8s
     0     0 43680.7241    0  307 6701.65752 43680.7241   552%     -    8s
     0     0 43680.7241    0  314 6701.65752 43680.7241   552%     -    8s
     0     0 41276.0377    0  338 6701.65752 41276.0377   516%     -   10s
H    0     0                    7436.8105815 41276.0377   455%     -   10s
H    0     0                    7731.8889789 41276.0377   434%     -   10s
H    0     0                    7787.5527327 41276.0377   430%     -   10s
H    0     0                    8012.3313737 41276.0377   415%     -   10s
     0     0 40773.1752    0  350 8012.33137 40773.1752   409%     -   11s
     0     0 40479.2078    0  343 8012.33137 40479.2078   405%     -   11s
     0     0 40417.7492    0  345 8012.33137 40417.7492   404%     -   12s
     0     0 40264.9171    0  352 8012.33137 40264.9171   403%     -   12s
     0     0 40234.5635    0  359 8012.33137 40234.5635   402%     -   12s
     0     0 40225.2832    0  359 8012.33137 40225.2832   402%     -   12s
     0     0 40223.5409    0  356 8012.33137 40223.5409   402%     -   12s
     0     0 40223.4249    0  354 8012.33137 40223.4249   402%     -   12s
H    0     0                    13301.032372 40223.4249   202%     -   14s
H    0     0                    15016.313491 40223.4249   168%     -   14s
H    0     0                    15098.603865 40223.4249   166%     -   14s
H    0     0                    15110.899565 40223.4249   166%     -   14s
H    0     0                    15115.392361 40223.4249   166%     -   14s
H    0     0                    15120.796520 40223.4249   166%     -   14s
H    0     0                    15134.476907 40223.4249   166%     -   14s
H    0     0                    15150.200270 40223.4249   165%     -   14s
H    0     0                    15152.167984 40223.4249   165%     -   14s
H    0     0                    15163.880460 40223.4249   165%     -   14s
H    0     0                    15175.100518 40223.4249   165%     -   14s
     0     0 38673.0244    0  409 15175.1005 38673.0244   155%     -   15s
H    0     0                    17474.663250 38310.5425   119%     -   16s
H    0     0                    18638.486515 38310.5425   106%     -   16s
H    0     0                    18846.394342 38310.5425   103%     -   16s
H    0     0                    18847.263460 38310.5425   103%     -   16s
H    0     0                    18847.620684 38310.5425   103%     -   16s
     0     0 38310.5425    0  430 18847.6207 38310.5425   103%     -   16s
H    0     0                    19390.419189 38220.5113  97.1%     -   16s
     0     0 38220.5113    0  453 19390.4192 38220.5113  97.1%     -   16s
     0     0 38167.2179    0  448 19390.4192 38167.2179  96.8%     -   17s
     0     0 38156.5490    0  451 19390.4192 38156.5490  96.8%     -   17s
     0     0 38153.9893    0  454 19390.4192 38153.9893  96.8%     -   17s
     0     0 38149.9454    0  456 19390.4192 38149.9454  96.7%     -   17s
     0     0 38142.3583    0  450 19390.4192 38142.3583  96.7%     -   17s
     0     0 38142.0210    0  451 19390.4192 38142.0210  96.7%     -   17s
     0     0 37345.8218    0  462 19390.4192 37345.8218  92.6%     -   20s
H    0     0                    19850.705970 37344.8066  88.1%     -   20s
H    0     0                    19966.667737 37344.8066  87.0%     -   20s
H    0     0                    19982.694977 37344.8066  86.9%     -   20s
H    0     0                    20054.177828 37344.8066  86.2%     -   20s
H    0     0                    20060.100510 37344.8066  86.2%     -   20s
H    0     0                    20066.938361 37344.8066  86.1%     -   20s
H    0     0                    20070.628948 37344.8066  86.1%     -   20s
H    0     0                    20091.969797 37344.8066  85.9%     -   20s
H    0     0                    20101.947837 37344.8066  85.8%     -   20s
     0     0 37140.3362    0  435 20101.9478 37140.3362  84.8%     -   21s
     0     0 37044.9641    0  439 20101.9478 37044.9641  84.3%     -   22s
     0     0 37025.9819    0  447 20101.9478 37025.9819  84.2%     -   22s
     0     0 37006.3880    0  443 20101.9478 37006.3880  84.1%     -   22s
     0     0 36999.3010    0  450 20101.9478 36999.3010  84.1%     -   23s
     0     0 36997.9729    0  452 20101.9478 36997.9729  84.1%     -   23s
     0     0 36868.1015    0  476 20101.9478 36868.1015  83.4%     -   24s
     0     0 36805.9298    0  484 20101.9478 36805.9298  83.1%     -   25s
     0     0 36786.2511    0  488 20101.9478 36786.2511  83.0%     -   25s
     0     0 36778.0359    0  484 20101.9478 36778.0359  83.0%     -   26s
     0     0 36774.7002    0  495 20101.9478 36774.7002  82.9%     -   26s
     0     0 36771.3669    0  495 20101.9478 36771.3669  82.9%     -   26s
     0     0 36770.4713    0  499 20101.9478 36770.4713  82.9%     -   26s
     0     0 36702.2045    0  471 20101.9478 36702.2045  82.6%     -   27s
H    0     0                    20123.400262 36702.0546  82.4%     -   27s
H    0     0                    20144.917855 36702.0546  82.2%     -   27s
     0     0 36669.0147    0  477 20144.9179 36669.0147  82.0%     -   27s
     0     0 36618.5360    0  479 20144.9179 36618.5360  81.8%     -   28s
     0     0 36605.2843    0  478 20144.9179 36605.2843  81.7%     -   28s
     0     0 36599.9626    0  482 20144.9179 36599.9626  81.7%     -   28s
     0     0 36593.6265    0  489 20144.9179 36593.6265  81.7%     -   28s
     0     0 36591.8868    0  492 20144.9179 36591.8868  81.6%     -   28s
     0     0 36591.8381    0  494 20144.9179 36591.8381  81.6%     -   28s
     0     0 36502.4462    0  466 20144.9179 36502.4462  81.2%     -   29s
     0     0 36474.9741    0  461 20144.9179 36474.9741  81.1%     -   29s
     0     0 36469.6306    0  484 20144.9179 36469.6306  81.0%     -   29s
     0     0 36464.3026    0  477 20144.9179 36464.3026  81.0%     -   30s
     0     0 36463.0043    0  480 20144.9179 36463.0043  81.0%     -   30s
     0     0 36454.5583    0  483 20144.9179 36454.5583  81.0%     -   30s
H    0     0                    20169.022818 36454.4107  80.7%     -   30s
     0     0 36451.2048    0  485 20169.0228 36451.2048  80.7%     -   31s
     0     0 36450.3691    0  490 20169.0228 36450.3691  80.7%     -   31s
     0     0 36438.5646    0  501 20169.0228 36438.5646  80.7%     -   31s
     0     0 36432.6394    0  493 20169.0228 36432.6394  80.6%     -   32s
     0     0 36427.8698    0  527 20169.0228 36427.8698  80.6%     -   32s
     0     0 36425.9708    0  532 20169.0228 36425.9708  80.6%     -   32s
     0     0 36424.6583    0  507 20169.0228 36424.6583  80.6%     -   32s
     0     0 36414.7742    0  490 20169.0228 36414.7742  80.5%     -   33s
H    0     0                    20185.821358 36414.3610  80.4%     -   33s
     0     0 36408.5619    0  483 20185.8214 36408.5619  80.4%     -   33s
     0     0 36405.4436    0  490 20185.8214 36405.4436  80.4%     -   33s
     0     0 36404.0146    0  490 20185.8214 36404.0146  80.3%     -   33s
     0     0 36389.8481    0  481 20185.8214 36389.8481  80.3%     -   34s
H    0     0                    20542.668863 36389.5901  77.1%     -   34s
H    0     0                    20557.537279 36389.5901  77.0%     -   34s
     0     0 36386.3655    0  528 20557.5373 36386.3655  77.0%     -   34s
     0     0 36383.6907    0  490 20557.5373 36383.6907  77.0%     -   34s
     0     0 36382.9212    0  483 20557.5373 36382.9212  77.0%     -   35s
     0     0 36377.6159    0  486 20557.5373 36377.6159  77.0%     -   35s
H    0     0                    20568.821666 36376.8143  76.9%     -   35s
H    0     0                    20703.180286 36376.8143  75.7%     -   35s
     0     0 36375.9201    0  503 20703.1803 36375.9201  75.7%     -   35s
     0     0 36373.2751    0  516 20703.1803 36373.2751  75.7%     -   36s
     0     0 36372.4799    0  509 20703.1803 36372.4799  75.7%     -   36s
     0     0 36367.6730    0  496 20703.1803 36367.6730  75.7%     -   36s
     0     0 36367.6644    0  496 20703.1803 36367.6644  75.7%     -   37s
H    0     0                    20734.127230 36367.6555  75.4%     -   44s
H    0     0                    21278.254284 36367.6555  70.9%     -   47s
H    0     0                    21327.959943 36367.6555  70.5%     -   47s
H    0     0                    21372.523373 36367.6555  70.2%     -   47s
H    0     0                    21848.905802 36367.6555  66.5%     -   47s
H    0     0                    21904.057319 36367.6555  66.0%     -   47s
H    0     0                    22562.513018 36367.6555  61.2%     -   47s
H    0     0                    22677.014023 36367.6555  60.4%     -   47s
H    0     0                    22708.622495 36367.6555  60.1%     -   47s
     0     2 36367.6555    0  496 22708.6225 36367.6555  60.1%     -   48s
     3     8 35821.8800    2  459 22708.6225 36085.7171  58.9%  1496   52s
    15    32 34942.9686    4  469 22708.6225 35559.8002  56.6%  3024   56s
H   32    64                    22740.147288 34941.9285  53.7%  4017   59s
H   34    64                    22755.124230 34941.9285  53.6%  3969   59s
H   44    64                    22767.228138 34941.9285  53.5%  3355   59s
H   54    64                    22769.084986 34596.1541  51.9%  3322   59s
H   57    64                    23111.666053 34596.1541  49.7%  3352   59s
    63    96 34199.3806    6  486 23111.6661 34596.1541  49.7%  3262   60s
H   98   190                    23478.399145 34588.5432  47.3%  2515   63s
   189   263 33194.4620    9  456 23478.3991 34588.5432  47.3%  1768   66s
   332   379 33900.6516   11  510 23478.3991 34588.5432  47.3%  1576   73s
H  377   379                    23479.231602 34588.5432  47.3%  1532   73s
   378   437 33761.6953   12  494 23479.2316 34588.5432  47.3%  1532   75s
H  381   437                    23483.419114 34588.5432  47.3%  1526   75s
H  409   437                    23515.552007 34588.5432  47.1%  1485   75s
H  520   599                    23523.101314 34588.5432  47.0%  1362   82s
H  535   599                    23550.850089 34588.5432  46.9%  1387   82s
H  544   599                    23637.739368 34588.5432  46.3%  1383   82s
   685   749 33125.8920   15  448 23637.7394 34588.5432  46.3%  1271   86s
H  690   749                    23680.679941 34588.5432  46.1%  1272   86s
H  720   749                    23725.538200 34588.5432  45.8%  1256   86s
H  736   749                    23847.182350 34588.5432  45.0%  1242   86s
   868   919 32088.2791   17  414 23847.1824 34463.6936  44.5%  1136   91s
H  871   919                    24000.578679 34463.6936  43.6%  1135   91s
H  879   919                    24013.339211 34463.6936  43.5%  1134   91s
H  895   919                    24014.577977 34463.6936  43.5%  1127   91s
   999   980 27429.1384   18  423 24014.5780 34463.6936  43.5%  1087   95s
H 1018   980                    24014.718060 34463.6936  43.5%  1084   95s
  1151  1147 30441.7716   19  414 24014.7181 34193.9719  42.4%  1045  101s
H 1152  1147                    24033.262845 34193.9719  42.3%  1044  101s
H 1176  1147                    24045.873642 34193.9719  42.2%  1044  101s
H 1342  1328                    24046.742760 34024.3303  41.5%  1015  105s
  1760  1707 28742.9289   24  306 24046.7428 34022.8245  41.5%   895  111s
H 1984  1778                    24084.090140 34022.3145  41.3%   855  114s
  2016  1852 28591.7912   25  350 24084.0901 34022.3145  41.3%   846  117s
H 2139  1907                    24084.959257 34005.2313  41.2%   849  120s
  2510  2173 24714.2486   30  301 24084.9593 34005.2313  41.2%   841  128s
  2657  2265 32930.4779   12  422 24084.9593 34005.2313  41.2%   841  131s
  2845  2380 30034.2401   14  354 24084.9593 33860.7869  40.6%   849  136s
  2991  2452 29137.6875   15  332 24084.9593 33841.8203  40.5%   853  140s
  3104  2566 26658.3138   17  214 24084.9593 33804.1733  40.4%   858  146s
  3270  2648 26539.5510   20  278 24084.9593 33804.1733  40.4%   851  150s
  3626  2893 24218.9466   22  228 24084.9593 33804.1733  40.4%   848  155s
  3826  2894 32262.3133   13  496 24084.9593 33804.1733  40.4%   843  190s
  3829  2896 28771.8624   37  403 24084.9593 33804.1733  40.4%   842  199s
  3830  2897 33406.2522    8  458 24084.9593 33804.1733  40.4%   842  201s
  3833  2899 24875.3369   32  504 24084.9593 33804.1733  40.4%   841  205s
  3840  2903 32236.5706    8  487 24084.9593 33804.1733  40.4%   840  210s
  3846  2907 32785.9968   13  550 24084.9593 33804.1733  40.4%   838  215s
  3851  2911 28832.6039   38  503 24084.9593 33804.1733  40.4%   837  220s
  3856  2914 28672.9967   23  570 24084.9593 33804.1733  40.4%   836  229s
  3857  2915 30413.1190   11  570 24084.9593 33804.1733  40.4%   836  233s
  3858  2918 33804.1733   12  493 24084.9593 33804.1733  40.4%   852  239s
  3860  2922 33804.1733   13  525 24084.9593 33804.1733  40.4%   854  244s
  3864  2928 33804.1733   14  469 24084.9593 33804.1733  40.4%   857  248s
  3872  2942 33804.1733   15  464 24084.9593 33804.1733  40.4%   864  252s
  3888  2964 32668.6603   16  421 24084.9593 33804.1733  40.4%   880  260s
  3918  2986 31878.2157   17  459 24084.9593 33804.1733  40.4%   938  265s
  3984  3030 31351.5390   19  396 24084.9593 33804.1733  40.4%   955  273s
H 3997  2879                    24177.803624 33804.1733  39.8%   956  273s
H 3998  2740                    24254.279636 33804.1733  39.4%   956  273s
H 4013  2603                    24382.667939 33804.1733  38.6%   956  273s
  4020  2704 27536.6579   19  391 24382.6679 33804.1733  38.6%   957  278s
  4149  2716 30186.9971   20  386 24382.6679 33804.1733  38.6%   979  282s
  4252  2690 28851.8696   21  330 24382.6679 33804.1733  38.6%  1000  285s
  4435  2644 27566.1065   24  392 24382.6679 33804.1733  38.6%  1027  291s
  4508  2635 27138.9737   25  286 24382.6679 33804.1733  38.6%  1048  295s
  4625  2648 infeasible   26      24382.6679 33804.1733  38.6%  1091  301s
  4769  2650     cutoff   30      24382.6679 32302.7538  32.5%  1101  306s
  4919  2635 29567.0983   22  258 24382.6679 32301.5299  32.5%  1123  313s
  5003  2637 27444.9652   23  227 24382.6679 31519.6665  29.3%  1136  317s
  5064  2638 27417.2024   24  226 24382.6679 31486.7863  29.1%  1145  320s
  5258  2599 26132.3829   28  162 24382.6679 31252.7460  28.2%  1161  327s
  5365  2578     cutoff   27      24382.6679 30919.0255  26.8%  1174  330s
  5517  2583     cutoff   24      24382.6679 30697.5748  25.9%  1184  337s
  5643  2551 26033.1619   25  189 24382.6679 30697.5748  25.9%  1192  340s
  5797  2493 25702.1576   27  161 24382.6679 30697.5748  25.9%  1193  345s
  6052  2455 infeasible   23      24382.6679 30139.6174  23.6%  1209  354s
  6164  2451 25991.7259   25  248 24382.6679 30139.6174  23.6%  1223  358s
  6326  2394 24619.8366   26  152 24382.6679 30139.6174  23.6%  1230  362s
  6504  2347 27657.4332   21  372 24382.6679 29905.8849  22.7%  1238  367s
  6689  2295 25038.5451   26  258 24382.6679 29852.3266  22.4%  1245  371s
  6785  2273 25262.8879   26  335 24382.6679 29852.3266  22.4%  1250  375s
  6977  2197 26618.4013   21  332 24382.6679 29791.6396  22.2%  1256  380s
  7157  2118 24640.3402   24  304 24382.6679 29329.0327  20.3%  1262  385s
  7614  1950     cutoff   26      24382.6679 28861.5154  18.4%  1274  394s
  7884  1829     cutoff   25      24382.6679 28649.7240  17.5%  1276  400s
  8089  1691 25041.7617   26  181 24382.6679 27942.3201  14.6%  1281  405s
  8373  1516 24926.5916   24  272 24382.6679 27693.0545  13.6%  1282  410s
  8671  1294     cutoff   28      24382.6679 27443.0498  12.6%  1284  415s
  9051  1006 25499.0521   24  180 24382.6679 26978.7330  10.6%  1275  421s
  9492   687     cutoff   27      24382.6679 26752.7483  9.72%  1255  426s
* 9634   515              52    24382.677977 26752.7483  9.72%  1246  426s
*10033   216              47    24382.832363 25962.1923  6.48%  1210  426s
*10083    86              51    24406.616967 25962.1923  6.37%  1205  426s
*10227    22              48    24409.560649 25702.9274  5.30%  1189  426s
*10362    22              51    24409.707911 25208.7019  3.27%  1174  426s

Cutting planes:
  MIR: 348
  Mixing: 2
  Flow cover: 902
  RLT: 10
  Relax-and-lift: 104

Explored 10450 nodes (12235200 simplex iterations) in 427.02 seconds (1252.09 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 24409.7 24409.6 24406.6 ... 24084.1

Optimal solution found (tolerance 1.00e-04)
Best objective 2.440970791073e+04, best bound 2.440970791073e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 427.04s
  Master Objective (UB) = 24409.71, θ = 166782.75
  Upper Bound (UB) = 24409.71

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 166782.75
  [DEBUG]   ✓ Scenario 0: θ = 166782.75 ≤ Q = 166782.75 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 166782.75 ≤ Q = 166782.75 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 166782.75 ≤ Q = 166782.75 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x6c431a7a
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x93bce586
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.323399e+13
Presolve removed 2581 rows and 1872 columns
Presolve time: 0.00s
Presolved: 512 rows, 517 columns, 1445 nonzeros
Found heuristic solution: objective 6665672.6629
Variable types: 350 continuous, 167 integer (167 binary)

Root relaxation: objective -1.490675e+05, 260 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -149067.47    0  124 6665672.66 -149067.47   102%     -    0s
H    0     0                    -107668.5586 -149067.47  38.5%     -    0s
H    0     0                    -107806.7843 -149067.47  38.3%     -    0s
H    0     0                    -115661.7698 -149067.47  28.9%     -    0s
H    0     0                    -116328.5782 -149067.47  28.1%     -    0s
H    0     0                    -121268.4259 -149067.47  22.9%     -    0s
H    0     0                    -122219.8085 -130055.22  6.41%     -    0s
     0     0 -130055.22    0   74 -122219.81 -130055.22  6.41%     -    0s
H    0     0                    -122905.7100 -129988.27  5.76%     -    0s
H    0     0                    -125519.8450 -129988.27  3.56%     -    0s
H    0     0                    -127935.3098 -129988.27  1.60%     -    0s
     0     0 -129926.91    0   67 -127935.31 -129926.91  1.56%     -    0s
     0     0 -129926.54    0   67 -127935.31 -129926.54  1.56%     -    0s
     0     0 -129209.14    0   67 -127935.31 -129209.14  1.00%     -    0s
H    0     0                    -128326.0869 -129197.41  0.68%     -    0s
     0     0 -129178.29    0   67 -128326.09 -129178.29  0.66%     -    0s
     0     0 -129071.68    0   67 -128326.09 -129071.68  0.58%     -    0s
     0     0 -129067.99    0   67 -128326.09 -129067.99  0.58%     -    0s
     0     2 -129067.92    0   67 -128326.09 -129067.92  0.58%     -    0s
H  100    24                    -128332.9161 -128703.14  0.29%   8.2    0s
H  671    72                    -128338.3537 -128400.75  0.05%   7.6    0s
H  677    72                    -128342.4988 -128400.75  0.05%   7.6    0s

Cutting planes:
  Gomory: 57
  Implied bound: 8
  MIR: 116
  Flow cover: 9
  RLT: 42
  BQP: 1

Explored 960 nodes (6848 simplex iterations) in 0.12 seconds (0.12 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -128342 -128338 -128333 ... -116329
No other solutions better than -128342

Optimal solution found (tolerance 1.00e-04)
Best objective -1.283424987564e+05, best bound -1.283424987564e+05, gap 0.0000%
  Subproblem solved in 0.13s
  Worst-case operational profit (Z_SP) = 150783.82
  Scenario: 22 demand increases, 38 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -128342.50
  [DEBUG]   S×d_nominal = 279126.32
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 279126.32 + -128342.50 = 150783.82
  [DEBUG]   Current θ from Master = 166782.75
  [DEBUG]   ⚠️  Z_SP ≤ θ by 15998.93 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 8410.78
  Lower Bound (LB) = 19044.82
  Gap (UB-LB) = 5364.8891, Absolute Gap = 5364.8891, Relative Gap = 0.219785
  Not converged yet (gap = 5364.89 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 22 increases, 38 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178491 nonzeros
Model fingerprint: 0x3091eb83
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve produced solution with objective 8410.78 (0.04s)
Loaded MIP start from previous solve with objective 8410.78

Presolve removed 26704 rows and 10844 columns
Presolve time: 0.55s
Presolved: 35839 rows, 16376 columns, 221599 nonzeros
Variable types: 14117 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 35839 rows, 16376 columns, 221599 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   47226    2.5890818e+04   0.000000e+00   4.838556e+06      5s
Concurrent spin time: 2.04s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 4.926991e+04, 37413 iterations, 9.42 seconds (18.47 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 49269.9067    0  261 8410.77868 49269.9067   486%     -   10s
H    0     0                    19227.026934 49269.9067   156%     -   10s
H    0     0                    19721.808967 49269.9067   150%     -   10s
H    0     0                    19785.700054 49269.9067   149%     -   10s
H    0     0                    20563.424602 49269.9067   140%     -   10s
H    0     0                    20665.446971 49269.9067   138%     -   10s
H    0     0                    20666.242791 49269.9067   138%     -   10s
H    0     0                    22284.062016 49269.9067   121%     -   10s
H    0     0                    22602.671985 49269.9067   118%     -   10s
     0     0 43791.4944    0  309 22602.6720 43791.4944  93.7%     -   14s
     0     0 42860.5994    0  305 22602.6720 42860.5994  89.6%     -   16s
     0     0 42483.8334    0  309 22602.6720 42483.8334  88.0%     -   17s
     0     0 42384.9682    0  314 22602.6720 42384.9682  87.5%     -   17s
     0     0 42353.1127    0  318 22602.6720 42353.1127  87.4%     -   17s
     0     0 42350.1660    0  322 22602.6720 42350.1660  87.4%     -   18s
     0     0 42350.0908    0  322 22602.6720 42350.0908  87.4%     -   18s
     0     0 40199.2821    0  391 22602.6720 40199.2821  77.9%     -   21s
H    0     0                    22644.746864 40199.2647  77.5%     -   21s
H    0     0                    22797.342127 40199.2647  76.3%     -   22s
     0     0 39667.9186    0  396 22797.3421 39667.9186  74.0%     -   23s
     0     0 39484.6563    0  396 22797.3421 39484.6563  73.2%     -   24s
     0     0 39355.0212    0  390 22797.3421 39355.0212  72.6%     -   24s
     0     0 39333.8552    0  386 22797.3421 39333.8552  72.5%     -   25s
     0     0 39326.0840    0  386 22797.3421 39326.0840  72.5%     -   25s
     0     0 39323.1665    0  394 22797.3421 39323.1665  72.5%     -   25s
     0     0 39322.8770    0  396 22797.3421 39322.8770  72.5%     -   25s
     0     0 38099.3585    0  387 22797.3421 38099.3585  67.1%     -   30s
     0     0 37740.7243    0  445 22797.3421 37740.7243  65.5%     -   32s
     0     0 37583.5774    0  453 22797.3421 37583.5774  64.9%     -   33s
     0     0 37529.0714    0  469 22797.3421 37529.0714  64.6%     -   34s
     0     0 37517.4931    0  476 22797.3421 37517.4931  64.6%     -   34s
     0     0 37509.4267    0  474 22797.3421 37509.4267  64.5%     -   34s
     0     0 37506.8367    0  465 22797.3421 37506.8367  64.5%     -   34s
     0     0 37506.6780    0  467 22797.3421 37506.6780  64.5%     -   35s
H    0     0                    22799.909824 37506.6780  64.5%     -   37s
H    0     0                    22878.338951 37506.6780  63.9%     -   37s
     0     0 36985.2152    0  432 22878.3390 36985.2152  61.7%     -   40s
     0     0 36799.6693    0  471 22878.3390 36799.6693  60.8%     -   43s
     0     0 36706.2420    0  482 22878.3390 36706.2420  60.4%     -   44s
     0     0 36681.2538    0  453 22878.3390 36681.2538  60.3%     -   45s
     0     0 36662.7336    0  461 22878.3390 36662.7336  60.3%     -   46s
     0     0 36644.6194    0  457 22878.3390 36644.6194  60.2%     -   46s
     0     0 36633.5162    0  458 22878.3390 36633.5162  60.1%     -   46s
     0     0 36617.0583    0  455 22878.3390 36617.0583  60.1%     -   47s
     0     0 36605.8894    0  489 22878.3390 36605.8894  60.0%     -   47s
     0     0 36601.1727    0  456 22878.3390 36601.1727  60.0%     -   47s
     0     0 36598.2794    0  458 22878.3390 36598.2794  60.0%     -   48s
     0     0 36597.1770    0  461 22878.3390 36597.1770  60.0%     -   48s
     0     0 36493.3023    0  453 22878.3390 36493.3023  59.5%     -   49s
     0     0 36473.0968    0  457 22878.3390 36473.0968  59.4%     -   50s
     0     0 36464.2111    0  462 22878.3390 36464.2111  59.4%     -   50s
     0     0 36461.3159    0  496 22878.3390 36461.3159  59.4%     -   51s
     0     0 36459.2017    0  469 22878.3390 36459.2017  59.4%     -   51s
     0     0 36459.0142    0  472 22878.3390 36459.0142  59.4%     -   51s
     0     0 36419.1338    0  510 22878.3390 36419.1338  59.2%     -   52s
     0     0 36402.7828    0  516 22878.3390 36402.7828  59.1%     -   52s
     0     0 36395.3011    0  516 22878.3390 36395.3011  59.1%     -   53s
     0     0 36393.4774    0  513 22878.3390 36393.4774  59.1%     -   53s
     0     0 36392.6182    0  516 22878.3390 36392.6182  59.1%     -   53s
     0     0 36382.2083    0  474 22878.3390 36382.2083  59.0%     -   54s
     0     0 36376.3478    0  519 22878.3390 36376.3478  59.0%     -   54s
     0     0 36374.5214    0  522 22878.3390 36374.5214  59.0%     -   54s
     0     0 36373.9294    0  475 22878.3390 36373.9294  59.0%     -   55s
     0     0 36367.3414    0  486 22878.3390 36367.3414  59.0%     -   55s
     0     0 36365.3257    0  489 22878.3390 36365.3257  59.0%     -   56s
     0     0 36364.5709    0  488 22878.3390 36364.5709  58.9%     -   56s
     0     0 36361.7179    0  497 22878.3390 36361.7179  58.9%     -   57s
     0     0 36357.8200    0  490 22878.3390 36357.8200  58.9%     -   57s
     0     0 36356.7975    0  498 22878.3390 36356.7975  58.9%     -   57s
     0     0 36348.6042    0  495 22878.3390 36348.6042  58.9%     -   58s
     0     0 36348.4600    0  495 22878.3390 36348.4600  58.9%     -   58s
     0     2 36348.4444    0  495 22878.3390 36348.4444  58.9%     -   68s
     1     4 36065.9169    1  462 22878.3390 36347.9436  58.9%  3220   70s
     7    16 35637.5696    3  498 22878.3390 35734.9956  56.2%  3801   78s
    15    32 35145.8424    4  464 22878.3390 35631.6680  55.7%  4319   82s
    31    53 33966.0822    5  467 22878.3390 35145.0912  53.6%  5555   93s
    52    85 32962.9601    6  487 22878.3390 35145.0912  53.6%  5651   95s
H   57    85                    23413.031694 35145.0912  50.1%  5335   95s
H   73    85                    23452.738339 35145.0912  49.9%  4599   95s
    84   213 32864.4760    7  473 23452.7383 35145.0912  49.9%  4212  103s
H  212   303                    23575.686716 35145.0912  49.1%  2218  106s
H  213   303                    23662.582348 35145.0912  48.5%  2216  106s
H  227   303                    23729.831761 35145.0912  48.1%  2157  106s
H  232   303                    23815.112546 35145.0912  47.6%  2155  106s
H  244   303                    23867.073905 35145.0912  47.3%  2086  106s
H  258   303                    23867.869725 35145.0912  47.2%  2038  106s
H  271   303                    23962.032190 35145.0912  46.7%  1987  106s
   302   393 32474.5709   10  436 23962.0322 35145.0912  46.7%  1866  112s
   458   514 32675.9659   11  460 23962.0322 35145.0912  46.7%  1542  117s
   544   549 32511.1507   11  379 23962.0322 35145.0912  46.7%  1446  121s
   614   594 32461.3544   10  380 23962.0322 35145.0912  46.7%  1394  126s
   687   628 30979.0653   11  173 23962.0322 35145.0912  46.7%  1364  130s
   723   664 32677.5178   11  441 23962.0322 35145.0912  46.7%  1359  136s
   824   759 32090.5859   13  427 23962.0322 35145.0912  46.7%  1323  140s
   882   798 31925.8354   14  362 23962.0322 35145.0912  46.7%  1291  146s
   951   822 31834.2863   16  355 23962.0322 35145.0912  46.7%  1276  152s
   989   859 31718.3080   17  370 23962.0322 34853.1968  45.5%  1272  155s
  1070   936 30578.5396   18  303 23962.0322 34845.2330  45.4%  1274  161s
  1133   986 29726.9874   18  143 23962.0322 34845.2330  45.4%  1251  167s
  1202  1033 29895.2766   20  283 23962.0322 34845.2330  45.4%  1248  173s
  1279  1081 29593.0866   22  280 23962.0322 34845.2330  45.4%  1253  179s
  1367  1153 27895.1088   23  230 23962.0322 34574.0140  44.3%  1243  184s
  1459  1248 28517.5124   28  215 23962.0322 34555.0055  44.2%  1241  187s
  1582  1339 27359.6238   33  168 23962.0322 34555.0055  44.2%  1219  192s
  1707  1413 27466.9172   35  183 23962.0322 34555.0055  44.2%  1203  197s
  1833  1466 27348.8743   37  165 23962.0322 34529.5706  44.1%  1198  202s
  1952  1529     cutoff   38      23962.0322 34529.5706  44.1%  1197  207s
  2101  1575     cutoff   37      23962.0322 34529.5706  44.1%  1215  212s
  2157  1597     cutoff   38      23962.0322 34529.5706  44.1%  1215  218s
H 2179  1597                    24002.097743 34529.5706  43.9%  1216  218s
  2218  1691     cutoff   40      24002.0977 34529.5706  43.9%  1215  224s
  2401  1760 32418.6988    6  424 24002.0977 33839.9830  41.0%  1192  229s
  2569  1782 32033.0396    7  423 24002.0977 33839.9830  41.0%  1183  235s
H 2572  1782                    24004.286635 33839.9830  41.0%  1183  235s
  2635  1858 31713.1589    8  375 24004.2866 33839.9830  41.0%  1193  240s
  2764  1947 31052.0845   10  365 24004.2866 33839.9830  41.0%  1207  245s
  2893  2049 30333.4819   12  272 24004.2866 33839.9830  41.0%  1220  252s
  3074  2152 29009.2139   17  225 24004.2866 33839.9830  41.0%  1214  259s
  3290  2259 26980.6949   21  181 24004.2866 33703.6599  40.4%  1199  265s
  3464  2356 24919.7251   29  171 24004.2866 33703.6599  40.4%  1198  271s
  3693  2415 30418.1204   14  318 24004.2866 33703.6599  40.4%  1188  277s
  3814  2537 28910.3712   15  272 24004.2866 33555.4689  39.8%  1188  285s
  4073  2590 26066.9681   18  330 24004.2866 33379.2665  39.1%  1168  291s
  4261  2679 24742.4567   20  280 24004.2866 33379.2665  39.1%  1162  298s
  4488  2701 29998.4167    8  365 24004.2866 33301.3784  38.7%  1158  302s
H 4499  2701                    24022.717624 33300.4958  38.6%  1160  302s
  4530  2788 29680.0521    9  293 24022.7176 33300.4958  38.6%  1163  311s
  4755  2967 27186.0054   14  210 24022.7176 33300.4958  38.6%  1168  317s
  5060  2968 29556.2689   14  495 24022.7176 33210.9620  38.2%  1155  369s
  5062  2969 29323.2215   20  261 24022.7176 33210.9620  38.2%  1154  377s
  5063  2970 25739.2368   18  434 24022.7176 33210.9620  38.2%  1154  387s
  5064  2971 32663.7279    6  445 24022.7176 33210.9620  38.2%  1154  390s
  5066  2972 31457.8116   16  443 24022.7176 33210.9620  38.2%  1153  396s
  5069  2974 30475.0886   26  472 24022.7176 33210.9620  38.2%  1153  400s
  5075  2978 29942.9492   10  481 24022.7176 33210.9620  38.2%  1151  405s
  5078  2980 31643.1430    7  525 24022.7176 33210.9620  38.2%  1151  410s
  5082  2983 30107.8674   14  495 24022.7176 33210.9620  38.2%  1150  415s
  5085  2985 28677.4136   31  546 24022.7176 33210.9620  38.2%  1149  420s
  5088  2987 24510.3429   18  578 24022.7176 33210.9620  38.2%  1148  425s
  5091  2989 26444.1225   20  538 24022.7176 33210.9620  38.2%  1148  430s
  5092  2989 32266.3428   13  538 24022.7176 33210.9620  38.2%  1148  439s
  5093  2990 29030.2836   16  538 24022.7176 33210.9620  38.2%  1147  447s
  5094  2994 33210.9620   14  532 24022.7176 33210.9620  38.2%  1165  453s
  5096  2997 33210.9620   15  486 24022.7176 33210.9620  38.2%  1165  459s
  5100  3004 33210.9620   16  497 24022.7176 33210.9620  38.2%  1167  465s
  5108  3017 33210.9620   17  508 24022.7176 33210.9620  38.2%  1172  471s
  5124  3035 33210.9620   18  460 24022.7176 33210.9620  38.2%  1190  482s
  5147  3058 33210.9620   19  436 24022.7176 33210.9620  38.2%  1211  488s
  5179  3094 33210.9620   20  471 24022.7176 33210.9620  38.2%  1232  496s
  5230  3111 33210.9620   21  431 24022.7176 33210.9620  38.2%  1239  502s
  5264  3167 33143.2107   21  379 24022.7176 33210.9620  38.2%  1246  511s
  5342  3207 31940.6873   22  402 24022.7176 33210.9620  38.2%  1279  518s
  5441  3224 33210.9620   23  461 24022.7176 33210.9620  38.2%  1295  527s
  5531  3232 29039.0322   24  369 24022.7176 33210.9620  38.2%  1309  534s
  5614  3219 32534.9939   25  356 24022.7176 33210.9620  38.2%  1323  540s
  5714  3207 31793.4049   26  402 24022.7176 33210.9620  38.2%  1330  546s
  5799  3203 31245.6309   27  422 24022.7176 33210.9620  38.2%  1342  551s
  5868  3222 25028.4161   27  392 24022.7176 33210.9620  38.2%  1352  555s
  5932  3233 29993.2275   28  280 24022.7176 33210.9620  38.2%  1360  560s
  6006  3236 29431.4533   28  347 24022.7176 33210.9620  38.2%  1367  566s
  6099  3234 29933.4653   29  273 24022.7176 33210.9620  38.2%  1370  572s
  6197  3242 28606.1352   30  341 24022.7176 33145.3893  38.0%  1373  578s
  6311  3244 27838.4111   31  320 24022.7176 33145.3893  38.0%  1371  586s
  6417  3231 27083.0040   32  292 24022.7176 33092.1447  37.8%  1371  591s
  6510  3224 infeasible   33      24022.7176 32961.6258  37.2%  1377  597s
  6574  3243     cutoff   34      24022.7176 32961.6258  37.2%  1381  602s
  6649  3243     cutoff   24      24022.7176 32724.3625  36.2%  1386  609s
  6749  3246 27946.3109   24  418 24022.7176 32724.3625  36.2%  1391  615s
  6861  3229 26896.3101   25  400 24022.7176 32724.3625  36.2%  1396  623s
  6980  3237 26132.8586   27  310 24022.7176 32724.3625  36.2%  1401  630s
  7082  3249     cutoff   30      24022.7176 32426.1267  35.0%  1411  637s
  7214  3237 24534.9832   23  129 24022.7176 32377.4609  34.8%  1417  647s
  7344  3234 30061.0272   25  462 24022.7176 32377.4609  34.8%  1426  655s
  7479  3231 28600.4396   27  354 24022.7176 32261.1189  34.3%  1434  663s
  7618  3199 26358.7301   30  228 24022.7176 32234.1544  34.2%  1440  669s
  7720  3187     cutoff   32      24022.7176 31863.1172  32.6%  1443  677s
  7883  3156     cutoff   31      24022.7176 31863.1172  32.6%  1447  686s
  8057  3152 29292.7496   22  367 24022.7176 31689.1365  31.9%  1455  694s
  8240  3104 27658.3385   26  205 24022.7176 31689.1365  31.9%  1458  702s
  8447  3077 26225.5580   28  248 24022.7176 31204.0932  29.9%  1459  711s
  8637  3033 27953.3755   23  314 24022.7176 31204.0932  29.9%  1465  719s
  8850  3000 26071.4371   26  281 24022.7176 30640.7434  27.5%  1467  728s
  9002  2962     cutoff   27      24022.7176 30508.0056  27.0%  1466  737s
  9240  2935 28115.2438   27  317 24022.7176 30508.0056  27.0%  1464  748s
  9505  2875     cutoff   35      24022.7176 30477.3971  26.9%  1462  759s
  9750  2833 26236.2926   29  253 24022.7176 30087.5944  25.2%  1467  770s
 10011  2795     cutoff   29      24022.7176 29863.3606  24.3%  1470  779s
 10275  2747     cutoff   31      24022.7176 29725.7696  23.7%  1474  791s
 10587  2688 25510.9321   26  336 24022.7176 29725.7696  23.7%  1474  803s
 10908  2610 25914.0465   31  318 24022.7176 29500.0579  22.8%  1475  813s
 11233  2531 26290.5520   23  405 24022.7176 29265.4459  21.8%  1476  825s
 11621  2409     cutoff   30      24022.7176 29163.9212  21.4%  1475  836s
 11818  2319     cutoff   22      24022.7176 28843.0526  20.1%  1476  849s
 12249  2216 27604.6623   24  280 24022.7176 28621.3894  19.1%  1472  863s
 12713  2048 24532.2598   28  175 24022.7176 28490.9383  18.6%  1468  876s
 13192  1874 26756.0344   31  362 24022.7176 28160.0677  17.2%  1464  889s
 13704  1641 24876.9795   29  273 24022.7176 27974.7520  16.5%  1461  906s
 14221  1389     cutoff   29      24022.7176 27688.2135  15.3%  1459  920s
 14752  1302 24372.8020   31  289 24022.7176 27431.5736  14.2%  1458  934s
 15163  1061 infeasible   28      24022.7176 27377.7751  14.0%  1452  948s
 15843   702 infeasible   30      24022.7176 26960.6168  12.2%  1440  963s
*16105   702              58    24029.682177 26956.7989  12.2%  1429  963s
 16661   184 24289.6807   31  399 24029.6822 26382.1688  9.79%  1418  976s
*17245   184              66    24032.330337 26287.2149  9.38%  1380  976s
*17263   184              68    24039.855607 26287.2149  9.35%  1379  976s
*17265   184              69    24039.979571 26287.2149  9.35%  1378  976s
*17269   184              69    24044.685098 26287.2149  9.33%  1378  976s
*18310   101              50    24067.480257 25547.0991  6.15%  1322  978s
*18902   101              52    24068.286151 25547.0991  6.14%  1282  978s
*18904   101              51    24068.296626 25547.0991  6.14%  1282  978s
*18918   101              56    24111.134308 25547.0991  5.96%  1281  978s

Cutting planes:
  MIR: 614
  Mixing: 1
  Flow cover: 1310
  RLT: 34
  Relax-and-lift: 99

Explored 19586 nodes (24366855 simplex iterations) in 978.62 seconds (2898.49 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 24111.1 24068.3 24068.3 ... 24022.7

Optimal solution found (tolerance 1.00e-04)
Best objective 2.411113430769e+04, best bound 2.411113430769e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 978.63s
  Master Objective (UB) = 24111.13, θ = 167194.63
  Upper Bound (UB) = 24111.13

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 167194.63
  [DEBUG]   ✓ Scenario 0: θ = 167194.63 ≤ Q = 167194.63 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 167194.63 ≤ Q = 167194.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 167194.63 ≤ Q = 167194.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 167194.63 ≤ Q = 167194.63 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x1d6509e7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xe29af619
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [3e-01, 2e+02]
Found heuristic solution: objective 1.224642e+13
Presolve removed 2600 rows and 1888 columns
Presolve time: 0.00s
Presolved: 493 rows, 501 columns, 1394 nonzeros
Found heuristic solution: objective 5944165.8196
Variable types: 337 continuous, 164 integer (164 binary)
Found heuristic solution: objective 5943736.8047

Root relaxation: objective -1.477608e+05, 235 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -147760.77    0  119 5943736.80 -147760.77   102%     -    0s
H    0     0                    -111371.4947 -147760.77  32.7%     -    0s
H    0     0                    -111738.1632 -147760.77  32.2%     -    0s
H    0     0                    -121678.8277 -147760.77  21.4%     -    0s
H    0     0                    -123285.9275 -147760.77  19.9%     -    0s
     0     0 -132947.70    0   88 -123285.93 -132947.70  7.84%     -    0s
H    0     0                    -130394.2075 -132830.14  1.87%     -    0s
     0     0 -132488.30    0   87 -130394.21 -132488.30  1.61%     -    0s
H    0     0                    -130527.4876 -132488.30  1.50%     -    0s
     0     0 -131885.04    0   48 -130527.49 -131885.04  1.04%     -    0s
H    0     0                    -130780.7737 -131785.77  0.77%     -    0s
     0     0 -131785.77    0   49 -130780.77 -131785.77  0.77%     -    0s
     0     0 -131785.77    0   47 -130780.77 -131785.77  0.77%     -    0s
     0     0 -131507.52    0   28 -130780.77 -131507.52  0.56%     -    0s
     0     0 -131460.54    0   35 -130780.77 -131460.54  0.52%     -    0s
     0     0 -131452.52    0   35 -130780.77 -131452.52  0.51%     -    0s
     0     0 -131197.13    0   19 -130780.77 -131197.13  0.32%     -    0s
     0     0 -131127.19    0   23 -130780.77 -131127.19  0.26%     -    0s
     0     0 -131113.55    0   23 -130780.77 -131113.55  0.25%     -    0s
     0     0 -131027.66    0   19 -130780.77 -131027.66  0.19%     -    0s
     0     0 -131014.08    0   18 -130780.77 -131014.08  0.18%     -    0s
     0     0 -131014.08    0   17 -130780.77 -131014.08  0.18%     -    0s
     0     0 -130963.41    0   17 -130780.77 -130963.41  0.14%     -    0s
     0     0 -130963.41    0   25 -130780.77 -130963.41  0.14%     -    0s
     0     0 -130845.30    0   12 -130780.77 -130845.30  0.05%     -    0s
H    0     0                    -130829.9063 -130844.39  0.01%     -    0s
     0     0          -    0      -130829.91 -130838.41  0.01%     -    0s

Cutting planes:
  Gomory: 13
  MIR: 8
  Flow cover: 10
  Relax-and-lift: 4

Explored 1 nodes (965 simplex iterations) in 0.08 seconds (0.06 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -130830 -130781 -130744 ... 5.94374e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.308299062514e+05, best bound -1.308384083852e+05, gap 0.0065%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 147773.45
  Scenario: 42 demand increases, 18 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -130829.91
  [DEBUG]   S×d_nominal = 278603.36
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 278603.36 + -130829.91 = 147773.45
  [DEBUG]   Current θ from Master = 167194.63
  [DEBUG]   ⚠️  Z_SP ≤ θ by 19421.18 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 4689.95
  Lower Bound (LB) = 19044.82
  Gap (UB-LB) = 5066.3155, Absolute Gap = 5066.3155, Relative Gap = 0.210123
  Not converged yet (gap = 5066.32 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 42 increases, 18 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221734 nonzeros
Model fingerprint: 0xcba34699
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 33370 rows and 13550 columns
Presolve time: 0.68s
Presolved: 44463 rows, 19910 columns, 275649 nonzeros
Variable types: 17651 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -326728.6770
Found heuristic solution: objective -184683.4741

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 44463 rows, 19910 columns, 275649 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   32627    2.4647197e+04   0.000000e+00   1.174038e+07      5s
   46704    3.3574450e+04   0.000000e+00   4.018903e+07     10s
Concurrent spin time: 2.08s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 4.924374e+04, 43379 iterations, 13.22 seconds (26.25 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 49243.7368    0  259 -184683.47 49243.7368   127%     -   14s
H    0     0                    -172875.3589 49243.7368   128%     -   14s
H    0     0                    -169557.5677 49243.7368   129%     -   14s
H    0     0                    -86632.86089 49243.7368   157%     -   14s
H    0     0                    -86180.07814 49243.7368   157%     -   14s
H    0     0                    -49969.16586 49243.7368   199%     -   14s
H    0     0                    -18278.18533 49243.7368   369%     -   14s
H    0     0                    -4291.163312 49243.7368  1248%     -   14s
H    0     0                    -466.6134022 49243.7368      -     -   14s
H    0     0                     969.3906149 49243.7368  4980%     -   15s
H    0     0                    4809.9201982 49243.7368   924%     -   15s
H    0     0                    4818.0559990 49243.7368   922%     -   15s
     0     0 44321.0467    0  252 4818.05600 44321.0467   820%     -   21s
H    0     0                    5043.8671126 44321.0467   779%     -   21s
     0     0 42336.0671    0  335 5043.86711 42336.0671   739%     -   25s
     0     0 42328.1244    0  339 5043.86711 42328.1244   739%     -   28s
     0     0 42328.1244    0  328 5043.86711 42328.1244   739%     -   29s
     0     0 42328.1244    0  281 5043.86711 42328.1244   739%     -   30s
     0     0 40542.6646    0  330 5043.86711 40542.6646   704%     -   30s
     0     0 40540.4094    0  274 5043.86711 40540.4094   704%     -   30s
     0     0 40540.4094    0  274 5043.86711 40540.4094   704%     -   30s
     0     0 40536.7904    0  346 5043.86711 40536.7904   704%     -   35s
H    0     0                    7722.9204545 40536.7062   425%     -   35s
H    0     0                    7724.3601602 40536.7062   425%     -   35s
     0     0 39928.4237    0  370 7724.36016 39928.4237   417%     -   38s
     0     0 39758.6429    0  376 7724.36016 39758.6429   415%     -   39s
     0     0 39717.8075    0  374 7724.36016 39717.8075   414%     -   40s
     0     0 39631.6226    0  361 7724.36016 39631.6226   413%     -   40s
     0     0 39605.7899    0  374 7724.36016 39605.7899   413%     -   41s
     0     0 39593.3229    0  372 7724.36016 39593.3229   413%     -   41s
     0     0 39574.9163    0  372 7724.36016 39574.9163   412%     -   42s
     0     0 39573.1125    0  372 7724.36016 39573.1125   412%     -   42s
     0     0 39571.7760    0  370 7724.36016 39571.7760   412%     -   42s
     0     0 39571.2734    0  397 7724.36016 39571.2734   412%     -   42s
H    0     0                    8027.1936779 39571.2734   393%     -   46s
H    0     0                    8056.8938318 39571.2734   391%     -   46s
H    0     0                    8421.9988505 39571.2734   370%     -   46s
H    0     0                    8483.9913554 39571.2734   366%     -   46s
H    0     0                    8499.3416987 38406.8659   352%     -   50s
     0     0 38406.8659    0  414 8499.34170 38406.8659   352%     -   50s
H    0     0                    8511.0865012 38406.5822   351%     -   51s
H    0     0                    8532.1554801 38406.5822   350%     -   51s
H    0     0                    8619.4048863 38406.5822   346%     -   51s
     0     0 37861.1475    0  438 8619.40489 37861.1475   339%     -   55s
H    0     0                    9613.2382310 37670.2862   292%     -   57s
H    0     0                    10016.183336 37670.2862   276%     -   57s
H    0     0                    10392.901365 37670.2862   262%     -   57s
H    0     0                    14869.706848 37670.2862   153%     -   57s
H    0     0                    14915.075148 37670.2862   153%     -   57s
H    0     0                    15005.546338 37670.2862   151%     -   57s
H    0     0                    15033.487799 37670.2862   151%     -   57s
H    0     0                    15055.737077 37670.2862   150%     -   57s
     0     0 37670.2862    0  404 15055.7371 37670.2862   150%     -   57s
     0     0 37517.7207    0  436 15055.7371 37517.7207   149%     -   60s
     0     0 37482.0426    0  432 15055.7371 37482.0426   149%     -   61s
H    0     0                    18063.960794 37451.0848   107%     -   62s
H    0     0                    18600.141221 37451.0848   101%     -   62s
H    0     0                    18651.018413 37451.0848   101%     -   62s
H    0     0                    18756.811578 37451.0848   100%     -   62s
     0     0 37451.0848    0  448 18756.8116 37451.0848   100%     -   62s
     0     0 37435.9449    0  439 18756.8116 37435.9449   100%     -   63s
     0     0 37423.5730    0  440 18756.8116 37423.5730   100%     -   63s
     0     0 37413.0459    0  439 18756.8116 37413.0459  99.5%     -   63s
     0     0 37403.8894    0  443 18756.8116 37403.8894  99.4%     -   64s
     0     0 37401.1837    0  439 18756.8116 37401.1837  99.4%     -   64s
     0     0 37400.4457    0  445 18756.8116 37400.4457  99.4%     -   64s
     0     0 36906.8853    0  475 18756.8116 36906.8853  96.8%     -   72s
H    0     0                    18759.267680 36906.6872  96.7%     -   72s
H    0     0                    19376.774077 36906.6872  90.5%     -   73s
H    0     0                    19402.464880 36906.6872  90.2%     -   73s
H    0     0                    19449.027669 36906.6872  89.8%     -   73s
H    0     0                    19521.043509 36906.6872  89.1%     -   73s
H    0     0                    19523.148616 36906.6872  89.0%     -   73s
H    0     0                    19542.736088 36906.6872  88.9%     -   73s
H    0     0                    19542.904032 36906.6872  88.8%     -   73s
     0     0 36788.4238    0  485 19542.9040 36788.4238  88.2%     -   75s
     0     0 36735.9238    0  518 19542.9040 36735.9238  88.0%     -   75s
     0     0 36703.6240    0  526 19542.9040 36703.6240  87.8%     -   76s
     0     0 36694.3888    0  533 19542.9040 36694.3888  87.8%     -   77s
     0     0 36688.8260    0  545 19542.9040 36688.8260  87.7%     -   77s
     0     0 36686.8986    0  538 19542.9040 36686.8986  87.7%     -   77s
     0     0 36685.9480    0  535 19542.9040 36685.9480  87.7%     -   78s
     0     0 36575.5496    0  500 19542.9040 36575.5496  87.2%     -   80s
H    0     0                    19768.318531 36548.6493  84.9%     -   81s
     0     0 36548.6493    0  512 19768.3185 36548.6493  84.9%     -   81s
     0     0 36538.4295    0  500 19768.3185 36538.4295  84.8%     -   81s
     0     0 36523.3746    0  506 19768.3185 36523.3746  84.8%     -   82s
     0     0 36520.7428    0  508 19768.3185 36520.7428  84.7%     -   82s
     0     0 36519.9945    0  507 19768.3185 36519.9945  84.7%     -   82s
H    0     0                    19813.828671 36519.9945  84.3%     -   83s
     0     0 36490.9510    0  519 19813.8287 36490.9510  84.2%     -   84s
H    0     0                    20142.888004 36490.2025  81.2%     -   84s
H    0     0                    20147.394261 36490.2025  81.1%     -   84s
H    0     0                    20167.542253 36490.2025  80.9%     -   84s
H    0     0                    20174.398173 36490.2025  80.9%     -   84s
     0     0 36480.7084    0  533 20174.3982 36480.7084  80.8%     -   85s
     0     0 36478.7895    0  530 20174.3982 36478.7895  80.8%     -   85s
     0     0 36477.6483    0  533 20174.3982 36477.6483  80.8%     -   85s
     0     0 36465.0773    0  519 20174.3982 36465.0773  80.7%     -   87s
     0     0 36450.0260    0  521 20174.3982 36450.0260  80.7%     -   87s
     0     0 36445.3680    0  528 20174.3982 36445.3680  80.7%     -   88s
     0     0 36444.9038    0  533 20174.3982 36444.9038  80.6%     -   88s
     0     0 36429.1960    0  564 20174.3982 36429.1960  80.6%     -   90s
H    0     0                    20389.116635 36429.0095  78.7%     -   90s
H    0     0                    20472.638646 36429.0095  77.9%     -   90s
H    0     0                    20478.655459 36429.0095  77.9%     -   90s
H    0     0                    20583.893074 36429.0095  77.0%     -   90s
     0     0 36417.7397    0  573 20583.8931 36417.7397  76.9%     -   91s
     0     0 36414.4127    0  574 20583.8931 36414.4127  76.9%     -   91s
     0     0 36413.1668    0  572 20583.8931 36413.1668  76.9%     -   91s
     0     0 36405.9297    0  576 20583.8931 36405.9297  76.9%     -   92s
     0     0 36404.3598    0  544 20583.8931 36404.3598  76.9%     -   92s
     0     0 36393.8777    0  545 20583.8931 36393.8777  76.8%     -   94s
     0     0 36385.6566    0  583 20583.8931 36385.6566  76.8%     -   95s
     0     0 36382.5707    0  542 20583.8931 36382.5707  76.8%     -   95s
     0     0 36381.0354    0  543 20583.8931 36381.0354  76.7%     -   95s
     0     0 36377.4762    0  546 20583.8931 36377.4762  76.7%     -   96s
     0     0 36376.7036    0  585 20583.8931 36376.7036  76.7%     -   97s
     0     0 36375.4072    0  587 20583.8931 36375.4072  76.7%     -   98s
     0     0 36375.2952    0  587 20583.8931 36375.2952  76.7%     -   98s
H    0     0                    20660.045414 36375.2911  76.1%     -  112s
H    0     0                    20861.485632 36375.2911  74.4%     -  112s
H    0     0                    20945.341967 36375.2911  73.7%     -  113s
H    0     0                    20952.090166 36375.2911  73.6%     -  113s
H    0     0                    20965.692436 36375.2911  73.5%     -  113s
H    0     0                    21090.257906 36375.2911  72.5%     -  113s
H    0     0                    21101.074959 36375.2911  72.4%     -  113s
H    0     2                    21138.525986 36375.2911  72.1%     -  115s
     0     2 36375.2911    0  587 21138.5260 36375.2911  72.1%     -  115s
     3     8 36260.1867    2  561 21138.5260 36296.7310  71.7%  1749  124s
     7    16 36046.6492    3  556 21138.5260 36259.5097  71.5%  4252  129s
    15    32 35517.4919    4  514 21138.5260 36046.3954  70.5%  4803  136s
    31    53 33140.3643    5  402 21138.5260 35517.4754  68.0%  8050  153s
H   52    85                    21152.128256 35517.4754  67.9%  7212  162s
    84   168 34356.0152    7  496 21152.1283 35517.4754  67.9%  5810  175s
   167   204 34255.3259    8  449 21152.1283 35517.4754  67.9%  3931  180s
H  171   204                    21516.745148 35517.4754  65.1%  3849  180s
   203   305 33054.2264    8  498 21516.7451 35517.4754  65.1%  3547  189s
   328   375 33854.3420   10  421 21516.7451 35517.4754  65.1%  2846  195s
H  337   375                    21672.638667 35517.4754  63.9%  2842  195s
   421   423 32152.7673    9  348 21672.6387 35420.6176  63.4%  2689  203s
   505   471 30336.2090   11  449 21672.6387 35420.6176  63.4%  2551  208s
   582   514 33208.3439   11  365 21672.6387 34713.5306  60.2%  2443  216s
   651   541 30682.1638   11  437 21672.6387 34712.4503  60.2%  2414  221s
   724   586 33224.5105   10  248 21672.6387 34712.4503  60.2%  2363  228s
   785   617 32470.0360   11  424 21672.6387 34712.4503  60.2%  2363  233s
H  787   617                    21793.818335 34712.4503  59.3%  2361  233s
H  792   617                    21855.425525 34712.4503  58.8%  2371  233s
   817   678 31897.3557   12  404 21855.4255 34712.4503  58.8%  2379  238s
   908   744 33229.0399   10  249 21855.4255 34712.4503  58.8%  2282  246s
  1002   795 30164.2047   11  333 21855.4255 34712.4503  58.8%  2210  253s
H 1008   795                    22616.198718 34712.4503  53.5%  2204  253s
H 1022   795                    23015.173833 34712.4503  50.8%  2191  253s
H 1056   795                    23134.450673 34712.4503  50.0%  2164  253s
  1081   831 31769.6465   13  345 23134.4507 34712.4503  50.0%  2147  259s
  1185   877 29588.1003   13  362 23134.4507 34712.4503  50.0%  2072  265s
  1284   947 31047.4024   14  314 23134.4507 34712.4503  50.0%  2045  272s
  1409   988 30129.9050   17  278 23134.4507 34518.7308  49.2%  1990  280s
  1514   999 30367.8263   16  222 23134.4507 34204.0708  47.8%  1960  287s
H 1532   999                    23187.427185 34204.0708  47.5%  1961  287s
H 1533   999                    23237.174667 34204.0708  47.2%  1961  287s
H 1550   999                    23437.164574 34204.0708  45.9%  1958  287s
  1561  1053 29410.6312   18  280 23437.1646 34204.0708  45.9%  1958  296s
  1679  1106 29218.3887   17  234 23437.1646 34204.0708  45.9%  1928  304s
  1790  1179 28474.5477   19  218 23437.1646 33892.9370  44.6%  1918  312s
  1917  1230     cutoff   19      23437.1646 33892.9370  44.6%  1894  318s
  2026  1253 26928.0619   22  261 23437.1646 33892.9370  44.6%  1891  325s
H 2028  1253                    23555.265136 33892.9370  43.9%  1890  325s
  2067  1302 26609.9787   23  326 23555.2651 33883.1684  43.8%  1897  334s
  2202  1363 24923.8626   25  169 23555.2651 33883.1684  43.8%  1875  343s
  2350  1422     cutoff   23      23555.2651 33786.5549  43.4%  1860  352s
  2493  1492 25666.5651   27  361 23555.2651 33786.5549  43.4%  1845  361s
  2644  1517     cutoff   33      23555.2651 33752.1883  43.3%  1833  370s
  2737  1568 24041.4631   35  271 23555.2651 33355.4155  41.6%  1828  381s
  2872  1617     cutoff    9      23555.2651 33214.5879  41.0%  1820  390s
  3025  1692 29126.1115   10  345 23555.2651 33166.5195  40.8%  1812  399s
  3214  1757 24033.2851   12  300 23555.2651 33166.5195  40.8%  1798  409s
  3421  1779     cutoff   13      23555.2651 33042.5640  40.3%  1777  421s
  3617  1800     cutoff   37      23555.2651 32932.0279  39.8%  1775  429s
  3843  1878 infeasible   18      23555.2651 32786.7419  39.2%  1762  439s
  4029  1930 infeasible   23      23555.2651 32685.6074  38.8%  1772  450s
  4255  1973     cutoff   11      23555.2651 32685.6074  38.8%  1771  460s
  4416  2014 25008.0927   12  349 23555.2651 32665.5533  38.7%  1767  470s
  4630  2065     cutoff   17      23555.2651 32665.5533  38.7%  1764  482s
  4831  2123 26678.1947   16  344 23555.2651 32438.2029  37.7%  1781  495s
  5078  2162 infeasible   18      23555.2651 32438.2029  37.7%  1783  508s
  5324  2231 28246.5440   12  370 23555.2651 32291.1129  37.1%  1789  521s
  5600  2264 26285.6683   16  187 23555.2651 31931.0166  35.6%  1790  535s
  5913  2302 28979.6805   12  364 23555.2651 31709.4833  34.6%  1779  547s
  6132  2402 infeasible   14      23555.2651 31654.6049  34.4%  1782  560s
  6448  2486 25508.6644   17  184 23555.2651 31532.0857  33.9%  1777  574s
  6796  2487 23839.3609   17  587 23555.2651 31507.1618  33.8%  1769  610s
  6798  2488 25173.2042   19  259 23555.2651 31507.1618  33.8%  1769  621s
  6799  2489 26289.9860   20  439 23555.2651 31507.1618  33.8%  1768  634s
  6800  2490 23647.1837   37  482 23555.2651 31507.1618  33.8%  1768  641s
  6801  2490 26908.9183   17  490 23555.2651 31507.1618  33.8%  1768  645s
  6803  2492 30284.8885   15  558 23555.2651 31507.1618  33.8%  1767  651s
  6805  2493 24188.7256   33  536 23555.2651 31507.1618  33.8%  1767  656s
  6808  2495 25493.5576   26  532 23555.2651 31507.1618  33.8%  1766  662s
  6811  2497 26892.4967   22  549 23555.2651 31507.1618  33.8%  1765  666s
  6812  2498 27992.7499   16  497 23555.2651 31507.1618  33.8%  1765  670s
  6814  2499 28785.2755   19  498 23555.2651 31507.1618  33.8%  1764  675s
  6817  2501 24594.7936   33  557 23555.2651 31507.1618  33.8%  1764  681s
  6819  2502 28357.2284   16  515 23555.2651 31507.1618  33.8%  1763  686s
  6821  2504 28609.5148   15  550 23555.2651 31507.1618  33.8%  1763  699s
  6822  2504 25019.1634   20  550 23555.2651 31507.1618  33.8%  1762  709s
  6823  2508 31507.1618   14  477 23555.2651 31507.1618  33.8%  1778  721s
  6825  2511 31507.1618   15  516 23555.2651 31507.1618  33.8%  1778  734s
  6829  2518 31507.1618   16  517 23555.2651 31507.1618  33.8%  1780  744s
  6837  2531 31507.1618   17  528 23555.2651 31507.1618  33.8%  1786  757s
  6853  2542 31507.1618   18  506 23555.2651 31507.1618  33.8%  1800  778s
  6869  2569 31404.4020   19  521 23555.2651 31507.1618  33.8%  1817  787s
  6901  2660 31015.3293   20  456 23555.2651 31507.1618  33.8%  1834  799s
  7020  2645 30189.7261   23  310 23555.2651 31507.1618  33.8%  1863  811s
  7057  2662 30307.9745   23  488 23555.2651 31507.1618  33.8%  1870  817s
  7097  2689 30270.2836   22  414 23555.2651 31507.1618  33.8%  1877  825s
  7139  2713 29315.9555   24  310 23555.2651 31507.1618  33.8%  1885  833s
  7194  2735 29722.0279   24  438 23555.2651 31507.1618  33.8%  1897  839s
  7261  2736 26389.4034   24  302 23555.2651 31507.1618  33.8%  1900  848s
  7355  2728 26768.4867   24  452 23555.2651 31507.1618  33.8%  1897  858s
  7445  2707 27918.1623   25  259 23555.2651 31507.1618  33.8%  1894  866s
  7529  2708 27502.3769   26  255 23555.2651 31507.1618  33.8%  1899  872s
  7590  2714 27349.3384   27  234 23555.2651 31507.1618  33.8%  1905  881s
  7645  2708 25710.0301   27  207 23555.2651 31507.1618  33.8%  1912  888s
  7698  2718 26161.1979   28  133 23555.2651 31507.1618  33.8%  1916  897s
  7752  2725 23970.7946   28  108 23555.2651 31507.1618  33.8%  1922  905s
  7806  2744 24540.3038   29  101 23555.2651 31507.1618  33.8%  1924  917s
  7882  2750     cutoff   28      23555.2651 31507.1618  33.8%  1926  926s
  7942  2769     cutoff   29      23555.2651 31507.1618  33.8%  1933  934s
  8013  2767     cutoff   30      23555.2651 31507.1618  33.8%  1940  941s
  8050  2769 25628.1620   23  507 23555.2651 31507.1618  33.8%  1944  950s
  8100  2780 25466.3089   24  458 23555.2651 31507.1618  33.8%  1947  957s
  8153  2787 24480.0305   25  463 23555.2651 31507.1618  33.8%  1950  965s
  8224  2783 24015.9701   26  436 23555.2651 31507.1618  33.8%  1949  974s
  8306  2784     cutoff   27      23555.2651 31507.1618  33.8%  1953  984s
  8412  2795     cutoff   27      23555.2651 31507.1618  33.8%  1950  995s
  8512  2804     cutoff   26      23555.2651 31507.1618  33.8%  1955 1003s
  8633  2798 24653.4149   22  394 23555.2651 31507.1618  33.8%  1958 1013s
  8767  2767     cutoff   24      23555.2651 31507.1618  33.8%  1962 1021s
  8824  2788 24485.1948   23  435 23555.2651 31507.1618  33.8%  1966 1031s
  8917  2807 23706.4340   24  419 23555.2651 31507.1618  33.8%  1972 1041s
  9036  2823 25041.3903   30  461 23555.2651 31507.1618  33.8%  1980 1052s
  9175  2821     cutoff   31      23555.2651 31507.1618  33.8%  1985 1064s
  9337  2814     cutoff   33      23555.2651 30958.9676  31.4%  1985 1076s
  9485  2825 25867.7975   20  447 23555.2651 30925.5196  31.3%  1992 1086s
  9647  2799 25176.2820   25  194 23555.2651 30925.5196  31.3%  1994 1099s
  9781  2799 26669.8061   22  408 23555.2651 30749.3146  30.5%  1995 1111s
  9985  2771 24229.2259   26  301 23555.2651 30465.6180  29.3%  1991 1123s
 10180  2765 27899.7665   22  262 23555.2651 30454.1330  29.3%  1992 1136s
 10398  2695     cutoff   27      23555.2651 30362.2436  28.9%  1993 1151s
 10619  2656     cutoff   32      23555.2651 30269.8437  28.5%  1994 1165s
 10835  2639     cutoff   25      23555.2651 29904.3178  27.0%  1995 1180s
 11083  2586 23806.2890   27  304 23555.2651 29904.3178  27.0%  1996 1195s
 11327  2566 26565.1935   24  405 23555.2651 29731.4153  26.2%  1999 1209s
 11558  2528     cutoff   28      23555.2651 29634.4956  25.8%  2003 1224s
 11814  2518     cutoff   32      23555.2651 29617.8754  25.7%  2004 1242s
 12089  2502 25566.5698   29  327 23555.2651 29352.9461  24.6%  2006 1260s
 12376  2469 25375.0807   28  276 23555.2651 29158.6681  23.8%  2009 1278s
 12661  2442 25080.5865   30  170 23555.2651 29002.5539  23.1%  2009 1297s
 13003  2384 26474.6987   27  392 23555.2651 28856.6743  22.5%  2010 1316s
 13387  2314     cutoff   34      23555.2651 28833.2739  22.4%  2006 1332s
 13732  2262 25650.8315   29  225 23555.2651 28602.3307  21.4%  2009 1351s
 14147  2186 24705.5653   27  263 23555.2651 28414.3476  20.6%  2005 1370s
 14446  2185 25076.4982   30  264 23555.2651 28253.6858  19.9%  2009 1388s
 14909  2215 23798.8654   31  310 23555.2651 28253.4305  19.9%  2001 1409s
H15093  2215                    23571.906795 28253.4305  19.9%  1999 1409s
H15295  2211                    23914.058400 27964.6816  16.9%  1997 1428s
H15299  2205                    23946.625763 27964.6816  16.8%  1997 1428s
H15324  2204                    23955.482805 27902.5871  16.5%  1997 1428s
 15380  2150     cutoff   28      23955.4828 27827.9436  16.2%  1998 1450s
 15874  2148 26723.8271   29  259 23955.4828 27782.7463  16.0%  1997 1472s
 16433  2139 25771.0829   32  185 23955.4828 27494.0586  14.8%  1991 1496s
H16579  2123                    24046.236694 27481.9729  14.3%  1991 1496s
 16845  2041 25569.8721   29  202 24046.2367 27332.9061  13.7%  1990 1521s
 17467  2050     cutoff   28      24046.2367 27130.9916  12.8%  1980 1541s
H17471  2047                    24065.067503 27130.9916  12.7%  1980 1541s
H17490  2047                    24071.158063 27130.9916  12.7%  1980 1541s
 17529  1920 24404.8002   26  368 24071.1581 27099.0069  12.6%  1981 1568s
 18155  1834     cutoff   25      24071.1581 26965.7911  12.0%  1977 1594s
 18853  1651     cutoff   30      24071.1581 26789.8521  11.3%  1966 1623s
 19454  1335     cutoff   31      24071.1581 26543.8323  10.3%  1959 1652s
 20278  1046 24240.5461   29  297 24071.1581 26153.4300  8.65%  1941 1679s
 20879   290     cutoff   34      24071.1581 26003.6453  8.03%  1921 1710s
 22309     0 24832.9051   27  207 24071.1581 25526.6717  6.05%  1844 1725s

Cutting planes:
  MIR: 607
  Mixing: 1
  Flow cover: 1438
  RLT: 28
  Relax-and-lift: 118

Explored 23017 nodes (41529927 simplex iterations) in 1725.08 seconds (5315.94 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 24071.2 24065.1 24046.2 ... 23237.2

Optimal solution found (tolerance 1.00e-04)
Best objective 2.407115806292e+04, best bound 2.407115806292e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 1725.12s
  Master Objective (UB) = 24071.16, θ = 167240.39
  Upper Bound (UB) = 24071.16

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 167240.39
  [DEBUG]   ✓ Scenario 0: θ = 167240.39 ≤ Q = 167240.39 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 167240.39 ≤ Q = 167240.39 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 167240.39 ≤ Q = 167240.39 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 167240.39 ≤ Q = 167240.39 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 167240.39 ≤ Q = 167240.39 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x2cb5dee8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xd34a2118
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [2e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.330940e+13
Presolve removed 2581 rows and 1872 columns
Presolve time: 0.01s
Presolved: 512 rows, 517 columns, 1445 nonzeros
Found heuristic solution: objective 6739230.3081
Variable types: 350 continuous, 167 integer (167 binary)

Root relaxation: objective -1.474953e+05, 253 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -147495.34    0  124 6739230.31 -147495.34   102%     -    0s
H    0     0                    -104237.7387 -147495.34  41.5%     -    0s
H    0     0                    -113475.8139 -147495.34  30.0%     -    0s
H    0     0                    -120135.5714 -147495.34  22.8%     -    0s
H    0     0                    -121228.0422 -129637.88  6.94%     -    0s
     0     0 -129637.88    0   89 -121228.04 -129637.88  6.94%     -    0s
H    0     0                    -126035.9653 -129637.01  2.86%     -    0s
H    0     0                    -127049.8531 -129637.01  2.04%     -    0s
     0     0 -129531.26    0   93 -127049.85 -129531.26  1.95%     -    0s
     0     0 -128701.81    0   80 -127049.85 -128701.81  1.30%     -    0s
H    0     0                    -127363.6034 -128697.31  1.05%     -    0s
     0     0 -128697.31    0   80 -127363.60 -128697.31  1.05%     -    0s
     0     0 -128584.36    0   75 -127363.60 -128584.36  0.96%     -    0s
     0     0 -128583.56    0   75 -127363.60 -128583.56  0.96%     -    0s
H    0     0                    -127369.0408 -128583.56  0.95%     -    0s
     0     2 -128583.56    0   75 -127369.04 -128583.56  0.95%     -    0s
H 1119   444                    -127396.5678 -127934.04  0.42%   5.9    0s
H 1168   444                    -127396.9827 -127934.04  0.42%   5.9    0s
H 2315   777                    -127407.1688 -127732.87  0.26%   5.6    0s
H 2331   777                    -127413.0248 -127732.87  0.25%   5.6    0s
H 3573  1084                    -127414.8555 -127644.24  0.18%   5.0    0s
H 3574  1084                    -127430.9693 -127644.24  0.17%   5.0    0s
H 3606  1084                    -127434.3698 -127644.24  0.16%   5.0    0s

Cutting planes:
  Gomory: 52
  Implied bound: 6
  MIR: 142
  Flow cover: 4
  RLT: 52
  Relax-and-lift: 3
  BQP: 1

Explored 9767 nodes (39169 simplex iterations) in 0.36 seconds (0.36 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -127434 -127431 -127415 ... -127050
No other solutions better than -127434

Optimal solution found (tolerance 1.00e-04)
Best objective -1.274343698121e+05, best bound -1.274343698121e+05, gap 0.0000%
  Subproblem solved in 0.37s
  Worst-case operational profit (Z_SP) = 150953.86
  Scenario: 30 demand increases, 30 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -127434.37
  [DEBUG]   S×d_nominal = 278388.23
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 278388.23 + -127434.37 = 150953.86
  [DEBUG]   Current θ from Master = 167240.39
  [DEBUG]   ⚠️  Z_SP ≤ θ by 16286.53 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 7784.63
  Lower Bound (LB) = 19044.82
  Gap (UB-LB) = 5026.3393, Absolute Gap = 5026.3393, Relative Gap = 0.208812
  Not converged yet (gap = 5026.34 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 30 increases, 30 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 264977 nonzeros
Model fingerprint: 0xff2746e4
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 40036 rows and 16256 columns
Presolve time: 0.83s
Presolved: 53087 rows, 23444 columns, 329699 nonzeros
Variable types: 21185 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -326728.6770
Found heuristic solution: objective -184683.4741

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 53087 rows, 23444 columns, 329699 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   37059    1.6922164e+04   0.000000e+00   9.929693e+06      5s
   50962    3.3403841e+04   0.000000e+00   1.155283e+07     10s
   62489    4.1610514e+04   0.000000e+00   1.579849e+07     15s
   71444    4.5780945e+04   0.000000e+00   3.375566e+06     20s
Concurrent spin time: 0.86s

Solved with dual simplex

Root relaxation: objective 4.921863e+04, 60281 iterations, 18.92 seconds (35.45 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 49218.6287    0  263 -184683.47 49218.6287   127%     -   20s
H    0     0                    -170318.0935 49218.6287   129%     -   20s
H    0     0                    -166395.8455 49218.6287   130%     -   20s
H    0     0                    -154963.2466 49218.6287   132%     -   20s
H    0     0                    -147492.0310 49218.6287   133%     -   20s
H    0     0                    -82683.96996 49218.6287   160%     -   20s
H    0     0                    -82459.06607 49218.6287   160%     -   20s
H    0     0                    -3492.569385 49218.6287  1509%     -   20s
H    0     0                    -3195.326074 49218.6287  1640%     -   20s
H    0     0                    -466.6134022 49218.6287      -     -   20s
H    0     0                    5853.2712882 49218.6287   741%     -   21s
H    0     0                    5854.6845098 49218.6287   741%     -   21s
H    0     0                    6009.4239850 49218.6287   719%     -   21s
H    0     0                    6024.0057167 49218.6287   717%     -   21s
H    0     0                    6037.7245379 49218.6287   715%     -   21s
     0     0 44106.1521    0  228 6037.72454 44106.1521   631%     -   32s
H    0     0                    6113.6301590 44106.1521   621%     -   32s
     0     0 42149.7017    0  308 6113.63016 42149.7017   589%     -   36s
     0     0 42129.0291    0  324 6113.63016 42129.0291   589%     -   38s
     0     0 42129.0291    0  324 6113.63016 42129.0291   589%     -   39s
     0     0 42129.0291    0  325 6113.63016 42129.0291   589%     -   39s
     0     0 42129.0291    0  326 6113.63016 42129.0291   589%     -   40s
     0     0 42129.0291    0  323 6113.63016 42129.0291   589%     -   40s
     0     0 42129.0291    0  325 6113.63016 42129.0291   589%     -   41s
     0     0 42129.0291    0  330 6113.63016 42129.0291   589%     -   41s
     0     0 39744.9180    0  406 6113.63016 39744.9180   550%     -   50s
     0     0 39483.0158    0  381 6113.63016 39483.0158   546%     -   54s
     0     0 39391.1161    0  380 6113.63016 39391.1161   544%     -   56s
     0     0 39357.9993    0  386 6113.63016 39357.9993   544%     -   57s
     0     0 39200.4745    0  377 6113.63016 39200.4745   541%     -   60s
     0     0 39126.1453    0  381 6113.63016 39126.1453   540%     -   62s
     0     0 39112.9220    0  385 6113.63016 39112.9220   540%     -   62s
     0     0 39108.6980    0  383 6113.63016 39108.6980   540%     -   63s
     0     0 39104.7155    0  381 6113.63016 39104.7155   540%     -   64s
     0     0 39103.1406    0  387 6113.63016 39103.1406   540%     -   64s
     0     0 39102.8803    0  389 6113.63016 39102.8803   540%     -   64s
H    0     0                    10111.770027 39102.8803   287%     -   69s
H    0     0                    10463.707734 39102.8803   274%     -   69s
H    0     0                    15554.819491 39102.8803   151%     -   69s
H    0     0                    16298.016357 39102.8803   140%     -   69s
     0     0 38165.5120    0  450 16298.0164 38165.5120   134%     -   76s
H    0     0                    16719.928043 38165.4778   128%     -   76s
     0     0 37951.9835    0  450 16719.9280 37951.9835   127%     -   80s
     0     0 37847.5823    0  460 16719.9280 37847.5823   126%     -   82s
     0     0 37818.5467    0  464 16719.9280 37818.5467   126%     -   83s
     0     0 37800.4688    0  467 16719.9280 37800.4688   126%     -   84s
     0     0 37761.9859    0  471 16719.9280 37761.9859   126%     -   85s
     0     0 37730.1569    0  471 16719.9280 37730.1569   126%     -   87s
     0     0 37689.5628    0  463 16719.9280 37689.5628   125%     -   88s
     0     0 37673.6386    0  468 16719.9280 37673.6386   125%     -   89s
     0     0 37651.8188    0  469 16719.9280 37651.8188   125%     -   91s
H    0     0                    19453.468154 37639.5341  93.5%     -   93s
     0     0 37639.5341    0  463 19453.4682 37639.5341  93.5%     -   93s
     0     0 37560.7659    0  467 19453.4682 37560.7659  93.1%     -   94s
H    0     0                    21312.499636 37526.2873  76.1%     -   95s
H    0     0                    21462.918795 37526.2873  74.8%     -   95s
     0     0 37526.2873    0  473 21462.9188 37526.2873  74.8%     -   95s
     0     0 37520.5389    0  475 21462.9188 37520.5389  74.8%     -   96s
     0     0 37518.3535    0  475 21462.9188 37518.3535  74.8%     -   96s
     0     0 37515.3048    0  480 21462.9188 37515.3048  74.8%     -   97s
     0     0 37514.4981    0  475 21462.9188 37514.4981  74.8%     -   97s
     0     0 37056.1518    0  465 21462.9188 37056.1518  72.7%     -  106s
H    0     0                    21470.441632 37055.1373  72.6%     -  106s
     0     0 36924.0448    0  466 21470.4416 36924.0448  72.0%     -  109s
     0     0 36874.4254    0  523 21470.4416 36874.4254  71.7%     -  112s
     0     0 36845.2372    0  473 21470.4416 36845.2372  71.6%     -  113s
     0     0 36827.4232    0  496 21470.4416 36827.4232  71.5%     -  115s
     0     0 36817.0335    0  471 21470.4416 36817.0335  71.5%     -  116s
     0     0 36814.1750    0  480 21470.4416 36814.1750  71.5%     -  116s
     0     0 36812.7224    0  476 21470.4416 36812.7224  71.5%     -  116s
     0     0 36719.4400    0  473 21470.4416 36719.4400  71.0%     -  120s
     0     0 36671.6163    0  483 21470.4416 36671.6163  70.8%     -  122s
     0     0 36650.5687    0  482 21470.4416 36650.5687  70.7%     -  123s
     0     0 36645.4425    0  491 21470.4416 36645.4425  70.7%     -  124s
     0     0 36641.7769    0  496 21470.4416 36641.7769  70.7%     -  124s
     0     0 36640.1581    0  497 21470.4416 36640.1581  70.7%     -  125s
     0     0 36638.0571    0  493 21470.4416 36638.0571  70.6%     -  125s
     0     0 36636.9117    0  495 21470.4416 36636.9117  70.6%     -  125s
     0     0 36586.3446    0  493 21470.4416 36586.3446  70.4%     -  127s
     0     0 36562.1199    0  489 21470.4416 36562.1199  70.3%     -  129s
     0     0 36560.0106    0  492 21470.4416 36560.0106  70.3%     -  130s
     0     0 36555.2193    0  491 21470.4416 36555.2193  70.3%     -  130s
     0     0 36548.1527    0  488 21470.4416 36548.1527  70.2%     -  131s
     0     0 36545.9499    0  498 21470.4416 36545.9499  70.2%     -  131s
     0     0 36543.4907    0  504 21470.4416 36543.4907  70.2%     -  132s
     0     0 36542.2656    0  498 21470.4416 36542.2656  70.2%     -  132s
     0     0 36510.1652    0  492 21470.4416 36510.1652  70.0%     -  134s
     0     0 36491.3360    0  497 21470.4416 36491.3360  70.0%     -  136s
     0     0 36487.4221    0  504 21470.4416 36487.4221  69.9%     -  136s
     0     0 36483.9777    0  496 21470.4416 36483.9777  69.9%     -  137s
     0     0 36481.4001    0  507 21470.4416 36481.4001  69.9%     -  137s
     0     0 36480.7221    0  505 21470.4416 36480.7221  69.9%     -  137s
     0     0 36472.4782    0  508 21470.4416 36472.4782  69.9%     -  138s
     0     0 36468.2313    0  504 21470.4416 36468.2313  69.9%     -  140s
     0     0 36466.2716    0  508 21470.4416 36466.2716  69.8%     -  140s
     0     0 36465.5412    0  509 21470.4416 36465.5412  69.8%     -  140s
     0     0 36456.7574    0  498 21470.4416 36456.7574  69.8%     -  141s
     0     0 36446.3847    0  503 21470.4416 36446.3847  69.8%     -  143s
     0     0 36444.0849    0  508 21470.4416 36444.0849  69.7%     -  143s
     0     0 36443.4332    0  511 21470.4416 36443.4332  69.7%     -  144s
     0     0 36437.6658    0  503 21470.4416 36437.6658  69.7%     -  145s
H    0     0                    21471.881337 36436.5830  69.7%     -  145s
     0     0 36435.9782    0  509 21471.8813 36435.9782  69.7%     -  146s
     0     0 36434.3833    0  512 21471.8813 36434.3833  69.7%     -  146s
     0     0 36429.2823    0  519 21471.8813 36429.2823  69.7%     -  147s
     0     0 36428.6346    0  514 21471.8813 36428.6346  69.7%     -  148s
     0     0 36425.2184    0  511 21471.8813 36425.2184  69.6%     -  149s
H    0     0                    22183.021438 36424.6527  64.2%     -  150s
     0     0 36423.6270    0  510 22183.0214 36423.6270  64.2%     -  151s
     0     0 36418.7653    0  504 22183.0214 36418.7653  64.2%     -  152s
     0     0 36418.6716    0  504 22183.0214 36418.6716  64.2%     -  153s
     0     2 36418.4933    0  504 22183.0214 36418.4933  64.2%     -  179s
     1     4 36106.3927    1  461 22183.0214 36418.4933  64.2%  4644  184s
     3     8 35810.6610    2  468 22183.0214 36105.9474  62.8%  5602  191s
     7    16 35295.2327    3  510 22183.0214 35808.6473  61.4%  6594  198s
    15    31 34834.1200    4  516 22183.0214 35295.1259  59.1%  6788  209s
    30    52 33764.1123    5  451 22183.0214 34834.0862  57.0% 11419  230s
    51    84 33555.8496    6  487 22183.0214 34834.0862  57.0% 11024  238s
    83   177 33433.8022    7  449 22183.0214 34834.0862  57.0%  8625  248s
   176   252 33227.5407   12  275 22183.0214 34834.0862  57.0%  4885  258s
   257   310 26747.9294   14  190 22183.0214 34834.0862  57.0%  4120  266s
   325   358 26490.2459   16  188 22183.0214 34834.0862  57.0%  3759  274s
   403   377 24965.7692   17  237 22183.0214 34834.0862  57.0%  3513  282s
   460   419 23563.9509   18  220 22183.0214 34833.1993  57.0%  3396  290s
   530   464 23301.9546   21  221 22183.0214 34721.4909  56.5%  3299  298s
   594   503     cutoff   24      22183.0214 34721.4909  56.5%  3203  306s
   661   534 28086.5621   16  377 22183.0214 34721.4909  56.5%  3097  313s
   705   588 27898.9144   17  342 22183.0214 34721.4909  56.5%  3054  320s
   781   630 27756.9464   18  290 22183.0214 34721.4909  56.5%  2971  327s
   855   682 27569.5343   19  235 22183.0214 34721.4909  56.5%  2865  335s
   941   712 27170.0706   21  185 22183.0214 34585.5369  55.9%  2759  343s
   985   787 27032.3498   22  177 22183.0214 34585.5369  55.9%  2769  350s
  1100   875 26183.1369   27  149 22183.0214 34585.5369  55.9%  2672  361s
H 1116   875                    22326.892261 34585.5369  54.9%  2668  361s
  1168   945 26000.8816   28  158 22326.8923 34585.5369  54.9%  2600  370s
  1292  1042 25616.0959   36  102 22326.8923 34585.5369  54.9%  2490  378s
  1429  1148 24849.8217   45   88 22326.8923 34585.5369  54.9%  2388  388s
H 1447  1148                    22851.962454 34585.5369  51.3%  2364  388s
H 1546  1148                    22909.105485 34585.5369  51.0%  2290  388s
  1573  1264     cutoff   51      22909.1055 34585.5369  51.0%  2278  397s
  1754  1361     cutoff   59      22909.1055 34585.5369  51.0%  2146  406s
H 1758  1361                    22909.633881 34585.5369  51.0%  2142  406s
H 1765  1361                    23129.905610 34585.5369  49.5%  2139  406s
H 1784  1361                    23133.827303 34585.5369  49.5%  2131  406s
  1899  1462 28744.2491   10  436 23133.8273 34585.5369  49.5%  2088  415s
  2050  1529 26130.4040   11  390 23133.8273 34585.5369  49.5%  2028  423s
  2195  1619 25098.0150   13  344 23133.8273 34585.5369  49.5%  1989  432s
H 2216  1619                    23134.411867 34585.5369  49.5%  1992  432s
H 2249  1619                    23335.866181 34585.5369  48.2%  1984  432s
  2311  1694 25051.9958   14  340 23335.8662 34585.5369  48.2%  1951  442s
  2480  1768     cutoff   20      23335.8662 34585.5369  48.2%  1911  451s
  2621  1812 31334.9610   14  279 23335.8662 34103.2376  46.1%  1909  461s
  2766  1854 24704.0701   16  174 23335.8662 34102.7804  46.1%  1900  472s
H 2769  1851                    23376.823156 34102.7804  45.9%  1900  472s
  2977  1907 29447.0569   17  267 23376.8232 34102.7804  45.9%  1854  484s
  3148  1923     cutoff   15      23376.8232 33585.5952  43.7%  1852  492s
  3194  1945 27818.6535   18  297 23376.8232 33585.5952  43.7%  1870  504s
  3248  1973 28850.4402   18  241 23376.8232 33585.5952  43.7%  1886  516s
  3302  2004 25512.7826   20  121 23376.8232 33585.5952  43.7%  1897  525s
  3355  2045     cutoff   20      23376.8232 32616.9742  39.5%  1911  537s
  3420  2055     cutoff   14      23376.8232 32534.7459  39.2%  1915  548s
  3522  2103 29536.8817   11  388 23376.8232 32534.7459  39.2%  1911  559s
  3612  2142 28356.8433   13  273 23376.8232 32534.7459  39.2%  1928  572s
  3766  2169 26287.6663   16  316 23376.8232 32534.7459  39.2%  1928  586s
  3918  2191 25417.3289   19  222 23376.8232 32353.9873  38.4%  1945  600s
  4088  2215 infeasible   42      23376.8232 32269.3947  38.0%  1957  613s
  4172  2251 25591.4953   10  361 23376.8232 32269.3947  38.0%  1958  628s
  4315  2306 23508.5196   14  244 23376.8232 32043.2347  37.1%  1985  644s
  4505  2343 30552.9854   10  364 23376.8232 31928.6856  36.6%  1995  660s
  4640  2411 23857.9850   11  289 23376.8232 31837.9175  36.2%  2004  676s
  4842  2496     cutoff   12      23376.8232 31765.0408  35.9%  2013  694s
  5058  2546     cutoff   12      23376.8232 31489.0438  34.7%  2028  710s
  5266  2625 27299.9825   14  328 23376.8232 31414.6209  34.4%  2048  727s
  5532  2665 infeasible   15      23376.8232 31311.1825  33.9%  2047  745s
  5850  2674 24019.8549   17  230 23376.8232 31311.1825  33.9%  2037  763s
  6047  2754 25985.4231   17  170 23376.8232 31171.9998  33.3%  2032  781s
  6269  2829 24328.7578   19  213 23376.8232 31106.3582  33.1%  2057  802s
  6566  2830 24079.8052   28  504 23376.8232 31062.2312  32.9%  2065  849s
  6568  2831 26699.3575   23  263 23376.8232 31062.2312  32.9%  2064  874s
  6569  2832 23793.0443   40  394 23376.8232 31062.2312  32.9%  2064  889s
  6570  2833 28167.7306   11  485 23376.8232 31062.2312  32.9%  2063  900s
  6571  2833 24710.0179   22  457 23376.8232 31062.2312  32.9%  2063  906s
  6572  2834 30480.9099   14  466 23376.8232 31062.2312  32.9%  2063  911s
  6574  2835 29303.4011   13  504 23376.8232 31062.2312  32.9%  2062  919s
  6575  2836 30821.8205   12  496 23376.8232 31062.2312  32.9%  2062  922s
  6576  2837 24853.7117   33  496 23376.8232 31062.2312  32.9%  2061  925s
  6577  2837 29784.9405   13  486 23376.8232 31062.2312  32.9%  2061  931s
  6579  2839 24445.9456   25  502 23376.8232 31062.2312  32.9%  2061  935s
  6581  2840 25835.1377   21  501 23376.8232 31062.2312  32.9%  2060  943s
  6582  2841 24482.6296   36  527 23376.8232 31062.2312  32.9%  2060  946s
  6584  2842 27163.2321   26  533 23376.8232 31062.2312  32.9%  2059  952s
  6585  2843 27216.8082   10  569 23376.8232 31062.2312  32.9%  2059  955s
  6587  2844 23799.3779   26  546 23376.8232 31062.2312  32.9%  2058  961s
  6588  2845 25426.1979   17  575 23376.8232 31062.2312  32.9%  2058  966s
  6590  2846 29911.2248   14  541 23376.8232 31062.2312  32.9%  2057  971s
  6591  2847 23496.2937   40  541 23376.8232 31062.2312  32.9%  2057  992s
  6592  2847 29638.0695   15  541 23376.8232 31062.2312  32.9%  2056 1006s
  6593  2851 31062.2312   14  521 23376.8232 31062.2312  32.9%  2080 1024s
  6595  2854 31062.2312   15  510 23376.8232 31062.2312  32.9%  2080 1037s
  6599  2861 31062.2312   16  513 23376.8232 31062.2312  32.9%  2082 1066s
  6607  2874 31062.2312   17  508 23376.8232 31062.2312  32.9%  2088 1084s
  6623  2885 31062.2312   18  504 23376.8232 31062.2312  32.9%  2117 1115s
  6639  2912 30686.1791   19  484 23376.8232 31062.2312  32.9%  2143 1134s
  6671  2998 29330.6036   20  446 23376.8232 31062.2312  32.9%  2160 1150s
  6775  2993 28648.3526   23  338 23376.8232 31062.2312  32.9%  2202 1160s
  6808  3008 27018.3195   23  435 23376.8232 31062.2312  32.9%  2209 1168s
  6842  3020 28153.7182   22  335 23376.8232 31062.2312  32.9%  2222 1180s
  6878  3021 28908.9047   21  459 23376.8232 31062.2312  32.9%  2242 1191s
  6920  3022 27301.8439   24  358 23376.8232 31062.2312  32.9%  2261 1203s
  6958  3030 26887.1301   24  365 23376.8232 31062.2312  32.9%  2284 1216s
  6995  3040 26733.2602   24  355 23376.8232 31062.2312  32.9%  2304 1226s
  7034  3045 26939.5534   23  358 23376.8232 31062.2312  32.9%  2325 1238s
  7095  3031 26303.3516   23  345 23376.8232 31062.2312  32.9%  2347 1249s
  7142  3019 26573.0135   24  330 23376.8232 31062.2312  32.9%  2361 1263s
  7202  3014 25249.9308   26  226 23376.8232 31062.2312  32.9%  2375 1274s
  7245  3006 24764.6441   27  355 23376.8232 31062.2312  32.9%  2399 1284s
  7299  2996     cutoff   28      23376.8232 31062.2312  32.9%  2414 1295s
  7355  3007     cutoff   27      23376.8232 31062.2312  32.9%  2427 1308s
  7415  3009 30587.9862   23  378 23376.8232 31062.2312  32.9%  2444 1323s
  7482  3021 30010.5595   25  384 23376.8232 31062.2312  32.9%  2469 1334s
  7551  3025 28417.6789   27  369 23376.8232 31062.2312  32.9%  2495 1346s
  7628  3031 27090.1155   29  328 23376.8232 31062.2312  32.9%  2515 1357s
  7713  3041 25115.6342   31  264 23376.8232 31062.2312  32.9%  2549 1369s
  7810  3036 23925.0809   33  319 23376.8232 31062.2312  32.9%  2556 1383s
  7901  3040 25417.1087   23  412 23376.8232 31062.2312  32.9%  2575 1397s
  8021  3034 23867.9340   26  436 23376.8232 31062.2312  32.9%  2583 1410s
  8112  3025     cutoff   27      23376.8232 31062.2312  32.9%  2613 1423s
  8231  3045 23792.4910   26  366 23376.8232 31062.2312  32.9%  2639 1437s
  8349  3065 29259.7053   21  364 23376.8232 31062.2312  32.9%  2673 1453s
  8468  3075 28629.3345   23  360 23376.8232 31062.2312  32.9%  2696 1467s
  8608  3071 28479.8460   23  334 23376.8232 31062.2312  32.9%  2726 1485s
  8753  3057 27214.4415   26  347 23376.8232 31062.2312  32.9%  2758 1499s
  8901  3040 26402.8467   29  316 23376.8232 31062.2312  32.9%  2796 1515s
  9046  3032 24049.2076   33  210 23376.8232 31062.2312  32.9%  2827 1532s
  9203  3017     cutoff   37      23376.8232 31014.1490  32.7%  2851 1551s
  9375  2996 26816.5156   27  330 23376.8232 30821.6589  31.8%  2892 1569s
  9545  2981     cutoff   30      23376.8232 30821.6589  31.8%  2928 1587s
  9725  2985     cutoff   34      23376.8232 30354.8280  29.9%  2963 1604s
  9901  2992 27826.5936   21  336 23376.8232 30065.0455  28.6%  2993 1623s
 10097  2958 26847.5070   24  265 23376.8232 30065.0455  28.6%  3032 1642s
 10321  2924     cutoff   29      23376.8232 30065.0455  28.6%  3063 1661s
 10519  2910     cutoff   33      23376.8232 29916.3527  28.0%  3102 1682s
 10758  2874 26613.9002   26  363 23376.8232 29710.6776  27.1%  3138 1702s
 11035  2791 23877.3982   30  260 23376.8232 29710.6776  27.1%  3163 1722s
 11088  2774     cutoff   31      23376.8232 29654.3741  26.9%  3171 1744s
 11152  2744     cutoff   32      23376.8232 29654.3741  26.9%  3182 1765s
 11224  2735 24597.3021   24  316 23376.8232 29654.3741  26.9%  3189 1785s
 11316  2722 23435.2533   25  283 23376.8232 29523.9837  26.3%  3203 1807s
 11521  2716 26491.1754   24  390 23376.8232 29523.9837  26.3%  3218 1833s
 11795  2691 24209.6846   30  365 23376.8232 29327.4768  25.5%  3240 1859s
 12102  2626 27110.1989   24  421 23376.8232 29106.1697  24.5%  3273 1887s
 12430  2578     cutoff   28      23376.8232 29106.1697  24.5%  3311 1914s
 12727  2557 26573.1318   25  281 23376.8232 28791.8072  23.2%  3332 1940s
 13124  2463 24348.8553   33  260 23376.8232 28791.8072  23.2%  3358 1968s
 13526  2382 23571.6438   21  321 23376.8232 28382.6755  21.4%  3385 1996s
 13922  2280 23931.3281   35  211 23376.8232 28331.0323  21.2%  3417 2024s
 14357  2127     cutoff   22      23376.8232 28163.7181  20.5%  3452 2055s
 14789  2017     cutoff   33      23376.8232 27897.4803  19.3%  3485 2085s
 15290  1917 24903.8830   34  280 23376.8232 27709.2987  18.5%  3504 2116s
 15788  1928 23595.0950   26  185 23376.8232 27464.6870  17.5%  3529 2148s
 16452  1915     cutoff   34      23376.8232 27269.9413  16.7%  3526 2178s
 16546  1861     cutoff   34      23376.8232 27203.8998  16.4%  3534 2213s
 16959  1771 23573.9040   25  501 23376.8232 27153.0344  16.2%  3544 2248s
 17593  1677     cutoff   36      23376.8232 26840.7043  14.8%  3549 2285s
 18218  1538     cutoff   23      23376.8232 26618.1420  13.9%  3565 2323s
 18897  1334 23848.2399   33  300 23376.8232 26356.2355  12.7%  3576 2360s
 19673   973     cutoff   35      23376.8232 26155.8564  11.9%  3575 2400s
 20550   410     cutoff   31      23376.8232 25716.9981  10.0%  3561 2441s
 21749   707 23965.9942   24  415 23376.8232 25320.9315  8.32%  3476 2473s
*21826   707              64    23401.448719 25320.9315  8.20%  3465 2473s
H21829   707                    23404.691369 25320.9315  8.19%  3464 2473s
*21834   707              65    23408.040271 25320.9315  8.17%  3463 2473s
*22183   707              68    23408.703100 25222.0596  7.75%  3414 2473s
H22224   707                    23543.809212 25222.0596  7.13%  3408 2473s
 23959   123     cutoff   67      23543.8092 24891.4116  5.72%  3195 2476s
H23961   123                    23556.437778 24891.4116  5.67%  3195 2476s
H24155   123                    23569.048575 24891.4116  5.61%  3169 2476s
*24193   123              66    23573.982009 24891.4116  5.59%  3165 2476s
H24255   123                    23576.655472 24891.4116  5.58%  3157 2476s
H24676   123                    23610.943817 24751.9018  4.83%  3104 2476s
*24952   123              65    23611.739637 24505.4965  3.79%  3070 2476s
H25746     0                    23631.765126 23653.3062  0.09%  2977 2477s
H25748     0                    23632.634244 23651.5918  0.08%  2977 2477s

Cutting planes:
  Learned: 2
  MIR: 818
  Mixing: 3
  Flow cover: 2027
  RLT: 47
  Relax-and-lift: 196

Explored 25891 nodes (76841802 simplex iterations) in 2477.47 seconds (7961.99 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 23632.6 23631.8 23611.7 ... 23408.7

Optimal solution found (tolerance 1.00e-04)
Best objective 2.363263424424e+04, best bound 2.363263424424e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2477.50s
  Master Objective (UB) = 23632.63, θ = 165708.38
  Upper Bound (UB) = 23632.63

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 165708.38
  [DEBUG]   ✓ Scenario 0: θ = 165708.38 ≤ Q = 165708.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 165708.38 ≤ Q = 165708.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 165708.38 ≤ Q = 165708.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 165708.38 ≤ Q = 165708.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 165708.38 ≤ Q = 165708.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 165708.38 ≤ Q = 165708.38 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x5a16bf20
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x5a16bf20
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.323558e+13
Presolve removed 2581 rows and 1872 columns
Presolve time: 0.00s
Presolved: 512 rows, 517 columns, 1445 nonzeros
Found heuristic solution: objective 6660011.1389
Variable types: 350 continuous, 167 integer (167 binary)

Root relaxation: objective -1.498360e+05, 252 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -149835.97    0  125 6660011.14 -149835.97   102%     -    0s
H    0     0                    -107349.8277 -149835.97  39.6%     -    0s
H    0     0                    -114174.0986 -149835.97  31.2%     -    0s
H    0     0                    -121100.2389 -130541.29  7.80%     -    0s
H    0     0                    -123111.5286 -130541.29  6.03%     -    0s
     0     0 -130541.29    0   86 -123111.53 -130541.29  6.03%     -    0s
H    0     0                    -123736.6684 -130540.93  5.50%     -    0s
H    0     0                    -126752.5744 -130540.93  2.99%     -    0s
     0     0 -129454.26    0   84 -126752.57 -129454.26  2.13%     -    0s
     0     0 -129453.54    0   84 -126752.57 -129453.54  2.13%     -    0s
     0     0 -128342.16    0   73 -126752.57 -128342.16  1.25%     -    0s
H    0     0                    -126833.7228 -128333.96  1.18%     -    0s
H    0     0                    -126915.2044 -128333.96  1.12%     -    0s
     0     0 -128287.84    0   70 -126915.20 -128287.84  1.08%     -    0s
H    0     0                    -127184.0478 -128287.84  0.87%     -    0s
     0     0 -128233.72    0   68 -127184.05 -128233.72  0.83%     -    0s
     0     0 -128218.67    0   68 -127184.05 -128218.67  0.81%     -    0s
     0     2 -128218.57    0   68 -127184.05 -128218.57  0.81%     -    0s
H   37    22                    -127237.6687 -127977.91  0.58%  19.3    0s
H  628   324                    -127266.6216 -127640.99  0.29%   6.3    0s
* 3374   273              53    -127269.9286 -127351.13  0.06%   6.8    0s

Cutting planes:
  Gomory: 50
  Implied bound: 7
  MIR: 154
  Flow cover: 4
  RLT: 42
  BQP: 1

Explored 3879 nodes (27039 simplex iterations) in 0.20 seconds (0.23 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -127270 -127267 -127238 ... -121100
No other solutions better than -127270

Optimal solution found (tolerance 1.00e-04)
Best objective -1.272699285985e+05, best bound -1.272699285985e+05, gap 0.0000%
  Subproblem solved in 0.22s
  Worst-case operational profit (Z_SP) = 151948.09
  Scenario: 29 demand increases, 31 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -127269.93
  [DEBUG]   S×d_nominal = 279218.02
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 279218.02 + -127269.93 = 151948.09
  [DEBUG]   Current θ from Master = 165708.38
  [DEBUG]   ⚠️  Z_SP ≤ θ by 13760.28 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 9872.35
  Lower Bound (LB) = 19044.82
  Gap (UB-LB) = 4587.8154, Absolute Gap = 4587.8154, Relative Gap = 0.194131
  Not converged yet (gap = 4587.82 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 29 increases, 31 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308220 nonzeros
Model fingerprint: 0xe29c8cb8
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 46702 rows and 18962 columns
Presolve time: 0.98s
Presolved: 61711 rows, 26978 columns, 383749 nonzeros
Variable types: 24719 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -326728.6770
Found heuristic solution: objective -184683.4741

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 61711 rows, 26978 columns, 383749 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   29786   -4.7365199e+04   0.000000e+00   3.850466e+08      5s
   41787    3.3197178e+03   0.000000e+00   2.993351e+07     10s
   51913    2.0445887e+04   0.000000e+00   1.616364e+07     15s
   62371    2.4759044e+04   0.000000e+00   6.595604e+06     20s
   72382    2.8964219e+04   0.000000e+00   1.496855e+06     25s
Concurrent spin time: 6.29s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 4.921863e+04, 68349 iterations, 34.56 seconds (62.75 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 49218.6287    0  263 -184683.47 49218.6287   127%     -   36s
H    0     0                    -171344.1030 49218.6287   129%     -   36s
H    0     0                    -112225.0182 49218.6287   144%     -   36s
H    0     0                    -112211.6139 49218.6287   144%     -   36s
H    0     0                    -111961.2548 49218.6287   144%     -   36s
H    0     0                    -82683.96996 49218.6287   160%     -   36s
H    0     0                    -82459.06607 49218.6287   160%     -   36s
H    0     0                    -3492.569385 49218.6287  1509%     -   36s
H    0     0                    -3195.326074 49218.6287  1640%     -   36s
H    0     0                    -466.6134022 49218.6287      -     -   36s
H    0     0                    4401.4253868 49218.6287  1018%     -   37s
H    0     0                    5784.3979844 49218.6287   751%     -   37s
H    0     0                    6024.0057167 49218.6287   717%     -   37s
H    0     0                    6028.5698880 49218.6287   716%     -   37s
H    0     0                    6037.7245379 49218.6287   715%     -   37s
     0     0 44108.2237    0  296 6037.72454 44108.2237   631%     -   47s
H    0     0                    6077.5130413 44108.1400   626%     -   47s
H    0     0                    6078.2927802 44108.1400   626%     -   47s
H    0     0                    6104.4755090 44108.1400   623%     -   47s
H    0     0                    6109.3300288 44108.1400   622%     -   47s
H    0     0                    6113.6301590 44108.1400   621%     -   47s
     0     0 42481.9034    0  323 6113.63016 42481.9034   595%     -   54s
     0     0 42324.3957    0  327 6113.63016 42324.3957   592%     -   56s
     0     0 42286.7182    0  330 6113.63016 42286.7182   592%     -   58s
     0     0 42212.2032    0  330 6113.63016 42212.2032   590%     -   60s
     0     0 42134.0743    0  337 6113.63016 42134.0743   589%     -   62s
     0     0 42134.0743    0  331 6113.63016 42134.0743   589%     -   63s
     0     0 42134.0743    0  330 6113.63016 42134.0743   589%     -   63s
     0     0 42134.0743    0  330 6113.63016 42134.0743   589%     -   63s
     0     0 42134.0743    0  334 6113.63016 42134.0743   589%     -   64s
     0     0 42134.0743    0  337 6113.63016 42134.0743   589%     -   64s
     0     0 39915.4272    0  361 6113.63016 39915.4272   553%     -   76s
H    0     0                    6545.6513851 39915.2242   510%     -   76s
H    0     0                    6592.8355801 39915.2242   505%     -   76s
H    0     0                    6920.0361199 39915.2242   477%     -   76s
H    0     0                    7469.3185753 39915.2242   434%     -   76s
     0     0 39555.0065    0  352 7469.31858 39555.0065   430%     -   82s
     0     0 39420.7399    0  371 7469.31858 39420.7399   428%     -   86s
     0     0 39351.4116    0  377 7469.31858 39351.4116   427%     -   88s
H    0     0                    11182.508317 39313.5134   252%     -   92s
H    0     0                    16382.896787 39313.5134   140%     -   92s
     0     0 39313.5134    0  382 16382.8968 39313.5134   140%     -   92s
     0     0 39304.6241    0  388 16382.8968 39304.6241   140%     -   93s
     0     0 39303.9261    0  389 16382.8968 39303.9261   140%     -   93s
     0     0 38194.7342    0  443 16382.8968 38194.7342   133%     -  110s
     0     0 37918.2955    0  453 16382.8968 37918.2955   131%     -  116s
     0     0 37799.0297    0  466 16382.8968 37799.0297   131%     -  120s
     0     0 37764.8054    0  460 16382.8968 37764.8054   131%     -  122s
     0     0 37742.3987    0  453 16382.8968 37742.3987   130%     -  123s
     0     0 37688.1074    0  454 16382.8968 37688.1074   130%     -  125s
     0     0 37665.6969    0  462 16382.8968 37665.6969   130%     -  126s
     0     0 37635.3693    0  458 16382.8968 37635.3693   130%     -  128s
     0     0 37625.1966    0  459 16382.8968 37625.1966   130%     -  129s
     0     0 37621.7158    0  464 16382.8968 37621.7158   130%     -  129s
     0     0 37619.4693    0  460 16382.8968 37619.4693   130%     -  129s
     0     0 37618.1336    0  461 16382.8968 37618.1336   130%     -  130s
     0     0 37617.3470    0  461 16382.8968 37617.3470   130%     -  130s
H    0     0                    16386.818481 37140.6949   127%     -  140s
H    0     0                    17580.968949 37140.6949   111%     -  140s
H    0     0                    17619.083671 37140.6949   111%     -  140s
     0     0 37140.6949    0  460 17619.0837 37140.6949   111%     -  140s
H    0     0                    20435.586825 37140.1827  81.7%     -  140s
H    0     0                    20439.508518 37140.1827  81.7%     -  140s
     0     0 37027.1245    0  467 20439.5085 37027.1245  81.2%     -  144s
     0     0 36938.6970    0  466 20439.5085 36938.6970  80.7%     -  147s
     0     0 36889.2125    0  498 20439.5085 36889.2125  80.5%     -  150s
     0     0 36879.8410    0  465 20439.5085 36879.8410  80.4%     -  150s
     0     0 36871.4699    0  469 20439.5085 36871.4699  80.4%     -  151s
     0     0 36860.4440    0  469 20439.5085 36860.4440  80.3%     -  151s
     0     0 36844.7797    0  474 20439.5085 36844.7797  80.3%     -  152s
     0     0 36842.6155    0  466 20439.5085 36842.6155  80.3%     -  152s
     0     0 36841.2280    0  482 20439.5085 36841.2280  80.2%     -  153s
     0     0 36644.8139    0  478 20439.5085 36644.8139  79.3%     -  157s
     0     0 36598.8924    0  480 20439.5085 36598.8924  79.1%     -  160s
     0     0 36571.3665    0  483 20439.5085 36571.3665  78.9%     -  161s
     0     0 36563.8652    0  490 20439.5085 36563.8652  78.9%     -  162s
     0     0 36560.0676    0  497 20439.5085 36560.0676  78.9%     -  163s
     0     0 36558.3090    0  487 20439.5085 36558.3090  78.9%     -  163s
     0     0 36558.2418    0  493 20439.5085 36558.2418  78.9%     -  164s
     0     0 36514.2534    0  503 20439.5085 36514.2534  78.6%     -  166s
H    0     0                    20575.296111 36514.1247  77.5%     -  167s
     0     0 36506.7277    0  512 20575.2961 36506.7277  77.4%     -  169s
     0     0 36502.9420    0  511 20575.2961 36502.9420  77.4%     -  169s
     0     0 36500.7011    0  524 20575.2961 36500.7011  77.4%     -  170s
     0     0 36499.3987    0  517 20575.2961 36499.3987  77.4%     -  171s
     0     0 36462.7262    0  498 20575.2961 36462.7262  77.2%     -  173s
     0     0 36448.8073    0  502 20575.2961 36448.8073  77.1%     -  174s
     0     0 36441.4290    0  514 20575.2961 36441.4290  77.1%     -  175s
     0     0 36438.6063    0  514 20575.2961 36438.6063  77.1%     -  175s
     0     0 36437.2775    0  506 20575.2961 36437.2775  77.1%     -  176s
     0     0 36408.1227    0  545 20575.2961 36408.1227  77.0%     -  178s
H    0     0                    20579.217805 36407.7281  76.9%     -  179s
     0     0 36400.9859    0  561 20579.2178 36400.9859  76.9%     -  180s
     0     0 36399.6742    0  562 20579.2178 36399.6742  76.9%     -  180s
     0     0 36385.6613    0  533 20579.2178 36385.6613  76.8%     -  182s
     0     0 36380.2062    0  532 20579.2178 36380.2062  76.8%     -  182s
     0     0 36371.4077    0  540 20579.2178 36371.4077  76.7%     -  183s
     0     0 36368.2879    0  534 20579.2178 36368.2879  76.7%     -  184s
     0     0 36367.7298    0  534 20579.2178 36367.7298  76.7%     -  184s
     0     0 36364.0142    0  540 20579.2178 36364.0142  76.7%     -  185s
     0     0 36362.7254    0  539 20579.2178 36362.7254  76.7%     -  186s
     0     0 36361.8431    0  547 20579.2178 36361.8431  76.7%     -  187s
     0     0 36361.1525    0  552 20579.2178 36361.1525  76.7%     -  188s
     0     0 36358.9125    0  546 20579.2178 36358.9125  76.7%     -  189s
H    0     0                    20754.410608 36358.7523  75.2%     -  190s
     0     0 36357.3543    0  541 20754.4106 36357.3543  75.2%     -  191s
     0     0 36354.2640    0  551 20754.4106 36354.2640  75.2%     -  193s
     0     0 36354.1946    0  551 20754.4106 36354.1946  75.2%     -  194s
H    0     0                    20971.831496 36353.9886  73.3%     -  215s
H    0     0                    21064.878004 36353.9886  72.6%     -  215s
H    0     0                    21732.846317 36353.9886  67.3%     -  235s
     0     2 36353.9886    0  551 21732.8463 36353.9886  67.3%     -  236s
     1     4 36058.1415    1  498 21732.8463 36353.8905  67.3%  4095  248s
     3     8 35993.5937    2  517 21732.8463 36057.9498  65.9%  7344  257s
     7    16 35872.2125    3  509 21732.8463 35993.5323  65.6%  6317  263s
    15    31 35403.8653    4  588 21732.8463 35872.1168  65.1%  6199  278s
    30    46 33304.9863    5  486 21732.8463 35403.7068  62.9% 11263  304s
    45    77 32574.4878    5  506 21732.8463 35403.7068  62.9% 10536  320s
H   49    77                    21782.348733 35403.7068  62.5% 10191  320s
H   57    77                    21870.126952 35403.7068  61.9%  9882  320s
H   61    77                    21938.899783 35403.7068  61.4%  9669  320s
H   65    77                    21989.590178 35403.7068  61.0%  9367  320s
    76   196 32503.4368    6  486 21989.5902 35403.7068  61.0%  8892  348s
H  197   300                    22006.927424 35403.7068  60.9%  4858  356s
H  207   300                    22039.092594 35403.7068  60.6%  4695  356s
H  209   300                    22056.429840 35403.7068  60.5%  4694  356s
H  228   300                    22115.786343 35403.7068  60.1%  4411  356s
H  267   300                    22133.519022 35403.7068  60.0%  4008  356s
H  283   300                    22183.021438 35403.7068  59.6%  3906  356s
   303   410 32214.8060   10  483 22183.0214 35403.7068  59.6%  3730  364s
   421   460 32024.4311   13  473 22183.0214 35403.7068  59.6%  3111  370s
   486   508 31934.8861   15  456 22183.0214 35403.7068  59.6%  2965  378s
   553   552 31392.8965   17  398 22183.0214 35403.7068  59.6%  2889  385s
   618   591 31058.7327   18  331 22183.0214 35403.7068  59.6%  2817  394s
   681   606 29226.4581   19  241 22183.0214 35403.7068  59.6%  2763  402s
   730   639 28412.3963   20  239 22183.0214 35403.7068  59.6%  2723  410s
   777   673 27940.3427   22  247 22183.0214 35403.7068  59.6%  2718  417s
   839   692 24343.8980   24  165 22183.0214 35403.7068  59.6%  2671  424s
   906   725     cutoff   26      22183.0214 35403.7068  59.6%  2596  433s
   966   757 30129.3655   11  418 22183.0214 35403.7068  59.6%  2597  442s
  1038   827 29703.3935   12  397 22183.0214 35403.7068  59.6%  2563  450s
  1124   912 28751.1657   13  266 22183.0214 35129.7975  58.4%  2524  458s
  1220  1013 28558.2129   14  262 22183.0214 35129.7975  58.4%  2482  464s
  1357  1109 25868.8259   16  145 22183.0214 35129.7975  58.4%  2371  474s
  1485  1133 25268.2503   19  133 22183.0214 35129.7975  58.4%  2276  482s
  1521  1157 25063.1725   20  117 22183.0214 35129.7975  58.4%  2265  489s
  1574  1190 24873.5321   21  307 22183.0214 34985.6732  57.7%  2260  499s
  1625  1241     cutoff   22      22183.0214 34985.6732  57.7%  2256  508s
  1728  1270 24169.1794   27  119 22183.0214 34985.6732  57.7%  2208  518s
  1817  1322 23560.2527   36  259 22183.0214 34985.6732  57.7%  2164  528s
  1903  1373 22919.0584   41  204 22183.0214 34985.6732  57.7%  2160  538s
  2021  1426 22479.8635   45  232 22183.0214 34985.6732  57.7%  2135  549s
  2162  1510 31315.1950   14  413 22183.0214 34985.6732  57.7%  2091  559s
  2272  1569 30452.8102   16  380 22183.0214 34985.6732  57.7%  2096  570s
  2376  1647 29426.5490   18  365 22183.0214 34985.6732  57.7%  2108  582s
  2490  1766     cutoff   21      22183.0214 34985.6732  57.7%  2110  594s
  2643  1921 23557.4322   21  340 22183.0214 34985.6732  57.7%  2098  605s
  2827  2019 22622.7475   24  317 22183.0214 34481.6892  55.4%  2064  617s
  2989  2141     cutoff   26      22183.0214 34203.4689  54.2%  2017  630s
  3167  2326 31411.6231   11  389 22183.0214 34090.0631  53.7%  1973  640s
  3394  2485 29792.6513   13  375 22183.0214 33985.1538  53.2%  1927  654s
  3653  2486 25984.8377   31  551 22183.0214 33985.1538  53.2%  1878  720s
  3655  2487 29740.6459   15  263 22183.0214 33985.1538  53.2%  1877  754s
  3656  2488 26491.3505   53  415 22183.0214 33985.1538  53.2%  1877  777s
  3657  2489 22999.0305   59  488 22183.0214 33985.1538  53.2%  1876  794s
  3658  2489 29988.3686   23  462 22183.0214 33985.1538  53.2%  1876  802s
  3659  2490 31058.2867   19  491 22183.0214 33985.1538  53.2%  1875  815s
  3660  2491 31331.0778   19  516 22183.0214 33985.1538  53.2%  1875  822s
  3661  2491 25814.3400   35  479 22183.0214 33985.1538  53.2%  1874  827s
  3662  2492 25947.4248   20  506 22183.0214 33985.1538  53.2%  1874  830s
  3665  2494 29739.4838   17  521 22183.0214 33985.1538  53.2%  1872  837s
  3666  2495 25573.6782   55  527 22183.0214 33985.1538  53.2%  1872  840s
  3667  2495 23724.7228   39  628 22183.0214 33985.1538  53.2%  1871  847s
  3668  2496 24927.1132   67  522 22183.0214 33985.1538  53.2%  1871  850s
  3670  2497 25458.0059   33  542 22183.0214 33985.1538  53.2%  1870  859s
  3671  2498 31609.7537   14  551 22183.0214 33985.1538  53.2%  1869  861s
  3673  2499 25151.3826   24  539 22183.0214 33985.1538  53.2%  1868  869s
  3674  2500 26799.4816   43  544 22183.0214 33985.1538  53.2%  1868  871s
  3676  2501 31587.5874   19  606 22183.0214 33985.1538  53.2%  1867  878s
  3677  2502 23844.1811   80  610 22183.0214 33985.1538  53.2%  1866  880s
  3678  2503 25262.6781   48  526 22183.0214 33985.1538  53.2%  1866  892s
  3679  2503 28187.2869   34  522 22183.0214 33985.1538  53.2%  1865  895s
  3681  2505 24097.7448   64  612 22183.0214 33985.1538  53.2%  1864  902s
  3682  2505 24917.6132   43  604 22183.0214 33985.1538  53.2%  1864  908s
  3683  2506 30834.6337   20  579 22183.0214 33985.1538  53.2%  1863  910s
  3685  2507 24781.8797   40  576 22183.0214 33985.1538  53.2%  1862  917s
  3686  2508 25134.8529   41  612 22183.0214 33985.1538  53.2%  1862  921s
  3687  2509 25514.0254   58  612 22183.0214 33985.1538  53.2%  1861  950s
  3688  2509 29939.7890   32  612 22183.0214 33985.1538  53.2%  1861  977s
  3689  2513 33985.1538   15  567 22183.0214 33985.1538  53.2%  1920 1014s
  3691  2516 33985.1538   16  549 22183.0214 33985.1538  53.2%  1924 1034s
  3695  2523 33985.1538   17  523 22183.0214 33985.1538  53.2%  1929 1052s
  3703  2536 33985.1538   18  566 22183.0214 33985.1538  53.2%  1945 1071s
  3719  2554 33985.1538   19  522 22183.0214 33985.1538  53.2%  2020 1099s
  3742  2578 33803.2672   20  577 22183.0214 33985.1538  53.2%  2062 1121s
  3774  2670 33167.2367   21  446 22183.0214 33985.1538  53.2%  2138 1140s
  3884  2662 32103.0867   23  318 22183.0214 33985.1538  53.2%  2237 1150s
  3917  2684 32383.4457   23  457 22183.0214 33985.1538  53.2%  2267 1163s
  3953  2706 31762.6378   22  362 22183.0214 33985.1538  53.2%  2291 1174s
  3995  2723 31756.1212   24  348 22183.0214 33985.1538  53.2%  2311 1183s
  4034  2730 32247.3182   24  445 22183.0214 33985.1538  53.2%  2324 1197s
  4076  2732 29586.2707   24  319 22183.0214 33985.1538  53.2%  2342 1220s
  4128  2731 30153.6662   25  328 22183.0214 33985.1538  53.2%  2356 1233s
  4178  2740 28672.0333   24  362 22183.0214 33985.1538  53.2%  2378 1252s
  4228  2751 29626.1353   26  321 22183.0214 33985.1538  53.2%  2394 1264s
  4291  2776 28283.6434   27  221 22183.0214 33985.1538  53.2%  2403 1275s
  4368  2790 28170.4278   28  196 22183.0214 33985.1538  53.2%  2401 1291s
  4441  2795 26920.5227   29  235 22183.0214 33985.1538  53.2%  2401 1302s
H 4475  2657                    22523.461611 33985.1538  50.9%  2405 1302s
  4508  2705 25289.8559   29  200 22523.4616 33985.1538  50.9%  2406 1320s
H 4608  2576                    22545.332597 33985.1538  50.7%  2411 1332s
H 4641  2451                    22549.838854 33985.1538  50.7%  2417 1332s
  4691  2460 24978.6658   31  163 22549.8389 33985.1538  50.7%  2418 1353s
H 4699  2349                    22570.907833 33985.1538  50.6%  2416 1353s
H 4737  2234                    22617.816832 33985.1538  50.3%  2426 1353s
  4752  2265     cutoff   33      22617.8168 33985.1538  50.3%  2423 1369s
H 4789  2155                    22685.914002 33985.1538  49.8%  2432 1369s
H 4815  2054                    22945.089295 33985.1538  48.1%  2432 1369s
H 4820  1964                    23306.868439 33985.1538  45.8%  2432 1369s
  4842  1996 28098.2329   23  477 23306.8684 33985.1538  45.8%  2436 1382s
  4929  1980 30323.5453   23  538 23306.8684 33985.1538  45.8%  2459 1394s
H 4971  1882                    23307.737557 33985.1538  45.8%  2463 1394s
  5002  1909 30113.9797   24  450 23307.7376 33985.1538  45.8%  2466 1409s
  5097  1927 29741.3985   25  395 23307.7376 33717.7472  44.7%  2480 1422s
H 5181  1820                    23334.753753 33717.7472  44.5%  2505 1422s
  5190  1862 29196.7914   26  349 23334.7538 33717.7472  44.5%  2503 1437s
  5290  1845 27852.9629   27  298 23334.7538 33717.7472  44.5%  2515 1453s
H 5334  1755                    23391.381828 33643.6695  43.8%  2532 1453s
  5335  1788 28613.6977   27  337 23391.3818 33643.6695  43.8%  2533 1468s
  5443  1765     cutoff   28      23391.3818 33163.8968  41.8%  2560 1482s
  5490  1768 27213.4176   29  285 23391.3818 33163.8968  41.8%  2572 1496s
  5542  1763 26299.7579   30  163 23391.3818 33163.8968  41.8%  2585 1511s
  5601  1768     cutoff   31      23391.3818 33163.8968  41.8%  2598 1524s
H 5646  1682                    23460.892285 32893.3372  40.2%  2607 1524s
H 5651  1612                    23464.257036 32893.3372  40.2%  2608 1524s
  5654  1630     cutoff   31      23464.2570 32893.3372  40.2%  2608 1543s
  5836  1619 28246.7955   25  384 23464.2570 32893.3372  40.2%  2610 1561s
  5977  1616 27106.3415   27  357 23464.2570 32243.1853  37.4%  2631 1581s
  6120  1623 infeasible   30      23464.2570 32243.1853  37.4%  2656 1600s
  6269  1608 24235.1843   31  235 23464.2570 32036.1548  36.5%  2681 1625s
  6426  1610 27026.5937   26  338 23464.2570 31920.4187  36.0%  2706 1645s
  6574  1579     cutoff   27      23464.2570 31903.1635  36.0%  2738 1669s
  6784  1514     cutoff   28      23464.2570 31903.1635  36.0%  2742 1684s
  6842  1516 27186.0967   28  361 23464.2570 31230.6639  33.1%  2747 1704s
  6930  1518 25185.4066   29  339 23464.2570 31230.6639  33.1%  2756 1729s
  7094  1518     cutoff   32      23464.2570 31227.2231  33.1%  2764 1755s
  7267  1513     cutoff   28      23464.2570 31227.2231  33.1%  2797 1780s
  7480  1488 27869.9185   31  267 23464.2570 30897.9411  31.7%  2818 1806s
  7696  1509 24742.3837   34  214 23464.2570 30868.2156  31.6%  2839 1835s
  7901  1579 25071.2479   28  328 23464.2570 30776.6399  31.2%  2870 1862s
  8165  1590 24006.1758   32  131 23464.2570 30679.9966  30.8%  2876 1890s
H 8216  1590                    23476.867833 30679.9966  30.7%  2876 1890s
  8337  1647 26272.1883   26  384 23476.8678 30679.9966  30.7%  2892 1919s
  8621  1681 24877.5884   34  199 23476.8678 30286.9055  29.0%  2902 1949s
  8923  1717 26719.4669   24  276 23476.8678 30055.8287  28.0%  2911 1983s
  9248  1701 26862.5814   27  364 23476.8678 29793.3326  26.9%  2916 2015s
  9330  1704 24218.0334   29  381 23476.8678 29793.3326  26.9%  2922 2050s
  9532  1734     cutoff   30      23476.8678 29582.9166  26.0%  2927 2086s
  9844  1772 25108.0860   26  298 23476.8678 29577.8595  26.0%  2942 2123s
 10263  1800 25865.5406   26  494 23476.8678 29178.1122  24.3%  2939 2160s
 10683  1816     cutoff   30      23476.8678 29022.4936  23.6%  2943 2199s
 11099  1827 23653.2159   30  120 23476.8678 28783.0142  22.6%  2950 2238s
 11524  1863     cutoff   33      23476.8678 28475.9430  21.3%  2964 2281s
 11995  1869     cutoff   41      23476.8678 28319.3670  20.6%  2965 2321s
 12498  1862 26411.8902   27  208 23476.8678 28028.6373  19.4%  2965 2366s
 13006  1822 infeasible   29      23476.8678 27968.1978  19.1%  2971 2414s
 13501  1737 24348.0995   30  297 23476.8678 27605.7339  17.6%  2977 2461s
 14040  1667     cutoff   28      23476.8678 27503.8281  17.2%  2982 2511s
 14624  1645 23800.3379   31  248 23476.8678 27144.7438  15.6%  2984 2553s
 14770  1509     cutoff   32      23476.8678 27027.7039  15.1%  2984 2603s
 15405  1270 24068.0849   34  351 23476.8678 26875.2433  14.5%  2965 2655s
 16150   861 23866.4092   26  191 23476.8678 26482.8096  12.8%  2951 2709s
 17124   139     cutoff   28      23476.8678 25994.7956  10.7%  2900 2754s
 18424    72     cutoff   46      23476.8678 25276.8121  7.67%  2782 2762s
*19227    27              62    23508.862600 23625.8627  0.50%  2674 2764s
 19571     0 23533.6166   54    8 23508.8626 23563.9400  0.23%  2629 2765s

Cutting planes:
  Learned: 3
  MIR: 1061
  Mixing: 1
  Flow cover: 2741
  RLT: 32
  Relax-and-lift: 263

Explored 19692 nodes (51683344 simplex iterations) in 2765.55 seconds (8456.81 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 23508.9 23476.9 23464.3 ... 22685.9

Optimal solution found (tolerance 1.00e-04)
Best objective 2.350886259964e+04, best bound 2.350886259964e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 2765.57s
  Master Objective (UB) = 23508.86, θ = 166272.59
  Upper Bound (UB) = 23508.86

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 166272.59
  [DEBUG]   ✓ Scenario 0: θ = 166272.59 ≤ Q = 166272.59 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 166272.59 ≤ Q = 166272.59 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 166272.59 ≤ Q = 166272.59 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 166272.59 ≤ Q = 166272.59 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 166272.59 ≤ Q = 166272.59 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 166272.59 ≤ Q = 166272.59 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 166272.59 ≤ Q = 166272.59 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x32b65ce7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xcd49a319
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.320081e+13
Presolve removed 2581 rows and 1872 columns
Presolve time: 0.00s
Presolved: 512 rows, 517 columns, 1445 nonzeros
Found heuristic solution: objective 6643026.4690
Variable types: 350 continuous, 167 integer (167 binary)

Root relaxation: objective -1.498961e+05, 253 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -149896.12    0  125 6643026.47 -149896.12   102%     -    0s
H    0     0                    -101054.1113 -149896.12  48.3%     -    0s
H    0     0                    -101966.7877 -149896.12  47.0%     -    0s
H    0     0                    -122146.8798 -149896.12  22.7%     -    0s
     0     0 -127649.40    0   70 -122146.88 -127649.40  4.50%     -    0s
H    0     0                    -123695.6847 -127607.59  3.16%     -    0s
     0     0 -127307.30    0   62 -123695.68 -127307.30  2.92%     -    0s
H    0     0                    -126437.8252 -127288.87  0.67%     -    0s
     0     0 -127288.87    0   52 -126437.83 -127288.87  0.67%     -    0s
     0     0 -127029.31    0   77 -126437.83 -127029.31  0.47%     -    0s
     0     0 -127005.43    0   41 -126437.83 -127005.43  0.45%     -    0s
     0     0 -127005.29    0   41 -126437.83 -127005.29  0.45%     -    0s
     0     0 -127004.41    0   72 -126437.83 -127004.41  0.45%     -    0s
H    0     0                    -126469.4122 -127004.41  0.42%     -    0s
     0     0 -126833.30    0   47 -126469.41 -126833.30  0.29%     -    0s
     0     0 -126822.28    0   24 -126469.41 -126822.28  0.28%     -    0s
     0     0 -126790.73    0   55 -126469.41 -126790.73  0.25%     -    0s
     0     0 -126786.29    0   53 -126469.41 -126786.29  0.25%     -    0s
H    0     0                    -126480.1138 -126786.29  0.24%     -    0s
H    0     0                    -126481.2196 -126786.29  0.24%     -    0s
     0     0 -126709.81    0   39 -126481.22 -126709.81  0.18%     -    0s
     0     0 -126709.81    0   48 -126481.22 -126709.81  0.18%     -    0s
     0     0 -126709.81    0   48 -126481.22 -126709.81  0.18%     -    0s
     0     0 -126619.37    0   13 -126481.22 -126619.37  0.11%     -    0s
     0     0 -126603.51    0   10 -126481.22 -126603.51  0.10%     -    0s
H    0     0                    -126514.6479 -126588.02  0.06%     -    0s
H    0     0                    -126521.7293 -126588.02  0.05%     -    0s
     0     0 -126556.96    0   12 -126521.73 -126556.96  0.03%     -    0s
     0     0          -    0      -126521.73 -126532.15  0.01%     -    0s

Cutting planes:
  Gomory: 10
  Implied bound: 5
  MIR: 31
  Flow cover: 6
  RLT: 4
  Relax-and-lift: 1

Explored 1 nodes (947 simplex iterations) in 0.07 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -126522 -126515 -126481 ... 1.32008e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.265217292685e+05, best bound -1.265321466576e+05, gap 0.0082%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 153305.61
  Scenario: 21 demand increases, 39 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -126521.73
  [DEBUG]   S×d_nominal = 279827.34
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 279827.34 + -126521.73 = 153305.61
  [DEBUG]   Current θ from Master = 166272.59
  [DEBUG]   ⚠️  Z_SP ≤ θ by 12966.99 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 10541.88
  Lower Bound (LB) = 19044.82
  Gap (UB-LB) = 4464.0438, Absolute Gap = 4464.0438, Relative Gap = 0.189888
  Not converged yet (gap = 4464.04 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 21 increases, 39 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351463 nonzeros
Model fingerprint: 0xc778cb85
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 53368 rows and 21668 columns
Presolve time: 1.12s
Presolved: 70335 rows, 30512 columns, 437799 nonzeros
Variable types: 28253 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -326728.6770
Found heuristic solution: objective -184683.4741

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 70335 rows, 30512 columns, 437799 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   35620   -5.1084150e+04   0.000000e+00   1.716427e+07      5s
   50127    1.0993603e+04   0.000000e+00   3.270074e+06     10s
   60665    2.4158948e+04   0.000000e+00   5.214490e+08     15s
   69150    2.9858146e+04   0.000000e+00   5.942099e+06     20s
   76151    3.0881936e+04   0.000000e+00   5.773507e+07     25s
   82584    3.1434117e+04   0.000000e+00   1.643805e+07     30s
   90708    3.4444047e+04   0.000000e+00   2.194081e+06     35s
Concurrent spin time: 11.30s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 4.859565e+04, 75947 iterations, 46.30 seconds (78.62 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 48595.6468    0  260 -184683.47 48595.6468   126%     -   48s
H    0     0                    -176024.7584 48595.6468   128%     -   48s
H    0     0                    -146401.8056 48595.6468   133%     -   48s
H    0     0                    -116279.7500 48595.6468   142%     -   48s
H    0     0                    -114596.0605 48595.6468   142%     -   48s
H    0     0                    -66268.08877 48595.6468   173%     -   48s
H    0     0                    -66179.34396 48595.6468   173%     -   48s
H    0     0                    -39322.17029 48595.6468   224%     -   48s
H    0     0                    -39307.98327 48595.6468   224%     -   48s
H    0     0                    -12643.33107 48595.6468   484%     -   48s
H    0     0                    -12444.45879 48595.6468   491%     -   48s
H    0     0                    1514.9969543 48595.6468  3108%     -   48s
H    0     0                    12634.873036 44456.6473   252%     -   60s
H    0     0                    17349.192839 44456.6473   156%     -   60s
H    0     0                    17455.184043 44456.6473   155%     -   60s
H    0     0                    17500.604997 44456.6473   154%     -   60s
     0     0 44456.6473    0  319 17500.6050 44456.6473   154%     -   60s
     0     0 43347.0037    0  325 17500.6050 43347.0037   148%     -   68s
     0     0 43226.5821    0  327 17500.6050 43226.5821   147%     -   72s
     0     0 43226.5821    0  328 17500.6050 43226.5821   147%     -   74s
     0     0 43107.2369    0  351 17500.6050 43107.2369   146%     -   76s
     0     0 42993.0062    0  325 17500.6050 42993.0062   146%     -   81s
     0     0 42993.0062    0  324 17500.6050 42993.0062   146%     -   87s
     0     0 42988.8187    0  346 17500.6050 42988.8187   146%     -   89s
     0     0 42987.3591    0  349 17500.6050 42987.3591   146%     -   89s
     0     0 42987.2163    0  349 17500.6050 42987.2163   146%     -   89s
     0     0 40482.5856    0  393 17500.6050 40482.5856   131%     -  104s
H    0     0                    18963.427983 40482.5856   113%     -  104s
H    0     0                    20279.142470 40482.5856   100%     -  104s
H    0     0                    20439.622037 40482.5856  98.1%     -  104s
     0     0 39799.5535    0  384 20439.6220 39799.5535  94.7%     -  113s
     0     0 39430.8410    0  403 20439.6220 39430.8410  92.9%     -  119s
     0     0 39367.1412    0  410 20439.6220 39367.1412  92.6%     -  123s
     0     0 39312.2210    0  406 20439.6220 39312.2210  92.3%     -  126s
     0     0 39303.8352    0  404 20439.6220 39303.8352  92.3%     -  127s
     0     0 39295.7767    0  410 20439.6220 39295.7767  92.3%     -  128s
     0     0 39293.7585    0  414 20439.6220 39293.7585  92.2%     -  128s
     0     0 39290.2496    0  411 20439.6220 39290.2496  92.2%     -  129s
     0     0 39289.8260    0  413 20439.6220 39289.8260  92.2%     -  129s
     0     0 37929.0168    0  419 20439.6220 37929.0168  85.6%     -  149s
H    0     0                    20474.715060 37928.6380  85.2%     -  149s
H    0     0                    20483.585051 37928.6380  85.2%     -  149s
H    0     0                    20763.357227 37303.7514  79.7%     -  161s
H    0     0                    20833.503438 37303.7514  79.1%     -  161s
     0     0 37303.7514    0  399 20833.5034 37303.7514  79.1%     -  161s
     0     0 37077.2102    0  453 20833.5034 37077.2102  78.0%     -  166s
     0     0 37009.1612    0  458 20833.5034 37009.1612  77.6%     -  170s
     0     0 36978.2477    0  465 20833.5034 36978.2477  77.5%     -  172s
     0     0 36961.8579    0  456 20833.5034 36961.8579  77.4%     -  174s
     0     0 36930.3874    0  457 20833.5034 36930.3874  77.3%     -  176s
     0     0 36909.5224    0  430 20833.5034 36909.5224  77.2%     -  177s
     0     0 36906.1820    0  433 20833.5034 36906.1820  77.1%     -  178s
     0     0 36903.8967    0  434 20833.5034 36903.8967  77.1%     -  179s
     0     0 36898.7458    0  431 20833.5034 36898.7458  77.1%     -  179s
     0     0 36897.8990    0  441 20833.5034 36897.8990  77.1%     -  180s
H    0     0                    21685.527480 36897.8990  70.1%     -  185s
H    0     0                    21876.510129 36897.8990  68.7%     -  185s
     0     0 36307.5813    0  471 21876.5101 36307.5813  66.0%     -  194s
H    0     0                    22039.092594 36307.2335  64.7%     -  194s
     0     0 36162.6145    0  479 22039.0926 36162.6145  64.1%     -  200s
     0     0 36112.2010    0  467 22039.0926 36112.2010  63.9%     -  203s
     0     0 36086.4509    0  516 22039.0926 36086.4509  63.7%     -  205s
     0     0 36056.4659    0  525 22039.0926 36056.4659  63.6%     -  208s
     0     0 36044.7073    0  523 22039.0926 36044.7073  63.5%     -  209s
     0     0 36026.6119    0  482 22039.0926 36026.6119  63.5%     -  210s
     0     0 36020.5482    0  493 22039.0926 36020.5482  63.4%     -  211s
     0     0 36018.5529    0  490 22039.0926 36018.5529  63.4%     -  211s
     0     0 36017.8376    0  490 22039.0926 36017.8376  63.4%     -  212s
     0     0 35931.5671    0  518 22039.0926 35931.5671  63.0%     -  217s
     0     0 35910.5962    0  521 22039.0926 35910.5962  62.9%     -  219s
     0     0 35898.9309    0  526 22039.0926 35898.9309  62.9%     -  221s
     0     0 35895.9906    0  531 22039.0926 35895.9906  62.9%     -  222s
     0     0 35894.8224    0  535 22039.0926 35894.8224  62.9%     -  222s
     0     0 35851.5827    0  543 22039.0926 35851.5827  62.7%     -  226s
     0     0 35838.9338    0  532 22039.0926 35838.9338  62.6%     -  229s
     0     0 35836.1967    0  533 22039.0926 35836.1967  62.6%     -  230s
     0     0 35834.3426    0  537 22039.0926 35834.3426  62.6%     -  230s
     0     0 35833.4030    0  542 22039.0926 35833.4030  62.6%     -  231s
     0     0 35806.5293    0  546 22039.0926 35806.5293  62.5%     -  234s
     0     0 35801.0995    0  542 22039.0926 35801.0995  62.4%     -  235s
H    0     0                    22183.021438 35798.5967  61.4%     -  235s
     0     0 35798.5967    0  544 22183.0214 35798.5967  61.4%     -  236s
     0     0 35797.8471    0  543 22183.0214 35797.8471  61.4%     -  236s
     0     0 35782.2674    0  541 22183.0214 35782.2674  61.3%     -  238s
     0     0 35777.8638    0  545 22183.0214 35777.8638  61.3%     -  240s
     0     0 35776.2682    0  536 22183.0214 35776.2682  61.3%     -  240s
     0     0 35775.5776    0  546 22183.0214 35775.5776  61.3%     -  241s
     0     0 35764.3837    0  540 22183.0214 35764.3837  61.2%     -  243s
     0     0 35752.8820    0  531 22183.0214 35752.8820  61.2%     -  244s
     0     0 35749.7779    0  536 22183.0214 35749.7779  61.2%     -  245s
     0     0 35748.5526    0  535 22183.0214 35748.5526  61.2%     -  245s
     0     0 35730.8890    0  542 22183.0214 35730.8890  61.1%     -  248s
     0     0 35726.6450    0  535 22183.0214 35726.6450  61.1%     -  249s
     0     0 35722.0922    0  543 22183.0214 35722.0922  61.0%     -  250s
     0     0 35721.4062    0  548 22183.0214 35721.4062  61.0%     -  251s
     0     0 35714.8035    0  538 22183.0214 35714.8035  61.0%     -  253s
     0     0 35711.7909    0  553 22183.0214 35711.7909  61.0%     -  254s
     0     0 35711.1540    0  552 22183.0214 35711.1540  61.0%     -  255s
     0     0 35706.1250    0  554 22183.0214 35706.1250  61.0%     -  257s
     0     0 35704.9562    0  555 22183.0214 35704.9562  61.0%     -  264s
     0     0 35695.5983    0  551 22183.0214 35695.5983  60.9%     -  266s
     0     0 35693.1208    0  554 22183.0214 35693.1208  60.9%     -  267s
     0     0 35691.0293    0  552 22183.0214 35691.0293  60.9%     -  268s
     0     0 35689.3318    0  549 22183.0214 35689.3318  60.9%     -  268s
     0     0 35688.9244    0  551 22183.0214 35688.9244  60.9%     -  269s
     0     0 35683.6457    0  539 22183.0214 35683.6457  60.9%     -  271s
     0     0 35683.4845    0  539 22183.0214 35683.4845  60.9%     -  272s
     0     2 35683.0459    0  539 22183.0214 35683.0459  60.9%     -  359s
     1     4 35431.6323    1  474 22183.0214 35681.7192  60.9%  3883  366s
     3     7 35056.2081    2  544 22183.0214 35430.9297  59.7%  6732  380s
     6    14 34753.0928    3  523 22183.0214 35312.7169  59.2%  9607  390s
    13    28 34292.0534    4  544 22183.0214 34746.9750  56.6%  9517  407s
    27    43 34240.0638    4  457 22183.0214 34292.0166  54.6% 12871  433s
    42    75 33940.4925    5  472 22183.0214 34292.0166  54.6% 11503  455s
    74   128 33685.6265    6  451 22183.0214 34233.2660  54.3%  9321  472s
   127   230 33607.1757    7  436 22183.0214 34233.2660  54.3%  6852  489s
   229   341 33501.6519    8  437 22183.0214 34233.2660  54.3%  4812  502s
   340   380 33454.8508    9  437 22183.0214 34233.2660  54.3%  4106  508s
   389   432 33349.2667   10  431 22183.0214 34233.2660  54.3%  3833  518s
   446   482 33273.3495   11  375 22183.0214 34233.2660  54.3%  3657  527s
   518   528 32031.3124   13  371 22183.0214 34233.2660  54.3%  3546  537s
   588   561 31583.3654   16  359 22183.0214 34233.2660  54.3%  3493  548s
   653   598 31238.8191   18  350 22183.0214 34233.2660  54.3%  3473  558s
   720   629 30818.9702   20  229 22183.0214 34233.2660  54.3%  3457  568s
   783   636 30748.6598   21  386 22183.0214 34233.2660  54.3%  3394  579s
   840   650 30080.0156   23  334 22183.0214 34233.2660  54.3%  3436  590s
   876   680 29299.4731   24  204 22183.0214 34233.2660  54.3%  3581  602s
   920   713 29115.7528   25  321 22183.0214 34233.2660  54.3%  3744  613s
   972   793 29083.6046   27  261 22183.0214 34233.2660  54.3%  3862  623s
  1059   827 28364.3010   31  180 22183.0214 34233.2660  54.3%  3821  634s
  1125   873 28063.5156   32  166 22183.0214 34233.2660  54.3%  3867  645s
  1199   935 28044.9502   33  186 22183.0214 34233.2660  54.3%  3876  657s
  1285  1001 26402.4883   36  228 22183.0214 34233.2660  54.3%  3903  669s
  1392  1059 25899.9075   41  171 22183.0214 34233.2660  54.3%  3897  681s
  1498  1129 24992.1372   44  200 22183.0214 34233.2660  54.3%  3868  694s
  1639  1169 24312.8767   52  129 22183.0214 34233.2660  54.3%  3776  708s
  1740  1208     cutoff   62      22183.0214 34233.2660  54.3%  3782  721s
  1833  1246 30254.2190   11  363 22183.0214 33944.6182  53.0%  3878  736s
  1913  1273 29641.8027   12  360 22183.0214 33944.6182  53.0%  3972  750s
  2006  1325 27907.3998   13  326 22183.0214 33944.6182  53.0%  4038  766s
  2106  1412     cutoff   14      22183.0214 33944.6182  53.0%  4098  782s
  2235  1439 30188.7479   12  428 22183.0214 33944.6182  53.0%  4106  798s
  2269  1466 23092.4398   13  322 22183.0214 33944.6182  53.0%  4154  825s
  2316  1493 22417.6035   14  244 22183.0214 33944.6182  53.0%  4209  841s
  2373  1516 22338.0075   15  141 22183.0214 33944.6182  53.0%  4241  858s
  2434  1564 infeasible   16      22183.0214 33862.9036  52.7%  4253  875s
  2527  1630     cutoff   15      22183.0214 33862.9036  52.7%  4227  892s
  2657  1658 29202.6835   14  271 22183.0214 33862.9036  52.7%  4171  911s
  2767  1708 28374.6350   15  347 22183.0214 33862.9036  52.7%  4148  929s
  2879  1779 27982.0889   16  339 22183.0214 33500.9366  51.0%  4149  948s
  2992  1823 26518.1289   17  344 22183.0214 33451.7753  50.8%  4169  968s
  3078  1878 26406.3631   18  290 22183.0214 33451.7753  50.8%  4211  990s
  3209  1954 25165.7903   19  287 22183.0214 33451.7753  50.8%  4209 1010s
  3340  2061     cutoff   20      22183.0214 33366.8338  50.4%  4243 1032s
  3485  2151 23135.2016   21  329 22183.0214 33366.8338  50.4%  4282 1052s
  3649  2243 22957.4403   22  332 22183.0214 33366.8338  50.4%  4314 1074s
  3819  2344     cutoff   23      22183.0214 33366.8338  50.4%  4353 1098s
  4027  2418 31649.8983   12  302 22183.0214 33366.8338  50.4%  4376 1126s
  4240  2480 31051.9732   13  340 22183.0214 33348.1300  50.3%  4399 1151s
  4422  2592 30540.1185   14  336 22183.0214 33182.9644  49.6%  4450 1179s
  4599  2593 25094.3930   34  539 22183.0214 33182.9644  49.6%  4516 1299s
  4601  2594 23714.5654   40  260 22183.0214 33182.9644  49.6%  4514 1351s
  4602  2595 25892.7359   38  420 22183.0214 33182.9644  49.6%  4513 1385s
  4603  2596 30954.5986   10  437 22183.0214 33182.9644  49.6%  4512 1406s
  4604  2596 24786.4639   34  482 22183.0214 33182.9644  49.6%  4511 1416s
  4605  2597 26775.9568   22  495 22183.0214 33182.9644  49.6%  4510 1424s
  4606  2598 24816.9044   19  505 22183.0214 33182.9644  49.6%  4509 1431s
  4607  2598 26806.5752   18  515 22183.0214 33182.9644  49.6%  4508 1437s
  4608  2599 27131.7576   27  520 22183.0214 33182.9644  49.6%  4507 1442s
  4609  2600 24548.7321   48  522 22183.0214 33182.9644  49.6%  4506 1446s
  4611  2601 31845.2807   12  573 22183.0214 33182.9644  49.6%  4504 1453s
  4612  2602 23127.2254   47  488 22183.0214 33182.9644  49.6%  4503 1463s
  4613  2602 25192.3088   17  539 22183.0214 33182.9644  49.6%  4502 1469s
  4614  2603 27988.7295   16  541 22183.0214 33182.9644  49.6%  4501 1471s
  4615  2604 24655.1031   23  589 22183.0214 33182.9644  49.6%  4500 1475s
  4617  2605 24749.9074   20  549 22183.0214 33182.9644  49.6%  4498 1486s
  4618  2606 30233.6569   10  602 22183.0214 33182.9644  49.6%  4497 1490s
  4619  2606 30846.1721    8  520 22183.0214 33182.9644  49.6%  4496 1495s
  4621  2608 27197.1653   22  587 22183.0214 33182.9644  49.6%  4494 1503s
  4622  2608 29485.6756   11  603 22183.0214 33182.9644  49.6%  4493 1506s
  4623  2609 26200.5697   18  553 22183.0214 33182.9644  49.6%  4492 1516s
  4624  2610 26390.2596   16  615 22183.0214 33182.9644  49.6%  4491 1520s
  4625  2610 26411.5375   30  610 22183.0214 33182.9644  49.6%  4490 1526s
  4626  2611 29362.0624   26  610 22183.0214 33182.9644  49.6%  4489 1530s
  4627  2612 30605.2907   18  630 22183.0214 33182.9644  49.6%  4488 1540s
  4629  2613 23766.3021   24  604 22183.0214 33182.9644  49.6%  4486 1549s
  4630  2614 31996.5329   10  604 22183.0214 33182.9644  49.6%  4485 1680s
  4631  2614 24316.3324   17  604 22183.0214 33182.9644  49.6%  4484 1740s
  4632  2618 33182.9644   12  473 22183.0214 33182.9644  49.6%  4535 1784s
  4634  2621 33182.9644   13  520 22183.0214 33182.9644  49.6%  4538 1813s
  4638  2628 33182.9644   14  574 22183.0214 33182.9644  49.6%  4543 1851s
  4646  2641 33182.9644   15  537 22183.0214 33182.9644  49.6%  4557 1881s
  4662  2653 29992.5191   16  420 22183.0214 33182.9644  49.6%  4623 1930s
  4679  2679 32004.2528   17  476 22183.0214 33182.9644  49.6%  4654 1976s
  4711  2719 31868.7425   18  505 22183.0214 33182.9644  49.6%  4675 2006s
  4761  2768 31451.8757   19  404 22183.0214 33182.9644  49.6%  4662 2038s
  4849  2787 31198.8708   20  534 22183.0214 33182.9644  49.6%  4650 2066s
  4947  2756 29686.3231   21  425 22183.0214 33182.9644  49.6%  4638 2092s
H 4980  2613                    22198.393518 33182.9644  49.5%  4643 2092s
  4999  2640 26289.9570   21  329 22198.3935 33182.9644  49.5%  4647 2118s
  5080  2629 26862.4861   21  256 22198.3935 33182.9644  49.5%  4642 2146s
H 5096  2499                    22549.838854 33182.9644  47.2%  4646 2146s
  5116  2510 25718.0823   20  381 22549.8389 33182.9644  47.2%  4651 2165s
  5210  2496 29324.7128   20  416 22549.8389 33182.9644  47.2%  4627 2180s
H 5238  2368                    22570.907833 33182.9644  47.0%  4628 2180s
  5251  2400 23791.5453   28  237 22570.9078 33182.9644  47.0%  4630 2197s
  5337  2396 28840.1070   21  360 22570.9078 33182.9644  47.0%  4608 2221s
H 5389  2267                    23023.619640 33182.9644  44.1%  4593 2221s
  5411  2249 26104.2915   22  343 23023.6196 33182.9644  44.1%  4587 2244s
H 5448  2130                    23184.656484 33182.9644  43.1%  4575 2244s
  5471  2141     cutoff   23      23184.6565 33182.9644  43.1%  4566 2262s
  5534  2133     cutoff   23      23184.6565 33182.9644  43.1%  4562 2279s
  5600  2118 27148.1482   19  362 23184.6565 33036.5467  42.5%  4559 2294s
H 5603  2015                    23189.162741 33036.5467  42.5%  4556 2294s
  5640  2027 27007.5515   20  341 23189.1627 33036.5467  42.5%  4558 2313s
H 5722  1907                    23190.602447 33036.5467  42.5%  4540 2338s
H 5774  1797                    23193.084435 33036.5467  42.4%  4528 2338s
  5788  1811     cutoff   26      23193.0844 31642.1591  36.4%  4528 2363s
  5883  1794 29632.4656   19  433 23193.0844 31616.8695  36.3%  4515 2385s
  5963  1795 29325.2543   19  422 23193.0844 31616.8695  36.3%  4522 2404s
  6059  1800 28279.0009   20  286 23193.0844 31616.8695  36.3%  4515 2424s
  6166  1797 27877.3448   21  369 23193.0844 31616.8695  36.3%  4497 2446s
  6278  1798 25348.4650   22  362 23193.0844 31368.2131  35.2%  4485 2467s
  6408  1769 23968.1591   25  257 23193.0844 31368.2131  35.2%  4465 2486s
H 6410  1681                    23194.524140 31368.2131  35.2%  4465 2486s
  6451  1697 23769.3507   26  261 23194.5241 30669.6116  32.2%  4460 2512s
  6612  1676 25870.2730   22  495 23194.5241 30669.6116  32.2%  4421 2541s
  6749  1653 24999.7115   25  367 23194.5241 30669.6116  32.2%  4394 2574s
  6878  1643 23666.5606   30  338 23194.5241 30669.6116  32.2%  4384 2606s
  7026  1617 24638.9722   23  400 23194.5241 30669.6116  32.2%  4365 2643s
  7173  1578 24173.2358   26  395 23194.5241 30669.6116  32.2%  4353 2666s
  7253  1568 23644.5516   27  386 23194.5241 29685.7068  28.0%  4349 2693s
  7379  1559     cutoff   25      23194.5241 29346.2931  26.5%  4342 2722s
  7534  1517     cutoff   25      23194.5241 29235.6589  26.0%  4329 2754s
  7717  1496     cutoff   28      23194.5241 29235.6589  26.0%  4307 2787s
  7911  1459     cutoff   25      23194.5241 28699.3850  23.7%  4290 2819s
  8134  1423 23513.6395   23  330 23194.5241 28699.3850  23.7%  4265 2861s
  8361  1385 25452.1579   22  489 23194.5241 28699.3850  23.7%  4235 2898s
  8597  1345     cutoff   30      23194.5241 28478.9899  22.8%  4211 2936s
  8845  1285 24981.2718   28  316 23194.5241 28175.5487  21.5%  4186 2973s
  9100  1222     cutoff   33      23194.5241 28175.5487  21.5%  4162 3009s
  9245  1193 23727.4106   34  295 23194.5241 27423.3409  18.2%  4150 3062s
  9536  1179 23410.6987   26  207 23194.5241 27243.2658  17.5%  4114 3116s
  9873  1194 23420.8478   31  242 23194.5241 26998.7460  16.4%  4073 3160s
 10218  1205     cutoff   27      23194.5241 26762.3822  15.4%  4040 3207s
 10557  1235 23201.9846   25  208 23194.5241 26520.6801  14.3%  4019 3254s
 10920  1231 24135.0201   24  321 23194.5241 26343.9819  13.6%  3993 3303s
 11376  1203     cutoff   24      23194.5241 25906.4963  11.7%  3944 3354s
 11853  1106 23605.9811   24  256 23194.5241 25829.6480  11.4%  3893 3410s
 12357   970 infeasible   30      23194.5241 25502.5597  10.0%  3846 3458s
 12894   745     cutoff   29      23194.5241 25254.3267  8.88%  3795 3513s
 13531   240     cutoff   31      23194.5241 24966.5709  7.64%  3724 3564s
 14283     0     cutoff   25      23194.5241 24393.7584  5.17%  3621 3582s

Cutting planes:
  Learned: 2
  MIR: 957
  Mixing: 1
  Flow cover: 2354
  RLT: 43
  Relax-and-lift: 248

Explored 14625 nodes (52327471 simplex iterations) in 3582.86 seconds (10143.89 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 23194.5 23193.1 23190.6 ... 22183

Optimal solution found (tolerance 1.00e-04)
Best objective 2.319452414040e+04, best bound 2.319452414040e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3582.87s
  Master Objective (UB) = 23194.52, θ = 167112.28
  Upper Bound (UB) = 23194.52

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 167112.28
  [DEBUG]   ✓ Scenario 0: θ = 167112.28 ≤ Q = 167112.28 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 167112.28 ≤ Q = 167112.28 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 167112.28 ≤ Q = 167112.28 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 167112.28 ≤ Q = 167112.28 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 167112.28 ≤ Q = 167112.28 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 167112.28 ≤ Q = 167112.28 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 167112.28 ≤ Q = 167112.28 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 167112.28 ≤ Q = 167112.28 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x2cf9c303
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x2cf9c303
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [2e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.356012e+13
Presolve removed 2575 rows and 1867 columns
Presolve time: 0.00s
Presolved: 518 rows, 522 columns, 1461 nonzeros
Found heuristic solution: objective 6858192.4019
Variable types: 354 continuous, 168 integer (168 binary)

Root relaxation: objective -1.584270e+05, 263 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -158427.04    0  130 6858192.40 -158427.04   102%     -    0s
H    0     0                    -122948.3916 -158427.04  28.9%     -    0s
H    0     0                    -123188.4279 -158427.04  28.6%     -    0s
H    0     0                    -126328.4947 -158427.04  25.4%     -    0s
H    0     0                    -132523.8350 -158427.04  19.5%     -    0s
H    0     0                    -135434.1195 -136399.62  0.71%     -    0s
     0     0 -136256.64    0   32 -135434.12 -136256.64  0.61%     -    0s
     0     0 -136006.47    0   34 -135434.12 -136006.47  0.42%     -    0s
     0     0 -135993.18    0   34 -135434.12 -135993.18  0.41%     -    0s
     0     0 -135992.57    0   34 -135434.12 -135992.57  0.41%     -    0s
     0     0 -135842.78    0    8 -135434.12 -135842.78  0.30%     -    0s
H    0     0                    -135780.4963 -135842.38  0.05%     -    0s
     0     0 -135822.33    0    5 -135780.50 -135822.33  0.03%     -    0s
     0     0 -135822.14    0    4 -135780.50 -135822.14  0.03%     -    0s
     0     0 -135822.02    0    4 -135780.50 -135822.02  0.03%     -    0s
H    0     0                    -135795.3969 -135822.02  0.02%     -    0s
     0     0 -135817.99    0    2 -135795.40 -135817.99  0.02%     -    0s
     0     0 -135817.99    0    9 -135795.40 -135817.99  0.02%     -    0s
H    0     0                    -135804.8546 -135817.99  0.01%     -    0s

Explored 1 nodes (525 simplex iterations) in 0.05 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -135805 -135795 -135780 ... 1.35601e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.358048545770e+05, best bound -1.358179898381e+05, gap 0.0097%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 153501.13
  Scenario: 11 demand increases, 49 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -135804.85
  [DEBUG]   S×d_nominal = 289305.99
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 289305.99 + -135804.85 = 153501.13
  [DEBUG]   Current θ from Master = 167112.28
  [DEBUG]   ⚠️  Z_SP ≤ θ by 13611.15 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 9583.37
  Lower Bound (LB) = 19044.82
  Gap (UB-LB) = 4149.7053, Absolute Gap = 4149.7053, Relative Gap = 0.178909
  Not converged yet (gap = 4149.71 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 11 increases, 49 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394706 nonzeros
Model fingerprint: 0x57da7d82
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 60034 rows and 24374 columns
Presolve time: 1.10s
Presolved: 78959 rows, 34046 columns, 483785 nonzeros
Variable types: 31787 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -326728.6770
Found heuristic solution: objective -184683.4741

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 78959 rows, 34046 columns, 483785 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   35800   -9.2731384e+04   0.000000e+00   5.676897e+07      5s
   51327   -7.8461190e+02   0.000000e+00   1.308088e+07     10s
   62272    1.0856916e+04   0.000000e+00   1.149738e+08     15s
   72587    1.6824390e+04   0.000000e+00   2.810128e+06     20s
   81350    2.5313390e+04   0.000000e+00   3.466108e+07     25s
   90370    3.1171685e+04   0.000000e+00   3.294381e+07     30s
   97683    3.5708925e+04   0.000000e+00   1.358341e+07     35s
  105106    3.9544195e+04   0.000000e+00   5.366516e+06     40s
Concurrent spin time: 9.45s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 5.159312e+04, 84851 iterations, 52.46 seconds (93.71 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 51593.1230    0  404 -184683.47 51593.1230   128%     -   54s
H    0     0                    -169508.6893 51593.1230   130%     -   54s
H    0     0                    -93107.56195 51593.1230   155%     -   54s
H    0     0                    -83145.98334 51593.1230   162%     -   54s
H    0     0                    -59218.72771 51593.1230   187%     -   54s
H    0     0                    -58838.43612 51593.1230   188%     -   54s
H    0     0                    -21649.60355 51593.1230   338%     -   54s
H    0     0                    -9506.544170 51593.1230   643%     -   54s
H    0     0                    -2357.965953 51593.1230  2288%     -   54s
H    0     0                    -2196.492732 51593.1230  2449%     -   54s
H    0     0                    5796.5642986 51593.1230   790%     -   56s
H    0     0                    8145.6491608 51593.1230   533%     -   56s
H    0     0                    9950.1544603 51593.1230   419%     -   56s
H    0     0                    10247.074711 45572.6319   345%     -   73s
     0     0 45458.3256    0  400 10247.0747 45458.3256   344%     -   73s
H    0     0                    13592.204737 45458.3256   234%     -   73s
     0     0 43795.0522    0  348 13592.2047 43795.0522   222%     -   85s
     0     0 43604.8900    0  376 13592.2047 43604.8900   221%     -   89s
     0     0 43604.8900    0  346 13592.2047 43604.8900   221%     -   94s
     0     0 43604.8900    0  341 13592.2047 43604.8900   221%     -   98s
     0     0 43604.8900    0  390 13592.2047 43604.8900   221%     -  100s
H    0     0                    13849.629240 43604.8900   215%     -  103s
H    0     0                    15032.758207 43604.8900   190%     -  103s
     0     0 41150.7960    0  362 15032.7582 41150.7960   174%     -  103s
     0     0 41150.7851    0  363 15032.7582 41150.7851   174%     -  105s
     0     0 41150.7851    0  366 15032.7582 41150.7851   174%     -  107s
     0     0 41150.7851    0  364 15032.7582 41150.7851   174%     -  107s
     0     0 41150.7851    0  363 15032.7582 41150.7851   174%     -  108s
     0     0 40996.4360    0  406 15032.7582 40996.4360   173%     -  126s
H    0     0                    15120.635297 40192.4103   166%     -  139s
     0     0 40192.4103    0  417 15120.6353 40192.4103   166%     -  139s
     0     0 40005.1532    0  414 15120.6353 40005.1532   165%     -  146s
     0     0 39979.0650    0  415 15120.6353 39979.0650   164%     -  148s
     0     0 39901.8106    0  423 15120.6353 39901.8106   164%     -  153s
     0     0 39891.7898    0  452 15120.6353 39891.7898   164%     -  154s
     0     0 39888.5796    0  447 15120.6353 39888.5796   164%     -  155s
     0     0 39881.7997    0  439 15120.6353 39881.7997   164%     -  156s
     0     0 39876.8441    0  443 15120.6353 39876.8441   164%     -  157s
     0     0 39876.2403    0  449 15120.6353 39876.2403   164%     -  157s
H    0     0                    17688.669417 39876.2403   125%     -  168s
     0     0 37988.7961    0  432 17688.6694 37988.7961   115%     -  186s
H    0     0                    17795.439040 37988.3017   113%     -  186s
     0     0 37552.4377    0  458 17795.4390 37552.4377   111%     -  195s
     0     0 37342.1944    0  458 17795.4390 37342.1944   110%     -  202s
     0     0 37258.0489    0  452 17795.4390 37258.0489   109%     -  206s
     0     0 37147.4591    0  458 17795.4390 37147.4591   109%     -  212s
H    0     0                    17799.148176 37104.0995   108%     -  215s
H    0     0                    18313.631625 37104.0995   103%     -  215s
     0     0 37104.0995    0  458 18313.6316 37104.0995   103%     -  215s
     0     0 37095.5956    0  457 18313.6316 37095.5956   103%     -  217s
     0     0 37076.9728    0  464 18313.6316 37076.9728   102%     -  218s
     0     0 37044.6015    0  461 18313.6316 37044.6015   102%     -  220s
H    0     0                    18416.657223 37039.1940   101%     -  222s
     0     0 37039.1940    0  465 18416.6572 37039.1940   101%     -  222s
     0     0 37037.7543    0  467 18416.6572 37037.7543   101%     -  222s
H    0     0                    18418.366537 37037.7543   101%     -  229s
H    0     0                    19115.885686 36615.2063  91.5%     -  242s
H    0     0                    19392.276877 36615.2063  88.8%     -  242s
     0     0 36615.2063    0  482 19392.2769 36615.2063  88.8%     -  242s
H    0     0                    19393.716583 36372.3456  87.5%     -  250s
     0     0 36372.3456    0  471 19393.7166 36372.3456  87.5%     -  250s
     0     0 36298.4882    0  480 19393.7166 36298.4882  87.2%     -  255s
     0     0 36259.4455    0  516 19393.7166 36259.4455  87.0%     -  259s
     0     0 36240.4817    0  518 19393.7166 36240.4817  86.9%     -  262s
     0     0 36233.5556    0  492 19393.7166 36233.5556  86.8%     -  263s
     0     0 36231.5953    0  495 19393.7166 36231.5953  86.8%     -  264s
     0     0 36062.7746    0  464 19393.7166 36062.7746  86.0%     -  271s
     0     0 36009.3393    0  492 19393.7166 36009.3393  85.7%     -  276s
     0     0 35992.8144    0  490 19393.7166 35992.8144  85.6%     -  278s
     0     0 35985.0704    0  501 19393.7166 35985.0704  85.6%     -  280s
     0     0 35974.6030    0  504 19393.7166 35974.6030  85.5%     -  281s
     0     0 35972.6175    0  499 19393.7166 35972.6175  85.5%     -  282s
     0     0 35875.5929    0  488 19393.7166 35875.5929  85.0%     -  288s
H    0     0                    19980.636698 35875.5667  79.6%     -  290s
H    0     0                    20102.502022 35875.5667  78.5%     -  290s
     0     0 35863.4322    0  489 20102.5020 35863.4322  78.4%     -  294s
     0     0 35860.7941    0  491 20102.5020 35860.7941  78.4%     -  294s
     0     0 35859.5140    0  491 20102.5020 35859.5140  78.4%     -  295s
     0     0 35839.2927    0  536 20102.5020 35839.2927  78.3%     -  300s
     0     0 35814.5826    0  534 20102.5020 35814.5826  78.2%     -  305s
     0     0 35802.2914    0  533 20102.5020 35802.2914  78.1%     -  307s
     0     0 35792.6732    0  541 20102.5020 35792.6732  78.1%     -  309s
     0     0 35789.5663    0  533 20102.5020 35789.5663  78.0%     -  310s
     0     0 35788.0648    0  537 20102.5020 35788.0648  78.0%     -  311s
     0     0 35766.2147    0  529 20102.5020 35766.2147  77.9%     -  315s
H    0     0                    20151.493748 35766.0809  77.5%     -  316s
     0     0 35761.6658    0  528 20151.4937 35761.6658  77.5%     -  317s
     0     0 35760.8326    0  488 20151.4937 35760.8326  77.5%     -  318s
     0     0 35752.5268    0  479 20151.4937 35752.5268  77.4%     -  320s
     0     0 35748.5563    0  490 20151.4937 35748.5563  77.4%     -  322s
     0     0 35745.6481    0  487 20151.4937 35745.6481  77.4%     -  323s
     0     0 35743.8097    0  523 20151.4937 35743.8097  77.4%     -  324s
     0     0 35731.8216    0  538 20151.4937 35731.8216  77.3%     -  327s
     0     0 35731.6749    0  538 20151.4937 35731.6749  77.3%     -  329s
H    0     0                    20785.616733 35731.3245  71.9%     -  352s
H    0     0                    20845.516731 35731.3245  71.4%     -  352s
H    0     0                    21073.052752 35731.3245  69.6%     -  352s
H    0     0                    21075.517019 35731.3245  69.5%     -  352s
H    0     0                    21219.445863 35731.3245  68.4%     -  352s
H    0     0                    21275.392279 35731.3245  67.9%     -  386s
H    0     0                    21463.374599 35731.3245  66.5%     -  386s
H    0     0                    21467.296292 35731.3245  66.4%     -  389s
H    0     0                    21519.977016 35731.3245  66.0%     -  389s
     0     2 35731.3245    0  538 21519.9770 35731.3245  66.0%     -  391s
     1     3 35041.6712    1  461 21519.9770 35731.3245  66.0%  8815  400s
     2     4 35312.7481    1  526 21519.9770 35312.7481  64.1% 10436  411s
     3     6 33971.7587    2  455 21519.9770 35312.6398  64.1%  9217  421s
     5    11 33514.2817    3  467 21519.9770 35312.6398  64.1%  8012  434s
    10    21 32662.2775    4  456 21519.9770 34890.0085  62.1%  8671  452s
    20    31 33214.8906    5  449 21519.9770 34889.9477  62.1% 12335  478s
    30    62 31676.6300    4  413 21519.9770 34620.8413  60.9% 11619  514s
H   44    62                    21618.041199 34620.6956  60.1%  9786  514s
    61    94 31505.3360    5  399 21618.0412 34424.5876  59.2% 11660  536s
    93   158 31306.1224    6  411 21618.0412 34373.3176  59.0% 10978  568s
H   94   158                    21621.962892 34373.3176  59.0% 10861  568s
H  114   158                    21705.726307 34373.3176  58.4%  9296  568s
H  121   158                    21709.648001 34373.3095  58.3%  8920  568s
   157   232 31295.6284    7  402 21709.6480 34373.3095  58.3%  7735  586s
   246   265 30851.3300    9  387 21709.6480 34373.3095  58.3%  6062  599s
   313   300 30519.2173   10  379 21709.6480 34310.9694  58.0%  5320  614s
   368   327 27999.2951   21  386 21709.6480 34310.9694  58.0%  5101  629s
   397   364 27819.3499   22  410 21709.6480 34310.9694  58.0%  5056  644s
   446   378 27348.4672   23  397 21709.6480 34310.9694  58.0%  4890  657s
   475   413 23698.6513   13  396 21709.6480 34310.9694  58.0%  4925  672s
   530   438 23684.7331   14  332 21709.6480 34310.9694  58.0%  4823  688s
   583   478 22146.2628   16  274 21709.6480 34310.9694  58.0%  4708  703s
   653   527 21841.5004   17  259 21709.6480 34310.9694  58.0%  4569  715s
   736   571 25796.1610   15  413 21709.6480 34310.9694  58.0%  4287  726s
   824   611 25746.8669   16  416 21709.6480 34310.9694  58.0%  4088  740s
   916   638 25449.7044   21  306 21709.6480 33749.4446  55.5%  3917  754s
  1007   649 24826.2169   23  244 21709.6480 33749.4446  55.5%  3782  768s
  1048   662 24800.1285   24  239 21709.6480 33749.4446  55.5%  3751  782s
  1085   681 24738.5398   25  243 21709.6480 33749.4446  55.5%  3744  796s
  1128   705 24735.8850   26  234 21709.6480 33749.4446  55.5%  3716  810s
  1168   732 24664.1204   27  233 21709.6480 33749.4446  55.5%  3738  822s
  1205   751 24553.6602   28  259 21709.6480 33749.4446  55.5%  3735  836s
  1252   779 24484.9483   29  231 21709.6480 33749.4446  55.5%  3687  850s
  1296   811 24039.2111   31  219 21709.6480 33749.4446  55.5%  3645  864s
  1358   862 23448.5439   38  175 21709.6480 33749.4446  55.5%  3589  879s
  1435   912 22895.7782   47  154 21709.6480 33283.7893  53.3%  3532  894s
  1547   956 22393.2786   55  107 21709.6480 33283.7893  53.3%  3398  910s
  1671   982 28895.6277    9  282 21709.6480 33283.7893  53.3%  3290  929s
  1767  1019 27433.0339   10  329 21709.6480 33250.0906  53.2%  3271  949s
  1889  1097 26466.4804   11  365 21709.6480 33250.0906  53.2%  3212  970s
  2005  1169 25758.1351   12  354 21709.6480 33250.0906  53.2%  3210  991s
  2159  1249 24920.7778   14  337 21709.6480 33250.0906  53.2%  3151 1012s
  2350  1323 23734.9213   16  240 21709.6480 33032.1729  52.2%  3057 1035s
  2565  1389     cutoff   19      21709.6480 33032.1729  52.2%  2974 1059s
  2745  1456 32017.9876   11  414 21709.6480 32839.4395  51.3%  2931 1083s
  2865  1511 25328.2398   12  410 21709.6480 32838.9843  51.3%  2954 1108s
  3009  1603 21762.9874   14  302 21709.6480 32838.9843  51.3%  2971 1132s
  3195  1712 23884.9461   15  336 21709.6480 32838.9843  51.3%  2952 1157s
  3440  1803 22921.6113   18  255 21709.6480 32838.9843  51.3%  2882 1184s
  3665  1859     cutoff   20      21709.6480 32714.1935  50.7%  2850 1212s
  3839  2001 21799.2247   12   65 21709.6480 32714.1935  50.7%  2867 1246s
  4065  2096 29167.6087    9  417 21709.6480 32465.1686  49.5%  2846 1276s
  4286  2184 28347.4313   13  368 21709.6480 32440.1344  49.4%  2838 1307s
  4460  2334 26442.3237   18  311 21709.6480 32117.3321  47.9%  2869 1340s
  4728  2335 31998.1380    7  538 21709.6480 32066.0534  47.7%  2845 1425s
  4730  2336 25921.8643   15  311 21709.6480 32066.0534  47.7%  2844 1480s
  4731  2337 25788.4672   12  395 21709.6480 32066.0534  47.7%  2843 1507s
  4732  2338 22047.8075   37  494 21709.6480 32066.0534  47.7%  2843 1540s
  4733  2338 25566.2801   19  450 21709.6480 32066.0534  47.7%  2842 1554s
  4734  2339 24480.2765   18  445 21709.6480 32066.0534  47.7%  2842 1569s
  4735  2340 28497.9430   12  534 21709.6480 32066.0534  47.7%  2841 1578s
  4736  2340 26848.9263   15  468 21709.6480 32066.0534  47.7%  2840 1584s
  4737  2341 23861.8720   35  470 21709.6480 32066.0534  47.7%  2840 1590s
  4738  2342 22888.4524   44  465 21709.6480 32066.0534  47.7%  2839 1596s
  4739  2342 27280.8268   13  474 21709.6480 32066.0534  47.7%  2839 1603s
  4740  2343 23957.1731   20  467 21709.6480 32066.0534  47.7%  2838 1607s
  4741  2344 27069.7514   12  482 21709.6480 32066.0534  47.7%  2837 1611s
  4742  2344 25823.4891   18  528 21709.6480 32066.0534  47.7%  2837 1622s
  4743  2345 28377.4406   13  526 21709.6480 32066.0534  47.7%  2836 1628s
  4744  2346 22628.1359   37  487 21709.6480 32066.0534  47.7%  2836 1632s
  4745  2346 25748.5550   17  536 21709.6480 32066.0534  47.7%  2835 1637s
  4746  2347 27899.5109   11  525 21709.6480 32066.0534  47.7%  2834 1645s
  4747  2348 23051.1973   31  540 21709.6480 32066.0534  47.7%  2834 1650s
  4748  2348 23761.2674   21  546 21709.6480 32066.0534  47.7%  2833 1661s
  4750  2350 25894.5047   14  543 21709.6480 32066.0534  47.7%  2832 1668s
  4751  2350 24046.4876   32  562 21709.6480 32066.0534  47.7%  2831 1675s
  4752  2351 25758.7776   15  557 21709.6480 32066.0534  47.7%  2831 1680s
  4753  2352 26573.0326   12  581 21709.6480 32066.0534  47.7%  2830 1689s
  4754  2352 23280.3042   31  418 21709.6480 32066.0534  47.7%  2830 1693s
  4755  2353 23453.7293   18  499 21709.6480 32066.0534  47.7%  2829 1698s
  4756  2354 24531.4180   21  487 21709.6480 32066.0534  47.7%  2828 1702s
  4757  2354 28264.2207    9  489 21709.6480 32066.0534  47.7%  2828 1708s
  4758  2355 28681.4855   13  489 21709.6480 32066.0534  47.7%  2827 1754s
  4759  2356 23412.7695   42  489 21709.6480 32066.0534  47.7%  2827 1799s
  4760  2359 32066.0534   13  502 21709.6480 32066.0534  47.7%  2883 1844s
  4762  2363 32066.0534   14  449 21709.6480 32066.0534  47.7%  2883 1877s
  4766  2369 32066.0534   15  467 21709.6480 32066.0534  47.7%  2888 1909s
  4774  2383 32066.0534   16  469 21709.6480 32066.0534  47.7%  2901 1943s
  4790  2393 32066.0534   17  464 21709.6480 32066.0534  47.7%  2955 2001s
  4806  2418 32066.0534   18  453 21709.6480 32066.0534  47.7%  2998 2048s
  4838  2438 30368.3400   19  413 21709.6480 32066.0534  47.7%  3019 2084s
  4871  2467 29823.9156   20  423 21709.6480 32066.0534  47.7%  3072 2116s
  4949  2480 29265.5829   23  367 21709.6480 32066.0534  47.7%  3110 2147s
  5023  2490 26630.4096   24  418 21709.6480 32066.0534  47.7%  3173 2172s
  5086  2497 24711.2291   23  338 21709.6480 32066.0534  47.7%  3242 2196s
  5171  2467 22410.5039   24  370 21709.6480 32066.0534  47.7%  3289 2224s
  5254  2435     cutoff   24      21709.6480 32066.0534  47.7%  3335 2243s
  5325  2431 22422.9194   24  330 21709.6480 32066.0534  47.7%  3354 2266s
  5398  2427     cutoff   23      21709.6480 32066.0534  47.7%  3379 2284s
  5463  2415 21911.8822   27  296 21709.6480 32066.0534  47.7%  3427 2304s
  5495  2418 21833.3078   28  278 21709.6480 32066.0534  47.7%  3444 2320s
  5540  2414     cutoff   29      21709.6480 32066.0534  47.7%  3480 2341s
  5578  2413 25762.5061   21  486 21709.6480 32066.0534  47.7%  3500 2360s
  5624  2412 23929.5505   22  459 21709.6480 32066.0534  47.7%  3515 2377s
  5673  2417 23792.7209   23  399 21709.6480 32066.0534  47.7%  3523 2394s
  5726  2412 23311.3953   24  392 21709.6480 32066.0534  47.7%  3529 2412s
  5789  2416 23048.7045   25  343 21709.6480 32066.0534  47.7%  3550 2440s
  5862  2422 22898.8719   26  347 21709.6480 32066.0534  47.7%  3562 2460s
  5949  2418 22740.8250   27  336 21709.6480 32066.0534  47.7%  3579 2479s
  6037  2401 23416.7558   27  383 21709.6480 32066.0534  47.7%  3598 2500s
  6123  2399 22814.7925   29  352 21709.6480 32066.0534  47.7%  3614 2522s
  6199  2410 22239.2799   31  323 21709.6480 32066.0534  47.7%  3649 2550s
  6298  2414 23969.8731   22  311 21709.6480 32066.0534  47.7%  3689 2572s
  6406  2418     cutoff   25      21709.6480 31745.6704  46.2%  3733 2597s
  6518  2424 23688.2924   25  275 21709.6480 31745.6704  46.2%  3774 2621s
  6643  2435 22129.1756   25  243 21709.6480 31745.6704  46.2%  3809 2646s
  6775  2441 27053.1412   20  410 21709.6480 31745.6704  46.2%  3839 2672s
  6946  2429 26758.8793   23  420 21709.6480 31745.6704  46.2%  3863 2698s
  7088  2431 25388.2987   27  299 21709.6480 31745.6704  46.2%  3894 2728s
  7248  2405 21916.0210   31  293 21709.6480 31745.6704  46.2%  3930 2757s
  7409  2375     cutoff   21      21709.6480 30352.8147  39.8%  3973 2792s
  7578  2356 24554.9872   20  486 21709.6480 29490.3496  35.8%  4010 2824s
  7758  2364 23461.0900   23  446 21709.6480 29350.8235  35.2%  4066 2858s
  7947  2369 22718.1973   26  363 21709.6480 29073.7300  33.9%  4120 2894s
  8137  2352     cutoff   30      21709.6480 29019.9133  33.7%  4155 2935s
  8339  2371 26646.2671   23  309 21709.6480 28752.6655  32.4%  4205 2974s
  8537  2388 24168.0736   24  276 21709.6480 28542.7742  31.5%  4253 3010s
  8762  2383 22815.0609   30  218 21709.6480 28542.7742  31.5%  4295 3052s
* 8983  2191              37    22188.984913 28489.5842  28.4%  4314 3052s
  9046  2233 24686.9314   22  385 22188.9849 28489.5842  28.4%  4321 3095s
  9285  2225 23671.9665   22  407 22188.9849 28366.2730  27.8%  4364 3145s
  9558  2215 27300.2347   24  381 22188.9849 28276.6415  27.4%  4383 3190s
  9832  2166 24788.5509   29  435 22188.9849 27939.6959  25.9%  4423 3234s
 10084  2107 23699.7539   27  411 22188.9849 27688.9152  24.8%  4465 3274s
H10091  1992                    22234.184017 27688.9152  24.5%  4467 3274s
H10106  1880                    22570.907833 27688.9152  22.7%  4464 3274s
 10260  1864     cutoff   28      22570.9078 27514.8344  21.9%  4479 3319s
 10587  1767 22953.9747   26  288 22570.9078 27514.8344  21.9%  4528 3367s
 10922  1714 23496.3822   26  435 22570.9078 27514.8344  21.9%  4567 3423s
 11244  1714 23483.4865   31  157 22570.9078 27012.5465  19.7%  4617 3478s
 11612  1685     cutoff   25      22570.9078 26881.6828  19.1%  4651 3531s
 12009  1670 23803.3735   29  437 22570.9078 26881.6828  19.1%  4693 3589s
 12391  1645 23691.5430   27  218 22570.9078 26446.0412  17.2%  4738 3600s

Cutting planes:
  Learned: 1
  Gomory: 1
  Projected implied bound: 97
  MIR: 1402
  Mixing: 2
  Flow cover: 2540
  RLT: 65
  Relax-and-lift: 274

Explored 12486 nodes (59372951 simplex iterations) in 3600.04 seconds (10279.45 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 22570.9 22234.2 22189 ... 21463.4

Time limit reached
Best objective 2.257090783259e+04, best bound 2.644604116536e+04, gap 17.1687%
  WARNING: Time limit reached. Using best solution found (gap: 17.17%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.05s
  Master Objective (UB) = 22570.91, θ = 165043.17
  Upper Bound (UB) = 22570.91

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 165043.17
  [DEBUG]   ✓ Scenario 0: θ = 165043.17 ≤ Q = 165043.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 165043.17 ≤ Q = 165043.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 165043.17 ≤ Q = 165043.17 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 165043.17 ≤ Q = 165043.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 165043.17 ≤ Q = 165043.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 165043.17 ≤ Q = 165043.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 165043.17 ≤ Q = 165043.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 165043.17 ≤ Q = 165043.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 165043.17 ≤ Q = 165043.17 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x7ad0180d
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x7ad0180d
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [3e-01, 2e+02]
Found heuristic solution: objective 1.338924e+13
Presolve removed 2587 rows and 1877 columns
Presolve time: 0.00s
Presolved: 506 rows, 512 columns, 1429 nonzeros
Found heuristic solution: objective 6503771.5711
Variable types: 346 continuous, 166 integer (166 binary)
Found heuristic solution: objective 6503462.9820

Root relaxation: objective -1.601657e+05, 253 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -160165.74    0  124 6503462.98 -160165.74   102%     -    0s
H    0     0                    -126766.8836 -160165.74  26.3%     -    0s
H    0     0                    -129478.0280 -160165.74  23.7%     -    0s
H    0     0                    -141945.1092 -160165.74  12.8%     -    0s
H    0     0                    -144201.4839 -146244.30  1.42%     -    0s
     0     0 -146244.30    0   64 -144201.48 -146244.30  1.42%     -    0s
     0     0 -145821.92    0   60 -144201.48 -145821.92  1.12%     -    0s
     0     0 -145813.47    0   59 -144201.48 -145813.47  1.12%     -    0s
     0     0 -145284.76    0   18 -144201.48 -145284.76  0.75%     -    0s
H    0     0                    -145008.8220 -145284.76  0.19%     -    0s
     0     0 -145207.07    0   29 -145008.82 -145207.07  0.14%     -    0s
     0     0 -145182.71    0   19 -145008.82 -145182.71  0.12%     -    0s
     0     0 -145173.97    0   20 -145008.82 -145173.97  0.11%     -    0s
     0     0 -145117.62    0    9 -145008.82 -145117.62  0.08%     -    0s
     0     0 -145117.62    0   15 -145008.82 -145117.62  0.08%     -    0s
H    0     0                    -145010.7362 -145117.62  0.07%     -    0s
H    0     0                    -145064.4550 -145117.62  0.04%     -    0s
H    0     0                    -145066.3692 -145117.62  0.04%     -    0s
     0     0 -145091.98    0    7 -145066.37 -145091.98  0.02%     -    0s
     0     0 -145085.96    0    6 -145066.37 -145085.96  0.01%     -    0s
H    0     0                    -145067.6770 -145085.96  0.01%     -    0s
     0     0 -145085.96    0    7 -145067.68 -145085.96  0.01%     -    0s
     0     0          -    0      -145067.68 -145081.39  0.01%     -    0s

Cutting planes:
  Gomory: 9
  Implied bound: 3
  MIR: 3
  Flow cover: 7
  Relax-and-lift: 3

Explored 1 nodes (678 simplex iterations) in 0.06 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -145068 -145066 -145064 ... -126767

Optimal solution found (tolerance 1.00e-04)
Best objective -1.450676769730e+05, best bound -1.450813919177e+05, gap 0.0095%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 144766.64
  Scenario: 28 demand increases, 32 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -145067.68
  [DEBUG]   S×d_nominal = 289834.31
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 289834.31 + -145067.68 = 144766.64
  [DEBUG]   Current θ from Master = 165043.17
  [DEBUG]   ⚠️  Z_SP ≤ θ by 20276.53 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 2294.38
  Lower Bound (LB) = 19044.82
  Gap (UB-LB) = 3526.0890, Absolute Gap = 3526.0890, Relative Gap = 0.156223
  Not converged yet (gap = 3526.09 > ε = 200)

  [DEBUG] Adding NEW scenario 9 to Master Problem...
  [DEBUG] New scenario pattern: 28 increases, 32 decreases
    [DEBUG] Scenario 9 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 9 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 9]
    [DEBUG]   - Total constraints in model: 154283
    [DEBUG]   - Total variables in model: 64660
  [DEBUG] Total scenarios in Master: 10
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 10
================================================================================
[Iteration 10] Solving Master Problem...
  Current scenarios in Master: 10
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 154283 rows, 64660 columns and 437949 nonzeros
Model fingerprint: 0x7917c4d4
Variable types: 62401 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 66720 rows and 27090 columns
Presolve time: 1.22s
Presolved: 87563 rows, 37570 columns, 533159 nonzeros
Variable types: 35311 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -328721.9788
Found heuristic solution: objective -184683.4741

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.17s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.758e+06
 Factor NZ  : 8.148e+06 (roughly 120 MB of memory)
 Factor Ops : 1.400e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.77485559e+07  1.57192255e+08  1.05e+05 2.10e+01  7.56e+04     2s
   1  -1.33093611e+07  1.40573709e+08  7.29e+04 7.31e+01  5.20e+04     2s
   2  -4.17185106e+06  1.04194481e+08  2.29e+04 1.09e-11  1.74e+04     2s
   3  -8.27906156e+05  7.46146411e+07  2.27e+03 1.37e+00  2.08e+03     2s
   4  -4.57207847e+05  3.43743614e+07  4.70e+02 2.95e-01  5.15e+02     2s
   5  -3.63453332e+05  2.18261736e+07  2.33e+02 1.60e-01  2.73e+02     2s
   6  -2.53686385e+05  1.64319679e+07  7.72e+01 1.13e-01  1.45e+02     3s
   7  -1.97028386e+05  1.26192503e+07  4.01e+01 8.20e-02  9.87e+01     3s
   8  -1.13555762e+05  1.07738704e+07  1.26e+01 6.83e-02  7.31e+01     3s
   9  -9.01079437e+04  5.94410385e+06  8.65e+00 3.59e-02  3.99e+01     3s
  10  -6.63570011e+04  3.35179263e+06  4.02e+00 1.95e-02  2.19e+01     3s
  11  -2.24747226e+04  5.77744277e+05  8.00e-01 2.64e-03  3.77e+00     3s
  12  -2.26330189e+03  3.49654305e+05  5.27e-01 1.52e-03  2.20e+00     3s
  13   1.45028645e+03  2.39850558e+05  4.38e-01 1.05e-03  1.49e+00     3s
  14   6.08656496e+03  1.94547800e+05  3.73e-01 8.75e-04  1.18e+00     3s
  15   1.31869983e+04  1.48984299e+05  2.82e-01 7.49e-04  8.48e-01     3s
  16   1.97513829e+04  1.14542919e+05  2.23e-01 8.82e-04  5.92e-01     3s
  17   2.34891187e+04  9.58936176e+04  1.92e-01 1.06e-03  4.52e-01     3s
  18   2.78676245e+04  8.67029910e+04  1.60e-01 1.75e-03  3.67e-01     3s
  19   3.38549709e+04  7.72328679e+04  1.16e-01 1.73e-03  2.71e-01     3s
  20   3.79488668e+04  6.92959542e+04  8.97e-02 1.88e-03  1.96e-01     3s
  21   4.00793711e+04  6.48432544e+04  7.64e-02 2.23e-03  1.55e-01     3s
  22   4.25615527e+04  6.12454147e+04  6.10e-02 2.19e-03  1.17e-01     3s
  23   4.35188006e+04  5.91853915e+04  5.50e-02 1.69e-03  9.78e-02     3s
  24   4.39323590e+04  5.84199676e+04  5.24e-02 1.65e-03  9.04e-02     3s
  25   4.54279153e+04  5.73612436e+04  4.35e-02 1.36e-03  7.45e-02     3s
  26   4.61877998e+04  5.63593673e+04  3.89e-02 1.07e-03  6.35e-02     3s
  27   4.66953803e+04  5.59660113e+04  3.58e-02 9.59e-04  5.79e-02     3s
  28   4.71912373e+04  5.54924651e+04  3.30e-02 7.19e-04  5.18e-02     3s
  29   4.74910287e+04  5.51498054e+04  3.12e-02 6.24e-04  4.78e-02     3s
  30   4.88621703e+04  5.45200878e+04  2.31e-02 7.24e-04  3.53e-02     3s
  31   4.95763881e+04  5.43090115e+04  1.90e-02 6.94e-04  2.95e-02     3s
  32   5.02072921e+04  5.41171945e+04  1.53e-02 6.07e-04  2.44e-02     3s
  33   5.06912158e+04  5.38527484e+04  1.25e-02 4.91e-04  1.97e-02     3s
  34   5.09671009e+04  5.36037826e+04  1.08e-02 3.66e-04  1.65e-02     3s
  35   5.14306142e+04  5.34846246e+04  8.11e-03 3.07e-04  1.28e-02     3s
  36   5.19080640e+04  5.33426043e+04  5.39e-03 2.42e-04  8.95e-03     4s
  37   5.19946999e+04  5.31770928e+04  4.91e-03 1.94e-04  7.38e-03     4s
  38   5.20512404e+04  5.31015511e+04  4.54e-03 2.69e-04  6.56e-03     4s
  39   5.22656552e+04  5.30840985e+04  3.42e-03 2.46e-04  5.11e-03     4s
  40   5.23991773e+04  5.30587767e+04  2.68e-03 2.16e-04  4.12e-03     4s
  41   5.24546378e+04  5.30437184e+04  2.37e-03 1.97e-04  3.68e-03     4s
  42   5.24753242e+04  5.30229797e+04  2.26e-03 1.69e-04  3.42e-03     4s
  43   5.25823022e+04  5.29877942e+04  1.67e-03 1.19e-04  2.53e-03     4s
  44   5.26422058e+04  5.29783861e+04  1.33e-03 1.05e-04  2.10e-03     4s
  45   5.27085076e+04  5.29512610e+04  9.73e-04 6.62e-05  1.52e-03     4s
  46   5.27643910e+04  5.29339658e+04  6.80e-04 4.52e-05  1.06e-03     4s
  47   5.27830535e+04  5.29301164e+04  5.79e-04 4.07e-05  9.18e-04     4s
  48   5.28155879e+04  5.29211490e+04  4.06e-04 3.10e-05  6.59e-04     4s
  49   5.28455266e+04  5.29133210e+04  2.41e-04 2.14e-05  4.23e-04     4s
  50   5.28718077e+04  5.29013266e+04  1.09e-04 7.20e-06  1.84e-04     4s
  51   5.28767050e+04  5.28969690e+04  8.51e-05 2.43e-06  1.27e-04     4s
  52   5.28862858e+04  5.28959443e+04  3.89e-05 1.33e-06  6.03e-05     4s
  53   5.28908755e+04  5.28955229e+04  1.66e-05 8.97e-07  2.90e-05     4s
  54   5.28927076e+04  5.28952102e+04  8.45e-06 5.69e-07  1.56e-05     4s
  55   5.28945788e+04  5.28950072e+04  2.68e-07 3.60e-07  2.67e-06     4s
  56   5.28946080e+04  5.28946882e+04  1.72e-07 2.01e-08  4.99e-07     4s
  57   5.28946546e+04  5.28946618e+04  2.79e-08 9.60e-10  4.46e-08     4s
  58   5.28946587e+04  5.28946605e+04  8.16e-07 7.29e-09  1.12e-08     4s
  59   5.28946593e+04  5.28946605e+04  2.74e-06 1.40e-07  7.89e-09     4s
  60   5.28946604e+04  5.28946605e+04  3.23e-07 1.32e-08  9.30e-10     5s

Barrier solved model in 60 iterations and 4.52 seconds (8.80 work units)
Optimal objective 5.28946604e+04


Root crossover log...

       0 DPushes remaining with DInf 0.0000000e+00                 8s

    7742 PPushes remaining with PInf 3.9661908e-05                 8s
       0 PPushes remaining with PInf 0.0000000e+00                 8s

  Push phase complete: Pinf 0.0000000e+00, Dinf 8.9277918e+03      8s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   38864    5.2894661e+04   0.000000e+00   8.927792e+03      8s
   39024    5.2894661e+04   0.000000e+00   0.000000e+00      8s
   39024    5.2894661e+04   0.000000e+00   0.000000e+00      8s
Concurrent spin time: 2.01s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 5.289466e+04, 39024 iterations, 8.76 seconds (18.13 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 52894.6605    0  453 -184683.47 52894.6605   129%     -   10s
H    0     0                    -171019.4697 52894.6605   131%     -   10s
H    0     0                    -49163.80908 52894.6605   208%     -   11s
H    0     0                    -6441.780356 52894.6605   921%     -   11s
H    0     0                    -4191.808044 52894.6605  1362%     -   11s
H    0     0                    -2810.849680 52894.6605  1982%     -   12s
H    0     0                    -2710.259052 52894.6605  2052%     -   12s
H    0     0                    -2536.235808 52894.6605  2186%     -   12s
H    0     0                    1221.4865344 46511.6267  3708%     -   51s
H    0     0                    1664.2496851 46511.6267  2695%     -   51s
H    0     0                    1703.2713176 46511.6267  2631%     -   51s
H    0     0                    1837.7783094 46511.6267  2431%     -   51s
H    0     0                    1844.5859252 46511.6267  2422%     -   51s
     0     0 46511.6267    0  455 1844.58593 46511.6267  2422%     -   51s
     0     0 45818.1469    0  463 1844.58593 45818.1469  2384%     -   71s
     0     0 45453.0940    0  470 1844.58593 45453.0940  2364%     -   81s
     0     0 45373.4532    0  441 1844.58593 45373.4532  2360%     -   89s
     0     0 45130.1830    0  463 1844.58593 45130.1830  2347%     -  101s
     0     0 45130.1529    0  462 1844.58593 45130.1529  2347%     -  106s
     0     0 45130.1529    0  464 1844.58593 45130.1529  2347%     -  107s
     0     0 45130.1529    0  455 1844.58593 45130.1529  2347%     -  117s
     0     0 45124.2539    0  471 1844.58593 45124.2539  2346%     -  120s
     0     0 45116.3811    0  469 1844.58593 45116.3811  2346%     -  122s
     0     0 45115.0826    0  471 1844.58593 45115.0826  2346%     -  122s
     0     0 45114.9263    0  470 1844.58593 45114.9263  2346%     -  123s
H    0     0                    5794.4645925 41596.6947   618%     -  166s
H    0     0                    5858.3969673 41596.6947   610%     -  166s
H    0     0                    5895.8329901 41596.6947   606%     -  166s
H    0     0                    5908.2314907 41596.6947   604%     -  166s
H    0     0                    6029.3017885 41596.6947   590%     -  166s
H    0     0                    6070.8480573 41596.6947   585%     -  166s
     0     0 41596.6947    0  486 6070.84806 41596.6947   585%     -  166s
H    0     0                    6626.4685482 41594.3199   528%     -  167s
H    0     0                    6752.0249204 41594.3199   516%     -  167s
H    0     0                    7304.5375781 41594.3199   469%     -  167s
H    0     0                    7339.2141434 41594.3199   467%     -  167s
H    0     0                    7384.4095349 41594.3199   463%     -  167s
H    0     0                    7426.4799565 41594.3199   460%     -  167s
     0     0 40691.3741    0  455 7426.47996 40691.3741   448%     -  189s
     0     0 40407.8060    0  489 7426.47996 40407.8060   444%     -  200s
     0     0 40336.1689    0  499 7426.47996 40336.1689   443%     -  207s
     0     0 40261.6388    0  506 7426.47996 40261.6388   442%     -  218s
     0     0 40233.4358    0  503 7426.47996 40233.4358   442%     -  223s
     0     0 40219.9476    0  481 7426.47996 40219.9476   442%     -  228s
     0     0 40158.6604    0  481 7426.47996 40158.6604   441%     -  237s
     0     0 40101.0372    0  489 7426.47996 40101.0372   440%     -  244s
     0     0 40074.7883    0  487 7426.47996 40074.7883   440%     -  251s
     0     0 40039.2486    0  488 7426.47996 40039.2486   439%     -  256s
     0     0 40032.2533    0  492 7426.47996 40032.2533   439%     -  259s
     0     0 40025.6285    0  490 7426.47996 40025.6285   439%     -  260s
     0     0 40025.5743    0  488 7426.47996 40025.5743   439%     -  260s
H    0     0                    7593.9160185 38404.9168   406%     -  312s
H    0     0                    10557.519073 38404.9168   264%     -  312s
H    0     0                    10700.663406 38404.9168   259%     -  312s
     0     0 38404.9168    0  485 10700.6634 38404.9168   259%     -  312s
H    0     0                    10785.690988 38404.9065   256%     -  312s
     0     0 37939.0034    0  487 10785.6910 37939.0034   252%     -  333s
     0     0 37722.5781    0  486 10785.6910 37722.5781   250%     -  346s
H    0     0                    10974.389632 37652.1216   243%     -  355s
H    0     0                    11104.939956 37652.1216   239%     -  355s
H    0     0                    11108.597796 37652.1216   239%     -  355s
H    0     0                    11760.788689 37652.1216   220%     -  355s
     0     0 37652.1216    0  453 11760.7887 37652.1216   220%     -  355s
     0     0 37582.8508    0  452 11760.7887 37582.8508   220%     -  363s
     0     0 37541.4234    0  485 11760.7887 37541.4234   219%     -  368s
     0     0 37531.5148    0  456 11760.7887 37531.5148   219%     -  371s
H    0     0                    11868.878480 37501.2399   216%     -  377s
H    0     0                    11880.691360 37501.2399   216%     -  377s
     0     0 37501.2399    0  462 11880.6914 37501.2399   216%     -  377s
     0     0 37498.7016    0  472 11880.6914 37498.7016   216%     -  379s
     0     0 37495.8060    0  469 11880.6914 37495.8060   216%     -  381s
     0     0 37488.0321    0  464 11880.6914 37488.0321   216%     -  383s
     0     0 37484.7244    0  457 11880.6914 37484.7244   216%     -  386s
     0     0 37484.0103    0  461 11880.6914 37484.0103   216%     -  386s
     0     0 36640.7092    0  468 11880.6914 36640.7092   208%     -  419s
     0     0 36524.3261    0  538 11880.6914 36524.3261   207%     -  430s
     0     0 36477.2777    0  584 11880.6914 36477.2777   207%     -  437s
     0     0 36465.9717    0  587 11880.6914 36465.9717   207%     -  441s
     0     0 36442.0188    0  495 11880.6914 36442.0188   207%     -  446s
     0     0 36430.8323    0  576 11880.6914 36430.8323   207%     -  450s
     0     0 36428.2239    0  550 11880.6914 36428.2239   207%     -  453s
     0     0 36228.2220    0  463 11880.6914 36228.2220   205%     -  469s
H    0     0                    12195.226614 36227.9921   197%     -  469s
     0     0 36177.1050    0  493 12195.2266 36177.1050   197%     -  479s
     0     0 36141.7960    0  509 12195.2266 36141.7960   196%     -  486s
     0     0 36136.9455    0  515 12195.2266 36136.9455   196%     -  488s
     0     0 36134.1741    0  505 12195.2266 36134.1741   196%     -  490s
     0     0 36003.1794    0  488 12195.2266 36003.1794   195%     -  501s
     0     0 35961.4937    0  481 12195.2266 35961.4937   195%     -  511s
     0     0 35946.3827    0  531 12195.2266 35946.3827   195%     -  516s
     0     0 35935.4521    0  533 12195.2266 35935.4521   195%     -  520s
     0     0 35932.3277    0  542 12195.2266 35932.3277   195%     -  522s
     0     0 35929.6736    0  490 12195.2266 35929.6736   195%     -  523s
     0     0 35873.2055    0  512 12195.2266 35873.2055   194%     -  532s
     0     0 35852.7122    0  502 12195.2266 35852.7122   194%     -  536s
     0     0 35848.5183    0  497 12195.2266 35848.5183   194%     -  539s
     0     0 35847.7893    0  504 12195.2266 35847.7893   194%     -  540s
     0     0 35812.4605    0  553 12195.2266 35812.4605   194%     -  550s
     0     0 35806.6799    0  557 12195.2266 35806.6799   194%     -  553s
     0     0 35805.5473    0  562 12195.2266 35805.5473   194%     -  554s
     0     0 35788.9445    0  502 12195.2266 35788.9445   193%     -  560s
     0     0 35782.5032    0  578 12195.2266 35782.5032   193%     -  564s
     0     0 35780.5402    0  536 12195.2266 35780.5402   193%     -  565s
     0     0 35766.4882    0  570 12195.2266 35766.4882   193%     -  570s
     0     0 35766.4029    0  570 12195.2266 35766.4029   193%     -  573s
H    0     0                    16564.499376 35766.2760   116%     -  667s
H    0     0                    16566.051416 35766.2760   116%     -  668s
H    0     0                    16682.707174 35766.2760   114%     -  668s
H    0     0                    16904.846712 35766.2760   112%     -  668s
H    0     0                    17130.157592 35766.2760   109%     -  669s
H    0     0                    17176.565507 35766.2760   108%     -  669s
H    0     0                    17218.336593 35766.2760   108%     -  669s
H    0     0                    17304.012039 35766.2760   107%     -  670s
H    0     0                    17304.881157 35766.2760   107%     -  670s
H    0     0                    17310.074303 35766.2760   107%     -  670s
H    0     0                    17310.943421 35766.2760   107%     -  670s
H    0     2                    17359.816802 35766.2760   106%     -  688s
     0     2 35766.2760    0  570 17359.8168 35766.2760   106%     -  688s
     1     4 35441.6364    1  487 17359.8168 35765.4168   106% 10167  701s
     3     8 35237.4464    2  537 17359.8168 35554.6414   105%  9812  727s
     7    15 35070.3847    3  586 17359.8168 35375.8191   104% 10727  770s
    14    29 34624.1664    4  569 17359.8168 35375.8191   104% 17573  803s
    28    43 32784.3972    5  455 17359.8168 35070.0417   102% 21761  899s
H   42    74                    17373.979638 34870.1436   101% 25544  966s
H   44    74                    17405.231780 34870.1436   100% 24976  966s
    73   182 31824.2885    7  461 17405.2318 34870.1436   100% 20415 1018s
H  181   220                    18346.555463 34870.1436  90.1% 11554 1038s
H  196   220                    18528.773359 34870.1436  88.2% 10983 1038s
H  198   220                    19021.683313 34870.1436  83.3% 10953 1038s
H  212   220                    19030.089905 34870.1436  83.2% 10386 1038s
   219   294 31635.7130   11  464 19030.0899 34870.1436  83.2% 10138 1064s
   295   360 29529.2559   13  423 19030.0899 34870.1436  83.2%  8795 1086s
   363   434 30810.6076   12  449 19030.0899 34870.1436  83.2%  8114 1108s
   441   488 30733.5681   10  461 19030.0899 34870.1436  83.2%  7436 1130s
   501   527 22473.9588   13  211 19030.0899 34870.1436  83.2%  7327 1150s
   558   566 22234.1404   15  187 19030.0899 34870.1436  83.2%  7212 1169s
   615   606 19519.0739   20   95 19030.0899 34870.1436  83.2%  7198 1185s
   683   634 19283.1191   21  110 19030.0899 34870.1436  83.2%  7090 1202s
   754   650 22964.3056   17  387 19030.0899 34870.1436  83.2%  6976 1218s
   824   680 22959.4600   18  384 19030.0899 34870.1436  83.2%  6889 1237s
   898   692     cutoff   21      19030.0899 34870.1436  83.2%  6791 1256s
   980   713 infeasible   32      19030.0899 34870.1436  83.2%  6658 1274s
H  993   713                    19831.224315 34870.1436  75.8%  6662 1274s
  1041   713 23754.4796   13  303 19831.2243 34870.1436  75.8%  6615 1293s
H 1056   713                    19928.925862 34870.1436  75.0%  6611 1293s
H 1071   713                    20327.890564 34870.1436  71.5%  6592 1293s
  1088   727 26297.8193   15  468 20327.8906 34870.1436  71.5%  6594 1315s
  1147   752 26174.0524   16  469 20327.8906 34870.1436  71.5%  6550 1334s
  1210   793 26058.8380   18  443 20327.8906 34870.1436  71.5%  6541 1357s
  1287   818 25674.9672   20  464 20327.8906 34870.1436  71.5%  6559 1380s
  1358   856 24400.2071   21  428 20327.8906 34870.1436  71.5%  6641 1402s
  1428   908 24762.3132   23  466 20327.8906 34870.1436  71.5%  6712 1427s
  1520   976 24599.3396   26  397 20327.8906 34870.1436  71.5%  6734 1454s
H 1550   976                    20331.927404 34870.1436  71.5%  6711 1454s
  1613  1024 24066.8539   27  420 20331.9274 34870.1436  71.5%  6760 1474s
H 1614  1024                    20352.996383 34870.1436  71.3%  6756 1474s
H 1618  1024                    20401.199379 34870.1436  70.9%  6752 1474s
H 1622  1024                    20434.542104 34870.1436  70.6%  6750 1474s
  1667  1047 24310.7603   29  368 20434.5421 34870.1436  70.6%  6786 1501s
H 1695  1047                    20524.243657 34692.7891  69.0%  6791 1501s
  1702  1154 23742.4748   28  285 20524.2437 34692.7891  69.0%  6795 1529s
  1841  1239 23098.4239   31  311 20524.2437 34692.7891  69.0%  6747 1555s
  1976  1315 23776.0158   32  317 20524.2437 34692.7891  69.0%  6667 1586s
  2143  1401 22757.5507   34  270 20524.2437 34692.7891  69.0%  6530 1617s
  2277  1475 23122.8141   33  237 20524.2437 34692.7891  69.0%  6475 1650s
  2403  1507 23014.4672   34  260 20524.2437 34692.7891  69.0%  6512 1683s
  2525  1529 21902.2208   36  264 20524.2437 34054.5656  65.9%  6522 1715s
  2563  1567 20744.8559   36  222 20524.2437 34054.5656  65.9%  6605 1742s
  2623  1576 infeasible   37      20524.2437 34054.5656  65.9%  6608 1772s
  2672  1609 29865.3876    9  513 20524.2437 34054.5656  65.9%  6693 1810s
  2735  1648 29004.3664   10  380 20524.2437 34054.5656  65.9%  6760 1847s
  2822  1747     cutoff   12      20524.2437 34054.5656  65.9%  6830 1880s
H 2909  1747                    21217.376350 34054.5656  60.5%  6810 1880s
  2945  1861 28332.0380   13  253 21217.3763 34054.5656  60.5%  6856 1921s
  3170  1821 31672.7423    6  460 21217.3763 34054.5656  60.5%  6774 1965s
  3366  1932 25273.0691    7  436 21217.3763 33323.4636  57.1%  6723 2007s
  3586  2009 24245.4790   11  407 21217.3763 33323.4636  57.1%  6666 2049s
  3803  2100 22024.9636   16  306 21217.3763 33092.8430  56.0%  6653 2095s
  3994  2176     cutoff   59      21217.3763 32566.2783  53.5%  6682 2146s
  4140  2295 28378.0050   10  408 21217.3763 32511.5326  53.2%  6714 2196s
H 4324  2295                    21217.557108 32511.5326  53.2%  6801 2239s
H 4324  2290                    21238.626087 32511.5326  53.1%  6801 2258s
H 4324  1997                    22262.693188 32511.5326  46.0%  6801 2298s
  4325  1980 23343.8581   37  570 22262.6932 32511.5326  46.0%  6800 2632s
H 4326  1881                    22378.565318 32511.5326  45.3%  6798 2644s
H 4326  1787                    22671.125536 32511.5326  43.4%  6798 2644s
H 4326  1698                    22672.565241 32511.5326  43.4%  6798 2644s
H 4326  1613                    22678.768858 32511.5326  43.4%  6798 2644s
H 4326  1532                    22681.289221 32511.5326  43.3%  6798 2644s
  4328  1533 27998.4691    9  429 22681.2892 32511.5326  43.3%  6795 2704s
H 4328  1457                    22710.349746 32511.5326  43.2%  6795 2742s
H 4328  1384                    22713.950888 32511.5326  43.1%  6795 2742s
  4330  1385 28352.5472   21  490 22713.9509 32511.5326  43.1%  6792 2777s
  4331  1386 23760.8103   16  483 22713.9509 32511.5326  43.1%  6790 2802s
  4332  1387 24727.1557   19  522 22713.9509 32511.5326  43.1%  6789 2821s
  4333  1387 27205.8649   15  496 22713.9509 32511.5326  43.1%  6787 2831s
  4334  1388 26153.2701   31  491 22713.9509 32511.5326  43.1%  6785 2840s
  4335  1389 27597.2256   29  489 22713.9509 32511.5326  43.1%  6784 2849s
  4336  1389 22713.9509   46  515 22713.9509 32511.5326  43.1%  6782 2856s
  4337  1390 22944.8435   18  531 22713.9509 32511.5326  43.1%  6781 2863s
  4338  1391 22713.9509   25  537 22713.9509 32511.5326  43.1%  6779 2870s
  4339  1391 23053.6968   28  540 22713.9509 32511.5326  43.1%  6778 2876s
  4340  1392 29063.8793   17  494 22713.9509 32511.5326  43.1%  6776 2893s
  4341  1393 28058.2563   12  545 22713.9509 32511.5326  43.1%  6775 2900s
  4342  1393 23376.9057   52  558 22713.9509 32511.5326  43.1%  6773 2906s
  4343  1394 22713.9509   48  497 22713.9509 32511.5326  43.1%  6771 2920s
  4344  1395 24560.8533   34  577 22713.9509 32511.5326  43.1%  6770 2928s
  4345  1395 30004.5494   13  559 22713.9509 32511.5326  43.1%  6768 2941s
  4346  1396 29450.4273   11  562 22713.9509 32511.5326  43.1%  6767 2948s
  4347  1397 24350.2743   32  522 22713.9509 32511.5326  43.1%  6765 2960s
  4348  1397 25500.2802   18  521 22713.9509 32511.5326  43.1%  6764 2965s
  4349  1398 29316.7105   15  519 22713.9509 32511.5326  43.1%  6762 2974s
  4350  1399 30441.1423   10  528 22713.9509 32511.5326  43.1%  6760 2980s
  4351  1399 25578.3314   12  561 22713.9509 32511.5326  43.1%  6759 2991s
  4352  1400 26908.6655   10  552 22713.9509 32511.5326  43.1%  6757 2998s
  4353  1401 24138.1355   13  546 22713.9509 32511.5326  43.1%  6756 3010s
  4354  1401 22953.6959   23  546 22713.9509 32511.5326  43.1%  6754 3050s
  4355  1402 28855.2384   11  546 22713.9509 32511.5326  43.1%  6753 3108s
  4356  1406 32511.5326   13  496 22713.9509 32511.5326  43.1%  6813 3149s
  4358  1409 32511.5326   14  452 22713.9509 32511.5326  43.1%  6813 3193s
  4362  1416 32511.5326   15  470 22713.9509 32511.5326  43.1%  6818 3250s
  4370  1429 32511.5326   16  523 22713.9509 32511.5326  43.1%  6836 3315s
  4386  1438 32511.5326   17  505 22713.9509 32511.5326  43.1%  6889 3600s

Cutting planes:
  Gomory: 2
  Implied bound: 35
  Projected implied bound: 225
  MIR: 878
  Mixing: 1
  Flow cover: 1362
  RLT: 62
  Relax-and-lift: 307

Explored 4400 nodes (30973233 simplex iterations) in 3600.09 seconds (8795.73 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 22714 22710.3 22681.3 ... 21217.6

Time limit reached
Best objective 2.271395088846e+04, best bound 3.251153262202e+04, gap 43.1346%
  WARNING: Time limit reached. Using best solution found (gap: 43.13%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.11s
  Master Objective (UB) = 22713.95, θ = 166294.70
  Upper Bound (UB) = 22713.95

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 166294.70
  [DEBUG]   ✓ Scenario 0: θ = 166294.70 ≤ Q = 166294.70 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 166294.70 ≤ Q = 166294.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 166294.70 ≤ Q = 166294.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 166294.70 ≤ Q = 166294.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 166294.70 ≤ Q = 166294.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 166294.70 ≤ Q = 166294.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 166294.70 ≤ Q = 166294.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 166294.70 ≤ Q = 166294.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 166294.70 ≤ Q = 166294.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 166294.70 ≤ Q = 166294.70 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 10] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x49521be7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x49521be7
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [1e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.356797e+13
Presolve removed 2581 rows and 1872 columns
Presolve time: 0.00s
Presolved: 512 rows, 517 columns, 1445 nonzeros
Found heuristic solution: objective 6784617.3257
Variable types: 350 continuous, 167 integer (167 binary)

Root relaxation: objective -1.536058e+05, 241 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -153605.81    0  121 6784617.33 -153605.81   102%     -    0s
H    0     0                    -110141.6396 -153605.81  39.5%     -    0s
H    0     0                    -118487.1858 -153605.81  29.6%     -    0s
H    0     0                    -119980.4801 -153605.81  28.0%     -    0s
     0     0 -132846.30    0  108 -119980.48 -132846.30  10.7%     -    0s
H    0     0                    -129727.9037 -132735.56  2.32%     -    0s
H    0     0                    -130215.1122 -131651.32  1.10%     -    0s
     0     0 -131651.32    0  111 -130215.11 -131651.32  1.10%     -    0s
H    0     0                    -130447.8599 -131625.74  0.90%     -    0s
     0     0 -131625.74    0   93 -130447.86 -131625.74  0.90%     -    0s
     0     0 -131290.85    0   72 -130447.86 -131290.85  0.65%     -    0s
     0     0 -131259.06    0   70 -130447.86 -131259.06  0.62%     -    0s
     0     0 -131258.85    0   70 -130447.86 -131258.85  0.62%     -    0s
     0     0 -131043.64    0   66 -130447.86 -131043.64  0.46%     -    0s
     0     0 -131039.82    0   68 -130447.86 -131039.82  0.45%     -    0s
     0     0 -130887.06    0   92 -130447.86 -130887.06  0.34%     -    0s
     0     0 -130886.36    0   69 -130447.86 -130886.36  0.34%     -    0s
     0     0 -130856.64    0   59 -130447.86 -130856.64  0.31%     -    0s
     0     2 -130856.64    0   59 -130447.86 -130856.64  0.31%     -    0s
H   47    21                    -130491.1927 -130703.77  0.16%   9.4    0s
H  274    27                    -130501.3959 -130546.98  0.03%   4.8    0s
H  351     6                    -130504.8068 -130524.71  0.02%   4.7    0s
H  357     6                    -130517.6830 -130524.71  0.01%   4.6    0s

Cutting planes:
  Gomory: 49
  Implied bound: 11
  MIR: 125
  Flow cover: 20
  RLT: 46
  Relax-and-lift: 6
  BQP: 3

Explored 372 nodes (2352 simplex iterations) in 0.12 seconds (0.07 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -130518 -130505 -130501 ... 6.78462e+06
No other solutions better than -130518

Optimal solution found (tolerance 1.00e-04)
Best objective -1.305176830025e+05, best bound -1.305176830025e+05, gap 0.0000%
  Subproblem solved in 0.13s
  Worst-case operational profit (Z_SP) = 157280.62
  Scenario: 47 demand increases, 13 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -130517.68
  [DEBUG]   S×d_nominal = 287798.30
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 287798.30 + -130517.68 = 157280.62
  [DEBUG]   Current θ from Master = 166294.70
  [DEBUG]   ⚠️  Z_SP ≤ θ by 9014.08 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 13699.87
  Lower Bound (LB) = 19044.82
  Gap (UB-LB) = 3669.1321, Absolute Gap = 3669.1321, Relative Gap = 0.161536
  Not converged yet (gap = 3669.13 > ε = 200)

  [DEBUG] Adding NEW scenario 10 to Master Problem...
  [DEBUG] New scenario pattern: 47 increases, 13 decreases
    [DEBUG] Scenario 10 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 10 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 10]
    [DEBUG]   - Total constraints in model: 169573
    [DEBUG]   - Total variables in model: 70900
  [DEBUG] Total scenarios in Master: 11
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 11
================================================================================
[Iteration 11] Solving Master Problem...
  Current scenarios in Master: 11
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 169573 rows, 70900 columns and 481192 nonzeros
Model fingerprint: 0x7ea58083
Variable types: 68641 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 73386 rows and 29796 columns
Presolve time: 1.35s
Presolved: 96187 rows, 41104 columns, 583301 nonzeros
Variable types: 38845 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -333692.0824
Found heuristic solution: objective -184683.4741

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.20s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 4.336e+06
 Factor NZ  : 9.502e+06 (roughly 130 MB of memory)
 Factor Ops : 1.734e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.84535136e+07  1.71796158e+08  1.09e+05 2.01e+01  7.81e+04     3s
   1  -1.38639765e+07  1.54818508e+08  7.58e+04 7.08e+01  5.37e+04     3s
   2  -3.90610638e+06  1.14356860e+08  2.12e+04 8.28e-01  1.61e+04     3s
   3  -7.84471662e+05  8.67243381e+07  1.82e+03 1.32e+00  1.77e+03     3s
   4  -4.57361465e+05  3.66264437e+07  3.69e+02 3.81e-01  4.37e+02     3s
   5  -3.38985105e+05  2.31063136e+07  9.26e+01 2.11e-01  1.85e+02     3s
   6  -2.76023374e+05  1.64733195e+07  4.83e+01 1.43e-01  1.18e+02     3s
   7  -1.59052425e+05  1.21857357e+07  1.37e+01 1.01e-01  7.55e+01     3s
   8  -1.01697565e+05  8.94011421e+06  6.76e+00 7.28e-02  5.34e+01     3s
   9  -7.02814844e+04  5.34397547e+06  3.90e+00 4.21e-02  3.15e+01     3s
  10  -4.31788065e+04  2.08572003e+06  1.84e+00 1.56e-02  1.22e+01     3s
  11  -1.75289762e+03  4.87072781e+05  5.75e-01 3.44e-03  2.79e+00     3s
  12   5.18418635e+03  2.29996075e+05  4.26e-01 1.33e-03  1.28e+00     3s
  13   1.10445077e+04  1.80306414e+05  3.29e-01 1.53e-03  9.63e-01     3s
  14   1.37294124e+04  1.64245409e+05  2.97e-01 1.40e-03  8.56e-01     3s
  15   1.80868065e+04  1.42319716e+05  2.42e-01 1.39e-03  7.07e-01     3s
  16   2.46189119e+04  1.07436152e+05  1.82e-01 1.49e-03  4.71e-01     3s
  17   3.08042320e+04  8.82291492e+04  1.37e-01 1.80e-03  3.26e-01     3s
  18   3.58625083e+04  7.85846598e+04  1.04e-01 1.74e-03  2.43e-01     3s
  19   3.97731095e+04  7.34314808e+04  7.90e-02 2.68e-03  1.91e-01     3s
  20   4.17344288e+04  6.88958272e+04  6.69e-02 2.18e-03  1.54e-01     3s
  21   4.33793405e+04  6.51641064e+04  5.65e-02 1.68e-03  1.24e-01     3s
  22   4.53228990e+04  6.26048136e+04  4.47e-02 1.44e-03  9.82e-02     3s
  23   4.71093733e+04  5.99109889e+04  3.41e-02 1.02e-03  7.28e-02     3s
  24   4.79605059e+04  5.82138517e+04  2.95e-02 1.13e-03  5.83e-02     3s
  25   4.90016475e+04  5.69282879e+04  2.38e-02 1.16e-03  4.51e-02     3s
  26   5.01646769e+04  5.62989801e+04  1.77e-02 9.09e-04  3.49e-02     3s
  27   5.10824674e+04  5.56111474e+04  1.28e-02 7.05e-04  2.57e-02     3s
  28   5.15750470e+04  5.53527656e+04  1.04e-02 6.13e-04  2.15e-02     4s
  29   5.19864753e+04  5.48934185e+04  8.29e-03 4.36e-04  1.65e-02     4s
  30   5.24171839e+04  5.46984009e+04  6.12e-03 3.61e-04  1.30e-02     4s
  31   5.27115280e+04  5.44193937e+04  4.65e-03 2.57e-04  9.71e-03     4s
  32   5.29308641e+04  5.41415839e+04  3.55e-03 1.58e-04  6.88e-03     4s
  33   5.29787724e+04  5.40753939e+04  3.30e-03 1.34e-04  6.23e-03     4s
  34   5.31341609e+04  5.39794488e+04  2.56e-03 9.83e-05  4.80e-03     4s
  35   5.32404834e+04  5.39488379e+04  2.06e-03 8.75e-05  4.03e-03     4s
  36   5.33613407e+04  5.38862590e+04  1.49e-03 6.01e-05  2.98e-03     4s
  37   5.33883980e+04  5.38580193e+04  1.37e-03 5.06e-05  2.67e-03     4s
  38   5.34506484e+04  5.38412466e+04  1.08e-03 4.51e-05  2.22e-03     4s
  39   5.35071611e+04  5.38245167e+04  8.29e-04 3.94e-05  1.80e-03     4s
  40   5.35204816e+04  5.37999633e+04  7.68e-04 3.10e-05  1.59e-03     4s
  41   5.35366595e+04  5.37777637e+04  6.94e-04 2.04e-05  1.37e-03     4s
  42   5.35958479e+04  5.37482780e+04  4.29e-04 1.27e-05  8.66e-04     4s
  43   5.36305029e+04  5.37291564e+04  2.75e-04 8.03e-06  5.61e-04     4s
  44   5.36750143e+04  5.37193182e+04  8.21e-05 5.69e-06  2.52e-04     4s
  45   5.36802023e+04  5.37119168e+04  6.16e-05 3.72e-06  1.80e-04     4s
  46   5.36864904e+04  5.37093690e+04  3.69e-05 3.08e-06  1.30e-04     4s
  47   5.36867713e+04  5.37076092e+04  3.58e-05 2.67e-06  1.18e-04     4s
  48   5.36912906e+04  5.37060133e+04  1.86e-05 2.28e-06  8.35e-05     4s
  49   5.36924375e+04  5.37040699e+04  1.47e-05 1.80e-06  6.60e-05     4s
  50   5.36924954e+04  5.37035162e+04  1.44e-05 1.66e-06  6.25e-05     5s
  51   5.36940970e+04  5.37027055e+04  8.94e-06 1.58e-06  4.88e-05     5s
  52   5.36953215e+04  5.36986585e+04  4.58e-06 6.15e-07  1.89e-05     5s
  53   5.36957172e+04  5.36980694e+04  3.26e-06 4.27e-07  1.33e-05     5s
  54   5.36959303e+04  5.36978801e+04  2.58e-06 3.61e-07  1.11e-05     5s
  55   5.36962142e+04  5.36973198e+04  1.67e-06 1.83e-07  6.28e-06     5s
  56   5.36965810e+04  5.36972027e+04  4.48e-07 1.46e-07  3.53e-06     5s
  57   5.36966833e+04  5.36969848e+04  1.21e-07 7.66e-08  1.71e-06     5s
  58   5.36967304e+04  5.36968349e+04  1.98e-08 2.89e-08  5.92e-07     5s
  59   5.36967360e+04  5.36967415e+04  8.64e-09 3.27e-10  3.12e-08     5s
  60   5.36967396e+04  5.36967396e+04  2.33e-08 8.59e-09  1.20e-10     5s

Barrier solved model in 60 iterations and 5.03 seconds (10.10 work units)
Optimal objective 5.36967396e+04


Root crossover log...

   75915 DPushes remaining with DInf 0.0000000e+00                 5s
       0 DPushes remaining with DInf 0.0000000e+00                 7s

    2749 PPushes remaining with PInf 1.3724595e-05                 7s
       0 PPushes remaining with PInf 0.0000000e+00                 7s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.2218657e-01      7s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   31960    5.3696740e+04   0.000000e+00   3.221866e-01      7s
   31961    5.3696740e+04   0.000000e+00   0.000000e+00      7s
   31961    5.3696740e+04   0.000000e+00   0.000000e+00      7s
Concurrent spin time: 0.83s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 5.369674e+04, 31961 iterations, 6.44 seconds (13.44 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 53696.7396    0  462 -184683.47 53696.7396   129%     -    8s
H    0     0                    -173694.6684 53696.7396   131%     -    8s
H    0     0                    -130136.8613 53696.7396   141%     -    9s
H    0     0                    -125255.7961 53696.7396   143%     -    9s
H    0     0                    -123539.3018 53696.7396   143%     -    9s
H    0     0                    -122721.8086 53696.7396   144%     -    9s
H    0     0                    -122698.7090 53696.7396   144%     -    9s
H    0     0                    -122071.6123 53696.7396   144%     -    9s
H    0     0                    -119986.3255 53696.7396   145%     -    9s
H    0     0                    -119863.9950 53696.7396   145%     -    9s
H    0     0                    -119415.2546 53696.7396   145%     -    9s
H    0     0                    -100528.0907 53696.7396   153%     -    9s
H    0     0                    -77882.19181 53696.7396   169%     -   10s
H    0     0                    -77863.52008 53696.7396   169%     -   10s
H    0     0                    -20318.22421 53696.7396   364%     -   11s
H    0     0                    -17728.12803 53696.7396   403%     -   11s
H    0     0                    -4694.044795 53696.7396  1244%     -   11s
H    0     0                    -4669.818872 53696.7396  1250%     -   11s
H    0     0                    -2497.891559 53696.7396  2250%     -   11s
H    0     0                    -2493.765075 53696.7396  2253%     -   11s
H    0     0                    -2439.018639 53696.7396  2302%     -   11s
H    0     0                    -2425.029108 53696.7396  2314%     -   11s
H    0     0                    -2014.314274 53696.7396  2766%     -   11s
H    0     0                    -2013.780817 53696.7396  2766%     -   11s
     0     0 47587.2448    0  444 -2013.7808 47587.2448  2463%     -   49s
H    0     0                    -1734.755284 47587.2448  2843%     -   50s
H    0     0                    -1734.221826 47587.2448  2844%     -   50s
H    0     0                    -1718.589514 47587.2448  2869%     -   50s
H    0     0                    -1708.933812 47587.2448  2885%     -   50s
H    0     0                    -1708.400355 47587.2448  2885%     -   50s
     0     0 46501.4695    0  464 -1708.4004 46501.4695  2822%     -   74s
     0     0 46422.3347    0  463 -1708.4004 46422.3347  2817%     -   85s
     0     0 46410.3947    0  450 -1708.4004 46410.3947  2817%     -   95s
     0     0 46410.3947    0  487 -1708.4004 46410.3947  2817%     -  102s
     0     0 46410.3947    0  488 -1708.4004 46410.3947  2817%     -  105s
     0     0 46410.3947    0  461 -1708.4004 46410.3947  2817%     -  106s
     0     0 46410.3947    0  491 -1708.4004 46410.3947  2817%     -  108s
     0     0 46410.3947    0  490 -1708.4004 46410.3947  2817%     -  109s
H    0     0                    -1137.289085 42955.3454  3877%     -  154s
H    0     0                      86.9236648 42955.3454      -     -  154s
H    0     0                     378.2783732 42955.3454      -     -  154s
H    0     0                     379.7180788 42955.3454      -     -  154s
H    0     0                    1317.3942287 42955.3454  3161%     -  154s
H    0     0                    1374.3326159 42955.3454  3026%     -  154s
H    0     0                    3343.5851313 42955.3454  1185%     -  154s
H    0     0                    4107.4687587 42955.3454   946%     -  154s
     0     0 42955.3454    0  478 4107.46876 42955.3454   946%     -  154s
H    0     0                    11613.914898 42955.3149   270%     -  156s
     0     0 42208.6006    0  497 11613.9149 42208.6006   263%     -  185s
     0     0 41984.0513    0  507 11613.9149 41984.0513   261%     -  202s
     0     0 41820.6841    0  518 11613.9149 41820.6841   260%     -  217s
     0     0 41654.3193    0  516 11613.9149 41654.3193   259%     -  231s
H    0     0                    11973.577553 41637.5463   248%     -  240s
     0     0 41637.5463    0  489 11973.5776 41637.5463   248%     -  240s
     0     0 41566.2893    0  486 11973.5776 41566.2893   247%     -  249s
     0     0 41555.3343    0  500 11973.5776 41555.3343   247%     -  252s
     0     0 41525.7326    0  493 11973.5776 41525.7326   247%     -  260s
     0     0 41515.3408    0  512 11973.5776 41515.3408   247%     -  265s
     0     0 41495.5000    0  555 11973.5776 41495.5000   247%     -  269s
     0     0 41473.0163    0  492 11973.5776 41473.0163   246%     -  273s
     0     0 41452.4102    0  511 11973.5776 41452.4102   246%     -  277s
     0     0 41424.9806    0  499 11973.5776 41424.9806   246%     -  282s
     0     0 41423.5514    0  497 11973.5776 41423.5514   246%     -  283s
H    0     0                    11977.499246 38824.5776   224%     -  357s
H    0     0                    12117.790700 38824.5776   220%     -  357s
H    0     0                    12329.059219 38824.5776   215%     -  357s
     0     0 38824.5776    0  523 12329.0592 38824.5776   215%     -  357s
H    0     0                    12395.472651 38824.2670   213%     -  357s
     0     0 38462.0838    0  536 12395.4727 38462.0838   210%     -  393s
     0     0 38262.6448    0  529 12395.4727 38262.6448   209%     -  413s
H    0     0                    12587.726719 38093.3707   203%     -  429s
H    0     0                    12597.157401 38093.3707   202%     -  429s
H    0     0                    12794.178760 38093.3707   198%     -  429s
H    0     0                    12955.651981 38093.3707   194%     -  429s
     0     0 38093.3707    0  577 12955.6520 38093.3707   194%     -  429s
H    0     0                    15302.516150 38016.9685   148%     -  439s
H    0     0                    15676.263295 38016.9685   143%     -  439s
H    0     0                    15688.943899 38016.9685   142%     -  439s
     0     0 38016.9685    0  537 15688.9439 38016.9685   142%     -  439s
     0     0 37975.5479    0  548 15688.9439 37975.5479   142%     -  446s
     0     0 37956.2249    0  559 15688.9439 37956.2249   142%     -  451s
     0     0 37914.4737    0  562 15688.9439 37914.4737   142%     -  459s
     0     0 37899.1340    0  559 15688.9439 37899.1340   142%     -  465s
     0     0 37893.8670    0  623 15688.9439 37893.8670   142%     -  469s
     0     0 37887.6183    0  552 15688.9439 37887.6183   141%     -  472s
     0     0 37884.0019    0  553 15688.9439 37884.0019   141%     -  474s
     0     0 37867.9735    0  545 15688.9439 37867.9735   141%     -  478s
     0     0 37860.2132    0  536 15688.9439 37860.2132   141%     -  481s
     0     0 37856.9263    0  536 15688.9439 37856.9263   141%     -  483s
     0     0 37840.7249    0  558 15688.9439 37840.7249   141%     -  486s
     0     0 37833.8601    0  556 15688.9439 37833.8601   141%     -  489s
     0     0 37828.3985    0  552 15688.9439 37828.3985   141%     -  491s
     0     0 37827.8206    0  559 15688.9439 37827.8206   141%     -  492s
H    0     0                    18390.514885 36855.5521   100%     -  562s
H    0     0                    18394.436578 36855.5521   100%     -  562s
H    0     0                    18447.117302 36855.5521   100%     -  562s
     0     0 36855.5521    0  519 18447.1173 36855.5521   100%     -  562s
     0     0 36643.8471    0  509 18447.1173 36643.8471  98.6%     -  585s
     0     0 36559.2820    0  536 18447.1173 36559.2820  98.2%     -  600s
     0     0 36518.8264    0  510 18447.1173 36518.8264  98.0%     -  609s
     0     0 36495.0132    0  518 18447.1173 36495.0132  97.8%     -  616s
     0     0 36466.0497    0  518 18447.1173 36466.0497  97.7%     -  623s
     0     0 36455.4735    0  516 18447.1173 36455.4735  97.6%     -  627s
     0     0 36436.5226    0  569 18447.1173 36436.5226  97.5%     -  632s
     0     0 36429.5356    0  573 18447.1173 36429.5356  97.5%     -  635s
     0     0 36420.8840    0  568 18447.1173 36420.8840  97.4%     -  639s
     0     0 36414.0821    0  601 18447.1173 36414.0821  97.4%     -  642s
     0     0 36411.7381    0  599 18447.1173 36411.7381  97.4%     -  644s
     0     0 36203.8936    0  582 18447.1173 36203.8936  96.3%     -  665s
H    0     0                    18764.498547 36153.2776  92.7%     -  673s
H    0     0                    18815.693259 36153.2776  92.1%     -  673s
H    0     0                    18922.199909 36153.2776  91.1%     -  673s
     0     0 36153.2776    0  619 18922.1999 36153.2776  91.1%     -  673s
     0     0 36137.5768    0  622 18922.1999 36137.5768  91.0%     -  680s
     0     0 36124.5872    0  629 18922.1999 36124.5872  90.9%     -  686s
     0     0 36115.1359    0  603 18922.1999 36115.1359  90.9%     -  695s
     0     0 36106.7920    0  576 18922.1999 36106.7920  90.8%     -  698s
     0     0 36101.5758    0  601 18922.1999 36101.5758  90.8%     -  703s
     0     0 36100.9805    0  593 18922.1999 36100.9805  90.8%     -  705s
     0     0 36009.5061    0  551 18922.1999 36009.5061  90.3%     -  721s
H    0     0                    21469.034894 36009.2207  67.7%     -  726s
     0     0 35960.9748    0  563 21469.0349 35960.9748  67.5%     -  736s
     0     0 35951.3382    0  561 21469.0349 35951.3382  67.5%     -  742s
     0     0 35946.6178    0  570 21469.0349 35946.6178  67.4%     -  746s
     0     0 35944.1153    0  526 21469.0349 35944.1153  67.4%     -  748s
     0     0 35898.0075    0  530 21469.0349 35898.0075  67.2%     -  759s
     0     0 35859.3436    0  544 21469.0349 35859.3436  67.0%     -  770s
     0     0 35848.7688    0  544 21469.0349 35848.7688  67.0%     -  775s
     0     0 35843.4532    0  535 21469.0349 35843.4532  67.0%     -  777s
     0     0 35842.1026    0  528 21469.0349 35842.1026  66.9%     -  779s
     0     0 35799.3622    0  631 21469.0349 35799.3622  66.7%     -  793s
H    0     0                    21518.356552 35799.2717  66.4%     -  794s
H    0     0                    21518.537310 35799.2717  66.4%     -  794s
H    0     0                    21519.977016 35799.2717  66.4%     -  794s
     0     0 35793.2236    0  565 21519.9770 35793.2236  66.3%     -  799s
     0     0 35788.4030    0  530 21519.9770 35788.4030  66.3%     -  803s
     0     0 35786.8614    0  545 21519.9770 35786.8614  66.3%     -  805s
     0     0 35746.2697    0  583 21519.9770 35746.2697  66.1%     -  819s
     0     0 35740.3102    0  533 21519.9770 35740.3102  66.1%     -  823s
     0     0 35737.5435    0  569 21519.9770 35737.5435  66.1%     -  825s
     0     0 35712.0382    0  523 21519.9770 35712.0382  65.9%     -  835s
     0     0 35706.4736    0  560 21519.9770 35706.4736  65.9%     -  844s
     0     0 35705.8400    0  564 21519.9770 35705.8400  65.9%     -  845s
     0     0 35697.6924    0  628 21519.9770 35697.6924  65.9%     -  851s
     0     0 35693.7248    0  641 21519.9770 35693.7248  65.9%     -  855s
     0     0 35692.9468    0  586 21519.9770 35692.9468  65.9%     -  857s
     0     0 35680.8889    0  582 21519.9770 35680.8889  65.8%     -  863s
     0     0 35680.5383    0  582 21519.9770 35680.5383  65.8%     -  866s
H    0     0                    21618.041199 35680.5383  65.0%     - 1003s
H    0     0                    21621.962892 35680.5383  65.0%     - 1003s
H    0     0                    21706.046859 35680.5383  64.4%     - 1004s
H    0     0                    21709.648001 35680.5383  64.4%     - 1004s
     0     2 35680.5383    0  582 21709.6480 35680.5383  64.4%     - 1006s
     1     3 35272.2891    1  522 21709.6480 35679.9098  64.4% 21536 1040s
     2     4 35280.9473    1  518 21709.6480 35280.9473  62.5% 16977 1056s
     3     6 34827.3215    2  493 21709.6480 35280.9296  62.5% 14946 1072s
     5    12 34289.3091    3  538 21709.6480 35280.9296  62.5% 13454 1098s
    11    24 34245.2332    4  538 21709.6480 34834.3390  60.5% 14082 1156s
    23    36 34042.8148    4  552 21709.6480 34759.3556  60.1% 21847 2003s
    35    68 33883.0182    5  535 21709.6480 34759.3556  60.1% 25578 2107s
    67   208 33861.1521    6  491 21709.6480 34653.0886  59.6% 23483 2159s
   209   239 33680.0012   11  483 21709.6480 34652.7634  59.6% 11318 2177s
   240   277 33669.4501   12  481 21709.6480 34652.7634  59.6% 10354 2196s
   278   327 33474.1647   13  476 21709.6480 34652.7634  59.6%  9569 2217s
   328   370 26181.0619   16  159 21709.6480 34652.7634  59.6%  9162 2237s
   385   409 25934.3633   19  128 21709.6480 34652.7634  59.6%  8718 2257s
   442   445 25374.5902   24  130 21709.6480 34652.7634  59.6%  8348 2277s
   496   457 23789.2908   26  149 21709.6480 34652.7634  59.6%  8081 2298s
   545   449 23660.9380   26  134 21709.6480 34652.7634  59.6%  8037 2320s
   596   460 infeasible   27      21709.6480 34652.7634  59.6%  8009 2342s
   633   487 26115.7909   12  191 21709.6480 34652.7634  59.6%  8020 2363s
   698   486 24547.5421   19   81 21709.6480 34652.7634  59.6%  7692 2382s
   751   494 24186.2868   20   83 21709.6480 34652.7634  59.6%  7452 2403s
   805   513 infeasible   21      21709.6480 34652.7634  59.6%  7298 2423s
   840   510 infeasible   21      21709.6480 34652.7634  59.6%  7147 2444s
   927   490 22927.6248   24   79 21709.6480 34652.7634  59.6%  6858 2466s
   995   496 25058.8738   16  438 21709.6480 34652.7634  59.6%  6728 2491s
  1007   512 33872.7598    5  540 21709.6480 34186.0634  57.5%  6782 2517s
  1023   525 30045.7921    9  447 21709.6480 34186.0634  57.5%  6911 2543s
  1036   536 30016.8844   10  450 21709.6480 34185.9402  57.5%  7041 2568s
  1051   544 22080.1501   20  386 21709.6480 34185.9402  57.5%  7156 2595s
  1065   552 infeasible   21      21709.6480 33872.6711  56.0%  7242 2623s
  1077   566 30575.4318    7  490 21709.6480 33604.2214  54.8%  7339 2647s
  1097   593 29210.5489    8  476 21709.6480 33573.5680  54.6%  7432 2675s
  1126   609 29157.5099    9  461 21709.6480 33376.1039  53.7%  7696 2704s
  1160   633 26872.0486   22  350 21709.6480 33376.1039  53.7%  7873 2732s
  1194   673 27096.3195   11  462 21709.6480 33376.1039  53.7%  8100 2757s
  1238   708 26926.7043   12  410 21709.6480 33376.1039  53.7%  8182 2782s
H 1259   708                    22010.367072 33376.1039  51.6%  8241 2782s
  1296   754 26509.6240   15  378 22010.3671 33376.1039  51.6%  8233 2811s
H 1382   783                    22032.238058 33376.1039  51.5%  8229 2845s
H 1386   783                    22055.877212 33376.1039  51.3%  8228 2845s
H 1388   783                    22077.748198 33376.1039  51.2%  8230 2845s
H 1420   783                    22078.005961 33376.1039  51.2%  8234 2845s
H 1421   783                    22088.823014 33376.1039  51.1%  8245 2845s
H 1422   783                    22241.715462 33376.1039  50.1%  8256 2845s
  1468   820 24682.7978   23  319 22241.7155 33376.1039  50.1%  8254 2879s
H 1555   864                    22263.586448 33376.1039  49.9%  8309 2909s
  1647   863     cutoff   32      22263.5864 33376.1039  49.9%  8317 2945s
  1764   879 23519.8749   16  124 22263.5864 33341.5506  49.8%  8199 2983s
H 1794   879                    22274.925142 33341.5506  49.7%  8243 2983s
  1836   904 23055.3625   21   86 22274.9251 33341.5506  49.7%  8286 3026s
  1871   934 23037.1148   22   82 22274.9251 33341.5506  49.7%  8457 3065s
  1909   967 22302.2152   23   68 22274.9251 33341.5506  49.7%  8558 3098s
  1954   981     cutoff   24      22274.9251 33341.5506  49.7%  8649 3138s
  2024   998 infeasible   25      22274.9251 33337.7805  49.7%  8696 3181s
  2071  1031 32070.2623    7  443 22274.9251 33154.7702  48.8%  8769 3223s
  2122  1036 29323.1106   13  430 22274.9251 33154.7702  48.8%  8860 3266s
  2199  1057 26126.6824    8  408 22274.9251 33154.7702  48.8%  8906 3312s
  2294  1095 26078.5976    9  347 22274.9251 33154.7702  48.8%  8912 3359s
  2398  1114 25264.0540   10  350 22274.9251 33154.7702  48.8%  8930 3410s
  2441  1160 24864.8115   11  338 22274.9251 33154.7702  48.8%  9062 3460s
  2557  1243 23530.5480   13  196 22274.9251 33154.7702  48.8%  9053 3513s
  2716  1348 28599.8503    9  520 22274.9251 33154.7702  48.8%  9083 3567s
  2869  1380 28435.8505   10  452 22274.9251 33036.4615  48.3%  9082 3600s

Cutting planes:
  Learned: 2
  Gomory: 15
  Implied bound: 285
  MIR: 3953
  Flow cover: 3645
  Inf proof: 1
  RLT: 230
  Relax-and-lift: 1334

Explored 3001 nodes (27779899 simplex iterations) in 3600.05 seconds (8277.95 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 22274.9 22263.6 22241.7 ... 21709.6

Time limit reached
Best objective 2.227492514186e+04, best bound 3.284038001877e+04, gap 47.4321%
  WARNING: Time limit reached. Using best solution found (gap: 47.43%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = 22274.93, θ = 165167.93
  Upper Bound (UB) = 22274.93

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 165167.93
  [DEBUG]   ✓ Scenario 0: θ = 165167.93 ≤ Q = 165167.93 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 165167.93 ≤ Q = 165167.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 165167.93 ≤ Q = 165167.93 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 165167.93 ≤ Q = 165167.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 165167.93 ≤ Q = 165167.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 165167.93 ≤ Q = 165167.93 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 165167.93 ≤ Q = 165167.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 165167.93 ≤ Q = 165167.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 165167.93 ≤ Q = 165167.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 165167.93 ≤ Q = 165167.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 165167.93 ≤ Q = 165167.93 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 11] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x76eb108f
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x76eb108f
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [3e-01, 2e+02]
Found heuristic solution: objective 1.331503e+13
Presolve removed 2587 rows and 1877 columns
Presolve time: 0.00s
Presolved: 506 rows, 512 columns, 1429 nonzeros
Found heuristic solution: objective 6500427.0151
Variable types: 346 continuous, 166 integer (166 binary)
Found heuristic solution: objective 6500118.4260

Root relaxation: objective -1.564010e+05, 243 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -156401.03    0  122 6500118.43 -156401.03   102%     -    0s
H    0     0                    -113102.5683 -156401.03  38.3%     -    0s
H    0     0                    -120658.1811 -156401.03  29.6%     -    0s
     0     0 -130423.77    0  101 -120658.18 -130423.77  8.09%     -    0s
H    0     0                    -129017.6672 -130416.41  1.08%     -    0s
     0     0 -129538.09    0   50 -129017.67 -129538.09  0.40%     -    0s
     0     0 -129505.50    0   33 -129017.67 -129505.50  0.38%     -    0s
     0     0 -129370.09    0   33 -129017.67 -129370.09  0.27%     -    0s
     0     0 -129361.84    0   40 -129017.67 -129361.84  0.27%     -    0s
     0     0 -129301.48    0   30 -129017.67 -129301.48  0.22%     -    0s
     0     0 -129294.50    0   30 -129017.67 -129294.50  0.21%     -    0s
H    0     0                    -129044.0389 -129294.50  0.19%     -    0s
     0     0 -129294.50    0   75 -129044.04 -129294.50  0.19%     -    0s
     0     0 -129294.50    0   26 -129044.04 -129294.50  0.19%     -    0s
H    0     0                    -129096.6209 -129294.50  0.15%     -    0s
     0     0 -129227.52    0   11 -129096.62 -129227.52  0.10%     -    0s
     0     0 -129223.23    0    8 -129096.62 -129223.23  0.10%     -    0s
     0     0 -129221.43    0    8 -129096.62 -129221.43  0.10%     -    0s
     0     0 -129172.60    0    8 -129096.62 -129172.60  0.06%     -    0s
     0     0 -129172.60    0   17 -129096.62 -129172.60  0.06%     -    0s
     0     0 -129140.20    0    4 -129096.62 -129140.20  0.03%     -    0s
H    0     0                    -129108.7007 -129135.26  0.02%     -    0s
     0     0 -129133.10    0    5 -129108.70 -129133.10  0.02%     -    0s
     0     0 -129129.37    0    4 -129108.70 -129129.37  0.02%     -    0s
H    0     0                    -129129.1162 -129129.13  0.00%     -    0s

Cutting planes:
  Gomory: 6
  Implied bound: 1
  MIR: 4
  Flow cover: 11
  Relax-and-lift: 1

Explored 1 nodes (1045 simplex iterations) in 0.10 seconds (0.07 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -129129 -129109 -129097 ... 6.50043e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.291291162195e+05, best bound -1.291291324682e+05, gap 0.0000%
  Subproblem solved in 0.12s
  Worst-case operational profit (Z_SP) = 159990.01
  Scenario: 23 demand increases, 37 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -129129.12
  [DEBUG]   S×d_nominal = 289119.12
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 289119.12 + -129129.12 = 159990.01
  [DEBUG]   Current θ from Master = 165167.93
  [DEBUG]   ⚠️  Z_SP ≤ θ by 5177.92 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 17097.00
  Lower Bound (LB) = 19044.82
  Gap (UB-LB) = 3230.1063, Absolute Gap = 3230.1063, Relative Gap = 0.145011
  Not converged yet (gap = 3230.11 > ε = 200)

  [DEBUG] Adding NEW scenario 11 to Master Problem...
  [DEBUG] New scenario pattern: 23 increases, 37 decreases
    [DEBUG] Scenario 11 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 11 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 11]
    [DEBUG]   - Total constraints in model: 184863
    [DEBUG]   - Total variables in model: 77140
  [DEBUG] Total scenarios in Master: 12
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 12
================================================================================
[Iteration 12] Solving Master Problem...
  Current scenarios in Master: 12
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 184863 rows, 77140 columns and 524435 nonzeros
Model fingerprint: 0x34619730
Variable types: 74881 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 80072 rows and 32512 columns
Presolve time: 1.48s
Presolved: 104791 rows, 44628 columns, 632663 nonzeros
Variable types: 42369 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -335441.9273
Found heuristic solution: objective -184683.4741

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.20s

Barrier statistics:
 Dense cols : 650
 AA' NZ     : 3.618e+06
 Factor NZ  : 8.670e+06 (roughly 130 MB of memory)
 Factor Ops : 1.652e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.90360128e+07  1.85373201e+08  1.12e+05 1.79e+01  8.01e+04     3s
   1  -1.43643525e+07  1.68039793e+08  7.90e+04 6.93e+01  5.59e+04     3s
   2  -3.56143804e+06  1.27260881e+08  2.11e+04 8.46e-01  1.60e+04     3s
   3  -9.57362455e+05  9.64815231e+07  2.20e+03 9.96e-01  2.06e+03     3s
   4  -4.97563013e+05  4.28311532e+07  4.52e+02 7.82e-02  5.11e+02     3s
   5  -3.37123206e+05  2.72599669e+07  1.35e+02 4.09e-02  2.22e+02     3s
   6  -2.57334342e+05  1.82643097e+07  5.21e+01 2.48e-02  1.23e+02     3s
   7  -1.50067801e+05  1.43849003e+07  1.80e+01 1.85e-02  8.35e+01     3s
   8  -1.01083611e+05  7.91799301e+06  9.55e+00 9.64e-03  4.45e+01     3s
   9  -6.86257361e+04  3.67924298e+06  5.53e+00 4.20e-03  2.03e+01     3s
  10  -3.87568338e+04  1.14830730e+06  2.97e+00 1.13e-03  6.35e+00     3s
  11  -4.75510481e+03  3.65837652e+05  1.16e+00 3.07e-04  1.96e+00     3s
  12   5.41940058e+03  1.74642749e+05  7.85e-01 3.48e-04  8.91e-01     3s
  13   9.74137730e+03  1.35765265e+05  6.66e-01 4.16e-04  6.63e-01     3s
  14   1.77395125e+04  1.12910126e+05  5.10e-01 5.06e-04  5.00e-01     3s
  15   2.18989541e+04  1.05591755e+05  4.39e-01 7.44e-04  4.39e-01     3s
  16   2.49786484e+04  8.40972699e+04  3.88e-01 1.92e-03  3.11e-01     3s
  17   3.10187937e+04  7.63194287e+04  3.04e-01 1.52e-03  2.38e-01     3s
  18   3.43250538e+04  6.90278380e+04  2.57e-01 2.82e-03  1.82e-01     3s
  19   3.69454630e+04  6.56416873e+04  2.22e-01 3.05e-03  1.51e-01     3s
  20   4.05848964e+04  6.24338788e+04  1.72e-01 3.02e-03  1.15e-01     3s
  21   4.23171078e+04  6.05344700e+04  1.48e-01 3.42e-03  9.57e-02     3s
  22   4.50826730e+04  5.88798565e+04  1.09e-01 3.21e-03  7.24e-02     3s
  23   4.65334911e+04  5.73050038e+04  9.00e-02 2.55e-03  5.66e-02     3s
  24   4.80752300e+04  5.64386634e+04  7.03e-02 2.03e-03  4.39e-02     4s
  25   4.85657840e+04  5.60794742e+04  6.40e-02 2.17e-03  3.95e-02     4s
  26   4.96299052e+04  5.52436219e+04  5.05e-02 1.18e-03  2.95e-02     4s
  27   5.02551729e+04  5.48351322e+04  4.27e-02 1.09e-03  2.41e-02     4s
  28   5.10512643e+04  5.45095291e+04  3.23e-02 9.90e-04  1.82e-02     4s
  29   5.13450388e+04  5.43460656e+04  2.86e-02 9.07e-04  1.58e-02     4s
  30   5.20235920e+04  5.41926419e+04  2.01e-02 8.03e-04  1.14e-02     4s
  31   5.21997581e+04  5.41208183e+04  1.80e-02 6.22e-04  1.01e-02     4s
  32   5.25457576e+04  5.39863074e+04  1.37e-02 6.01e-04  7.57e-03     4s
  33   5.26141636e+04  5.39459570e+04  1.29e-02 5.86e-04  7.00e-03     4s
  34   5.30357682e+04  5.39156018e+04  8.05e-03 5.16e-04  4.62e-03     4s
  35   5.31826970e+04  5.38470237e+04  6.26e-03 6.18e-04  3.49e-03     4s
  36   5.32671907e+04  5.38260900e+04  5.29e-03 6.06e-04  2.94e-03     4s
  37   5.33377156e+04  5.38164228e+04  4.43e-03 5.49e-04  2.52e-03     4s
  38   5.33790764e+04  5.37815638e+04  3.94e-03 4.04e-04  2.12e-03     4s
  39   5.34546297e+04  5.37759523e+04  3.03e-03 3.58e-04  1.69e-03     4s
  40   5.35429948e+04  5.37572388e+04  1.99e-03 2.44e-04  1.13e-03     4s
  41   5.35986875e+04  5.37410424e+04  1.36e-03 1.36e-04  7.48e-04     4s
  42   5.36289037e+04  5.37326753e+04  1.02e-03 9.22e-05  5.46e-04     4s
  43   5.36510608e+04  5.37318535e+04  7.61e-04 8.60e-05  4.25e-04     4s
  44   5.37058546e+04  5.37215754e+04  1.31e-04 1.35e-05  8.25e-05     4s
  45   5.37163492e+04  5.37191868e+04  2.17e-05 3.55e-06  1.49e-05     4s
  46   5.37179155e+04  5.37186813e+04  5.93e-06 8.76e-07  4.02e-06     4s
  47   5.37185444e+04  5.37185889e+04  3.58e-07 9.08e-07  2.34e-07     4s
  48   5.37185860e+04  5.37185862e+04  8.65e-09 6.14e-09  9.59e-10     4s

Barrier solved model in 48 iterations and 4.49 seconds (8.45 work units)
Optimal objective 5.37185860e+04


Root crossover log...

       0 DPushes remaining with DInf 0.0000000e+00                10s

    9663 PPushes remaining with PInf 5.3117362e-05                10s
    1466 PPushes remaining with PInf 1.5954903e-05                10s
       0 PPushes remaining with PInf 0.0000000e+00                10s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.3328236e+04     10s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   44853    5.3718586e+04   0.000000e+00   2.332824e+04     10s
   44886    5.3718586e+04   0.000000e+00   0.000000e+00     10s
   44886    5.3718586e+04   0.000000e+00   0.000000e+00     11s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 5.371859e+04, 44886 iterations, 8.56 seconds (15.26 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 53718.5861    0  447 -184683.47 53718.5861   129%     -   11s
H    0     0                    -173694.6684 53718.5861   131%     -   11s
H    0     0                    -159156.4045 53718.5861   134%     -   11s
H    0     0                    -158587.4936 53718.5861   134%     -   11s
H    0     0                    -147237.3690 53718.5861   136%     -   12s
H    0     0                    -143394.6808 53718.5861   137%     -   12s
H    0     0                    -143027.8462 53718.5861   138%     -   12s
H    0     0                    -135450.2807 53718.5861   140%     -   12s
H    0     0                    -74838.73273 53718.5861   172%     -   12s
H    0     0                    -74665.15528 53718.5861   172%     -   12s
H    0     0                    -8945.909666 53718.5861   700%     -   13s
H    0     0                    -8859.554864 53718.5861   706%     -   13s
H    0     0                    -8761.294234 53718.5861   713%     -   13s
H    0     0                    -8623.918848 53718.5861   723%     -   13s
H    0     0                    8581.5047794 47726.2694   456%     -   57s
H    0     0                    8731.9845170 47726.2694   447%     -   57s
H    0     0                    8860.3357073 47726.2694   439%     -   57s
H    0     0                    8886.1365581 47726.2694   437%     -   57s
H    0     0                    9028.1203022 47726.2694   429%     -   57s
H    0     0                    9051.4595008 47726.2694   427%     -   57s
     0     0 47621.7719    0  621 9051.45950 47621.7719   426%     -   58s
H    0     0                    9134.1043953 47621.7719   421%     -   58s
H    0     0                    9151.2948224 47621.7719   420%     -   58s
H    0     0                    9277.8864209 47621.7719   413%     -   58s
     0     0 47026.0946    0  612 9277.88642 47026.0946   407%     -   80s
     0     0 46974.2135    0  617 9277.88642 46974.2135   406%     -   91s
     0     0 46974.2135    0  624 9277.88642 46974.2135   406%     -   98s
     0     0 46974.2135    0  607 9277.88642 46974.2135   406%     -  101s
     0     0 46974.2135    0  609 9277.88642 46974.2135   406%     -  102s
     0     0 46974.2135    0  608 9277.88642 46974.2135   406%     -  102s
     0     0 43738.5605    0  525 9277.88642 43738.5605   371%     -  163s
H    0     0                    13162.241236 43738.4883   232%     -  163s
     0     0 42809.4667    0  583 13162.2412 42809.4667   225%     -  214s
     0     0 42625.2226    0  586 13162.2412 42625.2226   224%     -  235s
     0     0 42522.3734    0  611 13162.2412 42522.3734   223%     -  255s
     0     0 42404.5740    0  489 13162.2412 42404.5740   222%     -  274s
     0     0 42280.1374    0  585 13162.2412 42280.1374   221%     -  292s
H    0     0                    13406.365077 42226.4184   215%     -  302s
H    0     0                    13496.207924 42226.4184   213%     -  302s
H    0     0                    13553.519449 42226.4184   212%     -  302s
H    0     0                    13780.841391 42226.4184   206%     -  302s
H    0     0                    13838.152916 42226.4184   205%     -  302s
     0     0 42226.4184    0  581 13838.1529 42226.4184   205%     -  302s
     0     0 42118.1648    0  592 13838.1529 42118.1648   204%     -  314s
     0     0 42095.8846    0  591 13838.1529 42095.8846   204%     -  321s
     0     0 42088.8905    0  506 13838.1529 42088.8905   204%     -  327s
     0     0 42078.5545    0  591 13838.1529 42078.5545   204%     -  332s
     0     0 42074.0999    0  593 13838.1529 42074.0999   204%     -  336s
H    0     0                    14898.948951 42071.9909   182%     -  339s
     0     0 42071.9909    0  592 14898.9490 42071.9909   182%     -  339s
     0     0 42064.3155    0  603 14898.9490 42064.3155   182%     -  343s
     0     0 42062.7258    0  605 14898.9490 42062.7258   182%     -  346s
     0     0 42058.8336    0  609 14898.9490 42058.8336   182%     -  347s
     0     0 42054.4548    0  620 14898.9490 42054.4548   182%     -  349s
     0     0 42010.1130    0  604 14898.9490 42010.1130   182%     -  356s
     0     0 41984.0961    0  609 14898.9490 41984.0961   182%     -  362s
H    0     0                    14899.707217 41982.9850   182%     -  365s
     0     0 41982.9850    0  624 14899.7072 41982.9850   182%     -  366s
H    0     0                    15066.263968 39614.9359   163%     -  448s
H    0     0                    15294.512390 39614.9359   159%     -  448s
     0     0 39614.9359    0  494 15294.5124 39614.9359   159%     -  448s
H    0     0                    15339.874480 39614.8336   158%     -  449s
     0     0 38773.0931    0  499 15339.8745 38773.0931   153%     -  482s
     0     0 38528.6354    0  520 15339.8745 38528.6354   151%     -  504s
     0     0 38447.2921    0  524 15339.8745 38447.2921   151%     -  517s
     0     0 38390.7095    0  511 15339.8745 38390.7095   150%     -  530s
H    0     0                    15770.095795 38309.8072   143%     -  542s
     0     0 38309.8072    0  512 15770.0958 38309.8072   143%     -  542s
     0     0 38278.3238    0  514 15770.0958 38278.3238   143%     -  549s
     0     0 38243.8910    0  508 15770.0958 38243.8910   143%     -  555s
H    0     0                    15910.254003 38235.7708   140%     -  559s
     0     0 38235.7708    0  521 15910.2540 38235.7708   140%     -  559s
     0     0 38221.8049    0  529 15910.2540 38221.8049   140%     -  562s
     0     0 38214.1562    0  520 15910.2540 38214.1562   140%     -  565s
     0     0 38209.7693    0  522 15910.2540 38209.7693   140%     -  567s
     0     0 38208.2129    0  519 15910.2540 38208.2129   140%     -  568s
     0     0 37087.7374    0  550 15910.2540 37087.7374   133%     -  626s
     0     0 36634.5839    0  564 15910.2540 36634.5839   130%     -  655s
     0     0 36554.4869    0  538 15910.2540 36554.4869   130%     -  669s
     0     0 36522.7373    0  545 15910.2540 36522.7373   130%     -  680s
H    0     0                    16945.021828 36496.8979   115%     -  687s
H    0     0                    16955.344671 36496.8979   115%     -  687s
H    0     0                    16955.385037 36496.8979   115%     -  687s
H    0     0                    16972.227603 36496.8979   115%     -  687s
H    0     0                    16998.143931 36496.8979   115%     -  687s
     0     0 36496.8979    0  546 16998.1439 36496.8979   115%     -  687s
     0     0 36466.8996    0  561 16998.1439 36466.8996   115%     -  695s
H    0     0                    17063.563775 36431.6668   114%     -  704s
H    0     0                    17076.970392 36431.6668   113%     -  704s
     0     0 36431.6668    0  555 17076.9704 36431.6668   113%     -  704s
     0     0 36428.0881    0  561 17076.9704 36428.0881   113%     -  706s
     0     0 36424.3898    0  555 17076.9704 36424.3898   113%     -  709s
     0     0 36422.8990    0  569 17076.9704 36422.8990   113%     -  711s
     0     0 36228.1233    0  548 17076.9704 36228.1233   112%     -  736s
     0     0 36189.5363    0  582 17076.9704 36189.5363   112%     -  748s
     0     0 36165.3541    0  606 17076.9704 36165.3541   112%     -  756s
     0     0 36152.6800    0  581 17076.9704 36152.6800   112%     -  762s
     0     0 36146.7952    0  599 17076.9704 36146.7952   112%     -  766s
     0     0 36143.6993    0  599 17076.9704 36143.6993   112%     -  770s
     0     0 36081.7416    0  538 17076.9704 36081.7416   111%     -  786s
     0     0 36074.1900    0  539 17076.9704 36074.1900   111%     -  791s
     0     0 36061.9125    0  538 17076.9704 36061.9125   111%     -  795s
     0     0 36057.7671    0  538 17076.9704 36057.7671   111%     -  799s
     0     0 36056.3588    0  527 17076.9704 36056.3588   111%     -  801s
     0     0 35949.0834    0  522 17076.9704 35949.0834   111%     -  821s
     0     0 35920.6647    0  585 17076.9704 35920.6647   110%     -  834s
     0     0 35911.6680    0  591 17076.9704 35911.6680   110%     -  843s
     0     0 35909.9696    0  600 17076.9704 35909.9696   110%     -  846s
     0     0 35882.1675    0  653 17076.9704 35882.1675   110%     -  860s
     0     0 35874.3433    0  665 17076.9704 35874.3433   110%     -  866s
     0     0 35869.8346    0  603 17076.9704 35869.8346   110%     -  869s
     0     0 35868.1443    0  602 17076.9704 35868.1443   110%     -  872s
     0     0 35861.6119    0  601 17076.9704 35861.6119   110%     -  877s
     0     0 35858.7854    0  603 17076.9704 35858.7854   110%     -  881s
     0     0 35851.5565    0  594 17076.9704 35851.5565   110%     -  887s
     0     0 35850.8773    0  594 17076.9704 35850.8773   110%     -  892s
H    0     0                    17359.731260 35850.8773   107%     - 1072s
H    0     0                    17419.394616 35850.8773   106%     - 1072s
H    0     2                    19580.843664 35850.8773  83.1%     - 1128s
     0     2 35850.8773    0  594 19580.8437 35850.8773  83.1%     - 1128s
     1     4 35753.6956    1  529 19580.8437 35850.6680  83.1%  9967 1142s
     3     8 35566.2371    2  539 19580.8437 35803.1918  82.8%  8556 1179s
     7    14 35501.6238    3  645 19580.8437 35581.5139  81.7% 11850 1235s
    13    25 34410.7455    4  573 19580.8437 35566.1016  81.6% 17906 1295s
    24    36 32283.2611    5  446 19580.8437 35501.4680  81.3% 25801 1390s
H   35    64                    19586.169049 34934.2419  78.4% 23116 1606s
H   35    64                    19587.608754 34934.2419  78.3% 23116 1606s
H   36    64                    20167.304890 34934.2419  73.2% 22718 1606s
    63    96 34163.5425    6  674 20167.3049 34934.2419  73.2% 24539 1682s
    95   253 34136.9841    7  579 20167.3049 34934.2419  73.2% 22973 1744s
H  105   253                    20360.167230 34934.2419  71.6% 21161 1744s
H  130   253                    20629.619766 34934.2419  69.3% 17734 1744s
H  178   253                    20651.806751 34934.2419  69.2% 14287 1744s
   252   323 33983.7842   12  530 20651.8068 34934.2419  69.2% 11308 1774s
   322   392 33955.4297   14  523 20651.8068 34934.2419  69.2%  9605 1802s
   391   439 33671.0041   16  535 20651.8068 34934.2419  69.2%  8583 1828s
   438   462 33432.2487   19  522 20651.8068 34934.2419  69.2%  8096 1852s
   463   494 32527.7202   20  575 20651.8068 34934.2419  69.2%  7968 1877s
   495   532 31428.2846   25  401 20651.8068 34934.2419  69.2%  7741 1903s
H  522   532                    20819.254306 34934.2419  67.8%  7525 1903s
   533   599 33479.6261   18  552 20819.2543 34934.2419  67.8%  7478 1931s
   600   663 32434.4222   22  573 20819.2543 34934.2419  67.8%  7156 1955s
   666   710 29524.2797   18  412 20819.2543 34934.2419  67.8%  6788 1981s
   725   767 29250.8564   19  388 20819.2543 34934.2419  67.8%  6535 2005s
   794   843 26934.9765   21  371 20819.2543 34934.2419  67.8%  6286 2029s
   873   913 26756.3924   23  377 20819.2543 34934.2419  67.8%  6014 2052s
   973   985 26747.7983   24  356 20819.2543 34934.2419  67.8%  5683 2076s
  1065  1034 infeasible   26      20819.2543 34934.2419  67.8%  5451 2099s
  1168  1107 22568.9909   32   87 20819.2543 34934.2419  67.8%  5211 2130s
  1283  1127     cutoff   35      20819.2543 34934.2419  67.8%  4953 2167s
  1383  1210 30153.8660   14  420 20819.2543 34934.2419  67.8%  4822 2194s
  1514  1244 29988.9145   15  425 20819.2543 34934.2419  67.8%  4617 2230s
  1621  1262 29944.7242   16  471 20819.2543 34934.2419  67.8%  4481 2278s
  1660  1281 28567.8438   17  387 20819.2543 34934.1613  67.8%  4481 2305s
  1699  1298 28508.6205   18  478 20819.2543 34934.1613  67.8%  4497 2333s
  1744  1320 28422.5525   19  428 20819.2543 34934.1613  67.8%  4512 2360s
H 1751  1320                    20831.549105 34934.1613  67.7%  4509 2360s
  1784  1353 27961.7097   20  332 20831.5491 34934.1613  67.7%  4514 2394s
  1863  1385 26860.6936   21  278 20831.5491 34934.1613  67.7%  4460 2431s
  1945  1430 infeasible   23      20831.5491 34934.1613  67.7%  4459 2471s
  2004  1504 infeasible   22      20831.5491 34934.1613  67.7%  4483 2507s
  2125  1522 infeasible   20      20831.5491 34234.7654  64.3%  4428 2565s
  2222  1546 24618.6042   32  305 20831.5491 34234.6989  64.3%  4428 2603s
H 2233  1546                    21810.885813 34234.6989  57.0%  4462 2603s
H 2244  1546                    22477.610658 34234.6989  52.3%  4482 2603s
H 2254  1581                    22481.532352 34234.6989  52.3%  4492 2647s
H 2256  1581                    22482.116915 34234.6989  52.3%  4499 2647s
  2321  1606 23174.5774   34   98 22482.1169 34234.6989  52.3%  4556 2685s
  2356  1634 25250.2317   12  168 22482.1169 34234.6989  52.3%  4622 2722s
  2390  1658     cutoff   13      22482.1169 34234.6989  52.3%  4666 2759s
  2434  1689 24469.2071   14  149 22482.1169 34234.6989  52.3%  4686 2795s
  2499  1735 23971.4498   18  145 22482.1169 34234.6989  52.3%  4700 2836s
  2571  1789     cutoff   22      22482.1169 33944.0757  51.0%  4751 2883s
  2680  1779 23160.2070   21   94 22482.1169 33944.0757  51.0%  4758 2928s
  2779  1745 infeasible   22      22482.1169 33944.0757  51.0%  4784 3020s
  2830  1764 infeasible   22      22482.1169 33565.5924  49.3%  4809 3178s
H 2848  1764                    22526.463446 33565.5924  49.0%  4828 3178s
  2880  1835 31756.1000   13  507 22526.4634 33565.5924  49.0%  4862 3236s
  3030  1873 29269.6685   15  423 22526.4634 33565.5924  49.0%  4865 3294s
  3154  1951 25204.5598   17  332 22526.4634 33478.5860  48.6%  4916 3359s
  3278  2069 infeasible   20      22526.4634 33447.1612  48.5%  4953 3424s
  3452  2118 infeasible   29      22526.4634 33437.0585  48.4%  4967 3494s
  3635  2204 29549.4316   13  432 22526.4634 33437.0585  48.4%  4988 3568s
  3781  2242 29155.3610   15  410 22526.4634 33437.0585  48.4%  5057 3600s

Cutting planes:
  Learned: 4
  Gomory: 24
  Implied bound: 419
  MIR: 3654
  Flow cover: 3590
  Zero half: 5
  RLT: 269
  Relax-and-lift: 1569

Explored 3867 nodes (20189080 simplex iterations) in 3600.07 seconds (9032.16 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 22526.5 22482.1 22481.5 ... 20360.2

Time limit reached
Best objective 2.252646344598e+04, best bound 3.343705853553e+04, gap 48.4346%
  WARNING: Time limit reached. Using best solution found (gap: 48.43%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = 22526.46, θ = 166549.72
  Upper Bound (UB) = 22526.46

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 166549.72
  [DEBUG]   ✓ Scenario 0: θ = 166549.72 ≤ Q = 166549.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 166549.72 ≤ Q = 166549.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 166549.72 ≤ Q = 166549.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 166549.72 ≤ Q = 166549.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 166549.72 ≤ Q = 166549.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 166549.72 ≤ Q = 166549.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 166549.72 ≤ Q = 166549.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 166549.72 ≤ Q = 166549.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 166549.72 ≤ Q = 166549.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 166549.72 ≤ Q = 166549.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 166549.72 ≤ Q = 166549.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 166549.72 ≤ Q = 166549.72 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 12] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x69fd2672
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x69fd2672
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.351339e+13
Presolve removed 2575 rows and 1867 columns
Presolve time: 0.00s
Presolved: 518 rows, 522 columns, 1461 nonzeros
Found heuristic solution: objective 6811373.8636
Variable types: 354 continuous, 168 integer (168 binary)

Root relaxation: objective -1.572823e+05, 260 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -157282.27    0  129 6811373.86 -157282.27   102%     -    0s
H    0     0                    -120337.6680 -157282.27  30.7%     -    0s
H    0     0                    -121709.0731 -157282.27  29.2%     -    0s
H    0     0                    -126840.5114 -133892.23  5.56%     -    0s
H    0     0                    -130471.1355 -133892.23  2.62%     -    0s
     0     0 -133879.98    0   22 -130471.14 -133879.98  2.61%     -    0s
H    0     0                    -133440.6774 -133849.24  0.31%     -    0s
     0     0 -133796.58    0   18 -133440.68 -133796.58  0.27%     -    0s
     0     0 -133778.23    0    7 -133440.68 -133778.23  0.25%     -    0s
     0     0 -133721.17    0    4 -133440.68 -133721.17  0.21%     -    0s
H    0     0                    -133662.2917 -133713.26  0.04%     -    0s
H    0     0                    -133713.2588 -133713.26  0.00%     -    0s
     0     0          -    0      -133713.26 -133713.26  0.00%     -    0s

Cutting planes:
  Gomory: 16
  Implied bound: 1
  MIR: 119
  Flow cover: 1
  RLT: 17

Explored 1 nodes (431 simplex iterations) in 0.02 seconds (0.02 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -133713 -133662 -133441 ... 1.35134e+13
No other solutions better than -133713

Optimal solution found (tolerance 1.00e-04)
Best objective -1.337132588498e+05, best bound -1.337132588498e+05, gap 0.0000%
  Subproblem solved in 0.04s
  Worst-case operational profit (Z_SP) = 155471.10
  Scenario: 9 demand increases, 51 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -133713.26
  [DEBUG]   S×d_nominal = 289184.36
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 289184.36 + -133713.26 = 155471.10
  [DEBUG]   Current θ from Master = 166549.72
  [DEBUG]   ⚠️  Z_SP ≤ θ by 11078.62 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 11447.84
  Lower Bound (LB) = 19044.82
  Gap (UB-LB) = 3481.6446, Absolute Gap = 3481.6446, Relative Gap = 0.154558
  Not converged yet (gap = 3481.64 > ε = 200)

  [DEBUG] Adding NEW scenario 12 to Master Problem...
  [DEBUG] New scenario pattern: 9 increases, 51 decreases
    [DEBUG] Scenario 12 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 12 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 12]
    [DEBUG]   - Total constraints in model: 200153
    [DEBUG]   - Total variables in model: 83380
  [DEBUG] Total scenarios in Master: 13
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 13
================================================================================
[Iteration 13] Solving Master Problem...
  Current scenarios in Master: 13
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 200153 rows, 83380 columns and 567678 nonzeros
Model fingerprint: 0xc2a33e80
Variable types: 81121 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 86758 rows and 35228 columns
Presolve time: 1.68s
Presolved: 113395 rows, 48152 columns, 683715 nonzeros
Variable types: 45893 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -335441.9273
Found heuristic solution: objective -184683.4741

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.24s

Barrier statistics:
 Dense cols : 642
 AA' NZ     : 4.174e+06
 Factor NZ  : 1.004e+07 (roughly 150 MB of memory)
 Factor Ops : 1.993e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.96779417e+07  1.98392554e+08  1.16e+05 1.73e+01  8.23e+04     3s
   1  -1.48606207e+07  1.80661274e+08  8.17e+04 6.89e+01  5.75e+04     3s
   2  -5.02672716e+06  1.37259735e+08  2.74e+04 5.88e-01  2.05e+04     3s
   3  -1.50992768e+06  1.36003920e+08  5.34e+03 8.52e+00  4.53e+03     3s
   4  -8.32413871e+05  1.00939842e+08  2.14e+03 4.27e+00  1.96e+03     3s
   5  -5.57946349e+05  6.49234878e+07  7.60e+02 1.39e+00  8.03e+02     3s
   6  -4.54561654e+05  3.39232993e+07  3.67e+02 4.81e-02  3.76e+02     3s
   7  -3.42227034e+05  2.42474190e+07  1.24e+02 3.09e-02  1.85e+02     3s
   8  -2.42305924e+05  1.67155972e+07  4.97e+01 1.95e-02  1.05e+02     3s
   9  -1.60345465e+05  1.20961969e+07  2.18e+01 1.33e-02  6.74e+01     3s
  10  -8.74400694e+04  6.13572514e+06  7.02e+00 6.22e-03  3.17e+01     3s
  11  -5.94982210e+04  3.40810741e+06  3.52e+00 3.29e-03  1.72e+01     3s
  12  -1.71846945e+04  1.40761355e+06  1.04e+00 1.24e-03  6.94e+00     3s
  13  -3.05309601e+03  5.23751191e+05  6.72e-01 4.33e-04  2.56e+00     3s
  14   5.89294883e+03  2.96831850e+05  4.57e-01 2.49e-04  1.41e+00     4s
  15   1.40001385e+04  2.04403439e+05  3.11e-01 2.40e-04  9.21e-01     4s
  16   1.88943763e+04  1.51094409e+05  2.48e-01 2.08e-04  6.40e-01     4s
  17   2.42379581e+04  1.27136384e+05  1.93e-01 2.32e-04  4.98e-01     4s
  18   2.84577329e+04  1.08077689e+05  1.55e-01 4.02e-04  3.85e-01     4s
  19   3.32977384e+04  9.61725861e+04  1.18e-01 9.62e-04  3.04e-01     4s
  20   3.67914591e+04  8.60415266e+04  9.38e-02 1.05e-03  2.38e-01     4s
  21   3.87945757e+04  7.59736444e+04  8.11e-02 1.49e-03  1.80e-01     4s
  22   4.12759475e+04  7.07015342e+04  6.64e-02 1.18e-03  1.42e-01     4s
  23   4.26019216e+04  6.62525414e+04  5.84e-02 1.44e-03  1.14e-01     4s
  24   4.45985923e+04  6.28003543e+04  4.69e-02 1.23e-03  8.80e-02     4s
  25   4.67609866e+04  6.15106418e+04  3.49e-02 1.30e-03  7.13e-02     4s
  26   4.79525486e+04  5.89658082e+04  2.85e-02 1.06e-03  5.32e-02     4s
  27   4.90752700e+04  5.75387064e+04  2.26e-02 1.17e-03  4.09e-02     4s
  28   4.97754346e+04  5.68348994e+04  1.91e-02 8.51e-04  3.41e-02     4s
  29   5.08069423e+04  5.61637322e+04  1.42e-02 6.71e-04  2.59e-02     4s
  30   5.11418949e+04  5.58860815e+04  1.26e-02 5.84e-04  2.29e-02     4s
  31   5.14564197e+04  5.55941715e+04  1.10e-02 5.02e-04  2.00e-02     4s
  32   5.20935717e+04  5.52560249e+04  7.81e-03 4.25e-04  1.53e-02     4s
  33   5.25507065e+04  5.49724626e+04  5.54e-03 3.38e-04  1.17e-02     4s
  34   5.26908314e+04  5.47536912e+04  4.90e-03 2.67e-04  9.96e-03     4s
  35   5.28941037e+04  5.44647905e+04  4.00e-03 1.87e-04  7.59e-03     4s
  36   5.29543663e+04  5.43613174e+04  3.71e-03 1.57e-04  6.80e-03     4s
  37   5.31703791e+04  5.41509711e+04  2.74e-03 1.25e-04  4.74e-03     5s
  38   5.33399782e+04  5.39930899e+04  1.96e-03 7.37e-05  3.16e-03     5s
  39   5.35296139e+04  5.39378409e+04  1.14e-03 5.01e-05  1.97e-03     5s
  40   5.36046174e+04  5.38935656e+04  8.23e-04 3.30e-05  1.40e-03     5s
  41   5.36468449e+04  5.38660988e+04  6.47e-04 2.23e-05  1.06e-03     5s
  42   5.36785916e+04  5.38585077e+04  5.16e-04 1.91e-05  8.69e-04     5s
  43   5.37331274e+04  5.38374540e+04  2.86e-04 4.06e-05  5.04e-04     5s
  44   5.37673860e+04  5.38198660e+04  1.53e-04 1.36e-05  2.54e-04     5s
  45   5.37978550e+04  5.38144518e+04  3.72e-05 6.43e-06  8.02e-05     5s
  46   5.38006042e+04  5.38139390e+04  2.76e-05 5.78e-06  6.44e-05     5s
  47   5.38053134e+04  5.38113194e+04  1.12e-05 2.55e-06  2.90e-05     5s
  48   5.38079443e+04  5.38102265e+04  2.90e-06 1.31e-06  1.10e-05     5s
  49   5.38089457e+04  5.38091178e+04  9.37e-08 1.21e-07  8.30e-07     5s
  50   5.38090043e+04  5.38090045e+04  2.79e-09 1.82e-08  1.03e-09     5s

Barrier solved model in 50 iterations and 5.11 seconds (9.77 work units)
Optimal objective 5.38090043e+04


Root crossover log...

   90085 DPushes remaining with DInf 0.0000000e+00                 5s
       0 DPushes remaining with DInf 0.0000000e+00                 8s

    8265 PPushes remaining with PInf 5.1795406e-05                 8s
       0 PPushes remaining with PInf 0.0000000e+00                 8s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.1002448e+01      8s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   44731    5.3809004e+04   0.000000e+00   2.100245e+01      8s
   44736    5.3809004e+04   0.000000e+00   0.000000e+00      8s
   44736    5.3809004e+04   0.000000e+00   0.000000e+00      9s
Concurrent spin time: 1.45s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 5.380900e+04, 44736 iterations, 7.73 seconds (15.24 work units)
Total elapsed time = 10.17s (DegenMoves)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 53809.0044    0  450 -184683.47 53809.0044   129%     -   10s
H    0     0                    -180113.2797 53809.0044   130%     -   10s
H    0     0                    -74075.07090 53809.0044   173%     -   11s
H    0     0                    -24302.39635 53809.0044   321%     -   11s
H    0     0                    -20325.47704 53809.0044   365%     -   11s
H    0     0                    -20316.51563 53809.0044   365%     -   11s
H    0     0                    -14961.05323 48408.3538   424%     -   53s
H    0     0                    -11217.00063 48408.3538   532%     -   53s
     0     0 48240.1758    0  566 -11217.001 48240.1758   530%     -   53s
H    0     0                    -10037.84895 48240.1758   581%     -   54s
H    0     0                    -8660.066384 48240.1758   657%     -   54s
H    0     0                    -7955.219914 48240.1758   706%     -   54s
H    0     0                    -7949.273952 48240.1758   707%     -   54s
     0     0 47664.5194    0  541 -7949.2740 47664.5194   700%     -   73s
     0     0 47548.5623    0  616 -7949.2740 47548.5623   698%     -   84s
     0     0 47520.5326    0  630 -7949.2740 47520.5326   698%     -   91s
     0     0 47511.1195    0  619 -7949.2740 47511.1195   698%     -  103s
     0     0 47511.1195    0  621 -7949.2740 47511.1195   698%     -  107s
     0     0 47511.1195    0  620 -7949.2740 47511.1195   698%     -  110s
     0     0 47511.1195    0  621 -7949.2740 47511.1195   698%     -  112s
     0     0 47511.1195    0  621 -7949.2740 47511.1195   698%     -  112s
H    0     0                    -7762.716836 44699.5662   676%     -  171s
H    0     0                    -7751.916456 44699.5662   677%     -  171s
H    0     0                    -5130.403867 44699.5662   971%     -  171s
H    0     0                    -3765.052440 44699.5662  1287%     -  171s
H    0     0                    -3764.518983 44699.5662  1287%     -  171s
H    0     0                    -3740.077822 44699.5662  1295%     -  171s
     0     0 44553.5131    0  475 -3740.0778 44553.5131  1291%     -  171s
H    0     0                    -3508.678657 44553.5131  1370%     -  172s
H    0     0                    -3315.941285 44553.5131  1444%     -  172s
H    0     0                    -3243.433727 44553.5131  1474%     -  172s
H    0     0                    -380.3096556 43222.8310      -     -  233s
H    0     0                      68.2899018 43222.8310      -     -  233s
H    0     0                      81.3387836 43222.8310      -     -  233s
H    0     0                     161.3607437 43222.8310      -     -  233s
H    0     0                     163.8529603 43222.8310      -     -  233s
H    0     0                     218.9645773 43222.8310      -     -  233s
H    0     0                     267.0650365 43222.8310      -     -  233s
     0     0 43222.8310    0  517  267.06504 43222.8310      -     -  233s
     0     0 42703.3658    0  581  267.06504 42703.3658      -     -  267s
     0     0 42467.6892    0  575  267.06504 42467.6892      -     -  287s
     0     0 42369.2974    0  609  267.06504 42369.2974      -     -  302s
     0     0 42317.2699    0  586  267.06504 42317.2699      -     -  312s
     0     0 42283.8937    0  599  267.06504 42283.8937      -     -  319s
H    0     0                     427.7423197 42189.6355  9763%     -  335s
H    0     0                    2959.9037726 42189.6355  1325%     -  335s
H    0     0                    3019.1046448 42189.6355  1297%     -  335s
H    0     0                    3171.4685038 42189.6355  1230%     -  335s
H    0     0                    3626.8554097 42189.6355  1063%     -  335s
H    0     0                    9955.3736661 42189.6355   324%     -  335s
H    0     0                    10097.788768 42189.6355   318%     -  335s
     0     0 42189.6355    0  590 10097.7888 42189.6355   318%     -  335s
H    0     0                    10988.754423 42107.9146   283%     -  352s
H    0     0                    13821.144436 42107.9146   205%     -  352s
H    0     0                    20766.699447 42107.9146   103%     -  352s
     0     0 42107.9146    0  599 20766.6994 42107.9146   103%     -  352s
     0     0 42046.9526    0  537 20766.6994 42046.9526   102%     -  368s
     0     0 42028.4191    0  582 20766.6994 42028.4191   102%     -  378s
H    0     0                    20787.768425 41972.5496   102%     -  390s
     0     0 41972.5496    0  565 20787.7684 41972.5496   102%     -  390s
     0     0 41937.7826    0  572 20787.7684 41937.7826   102%     -  399s
     0     0 41935.6159    0  575 20787.7684 41935.6159   102%     -  402s
     0     0 41933.7099    0  575 20787.7684 41933.7099   102%     -  404s
     0     0 41932.3992    0  573 20787.7684 41932.3992   102%     -  405s
H    0     0                    20984.153764 41932.3992   100%     -  431s
     0     0 39328.6584    0  545 20984.1538 39328.6584  87.4%     -  531s
H    0     0                    21008.583944 39328.6180  87.2%     -  531s
H    0     0                    21077.419953 39328.6180  86.6%     -  531s
     0     0 38499.6367    0  527 21077.4200 38499.6367  82.7%     -  582s
     0     0 38273.8679    0  548 21077.4200 38273.8679  81.6%     -  606s
     0     0 38167.6896    0  529 21077.4200 38167.6896  81.1%     -  625s
     0     0 38087.6161    0  520 21077.4200 38087.6161  80.7%     -  642s
     0     0 38019.2959    0  548 21077.4200 38019.2959  80.4%     -  659s
     0     0 37967.2219    0  541 21077.4200 37967.2219  80.1%     -  674s
     0     0 37925.8927    0  550 21077.4200 37925.8927  79.9%     -  685s
     0     0 37903.1554    0  545 21077.4200 37903.1554  79.8%     -  694s
     0     0 37897.6158    0  533 21077.4200 37897.6158  79.8%     -  700s
     0     0 37864.7435    0  538 21077.4200 37864.7435  79.6%     -  707s
     0     0 37861.1634    0  540 21077.4200 37861.1634  79.6%     -  710s
     0     0 37854.1574    0  541 21077.4200 37854.1574  79.6%     -  714s
     0     0 37833.3488    0  537 21077.4200 37833.3488  79.5%     -  720s
     0     0 37828.1516    0  526 21077.4200 37828.1516  79.5%     -  724s
     0     0 37812.9605    0  520 21077.4200 37812.9605  79.4%     -  729s
     0     0 37782.8097    0  532 21077.4200 37782.8097  79.3%     -  736s
     0     0 37770.9701    0  527 21077.4200 37770.9701  79.2%     -  741s
     0     0 37768.4982    0  532 21077.4200 37768.4982  79.2%     -  744s
H    0     0                    21080.420702 36946.2359  75.3%     -  802s
H    0     0                    21087.824047 36946.2359  75.2%     -  802s
H    0     0                    21165.105062 36946.2359  74.6%     -  802s
     0     0 36946.2359    0  506 21165.1051 36946.2359  74.6%     -  802s
     0     0 36564.6640    0  544 21165.1051 36564.6640  72.8%     -  829s
     0     0 36491.7805    0  505 21165.1051 36491.7805  72.4%     -  847s
     0     0 36475.0975    0  510 21165.1051 36475.0975  72.3%     -  855s
     0     0 36457.8684    0  511 21165.1051 36457.8684  72.3%     -  862s
     0     0 36440.8224    0  557 21165.1051 36440.8224  72.2%     -  870s
     0     0 36429.1752    0  521 21165.1051 36429.1752  72.1%     -  876s
     0     0 36427.5419    0  524 21165.1051 36427.5419  72.1%     -  879s
     0     0 36170.0177    0  646 21165.1051 36170.0177  70.9%     -  912s
     0     0 36120.8485    0  635 21165.1051 36120.8485  70.7%     -  927s
     0     0 36100.4818    0  627 21165.1051 36100.4818  70.6%     -  938s
     0     0 36088.3554    0  636 21165.1051 36088.3554  70.5%     -  945s
     0     0 36083.3450    0  643 21165.1051 36083.3450  70.5%     -  950s
     0     0 36082.1758    0  646 21165.1051 36082.1758  70.5%     -  952s
H    0     0                    21373.620281 35969.7113  68.3%     -  980s
     0     0 35969.7113    0  540 21373.6203 35969.7113  68.3%     -  980s
     0     0 35951.8884    0  512 21373.6203 35951.8884  68.2%     -  991s
     0     0 35944.0631    0  499 21373.6203 35944.0631  68.2%     -  997s
     0     0 35937.8426    0  517 21373.6203 35937.8426  68.1%     - 1000s
     0     0 35933.0833    0  546 21373.6203 35933.0833  68.1%     - 1004s
     0     0 35932.1243    0  513 21373.6203 35932.1243  68.1%     - 1006s
     0     0 35880.3342    0  514 21373.6203 35880.3342  67.9%     - 1022s
     0     0 35857.5247    0  546 21373.6203 35857.5247  67.8%     - 1037s
     0     0 35851.3680    0  524 21373.6203 35851.3680  67.7%     - 1043s
     0     0 35849.0901    0  523 21373.6203 35849.0901  67.7%     - 1047s
     0     0 35820.6137    0  517 21373.6203 35820.6137  67.6%     - 1060s
     0     0 35813.5900    0  554 21373.6203 35813.5900  67.6%     - 1065s
     0     0 35809.8649    0  561 21373.6203 35809.8649  67.5%     - 1070s
     0     0 35807.5624    0  553 21373.6203 35807.5624  67.5%     - 1073s
     0     0 35765.0646    0  519 21373.6203 35765.0646  67.3%     - 1088s
     0     0 35746.9040    0  548 21373.6203 35746.9040  67.2%     - 1101s
     0     0 35743.6152    0  553 21373.6203 35743.6152  67.2%     - 1105s
     0     0 35716.2578    0  504 21373.6203 35716.2578  67.1%     - 1116s
     0     0 35710.9429    0  507 21373.6203 35710.9429  67.1%     - 1122s
     0     0 35709.1341    0  507 21373.6203 35709.1341  67.1%     - 1127s
     0     0 35668.0623    0  506 21373.6203 35668.0623  66.9%     - 1141s
     0     0 35642.4741    0  498 21373.6203 35642.4741  66.8%     - 1151s
     0     0 35638.7956    0  488 21373.6203 35638.7956  66.7%     - 1155s
     0     0 35634.7668    0  493 21373.6203 35634.7668  66.7%     - 1159s
     0     0 35633.7227    0  499 21373.6203 35633.7227  66.7%     - 1160s
     0     0 35625.6868    0  497 21373.6203 35625.6868  66.7%     - 1167s
H    0     0                    21541.441066 35625.5144  65.4%     - 1180s
H    0     0                    21579.997086 35625.5144  65.1%     - 1180s
     0     0 35622.8444    0  488 21579.9971 35622.8444  65.1%     - 1183s
     0     0 35620.4940    0  485 21579.9971 35620.4940  65.1%     - 1186s
     0     0 35618.7836    0  500 21579.9971 35618.7836  65.1%     - 1188s
     0     0 35615.8016    0  500 21579.9971 35615.8016  65.0%     - 1192s
     0     0 35615.7343    0  500 21579.9971 35615.7343  65.0%     - 1196s
H    0     0                    21581.436791 35615.7073  65.0%     - 1469s
H    0     0                    21582.968149 35615.7073  65.0%     - 1495s
H    0     0                    22085.199981 35615.7073  61.3%     - 1517s
     0     2 35615.7073    0  500 22085.2000 35615.7073  61.3%     - 1532s
     1     4 35389.0966    1  477 22085.2000 35615.7073  61.3%  7898 1549s
     3     8 35073.6304    2  535 22085.2000 35389.0064  60.2% 10216 1617s
     7    16 34971.6671    3  535 22085.2000 35073.5971  58.8% 17064 1699s
    15    32 34575.4856    4  476 22085.2000 34971.2790  58.3% 20828 1756s
    31    47 32524.2558    5  500 22085.2000 34575.4854  56.6% 26591 3600s

Cutting planes:
  Learned: 2
  Gomory: 17
  Implied bound: 362
  MIR: 3660
  Flow cover: 3347
  RLT: 236
  Relax-and-lift: 1544

Explored 46 nodes (2598359 simplex iterations) in 3600.10 seconds (6281.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 22085.2 21583 21581.4 ... 21077.4

Time limit reached
Best objective 2.208519998089e+04, best bound 3.457548535814e+04, gap 56.5550%
  WARNING: Time limit reached. Using best solution found (gap: 56.56%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.11s
  Master Objective (UB) = 22085.20, θ = 165160.30
  Upper Bound (UB) = 22085.20

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 165160.30
  [DEBUG]   ✓ Scenario 0: θ = 165160.30 ≤ Q = 165160.30 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 165160.30 ≤ Q = 165160.30 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 165160.30 ≤ Q = 165160.30 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 165160.30 ≤ Q = 165160.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 165160.30 ≤ Q = 165160.30 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 165160.30 ≤ Q = 165160.30 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 165160.30 ≤ Q = 165160.30 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 165160.30 ≤ Q = 165160.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 165160.30 ≤ Q = 165160.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 165160.30 ≤ Q = 165160.30 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 165160.30 ≤ Q = 165160.30 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 165160.30 ≤ Q = 165160.30 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 165160.30 ≤ Q = 165160.30 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 13] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x1bad6540
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xe4529ac0
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [3e-01, 2e+02]
Found heuristic solution: objective 1.336175e+13
Presolve removed 2587 rows and 1877 columns
Presolve time: 0.00s
Presolved: 506 rows, 512 columns, 1429 nonzeros
Found heuristic solution: objective 6512412.9686
Variable types: 346 continuous, 166 integer (166 binary)
Found heuristic solution: objective 6512104.3794

Root relaxation: objective -1.563926e+05, 243 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -156392.57    0  122 6512104.38 -156392.57   102%     -    0s
H    0     0                    -110244.9921 -156392.57  41.9%     -    0s
H    0     0                    -110275.3009 -156392.57  41.8%     -    0s
H    0     0                    -123424.7917 -156392.57  26.7%     -    0s
     0     0 -130845.73    0   81 -123424.79 -130845.73  6.01%     -    0s
H    0     0                    -127786.8088 -130830.47  2.38%     -    0s
H    0     0                    -128450.2945 -130830.47  1.85%     -    0s
     0     0 -130262.03    0   56 -128450.29 -130262.03  1.41%     -    0s
H    0     0                    -130198.2154 -130258.60  0.05%     -    0s
H    0     0                    -130204.9738 -130258.60  0.04%     -    0s
     0     0 -130218.16    0    4 -130204.97 -130218.16  0.01%     -    0s

Cutting planes:
  Gomory: 10
  MIR: 157
  Flow cover: 1
  RLT: 2
  Relax-and-lift: 1

Explored 1 nodes (431 simplex iterations) in 0.03 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -130205 -130198 -128450 ... 1.33618e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.302049738409e+05, best bound -1.302151150939e+05, gap 0.0078%
  Subproblem solved in 0.05s
  Worst-case operational profit (Z_SP) = 158914.15
  Scenario: 10 demand increases, 50 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -130204.97
  [DEBUG]   S×d_nominal = 289119.12
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 289119.12 + -130204.97 = 158914.15
  [DEBUG]   Current θ from Master = 165160.30
  [DEBUG]   ⚠️  Z_SP ≤ θ by 6246.15 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 15839.05
  Lower Bound (LB) = 19044.82
  Gap (UB-LB) = 3040.3812, Absolute Gap = 3040.3812, Relative Gap = 0.137666
  Not converged yet (gap = 3040.38 > ε = 200)

  [DEBUG] Adding NEW scenario 13 to Master Problem...
  [DEBUG] New scenario pattern: 10 increases, 50 decreases
    [DEBUG] Scenario 13 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 13 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 13]
    [DEBUG]   - Total constraints in model: 215443
    [DEBUG]   - Total variables in model: 89620
  [DEBUG] Total scenarios in Master: 14
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 14
================================================================================
[Iteration 14] Solving Master Problem...
  Current scenarios in Master: 14
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 215443 rows, 89620 columns and 610921 nonzeros
Model fingerprint: 0x1c8de8f6
Variable types: 87361 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 93444 rows and 37944 columns
Presolve time: 1.97s
Presolved: 121999 rows, 51676 columns, 751158 nonzeros
Variable types: 49417 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -327005.3771
Found heuristic solution: objective -184683.4741

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.28s

Barrier statistics:
 Dense cols : 677
 AA' NZ     : 5.151e+06
 Factor NZ  : 1.230e+07 (roughly 170 MB of memory)
 Factor Ops : 3.672e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.05628412e+07  2.10597080e+08  1.23e+05 1.86e+01  8.54e+04     3s
   1  -1.56296695e+07  1.91700003e+08  8.71e+04 6.73e+01  6.03e+04     3s
   2  -5.83669139e+06  1.46605684e+08  3.22e+04 1.25e+00  2.37e+04     4s
   3  -4.85630681e+06  1.46549152e+08  2.67e+04 1.21e+00  1.97e+04     4s
   4  -1.67734553e+06  1.36383379e+08  6.37e+03 8.84e-01  5.18e+03     4s
   5  -6.75526119e+05  9.44371359e+07  9.20e+02 3.40e-01  1.05e+03     4s
   6  -5.18070775e+05  5.01718202e+07  4.15e+02 1.43e-01  4.79e+02     4s
   7  -3.73984943e+05  3.41674479e+07  1.02e+02 8.84e-02  2.12e+02     4s
   8  -3.10486765e+05  2.23160069e+07  2.72e+01 5.43e-02  1.15e+02     4s
   9  -2.22299323e+05  1.75564719e+07  5.84e+00 4.19e-02  8.22e+01     4s
  10  -1.34673315e+05  9.71231776e+06  1.22e+00 2.35e-02  4.45e+01     4s
  11  -9.20665059e+04  3.96608330e+06  6.11e-01 1.34e-02  1.83e+01     4s
  12  -6.42027384e+04  2.42182217e+06  2.68e-01 5.75e-03  1.12e+01     4s
  13  -3.20908131e+04  7.41723442e+05  7.66e-02 1.48e-03  3.47e+00     4s
  14  -5.95795468e+03  3.48567706e+05  3.69e-02 6.01e-04  1.59e+00     4s
  15   3.66899575e+01  2.16902780e+05  3.10e-02 4.53e-04  9.73e-01     4s
  16   1.21384014e+04  1.75701616e+05  2.12e-02 4.82e-04  7.34e-01     4s
  17   1.56640646e+04  1.33239983e+05  1.88e-02 1.06e-03  5.28e-01     4s
  18   2.07442630e+04  1.14029644e+05  1.57e-02 1.02e-03  4.19e-01     4s
  19   2.76210068e+04  8.72680486e+04  1.17e-02 2.41e-03  2.68e-01     4s
  20   3.16926432e+04  7.88689241e+04  9.37e-03 1.89e-03  2.12e-01     4s
  21   3.57684154e+04  6.87240906e+04  7.19e-03 1.20e-03  1.48e-01     4s
  22   3.88541496e+04  6.40093040e+04  5.68e-03 9.46e-04  1.13e-01     5s
  23   4.10536622e+04  6.13486108e+04  4.54e-03 7.61e-04  9.11e-02     5s
  24   4.20375282e+04  5.76665029e+04  4.08e-03 4.77e-04  7.01e-02     5s
  25   4.45152162e+04  5.61174768e+04  2.93e-03 3.59e-04  5.21e-02     5s
  26   4.58948601e+04  5.48065393e+04  2.31e-03 2.61e-04  4.00e-02     5s
  27   4.72537670e+04  5.36087388e+04  1.71e-03 1.68e-04  2.85e-02     5s
  28   4.82299801e+04  5.30048484e+04  1.29e-03 1.21e-04  2.14e-02     5s
  29   4.86060048e+04  5.26046007e+04  1.14e-03 9.28e-05  1.79e-02     5s
  30   4.87956507e+04  5.25207025e+04  1.06e-03 8.67e-05  1.67e-02     5s
  31   4.90240110e+04  5.24200259e+04  9.65e-04 7.93e-05  1.52e-02     5s
  32   4.90746925e+04  5.23222803e+04  9.43e-04 7.26e-05  1.46e-02     5s
  33   4.93155673e+04  5.20893771e+04  8.33e-04 5.62e-05  1.24e-02     5s
  34   4.94749688e+04  5.20340624e+04  7.66e-04 5.24e-05  1.15e-02     5s
  35   4.97274878e+04  5.19333297e+04  6.60e-04 4.47e-05  9.90e-03     5s
  36   5.00126895e+04  5.18117588e+04  5.36e-04 3.61e-05  8.07e-03     6s
  37   5.03223288e+04  5.15472663e+04  4.00e-04 1.77e-05  5.50e-03     6s
  38   5.06812757e+04  5.14333829e+04  2.50e-04 9.86e-06  3.38e-03     6s
  39   5.08355784e+04  5.13615015e+04  1.85e-04 4.97e-06  2.36e-03     6s
  40   5.09329760e+04  5.13347383e+04  1.42e-04 3.43e-06  1.80e-03     6s
  41   5.09867980e+04  5.13196055e+04  1.19e-04 2.44e-06  1.49e-03     6s
  42   5.10356499e+04  5.13139393e+04  9.86e-05 1.99e-06  1.25e-03     6s
  43   5.11998672e+04  5.12885480e+04  2.93e-05 5.36e-07  3.98e-04     6s
  44   5.12267486e+04  5.12818342e+04  1.88e-05 1.71e-07  2.47e-04     6s
  45   5.12611589e+04  5.12796158e+04  5.54e-06 1.86e-07  8.28e-05     6s
  46   5.12700711e+04  5.12774590e+04  2.40e-06 3.38e-08  3.32e-05     6s
  47   5.12705395e+04  5.12772943e+04  2.24e-06 2.32e-08  3.03e-05     6s
  48   5.12736340e+04  5.12770836e+04  1.14e-06 8.01e-09  1.55e-05     6s
  49   5.12750811e+04  5.12770087e+04  6.87e-07 2.04e-09  8.65e-06     6s
  50   5.12760609e+04  5.12769797e+04  3.49e-07 1.58e-06  4.12e-06     6s
  51   5.12768372e+04  5.12769742e+04  3.35e-07 3.24e-07  6.15e-07     6s
  52   5.12769108e+04  5.12769739e+04  1.73e-06 4.36e-09  2.83e-07     7s
  53   5.12769294e+04  5.12769739e+04  1.32e-06 1.95e-09  2.00e-07     7s
  54   5.12769512e+04  5.12769739e+04  6.74e-07 9.84e-10  1.02e-07     7s
  55   5.12769735e+04  5.12769739e+04  4.41e-07 1.00e-09  1.61e-09     7s

Barrier solved model in 55 iterations and 6.76 seconds (12.65 work units)
Optimal objective 5.12769735e+04


Root crossover log...

   99661 DPushes remaining with DInf 0.0000000e+00                 7s
   15602 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                12s

   15788 PPushes remaining with PInf 7.5500464e-05                12s
       0 PPushes remaining with PInf 0.0000000e+00                14s

  Push phase complete: Pinf 0.0000000e+00, Dinf 9.1864366e+05     14s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   69873    5.1276974e+04   0.000000e+00   9.186437e+05     14s
   70401    5.1276974e+04   0.000000e+00   0.000000e+00     14s
   70401    5.1276974e+04   0.000000e+00   0.000000e+00     14s
Concurrent spin time: 3.56s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 5.127697e+04, 70401 iterations, 15.30 seconds (30.57 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 51276.9739    0  380 -184683.47 51276.9739   128%     -   18s
H    0     0                    -180113.2797 51276.9739   128%     -   18s
H    0     0                    -70128.96788 51276.9739   173%     -   19s
H    0     0                    -67491.94361 51276.9739   176%     -   19s
H    0     0                    -67481.01867 51276.9739   176%     -   19s
H    0     0                    -22663.98547 51276.9739   326%     -   19s
H    0     0                    -21373.27018 51276.9739   340%     -   19s
H    0     0                    -18265.12145 51276.9739   381%     -   19s
H    0     0                    -17046.95477 51276.9739   401%     -   19s
H    0     0                    -17001.85265 51276.9739   402%     -   19s
H    0     0                    -16911.44081 51276.9739   403%     -   19s
H    0     0                    -16846.50018 51276.9739   404%     -   19s
H    0     0                    -3605.777735 51276.9739  1522%     -   21s
H    0     0                    -815.8292627 51276.9739  6385%     -   21s
H    0     0                    -541.8526853 51276.9739  9563%     -   21s
H    0     0                    -522.7693939 51276.9739  9909%     -   21s
H    0     0                     -63.3810587 44864.2294      -     -   66s
     0     0 44864.2294    0  345  -63.38106 44864.2294      -     -   66s
     0     0 43843.3540    0  348  -63.38106 43843.3540      -     -   93s
     0     0 43683.2941    0  365  -63.38106 43683.2941      -     -  106s
     0     0 43567.2285    0  369  -63.38106 43567.2285      -     -  111s
     0     0 43567.2285    0  375  -63.38106 43567.2285      -     -  113s
     0     0 43481.8775    0  372  -63.38106 43481.8775      -     -  123s
     0     0 43442.8231    0  380  -63.38106 43442.8231      -     -  125s
     0     0 43431.6304    0  368  -63.38106 43431.6304      -     -  127s
     0     0 43431.6304    0  370  -63.38106 43431.6304      -     -  131s
     0     0 43431.6304    0  362  -63.38106 43431.6304      -     -  138s
     0     0 43431.6304    0  367  -63.38106 43431.6304      -     -  142s
     0     0 43431.6304    0  352  -63.38106 43431.6304      -     -  148s
     0     0 43431.6304    0  363  -63.38106 43431.6304      -     -  149s
     0     0 43431.6304    0  351  -63.38106 43431.6304      -     -  154s
     0     0 43431.6304    0  363  -63.38106 43431.6304      -     -  156s
     0     0 43431.6304    0  390  -63.38106 43431.6304      -     -  159s
     0     0 43429.6675    0  378  -63.38106 43429.6675      -     -  161s
     0     0 43428.1173    0  372  -63.38106 43428.1173      -     -  162s
     0     0 43427.9911    0  375  -63.38106 43427.9911      -     -  162s
H    0     0                    1039.3736525 40968.7409  3842%     -  211s
H    0     0                    1076.7045509 40968.7409  3705%     -  211s
H    0     0                    1354.8295014 40968.7409  2924%     -  211s
H    0     0                    1595.6278970 40968.7409  2468%     -  211s
H    0     0                    1638.5197508 40968.7409  2400%     -  211s
     0     0 40968.7383    0  398 1638.51975 40968.7383  2400%     -  211s
H    0     0                    2234.7515102 40968.7383  1733%     -  211s
H    0     0                    3008.1673085 40968.7383  1262%     -  213s
H    0     0                    4420.1676196 40968.7383   827%     -  213s
H    0     0                    4420.3993403 40968.7383   827%     -  213s
H    0     0                    4495.4571621 40968.7383   811%     -  213s
     0     0 40018.2099    0  398 4495.45716 40018.2099   790%     -  252s
     0     0 39754.9656    0  413 4495.45716 39754.9656   784%     -  274s
     0     0 39645.7069    0  390 4495.45716 39645.7069   782%     -  288s
     0     0 39583.5954    0  428 4495.45716 39583.5954   781%     -  303s
     0     0 39515.7414    0  443 4495.45716 39515.7414   779%     -  314s
H    0     0                    5423.0345301 39492.1287   628%     -  320s
H    0     0                    6527.3550201 39492.1287   505%     -  320s
H    0     0                    7267.5032042 39492.1287   443%     -  320s
     0     0 39492.1287    0  453 7267.50320 39492.1287   443%     -  320s
     0     0 39457.3753    0  455 7267.50320 39457.3753   443%     -  326s
     0     0 39448.7838    0  452 7267.50320 39448.7838   443%     -  328s
H    0     0                    8498.3693849 39428.6720   364%     -  333s
H    0     0                    8654.3699138 39428.6720   356%     -  333s
H    0     0                    8885.4727708 39428.6720   344%     -  333s
     0     0 39428.6720    0  451 8885.47277 39428.6720   344%     -  333s
     0     0 39424.4723    0  416 8885.47277 39424.4723   344%     -  336s
     0     0 39420.9763    0  421 8885.47277 39420.9763   344%     -  339s
     0     0 39419.4896    0  421 8885.47277 39419.4896   344%     -  341s
     0     0 39418.6768    0  422 8885.47277 39418.6768   344%     -  342s
H    0     0                    9261.5420633 37638.5114   306%     -  402s
H    0     0                    9275.4164826 37638.5114   306%     -  402s
H    0     0                    9328.9717693 37638.5114   303%     -  402s
H    0     0                    9467.0426350 37638.5114   298%     -  402s
     0     0 37638.5114    0  506 9467.04263 37638.5114   298%     -  402s
H    0     0                    9726.5371927 37638.2764   287%     -  403s
H    0     0                    9808.4155367 37429.2258   282%     -  424s
H    0     0                    9884.1121671 37429.2258   279%     -  424s
     0     0 37429.2258    0  500 9884.11217 37429.2258   279%     -  424s
     0     0 37377.6567    0  506 9884.11217 37377.6567   278%     -  434s
     0     0 37304.0106    0  502 9884.11217 37304.0106   277%     -  443s
     0     0 37253.5711    0  495 9884.11217 37253.5711   277%     -  453s
     0     0 37192.3705    0  500 9884.11217 37192.3705   276%     -  461s
     0     0 37175.9205    0  506 9884.11217 37175.9205   276%     -  465s
     0     0 37165.7658    0  480 9884.11217 37165.7658   276%     -  468s
     0     0 37151.9495    0  474 9884.11217 37151.9495   276%     -  474s
     0     0 37150.5653    0  474 9884.11217 37150.5653   276%     -  475s
     0     0 36627.4647    0  467 9884.11217 36627.4647   271%     -  508s
H    0     0                    10229.806052 36627.2782   258%     -  510s
H    0     0                    10872.829001 36627.2782   237%     -  510s
H    0     0                    11153.611267 36627.2782   228%     -  510s
H    0     0                    11155.451330 36627.2782   228%     -  510s
     0     0 36417.7819    0  472 11155.4513 36417.7819   226%     -  528s
     0     0 36342.2915    0  478 11155.4513 36342.2915   226%     -  540s
     0     0 36290.3252    0  475 11155.4513 36290.3252   225%     -  548s
     0     0 36220.0687    0  478 11155.4513 36220.0687   225%     -  560s
     0     0 36194.3709    0  481 11155.4513 36194.3709   224%     -  564s
     0     0 36182.0275    0  482 11155.4513 36182.0275   224%     -  568s
     0     0 36176.7545    0  501 11155.4513 36176.7545   224%     -  570s
     0     0 36174.0269    0  497 11155.4513 36174.0269   224%     -  571s
     0     0 36172.8161    0  503 11155.4513 36172.8161   224%     -  572s
     0     0 36087.7501    0  473 11155.4513 36087.7501   223%     -  587s
H    0     0                    11290.241180 36087.5698   220%     -  587s
H    0     0                    11362.110696 36087.5698   218%     -  587s
     0     0 36072.0061    0  485 11362.1107 36072.0061   217%     -  592s
     0     0 36061.3132    0  491 11362.1107 36061.3132   217%     -  595s
     0     0 36052.9741    0  487 11362.1107 36052.9741   217%     -  599s
     0     0 36020.7037    0  493 11362.1107 36020.7037   217%     -  602s
     0     0 36014.1529    0  496 11362.1107 36014.1529   217%     -  605s
     0     0 36012.0510    0  493 11362.1107 36012.0510   217%     -  607s
     0     0 35881.9457    0  541 11362.1107 35881.9457   216%     -  630s
H    0     0                    11404.546887 35881.8393   215%     -  631s
     0     0 35852.5832    0  489 11404.5469 35852.5832   214%     -  640s
     0     0 35847.9150    0  499 11404.5469 35847.9150   214%     -  642s
     0     0 35846.4723    0  502 11404.5469 35846.4723   214%     -  644s
     0     0 35817.6355    0  543 11404.5469 35817.6355   214%     -  654s
     0     0 35809.4361    0  526 11404.5469 35809.4361   214%     -  659s
     0     0 35800.4399    0  538 11404.5469 35800.4399   214%     -  662s
     0     0 35797.5620    0  541 11404.5469 35797.5620   214%     -  663s
     0     0 35791.6689    0  545 11404.5469 35791.6689   214%     -  666s
     0     0 35789.2049    0  536 11404.5469 35789.2049   214%     -  668s
     0     0 35788.3541    0  543 11404.5469 35788.3541   214%     -  670s
     0     0 35767.6126    0  493 11404.5469 35767.6126   214%     -  680s
H    0     0                    11482.095484 35767.6058   212%     -  680s
     0     0 35758.6916    0  555 11482.0955 35758.6916   211%     -  685s
     0     0 35756.5084    0  541 11482.0955 35756.5084   211%     -  687s
     0     0 35742.7704    0  531 11482.0955 35742.7704   211%     -  693s
H    0     0                    11488.360640 35742.6408   211%     -  694s
     0     0 35738.0380    0  541 11488.3606 35738.0380   211%     -  699s
     0     0 35735.3543    0  547 11488.3606 35735.3543   211%     -  702s
     0     0 35734.8554    0  553 11488.3606 35734.8554   211%     -  703s
     0     0 35729.3720    0  550 11488.3606 35729.3720   211%     -  708s
H    0     0                    11553.591104 35729.2770   209%     -  709s
H    0     0                    11554.366198 35729.2770   209%     -  709s
H    0     0                    11568.442783 35729.2770   209%     -  709s
     0     0 35727.6965    0  555 11568.4428 35727.6965   209%     -  710s
     0     0 35712.9058    0  542 11568.4428 35712.9058   209%     -  717s
H    0     0                    11636.605832 35712.7580   207%     -  718s
     0     0 35711.5915    0  553 11636.6058 35711.5915   207%     -  720s
     0     0 35710.6645    0  549 11636.6058 35710.6645   207%     -  722s
     0     0 35710.6179    0  549 11636.6058 35710.6179   207%     -  728s
H    0     0                    11859.417944 35710.6179   201%     -  901s
H    0     0                    12983.294877 35710.6179   175%     -  907s
H    0     0                    16774.506355 35710.6179   113%     -  907s
H    0     0                    16804.845154 35710.6179   113%     -  910s
H    0     0                    16864.781879 35710.6179   112%     -  910s
H    0     0                    17224.448983 35710.6179   107%     -  910s
H    0     0                    17269.696037 35710.6179   107%     -  910s
H    0     0                    17283.354629 35710.6179   107%     -  910s
H    0     0                    17285.272374 35710.6179   107%     -  910s
H    0     2                    18457.364360 35710.6179  93.5%     -  911s
     0     2 35710.6179    0  549 18457.3644 35710.6179  93.5%     -  911s
     1     3 35279.8956    1  441 18457.3644 35710.6179  93.5% 10425  926s
     2     4 35516.6275    1  474 18457.3644 35516.6275  92.4% 10055  940s
     3     6 35016.5887    2  463 18457.3644 35516.4256  92.4%  9584  960s
     5    11 34652.6471    3  495 18457.3644 35516.4256  92.4% 10791  980s
    10    21 34550.1391    4  458 18457.3644 35179.3672  90.6% 10020 1015s
    20    31 34430.9912    4  509 18457.3644 35179.3532  90.6% 14987 1085s
H   30    59                    19147.226966 35108.6514  83.4% 14682 1346s
H   36    59                    19188.557193 35108.6514  83.0% 14291 1347s
H   39    59                    19300.087776 35108.6514  81.9% 14427 1347s
H   44    59                    19628.601742 35108.6514  78.9% 13506 1347s
    58    91 33123.7791    5  460 19628.6017 35108.6514  78.9% 24392 1396s
H   90   126                    19632.523435 35108.6514  78.8% 19745 1431s
H   95   126                    21215.882153 35108.6514  65.5% 19179 1431s
H   97   126                    21560.459465 35108.6514  62.8% 19067 1431s
H   99   126                    21568.538783 35108.6514  62.8% 18915 1431s
H  111   126                    21649.584279 35108.6514  62.2% 17870 1431s
H  118   126                    21654.784186 35108.6514  62.1% 17374 1431s
   125   225 33075.0848    7  466 21654.7842 35108.6514  62.1% 16939 1477s
   224   297 33074.2597    8  461 21654.7842 35108.6514  62.1% 11445 1507s
H  249   297                    21656.223891 35108.6514  62.1% 10674 1507s
   296   369 32909.5094    9  442 21656.2239 35108.6514  62.1% 10031 1534s
   368   418 32867.8033   10  437 21656.2239 35108.6514  62.1%  9118 1562s
   417   468 32654.7230   11  424 21656.2239 35108.6514  62.1%  8606 1586s
   467   519 32740.1381   11  437 21656.2239 35108.6514  62.1%  8460 1611s
   518   572 32417.5931   12  428 21656.2239 35108.6514  62.1%  8443 1634s
   581   593 28744.4845   23  160 21656.2239 35108.6514  62.1%  8228 1655s
H  585   593                    21660.145585 35108.6514  62.1%  8213 1655s
   604   651 28604.3481   24  163 21660.1456 35108.6514  62.1%  8265 1681s
   664   676 31633.8643   13  419 21660.1456 35108.6514  62.1%  8006 1714s
   689   725 28232.1293   28  141 21660.1456 35108.6514  62.1%  8017 1734s
   738   751 31485.6391   14  416 21660.1456 35108.6514  62.1%  7798 1754s
   768   810 27512.6376   34  116 21660.1456 35108.6514  62.1%  7746 1773s
   830   875 25302.7287   36  105 21660.1456 35108.6514  62.1%  7464 1794s
   926   939 27976.6244   17  159 21660.1456 35108.6514  62.1%  7150 1818s
  1039   957 27864.5745   18  135 21660.1456 35108.6514  62.1%  6795 1840s
  1079   986 27631.9661   19  129 21660.1456 35108.6514  62.1%  6706 1863s
  1142  1067 27436.1640   20  106 21660.1456 35108.6514  62.1%  6517 1888s
  1264  1124 27396.6843   21  110 21660.1456 35108.6514  62.1%  6173 1915s
  1396  1213 25814.8785   29   61 21660.1456 35108.6514  62.1%  5925 1942s
  1556  1291 25372.0340   38   47 21660.1456 35108.6514  62.1%  5697 1970s
  1704  1346 21835.3406   46   15 21660.1456 35108.6514  62.1%  5507 2000s
  1856  1354 infeasible   52      21660.1456 35108.6514  62.1%  5259 2031s
  1962  1370 28235.8907   13  142 21660.1456 35108.6514  62.1%  5248 2065s
  2017  1376 infeasible   15      21660.1456 35108.6514  62.1%  5323 2103s
  2067  1390 30211.2131   15  387 21660.1456 35108.6514  62.1%  5428 2138s
  2093  1414 28743.4869   11  127 21660.1456 35108.6514  62.1%  5511 2170s
  2125  1448 27770.4597    9  411 21660.1456 35108.6514  62.1%  5618 2203s
  2191  1473 27587.6365   10  418 21660.1456 35108.6514  62.1%  5673 2236s
  2256  1499 27389.7634   11  314 21660.1456 35108.6514  62.1%  5787 2272s
  2330  1522 27249.4157   12  315 21660.1456 35108.6514  62.1%  5926 2307s
  2405  1546 26062.6596   12  236 21660.1456 35108.6514  62.1%  6000 2345s
  2473  1573 25564.1019   13  247 21660.1456 35108.6514  62.1%  6106 2385s
  2526  1606 25467.4811   14  243 21660.1456 35108.6514  62.1%  6281 2424s
  2579  1648 25433.6369   15  255 21660.1456 35108.6514  62.1%  6424 2471s
  2653  1708 24853.9802   18  360 21660.1456 35108.6514  62.1%  6600 2514s
H 2678  1708                    21880.185386 35108.6514  60.5%  6619 2514s
  2762  1735     cutoff   23      21880.1854 35108.6514  60.5%  6655 2562s
  2868  1793 infeasible   32      21880.1854 34981.5199  59.9%  6704 2614s
H 2939  1788                    21905.121221 34981.4945  59.7%  6753 2614s
  2982  1850 34254.2338    5  474 21905.1212 34981.2367  59.7%  6774 2669s
  3111  1874 infeasible   31      21905.1212 34981.2367  59.7%  6757 2722s
  3192  1922 28060.4000    6  441 21905.1212 34981.2367  59.7%  6892 2779s
  3262  1974 26177.9296    7  414 21905.1212 34981.2367  59.7%  7106 2834s
  3350  2005 25555.4952    9  419 21905.1212 34981.2367  59.7%  7214 2890s
  3431  2044 25464.6864   10  371 21905.1212 34981.2367  59.7%  7375 2947s
  3542  2089 25409.9520    9  405 21905.1212 34141.5268  55.9%  7553 3005s
H 3543  2077                    22011.603029 34141.5268  55.1%  7551 3005s
H 3595  2036                    22131.985163 34141.5268  54.3%  7628 3005s
  3635  2061 25040.2718   10  378 22131.9852 34141.5268  54.3%  7702 3057s
  3706  2111 24952.0103   11  337 22131.9852 34141.5268  54.3%  7776 3117s
  3805  2145 24530.9149   12  315 22131.9852 33878.4127  53.1%  7872 3179s
  3901  2191 24460.4455   13  304 22131.9852 33878.4127  53.1%  7998 3251s
  4017  2245 24408.3724   14  299 22131.9852 33878.4127  53.1%  8177 3323s
  4164  2299 22990.5877   18  200 22131.9852 33878.4127  53.1%  8286 3403s
  4333  2376 infeasible   21      22131.9852 33865.8457  53.0%  8350 3476s
  4502  2478 26565.3878   15  385 22131.9852 33821.2420  52.8%  8432 3561s

Cutting planes:
  Learned: 3
  Gomory: 7
  Implied bound: 186
  MIR: 3364
  Flow cover: 3263
  RLT: 98
  Relax-and-lift: 551

Explored 4684 nodes (40481869 simplex iterations) in 3600.07 seconds (9158.86 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 22132 22011.6 21905.1 ... 21560.5

Time limit reached
Best objective 2.213198516282e+04, best bound 3.375042063465e+04, gap 52.4961%
  WARNING: Time limit reached. Using best solution found (gap: 52.50%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.11s
  Master Objective (UB) = 22131.99, θ = 165290.30
  Upper Bound (UB) = 22131.99

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 165290.30
  [DEBUG]   ✓ Scenario 0: θ = 165290.30 ≤ Q = 165290.30 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 165290.30 ≤ Q = 165290.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 165290.30 ≤ Q = 165290.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 165290.30 ≤ Q = 165290.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 165290.30 ≤ Q = 165290.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 165290.30 ≤ Q = 165290.30 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 165290.30 ≤ Q = 165290.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 165290.30 ≤ Q = 165290.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 165290.30 ≤ Q = 165290.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 165290.30 ≤ Q = 165290.30 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 165290.30 ≤ Q = 165290.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 165290.30 ≤ Q = 165290.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 165290.30 ≤ Q = 165290.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 165290.30 ≤ Q = 165290.30 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 14] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x4f0ed604
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xb0f129fc
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [5e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [3e-01, 2e+02]
Found heuristic solution: objective 1.340868e+13
Presolve removed 2593 rows and 1882 columns
Presolve time: 0.00s
Presolved: 500 rows, 507 columns, 1413 nonzeros
Found heuristic solution: objective 6453377.1120
Variable types: 342 continuous, 165 integer (165 binary)
Found heuristic solution: objective 6452639.5080

Root relaxation: objective -1.564486e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -156448.63    0  119 6452639.51 -156448.63   102%     -    0s
H    0     0                    -113800.8294 -156448.63  37.5%     -    0s
H    0     0                    -121749.1854 -156448.63  28.5%     -    0s
     0     0 -132579.56    0   55 -121749.19 -132579.56  8.90%     -    0s
H    0     0                    -130594.9473 -132491.81  1.45%     -    0s
H    0     0                    -131254.4607 -132491.81  0.94%     -    0s
     0     0 -131883.95    0   35 -131254.46 -131883.95  0.48%     -    0s
H    0     0                    -131600.1171 -131847.04  0.19%     -    0s
     0     0 -131842.43    0   23 -131600.12 -131842.43  0.18%     -    0s
     0     0 -131832.88    0   18 -131600.12 -131832.88  0.18%     -    0s
     0     0 -131823.90    0   16 -131600.12 -131823.90  0.17%     -    0s
     0     0 -131785.53    0   20 -131600.12 -131785.53  0.14%     -    0s
     0     0 -131781.49    0   19 -131600.12 -131781.49  0.14%     -    0s
     0     0 -131781.45    0   19 -131600.12 -131781.45  0.14%     -    0s
     0     0 -131729.23    0   12 -131600.12 -131729.23  0.10%     -    0s
     0     0 -131729.23    0   37 -131600.12 -131729.23  0.10%     -    0s
     0     0 -131674.58    0    5 -131600.12 -131674.58  0.06%     -    0s
H    0     0                    -131663.3462 -131672.57  0.01%     -    0s

Cutting planes:
  Gomory: 3
  Implied bound: 1
  MIR: 26
  Flow cover: 7
  Relax-and-lift: 2

Explored 1 nodes (674 simplex iterations) in 0.08 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -131663 -131600 -131254 ... 1.34087e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.316633462378e+05, best bound -1.316725716535e+05, gap 0.0070%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 157346.57
  Scenario: 19 demand increases, 41 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -131663.35
  [DEBUG]   S×d_nominal = 289009.92
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 289009.92 + -131663.35 = 157346.57
  [DEBUG]   Current θ from Master = 165290.30
  [DEBUG]   ⚠️  Z_SP ≤ θ by 7943.73 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 14188.26
  Lower Bound (LB) = 19044.82
  Gap (UB-LB) = 3087.1664, Absolute Gap = 3087.1664, Relative Gap = 0.139489
  Not converged yet (gap = 3087.17 > ε = 200)

  [DEBUG] Adding NEW scenario 14 to Master Problem...
  [DEBUG] New scenario pattern: 19 increases, 41 decreases
    [DEBUG] Scenario 14 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 14 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 14]
    [DEBUG]   - Total constraints in model: 230733
    [DEBUG]   - Total variables in model: 95860
  [DEBUG] Total scenarios in Master: 15
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 15
================================================================================
[Iteration 15] Solving Master Problem...
  Current scenarios in Master: 15
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 230733 rows, 95860 columns and 654164 nonzeros
Model fingerprint: 0x9511d09f
Variable types: 93601 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 100130 rows and 40660 columns
Presolve time: 2.20s
Presolved: 130603 rows, 55200 columns, 804278 nonzeros
Variable types: 52941 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -327005.3771
Found heuristic solution: objective -184683.4741

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.16s

Barrier statistics:
 Dense cols : 677
 AA' NZ     : 5.825e+06
 Factor NZ  : 1.301e+07 (roughly 180 MB of memory)
 Factor Ops : 2.854e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.11248450e+07  2.23429090e+08  1.26e+05 1.83e+01  8.72e+04     5s
   1  -1.61873651e+07  2.04100251e+08  8.96e+04 6.62e+01  6.15e+04     5s
   2  -5.97314395e+06  1.54081864e+08  3.27e+04 4.13e+00  2.39e+04     5s
   3  -1.56672064e+06  1.25352980e+08  4.86e+03 1.37e+00  3.93e+03     5s
   4  -7.56436571e+05  8.59820026e+07  7.42e+02 6.34e-01  8.50e+02     5s
   5  -5.29252217e+05  4.62483318e+07  3.75e+02 2.78e-01  4.18e+02     5s
   6  -4.01127229e+05  3.62514755e+07  1.50e+02 2.05e-01  2.38e+02     5s
   7  -3.68422291e+05  2.63883798e+07  9.26e+01 1.39e-01  1.60e+02     5s
   8  -2.68898070e+05  1.78191184e+07  2.34e+01 8.85e-02  8.60e+01     5s
   9  -1.72045417e+05  1.32080805e+07  4.99e+00 6.39e-02  5.79e+01     5s
  10  -1.15954698e+05  6.16899409e+06  2.67e+00 2.90e-02  2.68e+01     5s
  11  -8.41736131e+04  1.68551719e+06  1.13e+00 7.39e-03  7.49e+00     5s
  12  -3.82228720e+04  5.30629945e+05  3.47e-01 2.22e-03  2.39e+00     5s
  13  -7.76150962e+03  3.26721874e+05  1.77e-01 1.52e-03  1.41e+00     5s
  14   1.92902818e+02  2.08097841e+05  1.39e-01 1.77e-03  8.73e-01     5s
  15   9.21515945e+03  1.38955399e+05  1.11e-01 3.17e-03  5.45e-01     5s
  16   1.63807811e+04  1.06469234e+05  9.09e-02 2.96e-03  3.79e-01     5s
  17   2.31857132e+04  9.17062124e+04  7.22e-02 2.45e-03  2.88e-01     6s
  18   2.89353222e+04  8.27365266e+04  5.61e-02 1.91e-03  2.26e-01     6s
  19   3.38984467e+04  7.03418537e+04  4.21e-02 3.63e-03  1.53e-01     6s
  20   3.73533869e+04  6.55834843e+04  3.30e-02 3.41e-03  1.19e-01     6s
  21   3.91552499e+04  6.14031714e+04  2.82e-02 2.87e-03  9.36e-02     6s
  22   4.15827673e+04  5.87004849e+04  2.23e-02 2.22e-03  7.20e-02     6s
  23   4.35595807e+04  5.65869695e+04  1.74e-02 1.58e-03  5.48e-02     6s
  24   4.47769981e+04  5.46550422e+04  1.46e-02 1.04e-03  4.16e-02     6s
  25   4.62708486e+04  5.35663647e+04  1.11e-02 6.80e-04  3.07e-02     6s
  26   4.75933275e+04  5.29088659e+04  8.09e-03 4.59e-04  2.24e-02     6s
  27   4.86507048e+04  5.27188559e+04  5.85e-03 4.00e-04  1.71e-02     6s
  28   4.89790407e+04  5.25711235e+04  5.11e-03 3.57e-04  1.51e-02     6s
  29   4.92753400e+04  5.24385260e+04  4.46e-03 3.19e-04  1.33e-02     6s
  30   4.95473245e+04  5.21192108e+04  3.82e-03 2.37e-04  1.08e-02     6s
  31   4.96979277e+04  5.20427338e+04  3.49e-03 2.14e-04  9.87e-03     6s
  32   5.00092048e+04  5.19317061e+04  2.80e-03 1.82e-04  8.09e-03     7s
  33   5.01060709e+04  5.18858328e+04  2.58e-03 1.69e-04  7.49e-03     7s
  34   5.02934340e+04  5.16577739e+04  2.14e-03 1.44e-04  5.74e-03     7s
  35   5.05147572e+04  5.14886367e+04  1.65e-03 8.14e-05  4.10e-03     7s
  36   5.07379632e+04  5.13952488e+04  1.16e-03 4.28e-05  2.77e-03     7s
  37   5.07750665e+04  5.13471402e+04  1.08e-03 2.57e-05  2.41e-03     7s
  38   5.09290098e+04  5.13276831e+04  7.45e-04 1.86e-05  1.68e-03     7s
  39   5.09710798e+04  5.13226607e+04  6.53e-04 1.64e-05  1.48e-03     7s
  40   5.11412673e+04  5.12909365e+04  2.68e-04 3.08e-05  6.30e-04     7s
  41   5.12453632e+04  5.12826199e+04  5.18e-05 2.83e-05  1.57e-04     7s
  42   5.12503481e+04  5.12812267e+04  4.33e-05 2.12e-05  1.30e-04     7s
  43   5.12674908e+04  5.12797064e+04  1.48e-05 1.29e-05  5.14e-05     7s
  44   5.12747691e+04  5.12772783e+04  3.08e-06 8.65e-07  1.06e-05     7s
  45   5.12758980e+04  5.12770165e+04  1.43e-06 4.51e-08  4.71e-06     8s
  46   5.12769162e+04  5.12769758e+04  1.62e-07 1.30e-09  2.51e-07     8s
  47   5.12769163e+04  5.12769758e+04  3.02e-06 1.31e-09  2.50e-07     8s
  48   5.12769181e+04  5.12769758e+04  3.89e-06 2.44e-09  2.46e-07     8s
  49   5.12769507e+04  5.12769739e+04  1.25e-06 8.85e-08  9.85e-08     8s
  50   5.12769730e+04  5.12769739e+04  4.77e-07 2.65e-09  3.69e-09     8s
  51   5.12769736e+04  5.12769739e+04  1.56e-07 8.59e-10  1.21e-09     8s

Barrier solved model in 51 iterations and 7.92 seconds (13.38 work units)
Optimal objective 5.12769736e+04


Root crossover log...

  106568 DPushes remaining with DInf 0.0000000e+00                 8s
   49880 DPushes remaining with DInf 0.0000000e+00                10s
   19560 DPushes remaining with DInf 0.0000000e+00                15s
    1079 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                21s

   14700 PPushes remaining with PInf 8.5590494e-05                21s
       0 PPushes remaining with PInf 0.0000000e+00                22s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.2126398e+04     22s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   70180    5.1276974e+04   0.000000e+00   1.212640e+04     22s
   70522    5.1276974e+04   0.000000e+00   0.000000e+00     23s
   70522    5.1276974e+04   0.000000e+00   0.000000e+00     23s
Concurrent spin time: 0.02s

Solved with barrier

Root relaxation: objective 5.127697e+04, 70522 iterations, 20.18 seconds (34.42 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 51276.9739    0  380 -184683.47 51276.9739   128%     -   23s
H    0     0                    -180113.2797 51276.9739   128%     -   23s
H    0     0                    -177568.9689 51276.9739   129%     -   24s
H    0     0                    -176702.7910 51276.9739   129%     -   24s
H    0     0                    -145499.9243 51276.9739   135%     -   25s
H    0     0                    -143370.3975 51276.9739   136%     -   25s
H    0     0                    -70128.96788 51276.9739   173%     -   25s
H    0     0                    -67491.94361 51276.9739   176%     -   25s
H    0     0                    -67481.01867 51276.9739   176%     -   26s
H    0     0                    -22663.98547 51276.9739   326%     -   26s
H    0     0                    -18642.02964 51276.9739   375%     -   26s
H    0     0                    -17046.95477 51276.9739   401%     -   26s
H    0     0                    -16911.44081 51276.9739   403%     -   26s
H    0     0                    -16846.50018 51276.9739   404%     -   26s
H    0     0                    -4241.392348 51276.9739  1309%     -   29s
H    0     0                    -815.8292627 51276.9739  6385%     -   29s
H    0     0                    -685.0824533 51276.9739  7585%     -   29s
H    0     0                    -541.8526853 51276.9739  9563%     -   29s
H    0     0                    -522.7693939 51276.9739  9909%     -   29s
     0     0 44830.1566    0  360 -522.76939 44830.1566  8676%     -   82s
H    0     0                    1239.2763205 44830.1566  3517%     -   83s
H    0     0                    1596.9287940 44830.1566  2707%     -   83s
H    0     0                    1652.1773070 44830.1566  2613%     -   83s
     0     0 43693.8820    0  342 1652.17731 43693.8820  2545%     -  124s
     0     0 43658.4329    0  364 1652.17731 43658.4329  2542%     -  135s
     0     0 43658.4329    0  363 1652.17731 43658.4329  2542%     -  139s
     0     0 43658.4329    0  373 1652.17731 43658.4329  2542%     -  140s
     0     0 43500.0528    0  372 1652.17731 43500.0528  2533%     -  148s
     0     0 43414.2073    0  363 1652.17731 43414.2073  2528%     -  159s
     0     0 43312.7241    0  366 1652.17731 43312.7241  2522%     -  167s
     0     0 43231.7995    0  380 1652.17731 43231.7995  2517%     -  176s
     0     0 43230.1047    0  373 1652.17731 43230.1047  2517%     -  178s
     0     0 43230.1047    0  376 1652.17731 43230.1047  2517%     -  180s
     0     0 43230.1047    0  378 1652.17731 43230.1047  2517%     -  184s
     0     0 43230.1047    0  376 1652.17731 43230.1047  2517%     -  191s
     0     0 43230.1047    0  379 1652.17731 43230.1047  2517%     -  195s
     0     0 43230.1047    0  372 1652.17731 43230.1047  2517%     -  199s
     0     0 43230.1047    0  374 1652.17731 43230.1047  2517%     -  202s
     0     0 43230.1047    0  374 1652.17731 43230.1047  2517%     -  205s
     0     0 43230.1047    0  372 1652.17731 43230.1047  2517%     -  209s
     0     0 43230.1047    0  372 1652.17731 43230.1047  2517%     -  211s
     0     0 43230.1047    0  367 1652.17731 43230.1047  2517%     -  212s
     0     0 43230.1047    0  369 1652.17731 43230.1047  2517%     -  212s
     0     0 40702.9219    0  413 1652.17731 40702.9219  2364%     -  277s
H    0     0                    3259.2887056 40702.8226  1149%     -  278s
H    0     0                    4418.7639373 40702.8226   821%     -  278s
H    0     0                    4795.0120513 40702.8226   749%     -  278s
H    0     0                    8221.6217890 40702.8226   395%     -  279s
H    0     0                    8508.2870482 40702.8226   378%     -  279s
H    0     0                    8609.5372015 40702.8226   373%     -  279s
H    0     0                    8696.9931900 40702.8226   368%     -  279s
H    0     0                    9596.3374488 40702.8226   324%     -  279s
H    0     0                    10020.535288 40702.8226   306%     -  279s
H    0     0                    10154.417646 40702.8226   301%     -  279s
H    0     0                    10173.306243 40702.8226   300%     -  279s
     0     0 39847.2095    0  451 10173.3062 39847.2095   292%     -  324s
     0     0 39586.4753    0  448 10173.3062 39586.4753   289%     -  353s
     0     0 39390.4288    0  405 10173.3062 39390.4288   287%     -  373s
     0     0 39316.4342    0  414 10173.3062 39316.4342   286%     -  388s
     0     0 39284.2311    0  438 10173.3062 39284.2311   286%     -  399s
     0     0 39257.0900    0  446 10173.3062 39257.0900   286%     -  403s
     0     0 39241.3418    0  447 10173.3062 39241.3418   286%     -  410s
     0     0 39219.3877    0  440 10173.3062 39219.3877   286%     -  416s
     0     0 39210.9199    0  449 10173.3062 39210.9199   285%     -  419s
     0     0 39197.0986    0  445 10173.3062 39197.0986   285%     -  425s
     0     0 39188.6051    0  448 10173.3062 39188.6051   285%     -  428s
     0     0 39187.4316    0  453 10173.3062 39187.4316   285%     -  429s
     0     0 37627.7303    0  443 10173.3062 37627.7303   270%     -  511s
H    0     0                    10483.707419 37627.6580   259%     -  512s
     0     0 37329.0476    0  450 10483.7074 37329.0476   256%     -  539s
     0     0 37175.1834    0  514 10483.7074 37175.1834   255%     -  561s
     0     0 37082.7164    0  484 10483.7074 37082.7164   254%     -  571s
     0     0 37040.0752    0  491 10483.7074 37040.0752   253%     -  581s
     0     0 37025.4396    0  497 10483.7074 37025.4396   253%     -  587s
     0     0 37013.8335    0  494 10483.7074 37013.8335   253%     -  593s
     0     0 36990.5908    0  484 10483.7074 36990.5908   253%     -  599s
     0     0 36975.6798    0  496 10483.7074 36975.6798   253%     -  605s
     0     0 36970.7140    0  492 10483.7074 36970.7140   253%     -  609s
     0     0 36968.7813    0  495 10483.7074 36968.7813   253%     -  612s
     0     0 36967.3698    0  491 10483.7074 36967.3698   253%     -  614s
     0     0 36514.6779    0  461 10483.7074 36514.6779   248%     -  655s
H    0     0                    10551.735979 36514.6052   246%     -  657s
H    0     0                    10633.157666 36514.6052   243%     -  657s
H    0     0                    10763.666583 36514.6052   239%     -  657s
H    0     0                    10845.088270 36514.6052   237%     -  657s
H    0     0                    10867.138087 36514.6052   236%     -  657s
H    0     0                    10901.483359 36514.6052   235%     -  657s
H    0     0                    10905.616249 36514.6052   235%     -  657s
H    0     0                    10927.334841 36514.6052   234%     -  657s
H    0     0                    10933.970999 36514.6052   234%     -  657s
H    0     0                    10987.037937 36514.6052   232%     -  657s
H    0     0                    11012.903970 36514.6052   232%     -  657s
     0     0 36407.7132    0  470 11012.9040 36407.7132   231%     -  671s
     0     0 36367.7872    0  465 11012.9040 36367.7872   230%     -  683s
     0     0 36339.8093    0  472 11012.9040 36339.8093   230%     -  691s
     0     0 36314.8545    0  481 11012.9040 36314.8545   230%     -  699s
     0     0 36305.0136    0  485 11012.9040 36305.0136   230%     -  705s
     0     0 36296.8490    0  479 11012.9040 36296.8490   230%     -  711s
     0     0 36285.8889    0  488 11012.9040 36285.8889   229%     -  716s
     0     0 36284.1482    0  490 11012.9040 36284.1482   229%     -  719s
     0     0 36079.5125    0  499 11012.9040 36079.5125   228%     -  745s
H    0     0                    11057.505331 36078.9685   226%     -  745s
H    0     0                    11107.305394 36078.9685   225%     -  745s
     0     0 36008.7818    0  484 11107.3054 36008.7818   224%     -  759s
     0     0 36001.9983    0  478 11107.3054 36001.9983   224%     -  766s
     0     0 35983.8205    0  491 11107.3054 35983.8205   224%     -  775s
     0     0 35978.5863    0  497 11107.3054 35978.5863   224%     -  783s
     0     0 35976.5806    0  493 11107.3054 35976.5806   224%     -  785s
     0     0 35918.4348    0  500 11107.3054 35918.4348   223%     -  802s
     0     0 35904.9581    0  493 11107.3054 35904.9581   223%     -  812s
     0     0 35902.8543    0  497 11107.3054 35902.8543   223%     -  814s
     0     0 35885.7466    0  513 11107.3054 35885.7466   223%     -  825s
     0     0 35873.2209    0  509 11107.3054 35873.2209   223%     -  834s
     0     0 35870.2362    0  511 11107.3054 35870.2362   223%     -  837s
     0     0 35853.4498    0  516 11107.3054 35853.4498   223%     -  843s
     0     0 35850.9102    0  548 11107.3054 35850.9102   223%     -  847s
     0     0 35850.4314    0  551 11107.3054 35850.4314   223%     -  848s
     0     0 35825.0325    0  494 11107.3054 35825.0325   223%     -  859s
H    0     0                    11164.314107 35824.9214   221%     -  860s
     0     0 35812.5771    0  516 11164.3141 35812.5771   221%     -  867s
     0     0 35806.1474    0  519 11164.3141 35806.1474   221%     -  871s
     0     0 35802.2824    0  514 11164.3141 35802.2824   221%     -  877s
     0     0 35800.8949    0  517 11164.3141 35800.8949   221%     -  878s
     0     0 35782.1153    0  507 11164.3141 35782.1153   221%     -  888s
H    0     0                    11348.504031 35781.7755   215%     -  889s
     0     0 35777.9192    0  516 11348.5040 35777.9192   215%     -  892s
     0     0 35775.4469    0  515 11348.5040 35775.4469   215%     -  894s
     0     0 35774.0815    0  514 11348.5040 35774.0815   215%     -  896s
     0     0 35768.0903    0  516 11348.5040 35768.0903   215%     -  902s
H    0     0                    11817.556820 35768.0119   203%     -  903s
H    0     0                    11850.210652 35768.0119   202%     -  903s
     0     0 35765.3637    0  516 11850.2107 35765.3637   202%     -  905s
     0     0 35763.0811    0  517 11850.2107 35763.0811   202%     -  907s
     0     0 35761.9441    0  515 11850.2107 35761.9441   202%     -  909s
     0     0 35758.1550    0  520 11850.2107 35758.1550   202%     -  914s
H    0     0                    11856.253710 35757.9092   202%     -  915s
     0     0 35757.5021    0  516 11856.2537 35757.5021   202%     -  916s
     0     0 35756.0909    0  559 11856.2537 35756.0909   202%     -  920s
     0     0 35755.7683    0  559 11856.2537 35755.7683   202%     -  927s
H    0     0                    12140.035451 35755.7683   195%     - 1180s
H    0     0                    15671.041637 35755.7683   128%     - 1180s
H    0     0                    18293.032026 35755.7683  95.5%     - 1182s
     0     2 35755.7683    0  559 18293.0320 35755.7683  95.5%     - 1184s
     1     3 35254.0952    1  458 18293.0320 35755.7371  95.5%  9376 1201s
     2     4 35480.5080    1  521 18293.0320 35480.5080  94.0% 10258 1217s
     3     6 35421.3998    2  486 18293.0320 35480.4538  94.0%  9464 1232s
     5     9 34640.6326    3  458 18293.0320 35480.4538  94.0% 10026 1255s
     8    16 34354.1104    3  458 18293.0320 35421.1312  93.6%  9942 1285s
    15    31 34671.9618    4  566 18293.0320 34950.8934  91.1% 13107 1324s
    30    46 33933.2433    5  553 18293.0320 34671.8997  89.5% 18993 1463s
    45    77 32166.2684    6  450 18293.0320 34671.8997  89.5% 19685 1614s
H   46    77                    19125.268881 34671.8997  81.3% 19257 1614s
    76   202 31651.6175    7  431 19125.2689 34671.8997  81.3% 16983 1668s
   201   232 31592.3668    8  444 19125.2689 34671.8997  81.3%  9962 1692s
H  203   232                    19154.748613 34671.8997  81.0%  9909 1692s
H  206   232                    19170.161707 34671.8997  80.9%  9842 1692s
H  207   232                    19607.110659 34671.8997  76.8%  9798 1692s
H  210   232                    20048.573249 34671.8997  72.9%  9716 1692s
   231   295 31437.8958    9  457 20048.5732 34671.8997  72.9%  9316 1725s
   294   327 31291.2382   11  418 20048.5732 34671.8997  72.9%  8118 1747s
H  301   327                    21073.499108 34671.8997  64.5%  8026 1747s
   326   391 32225.1205   11  391 21073.4991 34671.8997  64.5%  7768 1779s
   390   444 31200.4965   12  418 21073.4991 34671.8997  64.5%  7058 1813s
   447   476 30448.1756   16  424 21073.4991 34671.8997  64.5%  6641 1847s
   493   497 31146.4915   11  413 21073.4991 34671.8997  64.5%  6343 1873s
H  498   497                    21078.005365 34671.8997  64.5%  6326 1873s
H  512   497                    21119.009248 34671.8997  64.2%  6298 1873s
H  513   497                    21211.540666 34671.8997  63.5%  6287 1873s
   517   551 30127.2555   12  413 21211.5407 34671.8997  63.5%  6308 1903s
   579   583 29808.1893   13  398 21211.5407 34671.8997  63.5%  6079 1927s
   635   598 28838.8368   20  356 21211.5407 34671.8997  63.5%  5863 1954s
   688   608 29352.9304   14  353 21211.5407 34671.8997  63.5%  5698 1980s
   722   614 29834.4702   20  338 21211.5407 34671.8997  63.5%  5661 2009s
   750   621 30843.0775   15  294 21211.5407 34671.8997  63.5%  5627 2032s
   773   629 infeasible   28      21211.5407 34671.8997  63.5%  5599 2059s
   813   634 22182.7494   15  112 21211.5407 34671.8997  63.5%  5501 2086s
   863   678 infeasible   15      21211.5407 34671.8997  63.5%  5376 2112s
H  866   678                    21298.374838 34671.8997  62.8%  5370 2112s
H  867   678                    21404.136928 34671.8997  62.0%  5368 2112s
H  880   678                    21419.650649 34671.8997  61.9%  5310 2112s
   928   745 22906.7953   36  206 21419.6506 34671.8997  61.9%  5229 2140s
H 1051   767                    21428.169786 34671.8997  61.8%  4887 2165s
H 1072   767                    21494.785916 34671.8997  61.3%  4845 2165s
H 1081   767                    21507.335758 34671.8997  61.2%  4834 2165s
H 1091   767                    21511.961769 34671.8997  61.2%  4827 2165s
  1092   789 22134.1439   39  184 21511.9618 34671.8997  61.2%  4826 2193s
  1237   781 infeasible   16      21511.9618 34671.8997  61.2%  4523 2225s
  1324   797 infeasible   44      21511.9618 34671.8997  61.2%  4414 2257s
  1399   821 22795.0486   20  226 21511.9618 34671.8997  61.2%  4382 2293s
  1453   832 infeasible   22      21511.9618 34671.8997  61.2%  4372 2329s
  1510   844 24168.7901   14  390 21511.9618 34671.8997  61.2%  4411 2367s
  1558   866 23769.8317   15  405 21511.9618 34671.8997  61.2%  4476 2406s
  1592   888 28456.3434   14  363 21511.9618 34671.8997  61.2%  4583 2444s
  1626   936 28309.5856   15  355 21511.9618 34671.8997  61.2%  4635 2483s
H 1665   936                    21613.452167 34671.8997  60.4%  4623 2483s
H 1683   936                    21616.863563 34671.8997  60.4%  4622 2483s
  1695   968 27404.0531   16  301 21616.8636 34671.8997  60.4%  4662 2540s
  1777   974 25164.6757   17  292 21616.8636 34671.8997  60.4%  4661 2587s
  1821   985 24392.7143   18  384 21616.8636 34671.8997  60.4%  4708 2645s
  1866  1005 24066.0970   19  376 21616.8636 34668.4329  60.4%  4732 2688s
  1920  1027 22623.8409   20  405 21616.8636 34668.4329  60.4%  4784 2730s
  1997  1044 22004.6008   21  321 21616.8636 34668.4329  60.4%  4787 2788s
  2051  1089 infeasible   22      21616.8636 34668.4329  60.4%  4826 2833s
  2112  1138 22429.8540   23  262 21616.8636 34668.4329  60.4%  4886 2883s
  2179  1193 infeasible   13      21616.8636 34668.4329  60.4%  4919 2931s
  2268  1222     cutoff   24      21616.8636 34267.2605  58.5%  4918 2978s
  2348  1266 33712.7671    6  549 21616.8636 34267.2605  58.5%  4926 3032s
  2432  1322 33691.6218    7  535 21616.8636 34150.8141  58.0%  4960 3089s
  2544  1382 31247.7076    9  396 21616.8636 34150.8141  58.0%  4981 3146s
  2673  1452 30675.9606   10  439 21616.8636 33784.8348  56.3%  4992 3207s
  2804  1503 29950.1615   12  433 21616.8636 33784.8348  56.3%  5007 3266s
  2899  1580 29786.2551   13  474 21616.8636 33712.6612  56.0%  5004 3345s
  3042  1685 25364.0496   14  292 21616.8636 33712.6612  56.0%  5021 3415s
  3219  1814 23643.2116   17  213 21616.8636 33712.6612  56.0%  5038 3492s
  3404  1929 21864.0696   20  224 21616.8636 33543.1177  55.2%  5064 3583s
  3624  1967 30291.0586    9  321 21616.8636 33543.1177  55.2%  5028 3600s

Cutting planes:
  Learned: 1
  Gomory: 4
  Implied bound: 198
  MIR: 3190
  Flow cover: 3559
  Zero half: 1
  RLT: 107
  Relax-and-lift: 585

Explored 3708 nodes (19027212 simplex iterations) in 3600.03 seconds (8128.69 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 21616.9 21613.5 21512 ... 21211.5

Time limit reached
Best objective 2.161686356313e+04, best bound 3.354311772419e+04, gap 55.1711%
  WARNING: Time limit reached. Using best solution found (gap: 55.17%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = 21616.86, θ = 168611.12
  Upper Bound (UB) = 21616.86

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 168611.12
  [DEBUG]   ✓ Scenario 0: θ = 168611.12 ≤ Q = 168611.12 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 168611.12 ≤ Q = 168611.12 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 168611.12 ≤ Q = 168611.12 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 168611.12 ≤ Q = 168611.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 168611.12 ≤ Q = 168611.12 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 168611.12 ≤ Q = 168611.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 168611.12 ≤ Q = 168611.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 168611.12 ≤ Q = 168611.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 168611.12 ≤ Q = 168611.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 168611.12 ≤ Q = 168611.12 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 168611.12 ≤ Q = 168611.12 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 168611.12 ≤ Q = 168611.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 168611.12 ≤ Q = 168611.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 168611.12 ≤ Q = 168611.12 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 168611.12 ≤ Q = 168611.12 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 15] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x3aa3cf83
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xc55c307d
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [5e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [5e-14, 2e+02]
Found heuristic solution: objective 1.346430e+13
Presolve removed 2574 rows and 1866 columns
Presolve time: 0.01s
Presolved: 519 rows, 523 columns, 1464 nonzeros
Found heuristic solution: objective 6785303.6744
Variable types: 355 continuous, 168 integer (168 binary)

Root relaxation: objective -1.528076e+05, 254 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -152807.59    0  124 6785303.67 -152807.59   102%     -    0s
H    0     0                    -117755.8190 -152807.59  29.8%     -    0s
H    0     0                    -118442.6290 -152807.59  29.0%     -    0s
     0     0 -132144.44    0   63 -118442.63 -132144.44  11.6%     -    0s
H    0     0                    -130630.7315 -132133.91  1.15%     -    0s
     0     0 -131668.41    0   54 -130630.73 -131668.41  0.79%     -    0s
H    0     0                    -131142.1202 -131596.21  0.35%     -    0s
     0     0 -131596.21    0   52 -131142.12 -131596.21  0.35%     -    0s
     0     0 -131596.21    0   51 -131142.12 -131596.21  0.35%     -    0s
     0     0 -131596.21    0   34 -131142.12 -131596.21  0.35%     -    0s
     0     0 -131596.21    0   49 -131142.12 -131596.21  0.35%     -    0s
     0     0 -131320.15    0   45 -131142.12 -131320.15  0.14%     -    0s
     0     0 -131284.98    0   10 -131142.12 -131284.98  0.11%     -    0s
     0     0 -131225.32    0   10 -131142.12 -131225.32  0.06%     -    0s
     0     0 -131222.19    0    8 -131142.12 -131222.19  0.06%     -    0s
     0     0 -131207.03    0    8 -131142.12 -131207.03  0.05%     -    0s
     0     0 -131195.26    0    6 -131142.12 -131195.26  0.04%     -    0s
     0     0 -131195.26    0   18 -131142.12 -131195.26  0.04%     -    0s
     0     0 -131195.26    0   13 -131142.12 -131195.26  0.04%     -    0s
     0     0 -131191.17    0    8 -131142.12 -131191.17  0.04%     -    0s
     0     0 -131157.09    0    2 -131142.12 -131157.09  0.01%     -    0s
H    0     0                    -131149.5495 -131155.55  0.00%     -    0s

Cutting planes:
  MIR: 4
  Flow cover: 3

Explored 1 nodes (687 simplex iterations) in 0.07 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 7: -131150 -131142 -130982 ... 1.34643e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.311495494981e+05, best bound -1.311555533860e+05, gap 0.0046%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 158706.40
  Scenario: 23 demand increases, 37 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -131149.55
  [DEBUG]   S×d_nominal = 289855.95
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 289855.95 + -131149.55 = 158706.40
  [DEBUG]   Current θ from Master = 168611.12
  [DEBUG]   ⚠️  Z_SP ≤ θ by 9904.72 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 11712.14
  Lower Bound (LB) = 19044.82
  Gap (UB-LB) = 2572.0448, Absolute Gap = 2572.0448, Relative Gap = 0.118983
  Not converged yet (gap = 2572.04 > ε = 200)

  [DEBUG] Adding NEW scenario 15 to Master Problem...
  [DEBUG] New scenario pattern: 23 increases, 37 decreases
    [DEBUG] Scenario 15 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 15 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 15]
    [DEBUG]   - Total constraints in model: 246023
    [DEBUG]   - Total variables in model: 102100
  [DEBUG] Total scenarios in Master: 16
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 16
================================================================================
[Iteration 16] Solving Master Problem...
  Current scenarios in Master: 16
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 246023 rows, 102100 columns and 697407 nonzeros
Model fingerprint: 0xb368e7db
Variable types: 99841 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 106800 rows and 43368 columns
Presolve time: 2.68s
Presolved: 139223 rows, 58732 columns, 857437 nonzeros
Variable types: 56473 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -327262.4774
Found heuristic solution: objective -184683.4741

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.34s

Barrier statistics:
 Dense cols : 677
 AA' NZ     : 6.533e+06
 Factor NZ  : 1.487e+07 (roughly 200 MB of memory)
 Factor Ops : 3.486e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.16409621e+07  2.36456221e+08  1.29e+05 1.76e+01  8.89e+04     4s
   1  -1.66432579e+07  2.16715818e+08  9.22e+04 6.46e+01  6.29e+04     4s
   2  -6.34981254e+06  1.65295547e+08  3.48e+04 1.49e+00  2.54e+04     5s
   3  -9.73363028e+05  1.26565471e+08  2.35e+03 1.41e+00  2.14e+03     5s
   4  -5.43811579e+05  7.99523700e+07  4.93e+02 7.05e-01  6.35e+02     5s
   5  -4.74503442e+05  4.40928038e+07  2.84e+02 3.18e-01  3.38e+02     5s
   6  -3.85713471e+05  3.11298437e+07  8.48e+01 2.07e-01  1.69e+02     5s
   7  -3.47229138e+05  2.41318739e+07  4.58e+01 1.54e-01  1.18e+02     5s
   8  -2.33977858e+05  1.89392617e+07  4.02e+00 1.18e-01  7.71e+01     5s
   9  -1.63820317e+05  1.11011692e+07  9.02e-01 6.84e-02  4.46e+01     5s
  10  -1.07093144e+05  4.99910821e+06  3.76e-01 3.03e-02  2.01e+01     5s
  11  -7.74540913e+04  1.85015886e+06  1.85e-01 1.10e-02  7.59e+00     5s
  12  -3.41822897e+04  6.36525682e+05  5.21e-02 3.26e-03  2.64e+00     5s
  13  -9.57448260e+03  3.02880974e+05  2.62e-02 1.46e-03  1.23e+00     5s
  14  -3.77033488e+02  1.88285601e+05  2.00e-02 1.30e-03  7.43e-01     5s
  15   8.76329098e+03  1.38342938e+05  1.60e-02 8.19e-04  5.10e-01     5s
  16   1.40742565e+04  1.13030884e+05  1.39e-02 5.64e-04  3.90e-01     5s
  17   2.47639065e+04  9.60535407e+04  9.78e-03 3.89e-04  2.81e-01     5s
  18   2.84992800e+04  8.30151607e+04  8.27e-03 2.79e-04  2.15e-01     5s
  19   3.05125327e+04  7.28855061e+04  7.46e-03 1.94e-04  1.67e-01     6s
  20   3.63628547e+04  6.71737622e+04  5.22e-03 1.43e-04  1.21e-01     6s
  21   3.89431092e+04  6.30382966e+04  4.25e-03 1.06e-04  9.48e-02     6s
  22   4.06639688e+04  6.07139488e+04  3.64e-03 8.67e-05  7.89e-02     6s
  23   4.31285509e+04  5.84478523e+04  2.73e-03 6.63e-05  6.03e-02     6s
  24   4.48258718e+04  5.59522233e+04  2.12e-03 4.40e-05  4.38e-02     6s
  25   4.51572861e+04  5.46076756e+04  2.00e-03 3.17e-05  3.72e-02     6s
  26   4.66965621e+04  5.41231505e+04  1.49e-03 2.69e-05  2.92e-02     6s
  27   4.75042741e+04  5.35106040e+04  1.22e-03 2.12e-05  2.36e-02     6s
  28   4.81802849e+04  5.30727880e+04  9.99e-04 1.68e-05  1.93e-02     6s
  29   4.86203735e+04  5.27858132e+04  8.55e-04 1.41e-05  1.64e-02     6s
  30   4.91622016e+04  5.23753437e+04  6.77e-04 9.99e-06  1.26e-02     6s
  31   4.94025297e+04  5.21810991e+04  5.98e-04 1.32e-05  1.09e-02     7s
  32   4.98759020e+04  5.19634797e+04  4.44e-04 9.86e-06  8.22e-03     7s
  33   4.99980677e+04  5.17553245e+04  4.06e-04 6.79e-06  6.92e-03     7s
  34   5.02402507e+04  5.16405341e+04  3.27e-04 5.12e-06  5.51e-03     7s
  35   5.04302107e+04  5.15822142e+04  2.69e-04 4.24e-06  4.54e-03     7s
  36   5.06888181e+04  5.15000654e+04  1.85e-04 3.03e-06  3.19e-03     7s
  37   5.08422405e+04  5.14261372e+04  1.36e-04 1.91e-06  2.30e-03     7s
  38   5.09922357e+04  5.13900034e+04  8.78e-05 1.36e-06  1.57e-03     7s
  39   5.10839628e+04  5.13693738e+04  6.01e-05 1.03e-06  1.12e-03     7s
  40   5.11457894e+04  5.13487866e+04  4.25e-05 7.34e-07  7.99e-04     7s
  41   5.12183773e+04  5.13342028e+04  2.09e-05 5.36e-07  4.56e-04     7s
  42   5.12395729e+04  5.13207439e+04  1.49e-05 2.04e-06  3.20e-04     8s
  43   5.12536923e+04  5.13166864e+04  1.09e-05 1.68e-06  2.48e-04     8s
  44   5.12788148e+04  5.13124847e+04  4.24e-06 1.73e-06  1.33e-04     8s
  45   5.12814525e+04  5.13032550e+04  3.48e-06 1.05e-06  8.58e-05     8s
  46   5.12939052e+04  5.12985426e+04  1.94e-07 5.46e-07  1.83e-05     8s
  47   5.12947261e+04  5.12963171e+04  6.87e-08 2.08e-07  6.27e-06     8s
  48   5.12948488e+04  5.12950545e+04  3.87e-08 1.94e-08  8.13e-07     8s
  49   5.12948867e+04  5.12949348e+04  2.16e-07 4.58e-09  1.91e-07     8s
  50   5.12948889e+04  5.12949344e+04  4.94e-07 4.12e-09  1.81e-07     8s
  51   5.12949277e+04  5.12949281e+04  1.31e-08 2.27e-08  1.23e-09     8s

Barrier solved model in 51 iterations and 8.25 seconds (15.44 work units)
Optimal objective 5.12949277e+04


Root crossover log...

  114240 DPushes remaining with DInf 0.0000000e+00                 8s
   63423 DPushes remaining with DInf 0.0000000e+00                10s
   33797 DPushes remaining with DInf 0.0000000e+00                15s
   11660 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                25s

   18003 PPushes remaining with PInf 9.1871049e-05                25s
       0 PPushes remaining with PInf 0.0000000e+00                27s

  Push phase complete: Pinf 0.0000000e+00, Dinf 5.0614433e+03     27s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   77338    5.1294928e+04   0.000000e+00   5.061443e+03     27s
   77569    5.1294928e+04   0.000000e+00   0.000000e+00     27s
   77569    5.1294928e+04   0.000000e+00   0.000000e+00     28s
Concurrent spin time: 9.34s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 5.129493e+04, 77569 iterations, 33.44 seconds (43.94 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 51294.9281    0  379 -184683.47 51294.9281   128%     -   37s
H    0     0                    -173694.6684 51294.9281   130%     -   37s
H    0     0                    -169153.7499 51294.9281   130%     -   39s
H    0     0                    -168535.2133 51294.9281   130%     -   40s
H    0     0                    -162261.6301 51294.9281   132%     -   40s
H    0     0                    -162205.1093 51294.9281   132%     -   40s
H    0     0                    -161155.7938 51294.9281   132%     -   40s
H    0     0                    -160518.2307 51294.9281   132%     -   40s
H    0     0                    -160511.7170 51294.9281   132%     -   40s
H    0     0                    -69355.67453 51294.9281   174%     -   40s
H    0     0                    -69344.74958 51294.9281   174%     -   41s
H    0     0                    -22663.98547 51294.9281   326%     -   41s
H    0     0                    -18515.18569 51294.9281   377%     -   41s
H    0     0                    -18120.49255 51294.9281   383%     -   41s
H    0     0                    -17046.95477 51294.9281   401%     -   41s
H    0     0                    -16936.12688 51294.9281   403%     -   42s
H    0     0                    -16846.50018 51294.9281   404%     -   42s
     0     0 44755.5652    0  408 -16846.500 44755.5652   366%     -  116s
H    0     0                    -16647.41571 44755.5144   369%     -  116s
H    0     0                    -12457.54280 44755.5144   459%     -  117s
H    0     0                    -12449.02947 44755.5144   460%     -  117s
H    0     0                    -12378.68735 44755.5144   462%     -  117s
H    0     0                    -12267.60828 44755.5144   465%     -  117s
     0     0 43907.1670    0  391 -12267.608 43907.1670   458%     -  156s
     0     0 43822.1317    0  359 -12267.608 43822.1317   457%     -  168s
     0     0 43789.2977    0  360 -12267.608 43789.2977   457%     -  177s
     0     0 43769.5369    0  374 -12267.608 43769.5369   457%     -  186s
     0     0 43764.8291    0  378 -12267.608 43764.8291   457%     -  191s
     0     0 43754.1411    0  382 -12267.608 43754.1411   457%     -  199s
     0     0 43737.4286    0  380 -12267.608 43737.4286   457%     -  202s
     0     0 43672.7878    0  379 -12267.608 43672.7878   456%     -  210s
     0     0 43598.9147    0  384 -12267.608 43598.9147   455%     -  223s
     0     0 43575.9402    0  383 -12267.608 43575.9402   455%     -  232s
     0     0 43574.3581    0  380 -12267.608 43574.3581   455%     -  235s
     0     0 43517.9238    0  420 -12267.608 43517.9238   455%     -  246s
     0     0 43403.2944    0  382 -12267.608 43403.2944   454%     -  259s
     0     0 43388.3880    0  376 -12267.608 43388.3880   454%     -  266s
     0     0 43382.5365    0  383 -12267.608 43382.5365   454%     -  269s
     0     0 43317.8666    0  375 -12267.608 43317.8666   453%     -  275s
     0     0 43314.1373    0  384 -12267.608 43314.1373   453%     -  278s
     0     0 43310.9503    0  385 -12267.608 43310.9503   453%     -  279s
     0     0 43310.6252    0  385 -12267.608 43310.6252   453%     -  279s
     0     0 40815.9983    0  431 -12267.608 40815.9983   433%     -  360s
H    0     0                    -565.7470157 40815.9422  7315%     -  361s
H    0     0                      -2.2649388 40815.9422      -     -  361s
H    0     0                    1197.4814935 40815.9422  3308%     -  362s
H    0     0                    2627.1864311 40815.9422  1454%     -  362s
H    0     0                    2933.7612221 40815.9422  1291%     -  362s
H    0     0                    3254.0332306 40815.9422  1154%     -  362s
H    0     0                    3329.2893259 40815.9422  1126%     -  362s
H    0     0                    3551.5379182 40815.9422  1049%     -  362s
H    0     0                    3594.8558203 40815.9422  1035%     -  362s
     0     0 40253.3160    0  440 3594.85582 40253.3160  1020%     -  401s
     0     0 40073.3565    0  450 3594.85582 40073.3565  1015%     -  426s
     0     0 39935.9951    0  411 3594.85582 39935.9951  1011%     -  452s
     0     0 39740.0338    0  459 3594.85582 39740.0338  1005%     -  483s
     0     0 39675.1350    0  468 3594.85582 39675.1350  1004%     -  501s
     0     0 39644.0343    0  466 3594.85582 39644.0343  1003%     -  513s
     0     0 39615.9684    0  470 3594.85582 39615.9684  1002%     -  525s
     0     0 39569.2412    0  468 3594.85582 39569.2412  1001%     -  541s
     0     0 39543.7419    0  479 3594.85582 39543.7419  1000%     -  547s
     0     0 39540.2120    0  477 3594.85582 39540.2120  1000%     -  551s
     0     0 39534.1773    0  484 3594.85582 39534.1773  1000%     -  554s
     0     0 39522.6121    0  454 3594.85582 39522.6121   999%     -  560s
     0     0 39517.1845    0  465 3594.85582 39517.1845   999%     -  564s
     0     0 39515.1589    0  462 3594.85582 39515.1589   999%     -  567s
     0     0 39514.6068    0  467 3594.85582 39514.6068   999%     -  568s
     0     0 37922.4520    0  422 3594.85582 37922.4520   955%     -  669s
H    0     0                    5351.3313671 37922.1663   609%     -  670s
H    0     0                    5768.7341807 37922.1663   557%     -  670s
H    0     0                    5773.2404378 37922.1663   557%     -  670s
H    0     0                    5915.9666305 37922.1663   541%     -  670s
     0     0 37524.5406    0  486 5915.96663 37524.5406   534%     -  705s
     0     0 37386.0493    0  493 5915.96663 37386.0493   532%     -  724s
     0     0 37310.9330    0  536 5915.96663 37310.9330   531%     -  740s
     0     0 37289.5275    0  539 5915.96663 37289.5275   530%     -  749s
     0     0 37280.8602    0  538 5915.96663 37280.8602   530%     -  753s
     0     0 37274.5141    0  538 5915.96663 37274.5141   530%     -  758s
     0     0 37268.3411    0  535 5915.96663 37268.3411   530%     -  762s
     0     0 37262.2187    0  537 5915.96663 37262.2187   530%     -  764s
     0     0 37251.0536    0  528 5915.96663 37251.0536   530%     -  769s
     0     0 37243.4179    0  535 5915.96663 37243.4179   530%     -  775s
     0     0 37240.1105    0  530 5915.96663 37240.1105   529%     -  777s
     0     0 37216.1771    0  530 5915.96663 37216.1771   529%     -  784s
     0     0 37214.2879    0  530 5915.96663 37214.2879   529%     -  786s
     0     0 37209.6154    0  534 5915.96663 37209.6154   529%     -  791s
     0     0 37207.1709    0  533 5915.96663 37207.1709   529%     -  793s
     0     0 37206.5682    0  533 5915.96663 37206.5682   529%     -  795s
     0     0 36497.0183    0  487 5915.96663 36497.0183   517%     -  875s
H    0     0                    7368.6804423 36496.8521   395%     -  876s
     0     0 36346.6859    0  494 7368.68044 36346.6859   393%     -  904s
     0     0 36307.1285    0  477 7368.68044 36307.1285   393%     -  919s
     0     0 36267.1746    0  522 7368.68044 36267.1746   392%     -  934s
     0     0 36252.2697    0  483 7368.68044 36252.2697   392%     -  941s
     0     0 36245.1584    0  489 7368.68044 36245.1584   392%     -  947s
     0     0 36224.0292    0  488 7368.68044 36224.0292   392%     -  953s
     0     0 36209.9896    0  484 7368.68044 36209.9896   391%     -  960s
     0     0 36206.7235    0  483 7368.68044 36206.7235   391%     -  964s
     0     0 36204.4716    0  484 7368.68044 36204.4716   391%     -  967s
     0     0 36193.8129    0  481 7368.68044 36193.8129   391%     -  972s
     0     0 36192.1644    0  483 7368.68044 36192.1644   391%     -  974s
     0     0 36053.9561    0  521 7368.68044 36053.9561   389%     - 1002s
H    0     0                    7381.2306393 36053.6832   388%     - 1003s
H    0     0                    7588.2015096 36053.6832   375%     - 1004s
H    0     0                    7592.7077667 36053.6832   375%     - 1004s
     0     0 36009.8666    0  528 7592.70777 36009.8666   374%     - 1022s
     0     0 35988.4329    0  522 7592.70777 35988.4329   374%     - 1035s
     0     0 35966.4294    0  533 7592.70777 35966.4294   374%     - 1046s
     0     0 35952.5517    0  543 7592.70777 35952.5517   374%     - 1055s
     0     0 35949.9527    0  537 7592.70777 35949.9527   373%     - 1058s
     0     0 35944.2960    0  541 7592.70777 35944.2960   373%     - 1062s
     0     0 35941.7461    0  540 7592.70777 35941.7461   373%     - 1066s
     0     0 35939.7568    0  536 7592.70777 35939.7568   373%     - 1070s
     0     0 35897.0776    0  485 7592.70777 35897.0776   373%     - 1086s
H    0     0                    7593.5042759 35896.4790   373%     - 1088s
     0     0 35881.1991    0  479 7593.50428 35881.1991   373%     - 1097s
     0     0 35873.3702    0  487 7593.50428 35873.3702   372%     - 1105s
     0     0 35864.8305    0  492 7593.50428 35864.8305   372%     - 1111s
     0     0 35862.6361    0  493 7593.50428 35862.6361   372%     - 1115s
     0     0 35813.2688    0  492 7593.50428 35813.2688   372%     - 1134s
     0     0 35800.5980    0  502 7593.50428 35800.5980   371%     - 1142s
     0     0 35796.0694    0  498 7593.50428 35796.0694   371%     - 1146s
     0     0 35795.5746    0  497 7593.50428 35795.5746   371%     - 1147s
     0     0 35784.9273    0  496 7593.50428 35784.9273   371%     - 1155s
H    0     0                    8109.8811357 35784.7776   341%     - 1156s
H    0     0                    8134.7906741 35784.7776   340%     - 1156s
H    0     0                    9006.2940920 35784.7776   297%     - 1156s
H    0     0                    9140.9863492 35784.7776   291%     - 1156s
H    0     0                    9167.7804992 35784.7776   290%     - 1156s
H    0     0                    9207.1649942 35784.7776   289%     - 1156s
     0     0 35782.2367    0  495 9207.16499 35782.2367   289%     - 1158s
     0     0 35781.5294    0  493 9207.16499 35781.5294   289%     - 1160s
     0     0 35769.1988    0  489 9207.16499 35769.1988   288%     - 1172s
     0     0 35763.4439    0  492 9207.16499 35763.4439   288%     - 1181s
     0     0 35760.7396    0  503 9207.16499 35760.7396   288%     - 1184s
     0     0 35759.8259    0  500 9207.16499 35759.8259   288%     - 1185s
     0     0 35751.1602    0  498 9207.16499 35751.1602   288%     - 1193s
H    0     0                    9475.1828169 35750.8182   277%     - 1195s
H    0     0                    10025.945175 35750.8182   257%     - 1195s
H    0     0                    10242.799847 35750.8182   249%     - 1195s
H    0     0                    10244.639910 35750.8182   249%     - 1195s
     0     0 35748.0816    0  502 10244.6399 35748.0816   249%     - 1198s
     0     0 35747.4468    0  505 10244.6399 35747.4468   249%     - 1200s
     0     0 35742.1463    0  526 10244.6399 35742.1463   249%     - 1208s
     0     0 35742.0977    0  526 10244.6399 35742.0977   249%     - 1216s
H    0     0                    10832.815754 35742.0977   230%     - 1328s
H    0     0                    10896.311071 35742.0977   228%     - 1328s
H    0     0                    10909.405259 35742.0977   228%     - 1465s
H    0     0                    10910.310369 35742.0977   228%     - 1465s
H    0     0                    10924.273675 35742.0977   227%     - 1467s
H    0     0                    11184.121736 35742.0977   220%     - 1467s
     0     2 35742.0977    0  526 11184.1217 35742.0977   220%     - 1470s
     1     3 35351.4785    1  422 11184.1217 35741.6338   220% 16379 1500s
     2     4 35464.5955    1  481 11184.1217 35464.5955   217% 14522 1522s
     3     5 34688.0636    2  481 11184.1217 35464.4677   217% 13889 1544s
     4    10 34513.5589    3  498 11184.1217 35464.4677   217% 13592 1586s
     9    19 34306.5770    4  447 11184.1217 35207.7725   215% 13142 1649s
    18    38 34173.2640    5  452 11184.1217 35207.7725   215% 17011 1696s
    37    51 32421.3429    4  454 11184.1217 34733.9971   211% 21424 1788s
    50    74 32589.9946    7  435 11184.1217 34733.9971   211% 23591 1862s
H   52    74                    15729.099789 34733.9971   121% 23215 1862s
H   54    74                    16116.753800 34733.9971   116% 23056 1862s
    73   168 32560.0552    8  365 16116.7538 34733.9971   116% 20182 1966s
H  167   252                    17593.249375 34733.9971  97.4% 13275 2009s
H  169   252                    18121.551839 34733.9971  91.7% 13281 2009s
H  171   252                    18891.131159 34733.9971  83.9% 13185 2009s
H  176   252                    20591.621651 34733.9971  68.7% 12938 2009s
   251   360 31824.9149   12  310 20591.6217 34733.9971  68.7% 10054 2045s
   359   427 31424.7320   17  293 20591.6217 34733.9971  68.7%  8135 2075s
   426   485 31358.3768   18  291 20591.6217 34733.9971  68.7%  7434 2103s
   484   530 30917.2381   19  291 20591.6217 34733.9971  68.7%  7048 2142s
   533   576 29444.5900   20  274 20591.6217 34733.9971  68.7%  6713 2179s
   585   615 28565.5657   21  256 20591.6217 34733.9971  68.7%  6415 2214s
   636   627 26830.4409   22  243 20591.6217 34733.9971  68.7%  6211 2242s
   688   641 26606.5214   23  158 20591.6217 34733.9971  68.7%  6046 2277s
   732   644 26183.4151   25  148 20591.6217 34733.9971  68.7%  5984 2308s
   777   649 infeasible   24      20591.6217 34733.9971  68.7%  5899 2340s
   814   665 23404.3534   27  263 20591.6217 34733.9971  68.7%  5823 2371s
   871   670 infeasible   28      20591.6217 34733.9971  68.7%  5577 2400s
H  873   670                    20945.273034 34733.9971  65.8%  5565 2400s
   917   651     cutoff   43      20945.2730 34733.9971  65.8%  5434 2439s
H  918   651                    20978.009936 34733.9971  65.6%  5428 2439s
H  927   651                    21019.274683 34733.9971  65.2%  5402 2439s
H  933   651                    21150.096704 34733.9971  64.2%  5374 2439s
   937   662 33072.9641    9  394 21150.0967 34733.9971  64.2%  5369 2482s
   948   680 28533.5875   17  329 21150.0967 34733.9971  64.2%  5419 2519s
   966   696 28265.9485   18  311 21150.0967 34313.7465  62.2%  5483 2559s
   982   729 24716.8588   11  312 21150.0967 34313.7465  62.2%  5549 2593s
  1021   759 27244.9693   22  191 21150.0967 34313.7465  62.2%  5573 2627s
H 1024   759                    21395.955227 34313.7465  60.4%  5574 2627s
H 1030   759                    21417.024206 34313.7465  60.2%  5569 2627s
  1069   806 27194.1361   23  190 21417.0242 34313.7465  60.2%  5501 2666s
  1156   831 26264.0396   25  238 21417.0242 34313.7465  60.2%  5420 2703s
H 1167   831                    21551.987715 34313.7465  59.2%  5390 2703s
H 1176   831                    21553.310884 34313.7465  59.2%  5369 2703s
H 1206   831                    21674.901686 34313.7465  58.3%  5332 2703s
H 1234   845                    21680.515737 34313.7465  58.3%  5325 2742s
H 1269   845                    21695.831297 34313.7465  58.2%  5310 2742s
H 1284   845                    21724.223196 34313.7465  58.0%  5293 2742s
  1306   847 22287.7608   26  126 21724.2232 34313.7465  58.0%  5314 2783s
H 1315   847                    21745.292175 34313.7465  57.8%  5318 2783s
H 1316   847                    21790.802316 34313.7465  57.5%  5315 2783s
  1346   881 22225.8204   27  126 21790.8023 34313.7465  57.5%  5340 2830s
H 1363   881                    21962.060202 34313.7465  56.2%  5316 2830s
  1417   919 31254.7849   12  403 21962.0602 34313.7465  56.2%  5319 2876s
H 1429   919                    21966.418746 34313.7465  56.2%  5328 2876s
  1487   982 22307.1035   20   84 21966.4187 34313.7465  56.2%  5384 2923s
  1562  1006 infeasible   22      21966.4187 34313.7465  56.2%  5389 2967s
H 1582  1006                    22051.965167 34313.7465  55.6%  5428 2967s
  1596  1145 29504.9993   12  428 22051.9652 34313.7465  55.6%  5466 3012s
H 1610  1145                    22072.539472 34313.7465  55.5%  5459 3012s
H 1656  1145                    22074.473851 34313.7465  55.4%  5404 3012s
H 1685  1145                    22088.147935 34313.7465  55.3%  5363 3012s
H 1719  1145                    22093.608451 34313.7465  55.3%  5335 3012s
  1757  1214 28679.7353   13  391 22093.6085 34313.7465  55.3%  5267 3062s
  1933  1248 30230.6507   16  352 22093.6085 34313.7465  55.3%  5088 3114s
H 2042  1248                    22122.739737 34313.7465  55.1%  5013 3114s
  2087  1252 27970.6273   13  388 22122.7397 34313.7465  55.1%  4987 3167s
  2146  1275 27011.5874   14  378 22122.7397 34313.7465  55.1%  5037 3219s
  2181  1313 26692.7572   15  314 22122.7397 33763.2359  52.6%  5125 3271s
  2231  1375 26645.1527   16  319 22122.7397 33763.2359  52.6%  5150 3320s
  2327  1469 25940.6348   17  313 22122.7397 33763.2359  52.6%  5144 3382s
  2467  1567 25393.5668   22  309 22122.7397 33517.1926  51.5%  5099 3447s
  2611  1657 25046.6023   25  293 22122.7397 33517.1926  51.5%  5072 3506s
  2755  1730 infeasible   30      22122.7397 33339.9568  50.7%  5050 3574s
  2913  1716 22628.0427   32  268 22122.7397 33339.9568  50.7%  5041 3600s

Cutting planes:
  Learned: 2
  Gomory: 2
  Implied bound: 214
  MIR: 3428
  Flow cover: 3730
  RLT: 98
  Relax-and-lift: 651

Explored 2979 nodes (15586663 simplex iterations) in 3600.08 seconds (7835.13 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 22122.7 22093.6 22088.1 ... 21745.3

Time limit reached
Best objective 2.212273973695e+04, best bound 3.333995676027e+04, gap 50.7045%
  WARNING: Time limit reached. Using best solution found (gap: 50.70%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.10s
  Master Objective (UB) = 22122.74, θ = 164843.45
  Upper Bound (UB) = 22122.74

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 164843.45
  [DEBUG]   ✓ Scenario 0: θ = 164843.45 ≤ Q = 164843.45 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 164843.45 ≤ Q = 164843.45 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 164843.45 ≤ Q = 164843.45 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 164843.45 ≤ Q = 164843.45 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 164843.45 ≤ Q = 164843.45 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 164843.45 ≤ Q = 164843.45 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 164843.45 ≤ Q = 164843.45 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 164843.45 ≤ Q = 164843.45 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 164843.45 ≤ Q = 164843.45 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 164843.45 ≤ Q = 164843.45 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 164843.45 ≤ Q = 164843.45 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 164843.45 ≤ Q = 164843.45 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 164843.45 ≤ Q = 164843.45 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 164843.45 ≤ Q = 164843.45 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 164843.45 ≤ Q = 164843.45 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 164843.45 ≤ Q = 164843.45 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 16] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x386e0357
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x386e0357
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [3e-01, 2e+02]
Found heuristic solution: objective 1.331503e+13
Presolve removed 2587 rows and 1877 columns
Presolve time: 0.01s
Presolved: 506 rows, 512 columns, 1429 nonzeros
Found heuristic solution: objective 6469157.8114
Variable types: 346 continuous, 166 integer (166 binary)
Found heuristic solution: objective 6468849.2222

Root relaxation: objective -1.565675e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -156567.54    0  122 6468849.22 -156567.54   102%     -    0s
H    0     0                    -111729.6243 -156567.54  40.1%     -    0s
H    0     0                    -111817.1954 -156567.54  40.0%     -    0s
H    0     0                    -118842.4148 -156567.54  31.7%     -    0s
     0     0 -130306.45    0   95 -118842.41 -130306.45  9.65%     -    0s
H    0     0                    -125762.1610 -130219.53  3.54%     -    0s
H    0     0                    -126648.3790 -129150.63  1.98%     -    0s
     0     0 -129150.63    0  106 -126648.38 -129150.63  1.98%     -    0s
     0     0 -128878.62    0   54 -126648.38 -128878.62  1.76%     -    0s
H    0     0                    -127947.8245 -128875.54  0.73%     -    0s
     0     0 -128850.04    0   46 -127947.82 -128850.04  0.71%     -    0s
     0     0 -128726.65    0   32 -127947.82 -128726.65  0.61%     -    0s
H    0     0                    -128041.8926 -128720.06  0.53%     -    0s
H    0     0                    -128392.1362 -128720.06  0.26%     -    0s
H    0     0                    -128410.3012 -128720.06  0.24%     -    0s
     0     0 -128710.73    0   62 -128410.30 -128710.73  0.23%     -    0s
     0     0 -128633.79    0   61 -128410.30 -128633.79  0.17%     -    0s
     0     0 -128626.92    0   62 -128410.30 -128626.92  0.17%     -    0s
     0     0 -128626.92    0   62 -128410.30 -128626.92  0.17%     -    0s
     0     0 -128626.92    0   62 -128410.30 -128626.92  0.17%     -    0s
     0     0 -128626.92    0   62 -128410.30 -128626.92  0.17%     -    0s
H    0     0                    -128433.8439 -128623.52  0.15%     -    0s
H    0     0                    -128488.2441 -128623.52  0.11%     -    0s
     0     0 -128623.52    0   73 -128488.24 -128623.52  0.11%     -    0s
     0     0 -128623.52    0   42 -128488.24 -128623.52  0.11%     -    0s
     0     0 -128595.33    0   28 -128488.24 -128595.33  0.08%     -    0s
     0     0 -128591.26    0   11 -128488.24 -128591.26  0.08%     -    0s
     0     0 -128589.43    0   11 -128488.24 -128589.43  0.08%     -    0s
     0     0 -128549.45    0    8 -128488.24 -128549.45  0.05%     -    0s
     0     0 -128549.45    0   15 -128488.24 -128549.45  0.05%     -    0s
     0     0 -128507.28    0    9 -128488.24 -128507.28  0.01%     -    0s
H    0     0                    -128493.2029 -128501.79  0.01%     -    0s
     0     0 -128501.79    0    6 -128493.20 -128501.79  0.01%     -    0s

Cutting planes:
  Gomory: 2
  Implied bound: 1
  MIR: 7
  Flow cover: 8
  Relax-and-lift: 2

Explored 1 nodes (1028 simplex iterations) in 0.11 seconds (0.07 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -128493 -128488 -128434 ... -111817

Optimal solution found (tolerance 1.00e-04)
Best objective -1.284932029303e+05, best bound -1.285017941446e+05, gap 0.0067%
  Subproblem solved in 0.13s
  Worst-case operational profit (Z_SP) = 160477.36
  Scenario: 24 demand increases, 36 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -128493.20
  [DEBUG]   S×d_nominal = 288970.56
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 288970.56 + -128493.20 = 160477.36
  [DEBUG]   Current θ from Master = 164843.45
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4366.09 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 17756.65
  Lower Bound (LB) = 19044.82
  Gap (UB-LB) = 3077.9209, Absolute Gap = 3077.9209, Relative Gap = 0.139129
  Not converged yet (gap = 3077.92 > ε = 200)

  [DEBUG] Adding NEW scenario 16 to Master Problem...
  [DEBUG] New scenario pattern: 24 increases, 36 decreases
    [DEBUG] Scenario 16 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 16 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 16]
    [DEBUG]   - Total constraints in model: 261313
    [DEBUG]   - Total variables in model: 108340
  [DEBUG] Total scenarios in Master: 17
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 17
================================================================================
[Iteration 17] Solving Master Problem...
  Current scenarios in Master: 17
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 261313 rows, 108340 columns and 740650 nonzeros
Model fingerprint: 0x097200c2
Variable types: 106081 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 113502 rows and 46092 columns
Presolve time: 2.84s
Presolved: 147811 rows, 62248 columns, 910923 nonzeros
Variable types: 59989 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -327005.3771
Found heuristic solution: objective -184683.4741

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.39s

Barrier statistics:
 Dense cols : 677
 AA' NZ     : 7.300e+06
 Factor NZ  : 1.655e+07 (roughly 200 MB of memory)
 Factor Ops : 4.043e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.24009022e+07  2.48901235e+08  1.34e+05 1.70e+01  9.14e+04     5s
   1  -1.72688594e+07  2.29080520e+08  9.55e+04 6.41e+01  6.48e+04     5s
   2  -6.65068689e+06  1.74306782e+08  3.63e+04 3.69e+00  2.64e+04     5s
   3  -1.06864914e+06  1.35572353e+08  2.46e+03 1.83e+00  2.21e+03     5s
   4  -5.79656977e+05  8.07981137e+07  5.19e+02 7.85e-01  6.34e+02     5s
   5  -4.94443262e+05  4.78961055e+07  2.94e+02 3.93e-01  3.49e+02     5s
   6  -4.00775441e+05  3.34278768e+07  9.21e+01 2.53e-01  1.75e+02     5s
   7  -3.60499672e+05  2.57349027e+07  4.83e+01 1.87e-01  1.20e+02     5s
   8  -2.50135845e+05  2.08968560e+07  4.68e+00 1.48e-01  8.04e+01     5s
   9  -1.51589302e+05  1.07093337e+07  1.70e-01 7.44e-02  4.03e+01     5s
  10  -1.10970934e+05  4.58682092e+06  1.04e-01 3.18e-02  1.74e+01     5s
  11  -7.20751905e+04  1.75031662e+06  4.12e-02 1.18e-02  6.76e+00     6s
  12  -2.93040248e+04  6.16440383e+05  1.13e-02 3.68e-03  2.39e+00     6s
  13  -1.06452453e+04  3.05668332e+05  6.68e-03 1.50e-03  1.17e+00     6s
  14  -1.07128666e+03  1.86461663e+05  5.05e-03 8.14e-04  6.95e-01     6s
  15   8.28945547e+03  1.38797890e+05  4.04e-03 5.25e-04  4.84e-01     6s
  16   1.34008120e+04  1.14074210e+05  3.54e-03 3.75e-04  3.73e-01     6s
  17   2.39965461e+04  9.49892276e+04  2.50e-03 2.61e-04  2.63e-01     6s
  18   2.84024479e+04  8.17043503e+04  2.06e-03 1.83e-04  1.98e-01     6s
  19   3.08885090e+04  7.50026238e+04  1.80e-03 1.44e-04  1.64e-01     6s
  20   3.61777251e+04  6.71627417e+04  1.27e-03 9.79e-05  1.15e-01     6s
  21   3.82151140e+04  6.18783414e+04  1.09e-03 6.58e-05  8.78e-02     6s
  22   4.21180878e+04  5.83403332e+04  7.38e-04 4.41e-05  6.02e-02     7s
  23   4.37189909e+04  5.55988419e+04  5.95e-04 2.81e-05  4.41e-02     7s
  24   4.46196528e+04  5.44640161e+04  5.18e-04 2.14e-05  3.65e-02     7s
  25   4.62596703e+04  5.33154875e+04  3.83e-04 1.41e-05  2.62e-02     7s
  26   4.72079137e+04  5.26163977e+04  3.07e-04 9.87e-06  2.01e-02     7s
  27   4.78415103e+04  5.23167563e+04  2.56e-04 7.85e-06  1.66e-02     7s
  28   4.82743553e+04  5.18651914e+04  2.21e-04 5.10e-06  1.33e-02     7s
  29   4.89415037e+04  5.17080520e+04  1.66e-04 4.15e-06  1.03e-02     7s
  30   4.93270076e+04  5.15468733e+04  1.34e-04 3.97e-06  8.23e-03     7s
  31   4.96624459e+04  5.14616122e+04  1.07e-04 2.72e-06  6.67e-03     7s
  32   4.97745860e+04  5.14070818e+04  9.83e-05 2.37e-06  6.05e-03     7s
  33   5.00453361e+04  5.13586119e+04  7.67e-05 2.00e-06  4.87e-03     8s
  34   5.02579780e+04  5.12981279e+04  6.06e-05 1.75e-06  3.86e-03     8s
  35   5.03715969e+04  5.12661437e+04  5.15e-05 1.41e-06  3.32e-03     8s
  36   5.05150260e+04  5.12387093e+04  4.05e-05 1.24e-06  2.68e-03     8s
  37   5.06387435e+04  5.11942319e+04  3.06e-05 9.58e-07  2.06e-03     8s
  38   5.06723436e+04  5.11279794e+04  2.80e-05 5.67e-07  1.69e-03     8s
  39   5.07136113e+04  5.11236786e+04  2.48e-05 5.40e-07  1.52e-03     8s
  40   5.07356503e+04  5.11174602e+04  2.31e-05 5.03e-07  1.42e-03     8s
  41   5.07437079e+04  5.11112637e+04  2.25e-05 4.72e-07  1.36e-03     8s
  42   5.08063076e+04  5.11050293e+04  1.74e-05 4.45e-07  1.11e-03     8s
  43   5.08275876e+04  5.10925102e+04  1.57e-05 3.65e-07  9.83e-04     9s
  44   5.08548575e+04  5.10873642e+04  1.36e-05 3.32e-07  8.62e-04     9s
  45   5.09033355e+04  5.10604406e+04  9.90e-06 1.42e-07  5.83e-04     9s
  46   5.09185659e+04  5.10558004e+04  8.65e-06 1.17e-07  5.09e-04     9s
  47   5.09529512e+04  5.10516001e+04  6.07e-06 9.14e-08  3.66e-04     9s
  48   5.09660229e+04  5.10487904e+04  5.06e-06 7.73e-08  3.07e-04     9s
  49   5.09990604e+04  5.10441881e+04  2.62e-06 1.72e-07  1.67e-04     9s
  50   5.10178336e+04  5.10433267e+04  1.21e-06 1.57e-07  9.46e-05     9s
  51   5.10187960e+04  5.10380337e+04  1.14e-06 5.80e-08  7.14e-05     9s
  52   5.10268794e+04  5.10372974e+04  5.46e-07 4.47e-08  3.86e-05     9s
  53   5.10282276e+04  5.10371427e+04  4.52e-07 4.18e-08  3.31e-05    10s
  54   5.10346422e+04  5.10350388e+04  6.58e-08 1.62e-09  1.48e-06    10s
  55   5.10348910e+04  5.10348942e+04  8.88e-09 1.05e-08  1.18e-08    10s
  56   5.10348916e+04  5.10348936e+04  9.59e-07 6.12e-08  7.45e-09    10s
  57   5.10348932e+04  5.10348933e+04  1.97e-08 6.26e-08  1.27e-10    10s

Barrier solved model in 57 iterations and 9.95 seconds (18.69 work units)
Optimal objective 5.10348932e+04


Root crossover log...

  122948 DPushes remaining with DInf 0.0000000e+00                10s
   24300 DPushes remaining with DInf 0.0000000e+00                15s
     839 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                21s

    4034 PPushes remaining with PInf 2.1488040e-05                21s
       0 PPushes remaining with PInf 0.0000000e+00                21s

  Push phase complete: Pinf 0.0000000e+00, Dinf 7.2977627e+00     21s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   57960    5.1034893e+04   0.000000e+00   7.297763e+00     21s
   58006    5.1034893e+04   0.000000e+00   0.000000e+00     21s
   58006    5.1034893e+04   0.000000e+00   0.000000e+00     21s
Concurrent spin time: 6.02s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 5.103489e+04, 58006 iterations, 23.79 seconds (32.66 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 51034.8933    0  337 -184683.47 51034.8933   128%     -   28s
H    0     0                    -180113.2797 51034.8933   128%     -   28s
H    0     0                    -171801.1734 51034.8933   130%     -   29s
H    0     0                    -155744.8953 51034.8933   133%     -   29s
H    0     0                    -152219.7574 51034.8933   134%     -   30s
H    0     0                    -151597.1574 51034.8933   134%     -   30s
H    0     0                    -150477.1624 51034.8933   134%     -   31s
H    0     0                    -146566.6208 51034.8933   135%     -   31s
H    0     0                    -144922.3320 51034.8933   135%     -   31s
H    0     0                    -64415.55812 51034.8933   179%     -   31s
H    0     0                    -64404.63317 51034.8933   179%     -   32s
H    0     0                    -18881.85786 51034.8933   370%     -   32s
H    0     0                    -16740.13349 51034.8933   405%     -   32s
H    0     0                    -15126.35926 51034.8933   437%     -   32s
H    0     0                    -15021.28992 51034.8933   440%     -   33s
H    0     0                    -15009.98247 51034.8933   440%     -   33s
     0     0 44570.7224    0  365 -15009.982 44570.7224   397%     -  127s
H    0     0                    -12736.67653 44570.6524   450%     -  129s
H    0     0                    -12368.81320 44570.6524   460%     -  129s
H    0     0                    -11406.08556 44570.6524   491%     -  129s
H    0     0                    -11046.16137 44570.6524   503%     -  129s
H    0     0                    -10981.93513 44570.6524   506%     -  129s
H    0     0                    -9746.715584 44570.6524   557%     -  130s
H    0     0                    -9726.653224 44570.6524   558%     -  130s
     0     0 43859.0185    0  362 -9726.6532 43859.0185   551%     -  171s
     0     0 43802.3845    0  375 -9726.6532 43802.3845   550%     -  181s
     0     0 43785.6012    0  368 -9726.6532 43785.6012   550%     -  185s
     0     0 43760.5949    0  376 -9726.6532 43760.5949   550%     -  195s
     0     0 43744.1717    0  365 -9726.6532 43744.1717   550%     -  199s
     0     0 43673.0726    0  373 -9726.6532 43673.0726   549%     -  213s
     0     0 43659.4051    0  367 -9726.6532 43659.4051   549%     -  218s
     0     0 43626.5623    0  364 -9726.6532 43626.5623   549%     -  225s
     0     0 43624.7804    0  366 -9726.6532 43624.7804   549%     -  227s
     0     0 43621.7208    0  367 -9726.6532 43621.7208   548%     -  231s
     0     0 43599.7162    0  373 -9726.6532 43599.7162   548%     -  236s
     0     0 43594.2977    0  362 -9726.6532 43594.2977   548%     -  240s
     0     0 43563.2965    0  370 -9726.6532 43563.2965   548%     -  248s
     0     0 43559.4221    0  366 -9726.6532 43559.4221   548%     -  251s
     0     0 43550.9243    0  365 -9726.6532 43550.9243   548%     -  254s
     0     0 43483.7696    0  377 -9726.6532 43483.7696   547%     -  266s
     0     0 43482.2841    0  371 -9726.6532 43482.2841   547%     -  269s
     0     0 43482.0277    0  371 -9726.6532 43482.0277   547%     -  269s
     0     0 40621.3004    0  396 -9726.6532 40621.3004   518%     -  338s
H    0     0                    -679.9866022 40621.2421  6074%     -  338s
H    0     0                    1097.9979411 40621.2421  3600%     -  339s
H    0     0                    1526.9851340 40621.2421  2560%     -  339s
H    0     0                    1635.6486723 40621.2421  2383%     -  339s
H    0     0                    1645.9294645 40621.2421  2368%     -  339s
H    0     0                    1647.1374703 40621.2421  2366%     -  339s
H    0     0                    1649.6867317 40621.2421  2362%     -  339s
     0     0 40045.2207    0  421 1649.68673 40045.2207  2327%     -  383s
     0     0 39866.1636    0  439 1649.68673 39866.1636  2317%     -  417s
     0     0 39550.7112    0  419 1649.68673 39550.7112  2297%     -  457s
     0     0 39477.5121    0  466 1649.68673 39477.5121  2293%     -  477s
     0     0 39458.7431    0  465 1649.68673 39458.7431  2292%     -  485s
     0     0 39359.9488    0  448 1649.68673 39359.9488  2286%     -  506s
     0     0 39318.5602    0  444 1649.68673 39318.5602  2283%     -  518s
     0     0 39309.6936    0  464 1649.68673 39309.6936  2283%     -  525s
     0     0 39299.7878    0  445 1649.68673 39299.7878  2282%     -  530s
     0     0 39294.7371    0  445 1649.68673 39294.7371  2282%     -  536s
     0     0 39285.5242    0  490 1649.68673 39285.5242  2281%     -  542s
     0     0 39282.2482    0  436 1649.68673 39282.2482  2281%     -  544s
     0     0 39281.8975    0  456 1649.68673 39281.8975  2281%     -  545s
     0     0 37607.9681    0  441 1649.68673 37607.9681  2180%     -  652s
H    0     0                    5509.9657535 37607.5063   583%     -  653s
H    0     0                    6405.3054062 37607.5063   487%     -  654s
H    0     0                    6469.5500838 37607.5063   481%     -  654s
     0     0 37207.5065    0  447 6469.55008 37207.5065   475%     -  695s
     0     0 37095.9200    0  462 6469.55008 37095.9200   473%     -  720s
     0     0 37022.8977    0  451 6469.55008 37022.8977   472%     -  737s
     0     0 36970.4660    0  472 6469.55008 36970.4660   471%     -  753s
     0     0 36943.3750    0  471 6469.55008 36943.3750   471%     -  765s
     0     0 36926.2561    0  469 6469.55008 36926.2561   471%     -  776s
     0     0 36910.8358    0  485 6469.55008 36910.8358   471%     -  788s
     0     0 36901.0667    0  493 6469.55008 36901.0667   470%     -  796s
     0     0 36898.7585    0  485 6469.55008 36898.7585   470%     -  800s
     0     0 36886.8018    0  479 6469.55008 36886.8018   470%     -  807s
     0     0 36884.2203    0  488 6469.55008 36884.2203   470%     -  811s
     0     0 36883.8186    0  483 6469.55008 36883.8186   470%     -  813s
     0     0 36324.9562    0  528 6469.55008 36324.9562   461%     -  880s
H    0     0                    7377.9205017 36324.8958   392%     -  881s
H    0     0                    7691.7900783 36324.8958   372%     -  881s
     0     0 36265.1463    0  511 7691.79008 36265.1463   371%     -  905s
     0     0 36240.5001    0  549 7691.79008 36240.5001   371%     -  919s
     0     0 36180.7681    0  550 7691.79008 36180.7681   370%     -  942s
     0     0 36154.5088    0  524 7691.79008 36154.5088   370%     -  953s
     0     0 36150.2957    0  529 7691.79008 36150.2957   370%     -  957s
     0     0 36126.9826    0  513 7691.79008 36126.9826   370%     -  965s
     0     0 36120.8681    0  516 7691.79008 36120.8681   370%     -  972s
     0     0 36118.9943    0  517 7691.79008 36118.9943   370%     -  974s
     0     0 36030.4253    0  464 7691.79008 36030.4253   368%     -  998s
H    0     0                    9139.7143940 36029.6319   294%     -  999s
H    0     0                    9373.7163185 36029.6319   284%     -  999s
H    0     0                    9377.6380122 36029.6319   284%     -  999s
     0     0 35997.6379    0  552 9377.63801 35997.6379   284%     - 1016s
     0     0 35987.8914    0  485 9377.63801 35987.8914   284%     - 1022s
     0     0 35982.3148    0  534 9377.63801 35982.3148   284%     - 1031s
     0     0 35975.2624    0  533 9377.63801 35975.2624   284%     - 1039s
     0     0 35969.4363    0  534 9377.63801 35969.4363   284%     - 1045s
     0     0 35967.9307    0  537 9377.63801 35967.9307   284%     - 1048s
     0     0 35930.8452    0  482 9377.63801 35930.8452   283%     - 1065s
H    0     0                    9650.5439857 35930.7414   272%     - 1065s
H    0     0                    9653.6906839 35930.7414   272%     - 1066s
H    0     0                    9685.1402062 35930.7414   271%     - 1066s
     0     0 35914.6632    0  489 9685.14021 35914.6632   271%     - 1076s
     0     0 35906.0538    0  520 9685.14021 35906.0538   271%     - 1085s
     0     0 35901.4992    0  532 9685.14021 35901.4992   271%     - 1092s
     0     0 35898.7386    0  531 9685.14021 35898.7386   271%     - 1096s
     0     0 35896.5322    0  497 9685.14021 35896.5322   271%     - 1101s
     0     0 35896.2500    0  495 9685.14021 35896.2500   271%     - 1102s
     0     0 35868.0974    0  577 9685.14021 35868.0974   270%     - 1118s
H    0     0                    9731.3571994 35867.6523   269%     - 1119s
H    0     0                    9900.8325858 35867.6523   262%     - 1119s
     0     0 35847.1312    0  587 9900.83259 35847.1312   262%     - 1130s
     0     0 35837.6921    0  552 9900.83259 35837.6921   262%     - 1135s
     0     0 35833.4689    0  581 9900.83259 35833.4689   262%     - 1142s
     0     0 35832.8301    0  588 9900.83259 35832.8301   262%     - 1144s
     0     0 35821.6046    0  575 9900.83259 35821.6046   262%     - 1157s
H    0     0                    11082.171226 35821.5712   223%     - 1158s
H    0     0                    11206.306946 35821.5712   220%     - 1158s
H    0     0                    11227.375925 35821.5712   219%     - 1158s
     0     0 35813.9956    0  577 11227.3759 35813.9956   219%     - 1164s
     0     0 35812.3909    0  543 11227.3759 35812.3909   219%     - 1168s
     0     0 35793.5475    0  570 11227.3759 35793.5475   219%     - 1186s
H    0     0                    11255.595076 35793.5373   218%     - 1187s
     0     0 35787.1311    0  487 11255.5951 35787.1311   218%     - 1194s
     0     0 35784.7945    0  504 11255.5951 35784.7945   218%     - 1201s
     0     0 35784.0726    0  506 11255.5951 35784.0726   218%     - 1203s
     0     0 35778.1333    0  533 11255.5951 35778.1333   218%     - 1216s
H    0     0                    11256.162999 35777.9256   218%     - 1217s
     0     0 35775.1759    0  544 11256.1630 35775.1759   218%     - 1222s
     0     0 35773.6970    0  544 11256.1630 35773.6970   218%     - 1226s
     0     0 35772.5501    0  548 11256.1630 35772.5501   218%     - 1234s
     0     0 35744.7569    0  549 11256.1630 35744.7569   218%     - 1248s
     0     0 35739.4825    0  551 11256.1630 35739.4825   218%     - 1253s
     0     0 35736.4073    0  556 11256.1630 35736.4073   217%     - 1256s
     0     0 35734.9311    0  557 11256.1630 35734.9311   217%     - 1258s
     0     0 35731.9472    0  549 11256.1630 35731.9472   217%     - 1263s
H    0     0                    11280.281144 35731.8960   217%     - 1265s
H    0     0                    11280.849067 35731.8960   217%     - 1265s
     0     0 35730.4674    0  598 11280.8491 35730.4674   217%     - 1269s
     0     0 35728.6992    0  563 11280.8491 35728.6992   217%     - 1277s
     0     0 35728.3964    0  552 11280.8491 35728.3964   217%     - 1280s
     0     0 35709.9807    0  538 11280.8491 35709.9807   217%     - 1295s
H    0     0                    11408.912678 35709.9771   213%     - 1296s
H    0     0                    11626.989047 35709.9771   207%     - 1297s
     0     0 35703.4664    0  545 11626.9890 35703.4664   207%     - 1303s
     0     0 35699.9599    0  547 11626.9890 35699.9599   207%     - 1308s
     0     0 35698.8196    0  590 11626.9890 35698.8196   207%     - 1313s
     0     0 35693.8806    0  563 11626.9890 35693.8806   207%     - 1320s
     0     0 35693.6152    0  563 11626.9890 35693.6152   207%     - 1328s
H    0     0                    11641.227712 35693.6152   207%     - 1507s
H    0     0                    11841.699395 35693.6152   201%     - 1550s
H    0     0                    12298.518114 35693.6152   190%     - 1550s
H    0     0                    12318.174913 35693.6152   190%     - 1551s
H    0     0                    12491.047124 35693.6152   186%     - 1551s
H    0     2                    12755.645993 35693.6152   180%     - 1556s
     0     2 35693.6152    0  563 12755.6460 35693.6152   180%     - 1556s
     1     3 35134.2107    1  517 12755.6460 35693.2417   180% 15576 1586s
     2     4 35256.3224    1  531 12755.6460 35256.3224   176% 13706 1609s
     3     6 35125.8090    2  543 12755.6460 35256.2714   176% 12652 1634s
     5    12 34396.1268    3  496 12755.6460 35256.2714   176% 13072 1663s
    11    21 33415.2774    4  468 12755.6460 35083.7009   175% 11491 1738s
    20    30 32785.2588    4  526 12755.6460 35083.7009   175% 23231 1844s
H   29    58                    12881.424144 34612.5190   169% 21320 2072s
H   30    58                    13926.590722 34612.5190   149% 21055 2072s
H   41    58                    13985.524437 34612.5190   147% 19448 2072s
    57    90 34261.9533    6  590 13985.5244 34448.2797   146% 27428 2128s
H   89   140                    15198.292247 34424.2771   127% 25398 2195s
H   93   140                    16334.071674 34424.2771   111% 25167 2195s
H  113   140                    16383.849084 34424.2771   110% 22892 2195s
H  125   140                    16492.247591 34424.2182   109% 22351 2195s
H  130   140                    16634.068285 34424.2182   107% 22242 2195s
H  132   140                    16671.230032 34424.2182   106% 22132 2195s
   139   238 33140.3455    8  539 16671.2300 34424.2182   106% 21818 2251s
   237   268 32846.4502    9  521 16671.2300 34424.2182   106% 15264 2284s
H  241   268                    19182.379960 34424.2182  79.5% 15116 2284s
H  243   268                    21619.529782 34424.2182  59.2% 15036 2284s
   267   337 32732.3690   10  534 21619.5298 34424.2182  59.2% 14514 2326s
H  269   337                    21735.602430 34424.2182  58.4% 14424 2326s
H  270   337                    21758.341504 34424.2182  58.2% 14438 2326s
H  271   337                    21929.249388 34424.2182  57.0% 14420 2326s
H  272   337                    21963.526304 34424.2182  56.7% 14390 2326s
H  290   337                    21967.568484 34424.2182  56.7% 14033 2326s
   336   389 32668.9035   12  528 21967.5685 34424.2182  56.7% 13283 2361s
   388   437 31831.4244   13  406 21967.5685 34424.2182  56.7% 12927 2396s
H  391   437                    22028.397756 34424.2182  56.3% 12916 2396s
   437   469 32487.5099   12  533 22028.3978 34424.2182  56.3% 12373 2433s
H  477   508                    22032.319449 34424.2182  56.2% 12159 2469s
H  481   508                    22035.920592 34424.2182  56.2% 12125 2469s
H  505   508                    22036.412041 34424.2182  56.2% 11898 2469s
   524   552 29665.3174   15  334 22036.4120 34424.2182  56.2% 11823 2500s
   582   622 29628.9946   16  400 22036.4120 34424.2182  56.2% 11524 2536s
   654   709 25675.5700   18  118 22036.4120 34424.2182  56.2% 11091 2575s
   747   765 25235.8822   19  100 22036.4120 34424.2182  56.2% 10442 2606s
   831   771 infeasible   20      22036.4120 34424.2182  56.2%  9887 2635s
   919   788 24271.0110   22  163 22036.4120 34424.2182  56.2%  9419 2665s
   966   823 infeasible   23      22036.4120 34424.2182  56.2%  9331 2696s
H  971   823                    22076.910329 34424.2182  55.9%  9346 2696s
H  976   823                    22207.739502 34424.2182  55.0%  9341 2696s
  1014   896 infeasible   18      22207.7395 34424.2182  55.0%  9283 2724s
H 1018   896                    22267.930617 34424.2182  54.6%  9268 2724s
  1109   997 25358.6221   41   72 22267.9306 34424.2182  54.6%  8937 2757s
  1253  1073 24562.7986   48   61 22267.9306 34424.2182  54.6%  8396 2791s
  1395  1125 22678.5116   56   50 22267.9306 34424.2182  54.6%  7923 2823s
  1561  1237 22391.3444   62   40 22267.9306 34424.2182  54.6%  7419 2854s
  1756  1237 22481.3612   52   42 22267.9306 34424.2182  54.6%  6847 2855s
  1762  1268     cutoff   55      22267.9306 34424.2182  54.6%  6831 2887s
  1962  1279 infeasible   46      22267.9306 34279.4193  53.9%  6340 2921s
H 1987  1279                    22363.988332 34279.4193  53.3%  6312 2921s
H 2064  1300                    22409.498472 34279.4193  53.0%  6234 2956s
H 2075  1300                    22427.628463 34279.4193  52.8%  6231 2956s
  2111  1335 infeasible   34      22427.6285 34279.4193  52.8%  6270 2993s
  2190  1345 24453.9107   33  269 22427.6285 34279.4193  52.8%  6280 3030s
  2238  1388 24438.0635   34  263 22427.6285 34279.4193  52.8%  6293 3070s
  2313  1416 24381.9110   35  257 22427.6285 34279.4193  52.8%  6279 3111s
  2409  1479 23997.3912   38  188 22427.6285 34279.4193  52.8%  6275 3154s
  2516  1479 23675.5882   44  159 22427.6285 34279.4193  52.8%  6256 3201s
  2623  1493 infeasible   46      22427.6285 34214.3082  52.6%  6239 3250s
  2659  1519 27633.1205    8  240 22427.6285 34214.2169  52.6%  6386 3300s
  2707  1544 29255.7773   18  413 22427.6285 34214.2169  52.6%  6517 3345s
  2742  1587 23268.0393   13  319 22427.6285 34214.2169  52.6%  6654 3387s
  2799  1633     cutoff   14      22427.6285 34214.2169  52.6%  6743 3427s
  2890  1695 26290.8610   19  332 22427.6285 34214.2169  52.6%  6796 3475s
  3007  1720 infeasible   20      22427.6285 34214.0917  52.6%  6864 3521s
  3042  1739 33019.4022    6  524 22427.6285 34214.0917  52.6%  6987 3570s
  3099  1747 25509.1102   25  239 22427.6285 34214.0917  52.6%  7065 3600s

Cutting planes:
  Gomory: 4
  Implied bound: 203
  MIR: 3650
  Flow cover: 4132
  Zero half: 3
  RLT: 132
  Relax-and-lift: 791

Explored 3131 nodes (22901683 simplex iterations) in 3600.06 seconds (7886.73 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 22427.6 22409.5 22364 ... 22028.4

Time limit reached
Best objective 2.242762846299e+04, best bound 3.421409172531e+04, gap 52.5533%
  WARNING: Time limit reached. Using best solution found (gap: 52.55%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = 22427.63, θ = 166530.60
  Upper Bound (UB) = 22427.63

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 166530.60
  [DEBUG]   ✓ Scenario 0: θ = 166530.60 ≤ Q = 166530.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 166530.60 ≤ Q = 166530.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 166530.60 ≤ Q = 166530.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 166530.60 ≤ Q = 166530.60 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 166530.60 ≤ Q = 166530.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 166530.60 ≤ Q = 166530.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 166530.60 ≤ Q = 166530.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 166530.60 ≤ Q = 166530.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 166530.60 ≤ Q = 166530.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 166530.60 ≤ Q = 166530.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 166530.60 ≤ Q = 166530.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 166530.60 ≤ Q = 166530.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 166530.60 ≤ Q = 166530.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 166530.60 ≤ Q = 166530.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 166530.60 ≤ Q = 166530.60 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 166530.60 ≤ Q = 166530.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 166530.60 ≤ Q = 166530.60 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 17] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x4eb69ed3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xb149612d
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [2e-16, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [7e-19, 2e+02]
Found heuristic solution: objective 1.351339e+13
Presolve removed 2575 rows and 1867 columns
Presolve time: 0.01s
Presolved: 518 rows, 522 columns, 1461 nonzeros
Found heuristic solution: objective 6859763.4564
Variable types: 354 continuous, 168 integer (168 binary)

Root relaxation: objective -1.541188e+05, 249 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -154118.79    0  123 6859763.46 -154118.79   102%     -    0s
H    0     0                    -119269.2154 -154118.79  29.2%     -    0s
H    0     0                    -120066.6876 -154118.79  28.4%     -    0s
     0     0 -131589.42    0   67 -120066.69 -131589.42  9.60%     -    0s
H    0     0                    -128801.8559 -131471.76  2.07%     -    0s
H    0     0                    -129152.7801 -131471.76  1.80%     -    0s
H    0     0                    -129187.5574 -131471.76  1.77%     -    0s
H    0     0                    -129538.4817 -131471.76  1.49%     -    0s
     0     0 -130538.52    0   88 -129538.48 -130538.52  0.77%     -    0s
H    0     0                    -129747.1970 -130485.09  0.57%     -    0s
     0     0 -130476.98    0   84 -129747.20 -130476.98  0.56%     -    0s
H    0     0                    -129796.9675 -130476.98  0.52%     -    0s
     0     0 -130231.00    0   38 -129796.97 -130231.00  0.33%     -    0s
     0     0 -130211.97    0   37 -129796.97 -130211.97  0.32%     -    0s
     0     0 -130190.74    0   37 -129796.97 -130190.74  0.30%     -    0s
     0     0 -130127.77    0   16 -129796.97 -130127.77  0.25%     -    0s
     0     0 -130056.07    0   18 -129796.97 -130056.07  0.20%     -    0s
     0     0 -130055.99    0   15 -129796.97 -130055.99  0.20%     -    0s
     0     0 -129995.60    0   10 -129796.97 -129995.60  0.15%     -    0s
H    0     0                    -129801.2160 -129994.14  0.15%     -    0s
     0     0 -129994.14    0   10 -129801.22 -129994.14  0.15%     -    0s
     0     0 -129949.59    0    7 -129801.22 -129949.59  0.11%     -    0s
H    0     0                    -129839.7224 -129949.59  0.08%     -    0s
     0     0 -129947.78    0    7 -129839.72 -129947.78  0.08%     -    0s
     0     0 -129931.50    0    8 -129839.72 -129931.50  0.07%     -    0s
     0     0 -129931.50    0   35 -129839.72 -129931.50  0.07%     -    0s
     0     0 -129888.93    0    8 -129839.72 -129888.93  0.04%     -    0s
H    0     0                    -129850.3716 -129885.98  0.03%     -    0s
     0     0 -129877.46    0    7 -129850.37 -129877.46  0.02%     -    0s
     0     0 -129865.23    0    2 -129850.37 -129865.23  0.01%     -    0s
     0     0 -129865.23    0    9 -129850.37 -129865.23  0.01%     -    0s
H    0     0                    -129861.1291 -129865.23  0.00%     -    0s

Explored 1 nodes (828 simplex iterations) in 0.13 seconds (0.06 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -129861 -129850 -129840 ... -120067

Optimal solution found (tolerance 1.00e-04)
Best objective -1.298611291081e+05, best bound -1.298652291436e+05, gap 0.0032%
  Subproblem solved in 0.15s
  Worst-case operational profit (Z_SP) = 159173.78
  Scenario: 24 demand increases, 36 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -129861.13
  [DEBUG]   S×d_nominal = 289034.91
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 289034.91 + -129861.13 = 159173.78
  [DEBUG]   Current θ from Master = 166530.60
  [DEBUG]   ⚠️  Z_SP ≤ θ by 7356.82 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 15070.81
  Lower Bound (LB) = 19044.82
  Gap (UB-LB) = 3382.8097, Absolute Gap = 3382.8097, Relative Gap = 0.150832
  Not converged yet (gap = 3382.81 > ε = 200)

  [DEBUG] Adding NEW scenario 17 to Master Problem...
  [DEBUG] New scenario pattern: 24 increases, 36 decreases
    [DEBUG] Scenario 17 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 17 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 17]
    [DEBUG]   - Total constraints in model: 276603
    [DEBUG]   - Total variables in model: 114580
  [DEBUG] Total scenarios in Master: 18
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 18
================================================================================
[Iteration 18] Solving Master Problem...
  Current scenarios in Master: 18
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 276603 rows, 114580 columns and 783893 nonzeros
Model fingerprint: 0xbcf2efb0
Variable types: 112321 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 120188 rows and 48808 columns
Presolve time: 3.12s
Presolved: 156415 rows, 65772 columns, 963404 nonzeros
Variable types: 63513 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -326728.6770
Found heuristic solution: objective -184683.4741

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.42s

Barrier statistics:
 Dense cols : 677
 AA' NZ     : 8.073e+06
 Factor NZ  : 1.834e+07 (roughly 240 MB of memory)
 Factor Ops : 4.736e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.33047857e+07  2.61663912e+08  1.39e+05 1.67e+01  9.46e+04     5s
   1  -1.79817835e+07  2.42129270e+08  9.93e+04 6.42e+01  6.71e+04     5s
   2  -7.25924565e+06  1.84138703e+08  3.96e+04 7.46e+00  2.86e+04     5s
   3  -2.85120037e+06  1.50405521e+08  1.18e+04 1.60e+00  8.83e+03     5s
   4  -7.96529961e+05  1.16396601e+08  1.01e+03 9.09e-01  1.09e+03     6s
   5  -5.51339882e+05  5.10080825e+07  6.04e+02 2.68e-01  5.42e+02     6s
   6  -3.77342208e+05  3.66943166e+07  1.42e+02 1.80e-01  2.10e+02     6s
   7  -3.43846474e+05  2.72127509e+07  9.34e+01 1.25e-01  1.44e+02     6s
   8  -2.64867742e+05  1.84478370e+07  3.09e+01 7.76e-02  7.89e+01     6s
   9  -1.64314184e+05  1.45511107e+07  4.61e+00 5.94e-02  5.33e+01     6s
  10  -1.09077363e+05  6.87476258e+06  1.45e+00 2.73e-02  2.48e+01     6s
  11  -8.23375272e+04  2.37448263e+06  5.79e-01 9.11e-03  8.66e+00     6s
  12  -5.51668029e+04  8.85045471e+05  2.34e-01 3.30e-03  3.30e+00     6s
  13  -2.40626401e+04  3.22874236e+05  1.17e-01 1.17e-03  1.22e+00     6s
  14  -1.38304972e+04  2.08831737e+05  9.17e-02 1.12e-03  7.82e-01     6s
  15  -4.41463742e+03  1.64154136e+05  7.42e-02 2.08e-03  5.92e-01     6s
  16   1.10641459e+04  1.26994418e+05  5.06e-02 2.32e-03  4.07e-01     6s
  17   1.53056573e+04  1.15008486e+05  4.49e-02 2.35e-03  3.50e-01     6s
  18   2.43553736e+04  9.69601402e+04  3.32e-02 1.60e-03  2.55e-01     6s
  19   2.92206564e+04  8.26475192e+04  2.67e-02 1.12e-03  1.88e-01     6s
  20   3.43456619e+04  7.63688365e+04  1.98e-02 8.91e-04  1.48e-01     7s
  21   3.64684189e+04  6.96935221e+04  1.68e-02 7.28e-04  1.17e-01     7s
  22   3.95519905e+04  6.61226461e+04  1.30e-02 5.88e-04  9.33e-02     7s
  23   4.09384562e+04  6.10201859e+04  1.13e-02 3.82e-04  7.05e-02     7s
  24   4.30738899e+04  5.83309502e+04  8.89e-03 2.72e-04  5.36e-02     7s
  25   4.44126950e+04  5.64136997e+04  7.40e-03 1.97e-04  4.21e-02     7s
  26   4.55978226e+04  5.47539857e+04  6.11e-03 1.33e-04  3.22e-02     7s
  27   4.65267324e+04  5.40436764e+04  5.11e-03 1.19e-04  2.64e-02     7s
  28   4.77749615e+04  5.35976991e+04  3.80e-03 9.04e-05  2.05e-02     7s
  29   4.83468861e+04  5.30979761e+04  3.20e-03 7.16e-05  1.67e-02     7s
  30   4.89629085e+04  5.27456537e+04  2.57e-03 4.94e-05  1.33e-02     7s
  31   4.93026221e+04  5.25175793e+04  2.22e-03 4.55e-05  1.13e-02     8s
  32   4.97701718e+04  5.22282988e+04  1.75e-03 3.12e-05  8.64e-03     8s
  33   5.00819728e+04  5.20613334e+04  1.43e-03 2.37e-05  6.95e-03     8s
  34   5.03199947e+04  5.19714647e+04  1.18e-03 1.96e-05  5.80e-03     8s
  35   5.04702016e+04  5.17691400e+04  1.03e-03 1.75e-05  4.56e-03     8s
  36   5.07074565e+04  5.17286443e+04  7.97e-04 1.45e-05  3.59e-03     8s
  37   5.08116648e+04  5.16579660e+04  6.95e-04 9.03e-06  2.97e-03     8s
  38   5.09763205e+04  5.16450554e+04  5.35e-04 8.09e-06  2.35e-03     8s
  39   5.10110602e+04  5.16190372e+04  5.02e-04 6.37e-06  2.14e-03     8s
  40   5.12643357e+04  5.15924555e+04  2.50e-04 4.41e-06  1.15e-03     8s
  41   5.13523609e+04  5.15733098e+04  1.64e-04 3.13e-06  7.76e-04     8s
  42   5.13681149e+04  5.15533722e+04  1.49e-04 1.78e-06  6.51e-04     9s
  43   5.14309035e+04  5.15504594e+04  8.81e-05 1.56e-06  4.20e-04     9s
  44   5.14606566e+04  5.15390949e+04  6.00e-05 7.03e-07  2.76e-04     9s
  45   5.14906044e+04  5.15348736e+04  3.16e-05 7.27e-07  1.56e-04     9s
  46   5.15057952e+04  5.15310812e+04  1.76e-05 3.79e-07  8.89e-05     9s
  47   5.15204764e+04  5.15293247e+04  5.29e-06 1.71e-07  3.11e-05     9s
  48   5.15210096e+04  5.15277469e+04  4.86e-06 6.05e-07  2.37e-05     9s
  49   5.15233092e+04  5.15276452e+04  3.11e-06 2.65e-07  1.52e-05     9s
  50   5.15234921e+04  5.15276352e+04  2.97e-06 2.38e-07  1.46e-05     9s
  51   5.15238551e+04  5.15276156e+04  2.68e-06 1.88e-06  1.32e-05     9s
  52   5.15271610e+04  5.15274733e+04  1.51e-07 3.05e-07  1.10e-06     9s
  53   5.15274093e+04  5.15274318e+04  2.84e-07 1.51e-06  7.96e-08     9s
  54   5.15274220e+04  5.15274301e+04  2.72e-07 1.99e-09  2.90e-08     9s
  55   5.15274229e+04  5.15274301e+04  4.28e-06 2.79e-09  2.51e-08    10s
  56   5.15274267e+04  5.15274301e+04  6.26e-06 1.73e-09  1.17e-08    10s
  57   5.15274269e+04  5.15274301e+04  9.28e-06 4.54e-08  1.15e-08    10s
  58   5.15274283e+04  5.15274301e+04  5.28e-06 2.68e-07  6.55e-09    10s
  59   5.15274301e+04  5.15274301e+04  1.78e-07 3.26e-07  2.21e-10    10s

Barrier solved model in 59 iterations and 9.90 seconds (18.34 work units)
Optimal objective 5.15274301e+04


Root crossover log...

  128317 DPushes remaining with DInf 0.0000000e+00                10s
   65266 DPushes remaining with DInf 0.0000000e+00                12s
   38996 DPushes remaining with DInf 0.0000000e+00                15s
    7623 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                25s

    5955 PPushes remaining with PInf 3.3237077e-05                25s
    3938 PPushes remaining with PInf 1.3626094e-05                25s
       0 PPushes remaining with PInf 0.0000000e+00                26s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.3534183e+02     26s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   65053    5.1527430e+04   0.000000e+00   2.353418e+02     26s
   65113    5.1527430e+04   0.000000e+00   0.000000e+00     26s
   65113    5.1527430e+04   0.000000e+00   0.000000e+00     26s
Concurrent spin time: 6.91s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 5.152743e+04, 65113 iterations, 28.80 seconds (40.77 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 51527.4301    0  391 -184683.47 51527.4301   128%     -   33s
H    0     0                    -175225.9243 51527.4301   129%     -   33s
H    0     0                    -72351.17038 51527.4301   171%     -   34s
H    0     0                    -54129.30880 51527.4301   195%     -   34s
H    0     0                    -39895.29007 51527.4301   229%     -   34s
H    0     0                    -6332.267856 51527.4301   914%     -   34s
H    0     0                    -3352.800175 51527.4301  1637%     -   35s
H    0     0                    -3341.712974 51527.4301  1642%     -   35s
     0     0 44871.2884    0  374 -3341.7130 44871.2884  1443%     -  136s
H    0     0                    -954.1526856 44870.9253  4803%     -  138s
H    0     0                     -43.9922423 44870.9253      -     -  139s
H    0     0                     121.4812273 44870.9253      -     -  139s
H    0     0                     226.1225090 44870.9253      -     -  139s
     0     0 44500.0905    0  364  226.12251 44500.0905      -     -  174s
     0     0 44398.6463    0  355  226.12251 44398.6463      -     -  191s
     0     0 44381.4870    0  360  226.12251 44381.4870      -     -  198s
     0     0 44374.9941    0  352  226.12251 44374.9941      -     -  203s
     0     0 44362.8567    0  356  226.12251 44362.8567      -     -  206s
     0     0 44350.8567    0  354  226.12251 44350.8567      -     -  209s
     0     0 44333.4292    0  355  226.12251 44333.4292      -     -  213s
     0     0 44317.5207    0  358  226.12251 44317.5207      -     -  218s
     0     0 44252.7246    0  362  226.12251 44252.7246      -     -  227s
     0     0 44170.8456    0  366  226.12251 44170.8456      -     -  239s
     0     0 44165.5573    0  372  226.12251 44165.5573      -     -  244s
     0     0 44123.7383    0  362  226.12251 44123.7383      -     -  252s
     0     0 44080.1398    0  371  226.12251 44080.1398      -     -  260s
     0     0 44079.6141    0  371  226.12251 44079.6141      -     -  262s
     0     0 40799.6402    0  433  226.12251 40799.6402      -     -  364s
H    0     0                     523.8106581 40799.5734  7689%     -  365s
H    0     0                     976.2286944 40799.5734  4079%     -  365s
H    0     0                    1343.6529184 40799.5734  2936%     -  365s
H    0     0                    4183.2887838 40799.5734   875%     -  365s
H    0     0                    12166.070742 40799.5734   235%     -  366s
H    0     0                    13243.212416 40799.5734   208%     -  366s
H    0     0                    13572.393319 40799.5734   201%     -  366s
     0     0 40116.5204    0  410 13572.3933 40116.5204   196%     -  418s
     0     0 39862.5997    0  470 13572.3933 39862.5997   194%     -  452s
     0     0 39767.9262    0  473 13572.3933 39767.9262   193%     -  472s
     0     0 39737.0767    0  471 13572.3933 39737.0767   193%     -  481s
     0     0 39710.2270    0  477 13572.3933 39710.2270   193%     -  491s
     0     0 39630.9385    0  475 13572.3933 39630.9385   192%     -  507s
     0     0 39557.9396    0  486 13572.3933 39557.9396   191%     -  521s
     0     0 39524.4950    0  485 13572.3933 39524.4950   191%     -  532s
     0     0 39481.0046    0  480 13572.3933 39481.0046   191%     -  544s
     0     0 39466.1460    0  488 13572.3933 39466.1460   191%     -  549s
     0     0 39461.2466    0  487 13572.3933 39461.2466   191%     -  553s
     0     0 39460.8019    0  488 13572.3933 39460.8019   191%     -  554s
     0     0 37922.7363    0  427 13572.3933 37922.7363   179%     -  682s
H    0     0                    14498.267312 37922.5847   162%     -  684s
     0     0 37505.4508    0  467 14498.2673 37505.4508   159%     -  722s
     0     0 37419.6592    0  432 14498.2673 37419.6592   158%     -  740s
     0     0 37391.1729    0  435 14498.2673 37391.1729   158%     -  757s
     0     0 37359.7811    0  435 14498.2673 37359.7811   158%     -  769s
     0     0 37347.3955    0  443 14498.2673 37347.3955   158%     -  776s
     0     0 37332.8522    0  438 14498.2673 37332.8522   157%     -  789s
     0     0 37324.7469    0  439 14498.2673 37324.7469   157%     -  799s
     0     0 37321.4380    0  439 14498.2673 37321.4380   157%     -  805s
     0     0 37319.4095    0  440 14498.2673 37319.4095   157%     -  808s
     0     0 37318.7650    0  438 14498.2673 37318.7650   157%     -  809s
     0     0 36552.7729    0  448 14498.2673 36552.7729   152%     -  886s
     0     0 36360.2820    0  492 14498.2673 36360.2820   151%     -  915s
     0     0 36312.8026    0  474 14498.2673 36312.8026   150%     -  932s
     0     0 36283.1412    0  513 14498.2673 36283.1412   150%     -  946s
     0     0 36256.1267    0  493 14498.2673 36256.1267   150%     -  959s
     0     0 36243.4463    0  495 14498.2673 36243.4463   150%     -  973s
     0     0 36228.9329    0  484 14498.2673 36228.9329   150%     -  982s
     0     0 36224.1089    0  485 14498.2673 36224.1089   150%     -  988s
     0     0 36215.9819    0  482 14498.2673 36215.9819   150%     -  993s
     0     0 36211.1282    0  481 14498.2673 36211.1282   150%     -  998s
     0     0 36210.3231    0  485 14498.2673 36210.3231   150%     - 1001s
     0     0 36062.4811    0  522 14498.2673 36062.4811   149%     - 1036s
H    0     0                    15396.455958 36061.9424   134%     - 1037s
     0     0 36004.2433    0  523 15396.4560 36004.2433   134%     - 1060s
     0     0 35985.3300    0  539 15396.4560 35985.3300   134%     - 1070s
     0     0 35977.2876    0  540 15396.4560 35977.2876   134%     - 1078s
     0     0 35969.8269    0  553 15396.4560 35969.8269   134%     - 1084s
     0     0 35966.6482    0  545 15396.4560 35966.6482   134%     - 1087s
     0     0 35965.5944    0  548 15396.4560 35965.5944   134%     - 1089s
     0     0 35881.0462    0  506 15396.4560 35881.0462   133%     - 1118s
     0     0 35866.6685    0  507 15396.4560 35866.6685   133%     - 1138s
     0     0 35861.5464    0  500 15396.4560 35861.5464   133%     - 1144s
     0     0 35847.7971    0  494 15396.4560 35847.7971   133%     - 1150s
     0     0 35844.8137    0  486 15396.4560 35844.8137   133%     - 1152s
     0     0 35841.2503    0  493 15396.4560 35841.2503   133%     - 1155s
     0     0 35835.6316    0  499 15396.4560 35835.6316   133%     - 1161s
     0     0 35827.0290    0  474 15396.4560 35827.0290   133%     - 1168s
     0     0 35823.9089    0  486 15396.4560 35823.9089   133%     - 1175s
     0     0 35823.0304    0  482 15396.4560 35823.0304   133%     - 1177s
     0     0 35757.2170    0  487 15396.4560 35757.2170   132%     - 1203s
     0     0 35727.0500    0  495 15396.4560 35727.0500   132%     - 1217s
     0     0 35721.0246    0  472 15396.4560 35721.0246   132%     - 1227s
     0     0 35717.7305    0  533 15396.4560 35717.7305   132%     - 1232s
     0     0 35715.9297    0  497 15396.4560 35715.9297   132%     - 1235s
     0     0 35697.9179    0  473 15396.4560 35697.9179   132%     - 1249s
H    0     0                    15405.226760 35697.8981   132%     - 1253s
H    0     0                    15409.975642 35697.8981   132%     - 1253s
     0     0 35689.6958    0  486 15409.9756 35689.6958   132%     - 1265s
     0     0 35686.4293    0  493 15409.9756 35686.4293   132%     - 1271s
     0     0 35685.6019    0  497 15409.9756 35685.6019   132%     - 1273s
     0     0 35670.6943    0  499 15409.9756 35670.6943   131%     - 1289s
     0     0 35652.4790    0  504 15409.9756 35652.4790   131%     - 1300s
     0     0 35648.5746    0  540 15409.9756 35648.5746   131%     - 1306s
     0     0 35648.1081    0  540 15409.9756 35648.1081   131%     - 1309s
     0     0 35642.0510    0  525 15409.9756 35642.0510   131%     - 1317s
     0     0 35639.8717    0  491 15409.9756 35639.8717   131%     - 1325s
     0     0 35637.1447    0  533 15409.9756 35637.1447   131%     - 1332s
     0     0 35636.1430    0  531 15409.9756 35636.1430   131%     - 1334s
     0     0 35632.9368    0  496 15409.9756 35632.9368   131%     - 1342s
H    0     0                    15410.187238 35632.9198   131%     - 1345s
     0     0 35631.8700    0  501 15410.1872 35631.8700   131%     - 1349s
     0     0 35630.6849    0  505 15410.1872 35630.6849   131%     - 1358s
     0     0 35630.6187    0  505 15410.1872 35630.6187   131%     - 1367s
H    0     0                    15414.557287 35630.3866   131%     - 1481s
H    0     0                    19480.775865 35630.3866  82.9%     - 1626s
H    0     0                    19506.351101 35630.3866  82.7%     - 1629s
     0     2 35630.3866    0  505 19506.3511 35630.3866  82.7%     - 1632s
     1     3 35225.1283    1  426 19506.3511 35630.3866  82.7% 12708 1658s
     2     4 35243.8418    1  476 19506.3511 35243.8418  80.7% 13350 1682s
     3     6 34979.2178    2  460 19506.3511 35243.8080  80.7% 13142 1718s
     5    11 34759.7098    3  463 19506.3511 35243.8080  80.7% 14889 1753s
    10    19 34402.2886    4  504 19506.3511 34970.9848  79.3% 14212 1865s
    18    27 33332.9386    4  449 19506.3511 34970.9848  79.3% 27507 1996s
    26    52 32479.6452    4  429 19506.3511 34534.4266  77.0% 25958 2191s
    51    84 31968.4702    5  412 19506.3511 34534.3297  77.0% 29033 2311s
H   77    84                    19543.583720 34534.3297  76.7% 26173 2311s
    83   226 31951.4810    6  409 19543.5837 34534.3297  76.7% 27475 2419s
   225   266 31390.8871   10  386 19543.5837 34534.3297  76.7% 14098 2458s
H  235   266                    19563.343352 34534.3297  76.5% 13697 2458s
H  248   266                    20055.542995 34534.3297  72.2% 13221 2458s
H  262   266                    21145.589171 34534.3297  63.3% 12765 2458s
   265   331 31291.7246   10  377 21145.5892 34534.3297  63.3% 12684 2503s
   330   395 31350.1529   11  319 21145.5892 34534.3297  63.3% 11278 2546s
   394   471 30308.1891   19  222 21145.5892 34534.3297  63.3% 10194 2585s
   470   496 30784.4045   12  371 21145.5892 34534.3297  63.3%  9228 2716s
   499   532 31200.8245   12  318 21145.5892 34534.3297  63.3%  9010 2756s
H  522   532                    21245.705089 34534.3297  62.5%  8835 2756s
   535   562 23985.2574   22  200 21245.7051 34534.3297  62.5%  8774 2796s
   569   582 23754.0136   23  211 21245.7051 34534.3297  62.5%  8677 2832s
   595   607 23519.5408   24  219 21245.7051 34534.3297  62.5%  8587 2874s
   628   629 22149.6754   23  187 21245.7051 34534.3297  62.5%  8379 2914s
H  649   629                    21345.601391 34534.3297  61.8%  8320 2914s
   664   683 21963.0761   24  166 21345.6014 34534.3297  61.8%  8283 2953s
   740   707 infeasible   29      21345.6014 34534.3297  61.8%  7920 2991s
   826   734 infeasible   29      21345.6014 34534.3297  61.8%  7526 3029s
   914   741 22375.2692   28  281 21345.6014 34534.3297  61.8%  7170 3068s
   983   748 infeasible   27      21345.6014 34534.3297  61.8%  6961 3113s
  1034   757 21644.9171   30  245 21345.6014 34534.3297  61.8%  6917 3160s
  1089   768 30459.3444   15  315 21345.6014 34534.3297  61.8%  6838 3209s
  1134   809 29525.2163   16  159 21345.6014 34534.3297  61.8%  6846 3259s
  1190   830 29462.3613   17  161 21345.6014 34534.3297  61.8%  6696 3303s
  1290   856 28693.7414   19  229 21345.6014 34534.3297  61.8%  6432 3352s
  1350   919 28377.0297   21  224 21345.6014 34534.3297  61.8%  6448 3406s
  1427  1002 23658.4312   25  112 21345.6014 34534.3297  61.8%  6411 3459s
  1530  1088 23138.2571   34  108 21345.6014 34534.3297  61.8%  6287 3526s
  1642  1181 22583.1138   44   89 21345.6014 34534.3297  61.8%  6199 3592s
  1767  1186 infeasible   48      21345.6014 34534.3297  61.8%  6070 3600s

Cutting planes:
  Learned: 1
  Implied bound: 134
  MIR: 3750
  Flow cover: 4050
  Zero half: 2
  RLT: 130
  Relax-and-lift: 784
  BQP: 1

Explored 1780 nodes (11442899 simplex iterations) in 3600.05 seconds (7484.57 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 21345.6 21245.7 21145.6 ... 15410.2

Time limit reached
Best objective 2.134560139088e+04, best bound 3.453432970846e+04, gap 61.7866%
  WARNING: Time limit reached. Using best solution found (gap: 61.79%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = 21345.60, θ = 168269.15
  Upper Bound (UB) = 21345.60

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 168269.15
  [DEBUG]   ✓ Scenario 0: θ = 168269.15 ≤ Q = 168269.15 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 168269.15 ≤ Q = 168269.15 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 168269.15 ≤ Q = 168269.15 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 168269.15 ≤ Q = 168269.15 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 168269.15 ≤ Q = 168269.15 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 168269.15 ≤ Q = 168269.15 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 168269.15 ≤ Q = 168269.15 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 168269.15 ≤ Q = 168269.15 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 168269.15 ≤ Q = 168269.15 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 168269.15 ≤ Q = 168269.15 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 168269.15 ≤ Q = 168269.15 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 168269.15 ≤ Q = 168269.15 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 168269.15 ≤ Q = 168269.15 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 168269.15 ≤ Q = 168269.15 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 168269.15 ≤ Q = 168269.15 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 168269.15 ≤ Q = 168269.15 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 168269.15 ≤ Q = 168269.15 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 168269.15 ≤ Q = 168269.15 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 18] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x7910e416
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x86ef1bea
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [3e-01, 2e+02]
Found heuristic solution: objective 1.336300e+13
Presolve removed 2574 rows and 1866 columns
Presolve time: 0.01s
Presolved: 519 rows, 523 columns, 1464 nonzeros
Found heuristic solution: objective 6689908.7086
Variable types: 355 continuous, 168 integer (168 binary)

Root relaxation: objective -1.531886e+05, 251 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -153188.60    0  123 6689908.71 -153188.60   102%     -    0s
H    0     0                    -118206.2727 -153188.60  29.6%     -    0s
H    0     0                    -118372.0865 -153188.60  29.4%     -    0s
     0     0 -129358.71    0   58 -118372.09 -129358.71  9.28%     -    0s
H    0     0                    -127522.4532 -129267.15  1.37%     -    0s
H    0     0                    -127853.5256 -129267.15  1.11%     -    0s
H    0     0                    -128030.8128 -128669.87  0.50%     -    0s
     0     0 -128669.87    0   60 -128030.81 -128669.87  0.50%     -    0s
     0     0 -128598.53    0   56 -128030.81 -128598.53  0.44%     -    0s
     0     0 -128590.85    0   55 -128030.81 -128590.85  0.44%     -    0s
     0     0 -128264.19    0   22 -128030.81 -128264.19  0.18%     -    0s
     0     0 -128252.73    0   18 -128030.81 -128252.73  0.17%     -    0s
     0     0 -128242.89    0   17 -128030.81 -128242.89  0.17%     -    0s
H    0     0                    -128055.1710 -128147.71  0.07%     -    0s
     0     0 -128147.71    0   17 -128055.17 -128147.71  0.07%     -    0s
     0     0 -128140.53    0   17 -128055.17 -128140.53  0.07%     -    0s
     0     0 -128117.06    0    5 -128055.17 -128117.06  0.05%     -    0s
     0     0 -128117.06    0   13 -128055.17 -128117.06  0.05%     -    0s
H    0     0                    -128068.8920 -128117.06  0.04%     -    0s
*    0     0               0    -128093.8212 -128093.82  0.00%     -    0s

Cutting planes:
  Gomory: 6
  MIR: 9
  Flow cover: 5
  Relax-and-lift: 1
  BQP: 1

Explored 1 nodes (696 simplex iterations) in 0.07 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -128094 -128069 -128055 ... 1.3363e+13
No other solutions better than -128094

Optimal solution found (tolerance 1.00e-04)
Best objective -1.280938212230e+05, best bound -1.280938212230e+05, gap 0.0000%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 161784.23
  Scenario: 19 demand increases, 41 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -128093.82
  [DEBUG]   S×d_nominal = 289878.06
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 289878.06 + -128093.82 = 161784.23
  [DEBUG]   Current θ from Master = 168269.15
  [DEBUG]   ⚠️  Z_SP ≤ θ by 6484.91 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 14860.69
  Lower Bound (LB) = 19044.82
  Gap (UB-LB) = 2300.7826, Absolute Gap = 2300.7826, Relative Gap = 0.107787
  Not converged yet (gap = 2300.78 > ε = 200)

  [DEBUG] Adding NEW scenario 18 to Master Problem...
  [DEBUG] New scenario pattern: 19 increases, 41 decreases
    [DEBUG] Scenario 18 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 18 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 18]
    [DEBUG]   - Total constraints in model: 291893
    [DEBUG]   - Total variables in model: 120820
  [DEBUG] Total scenarios in Master: 19
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 19
================================================================================
[Iteration 19] Solving Master Problem...
  Current scenarios in Master: 19
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 291893 rows, 120820 columns and 827136 nonzeros
Model fingerprint: 0xa799746a
Variable types: 118561 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 126874 rows and 51524 columns
Presolve time: 3.26s
Presolved: 165019 rows, 69296 columns, 1016397 nonzeros
Variable types: 67037 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -326728.6770
Found heuristic solution: objective -184683.4741

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.48s

Barrier statistics:
 Dense cols : 677
 AA' NZ     : 8.901e+06
 Factor NZ  : 2.015e+07 (roughly 260 MB of memory)
 Factor Ops : 5.340e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.41883855e+07  2.74063758e+08  1.44e+05 1.64e+01  9.77e+04     6s
   1  -1.86955889e+07  2.54802767e+08  1.03e+05 6.41e+01  6.94e+04     6s
   2  -7.69533020e+06  1.94671310e+08  4.19e+04 5.93e+00  3.01e+04     6s
   3  -1.83732265e+06  1.62235522e+08  6.18e+03 2.18e+00  4.83e+03     6s
   4  -8.58357174e+05  1.41953004e+08  1.13e+03 1.53e+00  1.24e+03     6s
   5  -6.91419988e+05  6.94704701e+07  7.07e+02 5.16e-01  6.58e+02     6s
   6  -5.93774430e+05  5.14714437e+07  3.20e+02 3.48e-01  3.56e+02     6s
   7  -5.14756534e+05  3.70996812e+07  9.27e+01 2.30e-01  1.74e+02     6s
   8  -4.54248634e+05  2.63240128e+07  3.54e+01 1.55e-01  1.05e+02     6s
   9  -3.07588597e+05  2.11723292e+07  6.29e+00 1.22e-01  7.40e+01     6s
  10  -1.86005888e+05  1.10468159e+07  9.68e-01 6.27e-02  3.76e+01     6s
  11  -1.21386624e+05  4.52554430e+06  5.36e-01 2.56e-02  1.55e+01     6s
  12  -9.50075349e+04  1.88288272e+06  3.10e-01 1.08e-02  6.59e+00     6s
  13  -4.90629748e+04  1.18733083e+06  1.19e-01 6.79e-03  4.11e+00     6s
  14  -2.47590217e+04  4.33832605e+05  6.19e-02 2.41e-03  1.53e+00     7s
  15  -9.29179361e+03  2.48190413e+05  4.12e-02 1.15e-03  8.57e-01     7s
  16   7.33855453e+03  1.90586890e+05  2.81e-02 1.24e-03  6.10e-01     7s
  17   1.27380594e+04  1.53613072e+05  2.42e-02 9.12e-04  4.69e-01     7s
  18   2.16275245e+04  1.15523160e+05  1.83e-02 5.52e-04  3.12e-01     7s
  19   2.84879292e+04  9.04366373e+04  1.37e-02 3.90e-04  2.06e-01     7s
  20   3.27870012e+04  8.05390036e+04  1.08e-02 2.99e-04  1.59e-01     7s
  21   3.79470823e+04  7.36589936e+04  7.38e-03 2.56e-04  1.19e-01     7s
  22   3.98750290e+04  6.47753595e+04  6.16e-03 1.65e-04  8.28e-02     7s
  23   4.14863227e+04  6.20401645e+04  5.20e-03 1.39e-04  6.84e-02     7s
  24   4.42824071e+04  5.80116989e+04  3.66e-03 1.15e-04  4.57e-02     7s
  25   4.54484638e+04  5.63695635e+04  3.05e-03 1.03e-04  3.63e-02     8s
  26   4.70473925e+04  5.52827100e+04  2.19e-03 7.92e-05  2.74e-02     8s
  27   4.79658781e+04  5.44527039e+04  1.72e-03 6.12e-05  2.16e-02     8s
  28   4.88471856e+04  5.39262585e+04  1.29e-03 4.95e-05  1.69e-02     8s
  29   4.92885586e+04  5.34185039e+04  1.08e-03 3.90e-05  1.37e-02     8s
  30   4.95499085e+04  5.31970511e+04  9.44e-04 3.43e-05  1.21e-02     8s
  31   4.99191962e+04  5.29564193e+04  7.59e-04 3.05e-05  1.01e-02     8s
  32   5.02094528e+04  5.25898433e+04  6.10e-04 2.20e-05  7.92e-03     8s
  33   5.04248991e+04  5.24071308e+04  5.10e-04 1.83e-05  6.60e-03     8s
  34   5.04915871e+04  5.23457369e+04  4.77e-04 1.70e-05  6.17e-03     8s
  35   5.06733680e+04  5.20956332e+04  3.88e-04 1.18e-05  4.73e-03     9s
  36   5.09484010e+04  5.19130072e+04  2.61e-04 8.03e-06  3.21e-03     9s
  37   5.10974802e+04  5.18164444e+04  1.90e-04 5.76e-06  2.39e-03     9s
  38   5.12932792e+04  5.16645787e+04  9.92e-05 3.45e-06  1.24e-03     9s
  39   5.14156434e+04  5.16002204e+04  4.41e-05 1.85e-06  6.14e-04     9s
  40   5.14300379e+04  5.15743298e+04  3.81e-05 1.21e-06  4.80e-04     9s
  41   5.14424236e+04  5.15679610e+04  3.30e-05 1.02e-06  4.18e-04     9s
  42   5.14584901e+04  5.15553738e+04  2.64e-05 7.93e-07  3.22e-04     9s
  43   5.14784644e+04  5.15518084e+04  1.83e-05 9.26e-07  2.44e-04     9s
  44   5.15119076e+04  5.15320782e+04  5.05e-06 2.99e-07  6.71e-05     9s
  45   5.15230517e+04  5.15301587e+04  1.02e-06 1.99e-07  2.37e-05    10s
  46   5.15234727e+04  5.15300005e+04  8.92e-07 1.90e-07  2.17e-05    10s
  47   5.15246847e+04  5.15278435e+04  5.10e-07 7.44e-08  1.05e-05    10s
  48   5.15260206e+04  5.15264776e+04  7.57e-08 2.06e-08  1.53e-06    10s
  49   5.15260208e+04  5.15264775e+04  1.13e-06 2.06e-08  1.52e-06    10s
  50   5.15260534e+04  5.15264640e+04  8.12e-07 3.03e-08  1.37e-06    10s
  51   5.15263163e+04  5.15263231e+04  1.98e-08 6.52e-08  2.26e-08    10s
  52   5.15263224e+04  5.15263230e+04  3.84e-07 1.50e-07  1.85e-09    10s
  53   5.15263228e+04  5.15263230e+04  8.32e-07 7.05e-08  9.82e-10    10s

Barrier solved model in 53 iterations and 10.27 seconds (18.97 work units)
Optimal objective 5.15263228e+04


Root crossover log...

  135471 DPushes remaining with DInf 0.0000000e+00                10s
   33208 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                19s

   20630 PPushes remaining with PInf 5.2720591e-04                19s
   12851 PPushes remaining with PInf 3.0804013e-04                20s
       0 PPushes remaining with PInf 0.0000000e+00                22s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.6599028e+03     22s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   91477    5.1526323e+04   0.000000e+00   3.659903e+03     22s
   91797    5.1526323e+04   0.000000e+00   0.000000e+00     23s
   91797    5.1526323e+04   0.000000e+00   0.000000e+00     23s
Concurrent spin time: 18.84s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 5.152632e+04, 91797 iterations, 37.55 seconds (50.64 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 51526.3230    0  392 -184683.47 51526.3230   128%     -   42s
H    0     0                    -96727.52512 51526.3230   153%     -   43s
H    0     0                    -64627.79547 51526.3230   180%     -   43s
H    0     0                    -64616.87052 51526.3230   180%     -   44s
H    0     0                    -42067.69287 51526.3230   222%     -   44s
H    0     0                    -14922.28684 51526.3230   445%     -   44s
H    0     0                    -8842.875904 51526.3230   683%     -   44s
H    0     0                    -8737.558920 51526.3230   690%     -   45s
     0     0 44781.4971    0  356 -8737.5589 44781.4971   613%     -  113s
H    0     0                    -5538.278414 44777.3201   909%     -  114s
H    0     0                    -3282.804395 44777.3201  1464%     -  115s
H    0     0                    -2539.769348 44777.3201  1863%     -  115s
     0     0 43856.8878    0  364 -2539.7693 43856.8878  1827%     -  149s
     0     0 43788.5152    0  357 -2539.7693 43788.5152  1824%     -  163s
     0     0 43751.3990    0  358 -2539.7693 43751.3990  1823%     -  170s
     0     0 43722.5484    0  368 -2539.7693 43722.5484  1822%     -  178s
     0     0 43684.5822    0  395 -2539.7693 43684.5822  1820%     -  183s
     0     0 43672.1423    0  397 -2539.7693 43672.1423  1820%     -  188s
     0     0 43667.7942    0  366 -2539.7693 43667.7942  1819%     -  192s
     0     0 43667.4850    0  363 -2539.7693 43667.4850  1819%     -  194s
     0     0 40659.2111    0  466 -2539.7693 40659.2111  1701%     -  266s
H    0     0                    -605.6063615 40659.0077  6814%     -  267s
H    0     0                    2184.9204552 40659.0077  1761%     -  268s
H    0     0                    2654.0792776 40659.0077  1432%     -  268s
H    0     0                    4174.3749157 40659.0077   874%     -  268s
H    0     0                    7342.0852820 40659.0077   454%     -  268s
H    0     0                    7761.6984660 40659.0077   424%     -  268s
H    0     0                    8257.7453668 40659.0077   392%     -  268s
     0     0 40153.7655    0  430 8257.74537 40153.7655   386%     -  311s
     0     0 40071.8043    0  463 8257.74537 40071.8043   385%     -  330s
     0     0 40010.8398    0  476 8257.74537 40010.8398   385%     -  350s
     0     0 39954.8530    0  473 8257.74537 39954.8530   384%     -  368s
     0     0 39734.8428    0  479 8257.74537 39734.8428   381%     -  405s
     0     0 39614.7831    0  494 8257.74537 39614.7831   380%     -  430s
     0     0 39588.7812    0  501 8257.74537 39588.7812   379%     -  444s
     0     0 39578.0220    0  500 8257.74537 39578.0220   379%     -  453s
     0     0 39518.1498    0  503 8257.74537 39518.1498   379%     -  471s
     0     0 39506.0511    0  509 8257.74537 39506.0511   378%     -  477s
     0     0 39494.0574    0  514 8257.74537 39494.0574   378%     -  483s
     0     0 39490.2743    0  511 8257.74537 39490.2743   378%     -  486s
     0     0 39481.9142    0  496 8257.74537 39481.9142   378%     -  492s
     0     0 39477.3321    0  506 8257.74537 39477.3321   378%     -  500s
     0     0 39474.2458    0  502 8257.74537 39474.2458   378%     -  503s
     0     0 39457.1545    0  502 8257.74537 39457.1545   378%     -  509s
     0     0 39448.1238    0  501 8257.74537 39448.1238   378%     -  513s
     0     0 39441.7808    0  500 8257.74537 39441.7808   378%     -  518s
     0     0 39438.3056    0  499 8257.74537 39438.3056   378%     -  520s
     0     0 39424.3503    0  504 8257.74537 39424.3503   377%     -  524s
     0     0 39420.0456    0  509 8257.74537 39420.0456   377%     -  527s
     0     0 39419.5493    0  509 8257.74537 39419.5493   377%     -  528s
     0     0 37815.3231    0  441 8257.74537 37815.3231   358%     -  635s
H    0     0                    8327.8311735 37815.2937   354%     -  636s
     0     0 37381.9938    0  430 8327.83117 37381.9938   349%     -  678s
     0     0 37227.1229    0  494 8327.83117 37227.1229   347%     -  700s
     0     0 37183.7125    0  514 8327.83117 37183.7125   346%     -  712s
     0     0 37169.2714    0  509 8327.83117 37169.2714   346%     -  720s
     0     0 37139.9495    0  506 8327.83117 37139.9495   346%     -  727s
     0     0 37131.0764    0  468 8327.83117 37131.0764   346%     -  733s
     0     0 37129.5614    0  466 8327.83117 37129.5614   346%     -  736s
     0     0 36368.2908    0  497 8327.83117 36368.2908   337%     -  798s
H    0     0                    8335.5374841 36367.9610   336%     -  799s
H    0     0                    8338.2179100 36367.9610   336%     -  799s
H    0     0                    8554.3870774 36367.9610   325%     -  799s
H    0     0                    8619.0665598 36367.9610   322%     -  799s
     0     0 36206.6184    0  508 8619.06656 36206.6184   320%     -  830s
     0     0 36155.2964    0  499 8619.06656 36155.2964   319%     -  849s
     0     0 36128.0414    0  469 8619.06656 36128.0414   319%     -  860s
     0     0 36108.7883    0  468 8619.06656 36108.7883   319%     -  869s
     0     0 36098.8194    0  478 8619.06656 36098.8194   319%     -  879s
     0     0 36092.9566    0  481 8619.06656 36092.9566   319%     -  887s
     0     0 36091.0666    0  472 8619.06656 36091.0666   319%     -  889s
     0     0 35977.4858    0  477 8619.06656 35977.4858   317%     -  914s
H    0     0                    9645.9672927 35977.1322   273%     -  916s
H    0     0                    9890.6848902 35977.1322   264%     -  916s
     0     0 35962.7703    0  486 9890.68489 35962.7703   264%     -  925s
     0     0 35954.0081    0  484 9890.68489 35954.0081   264%     -  934s
     0     0 35949.8804    0  489 9890.68489 35949.8804   263%     -  939s
     0     0 35948.2061    0  487 9890.68489 35948.2061   263%     -  945s
     0     0 35875.9037    0  520 9890.68489 35875.9037   263%     -  971s
H    0     0                    10422.178382 35875.0107   244%     -  972s
H    0     0                    10436.811068 35875.0107   244%     -  972s
     0     0 35851.5809    0  496 10436.8111 35851.5809   244%     -  986s
     0     0 35842.5733    0  503 10436.8111 35842.5733   243%     -  992s
     0     0 35835.6263    0  509 10436.8111 35835.6263   243%     -  997s
     0     0 35830.7787    0  509 10436.8111 35830.7787   243%     - 1002s
     0     0 35829.3350    0  507 10436.8111 35829.3350   243%     - 1006s
     0     0 35786.0832    0  498 10436.8111 35786.0832   243%     - 1021s
     0     0 35776.0306    0  500 10436.8111 35776.0306   243%     - 1032s
     0     0 35765.9273    0  494 10436.8111 35765.9273   243%     - 1038s
     0     0 35762.7383    0  521 10436.8111 35762.7383   243%     - 1044s
     0     0 35761.4088    0  530 10436.8111 35761.4088   243%     - 1048s
     0     0 35746.0405    0  500 10436.8111 35746.0405   242%     - 1059s
H    0     0                    10448.736178 35746.0390   242%     - 1060s
H    0     0                    10453.242435 35746.0390   242%     - 1060s
     0     0 35742.2365    0  502 10453.2424 35742.2365   242%     - 1064s
     0     0 35740.9294    0  503 10453.2424 35740.9294   242%     - 1067s
     0     0 35733.3106    0  489 10453.2424 35733.3106   242%     - 1078s
H    0     0                    11320.298582 35733.3103   216%     - 1079s
H    0     0                    11682.971706 35733.3103   206%     - 1079s
     0     0 35732.2432    0  491 11682.9717 35732.2432   206%     - 1084s
     0     0 35730.6310    0  534 11682.9717 35730.6310   206%     - 1092s
H    0     0                    11686.893399 35730.6141   206%     - 1092s
     0     0 35729.3171    0  542 11686.8934 35729.3171   206%     - 1094s
     0     0 35724.0063    0  490 11686.8934 35724.0063   206%     - 1104s
     0     0 35723.9449    0  490 11686.8934 35723.9449   206%     - 1112s
H    0     0                    12153.941793 35723.9365   194%     - 1213s
H    0     0                    12163.122457 35723.9365   194%     - 1213s
H    0     0                    12179.957032 35723.9365   193%     - 1213s
H    0     0                    12190.717952 35723.9365   193%     - 1331s
H    0     0                    12241.079063 35723.9365   192%     - 1331s
H    0     0                    12592.333512 35723.9365   184%     - 1364s
H    0     0                    12616.496569 35723.9365   183%     - 1367s
H    0     2                    12966.611682 35723.9365   176%     - 1369s
     0     2 35723.9365    0  490 12966.6117 35723.9365   176%     - 1369s
     1     3 35582.4678    1  467 12966.6117 35723.8764   176% 11899 1393s
     2     4 35493.3711    1  522 12966.6117 35582.3038   174% 13227 1418s
     3     5 35214.1127    2  481 12966.6117 35582.3038   174% 13609 1439s
     4     7 34835.3522    2  473 12966.6117 35493.1771   174% 13079 1466s
     6    13 34446.9601    3  470 12966.6117 35493.1771   174% 12124 1500s
    12    25 34337.1541    4  517 12966.6117 35139.7796   171% 13545 1558s
    24    37 32524.5327    5  463 12966.6117 35036.3448   170% 24587 1699s
H   36    67                    13464.741618 34869.8181   159% 24187 1944s
H   50    67                    14106.861101 34869.8181   147% 21977 1944s
    66   129 34111.6248    6  496 14106.8611 34869.8181   147% 29620 2071s
H  128   233                    14815.617006 34869.8181   135% 23187 2151s
H  161   233                    15380.993188 34869.8181   127% 20385 2151s
   232   311 33843.7018   12  447 15380.9932 34869.8181   127% 16768 2229s
   310   340 33682.6641   15  445 15380.9932 34869.8181   127% 14350 2269s
H  319   340                    15488.106074 34869.8181   125% 14131 2269s
H  339   390                    18419.316959 34869.8181  89.3% 13838 2322s
H  340   390                    18645.175658 34869.8181  87.0% 13819 2322s
H  342   390                    18919.187605 34869.8181  84.3% 13781 2322s
   389   435 32069.8604   18  394 18919.1876 34869.8181  84.3% 12881 2392s
   434   480 33334.9659   16  422 18919.1876 34869.8181  84.3% 12486 2448s
H  435   480                    19146.486010 34869.8181  82.1% 12457 2448s
H  449   480                    19150.207639 34869.8181  82.1% 12320 2448s
   481   537 33094.0685   17  426 19150.2076 34869.8181  82.1% 12194 2499s
   542   605 32865.8507   18  412 19150.2076 34869.8181  82.1% 11909 2541s
H  557   605                    19150.439359 34869.8181  82.1% 11836 2541s
H  559   605                    19198.425919 34869.8181  81.6% 11819 2541s
   624   629 32512.2109   19  372 19198.4259 34869.8181  81.6% 11568 2575s
H  653   629                    19278.451345 34869.8181  80.9% 11624 2575s
   660   663 29291.7314   20  231 19278.4513 34869.8181  80.9% 11631 2610s
H  661   663                    19301.234956 34869.8181  80.7% 11614 2610s
   738   685 28405.2711   21  229 19301.2350 34869.8181  80.7% 11175 2647s
   802   732 28166.0975   22  229 19301.2350 34869.8181  80.7% 10862 2678s
H  818   732                    19381.739535 34869.8181  79.9% 10811 2678s
   889   806 27023.2242   25  153 19381.7395 34869.8181  79.9% 10396 2706s
  1005   810 26498.4787   28  268 19381.7395 34869.8181  79.9%  9707 2740s
  1121   811 21913.0589   34   96 19381.7395 34176.9256  76.3%  9204 2778s
H 1202   817                    19398.356075 34176.9256  76.2%  8904 2816s
H 1224   817                    19463.421447 34176.9256  75.6%  8843 2816s
H 1229   817                    19551.106556 34176.9256  74.8%  8873 2816s
  1242   831     cutoff   41      19551.1066 34176.9256  74.8%  8856 2858s
  1302   863 32763.5753   11  467 19551.1066 34176.9256  74.8%  8830 2901s
  1379   906 32420.0927   12  397 19551.1066 34176.9256  74.8%  8665 2944s
  1477   905 32385.1085   13  395 19551.1066 34176.9256  74.8%  8297 2991s
  1547   924 25698.4482   13  368 19551.1066 34176.9256  74.8%  8150 3041s
  1578   949 25533.2790   14  371 19551.1066 34176.9256  74.8%  8300 3092s
H 1611  1003                    19883.485593 34176.9256  71.9%  8594 3142s
H 1676  1032                    19904.554572 34176.9256  71.7%  8886 3189s
H 1736  1032                    19927.472062 34176.9256  71.5%  9081 3189s
  1755  1057 24372.2204   17  355 19927.4721 34176.9256  71.5%  9081 3235s
H 1766  1057                    20487.061397 34176.9256  66.8%  9135 3235s
H 1767  1057                    21526.330781 34176.9256  58.8%  9136 3235s
H 1788  1057                    21553.855896 34176.9256  58.6%  9257 3235s
  1790  1055 23446.3593   18  309 21553.8559 34176.9256  58.6%  9285 3281s
H 1795  1055                    21740.485033 34176.9256  57.2%  9313 3281s
H 1801  1055                    21767.478764 34176.9256  57.0%  9313 3281s
  1846  1075 22961.9144   19  284 21767.4788 34176.9256  57.0%  9298 3333s
H 1854  1075                    21983.614989 34176.9256  55.5%  9312 3333s
  1884  1128 22708.3597   20  281 21983.6150 34176.9256  55.5%  9419 3382s
  1997  1162 infeasible   21      21983.6150 34176.9256  55.5%  9450 3435s
  2091  1223 25994.9936   40  320 21983.6150 34176.9256  55.5%  9446 3500s
  2206  1332 infeasible   22      21983.6150 34176.9256  55.5%  9455 3567s
H 2207  1332                    22004.683968 34176.9256  55.3%  9450 3567s
H 2224  1332                    22009.724816 34176.9256  55.3%  9409 3567s
  2365  1366     cutoff   19      22009.7248 34176.9256  55.3%  9265 3600s

Cutting planes:
  Learned: 1
  Gomory: 4
  Implied bound: 183
  MIR: 4211
  Flow cover: 4235
  RLT: 131
  Relax-and-lift: 857

Explored 2495 nodes (23248844 simplex iterations) in 3600.08 seconds (8546.65 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 22009.7 22004.7 21983.6 ... 19904.6

Time limit reached
Best objective 2.200972481563e+04, best bound 3.417692556305e+04, gap 55.2810%
  WARNING: Time limit reached. Using best solution found (gap: 55.28%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.11s
  Master Objective (UB) = 22009.72, θ = 165585.77
  Upper Bound (UB) = 22009.72

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 165585.77
  [DEBUG]   ✓ Scenario 0: θ = 165585.77 ≤ Q = 165585.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 165585.77 ≤ Q = 165585.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 165585.77 ≤ Q = 165585.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 165585.77 ≤ Q = 165585.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 165585.77 ≤ Q = 165585.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 165585.77 ≤ Q = 165585.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 165585.77 ≤ Q = 165585.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 165585.77 ≤ Q = 165585.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 165585.77 ≤ Q = 165585.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 165585.77 ≤ Q = 165585.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 165585.77 ≤ Q = 165585.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 165585.77 ≤ Q = 165585.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 165585.77 ≤ Q = 165585.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 165585.77 ≤ Q = 165585.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 165585.77 ≤ Q = 165585.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 165585.77 ≤ Q = 165585.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 165585.77 ≤ Q = 165585.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 165585.77 ≤ Q = 165585.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 165585.77 ≤ Q = 165585.77 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 19] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x8b5bca
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x008b5bca
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [3e-01, 2e+02]
Found heuristic solution: objective 1.342222e+13
Presolve removed 2587 rows and 1877 columns
Presolve time: 0.00s
Presolved: 506 rows, 512 columns, 1429 nonzeros
Found heuristic solution: objective 6505780.4915
Variable types: 346 continuous, 166 integer (166 binary)
Found heuristic solution: objective 6505471.9024

Root relaxation: objective -1.567304e+05, 243 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -156730.41    0  122 6505471.90 -156730.41   102%     -    0s
H    0     0                    -109463.6685 -156730.41  43.2%     -    0s
H    0     0                    -116460.2076 -156730.41  34.6%     -    0s
H    0     0                    -118298.3770 -131039.33  10.8%     -    0s
     0     0 -131039.33    0   77 -118298.38 -131039.33  10.8%     -    0s
H    0     0                    -127545.5787 -130928.09  2.65%     -    0s
H    0     0                    -127854.1679 -130928.09  2.40%     -    0s
H    0     0                    -129280.2536 -130928.09  1.27%     -    0s
H    0     0                    -129588.8428 -130928.09  1.03%     -    0s
     0     0 -130045.62    0   48 -129588.84 -130045.62  0.35%     -    0s
     0     0 -129899.81    0   19 -129588.84 -129899.81  0.24%     -    0s
     0     0 -129891.72    0   30 -129588.84 -129891.72  0.23%     -    0s
     0     0 -129867.49    0   30 -129588.84 -129867.49  0.22%     -    0s
     0     0 -129854.77    0   30 -129588.84 -129854.77  0.21%     -    0s
H    0     0                    -129641.5986 -129851.81  0.16%     -    0s
     0     0 -129851.81    0   62 -129641.60 -129851.81  0.16%     -    0s
     0     0 -129851.81    0   37 -129641.60 -129851.81  0.16%     -    0s
     0     0 -129818.04    0   30 -129641.60 -129818.04  0.14%     -    0s
     0     0 -129810.02    0   28 -129641.60 -129810.02  0.13%     -    0s
     0     0 -129807.24    0   24 -129641.60 -129807.24  0.13%     -    0s
     0     0 -129807.10    0   23 -129641.60 -129807.10  0.13%     -    0s
     0     0 -129803.49    0   13 -129641.60 -129803.49  0.12%     -    0s
     0     0 -129741.27    0    7 -129641.60 -129741.27  0.08%     -    0s
H    0     0                    -129661.0654 -129723.83  0.05%     -    0s
     0     0 -129723.83    0    7 -129661.07 -129723.83  0.05%     -    0s
     0     0 -129719.74    0    9 -129661.07 -129719.74  0.05%     -    0s
     0     0 -129719.74    0   16 -129661.07 -129719.74  0.05%     -    0s
H    0     0                    -129661.6418 -129719.74  0.04%     -    0s
     0     0 -129678.90    0    4 -129661.64 -129678.90  0.01%     -    0s
     0     0 -129678.03    0    2 -129661.64 -129678.03  0.01%     -    0s
     0     0 -129678.03    0    5 -129661.64 -129678.03  0.01%     -    0s
H    0     0                    -129675.2613 -129678.03  0.00%     -    0s

Explored 1 nodes (983 simplex iterations) in 0.13 seconds (0.06 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -129675 -129662 -129661 ... 6.50547e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.296752613495e+05, best bound -1.296780262684e+05, gap 0.0021%
  Subproblem solved in 0.15s
  Worst-case operational profit (Z_SP) = 160159.05
  Scenario: 23 demand increases, 37 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -129675.26
  [DEBUG]   S×d_nominal = 289834.31
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 289834.31 + -129675.26 = 160159.05
  [DEBUG]   Current θ from Master = 165585.77
  [DEBUG]   ⚠️  Z_SP ≤ θ by 5426.71 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 16583.01
  Lower Bound (LB) = 19044.82
  Gap (UB-LB) = 2964.9060, Absolute Gap = 2964.9060, Relative Gap = 0.134709
  Not converged yet (gap = 2964.91 > ε = 200)

  [DEBUG] Adding NEW scenario 19 to Master Problem...
  [DEBUG] New scenario pattern: 23 increases, 37 decreases
    [DEBUG] Scenario 19 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 19 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 19]
    [DEBUG]   - Total constraints in model: 307183
    [DEBUG]   - Total variables in model: 127060
  [DEBUG] Total scenarios in Master: 20
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 20
================================================================================
[Iteration 20] Solving Master Problem...
  Current scenarios in Master: 20
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 307183 rows, 127060 columns and 870379 nonzeros
Model fingerprint: 0x039095d5
Variable types: 124801 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 133560 rows and 54240 columns
Presolve time: 3.28s
Presolved: 173623 rows, 72820 columns, 1069345 nonzeros
Variable types: 70561 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -326728.6770
Found heuristic solution: objective -184683.4741

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.65s

Barrier statistics:
 Dense cols : 677
 AA' NZ     : 9.774e+06
 Factor NZ  : 2.172e+07 (roughly 300 MB of memory)
 Factor Ops : 5.742e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.49807242e+07  2.86443303e+08  1.49e+05 1.59e+01  1.00e+05     7s
   1  -1.93416178e+07  2.67401144e+08  1.07e+05 6.37e+01  7.14e+04     7s
   2  -8.12228261e+06  2.06974209e+08  4.41e+04 2.60e+00  3.16e+04     7s
   3  -6.32590104e+06  2.06636459e+08  3.40e+04 2.56e+00  2.45e+04     7s
   4  -9.54162684e+05  1.59199749e+08  1.85e+03 1.14e+00  1.82e+03     7s
   5  -6.28213726e+05  1.26836863e+08  5.06e+02 7.88e-01  7.47e+02     7s
   6  -5.60585828e+05  6.25676099e+07  3.41e+02 3.05e-01  4.01e+02     7s
   7  -4.25680710e+05  4.50760576e+07  9.32e+01 2.03e-01  1.95e+02     7s
   8  -3.73049796e+05  3.22521611e+07  2.55e+01 1.40e-01  1.16e+02     7s
   9  -3.16511780e+05  2.66280538e+07  4.13e+00 1.14e-01  8.70e+01     7s
  10  -2.22309175e+05  1.33400816e+07  4.09e-01 5.53e-02  4.30e+01     7s
  11  -1.38227268e+05  4.12107018e+06  9.73e-02 1.67e-02  1.35e+01     8s
  12  -8.02766138e+04  2.51173128e+06  3.81e-02 9.94e-03  8.20e+00     8s
  13  -5.55069227e+04  1.54792754e+06  2.11e-02 6.05e-03  5.07e+00     8s
  14  -2.71015545e+04  6.74154437e+05  8.19e-03 2.46e-03  2.22e+00     8s
  15  -4.62120746e+03  3.29060453e+05  4.57e-03 1.08e-03  1.06e+00     8s
  16   3.82131735e+03  1.82953410e+05  3.67e-03 7.51e-04  5.66e-01     8s
  17   1.34120862e+04  1.43089117e+05  2.72e-03 5.18e-04  4.10e-01     8s
  18   2.06855921e+04  1.15031178e+05  2.17e-03 3.50e-04  2.98e-01     8s
  19   2.77810539e+04  8.98963282e+04  1.63e-03 2.12e-04  1.96e-01     8s
  20   3.29425935e+04  8.09965383e+04  1.24e-03 1.64e-04  1.52e-01     8s
  21   3.78737750e+04  7.07121460e+04  8.58e-04 1.09e-04  1.04e-01     9s
  22   4.02417786e+04  6.68917057e+04  6.92e-04 8.76e-05  8.43e-02     9s
  23   4.22852393e+04  6.36771411e+04  5.56e-04 6.98e-05  6.76e-02     9s
  24   4.41457724e+04  5.88317564e+04  4.34e-04 4.19e-05  4.64e-02     9s
  25   4.53720369e+04  5.66191378e+04  3.58e-04 2.90e-05  3.56e-02     9s
  26   4.71688042e+04  5.55127719e+04  2.50e-04 2.24e-05  2.64e-02     9s
  27   4.81097965e+04  5.46261514e+04  1.94e-04 1.72e-05  2.06e-02     9s
  28   4.88401292e+04  5.37488655e+04  1.53e-04 1.23e-05  1.55e-02     9s
  29   4.94394284e+04  5.33364757e+04  1.19e-04 9.89e-06  1.23e-02     9s
  30   4.97585332e+04  5.29470147e+04  1.01e-04 7.56e-06  1.01e-02    10s
  31   4.99062479e+04  5.26167123e+04  9.20e-05 5.69e-06  8.57e-03    10s
  32   5.03183828e+04  5.23804002e+04  6.94e-05 4.33e-06  6.52e-03    10s
  33   5.06580998e+04  5.23046858e+04  5.00e-05 3.91e-06  5.21e-03    10s
  34   5.08355380e+04  5.21406261e+04  4.00e-05 2.99e-06  4.13e-03    10s
  35   5.08655818e+04  5.20638263e+04  3.84e-05 2.56e-06  3.79e-03    10s
  36   5.10418011e+04  5.18815985e+04  2.90e-05 2.39e-06  2.66e-03    10s
  37   5.11939895e+04  5.17706887e+04  2.07e-05 2.71e-06  1.82e-03    10s
  38   5.12673913e+04  5.16892954e+04  1.67e-05 1.67e-06  1.33e-03    10s
  39   5.14439789e+04  5.16496718e+04  7.49e-06 8.36e-07  6.50e-04    11s
  40   5.14511671e+04  5.16379324e+04  7.08e-06 6.83e-07  5.91e-04    11s
  41   5.15209624e+04  5.16296018e+04  3.48e-06 5.48e-07  3.44e-04    11s
  42   5.15635062e+04  5.16140512e+04  1.29e-06 3.33e-07  1.60e-04    11s
  43   5.15713332e+04  5.15993350e+04  9.21e-07 1.84e-07  8.85e-05    11s
  44   5.15819051e+04  5.15964715e+04  4.00e-07 1.16e-07  4.61e-05    11s
  45   5.15891537e+04  5.15936671e+04  6.58e-08 5.89e-08  1.43e-05    11s
  46   5.15902033e+04  5.15924978e+04  4.84e-08 3.39e-08  7.26e-06    11s
  47   5.15905069e+04  5.15912415e+04  7.27e-08 4.00e-07  2.33e-06    11s
  48   5.15908359e+04  5.15908635e+04  6.66e-09 2.81e-09  8.74e-08    11s
  49   5.15908547e+04  5.15908623e+04  2.67e-07 7.15e-10  2.40e-08    12s
  50   5.15908609e+04  5.15908622e+04  7.95e-07 3.38e-10  4.11e-09    12s
  51   5.15908621e+04  5.15908622e+04  9.79e-08 1.00e-07  5.07e-10    12s

Barrier solved model in 51 iterations and 11.68 seconds (21.47 work units)
Optimal objective 5.15908621e+04


Root crossover log...

  141925 DPushes remaining with DInf 1.8541546e-09                12s
   33192 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                20s

   12544 PPushes remaining with PInf 5.6729917e-05                20s
    6614 PPushes remaining with PInf 2.8964704e-05                20s
       0 PPushes remaining with PInf 0.0000000e+00                21s

  Push phase complete: Pinf 0.0000000e+00, Dinf 4.5224879e+01     21s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   78875    5.1590862e+04   0.000000e+00   4.522488e+01     21s
   78956    5.1590862e+04   0.000000e+00   0.000000e+00     21s
   78956    5.1590862e+04   0.000000e+00   0.000000e+00     21s
Concurrent spin time: 5.27s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 5.159086e+04, 78956 iterations, 22.53 seconds (43.78 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 51590.8622    0  388 -184683.47 51590.8622   128%     -   27s
H    0     0                    -179796.1187 51590.8622   129%     -   27s
H    0     0                    -171830.0064 51590.8622   130%     -   28s
H    0     0                    -158313.6886 51590.8622   133%     -   29s
H    0     0                    -158103.3926 51590.8622   133%     -   30s
H    0     0                    -156684.6193 51590.8622   133%     -   30s
H    0     0                    -156297.5913 51590.8622   133%     -   30s
H    0     0                    -156297.2526 51590.8622   133%     -   30s
H    0     0                    -66952.25315 51590.8622   177%     -   30s
H    0     0                    -66410.86309 51590.8622   178%     -   30s
H    0     0                    -65518.42325 51590.8622   179%     -   31s
H    0     0                    -65299.61612 51590.8622   179%     -   31s
H    0     0                    -40165.34910 51590.8622   228%     -   31s
H    0     0                    -26218.02430 51590.8622   297%     -   31s
H    0     0                    -22174.29959 51590.8622   333%     -   32s
H    0     0                    -22146.63823 51590.8622   333%     -   32s
H    0     0                    -20260.60047 51590.8622   355%     -   32s
H    0     0                    -20210.98366 51590.8622   355%     -   32s
     0     0 44461.2178    0  350 -20210.984 44461.2178   320%     -   93s
H    0     0                    -12446.56491 44461.1559   457%     -   94s
H    0     0                    -4536.754862 44461.1559  1080%     -   94s
H    0     0                    -4401.049202 44461.1559  1110%     -   95s
     0     0 43721.8092    0  340 -4401.0492 43721.8092  1093%     -  127s
     0     0 43653.5670    0  359 -4401.0492 43653.5670  1092%     -  143s
     0     0 43599.0808    0  358 -4401.0492 43599.0808  1091%     -  150s
     0     0 43579.6684    0  355 -4401.0492 43579.6684  1090%     -  158s
     0     0 43564.9454    0  362 -4401.0492 43564.9454  1090%     -  165s
     0     0 43554.6821    0  368 -4401.0492 43554.6821  1090%     -  173s
     0     0 43542.2465    0  372 -4401.0492 43542.2465  1089%     -  176s
     0     0 43528.5009    0  371 -4401.0492 43528.5009  1089%     -  180s
     0     0 43526.0072    0  371 -4401.0492 43526.0072  1089%     -  182s
     0     0 43458.4836    0  382 -4401.0492 43458.4836  1087%     -  195s
     0     0 43315.6826    0  360 -4401.0492 43315.6826  1084%     -  214s
     0     0 43309.4395    0  374 -4401.0492 43309.4395  1084%     -  217s
     0     0 43304.8251    0  374 -4401.0492 43304.8251  1084%     -  218s
     0     0 43304.8251    0  374 -4401.0492 43304.8251  1084%     -  219s
     0     0 40806.8825    0  429 -4401.0492 40806.8825  1027%     -  317s
H    0     0                    6887.3856531 40806.5944   492%     -  318s
H    0     0                    6890.9867955 40806.5944   492%     -  318s
H    0     0                    6954.3929569 40806.5944   487%     -  318s
H    0     0                    6959.6569556 40806.5944   486%     -  318s
H    0     0                    6962.3741899 40806.5944   486%     -  318s
     0     0 40155.1156    0  425 6962.37419 40155.1156   477%     -  372s
     0     0 40029.8436    0  463 6962.37419 40029.8436   475%     -  402s
     0     0 39953.6120    0  466 6962.37419 39953.6120   474%     -  424s
     0     0 39873.9197    0  460 6962.37419 39873.9197   473%     -  447s
     0     0 39789.5702    0  473 6962.37419 39789.5702   471%     -  475s
     0     0 39763.9674    0  461 6962.37419 39763.9674   471%     -  489s
     0     0 39714.8947    0  451 6962.37419 39714.8947   470%     -  504s
     0     0 39698.0673    0  464 6962.37419 39698.0673   470%     -  513s
     0     0 39676.6915    0  464 6962.37419 39676.6915   470%     -  522s
     0     0 39666.1241    0  467 6962.37419 39666.1241   470%     -  528s
     0     0 39662.6094    0  469 6962.37419 39662.6094   470%     -  532s
     0     0 39617.5209    0  450 6962.37419 39617.5209   469%     -  543s
     0     0 39592.1557    0  445 6962.37419 39592.1557   469%     -  565s
     0     0 39584.5669    0  459 6962.37419 39584.5669   469%     -  572s
     0     0 39573.8031    0  459 6962.37419 39573.8031   468%     -  579s
     0     0 39572.6199    0  462 6962.37419 39572.6199   468%     -  581s
     0     0 37926.2579    0  431 6962.37419 37926.2579   445%     -  686s
H    0     0                    7082.9235389 37925.9685   435%     -  688s
H    0     0                    8130.2404511 37925.9685   366%     -  688s
H    0     0                    8134.1621447 37925.9685   366%     -  688s
     0     0 37540.7288    0  455 8134.16214 37540.7288   362%     -  722s
     0     0 37461.0439    0  456 8134.16214 37461.0439   361%     -  744s
     0     0 37405.1037    0  450 8134.16214 37405.1037   360%     -  761s
     0     0 37371.2724    0  461 8134.16214 37371.2724   359%     -  775s
     0     0 37362.1323    0  460 8134.16214 37362.1323   359%     -  783s
     0     0 37348.4304    0  459 8134.16214 37348.4304   359%     -  792s
     0     0 37336.6453    0  453 8134.16214 37336.6453   359%     -  803s
     0     0 37316.7274    0  463 8134.16214 37316.7274   359%     -  811s
     0     0 37291.7282    0  470 8134.16214 37291.7282   358%     -  821s
     0     0 37267.8476    0  462 8134.16214 37267.8476   358%     -  832s
     0     0 37261.3928    0  457 8134.16214 37261.3928   358%     -  838s
     0     0 37260.3513    0  465 8134.16214 37260.3513   358%     -  842s
     0     0 36662.0321    0  545 8134.16214 36662.0321   351%     -  927s
     0     0 36477.5168    0  519 8134.16214 36477.5168   348%     -  956s
     0     0 36422.6395    0  508 8134.16214 36422.6395   348%     -  971s
     0     0 36391.9123    0  502 8134.16214 36391.9123   347%     -  982s
     0     0 36374.9977    0  468 8134.16214 36374.9977   347%     -  989s
     0     0 36360.1532    0  474 8134.16214 36360.1532   347%     -  999s
     0     0 36344.1705    0  509 8134.16214 36344.1705   347%     - 1009s
     0     0 36337.1675    0  458 8134.16214 36337.1675   347%     - 1015s
     0     0 36330.3201    0  510 8134.16214 36330.3201   347%     - 1022s
     0     0 36329.2356    0  525 8134.16214 36329.2356   347%     - 1026s
     0     0 36186.6727    0  515 8134.16214 36186.6727   345%     - 1056s
H    0     0                    9093.2516481 36186.5630   298%     - 1057s
H    0     0                    9133.5433525 36186.5630   296%     - 1057s
H    0     0                    9162.1511144 36186.5630   295%     - 1057s
H    0     0                    9163.3519965 36186.5630   295%     - 1057s
     0     0 36108.5984    0  522 9163.35200 36108.5984   294%     - 1076s
     0     0 36089.2069    0  521 9163.35200 36089.2069   294%     - 1085s
     0     0 36076.1953    0  536 9163.35200 36076.1953   294%     - 1091s
     0     0 36066.5853    0  536 9163.35200 36066.5853   294%     - 1099s
     0     0 36064.1861    0  528 9163.35200 36064.1861   294%     - 1105s
     0     0 36061.3515    0  523 9163.35200 36061.3515   294%     - 1108s
     0     0 36054.1742    0  522 9163.35200 36054.1742   293%     - 1112s
     0     0 36052.0793    0  536 9163.35200 36052.0793   293%     - 1115s
     0     0 36011.1803    0  472 9163.35200 36011.1803   293%     - 1130s
     0     0 35991.5548    0  468 9163.35200 35991.5548   293%     - 1142s
     0     0 35986.7233    0  476 9163.35200 35986.7233   293%     - 1146s
     0     0 35983.5939    0  480 9163.35200 35983.5939   293%     - 1151s
     0     0 35980.6842    0  512 9163.35200 35980.6842   293%     - 1155s
     0     0 35980.1702    0  477 9163.35200 35980.1702   293%     - 1156s
     0     0 35932.0145    0  518 9163.35200 35932.0145   292%     - 1175s
     0     0 35921.9825    0  508 9163.35200 35921.9825   292%     - 1188s
     0     0 35916.9441    0  526 9163.35200 35916.9441   292%     - 1197s
     0     0 35913.6054    0  521 9163.35200 35913.6054   292%     - 1202s
     0     0 35912.5941    0  513 9163.35200 35912.5941   292%     - 1206s
     0     0 35881.3793    0  490 9163.35200 35881.3793   292%     - 1225s
     0     0 35872.6221    0  480 9163.35200 35872.6221   291%     - 1236s
     0     0 35869.4634    0  486 9163.35200 35869.4634   291%     - 1241s
     0     0 35864.1747    0  525 9163.35200 35864.1747   291%     - 1249s
     0     0 35862.6093    0  499 9163.35200 35862.6093   291%     - 1253s
     0     0 35856.1254    0  484 9163.35200 35856.1254   291%     - 1263s
     0     0 35854.7159    0  488 9163.35200 35854.7159   291%     - 1267s
     0     0 35837.6070    0  476 9163.35200 35837.6070   291%     - 1280s
H    0     0                    10178.579149 35837.5093   252%     - 1281s
H    0     0                    10185.112519 35837.5093   252%     - 1281s
H    0     0                    10220.749892 35837.5093   251%     - 1281s
H    0     0                    10240.907577 35837.5093   250%     - 1281s
     0     0 35835.5493    0  487 10240.9076 35835.5493   250%     - 1286s
     0     0 35827.7822    0  570 10240.9076 35827.7822   250%     - 1298s
     0     0 35824.5829    0  528 10240.9076 35824.5829   250%     - 1304s
     0     0 35823.0249    0  522 10240.9076 35823.0249   250%     - 1306s
     0     0 35803.2906    0  523 10240.9076 35803.2906   250%     - 1320s
     0     0 35786.3904    0  484 10240.9076 35786.3904   249%     - 1332s
     0     0 35783.3883    0  512 10240.9076 35783.3883   249%     - 1337s
     0     0 35782.4410    0  515 10240.9076 35782.4410   249%     - 1339s
     0     0 35778.0849    0  496 10240.9076 35778.0849   249%     - 1346s
     0     0 35775.9350    0  531 10240.9076 35775.9350   249%     - 1351s
     0     0 35771.7093    0  531 10240.9076 35771.7093   249%     - 1360s
H    0     0                    10261.221082 35771.6944   249%     - 1361s
     0     0 35769.5456    0  542 10261.2211 35769.5456   249%     - 1366s
     0     0 35768.1416    0  497 10261.2211 35768.1416   249%     - 1371s
     0     0 35765.7912    0  541 10261.2211 35765.7912   249%     - 1376s
     0     0 35754.9906    0  497 10261.2211 35754.9906   248%     - 1385s
     0     0 35754.7626    0  497 10261.2211 35754.7626   248%     - 1395s
H    0     0                    11302.378597 35754.7626   216%     - 1494s
H    0     0                    11655.377939 35754.7626   207%     - 1494s
H    0     0                    11743.264542 35754.7626   204%     - 1494s
H    0     0                    11743.585093 35754.7626   204%     - 1494s
H    0     0                    13057.524396 35754.7626   174%     - 1656s
H    0     0                    16444.842972 35754.7626   117%     - 1656s
H    0     0                    16719.456844 35754.7626   114%     - 1658s
H    0     0                    17020.689038 35754.7626   110%     - 1660s
     0     2 35754.7626    0  497 17020.6890 35754.7626   110%     - 1664s
     1     3 35297.5306    1  432 17020.6890 35754.6246   110% 17295 1696s
     2     4 35485.4680    1  468 17020.6890 35485.4680   108% 14770 1717s
     3     5 34630.9719    2  470 17020.6890 35485.4624   108% 16816 1757s
     4     8 35205.8725    2  481 17020.6890 35485.1584   108% 15395 1783s
     7    14 34834.6823    3  487 17020.6890 35485.1584   108% 15319 1848s
    13    25 34755.1246    4  489 17020.6890 35205.2601   107% 16284 1930s
    24    36 32018.3849    5  503 17020.6890 34833.4945   105% 22826 2085s
    35    65 33644.3021    5  472 17020.6890 34755.0504   104% 19572 2476s
H   40    65                    17297.495106 34755.0504   101% 19232 2476s
    64    96 33389.1560    6  483 17297.4951 34755.0504   101% 26074 2738s
    95   240 33312.9417    7  480 17297.4951 34755.0504   101% 23999 2844s
H  109   240                    18234.791056 34755.0504  90.6% 21801 2844s
H  113   240                    19914.047627 34755.0504  74.5% 21493 2844s
   239   300 32917.9497   12  456 19914.0476 34755.0504  74.5% 13318 2895s
   299   350 32710.7885   14  457 19914.0476 34755.0504  74.5% 12726 2938s
H  302   350                    20521.141660 34755.0504  69.4% 12636 2938s
H  311   350                    20889.550776 34755.0504  66.4% 12618 2938s
H  315   350                    21002.482968 34755.0504  65.5% 12507 2938s
   349   410 32467.6881   17  453 21002.4830 34755.0504  65.5% 12305 2983s
   409   467 32054.0556   18  350 21002.4830 34755.0504  65.5% 11754 3023s
H  410   467                    21114.989024 34755.0504  64.6% 11725 3023s
H  411   467                    21118.910717 34755.0504  64.6% 11707 3023s
H  423   467                    21368.106677 34755.0504  62.6% 11624 3023s
H  428   467                    21915.630568 34755.0504  58.6% 11513 3023s
   466   529 30386.4371   19  280 21915.6306 34755.0504  58.6% 11257 3061s
   534   590 26840.3295   20  204 21915.6306 34755.0504  58.6% 10695 3096s
H  552   590                    22145.701462 34755.0504  56.9% 10539 3096s
H  580   590                    22150.508212 34755.0504  56.9% 10381 3096s
H  593   590                    22183.165825 34755.0504  56.7% 10301 3096s
   601   656 26764.0417   21  188 22183.1658 34755.0504  56.7% 10312 3128s
   675   725 25983.2141   25  148 22183.1658 34755.0504  56.7% 10162 3158s
H  723   725                    22244.163025 34755.0504  56.2%  9814 3158s
   752   788 25471.9445   30  128 22244.1630 34755.0504  56.2%  9711 3189s
H  831   852                    22247.764167 34755.0504  56.2%  9362 3213s
H  833   852                    22259.883687 34755.0504  56.1%  9370 3213s
   913   923     cutoff   36      22259.8837 34755.0504  56.1%  9010 3240s
  1024   999 infeasible   36      22259.8837 34755.0504  56.1%  8521 3268s
  1141  1091 23479.3572   40   85 22259.8837 34755.0504  56.1%  8118 3297s
  1284  1158 22615.7424   48   56 22259.8837 34755.0504  56.1%  7623 3322s
  1403  1186 22595.0683   49   45 22259.8837 34755.0504  56.1%  7241 3354s
  1520  1191 22409.1945   50   46 22259.8837 34755.0504  56.1%  7012 3390s
  1619  1224 infeasible   51      22259.8837 34755.0504  56.1%  6891 3426s
  1715  1234 25677.2444   40  246 22259.8837 34755.0504  56.1%  6808 3464s
  1817  1236 25640.4704   41  245 22259.8837 34755.0504  56.1%  6768 3503s
  1881  1234 infeasible   41      22259.8837 34755.0504  56.1%  6822 3545s
  1919  1244 24402.5268   17  333 22259.8837 34755.0504  56.1%  6885 3593s
  1939  1244 infeasible   41      22259.8837 34755.0504  56.1%  7034 3600s

Cutting planes:
  Learned: 3
  Gomory: 1
  Implied bound: 129
  MIR: 4571
  Flow cover: 4046
  RLT: 136
  Relax-and-lift: 770
  BQP: 1

Explored 1941 nodes (14518377 simplex iterations) in 3600.09 seconds (8182.83 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 22259.9 22247.8 22244.2 ... 21115

Time limit reached
Best objective 2.225988368657e+04, best bound 3.475505044217e+04, gap 56.1331%
  WARNING: Time limit reached. Using best solution found (gap: 56.13%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.11s
  Master Objective (UB) = 22259.88, θ = 166942.28
  Upper Bound (UB) = 22259.88

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 166942.28
  [DEBUG]   ✓ Scenario 0: θ = 166942.28 ≤ Q = 166942.28 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 166942.28 ≤ Q = 166942.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 166942.28 ≤ Q = 166942.28 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 166942.28 ≤ Q = 166942.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 166942.28 ≤ Q = 166942.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 166942.28 ≤ Q = 166942.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 166942.28 ≤ Q = 166942.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 166942.28 ≤ Q = 166942.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 166942.28 ≤ Q = 166942.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 166942.28 ≤ Q = 166942.28 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 166942.28 ≤ Q = 166942.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 166942.28 ≤ Q = 166942.28 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 166942.28 ≤ Q = 166942.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 166942.28 ≤ Q = 166942.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 166942.28 ≤ Q = 166942.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 166942.28 ≤ Q = 166942.28 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 166942.28 ≤ Q = 166942.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 166942.28 ≤ Q = 166942.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 166942.28 ≤ Q = 166942.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 166942.28 ≤ Q = 166942.28 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 20] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x2c38490d
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x2c38490d
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [9e-16, 2e+02]
Found heuristic solution: objective 1.366142e+13
Presolve removed 2575 rows and 1867 columns
Presolve time: 0.00s
Presolved: 518 rows, 522 columns, 1461 nonzeros
Found heuristic solution: objective 6900572.7487
Variable types: 354 continuous, 168 integer (168 binary)

Root relaxation: objective -1.536491e+05, 251 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -153649.12    0  123 6900572.75 -153649.12   102%     -    0s
H    0     0                    -118877.0888 -153649.12  29.3%     -    0s
H    0     0                    -119644.4588 -153649.12  28.4%     -    0s
     0     0 -130588.12    0   79 -119644.46 -130588.12  9.15%     -    0s
H    0     0                    -128533.9507 -130476.77  1.51%     -    0s
     0     0 -130077.51    0   97 -128533.95 -130077.51  1.20%     -    0s
H    0     0                    -129090.1697 -130026.14  0.73%     -    0s
     0     0 -130026.14    0   95 -129090.17 -130026.14  0.73%     -    0s
     0     0 -129503.42    0   39 -129090.17 -129503.42  0.32%     -    0s
     0     0 -129502.54    0   38 -129090.17 -129502.54  0.32%     -    0s
     0     0 -129502.15    0   37 -129090.17 -129502.15  0.32%     -    0s
     0     0 -129501.47    0   36 -129090.17 -129501.47  0.32%     -    0s
     0     0 -129501.45    0   35 -129090.17 -129501.45  0.32%     -    0s
H    0     0                    -129134.1710 -129471.91  0.26%     -    0s
     0     0 -129424.85    0   24 -129134.17 -129424.85  0.23%     -    0s
     0     0 -129384.55    0   24 -129134.17 -129384.55  0.19%     -    0s
     0     0 -129383.93    0   24 -129134.17 -129383.93  0.19%     -    0s
     0     0 -129288.09    0   19 -129134.17 -129288.09  0.12%     -    0s
H    0     0                    -129145.2668 -129262.69  0.09%     -    0s
     0     0 -129262.69    0   19 -129145.27 -129262.69  0.09%     -    0s
     0     0 -129262.69    0   13 -129145.27 -129262.69  0.09%     -    0s
     0     0 -129241.84    0   10 -129145.27 -129241.84  0.07%     -    0s
     0     0 -129241.84    0   20 -129145.27 -129241.84  0.07%     -    0s
     0     0 -129241.84    0   19 -129145.27 -129241.84  0.07%     -    0s
     0     0 -129185.41    0    5 -129145.27 -129185.41  0.03%     -    0s
     0     0 -129185.40    0    3 -129145.27 -129185.40  0.03%     -    0s
H    0     0                    -129184.6717 -129184.86  0.00%     -    0s

Cutting planes:
  Gomory: 1
  Implied bound: 2
  MIR: 9
  Flow cover: 8
  RLT: 1
  Relax-and-lift: 3

Explored 1 nodes (792 simplex iterations) in 0.06 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -129185 -129145 -129134 ... 1.36614e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.291846717073e+05, best bound -1.291848589370e+05, gap 0.0001%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 159911.23
  Scenario: 29 demand increases, 31 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -129184.67
  [DEBUG]   S×d_nominal = 289095.91
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 289095.91 + -129184.67 = 159911.23
  [DEBUG]   Current θ from Master = 166942.28
  [DEBUG]   ⚠️  Z_SP ≤ θ by 7031.04 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 15228.84
  Lower Bound (LB) = 19044.82
  Gap (UB-LB) = 3215.0649, Absolute Gap = 3215.0649, Relative Gap = 0.144433
  Not converged yet (gap = 3215.06 > ε = 200)

  [DEBUG] Adding NEW scenario 20 to Master Problem...
  [DEBUG] New scenario pattern: 29 increases, 31 decreases
    [DEBUG] Scenario 20 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 20 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 20]
    [DEBUG]   - Total constraints in model: 322473
    [DEBUG]   - Total variables in model: 133300
  [DEBUG] Total scenarios in Master: 21
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 21
================================================================================
[Iteration 21] Solving Master Problem...
  Current scenarios in Master: 21
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 322473 rows, 133300 columns and 913622 nonzeros
Model fingerprint: 0x3fcedd68
Variable types: 131041 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 140226 rows and 56946 columns
Presolve time: 3.66s
Presolved: 182247 rows, 76354 columns, 1122745 nonzeros
Variable types: 74095 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -326728.6770
Found heuristic solution: objective -184683.4741

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.42s

Barrier statistics:
 Dense cols : 1203
 AA' NZ     : 4.325e+06
 Factor NZ  : 1.218e+07 (roughly 200 MB of memory)
 Factor Ops : 4.274e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.57428831e+07  2.98696629e+08  1.54e+05 1.54e+01  1.03e+05     7s
   1  -2.00998222e+07  2.79904440e+08  1.11e+05 6.31e+01  7.39e+04     7s
   2  -8.24821400e+06  2.15677286e+08  4.70e+04 8.27e+00  3.34e+04     7s
   3  -4.07647443e+06  2.07597783e+08  2.19e+04 6.76e+00  1.58e+04     7s
   4  -7.37604516e+05  1.47743664e+08  1.39e+03 2.31e+00  1.39e+03     7s
   5  -5.01510709e+05  6.48341082e+07  4.68e+02 6.45e-01  4.76e+02     7s
   6  -4.27337577e+05  4.94973979e+07  2.42e+02 4.46e-01  2.87e+02     7s
   7  -3.64881530e+05  3.53330098e+07  8.22e+01 2.88e-01  1.50e+02     7s
   8  -3.20091024e+05  2.45198789e+07  2.88e+01 1.87e-01  8.76e+01     7s
   9  -2.07182188e+05  1.84892470e+07  2.72e+00 1.37e-01  5.73e+01     7s
  10  -1.47239411e+05  1.00616435e+07  9.18e-01 7.18e-02  3.10e+01     8s
  11  -1.13250419e+05  6.31292593e+06  5.26e-01 4.46e-02  1.94e+01     8s
  12  -8.93300017e+04  4.04592274e+06  3.34e-01 2.75e-02  1.25e+01     8s
  13  -7.05968215e+04  2.72528733e+06  1.91e-01 1.83e-02  8.44e+00     8s
  14  -4.46408515e+04  8.80304436e+05  7.44e-02 5.59e-03  2.79e+00     8s
  15  -1.94977167e+04  3.23337219e+05  3.61e-02 2.06e-03  1.03e+00     8s
  16  -2.46225795e+03  2.38016549e+05  2.26e-02 1.53e-03  7.25e-01     8s
  17   5.84888324e+03  1.81277401e+05  1.88e-02 1.34e-03  5.29e-01     8s
  18   1.24506794e+04  1.36748444e+05  1.57e-02 8.71e-04  3.75e-01     8s
  19   1.70591696e+04  1.17750341e+05  1.42e-02 7.05e-04  3.04e-01     8s
  20   2.53413997e+04  9.98016223e+04  1.06e-02 5.06e-04  2.24e-01     8s
  21   2.68486454e+04  8.70555086e+04  9.85e-03 4.52e-04  1.82e-01     8s
  22   3.17366340e+04  8.39743607e+04  7.66e-03 4.14e-04  1.57e-01     8s
  23   3.32134045e+04  7.27764575e+04  6.91e-03 2.71e-04  1.19e-01     8s
  24   3.66502991e+04  7.02094160e+04  5.52e-03 2.44e-04  1.01e-01     9s
  25   3.89943709e+04  6.55071379e+04  4.53e-03 1.80e-04  7.99e-02     9s
  26   3.98787398e+04  6.34932180e+04  4.15e-03 1.57e-04  7.12e-02     9s
  27   4.22292362e+04  5.99198128e+04  3.23e-03 1.14e-04  5.33e-02     9s
  28   4.32587708e+04  5.80887457e+04  2.83e-03 8.96e-05  4.47e-02     9s
  29   4.48101203e+04  5.63702587e+04  2.26e-03 6.64e-05  3.49e-02     9s
  30   4.57282424e+04  5.52788443e+04  1.91e-03 5.98e-05  2.88e-02     9s
  31   4.68265151e+04  5.44091248e+04  1.52e-03 4.63e-05  2.29e-02     9s
  32   4.76994707e+04  5.42875284e+04  1.23e-03 4.44e-05  1.99e-02     9s
  33   4.80780233e+04  5.33281081e+04  1.10e-03 3.02e-05  1.58e-02     9s
  34   4.86805079e+04  5.30447888e+04  8.94e-04 2.56e-05  1.32e-02    10s
  35   4.88286026e+04  5.28960960e+04  8.43e-04 2.34e-05  1.23e-02    10s
  36   4.92126381e+04  5.26466649e+04  7.14e-04 1.94e-05  1.04e-02    10s
  37   4.94646959e+04  5.24442069e+04  6.29e-04 1.62e-05  8.98e-03    10s
  38   4.97548252e+04  5.21130880e+04  5.29e-04 1.10e-05  7.11e-03    10s
  39   4.99031272e+04  5.19977664e+04  4.77e-04 9.35e-06  6.32e-03    10s
  40   5.01982495e+04  5.18282888e+04  3.76e-04 6.82e-06  4.91e-03    10s
  41   5.03437762e+04  5.17327862e+04  3.29e-04 5.43e-06  4.19e-03    10s
  42   5.05265175e+04  5.17038563e+04  2.68e-04 5.00e-06  3.55e-03    10s
  43   5.06503285e+04  5.16283063e+04  2.26e-04 3.91e-06  2.95e-03    10s
  44   5.07529116e+04  5.15201025e+04  1.91e-04 2.46e-06  2.31e-03    10s
  45   5.08226131e+04  5.14941160e+04  1.68e-04 2.10e-06  2.02e-03    11s
  46   5.09286871e+04  5.14868861e+04  1.34e-04 2.00e-06  1.68e-03    11s
  47   5.10158744e+04  5.14469683e+04  1.05e-04 1.50e-06  1.30e-03    11s
  48   5.10976155e+04  5.14174411e+04  7.90e-05 1.19e-06  9.64e-04    11s
  49   5.11811975e+04  5.13967953e+04  5.11e-05 8.63e-07  6.50e-04    11s
  50   5.12219075e+04  5.13828764e+04  3.80e-05 5.94e-07  4.85e-04    11s
  51   5.12292130e+04  5.13749745e+04  3.56e-05 4.88e-07  4.40e-04    11s
  52   5.12844809e+04  5.13565989e+04  1.84e-05 5.47e-07  2.17e-04    11s
  53   5.13087853e+04  5.13528018e+04  1.06e-05 3.70e-07  1.33e-04    11s
  54   5.13171221e+04  5.13486624e+04  8.02e-06 1.88e-07  9.51e-05    11s
  55   5.13299006e+04  5.13455351e+04  4.10e-06 1.72e-07  4.72e-05    11s
  56   5.13414307e+04  5.13444824e+04  6.91e-07 1.10e-07  9.20e-06    12s
  57   5.13433651e+04  5.13440075e+04  1.32e-07 9.39e-08  1.94e-06    12s
  58   5.13437017e+04  5.13439511e+04  4.88e-08 4.49e-08  7.53e-07    12s
  59   5.13438999e+04  5.13439033e+04  1.85e-09 2.34e-09  1.02e-08    12s
  60   5.13439027e+04  5.13439028e+04  7.13e-09 9.91e-11  2.38e-10    12s

Barrier solved model in 60 iterations and 11.93 seconds (20.32 work units)
Optimal objective 5.13439027e+04


Root crossover log...

  148428 DPushes remaining with DInf 1.4075272e-09                12s
   67952 DPushes remaining with DInf 1.3504229e-09                15s
   34146 DPushes remaining with DInf 1.2209703e-09                20s
    6919 DPushes remaining with DInf 0.0000000e+00                25s
      67 DPushes remaining with DInf 0.0000000e+00                30s
       0 DPushes remaining with DInf 0.0000000e+00                30s

    7941 PPushes remaining with PInf 1.4829689e-04                30s
       0 PPushes remaining with PInf 0.0000000e+00                31s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.7673581e+01     31s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   73406    5.1343903e+04   0.000000e+00   3.767358e+01     31s
   73429    5.1343903e+04   0.000000e+00   0.000000e+00     31s
   73429    5.1343903e+04   0.000000e+00   0.000000e+00     32s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 5.134390e+04, 73429 iterations, 26.99 seconds (47.21 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 51343.9028    0  388 -184683.47 51343.9028   128%     -   32s
H    0     0                    -181783.8653 51343.9028   128%     -   34s
H    0     0                    -180664.1273 51343.9028   128%     -   34s
H    0     0                    -178062.8824 51343.9028   129%     -   35s
H    0     0                    -177768.0195 51343.9028   129%     -   35s
H    0     0                    -177706.7644 51343.9028   129%     -   35s
H    0     0                    -177507.4753 51343.9028   129%     -   35s
H    0     0                    -66719.42011 51343.9028   177%     -   35s
H    0     0                    -66178.03005 51343.9028   178%     -   35s
H    0     0                    -65285.59021 51343.9028   179%     -   35s
H    0     0                    -65242.60031 51343.9028   179%     -   35s
H    0     0                    -64734.36946 51343.9028   179%     -   36s
H    0     0                    -45844.89907 51343.9028   212%     -   36s
H    0     0                    -41912.55586 51343.9028   223%     -   37s
H    0     0                    -41689.05439 51343.9028   223%     -   37s
H    0     0                    -33478.85879 51343.9028   253%     -   37s
H    0     0                    -22812.69281 51343.9028   325%     -   38s
H    0     0                    -20797.53243 51343.9028   347%     -   52s
     0     0 44600.1279    0  350 -20797.532 44600.1279   314%     -  142s
H    0     0                    -20365.89955 44599.8556   319%     -  145s
H    0     0                    -14412.35917 44599.8556   409%     -  145s
H    0     0                    -14411.49005 44599.8556   409%     -  145s
     0     0 44167.2952    0  360 -14411.490 44167.2952   406%     -  188s
     0     0 43962.2480    0  357 -14411.490 43962.2480   405%     -  214s
     0     0 43946.3398    0  363 -14411.490 43946.3398   405%     -  221s
     0     0 43941.1685    0  369 -14411.490 43941.1685   405%     -  228s
     0     0 43794.4930    0  364 -14411.490 43794.4930   404%     -  250s
     0     0 43792.9287    0  374 -14411.490 43792.9287   404%     -  254s
     0     0 43789.5708    0  372 -14411.490 43789.5708   404%     -  258s
     0     0 43782.7399    0  377 -14411.490 43782.7399   404%     -  261s
     0     0 43780.3921    0  382 -14411.490 43780.3921   404%     -  263s
     0     0 43776.8853    0  384 -14411.490 43776.8853   404%     -  266s
     0     0 43773.1236    0  375 -14411.490 43773.1236   404%     -  268s
     0     0 43772.5352    0  375 -14411.490 43772.5352   404%     -  270s
     0     0 41018.2090    0  417 -14411.490 41018.2090   385%     -  370s
     0     0 40274.3783    0  443 -14411.490 40274.3783   379%     -  443s
     0     0 40028.9239    0  451 -14411.490 40028.9239   378%     -  476s
     0     0 39956.5235    0  466 -14411.490 39956.5235   377%     -  501s
     0     0 39879.4810    0  472 -14411.490 39879.4810   377%     -  529s
     0     0 39813.3133    0  502 -14411.490 39813.3133   376%     -  551s
     0     0 39770.7921    0  492 -14411.490 39770.7921   376%     -  566s
     0     0 39677.0825    0  501 -14411.490 39677.0825   375%     -  590s
     0     0 39634.1477    0  503 -14411.490 39634.1477   375%     -  606s
     0     0 39493.3315    0  463 -14411.490 39493.3315   374%     -  642s
     0     0 39436.9589    0  466 -14411.490 39436.9589   374%     -  663s
     0     0 39375.4764    0  460 -14411.490 39375.4764   373%     -  688s
     0     0 39364.8081    0  471 -14411.490 39364.8081   373%     -  697s
     0     0 39347.6491    0  463 -14411.490 39347.6491   373%     -  710s
     0     0 39342.1323    0  465 -14411.490 39342.1323   373%     -  717s
     0     0 39320.7451    0  469 -14411.490 39320.7451   373%     -  730s
     0     0 39280.5624    0  466 -14411.490 39280.5624   373%     -  745s
     0     0 39267.2484    0  460 -14411.490 39267.2484   372%     -  752s
     0     0 39266.2485    0  464 -14411.490 39266.2485   372%     -  755s
     0     0 37620.8873    0  434 -14411.490 37620.8873   361%     -  871s
H    0     0                    -10698.75452 37620.7429   452%     -  872s
H    0     0                    -7472.539954 37620.7429   603%     -  872s
H    0     0                    -7409.899378 37620.7429   608%     -  873s
H    0     0                    -6905.436744 37620.7429   645%     -  873s
H    0     0                    4260.5536622 37620.7429   783%     -  873s
H    0     0                    4687.8310505 37620.7429   703%     -  873s
H    0     0                    5448.4865826 37620.7429   590%     -  873s
     0     0 37317.7254    0  489 5448.48658 37317.7254   585%     -  916s
     0     0 37172.9200    0  476 5448.48658 37172.9200   582%     -  943s
     0     0 37126.8341    0  474 5448.48658 37126.8341   581%     -  963s
     0     0 37102.7232    0  478 5448.48658 37102.7232   581%     -  975s
     0     0 37062.1092    0  479 5448.48658 37062.1092   580%     -  987s
     0     0 36968.3136    0  477 5448.48658 36968.3136   579%     - 1008s
     0     0 36960.8085    0  477 5448.48658 36960.8085   578%     - 1016s
     0     0 36956.2219    0  477 5448.48658 36956.2219   578%     - 1019s
     0     0 36952.4447    0  482 5448.48658 36952.4447   578%     - 1025s
     0     0 36949.9507    0  486 5448.48658 36949.9507   578%     - 1029s
     0     0 36949.4656    0  484 5448.48658 36949.4656   578%     - 1030s
     0     0 36443.7434    0  459 5448.48658 36443.7434   569%     - 1099s
H    0     0                    5843.3327387 36443.4144   524%     - 1101s
H    0     0                    11265.725154 36443.4144   223%     - 1101s
H    0     0                    11307.017495 36443.4144   222%     - 1101s
     0     0 36245.7491    0  454 11307.0175 36245.7491   221%     - 1138s
     0     0 36177.4366    0  471 11307.0175 36177.4366   220%     - 1158s
     0     0 36154.0563    0  470 11307.0175 36154.0563   220%     - 1174s
     0     0 36129.9709    0  471 11307.0175 36129.9709   220%     - 1185s
     0     0 36108.9351    0  485 11307.0175 36108.9351   219%     - 1195s
     0     0 36104.4640    0  491 11307.0175 36104.4640   219%     - 1201s
     0     0 36091.8223    0  484 11307.0175 36091.8223   219%     - 1211s
     0     0 36089.7935    0  484 11307.0175 36089.7935   219%     - 1215s
     0     0 35954.6278    0  469 11307.0175 35954.6278   218%     - 1250s
H    0     0                    13323.062777 35954.5953   170%     - 1252s
H    0     0                    13481.881028 35954.5953   167%     - 1252s
     0     0 35915.5170    0  473 13481.8810 35915.5170   166%     - 1274s
     0     0 35893.9388    0  460 13481.8810 35893.9388   166%     - 1289s
     0     0 35878.0617    0  471 13481.8810 35878.0617   166%     - 1298s
     0     0 35865.3151    0  473 13481.8810 35865.3151   166%     - 1307s
     0     0 35859.5454    0  483 13481.8810 35859.5454   166%     - 1316s
     0     0 35858.5124    0  479 13481.8810 35858.5124   166%     - 1319s
     0     0 35820.4002    0  491 13481.8810 35820.4002   166%     - 1345s
     0     0 35808.4116    0  491 13481.8810 35808.4116   166%     - 1356s
     0     0 35801.5595    0  490 13481.8810 35801.5595   166%     - 1364s
     0     0 35800.4800    0  490 13481.8810 35800.4800   166%     - 1368s
     0     0 35786.4806    0  492 13481.8810 35786.4806   165%     - 1387s
H    0     0                    13741.378698 35786.3149   160%     - 1389s
H    0     0                    14040.275111 35786.3149   155%     - 1389s
H    0     0                    14063.569049 35786.3149   154%     - 1389s
H    0     0                    14064.438167 35786.3149   154%     - 1389s
     0     0 35776.6655    0  488 14064.4382 35776.6655   154%     - 1399s
     0     0 35772.8402    0  494 14064.4382 35772.8402   154%     - 1406s
     0     0 35770.3908    0  538 14064.4382 35770.3908   154%     - 1412s
     0     0 35769.8233    0  498 14064.4382 35769.8233   154%     - 1413s
     0     0 35756.8324    0  522 14064.4382 35756.8324   154%     - 1433s
H    0     0                    14089.124236 35756.7403   154%     - 1433s
     0     0 35753.6938    0  496 14089.1242 35753.6938   154%     - 1440s
     0     0 35749.7170    0  497 14089.1242 35749.7170   154%     - 1447s
     0     0 35748.5580    0  502 14089.1242 35748.5580   154%     - 1451s
     0     0 35738.3722    0  491 14089.1242 35738.3722   154%     - 1461s
H    0     0                    14190.874892 35738.3287   152%     - 1463s
H    0     0                    14278.240011 35738.3287   150%     - 1463s
H    0     0                    14596.173455 35738.3287   145%     - 1463s
     0     0 35735.5292    0  499 14596.1735 35735.5292   145%     - 1471s
     0     0 35731.9580    0  490 14596.1735 35731.9580   145%     - 1479s
     0     0 35729.7284    0  502 14596.1735 35729.7284   145%     - 1484s
     0     0 35729.2793    0  498 14596.1735 35729.2793   145%     - 1487s
     0     0 35718.9457    0  490 14596.1735 35718.9457   145%     - 1499s
H    0     0                    14828.009903 35718.7817   141%     - 1501s
H    0     0                    14930.569521 35718.7817   139%     - 1501s
H    0     0                    14932.426369 35718.7817   139%     - 1501s
     0     0 35717.1241    0  500 14932.4264 35717.1241   139%     - 1505s
     0     0 35704.5240    0  502 14932.4264 35704.5240   139%     - 1518s
     0     0 35704.5149    0  502 14932.4264 35704.5149   139%     - 1530s
H    0     0                    14943.547348 35704.5149   139%     - 1688s
H    0     0                    15035.041069 35704.5149   137%     - 1688s
H    0     0                    15162.733511 35704.5149   135%     - 1808s
H    0     0                    15208.887052 35704.5149   135%     - 1855s
H    0     0                    18308.256687 35704.5149  95.0%     - 1855s
H    0     2                    18852.547526 35704.5149  89.4%     - 1861s
     0     2 35704.5149    0  502 18852.5475 35704.5149  89.4%     - 1861s
     1     3 35241.6767    1  443 18852.5475 35704.5149  89.4% 21442 1897s
     2     4 35263.5630    1  453 18852.5475 35263.5630  87.0% 18482 1921s
     3     5 34244.7207    2  450 18852.5475 35263.4747  87.0% 20461 1959s
     4     7 35076.2604    2  470 18852.5475 35263.1310  87.0% 17072 1997s
     6    13 34726.8423    3  462 18852.5475 35263.1310  87.0% 17094 2049s
    12    26 34505.2891    4  480 18852.5475 35075.9854  86.1% 15629 2121s
    25    38 33444.1105    5  399 18852.5475 34655.9850  83.8% 25348 3600s

Cutting planes:
  Learned: 3
  Gomory: 1
  Implied bound: 166
  MIR: 3865
  Flow cover: 3547
  RLT: 124
  Relax-and-lift: 611

Explored 37 nodes (1759934 simplex iterations) in 3600.15 seconds (6136.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 18852.5 18308.3 15208.9 ... 14596.2

Time limit reached
Best objective 1.885254752569e+04, best bound 3.465598503515e+04, gap 83.8265%
  WARNING: Time limit reached. Using best solution found (gap: 83.83%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.18s
  Master Objective (UB) = 18852.55, θ = 168168.42
  Upper Bound (UB) = 18852.55

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 168168.42
  [DEBUG]   ✓ Scenario 0: θ = 168168.42 ≤ Q = 168168.42 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 168168.42 ≤ Q = 168168.42 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 168168.42 ≤ Q = 168168.42 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 168168.42 ≤ Q = 168168.42 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 168168.42 ≤ Q = 168168.42 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 168168.42 ≤ Q = 168168.42 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 168168.42 ≤ Q = 168168.42 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 168168.42 ≤ Q = 168168.42 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 168168.42 ≤ Q = 168168.42 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 168168.42 ≤ Q = 168168.42 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 168168.42 ≤ Q = 168168.42 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 168168.42 ≤ Q = 168168.42 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 168168.42 ≤ Q = 168168.42 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 168168.42 ≤ Q = 168168.42 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 168168.42 ≤ Q = 168168.42 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 168168.42 ≤ Q = 168168.42 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 168168.42 ≤ Q = 168168.42 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 168168.42 ≤ Q = 168168.42 (slack: 0.00)
  [DEBUG]   ✓ Scenario 18: θ = 168168.42 ≤ Q = 168168.42 (slack: 0.00)
  [DEBUG]   ✓ Scenario 19: θ = 168168.42 ≤ Q = 168168.42 (slack: 0.00)
  [DEBUG]   ✓ Scenario 20: θ = 168168.42 ≤ Q = 168168.42 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 21] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x7f643453
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x809bcbad
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.344905e+13
Presolve removed 2574 rows and 1866 columns
Presolve time: 0.01s
Presolved: 519 rows, 523 columns, 1464 nonzeros
Found heuristic solution: objective 6807086.4455
Variable types: 355 continuous, 168 integer (168 binary)

Root relaxation: objective -1.524522e+05, 252 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -152452.22    0  123 6807086.45 -152452.22   102%     -    0s
H    0     0                    -118078.2633 -152452.22  29.1%     -    0s
H    0     0                    -118912.3401 -152452.22  28.2%     -    0s
     0     0 -132323.65    0   65 -118912.34 -132323.65  11.3%     -    0s
H    0     0                    -129130.7894 -132303.26  2.46%     -    0s
H    0     0                    -130656.0151 -132303.26  1.26%     -    0s
     0     0 -131436.69    0   66 -130656.02 -131436.69  0.60%     -    0s
     0     0 -131337.36    0   63 -130656.02 -131337.36  0.52%     -    0s
     0     0 -131290.43    0   48 -130656.02 -131290.43  0.49%     -    0s
     0     0 -131109.25    0   36 -130656.02 -131109.25  0.35%     -    0s
     0     0 -131016.61    0   26 -130656.02 -131016.61  0.28%     -    0s
     0     0 -130970.74    0   23 -130656.02 -130970.74  0.24%     -    0s
     0     0 -130968.97    0   23 -130656.02 -130968.97  0.24%     -    0s
     0     0 -130905.01    0   16 -130656.02 -130905.01  0.19%     -    0s
     0     0 -130905.01    0   16 -130656.02 -130905.01  0.19%     -    0s
H    0     0                    -130746.9252 -130892.86  0.11%     -    0s
     0     0 -130892.86    0   15 -130746.93 -130892.86  0.11%     -    0s
     0     0 -130883.12    0   11 -130746.93 -130883.12  0.10%     -    0s
     0     0 -130883.12    0   36 -130746.93 -130883.12  0.10%     -    0s
     0     0 -130794.53    0   13 -130746.93 -130794.53  0.04%     -    0s
H    0     0                    -130773.6546 -130786.94  0.01%     -    0s
     0     0 -130786.94    0    4 -130773.65 -130786.94  0.01%     -    0s
H    0     0                    -130786.4190 -130786.94  0.00%     -    0s

Cutting planes:
  Gomory: 8
  Implied bound: 1
  MIR: 26
  Flow cover: 11

Explored 1 nodes (799 simplex iterations) in 0.12 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -130786 -130774 -130747 ... 1.34491e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.307864190318e+05, best bound -1.307868663273e+05, gap 0.0003%
  Subproblem solved in 0.14s
  Worst-case operational profit (Z_SP) = 158352.37
  Scenario: 23 demand increases, 37 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -130786.42
  [DEBUG]   S×d_nominal = 289138.79
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 289138.79 + -130786.42 = 158352.37
  [DEBUG]   Current θ from Master = 168168.42
  [DEBUG]   ⚠️  Z_SP ≤ θ by 9816.05 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 9036.49
  Lower Bound (LB) = 19044.82
  Gap (UB-LB) = -192.2713, Absolute Gap = 192.2713, Relative Gap = -0.010199
  *** CONVERGED (small negative gap: -192.27 within tolerance ε=200) ***
  Note: Negative gap likely due to numerical precision or solver tolerance

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 21
Total Time: 59033.92s
Converged: True
Final Lower Bound: 19044.8188
Final Upper Bound: 18852.5475
Final Gap: -192.271285
Number of Critical Scenarios: 21
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [1] (1/3)
Product 1 Plants: [1] (1/3)
Product 2 Plants: [1] (1/3)
Total Plant Openings: 3
DCs Opened: [0, 5, 7, 8] (4/10)
Active Routes (Plant→DC): 12
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 7 customers  Mode 1: 2 customers  Mode 2: 41 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 21
Start Time: 2026-01-04 12:30:56
End Time: 2026-01-05 04:54:50
Total Time: 59033.92s
Optimal Value: 19044.82
Lower Bound: 19044.82
Upper Bound: 18852.55
Gap: -192.271285
Plants Opened: {0: [1], 1: [1], 2: [1]} (3 plants)
DCs Opened: [0, 5, 7, 8] (4 DCs)
================================================================================

Results saved to: result/DH_single_full_seed21_Mixed_gamma20_20260105_045451.csv

Total Execution Time: 59034.13 seconds
End Time: 2026-01-05 04:54:51

All tasks completed successfully!

