
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 42
DI Scenario: LD
Start Time: 2026-01-05 17:32:59
================================================================================
Loading data from data/DH_data_full_seed42.pkl...

Applying DI scenario: LD
DI values:
  Product 0: ['1.000', '1.021', '1.042'] (k=0.050)
  Product 1: ['1.000', '1.096', '1.201'] (k=0.226)
  Product 2: ['1.000', '1.032', '1.064'] (k=0.077)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=1033, max=1638
  DC capacity (MC): min=441, max=890

Demand Structure (s_rk matrix):
  Total customer-product pairs: 88/150 (41.3% sparse)
  Average products per customer: 1.76

Demand (only non-zero entries):
  Nominal (μ): min=8.24, max=34.19, count=88
  Deviation (μ̂): min=4.08, max=9.90

Costs:
  Plant fixed cost: min=5618, max=9853
  DC fixed cost: min=3306, max=5456
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.368', '1.872'] (k=0.773)
    Product 1: ['1.000', '1.336', '1.786'] (k=0.715)
    Product 2: ['1.000', '1.464', '2.143'] (k=0.940)
  MD:
    Product 0: ['1.000', '1.170', '1.369'] (k=0.387)
    Product 1: ['1.000', '1.302', '1.694'] (k=0.650)
    Product 2: ['1.000', '1.198', '1.435'] (k=0.445)
  LD:
    Product 0: ['1.000', '1.021', '1.042'] (k=0.050)
    Product 1: ['1.000', '1.096', '1.201'] (k=0.226)
    Product 2: ['1.000', '1.032', '1.064'] (k=0.077)
  Mixed:
    Product 0: ['1.000', '1.368', '1.872'] (k=0.773)
    Product 1: ['1.000', '1.302', '1.694'] (k=0.650)
    Product 2: ['1.000', '1.032', '1.064'] (k=0.077)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48774 nonzeros
Model fingerprint: 0x34354955
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11543 rows and 2543 columns
Presolve time: 0.13s
Presolved: 5130 rows, 5957 columns, 35527 nonzeros
Variable types: 3698 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -299385.1261
Found heuristic solution: objective -194749.8017

Root relaxation: objective 4.995223e+04, 4865 iterations, 0.30 seconds (0.36 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 49952.2324    0  733 -194749.80 49952.2324   126%     -    0s
     0     0 48737.3504    0  998 -194749.80 48737.3504   125%     -    1s
H    0     0                    -126715.3775 48734.6497   138%     -    1s
     0     0 48644.9439    0  999 -126715.38 48644.9439   138%     -    1s
     0     0 48633.0608    0  916 -126715.38 48633.0608   138%     -    1s
     0     0 48633.0052    0  914 -126715.38 48633.0052   138%     -    1s
     0     0 46371.0258    0 1027 -126715.38 46371.0258   137%     -    2s
H    0     0                    -120944.0742 46371.0258   138%     -    3s
     0     0 44415.6648    0 1121 -120944.07 44415.6648   137%     -    3s
     0     0 44415.6648    0 1128 -120944.07 44415.6648   137%     -    3s
     0     0 44410.8456    0 1128 -120944.07 44410.8456   137%     -    3s
     0     0 44410.8456    0 1129 -120944.07 44410.8456   137%     -    3s
H    0     0                    -90038.05999 43062.7621   148%     -    6s
H    0     0                    -45068.95674 41093.7495   191%     -    6s
     0     0 41093.7495    0 1329 -45068.957 41093.7495   191%     -    6s
     0     0 41093.7495    0 1329 -45068.957 41093.7495   191%     -    6s
     0     2 41093.7495    0 1329 -45068.957 41093.7495   191%     -    8s
     1     4 41093.7495    1 1223 -45068.957 41093.7495   191%  1616   10s
    15    32 41093.7495    4  897 -45068.957 41093.7495   191%  3168   15s
H   95   256                    -27904.85659 37674.2662   235%  2660   18s
H  100   256                    -24036.26389 37674.2662   257%  2543   18s
H  105   256                    -10442.92116 37674.2662   461%  2433   18s
H  125   256                    -7319.814146 37674.2662   615%  2085   18s
H  150   256                    -5752.362803 37674.2662   755%  1774   18s
H  366   438                    -5052.426814 37674.2662   846%   857   19s
H  368   438                    1712.3484106 37674.2662  2100%   855   19s
   506   539 34587.5883   16  691 1712.34841 37674.2662  2100%   709   20s
H  531   539                    1932.6702264 37674.2662  1849%   706   20s
H  609   643                    1950.5179448 37674.2662  1832%   669   21s
H  613   643                    1961.6149752 37674.2662  1821%   665   21s
H  630   643                    1981.7047124 37674.2662  1801%   660   21s
H  640   643                    2004.3384273 37674.2662  1780%   653   21s
H  648   716                    2029.6890290 37674.2662  1756%   648   22s
H  657   716                    2061.6117269 37674.2662  1727%   642   22s
H  663   716                    2108.6136638 37674.2662  1687%   638   22s
H  749   746                    2526.1907830 37674.2662  1391%   605   22s
H  765   814                    2558.3127224 37674.2662  1373%   598   23s
H  768   814                    2570.2401481 37674.2662  1366%   597   23s
H  774   814                    2578.8441446 37674.2662  1361%   596   23s
H  786   814                    2595.6152298 37674.2662  1351%   594   23s
H  801   814                    2612.4981783 37674.2662  1342%   591   23s
H  928   957                    2624.0401767 37480.7061  1328%   555   24s
H  945   957                    2631.9529673 37480.7061  1324%   553   24s
H  976   957                    2634.8909691 37480.7061  1322%   541   24s
  1110  1086 30343.7517   24  677 2634.89097 36757.2134  1295%   504   25s
H 1128  1086                    2647.2559756 36757.2134  1289%   502   25s
H 1250  1256                    2655.6880946 36757.2134  1284%   484   26s
H 1767  1674                    2708.9717847 36757.2134  1257%   408   28s
H 1820  1705                    2711.9408065 36757.2134  1255%   403   28s
H 1831  1705                    2778.0381347 36757.2134  1223%   401   28s
H 2022  1982                    2793.2853842 36757.2134  1216%   385   29s
H 2038  1982                    2795.1969948 36757.2134  1215%   383   29s
  2361  2262 11818.8051   44  570 2795.19699 36757.2134  1215%   360   30s
H 3304  2844                    3363.0620152 36757.2134   993%   312   36s
H 3304  2833                    3657.4373635 36757.2134   905%   312   36s
H 3304  2831                    3754.6170433 36757.2134   879%   312   36s
H 3304  2815                    4209.7190464 36757.2134   773%   312   36s
H 3304  2789                    4870.8104559 36757.2134   655%   312   37s
H 3304  2686                    5758.5345150 36757.2134   538%   312   37s
  3305  2673 26809.5838   15 1329 5758.53452 36757.2134   538%   312   43s
  3311  2677 20337.9078   36  444 5758.53452 20337.9078   253%   312   45s
H 3327  2553                    5759.2183138 17059.0612   196%   310   50s
  3337  2568 16597.7884   15  289 5759.21831 16923.3214   194%   316   55s
H 3372  2475                    5779.9278224 16331.4767   183%   317   56s
H 3567  2411                    8748.2908274 15346.6022  75.4%   312   57s
H 3603  2283                    8780.7724884 15346.6022  74.8%   311   57s
H 3904  2043                    8798.7301015 14476.5456  64.5%   301   59s
H 3906  1939                    8804.4518569 14476.5456  64.4%   301   59s
H 3908  1839                    8808.3374981 14476.5456  64.4%   301   59s
H 3926  1739                    8827.8385714 14476.5456  64.0%   301   59s
  4043  1680 8859.55632   19  200 8827.83857 14362.0983  62.7%   296   60s
H 4047  1589                    8832.0168666 14362.0983  62.6%   296   60s
H 4059  1500                    8845.7961845 13603.0720  53.8%   296   60s
H 4063  1417                    8854.3167828 13603.0720  53.6%   296   60s
H 4067  1339                    9037.0715097 13603.0720  50.5%   296   60s
H 4189  1166                    9069.0927355 13603.0720  50.0%   291   60s
H 4208  1090                    9073.2710306 13155.4943  45.0%   291   60s

Cutting planes:
  Projected implied bound: 83
  MIR: 126
  Flow cover: 380
  Zero half: 13
  RLT: 11
  Relax-and-lift: 100

Explored 4415 nodes (1265811 simplex iterations) in 62.15 seconds (81.41 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 9073.27 9069.09 9037.07 ... 8798.73

Optimal solution found (tolerance 1.00e-04)
Best objective 9.073271030599e+03, best bound 9.073271030599e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 62.16s
  Master Objective (UB) = 9073.27, θ = 132923.61
  Upper Bound (UB) = 9073.27

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 132923.61
  [DEBUG]   ✓ Scenario 0: θ = 132923.61 ≤ Q = 132923.61 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x531e848b
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xace17b75
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [5e-01, 2e+02]
Found heuristic solution: objective 1.227879e+13
Presolve removed 2553 rows and 1846 columns
Presolve time: 0.01s
Presolved: 540 rows, 543 columns, 1523 nonzeros
Found heuristic solution: objective 6705710.5173
Variable types: 367 continuous, 176 integer (176 binary)

Root relaxation: objective -1.265115e+05, 253 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -126511.51    0  124 6705710.52 -126511.51   102%     -    0s
H    0     0                    -88057.74411 -126511.51  43.7%     -    0s
H    0     0                    -88618.99351 -126511.51  42.8%     -    0s
H    0     0                    -91966.43321 -91966.433  0.00%     -    0s
     0     0          -    0      -91966.433 -91966.433  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 212

Explored 1 nodes (387 simplex iterations) in 0.02 seconds (0.02 work units)
Thread count was 32 (of 32 available processors)

Solution count 5: -91966.4 -88619 -88057.7 ... 1.22788e+13
No other solutions better than -91966.4

Optimal solution found (tolerance 1.00e-04)
Best objective -9.196643320956e+04, best bound -9.196643320956e+04, gap 0.0000%
  Subproblem solved in 0.05s
  Worst-case operational profit (Z_SP) = 99480.16
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -91966.43
  [DEBUG]   S×d_nominal = 191446.59
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 191446.59 + -91966.43 = 99480.16
  [DEBUG]   Current θ from Master = 132923.61
  [DEBUG]   ⚠️  Z_SP ≤ θ by 33443.45 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -24370.17
  Lower Bound (LB) = -24370.17
  Gap (UB-LB) = 33443.4456, Absolute Gap = 33443.4456, Relative Gap = 3.685930
  Not converged yet (gap = 33443.45 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 92029 nonzeros
Model fingerprint: 0x364119f2
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -24370.2 (0.02s)
MIP start from previous solve produced solution with objective -24370.2 (0.02s)
Loaded MIP start from previous solve with objective -24370.2

Presolve removed 12585 rows and 5104 columns
Presolve time: 0.52s
Presolved: 19378 rows, 9636 columns, 107498 nonzeros
Variable types: 7377 continuous, 2259 integer (2259 binary)

Root relaxation: objective 6.620506e+03, 10058 iterations, 2.31 seconds (3.25 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 6620.50644    0  565 -24370.175 6620.50644   127%     -    3s
H    0     0                    -24042.85794 6620.50644   128%     -    3s
     0     0 -544.24140    0  781 -24042.858 -544.24140  97.7%     -    7s
H    0     0                    -23567.92302 -545.73308  97.7%     -    7s
     0     0 -725.84125    0  783 -23567.923 -725.84125  96.9%     -    7s
     0     0 -763.55964    0  779 -23567.923 -763.55964  96.8%     -    8s
     0     0 -763.66423    0  774 -23567.923 -763.66423  96.8%     -    8s
     0     0 -4830.5181    0  739 -23567.923 -4830.5181  79.5%     -   12s
H    0     0                    -23558.85068 -5226.5662  77.8%     -   13s
     0     0 -5226.5662    0  747 -23558.851 -5226.5662  77.8%     -   13s
     0     0 -5290.7397    0  806 -23558.851 -5290.7397  77.5%     -   14s
     0     0 -5298.6102    0  756 -23558.851 -5298.6102  77.5%     -   14s
     0     0 -5299.6386    0  766 -23558.851 -5299.6386  77.5%     -   14s
H    0     0                    -23533.88111 -7800.1633  66.9%     -   20s
H    0     0                    -23525.77322 -7800.1633  66.8%     -   20s
     0     0 -7800.1633    0  769 -23525.773 -7800.1633  66.8%     -   20s
     0     0 -8306.5085    0  861 -23525.773 -8306.5085  64.7%     -   22s
H    0     0                    -23499.83313 -8472.2126  63.9%     -   23s
H    0     0                    -23499.44707 -8472.2126  63.9%     -   23s
     0     0 -8472.2126    0  811 -23499.447 -8472.2126  63.9%     -   23s
     0     0 -8513.5227    0  806 -23499.447 -8513.5227  63.8%     -   23s
     0     0 -8521.0380    0  809 -23499.447 -8521.0380  63.7%     -   24s
     0     0 -8521.5484    0  809 -23499.447 -8521.5484  63.7%     -   24s
H    0     0                    -23498.29802 -8521.5484  63.7%     -   26s
H    0     0                    -23369.99764 -9328.9228  60.1%     -   29s
H    0     0                    -23351.96244 -9328.9228  60.1%     -   29s
H    0     0                    -22998.24601 -9328.9228  59.4%     -   29s
     0     0 -9328.9228    0  604 -22998.246 -9328.9228  59.4%     -   29s
H    0     0                    -22966.23656 -9328.9812  59.4%     -   29s
     0     0 -9560.0335    0  615 -22966.237 -9560.0335  58.4%     -   30s
H    0     0                    -22961.19518 -9619.1685  58.1%     -   31s
     0     0 -9619.1685    0  622 -22961.195 -9619.1685  58.1%     -   31s
     0     0 -9629.7693    0  632 -22961.195 -9629.7693  58.1%     -   32s
     0     0 -9633.9639    0  618 -22961.195 -9633.9639  58.0%     -   32s
     0     0 -9864.9753    0  590 -22961.195 -9864.9753  57.0%     -   34s
H    0     0                    -22895.65283 -9865.1135  56.9%     -   34s
     0     0 -9972.0268    0  600 -22895.653 -9972.0268  56.4%     -   35s
     0     0 -9984.0363    0  635 -22895.653 -9984.0363  56.4%     -   36s
     0     0 -9987.1458    0  627 -22895.653 -9987.1458  56.4%     -   36s
H    0     0                    -22546.40418 -10088.916  55.3%     -   38s
H    0     0                    -22443.62548 -10088.916  55.0%     -   38s
H    0     0                    -22432.05092 -10088.916  55.0%     -   38s
H    0     0                    -22416.18855 -10088.916  55.0%     -   38s
     0     0 -10088.916    0  870 -22416.189 -10088.916  55.0%     -   38s
H    0     0                    -22392.21580 -10089.055  54.9%     -   39s
H    0     0                    -22354.54855 -10089.055  54.9%     -   39s
H    0     0                    -22081.79001 -10089.055  54.3%     -   39s
H    0     0                    -21788.35208 -10089.055  53.7%     -   39s
H    0     0                    -21779.45448 -10089.055  53.7%     -   39s
     0     0 -10128.934    0  809 -21779.454 -10128.934  53.5%     -   39s
     0     0 -10155.213    0  796 -21779.454 -10155.213  53.4%     -   40s
     0     0 -10159.396    0  795 -21779.454 -10159.396  53.4%     -   40s
     0     0 -10194.113    0  646 -21779.454 -10194.113  53.2%     -   42s
H    0     0                    -21599.26030 -10194.283  52.8%     -   42s
     0     0 -10208.325    0  571 -21599.260 -10208.325  52.7%     -   42s
     0     0 -10212.667    0  577 -21599.260 -10212.667  52.7%     -   42s
     0     0 -10261.027    0  671 -21599.260 -10261.027  52.5%     -   44s
H    0     0                    -21592.02391 -10261.220  52.5%     -   45s
H    0     0                    -21591.57114 -10261.220  52.5%     -   45s
     0     0 -10267.491    0  569 -21591.571 -10267.491  52.4%     -   45s
     0     0 -10294.833    0  576 -21591.571 -10294.833  52.3%     -   47s
     0     0 -10302.588    0  570 -21591.571 -10302.588  52.3%     -   47s
     0     0 -10303.629    0  590 -21591.571 -10303.629  52.3%     -   47s
     0     0 -10319.451    0  576 -21591.571 -10319.451  52.2%     -   48s
     0     0 -10319.634    0  576 -21591.571 -10319.634  52.2%     -   49s
H    0     0                    -21591.33749 -10319.634  52.2%     -   51s
     0     2 -10319.634    0  576 -21591.337 -10319.634  52.2%     -   59s
     1     4 -10409.253    1  596 -21591.337 -10321.204  52.2%   923   61s
    15    32 -12178.702    4  519 -21591.337 -11585.465  46.3%  1165   65s
    63    92 -14699.940    6  502 -21591.337 -12201.203  43.5%  1050   70s
H   65    92                    -18308.65175 -12201.203  33.4%  1026   70s
H  134   139                    -18106.26075 -12787.217  29.4%   752   75s
H  140   139                    -18047.32294 -12787.217  29.1%   747   75s
H  145   139                    -17970.47977 -12787.217  28.8%   749   75s
H  159   139                    -17906.34701 -12787.217  28.6%   741   75s
   534   284 -17645.504    9  197 -17906.347 -12854.391  28.2%   425   80s
   864   259     cutoff   12      -17906.347 -13269.142  25.9%   395   85s
  1047   214 -17482.099    8   89 -17906.347 -13431.141  25.0%   393   90s
  1977   482     cutoff   16      -17906.347 -16357.180  8.65%   285   95s
* 2991   641              60    -17901.47641 -16819.269  6.05%   196   96s
* 3305   641              62    -17870.06619 -16863.052  5.64%   179   96s
* 6315  1184              54    -17866.02484 -17590.471  1.54%   101   98s
* 7444  1874              78    -17813.99584 -17686.410  0.72%  87.7   98s
  8949   854 -17767.682   31   40 -17813.996 -17746.846  0.38%  74.6  100s
*10169   295              69    -17810.60610 -17767.960  0.24%  66.3  100s
*10216   295              68    -17807.83046 -17767.960  0.22%  66.0  100s
*10958    37              64    -17795.61435 -17781.451  0.08%  62.0  101s

Cutting planes:
  Gomory: 2
  Cover: 1
  MIR: 2267
  Flow cover: 1122
  Inf proof: 5
  Zero half: 25
  RLT: 89
  Relax-and-lift: 378

Explored 11294 nodes (730616 simplex iterations) in 101.28 seconds (143.65 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -17795.6 -17807.8 -17810.6 ... -18047.3

Optimal solution found (tolerance 1.00e-04)
Warning: max constraint violation (6.7297e-09) exceeds tolerance
Best objective -1.779561434978e+04, best bound -1.779398689021e+04, gap 0.0091%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 101.29s
  Master Objective (UB) = -17795.61, θ = 95023.67
  Upper Bound (UB) = -17795.61

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 95023.67
  [DEBUG]   ✓ Scenario 0: θ = 95023.67 ≤ Q = 95023.67 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 95023.67 ≤ Q = 95023.67 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x1ac66318
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xe5399ce8
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.407451e+13
Presolve removed 2558 rows and 1853 columns
Presolve time: 0.01s
Presolved: 535 rows, 536 columns, 1508 nonzeros
Found heuristic solution: objective 7888937.0683
Variable types: 360 continuous, 176 integer (176 binary)

Root relaxation: objective -1.304957e+05, 288 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -130495.72    0  139 7888937.07 -130495.72   102%     -    0s
H    0     0                    -82878.16971 -130495.72  57.5%     -    0s
H    0     0                    -84642.76092 -130495.72  54.2%     -    0s
H    0     0                    -109666.4484 -130495.72  19.0%     -    0s
     0     0 -116536.09    0  123 -109666.45 -116536.09  6.26%     -    0s
H    0     0                    -112603.7510 -116511.00  3.47%     -    0s
     0     0 -116167.78    0  120 -112603.75 -116167.78  3.17%     -    0s
     0     0 -115698.89    0  122 -112603.75 -115698.89  2.75%     -    0s
     0     0 -115551.40    0  121 -112603.75 -115551.40  2.62%     -    0s
H    0     0                    -112691.8797 -115551.40  2.54%     -    0s
     0     0 -115208.56    0  125 -112691.88 -115208.56  2.23%     -    0s
     0     0 -115163.73    0  125 -112691.88 -115163.73  2.19%     -    0s
     0     0 -114924.28    0  126 -112691.88 -114924.28  1.98%     -    0s
H    0     0                    -112828.6881 -114833.57  1.78%     -    0s
     0     0 -114417.56    0  126 -112828.69 -114417.56  1.41%     -    0s
     0     0 -114359.01    0  117 -112828.69 -114359.01  1.36%     -    0s
     0     0 -114340.95    0  116 -112828.69 -114340.95  1.34%     -    0s
     0     0 -114340.94    0  116 -112828.69 -114340.94  1.34%     -    0s
     0     0 -114148.37    0   98 -112828.69 -114148.37  1.17%     -    0s
     0     0 -114134.14    0   95 -112828.69 -114134.14  1.16%     -    0s
     0     0 -114127.87    0  105 -112828.69 -114127.87  1.15%     -    0s
     0     0 -114060.32    0   94 -112828.69 -114060.32  1.09%     -    0s
     0     0 -114058.26    0   94 -112828.69 -114058.26  1.09%     -    0s
     0     2 -114057.42    0   94 -112828.69 -114057.42  1.09%     -    0s
H 2379  1070                    -112837.2902 -113384.68  0.49%   7.3    0s
H 2388  1070                    -112840.9407 -113384.68  0.48%   7.3    0s

Cutting planes:
  Gomory: 30
  Implied bound: 5
  MIR: 321
  Flow cover: 4
  RLT: 71
  Relax-and-lift: 4
  BQP: 1

Explored 21796 nodes (172359 simplex iterations) in 1.21 seconds (0.94 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -112841 -112837 -112829 ... 1.40745e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.128409406564e+05, best bound -1.128471934427e+05, gap 0.0055%
  Subproblem solved in 1.25s
  Worst-case operational profit (Z_SP) = 73913.95
  Scenario: 60 demand increases, 0 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -112840.94
  [DEBUG]   S×d_nominal = 186754.89
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 186754.89 + -112840.94 = 73913.95
  [DEBUG]   Current θ from Master = 95023.67
  [DEBUG]   ⚠️  Z_SP ≤ θ by 21109.72 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -38905.33
  Lower Bound (LB) = -24370.17
  Gap (UB-LB) = 6574.5602, Absolute Gap = 6574.5602, Relative Gap = 0.369448
  Not converged yet (gap = 6574.56 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 60 increases, 0 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135284 nonzeros
Model fingerprint: 0x9b326b24
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -38905.3 (0.03s)
Loaded MIP start from previous solve with objective -38905.3

Presolve removed 18826 rows and 7646 columns
Presolve time: 0.76s
Presolved: 28427 rows, 13334 columns, 175169 nonzeros
Variable types: 11075 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   27148   -1.5735895e+04   0.000000e+00   3.059597e+06      5s
   36559   -8.4239743e+03   0.000000e+00   7.152786e+06     10s
Concurrent spin time: 0.00s

Solved with dual simplex

Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   22054   -4.4600144e+03   0.000000e+00   0.000000e+00     11s

Root relaxation: objective -4.460014e+03, 22054 iterations, 10.05 seconds (13.69 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -4460.0144    0  362 -38905.333 -4460.0144  88.5%     -   11s
H    0     0                    -36415.62686 -4460.0144  87.8%     -   11s
H    0     0                    -36409.98847 -4460.0144  87.8%     -   11s
H    0     0                    -36392.66128 -4460.0144  87.7%     -   11s
H    0     0                    -32230.46135 -4460.0144  86.2%     -   13s
H    0     0                    -31915.50485 -4460.0144  86.0%     -   13s
H    0     0                    -31636.80634 -4460.0144  85.9%     -   13s
H    0     0                    -31214.80039 -4460.0144  85.7%     -   13s
H    0     0                    -31127.22639 -4460.0144  85.7%     -   13s
H    0     0                    -31116.11556 -4460.0144  85.7%     -   13s
H    0     0                    -31106.88531 -4460.0144  85.7%     -   13s
H    0     0                    -31097.81297 -4460.0144  85.7%     -   13s
     0     0 -6357.8259    0  389 -31097.813 -6357.8259  79.6%     -   16s
H    0     0                    -31096.56303 -6359.5209  79.5%     -   16s
     0     0 -7043.5572    0  384 -31096.563 -7043.5572  77.3%     -   18s
     0     0 -7065.4297    0  400 -31096.563 -7065.4297  77.3%     -   19s
     0     0 -7322.2021    0  403 -31096.563 -7322.2021  76.5%     -   19s
     0     0 -7409.5878    0  388 -31096.563 -7409.5878  76.2%     -   20s
     0     0 -7409.5878    0  389 -31096.563 -7409.5878  76.2%     -   20s
     0     0 -7409.5878    0  377 -31096.563 -7409.5878  76.2%     -   21s
     0     0 -7409.5878    0  375 -31096.563 -7409.5878  76.2%     -   21s
     0     0 -9569.0090    0  537 -31096.563 -9569.0090  69.2%     -   27s
H    0     0                    -31094.47165 -9569.0573  69.2%     -   28s
H    0     0                    -31093.22172 -9569.0573  69.2%     -   28s
H    0     0                    -31085.39931 -9569.0573  69.2%     -   28s
H    0     0                    -30774.16361 -10164.689  67.0%     -   30s
H    0     0                    -30766.66440 -10164.689  67.0%     -   30s
H    0     0                    -30750.79292 -10164.689  66.9%     -   30s
     0     0 -10164.689    0  454 -30750.793 -10164.689  66.9%     -   30s
     0     0 -10296.579    0  464 -30750.793 -10296.579  66.5%     -   31s
     0     0 -10320.627    0  463 -30750.793 -10320.627  66.4%     -   31s
     0     0 -10322.504    0  465 -30750.793 -10322.504  66.4%     -   31s
     0     0 -10322.561    0  463 -30750.793 -10322.561  66.4%     -   31s
H    0     0                    -30720.32449 -11644.894  62.1%     -   39s
H    0     0                    -22861.55997 -11644.894  49.1%     -   39s
     0     0 -11644.894    0  509 -22861.560 -11644.894  49.1%     -   39s
H    0     0                    -22851.99310 -11925.448  47.8%     -   41s
     0     0 -11925.448    0  524 -22851.993 -11925.448  47.8%     -   41s
H    0     0                    -22807.36301 -12053.081  47.2%     -   43s
     0     0 -12053.081    0  525 -22807.363 -12053.081  47.2%     -   43s
     0     0 -12094.196    0  519 -22807.363 -12094.196  47.0%     -   44s
H    0     0                    -22761.56263 -12104.373  46.8%     -   44s
     0     0 -12104.373    0  516 -22761.563 -12104.373  46.8%     -   44s
     0     0 -12116.017    0  524 -22761.563 -12116.017  46.8%     -   45s
     0     0 -12119.362    0  524 -22761.563 -12119.362  46.8%     -   45s
     0     0 -12120.367    0  521 -22761.563 -12120.367  46.8%     -   45s
     0     0 -12120.560    0  523 -22761.563 -12120.560  46.7%     -   46s
     0     0 -12544.835    0  613 -22761.563 -12544.835  44.9%     -   52s
H    0     0                    -22758.24314 -12544.919  44.9%     -   52s
     0     0 -12742.226    0  595 -22758.243 -12742.226  44.0%     -   54s
     0     0 -12784.097    0  618 -22758.243 -12784.097  43.8%     -   55s
     0     0 -12811.709    0  622 -22758.243 -12811.709  43.7%     -   56s
     0     0 -12816.910    0  628 -22758.243 -12816.910  43.7%     -   56s
     0     0 -12842.000    0  628 -22758.243 -12842.000  43.6%     -   57s
     0     0 -12851.365    0  626 -22758.243 -12851.365  43.5%     -   57s
     0     0 -12853.725    0  636 -22758.243 -12853.725  43.5%     -   57s
     0     0 -12853.787    0  639 -22758.243 -12853.787  43.5%     -   57s
     0     0 -12967.173    0  576 -22758.243 -12967.173  43.0%     -   59s
     0     0 -12981.512    0  568 -22758.243 -12981.512  43.0%     -   60s
     0     0 -12987.668    0  576 -22758.243 -12987.668  42.9%     -   61s
     0     0 -12988.970    0  572 -22758.243 -12988.970  42.9%     -   61s
     0     0 -12989.485    0  574 -22758.243 -12989.485  42.9%     -   61s
H    0     0                    -22755.50202 -13016.921  42.8%     -   62s
     0     0 -13016.921    0  576 -22755.502 -13016.921  42.8%     -   62s
     0     0 -13018.897    0  574 -22755.502 -13018.897  42.8%     -   63s
     0     0 -13019.394    0  574 -22755.502 -13019.394  42.8%     -   63s
     0     0 -13035.233    0  586 -22755.502 -13035.233  42.7%     -   64s
     0     0 -13039.899    0  587 -22755.502 -13039.899  42.7%     -   65s
     0     0 -13041.333    0  593 -22755.502 -13041.333  42.7%     -   65s
     0     0 -13041.516    0  598 -22755.502 -13041.516  42.7%     -   65s
     0     0 -13053.602    0  595 -22755.502 -13053.602  42.6%     -   66s
     0     0 -13054.834    0  600 -22755.502 -13054.834  42.6%     -   67s
     0     0 -13054.881    0  599 -22755.502 -13054.881  42.6%     -   67s
     0     0 -13070.897    0  588 -22755.502 -13070.897  42.6%     -   68s
     0     0 -13074.999    0  589 -22755.502 -13074.999  42.5%     -   69s
     0     0 -13077.235    0  591 -22755.502 -13077.235  42.5%     -   69s
     0     0 -13078.433    0  598 -22755.502 -13078.433  42.5%     -   70s
     0     0 -13078.575    0  593 -22755.502 -13078.575  42.5%     -   70s
     0     0 -13084.560    0  595 -22755.502 -13084.560  42.5%     -   71s
     0     0 -13088.449    0  599 -22755.502 -13088.449  42.5%     -   72s
     0     0 -13089.819    0  608 -22755.502 -13089.819  42.5%     -   72s
     0     0 -13090.584    0  602 -22755.502 -13090.584  42.5%     -   72s
     0     0 -13093.905    0  599 -22755.502 -13093.905  42.5%     -   73s
     0     0 -13095.332    0  602 -22755.502 -13095.332  42.5%     -   73s
     0     0 -13095.945    0  604 -22755.502 -13095.945  42.4%     -   74s
     0     0 -13097.231    0  603 -22755.502 -13097.231  42.4%     -   78s
     0     0 -13097.499    0  607 -22755.502 -13097.499  42.4%     -   78s
     0     0 -13099.274    0  606 -22755.502 -13099.274  42.4%     -   79s
     0     0 -13100.551    0  606 -22755.502 -13100.551  42.4%     -   80s
     0     2 -13100.551    0  606 -22755.502 -13100.551  42.4%     -   92s
     1     4 -13186.617    1  599 -22755.502 -13102.297  42.4%   681   95s
     7    16 -13344.077    3  582 -22755.502 -13249.364  41.8%  1683  100s
    31    60 -13577.209    5  578 -22755.502 -13541.736  40.5%  2652  106s
    61    92 -13657.604    6  579 -22755.502 -13577.939  40.3%  2153  111s
   125   156 -13894.246    8  584 -22755.502 -13658.491  40.0%  1466  116s
   159   191 -13931.079    9  589 -22755.502 -13658.491  40.0%  1342  120s
   233   264 -14140.266   12  678 -22755.502 -13658.491  40.0%  1193  126s
   277   309 -14277.089   13  687 -22755.502 -13800.754  39.4%  1136  131s
   331   359 -14331.727   14  656 -22755.502 -13895.092  38.9%  1133  135s
   448   437 -16182.497   15  510 -22755.502 -13895.092  38.9%  1117  144s
   507   463 -14627.579   16  608 -22755.502 -13931.151  38.8%  1172  148s
   569   489 -14532.381   16  666 -22755.502 -13931.151  38.8%  1157  152s
   623   525 -14643.363   17  542 -22755.502 -13931.151  38.8%  1170  155s
   671   555 -17176.032   19  463 -22755.502 -13931.151  38.8%  1201  161s
   726   583 -16295.701   19  548 -22755.502 -14092.868  38.1%  1274  165s
   768   615 -17048.711   20  558 -22755.502 -14148.444  37.8%  1287  170s
   868   696 -19085.873   21  379 -22755.502 -14208.907  37.6%  1353  177s
   976   760 -18948.466   22  552 -22755.502 -14269.616  37.3%  1332  184s
  1023   788 -18468.945   23  469 -22755.502 -14269.616  37.3%  1330  187s
  1082   822 -20065.959   24  374 -22755.502 -14269.616  37.3%  1316  192s
  1152   860 -19352.239   26  451 -22755.502 -14269.616  37.3%  1289  195s
  1321   961 -20168.450   38  277 -22755.502 -14291.203  37.2%  1217  203s
  1432  1020     cutoff   43      -22755.502 -14375.907  36.8%  1181  208s
  1553  1083 -22496.308   52  336 -22755.502 -14375.907  36.8%  1150  214s
  1691  1119 -19944.200   12  209 -22755.502 -14375.907  36.8%  1117  218s
  1828  1174     cutoff   16      -22755.502 -14546.681  36.1%  1097  223s
  1965  1234 -16701.742   11  250 -22755.502 -14546.681  36.1%  1080  228s
  2089  1308 -18032.193   14  202 -22755.502 -14689.400  35.4%  1072  233s
  2232  1361 -21433.251   15  187 -22755.502 -14689.400  35.4%  1066  238s
  2379  1416 -20391.026   15  188 -22755.502 -14733.360  35.3%  1055  242s
  2528  1475 -19468.560   16  223 -22755.502 -14733.360  35.3%  1047  248s
  2657  1545     cutoff   15      -22755.502 -14869.101  34.7%  1048  253s
  2808  1627 -21508.816   16  189 -22755.502 -14963.709  34.2%  1043  258s
  2948  1675 -19689.735   13  226 -22755.502 -14963.709  34.2%  1044  263s
  3167  1734 -20344.896   14  208 -22755.502 -14963.709  34.2%  1022  269s
  3363  1769 -20755.454   16  211 -22755.502 -15109.439  33.6%  1013  275s
  3607  1841 -22415.364   17  214 -22755.502 -15281.617  32.8%   994  282s
  3819  1923 -21335.185   18  275 -22755.502 -15306.905  32.7%   988  289s
  4056  2010 -21445.774   17  296 -22755.502 -15386.403  32.4%   977  298s
H 4255  2009                    -22691.75617 -15413.467  32.1%   964  298s
  4347  2067     cutoff   18      -22691.756 -15438.237  32.0%   960  306s
H 4354  2067                    -22665.11372 -15438.237  31.9%   959  306s
H 4359  2063                    -22639.88058 -15438.237  31.8%   960  306s
H 4362  2046                    -22531.29872 -15438.237  31.5%   960  306s
H 4500  2005                    -22311.77273 -15438.237  30.8%   951  306s
  4559  2075     cutoff   21      -22311.773 -15438.237  30.8%   949  313s
  4810  2136 -16962.364    8  301 -22311.773 -15438.237  30.8%   943  320s
  5107  2217 -19860.316   11  215 -22311.773 -15438.237  30.8%   934  327s
  5397  2261 infeasible   13      -22311.773 -15552.642  30.3%   925  338s
  5708  2296     cutoff   19      -22311.773 -15552.642  30.3%   918  347s
  5931  2398 -21253.507   18  219 -22311.773 -16060.170  28.0%   918  356s
  6227  2451 -20598.433   17  472 -22311.773 -16071.187  28.0%   915  366s
  6540  2534 -20727.518   19  197 -22311.773 -16209.160  27.4%   912  376s
  6858  2535 -16987.877   17  606 -22311.773 -16209.160  27.4%   912  398s
  6860  2536 -17618.366   20  362 -22311.773 -16209.160  27.4%   912  412s
  6861  2537 -18215.645   13  510 -22311.773 -16209.160  27.4%   912  422s
  6862  2538 -18592.589   10  609 -22311.773 -16209.160  27.4%   912  427s
  6863  2538 -18237.580   12  605 -22311.773 -16209.160  27.4%   912  430s
  6865  2540 -16795.522   13  558 -22311.773 -16209.160  27.4%   911  436s
  6869  2542 -17616.256   14  597 -22311.773 -16209.160  27.4%   911  441s
  6870  2543 -18407.944   14  589 -22311.773 -16209.160  27.4%   911  446s
  6873  2545 -21271.494   16  602 -22311.773 -16209.160  27.4%   910  450s
  6875  2546 -18981.520   24  639 -22311.773 -16209.160  27.4%   910  455s
  6877  2548 -18530.156   17  657 -22311.773 -16209.160  27.4%   910  461s
  6879  2549 -20341.288   26  613 -22311.773 -16209.160  27.4%   909  467s
  6881  2550 -22003.619   25  630 -22311.773 -16209.160  27.4%   909  474s
  6882  2551 -18424.683   15  630 -22311.773 -16209.160  27.4%   909  490s
  6883  2552 -18720.366   14  630 -22311.773 -16209.160  27.4%   909  499s
  6884  2555 -16209.160   13  657 -22311.773 -16209.160  27.4%   922  506s
  6886  2559 -16209.160   14  677 -22311.773 -16209.160  27.4%   922  511s
  6890  2563 -16209.160   15  585 -22311.773 -16209.160  27.4%   923  516s
  6898  2575 -16209.160   16  574 -22311.773 -16209.160  27.4%   924  523s
  6912  2598 -16209.160   17  567 -22311.773 -16209.160  27.4%   934  527s
  6940  2619 -16291.004   18  395 -22311.773 -16209.160  27.4%   939  534s
  6972  2639 -16862.815   19  397 -22311.773 -16209.160  27.4%   943  541s
  7005  2662 -17186.801   20  459 -22311.773 -16209.160  27.4%   947  547s
  7060  2668 -17466.777   21  452 -22311.773 -16209.160  27.4%   953  552s
  7137  2671 -17710.738   22  446 -22311.773 -16209.160  27.4%   952  561s
  7212  2653 -18642.094   23  441 -22311.773 -16209.160  27.4%   952  565s
  7295  2645 -20111.015   23  360 -22311.773 -16209.160  27.4%   954  571s
  7372  2645 -19387.920   24  292 -22311.773 -16209.160  27.4%   955  579s
  7450  2646 -20470.432   25  357 -22311.773 -16209.160  27.4%   955  585s
  7591  2630     cutoff   27      -22311.773 -16365.530  26.7%   956  593s
  7664  2634 -21271.235   29  203 -22311.773 -16415.003  26.4%   957  597s
  7728  2628     cutoff   30      -22311.773 -16415.003  26.4%   958  601s
  7810  2623 -20871.261   28  386 -22311.773 -16415.003  26.4%   957  607s
  7883  2624 -20880.352   29  378 -22311.773 -16511.909  26.0%   957  612s
  7959  2615 -22264.586   32  183 -22311.773 -16717.871  25.1%   958  616s
  8050  2596 -19637.550   20  305 -22311.773 -16717.871  25.1%   958  621s
  8140  2577 -20279.404   21  210 -22311.773 -17367.829  22.2%   959  625s
  8252  2565 -21809.298   23  178 -22311.773 -17367.829  22.2%   963  633s
  8319  2534 -21826.405   24  170 -22311.773 -17921.385  19.7%   964  640s
  8399  2508 -21930.865   25  185 -22311.773 -17921.385  19.7%   965  646s
  8494  2474     cutoff   29      -22311.773 -18400.731  17.5%   966  652s
  8595  2458 -20794.510   19  254 -22311.773 -18403.057  17.5%   966  657s
  8692  2428 -22003.045   23  202 -22311.773 -18403.057  17.5%   968  662s
  8798  2375 -21250.856   22  378 -22311.773 -18569.095  16.8%   968  667s
  8920  2324 -22181.243   24  332 -22311.773 -18785.855  15.8%   968  673s
  9061  2248 -22044.208   24  313 -22311.773 -19216.257  13.9%   967  678s
  9192  2162 -21669.210   22  420 -22311.773 -19259.417  13.7%   965  684s
  9357  2055 -20404.591   20  231 -22311.773 -19263.581  13.7%   963  689s
  9549  1880     cutoff   24      -22311.773 -19744.358  11.5%   960  697s
  9781  1659     cutoff   26      -22311.773 -20048.913  10.1%   952  703s
 10012  1512 -21621.643   32  163 -22311.773 -20413.766  8.51%   941  706s

Cutting planes:
  Learned: 1
  MIR: 194
  Flow cover: 693
  Zero half: 26
  RLT: 15
  Relax-and-lift: 33

Explored 10124 nodes (9533228 simplex iterations) in 706.54 seconds (1237.75 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -22311.8 -22531.3 -22639.9 ... -22852
No other solutions better than -22311.8

Optimal solution found (tolerance 1.00e-04)
Best objective -2.231177273079e+04, best bound -2.231177273079e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 706.55s
  Master Objective (UB) = -22311.77, θ = 100579.64
  Upper Bound (UB) = -22311.77

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 100579.64
  [DEBUG]   ✓ Scenario 0: θ = 100579.64 ≤ Q = 100579.64 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 100579.64 ≤ Q = 100579.64 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 100579.64 ≤ Q = 100579.64 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x2b6c5a5b
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xd493a5a5
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.243022e+13
Presolve removed 2560 rows and 1852 columns
Presolve time: 0.01s
Presolved: 533 rows, 537 columns, 1504 nonzeros
Found heuristic solution: objective 6715326.9425
Variable types: 362 continuous, 175 integer (175 binary)

Root relaxation: objective -1.302186e+05, 262 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -130218.61    0  134 6715326.94 -130218.61   102%     -    0s
H    0     0                    -90349.99648 -130218.61  44.1%     -    0s
H    0     0                    -103379.5746 -130218.61  26.0%     -    0s
     0     0 -109220.76    0   91 -103379.57 -109220.76  5.65%     -    0s
H    0     0                    -106687.9423 -109165.13  2.32%     -    0s
     0     0 -109039.84    0   95 -106687.94 -109039.84  2.20%     -    0s
     0     0 -109034.43    0   95 -106687.94 -109034.43  2.20%     -    0s
     0     0 -109034.41    0   95 -106687.94 -109034.41  2.20%     -    0s
     0     0 -108817.28    0   67 -106687.94 -108817.28  2.00%     -    0s
H    0     0                    -107779.1619 -108802.02  0.95%     -    0s
     0     0 -108713.73    0   63 -107779.16 -108713.73  0.87%     -    0s
     0     0 -108713.73    0   64 -107779.16 -108713.73  0.87%     -    0s
     0     0 -108652.44    0   64 -107779.16 -108652.44  0.81%     -    0s
     0     2 -108652.44    0   64 -107779.16 -108652.44  0.81%     -    0s
*  569     0              28    -107786.2525 -107792.11  0.01%   6.5    0s

Cutting planes:
  Gomory: 50
  Implied bound: 7
  MIR: 149
  Flow cover: 2
  RLT: 45
  Relax-and-lift: 1

Explored 573 nodes (4237 simplex iterations) in 0.33 seconds (0.08 work units)
Thread count was 32 (of 32 available processors)

Solution count 7: -107786 -107779 -106688 ... 1.24302e+13
No other solutions better than -107786

Optimal solution found (tolerance 1.00e-04)
Best objective -1.077862525263e+05, best bound -1.077862525263e+05, gap 0.0000%
  Subproblem solved in 0.36s
  Worst-case operational profit (Z_SP) = 84428.90
  Scenario: 42 demand increases, 18 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -107786.25
  [DEBUG]   S×d_nominal = 192215.16
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 192215.16 + -107786.25 = 84428.90
  [DEBUG]   Current θ from Master = 100579.64
  [DEBUG]   ⚠️  Z_SP ≤ θ by 16150.73 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -38462.50
  Lower Bound (LB) = -24370.17
  Gap (UB-LB) = 2058.4018, Absolute Gap = 2058.4018, Relative Gap = 0.092256
  Not converged yet (gap = 2058.40 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 42 increases, 18 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178539 nonzeros
Model fingerprint: 0x99b5d412
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -38462.5 (0.03s)
Loaded MIP start from previous solve with objective -38462.5

Presolve removed 25088 rows and 10188 columns
Presolve time: 1.03s
Presolved: 37455 rows, 17032 columns, 231759 nonzeros
Variable types: 14773 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 37455 rows, 17032 columns, 231759 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   33735   -1.5265309e+04   0.000000e+00   4.434489e+07      5s
   42265   -9.4615305e+03   0.000000e+00   1.307909e+07     10s
   50162   -5.8399121e+03   0.000000e+00   4.135193e+05     15s
Concurrent spin time: 2.33s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective -4.486271e+03, 29371 iterations, 17.41 seconds (23.53 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -4486.2712    0  364 -38462.504 -4486.2712  88.3%     -   18s
H    0     0                    -31741.02620 -4486.2712  85.9%     -   19s
H    0     0                    -23673.37875 -4486.2712  81.0%     -   19s
H    0     0                    -23559.45033 -4486.2712  81.0%     -   19s
H    0     0                    -23537.62182 -4486.2712  80.9%     -   19s
H    0     0                    -23500.77410 -4486.2712  80.9%     -   19s
H    0     0                    -22921.82765 -4486.2712  80.4%     -   19s
H    0     0                    -22919.70151 -4486.2712  80.4%     -   20s
H    0     0                    -22877.26756 -4486.2712  80.4%     -   20s
     0     0 -8298.8807    0  393 -22877.268 -8298.8807  63.7%     -   33s
H    0     0                    -22872.78251 -8298.8807  63.7%     -   35s
     0     0 -10424.651    0  372 -22872.783 -10424.651  54.4%     -   38s
     0     0 -10440.198    0  369 -22872.783 -10440.198  54.4%     -   38s
     0     0 -10440.198    0  452 -22872.783 -10440.198  54.4%     -   38s
     0     0 -10440.198    0  457 -22872.783 -10440.198  54.4%     -   39s
     0     0 -10440.198    0  461 -22872.783 -10440.198  54.4%     -   39s
     0     0 -10440.198    0  461 -22872.783 -10440.198  54.4%     -   39s
     0     0 -10465.727    0  543 -22872.783 -10465.727  54.2%     -   46s
     0     0 -10630.285    0  534 -22872.783 -10630.285  53.5%     -   48s
H    0     0                    -22783.13154 -10788.107  52.6%     -   52s
H    0     0                    -22767.26006 -10788.107  52.6%     -   52s
H    0     0                    -22755.50202 -10788.107  52.6%     -   52s
     0     0 -10788.107    0  541 -22755.502 -10788.107  52.6%     -   52s
     0     0 -10814.338    0  539 -22755.502 -10814.338  52.5%     -   52s
     0     0 -10840.622    0  546 -22755.502 -10840.622  52.4%     -   53s
     0     0 -10851.856    0  544 -22755.502 -10851.856  52.3%     -   54s
     0     0 -10861.630    0  541 -22755.502 -10861.630  52.3%     -   54s
     0     0 -10863.341    0  543 -22755.502 -10863.341  52.3%     -   54s
     0     0 -10863.407    0  542 -22755.502 -10863.407  52.3%     -   54s
     0     0 -11665.263    0  505 -22755.502 -11665.263  48.7%     -   63s
     0     0 -12095.941    0  525 -22755.502 -12095.941  46.8%     -   69s
     0     0 -12224.901    0  548 -22755.502 -12224.901  46.3%     -   71s
     0     0 -12358.845    0  542 -22755.502 -12358.845  45.7%     -   75s
     0     0 -12396.213    0  555 -22755.502 -12396.213  45.5%     -   77s
     0     0 -12403.363    0  556 -22755.502 -12403.363  45.5%     -   78s
     0     0 -12413.743    0  556 -22755.502 -12413.743  45.4%     -   78s
     0     0 -12418.191    0  547 -22755.502 -12418.191  45.4%     -   78s
     0     0 -12424.770    0  546 -22755.502 -12424.770  45.4%     -   79s
     0     0 -12436.926    0  554 -22755.502 -12436.926  45.3%     -   79s
     0     0 -12437.632    0  549 -22755.502 -12437.632  45.3%     -   79s
     0     0 -12704.789    0  570 -22755.502 -12704.789  44.2%     -   87s
     0     0 -12776.652    0  563 -22755.502 -12776.652  43.9%     -   89s
     0     0 -12803.296    0  568 -22755.502 -12803.296  43.7%     -   91s
     0     0 -12808.732    0  573 -22755.502 -12808.732  43.7%     -   91s
     0     0 -12811.429    0  573 -22755.502 -12811.429  43.7%     -   92s
     0     0 -12814.181    0  574 -22755.502 -12814.181  43.7%     -   92s
     0     0 -12814.994    0  576 -22755.502 -12814.994  43.7%     -   92s
     0     0 -12856.439    0  570 -22755.502 -12856.439  43.5%     -   94s
     0     0 -12860.986    0  587 -22755.502 -12860.986  43.5%     -   95s
     0     0 -12863.446    0  578 -22755.502 -12863.446  43.5%     -   95s
     0     0 -12864.059    0  583 -22755.502 -12864.059  43.5%     -   96s
     0     0 -12900.116    0  581 -22755.502 -12900.116  43.3%     -   98s
     0     0 -12924.848    0  587 -22755.502 -12924.848  43.2%     -  101s
     0     0 -12928.328    0  586 -22755.502 -12928.328  43.2%     -  101s
     0     0 -12929.662    0  592 -22755.502 -12929.662  43.2%     -  102s
     0     0 -12930.683    0  598 -22755.502 -12930.683  43.2%     -  102s
     0     0 -12941.704    0  606 -22755.502 -12941.704  43.1%     -  103s
     0     0 -12944.411    0  601 -22755.502 -12944.411  43.1%     -  104s
     0     0 -12944.464    0  606 -22755.502 -12944.464  43.1%     -  104s
     0     0 -12952.109    0  612 -22755.502 -12952.109  43.1%     -  105s
     0     0 -12952.706    0  617 -22755.502 -12952.706  43.1%     -  111s
     0     0 -12965.312    0  619 -22755.502 -12965.312  43.0%     -  112s
     0     0 -12965.649    0  620 -22755.502 -12965.649  43.0%     -  113s
     0     0 -12980.868    0  596 -22755.502 -12980.868  43.0%     -  114s
     0     0 -12989.410    0  607 -22755.502 -12989.410  42.9%     -  115s
     0     0 -12992.353    0  608 -22755.502 -12992.353  42.9%     -  115s
     0     0 -12992.630    0  609 -22755.502 -12992.630  42.9%     -  116s
     0     0 -13016.404    0  618 -22755.502 -13016.404  42.8%     -  118s
     0     0 -13020.419    0  614 -22755.502 -13020.419  42.8%     -  119s
     0     0 -13020.538    0  613 -22755.502 -13020.538  42.8%     -  119s
     0     0 -13049.536    0  622 -22755.502 -13049.536  42.7%     -  121s
     0     0 -13051.099    0  625 -22755.502 -13051.099  42.6%     -  122s
     0     0 -13051.794    0  624 -22755.502 -13051.794  42.6%     -  122s
     0     0 -13058.820    0  631 -22755.502 -13058.820  42.6%     -  123s
     0     0 -13059.299    0  627 -22755.502 -13059.299  42.6%     -  123s
     0     0 -13060.701    0  628 -22755.502 -13060.701  42.6%     -  124s
     0     0 -13061.344    0  633 -22755.502 -13061.344  42.6%     -  125s
     0     0 -13065.897    0  628 -22755.502 -13065.897  42.6%     -  126s
     0     0 -13065.940    0  628 -22755.502 -13065.940  42.6%     -  127s
     0     2 -13066.069    0  628 -22755.502 -13066.069  42.6%     -  148s
     1     4 -13186.785    1  590 -22755.502 -13066.069  42.6%  1692  153s
     3     8 -13380.378    2  579 -22755.502 -13188.795  42.0%  2679  156s
     7    16 -13479.356    3  635 -22755.502 -13380.520  41.2%  2575  160s
    15    32 -13668.939    4  637 -22755.502 -13401.943  41.1%  2893  165s
    31    64 -13820.154    5  598 -22755.502 -13578.982  40.3%  3070  175s
    95   184 -14058.002    7  605 -22755.502 -13667.952  39.9%  2863  184s
   189   238 -16191.339    8  519 -22755.502 -13667.952  39.9%  1986  191s
   265   264 -14277.515    8  577 -22755.502 -13667.952  39.9%  1941  197s
   303   293 -14647.472    9  585 -22755.502 -13820.359  39.3%  2124  205s
   338   316 -15482.124   10  574 -22755.502 -14051.323  38.3%  2168  210s
   381   348 -16311.828   10  457 -22755.502 -14051.323  38.3%  2212  216s
   430   377 -15988.511   11  622 -22755.502 -14051.323  38.3%  2317  223s
   475   413 -17532.191   11  550 -22755.502 -14051.323  38.3%  2468  232s
   529   444 -17197.336   12  615 -22755.502 -14051.323  38.3%  2599  242s
   586   493 -17201.123   12  612 -22755.502 -14051.323  38.3%  2681  248s
   649   534 -18103.701   13  414 -22755.502 -14051.323  38.3%  2572  256s
   705   570 -18510.350   13  625 -22755.502 -14286.829  37.2%  2490  266s
   771   592 -18994.056   14  513 -22755.502 -14307.562  37.1%  2419  275s
   813   619 -20060.865   14  222 -22755.502 -14307.562  37.1%  2358  281s
   850   643 -20262.495   15  465 -22755.502 -14458.604  36.5%  2335  288s
   888   679 -20355.897   16  467 -22755.502 -14458.604  36.5%  2302  292s
   936   707 -20422.150   18  365 -22755.502 -14458.604  36.5%  2248  298s
   996   735 -20817.262   23  487 -22755.502 -14458.604  36.5%  2184  306s
  1048   786 infeasible   23      -22755.502 -14458.604  36.5%  2153  313s
  1129   835 -21062.212   26  409 -22755.502 -14458.604  36.5%  2082  322s
  1218   867     cutoff   30      -22755.502 -14458.604  36.5%  1993  332s
  1330   931 -21842.673   35  268 -22755.502 -14999.420  34.1%  1883  342s
  1461   999 -22325.906   43  327 -22755.502 -14999.420  34.1%  1785  349s
  1596  1033     cutoff   49      -22755.502 -15402.317  32.3%  1709  357s
  1699  1052 -18131.441    8  225 -22755.502 -15402.317  32.3%  1661  366s
  1798  1081 -20657.166   12  281 -22755.502 -15411.347  32.3%  1644  375s
  1897  1128 -22004.852   13  270 -22755.502 -15729.339  30.9%  1635  382s
  1986  1172     cutoff   15      -22755.502 -15791.996  30.6%  1629  392s
  2083  1244 -17042.213    9  472 -22755.502 -15791.996  30.6%  1627  401s
  2220  1308 -18128.447   10  444 -22755.502 -15880.379  30.2%  1597  411s
  2391  1351 -18344.521   12  341 -22755.502 -15880.379  30.2%  1549  420s
  2554  1418     cutoff   17      -22755.502 -15892.113  30.2%  1519  432s
  2729  1490 -21163.351   23  232 -22755.502 -15948.812  29.9%  1484  441s
  2869  1556 -21925.222   30  293 -22755.502 -16093.386  29.3%  1458  450s
  3065  1645 -19205.567    8  183 -22755.502 -16093.386  29.3%  1419  459s
  3262  1716 -18664.617   12  431 -22755.502 -16093.386  29.3%  1397  469s
  3478  1784 -20271.740   15  387 -22755.502 -16368.150  28.1%  1376  480s
  3714  1834 -21198.528   18  185 -22755.502 -16481.870  27.6%  1355  490s
  3943  1883 -21997.661   23  184 -22755.502 -16499.720  27.5%  1339  500s
  4130  1923 -22351.689   30  267 -22755.502 -16499.720  27.5%  1326  513s
  4375  1999 -18786.323   12  159 -22755.502 -16499.720  27.5%  1307  525s
  4641  2083 -21665.190   18  226 -22755.502 -16614.284  27.0%  1288  537s
  4913  2135 -20034.287   14  190 -22755.502 -16674.803  26.7%  1275  551s
  5159  2160 -21712.900   20  204 -22755.502 -16674.803  26.7%  1270  565s
  5325  2235 -21819.915    8  227 -22755.502 -16883.421  25.8%  1269  577s
  5626  2283     cutoff   13      -22755.502 -17167.883  24.6%  1253  589s
  5876  2355 -20387.737    8  316 -22755.502 -17289.621  24.0%  1255  605s
  6151  2399 infeasible   11      -22755.502 -17378.428  23.6%  1255  621s
  6555  2485 -21262.838   13  592 -22755.502 -17448.467  23.3%  1236  638s
  6833  2486 -21341.609   10  628 -22755.502 -17611.232  22.6%  1236  675s
  6835  2487 -18567.171    9  364 -22755.502 -17611.232  22.6%  1236  698s
  6836  2488 -21431.491   15  580 -22755.502 -17611.232  22.6%  1236  714s
  6837  2489 -20867.781   13  543 -22755.502 -17611.232  22.6%  1235  722s
  6838  2489 -21629.790   17  634 -22755.502 -17611.232  22.6%  1235  730s
  6840  2491 -19187.312   14  606 -22755.502 -17611.232  22.6%  1235  736s
  6841  2491 -21448.558   25  617 -22755.502 -17611.232  22.6%  1235  740s
  6842  2492 -20232.829   18  590 -22755.502 -17611.232  22.6%  1234  748s
  6843  2493 -22047.845   25  588 -22755.502 -17611.232  22.6%  1234  751s
  6845  2494 -22387.729   11  608 -22755.502 -17611.232  22.6%  1234  760s
  6847  2495 -21939.760   13  653 -22755.502 -17611.232  22.6%  1234  769s
  6848  2496 -19676.025   13  603 -22755.502 -17611.232  22.6%  1233  772s
  6849  2497 -19272.837   10  620 -22755.502 -17611.232  22.6%  1233  776s
  6850  2497 -21968.409   26  620 -22755.502 -17611.232  22.6%  1233  805s
  6851  2498 -17717.145   10  620 -22755.502 -17611.232  22.6%  1233  819s
  6852  2502 -17611.232   11  662 -22755.502 -17611.232  22.6%  1248  829s
  6854  2505 -17611.232   12  670 -22755.502 -17611.232  22.6%  1248  839s
  6858  2512 -17611.232   13  668 -22755.502 -17611.232  22.6%  1249  850s
  6866  2525 -17611.232   14  666 -22755.502 -17611.232  22.6%  1254  863s
  6882  2537 -18113.493   15  348 -22755.502 -17611.232  22.6%  1264  880s
  6899  2559 -17776.378   16  362 -22755.502 -17611.232  22.6%  1284  887s
  6931  2633 -17830.060   17  350 -22755.502 -17611.232  22.6%  1290  898s
  7031  2633 -19015.637   21  335 -22755.502 -17611.232  22.6%  1306  909s
  7126  2621 -19785.346   24  329 -22755.502 -17611.232  22.6%  1307  921s
  7170  2627 -21415.457   24  246 -22755.502 -17611.232  22.6%  1313  931s
  7220  2636 -19826.996   25  334 -22755.502 -17611.232  22.6%  1331  939s
  7259  2643     cutoff   23      -22755.502 -17611.232  22.6%  1337  946s
  7300  2651 -20825.818   26  302 -22755.502 -17611.232  22.6%  1339  954s
  7348  2652     cutoff   26      -22755.502 -17611.232  22.6%  1342  961s
  7401  2645 -22200.595   31  281 -22755.502 -17611.232  22.6%  1343  973s
  7459  2646     cutoff   35      -22755.502 -17611.232  22.6%  1346  983s
  7511  2651 -17611.232   19  315 -22755.502 -17611.232  22.6%  1350  988s
  7566  2653 -17627.537   20  331 -22755.502 -17611.232  22.6%  1352  996s
  7620  2666 -17857.673   21  324 -22755.502 -17611.232  22.6%  1355 1006s
  7680  2674     cutoff   23      -22755.502 -17611.232  22.6%  1356 1013s
  7736  2676 -19568.543   23  257 -22755.502 -17611.232  22.6%  1358 1024s
  7797  2681 -19696.863   24  285 -22755.502 -17611.232  22.6%  1364 1034s
  7863  2681     cutoff   25      -22755.502 -17611.232  22.6%  1369 1043s
  7918  2680 -19799.178   25  143 -22755.502 -17611.232  22.6%  1371 1055s
  7971  2692 -20417.857   27  468 -22755.502 -17611.232  22.6%  1377 1065s
  8038  2707 -20502.194   29  463 -22755.502 -17611.232  22.6%  1389 1076s
  8095  2726 -20664.890   31  315 -22755.502 -17611.232  22.6%  1395 1085s
  8175  2729 -21313.920   35  312 -22755.502 -17611.232  22.6%  1400 1096s
  8261  2714     cutoff   38      -22755.502 -17611.232  22.6%  1406 1109s
  8368  2685 -21064.071   20  348 -22755.502 -17611.232  22.6%  1410 1120s
  8432  2692 -21961.924   21  315 -22755.502 -17611.232  22.6%  1416 1132s
  8535  2690     cutoff   23      -22755.502 -17611.232  22.6%  1421 1144s
  8648  2687 -22321.179   21  198 -22755.502 -17611.232  22.6%  1426 1157s
  8793  2646 -18999.275   18  514 -22755.502 -17611.232  22.6%  1427 1169s
  8950  2621 -20082.161   20  432 -22755.502 -17611.232  22.6%  1427 1183s
  9064  2607 -20166.286   21  426 -22755.502 -17611.232  22.6%  1427 1195s
  9196  2624     cutoff   24      -22755.502 -17690.179  22.3%  1432 1207s
  9337  2621     cutoff   30      -22755.502 -17795.788  21.8%  1434 1221s
  9489  2578 -21776.710   22  327 -22755.502 -17827.186  21.7%  1438 1237s
  9669  2563 -19419.057   18  367 -22755.502 -17895.156  21.4%  1438 1250s
  9794  2579 -20687.394   20  310 -22755.502 -17895.156  21.4%  1446 1262s
  9969  2548 -22389.503   23  404 -22755.502 -17895.156  21.4%  1448 1275s
 10131  2528 -22706.184   24  422 -22755.502 -18319.692  19.5%  1449 1293s
 10347  2536 -20202.976   19  337 -22755.502 -18395.767  19.2%  1448 1307s
 10573  2509 -22284.868   22  305 -22755.502 -18395.767  19.2%  1447 1324s
 10827  2422     cutoff   32      -22755.502 -18831.348  17.2%  1444 1336s
 10889  2405 -21946.327   23  393 -22755.502 -19065.127  16.2%  1445 1351s
 10967  2372 -22467.134   24  306 -22755.502 -19107.257  16.0%  1445 1371s
 11034  2362     cutoff   25      -22755.502 -19110.577  16.0%  1448 1385s
 11145  2361 -21087.880   25  386 -22755.502 -19110.577  16.0%  1447 1400s
 11299  2306 -22646.368   33  169 -22755.502 -19110.577  16.0%  1444 1417s
 11499  2241     cutoff   22      -22755.502 -19396.098  14.8%  1443 1434s
 11810  2158 -21980.713   20  500 -22755.502 -19479.744  14.4%  1436 1452s
 12144  1943     cutoff   23      -22755.502 -19519.746  14.2%  1431 1471s
 12490  1759 -22052.608   20  346 -22755.502 -19761.107  13.2%  1430 1493s
 12913  1517 -21159.049   26  490 -22755.502 -20058.914  11.9%  1422 1516s
 13404  1268 -22017.912   20  435 -22755.502 -20324.085  10.7%  1408 1534s
 13558  1121     cutoff   21      -22755.502 -20454.823  10.1%  1403 1552s
 13927   489 -22205.588   36  160 -22755.502 -20511.936  9.86%  1388 1572s
 14829     8 -22231.083   27  280 -22755.502 -21267.597  6.54%  1337 1586s

Cutting planes:
  Gomory: 1
  MIR: 398
  Flow cover: 1099
  Zero half: 19
  RLT: 21
  Relax-and-lift: 26

Explored 15336 nodes (20156180 simplex iterations) in 1588.26 seconds (3036.45 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -22755.5 -22767.3 -22783.1 ... -23559.5
No other solutions better than -22755.5

Optimal solution found (tolerance 1.00e-04)
Best objective -2.275550201905e+04, best bound -2.275550201905e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 1588.30s
  Master Objective (UB) = -22755.50, θ = 101597.38
  Upper Bound (UB) = -22755.50

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 101597.38
  [DEBUG]   ✓ Scenario 0: θ = 101597.38 ≤ Q = 101597.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 101597.38 ≤ Q = 101597.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 101597.38 ≤ Q = 101597.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 101597.38 ≤ Q = 101597.38 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x25ea2ea0
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x25ea2ea0
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [5e-01, 2e+02]
Found heuristic solution: objective 1.238187e+13
Presolve removed 2553 rows and 1846 columns
Presolve time: 0.01s
Presolved: 540 rows, 543 columns, 1523 nonzeros
Found heuristic solution: objective 6745196.5406
Variable types: 367 continuous, 176 integer (176 binary)

Root relaxation: objective -1.320638e+05, 265 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -132063.82    0  135 6745196.54 -132063.82   102%     -    0s
H    0     0                    -92654.72965 -132063.82  42.5%     -    0s
H    0     0                    -93192.49730 -132063.82  41.7%     -    0s
H    0     0                    -101452.6326 -110295.10  8.72%     -    0s
H    0     0                    -104641.3519 -110295.10  5.40%     -    0s
     0     0 -110295.10    0   39 -104641.35 -110295.10  5.40%     -    0s
H    0     0                    -109841.7329 -110285.94  0.40%     -    0s
     0     0 -110234.26    0   29 -109841.73 -110234.26  0.36%     -    0s
     0     0 -110225.98    0   20 -109841.73 -110225.98  0.35%     -    0s
     0     0 -110219.47    0   19 -109841.73 -110219.47  0.34%     -    0s
     0     0 -110187.49    0   25 -109841.73 -110187.49  0.31%     -    0s
     0     0 -110185.12    0   22 -109841.73 -110185.12  0.31%     -    0s
     0     0 -110178.74    0   22 -109841.73 -110178.74  0.31%     -    0s
     0     0 -110173.66    0   21 -109841.73 -110173.66  0.30%     -    0s
     0     0 -110129.42    0    4 -109841.73 -110129.42  0.26%     -    0s
     0     0 -110129.42    0   18 -109841.73 -110129.42  0.26%     -    0s
H    0     0                    -109845.1967 -110129.42  0.26%     -    0s
H    0     0                    -109960.5719 -110129.42  0.15%     -    0s
     0     0 -110129.42    0    4 -109960.57 -110129.42  0.15%     -    0s
H    0     0                    -110124.1392 -110124.22  0.00%     -    0s

Cutting planes:
  Gomory: 6
  Implied bound: 1
  MIR: 8
  Flow cover: 9

Explored 1 nodes (655 simplex iterations) in 0.11 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -110124 -109961 -109845 ... 6.7452e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.101241392300e+05, best bound -1.101242164794e+05, gap 0.0001%
  Subproblem solved in 0.14s
  Worst-case operational profit (Z_SP) = 82904.61
  Scenario: 13 demand increases, 47 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -110124.14
  [DEBUG]   S×d_nominal = 193028.75
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 193028.75 + -110124.14 = 82904.61
  [DEBUG]   Current θ from Master = 101597.38
  [DEBUG]   ⚠️  Z_SP ≤ θ by 18692.77 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -41448.27
  Lower Bound (LB) = -24370.17
  Gap (UB-LB) = 1614.6726, Absolute Gap = 1614.6726, Relative Gap = 0.070957
  Not converged yet (gap = 1614.67 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 13 increases, 47 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221794 nonzeros
Model fingerprint: 0x4a503356
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 31370 rows and 12740 columns
Presolve time: 1.41s
Presolved: 46463 rows, 20720 columns, 288289 nonzeros
Variable types: 18461 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -362049.1746
Found heuristic solution: objective -192025.5558

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 46463 rows, 20720 columns, 288289 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   24687   -4.3023279e+04   0.000000e+00   3.720432e+06      5s
   33340   -1.9540402e+04   0.000000e+00   5.532156e+06     10s
   40542   -1.0967991e+04   0.000000e+00   2.747803e+06     15s
   46601   -7.1148714e+03   0.000000e+00   2.397613e+06     20s
   52912   -5.6567874e+03   0.000000e+00   9.202728e+04     25s
   58590   -5.5494287e+03   0.000000e+00   2.129386e+05     30s
   64788   -4.9422755e+03   0.000000e+00   1.537480e+06     35s
Concurrent spin time: 3.31s

Solved with dual simplex

Root relaxation: objective -4.869241e+03, 50947 iterations, 38.69 seconds (52.27 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -4869.2410    0  366 -192025.56 -4869.2410  97.5%     -   40s
H    0     0                    -180121.9676 -4869.2410  97.3%     -   40s
H    0     0                    -115384.5485 -4869.2410  95.8%     -   40s
H    0     0                    -61772.44950 -4869.2410  92.1%     -   40s
H    0     0                    -48591.31419 -4869.2410  90.0%     -   41s
H    0     0                    -48583.41263 -4869.2410  90.0%     -   41s
H    0     0                    -33794.81660 -4869.2410  85.6%     -   41s
H    0     0                    -24254.38654 -4869.2410  79.9%     -   41s
H    0     0                    -23550.79425 -4869.2410  79.3%     -   41s
H    0     0                    -23540.17760 -4869.2410  79.3%     -   42s
     0     0 -7381.6589    0  396 -23540.178 -7381.6589  68.6%     -   52s
H    0     0                    -23535.64573 -7381.6589  68.6%     -   53s
     0     0 -7576.7277    0  460 -23535.646 -7576.7277  67.8%     -   57s
     0     0 -7626.9880    0  460 -23535.646 -7626.9880  67.6%     -   59s
     0     0 -7626.9880    0  459 -23535.646 -7626.9880  67.6%     -   62s
     0     0 -7627.4259    0  473 -23535.646 -7627.4259  67.6%     -   64s
     0     0 -7627.8165    0  474 -23535.646 -7627.8165  67.6%     -   64s
     0     0 -7627.8165    0  474 -23535.646 -7627.8165  67.6%     -   64s
     0     0 -10256.840    0  556 -23535.646 -10256.840  56.4%     -   76s
H    0     0                    -23531.94018 -10257.836  56.4%     -   77s
     0     0 -10567.136    0  548 -23531.940 -10567.136  55.1%     -   81s
     0     0 -10582.976    0  551 -23531.940 -10582.976  55.0%     -   82s
     0     0 -10641.058    0  552 -23531.940 -10641.058  54.8%     -   85s
     0     0 -10667.084    0  555 -23531.940 -10667.084  54.7%     -   86s
     0     0 -10667.549    0  557 -23531.940 -10667.549  54.7%     -   87s
     0     0 -11809.100    0  541 -23531.940 -11809.100  49.8%     -  100s
     0     0 -11968.350    0  522 -23531.940 -11968.350  49.1%     -  103s
     0     0 -12065.732    0  524 -23531.940 -12065.732  48.7%     -  105s
     0     0 -12081.147    0  532 -23531.940 -12081.147  48.7%     -  106s
     0     0 -12093.835    0  524 -23531.940 -12093.835  48.6%     -  107s
     0     0 -12107.242    0  533 -23531.940 -12107.242  48.5%     -  107s
     0     0 -12111.551    0  529 -23531.940 -12111.551  48.5%     -  108s
     0     0 -12112.518    0  530 -23531.940 -12112.518  48.5%     -  108s
H    0     0                    -23528.30460 -12112.764  48.5%     -  109s
     0     0 -12112.764    0  529 -23528.305 -12112.764  48.5%     -  109s
     0     0 -12315.599    0  548 -23528.305 -12315.599  47.7%     -  117s
H    0     0                    -23523.77273 -12315.959  47.6%     -  117s
     0     0 -12484.246    0  564 -23523.773 -12484.246  46.9%     -  124s
     0     0 -12566.719    0  574 -23523.773 -12566.719  46.6%     -  129s
     0     0 -12608.171    0  557 -23523.773 -12608.171  46.4%     -  130s
     0     0 -12617.689    0  572 -23523.773 -12617.689  46.4%     -  131s
     0     0 -12619.489    0  582 -23523.773 -12619.489  46.4%     -  131s
     0     0 -12620.313    0  574 -23523.773 -12620.313  46.4%     -  132s
     0     0 -12673.996    0  572 -23523.773 -12673.996  46.1%     -  135s
     0     0 -12690.835    0  572 -23523.773 -12690.835  46.1%     -  136s
     0     0 -12703.219    0  578 -23523.773 -12703.219  46.0%     -  137s
     0     0 -12705.422    0  578 -23523.773 -12705.422  46.0%     -  138s
     0     0 -12708.464    0  582 -23523.773 -12708.464  46.0%     -  139s
     0     0 -12708.669    0  582 -23523.773 -12708.669  46.0%     -  139s
     0     0 -12752.981    0  576 -23523.773 -12752.981  45.8%     -  142s
     0     0 -12757.503    0  576 -23523.773 -12757.503  45.8%     -  144s
     0     0 -12758.060    0  581 -23523.773 -12758.060  45.8%     -  145s
     0     0 -12781.444    0  584 -23523.773 -12781.444  45.7%     -  148s
     0     0 -12785.065    0  589 -23523.773 -12785.065  45.7%     -  149s
     0     0 -12786.584    0  589 -23523.773 -12786.584  45.6%     -  150s
     0     0 -12789.646    0  596 -23523.773 -12789.646  45.6%     -  150s
     0     0 -12791.508    0  592 -23523.773 -12791.508  45.6%     -  151s
     0     0 -12791.670    0  592 -23523.773 -12791.670  45.6%     -  151s
     0     0 -12811.035    0  593 -23523.773 -12811.035  45.5%     -  153s
H    0     0                    -23510.26582 -12811.131  45.5%     -  154s
     0     0 -12814.971    0  592 -23510.266 -12814.971  45.5%     -  155s
     0     0 -12815.498    0  585 -23510.266 -12815.498  45.5%     -  155s
     0     0 -12826.543    0  594 -23510.266 -12826.543  45.4%     -  157s
     0     0 -12828.462    0  594 -23510.266 -12828.462  45.4%     -  158s
     0     0 -12829.636    0  602 -23510.266 -12829.636  45.4%     -  158s
     0     0 -12830.419    0  604 -23510.266 -12830.419  45.4%     -  159s
     0     0 -12834.830    0  601 -23510.266 -12834.830  45.4%     -  161s
     0     0 -12836.648    0  605 -23510.266 -12836.648  45.4%     -  162s
     0     0 -12837.909    0  604 -23510.266 -12837.909  45.4%     -  162s
     0     0 -12838.072    0  605 -23510.266 -12838.072  45.4%     -  162s
     0     0 -12843.476    0  610 -23510.266 -12843.476  45.4%     -  164s
     0     0 -12844.213    0  615 -23510.266 -12844.213  45.4%     -  165s
     0     0 -12847.703    0  607 -23510.266 -12847.703  45.4%     -  167s
     0     0 -12847.865    0  607 -23510.266 -12847.865  45.4%     -  169s
     0     2 -12847.906    0  607 -23510.266 -12847.906  45.4%     -  211s
     1     4 -12968.878    1  580 -23510.266 -12847.910  45.4%  4131  216s
     3     8 -13046.911    2  586 -23510.266 -12969.536  44.8%  3275  223s
     7    16 -13147.084    3  585 -23510.266 -13047.801  44.5%  3559  229s
    15    32 -13207.698    4  580 -23510.266 -13147.294  44.1%  3233  241s
    31    64 -13244.219    5  581 -23510.266 -13208.126  43.8%  5096  251s
    63    96 -13265.234    6  581 -23510.266 -13244.404  43.7%  4192  259s
    95   209 -13294.109    7  579 -23510.266 -13244.404  43.7%  3259  271s
   210   251 -13342.861    8  580 -23510.266 -13244.404  43.7%  2064  280s
   260   290 -13469.505    9  587 -23510.266 -13244.404  43.7%  1854  287s
   313   333 -14156.777   10  658 -23510.266 -13244.404  43.7%  1762  295s
   372   374 -13656.745   10  578 -23510.266 -13244.404  43.7%  1627  303s
   424   410 -14632.421   11  581 -23510.266 -13244.404  43.7%  1651  313s
   483   438 -13822.731   11  586 -23510.266 -13244.404  43.7%  1667  323s
   538   472 -15343.735   11  495 -23510.266 -13244.404  43.7%  1707  334s
   586   504 -15514.546   13  640 -23510.266 -13244.404  43.7%  1781  344s
   634   548 -15958.190   12  581 -23510.266 -13244.404  43.7%  1904  354s
   696   596 -16701.758   13  468 -23510.266 -13294.752  43.5%  1933  362s
   747   645 -16732.913   14  473 -23510.266 -13294.752  43.5%  1917  371s
   808   670 -17117.789   15  478 -23510.266 -13294.752  43.5%  1890  378s
   855   710 -18369.570   15  469 -23510.266 -13294.752  43.5%  1854  387s
   926   767 -17266.347   16  468 -23510.266 -13471.916  42.7%  1815  396s
  1011   805 -18008.839   18  368 -23510.266 -13471.916  42.7%  1765  402s
  1065   863 -18249.077   19  365 -23510.266 -13541.382  42.4%  1745  412s
  1147   927 -19841.417   20  348 -23510.266 -13857.917  41.1%  1723  422s
  1235   987 -21146.214   21  360 -23510.266 -13857.917  41.1%  1692  430s
  1331  1051 -21374.217   21  281 -23510.266 -13857.917  41.1%  1664  439s
  1432  1131 -22739.375   23  222 -23510.266 -13857.917  41.1%  1646  450s
  1552  1207     cutoff   26      -23510.266 -13857.917  41.1%  1608  462s
  1686  1282 -18157.186    8  198 -23510.266 -13857.917  41.1%  1575  473s
  1814  1344 -23447.328   15   53 -23510.266 -13857.917  41.1%  1549  486s
  1925  1400 -15181.732   13  562 -23510.266 -13857.917  41.1%  1547  498s
  2025  1457 -16536.829   15  466 -23510.266 -14133.226  39.9%  1565  510s
  2140  1498 -16855.700   16  527 -23510.266 -14133.226  39.9%  1561  523s
  2241  1516 -16101.971   14  562 -23510.266 -14133.226  39.9%  1554  533s
  2289  1572 -17032.486   17  466 -23510.266 -14133.226  39.9%  1556  543s
  2377  1621 -17652.536   18  532 -23510.266 -14133.226  39.9%  1549  557s
  2486  1708 -19179.081   18  231 -23510.266 -14133.226  39.9%  1540  570s
  2637  1814 -17834.931   19  517 -23510.266 -14133.226  39.9%  1523  585s
  2815  1841 -20353.242   20  259 -23510.266 -14133.226  39.9%  1506  594s
  2852  1867 -20399.199   21  263 -23510.266 -14567.900  38.0%  1511  603s
  2920  1905 -20958.652   24  184 -23510.266 -14567.900  38.0%  1509  613s
  2974  1943 -21270.966   29  156 -23510.266 -14567.900  38.0%  1505  623s
  3050  1989 -22207.215   33  184 -23510.266 -14663.769  37.6%  1494  635s
  3136  2061 -22661.766   41  174 -23510.266 -14792.943  37.1%  1485  650s
  3325  2155     cutoff   51      -23510.266 -14792.943  37.1%  1445  663s
  3533  2267 -18682.720   15  485 -23510.266 -14887.149  36.7%  1422  678s
  3814  2335     cutoff   17      -23510.266 -15072.837  35.9%  1392  695s
  4040  2410 -21723.802   17  461 -23510.266 -15072.837  35.9%  1392  715s
  4276  2457 -22335.677   19  468 -23510.266 -15072.837  35.9%  1385  732s
  4439  2541 -22573.424   20  462 -23510.266 -15165.194  35.5%  1393  753s
  4643  2621 -19849.656   17  421 -23510.266 -15203.056  35.3%  1407  773s
  4913  2725 -22775.309   22  288 -23510.266 -15203.056  35.3%  1402  793s
  5184  2814 -19667.996   12   99 -23510.266 -15493.540  34.1%  1401  815s
  5473  2907 -19232.606    9  516 -23510.266 -15599.942  33.6%  1398  833s
  5651  2908 -16551.502    9  607 -23510.266 -15672.273  33.3%  1405  887s
  5653  2909 -20189.817   24  366 -23510.266 -15672.273  33.3%  1405  919s
  5654  2910 -18396.395   15  556 -23510.266 -15672.273  33.3%  1405  940s
  5655  2911 -17443.867   16  556 -23510.266 -15672.273  33.3%  1404  951s
  5656  2911 -20079.228   24  629 -23510.266 -15672.273  33.3%  1404  963s
  5657  2912 -22833.968   34  573 -23510.266 -15672.273  33.3%  1404  970s
  5659  2913 -19273.821   16  565 -23510.266 -15672.273  33.3%  1403  975s
  5661  2915 -22924.920   45  580 -23510.266 -15672.273  33.3%  1403  981s
  5662  2915 -21127.601   21  598 -23510.266 -15672.273  33.3%  1403  989s
  5663  2916 -22833.311   21  604 -23510.266 -15672.273  33.3%  1402  993s
  5664  2917 -22259.307   17  607 -23510.266 -15672.273  33.3%  1402  995s
  5666  2918 -22090.146   32  648 -23510.266 -15672.273  33.3%  1402 1009s
  5667  2919 -22726.190   19  666 -23510.266 -15672.273  33.3%  1401 1012s
  5669  2920 -19061.637   19  636 -23510.266 -15672.273  33.3%  1401 1018s
  5670  2921 -17545.440   13  654 -23510.266 -15672.273  33.3%  1401 1025s
  5672  2922 -20795.835   29  683 -23510.266 -15672.273  33.3%  1400 1032s
  5673  2923 -17906.819   15  619 -23510.266 -15672.273  33.3%  1400 1039s
  5674  2923 -16102.381   15  684 -23510.266 -15672.273  33.3%  1400 1044s
  5675  2924 -16956.533   13  679 -23510.266 -15672.273  33.3%  1399 1052s
  5676  2925 -23038.537   49  632 -23510.266 -15672.273  33.3%  1399 1056s
  5677  2925 -18488.941   14  627 -23510.266 -15672.273  33.3%  1399 1061s
  5678  2926 -19288.804   20  627 -23510.266 -15672.273  33.3%  1399 1098s
  5679  2927 -18930.966   15  627 -23510.266 -15672.273  33.3%  1398 1118s
  5680  2930 -15672.273   12  616 -23510.266 -15672.273  33.3%  1422 1130s
  5682  2934 -15672.273   13  620 -23510.266 -15672.273  33.3%  1423 1146s
  5686  2940 -15672.273   14  619 -23510.266 -15672.273  33.3%  1427 1158s
  5694  2952 -15672.273   15  603 -23510.266 -15672.273  33.3%  1431 1180s
  5710  2962 -20770.009   16  157 -23510.266 -15672.273  33.3%  1455 1203s
  5728  2981 -17187.895   17  443 -23510.266 -15672.273  33.3%  1479 1215s
  5760  3001 -18098.894   18  310 -23510.266 -15672.273  33.3%  1499 1233s
  5808  3033 -18584.411   19  383 -23510.266 -15672.273  33.3%  1508 1249s
  5893  3025 -19904.435   22  295 -23510.266 -15672.273  33.3%  1508 1262s
  5959  3031 -21393.866   24  179 -23510.266 -15672.273  33.3%  1512 1282s
  6037  3037 -22980.875   27  161 -23510.266 -15672.273  33.3%  1518 1293s
  6115  3031     cutoff   28      -23510.266 -15672.273  33.3%  1521 1312s
  6202  3021 -15672.273   17  567 -23510.266 -15672.273  33.3%  1522 1327s
  6243  3033 -15672.273   17  616 -23510.266 -15672.273  33.3%  1529 1339s
  6286  3040 -15672.273   18  591 -23510.266 -15672.273  33.3%  1538 1351s
  6323  3048 -17114.573   18  374 -23510.266 -15672.273  33.3%  1541 1369s
  6374  3056 -15672.273   18  643 -23510.266 -15672.273  33.3%  1545 1385s
  6437  3059 -15847.678   19  693 -23510.266 -15672.273  33.3%  1550 1398s
  6490  3067 -18737.359   19  452 -23510.266 -15672.273  33.3%  1558 1414s
  6541  3075 -22135.272   26  398 -23510.266 -15672.273  33.3%  1562 1429s
  6611  3088 -17643.228   19  635 -23510.266 -15672.273  33.3%  1568 1449s
  6682  3099 -16890.255   19  598 -23510.266 -15672.273  33.3%  1575 1465s
  6754  3110 -18682.884   20  559 -23510.266 -15672.273  33.3%  1582 1479s
  6838  3105 -20096.021   21  534 -23510.266 -15672.273  33.3%  1588 1494s
  6932  3110 -20607.454   22  472 -23510.266 -15672.273  33.3%  1593 1508s
  7036  3107 -20768.700   23  466 -23510.266 -15672.273  33.3%  1593 1524s
  7140  3102 -23091.477   22  186 -23510.266 -15672.273  33.3%  1598 1541s
  7235  3088     cutoff   25      -23510.266 -15672.273  33.3%  1604 1558s
  7333  3082 -22055.327   27  398 -23510.266 -15672.273  33.3%  1610 1574s
  7391  3087 -23313.560   26  310 -23510.266 -15672.273  33.3%  1619 1590s
  7479  3081     cutoff   28      -23510.266 -16727.126  28.9%  1628 1605s
  7587  3084 -21540.593   20  534 -23510.266 -16728.654  28.8%  1634 1624s
  7696  3053     cutoff   22      -23510.266 -16728.654  28.8%  1641 1643s
  7833  3032 -23164.137   25  229 -23510.266 -16728.654  28.8%  1642 1665s
  7968  3020 -20620.740   20  413 -23510.266 -16728.654  28.8%  1649 1685s
  8090  3019     cutoff   26      -23510.266 -17133.160  27.1%  1659 1708s
  8232  3011 -21587.103   21  400 -23510.266 -17133.160  27.1%  1668 1731s
  8376  3005     cutoff   22      -23510.266 -17133.160  27.1%  1674 1754s
  8530  2982 -23153.115   25  266 -23510.266 -17133.160  27.1%  1680 1778s
  8698  2953 -20670.584   20  426 -23510.266 -18201.573  22.6%  1689 1801s
  8815  2935 -20325.343   21  467 -23510.266 -18605.440  20.9%  1696 1825s
  8982  2892 -20720.363   23  407 -23510.266 -18625.368  20.8%  1707 1851s
  9189  2869     cutoff   27      -23510.266 -18625.368  20.8%  1711 1876s
  9383  2794     cutoff   32      -23510.266 -18965.815  19.3%  1717 1895s
  9453  2781     cutoff   33      -23510.266 -19050.190  19.0%  1719 1914s
  9526  2777 -22869.706   35  196 -23510.266 -19077.109  18.9%  1719 1939s
  9706  2761 -20699.100   21  413 -23510.266 -19097.300  18.8%  1721 1964s
  9914  2686 -23109.229   27  182 -23510.266 -19097.300  18.8%  1728 1994s
 10205  2612 -21739.997   26  553 -23510.266 -19352.821  17.7%  1728 2021s
 10297  2623 -21851.373   27  462 -23510.266 -19352.821  17.7%  1735 2049s
 10556  2529     cutoff   30      -23510.266 -19593.793  16.7%  1737 2082s
 10821  2404     cutoff   22      -23510.266 -19684.778  16.3%  1746 2124s
 11107  2296 -22650.913   21  544 -23510.266 -19904.553  15.3%  1756 2158s
 11452  2111     cutoff   21      -23510.266 -20072.091  14.6%  1755 2192s
 11818  1886 -21653.087   24  300 -23510.266 -20236.151  13.9%  1753 2230s
 12242  1638 infeasible   30      -23510.266 -20622.077  12.3%  1745 2263s
 12667  1279 -21773.290   24  389 -23510.266 -20834.958  11.4%  1740 2301s
 13228   603 infeasible   39      -23510.266 -21136.669  10.1%  1719 2336s
 13983   232 infeasible   26      -23510.266 -21804.608  7.25%  1670 2364s
 14159   100     cutoff   27      -23510.266 -22247.695  5.37%  1658 2381s

Cutting planes:
  Learned: 1
  MIR: 554
  Flow cover: 1548
  Zero half: 22
  Mod-K: 1
  RLT: 32
  Relax-and-lift: 52

Explored 14267 nodes (23657154 simplex iterations) in 2381.12 seconds (4437.76 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -23510.3 -23523.8 -23528.3 ... -48583.4
No other solutions better than -23510.3

Optimal solution found (tolerance 1.00e-04)
Best objective -2.351026581818e+04, best bound -2.351026581818e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 2381.13s
  Master Objective (UB) = -23510.27, θ = 100948.12
  Upper Bound (UB) = -23510.27

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 100948.12
  [DEBUG]   ✓ Scenario 0: θ = 100948.12 ≤ Q = 100948.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 100948.12 ≤ Q = 100948.12 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 100948.12 ≤ Q = 100948.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 100948.12 ≤ Q = 100948.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 100948.12 ≤ Q = 100948.12 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x4b9855a8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x4b9855a8
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.262158e+13
Presolve removed 2553 rows and 1846 columns
Presolve time: 0.01s
Presolved: 540 rows, 543 columns, 1523 nonzeros
Found heuristic solution: objective 6842784.1325
Variable types: 367 continuous, 176 integer (176 binary)

Root relaxation: objective -1.280074e+05, 252 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -128007.40    0  124 6842784.13 -128007.40   102%     -    0s
H    0     0                    -89565.52501 -128007.40  42.9%     -    0s
H    0     0                    -90166.98733 -128007.40  42.0%     -    0s
     0     0 -101238.05    0   85 -90166.987 -101238.05  12.3%     -    0s
H    0     0                    -99327.69291 -101231.27  1.92%     -    0s
H    0     0                    -99797.52222 -101231.27  1.44%     -    0s
     0     0 -100894.24    0   85 -99797.522 -100894.24  1.10%     -    0s
     0     0 -100834.53    0   87 -99797.522 -100834.53  1.04%     -    0s
     0     0 -100834.53    0   87 -99797.522 -100834.53  1.04%     -    0s
     0     0 -100371.50    0   27 -99797.522 -100371.50  0.58%     -    0s
     0     0 -100272.88    0   30 -99797.522 -100272.88  0.48%     -    0s
     0     0 -100271.99    0   30 -99797.522 -100271.99  0.48%     -    0s
     0     0 -100088.67    0   22 -99797.522 -100088.67  0.29%     -    0s
     0     0 -99978.608    0   22 -99797.522 -99978.608  0.18%     -    0s
     0     0 -99958.342    0   20 -99797.522 -99958.342  0.16%     -    0s
     0     0 -99957.330    0   20 -99797.522 -99957.330  0.16%     -    0s
     0     0 -99878.379    0   10 -99797.522 -99878.379  0.08%     -    0s
     0     0 -99855.627    0   11 -99797.522 -99855.627  0.06%     -    0s
     0     0          -    0      -99797.522 -99804.848  0.01%     -    0s

Cutting planes:
  Gomory: 3
  Implied bound: 2
  MIR: 6
  Flow cover: 5
  Relax-and-lift: 4

Explored 1 nodes (893 simplex iterations) in 0.15 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 5: -99797.5 -90167 -89565.5 ... 1.26216e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -9.979752221596e+04, best bound -9.980484787077e+04, gap 0.0073%
  Subproblem solved in 0.18s
  Worst-case operational profit (Z_SP) = 94220.13
  Scenario: 38 demand increases, 22 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -99797.52
  [DEBUG]   S×d_nominal = 194017.65
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 194017.65 + -99797.52 = 94220.13
  [DEBUG]   Current θ from Master = 100948.12
  [DEBUG]   ⚠️  Z_SP ≤ θ by 6727.99 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -30238.26
  Lower Bound (LB) = -24370.17
  Gap (UB-LB) = 859.9088, Absolute Gap = 859.9088, Relative Gap = 0.036576
  Not converged yet (gap = 859.91 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 38 increases, 22 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 265049 nonzeros
Model fingerprint: 0x06673427
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 37632 rows and 15282 columns
Presolve time: 1.80s
Presolved: 55491 rows, 24418 columns, 344879 nonzeros
Variable types: 22159 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -362049.1746
Found heuristic solution: objective -192025.5558

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 55491 rows, 24418 columns, 344879 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   21990   -8.0100414e+04   0.000000e+00   2.476404e+06      5s
   33437   -3.3041972e+04   0.000000e+00   4.897570e+08     10s
   42459   -2.3399397e+04   0.000000e+00   4.994474e+07     15s
   49529   -1.1816534e+04   0.000000e+00   1.001413e+06     20s
   55778   -1.0874829e+04   0.000000e+00   3.848785e+06     25s
   60265   -1.0488661e+04   0.000000e+00   9.080918e+06     30s
   65686   -9.6901787e+03   0.000000e+00   3.754810e+06     35s
   71737   -6.4309191e+03   0.000000e+00   1.511306e+06     40s
   76421   -5.7692742e+03   0.000000e+00   5.663694e+05     45s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective -4.922537e+03, 54474 iterations, 46.29 seconds (64.02 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -4922.5370    0  374 -192025.56 -4922.5370  97.4%     -   49s
H    0     0                    -179394.1260 -4922.5370  97.3%     -   49s
H    0     0                    -84373.41395 -4922.5370  94.2%     -   49s
H    0     0                    -75904.01089 -4922.5370  93.5%     -   49s
H    0     0                    -60966.23773 -4922.5370  91.9%     -   49s
H    0     0                    -32057.11311 -4922.5370  84.6%     -   49s
H    0     0                    -31371.50258 -4922.5370  84.3%     -   49s
H    0     0                    -29292.04294 -4922.5370  83.2%     -   51s
H    0     0                    -23652.40890 -4922.5370  79.2%     -   51s
H    0     0                    -23637.09648 -4922.5370  79.2%     -   51s
     0     0 -6854.8655    0  373 -23637.096 -6854.8655  71.0%     -   61s
     0     0 -7281.6488    0  367 -23637.096 -7281.6488  69.2%     -   63s
     0     0 -7448.8893    0  374 -23637.096 -7448.8893  68.5%     -   66s
     0     0 -7448.8893    0  455 -23637.096 -7448.8893  68.5%     -   69s
     0     0 -7448.8893    0  460 -23637.096 -7448.8893  68.5%     -   70s
     0     0 -7448.8893    0  458 -23637.096 -7448.8893  68.5%     -   73s
     0     0 -7448.8893    0  458 -23637.096 -7448.8893  68.5%     -   73s
     0     0 -9770.4716    0  457 -23637.096 -9770.4716  58.7%     -   87s
     0     0 -10076.755    0  520 -23637.096 -10076.755  57.4%     -   94s
     0     0 -10168.857    0  518 -23637.096 -10168.857  57.0%     -   97s
     0     0 -10217.425    0  530 -23637.096 -10217.425  56.8%     -  100s
     0     0 -10247.779    0  512 -23637.096 -10247.779  56.6%     -  102s
     0     0 -10256.663    0  530 -23637.096 -10256.663  56.6%     -  103s
     0     0 -10290.375    0  532 -23637.096 -10290.375  56.5%     -  105s
     0     0 -10315.332    0  532 -23637.096 -10315.332  56.4%     -  106s
H    0     0                    -23625.38738 -10316.546  56.3%     -  107s
     0     0 -10316.546    0  534 -23625.387 -10316.546  56.3%     -  107s
     0     0 -10318.079    0  538 -23625.387 -10318.079  56.3%     -  107s
     0     0 -10318.175    0  544 -23625.387 -10318.175  56.3%     -  108s
     0     0 -11374.028    0  526 -23625.387 -11374.028  51.9%     -  124s
     0     0 -11582.752    0  539 -23625.387 -11582.752  51.0%     -  130s
     0     0 -11649.432    0  537 -23625.387 -11649.432  50.7%     -  133s
     0     0 -11672.818    0  527 -23625.387 -11672.818  50.6%     -  135s
     0     0 -11708.240    0  529 -23625.387 -11708.240  50.4%     -  138s
     0     0 -11784.299    0  539 -23625.387 -11784.299  50.1%     -  144s
     0     0 -11794.996    0  529 -23625.387 -11794.996  50.1%     -  145s
     0     0 -11797.288    0  536 -23625.387 -11797.288  50.1%     -  146s
     0     0 -11799.271    0  544 -23625.387 -11799.271  50.1%     -  147s
     0     0 -11801.149    0  534 -23625.387 -11801.149  50.0%     -  147s
     0     0 -11801.567    0  541 -23625.387 -11801.567  50.0%     -  148s
     0     0 -12111.504    0  566 -23625.387 -12111.504  48.7%     -  160s
H    0     0                    -23615.19996 -12111.945  48.7%     -  160s
     0     0 -12228.835    0  566 -23615.200 -12228.835  48.2%     -  167s
     0     0 -12302.935    0  563 -23615.200 -12302.935  47.9%     -  173s
     0     0 -12337.363    0  577 -23615.200 -12337.363  47.8%     -  177s
     0     0 -12356.511    0  569 -23615.200 -12356.511  47.7%     -  179s
     0     0 -12367.904    0  587 -23615.200 -12367.904  47.6%     -  181s
     0     0 -12374.276    0  599 -23615.200 -12374.276  47.6%     -  182s
     0     0 -12375.371    0  596 -23615.200 -12375.371  47.6%     -  182s
     0     0 -12375.433    0  598 -23615.200 -12375.433  47.6%     -  182s
     0     0 -12490.570    0  596 -23615.200 -12490.570  47.1%     -  188s
     0     0 -12534.654    0  603 -23615.200 -12534.654  46.9%     -  191s
     0     0 -12587.357    0  594 -23615.200 -12587.357  46.7%     -  194s
     0     0 -12602.527    0  600 -23615.200 -12602.527  46.6%     -  197s
     0     0 -12604.086    0  598 -23615.200 -12604.086  46.6%     -  197s
     0     0 -12604.602    0  604 -23615.200 -12604.602  46.6%     -  198s
     0     0 -12671.870    0  581 -23615.200 -12671.870  46.3%     -  202s
     0     0 -12685.978    0  584 -23615.200 -12685.978  46.3%     -  208s
     0     0 -12700.277    0  601 -23615.200 -12700.277  46.2%     -  209s
     0     0 -12727.343    0  595 -23615.200 -12727.343  46.1%     -  211s
     0     0 -12733.221    0  598 -23615.200 -12733.221  46.1%     -  213s
     0     0 -12736.030    0  617 -23615.200 -12736.030  46.1%     -  213s
     0     0 -12738.044    0  620 -23615.200 -12738.044  46.1%     -  215s
     0     0 -12738.561    0  616 -23615.200 -12738.561  46.1%     -  215s
     0     0 -12791.499    0  607 -23615.200 -12791.499  45.8%     -  220s
     0     0 -12801.669    0  598 -23615.200 -12801.669  45.8%     -  223s
     0     0 -12806.999    0  607 -23615.200 -12806.999  45.8%     -  225s
     0     0 -12807.986    0  608 -23615.200 -12807.986  45.8%     -  226s
     0     0 -12863.827    0  614 -23615.200 -12863.827  45.5%     -  231s
     0     0 -12885.502    0  675 -23615.200 -12885.502  45.4%     -  236s
     0     0 -12889.725    0  684 -23615.200 -12889.725  45.4%     -  236s
     0     0 -12891.832    0  635 -23615.200 -12891.832  45.4%     -  237s
     0     0 -12892.687    0  629 -23615.200 -12892.687  45.4%     -  238s
     0     0 -12927.314    0  628 -23615.200 -12927.314  45.3%     -  242s
     0     0 -12946.290    0  629 -23615.200 -12946.290  45.2%     -  244s
     0     0 -12951.109    0  635 -23615.200 -12951.109  45.2%     -  245s
     0     0 -12952.331    0  638 -23615.200 -12952.331  45.2%     -  246s
     0     0 -12952.537    0  632 -23615.200 -12952.537  45.2%     -  246s
     0     0 -13006.444    0  623 -23615.200 -13006.444  44.9%     -  251s
     0     0 -13029.749    0  627 -23615.200 -13029.749  44.8%     -  255s
     0     0 -13036.971    0  635 -23615.200 -13036.971  44.8%     -  256s
     0     0 -13041.863    0  629 -23615.200 -13041.863  44.8%     -  258s
     0     0 -13044.117    0  633 -23615.200 -13044.117  44.8%     -  259s
     0     0 -13044.924    0  632 -23615.200 -13044.924  44.8%     -  260s
     0     0 -13062.199    0  622 -23615.200 -13062.199  44.7%     -  263s
     0     0 -13070.289    0  634 -23615.200 -13070.289  44.7%     -  265s
     0     0 -13073.582    0  633 -23615.200 -13073.582  44.6%     -  266s
     0     0 -13074.148    0  636 -23615.200 -13074.148  44.6%     -  267s
     0     0 -13077.304    0  637 -23615.200 -13077.304  44.6%     -  269s
     0     0 -13078.375    0  639 -23615.200 -13078.375  44.6%     -  279s
     0     0 -13078.672    0  653 -23615.200 -13078.672  44.6%     -  279s
     0     0 -13082.914    0  638 -23615.200 -13082.914  44.6%     -  282s
     0     0 -13083.700    0  641 -23615.200 -13083.700  44.6%     -  282s
     0     0 -13089.443    0  641 -23615.200 -13089.443  44.6%     -  284s
     0     0 -13090.654    0  662 -23615.200 -13090.654  44.6%     -  285s
     0     0 -13091.462    0  653 -23615.200 -13091.462  44.6%     -  286s
     0     0 -13095.434    0  651 -23615.200 -13095.434  44.5%     -  288s
     0     0 -13095.491    0  651 -23615.200 -13095.491  44.5%     -  290s
     0     2 -13095.491    0  651 -23615.200 -13095.491  44.5%     -  337s
     1     4 -13206.522    1  637 -23615.200 -13095.763  44.5%  1838  349s
     3     8 -13225.715    2  621 -23615.200 -13207.429  44.1%  4264  359s
     7    16 -13272.226    3  609 -23615.200 -13226.388  44.0%  3608  371s
    15    32 -13290.344    4  633 -23615.200 -13273.314  43.8%  3947  383s
    31    48 -14396.954    5  460 -23615.200 -13290.361  43.7%  5225  402s
    47    80 -14572.863    6  533 -23615.200 -13290.361  43.7%  5880  419s
    79   159 -14879.817    7  503 -23615.200 -13290.361  43.7%  4512  434s
   158   201 -14897.054    8  490 -23615.200 -13290.361  43.7%  3111  441s
   200   268 -14900.807    8  499 -23615.200 -13290.361  43.7%  2771  452s
   276   311 -14897.953    9  431 -23615.200 -13290.361  43.7%  2487  460s
   367   326 -14937.676    9  489 -23615.200 -13290.361  43.7%  2297  472s
   451   361 -15081.051   10  492 -23615.200 -13290.361  43.7%  2226  484s
   515   389 -16139.517   11  448 -23615.200 -13290.361  43.7%  2323  497s
   591   402 -17216.599   11  437 -23615.200 -13290.361  43.7%  2365  508s
   663   424 -20076.169   10  341 -23615.200 -13290.361  43.7%  2363  519s
   727   465 -16320.004   12  457 -23615.200 -13290.361  43.7%  2455  530s
   799   504 -16757.432   13  308 -23615.200 -13290.361  43.7%  2422  541s
   873   534 -16765.766   14  362 -23615.200 -13290.361  43.7%  2373  553s
   945   547 -16933.710   16  433 -23615.200 -13290.361  43.7%  2346  565s
   996   555 -17134.714   15  456 -23615.200 -13290.361  43.7%  2369  575s
  1055   574 -17585.719   17  372 -23615.200 -13290.361  43.7%  2461  587s
  1104   585 -18290.655   17  425 -23615.200 -13290.361  43.7%  2468  598s
  1176   598 -17226.590   16  458 -23615.200 -13290.361  43.7%  2508  611s
  1229   633 -19499.649   16  150 -23615.200 -13439.708  43.1%  2516  623s
  1300   677 -18185.001   18  358 -23615.200 -13440.405  43.1%  2541  632s
  1392   705 -20299.459   18  377 -23615.200 -13440.405  43.1%  2527  645s
  1492   764     cutoff   19      -23615.200 -13440.405  43.1%  2557  662s
  1601   813 -18320.057   18  425 -23615.200 -13440.405  43.1%  2568  675s
  1709   872 -19867.804   20  346 -23615.200 -13440.405  43.1%  2568  691s
  1811   895 -20118.167   23  341 -23615.200 -13440.405  43.1%  2571  707s
  1932   939 -22355.499   22  317 -23615.200 -13440.405  43.1%  2576  721s
  2034   967 -22427.739   23  239 -23615.200 -13440.405  43.1%  2626  737s
  2112   989 -22843.345   24  242 -23615.200 -13440.405  43.1%  2656  754s
  2226  1026 -23113.536   26  249 -23615.200 -13440.405  43.1%  2626  772s
  2333  1089 -23373.414   28  219 -23615.200 -13440.405  43.1%  2667  788s
  2464  1147     cutoff   32      -23615.200 -14396.231  39.0%  2688  805s
  2570  1204 -20180.535   14  258 -23615.200 -14396.231  39.0%  2738  823s
  2689  1272 -20712.671   18  252 -23615.200 -15620.786  33.9%  2772  840s
  2853  1327 -21321.200   23  181 -23615.200 -15620.786  33.9%  2774  859s
  3015  1385 -22210.454   30  181 -23615.200 -15620.902  33.9%  2786  880s
  3131  1427     cutoff   38      -23615.200 -15652.222  33.7%  2835  900s
  3287  1466 -18001.605   13  590 -23615.200 -15652.222  33.7%  2818  920s
  3449  1521 -19429.706   15  504 -23615.200 -15652.222  33.7%  2864  941s
  3642  1558 -21776.081   17  312 -23615.200 -15755.442  33.3%  2859  963s
  3765  1566 -22842.000   20  291 -23615.200 -15755.456  33.3%  2877  985s
  3817  1585 -22947.568   21  162 -23615.200 -15755.456  33.3%  2898 1001s
  3876  1610     cutoff   22      -23615.200 -15755.456  33.3%  2929 1023s
  3979  1651 -20145.667   10  368 -23615.200 -15755.456  33.3%  2959 1044s
  4136  1740 -21223.566   12  209 -23615.200 -15755.456  33.3%  2930 1067s
  4371  1780     cutoff   17      -23615.200 -15755.456  33.3%  2924 1090s
  4587  1839 -23412.192   17   42 -23615.200 -16317.478  30.9%  2953 1116s
  4801  1956 -21211.512   19  414 -23615.200 -16359.881  30.7%  2982 1142s
  5025  2082 -21364.055   22  213 -23615.200 -16359.881  30.7%  2931 1169s
  5372  2142     cutoff   22      -23615.200 -17253.059  26.9%  2837 1200s
  5645  2217 -17910.911   11  530 -23615.200 -17253.537  26.9%  2793 1234s
  5936  2278 -21345.767   13  460 -23615.200 -17253.537  26.9%  2752 1269s
  6230  2313     cutoff   15      -23615.200 -17253.537  26.9%  2717 1305s
  6473  2394 -19822.756   13  543 -23615.200 -17608.489  25.4%  2691 1340s
  6854  2497 -21917.805   16  511 -23615.200 -17995.499  23.8%  2629 1377s
  7209  2498 -23212.863   23  651 -23615.200 -18267.490  22.6%  2592 1444s
  7211  2499 -19188.983   10  374 -23615.200 -18267.490  22.6%  2591 1513s
  7212  2500 -19571.893   14  567 -23615.200 -18267.490  22.6%  2591 1534s
  7213  2501 -20068.204   15  535 -23615.200 -18267.490  22.6%  2590 1554s
  7214  2501 -22393.004   16  681 -23615.200 -18267.490  22.6%  2590 1569s
  7215  2502 -23523.167   25  577 -23615.200 -18267.490  22.6%  2590 1579s
  7216  2503 -19499.569    9  599 -23615.200 -18267.490  22.6%  2589 1586s
  7217  2503 -19960.430   15  594 -23615.200 -18267.490  22.6%  2589 1592s
  7218  2504 -22493.072   30  601 -23615.200 -18267.490  22.6%  2588 1596s
  7219  2505 -21848.025   34  623 -23615.200 -18267.490  22.6%  2588 1603s
  7220  2505 -20620.497   25  611 -23615.200 -18267.490  22.6%  2588 1619s
  7221  2506 -22460.933   40  622 -23615.200 -18267.490  22.6%  2587 1622s
  7222  2507 -19629.590   14  621 -23615.200 -18267.490  22.6%  2587 1628s
  7223  2507 -21630.160    8  607 -23615.200 -18267.490  22.6%  2587 1640s
  7224  2508 -21393.220   14  626 -23615.200 -18267.490  22.6%  2586 1646s
  7226  2509 -20556.463   11  640 -23615.200 -18267.490  22.6%  2586 1656s
  7227  2510 -22639.690   43  626 -23615.200 -18267.490  22.6%  2585 1668s
  7228  2511 -21641.349   20  635 -23615.200 -18267.490  22.6%  2585 1676s
  7229  2511 -21151.967   22  629 -23615.200 -18267.490  22.6%  2585 1686s
  7230  2512 -22848.661   33  629 -23615.200 -18267.490  22.6%  2584 1758s
  7231  2513 -19206.710    8  629 -23615.200 -18267.490  22.6%  2584 1789s
  7232  2516 -18267.490   12  621 -23615.200 -18267.490  22.6%  2610 1816s
  7234  2520 -18267.490   13  612 -23615.200 -18267.490  22.6%  2611 1830s
  7238  2526 -18267.490   14  605 -23615.200 -18267.490  22.6%  2613 1847s
  7246  2540 -18267.490   15  608 -23615.200 -18267.490  22.6%  2613 1867s
  7262  2552 -20384.851   16  228 -23615.200 -18267.490  22.6%  2635 1895s
  7282  2573 -18267.490   17  377 -23615.200 -18267.490  22.6%  2642 1914s
  7314  2624 -18267.490   18  434 -23615.200 -18267.490  22.6%  2659 1937s
  7398  2625 -18582.168   20  409 -23615.200 -18267.490  22.6%  2668 1956s
  7496  2605 -20922.061   19  193 -23615.200 -18267.490  22.6%  2659 1970s
  7540  2607 -19691.025   22  296 -23615.200 -18267.490  22.6%  2657 1985s
  7597  2612 -22679.862   21  378 -23615.200 -18267.490  22.6%  2658 2004s
  7641  2620 -21700.913   21  396 -23615.200 -18267.490  22.6%  2662 2024s
  7702  2631 -21673.640   23  265 -23615.200 -18267.490  22.6%  2660 2047s
  7758  2626     cutoff   24      -23615.200 -18267.490  22.6%  2661 2064s
  7831  2632 -21039.817   24  380 -23615.200 -18267.490  22.6%  2656 2080s
  7886  2647 -21143.281   25  279 -23615.200 -18267.490  22.6%  2655 2094s
  7959  2640 -21906.964   26  248 -23615.200 -18267.490  22.6%  2651 2109s
  8020  2648 -22471.261   28  148 -23615.200 -18267.490  22.6%  2648 2129s
  8085  2649 -19098.678   21  442 -23615.200 -18267.490  22.6%  2644 2145s
  8154  2659 -18750.403   21  516 -23615.200 -18267.490  22.6%  2642 2162s
  8232  2658 -19121.810   22  402 -23615.200 -18267.490  22.6%  2640 2176s
  8278  2650 -21291.848   22  498 -23615.200 -18267.490  22.6%  2641 2191s
  8355  2669 -22118.367   23  111 -23615.200 -18267.490  22.6%  2639 2208s
  8429  2670 -21403.192   24  242 -23615.200 -18267.490  22.6%  2635 2225s
  8513  2662     cutoff   25      -23615.200 -18267.490  22.6%  2634 2243s
  8597  2659 -20518.352   24  285 -23615.200 -18267.490  22.6%  2630 2259s
  8702  2659 -22741.842   25  236 -23615.200 -18267.490  22.6%  2624 2278s
  8801  2655     cutoff   27      -23615.200 -18267.490  22.6%  2620 2296s
  8913  2644 -22966.744   23  196 -23615.200 -18267.490  22.6%  2614 2316s
  9002  2636     cutoff   24      -23615.200 -18267.490  22.6%  2610 2336s
  9121  2632 -22693.001   19  226 -23615.200 -18267.490  22.6%  2605 2364s
  9273  2588     cutoff   33      -23615.200 -18267.490  22.6%  2592 2387s
  9351  2591 -18673.071   19  493 -23615.200 -18267.490  22.6%  2595 2409s
  9441  2597 -18993.200   20  489 -23615.200 -18267.490  22.6%  2593 2434s
  9546  2584 -19225.677   21  485 -23615.200 -18267.490  22.6%  2597 2450s
  9586  2583 -19536.077   22  456 -23615.200 -18267.490  22.6%  2599 2466s
  9638  2572 -20044.572   23  443 -23615.200 -18267.490  22.6%  2598 2490s
  9697  2566 -20821.404   24  411 -23615.200 -18267.490  22.6%  2599 2516s
  9764  2553     cutoff   25      -23615.200 -18267.490  22.6%  2599 2539s
  9861  2535     cutoff   25      -23615.200 -18267.490  22.6%  2599 2567s
  9988  2522 -21556.671   24  390 -23615.200 -18267.490  22.6%  2599 2596s
 10140  2483     cutoff   26      -23615.200 -18267.490  22.6%  2597 2626s
 10278  2480 -21357.854   23  421 -23615.200 -18267.490  22.6%  2593 2660s
 10435  2461     cutoff   26      -23615.200 -18267.490  22.6%  2593 2690s
 10585  2437 -22058.597   22  448 -23615.200 -18267.490  22.6%  2586 2723s
 10781  2377 -23086.240   22  457 -23615.200 -18601.752  21.2%  2581 2759s
 10994  2344     cutoff   25      -23615.200 -18601.752  21.2%  2578 2795s
 11207  2271     cutoff   27      -23615.200 -19218.529  18.6%  2573 2833s
 11422  2202 -21331.268   29  351 -23615.200 -19424.459  17.7%  2575 2872s
 11674  2125     cutoff   37      -23615.200 -19496.346  17.4%  2568 2915s
 11934  2030 -21419.739   22  402 -23615.200 -19805.201  16.1%  2566 2958s
 12239  1913     cutoff   23      -23615.200 -19972.657  15.4%  2554 3000s
 12548  1818     cutoff   33      -23615.200 -20115.049  14.8%  2545 3042s
 12906  1681     cutoff   32      -23615.200 -20324.991  13.9%  2527 3081s
 13077  1624 -23206.702   27  202 -23615.200 -20485.038  13.3%  2524 3128s
 13451  1413 -23387.680   22  500 -23615.200 -20596.310  12.8%  2506 3179s
 13906  1146     cutoff   27      -23615.200 -20946.164  11.3%  2482 3227s
 14441   749 -23341.771   22  242 -23615.200 -21173.258  10.3%  2449 3274s
 15021   193 -22587.714   27  298 -23615.200 -21550.014  8.75%  2405 3320s
 15832     0 -23586.220   30  266 -23615.200 -21863.257  7.42%  2331 3347s

Cutting planes:
  Learned: 1
  Gomory: 1
  MIR: 694
  Mixing: 1
  Flow cover: 1802
  Zero half: 24
  RLT: 30
  Relax-and-lift: 51

Explored 16134 nodes (37351373 simplex iterations) in 3347.57 seconds (6064.19 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -23615.2 -23625.4 -23637.1 ... -84373.4
No other solutions better than -23615.2

Optimal solution found (tolerance 1.00e-04)
Best objective -2.361519995736e+04, best bound -2.361519995736e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3347.58s
  Master Objective (UB) = -23615.20, θ = 101069.48
  Upper Bound (UB) = -23615.20

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 101069.48
  [DEBUG]   ✓ Scenario 0: θ = 101069.48 ≤ Q = 101069.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 101069.48 ≤ Q = 101069.48 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 101069.48 ≤ Q = 101069.48 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 101069.48 ≤ Q = 101069.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 101069.48 ≤ Q = 101069.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 101069.48 ≤ Q = 101069.48 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x16d47e46
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xe92b81ba
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.260460e+13
Presolve removed 2553 rows and 1846 columns
Presolve time: 0.01s
Presolved: 540 rows, 543 columns, 1523 nonzeros
Found heuristic solution: objective 6835568.0991
Variable types: 367 continuous, 176 integer (176 binary)

Root relaxation: objective -1.278572e+05, 252 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -127857.22    0  124 6835568.10 -127857.22   102%     -    0s
H    0     0                    -89372.12986 -127857.22  43.1%     -    0s
H    0     0                    -89973.59219 -127857.22  42.1%     -    0s
     0     0 -96834.070    0   31 -89973.592 -96834.070  7.62%     -    0s
H    0     0                    -96236.54197 -96822.309  0.61%     -    0s
     0     0 -96692.179    0   23 -96236.542 -96692.179  0.47%     -    0s
     0     0 -96679.190    0   22 -96236.542 -96679.190  0.46%     -    0s
H    0     0                    -96477.71625 -96612.543  0.14%     -    0s
     0     0 -96585.045    0   12 -96477.716 -96585.045  0.11%     -    0s
     0     0 -96575.749    0   11 -96477.716 -96575.749  0.10%     -    0s
     0     0 -96564.395    0   10 -96477.716 -96564.395  0.09%     -    0s
     0     0 -96528.943    0    4 -96477.716 -96528.943  0.05%     -    0s
     0     0 -96528.943    0   10 -96477.716 -96528.943  0.05%     -    0s
H    0     0                    -96483.09585 -96528.943  0.05%     -    0s
     0     0 -96527.549    0    5 -96483.096 -96527.549  0.05%     -    0s
H    0     0                    -96527.36767 -96527.368  0.00%     -    0s

Cutting planes:
  Gomory: 1
  MIR: 3
  Flow cover: 4

Explored 1 nodes (566 simplex iterations) in 0.11 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 8: -96527.4 -96483.1 -96477.7 ... 1.26046e+13
No other solutions better than -96527.4

Optimal solution found (tolerance 1.00e-04)
Best objective -9.652736766687e+04, best bound -9.652736766687e+04, gap 0.0000%
  Subproblem solved in 0.14s
  Worst-case operational profit (Z_SP) = 97490.28
  Scenario: 7 demand increases, 53 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -96527.37
  [DEBUG]   S×d_nominal = 194017.65
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 194017.65 + -96527.37 = 97490.28
  [DEBUG]   Current θ from Master = 101069.48
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3579.20 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -27194.40
  Lower Bound (LB) = -24370.17
  Gap (UB-LB) = 754.9746, Absolute Gap = 754.9746, Relative Gap = 0.031970
  Not converged yet (gap = 754.97 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 7 increases, 53 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308304 nonzeros
Model fingerprint: 0x8321bc29
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 43914 rows and 17834 columns
Presolve time: 2.24s
Presolved: 64499 rows, 28106 columns, 401409 nonzeros
Variable types: 25847 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -362049.1746
Found heuristic solution: objective -192025.5558

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 64499 rows, 28106 columns, 401409 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   24170   -1.3703315e+05   0.000000e+00   1.201077e+08      5s
   36892   -3.9048229e+04   0.000000e+00   4.672732e+06     10s
   43039   -2.8979773e+04   0.000000e+00   1.332056e+08     15s
   48462   -1.6542863e+04   0.000000e+00   2.111613e+06     20s
   52565   -1.5538492e+04   0.000000e+00   1.954714e+06     25s
   56361   -1.5498436e+04   0.000000e+00   3.523309e+06     30s
   61015   -1.3150406e+04   0.000000e+00   4.851814e+06     35s
   66193   -8.2699803e+03   0.000000e+00   3.099050e+08     40s
   70719   -7.5128881e+03   0.000000e+00   1.270135e+06     45s
   75071   -6.5277774e+03   0.000000e+00   1.163046e+07     50s
   78987   -6.2080711e+03   0.000000e+00   2.080003e+07     55s
Concurrent spin time: 2.01s

Solved with dual simplex

Root relaxation: objective -4.962582e+03, 72077 iterations, 57.45 seconds (81.14 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -4962.5825    0  382 -192025.56 -4962.5825  97.4%     -   60s
H    0     0                    -177617.1298 -4962.5825  97.2%     -   60s
H    0     0                    -143446.4136 -4962.5825  96.5%     -   60s
H    0     0                    -140603.7580 -4962.5825  96.5%     -   60s
H    0     0                    -86947.20292 -4962.5825  94.3%     -   60s
H    0     0                    -60871.79843 -4962.5825  91.8%     -   61s
H    0     0                    -33155.65009 -4962.5825  85.0%     -   61s
H    0     0                    -32607.27186 -4962.5825  84.8%     -   61s
H    0     0                    -32600.73948 -4962.5825  84.8%     -   61s
H    0     0                    -24963.39888 -4962.5825  80.1%     -   63s
H    0     0                    -24671.91859 -4962.5825  79.9%     -   63s
H    0     0                    -24147.11271 -4962.5825  79.4%     -   63s
H    0     0                    -24045.24414 -4962.5825  79.4%     -   63s
H    0     0                    -23992.38480 -4962.5825  79.3%     -   63s
H    0     0                    -23978.00272 -4962.5825  79.3%     -   63s
H    0     0                    -23895.18393 -4962.5825  79.2%     -   63s
H    0     0                    -23822.87882 -4962.5825  79.2%     -   63s
     0     0 -7151.2243    0  463 -23822.879 -7151.2243  70.0%     -   79s
H    0     0                    -23750.92472 -7151.3198  69.9%     -   80s
     0     0 -7604.5949    0  475 -23750.925 -7604.5949  68.0%     -   86s
     0     0 -7669.6192    0  477 -23750.925 -7669.6192  67.7%     -   89s
     0     0 -7674.0207    0  477 -23750.925 -7674.0207  67.7%     -   90s
     0     0 -7771.9520    0  486 -23750.925 -7771.9520  67.3%     -   92s
     0     0 -7771.9520    0  480 -23750.925 -7771.9520  67.3%     -   93s
     0     0 -7772.6734    0  472 -23750.925 -7772.6734  67.3%     -   96s
     0     0 -7773.6181    0  476 -23750.925 -7773.6181  67.3%     -   97s
     0     0 -7774.1955    0  480 -23750.925 -7774.1955  67.3%     -   97s
     0     0 -7774.2025    0  480 -23750.925 -7774.2025  67.3%     -   98s
     0     0 -9949.9165    0  478 -23750.925 -9949.9165  58.1%     -  120s
H    0     0                    -23725.54481 -9950.1795  58.1%     -  120s
     0     0 -10215.623    0  499 -23725.545 -10215.623  56.9%     -  128s
     0     0 -10302.784    0  510 -23725.545 -10302.784  56.6%     -  133s
     0     0 -10373.523    0  494 -23725.545 -10373.523  56.3%     -  136s
     0     0 -10520.534    0  544 -23725.545 -10520.534  55.7%     -  142s
     0     0 -10529.064    0  541 -23725.545 -10529.064  55.6%     -  143s
     0     0 -10557.496    0  553 -23725.545 -10557.496  55.5%     -  145s
     0     0 -10558.411    0  549 -23725.545 -10558.411  55.5%     -  146s
     0     0 -10558.445    0  547 -23725.545 -10558.445  55.5%     -  146s
     0     0 -11560.978    0  512 -23725.545 -11560.978  51.3%     -  175s
     0     0 -11780.616    0  531 -23725.545 -11780.616  50.3%     -  183s
     0     0 -11898.278    0  529 -23725.545 -11898.278  49.9%     -  189s
     0     0 -11974.083    0  541 -23725.545 -11974.083  49.5%     -  197s
     0     0 -11989.693    0  544 -23725.545 -11989.693  49.5%     -  199s
     0     0 -12007.026    0  534 -23725.545 -12007.026  49.4%     -  201s
     0     0 -12041.867    0  533 -23725.545 -12041.867  49.2%     -  204s
     0     0 -12049.377    0  542 -23725.545 -12049.377  49.2%     -  205s
     0     0 -12054.347    0  537 -23725.545 -12054.347  49.2%     -  206s
     0     0 -12058.874    0  529 -23725.545 -12058.874  49.2%     -  207s
     0     0 -12059.257    0  535 -23725.545 -12059.257  49.2%     -  207s
     0     0 -12650.123    0  561 -23725.545 -12650.123  46.7%     -  230s
     0     0 -12878.102    0  545 -23725.545 -12878.102  45.7%     -  243s
     0     0 -12950.947    0  554 -23725.545 -12950.947  45.4%     -  248s
     0     0 -12957.851    0  567 -23725.545 -12957.851  45.4%     -  250s
     0     0 -12969.753    0  570 -23725.545 -12969.753  45.3%     -  251s
     0     0 -12974.728    0  576 -23725.545 -12974.728  45.3%     -  252s
     0     0 -12975.270    0  581 -23725.545 -12975.270  45.3%     -  253s
     0     0 -13090.419    0  573 -23725.545 -13090.419  44.8%     -  261s
     0     0 -13110.095    0  574 -23725.545 -13110.095  44.7%     -  265s
     0     0 -13118.686    0  583 -23725.545 -13118.686  44.7%     -  266s
     0     0 -13127.220    0  582 -23725.545 -13127.220  44.7%     -  268s
     0     0 -13128.085    0  588 -23725.545 -13128.085  44.7%     -  269s
     0     0 -13147.910    0  589 -23725.545 -13147.910  44.6%     -  273s
H    0     0                    -23713.93795 -13147.972  44.6%     -  277s
     0     0 -13151.284    0  583 -23713.938 -13151.284  44.5%     -  278s
     0     0 -13152.818    0  589 -23713.938 -13152.818  44.5%     -  279s
     0     0 -13152.863    0  594 -23713.938 -13152.863  44.5%     -  279s
     0     0 -13159.751    0  580 -23713.938 -13159.751  44.5%     -  281s
     0     0 -13160.424    0  592 -23713.938 -13160.424  44.5%     -  283s
     0     0 -13167.022    0  589 -23713.938 -13167.022  44.5%     -  285s
     0     0 -13169.360    0  591 -23713.938 -13169.360  44.5%     -  288s
     0     0 -13170.310    0  597 -23713.938 -13170.310  44.5%     -  289s
     0     0 -13224.232    0  563 -23713.938 -13224.232  44.2%     -  296s
     0     0 -13229.193    0  572 -23713.938 -13229.193  44.2%     -  299s
     0     0 -13230.817    0  589 -23713.938 -13230.817  44.2%     -  300s
     0     0 -13232.291    0  594 -23713.938 -13232.291  44.2%     -  301s
     0     0 -13233.052    0  593 -23713.938 -13233.052  44.2%     -  302s
     0     0 -13238.393    0  600 -23713.938 -13238.393  44.2%     -  305s
     0     0 -13241.371    0  593 -23713.938 -13241.371  44.2%     -  310s
     0     0 -13242.344    0  592 -23713.938 -13242.344  44.2%     -  310s
     0     0 -13244.624    0  597 -23713.938 -13244.624  44.1%     -  312s
     0     0 -13246.385    0  598 -23713.938 -13246.385  44.1%     -  313s
     0     0 -13246.754    0  589 -23713.938 -13246.754  44.1%     -  314s
     0     0 -13249.005    0  590 -23713.938 -13249.005  44.1%     -  316s
     0     0 -13249.543    0  596 -23713.938 -13249.543  44.1%     -  318s
     0     0 -13250.643    0  593 -23713.938 -13250.643  44.1%     -  320s
     0     0 -13250.665    0  593 -23713.938 -13250.665  44.1%     -  324s
     0     2 -13250.677    0  593 -23713.938 -13250.677  44.1%     -  357s
     1     4 -13350.695    1  551 -23713.938 -13250.677  44.1%  3941  363s
     3     8 -13393.901    2  546 -23713.938 -13350.907  43.7%  2926  372s
     7    16 -13536.262    3  558 -23713.938 -13394.490  43.5%  4015  384s
    15    31 -13607.844    4  561 -23713.938 -13537.322  42.9%  4486  400s
    30    39 -20424.589    5  159 -23713.938 -13607.916  42.6%  6082  426s
    46    65 -14957.583    6  436 -23713.938 -13607.916  42.6%  7821  449s
    72    97 -15125.943    7  427 -23713.938 -13607.916  42.6%  6531  478s
   104   198 -15248.786    8  409 -23713.938 -13607.916  42.6%  5740  496s
   211   289 -15967.350   12  418 -23713.938 -13607.916  42.6%  3690  507s
   312   336 -16741.981   15  343 -23713.938 -13607.916  42.6%  2949  518s
   412   344 -17299.321   16  310 -23713.938 -13607.916  42.6%  2472  529s
   455   360 -17666.448   17  304 -23713.938 -13607.916  42.6%  2357  539s
   509   382 -18712.850   18  279 -23713.938 -13607.916  42.6%  2228  548s
   560   382 -19001.904   19  275 -23713.938 -13607.916  42.6%  2143  560s
   628   404 -19500.805   20  201 -23713.938 -13607.916  42.6%  2090  571s
   678   421 -19639.280   21  283 -23713.938 -13607.916  42.6%  2073  583s
   735   452 -19716.664   22  187 -23713.938 -13607.916  42.6%  2051  596s
   782   498 -20125.419   23  260 -23713.938 -13607.916  42.6%  2072  609s
   834   534 -20126.610   24  188 -23713.938 -13790.615  41.8%  2100  621s
   894   567 -20679.674   25  173 -23713.938 -13791.586  41.8%  2106  633s
   949   592 -21348.172   26  184 -23713.938 -13791.586  41.8%  2130  647s
  1018   603 -23406.322   27   88 -23713.938 -13791.586  41.8%  2135  660s
  1090   632     cutoff   28      -23713.938 -13791.586  41.8%  2146  674s
  1158   674     cutoff   28      -23713.938 -13791.586  41.8%  2164  688s
  1237   716 -20936.882   17  153 -23713.938 -13791.586  41.8%  2142  703s
  1340   765 -21581.140   19  192 -23713.938 -13791.586  41.8%  2106  720s
  1445   796 -22280.322   22  179 -23713.938 -13791.586  41.8%  2048  736s
  1558   842     cutoff   17      -23713.938 -14141.442  40.4%  2010  752s
  1650   894 -16093.091    7  435 -23713.938 -14141.442  40.4%  2010  773s
  1760   958 -16741.949    8  429 -23713.938 -14141.442  40.4%  1990  789s
  1882  1000 -16992.354    9  200 -23713.938 -14141.442  40.4%  1968  809s
  2001  1037 -19983.157   11  133 -23713.938 -14512.753  38.8%  1952  827s
  2098  1062     cutoff   14      -23713.938 -14515.482  38.8%  1946  849s
  2220  1085 -21510.265   13  135 -23713.938 -14515.482  38.8%  1940  865s
  2259  1104     cutoff   14      -23713.938 -14515.482  38.8%  1965  883s
  2328  1127 infeasible   14      -23713.938 -14515.482  38.8%  1969  906s
  2415  1186 -21522.632   15  213 -23713.938 -15132.316  36.2%  1976  926s
  2508  1229     cutoff   16      -23713.938 -15132.316  36.2%  1985  947s
  2627  1261 -23328.755   17  120 -23713.938 -15310.617  35.4%  1987  968s
  2745  1290 -16875.388   10  318 -23713.938 -15399.070  35.1%  2012  990s
  2865  1355 -17680.143   12  290 -23713.938 -15399.070  35.1%  2084 1015s
  2994  1391 -19328.240   14  195 -23713.938 -15399.070  35.1%  2099 1043s
  3163  1468 -20000.005   16  206 -23713.938 -15476.000  34.7%  2096 1069s
  3358  1487 -21234.203   19  280 -23713.938 -15476.000  34.7%  2089 1091s
  3403  1518 -21620.188   20  329 -23713.938 -15476.000  34.7%  2101 1108s
  3444  1538 -21790.903   21  258 -23713.938 -15554.396  34.4%  2115 1132s
  3494  1556 -22037.534   22  201 -23713.938 -15554.396  34.4%  2120 1155s
  3574  1576 -22352.319   23  279 -23713.938 -15554.396  34.4%  2119 1180s
  3692  1602 -23588.515   24  277 -23713.938 -15754.083  33.6%  2106 1204s
  3828  1654 -19064.593   10  377 -23713.938 -15890.119  33.0%  2115 1230s
  3946  1681 -22067.325   12  443 -23713.938 -15890.119  33.0%  2122 1261s
  4138  1722     cutoff   14      -23713.938 -16030.121  32.4%  2123 1295s
  4389  1745     cutoff   13      -23713.938 -16068.933  32.2%  2121 1329s
  4593  1776 -22997.808   11  392 -23713.938 -16244.803  31.5%  2133 1364s
  4824  1824 -20596.075   12  128 -23713.938 -16386.180  30.9%  2137 1401s
  5046  1863 -19976.407   17  398 -23713.938 -16422.752  30.7%  2154 1439s
  5245  1894 infeasible   19      -23713.938 -16538.310  30.3%  2161 1484s
  5487  1946 -23115.383   35   33 -23713.938 -16704.950  29.6%  2170 1530s
  5748  1957 -20678.214   16  354 -23713.938 -16746.455  29.4%  2176 1563s
  5803  1977 -21780.459   17  279 -23713.938 -16746.455  29.4%  2181 1603s
  5945  2028     cutoff   21      -23713.938 -16832.632  29.0%  2191 1647s
  6190  2076 infeasible   17      -23713.938 -16895.568  28.8%  2194 1690s
  6461  2142 infeasible   19      -23713.938 -17059.349  28.1%  2212 1738s
  6791  2211     cutoff   15      -23713.938 -17103.414  27.9%  2217 1790s
  7138  2254 -23178.291   13  246 -23713.938 -17173.493  27.6%  2221 1841s
  7479  2321 -18619.967   12  389 -23713.938 -17279.376  27.1%  2231 1904s
  7855  2349 -21834.112   14   81 -23713.938 -17336.791  26.9%  2234 1963s
  8238  2394 -21478.403   15  187 -23713.938 -17616.670  25.7%  2239 2018s
  8623  2447 -22249.362   16  197 -23713.938 -17704.755  25.3%  2252 2077s
  9061  2494 -20859.793   15  343 -23713.938 -17809.913  24.9%  2255 2140s
  9552  2564 -19704.572   16  292 -23713.938 -17850.900  24.7%  2249 2208s
 10039  2565 -19351.009   16  593 -23713.938 -17988.027  24.1%  2247 2445s
 10041  2566 -18568.383    9  382 -23713.938 -17988.027  24.1%  2247 2518s
 10042  2567 -18568.383    9  543 -23713.938 -17988.027  24.1%  2246 2561s
 10043  2568 -21463.304   14  538 -23713.938 -17988.027  24.1%  2246 2583s
 10044  2568 -18557.248   17  559 -23713.938 -17988.027  24.1%  2246 2600s
 10045  2569 -18518.287   14  570 -23713.938 -17988.027  24.1%  2246 2613s
 10046  2570 -18634.167   10  562 -23713.938 -17988.027  24.1%  2245 2622s
 10047  2570 -21388.099   21  583 -23713.938 -17988.027  24.1%  2245 2630s
 10048  2571 -22020.190   12  572 -23713.938 -17988.027  24.1%  2245 2641s
 10049  2572 -18480.636   20  571 -23713.938 -17988.027  24.1%  2245 2646s
 10050  2572 -20330.459   12  577 -23713.938 -17988.027  24.1%  2245 2652s
 10051  2573 -18614.340   16  615 -23713.938 -17988.027  24.1%  2244 2666s
 10052  2574 -22380.141   17  651 -23713.938 -17988.027  24.1%  2244 2672s
 10053  2574 -18680.199   18  587 -23713.938 -17988.027  24.1%  2244 2679s
 10054  2575 -20529.526    9  611 -23713.938 -17988.027  24.1%  2244 2691s
 10055  2576 -22095.073   15  611 -23713.938 -17988.027  24.1%  2243 2697s
 10056  2576 -22906.999   18  611 -23713.938 -17988.027  24.1%  2243 2703s
 10057  2577 -19246.342   13  615 -23713.938 -17988.027  24.1%  2243 2717s
 10058  2578 -20763.294   24  686 -23713.938 -17988.027  24.1%  2243 2727s
 10059  2578 -23547.047   37  617 -23713.938 -17988.027  24.1%  2243 2738s
 10060  2579 -20215.030   13  628 -23713.938 -17988.027  24.1%  2242 2747s
 10061  2580 -19545.510   14  626 -23713.938 -17988.027  24.1%  2242 2759s
 10062  2580 -18703.709   13  626 -23713.938 -17988.027  24.1%  2242 2833s
 10063  2581 -22890.148   19  626 -23713.938 -17988.027  24.1%  2242 2883s
 10064  2585 -17988.027   13  609 -23713.938 -17988.027  24.1%  2264 2898s
 10066  2588 -17988.027   14  593 -23713.938 -17988.027  24.1%  2264 2913s
 10070  2594 -17988.027   15  518 -23713.938 -17988.027  24.1%  2266 2936s
 10077  2606 -17988.027   16  282 -23713.938 -17988.027  24.1%  2268 2964s
 10092  2602     cutoff   17      -23713.938 -17988.027  24.1%  2278 2997s
 10110  2612 -17988.027   18  356 -23713.938 -17988.027  24.1%  2293 3028s
 10137  2699 -17988.027   19  265 -23713.938 -17988.027  24.1%  2308 3066s
 10238  2694 -17988.027   23  339 -23713.938 -17988.027  24.1%  2341 3084s
 10273  2713 -18034.950   24  434 -23713.938 -17988.027  24.1%  2344 3107s
 10332  2724 -18971.027   25  344 -23713.938 -17988.027  24.1%  2343 3143s
 10416  2724 -19475.603   26  399 -23713.938 -17988.027  24.1%  2345 3174s
 10492  2724 -21038.236   28  280 -23713.938 -17988.027  24.1%  2349 3193s
 10555  2756 -21648.132   30  304 -23713.938 -17988.027  24.1%  2354 3209s
 10627  2730 -21864.588   34  264 -23713.938 -17988.027  24.1%  2357 3226s
 10716  2713     cutoff   38      -23713.938 -17988.027  24.1%  2354 3246s
 10775  2713 -18502.988   22  345 -23713.938 -17988.027  24.1%  2355 3262s
 10850  2690 -18907.305   23  254 -23713.938 -17988.027  24.1%  2357 3288s
 10913  2676 -19519.325   24  376 -23713.938 -17988.027  24.1%  2356 3312s
 10980  2678 -19650.495   25  373 -23713.938 -17988.027  24.1%  2357 3332s
 11055  2674 -20821.903   27  406 -23713.938 -17988.027  24.1%  2359 3351s
 11129  2665 -21086.177   30  312 -23713.938 -17988.027  24.1%  2359 3369s
 11173  2660 -21191.783   32  177 -23713.938 -17988.027  24.1%  2358 3387s
 11239  2663 -23449.551   35  293 -23713.938 -17988.027  24.1%  2360 3411s
 11316  2661 -22845.802   22  237 -23713.938 -17988.027  24.1%  2361 3434s
 11404  2658     cutoff   23      -23713.938 -17988.027  24.1%  2363 3456s
 11496  2666 -22416.615   22  363 -23713.938 -17988.027  24.1%  2367 3477s
 11570  2672 -23313.251   23  405 -23713.938 -17988.027  24.1%  2372 3507s
 11666  2670 -23319.137   24  340 -23713.938 -17988.027  24.1%  2374 3533s
 11779  2656 -20225.064   22  623 -23713.938 -17988.027  24.1%  2377 3563s
 11899  2649 -20290.684   23  341 -23713.938 -17988.027  24.1%  2379 3588s
 12013  2619 -21256.225   25  274 -23713.938 -17988.027  24.1%  2381 3600s

Cutting planes:
  MIR: 595
  Flow cover: 1694
  Zero half: 17
  RLT: 28
  Relax-and-lift: 61

Explored 12055 nodes (28919485 simplex iterations) in 3600.06 seconds (6066.83 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -23713.9 -23725.5 -23750.9 ... -24671.9

Time limit reached
Best objective -2.371393795121e+04, best bound -1.798802688358e+04, gap 24.1458%
  WARNING: Time limit reached. Using best solution found (gap: 24.15%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = -23713.94, θ = 100805.06
  Upper Bound (UB) = -23713.94

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 100805.06
  [DEBUG]   ✓ Scenario 0: θ = 100805.06 ≤ Q = 100805.06 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 100805.06 ≤ Q = 100805.06 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 100805.06 ≤ Q = 100805.06 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 100805.06 ≤ Q = 100805.06 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 100805.06 ≤ Q = 100805.06 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 100805.06 ≤ Q = 100805.06 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 100805.06 ≤ Q = 100805.06 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x6856d916
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x6856d916
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.260460e+13
Presolve removed 2553 rows and 1846 columns
Presolve time: 0.01s
Presolved: 540 rows, 543 columns, 1523 nonzeros
Found heuristic solution: objective 6865123.0175
Variable types: 367 continuous, 176 integer (176 binary)

Root relaxation: objective -1.275326e+05, 252 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -127532.59    0  124 6865123.02 -127532.59   102%     -    0s
H    0     0                    -89037.63646 -127532.59  43.2%     -    0s
H    0     0                    -89639.09879 -127532.59  42.3%     -    0s
     0     0 -95081.072    0   87 -89639.099 -95081.072  6.07%     -    0s
H    0     0                    -92169.88851 -95050.580  3.13%     -    0s
H    0     0                    -92492.28959 -95050.580  2.77%     -    0s
H    0     0                    -93154.29473 -95050.580  2.04%     -    0s
H    0     0                    -93476.69580 -95050.580  1.68%     -    0s
     0     0 -94774.383    0   88 -93476.696 -94774.383  1.39%     -    0s
H    0     0                    -93511.43384 -94731.926  1.31%     -    0s
     0     0 -94731.926    0   88 -93511.434 -94731.926  1.31%     -    0s
     0     0 -94624.297    0   89 -93511.434 -94624.297  1.19%     -    0s
     0     0 -94612.074    0   89 -93511.434 -94612.074  1.18%     -    0s
     0     2 -94608.759    0   89 -93511.434 -94608.759  1.17%     -    0s
H   37    20                    -94234.03518 -94385.856  0.16%   8.8    0s
*   83     0              16    -94237.49067 -94248.202  0.01%   6.7    0s

Cutting planes:
  Gomory: 19
  MIR: 154
  RLT: 2

Explored 87 nodes (1062 simplex iterations) in 0.15 seconds (0.06 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -94237.5 -94234 -93511.4 ... 1.26046e+13
No other solutions better than -94237.5

Optimal solution found (tolerance 1.00e-04)
Best objective -9.423749067088e+04, best bound -9.423749067088e+04, gap 0.0000%
  Subproblem solved in 0.19s
  Worst-case operational profit (Z_SP) = 99206.22
  Scenario: 7 demand increases, 53 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -94237.49
  [DEBUG]   S×d_nominal = 193443.71
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 193443.71 + -94237.49 = 99206.22
  [DEBUG]   Current θ from Master = 100805.06
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1598.84 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -25312.78
  Lower Bound (LB) = -24370.17
  Gap (UB-LB) = 656.2366, Absolute Gap = 656.2366, Relative Gap = 0.027673
  Not converged yet (gap = 656.24 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 7 increases, 53 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351559 nonzeros
Model fingerprint: 0x1c685ddf
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 50196 rows and 20386 columns
Presolve time: 2.18s
Presolved: 73507 rows, 31794 columns, 457939 nonzeros
Variable types: 29535 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -362049.1746
Found heuristic solution: objective -192025.5558

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 73507 rows, 31794 columns, 457939 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   19648   -1.7774027e+05   0.000000e+00   2.130147e+06      5s
   31392   -7.5215308e+04   0.000000e+00   2.627910e+09     10s
   38740   -4.4543290e+04   0.000000e+00   5.959611e+07     15s
   45651   -2.3070705e+04   0.000000e+00   1.410037e+07     20s
   50636   -2.1920858e+04   0.000000e+00   2.033229e+07     25s
   54622   -2.1594253e+04   0.000000e+00   3.245358e+06     30s
   58378   -2.1223458e+04   0.000000e+00   1.016773e+07     35s
   62191   -2.0597336e+04   0.000000e+00   1.457124e+07     40s
   65446   -2.0531655e+04   0.000000e+00   2.609800e+06     45s
   68795   -2.0157506e+04   0.000000e+00   1.301435e+07     50s
   72038   -1.9982574e+04   0.000000e+00   1.996004e+08     55s
Concurrent spin time: 0.32s

Solved with dual simplex

Root relaxation: objective -4.963704e+03, 56430 iterations, 55.92 seconds (77.98 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -4963.7044    0  383 -192025.56 -4963.7044  97.4%     -   59s
H    0     0                    -172638.9008 -4963.7044  97.1%     -   59s
H    0     0                    -91942.70022 -4963.7044  94.6%     -   59s
H    0     0                    -60871.79843 -4963.7044  91.8%     -   59s
H    0     0                    -33188.38017 -4963.7044  85.0%     -   59s
H    0     0                    -32631.11781 -4963.7044  84.8%     -   60s
H    0     0                    -32624.58542 -4963.7044  84.8%     -   60s
H    0     0                    -32600.73948 -4963.7044  84.8%     -   60s
H    0     0                    -25315.42113 -4963.7044  80.4%     -   62s
H    0     0                    -25082.05051 -4963.7044  80.2%     -   62s
H    0     0                    -23956.75473 -4963.7044  79.3%     -   62s
H    0     0                    -23842.17386 -4963.7044  79.2%     -   62s
     0     0 -7547.0702    0  381 -23842.174 -7547.0702  68.3%     -   98s
H    0     0                    -23822.91781 -7547.0702  68.3%     -   99s
H    0     0                    -23758.80732 -7547.0702  68.2%     -   99s
     0     0 -7745.8251    0  461 -23758.807 -7745.8251  67.4%     -  108s
     0     0 -7745.8251    0  462 -23758.807 -7745.8251  67.4%     -  114s
     0     0 -7745.8251    0  463 -23758.807 -7745.8251  67.4%     -  115s
     0     0 -7745.8251    0  468 -23758.807 -7745.8251  67.4%     -  124s
     0     0 -7745.8251    0  478 -23758.807 -7745.8251  67.4%     -  128s
     0     0 -9809.5588    0  483 -23758.807 -9809.5588  58.7%     -  130s
     0     0 -9809.5588    0  471 -23758.807 -9809.5588  58.7%     -  136s
     0     0 -9809.5588    0  470 -23758.807 -9809.5588  58.7%     -  137s
     0     0 -9809.5588    0  467 -23758.807 -9809.5588  58.7%     -  137s
     0     0 -9809.5588    0  466 -23758.807 -9809.5588  58.7%     -  138s
     0     0 -9809.5588    0  466 -23758.807 -9809.5588  58.7%     -  138s
     0     0 -9809.5588    0  466 -23758.807 -9809.5588  58.7%     -  138s
     0     0 -9809.5588    0  496 -23758.807 -9809.5588  58.7%     -  161s
     0     0 -9984.2089    0  500 -23758.807 -9984.2089  58.0%     -  172s
     0     0 -10018.714    0  493 -23758.807 -10018.714  57.8%     -  176s
     0     0 -10161.189    0  500 -23758.807 -10161.189  57.2%     -  187s
     0     0 -10215.770    0  512 -23758.807 -10215.770  57.0%     -  193s
     0     0 -10393.947    0  496 -23758.807 -10393.947  56.3%     -  207s
     0     0 -10484.329    0  555 -23758.807 -10484.329  55.9%     -  217s
     0     0 -10487.616    0  507 -23758.807 -10487.616  55.9%     -  219s
     0     0 -10497.425    0  491 -23758.807 -10497.425  55.8%     -  223s
     0     0 -10611.766    0  548 -23758.807 -10611.766  55.3%     -  230s
     0     0 -10629.573    0  552 -23758.807 -10629.573  55.3%     -  233s
     0     0 -10632.149    0  550 -23758.807 -10632.149  55.2%     -  235s
     0     0 -10632.223    0  550 -23758.807 -10632.223  55.2%     -  236s
     0     0 -11212.324    0  504 -23758.807 -11212.324  52.8%     -  265s
     0     0 -11356.579    0  517 -23758.807 -11356.579  52.2%     -  275s
     0     0 -11390.514    0  523 -23758.807 -11390.514  52.1%     -  278s
     0     0 -11393.555    0  532 -23758.807 -11393.555  52.0%     -  280s
     0     0 -11543.461    0  521 -23758.807 -11543.461  51.4%     -  285s
     0     0 -11576.423    0  521 -23758.807 -11576.423  51.3%     -  290s
     0     0 -11590.984    0  524 -23758.807 -11590.984  51.2%     -  293s
     0     0 -11596.440    0  531 -23758.807 -11596.440  51.2%     -  294s
     0     0 -11599.528    0  526 -23758.807 -11599.528  51.2%     -  296s
     0     0 -11599.730    0  524 -23758.807 -11599.730  51.2%     -  296s
     0     0 -12025.570    0  541 -23758.807 -12025.570  49.4%     -  317s
H    0     0                    -23758.64343 -12025.581  49.4%     -  318s
     0     0 -12287.500    0  548 -23758.643 -12287.500  48.3%     -  332s
     0     0 -12346.592    0  547 -23758.643 -12346.592  48.0%     -  339s
     0     0 -12367.681    0  563 -23758.643 -12367.681  47.9%     -  341s
     0     0 -12391.688    0  569 -23758.643 -12391.688  47.8%     -  346s
     0     0 -12410.979    0  568 -23758.643 -12410.979  47.8%     -  349s
     0     0 -12413.943    0  562 -23758.643 -12413.943  47.7%     -  350s
     0     0 -12414.508    0  561 -23758.643 -12414.508  47.7%     -  351s
     0     0 -12520.568    0  566 -23758.643 -12520.568  47.3%     -  358s
     0     0 -12556.719    0  596 -23758.643 -12556.719  47.1%     -  363s
     0     0 -12567.476    0  583 -23758.643 -12567.476  47.1%     -  365s
     0     0 -12571.979    0  585 -23758.643 -12571.979  47.1%     -  366s
     0     0 -12572.765    0  586 -23758.643 -12572.765  47.1%     -  367s
     0     0 -12644.666    0  587 -23758.643 -12644.666  46.8%     -  377s
H    0     0                    -23754.11156 -12644.829  46.8%     -  379s
     0     0 -12675.309    0  589 -23754.112 -12675.309  46.6%     -  384s
     0     0 -12685.493    0  601 -23754.112 -12685.493  46.6%     -  387s
     0     0 -12687.043    0  607 -23754.112 -12687.043  46.6%     -  388s
     0     0 -12687.192    0  605 -23754.112 -12687.192  46.6%     -  389s
     0     0 -12769.550    0  597 -23754.112 -12769.550  46.2%     -  398s
     0     0 -12789.628    0  596 -23754.112 -12789.628  46.2%     -  404s
     0     0 -12794.916    0  595 -23754.112 -12794.916  46.1%     -  407s
     0     0 -12798.550    0  596 -23754.112 -12798.550  46.1%     -  408s
     0     0 -12800.114    0  605 -23754.112 -12800.114  46.1%     -  410s
     0     0 -12800.319    0  606 -23754.112 -12800.319  46.1%     -  411s
     0     0 -12814.323    0  588 -23754.112 -12814.323  46.1%     -  415s
H    0     0                    -23748.93484 -12815.109  46.0%     -  416s
     0     0 -12817.040    0  606 -23748.935 -12817.040  46.0%     -  417s
     0     0 -12818.542    0  602 -23748.935 -12818.542  46.0%     -  418s
     0     0 -12820.576    0  605 -23748.935 -12820.576  46.0%     -  419s
     0     0 -12821.376    0  608 -23748.935 -12821.376  46.0%     -  420s
     0     0 -12854.775    0  595 -23748.935 -12854.775  45.9%     -  428s
     0     0 -12890.060    0  646 -23748.935 -12890.060  45.7%     -  435s
     0     0 -12914.692    0  605 -23748.935 -12914.692  45.6%     -  438s
     0     0 -12920.198    0  615 -23748.935 -12920.198  45.6%     -  440s
     0     0 -12923.328    0  619 -23748.935 -12923.328  45.6%     -  441s
     0     0 -12923.842    0  620 -23748.935 -12923.842  45.6%     -  442s
     0     0 -12943.222    0  656 -23748.935 -12943.222  45.5%     -  447s
     0     0 -12945.436    0  657 -23748.935 -12945.436  45.5%     -  451s
     0     0 -12947.363    0  652 -23748.935 -12947.363  45.5%     -  452s
     0     0 -12947.671    0  659 -23748.935 -12947.671  45.5%     -  453s
     0     0 -12963.118    0  647 -23748.935 -12963.118  45.4%     -  458s
     0     0 -12965.817    0  608 -23748.935 -12965.817  45.4%     -  461s
     0     0 -12966.601    0  610 -23748.935 -12966.601  45.4%     -  462s
     0     0 -12970.484    0  612 -23748.935 -12970.484  45.4%     -  465s
     0     0 -12971.226    0  610 -23748.935 -12971.226  45.4%     -  467s
     0     0 -12973.976    0  613 -23748.935 -12973.976  45.4%     -  470s
     0     0 -12974.404    0  621 -23748.935 -12974.404  45.4%     -  471s
     0     0 -12975.761    0  616 -23748.935 -12975.761  45.4%     -  474s
     0     0 -12975.888    0  616 -23748.935 -12975.888  45.4%     -  479s
     0     2 -12975.917    0  616 -23748.935 -12975.917  45.4%     -  614s
     1     4 -13008.720    1  612 -23748.935 -12976.208  45.4%  2000  625s
     3     8 -13011.724    2  612 -23748.935 -13009.178  45.2%  3368  651s
     7    16 -13029.913    3  607 -23748.935 -13011.756  45.2%  6485  671s
    15    32 -13122.221    4  612 -23748.935 -13031.124  45.1%  6606  697s
    31    52 -15559.160    5  292 -23748.935 -13122.300  44.7%  9773  733s
    51    84 -13975.168    6  607 -23748.935 -13122.300  44.7%  9497  750s
    83   116 -14041.262    7  581 -23748.935 -13122.300  44.7%  7323  773s
   115   194 -14089.624    8  546 -23748.935 -13122.300  44.7%  6150  795s
   200   235 -16072.761   11  271 -23748.935 -13122.300  44.7%  4351  813s
   264   267 -14312.502   10  528 -23748.935 -13122.300  44.7%  3674  832s
   319   286 -14221.728   11  569 -23748.935 -13122.300  44.7%  3530  848s
   368   311 -15572.349   12  311 -23748.935 -13122.300  44.7%  3369  867s
   429   348 -15777.154   13  391 -23748.935 -13122.300  44.7%  3223  885s
   486   385 -16507.924   12  420 -23748.935 -13122.300  44.7%  3137  901s
   547   414 -16546.061   12  272 -23748.935 -13122.300  44.7%  3056  919s
   623   441 -18317.654   12  264 -23748.935 -13122.300  44.7%  2946  939s
   682   466 -16890.781   13  475 -23748.935 -13122.300  44.7%  2929  958s
   727   502 -16636.389   13  261 -23748.935 -13122.300  44.7%  2935  977s
   791   524 -18814.331   14  261 -23748.935 -13122.300  44.7%  2887  992s
   836   561 -19994.371   13  205 -23748.935 -13122.300  44.7%  2904 1008s
   905   586 -18373.050   13  260 -23748.935 -13122.300  44.7%  2850 1024s
   960   626 -19867.272   15  174 -23748.935 -13122.300  44.7%  2837 1041s
  1027   668 -20633.342   17  298 -23748.935 -13122.300  44.7%  2817 1056s
  1103   704 -21028.146   20  218 -23748.935 -13122.300  44.7%  2751 1073s
  1205   731 -22645.764   24  145 -23748.935 -13122.300  44.7%  2667 1093s
  1317   771 -23228.774   26  202 -23748.935 -13122.300  44.7%  2566 1115s
  1429   797     cutoff   25      -23748.935 -13122.300  44.7%  2509 1133s
  1507   855     cutoff   28      -23748.935 -13122.300  44.7%  2488 1155s
  1608   907 -19766.378   10  136 -23748.935 -13122.300  44.7%  2462 1176s
  1717   955 -20999.747   12  143 -23748.935 -13463.598  43.3%  2443 1199s
  1844  1014 -17671.866   13  284 -23748.935 -13467.984  43.3%  2419 1224s
  1968  1040 -18186.267   16  276 -23748.935 -13467.984  43.3%  2386 1250s
  2088  1072 -18738.173   17  286 -23748.935 -13467.984  43.3%  2368 1276s
  2172  1100 -19848.573   19  278 -23748.935 -13467.984  43.3%  2396 1298s
  2239  1143 -22572.733   20  102 -23748.935 -13467.984  43.3%  2417 1324s
  2324  1188     cutoff   22      -23748.935 -13467.984  43.3%  2424 1353s
  2425  1241 -20516.621    9  153 -23748.935 -13467.984  43.3%  2433 1380s
  2545  1285 -20973.174   11  156 -23748.935 -13467.984  43.3%  2425 1411s
  2678  1338     cutoff   14      -23748.935 -14300.858  39.8%  2422 1444s
  2798  1396 -20712.794   10  159 -23748.935 -14300.858  39.8%  2439 1479s
  2945  1439 -18803.870   13  304 -23748.935 -15000.446  36.8%  2443 1518s
  3071  1471 -20404.174   15  276 -23748.935 -15035.000  36.7%  2468 1554s
  3183  1504 -22974.127   18  253 -23748.935 -15035.000  36.7%  2504 1589s
  3337  1582 -17019.720   13  453 -23748.935 -15035.000  36.7%  2527 1628s
  3498  1632 -19329.671   16  279 -23748.935 -15035.000  36.7%  2536 1666s
  3633  1688 infeasible   20      -23748.935 -15071.349  36.5%  2530 1705s
  3804  1700     cutoff   19      -23748.935 -15087.339  36.5%  2529 1739s
  3856  1716 -16636.017    6  501 -23748.935 -15087.339  36.5%  2549 1768s
  3905  1731 -16751.146    6  480 -23748.935 -15087.339  36.5%  2556 1802s
  3982  1771 -17015.157    7  389 -23748.935 -15087.339  36.5%  2554 1846s
  4082  1820 -17308.401    8  374 -23748.935 -15087.339  36.5%  2562 1893s
  4245  1876 -18677.521   10  367 -23748.935 -15756.827  33.7%  2576 1938s
  4410  1960 -20119.842   15  395 -23748.935 -15833.809  33.3%  2600 1988s
  4639  1984     cutoff   16      -23748.935 -15978.257  32.7%  2608 2037s
  4782  2070     cutoff   20      -23748.935 -15999.385  32.6%  2615 2093s
  4988  2134     cutoff   13      -23748.935 -16078.690  32.3%  2631 2153s
  5180  2188 -22266.789   13   91 -23748.935 -16127.627  32.1%  2640 2213s
  5399  2257 -18937.652   15  359 -23748.935 -16135.530  32.1%  2653 2276s
  5640  2333 -22662.463   22  240 -23748.935 -16214.915  31.7%  2669 2335s
  5881  2334 -22323.714   14  616 -23748.935 -16308.343  31.3%  2736 2581s
  5883  2335 -18948.953    9  383 -23748.935 -16308.343  31.3%  2735 2686s
  5884  2336 -21576.838   26  540 -23748.935 -16308.343  31.3%  2734 2745s
  5885  2337 -21986.474   19  521 -23748.935 -16308.343  31.3%  2734 2786s
  5886  2337 -21594.432   25  631 -23748.935 -16308.343  31.3%  2734 2816s
  5887  2338 -18257.136   11  655 -23748.935 -16308.343  31.3%  2733 2833s
  5888  2339 -17418.027   15  601 -23748.935 -16308.343  31.3%  2733 2847s
  5889  2339 -23644.891   33  602 -23748.935 -16308.343  31.3%  2732 2860s
  5890  2340 -20826.548   12  565 -23748.935 -16308.343  31.3%  2732 2871s
  5891  2341 -21093.974   12  597 -23748.935 -16308.343  31.3%  2731 2878s
  5892  2341 -20129.702   12  611 -23748.935 -16308.343  31.3%  2731 2885s
  5893  2342 -18306.478   15  641 -23748.935 -16308.343  31.3%  2730 2907s
  5894  2343 -20472.603   19  599 -23748.935 -16308.343  31.3%  2730 2919s
  5895  2343 -20725.460   21  610 -23748.935 -16308.343  31.3%  2729 2930s
  5896  2344 -18051.907   20  609 -23748.935 -16308.343  31.3%  2729 2937s
  5897  2345 -23526.845   21  647 -23748.935 -16308.343  31.3%  2728 2956s
  5898  2345 -19082.393   17  606 -23748.935 -16308.343  31.3%  2728 2965s
  5899  2346 -17110.495   16  649 -23748.935 -16308.343  31.3%  2727 2975s
  5900  2347 -19324.265   19  606 -23748.935 -16308.343  31.3%  2727 2988s
  5901  2347 -16877.519   10  612 -23748.935 -16308.343  31.3%  2727 3000s
  5902  2348 -19884.677   11  610 -23748.935 -16308.343  31.3%  2726 3015s
  5903  2349 -16843.496   15  627 -23748.935 -16308.343  31.3%  2726 3024s
  5904  2349 -18434.388   15  660 -23748.935 -16308.343  31.3%  2725 3042s
  5905  2350 -21904.496   18  688 -23748.935 -16308.343  31.3%  2725 3053s
  5906  2351 -19417.149    8  615 -23748.935 -16308.343  31.3%  2724 3066s
  5907  2351 -21216.790   21  615 -23748.935 -16308.343  31.3%  2724 3167s
  5908  2352 -16743.502   14  615 -23748.935 -16308.343  31.3%  2723 3232s
  5909  2356 -16308.343   14  607 -23748.935 -16308.343  31.3%  2767 3287s
  5911  2359 -16308.343   15  615 -23748.935 -16308.343  31.3%  2769 3323s
  5915  2366 -16308.343   16  595 -23748.935 -16308.343  31.3%  2771 3376s
  5923  2379 -16308.343   17  609 -23748.935 -16308.343  31.3%  2779 3430s
  5939  2391 -19966.773   18  187 -23748.935 -16308.343  31.3%  2813 3600s

Cutting planes:
  MIR: 497
  Flow cover: 1391
  Zero half: 18
  RLT: 12
  Relax-and-lift: 76

Explored 5956 nodes (17285370 simplex iterations) in 3600.05 seconds (5498.56 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -23748.9 -23754.1 -23758.6 ... -32600.7

Time limit reached
Best objective -2.374893483664e+04, best bound -1.630834253552e+04, gap 31.3302%
  WARNING: Time limit reached. Using best solution found (gap: 31.33%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = -23748.93, θ = 100730.20
  Upper Bound (UB) = -23748.93

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 100730.20
  [DEBUG]   ✓ Scenario 0: θ = 100730.20 ≤ Q = 100730.20 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 100730.20 ≤ Q = 100730.20 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 100730.20 ≤ Q = 100730.20 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 100730.20 ≤ Q = 100730.20 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 100730.20 ≤ Q = 100730.20 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 100730.20 ≤ Q = 100730.20 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 100730.20 ≤ Q = 100730.20 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 100730.20 ≤ Q = 100730.20 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x1a5b57cc
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x1a5b57cc
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.253618e+13
Presolve removed 2553 rows and 1846 columns
Presolve time: 0.01s
Presolved: 540 rows, 543 columns, 1523 nonzeros
Found heuristic solution: objective 6849479.5516
Variable types: 367 continuous, 176 integer (176 binary)

Root relaxation: objective -1.272784e+05, 252 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -127278.44    0  124 6849479.55 -127278.44   102%     -    0s
H    0     0                    -88816.86733 -127278.44  43.3%     -    0s
H    0     0                    -89435.07130 -127278.44  42.3%     -    0s
H    0     0                    -94604.46321 -95130.129  0.56%     -    0s
     0     0 -95130.129    0   34 -94604.463 -95130.129  0.56%     -    0s
     0     0 -95092.626    0   33 -94604.463 -95092.626  0.52%     -    0s
H    0     0                    -94812.93860 -95092.626  0.29%     -    0s
     0     0 -94930.604    0   31 -94812.939 -94930.604  0.12%     -    0s
     0     0 -94930.604    0   22 -94812.939 -94930.604  0.12%     -    0s
     0     0 -94930.604    0   17 -94812.939 -94930.604  0.12%     -    0s
     0     0 -94930.604    0   12 -94812.939 -94930.604  0.12%     -    0s
     0     0 -94834.398    0    9 -94812.939 -94834.398  0.02%     -    0s
     0     0 -94826.591    0    6 -94812.939 -94826.591  0.01%     -    0s
     0     0 -94824.974    0    5 -94812.939 -94824.974  0.01%     -    0s

Cutting planes:
  Gomory: 1
  Implied bound: 2
  MIR: 4
  Flow cover: 2
  RLT: 1

Explored 1 nodes (481 simplex iterations) in 0.20 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 6: -94812.9 -94604.5 -89435.1 ... 1.25362e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -9.481293860430e+04, best bound -9.481783091805e+04, gap 0.0052%
  Subproblem solved in 0.25s
  Worst-case operational profit (Z_SP) = 98394.09
  Scenario: 10 demand increases, 50 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -94812.94
  [DEBUG]   S×d_nominal = 193207.03
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 193207.03 + -94812.94 = 98394.09
  [DEBUG]   Current θ from Master = 100730.20
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2336.11 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -26085.04
  Lower Bound (LB) = -24370.17
  Gap (UB-LB) = 621.2397, Absolute Gap = 621.2397, Relative Gap = 0.026159
  Not converged yet (gap = 621.24 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 10 increases, 50 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394814 nonzeros
Model fingerprint: 0xa18e9ec5
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 56478 rows and 22938 columns
Presolve time: 2.98s
Presolved: 82515 rows, 35482 columns, 503795 nonzeros
Variable types: 33223 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -362146.8008
Found heuristic solution: objective -192025.5558

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.24s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.400e+06
 Factor NZ  : 7.392e+06 (roughly 100 MB of memory)
 Factor Ops : 1.200e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.30273562e+07  1.45534610e+08  7.29e+04 2.73e+01  5.66e+04     5s
   1  -9.65572131e+06  1.22622199e+08  5.03e+04 6.59e+01  3.89e+04     5s
   2  -3.75952819e+06  9.64557204e+07  1.83e+04 2.97e+01  1.46e+04     5s
   3  -7.76868096e+05  5.92962276e+07  1.30e+03 5.19e-01  1.34e+03     5s
   4  -5.12050458e+05  2.11807186e+07  3.87e+02 8.59e-02  3.91e+02     5s
   5  -3.73487108e+05  1.49919013e+07  1.75e+02 5.30e-02  2.05e+02     5s
   6  -2.34827789e+05  1.10528757e+07  6.49e+01 3.41e-02  1.09e+02     5s
   7  -1.68983996e+05  7.99703474e+06  3.75e+01 2.26e-02  7.06e+01     5s
   8  -1.14705954e+05  4.73714523e+06  1.47e+01 1.20e-02  3.65e+01     5s
   9  -1.03221444e+05  2.57113689e+06  1.01e+01 6.13e-03  1.96e+01     5s
  10  -8.85054849e+04  1.14994315e+06  6.60e+00 2.50e-03  8.85e+00     5s
  11  -6.17107691e+04  3.03691621e+05  2.32e+00 6.72e-04  2.50e+00     5s
  12  -4.74097533e+04  1.29781430e+05  1.48e+00 6.49e-04  1.20e+00     5s
  13  -3.71176306e+04  7.63646603e+04  1.05e+00 1.45e-03  7.68e-01     6s
  14  -3.00584724e+04  4.93224774e+04  8.24e-01 3.19e-03  5.37e-01     6s
  15  -2.61462051e+04  3.77641129e+04  7.08e-01 2.62e-03  4.32e-01     6s
  16  -1.94916113e+04  2.65424806e+04  5.14e-01 1.45e-03  3.11e-01     6s
  17  -1.56546297e+04  1.75594190e+04  4.05e-01 1.63e-03  2.24e-01     6s
  18  -1.25566966e+04  1.14042877e+04  3.25e-01 1.92e-03  1.62e-01     6s
  19  -1.03138213e+04  7.82961948e+03  2.66e-01 2.09e-03  1.23e-01     6s
  20  -7.93172771e+03  6.50939543e+03  2.04e-01 2.39e-03  9.77e-02     6s
  21  -6.29256590e+03  4.69903320e+03  1.59e-01 3.49e-03  7.44e-02     6s
  22  -4.92065538e+03  3.28486136e+03  1.25e-01 3.12e-03  5.56e-02     6s
  23  -4.06808849e+03  2.41765238e+03  1.04e-01 2.32e-03  4.40e-02     6s
  24  -3.22741831e+03  2.19162237e+03  8.47e-02 2.02e-03  3.67e-02     6s
  25  -2.71587115e+03  1.72332802e+03  7.29e-02 1.59e-03  3.01e-02     7s
  26  -2.34225510e+03  1.34769553e+03  6.40e-02 1.72e-03  2.51e-02     7s
  27  -1.83793387e+03  1.11155167e+03  5.20e-02 1.27e-03  2.00e-02     7s
  28  -1.58836032e+03  9.37302185e+02  4.60e-02 8.88e-04  1.72e-02     7s
  29  -1.27599502e+03  8.67962445e+02  3.89e-02 9.92e-04  1.46e-02     7s
  30  -8.82312192e+02  7.64970605e+02  2.97e-02 8.55e-04  1.12e-02     7s
  31  -3.82102973e+02  7.08595717e+02  1.81e-02 7.50e-04  7.39e-03     7s
  32  -1.41405496e+02  5.93839212e+02  1.26e-02 8.94e-04  4.99e-03     7s
  33   3.48108376e+01  5.23879135e+02  8.64e-03 9.48e-04  3.32e-03     7s
  34   1.09116591e+02  5.07697544e+02  7.05e-03 7.53e-04  2.71e-03     7s
  35   1.48330327e+02  4.99905931e+02  6.16e-03 6.71e-04  2.39e-03     7s
  36   2.08079083e+02  4.88304990e+02  4.77e-03 5.48e-04  1.90e-03     7s
  37   2.78275912e+02  4.76115636e+02  3.20e-03 3.98e-04  1.34e-03     7s
  38   2.87056193e+02  4.63635279e+02  3.00e-03 2.93e-04  1.20e-03     8s
  39   3.27403049e+02  4.55863114e+02  2.13e-03 2.44e-04  8.71e-04     8s
  40   3.39485620e+02  4.49250280e+02  1.87e-03 1.91e-04  7.45e-04     8s
  41   3.45424711e+02  4.48351802e+02  1.74e-03 1.84e-04  6.98e-04     8s
  42   3.55159466e+02  4.38244041e+02  1.54e-03 1.61e-04  5.65e-04     8s
  43   3.73947071e+02  4.36617336e+02  1.14e-03 1.31e-04  4.26e-04     8s
  44   3.89050415e+02  4.33386981e+02  8.09e-04 8.15e-05  3.01e-04     8s
  45   4.05418713e+02  4.32134497e+02  4.61e-04 6.53e-05  1.81e-04     8s
  46   4.09818857e+02  4.31065703e+02  3.66e-04 4.99e-05  1.44e-04     8s
  47   4.11655978e+02  4.30004263e+02  3.26e-04 3.48e-05  1.25e-04     9s
  48   4.16395280e+02  4.28902097e+02  2.24e-04 1.81e-05  8.49e-05     9s
  49   4.20273585e+02  4.28826271e+02  1.43e-04 1.67e-05  5.80e-05     9s
  50   4.23725343e+02  4.27804129e+02  6.99e-05 6.03e-06  2.77e-05     9s
  51   4.26091471e+02  4.27428918e+02  2.04e-05 2.61e-06  9.04e-06     9s
  52   4.26594794e+02  4.27298636e+02  1.05e-05 1.23e-06  4.76e-06     9s
  53   4.26649633e+02  4.27286313e+02  9.47e-06 1.12e-06  4.30e-06     9s
  54   4.26752063e+02  4.27275537e+02  7.65e-06 9.99e-07  3.54e-06     9s
  55   4.26752259e+02  4.27275492e+02  7.64e-06 9.98e-07  3.53e-06     9s
  56   4.26900947e+02  4.27262914e+02  4.88e-06 8.64e-07  2.44e-06     9s
  57   4.26954402e+02  4.27192063e+02  3.94e-06 4.24e-07  1.61e-06    10s
  58   4.26955141e+02  4.27187585e+02  1.05e-05 5.14e-06  1.57e-06    10s
  59   4.26955774e+02  4.27186893e+02  1.05e-05 4.85e-06  1.56e-06    10s
  60   4.27013614e+02  4.27185121e+02  1.26e-05 4.12e-06  1.16e-06    10s
  61   4.27035950e+02  4.27184747e+02  2.52e-05 3.96e-06  9.98e-07    10s
  62   4.27056872e+02  4.27184518e+02  2.20e-05 3.68e-06  8.56e-07    10s
  63   4.27105984e+02  4.27182021e+02  1.52e-05 1.83e-06  5.13e-07    10s
  64   4.27112254e+02  4.27181425e+02  1.43e-05 1.59e-06  4.68e-07    10s
  65   4.27117467e+02  4.27181165e+02  8.59e-06 1.34e-06  4.34e-07    11s
  66   4.27118270e+02  4.27180171e+02  8.52e-06 1.01e-06  4.22e-07    11s
  67   4.27120774e+02  4.27179878e+02  8.30e-06 9.06e-07  4.03e-07    11s
  68   4.27121155e+02  4.27179873e+02  8.93e-06 9.23e-07  4.03e-07    11s
  69   4.27145651e+02  4.27183116e+02  1.22e-05 6.12e-07  2.51e-07    11s
  70   4.27165528e+02  4.27177416e+02  4.56e-06 1.11e-08  7.99e-08    11s
  71   4.27166247e+02  4.27177409e+02  3.90e-06 1.23e-08  7.40e-08    11s
  72   4.27169112e+02  4.27177399e+02  3.21e-06 9.58e-09  5.57e-08    11s
  73   4.27170387e+02  4.27177390e+02  2.89e-06 7.17e-09  4.74e-08    11s
  74   4.27171444e+02  4.27177382e+02  3.62e-06 8.92e-09  4.15e-08    12s
  75   4.27172107e+02  4.27177369e+02  3.21e-06 5.73e-07  3.67e-08    12s
  76   4.27172335e+02  4.27177367e+02  3.04e-06 5.82e-07  3.48e-08    12s
  77   4.27174387e+02  4.27177361e+02  2.45e-06 8.91e-07  2.15e-08    12s
  78   4.27176506e+02  4.27177349e+02  9.36e-07 3.77e-07  5.75e-09    12s
  79   4.27176849e+02  4.27177346e+02  1.57e-06 2.84e-07  3.61e-09    12s
  80   4.27177143e+02  4.27177345e+02  1.58e-06 1.92e-07  1.48e-09    12s
  81   4.27177179e+02  4.27177345e+02  3.32e-06 1.49e-07  1.26e-09    12s
  82   4.27177290e+02  4.27177344e+02  1.99e-06 9.27e-08  7.62e-10    12s
  83   4.27177317e+02  4.27177344e+02  9.27e-07 6.47e-08  3.55e-10    12s
  84   4.27177329e+02  4.27177344e+02  5.93e-07 3.96e-08  2.27e-10    12s
  85   4.27177370e+02  4.27177345e+02  5.53e-07 4.34e-08  2.06e-10    13s
  86   4.27177248e+02  4.27177345e+02  5.05e-07 5.34e-08  8.73e-11    13s
  87   4.27177311e+02  4.27177345e+02  1.44e-07 1.30e-08  2.48e-11    13s

Barrier solved model in 87 iterations and 12.69 seconds (10.53 work units)
Optimal objective 4.27177311e+02


Root crossover log...

   66144 DPushes remaining with DInf 0.0000000e+00                13s
    9535 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                17s

    2061 PPushes remaining with PInf 9.3495752e-06                17s
       0 PPushes remaining with PInf 0.0000000e+00                17s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.9257266e-10     17s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   35049    4.2717734e+02   0.000000e+00   0.000000e+00     17s
   35049    4.2717734e+02   0.000000e+00   0.000000e+00     17s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 4.271773e+02, 35049 iterations, 13.51 seconds (16.14 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0  427.17734    0  464 -192025.56  427.17734   100%     -   18s
H    0     0                    -180873.9461  427.17734   100%     -   18s
H    0     0                    -84413.27780  427.17734   101%     -   18s
H    0     0                    -83966.96021  427.17734   101%     -   18s
H    0     0                    -78736.49903  427.17734   101%     -   18s
H    0     0                    -44317.25072  427.17734   101%     -   18s
H    0     0                    -44137.54699  427.17734   101%     -   18s
H    0     0                    -44027.83803  427.17734   101%     -   21s
H    0     0                    -42516.69574  427.17734   101%     -   21s
H    0     0                    -42509.04395  427.17734   101%     -   21s
     0     0 -5445.4795    0  530 -42509.044 -5445.4795  87.2%     -   77s
H    0     0                    -42377.69693 -5445.4795  87.2%     -   78s
H    0     0                    -42211.59525 -5445.4795  87.1%     -   78s
H    0     0                    -42122.48340 -5445.4795  87.1%     -   78s
     0     0 -5843.1073    0  621 -42122.483 -5843.1073  86.1%     -   99s
     0     0 -6002.0007    0  612 -42122.483 -6002.0007  85.8%     -  110s
     0     0 -6032.6100    0  608 -42122.483 -6032.6100  85.7%     -  115s
     0     0 -6036.1687    0  615 -42122.483 -6036.1687  85.7%     -  125s
     0     0 -6036.1687    0  624 -42122.483 -6036.1687  85.7%     -  133s
     0     0 -6036.1687    0  618 -42122.483 -6036.1687  85.7%     -  140s
     0     0 -6036.1687    0  621 -42122.483 -6036.1687  85.7%     -  141s
     0     0 -6036.1687    0  619 -42122.483 -6036.1687  85.7%     -  144s
     0     0 -6036.1687    0  621 -42122.483 -6036.1687  85.7%     -  145s
     0     0 -6036.1687    0  622 -42122.483 -6036.1687  85.7%     -  146s
H    0     0                    -39540.15352 -8984.0273  77.3%     -  194s
H    0     0                    -38751.22113 -8984.0273  76.8%     -  194s
H    0     0                    -37160.07984 -8984.0273  75.8%     -  194s
H    0     0                    -37149.21778 -8984.0273  75.8%     -  194s
H    0     0                    -36831.08013 -8984.0273  75.6%     -  194s
     0     0 -8984.0273    0  574 -36831.080 -8984.0273  75.6%     -  194s
H    0     0                    -34916.85171 -8984.2762  74.3%     -  195s
H    0     0                    -34836.75566 -8984.2762  74.2%     -  195s
H    0     0                    -34807.87614 -8984.2762  74.2%     -  195s
H    0     0                    -34781.64978 -8984.2762  74.2%     -  195s
H    0     0                    -34769.50454 -8984.2762  74.2%     -  195s
H    0     0                    -34534.56568 -8984.2762  74.0%     -  195s
H    0     0                    -34496.19409 -8984.2762  74.0%     -  195s
H    0     0                    -34450.74888 -8984.2762  73.9%     -  195s
     0     0 -9327.7346    0  549 -34450.749 -9327.7346  72.9%     -  211s
     0     0 -9481.9087    0  563 -34450.749 -9481.9087  72.5%     -  220s
     0     0 -9574.3708    0  572 -34450.749 -9574.3708  72.2%     -  233s
     0     0 -9577.1844    0  574 -34450.749 -9577.1844  72.2%     -  236s
     0     0 -9594.0281    0  577 -34450.749 -9594.0281  72.2%     -  241s
     0     0 -9603.5660    0  582 -34450.749 -9603.5660  72.1%     -  243s
     0     0 -9608.1944    0  568 -34450.749 -9608.1944  72.1%     -  246s
     0     0 -9619.0578    0  571 -34450.749 -9619.0578  72.1%     -  248s
     0     0 -9620.5647    0  566 -34450.749 -9620.5647  72.1%     -  249s
     0     0 -9620.8742    0  566 -34450.749 -9620.8742  72.1%     -  250s
     0     0 -10944.014    0  565 -34450.749 -10944.014  68.2%     -  290s
H    0     0                    -34320.66934 -10944.209  68.1%     -  290s
H    0     0                    -34317.33745 -10944.209  68.1%     -  290s
H    0     0                    -31126.20951 -11051.551  64.5%     -  302s
H    0     0                    -31047.06737 -11051.551  64.4%     -  302s
H    0     0                    -30985.19800 -11051.551  64.3%     -  302s
H    0     0                    -30518.42222 -11051.551  63.8%     -  302s
H    0     0                    -30405.29453 -11051.551  63.7%     -  302s
H    0     0                    -30364.53817 -11051.551  63.6%     -  302s
H    0     0                    -30309.92941 -11051.551  63.5%     -  302s
H    0     0                    -30270.01960 -11051.551  63.5%     -  302s
H    0     0                    -30268.39350 -11051.551  63.5%     -  302s
     0     0 -11051.551    0  563 -30268.393 -11051.551  63.5%     -  302s
     0     0 -11089.404    0  575 -30268.393 -11089.404  63.4%     -  308s
H    0     0                    -30138.02624 -11128.144  63.1%     -  315s
     0     0 -11128.144    0  565 -30138.026 -11128.144  63.1%     -  315s
H    0     0                    -29990.64899 -11149.540  62.8%     -  319s
H    0     0                    -29984.13944 -11149.540  62.8%     -  319s
     0     0 -11149.540    0  568 -29984.139 -11149.540  62.8%     -  319s
     0     0 -11152.698    0  569 -29984.139 -11152.698  62.8%     -  321s
     0     0 -11166.916    0  575 -29984.139 -11166.916  62.8%     -  325s
     0     0 -11179.809    0  577 -29984.139 -11179.809  62.7%     -  329s
     0     0 -11181.252    0  584 -29984.139 -11181.252  62.7%     -  330s
     0     0 -11685.605    0  639 -29984.139 -11685.605  61.0%     -  366s
H    0     0                    -29951.67776 -11686.046  61.0%     -  366s
H    0     0                    -28511.34955 -11899.468  58.3%     -  385s
H    0     0                    -28280.71934 -11899.468  57.9%     -  385s
H    0     0                    -28278.41754 -11899.468  57.9%     -  385s
     0     0 -11899.468    0  703 -28278.418 -11899.468  57.9%     -  385s
     0     0 -11946.723    0  692 -28278.418 -11946.723  57.8%     -  397s
     0     0 -11965.810    0  711 -28278.418 -11965.810  57.7%     -  407s
H    0     0                    -28196.65476 -12059.279  57.2%     -  422s
H    0     0                    -28164.96780 -12059.279  57.2%     -  422s
     0     0 -12059.279    0  698 -28164.968 -12059.279  57.2%     -  422s
     0     0 -12109.737    0  581 -28164.968 -12109.737  57.0%     -  430s
     0     0 -12124.120    0  590 -28164.968 -12124.120  57.0%     -  433s
     0     0 -12138.362    0  590 -28164.968 -12138.362  56.9%     -  437s
     0     0 -12143.908    0  598 -28164.968 -12143.908  56.9%     -  441s
     0     0 -12150.243    0  593 -28164.968 -12150.243  56.9%     -  443s
     0     0 -12151.838    0  596 -28164.968 -12151.838  56.9%     -  444s
     0     0 -12356.109    0  688 -28164.968 -12356.109  56.1%     -  465s
     0     0 -12411.652    0  580 -28164.968 -12411.652  55.9%     -  479s
     0     0 -12456.469    0  574 -28164.968 -12456.469  55.8%     -  487s
H    0     0                    -28135.64751 -12468.466  55.7%     -  492s
H    0     0                    -28103.94125 -12468.466  55.6%     -  492s
     0     0 -12468.466    0  586 -28103.941 -12468.466  55.6%     -  492s
     0     0 -12476.257    0  576 -28103.941 -12476.257  55.6%     -  497s
H    0     0                    -28099.56673 -12478.410  55.6%     -  500s
H    0     0                    -28095.74317 -12478.410  55.6%     -  500s
     0     0 -12478.410    0  581 -28095.743 -12478.410  55.6%     -  500s
     0     0 -12486.057    0  589 -28095.743 -12486.057  55.6%     -  504s
     0     0 -12489.289    0  587 -28095.743 -12489.289  55.5%     -  505s
     0     0 -12490.562    0  581 -28095.743 -12490.562  55.5%     -  507s
     0     0 -12568.726    0  576 -28095.743 -12568.726  55.3%     -  522s
     0     0 -12582.907    0  599 -28095.743 -12582.907  55.2%     -  528s
     0     0 -12589.424    0  591 -28095.743 -12589.424  55.2%     -  533s
     0     0 -12597.531    0  587 -28095.743 -12597.531  55.2%     -  537s
     0     0 -12599.641    0  594 -28095.743 -12599.641  55.2%     -  539s
     0     0 -12650.653    0  599 -28095.743 -12650.653  55.0%     -  551s
     0     0 -12668.591    0  593 -28095.743 -12668.591  54.9%     -  556s
     0     0 -12679.387    0  607 -28095.743 -12679.387  54.9%     -  561s
     0     0 -12685.983    0  614 -28095.743 -12685.983  54.8%     -  565s
     0     0 -12687.264    0  603 -28095.743 -12687.264  54.8%     -  567s
     0     0 -12719.935    0  628 -28095.743 -12719.935  54.7%     -  577s
     0     0 -12722.588    0  628 -28095.743 -12722.588  54.7%     -  581s
     0     0 -12724.111    0  626 -28095.743 -12724.111  54.7%     -  583s
     0     0 -12762.806    0  715 -28095.743 -12762.806  54.6%     -  595s
     0     0 -12772.668    0  716 -28095.743 -12772.668  54.5%     -  601s
     0     0 -12774.072    0  716 -28095.743 -12774.072  54.5%     -  604s
     0     0 -12794.327    0  610 -28095.743 -12794.327  54.5%     -  613s
H    0     0                    -28085.44975 -12794.340  54.4%     -  614s
     0     0 -12801.560    0  606 -28085.450 -12801.560  54.4%     -  619s
     0     0 -12807.763    0  618 -28085.450 -12807.763  54.4%     -  622s
     0     0 -12808.362    0  615 -28085.450 -12808.362  54.4%     -  624s
     0     0 -12824.012    0  624 -28085.450 -12824.012  54.3%     -  632s
     0     0 -12831.525    0  623 -28085.450 -12831.525  54.3%     -  637s
     0     0 -12832.785    0  623 -28085.450 -12832.785  54.3%     -  639s
     0     0 -12849.500    0  619 -28085.450 -12849.500  54.2%     -  648s
     0     0 -12854.433    0  637 -28085.450 -12854.433  54.2%     -  653s
     0     0 -12855.260    0  639 -28085.450 -12855.260  54.2%     -  655s
     0     0 -12861.198    0  639 -28085.450 -12861.198  54.2%     -  661s
     0     0 -12864.303    0  641 -28085.450 -12864.303  54.2%     -  664s
     0     0 -12865.833    0  648 -28085.450 -12865.833  54.2%     -  665s
     0     0 -12870.060    0  641 -28085.450 -12870.060  54.2%     -  669s
     0     0 -12870.096    0  641 -28085.450 -12870.096  54.2%     -  675s
H    0     0                    -28049.08151 -12870.430  54.1%     -  842s
H    0     0                    -28035.58039 -12870.430  54.1%     -  848s
H    0     0                    -28030.71058 -12870.430  54.1%     -  849s
H    0     0                    -27993.10489 -12870.430  54.0%     -  859s
H    0     0                    -24703.91996 -12870.430  47.9%     -  860s
H    0     0                    -24433.52260 -12870.430  47.3%     -  860s
H    0     0                    -24419.23619 -12870.430  47.3%     -  864s
H    0     0                    -24330.75074 -12870.430  47.1%     -  864s
H    0     0                    -24107.72324 -12870.430  46.6%     -  864s
H    0     0                    -24063.06110 -12870.430  46.5%     -  866s
H    0     0                    -24028.73652 -12870.430  46.4%     -  875s
H    0     2                    -24017.95032 -12870.430  46.4%     -  876s
     0     2 -12870.430    0  641 -24017.950 -12870.430  46.4%     -  876s
     1     4 -12878.016    1  626 -24017.950 -12870.907  46.4%  1547  901s
     3     7 -14401.200    2  401 -24017.950 -12878.143  46.4%  6708  913s
     6    14 -13178.786    3  588 -24017.950 -12878.209  46.4%  7259  933s
    13    28 -13292.443    4  571 -24017.950 -12972.238  46.0%  7126  962s
    27    43 -21475.783    5  179 -24017.950 -13176.233  45.1% 11169 1011s
    42    75 -14559.867    6  336 -24017.950 -13176.233  45.1% 10328 1101s
H   44    75                    -23975.16666 -13176.233  45.0% 10161 1101s
H   47    75                    -23947.69145 -13176.233  45.0%  9865 1101s
H   59    75                    -23933.96386 -13176.233  44.9%  8807 1101s
    74   199 -14653.612    7  335 -23933.964 -13293.779  44.5%  8871 1134s
   210   263 -14574.993    9  360 -23933.964 -13293.779  44.5%  4770 1152s
H  212   263                    -23920.05541 -13293.779  44.4%  4756 1152s
H  216   263                    -23906.48865 -13293.779  44.4%  4725 1152s
   300   270 -14842.724   12  238 -23906.489 -13293.779  44.4%  3960 1167s
H  301   270                    -23878.45948 -13293.779  44.3%  3947 1167s
   384   281 -15564.781   13  230 -23878.459 -13293.779  44.3%  3483 1182s
   415   301 -16272.574   14  207 -23878.459 -13293.779  44.3%  3553 1198s
H  427   301                    -23876.92436 -13293.779  44.3%  3659 1198s
   459   325 -16473.922   15  216 -23876.924 -13293.779  44.3%  3700 1212s
   489   352 -16383.022   16  289 -23876.924 -13293.779  44.3%  3884 1228s
   531   378 -19792.014   16  112 -23876.924 -13293.779  44.3%  3848 1243s
   573   399 -21424.656   17   99 -23876.924 -13293.779  44.3%  3918 1258s
   644   420 -21706.899   18   85 -23876.924 -13293.779  44.3%  3741 1272s
   719   429 -23205.411   20   54 -23876.924 -13293.779  44.3%  3629 1287s
   782   447     cutoff   25      -23876.924 -13293.779  44.3%  3572 1302s
   840   478 -19265.343   18  339 -23876.924 -13293.779  44.3%  3612 1318s
   905   520 -19898.799   24  165 -23876.924 -13293.779  44.3%  3570 1333s
   965   566 -21870.804   27  152 -23876.924 -13293.779  44.3%  3568 1349s
  1039   570     cutoff   30      -23876.924 -13293.779  44.3%  3561 1363s
  1105   596 -15429.616    7  240 -23876.924 -13293.779  44.3%  3547 1381s
  1177   623 -17455.092    7  290 -23876.924 -13293.779  44.3%  3597 1398s
  1240   661 -19374.022    8  312 -23876.924 -13293.779  44.3%  3640 1417s
  1312   704 -21517.361    9  366 -23876.924 -13293.779  44.3%  3697 1436s
  1403   739 -22944.450   10  307 -23876.924 -13293.779  44.3%  3697 1456s
  1491   770 -19446.531    9  305 -23876.924 -13293.779  44.3%  3666 1478s
  1585   824 -21806.278   10  271 -23876.924 -13293.779  44.3%  3624 1498s
  1681   858 -22384.186   11  257 -23876.924 -13293.779  44.3%  3627 1518s
  1779   882     cutoff   11      -23876.924 -13293.779  44.3%  3597 1540s
  1850   914     cutoff   13      -23876.924 -13293.779  44.3%  3618 1563s
  1929   975 -22782.936   25  369 -23876.924 -13293.779  44.3%  3652 1584s
  2041  1003     cutoff   26      -23876.924 -13293.779  44.3%  3619 1609s
  2118  1034 -18173.214   20  339 -23876.924 -13293.779  44.3%  3655 1632s
  2192  1061 -19085.641   21  190 -23876.924 -13293.779  44.3%  3695 1653s
  2221  1085     cutoff   22      -23876.924 -13293.779  44.3%  3767 1680s
  2277  1110 -20951.249   23  164 -23876.924 -13293.779  44.3%  3821 1704s
  2314  1132 -21518.172   24  158 -23876.924 -13293.779  44.3%  3894 1731s
  2364  1185     cutoff   25      -23876.924 -13293.779  44.3%  3951 1756s
  2441  1231     cutoff   32      -23876.924 -13293.779  44.3%  3981 1782s
  2557  1286 -23506.005   19  103 -23876.924 -13552.843  43.2%  3983 1809s
  2651  1327 -14129.703    6  462 -23876.924 -13553.372  43.2%  4033 1839s
  2758  1389 -14145.861    7  530 -23876.924 -13553.372  43.2%  4046 1868s
  2896  1473 -15305.428    8  306 -23876.924 -13553.372  43.2%  4049 1900s
  3077  1528 -16947.127   11  253 -23876.924 -13553.372  43.2%  4016 1932s
  3184  1635 -18569.413   11  296 -23876.924 -13553.372  43.2%  4073 1967s
  3359  1693 -17798.663   11  293 -23876.924 -13553.372  43.2%  4066 2007s
  3537  1740 -18618.466   13  172 -23876.924 -14138.758  40.8%  4062 2042s
  3664  1796 -17726.179   12  262 -23876.924 -14138.758  40.8%  4113 2078s
  3830  1880 -18476.615   14  253 -23876.924 -14636.003  38.7%  4157 2116s
  4002  1934 -22838.797   17  185 -23876.924 -14636.003  38.7%  4172 2159s
  4207  1998 -22482.898   20  229 -23876.924 -14636.003  38.7%  4196 2197s
  4369  2077 -19001.551   15  216 -23876.924 -14853.634  37.8%  4287 2245s
  4592  2153     cutoff   24      -23876.924 -14875.738  37.7%  4312 2292s
  4791  2233 -21639.514    9  289 -23876.924 -15003.385  37.2%  4344 2337s
  4970  2234 -21927.303   24  641 -23876.924 -15003.385  37.2%  4372 2502s
  4972  2235 -22089.858   24  487 -23876.924 -15003.385  37.2%  4370 2529s
  4973  2236 -21403.814   30  551 -23876.924 -15003.385  37.2%  4369 2644s
  4974  2237 -16331.542   16  601 -23876.924 -15003.385  37.2%  4368 2680s
  4975  2237 -16475.313   18  555 -23876.924 -15003.385  37.2%  4367 2704s
  4976  2238 -18653.969   11  575 -23876.924 -15003.385  37.2%  4367 2755s
  4977  2239 -18228.187   13  572 -23876.924 -15003.385  37.2%  4366 2779s
  4978  2239 -20799.220   16  607 -23876.924 -15003.385  37.2%  4365 2795s
  4979  2240 -17813.327   11  601 -23876.924 -15003.385  37.2%  4364 2806s
  4980  2241 -16384.407   11  591 -23876.924 -15003.385  37.2%  4363 2815s
  4981  2241 -23414.685   59  608 -23876.924 -15003.385  37.2%  4362 2827s
  4982  2242 -17603.451   12  606 -23876.924 -15003.385  37.2%  4361 2836s
  4983  2243 -22085.653   32  612 -23876.924 -15003.385  37.2%  4360 2866s
  4984  2243 -21578.145    7  629 -23876.924 -15003.385  37.2%  4360 2878s
  4985  2244 -18522.720    9  631 -23876.924 -15003.385  37.2%  4359 2886s
  4986  2245 -18066.366   12  618 -23876.924 -15003.385  37.2%  4358 2891s
  4987  2245 -18625.874   14  639 -23876.924 -15003.385  37.2%  4357 2899s
  4988  2246 -23003.813   37  624 -23876.924 -15003.385  37.2%  4356 2921s
  4989  2247 -21689.653   21  621 -23876.924 -15003.385  37.2%  4355 2934s
  4990  2247 -17875.630   17  607 -23876.924 -15003.385  37.2%  4354 2940s
  4991  2248 -17198.011   14  624 -23876.924 -15003.385  37.2%  4353 2948s
  4992  2249 -21226.289   24  633 -23876.924 -15003.385  37.2%  4353 2960s
  4993  2249 -20628.934   13  639 -23876.924 -15003.385  37.2%  4352 2982s
  4994  2250 -22359.445   42  641 -23876.924 -15003.385  37.2%  4351 2993s
  4995  2251 -15661.007    7  652 -23876.924 -15003.385  37.2%  4350 3006s
  4996  2251 -16815.478   10  634 -23876.924 -15003.385  37.2%  4349 3031s
  4997  2252 -23322.963   27  648 -23876.924 -15003.385  37.2%  4348 3042s
  4998  2253 -19189.107   10  632 -23876.924 -15003.385  37.2%  4347 3061s
  4999  2253 -19891.183   11  625 -23876.924 -15003.385  37.2%  4346 3073s
  5000  2254 -22771.832   15  620 -23876.924 -15003.385  37.2%  4346 3099s
  5001  2255 -23316.450   45  629 -23876.924 -15003.385  37.2%  4345 3111s
  5002  2255 -23219.409    7  625 -23876.924 -15003.385  37.2%  4344 3124s
  5003  2256 -18754.783   11  642 -23876.924 -15003.385  37.2%  4343 3134s
  5004  2257 -19940.202   17  630 -23876.924 -15003.385  37.2%  4342 3148s
  5005  2257 -21311.273   28  688 -23876.924 -15003.385  37.2%  4341 3160s
  5006  2258 -22935.464   28  645 -23876.924 -15003.385  37.2%  4340 3177s
  5007  2259 -18898.022   18  645 -23876.924 -15003.385  37.2%  4340 3205s
  5008  2259 -17657.224   16  645 -23876.924 -15003.385  37.2%  4339 3297s
  5009  2262 -15003.385   12  596 -23876.924 -15003.385  37.2%  4400 3365s
  5010  2265 -15003.385   13  363 -23876.924 -15003.385  37.2%  4402 3399s
  5013  2270 -15011.031   14  439 -23876.924 -15003.385  37.2%  4403 3460s
  5019  2280 -15668.798   15  369 -23876.924 -15003.385  37.2%  4410 3508s
  5031  2289 -18306.893   16  206 -23876.924 -15003.385  37.2%  4450 3593s

Cutting planes:
  Implied bound: 3
  Projected implied bound: 130
  MIR: 1246
  Flow cover: 1678
  GUB cover: 1
  Zero half: 21
  RLT: 49
  Relax-and-lift: 125

Explored 5044 nodes (22945244 simplex iterations) in 3600.05 seconds (5603.16 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -23876.9 -23878.5 -23906.5 ... -24063.1

Time limit reached
Best objective -2.387692436100e+04, best bound -1.500338466713e+04, gap 37.1637%
  WARNING: Time limit reached. Using best solution found (gap: 37.16%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = -23876.92, θ = 99825.18
  Upper Bound (UB) = -23876.92

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 99825.18
  [DEBUG]   ✓ Scenario 0: θ = 99825.18 ≤ Q = 99825.18 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 99825.18 ≤ Q = 99825.18 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 99825.18 ≤ Q = 99825.18 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 99825.18 ≤ Q = 99825.18 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 99825.18 ≤ Q = 99825.18 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 99825.18 ≤ Q = 99825.18 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 99825.18 ≤ Q = 99825.18 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 99825.18 ≤ Q = 99825.18 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 99825.18 ≤ Q = 99825.18 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x62eb7f05
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x62eb7f05
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [5e-01, 2e+02]
Found heuristic solution: objective 1.214194e+13
Presolve removed 2553 rows and 1846 columns
Presolve time: 0.01s
Presolved: 540 rows, 543 columns, 1523 nonzeros
Found heuristic solution: objective 6580102.9563
Variable types: 367 continuous, 176 integer (176 binary)

Root relaxation: objective -1.272278e+05, 253 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -127227.77    0  124 6580102.96 -127227.77   102%     -    0s
H    0     0                    -88638.15924 -127227.77  43.5%     -    0s
H    0     0                    -89199.40864 -127227.77  42.6%     -    0s
     0     0 -99761.139    0   39 -89199.409 -99761.139  11.8%     -    0s
H    0     0                    -99225.86922 -99700.170  0.48%     -    0s
     0     0 -99458.160    0   14 -99225.869 -99458.160  0.23%     -    0s
     0     0 -99450.125    0   13 -99225.869 -99450.125  0.23%     -    0s
H    0     0                    -99426.18685 -99450.125  0.02%     -    0s
     0     0          -    0      -99426.187 -99435.396  0.01%     -    0s

Cutting planes:
  Gomory: 4
  MIR: 129
  RLT: 3

Explored 1 nodes (453 simplex iterations) in 0.03 seconds (0.02 work units)
Thread count was 32 (of 32 available processors)

Solution count 6: -99426.2 -99225.9 -89199.4 ... 1.21419e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -9.942618685247e+04, best bound -9.943539602150e+04, gap 0.0093%
  Subproblem solved in 0.06s
  Worst-case operational profit (Z_SP) = 93004.12
  Scenario: 14 demand increases, 46 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -99426.19
  [DEBUG]   S×d_nominal = 192430.30
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 192430.30 + -99426.19 = 93004.12
  [DEBUG]   Current θ from Master = 99825.18
  [DEBUG]   ⚠️  Z_SP ≤ θ by 6821.07 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -30697.99
  Lower Bound (LB) = -24370.17
  Gap (UB-LB) = 493.2502, Absolute Gap = 493.2502, Relative Gap = 0.020658
  Not converged yet (gap = 493.25 > ε = 200)

  [DEBUG] Adding NEW scenario 9 to Master Problem...
  [DEBUG] New scenario pattern: 14 increases, 46 decreases
    [DEBUG] Scenario 9 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 9 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 9]
    [DEBUG]   - Total constraints in model: 154283
    [DEBUG]   - Total variables in model: 64660
  [DEBUG] Total scenarios in Master: 10
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 10
================================================================================
[Iteration 10] Solving Master Problem...
  Current scenarios in Master: 10
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 154283 rows, 64660 columns and 438069 nonzeros
Model fingerprint: 0xcada0370
Variable types: 62401 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 62760 rows and 25490 columns
Presolve time: 3.23s
Presolved: 91523 rows, 39170 columns, 555789 nonzeros
Variable types: 36911 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -362332.0301
Found heuristic solution: objective -192025.5558

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.29s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.958e+06
 Factor NZ  : 8.592e+06 (roughly 120 MB of memory)
 Factor Ops : 1.471e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.35439344e+07  1.61200465e+08  7.54e+04 2.61e+01  5.85e+04     5s
   1  -1.00826750e+07  1.36295832e+08  5.23e+04 6.40e+01  4.05e+04     5s
   2  -4.13025059e+06  1.07770306e+08  2.02e+04 1.60e+01  1.63e+04     5s
   3  -7.12782331e+05  6.58740204e+07  1.30e+03 1.14e+00  1.35e+03     5s
   4  -4.78878514e+05  2.41855259e+07  3.80e+02 3.04e-01  3.92e+02     5s
   5  -3.27763361e+05  1.68490296e+07  1.02e+02 1.90e-01  1.63e+02     5s
   6  -2.07854767e+05  1.34940099e+07  2.13e+01 1.43e-01  9.32e+01     5s
   7  -1.51498179e+05  1.04354328e+07  1.06e+01 1.08e-01  6.78e+01     6s
   8  -1.03070567e+05  4.49068860e+06  4.15e+00 4.26e-02  2.83e+01     6s
   9  -7.98859751e+04  2.26439498e+06  2.53e+00 2.10e-02  1.43e+01     6s
  10  -6.07726930e+04  6.84622410e+05  1.68e+00 6.13e-03  4.52e+00     6s
  11  -4.15689833e+04  2.71103634e+05  9.70e-01 2.31e-03  1.88e+00     6s
  12  -2.80581665e+04  1.02974332e+05  4.91e-01 1.22e-03  7.85e-01     6s
  13  -2.38040370e+04  6.12753783e+04  3.96e-01 1.35e-03  5.10e-01     6s
  14  -2.07528618e+04  5.05413965e+04  3.33e-01 1.76e-03  4.27e-01     6s
  15  -1.68039318e+04  3.97783032e+04  2.62e-01 1.46e-03  3.39e-01     6s
  16  -1.38654012e+04  2.59572002e+04  2.14e-01 1.17e-03  2.38e-01     6s
  17  -1.01337815e+04  2.03636790e+04  1.64e-01 1.38e-03  1.82e-01     6s
  18  -8.12439864e+03  1.65037953e+04  1.36e-01 1.48e-03  1.47e-01     7s
  19  -6.20522943e+03  1.28114673e+04  1.10e-01 1.42e-03  1.14e-01     7s
  20  -4.70625868e+03  9.03572244e+03  8.96e-02 1.15e-03  8.22e-02     7s
  21  -4.03812947e+03  8.04894727e+03  8.08e-02 8.64e-04  7.23e-02     7s
  22  -2.62911558e+03  6.71442256e+03  6.27e-02 1.26e-03  5.59e-02     7s
  23  -2.00578387e+03  5.14488653e+03  5.38e-02 8.78e-04  4.28e-02     7s
  24  -1.21837214e+03  4.53688441e+03  4.33e-02 2.28e-03  3.44e-02     7s
  25  -6.26445775e+02  3.97662983e+03  3.53e-02 1.01e-03  2.75e-02     7s
  26   1.64027335e+01  3.54081460e+03  2.73e-02 6.76e-04  2.11e-02     7s
  27   4.74248299e+02  3.31503711e+03  2.15e-02 8.26e-04  1.70e-02     7s
  28   7.74081861e+02  2.95085848e+03  1.78e-02 1.61e-03  1.30e-02     7s
  29   1.04263416e+03  2.80227560e+03  1.44e-02 1.13e-03  1.05e-02     8s
  30   1.50681009e+03  2.62930482e+03  8.80e-03 7.86e-04  6.71e-03     8s
  31   1.57004077e+03  2.56007861e+03  8.04e-03 6.32e-04  5.92e-03     8s
  32   1.70506898e+03  2.49177763e+03  6.35e-03 5.42e-04  4.70e-03     8s
  33   1.86681393e+03  2.40312601e+03  4.43e-03 3.06e-04  3.21e-03     8s
  34   1.97715660e+03  2.38127796e+03  3.20e-03 2.53e-04  2.42e-03     8s
  35   2.06024297e+03  2.33454987e+03  2.24e-03 1.59e-04  1.64e-03     8s
  36   2.13515973e+03  2.29180853e+03  1.36e-03 1.31e-04  9.37e-04     8s
  37   2.17352595e+03  2.28064092e+03  9.29e-04 8.30e-05  6.41e-04     8s
  38   2.20405620e+03  2.27552560e+03  5.59e-04 6.32e-05  4.27e-04     9s
  39   2.21683608e+03  2.26769489e+03  4.19e-04 3.47e-05  3.04e-04     9s
  40   2.24863796e+03  2.26053124e+03  7.53e-05 1.06e-05  7.11e-05     9s
  41   2.25182907e+03  2.25693195e+03  4.37e-05 9.16e-07  3.05e-05     9s
  42   2.25410903e+03  2.25675786e+03  2.16e-05 5.86e-07  1.58e-05     9s
  43   2.25555813e+03  2.25646111e+03  8.86e-06 4.34e-07  5.40e-06     9s
  44   2.25619034e+03  2.25646017e+03  2.31e-06 2.98e-09  1.61e-06     9s
  45   2.25622954e+03  2.25645968e+03  1.87e-06 2.87e-09  1.38e-06     9s
  46   2.25637554e+03  2.25644608e+03  6.26e-07 2.27e-09  4.22e-07    10s
  47   2.25640197e+03  2.25644345e+03  6.07e-07 1.70e-09  2.48e-07    10s
  48   2.25640595e+03  2.25644278e+03  8.19e-07 7.07e-08  2.20e-07    10s
  49   2.25643504e+03  2.25644240e+03  1.26e-06 1.58e-07  4.50e-08    10s
  50   2.25643807e+03  2.25644240e+03  3.80e-06 7.42e-08  2.66e-08    10s
  51   2.25644215e+03  2.25644240e+03  9.58e-07 2.06e-08  1.45e-09    10s
  52   2.25644237e+03  2.25644240e+03  9.01e-08 2.35e-09  1.36e-10    10s
  53   2.25644239e+03  2.25644240e+03  1.65e-08 5.09e-10  2.50e-11    10s

Barrier solved model in 53 iterations and 10.33 seconds (8.14 work units)
Optimal objective 2.25644239e+03


Root crossover log...

   66026 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                13s

    3671 PPushes remaining with PInf 2.5176028e-06                13s
       0 PPushes remaining with PInf 0.0000000e+00                13s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.2772636e-10     13s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   29913    2.2564424e+03   0.000000e+00   0.000000e+00     13s
   29913    2.2564424e+03   0.000000e+00   0.000000e+00     13s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 2.256442e+03, 29913 iterations, 9.59 seconds (11.09 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 2256.44240    0  641 -192025.56 2256.44240   101%     -   14s
H    0     0                    -186029.4953 2256.44240   101%     -   14s
H    0     0                    -100297.8149 2256.44240   102%     -   15s
H    0     0                    -95359.77671 2256.44240   102%     -   15s
H    0     0                    -71298.25293 2256.44240   103%     -   15s
H    0     0                    -49576.04605 2256.44240   105%     -   15s
H    0     0                    -46061.25432 2256.44240   105%     -   15s
H    0     0                    -45343.63708 2256.44240   105%     -   15s
H    0     0                    -44926.38022 -2902.6998  93.5%     -   68s
H    0     0                    -44893.48466 -2902.6998  93.5%     -   68s
H    0     0                    -44767.29337 -2902.6998  93.5%     -   68s
H    0     0                    -44626.80084 -2902.6998  93.5%     -   68s
     0     0 -2962.4093    0  657 -44626.801 -2962.4093  93.4%     -   68s
H    0     0                    -43285.87047 -2962.4093  93.2%     -   69s
H    0     0                    -42905.63601 -2962.4093  93.1%     -   69s
     0     0 -3301.7337    0  656 -42905.636 -3301.7337  92.3%     -   86s
     0     0 -3362.6030    0  648 -42905.636 -3362.6030  92.2%     -   97s
     0     0 -3362.6030    0  652 -42905.636 -3362.6030  92.2%     -  101s
     0     0 -3515.6421    0  640 -42905.636 -3515.6421  91.8%     -  112s
     0     0 -3624.8999    0  641 -42905.636 -3624.8999  91.6%     -  117s
     0     0 -3631.3099    0  649 -42905.636 -3631.3099  91.5%     -  119s
     0     0 -3631.3099    0  649 -42905.636 -3631.3099  91.5%     -  137s
     0     0 -3631.3099    0  646 -42905.636 -3631.3099  91.5%     -  139s
     0     0 -3631.3099    0  646 -42905.636 -3631.3099  91.5%     -  151s
     0     0 -3631.3099    0  658 -42905.636 -3631.3099  91.5%     -  154s
     0     0 -3631.3099    0  646 -42905.636 -3631.3099  91.5%     -  157s
     0     0 -3631.3099    0  643 -42905.636 -3631.3099  91.5%     -  157s
H    0     0                    -42876.88877 -6989.4210  83.7%     -  251s
H    0     0                    -42861.48336 -6989.4210  83.7%     -  251s
H    0     0                    -42095.74128 -6989.4210  83.4%     -  251s
     0     0 -7015.0649    0  667 -42095.741 -7015.0649  83.3%     -  251s
H    0     0                    -29085.04473 -7015.0649  75.9%     -  252s
H    0     0                    -28824.83433 -7015.0649  75.7%     -  252s
     0     0 -8149.1080    0  674 -28824.834 -8149.1080  71.7%     -  320s
     0     0 -8417.3686    0  692 -28824.834 -8417.3686  70.8%     -  358s
     0     0 -8591.9477    0  694 -28824.834 -8591.9477  70.2%     -  389s
     0     0 -8712.2269    0  691 -28824.834 -8712.2269  69.8%     -  425s
     0     0 -8739.2904    0  767 -28824.834 -8739.2904  69.7%     -  447s
     0     0 -8746.4962    0  767 -28824.834 -8746.4962  69.7%     -  456s
     0     0 -8763.4033    0  760 -28824.834 -8763.4033  69.6%     -  467s
     0     0 -8807.0767    0  681 -28824.834 -8807.0767  69.4%     -  483s
     0     0 -8839.9120    0  670 -28824.834 -8839.9120  69.3%     -  501s
     0     0 -8841.0273    0  671 -28824.834 -8841.0273  69.3%     -  508s
     0     0 -10295.812    0  704 -28824.834 -10295.812  64.3%     -  619s
H    0     0                    -28480.99444 -10295.952  63.8%     -  619s
     0     0 -10830.916    0  542 -28480.994 -10830.916  62.0%     -  683s
     0     0 -10981.421    0  763 -28480.994 -10981.421  61.4%     -  718s
     0     0 -11053.010    0  569 -28480.994 -11053.010  61.2%     -  742s
     0     0 -11107.457    0  579 -28480.994 -11107.457  61.0%     -  761s
     0     0 -11185.230    0  546 -28480.994 -11185.230  60.7%     -  778s
     0     0 -11201.036    0  559 -28480.994 -11201.036  60.7%     -  790s
     0     0 -11230.836    0  561 -28480.994 -11230.836  60.6%     -  805s
     0     0 -11242.236    0  559 -28480.994 -11242.236  60.5%     -  816s
H    0     0                    -28333.96981 -11257.828  60.3%     -  830s
     0     0 -11257.828    0  739 -28333.970 -11257.828  60.3%     -  830s
     0     0 -11260.972    0  742 -28333.970 -11260.972  60.3%     -  836s
     0     0 -11262.085    0  734 -28333.970 -11262.085  60.3%     -  839s
     0     0 -11933.103    0  583 -28333.970 -11933.103  57.9%     -  937s
H    0     0                    -28325.95306 -11933.124  57.9%     -  937s
     0     0 -12029.052    0  794 -28325.953 -12029.052  57.5%     -  976s
     0     0 -12069.539    0  597 -28325.953 -12069.539  57.4%     -  991s
     0     0 -12090.102    0  597 -28325.953 -12090.102  57.3%     - 1007s
     0     0 -12150.702    0  746 -28325.953 -12150.702  57.1%     - 1022s
     0     0 -12170.466    0  591 -28325.953 -12170.466  57.0%     - 1035s
     0     0 -12173.198    0  588 -28325.953 -12173.198  57.0%     - 1040s
     0     0 -12174.569    0  590 -28325.953 -12174.569  57.0%     - 1042s
     0     0 -12352.032    0  699 -28325.953 -12352.032  56.4%     - 1084s
     0     0 -12390.818    0  592 -28325.953 -12390.818  56.3%     - 1103s
     0     0 -12407.742    0  596 -28325.953 -12407.742  56.2%     - 1117s
     0     0 -12412.794    0  593 -28325.953 -12412.794  56.2%     - 1123s
     0     0 -12417.443    0  593 -28325.953 -12417.443  56.2%     - 1134s
     0     0 -12418.887    0  750 -28325.953 -12418.887  56.2%     - 1138s
H    0     0                    -28144.14942 -12528.256  55.5%     - 1172s
H    0     0                    -27988.90874 -12528.256  55.2%     - 1172s
H    0     0                    -27985.08457 -12528.256  55.2%     - 1172s
     0     0 -12528.256    0  720 -27985.085 -12528.256  55.2%     - 1172s
     0     0 -12552.206    0  729 -27985.085 -12552.206  55.1%     - 1192s
     0     0 -12557.583    0  658 -27985.085 -12557.583  55.1%     - 1200s
     0     0 -12562.536    0  609 -27985.085 -12562.536  55.1%     - 1208s
     0     0 -12572.222    0  669 -27985.085 -12572.222  55.1%     - 1218s
     0     0 -12574.180    0  672 -27985.085 -12574.180  55.1%     - 1224s
     0     0 -12613.893    0  629 -27985.085 -12613.893  54.9%     - 1249s
     0     0 -12625.344    0  629 -27985.085 -12625.344  54.9%     - 1259s
     0     0 -12635.483    0  632 -27985.085 -12635.483  54.8%     - 1272s
     0     0 -12640.208    0  625 -27985.085 -12640.208  54.8%     - 1279s
     0     0 -12640.601    0  630 -27985.085 -12640.601  54.8%     - 1282s
     0     0 -12672.188    0  860 -27985.085 -12672.188  54.7%     - 1316s
     0     0 -12683.089    0  779 -27985.085 -12683.089  54.7%     - 1338s
     0     0 -12687.042    0  623 -27985.085 -12687.042  54.7%     - 1348s
     0     0 -12687.703    0  620 -27985.085 -12687.703  54.7%     - 1350s
     0     0 -12709.725    0  730 -27985.085 -12709.725  54.6%     - 1371s
     0     0 -12711.661    0  739 -27985.085 -12711.661  54.6%     - 1377s
     0     0 -12735.986    0  623 -27985.085 -12735.986  54.5%     - 1393s
     0     0 -12738.278    0  621 -27985.085 -12738.278  54.5%     - 1399s
     0     0 -12776.773    0  632 -27985.085 -12776.773  54.3%     - 1418s
     0     0 -12782.747    0  620 -27985.085 -12782.747  54.3%     - 1427s
     0     0 -12785.935    0  638 -27985.085 -12785.935  54.3%     - 1432s
     0     0 -12786.731    0  632 -27985.085 -12786.731  54.3%     - 1436s
     0     0 -12802.895    0  623 -27985.085 -12802.895  54.3%     - 1453s
H    0     0                    -27853.33524 -12802.987  54.0%     - 1482s
H    0     0                    -24556.76587 -12802.987  47.9%     - 1498s
H    0     0                    -24498.94145 -12802.987  47.7%     - 1503s
H    0     0                    -24268.08682 -12802.987  47.2%     - 1505s
H    0     0                    -24118.43594 -12802.987  46.9%     - 1507s
H    0     0                    -24070.37769 -12802.987  46.8%     - 1514s
H    0     0                    -23931.38017 -12802.987  46.5%     - 1515s
H    0     0                    -23901.54138 -12802.987  46.4%     - 1515s
H    0     0                    -23877.56864 -12802.987  46.4%     - 1516s
     0     0 -12809.538    0  624 -23877.569 -12809.538  46.4%     - 1531s
     0     0 -12811.663    0  634 -23877.569 -12811.663  46.3%     - 1536s
     0     0 -12839.824    0  625 -23877.569 -12839.824  46.2%     - 1553s
     0     0 -12842.756    0  634 -23877.569 -12842.756  46.2%     - 1564s
     0     0 -12844.326    0  626 -23877.569 -12844.326  46.2%     - 1568s
     0     0 -12850.982    0  633 -23877.569 -12850.982  46.2%     - 1579s
     0     0 -12854.013    0  636 -23877.569 -12854.013  46.2%     - 1592s
     0     0 -12854.379    0  639 -23877.569 -12854.379  46.2%     - 1593s
     0     0 -12858.400    0  647 -23877.569 -12858.400  46.1%     - 1602s
     0     0 -12858.578    0  647 -23877.569 -12858.578  46.1%     - 1610s
H    0     0                    -23849.50524 -12858.578  46.1%     - 1690s
H    0     0                    -23814.93678 -12858.578  46.0%     - 1690s
H    0     0                    -23803.22767 -12858.591  46.0%     - 1842s
H    0     0                    -23802.84161 -12858.591  46.0%     - 1857s
     0     2 -12858.591    0  647 -23802.842 -12858.591  46.0%     - 1865s
     1     3 -13184.064    1  495 -23802.842 -12858.591  46.0%  7271 1883s
     2     4 -12930.897    1  625 -23802.842 -12930.897  45.7%  4470 1899s
     3     6 -13681.609    2  470 -23802.842 -12930.985  45.7%  3521 1921s
     5    12 -14144.818    3  472 -23802.842 -12930.985  45.7%  5734 1948s
    11    21 -13865.737    4  471 -23802.842 -13207.715  44.5%  6791 1990s
    20    30 -14727.418    4  716 -23802.842 -13210.991  44.5% 14216 2058s
    29    57 -14606.401    4  584 -23802.842 -13433.718  43.6% 13477 2448s
H   35    57                    -23781.01311 -13433.718  43.5% 12617 2448s
    56    88 -14831.760    5  587 -23781.013 -13433.718  43.5% 19192 2613s
H   63    88                    -23778.07968 -13433.718  43.5% 17965 2613s
    87   197 -16014.003    6  674 -23778.080 -13433.718  43.5% 17390 2694s
   198   226 -16064.246    7  655 -23778.080 -13433.718  43.5% 11566 2739s
   231   275 -16650.557    8  621 -23778.080 -13433.718  43.5% 10914 2810s
   282   319 -15761.210   12  535 -23778.080 -13433.718  43.5%  9910 2848s
   337   362 -18455.277    9  514 -23778.080 -13433.718  43.5%  9183 2884s
   392   412 -18849.089   10  444 -23778.080 -13433.718  43.5%  8417 2923s
   458   454 -18930.466   11  596 -23778.080 -13433.718  43.5%  7880 2952s
   518   482 -19006.142   12  590 -23778.080 -13477.658  43.3%  7627 2984s
   584   513 -19337.973   13  581 -23778.080 -13479.047  43.3%  7550 3015s
   645   546 -19237.708   17  354 -23778.080 -13479.047  43.3%  7414 3046s
   698   597 -19504.013   14  598 -23778.080 -13479.047  43.3%  7373 3074s
   767   636 -19669.136   15  590 -23778.080 -13479.047  43.3%  7110 3104s
   842   660 -19566.763   20  334 -23778.080 -13479.047  43.3%  6837 3132s
   911   698 -19686.186   16  547 -23778.080 -13479.047  43.3%  6563 3161s
   996   720 -20523.761   17  602 -23778.080 -13479.047  43.3%  6389 3190s
  1075   758 -20639.347   18  594 -23778.080 -13479.047  43.3%  6243 3222s
  1154   779 -20834.934   19  603 -23778.080 -13479.047  43.3%  6090 3254s
  1246   844 -21137.561   20  601 -23778.080 -13479.047  43.3%  5989 3283s
  1349   881 infeasible   21      -23778.080 -13479.047  43.3%  5817 3316s
  1480   893 -22049.839   21  398 -23778.080 -13479.047  43.3%  5674 3353s
  1566   897 -22617.882   25  183 -23778.080 -13479.047  43.3%  5680 3391s
  1622   953 infeasible   28      -23778.080 -13479.047  43.3%  5734 3427s
  1728   979     cutoff   35      -23778.080 -13479.047  43.3%  5672 3465s
  1824   996 -23536.864   39  179 -23778.080 -14071.564  40.8%  5679 3503s
  1900  1018 -19832.858   11  134 -23778.080 -14071.564  40.8%  5711 3545s
  1958  1054 -21816.524   13   85 -23778.080 -14071.564  40.8%  5785 3590s
  2035  1059 infeasible   26      -23778.080 -14211.785  40.2%  5831 3600s

Cutting planes:
  Learned: 2
  Gomory: 5
  Implied bound: 186
  MIR: 3209
  Flow cover: 3072
  Zero half: 19
  RLT: 196
  Relax-and-lift: 753

Explored 2062 nodes (12705261 simplex iterations) in 3600.05 seconds (5074.89 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -23778.1 -23781 -23802.8 ... -24070.4

Time limit reached
Best objective -2.377807968062e+04, best bound -1.421178450658e+04, gap 40.2316%
  WARNING: Time limit reached. Using best solution found (gap: 40.23%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = -23778.08, θ = 100814.31
  Upper Bound (UB) = -23778.08

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 100814.31
  [DEBUG]   ✓ Scenario 0: θ = 100814.31 ≤ Q = 100814.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 100814.31 ≤ Q = 100814.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 100814.31 ≤ Q = 100814.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 100814.31 ≤ Q = 100814.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 100814.31 ≤ Q = 100814.31 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 100814.31 ≤ Q = 100814.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 100814.31 ≤ Q = 100814.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 100814.31 ≤ Q = 100814.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 100814.31 ≤ Q = 100814.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 100814.31 ≤ Q = 100814.31 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 10] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x1efb0779
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x1efb0779
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.260460e+13
Presolve removed 2553 rows and 1846 columns
Presolve time: 0.01s
Presolved: 540 rows, 543 columns, 1523 nonzeros
Found heuristic solution: objective 6839846.3205
Variable types: 367 continuous, 176 integer (176 binary)

Root relaxation: objective -1.276377e+05, 252 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -127637.70    0  124 6839846.32 -127637.70   102%     -    0s
H    0     0                    -89245.18134 -127637.70  43.0%     -    0s
H    0     0                    -89846.64367 -127637.70  42.1%     -    0s
H    0     0                    -92421.47812 -95311.958  3.13%     -    0s
     0     0 -95311.958    0   87 -92421.478 -95311.958  3.13%     -    0s
H    0     0                    -92743.87919 -95256.975  2.71%     -    0s
H    0     0                    -93382.61878 -95256.975  2.01%     -    0s
H    0     0                    -93705.01985 -95256.975  1.66%     -    0s
     0     0 -94983.042    0   88 -93705.020 -94983.042  1.36%     -    0s
H    0     0                    -93739.75789 -94974.477  1.32%     -    0s
     0     0 -94974.477    0   88 -93739.758 -94974.477  1.32%     -    0s
     0     0 -94918.493    0   32 -93739.758 -94918.493  1.26%     -    0s
     0     0 -94805.663    0   87 -93739.758 -94805.663  1.14%     -    0s
     0     0 -94754.049    0   92 -93739.758 -94754.049  1.08%     -    0s
     0     0 -94735.965    0   92 -93739.758 -94735.965  1.06%     -    0s
     0     0 -94677.262    0   83 -93739.758 -94677.262  1.00%     -    0s
     0     0 -94630.282    0   86 -93739.758 -94630.282  0.95%     -    0s
     0     0 -94560.609    0   93 -93739.758 -94560.609  0.88%     -    0s
     0     0 -94520.326    0   93 -93739.758 -94520.326  0.83%     -    0s
     0     2 -94496.859    0   93 -93739.758 -94496.859  0.81%     -    0s
H   28    24                    -94171.27981 -94401.404  0.24%   8.5    0s
H   35    17                    -94347.85179 -94401.404  0.06%  11.4    0s
*   70     1              10    -94350.33640 -94376.039  0.03%   9.9    0s
*   71     1               9    -94353.79189 -94376.039  0.02%   9.8    0s
H   79     1                    -94360.96110 -94376.039  0.02%   9.2    0s

Cutting planes:
  Gomory: 36
  MIR: 197
  RLT: 2

Explored 81 nodes (1311 simplex iterations) in 0.18 seconds (0.07 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -94361 -94353.8 -94350.3 ... -89245.2
No other solutions better than -94361

Optimal solution found (tolerance 1.00e-04)
Best objective -9.436096110205e+04, best bound -9.436096110205e+04, gap 0.0000%
  Subproblem solved in 0.21s
  Worst-case operational profit (Z_SP) = 99199.53
  Scenario: 8 demand increases, 52 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -94360.96
  [DEBUG]   S×d_nominal = 193560.50
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 193560.50 + -94360.96 = 99199.53
  [DEBUG]   Current θ from Master = 100814.31
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1614.78 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -25392.86
  Lower Bound (LB) = -24370.17
  Gap (UB-LB) = 592.0949, Absolute Gap = 592.0949, Relative Gap = 0.024901
  Not converged yet (gap = 592.09 > ε = 200)

  [DEBUG] Adding NEW scenario 10 to Master Problem...
  [DEBUG] New scenario pattern: 8 increases, 52 decreases
    [DEBUG] Scenario 10 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 10 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 10]
    [DEBUG]   - Total constraints in model: 169573
    [DEBUG]   - Total variables in model: 70900
  [DEBUG] Total scenarios in Master: 11
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 11
================================================================================
[Iteration 11] Solving Master Problem...
  Current scenarios in Master: 11
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 169573 rows, 70900 columns and 481324 nonzeros
Model fingerprint: 0xbe3c7f83
Variable types: 68641 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 69042 rows and 28042 columns
Presolve time: 4.09s
Presolved: 100531 rows, 42858 columns, 607577 nonzeros
Variable types: 40599 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -362637.8474
Found heuristic solution: objective -192025.5558

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.37s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 4.572e+06
 Factor NZ  : 1.009e+07 (roughly 140 MB of memory)
 Factor Ops : 1.847e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.33728654e+07  1.74379620e+08  7.44e+04 2.49e+01  5.74e+04     6s
   1  -1.01294146e+07  1.47510522e+08  5.21e+04 6.20e+01  3.99e+04     6s
   2  -3.92987228e+06  1.17925341e+08  1.92e+04 6.99e+00  1.55e+04     6s
   3  -9.12334833e+05  8.48436091e+07  2.35e+03 2.92e-11  2.22e+03     6s
   4  -5.16830791e+05  3.95178565e+07  4.71e+02 7.31e-01  5.35e+02     7s
   5  -3.89737871e+05  2.57979551e+07  1.53e+02 3.48e-01  2.37e+02     7s
   6  -2.61026639e+05  1.74903572e+07  2.72e+01 1.03e-11  1.11e+02     7s
   7  -1.65729374e+05  1.35920991e+07  6.40e+00 7.77e-12  7.76e+01     7s
   8  -1.17483685e+05  4.39014922e+06  2.33e+00 7.48e-12  2.49e+01     7s
   9  -8.53527305e+04  2.49803242e+06  1.30e+00 3.64e-12  1.42e+01     7s
  10  -6.48000452e+04  9.82707700e+05  8.27e-01 3.95e-03  5.73e+00     7s
  11  -4.62502751e+04  3.65086546e+05  4.80e-01 1.35e-12  2.24e+00     7s
  12  -3.19397897e+04  1.46264448e+05  2.51e-01 7.75e-13  9.70e-01     7s
  13  -2.60560166e+04  8.49685055e+04  1.82e-01 5.80e-13  6.04e-01     7s
  14  -2.14017198e+04  6.35699772e+04  1.37e-01 3.20e-13  4.62e-01     8s
  15  -1.70982725e+04  4.73253738e+04  1.07e-01 2.47e-04  3.50e-01     8s
  16  -1.42066239e+04  3.15175368e+04  8.76e-02 8.70e-04  2.49e-01     8s
  17  -1.28426228e+04  2.56559663e+04  7.96e-02 8.69e-04  2.09e-01     8s
  18  -1.12964233e+04  2.32290555e+04  7.05e-02 1.09e-03  1.88e-01     8s
  19  -9.61178205e+03  2.01863656e+04  6.13e-02 9.90e-04  1.62e-01     8s
  20  -7.23086577e+03  1.73924074e+04  4.79e-02 1.04e-03  1.34e-01     8s
  21  -6.15117924e+03  1.08270296e+04  4.20e-02 2.28e-03  9.23e-02     8s
  22  -4.41272783e+03  9.56586518e+03  3.26e-02 2.90e-03  7.60e-02     8s
  23  -3.58575593e+03  8.38135916e+03  2.79e-02 2.18e-03  6.51e-02     9s
  24  -2.77614019e+03  6.65488401e+03  2.33e-02 1.60e-03  5.13e-02     9s
  25  -2.06507288e+03  5.71009275e+03  1.94e-02 1.38e-03  4.23e-02     9s
  26  -1.55192146e+03  4.73885637e+03  1.67e-02 1.04e-03  3.42e-02     9s
  27  -8.37070571e+02  4.04933587e+03  1.29e-02 8.30e-04  2.66e-02     9s
  28  -2.08259867e+02  3.52834723e+03  9.55e-03 6.20e-04  2.03e-02     9s
  29   2.14419589e+02  3.06970931e+03  7.40e-03 4.64e-04  1.55e-02     9s
  30   3.88048514e+02  2.73876765e+03  6.56e-03 3.43e-04  1.28e-02    10s
  31   7.95721707e+02  2.48574868e+03  4.64e-03 2.49e-04  9.19e-03    10s
  32   1.03993629e+03  2.20374803e+03  3.48e-03 1.45e-04  6.33e-03    10s
  33   1.16907397e+03  2.15566903e+03  2.86e-03 1.28e-04  5.36e-03    10s
  34   1.24861232e+03  2.04188297e+03  2.50e-03 1.19e-04  4.31e-03    10s
  35   1.36226956e+03  1.96052425e+03  1.98e-03 7.67e-05  3.25e-03    10s
  36   1.46899279e+03  1.89866842e+03  1.48e-03 3.87e-05  2.34e-03    10s
  37   1.52845043e+03  1.88950830e+03  1.22e-03 3.43e-05  1.96e-03    11s
  38   1.57543401e+03  1.87100885e+03  9.97e-04 2.67e-05  1.61e-03    11s
  39   1.58190308e+03  1.84748465e+03  9.69e-04 1.71e-05  1.44e-03    11s
  40   1.62843543e+03  1.83283238e+03  7.61e-04 1.06e-05  1.11e-03    11s
  41   1.69605432e+03  1.82429148e+03  4.75e-04 7.29e-06  6.97e-04    11s
  42   1.71374696e+03  1.82186904e+03  4.02e-04 7.99e-06  5.88e-04    11s
  43   1.76141483e+03  1.81603936e+03  1.85e-04 4.37e-06  2.97e-04    12s
  44   1.77709435e+03  1.81147146e+03  1.14e-04 2.89e-06  1.87e-04    12s
  45   1.78805608e+03  1.80903949e+03  6.85e-05 1.69e-06  1.14e-04    12s
  46   1.79144095e+03  1.80832795e+03  5.48e-05 1.37e-06  9.18e-05    12s
  47   1.79763487e+03  1.80699023e+03  2.91e-05 7.72e-07  5.09e-05    12s
  48   1.80254709e+03  1.80543970e+03  9.68e-06 1.41e-07  1.57e-05    12s
  49   1.80386267e+03  1.80503863e+03  4.30e-06 6.24e-07  6.40e-06    12s
  50   1.80432556e+03  1.80502828e+03  2.52e-06 3.64e-07  3.82e-06    12s
  51   1.80473154e+03  1.80503207e+03  9.99e-07 1.19e-09  1.63e-06    13s
  52   1.80500894e+03  1.80501377e+03  4.36e-08 3.98e-08  2.62e-08    13s
  53   1.80501249e+03  1.80501257e+03  2.75e-08 1.81e-09  4.68e-10    13s
  54   1.80501257e+03  1.80501257e+03  6.04e-09 6.01e-10  6.02e-12    13s

Barrier solved model in 54 iterations and 13.07 seconds (9.68 work units)
Optimal objective 1.80501257e+03


Root crossover log...

   73850 DPushes remaining with DInf 0.0000000e+00                13s
    5420 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                16s

    3884 PPushes remaining with PInf 1.2811915e-06                16s
       0 PPushes remaining with PInf 0.0000000e+00                16s

  Push phase complete: Pinf 0.0000000e+00, Dinf 6.0650801e-11     16s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   31939    1.8050126e+03   0.000000e+00   0.000000e+00     16s
   31939    1.8050126e+03   0.000000e+00   0.000000e+00     16s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 1.805013e+03, 31939 iterations, 11.46 seconds (12.31 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 1805.01257    0  609 -192025.56 1805.01257   101%     -   18s
H    0     0                    -187036.9854 1805.01257   101%     -   18s
H    0     0                    -136085.3379 1805.01257   101%     -   18s
H    0     0                    -136053.1544 1805.01257   101%     -   18s
H    0     0                    -134959.1610 1805.01257   101%     -   18s
H    0     0                    -132820.8668 1805.01257   101%     -   18s
H    0     0                    -82709.01311 1805.01257   102%     -   18s
H    0     0                    -72842.04701 1805.01257   102%     -   19s
H    0     0                    -64743.50267 1805.01257   103%     -   19s
H    0     0                    -63057.52806 1805.01257   103%     -   19s
H    0     0                    -62964.90698 1805.01257   103%     -   19s
H    0     0                    -58184.91077 -2606.7567  95.5%     -   94s
H    0     0                    -54418.04514 -2606.7567  95.2%     -   94s
H    0     0                    -54253.62438 -2606.7567  95.2%     -   94s
     0     0 -2642.9270    0  634 -54253.624 -2642.9270  95.1%     -   94s
H    0     0                    -54000.69015 -2642.9270  95.1%     -   95s
H    0     0                    -53912.18616 -2642.9270  95.1%     -   95s
     0     0 -3401.3730    0  650 -53912.186 -3401.3730  93.7%     -  140s
     0     0 -3494.9649    0  649 -53912.186 -3494.9649  93.5%     -  157s
     0     0 -3566.3311    0  649 -53912.186 -3566.3311  93.4%     -  173s
     0     0 -3566.3311    0  656 -53912.186 -3566.3311  93.4%     -  180s
     0     0 -3566.3311    0  662 -53912.186 -3566.3311  93.4%     -  185s
     0     0 -3566.3311    0  660 -53912.186 -3566.3311  93.4%     -  195s
     0     0 -3566.3311    0  661 -53912.186 -3566.3311  93.4%     -  197s
     0     0 -3566.3311    0  660 -53912.186 -3566.3311  93.4%     -  199s
H    0     0                    -51776.83146 -6947.7281  86.6%     -  313s
H    0     0                    -51399.86752 -6947.7281  86.5%     -  313s
     0     0 -6947.7281    0  673 -51399.868 -6947.7281  86.5%     -  313s
H    0     0                    -35468.82842 -6948.5184  80.4%     -  314s
H    0     0                    -35380.65708 -6948.5184  80.4%     -  315s
     0     0 -7681.4356    0  729 -35380.657 -7681.4356  78.3%     -  409s
     0     0 -7930.1098    0  752 -35380.657 -7930.1098  77.6%     -  468s
     0     0 -8014.7274    0  767 -35380.657 -8014.7274  77.3%     -  513s
     0     0 -8086.8229    0  764 -35380.657 -8086.8229  77.1%     -  549s
H    0     0                    -34125.96011 -8142.1756  76.1%     -  580s
H    0     0                    -33937.09050 -8142.1756  76.0%     -  580s
H    0     0                    -33799.10744 -8142.1756  75.9%     -  580s
H    0     0                    -33795.33299 -8142.1756  75.9%     -  580s
H    0     0                    -33761.76335 -8142.1756  75.9%     -  580s
H    0     0                    -33757.24242 -8142.1756  75.9%     -  580s
H    0     0                    -33747.31435 -8142.1756  75.9%     -  580s
H    0     0                    -33743.53989 -8142.1756  75.9%     -  580s
H    0     0                    -33742.64870 -8142.1756  75.9%     -  580s
H    0     0                    -33738.12777 -8142.1756  75.9%     -  580s
H    0     0                    -33737.25463 -8142.1756  75.9%     -  580s
H    0     0                    -33734.40772 -8142.1756  75.9%     -  580s
H    0     0                    -33708.95843 -8142.1756  75.8%     -  580s
H    0     0                    -33700.83808 -8142.1756  75.8%     -  580s
H    0     0                    -33695.77183 -8142.1756  75.8%     -  580s
     0     0 -8142.1756    0  760 -33695.772 -8142.1756  75.8%     -  581s
H    0     0                    -33167.29935 -8232.9031  75.2%     -  613s
H    0     0                    -33025.57329 -8232.9031  75.1%     -  613s
H    0     0                    -33018.22482 -8232.9031  75.1%     -  613s
H    0     0                    -33016.93302 -8232.9031  75.1%     -  613s
H    0     0                    -32974.14936 -8232.9031  75.0%     -  613s
H    0     0                    -32908.79604 -8232.9031  75.0%     -  613s
     0     0 -8232.9031    0  764 -32908.796 -8232.9031  75.0%     -  613s
     0     0 -8272.9821    0  756 -32908.796 -8272.9821  74.9%     -  636s
     0     0 -8294.0951    0  774 -32908.796 -8294.0951  74.8%     -  652s
H    0     0                    -32719.55992 -8309.3004  74.6%     -  664s
H    0     0                    -32715.78547 -8309.3004  74.6%     -  664s
H    0     0                    -32668.23332 -8309.3004  74.6%     -  664s
H    0     0                    -32664.45887 -8309.3004  74.6%     -  664s
     0     0 -8309.3004    0  775 -32664.459 -8309.3004  74.6%     -  664s
     0     0 -8325.1114    0  768 -32664.459 -8325.1114  74.5%     -  678s
     0     0 -8330.5386    0  775 -32664.459 -8330.5386  74.5%     -  683s
     0     0 -8333.4572    0  768 -32664.459 -8333.4572  74.5%     -  688s
     0     0 -8333.9530    0  769 -32664.459 -8333.9530  74.5%     -  690s
H    0     0                    -32348.51155 -10214.422  68.4%     -  896s
H    0     0                    -31870.66427 -10214.422  68.0%     -  896s
H    0     0                    -31847.04107 -10214.422  67.9%     -  896s
H    0     0                    -31791.72834 -10214.422  67.9%     -  896s
H    0     0                    -31735.25286 -10214.422  67.8%     -  896s
H    0     0                    -31384.01397 -10214.422  67.5%     -  896s
H    0     0                    -31377.94282 -10214.422  67.4%     -  896s
H    0     0                    -31365.28026 -10214.422  67.4%     -  896s
H    0     0                    -31352.74238 -10214.422  67.4%     -  896s
H    0     0                    -30363.82173 -10214.422  66.4%     -  896s
H    0     0                    -30363.58908 -10214.422  66.4%     -  896s
H    0     0                    -30351.11956 -10214.422  66.3%     -  896s
H    0     0                    -30350.81171 -10214.422  66.3%     -  896s
H    0     0                    -30310.86353 -10214.422  66.3%     -  896s
     0     0 -10214.422    0  766 -30310.864 -10214.422  66.3%     -  896s
H    0     0                    -30300.28013 -10214.578  66.3%     -  897s
H    0     0                    -30278.06679 -10214.578  66.3%     -  897s
H    0     0                    -30248.43038 -10214.578  66.2%     -  897s
     0     0 -10705.551    0  751 -30248.430 -10705.551  64.6%     -  991s
H    0     0                    -30247.56929 -10938.119  63.8%     - 1054s
H    0     0                    -30238.49695 -10938.119  63.8%     - 1054s
     0     0 -10938.119    0  682 -30238.497 -10938.119  63.8%     - 1054s
     0     0 -11132.572    0  675 -30238.497 -11132.572  63.2%     - 1097s
     0     0 -11162.215    0  702 -30238.497 -11162.215  63.1%     - 1113s
     0     0 -11178.871    0  682 -30238.497 -11178.871  63.0%     - 1122s
H    0     0                    -30112.57549 -11189.683  62.8%     - 1133s
H    0     0                    -30086.12867 -11189.683  62.8%     - 1133s
H    0     0                    -30083.29306 -11189.683  62.8%     - 1133s
     0     0 -11189.683    0  689 -30083.293 -11189.683  62.8%     - 1133s
     0     0 -11200.485    0  686 -30083.293 -11200.485  62.8%     - 1146s
     0     0 -11201.709    0  757 -30083.293 -11201.709  62.8%     - 1151s
H    0     0                    -29578.45028 -11797.167  60.1%     - 1272s
H    0     0                    -29533.65368 -11797.167  60.1%     - 1272s
H    0     0                    -29389.79439 -11797.167  59.9%     - 1272s
H    0     0                    -28355.27228 -11797.167  58.4%     - 1272s
     0     0 -11797.167    0  733 -28355.272 -11797.167  58.4%     - 1272s
H    0     0                    -28225.73830 -11797.430  58.2%     - 1274s
     0     0 -11963.450    0  569 -28225.738 -11963.450  57.6%     - 1330s
     0     0 -12043.299    0  570 -28225.738 -12043.299  57.3%     - 1374s
     0     0 -12088.556    0  669 -28225.738 -12088.556  57.2%     - 1420s
     0     0 -12113.146    0  830 -28225.738 -12113.146  57.1%     - 1441s
     0     0 -12126.389    0  687 -28225.738 -12126.389  57.0%     - 1460s
     0     0 -12144.206    0  692 -28225.738 -12144.206  57.0%     - 1473s
     0     0 -12147.537    0  709 -28225.738 -12147.537  57.0%     - 1481s
     0     0 -12149.836    0  709 -28225.738 -12149.836  57.0%     - 1490s
     0     0 -12384.397    0  698 -28225.738 -12384.397  56.1%     - 1535s
     0     0 -12430.720    0  601 -28225.738 -12430.720  56.0%     - 1566s
     0     0 -12445.188    0  759 -28225.738 -12445.188  55.9%     - 1586s
     0     0 -12452.444    0  609 -28225.738 -12452.444  55.9%     - 1594s
     0     0 -12455.106    0  614 -28225.738 -12455.106  55.9%     - 1599s
     0     0 -12455.497    0  609 -28225.738 -12455.497  55.9%     - 1601s
     0     0 -12532.736    0  613 -28225.738 -12532.736  55.6%     - 1645s
H    0     0                    -25388.80767 -12532.903  50.6%     - 1678s
H    0     0                    -24447.45262 -12532.903  48.7%     - 1678s
H    0     0                    -24445.91750 -12532.903  48.7%     - 1678s
H    0     0                    -24393.96407 -12532.903  48.6%     - 1678s
     0     0 -12544.554    0  641 -24393.964 -12544.554  48.6%     - 1701s
     0     0 -12553.699    0  621 -24393.964 -12553.699  48.5%     - 1716s
     0     0 -12555.396    0  613 -24393.964 -12555.396  48.5%     - 1721s
     0     0 -12605.354    0  848 -24393.964 -12605.354  48.3%     - 1752s
     0     0 -12626.792    0  619 -24393.964 -12626.792  48.2%     - 1776s
     0     0 -12635.215    0  620 -24393.964 -12635.215  48.2%     - 1801s
     0     0 -12636.912    0  638 -24393.964 -12636.912  48.2%     - 1811s
     0     0 -12669.689    0  635 -24393.964 -12669.689  48.1%     - 1842s
     0     0 -12679.528    0  650 -24393.964 -12679.528  48.0%     - 1866s
     0     0 -12681.817    0  650 -24393.964 -12681.817  48.0%     - 1874s
     0     0 -12699.799    0  636 -24393.964 -12699.799  47.9%     - 1896s
     0     0 -12704.364    0  648 -24393.964 -12704.364  47.9%     - 1917s
     0     0 -12706.792    0  642 -24393.964 -12706.792  47.9%     - 1930s
     0     0 -12714.174    0  647 -24393.964 -12714.174  47.9%     - 1972s
     0     0 -12716.932    0  645 -24393.964 -12716.932  47.9%     - 1987s
     0     0 -12781.147    0  740 -24393.964 -12781.147  47.6%     - 2035s
     0     0 -12826.957    0  792 -24393.964 -12826.957  47.4%     - 2072s
     0     0 -12836.710    0  813 -24393.964 -12836.710  47.4%     - 2089s
     0     0 -12867.593    0  713 -24393.964 -12867.593  47.3%     - 2121s
     0     0 -12881.236    0  812 -24393.964 -12881.236  47.2%     - 2140s
     0     0 -12896.517    0  794 -24393.964 -12896.517  47.1%     - 2159s
     0     0 -12906.838    0  799 -24393.964 -12906.838  47.1%     - 2176s
     0     0 -12909.237    0  800 -24393.964 -12909.237  47.1%     - 2185s
     0     0 -12935.776    0  618 -24393.964 -12935.776  47.0%     - 2213s
H    0     0                    -24249.08053 -12935.841  46.7%     - 2217s
H    0     0                    -24131.96636 -12935.841  46.4%     - 2218s
     0     0 -12942.350    0  615 -24131.966 -12942.350  46.4%     - 2229s
     0     0 -12943.497    0  620 -24131.966 -12943.497  46.4%     - 2236s
     0     0 -12950.910    0  613 -24131.966 -12950.910  46.3%     - 2251s
     0     0 -12953.816    0  613 -24131.966 -12953.816  46.3%     - 2261s
     0     0 -12954.406    0  620 -24131.966 -12954.406  46.3%     - 2265s
     0     0 -12959.656    0  623 -24131.966 -12959.656  46.3%     - 2279s
     0     0 -12959.780    0  623 -24131.966 -12959.780  46.3%     - 2288s
H    0     0                    -24126.67574 -12959.788  46.3%     - 2395s
H    0     0                    -24065.43025 -12959.788  46.1%     - 2395s
H    0     0                    -24057.36947 -12959.788  46.1%     - 2549s
H    0     0                    -24055.44829 -12959.788  46.1%     - 2549s
H    0     0                    -24043.96727 -12959.788  46.1%     - 2549s
H    0     0                    -24033.37803 -12959.788  46.1%     - 2549s
     0     2 -12959.788    0  623 -24033.378 -12959.788  46.1%     - 2559s
     1     3 -13164.907    1  588 -24033.378 -12960.083  46.1%  7221 2580s
     2     4 -13315.561    1  680 -24033.378 -13165.156  45.2% 13776 2635s
     3     6 -13346.490    2  681 -24033.378 -13166.648  45.2% 11815 2671s
     5    12 -13849.814    3  579 -24033.378 -13315.680  44.6% 12382 2708s
    11    23 -13891.597    4  582 -24033.378 -13614.445  43.4% 10422 2797s
    22    34 -14658.156    5  563 -24033.378 -13719.845  42.9% 19995 2909s
    33    65 -14703.835    4  599 -24033.378 -13719.845  42.9% 17770 3133s
H   34    65                    -23999.48479 -13719.845  42.8% 17247 3133s
    64    97 -14766.909    5  734 -23999.485 -13719.845  42.8% 21424 3281s
    96   147 -14877.502    6  734 -23999.485 -13719.845  42.8% 17732 3377s
H  104   147                    -23992.92108 -13719.845  42.8% 16775 3377s
   146   261 -14964.722    7  735 -23992.921 -13719.845  42.8% 13278 3471s
   260   347 -15115.741   12  653 -23992.921 -13719.845  42.8%  9638 3523s
   354   416 -15280.033   14  645 -23992.921 -13719.845  42.8%  8558 3566s
   444   475 -15997.230   19  469 -23992.921 -13719.845  42.8%  7682 3600s

Cutting planes:
  Learned: 4
  Implied bound: 135
  MIR: 3416
  Flow cover: 3244
  Zero half: 20
  RLT: 227
  Relax-and-lift: 828

Explored 525 nodes (4625440 simplex iterations) in 3600.06 seconds (4713.14 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -23992.9 -23999.5 -24033.4 ... -24249.1

Time limit reached
Best objective -2.399292107885e+04, best bound -1.371984459835e+04, gap 42.8171%
  WARNING: Time limit reached. Using best solution found (gap: 42.82%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = -23992.92, θ = 99966.33
  Upper Bound (UB) = -23992.92

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 99966.33
  [DEBUG]   ✓ Scenario 0: θ = 99966.33 ≤ Q = 99966.33 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 99966.33 ≤ Q = 99966.33 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 99966.33 ≤ Q = 99966.33 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 99966.33 ≤ Q = 99966.33 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 99966.33 ≤ Q = 99966.33 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 99966.33 ≤ Q = 99966.33 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 99966.33 ≤ Q = 99966.33 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 99966.33 ≤ Q = 99966.33 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 99966.33 ≤ Q = 99966.33 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 99966.33 ≤ Q = 99966.33 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 99966.33 ≤ Q = 99966.33 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 11] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x60546e7e
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x60546e7e
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [5e-01, 2e+02]
Found heuristic solution: objective 1.221037e+13
Presolve removed 2553 rows and 1846 columns
Presolve time: 0.01s
Presolved: 540 rows, 543 columns, 1523 nonzeros
Found heuristic solution: objective 6608046.6373
Variable types: 367 continuous, 176 integer (176 binary)

Root relaxation: objective -1.274683e+05, 254 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -127468.28    0  124 6608046.64 -127468.28   102%     -    0s
H    0     0                    -88928.33521 -127468.28  43.3%     -    0s
H    0     0                    -89385.58241 -127468.28  42.6%     -    0s
     0     0 -98637.004    0   38 -89385.582 -98637.004  10.4%     -    0s
H    0     0                    -97956.98588 -98603.043  0.66%     -    0s
     0     0 -98395.048    0   20 -97956.986 -98395.048  0.45%     -    0s
H    0     0                    -98198.72538 -98390.244  0.20%     -    0s
H    0     0                    -98221.34905 -98390.244  0.17%     -    0s
     0     0 -98382.976    0   18 -98221.349 -98382.976  0.16%     -    0s
     0     0 -98376.141    0   14 -98221.349 -98376.141  0.16%     -    0s
     0     0 -98349.342    0   13 -98221.349 -98349.342  0.13%     -    0s
H    0     0                    -98234.46033 -98349.342  0.12%     -    0s
     0     0 -98271.410    0    3 -98234.460 -98271.410  0.04%     -    0s
     0     0 -98263.371    0    4 -98234.460 -98263.371  0.03%     -    0s
H    0     0                    -98256.15447 -98263.371  0.01%     -    0s

Explored 1 nodes (530 simplex iterations) in 0.12 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 7: -98256.2 -98234.5 -98221.3 ... 1.22104e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -9.825615447024e+04, best bound -9.826337115457e+04, gap 0.0073%
  Subproblem solved in 0.15s
  Worst-case operational profit (Z_SP) = 94470.09
  Scenario: 11 demand increases, 49 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -98256.15
  [DEBUG]   S×d_nominal = 192726.25
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 192726.25 + -98256.15 = 94470.09
  [DEBUG]   Current θ from Master = 99966.33
  [DEBUG]   ⚠️  Z_SP ≤ θ by 5496.24 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -29489.16
  Lower Bound (LB) = -24370.17
  Gap (UB-LB) = 377.2535, Absolute Gap = 377.2535, Relative Gap = 0.015724
  Not converged yet (gap = 377.25 > ε = 200)

  [DEBUG] Adding NEW scenario 11 to Master Problem...
  [DEBUG] New scenario pattern: 11 increases, 49 decreases
    [DEBUG] Scenario 11 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 11 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 11]
    [DEBUG]   - Total constraints in model: 184863
    [DEBUG]   - Total variables in model: 77140
  [DEBUG] Total scenarios in Master: 12
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 12
================================================================================
[Iteration 12] Solving Master Problem...
  Current scenarios in Master: 12
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 184863 rows, 77140 columns and 524579 nonzeros
Model fingerprint: 0xdeeea20e
Variable types: 74881 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 75324 rows and 30594 columns
Presolve time: 3.25s
Presolved: 109539 rows, 46546 columns, 660071 nonzeros
Variable types: 44287 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -362663.4623
Found heuristic solution: objective -192025.5558

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.32s

Barrier statistics:
 Dense cols : 665
 AA' NZ     : 3.796e+06
 Factor NZ  : 9.163e+06 (roughly 140 MB of memory)
 Factor Ops : 1.759e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.32284607e+07  1.87423569e+08  7.36e+04 2.53e+01  5.63e+04     5s
   1  -1.00387623e+07  1.58446224e+08  5.15e+04 6.20e+01  3.92e+04     5s
   2  -4.38928540e+06  1.22929905e+08  2.13e+04 1.63e+01  1.68e+04     5s
   3  -7.24901206e+05  8.51306875e+07  1.46e+03 2.09e-01  1.49e+03     6s
   4  -5.09099790e+05  6.43041130e+07  4.83e+02 1.42e-01  6.58e+02     6s
   5  -4.08631976e+05  3.94755548e+07  1.68e+02 7.73e-02  3.05e+02     6s
   6  -3.36091029e+05  2.75008630e+07  4.84e+01 5.03e-02  1.66e+02     6s
   7  -2.64073212e+05  1.94812097e+07  1.22e+01 3.42e-02  1.04e+02     6s
   8  -1.79905655e+05  1.06475655e+07  4.52e+00 1.82e-02  5.53e+01     6s
   9  -1.17999502e+05  3.62117567e+06  1.50e+00 5.81e-03  1.88e+01     6s
  10  -8.08446696e+04  1.25535654e+06  7.45e-01 1.93e-03  6.70e+00     6s
  11  -6.17722025e+04  5.95914507e+05  5.26e-01 9.10e-04  3.29e+00     6s
  12  -4.66829717e+04  3.55479984e+05  3.56e-01 5.80e-04  2.01e+00     6s
  13  -3.10579413e+04  1.73444502e+05  1.88e-01 3.82e-04  1.02e+00     6s
  14  -2.35510459e+04  9.69521407e+04  1.40e-01 7.49e-04  6.02e-01     7s
  15  -1.93907829e+04  7.85957859e+04  1.12e-01 6.51e-04  4.89e-01     7s
  16  -1.45741425e+04  5.49995787e+04  8.13e-02 6.11e-04  3.47e-01     7s
  17  -1.15947089e+04  4.09509425e+04  6.38e-02 1.02e-03  2.62e-01     7s
  18  -9.24747721e+03  2.93704438e+04  5.13e-02 1.16e-03  1.93e-01     7s
  19  -6.59086205e+03  1.81492683e+04  3.84e-02 1.27e-03  1.24e-01     7s
  20  -5.04616243e+03  1.49134429e+04  3.10e-02 1.17e-03  9.97e-02     7s
  21  -3.54661861e+03  1.21724567e+04  2.36e-02 1.00e-03  7.85e-02     7s
  22  -2.69551961e+03  9.55071019e+03  1.96e-02 9.88e-04  6.11e-02     7s
  23  -1.81648764e+03  7.27398212e+03  1.55e-02 6.90e-04  4.54e-02     7s
  24  -7.65446303e+02  6.25043593e+03  1.06e-02 5.60e-04  3.50e-02     8s
  25  -2.21832005e+02  5.31172414e+03  8.30e-03 4.62e-04  2.76e-02     8s
  26   1.57558884e+02  4.63198473e+03  6.71e-03 3.69e-04  2.23e-02     8s
  27   3.19525120e+02  3.79440800e+03  6.04e-03 2.49e-04  1.73e-02     8s
  28   6.72007713e+02  3.38858790e+03  4.62e-03 1.89e-04  1.36e-02     8s
  29   1.02842188e+03  3.16445430e+03  3.19e-03 1.63e-04  1.07e-02     8s
  30   1.25587931e+03  2.52169156e+03  2.32e-03 1.16e-04  6.32e-03     8s
  31   1.28701462e+03  2.42664171e+03  2.20e-03 1.02e-04  5.69e-03     8s
  32   1.45245531e+03  2.32344903e+03  1.59e-03 7.82e-05  4.35e-03     9s
  33   1.56131203e+03  2.19262447e+03  1.19e-03 5.03e-05  3.15e-03     9s
  34   1.61414929e+03  2.11955072e+03  1.01e-03 6.95e-05  2.52e-03     9s
  35   1.68605714e+03  2.06204938e+03  7.44e-04 5.06e-05  1.88e-03     9s
  36   1.74517556e+03  2.01970203e+03  5.32e-04 3.67e-05  1.37e-03     9s
  37   1.77227241e+03  1.99646961e+03  4.35e-04 2.92e-05  1.12e-03     9s
  38   1.80672006e+03  1.98210577e+03  3.13e-04 2.47e-05  8.76e-04     9s
  39   1.82356293e+03  1.95930935e+03  2.56e-04 1.75e-05  6.78e-04    10s
  40   1.83936388e+03  1.93503870e+03  2.04e-04 2.15e-05  4.78e-04    10s
  41   1.85180004e+03  1.92693286e+03  1.62e-04 1.61e-05  3.75e-04    10s
  42   1.86426457e+03  1.92475164e+03  1.20e-04 1.46e-05  3.02e-04    10s
  43   1.86727965e+03  1.91623306e+03  1.10e-04 9.29e-06  2.44e-04    10s
  44   1.87154293e+03  1.91321353e+03  9.60e-05 7.27e-06  2.08e-04    10s
  45   1.89324369e+03  1.91070565e+03  2.65e-05 6.64e-06  8.72e-05    10s
  46   1.89705185e+03  1.90440284e+03  1.38e-05 2.90e-06  3.67e-05    11s
  47   1.90119551e+03  1.90191055e+03  7.02e-07 2.77e-07  3.57e-06    11s
  48   1.90154589e+03  1.90168044e+03  1.14e-07 3.12e-08  6.71e-07    11s
  49   1.90161377e+03  1.90161882e+03  8.96e-09 1.22e-08  2.52e-08    11s
  50   1.90161442e+03  1.90161479e+03  9.54e-09 8.31e-10  1.85e-09    11s
  51   1.90161446e+03  1.90161473e+03  3.62e-07 2.00e-08  1.34e-09    11s
  52   1.90161452e+03  1.90161471e+03  7.65e-07 8.11e-07  1.08e-09    11s
  53   1.90161447e+03  1.90161462e+03  2.16e-06 7.26e-07  5.57e-10    11s
  54   1.90161448e+03  1.90161462e+03  2.07e-06 6.93e-07  5.33e-10    11s
  55   1.90161456e+03  1.90161461e+03  8.13e-07 4.62e-08  1.65e-10    12s
  56   1.90161460e+03  1.90161460e+03  8.90e-08 5.71e-10  1.70e-11    12s

Barrier solved model in 56 iterations and 11.69 seconds (10.56 work units)
Optimal objective 1.90161460e+03


Root crossover log...

   80277 DPushes remaining with DInf 0.0000000e+00                12s
       0 DPushes remaining with DInf 0.0000000e+00                15s

    4372 PPushes remaining with PInf 3.7173325e-06                15s
     832 PPushes remaining with PInf 0.0000000e+00                15s
       0 PPushes remaining with PInf 0.0000000e+00                15s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.0313658e-01     15s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   37417    1.9016146e+03   0.000000e+00   1.031366e-01     15s
   37419    1.9016146e+03   0.000000e+00   0.000000e+00     15s
   37419    1.9016146e+03   0.000000e+00   0.000000e+00     15s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 1.901615e+03, 37419 iterations, 11.05 seconds (13.45 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 1901.61460    0  612 -192025.56 1901.61460   101%     -   16s
H    0     0                    -184382.6964 1901.61460   101%     -   16s
H    0     0                    -170610.4780 1901.61460   101%     -   17s
H    0     0                    -163094.5258 1901.61460   101%     -   17s
H    0     0                    -162599.5879 1901.61460   101%     -   17s
H    0     0                    -153243.9101 1901.61460   101%     -   17s
H    0     0                    -151951.3764 1901.61460   101%     -   17s
H    0     0                    -146849.1818 1901.61460   101%     -   17s
H    0     0                    -146598.5286 1901.61460   101%     -   17s
H    0     0                    -146592.9856 1901.61460   101%     -   17s
H    0     0                    -68457.03532 1901.61460   103%     -   17s
H    0     0                    -68156.91033 1901.61460   103%     -   18s
H    0     0                    -63282.86670 1901.61460   103%     -   18s
H    0     0                    -50799.63503 1901.61460   104%     -   18s
H    0     0                    -50741.91750 1901.61460   104%     -   18s
H    0     0                    -50542.66285 -3548.1919  93.0%     -  104s
H    0     0                    -50534.18859 -3548.1919  93.0%     -  104s
H    0     0                    -50526.53680 -3548.1919  93.0%     -  104s
H    0     0                    -50454.15886 -3548.1919  93.0%     -  104s
H    0     0                    -50445.68460 -3548.1919  93.0%     -  104s
H    0     0                    -50444.90297 -3548.1919  93.0%     -  104s
H    0     0                    -50443.25595 -3548.1919  93.0%     -  104s
H    0     0                    -50435.60416 -3548.1919  93.0%     -  104s
     0     0 -3548.1919    0  810 -50435.604 -3548.1919  93.0%     -  105s
     0     0 -3857.6119    0  793 -50435.604 -3857.6119  92.4%     -  135s
     0     0 -3988.3851    0  783 -50435.604 -3988.3851  92.1%     -  154s
     0     0 -4003.8297    0  781 -50435.604 -4003.8297  92.1%     -  166s
     0     0 -4047.8751    0  637 -50435.604 -4047.8751  92.0%     -  175s
     0     0 -4070.5605    0  638 -50435.604 -4070.5605  91.9%     -  184s
     0     0 -4071.8073    0  783 -50435.604 -4071.8073  91.9%     -  187s
     0     0 -4155.6604    0  779 -50435.604 -4155.6604  91.8%     -  203s
     0     0 -4220.6359    0  754 -50435.604 -4220.6359  91.6%     -  215s
     0     0 -4240.5133    0  773 -50435.604 -4240.5133  91.6%     -  230s
     0     0 -4242.1226    0  779 -50435.604 -4242.1226  91.6%     -  238s
     0     0 -4242.3504    0  782 -50435.604 -4242.3504  91.6%     -  241s
H    0     0                    -50409.06913 -7308.3997  85.5%     -  367s
H    0     0                    -49955.78319 -7308.3997  85.4%     -  367s
H    0     0                    -49913.74212 -7308.3997  85.4%     -  367s
H    0     0                    -49835.71398 -7308.3997  85.3%     -  367s
     0     0 -7308.3997    0  690 -49835.714 -7308.3997  85.3%     -  377s
H    0     0                    -35809.88136 -7308.4514  79.6%     -  378s
H    0     0                    -34907.56181 -7308.4514  79.1%     -  379s
H    0     0                    -34879.94241 -7308.4514  79.0%     -  379s
     0     0 -8449.0915    0  734 -34879.942 -8449.0915  75.8%     -  528s
     0     0 -8597.0881    0  795 -34879.942 -8597.0881  75.4%     -  607s
     0     0 -8724.9760    0  693 -34879.942 -8724.9760  75.0%     -  654s
H    0     0                    -34259.08895 -8773.0346  74.4%     -  694s
H    0     0                    -33952.86736 -8773.0346  74.2%     -  694s
H    0     0                    -33948.38231 -8773.0346  74.2%     -  694s
H    0     0                    -33758.79020 -8773.0346  74.0%     -  694s
H    0     0                    -33356.68702 -8773.0346  73.7%     -  694s
H    0     0                    -33159.02493 -8773.0346  73.5%     -  694s
     0     0 -8773.0346    0  772 -33159.025 -8773.0346  73.5%     -  694s
     0     0 -8810.6397    0  765 -33159.025 -8810.6397  73.4%     -  719s
     0     0 -8848.6834    0  774 -33159.025 -8848.6834  73.3%     -  748s
     0     0 -8876.7832    0  691 -33159.025 -8876.7832  73.2%     -  777s
     0     0 -8898.4256    0  703 -33159.025 -8898.4256  73.2%     -  797s
     0     0 -8920.6270    0  683 -33159.025 -8920.6270  73.1%     -  817s
     0     0 -8924.3915    0  702 -33159.025 -8924.3915  73.1%     -  825s
H    0     0                    -33126.14826 -8936.0437  73.0%     -  845s
     0     0 -8936.0437    0  691 -33126.148 -8936.0437  73.0%     -  845s
     0     0 -8951.4226    0  690 -33126.148 -8951.4226  73.0%     -  864s
H    0     0                    -33075.01773 -8960.1504  72.9%     -  879s
     0     0 -8960.1504    0  681 -33075.018 -8960.1504  72.9%     -  879s
     0     0 -8963.2870    0  696 -33075.018 -8963.2870  72.9%     -  887s
     0     0 -8972.2233    0  769 -33075.018 -8972.2233  72.9%     -  900s
     0     0 -8976.3995    0  665 -33075.018 -8976.3995  72.9%     -  907s
     0     0 -8977.6473    0  679 -33075.018 -8977.6473  72.9%     -  912s
H    0     0                    -31808.25352 -8977.6473  71.8%     -  944s
H    0     0                    -30719.56051 -8977.6473  70.8%     -  944s
H    0     0                    -30691.98570 -8977.6473  70.7%     -  944s
     0     0 -10632.981    0  774 -30691.986 -10632.981  65.4%     - 1223s
H    0     0                    -30575.99592 -10633.032  65.2%     - 1224s
H    0     0                    -30106.86816 -10633.032  64.7%     - 1224s
H    0     0                    -30106.48210 -10633.032  64.7%     - 1224s
     0     0 -10865.922    0  775 -30106.482 -10865.922  63.9%     - 1323s
     0     0 -10932.046    0  772 -30106.482 -10932.046  63.7%     - 1377s
     0     0 -10993.229    0  854 -30106.482 -10993.229  63.5%     - 1428s
     0     0 -11008.901    0  765 -30106.482 -11008.901  63.4%     - 1453s
     0     0 -11028.366    0  849 -30106.482 -11028.366  63.4%     - 1480s
     0     0 -11036.635    0  783 -30106.482 -11036.635  63.3%     - 1494s
H    0     0                    -29640.71779 -11049.089  62.7%     - 1512s
     0     0 -11049.089    0  769 -29640.718 -11049.089  62.7%     - 1512s
H    0     0                    -29242.53398 -11062.092  62.2%     - 1527s
H    0     0                    -29005.44083 -11062.092  61.9%     - 1527s
H    0     0                    -28956.24468 -11062.092  61.8%     - 1527s
H    0     0                    -28944.09934 -11062.092  61.8%     - 1527s
     0     0 -11062.092    0  756 -28944.099 -11062.092  61.8%     - 1527s
     0     0 -11091.968    0  753 -28944.099 -11091.968  61.7%     - 1557s
H    0     0                    -25928.45289 -11094.049  57.2%     - 1565s
H    0     0                    -25826.36214 -11094.049  57.0%     - 1565s
H    0     0                    -25665.09088 -11094.049  56.8%     - 1565s
H    0     0                    -25607.66475 -11094.049  56.7%     - 1565s
H    0     0                    -25554.80540 -11094.049  56.6%     - 1565s
     0     0 -11094.049    0  749 -25554.805 -11094.049  56.6%     - 1565s
H    0     0                    -25492.45100 -11763.583  53.9%     - 1737s
H    0     0                    -25140.39040 -11763.583  53.2%     - 1737s
H    0     0                    -24971.29206 -11763.583  52.9%     - 1737s
H    0     0                    -24709.86283 -11763.583  52.4%     - 1737s
H    0     0                    -24670.55937 -11763.583  52.3%     - 1737s
H    0     0                    -24667.27727 -11763.583  52.3%     - 1737s
H    0     0                    -24666.89121 -11763.583  52.3%     - 1737s
     0     0 -11763.583    0  732 -24666.891 -11763.583  52.3%     - 1737s
     0     0 -12003.414    0  753 -24666.891 -12003.414  51.3%     - 1822s
     0     0 -12056.054    0  736 -24666.891 -12056.054  51.1%     - 1867s
     0     0 -12077.396    0  750 -24666.891 -12077.396  51.0%     - 1893s
H    0     0                    -24647.72451 -12082.579  51.0%     - 1909s
     0     0 -12082.579    0  766 -24647.725 -12082.579  51.0%     - 1909s
     0     0 -12090.947    0  753 -24647.725 -12090.947  50.9%     - 1936s
     0     0 -12092.254    0  761 -24647.725 -12092.254  50.9%     - 1944s
     0     0 -12269.352    0  596 -24647.725 -12269.352  50.2%     - 2021s
H    0     0                    -24452.80683 -12269.516  49.8%     - 2022s
H    0     0                    -24448.32178 -12269.516  49.8%     - 2022s
H    0     0                    -24400.97737 -12269.516  49.7%     - 2022s
H    0     0                    -24400.59131 -12269.516  49.7%     - 2022s
     0     0 -12304.531    0  591 -24400.591 -12304.531  49.6%     - 2052s
     0     0 -12312.944    0  587 -24400.591 -12312.944  49.5%     - 2068s
     0     0 -12343.742    0  588 -24400.591 -12343.742  49.4%     - 2106s
     0     0 -12356.910    0  771 -24400.591 -12356.910  49.4%     - 2129s
     0     0 -12358.707    0  586 -24400.591 -12358.707  49.4%     - 2141s
     0     0 -12509.298    0  757 -24400.591 -12509.298  48.7%     - 2203s
H    0     0                    -24214.64627 -12509.338  48.3%     - 2211s
H    0     0                    -24205.90740 -12509.338  48.3%     - 2213s
H    0     0                    -24160.22688 -12509.338  48.2%     - 2214s
H    0     0                    -24155.74183 -12509.338  48.2%     - 2214s
H    0     0                    -24144.04122 -12509.338  48.2%     - 2214s
H    0     0                    -24102.72765 -12509.338  48.1%     - 2214s
H    0     0                    -24092.62186 -12509.338  48.1%     - 2214s
     0     0 -12539.792    0  611 -24092.622 -12539.792  48.0%     - 2256s
     0     0 -12550.096    0  614 -24092.622 -12550.096  47.9%     - 2280s
     0     0 -12558.711    0  781 -24092.622 -12558.711  47.9%     - 2318s
     0     0 -12560.672    0  619 -24092.622 -12560.672  47.9%     - 2330s
     0     0 -12621.097    0  687 -24092.622 -12621.097  47.6%     - 2384s
     0     0 -12636.626    0  605 -24092.622 -12636.626  47.5%     - 2409s
     0     0 -12648.049    0  615 -24092.622 -12648.049  47.5%     - 2456s
     0     0 -12650.023    0  694 -24092.622 -12650.023  47.5%     - 2472s
     0     0 -12679.537    0  701 -24092.622 -12679.537  47.4%     - 2509s
H    0     0                    -24039.76251 -12679.993  47.3%     - 2511s
     0     0 -12687.828    0  609 -24039.763 -12687.828  47.2%     - 2525s
     0     0 -12689.848    0  613 -24039.763 -12689.848  47.2%     - 2535s
     0     0 -12704.815    0  618 -24039.763 -12704.815  47.2%     - 2561s
     0     0 -12710.037    0  633 -24039.763 -12710.037  47.1%     - 2576s
     0     0 -12710.280    0  632 -24039.763 -12710.280  47.1%     - 2578s
     0     0 -12719.918    0  625 -24039.763 -12719.918  47.1%     - 2597s
H    0     0                    -24039.37645 -12719.962  47.1%     - 2688s
     0     0 -12721.088    0  630 -24039.376 -12721.088  47.1%     - 2701s
     0     0 -12751.341    0  624 -24039.376 -12751.341  47.0%     - 2740s
     0     0 -12753.432    0  632 -24039.376 -12753.432  46.9%     - 2755s
     0     0 -12771.101    0  628 -24039.376 -12771.101  46.9%     - 2786s
H    0     0                    -24028.06190 -12771.196  46.8%     - 2789s
     0     0 -12778.362    0  636 -24028.062 -12778.362  46.8%     - 2809s
     0     0 -12781.284    0  632 -24028.062 -12781.284  46.8%     - 2822s
     0     0 -12783.118    0  638 -24028.062 -12783.118  46.8%     - 2830s
     0     0 -12803.678    0  637 -24028.062 -12803.678  46.7%     - 2855s
     0     0 -12809.170    0  631 -24028.062 -12809.170  46.7%     - 2881s
     0     0 -12811.299    0  641 -24028.062 -12811.299  46.7%     - 2901s
     0     0 -12815.947    0  628 -24028.062 -12815.947  46.7%     - 2923s
     0     0 -12816.886    0  629 -24028.062 -12816.886  46.7%     - 3238s
     0     0 -12838.038    0  638 -24028.062 -12838.038  46.6%     - 3261s
     0     0 -12838.081    0  638 -24028.062 -12838.081  46.6%     - 3274s

Cutting planes:
  Learned: 2
  Implied bound: 97
  MIR: 2664
  Flow cover: 1607
  Zero half: 15
  RLT: 185
  Relax-and-lift: 700

Explored 1 nodes (1015146 simplex iterations) in 3600.02 seconds (4076.93 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -24028.1 -24039.4 -24039.8 ... -24214.6

Time limit reached
Best objective -2.402806190412e+04, best bound -1.283814093830e+04, gap 46.5702%
  WARNING: Time limit reached. Using best solution found (gap: 46.57%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3600.19s
  Master Objective (UB) = -24028.06, θ = 99938.13
  Upper Bound (UB) = -24028.06

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 99938.13
  [DEBUG]   ✓ Scenario 0: θ = 99938.13 ≤ Q = 99938.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 99938.13 ≤ Q = 99938.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 99938.13 ≤ Q = 99938.13 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 99938.13 ≤ Q = 99938.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 99938.13 ≤ Q = 99938.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 99938.13 ≤ Q = 99938.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 99938.13 ≤ Q = 99938.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 99938.13 ≤ Q = 99938.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 99938.13 ≤ Q = 99938.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 99938.13 ≤ Q = 99938.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 99938.13 ≤ Q = 99938.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 99938.13 ≤ Q = 99938.13 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 12] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x515252e3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x515252e3
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [5e-01, 2e+02]
Found heuristic solution: objective 1.227879e+13
Presolve removed 2553 rows and 1846 columns
Presolve time: 0.01s
Presolved: 540 rows, 543 columns, 1523 nonzeros
Found heuristic solution: objective 6656323.2177
Variable types: 367 continuous, 176 integer (176 binary)

Root relaxation: objective -1.271552e+05, 254 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -127155.23    0  124 6656323.22 -127155.23   102%     -    0s
H    0     0                    -88627.75258 -127155.23  43.5%     -    0s
H    0     0                    -89173.19004 -127155.23  42.6%     -    0s
     0     0 -96165.915    0   37 -89173.190 -96165.915  7.84%     -    0s
H    0     0                    -95522.67119 -96104.086  0.61%     -    0s
     0     0 -95896.686    0   25 -95522.671 -95896.686  0.39%     -    0s
H    0     0                    -95817.28147 -95887.626  0.07%     -    0s
     0     0 -95856.956    0   11 -95817.281 -95856.956  0.04%     -    0s
     0     0 -95834.374    0    6 -95817.281 -95834.374  0.02%     -    0s
     0     0          -    0      -95817.281 -95821.939  0.00%     -    0s

Cutting planes:
  Gomory: 6
  MIR: 154
  RLT: 7
  Relax-and-lift: 2

Explored 1 nodes (486 simplex iterations) in 0.04 seconds (0.02 work units)
Thread count was 32 (of 32 available processors)

Solution count 6: -95817.3 -95522.7 -89173.2 ... 1.22788e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -9.581728147415e+04, best bound -9.582193936156e+04, gap 0.0049%
  Subproblem solved in 0.06s
  Worst-case operational profit (Z_SP) = 96628.88
  Scenario: 11 demand increases, 49 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -95817.28
  [DEBUG]   S×d_nominal = 192446.16
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 192446.16 + -95817.28 = 96628.88
  [DEBUG]   Current θ from Master = 99938.13
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3309.25 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -27337.32
  Lower Bound (LB) = -24370.17
  Gap (UB-LB) = 342.1127, Absolute Gap = 342.1127, Relative Gap = 0.014238
  Not converged yet (gap = 342.11 > ε = 200)

  [DEBUG] Adding NEW scenario 12 to Master Problem...
  [DEBUG] New scenario pattern: 11 increases, 49 decreases
    [DEBUG] Scenario 12 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 12 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 12]
    [DEBUG]   - Total constraints in model: 200153
    [DEBUG]   - Total variables in model: 83380
  [DEBUG] Total scenarios in Master: 13
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 13
================================================================================
[Iteration 13] Solving Master Problem...
  Current scenarios in Master: 13
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 200153 rows, 83380 columns and 567834 nonzeros
Model fingerprint: 0x8e97313d
Variable types: 81121 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 81606 rows and 33146 columns
Presolve time: 3.80s
Presolved: 118547 rows, 50234 columns, 728611 nonzeros
Variable types: 47975 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -362034.9317
Found heuristic solution: objective -192025.5558

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.11s

Barrier statistics:
 Dense cols : 694
 AA' NZ     : 4.761e+06
 Factor NZ  : 1.068e+07 (roughly 150 MB of memory)
 Factor Ops : 2.099e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.37240096e+07  1.97276224e+08  7.81e+04 2.74e+01  5.81e+04     7s
   1  -1.05479363e+07  1.67742334e+08  5.54e+04 6.87e+01  4.09e+04     7s
   2  -4.27966134e+06  1.35208457e+08  2.10e+04 1.23e+01  1.65e+04     7s
   3  -8.25819917e+05  9.26190030e+07  1.52e+03 1.70e+00  1.55e+03     7s
   4  -5.75196005e+05  6.75914949e+07  4.38e+02 1.01e+00  6.20e+02     7s
   5  -4.90794185e+05  4.06380878e+07  1.96e+02 5.24e-01  3.14e+02     7s
   6  -4.15635865e+05  2.85649768e+07  6.58e+01 3.45e-01  1.71e+02     7s
   7  -3.44567901e+05  2.28262774e+07  1.05e+01 2.68e-01  1.12e+02     8s
   8  -2.10570926e+05  7.77667641e+06  1.14e+00 8.54e-02  3.71e+01     8s
   9  -1.24160679e+05  2.67960236e+06  3.31e-01 2.76e-02  1.30e+01     8s
  10  -9.78213092e+04  1.07315995e+06  1.94e-01 1.09e-02  5.41e+00     8s
  11  -7.78114739e+04  6.44116777e+05  1.30e-01 6.65e-03  3.33e+00     8s
  12  -5.42618799e+04  3.15472838e+05  6.66e-02 3.14e-03  1.71e+00     8s
  13  -3.94652330e+04  1.68253252e+05  4.14e-02 2.00e-03  9.59e-01     8s
  14  -2.69904755e+04  1.00682020e+05  2.45e-02 1.66e-03  5.89e-01     8s
  15  -2.07379724e+04  7.11182265e+04  1.75e-02 1.18e-03  4.24e-01     9s
  16  -1.59352792e+04  5.36830808e+04  1.21e-02 9.00e-04  3.21e-01     9s
  17  -1.25148742e+04  3.19333844e+04  8.76e-03 5.55e-04  2.05e-01     9s
  18  -9.87009405e+03  2.17344969e+04  6.46e-03 3.82e-04  1.46e-01     9s
  19  -8.19585321e+03  1.32731546e+04  5.10e-03 2.32e-04  9.91e-02     9s
  20  -6.23188288e+03  9.00616133e+03  3.62e-03 1.52e-04  7.03e-02    10s
  21  -5.06559993e+03  6.47114833e+03  2.78e-03 1.23e-04  5.32e-02    10s
  22  -3.89850680e+03  4.43877941e+03  1.99e-03 9.09e-05  3.85e-02    10s
  23  -3.69357367e+03  3.26356588e+03  1.83e-03 7.13e-05  3.21e-02    10s
  24  -3.50594749e+03  2.53245736e+03  1.71e-03 5.83e-05  2.79e-02    10s
  25  -3.19910596e+03  1.97544890e+03  1.52e-03 4.84e-05  2.39e-02    11s
  26  -2.76478107e+03  1.36591618e+03  1.26e-03 3.66e-05  1.91e-02    11s
  27  -2.49023366e+03  7.94144692e+02  1.09e-03 2.58e-05  1.52e-02    11s
  28  -1.99923608e+03  4.55967904e+02  8.04e-04 1.91e-05  1.13e-02    11s
  29  -1.62524985e+03  1.82519908e+02  5.91e-04 1.36e-05  8.34e-03    11s
  30  -1.50266823e+03  3.86043336e+01  5.21e-04 1.10e-05  7.11e-03    12s
  31  -1.19301218e+03 -1.10915348e+02  3.46e-04 8.05e-06  5.00e-03    12s
  32  -1.06884206e+03 -2.26021229e+02  2.76e-04 5.96e-06  3.89e-03    12s
  33  -9.71301525e+02 -3.57570013e+02  2.22e-04 3.51e-06  2.83e-03    12s
  34  -9.28763467e+02 -4.11376745e+02  1.98e-04 2.55e-06  2.39e-03    13s
  35  -7.37689668e+02 -4.33612753e+02  9.72e-05 2.12e-06  1.40e-03    13s
  36  -6.98151353e+02 -4.72757147e+02  7.61e-05 1.42e-06  1.04e-03    13s
  37  -6.79211895e+02 -4.82557394e+02  6.63e-05 1.24e-06  9.08e-04    13s
  38  -6.52349214e+02 -4.96373733e+02  5.19e-05 1.29e-06  7.20e-04    13s
  39  -6.49074518e+02 -5.02415748e+02  5.02e-05 1.15e-06  6.77e-04    14s
  40  -6.23434213e+02 -5.15399652e+02  3.61e-05 1.77e-06  4.99e-04    14s
  41  -5.95181045e+02 -5.29561859e+02  2.20e-05 1.10e-06  3.03e-04    14s
  42  -5.92568882e+02 -5.33499237e+02  2.07e-05 9.36e-07  2.73e-04    14s
  43  -5.80886228e+02 -5.37679911e+02  1.49e-05 6.81e-07  1.99e-04    14s
  44  -5.65444753e+02 -5.44667681e+02  6.75e-06 1.75e-07  9.59e-05    15s
  45  -5.53297590e+02 -5.49942343e+02  7.31e-07 2.50e-08  1.55e-05    15s
  46  -5.51677374e+02 -5.51186902e+02  1.00e-07 5.32e-09  2.27e-06    15s
  47  -5.51398076e+02 -5.51361802e+02  2.69e-08 9.51e-08  1.68e-07    15s
  48  -5.51384042e+02 -5.51383952e+02  9.55e-09 6.45e-10  4.14e-10    15s
  49  -5.51383965e+02 -5.51383953e+02  3.70e-07 6.11e-08  4.06e-11    16s
  50  -5.51383954e+02 -5.51383954e+02  4.02e-09 1.48e-09  4.40e-13    16s

Barrier solved model in 50 iterations and 15.62 seconds (11.75 work units)
Optimal objective -5.51383954e+02


Root crossover log...

   95317 DPushes remaining with DInf 0.0000000e+00                16s
    4703 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                21s

    2758 PPushes remaining with PInf 9.3654592e-08                21s
       0 PPushes remaining with PInf 0.0000000e+00                21s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.1406929e-10     22s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   47766   -5.5138395e+02   0.000000e+00   0.000000e+00     22s
   47766   -5.5138395e+02   0.000000e+00   0.000000e+00     22s
Concurrent spin time: 0.39s

Solved with barrier

Root relaxation: objective -5.513840e+02, 47766 iterations, 17.26 seconds (19.42 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -551.38395    0  432 -192025.56 -551.38395   100%     -   23s
H    0     0                    -183538.5765 -551.38395   100%     -   23s
H    0     0                    -62130.61465 -551.38395  99.1%     -   23s
H    0     0                    -59236.37163 -551.38395  99.1%     -   23s
H    0     0                    -56975.44483 -551.38395  99.0%     -   23s
H    0     0                    -53190.95470 -551.38395  99.0%     -   24s
H    0     0                    -46572.96901 -551.38395  98.8%     -   24s
H    0     0                    -45675.58153 -551.38395  98.8%     -   24s
H    0     0                    -44964.54193 -551.38395  98.8%     -   24s
H    0     0                    -44588.21212 -551.38395  98.8%     -   24s
H    0     0                    -44565.76769 -551.38395  98.8%     -   24s
H    0     0                    -44519.22801 -551.38395  98.8%     -   24s
H    0     0                    -44517.03481 -551.38395  98.8%     -   24s
H    0     0                    -44496.78358 -551.38395  98.8%     -   24s
H    0     0                    -44492.76967 -551.38395  98.8%     -   24s
H    0     0                    -43644.09207 -551.38395  98.7%     -   28s
H    0     0                    -43513.15512 -551.38395  98.7%     -   28s
H    0     0                    -43010.44368 -5588.1469  87.0%     -  117s
H    0     0                    -42784.44762 -5588.1469  86.9%     -  117s
H    0     0                    -41519.98323 -5588.1469  86.5%     -  117s
     0     0 -5951.6707    0  527 -41519.983 -5951.6707  85.7%     -  118s
H    0     0                    -41428.62413 -5951.6707  85.6%     -  119s
     0     0 -5971.8483    0  527 -41428.624 -5971.8483  85.6%     -  139s
     0     0 -6117.6359    0  529 -41428.624 -6117.6359  85.2%     -  148s
     0     0 -6197.6974    0  534 -41428.624 -6197.6974  85.0%     -  157s
     0     0 -6199.2601    0  534 -41428.624 -6199.2601  85.0%     -  162s
     0     0 -6199.2601    0  539 -41428.624 -6199.2601  85.0%     -  172s
     0     0 -6285.3737    0  520 -41428.624 -6285.3737  84.8%     -  197s
     0     0 -6287.4184    0  519 -41428.624 -6287.4184  84.8%     -  200s
     0     0 -6416.0446    0  473 -41428.624 -6416.0446  84.5%     -  217s
     0     0 -6422.6692    0  538 -41428.624 -6422.6692  84.5%     -  226s
     0     0 -6425.8524    0  547 -41428.624 -6425.8524  84.5%     -  230s
     0     0 -6431.4610    0  538 -41428.624 -6431.4610  84.5%     -  236s
     0     0 -6433.6351    0  535 -41428.624 -6433.6351  84.5%     -  239s
H    0     0                    -41254.74289 -6434.0919  84.4%     -  242s
H    0     0                    -40982.08881 -6434.0919  84.3%     -  242s
H    0     0                    -40954.46807 -6434.0919  84.3%     -  242s
H    0     0                    -40950.87454 -6434.0919  84.3%     -  242s
     0     0 -8257.6698    0  536 -40950.875 -8257.6698  79.8%     -  242s
H    0     0                    -32669.86641 -9018.5350  72.4%     -  329s
H    0     0                    -32640.18855 -9018.5350  72.4%     -  329s
H    0     0                    -30846.82046 -9018.5350  70.8%     -  329s
H    0     0                    -30521.66303 -9018.5350  70.5%     -  329s
H    0     0                    -30462.10081 -9018.5350  70.4%     -  329s
     0     0 -9018.5350    0  526 -30462.101 -9018.5350  70.4%     -  330s
H    0     0                    -28564.17306 -9018.5761  68.4%     -  331s
H    0     0                    -28517.87552 -9018.5761  68.4%     -  331s
     0     0 -9588.0913    0  598 -28517.876 -9588.0913  66.4%     -  390s
     0     0 -9659.7156    0  619 -28517.876 -9659.7156  66.1%     -  425s
H    0     0                    -28443.30787 -9772.1671  65.6%     -  460s
H    0     0                    -28429.47988 -9772.1671  65.6%     -  460s
     0     0 -9772.1671    0  613 -28429.480 -9772.1671  65.6%     -  460s
     0     0 -9797.7343    0  621 -28429.480 -9797.7343  65.5%     -  478s
     0     0 -10101.050    0  617 -28429.480 -10101.050  64.5%     -  519s
     0     0 -10113.533    0  615 -28429.480 -10113.533  64.4%     -  527s
     0     0 -10121.551    0  620 -28429.480 -10121.551  64.4%     -  535s
     0     0 -10156.173    0  617 -28429.480 -10156.173  64.3%     -  553s
H    0     0                    -28399.50749 -10177.667  64.2%     -  563s
H    0     0                    -28332.58027 -10177.667  64.1%     -  563s
H    0     0                    -28326.07072 -10177.667  64.1%     -  563s
H    0     0                    -28322.24715 -10177.667  64.1%     -  563s
H    0     0                    -28317.87264 -10177.667  64.1%     -  563s
H    0     0                    -28314.04907 -10177.667  64.1%     -  563s
     0     0 -10177.667    0  615 -28314.049 -10177.667  64.1%     -  563s
     0     0 -10178.174    0  621 -28314.049 -10178.174  64.1%     -  566s
     0     0 -11515.457    0  580 -28314.049 -11515.457  59.3%     -  661s
     0     0 -11759.406    0  578 -28314.049 -11759.406  58.5%     -  709s
     0     0 -11891.173    0  591 -28314.049 -11891.173  58.0%     -  741s
     0     0 -11971.859    0  581 -28314.049 -11971.859  57.7%     -  761s
     0     0 -12008.154    0  604 -28314.049 -12008.154  57.6%     -  779s
     0     0 -12026.575    0  612 -28314.049 -12026.575  57.5%     -  791s
     0     0 -12032.147    0  616 -28314.049 -12032.147  57.5%     -  801s
     0     0 -12033.484    0  614 -28314.049 -12033.484  57.5%     -  805s
H    0     0                    -28300.22107 -12033.484  57.5%     -  820s
     0     0 -12473.769    0  592 -28300.221 -12473.769  55.9%     -  880s
H    0     0                    -28280.18308 -12475.198  55.9%     -  881s
     0     0 -12589.024    0  602 -28280.183 -12589.024  55.5%     -  909s
     0     0 -12642.652    0  600 -28280.183 -12642.652  55.3%     -  931s
     0     0 -12669.580    0  608 -28280.183 -12669.580  55.2%     -  950s
     0     0 -12681.688    0  602 -28280.183 -12681.688  55.2%     -  960s
     0     0 -12684.748    0  607 -28280.183 -12684.748  55.1%     -  967s
     0     0 -12687.368    0  616 -28280.183 -12687.368  55.1%     -  972s
     0     0 -12687.634    0  624 -28280.183 -12687.634  55.1%     -  974s
     0     0 -12811.830    0  612 -28280.183 -12811.830  54.7%     - 1006s
     0     0 -12833.683    0  622 -28280.183 -12833.683  54.6%     - 1027s
     0     0 -12851.867    0  619 -28280.183 -12851.867  54.6%     - 1046s
     0     0 -12858.031    0  618 -28280.183 -12858.031  54.5%     - 1053s
     0     0 -12858.404    0  612 -28280.183 -12858.404  54.5%     - 1054s
     0     0 -12902.312    0  667 -28280.183 -12902.312  54.4%     - 1080s
H    0     0                    -28182.88107 -12912.052  54.2%     - 1092s
     0     0 -12912.052    0  605 -28182.881 -12912.052  54.2%     - 1092s
     0     0 -12921.373    0  598 -28182.881 -12921.373  54.2%     - 1101s
     0     0 -12923.082    0  593 -28182.881 -12923.082  54.1%     - 1105s
     0     0 -12972.177    0  614 -28182.881 -12972.177  54.0%     - 1126s
     0     0 -12990.648    0  611 -28182.881 -12990.648  53.9%     - 1146s
     0     0 -12993.756    0  676 -28182.881 -12993.756  53.9%     - 1157s
     0     0 -12995.391    0  614 -28182.881 -12995.391  53.9%     - 1161s
     0     0 -13065.840    0  682 -28182.881 -13065.840  53.6%     - 1187s
     0     0 -13070.840    0  692 -28182.881 -13070.840  53.6%     - 1199s
     0     0 -13083.232    0  678 -28182.881 -13083.232  53.6%     - 1206s
     0     0 -13085.796    0  627 -28182.881 -13085.796  53.6%     - 1210s
     0     0 -13088.283    0  679 -28182.881 -13088.283  53.6%     - 1213s
     0     0 -13089.361    0  669 -28182.881 -13089.361  53.6%     - 1215s
     0     0 -13103.758    0  633 -28182.881 -13103.758  53.5%     - 1229s
     0     0 -13108.771    0  629 -28182.881 -13108.771  53.5%     - 1236s
     0     0 -13113.371    0  644 -28182.881 -13113.371  53.5%     - 1243s
     0     0 -13116.005    0  641 -28182.881 -13116.005  53.5%     - 1247s
     0     0 -13116.892    0  644 -28182.881 -13116.892  53.5%     - 1249s
     0     0 -13123.698    0  638 -28182.881 -13123.698  53.4%     - 1259s
     0     0 -13125.035    0  637 -28182.881 -13125.035  53.4%     - 1266s
     0     0 -13126.803    0  631 -28182.881 -13126.803  53.4%     - 1274s
     0     0 -13126.870    0  631 -28182.881 -13126.870  53.4%     - 1284s
H    0     0                    -28182.47640 -13126.969  53.4%     - 1344s
H    0     0                    -28149.48308 -13126.969  53.4%     - 1344s
H    0     0                    -28142.97352 -13126.969  53.4%     - 1344s
H    0     0                    -28124.47850 -13126.969  53.3%     - 1344s
H    0     0                    -27807.88018 -13126.969  52.8%     - 1442s
H    0     0                    -27802.16098 -13126.969  52.8%     - 1442s
H    0     0                    -27800.37506 -13126.969  52.8%     - 1442s
H    0     0                    -27797.69276 -13126.969  52.8%     - 1442s
     0     2 -13126.969    0  631 -27797.693 -13126.969  52.8%     - 1445s
     1     3 -13478.248    1  605 -27797.693 -13127.029  52.8% 11685 1475s
     2     4 -13227.994    1  614 -27797.693 -13227.994  52.4%  7919 1491s
     3     6 -13303.978    2  615 -27797.693 -13228.710  52.4%  7541 1518s
     5    10 -13408.941    3  609 -27797.693 -13228.710  52.4%  7378 1566s
     9    19 -15565.644    4  323 -27797.693 -13305.941  52.1%  9430 1631s
    18    38 -13762.451    5  625 -27797.693 -13409.864  51.8% 10462 1675s
    37    51 -15012.889    6  585 -27797.693 -13632.461  51.0% 13547 1773s
H   50    75                    -27754.90910 -13632.461  50.9% 16527 1846s
H   53    75                    -27750.42405 -13632.461  50.9% 16480 1846s
H   57    75                    -25769.95694 -13632.461  47.1% 16065 1846s
H   58    75                    -25552.35897 -13632.461  46.6% 15950 1846s
H   68    75                    -24715.62083 -13632.461  44.8% 14666 1846s
H   73    75                    -24446.52406 -13632.461  44.2% 14107 1846s
    74   184 -18265.648    8  272 -24446.524 -13632.461  44.2% 14473 1919s
H  185   236                    -23909.29667 -13632.461  43.0%  8830 1963s
H  206   236                    -23896.43540 -13632.461  43.0%  8227 1963s
H  230   236                    -23864.09211 -13632.461  42.9%  7754 1963s
   247   310 -18347.109   11  277 -23864.092 -13632.461  42.9%  7430 1998s
   345   327 -18573.532   15  408 -23864.092 -13632.461  42.9%  6397 2026s
H  346   327                    -23853.32813 -13632.461  42.8%  6379 2026s
H  354   327                    -23852.38300 -13632.461  42.8%  6299 2026s
H  361   327                    -23807.99564 -13632.461  42.7%  6265 2026s
   385   373 -18676.340   16  407 -23807.996 -13632.461  42.7%  6325 2055s
   467   409 -18718.577   20  411 -23807.996 -13632.461  42.7%  6109 2079s
   524   443 -18916.915   24  537 -23807.996 -13632.461  42.7%  6113 2104s
H  585   443                    -23804.67615 -13632.461  42.7%  5996 2104s
   595   475 -18928.138   25  390 -23804.676 -13632.461  42.7%  5934 2129s
   655   500 -19434.852   28  409 -23804.676 -13632.461  42.7%  5799 2152s
   723   522 -19664.609   30  416 -23804.676 -13632.461  42.7%  5743 2177s
   797   545 -20234.991   31  468 -23804.676 -13632.461  42.7%  5589 2202s
   870   560 infeasible   32      -23804.676 -13632.461  42.7%  5493 2225s
   936   595 -21550.910   32  479 -23804.676 -13632.461  42.7%  5369 2251s
  1004   642 -21641.756   33  478 -23804.676 -13632.461  42.7%  5350 2279s
  1088   697     cutoff   34      -23804.676 -13632.461  42.7%  5243 2303s
  1182   761 -23342.413   34  350 -23804.676 -13632.461  42.7%  5210 2327s
  1312   807 infeasible   35      -23804.676 -13632.461  42.7%  5002 2353s
  1427   823 -22363.062   19  154 -23804.676 -13632.461  42.7%  4858 2381s
  1460   827 -23255.558   34  350 -23804.676 -13632.461  42.7%  4882 2407s
  1524   843 infeasible   35      -23804.676 -13632.461  42.7%  4855 2437s
  1596   860 -20017.846   19  293 -23804.676 -13632.461  42.7%  4878 2467s
  1647   898 -20113.142   20  209 -23804.676 -13632.461  42.7%  4953 2499s
  1731   933 -20310.834   21  289 -23804.676 -13632.461  42.7%  4969 2529s
  1829   942 -20440.527   22  218 -23804.676 -13632.461  42.7%  4993 2565s
  1896   957 infeasible   21      -23804.676 -13632.461  42.7%  5023 2602s
  1971   957 -18239.323   16  331 -23804.676 -13632.461  42.7%  5085 2640s
  2048   970 -19189.935   18  313 -23804.676 -13632.461  42.7%  5126 2677s
  2117   990 -19598.251   20  454 -23804.676 -13632.461  42.7%  5187 2716s
  2190  1000 -19649.427   21  465 -23804.676 -13632.461  42.7%  5179 2755s
  2277  1019 -21117.336   22  434 -23804.676 -13632.461  42.7%  5174 2798s
  2344  1038 infeasible   24      -23804.676 -13632.461  42.7%  5258 2845s
  2430  1071 -19219.792    8  313 -23804.676 -13632.461  42.7%  5343 2891s
  2509  1116 -22148.917    9  377 -23804.676 -13632.461  42.7%  5477 2935s
  2633  1140 -23067.686   40  156 -23804.676 -13632.461  42.7%  5489 2990s
  2697  1158 -23008.226    9  296 -23804.676 -13632.461  42.7%  5492 3068s
  2768  1203 -23338.235   10  292 -23804.676 -13632.461  42.7%  5528 3144s
  2869  1242 infeasible   11      -23804.676 -13632.461  42.7%  5559 3197s
  3001  1250 -20957.488   12  422 -23804.676 -13632.461  42.7%  5535 3251s
  3053  1277 -21221.073   13  217 -23804.676 -13632.461  42.7%  5608 3310s
  3102  1300 -21287.754   14  298 -23804.676 -13632.461  42.7%  5676 3364s
  3149  1322 -21333.857   15  297 -23804.676 -13935.140  41.5%  5720 3426s
  3205  1358 -21726.770   16  212 -23804.676 -13935.140  41.5%  5784 3493s
  3263  1400 -21803.728   17  208 -23804.676 -13935.140  41.5%  5836 3551s
  3341  1466 -22304.376   19  287 -23804.676 -13935.140  41.5%  5893 3600s

Cutting planes:
  Learned: 2
  Implied bound: 222
  MIR: 3313
  Flow cover: 3553
  Zero half: 19
  RLT: 104
  Relax-and-lift: 471

Explored 3480 nodes (20957190 simplex iterations) in 3600.08 seconds (5361.92 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -23804.7 -23808 -23852.4 ... -25552.4

Time limit reached
Best objective -2.380467614575e+04, best bound -1.393597966274e+04, gap 41.4570%
  WARNING: Time limit reached. Using best solution found (gap: 41.46%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3600.10s
  Master Objective (UB) = -23804.68, θ = 100535.46
  Upper Bound (UB) = -23804.68

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 100535.46
  [DEBUG]   ✓ Scenario 0: θ = 100535.46 ≤ Q = 100535.46 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 100535.46 ≤ Q = 100535.46 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 100535.46 ≤ Q = 100535.46 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 100535.46 ≤ Q = 100535.46 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 100535.46 ≤ Q = 100535.46 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 100535.46 ≤ Q = 100535.46 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 100535.46 ≤ Q = 100535.46 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 100535.46 ≤ Q = 100535.46 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 100535.46 ≤ Q = 100535.46 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 100535.46 ≤ Q = 100535.46 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 100535.46 ≤ Q = 100535.46 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 100535.46 ≤ Q = 100535.46 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 100535.46 ≤ Q = 100535.46 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 13] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x11580694
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x11580694
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.265603e+13
Presolve removed 2553 rows and 1846 columns
Presolve time: 0.01s
Presolved: 540 rows, 543 columns, 1523 nonzeros
Found heuristic solution: objective 6870701.5746
Variable types: 367 continuous, 176 integer (176 binary)

Root relaxation: objective -1.279979e+05, 252 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -127997.88    0  124 6870701.57 -127997.88   102%     -    0s
H    0     0                    -89489.33987 -127997.88  43.0%     -    0s
H    0     0                    -90090.80220 -127997.88  42.1%     -    0s
     0     0 -94365.997    0   86 -90090.802 -94365.997  4.75%     -    0s
H    0     0                    -92416.59374 -94362.614  2.11%     -    0s
H    0     0                    -92738.99481 -94362.614  1.75%     -    0s
     0     0 -94158.745    0   82 -92738.995 -94158.745  1.53%     -    0s
     0     0 -94158.745    0   82 -92738.995 -94158.745  1.53%     -    0s
     0     2 -94158.745    0   82 -92738.995 -94158.745  1.53%     -    0s
H   33    48                    -93166.63221 -93997.635  0.89%  11.4    0s
H   42    44                    -93248.93057 -93957.294  0.76%   9.6    0s
H  386   187                    -93263.81713 -93767.838  0.54%   4.1    0s
H  406   187                    -93297.45542 -93767.838  0.50%   4.0    0s
*  838   261              26    -93303.01042 -93729.072  0.46%   3.5    0s
* 4540   391              26    -93308.44911 -93439.719  0.14%   4.2    0s

Cutting planes:
  Gomory: 58
  MIR: 163

Explored 5702 nodes (26822 simplex iterations) in 0.41 seconds (0.27 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -93308.4 -93303 -93297.5 ... -89489.3

Optimal solution found (tolerance 1.00e-04)
Best objective -9.330844910870e+04, best bound -9.331311491216e+04, gap 0.0050%
  Subproblem solved in 0.44s
  Worst-case operational profit (Z_SP) = 100343.60
  Scenario: 7 demand increases, 53 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -93308.45
  [DEBUG]   S×d_nominal = 193652.05
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 193652.05 + -93308.45 = 100343.60
  [DEBUG]   Current θ from Master = 100535.46
  [DEBUG]   ⚠️  Z_SP ≤ θ by 191.87 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -23996.54
  Lower Bound (LB) = -23996.54
  Gap (UB-LB) = 191.8653, Absolute Gap = 191.8653, Relative Gap = 0.008060
  *** CONVERGED (gap within tolerance) ***

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 13
Total Time: 33398.40s
Converged: True
Final Lower Bound: -23996.5415
Final Upper Bound: -23804.6761
Final Gap: 191.865342
Number of Critical Scenarios: 13
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [2] (1/3)
Product 1 Plants: [0] (1/3)
Product 2 Plants: [0] (1/3)
Total Plant Openings: 3
DCs Opened: [4, 5, 6] (3/10)
Active Routes (Plant→DC): 9
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 12 customers  Mode 1: 16 customers  Mode 2: 22 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 13
Start Time: 2026-01-05 17:32:59
End Time: 2026-01-06 02:49:38
Total Time: 33398.40s
Optimal Value: -23996.54
Lower Bound: -23996.54
Upper Bound: -23804.68
Gap: 191.865342
Plants Opened: {0: [2], 1: [0], 2: [0]} (3 plants)
DCs Opened: [4, 5, 6] (3 DCs)
================================================================================

Results saved to: result/DH_single_full_seed42_LD_gamma20_20260106_024938.csv

Total Execution Time: 33398.88 seconds
End Time: 2026-01-06 02:49:38

All tasks completed successfully!

