
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 12
DI Scenario: Mixed
Start Time: 2026-01-04 12:30:56
================================================================================
Loading data from data/DH_data_full_seed12.pkl...

Applying DI scenario: Mixed
DI values:
  Product 0: ['1.000', '1.315', '1.730'] (k=0.676)
  Product 1: ['1.000', '1.193', '1.424'] (k=0.436)
  Product 2: ['1.000', '1.055', '1.114'] (k=0.133)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=928, max=1669
  DC capacity (MC): min=444, max=839

Demand Structure (s_rk matrix):
  Total customer-product pairs: 79/150 (47.3% sparse)
  Average products per customer: 1.58

Demand (only non-zero entries):
  Nominal (μ): min=8.02, max=34.77, count=79
  Deviation (μ̂): min=4.04, max=9.89

Costs:
  Plant fixed cost: min=5855, max=8988
  DC fixed cost: min=3255, max=5629
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.315', '1.730'] (k=0.676)
    Product 1: ['1.000', '1.459', '2.127'] (k=0.931)
    Product 2: ['1.000', '1.356', '1.838'] (k=0.751)
  MD:
    Product 0: ['1.000', '1.275', '1.626'] (k=0.599)
    Product 1: ['1.000', '1.193', '1.424'] (k=0.436)
    Product 2: ['1.000', '1.235', '1.525'] (k=0.521)
  LD:
    Product 0: ['1.000', '1.091', '1.191'] (k=0.215)
    Product 1: ['1.000', '1.071', '1.147'] (k=0.169)
    Product 2: ['1.000', '1.055', '1.114'] (k=0.133)
  Mixed:
    Product 0: ['1.000', '1.315', '1.730'] (k=0.676)
    Product 1: ['1.000', '1.193', '1.424'] (k=0.436)
    Product 2: ['1.000', '1.055', '1.114'] (k=0.133)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48747 nonzeros
Model fingerprint: 0x3f068969
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11912 rows and 2912 columns
Presolve time: 0.08s
Presolved: 4761 rows, 5588 columns, 33115 nonzeros
Variable types: 3329 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -304342.5778
Found heuristic solution: objective -185355.3570

Root relaxation: objective 8.472681e+04, 4559 iterations, 0.15 seconds (0.26 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 84726.8111    0  569 -185355.36 84726.8111   146%     -    0s
H    0     0                    -183348.2604 84726.8111   146%     -    0s
     0     0 76168.3066    0  694 -183348.26 76168.3066   142%     -    0s
H    0     0                    -165957.4706 75733.0493   146%     -    0s
     0     0 75733.0493    0  699 -165957.47 75733.0493   146%     -    0s
     0     0 75725.0971    0  708 -165957.47 75725.0971   146%     -    0s
H    0     0                    -113548.4284 68851.2437   161%     -    1s
H    0     0                    -113268.9825 68851.2437   161%     -    1s
H    0     0                    -112942.5377 68851.2437   161%     -    1s
H    0     0                    -112843.2747 68851.2437   161%     -    1s
H    0     0                    -112603.9386 68851.2437   161%     -    1s
H    0     0                    -112391.6267 68851.2437   161%     -    1s
H    0     0                    -112184.5730 68851.2437   161%     -    1s
H    0     0                    -111863.2983 68851.2437   162%     -    1s
H    0     0                    -111639.1942 68851.2437   162%     -    1s
     0     0 68851.2437    0 1016 -111639.19 68851.2437   162%     -    1s
     0     0 68583.3244    0 1005 -111639.19 68583.3244   161%     -    1s
     0     0 68570.8162    0 1004 -111639.19 68570.8162   161%     -    1s
     0     0 68568.4861    0 1008 -111639.19 68568.4861   161%     -    1s
     0     0 64238.9893    0 1113 -111639.19 64238.9893   158%     -    3s
     0     0 63504.2848    0 1099 -111639.19 63504.2848   157%     -    3s
     0     0 63350.4101    0 1230 -111639.19 63350.4101   157%     -    3s
H    0     0                    -20497.68783 63342.3549   409%     -    3s
H    0     0                     105.0812646 63342.3549      -     -    3s
     0     0 63342.3549    0 1230  105.08126 63342.3549      -     -    3s
     0     0 63341.8254    0 1230  105.08126 63341.8254      -     -    3s
H    0     0                     240.0904448 60631.5012      -     -    5s
     0     0 60631.5012    0 1287  240.09044 60631.5012      -     -    5s
     0     0 60343.8174    0 1269  240.09044 60343.8174      -     -    5s
     0     0 60312.8926    0 1290  240.09044 60312.8926      -     -    6s
     0     0 60301.5238    0 1294  240.09044 60301.5238      -     -    6s
     0     0 60299.0522    0 1297  240.09044 60299.0522      -     -    6s
H    0     0                     274.6239595 58499.5790      -     -    7s
H    0     0                     476.6727826 58499.5790      -     -    7s
H    0     0                     805.4171749 58499.5790  7163%     -    7s
H    0     0                     807.3736352 58499.5790  7146%     -    7s
H    0     0                     853.0278543 58499.5790  6758%     -    7s
H    0     0                     865.8199534 58499.5790  6657%     -    7s
H    0     0                    1214.3595949 58499.5790  4717%     -    7s
H    0     0                    1352.9873808 58499.5790  4224%     -    7s
H    0     0                    1975.5984926 58499.5790  2861%     -    7s
     0     0 58499.5790    0 1250 1975.59849 58499.5790  2861%     -    7s
H    0     0                    1992.6394945 58222.8375  2822%     -    7s
H    0     0                    2639.5422849 58222.8375  2106%     -    7s
H    0     0                    2654.9008067 58222.8375  2093%     -    7s
H    0     0                    3160.2366699 58222.8375  1742%     -    7s
H    0     0                    3178.4196097 58222.8375  1732%     -    7s
H    0     0                    3287.6229842 58222.8375  1671%     -    7s
H    0     0                    3352.1083699 58222.8375  1637%     -    7s
H    0     0                    3524.5695620 58222.8375  1552%     -    7s
H    0     0                    3672.0326811 58222.8375  1486%     -    7s
H    0     0                    3675.3303353 58222.8375  1484%     -    7s
H    0     0                    4214.0171021 58222.8375  1282%     -    7s
     0     0 58222.8375    0 1296 4214.01710 58222.8375  1282%     -    7s
H    0     0                    4240.5010906 58185.6024  1272%     -    7s
H    0     0                    5655.4016577 58185.6024   929%     -    7s
     0     0 58185.6024    0 1309 5655.40166 58185.6024   929%     -    7s
     0     0 58177.6199    0 1312 5655.40166 58177.6199   929%     -    8s
H    0     0                    12297.071541 56837.8541   362%     -    9s
H    0     0                    12357.723750 56837.8541   360%     -    9s
H    0     0                    12368.842694 56837.8541   360%     -    9s
H    0     0                    12398.792501 56837.8541   358%     -    9s
H    0     0                    12487.708155 56837.8541   355%     -    9s
H    0     0                    12503.215999 56837.8541   355%     -    9s
H    0     0                    12562.729907 56837.8541   352%     -    9s
H    0     0                    12597.637739 56837.8541   351%     -    9s
H    0     0                    12639.751855 56837.8541   350%     -    9s
H    0     0                    13443.680759 56837.8541   323%     -    9s
H    0     0                    13898.269730 56837.8541   309%     -    9s
H    0     0                    13952.138961 56837.8541   307%     -    9s
H    0     0                    13959.273749 56837.8541   307%     -    9s
H    0     0                    13986.190326 56837.8541   306%     -    9s
H    0     0                    13997.496099 56837.8541   306%     -    9s
H    0     0                    14028.399520 56837.8541   305%     -    9s
H    0     0                    14120.805278 56837.8541   303%     -    9s
H    0     0                    15578.198819 56837.8541   265%     -    9s
H    0     0                    16014.966145 56837.8541   255%     -    9s
H    0     0                    16034.176012 56837.8541   254%     -    9s
H    0     0                    16318.256198 56837.8541   248%     -    9s
H    0     0                    17471.206881 56837.8541   225%     -    9s
H    0     0                    17472.548075 56837.8541   225%     -    9s
     0     0 56837.8541    0 1299 17472.5481 56837.8541   225%     -    9s
     0     0 56541.4916    0 1302 17472.5481 56541.4916   224%     -   10s
     0     0 56504.2807    0 1308 17472.5481 56504.2807   223%     -   10s
     0     0 56487.5371    0 1308 17472.5481 56487.5371   223%     -   10s
     0     0 55451.2535    0 1310 17472.5481 55451.2535   217%     -   12s
H    0     0                    17581.590452 55276.9067   214%     -   12s
H    0     0                    17585.507208 55276.9067   214%     -   12s
H    0     0                    17601.278899 55276.9067   214%     -   12s
     0     0 55276.9067    0 1315 17601.2789 55276.9067   214%     -   12s
     0     0 55252.8425    0 1339 17601.2789 55252.8425   214%     -   12s
     0     0 55245.9530    0 1350 17601.2789 55245.9530   214%     -   12s
H    0     0                    17655.790101 54490.9976   209%     -   14s
H    0     0                    17685.646859 54490.9976   208%     -   14s
H    0     0                    17829.083525 54490.9976   206%     -   14s
H    0     0                    17913.237105 54490.9976   204%     -   14s
H    0     0                    17915.033016 54490.9976   204%     -   14s
     0     0 54490.9976    0 1298 17915.0330 54490.9976   204%     -   14s
     0     0 54366.0216    0 1333 17915.0330 54366.0216   203%     -   14s
     0     0 54338.7376    0 1359 17915.0330 54338.7376   203%     -   15s
H    0     0                    18637.874112 54326.5324   191%     -   15s
H    0     0                    18729.607970 54326.5324   190%     -   15s
H    0     0                    19135.066406 54326.5324   184%     -   15s
H    0     0                    19137.431165 54326.5324   184%     -   15s
H    0     0                    19140.858139 54326.5324   184%     -   15s
H    0     0                    19143.343007 54326.5324   184%     -   15s
H    0     0                    19164.390793 54326.5324   183%     -   15s
     0     0 54326.5324    0 1363 19164.3908 54326.5324   183%     -   15s
H    0     0                    19231.278502 53677.2748   179%     -   17s
H    0     0                    19276.120208 53677.2748   178%     -   17s
H    0     0                    19286.191420 53677.2748   178%     -   17s
H    0     0                    19296.145311 53677.2748   178%     -   17s
H    0     0                    19306.216522 53677.2748   178%     -   17s
H    0     0                    19491.917396 53677.2748   175%     -   17s
H    0     0                    19529.511852 53677.2748   175%     -   17s
H    0     0                    19557.535279 53677.2748   174%     -   17s
     0     0 53677.2748    0 1298 19557.5353 53677.2748   174%     -   17s
     0     0 53552.4713    0 1337 19557.5353 53552.4713   174%     -   18s
     0     0 53524.6309    0 1344 19557.5353 53524.6309   174%     -   18s
     0     0 53517.3668    0 1344 19557.5353 53517.3668   174%     -   18s
H    0     0                    19571.583016 53119.7339   171%     -   20s
     0     0 53119.7339    0 1276 19571.5830 53119.7339   171%     -   20s
     0     0 53035.5683    0 1355 19571.5830 53035.5683   171%     -   21s
     0     0 53014.7520    0 1333 19571.5830 53014.7520   171%     -   21s
     0     0 52725.4195    0 1263 19571.5830 52725.4195   169%     -   22s
     0     0 52647.1062    0 1273 19571.5830 52647.1062   169%     -   23s
     0     0 52629.8025    0 1299 19571.5830 52629.8025   169%     -   23s
     0     0 52406.4917    0 1220 19571.5830 52406.4917   168%     -   25s
     0     0 52406.4077    0 1220 19571.5830 52406.4077   168%     -   25s
     0     2 52406.4077    0 1220 19571.5830 52406.4077   168%     -   26s
     7    16 48308.2293    3  912 19571.5830 50453.2006   158%  4260   32s
    31    64 46282.0493    5  840 19571.5830 48204.9875   146%  3513   37s
H   37    64                    19598.305549 48204.9875   146%  3700   37s
H   41    64                    19784.271726 48203.6825   144%  3903   37s
   233   340 40225.8317    8  561 19784.2717 46788.7599   136%  1743   40s
H  401   407                    19811.507292 46788.7599   136%  1259   41s
H  449   434                    19811.756093 46788.7599   136%  1182   41s
H  459   506                    19812.023473 46788.7599   136%  1167   42s
H  461   506                    19839.737843 46788.7599   136%  1163   42s
H  495   506                    19899.083262 46788.7599   135%  1125   42s
H  515   506                    19918.909127 46788.7599   135%  1096   42s
H  631   613                    19925.958988 46486.4064   133%  1011   43s
H  785   729                    19941.456145 46452.7536   133%   932   44s
H  825   729                    20053.401364 46452.7536   132%   918   44s
   828   813 33618.2760   20  460 20053.4014 46452.7536   132%   917   45s
H 1242  1081                    20081.588597 44454.8526   121%   784   47s
  1491  1390 28876.9293   36  370 20081.5886 44454.8526   121%   732   50s
  2752  2092 36518.2655   10  371 20081.5886 42110.9864   110%   582   55s
H 2985  2123                    20087.949960 41993.1320   109%   572   56s
H 3042  2120                    20156.334166 41993.1320   108%   572   56s
H 3941  2625                    20161.544118 41419.4795   105%   545   63s
  3942  2626 20989.7701   26 1220 20161.5441 41419.4795   105%   545   72s
  3958  2637 29942.0214   14  427 20161.5441 32311.7496  60.3%   543   75s
H 4055  2576                    20162.885312 29783.3632  47.7%   546   78s
H 4230  2448                    21110.414963 29059.7256  37.7%   537   79s
H 4248  2322                    23376.071950 29059.7256  24.3%   536   79s
H 4252  2208                    24856.358500 29059.7256  16.9%   536   79s
  4487  2071 26491.1695   20  316 24856.3585 28195.7634  13.4%   514   80s
H 4667  2004                    25682.137846 27224.5108  6.01%   497   80s
H 4695  1893                    26046.137646 27187.6081  4.38%   495   80s
H 4722  1786                    26135.495841 27187.6081  4.03%   492   80s
H 4911  1467                    26260.442790 27172.9299  3.47%   474   80s
H 4932  1372                    26265.289009 27172.9299  3.46%   472   80s
H 4981  1301                    26287.567269 27170.2722  3.36%   468   80s
H 5029  1254                    26553.459121 27164.5896  2.30%   464   80s
H 5038  1175                    26560.679045 27164.5896  2.27%   463   80s
H 5120  1076                    26563.541546 27159.4937  2.24%   456   80s
H 5265   934                    26581.172552 27158.1709  2.17%   444   81s
H 5490   831                    26701.562622 27081.1630  1.42%   427   81s
H 5657   694                    26722.056128 27081.1630  1.34%   415   81s
H 5680   629                    26733.563101 27081.1630  1.30%   413   81s
* 5920   469              49    26736.239009 27048.3217  1.17%   397   81s
* 6491   269              57    26763.182316 27021.5564  0.97%   364   81s
H 6603   149                    26791.040491 27021.5564  0.86%   359   81s
H 6726    88                    26791.567766 27021.5564  0.86%   352   81s
H 6800    88                    26792.544054 27021.5564  0.85%   349   81s
* 7328     9              49    26792.804069 27006.5474  0.80%   325   81s

Cutting planes:
  Implied bound: 7
  Projected implied bound: 53
  MIR: 192
  Flow cover: 459
  RLT: 16
  Relax-and-lift: 113

Explored 7379 nodes (2457713 simplex iterations) in 81.61 seconds (179.16 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 26792.8 26792.5 26791.6 ... 26581.2

Optimal solution found (tolerance 1.00e-04)
Best objective 2.679280406932e+04, best bound 2.679280406932e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 81.62s
  Master Objective (UB) = 26792.80, θ = 156741.74
  Upper Bound (UB) = 26792.80

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 156741.74
  [DEBUG]   ✓ Scenario 0: θ = 156741.74 ≤ Q = 156741.74 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x3799b81c
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x3799b81c
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [1e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.409680e+13
Presolve removed 2607 rows and 1900 columns
Presolve time: 0.00s
Presolved: 486 rows, 489 columns, 1370 nonzeros
Found heuristic solution: objective 6924679.7327
Variable types: 331 continuous, 158 integer (158 binary)

Root relaxation: objective -1.339111e+05, 241 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -133911.14    0  124 6924679.73 -133911.14   102%     -    0s
H    0     0                    -100892.0769 -133911.14  32.7%     -    0s
H    0     0                    -101420.8217 -133911.14  32.0%     -    0s
*    0     0               0    -103649.9305 -103649.93  0.00%     -    0s

Cutting planes:
  Gomory: 2
  MIR: 203

Explored 1 nodes (371 simplex iterations) in 0.01 seconds (0.01 work units)
Thread count was 32 (of 64 available processors)

Solution count 5: -103650 -101421 -100892 ... 1.40968e+13
No other solutions better than -103650

Optimal solution found (tolerance 1.00e-04)
Best objective -1.036499305373e+05, best bound -1.036499305373e+05, gap 0.0000%
  Subproblem solved in 0.03s
  Worst-case operational profit (Z_SP) = 123919.09
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -103649.93
  [DEBUG]   S×d_nominal = 227569.02
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 227569.02 + -103649.93 = 123919.09
  [DEBUG]   Current θ from Master = 156741.74
  [DEBUG]   ⚠️  Z_SP ≤ θ by 32822.65 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -6029.84
  Lower Bound (LB) = -6029.84
  Gap (UB-LB) = 32822.6453, Absolute Gap = 32822.6453, Relative Gap = 1.225055
  Not converged yet (gap = 32822.65 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 91975 nonzeros
Model fingerprint: 0xbc6cbb72
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -6029.84 (0.01s)
MIP start from previous solve produced solution with objective -6029.84 (0.01s)
Loaded MIP start from previous solve with objective -6029.84

Presolve removed 14403 rows and 5842 columns
Presolve time: 0.30s
Presolved: 17560 rows, 8898 columns, 97148 nonzeros
Variable types: 6639 continuous, 2259 integer (2259 binary)

Root relaxation: objective 2.853265e+04, 8348 iterations, 1.02 seconds (2.21 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 28532.6454    0  432 -6029.8412 28532.6454   573%     -    1s
H    0     0                    -5166.870364 28532.6454   652%     -    1s
H    0     0                    -5052.949126 28532.6454   665%     -    1s
H    0     0                    -3583.563523 28532.6454   896%     -    1s
H    0     0                    -3518.941279 28532.6454   911%     -    1s
     0     0 18518.8893    0  598 -3518.9413 18518.8893   626%     -    3s
H    0     0                    -3338.737534 18514.2393   655%     -    3s
     0     0 18417.6287    0  595 -3338.7375 18417.6287   652%     -    3s
     0     0 18416.8359    0  603 -3338.7375 18416.8359   652%     -    3s
     0     0 13742.3815    0  644 -3338.7375 13742.3815   512%     -    5s
     0     0 13326.1780    0  675 -3338.7375 13326.1780   499%     -    5s
     0     0 13219.3272    0  602 -3338.7375 13219.3272   496%     -    5s
     0     0 13183.7504    0  608 -3338.7375 13183.7504   495%     -    6s
     0     0 13182.9305    0  614 -3338.7375 13182.9305   495%     -    6s
     0     0 10628.1848    0  525 -3338.7375 10628.1848   418%     -    8s
     0     0 10350.4035    0  585 -3338.7375 10350.4035   410%     -    8s
     0     0 10285.3983    0  586 -3338.7375 10285.3983   408%     -    9s
     0     0 10250.5218    0  574 -3338.7375 10250.5218   407%     -    9s
     0     0 10238.8697    0  575 -3338.7375 10238.8697   407%     -    9s
     0     0 10234.8824    0  586 -3338.7375 10234.8824   407%     -    9s
     0     0 8596.88861    0  524 -3338.7375 8596.88861   357%     -   11s
     0     0 8045.60067    0  654 -3338.7375 8045.60067   341%     -   12s
     0     0 7974.58747    0  660 -3338.7375 7974.58747   339%     -   13s
     0     0 7885.08699    0  684 -3338.7375 7885.08699   336%     -   13s
     0     0 7857.55850    0  598 -3338.7375 7857.55850   335%     -   13s
     0     0 7851.36351    0  680 -3338.7375 7851.36351   335%     -   13s
     0     0 7848.92363    0  675 -3338.7375 7848.92363   335%     -   13s
     0     0 7145.79639    0  540 -3338.7375 7145.79639   314%     -   15s
     0     0 7071.45272    0  687 -3338.7375 7071.45272   312%     -   15s
     0     0 7031.18341    0  702 -3338.7375 7031.18341   311%     -   16s
     0     0 7022.49561    0  695 -3338.7375 7022.49561   310%     -   16s
     0     0 7020.80964    0  757 -3338.7375 7020.80964   310%     -   16s
     0     0 6778.48741    0  477 -3338.7375 6778.48741   303%     -   17s
H    0     0                    -3338.476024 6775.51116   303%     -   18s
H    0     0                    -2080.292651 6775.51116   426%     -   18s
H    0     0                    -1780.253508 6775.51116   481%     -   18s
H    0     0                    -1706.833190 6775.51116   497%     -   18s
H    0     0                    -1676.835774 6775.51116   504%     -   18s
H    0     0                    -1641.779865 6775.51116   513%     -   18s
H    0     0                    -1558.389002 6775.51116   535%     -   18s
H    0     0                    -1022.253212 6775.51116   763%     -   18s
H    0     0                    -987.3398153 6775.51116   786%     -   18s
H    0     0                    -904.0759850 6775.51116   849%     -   18s
     0     0 6707.91896    0  478 -904.07599 6707.91896   842%     -   19s
     0     0 6694.51949    0  481 -904.07599 6694.51949   840%     -   19s
     0     0 6691.82921    0  475 -904.07599 6691.82921   840%     -   19s
     0     0 6592.78377    0  473 -904.07599 6592.78377   829%     -   20s
     0     0 6565.68978    0  481 -904.07599 6565.68978   826%     -   20s
     0     0 6554.34197    0  479 -904.07599 6554.34197   825%     -   20s
     0     0 6551.28704    0  484 -904.07599 6551.28704   825%     -   20s
     0     0 6472.53273    0  406 -904.07599 6472.53273   816%     -   21s
     0     0 6442.53777    0  486 -904.07599 6442.53777   813%     -   21s
     0     0 6437.56019    0  495 -904.07599 6437.56019   812%     -   21s
     0     0 6391.63088    0  490 -904.07599 6391.63088   807%     -   22s
     0     0 6373.71633    0  501 -904.07599 6373.71633   805%     -   22s
     0     0 6369.13316    0  499 -904.07599 6369.13316   804%     -   22s
     0     0 6355.08704    0  417 -904.07599 6355.08704   803%     -   22s
     0     0 6351.11906    0  493 -904.07599 6351.11906   802%     -   23s
     0     0 6338.69723    0  489 -904.07599 6338.69723   801%     -   23s
     0     0 6333.76914    0  498 -904.07599 6333.76914   801%     -   23s
     0     0 6310.08484    0  496 -904.07599 6310.08484   798%     -   24s
     0     0 6309.93839    0  496 -904.07599 6309.93839   798%     -   24s
H    0     0                    -877.5545592 6309.84262   819%     -   29s
H    0     0                    -857.8113602 6309.84262   836%     -   29s
H    0     0                    -456.8618201 6309.84262  1481%     -   29s
H    0     0                    -316.8746590 6309.84262  2091%     -   29s
     0     2 6309.84262    0  496 -316.87466 6309.84262  2091%     -   29s
     1     4 6197.24367    1  426 -316.87466 6309.84262  2091%   710   30s
H   77    82                    -303.9184045 5513.24533  1914%  1043   34s
    93   185 2857.48006    7  386 -303.91840 5451.26697  1894%  1029   35s
H  281   243                    -299.6777029 5354.39441  1887%   525   36s
  1007   661     cutoff   15      -299.67770 4989.39895  1765%   309   40s
  2195  1046  222.80867   10  217 -299.67770 4407.48294  1571%   251   45s
* 3435  1424              53    -288.3456773 3751.84523  1401%   237   48s
  3804  1496  -26.43465   12  178 -288.34568 3388.83844  1275%   239   50s
H 4176  1550                    -210.2828088 3265.21815  1653%   237   50s
H 4179  1569                    -154.8652447 3265.21815  2208%   237   51s
H 4195  1569                     -95.3749935 3265.21815  3524%   237   51s
  5115  1608     cutoff   28       -95.37499 2749.10077  2982%   241   55s
  6483  1526  425.75819   31  156  -95.37499 2188.87891  2395%   238   60s
  8864   888     cutoff   17       -95.37499 1079.71427  1232%   225   65s

Cutting planes:
  Gomory: 11
  Implied bound: 1
  MIR: 1576
  Flow cover: 870
  Zero half: 4
  RLT: 67
  Relax-and-lift: 309

Explored 11658 nodes (2330271 simplex iterations) in 67.10 seconds (172.16 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -95.375 -154.865 -210.283 ... -877.555
No other solutions better than -95.375

Optimal solution found (tolerance 1.00e-04)
Best objective -9.537499346826e+01, best bound -9.537499346826e+01, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 67.11s
  Master Objective (UB) = -95.37, θ = 131547.79
  Upper Bound (UB) = -95.37

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 131547.79
  [DEBUG]   ✓ Scenario 0: θ = 131547.79 ≤ Q = 131547.79 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 131547.79 ≤ Q = 131547.79 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x5b2a7cc3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xa4d5833d
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.268478e+13
Presolve removed 2607 rows and 1900 columns
Presolve time: 0.00s
Presolved: 486 rows, 489 columns, 1370 nonzeros
Found heuristic solution: objective 6269857.5588
Variable types: 331 continuous, 158 integer (158 binary)

Root relaxation: objective -1.324638e+05, 262 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -132463.83    0  128 6269857.56 -132463.83   102%     -    0s
H    0     0                    -91535.78687 -132463.83  44.7%     -    0s
H    0     0                    -91843.91739 -132463.83  44.2%     -    0s
H    0     0                    -111598.2277 -132463.83  18.7%     -    0s
H    0     0                    -111644.7784 -132463.83  18.6%     -    0s
     0     0 -121537.55    0   83 -111644.78 -121537.55  8.86%     -    0s
H    0     0                    -117983.7636 -121443.21  2.93%     -    0s
     0     0 -121090.55    0   91 -117983.76 -121090.55  2.63%     -    0s
     0     0 -121090.44    0   91 -117983.76 -121090.44  2.63%     -    0s
     0     0 -120810.77    0   87 -117983.76 -120810.77  2.40%     -    0s
H    0     0                    -118756.4085 -120796.44  1.72%     -    0s
     0     0 -120787.76    0   84 -118756.41 -120787.76  1.71%     -    0s
H    0     0                    -120466.3538 -120787.76  0.27%     -    0s
     0     0 -120699.30    0   57 -120466.35 -120699.30  0.19%     -    0s
     0     0 -120659.55    0   33 -120466.35 -120659.55  0.16%     -    0s
     0     0 -120651.64    0   25 -120466.35 -120651.64  0.15%     -    0s
     0     0 -120650.17    0   23 -120466.35 -120650.17  0.15%     -    0s
H    0     0                    -120499.3924 -120585.30  0.07%     -    0s
     0     0 -120576.52    0   20 -120499.39 -120576.52  0.06%     -    0s
     0     0 -120550.43    0   11 -120499.39 -120550.43  0.04%     -    0s
     0     0 -120550.30    0   10 -120499.39 -120550.30  0.04%     -    0s
     0     0 -120526.70    0   12 -120499.39 -120526.70  0.02%     -    0s
     0     0 -120526.66    0   11 -120499.39 -120526.66  0.02%     -    0s
     0     0 -120525.69    0   11 -120499.39 -120525.69  0.02%     -    0s
     0     0 -120511.36    0    6 -120499.39 -120511.36  0.01%     -    0s

Cutting planes:
  Gomory: 17
  Implied bound: 1
  MIR: 73
  Flow cover: 3
  RLT: 76
  Relax-and-lift: 6
  BQP: 4

Explored 1 nodes (720 simplex iterations) in 0.05 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 8: -120499 -120466 -111645 ... 1.26848e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.204993923552e+05, best bound -1.205113556512e+05, gap 0.0099%
  Subproblem solved in 0.06s
  Worst-case operational profit (Z_SP) = 107010.43
  Scenario: 35 demand increases, 25 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -120499.39
  [DEBUG]   S×d_nominal = 227509.82
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 227509.82 + -120499.39 = 107010.43
  [DEBUG]   Current θ from Master = 131547.79
  [DEBUG]   ⚠️  Z_SP ≤ θ by 24537.36 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -24632.74
  Lower Bound (LB) = -6029.84
  Gap (UB-LB) = 5934.4662, Absolute Gap = 5934.4662, Relative Gap = 62.222455
  Not converged yet (gap = 5934.47 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 35 increases, 25 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135203 nonzeros
Model fingerprint: 0x70c77057
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -24632.7 (0.01s)
MIP start from previous solve produced solution with objective -24632.7 (0.02s)
Loaded MIP start from previous solve with objective -24632.7

Presolve removed 21603 rows and 8763 columns
Presolve time: 0.40s
Presolved: 25650 rows, 12217 columns, 143414 nonzeros
Variable types: 9958 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   32687    2.7404255e+04   0.000000e+00   2.897768e+05      5s
Concurrent spin time: 0.00s

Solved with dual simplex

Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   23128    2.8198107e+04   0.000000e+00   0.000000e+00      5s

Root relaxation: objective 2.819811e+04, 23128 iterations, 4.83 seconds (10.16 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 28198.1073    0  435 -24632.740 28198.1073   214%     -    5s
H    0     0                    -2442.240481 28198.1073  1255%     -    5s
H    0     0                    -2212.962299 28198.1073  1374%     -    5s
H    0     0                    -2165.777606 28198.1073  1402%     -    5s
H    0     0                    -1665.017819 28198.1073  1794%     -    5s
H    0     0                    -1501.954470 28198.1073  1977%     -    6s
H    0     0                    -1490.255803 28198.1073  1992%     -    6s
H    0     0                    -1307.233081 18225.7264  1494%     -    9s
H    0     0                    -897.9153206 18225.7264  2130%     -    9s
H    0     0                    -761.8884227 18225.7264  2492%     -    9s
H    0     0                    -740.1445510 18225.7264  2562%     -    9s
H    0     0                    -738.9982863 18225.7264  2566%     -    9s
H    0     0                    -709.0008710 18225.7264  2671%     -    9s
     0     0 18034.0253    0  582 -709.00087 18034.0253  2644%     -    9s
     0     0 18034.0253    0  588 -709.00087 18034.0253  2644%     -   10s
     0     0 18009.9008    0  596 -709.00087 18009.9008  2640%     -   10s
     0     0 18008.5825    0  595 -709.00087 18008.5825  2640%     -   10s
     0     0 13723.2714    0  580 -709.00087 13723.2714  2036%     -   14s
H    0     0                    -688.3502829 13722.3145  2094%     -   14s
H    0     0                    -684.9828928 13722.3145  2103%     -   14s
H    0     0                    -658.3528676 13722.3145  2184%     -   14s
     0     0 13004.1916    0  649 -658.35287 13004.1916  2075%     -   16s
     0     0 12753.6306    0  668 -658.35287 12753.6306  2037%     -   16s
     0     0 12736.4142    0  670 -658.35287 12736.4142  2035%     -   17s
     0     0 12734.0674    0  675 -658.35287 12734.0674  2034%     -   17s
     0     0 9675.11539    0  704 -658.35287 9675.11539  1570%     -   23s
H    0     0                    -637.3078993 9181.39488  1541%     -   24s
     0     0 9181.39488    0  720 -637.30790 9181.39488  1541%     -   24s
     0     0 8933.39662    0  690 -637.30790 8933.39662  1502%     -   25s
     0     0 8898.00496    0  724 -637.30790 8898.00496  1496%     -   25s
     0     0 8882.14693    0  728 -637.30790 8882.14693  1494%     -   26s
     0     0 8877.77385    0  730 -637.30790 8877.77385  1493%     -   26s
     0     0 7183.41866    0  512 -637.30790 7183.41866  1227%     -   32s
H    0     0                    -627.8399220 7183.11861  1244%     -   32s
H    0     0                    -566.1120700 6739.53937  1290%     -   34s
H    0     0                    -556.6440927 6739.53937  1311%     -   34s
     0     0 6739.53937    0  628 -556.64409 6739.53937  1311%     -   34s
     0     0 6568.88267    0  623 -556.64409 6568.88267  1280%     -   35s
     0     0 6525.99649    0  707 -556.64409 6525.99649  1272%     -   35s
     0     0 6509.49161    0  663 -556.64409 6509.49161  1269%     -   36s
     0     0 6506.41382    0  583 -556.64409 6506.41382  1269%     -   36s
     0     0 6104.40602    0  564 -556.64409 6104.40602  1197%     -   38s
     0     0 5990.84648    0  571 -556.64409 5990.84648  1176%     -   39s
     0     0 5953.72388    0  620 -556.64409 5953.72388  1170%     -   40s
     0     0 5928.45575    0  628 -556.64409 5928.45575  1165%     -   40s
     0     0 5919.46020    0  624 -556.64409 5919.46020  1163%     -   40s
     0     0 5915.26202    0  626 -556.64409 5915.26202  1163%     -   41s
     0     0 5749.26418    0  473 -556.64409 5749.26418  1133%     -   42s
     0     0 5729.75796    0  470 -556.64409 5729.75796  1129%     -   43s
     0     0 5714.88625    0  476 -556.64409 5714.88625  1127%     -   43s
     0     0 5713.00263    0  482 -556.64409 5713.00263  1126%     -   44s
     0     0 5644.62705    0  642 -556.64409 5644.62705  1114%     -   45s
     0     0 5633.39646    0  490 -556.64409 5633.39646  1112%     -   46s
     0     0 5629.37606    0  502 -556.64409 5629.37606  1111%     -   46s
     0     0 5580.13904    0  476 -556.64409 5580.13904  1102%     -   47s
     0     0 5566.71186    0  463 -556.64409 5566.71186  1100%     -   48s
     0     0 5559.16857    0  467 -556.64409 5559.16857  1099%     -   48s
     0     0 5554.52021    0  467 -556.64409 5554.52021  1098%     -   48s
H    0     0                    -549.4392827 5534.73597  1107%     -   49s
     0     0 5534.73597    0  649 -549.43928 5534.73597  1107%     -   49s
     0     0 5523.63515    0  662 -549.43928 5523.63515  1105%     -   50s
     0     0 5519.60624    0  491 -549.43928 5519.60624  1105%     -   50s
     0     0 5501.41501    0  489 -549.43928 5501.41501  1101%     -   51s
     0     0 5501.14567    0  489 -549.43928 5501.14567  1101%     -   52s
H    0     0                    -547.8141556 5500.76570  1104%     -   61s
H    0     0                    -528.3298599 5500.76570  1141%     -   61s
H    0     0                    -490.4291260 5500.76570  1222%     -   61s
     0     2 5500.76570    0  489 -490.42913 5500.76570  1222%     -   61s
     7    16 4975.79491    3  541 -490.42913 5266.44558  1174%  1931   66s
    31    64 3532.26929    5  482 -490.42913 4882.18611  1095%  3615   70s
H   79    94                    -405.7603610 4741.40360  1269%  3045   73s
    95   124 1092.15674    7  398 -405.76036 4741.40360  1269%  2980   75s
   249   253  323.63820   10  335 -405.76036 4741.40360  1269%  1825   81s
   421   384   61.20803   12  145 -405.76036 4628.75150  1241%  1517   86s
   618   437     cutoff   10      -405.76036 4436.58697  1193%  1275   90s
   864   576 3806.32994   11  375 -405.76036 4303.99160  1161%  1208   96s
  1142   731 3247.71440   21  207 -405.76036 4079.32780  1105%  1131  101s
  1335   854 2550.67428   34  185 -405.76036 4079.32780  1105%  1085  105s
  1710  1094  714.93581   63   42 -405.76036 3792.21510  1035%  1013  111s
  2007  1251 2118.58748   24  134 -405.76036 3705.88443  1013%   972  116s
  2272  1327  738.25665   38   75 -405.76036 3581.24492   983%   935  121s
  2515  1491  -49.92171   54   32 -405.76036 3581.24492   983%   913  125s
  3059  1799   47.95826   57   26 -405.76036 3496.92660   962%   860  131s
  3502  2074 2275.37381   21  160 -405.76036 3390.10702   935%   831  135s
  4095  2341     cutoff   37      -405.76036 3309.31376   916%   788  140s
  4727  2479 2800.74722    6  489 -405.76036 3206.31386   890%   753  159s
  4729  2480 1830.18617   22  290 -405.76036 3206.31386   890%   753  164s
  4730  2481  365.93872   40  446 -405.76036 3206.31386   890%   753  167s
  4732  2482  967.60273   19  447 -405.76036 3206.31386   890%   753  170s
  4739  2487 1159.45993   36  455 -405.76036 3206.31386   890%   751  176s
  4745  2491 2557.74354   24  519 -405.76036 3206.31386   890%   750  180s
  4751  2495 1684.06826   22  403 -405.76036 3206.31386   890%   750  185s
  4756  2498  653.72459   53  529 -405.76036 3206.31386   890%   749  190s
  4761  2502  475.59267   35  480 -405.76036 3206.31386   890%   748  200s
  4763  2506 3206.31386   12  400 -405.76036 3206.31386   890%   761  206s
  4769  2516 3206.31386   14  452 -405.76036 3206.31386   890%   764  210s
  4819  2543 3206.31386   17  399 -405.76036 3206.31386   890%   785  216s
  4903  2541 2241.54612   19  402 -405.76036 3206.31386   890%   792  220s
  5096  2466     cutoff   21      -405.76036 3206.31386   890%   795  226s
  5265  2406  -40.12031   23  364 -405.76036 3059.68929   854%   792  230s
  5448  2305 infeasible   25      -405.76036 3059.68929   854%   782  235s

Cutting planes:
  Implied bound: 10
  Projected implied bound: 1
  MIR: 168
  Flow cover: 376
  Zero half: 1
  RLT: 4
  Relax-and-lift: 23

Explored 5657 nodes (4431622 simplex iterations) in 239.18 seconds (580.58 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -405.76 -490.429 -528.33 ... -658.353
No other solutions better than -405.76

Optimal solution found (tolerance 1.00e-04)
Best objective -4.057603609865e+02, best bound -4.057603609865e+02, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 239.18s
  Master Objective (UB) = -405.76, θ = 130173.38
  Upper Bound (UB) = -405.76

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 130173.38
  [DEBUG]   ✓ Scenario 0: θ = 130173.38 ≤ Q = 130173.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 130173.38 ≤ Q = 130173.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 130173.38 ≤ Q = 130173.38 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x111a47da
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xeee5b826
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.286643e+13
Presolve removed 2607 rows and 1900 columns
Presolve time: 0.00s
Presolved: 486 rows, 489 columns, 1370 nonzeros
Found heuristic solution: objective 6330684.8764
Variable types: 331 continuous, 158 integer (158 binary)

Root relaxation: objective -1.328458e+05, 266 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -132845.84    0  128 6330684.88 -132845.84   102%     -    0s
H    0     0                    -96968.23524 -132845.84  37.0%     -    0s
H    0     0                    -111415.6357 -132845.84  19.2%     -    0s
     0     0 -123337.46    0   87 -111415.64 -123337.46  10.7%     -    0s
H    0     0                    -120608.4023 -123291.63  2.22%     -    0s
     0     0 -123145.92    0   89 -120608.40 -123145.92  2.10%     -    0s
H    0     0                    -122150.4271 -123145.92  0.81%     -    0s
H    0     0                    -122439.9255 -122968.93  0.43%     -    0s
     0     0 -122966.12    0   60 -122439.93 -122966.12  0.43%     -    0s
     0     0 -122961.90    0   53 -122439.93 -122961.90  0.43%     -    0s
     0     0 -122960.95    0   52 -122439.93 -122960.95  0.43%     -    0s
     0     0 -122873.43    0   74 -122439.93 -122873.43  0.35%     -    0s
     0     0 -122855.39    0   58 -122439.93 -122855.39  0.34%     -    0s
     0     0 -122854.02    0   57 -122439.93 -122854.02  0.34%     -    0s
     0     0 -122757.92    0   51 -122439.93 -122757.92  0.26%     -    0s
     0     0 -122757.92    0   53 -122439.93 -122757.92  0.26%     -    0s
     0     0 -122757.92    0   52 -122439.93 -122757.92  0.26%     -    0s
     0     0 -122757.92    0   51 -122439.93 -122757.92  0.26%     -    0s
     0     0 -122734.51    0   53 -122439.93 -122734.51  0.24%     -    0s
     0     0 -122734.51    0   52 -122439.93 -122734.51  0.24%     -    0s
     0     0 -122732.08    0   52 -122439.93 -122732.08  0.24%     -    0s
     0     0 -122537.06    0   14 -122439.93 -122537.06  0.08%     -    0s
     0     0 -122520.37    0   12 -122439.93 -122520.37  0.07%     -    0s
H    0     0                    -122442.1846 -122520.37  0.06%     -    0s
     0     0 -122458.34    0    4 -122442.18 -122458.34  0.01%     -    0s
     0     0 -122457.72    0    2 -122442.18 -122457.72  0.01%     -    0s

Cutting planes:
  Gomory: 1
  Implied bound: 3
  MIR: 5
  Flow cover: 4
  Relax-and-lift: 1

Explored 1 nodes (790 simplex iterations) in 0.08 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 8: -122442 -122440 -122355 ... 1.28664e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.224421846212e+05, best bound -1.224507100146e+05, gap 0.0070%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 104981.23
  Scenario: 38 demand increases, 22 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -122442.18
  [DEBUG]   S×d_nominal = 227423.42
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 227423.42 + -122442.18 = 104981.23
  [DEBUG]   Current θ from Master = 130173.38
  [DEBUG]   ⚠️  Z_SP ≤ θ by 25192.15 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -25597.91
  Lower Bound (LB) = -6029.84
  Gap (UB-LB) = 5624.0808, Absolute Gap = 5624.0808, Relative Gap = 13.860597
  Not converged yet (gap = 5624.08 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 38 increases, 22 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178431 nonzeros
Model fingerprint: 0xccca9067
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -25597.9 (0.03s)
MIP start from previous solve produced solution with objective -25597.9 (0.03s)
Loaded MIP start from previous solve with objective -25597.9

Presolve removed 28764 rows and 11684 columns
Presolve time: 0.52s
Presolved: 33779 rows, 15536 columns, 208779 nonzeros
Variable types: 13277 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 33779 rows, 15536 columns, 208779 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   40784    6.2147294e+03   0.000000e+00   7.770708e+05      5s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 1.549492e+04, 23933 iterations, 6.67 seconds (13.74 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 15494.9195    0  283 -25597.909 15494.9195   161%     -    7s
H    0     0                    -15662.67281 15494.9195   199%     -    7s
H    0     0                    -7807.359248 15494.9195   298%     -    7s
H    0     0                    -7420.303974 15494.9195   309%     -    7s
H    0     0                    -7384.162044 15491.8768   310%     -    8s
H    0     0                    -7380.249815 15491.8768   310%     -    8s
H    0     0                    -6983.920443 11561.9034   266%     -   11s
H    0     0                    -6981.045797 11561.9034   266%     -   11s
     0     0 11169.6027    0  271 -6981.0458 11169.6027   260%     -   11s
     0     0 11153.1401    0  223 -6981.0458 11153.1401   260%     -   12s
     0     0 11153.1401    0  223 -6981.0458 11153.1401   260%     -   13s
     0     0 11153.1401    0  276 -6981.0458 11153.1401   260%     -   13s
     0     0 11153.1401    0  227 -6981.0458 11153.1401   260%     -   13s
     0     0 11153.1401    0  230 -6981.0458 11153.1401   260%     -   13s
H    0     0                    -6136.666576 9510.54598   255%     -   16s
H    0     0                    -6061.086948 9510.54598   257%     -   16s
     0     0 9510.54598    0  286 -6061.0869 9510.54598   257%     -   16s
H    0     0                    -4620.585218 9510.40516   306%     -   16s
     0     0 9051.16796    0  306 -4620.5852 9051.16796   296%     -   17s
     0     0 8999.09577    0  321 -4620.5852 8999.09577   295%     -   18s
     0     0 8757.16032    0  310 -4620.5852 8757.16032   290%     -   19s
     0     0 8715.61050    0  313 -4620.5852 8715.61050   289%     -   19s
     0     0 8707.16131    0  309 -4620.5852 8707.16131   288%     -   19s
     0     0 8707.07341    0  309 -4620.5852 8707.07341   288%     -   19s
     0     0 7063.84680    0  460 -4620.5852 7063.84680   253%     -   24s
H    0     0                    -4602.954212 6744.58324   247%     -   26s
     0     0 6744.58324    0  473 -4602.9542 6744.58324   247%     -   26s
     0     0 6574.85874    0  477 -4602.9542 6574.85874   243%     -   27s
     0     0 6526.12016    0  480 -4602.9542 6526.12016   242%     -   27s
     0     0 6492.33462    0  482 -4602.9542 6492.33462   241%     -   28s
     0     0 6485.93143    0  487 -4602.9542 6485.93143   241%     -   28s
     0     0 6483.42033    0  492 -4602.9542 6483.42033   241%     -   28s
     0     0 6483.17497    0  490 -4602.9542 6483.17497   241%     -   28s
H    0     0                    -4330.031533 5966.61663   238%     -   33s
     0     0 5966.61663    0  382 -4330.0315 5966.61663   238%     -   33s
H    0     0                    -4224.168151 5966.48797   241%     -   33s
H    0     0                    -4220.742371 5966.48797   241%     -   33s
     0     0 5697.91468    0  371 -4220.7424 5697.91468   235%     -   35s
H    0     0                    -3845.698123 5600.67748   246%     -   36s
     0     0 5600.67748    0  377 -3845.6981 5600.67748   246%     -   36s
H    0     0                    -3809.521161 5569.02637   246%     -   37s
     0     0 5569.02637    0  394 -3809.5212 5569.02637   246%     -   37s
     0     0 5551.76138    0  399 -3809.5212 5551.76138   246%     -   37s
     0     0 5547.51238    0  402 -3809.5212 5547.51238   246%     -   38s
     0     0 5546.12379    0  400 -3809.5212 5546.12379   246%     -   38s
     0     0 5545.93279    0  402 -3809.5212 5545.93279   246%     -   38s
H    0     0                    -3779.463603 5545.93279   247%     -   38s
H    0     0                    -3778.377481 5545.93279   247%     -   38s
     0     0 5491.27518    0  445 -3778.3775 5491.27518   245%     -   39s
H    0     0                    -3697.536452 5491.14202   249%     -   40s
H    0     0                    -3635.243737 5491.14202   251%     -   40s
     0     0 5452.92410    0  441 -3635.2437 5452.92410   250%     -   40s
     0     0 5438.45524    0  502 -3635.2437 5438.45524   250%     -   41s
H    0     0                    -3588.143214 5423.30695   251%     -   41s
H    0     0                    -3474.934246 5423.30695   256%     -   41s
     0     0 5423.30695    0  505 -3474.9342 5423.30695   256%     -   41s
     0     0 5419.61957    0  498 -3474.9342 5419.61957   256%     -   42s
     0     0 5418.86895    0  439 -3474.9342 5418.86895   256%     -   42s
     0     0 5390.14041    0  451 -3474.9342 5390.14041   255%     -   43s
     0     0 5379.73803    0  459 -3474.9342 5379.73803   255%     -   44s
     0     0 5377.78375    0  468 -3474.9342 5377.78375   255%     -   44s
     0     0 5376.81700    0  467 -3474.9342 5376.81700   255%     -   44s
     0     0 5353.31941    0  465 -3474.9342 5353.31941   254%     -   45s
     0     0 5347.92015    0  463 -3474.9342 5347.92015   254%     -   46s
H    0     0                    -3333.735215 5344.75813   260%     -   46s
H    0     0                    -3324.695387 5344.75813   261%     -   46s
H    0     0                    -3163.071932 5344.75813   269%     -   46s
H    0     0                    -3145.792283 5344.75813   270%     -   46s
     0     0 5344.75813    0  522 -3145.7923 5344.75813   270%     -   46s
     0     0 5342.83840    0  520 -3145.7923 5342.83840   270%     -   46s
     0     0 5342.36618    0  475 -3145.7923 5342.36618   270%     -   46s
H    0     0                    -3062.516903 5313.64149   274%     -   48s
H    0     0                    -3058.604673 5313.64149   274%     -   48s
     0     0 5313.64149    0  479 -3058.6047 5313.64149   274%     -   48s
     0     0 5304.16711    0  482 -3058.6047 5304.16711   273%     -   48s
     0     0 5301.41489    0  410 -3058.6047 5301.41489   273%     -   48s
     0     0 5300.99962    0  414 -3058.6047 5300.99962   273%     -   48s
     0     0 5269.41520    0  469 -3058.6047 5269.41520   272%     -   49s
     0     0 5267.84754    0  471 -3058.6047 5267.84754   272%     -   50s
     0     0 5267.32310    0  470 -3058.6047 5267.32310   272%     -   50s
     0     0 5265.74592    0  468 -3058.6047 5265.74592   272%     -   50s
     0     0 5264.34252    0  474 -3058.6047 5264.34252   272%     -   51s
     0     0 5263.84597    0  473 -3058.6047 5263.84597   272%     -   51s
     0     0 5263.13698    0  476 -3058.6047 5263.13698   272%     -   51s
     0     0 5262.69407    0  521 -3058.6047 5262.69407   272%     -   51s
     0     0 5260.69427    0  524 -3058.6047 5260.69427   272%     -   52s
     0     0 5259.19640    0  524 -3058.6047 5259.19640   272%     -   53s
     0     2 5259.19640    0  524 -3058.6047 5259.19640   272%     -   60s
    15    32 4188.82883    4  499 -3058.6047 4461.83366   246%  2615   68s
    31    64 4135.48798    5  449 -3058.6047 4187.62145   237%  4159   72s
    95   141 3948.82264    7  506 -3058.6047 4135.47929   235%  2489   76s
   204   269 3286.89704    9  437 -3058.6047 4135.47929   235%  1709   83s
   281   299 3842.45273    9  437 -3058.6047 4135.47929   235%  1530   87s
   356   346 2972.22786   10  354 -3058.6047 3961.59475   230%  1430   90s
   428   393  466.42116   11  502 -3058.6047 3842.42157   226%  1390   96s
   527   475 1859.48633   12  323 -3058.6047 3842.42157   226%  1438  102s
H  628   523                    -2931.077944 3816.53396   230%  1403  104s
   640   568  910.80246   14  364 -2931.0779 3816.53396   230%  1401  110s
H  714   605                    -2765.288356 3816.53396   238%  1394  112s
H  721   605                    -2737.531775 3816.53396   239%  1387  112s
H  730   605                    -2492.924948 3816.53396   253%  1396  112s
H  735   605                    -2479.461226 3816.53396   254%  1392  112s
H  738   605                    -2450.838857 3816.53396   256%  1391  112s
H  758   605                    -2179.426050 3816.53396   275%  1379  112s
   761   623  425.75385   17  345 -2179.4261 3816.53396   275%  1382  115s
H  844   646                    -2059.162841 3763.11628   283%  1375  119s
H  868   646                    -2036.351580 3655.58798   280%  1389  119s
   886   686 -890.45344   22  276 -2036.3516 3655.58798   280%  1383  122s
H  966   729                    -1981.876544 3655.58798   284%  1347  124s
H  974   729                    -1939.557808 3655.58798   288%  1344  124s
  1033   746 infeasible   26      -1939.5578 3500.12995   280%  1333  128s
H 1035   746                    -1915.080187 3500.12995   283%  1335  128s
H 1040   746                    -1908.414128 3500.12995   283%  1334  128s
H 1057   746                    -1828.060946 3414.81971   287%  1344  128s
  1077   788 -1645.7906   27  273 -1828.0609 3414.81971   287%  1341  133s
  1158   833   -0.06942   14  259 -1828.0609 3414.81971   287%  1322  137s
  1262   866 infeasible   15      -1828.0609 3327.65440   282%  1280  140s
  1375   906 -1802.8378   15  181 -1828.0609 3323.43828   282%  1259  145s
H 1382   906                    -1817.545616 3323.43828   283%  1258  145s
  1547   969 -1475.3408   17  273 -1817.5456 3323.43828   283%  1238  152s
  1689  1018  896.51698   11  320 -1817.5456 3150.61065   273%  1210  156s
  1804  1051  466.98126   12  297 -1817.5456 3150.61065   273%  1201  161s
  1926  1069 -574.70585   15  285 -1817.5456 3099.18869   271%  1198  165s
H 1985  1069                    -1812.385609 3092.67378   271%  1193  165s
  2164  1110 infeasible   19      -1812.3856 3045.86200   268%  1175  175s
  2405  1167  110.11128   13  331 -1812.3856 2888.51035   259%  1184  183s
  2552  1189 -746.73487   15  394 -1812.3856 2870.13602   258%  1181  189s
  2705  1232 -644.38337   16  348 -1812.3856 2795.65668   254%  1179  195s
  3045  1290 infeasible   17      -1812.3856 2795.65668   254%  1169  203s
H 3096  1290                    -1800.564559 2795.65668   255%  1171  203s
  3108  1318     cutoff    8      -1800.5646 2704.02531   250%  1170  208s
  3278  1349  623.43285   13  247 -1800.5646 2704.02531   250%  1171  212s
H 3279  1349                    -1780.035121 2704.02531   252%  1171  212s
  3454  1383     cutoff   14      -1780.0351 2704.02531   252%  1159  217s
  3681  1415 infeasible   15      -1780.0351 2402.42235   235%  1144  224s
  3910  1420 -1412.6206   20  187 -1780.0351 2321.66386   230%  1135  229s
  3969  1431 -1541.9958   21  193 -1780.0351 2321.66386   230%  1138  234s
H 3970  1431                    -1775.626697 2321.66386   231%  1138  234s
H 4030  1431                    -1773.663624 2264.51595   228%  1133  234s
  4068  1433 -1561.4512   22  189 -1773.6636 2264.51595   228%  1131  241s
  4372  1446 -1585.5691   16   78 -1773.6636 2252.96493   227%  1115  248s
  4653  1458     cutoff   13      -1773.6636 1977.66568   212%  1104  255s
  4935  1449 -422.36622   12  235 -1773.6636 1834.40927   203%  1097  263s
  5227  1439     cutoff   12      -1773.6636 1675.06864   194%  1090  269s
H 5228  1439                    -1748.720960 1675.06864   196%  1090  269s
H 5244  1439                    -1745.374844 1675.06864   196%  1088  269s
  5503  1382     cutoff   11      -1745.3748 1482.17524   185%  1084  276s
  5795  1345     cutoff   17      -1745.3748 1216.50610   170%  1081  282s
  6117  1313     cutoff   18      -1745.3748 1046.56620   160%  1077  290s
H 6177  1313                    -1728.003548 1032.80905   160%  1079  290s
  6213  1191     cutoff   13      -1728.0035  899.46222   152%  1079  296s
  6663  1097     cutoff   12      -1728.0035  722.56637   142%  1057  304s
  7133   895 -1597.7875   22  201 -1728.0035  349.84766   120%  1037  311s
  7750   688     cutoff   18      -1728.0035   31.05885   102%  1003  318s
  8168   245 -741.72580   17  296 -1728.0035 -239.75710  86.1%   978  323s
H 8227   245                    -1720.588825 -286.64838  83.3%   974  323s
  9072    33     cutoff   15      -1720.5888 -649.69730  62.2%   915  325s
  9650    48     cutoff   32      -1720.5888 -1291.0784  25.0%   871  330s
 10816    44 -1648.3031   28   32 -1720.5888 -1539.8888  10.5%   780  335s

Cutting planes:
  Cover: 1
  Implied bound: 15
  MIR: 405
  Flow cover: 769
  Zero half: 2
  RLT: 31
  Relax-and-lift: 51

Explored 11767 nodes (8557513 simplex iterations) in 335.30 seconds (1041.16 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -1720.59 -1728 -1745.37 ... -1817.55
No other solutions better than -1720.59

Optimal solution found (tolerance 1.00e-04)
Best objective -1.720588825159e+03, best bound -1.720588825159e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 335.32s
  Master Objective (UB) = -1720.59, θ = 130234.76
  Upper Bound (UB) = -1720.59

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 130234.76
  [DEBUG]   ✓ Scenario 0: θ = 130234.76 ≤ Q = 130234.76 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 130234.76 ≤ Q = 130234.76 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 130234.76 ≤ Q = 130234.76 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 130234.76 ≤ Q = 130234.76 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x1a5ccf1d
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xe5a330e3
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.287761e+13
Presolve removed 2607 rows and 1900 columns
Presolve time: 0.00s
Presolved: 486 rows, 489 columns, 1370 nonzeros
Found heuristic solution: objective 6398014.6782
Variable types: 331 continuous, 158 integer (158 binary)

Root relaxation: objective -1.303328e+05, 244 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -130332.79    0  126 6398014.68 -130332.79   102%     -    0s
H    0     0                    -96288.50659 -130332.79  35.4%     -    0s
H    0     0                    -96520.55195 -130332.79  35.0%     -    0s
H    0     0                    -105784.2624 -130332.79  23.2%     -    0s
     0     0 -114566.92    0   97 -105784.26 -114566.92  8.30%     -    0s
H    0     0                    -111868.2629 -114558.13  2.40%     -    0s
     0     0 -114426.48    0  100 -111868.26 -114426.48  2.29%     -    0s
     0     0 -114420.85    0  100 -111868.26 -114420.85  2.28%     -    0s
H    0     0                    -113102.9024 -114420.85  1.17%     -    0s
H    0     0                    -113432.7055 -114420.85  0.87%     -    0s
     0     0 -114065.37    0   79 -113432.71 -114065.37  0.56%     -    0s
     0     0 -113647.01    0   45 -113432.71 -113647.01  0.19%     -    0s
     0     0 -113598.18    0   23 -113432.71 -113598.18  0.15%     -    0s
     0     0 -113551.79    0   18 -113432.71 -113551.79  0.10%     -    0s
     0     0 -113519.70    0   17 -113432.71 -113519.70  0.08%     -    0s
     0     0 -113519.70    0   12 -113432.71 -113519.70  0.08%     -    0s
     0     0 -113519.70    0   12 -113432.71 -113519.70  0.08%     -    0s
     0     0 -113466.77    0    6 -113432.71 -113466.77  0.03%     -    0s
     0     0 -113466.77    0    9 -113432.71 -113466.77  0.03%     -    0s
H    0     0                    -113434.5847 -113466.77  0.03%     -    0s
     0     0          -    0      -113434.58 -113443.17  0.01%     -    0s

Cutting planes:
  Implied bound: 3
  MIR: 4
  Flow cover: 5
  RLT: 2

Explored 1 nodes (719 simplex iterations) in 0.06 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -113435 -113433 -113399 ... 1.28776e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.134345847462e+05, best bound -1.134431662539e+05, gap 0.0076%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 112948.59
  Scenario: 43 demand increases, 17 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -113434.58
  [DEBUG]   S×d_nominal = 226383.18
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 226383.18 + -113434.58 = 112948.59
  [DEBUG]   Current θ from Master = 130234.76
  [DEBUG]   ⚠️  Z_SP ≤ θ by 17286.17 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -19006.76
  Lower Bound (LB) = -6029.84
  Gap (UB-LB) = 4309.2524, Absolute Gap = 4309.2524, Relative Gap = 2.504522
  Not converged yet (gap = 4309.25 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 43 increases, 17 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221659 nonzeros
Model fingerprint: 0x3c38ce77
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 35935 rows and 14595 columns
Presolve time: 0.66s
Presolved: 41898 rows, 18865 columns, 259654 nonzeros
Variable types: 16606 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -375121.6643
Found heuristic solution: objective -210214.6974

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 41898 rows, 18865 columns, 259654 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   30549    8.6767030e+03   0.000000e+00   7.552672e+06      5s
   42547    1.3825905e+04   0.000000e+00   1.699098e+06     10s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 1.511324e+04, 28089 iterations, 11.63 seconds (23.37 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 15113.2377    0  285 -210214.70 15113.2377   107%     -   12s
H    0     0                    -201231.0552 15113.2377   108%     -   12s
H    0     0                    -38285.99704 15113.2377   139%     -   12s
H    0     0                    -13422.40909 15113.2377   213%     -   12s
H    0     0                    -6534.404145 15113.2377   331%     -   12s
H    0     0                    -6496.305096 15113.2377   333%     -   12s
H    0     0                    -6443.784255 15113.0678   335%     -   13s
     0     0 10809.9426    0  282 -6443.7843 10809.9426   268%     -   19s
     0     0 10714.8815    0  266 -6443.7843 10714.8815   266%     -   21s
     0     0 10714.8815    0  239 -6443.7843 10714.8815   266%     -   22s
     0     0 10714.8815    0  230 -6443.7843 10714.8815   266%     -   23s
     0     0 10714.8815    0  231 -6443.7843 10714.8815   266%     -   23s
     0     0 10714.8815    0  231 -6443.7843 10714.8815   266%     -   23s
     0     0 10714.8815    0  237 -6443.7843 10714.8815   266%     -   23s
     0     0 10714.8815    0  237 -6443.7843 10714.8815   266%     -   23s
H    0     0                    -5537.079988 8700.50015   257%     -   29s
     0     0 8700.50015    0  352 -5537.0800 8700.50015   257%     -   30s
H    0     0                    -3625.427684 8700.42276   340%     -   30s
H    0     0                    -3519.211037 8700.42276   347%     -   30s
     0     0 8230.00945    0  357 -3519.2110 8230.00945   334%     -   33s
     0     0 8196.89669    0  365 -3519.2110 8196.89669   333%     -   34s
     0     0 8113.16462    0  359 -3519.2110 8113.16462   331%     -   34s
     0     0 8085.54410    0  367 -3519.2110 8085.54410   330%     -   35s
     0     0 8038.73186    0  370 -3519.2110 8038.73186   328%     -   36s
     0     0 8028.83526    0  372 -3519.2110 8028.83526   328%     -   36s
     0     0 8028.73914    0  372 -3519.2110 8028.73914   328%     -   36s
H    0     0                    -3435.665899 8028.73914   334%     -   39s
H    0     0                    -3396.288096 8028.73914   336%     -   39s
     0     0 6214.36952    0  357 -3396.2881 6214.36952   283%     -   45s
     0     0 5769.30727    0  483 -3396.2881 5769.30727   270%     -   49s
     0     0 5677.57096    0  483 -3396.2881 5677.57096   267%     -   51s
     0     0 5605.89319    0  493 -3396.2881 5605.89319   265%     -   53s
     0     0 5596.79077    0  484 -3396.2881 5596.79077   265%     -   53s
     0     0 5572.82060    0  482 -3396.2881 5572.82060   264%     -   54s
     0     0 5568.97145    0  425 -3396.2881 5568.97145   264%     -   54s
     0     0 5562.43236    0  428 -3396.2881 5562.43236   264%     -   54s
     0     0 5561.15766    0  429 -3396.2881 5561.15766   264%     -   54s
     0     0 5560.82014    0  427 -3396.2881 5560.82014   264%     -   55s
     0     0 4953.68541    0  461 -3396.2881 4953.68541   246%     -   62s
H    0     0                    -3392.375866 4951.60017   246%     -   62s
     0     0 4879.94690    0  464 -3392.3759 4879.94690   244%     -   64s
     0     0 4859.58171    0  465 -3392.3759 4859.58171   243%     -   65s
     0     0 4851.76976    0  468 -3392.3759 4851.76976   243%     -   66s
     0     0 4844.29905    0  479 -3392.3759 4844.29905   243%     -   67s
     0     0 4843.02502    0  472 -3392.3759 4843.02502   243%     -   67s
     0     0 4842.30859    0  472 -3392.3759 4842.30859   243%     -   67s
     0     0 4765.99525    0  511 -3392.3759 4765.99525   240%     -   69s
     0     0 4731.02892    0  515 -3392.3759 4731.02892   239%     -   71s
     0     0 4720.74886    0  520 -3392.3759 4720.74886   239%     -   72s
     0     0 4709.68672    0  524 -3392.3759 4709.68672   239%     -   72s
     0     0 4707.92711    0  523 -3392.3759 4707.92711   239%     -   73s
     0     0 4705.86686    0  528 -3392.3759 4705.86686   239%     -   73s
     0     0 4704.06445    0  525 -3392.3759 4704.06445   239%     -   73s
     0     0 4703.23552    0  537 -3392.3759 4703.23552   239%     -   74s
     0     0 4688.54708    0  476 -3392.3759 4688.54708   238%     -   75s
     0     0 4682.76601    0  538 -3392.3759 4682.76601   238%     -   77s
     0     0 4681.18676    0  540 -3392.3759 4681.18676   238%     -   77s
     0     0 4680.38248    0  475 -3392.3759 4680.38248   238%     -   77s
     0     0 4673.06230    0  471 -3392.3759 4673.06230   238%     -   78s
     0     0 4671.13517    0  490 -3392.3759 4671.13517   238%     -   79s
     0     0 4670.96118    0  487 -3392.3759 4670.96118   238%     -   79s
     0     0 4665.33893    0  483 -3392.3759 4665.33893   238%     -   80s
     0     0 4662.53586    0  479 -3392.3759 4662.53586   237%     -   81s
     0     0 4661.91806    0  536 -3392.3759 4661.91806   237%     -   81s
     0     0 4658.92070    0  411 -3392.3759 4658.92070   237%     -   82s
     0     0 4658.20286    0  415 -3392.3759 4658.20286   237%     -   82s
     0     0 4655.64470    0  495 -3392.3759 4655.64470   237%     -   83s
     0     0 4653.98174    0  494 -3392.3759 4653.98174   237%     -   84s
     0     0 4651.12757    0  549 -3392.3759 4651.12757   237%     -   85s
     0     0 4650.79887    0  549 -3392.3759 4650.79887   237%     -   85s
H    0     0                    -3338.737534 4650.50541   239%     -   89s
     0     2 4650.50541    0  549 -3338.7375 4650.50541   239%     -   97s
     3     8 4264.64239    2  525 -3338.7375 4518.55592   235%  3389  101s
     7    16 4179.71049    3  491 -3338.7375 4377.46662   231%  4087  105s
    31    50 2524.64640    5  242 -3338.7375 4066.34067   222%  5926  116s
    49    82 2720.64450    6  435 -3338.7375 4066.34067   222%  5938  120s
    81   162 2599.84196    7  423 -3338.7375 4066.34067   222%  4671  126s
   296   385 2310.43269   10  420 -3338.7375 4066.34067   222%  2002  132s
   408   457 1789.75044   11  343 -3338.7375 4066.34067   222%  1646  135s
   528   500 2300.93444   10  343 -3338.7375 4066.34067   222%  1410  140s
   627   529 2007.76480   11  408 -3338.7375 4066.34067   222%  1303  145s
   718   551 1573.37827   12  338 -3338.7375 4066.34067   222%  1273  151s
   782   578 1470.70665   13  333 -3338.7375 4066.34067   222%  1253  155s
   865   637 -1259.0520   15  396 -3338.7375 4066.34067   222%  1324  162s
   915   659  845.21606   15  394 -3338.7375 4066.34067   222%  1340  168s
   968   695  812.98008   16  402 -3338.7375 3751.85349   212%  1345  171s
  1026   727  692.62587   17  395 -3338.7375 3751.85349   212%  1339  175s
  1134   774  583.85710   17  320 -3338.7375 3751.85349   212%  1317  184s
  1169   807  640.63979   19  395 -3338.7375 3751.85349   212%  1332  188s
  1234   830  -90.42089   20  374 -3338.7375 3694.55112   211%  1328  194s
  1295   861   94.96573   20  359 -3338.7375 3694.55112   211%  1321  197s
  1376   900 -453.21669   18  375 -3338.7375 3694.55112   211%  1311  201s
  1437   938 -490.96623   21  344 -3338.7375 3694.55112   211%  1312  206s
  1530   987  -47.08294   21  375 -3338.7375 3694.55112   211%  1305  210s
  1723  1076 -517.63481   23  326 -3338.7375 3440.04245   203%  1279  219s
  1825  1130 -839.68126   22  296 -3338.7375 3440.04245   203%  1271  223s
  1923  1174 -931.78048   23  317 -3338.7375 3321.68781   199%  1269  227s
  2015  1204     cutoff   22      -3338.7375 3321.68781   199%  1250  231s
  2112  1244 -660.50994   24  310 -3338.7375 3321.68781   199%  1256  235s
  2271  1322 -794.48938   26  245 -3338.7375 3114.97579   193%  1266  244s
  2373  1353 -1904.5585   26  242 -3338.7375 3099.25926   193%  1268  248s
  2491  1393 -838.32407   27  193 -3338.7375 3099.25926   193%  1270  253s
  2611  1441 -947.44548   28  191 -3338.7375 3099.25926   193%  1274  259s
  2743  1487 -1034.2813   29  191 -3338.7375 3099.25926   193%  1272  265s
  2865  1512 -1117.5261   30  250 -3338.7375 2981.72052   189%  1287  271s
  2978  1559 -1132.5432   28  195 -3338.7375 2981.72052   189%  1289  277s
  3130  1614 -1211.5999   29  193 -3338.7375 2952.82137   188%  1291  283s
  3254  1690 -1517.1094   37  226 -3338.7375 2931.22826   188%  1299  289s
  3378  1774  852.69250    9  306 -3338.7375 2931.22826   188%  1304  296s
  3559  1854     cutoff   11      -3338.7375 2931.22826   188%  1296  304s
  3719  1950 -1657.7463   12  259 -3338.7375 2931.22826   188%  1299  312s
  3911  2013     cutoff   14      -3338.7375 2921.44470   188%  1293  320s
  4127  2057     cutoff   14      -3338.7375 2590.17808   178%  1290  326s
  4310  2072     cutoff   14      -3338.7375 2579.12821   177%  1297  333s
  4361  2115 -2590.8044   14  166 -3338.7375 2579.12821   177%  1304  339s
  4476  2165     cutoff   15      -3338.7375 2562.50434   177%  1309  346s
  4631  2250 -1196.3569   13  108 -3338.7375 2562.50434   177%  1312  355s
  4792  2355 1117.93561   10  258 -3338.7375 2562.50434   177%  1324  362s
  5041  2356 1515.79790   11  549 -3338.7375 2562.50434   177%  1315  386s
  5043  2357 -1410.0386   13  285 -3338.7375 2562.50434   177%  1314  401s
  5044  2358 -588.67837   13  358 -3338.7375 2562.50434   177%  1314  411s
  5045  2359 -1672.8802   45  466 -3338.7375 2562.50434   177%  1314  418s
  5046  2359 -2975.0251   28  500 -3338.7375 2562.50434   177%  1314  425s
  5048  2361 -2464.9522   14  478 -3338.7375 2562.50434   177%  1313  432s
  5050  2362 -959.35928   18  472 -3338.7375 2562.50434   177%  1313  436s
  5054  2365 1280.14450   10  419 -3338.7375 2562.50434   177%  1312  440s
  5055  2365 -1380.9256   20  548 -3338.7375 2562.50434   177%  1311  445s
  5059  2368  780.88592   18  498 -3338.7375 2562.50434   177%  1310  454s
  5060  2369 -1593.4593   17  497 -3338.7375 2562.50434   177%  1310  456s
  5063  2371  483.00836   14  492 -3338.7375 2562.50434   177%  1309  463s
  5065  2372 1317.08916   12  492 -3338.7375 2562.50434   177%  1309  465s
  5067  2373 -1718.5590   22  504 -3338.7375 2562.50434   177%  1308  470s
  5069  2375 -2488.9163   20  621 -3338.7375 2562.50434   177%  1308  475s
  5072  2377  927.73370   11  633 -3338.7375 2562.50434   177%  1307  481s
  5074  2378 1294.40886   12  631 -3338.7375 2562.50434   177%  1306  486s
  5075  2379 -3271.3891   23  625 -3338.7375 2562.50434   177%  1306  490s
  5077  2380 -1769.0718   42  428 -3338.7375 2562.50434   177%  1306  495s
  5078  2381 -588.45485   15  428 -3338.7375 2562.50434   177%  1305  510s
  5079  2381 -1331.7346   15  428 -3338.7375 2562.50434   177%  1305  522s
  5080  2385 2562.50434   13  616 -3338.7375 2562.50434   177%  1333  530s
  5082  2388 2562.50434   14  600 -3338.7375 2562.50434   177%  1335  535s
  5086  2395 2562.50434   15  592 -3338.7375 2562.50434   177%  1335  542s
  5094  2408 2562.50434   16  554 -3338.7375 2562.50434   177%  1342  549s
  5110  2426 1816.31379   17  426 -3338.7375 2562.50434   177%  1366  561s
  5133  2449 1626.82444   18  502 -3338.7375 2562.50434   177%  1391  567s
  5165  2482  936.09847   19  459 -3338.7375 2562.50434   177%  1414  577s
  5251  2486 -1085.3019   21  212 -3338.7375 2562.50434   177%  1444  585s
  5338  2468 infeasible   22      -3338.7375 2562.50434   177%  1470  591s
  5394  2471 -1903.9941   24  303 -3338.7375 2562.50434   177%  1497  597s
  5459  2466 -3134.9612   25  170 -3338.7375 2562.50434   177%  1516  604s
  5506  2468     cutoff   29      -3338.7375 2360.09986   171%  1531  613s
  5565  2456 1682.77707   19  290 -3338.7375 2296.28510   169%  1550  619s
  5620  2459 -618.60753   20  206 -3338.7375 2284.51131   168%  1563  626s
  5668  2478 -2448.6354   21  183 -3338.7375 2284.51131   168%  1577  632s
  5739  2469 -2612.7189   22  155 -3338.7375 2284.51131   168%  1587  639s
  5811  2464 -2714.6047   23  147 -3338.7375 2284.51131   168%  1593  646s
  5877  2461 -3254.0444   24   84 -3338.7375 2012.26164   160%  1606  653s
  5955  2446     cutoff   25      -3338.7375 1914.28151   157%  1614  660s
  6037  2438     cutoff   20      -3338.7375 1914.28151   157%  1633  667s
  6130  2421 -2414.1055   21  384 -3338.7375 1241.57916   137%  1647  673s
  6178  2431 -2895.8072   22  283 -3338.7375 1241.57916   137%  1664  679s
  6272  2425     cutoff   24      -3338.7375 1241.57916   137%  1673  686s
  6398  2398 -2371.9442   22  321 -3338.7375 1241.57916   137%  1680  695s
  6517  2363 -856.72997   22  397 -3338.7375 1241.57916   137%  1695  703s
  6638  2344 -944.52229   23  342 -3338.7375 1241.57916   137%  1705  709s
  6768  2336 -2298.2945   24   64 -3338.7375  309.73735   109%  1712  717s
  6910  2321 -1557.9264   27  325 -3338.7375  309.73735   109%  1718  725s
  7024  2308 -1712.0202   30  258 -3338.7375  309.73735   109%  1719  733s
  7220  2254 -2960.7644   34  264 -3338.7375   34.30667   101%  1714  741s
H 7362  2086                    -3207.864126 -254.06688  92.1%  1707  741s
  7413  2132     cutoff   37      -3207.8641 -254.06688  92.1%  1704  750s
  7673  2054 -2143.9232   32  134 -3207.8641 -432.87308  86.5%  1678  757s
* 7812  1893              82    -3207.583685 -721.15372  77.5%  1671  757s
  7920  1854 -3105.3647   36  100 -3207.5837 -799.25403  75.1%  1662  764s
* 8077  1694              83    -3192.999786 -825.25900  74.2%  1653  764s
  8181  1646 -3001.0483   21  450 -3192.9998 -1050.3159  67.1%  1648  771s
H 8460  1482                    -3123.014531 -1082.9411  65.3%  1633  778s
  8698  1438 -2598.4874   60  138 -3123.0145 -1082.9411  65.3%  1617  785s
  9079  1386 infeasible   29      -3123.0145 -1255.4037  59.8%  1587  790s
  9592  1323 -2964.2465   45   77 -3123.0145 -1692.2270  45.8%  1531  796s
H 9766  1168                    -3102.948914 -1692.2270  45.5%  1510  796s
 10175  1307 -2677.6342   35  195 -3102.9489 -1692.2270  45.5%  1461  800s
 12294  1914 -3076.9758   72   32 -3102.9489 -2371.2271  23.6%  1233  807s
 13679  2082     cutoff   29      -3102.9489 -2562.2477  17.4%  1120  811s
 17154  3664 -3060.6095   55   36 -3102.9489 -2747.2142  11.5%   912  816s
*22262  4234              93    -3055.766824 -2815.0688  7.88%   715  818s
H22269  3610                    -3021.634225 -2815.0688  6.84%   714  818s
 22358  3921     cutoff   61      -3021.6342 -2826.8058  6.45%   712  820s
*22685  3847              92    -3019.086822 -2827.2259  6.35%   702  820s
*29169  4678             105    -3010.607729 -2862.0714  4.93%   556  823s
 29891  5232     cutoff   69      -3010.6077 -2877.3781  4.43%   543  828s
*30843  4493              94    -2991.456264 -2877.3781  3.81%   528  828s
 36048  4012     cutoff   59      -2991.4563 -2920.4817  2.37%   457  830s
*38625  3717              94    -2990.025502 -2928.4101  2.06%   429  831s
*41908  1258              92    -2970.181244 -2944.4317  0.87%   398  833s

Cutting planes:
  Learned: 1
  MIR: 379
  Mixing: 2
  Flow cover: 1319
  Zero half: 2
  RLT: 11
  Relax-and-lift: 60

Explored 43722 nodes (16847027 simplex iterations) in 834.01 seconds (2415.88 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -2970.18 -2970.18 -2990.03 ... -3123.01
No other solutions better than -2970.18

Optimal solution found (tolerance 1.00e-04)
Best objective -2.970181244040e+03, best bound -2.970181244040e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 834.03s
  Master Objective (UB) = -2970.18, θ = 128332.72
  Upper Bound (UB) = -2970.18

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 128332.72
  [DEBUG]   ✓ Scenario 0: θ = 128332.72 ≤ Q = 135330.00 (slack: 6997.28)
  [DEBUG]   ✓ Scenario 1: θ = 128332.72 ≤ Q = 128332.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 128332.72 ≤ Q = 128334.43 (slack: 1.71)
  [DEBUG]   ✓ Scenario 3: θ = 128332.72 ≤ Q = 128340.60 (slack: 7.88)
  [DEBUG]   ✓ Scenario 4: θ = 128332.72 ≤ Q = 128342.72 (slack: 10.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x3826a5ae
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xc7d95a52
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.276924e+13
Presolve removed 2607 rows and 1900 columns
Presolve time: 0.00s
Presolved: 486 rows, 489 columns, 1370 nonzeros
Found heuristic solution: objective 6353704.3686
Variable types: 331 continuous, 158 integer (158 binary)

Root relaxation: objective -1.288512e+05, 250 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -128851.16    0  130 6353704.37 -128851.16   102%     -    0s
H    0     0                    -93980.36263 -128851.16  37.1%     -    0s
H    0     0                    -100872.3633 -128851.16  27.7%     -    0s
H    0     0                    -101103.1797 -111047.55  9.84%     -    0s
     0     0 -111047.55    0   78 -101103.18 -111047.55  9.84%     -    0s
H    0     0                    -106437.3761 -111039.01  4.32%     -    0s
H    0     0                    -109969.7021 -110544.32  0.52%     -    0s
     0     0 -110544.32    0   67 -109969.70 -110544.32  0.52%     -    0s
     0     0 -110543.44    0   67 -109969.70 -110543.44  0.52%     -    0s
     0     0 -110264.15    0   53 -109969.70 -110264.15  0.27%     -    0s
     0     0 -110237.38    0   50 -109969.70 -110237.38  0.24%     -    0s
     0     0 -110209.05    0   37 -109969.70 -110209.05  0.22%     -    0s
     0     0 -110203.24    0   36 -109969.70 -110203.24  0.21%     -    0s
     0     0 -110192.40    0   37 -109969.70 -110192.40  0.20%     -    0s
     0     0 -110185.35    0   35 -109969.70 -110185.35  0.20%     -    0s
     0     0 -110024.12    0   10 -109969.70 -110024.12  0.05%     -    0s
     0     0 -110024.12    0   10 -109969.70 -110024.12  0.05%     -    0s
     0     0 -110024.12    0    9 -109969.70 -110024.12  0.05%     -    0s
     0     0          -    0      -109969.70 -109978.84  0.01%     -    0s

Cutting planes:
  Implied bound: 5
  MIR: 4
  Flow cover: 2
  RLT: 4
  Relax-and-lift: 1

Explored 1 nodes (625 simplex iterations) in 0.05 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 6: -109970 -101103 -100872 ... 1.27692e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.099697020913e+05, best bound -1.099788362355e+05, gap 0.0083%
  Subproblem solved in 0.06s
  Worst-case operational profit (Z_SP) = 112743.26
  Scenario: 20 demand increases, 40 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -109969.70
  [DEBUG]   S×d_nominal = 222712.96
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 222712.96 + -109969.70 = 112743.26
  [DEBUG]   Current θ from Master = 128332.72
  [DEBUG]   ⚠️  Z_SP ≤ θ by 15589.46 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -18559.64
  Lower Bound (LB) = -6029.84
  Gap (UB-LB) = 3059.6600, Absolute Gap = 3059.6600, Relative Gap = 1.030126
  Not converged yet (gap = 3059.66 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 20 increases, 40 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 264887 nonzeros
Model fingerprint: 0xdc90c6f8
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 43106 rows and 17506 columns
Presolve time: 0.79s
Presolved: 50017 rows, 22194 columns, 310529 nonzeros
Variable types: 19935 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -375121.6643
Found heuristic solution: objective -210214.6974

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 50017 rows, 22194 columns, 310529 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   32488   -7.6773577e+03   0.000000e+00   4.592197e+07      5s
   43612    6.1246310e+03   0.000000e+00   1.653578e+06     10s
Concurrent spin time: 2.74s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 1.465718e+04, 46886 iterations, 15.21 seconds (30.36 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 14657.1831    0  281 -210214.70 14657.1831   107%     -   16s
H    0     0                    -196065.0261 14657.1831   107%     -   16s
H    0     0                    -66045.79651 14657.1831   122%     -   16s
H    0     0                    -24287.93372 14657.1831   160%     -   16s
H    0     0                    -24165.08554 14657.1831   161%     -   16s
H    0     0                    -23618.93068 14657.1831   162%     -   16s
H    0     0                    -12811.11682 14657.1831   214%     -   16s
H    0     0                    -5434.395582 14657.1831   370%     -   16s
H    0     0                    -3801.373688 14657.1831   486%     -   16s
H    0     0                    -3755.481976 14657.1831   490%     -   16s
H    0     0                    -3688.828192 14657.1831   497%     -   16s
H    0     0                    -3515.180351 14657.1831   517%     -   16s
     0     0 11255.8205    0  336 -3515.1804 11255.8205   420%     -   24s
     0     0 10950.6203    0  276 -3515.1804 10950.6203   412%     -   26s
     0     0 10635.6747    0  227 -3515.1804 10635.6747   403%     -   27s
     0     0 10635.6747    0  227 -3515.1804 10635.6747   403%     -   28s
     0     0 10287.2133    0  292 -3515.1804 10287.2133   393%     -   29s
     0     0 10287.2133    0  335 -3515.1804 10287.2133   393%     -   31s
     0     0 10287.2049    0  241 -3515.1804 10287.2049   393%     -   32s
     0     0 10287.2002    0  241 -3515.1804 10287.2002   393%     -   32s
H    0     0                    -3370.446549 8365.45685   348%     -   37s
H    0     0                    -3360.280770 8365.45685   349%     -   37s
     0     0 8365.45685    0  384 -3360.2808 8365.45685   349%     -   37s
H    0     0                    -3338.737534 8363.25952   350%     -   37s
     0     0 7885.21939    0  378 -3338.7375 7885.21939   336%     -   40s
     0     0 7859.32860    0  380 -3338.7375 7859.32860   335%     -   41s
     0     0 7812.52822    0  380 -3338.7375 7812.52822   334%     -   41s
     0     0 7793.45653    0  377 -3338.7375 7793.45653   333%     -   42s
     0     0 7791.80238    0  377 -3338.7375 7791.80238   333%     -   42s
     0     0 7791.07764    0  372 -3338.7375 7791.07764   333%     -   42s
     0     0 7790.47371    0  374 -3338.7375 7790.47371   333%     -   43s
     0     0 6494.37599    0  407 -3338.7375 6494.37599   295%     -   52s
     0     0 6191.55894    0  421 -3338.7375 6191.55894   285%     -   55s
     0     0 6063.56571    0  479 -3338.7375 6063.56571   282%     -   59s
     0     0 5819.53801    0  452 -3338.7375 5819.53801   274%     -   62s
     0     0 5744.28343    0  472 -3338.7375 5744.28343   272%     -   63s
     0     0 5721.08492    0  483 -3338.7375 5721.08492   271%     -   65s
     0     0 5644.58825    0  485 -3338.7375 5644.58825   269%     -   66s
     0     0 5634.50701    0  493 -3338.7375 5634.50701   269%     -   67s
     0     0 5627.41099    0  494 -3338.7375 5627.41099   269%     -   68s
     0     0 5625.81295    0  491 -3338.7375 5625.81295   269%     -   68s
     0     0 5624.55920    0  429 -3338.7375 5624.55920   268%     -   68s
     0     0 5621.42760    0  435 -3338.7375 5621.42760   268%     -   68s
     0     0 5620.24351    0  442 -3338.7375 5620.24351   268%     -   68s
     0     0 5619.71890    0  443 -3338.7375 5619.71890   268%     -   69s
     0     0 5237.29243    0  456 -3338.7375 5237.29243   257%     -   75s
     0     0 5095.54105    0  459 -3338.7375 5095.54105   253%     -   78s
     0     0 4945.54829    0  448 -3338.7375 4945.54829   248%     -   81s
     0     0 4880.03731    0  457 -3338.7375 4880.03731   246%     -   83s
     0     0 4867.22445    0  457 -3338.7375 4867.22445   246%     -   84s
     0     0 4856.44207    0  456 -3338.7375 4856.44207   245%     -   84s
     0     0 4847.25002    0  456 -3338.7375 4847.25002   245%     -   85s
     0     0 4837.13704    0  456 -3338.7375 4837.13704   245%     -   86s
     0     0 4823.70810    0  449 -3338.7375 4823.70810   244%     -   87s
     0     0 4813.57465    0  452 -3338.7375 4813.57465   244%     -   87s
     0     0 4810.42054    0  460 -3338.7375 4810.42054   244%     -   88s
     0     0 4810.13893    0  455 -3338.7375 4810.13893   244%     -   88s
     0     0 4709.39758    0  409 -3338.7375 4709.39758   241%     -   90s
     0     0 4662.58379    0  460 -3338.7375 4662.58379   240%     -   92s
     0     0 4652.24159    0  515 -3338.7375 4652.24159   239%     -   93s
     0     0 4646.89574    0  472 -3338.7375 4646.89574   239%     -   94s
     0     0 4623.91117    0  525 -3338.7375 4623.91117   238%     -   95s
     0     0 4615.05323    0  570 -3338.7375 4615.05323   238%     -   96s
     0     0 4611.79298    0  524 -3338.7375 4611.79298   238%     -   96s
     0     0 4608.88496    0  507 -3338.7375 4608.88496   238%     -   96s
     0     0 4607.27529    0  523 -3338.7375 4607.27529   238%     -   97s
     0     0 4607.18260    0  526 -3338.7375 4607.18260   238%     -   97s
     0     0 4556.21826    0  511 -3338.7375 4556.21826   236%     -  100s
     0     0 4541.98072    0  515 -3338.7375 4541.98072   236%     -  103s
     0     0 4525.78241    0  515 -3338.7375 4525.78241   236%     -  104s
     0     0 4520.24245    0  460 -3338.7375 4520.24245   235%     -  104s
     0     0 4519.42278    0  460 -3338.7375 4519.42278   235%     -  105s
     0     0 4478.85805    0  523 -3338.7375 4478.85805   234%     -  107s
     0     0 4469.13412    0  469 -3338.7375 4469.13412   234%     -  108s
     0     0 4464.81198    0  474 -3338.7375 4464.81198   234%     -  109s
     0     0 4463.81792    0  527 -3338.7375 4463.81792   234%     -  109s
     0     0 4445.75218    0  526 -3338.7375 4445.75218   233%     -  111s
     0     0 4437.33407    0  532 -3338.7375 4437.33407   233%     -  112s
     0     0 4436.12209    0  412 -3338.7375 4436.12209   233%     -  113s
     0     0 4424.80518    0  536 -3338.7375 4424.80518   233%     -  114s
     0     0 4423.26389    0  525 -3338.7375 4423.26389   232%     -  115s
     0     0 4422.41158    0  531 -3338.7375 4422.41158   232%     -  115s
     0     0 4416.03205    0  542 -3338.7375 4416.03205   232%     -  117s
     0     0 4412.66251    0  487 -3338.7375 4412.66251   232%     -  118s
     0     0 4411.16617    0  492 -3338.7375 4411.16617   232%     -  119s
     0     0 4410.41837    0  489 -3338.7375 4410.41837   232%     -  119s
     0     0 4407.06868    0  484 -3338.7375 4407.06868   232%     -  120s
     0     0 4405.30623    0  485 -3338.7375 4405.30623   232%     -  120s
     0     0 4405.26568    0  485 -3338.7375 4405.26568   232%     -  121s
     0     0 4404.23307    0  486 -3338.7375 4404.23307   232%     -  121s
     0     0 4404.21207    0  486 -3338.7375 4404.21207   232%     -  122s
     0     2 4404.19804    0  486 -3338.7375 4404.19804   232%     -  139s
     1     4 4304.02994    1  470 -3338.7375 4403.78485   232%  2035  141s
     7    16 3579.57601    3  395 -3338.7375 4065.61471   222%  3220  148s
    15    32 3201.03813    4  514 -3338.7375 3904.51410   217%  4360  154s
    31    51 3672.76869    5  388 -3338.7375 3703.73854   211%  6267  200s
    50    79 3298.43712    6  383 -3338.7375 3692.09304   211%  6086  207s
    82   176 3274.44071    7  451 -3338.7375 3692.09304   211%  4915  214s
   181   216 3158.57027    8  352 -3338.7375 3692.09304   211%  2969  217s
   221   248 3037.55284    9  376 -3338.7375 3692.09304   211%  2672  221s
   253   303 2843.11648   10  315 -3338.7375 3692.09304   211%  2570  225s
   328   355 2817.23791    9  363 -3338.7375 3692.09304   211%  2252  232s
   421   377 2720.29554   10  360 -3338.7375 3692.09304   211%  1952  238s
   507   415 1498.08975   11  247 -3338.7375 3692.09304   211%  1808  245s
   571   450 1357.97222   11  303 -3338.7375 3692.09304   211%  1786  252s
   644   475  125.46076   11  304 -3338.7375 3692.09304   211%  1739  258s
   709   491  963.69960   12  324 -3338.7375 3692.09304   211%  1710  265s
   751   527 -819.55586   12  218 -3338.7375 3692.09304   211%  1724  272s
   805   552 -349.73249   13  217 -3338.7375 3692.09304   211%  1714  278s
   864   589 infeasible   13      -3338.7375 3692.09304   211%  1717  285s
  1018   658 -952.72096   13  232 -3338.7375 3371.78663   201%  1635  294s
  1066   692 -1340.7126   14  212 -3338.7375 3371.78663   201%  1622  300s
  1124   742 -1566.2806   15  213 -3338.7375 3354.00684   200%  1611  306s
  1207   780 -1882.8187   16  195 -3338.7375 3286.21946   198%  1598  312s
  1299   837     cutoff   14      -3338.7375 3286.21946   198%  1578  319s
  1384   935 -2021.7666   18  197 -3338.7375 3286.21946   198%  1568  326s
  1510   984 -2732.7597   21  191 -3338.7375 3286.21946   198%  1526  334s
  1648  1015     cutoff   23      -3338.7375 3224.29399   197%  1488  342s
  1747  1037 1561.00410    9  338 -3338.7375 3200.78142   196%  1501  350s
  1829  1060     cutoff   11      -3338.7375 3200.78142   196%  1534  357s
  1914  1084     cutoff   12      -3338.7375 3200.78142   196%  1578  364s
  2014  1122     cutoff   11      -3338.7375 3057.94710   192%  1600  372s
  2126  1148 infeasible   12      -3338.7375 3057.94710   192%  1619  380s
  2233  1162 1712.32682    6  216 -3338.7375 2857.67101   186%  1625  386s
  2279  1187 1230.56567    7  201 -3338.7375 2857.67101   186%  1644  394s
  2373  1211  862.37781    8  254 -3338.7375 2857.67101   186%  1642  403s
  2441  1247  607.95131    9  243 -3338.7375 2857.67101   186%  1664  411s
  2539  1278  -91.70282   10  239 -3338.7375 2857.67101   186%  1670  419s
  2661  1330 -213.97371   11  173 -3338.7375 2857.67101   186%  1668  430s
  2796  1348     cutoff   16      -3338.7375 2802.71120   184%  1664  438s
  2940  1410 -2319.1509   15  258 -3338.7375 2720.20332   181%  1672  446s
  3090  1424 -3165.3830   22  187 -3338.7375 2720.20332   181%  1679  452s
  3139  1441 -3165.6670   23  182 -3338.7375 2720.20332   181%  1682  459s
  3187  1460 infeasible   24      -3338.7375 2720.20332   181%  1687  465s
  3236  1475   57.50525    9  192 -3338.7375 2720.20332   181%  1699  474s
  3313  1527 -219.40552   10  226 -3338.7375 2720.20332   181%  1696  482s
  3409  1573 -1186.1889   12  252 -3338.7375 2651.29405   179%  1697  492s
  3547  1619 -2919.4714   16  370 -3338.7375 2651.29405   179%  1694  504s
  3726  1671 -958.77407   13  220 -3338.7375 2651.29405   179%  1693  514s
  3951  1735     cutoff   14      -3338.7375 2541.65269   176%  1682  524s
  4149  1787     cutoff   13      -3338.7375 2260.89893   168%  1686  536s
  4401  1829     cutoff   11      -3338.7375 2180.00148   165%  1688  549s
  4645  1893 -283.62469   10  342 -3338.7375 2084.82539   162%  1694  563s
  4848  1979 -465.41487   11  384 -3338.7375 2084.82539   162%  1694  577s
  5058  2038 -1822.2110   15  259 -3338.7375 1994.56505   160%  1703  591s
  5338  2067     cutoff   16      -3338.7375 1861.00951   156%  1702  604s
  5629  2115 -397.90263   10  333 -3338.7375 1861.00951   156%  1704  619s
  5915  2149     cutoff   13      -3338.7375 1861.00951   156%  1708  633s
  6204  2189     cutoff   34      -3338.7375 1536.09010   146%  1704  650s
  6533  2240 -1684.4186   12  313 -3338.7375 1451.72980   143%  1706  665s
  6935  2284 -2889.7502   18  268 -3338.7375 1202.48292   136%  1694  682s
  7253  2327 infeasible   14      -3338.7375 1034.02486   131%  1697  699s
  7543  2358 -2276.0764   20  302 -3338.7375  800.22244   124%  1705  717s
  7939  2348 -787.79474   11  192 -3338.7375  751.14220   122%  1704  733s
  8386  2347 -2070.2215   14  258 -3338.7375  590.47086   118%  1698  754s
  8870  2399     cutoff   13      -3338.7375  386.58379   112%  1688  773s
  9281  2436 infeasible   10      -3338.7375  362.35691   111%  1679  794s
  9881  2456 -1863.7511   19  217 -3338.7375   97.00225   103%  1658  813s
 10491  2402 -2582.6846   14  159 -3338.7375  -53.95635  98.4%  1638  832s
 11140  2392     cutoff   13      -3338.7375 -335.42694  90.0%  1623  850s
 11821  2350     cutoff   16      -3338.7375 -438.84025  86.9%  1608  873s
 12534  2279 infeasible   19      -3338.7375 -631.98877  81.1%  1591  894s
 13262  2241 -3219.8407   13   96 -3338.7375 -978.20217  70.7%  1573  916s
 13951  2208 -2279.4098   16  250 -3338.7375 -1060.1630  68.2%  1557  933s
 14051  2225 -2809.7128   17  207 -3338.7375 -1199.3019  64.1%  1557  952s
 14406  2133 infeasible   26      -3338.7375 -1229.0264  63.2%  1546  975s
 15218  2028 -3041.1924   19  299 -3338.7375 -1353.1804  59.5%  1524 1000s
 16159  1921     cutoff   22      -3338.7375 -1581.2370  52.6%  1504 1024s
 17215  1792     cutoff   22      -3338.7375 -1830.8618  45.2%  1478 1047s
 18255  1600     cutoff   22      -3338.7375 -2015.0210  39.6%  1458 1071s
 19452  1310     cutoff   20      -3338.7375 -2160.0080  35.3%  1430 1095s
 20697   898     cutoff   26      -3338.7375 -2351.4597  29.6%  1403 1121s
 22054   101 -2925.7938   27  374 -3338.7375 -2570.3052  23.0%  1374 1141s

Cutting planes:
  Learned: 1
  Implied bound: 11
  MIR: 637
  Flow cover: 1196
  Zero half: 3
  RLT: 32
  Relax-and-lift: 73

Explored 23838 nodes (31484024 simplex iterations) in 1143.65 seconds (3769.55 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -3338.74 -3360.28 -3370.45 ... -23618.9
No other solutions better than -3338.74

Optimal solution found (tolerance 1.00e-04)
Best objective -3.338737534232e+03, best bound -3.338737534232e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1143.72s
  Master Objective (UB) = -3338.74, θ = 124907.32
  Upper Bound (UB) = -3338.74

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 124907.32
  [DEBUG]   ✓ Scenario 0: θ = 124907.32 ≤ Q = 124907.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 124907.32 ≤ Q = 124907.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 124907.32 ≤ Q = 124907.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 124907.32 ≤ Q = 124907.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 124907.32 ≤ Q = 124907.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 124907.32 ≤ Q = 124907.32 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x78c070ad
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x78c070ad
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [1e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.394759e+13
Presolve removed 2607 rows and 1900 columns
Presolve time: 0.00s
Presolved: 486 rows, 489 columns, 1370 nonzeros
Found heuristic solution: objective 6690718.8197
Variable types: 331 continuous, 158 integer (158 binary)

Root relaxation: objective -1.438193e+05, 249 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -143819.28    0  128 6690718.82 -143819.28   102%     -    0s
H    0     0                    -107541.8102 -143819.28  33.7%     -    0s
H    0     0                    -108144.7725 -122837.67  13.6%     -    0s
H    0     0                    -116161.6513 -122837.67  5.75%     -    0s
     0     0 -122837.67    0   40 -116161.65 -122837.67  5.75%     -    0s
H    0     0                    -121740.1084 -122813.89  0.88%     -    0s
     0     0 -122717.54    0   25 -121740.11 -122717.54  0.80%     -    0s
     0     0 -122691.82    0   35 -121740.11 -122691.82  0.78%     -    0s
H    0     0                    -122471.4044 -122691.82  0.18%     -    0s
     0     0 -122563.61    0    5 -122471.40 -122563.61  0.08%     -    0s
     0     0 -122563.61    0    5 -122471.40 -122563.61  0.08%     -    0s
H    0     0                    -122561.9691 -122563.61  0.00%     -    0s

Explored 1 nodes (490 simplex iterations) in 0.05 seconds (0.02 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -122562 -122471 -121979 ... 1.39476e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.225619691473e+05, best bound -1.225636054914e+05, gap 0.0013%
  Subproblem solved in 0.06s
  Worst-case operational profit (Z_SP) = 111189.41
  Scenario: 16 demand increases, 44 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -122561.97
  [DEBUG]   S×d_nominal = 233751.38
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 233751.38 + -122561.97 = 111189.41
  [DEBUG]   Current θ from Master = 124907.32
  [DEBUG]   ⚠️  Z_SP ≤ θ by 13717.91 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -17056.65
  Lower Bound (LB) = -6029.84
  Gap (UB-LB) = 2691.1037, Absolute Gap = 2691.1037, Relative Gap = 0.806024
  Not converged yet (gap = 2691.10 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 16 increases, 44 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308115 nonzeros
Model fingerprint: 0x75fadbbf
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 50297 rows and 20427 columns
Presolve time: 0.96s
Presolved: 58116 rows, 25513 columns, 361344 nonzeros
Variable types: 23254 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -375121.6643
Found heuristic solution: objective -210214.6974

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 58116 rows, 25513 columns, 361344 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   31392   -1.8225483e+04   0.000000e+00   1.917043e+08      5s
   42639   -1.3443313e+03   0.000000e+00   2.281931e+06     10s
   52126    4.6492446e+03   0.000000e+00   6.454267e+07     15s
   61078    9.8251957e+03   0.000000e+00   2.829142e+06     20s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 1.434270e+04, 45905 iterations, 22.47 seconds (47.62 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 14342.7022    0  338 -210214.70 14342.7022   107%     -   23s
H    0     0                    -201231.0552 14342.7022   107%     -   23s
H    0     0                    -76650.99572 14342.7022   119%     -   24s
H    0     0                    -8173.868411 14342.7022   275%     -   24s
H    0     0                    -8025.424223 14342.7022   279%     -   24s
H    0     0                    -3940.910974 14342.7022   464%     -   24s
     0     0 10265.2015    0  311 -3940.9110 10265.2015   360%     -   34s
     0     0 9940.25389    0  360 -3940.9110 9940.25389   352%     -   37s
     0     0 9908.75078    0  364 -3940.9110 9908.75078   351%     -   40s
     0     0 9908.75078    0  363 -3940.9110 9908.75078   351%     -   41s
     0     0 9908.75078    0  333 -3940.9110 9908.75078   351%     -   42s
     0     0 9908.75078    0  333 -3940.9110 9908.75078   351%     -   42s
     0     0 7593.99896    0  386 -3940.9110 7593.99896   293%     -   53s
     0     0 7468.77388    0  390 -3940.9110 7468.77388   290%     -   60s
H    0     0                    -3927.192198 7237.89807   284%     -   65s
H    0     0                    -3923.279968 7237.89807   284%     -   65s
     0     0 7237.89807    0  444 -3923.2800 7237.89807   284%     -   65s
     0     0 7138.24920    0  446 -3923.2800 7138.24920   282%     -   66s
     0     0 7123.07898    0  449 -3923.2800 7123.07898   282%     -   67s
     0     0 7104.21458    0  460 -3923.2800 7104.21458   281%     -   68s
     0     0 6997.42529    0  457 -3923.2800 6997.42529   278%     -   70s
     0     0 6989.22457    0  454 -3923.2800 6989.22457   278%     -   71s
     0     0 6989.00434    0  454 -3923.2800 6989.00434   278%     -   71s
     0     0 5784.89197    0  480 -3923.2800 5784.89197   247%     -   86s
H    0     0                    -3907.917579 5592.90416   243%     -   92s
     0     0 5592.90416    0  422 -3907.9176 5592.90416   243%     -   92s
     0     0 5494.25535    0  420 -3907.9176 5494.25535   241%     -   94s
H    0     0                    -3905.093079 5421.84065   239%     -   97s
     0     0 5421.84065    0  416 -3905.0931 5421.84065   239%     -   97s
     0     0 5363.96035    0  487 -3905.0931 5363.96035   237%     -   99s
     0     0 5338.01179    0  490 -3905.0931 5338.01179   237%     -  101s
     0     0 5321.73820    0  441 -3905.0931 5321.73820   236%     -  102s
     0     0 5319.31332    0  437 -3905.0931 5319.31332   236%     -  103s
     0     0 5312.43259    0  488 -3905.0931 5312.43259   236%     -  104s
     0     0 5303.91999    0  501 -3905.0931 5303.91999   236%     -  105s
     0     0 5302.68923    0  495 -3905.0931 5302.68923   236%     -  105s
     0     0 5301.29942    0  503 -3905.0931 5301.29942   236%     -  105s
     0     0 5300.97832    0  506 -3905.0931 5300.97832   236%     -  106s
     0     0 4949.64877    0  526 -3905.0931 4949.64877   227%     -  113s
     0     0 4855.79646    0  529 -3905.0931 4855.79646   224%     -  117s
     0     0 4835.76112    0  528 -3905.0931 4835.76112   224%     -  118s
     0     0 4826.54308    0  471 -3905.0931 4826.54308   224%     -  119s
     0     0 4820.83517    0  485 -3905.0931 4820.83517   223%     -  120s
     0     0 4818.41721    0  489 -3905.0931 4818.41721   223%     -  121s
     0     0 4816.23057    0  488 -3905.0931 4816.23057   223%     -  121s
     0     0 4815.98157    0  489 -3905.0931 4815.98157   223%     -  121s
     0     0 4767.64218    0  529 -3905.0931 4767.64218   222%     -  125s
     0     0 4740.92893    0  480 -3905.0931 4740.92893   221%     -  127s
     0     0 4705.68761    0  524 -3905.0931 4705.68761   221%     -  129s
     0     0 4673.77197    0  568 -3905.0931 4673.77197   220%     -  130s
     0     0 4665.65332    0  579 -3905.0931 4665.65332   219%     -  132s
     0     0 4663.68368    0  580 -3905.0931 4663.68368   219%     -  132s
     0     0 4663.11894    0  577 -3905.0931 4663.11894   219%     -  132s
     0     0 4630.39128    0  482 -3905.0931 4630.39128   219%     -  135s
     0     0 4613.37794    0  469 -3905.0931 4613.37794   218%     -  139s
     0     0 4608.11082    0  529 -3905.0931 4608.11082   218%     -  139s
     0     0 4601.87124    0  472 -3905.0931 4601.87124   218%     -  140s
     0     0 4601.57465    0  476 -3905.0931 4601.57465   218%     -  140s
     0     0 4587.64628    0  454 -3905.0931 4587.64628   217%     -  142s
     0     0 4581.92886    0  403 -3905.0931 4581.92886   217%     -  143s
     0     0 4579.42243    0  458 -3905.0931 4579.42243   217%     -  144s
     0     0 4577.05369    0  525 -3905.0931 4577.05369   217%     -  145s
     0     0 4575.59788    0  523 -3905.0931 4575.59788   217%     -  145s
     0     0 4575.32819    0  528 -3905.0931 4575.32819   217%     -  146s
     0     0 4560.76760    0  409 -3905.0931 4560.76760   217%     -  149s
     0     0 4559.07945    0  408 -3905.0931 4559.07945   217%     -  164s
     0     0 4557.35063    0  471 -3905.0931 4557.35063   217%     -  165s
     0     0 4556.95688    0  408 -3905.0931 4556.95688   217%     -  165s
     0     0 4546.99136    0  457 -3905.0931 4546.99136   216%     -  166s
     0     0 4462.76217    0  518 -3905.0931 4462.76217   214%     -  170s
     0     0 4449.67565    0  529 -3905.0931 4449.67565   214%     -  171s
     0     0 4446.63959    0  534 -3905.0931 4446.63959   214%     -  172s
     0     0 4445.20607    0  545 -3905.0931 4445.20607   214%     -  172s
     0     0 4444.48805    0  415 -3905.0931 4444.48805   214%     -  172s
     0     0 4441.59020    0  479 -3905.0931 4441.59020   214%     -  174s
     0     0 4441.20419    0  480 -3905.0931 4441.20419   214%     -  174s
     0     0 4440.56540    0  484 -3905.0931 4440.56540   214%     -  175s
     0     0 4440.32336    0  482 -3905.0931 4440.32336   214%     -  175s
     0     0 4440.28398    0  478 -3905.0931 4440.28398   214%     -  176s
     0     0 4440.10330    0  478 -3905.0931 4440.10330   214%     -  176s
     0     0 4439.89071    0  478 -3905.0931 4439.89071   214%     -  178s
     0     0 4439.34178    0  478 -3905.0931 4439.34178   214%     -  179s
     0     2 4438.54996    0  478 -3905.0931 4438.54996   214%     -  201s
     1     3 3966.49803    1  378 -3905.0931 4437.65399   214%  7047  206s
     2     5 3872.45305    2  386 -3905.0931 4437.65399   214%  4504  212s
     4    10 2382.17450    2  365 -3905.0931 4048.06699   204%  5788  218s
     9    20 2173.24348    3  344 -3905.0931 3799.30747   197%  4316  222s
    19    30  649.33177    4  369 -3905.0931 3778.52174   197%  3716  234s
    29    60 3059.33401    6  379 -3905.0931 3778.52174   197%  4207  259s
    59    92 3017.33708    7  439 -3905.0931 3640.55821   193% 11222  269s
    91   138 3015.03046    8  437 -3905.0931 3609.48502   192%  8037  276s
   137   187 2808.18143    9  368 -3905.0931 3609.34864   192%  5699  284s
   188   237 2692.65350   10  366 -3905.0931 3609.34864   192%  4736  293s
   256   293 1496.59005   11  256 -3905.0931 3478.23720   189%  4038  302s
   324   362 1181.50756   12  249 -3905.0931 3478.23720   189%  3554  309s
   404   416     cutoff   13      -3905.0931 3478.23720   189%  3167  316s
   480   461  886.58033   14  244 -3905.0931 3365.59432   186%  2864  324s
   543   515 -1301.2437   15  311 -3905.0931 3365.59432   186%  2768  330s
   619   543 -1399.1223   16  221 -3905.0931 3365.59432   186%  2634  338s
   651   573 -2098.1732   17  179 -3905.0931 3365.59432   186%  2619  345s
   705   604 -2191.9318   18  176 -3905.0931 3365.59432   186%  2528  353s
   762   638 -2313.5911   19  172 -3905.0931 3363.82472   186%  2480  360s
   814   672 -3063.8289   20  177 -3905.0931 3363.82472   186%  2453  367s
   870   707 -3141.0928   21  179 -3905.0931 3363.82472   186%  2444  373s
   942   760 -3219.3313   22  171 -3905.0931 3346.72041   186%  2388  380s
  1019   836 -3260.9341   23  243 -3905.0931 3346.72041   186%  2301  387s
  1121   904     cutoff   24      -3905.0931 3346.72041   186%  2184  394s
  1262   903 2204.05475   10  497 -3905.0931 3346.72041   186%  2042  402s
  1382   944 1768.61211   11  504 -3905.0931 3346.72041   186%  1965  410s
  1459  1002 1622.90255   12  547 -3905.0931 3239.23503   183%  1987  417s
  1543  1054 1588.57823   13  552 -3905.0931 3239.23503   183%  1986  423s
  1642  1125 1202.48405   14  550 -3905.0931 3239.23503   183%  1976  431s
  1747  1217 1146.37588   15  518 -3905.0931 3239.23503   183%  1963  439s
  1899  1332  971.30047   16  448 -3905.0931 3033.69214   178%  1893  447s
  2048  1417  565.74489   18  422 -3905.0931 3007.92316   177%  1848  455s
  2207  1520   60.15195   24  411 -3905.0931 3007.92316   177%  1806  464s
  2369  1602 -1179.4378   31  359 -3905.0931 2922.41164   175%  1767  473s
  2546  1703 -1866.3673   33  276 -3905.0931 2845.26327   173%  1742  481s
  2690  1794 -2525.0364   42  284 -3905.0931 2845.26327   173%  1734  490s
  2870  1870     cutoff   19      -3905.0931 2845.26327   173%  1714  501s
  3039  1947     cutoff   55      -3905.0931 2769.39989   171%  1705  512s
  3229  2041 -1025.3766   15  319 -3905.0931 2769.39989   171%  1691  521s
  3433  2150 -3785.7065   16  301 -3905.0931 2361.80511   160%  1672  531s
  3632  2278     cutoff   17      -3905.0931 2361.79816   160%  1658  543s
  3860  2417 -3075.0714   17  256 -3905.0931 2315.22032   159%  1634  554s
  4138  2523 -3598.7365   20  261 -3905.0931 2263.39537   158%  1599  565s
  4413  2638  968.09068   13  334 -3905.0931 2177.88732   156%  1580  577s
  4603  2639 -3154.8096   39  478 -3905.0931 2154.98802   155%  1585  603s
  4605  2640  133.56116   13  338 -3905.0931 2154.98802   155%  1585  631s
  4606  2641 -2044.3136   18  469 -3905.0931 2154.98802   155%  1584  653s
  4607  2642 -2934.5299   38  521 -3905.0931 2154.98802   155%  1584  662s
  4608  2642 -2740.2557   43  513 -3905.0931 2154.98802   155%  1584  669s
  4609  2643 -598.66993   22  531 -3905.0931 2154.98802   155%  1583  674s
  4610  2644 -2925.1041   24  519 -3905.0931 2154.98802   155%  1583  679s
  4611  2644 -752.83141   29  528 -3905.0931 2154.98802   155%  1583  681s
  4613  2646 -1284.7954   16  540 -3905.0931 2154.98802   155%  1582  685s
  4617  2648 -1450.8942   13  545 -3905.0931 2154.98802   155%  1580  692s
  4618  2649 -283.61345   27  530 -3905.0931 2154.98802   155%  1580  698s
  4619  2650 -1562.3387   18  542 -3905.0931 2154.98802   155%  1580  700s
  4622  2652 -3282.3025   27  494 -3905.0931 2154.98802   155%  1579  710s
  4625  2654 -2045.6877   32  547 -3905.0931 2154.98802   155%  1578  720s
  4628  2656 -3815.0443   39  561 -3905.0931 2154.98802   155%  1577  725s
  4630  2657 -3384.9503   43  562 -3905.0931 2154.98802   155%  1576  732s
  4631  2658 -2666.0128   33  542 -3905.0931 2154.98802   155%  1576  737s
  4633  2659 -2318.8956   42  552 -3905.0931 2154.98802   155%  1575  741s
  4634  2660 -3163.8175   22  615 -3905.0931 2154.98802   155%  1575  747s
  4635  2660   -9.38478   19  614 -3905.0931 2154.98802   155%  1574  750s
  4636  2661  945.88589   13  557 -3905.0931 2154.98802   155%  1574  755s
  4638  2662 -2333.1146   22  430 -3905.0931 2154.98802   155%  1573  762s
  4640  2664 -2075.8362   11  611 -3905.0931 2154.98802   155%  1573  769s
  4641  2664  773.04567   23  611 -3905.0931 2154.98802   155%  1572  798s
  4642  2665  189.72875   23  611 -3905.0931 2154.98802   155%  1572  813s
  4643  2669 2154.98802   14  470 -3905.0931 2154.98802   155%  1607  829s
  4645  2672 2154.98802   15  527 -3905.0931 2154.98802   155%  1608  837s
  4649  2679 2154.98802   16  582 -3905.0931 2154.98802   155%  1613  857s
  4657  2692 2154.98802   17  413 -3905.0931 2154.98802   155%  1622  874s
  4673  2699 2154.98802   18  398 -3905.0931 2154.98802   155%  1656  895s
  4689  2723 1969.58687   19  332 -3905.0931 2154.98802   155%  1677  915s
  4719  2767 1729.73786   20  323 -3905.0931 2154.98802   155%  1695  931s
  4828  2749 -1028.3571   22  498 -3905.0931 2154.98802   155%  1726  942s
  4872  2743 1398.00838   21  246 -3905.0931 2154.98802   155%  1731  956s
  4928  2741 -2368.3498   22  298 -3905.0931 2154.98802   155%  1743  966s
  4972  2745  -63.13394   22  230 -3905.0931 2154.98802   155%  1753  976s
  5027  2747 -1449.4002   23  508 -3905.0931 2154.98802   155%  1765  985s
  5085  2743 -2476.0039   23  238 -3905.0931 2154.98802   155%  1780  994s
  5152  2740 -3200.9273   25  229 -3905.0931 2154.98802   155%  1785 1002s
  5194  2756 -1442.0089   23  196 -3905.0931 2154.98802   155%  1790 1009s
  5245  2762 -1879.4979   24  150 -3905.0931 2154.98802   155%  1789 1018s
  5314  2755 -3576.8449   26   92 -3905.0931 2154.98802   155%  1791 1028s
  5388  2755  729.42245   21  289 -3905.0931 2154.98802   155%  1795 1037s
  5470  2738  158.69145   23  272 -3905.0931 1880.13496   148%  1802 1045s
  5542  2717 -1184.4762   26  426 -3905.0931 1880.13496   148%  1809 1055s
  5628  2705     cutoff   24      -3905.0931 1880.13496   148%  1811 1064s
  5708  2670 -2599.3661   22  136 -3905.0931 1880.13496   148%  1825 1074s
  5814  2626     cutoff   25      -3905.0931 1880.13496   148%  1816 1084s
  5924  2581     cutoff   22      -3905.0931 1094.31991   128%  1819 1095s
  6022  2537  529.02055   19  331 -3905.0931  855.78719   122%  1828 1106s
  6117  2491 -884.64103   20  438 -3905.0931  855.78719   122%  1843 1118s
  6201  2454 -3253.0648   20  431 -3905.0931  855.78719   122%  1858 1131s
  6279  2398 -2351.4831   19  206 -3905.0931   49.82278   101%  1876 1143s
  6387  2303     cutoff   20      -3905.0931   49.82278   101%  1886 1156s
  6554  2215 -3022.9269   21  186 -3905.0931   49.82278   101%  1885 1168s
  6723  2137     cutoff   24      -3905.0931   49.82278   101%  1881 1179s
  6879  2026 -2898.2230   26  300 -3905.0931   49.82278   101%  1873 1188s
  7111  1891 -3011.2607   27  346 -3905.0931   49.82278   101%  1843 1197s
  7282  1836 -3266.8244   28  346 -3905.0931   49.82278   101%  1821 1205s
  7410  1753     cutoff   30      -3905.0931 -1745.3269  55.3%  1806 1212s
  7504  1724 -3159.4566   27  195 -3905.0931 -2579.5685  33.9%  1795 1218s
  7552  1697     cutoff   28      -3905.0931 -2937.7270  24.8%  1790 1224s
  7583  1685 infeasible   35      -3905.0931 -3371.2573  13.7%  1786 1226s

Cutting planes:
  Learned: 1
  MIR: 492
  Mixing: 1
  Flow cover: 1339
  Zero half: 1
  RLT: 7
  Relax-and-lift: 76

Explored 7587 nodes (13753626 simplex iterations) in 1226.91 seconds (3375.48 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -3905.09 -3907.92 -3923.28 ... -210215
No other solutions better than -3905.09

Optimal solution found (tolerance 1.00e-04)
Best objective -3.905093078592e+03, best bound -3.905093078592e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1226.92s
  Master Objective (UB) = -3905.09, θ = 123569.57
  Upper Bound (UB) = -3905.09

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 123569.57
  [DEBUG]   ✓ Scenario 0: θ = 123569.57 ≤ Q = 123569.57 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 123569.57 ≤ Q = 123569.57 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 123569.57 ≤ Q = 123569.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 123569.57 ≤ Q = 123569.57 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 123569.57 ≤ Q = 127211.30 (slack: 3641.73)
  [DEBUG]   ✓ Scenario 5: θ = 123569.57 ≤ Q = 123569.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 123569.57 ≤ Q = 123569.57 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x7c748adf
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x7c748adf
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.400814e+13
Presolve removed 2607 rows and 1900 columns
Presolve time: 0.00s
Presolved: 486 rows, 489 columns, 1370 nonzeros
Found heuristic solution: objective 6723361.5879
Variable types: 331 continuous, 158 integer (158 binary)

Root relaxation: objective -1.404035e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -140403.46    0  125 6723361.59 -140403.46   102%     -    0s
H    0     0                    -107003.9994 -140403.46  31.2%     -    0s
H    0     0                    -107241.6269 -140403.46  30.9%     -    0s
     0     0 -117667.45    0   82 -107241.63 -117667.45  9.72%     -    0s
H    0     0                    -113192.7581 -117533.09  3.83%     -    0s
H    0     0                    -115422.7438 -117533.09  1.83%     -    0s
     0     0 -116780.74    0   82 -115422.74 -116780.74  1.18%     -    0s
H    0     0                    -115447.6648 -116757.03  1.13%     -    0s
     0     0 -116507.52    0   83 -115447.66 -116507.52  0.92%     -    0s
     0     0 -116485.16    0   83 -115447.66 -116485.16  0.90%     -    0s
     0     0 -116163.54    0   60 -115447.66 -116163.54  0.62%     -    0s
     0     0 -116055.12    0   64 -115447.66 -116055.12  0.53%     -    0s
     0     0 -116036.24    0   55 -115447.66 -116036.24  0.51%     -    0s
     0     0 -115756.52    0   34 -115447.66 -115756.52  0.27%     -    0s
     0     0 -115711.49    0   33 -115447.66 -115711.49  0.23%     -    0s
     0     0 -115693.83    0   31 -115447.66 -115693.83  0.21%     -    0s
     0     0 -115689.76    0   30 -115447.66 -115689.76  0.21%     -    0s
     0     0 -115609.57    0   20 -115447.66 -115609.57  0.14%     -    0s
     0     0 -115564.40    0   14 -115447.66 -115564.40  0.10%     -    0s
     0     0 -115560.01    0   15 -115447.66 -115560.01  0.10%     -    0s
     0     0 -115497.32    0    6 -115447.66 -115497.32  0.04%     -    0s
     0     0 -115497.32    0    9 -115447.66 -115497.32  0.04%     -    0s
H    0     0                    -115482.8511 -115497.32  0.01%     -    0s
     0     0          -    0      -115482.85 -115492.92  0.01%     -    0s

Cutting planes:
  Gomory: 2
  Implied bound: 3
  MIR: 2
  Flow cover: 4
  RLT: 2

Explored 1 nodes (748 simplex iterations) in 0.07 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 8: -115483 -115448 -115423 ... 1.40081e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.154828511488e+05, best bound -1.154929176142e+05, gap 0.0087%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 117892.44
  Scenario: 38 demand increases, 22 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -115482.85
  [DEBUG]   S×d_nominal = 233375.29
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 233375.29 + -115482.85 = 117892.44
  [DEBUG]   Current θ from Master = 123569.57
  [DEBUG]   ⚠️  Z_SP ≤ θ by 5677.13 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -9582.22
  Lower Bound (LB) = -6029.84
  Gap (UB-LB) = 2124.7481, Absolute Gap = 2124.7481, Relative Gap = 0.544097
  Not converged yet (gap = 2124.75 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 38 increases, 22 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351343 nonzeros
Model fingerprint: 0x15e4c4f1
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 57468 rows and 23338 columns
Presolve time: 1.09s
Presolved: 66235 rows, 28842 columns, 412219 nonzeros
Variable types: 26583 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -375121.6643
Found heuristic solution: objective -210214.6974

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 66235 rows, 28842 columns, 412219 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   36491   -5.8370924e+04   0.000000e+00   3.787713e+06      5s
   51206   -2.3052555e+04   0.000000e+00   2.957305e+06     10s
   61936   -2.3213164e+03   0.000000e+00   5.684360e+06     15s
   70896    1.0440446e+03   0.000000e+00   6.438474e+05     20s
   79435    3.2747205e+03   0.000000e+00   1.592799e+07     25s
   85317    5.2182740e+03   0.000000e+00   1.549625e+08     30s
Concurrent spin time: 5.19s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 1.426364e+04, 65703 iterations, 34.50 seconds (70.22 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 14263.6433    0  336 -210214.70 14263.6433   107%     -   36s
H    0     0                    -197529.5060 14263.6433   107%     -   36s
H    0     0                    -33217.07746 14263.6433   143%     -   36s
H    0     0                    -22057.91306 14263.6433   165%     -   36s
H    0     0                    -4501.515260 14263.6433   417%     -   36s
H    0     0                    -4413.799722 14263.6433   423%     -   36s
H    0     0                    -4409.887492 14263.6433   423%     -   36s
H    0     0                    -4268.891398 14263.6433   434%     -   36s
H    0     0                    -4034.128129 14263.5784   454%     -   38s
H    0     0                    -3946.940519 11325.1199   387%     -   47s
     0     0 11321.9011    0  284 -3946.9405 11321.9011   387%     -   47s
     0     0 10412.0245    0  293 -3946.9405 10412.0245   364%     -   52s
     0     0 10371.8256    0  370 -3946.9405 10371.8256   363%     -   55s
     0     0 10150.3634    0  288 -3946.9405 10150.3634   357%     -   56s
     0     0 9943.10054    0  302 -3946.9405 9943.10054   352%     -   59s
     0     0 9859.13276    0  308 -3946.9405 9859.13276   350%     -   63s
     0     0 9859.13276    0  308 -3946.9405 9859.13276   350%     -   65s
     0     0 9859.13276    0  308 -3946.9405 9859.13276   350%     -   65s
     0     0 7959.94299    0  382 -3946.9405 7959.94299   302%     -   76s
H    0     0                    -3929.309513 7959.94299   303%     -   76s
     0     0 7469.77185    0  434 -3929.3095 7469.77185   290%     -   84s
     0     0 7322.05941    0  429 -3929.3095 7322.05941   286%     -   87s
     0     0 7198.75319    0  434 -3929.3095 7198.75319   283%     -   90s
     0     0 7169.75476    0  447 -3929.3095 7169.75476   282%     -   91s
     0     0 7154.80991    0  459 -3929.3095 7154.80991   282%     -   92s
     0     0 7145.88369    0  462 -3929.3095 7145.88369   282%     -   93s
     0     0 7144.91370    0  463 -3929.3095 7144.91370   282%     -   93s
     0     0 7144.79978    0  465 -3929.3095 7144.79978   282%     -   93s
     0     0 6280.12886    0  456 -3929.3095 6280.12886   260%     -  112s
     0     0 6056.20506    0  370 -3929.3095 6056.20506   254%     -  121s
     0     0 5992.98455    0  364 -3929.3095 5992.98455   253%     -  123s
     0     0 5900.71849    0  368 -3929.3095 5900.71849   250%     -  127s
     0     0 5859.43717    0  415 -3929.3095 5859.43717   249%     -  130s
     0     0 5844.30332    0  419 -3929.3095 5844.30332   249%     -  131s
     0     0 5790.12400    0  425 -3929.3095 5790.12400   247%     -  134s
     0     0 5769.70241    0  410 -3929.3095 5769.70241   247%     -  136s
     0     0 5763.82050    0  417 -3929.3095 5763.82050   247%     -  137s
     0     0 5760.94475    0  423 -3929.3095 5760.94475   247%     -  138s
     0     0 5743.67142    0  474 -3929.3095 5743.67142   246%     -  139s
     0     0 5741.73271    0  421 -3929.3095 5741.73271   246%     -  139s
     0     0 5739.91355    0  419 -3929.3095 5739.91355   246%     -  140s
     0     0 5738.03365    0  415 -3929.3095 5738.03365   246%     -  140s
     0     0 5737.89643    0  417 -3929.3095 5737.89643   246%     -  140s
     0     0 5294.92928    0  463 -3929.3095 5294.92928   235%     -  150s
     0     0 5178.32139    0  461 -3929.3095 5178.32139   232%     -  154s
     0     0 5127.80543    0  454 -3929.3095 5127.80543   231%     -  156s
     0     0 5109.35410    0  460 -3929.3095 5109.35410   230%     -  157s
     0     0 5100.58107    0  458 -3929.3095 5100.58107   230%     -  158s
     0     0 5096.85738    0  464 -3929.3095 5096.85738   230%     -  159s
     0     0 5084.05247    0  468 -3929.3095 5084.05247   229%     -  160s
     0     0 5081.29031    0  459 -3929.3095 5081.29031   229%     -  160s
     0     0 5079.66709    0  464 -3929.3095 5079.66709   229%     -  161s
     0     0 5079.16559    0  463 -3929.3095 5079.16559   229%     -  161s
     0     0 4882.29653    0  396 -3929.3095 4882.29653   224%     -  167s
     0     0 4843.70178    0  396 -3929.3095 4843.70178   223%     -  170s
     0     0 4793.76310    0  478 -3929.3095 4793.76310   222%     -  173s
     0     0 4767.61625    0  463 -3929.3095 4767.61625   221%     -  174s
     0     0 4758.77045    0  461 -3929.3095 4758.77045   221%     -  175s
     0     0 4728.30969    0  460 -3929.3095 4728.30969   220%     -  177s
     0     0 4718.42143    0  475 -3929.3095 4718.42143   220%     -  179s
     0     0 4715.92799    0  476 -3929.3095 4715.92799   220%     -  180s
     0     0 4715.18111    0  479 -3929.3095 4715.18111   220%     -  180s
     0     0 4681.64390    0  470 -3929.3095 4681.64390   219%     -  183s
     0     0 4635.56916    0  446 -3929.3095 4635.56916   218%     -  187s
     0     0 4622.89134    0  521 -3929.3095 4622.89134   218%     -  188s
     0     0 4616.13967    0  528 -3929.3095 4616.13967   217%     -  189s
     0     0 4612.87309    0  456 -3929.3095 4612.87309   217%     -  190s
     0     0 4611.86288    0  456 -3929.3095 4611.86288   217%     -  190s
     0     0 4576.28139    0  384 -3929.3095 4576.28139   216%     -  193s
     0     0 4572.49576    0  506 -3929.3095 4572.49576   216%     -  194s
     0     0 4571.97136    0  514 -3929.3095 4571.97136   216%     -  194s
     0     0 4556.34958    0  400 -3929.3095 4556.34958   216%     -  196s
     0     0 4553.69914    0  413 -3929.3095 4553.69914   216%     -  197s
     0     0 4552.98322    0  413 -3929.3095 4552.98322   216%     -  197s
     0     0 4533.95286    0  407 -3929.3095 4533.95286   215%     -  199s
     0     0 4524.21885    0  389 -3929.3095 4524.21885   215%     -  201s
     0     0 4518.36396    0  530 -3929.3095 4518.36396   215%     -  202s
     0     0 4516.73941    0  529 -3929.3095 4516.73941   215%     -  203s
     0     0 4514.37243    0  533 -3929.3095 4514.37243   215%     -  203s
     0     0 4513.08372    0  537 -3929.3095 4513.08372   215%     -  204s
     0     0 4511.90183    0  538 -3929.3095 4511.90183   215%     -  204s
     0     0 4506.91564    0  539 -3929.3095 4506.91564   215%     -  206s
     0     0 4503.03487    0  534 -3929.3095 4503.03487   215%     -  207s
     0     0 4501.53468    0  540 -3929.3095 4501.53468   215%     -  207s
     0     0 4501.21662    0  542 -3929.3095 4501.21662   215%     -  207s
     0     0 4494.33849    0  529 -3929.3095 4494.33849   214%     -  209s
     0     0 4492.08777    0  540 -3929.3095 4492.08777   214%     -  210s
     0     0 4491.38781    0  535 -3929.3095 4491.38781   214%     -  210s
     0     0 4485.39485    0  536 -3929.3095 4485.39485   214%     -  212s
     0     0 4482.43813    0  544 -3929.3095 4482.43813   214%     -  215s
     0     0 4481.22927    0  554 -3929.3095 4481.22927   214%     -  216s
     0     0 4479.98378    0  547 -3929.3095 4479.98378   214%     -  216s
     0     0 4479.11610    0  547 -3929.3095 4479.11610   214%     -  216s
     0     0 4462.64263    0  539 -3929.3095 4462.64263   214%     -  219s
     0     0 4458.88269    0  542 -3929.3095 4458.88269   213%     -  220s
     0     0 4456.92847    0  545 -3929.3095 4456.92847   213%     -  220s
     0     0 4456.61673    0  550 -3929.3095 4456.61673   213%     -  220s
     0     0 4452.65457    0  534 -3929.3095 4452.65457   213%     -  222s
     0     0 4452.20454    0  548 -3929.3095 4452.20454   213%     -  224s
     0     0 4451.07974    0  548 -3929.3095 4451.07974   213%     -  225s
     0     0 4450.85263    0  543 -3929.3095 4450.85263   213%     -  226s
     0     0 4450.54238    0  546 -3929.3095 4450.54238   213%     -  227s
     0     0 4450.52436    0  546 -3929.3095 4450.52436   213%     -  229s
     0     2 4450.30664    0  546 -3929.3095 4450.30664   213%     -  261s
     1     4 4289.75093    1  380 -3929.3095 4450.06195   213%  2636  268s
     3     8 4190.64820    2  397 -3929.3095 4289.58009   209%  4740  273s
     7    16 4038.12282    3  537 -3929.3095 4190.48440   207%  4904  281s
    15    32 3936.41634    4  542 -3929.3095 4037.86666   203%  5378  288s
    31    49 1090.63120    5  185 -3929.3095 3936.33680   200%  8469  306s
    48    81 -297.57243    6  193 -3929.3095 3935.57578   200%  7623  323s
    80   202 -574.94538    7  168 -3929.3095 3935.57578   200%  5797  335s
   203   296 -900.72958   11  145 -3929.3095 3935.57578   200%  3395  343s
   305   381 -1352.7272   11  153 -3929.3095 3935.57578   200%  2916  350s
   413   391 -2508.6305   12  135 -3929.3095 3935.57578   200%  2514  357s
   487   405 -2523.1240   12  142 -3929.3095 3935.57578   200%  2276  365s
   545   432 -2384.2528   13  113 -3929.3095 3935.57578   200%  2242  373s
   620   455 -2410.5667   14  118 -3929.3095 3935.57578   200%  2175  381s
   690   479 -3427.3841   15   83 -3929.3095 3935.57578   200%  2150  388s
   763   525     cutoff   17      -3929.3095 3935.57578   200%  2095  396s
   831   599 infeasible   11      -3929.3095 3935.57578   200%  2070  406s
   931   608 -612.08328    9  117 -3929.3095 3935.57578   200%  1967  414s
  1035   634 -643.96597   10  112 -3929.3095 3935.57578   200%  1877  422s
  1114   673 -2543.2472   15   86 -3929.3095 3935.57578   200%  1851  429s
  1196   734 -3037.1056   22   42 -3929.3095 3935.57578   200%  1853  437s
  1299   766 -3849.8439   30   13 -3929.3095 3935.57578   200%  1825  445s
  1434   814 -2974.2168    9  298 -3929.3095 3637.52134   193%  1771  453s
  1529   872 -3138.7295   10  300 -3929.3095 3636.42200   193%  1772  462s
  1644   916 -3329.2157   13  287 -3929.3095 3636.42200   193%  1760  470s
  1748   961     cutoff   25      -3929.3095 3636.42200   193%  1769  479s
  1832  1009     cutoff   26      -3929.3095 3581.66678   191%  1781  488s
  1960  1036  368.05827    7  402 -3929.3095 3581.66678   191%  1765  497s
  2031  1078 -407.61886    8  333 -3929.3095 3581.66678   191%  1766  507s
  2152  1103 -713.67689   11  248 -3929.3095 3261.06778   183%  1762  517s
  2208  1136 -1259.5790   12  304 -3929.3095 3199.74929   181%  1781  527s
  2296  1209 -1883.8169   14  300 -3929.3095 3199.74929   181%  1800  537s
  2427  1278 -3045.7621   19  208 -3929.3095 3199.74929   181%  1792  547s
  2565  1355     cutoff   27      -3929.3095 3199.74929   181%  1790  557s
  2738  1447 1929.70625    7  463 -3929.3095 3036.42697   177%  1772  568s
  2914  1466 1464.86412    9  410 -3929.3095 2757.26863   170%  1760  579s
  2959  1498 1033.96473   10  392 -3929.3095 2757.26863   170%  1777  587s
  3006  1515 -642.90126   11  332 -3929.3095 2757.26863   170%  1786  597s
  3055  1541 -729.80615   12  333 -3929.3095 2757.26863   170%  1803  605s
  3101  1572 -929.17751   13  329 -3929.3095 2757.26863   170%  1807  615s
  3182  1604 -1454.5447   14  308 -3929.3095 2757.26863   170%  1802  626s
  3244  1669 -2067.2903   15  305 -3929.3095 2757.26863   170%  1810  635s
  3385  1706 -2535.4823   16  297 -3929.3095 2597.03443   166%  1784  647s
  3495  1741 -3286.5627   21  277 -3929.3095 2597.03443   166%  1778  659s
  3589  1830 -1803.4813   12  145 -3929.3095 2456.13067   163%  1796  671s
  3752  1854 -1807.6812    7  246 -3929.3095 2390.89249   161%  1790  684s
  3922  1900 -2586.0758   13  243 -3929.3095 2310.66346   159%  1800  698s
  4079  1968     cutoff   25      -3929.3095 2189.04767   156%  1810  713s
  4285  2007 -731.77919   10  328 -3929.3095 2141.46951   154%  1818  728s
  4501  2035 -1775.9789   13  347 -3929.3095 2105.21061   154%  1823  743s
  4715  2085 -3303.4252   16  338 -3929.3095 1953.25154   150%  1819  757s
  5004  2155 -2795.0592   16  353 -3929.3095 1735.71588   144%  1806  775s
  5290  2194  214.69912   19  394 -3929.3095 1683.10675   143%  1803  794s
  5553  2241 -2129.0995   23  292 -3929.3095 1641.90391   142%  1809  811s
  5817  2262 -1908.9973   12  287 -3929.3095 1446.70713   137%  1819  828s
  6057  2305     cutoff   19      -3929.3095 1346.24949   134%  1825  848s
  6334  2354     cutoff   15      -3929.3095 1296.70563   133%  1836  868s
  6635  2436 -2434.0459   15  375 -3929.3095 1084.08492   128%  1841  888s
  7058  2462 -3725.1139   25  272 -3929.3095  893.58358   123%  1821  909s
  7384  2523     cutoff   13      -3929.3095  873.36206   122%  1812  930s
  7741  2564 -2976.0485   21  146 -3929.3095  699.80385   118%  1809  951s
  8155  2591 -3281.0491    9   56 -3929.3095  546.89828   114%  1806  973s
  8695  2633 -1885.8034   12  291 -3929.3095  394.53568   110%  1784  995s
  9125  2657 -3474.6965   50   49 -3929.3095  122.23485   103%  1769 1020s
  9650  2713 -2298.3503    9  125 -3929.3095   99.89396   103%  1762 1042s
 10178  2802 -1340.4245   16  347 -3929.3095 -159.23043  95.9%  1754 1068s
 10783  2803 -1458.3902   15  546 -3929.3095 -325.66035  91.7%  1736 1183s
 10785  2804 -2427.6123   21  336 -3929.3095 -325.66035  91.7%  1736 1229s
 10786  2805 -966.64148   12  411 -3929.3095 -325.66035  91.7%  1736 1256s
 10787  2806 -1135.7929   17  483 -3929.3095 -325.66035  91.7%  1736 1272s
 10788  2806 -2288.6284   18  498 -3929.3095 -325.66035  91.7%  1735 1281s
 10789  2807 -841.77495   17  479 -3929.3095 -325.66035  91.7%  1735 1288s
 10790  2808 -3312.9753   23  476 -3929.3095 -325.66035  91.7%  1735 1293s
 10791  2808 -1567.8548   12  521 -3929.3095 -325.66035  91.7%  1735 1298s
 10792  2809 -2501.4495   15  485 -3929.3095 -325.66035  91.7%  1735 1302s
 10794  2810 -1816.1865   18  409 -3929.3095 -325.66035  91.7%  1734 1306s
 10796  2812 -3093.8679   21  457 -3929.3095 -325.66035  91.7%  1734 1317s
 10797  2812 -1734.8570   12  462 -3929.3095 -325.66035  91.7%  1734 1321s
 10799  2814 -1511.3541   15  414 -3929.3095 -325.66035  91.7%  1734 1331s
 10801  2815 -3591.3051   47  471 -3929.3095 -325.66035  91.7%  1733 1337s
 10802  2816 -2952.2120   16  466 -3929.3095 -325.66035  91.7%  1733 1343s
 10803  2816 -654.61981    9  490 -3929.3095 -325.66035  91.7%  1733 1346s
 10804  2817 -3609.1872   39  403 -3929.3095 -325.66035  91.7%  1733 1350s
 10806  2818 -1481.8040   19  418 -3929.3095 -325.66035  91.7%  1732 1359s
 10807  2819 -2631.4941   23  466 -3929.3095 -325.66035  91.7%  1732 1362s
 10808  2820 -2457.5036   16  522 -3929.3095 -325.66035  91.7%  1732 1368s
 10809  2820 -942.95633   10  404 -3929.3095 -325.66035  91.7%  1732 1370s
 10810  2821 -3366.8756   18  421 -3929.3095 -325.66035  91.7%  1732 1375s
 10811  2822 -1662.7611   14  421 -3929.3095 -325.66035  91.7%  1732 1418s
 10812  2822 -3123.8869   33  421 -3929.3095 -325.66035  91.7%  1732 1439s
 10813  2826 -325.66035   14  527 -3929.3095 -325.66035  91.7%  1749 1445s
 10815  2829 -325.66035   15  512 -3929.3095 -325.66035  91.7%  1750 1461s
 10819  2836 -325.66035   16  508 -3929.3095 -325.66035  91.7%  1751 1476s
 10827  2849 -325.66035   17  563 -3929.3095 -325.66035  91.7%  1755 1487s
 10843  2860 -325.66035   18  462 -3929.3095 -325.66035  91.7%  1771 1513s
 10859  2887 -325.66035   19  462 -3929.3095 -325.66035  91.7%  1777 1531s
 10891  2926 -325.66035   20  440 -3929.3095 -325.66035  91.7%  1794 1547s
 10942  2958 -325.66035   21  469 -3929.3095 -325.66035  91.7%  1811 1562s
 11010  2964 -325.66035   21  373 -3929.3095 -325.66035  91.7%  1821 1576s
 11106  2938 -325.66035   22  465 -3929.3095 -325.66035  91.7%  1841 1589s
 11187  2914 -325.66035   22  450 -3929.3095 -325.66035  91.7%  1866 1601s
 11261  2890     cutoff   23      -3929.3095 -325.66035  91.7%  1892 1614s
 11341  2868 -325.66035   23  441 -3929.3095 -325.66035  91.7%  1916 1626s
 11394  2848 -887.04681   23  463 -3929.3095 -325.66035  91.7%  1938 1639s
 11443  2854 -3131.8985   24  435 -3929.3095 -325.66035  91.7%  1951 1657s
 11492  2854 -3455.5642   25  419 -3929.3095 -325.66035  91.7%  1966 1668s
 11533  2850     cutoff   26      -3929.3095 -325.66035  91.7%  1992 1678s
 11579  2835     cutoff   26      -3929.3095 -325.66035  91.7%  2004 1693s
 11632  2835 -2765.5876   21  183 -3929.3095 -325.66035  91.7%  2021 1703s
 11697  2810 -3261.9419   22   98 -3929.3095 -325.66035  91.7%  2035 1714s
 11783  2785     cutoff   23      -3929.3095 -325.66035  91.7%  2051 1726s
 11873  2769 -1446.4859   21  273 -3929.3095 -325.66035  91.7%  2064 1739s
 11960  2735     cutoff   22      -3929.3095 -325.66035  91.7%  2072 1751s
 12069  2693 -2477.9888   22  198 -3929.3095 -325.66035  91.7%  2088 1765s
 12178  2653     cutoff   24      -3929.3095 -325.66035  91.7%  2103 1777s
 12271  2610 -3190.7863   22  486 -3929.3095 -325.66035  91.7%  2124 1790s
 12365  2582 -3205.9927   23  482 -3929.3095 -325.66035  91.7%  2147 1804s
 12458  2542 -3824.1417   25  486 -3929.3095 -325.66035  91.7%  2173 1819s
 12580  2492 -2197.7812   22  379 -3929.3095 -348.57465  91.1%  2193 1833s
 12637  2452 -2350.8464   23  417 -3929.3095 -348.57465  91.1%  2208 1846s
 12709  2422     cutoff   24      -3929.3095 -348.57465  91.1%  2218 1860s
 12781  2389     cutoff   24      -3929.3095 -702.27028  82.1%  2235 1876s
 12899  2352 -2315.7295   23  486 -3929.3095 -1185.7370  69.8%  2247 1891s
 13033  2288 -2495.7852   24  380 -3929.3095 -1185.7370  69.8%  2255 1906s
 13206  2215 -2857.4144   26  417 -3929.3095 -1198.3565  69.5%  2262 1921s
 13475  2087 -3234.9448   30  430 -3929.3095 -1327.0675  66.2%  2258 1938s
 13729  1980     cutoff   35      -3929.3095 -1327.0675  66.2%  2254 1955s
 14014  1804     cutoff   36      -3929.3095 -2011.9532  48.8%  2243 1969s
 14199  1699 infeasible   25      -3929.3095 -3051.8739  22.3%  2241 1981s
 14294  1662     cutoff   28      -3929.3095 -3210.5296  18.3%  2232 1988s

Cutting planes:
  MIR: 607
  Flow cover: 1515
  Zero half: 1
  RLT: 14
  Relax-and-lift: 90

Explored 14302 nodes (32181657 simplex iterations) in 1988.66 seconds (5824.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -3929.31 -3946.94 -4034.13 ... -197530
No other solutions better than -3929.31

Optimal solution found (tolerance 1.00e-04)
Best objective -3.929309513249e+03, best bound -3.929309513249e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1988.68s
  Master Objective (UB) = -3929.31, θ = 123460.78
  Upper Bound (UB) = -3929.31

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 123460.78
  [DEBUG]   ✓ Scenario 0: θ = 123460.78 ≤ Q = 123460.78 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 123460.78 ≤ Q = 123460.78 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 123460.78 ≤ Q = 123460.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 123460.78 ≤ Q = 123460.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 123460.78 ≤ Q = 123460.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 123460.78 ≤ Q = 123460.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 123460.78 ≤ Q = 123460.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 123460.78 ≤ Q = 123460.78 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x165538bc
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xe9aac744
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [1e-13, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.404706e+13
Presolve removed 2607 rows and 1900 columns
Presolve time: 0.00s
Presolved: 486 rows, 489 columns, 1370 nonzeros
Found heuristic solution: objective 6729016.5787
Variable types: 331 continuous, 158 integer (158 binary)

Root relaxation: objective -1.409317e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -140931.66    0  125 6729016.58 -140931.66   102%     -    0s
H    0     0                    -107538.0200 -140931.66  31.1%     -    0s
H    0     0                    -107775.6475 -140931.66  30.8%     -    0s
     0     0 -112830.02    0   79 -107775.65 -112830.02  4.69%     -    0s
H    0     0                    -110348.5082 -112719.50  2.15%     -    0s
     0     0 -111743.26    0   82 -110348.51 -111743.26  1.26%     -    0s
     0     0 -111669.27    0   82 -110348.51 -111669.27  1.20%     -    0s
     0     0 -111525.99    0   83 -110348.51 -111525.99  1.07%     -    0s
     0     0 -111272.77    0   39 -110348.51 -111272.77  0.84%     -    0s
H    0     0                    -111060.6005 -111267.85  0.19%     -    0s
     0     0 -111228.32    0   34 -111060.60 -111228.32  0.15%     -    0s
     0     0 -111210.16    0   38 -111060.60 -111210.16  0.13%     -    0s
     0     0 -111113.82    0   22 -111060.60 -111113.82  0.05%     -    0s
     0     0 -111112.99    0   10 -111060.60 -111112.99  0.05%     -    0s
     0     0 -111106.83    0    8 -111060.60 -111106.83  0.04%     -    0s
     0     0 -111086.71    0    3 -111060.60 -111086.71  0.02%     -    0s
     0     0 -111086.71    0    5 -111060.60 -111086.71  0.02%     -    0s
     0     0 -111086.60    0    2 -111060.60 -111086.60  0.02%     -    0s
H    0     0                    -111086.4202 -111086.60  0.00%     -    0s

Explored 1 nodes (615 simplex iterations) in 0.06 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 8: -111086 -111086 -111061 ... 1.40471e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.110864202188e+05, best bound -1.110866002634e+05, gap 0.0002%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 122664.96
  Scenario: 14 demand increases, 46 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -111086.42
  [DEBUG]   S×d_nominal = 233751.38
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 233751.38 + -111086.42 = 122664.96
  [DEBUG]   Current θ from Master = 123460.78
  [DEBUG]   ⚠️  Z_SP ≤ θ by 795.82 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -4725.13
  Lower Bound (LB) = -4725.13
  Gap (UB-LB) = 795.8163, Absolute Gap = 795.8163, Relative Gap = 0.202533
  Not converged yet (gap = 795.82 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 14 increases, 46 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394571 nonzeros
Model fingerprint: 0xf92f2c48
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 64659 rows and 26259 columns
Presolve time: 1.21s
Presolved: 74334 rows, 32161 columns, 463034 nonzeros
Variable types: 29902 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -375121.6643
Found heuristic solution: objective -210214.6974

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 74334 rows, 32161 columns, 463034 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   29252   -1.0458026e+05   0.000000e+00   1.103434e+07      5s
   40980   -3.1096038e+04   0.000000e+00   4.268248e+07     10s
   51213   -8.0564139e+03   0.000000e+00   3.752775e+07     15s
   58584   -5.3638643e+03   0.000000e+00   5.442407e+09     20s
   66156   -1.9428311e+03   0.000000e+00   2.306283e+07     25s
   72579    4.0829737e+02   0.000000e+00   5.857531e+07     30s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 1.425993e+04, 52978 iterations, 29.06 seconds (61.59 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 14259.9250    0  341 -210214.70 14259.9250   107%     -   30s
H    0     0                    -198644.2237 14259.9250   107%     -   30s
H    0     0                    -32397.66457 14259.9250   144%     -   31s
H    0     0                    -32275.12890 14259.9250   144%     -   31s
H    0     0                    -23944.11614 14259.9250   160%     -   31s
H    0     0                    -4604.305008 14259.9250   410%     -   31s
H    0     0                    -4501.515260 14259.9250   417%     -   31s
H    0     0                    -4105.619762 14259.9250   447%     -   31s
H    0     0                    -4038.040359 14259.9250   453%     -   31s
H    0     0                    -4034.128129 10679.5352   365%     -   49s
     0     0 10009.7037    0  296 -4034.1281 10009.7037   348%     -   49s
     0     0 9657.94428    0  290 -4034.1281 9657.94428   339%     -   57s
     0     0 9609.26770    0  295 -4034.1281 9609.26770   338%     -   58s
     0     0 9585.91878    0  258 -4034.1281 9585.91878   338%     -   65s
     0     0 9585.91878    0  287 -4034.1281 9585.91878   338%     -   71s
     0     0 7766.90428    0  291 -4034.1281 7766.90428   293%     -   74s
     0     0 7766.90428    0  292 -4034.1281 7766.90428   293%     -   76s
     0     0 7766.90428    0  351 -4034.1281 7766.90428   293%     -   77s
     0     0 7766.90428    0  347 -4034.1281 7766.90428   293%     -   78s
     0     0 7711.81803    0  421 -4034.1281 7711.81803   291%     -   94s
     0     0 7463.79544    0  422 -4034.1281 7463.79544   285%     -  100s
     0     0 7276.91788    0  383 -4034.1281 7276.91788   280%     -  105s
     0     0 7240.96144    0  390 -4034.1281 7240.96144   279%     -  106s
     0     0 7214.79012    0  426 -4034.1281 7214.79012   279%     -  108s
H    0     0                    -4016.497124 7192.43593   279%     -  110s
     0     0 7192.43593    0  431 -4016.4971 7192.43593   279%     -  110s
     0     0 7180.82630    0  436 -4016.4971 7180.82630   279%     -  111s
H    0     0                    -4005.547456 7027.10945   275%     -  115s
     0     0 7027.10945    0  443 -4005.5475 7027.10945   275%     -  115s
     0     0 7012.78042    0  397 -4005.5475 7012.78042   275%     -  116s
     0     0 6990.12194    0  440 -4005.5475 6990.12194   275%     -  118s
     0     0 6985.28038    0  441 -4005.5475 6985.28038   274%     -  118s
     0     0 6984.83009    0  441 -4005.5475 6984.83009   274%     -  119s
     0     0 5751.56688    0  436 -4005.5475 5751.56688   244%     -  140s
     0     0 5438.54950    0  417 -4005.5475 5438.54950   236%     -  147s
     0     0 5262.39221    0  483 -4005.5475 5262.39221   231%     -  152s
     0     0 5186.04016    0  420 -4005.5475 5186.04016   229%     -  155s
     0     0 5143.63605    0  493 -4005.5475 5143.63605   228%     -  158s
     0     0 5132.14756    0  483 -4005.5475 5132.14756   228%     -  159s
     0     0 5122.91705    0  474 -4005.5475 5122.91705   228%     -  161s
     0     0 5116.95930    0  478 -4005.5475 5116.95930   228%     -  162s
     0     0 5100.01009    0  532 -4005.5475 5100.01009   227%     -  164s
     0     0 5094.81733    0  424 -4005.5475 5094.81733   227%     -  164s
     0     0 5075.18126    0  472 -4005.5475 5075.18126   227%     -  165s
     0     0 5066.17264    0  476 -4005.5475 5066.17264   226%     -  167s
     0     0 5062.08831    0  475 -4005.5475 5062.08831   226%     -  168s
     0     0 5061.58545    0  478 -4005.5475 5061.58545   226%     -  168s
     0     0 4743.74720    0  449 -4005.5475 4743.74720   218%     -  179s
     0     0 4663.11241    0  500 -4005.5475 4663.11241   216%     -  184s
     0     0 4643.11390    0  447 -4005.5475 4643.11390   216%     -  186s
     0     0 4634.28867    0  456 -4005.5475 4634.28867   216%     -  188s
     0     0 4631.20101    0  504 -4005.5475 4631.20101   216%     -  189s
     0     0 4630.65473    0  456 -4005.5475 4630.65473   216%     -  190s
     0     0 4586.00229    0  450 -4005.5475 4586.00229   214%     -  194s
     0     0 4576.09074    0  457 -4005.5475 4576.09074   214%     -  196s
     0     0 4571.79426    0  459 -4005.5475 4571.79426   214%     -  196s
     0     0 4566.05796    0  453 -4005.5475 4566.05796   214%     -  197s
     0     0 4562.27172    0  459 -4005.5475 4562.27172   214%     -  198s
     0     0 4560.13689    0  454 -4005.5475 4560.13689   214%     -  199s
     0     0 4559.83940    0  458 -4005.5475 4559.83940   214%     -  199s
     0     0 4527.17187    0  456 -4005.5475 4527.17187   213%     -  203s
     0     0 4520.95114    0  522 -4005.5475 4520.95114   213%     -  205s
     0     0 4520.26284    0  521 -4005.5475 4520.26284   213%     -  206s
     0     0 4493.53121    0  513 -4005.5475 4493.53121   212%     -  210s
     0     0 4483.45725    0  455 -4005.5475 4483.45725   212%     -  211s
     0     0 4482.00919    0  462 -4005.5475 4482.00919   212%     -  212s
     0     0 4481.48936    0  463 -4005.5475 4481.48936   212%     -  212s
     0     0 4473.19784    0  407 -4005.5475 4473.19784   212%     -  215s
     0     0 4472.41268    0  412 -4005.5475 4472.41268   212%     -  216s
     0     0 4468.27109    0  415 -4005.5475 4468.27109   212%     -  218s
     0     0 4467.30777    0  413 -4005.5475 4467.30777   212%     -  219s
     0     0 4456.57185    0  399 -4005.5475 4456.57185   211%     -  222s
     0     0 4451.90577    0  403 -4005.5475 4451.90577   211%     -  224s
     0     0 4450.89074    0  404 -4005.5475 4450.89074   211%     -  224s
     0     0 4449.42781    0  404 -4005.5475 4449.42781   211%     -  226s
     0     0 4449.19154    0  404 -4005.5475 4449.19154   211%     -  228s
     0     2 4448.91120    0  404 -4005.5475 4448.91120   211%     -  276s
     1     3 4012.41402    1  377 -4005.5475 4442.25028   211%  6526  282s
     2     5 3760.48028    2  544 -4005.5475 4442.25028   211%  6814  288s
     4    10 3597.55845    2  539 -4005.5475 4012.27110   200%  6597  295s
     9    20 3352.37955    3  567 -4005.5475 3747.82715   194%  6077  308s
    19    40 3308.38134    4  390 -4005.5475 3663.12041   191%  7361  320s
    39    53 1122.15995    6  177 -4005.5475 3488.40030   187%  9140  344s
    52    79 1945.97910    6  234 -4005.5475 3488.40030   187% 10795  359s
    78   208 1916.93331    7  229 -4005.5475 3488.40030   187%  8861  371s
   209   249 -1247.2082   12  152 -4005.5475 3488.40030   187%  4968  378s
   252   287 -2178.2670   14  134 -4005.5475 3488.40030   187%  4536  388s
   310   312 -3624.6886   19   73 -4005.5475 3488.40030   187%  4128  397s
   353   350     cutoff   19      -4005.5475 3473.80968   187%  3915  404s
   411   367     cutoff   13      -4005.5475 3473.80968   187%  3629  412s
   482   399  505.68611   11  246 -4005.5475 3473.80968   187%  3395  419s
   549   420 -685.27441   12  155 -4005.5475 3473.80968   187%  3252  427s
   612   445 -765.08630   13  162 -4005.5475 3473.80968   187%  3072  434s
   678   480 -1361.7437   17  193 -4005.5475 3473.80968   187%  2931  442s
   763   517     cutoff   21      -4005.5475 3473.80968   187%  2777  450s
   846   525     cutoff   22      -4005.5475 3473.80968   187%  2648  457s
   906   567 infeasible   21      -4005.5475 3473.80968   187%  2589  465s
   987   590 2578.40309    8  525 -4005.5475 3473.80968   187%  2536  474s
  1071   610 2491.26326    9  521 -4005.5475 3473.80968   187%  2498  483s
  1149   638 1229.90779   11  312 -4005.5475 3473.80968   187%  2491  491s
  1224   687 1048.23291   12  370 -4005.5475 3473.80968   187%  2457  499s
  1317   715  716.56277   14  357 -4005.5475 3308.13323   183%  2405  508s
  1414   768  487.38770   17  343 -4005.5475 3308.13323   183%  2371  517s
  1517   822  249.50823   22  325 -4005.5475 3308.13323   183%  2344  527s
  1616   890  136.78816   25  194 -4005.5475 3308.13323   183%  2331  536s
  1732   981 -178.28205   34  168 -4005.5475 3308.13323   183%  2284  546s
  1855  1026 -1492.0927   43  191 -4005.5475 3308.13323   183%  2237  556s
  1936  1069     cutoff   53      -4005.5475 2904.47544   173%  2227  567s
  2023  1133 -2772.4602   63  129 -4005.5475 2879.11845   172%  2228  578s
  2129  1167 -3466.0378   74   87 -4005.5475 2847.33149   171%  2234  588s
  2234  1211     cutoff   81      -4005.5475 2827.59352   171%  2201  603s
  2330  1263  167.47393    9  364 -4005.5475 2768.81842   169%  2213  617s
  2434  1325 -199.06454   12  315 -4005.5475 2768.81842   169%  2233  630s
  2546  1402 -1064.3948   14  290 -4005.5475 2768.81842   169%  2249  643s
  2685  1462 -2049.8588   14  227 -4005.5475 2668.51043   167%  2243  656s
  2836  1560 -2517.1352   16  218 -4005.5475 2541.05446   163%  2235  669s
  3012  1671     cutoff   15      -4005.5475 2541.05446   163%  2220  683s
  3186  1770 -3324.4804   33  214 -4005.5475 2456.35508   161%  2212  699s
  3382  1818 -2542.6074   21  303 -4005.5475 2456.35508   161%  2196  713s
  3527  1857 -2982.0387   22  282 -4005.5475 2456.35508   161%  2180  728s
  3695  1872 -3833.3940   25  337 -4005.5475 2169.38986   154%  2180  744s
  3852  1937 1027.55823    9  240 -4005.5475 2169.38986   154%  2199  761s
  4023  1984 -2455.5647   14  173 -4005.5475 2073.04782   152%  2221  778s
  4186  2018 -1994.0255   15  154 -4005.5475 2073.04782   152%  2250  795s
  4383  2076  928.55227   14  429 -4005.5475 2063.76221   152%  2264  813s
  4549  2096 -912.90810   17  431 -4005.5475 1976.97159   149%  2286  831s
  4655  2147 -1731.7068   18  429 -4005.5475 1976.97159   149%  2299  850s
  4820  2210 -2043.5008   19  463 -4005.5475 1918.39138   148%  2314  870s
  4985  2261 -2677.7324   21  388 -4005.5475 1917.67369   148%  2344  890s
  5110  2360     cutoff   24      -4005.5475 1917.67369   148%  2369  911s
  5374  2361 -236.03670   19  404 -4005.5475 1869.78736   147%  2374  987s
  5376  2362 -949.61298   15  341 -4005.5475 1869.78736   147%  2374 1021s
  5377  2363  -25.70972   11  456 -4005.5475 1869.78736   147%  2373 1055s
  5378  2364 -1625.5445   11  501 -4005.5475 1869.78736   147%  2373 1069s
  5379  2364 -2775.4552   22  554 -4005.5475 1869.78736   147%  2372 1079s
  5380  2365   -2.30502   13  516 -4005.5475 1869.78736   147%  2372 1086s
  5381  2366 -3497.3970   26  565 -4005.5475 1869.78736   147%  2371 1092s
  5382  2366 -756.05513   10  569 -4005.5475 1869.78736   147%  2371 1097s
  5383  2367 -2849.8128   34  571 -4005.5475 1869.78736   147%  2371 1101s
  5384  2368 -3558.6010   18  574 -4005.5475 1869.78736   147%  2370 1106s
  5385  2368  931.60010   11  561 -4005.5475 1869.78736   147%  2370 1112s
  5386  2369 -1705.8734   15  569 -4005.5475 1869.78736   147%  2369 1115s
  5388  2370 -929.17856   13  572 -4005.5475 1869.78736   147%  2368 1133s
  5389  2371 1072.30810   11  529 -4005.5475 1869.78736   147%  2368 1137s
  5391  2372 -2576.3963   60  418 -4005.5475 1869.78736   147%  2367 1142s
  5392  2373 -871.71606   16  567 -4005.5475 1869.78736   147%  2367 1151s
  5393  2374 -460.31694   15  486 -4005.5475 1869.78736   147%  2366 1155s
  5395  2375 -1922.7112   22  481 -4005.5475 1869.78736   147%  2365 1161s
  5396  2376 -2068.2470   21  479 -4005.5475 1869.78736   147%  2365 1169s
  5397  2376 -929.17856   13  407 -4005.5475 1869.78736   147%  2364 1170s
  5399  2378 -2706.9551   46  484 -4005.5475 1869.78736   147%  2363 1180s
  5401  2379 -1320.1479   15  488 -4005.5475 1869.78736   147%  2363 1191s
  5403  2380  990.78165    9  410 -4005.5475 1869.78736   147%  2362 1196s
  5404  2381 -1343.3879   10  417 -4005.5475 1869.78736   147%  2361 1201s
  5406  2382 -2261.8291   21  424 -4005.5475 1869.78736   147%  2360 1212s
  5408  2384 -3441.6191   28  501 -4005.5475 1869.78736   147%  2360 1223s
  5409  2384 -1746.2678   29  436 -4005.5475 1869.78736   147%  2359 1227s
  5410  2385 -1142.0672   24  431 -4005.5475 1869.78736   147%  2359 1236s
  5411  2386 -1074.4365   13  431 -4005.5475 1869.78736   147%  2358 1271s
  5412  2386 -1752.9592   19  431 -4005.5475 1869.78736   147%  2358 1290s
  5413  2389 1869.78736   13  343 -4005.5475 1869.78736   147%  2400 1306s
  5414  2392 1869.78736   14  211 -4005.5475 1869.78736   147%  2401 1314s
  5417  2397 1869.78736   15  210 -4005.5475 1869.78736   147%  2402 1325s
  5423  2407 1803.11247   16  204 -4005.5475 1869.78736   147%  2405 1338s
  5435  2415 1733.72135   16  371 -4005.5475 1869.78736   147%  2422 1359s
  5447  2441 1127.24454   18  304 -4005.5475 1869.78736   147%  2450 1415s
  5479  2504  336.09633   19  424 -4005.5475 1869.78736   147%  2520 1437s
  5586  2477 -531.52102   20  294 -4005.5475 1869.78736   147%  2583 1449s
  5662  2458 -2753.2907   21  267 -4005.5475 1869.78736   147%  2622 1460s
  5717  2451 -3868.6610   22  260 -4005.5475 1869.78736   147%  2647 1471s
  5749  2449     cutoff   22      -4005.5475 1869.78736   147%  2679 1489s
  5784  2439 -388.51005   21  213 -4005.5475 1869.78736   147%  2713 1501s
  5831  2440     cutoff   21      -4005.5475 1869.78736   147%  2753 1513s
  5873  2436     cutoff   22      -4005.5475 1869.78736   147%  2784 1524s
  5907  2440     cutoff   22      -4005.5475 1869.78736   147%  2800 1534s
  5957  2439 -1039.7042   23  254 -4005.5475 1869.78736   147%  2818 1546s
  6031  2430 -1756.4733   24  285 -4005.5475 1869.78736   147%  2831 1557s
  6087  2422 -1795.9457   25  274 -4005.5475 1869.78736   147%  2852 1569s
  6151  2400 -2856.6128   26  238 -4005.5475 1508.22417   138%  2860 1581s
  6221  2383 -2984.5266   27  151 -4005.5475 1508.22417   138%  2872 1599s
  6292  2345 -3447.3234   29  156 -4005.5475 1508.22417   138%  2887 1611s
  6368  2315     cutoff   31      -4005.5475 1508.22417   138%  2907 1629s
  6430  2303     cutoff   23      -4005.5475 1508.22417   138%  2929 1642s
  6489  2280 -3148.5835   30  238 -4005.5475 1451.15307   136%  2961 1656s
  6552  2241     cutoff   33      -4005.5475 1451.15307   136%  2981 1674s
  6618  2220 -3702.4406   23  271 -4005.5475 1331.33861   133%  3002 1688s
  6695  2194 -3057.1696   22  321 -4005.5475  418.32548   110%  3040 1702s
  6772  2157 -3244.3176   23  364 -4005.5475  418.32548   110%  3054 1717s
  6863  2113     cutoff   25      -4005.5475  418.32548   110%  3077 1731s
  6974  2067     cutoff   26      -4005.5475 -495.19424  87.6%  3108 1746s
  7089  2034 -3434.5823   27  296 -4005.5475 -780.57695  80.5%  3130 1762s
  7205  1982     cutoff   32      -4005.5475 -1162.5002  71.0%  3155 1778s
  7373  1914 infeasible   29      -4005.5475 -1516.9581  62.1%  3163 1794s
  7538  1794     cutoff   24      -4005.5475 -2044.9707  48.9%  3179 1809s
  7744  1697     cutoff   31      -4005.5475 -2048.4916  48.9%  3176 1822s
  7928  1570 -3516.9970   27  242 -4005.5475 -2491.8485  37.8%  3161 1837s
  8093  1496     cutoff   23      -4005.5475 -3174.4912  20.7%  3127 1849s
  8133  1479 -3897.8258   32  222 -4005.5475 -3639.2577  9.14%  3117 1850s

Cutting planes:
  Learned: 2
  MIR: 545
  Mixing: 1
  Flow cover: 1412
  Zero half: 2
  RLT: 14
  Relax-and-lift: 82

Explored 8137 nodes (25595596 simplex iterations) in 1850.77 seconds (5120.57 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -4005.55 -4016.5 -4034.13 ... -32397.7
No other solutions better than -4005.55

Optimal solution found (tolerance 1.00e-04)
Best objective -4.005547456244e+03, best bound -4.005547456244e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1850.79s
  Master Objective (UB) = -4005.55, θ = 123384.54
  Upper Bound (UB) = -4005.55

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 123384.54
  [DEBUG]   ✓ Scenario 0: θ = 123384.54 ≤ Q = 123384.54 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 123384.54 ≤ Q = 123384.54 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 123384.54 ≤ Q = 123384.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 123384.54 ≤ Q = 124478.67 (slack: 1094.13)
  [DEBUG]   ✓ Scenario 4: θ = 123384.54 ≤ Q = 123384.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 123384.54 ≤ Q = 123384.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 123384.54 ≤ Q = 123384.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 123384.54 ≤ Q = 123384.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 123384.54 ≤ Q = 123384.54 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x5a9732b5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x5a9732b5
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [2e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [7e-15, 2e+02]
Found heuristic solution: objective 1.404706e+13
Presolve removed 2607 rows and 1900 columns
Presolve time: 0.00s
Presolved: 486 rows, 489 columns, 1370 nonzeros
Found heuristic solution: objective 6742467.2823
Variable types: 331 continuous, 158 integer (158 binary)

Root relaxation: objective -1.404719e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -140471.85    0  125 6742467.28 -140471.85   102%     -    0s
H    0     0                    -107130.8943 -140471.85  31.1%     -    0s
H    0     0                    -107368.5219 -140471.85  30.8%     -    0s
     0     0 -111814.74    0   79 -107368.52 -111814.74  4.14%     -    0s
H    0     0                    -109161.6988 -111684.05  2.31%     -    0s
     0     0 -110680.99    0   82 -109161.70 -110680.99  1.39%     -    0s
     0     0 -110607.01    0   82 -109161.70 -110607.01  1.32%     -    0s
     0     0 -110533.87    0   82 -109161.70 -110533.87  1.26%     -    0s
     0     0 -110483.78    0   82 -109161.70 -110483.78  1.21%     -    0s
H    0     0                    -109195.4764 -110483.78  1.18%     -    0s
     0     2 -110483.78    0   82 -109195.48 -110483.78  1.18%     -    0s
H   31    45                    -109655.7731 -110147.92  0.45%  20.3    0s
*   47    36               5    -109919.5337 -110147.83  0.21%  17.5    0s
*  251    16              23    -109927.8945 -109950.25  0.02%   8.1    0s
*  267    16              20    -109936.1052 -109950.25  0.01%   7.9    0s

Cutting planes:
  Gomory: 51
  Implied bound: 2
  MIR: 183
  BQP: 1

Explored 287 nodes (2635 simplex iterations) in 0.08 seconds (0.07 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -109936 -109928 -109920 ... 1.40471e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.099361052320e+05, best bound -1.099412483293e+05, gap 0.0047%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 123335.24
  Scenario: 13 demand increases, 47 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -109936.11
  [DEBUG]   S×d_nominal = 233271.34
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 233271.34 + -109936.11 = 123335.24
  [DEBUG]   Current θ from Master = 123384.54
  [DEBUG]   ⚠️  Z_SP ≤ θ by 49.30 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -4054.85
  Lower Bound (LB) = -4054.85
  Gap (UB-LB) = 49.3020, Absolute Gap = 49.3020, Relative Gap = 0.012308
  *** CONVERGED (gap within tolerance) ***

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 9
Total Time: 7770.78s
Converged: True
Final Lower Bound: -4054.8495
Final Upper Bound: -4005.5475
Final Gap: 49.302026
Number of Critical Scenarios: 9
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [1] (1/3)
Product 1 Plants: [0] (1/3)
Product 2 Plants: [0] (1/3)
Total Plant Openings: 3
DCs Opened: [5, 8, 9] (3/10)
Active Routes (Plant→DC): 9
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 0 customers  Mode 1: 7 customers  Mode 2: 43 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 9
Start Time: 2026-01-04 12:30:56
End Time: 2026-01-04 14:40:27
Total Time: 7770.78s
Optimal Value: -4054.85
Lower Bound: -4054.85
Upper Bound: -4005.55
Gap: 49.302026
Plants Opened: {0: [1], 1: [0], 2: [0]} (3 plants)
DCs Opened: [5, 8, 9] (3 DCs)
================================================================================

Results saved to: result/DH_single_full_seed12_Mixed_gamma20_20260104_144027.csv

Total Execution Time: 7771.36 seconds
End Time: 2026-01-04 14:40:28

All tasks completed successfully!

