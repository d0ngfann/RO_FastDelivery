
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 34
DI Scenario: LD
Start Time: 2026-01-05 08:56:36
================================================================================
Loading data from data/DH_data_full_seed34.pkl...

Applying DI scenario: LD
DI values:
  Product 0: ['1.000', '1.116', '1.245'] (k=0.270)
  Product 1: ['1.000', '1.000', '1.000'] (k=0.000)
  Product 2: ['1.000', '1.034', '1.070'] (k=0.083)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=921, max=1787
  DC capacity (MC): min=431, max=854

Demand Structure (s_rk matrix):
  Total customer-product pairs: 82/150 (45.3% sparse)
  Average products per customer: 1.64

Demand (only non-zero entries):
  Nominal (μ): min=8.04, max=34.79, count=82
  Deviation (μ̂): min=4.41, max=10.00

Costs:
  Plant fixed cost: min=5213, max=9962
  DC fixed cost: min=3231, max=5838
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.461', '2.135'] (k=0.935)
    Product 1: ['1.000', '1.393', '1.942'] (k=0.818)
    Product 2: ['1.000', '1.441', '2.075'] (k=0.900)
  MD:
    Product 0: ['1.000', '1.184', '1.403'] (k=0.417)
    Product 1: ['1.000', '1.174', '1.379'] (k=0.396)
    Product 2: ['1.000', '1.288', '1.660'] (k=0.625)
  LD:
    Product 0: ['1.000', '1.116', '1.245'] (k=0.270)
    Product 1: ['1.000', '1.000', '1.000'] (k=0.000)
    Product 2: ['1.000', '1.034', '1.070'] (k=0.083)
  Mixed:
    Product 0: ['1.000', '1.461', '2.135'] (k=0.935)
    Product 1: ['1.000', '1.174', '1.379'] (k=0.396)
    Product 2: ['1.000', '1.034', '1.070'] (k=0.083)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48756 nonzeros
Model fingerprint: 0x0e9c7c42
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11789 rows and 2789 columns
Presolve time: 0.08s
Presolved: 4884 rows, 5711 columns, 33922 nonzeros
Variable types: 3452 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -309329.5914
Found heuristic solution: objective -193281.0883

Root relaxation: objective 7.001793e+04, 5429 iterations, 0.27 seconds (0.54 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 70017.9322    0  752 -193281.09 70017.9322   136%     -    0s
H    0     0                    -157414.7272 70017.9322   144%     -    0s
     0     0 65284.7175    0  992 -157414.73 65284.7175   141%     -    1s
     0     0 65196.3365    0  986 -157414.73 65196.3365   141%     -    1s
     0     0 65196.3365    0  989 -157414.73 65196.3365   141%     -    1s
     0     0 65196.3365    0  991 -157414.73 65196.3365   141%     -    1s
H    0     0                    -134756.0559 65196.3365   148%     -    1s
     0     0 62906.3639    0 1009 -134756.06 62906.3639   147%     -    2s
H    0     0                    -127580.2449 62905.2137   149%     -    2s
     0     0 62837.9238    0 1021 -127580.24 62837.9238   149%     -    2s
     0     0 62827.3281    0 1107 -127580.24 62827.3281   149%     -    2s
     0     0 62826.1371    0 1110 -127580.24 62826.1371   149%     -    2s
H    0     0                    -98697.92260 60626.4518   161%     -    3s
H    0     0                    -98321.02886 60626.4518   162%     -    3s
H    0     0                    -98269.08733 60626.4518   162%     -    3s
H    0     0                    -98217.77660 60626.4518   162%     -    3s
H    0     0                    -97980.99886 60626.4518   162%     -    3s
H    0     0                    -97940.08099 60626.4518   162%     -    3s
H    0     0                    -97879.80137 60626.4518   162%     -    3s
H    0     0                    -54260.16379 60626.4518   212%     -    3s
     0     0 60626.4518    0 1165 -54260.164 60626.4518   212%     -    3s
     0     0 60164.8176    0 1097 -54260.164 60164.8176   211%     -    4s
     0     0 60077.3525    0 1111 -54260.164 60077.3525   211%     -    4s
     0     0 60073.9339    0 1116 -54260.164 60073.9339   211%     -    4s
     0     0 60072.6885    0 1124 -54260.164 60072.6885   211%     -    4s
H    0     0                    -33927.32826 58215.7873   272%     -    6s
H    0     0                    -28559.57130 58215.7873   304%     -    6s
H    0     0                    -28520.73434 58215.7873   304%     -    6s
H    0     0                    -24896.25893 58215.7873   334%     -    6s
H    0     0                    -24771.10443 58215.7873   335%     -    6s
H    0     0                    -24636.12499 58215.7873   336%     -    6s
H    0     0                    -16802.63034 58215.7873   446%     -    6s
H    0     0                    -16483.64716 58215.7873   453%     -    6s
H    0     0                    -12290.30653 58215.7873   574%     -    6s
H    0     0                    -12288.11072 58215.7873   574%     -    6s
     0     0 58215.7873    0 1353 -12288.111 58215.7873   574%     -    6s
     0     0 57891.7399    0 1372 -12288.111 57891.7399   571%     -    7s
H    0     0                    -12104.30030 57877.4966   578%     -    7s
H    0     0                    -11478.10433 57877.4966   604%     -    7s
H    0     0                    -9072.858826 57877.4966   738%     -    7s
H    0     0                    -9069.932585 57877.4966   738%     -    7s
H    0     0                    -4546.363127 57877.4966  1373%     -    7s
H    0     0                    -4544.167310 57877.4966  1374%     -    7s
     0     0 57877.4966    0 1377 -4544.1673 57877.4966  1374%     -    7s
H    0     0                    -4208.632829 57877.4966  1475%     -    7s
H    0     0                    -4118.126447 57877.4966  1505%     -    7s
H    0     0                    -4115.200206 57877.4966  1506%     -    7s
     0     0 57877.4966    0 1377 -4115.2002 57877.4966  1506%     -    7s
H    0     0                    -3943.522793 57876.3842  1568%     -    7s
H    0     0                    -3831.059048 57876.3842  1611%     -    7s
H    0     0                    -3199.960990 57876.3842  1909%     -    7s
H    0     0                    -3160.459194 57876.3842  1931%     -    7s
H    0     0                    -2821.610019 57876.3842  2151%     -    7s
H    0     0                    -2444.060795 57876.3842  2468%     -    7s
H    0     0                    -2422.159624 57876.3842  2489%     -    7s
H    0     0                    -2333.375545 56499.8224  2521%     -    9s
H    0     0                    -2236.290914 56499.8224  2626%     -    9s
H    0     0                    -2233.324675 56499.8224  2630%     -    9s
H    0     0                    -2230.989491 56499.8224  2633%     -    9s
H    0     0                    -2230.661646 56499.8224  2633%     -    9s
H    0     0                    -2225.037994 56499.8224  2639%     -    9s
H    0     0                    -2222.071754 56499.8224  2643%     -    9s
H    0     0                    -2221.743909 56499.8224  2643%     -    9s
H    0     0                    -2044.127284 56499.8224  2864%     -    9s
H    0     0                    -1156.451315 56499.8224  4986%     -    9s
H    0     0                    -1048.972636 56499.8224  5486%     -    9s
H    0     0                    -1043.671213 56499.8224  5514%     -    9s
H    0     0                    -1020.745845 56499.8224  5635%     -    9s
H    0     0                    -1020.547601 56499.8224  5636%     -    9s
H    0     0                    -933.8130789 56499.8224  6150%     -    9s
H    0     0                    -885.5329711 56499.8224  6480%     -    9s
H    0     0                    -840.2790368 56499.8224  6824%     -    9s
H    0     0                    -825.7488579 56499.8224  6942%     -    9s
H    0     0                    -727.6374401 56499.8224  7865%     -    9s
H    0     0                    -718.8367857 56499.8224  7960%     -    9s
H    0     0                    -655.3553301 56499.8224  8721%     -    9s
H    0     0                    -630.2387002 56499.8224  9065%     -    9s
H    0     0                    -517.6699344 56499.8224      -     -    9s
H    0     0                    -431.1827015 56499.8224      -     -    9s
H    0     0                    -419.9790664 56499.8224      -     -    9s
H    0     0                    2749.1451131 56499.8224  1955%     -    9s
H    0     0                    3034.6528155 56499.8224  1762%     -    9s
H    0     0                    4074.3566678 56499.8224  1287%     -    9s
H    0     0                    4106.7334568 56499.8224  1276%     -    9s
H    0     0                    4163.6035675 56499.8224  1257%     -    9s
H    0     0                    5035.5611261 56499.8224  1022%     -    9s
H    0     0                    5042.4126269 56499.8224  1020%     -    9s
H    0     0                    5059.5613536 56499.8224  1017%     -    9s
H    0     0                    5069.7464807 56499.8224  1014%     -    9s
     0     0 56499.8224    0 1224 5069.74648 56499.8224  1014%     -    9s
H    0     0                    5195.1232942 56268.9906   983%     -   10s
H    0     0                    5199.0583325 56268.9906   982%     -   10s
H    0     0                    5202.9515213 56268.9906   981%     -   10s
H    0     0                    5204.1189945 56268.9906   981%     -   10s
H    0     0                    5205.9077320 56268.9906   981%     -   10s
     0     0 56268.9906    0 1367 5205.90773 56268.9906   981%     -   10s
H    0     0                    11648.225804 56229.2067   383%     -   10s
H    0     0                    11989.758247 56229.2067   369%     -   10s
     0     0 56229.2067    0 1382 11989.7582 56229.2067   369%     -   10s
     0     0 56222.0703    0 1382 11989.7582 56222.0703   369%     -   10s
H    0     0                    20807.760942 56222.0703   170%     -   10s
H    0     0                    20926.594324 56222.0703   169%     -   10s
H    0     0                    21052.568167 56222.0703   167%     -   10s
H    0     0                    21066.214308 56222.0703   167%     -   10s
H    0     0                    23739.003006 54759.0043   131%     -   12s
H    0     0                    23974.986671 54759.0043   128%     -   12s
H    0     0                    24844.271364 54759.0043   120%     -   12s
H    0     0                    26161.083411 54759.0043   109%     -   12s
H    0     0                    26368.182061 54759.0043   108%     -   12s
H    0     0                    26394.196829 54759.0043   107%     -   12s
H    0     0                    26746.014134 54759.0043   105%     -   12s
H    0     0                    28934.262915 54759.0043  89.3%     -   12s
H    0     0                    29233.621498 54759.0043  87.3%     -   12s
H    0     0                    29587.234333 54759.0043  85.1%     -   12s
H    0     0                    29632.819054 54759.0043  84.8%     -   12s
H    0     0                    29681.578958 54759.0043  84.5%     -   12s
H    0     0                    29695.829776 54759.0043  84.4%     -   12s
H    0     0                    29701.740764 54759.0043  84.4%     -   12s
H    0     0                    29862.614818 54759.0043  83.4%     -   12s
H    0     0                    29873.536201 54759.0043  83.3%     -   12s
H    0     0                    29878.241248 54759.0043  83.3%     -   12s
     0     0 54759.0043    0 1410 29878.2412 54759.0043  83.3%     -   12s
H    0     0                    29987.388988 54527.9229  81.8%     -   12s
H    0     0                    30149.510256 54527.9229  80.9%     -   12s
H    0     0                    30219.740017 54527.9229  80.4%     -   12s
H    0     0                    30265.261468 54527.9229  80.2%     -   12s
     0     0 54527.9229    0 1452 30265.2615 54527.9229  80.2%     -   12s
     0     0 54478.1599    0 1441 30265.2615 54478.1599  80.0%     -   13s
     0     0 54464.4867    0 1458 30265.2615 54464.4867  80.0%     -   13s
     0     0 54460.6076    0 1464 30265.2615 54460.6076  79.9%     -   13s
     0     0 53351.1264    0 1393 30265.2615 53351.1264  76.3%     -   14s
     0     0 53191.3068    0 1366 30265.2615 53191.3068  75.8%     -   15s
H    0     0                    30300.111856 53143.4220  75.4%     -   15s
H    0     0                    30300.385177 53143.4220  75.4%     -   15s
     0     0 53143.4220    0 1409 30300.3852 53143.4220  75.4%     -   15s
     0     0 53134.5428    0 1404 30300.3852 53134.5428  75.4%     -   16s
     0     0 52368.9603    0 1272 30300.3852 52368.9603  72.8%     -   18s
     0     0 52246.5373    0 1409 30300.3852 52246.5373  72.4%     -   18s
     0     0 52218.6408    0 1315 30300.3852 52218.6408  72.3%     -   19s
     0     0 52199.2034    0 1309 30300.3852 52199.2034  72.3%     -   19s
     0     0 52195.8301    0 1339 30300.3852 52195.8301  72.3%     -   19s
H    0     0                    31970.176530 50981.6747  59.5%     -   21s
H    0     0                    32094.640801 50981.6747  58.8%     -   21s
     0     0 50981.6747    0 1323 32094.6408 50981.6747  58.8%     -   21s
     0     0 50755.5975    0 1332 32094.6408 50755.5975  58.1%     -   22s
     0     0 50718.8378    0 1352 32094.6408 50718.8378  58.0%     -   22s
     0     0 50709.6647    0 1353 32094.6408 50709.6647  58.0%     -   23s
     0     0 49545.5153    0 1229 32094.6408 49545.5153  54.4%     -   25s
     0     0 49236.1673    0 1232 32094.6408 49236.1673  53.4%     -   26s
     0     0 49135.5236    0 1255 32094.6408 49135.5236  53.1%     -   26s
     0     0 49122.0967    0 1274 32094.6408 49122.0967  53.1%     -   26s
     0     0 48240.3601    0 1141 32094.6408 48240.3601  50.3%     -   28s
     0     0 48041.0301    0 1288 32094.6408 48041.0301  49.7%     -   29s
     0     0 47992.5343    0 1297 32094.6408 47992.5343  49.5%     -   29s
     0     0 47982.6827    0 1304 32094.6408 47982.6827  49.5%     -   29s
     0     0 47320.0942    0 1259 32094.6408 47320.0942  47.4%     -   31s
     0     0 47208.0685    0 1296 32094.6408 47208.0685  47.1%     -   32s
     0     0 47167.6719    0 1294 32094.6408 47167.6719  47.0%     -   32s
     0     0 47152.0746    0 1181 32094.6408 47152.0746  46.9%     -   32s
     0     0 46802.7565    0 1286 32094.6408 46802.7565  45.8%     -   34s
     0     0 46734.3144    0 1295 32094.6408 46734.3144  45.6%     -   34s
     0     0 46701.9540    0 1299 32094.6408 46701.9540  45.5%     -   35s
     0     0 46693.0904    0 1311 32094.6408 46693.0904  45.5%     -   35s
H    0     0                    32113.547558 46388.0767  44.5%     -   36s
H    0     0                    32128.303733 46388.0767  44.4%     -   36s
H    0     0                    32128.902450 46388.0767  44.4%     -   36s
H    0     0                    32179.189293 46388.0767  44.2%     -   36s
     0     0 46388.0767    0 1283 32179.1893 46388.0767  44.2%     -   36s
H    0     0                    32209.339806 46306.2493  43.8%     -   37s
     0     0 46306.2493    0 1297 32209.3398 46306.2493  43.8%     -   37s
     0     0 46276.5563    0 1309 32209.3398 46276.5563  43.7%     -   38s
     0     0 46265.3749    0 1310 32209.3398 46265.3749  43.6%     -   38s
H    0     0                    32210.334068 46265.3749  43.6%     -   38s
     0     0 46058.0547    0 1276 32210.3341 46058.0547  43.0%     -   39s
     0     0 45988.1634    0 1259 32210.3341 45988.1634  42.8%     -   40s
     0     0 45971.3818    0 1293 32210.3341 45971.3818  42.7%     -   40s
     0     0 45789.4793    0 1199 32210.3341 45789.4793  42.2%     -   41s
     0     0 45789.3777    0 1199 32210.3341 45789.3777  42.2%     -   41s
     0     2 45789.1724    0 1199 32210.3341 45789.1724  42.2%     -   43s
     1     4 44888.6138    1 1134 32210.3341 45789.1724  42.2%  7014   45s
     7    14 43673.7595    3  925 32210.3341 44965.4539  39.6%  5527   50s
    15    26 41453.1616    4  749 32210.3341 44575.7664  38.4%  4460   57s
    55    62 39274.8637    6  654 32210.3341 43523.6582  35.1%  3966   60s
   324   228 37119.6284   13  594 32210.3341 43126.9717  33.9%  1391   65s
   682   439 34496.7476   16  616 32210.3341 42294.8372  31.3%  1090   70s
  1330   743 34067.8820   19  476 32210.3341 41167.5888  27.8%   875   75s
  2032   887 35835.8307   12  434 32210.3341 39686.9917  23.2%   794   80s
  2568   909 32814.8848   17  493 32210.3341 39657.8944  23.1%   777   85s
  3099   890     cutoff   10      32210.3341 37594.8291  16.7%   777   91s
  3684   787     cutoff   23      32210.3341 37222.0921  15.6%   774   96s
  4386   465 infeasible   16      32210.3341 35865.7729  11.3%   751  100s

Cutting planes:
  Gomory: 3
  Implied bound: 491
  MIR: 2562
  Flow cover: 1312
  Zero half: 15
  RLT: 77
  Relax-and-lift: 904

Explored 5372 nodes (3759250 simplex iterations) in 102.99 seconds (215.60 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 32210.3 32209.3 32179.2 ... 30265.3

Optimal solution found (tolerance 1.00e-04)
Best objective 3.221033406784e+04, best bound 3.221033406784e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 103.00s
  Master Objective (UB) = 32210.33, θ = 153731.06
  Upper Bound (UB) = 32210.33

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 153731.06
  [DEBUG]   ✓ Scenario 0: θ = 153731.06 ≤ Q = 153731.06 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x29bdce35
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xd64231cb
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-01, 2e+02]
Found heuristic solution: objective 1.286707e+13
Presolve removed 2592 rows and 1886 columns
Presolve time: 0.00s
Presolved: 501 rows, 503 columns, 1412 nonzeros
Found heuristic solution: objective 7003398.1278
Variable types: 339 continuous, 164 integer (164 binary)

Root relaxation: objective -1.153204e+05, 254 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -115320.45    0  121 7003398.13 -115320.45   102%     -    0s
H    0     0                    -80178.91786 -115320.45  43.8%     -    0s
H    0     0                    -81931.06665 -115320.45  40.8%     -    0s
*    0     0               0    -83094.69320 -83094.693  0.00%     -    0s

Cutting planes:
  Gomory: 20
  MIR: 186

Explored 1 nodes (378 simplex iterations) in 0.02 seconds (0.02 work units)
Thread count was 32 (of 64 available processors)

Solution count 5: -83094.7 -81931.1 -80178.9 ... 1.28671e+13
No other solutions better than -83094.7

Optimal solution found (tolerance 1.00e-04)
Best objective -8.309469319947e+04, best bound -8.309469319947e+04, gap 0.0000%
  Subproblem solved in 0.03s
  Worst-case operational profit (Z_SP) = 116120.99
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -83094.69
  [DEBUG]   S×d_nominal = 199215.69
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 199215.69 + -83094.69 = 116120.99
  [DEBUG]   Current θ from Master = 153731.06
  [DEBUG]   ⚠️  Z_SP ≤ θ by 37610.06 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -5399.73
  Lower Bound (LB) = -5399.73
  Gap (UB-LB) = 37610.0640, Absolute Gap = 37610.0640, Relative Gap = 1.167640
  Not converged yet (gap = 37610.06 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 91993 nonzeros
Model fingerprint: 0x9de30a78
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -5399.73 (0.01s)
MIP start from previous solve produced solution with objective -5399.73 (0.01s)
Loaded MIP start from previous solve with objective -5399.73

Presolve removed 13827 rows and 5606 columns
Presolve time: 0.32s
Presolved: 18136 rows, 9134 columns, 100428 nonzeros
Variable types: 6875 continuous, 2259 integer (2259 binary)

Root relaxation: objective 2.286382e+04, 9489 iterations, 1.21 seconds (2.69 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 22863.8165    0  420 -5399.7299 22863.8165   523%     -    1s
H    0     0                    -4263.947231 22863.8165   636%     -    1s
H    0     0                    -4228.483664 16091.1782   481%     -    3s
     0     0 16091.1782    0  625 -4228.4837 16091.1782   481%     -    3s
     0     0 15873.8213    0  666 -4228.4837 15873.8213   475%     -    3s
     0     0 15873.3549    0  664 -4228.4837 15873.3549   475%     -    3s
     0     0 15873.2057    0  664 -4228.4837 15873.2057   475%     -    3s
     0     0 12312.0727    0  648 -4228.4837 12312.0727   391%     -    5s
H    0     0                    -4226.765141 12310.3941   391%     -    5s
H    0     0                    -4209.595782 12310.3941   392%     -    5s
     0     0 12020.9946    0  661 -4209.5958 12020.9946   386%     -    6s
     0     0 12013.7802    0  662 -4209.5958 12013.7802   385%     -    6s
     0     0 12013.3369    0  668 -4209.5958 12013.3369   385%     -    6s
H    0     0                    -857.5660731 10036.3330  1270%     -    9s
H    0     0                     698.8474569 10036.3330  1336%     -    9s
H    0     0                     805.9842387 10036.3330  1145%     -    9s
     0     0 10036.3330    0  641  805.98424 10036.3330  1145%     -    9s
     0     0 9788.56917    0  611  805.98424 9788.56917  1114%     -    9s
     0     0 9717.35440    0  638  805.98424 9717.35440  1106%     -   10s
     0     0 9710.33599    0  642  805.98424 9710.33599  1105%     -   10s
     0     0 9709.80788    0  638  805.98424 9709.80788  1105%     -   10s
     0     0 8587.29616    0  610  805.98424 8587.29616   965%     -   12s
     0     0 8108.63238    0  704  805.98424 8108.63238   906%     -   14s
     0     0 7885.70532    0  800  805.98424 7885.70532   878%     -   15s
     0     0 7839.10350    0  794  805.98424 7839.10350   873%     -   15s
     0     0 7823.31322    0  791  805.98424 7823.31322   871%     -   15s
     0     0 7822.03798    0  805  805.98424 7822.03798   870%     -   15s
     0     0 7379.02965    0  632  805.98424 7379.02965   816%     -   17s
     0     0 7290.60684    0  548  805.98424 7290.60684   805%     -   17s
     0     0 7270.11730    0  644  805.98424 7270.11730   802%     -   17s
     0     0 7262.90829    0  561  805.98424 7262.90829   801%     -   18s
     0     0 7260.22984    0  565  805.98424 7260.22984   801%     -   18s
     0     0 7002.46455    0  733  805.98424 7002.46455   769%     -   19s
     0     0 6935.45518    0  655  805.98424 6935.45518   760%     -   20s
     0     0 6918.56037    0  648  805.98424 6918.56037   758%     -   20s
     0     0 6901.08424    0  898  805.98424 6901.08424   756%     -   21s
     0     0 6899.27517    0  843  805.98424 6899.27517   756%     -   21s
     0     0 6755.03005    0  630  805.98424 6755.03005   738%     -   22s
     0     0 6710.13724    0  575  805.98424 6710.13724   733%     -   22s
     0     0 6700.04383    0  654  805.98424 6700.04383   731%     -   22s
     0     0 6698.51156    0  649  805.98424 6698.51156   731%     -   22s
H    0     0                    1119.6758676 6523.25444   483%     -   24s
H    0     0                    1600.6379253 6523.25444   308%     -   24s
H    0     0                    1614.3130180 6523.25444   304%     -   24s
     0     0 6523.25444    0  644 1614.31302 6523.25444   304%     -   24s
     0     0 6474.39478    0  718 1614.31302 6474.39478   301%     -   24s
     0     0 6461.46159    0  649 1614.31302 6461.46159   300%     -   24s
     0     0 6456.94431    0  651 1614.31302 6456.94431   300%     -   25s
     0     0 6387.63913    0  557 1614.31302 6387.63913   296%     -   25s
H    0     0                    1660.7976743 6387.58970   285%     -   25s
H    0     0                    1661.5716965 6387.58970   284%     -   26s
     0     0 6368.10099    0  618 1661.57170 6368.10099   283%     -   26s
     0     0 6362.46612    0  543 1661.57170 6362.46612   283%     -   26s
     0     0 6343.32578    0  708 1661.57170 6343.32578   282%     -   27s
     0     0 6338.34341    0  708 1661.57170 6338.34341   281%     -   27s
     0     0 6280.23590    0  615 1661.57170 6280.23590   278%     -   28s
     0     0 6275.14052    0  629 1661.57170 6275.14052   278%     -   28s
     0     0 6261.33543    0  699 1661.57170 6261.33543   277%     -   29s
     0     0 6259.48334    0  685 1661.57170 6259.48334   277%     -   29s
     0     0 6233.72281    0  624 1661.57170 6233.72281   275%     -   29s
     0     0 6233.63599    0  624 1661.57170 6233.63599   275%     -   30s
H    0     0                    1686.3385193 6233.63599   270%     -   34s
     0     2 6233.63599    0  624 1686.33852 6233.63599   270%     -   34s
     1     4 6018.94579    1  411 1686.33852 6232.70943   270%   768   35s
H   33    46                    1709.7861041 5673.40406   232%   877   38s
H   34    46                    1738.4023057 5673.40406   226%   868   38s
    63    75 5421.30390    6  512 1738.40231 5491.16172   216%   804   40s
   323   241 4421.98036   11  441 1738.40231 5449.00709   213%   726   45s
   743   444 3084.97620   16  378 1738.40231 5410.24233   211%   534   50s
  1026   524     cutoff   13      1738.40231 5252.43660   202%   521   55s
  1409   632 2167.55519   12  339 1738.40231 5210.04589   200%   465   60s
  1967   822 2147.00166   12  254 1738.40231 5105.41795   194%   453   65s
  2576   943 2193.92379   14  207 1738.40231 4932.56317   184%   414   70s
  3313   849     cutoff   18      1738.40231 4380.93538   152%   396   75s
  3765   723 2137.54522   15  309 1738.40231 4117.64702   137%   393   80s
  4726   606 infeasible    8      1738.40231 3516.75950   102%   362   86s
  6200  1014 1940.09133   23  624 1738.40231 3022.16549  73.8%   295   98s
  6202  1015 1935.95289   22  192 1738.40231 3022.16549  73.8%   295  100s
  6206  1018 1919.12050   17  522 1738.40231 3022.16549  73.8%   295  105s
  6216  1025 2079.13796   21  574 1738.40231 3022.16549  73.8%   294  110s
  6221  1028 1826.00210   23  609 1738.40231 3022.16549  73.8%   294  115s
  6228  1033 1774.41898   34  565 1738.40231 3022.16549  73.8%   294  120s
  6230  1034 1748.46939   37  553 1738.40231 3022.16549  73.8%   294  125s
  6234  1042 3022.16549   11  537 1738.40231 3022.16549  73.8%   300  130s
  6286  1047 3022.16549   16  456 1738.40231 3022.16549  73.8%   304  135s
H 6447   929                    1782.3543786 1872.95142  5.08%   304  138s
H 6459   876                    1803.2010870 1872.95142  3.87%   303  138s
H 6530   793                    1808.6948929 1827.35599  1.03%   300  138s
* 6586   722              49    1810.4823011 1810.65435  0.01%   298  139s
* 6588   679              49    1810.6543543 1810.65435  0.00%   298  139s

Cutting planes:
  Implied bound: 12
  Projected implied bound: 1
  MIR: 163
  Flow cover: 392
  Zero half: 1
  RLT: 5
  Relax-and-lift: 19

Explored 6589 nodes (2008486 simplex iterations) in 139.19 seconds (304.75 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 1810.65 1810.48 1803.2 ... 1614.31

Optimal solution found (tolerance 1.00e-04)
Best objective 1.810654354342e+03, best bound 1.810654354342e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 139.20s
  Master Objective (UB) = 1810.65, θ = 113730.87
  Upper Bound (UB) = 1810.65

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 113730.87
  [DEBUG]   ✓ Scenario 0: θ = 113730.87 ≤ Q = 113730.87 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 113730.87 ≤ Q = 113730.87 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x75f25665
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x75f25665
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [3e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.476514e+13
Presolve removed 2594 rows and 1889 columns
Presolve time: 0.00s
Presolved: 499 rows, 500 columns, 1406 nonzeros
Found heuristic solution: objective 8333962.5318
Variable types: 336 continuous, 164 integer (164 binary)

Root relaxation: objective -1.210163e+05, 265 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -121016.26    0  130 8333962.53 -121016.26   101%     -    0s
H    0     0                    -82770.58284 -121016.26  46.2%     -    0s
H    0     0                    -83142.05357 -121016.26  45.6%     -    0s
H    0     0                    -98275.70598 -121016.26  23.1%     -    0s
H    0     0                    -98366.59773 -121016.26  23.0%     -    0s
H    0     0                    -103875.9533 -121016.26  16.5%     -    0s
H    0     0                    -105538.9488 -107775.04  2.12%     -    0s
H    0     0                    -106280.1586 -107775.04  1.41%     -    0s
     0     0 -107775.04    0   60 -106280.16 -107775.04  1.41%     -    0s
H    0     0                    -106824.2449 -107686.67  0.81%     -    0s
     0     0 -107509.29    0   58 -106824.24 -107509.29  0.64%     -    0s
     0     0 -107197.28    0   47 -106824.24 -107197.28  0.35%     -    0s
     0     0 -107174.38    0   34 -106824.24 -107174.38  0.33%     -    0s
     0     0 -107170.04    0   33 -106824.24 -107170.04  0.32%     -    0s
     0     0 -107058.20    0   28 -106824.24 -107058.20  0.22%     -    0s
     0     0 -107028.50    0   20 -106824.24 -107028.50  0.19%     -    0s
     0     0 -107011.47    0   20 -106824.24 -107011.47  0.18%     -    0s
     0     0 -106987.83    0   20 -106824.24 -106987.83  0.15%     -    0s
     0     0 -106950.82    0   19 -106824.24 -106950.82  0.12%     -    0s
     0     0 -106920.38    0    9 -106824.24 -106920.38  0.09%     -    0s
     0     0 -106909.80    0   15 -106824.24 -106909.80  0.08%     -    0s
     0     0 -106906.42    0   15 -106824.24 -106906.42  0.08%     -    0s
     0     0 -106879.23    0    4 -106824.24 -106879.23  0.05%     -    0s
     0     0 -106879.23    0    8 -106824.24 -106879.23  0.05%     -    0s
H    0     0                    -106872.8525 -106879.23  0.01%     -    0s

Explored 1 nodes (642 simplex iterations) in 0.05 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -106873 -106824 -106722 ... 8.33396e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.068728524584e+05, best bound -1.068792270092e+05, gap 0.0060%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 88666.93
  Scenario: 28 demand increases, 32 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -106872.85
  [DEBUG]   S×d_nominal = 195539.78
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 195539.78 + -106872.85 = 88666.93
  [DEBUG]   Current θ from Master = 113730.87
  [DEBUG]   ⚠️  Z_SP ≤ θ by 25063.95 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -23253.29
  Lower Bound (LB) = -5399.73
  Gap (UB-LB) = 7210.3843, Absolute Gap = 7210.3843, Relative Gap = 3.982198
  Not converged yet (gap = 7210.38 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 28 increases, 32 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135230 nonzeros
Model fingerprint: 0xf43b7c07
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -23253.3 (0.02s)
Loaded MIP start from previous solve with objective -23253.3

Presolve removed 20664 rows and 8394 columns
Presolve time: 0.41s
Presolved: 26589 rows, 12586 columns, 163679 nonzeros
Variable types: 10327 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   43380    1.3626313e+04   0.000000e+00   3.525252e+06      5s
Concurrent spin time: 0.00s

Solved with dual simplex

Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   19741    1.4436563e+04   0.000000e+00   0.000000e+00      7s

Root relaxation: objective 1.443656e+04, 19741 iterations, 6.14 seconds (11.63 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 14436.5633    0  190 -23253.295 14436.5633   162%     -    6s
H    0     0                    -17659.90134 14436.5633   182%     -    6s
H    0     0                    -15546.97474 14436.5633   193%     -    7s
H    0     0                    -11410.49122 14436.5633   227%     -    7s
H    0     0                    -10712.05317 14436.5633   235%     -    7s
H    0     0                    -10290.77251 14436.5633   240%     -    7s
H    0     0                    -9133.666896 14436.5633   258%     -    7s
     0     0 11065.4526    0  403 -9133.6669 11065.4526   221%     -    9s
H    0     0                    -8819.753851 11063.1852   225%     -    9s
H    0     0                    -8552.601217 11063.1852   229%     -    9s
     0     0 10967.4114    0  425 -8552.6012 10967.4114   228%     -   10s
     0     0 10963.6848    0  425 -8552.6012 10963.6848   228%     -   10s
     0     0 10877.7523    0  430 -8552.6012 10877.7523   227%     -   10s
     0     0 10877.5195    0  433 -8552.6012 10877.5195   227%     -   10s
     0     0 9214.46042    0  409 -8552.6012 9214.46042   208%     -   13s
H    0     0                    -8541.627697 9212.67985   208%     -   13s
     0     0 9058.31275    0  419 -8541.6277 9058.31275   206%     -   14s
     0     0 8966.59746    0  413 -8541.6277 8966.59746   205%     -   14s
     0     0 8948.80121    0  411 -8541.6277 8948.80121   205%     -   14s
     0     0 8920.93821    0  409 -8541.6277 8920.93821   204%     -   14s
     0     0 8910.47424    0  415 -8541.6277 8910.47424   204%     -   14s
     0     0 8909.53989    0  420 -8541.6277 8909.53989   204%     -   15s
     0     0 8909.48339    0  420 -8541.6277 8909.48339   204%     -   15s
     0     0 8076.42782    0  405 -8541.6277 8076.42782   195%     -   17s
H    0     0                    -7029.285004 8076.29279   215%     -   18s
H    0     0                    -5104.176324 8076.29279   258%     -   18s
H    0     0                    -5020.051154 8076.29279   261%     -   18s
     0     0 7791.74303    0  501 -5020.0512 7791.74303   255%     -   19s
     0     0 7673.07454    0  380 -5020.0512 7673.07454   253%     -   19s
     0     0 7656.55283    0  493 -5020.0512 7656.55283   253%     -   20s
     0     0 7610.92105    0  398 -5020.0512 7610.92105   252%     -   21s
     0     0 7599.14101    0  490 -5020.0512 7599.14101   251%     -   21s
     0     0 7593.58895    0  495 -5020.0512 7593.58895   251%     -   22s
     0     0 7593.43932    0  491 -5020.0512 7593.43932   251%     -   22s
     0     0 7077.03393    0  503 -5020.0512 7077.03393   241%     -   25s
H    0     0                    -5002.881795 7076.97564   241%     -   25s
     0     0 6735.95312    0  490 -5002.8818 6735.95312   235%     -   26s
     0     0 6635.85195    0  402 -5002.8818 6635.85195   233%     -   27s
     0     0 6566.89842    0  506 -5002.8818 6566.89842   231%     -   27s
     0     0 6517.76239    0  565 -5002.8818 6517.76239   230%     -   28s
     0     0 6482.98304    0  411 -5002.8818 6482.98304   230%     -   29s
     0     0 6470.50242    0  506 -5002.8818 6470.50242   229%     -   29s
     0     0 6465.63420    0  510 -5002.8818 6465.63420   229%     -   29s
     0     0 6463.96593    0  428 -5002.8818 6463.96593   229%     -   29s
     0     0 6463.28564    0  430 -5002.8818 6463.28564   229%     -   29s
H    0     0                    -4298.270711 6275.91683   246%     -   31s
H    0     0                    -4262.033122 6275.91683   247%     -   31s
     0     0 6275.91683    0  514 -4262.0331 6275.91683   247%     -   31s
H    0     0                    -4219.434853 6275.77280   249%     -   31s
     0     0 6206.74604    0  546 -4219.4349 6206.74604   247%     -   32s
     0     0 6176.10070    0  532 -4219.4349 6176.10070   246%     -   32s
     0     0 6172.19325    0  527 -4219.4349 6172.19325   246%     -   33s
     0     0 6171.91961    0  531 -4219.4349 6171.91961   246%     -   33s
     0     0 6056.06610    0  523 -4219.4349 6056.06610   244%     -   34s
H    0     0                    -4205.166940 6055.70497   244%     -   35s
H    0     0                    -3829.157146 6055.70497   258%     -   35s
     0     0 6039.14922    0  532 -3829.1571 6039.14922   258%     -   35s
     0     0 6027.32720    0  533 -3829.1571 6027.32720   257%     -   36s
     0     0 6013.14844    0  533 -3829.1571 6013.14844   257%     -   36s
     0     0 6011.20005    0  543 -3829.1571 6011.20005   257%     -   36s
     0     0 6010.98560    0  548 -3829.1571 6010.98560   257%     -   36s
     0     0 5971.96790    0  530 -3829.1571 5971.96790   256%     -   38s
     0     0 5943.60119    0  546 -3829.1571 5943.60119   255%     -   38s
     0     0 5939.61974    0  550 -3829.1571 5939.61974   255%     -   38s
     0     0 5937.92915    0  547 -3829.1571 5937.92915   255%     -   39s
     0     0 5937.56856    0  545 -3829.1571 5937.56856   255%     -   39s
     0     0 5912.93031    0  610 -3829.1571 5912.93031   254%     -   40s
H    0     0                    -3829.083948 5912.91364   254%     -   40s
H    0     0                    -3829.075352 5912.91364   254%     -   40s
     0     0 5908.95036    0  612 -3829.0754 5908.95036   254%     -   40s
     0     0 5907.24589    0  617 -3829.0754 5907.24589   254%     -   40s
     0     0 5906.37885    0  613 -3829.0754 5906.37885   254%     -   41s
H    0     0                    -3750.938269 5896.86049   257%     -   41s
     0     0 5896.86049    0  610 -3750.9383 5896.86049   257%     -   41s
H    0     0                    -3749.716706 5896.77344   257%     -   41s
H    0     0                    -3739.502281 5896.77344   258%     -   41s
     0     0 5892.89652    0  609 -3739.5023 5892.89652   258%     -   42s
     0     0 5888.57480    0  557 -3739.5023 5888.57480   257%     -   42s
     0     0 5886.13920    0  616 -3739.5023 5886.13920   257%     -   42s
     0     0 5885.02451    0  620 -3739.5023 5885.02451   257%     -   42s
     0     0 5853.25498    0  619 -3739.5023 5853.25498   257%     -   44s
     0     0 5845.72009    0  618 -3739.5023 5845.72009   256%     -   44s
     0     0 5839.60493    0  623 -3739.5023 5839.60493   256%     -   44s
     0     0 5837.51771    0  626 -3739.5023 5837.51771   256%     -   45s
     0     0 5836.91768    0  570 -3739.5023 5836.91768   256%     -   45s
     0     0 5824.81506    0  634 -3739.5023 5824.81506   256%     -   46s
     0     0 5822.40090    0  581 -3739.5023 5822.40090   256%     -   46s
     0     0 5820.97460    0  640 -3739.5023 5820.97460   256%     -   46s
     0     0 5820.46652    0  641 -3739.5023 5820.46652   256%     -   46s
     0     0 5817.52679    0  578 -3739.5023 5817.52679   256%     -   47s
H    0     0                    -3731.971858 5817.31949   256%     -   48s
H    0     0                    -3727.253062 5817.31949   256%     -   48s
     0     0 5816.91575    0  587 -3727.2531 5816.91575   256%     -   48s
     0     0 5808.81239    0  577 -3727.2531 5808.81239   256%     -   48s
     0     0 5802.99056    0  583 -3727.2531 5802.99056   256%     -   49s
     0     0 5800.78927    0  648 -3727.2531 5800.78927   256%     -   49s
     0     0 5800.68636    0  648 -3727.2531 5800.68636   256%     -   49s
     0     0 5793.88537    0  576 -3727.2531 5793.88537   255%     -   50s
     0     0 5791.80916    0  579 -3727.2531 5791.80916   255%     -   50s
     0     0 5791.45104    0  589 -3727.2531 5791.45104   255%     -   50s
     0     0 5789.10710    0  587 -3727.2531 5789.10710   255%     -   51s
     0     0 5789.05912    0  588 -3727.2531 5789.05912   255%     -   51s
     0     0 5787.48930    0  590 -3727.2531 5787.48930   255%     -   51s
     0     0 5787.27844    0  587 -3727.2531 5787.27844   255%     -   52s
     0     0 5785.46127    0  590 -3727.2531 5785.46127   255%     -   52s
     0     0 5785.24265    0  590 -3727.2531 5785.24265   255%     -   53s
     0     2 5785.24265    0  590 -3727.2531 5785.24265   255%     -   61s
     7    16 5463.83098    3  582 -3727.2531 5636.95483   251%  1627   67s
    31    52 4923.56122    5  604 -3727.2531 5191.41398   239%  3187   72s
H   53    49                    1313.9476680 5090.67826   287%  2452   72s
    61    62 4798.74229    6  611 1313.94767 5090.67826   287%  2367   75s
H   63    62                    1345.6954399 5090.67826   278%  2327   75s
H   93    93                    1347.0366994 5078.09442   277%  1850   77s
H  114    93                    1402.5368536 5058.05871   261%  1800   77s
   176   119 4711.97127    9  568 1402.53685 5058.05871   261%  1446   80s
H  329   131                    1405.2130695 5011.67471   257%  1276   84s
   364   155     cutoff   11      1405.21307 5011.67471   257%  1239   86s
H  368   155                    1417.1623459 5011.67471   254%  1237   86s
   494   158 3697.04833   13  600 1417.16235 4802.29129   239%  1214   91s
   638   168 3133.66489   15  536 1417.16235 4724.64902   233%  1177   96s
   761   227 3023.60444   16  533 1417.16235 4714.05921   233%  1158  101s
   877   270 2270.19614   18  516 1417.16235 4714.05921   233%  1169  107s
  1013   331 2065.18089   19  432 1417.16235 4675.91264   230%  1171  111s
  1182   422     cutoff   20      1417.16235 4502.39537   218%  1145  116s
  1400   454 2919.32615   24  170 1417.16235 4316.20731   205%  1072  121s
  1628   481     cutoff   12      1417.16235 4276.85813   202%  1041  126s
  1860   494 infeasible   32      1417.16235 4244.22519   199%  1014  132s
  2127   510 1439.04187   15  216 1417.16235 4142.29595   192%   979  137s
H 2179   510                    1423.2886839 4142.29595   191%   971  137s
  2414   540 2266.18259   24  199 1423.28868 4142.29595   191%   940  142s
  2567   488 1497.65417   28  229 1423.28868 3744.88860   163%   928  145s
  2926   370 2595.12792   25  188 1423.28868 3691.06436   159%   891  150s
  3862   101     cutoff   34      1423.28868 2264.28126  59.1%   752  155s
H 4059   101                    1438.5823055 1979.94351  37.6%   719  155s
H 4143   101                    1440.8931999 1979.94351  37.4%   705  155s
H 4495    96                    1440.9893791 1954.02854  35.6%   655  156s
H 4745   238                    1441.5881835 1526.21969  5.87%   622  157s

Cutting planes:
  Implied bound: 11
  MIR: 262
  Flow cover: 764
  Zero half: 8
  RLT: 11
  Relax-and-lift: 34

Explored 7184 nodes (3106626 simplex iterations) in 158.96 seconds (409.82 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 1441.59 1440.99 1440.89 ... 1345.7

Optimal solution found (tolerance 1.00e-04)
Best objective 1.441588183489e+03, best bound 1.441588183489e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 158.97s
  Master Objective (UB) = 1441.59, θ = 113386.24
  Upper Bound (UB) = 1441.59

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 113386.24
  [DEBUG]   ✓ Scenario 0: θ = 113386.24 ≤ Q = 113386.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 113386.24 ≤ Q = 113386.24 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 113386.24 ≤ Q = 113386.24 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x35d41b50
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xca2be4b0
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.472749e+13
Presolve removed 2594 rows and 1889 columns
Presolve time: 0.00s
Presolved: 499 rows, 500 columns, 1406 nonzeros
Found heuristic solution: objective 8285889.7621
Variable types: 336 continuous, 164 integer (164 binary)

Root relaxation: objective -1.163262e+05, 269 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -116326.21    0  130 8285889.76 -116326.21   101%     -    0s
H    0     0                    -74318.91201 -116326.21  56.5%     -    0s
H    0     0                    -77263.06781 -116326.21  50.6%     -    0s
H    0     0                    -89882.29795 -116326.21  29.4%     -    0s
H    0     0                    -97130.13752 -116326.21  19.8%     -    0s
H    0     0                    -98178.77210 -106866.55  8.85%     -    0s
H    0     0                    -98589.07263 -106866.55  8.40%     -    0s
H    0     0                    -104285.2796 -106866.55  2.48%     -    0s
     0     0 -106866.55    0  121 -104285.28 -106866.55  2.48%     -    0s
H    0     0                    -104825.1773 -106650.13  1.74%     -    0s
     0     0 -106650.13    0  121 -104825.18 -106650.13  1.74%     -    0s
     0     0 -106268.72    0  108 -104825.18 -106268.72  1.38%     -    0s
H    0     0                    -105142.2346 -106169.71  0.98%     -    0s
     0     0 -105981.50    0   77 -105142.23 -105981.50  0.80%     -    0s
     0     0 -105955.14    0   86 -105142.23 -105955.14  0.77%     -    0s
     0     0 -105948.23    0   86 -105142.23 -105948.23  0.77%     -    0s
H    0     0                    -105148.8626 -105948.23  0.76%     -    0s
     0     0 -105587.22    0   52 -105148.86 -105587.22  0.42%     -    0s
     0     0 -105499.93    0   64 -105148.86 -105499.93  0.33%     -    0s
     0     0 -105475.26    0   30 -105148.86 -105475.26  0.31%     -    0s
     0     0 -105475.17    0   29 -105148.86 -105475.17  0.31%     -    0s
     0     0 -105458.00    0   55 -105148.86 -105458.00  0.29%     -    0s
     0     0 -105457.23    0   55 -105148.86 -105457.23  0.29%     -    0s
     0     0 -105338.53    0   23 -105148.86 -105338.53  0.18%     -    0s
     0     0 -105292.52    0   21 -105148.86 -105292.52  0.14%     -    0s
     0     0 -105291.87    0   23 -105148.86 -105291.87  0.14%     -    0s
     0     0 -105230.50    0   13 -105148.86 -105230.50  0.08%     -    0s
     0     0 -105218.70    0   11 -105148.86 -105218.70  0.07%     -    0s
     0     0 -105168.82    0    3 -105148.86 -105168.82  0.02%     -    0s
     0     0 -105163.69    0    2 -105148.86 -105163.69  0.01%     -    0s
H    0     0                    -105149.1544 -105163.69  0.01%     -    0s
     0     0 -105163.69    0    3 -105149.15 -105163.69  0.01%     -    0s
H    0     0                    -105160.6560 -105163.69  0.00%     -    0s

Cutting planes:
  Gomory: 6
  Implied bound: 4
  MIR: 1
  Flow cover: 5
  Relax-and-lift: 2

Explored 1 nodes (973 simplex iterations) in 0.07 seconds (0.06 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -105161 -105149 -105149 ... -89882.3
No other solutions better than -105161

Optimal solution found (tolerance 1.00e-04)
Best objective -1.051606559507e+05, best bound -1.051606559507e+05, gap 0.0000%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 90311.68
  Scenario: 60 demand increases, 0 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -105160.66
  [DEBUG]   S×d_nominal = 195472.34
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 195472.34 + -105160.66 = 90311.68
  [DEBUG]   Current θ from Master = 113386.24
  [DEBUG]   ⚠️  Z_SP ≤ θ by 23074.56 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -21632.97
  Lower Bound (LB) = -5399.73
  Gap (UB-LB) = 6841.3181, Absolute Gap = 6841.3181, Relative Gap = 4.745681
  Not converged yet (gap = 6841.32 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 60 increases, 0 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178467 nonzeros
Model fingerprint: 0x62c34e12
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -21633 (0.02s)
Loaded MIP start from previous solve with objective -21633

Presolve removed 27532 rows and 11182 columns
Presolve time: 0.55s
Presolved: 35011 rows, 16038 columns, 216459 nonzeros
Variable types: 13779 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 35011 rows, 16038 columns, 216459 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   41493    4.9765155e+02   0.000000e+00   2.676242e+06      5s
   54431    1.2141498e+04   0.000000e+00   1.354550e+05     10s
Concurrent spin time: 0.40s

Solved with dual simplex

Root relaxation: objective 1.250047e+04, 29906 iterations, 9.60 seconds (19.09 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 12500.4674    0  362 -21632.969 12500.4674   158%     -   10s
H    0     0                    -20540.11240 12500.4674   161%     -   10s
H    0     0                    -20505.55656 12500.4674   161%     -   10s
H    0     0                    -7055.536634 12500.4674   277%     -   10s
H    0     0                    -4620.900470 12500.4674   371%     -   10s
H    0     0                    -4265.561058 12500.4674   393%     -   10s
H    0     0                    -4240.288381 8877.57275   309%     -   14s
     0     0 8469.88779    0  412 -4240.2884 8469.88779   300%     -   14s
     0     0 8234.56919    0  418 -4240.2884 8234.56919   294%     -   16s
     0     0 8234.56919    0  435 -4240.2884 8234.56919   294%     -   17s
     0     0 8234.56919    0  437 -4240.2884 8234.56919   294%     -   17s
     0     0 8234.56919    0  437 -4240.2884 8234.56919   294%     -   17s
     0     0 7200.73619    0  400 -4240.2884 7200.73619   270%     -   20s
H    0     0                    -4239.514358 7193.64330   270%     -   20s
H    0     0                    -4219.123971 6816.35057   262%     -   21s
     0     0 6816.35057    0  408 -4219.1240 6816.35057   262%     -   21s
     0     0 6780.51661    0  407 -4219.1240 6780.51661   261%     -   21s
     0     0 6764.74333    0  411 -4219.1240 6764.74333   260%     -   22s
     0     0 6744.87777    0  367 -4219.1240 6744.87777   260%     -   22s
H    0     0                    -4218.349949 6683.35041   258%     -   23s
     0     0 6683.35041    0  412 -4218.3499 6683.35041   258%     -   23s
     0     0 6680.63043    0  410 -4218.3499 6680.63043   258%     -   23s
     0     0 6678.98365    0  425 -4218.3499 6678.98365   258%     -   23s
     0     0 6678.66251    0  426 -4218.3499 6678.66251   258%     -   23s
     0     0 5206.83049    0  422 -4218.3499 5206.83049   223%     -   30s
     0     0 4977.59994    0  403 -4218.3499 4977.59994   218%     -   31s
     0     0 4594.49778    0  494 -4218.3499 4594.49778   209%     -   33s
     0     0 4389.08732    0  463 -4218.3499 4389.08732   204%     -   34s
     0     0 4344.31936    0  509 -4218.3499 4344.31936   203%     -   35s
     0     0 4274.10036    0  515 -4218.3499 4274.10036   201%     -   36s
     0     0 4255.14587    0  510 -4218.3499 4255.14587   201%     -   36s
     0     0 4251.03289    0  509 -4218.3499 4251.03289   201%     -   36s
     0     0 4250.97076    0  509 -4218.3499 4250.97076   201%     -   36s
     0     0 3726.31768    0  438 -4218.3499 3726.31768   188%     -   39s
     0     0 3610.95418    0  492 -4218.3499 3610.95418   186%     -   41s
     0     0 3562.84601    0  500 -4218.3499 3562.84601   184%     -   41s
     0     0 3450.50048    0  436 -4218.3499 3450.50048   182%     -   42s
     0     0 3423.06760    0  517 -4218.3499 3423.06760   181%     -   42s
     0     0 3415.26869    0  520 -4218.3499 3415.26869   181%     -   42s
     0     0 3409.04367    0  518 -4218.3499 3409.04367   181%     -   42s
     0     0 3409.02148    0  518 -4218.3499 3409.02148   181%     -   43s
     0     0 3289.09541    0  518 -4218.3499 3289.09541   178%     -   44s
     0     0 3184.25240    0  529 -4218.3499 3184.25240   175%     -   45s
     0     0 3176.00083    0  526 -4218.3499 3176.00083   175%     -   45s
     0     0 3164.95019    0  523 -4218.3499 3164.95019   175%     -   46s
     0     0 3159.46209    0  527 -4218.3499 3159.46209   175%     -   46s
     0     0 3157.19355    0  532 -4218.3499 3157.19355   175%     -   46s
     0     0 3156.50184    0  533 -4218.3499 3156.50184   175%     -   46s
     0     0 3105.88507    0  546 -4218.3499 3105.88507   174%     -   47s
     0     0 3098.78595    0  559 -4218.3499 3098.78595   173%     -   49s
     0     0 3098.12703    0  556 -4218.3499 3098.12703   173%     -   49s
     0     0 2995.78543    0  528 -4218.3499 2995.78543   171%     -   50s
     0     0 2947.58307    0  539 -4218.3499 2947.58307   170%     -   51s
     0     0 2943.22974    0  537 -4218.3499 2943.22974   170%     -   51s
     0     0 2940.53147    0  550 -4218.3499 2940.53147   170%     -   51s
     0     0 2940.08662    0  548 -4218.3499 2940.08662   170%     -   52s
     0     0 2899.09745    0  542 -4218.3499 2899.09745   169%     -   53s
     0     0 2889.20720    0  548 -4218.3499 2889.20720   168%     -   53s
     0     0 2887.42235    0  552 -4218.3499 2887.42235   168%     -   53s
     0     0 2874.37836    0  553 -4218.3499 2874.37836   168%     -   54s
     0     0 2872.43128    0  549 -4218.3499 2872.43128   168%     -   54s
     0     0 2870.76106    0  554 -4218.3499 2870.76106   168%     -   54s
     0     0 2870.66702    0  554 -4218.3499 2870.66702   168%     -   54s
     0     0 2859.49209    0  549 -4218.3499 2859.49209   168%     -   55s
     0     0 2857.35568    0  560 -4218.3499 2857.35568   168%     -   55s
     0     0 2829.83211    0  559 -4218.3499 2829.83211   167%     -   56s
     0     0 2818.90585    0  483 -4218.3499 2818.90585   167%     -   56s
     0     0 2817.54712    0  556 -4218.3499 2817.54712   167%     -   56s
     0     0 2817.02906    0  554 -4218.3499 2817.02906   167%     -   56s
     0     0 2806.60724    0  550 -4218.3499 2806.60724   167%     -   57s
     0     0 2806.35657    0  560 -4218.3499 2806.35657   167%     -   57s
     0     0 2798.35410    0  555 -4218.3499 2798.35410   166%     -   58s
     0     0 2795.68437    0  562 -4218.3499 2795.68437   166%     -   60s
     0     0 2795.32557    0  564 -4218.3499 2795.32557   166%     -   61s
     0     0 2789.57664    0  562 -4218.3499 2789.57664   166%     -   61s
     0     0 2788.50356    0  555 -4218.3499 2788.50356   166%     -   62s
     0     0 2787.09389    0  551 -4218.3499 2787.09389   166%     -   62s
     0     0 2786.55715    0  551 -4218.3499 2786.55715   166%     -   63s
H    0     0                    -4107.182620 2786.42960   168%     -   78s
H    0     0                    -4036.862156 2786.42960   169%     -   78s
H    0     0                    -4006.573521 2786.42960   170%     -   78s
     0     2 2786.42960    0  551 -4006.5735 2786.42960   170%     -   78s
     3     8 2657.85227    2  586 -4006.5735 2685.31149   167%   949   80s
    15    32 2097.09893    4  545 -4006.5735 2377.23777   159%  1951   85s
    63    90 1811.68007    6  543 -4006.5735 1911.24151   148%  2330   91s
H   66    90                    -3986.527436 1911.24151   148%  2301   91s
H   70    90                    -3982.934241 1911.24151   148%  2257   91s
H   87    90                    -3972.825800 1911.24151   148%  2100   91s
   154   227 1453.06339    8  607 -3972.8258 1811.39171   146%  1764   95s
   306   346 1355.41543    9  580 -3972.8258 1771.12574   145%  1327  104s
   396   389  875.13028   11  538 -3972.8258 1771.12574   145%  1228  106s
   454   441 -1827.2052   11  588 -3972.8258 1771.12574   145%  1218  110s
   530   484  779.38716   12  528 -3972.8258 1771.12574   145%  1187  115s
   658   565  699.39514   13  578 -3972.8258 1625.03674   141%  1199  123s
   690   601 -2715.0024   13  338 -3972.8258 1625.03674   141%  1192  126s
   784   664  216.66691   14  621 -3972.8258 1590.97067   140%  1189  131s
   836   691   32.77712   15  621 -3972.8258 1551.90367   139%  1172  136s
   918   773  -51.29191   16  609 -3972.8258 1551.90367   139%  1224  142s
   983   828 -1144.0409   17  596 -3972.8258 1551.90367   139%  1214  146s
  1159   918 -3182.9671   18  568 -3972.8258 1500.01705   138%  1157  152s
  1220   980 -2629.2809   19  504 -3972.8258 1500.01705   138%  1148  155s
  1407  1080 infeasible   22      -3972.8258 1463.59278   137%  1091  161s
  1544  1179     cutoff   24      -3972.8258 1463.59278   137%  1050  166s
  1752  1316 -2671.7986   14  391 -3972.8258 1463.59278   137%   985  171s
  1908  1401 -3387.1765   19  375 -3972.8258 1463.59278   137%   939  175s
  2080  1480 -3222.5234   18  145 -3972.8258 1345.47681   134%   901  180s
  2381  1593 -3134.6116    9  240 -3972.8258 1318.99146   133%   863  187s
  2505  1686 -3607.8365   11  244 -3972.8258 1310.84833   133%   862  191s
  2652  1811  298.75909   10  543 -3972.8258 1310.84833   133%   851  195s
  3044  2065 -880.16597   18  578 -3972.8258 1280.44560   132%   816  203s
  3271  2214 -1643.9026   21  527 -3972.8258 1280.44560   132%   800  208s
  3547  2317 -2260.8638   24  215 -3972.8258 1280.44560   132%   777  215s
  4001  2470 -3833.0742   39  231 -3972.8258 1077.53820   127%   760  224s
  4194  2567 -1912.8365    9  373 -3972.8258  887.63243   122%   760  229s
  4388  2670 -2903.3542   16  365 -3972.8258  887.63243   122%   763  234s
  4651  2815 -1874.1444   12  421 -3972.8258  871.67296   122%   758  239s
  4939  2816 -370.75651   21  551 -3972.8258  871.67296   122%   749  258s
  4941  2817 -490.06981    8  362 -3972.8258  871.67296   122%   749  267s
  4942  2818 -3561.7026   34  456 -3972.8258  871.67296   122%   749  273s
  4943  2819 -3055.5659   18  548 -3972.8258  871.67296   122%   748  277s
  4944  2819 -1994.1038   16  523 -3972.8258  871.67296   122%   748  280s
  4948  2822 -2556.3557   32  555 -3972.8258  871.67296   122%   748  285s
  4954  2826 -2986.2250   14  594 -3972.8258  871.67296   122%   747  290s
  4956  2827 -2349.7217   36  595 -3972.8258  871.67296   122%   746  295s
  4961  2831 -1267.4810   23  517 -3972.8258  871.67296   122%   746  300s
  4965  2833 -2929.3413   22  598 -3972.8258  871.67296   122%   745  305s
  4968  2835 -2313.6800   38  547 -3972.8258  871.67296   122%   745  310s
  4970  2837 -2896.1750   18  552 -3972.8258  871.67296   122%   744  315s
  4973  2839  197.24232   12  565 -3972.8258  871.67296   122%   744  321s
  4975  2840 -1149.6757   27  567 -3972.8258  871.67296   122%   744  325s
  4978  2842 -133.57848   16  560 -3972.8258  871.67296   122%   743  338s
  4979  2843 -1670.7964   22  560 -3972.8258  871.67296   122%   743  344s
  4980  2846  871.67296   11  533 -3972.8258  871.67296   122%   762  352s
  4982  2850  871.67296   12  511 -3972.8258  871.67296   122%   763  356s
  4986  2854  871.67296   13  508 -3972.8258  871.67296   122%   765  361s
  4994  2860  871.67296   14  530 -3972.8258  871.67296   122%   767  365s
  5008  2870  871.67296   15  527 -3972.8258  871.67296   122%   780  372s
  5029  2891  871.67296   16  527 -3972.8258  871.67296   122%   785  380s
  5061  2912 -637.59732   17  519 -3972.8258  871.67296   122%   810  386s
  5100  2924 -741.85958   18  528 -3972.8258  871.67296   122%   823  391s
  5144  2931 -2951.2282   18  534 -3972.8258  871.67296   122%   843  396s
  5226  2944 -1477.3415   19  396 -3972.8258  871.67296   122%   854  401s
  5360  2968 -1719.9200   20  424 -3972.8258  742.68727   119%   885  408s
  5450  2964     cutoff   20      -3972.8258  603.65997   115%   890  412s
  5522  2961 -1812.7212   22  474 -3972.8258  447.30738   111%   897  418s
  5602  2947 infeasible   22      -3972.8258  352.05376   109%   903  423s
  5646  2946     cutoff   23      -3972.8258  352.05376   109%   911  425s
  5696  2946 -2272.3158   24  587 -3972.8258  352.05376   109%   915  430s
  5811  2938 -2216.6777   26  542 -3972.8258 -134.05890  96.6%   923  436s
  5888  2936     cutoff   26      -3972.8258 -134.05890  96.6%   925  441s
  6029  2901 -2622.7439   29  382 -3972.8258 -134.05890  96.6%   932  449s
  6117  2863     cutoff   29      -3972.8258 -259.08772  93.5%   937  452s
  6208  2847 -2725.9364   31  377 -3972.8258 -288.38337  92.7%   946  456s
  6284  2845     cutoff   32      -3972.8258 -288.38337  92.7%   954  461s
  6384  2821     cutoff   36      -3972.8258 -288.38337  92.7%   957  465s
  6617  2757 -3424.8776   24  380 -3972.8258 -510.21893  87.2%   971  474s
  6740  2711 -3739.9685   29  356 -3972.8258 -1284.3820  67.7%   975  479s
  6836  2693 -3863.6493   35  261 -3972.8258 -1285.8096  67.6%   980  483s
  6986  2634 -1778.9150   20  500 -3972.8258 -1285.8096  67.6%   980  488s
  7146  2554 -1956.4071   21  522 -3972.8258 -1387.9658  65.1%   981  493s
  7308  2473 -2312.2440   23  437 -3972.8258 -1387.9658  65.1%   986  498s
  7481  2388 -2601.8965   26  425 -3972.8258 -1387.9658  65.1%   988  504s
  7703  2282     cutoff   28      -3972.8258 -1453.1776  63.4%   983  510s
  7919  2135 -3631.5628   25  377 -3972.8258 -2061.5775  48.1%   977  515s
  8348  1788     cutoff   31      -3972.8258 -2433.2146  38.8%   962  523s
  8568  1650     cutoff   27      -3972.8258 -2578.1615  35.1%   949  527s

Cutting planes:
  Implied bound: 16
  MIR: 302
  Flow cover: 905
  Zero half: 1
  RLT: 16
  Relax-and-lift: 59

Explored 8693 nodes (8288520 simplex iterations) in 529.37 seconds (1391.20 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -3972.83 -3982.93 -3986.53 ... -4240.29
No other solutions better than -3972.83

Optimal solution found (tolerance 1.00e-04)
Best objective -3.972825800449e+03, best bound -3.972825800449e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 529.37s
  Master Objective (UB) = -3972.83, θ = 115916.16
  Upper Bound (UB) = -3972.83

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 115916.16
  [DEBUG]   ✓ Scenario 0: θ = 115916.16 ≤ Q = 115916.16 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 115916.16 ≤ Q = 115916.16 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 115916.16 ≤ Q = 115916.16 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 115916.16 ≤ Q = 115916.16 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x148450b3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x148450b3
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.270861e+13
Presolve removed 2592 rows and 1886 columns
Presolve time: 0.00s
Presolved: 501 rows, 503 columns, 1412 nonzeros
Found heuristic solution: objective 6980810.8539
Variable types: 339 continuous, 164 integer (164 binary)

Root relaxation: objective -1.162976e+05, 256 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -116297.61    0  121 6980810.85 -116297.61   102%     -    0s
H    0     0                    -81024.48231 -116297.61  43.5%     -    0s
H    0     0                    -82656.36872 -116297.61  40.7%     -    0s
     0     0 -98925.447    0  103 -82656.369 -98925.447  19.7%     -    0s
H    0     0                    -94867.18314 -98888.468  4.24%     -    0s
H    0     0                    -96584.82362 -98888.468  2.39%     -    0s
     0     0 -98639.187    0  104 -96584.824 -98639.187  2.13%     -    0s
     0     0 -98584.777    0  102 -96584.824 -98584.777  2.07%     -    0s
     0     0 -98260.483    0  105 -96584.824 -98260.483  1.73%     -    0s
H    0     0                    -96885.49885 -98175.513  1.33%     -    0s
     0     0 -98175.513    0   97 -96885.499 -98175.513  1.33%     -    0s
     0     0 -98169.697    0  102 -96885.499 -98169.697  1.33%     -    0s
H    0     0                    -96919.06753 -98169.697  1.29%     -    0s
     0     0 -97981.323    0   85 -96919.068 -97981.323  1.10%     -    0s
H    0     0                    -96942.14671 -97977.996  1.07%     -    0s
     0     0 -97942.891    0   98 -96942.147 -97942.891  1.03%     -    0s
     0     0 -97869.798    0   67 -96942.147 -97869.798  0.96%     -    0s
     0     0 -97859.960    0   81 -96942.147 -97859.960  0.95%     -    0s
     0     0 -97656.986    0   74 -96942.147 -97656.986  0.74%     -    0s
     0     0 -97648.842    0   81 -96942.147 -97648.842  0.73%     -    0s
     0     0 -97578.336    0   62 -96942.147 -97578.336  0.66%     -    0s
     0     0 -97549.974    0   59 -96942.147 -97549.974  0.63%     -    0s
     0     0 -97549.370    0   59 -96942.147 -97549.370  0.63%     -    0s
     0     0 -97466.758    0   58 -96942.147 -97466.758  0.54%     -    0s
     0     0 -97457.345    0   58 -96942.147 -97457.345  0.53%     -    0s
     0     2 -97457.345    0   58 -96942.147 -97457.345  0.53%     -    0s
H    3     7                    -96956.51236 -97451.922  0.51%   9.3    0s
H   33    19                    -97007.00361 -97231.503  0.23%  22.7    0s
H   34    19                    -97027.57843 -97231.503  0.21%  22.1    0s
H   35    17                    -97093.41186 -97231.503  0.14%  21.7    0s

Cutting planes:
  Gomory: 24
  Implied bound: 1
  MIR: 140
  Flow cover: 6
  RLT: 70
  Relax-and-lift: 2
  BQP: 2

Explored 82 nodes (1820 simplex iterations) in 0.09 seconds (0.09 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -97093.4 -97027.6 -97007 ... -81024.5
No other solutions better than -97093.4

Optimal solution found (tolerance 1.00e-04)
Best objective -9.709341185717e+04, best bound -9.709341185717e+04, gap 0.0000%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 102630.58
  Scenario: 16 demand increases, 44 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -97093.41
  [DEBUG]   S×d_nominal = 199723.99
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 199723.99 + -97093.41 = 102630.58
  [DEBUG]   Current θ from Master = 115916.16
  [DEBUG]   ⚠️  Z_SP ≤ θ by 13285.58 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -17258.41
  Lower Bound (LB) = -5399.73
  Gap (UB-LB) = 1426.9041, Absolute Gap = 1426.9041, Relative Gap = 0.359166
  Not converged yet (gap = 1426.90 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 16 increases, 44 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221704 nonzeros
Model fingerprint: 0x8eaa74b7
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 34420 rows and 13980 columns
Presolve time: 0.68s
Presolved: 43413 rows, 19480 columns, 269179 nonzeros
Variable types: 17221 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -410141.1274
Found heuristic solution: objective -211458.2747

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 43413 rows, 19480 columns, 269179 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   28722   -3.2998727e+03   0.000000e+00   1.508236e+07      5s
   39605    8.5938290e+03   0.000000e+00   1.115964e+06     10s
Concurrent spin time: 0.40s

Solved with dual simplex

Root relaxation: objective 1.250047e+04, 28602 iterations, 9.72 seconds (19.77 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 12500.4674    0  362 -211458.27 12500.4674   106%     -   10s
H    0     0                    -201986.3795 12500.4674   106%     -   10s
H    0     0                    -24246.51156 12500.4674   152%     -   10s
H    0     0                    -20885.29670 12500.4674   160%     -   10s
H    0     0                    -20505.55656 12500.4674   161%     -   10s
H    0     0                    -5617.695458 12500.4674   323%     -   11s
H    0     0                    -4518.605102 12500.4674   377%     -   11s
H    0     0                    -4265.561058 12500.4674   393%     -   11s
     0     0 8439.87917    0  423 -4265.5611 8439.87917   298%     -   18s
     0     0 8234.09809    0  411 -4265.5611 8234.09809   293%     -   19s
     0     0 8234.09809    0  420 -4265.5611 8234.09809   293%     -   20s
     0     0 8234.09809    0  427 -4265.5611 8234.09809   293%     -   20s
     0     0 8234.09809    0  430 -4265.5611 8234.09809   293%     -   21s
     0     0 8234.09809    0  428 -4265.5611 8234.09809   293%     -   21s
     0     0 8234.09809    0  437 -4265.5611 8234.09809   293%     -   21s
     0     0 8234.09809    0  437 -4265.5611 8234.09809   293%     -   21s
H    0     0                    -4254.587538 7199.28219   269%     -   26s
     0     0 7183.66874    0  394 -4254.5875 7183.66874   269%     -   26s
     0     0 6975.40486    0  425 -4254.5875 6975.40486   264%     -   27s
H    0     0                    -4253.813516 6769.28071   259%     -   30s
     0     0 6769.28071    0  358 -4253.8135 6769.28071   259%     -   30s
     0     0 6700.04070    0  413 -4253.8135 6700.04070   258%     -   31s
     0     0 6694.27233    0  417 -4253.8135 6694.27233   257%     -   31s
     0     0 6693.22915    0  423 -4253.8135 6693.22915   257%     -   31s
     0     0 6692.91007    0  421 -4253.8135 6692.91007   257%     -   32s
     0     0 5298.42892    0  398 -4253.8135 5298.42892   225%     -   41s
     0     0 4954.40230    0  398 -4253.8135 4954.40230   216%     -   44s
     0     0 4871.14023    0  396 -4253.8135 4871.14023   215%     -   45s
     0     0 4834.87540    0  398 -4253.8135 4834.87540   214%     -   46s
     0     0 4829.19210    0  413 -4253.8135 4829.19210   214%     -   46s
     0     0 4683.90536    0  399 -4253.8135 4683.90536   210%     -   47s
     0     0 4652.75197    0  412 -4253.8135 4652.75197   209%     -   48s
     0     0 4649.37514    0  418 -4253.8135 4649.37514   209%     -   48s
     0     0 4648.90875    0  420 -4253.8135 4648.90875   209%     -   48s
     0     0 4105.52044    0  527 -4253.8135 4105.52044   197%     -   52s
     0     0 3906.48722    0  524 -4253.8135 3906.48722   192%     -   54s
     0     0 3795.59270    0  511 -4253.8135 3795.59270   189%     -   55s
     0     0 3749.79482    0  510 -4253.8135 3749.79482   188%     -   56s
     0     0 3717.09288    0  517 -4253.8135 3717.09288   187%     -   57s
     0     0 3686.68616    0  522 -4253.8135 3686.68616   187%     -   57s
     0     0 3681.89797    0  534 -4253.8135 3681.89797   187%     -   57s
     0     0 3681.78920    0  533 -4253.8135 3681.78920   187%     -   57s
     0     0 3504.85197    0  533 -4253.8135 3504.85197   182%     -   60s
     0     0 3420.18153    0  538 -4253.8135 3420.18153   180%     -   62s
     0     0 3273.53062    0  520 -4253.8135 3273.53062   177%     -   64s
     0     0 3236.20796    0  511 -4253.8135 3236.20796   176%     -   65s
     0     0 3220.64863    0  528 -4253.8135 3220.64863   176%     -   67s
     0     0 3215.71606    0  522 -4253.8135 3215.71606   176%     -   67s
     0     0 3214.60672    0  525 -4253.8135 3214.60672   176%     -   68s
     0     0 3213.78460    0  541 -4253.8135 3213.78460   176%     -   68s
     0     0 3051.38097    0  526 -4253.8135 3051.38097   172%     -   70s
     0     0 3019.12424    0  539 -4253.8135 3019.12424   171%     -   73s
     0     0 3012.10437    0  552 -4253.8135 3012.10437   171%     -   73s
     0     0 3010.61798    0  557 -4253.8135 3010.61798   171%     -   73s
     0     0 3001.30400    0  544 -4253.8135 3001.30400   171%     -   74s
     0     0 3000.29651    0  554 -4253.8135 3000.29651   171%     -   74s
     0     0 2937.33639    0  545 -4253.8135 2937.33639   169%     -   76s
     0     0 2890.99188    0  597 -4253.8135 2890.99188   168%     -   77s
     0     0 2876.03821    0  541 -4253.8135 2876.03821   168%     -   77s
     0     0 2872.87777    0  595 -4253.8135 2872.87777   168%     -   77s
     0     0 2871.32652    0  603 -4253.8135 2871.32652   168%     -   77s
     0     0 2871.07311    0  600 -4253.8135 2871.07311   167%     -   78s
     0     0 2797.24403    0  543 -4253.8135 2797.24403   166%     -   80s
     0     0 2766.65507    0  605 -4253.8135 2766.65507   165%     -   83s
     0     0 2764.39263    0  601 -4253.8135 2764.39263   165%     -   84s
     0     0 2763.59269    0  608 -4253.8135 2763.59269   165%     -   84s
     0     0 2716.91340    0  567 -4253.8135 2716.91340   164%     -   85s
     0     0 2711.92071    0  567 -4253.8135 2711.92071   164%     -   86s
     0     0 2710.29983    0  566 -4253.8135 2710.29983   164%     -   86s
     0     0 2710.21920    0  572 -4253.8135 2710.21920   164%     -   86s
     0     0 2706.58799    0  570 -4253.8135 2706.58799   164%     -   87s
     0     0 2704.75019    0  578 -4253.8135 2704.75019   164%     -   87s
     0     0 2704.23295    0  578 -4253.8135 2704.23295   164%     -   88s
     0     0 2700.15807    0  578 -4253.8135 2700.15807   163%     -   88s
     0     0 2699.48377    0  570 -4253.8135 2699.48377   163%     -   89s
     0     0 2698.31924    0  622 -4253.8135 2698.31924   163%     -   90s
     0     0 2698.25362    0  622 -4253.8135 2698.25362   163%     -   91s
     0     2 2698.21195    0  622 -4253.8135 2698.21195   163%     -  103s
     3     8 2332.58985    2  615 -4253.8135 2557.02045   160%  1802  108s
     7    16 2253.61247    3  598 -4253.8135 2332.37858   155%  2739  111s
    15    32 2178.63745    4  617 -4253.8135 2252.94889   153%  2334  116s
    31    60 2113.43308    5  618 -4253.8135 2178.53709   151%  4149  120s
    63    92 2034.83238    6  621 -4253.8135 2113.16782   150%  2910  125s
    95   173 2002.37478    7  616 -4253.8135 2030.53782   148%  2515  131s
   237   252 1507.26641   10  551 -4253.8135 2030.53782   148%  1620  139s
   293   294 1938.80572   10  610 -4253.8135 2030.53782   148%  1617  143s
   351   330 1936.29125   11  608 -4253.8135 1990.69704   147%  1660  148s
   411   363 1430.41207   14  542 -4253.8135 1935.62322   146%  1707  152s
   481   399 1206.77926   16  532 -4253.8135 1935.62322   146%  1596  156s
   540   432  870.35855   18  517 -4253.8135 1935.62322   146%  1579  160s
   599   466  626.07795   19  520 -4253.8135 1935.62322   146%  1548  165s
   725   558 -2688.8773   20  528 -4253.8135 1935.62322   146%  1474  173s
   786   588   -3.04143   21  588 -4253.8135 1935.62322   146%  1459  176s
   875   655 -470.70981   23  511 -4253.8135 1682.58818   140%  1428  181s
   976   795 -604.31625   26  498 -4253.8135 1669.61478   139%  1387  189s
  1065   909 -780.85940   28  479 -4253.8135 1669.61478   139%  1330  192s
  1199  1024 -983.66196   31  485 -4253.8135 1608.54138   138%  1238  197s
  1335  1112 -988.63843   32  482 -4253.8135 1596.46688   138%  1177  201s
  1451  1200 -1214.1589   33  494 -4253.8135 1596.46688   138%  1144  207s
  1591  1277 -1363.0160   35  494 -4253.8135 1596.46688   138%  1105  212s
  1748  1323 -3032.9468   39  277 -4253.8135 1569.94698   137%  1072  215s
  1860  1387 -2563.1060   40  237 -4253.8135 1506.61417   135%  1051  221s
  2013  1450 -2873.3268   45  203 -4253.8135 1506.61417   135%  1035  227s
  2151  1488 -3649.1128   56  183 -4253.8135 1466.38156   134%  1024  233s
  2223  1556 -3445.8234    7  200 -4253.8135 1466.38156   134%  1028  239s
  2330  1603     cutoff    8      -4253.8135 1466.38156   134%  1019  245s
  2450  1666 -794.49415   10  288 -4253.8135 1466.22536   134%  1015  252s
  2587  1740 -1230.8449   11  185 -4253.8135 1428.66440   134%  1008  258s
  2722  1791     cutoff   16      -4253.8135 1338.53827   131%  1008  266s
  2871  1878 -2360.2578   18   99 -4253.8135 1305.46309   131%  1004  270s
  3021  1921     cutoff   33      -4253.8135 1253.41409   129%   989  275s
  3157  1993  512.12158   10  390 -4253.8135 1253.41409   129%   987  280s
  3302  2066 -335.80758   15  368 -4253.8135 1226.90246   129%   987  286s
  3467  2195 -1584.7744   21  280 -4253.8135 1226.90246   129%   992  295s
  3660  2285 -3589.5739   35  239 -4253.8135 1226.90246   129%   984  301s
  3938  2340   30.24694   12  383 -4253.8135 1206.41842   128%   972  307s
  4119  2392 -724.91091   15  291 -4253.8135 1048.11229   125%   966  314s
  4292  2486 infeasible   19      -4253.8135 1008.91572   124%   962  323s
  4511  2562 infeasible   23      -4253.8135 1008.91572   124%   959  330s
  4722  2669 -3408.6074   28  186 -4253.8135 1008.91572   124%   964  339s
  5055  2739 -711.75906   14  369 -4253.8135  973.32211   123%   951  347s
  5350  2788 -1765.4795   20  301 -4253.8135  880.08056   121%   948  354s
  5528  2876 -3279.6783   11  498 -4253.8135  856.06908   120%   952  361s
  5756  2877 -1057.9955   23  622 -4253.8135  782.17029   118%   958  387s
  5758  2878 -2289.2876   33  362 -4253.8135  782.17029   118%   958  402s
  5759  2879 -2336.3899   19  441 -4253.8135  782.17029   118%   958  411s
  5760  2880 -781.01642   24  418 -4253.8135  782.17029   118%   957  416s
  5762  2881 -1984.3901   37  442 -4253.8135  782.17029   118%   957  422s
  5763  2882 -729.16775   22  583 -4253.8135  782.17029   118%   957  426s
  5765  2883 -1444.6621   34  582 -4253.8135  782.17029   118%   957  432s
  5767  2884 -1216.5542   22  542 -4253.8135  782.17029   118%   956  436s
  5771  2887 -2475.0918   11  555 -4253.8135  782.17029   118%   956  441s
  5773  2888 -299.39391   18  544 -4253.8135  782.17029   118%   955  445s
  5777  2891 -2422.3732   21  656 -4253.8135  782.17029   118%   955  452s
  5780  2893 -1831.2103    6  561 -4253.8135  782.17029   118%   954  457s
  5782  2894  108.50272   17  543 -4253.8135  782.17029   118%   954  461s
  5784  2896 -106.20423   14  550 -4253.8135  782.17029   118%   953  466s
  5786  2897 -4014.5260   18  560 -4253.8135  782.17029   118%   953  470s
  5788  2898 -2199.6435   29  556 -4253.8135  782.17029   118%   953  475s
  5791  2900 -3188.7586   18  549 -4253.8135  782.17029   118%   952  480s
  5793  2902 -1394.2113   21  561 -4253.8135  782.17029   118%   952  499s
  5794  2902 -2736.7237   44  561 -4253.8135  782.17029   118%   952  508s
  5795  2906  782.17029   13  541 -4253.8135  782.17029   118%   974  522s
  5797  2909  782.17029   14  563 -4253.8135  782.17029   118%   975  529s
  5801  2916  782.17029   15  505 -4253.8135  782.17029   118%   977  537s
  5809  2929  782.17029   16  558 -4253.8135  782.17029   118%   982  546s
  5825  2939 -3343.6009   17  239 -4253.8135  782.17029   118%   996  562s
  5846  2943 -132.58815   18  472 -4253.8135  782.17029   118%  1020  568s
  5878  2975 -329.27542   19  452 -4253.8135  782.17029   118%  1029  578s
  5955  2999 -763.35492   21  458 -4253.8135  782.17029   118%  1048  585s
  6101  3016 -444.11420   20  482 -4253.8135  782.17029   118%  1061  597s
  6178  3011 -1062.0834   22  449 -4253.8135  782.17029   118%  1064  601s
H 6226  2849                    -4216.100621  782.17029   119%  1062  601s
  6261  2868 -3102.7547   22  460 -4216.1006  782.17029   119%  1061  609s
  6339  2851 -1059.5458   23  451 -4216.1006  782.17029   119%  1058  617s
  6404  2846 -1273.5271   24  439 -4216.1006  782.17029   119%  1059  624s
  6480  2842     cutoff   23      -4216.1006  782.17029   119%  1060  629s
  6515  2841 -1467.3319   26  455 -4216.1006  782.17029   119%  1063  634s
  6567  2854 -1643.6444   27  337 -4216.1006  782.17029   119%  1065  640s
  6625  2841 -1662.5027   28  331 -4216.1006  782.17029   119%  1065  646s
  6699  2832 -1734.7358   29  247 -4216.1006  782.17029   119%  1068  652s
  6760  2830 -1774.1303   30  241 -4216.1006  782.17029   119%  1069  659s
  6834  2823 -2058.7490   32  289 -4216.1006  782.17029   119%  1070  664s
  6897  2812 -2114.9747   33  294 -4216.1006  753.12604   118%  1073  669s
  6997  2788 -2230.7640   35  277 -4216.1006  753.12604   118%  1070  676s
  7070  2774 -2527.9407   38  267 -4216.1006  596.37528   114%  1070  683s
  7166  2776 -2828.3783   42  286 -4216.1006  291.96612   107%  1074  690s
  7242  2762     cutoff   45      -4216.1006  142.35598   103%  1078  699s
  7341  2740 infeasible   46      -4216.1006  118.07388   103%  1080  707s
  7459  2715 -2856.5093   24  306 -4216.1006  118.07388   103%  1086  714s
  7571  2698 infeasible   25      -4216.1006  118.07388   103%  1090  722s
  7653  2685 -4082.9931   27  282 -4216.1006 -253.79153  94.0%  1095  728s
  7762  2659 -1479.9212   21  463 -4216.1006 -253.79153  94.0%  1101  737s
  7885  2645 -1791.4959   22  457 -4216.1006 -823.13556  80.5%  1104  744s
  8008  2589 -2689.7576   24  441 -4216.1006 -823.13556  80.5%  1104  753s
  8170  2574 -3037.5852   25  430 -4216.1006 -964.12636  77.1%  1103  759s
  8320  2555 -3362.9807   27  362 -4216.1006 -1357.9146  67.8%  1104  766s
  8505  2511 -3827.1792   30  321 -4216.1006 -1357.9146  67.8%  1099  773s
  8712  2448     cutoff   23      -4216.1006 -1587.0796  62.4%  1095  782s
  8928  2384 -3476.3694   27  260 -4216.1006 -1684.6398  60.0%  1092  789s
  9146  2309     cutoff   30      -4216.1006 -1762.1049  58.2%  1090  799s
  9203  2274 -3451.5514   30  273 -4216.1006 -1762.1049  58.2%  1090  806s
  9278  2235 -3463.6744   31  262 -4216.1006 -1874.4131  55.5%  1088  813s
  9369  2174 -3499.2877   32  246 -4216.1006 -1874.4131  55.5%  1084  821s
  9563  2044 -4127.1682   32  186 -4216.1006 -2126.2596  49.6%  1075  831s
  9854  1911     cutoff   29      -4216.1006 -2126.2596  49.6%  1065  839s
  9988  1821     cutoff   25      -4216.1006 -2126.2596  49.6%  1062  847s
 10281  1586 -3223.8577   23  370 -4216.1006 -2511.4099  40.4%  1052  857s
 10638  1264 -4177.8768   24  258 -4216.1006 -2630.1025  37.6%  1038  867s
 11102   987     cutoff   29      -4216.1006 -2921.5414  30.7%  1014  870s

Cutting planes:
  Gomory: 1
  Implied bound: 22
  Projected implied bound: 5
  MIR: 387
  Flow cover: 1434
  Zero half: 2
  RLT: 9
  Relax-and-lift: 75

Explored 11286 nodes (11454799 simplex iterations) in 870.59 seconds (2308.39 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -4216.1 -4253.81 -4254.59 ... -201986
No other solutions better than -4216.1

Optimal solution found (tolerance 1.00e-04)
Best objective -4.216100621360e+03, best bound -4.216100621360e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 870.60s
  Master Objective (UB) = -4216.10, θ = 115995.20
  Upper Bound (UB) = -4216.10

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 115995.20
  [DEBUG]   ✓ Scenario 0: θ = 115995.20 ≤ Q = 115995.20 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 115995.20 ≤ Q = 115995.20 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 115995.20 ≤ Q = 115995.20 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 115995.20 ≤ Q = 115995.20 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 115995.20 ≤ Q = 115995.20 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x7afa8eda
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x7afa8eda
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.283321e+13
Presolve removed 2592 rows and 1886 columns
Presolve time: 0.00s
Presolved: 501 rows, 503 columns, 1412 nonzeros
Found heuristic solution: objective 7080275.9467
Variable types: 339 continuous, 164 integer (164 binary)

Root relaxation: objective -1.162287e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -116228.65    0  121 7080275.95 -116228.65   102%     -    0s
H    0     0                    -80910.60613 -116228.65  43.7%     -    0s
H    0     0                    -82554.92556 -116228.65  40.8%     -    0s
     0     0 -98617.826    0  105 -82554.926 -98617.826  19.5%     -    0s
H    0     0                    -95523.65016 -98585.262  3.21%     -    0s
     0     0 -98445.942    0  106 -95523.650 -98445.942  3.06%     -    0s
     0     0 -98439.480    0  106 -95523.650 -98439.480  3.05%     -    0s
H    0     0                    -96822.93227 -98439.480  1.67%     -    0s
H    0     0                    -96868.65297 -98105.725  1.28%     -    0s
     0     0 -98105.725    0  109 -96868.653 -98105.725  1.28%     -    0s
     0     0 -98097.187    0  109 -96868.653 -98097.187  1.27%     -    0s
     0     0 -97824.847    0  101 -96868.653 -97824.847  0.99%     -    0s
     0     0 -97675.183    0   73 -96868.653 -97675.183  0.83%     -    0s
     0     0 -97639.907    0   76 -96868.653 -97639.907  0.80%     -    0s
     0     0 -97587.630    0   78 -96868.653 -97587.630  0.74%     -    0s
     0     0 -97585.931    0   78 -96868.653 -97585.931  0.74%     -    0s
     0     0 -97378.938    0   82 -96868.653 -97378.938  0.53%     -    0s
     0     0 -97350.374    0   72 -96868.653 -97350.374  0.50%     -    0s
     0     0 -97350.374    0   67 -96868.653 -97350.374  0.50%     -    0s
     0     0 -97250.822    0   64 -96868.653 -97250.822  0.39%     -    0s
     0     0 -97223.092    0   65 -96868.653 -97223.092  0.37%     -    0s
     0     0 -97222.378    0   65 -96868.653 -97222.378  0.37%     -    0s
     0     0 -97193.518    0   65 -96868.653 -97193.518  0.34%     -    0s
     0     0 -97187.081    0   65 -96868.653 -97187.081  0.33%     -    0s
H    0     0                    -96869.77811 -97187.081  0.33%     -    0s
H    0     0                    -96873.63606 -97187.081  0.32%     -    0s
     0     2 -97187.081    0   65 -96873.636 -97187.081  0.32%     -    0s
*   55     3              13    -96879.54623 -96894.820  0.02%   8.3    0s
*   62     0              14    -96893.60122 -96893.601  0.00%   7.6    0s

Cutting planes:
  Gomory: 2
  Implied bound: 1
  MIR: 153
  Flow cover: 22
  RLT: 40
  Relax-and-lift: 1

Explored 65 nodes (1188 simplex iterations) in 0.09 seconds (0.08 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -96893.6 -96879.5 -96873.6 ... 1.28332e+13
No other solutions better than -96893.6

Optimal solution found (tolerance 1.00e-04)
Best objective -9.689360121722e+04, best bound -9.689360121722e+04, gap 0.0000%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 102807.98
  Scenario: 48 demand increases, 12 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -96893.60
  [DEBUG]   S×d_nominal = 199701.59
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 199701.59 + -96893.60 = 102807.98
  [DEBUG]   Current θ from Master = 115995.20
  [DEBUG]   ⚠️  Z_SP ≤ θ by 13187.21 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -17403.32
  Lower Bound (LB) = -5399.73
  Gap (UB-LB) = 1183.6293, Absolute Gap = 1183.6293, Relative Gap = 0.280740
  Not converged yet (gap = 1183.63 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 48 increases, 12 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 264941 nonzeros
Model fingerprint: 0x388ee08a
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 41288 rows and 16768 columns
Presolve time: 0.81s
Presolved: 51835 rows, 22932 columns, 321959 nonzeros
Variable types: 20673 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -410141.1274
Found heuristic solution: objective -403085.5655
Found heuristic solution: objective -211458.2747

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 51835 rows, 22932 columns, 321959 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   34380   -7.4964477e+02   0.000000e+00   3.681435e+06      5s
   44157    5.6546513e+03   0.000000e+00   1.231656e+06     10s
Concurrent spin time: 1.07s

Solved with dual simplex

Root relaxation: objective 1.250047e+04, 35732 iterations, 12.64 seconds (26.10 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 12500.4674    0  362 -211458.27 12500.4674   106%     -   13s
H    0     0                    -205738.3218 12500.4674   106%     -   13s
H    0     0                    -24246.51156 12500.4674   152%     -   14s
H    0     0                    -20885.29670 12500.4674   160%     -   14s
H    0     0                    -20505.55656 12500.4674   161%     -   14s
H    0     0                    -5617.695458 12500.4674   323%     -   14s
H    0     0                    -4727.634369 12500.4674   364%     -   14s
H    0     0                    -4265.561058 12500.4674   393%     -   14s
     0     0 8842.21611    0  405 -4265.5611 8842.21611   307%     -   20s
     0     0 8584.33190    0  400 -4265.5611 8584.33190   301%     -   21s
     0     0 8466.38822    0  408 -4265.5611 8466.38822   298%     -   22s
     0     0 8339.55188    0  420 -4265.5611 8339.55188   296%     -   23s
     0     0 8322.67312    0  420 -4265.5611 8322.67312   295%     -   23s
     0     0 7452.35687    0  407 -4265.5611 7452.35687   275%     -   27s
     0     0 7154.21104    0  356 -4265.5611 7154.21104   268%     -   30s
H    0     0                    -4254.587538 7118.40945   267%     -   31s
     0     0 7118.40945    0  405 -4254.5875 7118.40945   267%     -   31s
     0     0 6926.56951    0  342 -4254.5875 6926.56951   263%     -   32s
     0     0 6854.21328    0  339 -4254.5875 6854.21328   261%     -   33s
     0     0 6851.75406    0  343 -4254.5875 6851.75406   261%     -   33s
     0     0 6839.61850    0  350 -4254.5875 6839.61850   261%     -   34s
     0     0 6838.04898    0  344 -4254.5875 6838.04898   261%     -   34s
     0     0 6837.98781    0  344 -4254.5875 6837.98781   261%     -   34s
     0     0 5678.22692    0  376 -4254.5875 5678.22692   233%     -   42s
     0     0 5383.20207    0  391 -4254.5875 5383.20207   227%     -   45s
     0     0 5242.08902    0  396 -4254.5875 5242.08902   223%     -   47s
     0     0 5205.16087    0  497 -4254.5875 5205.16087   222%     -   48s
     0     0 5190.95576    0  398 -4254.5875 5190.95576   222%     -   49s
     0     0 5179.36790    0  491 -4254.5875 5179.36790   222%     -   49s
     0     0 5147.22223    0  406 -4254.5875 5147.22223   221%     -   50s
     0     0 5133.11916    0  410 -4254.5875 5133.11916   221%     -   50s
H    0     0                    -4253.813516 5073.47580   219%     -   51s
     0     0 5073.47580    0  403 -4253.8135 5073.47580   219%     -   51s
     0     0 5044.40319    0  414 -4253.8135 5044.40319   219%     -   52s
     0     0 5038.56709    0  414 -4253.8135 5038.56709   218%     -   53s
     0     0 5038.24225    0  408 -4253.8135 5038.24225   218%     -   53s
     0     0 4186.93362    0  514 -4253.8135 4186.93362   198%     -   59s
     0     0 3981.97370    0  507 -4253.8135 3981.97370   194%     -   61s
     0     0 3830.19641    0  450 -4253.8135 3830.19641   190%     -   63s
     0     0 3795.45813    0  505 -4253.8135 3795.45813   189%     -   64s
     0     0 3753.30718    0  506 -4253.8135 3753.30718   188%     -   65s
     0     0 3732.97573    0  523 -4253.8135 3732.97573   188%     -   66s
     0     0 3704.75793    0  524 -4253.8135 3704.75793   187%     -   67s
     0     0 3698.43499    0  522 -4253.8135 3698.43499   187%     -   68s
     0     0 3696.46146    0  525 -4253.8135 3696.46146   187%     -   68s
     0     0 3692.50172    0  519 -4253.8135 3692.50172   187%     -   68s
     0     0 3668.21862    0  535 -4253.8135 3668.21862   186%     -   69s
     0     0 3652.36877    0  522 -4253.8135 3652.36877   186%     -   70s
     0     0 3647.58269    0  534 -4253.8135 3647.58269   186%     -   70s
     0     0 3647.28015    0  533 -4253.8135 3647.28015   186%     -   70s
     0     0 3499.33350    0  538 -4253.8135 3499.33350   182%     -   73s
     0     0 3466.73028    0  562 -4253.8135 3466.73028   181%     -   74s
     0     0 3460.87161    0  482 -4253.8135 3460.87161   181%     -   75s
     0     0 3447.46747    0  565 -4253.8135 3447.46747   181%     -   75s
     0     0 3445.93022    0  567 -4253.8135 3445.93022   181%     -   76s
     0     0 3439.06807    0  562 -4253.8135 3439.06807   181%     -   76s
     0     0 3438.98271    0  560 -4253.8135 3438.98271   181%     -   76s
     0     0 3383.34951    0  476 -4253.8135 3383.34951   180%     -   78s
     0     0 3362.97654    0  564 -4253.8135 3362.97654   179%     -   81s
     0     0 3358.72908    0  560 -4253.8135 3358.72908   179%     -   82s
     0     0 3352.45183    0  486 -4253.8135 3352.45183   179%     -   83s
     0     0 3352.40569    0  486 -4253.8135 3352.40569   179%     -   83s
     0     0 3187.86796    0  594 -4253.8135 3187.86796   175%     -   86s
     0     0 3140.64805    0  596 -4253.8135 3140.64805   174%     -   87s
     0     0 3135.16928    0  605 -4253.8135 3135.16928   174%     -   88s
     0     0 3131.86877    0  617 -4253.8135 3131.86877   174%     -   88s
     0     0 3128.50094    0  614 -4253.8135 3128.50094   174%     -   88s
     0     0 3127.70784    0  613 -4253.8135 3127.70784   174%     -   88s
     0     0 3052.50252    0  564 -4253.8135 3052.50252   172%     -   90s
     0     0 3032.11390    0  583 -4253.8135 3032.11390   171%     -   94s
     0     0 3028.18857    0  584 -4253.8135 3028.18857   171%     -   94s
     0     0 3026.08952    0  580 -4253.8135 3026.08952   171%     -   94s
     0     0 3025.65395    0  585 -4253.8135 3025.65395   171%     -   94s
     0     0 3010.84503    0  489 -4253.8135 3010.84503   171%     -   96s
     0     0 2998.95097    0  567 -4253.8135 2998.95097   171%     -   97s
     0     0 2994.46691    0  579 -4253.8135 2994.46691   170%     -   97s
     0     0 2992.81963    0  582 -4253.8135 2992.81963   170%     -   97s
     0     0 2991.77863    0  578 -4253.8135 2991.77863   170%     -   97s
     0     0 2963.38747    0  574 -4253.8135 2963.38747   170%     -   99s
     0     0 2955.24221    0  584 -4253.8135 2955.24221   169%     -   99s
     0     0 2947.41465    0  575 -4253.8135 2947.41465   169%     -   99s
     0     0 2944.60777    0  580 -4253.8135 2944.60777   169%     -  100s
     0     0 2940.68901    0  577 -4253.8135 2940.68901   169%     -  100s
     0     0 2939.02798    0  575 -4253.8135 2939.02798   169%     -  100s
     0     0 2938.95669    0  580 -4253.8135 2938.95669   169%     -  100s
     0     0 2917.52843    0  499 -4253.8135 2917.52843   169%     -  102s
     0     0 2915.32729    0  589 -4253.8135 2915.32729   169%     -  102s
     0     0 2912.36234    0  597 -4253.8135 2912.36234   168%     -  102s
     0     0 2912.10773    0  589 -4253.8135 2912.10773   168%     -  102s
     0     0 2906.35067    0  586 -4253.8135 2906.35067   168%     -  103s
     0     0 2904.98533    0  592 -4253.8135 2904.98533   168%     -  104s
     0     0 2904.77394    0  594 -4253.8135 2904.77394   168%     -  104s
     0     0 2897.40077    0  582 -4253.8135 2897.40077   168%     -  105s
     0     0 2895.91048    0  587 -4253.8135 2895.91048   168%     -  106s
     0     0 2895.86497    0  591 -4253.8135 2895.86497   168%     -  106s
     0     0 2895.08167    0  595 -4253.8135 2895.08167   168%     -  107s
     0     0 2894.63158    0  595 -4253.8135 2894.63158   168%     -  108s
     0     2 2894.43149    0  595 -4253.8135 2894.43149   168%     -  137s
     1     4 2876.81575    1  585 -4253.8135 2892.48323   168%   660  142s
     3     8 2863.95612    2  582 -4253.8135 2876.76964   168%  3168  145s
     7    16 2779.18353    3  507 -4253.8135 2863.36966   167%  3048  152s
    15    30 2195.17491    4  566 -4253.8135 2778.95976   165%  4266  159s
    31    42 2501.94126    5  548 -4253.8135 2534.51586   160%  6053  173s
    47    63 2011.87080    6  532 -4253.8135 2534.51586   160%  6025  184s
    79   114 1863.93630    7  528 -4253.8135 2420.18264   157%  5022  196s
   155   170 1838.20480    8  526 -4253.8135 2294.80894   154%  3612  205s
   258   194 1675.96981    9  528 -4253.8135 2294.80894   154%  2979  212s
   334   240 1500.10210   10  504 -4253.8135 2294.80894   154%  2842  218s
   407   284 1344.10716   11  564 -4253.8135 2294.80894   154%  2790  223s
   478   319  962.91145   12  498 -4253.8135 2229.19522   152%  2694  230s
   555   347  922.74306   13  480 -4253.8135 2075.30132   149%  2656  237s
   615   400  726.65591   14  426 -4253.8135 2075.30132   149%  2683  244s
   686   440  667.48974   15  418 -4253.8135 2075.30132   149%  2664  250s
   741   495  294.54558   17  367 -4253.8135 2033.46059   148%  2681  255s
   876   573 -226.46020   19  306 -4253.8135 2033.46059   148%  2631  266s
   943   594 -655.97720   20  308 -4253.8135 1987.55886   147%  2600  271s
  1015   613 -826.77057   21  211 -4253.8135 1987.55886   147%  2554  277s
  1093   616 -1292.0907   22  195 -4253.8135 1934.79260   145%  2514  284s
  1177   649     cutoff   23      -4253.8135 1863.27304   144%  2520  291s
  1254   678     cutoff   24      -4253.8135 1832.41817   143%  2516  299s
  1337   712 -2709.9897   25  152 -4253.8135 1717.31560   140%  2527  306s
  1399   731 -3350.7081   26  281 -4253.8135 1717.31560   140%  2565  313s
  1454   748 -3636.8617   27  249 -4253.8135 1717.31560   140%  2603  320s
  1527   762     cutoff   30      -4253.8135 1559.25883   137%  2610  327s
  1621   792  -64.69550    9  403 -4253.8135 1559.25883   137%  2599  335s
  1699   823 -232.87952   11  312 -4253.8135 1497.25294   135%  2651  343s
  1783   862 -649.80510   13  251 -4253.8135 1496.45267   135%  2687  352s
  1886   900 -1386.0314   16  312 -4253.8135 1496.28981   135%  2702  359s
  1989   952 -2607.9395   20  272 -4253.8135 1359.05094   132%  2722  366s
  2101   968 -4226.0693   27  199 -4253.8135 1359.05094   132%  2723  376s
  2194  1022 -2089.2653    9  391 -4253.8135 1342.07246   132%  2717  385s
  2312  1064 -3172.8280   11  310 -4253.8135 1334.88815   131%  2700  395s
  2436  1126 -3436.5204   14  483 -4253.8135 1295.16237   130%  2710  404s
  2605  1193 -405.41503   10  441 -4253.8135 1295.16237   130%  2683  414s
  2740  1252 -716.66064   11  389 -4253.8135 1295.16237   130%  2707  424s
  2877  1327 -2684.7801   12  290 -4253.8135 1295.16237   130%  2735  433s
  3074  1383 -3151.4941   15  204 -4253.8135 1181.04643   128%  2705  444s
  3255  1422     cutoff   19      -4253.8135 1092.19179   126%  2702  455s
  3394  1491     cutoff   15      -4253.8135 1092.19179   126%  2695  465s
  3570  1560     cutoff   16      -4253.8135  889.46281   121%  2688  477s
  3753  1645 -1305.7880    9  317 -4253.8135  889.46281   121%  2685  489s
  4020  1660 -1630.4581   10  310 -4253.8135  776.14760   118%  2647  504s
  4069  1683 -1670.3841   11  257 -4253.8135  776.14760   118%  2654  533s
  4118  1686 -1864.4955   12  400 -4253.8135  776.14760   118%  2653  552s
  4190  1702 -1910.3340   13  392 -4253.8135  688.08441   116%  2660  564s
  4252  1725 -1935.6866   14  385 -4253.8135  610.45713   114%  2660  574s
  4339  1749 -1973.5670   15  387 -4253.8135  610.45713   114%  2655  585s
  4426  1767 -2215.3446   16  330 -4253.8135  485.72937   111%  2639  597s
  4482  1781 -2243.1898   17  276 -4253.8135  485.72937   111%  2637  609s
  4564  1819 infeasible   18      -4253.8135  485.72937   111%  2638  620s
  4684  1885 -2745.5717   19  400 -4253.8135  485.72937   111%  2626  630s
  4835  1907 -3137.8077   20  386 -4253.8135  358.01812   108%  2597  644s
  4945  1928 -3194.2612   21  351 -4253.8135  341.52753   108%  2584  657s
  5101  1981 -3229.3801   22  368 -4253.8135  332.24871   108%  2558  673s
  5235  1996 -3249.6725   23  317 -4253.8135  332.24871   108%  2543  687s
  5382  2005 -3367.1064   24  302 -4253.8135  326.04770   108%  2529  703s
  5544  2033 -3391.9150   25  258 -4253.8135  278.08176   107%  2521  718s
  5726  2064 -3523.6127   26  261 -4253.8135  154.68291   104%  2518  737s
  5961  2098 -3714.6473   27  267 -4253.8135  151.91652   104%  2499  752s
  6259  2185     cutoff   17      -4253.8135 -140.00135  96.7%  2483  771s
  6666  2202     cutoff   29      -4253.8135 -166.82047  96.1%  2464  791s
  7192  2230     cutoff   25      -4253.8135 -381.18906  91.0%  2421  810s
  7670  2261 -3482.2906   27  304 -4253.8135 -732.34808  82.8%  2389  829s
  8326  2185 -3461.8356   14  320 -4253.8135 -755.51599  82.2%  2331  848s
  8968  2175 -3720.4939   26  298 -4253.8135 -1352.7222  68.2%  2286  868s
  9447  2153 -3239.4470   16  396 -4253.8135 -1526.5147  64.1%  2249  888s
 10376  2006     cutoff   29      -4253.8135 -1843.8043  56.7%  2158  906s
 11614  1815     cutoff   31      -4253.8135 -2248.4480  47.1%  2028  926s
 13240  1152     cutoff   29      -4253.8135 -2441.5030  42.6%  1860  945s
 15328    84 -4073.2187   17  311 -4253.8135 -3070.8013  27.8%  1674  960s
 17246    15     cutoff   14      -4253.8135 -3558.2306  16.4%  1519  971s
 17323     0     cutoff   27      -4253.8135 -3831.3433  9.93%  1513  979s

Cutting planes:
  Gomory: 2
  Implied bound: 24
  MIR: 396
  Flow cover: 1464
  Zero half: 5
  RLT: 29
  Relax-and-lift: 66

Explored 17350 nodes (26403476 simplex iterations) in 979.87 seconds (2923.47 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -4253.81 -4254.59 -4265.56 ... -211458
No other solutions better than -4253.81

Optimal solution found (tolerance 1.00e-04)
Best objective -4.253813515991e+03, best bound -4.253813515991e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 979.98s
  Master Objective (UB) = -4253.81, θ = 116970.77
  Upper Bound (UB) = -4253.81

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 116970.77
  [DEBUG]   ✓ Scenario 0: θ = 116970.77 ≤ Q = 116970.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 116970.77 ≤ Q = 116970.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 116970.77 ≤ Q = 116970.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 116970.77 ≤ Q = 116970.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 116970.77 ≤ Q = 116970.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 116970.77 ≤ Q = 116970.77 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x64244c2a
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x9bdbb3d6
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-01, 2e+02]
Found heuristic solution: objective 1.303487e+13
Presolve removed 2592 rows and 1886 columns
Presolve time: 0.00s
Presolved: 501 rows, 503 columns, 1412 nonzeros
Found heuristic solution: objective 7089054.6266
Variable types: 339 continuous, 164 integer (164 binary)

Root relaxation: objective -1.163647e+05, 252 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -116364.71    0  121 7089054.63 -116364.71   102%     -    0s
H    0     0                    -81104.03043 -116364.71  43.5%     -    0s
H    0     0                    -82741.09133 -116364.71  40.6%     -    0s
     0     0 -93293.475    0  103 -82741.091 -93293.475  12.8%     -    0s
H    0     0                    -90183.83130 -93289.352  3.44%     -    0s
     0     0 -93085.408    0  107 -90183.831 -93085.408  3.22%     -    0s
     0     0 -93055.468    0  107 -90183.831 -93055.468  3.18%     -    0s
H    0     0                    -91525.56369 -93055.468  1.67%     -    0s
H    0     0                    -91552.36183 -93055.468  1.64%     -    0s
     0     0 -92996.395    0  107 -91552.362 -92996.395  1.58%     -    0s
     0     0 -92982.946    0  107 -91552.362 -92982.946  1.56%     -    0s
     0     2 -92982.946    0  107 -91552.362 -92982.946  1.56%     -    0s
H 3351   837                    -91559.96846 -91897.192  0.37%   3.6    0s
H 5079  1061                    -91565.47637 -91787.894  0.24%   3.6    0s
H 5137  1061                    -91566.34606 -91787.894  0.24%   3.6    0s

Cutting planes:
  Gomory: 102
  Implied bound: 2
  MIR: 216

Explored 9886 nodes (40089 simplex iterations) in 0.26 seconds (0.26 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -91566.3 -91565.5 -91560 ... 1.30349e+13
No other solutions better than -91566.3

Optimal solution found (tolerance 1.00e-04)
Best objective -9.156634605953e+04, best bound -9.156634605953e+04, gap 0.0000%
  Subproblem solved in 0.28s
  Worst-case operational profit (Z_SP) = 109339.70
  Scenario: 47 demand increases, 13 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -91566.35
  [DEBUG]   S×d_nominal = 200906.04
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 200906.04 + -91566.35 = 109339.70
  [DEBUG]   Current θ from Master = 116970.77
  [DEBUG]   ⚠️  Z_SP ≤ θ by 7631.07 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -11884.88
  Lower Bound (LB) = -5399.73
  Gap (UB-LB) = 1145.9164, Absolute Gap = 1145.9164, Relative Gap = 0.269386
  Not converged yet (gap = 1145.92 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 47 increases, 13 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308178 nonzeros
Model fingerprint: 0x899cfe95
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 48156 rows and 19556 columns
Presolve time: 1.00s
Presolved: 60257 rows, 26384 columns, 374739 nonzeros
Variable types: 24125 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -410141.1274
Found heuristic solution: objective -211458.2747

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 60257 rows, 26384 columns, 374739 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   35746   -3.0228038e+04   0.000000e+00   2.650624e+06      5s
   45436   -2.2000409e+03   0.000000e+00   6.934317e+06     10s
   53743    3.3073891e+03   0.000000e+00   3.020304e+06     15s
   61280    4.5615214e+03   0.000000e+00   1.540797e+06     20s
   68328    5.2386271e+03   0.000000e+00   1.131625e+06     25s
   75736    8.2355653e+03   0.000000e+00   4.192581e+06     30s
Concurrent spin time: 2.94s

Solved with dual simplex

Root relaxation: objective 1.250047e+04, 66604 iterations, 32.39 seconds (67.60 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 12500.4674    0  362 -211458.27 12500.4674   106%     -   33s
H    0     0                    -205738.3218 12500.4674   106%     -   33s
H    0     0                    -24246.51156 12500.4674   152%     -   34s
H    0     0                    -20885.29670 12500.4674   160%     -   34s
H    0     0                    -20505.55656 12500.4674   161%     -   34s
H    0     0                    -15635.09650 12500.4674   180%     -   34s
H    0     0                    -4844.919863 12500.4674   358%     -   34s
H    0     0                    -4518.527142 12500.4674   377%     -   34s
H    0     0                    -4407.114750 12500.4674   384%     -   34s
     0     0 8875.74807    0  422 -4407.1148 8875.74807   301%     -   42s
H    0     0                    -4381.842072 8874.20925   303%     -   42s
H    0     0                    -4308.159327 8874.20925   306%     -   42s
     0     0 8683.39544    0  403 -4308.1593 8683.39544   302%     -   44s
     0     0 8440.84660    0  422 -4308.1593 8440.84660   296%     -   46s
     0     0 8408.97510    0  422 -4308.1593 8408.97510   295%     -   46s
     0     0 8408.97510    0  418 -4308.1593 8408.97510   295%     -   47s
     0     0 8331.04520    0  427 -4308.1593 8331.04520   293%     -   47s
     0     0 8331.04520    0  430 -4308.1593 8331.04520   293%     -   49s
     0     0 8331.04520    0  436 -4308.1593 8331.04520   293%     -   49s
     0     0 8331.04520    0  436 -4308.1593 8331.04520   293%     -   49s
H    0     0                    -4297.185806 8331.04520   294%     -   50s
     0     0 7050.24250    0  405 -4297.1858 7050.24250   264%     -   55s
     0     0 6995.47186    0  418 -4297.1858 6995.47186   263%     -   57s
     0     0 6780.35324    0  369 -4297.1858 6780.35324   258%     -   60s
     0     0 6751.87721    0  416 -4297.1858 6751.87721   257%     -   62s
     0     0 6738.37037    0  425 -4297.1858 6738.37037   257%     -   62s
     0     0 6737.79497    0  426 -4297.1858 6737.79497   257%     -   62s
     0     0 5525.26543    0  415 -4297.1858 5525.26543   229%     -   71s
H    0     0                    -4296.411784 5525.10231   229%     -   71s
     0     0 4899.10144    0  424 -4296.4118 4899.10144   214%     -   75s
     0     0 4578.65564    0  496 -4296.4118 4578.65564   207%     -   78s
     0     0 4534.67936    0  482 -4296.4118 4534.67936   206%     -   80s
     0     0 4508.44767    0  515 -4296.4118 4508.44767   205%     -   80s
     0     0 4475.42875    0  498 -4296.4118 4475.42875   204%     -   81s
     0     0 4427.94922    0  507 -4296.4118 4427.94922   203%     -   83s
     0     0 4419.72936    0  510 -4296.4118 4419.72936   203%     -   83s
     0     0 4418.22592    0  511 -4296.4118 4418.22592   203%     -   83s
     0     0 4416.43734    0  515 -4296.4118 4416.43734   203%     -   84s
     0     0 4408.85929    0  512 -4296.4118 4408.85929   203%     -   84s
     0     0 4407.96666    0  509 -4296.4118 4407.96666   203%     -   84s
     0     0 4404.57299    0  508 -4296.4118 4404.57299   203%     -   84s
     0     0 4403.26639    0  508 -4296.4118 4403.26639   202%     -   84s
     0     0 4403.23654    0  509 -4296.4118 4403.23654   202%     -   84s
     0     0 3969.20398    0  534 -4296.4118 3969.20398   192%     -   91s
     0     0 3663.46784    0  518 -4296.4118 3663.46784   185%     -   94s
     0     0 3603.67169    0  530 -4296.4118 3603.67169   184%     -   95s
     0     0 3587.98168    0  510 -4296.4118 3587.98168   184%     -   96s
     0     0 3573.65394    0  529 -4296.4118 3573.65394   183%     -   97s
     0     0 3567.29561    0  518 -4296.4118 3567.29561   183%     -   97s
     0     0 3555.70936    0  512 -4296.4118 3555.70936   183%     -   97s
     0     0 3549.02330    0  520 -4296.4118 3549.02330   183%     -   98s
     0     0 3537.58449    0  525 -4296.4118 3537.58449   182%     -   98s
     0     0 3530.18849    0  471 -4296.4118 3530.18849   182%     -   99s
     0     0 3513.14078    0  529 -4296.4118 3513.14078   182%     -   99s
     0     0 3510.85860    0  522 -4296.4118 3510.85860   182%     -  100s
     0     0 3510.03468    0  527 -4296.4118 3510.03468   182%     -  100s
     0     0 3387.67005    0  522 -4296.4118 3387.67005   179%     -  103s
     0     0 3366.49808    0  525 -4296.4118 3366.49808   178%     -  104s
     0     0 3357.96252    0  540 -4296.4118 3357.96252   178%     -  105s
     0     0 3352.02209    0  546 -4296.4118 3352.02209   178%     -  105s
     0     0 3348.85985    0  546 -4296.4118 3348.85985   178%     -  106s
     0     0 3344.48578    0  536 -4296.4118 3344.48578   178%     -  106s
     0     0 3344.43400    0  542 -4296.4118 3344.43400   178%     -  106s
     0     0 3279.17347    0  544 -4296.4118 3279.17347   176%     -  109s
     0     0 3249.20326    0  532 -4296.4118 3249.20326   176%     -  113s
     0     0 3246.21474    0  541 -4296.4118 3246.21474   176%     -  113s
     0     0 3240.48925    0  539 -4296.4118 3240.48925   175%     -  114s
     0     0 3237.26014    0  540 -4296.4118 3237.26014   175%     -  114s
     0     0 3236.20542    0  536 -4296.4118 3236.20542   175%     -  114s
     0     0 3170.31510    0  527 -4296.4118 3170.31510   174%     -  116s
     0     0 3158.64311    0  529 -4296.4118 3158.64311   174%     -  117s
     0     0 3155.73082    0  530 -4296.4118 3155.73082   173%     -  118s
     0     0 3148.01298    0  550 -4296.4118 3148.01298   173%     -  118s
     0     0 3147.31466    0  551 -4296.4118 3147.31466   173%     -  118s
     0     0 3114.97416    0  539 -4296.4118 3114.97416   173%     -  120s
     0     0 3101.27050    0  547 -4296.4118 3101.27050   172%     -  127s
     0     0 3090.60161    0  542 -4296.4118 3090.60161   172%     -  127s
     0     0 3082.97837    0  555 -4296.4118 3082.97837   172%     -  127s
     0     0 3081.76168    0  560 -4296.4118 3081.76168   172%     -  128s
     0     0 3081.21391    0  557 -4296.4118 3081.21391   172%     -  128s
     0     0 3059.99971    0  564 -4296.4118 3059.99971   171%     -  129s
     0     0 3054.74889    0  571 -4296.4118 3054.74889   171%     -  130s
     0     0 3053.65243    0  571 -4296.4118 3053.65243   171%     -  130s
     0     0 3028.89297    0  564 -4296.4118 3028.89297   170%     -  131s
     0     0 3024.02441    0  562 -4296.4118 3024.02441   170%     -  132s
     0     0 3022.62405    0  560 -4296.4118 3022.62405   170%     -  132s
     0     0 3022.32771    0  561 -4296.4118 3022.32771   170%     -  132s
     0     0 3015.27072    0  562 -4296.4118 3015.27072   170%     -  133s
     0     0 3011.31183    0  570 -4296.4118 3011.31183   170%     -  134s
     0     0 3009.92040    0  565 -4296.4118 3009.92040   170%     -  134s
     0     0 3009.76343    0  565 -4296.4118 3009.76343   170%     -  134s
     0     0 3005.88913    0  561 -4296.4118 3005.88913   170%     -  135s
     0     0 3004.29450    0  573 -4296.4118 3004.29450   170%     -  136s
     0     0 3003.49492    0  574 -4296.4118 3003.49492   170%     -  136s
     0     0 2999.20889    0  574 -4296.4118 2999.20889   170%     -  137s
     0     0 2997.53286    0  573 -4296.4118 2997.53286   170%     -  137s
     0     0 2997.29435    0  572 -4296.4118 2997.29435   170%     -  137s
     0     0 2995.60893    0  573 -4296.4118 2995.60893   170%     -  138s
     0     0 2995.56832    0  573 -4296.4118 2995.56832   170%     -  140s
     0     2 2995.21916    0  573 -4296.4118 2995.21916   170%     -  176s
     3     8 2746.70930    2  542 -4296.4118 2818.05133   166%  3911  182s
     7    16 2303.69643    3  560 -4296.4118 2745.18343   164%  3975  190s
    15    30 2144.52214    4  615 -4296.4118 2319.95733   154%  4941  195s
    31    42 -981.24632    5  512 -4296.4118 2214.06472   152%  6519  209s
    45    61     cutoff    6      -4296.4118 2214.06472   152%  7414  221s
    74   163     cutoff    6      -4296.4118 2214.06472   152%  5775  230s
   190   194     cutoff   12      -4296.4118 2144.13898   150%  3685  237s
   233   218  627.26543    6  332 -4296.4118 2144.13898   150%  3325  247s
   277   246  509.54602    7  326 -4296.4118 2144.13898   150%  3140  252s
   339   265  342.79063    8  328 -4296.4118 2144.13898   150%  2860  259s
   403   277  403.55179    7  326 -4296.4118 2144.13898   150%  2656  266s
   464   299 -1305.2073    9  400 -4296.4118 1927.87639   145%  2533  274s
   521   339  499.07206    7  329 -4296.4118 1927.87639   145%  2439  281s
   579   385  185.40627    8  324 -4296.4118 1927.87639   145%  2390  286s
   649   426 -1354.4451    9  325 -4296.4118 1927.87639   145%  2358  293s
   722   452     cutoff   10      -4296.4118 1927.87639   145%  2345  299s
   801   470     cutoff    8      -4296.4118 1798.04825   142%  2278  306s
   880   481 -2444.7281    6  128 -4296.4118 1798.04825   142%  2283  313s
   955   496 -2563.3884    7  134 -4296.4118 1798.04825   142%  2296  321s
  1037   499 -4023.1933   12   74 -4296.4118 1798.04825   142%  2292  329s
  1116   534 -1703.8519   11  466 -4296.4118 1798.04825   142%  2374  336s
  1175   573 -1821.7352   12  512 -4296.4118 1798.04825   142%  2465  343s
  1246   608 -2060.8649   13  438 -4296.4118 1798.04825   142%  2521  350s
  1331   647 -2799.3103   15  353 -4296.4118 1671.58504   139%  2545  357s
  1417   696 -3166.5066   17  416 -4296.4118 1567.37956   136%  2583  365s
  1506   711 -3291.1595   21  300 -4296.4118 1567.37956   136%  2589  373s
  1549   726 -3328.9628   22  301 -4296.4118 1520.25813   135%  2591  381s
  1602   752     cutoff   23      -4296.4118 1474.99394   134%  2607  388s
  1652   779 -3361.1737   19  329 -4296.4118 1474.99394   134%  2614  396s
  1694   811 -3361.5226   20  327 -4296.4118 1351.57352   131%  2624  402s
  1752   850 -3385.6955   21  265 -4296.4118 1351.57352   131%  2626  410s
  1831   881 -3506.4630   22  316 -4296.4118 1351.57352   131%  2595  418s
  1923   900 -3552.9779   23  216 -4296.4118 1349.08521   131%  2555  426s
  2024   914     cutoff   24      -4296.4118 1349.08521   131%  2544  436s
  2116   925     cutoff   23      -4296.4118 1315.22377   131%  2564  447s
  2209   955  834.94710   12  389 -4296.4118 1293.21186   130%  2577  457s
  2281   980  602.52185   13  288 -4296.4118 1293.21186   130%  2632  467s
  2396   987     cutoff   14      -4296.4118 1293.21186   130%  2632  475s
  2510  1008  260.80131   15  362 -4296.4118 1293.21186   130%  2647  486s
  2613  1075 -219.14476   17  405 -4296.4118 1293.21186   130%  2672  495s
  2758  1185 -1296.6574   22  278 -4296.4118 1003.65188   123%  2660  506s
  2965  1277 -2471.2820   27  299 -4296.4118  947.29742   122%  2621  517s
  3204  1374     cutoff   33      -4296.4118  809.41918   119%  2587  529s
  3443  1474     cutoff   19      -4296.4118  753.26609   118%  2567  540s
  3743  1518     cutoff   19      -4296.4118  530.10161   112%  2528  552s
  3959  1593 -562.53240   23  187 -4296.4118  511.92654   112%  2543  562s
  4179  1645 -2793.5754   18  352 -4296.4118  379.60712   109%  2570  574s
  4435  1718 -3308.4139   21  323 -4296.4118  379.60712   109%  2577  588s
  4705  1764     cutoff   25      -4296.4118  379.60712   109%  2565  600s
  4983  1840 -1969.2390    6  314 -4296.4118  379.60712   109%  2544  613s
  5165  1965 -4128.2775    7  418 -4296.4118 -139.32093  96.8%  2560  627s
  5472  1966 -1491.8635    8  573 -4296.4118 -142.27977  96.7%  2546  670s
  5474  1967 -2976.3908   39  362 -4296.4118 -142.27977  96.7%  2545  701s
  5475  1968 -2976.3908   39  470 -4296.4118 -142.27977  96.7%  2545  718s
  5476  1969 -3883.9938   25  498 -4296.4118 -142.27977  96.7%  2544  727s
  5477  1969 -3723.9083   57  527 -4296.4118 -142.27977  96.7%  2544  732s
  5478  1970 -2506.6622   13  467 -4296.4118 -142.27977  96.7%  2543  737s
  5479  1971 -1583.8791   10  539 -4296.4118 -142.27977  96.7%  2543  741s
  5481  1972 -2537.7257   31  550 -4296.4118 -142.27977  96.7%  2542  745s
  5483  1973 -2699.2263    9  539 -4296.4118 -142.27977  96.7%  2541  751s
  5486  1975 -1128.5667   14  537 -4296.4118 -142.27977  96.7%  2540  755s
  5487  1976 -2565.2505   26  549 -4296.4118 -142.27977  96.7%  2539  762s
  5489  1977 -2029.3808   21  591 -4296.4118 -142.27977  96.7%  2538  765s
  5491  1979 -3791.2121   26  546 -4296.4118 -142.27977  96.7%  2537  772s
  5493  1980 -1645.7963   22  600 -4296.4118 -142.27977  96.7%  2536  777s
  5494  1981 -2131.3322   26  614 -4296.4118 -142.27977  96.7%  2536  781s
  5496  1982 -3586.1168   31  568 -4296.4118 -142.27977  96.7%  2535  785s
  5499  1984 -3605.7721   40  556 -4296.4118 -142.27977  96.7%  2534  793s
  5500  1985 -655.01927   24  563 -4296.4118 -142.27977  96.7%  2533  795s
  5501  1985 -3211.2119   21  565 -4296.4118 -142.27977  96.7%  2533  800s
  5503  1987 -2277.7273   15  559 -4296.4118 -142.27977  96.7%  2532  805s
  5505  1988 -2432.0179    7  565 -4296.4118 -142.27977  96.7%  2531  812s
  5507  1989 -3254.6898   18  560 -4296.4118 -142.27977  96.7%  2530  817s
  5509  1991 -2739.6063   49  555 -4296.4118 -142.27977  96.7%  2529  822s
  5510  1991 -3947.3721   16  555 -4296.4118 -142.27977  96.7%  2529  852s
  5511  1992 -1512.3526   10  555 -4296.4118 -142.27977  96.7%  2528  870s
  5512  1996 -142.27977   15  607 -4296.4118 -142.27977  96.7%  2568  903s
  5514  1999 -142.27977   16  604 -4296.4118 -142.27977  96.7%  2569  909s
  5518  2006 -142.27977   17  588 -4296.4118 -142.27977  96.7%  2571  921s
  5526  2019 -142.27977   18  477 -4296.4118 -142.27977  96.7%  2573  931s
  5542  2025 -142.27977   19  446 -4296.4118 -142.27977  96.7%  2593  949s
  5560  2015 -142.27977   20  449 -4296.4118 -142.27977  96.7%  2612  965s
  5592  2016 -1262.5808   21  368 -4296.4118 -142.27977  96.7%  2627  979s
  5637  2025 -1365.1634   22  360 -4296.4118 -142.27977  96.7%  2663  995s
  5679  2047 -1664.9963   23  397 -4296.4118 -142.27977  96.7%  2671 1008s
  5723  2038 -2499.9979   24  419 -4296.4118 -142.27977  96.7%  2688 1020s
  5791  2036 -2652.2267   25  415 -4296.4118 -142.27977  96.7%  2696 1031s
  5860  2041     cutoff   25      -4296.4118 -142.27977  96.7%  2704 1041s
  5930  2049 -3964.9989   28  277 -4296.4118 -142.27977  96.7%  2706 1052s
  6005  2041 -4206.5558   30  163 -4296.4118 -142.27977  96.7%  2704 1061s
  6044  2047     cutoff   31      -4296.4118 -142.27977  96.7%  2700 1078s
  6084  2055 -3242.3835   25  515 -4296.4118 -142.27977  96.7%  2700 1090s
  6133  2052 -3244.4195   26  516 -4296.4118 -142.27977  96.7%  2696 1099s
  6189  2039 -3327.9902   27  501 -4296.4118 -142.27977  96.7%  2693 1110s
  6249  2039 -3339.5822   28  496 -4296.4118 -142.27977  96.7%  2686 1119s
  6300  2035 -3511.8743   29  479 -4296.4118 -142.27977  96.7%  2685 1128s
  6357  2020     cutoff   30      -4296.4118 -142.27977  96.7%  2680 1138s
  6418  1999 -2472.4383   24  364 -4296.4118 -142.27977  96.7%  2677 1148s
  6484  1996 -3406.2525   25  365 -4296.4118 -142.27977  96.7%  2674 1160s
  6548  1987     cutoff   26      -4296.4118 -142.27977  96.7%  2665 1175s
  6612  1987 -3717.5341   26  354 -4296.4118 -142.27977  96.7%  2661 1187s
  6682  1982 -3800.1874   27  357 -4296.4118 -142.27977  96.7%  2654 1197s
  6753  1966     cutoff   28      -4296.4118 -142.27977  96.7%  2649 1208s
  6845  1923 -2340.4134   32  386 -4296.4118 -142.27977  96.7%  2642 1220s
  6948  1879 -2384.5034   33  379 -4296.4118 -142.27977  96.7%  2627 1231s
  7037  1837 -2399.7111   34  325 -4296.4118 -142.27977  96.7%  2618 1244s
  7143  1796 -2510.5509   35  435 -4296.4118 -381.03414  91.1%  2604 1256s
  7257  1730 -2663.9347   36  436 -4296.4118 -381.03414  91.1%  2590 1269s
  7401  1676     cutoff   36      -4296.4118 -381.03414  91.1%  2562 1281s
  7517  1597 -2723.3633   38  303 -4296.4118 -381.03414  91.1%  2555 1294s
  7697  1504 -3011.2385   39  306 -4296.4118 -381.03414  91.1%  2522 1307s
  7887  1402 -3093.5264   40  306 -4296.4118 -1030.4305  76.0%  2485 1318s
  8101  1316     cutoff   42      -4296.4118 -2127.1199  50.5%  2444 1329s
  8321  1161     cutoff   33      -4296.4118 -2409.7801  43.9%  2403 1340s
  8607   993     cutoff   42      -4296.4118 -2774.8812  35.4%  2346 1348s
  8765   916 -3891.5891   46  281 -4296.4118 -2779.1892  35.3%  2313 1358s
  8804   902 -3893.5417   47  277 -4296.4118 -3173.5458  26.1%  2305 1365s
  8821   891 -3900.9850   48  269 -4296.4118 -3338.5098  22.3%  2303 1373s
  8858   876 -4275.5016   55  203 -4296.4118 -3980.6911  7.35%  2295 1380s

Cutting planes:
  Gomory: 1
  MIR: 492
  Flow cover: 1492
  Zero half: 4
  RLT: 12
  Relax-and-lift: 83

Explored 8866 nodes (20542193 simplex iterations) in 1380.14 seconds (3851.49 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -4296.41 -4297.19 -4308.16 ... -20885.3
No other solutions better than -4296.41

Optimal solution found (tolerance 1.00e-04)
Best objective -4.296411784230e+03, best bound -4.296411784230e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1380.16s
  Master Objective (UB) = -4296.41, θ = 116909.74
  Upper Bound (UB) = -4296.41

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 116909.74
  [DEBUG]   ✓ Scenario 0: θ = 116909.74 ≤ Q = 116909.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 116909.74 ≤ Q = 116909.74 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 116909.74 ≤ Q = 116909.74 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 116909.74 ≤ Q = 116909.74 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 116909.74 ≤ Q = 116909.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 116909.74 ≤ Q = 116909.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 116909.74 ≤ Q = 116909.74 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x5313a55e
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x5313a55e
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-01, 2e+02]
Found heuristic solution: objective 1.293740e+13
Presolve removed 2592 rows and 1886 columns
Presolve time: 0.00s
Presolved: 501 rows, 503 columns, 1412 nonzeros
Found heuristic solution: objective 7005243.0121
Variable types: 339 continuous, 164 integer (164 binary)

Root relaxation: objective -1.164367e+05, 299 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -116436.71    0  121 7005243.01 -116436.71   102%     -    0s
H    0     0                    -81165.05790 -116436.71  43.5%     -    0s
H    0     0                    -82802.11880 -116436.71  40.6%     -    0s
     0     0 -89089.729    0   40 -82802.119 -89089.729  7.59%     -    0s
H    0     0                    -88390.82839 -89033.500  0.73%     -    0s
     0     0 -88873.718    0   34 -88390.828 -88873.718  0.55%     -    0s
     0     0 -88776.919    0   18 -88390.828 -88776.919  0.44%     -    0s
H    0     0                    -88597.36761 -88766.774  0.19%     -    0s
H    0     0                    -88618.67217 -88766.774  0.17%     -    0s
     0     0 -88764.363    0   22 -88618.672 -88764.363  0.16%     -    0s
     0     0 -88739.556    0   14 -88618.672 -88739.556  0.14%     -    0s
     0     0 -88737.879    0   14 -88618.672 -88737.879  0.13%     -    0s
     0     0 -88737.140    0   14 -88618.672 -88737.140  0.13%     -    0s
     0     0 -88735.282    0   12 -88618.672 -88735.282  0.13%     -    0s
     0     0 -88734.138    0   12 -88618.672 -88734.138  0.13%     -    0s
     0     0          -    0      -88618.672 -88626.226  0.01%     -    0s

Cutting planes:
  Gomory: 8
  Implied bound: 8
  MIR: 110
  Flow cover: 5
  RLT: 18

Explored 1 nodes (541 simplex iterations) in 0.03 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 7: -88618.7 -88597.4 -88390.8 ... 1.29374e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -8.861867216743e+04, best bound -8.862622640169e+04, gap 0.0085%
  Subproblem solved in 0.04s
  Worst-case operational profit (Z_SP) = 112287.37
  Scenario: 14 demand increases, 46 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -88618.67
  [DEBUG]   S×d_nominal = 200906.04
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 200906.04 + -88618.67 = 112287.37
  [DEBUG]   Current θ from Master = 116909.74
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4622.37 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -8918.78
  Lower Bound (LB) = -5399.73
  Gap (UB-LB) = 1103.3181, Absolute Gap = 1103.3181, Relative Gap = 0.256800
  Not converged yet (gap = 1103.32 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 14 increases, 46 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351415 nonzeros
Model fingerprint: 0x275b8408
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 55044 rows and 22354 columns
Presolve time: 1.11s
Presolved: 68659 rows, 29826 columns, 427459 nonzeros
Variable types: 27567 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -410141.1274
Found heuristic solution: objective -211458.2747

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 68659 rows, 29826 columns, 427459 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   35729   -3.0084877e+04   0.000000e+00   5.985439e+06      5s
   47188    2.0922391e+02   0.000000e+00   9.789120e+06     10s
   53599    1.0123590e+03   0.000000e+00   1.043118e+07     15s
   60816    3.6386146e+03   0.000000e+00   1.300996e+06     20s
   67246    4.2801189e+03   0.000000e+00   3.447833e+07     25s
   75116    7.8959438e+03   0.000000e+00   9.549131e+06     30s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 1.241465e+04, 58365 iterations, 29.84 seconds (64.77 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 12414.6463    0  347 -211458.27 12414.6463   106%     -   31s
H    0     0                    -199177.5263 12414.6463   106%     -   31s
H    0     0                    -77283.42459 12414.6463   116%     -   31s
H    0     0                    -52310.89047 12414.6463   124%     -   31s
H    0     0                    -43356.84371 12414.6463   129%     -   31s
H    0     0                    -29046.58566 12414.6463   143%     -   31s
H    0     0                    -12926.15006 12414.6463   196%     -   33s
H    0     0                    -12335.95335 12414.6463   201%     -   33s
H    0     0                    -12144.61584 12414.6463   202%     -   33s
     0     0 7963.17236    0  445 -12144.616 7963.17236   166%     -   49s
H    0     0                    -12066.97661 7963.17236   166%     -   49s
H    0     0                    -12050.18964 7963.17236   166%     -   49s
     0     0 7963.17236    0  435 -12050.190 7963.17236   166%     -   53s
     0     0 7963.17236    0  436 -12050.190 7963.17236   166%     -   55s
     0     0 7963.17236    0  431 -12050.190 7963.17236   166%     -   55s
     0     0 7963.17236    0  439 -12050.190 7963.17236   166%     -   56s
     0     0 6821.06241    0  441 -12050.190 6821.06241   157%     -   57s
     0     0 6821.06241    0  444 -12050.190 6821.06241   157%     -   57s
     0     0 6821.06241    0  446 -12050.190 6821.06241   157%     -   58s
     0     0 6821.06241    0  437 -12050.190 6821.06241   157%     -   58s
     0     0 6821.06241    0  441 -12050.190 6821.06241   157%     -   58s
     0     0 6821.06241    0  441 -12050.190 6821.06241   157%     -   58s
     0     0 6821.06241    0  416 -12050.190 6821.06241   157%     -   67s
H    0     0                    -9886.364290 6821.06241   169%     -   67s
H    0     0                    -5884.786169 6821.06241   216%     -   67s
     0     0 6435.87968    0  379 -5884.7862 6435.87968   209%     -   75s
     0     0 6323.72455    0  393 -5884.7862 6323.72455   207%     -   78s
     0     0 6310.07814    0  399 -5884.7862 6310.07814   207%     -   78s
     0     0 6309.84621    0  398 -5884.7862 6309.84621   207%     -   79s
H    0     0                    -4816.959856 6309.84621   231%     -   81s
H    0     0                    -4758.323318 6309.84621   233%     -   81s
H    0     0                    -4689.185101 6309.84621   235%     -   81s
H    0     0                    -4467.227282 5759.17389   229%     -   86s
H    0     0                    -4408.915524 5759.17389   231%     -   86s
     0     0 5759.17389    0  438 -4408.9155 5759.17389   231%     -   86s
     0     0 5296.43066    0  489 -4408.9155 5296.43066   220%     -   91s
     0     0 5038.74819    0  487 -4408.9155 5038.74819   214%     -   94s
     0     0 4892.57685    0  501 -4408.9155 4892.57685   211%     -   96s
     0     0 4830.12333    0  564 -4408.9155 4830.12333   210%     -   99s
H    0     0                    -4396.141230 4799.91327   209%     -  100s
H    0     0                    -4395.367208 4799.91327   209%     -  100s
     0     0 4799.91327    0  556 -4395.3672 4799.91327   209%     -  100s
     0     0 4771.66783    0  556 -4395.3672 4771.66783   209%     -  101s
     0     0 4760.27665    0  558 -4395.3672 4760.27665   208%     -  102s
     0     0 4759.88662    0  556 -4395.3672 4759.88662   208%     -  102s
     0     0 4390.78948    0  527 -4395.3672 4390.78948   200%     -  109s
     0     0 4256.30609    0  462 -4395.3672 4256.30609   197%     -  113s
     0     0 4138.31123    0  541 -4395.3672 4138.31123   194%     -  115s
     0     0 4084.01963    0  469 -4395.3672 4084.01963   193%     -  117s
     0     0 4065.07263    0  551 -4395.3672 4065.07263   192%     -  119s
     0     0 4054.28284    0  469 -4395.3672 4054.28284   192%     -  120s
     0     0 4048.69163    0  560 -4395.3672 4048.69163   192%     -  121s
     0     0 4043.23172    0  474 -4395.3672 4043.23172   192%     -  121s
     0     0 4040.34453    0  482 -4395.3672 4040.34453   192%     -  122s
     0     0 4039.43906    0  485 -4395.3672 4039.43906   192%     -  122s
     0     0 3817.82764    0  566 -4395.3672 3817.82764   187%     -  126s
     0     0 3775.66679    0  555 -4395.3672 3775.66679   186%     -  127s
     0     0 3757.73242    0  557 -4395.3672 3757.73242   185%     -  128s
     0     0 3755.81477    0  575 -4395.3672 3755.81477   185%     -  128s
     0     0 3750.36524    0  568 -4395.3672 3750.36524   185%     -  129s
     0     0 3747.52907    0  555 -4395.3672 3747.52907   185%     -  129s
     0     0 3745.78375    0  561 -4395.3672 3745.78375   185%     -  129s
     0     0 3745.41622    0  564 -4395.3672 3745.41622   185%     -  130s
     0     0 3598.99104    0  551 -4395.3672 3598.99104   182%     -  133s
     0     0 3557.98663    0  558 -4395.3672 3557.98663   181%     -  141s
     0     0 3516.23101    0  577 -4395.3672 3516.23101   180%     -  143s
     0     0 3503.44244    0  569 -4395.3672 3503.44244   180%     -  144s
     0     0 3498.65292    0  574 -4395.3672 3498.65292   180%     -  144s
     0     0 3497.61310    0  576 -4395.3672 3497.61310   180%     -  144s
     0     0 3442.72113    0  590 -4395.3672 3442.72113   178%     -  147s
     0     0 3434.64688    0  592 -4395.3672 3434.64688   178%     -  148s
     0     0 3430.41399    0  591 -4395.3672 3430.41399   178%     -  148s
     0     0 3427.17026    0  597 -4395.3672 3427.17026   178%     -  149s
     0     0 3422.45168    0  589 -4395.3672 3422.45168   178%     -  149s
     0     0 3418.23362    0  589 -4395.3672 3418.23362   178%     -  150s
     0     0 3415.79103    0  594 -4395.3672 3415.79103   178%     -  150s
     0     0 3415.16634    0  595 -4395.3672 3415.16634   178%     -  150s
     0     0 3391.14631    0  611 -4395.3672 3391.14631   177%     -  152s
     0     0 3375.32380    0  602 -4395.3672 3375.32380   177%     -  154s
     0     0 3369.42162    0  607 -4395.3672 3369.42162   177%     -  154s
     0     0 3367.64136    0  601 -4395.3672 3367.64136   177%     -  155s
     0     0 3366.47388    0  608 -4395.3672 3366.47388   177%     -  155s
     0     0 3365.56886    0  604 -4395.3672 3365.56886   177%     -  155s
     0     0 3350.32476    0  603 -4395.3672 3350.32476   176%     -  157s
     0     0 3347.21532    0  606 -4395.3672 3347.21532   176%     -  159s
     0     0 3346.77332    0  609 -4395.3672 3346.77332   176%     -  159s
     0     0 3340.96198    0  519 -4395.3672 3340.96198   176%     -  161s
     0     0 3340.33214    0  613 -4395.3672 3340.33214   176%     -  163s
     0     0 3339.02996    0  615 -4395.3672 3339.02996   176%     -  165s
     0     0 3338.51848    0  526 -4395.3672 3338.51848   176%     -  165s
     0     0 3336.04312    0  537 -4395.3672 3336.04312   176%     -  167s
     0     0 3285.64817    0  650 -4395.3672 3285.64817   175%     -  170s
     0     0 3276.29018    0  613 -4395.3672 3276.29018   175%     -  171s
     0     0 3275.08713    0  621 -4395.3672 3275.08713   175%     -  172s
     0     0 3274.48619    0  618 -4395.3672 3274.48619   174%     -  172s
     0     0 3257.91824    0  614 -4395.3672 3257.91824   174%     -  176s
     0     0 3254.64395    0  615 -4395.3672 3254.64395   174%     -  176s
     0     0 3252.64267    0  613 -4395.3672 3252.64267   174%     -  177s
     0     0 3249.99331    0  619 -4395.3672 3249.99331   174%     -  177s
     0     0 3249.00049    0  611 -4395.3672 3249.00049   174%     -  178s
     0     0 3238.24375    0  611 -4395.3672 3238.24375   174%     -  180s
     0     0 3235.33455    0  615 -4395.3672 3235.33455   174%     -  214s
     0     0 3234.29029    0  608 -4395.3672 3234.29029   174%     -  215s
     0     0 3229.92878    0  613 -4395.3672 3229.92878   173%     -  216s
     0     0 3229.23340    0  623 -4395.3672 3229.23340   173%     -  218s
     0     0 3222.27481    0  610 -4395.3672 3222.27481   173%     -  220s
     0     0 3219.60998    0  610 -4395.3672 3219.60998   173%     -  221s
     0     0 3218.81701    0  617 -4395.3672 3218.81701   173%     -  221s
     0     0 3168.58603    0  578 -4395.3672 3168.58603   172%     -  224s
     0     0 3165.57665    0  588 -4395.3672 3165.57665   172%     -  225s
     0     0 3161.61088    0  593 -4395.3672 3161.61088   172%     -  225s
     0     0 3159.16502    0  591 -4395.3672 3159.16502   172%     -  225s
     0     0 3158.32656    0  598 -4395.3672 3158.32656   172%     -  226s
     0     0 3149.13976    0  595 -4395.3672 3149.13976   172%     -  227s
     0     0 3143.49536    0  599 -4395.3672 3143.49536   172%     -  228s
     0     0 3141.93789    0  600 -4395.3672 3141.93789   171%     -  228s
     0     0 3140.44828    0  601 -4395.3672 3140.44828   171%     -  229s
     0     0 3139.40038    0  611 -4395.3672 3139.40038   171%     -  229s
     0     0 3134.43124    0  608 -4395.3672 3134.43124   171%     -  230s
     0     0 3133.31934    0  607 -4395.3672 3133.31934   171%     -  231s
     0     0 3131.49638    0  613 -4395.3672 3131.49638   171%     -  232s
     0     0 3130.05533    0  609 -4395.3672 3130.05533   171%     -  233s
     0     0 3129.72337    0  614 -4395.3672 3129.72337   171%     -  233s
     0     0 3129.53620    0  611 -4395.3672 3129.53620   171%     -  234s
     0     0 3129.20270    0  611 -4395.3672 3129.20270   171%     -  236s
     0     2 3129.14149    0  611 -4395.3672 3129.14149   171%     -  261s
     3     8 3034.66938    2  578 -4395.3672 3055.07266   170%  2603  268s
     7    16 2785.62613    3  565 -4395.3672 3033.96653   169%  3539  272s
    15    32 2653.43836    4  586 -4395.3672 2787.64959   163%  4308  280s
    31    48 1539.78232    5  431 -4395.3672 2652.94778   160%  7126  339s
    47    80 1749.19896    6  549 -4395.3672 2652.94778   160%  6885  345s
    79   155 1728.88680    7  546 -4395.3672 2652.94778   160%  5560  360s
   156   269 1574.22817    9  510 -4395.3672 2652.94778   160%  3489  367s
   276   333 1627.84254   10  510 -4395.3672 2652.94778   160%  2551  374s
   362   374     cutoff   10      -4395.3672 2652.94778   160%  2320  382s
   451   380     cutoff   10      -4395.3672 2652.94778   160%  2119  390s
   531   383 1374.51748   11  501 -4395.3672 2652.94778   160%  2012  397s
   589   400 1408.21065   11  480 -4395.3672 2652.94778   160%  1993  405s
   647   414 1058.48961   12  437 -4395.3672 2652.94778   160%  1949  412s
   709   438  683.03262   13  404 -4395.3672 2652.94778   160%  1922  421s
   781   480  524.04697   15  443 -4395.3672 2652.94778   160%  1900  428s
   847   532  210.23261   18  275 -4395.3672 2652.94778   160%  1895  435s
   915   575 -235.83654   20  277 -4395.3672 2652.94778   160%  1883  444s
   986   620 -1541.8409   19  149 -4395.3672 2652.94778   160%  1878  451s
  1069   665 -346.15909   21  198 -4395.3672 2652.94778   160%  1851  459s
  1137   699     cutoff   22      -4395.3672 2652.94778   160%  1817  467s
  1230   741 -960.57806   21  262 -4395.3672 2652.94778   160%  1779  475s
  1310   769 -1354.8559   23  204 -4395.3672 2652.94778   160%  1777  483s
  1392   814     cutoff   25      -4395.3672 2652.94778   160%  1774  491s
  1475   842 -1529.7924   27  291 -4395.3672 2652.94778   160%  1789  497s
  1529   871 -1877.3191   28  248 -4395.3672 2652.94778   160%  1779  506s
  1588   911 -2523.7031   29  318 -4395.3672 2652.94778   160%  1782  514s
  1664   959 -4086.2676   28  122 -4395.3672 2652.94778   160%  1789  522s
  1771  1004 -2885.1553   30  271 -4395.3672 2652.94778   160%  1766  532s
  1887  1057 -3393.3563   32  235 -4395.3672 2652.94778   160%  1748  541s
  2025  1095     cutoff   37      -4395.3672 2652.94778   160%  1724  552s
  2171  1120     cutoff   10      -4395.3672 2587.03719   159%  1710  562s
  2264  1181     cutoff   11      -4395.3672 2587.03719   159%  1708  573s
  2405  1212 -738.86893    9  414 -4395.3672 2587.03719   159%  1691  583s
  2544  1265 -2175.7941   10  322 -4395.3672 2587.03719   159%  1686  595s
  2651  1324 -2268.4402   12  294 -4395.3672 2587.03719   159%  1707  607s
  2801  1411 -2773.4094   15  290 -4395.3672 2408.51388   155%  1704  618s
  2984  1435 -3078.7877   19  406 -4395.3672 1997.99179   145%  1696  625s
  3022  1474 -3333.0416   20  188 -4395.3672 1647.24487   137%  1707  636s
  3094  1504 -3370.0298   21  411 -4395.3672 1647.24487   137%  1703  646s
  3213  1553 -3560.4757   24  173 -4395.3672 1647.24487   137%  1698  658s
  3363  1629  385.50939   10  328 -4395.3672 1647.24487   137%  1701  671s
  3510  1710 infeasible   12      -4395.3672 1546.93614   135%  1718  686s
  3683  1740 -988.63840   11  214 -4395.3672 1546.93614   135%  1735  700s
  3873  1787 infeasible   16      -4395.3672 1460.86234   133%  1741  714s
  4070  1828     cutoff   19      -4395.3672 1422.02406   132%  1753  732s
  4277  1854     cutoff   23      -4395.3672 1398.73818   132%  1767  748s
  4511  1914 -3400.7672   14  366 -4395.3672 1398.73818   132%  1767  767s
  4727  1942 -4211.0863   17  364 -4395.3672 1337.51426   130%  1781  781s
  4789  1971     cutoff   18      -4395.3672 1337.51426   130%  1791  797s
  4886  2016     cutoff   19      -4395.3672 1337.51426   130%  1802  810s
  5042  2067 -2161.5750    8  330 -4395.3672 1254.16686   129%  1802  830s
  5229  2143 -3129.6534    9  341 -4395.3672 1254.16686   129%  1805  849s
  5485  2220     cutoff   10      -4395.3672 1157.86657   126%  1805  870s
  5771  2270 infeasible    9      -4395.3672 1080.36767   125%  1801  889s
  6040  2353 -2931.7594    9  196 -4395.3672  937.96067   121%  1809  913s
  6364  2484 -3804.1435   14  209 -4395.3672  766.12349   117%  1813  934s
  6804  2485 -1101.2550   16  611 -4395.3672  766.12349   117%  1788 1092s
  6806  2486 -3570.0588   30  347 -4395.3672  766.12349   117%  1787 1130s
  6807  2487 -1157.4628   12  497 -4395.3672  766.12349   117%  1787 1151s
  6808  2488 -3786.3182   34  502 -4395.3672  766.12349   117%  1787 1162s
  6809  2488 -644.38262   13  526 -4395.3672  766.12349   117%  1787 1169s
  6810  2489 -3156.8131   41  479 -4395.3672  766.12349   117%  1786 1175s
  6812  2490 -2810.2981   34  619 -4395.3672  766.12349   117%  1786 1185s
  6814  2492 -3332.6740   25  552 -4395.3672  766.12349   117%  1785 1191s
  6817  2494 -1327.4202   14  591 -4395.3672  766.12349   117%  1785 1196s
  6819  2495 -2123.9092   25  587 -4395.3672  766.12349   117%  1784 1200s
  6820  2496 -2808.0797   36  561 -4395.3672  766.12349   117%  1784 1207s
  6823  2498 -1487.9927   16  632 -4395.3672  766.12349   117%  1783 1213s
  6824  2498  -29.06468    8  571 -4395.3672  766.12349   117%  1783 1219s
  6825  2499 -1865.0777   19  566 -4395.3672  766.12349   117%  1783 1221s
  6828  2501 -2327.9973   21  557 -4395.3672  766.12349   117%  1782 1227s
  6829  2502 -2329.5300   19  552 -4395.3672  766.12349   117%  1781 1232s
  6830  2502 -3284.2341   41  557 -4395.3672  766.12349   117%  1781 1235s
  6832  2504 -3861.2834   29  549 -4395.3672  766.12349   117%  1781 1246s
  6834  2505 -3754.2742   18  612 -4395.3672  766.12349   117%  1780 1260s
  6837  2507 -2721.9170   24  551 -4395.3672  766.12349   117%  1779 1269s
  6838  2508 -1310.1036   19  558 -4395.3672  766.12349   117%  1779 1271s
  6839  2508 -771.99619   10  562 -4395.3672  766.12349   117%  1779 1277s
  6840  2509 -197.36415   17  567 -4395.3672  766.12349   117%  1779 1280s
  6841  2510 -877.26588   11  558 -4395.3672  766.12349   117%  1778 1285s
  6843  2511 -2333.5675   27  587 -4395.3672  766.12349   117%  1778 1291s
  6844  2512 -3358.9204   34  587 -4395.3672  766.12349   117%  1778 1331s
  6845  2512 -957.23792   15  587 -4395.3672  766.12349   117%  1777 1358s
  6846  2516  766.12349   15  548 -4395.3672  766.12349   117%  1810 1406s
  6848  2519  766.12349   16  546 -4395.3672  766.12349   117%  1811 1426s
  6852  2526  766.12349   17  555 -4395.3672  766.12349   117%  1814 1439s
  6860  2539  766.12349   18  545 -4395.3672  766.12349   117%  1817 1451s
  6876  2549  766.12349   19  536 -4395.3672  766.12349   117%  1843 1480s
  6895  2560  766.12349   20  593 -4395.3672  766.12349   117%  1857 1495s
  6927  2625  766.12349   21  540 -4395.3672  766.12349   117%  1887 1512s
  7023  2644  766.12349   22  544 -4395.3672  766.12349   117%  1938 1526s
  7103  2630  766.12349   23  452 -4395.3672  766.12349   117%  1959 1540s
  7168  2623  233.66667   24  476 -4395.3672  766.12349   117%  1977 1557s
  7235  2614  199.03799   24  366 -4395.3672  766.12349   117%  1985 1566s
  7283  2617  188.71545   25  366 -4395.3672  766.12349   117%  2004 1575s
  7325  2621   69.70117   26  373 -4395.3672  766.12349   117%  2021 1588s
  7385  2613 -125.53424   27  342 -4395.3672  766.12349   117%  2028 1597s
  7438  2618 -375.01585   28  335 -4395.3672  766.12349   117%  2047 1610s
  7497  2620 -2799.4514   28  172 -4395.3672  766.12349   117%  2060 1621s
  7572  2633     cutoff   29      -4395.3672  766.12349   117%  2076 1629s
  7644  2638 -1133.1678   32  170 -4395.3672  766.12349   117%  2093 1645s
  7730  2618 -1592.0938   33  172 -4395.3672  766.12349   117%  2096 1656s
  7820  2608 -1757.8536   34  496 -4395.3672  766.12349   117%  2108 1667s
  7904  2592 -1822.6117   35  453 -4395.3672  766.12349   117%  2118 1679s
  7978  2595     cutoff   35      -4395.3672  766.12349   117%  2131 1695s
  8049  2591 -1907.0929   37  242 -4395.3672  766.12349   117%  2151 1713s
  8125  2602     cutoff   38      -4395.3672  766.12349   117%  2169 1725s
  8210  2613 infeasible   40      -4395.3672  766.12349   117%  2192 1737s
  8275  2605     cutoff   41      -4395.3672  766.12349   117%  2213 1752s
  8382  2579 -3726.5255   45  307 -4395.3672  766.12349   117%  2228 1764s
  8498  2580 -1187.5114   28  483 -4395.3672  766.12349   117%  2246 1780s
  8617  2571 -1524.3600   30  353 -4395.3672  766.12349   117%  2264 1797s
  8742  2538 -2108.8239   33  334 -4395.3672  766.12349   117%  2281 1809s
  8792  2548 -2493.0989   34  157 -4395.3672   -1.48334   100%  2297 1821s
  8882  2554 -2872.0439   35  219 -4395.3672 -136.13900  96.9%  2307 1838s
  8989  2581 -3944.2613   38  235 -4395.3672 -136.13900  96.9%  2316 1854s
  9145  2585 -1314.4782   22  243 -4395.3672 -523.85107  88.1%  2328 1873s
  9307  2569 -2863.9243   26  270 -4395.3672 -655.69541  85.1%  2340 1888s
  9474  2521 -3116.1196   30  271 -4395.3672 -707.72809  83.9%  2354 1904s
  9640  2501 -4140.7727   37  114 -4395.3672 -767.76507  82.5%  2372 1921s
  9822  2456 -2703.1884   29  410 -4395.3672 -767.76507  82.5%  2390 1939s
 10038  2383 -3710.1550   32  407 -4395.3672 -1085.8436  75.3%  2402 1957s
 10254  2339     cutoff   34      -4395.3672 -1085.8436  75.3%  2409 1975s
 10488  2271 -3389.2165   26  426 -4395.3672 -1218.7963  72.3%  2405 1995s
 10743  2189 -4111.7595   31  342 -4395.3672 -1367.7744  68.9%  2411 2017s
 11014  2101 -2077.8473   33  230 -4395.3672 -1460.7385  66.8%  2414 2037s
 11206  1998 -2922.9734   39  282 -4395.3672 -1688.6340  61.6%  2432 2058s
 11510  1817 -4190.6480   26  172 -4395.3672 -1879.5234  57.2%  2430 2081s
 11856  1590 -3140.2213   23  530 -4395.3672 -2203.2486  49.9%  2421 2105s
 12257  1287     cutoff   34      -4395.3672 -2400.1615  45.4%  2408 2124s
 12772   680 -4169.3778   45  180 -4395.3672 -2421.0208  44.9%  2375 2141s
 13485   315 -4158.8326   25  431 -4395.3672 -3080.3280  29.9%  2298 2160s
 13656   242     cutoff   33      -4395.3672 -3538.1098  19.5%  2280 2168s

Cutting planes:
  Gomory: 2
  Implied bound: 66
  Projected implied bound: 7
  MIR: 562
  Flow cover: 2168
  Zero half: 1
  RLT: 8
  Relax-and-lift: 103

Explored 13700 nodes (31451100 simplex iterations) in 2168.47 seconds (5951.45 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -4395.37 -4396.14 -4408.92 ... -12050.2
No other solutions better than -4395.37

Optimal solution found (tolerance 1.00e-04)
Best objective -4.395367207764e+03, best bound -4.395367207764e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2168.53s
  Master Objective (UB) = -4395.37, θ = 116688.61
  Upper Bound (UB) = -4395.37

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 116688.61
  [DEBUG]   ✓ Scenario 0: θ = 116688.61 ≤ Q = 116688.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 116688.61 ≤ Q = 116688.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 116688.61 ≤ Q = 116688.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 116688.61 ≤ Q = 116688.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 116688.61 ≤ Q = 116688.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 116688.61 ≤ Q = 116688.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 116688.61 ≤ Q = 116730.71 (slack: 42.10)
  [DEBUG]   ✓ Scenario 7: θ = 116688.61 ≤ Q = 116688.61 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0xf9c0122
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xf063fede
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-01, 2e+02]
Found heuristic solution: objective 1.299970e+13
Presolve removed 2592 rows and 1886 columns
Presolve time: 0.00s
Presolved: 501 rows, 503 columns, 1412 nonzeros
Found heuristic solution: objective 7051692.7350
Variable types: 339 continuous, 164 integer (164 binary)

Root relaxation: objective -1.166251e+05, 303 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -116625.06    0  121 7051692.74 -116625.06   102%     -    0s
H    0     0                    -81417.84641 -116625.06  43.2%     -    0s
H    0     0                    -83023.25264 -116625.06  40.5%     -    0s
     0     0 -89746.494    0   50 -83023.253 -89746.494  8.10%     -    0s
H    0     0                    -88051.20167 -89728.287  1.90%     -    0s
H    0     0                    -88094.62004 -89728.287  1.85%     -    0s
H    0     0                    -88622.72556 -89728.287  1.25%     -    0s
H    0     0                    -88666.14394 -89728.287  1.20%     -    0s
     0     0 -89535.943    0   43 -88666.144 -89535.943  0.98%     -    0s
     0     0 -89326.959    0   18 -88666.144 -89326.959  0.75%     -    0s
H    0     0                    -88963.23745 -89326.959  0.41%     -    0s
H    0     0                    -88971.58987 -89326.959  0.40%     -    0s
     0     0 -89133.957    0   14 -88971.590 -89133.957  0.18%     -    0s
     0     0 -89096.144    0   15 -88971.590 -89096.144  0.14%     -    0s
     0     0 -89085.050    0   14 -88971.590 -89085.050  0.13%     -    0s
     0     0 -89079.935    0   14 -88971.590 -89079.935  0.12%     -    0s
     0     0 -89077.612    0   14 -88971.590 -89077.612  0.12%     -    0s
     0     0 -89076.557    0   14 -88971.590 -89076.557  0.12%     -    0s
     0     0 -89076.503    0   14 -88971.590 -89076.503  0.12%     -    0s
     0     0 -89019.561    0    6 -88971.590 -89019.561  0.05%     -    0s
     0     0 -88995.363    0    7 -88971.590 -88995.363  0.03%     -    0s
H    0     0                    -88973.88284 -88995.363  0.02%     -    0s

Cutting planes:
  Gomory: 2
  Implied bound: 3
  MIR: 2
  RLT: 2
  Relax-and-lift: 2

Explored 1 nodes (628 simplex iterations) in 0.05 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -88973.9 -88971.6 -88927.4 ... 1.29997e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -8.897388284333e+04, best bound -8.898139606955e+04, gap 0.0084%
  Subproblem solved in 0.06s
  Worst-case operational profit (Z_SP) = 111932.16
  Scenario: 18 demand increases, 42 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -88973.88
  [DEBUG]   S×d_nominal = 200906.04
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 200906.04 + -88973.88 = 111932.16
  [DEBUG]   Current θ from Master = 116688.61
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4756.45 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -9151.81
  Lower Bound (LB) = -5399.73
  Gap (UB-LB) = 1004.3627, Absolute Gap = 1004.3627, Relative Gap = 0.228505
  Not converged yet (gap = 1004.36 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 18 increases, 42 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394652 nonzeros
Model fingerprint: 0x53fc8c08
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 61952 rows and 25162 columns
Presolve time: 1.19s
Presolved: 77041 rows, 33258 columns, 472919 nonzeros
Variable types: 30999 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -410141.1274
Found heuristic solution: objective -405176.3109
Found heuristic solution: objective -211458.2747

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 77041 rows, 33258 columns, 472919 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   38219   -4.8839307e+04   0.000000e+00   7.628726e+08      5s
   49433   -1.1254705e+04   0.000000e+00   2.424665e+08     10s
   57813    1.2933896e+02   0.000000e+00   2.485219e+06     15s
   63556    1.0290741e+03   0.000000e+00   6.461070e+07     20s
   70688    5.4519445e+03   0.000000e+00   8.390274e+05     25s
   76682    6.1551550e+03   0.000000e+00   2.430734e+06     30s
Concurrent spin time: 0.80s

Solved with dual simplex

Root relaxation: objective 1.242213e+04, 52880 iterations, 30.58 seconds (63.05 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 12422.1283    0  413 -211458.27 12422.1283   106%     -   32s
H    0     0                    -207203.4283 12422.1283   106%     -   32s
H    0     0                    -42616.02667 12422.1283   129%     -   32s
H    0     0                    -16044.61378 12422.1283   177%     -   32s
H    0     0                    -15848.40083 12422.1283   178%     -   32s
H    0     0                    -15827.69812 12422.1283   178%     -   32s
H    0     0                    -7234.520077 12422.1283   272%     -   34s
H    0     0                    -7162.044469 12422.1283   273%     -   34s
H    0     0                    -7144.183205 12422.1283   274%     -   34s
     0     0 8068.52006    0  502 -7144.1832 8068.52006   213%     -   48s
H    0     0                    -6757.553057 8068.52006   219%     -   48s
H    0     0                    -6360.174457 8068.52006   227%     -   49s
     0     0 7867.39392    0  468 -6360.1745 7867.39392   224%     -   54s
     0     0 7867.39392    0  504 -6360.1745 7867.39392   224%     -   57s
     0     0 7867.39392    0  505 -6360.1745 7867.39392   224%     -   59s
     0     0 7867.39392    0  496 -6360.1745 7867.39392   224%     -   61s
     0     0 7867.39392    0  487 -6360.1745 7867.39392   224%     -   61s
     0     0 7867.39392    0  499 -6360.1745 7867.39392   224%     -   62s
     0     0 7865.83297    0  509 -6360.1745 7865.83297   224%     -   63s
     0     0 7865.20055    0  520 -6360.1745 7865.20055   224%     -   63s
     0     0 7865.10440    0  513 -6360.1745 7865.10440   224%     -   63s
     0     0 6614.47672    0  412 -6360.1745 6614.47672   204%     -   79s
     0     0 6368.42034    0  407 -6360.1745 6368.42034   200%     -   92s
H    0     0                    -4461.836766 6346.05023   242%     -   95s
H    0     0                    -4448.938996 6346.05023   243%     -   95s
H    0     0                    -4437.965476 6346.05023   243%     -   95s
     0     0 6346.05023    0  414 -4437.9655 6346.05023   243%     -   95s
     0     0 6333.71714    0  411 -4437.9655 6333.71714   243%     -   97s
     0     0 6330.91051    0  409 -4437.9655 6330.91051   243%     -   98s
     0     0 6328.87500    0  416 -4437.9655 6328.87500   243%     -   98s
     0     0 6327.99595    0  415 -4437.9655 6327.99595   243%     -   99s
     0     0 6307.03701    0  431 -4437.9655 6307.03701   242%     -  101s
     0     0 6305.89158    0  430 -4437.9655 6305.89158   242%     -  102s
     0     0 6298.77130    0  431 -4437.9655 6298.77130   242%     -  103s
     0     0 6298.28331    0  435 -4437.9655 6298.28331   242%     -  104s
     0     0 5527.61546    0  387 -4437.9655 5527.61546   225%     -  120s
     0     0 4938.44186    0  388 -4437.9655 4938.44186   211%     -  127s
     0     0 4597.46838    0  531 -4437.9655 4597.46838   204%     -  132s
     0     0 4544.38040    0  475 -4437.9655 4544.38040   202%     -  133s
     0     0 4484.94502    0  478 -4437.9655 4484.94502   201%     -  135s
     0     0 4439.59839    0  477 -4437.9655 4439.59839   200%     -  136s
     0     0 4425.83190    0  483 -4437.9655 4425.83190   200%     -  137s
     0     0 4398.33383    0  562 -4437.9655 4398.33383   199%     -  138s
     0     0 4355.27322    0  568 -4437.9655 4355.27322   198%     -  140s
     0     0 4345.90881    0  564 -4437.9655 4345.90881   198%     -  140s
     0     0 4342.82808    0  503 -4437.9655 4342.82808   198%     -  141s
     0     0 4331.50097    0  498 -4437.9655 4331.50097   198%     -  141s
     0     0 4331.07849    0  502 -4437.9655 4331.07849   198%     -  141s
     0     0 3775.42147    0  519 -4437.9655 3775.42147   185%     -  148s
     0     0 3594.57297    0  529 -4437.9655 3594.57297   181%     -  152s
     0     0 3522.60582    0  526 -4437.9655 3522.60582   179%     -  155s
     0     0 3437.43342    0  513 -4437.9655 3437.43342   177%     -  158s
     0     0 3422.63086    0  522 -4437.9655 3422.63086   177%     -  159s
     0     0 3407.09042    0  526 -4437.9655 3407.09042   177%     -  160s
     0     0 3372.47600    0  519 -4437.9655 3372.47600   176%     -  161s
     0     0 3365.17198    0  528 -4437.9655 3365.17198   176%     -  162s
     0     0 3361.64766    0  528 -4437.9655 3361.64766   176%     -  162s
     0     0 3357.66319    0  530 -4437.9655 3357.66319   176%     -  163s
     0     0 3346.88108    0  525 -4437.9655 3346.88108   175%     -  164s
     0     0 3346.25908    0  531 -4437.9655 3346.25908   175%     -  164s
     0     0 3271.63954    0  531 -4437.9655 3271.63954   174%     -  168s
     0     0 3244.04270    0  609 -4437.9655 3244.04270   173%     -  171s
     0     0 3216.44339    0  537 -4437.9655 3216.44339   172%     -  172s
     0     0 3212.89267    0  540 -4437.9655 3212.89267   172%     -  173s
     0     0 3212.61023    0  537 -4437.9655 3212.61023   172%     -  173s
     0     0 3089.89851    0  623 -4437.9655 3089.89851   170%     -  178s
     0     0 3067.98383    0  614 -4437.9655 3067.98383   169%     -  183s
     0     0 3055.80867    0  615 -4437.9655 3055.80867   169%     -  185s
     0     0 3050.07669    0  529 -4437.9655 3050.07669   169%     -  185s
     0     0 3032.94584    0  527 -4437.9655 3032.94584   168%     -  186s
     0     0 3030.82123    0  536 -4437.9655 3030.82123   168%     -  187s
     0     0 3030.10404    0  543 -4437.9655 3030.10404   168%     -  187s
     0     0 3006.93255    0  619 -4437.9655 3006.93255   168%     -  190s
     0     0 3000.77623    0  540 -4437.9655 3000.77623   168%     -  191s
     0     0 2999.77444    0  545 -4437.9655 2999.77444   168%     -  191s
     0     0 2985.65170    0  640 -4437.9655 2985.65170   167%     -  193s
     0     0 2980.00480    0  632 -4437.9655 2980.00480   167%     -  201s
     0     0 2977.89009    0  647 -4437.9655 2977.89009   167%     -  201s
     0     0 2976.33419    0  645 -4437.9655 2976.33419   167%     -  201s
     0     0 2975.83896    0  649 -4437.9655 2975.83896   167%     -  201s
     0     0 2958.59312    0  541 -4437.9655 2958.59312   167%     -  203s
     0     0 2946.97297    0  545 -4437.9655 2946.97297   166%     -  204s
     0     0 2942.17018    0  553 -4437.9655 2942.17018   166%     -  205s
     0     0 2941.91577    0  549 -4437.9655 2941.91577   166%     -  205s
     0     0 2914.77091    0  536 -4437.9655 2914.77091   166%     -  207s
     0     0 2912.94287    0  536 -4437.9655 2912.94287   166%     -  208s
     0     0 2909.23281    0  537 -4437.9655 2909.23281   166%     -  208s
     0     0 2908.33442    0  536 -4437.9655 2908.33442   166%     -  208s
     0     0 2899.17486    0  547 -4437.9655 2899.17486   165%     -  210s
     0     0 2898.64285    0  559 -4437.9655 2898.64285   165%     -  211s
     0     0 2892.62532    0  567 -4437.9655 2892.62532   165%     -  212s
     0     0 2891.95719    0  569 -4437.9655 2891.95719   165%     -  213s
     0     0 2887.95096    0  565 -4437.9655 2887.95096   165%     -  214s
     0     0 2886.21289    0  566 -4437.9655 2886.21289   165%     -  215s
     0     0 2885.67903    0  572 -4437.9655 2885.67903   165%     -  215s
     0     0 2883.27408    0  569 -4437.9655 2883.27408   165%     -  216s
     0     0 2883.23243    0  569 -4437.9655 2883.23243   165%     -  218s
     0     2 2883.23243    0  569 -4437.9655 2883.23243   165%     -  269s
     1     4 2709.97436    1  555 -4437.9655 2883.23243   165%  4503  272s
     3     8 2643.12341    2  568 -4437.9655 2708.34260   161%  3367  277s
     7    16 2604.36347    3  559 -4437.9655 2643.04446   160%  4677  285s
    15    28 2431.75434    4  550 -4437.9655 2604.31696   159%  6014  290s
    31    34 2073.46294    5  455 -4437.9655 2431.72376   155%  7368  308s
    43    57 -1216.3223    6  184 -4437.9655 2431.72376   155%  8629  336s
    66   104     cutoff    7      -4437.9655 2431.72376   155%  9230  348s
   125   219  357.63261    9  456 -4437.9655 2431.72376   155%  6956  360s
   248   269  327.94653   10  435 -4437.9655 2431.72376   155%  4588  369s
   314   324  161.82653   12  419 -4437.9655 2431.72376   155%  4310  377s
   383   370  -73.97236   15  430 -4437.9655 2431.72376   155%  4066  385s
   439   447 -1522.8611   17  180 -4437.9655 2431.72376   155%  3921  392s
   528   494 -2217.5419   21  155 -4437.9655 2431.72376   155%  3608  401s
   582   539 -2642.9759   25  169 -4437.9655 2431.72376   155%  3512  410s
   660   574 -2733.0098   30  154 -4437.9655 2431.72376   155%  3367  418s
   715   611 -3044.5084   35  132 -4437.9655 2431.62385   155%  3339  427s
   760   659 -3859.9911   40   97 -4437.9655 2431.62385   155%  3396  435s
   828   692     cutoff   42      -4437.9655 2431.62385   155%  3411  443s
   897   746 -482.26756    6  237 -4437.9655 2431.62385   155%  3461  452s
   973   802 -597.86628    7  238 -4437.9655 2431.62385   155%  3502  459s
  1063   836 -3863.1766    9  481 -4437.9655 2329.58519   152%  3516  467s
  1109   882 -2740.4766    7  225 -4437.9655 2329.58519   152%  3569  476s
  1183   939 -3543.7842    8  139 -4437.9655 2329.58519   152%  3551  484s
  1268   995 -1961.7501   10  294 -4437.9655 2329.58519   152%  3522  493s
  1360  1055 -3786.7999   15  273 -4437.9655 2295.16267   152%  3490  500s
  1448  1151     cutoff   15      -4437.9655 2295.16267   152%  3524  510s
  1568  1244 -4298.5593   14  255 -4437.9655 2295.16267   152%  3494  519s
  1704  1314     cutoff   14      -4437.9655 2295.16267   152%  3413  528s
  1852  1364 -4177.6118   16  323 -4437.9655 2295.16267   152%  3340  538s
  1984  1448 -4275.5365   15  113 -4437.9655 2295.16267   152%  3308  549s
  2108  1545 -1532.8577   10  333 -4437.9655 2295.16267   152%  3308  559s
  2241  1627 -1873.2162   12  248 -4437.9655 2295.16267   152%  3320  568s
  2367  1724 -3965.1323   14  133 -4437.9655 2295.16267   152%  3330  578s
  2490  1813 -2911.7793   20  216 -4437.9655 2232.71433   150%  3375  588s
  2631  1920 -3213.7541   22  259 -4437.9655 2232.71433   150%  3386  599s
  2785  1955 -1072.8376   11  336 -4437.9655 1971.14734   144%  3402  610s
  2840  2010 -1224.7054   12  325 -4437.9655 1971.14734   144%  3409  622s
  2922  2038 -1336.3366   14  405 -4437.9655 1859.10654   142%  3410  632s
  2958  2071 -1454.8852   15  394 -4437.9655 1859.10654   142%  3420  640s
  2991  2103 -1502.7396   16  403 -4437.9655 1859.10654   142%  3445  662s
  3023  2153 -1547.4865   17  317 -4437.9655 1859.10654   142%  3457  669s
  3073  2217 -1762.5377   18  403 -4437.9655 1859.10654   142%  3464  678s
  3137  2281 -2343.8413   19  189 -4437.9655 1859.10654   142%  3465  687s
  3217  2327 -2369.8182   20  181 -4437.9655 1859.10654   142%  3442  699s
  3323  2420 -2691.4370   21  187 -4437.9655 1784.60750   140%  3433  710s
  3489  2524 -2929.8060   22  182 -4437.9655 1778.65418   140%  3380  722s
  3674  2614     cutoff   23      -4437.9655 1778.65418   140%  3337  737s
  3876  2659 -3487.5472   24  169 -4437.9655 1740.34406   139%  3311  750s
  3977  2775 -3662.6699   25  166 -4437.9655 1740.34406   139%  3329  762s
  4161  2776 -3744.4234   41  569 -4437.9655 1715.24006   139%  3329  914s
  4163  2777  644.01690   11  414 -4437.9655 1715.24006   139%  3327  963s
  4164  2778  474.00659   12  456 -4437.9655 1715.24006   139%  3327  988s
  4165  2779 -3006.6790   27  395 -4437.9655 1715.24006   139%  3326 1005s
  4166  2779 -1673.4602   29  506 -4437.9655 1715.24006   139%  3325 1013s
  4167  2780 -4347.4898   59  521 -4437.9655 1715.24006   139%  3324 1021s
  4168  2781 1277.02283   11  525 -4437.9655 1715.24006   139%  3323 1027s
  4169  2781 -3214.4882   11  541 -4437.9655 1715.24006   139%  3323 1034s
  4170  2782 -3920.1558   53  459 -4437.9655 1715.24006   139%  3322 1037s
  4171  2783  859.75638   22  583 -4437.9655 1715.24006   139%  3321 1041s
  4173  2784 -3714.1015   20  525 -4437.9655 1715.24006   139%  3320 1049s
  4174  2785 -3997.8960   41  519 -4437.9655 1715.24006   139%  3319 1051s
  4177  2787 -2435.5576   36  540 -4437.9655 1715.24006   139%  3316 1055s
  4180  2789 -430.27655   17  549 -4437.9655 1715.24006   139%  3314 1060s
  4182  2790 -3521.1765   17  556 -4437.9655 1715.24006   139%  3312 1072s
  4184  2791 1211.37465   23  602 -4437.9655 1715.24006   139%  3311 1077s
  4186  2793 -4268.4235   56  561 -4437.9655 1715.24006   139%  3309 1081s
  4187  2793  217.22463   13  557 -4437.9655 1715.24006   139%  3308 1087s
  4189  2795  113.23601   25  535 -4437.9655 1715.24006   139%  3307 1090s
  4192  2797 -2715.7902   34  544 -4437.9655 1715.24006   139%  3304 1099s
  4193  2797 -2411.0575   17  561 -4437.9655 1715.24006   139%  3304 1100s
  4196  2799 -1698.1563   25  561 -4437.9655 1715.24006   139%  3301 1109s
  4197  2800  940.20551   14  574 -4437.9655 1715.24006   139%  3301 1113s
  4198  2801 -1252.0341   40  561 -4437.9655 1715.24006   139%  3300 1125s
  4200  2802 -2594.5891   43  557 -4437.9655 1715.24006   139%  3298 1135s
  4203  2804 1476.86803   13  556 -4437.9655 1715.24006   139%  3296 1146s
  4205  2805 -1669.3037   26  564 -4437.9655 1715.24006   139%  3294 1154s
  4206  2806 -1840.3613   38  565 -4437.9655 1715.24006   139%  3293 1155s
  4208  2807 -3706.0953   43  559 -4437.9655 1715.24006   139%  3292 1163s
  4209  2808  182.05859   32  559 -4437.9655 1715.24006   139%  3291 1210s
  4210  2809 -3291.6049   44  559 -4437.9655 1715.24006   139%  3290 1243s
  4211  2812 1715.24006   13  524 -4437.9655 1715.24006   139%  3352 1304s
  4213  2816 1715.24006   14  550 -4437.9655 1715.24006   139%  3353 1318s
  4217  2822 1715.24006   15  556 -4437.9655 1715.24006   139%  3357 1334s
  4225  2836 1715.24006   16  560 -4437.9655 1715.24006   139%  3367 1352s
  4241  2842 1715.24006   17  533 -4437.9655 1715.24006   139%  3392 1376s
  4257  2856 -1697.7577   18  519 -4437.9655 1715.24006   139%  3423 1399s
  4286  2891 -2691.6041   19  399 -4437.9655 1715.24006   139%  3448 1419s
  4389  2864 -3455.2936   21  374 -4437.9655 1715.24006   139%  3493 1439s
  4436  2875 -3217.7803   21  468 -4437.9655 1715.24006   139%  3497 1453s
  4490  2897 -2823.4990   20  403 -4437.9655 1715.24006   139%  3524 1469s
  4552  2924 -3753.4568   22  445 -4437.9655 1715.24006   139%  3539 1482s
  4618  2941 -3329.4750   22  464 -4437.9655 1715.24006   139%  3537 1496s
  4683  2967     cutoff   22      -4437.9655 1715.24006   139%  3553 1508s
  4751  2965 -3674.8243   23  397 -4437.9655 1715.24006   139%  3559 1517s
  4785  2978     cutoff   24      -4437.9655 1715.24006   139%  3568 1529s
  4837  2986     cutoff   24      -4437.9655 1715.24006   139%  3562 1541s
  4883  3006 -2007.8858   22  361 -4437.9655 1715.24006   139%  3564 1553s
  4943  3025 -2255.5234   23  349 -4437.9655 1715.24006   139%  3575 1568s
  5005  3048 -2449.1462   24  346 -4437.9655 1715.24006   139%  3569 1584s
  5069  3080 -2869.2446   25  329 -4437.9655 1715.24006   139%  3584 1597s
  5146  3097 -3005.2892   26  341 -4437.9655 1715.24006   139%  3585 1609s
  5233  3122 -3029.0193   27  339 -4437.9655 1715.24006   139%  3561 1621s
  5320  3150 -3428.3948   30  301 -4437.9655 1715.24006   139%  3548 1637s
  5433  3156     cutoff   33      -4437.9655 1360.31537   131%  3520 1654s
  5534  3140 -2772.6474   36  385 -4437.9655 1360.31537   131%  3523 1668s
  5638  3153 -3139.7724   39  351 -4437.9655 1360.31537   131%  3535 1681s
  5732  3177 -3484.3605   43  283 -4437.9655 1360.31537   131%  3537 1697s
  5848  3188 -3851.0910   48  200 -4437.9655  673.40923   115%  3523 1714s
  5969  3172     cutoff   31      -4437.9655  673.40923   115%  3520 1730s
  6047  3183     cutoff   23      -4437.9655  666.20865   115%  3527 1748s
  6133  3209  -51.81455   18  477 -4437.9655  637.02139   114%  3546 1766s
  6238  3227 -420.18572   20  464 -4437.9655  637.02139   114%  3558 1787s
  6356  3211 -954.85033   24  398 -4437.9655  343.21912   108%  3553 1804s
  6396  3226 -1068.0593   25  472 -4437.9655  288.93176   107%  3566 1816s
  6434  3237 -1517.7186   26  459 -4437.9655  288.93176   107%  3574 1828s
  6478  3249 -1574.6598   27  462 -4437.9655  288.93176   107%  3579 1840s
  6519  3260 -1608.4387   28  457 -4437.9655  288.93176   107%  3578 1858s
  6572  3265 -1863.8169   29  432 -4437.9655  288.93176   107%  3580 1873s
  6619  3277 -2034.7798   30  370 -4437.9655  288.93176   107%  3582 1890s
  6674  3287 -2186.5825   31  370 -4437.9655  288.93176   107%  3580 1914s
  6754  3298 -2336.8572   32  379 -4437.9655  246.48898   106%  3580 1935s
  6864  3299 -2404.7405   33  234 -4437.9655  246.48898   106%  3585 1956s
  6991  3287 -2866.1300   34  405 -4437.9655  246.48898   106%  3578 1976s
  7116  3259     cutoff   35      -4437.9655  -71.65408  98.4%  3589 2000s
  7171  3295 -4312.4395   36  354 -4437.9655 -233.54028  94.7%  3599 2024s
  7301  3311 -1665.9275   25  475 -4437.9655 -246.29587  94.5%  3608 2049s
  7464  3359 -2022.4292   29  388 -4437.9655 -258.78497  94.2%  3622 2073s
  7667  3395 -3012.3411   33  322 -4437.9655 -258.78497  94.2%  3615 2102s
  7909  3434     cutoff   30      -4437.9655 -415.51876  90.6%  3607 2128s
  8177  3425     cutoff   27      -4437.9655 -415.51876  90.6%  3583 2158s
  8479  3410 -1118.4699   24  524 -4437.9655 -535.43190  87.9%  3561 2187s
  8760  3369 -1885.7656   29  356 -4437.9655 -639.27977  85.6%  3560 2213s
  8922  3441 -2959.3795   39  181 -4437.9655 -724.01592  83.7%  3562 2243s
  9192  3428 -2111.9370   29  447 -4437.9655 -776.71038  82.5%  3555 2274s
  9544  3361 -3033.7806   35  329 -4437.9655 -805.06238  81.9%  3537 2305s
  9889  3312 -3039.6530   32  392 -4437.9655 -833.17428  81.2%  3533 2339s
 10260  3222 -4356.3799   34  349 -4437.9655 -1039.4956  76.6%  3520 2375s
 10612  3145     cutoff   40      -4437.9655 -1270.6404  71.4%  3530 2409s
 10993  3016 -2858.2972   36  316 -4437.9655 -1346.4646  69.7%  3543 2445s
 11472  2881 -2803.8724   34  380 -4437.9655 -1423.6166  67.9%  3528 2482s
 11971  2745 -3671.6172   34  283 -4437.9655 -1586.0074  64.3%  3517 2520s
 12538  2608 -4057.8694   33  334 -4437.9655 -1669.0484  62.4%  3494 2556s
 13144  2599 -2876.2644   32  375 -4437.9655 -1856.0538  58.2%  3460 2597s
 13747  2614 -4303.9405   33  289 -4437.9655 -1974.7914  55.5%  3435 2630s
 13810  2638     cutoff   34      -4437.9655 -1974.7914  55.5%  3435 2669s
 14305  2583 -3983.6510   38  277 -4437.9655 -2029.5334  54.3%  3409 2716s
 15054  2498     cutoff   38      -4437.9655 -2224.9398  49.9%  3370 2760s
 15761  2442     cutoff   32      -4437.9655 -2340.1662  47.3%  3341 2805s
 16549  2186 -3847.2111   32  520 -4437.9655 -2479.1420  44.1%  3304 2853s
 17472  1780 -4301.5076   35  169 -4437.9655 -2670.5006  39.8%  3253 2902s
 18628  1232     cutoff   43      -4437.9655 -2908.0200  34.5%  3171 2948s
 19819   291     cutoff   40      -4437.9655 -3142.0972  29.2%  3092 2990s
 21506     0     cutoff   36      -4437.9655 -3412.6098  23.1%  2941 3002s

Cutting planes:
  Gomory: 1
  Implied bound: 33
  Projected implied bound: 57
  MIR: 708
  Flow cover: 2544
  Zero half: 2
  RLT: 21
  Relax-and-lift: 178

Explored 21886 nodes (63745779 simplex iterations) in 3002.76 seconds (8696.80 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -4437.97 -4448.94 -4461.84 ... -15848.4
No other solutions better than -4437.97

Optimal solution found (tolerance 1.00e-04)
Best objective -4.437965476001e+03, best bound -4.437965476001e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3002.81s
  Master Objective (UB) = -4437.97, θ = 116627.58
  Upper Bound (UB) = -4437.97

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 116627.58
  [DEBUG]   ✓ Scenario 0: θ = 116627.58 ≤ Q = 116627.58 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 116627.58 ≤ Q = 116627.58 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 116627.58 ≤ Q = 116627.58 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 116627.58 ≤ Q = 116627.58 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 116627.58 ≤ Q = 116627.58 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 116627.58 ≤ Q = 116627.58 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 116627.58 ≤ Q = 116627.58 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 116627.58 ≤ Q = 116627.58 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 116627.58 ≤ Q = 116627.58 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x118da5e6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x118da5e6
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-01, 2e+02]
Found heuristic solution: objective 1.290223e+13
Presolve removed 2592 rows and 1886 columns
Presolve time: 0.01s
Presolved: 501 rows, 503 columns, 1412 nonzeros
Found heuristic solution: objective 6967881.1205
Variable types: 339 continuous, 164 integer (164 binary)

Root relaxation: objective -1.166971e+05, 249 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -116697.06    0  121 6967881.12 -116697.06   102%     -    0s
H    0     0                    -81478.87388 -116697.06  43.2%     -    0s
H    0     0                    -83084.28011 -116697.06  40.5%     -    0s
*    0     0               0    -84278.46524 -84278.465  0.00%     -    0s

Cutting planes:
  Gomory: 12
  MIR: 194

Explored 1 nodes (383 simplex iterations) in 0.02 seconds (0.02 work units)
Thread count was 32 (of 64 available processors)

Solution count 5: -84278.5 -83084.3 -81478.9 ... 1.29022e+13
No other solutions better than -84278.5

Optimal solution found (tolerance 1.00e-04)
Best objective -8.427846523826e+04, best bound -8.427846523826e+04, gap 0.0000%
  Subproblem solved in 0.03s
  Worst-case operational profit (Z_SP) = 116627.58
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -84278.47
  [DEBUG]   S×d_nominal = 200906.04
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 200906.04 + -84278.47 = 116627.58
  [DEBUG]   Current θ from Master = 116627.58
  [DEBUG]   ⚠️  Z_SP ≤ θ by 0.00 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -4437.97
  Lower Bound (LB) = -4437.97
  Gap (UB-LB) = 0.0000, Absolute Gap = 0.0000, Relative Gap = 0.000000
  *** CONVERGED (gap within tolerance) ***

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 9
Total Time: 9336.40s
Converged: True
Final Lower Bound: -4437.9655
Final Upper Bound: -4437.9655
Final Gap: 0.000000
Number of Critical Scenarios: 9
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [1] (1/3)
Product 1 Plants: [2] (1/3)
Product 2 Plants: [2] (1/3)
Total Plant Openings: 3
DCs Opened: [1, 3, 6] (3/10)
Active Routes (Plant→DC): 8
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 10 customers  Mode 1: 7 customers  Mode 2: 33 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 9
Start Time: 2026-01-05 08:56:36
End Time: 2026-01-05 11:32:13
Total Time: 9336.40s
Optimal Value: -4437.97
Lower Bound: -4437.97
Upper Bound: -4437.97
Gap: 0.000000
Plants Opened: {0: [1], 1: [2], 2: [2]} (3 plants)
DCs Opened: [1, 3, 6] (3 DCs)
================================================================================

Results saved to: result/DH_single_full_seed34_LD_gamma20_20260105_113213.csv

Total Execution Time: 9337.02 seconds
End Time: 2026-01-05 11:32:13

All tasks completed successfully!

