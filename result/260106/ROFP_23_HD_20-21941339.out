
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 23
DI Scenario: HD
Start Time: 2026-01-04 12:31:03
================================================================================
Loading data from data/DH_data_full_seed23.pkl...

Applying DI scenario: HD
DI values:
  Product 0: ['1.000', '1.483', '2.198'] (k=0.971)
  Product 1: ['1.000', '1.427', '2.036'] (k=0.877)
  Product 2: ['1.000', '1.404', '1.970'] (k=0.836)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=957, max=1788
  DC capacity (MC): min=424, max=888

Demand Structure (s_rk matrix):
  Total customer-product pairs: 82/150 (45.3% sparse)
  Average products per customer: 1.64

Demand (only non-zero entries):
  Nominal (μ): min=8.22, max=34.68, count=82
  Deviation (μ̂): min=4.01, max=9.75

Costs:
  Plant fixed cost: min=5308, max=9514
  DC fixed cost: min=3659, max=5984
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.483', '2.198'] (k=0.971)
    Product 1: ['1.000', '1.427', '2.036'] (k=0.877)
    Product 2: ['1.000', '1.404', '1.970'] (k=0.836)
  MD:
    Product 0: ['1.000', '1.153', '1.329'] (k=0.351)
    Product 1: ['1.000', '1.151', '1.325'] (k=0.347)
    Product 2: ['1.000', '1.264', '1.598'] (k=0.578)
  LD:
    Product 0: ['1.000', '1.094', '1.197'] (k=0.222)
    Product 1: ['1.000', '1.121', '1.257'] (k=0.282)
    Product 2: ['1.000', '1.020', '1.041'] (k=0.049)
  Mixed:
    Product 0: ['1.000', '1.483', '2.198'] (k=0.971)
    Product 1: ['1.000', '1.151', '1.325'] (k=0.347)
    Product 2: ['1.000', '1.020', '1.041'] (k=0.049)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48756 nonzeros
Model fingerprint: 0x4cb6adcf
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11789 rows and 2789 columns
Presolve time: 0.12s
Presolved: 4884 rows, 5711 columns, 33922 nonzeros
Variable types: 3452 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -305639.8511
Found heuristic solution: objective -188519.7825

Root relaxation: objective 1.729990e+05, 5439 iterations, 0.43 seconds (0.48 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 172998.955    0  514 -188519.78 172998.955   192%     -    0s
H    0     0                    -182149.8726 172998.955   195%     -    0s
     0     0 150009.660    0  762 -182149.87 150009.660   182%     -    2s
     0     0 149646.044    0  782 -182149.87 149646.044   182%     -    2s
     0     0 149605.809    0  793 -182149.87 149605.809   182%     -    2s
     0     0 149604.947    0  793 -182149.87 149604.947   182%     -    2s
     0     0 124593.083    0  448 -182149.87 124593.083   168%     -    3s
     0     0 123782.220    0  452 -182149.87 123782.220   168%     -    3s
     0     0 123660.778    0  443 -182149.87 123660.778   168%     -    3s
     0     0 123608.819    0  446 -182149.87 123608.819   168%     -    3s
     0     0 123596.648    0  457 -182149.87 123596.648   168%     -    4s
H    0     0                    -159393.6744 111271.655   170%     -    5s
H    0     0                    49352.756989 111271.655   125%     -    5s
     0     0 111271.655    0  434 49352.7570 111271.655   125%     -    5s
     0     0 110155.351    0  463 49352.7570 110155.351   123%     -    5s
     0     0 109910.729    0  510 49352.7570 109910.729   123%     -    5s
     0     0 109851.476    0  512 49352.7570 109851.476   123%     -    5s
     0     0 109814.935    0  517 49352.7570 109814.935   123%     -    6s
     0     0 109811.872    0  514 49352.7570 109811.872   123%     -    6s
H    0     0                    49535.461679 109811.872   122%     -    6s
H    0     0                    49633.909706 109811.872   121%     -    6s
H    0     0                    49685.594773 105516.166   112%     -    7s
H    0     0                    49835.791032 105516.166   112%     -    7s
H    0     0                    49836.118083 105516.166   112%     -    7s
H    0     0                    50032.685719 105516.166   111%     -    7s
H    0     0                    51637.426521 105516.166   104%     -    7s
H    0     0                    51803.420919 105516.166   104%     -    7s
H    0     0                    51822.223201 105516.166   104%     -    7s
H    0     0                    51991.988952 105516.166   103%     -    7s
H    0     0                    52572.006600 105516.166   101%     -    7s
H    0     0                    52676.624925 105516.166   100%     -    7s
H    0     0                    52720.402542 105516.166   100%     -    7s
     0     0 105516.166    0  585 52720.4025 105516.166   100%     -    7s
H    0     0                    53495.291532 104996.918  96.3%     -    8s
     0     0 104996.918    0  563 53495.2915 104996.918  96.3%     -    8s
     0     0 104885.235    0  623 53495.2915 104885.235  96.1%     -    8s
     0     0 104846.187    0  629 53495.2915 104846.187  96.0%     -    8s
     0     0 104830.416    0  626 53495.2915 104830.416  96.0%     -    8s
     0     0 103389.285    0  551 53495.2915 103389.285  93.3%     -    9s
     0     0 103081.119    0  573 53495.2915 103081.119  92.7%     -    9s
     0     0 103038.129    0  625 53495.2915 103038.129  92.6%     -   10s
     0     0 103018.587    0  567 53495.2915 103018.587  92.6%     -   10s
     0     0 102016.469    0  647 53495.2915 102016.469  90.7%     -   10s
     0     0 101679.344    0  683 53495.2915 101679.344  90.1%     -   11s
     0     0 101557.725    0  714 53495.2915 101557.725  89.8%     -   11s
     0     0 101535.189    0  703 53495.2915 101535.189  89.8%     -   11s
     0     0 100701.837    0  647 53495.2915 100701.837  88.2%     -   12s
     0     0 100492.952    0  636 53495.2915 100492.952  87.9%     -   12s
     0     0 100427.499    0  747 53495.2915 100427.499  87.7%     -   13s
     0     0 100401.332    0  719 53495.2915 100401.332  87.7%     -   13s
H    0     0                    53762.774682 99587.6460  85.2%     -   14s
H    0     0                    54976.544329 99587.6460  81.1%     -   14s
H    0     0                    56060.367813 99587.6460  77.6%     -   14s
H    0     0                    56373.540642 99587.6460  76.7%     -   14s
H    0     0                    57097.226430 99587.6460  74.4%     -   14s
H    0     0                    57137.067130 99587.6460  74.3%     -   14s
H    0     0                    57515.780626 99587.6460  73.1%     -   14s
     0     0 99587.6460    0  695 57515.7806 99587.6460  73.1%     -   14s
H    0     0                    57588.111695 99376.2925  72.6%     -   14s
H    0     0                    57639.822106 99376.2925  72.4%     -   14s
H    0     0                    57928.868890 99376.2925  71.5%     -   14s
     0     0 99376.2925    0  752 57928.8689 99376.2925  71.5%     -   14s
     0     0 99333.2430    0  743 57928.8689 99333.2430  71.5%     -   15s
H    0     0                    58063.731634 98796.2032  70.2%     -   16s
H    0     0                    58216.740879 98796.2032  69.7%     -   16s
     0     0 98796.2032    0  641 58216.7409 98796.2032  69.7%     -   16s
     0     0 98605.3374    0  681 58216.7409 98605.3374  69.4%     -   16s
     0     0 98521.6126    0  790 58216.7409 98521.6126  69.2%     -   17s
     0     0 98486.0938    0  813 58216.7409 98486.0938  69.2%     -   17s
     0     0 97894.5866    0  658 58216.7409 97894.5866  68.2%     -   19s
     0     0 97769.1389    0  663 58216.7409 97769.1389  67.9%     -   19s
     0     0 97742.3421    0  658 58216.7409 97742.3421  67.9%     -   20s
     0     0 97527.3217    0  543 58216.7409 97527.3217  67.5%     -   21s
     0     0 97402.0451    0  611 58216.7409 97402.0451  67.3%     -   21s
     0     0 97385.1574    0  595 58216.7409 97385.1574  67.3%     -   21s
     0     0 97098.0585    0  690 58216.7409 97098.0585  66.8%     -   22s
     0     0 97097.4329    0  690 58216.7409 97097.4329  66.8%     -   22s
     0     2 97097.4329    0  690 58216.7409 97097.4329  66.8%     -   24s
     3     8 96886.7856    2  740 58216.7409 97094.4188  66.8%   737   26s
    31    64 94907.7343    5  593 58216.7409 96539.8357  65.8%  2624   31s
H   44    64                    58226.659390 96539.8357  65.8%  2270   31s
   224   323 92115.4069    9  643 58226.6594 96373.6360  65.5%  1206   36s
H  357   393                    58230.846468 96373.6360  65.5%   985   39s
H  363   393                    58323.645659 96373.6360  65.2%   984   39s
   392   496 92013.3192   12  597 58323.6457 96373.6360  65.2%   949   40s
H  766   808                    60479.290672 96373.6360  59.3%   751   43s
   807   886 91107.0804   16  627 60479.2907 96373.6360  59.3%   728   45s
H  821   886                    60485.048542 96373.6360  59.3%   739   45s
H  827   886                    60576.225715 96373.6360  59.1%   738   45s
H  839   886                    60817.070502 96373.6360  58.5%   730   45s
H  858   886                    60945.163266 96373.6360  58.1%   720   45s
H  978  1076                    61014.922506 96373.6360  58.0%   684   46s
  1298  1371 90253.5445   20  584 61014.9225 96209.0144  57.7%   608   50s
H 1426  1418                    61194.510540 96209.0144  57.2%   603   51s
H 1444  1418                    62653.401119 96209.0144  53.6%   605   51s
H 1568  1518                    62827.476841 96209.0144  53.1%   622   52s
H 1572  1518                    65545.704945 96209.0144  46.8%   625   52s
  1675  1616 86606.3643   25  521 65545.7049 96209.0144  46.8%   634   55s
H 1679  1616                    65596.366522 96209.0144  46.7%   634   55s
H 1973  1867                    65669.168509 96209.0144  46.5%   635   58s
H 1978  1861                    65920.029492 96209.0144  45.9%   634   58s
  2221  2268 84078.9243   32  473 65920.0295 96209.0144  45.9%   609   61s
  3251  3078 80834.6302   43  383 65920.0295 96209.0144  45.9%   511   65s
H 3252  3078                    66065.228504 96209.0144  45.6%   511   65s
H 3254  3041                    67785.655885 96209.0144  41.9%   511   65s
H 3670  3400                    67838.283420 95804.7957  41.2%   487   68s
H 3706  3376                    68256.932556 95804.7957  40.4%   488   68s
  3708  3488 75968.5756   46  333 68256.9326 95804.7957  40.4%   488   70s
  4428  3929 72713.1344   81  690 68256.9326 95355.3573  39.7%   476   90s
  4452  3945 87038.8269   10  385 68256.9326 91652.3807  34.3%   474   95s
  4470  3962 88271.1214   11  316 68256.9326 89950.1700  31.8%   476  100s
  4755  4135 77552.6946   17  244 68256.9326 86789.0082  27.2%   476  105s
H 5070  4025                    69463.222033 85558.7183  23.2%   466  108s
H 5079  3871                    69464.435087 85558.7183  23.2%   466  109s
H 5100  3685                    69466.694415 85558.7183  23.2%   465  109s
  5295  3683 82467.2464   17  299 69466.6944 85167.8118  22.6%   457  110s
H 5541  3510                    69510.878380 83651.6000  20.3%   446  111s
H 5939  3345                    69899.677214 83651.6000  19.7%   431  113s
H 5991  3174                    69919.348986 83651.6000  19.6%   429  113s
H 6157  3026                    70018.499527 82190.7964  17.4%   424  114s
  6387  3011 70267.0986   45  139 70018.4995 81545.8487  16.5%   417  115s
  7471  2934     cutoff   22      70018.4995 79013.8205  12.8%   390  120s
  9722  2425 70488.9438   26  213 70018.4995 77097.9972  10.1%   350  125s
 12790  1261 72061.8130   23  281 70018.4995 74748.8318  6.76%   317  130s
 16027    33     cutoff   25      70018.4995 72330.6309  3.30%   291  135s

Cutting planes:
  Gomory: 2
  Implied bound: 4
  Projected implied bound: 11
  MIR: 279
  Mixing: 1
  Flow cover: 456
  RLT: 49
  Relax-and-lift: 62

Explored 17847 nodes (4799904 simplex iterations) in 135.63 seconds (196.84 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 70018.5 69919.3 69899.7 ... 65920

Optimal solution found (tolerance 1.00e-04)
Best objective 7.001849952680e+04, best bound 7.001849952680e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 135.64s
  Master Objective (UB) = 70018.50, θ = 259056.36
  Upper Bound (UB) = 70018.50

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 259056.36
  [DEBUG]   ✓ Scenario 0: θ = 259056.36 ≤ Q = 259056.36 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x71d5702b
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x71d5702b
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.418747e+13
Presolve removed 2585 rows and 1875 columns
Presolve time: 0.01s
Presolved: 508 rows, 514 columns, 1439 nonzeros
Found heuristic solution: objective 6861622.0275
Variable types: 350 continuous, 164 integer (164 binary)

Root relaxation: objective -1.745708e+05, 244 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -174570.78    0  123 6861622.03 -174570.78   103%     -    0s
H    0     0                    -141468.2932 -174570.78  23.4%     -    0s
H    0     0                    -141755.1558 -174570.78  23.1%     -    0s
*    0     0               0    -144002.0672 -144002.07  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 205

Explored 1 nodes (377 simplex iterations) in 0.02 seconds (0.01 work units)
Thread count was 32 (of 32 available processors)

Solution count 5: -144002 -141755 -141468 ... 1.41875e+13
No other solutions better than -144002

Optimal solution found (tolerance 1.00e-04)
Best objective -1.440020671700e+05, best bound -1.440020671700e+05, gap 0.0000%
  Subproblem solved in 0.05s
  Worst-case operational profit (Z_SP) = 227445.13
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -144002.07
  [DEBUG]   S×d_nominal = 371447.20
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 371447.20 + -144002.07 = 227445.13
  [DEBUG]   Current θ from Master = 259056.36
  [DEBUG]   ⚠️  Z_SP ≤ θ by 31611.23 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 38407.27
  Lower Bound (LB) = 38407.27
  Gap (UB-LB) = 31611.2295, Absolute Gap = 31611.2295, Relative Gap = 0.451470
  Not converged yet (gap = 31611.23 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 91993 nonzeros
Model fingerprint: 0xf3aacf2a
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve produced solution with objective 38407.3 (0.02s)
MIP start from previous solve produced solution with objective 38407.3 (0.02s)
Loaded MIP start from previous solve with objective 38407.3

Presolve removed 13767 rows and 5586 columns
Presolve time: 0.50s
Presolved: 18196 rows, 9154 columns, 100768 nonzeros
Variable types: 6895 continuous, 2259 integer (2259 binary)

Root relaxation: objective 9.242080e+04, 8743 iterations, 1.09 seconds (1.43 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 92420.8019    0  222 38407.2701 92420.8019   141%     -    1s
H    0     0                    38892.713883 92420.8019   138%     -    2s
H    0     0                    39407.684082 92420.8019   135%     -    2s
H    0     0                    39841.108479 92420.8019   132%     -    2s
     0     0 83276.1948    0  315 39841.1085 83276.1948   109%     -    3s
H    0     0                    39930.152036 83227.7683   108%     -    3s
H    0     0                    40042.730370 83227.7683   108%     -    3s
H    0     0                    40087.311230 83227.7683   108%     -    3s
H    0     0                    40247.211983 83227.7683   107%     -    3s
H    0     0                    40335.190793 83227.7683   106%     -    3s
     0     0 82973.2698    0  338 40335.1908 82973.2698   106%     -    3s
     0     0 82970.7688    0  328 40335.1908 82970.7688   106%     -    3s
     0     0 77452.1306    0  396 40335.1908 77452.1306  92.0%     -    5s
     0     0 77028.5179    0  433 40335.1908 77028.5179  91.0%     -    6s
     0     0 76855.0593    0  444 40335.1908 76855.0593  90.5%     -    6s
     0     0 76773.9252    0  443 40335.1908 76773.9252  90.3%     -    6s
     0     0 76771.6180    0  440 40335.1908 76771.6180  90.3%     -    6s
     0     0 73834.8855    0  383 40335.1908 73834.8855  83.1%     -    9s
     0     0 73202.3595    0  439 40335.1908 73202.3595  81.5%     -   10s
     0     0 72847.6860    0  515 40335.1908 72847.6860  80.6%     -   10s
     0     0 72747.9919    0  513 40335.1908 72747.9919  80.4%     -   10s
     0     0 72634.7958    0  524 40335.1908 72634.7958  80.1%     -   11s
     0     0 72605.2106    0  518 40335.1908 72605.2106  80.0%     -   11s
     0     0 72599.5600    0  518 40335.1908 72599.5600  80.0%     -   11s
     0     0 72597.7122    0  526 40335.1908 72597.7122  80.0%     -   11s
     0     0 71016.4679    0  377 40335.1908 71016.4679  76.1%     -   14s
H    0     0                    40795.381721 71016.4027  74.1%     -   14s
     0     0 70714.0830    0  375 40795.3817 70714.0830  73.3%     -   15s
     0     0 70633.7030    0  390 40795.3817 70633.7030  73.1%     -   15s
     0     0 70620.5199    0  393 40795.3817 70620.5199  73.1%     -   15s
     0     0 70606.5270    0  428 40795.3817 70606.5270  73.1%     -   15s
     0     0 70604.1646    0  427 40795.3817 70604.1646  73.1%     -   15s
H    0     0                    45289.544902 70049.9903  54.7%     -   17s
H    0     0                    45295.467799 70049.9903  54.7%     -   17s
H    0     0                    45611.084447 70049.9903  53.6%     -   17s
     0     0 70049.9903    0  407 45611.0844 70049.9903  53.6%     -   17s
H    0     0                    46539.586448 70045.7133  50.5%     -   17s
H    0     0                    46572.416743 70045.7133  50.4%     -   17s
H    0     0                    46919.632209 70045.7133  49.3%     -   17s
H    0     0                    46973.498809 70045.7133  49.1%     -   17s
H    0     0                    46977.986596 70045.7133  49.1%     -   17s
     0     0 69981.0410    0  373 46977.9866 69981.0410  49.0%     -   17s
     0     0 69950.5361    0  390 46977.9866 69950.5361  48.9%     -   18s
     0     0 69946.3916    0  387 46977.9866 69946.3916  48.9%     -   18s
H    0     0                    48084.067142 69494.4740  44.5%     -   19s
     0     0 69494.4740    0  461 48084.0671 69494.4740  44.5%     -   19s
H    0     0                    48472.645045 69494.3662  43.4%     -   19s
     0     0 69430.1505    0  412 48472.6450 69430.1505  43.2%     -   20s
     0     0 69407.9891    0  370 48472.6450 69407.9891  43.2%     -   20s
     0     0 69398.8615    0  452 48472.6450 69398.8615  43.2%     -   20s
     0     0 69369.2059    0  496 48472.6450 69369.2059  43.1%     -   21s
     0     0 69362.1848    0  486 48472.6450 69362.1848  43.1%     -   21s
     0     0 69359.6814    0  482 48472.6450 69359.6814  43.1%     -   21s
     0     0 69238.1440    0  358 48472.6450 69238.1440  42.8%     -   22s
H    0     0                    48512.137543 69238.0726  42.7%     -   22s
     0     0 69208.1599    0  537 48512.1375 69208.1599  42.7%     -   23s
     0     0 69203.7965    0  486 48512.1375 69203.7965  42.7%     -   23s
     0     0 69117.7165    0  482 48512.1375 69117.7165  42.5%     -   24s
     0     0 69090.9238    0  422 48512.1375 69090.9238  42.4%     -   24s
     0     0 69084.2039    0  393 48512.1375 69084.2039  42.4%     -   24s
     0     0 69081.3884    0  490 48512.1375 69081.3884  42.4%     -   25s
     0     0 69031.3503    0  366 48512.1375 69031.3503  42.3%     -   25s
     0     0 69020.2699    0  370 48512.1375 69020.2699  42.3%     -   26s
     0     0 69018.0045    0  370 48512.1375 69018.0045  42.3%     -   26s
     0     0 68997.1568    0  482 48512.1375 68997.1568  42.2%     -   27s
H    0     0                    48935.571349 68996.2790  41.0%     -   27s
     0     0 68990.6885    0  373 48935.5713 68990.6885  41.0%     -   27s
     0     0 68963.4441    0  408 48935.5713 68963.4441  40.9%     -   28s
     0     0 68963.4349    0  408 48935.5713 68963.4349  40.9%     -   28s
     0     2 68963.3613    0  408 48935.5713 68963.3613  40.9%     -   32s
     3     8 68791.6790    2  354 48935.5713 68852.6601  40.7%   745   35s
    31    64 66460.3829    5  392 48935.5713 66933.2925  36.8%  1527   41s
   148   256 65975.5318    9  334 48935.5713 66453.8178  35.8%  1124   45s
H  179   256                    48958.954160 66453.8178  35.7%  1005   45s
H  255   316                    48998.375360 66453.8178  35.6%   828   47s
H  258   316                    49055.318409 66453.8178  35.5%   835   47s
   380   428 61078.7230   12  288 49055.3184 66351.6481  35.3%   775   50s
   627   647 63027.9042   14  374 49055.3184 66351.6481  35.3%   716   55s
H  715   717                    49079.565231 66351.6481  35.2%   697   58s
   731   791 60489.7048   16  273 49079.5652 66351.6481  35.2%   687   60s
H  898   849                    49093.393388 66351.6481  35.2%   639   62s
  1018   948 57096.9475   20  343 49093.3934 66351.6481  35.2%   616   65s
H 1095   998                    49142.328898 66351.6481  35.0%   608   67s
  1404  1422 55125.8909   32  302 49142.3289 66351.6481  35.0%   533   70s
  2230  2115     cutoff   32      49142.3289 66152.7349  34.6%   408   76s
  2578  2429 61635.5911    8  368 49142.3289 66152.7349  34.6%   378   82s
  2947  2597 58597.8224   14  364 49142.3289 66054.1053  34.4%   369   85s
H 3082  2633                    49328.310895 65967.0292  33.7%   372   87s
H 3101  2633                    49336.806187 65967.0292  33.7%   372   87s
H 3113  2631                    49588.080909 65967.0292  33.0%   371   87s
H 3123  2524                    50840.003870 65967.0292  29.8%   371   87s
  3125  2593 56857.9702   18  284 50840.0039 65967.0292  29.8%   372   90s
H 3416  2721                    50886.026672 65910.5507  29.5%   379   94s
H 3438  2714                    50920.672790 65910.5507  29.4%   380   94s
  3473  2845 62948.0231   11  363 50920.6728 65910.5507  29.4%   381   96s
H 3640  2774                    51314.815288 65910.5507  28.4%   381   98s
  3641  2775 56328.4459   34  408 51314.8153 65910.5507  28.4%   381  106s
H 3642  2637                    51728.261497 65910.5507  27.4%   381  107s
H 3642  2505                    51999.092903 65910.5507  26.8%   381  107s
H 3643  2380                    52044.053542 65910.5507  26.6%   380  110s
H 3643  2260                    52053.193813 65910.5507  26.6%   380  110s
H 3643  2147                    52183.631731 65910.5507  26.3%   380  110s
  3651  2153 62025.4272    7  410 52183.6317 65910.5507  26.3%   380  115s
  3657  2157 52183.6317   91  443 52183.6317 65910.5507  26.3%   379  120s
  3664  2161 60226.4033   17  367 52183.6317 65910.5507  26.3%   378  125s
H 3666  2055                    52192.721961 65910.5507  26.3%   378  130s
H 3666  1952                    52291.219949 65910.5507  26.0%   378  130s
H 3666  1854                    52291.364249 65910.5507  26.0%   378  130s
H 3666  1761                    52383.353904 65910.5507  25.8%   378  131s
  3674  1775 65910.5507   18  312 52383.3539 65910.5507  25.8%   386  136s
  3730  1836 64985.3843   21  285 52383.3539 65286.8983  24.6%   399  140s
  3862  1909 63577.1121   24  288 52383.3539 65286.8983  24.6%   403  146s
  3963  1957 60129.2407   25  238 52383.3539 64984.2297  24.1%   410  150s
  4207  2019 57836.8586   28  214 52383.3539 64868.4515  23.8%   419  156s
  4438  2005     cutoff   32      52383.3539 63579.7738  21.4%   426  160s
  4687  2051 54326.0849   27  286 52383.3539 63351.7631  20.9%   430  166s
  5040  2008 53634.8723   25  268 52383.3539 63351.7631  20.9%   424  170s
  5390  1988 53656.4284   28  300 52383.3539 61553.0455  17.5%   424  175s
  5841  1927 55002.8687   31  195 52383.3539 60909.8309  16.3%   420  181s
  6435  1774 52762.7472   46   95 52383.3539 60637.9329  15.8%   415  186s
  7064  1604 55897.0861   27  259 52383.3539 59410.5074  13.4%   418  191s
  7203  1565 53139.1167   29  227 52383.3539 59410.5074  13.4%   418  195s
  7559  1462 54568.6703   33  161 52383.3539 59288.6669  13.2%   416  200s
  8361  1178     cutoff   33      52383.3539 57969.6948  10.7%   415  207s
  8643  1056     cutoff   33      52383.3539 57675.7810  10.1%   415  210s
  9352   837     cutoff   27      52383.3539 56827.3101  8.48%   412  215s
 10227   654 53073.1187   26  237 52383.3539 55913.8876  6.74%   406  220s
 11761   301     cutoff   41      52383.3539 54164.0941  3.40%   379  225s

Cutting planes:
  MIR: 221
  Flow cover: 439
  RLT: 5
  Relax-and-lift: 39

Explored 14491 nodes (4651619 simplex iterations) in 227.60 seconds (383.34 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 52383.4 52291.4 52291.2 ... 51314.8

Optimal solution found (tolerance 1.00e-04)
Best objective 5.238335390430e+04, best bound 5.238335390430e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 227.61s
  Master Objective (UB) = 52383.35, θ = 229979.01
  Upper Bound (UB) = 52383.35

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 229979.01
  [DEBUG]   ✓ Scenario 0: θ = 229979.01 ≤ Q = 229979.01 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 229979.01 ≤ Q = 229979.01 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x6a52bae8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x95ad4518
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.338420e+13
Presolve removed 2588 rows and 1879 columns
Presolve time: 0.01s
Presolved: 505 rows, 510 columns, 1433 nonzeros
Found heuristic solution: objective 6533217.3548
Variable types: 346 continuous, 164 integer (164 binary)

Root relaxation: objective -1.720377e+05, 267 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -172037.65    0  120 6533217.35 -172037.65   103%     -    0s
H    0     0                    -136454.1298 -172037.65  26.1%     -    0s
H    0     0                    -136839.8749 -172037.65  25.7%     -    0s
H    0     0                    -150606.0656 -172037.65  14.2%     -    0s
H    0     0                    -151302.0346 -159646.60  5.52%     -    0s
H    0     0                    -156364.6209 -159646.60  2.10%     -    0s
     0     0 -159646.60    0  122 -156364.62 -159646.60  2.10%     -    0s
     0     0 -159120.43    0  109 -156364.62 -159120.43  1.76%     -    0s
H    0     0                    -157246.6485 -159120.43  1.19%     -    0s
     0     0 -157928.87    0   86 -157246.65 -157928.87  0.43%     -    0s
H    0     0                    -157255.1956 -157921.48  0.42%     -    0s
     0     0 -157916.59    0   85 -157255.20 -157916.59  0.42%     -    0s
     0     0 -157916.54    0   87 -157255.20 -157916.54  0.42%     -    0s
     0     0 -157764.62    0   80 -157255.20 -157764.62  0.32%     -    0s
     0     0 -157757.23    0   79 -157255.20 -157757.23  0.32%     -    0s
     0     0 -157704.84    0   79 -157255.20 -157704.84  0.29%     -    0s
     0     0 -157703.02    0   79 -157255.20 -157703.02  0.28%     -    0s
     0     2 -157703.02    0   79 -157255.20 -157703.02  0.28%     -    0s
H  388   130                    -157255.2700 -157391.64  0.09%   5.8    0s
H 1500   194                    -157258.2945 -157304.47  0.03%   4.2    0s
H 1500   194                    -157258.7636 -157304.47  0.03%   4.2    0s
* 1573    63              45    -157263.0386 -157298.09  0.02%   4.2    0s
* 1794    63              44    -157263.1130 -157282.63  0.01%   4.2    0s

Cutting planes:
  Gomory: 50
  Implied bound: 3
  MIR: 171
  Flow cover: 15
  RLT: 41

Explored 1886 nodes (8399 simplex iterations) in 0.32 seconds (0.16 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -157263 -157263 -157259 ... -136454
No other solutions better than -157263

Optimal solution found (tolerance 1.00e-04)
Best objective -1.572631130472e+05, best bound -1.572631130472e+05, gap 0.0000%
  Subproblem solved in 0.35s
  Worst-case operational profit (Z_SP) = 209402.22
  Scenario: 60 demand increases, 0 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -157263.11
  [DEBUG]   S×d_nominal = 366665.33
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 366665.33 + -157263.11 = 209402.22
  [DEBUG]   Current θ from Master = 229979.01
  [DEBUG]   ⚠️  Z_SP ≤ θ by 20576.80 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 31806.56
  Lower Bound (LB) = 38407.27
  Gap (UB-LB) = 13976.0838, Absolute Gap = 13976.0838, Relative Gap = 0.266804
  Not converged yet (gap = 13976.08 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 60 increases, 0 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135230 nonzeros
Model fingerprint: 0x3af20b08
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve produced solution with objective 31806.6 (0.03s)
Loaded MIP start from previous solve with objective 31806.6

Presolve removed 20624 rows and 8374 columns
Presolve time: 0.66s
Presolved: 26629 rows, 12606 columns, 163799 nonzeros
Variable types: 10347 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   43216    7.0443562e+04   0.000000e+00   8.495880e+06      5s
Concurrent spin time: 0.10s

Solved with dual simplex

Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   16926    7.8415391e+04   0.000000e+00   0.000000e+00      6s

Root relaxation: objective 7.841539e+04, 16926 iterations, 4.87 seconds (6.49 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 78415.3910    0   93 31806.5589 78415.3910   147%     -    5s
H    0     0                    34612.685489 78415.3910   127%     -    5s
H    0     0                    35350.773939 78415.3910   122%     -    6s
H    0     0                    35358.563013 78415.3910   122%     -    6s
     0     0 71765.8285    0  164 35358.5630 71765.8285   103%     -    9s
     0     0 70959.0317    0  196 35358.5630 70959.0317   101%     -   10s
     0     0 70959.0317    0  180 35358.5630 70959.0317   101%     -   11s
     0     0 70959.0317    0  198 35358.5630 70959.0317   101%     -   11s
     0     0 70959.0317    0  197 35358.5630 70959.0317   101%     -   11s
H    0     0                    35571.183832 68117.9132  91.5%     -   13s
     0     0 68096.9975    0  231 35571.1838 68096.9975  91.4%     -   13s
H    0     0                    36766.673426 68096.9975  85.2%     -   14s
H    0     0                    37361.410278 68096.9975  82.3%     -   14s
H    0     0                    38799.747353 68096.9975  75.5%     -   14s
H    0     0                    39182.572713 68096.9975  73.8%     -   14s
H    0     0                    39706.692970 68096.9975  71.5%     -   14s
H    0     0                    39860.031600 68096.9975  70.8%     -   14s
     0     0 67770.9327    0  236 39860.0316 67770.9327  70.0%     -   15s
     0     0 67627.9744    0  233 39860.0316 67627.9744  69.7%     -   16s
     0     0 67572.5825    0  242 39860.0316 67572.5825  69.5%     -   16s
     0     0 67565.9629    0  246 39860.0316 67565.9629  69.5%     -   16s
     0     0 67564.6706    0  248 39860.0316 67564.6706  69.5%     -   16s
     0     0 67564.6546    0  252 39860.0316 67564.6546  69.5%     -   16s
H    0     0                    41217.667465 66277.3258  60.8%     -   21s
     0     0 66277.3258    0  315 41217.6675 66277.3258  60.8%     -   21s
H    0     0                    41226.222174 65826.6703  59.7%     -   22s
     0     0 65826.6703    0  305 41226.2222 65826.6703  59.7%     -   22s
     0     0 65533.4003    0  314 41226.2222 65533.4003  59.0%     -   23s
     0     0 65483.6018    0  318 41226.2222 65483.6018  58.8%     -   24s
     0     0 65446.2858    0  323 41226.2222 65446.2858  58.7%     -   24s
     0     0 65423.0738    0  319 41226.2222 65423.0738  58.7%     -   25s
     0     0 65405.3252    0  324 41226.2222 65405.3252  58.6%     -   25s
     0     0 65381.8830    0  326 41226.2222 65381.8830  58.6%     -   26s
     0     0 65374.7677    0  326 41226.2222 65374.7677  58.6%     -   26s
     0     0 65373.2312    0  326 41226.2222 65373.2312  58.6%     -   26s
     0     0 65371.8140    0  324 41226.2222 65371.8140  58.6%     -   26s
     0     0 65112.9024    0  341 41226.2222 65112.9024  57.9%     -   29s
H    0     0                    41257.334264 65109.0061  57.8%     -   29s
H    0     0                    41340.948692 65109.0061  57.5%     -   29s
H    0     0                    41348.992441 65109.0061  57.5%     -   29s
H    0     0                    41367.428328 64864.9036  56.8%     -   30s
     0     0 64864.9036    0  356 41367.4283 64864.9036  56.8%     -   30s
     0     0 64829.7375    0  364 41367.4283 64829.7375  56.7%     -   31s
     0     0 64798.1543    0  371 41367.4283 64798.1543  56.6%     -   31s
     0     0 64790.5867    0  375 41367.4283 64790.5867  56.6%     -   31s
     0     0 64788.0780    0  336 41367.4283 64788.0780  56.6%     -   32s
     0     0 64776.3147    0  365 41367.4283 64776.3147  56.6%     -   32s
     0     0 64773.8223    0  366 41367.4283 64773.8223  56.6%     -   32s
     0     0 64773.6632    0  368 41367.4283 64773.6632  56.6%     -   32s
     0     0 64701.2294    0  335 41367.4283 64701.2294  56.4%     -   33s
     0     0 64687.3511    0  334 41367.4283 64687.3511  56.4%     -   34s
     0     0 64684.8075    0  335 41367.4283 64684.8075  56.4%     -   34s
     0     0 64683.6789    0  336 41367.4283 64683.6789  56.4%     -   34s
     0     0 64667.1697    0  338 41367.4283 64667.1697  56.3%     -   35s
     0     0 64664.3002    0  347 41367.4283 64664.3002  56.3%     -   35s
     0     0 64662.8461    0  348 41367.4283 64662.8461  56.3%     -   35s
     0     0 64657.0393    0  345 41367.4283 64657.0393  56.3%     -   36s
     0     0 64655.6650    0  341 41367.4283 64655.6650  56.3%     -   36s
     0     0 64647.2473    0  352 41367.4283 64647.2473  56.3%     -   37s
H    0     0                    41588.726858 64646.5659  55.4%     -   37s
H    0     0                    41618.577948 64646.5659  55.3%     -   37s
H    0     0                    41652.107075 64646.5659  55.2%     -   37s
     0     0 64643.0928    0  355 41652.1071 64643.0928  55.2%     -   38s
     0     0 64642.4116    0  352 41652.1071 64642.4116  55.2%     -   38s
     0     0 64640.1250    0  359 41652.1071 64640.1250  55.2%     -   38s
H    0     0                    41671.502815 64640.1029  55.1%     -   38s
     0     0 64638.4398    0  386 41671.5028 64638.4398  55.1%     -   39s
     0     0 64634.3778    0  380 41671.5028 64634.3778  55.1%     -   39s
     0     0 64633.2302    0  380 41671.5028 64633.2302  55.1%     -   39s
H    0     0                    41698.959175 64630.2029  55.0%     -   45s
H    0     0                    41730.494793 64630.2029  54.9%     -   45s
H    0     0                    41841.672287 64630.2029  54.5%     -   45s
H    0     0                    41847.694213 64630.2029  54.4%     -   46s
H    0     0                    42265.204228 64630.2029  52.9%     -   46s
     0     2 64630.2029    0  380 42265.2042 64630.2029  52.9%     -   46s
     7    16 64243.4413    3  323 42265.2042 64413.9710  52.4%  1634   50s
H   31    64                    42462.344505 64068.7374  50.9%  3517   57s
H   34    64                    42492.606910 64068.2257  50.8%  3288   57s
H   37    64                    42538.124514 64068.2257  50.6%  3097   57s
    95   212 63833.1303    7  329 42538.1245 64026.5557  50.5%  2263   62s
   211   278 63570.1294   11  360 42538.1245 64026.5557  50.5%  1525   65s
   328   388 62693.5696   13  381 42538.1245 64026.5557  50.5%  1517   71s
   440   471 61805.6404   14  319 42538.1245 64026.5557  50.5%  1476   76s
   515   546 58595.8714   15  315 42538.1245 64026.5557  50.5%  1494   82s
   551   588 60488.8077   16  379 42538.1245 64026.5557  50.5%  1517   86s
   597   630 60352.8795   17  361 42538.1245 64026.5557  50.5%  1516   90s
   690   725 60289.2415   18  358 42538.1245 63973.6285  50.4%  1524   96s
   813   852 59933.2748   20  372 42538.1245 63862.8811  50.1%  1462  101s
   952   979 58792.5194   23  333 42538.1245 63862.8811  50.1%  1400  107s
  1024  1019 54449.3594   23  308 42538.1245 63862.8811  50.1%  1372  110s
H 1118  1059                    42726.786044 63862.8811  49.5%  1355  113s
  1155  1090 57090.5533   24  329 42726.7860 63756.1113  49.2%  1353  116s
H 1180  1090                    42777.662833 63756.1113  49.0%  1361  116s
  1188  1179 56915.0272   25  314 42777.6628 63756.1113  49.0%  1367  120s
  1353  1334 54971.5039   28  288 42777.6628 63756.1113  49.0%  1312  126s
  1603  1555 54543.5466   30  225 42777.6628 63746.1750  49.0%  1222  132s
  1770  1624 50620.8854   34  187 42777.6628 63083.4621  47.5%  1194  138s
H 1787  1624                    42812.308951 63083.4621  47.3%  1194  138s
  1809  1807 50767.4472   35  196 42812.3090 63083.4621  47.3%  1197  141s
  1994  1886 48843.3489   44  148 42812.3090 63083.4621  47.3%  1135  146s
  2277  2163 47789.7547   53  111 42812.3090 62967.2872  47.1%  1081  154s
  2473  2360 45864.1798   65   55 42812.3090 62948.2526  47.0%  1048  158s
  2716  2563 45435.9254   78   46 42812.3090 62848.4445  46.8%  1000  162s
  3002  2623 44838.3907   91  109 42812.3090 62740.7068  46.5%   950  166s
  3076  2743 58108.3555   11  306 42812.3090 62740.7068  46.5%   949  170s
  3496  2934 56469.5313   15  380 42812.3090 62740.7068  46.5%   898  186s
  3498  2935 51106.7839   39   93 42812.3090 62740.7068  46.5%   898  193s
  3499  2936 59419.3173   16  254 42812.3090 62740.7068  46.5%   898  198s
  3500  2937 55719.3700   12  296 42812.3090 62740.7068  46.5%   897  200s
  3503  2939 48469.2318   49  357 42812.3090 62740.7068  46.5%   897  205s
  3509  2943 49586.8835   38  332 42812.3090 62740.7068  46.5%   895  210s
  3515  2947 55048.6915   18  334 42812.3090 62740.7068  46.5%   894  215s
  3521  2951 43377.4370   53  336 42812.3090 62740.7068  46.5%   892  221s
  3525  2953 54745.4571   18  336 42812.3090 62740.7068  46.5%   891  226s
  3526  2954 57154.5175   16  336 42812.3090 62740.7068  46.5%   891  234s
  3527  2955 43439.7057   51  336 42812.3090 62740.7068  46.5%   891  242s
  3528  2958 62350.1843   16  375 42812.3090 62740.7068  46.5%   906  246s
  3530  2962 62200.9773   17  373 42812.3090 62350.1145  45.6%   908  250s
  3534  2968 61980.1588   18  339 42812.3090 62339.6830  45.6%   907  255s
  3542  2982 60793.6232   19  348 42812.3090 61977.4397  44.8%   915  260s
  3590  3030 57993.3352   21  369 42812.3090 60351.4580  41.0%   957  274s
  3622  3101 57786.4083   22  347 42812.3090 60351.4580  41.0%  1028  281s
  3704  3141 55439.7616   24  292 42812.3090 60351.4580  41.0%  1065  285s
  3808  3166 53497.6801   25  239 42812.3090 60351.4580  41.0%  1097  298s
  3843  3186 53075.5683   26  249 42812.3090 60351.4580  41.0%  1106  300s
H 3878  3052                    42852.567409 60351.4580  40.8%  1112  304s
  3913  3059 52742.1913   27  248 42852.5674 60351.4580  40.8%  1115  307s
  3960  3086 49858.9543   27  216 42852.5674 60351.4580  40.8%  1116  311s
  4044  3112 48974.2051   29  172 42852.5674 60065.8348  40.2%  1119  315s
  4220  3144     cutoff   32      42852.5674 59036.0373  37.8%  1129  323s
  4311  3148 53357.4245   23  253 42852.5674 59036.0373  37.8%  1129  327s
  4394  3169 52308.6527   25  241 42852.5674 57516.7741  34.2%  1131  330s
  4582  3177 45900.5154   30  164 42852.5674 57509.8986  34.2%  1127  337s
  4693  3188     cutoff   36      42852.5674 57509.8986  34.2%  1125  342s
  4810  3219 51191.3629   26  263 42852.5674 56518.5872  31.9%  1123  347s
  4926  3208 48964.2736   29  274 42852.5674 56475.0036  31.8%  1120  350s
  5002  3232 48116.5350   31  245 42852.5674 56325.4444  31.4%  1119  357s
  5047  3240 47383.4348   32  233 42852.5674 56325.4444  31.4%  1118  361s
  5096  3234 47300.0907   33  253 42852.5674 56299.3484  31.4%  1118  367s
  5174  3234 46390.6927   34  234 42852.5674 56299.3484  31.4%  1117  372s
  5236  3250 45981.0775   35  220 42852.5674 56299.3484  31.4%  1121  377s
  5326  3253 45361.7411   36  210 42852.5674 56299.3484  31.4%  1119  381s
  5444  3267 44500.9339   37  158 42852.5674 56287.0143  31.4%  1118  386s
  5571  3288     cutoff   38      42852.5674 56287.0143  31.4%  1117  390s
  5713  3282 53548.6494   25  274 42852.5674 55651.8354  29.9%  1114  395s
  5880  3304 46444.4583   30  193 42852.5674 55651.8354  29.9%  1114  401s
  6057  3295     cutoff   35      42852.5674 55305.8029  29.1%  1111  408s
  6233  3312     cutoff   25      42852.5674 55296.1604  29.0%  1111  414s
  6408  3313 48966.0073   28  246 42852.5674 55296.1604  29.0%  1112  420s
  6602  3307 45309.4321   32  225 42852.5674 55296.1604  29.0%  1110  425s
H 6611  3163                    43514.924923 55296.1604  27.1%  1110  425s
H 6796  2983                    43619.346195 54407.9758  24.7%  1109  430s
H 6800  2855                    43679.059441 54407.9758  24.6%  1109  430s
H 6827  2725                    43795.653462 54313.7879  24.0%  1110  430s
  6848  2774 47318.7826   25  258 43795.6535 54313.7879  24.0%  1110  436s
  7089  2705     cutoff   29      43795.6535 54108.5408  23.5%  1105  441s
H 7093  2589                    43894.151451 54108.5408  23.3%  1105  441s
H 7095  2479                    44029.488475 54108.5408  22.9%  1105  441s
  7139  2511 46867.6344   27  297 44029.4885 54108.5408  22.9%  1106  447s
  7391  2484 47613.8301   25  193 44029.4885 54108.5408  22.9%  1103  454s
  7626  2462 44649.0810   28  139 44029.4885 54108.5408  22.9%  1104  460s
  7889  2347 47150.4420   26  210 44029.4885 53396.4294  21.3%  1104  467s
  8180  2272 44329.1391   26  294 44029.4885 52814.0441  20.0%  1104  474s
  8482  2195     cutoff   28      44029.4885 52594.1020  19.5%  1102  481s
  8754  2150     cutoff   29      44029.4885 52412.8645  19.0%  1105  488s
  9044  2091 45114.8837   27  261 44029.4885 52106.6561  18.3%  1108  497s
  9368  2035 48389.7442   23  278 44029.4885 51991.2668  18.1%  1109  504s
  9670  1968 45065.5152   27  271 44029.4885 51991.2668  18.1%  1104  514s
 10028  2005     cutoff   32      44029.4885 51704.8400  17.4%  1105  521s
 10434  2028 47299.8902   28  213 44029.4885 51474.9020  16.9%  1103  530s
 10791  2068 45810.7215   28  267 44029.4885 51285.2461  16.5%  1102  539s
 11194  2064 44522.3218   28  155 44029.4885 51068.5001  16.0%  1102  548s
 11314  2080     cutoff   28      44029.4885 51068.5001  16.0%  1103  557s
 11624  2103     cutoff   27      44029.4885 50814.8454  15.4%  1099  567s
 12081  2109     cutoff   29      44029.4885 50694.1701  15.1%  1098  576s
 12653  2108 45482.1689   28  255 44029.4885 50297.6635  14.2%  1090  586s
 13231  2103 46265.4956   29  253 44029.4885 50081.8301  13.7%  1085  597s
 13711  2110 45945.5809   29  235 44029.4885 49835.9785  13.2%  1083  607s
 14365  2114 44119.7440   31  232 44029.4885 49639.1616  12.7%  1075  618s
H14367  2098                    44122.973132 49639.1616  12.5%  1075  618s
 14441  2078     cutoff   32      44122.9731 49639.1616  12.5%  1075  630s
 14751  2016 45933.1161   27  200 44122.9731 49501.9867  12.2%  1071  642s
 15407  1946     cutoff   29      44122.9731 49326.6176  11.8%  1067  654s
 16098  1841     cutoff   32      44122.9731 48854.7307  10.7%  1063  670s
 16746  1662     cutoff   27      44122.9731 48598.2279  10.1%  1059  682s
 17584  1456     cutoff   26      44122.9731 48258.1871  9.37%  1051  696s
 18390  1137     cutoff   28      44122.9731 47869.4868  8.49%  1046  711s
 19287   582 infeasible   27      44122.9731 47274.3146  7.14%  1039  725s
 24197   413     cutoff   53      44122.9731 44683.3513  1.27%   868  731s
*24652   413              73    44152.732382 44670.9656  1.17%   852  731s
*25616   413              90    44183.546235 44590.0635  0.92%   822  731s

Cutting planes:
  Learned: 1
  MIR: 383
  Flow cover: 780
  RLT: 16
  Relax-and-lift: 79

Explored 28120 nodes (21190172 simplex iterations) in 732.71 seconds (1485.26 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 44183.5 44152.7 44123 ... 42852.6

Optimal solution found (tolerance 1.00e-04)
Best objective 4.418354623474e+04, best bound 4.418354623474e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 732.71s
  Master Objective (UB) = 44183.55, θ = 218294.23
  Upper Bound (UB) = 44183.55

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 218294.23
  [DEBUG]   ✓ Scenario 0: θ = 218294.23 ≤ Q = 218294.23 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 218294.23 ≤ Q = 218294.23 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 218294.23 ≤ Q = 218294.23 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x34ff95d8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x34ff95d8
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.331388e+13
Presolve removed 2588 rows and 1879 columns
Presolve time: 0.01s
Presolved: 505 rows, 510 columns, 1430 nonzeros
Found heuristic solution: objective 6614174.4458
Variable types: 346 continuous, 164 integer (164 binary)

Root relaxation: objective -1.639209e+05, 269 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -163920.89    0  131 6614174.45 -163920.89   102%     -    0s
H    0     0                    -127065.5255 -163920.89  29.0%     -    0s
H    0     0                    -129862.4898 -163920.89  26.2%     -    0s
H    0     0                    -147113.3089 -163920.89  11.4%     -    0s
     0     0 -151008.39    0   89 -147113.31 -151008.39  2.65%     -    0s
H    0     0                    -149210.8223 -150925.20  1.15%     -    0s
     0     0 -150108.99    0   93 -149210.82 -150108.99  0.60%     -    0s
     0     0 -150091.67    0   93 -149210.82 -150091.67  0.59%     -    0s
     0     0 -150046.45    0   93 -149210.82 -150046.45  0.56%     -    0s
     0     0 -149640.24    0   35 -149210.82 -149640.24  0.29%     -    0s
H    0     0                    -149550.4293 -149639.20  0.06%     -    0s
     0     0 -149635.73    0   24 -149550.43 -149635.73  0.06%     -    0s
     0     0 -149594.79    0   20 -149550.43 -149594.79  0.03%     -    0s
     0     0 -149586.27    0    7 -149550.43 -149586.27  0.02%     -    0s
     0     0 -149576.85    0    4 -149550.43 -149576.85  0.02%     -    0s
     0     0 -149576.85    0    8 -149550.43 -149576.85  0.02%     -    0s
H    0     0                    -149551.0670 -149576.85  0.02%     -    0s
     0     0          -    0      -149551.07 -149565.13  0.01%     -    0s

Cutting planes:
  Implied bound: 2
  MIR: 5
  Flow cover: 3
  RLT: 1
  Relax-and-lift: 1

Explored 1 nodes (711 simplex iterations) in 0.10 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -149551 -149550 -149505 ... 1.33139e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.495510669685e+05, best bound -1.495651333144e+05, gap 0.0094%
  Subproblem solved in 0.14s
  Worst-case operational profit (Z_SP) = 199246.39
  Scenario: 30 demand increases, 30 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -149551.07
  [DEBUG]   S×d_nominal = 348797.46
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 348797.46 + -149551.07 = 199246.39
  [DEBUG]   Current θ from Master = 218294.23
  [DEBUG]   ⚠️  Z_SP ≤ θ by 19047.84 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 25135.71
  Lower Bound (LB) = 38407.27
  Gap (UB-LB) = 5776.2762, Absolute Gap = 5776.2762, Relative Gap = 0.130734
  Not converged yet (gap = 5776.28 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 30 increases, 30 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178467 nonzeros
Model fingerprint: 0x7faee871
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve produced solution with objective 25135.7 (0.03s)
MIP start from previous solve produced solution with objective 25135.7 (0.03s)
Loaded MIP start from previous solve with objective 25135.7

Presolve removed 27492 rows and 11162 columns
Presolve time: 0.92s
Presolved: 35051 rows, 16058 columns, 216579 nonzeros
Variable types: 13799 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 35051 rows, 16058 columns, 216579 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   48619    3.8550918e+04   0.000000e+00   1.096409e+07      5s
Concurrent spin time: 0.71s

Solved with dual simplex

Root relaxation: objective 7.821698e+04, 21501 iterations, 7.86 seconds (10.19 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 78216.9774    0   92 25135.7062 78216.9774   211%     -    9s
H    0     0                    25663.160181 78216.9774   205%     -    9s
H    0     0                    41244.720829 78216.9774  89.6%     -    9s
H    0     0                    41419.436955 78216.9774  88.8%     -    9s
     0     0 71433.1671    0  168 41419.4370 71433.1671  72.5%     -   14s
     0     0 71245.1380    0  171 41419.4370 71245.1380  72.0%     -   16s
     0     0 71245.1380    0  177 41419.4370 71245.1380  72.0%     -   17s
     0     0 71245.1380    0  182 41419.4370 71245.1380  72.0%     -   17s
     0     0 71245.1380    0  177 41419.4370 71245.1380  72.0%     -   18s
     0     0 71245.1380    0  177 41419.4370 71245.1380  72.0%     -   18s
     0     0 68835.0980    0  211 41419.4370 68835.0980  66.2%     -   23s
     0     0 68261.2443    0  246 41419.4370 68261.2443  64.8%     -   25s
     0     0 68004.7554    0  260 41419.4370 68004.7554  64.2%     -   27s
     0     0 67925.3439    0  249 41419.4370 67925.3439  64.0%     -   29s
     0     0 67903.9593    0  252 41419.4370 67903.9593  63.9%     -   29s
     0     0 67902.4437    0  248 41419.4370 67902.4437  63.9%     -   29s
     0     0 67901.3611    0  255 41419.4370 67901.3611  63.9%     -   30s
     0     0 67901.3397    0  255 41419.4370 67901.3397  63.9%     -   30s
     0     0 66455.3559    0  283 41419.4370 66455.3559  60.4%     -   37s
     0     0 65870.6721    0  302 41419.4370 65870.6721  59.0%     -   40s
     0     0 65741.8279    0  309 41419.4370 65741.8279  58.7%     -   41s
     0     0 65675.3613    0  309 41419.4370 65675.3613  58.6%     -   42s
     0     0 65653.3447    0  308 41419.4370 65653.3447  58.5%     -   42s
     0     0 65644.1869    0  311 41419.4370 65644.1869  58.5%     -   43s
     0     0 65641.5850    0  308 41419.4370 65641.5850  58.5%     -   43s
     0     0 65635.8463    0  308 41419.4370 65635.8463  58.5%     -   43s
     0     0 65633.7312    0  310 41419.4370 65633.7312  58.5%     -   43s
     0     0 65633.4531    0  309 41419.4370 65633.4531  58.5%     -   43s
     0     0 65163.0551    0  321 41419.4370 65163.0551  57.3%     -   48s
     0     0 64920.2161    0  331 41419.4370 64920.2161  56.7%     -   53s
     0     0 64882.9674    0  375 41419.4370 64882.9674  56.6%     -   53s
     0     0 64858.1214    0  376 41419.4370 64858.1214  56.6%     -   54s
     0     0 64826.6997    0  330 41419.4370 64826.6997  56.5%     -   55s
     0     0 64804.6593    0  402 41419.4370 64804.6593  56.5%     -   55s
     0     0 64802.6801    0  375 41419.4370 64802.6801  56.5%     -   55s
     0     0 64800.5365    0  413 41419.4370 64800.5365  56.4%     -   56s
     0     0 64799.9238    0  408 41419.4370 64799.9238  56.4%     -   56s
     0     0 64685.6059    0  350 41419.4370 64685.6059  56.2%     -   58s
     0     0 64660.6450    0  389 41419.4370 64660.6450  56.1%     -   58s
     0     0 64653.9641    0  390 41419.4370 64653.9641  56.1%     -   59s
     0     0 64653.3673    0  389 41419.4370 64653.3673  56.1%     -   59s
     0     0 64626.2513    0  356 41419.4370 64626.2513  56.0%     -   60s
     0     0 64608.0231    0  426 41419.4370 64608.0231  56.0%     -   63s
     0     0 64605.3050    0  429 41419.4370 64605.3050  56.0%     -   64s
     0     0 64602.6839    0  433 41419.4370 64602.6839  56.0%     -   64s
     0     0 64602.4717    0  436 41419.4370 64602.4717  56.0%     -   64s
     0     0 64584.4092    0  395 41419.4370 64584.4092  55.9%     -   65s
     0     0 64576.3220    0  409 41419.4370 64576.3220  55.9%     -   66s
     0     0 64575.4260    0  358 41419.4370 64575.4260  55.9%     -   66s
     0     0 64568.5690    0  410 41419.4370 64568.5690  55.9%     -   67s
     0     0 64563.2246    0  451 41419.4370 64563.2246  55.9%     -   68s
     0     0 64562.6524    0  412 41419.4370 64562.6524  55.9%     -   68s
     0     0 64562.0657    0  444 41419.4370 64562.0657  55.9%     -   69s
     0     0 64557.6102    0  417 41419.4370 64557.6102  55.9%     -   69s
     0     0 64555.5888    0  417 41419.4370 64555.5888  55.9%     -   70s
     0     0 64554.7757    0  415 41419.4370 64554.7757  55.9%     -   70s
     0     0 64551.1582    0  373 41419.4370 64551.1582  55.8%     -   70s
     0     0 64549.0208    0  373 41419.4370 64549.0208  55.8%     -   71s
     0     2 64547.1140    0  373 41419.4370 64547.1140  55.8%     -   82s
     1     4 64479.2322    1  366 41419.4370 64542.2479  55.8%  1048   86s
     3     8 64348.8913    2  404 41419.4370 64475.4599  55.7%  2599   90s
     7    16 64164.5164    3  380 41419.4370 64345.6477  55.4%  3032   95s
    15    32 64045.9099    4  361 41419.4370 64164.4630  54.9%  3124  100s
    31    64 63502.3731    5  389 41419.4370 64041.8190  54.6%  3802  106s
    63    96 63125.0787    6  391 41419.4370 63622.9048  53.6%  3297  110s
H  141   149                    41977.540422 63622.9048  51.6%  2332  114s
   148   244 62920.8232    8  399 41977.5404 63622.9048  51.6%  2263  119s
   243   326 61713.8546    9  362 41977.5404 63622.9048  51.6%  1887  125s
H  246   326                    42115.668700 63622.9048  51.1%  1889  125s
H  250   326                    42492.601623 63622.9048  49.7%  1897  125s
H  262   326                    42629.617499 63622.9048  49.2%  1902  125s
H  394   461                    42771.382470 63622.9048  48.8%  1713  133s
H  405   461                    42839.183316 63622.9048  48.5%  1709  133s
   460   541 62059.6737   12  371 42839.1833 63622.9048  48.5%  1669  136s
   572   624 61821.0183   13  369 42839.1833 63622.9048  48.5%  1565  143s
   623   656 61992.7921   14  391 42839.1833 63622.9048  48.5%  1516  148s
   655   690 61840.0393   14  381 42839.1833 63622.9048  48.5%  1521  153s
H  684   690                    42904.177171 63622.9048  48.3%  1512  153s
H  687   690                    43406.068251 63622.9048  46.6%  1507  153s
   689   769 61931.9481   15  383 43406.0683 63622.9048  46.6%  1504  158s
   768   801 60407.9448   16  380 43406.0683 63622.9048  46.6%  1476  162s
   800   840 59720.1923   16  325 43406.0683 63622.9048  46.6%  1507  169s
   839   882 60282.6782   17  378 43406.0683 63622.9048  46.6%  1574  173s
   881   923 60069.4963   18  377 43406.0683 63622.9048  46.6%  1580  178s
   926   970 59789.6656   19  362 43406.0683 63622.9048  46.6%  1575  183s
   973  1000 57897.7123   20  324 43406.0683 63622.9048  46.6%  1577  187s
  1021  1040 56654.8557   20  362 43406.0683 63622.9048  46.6%  1586  192s
  1067  1090 54309.4091   21  280 43406.0683 63622.9048  46.6%  1599  199s
  1137  1154 54885.5668   21  315 43406.0683 63500.8446  46.3%  1588  204s
  1211  1230 51235.9489   22  289 43406.0683 63500.8446  46.3%  1577  209s
  1305  1304 53196.0871   22  322 43406.0683 63500.8446  46.3%  1557  214s
  1393  1393 50778.8054   23  264 43406.0683 63500.8446  46.3%  1548  219s
  1484  1510 48768.0390   24  261 43406.0683 63102.2701  45.4%  1531  224s
  1603  1658 50152.0030   26  275 43406.0683 63102.2701  45.4%  1491  230s
  1767  1802 49522.1630   32  283 43406.0683 63102.2701  45.4%  1422  235s
  1927  1975 49287.2189   33  243 43406.0683 63102.2701  45.4%  1368  241s
  2135  2166 47371.7332   34  230 43406.0683 62909.5226  44.9%  1298  247s
  2344  2352     cutoff   38      43406.0683 62909.5226  44.9%  1240  253s
  2575  2556 45103.0108   44  215 43406.0683 62782.5328  44.6%  1182  260s
  2814  2802 44498.8436   51  237 43406.0683 62660.9835  44.4%  1132  266s
  3110  3028     cutoff   26      43406.0683 62477.4770  43.9%  1069  273s
  3405  3260 58435.6972   11  320 43406.0683 62451.2724  43.9%  1019  280s
  3718  3471 57157.3441   14  300 43406.0683 62451.2724  43.9%   978  288s
  4007  3472 48471.6668   32  373 43406.0683 62451.2724  43.9%   951  309s
  4009  3473 52138.8071   37   92 43406.0683 62451.2724  43.9%   950  321s
  4010  3474 51921.4992   44  278 43406.0683 62451.2724  43.9%   950  331s
  4011  3475 54125.9168   32  293 43406.0683 62451.2724  43.9%   950  335s
  4013  3476 55557.2828   15  340 43406.0683 62451.2724  43.9%   950  341s
  4016  3478 45826.4341  115  392 43406.0683 62451.2724  43.9%   949  346s
  4020  3481 48046.1920   34  410 43406.0683 62451.2724  43.9%   948  352s
  4023  3483 46727.0663   63  412 43406.0683 62451.2724  43.9%   947  355s
  4026  3485 46378.6665   60  338 43406.0683 62451.2724  43.9%   946  360s
  4030  3487 49314.7894   40  386 43406.0683 62451.2724  43.9%   946  367s
  4032  3489 51377.8411   21  394 43406.0683 62451.2724  43.9%   945  370s
  4035  3491 57785.0275   17  376 43406.0683 62451.2724  43.9%   944  375s
  4038  3493 54058.9473   13  446 43406.0683 62451.2724  43.9%   944  380s
  4040  3494 46556.5719   50  423 43406.0683 62451.2724  43.9%   943  396s
  4041  3495 51583.1172   26  423 43406.0683 62451.2724  43.9%   943  406s
  4042  3498 62451.2724   11  419 43406.0683 62451.2724  43.9%   961  421s
  4044  3502 62451.2724   12  425 43406.0683 62451.2724  43.9%   962  430s
  4048  3508 62451.2724   13  387 43406.0683 62451.2724  43.9%   963  441s
  4056  3522 62451.2724   14  408 43406.0683 62451.2724  43.9%   972  453s
  4072  3538 62451.2724   15  405 43406.0683 62451.2724  43.9%   989  467s
  4094  3563 62451.2724   16  400 43406.0683 62451.2724  43.9%  1032  476s
  4126  3584 59178.4230   17  316 43406.0683 62451.2724  43.9%  1044  483s
  4158  3608 58802.9222   18  312 43406.0683 62451.2724  43.9%  1092  492s
H 4183  3423                    43445.761862 62451.2724  43.7%  1101  492s
  4192  3533 54366.9226   19  302 43445.7619 62451.2724  43.7%  1105  503s
  4308  3588 57263.5614   21  280 43445.7619 62451.2724  43.7%  1133  509s
  4413  3581 56885.6921   22  280 43445.7619 62451.2724  43.7%  1138  515s
  4447  3611 55013.6265   22  278 43445.7619 62451.2724  43.7%  1145  522s
  4528  3636 55829.0983   23  263 43445.7619 62451.2724  43.7%  1145  531s
  4609  3659 49729.7672   23  268 43445.7619 62451.2724  43.7%  1149  537s
  4683  3687 54681.7824   24  239 43445.7619 62451.2724  43.7%  1156  546s
  4759  3710 54304.7019   24  230 43445.7619 62451.2724  43.7%  1163  552s
  4831  3713 53860.1866   25  199 43445.7619 62451.2724  43.7%  1171  559s
  4901  3711 51572.2492   25  222 43445.7619 62451.2724  43.7%  1178  567s
  4983  3725     cutoff   26      43445.7619 60851.5961  40.1%  1191  576s
  5047  3724 52018.4770   27  233 43445.7619 60702.8900  39.7%  1202  581s
  5092  3755 48643.2907   27  125 43445.7619 60646.7526  39.6%  1210  587s
  5143  3789 51147.3496   28  160 43445.7619 60221.8158  38.6%  1219  595s
  5211  3820 48205.2295   28  222 43445.7619 60221.8158  38.6%  1225  603s
  5306  3828 43568.0091   29  197 43445.7619 60154.5479  38.5%  1231  609s
  5412  3831 47649.0365   30  217 43445.7619 60154.5479  38.5%  1232  618s
  5530  3817 44803.1987   31  136 43445.7619 59758.6254  37.5%  1235  627s
  5619  3834     cutoff   32      43445.7619 59758.6254  37.5%  1252  638s
  5702  3857 44590.0887   35  189 43445.7619 59255.9401  36.4%  1269  645s
  5799  3882 54690.9929   20  261 43445.7619 59255.9401  36.4%  1280  652s
  5892  3874 54330.1187   21  243 43445.7619 59255.9401  36.4%  1290  657s
  5928  3885 53588.7441   22  208 43445.7619 59255.9401  36.4%  1291  664s
  6010  3907 52830.2776   23  173 43445.7619 58823.5394  35.4%  1290  675s
  6131  3931 50868.8419   26  157 43445.7619 58823.5394  35.4%  1293  683s
  6291  3971 45338.0731   31  118 43445.7619 58537.6055  34.7%  1294  694s
  6471  3975     cutoff   41      43445.7619 58537.6055  34.7%  1291  703s
  6651  3973 51969.5307   17  320 43445.7619 58207.5036  34.0%  1290  712s
  6858  3968 49932.0530   18  263 43445.7619 58064.0936  33.6%  1286  724s
  7005  4012 50595.2515   21  281 43445.7619 57997.6437  33.5%  1296  738s
  7151  4079 48240.8655   23  179 43445.7619 57997.6437  33.5%  1308  750s
  7345  4129     cutoff   28      43445.7619 57971.3521  33.4%  1312  760s
  7626  4092     cutoff   39      43445.7619 57971.3521  33.4%  1303  770s
  7928  4064 51062.6512   21  318 43445.7619 57369.3795  32.0%  1294  783s
  8147  4092 47540.9076   26  178 43445.7619 57272.4293  31.8%  1298  797s
  8380  4054 49262.3547   22  327 43445.7619 56678.4862  30.5%  1305  809s
  8557  4076 47037.6630   23  293 43445.7619 56678.4862  30.5%  1306  821s
  8712  4099 43593.7901   26  261 43445.7619 56678.4862  30.5%  1318  833s
  8908  4097 43917.8083   25  222 43445.7619 56678.4862  30.5%  1327  848s
  9160  4063 45767.3850   22  171 43445.7619 56616.8698  30.3%  1336  863s
H 9172  3892                    43505.475108 56616.8698  30.1%  1336  863s
  9370  3939 48141.7881   20  318 43505.4751 56353.2347  29.5%  1343  877s
  9617  3975 47558.1371   22  285 43505.4751 55682.9842  28.0%  1353  893s
  9892  3981 48725.6288   22  329 43505.4751 55515.9437  27.6%  1361  909s
 10212  3977 infeasible   26      43505.4751 55476.8051  27.5%  1366  926s
 10522  3955 48314.0594   18  283 43505.4751 55453.7192  27.5%  1374  942s
 10868  3973     cutoff   29      43505.4751 55090.6722  26.6%  1378  958s
 11209  3933 46092.6638   27  148 43505.4751 54833.3187  26.0%  1384  976s
 11533  3933 45758.4245   22  290 43505.4751 54566.4500  25.4%  1394  995s
 11895  3927     cutoff   25      43505.4751 54418.2490  25.1%  1401 1012s
 12221  3888     cutoff   30      43505.4751 54418.2490  25.1%  1410 1032s
 12670  3825 47405.8353   23  335 43505.4751 54183.3815  24.5%  1413 1053s
 13121  3762 44606.4671   22  285 43505.4751 53898.6965  23.9%  1417 1075s
 13607  3770 48809.0418   26  293 43505.4751 53570.3550  23.1%  1420 1097s
 13988  3894 47545.4258   22  275 43505.4751 53570.3550  23.1%  1426 1120s
 14482  4032     cutoff   26      43505.4751 53324.7372  22.6%  1432 1142s
 15041  4159 infeasible   26      43505.4751 53094.3407  22.0%  1429 1168s
 15658  4270 49048.6989   24  224 43505.4751 52958.6961  21.7%  1427 1192s
 16224  4403 44743.8362   30  187 43505.4751 52640.8035  21.0%  1431 1216s
 16810  4495 48810.8321   21  298 43505.4751 52561.2411  20.8%  1433 1242s
 17390  4642 45703.0503   25  182 43505.4751 52310.2858  20.2%  1434 1268s
 18047  4795 49794.3438   21  272 43505.4751 52153.4070  19.9%  1434 1296s
 18575  4882 46120.4505   25  242 43505.4751 52119.3820  19.8%  1433 1326s
 19250  5059 45313.4927   25  241 43505.4751 51917.0078  19.3%  1440 1356s
 19920  5259     cutoff   35      43505.4751 51771.1696  19.0%  1445 1386s
 20655  5348 45135.9653   25  150 43505.4751 51678.8437  18.8%  1446 1418s
 21460  5432 49079.2411   24  287 43505.4751 51359.4658  18.1%  1447 1451s
 22244  5570 47545.8875   19  280 43505.4751 51150.9362  17.6%  1451 1484s
 23066  5664     cutoff   28      43505.4751 50986.2403  17.2%  1453 1519s
 23965  5672 46789.7666   25  210 43505.4751 50920.1214  17.0%  1453 1554s
H23988  5546                    44029.488475 50920.1214  15.7%  1453 1554s
 24040  5559 46496.2291   26  200 44029.4885 50920.1214  15.7%  1453 1590s
 24723  5602     cutoff   27      44029.4885 50837.9915  15.5%  1454 1628s
 25603  5621 46556.7932   30  212 44029.4885 50517.6247  14.7%  1452 1668s
 26545  5658 45159.0425   23  247 44029.4885 50299.6367  14.2%  1447 1708s
 27722  5644 46311.6566   28  259 44029.4885 50062.8119  13.7%  1443 1749s
 28964  5653 46529.1667   27  294 44029.4885 49824.3407  13.2%  1439 1791s
 30244  5672     cutoff   27      44029.4885 49591.6947  12.6%  1434 1833s
 31447  5592     cutoff   28      44029.4885 49410.1860  12.2%  1434 1881s
 32860  5547     cutoff   30      44029.4885 49118.5792  11.6%  1431 1923s
 34028  5409     cutoff   24      44029.4885 48917.4157  11.1%  1430 1971s
 35324  5290 44916.1283   25  199 44029.4885 48720.9968  10.7%  1427 2016s
 36668  5147     cutoff   26      44029.4885 48450.9257  10.0%  1424 2063s
 38051  4913     cutoff   22      44029.4885 48197.8509  9.47%  1421 2114s
 39471  4600 45045.4271   32  164 44029.4885 47976.8660  8.97%  1418 2164s
 41018  4162     cutoff   27      44029.4885 47648.7338  8.22%  1413 2216s
 42663  3545     cutoff   27      44029.4885 47381.0380  7.61%  1407 2267s
 44524  2697 infeasible   27      44029.4885 47032.7670  6.82%  1397 2319s
 46734  1060 45413.2427   26  283 44029.4885 46468.8660  5.54%  1378 2365s
 49329    10     cutoff   25      44029.4885 45457.6126  3.24%  1340 2382s

Cutting planes:
  MIR: 606
  Mixing: 5
  Flow cover: 1195
  RLT: 18
  Relax-and-lift: 77

Explored 51528 nodes (66613760 simplex iterations) in 2382.71 seconds (5128.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 44029.5 44029.5 43505.5 ... 42492.6

Optimal solution found (tolerance 1.00e-04)
Best objective 4.402948847466e+04, best bound 4.402948847466e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2382.73s
  Master Objective (UB) = 44029.49, θ = 227191.33
  Upper Bound (UB) = 44029.49

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 227191.33
  [DEBUG]   ✓ Scenario 0: θ = 227191.33 ≤ Q = 238143.92 (slack: 10952.59)
  [DEBUG]   ✓ Scenario 1: θ = 227191.33 ≤ Q = 227191.33 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 227191.33 ≤ Q = 227191.33 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 227191.33 ≤ Q = 227191.33 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x19995f1a
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x19995f1a
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.392333e+13
Presolve removed 2585 rows and 1875 columns
Presolve time: 0.01s
Presolved: 508 rows, 514 columns, 1433 nonzeros
Found heuristic solution: objective 6922841.4540
Variable types: 350 continuous, 164 integer (164 binary)

Root relaxation: objective -1.761623e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -176162.28    0  122 6922841.45 -176162.28   103%     -    0s
H    0     0                    -139909.6854 -176162.28  25.9%     -    0s
H    0     0                    -140247.3741 -176162.28  25.6%     -    0s
H    0     0                    -144548.6385 -155352.47  7.47%     -    0s
H    0     0                    -148759.0015 -155352.47  4.43%     -    0s
     0     0 -155352.47    0   57 -148759.00 -155352.47  4.43%     -    0s
H    0     0                    -152464.3037 -155302.96  1.86%     -    0s
H    0     0                    -152807.8353 -155302.96  1.63%     -    0s
H    0     0                    -153755.8279 -155093.86  0.87%     -    0s
H    0     0                    -154110.5888 -155093.86  0.64%     -    0s
     0     0 -155093.86    0   44 -154110.59 -155093.86  0.64%     -    0s
     0     0 -155091.96    0   54 -154110.59 -155091.96  0.64%     -    0s
     0     0 -154686.48    0   42 -154110.59 -154686.48  0.37%     -    0s
H    0     0                    -154248.9976 -154674.09  0.28%     -    0s
     0     0 -154631.54    0   42 -154249.00 -154631.54  0.25%     -    0s
     0     0 -154607.01    0   39 -154249.00 -154607.01  0.23%     -    0s
     0     0 -154605.92    0   37 -154249.00 -154605.92  0.23%     -    0s
     0     0 -154572.25    0   41 -154249.00 -154572.25  0.21%     -    0s
H    0     0                    -154282.1177 -154572.25  0.19%     -    0s
     0     0 -154485.45    0   16 -154282.12 -154485.45  0.13%     -    0s
     0     0 -154455.18    0   14 -154282.12 -154455.18  0.11%     -    0s
     0     0 -154443.51    0   12 -154282.12 -154443.51  0.10%     -    0s
H    0     0                    -154304.7645 -154443.51  0.09%     -    0s
     0     0 -154399.84    0   13 -154304.76 -154399.84  0.06%     -    0s
     0     0 -154399.32    0    7 -154304.76 -154399.32  0.06%     -    0s
     0     0 -154399.00    0    8 -154304.76 -154399.00  0.06%     -    0s
     0     0 -154378.40    0    6 -154304.76 -154378.40  0.05%     -    0s
     0     0 -154378.40    0   14 -154304.76 -154378.40  0.05%     -    0s
H    0     0                    -154305.5875 -154378.40  0.05%     -    0s
     0     0 -154355.30    0    4 -154305.59 -154355.30  0.03%     -    0s
H    0     0                    -154332.9990 -154351.31  0.01%     -    0s
     0     0          -    0      -154333.00 -154345.42  0.01%     -    0s

Cutting planes:
  Gomory: 5
  Implied bound: 3
  MIR: 6
  Flow cover: 2
  Relax-and-lift: 2

Explored 1 nodes (679 simplex iterations) in 0.15 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -154333 -154306 -154305 ... -148759

Optimal solution found (tolerance 1.00e-04)
Best objective -1.543329989704e+05, best bound -1.543454234894e+05, gap 0.0081%
  Subproblem solved in 0.18s
  Worst-case operational profit (Z_SP) = 213619.20
  Scenario: 20 demand increases, 40 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -154333.00
  [DEBUG]   S×d_nominal = 367952.20
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 367952.20 + -154333.00 = 213619.20
  [DEBUG]   Current θ from Master = 227191.33
  [DEBUG]   ⚠️  Z_SP ≤ θ by 13572.13 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 30457.35
  Lower Bound (LB) = 38407.27
  Gap (UB-LB) = 5622.2184, Absolute Gap = 5622.2184, Relative Gap = 0.127692
  Not converged yet (gap = 5622.22 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 20 increases, 40 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221704 nonzeros
Model fingerprint: 0xc9f9404e
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 34360 rows and 13950 columns
Presolve time: 1.22s
Presolved: 43473 rows, 19510 columns, 269359 nonzeros
Variable types: 17251 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -309441.0403
Found heuristic solution: objective -183060.7998

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 43473 rows, 19510 columns, 269359 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   23974    7.2757405e+03   0.000000e+00   2.472290e+07      5s
   36118    6.0123974e+04   0.000000e+00   3.053154e+07     10s
Concurrent spin time: 1.32s

Solved with dual simplex

Root relaxation: objective 7.821691e+04, 30073 iterations, 13.94 seconds (18.94 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 78216.9100    0   92 -183060.80 78216.9100   143%     -   15s
H    0     0                    -176523.5981 78216.9100   144%     -   15s
H    0     0                    -173465.5898 78216.9100   145%     -   15s
H    0     0                    -161120.2662 78216.9100   149%     -   15s
H    0     0                    -160993.1006 78216.9100   149%     -   15s
H    0     0                    -147028.8290 78216.9100   153%     -   15s
H    0     0                    -146178.4940 78216.9100   154%     -   15s
H    0     0                    -146140.4844 78216.9100   154%     -   15s
H    0     0                    -145802.7834 78216.9100   154%     -   15s
H    0     0                    -145654.5843 78216.9100   154%     -   15s
H    0     0                    -60827.49453 78216.9100   229%     -   16s
H    0     0                    -60805.50683 78216.9100   229%     -   16s
H    0     0                    -19595.73866 78216.9100   499%     -   16s
H    0     0                    -11380.10768 78216.9100   787%     -   16s
H    0     0                    -8187.334276 78216.9100  1055%     -   16s
H    0     0                    -6681.592286 78216.9100  1271%     -   16s
H    0     0                    19217.322668 78216.9100   307%     -   16s
H    0     0                    27778.055353 78216.9100   182%     -   16s
H    0     0                    28533.119516 78216.9100   174%     -   16s
H    0     0                    30537.108334 78216.9100   156%     -   16s
H    0     0                    30537.613197 78216.9100   156%     -   16s
H    0     0                    30542.062861 78216.9100   156%     -   16s
     0     0 71573.2038    0  190 30542.0629 71573.2038   134%     -   22s
H    0     0                    31297.490500 71572.9877   129%     -   22s
H    0     0                    31343.008104 71572.9877   128%     -   22s
     0     0 70915.4442    0  183 31343.0081 70915.4442   126%     -   25s
     0     0 70777.2516    0  186 31343.0081 70777.2516   126%     -   27s
     0     0 70777.2516    0  187 31343.0081 70777.2516   126%     -   27s
     0     0 70777.2516    0  188 31343.0081 70777.2516   126%     -   27s
     0     0 70777.2516    0  191 31343.0081 70777.2516   126%     -   28s
     0     0 70777.2516    0  185 31343.0081 70777.2516   126%     -   28s
     0     0 68261.7985    0  250 31343.0081 68261.7985   118%     -   34s
H    0     0                    31574.889853 68261.7985   116%     -   34s
H    0     0                    33556.897895 68261.7985   103%     -   34s
H    0     0                    35433.488605 67803.7311  91.4%     -   38s
H    0     0                    35632.178282 67803.7311  90.3%     -   38s
H    0     0                    36115.697319 67803.7311  87.7%     -   38s
H    0     0                    36181.084436 67803.7311  87.4%     -   38s
     0     0 67803.7311    0  247 36181.0844 67803.7311  87.4%     -   38s
     0     0 67611.4025    0  257 36181.0844 67611.4025  86.9%     -   40s
     0     0 67561.0390    0  256 36181.0844 67561.0390  86.7%     -   42s
     0     0 67549.0827    0  226 36181.0844 67549.0827  86.7%     -   43s
     0     0 67547.9650    0  223 36181.0844 67547.9650  86.7%     -   43s
     0     0 67547.7655    0  243 36181.0844 67547.7655  86.7%     -   43s
H    0     0                    38565.059128 66039.2283  71.2%     -   56s
H    0     0                    38595.198738 66039.2283  71.1%     -   56s
H    0     0                    38767.865048 66039.2283  70.3%     -   56s
     0     0 66039.2283    0  300 38767.8650 66039.2283  70.3%     -   56s
H    0     0                    38906.222068 66038.6215  69.7%     -   56s
     0     0 65735.1923    0  311 38906.2221 65735.1923  69.0%     -   58s
     0     0 65596.2680    0  302 38906.2221 65596.2680  68.6%     -   60s
     0     0 65514.2189    0  310 38906.2221 65514.2189  68.4%     -   61s
     0     0 65459.2572    0  308 38906.2221 65459.2572  68.2%     -   63s
     0     0 65453.8242    0  319 38906.2221 65453.8242  68.2%     -   63s
     0     0 65453.0534    0  316 38906.2221 65453.0534  68.2%     -   63s
     0     0 64976.6705    0  333 38906.2221 64976.6705  67.0%     -   70s
     0     0 64795.8006    0  343 38906.2221 64795.8006  66.5%     -   72s
     0     0 64756.8112    0  337 38906.2221 64756.8112  66.4%     -   73s
     0     0 64740.1888    0  369 38906.2221 64740.1888  66.4%     -   74s
     0     0 64736.5005    0  344 38906.2221 64736.5005  66.4%     -   76s
     0     0 64732.6779    0  380 38906.2221 64732.6779  66.4%     -   76s
     0     0 64731.8206    0  375 38906.2221 64731.8206  66.4%     -   76s
     0     0 64690.8197    0  343 38906.2221 64690.8197  66.3%     -   78s
H    0     0                    38956.883645 64690.5562  66.1%     -   79s
     0     0 64672.8219    0  357 38956.8836 64672.8219  66.0%     -   80s
     0     0 64669.5649    0  374 38956.8836 64669.5649  66.0%     -   80s
     0     0 64665.0719    0  378 38956.8836 64665.0719  66.0%     -   81s
     0     0 64664.5308    0  352 38956.8836 64664.5308  66.0%     -   81s
     0     0 64617.3006    0  366 38956.8836 64617.3006  65.9%     -   84s
     0     0 64603.2023    0  368 38956.8836 64603.2023  65.8%     -   86s
     0     0 64599.8398    0  409 38956.8836 64599.8398  65.8%     -   87s
     0     0 64598.1637    0  383 38956.8836 64598.1637  65.8%     -   87s
     0     0 64597.8492    0  415 38956.8836 64597.8492  65.8%     -   87s
     0     0 64581.9924    0  389 38956.8836 64581.9924  65.8%     -   89s
     0     0 64578.0035    0  394 38956.8836 64578.0035  65.8%     -   91s
     0     0 64577.3565    0  393 38956.8836 64577.3565  65.8%     -   91s
     0     0 64560.6520    0  420 38956.8836 64560.6520  65.7%     -   93s
     0     0 64550.4363    0  393 38956.8836 64550.4363  65.7%     -   94s
     0     0 64547.8797    0  389 38956.8836 64547.8797  65.7%     -   94s
     0     0 64547.7764    0  386 38956.8836 64547.7764  65.7%     -   95s
     0     0 64544.7163    0  398 38956.8836 64544.7163  65.7%     -   96s
     0     0 64544.0672    0  404 38956.8836 64544.0672  65.7%     -   96s
     0     0 64541.4473    0  401 38956.8836 64541.4473  65.7%     -   97s
     0     0 64537.8260    0  393 38956.8836 64537.8260  65.7%     -   99s
     0     0 64535.2848    0  400 38956.8836 64535.2848  65.7%     -   99s
     0     0 64534.7095    0  400 38956.8836 64534.7095  65.7%     -   99s
     0     0 64533.2622    0  400 38956.8836 64533.2622  65.7%     -  100s
     0     0 64529.9702    0  400 38956.8836 64529.9702  65.6%     -  101s
H    0     0                    39807.432095 64528.7199  62.1%     -  115s
H    0     0                    39948.538798 64528.7199  61.5%     -  115s
H    0     0                    39962.844219 64528.7199  61.5%     -  116s
H    0     0                    40279.724442 64528.7199  60.2%     -  116s
     0     2 64528.7199    0  400 40279.7244 64528.7199  60.2%     -  116s
     3     8 64334.6666    2  392 40279.7244 64359.7359  59.8%  1938  123s
     7    16 64225.0712    3  360 40279.7244 64334.5797  59.7%  2813  128s
    15    32 64018.2776    4  400 40279.7244 64222.3251  59.4%  3971  136s
    31    50 61569.3689    5  346 40279.7244 64018.0177  58.9%  6680  151s
    49    82 59462.1017    6  353 40279.7244 64018.0177  58.9%  6598  164s
H   54    82                    40293.696581 64018.0177  58.9%  6494  164s
H   55    82                    40321.218654 64018.0177  58.8%  6497  164s
H   74    82                    42137.851304 64018.0177  51.9%  5851  164s
    81   165 59424.9890    7  350 42137.8513 64018.0177  51.9%  5518  177s
H  164   298                    42425.827483 64018.0177  50.9%  3218  187s
H  187   298                    42571.165430 64018.0177  50.4%  2977  187s
H  197   298                    42621.894665 64018.0177  50.2%  2881  187s
H  277   298                    42937.205891 64018.0177  49.1%  2457  187s
   297   386 59286.4568   10  332 42937.2059 64018.0177  49.1%  2398  193s
   385   473 58975.6191   11  329 42937.2059 64018.0177  49.1%  2208  199s
   472   561 58956.2304   12  279 42937.2059 64018.0177  49.1%  2033  203s
   562   646 58876.3107   11  312 42937.2059 64018.0177  49.1%  1894  207s
H  584   646                    43023.812777 64018.0177  48.8%  1853  207s
   647   742 58818.0334   11  299 43023.8128 64018.0177  48.8%  1772  213s
   743   824 58881.4232   12  326 43023.8128 64018.0177  48.8%  1662  218s
   825   921 58851.9391   13  273 43023.8128 64018.0177  48.8%  1600  223s
   922   953 58625.6932   14  268 43023.8128 64018.0177  48.8%  1523  227s
   954   987 58683.8481   14  263 43023.8128 64018.0177  48.8%  1505  232s
   988  1019 58669.4189   15  298 43023.8128 64018.0177  48.8%  1490  235s
  1020  1051 58361.5250   15  253 43023.8128 64018.0177  48.8%  1474  242s
H 1046  1051                    43103.837633 64018.0177  48.5%  1463  242s
  1052  1175 58472.0164   16  299 43103.8376 64018.0177  48.5%  1458  251s
  1186  1315 58408.4233   16  287 43103.8376 64018.0177  48.5%  1368  257s
  1338  1424 58347.3387   15  248 43103.8376 64018.0177  48.5%  1291  267s
  1489  1532 58341.5522   18  296 43103.8376 64018.0177  48.5%  1234  276s
  1639  1638 58363.4111   17  253 43103.8376 64018.0177  48.5%  1202  286s
  1761  1670 58037.2986   18  254 43103.8376 64018.0177  48.5%  1185  291s
  1793  1703 57848.4445   18  240 43103.8376 64018.0177  48.5%  1186  296s
  1864  1765 57524.7102   19  255 43103.8376 64018.0177  48.5%  1187  302s
H 1867  1765                    43165.220563 64018.0177  48.3%  1185  302s
  1900  1919 58081.0813   20  269 43165.2206 64018.0177  48.3%  1181  313s
  2080  2055 57252.4519   24  230 43165.2206 64018.0177  48.3%  1136  323s
  2280  2196 55032.0214   24  255 43165.2206 63890.7474  48.0%  1091  331s
  2485  2386 56735.1796   25  249 43165.2206 63890.7474  48.0%  1065  337s
  2712  2413 56819.5287   26  241 43165.2206 63890.7474  48.0%  1025  344s
H 2713  2413                    43224.933809 63890.7474  47.8%  1025  344s
  2749  2571 57046.4653   26  259 43224.9338 63890.7474  47.8%  1029  354s
  2967  2640 56176.5852   31  251 43224.9338 63890.7474  47.8%  1011  363s
  3090  2742 53766.6198   32  236 43224.9338 63683.6662  47.3%  1040  372s
  3210  2863 49815.5937   30  193 43224.9338 63683.6662  47.3%  1061  384s
  3369  3029 52312.1419   32  216 43224.9338 62995.1199  45.7%  1069  395s
  3578  3030 61872.2719   12  400 43224.9338 62995.1199  45.7%  1063  430s
  3580  3031 53119.6045   33   92 43224.9338 62995.1199  45.7%  1062  460s
  3581  3032 52536.4030   39  278 43224.9338 62995.1199  45.7%  1062  473s
  3582  3033 58393.2555   30  311 43224.9338 62995.1199  45.7%  1062  481s
  3583  3033 50860.4915   26  350 43224.9338 62995.1199  45.7%  1061  487s
  3584  3034 52304.6459   47  347 43224.9338 62995.1199  45.7%  1061  491s
  3586  3035 48001.7464   35  365 43224.9338 62995.1199  45.7%  1060  498s
  3587  3036 52298.3824   43  353 43224.9338 62995.1199  45.7%  1060  501s
  3591  3039 46083.2099   66  402 43224.9338 62995.1199  45.7%  1059  506s
  3592  3039 60540.9558   10  399 43224.9338 62995.1199  45.7%  1059  511s
  3595  3041 60350.4098   12  408 43224.9338 62995.1199  45.7%  1058  515s
  3597  3043 59433.5979    7  385 43224.9338 62995.1199  45.7%  1057  520s
  3600  3045 56646.9905   45  442 43224.9338 62995.1199  45.7%  1056  526s
  3601  3045 57419.6551   12  394 43224.9338 62995.1199  45.7%  1056  531s
  3603  3047 58083.4879   25  401 43224.9338 62995.1199  45.7%  1055  536s
  3605  3048 58713.0772    9  400 43224.9338 62995.1199  45.7%  1055  541s
  3606  3049 57567.0198   10  399 43224.9338 62995.1199  45.7%  1055  545s
  3608  3050 61344.5311    9  433 43224.9338 62995.1199  45.7%  1054  550s
  3610  3051 56697.7701   14  407 43224.9338 62995.1199  45.7%  1053  555s
  3612  3053 54112.9835   28  392 43224.9338 62995.1199  45.7%  1053  560s
  3613  3053 50946.8224   39  392 43224.9338 62995.1199  45.7%  1053  589s
  3614  3054 59952.3277   11  392 43224.9338 62995.1199  45.7%  1052  605s
  3615  3058 62995.1199   15  387 43224.9338 62995.1199  45.7%  1090  624s
  3617  3061 62995.1199   16  381 43224.9338 62995.1199  45.7%  1093  637s
  3621  3068 62995.1199   17  422 43224.9338 62995.1199  45.7%  1097  651s
  3629  3081 62995.1199   18  363 43224.9338 62995.1199  45.7%  1107  670s
  3645  3094 59987.2788   19  329 43224.9338 62995.1199  45.7%  1142  697s
  3663  3120 60074.3520   20  355 43224.9338 62995.1199  45.7%  1176  716s
  3695  3155 58530.5969   21  352 43224.9338 62995.1199  45.7%  1209  733s
H 3738  2987                    43305.691819 62995.1199  45.5%  1296  733s
  3741  3099 58029.2211   22  304 43305.6918 62995.1199  45.5%  1304  749s
  3854  3135 57429.3115   25  335 43305.6918 62995.1199  45.5%  1338  760s
  3944  3162 51949.3668   25  244 43305.6918 62995.1199  45.5%  1357  773s
  4034  3164 56701.0435   26  306 43305.6918 62995.1199  45.5%  1366  783s
  4066  3191 51966.0247   26  211 43305.6918 62995.1199  45.5%  1378  791s
  4115  3214 56476.3323   27  215 43305.6918 62995.1199  45.5%  1383  804s
  4182  3249 56070.5601   29  227 43305.6918 62995.1199  45.5%  1387  816s
  4261  3273 53117.7428   31  204 43305.6918 62995.1199  45.5%  1392  827s
  4339  3285 54484.6082   30  246 43305.6918 62995.1199  45.5%  1398  836s
  4422  3281 52748.3282   31  299 43305.6918 62995.1199  45.5%  1405  848s
  4499  3284 51342.2591   31  206 43305.6918 62995.1199  45.5%  1409  860s
  4579  3317 52629.7141   30  257 43305.6918 62995.1199  45.5%  1421  870s
  4653  3339 52676.5221   32  216 43305.6918 62995.1199  45.5%  1435  881s
  4737  3358 51748.8068   31  261 43305.6918 62995.1199  45.5%  1443  893s
  4820  3385 50271.3339   33  220 43305.6918 62995.1199  45.5%  1452  905s
  4911  3394 46938.8038   32  191 43305.6918 62995.1199  45.5%  1460  919s
  5005  3387 49412.2816   34  167 43305.6918 60664.2251  40.1%  1477  930s
  5041  3410 49255.1128   35  157 43305.6918 60226.9869  39.1%  1489  941s
  5093  3429 49032.3562   36  220 43305.6918 60226.9869  39.1%  1497  955s
  5173  3446 47999.2450   37  100 43305.6918 60226.9869  39.1%  1506  969s
  5276  3448     cutoff   38      43305.6918 60226.9869  39.1%  1516  985s
  5366  3484     cutoff   42      43305.6918 59649.1322  37.7%  1528  998s
  5474  3478 46111.4818   48  131 43305.6918 59605.6347  37.6%  1541 1006s
  5508  3518 45255.4121   47  126 43305.6918 59605.6347  37.6%  1547 1018s
  5583  3544 44788.0503   59  105 43305.6918 59605.6347  37.6%  1549 1029s
  5707  3572 44355.6176   62   92 43305.6918 59087.2247  36.4%  1553 1042s
  5856  3589 52405.3413   22  350 43305.6918 59087.2247  36.4%  1562 1058s
  6009  3626 51766.8218   23  309 43305.6918 59028.1652  36.3%  1575 1073s
  6137  3660 50136.6587   23  303 43305.6918 59028.1652  36.3%  1588 1089s
  6297  3687 50580.3106   26  257 43305.6918 58780.2635  35.7%  1597 1107s
  6473  3658 47404.9217   30  204 43305.6918 58780.2635  35.7%  1604 1121s
  6524  3683 46266.1110   28  228 43305.6918 58780.2635  35.7%  1610 1134s
  6617  3731 46110.0836   29  222 43305.6918 58780.2635  35.7%  1612 1153s
  6796  3753 49829.1462   30  203 43305.6918 58324.7680  34.7%  1612 1172s
  7020  3762     cutoff   32      43305.6918 58250.6377  34.5%  1611 1190s
  7239  3790 48702.6785   26  271 43305.6918 58250.6377  34.5%  1616 1209s
  7431  3802 43377.2667   32  167 43305.6918 58250.6377  34.5%  1629 1228s
  7588  3842 44287.6178   34  179 43305.6918 57940.2618  33.8%  1635 1247s
  7836  3862 52268.9289   22  269 43305.6918 57783.1983  33.4%  1640 1270s
  8052  3951 49924.9882   26  255 43305.6918 57500.0873  32.8%  1650 1293s
  8292  4010 47173.5299   30  182 43305.6918 57500.0873  32.8%  1658 1319s
  8631  3958 45214.5202   34  202 43305.6918 57482.4141  32.7%  1653 1343s
  8859  3961 43783.3786   37  177 43305.6918 57482.4141  32.7%  1657 1372s
  9099  3965 49737.9420   22  301 43305.6918 57482.4141  32.7%  1675 1399s
  9363  3975     cutoff   24      43305.6918 57366.2045  32.5%  1689 1425s
  9702  4051 48486.0644   25  356 43305.6918 57366.2045  32.5%  1695 1449s
 10152  4075     cutoff   29      43305.6918 56380.7203  30.2%  1682 1477s
 10547  4050 49101.9877   25  224 43305.6918 56317.5807  30.0%  1684 1506s
 10938  4063 46581.0386   23  363 43305.6918 56317.5807  30.0%  1688 1536s
 11356  4062 infeasible   25      43305.6918 56101.5465  29.5%  1690 1568s
 11724  4083 43981.4496   31  200 43305.6918 55007.2427  27.0%  1700 1597s
 12098  4123 50454.1034   27  268 43305.6918 54734.9350  26.4%  1703 1627s
 12499  4229 45280.7335   29  162 43305.6918 54732.7239  26.4%  1711 1662s
 12981  4388 44743.1817   29  159 43305.6918 54490.8763  25.8%  1715 1697s
 13492  4691 47505.5619   28  173 43305.6918 54361.6152  25.5%  1717 1728s
 14087  4844 51660.9373   28  233 43305.6918 54361.6152  25.5%  1709 1764s
 14744  5057 infeasible   40      43305.6918 54149.8950  25.0%  1699 1802s
 15368  5254     cutoff   25      43305.6918 54078.6394  24.9%  1699 1840s
 16001  5485     cutoff   29      43305.6918 53597.8608  23.8%  1698 1880s
 16621  5650 49849.1455   27  323 43305.6918 53525.7931  23.6%  1701 1924s
 17167  5861 44205.8738   26  303 43305.6918 53512.1204  23.6%  1711 1965s
 17738  5875 47102.7569   34  280 43305.6918 53257.4054  23.0%  1722 2001s
 17787  5902 44889.2485   34  171 43305.6918 53257.4054  23.0%  1725 2036s
 17872  5951 44640.2021   35  173 43305.6918 53257.4054  23.0%  1726 2075s
 18041  6064     cutoff   35      43305.6918 53118.8817  22.7%  1727 2120s
 18411  6281 45044.1327   36  164 43305.6918 53097.5154  22.6%  1736 2166s
 19096  6514 47085.5490   30  256 43305.6918 53002.4247  22.4%  1739 2215s
 19804  6756 43877.7300   31  178 43305.6918 52888.2375  22.1%  1747 2266s
 20611  6980 47462.1982   31  201 43305.6918 52888.2375  22.1%  1751 2318s
 21403  7221 48767.9520   27  308 43305.6918 52400.9970  21.0%  1758 2373s
 22178  7479     cutoff   33      43305.6918 52237.4944  20.6%  1767 2431s
 22972  7733 infeasible   40      43305.6918 52068.9367  20.2%  1777 2491s
 23918  7879 infeasible   34      43305.6918 51945.9108  20.0%  1780 2553s
 24695  8105 44924.3002   25  326 43305.6918 51760.6325  19.5%  1792 2619s
 25732  8384 48456.6775   27  302 43305.6918 51617.3928  19.2%  1791 2681s
 26784  8648 45500.1519   30  314 43305.6918 51436.3101  18.8%  1792 2753s
 27856  8887 43806.9778   31  226 43305.6918 51287.5438  18.4%  1794 2819s
 29041  9060     cutoff   34      43305.6918 51109.3488  18.0%  1789 2891s
 30301  9189 45173.1639   34  140 43305.6918 50955.3077  17.7%  1792 2957s
 31357  9409 44588.1488   26  260 43305.6918 50927.9929  17.6%  1792 3027s
 32586  9593 45813.0103   25  279 43305.6918 50722.2808  17.1%  1791 3109s
 33700  9748     cutoff   29      43305.6918 50582.7478  16.8%  1799 3191s
 34909  9897     cutoff   36      43305.6918 50479.9672  16.6%  1806 3277s
 36107 10078     cutoff   30      43305.6918 50345.5857  16.3%  1815 3364s
 37427 10343 46507.9123   35  213 43305.6918 50190.6348  15.9%  1821 3447s
 38751 10544 44855.8513   36  189 43305.6918 50021.4025  15.5%  1823 3537s
 40422 10659 46507.6467   31  239 43305.6918 49859.5630  15.1%  1818 3600s

Cutting planes:
  Learned: 1
  MIR: 926
  Mixing: 6
  Flow cover: 1558
  RLT: 20
  Relax-and-lift: 129

Explored 41559 nodes (75739685 simplex iterations) in 3600.04 seconds (7360.50 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 43305.7 43224.9 43165.2 ... 42137.9

Time limit reached
Best objective 4.330569181869e+04, best bound 4.976805830556e+04, gap 14.9227%
  WARNING: Time limit reached. Using best solution found (gap: 14.92%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.05s
  Master Objective (UB) = 43305.69, θ = 228975.76
  Upper Bound (UB) = 43305.69

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 228975.76
  [DEBUG]   ✓ Scenario 0: θ = 228975.76 ≤ Q = 228975.76 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 228975.76 ≤ Q = 228975.76 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 228975.76 ≤ Q = 228975.76 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 228975.76 ≤ Q = 228975.76 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 228975.76 ≤ Q = 228975.76 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x1af6dbdb
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xe5092425
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.399079e+13
Presolve removed 2584 rows and 1874 columns
Presolve time: 0.01s
Presolved: 509 rows, 515 columns, 1436 nonzeros
Found heuristic solution: objective 6921410.0620
Variable types: 351 continuous, 164 integer (164 binary)

Root relaxation: objective -1.756043e+05, 252 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -175604.28    0  122 6921410.06 -175604.28   103%     -    0s
H    0     0                    -139270.9581 -175604.28  26.1%     -    0s
H    0     0                    -139649.3811 -175604.28  25.7%     -    0s
H    0     0                    -144498.6378 -157408.30  8.93%     -    0s
H    0     0                    -148524.8252 -157408.30  5.98%     -    0s
     0     0 -157408.30    0   53 -148524.83 -157408.30  5.98%     -    0s
H    0     0                    -149758.2793 -157385.04  5.09%     -    0s
H    0     0                    -151181.9265 -157385.04  4.10%     -    0s
H    0     0                    -154178.6846 -157385.04  2.08%     -    0s
     0     0 -155966.36    0   52 -154178.68 -155966.36  1.16%     -    0s
     0     0 -155951.79    0   69 -154178.68 -155951.79  1.15%     -    0s
     0     0 -155951.79    0   69 -154178.68 -155951.79  1.15%     -    0s
     0     0 -155946.84    0   59 -154178.68 -155946.84  1.15%     -    0s
     0     0 -155170.15    0   64 -154178.68 -155170.15  0.64%     -    0s
H    0     0                    -154727.7125 -155103.26  0.24%     -    0s
     0     0 -155103.26    0   64 -154727.71 -155103.26  0.24%     -    0s
     0     0 -155103.26    0   54 -154727.71 -155103.26  0.24%     -    0s
     0     0 -155103.26    0   54 -154727.71 -155103.26  0.24%     -    0s
     0     0 -155103.26    0   51 -154727.71 -155103.26  0.24%     -    0s
     0     0 -155103.26    0   50 -154727.71 -155103.26  0.24%     -    0s
     0     0 -155103.26    0   50 -154727.71 -155103.26  0.24%     -    0s
     0     0 -154900.78    0   27 -154727.71 -154900.78  0.11%     -    0s
     0     0 -154889.25    0   23 -154727.71 -154889.25  0.10%     -    0s
     0     0 -154881.09    0   20 -154727.71 -154881.09  0.10%     -    0s
     0     0 -154842.44    0   22 -154727.71 -154842.44  0.07%     -    0s
     0     0 -154839.75    0   20 -154727.71 -154839.75  0.07%     -    0s
     0     0 -154836.84    0   20 -154727.71 -154836.84  0.07%     -    0s
     0     0 -154836.82    0   19 -154727.71 -154836.82  0.07%     -    0s
     0     0 -154799.22    0   10 -154727.71 -154799.22  0.05%     -    0s
     0     0 -154784.67    0    8 -154727.71 -154784.67  0.04%     -    0s
H    0     0                    -154768.0247 -154784.67  0.01%     -    0s

Cutting planes:
  Gomory: 3
  Implied bound: 4
  MIR: 1
  Flow cover: 4
  RLT: 1

Explored 1 nodes (816 simplex iterations) in 0.29 seconds (0.05 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -154768 -154728 -154563 ... -139271

Optimal solution found (tolerance 1.00e-04)
Best objective -1.547680246864e+05, best bound -1.547790370369e+05, gap 0.0071%
  Subproblem solved in 0.33s
  Worst-case operational profit (Z_SP) = 213844.17
  Scenario: 18 demand increases, 42 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -154768.02
  [DEBUG]   S×d_nominal = 368612.19
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 368612.19 + -154768.02 = 213844.17
  [DEBUG]   Current θ from Master = 228975.76
  [DEBUG]   ⚠️  Z_SP ≤ θ by 15131.60 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 28174.09
  Lower Bound (LB) = 38407.27
  Gap (UB-LB) = 4898.4218, Absolute Gap = 4898.4218, Relative Gap = 0.113113
  Not converged yet (gap = 4898.42 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 18 increases, 42 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 264941 nonzeros
Model fingerprint: 0xed72364e
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 41228 rows and 16738 columns
Presolve time: 1.97s
Presolved: 51895 rows, 22962 columns, 322139 nonzeros
Variable types: 20703 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -309441.0403
Found heuristic solution: objective -183060.7998

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 51895 rows, 22962 columns, 322139 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   25075   -4.8998562e+04   0.000000e+00   4.252554e+07      5s
   38056    2.2321983e+04   0.000000e+00   1.063347e+09     10s
   47757    3.6701975e+04   0.000000e+00   2.487342e+06     15s
   57127    5.3553974e+04   0.000000e+00   1.663877e+06     20s
Concurrent spin time: 4.45s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 7.812145e+04, 48181 iterations, 21.09 seconds (28.93 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 78121.4459    0   95 -183060.80 78121.4459   143%     -   23s
H    0     0                    -176523.5981 78121.4459   144%     -   23s
H    0     0                    -167261.0650 78121.4459   147%     -   23s
H    0     0                    -166906.2449 78121.4459   147%     -   23s
H    0     0                    -146807.8857 78121.4459   153%     -   23s
H    0     0                    -144229.9107 78121.4459   154%     -   23s
H    0     0                    -143968.6039 78121.4459   154%     -   23s
H    0     0                    -142157.5376 78121.4459   155%     -   23s
H    0     0                    -142100.2148 78121.4459   155%     -   23s
H    0     0                    -142092.2535 78121.4459   155%     -   23s
H    0     0                    -57048.71494 78121.4459   237%     -   24s
H    0     0                    -57026.72723 78121.4459   237%     -   24s
H    0     0                    -38728.74049 78121.4459   302%     -   24s
H    0     0                    -26278.98849 78121.4459   397%     -   24s
H    0     0                    2723.0440899 78121.4459  2769%     -   24s
H    0     0                    2907.1568829 78121.4459  2587%     -   24s
H    0     0                    28200.717992 78121.4459   177%     -   24s
H    0     0                    28247.849671 78121.4459   177%     -   24s
H    0     0                    31059.977430 78121.4459   152%     -   25s
     0     0 72130.5041    0  214 31059.9774 72130.5041   132%     -   33s
H    0     0                    31385.608461 72130.5041   130%     -   34s
H    0     0                    31417.761196 71750.4329   128%     -   38s
     0     0 71709.8377    0  236 31417.7612 71709.8377   128%     -   38s
     0     0 71670.0325    0  236 31417.7612 71670.0325   128%     -   39s
     0     0 71653.2300    0  239 31417.7612 71653.2300   128%     -   39s
     0     0 71653.2300    0  237 31417.7612 71653.2300   128%     -   40s
     0     0 71653.2141    0  243 31417.7612 71653.2141   128%     -   40s
H    0     0                    36715.186041 68969.1463  87.8%     -   51s
H    0     0                    37678.336360 68969.1463  83.0%     -   51s
     0     0 68969.1463    0  238 37678.3364 68969.1463  83.0%     -   51s
H    0     0                    38728.575130 68969.0653  78.1%     -   52s
H    0     0                    39401.257905 68969.0653  75.0%     -   52s
H    0     0                    39445.834709 68969.0653  74.8%     -   52s
H    0     0                    39938.095657 68969.0653  72.7%     -   52s
     0     0 68337.4873    0  242 39938.0957 68337.4873  71.1%     -   57s
     0     0 68247.0412    0  236 39938.0957 68247.0412  70.9%     -   58s
     0     0 68197.4449    0  238 39938.0957 68197.4449  70.8%     -   60s
     0     0 68089.9356    0  251 39938.0957 68089.9356  70.5%     -   63s
     0     0 68072.6419    0  248 39938.0957 68072.6419  70.4%     -   64s
     0     0 68053.5247    0  251 39938.0957 68053.5247  70.4%     -   64s
     0     0 68051.4464    0  239 39938.0957 68051.4464  70.4%     -   65s
     0     0 68049.7144    0  239 39938.0957 68049.7144  70.4%     -   66s
     0     0 68049.1650    0  236 39938.0957 68049.1650  70.4%     -   66s
     0     0 66319.2841    0  302 39938.0957 66319.2841  66.1%     -   83s
H    0     0                    39969.110227 66318.6281  65.9%     -   83s
H    0     0                    40258.327318 66318.6281  64.7%     -   83s
H    0     0                    40263.359906 66318.6281  64.7%     -   83s
H    0     0                    40527.035064 66318.6281  63.6%     -   83s
H    0     0                    40613.537741 66318.6281  63.3%     -   83s
H    0     0                    40712.180029 66318.6281  62.9%     -   83s
     0     0 66059.1905    0  300 40712.1800 66059.1905  62.3%     -   88s
     0     0 65889.6031    0  306 40712.1800 65889.6031  61.8%     -   90s
     0     0 65851.3882    0  307 40712.1800 65851.3882  61.7%     -   91s
     0     0 65772.9249    0  310 40712.1800 65772.9249  61.6%     -   94s
     0     0 65726.9952    0  303 40712.1800 65726.9952  61.4%     -   96s
     0     0 65710.6564    0  311 40712.1800 65710.6564  61.4%     -   96s
     0     0 65699.9273    0  306 40712.1800 65699.9273  61.4%     -   97s
     0     0 65690.9136    0  306 40712.1800 65690.9136  61.4%     -   97s
     0     0 65687.3880    0  307 40712.1800 65687.3880  61.3%     -   97s
     0     0 65684.7981    0  309 40712.1800 65684.7981  61.3%     -   98s
     0     0 65683.2810    0  315 40712.1800 65683.2810  61.3%     -   98s
     0     0 65682.6885    0  319 40712.1800 65682.6885  61.3%     -   98s
     0     0 65346.4989    0  323 40712.1800 65346.4989  60.5%     -  105s
     0     0 65041.0584    0  316 40712.1800 65041.0584  59.8%     -  108s
     0     0 64932.5490    0  328 40712.1800 64932.5490  59.5%     -  111s
     0     0 64898.0322    0  326 40712.1800 64898.0322  59.4%     -  112s
     0     0 64871.8136    0  328 40712.1800 64871.8136  59.3%     -  114s
     0     0 64861.1455    0  323 40712.1800 64861.1455  59.3%     -  114s
     0     0 64853.2322    0  322 40712.1800 64853.2322  59.3%     -  115s
     0     0 64850.4020    0  327 40712.1800 64850.4020  59.3%     -  115s
     0     0 64846.7228    0  325 40712.1800 64846.7228  59.3%     -  116s
     0     0 64845.0188    0  325 40712.1800 64845.0188  59.3%     -  116s
     0     0 64845.0173    0  330 40712.1800 64845.0173  59.3%     -  116s
     0     0 64744.2305    0  343 40712.1800 64744.2305  59.0%     -  119s
     0     0 64722.7098    0  342 40712.1800 64722.7098  59.0%     -  121s
     0     0 64706.8505    0  356 40712.1800 64706.8505  58.9%     -  122s
     0     0 64691.1962    0  372 40712.1800 64691.1962  58.9%     -  123s
     0     0 64684.3591    0  338 40712.1800 64684.3591  58.9%     -  124s
     0     0 64677.3591    0  368 40712.1800 64677.3591  58.9%     -  125s
     0     0 64671.7866    0  376 40712.1800 64671.7866  58.9%     -  126s
     0     0 64671.1549    0  380 40712.1800 64671.1549  58.8%     -  126s
     0     0 64638.4808    0  382 40712.1800 64638.4808  58.8%     -  129s
H    0     0                    41129.741582 64636.3498  57.2%     -  130s
     0     0 64623.8946    0  375 41129.7416 64623.8946  57.1%     -  131s
     0     0 64616.4312    0  380 41129.7416 64616.4312  57.1%     -  132s
     0     0 64613.4615    0  383 41129.7416 64613.4615  57.1%     -  132s
     0     0 64603.5660    0  381 41129.7416 64603.5660  57.1%     -  133s
     0     0 64600.5841    0  379 41129.7416 64600.5841  57.1%     -  133s
     0     0 64599.3290    0  344 41129.7416 64599.3290  57.1%     -  133s
     0     0 64591.4550    0  415 41129.7416 64591.4550  57.0%     -  135s
     0     0 64590.0323    0  345 41129.7416 64590.0323  57.0%     -  136s
     0     0 64586.2735    0  344 41129.7416 64586.2735  57.0%     -  137s
     0     0 64585.0721    0  385 41129.7416 64585.0721  57.0%     -  139s
     0     0 64541.8220    0  419 41129.7416 64541.8220  56.9%     -  142s
     0     0 64537.5110    0  454 41129.7416 64537.5110  56.9%     -  143s
     0     0 64534.9279    0  459 41129.7416 64534.9279  56.9%     -  144s
     0     0 64534.5265    0  457 41129.7416 64534.5265  56.9%     -  144s
     0     0 64525.1797    0  428 41129.7416 64525.1797  56.9%     -  145s
H    0     0                    41309.642990 64523.8554  56.2%     -  148s
H    0     0                    41591.584109 64523.8554  55.1%     -  149s
     0     0 64523.7694    0  395 41591.5841 64523.7694  55.1%     -  149s
     0     0 64523.0213    0  358 41591.5841 64523.0213  55.1%     -  150s
     0     0 64522.9440    0  398 41591.5841 64522.9440  55.1%     -  151s
     0     0 64522.3567    0  393 41591.5841 64522.3567  55.1%     -  152s
     0     0 64522.0766    0  393 41591.5841 64522.0766  55.1%     -  153s
     0     0 64521.2169    0  398 41591.5841 64521.2169  55.1%     -  153s
     0     0 64519.7309    0  398 41591.5841 64519.7309  55.1%     -  154s
     0     0 64519.7309    0  394 41591.5841 64519.7309  55.1%     -  155s
     0     0 64519.3564    0  394 41591.5841 64519.3564  55.1%     -  156s
H    0     0                    41593.499763 64519.3564  55.1%     -  193s
H    0     0                    41644.161339 64519.3564  54.9%     -  193s
     0     2 64519.3564    0  394 41644.1613 64519.3564  54.9%     -  194s
     1     4 64406.9673    1  388 41644.1613 64516.8411  54.9%  2952  200s
     3     8 64276.5996    2  417 41644.1613 64400.9857  54.6%  5053  207s
     7    16 64181.1013    3  423 41644.1613 64275.6382  54.3%  5517  215s
    15    32 64098.8238    4  417 41644.1613 64180.1911  54.1%  6233  226s
    31    51 59211.9773    5  296 41644.1613 64098.7179  53.9%  9413  249s
    50    83 61277.1471    6  323 41644.1613 64098.1600  53.9%  8858  264s
H   65    83                    41693.212770 64098.1600  53.7%  7592  264s
    82   222 61253.8712    7  330 41693.2128 64098.1600  53.7%  6487  279s
   221   283 61020.5297   10  311 41693.2128 64098.1600  53.7%  3263  290s
H  242   283                    41758.120181 64098.1600  53.5%  3096  290s
   282   395 60624.4717   10  323 41758.1202 64098.1600  53.5%  2810  298s
   394   479 61027.6289   10  302 41758.1202 64098.1600  53.5%  2406  309s
   478   574 60992.0235   11  311 41758.1202 64098.1600  53.5%  2315  317s
   573   606 60589.1943   11  326 41758.1202 64098.1600  53.5%  2178  322s
   605   645 60917.1607   11  293 41758.1202 64098.1600  53.5%  2151  330s
H  625   645                    41979.508866 64098.1600  52.7%  2158  330s
   648   708 60922.4267   12  323 41979.5089 64098.1600  52.7%  2131  336s
   727   774 60816.2293   12  297 41979.5089 64098.1600  52.7%  2063  346s
   807   853 60212.0736   13  326 41979.5089 64098.1600  52.7%  2016  356s
   893   885 60432.1354   13  323 41979.5089 64098.1600  52.7%  1980  362s
H  922   885                    42067.509745 64098.1600  52.4%  1997  362s
   925   968 58706.5026   12  273 42067.5097 64098.1600  52.4%  2000  371s
  1010  1008 60247.1254   13  321 42067.5097 64098.1600  52.4%  1973  377s
H 1021  1008                    42201.160728 64098.1600  51.9%  1980  377s
  1062  1101 59956.8729   14  316 42201.1607 64098.1600  51.9%  1952  388s
  1173  1197 58787.6437   14  313 42201.1607 64098.1600  51.9%  1898  399s
  1293  1304 57854.3231   14  288 42201.1607 64098.1600  51.9%  1840  409s
  1420  1397 58654.5528   15  270 42201.1607 64098.1600  51.9%  1792  420s
  1545  1426 57774.5082   15  277 42201.1607 64098.1600  51.9%  1752  432s
  1578  1466 58208.7465   15  309 42201.1607 64098.1600  51.9%  1781  443s
H 1595  1466                    42259.422604 64098.1600  51.7%  1784  443s
  1630  1547 53937.4242   16  315 42259.4226 64098.1600  51.7%  1801  455s
  1761  1690 57759.8279   16  247 42259.4226 64098.1600  51.7%  1766  468s
  1906  1780 56990.3735   19  275 42259.4226 63454.0570  50.2%  1738  480s
  2036  1872 56070.4824   22  258 42259.4226 63454.0570  50.2%  1735  493s
  2158  1923 55888.1241   21  252 42259.4226 63454.0570  50.2%  1734  503s
H 2209  1923                    42302.848973 63454.0570  50.0%  1725  503s
  2229  2013 56056.5202   21  279 42302.8490 63194.0958  49.4%  1733  517s
  2353  2098 51273.4684   24  209 42302.8490 63191.8778  49.4%  1734  531s
  2500  2249 53622.3530   23  270 42302.8490 63191.8778  49.4%  1733  545s
  2677  2453 51430.2174   28  228 42302.8490 63191.8778  49.4%  1715  560s
  2915  2635 51368.8237   29  205 42302.8490 63191.8778  49.4%  1653  574s
  3165  2783 50083.7389   32  212 42302.8490 63191.8778  49.4%  1600  591s
  3393  2833 48867.1625   45  125 42302.8490 62240.1334  47.1%  1577  601s
H 3457  2833                    42573.659838 62240.1334  46.2%  1579  611s
H 3457  2833                    42589.721811 62240.1334  46.1%  1579  613s
  3458  2830 53106.7583   34  394 42589.7218 62240.1334  46.1%  1579  642s
  3460  2831 52182.6799   41   95 42589.7218 62240.1334  46.1%  1578  663s
  3461  2832 54429.8236   13  285 42589.7218 62240.1334  46.1%  1577  688s
  3462  2833 46258.8336   78  328 42589.7218 62240.1334  46.1%  1577  699s
  3463  2833 49634.4051   57  309 42589.7218 62240.1334  46.1%  1577  707s
H 3463  2691                    42596.682946 62240.1334  46.1%  1577  712s
  3465  2693 58150.6964    9  376 42596.6829 62240.1334  46.1%  1576  715s
  3466  2693 49119.6103   44  415 42596.6829 62240.1334  46.1%  1575  721s
  3467  2694 47184.4299   45  385 42596.6829 62240.1334  46.1%  1575  725s
  3470  2696 57009.7090   14  357 42596.6829 62240.1334  46.1%  1573  732s
  3471  2697 48639.2742   43  430 42596.6829 62240.1334  46.1%  1573  737s
  3472  2697 47622.2701   39  420 42596.6829 62240.1334  46.1%  1572  742s
  3473  2698 45742.8381   27  398 42596.6829 62240.1334  46.1%  1572  745s
  3475  2699 57039.6179   24  426 42596.6829 62240.1334  46.1%  1571  750s
  3477  2701 44355.1972   64  379 42596.6829 62240.1334  46.1%  1570  758s
  3478  2701 56054.0077   22  425 42596.6829 62240.1334  46.1%  1570  761s
  3480  2703 46116.2037   66  463 42596.6829 62240.1334  46.1%  1569  767s
  3481  2703 58329.3308   11  463 42596.6829 62240.1334  46.1%  1568  770s
  3483  2705 56788.5989   14  338 42596.6829 62240.1334  46.1%  1568  775s
  3484  2705 58634.4631    9  430 42596.6829 62240.1334  46.1%  1567  781s
  3486  2707 57543.6990   13  409 42596.6829 62240.1334  46.1%  1566  787s
  3488  2708 59281.6535   10  413 42596.6829 62240.1334  46.1%  1565  793s
  3489  2709 44542.0499   42  406 42596.6829 62240.1334  46.1%  1565  795s
  3492  2711 46001.8131   31  409 42596.6829 62240.1334  46.1%  1563  802s
  3493  2711 50883.1088   46  409 42596.6829 62240.1334  46.1%  1563  825s
  3494  2712 57204.4576   19  409 42596.6829 62240.1334  46.1%  1563  841s
  3495  2716 62240.1334   10  390 42596.6829 62240.1334  46.1%  1606  860s
  3497  2719 62240.1334   11  335 42596.6829 62240.1334  46.1%  1609  879s
  3501  2726 62240.1334   12  373 42596.6829 62240.1334  46.1%  1614  891s
  3509  2739 62240.1334   13  407 42596.6829 62240.1334  46.1%  1627  909s
  3525  2755 61549.6862   14  322 42596.6829 62240.1334  46.1%  1674  944s
  3546  2780 60397.8499   15  335 42596.6829 62240.1334  46.1%  1722  971s
H 3554  2641                    42858.928956 62240.1334  45.2%  1732  971s
H 3578  2602                    43197.092294 62240.1334  44.1%  1770 1001s
H 3630  2462                    43247.753871 62240.1334  43.9%  1868 1001s
  3677  2538 57324.8544   20  337 43247.7539 62240.1334  43.9%  1935 1020s
  3769  2598 56970.6392   19  270 43247.7539 62240.1334  43.9%  1979 1033s
H 3788  2475                    43336.757466 62240.1334  43.6%  1984 1033s
  3864  2532 56386.6083   20  292 43336.7575 62240.1334  43.6%  1988 1045s
  3950  2569 56518.8711   21  315 43336.7575 62240.1334  43.6%  1995 1063s
  4049  2602 55800.0615   22  221 43336.7575 62240.1334  43.6%  1992 1075s
  4145  2591 54973.4755   24  210 43336.7575 62240.1334  43.6%  1982 1089s
  4186  2598 49018.0276   24  200 43336.7575 62240.1334  43.6%  1995 1105s
  4237  2595 53597.1716   25  209 43336.7575 62240.1334  43.6%  2002 1118s
H 4266  2475                    43370.069221 62240.1334  43.5%  2003 1118s
  4308  2473 52621.5143   25  198 43370.0692 62240.1334  43.5%  2002 1136s
  4390  2470 52184.3981   23  215 43370.0692 61980.6481  42.9%  2016 1155s
  4427  2486 52876.9270   26  270 43370.0692 61980.6481  42.9%  2041 1169s
  4469  2497 49883.5830   26  188 43370.0692 61980.6481  42.9%  2067 1178s
  4505  2510 50032.9761   26  197 43370.0692 61980.6481  42.9%  2080 1187s
  4539  2529 47187.4780   26  190 43370.0692 61980.6481  42.9%  2095 1199s
  4576  2543 50192.6271   27  235 43370.0692 61980.6481  42.9%  2105 1213s
  4623  2553 50465.7877   27  221 43370.0692 61980.6481  42.9%  2126 1229s
  4675  2565 46770.8411   27  163 43370.0692 61980.6481  42.9%  2135 1241s
  4719  2577     cutoff   27      43370.0692 61980.6481  42.9%  2147 1254s
  4789  2596 47170.7432   28  190 43370.0692 61980.6481  42.9%  2151 1268s
  4854  2603     cutoff   28      43370.0692 60835.6688  40.3%  2162 1281s
  4928  2630 48570.0901   30  216 43370.0692 60835.6688  40.3%  2173 1293s
  4998  2644 46189.1638   31  173 43370.0692 60835.6688  40.3%  2179 1309s
  5111  2657 46660.4825   36  151 43370.0692 60006.0324  38.4%  2175 1327s
  5232  2666 50627.0448   16  259 43370.0692 59279.9633  36.7%  2183 1348s
  5344  2703 48049.8044   19  249 43370.0692 59279.9633  36.7%  2204 1365s
  5457  2726 47345.3914   22  196 43370.0692 58729.8953  35.4%  2214 1384s
  5596  2749 44412.5172   27  133 43370.0692 58683.4976  35.3%  2222 1401s
  5754  2742 51930.7628   17  256 43370.0692 58293.6117  34.4%  2226 1424s
  5910  2755 50879.2811   20  248 43370.0692 57795.1599  33.3%  2233 1444s
  6053  2792 46692.4505   26  179 43370.0692 57756.1018  33.2%  2251 1464s
  6189  2840 53563.5954   19  290 43370.0692 57200.9732  31.9%  2269 1485s
  6356  2871 53017.9812   20  260 43370.0692 57123.0824  31.7%  2278 1506s
  6550  2938 51232.4923   22  270 43370.0692 57123.0824  31.7%  2281 1529s
  6743  2966 47364.1089   32  176 43370.0692 57123.0824  31.7%  2283 1550s
  6991  2961 45040.0131   42   97 43370.0692 57123.0824  31.7%  2265 1574s
  7272  2916     cutoff   29      43370.0692 56874.2567  31.1%  2249 1600s
  7484  2885 50407.1235   20  308 43370.0692 56874.2567  31.1%  2258 1625s
  7575  2915     cutoff   22      43370.0692 56216.3926  29.6%  2277 1652s
  7755  2910 47096.0602   21  281 43370.0692 56216.3926  29.6%  2290 1679s
  7988  2850 44266.8146   28  219 43370.0692 56089.7085  29.3%  2296 1715s
  8231  2863 50583.3331   19  290 43370.0692 55654.5549  28.3%  2307 1745s
  8485  2846 48852.7312   22  312 43370.0692 55654.5549  28.3%  2314 1774s
  8672  2892 43958.4093   25  261 43370.0692 55234.9421  27.4%  2321 1807s
  8953  2911 47082.7190   21  279 43370.0692 55234.9421  27.4%  2331 1838s
  9289  2889 45563.8630   24  188 43370.0692 55172.1320  27.2%  2332 1871s
  9628  2863 50952.6923   23  313 43370.0692 55052.1144  26.9%  2333 1907s
  9960  2903     cutoff   27      43370.0692 54494.1327  25.6%  2339 1941s
 10322  3028 49976.4842   19  323 43370.0692 54246.3841  25.1%  2338 1976s
 10706  3154 47048.8759   23  180 43370.0692 54109.4902  24.8%  2338 2015s
 11106  3290 49796.5340   25  296 43370.0692 54109.4902  24.8%  2339 2054s
 11555  3416 45224.8032   21  343 43370.0692 54109.4902  24.8%  2336 2094s
 12021  3512 48713.2385   21  241 43370.0692 53907.9577  24.3%  2331 2133s
 12390  3540 45628.4128   26  236 43370.0692 53244.8241  22.8%  2336 2167s
 12471  3676     cutoff   26      43370.0692 53216.8541  22.7%  2335 2206s
 12945  3733     cutoff   32      43370.0692 52997.2493  22.2%  2328 2251s
 13393  3747 44738.1557   22  254 43370.0692 52946.5082  22.1%  2337 2291s
 13456  3763 47115.4069   21  242 43370.0692 52860.6617  21.9%  2340 2332s
H13572  3751                    43522.991627 52860.6617  21.5%  2340 2332s
 13581  3867 45781.0845   22  247 43522.9916 52860.6617  21.5%  2340 2382s
 14151  4008 46791.2666   19  325 43522.9916 52857.2887  21.4%  2339 2432s
 14719  4116 50279.5357   22  274 43522.9916 52521.6978  20.7%  2342 2484s
 15309  4169 44214.1199   27  180 43522.9916 52521.6978  20.7%  2342 2536s
 15905  4225 48574.0592   19  292 43522.9916 52430.2654  20.5%  2346 2589s
 16553  4342 44107.8105   25  225 43522.9916 52233.3455  20.0%  2348 2653s
 17238  4410     cutoff   30      43522.9916 52054.8392  19.6%  2345 2712s
 17926  4522     cutoff   23      43522.9916 51733.3118  18.9%  2347 2774s
 18623  4614 46271.8404   22  289 43522.9916 51532.4546  18.4%  2352 2836s
 19385  4724 45601.3054   21  212 43522.9916 51399.4775  18.1%  2352 2905s
 20182  4826     cutoff   26      43522.9916 51277.0241  17.8%  2351 2973s
 20973  4904     cutoff   24      43522.9916 50990.2885  17.2%  2355 3046s
 21775  4960 44818.1124   26  146 43522.9916 50885.8815  16.9%  2359 3119s
 22672  5062 45120.4832   27  251 43522.9916 50576.7157  16.2%  2358 3196s
 23670  5072     cutoff   26      43522.9916 50373.4467  15.7%  2348 3270s
 24585  5114     cutoff   19      43522.9916 50207.0744  15.4%  2353 3347s
 25561  5159 46534.8619   23  317 43522.9916 49972.0602  14.8%  2353 3427s
 26678  5187 45680.9023   20  243 43522.9916 49786.9036  14.4%  2346 3513s
 27745  5173 47090.7927   25  298 43522.9916 49517.8409  13.8%  2345 3589s
 28203  5166 44081.2609   19  303 43522.9916 49372.5884  13.4%  2343 3600s

Cutting planes:
  MIR: 984
  Mixing: 3
  Flow cover: 1757
  RLT: 24
  Relax-and-lift: 130

Explored 28357 nodes (66522212 simplex iterations) in 3600.03 seconds (7278.00 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 43523 43370.1 43336.8 ... 42302.8

Time limit reached
Best objective 4.352299162703e+04, best bound 4.937258841925e+04, gap 13.4402%
  WARNING: Time limit reached. Using best solution found (gap: 13.44%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.04s
  Master Objective (UB) = 43522.99, θ = 226248.68
  Upper Bound (UB) = 43522.99

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 226248.68
  [DEBUG]   ✓ Scenario 0: θ = 226248.68 ≤ Q = 226248.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 226248.68 ≤ Q = 226248.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 226248.68 ≤ Q = 226248.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 226248.68 ≤ Q = 226248.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 226248.68 ≤ Q = 226248.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 226248.68 ≤ Q = 226248.68 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x106553ca
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x106553ca
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [3e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-15, 2e+02]
Found heuristic solution: objective 1.394338e+13
Presolve removed 2585 rows and 1875 columns
Presolve time: 0.01s
Presolved: 508 rows, 514 columns, 1433 nonzeros
Found heuristic solution: objective 6949383.1879
Variable types: 350 continuous, 164 integer (164 binary)

Root relaxation: objective -1.785497e+05, 272 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -178549.67    0  128 6949383.19 -178549.67   103%     -    0s
H    0     0                    -142546.0113 -178549.67  25.3%     -    0s
H    0     0                    -143783.9704 -178549.67  24.2%     -    0s
H    0     0                    -157847.4452 -161380.07  2.24%     -    0s
H    0     0                    -159567.5696 -161380.07  1.14%     -    0s
     0     0 -161380.07    0   58 -159567.57 -161380.07  1.14%     -    0s
H    0     0                    -160948.0548 -161355.65  0.25%     -    0s
     0     0 -161241.67    0   47 -160948.05 -161241.67  0.18%     -    0s
     0     0 -161204.33    0   36 -160948.05 -161204.33  0.16%     -    0s
     0     0 -161165.65    0   27 -160948.05 -161165.65  0.14%     -    0s
     0     0 -161153.38    0   25 -160948.05 -161153.38  0.13%     -    0s
     0     0 -161128.14    0   23 -160948.05 -161128.14  0.11%     -    0s
     0     0 -161125.51    0   24 -160948.05 -161125.51  0.11%     -    0s
     0     0 -160990.69    0   10 -160948.05 -160990.69  0.03%     -    0s
     0     0 -160979.22    0    8 -160948.05 -160979.22  0.02%     -    0s
H    0     0                    -160964.3217 -160979.22  0.01%     -    0s

Explored 1 nodes (584 simplex iterations) in 0.08 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -160964 -160948 -160312 ... 1.39434e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.609643217068e+05, best bound -1.609792175232e+05, gap 0.0093%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 206987.88
  Scenario: 23 demand increases, 37 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -160964.32
  [DEBUG]   S×d_nominal = 367952.20
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 367952.20 + -160964.32 = 206987.88
  [DEBUG]   Current θ from Master = 226248.68
  [DEBUG]   ⚠️  Z_SP ≤ θ by 19260.80 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 24262.19
  Lower Bound (LB) = 38407.27
  Gap (UB-LB) = 5115.7216, Absolute Gap = 5115.7216, Relative Gap = 0.117541
  Not converged yet (gap = 5115.72 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 23 increases, 37 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308178 nonzeros
Model fingerprint: 0x77c2ca7b
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 48096 rows and 19526 columns
Presolve time: 1.76s
Presolved: 60317 rows, 26414 columns, 374919 nonzeros
Variable types: 24155 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -309441.0403
Found heuristic solution: objective -183060.7998

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 60317 rows, 26414 columns, 374919 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   22944   -1.2484126e+05   0.000000e+00   5.230307e+07      5s
   34057   -7.1234069e+03   0.000000e+00   3.923495e+07     10s
   44101    2.7239920e+04   0.000000e+00   3.258225e+07     15s
   54858    4.4712565e+04   0.000000e+00   3.579898e+07     20s
   62143    5.2841295e+04   0.000000e+00   2.516587e+07     25s
   70591    6.4909997e+04   0.000000e+00   1.414602e+07     30s
Concurrent spin time: 2.69s

Solved with dual simplex

Root relaxation: objective 7.812145e+04, 47609 iterations, 31.44 seconds (44.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 78121.4459    0   95 -183060.80 78121.4459   143%     -   33s
H    0     0                    -173155.1453 78121.4459   145%     -   34s
H    0     0                    -168392.6089 78121.4459   146%     -   34s
H    0     0                    -168120.2403 78121.4459   146%     -   34s
H    0     0                    -145522.1894 78121.4459   154%     -   34s
H    0     0                    -140612.5460 78121.4459   156%     -   34s
H    0     0                    -140159.0321 78121.4459   156%     -   34s
H    0     0                    -139921.6941 78121.4459   156%     -   34s
H    0     0                    -139889.5439 78121.4459   156%     -   34s
H    0     0                    -69076.51798 78121.4459   213%     -   34s
H    0     0                    -69054.53027 78121.4459   213%     -   34s
H    0     0                    -27566.17091 78121.4459   383%     -   34s
H    0     0                    -13260.04016 78121.4459   689%     -   35s
H    0     0                    -6686.288447 78121.4459  1268%     -   35s
H    0     0                    10457.108464 78121.4459   647%     -   35s
H    0     0                    16743.289290 78121.4459   367%     -   35s
H    0     0                    23228.683803 78121.4459   236%     -   35s
H    0     0                    28102.793237 78121.4459   178%     -   35s
H    0     0                    28247.849671 78121.4459   177%     -   35s
H    0     0                    29345.397552 71718.4362   144%     -   47s
H    0     0                    30533.906937 71718.4362   135%     -   47s
H    0     0                    30814.448236 71718.4362   133%     -   47s
H    0     0                    31188.526785 71718.4362   130%     -   47s
     0     0 71704.2068    0  195 31188.5268 71704.2068   130%     -   47s
     0     0 71165.6848    0  203 31188.5268 71165.6848   128%     -   53s
     0     0 71165.6848    0  200 31188.5268 71165.6848   128%     -   54s
     0     0 71165.6848    0  204 31188.5268 71165.6848   128%     -   55s
     0     0 71165.6848    0  202 31188.5268 71165.6848   128%     -   55s
     0     0 71165.6848    0  204 31188.5268 71165.6848   128%     -   55s
     0     0 71165.6848    0  204 31188.5268 71165.6848   128%     -   56s
H    0     0                    31629.665261 68782.0907   117%     -   64s
     0     0 68782.0907    0  222 31629.6653 68782.0907   117%     -   65s
H    0     0                    33299.166073 68782.0260   107%     -   65s
H    0     0                    33343.742877 68782.0260   106%     -   65s
H    0     0                    33433.980610 68782.0260   106%     -   65s
H    0     0                    33836.003825 68782.0260   103%     -   65s
     0     0 67963.1031    0  231 33836.0038 67963.1031   101%     -   73s
     0     0 67723.5664    0  233 33836.0038 67723.5664   100%     -   77s
     0     0 67563.9971    0  247 33836.0038 67563.9971   100%     -   81s
     0     0 67551.0510    0  252 33836.0038 67551.0510   100%     -   82s
     0     0 67503.1853    0  254 33836.0038 67503.1853   100%     -   83s
     0     0 67501.3627    0  254 33836.0038 67501.3627  99.5%     -   84s
     0     0 67474.3695    0  281 33836.0038 67474.3695  99.4%     -   85s
     0     0 67470.8985    0  282 33836.0038 67470.8985  99.4%     -   86s
     0     0 67457.2618    0  280 33836.0038 67457.2618  99.4%     -   88s
     0     0 67456.3926    0  280 33836.0038 67456.3926  99.4%     -   88s
     0     0 66139.9221    0  275 33836.0038 66139.9221  95.5%     -  104s
     0     0 65685.4761    0  308 33836.0038 65685.4761  94.1%     -  109s
     0     0 65631.9034    0  316 33836.0038 65631.9034  94.0%     -  111s
H    0     0                    39531.967174 65557.1052  65.8%     -  113s
     0     0 65557.1052    0  319 39531.9672 65557.1052  65.8%     -  113s
H    0     0                    39863.995327 65529.5726  64.4%     -  115s
H    0     0                    39993.329139 65529.5726  63.9%     -  115s
H    0     0                    40040.445699 65529.5726  63.7%     -  115s
     0     0 65529.5726    0  315 40040.4457 65529.5726  63.7%     -  115s
     0     0 65506.5230    0  317 40040.4457 65506.5230  63.6%     -  117s
     0     0 65500.3838    0  320 40040.4457 65500.3838  63.6%     -  117s
     0     0 65494.9177    0  317 40040.4457 65494.9177  63.6%     -  118s
     0     0 65489.6043    0  322 40040.4457 65489.6043  63.6%     -  119s
     0     0 65483.5343    0  318 40040.4457 65483.5343  63.5%     -  119s
     0     0 65481.5996    0  320 40040.4457 65481.5996  63.5%     -  120s
     0     0 65479.8927    0  318 40040.4457 65479.8927  63.5%     -  120s
     0     0 65479.3725    0  320 40040.4457 65479.3725  63.5%     -  120s
     0     0 65025.5854    0  324 40040.4457 65025.5854  62.4%     -  128s
     0     0 64816.6502    0  331 40040.4457 64816.6502  61.9%     -  133s
     0     0 64778.3301    0  340 40040.4457 64778.3301  61.8%     -  134s
     0     0 64762.5311    0  373 40040.4457 64762.5311  61.7%     -  135s
     0     0 64754.6949    0  339 40040.4457 64754.6949  61.7%     -  136s
     0     0 64747.4791    0  343 40040.4457 64747.4791  61.7%     -  137s
     0     0 64746.3482    0  342 40040.4457 64746.3482  61.7%     -  137s
     0     0 64657.0261    0  366 40040.4457 64657.0261  61.5%     -  141s
H    0     0                    40095.013901 64656.7933  61.3%     -  142s
H    0     0                    40163.966945 64656.7933  61.0%     -  142s
     0     0 64632.5143    0  370 40163.9669 64632.5143  60.9%     -  143s
     0     0 64622.4904    0  372 40163.9669 64622.4904  60.9%     -  144s
     0     0 64615.0182    0  386 40163.9669 64615.0182  60.9%     -  145s
     0     0 64607.9933    0  375 40163.9669 64607.9933  60.9%     -  146s
     0     0 64605.9692    0  380 40163.9669 64605.9692  60.9%     -  146s
     0     0 64604.5119    0  385 40163.9669 64604.5119  60.9%     -  147s
     0     0 64578.7876    0  415 40163.9669 64578.7876  60.8%     -  149s
H    0     0                    40178.802719 64578.4643  60.7%     -  151s
     0     0 64562.9835    0  423 40178.8027 64562.9835  60.7%     -  152s
     0     0 64553.5278    0  392 40178.8027 64553.5278  60.7%     -  153s
     0     0 64549.4916    0  432 40178.8027 64549.4916  60.7%     -  154s
     0     0 64547.0893    0  425 40178.8027 64547.0893  60.6%     -  154s
     0     0 64546.4609    0  430 40178.8027 64546.4609  60.6%     -  155s
     0     0 64542.5916    0  392 40178.8027 64542.5916  60.6%     -  157s
     0     0 64540.4323    0  356 40178.8027 64540.4323  60.6%     -  157s
     0     0 64539.5222    0  405 40178.8027 64539.5222  60.6%     -  158s
     0     0 64531.9183    0  401 40178.8027 64531.9183  60.6%     -  159s
H    0     0                    40343.196967 64527.9397  59.9%     -  161s
H    0     0                    40347.930839 64527.9397  59.9%     -  161s
     0     0 64527.9397    0  393 40347.9308 64527.9397  59.9%     -  161s
     0     0 64526.8661    0  392 40347.9308 64526.8661  59.9%     -  161s
     0     0 64517.3201    0  399 40347.9308 64517.3201  59.9%     -  163s
     0     0 64509.7934    0  399 40347.9308 64509.7934  59.9%     -  164s
     0     0 64508.5206    0  398 40347.9308 64508.5206  59.9%     -  165s
     0     0 64497.8644    0  401 40347.9308 64497.8644  59.9%     -  167s
H    0     0                    40475.763686 64497.1055  59.3%     -  168s
     0     0 64496.5935    0  435 40475.7637 64496.5935  59.3%     -  169s
     0     0 64495.8574    0  429 40475.7637 64495.8574  59.3%     -  171s
H    0     0                    41001.565360 64495.0638  57.3%     -  171s
H    0     0                    41478.106182 64495.0638  55.5%     -  171s
     0     0 64495.0638    0  432 41478.1062 64495.0638  55.5%     -  172s
     0     0 64494.8384    0  392 41478.1062 64494.8384  55.5%     -  173s
     0     0 64494.5581    0  392 41478.1062 64494.5581  55.5%     -  176s
     0     0 64492.8894    0  354 41478.1062 64492.8894  55.5%     -  177s
     0     0 64492.1388    0  396 41478.1062 64492.1388  55.5%     -  178s
     0     0 64491.4651    0  392 41478.1062 64491.4651  55.5%     -  179s
     0     0 64491.1219    0  392 41478.1062 64491.1219  55.5%     -  180s
H    0     0                    41734.359907 64491.0949  54.5%     -  230s
H    0     0                    42108.459744 64491.0949  53.2%     -  232s
H    0     0                    42244.553265 64491.0949  52.7%     -  232s
H    0     0                    42358.479107 64491.0949  52.3%     -  232s
     0     2 64491.0949    0  392 42358.4791 64491.0949  52.3%     -  245s
     3     8 64447.8267    2  339 42358.4791 64475.8279  52.2%  2151  254s
     7    16 64078.7270    3  335 42358.4791 64445.8522  52.1%  4186  275s
    15    32 63473.2065    4  359 42358.4791 64076.5053  51.3%  7257  288s
    31    50 60488.1207    5  275 42358.4791 63492.6009  49.9%  9844  317s
    49    82 61435.9953    6  295 42358.4791 63492.3940  49.9% 10014  334s
H   63    82                    42406.774228 63492.3940  49.7%  9464  334s
H   69    82                    42457.365470 63492.3940  49.5%  8981  334s
    81   149 61318.7390    7  295 42457.3655 63492.3940  49.5%  8184  353s
   148   275 61248.1560    8  286 42457.3655 63492.3940  49.5%  5806  372s
H  170   275                    42504.128786 63492.3940  49.4%  5413  372s
   274   365 61166.3664   10  291 42504.1288 63492.3940  49.4%  4241  383s
   364   445 60585.4029    9  273 42504.1288 63492.3940  49.4%  3935  395s
H  373   445                    42504.199121 63492.3940  49.4%  3885  395s
H  412   445                    42582.891778 63492.3940  49.1%  3700  395s
   452   541 61072.2356   11  276 42582.8918 63492.3940  49.1%  3567  406s
   550   636 59855.8656   12  262 42582.8918 63492.3940  49.1%  3242  417s
H  572   636                    42633.553354 63492.3940  48.9%  3174  417s
   645   742 60470.2726   12  256 42633.5534 63492.3940  48.9%  2983  426s
   753   773 59323.5787   12  252 42633.5534 63492.3940  48.9%  2753  436s
   784   808 60312.8792   13  268 42633.5534 63492.3940  48.9%  2702  441s
   819   840 60192.8120   13  264 42633.5534 63492.3940  48.9%  2652  448s
   851   877 60302.7943   13  256 42633.5534 63492.3940  48.9%  2608  455s
   888   912 60199.8735   14  255 42633.5534 63492.3940  48.9%  2566  462s
   923   945 60028.7371   14  261 42633.5534 63492.3940  48.9%  2514  472s
   956   982 58964.9775   14  252 42633.5534 63492.3940  48.9%  2492  479s
H  977   982                    42651.312743 63492.3940  48.9%  2474  479s
   993  1099 60159.4498   14  263 42651.3127 63492.3940  48.9%  2455  491s
  1124  1188 60067.9056   15  265 42651.3127 63492.3940  48.9%  2288  504s
  1246  1244 59070.7766   15  217 42651.3127 63492.3940  48.9%  2195  517s
  1359  1303 58843.4227   15  251 42651.3127 63492.3940  48.9%  2121  531s
  1450  1386 59809.3514   15  253 42651.3127 63492.3940  48.9%  2112  545s
  1557  1466 59135.8335   16  270 42651.3127 63492.3940  48.9%  2099  557s
  1683  1554 57484.8340   17  265 42651.3127 63492.3940  48.9%  2069  570s
  1827  1653 53556.6983   19  258 42651.3127 63492.3940  48.9%  2029  585s
  1975  1755 51143.5309   17  237 42651.3127 63492.3940  48.9%  1981  599s
H 2105  1839                    42671.833769 63492.3940  48.8%  1959  616s
  2212  1953 51907.1289   21  230 42671.8338 63402.2738  48.6%  1944  632s
  2352  2075 53928.5043   20  232 42671.8338 63399.8939  48.6%  1918  648s
  2506  2239 50600.5464   22  207 42671.8338 63399.8939  48.6%  1899  663s
  2686  2432 51174.5669   24  224 42671.8338 63399.8939  48.6%  1862  680s
  2903  2614 50238.0642   27  197 42671.8338 63039.4478  47.7%  1810  697s
  3129  2643 49649.2086   38  154 42671.8338 62161.8401  45.7%  1757  710s
  3164  2678 44183.3701   38   61 42671.8338 62161.8401  45.7%  1774  726s
  3201  2716 49246.9291   36  167 42671.8338 62161.8401  45.7%  1777  740s
  3252  2717 46617.4366   55  392 42671.8338 62161.8401  45.7%  1785  783s
  3254  2718 59937.4634    8   95 42671.8338 62161.8401  45.7%  1783  801s
  3255  2719 46214.4894   30  278 42671.8338 62161.8401  45.7%  1783  824s
  3256  2720 57074.3489   10  287 42671.8338 62161.8401  45.7%  1782  843s
  3257  2720 53570.3246   26  356 42671.8338 62161.8401  45.7%  1782  852s
  3258  2721 45597.1940   34  393 42671.8338 62161.8401  45.7%  1781  860s
  3260  2722 54918.7461   15  349 42671.8338 62161.8401  45.7%  1780  867s
  3262  2724 58328.9310   14  355 42671.8338 62161.8401  45.7%  1779  871s
  3264  2725 44848.5650   33  351 42671.8338 62161.8401  45.7%  1778  877s
  3265  2726 48231.8215   48  371 42671.8338 62161.8401  45.7%  1777  882s
  3266  2726 52382.4285   22  374 42671.8338 62161.8401  45.7%  1777  885s
  3268  2728 58084.1678   11  380 42671.8338 62161.8401  45.7%  1776  891s
  3270  2729 54988.2301   17  376 42671.8338 62161.8401  45.7%  1775  899s
  3271  2730 44367.6969   31  411 42671.8338 62161.8401  45.7%  1774  902s
  3272  2730 49107.5282   31  392 42671.8338 62161.8401  45.7%  1774  908s
  3273  2731 46289.5428   41  385 42671.8338 62161.8401  45.7%  1773  911s
  3274  2732 54571.1076   14  335 42671.8338 62161.8401  45.7%  1773  918s
  3275  2732 60268.8787   13  345 42671.8338 62161.8401  45.7%  1772  920s
  3277  2734 56081.1234   23  394 42671.8338 62161.8401  45.7%  1771  929s
  3278  2734 56294.3829   21  392 42671.8338 62161.8401  45.7%  1770  931s
H 3278  2596                    42791.964099 62161.8401  45.3%  1770  937s
H 3278  2466                    42851.677345 62161.8401  45.1%  1770  938s
  3280  2468 55436.1263   27  360 42851.6773 62161.8401  45.1%  1769  940s
  3282  2469 53772.8928   29  359 42851.6773 62161.8401  45.1%  1768  946s
  3283  2470 47004.1685   33  354 42851.6773 62161.8401  45.1%  1768  950s
  3284  2470 47289.5633   85  354 42851.6773 62161.8401  45.1%  1767  968s
  3285  2471 59559.8563   10  354 42851.6773 62161.8401  45.1%  1767 1000s
  3286  2475 62161.8401   11  331 42851.6773 62161.8401  45.1%  1811 1038s
  3288  2478 62161.8401   12  335 42851.6773 62161.8401  45.1%  1812 1061s
  3292  2485 62161.8401   13  383 42851.6773 62161.8401  45.1%  1821 1082s
  3300  2498 62161.8401   14  350 42851.6773 62161.8401  45.1%  1833 1099s
  3316  2509 59500.8756   15  362 42851.6773 62161.8401  45.1%  1902 1128s
  3332  2535 59062.4710   16  343 42851.6773 62161.8401  45.1%  1943 1152s
  3364  2572 57037.3591   17  324 42851.6773 62161.8401  45.1%  1967 1181s
  3411  2629 56630.9522   18  326 42851.6773 62161.8401  45.1%  2054 1205s
  3484  2687 55894.3911   19  281 42851.6773 62161.8401  45.1%  2133 1228s
  3572  2689 54964.1591   21  298 42851.6773 62161.8401  45.1%  2176 1240s
  3604  2710 54518.7121   21  281 42851.6773 62161.8401  45.1%  2190 1254s
  3638  2752 51873.3250   20  274 42851.6773 62161.8401  45.1%  2213 1268s
  3702  2785 54012.8331   20  318 42851.6773 62161.8401  45.1%  2224 1287s
  3779  2827 51850.4198   20  300 42851.6773 62161.8401  45.1%  2235 1304s
  3868  2843 54418.2619   22  275 42851.6773 62161.8401  45.1%  2245 1320s
  3956  2851 54089.8350   22  273 42851.6773 60976.9868  42.3%  2253 1339s
  4024  2861 54008.9884   22  282 42851.6773 60976.9868  42.3%  2268 1356s
  4093  2882 53321.7078   23  291 42851.6773 60976.9868  42.3%  2284 1372s
  4160  2895 53480.7198   23  323 42851.6773 60976.9868  42.3%  2307 1388s
  4251  2885 53227.9898   23  291 42851.6773 60976.9868  42.3%  2314 1406s
  4333  2880 52921.9395   22  356 42851.6773 60547.3757  41.3%  2321 1422s
  4401  2897 48647.3910   24  283 42851.6773 60218.2309  40.5%  2346 1442s
  4477  2895 51751.7939   24  257 42851.6773 59798.0377  39.5%  2366 1462s
  4557  2895 50931.9928   23  312 42851.6773 59798.0377  39.5%  2386 1480s
  4651  2888 48190.4371   23  255 42851.6773 59798.0377  39.5%  2397 1501s
  4745  2902 48912.5801   25  253 42851.6773 59798.0377  39.5%  2417 1533s
  4835  2901 47860.4714   25  301 42851.6773 59798.0377  39.5%  2438 1550s
  4870  2914 47358.5091   25  295 42851.6773 59320.5983  38.4%  2454 1568s
  4909  2937 48150.2874   26  181 42851.6773 59320.5983  38.4%  2467 1585s
  4949  2941 45520.9451   28  165 42851.6773 59320.5983  38.4%  2473 1606s
  4999  2953 43983.2000   32  160 42851.6773 58192.3948  35.8%  2487 1637s
  5046  2969 54647.8722   19  389 42851.6773 58189.0643  35.8%  2500 1654s
  5101  2993 51484.5312   21  331 42851.6773 58189.0643  35.8%  2508 1674s
  5163  3026 49940.8005   24  303 42851.6773 58189.0643  35.8%  2511 1695s
H 5220  2883                    42986.410665 58189.0643  35.4%  2508 1695s
  5238  2947 47857.1982   26  255 42986.4107 58189.0643  35.4%  2508 1723s
  5389  2970 44857.7669   31  211 42986.4107 58189.0643  35.4%  2510 1751s
  5555  2934     cutoff   34      42986.4107 58189.0643  35.4%  2517 1768s
H 5563  2814                    43037.557902 58189.0643  35.2%  2519 1768s
H 5571  2699                    43136.200190 58189.0643  34.9%  2523 1768s
  5599  2773 54260.2191   18  311 43136.2002 58189.0643  34.9%  2529 1801s
  5767  2821 51493.6983   20  342 43136.2002 58189.0643  34.9%  2534 1831s
  5932  2855 47376.0437   22  276 43136.2002 58189.0643  34.9%  2541 1865s
  6132  2834 44926.2185   25  296 43136.2002 58189.0643  34.9%  2541 1895s
H 6148  2723                    43304.457955 58189.0643  34.4%  2545 1895s
  6252  2757 43619.9848   26  398 43304.4580 58189.0643  34.4%  2543 1931s
  6428  2799 49504.5544   22  279 43304.4580 58189.0643  34.4%  2564 1963s
  6582  2844 47280.0876   24  214 43304.4580 58189.0643  34.4%  2596 1999s
  6789  2860 45448.6475   27  172 43304.4580 56627.1481  30.8%  2606 2035s
  7004  2873     cutoff   41      43304.4580 56362.4147  30.2%  2619 2078s
  7221  2822 52426.2114   20  280 43304.4580 56273.5903  29.9%  2635 2110s
  7264  2839 50229.6293   21  301 43304.4580 55958.7196  29.2%  2651 2138s
  7312  2886 48987.2244   21  312 43304.4580 55958.7196  29.2%  2666 2174s
  7481  2886 49547.0309   22  294 43304.4580 55958.7196  29.2%  2672 2216s
  7705  2886 44026.8415   22  283 43304.4580 55940.0599  29.2%  2686 2259s
  7970  2893 48233.7534   22  353 43304.4580 55940.0599  29.2%  2701 2308s
  8285  2887     cutoff   25      43304.4580 55426.7375  28.0%  2693 2355s
  8557  2823 52792.3161   19  285 43304.4580 54993.1652  27.0%  2709 2390s
  8599  2913 52623.6044   20  286 43304.4580 54993.1652  27.0%  2715 2434s
  8842  2935 50307.9531   24  243 43304.4580 54993.1652  27.0%  2716 2485s
  9163  2894 44102.0966   27  147 43304.4580 54646.6527  26.2%  2726 2536s
  9504  2973 48705.3746   18  262 43304.4580 54646.6527  26.2%  2731 2595s
  9801  3032     cutoff   25      43304.4580 54391.8833  25.6%  2757 2653s
 10160  3107 48587.3018   25  238 43304.4580 53999.4675  24.7%  2777 2715s
 10535  3220 47301.2577   27  251 43304.4580 53622.2247  23.8%  2796 2780s
 10926  3312 49739.2738   20  250 43304.4580 53326.7247  23.1%  2808 2847s
 11320  3391 43910.9795   29  229 43304.4580 53036.0458  22.5%  2828 2911s
 11768  3480 43548.4482   25  225 43304.4580 52987.7411  22.4%  2834 2981s
 12199  3599 46120.4328   31  273 43304.4580 52978.8569  22.3%  2848 3050s
 12806  3656     cutoff   33      43304.4580 52864.6671  22.1%  2828 3128s
 13302  3747 46136.4197   20  310 43304.4580 52623.5825  21.5%  2837 3204s
 13769  3834 43627.6491   25  195 43304.4580 52476.1103  21.2%  2855 3284s
 14316  3899 47920.5569   27  299 43304.4580 52281.9782  20.7%  2863 3370s
 14823  3988 44481.6980   22  300 43304.4580 52079.6305  20.3%  2882 3458s
 15336  4071 44418.5897   27  243 43304.4580 51782.6396  19.6%  2902 3544s
 15872  4123 46746.6070   25  197 43304.4580 51734.4582  19.5%  2921 3600s

Cutting planes:
  Learned: 1
  MIR: 817
  Mixing: 8
  Flow cover: 1858
  RLT: 13
  Relax-and-lift: 140

Explored 16400 nodes (47819498 simplex iterations) in 3600.05 seconds (6787.63 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 43304.5 43136.2 43037.6 ... 42504.2

Time limit reached
Best objective 4.330445795493e+04, best bound 5.162247408630e+04, gap 19.2082%
  WARNING: Time limit reached. Using best solution found (gap: 19.21%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = 43304.46, θ = 226307.14
  Upper Bound (UB) = 43304.46

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 226307.14
  [DEBUG]   ✓ Scenario 0: θ = 226307.14 ≤ Q = 226307.14 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 226307.14 ≤ Q = 226307.14 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 226307.14 ≤ Q = 226307.14 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 226307.14 ≤ Q = 226307.14 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 226307.14 ≤ Q = 226307.14 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 226307.14 ≤ Q = 226307.14 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 226307.14 ≤ Q = 226307.14 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x60abc485
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x60abc485
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.396629e+13
Presolve removed 2587 rows and 1877 columns
Presolve time: 0.01s
Presolved: 506 rows, 512 columns, 1433 nonzeros
Found heuristic solution: objective 6960139.4907
Variable types: 348 continuous, 164 integer (164 binary)

Root relaxation: objective -1.796769e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -179676.87    0  127 6960139.49 -179676.87   103%     -    0s
H    0     0                    -141626.4793 -179676.87  26.9%     -    0s
H    0     0                    -141913.3419 -179676.87  26.6%     -    0s
H    0     0                    -146471.8852 -179676.87  22.7%     -    0s
H    0     0                    -160790.9159 -179676.87  11.7%     -    0s
     0     0 -164398.53    0   60 -160790.92 -164398.53  2.24%     -    0s
H    0     0                    -162646.1214 -164386.07  1.07%     -    0s
     0     0 -163360.15    0   47 -162646.12 -163360.15  0.44%     -    0s
     0     0 -163268.44    0   12 -162646.12 -163268.44  0.38%     -    0s
H    0     0                    -163127.2458 -163267.44  0.09%     -    0s
H    0     0                    -163134.2804 -163249.16  0.07%     -    0s
     0     0 -163249.16    0    9 -163134.28 -163249.16  0.07%     -    0s
     0     0 -163187.51    0    8 -163134.28 -163187.51  0.03%     -    0s
     0     0 -163179.26    0    6 -163134.28 -163179.26  0.03%     -    0s
H    0     0                    -163150.5032 -163179.26  0.02%     -    0s
H    0     0                    -163164.3288 -163179.26  0.01%     -    0s

Explored 1 nodes (581 simplex iterations) in 0.08 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -163164 -163151 -163134 ... 6.96014e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.631643288201e+05, best bound -1.631792642628e+05, gap 0.0092%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 204787.87
  Scenario: 25 demand increases, 35 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -163164.33
  [DEBUG]   S×d_nominal = 367952.20
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 367952.20 + -163164.33 = 204787.87
  [DEBUG]   Current θ from Master = 226307.14
  [DEBUG]   ⚠️  Z_SP ≤ θ by 21519.27 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 21785.18
  Lower Bound (LB) = 38407.27
  Gap (UB-LB) = 4897.1879, Absolute Gap = 4897.1879, Relative Gap = 0.113087
  Not converged yet (gap = 4897.19 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 25 increases, 35 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351415 nonzeros
Model fingerprint: 0x72619b46
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 54984 rows and 22324 columns
Presolve time: 1.96s
Presolved: 68719 rows, 29856 columns, 427639 nonzeros
Variable types: 27597 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -309441.0403
Found heuristic solution: objective -183060.7998

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 68719 rows, 29856 columns, 427639 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   22319   -1.8416325e+05   0.000000e+00   3.026829e+06      5s
   34958   -1.7042293e+03   0.000000e+00   1.026261e+08     10s
   45939    3.6834195e+04   0.000000e+00   3.975745e+06     15s
   51575    3.8074039e+04   0.000000e+00   2.279924e+07     20s
   58414    4.7393267e+04   0.000000e+00   7.523043e+06     25s
   65315    5.3113131e+04   0.000000e+00   5.961144e+09     30s
   71934    5.8300489e+04   0.000000e+00   7.141079e+07     35s
   80253    6.3357076e+04   0.000000e+00   3.727017e+06     40s
Concurrent spin time: 8.53s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 7.812145e+04, 66615 iterations, 49.37 seconds (64.31 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 78121.4459    0   95 -183060.80 78121.4459   143%     -   52s
H    0     0                    -169322.6190 78121.4459   146%     -   52s
H    0     0                    -111540.9896 78121.4459   170%     -   52s
H    0     0                    -111269.1367 78121.4459   170%     -   52s
H    0     0                    -110787.1405 78121.4459   171%     -   52s
H    0     0                    -69455.28485 78121.4459   212%     -   52s
H    0     0                    -69433.29715 78121.4459   213%     -   52s
H    0     0                    -19145.10906 78121.4459   508%     -   52s
H    0     0                    -12710.56668 78121.4459   715%     -   52s
H    0     0                    -5684.503101 78121.4459  1474%     -   52s
H    0     0                    5371.1193098 78121.4459  1354%     -   53s
H    0     0                    27940.762507 78121.4459   180%     -   53s
H    0     0                    28247.849671 78121.4459   177%     -   55s
H    0     0                    31064.471448 72062.6979   132%     -   72s
H    0     0                    31114.319640 72062.6979   132%     -   72s
H    0     0                    31385.608461 72062.6979   130%     -   72s
     0     0 72052.7584    0  208 31385.6085 72052.7584   130%     -   72s
     0     0 71739.8592    0  205 31385.6085 71739.8592   129%     -   76s
     0     0 71667.1247    0  234 31385.6085 71667.1247   128%     -   80s
     0     0 71667.1247    0  225 31385.6085 71667.1247   128%     -   83s
     0     0 71667.1247    0  234 31385.6085 71667.1247   128%     -   84s
     0     0 71667.1247    0  232 31385.6085 71667.1247   128%     -   85s
     0     0 71667.1247    0  237 31385.6085 71667.1247   128%     -   85s
     0     0 71667.1247    0  237 31385.6085 71667.1247   128%     -   86s
     0     0 68630.3417    0  204 31385.6085 68630.3417   119%     -  104s
H    0     0                    39403.910340 68630.0767  74.2%     -  105s
     0     0 68195.4222    0  235 39403.9103 68195.4222  73.1%     -  112s
     0     0 68069.1101    0  231 39403.9103 68069.1101  72.7%     -  117s
     0     0 68029.5923    0  237 39403.9103 68029.5923  72.6%     -  119s
     0     0 67981.9207    0  232 39403.9103 67981.9207  72.5%     -  120s
     0     0 67967.9245    0  240 39403.9103 67967.9245  72.5%     -  121s
     0     0 67923.8309    0  262 39403.9103 67923.8309  72.4%     -  124s
     0     0 67917.2731    0  259 39403.9103 67917.2731  72.4%     -  124s
     0     0 67914.5483    0  262 39403.9103 67914.5483  72.4%     -  125s
     0     0 67913.7062    0  243 39403.9103 67913.7062  72.4%     -  125s
     0     0 66249.8425    0  318 39403.9103 66249.8425  68.1%     -  149s
H    0     0                    39828.093006 65901.8841  65.5%     -  156s
     0     0 65901.8841    0  310 39828.0930 65901.8841  65.5%     -  156s
     0     0 65748.9305    0  311 39828.0930 65748.9305  65.1%     -  160s
     0     0 65639.9756    0  317 39828.0930 65639.9756  64.8%     -  163s
     0     0 65605.7111    0  314 39828.0930 65605.7111  64.7%     -  165s
     0     0 65598.1535    0  314 39828.0930 65598.1535  64.7%     -  166s
     0     0 65590.6265    0  310 39828.0930 65590.6265  64.7%     -  167s
     0     0 65579.6539    0  313 39828.0930 65579.6539  64.7%     -  168s
     0     0 65577.5328    0  315 39828.0930 65577.5328  64.7%     -  169s
     0     0 65577.1929    0  317 39828.0930 65577.1929  64.7%     -  169s
     0     0 65136.6759    0  330 39828.0930 65136.6759  63.5%     -  178s
     0     0 65009.7381    0  330 39828.0930 65009.7381  63.2%     -  182s
     0     0 64937.8773    0  331 39828.0930 64937.8773  63.0%     -  185s
     0     0 64914.0339    0  338 39828.0930 64914.0339  63.0%     -  187s
     0     0 64889.5502    0  334 39828.0930 64889.5502  62.9%     -  188s
     0     0 64878.6764    0  333 39828.0930 64878.6764  62.9%     -  190s
     0     0 64857.7413    0  329 39828.0930 64857.7413  62.8%     -  192s
     0     0 64852.6685    0  340 39828.0930 64852.6685  62.8%     -  193s
     0     0 64845.2706    0  337 39828.0930 64845.2706  62.8%     -  194s
     0     0 64840.9210    0  337 39828.0930 64840.9210  62.8%     -  195s
     0     0 64834.8938    0  342 39828.0930 64834.8938  62.8%     -  195s
     0     0 64834.2552    0  337 39828.0930 64834.2552  62.8%     -  196s
     0     0 64787.7996    0  370 39828.0930 64787.7996  62.7%     -  199s
     0     0 64770.6584    0  374 39828.0930 64770.6584  62.6%     -  201s
     0     0 64763.1755    0  373 39828.0930 64763.1755  62.6%     -  202s
     0     0 64760.7666    0  366 39828.0930 64760.7666  62.6%     -  202s
     0     0 64758.0418    0  374 39828.0930 64758.0418  62.6%     -  203s
     0     0 64757.9135    0  374 39828.0930 64757.9135  62.6%     -  203s
     0     0 64728.4300    0  362 39828.0930 64728.4300  62.5%     -  207s
     0     0 64721.5274    0  374 39828.0930 64721.5274  62.5%     -  210s
     0     0 64709.7805    0  373 39828.0930 64709.7805  62.5%     -  211s
     0     0 64707.9623    0  439 39828.0930 64707.9623  62.5%     -  212s
     0     0 64707.4603    0  416 39828.0930 64707.4603  62.5%     -  212s
     0     0 64675.2235    0  380 39828.0930 64675.2235  62.4%     -  215s
H    0     0                    40139.946826 64670.2397  61.1%     -  217s
     0     0 64670.2397    0  374 40139.9468 64670.2397  61.1%     -  217s
     0     0 64666.4470    0  345 40139.9468 64666.4470  61.1%     -  217s
     0     0 64664.5241    0  347 40139.9468 64664.5241  61.1%     -  218s
     0     0 64664.1525    0  349 40139.9468 64664.1525  61.1%     -  218s
     0     0 64653.1254    0  415 40139.9468 64653.1254  61.1%     -  220s
     0     0 64650.9825    0  436 40139.9468 64650.9825  61.1%     -  224s
     0     0 64649.2404    0  380 40139.9468 64649.2404  61.1%     -  225s
     0     0 64648.3776    0  351 40139.9468 64648.3776  61.1%     -  225s
H    0     0                    40516.998968 64628.0877  59.5%     -  228s
     0     0 64628.0877    0  386 40516.9990 64628.0877  59.5%     -  228s
     0     0 64620.6129    0  354 40516.9990 64620.6129  59.5%     -  230s
     0     0 64619.6246    0  356 40516.9990 64619.6246  59.5%     -  230s
     0     0 64611.4189    0  356 40516.9990 64611.4189  59.5%     -  233s
     0     0 64610.2292    0  386 40516.9990 64610.2292  59.5%     -  237s
     0     0 64607.6979    0  384 40516.9990 64607.6979  59.5%     -  239s
     0     0 64606.3783    0  386 40516.9990 64606.3783  59.5%     -  240s
     0     0 64606.2998    0  386 40516.9990 64606.2998  59.5%     -  241s
     0     0 64605.6732    0  387 40516.9990 64605.6732  59.5%     -  242s
     0     0 64604.4960    0  356 40516.9990 64604.4960  59.5%     -  243s
     0     0 64603.8625    0  356 40516.9990 64603.8625  59.4%     -  245s
H    0     0                    40815.033144 64603.8625  58.3%     -  292s
H    0     2                    41952.862642 64603.8625  54.0%     -  293s
     0     2 64603.8625    0  356 41952.8626 64603.8625  54.0%     -  293s
     1     4 64554.2908    1  373 41952.8626 64603.7158  54.0%  3032  297s
     3     8 64499.2852    2  375 41952.8626 64553.9810  53.9%  3599  302s
     7    16 64224.5105    3  377 41952.8626 64498.3524  53.7%  4525  319s
    15    32 64055.7647    4  342 41952.8626 64219.5780  53.1%  6822  330s
    31    48 62691.5774    5  375 41952.8626 64055.5214  52.7% 10511  362s
    47    80 60591.4941    6  321 41952.8626 64055.5214  52.7% 10627  382s
H   58    80                    42333.757822 64055.5214  51.3% 10390  382s
H   61    80                    42408.009677 64055.5214  51.0% 10328  382s
H   62    80                    42510.384698 64055.5214  50.7% 10283  382s
    79   143 60500.7406    7  323 42510.3847 64055.5214  50.7%  9079  433s
   142   266 60405.1448    9  318 42510.3847 64055.5214  50.7%  7444  456s
   265   352 60252.3505   11  308 42510.3847 64055.5214  50.7%  5463  474s
   351   416 60082.5686   12  306 42510.3847 64055.5214  50.7%  4990  490s
   415   498 60068.6321   11  307 42510.3847 64055.5214  50.7%  4831  507s
   497   529 60154.7647   12  305 42510.3847 64055.5214  50.7%  4446  520s
   530   571 57137.2602   13  272 42510.3847 64055.5214  50.7%  4388  535s
   572   603 57214.1001   13  282 42510.3847 64055.5214  50.7%  4256  547s
   604   636 58328.9622   13  250 42510.3847 64055.5214  50.7%  4140  557s
   637   670 58321.2120   13  246 42510.3847 64055.5214  50.7%  4047  569s
H  639   670                    42552.912090 64055.5214  50.5%  4046  569s
   671   780 57935.5318   13  280 42552.9121 64055.5214  50.5%  3977  581s
   785   879 54969.3964   30  213 42552.9121 64055.5214  50.5%  3611  596s
   894   980 56829.5174   13  275 42552.9121 64055.5214  50.5%  3320  610s
  1017  1090 57573.2650   13  283 42552.9121 64055.5214  50.5%  3076  623s
  1135  1207 58101.1978   14  248 42552.9121 64055.5214  50.5%  2888  636s
  1282  1233 55625.4161   14  267 42552.9121 64055.5214  50.5%  2697  649s
  1316  1262 57467.5296   14  250 42552.9121 64055.5214  50.5%  2686  665s
  1359  1291 57600.9574   14  254 42552.9121 64055.5214  50.5%  2694  679s
  1406  1326 57000.3079   14  272 42552.9121 64055.5214  50.5%  2686  693s
  1453  1365 57646.6268   15  251 42552.9121 64055.5214  50.5%  2680  706s
  1500  1397 55679.6032   15  277 42552.9121 64055.5214  50.5%  2675  722s
  1542  1434 56592.1123   16  311 42552.9121 64055.5214  50.5%  2680  737s
  1597  1494 56577.7555   15  275 42552.9121 64055.5214  50.5%  2690  751s
  1675  1516 56143.6871   18  309 42552.9121 64032.0136  50.5%  2659  767s
  1713  1545 55690.2188   18  251 42552.9121 64032.0136  50.5%  2664  785s
  1758  1571 54313.3948   19  239 42552.9121 64032.0136  50.5%  2675  803s
  1796  1609 54512.7803   19  234 42552.9121 64032.0136  50.5%  2687  822s
  1844  1666 51062.7657   17  258 42552.9121 64032.0136  50.5%  2695  838s
  1916  1722 54341.4988   20  230 42552.9121 64032.0136  50.5%  2669  855s
  2004  1825 55563.5411   19  313 42552.9121 64032.0136  50.5%  2658  873s
  2144  1948 53999.6608   20  237 42552.9121 64032.0136  50.5%  2592  893s
  2315  1971 53258.7422   22  209 42552.9121 63598.9661  49.5%  2540  906s
  2356  1993 51426.5383   21  220 42552.9121 63594.7920  49.4%  2534  921s
  2400  2024 47233.0619   20  237 42552.9121 63271.1905  48.7%  2537  936s
  2441  2089 49086.7751   22  230 42552.9121 63209.0261  48.5%  2549  955s
  2518  2165 52763.6877   23  214 42552.9121 63209.0261  48.5%  2521  976s
  2656  2304 51903.1671   24  181 42552.9121 63070.5978  48.2%  2474  997s
  2843  2454 50868.6253   25  163 42552.9121 63070.5978  48.2%  2417 1023s
  3059  2620 50720.3221   26  189 42552.9121 62560.8752  47.0%  2370 1049s
  3282  2765 49960.7535   31  156 42552.9121 62461.7233  46.8%  2334 1078s
  3522  2902 49436.5459   34  140 42552.9121 62461.7233  46.8%  2298 1108s
  3726  2903 44272.6262   37  356 42552.9121 62273.4627  46.3%  2303 1171s
  3728  2904 51554.5454   15   95 42552.9121 62273.4627  46.3%  2302 1206s
  3729  2905 55740.0946   12  263 42552.9121 62273.4627  46.3%  2301 1236s
  3730  2906 51016.3719   18  336 42552.9121 62273.4627  46.3%  2301 1268s
  3731  2906 58586.8342   10  373 42552.9121 62273.4627  46.3%  2300 1278s
  3732  2907 51219.4222   32  351 42552.9121 62273.4627  46.3%  2300 1288s
  3733  2908 50716.7508   34  422 42552.9121 62273.4627  46.3%  2299 1295s
  3735  2909 47130.0828   38  351 42552.9121 62273.4627  46.3%  2298 1304s
  3736  2910 47610.6185   40  340 42552.9121 62273.4627  46.3%  2297 1307s
  3738  2911 54369.1189   14  423 42552.9121 62273.4627  46.3%  2296 1312s
  3740  2912 48480.8818   43  389 42552.9121 62273.4627  46.3%  2295 1317s
  3741  2913 48796.6488   54  458 42552.9121 62273.4627  46.3%  2294 1325s
  3742  2914 54139.0133   21  460 42552.9121 62273.4627  46.3%  2293 1330s
  3744  2915 50126.4723   26  443 42552.9121 62273.4627  46.3%  2292 1336s
  3745  2916 51633.5550   14  458 42552.9121 62273.4627  46.3%  2292 1342s
  3747  2917 58649.5618   12  397 42552.9121 62273.4627  46.3%  2290 1347s
  3748  2918 43832.5738   41  409 42552.9121 62273.4627  46.3%  2290 1353s
  3749  2918 46196.4372   20  404 42552.9121 62273.4627  46.3%  2289 1357s
  3750  2919 57267.2031   22  394 42552.9121 62273.4627  46.3%  2289 1366s
  3752  2920 54257.1364   20  363 42552.9121 62273.4627  46.3%  2287 1376s
  3753  2921 54995.7817   25  357 42552.9121 62273.4627  46.3%  2287 1381s
  3754  2922 51411.2498   39  370 42552.9121 62273.4627  46.3%  2286 1389s
  3755  2922 50356.1316   39  365 42552.9121 62273.4627  46.3%  2286 1392s
  3756  2923 45753.2400   78  422 42552.9121 62273.4627  46.3%  2285 1399s
  3757  2924 61200.6734   10  377 42552.9121 62273.4627  46.3%  2284 1403s
  3758  2924 54814.3307   24  386 42552.9121 62273.4627  46.3%  2284 1410s
  3759  2925 46764.2264   53  453 42552.9121 62273.4627  46.3%  2283 1415s
  3760  2926 54687.6209   21  360 42552.9121 62273.4627  46.3%  2282 1420s
  3761  2926 50716.7508   34  360 42552.9121 62273.4627  46.3%  2282 1457s
  3762  2927 55609.8039   20  360 42552.9121 62273.4627  46.3%  2281 1497s
  3763  2931 62273.4627   12  373 42552.9121 62273.4627  46.3%  2336 1525s
  3765  2934 62273.4627   13  373 42552.9121 62273.4627  46.3%  2340 1547s
  3769  2941 62273.4627   14  385 42552.9121 62273.4627  46.3%  2343 1575s
  3777  2954 62273.4627   15  431 42552.9121 62273.4627  46.3%  2357 1601s
  3793  2965 62273.4627   16  456 42552.9121 62273.4627  46.3%  2418 1658s
  3809  2991 61546.6284   17  417 42552.9121 62273.4627  46.3%  2456 1703s
  3841  3107 60963.9560   18  382 42552.9121 62273.4627  46.3%  2547 1744s
  3967  3139 58939.6728   21  346 42552.9121 62273.4627  46.3%  2646 1766s
  4041  3187 59160.4830   21  350 42552.9121 62273.4627  46.3%  2692 1787s
  4115  3185 53045.1730   26  226 42552.9121 62273.4627  46.3%  2712 1804s
  4145  3198 57745.0662   19  275 42552.9121 62273.4627  46.3%  2732 1822s
  4187  3202 56352.7493   21  348 42552.9121 62273.4627  46.3%  2767 1840s
  4230  3216 58620.8232   22  338 42552.9121 62273.4627  46.3%  2795 1879s
  4273  3238 58836.6039   22  360 42552.9121 62273.4627  46.3%  2825 1898s
  4315  3260 54470.7674   22  335 42552.9121 62273.4627  46.3%  2861 1917s
  4366  3280 57417.3142   23  333 42552.9121 62273.4627  46.3%  2886 1936s
  4417  3285 57286.6516   24  334 42552.9121 62273.4627  46.3%  2904 1953s
  4471  3279 56013.7641   26  292 42552.9121 62273.4627  46.3%  2907 1980s
  4536  3265 53255.3823   27  291 42552.9121 62273.4627  46.3%  2928 1999s
  4592  3268 53209.5918   28  256 42552.9121 62273.4627  46.3%  2993 2020s
  4647  3270 52835.6305   29  206 42552.9121 62273.4627  46.3%  3046 2041s
  4710  3277 52492.0193   30  204 42552.9121 62273.4627  46.3%  3084 2066s
  4773  3280 50374.5481   30  213 42552.9121 62273.4627  46.3%  3143 2094s
  4838  3283 50009.1586   32  188 42552.9121 62273.4627  46.3%  3202 2117s
  4875  3301 49660.0383   33  214 42552.9121 62273.4627  46.3%  3260 2139s
  4913  3316 49576.6217   34  182 42552.9121 62273.4627  46.3%  3310 2161s
  4968  3340 49467.1659   35  128 42552.9121 62273.4627  46.3%  3349 2185s
  5037  3372 48883.2706   38  231 42552.9121 62273.4627  46.3%  3378 2210s
  5138  3382 48759.2268   40  152 42552.9121 62273.4627  46.3%  3407 2235s
  5236  3391     cutoff   41      42552.9121 62273.4627  46.3%  3434 2266s
  5356  3409 44353.5735   47  103 42552.9121 61575.8454  44.7%  3442 2294s
  5456  3468     cutoff   56      42552.9121 61575.8454  44.7%  3498 2324s
  5585  3497 43758.7900   60   90 42552.9121 60306.9023  41.7%  3517 2353s
  5729  3495 43302.8338   70   64 42552.9121 60306.9023  41.7%  3534 2386s
  5872  3514 42995.2753   75   57 42552.9121 60306.9023  41.7%  3570 2418s
  6018  3527 51394.4481   22  339 42552.9121 59786.9148  40.5%  3610 2452s
  6139  3567 46555.4793   24  312 42552.9121 59786.9148  40.5%  3658 2485s
  6260  3546 44347.4256   26  288 42552.9121 59786.9148  40.5%  3686 2510s
  6303  3559 43834.9233   27  312 42552.9121 59786.9148  40.5%  3717 2539s
  6342  3569 43593.4152   28  299 42552.9121 59786.9148  40.5%  3726 2563s
  6382  3571 43246.1985   29  304 42552.9121 59786.9148  40.5%  3736 2596s
  6442  3591     cutoff   30      42552.9121 59786.9148  40.5%  3746 2630s
  6522  3608 54140.1763   19  298 42552.9121 59786.9148  40.5%  3760 2670s
  6637  3625 52159.5326   20  272 42552.9121 58688.3271  37.9%  3771 2712s
  6755  3622 52057.5468   21  271 42552.9121 58688.3271  37.9%  3820 2752s
  6870  3676 50558.0570   24  236 42552.9121 58037.4728  36.4%  3863 2799s
  7037  3729 47242.2104   29  168 42552.9121 58037.3879  36.4%  3912 2849s
  7246  3769 44501.6242   37  173 42552.9121 58037.3879  36.4%  3959 2896s
  7506  3750 50509.4940   23  324 42552.9121 57818.4384  35.9%  3987 2938s
H 7599  3571                    42652.662856 57741.8544  35.4%  3990 2938s
  7689  3654 49844.1683   24  332 42652.6629 57663.3026  35.2%  3982 2996s
  7896  3670 43150.5292   28  209 42652.6629 57437.6866  34.7%  4042 3048s
  8145  3711 44449.2551   32  145 42652.6629 57366.1054  34.5%  4085 3107s
  8437  3743 47045.1263   21  304 42652.6629 57366.1054  34.5%  4136 3159s
  8677  3757 49420.6966   22  338 42652.6629 57022.8113  33.7%  4197 3217s
H 8719  3589                    42761.128150 56936.6838  33.2%  4208 3217s
  8892  3636     cutoff   26      42761.1282 56727.3881  32.7%  4225 3275s
  9182  3684 45080.0432   24  352 42761.1282 56326.0191  31.7%  4291 3337s
  9456  3649 53213.6710   22  281 42761.1282 56079.8030  31.1%  4363 3389s
H 9523  3485                    42810.001082 56079.8030  31.0%  4365 3389s
  9571  3595 50734.1468   23  215 42810.0011 56079.8030  31.0%  4370 3453s
  9915  3629 51182.7207   21  241 42810.0011 56079.8030  31.0%  4423 3517s
 10327  3664 53565.8887   23  353 42810.0011 56079.8030  31.0%  4453 3583s
H10686  3431                    43096.079153 56079.8030  30.1%  4507 3600s

Cutting planes:
  MIR: 893
  Mixing: 7
  Flow cover: 2044
  RLT: 37
  Relax-and-lift: 153

Explored 10808 nodes (48946623 simplex iterations) in 3600.05 seconds (6924.54 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 43096.1 42810 42761.1 ... 40815

Time limit reached
Best objective 4.309607915300e+04, best bound 5.607980295156e+04, gap 30.1274%
  WARNING: Time limit reached. Using best solution found (gap: 30.13%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = 43096.08, θ = 226473.46
  Upper Bound (UB) = 43096.08

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 226473.46
  [DEBUG]   ✓ Scenario 0: θ = 226473.46 ≤ Q = 226473.46 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 226473.46 ≤ Q = 226473.46 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 226473.46 ≤ Q = 226473.46 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 226473.46 ≤ Q = 226473.46 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 226473.46 ≤ Q = 226473.46 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 226473.46 ≤ Q = 226473.46 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 226473.46 ≤ Q = 226473.46 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 226473.46 ≤ Q = 226473.46 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x4725328c
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xb8dacd74
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.396946e+13
Presolve removed 2585 rows and 1875 columns
Presolve time: 0.01s
Presolved: 508 rows, 514 columns, 1433 nonzeros
Found heuristic solution: objective 6933230.7058
Variable types: 350 continuous, 164 integer (164 binary)

Root relaxation: objective -1.765351e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -176535.06    0  123 6933230.71 -176535.06   103%     -    0s
H    0     0                    -139736.9952 -176535.06  26.3%     -    0s
H    0     0                    -140069.4265 -176535.06  26.0%     -    0s
H    0     0                    -146689.6364 -176535.06  20.3%     -    0s
H    0     0                    -149426.9081 -153711.22  2.87%     -    0s
     0     0 -153138.31    0   64 -149426.91 -153138.31  2.48%     -    0s
H    0     0                    -152367.0107 -153138.31  0.51%     -    0s
     0     0 -153056.36    0   58 -152367.01 -153056.36  0.45%     -    0s
     0     0 -153054.29    0   55 -152367.01 -153054.29  0.45%     -    0s
     0     0 -153051.75    0   54 -152367.01 -153051.75  0.45%     -    0s
     0     0 -153039.97    0   54 -152367.01 -153039.97  0.44%     -    0s
     0     0 -152478.03    0   19 -152367.01 -152478.03  0.07%     -    0s
     0     0 -152449.95    0    8 -152367.01 -152449.95  0.05%     -    0s
H    0     0                    -152425.2455 -152448.00  0.01%     -    0s
     0     0          -    0      -152425.25 -152439.92  0.01%     -    0s

Cutting planes:
  Gomory: 33
  Implied bound: 2
  MIR: 109
  Flow cover: 5
  RLT: 47
  Relax-and-lift: 7
  BQP: 6

Explored 1 nodes (525 simplex iterations) in 0.04 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 8: -152425 -152367 -149427 ... 1.39695e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.524252455179e+05, best bound -1.524399239924e+05, gap 0.0096%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 215526.95
  Scenario: 20 demand increases, 40 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -152425.25
  [DEBUG]   S×d_nominal = 367952.20
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 367952.20 + -152425.25 = 215526.95
  [DEBUG]   Current θ from Master = 226473.46
  [DEBUG]   ⚠️  Z_SP ≤ θ by 10946.51 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 32149.57
  Lower Bound (LB) = 38407.27
  Gap (UB-LB) = 4688.8091, Absolute Gap = 4688.8091, Relative Gap = 0.108799
  Not converged yet (gap = 4688.81 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 20 increases, 40 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394652 nonzeros
Model fingerprint: 0x4832e2f6
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 61872 rows and 25122 columns
Presolve time: 2.48s
Presolved: 77121 rows, 33298 columns, 472961 nonzeros
Variable types: 31039 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -309441.0403
Found heuristic solution: objective -183060.7998

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 77121 rows, 33298 columns, 472961 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   25797   -2.2969641e+05   0.000000e+00   6.809799e+06      5s
   36137   -1.0358816e+05   0.000000e+00   1.707385e+09     10s
   46131    1.5752882e+04   0.000000e+00   1.189515e+07     15s
   53717    3.1017169e+04   0.000000e+00   1.092292e+08     20s
   61096    4.1340090e+04   0.000000e+00   1.418097e+07     25s
   67120    4.4656870e+04   0.000000e+00   5.916996e+06     30s
   72988    4.7143218e+04   0.000000e+00   3.322970e+07     35s
   79238    5.8478245e+04   0.000000e+00   7.867794e+06     40s
Concurrent spin time: 14.60s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 8.308372e+04, 68537 iterations, 52.93 seconds (60.70 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 83083.7191    0  173 -183060.80 83083.7191   145%     -   56s
H    0     0                    -171128.6265 83083.7191   149%     -   56s
H    0     0                    -87477.05890 83083.7191   195%     -   56s
H    0     0                    -34057.66107 83083.7191   344%     -   56s
H    0     0                    -31380.86970 83083.7191   365%     -   56s
H    0     0                    -31182.55989 83083.7191   366%     -   56s
H    0     0                    -227.4579972 83083.7191      -     -   57s
H    0     0                    6936.6505177 83083.7191  1098%     -   58s
H    0     0                    7899.8671708 83083.7191   952%     -   58s
H    0     0                    9622.6400075 83083.7191   763%     -   58s
H    0     0                    9691.6389587 83083.7191   757%     -   58s
H    0     0                    9720.2366491 83083.7191   755%     -   58s
H    0     0                    9801.3480857 83083.7191   748%     -   58s
H    0     0                    20950.777939 83083.7191   297%     -   59s
H    0     0                    23524.604948 83083.7191   253%     -   59s
H    0     0                    27452.618921 83083.7191   203%     -   59s
H    0     0                    27740.600766 83083.7191   200%     -   59s
H    0     0                    28028.922884 83083.7191   196%     -   59s
H    0     0                    28353.829253 83083.7191   193%     -   59s
     0     0 74729.2309    0  208 28353.8293 74729.2309   164%     -   76s
H    0     0                    28694.295094 74729.2120   160%     -   77s
     0     0 74515.3537    0  198 28694.2951 74515.3537   160%     -   81s
     0     0 74407.5081    0  204 28694.2951 74407.5081   159%     -   84s
     0     0 74224.0842    0  212 28694.2951 74224.0842   159%     -   86s
     0     0 74211.0767    0  199 28694.2951 74211.0767   159%     -   90s
     0     0 74211.0767    0  201 28694.2951 74211.0767   159%     -   90s
     0     0 74209.6250    0  199 28694.2951 74209.6250   159%     -   90s
     0     0 74209.6250    0  199 28694.2951 74209.6250   159%     -   91s
     0     0 70894.5096    0  214 28694.2951 70894.5096   147%     -  107s
H    0     0                    32723.435356 70894.5096   117%     -  108s
H    0     0                    34492.327284 70894.5096   106%     -  108s
H    0     0                    34593.799934 70894.5096   105%     -  108s
     0     0 69925.9514    0  247 34593.7999 69925.9514   102%     -  121s
     0     0 69753.7272    0  314 34593.7999 69753.7272   102%     -  127s
     0     0 69638.6567    0  322 34593.7999 69638.6567   101%     -  133s
     0     0 69558.0133    0  253 34593.7999 69558.0133   101%     -  138s
     0     0 69451.3839    0  255 34593.7999 69451.3839   101%     -  145s
     0     0 69430.4272    0  325 34593.7999 69430.4272   101%     -  148s
     0     0 69426.9912    0  318 34593.7999 69426.9912   101%     -  149s
     0     0 69419.1627    0  327 34593.7999 69419.1627   101%     -  150s
     0     0 69415.3163    0  328 34593.7999 69415.3163   101%     -  150s
     0     0 69415.2821    0  328 34593.7999 69415.2821   101%     -  151s
     0     0 67167.6610    0  271 34593.7999 67167.6610  94.2%     -  175s
     0     0 66213.3634    0  336 34593.7999 66213.3634  91.4%     -  188s
     0     0 65899.3424    0  323 34593.7999 65899.3424  90.5%     -  194s
     0     0 65705.6976    0  322 34593.7999 65705.6976  89.9%     -  201s
     0     0 65612.7229    0  332 34593.7999 65612.7229  89.7%     -  205s
     0     0 65557.8551    0  338 34593.7999 65557.8551  89.5%     -  208s
     0     0 65542.2785    0  335 34593.7999 65542.2785  89.5%     -  209s
     0     0 65538.3885    0  339 34593.7999 65538.3885  89.5%     -  210s
     0     0 65534.3901    0  336 34593.7999 65534.3901  89.4%     -  210s
     0     0 65531.4805    0  336 34593.7999 65531.4805  89.4%     -  211s
     0     0 65530.6903    0  337 34593.7999 65530.6903  89.4%     -  211s
     0     0 64979.2822    0  336 34593.7999 64979.2822  87.8%     -  225s
H    0     0                    34804.476272 64978.5101  86.7%     -  225s
H    0     0                    34889.088761 64978.5101  86.2%     -  225s
H    0     0                    35105.167495 64978.5101  85.1%     -  225s
H    0     0                    35126.349246 64978.5101  85.0%     -  226s
H    0     0                    35151.676489 64978.5101  84.9%     -  226s
     0     0 64910.0082    0  372 35151.6765 64910.0082  84.7%     -  230s
     0     0 64872.3650    0  381 35151.6765 64872.3650  84.5%     -  234s
     0     0 64860.1311    0  377 35151.6765 64860.1311  84.5%     -  236s
     0     0 64854.3624    0  341 35151.6765 64854.3624  84.5%     -  237s
     0     0 64845.4120    0  374 35151.6765 64845.4120  84.5%     -  238s
     0     0 64840.7842    0  380 35151.6765 64840.7842  84.5%     -  241s
     0     0 64836.2496    0  382 35151.6765 64836.2496  84.4%     -  242s
     0     0 64834.0134    0  339 35151.6765 64834.0134  84.4%     -  243s
     0     0 64752.0038    0  377 35151.6765 64752.0038  84.2%     -  250s
H    0     0                    35187.564278 64751.0653  84.0%     -  250s
     0     0 64715.4191    0  418 35187.5643 64715.4191  83.9%     -  255s
     0     0 64707.0898    0  396 35187.5643 64707.0898  83.9%     -  256s
     0     0 64698.7131    0  420 35187.5643 64698.7131  83.9%     -  258s
     0     0 64690.2302    0  389 35187.5643 64690.2302  83.8%     -  259s
     0     0 64688.5081    0  398 35187.5643 64688.5081  83.8%     -  260s
     0     0 64655.2462    0  375 35187.5643 64655.2462  83.7%     -  265s
     0     0 64629.1884    0  382 35187.5643 64629.1884  83.7%     -  270s
     0     0 64616.1731    0  389 35187.5643 64616.1731  83.6%     -  273s
     0     0 64610.0368    0  381 35187.5643 64610.0368  83.6%     -  275s
     0     0 64609.1391    0  377 35187.5643 64609.1391  83.6%     -  276s
     0     0 64587.8671    0  370 35187.5643 64587.8671  83.6%     -  281s
     0     0 64578.0218    0  420 35187.5643 64578.0218  83.5%     -  285s
     0     0 64573.2139    0  353 35187.5643 64573.2139  83.5%     -  286s
     0     0 64572.0453    0  387 35187.5643 64572.0453  83.5%     -  287s
     0     0 64543.7954    0  420 35187.5643 64543.7954  83.4%     -  291s
H    0     0                    35257.770750 64543.7905  83.1%     -  293s
     0     0 64537.2827    0  382 35257.7708 64537.2827  83.0%     -  295s
     0     0 64532.0175    0  382 35257.7708 64532.0175  83.0%     -  296s
     0     0 64531.1910    0  394 35257.7708 64531.1910  83.0%     -  297s
     0     0 64520.0684    0  393 35257.7708 64520.0684  83.0%     -  301s
     0     0 64518.3674    0  439 35257.7708 64518.3674  83.0%     -  302s
     0     0 64511.5049    0  434 35257.7708 64511.5049  83.0%     -  305s
H    0     0                    35427.295560 64511.3322  82.1%     -  306s
H    0     0                    35489.617537 64511.3322  81.8%     -  307s
H    0     0                    35537.874161 64511.3322  81.5%     -  307s
     0     0 64507.0077    0  413 35537.8742 64507.0077  81.5%     -  308s
     0     0 64506.1776    0  409 35537.8742 64506.1776  81.5%     -  309s
     0     0 64502.1790    0  405 35537.8742 64502.1790  81.5%     -  311s
     0     0 64502.0053    0  405 35537.8742 64502.0053  81.5%     -  313s
H    0     0                    35717.197897 64501.9764  80.6%     -  372s
     0     2 64501.9764    0  405 35717.1979 64501.9764  80.6%     -  376s
     1     4 64325.6200    1  374 35717.1979 64499.7521  80.6%  3288  390s
     3     8 64181.7714    2  408 35717.1979 64325.4008  80.1%  6295  402s
     7    16 63979.6287    3  411 35717.1979 64179.4103  79.7%  7148  421s
    15    32 63887.1903    4  420 35717.1979 63978.5419  79.1%  9222  438s
    31    48 62668.9771    5  383 35717.1979 63886.7572  78.9% 11587  472s
    47    80 61684.9307    6  338 35717.1979 63886.7572  78.9% 12976  499s
H   48    80                    36051.214701 63886.7572  77.2% 12705  499s
    49    80 60381.9532    6  313 36051.2147 63886.7572  77.2% 12835  500s
H   63    80                    36097.819713 63886.7572  77.0% 11779  500s
H   69    80                    36178.682026 63886.7572  76.6% 11153  500s
H   71    80                    36191.693673 63886.7572  76.5% 10907  500s
    79   143 61522.2361    7  310 36191.6937 63886.7572  76.5% 10204  573s
   142   282 60863.1608    9  309 36191.6937 63886.7572  76.5%  8304  605s
   281   379 61165.7176   11  304 36191.6937 63886.7572  76.5%  5693  623s
   378   411 60741.4306   12  302 36191.6937 63886.7572  76.5%  4989  645s
   410   444 60882.3914   12  300 36191.6937 63886.7572  76.5%  4774  687s
   443   479 57138.2692   12  224 36191.6937 63886.7572  76.5%  4714  712s
   478   513 60717.2892   12  290 36191.6937 63886.7572  76.5%  4566  723s
   512   549 60706.7138   11  289 36191.6937 63886.7572  76.5%  4461  737s
   548   581 55787.2108   29  179 36191.6937 63886.7572  76.5%  4364  752s
   580   618 60394.5915   13  298 36191.6937 63886.7572  76.5%  4218  765s
   617   649 60867.7136   13  300 36191.6937 63886.7572  76.5%  4061  780s
   648   681 60739.2833   13  301 36191.6937 63886.7572  76.5%  3940  794s
   680   713 60453.8578   14  293 36191.6937 63886.7572  76.5%  3861  806s
H  687   713                    36216.519550 63886.7572  76.4%  3857  806s
   712   751 59823.1909   13  283 36216.5195 63886.7572  76.4%  3818  816s
H  713   751                    36615.366770 63886.7572  74.5%  3813  816s
H  723   751                    36618.857862 63886.7572  74.5%  3782  816s
H  727   751                    37116.815997 63886.7572  72.1%  3768  816s
   750   883 60042.9500   13  290 37116.8160 63886.7572  72.1%  3699  832s
   882  1031 60315.5461   14  259 37116.8160 63886.7572  72.1%  3393  844s
  1030  1183 60251.3921   14  290 37116.8160 63886.7572  72.1%  3075  858s
  1188  1364 60131.3467   15  256 37116.8160 63886.7572  72.1%  2822  875s
  1371  1555 59956.2434   14  280 37116.8160 63886.7572  72.1%  2567  893s
  1568  1710 60037.7346   16  327 37116.8160 63886.7572  72.1%  2360  909s
  1763  1752 59860.4842   16  275 37116.8160 63886.7572  72.1%  2216  924s
  1807  1786 59759.5288   16  250 37116.8160 63886.7572  72.1%  2194  942s
H 1816  1786                    37140.945011 63886.7572  72.0%  2190  942s
H 1820  1786                    37519.686879 63886.7572  70.3%  2187  942s
  1871  1893 59696.7225   16  249 37519.6869 63886.7572  70.3%  2163  962s
  2057  2019 59943.5621   17  371 37519.6869 63746.8447  69.9%  2084  985s
  2233  2141 59656.9067   17  288 37519.6869 63746.7402  69.9%  2019 1007s
  2417  2253 59825.7739   18  332 37519.6869 63746.7402  69.9%  1960 1029s
  2607  2302 59380.4435   18  330 37519.6869 63746.7402  69.9%  1901 1052s
  2724  2361 59709.2235   19  354 37519.6869 63746.7402  69.9%  1923 1076s
  2827  2392 58066.1342   20  300 37519.6869 63512.5680  69.3%  1960 1092s
  2860  2419 53816.8454   19  195 37519.6869 63512.5680  69.3%  1999 1113s
H 2889  2419                    37586.052379 63512.5680  69.0%  2037 1113s
  2891  2481 54985.8217   21  301 37586.0524 63512.5680  69.0%  2044 1136s
  2973  2510 51356.9832   21  311 37586.0524 63512.5680  69.0%  2092 1161s
  3006  2556 53506.0435   22  294 37586.0524 63512.5680  69.0%  2125 1182s
H 3052  2556                    37743.918004 63512.5680  68.3%  2145 1182s
  3060  2775 53467.8926   23  280 37743.9180 63512.5680  68.3%  2148 1208s
  3305  2996 51564.9352   25  261 37743.9180 63512.5680  68.3%  2092 1231s
H 3578  2996                    37762.440850 63512.5680  68.2%  2035 1279s
H 3578  2996                    37789.059189 63512.5680  68.1%  2035 1291s
H 3578  2996                    37939.527998 63512.5680  67.4%  2035 1298s
H 3578  2996                    37952.720217 63512.5680  67.3%  2035 1306s
  3579  2997 39763.8877   30  405 37952.7202 63512.5680  67.3%  2034 1458s
H 3580  2848                    38044.854172 63512.5680  66.9%  2033 1532s
H 3581  2705                    38759.565651 63512.5680  63.9%  2033 1569s
H 3581  2570                    38766.353200 63512.5680  63.8%  2033 1569s
H 3581  2441                    38795.987905 63512.5680  63.7%  2033 1573s
H 3582  2320                    38853.601513 63512.5680  63.5%  2032 1590s
H 3582  2204                    38860.914398 63512.5680  63.4%  2032 1590s
  3584  2205 51139.7140   27  344 38860.9144 63512.5680  63.4%  2031 1610s
  3585  2206 42093.5070   30  350 38860.9144 63512.5680  63.4%  2031 1627s
  3586  2207 44237.9814   89  369 38860.9144 63512.5680  63.4%  2030 1636s
  3587  2207 54020.7155   20  388 38860.9144 63512.5680  63.4%  2029 1643s
  3588  2208 40295.3092   78  386 38860.9144 63512.5680  63.4%  2029 1648s
  3589  2209 41557.6954   34  426 38860.9144 63512.5680  63.4%  2028 1651s
  3591  2210 41635.1159   91  398 38860.9144 63512.5680  63.4%  2027 1656s
  3592  2211 61286.8935    7  389 38860.9144 63512.5680  63.4%  2027 1660s
H 3593  2100                    38871.210997 63512.5680  63.4%  2026 1671s
H 3593  1995                    38871.348972 63512.5680  63.4%  2026 1674s
  3595  1997 51648.2523   52  399 38871.3490 63512.5680  63.4%  2025 1678s
  3597  1998 52531.2029   35  361 38871.3490 63512.5680  63.4%  2024 1681s
  3599  1999 54023.8692   20  359 38871.3490 63512.5680  63.4%  2023 1686s
  3600  2000 57448.1814   19  381 38871.3490 63512.5680  63.4%  2022 1694s
  3601  2001 54135.0337   43  389 38871.3490 63512.5680  63.4%  2022 1698s
  3602  2001 58503.0375    8  389 38871.3490 63512.5680  63.4%  2021 1701s
  3604  2003 56869.2803   38  423 38871.3490 63512.5680  63.4%  2020 1717s
  3605  2003 53958.0189   30  428 38871.3490 63512.5680  63.4%  2019 1721s
H 3605  1902                    38880.837048 63512.5680  63.4%  2019 1726s
H 3605  1807                    38900.539760 63512.5680  63.3%  2019 1726s
H 3605  1716                    38949.017464 63512.5680  63.1%  2019 1726s
  3607  1718 45308.7736   62  420 38949.0175 63512.5680  63.1%  2018 1730s
  3608  1718 43779.8042   58  398 38949.0175 63512.5680  63.1%  2018 1741s
  3609  1719 56532.7814   24  395 38949.0175 63512.5680  63.1%  2017 1747s
H 3609  1632                    39162.041516 63512.5680  62.2%  2017 1750s
  3612  1634 60055.4906    9  431 39162.0415 63512.5680  62.2%  2015 1755s
  3613  1635 49314.1948   28  386 39162.0415 63512.5680  62.2%  2015 1763s
  3614  1635 50578.2670   33  403 39162.0415 63512.5680  62.2%  2014 1768s
  3615  1636 58553.1119   15  386 39162.0415 63512.5680  62.2%  2014 1776s
  3617  1637 42388.2124   93  446 39162.0415 63512.5680  62.2%  2013 1784s
  3618  1638 57487.8941   13  401 39162.0415 63512.5680  62.2%  2012 1791s
  3619  1639 39162.0415   98  466 39162.0415 63512.5680  62.2%  2011 1796s
  3620  1639 55626.6685   17  408 39162.0415 63512.5680  62.2%  2011 1803s
  3621  1640 53230.8337   13  361 39162.0415 63512.5680  62.2%  2010 1805s
  3623  1641 39810.5242   62  398 39162.0415 63512.5680  62.2%  2009 1815s
  3625  1643 43886.4228   65  392 39162.0415 63512.5680  62.2%  2008 1823s
  3626  1643 59350.9352   15  392 39162.0415 63512.5680  62.2%  2008 1888s
  3627  1644 59703.9621   16  392 39162.0415 63512.5680  62.2%  2007 1946s
  3628  1648 63512.5680   13  396 39162.0415 63512.5680  62.2%  2086 2017s
  3630  1651 63512.5680   14  390 39162.0415 63512.5680  62.2%  2089 2056s
  3634  1658 63512.5680   15  377 39162.0415 63512.5680  62.2%  2095 2104s
  3642  1671 63066.1998   16  395 39162.0415 63512.5680  62.2%  2121 2150s
  3658  1682 60479.8331   17  313 39162.0415 63198.9619  61.4%  2173 2209s
  3674  1708 59931.0685   18  299 39162.0415 63198.9619  61.4%  2269 2282s
H 3675  1625                    39279.416154 63198.9619  60.9%  2268 2282s
H 3679  1545                    39298.465915 63198.9619  60.8%  2277 2282s
H 3686  1468                    39302.260776 63198.9619  60.8%  2291 2282s
H 3693  1394                    39358.402693 63198.9619  60.6%  2300 2282s
  3706  1496 58954.5746   19  297 39358.4027 63198.9619  60.6%  2316 2351s
  3812  1542 57850.3634   24  288 39358.4027 63198.9619  60.6%  2544 2394s
  3894  1585 57641.5553   25  289 39358.4027 63198.9619  60.6%  2604 2429s
  3964  1593 53219.2858   26  270 39358.4027 63198.9619  60.6%  2663 2455s
  3995  1615 53468.8058   27  303 39358.4027 63198.9619  60.6%  2675 2480s
  4028  1632 52763.8901   25  267 39358.4027 63198.9619  60.6%  2713 2505s
  4064  1646 52119.4233   27  289 39358.4027 63198.9619  60.6%  2733 2531s
  4100  1676 51827.1361   27  272 39358.4027 63198.9619  60.6%  2752 2554s
  4147  1704 52467.1220   28  300 39358.4027 63198.9619  60.6%  2763 2583s
  4200  1751 50972.7473   27  253 39358.4027 63066.1422  60.2%  2774 2610s
  4273  1785 50526.8754   28  242 39358.4027 63066.1422  60.2%  2786 2636s
  4358  1799 50305.7163   29  250 39358.4027 63066.1422  60.2%  2799 2662s
  4445  1806 48197.8218   30  244 39358.4027 63066.1422  60.2%  2800 2688s
  4543  1792 48275.1173   30  226 39358.4027 63066.1422  60.2%  2800 2728s
  4625  1808 45673.0139   31  243 39358.4027 63066.1422  60.2%  2810 2774s
  4706  1824 42858.7207   31  266 39358.4027 63066.1422  60.2%  2829 2803s
  4811  1836 43094.4452   31  254 39358.4027 63066.1422  60.2%  2831 2844s
  4921  1853 41306.5357   32  238 39358.4027 63066.1422  60.2%  2832 2883s
  5004  1877 43665.6139   33  232 39358.4027 63066.1422  60.2%  2846 2913s
  5080  1904     cutoff   36      39358.4027 63066.1422  60.2%  2869 2951s
  5176  1918 infeasible   38      39358.4027 63066.1422  60.2%  2876 2993s
  5275  1944 56829.9997   18  331 39358.4027 63066.1422  60.2%  2897 3031s
  5393  1962 56197.0696   20  328 39358.4027 63066.1422  60.2%  2913 3067s
  5512  1975 49316.4429   22  275 39358.4027 63066.1422  60.2%  2931 3104s
  5632  1996 50259.6432   22  311 39358.4027 63066.1422  60.2%  2946 3150s
  5750  2033 53851.9771   22  295 39358.4027 62877.6890  59.8%  2970 3193s
  5885  2078 51442.6415   24  291 39358.4027 62877.6890  59.8%  2991 3234s
  6011  2115 52092.7737   23  316 39358.4027 60812.0698  54.5%  3010 3284s
  6133  2185 49519.2659   24  227 39358.4027 60812.0698  54.5%  3021 3338s
  6285  2235 48637.0859   27  241 39358.4027 60812.0698  54.5%  3045 3397s
  6467  2279 45305.8606   30  189 39358.4027 60446.9310  53.6%  3050 3449s
* 6636  2129             110    39887.986132 60446.9310  51.5%  3067 3449s
  6640  2218 44449.6260   34  188 39887.9861 60446.9310  51.5%  3065 3503s
  6804  2262     cutoff   39      39887.9861 60446.9310  51.5%  3085 3555s
  7014  2245     cutoff   32      39887.9861 59746.2224  49.8%  3090 3600s

Cutting planes:
  Learned: 1
  Gomory: 14
  Projected implied bound: 38
  MIR: 1414
  Mixing: 4
  Flow cover: 2236
  RLT: 30
  Relax-and-lift: 262

Explored 7173 nodes (22478774 simplex iterations) in 3600.08 seconds (6025.59 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 39888 39358.4 39302.3 ... 38871.3

Time limit reached
Best objective 3.988798613207e+04, best bound 5.950605279252e+04, gap 49.1829%
  WARNING: Time limit reached. Using best solution found (gap: 49.18%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.10s
  Master Objective (UB) = 39887.99, θ = 219073.56
  Upper Bound (UB) = 39887.99

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 219073.56
  [DEBUG]   ✓ Scenario 0: θ = 219073.56 ≤ Q = 219073.56 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 219073.56 ≤ Q = 219073.56 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 219073.56 ≤ Q = 219073.56 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 219073.56 ≤ Q = 219073.56 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 219073.56 ≤ Q = 219073.56 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 219073.56 ≤ Q = 219073.56 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 219073.56 ≤ Q = 219073.56 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 219073.56 ≤ Q = 219073.56 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 219073.56 ≤ Q = 219073.56 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x44628b4a
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xbb9d74b6
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [3e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e-13, 2e+02]
Found heuristic solution: objective 1.326568e+13
Presolve removed 2586 rows and 1877 columns
Presolve time: 0.01s
Presolved: 507 rows, 512 columns, 1432 nonzeros
Found heuristic solution: objective 6518670.4042
Variable types: 348 continuous, 164 integer (164 binary)

Root relaxation: objective -1.615181e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -161518.07    0  127 6518670.40 -161518.07   102%     -    0s
H    0     0                    -126033.7840 -161518.07  28.2%     -    0s
H    0     0                    -126366.2152 -161518.07  27.8%     -    0s
H    0     0                    -129226.6015 -140927.70  9.05%     -    0s
     0     0 -140927.70    0   97 -129226.60 -140927.70  9.05%     -    0s
H    0     0                    -130909.8661 -140490.75  7.32%     -    0s
H    0     0                    -133908.3167 -140490.75  4.92%     -    0s
H    0     0                    -135806.7478 -140490.75  3.45%     -    0s
     0     0 -139290.28    0  100 -135806.75 -139290.28  2.57%     -    0s
     0     0 -139290.28    0   97 -135806.75 -139290.28  2.57%     -    0s
H    0     0                    -138307.4806 -138662.79  0.26%     -    0s
     0     0 -138661.94    0   68 -138307.48 -138661.94  0.26%     -    0s
     0     0 -138648.49    0   63 -138307.48 -138648.49  0.25%     -    0s
     0     0 -138619.29    0   60 -138307.48 -138619.29  0.23%     -    0s
     0     0 -138611.89    0   59 -138307.48 -138611.89  0.22%     -    0s
     0     0 -138606.92    0   58 -138307.48 -138606.92  0.22%     -    0s
     0     0 -138554.85    0   42 -138307.48 -138554.85  0.18%     -    0s
     0     0 -138550.82    0   42 -138307.48 -138550.82  0.18%     -    0s
     0     0 -138535.21    0   49 -138307.48 -138535.21  0.16%     -    0s
     0     0 -138525.05    0   49 -138307.48 -138525.05  0.16%     -    0s
H    0     0                    -138336.9831 -138525.05  0.14%     -    0s
     0     0 -138525.05    0   55 -138336.98 -138525.05  0.14%     -    0s
     0     0 -138367.25    0   32 -138336.98 -138367.25  0.02%     -    0s
     0     0 -138365.61    0   28 -138336.98 -138365.61  0.02%     -    0s
     0     0 -138355.46    0    7 -138336.98 -138355.46  0.01%     -    0s
     0     0 -138352.23    0    6 -138336.98 -138352.23  0.01%     -    0s

Cutting planes:
  Gomory: 21
  Implied bound: 23
  MIR: 46
  Flow cover: 3
  RLT: 6
  Relax-and-lift: 2

Explored 1 nodes (856 simplex iterations) in 0.15 seconds (0.07 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -138337 -138307 -135807 ... 1.32657e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.383369830765e+05, best bound -1.383502500268e+05, gap 0.0096%
  Subproblem solved in 0.18s
  Worst-case operational profit (Z_SP) = 211570.30
  Scenario: 14 demand increases, 46 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -138336.98
  [DEBUG]   S×d_nominal = 349907.29
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 349907.29 + -138336.98 = 211570.30
  [DEBUG]   Current θ from Master = 219073.56
  [DEBUG]   ⚠️  Z_SP ≤ θ by 7503.26 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 32384.72
  Lower Bound (LB) = 38407.27
  Gap (UB-LB) = 1480.7161, Absolute Gap = 1480.7161, Relative Gap = 0.037122
  Not converged yet (gap = 1480.72 > ε = 200)

  [DEBUG] Adding NEW scenario 9 to Master Problem...
  [DEBUG] New scenario pattern: 14 increases, 46 decreases
    [DEBUG] Scenario 9 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 9 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 9]
    [DEBUG]   - Total constraints in model: 154283
    [DEBUG]   - Total variables in model: 64660
  [DEBUG] Total scenarios in Master: 10
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 10
================================================================================
[Iteration 10] Solving Master Problem...
  Current scenarios in Master: 10
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 154283 rows, 64660 columns and 437889 nonzeros
Model fingerprint: 0x2a7dd65a
Variable types: 62401 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 68740 rows and 27910 columns
Presolve time: 2.29s
Presolved: 85543 rows, 36750 columns, 521739 nonzeros
Variable types: 34491 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -314147.0382
Found heuristic solution: objective -183060.7998

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.25s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.693e+06
 Factor NZ  : 8.006e+06 (roughly 110 MB of memory)
 Factor Ops : 1.394e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.58372138e+07  1.68160110e+08  1.25e+05 2.11e+01  7.85e+04     4s
   1  -1.20413475e+07  1.53491818e+08  8.79e+04 1.10e+02  5.47e+04     4s
   2  -3.74282432e+06  1.22894682e+08  2.76e+04 4.64e+00  1.82e+04     4s
   3  -1.81289647e+06  9.71118468e+07  7.83e+03 5.74e+00  5.47e+03     4s
   4  -7.79139599e+05  5.62948087e+07  9.15e+02 9.35e-01  8.87e+02     4s
   5  -6.62850644e+05  3.22587580e+07  3.75e+02 4.21e-01  4.01e+02     4s
   6  -4.30320595e+05  2.27837923e+07  2.42e+02 2.13e-01  2.61e+02     4s
   7  -2.95440418e+05  1.66616922e+07  1.01e+02 5.65e-02  1.51e+02     4s
   8  -2.18832042e+05  1.16189989e+07  6.20e+01 8.03e-12  9.74e+01     4s
   9  -1.72321511e+05  8.10705825e+06  3.94e+01 6.22e-12  6.39e+01     5s
  10  -1.28966458e+05  5.30693060e+06  2.45e+01 4.91e-12  3.99e+01     5s
  11  -8.81826746e+04  2.13690077e+06  1.10e+01 4.36e-12  1.54e+01     5s
  12  -3.24964052e+04  6.14400572e+05  2.97e+00 2.75e-12  4.25e+00     5s
  13  -1.03966954e+04  3.39403336e+05  2.14e+00 1.97e-12  2.29e+00     5s
  14   3.96672120e+03  2.61225646e+05  1.64e+00 1.48e-12  1.67e+00     5s
  15   1.98611433e+04  2.18835225e+05  1.16e+00 1.12e-12  1.29e+00     5s
  16   2.78285872e+04  1.74483549e+05  9.77e-01 5.69e-05  9.50e-01     5s
  17   3.63129034e+04  1.55654205e+05  8.05e-01 4.06e-04  7.72e-01     5s
  18   4.20739471e+04  1.25505092e+05  6.86e-01 9.72e-04  5.40e-01     5s
  19   5.28459863e+04  1.16413132e+05  4.79e-01 1.15e-03  4.11e-01     5s
  20   6.11369847e+04  1.08014134e+05  3.22e-01 2.65e-03  3.02e-01     5s
  21   6.59379078e+04  1.00359656e+05  2.34e-01 1.26e-03  2.22e-01     5s
  22   6.81631955e+04  9.58141125e+04  1.96e-01 1.13e-03  1.78e-01     6s
  23   6.96872051e+04  9.17878850e+04  1.71e-01 9.26e-04  1.43e-01     6s
  24   7.01530719e+04  8.88582072e+04  1.64e-01 1.38e-03  1.21e-01     6s
  25   7.16915978e+04  8.72400422e+04  1.42e-01 1.25e-03  1.00e-01     6s
  26   7.44542254e+04  8.59464466e+04  1.02e-01 1.90e-03  7.42e-02     6s
  27   7.48936294e+04  8.53143180e+04  9.52e-02 2.65e-03  6.73e-02     6s
  28   7.75969533e+04  8.49413550e+04  5.90e-02 3.05e-03  4.74e-02     6s
  29   7.81893970e+04  8.41027970e+04  5.13e-02 1.93e-03  3.82e-02     6s
  30   7.89041062e+04  8.37270702e+04  4.21e-02 1.28e-03  3.11e-02     6s
  31   7.93779691e+04  8.35057384e+04  3.60e-02 1.43e-03  2.66e-02     6s
  32   7.99785478e+04  8.33599239e+04  2.82e-02 1.07e-03  2.18e-02     6s
  33   8.06770085e+04  8.31819908e+04  1.92e-02 9.14e-04  1.61e-02     6s
  34   8.09816833e+04  8.30836514e+04  1.53e-02 8.04e-04  1.35e-02     6s
  35   8.11801296e+04  8.29296404e+04  1.27e-02 5.81e-04  1.13e-02     7s
  36   8.15981707e+04  8.27237166e+04  7.44e-03 5.08e-04  7.24e-03     7s
  37   8.18114476e+04  8.25638634e+04  4.84e-03 3.37e-04  4.84e-03     7s
  38   8.18779333e+04  8.24542243e+04  4.02e-03 2.26e-04  3.71e-03     7s
  39   8.19742500e+04  8.23641966e+04  2.94e-03 1.29e-04  2.51e-03     7s
  40   8.20256386e+04  8.23486950e+04  2.35e-03 1.02e-04  2.08e-03     7s
  41   8.20994736e+04  8.23145390e+04  1.51e-03 6.99e-05  1.38e-03     7s
  42   8.21204333e+04  8.22913021e+04  1.28e-03 4.81e-05  1.10e-03     7s
  43   8.22013158e+04  8.22627986e+04  3.78e-04 1.99e-05  3.95e-04     7s
  44   8.22231738e+04  8.22456028e+04  1.66e-04 6.33e-06  1.44e-04     7s
  45   8.22392059e+04  8.22425547e+04  1.33e-05 1.31e-06  2.14e-05     8s
  46   8.22410761e+04  8.22418906e+04  1.74e-06 6.00e-07  5.20e-06     8s
  47   8.22411600e+04  8.22416811e+04  1.28e-06 3.33e-07  3.33e-06     8s
  48   8.22413663e+04  8.22413951e+04  9.63e-08 1.02e-08  1.84e-07     8s
  49   8.22413864e+04  8.22413864e+04  8.13e-10 1.06e-09  1.03e-10     8s

Barrier solved model in 49 iterations and 7.93 seconds (7.17 work units)
Optimal objective 8.22413864e+04


Root crossover log...

   75210 DPushes remaining with DInf 0.0000000e+00                 8s
    2624 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                11s

    1103 PPushes remaining with PInf 6.9099077e-06                11s
       0 PPushes remaining with PInf 0.0000000e+00                11s

  Push phase complete: Pinf 0.0000000e+00, Dinf 7.8072604e-03     11s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   32318    8.2241386e+04   0.000000e+00   7.807260e-03     11s
   32319    8.2241386e+04   0.000000e+00   0.000000e+00     11s
   32319    8.2241386e+04   0.000000e+00   0.000000e+00     11s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 8.224139e+04, 32319 iterations, 7.94 seconds (9.68 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 82241.3864    0  176 -183060.80 82241.3864   145%     -   11s
H    0     0                    -177926.8407 82241.3864   146%     -   11s
H    0     0                    -167244.3384 82241.3864   149%     -   11s
H    0     0                    -163251.7002 82241.3864   150%     -   11s
H    0     0                    -162780.8521 82241.3864   151%     -   11s
H    0     0                    -138526.6307 82241.3864   159%     -   11s
H    0     0                    -137440.6645 82241.3864   160%     -   12s
H    0     0                    -73091.99948 82241.3864   213%     -   12s
H    0     0                    -73070.01177 82241.3864   213%     -   12s
H    0     0                    -19414.80381 82241.3864   524%     -   12s
H    0     0                    -6167.272031 82241.3864  1434%     -   12s
H    0     0                    15222.614241 82241.3864   440%     -   13s
H    0     0                    15413.396114 82241.3864   434%     -   13s
H    0     0                    15513.355717 82241.3864   430%     -   13s
H    0     0                    16172.539490 82241.3864   409%     -   13s
H    0     0                    16172.907033 82241.3864   409%     -   13s
H    0     0                    16306.052046 82241.3864   404%     -   13s
H    0     0                    16417.857798 82241.3864   401%     -   13s
H    0     0                    16714.480824 82241.3864   392%     -   13s
H    0     0                    22077.950514 74845.0676   239%     -   63s
H    0     0                    25190.348543 74845.0676   197%     -   63s
H    0     0                    26361.693850 74845.0676   184%     -   63s
H    0     0                    26366.020012 74845.0676   184%     -   63s
H    0     0                    26456.681193 74845.0676   183%     -   63s
H    0     0                    26719.107455 74845.0676   180%     -   63s
H    0     0                    26762.245646 74845.0676   180%     -   63s
H    0     0                    26853.171583 74845.0676   179%     -   63s
H    0     0                    27039.666730 74845.0676   177%     -   63s
     0     0 74845.0676    0  328 27039.6667 74845.0676   177%     -   63s
H    0     0                    27507.434241 74845.0166   172%     -   64s
H    0     0                    27929.911720 74845.0166   168%     -   64s
H    0     0                    28029.845806 74845.0166   167%     -   64s
H    0     0                    28098.276588 74845.0166   166%     -   64s
H    0     0                    28246.325042 74845.0166   165%     -   64s
     0     0 74016.8109    0  298 28246.3250 74016.8109   162%     -   86s
     0     0 73862.4046    0  315 28246.3250 73862.4046   161%     -   94s
     0     0 73753.8929    0  316 28246.3250 73753.8929   161%     -  101s
     0     0 73677.6890    0  316 28246.3250 73677.6890   161%     -  107s
     0     0 73677.6890    0  315 28246.3250 73677.6890   161%     -  108s
H    0     0                    28825.199020 70575.4319   145%     -  163s
H    0     0                    28902.066110 70575.4319   144%     -  163s
H    0     0                    28985.464817 70575.4319   143%     -  163s
     0     0 70401.0161    0  244 28985.4648 70401.0161   143%     -  164s
     0     0 69779.6411    0  258 28985.4648 69779.6411   141%     -  194s
     0     0 69645.1655    0  265 28985.4648 69645.1655   140%     -  207s
     0     0 69507.9535    0  273 28985.4648 69507.9535   140%     -  224s
     0     0 69347.5590    0  325 28985.4648 69347.5590   139%     -  240s
     0     0 69255.5309    0  272 28985.4648 69255.5309   139%     -  249s
     0     0 69218.9049    0  278 28985.4648 69218.9049   139%     -  255s
     0     0 69188.6682    0  281 28985.4648 69188.6682   139%     -  259s
     0     0 69182.3950    0  282 28985.4648 69182.3950   139%     -  262s
     0     0 69132.3523    0  282 28985.4648 69132.3523   139%     -  267s
     0     0 69080.5842    0  284 28985.4648 69080.5842   138%     -  273s
H    0     0                    29569.640081 69076.3197   134%     -  275s
H    0     0                    30007.047381 69076.3197   130%     -  275s
     0     0 69076.3197    0  289 30007.0474 69076.3197   130%     -  275s
     0     0 69073.1552    0  285 30007.0474 69073.1552   130%     -  278s
     0     0 69072.9793    0  285 30007.0474 69072.9793   130%     -  278s
H    0     0                    34224.084624 69072.9793   102%     -  287s
H    0     0                    36089.399892 69072.9793  91.4%     -  287s
     0     0 66739.9645    0  304 36089.3999 66739.9645  84.9%     -  321s
H    0     0                    36146.514235 66739.4873  84.6%     -  322s
H    0     0                    36612.546015 66739.4873  82.3%     -  322s
     0     0 66353.3092    0  326 36612.5460 66353.3092  81.2%     -  337s
     0     0 66174.9472    0  325 36612.5460 66174.9472  80.7%     -  351s
     0     0 66036.6947    0  329 36612.5460 66036.6947  80.4%     -  362s
H    0     0                    37911.251247 66000.6610  74.1%     -  368s
H    0     0                    37958.573761 66000.6610  73.9%     -  368s
     0     0 66000.6610    0  325 37958.5738 66000.6610  73.9%     -  368s
     0     0 65984.1929    0  326 37958.5738 65984.1929  73.8%     -  372s
     0     0 65975.5065    0  325 37958.5738 65975.5065  73.8%     -  375s
     0     0 65967.7488    0  335 37958.5738 65967.7488  73.8%     -  377s
     0     0 65962.6634    0  330 37958.5738 65962.6634  73.8%     -  378s
     0     0 65958.3598    0  340 37958.5738 65958.3598  73.8%     -  380s
     0     0 65956.3122    0  340 37958.5738 65956.3122  73.8%     -  381s
     0     0 65321.7319    0  340 37958.5738 65321.7319  72.1%     -  411s
H    0     0                    38205.359501 65320.7509  71.0%     -  415s
     0     0 65112.5994    0  348 38205.3595 65112.5994  70.4%     -  431s
     0     0 65037.7846    0  374 38205.3595 65037.7846  70.2%     -  442s
     0     0 65010.9271    0  370 38205.3595 65010.9271  70.2%     -  451s
     0     0 65002.3945    0  375 38205.3595 65002.3945  70.1%     -  453s
     0     0 64993.1582    0  376 38205.3595 64993.1582  70.1%     -  457s
     0     0 64986.5019    0  369 38205.3595 64986.5019  70.1%     -  459s
     0     0 64982.8635    0  377 38205.3595 64982.8635  70.1%     -  460s
     0     0 64982.2547    0  373 38205.3595 64982.2547  70.1%     -  462s
     0     0 64819.9047    0  382 38205.3595 64819.9047  69.7%     -  476s
H    0     0                    38210.966417 64819.5523  69.6%     -  477s
H    0     0                    38309.449373 64819.5523  69.2%     -  477s
H    0     0                    38442.076398 64819.5523  68.6%     -  477s
     0     0 64797.6625    0  356 38442.0764 64797.6625  68.6%     -  482s
     0     0 64778.0417    0  383 38442.0764 64778.0417  68.5%     -  489s
     0     0 64772.9095    0  407 38442.0764 64772.9095  68.5%     -  491s
     0     0 64770.0369    0  356 38442.0764 64770.0369  68.5%     -  493s
     0     0 64766.8004    0  407 38442.0764 64766.8004  68.5%     -  495s
     0     0 64764.0321    0  382 38442.0764 64764.0321  68.5%     -  497s
     0     0 64763.2417    0  357 38442.0764 64763.2417  68.5%     -  498s
     0     0 64678.9893    0  378 38442.0764 64678.9893  68.3%     -  507s
H    0     0                    38593.454043 64677.2636  67.6%     -  513s
H    0     0                    38628.436374 64677.2636  67.4%     -  513s
     0     0 64653.5781    0  388 38628.4364 64653.5781  67.4%     -  519s
     0     0 64649.6258    0  445 38628.4364 64649.6258  67.4%     -  522s
     0     0 64647.8333    0  441 38628.4364 64647.8333  67.4%     -  523s
     0     0 64612.3519    0  379 38628.4364 64612.3519  67.3%     -  531s
H    0     0                    38697.540949 64612.2336  67.0%     -  532s
H    0     0                    39214.096971 64612.2336  64.8%     -  532s
     0     0 64590.7245    0  391 39214.0970 64590.7245  64.7%     -  536s
     0     0 64587.2328    0  386 39214.0970 64587.2328  64.7%     -  537s
     0     0 64584.3078    0  448 39214.0970 64584.3078  64.7%     -  540s
     0     0 64583.4935    0  449 39214.0970 64583.4935  64.7%     -  541s
     0     0 64555.2116    0  389 39214.0970 64555.2116  64.6%     -  546s
     0     0 64546.2495    0  395 39214.0970 64546.2495  64.6%     -  551s
     0     0 64541.8972    0  388 39214.0970 64541.8972  64.6%     -  554s
     0     0 64540.9351    0  389 39214.0970 64540.9351  64.6%     -  555s
     0     0 64517.1925    0  385 39214.0970 64517.1925  64.5%     -  559s
     0     0 64510.3959    0  385 39214.0970 64510.3959  64.5%     -  561s
     0     0 64510.0451    0  389 39214.0970 64510.0451  64.5%     -  562s
     0     0 64496.3261    0  381 39214.0970 64496.3261  64.5%     -  567s
H    0     0                    39402.393339 64495.8514  63.7%     -  576s
H    0     0                    39419.093182 64495.8514  63.6%     -  580s
H    0     0                    39613.117958 64495.8514  62.8%     -  580s
     0     0 64489.3537    0  395 39613.1180 64489.3537  62.8%     -  584s
     0     0 64486.7751    0  401 39613.1180 64486.7751  62.8%     -  586s
     0     0 64468.5797    0  443 39613.1180 64468.5797  62.7%     -  594s
     0     0 64468.4909    0  443 39613.1180 64468.4909  62.7%     -  597s
     0     2 64468.3130    0  443 39613.1180 64468.3130  62.7%     -  719s
     1     3 64120.4102    1  408 39613.1180 64468.3130  62.7%  7653  731s
     2     4 64254.0773    1  377 39613.1180 64254.0773  62.2%  5274  741s
     3     6 63899.3619    2  363 39613.1180 64247.7592  62.2%  5958  755s
     5    11 63375.6821    3  410 39613.1180 64247.7592  62.2%  6589  773s
    10    21 62994.7147    4  413 39613.1180 63897.5645  61.3%  7454  806s
    20    31 62966.4226    5  396 39613.1180 63611.3744  60.6% 13167  850s
    30    61 62080.5487    6  420 39613.1180 63502.0911  60.3% 13041  959s
    60    93 61838.5496    7  408 39613.1180 63502.0911  60.3% 17392  998s
H   64    93                    39945.631612 63502.0911  59.0% 16570  998s
H   79    93                    40006.276927 63502.0911  58.7% 15362  998s
    92   185 61819.0810    8  427 40006.2769 63502.0911  58.7% 14923 1128s
   184   313 61444.3331   11  401 40006.2769 63502.0911  58.7% 10620 1170s
   312   344 61088.4005   16  388 40006.2769 63502.0911  58.7%  7886 1193s
   343   377 60895.9829   17  363 40006.2769 63502.0911  58.7%  7698 1216s
   376   413 60849.3666   18  363 40006.2769 63502.0911  58.7%  7470 1236s
   412   447 60462.1529   19  369 40006.2769 63502.0911  58.7%  7223 1260s
   446   480 60324.9142   20  369 40006.2769 63502.0911  58.7%  7138 1285s
H  456   480                    40038.736039 63502.0911  58.6%  7064 1285s
   479   574 60323.2136   21  338 40038.7360 63502.0911  58.6%  7073 1316s
   573   655 59989.5336   22  299 40038.7360 63502.0911  58.6%  6580 1342s
   654   720 59202.7826   23  283 40038.7360 63502.0911  58.6%  6429 1363s
   719   785 59115.9491   24  276 40038.7360 63502.0911  58.6%  6470 1384s
   784   845 59027.8753   26  281 40038.7360 63502.0911  58.6%  6494 1405s
   844   901 58900.9274   34  263 40038.7360 63502.0911  58.6%  6533 1428s
   900   975 58644.4525   28  272 40038.7360 63502.0911  58.6%  6588 1450s
   974  1053 58290.1559   30  277 40038.7360 63502.0911  58.6%  6603 1473s
  1052  1128 58036.0795   32  280 40038.7360 63502.0911  58.6%  6598 1497s
  1127  1229 57784.5954   33  274 40038.7360 63502.0911  58.6%  6633 1519s
  1228  1327 57144.4617   35  282 40038.7360 63502.0911  58.6%  6514 1543s
  1326  1431 56751.5466   37  269 40038.7360 63502.0911  58.6%  6430 1568s
  1430  1562 55797.4472   39  258 40038.7360 63502.0911  58.6%  6339 1593s
  1561  1593 54956.1050   42  253 40038.7360 63502.0911  58.6%  6202 1616s
  1592  1628 54855.3454   43  282 40038.7360 63502.0911  58.6%  6216 1640s
  1627  1661 54711.9394   44  333 40038.7360 63502.0911  58.6%  6237 1660s
  1660  1713 54663.7782   45  326 40038.7360 63502.0911  58.6%  6231 1682s
  1712  1809 54463.3722   46  328 40038.7360 63502.0911  58.6%  6203 1706s
  1810  1966 53208.5206   49  322 40038.7360 63502.0911  58.6%  6094 1734s
  1987  2085 49844.6112   53  316 40038.7360 63502.0911  58.6%  5864 1768s
  2163  2199 46042.9913   57  271 40038.7360 63502.0911  58.6%  5711 1802s
  2346  2231 43532.9622   68  218 40038.7360 63502.0911  58.6%  5625 1829s
  2378  2259 42887.6205   69  254 40038.7360 63502.0911  58.6%  5682 1859s
  2412  2321 42860.2792   70  222 40038.7360 63502.0911  58.6%  5727 1891s
  2500  2365 infeasible   78      40038.7360 63502.0911  58.6%  5718 1925s
  2554  2434 infeasible   78      40038.7360 63098.1884  57.6%  5772 1960s
  2665  2487 59785.9547    8  378 40038.7360 63098.1884  57.6%  5789 2003s
  2752  2559 59422.0670    9  359 40038.7360 63098.1884  57.6%  5788 2046s
  2830  2634 58515.5844   11  346 40038.7360 63098.1884  57.6%  5934 2086s
  2929  2702 57166.7017   13  321 40038.7360 63098.1884  57.6%  6013 2133s
  3029  2817 54748.0396   14  275 40038.7360 63098.1884  57.6%  6108 2182s
  3158  2934 51453.6825   18  276 40038.7360 63098.1884  57.6%  6201 2230s
  3301  3062 47877.4940   21  255 40038.7360 63098.1884  57.6%  6239 2283s
  3476  3063 43591.0378  148  443 40038.7360 63098.1884  57.6%  6276 2419s
  3478  3064 56584.5604   61  175 40038.7360 63098.1884  57.6%  6272 2432s
  3479  3065 59461.0097    7  300 40038.7360 63098.1884  57.6%  6270 2498s
  3480  3066 61152.6509   32  344 40038.7360 63098.1884  57.6%  6269 2562s
  3481  3066 44860.9631   29  343 40038.7360 63098.1884  57.6%  6267 2603s
  3482  3067 47259.2789   25  346 40038.7360 63098.1884  57.6%  6265 2649s
  3483  3068 43868.5214   33  403 40038.7360 63098.1884  57.6%  6263 2671s
  3484  3068 59523.6942   14  340 40038.7360 63098.1884  57.6%  6261 2681s
  3485  3069 59572.6009   24  370 40038.7360 63098.1884  57.6%  6260 2695s
  3486  3070 41219.8686   24  382 40038.7360 63098.1884  57.6%  6258 2704s
  3487  3070 59461.0097    7  398 40038.7360 63098.1884  57.6%  6256 2715s
  3488  3071 58917.8815   14  389 40038.7360 63098.1884  57.6%  6254 2720s
  3489  3072 45597.8693   35  419 40038.7360 63098.1884  57.6%  6253 2728s
  3490  3072 50748.4473   91  384 40038.7360 63098.1884  57.6%  6251 2732s
  3491  3073 59196.8994    8  431 40038.7360 63098.1884  57.6%  6249 2736s
  3493  3074 44634.3655  138  466 40038.7360 63098.1884  57.6%  6245 2757s
  3494  3075 59109.6004   12  450 40038.7360 63098.1884  57.6%  6244 2762s
  3495  3076 59233.4646   32  448 40038.7360 63098.1884  57.6%  6242 2765s
  3497  3077 53034.8101   71  436 40038.7360 63098.1884  57.6%  6238 2773s
  3498  3078 43214.7143   39  432 40038.7360 63098.1884  57.6%  6236 2787s
  3499  3078 60253.2924   17  456 40038.7360 63098.1884  57.6%  6235 2791s
  3500  3079 44872.9569  171  468 40038.7360 63098.1884  57.6%  6233 2795s
  3502  3080 41375.5085   76  399 40038.7360 63098.1884  57.6%  6229 2812s
  3503  3081 41195.8217   39  406 40038.7360 63098.1884  57.6%  6228 2817s
  3504  3082 50265.2131   26  435 40038.7360 63098.1884  57.6%  6226 2821s
  3505  3082 41364.8495   27  414 40038.7360 63098.1884  57.6%  6224 2825s
  3506  3083 42774.1629   76  477 40038.7360 63098.1884  57.6%  6222 2836s
  3507  3084 59421.8180   20  474 40038.7360 63098.1884  57.6%  6220 2843s
  3508  3084 58442.0531   28  477 40038.7360 63098.1884  57.6%  6219 2847s
  3509  3085 60057.8975   13  467 40038.7360 63098.1884  57.6%  6217 2870s
  3510  3086 58684.8616   33  494 40038.7360 63098.1884  57.6%  6215 2877s
  3511  3086 54440.4867   68  482 40038.7360 63098.1884  57.6%  6213 2883s
  3512  3087 49243.9794   26  458 40038.7360 63098.1884  57.6%  6212 2888s
  3513  3088 58345.8245   31  484 40038.7360 63098.1884  57.6%  6210 2903s
  3514  3088 59969.3945   31  439 40038.7360 63098.1884  57.6%  6208 2912s
  3515  3089 55248.3132   63  487 40038.7360 63098.1884  57.6%  6206 2918s
  3516  3090 58339.0080   25  462 40038.7360 63098.1884  57.6%  6205 2924s
  3517  3090 48905.4211   30  454 40038.7360 63098.1884  57.6%  6203 2942s
  3518  3091 58328.4783   13  503 40038.7360 63098.1884  57.6%  6201 2948s
  3519  3092 45905.1686   21  505 40038.7360 63098.1884  57.6%  6199 2954s
  3520  3092 52507.0552   24  504 40038.7360 63098.1884  57.6%  6197 2968s
  3521  3093 54771.4335   53  469 40038.7360 63098.1884  57.6%  6196 2974s
  3522  3094 46322.1226   26  509 40038.7360 63098.1884  57.6%  6194 2979s
  3523  3094 59714.5586   14  386 40038.7360 63098.1884  57.6%  6192 2984s
  3524  3095 61382.6103    9  461 40038.7360 63098.1884  57.6%  6190 3000s
  3525  3096 46705.9707   36  464 40038.7360 63098.1884  57.6%  6189 3011s
  3526  3096 58283.0725   25  492 40038.7360 63098.1884  57.6%  6187 3025s
  3527  3097 48038.3344   30  493 40038.7360 63098.1884  57.6%  6185 3030s
  3528  3098 42395.3021  140  501 40038.7360 63098.1884  57.6%  6183 3064s
  3529  3098 59205.5184   11  427 40038.7360 63098.1884  57.6%  6182 3071s
  3530  3099 50513.0368  105  507 40038.7360 63098.1884  57.6%  6180 3080s
  3532  3100 53872.6733   90  506 40038.7360 63098.1884  57.6%  6176 3097s
  3533  3101 59128.2103   17  506 40038.7360 63098.1884  57.6%  6175 3125s
  3534  3102 54186.2611   78  506 40038.7360 63098.1884  57.6%  6173 3296s
  3535  3104 62674.5384   10  439 40038.7360 63098.1884  57.6%  6280 3359s
  3536  3105 63098.1884   10  510 40038.7360 63098.1884  57.6%  6280 3394s
  3537  3109 62010.0804   11  386 40038.7360 63098.1884  57.6%  6283 3457s
  3541  3115 61109.1030   12  344 40038.7360 62996.2464  57.3%  6286 3577s
  3549  3116 61476.9087   13  417 40038.7360 62735.7318  56.7%  6308 3600s

Cutting planes:
  Gomory: 35
  Implied bound: 45
  Projected implied bound: 295
  MIR: 1124
  Mixing: 6
  Flow cover: 1204
  RLT: 44
  Relax-and-lift: 255

Explored 3552 nodes (22808312 simplex iterations) in 3600.09 seconds (5940.19 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 40038.7 40006.3 39945.6 ... 38593.5

Time limit reached
Best objective 4.003873603915e+04, best bound 6.273572922858e+04, gap 56.6876%
  WARNING: Time limit reached. Using best solution found (gap: 56.69%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.13s
  Master Objective (UB) = 40038.74, θ = 229307.02
  Upper Bound (UB) = 40038.74

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 229307.02
  [DEBUG]   ✓ Scenario 0: θ = 229307.02 ≤ Q = 229307.02 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 229307.02 ≤ Q = 229307.02 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 229307.02 ≤ Q = 229307.02 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 229307.02 ≤ Q = 229307.02 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 229307.02 ≤ Q = 229307.02 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 229307.02 ≤ Q = 229307.02 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 229307.02 ≤ Q = 229307.02 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 229307.02 ≤ Q = 229307.02 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 229307.02 ≤ Q = 229307.02 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 229307.02 ≤ Q = 229307.02 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 10] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x52631013
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xad9cefed
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.408157e+13
Presolve removed 2585 rows and 1875 columns
Presolve time: 0.01s
Presolved: 508 rows, 514 columns, 1439 nonzeros
Found heuristic solution: objective 6807485.0332
Variable types: 350 continuous, 164 integer (164 binary)

Root relaxation: objective -1.761712e+05, 264 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -176171.16    0  132 6807485.03 -176171.16   103%     -    0s
H    0     0                    -137984.9955 -176171.16  27.7%     -    0s
H    0     0                    -138219.1233 -176171.16  27.5%     -    0s
H    0     0                    -141889.4244 -176171.16  24.2%     -    0s
H    0     0                    -159963.0035 -176171.16  10.1%     -    0s
H    0     0                    -159992.7251 -176171.16  10.1%     -    0s
     0     0 -163520.79    0   68 -159992.73 -163520.79  2.21%     -    0s
H    0     0                    -161149.6694 -163501.85  1.46%     -    0s
H    0     0                    -161466.6888 -163501.85  1.26%     -    0s
H    0     0                    -161792.9028 -163501.85  1.06%     -    0s
H    0     0                    -162109.9222 -163501.85  0.86%     -    0s
     0     0 -162490.43    0   64 -162109.92 -162490.43  0.23%     -    0s
     0     0 -162418.24    0   32 -162109.92 -162418.24  0.19%     -    0s
     0     0 -162388.26    0   23 -162109.92 -162388.26  0.17%     -    0s
     0     0 -162384.54    0   22 -162109.92 -162384.54  0.17%     -    0s
     0     0 -162384.19    0   22 -162109.92 -162384.19  0.17%     -    0s
     0     0 -162193.59    0    4 -162109.92 -162193.59  0.05%     -    0s
     0     0 -162193.59    0    9 -162109.92 -162193.59  0.05%     -    0s
H    0     0                    -162163.4478 -162193.59  0.02%     -    0s
     0     0          -    0      -162163.45 -162171.72  0.01%     -    0s

Cutting planes:
  Gomory: 3
  Implied bound: 4
  MIR: 6
  Flow cover: 6

Explored 1 nodes (620 simplex iterations) in 0.15 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -162163 -162110 -162017 ... -137985

Optimal solution found (tolerance 1.00e-04)
Best objective -1.621634477630e+05, best bound -1.621717161302e+05, gap 0.0051%
  Subproblem solved in 0.19s
  Worst-case operational profit (Z_SP) = 209283.75
  Scenario: 30 demand increases, 30 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -162163.45
  [DEBUG]   S×d_nominal = 371447.20
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 371447.20 + -162163.45 = 209283.75
  [DEBUG]   Current θ from Master = 229307.02
  [DEBUG]   ⚠️  Z_SP ≤ θ by 20023.27 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 20015.46
  Lower Bound (LB) = 38407.27
  Gap (UB-LB) = 1631.4660, Absolute Gap = 1631.4660, Relative Gap = 0.040747
  Not converged yet (gap = 1631.47 > ε = 200)

  [DEBUG] Adding NEW scenario 10 to Master Problem...
  [DEBUG] New scenario pattern: 30 increases, 30 decreases
    [DEBUG] Scenario 10 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 10 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 10]
    [DEBUG]   - Total constraints in model: 169573
    [DEBUG]   - Total variables in model: 70900
  [DEBUG] Total scenarios in Master: 11
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 11
================================================================================
[Iteration 11] Solving Master Problem...
  Current scenarios in Master: 11
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 169573 rows, 70900 columns and 481126 nonzeros
Model fingerprint: 0xcae89904
Variable types: 68641 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 75628 rows and 30708 columns
Presolve time: 3.27s
Presolved: 93945 rows, 40192 columns, 569557 nonzeros
Variable types: 37933 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -325702.3089
Found heuristic solution: objective -183060.7998

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.29s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 4.229e+06
 Factor NZ  : 9.287e+06 (roughly 130 MB of memory)
 Factor Ops : 1.720e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.63804058e+07  1.83078028e+08  1.29e+05 2.02e+01  8.08e+04     5s
   1  -1.24693818e+07  1.68391014e+08  9.10e+04 1.10e+02  5.63e+04     5s
   2  -3.87631281e+06  1.34887345e+08  2.87e+04 5.86e+00  1.88e+04     5s
   3  -2.14920028e+06  1.31949535e+08  1.09e+04 3.33e+01  7.63e+03     5s
   4  -8.94340904e+05  7.86952782e+07  2.26e+03 8.25e-01  1.79e+03     5s
   5  -5.91869276e+05  5.05520074e+07  6.43e+02 3.56e-01  6.46e+02     5s
   6  -4.37161705e+05  3.09532534e+07  3.27e+02 1.24e-01  3.42e+02     5s
   7  -3.17993301e+05  2.42028988e+07  1.43e+02 1.34e-03  2.08e+02     6s
   8  -2.66899785e+05  1.54756381e+07  3.59e+01 1.04e-11  1.05e+02     6s
   9  -2.04700198e+05  1.18328042e+07  2.50e+01 7.83e-12  7.79e+01     6s
  10  -1.42682233e+05  8.28924890e+06  1.52e+01 1.03e-11  5.27e+01     6s
  11  -9.47608347e+04  3.22270944e+06  7.73e+00 4.29e-12  2.02e+01     6s
  12  -3.09777614e+04  1.04475752e+06  2.44e+00 2.45e-12  6.36e+00     6s
  13  -8.74812409e+03  4.83774797e+05  1.58e+00 1.33e-12  2.90e+00     6s
  14   4.90607096e+03  3.03747319e+05  1.20e+00 1.47e-12  1.76e+00     6s
  15   1.67244869e+04  2.41026576e+05  8.90e-01 1.34e-03  1.31e+00     6s
  16   2.75316355e+04  1.96245344e+05  6.69e-01 1.29e-03  9.87e-01     6s
  17   3.25456794e+04  1.79622497e+05  5.95e-01 9.75e-04  8.60e-01     6s
  18   4.26693780e+04  1.38342974e+05  4.57e-01 1.75e-03  5.60e-01     6s
  19   5.53068546e+04  1.21938775e+05  2.91e-01 1.52e-03  3.89e-01     6s
  20   5.92343530e+04  1.12707978e+05  2.45e-01 2.02e-03  3.12e-01     6s
  21   6.46137298e+04  1.01871436e+05  1.79e-01 1.50e-03  2.18e-01     7s
  22   6.92964342e+04  9.84618886e+04  1.25e-01 1.22e-03  1.70e-01     7s
  23   7.09745644e+04  9.36259297e+04  1.05e-01 9.35e-04  1.32e-01     7s
  24   7.35215803e+04  9.10784965e+04  7.86e-02 1.16e-03  1.02e-01     7s
  25   7.45518257e+04  8.84050942e+04  6.82e-02 1.11e-03  8.09e-02     7s
  26   7.57208746e+04  8.74432322e+04  5.59e-02 1.15e-03  6.84e-02     7s
  27   7.66172740e+04  8.66990603e+04  4.69e-02 9.97e-04  5.88e-02     7s
  28   7.78858506e+04  8.52205348e+04  3.49e-02 7.70e-04  4.28e-02     7s
  29   7.83799570e+04  8.42469093e+04  3.04e-02 9.77e-04  3.43e-02     7s
  30   7.88023911e+04  8.37402734e+04  2.66e-02 8.21e-04  2.88e-02     7s
  31   7.95335041e+04  8.33736637e+04  2.01e-02 8.01e-04  2.24e-02     7s
  32   8.01321293e+04  8.30983035e+04  1.49e-02 6.85e-04  1.73e-02     7s
  33   8.05676385e+04  8.27658384e+04  1.11e-02 6.26e-04  1.28e-02     7s
  34   8.08143858e+04  8.25691557e+04  9.06e-03 4.47e-04  1.02e-02     7s
  35   8.11375517e+04  8.23922437e+04  6.48e-03 3.13e-04  7.32e-03     8s
  36   8.13669442e+04  8.22551477e+04  4.61e-03 2.08e-04  5.18e-03     8s
  37   8.14480375e+04  8.21616863e+04  3.95e-03 1.43e-04  4.17e-03     8s
  38   8.16254712e+04  8.20847015e+04  2.50e-03 8.97e-05  2.68e-03     8s
  39   8.16491674e+04  8.20636646e+04  2.32e-03 7.49e-05  2.42e-03     8s
  40   8.18110949e+04  8.20299935e+04  1.09e-03 5.06e-05  1.28e-03     8s
  41   8.18686201e+04  8.19995253e+04  6.55e-04 2.84e-05  7.64e-04     8s
  42   8.18860246e+04  8.19773290e+04  5.20e-04 1.28e-05  5.33e-04     8s
  43   8.19161666e+04  8.19681300e+04  2.77e-04 7.22e-06  3.03e-04     8s
  44   8.19445000e+04  8.19619105e+04  7.07e-05 3.50e-06  1.01e-04     8s
  45   8.19475944e+04  8.19588183e+04  4.87e-05 2.35e-06  6.55e-05     9s
  46   8.19544385e+04  8.19561337e+04  3.99e-06 5.00e-07  9.86e-06     9s
  47   8.19553512e+04  8.19554335e+04  7.78e-08 1.46e-07  4.78e-07     9s
  48   8.19553906e+04  8.19553906e+04  1.59e-10 7.76e-09  7.85e-11     9s

Barrier solved model in 48 iterations and 8.76 seconds (7.99 work units)
Optimal objective 8.19553906e+04


Root crossover log...

   81856 DPushes remaining with DInf 0.0000000e+00                 9s
    9495 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                11s

    1371 PPushes remaining with PInf 7.2616745e-06                11s
       0 PPushes remaining with PInf 0.0000000e+00                11s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.3170798e-10     11s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   32458    8.1955391e+04   0.000000e+00   0.000000e+00     11s
   32458    8.1955391e+04   0.000000e+00   0.000000e+00     11s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 8.195539e+04, 32458 iterations, 7.41 seconds (9.42 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 81955.3906    0  197 -183060.80 81955.3906   145%     -   11s
H    0     0                    -180310.9124 81955.3906   145%     -   11s
H    0     0                    -147999.8174 81955.3906   155%     -   12s
H    0     0                    -138434.5317 81955.3906   159%     -   12s
H    0     0                    -122107.8524 81955.3906   167%     -   12s
H    0     0                    -77400.84787 81955.3906   206%     -   13s
H    0     0                    19780.326157 81955.3906   314%     -   13s
H    0     0                    21110.257136 81955.3906   288%     -   13s
H    0     0                    23309.814319 81955.3906   252%     -   13s
H    0     0                    23347.838169 81955.3906   251%     -   13s
H    0     0                    25733.834171 81955.3906   218%     -   13s
H    0     0                    25741.081296 81955.3538   218%     -   15s
H    0     0                    25749.871883 81955.3538   218%     -   15s
H    0     0                    27704.392250 75426.7977   172%     -   54s
H    0     0                    28512.729554 75426.7977   165%     -   54s
H    0     0                    29383.217829 75426.7977   157%     -   54s
H    0     0                    29870.385575 75426.7977   153%     -   54s
H    0     0                    29967.801904 75426.7977   152%     -   54s
     0     0 75426.7977    0  289 29967.8019 75426.7977   152%     -   54s
     0     0 74600.9004    0  329 29967.8019 74600.9004   149%     -   84s
     0     0 74585.0355    0  325 29967.8019 74585.0355   149%     -   92s
     0     0 74530.8894    0  321 29967.8019 74530.8894   149%     -  100s
     0     0 74530.2887    0  321 29967.8019 74530.2887   149%     -  103s
H    0     0                    30861.596896 70597.3895   129%     -  171s
     0     0 70597.3895    0  383 30861.5969 70597.3895   129%     -  172s
H    0     0                    31809.017988 70597.3614   122%     -  172s
H    0     0                    31951.024618 70597.3614   121%     -  172s
H    0     0                    32601.950318 70597.3614   117%     -  172s
H    0     0                    32954.515326 70597.3614   114%     -  172s
H    0     0                    32959.443476 70597.3614   114%     -  172s
H    0     0                    35239.639805 70597.3614   100%     -  172s
     0     0 70109.6502    0  416 35239.6398 70109.6502  99.0%     -  204s
H    0     0                    35534.890439 70035.6527  97.1%     -  224s
H    0     0                    36358.440470 70035.6527  92.6%     -  224s
H    0     0                    37114.974069 70035.6527  88.7%     -  224s
H    0     0                    37261.104276 70035.6527  88.0%     -  224s
H    0     0                    37374.074314 70035.6527  87.4%     -  224s
     0     0 70035.6527    0  430 37374.0743 70035.6527  87.4%     -  224s
     0     0 69956.8410    0  403 37374.0743 69956.8410  87.2%     -  244s
     0     0 69915.0682    0  416 37374.0743 69915.0682  87.1%     -  253s
     0     0 69869.1937    0  427 37374.0743 69869.1937  86.9%     -  269s
     0     0 69833.4915    0  413 37374.0743 69833.4915  86.9%     -  279s
     0     0 69822.6373    0  415 37374.0743 69822.6373  86.8%     -  287s
     0     0 69777.6075    0  407 37374.0743 69777.6075  86.7%     -  298s
     0     0 69767.8604    0  400 37374.0743 69767.8604  86.7%     -  302s
     0     0 69767.1353    0  404 37374.0743 69767.1353  86.7%     -  304s
     0     0 67355.2864    0  335 37374.0743 67355.2864  80.2%     -  383s
     0     0 66876.6124    0  439 37374.0743 66876.6124  78.9%     -  426s
     0     0 66697.9371    0  448 37374.0743 66697.9371  78.5%     -  447s
     0     0 66609.6013    0  470 37374.0743 66609.6013  78.2%     -  472s
     0     0 66540.7154    0  468 37374.0743 66540.7154  78.0%     -  485s
     0     0 66464.9739    0  466 37374.0743 66464.9739  77.8%     -  499s
H    0     0                    39397.391906 66446.0384  68.7%     -  511s
     0     0 66446.0384    0  472 39397.3919 66446.0384  68.7%     -  511s
     0     0 66429.9387    0  468 39397.3919 66429.9387  68.6%     -  518s
     0     0 66417.0169    0  469 39397.3919 66417.0169  68.6%     -  523s
     0     0 66398.3470    0  480 39397.3919 66398.3470  68.5%     -  531s
     0     0 66390.6871    0  488 39397.3919 66390.6871  68.5%     -  534s
     0     0 66377.4796    0  486 39397.3919 66377.4796  68.5%     -  538s
     0     0 66361.9230    0  478 39397.3919 66361.9230  68.4%     -  543s
     0     0 66356.7414    0  481 39397.3919 66356.7414  68.4%     -  546s
     0     0 66354.1227    0  484 39397.3919 66354.1227  68.4%     -  548s
     0     0 66352.7765    0  484 39397.3919 66352.7765  68.4%     -  550s
     0     0 65524.1106    0  351 39397.3919 65524.1106  66.3%     -  600s
H    0     0                    39608.116526 65524.0084  65.4%     -  600s
     0     0 65261.6383    0  352 39608.1165 65261.6383  64.8%     -  626s
     0     0 65172.5638    0  454 39608.1165 65172.5638  64.5%     -  642s
     0     0 65114.2523    0  485 39608.1165 65114.2523  64.4%     -  654s
     0     0 65071.8160    0  477 39608.1165 65071.8160  64.3%     -  664s
     0     0 65055.7120    0  473 39608.1165 65055.7120  64.2%     -  669s
     0     0 65047.4763    0  433 39608.1165 65047.4763  64.2%     -  674s
     0     0 65043.0646    0  490 39608.1165 65043.0646  64.2%     -  677s
     0     0 65035.6127    0  424 39608.1165 65035.6127  64.2%     -  681s
     0     0 65023.6558    0  427 39608.1165 65023.6558  64.2%     -  687s
     0     0 65015.0406    0  415 39608.1165 65015.0406  64.1%     -  690s
     0     0 65013.9191    0  431 39608.1165 65013.9191  64.1%     -  691s
     0     0 64913.2658    0  461 39608.1165 64913.2658  63.9%     -  708s
     0     0 64881.0516    0  469 39608.1165 64881.0516  63.8%     -  719s
     0     0 64867.2845    0  493 39608.1165 64867.2845  63.8%     -  726s
     0     0 64848.9147    0  436 39608.1165 64848.9147  63.7%     -  734s
     0     0 64845.8937    0  454 39608.1165 64845.8937  63.7%     -  737s
     0     0 64841.0742    0  466 39608.1165 64841.0742  63.7%     -  740s
     0     0 64837.5316    0  452 39608.1165 64837.5316  63.7%     -  743s
     0     0 64836.3246    0  455 39608.1165 64836.3246  63.7%     -  745s
     0     0 64786.6185    0  460 39608.1165 64786.6185  63.6%     -  759s
     0     0 64772.7523    0  452 39608.1165 64772.7523  63.5%     -  774s
     0     0 64765.0849    0  455 39608.1165 64765.0849  63.5%     -  778s
     0     0 64763.8734    0  449 39608.1165 64763.8734  63.5%     -  781s
     0     0 64726.3827    0  481 39608.1165 64726.3827  63.4%     -  794s
     0     0 64712.2592    0  460 39608.1165 64712.2592  63.4%     -  801s
     0     0 64707.6091    0  401 39608.1165 64707.6091  63.4%     -  804s
     0     0 64706.3188    0  477 39608.1165 64706.3188  63.4%     -  807s
     0     0 64693.2825    0  473 39608.1165 64693.2825  63.3%     -  817s
H    0     0                    39677.933205 64693.2301  63.0%     -  820s
     0     0 64685.1630    0  475 39677.9332 64685.1630  63.0%     -  827s
     0     0 64676.7404    0  482 39677.9332 64676.7404  63.0%     -  833s
     0     0 64672.2352    0  479 39677.9332 64672.2352  63.0%     -  838s
     0     0 64670.4289    0  490 39677.9332 64670.4289  63.0%     -  841s
     0     0 64648.8411    0  466 39677.9332 64648.8411  62.9%     -  851s
     0     0 64641.5301    0  458 39677.9332 64641.5301  62.9%     -  855s
     0     0 64639.9567    0  461 39677.9332 64639.9567  62.9%     -  859s
     0     0 64622.8608    0  428 39677.9332 64622.8608  62.9%     -  866s
     0     0 64592.7363    0  406 39677.9332 64592.7363  62.8%     -  873s
     0     0 64581.4025    0  382 39677.9332 64581.4025  62.8%     -  877s
     0     0 64576.9763    0  378 39677.9332 64576.9763  62.8%     -  880s
     0     0 64575.7575    0  365 39677.9332 64575.7575  62.7%     -  882s
     0     0 64537.1465    0  393 39677.9332 64537.1465  62.7%     -  894s
     0     0 64528.9289    0  473 39677.9332 64528.9289  62.6%     -  901s
     0     0 64527.4758    0  476 39677.9332 64527.4758  62.6%     -  904s
     0     0 64516.2783    0  496 39677.9332 64516.2783  62.6%     -  911s
     0     0 64508.1846    0  382 39677.9332 64508.1846  62.6%     -  922s
     0     0 64497.5420    0  475 39677.9332 64497.5420  62.6%     -  926s
     0     0 64495.5909    0  479 39677.9332 64495.5909  62.5%     -  928s
     0     0 64463.9617    0  481 39677.9332 64463.9617  62.5%     -  938s
     0     0 64455.6373    0  481 39677.9332 64455.6373  62.4%     -  945s
     0     0 64451.4307    0  491 39677.9332 64451.4307  62.4%     -  951s
     0     0 64450.7148    0  418 39677.9332 64450.7148  62.4%     -  953s
     0     0 64441.6985    0  446 39677.9332 64441.6985  62.4%     -  959s
H    0     0                    39719.427416 64441.6963  62.2%     - 1057s
     0     0 64439.3634    0  430 39719.4274 64439.3634  62.2%     - 1081s
     0     0 64430.0499    0  438 39719.4274 64430.0499  62.2%     - 1087s
     0     0 64429.9335    0  438 39719.4274 64429.9335  62.2%     - 1090s
     0     2 64429.3242    0  438 39719.4274 64429.3242  62.2%     - 1241s
     1     4 64386.0024    1  489 39719.4274 64423.6961  62.2%  3507 1254s
     3     7 64314.5121    2  433 39719.4274 64385.9645  62.1%  6269 1277s
     6    12 64277.2152    3  408 39719.4274 64314.3842  61.9%  8028 1316s
    11    20 64032.9051    4  442 39719.4274 64314.3842  61.9% 10938 1365s
    19    28 62624.7208    4  464 39719.4274 64277.1552  61.8% 17982 1432s
    27    51 60785.1257    5  468 39719.4274 64032.8235  61.2% 16119 1686s
    50    83 60505.7180    6  481 39719.4274 64032.8235  61.2% 22518 1737s
    82   149 60453.0045    7  478 39719.4274 64032.8235  61.2% 22303 1833s
   148   183 58645.5892    9  253 39719.4274 64032.8235  61.2% 15657 1880s
   182   215 58645.2820   10  249 39719.4274 64032.8235  61.2% 13884 1920s
   214   266 58336.5838   11  239 39719.4274 64032.8235  61.2% 12528 1967s
   265   324 58327.1573   12  245 39719.4274 64032.8235  61.2% 10760 2018s
   323   382 58237.1692   13  250 39719.4274 64032.8235  61.2%  9628 2066s
   381   440 57981.8977   14  241 39719.4274 64032.8235  61.2%  8933 2114s
   439   511 57874.2734   15  241 39719.4274 64032.8235  61.2%  8451 2159s
   510   585 57639.8211   16  238 39719.4274 64032.8235  61.2%  7920 2199s
   586   648 57528.7854   17  233 39719.4274 64032.8235  61.2%  7443 2238s
   649   717 57026.1212   18  215 39719.4274 64032.8235  61.2%  7142 2277s
   718   796 55857.4640   19  205 39719.4274 64032.8235  61.2%  6762 2309s
   797   866 55784.6057   20  196 39719.4274 64032.8235  61.2%  6369 2339s
   869   936 55750.1082   21  194 39719.4274 64032.8235  61.2%  6083 2372s
   947  1029 55703.2980   22  195 39719.4274 64032.8235  61.2%  5805 2411s
  1040  1118 54821.2736   28  190 39719.4274 64032.8235  61.2%  5533 2446s
  1131  1208 53782.6193   35  165 39719.4274 64032.8235  61.2%  5344 2482s
  1227  1312 50998.9426   39  168 39719.4274 64032.8235  61.2%  5179 2521s
  1335  1433 45289.8643   47  155 39719.4274 64032.8235  61.2%  4959 2564s
  1474  1528 42984.6197   55  137 39719.4274 64032.8235  61.2%  4687 2602s
  1599  1655 42155.7512   65  142 39719.4274 64032.8235  61.2%  4485 2643s
  1748  1748     cutoff   90      39719.4274 63807.2089  60.6%  4282 2686s
  1886  1873 63755.2326    6  365 39719.4274 63807.1241  60.6%  4168 2732s
  2033  1959 63413.2346    9  506 39719.4274 63807.1241  60.6%  4057 2785s
  2160  2056 62825.4173   10  437 39719.4274 63807.1241  60.6%  4011 2837s
  2287  2171 62506.2931   12  394 39719.4274 63807.1241  60.6%  3985 2890s
  2420  2305 60425.4976   13  420 39719.4274 63807.1241  60.6%  3947 2946s
  2566  2442 60010.7488   14  401 39719.4274 63807.1241  60.6%  3896 3002s
  2721  2553 59059.4424   16  398 39719.4274 63807.1241  60.6%  3851 3062s
  2846  2677 58145.9980   18  383 39719.4274 63807.1241  60.6%  3864 3124s
  2994  2744 57652.4622   20  358 39719.4274 63807.1241  60.6%  3867 3207s
  3087  2964 55134.0009   21  277 39719.4274 63754.6820  60.5%  3847 3275s
  3329  2965 43651.6613   69  438 39719.4274 63754.6820  60.5%  3747 3590s

Explored 3330 nodes (13101151 simplex iterations) in 3600.12 seconds (5076.96 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 39719.4 39677.9 39608.1 ... 35239.6

Time limit reached
Best objective 3.971942741634e+04, best bound 6.375468202936e+04, gap 60.5126%
  WARNING: Time limit reached. Using best solution found (gap: 60.51%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.23s
  Master Objective (UB) = 39719.43, θ = 228676.39
  Upper Bound (UB) = 39719.43

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 228676.39
  [DEBUG]   ✓ Scenario 0: θ = 228676.39 ≤ Q = 228676.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 228676.39 ≤ Q = 228676.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 228676.39 ≤ Q = 228676.39 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 228676.39 ≤ Q = 228676.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 228676.39 ≤ Q = 228676.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 228676.39 ≤ Q = 228676.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 228676.39 ≤ Q = 228676.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 228676.39 ≤ Q = 228676.39 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 228676.39 ≤ Q = 228676.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 228676.39 ≤ Q = 228676.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 228676.39 ≤ Q = 228676.39 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 11] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x5762b70b
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xa89d48f5
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.408157e+13
Presolve removed 2585 rows and 1875 columns
Presolve time: 0.01s
Presolved: 508 rows, 514 columns, 1439 nonzeros
Found heuristic solution: objective 6831413.4935
Variable types: 350 continuous, 164 integer (164 binary)

Root relaxation: objective -1.744686e+05, 265 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -174468.57    0  133 6831413.49 -174468.57   103%     -    0s
H    0     0                    -138578.3095 -174468.57  25.9%     -    0s
H    0     0                    -139710.9372 -174468.57  24.9%     -    0s
H    0     0                    -142863.6761 -155259.17  8.68%     -    0s
H    0     0                    -151154.9800 -155259.17  2.72%     -    0s
H    0     0                    -154355.1641 -155259.17  0.59%     -    0s
     0     0 -155259.17    0   42 -154355.16 -155259.17  0.59%     -    0s
H    0     0                    -154625.0839 -155251.37  0.41%     -    0s
     0     0 -155127.69    0   36 -154625.08 -155127.69  0.33%     -    0s
     0     0 -155124.10    0   35 -154625.08 -155124.10  0.32%     -    0s
     0     0 -155119.20    0   40 -154625.08 -155119.20  0.32%     -    0s
     0     0 -154925.09    0    6 -154625.08 -154925.09  0.19%     -    0s
     0     0 -154925.09    0   16 -154625.08 -154925.09  0.19%     -    0s
H    0     0                    -154846.8438 -154925.09  0.05%     -    0s
     0     0 -154881.59    0    2 -154846.84 -154881.59  0.02%     -    0s
H    0     0                    -154880.3376 -154880.34  0.00%     -    0s

Cutting planes:
  Gomory: 3
  Implied bound: 1
  MIR: 5
  Flow cover: 9
  RLT: 1
  Relax-and-lift: 7

Explored 1 nodes (604 simplex iterations) in 0.11 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -154880 -154847 -154625 ... -138578
No other solutions better than -154880

Optimal solution found (tolerance 1.00e-04)
Best objective -1.548803375795e+05, best bound -1.548803375795e+05, gap 0.0000%
  Subproblem solved in 0.14s
  Worst-case operational profit (Z_SP) = 216566.86
  Scenario: 14 demand increases, 46 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -154880.34
  [DEBUG]   S×d_nominal = 371447.20
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 371447.20 + -154880.34 = 216566.86
  [DEBUG]   Current θ from Master = 228676.39
  [DEBUG]   ⚠️  Z_SP ≤ θ by 12109.53 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 27609.90
  Lower Bound (LB) = 38407.27
  Gap (UB-LB) = 1312.1573, Absolute Gap = 1312.1573, Relative Gap = 0.033036
  Not converged yet (gap = 1312.16 > ε = 200)

  [DEBUG] Adding NEW scenario 11 to Master Problem...
  [DEBUG] New scenario pattern: 14 increases, 46 decreases
    [DEBUG] Scenario 11 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 11 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 11]
    [DEBUG]   - Total constraints in model: 184863
    [DEBUG]   - Total variables in model: 77140
  [DEBUG] Total scenarios in Master: 12
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 12
================================================================================
[Iteration 12] Solving Master Problem...
  Current scenarios in Master: 12
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 184863 rows, 77140 columns and 524363 nonzeros
Model fingerprint: 0x871e7cf5
Variable types: 74881 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 82516 rows and 33506 columns
Presolve time: 3.49s
Presolved: 102347 rows, 43634 columns, 618947 nonzeros
Variable types: 41375 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -327140.1202
Found heuristic solution: objective -183060.7998

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.29s

Barrier statistics:
 Dense cols : 674
 AA' NZ     : 3.347e+06
 Factor NZ  : 8.129e+06 (roughly 130 MB of memory)
 Factor Ops : 1.589e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.68686539e+07  1.97354682e+08  1.33e+05 1.94e+01  8.27e+04     5s
   1  -1.29954248e+07  1.82423111e+08  9.44e+04 1.09e+02  5.79e+04     5s
   2  -6.53338683e+06  1.43922735e+08  4.58e+04 1.64e+01  2.93e+04     5s
   3  -1.50910278e+06  1.08647475e+08  6.78e+03 1.58e+00  4.73e+03     6s
   4  -6.46975835e+05  6.09921818e+07  8.38e+02 3.23e-01  7.99e+02     6s
   5  -4.75294692e+05  3.31570162e+07  3.93e+02 1.52e-01  3.75e+02     6s
   6  -3.67649920e+05  2.59231613e+07  1.90e+02 1.11e-01  2.29e+02     6s
   7  -3.00801830e+05  1.99722167e+07  8.44e+01 8.17e-02  1.44e+02     6s
   8  -1.91831459e+05  1.28002520e+07  3.42e+01 4.73e-02  8.09e+01     6s
   9  -1.26417508e+05  6.74171302e+06  2.00e+01 2.26e-02  4.11e+01     6s
  10  -8.76084525e+04  4.51176563e+06  1.13e+01 1.45e-02  2.63e+01     6s
  11  -5.10060584e+04  2.59352994e+06  3.88e+00 7.95e-03  1.45e+01     6s
  12  -1.87570025e+04  7.60122891e+05  1.64e+00 2.29e-03  4.21e+00     6s
  13  -1.03109692e+03  4.13251860e+05  1.22e+00 1.21e-03  2.23e+00     6s
  14   1.46265874e+04  2.69067550e+05  7.79e-01 1.35e-03  1.37e+00     7s
  15   2.41259692e+04  2.15151088e+05  5.83e-01 1.26e-03  1.03e+00     7s
  16   3.68675913e+04  1.73289324e+05  4.03e-01 1.32e-03  7.32e-01     7s
  17   4.30737322e+04  1.43249403e+05  3.37e-01 1.44e-03  5.37e-01     7s
  18   5.12295564e+04  1.22885007e+05  2.62e-01 2.61e-03  3.84e-01     7s
  19   5.82013870e+04  1.07640579e+05  1.95e-01 2.23e-03  2.65e-01     7s
  20   6.27735065e+04  1.03424736e+05  1.55e-01 2.88e-03  2.18e-01     7s
  21   6.61750052e+04  9.66543156e+04  1.25e-01 2.94e-03  1.63e-01     7s
  22   7.10989985e+04  9.32278938e+04  8.18e-02 2.67e-03  1.19e-01     7s
  23   7.21174557e+04  9.06980494e+04  7.24e-02 1.99e-03  9.95e-02     8s
  24   7.45299499e+04  8.87491730e+04  5.27e-02 1.74e-03  7.62e-02     8s
  25   7.59452031e+04  8.67166139e+04  4.16e-02 1.26e-03  5.77e-02     8s
  26   7.67858065e+04  8.60188924e+04  3.52e-02 1.18e-03  4.94e-02     8s
  27   7.78889349e+04  8.52153916e+04  2.75e-02 1.64e-03  3.92e-02     8s
  28   7.83153225e+04  8.42526936e+04  2.43e-02 1.41e-03  3.18e-02     8s
  29   7.93832764e+04  8.39242678e+04  1.68e-02 1.26e-03  2.43e-02     8s
  30   8.00229700e+04  8.33805777e+04  1.24e-02 8.87e-04  1.80e-02     8s
  31   8.04963930e+04  8.28608285e+04  9.21e-03 5.83e-04  1.27e-02     8s
  32   8.09419151e+04  8.25555509e+04  6.28e-03 3.88e-04  8.64e-03     9s
  33   8.13922041e+04  8.23597377e+04  3.37e-03 2.93e-04  5.18e-03     9s
  34   8.15307986e+04  8.22033699e+04  2.53e-03 1.71e-04  3.60e-03     9s
  35   8.15698557e+04  8.21740368e+04  2.29e-03 1.49e-04  3.24e-03     9s
  36   8.16818067e+04  8.21045548e+04  1.65e-03 9.62e-05  2.26e-03     9s
  37   8.17405568e+04  8.20405827e+04  1.30e-03 4.61e-05  1.61e-03     9s
  38   8.18960658e+04  8.20367223e+04  4.22e-04 4.31e-05  7.53e-04     9s
  39   8.19520732e+04  8.19916146e+04  1.01e-04 1.28e-05  2.11e-04    10s
  40   8.19657782e+04  8.19812740e+04  2.57e-05 5.96e-06  8.28e-05    10s
  41   8.19695857e+04  8.19730384e+04  9.06e-06 1.38e-06  1.85e-05    10s
  42   8.19715589e+04  8.19726770e+04  2.15e-06 7.55e-07  5.97e-06    10s
  43   8.19721427e+04  8.19723094e+04  1.58e-07 1.52e-07  8.90e-07    10s
  44   8.19722051e+04  8.19722099e+04  6.73e-09 4.95e-09  2.61e-08    10s
  45   8.19722087e+04  8.19722087e+04  1.52e-10 1.79e-11  2.61e-11    10s

Barrier solved model in 45 iterations and 10.33 seconds (8.16 work units)
Optimal objective 8.19722087e+04


Root crossover log...

   89242 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                13s

    1430 PPushes remaining with PInf 1.2486387e-06                14s
       0 PPushes remaining with PInf 0.0000000e+00                14s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.1398809e-10     14s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   34169    8.1972209e+04   0.000000e+00   0.000000e+00     14s
   34169    8.1972209e+04   0.000000e+00   0.000000e+00     14s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 8.197221e+04, 34169 iterations, 9.50 seconds (10.36 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 81972.2087    0  185 -183060.80 81972.2087   145%     -   14s
H    0     0                    -180310.9124 81972.2087   145%     -   14s
H    0     0                    -114377.5126 81972.2087   172%     -   14s
H    0     0                    -105317.1491 81972.2087   178%     -   14s
H    0     0                    -103540.0593 81972.2087   179%     -   15s
H    0     0                    -70278.64523 81972.2087   217%     -   15s
H    0     0                    15940.937869 81972.2087   414%     -   15s
H    0     0                    24903.817947 81972.2087   229%     -   15s
H    0     0                    29756.134210 81972.2087   175%     -   16s
H    0     0                    30070.693949 81972.2087   173%     -   16s
H    0     0                    30097.549344 81972.2087   172%     -   16s
H    0     0                    30173.572750 81972.2087   172%     -   16s
H    0     0                    30199.195181 81972.2087   171%     -   16s
H    0     0                    30215.886537 81972.2087   171%     -   16s
H    0     0                    30355.309714 76351.8580   152%     -   68s
H    0     0                    31195.102951 76351.8580   145%     -   68s
     0     0 76351.8580    0  297 31195.1030 76351.8580   145%     -   68s
H    0     0                    31234.388652 76351.8394   144%     -   70s
     0     0 75851.7738    0  300 31234.3887 75851.7738   143%     -   95s
     0     0 75746.3448    0  326 31234.3887 75746.3448   143%     -  108s
     0     0 75746.3422    0  318 31234.3887 75746.3422   143%     -  116s
     0     0 75746.3422    0  318 31234.3887 75746.3422   143%     -  119s
H    0     0                    31447.292995 71729.7421   128%     -  218s
H    0     0                    31471.223027 71729.7421   128%     -  218s
H    0     0                    31478.775298 71729.7421   128%     -  218s
     0     0 71728.5695    0  268 31478.7753 71728.5695   128%     -  218s
H    0     0                    31973.191712 71728.5695   124%     -  219s
H    0     0                    32670.108948 70794.5436   117%     -  282s
H    0     0                    32861.983844 70794.5436   115%     -  282s
H    0     0                    32894.199803 70794.5436   115%     -  282s
H    0     0                    32903.501678 70794.5436   115%     -  282s
H    0     0                    32986.571160 70794.5436   115%     -  282s
     0     0 70794.5436    0  399 32986.5712 70794.5436   115%     -  283s
     0     0 70501.6895    0  408 32986.5712 70501.6895   114%     -  316s
     0     0 70423.4619    0  420 32986.5712 70423.4619   113%     -  330s
     0     0 70285.5706    0  427 32986.5712 70285.5706   113%     -  358s
     0     0 70265.1206    0  429 32986.5712 70265.1206   113%     -  369s
H    0     0                    35499.888612 70259.0466  97.9%     -  373s
H    0     0                    35812.599324 70259.0466  96.2%     -  373s
     0     0 70259.0466    0  460 35812.5993 70259.0466  96.2%     -  373s
H    0     0                    36018.774746 70236.5169  95.0%     -  380s
H    0     0                    36086.892277 70236.5169  94.6%     -  380s
     0     0 70236.5169    0  410 36086.8923 70236.5169  94.6%     -  381s
     0     0 70202.0991    0  413 36086.8923 70202.0991  94.5%     -  386s
     0     0 70169.8173    0  426 36086.8923 70169.8173  94.4%     -  394s
     0     0 70157.3576    0  420 36086.8923 70157.3576  94.4%     -  398s
     0     0 70154.6574    0  407 36086.8923 70154.6574  94.4%     -  399s
     0     0 70154.4288    0  408 36086.8923 70154.4288  94.4%     -  400s
     0     0 67541.4912    0  345 36086.8923 67541.4912  87.2%     -  498s
     0     0 66964.2551    0  437 36086.8923 66964.2551  85.6%     -  552s
     0     0 66658.4747    0  476 36086.8923 66658.4747  84.7%     -  583s
     0     0 66522.2231    0  491 36086.8923 66522.2231  84.3%     -  606s
     0     0 66443.3875    0  364 36086.8923 66443.3875  84.1%     -  621s
H    0     0                    36371.171197 66416.7153  82.6%     -  634s
     0     0 66416.7153    0  372 36371.1712 66416.7153  82.6%     -  634s
     0     0 66249.1529    0  447 36371.1712 66249.1529  82.1%     -  655s
     0     0 66190.8345    0  501 36371.1712 66190.8345  82.0%     -  668s
     0     0 66169.6786    0  492 36371.1712 66169.6786  81.9%     -  678s
     0     0 66148.8451    0  511 36371.1712 66148.8451  81.9%     -  686s
     0     0 66146.6436    0  483 36371.1712 66146.6436  81.9%     -  690s
H    0     0                    36437.824788 65491.1272  79.7%     -  747s
H    0     0                    36463.221947 65491.1272  79.6%     -  747s
H    0     0                    36516.891677 65491.1272  79.3%     -  747s
     0     0 65491.1272    0  482 36516.8917 65491.1272  79.3%     -  748s
H    0     0                    36561.070051 65301.3192  78.6%     -  778s
     0     0 65301.3192    0  383 36561.0701 65301.3192  78.6%     -  778s
     0     0 65235.3394    0  385 36561.0701 65235.3394  78.4%     -  792s
     0     0 65163.9040    0  459 36561.0701 65163.9040  78.2%     -  809s
     0     0 65110.8933    0  461 36561.0701 65110.8933  78.1%     -  823s
     0     0 65082.2108    0  455 36561.0701 65082.2108  78.0%     -  831s
H    0     0                    37938.393063 65071.6586  71.5%     -  838s
H    0     0                    38750.811805 65071.6586  67.9%     -  838s
     0     0 65071.6586    0  465 38750.8118 65071.6586  67.9%     -  838s
H    0     0                    38815.483977 65067.9829  67.6%     -  844s
     0     0 65067.9829    0  466 38815.4840 65067.9829  67.6%     -  844s
     0     0 65064.7823    0  472 38815.4840 65064.7823  67.6%     -  850s
     0     0 65051.5965    0  470 38815.4840 65051.5965  67.6%     -  856s
     0     0 65041.4094    0  473 38815.4840 65041.4094  67.6%     -  862s
     0     0 65038.3746    0  472 38815.4840 65038.3746  67.6%     -  868s
     0     0 65036.4401    0  464 38815.4840 65036.4401  67.6%     -  871s
     0     0 64919.3191    0  496 38815.4840 64919.3191  67.3%     -  894s
     0     0 64870.2731    0  470 38815.4840 64870.2731  67.1%     -  912s
     0     0 64847.0210    0  503 38815.4840 64847.0210  67.1%     -  921s
     0     0 64836.2010    0  475 38815.4840 64836.2010  67.0%     -  926s
     0     0 64831.2392    0  501 38815.4840 64831.2392  67.0%     -  929s
     0     0 64829.2753    0  506 38815.4840 64829.2753  67.0%     -  933s
     0     0 64716.9306    0  416 38815.4840 64716.9306  66.7%     -  959s
     0     0 64689.9741    0  519 38815.4840 64689.9741  66.7%     -  972s
     0     0 64686.5053    0  527 38815.4840 64686.5053  66.7%     -  977s
     0     0 64680.7453    0  534 38815.4840 64680.7453  66.6%     -  983s
     0     0 64674.8804    0  515 38815.4840 64674.8804  66.6%     -  989s
     0     0 64669.9289    0  546 38815.4840 64669.9289  66.6%     -  996s
     0     0 64668.0857    0  502 38815.4840 64668.0857  66.6%     - 1001s
H    0     0                    38848.236551 64593.0552  66.3%     - 1018s
     0     0 64593.0552    0  406 38848.2366 64593.0552  66.3%     - 1018s
     0     0 64559.7157    0  405 38848.2366 64559.7157  66.2%     - 1031s
     0     0 64555.1796    0  403 38848.2366 64555.1796  66.2%     - 1036s
     0     0 64551.1773    0  412 38848.2366 64551.1773  66.2%     - 1040s
     0     0 64549.2733    0  406 38848.2366 64549.2733  66.2%     - 1043s
     0     0 64521.8702    0  390 38848.2366 64521.8702  66.1%     - 1053s
     0     0 64508.4751    0  513 38848.2366 64508.4751  66.1%     - 1062s
     0     0 64501.8347    0  522 38848.2366 64501.8347  66.0%     - 1067s
     0     0 64487.1942    0  518 38848.2366 64487.1942  66.0%     - 1074s
     0     0 64485.0812    0  530 38848.2366 64485.0812  66.0%     - 1078s
     0     0 64469.0951    0  510 38848.2366 64469.0951  66.0%     - 1088s
H    0     0                    38894.769844 64468.9680  65.8%     - 1089s
H    0     0                    38999.839960 64468.9680  65.3%     - 1089s
H    0     0                    39015.154316 64468.9680  65.2%     - 1089s
     0     0 64464.8358    0  506 39015.1543 64464.8358  65.2%     - 1095s
     0     0 64464.0737    0  440 39015.1543 64464.0737  65.2%     - 1097s
     0     0 64460.1173    0  513 39015.1543 64460.1173  65.2%     - 1102s
H    0     0                    39100.759363 64460.0301  64.9%     - 1107s
     0     0 64458.0149    0  504 39100.7594 64458.0149  64.9%     - 1111s
     0     0 64452.7690    0  442 39100.7594 64452.7690  64.8%     - 1117s
     0     0 64451.8858    0  404 39100.7594 64451.8858  64.8%     - 1119s
     0     0 64450.0330    0  375 39100.7594 64450.0330  64.8%     - 1124s
     0     0 64403.2667    0  375 39100.7594 64403.2667  64.7%     - 1155s
     0     0 64346.3269    0  418 39100.7594 64346.3269  64.6%     - 1168s
     0     0 64344.3361    0  415 39100.7594 64344.3361  64.6%     - 1170s
     0     0 64332.8250    0  414 39100.7594 64332.8250  64.5%     - 1179s
     0     0 64331.4155    0  384 39100.7594 64331.4155  64.5%     - 1182s
     0     0 64307.9913    0  386 39100.7594 64307.9913  64.5%     - 1192s
H    0     0                    39103.342997 64307.9274  64.5%     - 1219s
H    0     0                    39166.483681 64307.9274  64.2%     - 1227s
H    0     0                    39192.735680 64307.9274  64.1%     - 1229s
     0     0 64306.1009    0  387 39192.7357 64306.1009  64.1%     - 1232s
     0     0 64294.7573    0  377 39192.7357 64294.7573  64.0%     - 1237s
     0     0 64294.7355    0  377 39192.7357 64294.7355  64.0%     - 1240s
     0     2 64294.7355    0  377 39192.7357 64294.7355  64.0%     - 1447s
     1     4 64200.3790    1  360 39192.7357 64294.6545  64.0%  3250 1514s
     3     7 63954.2598    2  360 39192.7357 64200.2233  63.8% 13375 1567s
     6    11 63434.1756    3  367 39192.7357 63953.3610  63.2% 14826 1699s
    10    21 61674.5771    4  404 39192.7357 63953.3610  63.2% 22399 1770s
    20    31 60500.8306    4  359 39192.7357 63615.2201  62.3% 29290 2815s
    30    61 59608.6530    5  349 39192.7357 63615.2201  62.3% 30040 3388s
H   34    61                    39204.780189 63615.2201  62.3% 29206 3388s
H   37    61                    39222.497674 63615.2201  62.2% 28456 3388s
    60    93 59424.8757    6  325 39222.4977 63615.2201  62.2% 32970 3437s
    92   176 59420.4532    7  324 39222.4977 63615.2201  62.2% 25679 3600s

Cutting planes:
  Learned: 1
  Gomory: 12
  Implied bound: 109
  MIR: 2768
  Flow cover: 2462
  RLT: 105
  Relax-and-lift: 714
  PSD: 1

Explored 175 nodes (3568330 simplex iterations) in 3600.16 seconds (4090.51 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 39222.5 39204.8 39192.7 ... 38848.2

Time limit reached
Best objective 3.922249767422e+04, best bound 6.361522013433e+04, gap 62.1906%
  WARNING: Time limit reached. Using best solution found (gap: 62.19%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.18s
  Master Objective (UB) = 39222.50, θ = 214523.26
  Upper Bound (UB) = 39222.50

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 214523.26
  [DEBUG]   ✓ Scenario 0: θ = 214523.26 ≤ Q = 214523.26 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 214523.26 ≤ Q = 214523.26 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 214523.26 ≤ Q = 214523.26 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 214523.26 ≤ Q = 214523.26 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 214523.26 ≤ Q = 214523.26 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 214523.26 ≤ Q = 214523.26 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 214523.26 ≤ Q = 214523.26 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 214523.26 ≤ Q = 214523.26 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 214523.26 ≤ Q = 214523.26 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 214523.26 ≤ Q = 214523.26 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 214523.26 ≤ Q = 214523.26 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 214523.26 ≤ Q = 214523.26 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 12] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x3d74cabc
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xc28b3544
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.344419e+13
Presolve removed 2593 rows and 1883 columns
Presolve time: 0.01s
Presolved: 500 rows, 506 columns, 1416 nonzeros
Found heuristic solution: objective 6438844.6235
Variable types: 343 continuous, 163 integer (163 binary)
Found heuristic solution: objective 6438450.6200

Root relaxation: objective -1.680995e+05, 256 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -168099.51    0  127 6438450.62 -168099.51   103%     -    0s
H    0     0                    -133116.3371 -168099.51  26.3%     -    0s
H    0     0                    -136790.3433 -168099.51  22.9%     -    0s
H    0     0                    -137476.1147 -168099.51  22.3%     -    0s
     0     0 -146065.08    0   64 -137476.11 -146065.08  6.25%     -    0s
H    0     0                    -141263.2674 -145959.69  3.32%     -    0s
     0     0 -145871.89    0   52 -141263.27 -145871.89  3.26%     -    0s
     0     0 -145869.20    0   53 -141263.27 -145869.20  3.26%     -    0s
H    0     0                    -144281.8745 -145869.20  1.10%     -    0s
H    0     0                    -144914.0168 -145869.20  0.66%     -    0s
     0     0 -145536.02    0   49 -144914.02 -145536.02  0.43%     -    0s
H    0     0                    -144990.1437 -145516.13  0.36%     -    0s
     0     0 -145516.13    0   49 -144990.14 -145516.13  0.36%     -    0s
     0     0 -145434.90    0   45 -144990.14 -145434.90  0.31%     -    0s
     0     0 -145431.09    0   45 -144990.14 -145431.09  0.30%     -    0s
H    0     0                    -145004.0066 -145408.07  0.28%     -    0s
     0     0 -145408.07    0   88 -145004.01 -145408.07  0.28%     -    0s
     0     0 -145281.17    0   37 -145004.01 -145281.17  0.19%     -    0s
     0     0 -145264.68    0   31 -145004.01 -145264.68  0.18%     -    0s
     0     0 -145263.43    0   30 -145004.01 -145263.43  0.18%     -    0s
     0     0 -145245.73    0   36 -145004.01 -145245.73  0.17%     -    0s
     0     0 -145243.93    0   33 -145004.01 -145243.93  0.17%     -    0s
     0     0 -145110.11    0   22 -145004.01 -145110.11  0.07%     -    0s
     0     0 -145110.11    0   19 -145004.01 -145110.11  0.07%     -    0s
     0     0 -145072.32    0   12 -145004.01 -145072.32  0.05%     -    0s
     0     0 -145072.32    0   19 -145004.01 -145072.32  0.05%     -    0s
H    0     0                    -145027.4387 -145072.32  0.03%     -    0s
     0     0          -    0      -145027.44 -145041.77  0.01%     -    0s

Cutting planes:
  Gomory: 5
  Implied bound: 6
  MIR: 11
  Flow cover: 5
  Relax-and-lift: 1

Explored 1 nodes (1047 simplex iterations) in 0.18 seconds (0.06 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -145027 -145004 -144990 ... 6.43884e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.450274387373e+05, best bound -1.450417727503e+05, gap 0.0099%
  Subproblem solved in 0.21s
  Worst-case operational profit (Z_SP) = 206219.66
  Scenario: 18 demand increases, 42 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -145027.44
  [DEBUG]   S×d_nominal = 351247.10
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 351247.10 + -145027.44 = 206219.66
  [DEBUG]   Current θ from Master = 214523.26
  [DEBUG]   ⚠️  Z_SP ≤ θ by 8303.60 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 30918.90
  Lower Bound (LB) = 38407.27
  Gap (UB-LB) = 815.2276, Absolute Gap = 815.2276, Relative Gap = 0.020785
  Not converged yet (gap = 815.23 > ε = 200)

  [DEBUG] Adding NEW scenario 12 to Master Problem...
  [DEBUG] New scenario pattern: 18 increases, 42 decreases
    [DEBUG] Scenario 12 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 12 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 12]
    [DEBUG]   - Total constraints in model: 200153
    [DEBUG]   - Total variables in model: 83380
  [DEBUG] Total scenarios in Master: 13
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 13
================================================================================
[Iteration 13] Solving Master Problem...
  Current scenarios in Master: 13
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 200153 rows, 83380 columns and 567600 nonzeros
Model fingerprint: 0x067e7873
Variable types: 81121 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 89404 rows and 36304 columns
Presolve time: 3.55s
Presolved: 110749 rows, 47076 columns, 667769 nonzeros
Variable types: 44817 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -325718.8223
Found heuristic solution: objective -183060.7998

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.34s

Barrier statistics:
 Dense cols : 667
 AA' NZ     : 3.799e+06
 Factor NZ  : 9.938e+06 (roughly 140 MB of memory)
 Factor Ops : 2.865e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.73011745e+07  2.11271391e+08  1.36e+05 1.87e+01  8.44e+04     6s
   1  -1.34124206e+07  1.96327853e+08  9.71e+04 1.09e+02  5.91e+04     6s
   2  -5.68477174e+06  1.55667459e+08  4.11e+04 1.94e+01  2.62e+04     6s
   3  -1.44460559e+06  1.20920998e+08  5.29e+03 8.67e-01  3.83e+03     6s
   4  -7.57022269e+05  6.19235443e+07  6.77e+02 2.03e-01  6.82e+02     6s
   5  -6.75577694e+05  4.64583925e+07  2.94e+02 1.44e-01  3.85e+02     6s
   6  -3.76646655e+05  3.04812999e+07  1.69e+02 8.47e-02  2.30e+02     6s
   7  -3.36759036e+05  2.32081753e+07  1.06e+02 6.10e-02  1.60e+02     6s
   8  -2.13574982e+05  1.62208322e+07  2.49e+01 4.10e-02  8.97e+01     6s
   9  -1.56763698e+05  8.95069659e+06  1.22e+01 2.31e-02  4.79e+01     6s
  10  -1.09087852e+05  6.09653338e+06  7.82e+00 1.52e-02  3.20e+01     6s
  11  -8.06385342e+04  4.56138006e+06  5.16e+00 1.12e-02  2.36e+01     7s
  12  -6.25229979e+04  3.58155503e+06  3.36e+00 8.79e-03  1.83e+01     7s
  13  -2.32371995e+04  1.58632025e+06  1.32e+00 3.64e-03  8.01e+00     7s
  14   2.41202820e+03  5.72831000e+05  5.91e-01 1.43e-03  2.83e+00     7s
  15   1.33105978e+04  3.34732417e+05  4.03e-01 8.54e-04  1.59e+00     7s
  16   2.65433018e+04  2.42639517e+05  2.62e-01 1.02e-03  1.07e+00     7s
  17   3.99974602e+04  1.62380921e+05  1.76e-01 2.05e-03  6.05e-01     7s
  18   5.11114574e+04  1.44420938e+05  1.17e-01 1.47e-03  4.61e-01     7s
  19   5.58423838e+04  1.31205035e+05  9.70e-02 1.40e-03  3.72e-01     7s
  20   6.02234161e+04  1.22776048e+05  7.86e-02 1.16e-03  3.09e-01     7s
  21   6.41052680e+04  1.12924328e+05  6.34e-02 2.28e-03  2.41e-01     7s
  22   6.95938562e+04  1.03593003e+05  4.30e-02 2.54e-03  1.68e-01     7s
  23   7.10154059e+04  9.49869122e+04  3.72e-02 2.16e-03  1.18e-01     8s
  24   7.29854039e+04  9.25805352e+04  3.01e-02 1.75e-03  9.68e-02     8s
  25   7.45754482e+04  9.05931721e+04  2.47e-02 1.41e-03  7.91e-02     8s
  26   7.62745507e+04  8.92480506e+04  1.91e-02 1.17e-03  6.41e-02     8s
  27   7.70577892e+04  8.74850466e+04  1.66e-02 8.93e-04  5.15e-02     8s
  28   7.79766609e+04  8.67439164e+04  1.38e-02 7.46e-04  4.33e-02     8s
  29   7.87067116e+04  8.51990012e+04  1.17e-02 4.80e-04  3.21e-02     8s
  30   7.96287806e+04  8.50068200e+04  9.02e-03 4.41e-04  2.66e-02     8s
  31   8.02699277e+04  8.43733217e+04  7.17e-03 3.08e-04  2.03e-02     9s
  32   8.08557635e+04  8.39518474e+04  5.52e-03 2.55e-04  1.53e-02     9s
  33   8.13400415e+04  8.37125415e+04  4.18e-03 1.91e-04  1.17e-02     9s
  34   8.17917288e+04  8.34946118e+04  2.94e-03 1.44e-04  8.42e-03     9s
  35   8.22230203e+04  8.33432874e+04  1.78e-03 1.07e-04  5.54e-03     9s
  36   8.23702161e+04  8.30869854e+04  1.40e-03 7.81e-05  3.54e-03     9s
  37   8.25381482e+04  8.30665513e+04  9.60e-04 6.83e-05  2.61e-03     9s
  38   8.26811786e+04  8.30486156e+04  6.11e-04 5.92e-05  1.82e-03     9s
  39   8.27821808e+04  8.29975956e+04  3.50e-04 1.59e-05  1.06e-03    10s
  40   8.28610060e+04  8.29797609e+04  1.59e-04 2.61e-05  5.87e-04    10s
  41   8.29183942e+04  8.29416821e+04  2.88e-05 5.08e-06  1.15e-04    10s
  42   8.29299626e+04  8.29350738e+04  5.68e-06 1.18e-06  2.52e-05    10s
  43   8.29318842e+04  8.29339922e+04  1.91e-06 5.56e-07  1.04e-05    10s
  44   8.29326801e+04  8.29331031e+04  5.46e-07 4.27e-08  2.09e-06    10s
  45   8.29330124e+04  8.29330265e+04  2.10e-08 8.24e-10  6.97e-08    10s
  46   8.29330201e+04  8.29330243e+04  1.46e-07 2.74e-10  2.09e-08    10s
  47   8.29330238e+04  8.29330243e+04  3.37e-07 2.70e-09  2.55e-09    11s

Barrier solved model in 47 iterations and 10.55 seconds (9.59 work units)
Optimal objective 8.29330238e+04


Root crossover log...

   96508 DPushes remaining with DInf 0.0000000e+00                11s
     622 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                15s

   20230 PPushes remaining with PInf 6.4386754e-05                15s
       0 PPushes remaining with PInf 0.0000000e+00                17s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.3050743e+04     17s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   64903    8.2933024e+04   0.000000e+00   1.305074e+04     17s
   65415    8.2933024e+04   0.000000e+00   0.000000e+00     17s
   65415    8.2933024e+04   0.000000e+00   0.000000e+00     18s
Concurrent spin time: 1.94s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 8.293302e+04, 65415 iterations, 15.02 seconds (18.86 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 82933.0243    0  194 -183060.80 82933.0243   145%     -   20s
H    0     0                    -178761.2066 82933.0243   146%     -   20s
H    0     0                    -163811.6215 82933.0243   151%     -   21s
H    0     0                    -137540.5000 82933.0243   160%     -   21s
H    0     0                    -134714.2445 82933.0243   162%     -   21s
H    0     0                    -134122.2809 82933.0243   162%     -   22s
H    0     0                    -133997.9444 82933.0243   162%     -   22s
H    0     0                    -57690.94726 82933.0243   244%     -   22s
H    0     0                    -57419.11984 82933.0243   244%     -   22s
H    0     0                    11160.712807 82933.0243   643%     -   22s
H    0     0                    21379.744386 82933.0243   288%     -   23s
H    0     0                    22523.879683 82933.0243   268%     -   23s
H    0     0                    28138.259325 82933.0243   195%     -   25s
H    0     0                    28176.509025 82933.0243   194%     -   25s
H    0     0                    31804.617011 82933.0243   161%     -   25s
H    0     0                    31829.951212 82933.0243   161%     -   25s
     0     0 76834.3183    0  313 31829.9512 76834.3183   141%     -   83s
H    0     0                    31834.141488 76834.3183   141%     -   84s
H    0     0                    32413.181704 76834.3183   137%     -   84s
     0     0 76222.3431    0  324 32413.1817 76222.3431   135%     -  121s
     0     0 76091.2316    0  323 32413.1817 76091.2316   135%     -  128s
     0     0 76088.3988    0  315 32413.1817 76088.3988   135%     -  131s
     0     0 76088.3988    0  319 32413.1817 76088.3988   135%     -  133s
     0     0 76063.7382    0  331 32413.1817 76063.7382   135%     -  141s
     0     0 76058.9673    0  319 32413.1817 76058.9673   135%     -  143s
     0     0 76057.2357    0  326 32413.1817 76057.2357   135%     -  144s
     0     0 76057.0240    0  324 32413.1817 76057.0240   135%     -  145s
     0     0 71888.2407    0  225 32413.1817 71888.2407   122%     -  261s
H    0     0                    35178.997780 71888.2407   104%     -  263s
H    0     0                    35219.593090 71888.2407   104%     -  263s
H    0     0                    35313.241460 71888.2407   104%     -  263s
H    0     0                    35404.740920 71888.2407   103%     -  263s
     0     0 70787.4782    0  425 35404.7409 70787.4782   100%     -  359s
     0     0 70429.2186    0  414 35404.7409 70429.2186  98.9%     -  408s
     0     0 70064.2329    0  414 35404.7409 70064.2329  97.9%     -  454s
     0     0 69766.9592    0  421 35404.7409 69766.9592  97.1%     -  477s
     0     0 69677.6130    0  419 35404.7409 69677.6130  96.8%     -  496s
     0     0 69640.6774    0  428 35404.7409 69640.6774  96.7%     -  509s
     0     0 69615.3103    0  440 35404.7409 69615.3103  96.6%     -  517s
     0     0 69607.4258    0  438 35404.7409 69607.4258  96.6%     -  521s
     0     0 69605.6124    0  437 35404.7409 69605.6124  96.6%     -  523s
     0     0 69604.8802    0  439 35404.7409 69604.8802  96.6%     -  524s
H    0     0                    35411.189509 66981.1506  89.2%     -  630s
H    0     0                    35798.777798 66981.1506  87.1%     -  630s
H    0     0                    36889.766028 66981.1506  81.6%     -  630s
     0     0 66981.1506    0  396 36889.7660 66981.1506  81.6%     -  630s
H    0     0                    36931.370640 66981.0527  81.4%     -  631s
H    0     0                    37020.322675 66456.0330  79.5%     -  679s
H    0     0                    37341.104997 66456.0330  78.0%     -  679s
H    0     0                    37341.181446 66456.0330  78.0%     -  679s
H    0     0                    37549.773561 66456.0330  77.0%     -  679s
H    0     0                    37566.166830 66456.0330  76.9%     -  679s
     0     0 66456.0330    0  355 37566.1668 66456.0330  76.9%     -  680s
     0     0 66369.2868    0  345 37566.1668 66369.2868  76.7%     -  695s
H    0     0                    37657.607590 66248.4475  75.9%     -  715s
     0     0 66248.4475    0  364 37657.6076 66248.4475  75.9%     -  715s
     0     0 66212.5709    0  370 37657.6076 66212.5709  75.8%     -  726s
     0     0 66193.4668    0  361 37657.6076 66193.4668  75.8%     -  734s
H    0     0                    37684.205103 66180.0790  75.6%     -  742s
H    0     0                    37844.618080 66180.0790  74.9%     -  742s
H    0     0                    37954.746243 66180.0790  74.4%     -  742s
H    0     0                    37977.346958 66180.0790  74.3%     -  742s
     0     0 66180.0790    0  364 37977.3470 66180.0790  74.3%     -  742s
     0     0 66170.9715    0  366 37977.3470 66170.9715  74.2%     -  746s
     0     0 66159.0143    0  331 37977.3470 66159.0143  74.2%     -  752s
     0     0 66154.3607    0  364 37977.3470 66154.3607  74.2%     -  754s
     0     0 66151.0225    0  348 37977.3470 66151.0225  74.2%     -  757s
     0     0 66113.1755    0  361 37977.3470 66113.1755  74.1%     -  766s
     0     0 66103.1266    0  370 37977.3470 66103.1266  74.1%     -  771s
     0     0 66099.7638    0  366 37977.3470 66099.7638  74.1%     -  774s
     0     0 66099.1610    0  373 37977.3470 66099.1610  74.0%     -  777s
     0     0 65377.5776    0  464 37977.3470 65377.5776  72.1%     -  845s
     0     0 65259.9071    0  484 37977.3470 65259.9071  71.8%     -  879s
     0     0 65189.9197    0  442 37977.3470 65189.9197  71.7%     -  893s
     0     0 65169.8842    0  498 37977.3470 65169.8842  71.6%     -  907s
     0     0 65117.4278    0  486 37977.3470 65117.4278  71.5%     -  926s
H    0     0                    38010.591826 65104.4340  71.3%     -  934s
H    0     0                    38325.217106 65104.4340  69.9%     -  934s
H    0     0                    38328.100833 65104.4340  69.9%     -  934s
H    0     0                    38522.718500 65104.4340  69.0%     -  934s
     0     0 65104.4340    0  504 38522.7185 65104.4340  69.0%     -  934s
     0     0 65095.5486    0  535 38522.7185 65095.5486  69.0%     -  942s
     0     0 65092.5900    0  533 38522.7185 65092.5900  69.0%     -  946s
H    0     0                    38597.917514 64917.9580  68.2%     -  978s
H    0     0                    38624.178090 64917.9580  68.1%     -  978s
H    0     0                    38680.512257 64917.9580  67.8%     -  978s
     0     0 64917.9580    0  436 38680.5123 64917.9580  67.8%     -  978s
H    0     0                    38939.725477 64917.8828  66.7%     -  979s
     0     0 64874.2650    0  351 38939.7255 64874.2650  66.6%     -  991s
     0     0 64866.2673    0  359 38939.7255 64866.2673  66.6%     -  999s
     0     0 64855.6455    0  442 38939.7255 64855.6455  66.6%     - 1007s
     0     0 64851.7389    0  446 38939.7255 64851.7389  66.5%     - 1012s
     0     0 64849.0146    0  368 38939.7255 64849.0146  66.5%     - 1017s
     0     0 64709.4393    0  443 38939.7255 64709.4393  66.2%     - 1043s
     0     0 64684.6969    0  454 38939.7255 64684.6969  66.1%     - 1056s
     0     0 64670.8663    0  460 38939.7255 64670.8663  66.1%     - 1062s
     0     0 64663.3784    0  464 38939.7255 64663.3784  66.1%     - 1071s
     0     0 64661.8516    0  521 38939.7255 64661.8516  66.1%     - 1075s
     0     0 64621.8650    0  377 38939.7255 64621.8650  66.0%     - 1088s
     0     0 64610.5786    0  355 38939.7255 64610.5786  65.9%     - 1097s
     0     0 64603.8451    0  366 38939.7255 64603.8451  65.9%     - 1100s
     0     0 64600.6857    0  366 38939.7255 64600.6857  65.9%     - 1103s
     0     0 64599.5938    0  362 38939.7255 64599.5938  65.9%     - 1105s
     0     0 64551.9212    0  409 38939.7255 64551.9212  65.8%     - 1121s
     0     0 64536.5963    0  410 38939.7255 64536.5963  65.7%     - 1134s
H    0     0                    38949.571380 64533.0452  65.7%     - 1141s
     0     0 64533.0452    0  387 38949.5714 64533.0452  65.7%     - 1141s
     0     0 64530.5670    0  379 38949.5714 64530.5670  65.7%     - 1146s
     0     0 64507.9688    0  380 38949.5714 64507.9688  65.6%     - 1156s
     0     0 64501.9996    0  384 38949.5714 64501.9996  65.6%     - 1167s
     0     0 64496.7526    0  376 38949.5714 64496.7526  65.6%     - 1174s
     0     0 64495.3924    0  383 38949.5714 64495.3924  65.6%     - 1179s
     0     0 64470.1804    0  489 38949.5714 64470.1804  65.5%     - 1200s
     0     0 64461.3204    0  499 38949.5714 64461.3204  65.5%     - 1211s
     0     0 64456.9366    0  414 38949.5714 64456.9366  65.5%     - 1216s
     0     0 64455.1490    0  412 38949.5714 64455.1490  65.5%     - 1219s
     0     0 64446.7973    0  374 38949.5714 64446.7973  65.5%     - 1226s
     0     0 64445.8923    0  379 38949.5714 64445.8923  65.5%     - 1229s
     0     0 64439.9432    0  369 38949.5714 64439.9432  65.4%     - 1235s
     0     0 64430.5332    0  454 38949.5714 64430.5332  65.4%     - 1244s
     0     0 64427.7323    0  453 38949.5714 64427.7323  65.4%     - 1249s
     0     0 64418.0971    0  370 38949.5714 64418.0971  65.4%     - 1255s
     0     0 64417.7765    0  370 38949.5714 64417.7765  65.4%     - 1258s
H    0     0                    38982.613015 64417.7765  65.2%     - 1392s
H    0     0                    39026.817387 64417.7765  65.1%     - 1392s
H    0     0                    39077.300837 64417.7765  64.8%     - 1392s
H    0     0                    39480.079614 64417.7765  63.2%     - 1392s
H    0     0                    39562.164643 64417.7765  62.8%     - 1479s
     0     2 64417.7765    0  370 39562.1646 64417.7765  62.8%     - 1482s
     1     3 64265.8740    1  476 39562.1646 64417.5609  62.8% 17906 1515s
     2     4 64275.8716    1  374 39562.1646 64275.8716  62.5% 13736 1531s
     3     7 63916.4404    2  363 39562.1646 64275.8144  62.5% 13119 1555s
     6    13 64039.1457    3  456 39562.1646 64265.3549  62.4% 12616 1626s
    12    26 63319.2501    4  471 39562.1646 64038.9212  61.9% 16903 1683s
    25    39 61644.3386    5  344 39562.1646 63789.8991  61.2% 23609 2226s
H   38    71                    39639.091875 63789.8991  60.9% 24554 2678s
H   41    71                    39896.574979 63789.8991  59.9% 24267 2678s
H   48    71                    39940.007358 63789.8991  59.7% 23785 2678s
    70   152 62412.4019    7  519 39940.0074 63638.0900  59.3% 25575 2797s
   151   209 62167.2011   10  428 39940.0074 63637.8125  59.3% 17823 2873s
   208   262 61946.7010   11  425 39940.0074 63637.8125  59.3% 15385 2952s
   261   293 55915.4364   10  278 39940.0074 63637.8125  59.3% 14086 3046s
   292   338 61790.4990   13  415 39940.0074 63637.8125  59.3% 13291 3205s
   337   382 61485.5101   16  448 39940.0074 63637.8125  59.3% 12373 3265s
   381   412 61344.4980   19  449 39940.0074 63637.8125  59.3% 11807 3329s
   411   445 61228.2954   20  454 39940.0074 63637.8125  59.3% 11521 3410s
   444   481 61054.6109   21  446 39940.0074 63637.8125  59.3% 11203 3463s
   480   514 61013.8450   22  450 39940.0074 63637.8125  59.3% 10854 3511s
   513   549 61002.5463   23  452 39940.0074 63637.8125  59.3% 10656 3558s
   548   585 60885.3920   24  445 39940.0074 63637.8125  59.3% 10516 3600s

Cutting planes:
  Learned: 2
  Gomory: 42
  Implied bound: 183
  MIR: 2993
  Flow cover: 2615
  RLT: 113
  Relax-and-lift: 673

Explored 584 nodes (6681128 simplex iterations) in 3600.13 seconds (4661.38 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 39940 39896.6 39639.1 ... 38939.7

Time limit reached
Best objective 3.994000735775e+04, best bound 6.363781247515e+04, gap 59.3335%
  WARNING: Time limit reached. Using best solution found (gap: 59.33%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.14s
  Master Objective (UB) = 39940.01, θ = 216512.12
  Upper Bound (UB) = 39940.01

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 216512.12
  [DEBUG]   ✓ Scenario 0: θ = 216512.12 ≤ Q = 216512.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 216512.12 ≤ Q = 216512.12 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 216512.12 ≤ Q = 216512.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 216512.12 ≤ Q = 216512.12 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 216512.12 ≤ Q = 216512.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 216512.12 ≤ Q = 216512.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 216512.12 ≤ Q = 216512.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 216512.12 ≤ Q = 216512.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 216512.12 ≤ Q = 216512.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 216512.12 ≤ Q = 216512.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 216512.12 ≤ Q = 216512.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 216512.12 ≤ Q = 216512.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 216512.12 ≤ Q = 216512.12 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 13] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x4fb522c7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xb04add39
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [3e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.343789e+13
Presolve removed 2592 rows and 1882 columns
Presolve time: 0.01s
Presolved: 501 rows, 507 columns, 1417 nonzeros
Found heuristic solution: objective 6473796.8805
Variable types: 344 continuous, 163 integer (163 binary)
Found heuristic solution: objective 6473402.8771

Root relaxation: objective -1.678124e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -167812.42    0  127 6473402.88 -167812.42   103%     -    0s
H    0     0                    -130826.6660 -167812.42  28.3%     -    0s
H    0     0                    -134682.4047 -167812.42  24.6%     -    0s
     0     0 -147589.76    0   68 -134682.40 -147589.76  9.58%     -    0s
H    0     0                    -142513.9222 -147460.47  3.47%     -    0s
H    0     0                    -144678.7226 -147460.47  1.92%     -    0s
H    0     0                    -146134.1022 -147460.47  0.91%     -    0s
H    0     0                    -146321.1886 -147460.47  0.78%     -    0s
     0     0 -147417.91    0   55 -146321.19 -147417.91  0.75%     -    0s
     0     0 -147407.44    0   55 -146321.19 -147407.44  0.74%     -    0s
     0     0 -146716.58    0   48 -146321.19 -146716.58  0.27%     -    0s
     0     0 -146667.20    0   43 -146321.19 -146667.20  0.24%     -    0s
     0     0 -146656.87    0   42 -146321.19 -146656.87  0.23%     -    0s
H    0     0                    -146423.7369 -146647.38  0.15%     -    0s
H    0     0                    -146458.5534 -146621.02  0.11%     -    0s
     0     0 -146621.02    0   39 -146458.55 -146621.02  0.11%     -    0s
     0     0 -146585.68    0   34 -146458.55 -146585.68  0.09%     -    0s
     0     0 -146575.11    0   18 -146458.55 -146575.11  0.08%     -    0s
     0     0 -146575.03    0   18 -146458.55 -146575.03  0.08%     -    0s
     0     0 -146565.09    0   19 -146458.55 -146565.09  0.07%     -    0s
     0     0 -146564.88    0   19 -146458.55 -146564.88  0.07%     -    0s
     0     0 -146523.57    0    8 -146458.55 -146523.57  0.04%     -    0s
     0     0 -146523.57    0   23 -146458.55 -146523.57  0.04%     -    0s
     0     0          -    0      -146458.55 -146471.08  0.01%     -    0s

Cutting planes:
  Gomory: 7
  Implied bound: 2
  MIR: 10
  Flow cover: 12
  RLT: 1

Explored 1 nodes (647 simplex iterations) in 0.15 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -146459 -146424 -146321 ... 1.34379e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.464585533996e+05, best bound -1.464710780373e+05, gap 0.0086%
  Subproblem solved in 0.22s
  Worst-case operational profit (Z_SP) = 204630.44
  Scenario: 17 demand increases, 43 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -146458.55
  [DEBUG]   S×d_nominal = 351088.99
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 351088.99 + -146458.55 = 204630.44
  [DEBUG]   Current θ from Master = 216512.12
  [DEBUG]   ⚠️  Z_SP ≤ θ by 11881.68 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 28058.33
  Lower Bound (LB) = 38407.27
  Gap (UB-LB) = 1532.7373, Absolute Gap = 1532.7373, Relative Gap = 0.038376
  Not converged yet (gap = 1532.74 > ε = 200)

  [DEBUG] Adding NEW scenario 13 to Master Problem...
  [DEBUG] New scenario pattern: 17 increases, 43 decreases
    [DEBUG] Scenario 13 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 13 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 13]
    [DEBUG]   - Total constraints in model: 215443
    [DEBUG]   - Total variables in model: 89620
  [DEBUG] Total scenarios in Master: 14
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 14
================================================================================
[Iteration 14] Solving Master Problem...
  Current scenarios in Master: 14
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 215443 rows, 89620 columns and 610837 nonzeros
Model fingerprint: 0x934ee335
Variable types: 87361 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 96272 rows and 39092 columns
Presolve time: 4.08s
Presolved: 119171 rows, 50528 columns, 732822 nonzeros
Variable types: 48269 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -312480.3870
Found heuristic solution: objective -183060.7998

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.30s

Barrier statistics:
 Dense cols : 700
 AA' NZ     : 4.666e+06
 Factor NZ  : 1.063e+07 (roughly 150 MB of memory)
 Factor Ops : 2.188e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.78689956e+07  2.26561098e+08  1.43e+05 1.85e+01  8.68e+04     7s
   1  -1.39185991e+07  2.10578706e+08  1.03e+05 1.05e+02  6.16e+04     7s
   2  -5.19225693e+06  1.69564724e+08  3.81e+04 5.84e-01  2.43e+04     7s
   3  -1.41270683e+06  1.28923507e+08  5.51e+03 1.01e+00  3.94e+03     8s
   4  -7.10793879e+05  6.42866337e+07  6.98e+02 1.31e-01  6.82e+02     8s
   5  -5.58609242e+05  3.73815260e+07  2.90e+02 6.76e-02  3.17e+02     8s
   6  -3.77918112e+05  2.65466443e+07  1.01e+02 4.29e-02  1.69e+02     8s
   7  -3.14035804e+05  1.83541934e+07  5.60e+01 2.71e-02  1.07e+02     8s
   8  -2.09504108e+05  1.25901995e+07  2.34e+01 1.81e-02  6.60e+01     8s
   9  -1.50299214e+05  6.44364998e+06  1.34e+01 8.47e-03  3.28e+01     8s
  10  -1.20480157e+05  2.85720184e+06  8.36e+00 3.49e-03  1.45e+01     8s
  11  -6.74603174e+04  1.63613688e+06  2.17e+00 1.95e-03  7.95e+00     8s
  12  -4.23476853e+04  5.63226754e+05  1.09e+00 1.30e-03  2.81e+00     8s
  13  -1.52493864e+04  2.94010200e+05  5.75e-01 6.61e-04  1.43e+00     9s
  14   7.04403439e+03  2.28905113e+05  4.14e-01 1.23e-03  1.02e+00     9s
  15   2.87239458e+04  1.94378723e+05  2.85e-01 1.31e-03  7.64e-01     9s
  16   3.90903847e+04  1.64092597e+05  2.22e-01 1.32e-03  5.77e-01     9s
  17   4.48984805e+04  1.52321090e+05  1.89e-01 1.32e-03  4.95e-01     9s
  18   5.07019281e+04  1.37439341e+05  1.53e-01 1.79e-03  4.00e-01     9s
  19   5.90090502e+04  1.22576126e+05  1.08e-01 1.91e-03  2.93e-01     9s
  20   6.43135468e+04  1.09924569e+05  7.81e-02 3.03e-03  2.10e-01     9s
  21   6.94091435e+04  1.03364764e+05  5.15e-02 2.64e-03  1.56e-01     9s
  22   7.06323536e+04  9.83026908e+04  4.50e-02 2.09e-03  1.27e-01    10s
  23   7.32031831e+04  9.42278549e+04  3.33e-02 1.76e-03  9.69e-02    10s
  24   7.46519087e+04  8.97850078e+04  2.71e-02 1.02e-03  6.97e-02    10s
  25   7.56212228e+04  8.85001552e+04  2.33e-02 8.29e-04  5.94e-02    10s
  26   7.63360994e+04  8.67188159e+04  2.06e-02 6.12e-04  4.79e-02    10s
  27   7.68405593e+04  8.59963702e+04  1.86e-02 5.18e-04  4.22e-02    10s
  28   7.80613655e+04  8.51094408e+04  1.41e-02 5.05e-04  3.25e-02    10s
  29   7.86671831e+04  8.47797672e+04  1.20e-02 4.74e-04  2.82e-02    10s
  30   7.89160281e+04  8.41214433e+04  1.12e-02 3.59e-04  2.40e-02    11s
  31   7.97389130e+04  8.34989518e+04  8.22e-03 2.38e-04  1.73e-02    11s
  32   8.04590373e+04  8.29535130e+04  5.65e-03 1.45e-04  1.15e-02    11s
  33   8.07869589e+04  8.26931186e+04  4.57e-03 9.45e-05  8.80e-03    11s
  34   8.12058623e+04  8.25249292e+04  3.17e-03 1.26e-04  6.09e-03    11s
  35   8.13303459e+04  8.24894630e+04  2.78e-03 1.12e-04  5.35e-03    11s
  36   8.13728481e+04  8.24271544e+04  2.64e-03 8.43e-05  4.87e-03    11s
  37   8.15712712e+04  8.23827096e+04  2.00e-03 6.61e-05  3.75e-03    11s
  38   8.17186088e+04  8.23531677e+04  1.55e-03 4.89e-05  2.93e-03    12s
  39   8.18810920e+04  8.23131677e+04  1.03e-03 3.34e-05  1.99e-03    12s
  40   8.19537464e+04  8.22832682e+04  8.13e-04 2.25e-05  1.52e-03    12s
  41   8.20648489e+04  8.22489576e+04  4.60e-04 1.46e-05  8.50e-04    12s
  42   8.20976711e+04  8.22416592e+04  3.62e-04 1.08e-05  6.65e-04    12s
  43   8.21236403e+04  8.22390290e+04  2.85e-04 9.31e-06  5.33e-04    12s
  44   8.21694836e+04  8.22273393e+04  1.46e-04 3.32e-06  2.67e-04    12s
  45   8.21825365e+04  8.22237078e+04  1.08e-04 1.77e-06  1.90e-04    12s
  46   8.21842474e+04  8.22232767e+04  1.03e-04 1.59e-06  1.80e-04    12s
  47   8.21921014e+04  8.22219631e+04  7.98e-05 1.03e-06  1.38e-04    13s
  48   8.22062530e+04  8.22202938e+04  3.77e-05 5.68e-06  6.49e-05    13s
  49   8.22165648e+04  8.22199312e+04  7.21e-06 2.63e-06  1.55e-05    13s
  50   8.22190612e+04  8.22195819e+04  1.08e-06 4.30e-07  2.40e-06    13s
  51   8.22195009e+04  8.22195070e+04  4.16e-08 1.37e-09  2.81e-08    13s
  52   8.22195055e+04  8.22195056e+04  2.15e-09 1.46e-10  3.95e-10    13s

Barrier solved model in 52 iterations and 13.30 seconds (11.61 work units)
Optimal objective 8.22195055e+04


Root crossover log...

  105511 DPushes remaining with DInf 0.0000000e+00                13s
   15944 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                17s

    3185 PPushes remaining with PInf 4.0432366e-05                17s
       0 PPushes remaining with PInf 0.0000000e+00                17s

  Push phase complete: Pinf 0.0000000e+00, Dinf 5.8622800e+02     17s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   50970    8.2219506e+04   0.000000e+00   5.862280e+02     17s
   50974    8.2219506e+04   0.000000e+00   0.000000e+00     17s
   50974    8.2219506e+04   0.000000e+00   0.000000e+00     18s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 8.221951e+04, 50974 iterations, 12.44 seconds (15.07 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 82219.5056    0  165 -183060.80 82219.5056   145%     -   18s
H    0     0                    -140132.6589 82219.5056   159%     -   19s
H    0     0                    -139824.7425 82219.5056   159%     -   19s
H    0     0                    -136957.8596 82219.5056   160%     -   20s
H    0     0                    -135992.2474 82219.5056   160%     -   20s
H    0     0                    -68045.55698 82219.5056   221%     -   21s
H    0     0                    -18763.35573 82219.5056   538%     -   21s
H    0     0                    -18359.19494 82219.5056   548%     -   21s
H    0     0                    1878.4011972 82219.5056  4277%     -   22s
H    0     0                    6925.5277573 82219.5056  1087%     -   22s
H    0     0                    6948.5171334 82219.5056  1083%     -   22s
H    0     0                    22315.214055 82219.5056   268%     -   23s
H    0     0                    23644.265430 82219.5056   248%     -   23s
H    0     0                    23721.855527 75811.4582   220%     -   90s
     0     0 75780.0910    0  227 23721.8555 75780.0910   219%     -   90s
     0     0 74687.4584    0  195 23721.8555 74687.4584   215%     -  134s
     0     0 74655.9390    0  206 23721.8555 74655.9390   215%     -  140s
     0     0 74655.9390    0  196 23721.8555 74655.9390   215%     -  145s
     0     0 74589.3082    0  201 23721.8555 74589.3082   214%     -  154s
     0     0 74589.3082    0  206 23721.8555 74589.3082   214%     -  158s
     0     0 74589.3082    0  206 23721.8555 74589.3082   214%     -  165s
     0     0 74589.3082    0  207 23721.8555 74589.3082   214%     -  168s
     0     0 74586.4416    0  210 23721.8555 74586.4416   214%     -  171s
     0     0 74585.1882    0  214 23721.8555 74585.1882   214%     -  172s
     0     0 74581.9295    0  214 23721.8555 74581.9295   214%     -  174s
     0     0 74575.1603    0  225 23721.8555 74575.1603   214%     -  175s
     0     0 74575.0283    0  225 23721.8555 74575.0283   214%     -  176s
     0     0 70318.5609    0  308 23721.8555 70318.5609   196%     -  273s
H    0     0                    26772.630983 70318.4422   163%     -  274s
H    0     0                    29687.064130 70318.4422   137%     -  274s
H    0     0                    29934.853879 69565.2496   132%     -  326s
H    0     0                    29941.900458 69565.2496   132%     -  326s
H    0     0                    29944.357255 69565.2496   132%     -  326s
H    0     0                    30292.134269 69565.2496   130%     -  326s
H    0     0                    30362.751787 69565.2496   129%     -  326s
H    0     0                    30416.648672 69565.2496   129%     -  326s
     0     0 69565.2496    0  292 30416.6487 69565.2496   129%     -  326s
     0     0 69373.6826    0  350 30416.6487 69373.6826   128%     -  350s
     0     0 69349.4095    0  351 30416.6487 69349.4095   128%     -  357s
     0     0 69242.4570    0  359 30416.6487 69242.4570   128%     -  376s
     0     0 69156.9015    0  350 30416.6487 69156.9015   127%     -  391s
     0     0 69082.7253    0  355 30416.6487 69082.7253   127%     -  400s
     0     0 69075.2603    0  354 30416.6487 69075.2603   127%     -  402s
     0     0 69064.5531    0  356 30416.6487 69064.5531   127%     -  404s
     0     0 69056.1225    0  358 30416.6487 69056.1225   127%     -  408s
     0     0 69055.4434    0  356 30416.6487 69055.4434   127%     -  410s
H    0     0                    30932.941294 69055.4434   123%     -  429s
H    0     0                    31213.155049 66586.8651   113%     -  485s
H    0     0                    31228.636076 66586.8651   113%     -  485s
H    0     0                    31252.727565 66586.8651   113%     -  485s
H    0     0                    31635.495699 66586.8651   110%     -  485s
H    0     0                    31735.171859 66586.8651   110%     -  485s
H    0     0                    31790.354035 66586.8651   109%     -  485s
H    0     0                    31963.168235 66586.8651   108%     -  485s
H    0     0                    31966.363955 66586.8651   108%     -  485s
H    0     0                    31972.161124 66586.8651   108%     -  485s
H    0     0                    32251.302979 66586.8651   106%     -  485s
H    0     0                    32296.444860 66586.8651   106%     -  485s
H    0     0                    34463.040685 66586.8651  93.2%     -  486s
H    0     0                    34502.730659 66586.8651  93.0%     -  486s
H    0     0                    34673.448165 66586.8651  92.0%     -  486s
H    0     0                    35309.242898 66586.8651  88.6%     -  486s
     0     0 66586.8651    0  335 35309.2429 66586.8651  88.6%     -  486s
     0     0 66207.8185    0  335 35309.2429 66207.8185  87.5%     -  511s
     0     0 66074.1841    0  353 35309.2429 66074.1841  87.1%     -  526s
     0     0 65987.7552    0  356 35309.2429 65987.7552  86.9%     -  537s
     0     0 65954.0473    0  360 35309.2429 65954.0473  86.8%     -  545s
     0     0 65910.4081    0  360 35309.2429 65910.4081  86.7%     -  554s
H    0     0                    35541.495710 65875.8117  85.3%     -  565s
H    0     0                    35567.016061 65875.8117  85.2%     -  565s
H    0     0                    35596.691691 65875.8117  85.1%     -  565s
H    0     0                    35769.281399 65875.8117  84.2%     -  565s
H    0     0                    35905.631039 65875.8117  83.5%     -  565s
H    0     0                    36022.566415 65875.8117  82.9%     -  565s
H    0     0                    36034.763169 65875.8117  82.8%     -  565s
     0     0 65875.8117    0  358 36034.7632 65875.8117  82.8%     -  565s
     0     0 65872.1512    0  358 36034.7632 65872.1512  82.8%     -  568s
H    0     0                    36092.407760 65867.5756  82.5%     -  571s
     0     0 65867.5756    0  368 36092.4078 65867.5756  82.5%     -  571s
     0     0 65852.5300    0  355 36092.4078 65852.5300  82.5%     -  576s
     0     0 65842.2268    0  355 36092.4078 65842.2268  82.4%     -  579s
     0     0 65840.5592    0  357 36092.4078 65840.5592  82.4%     -  581s
H    0     0                    36150.378745 65048.0787  79.9%     -  637s
     0     0 65048.0787    0  394 36150.3787 65048.0787  79.9%     -  638s
     0     0 64874.6426    0  405 36150.3787 64874.6426  79.5%     -  672s
     0     0 64831.7231    0  403 36150.3787 64831.7231  79.3%     -  685s
     0     0 64811.3125    0  430 36150.3787 64811.3125  79.3%     -  692s
     0     0 64792.5391    0  424 36150.3787 64792.5391  79.2%     -  699s
     0     0 64785.5393    0  426 36150.3787 64785.5393  79.2%     -  702s
     0     0 64780.5157    0  423 36150.3787 64780.5157  79.2%     -  705s
     0     0 64776.3716    0  398 36150.3787 64776.3716  79.2%     -  707s
     0     0 64770.0207    0  396 36150.3787 64770.0207  79.2%     -  709s
     0     0 64762.8395    0  384 36150.3787 64762.8395  79.1%     -  715s
     0     0 64759.1617    0  388 36150.3787 64759.1617  79.1%     -  717s
     0     0 64756.4865    0  398 36150.3787 64756.4865  79.1%     -  720s
     0     0 64755.5249    0  395 36150.3787 64755.5249  79.1%     -  722s
     0     0 64691.5909    0  359 36150.3787 64691.5909  79.0%     -  737s
     0     0 64657.9124    0  407 36150.3787 64657.9124  78.9%     -  747s
     0     0 64652.0858    0  409 36150.3787 64652.0858  78.8%     -  750s
     0     0 64648.6849    0  432 36150.3787 64648.6849  78.8%     -  757s
     0     0 64644.8558    0  416 36150.3787 64644.8558  78.8%     -  760s
     0     0 64642.8434    0  440 36150.3787 64642.8434  78.8%     -  763s
     0     0 64534.6303    0  367 36150.3787 64534.6303  78.5%     -  779s
     0     0 64487.1281    0  408 36150.3787 64487.1281  78.4%     -  795s
     0     0 64473.7196    0  426 36150.3787 64473.7196  78.3%     -  802s
     0     0 64464.5017    0  428 36150.3787 64464.5017  78.3%     -  808s
     0     0 64459.9592    0  430 36150.3787 64459.9592  78.3%     -  816s
     0     0 64454.8671    0  435 36150.3787 64454.8671  78.3%     -  819s
     0     0 64452.9084    0  393 36150.3787 64452.9084  78.3%     -  822s
     0     0 64411.3551    0  386 36150.3787 64411.3551  78.2%     -  836s
H    0     0                    36241.159942 64411.1818  77.7%     -  837s
     0     0 64399.4638    0  469 36241.1599 64399.4638  77.7%     -  846s
     0     0 64396.0128    0  469 36241.1599 64396.0128  77.7%     -  853s
     0     0 64395.0775    0  461 36241.1599 64395.0775  77.7%     -  854s
     0     0 64369.9118    0  377 36241.1599 64369.9118  77.6%     -  861s
     0     0 64359.0116    0  386 36241.1599 64359.0116  77.6%     -  868s
     0     0 64356.4322    0  394 36241.1599 64356.4322  77.6%     -  875s
     0     0 64355.2940    0  389 36241.1599 64355.2940  77.6%     -  877s
     0     0 64337.4481    0  389 36241.1599 64337.4481  77.5%     -  886s
     0     0 64316.4266    0  465 36241.1599 64316.4266  77.5%     -  895s
     0     0 64312.4959    0  405 36241.1599 64312.4959  77.5%     -  899s
     0     0 64309.7340    0  403 36241.1599 64309.7340  77.4%     -  901s
     0     0 64309.2896    0  404 36241.1599 64309.2896  77.4%     -  902s
     0     0 64273.8586    0  397 36241.1599 64273.8586  77.4%     -  915s
     0     0 64265.6375    0  394 36241.1599 64265.6375  77.3%     -  925s
     0     0 64256.8831    0  403 36241.1599 64256.8831  77.3%     -  932s
     0     0 64252.2066    0  405 36241.1599 64252.2066  77.3%     -  935s
     0     0 64250.7970    0  405 36241.1599 64250.7970  77.3%     -  937s
     0     0 64232.8117    0  402 36241.1599 64232.8117  77.2%     -  945s
     0     0 64227.4457    0  404 36241.1599 64227.4457  77.2%     -  950s
     0     0 64226.5205    0  411 36241.1599 64226.5205  77.2%     -  951s
     0     0 64222.5866    0  410 36241.1599 64222.5866  77.2%     -  956s
H    0     0                    36424.453678 64221.5225  76.3%     -  981s
     0     0 64221.5225    0  413 36424.4537 64221.5225  76.3%     -  983s
     0     0 64218.7523    0  407 36424.4537 64218.7523  76.3%     -  987s
     0     0 64217.8849    0  483 36424.4537 64217.8849  76.3%     -  992s
     0     0 64217.5256    0  482 36424.4537 64217.5256  76.3%     -  996s
     0     0 64217.4516    0  482 36424.4537 64217.4516  76.3%     - 1000s
H    0     0                    37183.378864 64217.4516  72.7%     - 1089s
H    0     0                    37429.627552 64217.4514  71.6%     - 1315s
H    0     2                    39015.614239 64217.4514  64.6%     - 1664s
     0     2 64217.4514    0  482 39015.6142 64217.4514  64.6%     - 1664s
     1     4 64152.6385    1  388 39015.6142 64217.0363  64.6%  4363 1682s
     3     8 64083.6317    2  392 39015.6142 64152.4725  64.4%  6631 1753s
     7    16 63997.3048    3  417 39015.6142 64130.6595  64.4% 12666 1857s
    15    32 63625.0515    4  400 39015.6142 63997.1647  64.0% 18317 1922s
    31    48 61163.1015    5  353 39015.6142 63624.1797  63.1% 23143 2703s
    47    80 60231.8429    6  323 39015.6142 63624.1797  63.1% 29460 2817s
    79   144 60134.8101    7  319 39015.6142 63624.1797  63.1% 22979 3131s
   143   176 60043.0208    9  325 39015.6142 63624.1797  63.1% 16110 3202s
H  145   176                    39142.895780 63624.1797  62.5% 15906 3202s
H  150   176                    39441.228354 63624.1797  61.3% 15640 3202s
H  157   176                    39610.335355 63624.1797  60.6% 15143 3202s
   175   208 59666.6674    9  314 39610.3354 63624.1797  60.6% 14324 3290s
H  179   208                    39691.383962 63624.1797  60.3% 14149 3290s
H  187   208                    39715.412033 63624.1797  60.2% 13750 3290s
   207   354 60033.2547   10  348 39715.4120 63624.1797  60.2% 13146 3393s
   353   465 59671.4005   12  311 39715.4120 63624.1797  60.2% 10009 3461s
   464   552 59674.1805   13  316 39715.4120 63624.1797  60.2%  8604 3512s
   551   628 59625.8091   13  334 39715.4120 63624.1797  60.2%  7929 3558s
   627   703 59575.6283   14  340 39715.4120 63624.1797  60.2%  7585 3597s
   702   705 57398.9632   33  251 39715.4120 63624.1797  60.2%  7331 3600s

Cutting planes:
  Learned: 3
  Gomory: 19
  Implied bound: 184
  MIR: 2706
  Flow cover: 2431
  RLT: 54
  Relax-and-lift: 418

Explored 704 nodes (5643513 simplex iterations) in 3600.10 seconds (4938.14 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 39715.4 39691.4 39610.3 ... 36241.2

Time limit reached
Best objective 3.971541203308e+04, best bound 6.362417970446e+04, gap 60.2002%
  WARNING: Time limit reached. Using best solution found (gap: 60.20%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.12s
  Master Objective (UB) = 39715.41, θ = 216138.28
  Upper Bound (UB) = 39715.41

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 216138.28
  [DEBUG]   ✓ Scenario 0: θ = 216138.28 ≤ Q = 216138.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 216138.28 ≤ Q = 216138.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 216138.28 ≤ Q = 216138.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 216138.28 ≤ Q = 216138.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 216138.28 ≤ Q = 216138.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 216138.28 ≤ Q = 216138.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 216138.28 ≤ Q = 216138.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 216138.28 ≤ Q = 216138.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 216138.28 ≤ Q = 216138.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 216138.28 ≤ Q = 216138.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 216138.28 ≤ Q = 216138.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 216138.28 ≤ Q = 216138.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 216138.28 ≤ Q = 216138.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 216138.28 ≤ Q = 216138.28 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 14] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x122c60b2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x122c60b2
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.332731e+13
Presolve removed 2586 rows and 1877 columns
Presolve time: 0.01s
Presolved: 507 rows, 512 columns, 1433 nonzeros
Found heuristic solution: objective 6547071.3306
Variable types: 348 continuous, 164 integer (164 binary)

Root relaxation: objective -1.658772e+05, 255 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -165877.19    0  128 6547071.33 -165877.19   103%     -    0s
H    0     0                    -130643.9604 -165877.19  27.0%     -    0s
     0     0 -146305.10    0   87 -130643.96 -146305.10  12.0%     -    0s
H    0     0                    -142756.8693 -146183.56  2.40%     -    0s
     0     0 -146183.56    0   90 -142756.87 -146183.56  2.40%     -    0s
H    0     0                    -144284.0530 -146183.56  1.32%     -    0s
H    0     0                    -144601.5773 -146183.56  1.09%     -    0s
     0     0 -146183.56    0   83 -144601.58 -146183.56  1.09%     -    0s
H    0     0                    -144773.3754 -146183.56  0.97%     -    0s
     0     0 -145359.99    0   56 -144773.38 -145359.99  0.41%     -    0s
     0     0 -145314.40    0   54 -144773.38 -145314.40  0.37%     -    0s
     0     0 -145311.06    0   70 -144773.38 -145311.06  0.37%     -    0s
     0     0 -144968.05    0   21 -144773.38 -144968.05  0.13%     -    0s
     0     0 -144968.02    0   20 -144773.38 -144968.02  0.13%     -    0s
H    0     0                    -144782.1215 -144965.80  0.13%     -    0s
     0     0 -144899.03    0   26 -144782.12 -144899.03  0.08%     -    0s
     0     0 -144898.30    0   24 -144782.12 -144898.30  0.08%     -    0s
     0     0 -144895.38    0   23 -144782.12 -144895.38  0.08%     -    0s
     0     0 -144868.28    0   13 -144782.12 -144868.28  0.06%     -    0s
     0     0 -144846.84    0    8 -144782.12 -144846.84  0.04%     -    0s
     0     0 -144846.84    0   18 -144782.12 -144846.84  0.04%     -    0s
     0     0 -144803.40    0    5 -144782.12 -144803.40  0.01%     -    0s
H    0     0                    -144787.3825 -144803.40  0.01%     -    0s
H    0     0                    -144794.7812 -144802.29  0.01%     -    0s
     0     0 -144802.29    0    4 -144794.78 -144802.29  0.01%     -    0s

Cutting planes:
  Gomory: 4
  Implied bound: 1
  MIR: 11
  Flow cover: 8
  RLT: 1
  Relax-and-lift: 2

Explored 1 nodes (813 simplex iterations) in 0.11 seconds (0.05 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -144795 -144787 -144782 ... 1.33273e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.447947811760e+05, best bound -1.448022939983e+05, gap 0.0052%
  Subproblem solved in 0.14s
  Worst-case operational profit (Z_SP) = 204985.30
  Scenario: 31 demand increases, 29 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -144794.78
  [DEBUG]   S×d_nominal = 349780.08
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 349780.08 + -144794.78 = 204985.30
  [DEBUG]   Current θ from Master = 216138.28
  [DEBUG]   ⚠️  Z_SP ≤ θ by 11152.98 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 28562.43
  Lower Bound (LB) = 38407.27
  Gap (UB-LB) = 1308.1420, Absolute Gap = 1308.1420, Relative Gap = 0.032938
  Not converged yet (gap = 1308.14 > ε = 200)

  [DEBUG] Adding NEW scenario 14 to Master Problem...
  [DEBUG] New scenario pattern: 31 increases, 29 decreases
    [DEBUG] Scenario 14 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 14 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 14]
    [DEBUG]   - Total constraints in model: 230733
    [DEBUG]   - Total variables in model: 95860
  [DEBUG] Total scenarios in Master: 15
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 15
================================================================================
[Iteration 15] Solving Master Problem...
  Current scenarios in Master: 15
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 230733 rows, 95860 columns and 654074 nonzeros
Model fingerprint: 0x2c590d7a
Variable types: 93601 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 103140 rows and 41880 columns
Presolve time: 4.50s
Presolved: 127593 rows, 53980 columns, 785159 nonzeros
Variable types: 51721 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -311899.6497
Found heuristic solution: objective -183060.7998

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.94s

Barrier statistics:
 Dense cols : 703
 AA' NZ     : 5.243e+06
 Factor NZ  : 1.190e+07 (roughly 170 MB of memory)
 Factor Ops : 2.582e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.82530255e+07  2.40803106e+08  1.46e+05 1.77e+01  8.82e+04     8s
   1  -1.42500633e+07  2.24617362e+08  1.05e+05 1.05e+02  6.27e+04     8s
   2  -4.50384777e+06  1.80086552e+08  3.29e+04 6.49e-01  2.11e+04     8s
   3  -1.03648440e+06  1.28638556e+08  3.50e+03 9.88e-01  2.69e+03     9s
   4  -5.98199554e+05  5.21531296e+07  5.79e+02 2.42e-01  5.39e+02     9s
   5  -4.60966156e+05  3.50263862e+07  2.71e+02 1.35e-01  2.87e+02     9s
   6  -3.69774817e+05  2.81923432e+07  1.32e+02 1.01e-01  1.84e+02     9s
   7  -3.02577734e+05  2.00490629e+07  6.53e+01 6.72e-02  1.14e+02     9s
   8  -2.08891060e+05  1.44653533e+07  2.71e+01 4.58e-02  7.21e+01     9s
   9  -1.49793288e+05  7.96295605e+06  1.42e+01 2.30e-02  3.79e+01     9s
  10  -1.17593508e+05  4.04033539e+06  7.59e+00 1.11e-02  1.88e+01     9s
  11  -8.54406347e+04  1.78465192e+06  3.56e+00 4.63e-03  8.24e+00     9s
  12  -5.04158389e+04  6.45244910e+05  1.42e+00 1.58e-03  3.02e+00     9s
  13  -2.32959282e+04  3.28308158e+05  7.42e-01 7.55e-04  1.52e+00     9s
  14  -5.78759678e+03  2.29363444e+05  5.42e-01 8.57e-04  1.02e+00     9s
  15   8.13564648e+03  2.01035618e+05  4.46e-01 1.60e-03  8.33e-01    10s
  16   3.27416150e+04  1.84151924e+05  2.70e-01 2.16e-03  6.53e-01    10s
  17   4.36365576e+04  1.61427934e+05  2.06e-01 1.61e-03  5.08e-01    10s
  18   4.82512959e+04  1.35432716e+05  1.75e-01 1.49e-03  3.76e-01    10s
  19   5.76802663e+04  1.30530290e+05  1.21e-01 1.39e-03  3.14e-01    10s
  20   5.99985997e+04  1.08864643e+05  1.07e-01 1.85e-03  2.11e-01    10s
  21   6.43247499e+04  1.01462952e+05  8.40e-02 2.15e-03  1.60e-01    10s
  22   6.81253478e+04  9.84966324e+04  6.48e-02 2.12e-03  1.31e-01    10s
  23   6.99209378e+04  9.47953964e+04  5.54e-02 1.73e-03  1.07e-01    10s
  24   7.09100700e+04  9.30575118e+04  5.05e-02 1.73e-03  9.56e-02    10s
  25   7.27020458e+04  9.07720863e+04  4.16e-02 1.60e-03  7.80e-02    11s
  26   7.37444088e+04  9.02431594e+04  3.68e-02 1.47e-03  7.12e-02    11s
  27   7.46174734e+04  8.94121875e+04  3.27e-02 1.30e-03  6.38e-02    11s
  28   7.58603420e+04  8.79589303e+04  2.73e-02 1.12e-03  5.22e-02    11s
  29   7.67699143e+04  8.68044185e+04  2.34e-02 8.72e-04  4.33e-02    11s
  30   7.78604595e+04  8.64507540e+04  1.87e-02 8.03e-04  3.70e-02    11s
  31   7.84770779e+04  8.56460294e+04  1.61e-02 8.57e-04  3.09e-02    11s
  32   7.89284739e+04  8.51980420e+04  1.43e-02 7.36e-04  2.70e-02    11s
  33   7.93039609e+04  8.49938617e+04  1.27e-02 6.79e-04  2.45e-02    11s
  34   7.98603341e+04  8.43519913e+04  1.05e-02 4.88e-04  1.94e-02    12s
  35   8.02656354e+04  8.38677773e+04  8.92e-03 3.51e-04  1.55e-02    12s
  36   8.08618075e+04  8.36637637e+04  6.61e-03 2.89e-04  1.21e-02    12s
  37   8.13486388e+04  8.34432740e+04  4.76e-03 2.24e-04  9.04e-03    12s
  38   8.15309341e+04  8.32519864e+04  4.09e-03 1.98e-04  7.43e-03    12s
  39   8.20427732e+04  8.31200131e+04  2.18e-03 1.56e-04  4.64e-03    12s
  40   8.20653142e+04  8.30974579e+04  2.09e-03 1.48e-04  4.45e-03    12s
  41   8.21250860e+04  8.30489431e+04  1.88e-03 1.29e-04  3.98e-03    13s
  42   8.23545237e+04  8.29291783e+04  1.08e-03 8.54e-05  2.48e-03    13s
  43   8.24130195e+04  8.28444883e+04  8.73e-04 5.44e-05  1.86e-03    13s
  44   8.25024274e+04  8.27981479e+04  5.74e-04 3.84e-05  1.27e-03    13s
  45   8.25600093e+04  8.27702019e+04  3.90e-04 2.81e-05  9.06e-04    13s
  46   8.26179399e+04  8.27317389e+04  2.09e-04 1.46e-05  4.90e-04    13s
  47   8.26547471e+04  8.27073726e+04  9.84e-05 1.18e-05  2.27e-04    13s
  48   8.26826767e+04  8.26935493e+04  1.86e-05 3.90e-06  4.68e-05    13s
  49   8.26892042e+04  8.26899976e+04  9.72e-07 3.56e-07  3.42e-06    14s
  50   8.26896769e+04  8.26896776e+04  1.07e-09 3.98e-09  2.97e-09    14s

Barrier solved model in 50 iterations and 13.63 seconds (12.37 work units)
Optimal objective 8.26896769e+04


Root crossover log...

  112853 DPushes remaining with DInf 0.0000000e+00                14s
   42879 DPushes remaining with DInf 0.0000000e+00                15s
    1485 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                21s

   17189 PPushes remaining with PInf 9.4836663e-05                21s
       0 PPushes remaining with PInf 0.0000000e+00                22s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.2896663e+04     22s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   75669    8.2689677e+04   0.000000e+00   1.289666e+04     22s
   75828    8.2689677e+04   0.000000e+00   0.000000e+00     22s
   75828    8.2689677e+04   0.000000e+00   0.000000e+00     23s
Concurrent spin time: 1.29s

Solved with barrier

Root relaxation: objective 8.268968e+04, 75828 iterations, 18.47 seconds (23.49 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 82689.6774    0  167 -183060.80 82689.6774   145%     -   24s
H    0     0                    -176942.4595 82689.6774   147%     -   24s
H    0     0                    -127902.1320 82689.6774   165%     -   25s
H    0     0                    -127628.7006 82689.6774   165%     -   26s
H    0     0                    -125723.4126 82689.6774   166%     -   26s
H    0     0                    -66782.91050 82689.6774   224%     -   27s
H    0     0                    -9424.336276 82689.6774   977%     -   27s
H    0     0                    6110.9891261 82689.6774  1253%     -   29s
H    0     0                    23291.352788 82689.6774   255%     -   29s
H    0     0                    23645.516647 82689.6774   250%     -   29s
H    0     0                    23784.625793 82689.6774   248%     -   29s
H    0     0                    23801.651314 82689.6774   247%     -   31s
H    0     0                    23846.895307 82689.6774   247%     -   31s
H    0     0                    23887.201871 82689.6774   246%     -   31s
     0     0 75785.4887    0  210 23887.2019 75785.4887   217%     -   96s
H    0     0                    26171.316239 75785.4356   190%     -   97s
H    0     0                    26296.614157 75785.4356   188%     -   97s
H    0     0                    27952.309519 75785.4356   171%     -   97s
     0     0 75329.7610    0  194 27952.3095 75329.7610   169%     -  125s
     0     0 75113.6148    0  214 27952.3095 75113.6148   169%     -  141s
     0     0 75113.6148    0  247 27952.3095 75113.6148   169%     -  145s
     0     0 74899.0677    0  248 27952.3095 74899.0677   168%     -  154s
     0     0 74899.0677    0  251 27952.3095 74899.0677   168%     -  165s
     0     0 74899.0677    0  264 27952.3095 74899.0677   168%     -  180s
     0     0 74899.0677    0  262 27952.3095 74899.0677   168%     -  186s
     0     0 74899.0677    0  265 27952.3095 74899.0677   168%     -  188s
     0     0 74898.1724    0  267 27952.3095 74898.1724   168%     -  190s
     0     0 74895.8690    0  267 27952.3095 74895.8690   168%     -  190s
     0     0 74895.6436    0  241 27952.3095 74895.6436   168%     -  191s
     0     0 70495.0654    0  280 27952.3095 70495.0654   152%     -  290s
H    0     0                    34247.524821 70495.0654   106%     -  291s
H    0     0                    34257.757632 70495.0654   106%     -  291s
     0     0 69876.5647    0  277 34257.7576 69876.5647   104%     -  335s
     0     0 69368.3781    0  286 34257.7576 69368.3781   102%     -  368s
     0     0 69135.0129    0  283 34257.7576 69135.0129   102%     -  386s
     0     0 69039.3455    0  283 34257.7576 69039.3455   102%     -  398s
     0     0 69008.3297    0  289 34257.7576 69008.3297   101%     -  410s
     0     0 68978.8670    0  336 34257.7576 68978.8670   101%     -  424s
H    0     0                    34408.389605 68948.8698   100%     -  431s
H    0     0                    36313.088910 68948.8698  89.9%     -  431s
     0     0 68948.8698    0  341 36313.0889 68948.8698  89.9%     -  431s
     0     0 68930.4477    0  290 36313.0889 68930.4477  89.8%     -  436s
     0     0 68928.6864    0  293 36313.0889 68928.6864  89.8%     -  438s
     0     0 68926.0767    0  286 36313.0889 68926.0767  89.8%     -  441s
     0     0 68920.3079    0  285 36313.0889 68920.3079  89.8%     -  442s
     0     0 68919.1997    0  285 36313.0889 68919.1997  89.8%     -  443s
     0     0 66678.9055    0  339 36313.0889 66678.9055  83.6%     -  542s
H    0     0                    36574.736609 66678.3947  82.3%     -  543s
H    0     0                    38260.766639 66318.4431  73.3%     -  578s
     0     0 66318.4431    0  346 38260.7666 66318.4431  73.3%     -  578s
     0     0 66152.1301    0  319 38260.7666 66152.1301  72.9%     -  604s
     0     0 66049.1832    0  366 38260.7666 66049.1832  72.6%     -  621s
     0     0 66033.8924    0  327 38260.7666 66033.8924  72.6%     -  628s
     0     0 66021.5910    0  316 38260.7666 66021.5910  72.6%     -  636s
     0     0 65991.7184    0  324 38260.7666 65991.7184  72.5%     -  642s
     0     0 65970.3156    0  323 38260.7666 65970.3156  72.4%     -  648s
     0     0 65934.3966    0  328 38260.7666 65934.3966  72.3%     -  656s
     0     0 65930.4130    0  331 38260.7666 65930.4130  72.3%     -  659s
     0     0 65927.7303    0  332 38260.7666 65927.7303  72.3%     -  662s
     0     0 65921.8093    0  337 38260.7666 65921.8093  72.3%     -  666s
H    0     0                    38440.446763 65897.3307  71.4%     -  673s
H    0     0                    38558.955500 65897.3307  70.9%     -  673s
H    0     0                    38653.391969 65897.3307  70.5%     -  673s
H    0     0                    38667.403739 65897.3307  70.4%     -  673s
     0     0 65897.3307    0  327 38667.4037 65897.3307  70.4%     -  673s
     0     0 65886.8722    0  337 38667.4037 65886.8722  70.4%     -  677s
     0     0 65864.5309    0  336 38667.4037 65864.5309  70.3%     -  683s
     0     0 65852.5754    0  336 38667.4037 65852.5754  70.3%     -  686s
     0     0 65847.1519    0  338 38667.4037 65847.1519  70.3%     -  688s
     0     0 65846.0319    0  335 38667.4037 65846.0319  70.3%     -  690s
     0     0 64973.9732    0  391 38667.4037 64973.9732  68.0%     -  738s
     0     0 64801.7202    0  415 38667.4037 64801.7202  67.6%     -  762s
     0     0 64750.8762    0  408 38667.4037 64750.8762  67.5%     -  774s
     0     0 64726.7525    0  412 38667.4037 64726.7525  67.4%     -  781s
     0     0 64716.9700    0  421 38667.4037 64716.9700  67.4%     -  786s
H    0     0                    38779.486070 64713.8561  66.9%     -  788s
     0     0 64713.8561    0  430 38779.4861 64713.8561  66.9%     -  788s
     0     0 64704.7414    0  427 38779.4861 64704.7414  66.9%     -  793s
     0     0 64703.2493    0  438 38779.4861 64703.2493  66.8%     -  794s
H    0     0                    38952.615650 64585.2405  65.8%     -  817s
     0     0 64585.2405    0  383 38952.6156 64585.2405  65.8%     -  818s
     0     0 64536.3690    0  385 38952.6156 64536.3690  65.7%     -  834s
     0     0 64504.3173    0  378 38952.6156 64504.3173  65.6%     -  841s
     0     0 64487.0725    0  381 38952.6156 64487.0725  65.6%     -  850s
     0     0 64476.6025    0  387 38952.6156 64476.6025  65.5%     -  855s
     0     0 64473.9247    0  446 38952.6156 64473.9247  65.5%     -  859s
     0     0 64473.1940    0  391 38952.6156 64473.1940  65.5%     -  860s
     0     0 64457.0159    0  410 38952.6156 64457.0159  65.5%     -  867s
     0     0 64445.6808    0  411 38952.6156 64445.6808  65.4%     -  874s
     0     0 64443.3444    0  350 38952.6156 64443.3444  65.4%     -  877s
     0     0 64422.6414    0  365 38952.6156 64422.6414  65.4%     -  887s
     0     0 64413.4050    0  359 38952.6156 64413.4050  65.4%     -  893s
     0     0 64410.1090    0  409 38952.6156 64410.1090  65.4%     -  897s
     0     0 64408.9535    0  365 38952.6156 64408.9535  65.4%     -  898s
     0     0 64392.3604    0  403 38952.6156 64392.3604  65.3%     -  906s
     0     0 64386.4064    0  406 38952.6156 64386.4064  65.3%     -  914s
     0     0 64384.3740    0  401 38952.6156 64384.3740  65.3%     -  916s
     0     0 64381.3929    0  400 38952.6156 64381.3929  65.3%     -  922s
     0     0 64379.7972    0  401 38952.6156 64379.7972  65.3%     -  923s
     0     0 64377.4869    0  419 38952.6156 64377.4869  65.3%     -  933s
     0     0 64376.7837    0  447 38952.6156 64376.7837  65.3%     -  936s
     0     0 64373.0699    0  443 38952.6156 64373.0699  65.3%     -  943s
     0     0 64372.9454    0  443 38952.6156 64372.9454  65.3%     -  947s
H    0     0                    39092.748281 64372.9454  64.7%     - 1029s
H    0     0                    39119.682644 64372.9454  64.6%     - 1029s
H    0     0                    39206.655858 64372.9454  64.2%     - 1029s
H    0     0                    39254.232641 64372.9454  64.0%     - 1029s
H    0     0                    39377.445177 64372.9454  63.5%     - 1029s
H    0     0                    39397.351087 64372.9454  63.4%     - 1029s
     0     2 64372.9454    0  443 39397.3511 64372.9454  63.4%     - 1130s
     1     3 63590.3084    1  364 39397.3511 64371.9331  63.4% 21257 1177s
     2     4 64269.4440    1  430 39397.3511 64269.4440  63.1% 14892 1197s
     3     8 63968.1323    2  363 39397.3511 64269.3777  63.1% 13467 1224s
     7    14 62434.0844    3  349 39397.3511 64202.1380  63.0% 11793 1311s
    13    28 62095.4891    4  359 39397.3511 63870.9610  62.1% 15959 1357s
    27    42 62988.9095    5  373 39397.3511 63580.1194  61.4% 20656 1457s
    41    74 62593.0281    6  381 39397.3511 63580.1194  61.4% 21732 1628s
    73   167 62424.3644    7  334 39397.3511 63426.6156  61.0% 19039 1808s
   166   273 62393.0545   10  356 39397.3511 63423.6929  61.0% 11525 1877s
   272   334 62128.8138   13  339 39397.3511 63423.6929  61.0%  8911 1932s
   333   402 61489.3288   14  308 39397.3511 63423.6929  61.0%  8394 1980s
   401   456 61882.5482   15  321 39397.3511 63423.6929  61.0%  7851 2028s
   455   487 61553.2230   18  289 39397.3511 63423.6929  61.0%  7637 2070s
   486   514 61457.7165   19  281 39397.3511 63423.6929  61.0%  7664 2118s
   513   543 61227.7502   20  274 39397.3511 63423.6929  61.0%  7602 2179s
   542   575 61099.8258   21  276 39397.3511 63423.6929  61.0%  7508 2283s
   574   611 61027.9789   22  267 39397.3511 63423.6929  61.0%  7608 2327s
   610   646 60998.1013   23  269 39397.3511 63423.6929  61.0%  7526 2353s
   645   678 60901.5321   24  268 39397.3511 63423.6929  61.0%  7501 2380s
   677   709 60840.4743   25  263 39397.3511 63423.6929  61.0%  7468 2404s
   712   741 60567.6838   26  261 39397.3511 63423.6929  61.0%  7481 2432s
   744   770 60382.1218   27  257 39397.3511 63423.6929  61.0%  7436 2455s
   777   802 60309.1287   28  258 39397.3511 63423.6929  61.0%  7428 2480s
   809   834 60272.0073   29  258 39397.3511 63423.6929  61.0%  7424 2509s
   841   866 60151.8258   30  246 39397.3511 63423.6929  61.0%  7403 2548s
   873   897 60134.2258   31  245 39397.3511 63423.6929  61.0%  7363 2576s
   910   934 60063.5737   32  252 39397.3511 63423.6929  61.0%  7374 2602s
   947   966 59693.9445   33  250 39397.3511 63423.6929  61.0%  7329 2635s
   979  1000 59610.2221   34  249 39397.3511 63423.6929  61.0%  7317 2669s
  1013  1042 59483.0820   35  278 39397.3511 63423.6929  61.0%  7263 2706s
  1063  1109 59455.5334   36  245 39397.3511 63423.6929  61.0%  7277 2748s
  1130  1199 59420.9273   37  271 39397.3511 63423.6929  61.0%  7239 2789s
  1220  1289 59254.7650   38  247 39397.3511 63423.6929  61.0%  7108 2832s
  1312  1405 58967.5639   45  233 39397.3511 63423.6929  61.0%  7030 2873s
  1430  1522 58664.5293   49  220 39397.3511 63423.6929  61.0%  6911 2918s
  1555  1663 58209.9368   54  242 39397.3511 63423.6929  61.0%  6828 2968s
  1704  1802 56719.1859   57  223 39397.3511 63423.6929  61.0%  6648 3025s
  1863  1890 56265.9077   61  203 39397.3511 63423.6929  61.0%  6503 3090s
  2006  1959 52281.9526   66  221 39397.3511 63423.6929  61.0%  6507 3146s
  2145  2018 43444.3541   69  168 39397.3511 63423.6929  61.0%  6557 3210s
  2271  2044 39874.2999   72  138 39397.3511 63370.2879  60.8%  6609 3268s
  2309  2075     cutoff   73      39397.3511 63370.2879  60.8%  6792 3322s
  2357  2111 60779.4984   15  345 39397.3511 63370.2879  60.8%  6909 3382s
  2411  2163 57658.7263   16  297 39397.3511 63370.2879  60.8%  7015 3439s
  2473  2214 55774.1705   17  320 39397.3511 63370.2879  60.8%  7101 3502s
  2537  2252 55765.2689   18  316 39397.3511 63370.2879  60.8%  7133 3559s
  2597  2312 55379.6347   19  320 39397.3511 63370.2879  60.8%  7200 3600s

Cutting planes:
  Learned: 1
  Gomory: 46
  Implied bound: 154
  MIR: 2950
  Flow cover: 2533
  RLT: 64
  Relax-and-lift: 394
  PSD: 1

Explored 2669 nodes (19681477 simplex iterations) in 3600.07 seconds (5833.68 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 39397.4 39377.4 39254.2 ... 38653.4

Time limit reached
Best objective 3.939735108703e+04, best bound 6.337028785126e+04, gap 60.8491%
  WARNING: Time limit reached. Using best solution found (gap: 60.85%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.11s
  Master Objective (UB) = 39397.35, θ = 228213.71
  Upper Bound (UB) = 39397.35

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 228213.71
  [DEBUG]   ✓ Scenario 0: θ = 228213.71 ≤ Q = 228213.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 228213.71 ≤ Q = 228213.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 228213.71 ≤ Q = 228213.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 228213.71 ≤ Q = 228213.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 228213.71 ≤ Q = 228213.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 228213.71 ≤ Q = 228213.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 228213.71 ≤ Q = 228213.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 228213.71 ≤ Q = 228213.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 228213.71 ≤ Q = 228213.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 228213.71 ≤ Q = 228213.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 228213.71 ≤ Q = 228213.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 228213.71 ≤ Q = 228213.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 228213.71 ≤ Q = 228213.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 228213.71 ≤ Q = 228213.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 228213.71 ≤ Q = 228213.71 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 15] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x4cd07e7a
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xb32f8186
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.400020e+13
Presolve removed 2586 rows and 1876 columns
Presolve time: 0.01s
Presolved: 507 rows, 513 columns, 1439 nonzeros
Found heuristic solution: objective 6812025.9704
Variable types: 349 continuous, 164 integer (164 binary)

Root relaxation: objective -1.759030e+05, 248 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -175902.98    0  126 6812025.97 -175902.98   103%     -    0s
H    0     0                    -140856.4564 -175902.98  24.9%     -    0s
H    0     0                    -141143.3190 -175902.98  24.6%     -    0s
     0     0 -155533.17    0   43 -141143.32 -155533.17  10.2%     -    0s
H    0     0                    -154210.5757 -155512.57  0.84%     -    0s
H    0     0                    -154811.2814 -155512.57  0.45%     -    0s
H    0     0                    -155028.5760 -155473.08  0.29%     -    0s
     0     0 -155473.08    0   34 -155028.58 -155473.08  0.29%     -    0s
     0     0 -155468.78    0   28 -155028.58 -155468.78  0.28%     -    0s
     0     0 -155198.38    0    8 -155028.58 -155198.38  0.11%     -    0s
     0     0 -155175.86    0    9 -155028.58 -155175.86  0.10%     -    0s
H    0     0                    -155115.0414 -155175.86  0.04%     -    0s
     0     0 -155162.55    0    2 -155115.04 -155162.55  0.03%     -    0s
     0     0 -155158.67    0    4 -155115.04 -155158.67  0.03%     -    0s
     0     0 -155158.67    0    3 -155115.04 -155158.67  0.03%     -    0s
H    0     0                    -155118.6556 -155158.67  0.03%     -    0s
H    0     0                    -155151.5280 -155158.67  0.00%     -    0s

Explored 1 nodes (503 simplex iterations) in 0.16 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -155152 -155119 -155115 ... 1.40002e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.551515279569e+05, best bound -1.551586679991e+05, gap 0.0046%
  Subproblem solved in 0.19s
  Worst-case operational profit (Z_SP) = 216295.67
  Scenario: 18 demand increases, 42 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -155151.53
  [DEBUG]   S×d_nominal = 371447.20
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 371447.20 + -155151.53 = 216295.67
  [DEBUG]   Current θ from Master = 228213.71
  [DEBUG]   ⚠️  Z_SP ≤ θ by 11918.04 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 27479.31
  Lower Bound (LB) = 38407.27
  Gap (UB-LB) = 990.0810, Absolute Gap = 990.0810, Relative Gap = 0.025131
  Not converged yet (gap = 990.08 > ε = 200)

  [DEBUG] Adding NEW scenario 15 to Master Problem...
  [DEBUG] New scenario pattern: 18 increases, 42 decreases
    [DEBUG] Scenario 15 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 15 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 15]
    [DEBUG]   - Total constraints in model: 246023
    [DEBUG]   - Total variables in model: 102100
  [DEBUG] Total scenarios in Master: 16
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 16
================================================================================
[Iteration 16] Solving Master Problem...
  Current scenarios in Master: 16
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 246023 rows, 102100 columns and 697311 nonzeros
Model fingerprint: 0xb0799b88
Variable types: 99841 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 110028 rows and 44678 columns
Presolve time: 4.47s
Presolved: 135995 rows, 57422 columns, 837046 nonzeros
Variable types: 55163 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -309441.0403
Found heuristic solution: objective -183060.7998

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.73s

Barrier statistics:
 Dense cols : 702
 AA' NZ     : 5.888e+06
 Factor NZ  : 1.336e+07 (roughly 200 MB of memory)
 Factor Ops : 2.997e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.86987670e+07  2.54554691e+08  1.49e+05 1.69e+01  8.99e+04     8s
   1  -1.46495412e+07  2.38364627e+08  1.07e+05 1.04e+02  6.40e+04     8s
   2  -4.67090178e+06  1.91027136e+08  3.40e+04 7.37e-01  2.17e+04     8s
   3  -1.09986416e+06  1.37604678e+08  3.91e+03 1.18e+00  2.94e+03     8s
   4  -6.23094030e+05  7.76082432e+07  6.36e+02 3.51e-01  6.67e+02     9s
   5  -5.04978827e+05  4.37564814e+07  2.78e+02 1.63e-01  3.15e+02     9s
   6  -3.82415869e+05  3.31048242e+07  9.21e+01 1.13e-01  1.77e+02     9s
   7  -3.28769736e+05  3.02893549e+07  5.17e+01 1.03e-01  1.46e+02     9s
   8  -2.29067112e+05  1.94064251e+07  1.67e+01 6.17e-02  8.48e+01     9s
   9  -1.70144226e+05  1.07140628e+07  9.46e+00 3.25e-02  4.59e+01     9s
  10  -1.38406248e+05  6.20583955e+06  6.07e+00 1.84e-02  2.64e+01     9s
  11  -1.07294182e+05  3.67647331e+06  3.64e+00 1.07e-02  1.56e+01     9s
  12  -6.43590180e+04  2.30038413e+06  1.23e+00 6.55e-03  9.60e+00     9s
  13  -3.63149528e+04  6.75581463e+05  5.79e-01 1.91e-03  2.88e+00     9s
  14  -5.87474545e+02  3.51418971e+05  2.18e-01 9.93e-04  1.42e+00    10s
  15   1.12543296e+04  2.84524324e+05  1.74e-01 8.82e-04  1.10e+00    10s
  16   3.38646113e+04  2.10449060e+05  1.11e-01 1.52e-03  7.12e-01    10s
  17   3.82432659e+04  1.94854928e+05  1.00e-01 1.37e-03  6.32e-01    10s
  18   4.64766603e+04  1.67948522e+05  7.78e-02 1.40e-03  4.90e-01    10s
  19   5.69689525e+04  1.33565658e+05  4.97e-02 2.10e-03  3.09e-01    10s
  20   5.91213801e+04  1.16138965e+05  4.47e-02 1.68e-03  2.30e-01    10s
  21   6.53877391e+04  1.07508404e+05  3.09e-02 1.43e-03  1.70e-01    10s
  22   6.79878456e+04  1.02640496e+05  2.57e-02 1.25e-03  1.40e-01    10s
  23   7.03008744e+04  9.97485974e+04  2.10e-02 1.10e-03  1.19e-01    11s
  24   7.19173270e+04  9.38182566e+04  1.76e-02 7.54e-04  8.84e-02    11s
  25   7.44175867e+04  9.22502420e+04  1.32e-02 6.48e-04  7.19e-02    11s
  26   7.51574176e+04  9.03116954e+04  1.19e-02 5.25e-04  6.11e-02    11s
  27   7.55798670e+04  8.89072662e+04  1.12e-02 4.27e-04  5.38e-02    11s
  28   7.63754994e+04  8.79668846e+04  9.89e-03 3.69e-04  4.68e-02    11s
  29   7.81690709e+04  8.73101439e+04  6.92e-03 3.22e-04  3.69e-02    11s
  30   7.87064291e+04  8.70182877e+04  6.04e-03 3.03e-04  3.35e-02    12s
  31   7.88455602e+04  8.64329176e+04  5.82e-03 2.63e-04  3.06e-02    12s
  32   7.95963472e+04  8.51763369e+04  4.59e-03 1.77e-04  2.25e-02    12s
  33   8.00813463e+04  8.47077157e+04  3.86e-03 1.43e-04  1.87e-02    12s
  34   8.01410495e+04  8.44780093e+04  3.77e-03 1.27e-04  1.75e-02    12s
  35   8.07845240e+04  8.39512512e+04  2.77e-03 8.93e-05  1.28e-02    12s
  36   8.14103592e+04  8.36641544e+04  1.85e-03 6.85e-05  9.09e-03    12s
  37   8.17017792e+04  8.34361369e+04  1.41e-03 5.20e-05  7.00e-03    13s
  38   8.20179356e+04  8.32498640e+04  9.27e-04 3.89e-05  4.97e-03    13s
  39   8.21713397e+04  8.31729038e+04  7.14e-04 3.39e-05  4.04e-03    13s
  40   8.22870973e+04  8.30766480e+04  5.37e-04 2.73e-05  3.18e-03    13s
  41   8.24252743e+04  8.29161898e+04  3.45e-04 1.56e-05  1.98e-03    13s
  42   8.24997265e+04  8.28231430e+04  2.42e-04 9.25e-06  1.30e-03    13s
  43   8.25723026e+04  8.28022514e+04  1.44e-04 7.84e-06  9.27e-04    14s
  44   8.26192459e+04  8.27504994e+04  8.61e-05 4.18e-06  5.29e-04    14s
  45   8.26394066e+04  8.27314772e+04  6.12e-05 2.84e-06  3.71e-04    14s
  46   8.26672138e+04  8.27044357e+04  2.63e-05 9.84e-07  1.50e-04    14s
  47   8.26857382e+04  8.26932616e+04  3.74e-06 2.28e-07  3.03e-05    14s
  48   8.26894793e+04  8.26897486e+04  1.31e-07 5.95e-07  1.09e-06    14s
  49   8.26896774e+04  8.26896774e+04  5.62e-11 1.14e-09  6.44e-11    14s

Barrier solved model in 49 iterations and 14.40 seconds (13.78 work units)
Optimal objective 8.26896774e+04


Root crossover log...

  120111 DPushes remaining with DInf 0.0000000e+00                14s
   43989 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                19s

    2057 PPushes remaining with PInf 9.1954217e-06                19s
       0 PPushes remaining with PInf 0.0000000e+00                19s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.7772661e-10     19s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   50428    8.2689677e+04   0.000000e+00   0.000000e+00     19s
   50428    8.2689677e+04   0.000000e+00   0.000000e+00     19s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 8.268968e+04, 50428 iterations, 13.48 seconds (16.57 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 82689.6774    0  167 -183060.80 82689.6774   145%     -   19s
H    0     0                    -115922.4230 82689.6774   171%     -   20s
H    0     0                    -114282.9329 82689.6774   172%     -   21s
H    0     0                    -114121.9939 82689.6774   172%     -   21s
H    0     0                    -86480.28203 82689.6774   196%     -   21s
H    0     0                    -9424.336276 82689.6774   977%     -   22s
H    0     0                    19811.831509 82689.6774   317%     -   23s
H    0     0                    23291.352788 82689.6774   255%     -   23s
H    0     0                    23470.836934 82689.6774   252%     -   23s
H    0     0                    23717.834946 82689.6774   249%     -   23s
H    0     0                    23732.915444 82689.6774   248%     -   23s
H    0     0                    23784.625793 82689.6774   248%     -   23s
     0     0 76019.9045    0  220 23784.6258 76019.9045   220%     -   89s
     0     0 75590.8308    0  215 23784.6258 75590.8308   218%     -  130s
     0     0 75508.7452    0  216 23784.6258 75508.7452   217%     -  140s
     0     0 75489.0393    0  214 23784.6258 75489.0393   217%     -  145s
     0     0 75476.2248    0  220 23784.6258 75476.2248   217%     -  153s
     0     0 75364.3416    0  225 23784.6258 75364.3416   217%     -  175s
     0     0 75071.5439    0  212 23784.6258 75071.5439   216%     -  213s
     0     0 74972.4611    0  220 23784.6258 74972.4611   215%     -  226s
     0     0 74942.2233    0  228 23784.6258 74942.2233   215%     -  231s
     0     0 74936.7484    0  226 23784.6258 74936.7484   215%     -  234s
     0     0 74936.4495    0  229 23784.6258 74936.4495   215%     -  234s
     0     0 70798.6702    0  294 23784.6258 70798.6702   198%     -  319s
H    0     0                    32154.849713 70798.4396   120%     -  320s
     0     0 70095.5545    0  340 32154.8497 70095.5545   118%     -  365s
     0     0 69742.1978    0  311 32154.8497 69742.1978   117%     -  395s
     0     0 69633.3750    0  318 32154.8497 69633.3750   117%     -  409s
     0     0 69597.5704    0  321 32154.8497 69597.5704   116%     -  424s
     0     0 69590.3031    0  322 32154.8497 69590.3031   116%     -  428s
     0     0 69527.5418    0  330 32154.8497 69527.5418   116%     -  446s
     0     0 69504.0645    0  329 32154.8497 69504.0645   116%     -  450s
     0     0 69501.5094    0  330 32154.8497 69501.5094   116%     -  452s
     0     0 69490.3046    0  327 32154.8497 69490.3046   116%     -  455s
     0     0 69486.0138    0  330 32154.8497 69486.0138   116%     -  458s
     0     0 69480.8198    0  333 32154.8497 69480.8198   116%     -  461s
     0     0 69480.6360    0  329 32154.8497 69480.6360   116%     -  462s
     0     0 67243.8486    0  293 32154.8497 67243.8486   109%     -  561s
     0     0 66663.2331    0  318 32154.8497 66663.2331   107%     -  605s
     0     0 66455.3750    0  325 32154.8497 66455.3750   107%     -  633s
     0     0 66382.3051    0  336 32154.8497 66382.3051   106%     -  647s
     0     0 66351.9430    0  342 32154.8497 66351.9430   106%     -  655s
     0     0 66293.3953    0  335 32154.8497 66293.3953   106%     -  666s
     0     0 66227.2960    0  349 32154.8497 66227.2960   106%     -  682s
     0     0 66214.0365    0  365 32154.8497 66214.0365   106%     -  689s
     0     0 66209.2468    0  376 32154.8497 66209.2468   106%     -  694s
     0     0 66200.2506    0  375 32154.8497 66200.2506   106%     -  699s
     0     0 66197.3017    0  377 32154.8497 66197.3017   106%     -  702s
     0     0 66192.5917    0  349 32154.8497 66192.5917   106%     -  704s
     0     0 66192.4691    0  348 32154.8497 66192.4691   106%     -  705s
     0     0 65285.5676    0  385 32154.8497 65285.5676   103%     -  771s
H    0     0                    32183.288987 65285.0104   103%     -  772s
     0     0 65097.6484    0  391 32183.2890 65097.6484   102%     -  799s
     0     0 65044.9742    0  362 32183.2890 65044.9742   102%     -  812s
     0     0 65031.3637    0  357 32183.2890 65031.3637   102%     -  820s
     0     0 65027.3334    0  352 32183.2890 65027.3334   102%     -  824s
     0     0 65023.1087    0  348 32183.2890 65023.1087   102%     -  828s
     0     0 65019.7192    0  375 32183.2890 65019.7192   102%     -  833s
     0     0 65018.5515    0  376 32183.2890 65018.5515   102%     -  835s
     0     0 64873.5129    0  443 32183.2890 64873.5129   102%     -  864s
     0     0 64833.5729    0  451 32183.2890 64833.5729   101%     -  883s
     0     0 64811.0542    0  458 32183.2890 64811.0542   101%     -  892s
     0     0 64799.0437    0  423 32183.2890 64799.0437   101%     -  901s
     0     0 64793.6476    0  473 32183.2890 64793.6476   101%     -  908s
     0     0 64790.2507    0  470 32183.2890 64790.2507   101%     -  911s
     0     0 64787.6423    0  447 32183.2890 64787.6423   101%     -  914s
     0     0 64785.7686    0  448 32183.2890 64785.7686   101%     -  917s
     0     0 64693.1350    0  369 32183.2890 64693.1350   101%     -  937s
     0     0 64670.7303    0  363 32183.2890 64670.7303   101%     -  947s
     0     0 64662.5110    0  369 32183.2890 64662.5110   101%     -  953s
     0     0 64659.3456    0  360 32183.2890 64659.3456   101%     -  956s
     0     0 64655.6110    0  393 32183.2890 64655.6110   101%     -  962s
     0     0 64650.6783    0  395 32183.2890 64650.6783   101%     -  967s
     0     0 64645.6102    0  357 32183.2890 64645.6102   101%     -  971s
     0     0 64640.1771    0  437 32183.2890 64640.1771   101%     -  976s
     0     0 64637.0542    0  390 32183.2890 64637.0542   101%     -  978s
     0     0 64634.6188    0  395 32183.2890 64634.6188   101%     -  979s
     0     0 64591.6939    0  411 32183.2890 64591.6939   101%     -  997s
     0     0 64576.2327    0  415 32183.2890 64576.2327   101%     - 1006s
     0     0 64570.0288    0  407 32183.2890 64570.0288   101%     - 1010s
     0     0 64567.8332    0  412 32183.2890 64567.8332   101%     - 1012s
     0     0 64522.4439    0  405 32183.2890 64522.4439   100%     - 1027s
     0     0 64493.1511    0  413 32183.2890 64493.1511   100%     - 1037s
     0     0 64488.2495    0  418 32183.2890 64488.2495   100%     - 1041s
     0     0 64486.4968    0  415 32183.2890 64486.4968   100%     - 1044s
     0     0 64475.9305    0  373 32183.2890 64475.9305   100%     - 1054s
     0     0 64467.9718    0  373 32183.2890 64467.9718   100%     - 1062s
     0     0 64466.7773    0  369 32183.2890 64466.7773   100%     - 1065s
     0     0 64455.6441    0  398 32183.2890 64455.6441   100%     - 1076s
     0     0 64449.7478    0  370 32183.2890 64449.7478   100%     - 1084s
     0     0 64448.5232    0  369 32183.2890 64448.5232   100%     - 1087s
     0     0 64442.0243    0  369 32183.2890 64442.0243   100%     - 1095s
     0     0 64433.9101    0  357 32183.2890 64433.9101   100%     - 1103s
     0     0 64431.8087    0  364 32183.2890 64431.8087   100%     - 1108s
     0     0 64419.2298    0  441 32183.2890 64419.2298   100%     - 1118s
     0     0 64418.8389    0  441 32183.2890 64418.8389   100%     - 1123s
H    0     0                    36482.954941 64418.1418  76.6%     - 1345s
H    0     0                    36523.211927 64418.1418  76.4%     - 1350s
H    0     0                    36570.410160 64418.1418  76.1%     - 1350s
H    0     0                    37641.527832 64418.1418  71.1%     - 1353s
     0     2 64418.1418    0  441 37641.5278 64418.1418  71.1%     - 1357s
     1     3 63509.8762    1  352 37641.5278 64418.1418  71.1% 21976 1423s
     2     4 64342.5065    1  367 37641.5278 64342.5065  70.9% 12832 1448s
     3     6 64219.6256    2  361 37641.5278 64341.9409  70.9% 12713 1492s
     5    11 64119.0729    3  392 37641.5278 64341.9409  70.9% 13480 1545s
    10    22 63927.5108    4  389 37641.5278 64164.5492  70.5% 13097 1610s
    21    33 63755.4948    5  343 37641.5278 64067.2502  70.2% 21263 1742s
    32    64 63380.2875    6  336 37641.5278 64067.2502  70.2% 20333 1951s
H   36    64                    37673.505056 64067.2502  70.1% 19834 1951s
H   41    64                    38230.492175 64067.2502  67.6% 19734 1951s
    63    96 62960.9721    7  329 38230.4922 63921.3729  67.2% 24897 2039s
    95   128 62838.3834    8  316 38230.4922 63904.2727  67.2% 22359 2101s
H   98   128                    38356.960294 63904.2727  66.6% 21830 2101s
H   99   128                    38367.675974 63904.2727  66.6% 21708 2101s
H  104   128                    38618.320805 63904.2727  65.5% 20942 2101s
H  117   128                    38745.183049 63904.2727  64.9% 19401 2101s
H  118   128                    38894.116453 63904.2671  64.3% 19450 2101s
H  123   128                    39115.249246 63904.2671  63.4% 19002 2101s
H  124   128                    39198.992144 63904.2671  63.0% 18948 2101s
   127   160 62691.3484    9  334 39198.9921 63904.2671  63.0% 18811 2194s
H  141   160                    39215.075521 63904.2671  63.0% 17893 2194s
   159   298 62689.8634   10  319 39215.0755 63904.2671  63.0% 16669 2308s
   297   363 61161.0941   14  285 39215.0755 63904.2671  63.0% 11532 2380s
   362   434 62222.7176   15  309 39215.0755 63904.2671  63.0% 10653 2443s
   433   488 61832.7109   16  296 39215.0755 63904.2671  63.0%  9949 2496s
   487   549 61579.1892   18  282 39215.0755 63904.2671  63.0%  9708 2536s
   548   605 61182.2800   20  282 39215.0755 63904.2671  63.0%  9666 2580s
   604   660 60613.1338   21  271 39215.0755 63904.2671  63.0%  9623 2630s
   659   721 60419.0585   22  265 39215.0755 63904.2671  63.0%  9796 2669s
   720   793 60244.7651   24  259 39215.0755 63904.2671  63.0%  9683 2708s
   792   859 59883.9352   26  287 39215.0755 63904.2671  63.0%  9518 2744s
   860   937 59843.4473   27  275 39215.0755 63904.2671  63.0%  9262 2781s
   938  1022 59662.9377   31  271 39215.0755 63904.2671  63.0%  9040 2825s
  1025  1053 59501.8202   35  275 39215.0755 63904.2671  63.0%  8905 2858s
H 1027  1053                    39244.652003 63904.2671  62.8%  8892 2858s
  1058  1144 59489.0164   36  271 39244.6520 63904.2671  62.8%  8860 2900s
  1153  1237 59036.1084   37  263 39244.6520 63904.2671  62.8%  8663 2942s
  1258  1343 58204.9749   40  264 39244.6520 63904.2671  62.8%  8552 2988s
  1380  1454 57751.8333   43  259 39244.6520 63904.2671  62.8%  8315 3030s
  1511  1516 57100.7975   46  253 39244.6520 63904.2671  62.8%  8079 3076s
  1611  1583 53786.7300   48  178 39244.6520 63904.2671  62.8%  8007 3124s
  1712  1624 53528.1786   50  170 39244.6520 63904.2671  62.8%  7971 3175s
  1790  1707 48714.3038   52  180 39244.6520 63826.5316  62.6%  8036 3232s
H 1853  1707                    39274.820162 63826.5316  62.5%  7991 3232s
H 1863  1707                    39670.481287 63826.5316  60.9%  7965 3232s
  1888  1829 infeasible   57      39670.4813 63826.5316  60.9%  7934 3296s
  2036  1995 43474.7331   63  205 39670.4813 63826.5316  60.9%  7792 3357s
  2224  2198 42839.2746   75  176 39670.4813 63826.5316  60.9%  7525 3420s
  2465  2284 42073.6074   88  115 39670.4813 63826.5316  60.9%  7179 3477s
H 2592  2277                    39812.818689 63826.5316  60.3%  7036 3477s
  2593  2409 41111.9866   98  105 39812.8187 63826.5316  60.3%  7035 3544s
  2819  2473 infeasible  111      39812.8187 63826.5316  60.3%  6825 3600s

Cutting planes:
  Learned: 2
  Gomory: 18
  Implied bound: 105
  MIR: 3067
  Flow cover: 2672
  RLT: 50
  Relax-and-lift: 528

Explored 2985 nodes (20713195 simplex iterations) in 3600.12 seconds (5232.53 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 39812.8 39670.5 39274.8 ... 38618.3

Time limit reached
Best objective 3.981281868878e+04, best bound 6.337989975394e+04, gap 59.1947%
  WARNING: Time limit reached. Using best solution found (gap: 59.19%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.13s
  Master Objective (UB) = 39812.82, θ = 227970.30
  Upper Bound (UB) = 39812.82

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 227970.30
  [DEBUG]   ✓ Scenario 0: θ = 227970.30 ≤ Q = 227970.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 227970.30 ≤ Q = 227970.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 227970.30 ≤ Q = 227970.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 227970.30 ≤ Q = 227970.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 227970.30 ≤ Q = 227970.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 227970.30 ≤ Q = 227970.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 227970.30 ≤ Q = 227970.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 227970.30 ≤ Q = 227970.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 227970.30 ≤ Q = 227970.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 227970.30 ≤ Q = 227970.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 227970.30 ≤ Q = 227970.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 227970.30 ≤ Q = 227970.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 227970.30 ≤ Q = 227970.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 227970.30 ≤ Q = 227970.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 227970.30 ≤ Q = 227970.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 227970.30 ≤ Q = 227970.30 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 16] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x4f4cb57a
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x4f4cb57a
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.390380e+13
Presolve removed 2586 rows and 1877 columns
Presolve time: 0.01s
Presolved: 507 rows, 512 columns, 1435 nonzeros
Found heuristic solution: objective 6659449.9527
Variable types: 348 continuous, 164 integer (164 binary)

Root relaxation: objective -1.741391e+05, 265 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -174139.11    0  125 6659449.95 -174139.11   103%     -    0s
H    0     0                    -140858.1713 -174139.11  23.6%     -    0s
H    0     0                    -141137.8678 -174139.11  23.4%     -    0s
     0     0 -154689.37    0   85 -141137.87 -154689.37  9.60%     -    0s
H    0     0                    -150319.5309 -154569.28  2.83%     -    0s
H    0     0                    -152542.6739 -154569.28  1.33%     -    0s
H    0     0                    -152903.3530 -154569.28  1.09%     -    0s
H    0     0                    -152935.6828 -154569.28  1.07%     -    0s
     0     0 -153569.59    0   81 -152935.68 -153569.59  0.41%     -    0s
     0     0 -153275.37    0   30 -152935.68 -153275.37  0.22%     -    0s
     0     0 -153172.86    0   35 -152935.68 -153172.86  0.16%     -    0s
     0     0 -153167.85    0   29 -152935.68 -153167.85  0.15%     -    0s
     0     0 -153167.02    0   28 -152935.68 -153167.02  0.15%     -    0s
     0     0 -153166.94    0   27 -152935.68 -153166.94  0.15%     -    0s
     0     0 -153164.43    0   27 -152935.68 -153164.43  0.15%     -    0s
     0     0 -153101.69    0   11 -152935.68 -153101.69  0.11%     -    0s
     0     0 -153101.69    0   33 -152935.68 -153101.69  0.11%     -    0s
H    0     0                    -152957.9607 -153101.69  0.09%     -    0s
     0     0 -153040.36    0   10 -152957.96 -153040.36  0.05%     -    0s
H    0     0                    -153027.6443 -153039.47  0.01%     -    0s

Cutting planes:
  Gomory: 14
  Implied bound: 4
  MIR: 18
  Flow cover: 10
  Relax-and-lift: 5

Explored 1 nodes (878 simplex iterations) in 0.21 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -153028 -152958 -152936 ... 1.39038e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.530276442711e+05, best bound -1.530394674748e+05, gap 0.0077%
  Subproblem solved in 0.24s
  Worst-case operational profit (Z_SP) = 218419.56
  Scenario: 28 demand increases, 32 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -153027.64
  [DEBUG]   S×d_nominal = 371447.20
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 371447.20 + -153027.64 = 218419.56
  [DEBUG]   Current θ from Master = 227970.30
  [DEBUG]   ⚠️  Z_SP ≤ θ by 9550.74 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 30262.08
  Lower Bound (LB) = 38407.27
  Gap (UB-LB) = 1405.5486, Absolute Gap = 1405.5486, Relative Gap = 0.035304
  Not converged yet (gap = 1405.55 > ε = 200)

  [DEBUG] Adding NEW scenario 16 to Master Problem...
  [DEBUG] New scenario pattern: 28 increases, 32 decreases
    [DEBUG] Scenario 16 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 16 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 16]
    [DEBUG]   - Total constraints in model: 261313
    [DEBUG]   - Total variables in model: 108340
  [DEBUG] Total scenarios in Master: 17
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 17
================================================================================
[Iteration 17] Solving Master Problem...
  Current scenarios in Master: 17
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 261313 rows, 108340 columns and 740548 nonzeros
Model fingerprint: 0x39e1e95a
Variable types: 106081 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 116896 rows and 47466 columns (presolve time = 5s)...
Presolve removed 116896 rows and 47466 columns
Presolve time: 5.37s
Presolved: 144417 rows, 60874 columns, 888429 nonzeros
Variable types: 58615 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -309441.0403
Found heuristic solution: objective -183060.7998

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.54s

Barrier statistics:
 Dense cols : 694
 AA' NZ     : 6.649e+06
 Factor NZ  : 1.546e+07 (roughly 200 MB of memory)
 Factor Ops : 3.830e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.91232552e+07  2.68542894e+08  1.52e+05 1.67e+01  9.15e+04     8s
   1  -1.50223275e+07  2.52485436e+08  1.10e+05 1.03e+02  6.52e+04     8s
   2  -4.82245232e+06  2.02645865e+08  3.51e+04 8.27e-01  2.23e+04     9s
   3  -1.15986925e+06  1.46765509e+08  4.30e+03 1.24e+00  3.17e+03     9s
   4  -6.31042527e+05  8.64285153e+07  6.23e+02 3.10e-01  6.77e+02     9s
   5  -5.25625999e+05  4.88983822e+07  2.74e+02 1.43e-01  3.23e+02     9s
   6  -4.18286285e+05  3.66619409e+07  1.06e+02 9.89e-02  1.89e+02     9s
   7  -3.63043295e+05  3.33209727e+07  6.07e+01 8.91e-02  1.54e+02     9s
   8  -2.86435778e+05  2.35788201e+07  2.46e+01 5.97e-02  9.96e+01     9s
   9  -2.06693876e+05  1.74153281e+07  1.16e+01 4.31e-02  7.03e+01    10s
  10  -1.83750459e+05  8.79408985e+06  8.93e+00 2.08e-02  3.56e+01    10s
  11  -1.44935694e+05  6.14347803e+06  6.06e+00 1.41e-02  2.46e+01    10s
  12  -1.15206441e+05  3.83849710e+06  4.07e+00 8.60e-03  1.54e+01    10s
  13  -6.52381428e+04  2.21746622e+06  1.21e+00 4.87e-03  8.73e+00    10s
  14  -3.49680713e+04  5.65952088e+05  4.59e-01 1.09e-03  2.29e+00    10s
  15  -1.02060502e+04  3.85111759e+05  2.94e-01 7.32e-04  1.50e+00    10s
  16   9.66029119e+03  3.02155559e+05  2.10e-01 6.16e-04  1.11e+00    11s
  17   2.98871042e+04  2.27171305e+05  1.44e-01 1.74e-03  7.50e-01    11s
  18   3.84171560e+04  1.70245945e+05  1.19e-01 1.48e-03  5.01e-01    11s
  19   4.99471670e+04  1.49089171e+05  8.33e-02 1.59e-03  3.77e-01    11s
  20   5.54349137e+04  1.27233590e+05  6.66e-02 1.89e-03  2.73e-01    11s
  21   6.28199164e+04  1.13523503e+05  4.57e-02 1.79e-03  1.93e-01    11s
  22   6.60182445e+04  1.09457166e+05  3.70e-02 1.57e-03  1.65e-01    11s
  23   6.95261747e+04  1.03103431e+05  2.80e-02 1.22e-03  1.28e-01    12s
  24   7.16555280e+04  1.00291313e+05  2.25e-02 1.07e-03  1.09e-01    12s
  25   7.40017767e+04  9.68819508e+04  1.66e-02 8.80e-04  8.70e-02    12s
  26   7.53831973e+04  9.25223873e+04  1.35e-02 6.26e-04  6.52e-02    12s
  27   7.69876525e+04  8.98966745e+04  1.01e-02 4.69e-04  4.91e-02    12s
  28   7.76800032e+04  8.79606718e+04  8.61e-03 3.57e-04  3.91e-02    13s
  29   7.82731596e+04  8.70218557e+04  7.47e-03 2.94e-04  3.33e-02    13s
  30   7.89208901e+04  8.60788805e+04  6.27e-03 2.32e-04  2.72e-02    13s
  31   7.93826982e+04  8.54742789e+04  5.43e-03 1.95e-04  2.32e-02    13s
  32   7.95238233e+04  8.51650747e+04  5.17e-03 1.76e-04  2.15e-02    13s
  33   8.02501832e+04  8.47574678e+04  3.88e-03 1.58e-04  1.71e-02    14s
  34   8.05912487e+04  8.43834082e+04  3.24e-03 1.31e-04  1.44e-02    14s
  35   8.08053178e+04  8.41375418e+04  2.86e-03 1.09e-04  1.27e-02    14s
  36   8.11462206e+04  8.39828011e+04  2.26e-03 9.86e-05  1.08e-02    14s
  37   8.13110911e+04  8.35148088e+04  1.97e-03 6.73e-05  8.38e-03    14s
  38   8.17860014e+04  8.33675458e+04  1.19e-03 5.85e-05  6.01e-03    15s
  39   8.19212487e+04  8.33055242e+04  9.62e-04 5.43e-05  5.26e-03    15s
  40   8.19865074e+04  8.31584753e+04  8.54e-04 4.40e-05  4.46e-03    15s
  41   8.21219351e+04  8.30117207e+04  6.41e-04 3.34e-05  3.38e-03    15s
  42   8.21401469e+04  8.28585199e+04  6.10e-04 2.35e-05  2.73e-03    15s
  43   8.22530228e+04  8.27461810e+04  4.36e-04 1.51e-05  1.88e-03    16s
  44   8.23850996e+04  8.26942406e+04  2.21e-04 1.13e-05  1.18e-03    16s
  45   8.24401676e+04  8.26142237e+04  1.34e-04 5.61e-06  6.62e-04    16s
  46   8.24844198e+04  8.25650073e+04  6.82e-05 2.14e-06  3.06e-04    16s
  47   8.24980120e+04  8.25587852e+04  4.84e-05 1.72e-06  2.31e-04    17s
  48   8.25135554e+04  8.25479282e+04  2.72e-05 9.63e-07  1.31e-04    17s
  49   8.25238028e+04  8.25442951e+04  1.26e-05 7.18e-07  7.79e-05    17s
  50   8.25288358e+04  8.25396491e+04  5.93e-06 3.97e-07  4.11e-05    17s
  51   8.25291434e+04  8.25375361e+04  5.53e-06 2.56e-07  3.19e-05    17s
  52   8.25312661e+04  8.25357520e+04  2.95e-06 1.34e-07  1.71e-05    18s
  53   8.25332531e+04  8.25342193e+04  3.71e-07 3.20e-08  3.67e-06    18s
  54   8.25336923e+04  8.25337293e+04  6.73e-09 5.32e-09  1.40e-07    18s
  55   8.25337027e+04  8.25337028e+04  7.36e-10 4.55e-09  3.32e-10    18s

Barrier solved model in 55 iterations and 18.10 seconds (15.45 work units)
Optimal objective 8.25337027e+04


Root crossover log...

  127200 DPushes remaining with DInf 0.0000000e+00                18s
   34561 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                24s

    3323 PPushes remaining with PInf 2.8057449e-05                24s
       0 PPushes remaining with PInf 0.0000000e+00                24s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.6502475e+00     24s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   58124    8.2533703e+04   0.000000e+00   3.650248e+00     24s
   58158    8.2533703e+04   0.000000e+00   0.000000e+00     24s
   58158    8.2533703e+04   0.000000e+00   0.000000e+00     24s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 8.253370e+04, 58158 iterations, 17.96 seconds (21.52 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 82533.7028    0  175 -183060.80 82533.7028   145%     -   25s
H    0     0                    -140087.4313 82533.7028   159%     -   26s
H    0     0                    -132692.0673 82533.7028   162%     -   26s
H    0     0                    -129007.3923 82533.7028   164%     -   27s
H    0     0                    -128700.3881 82533.7028   164%     -   27s
H    0     0                    -74632.28897 82533.7028   211%     -   27s
H    0     0                    -19291.35009 82533.7028   528%     -   28s
H    0     0                    -18887.18930 82533.7028   537%     -   28s
H    0     0                    -454.1008673 82533.7028      -     -   28s
H    0     0                    21751.552206 82533.7028   279%     -   29s
H    0     0                    21891.901881 82533.7028   277%     -   29s
H    0     0                    21998.481468 82533.7028   275%     -   29s
H    0     0                    22840.416087 82533.7028   261%     -   29s
H    0     0                    23167.431147 82533.7028   256%     -   29s
H    0     0                    23169.438577 82533.7028   256%     -   29s
H    0     0                    23246.113497 82533.7028   255%     -   29s
     0     0 75237.6865    0  217 23246.1135 75237.6865   224%     -  136s
     0     0 74454.8871    0  182 23246.1135 74454.8871   220%     -  185s
     0     0 74378.4834    0  193 23246.1135 74378.4834   220%     -  204s
     0     0 74330.8220    0  212 23246.1135 74330.8220   220%     -  216s
     0     0 74153.4502    0  214 23246.1135 74153.4502   219%     -  229s
     0     0 74152.6815    0  218 23246.1135 74152.6815   219%     -  231s
     0     0 70329.8565    0  305 23246.1135 70329.8565   203%     -  308s
H    0     0                    27568.603617 70329.8171   155%     -  309s
H    0     0                    29956.999781 70329.8171   135%     -  309s
H    0     0                    31292.243270 70329.8171   125%     -  309s
H    0     0                    31944.206965 70329.8171   120%     -  309s
H    0     0                    31946.202004 70329.8171   120%     -  309s
     0     0 69706.7787    0  316 31946.2020 69706.7787   118%     -  359s
     0     0 69567.8671    0  334 31946.2020 69567.8671   118%     -  385s
     0     0 69457.9117    0  333 31946.2020 69457.9117   117%     -  410s
     0     0 69360.5308    0  341 31946.2020 69360.5308   117%     -  429s
     0     0 69302.5087    0  357 31946.2020 69302.5087   117%     -  444s
     0     0 69256.8129    0  347 31946.2020 69256.8129   117%     -  455s
     0     0 69239.8985    0  354 31946.2020 69239.8985   117%     -  460s
     0     0 69239.1482    0  352 31946.2020 69239.1482   117%     -  462s
     0     0 66746.2991    0  305 31946.2020 66746.2991   109%     -  567s
     0     0 66230.6329    0  328 31946.2020 66230.6329   107%     -  617s
     0     0 66077.3718    0  338 31946.2020 66077.3718   107%     -  647s
     0     0 65983.2864    0  331 31946.2020 65983.2864   107%     -  671s
     0     0 65913.6942    0  340 31946.2020 65913.6942   106%     -  687s
     0     0 65858.7107    0  344 31946.2020 65858.7107   106%     -  706s
     0     0 65837.6046    0  381 31946.2020 65837.6046   106%     -  716s
     0     0 65831.1398    0  354 31946.2020 65831.1398   106%     -  722s
     0     0 65825.4248    0  350 31946.2020 65825.4248   106%     -  726s
     0     0 65782.6290    0  336 31946.2020 65782.6290   106%     -  735s
     0     0 65776.4754    0  346 31946.2020 65776.4754   106%     -  740s
     0     0 65766.4159    0  347 31946.2020 65766.4159   106%     -  745s
     0     0 65762.7223    0  363 31946.2020 65762.7223   106%     -  750s
     0     0 65759.1782    0  364 31946.2020 65759.1782   106%     -  754s
     0     0 65751.6865    0  376 31946.2020 65751.6865   106%     -  762s
     0     0 65751.0651    0  345 31946.2020 65751.0651   106%     -  764s
     0     0 65138.0068    0  347 31946.2020 65138.0068   104%     -  825s
H    0     0                    31952.696465 65137.5154   104%     -  827s
     0     0 64965.0716    0  386 31952.6965 64965.0716   103%     -  849s
     0     0 64873.3856    0  349 31952.6965 64873.3856   103%     -  872s
     0     0 64853.5708    0  351 31952.6965 64853.5708   103%     -  880s
     0     0 64833.5130    0  367 31952.6965 64833.5130   103%     -  894s
     0     0 64817.3178    0  375 31952.6965 64817.3178   103%     -  903s
     0     0 64807.4584    0  370 31952.6965 64807.4584   103%     -  908s
     0     0 64802.6407    0  366 31952.6965 64802.6407   103%     -  911s
     0     0 64800.6289    0  367 31952.6965 64800.6289   103%     -  915s
     0     0 64686.7580    0  388 31952.6965 64686.7580   102%     -  945s
H    0     0                    33849.868219 64686.5349  91.1%     -  946s
     0     0 64671.9615    0  345 33849.8682 64671.9615  91.1%     -  957s
     0     0 64645.4135    0  391 33849.8682 64645.4135  91.0%     -  972s
     0     0 64636.5039    0  350 33849.8682 64636.5039  91.0%     -  982s
     0     0 64633.5373    0  352 33849.8682 64633.5373  90.9%     -  989s
     0     0 64619.1952    0  406 33849.8682 64619.1952  90.9%     - 1004s
     0     0 64617.2826    0  409 33849.8682 64617.2826  90.9%     - 1009s
     0     0 64551.1071    0  477 33849.8682 64551.1071  90.7%     - 1036s
     0     0 64535.6136    0  419 33849.8682 64535.6136  90.7%     - 1044s
     0     0 64527.3727    0  422 33849.8682 64527.3727  90.6%     - 1052s
     0     0 64525.7575    0  430 33849.8682 64525.7575  90.6%     - 1054s
     0     0 64509.6758    0  390 33849.8682 64509.6758  90.6%     - 1065s
     0     0 64502.8099    0  402 33849.8682 64502.8099  90.6%     - 1072s
     0     0 64500.3252    0  356 33849.8682 64500.3252  90.5%     - 1074s
     0     0 64463.8398    0  405 33849.8682 64463.8398  90.4%     - 1092s
H    0     0                    33899.212291 64463.3166  90.2%     - 1093s
     0     0 64460.0178    0  402 33899.2123 64460.0178  90.2%     - 1096s
     0     0 64455.0997    0  407 33899.2123 64455.0997  90.1%     - 1102s
     0     0 64453.8061    0  402 33899.2123 64453.8061  90.1%     - 1105s
     0     0 64445.7424    0  360 33899.2123 64445.7424  90.1%     - 1113s
     0     0 64444.6462    0  362 33899.2123 64444.6462  90.1%     - 1115s
     0     0 64421.6155    0  359 33899.2123 64421.6155  90.0%     - 1130s
     0     0 64414.3027    0  441 33899.2123 64414.3027  90.0%     - 1137s
     0     0 64412.4821    0  401 33899.2123 64412.4821  90.0%     - 1141s
     0     0 64378.3639    0  349 33899.2123 64378.3639  89.9%     - 1158s
     0     0 64370.0565    0  343 33899.2123 64370.0565  89.9%     - 1167s
     0     0 64368.8117    0  341 33899.2123 64368.8117  89.9%     - 1169s
     0     0 64355.8903    0  383 33899.2123 64355.8903  89.8%     - 1182s
H    0     0                    34417.549569 64355.5674  87.0%     - 1184s
H    0     0                    35319.018975 64355.5674  82.2%     - 1184s
H    0     0                    35491.509470 64355.5674  81.3%     - 1184s
H    0     0                    35495.908400 64355.5674  81.3%     - 1185s
     0     0 64351.7524    0  388 35495.9084 64351.7524  81.3%     - 1188s
     0     0 64349.2566    0  391 35495.9084 64349.2566  81.3%     - 1194s
     0     0 64345.5477    0  355 35495.9084 64345.5477  81.3%     - 1202s
H    0     0                    35763.175252 64344.0745  79.9%     - 1203s
     0     0 64342.5401    0  371 35763.1753 64342.5401  79.9%     - 1206s
     0     0 64341.9630    0  373 35763.1753 64341.9630  79.9%     - 1208s
     0     0 64339.9130    0  368 35763.1753 64339.9130  79.9%     - 1212s
     0     0 64339.3437    0  368 35763.1753 64339.3437  79.9%     - 1218s
H    0     0                    36259.584594 64338.6790  77.4%     - 1513s
H    0     0                    36425.911292 64338.6790  76.6%     - 1517s
H    0     0                    36801.007987 64338.6790  74.8%     - 1544s
H    0     0                    37588.058463 64338.6790  71.2%     - 1544s
H    0     0                    37722.203463 64338.6790  70.6%     - 1554s
H    0     0                    37761.996958 64338.6790  70.4%     - 1554s
H    0     0                    37788.779674 64338.6790  70.3%     - 1554s
H    0     0                    38073.690688 64338.6790  69.0%     - 1567s
H    0     0                    38161.817555 64338.6790  68.6%     - 1567s
H    0     0                    38370.695313 64338.6790  67.7%     - 1579s
H    0     2                    38800.305775 64338.6790  65.8%     - 1590s
     0     2 64338.6790    0  368 38800.3058 64338.6790  65.8%     - 1590s
     1     3 64139.5403    1  349 38800.3058 64338.6790  65.8% 13162 1619s
     2     5 63926.8754    2  411 38800.3058 64338.6790  65.8% 12754 1647s
     4     9 63884.0308    3  405 38800.3058 64310.4659  65.7%  9072 1685s
     8    15 64088.0221    3  343 38800.3058 64309.3896  65.7%  9806 1813s
    14    30 62788.9798    4  329 38800.3058 64149.1929  65.3% 17529 1879s
    29    45 63123.0381    5  338 38800.3058 63896.1689  64.7% 23537 2053s
    44    77 62904.2560    6  329 38800.3058 63896.1689  64.7% 22270 2358s
    76   190 62860.3378    7  331 38800.3058 63426.4488  63.5% 19881 2459s
   189   224 62658.3286   10  315 38800.3058 63426.4488  63.5% 11860 2512s
   223   273 62523.4837   11  363 38800.3058 63426.4488  63.5% 10972 2563s
H  248   273                    38841.537965 63426.4488  63.3% 10257 2563s
   272   314 62399.2984   12  346 38841.5380 63426.4488  63.3%  9955 2614s
H  273   314                    38892.199542 63426.4488  63.1%  9918 2614s
H  303   314                    38923.545679 63426.4488  63.0%  9748 2614s
   313   368 62386.9905   13  343 38923.5457 63426.4488  63.0%  9629 2670s
   367   414 62208.9339   15  339 38923.5457 63426.4488  63.0%  9135 2722s
   413   478 62047.7401   17  312 38923.5457 63426.4488  63.0%  8981 2785s
   477   509 61972.6038   18  315 38923.5457 63426.4488  63.0%  8393 2830s
   508   541 61874.6039   19  310 38923.5457 63426.4488  63.0%  8175 2880s
   540   570 61794.5945   20  304 38923.5457 63426.4488  63.0%  8061 2933s
H  560   570                    38973.213116 63426.4488  62.7%  7978 2933s
   569   603 61697.7895   21  339 38973.2131 63426.4488  62.7%  7977 2968s
H  570   603                    39023.874693 63426.4488  62.5%  7963 2968s
H  577   603                    39089.261810 63426.4488  62.3%  8004 2968s
   602   642 61547.9335   22  326 39089.2618 63426.4488  62.3%  8081 3018s
   641   704 61084.2195   23  316 39089.2618 63426.4488  62.3%  8244 3071s
   703   757 61037.5911   24  314 39089.2618 63426.4488  62.3%  7919 3127s
   756   786 60805.7843   26  311 39089.2618 63426.4488  62.3%  7733 3175s
   785   815 58832.5499   27  273 39089.2618 63426.4488  62.3%  7690 3224s
   814   847 58805.2611   28  277 39089.2618 63426.4488  62.3%  7623 3274s
H  832   847                    39377.445177 63426.4488  61.1%  7564 3274s
   846   875 58749.1617   29  268 39377.4452 63426.4488  61.1%  7516 3569s
   874   899 59524.7597   24  297 39377.4452 63426.4488  61.1%  7449 3600s

Cutting planes:
  Learned: 3
  Gomory: 11
  Implied bound: 127
  MIR: 2802
  Flow cover: 3046
  RLT: 60
  Relax-and-lift: 472

Explored 898 nodes (7214211 simplex iterations) in 3600.11 seconds (4758.63 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 39377.4 39089.3 39023.9 ... 38161.8

Time limit reached
Best objective 3.937744517715e+04, best bound 6.342644882345e+04, gap 61.0730%
  WARNING: Time limit reached. Using best solution found (gap: 61.07%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.15s
  Master Objective (UB) = 39377.45, θ = 227565.62
  Upper Bound (UB) = 39377.45

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 227565.62
  [DEBUG]   ✓ Scenario 0: θ = 227565.62 ≤ Q = 227565.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 227565.62 ≤ Q = 227565.62 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 227565.62 ≤ Q = 227565.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 227565.62 ≤ Q = 227565.62 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 227565.62 ≤ Q = 227565.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 227565.62 ≤ Q = 227565.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 227565.62 ≤ Q = 227565.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 227565.62 ≤ Q = 227565.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 227565.62 ≤ Q = 227565.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 227565.62 ≤ Q = 227565.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 227565.62 ≤ Q = 227565.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 227565.62 ≤ Q = 227565.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 227565.62 ≤ Q = 227565.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 227565.62 ≤ Q = 227565.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 227565.62 ≤ Q = 227565.62 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 227565.62 ≤ Q = 227565.62 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 227565.62 ≤ Q = 227565.62 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 17] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x21a88de7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x21a88de7
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.408157e+13
Presolve removed 2585 rows and 1875 columns
Presolve time: 0.01s
Presolved: 508 rows, 514 columns, 1438 nonzeros
Found heuristic solution: objective 6824096.6094
Variable types: 350 continuous, 164 integer (164 binary)

Root relaxation: objective -1.745709e+05, 244 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -174570.88    0  123 6824096.61 -174570.88   103%     -    0s
H    0     0                    -141497.7870 -174570.88  23.4%     -    0s
H    0     0                    -141830.2183 -174570.88  23.1%     -    0s
     0     0 -149549.73    0   66 -141830.22 -149549.73  5.44%     -    0s
H    0     0                    -148082.3087 -149548.71  0.99%     -    0s
H    0     0                    -148199.3934 -149548.71  0.91%     -    0s
H    0     0                    -148318.3970 -149548.71  0.83%     -    0s
     0     0 -148717.94    0   36 -148318.40 -148717.94  0.27%     -    0s
     0     0 -148714.01    0   35 -148318.40 -148714.01  0.27%     -    0s
H    0     0                    -148379.0935 -148704.34  0.22%     -    0s
     0     0 -148577.94    0   30 -148379.09 -148577.94  0.13%     -    0s
     0     0 -148576.85    0   30 -148379.09 -148576.85  0.13%     -    0s
     0     0 -148576.81    0   30 -148379.09 -148576.81  0.13%     -    0s
     0     0 -148574.21    0   29 -148379.09 -148574.21  0.13%     -    0s
     0     0 -148573.42    0   29 -148379.09 -148573.42  0.13%     -    0s
     0     0 -148501.91    0   10 -148379.09 -148501.91  0.08%     -    0s
     0     0 -148501.91    0   32 -148379.09 -148501.91  0.08%     -    0s
H    0     0                    -148406.9979 -148501.91  0.06%     -    0s
     0     0 -148459.61    0    4 -148407.00 -148459.61  0.04%     -    0s
H    0     0                    -148416.0241 -148457.46  0.03%     -    0s
H    0     0                    -148429.6137 -148457.46  0.02%     -    0s
     0     0 -148451.04    0    2 -148429.61 -148451.04  0.01%     -    0s
     0     0          -    0      -148429.61 -148443.63  0.01%     -    0s

Explored 1 nodes (656 simplex iterations) in 0.09 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -148430 -148416 -148407 ... 6.8241e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.484296136611e+05, best bound -1.484436274987e+05, gap 0.0094%
  Subproblem solved in 0.12s
  Worst-case operational profit (Z_SP) = 223017.59
  Scenario: 14 demand increases, 46 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -148429.61
  [DEBUG]   S×d_nominal = 371447.20
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 371447.20 + -148429.61 = 223017.59
  [DEBUG]   Current θ from Master = 227565.62
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4548.03 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 34829.41
  Lower Bound (LB) = 38407.27
  Gap (UB-LB) = 970.1751, Absolute Gap = 970.1751, Relative Gap = 0.024638
  Not converged yet (gap = 970.18 > ε = 200)

  [DEBUG] Adding NEW scenario 17 to Master Problem...
  [DEBUG] New scenario pattern: 14 increases, 46 decreases
    [DEBUG] Scenario 17 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 17 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 17]
    [DEBUG]   - Total constraints in model: 276603
    [DEBUG]   - Total variables in model: 114580
  [DEBUG] Total scenarios in Master: 18
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 18
================================================================================
[Iteration 18] Solving Master Problem...
  Current scenarios in Master: 18
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 276603 rows, 114580 columns and 783785 nonzeros
Model fingerprint: 0x5b79c376
Variable types: 112321 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 123764 rows and 50254 columns (presolve time = 5s)...
Presolve removed 123764 rows and 50254 columns
Presolve time: 6.37s
Presolved: 152839 rows, 64326 columns, 940167 nonzeros
Variable types: 62067 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -314726.8092
Found heuristic solution: objective -183060.7998

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.69s

Barrier statistics:
 Dense cols : 694
 AA' NZ     : 7.363e+06
 Factor NZ  : 1.711e+07 (roughly 230 MB of memory)
 Factor Ops : 4.407e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.95454364e+07  2.82477624e+08  1.56e+05 1.65e+01  9.31e+04    10s
   1  -1.53994539e+07  2.66539888e+08  1.13e+05 1.03e+02  6.64e+04    10s
   2  -4.99786439e+06  2.13672487e+08  3.64e+04 6.35e-01  2.30e+04    10s
   3  -1.20502813e+06  1.55379992e+08  4.84e+03 9.94e-01  3.49e+03    10s
   4  -6.29618934e+05  1.03427636e+08  7.23e+02 3.57e-01  7.83e+02    10s
   5  -5.32728715e+05  5.66220708e+07  3.28e+02 1.53e-01  3.69e+02    10s
   6  -4.15878811e+05  4.47019353e+07  1.17e+02 1.16e-01  2.17e+02    10s
   7  -3.63781672e+05  3.16038817e+07  6.53e+01 7.75e-02  1.41e+02    11s
   8  -2.76694705e+05  2.34635108e+07  2.21e+01 5.46e-02  9.29e+01    11s
   9  -2.15855491e+05  1.33367167e+07  9.82e+00 2.99e-02  5.09e+01    11s
  10  -1.67797471e+05  7.03801295e+06  6.79e+00 1.51e-02  2.68e+01    11s
  11  -1.31628102e+05  5.13759549e+06  4.40e+00 1.08e-02  1.94e+01    11s
  12  -1.00645045e+05  3.06785673e+06  2.60e+00 6.29e-03  1.15e+01    11s
  13  -6.31812149e+04  1.62437238e+06  1.00e+00 3.14e-03  6.09e+00    12s
  14  -1.55230671e+04  3.65003884e+05  2.49e-01 8.76e-04  1.37e+00    12s
  15  -4.42634579e+03  2.74036995e+05  2.08e-01 6.56e-04  1.00e+00    12s
  16   2.84919997e+04  2.10992554e+05  1.18e-01 1.72e-03  6.56e-01    12s
  17   3.96410715e+04  1.64109663e+05  9.07e-02 2.47e-03  4.47e-01    12s
  18   4.98833601e+04  1.48259850e+05  6.47e-02 1.66e-03  3.54e-01    12s
  19   5.52540333e+04  1.28069644e+05  5.14e-02 1.97e-03  2.62e-01    13s
  20   5.96218032e+04  1.14091376e+05  4.17e-02 1.53e-03  1.96e-01    13s
  21   6.65786104e+04  1.08903697e+05  2.69e-02 1.53e-03  1.52e-01    13s
  22   6.87075560e+04  1.02683814e+05  2.28e-02 1.19e-03  1.22e-01    13s
  23   7.12715517e+04  9.99115177e+04  1.79e-02 1.03e-03  1.03e-01    13s
  24   7.23089048e+04  9.47990552e+04  1.57e-02 7.63e-04  8.08e-02    14s
  25   7.41157285e+04  9.26585189e+04  1.26e-02 6.34e-04  6.66e-02    14s
  26   7.55634571e+04  9.04537223e+04  1.03e-02 4.96e-04  5.35e-02    14s
  27   7.69112644e+04  8.93859098e+04  8.12e-03 4.31e-04  4.48e-02    14s
  28   7.82164782e+04  8.84472424e+04  6.11e-03 3.67e-04  3.68e-02    15s
  29   7.90794519e+04  8.63944939e+04  4.82e-03 2.43e-04  2.63e-02    15s
  30   7.97730939e+04  8.57562333e+04  3.83e-03 2.01e-04  2.15e-02    15s
  31   7.99347938e+04  8.53255082e+04  3.60e-03 1.74e-04  1.94e-02    15s
  32   8.04913955e+04  8.44707275e+04  2.82e-03 1.19e-04  1.43e-02    15s
  33   8.09553604e+04  8.40701830e+04  2.19e-03 9.21e-05  1.12e-02    16s
  34   8.13660909e+04  8.39014015e+04  1.64e-03 8.10e-05  9.11e-03    16s
  35   8.16546199e+04  8.34067910e+04  1.26e-03 4.84e-05  6.30e-03    16s
  36   8.20320393e+04  8.32509436e+04  7.73e-04 3.79e-05  4.38e-03    16s
  37   8.21722987e+04  8.30132563e+04  5.97e-04 2.40e-05  3.02e-03    17s
  38   8.23359402e+04  8.28999844e+04  3.96e-04 1.93e-05  2.03e-03    17s
  39   8.25904377e+04  8.28316448e+04  9.06e-05 1.07e-05  8.66e-04    17s
  40   8.26149428e+04  8.28045456e+04  6.25e-05 8.75e-06  6.81e-04    17s
  41   8.26375878e+04  8.27460280e+04  3.99e-05 4.52e-06  3.89e-04    18s
  42   8.26467599e+04  8.27226666e+04  3.10e-05 2.89e-06  2.73e-04    18s
  43   8.26682806e+04  8.26900590e+04  1.07e-05 6.01e-07  7.82e-05    18s
  44   8.26784983e+04  8.26846300e+04  2.16e-06 2.22e-07  2.20e-05    18s
  45   8.26786077e+04  8.26840243e+04  2.07e-06 1.81e-07  1.95e-05    19s
  46   8.26796230e+04  8.26815344e+04  1.22e-06 1.45e-08  6.87e-06    19s
  47   8.26801488e+04  8.26814870e+04  8.38e-07 2.58e-08  4.81e-06    19s
  48   8.26812555e+04  8.26813217e+04  2.00e-08 6.20e-08  2.38e-07    19s
  49   8.26812596e+04  8.26813180e+04  6.68e-06 1.28e-06  2.08e-07    20s
  50   8.26812996e+04  8.26813014e+04  3.98e-07 5.12e-07  6.33e-09    20s
  51   8.26813000e+04  8.26813014e+04  2.89e-06 3.68e-07  4.96e-09    20s
  52   8.26813013e+04  8.26813014e+04  2.75e-07 4.51e-09  3.47e-10    20s

Barrier solved model in 52 iterations and 20.30 seconds (15.92 work units)
Optimal objective 8.26813013e+04


Root crossover log...

  134884 DPushes remaining with DInf 0.0000000e+00                20s
    3821 DPushes remaining with DInf 0.0000000e+00                25s
       0 DPushes remaining with DInf 0.0000000e+00                27s

    5008 PPushes remaining with PInf 5.3563114e-05                27s
       0 PPushes remaining with PInf 0.0000000e+00                27s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.3111340e+01     27s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   64707    8.2681301e+04   0.000000e+00   1.311134e+01     27s
   64793    8.2681301e+04   0.000000e+00   0.000000e+00     28s
   64793    8.2681301e+04   0.000000e+00   0.000000e+00     28s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 8.268130e+04, 64793 iterations, 20.13 seconds (24.69 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 82681.3014    0  171 -183060.80 82681.3014   145%     -   28s
H    0     0                    -181038.9918 82681.3014   146%     -   28s
H    0     0                    -159046.7770 82681.3014   152%     -   30s
H    0     0                    -157554.6477 82681.3014   152%     -   30s
H    0     0                    -135668.3045 82681.3014   161%     -   30s
H    0     0                    -132087.1789 82681.3014   163%     -   31s
H    0     0                    -124360.5805 82681.3014   166%     -   31s
H    0     0                    -114834.9971 82681.3014   172%     -   32s
H    0     0                    -114822.0383 82681.3014   172%     -   32s
H    0     0                    -75894.93545 82681.3014   209%     -   32s
H    0     0                    -19291.35009 82681.3014   529%     -   32s
H    0     0                    -18887.18930 82681.3014   538%     -   32s
H    0     0                    -18015.86406 82681.3014   559%     -   33s
H    0     0                    -454.1008673 82681.3014      -     -   33s
H    0     0                    5254.0721282 82681.3014  1474%     -   34s
H    0     0                    21751.552206 82681.3014   280%     -   34s
H    0     0                    22634.649587 82681.3014   265%     -   34s
H    0     0                    22840.416087 82681.3014   262%     -   34s
H    0     0                    23162.813742 82681.3014   257%     -   34s
H    0     0                    23272.617929 82681.3014   255%     -   34s
     0     0 75122.9688    0  225 23272.6179 75122.9688   223%     -  125s
H    0     0                    23578.942339 75122.2629   219%     -  127s
     0     0 74873.6535    0  226 23578.9423 74873.6535   218%     -  156s
     0     0 74766.9729    0  221 23578.9423 74766.9729   217%     -  174s
     0     0 74701.2907    0  239 23578.9423 74701.2907   217%     -  187s
     0     0 74628.0531    0  234 23578.9423 74628.0531   217%     -  198s
     0     0 74609.6402    0  232 23578.9423 74609.6402   216%     -  200s
     0     0 74468.1856    0  240 23578.9423 74468.1856   216%     -  213s
     0     0 74463.9730    0  240 23578.9423 74463.9730   216%     -  216s
     0     0 74456.0390    0  240 23578.9423 74456.0390   216%     -  217s
     0     0 74456.0390    0  240 23578.9423 74456.0390   216%     -  217s
     0     0 70687.4432    0  245 23578.9423 70687.4432   200%     -  318s
H    0     0                    25649.464859 70687.3412   176%     -  319s
H    0     0                    28403.598888 70687.3412   149%     -  320s
H    0     0                    30134.139357 70687.3412   135%     -  320s
H    0     0                    30175.353729 70687.3412   134%     -  320s
H    0     0                    30192.623483 70687.3412   134%     -  320s
H    0     0                    30274.218508 70687.3412   133%     -  320s
H    0     0                    30349.720152 70687.3412   133%     -  320s
H    0     0                    30349.834704 70687.3412   133%     -  320s
     0     0 69740.6283    0  313 30349.8347 69740.6283   130%     -  404s
     0     0 69466.7230    0  350 30349.8347 69466.7230   129%     -  468s
     0     0 69152.5994    0  341 30349.8347 69152.5994   128%     -  508s
     0     0 68992.1759    0  387 30349.8347 68992.1759   127%     -  554s
     0     0 68969.2824    0  389 30349.8347 68969.2824   127%     -  565s
     0     0 68882.1651    0  379 30349.8347 68882.1651   127%     -  594s
     0     0 68873.3970    0  351 30349.8347 68873.3970   127%     -  603s
     0     0 68850.7311    0  353 30349.8347 68850.7311   127%     -  611s
     0     0 68820.0145    0  368 30349.8347 68820.0145   127%     -  625s
     0     0 68814.0881    0  344 30349.8347 68814.0881   127%     -  630s
     0     0 68747.7236    0  347 30349.8347 68747.7236   127%     -  645s
     0     0 68729.9956    0  373 30349.8347 68729.9956   126%     -  661s
     0     0 68719.7003    0  376 30349.8347 68719.7003   126%     -  673s
     0     0 68715.1782    0  385 30349.8347 68715.1782   126%     -  678s
     0     0 68710.9577    0  379 30349.8347 68710.9577   126%     -  682s
     0     0 68707.7160    0  376 30349.8347 68707.7160   126%     -  686s
     0     0 68707.0995    0  376 30349.8347 68707.0995   126%     -  688s
     0     0 66789.0002    0  313 30349.8347 66789.0002   120%     -  795s
H    0     0                    32077.387857 66788.9647   108%     -  796s
H    0     0                    34241.397267 66788.9647  95.1%     -  797s
H    0     0                    35089.002210 66788.9647  90.3%     -  797s
H    0     0                    36373.709611 66788.9647  83.6%     -  797s
H    0     0                    36894.839997 66788.9647  81.0%     -  797s
     0     0 66474.1752    0  306 36894.8400 66474.1752  80.2%     -  839s
     0     0 66193.1153    0  310 36894.8400 66193.1153  79.4%     -  871s
     0     0 66085.6433    0  315 36894.8400 66085.6433  79.1%     -  893s
     0     0 66004.7316    0  314 36894.8400 66004.7316  78.9%     -  908s
     0     0 65959.6602    0  321 36894.8400 65959.6602  78.8%     -  919s
     0     0 65943.4397    0  327 36894.8400 65943.4397  78.7%     -  924s
     0     0 65936.0691    0  329 36894.8400 65936.0691  78.7%     -  927s
     0     0 65914.8587    0  328 36894.8400 65914.8587  78.7%     -  932s
     0     0 65902.2242    0  325 36894.8400 65902.2242  78.6%     -  938s
     0     0 65886.3796    0  325 36894.8400 65886.3796  78.6%     -  943s
     0     0 65834.8561    0  331 36894.8400 65834.8561  78.4%     -  951s
     0     0 65773.1374    0  326 36894.8400 65773.1374  78.3%     -  961s
     0     0 65760.4993    0  336 36894.8400 65760.4993  78.2%     -  968s
     0     0 65686.9214    0  335 36894.8400 65686.9214  78.0%     -  980s
     0     0 65681.5629    0  339 36894.8400 65681.5629  78.0%     -  984s
     0     0 65672.0344    0  337 36894.8400 65672.0344  78.0%     -  989s
     0     0 65655.8534    0  336 36894.8400 65655.8534  78.0%     -  995s
     0     0 65639.1977    0  335 36894.8400 65639.1977  77.9%     - 1001s
     0     0 65635.8736    0  336 36894.8400 65635.8736  77.9%     - 1004s
     0     0 65634.1903    0  334 36894.8400 65634.1903  77.9%     - 1006s
     0     0 65022.5717    0  381 36894.8400 65022.5717  76.2%     - 1089s
     0     0 64849.1246    0  429 36894.8400 64849.1246  75.8%     - 1121s
     0     0 64814.7250    0  393 36894.8400 64814.7250  75.7%     - 1140s
     0     0 64800.6950    0  399 36894.8400 64800.6950  75.6%     - 1147s
     0     0 64795.2405    0  394 36894.8400 64795.2405  75.6%     - 1151s
     0     0 64785.5149    0  394 36894.8400 64785.5149  75.6%     - 1159s
     0     0 64783.6065    0  398 36894.8400 64783.6065  75.6%     - 1161s
     0     0 64715.1765    0  433 36894.8400 64715.1765  75.4%     - 1187s
     0     0 64676.3489    0  437 36894.8400 64676.3489  75.3%     - 1209s
     0     0 64664.1133    0  480 36894.8400 64664.1133  75.3%     - 1219s
     0     0 64658.9074    0  367 36894.8400 64658.9074  75.3%     - 1225s
     0     0 64654.8539    0  487 36894.8400 64654.8539  75.2%     - 1229s
     0     0 64652.8413    0  368 36894.8400 64652.8413  75.2%     - 1233s
     0     0 64600.1409    0  454 36894.8400 64600.1409  75.1%     - 1252s
H    0     0                    37391.249339 64599.8063  72.8%     - 1254s
     0     0 64585.9343    0  492 37391.2493 64585.9343  72.7%     - 1267s
     0     0 64578.8776    0  453 37391.2493 64578.8776  72.7%     - 1276s
     0     0 64577.8461    0  468 37391.2493 64577.8461  72.7%     - 1279s
     0     0 64551.4288    0  458 37391.2493 64551.4288  72.6%     - 1301s
     0     0 64548.7438    0  412 37391.2493 64548.7438  72.6%     - 1308s
     0     0 64546.8047    0  461 37391.2493 64546.8047  72.6%     - 1314s
     0     0 64521.2233    0  421 37391.2493 64521.2233  72.6%     - 1336s
     0     0 64505.7102    0  426 37391.2493 64505.7102  72.5%     - 1350s
     0     0 64501.1101    0  426 37391.2493 64501.1101  72.5%     - 1362s
     0     0 64499.6336    0  417 37391.2493 64499.6336  72.5%     - 1367s
     0     0 64488.1693    0  412 37391.2493 64488.1693  72.5%     - 1379s
     0     0 64483.9640    0  384 37391.2493 64483.9640  72.5%     - 1385s
     0     0 64482.0145    0  378 37391.2493 64482.0145  72.5%     - 1389s
     0     0 64471.0807    0  404 37391.2493 64471.0807  72.4%     - 1401s
     0     0 64464.4638    0  507 37391.2493 64464.4638  72.4%     - 1412s
     0     0 64462.0100    0  469 37391.2493 64462.0100  72.4%     - 1419s
     0     0 64450.5577    0  458 37391.2493 64450.5577  72.4%     - 1428s
     0     0 64444.4874    0  451 37391.2493 64444.4874  72.4%     - 1438s
     0     0 64441.5220    0  450 37391.2493 64441.5220  72.3%     - 1442s
     0     0 64440.3666    0  454 37391.2493 64440.3666  72.3%     - 1445s
     0     0 64433.4183    0  454 37391.2493 64433.4183  72.3%     - 1453s
     0     0 64432.9256    0  454 37391.2493 64432.9256  72.3%     - 1460s
H    0     0                    37404.136924 64432.9124  72.3%     - 1757s
H    0     0                    37469.207246 64432.9124  72.0%     - 1757s
H    0     0                    37698.149015 64432.9124  70.9%     - 1757s
H    0     2                    38982.322130 64432.9124  65.3%     - 1785s
     0     2 64432.9124    0  454 38982.3221 64432.9124  65.3%     - 1785s
     1     4 64331.5805    1  453 38982.3221 64432.9124  65.3%  7103 1847s
     3     7 64307.5592    2  451 38982.3221 64331.5019  65.0% 11998 1911s
     6    13 64182.0004    3  445 38982.3221 64296.0451  64.9% 14220 2010s
    12    26 64091.0942    4  440 38982.3221 64181.4486  64.6% 17168 2076s
    25    39 61200.7492    5  359 38982.3221 64091.0022  64.4% 26111 2323s
H   38    70                    39137.611203 64091.0022  63.8% 30709 3007s
H   39    70                    39198.736171 64091.0022  63.5% 30624 3007s
    69   175 60515.2331    7  313 39198.7362 63948.4671  63.1% 31614 3169s
   174   273 60185.3793   11  311 39198.7362 63806.9406  62.8% 18402 3256s
   272   337 59930.6638   16  311 39198.7362 63806.9406  62.8% 14929 3326s
H  336   396                    39328.031109 63806.9406  62.2% 13529 3389s
   395   447 59032.4172   19  319 39328.0311 63806.9406  62.2% 13036 3453s
   446   498 58781.0261   21  312 39328.0311 63806.9406  62.2% 12372 3507s
   497   555 58181.5073   23  296 39328.0311 63806.9406  62.2% 12285 3567s
   554   597 58061.1403   25  304 39328.0311 63806.9406  62.2% 11870 3600s

Cutting planes:
  Learned: 3
  Gomory: 17
  Implied bound: 223
  MIR: 3521
  Flow cover: 2957
  RLT: 51
  Relax-and-lift: 590

Explored 596 nodes (7663332 simplex iterations) in 3600.12 seconds (4571.69 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 39328 39198.7 39137.6 ... 36373.7

Time limit reached
Best objective 3.932803110906e+04, best bound 6.380694060169e+04, gap 62.2429%
  WARNING: Time limit reached. Using best solution found (gap: 62.24%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.14s
  Master Objective (UB) = 39328.03, θ = 228185.21
  Upper Bound (UB) = 39328.03

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 228185.21
  [DEBUG]   ✓ Scenario 0: θ = 228185.21 ≤ Q = 228185.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 228185.21 ≤ Q = 228185.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 228185.21 ≤ Q = 228185.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 228185.21 ≤ Q = 228185.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 228185.21 ≤ Q = 228185.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 228185.21 ≤ Q = 228185.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 228185.21 ≤ Q = 228185.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 228185.21 ≤ Q = 228185.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 228185.21 ≤ Q = 228185.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 228185.21 ≤ Q = 228185.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 228185.21 ≤ Q = 228185.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 228185.21 ≤ Q = 228185.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 228185.21 ≤ Q = 228185.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 228185.21 ≤ Q = 228185.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 228185.21 ≤ Q = 228185.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 228185.21 ≤ Q = 228185.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 228185.21 ≤ Q = 228185.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 228185.21 ≤ Q = 228185.21 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 18] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x1ed87786
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xe127887a
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e-13, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [5e-15, 2e+02]
Found heuristic solution: objective 1.401873e+13
Presolve removed 2585 rows and 1875 columns
Presolve time: 0.01s
Presolved: 508 rows, 514 columns, 1439 nonzeros
Found heuristic solution: objective 6820932.8001
Variable types: 350 continuous, 164 integer (164 binary)

Root relaxation: objective -1.738778e+05, 237 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -173877.76    0  123 6820932.80 -173877.76   103%     -    0s
H    0     0                    -140726.9668 -173877.76  23.6%     -    0s
H    0     0                    -141013.8294 -173877.76  23.3%     -    0s
     0     0 -148196.74    0   44 -141013.83 -148196.74  5.09%     -    0s
H    0     0                    -146305.8445 -148120.79  1.24%     -    0s
H    0     0                    -146622.8639 -148120.79  1.02%     -    0s
H    0     0                    -146740.1400 -148120.79  0.94%     -    0s
H    0     0                    -147057.1593 -148120.79  0.72%     -    0s
     0     0 -147960.41    0   30 -147057.16 -147960.41  0.61%     -    0s
H    0     0                    -147914.6204 -147954.35  0.03%     -    0s
     0     0 -147936.08    0    3 -147914.62 -147936.08  0.01%     -    0s
H    0     0                    -147929.7746 -147936.08  0.00%     -    0s

Cutting planes:
  Gomory: 15
  Implied bound: 1
  MIR: 144
  RLT: 1
  Relax-and-lift: 1

Explored 1 nodes (405 simplex iterations) in 0.04 seconds (0.02 work units)
Thread count was 32 (of 32 available processors)

Solution count 8: -147930 -147915 -147057 ... 1.40187e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.479297746024e+05, best bound -1.479360817999e+05, gap 0.0043%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 223517.43
  Scenario: 2 demand increases, 58 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -147929.77
  [DEBUG]   S×d_nominal = 371447.20
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 371447.20 + -147929.77 = 223517.43
  [DEBUG]   Current θ from Master = 228185.21
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4667.78 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 34660.25
  Lower Bound (LB) = 38407.27
  Gap (UB-LB) = 920.7610, Absolute Gap = 920.7610, Relative Gap = 0.023412
  Not converged yet (gap = 920.76 > ε = 200)

  [DEBUG] Adding NEW scenario 18 to Master Problem...
  [DEBUG] New scenario pattern: 2 increases, 58 decreases
    [DEBUG] Scenario 18 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 18 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 18]
    [DEBUG]   - Total constraints in model: 291893
    [DEBUG]   - Total variables in model: 120820
  [DEBUG] Total scenarios in Master: 19
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 19
================================================================================
[Iteration 19] Solving Master Problem...
  Current scenarios in Master: 19
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 291893 rows, 120820 columns and 827022 nonzeros
Model fingerprint: 0x25b88ff2
Variable types: 118561 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 130652 rows and 53052 columns (presolve time = 5s)...
Presolve removed 130652 rows and 53052 columns
Presolve time: 5.38s
Presolved: 161241 rows, 67768 columns, 991892 nonzeros
Variable types: 65509 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -314726.8092
Found heuristic solution: objective -183060.7998

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.68s

Barrier statistics:
 Dense cols : 693
 AA' NZ     : 8.135e+06
 Factor NZ  : 1.886e+07 (roughly 250 MB of memory)
 Factor Ops : 5.058e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.99094425e+07  2.95584550e+08  1.59e+05 1.62e+01  9.43e+04     9s
   1  -1.57404177e+07  2.99635584e+08  1.15e+05 8.99e+01  6.97e+04     9s
   2  -7.23251166e+06  2.13969778e+08  5.04e+04 1.43e+00  3.24e+04     9s
   3  -1.36340440e+06  1.72806432e+08  5.83e+03 1.90e+00  4.20e+03     9s
   4  -6.17287818e+05  9.27086439e+07  7.97e+02 2.07e-01  7.69e+02     9s
   5  -5.01295506e+05  5.77054034e+07  3.85e+02 9.91e-02  3.97e+02     9s
   6  -4.54019395e+05  4.27452768e+07  2.46e+02 6.69e-02  2.65e+02     9s
   7  -4.00847892e+05  3.42118091e+07  1.13e+02 5.15e-02  1.68e+02     9s
   8  -3.43415823e+05  2.30729928e+07  5.91e+01 3.27e-02  1.02e+02    10s
   9  -2.07409282e+05  1.52943764e+07  1.53e+01 2.02e-02  5.73e+01    10s
  10  -1.38772760e+05  8.74902168e+06  8.13e+00 1.12e-02  3.18e+01    10s
  11  -1.12155607e+05  7.40430787e+06  4.70e+00 9.42e-03  2.64e+01    10s
  12  -1.01053626e+05  4.48285121e+06  3.15e+00 5.61e-03  1.59e+01    10s
  13  -7.39012813e+04  2.67874702e+06  1.31e+00 3.31e-03  9.45e+00    10s
  14  -4.47246999e+04  6.70686016e+05  5.17e-01 8.25e-04  2.44e+00    10s
  15  -1.62681330e+04  3.36070620e+05  2.82e-01 5.64e-04  1.20e+00    10s
  16   1.43870628e+03  2.37202549e+05  2.13e-01 9.20e-04  8.04e-01    11s
  17   2.44665580e+04  1.88179830e+05  1.46e-01 1.45e-03  5.58e-01    11s
  18   4.03314148e+04  1.55898307e+05  1.04e-01 1.97e-03  3.94e-01    11s
  19   4.78094274e+04  1.44629143e+05  8.33e-02 1.88e-03  3.30e-01    11s
  20   5.40856614e+04  1.29563093e+05  6.66e-02 2.02e-03  2.57e-01    11s
  21   5.84293757e+04  1.16780988e+05  5.43e-02 2.66e-03  1.99e-01    11s
  22   6.31756016e+04  1.09348192e+05  4.20e-02 2.15e-03  1.57e-01    11s
  23   6.58879402e+04  1.02215692e+05  3.52e-02 2.38e-03  1.24e-01    12s
  24   7.04790039e+04  9.95127432e+04  2.41e-02 2.28e-03  9.90e-02    12s
  25   7.20386952e+04  9.68292287e+04  2.02e-02 2.13e-03  8.45e-02    12s
  26   7.32017103e+04  9.33562730e+04  1.75e-02 1.67e-03  6.87e-02    12s
  27   7.42697819e+04  9.17572146e+04  1.53e-02 1.45e-03  5.96e-02    12s
  28   7.50447235e+04  8.97707051e+04  1.37e-02 1.15e-03  5.02e-02    12s
  29   7.60487665e+04  8.75612023e+04  1.18e-02 8.53e-04  3.93e-02    13s
  30   7.65777598e+04  8.71549523e+04  1.07e-02 7.82e-04  3.61e-02    13s
  31   7.74296857e+04  8.64631518e+04  9.12e-03 6.64e-04  3.08e-02    13s
  32   7.79026815e+04  8.56175846e+04  8.26e-03 5.14e-04  2.63e-02    13s
  33   7.89122870e+04  8.51082713e+04  6.42e-03 4.22e-04  2.11e-02    13s
  34   7.93302821e+04  8.45765194e+04  5.67e-03 3.29e-04  1.79e-02    14s
  35   7.98805590e+04  8.44067964e+04  4.69e-03 2.96e-04  1.54e-02    14s
  36   8.01424216e+04  8.39261257e+04  4.23e-03 3.75e-04  1.29e-02    14s
  37   8.12053014e+04  8.36476341e+04  2.41e-03 2.88e-04  8.33e-03    14s
  38   8.17178390e+04  8.35300527e+04  1.55e-03 2.54e-04  6.18e-03    14s
  39   8.18338051e+04  8.33091012e+04  1.35e-03 1.90e-04  5.03e-03    14s
  40   8.20724854e+04  8.31697395e+04  9.37e-04 1.48e-04  3.74e-03    15s
  41   8.22231688e+04  8.29795327e+04  6.85e-04 9.13e-05  2.58e-03    15s
  42   8.23782371e+04  8.29078942e+04  4.33e-04 7.01e-05  1.81e-03    15s
  43   8.25271524e+04  8.28072345e+04  1.98e-04 4.04e-05  9.55e-04    15s
  44   8.26037953e+04  8.27187006e+04  8.36e-05 1.50e-05  3.92e-04    15s
  45   8.26317642e+04  8.27062882e+04  4.56e-05 1.14e-05  2.54e-04    16s
  46   8.26408384e+04  8.26778182e+04  3.30e-05 3.44e-06  1.26e-04    16s
  47   8.26592176e+04  8.26773020e+04  8.53e-06 3.29e-06  6.16e-05    16s
  48   8.26631191e+04  8.26662924e+04  3.25e-06 1.55e-07  1.08e-05    16s
  49   8.26655214e+04  8.26657633e+04  1.04e-07 5.22e-07  8.26e-07    16s
  50   8.26656772e+04  8.26656774e+04  1.10e-09 7.37e-09  8.26e-10    16s

Barrier solved model in 50 iterations and 16.38 seconds (16.58 work units)
Optimal objective 8.26656772e+04


Root crossover log...

  141690 DPushes remaining with DInf 0.0000000e+00                16s
   33852 DPushes remaining with DInf 0.0000000e+00                20s
     489 DPushes remaining with DInf 0.0000000e+00                25s
       0 DPushes remaining with DInf 0.0000000e+00                25s

    7210 PPushes remaining with PInf 1.1173427e-04                25s
       0 PPushes remaining with PInf 0.0000000e+00                26s

  Push phase complete: Pinf 0.0000000e+00, Dinf 4.8414260e+01     26s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   71440    8.2665677e+04   0.000000e+00   4.841426e+01     26s
   71471    8.2665677e+04   0.000000e+00   0.000000e+00     26s
   71471    8.2665677e+04   0.000000e+00   0.000000e+00     27s
Concurrent spin time: 4.79s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 8.266568e+04, 71471 iterations, 24.78 seconds (29.84 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 82665.6773    0  182 -183060.80 82665.6773   145%     -   32s
H    0     0                    -169665.3649 82665.6773   149%     -   33s
H    0     0                    -134345.4490 82665.6773   162%     -   34s
H    0     0                    -134144.6405 82665.6773   162%     -   35s
H    0     0                    -134112.2939 82665.6773   162%     -   35s
H    0     0                    -75894.93545 82665.6773   209%     -   35s
H    0     0                    -8158.407944 82665.6773  1113%     -   36s
H    0     0                    -3189.497144 82665.6773  2692%     -   37s
H    0     0                    21367.742493 82665.6773   287%     -   37s
H    0     0                    22958.578895 82665.6773   260%     -   37s
H    0     0                    23070.458483 82665.6773   258%     -   37s
H    0     0                    23076.648230 82665.6773   258%     -   37s
H    0     0                    23078.508615 82665.6773   258%     -   37s
H    0     0                    23117.096258 82665.6773   258%     -   38s
H    0     0                    23151.822323 82665.6773   257%     -   38s
H    0     0                    23157.759667 82665.6773   257%     -   38s
     0     0 75442.7967    0  242 23157.7597 75442.7967   226%     -  214s
H    0     0                    23345.124818 75441.9972   223%     -  216s
H    0     0                    24062.030327 75441.9972   214%     -  217s
H    0     0                    25228.650570 75441.9972   199%     -  217s
H    0     0                    26041.587996 75441.9972   190%     -  217s
     0     0 74823.8375    0  245 26041.5880 74823.8375   187%     -  290s
     0     0 74520.2890    0  253 26041.5880 74520.2890   186%     -  335s
     0     0 74429.4435    0  249 26041.5880 74429.4435   186%     -  361s
     0     0 74411.0692    0  253 26041.5880 74411.0692   186%     -  370s
     0     0 74394.1120    0  255 26041.5880 74394.1120   186%     -  375s
     0     0 74374.1930    0  251 26041.5880 74374.1930   186%     -  384s
     0     0 74366.0285    0  256 26041.5880 74366.0285   186%     -  386s
     0     0 74347.5094    0  256 26041.5880 74347.5094   185%     -  387s
     0     0 74347.4407    0  257 26041.5880 74347.4407   185%     -  387s
     0     0 70429.3044    0  311 26041.5880 70429.3044   170%     -  538s
H    0     0                    30727.494428 70429.1921   129%     -  539s
H    0     0                    34984.551908 70429.1921   101%     -  539s
     0     0 69447.0438    0  311 34984.5519 69447.0438  98.5%     -  634s
     0     0 69264.6865    0  309 34984.5519 69264.6865  98.0%     -  672s
     0     0 69027.6094    0  317 34984.5519 69027.6094  97.3%     -  708s
     0     0 68961.1505    0  261 34984.5519 68961.1505  97.1%     -  729s
     0     0 68908.7876    0  321 34984.5519 68908.7876  97.0%     -  748s
     0     0 68842.2190    0  322 34984.5519 68842.2190  96.8%     -  774s
     0     0 68829.6870    0  342 34984.5519 68829.6870  96.7%     -  789s
     0     0 68819.9499    0  340 34984.5519 68819.9499  96.7%     -  795s
     0     0 68818.0961    0  338 34984.5519 68818.0961  96.7%     -  798s
     0     0 68816.3787    0  334 34984.5519 68816.3787  96.7%     -  802s
     0     0 68814.6633    0  338 34984.5519 68814.6633  96.7%     -  806s
     0     0 68799.6605    0  339 34984.5519 68799.6605  96.7%     -  811s
     0     0 68789.2818    0  332 34984.5519 68789.2818  96.6%     -  817s
     0     0 68787.0255    0  332 34984.5519 68787.0255  96.6%     -  821s
     0     0 68785.9289    0  338 34984.5519 68785.9289  96.6%     -  825s
     0     0 66850.4027    0  336 34984.5519 66850.4027  91.1%     -  943s
H    0     0                    35232.865826 66850.3749  89.7%     -  944s
H    0     0                    35365.343031 66850.3749  89.0%     -  944s
     0     0 66379.9503    0  346 35365.3430 66379.9503  87.7%     -  999s
     0     0 66240.9603    0  325 35365.3430 66240.9603  87.3%     - 1026s
     0     0 66153.2748    0  350 35365.3430 66153.2748  87.1%     - 1052s
     0     0 66079.2803    0  361 35365.3430 66079.2803  86.8%     - 1077s
     0     0 66037.0538    0  407 35365.3430 66037.0538  86.7%     - 1093s
     0     0 66007.3862    0  399 35365.3430 66007.3862  86.6%     - 1111s
     0     0 65981.7972    0  385 35365.3430 65981.7972  86.6%     - 1128s
     0     0 65964.7436    0  393 35365.3430 65964.7436  86.5%     - 1139s
     0     0 65948.3829    0  375 35365.3430 65948.3829  86.5%     - 1149s
     0     0 65930.6901    0  351 35365.3430 65930.6901  86.4%     - 1160s
     0     0 65926.2728    0  397 35365.3430 65926.2728  86.4%     - 1167s
     0     0 65924.1950    0  398 35365.3430 65924.1950  86.4%     - 1170s
     0     0 65322.3691    0  377 35365.3430 65322.3691  84.7%     - 1247s
     0     0 65236.5312    0  374 35365.3430 65236.5312  84.5%     - 1270s
     0     0 65053.7847    0  413 35365.3430 65053.7847  83.9%     - 1303s
     0     0 65025.9750    0  385 35365.3430 65025.9750  83.9%     - 1318s
     0     0 65004.6607    0  428 35365.3430 65004.6607  83.8%     - 1331s
     0     0 64993.9903    0  427 35365.3430 64993.9903  83.8%     - 1339s
     0     0 64988.5634    0  425 35365.3430 64988.5634  83.8%     - 1343s
     0     0 64985.6014    0  427 35365.3430 64985.6014  83.8%     - 1350s
     0     0 64983.6105    0  465 35365.3430 64983.6105  83.7%     - 1353s
     0     0 64827.6839    0  343 35365.3430 64827.6839  83.3%     - 1390s
     0     0 64788.5254    0  356 35365.3430 64788.5254  83.2%     - 1412s
     0     0 64780.4743    0  356 35365.3430 64780.4743  83.2%     - 1421s
     0     0 64762.5460    0  375 35365.3430 64762.5460  83.1%     - 1435s
     0     0 64760.4466    0  401 35365.3430 64760.4466  83.1%     - 1442s
     0     0 64716.1688    0  383 35365.3430 64716.1688  83.0%     - 1464s
     0     0 64696.7510    0  392 35365.3430 64696.7510  82.9%     - 1496s
     0     0 64671.4156    0  403 35365.3430 64671.4156  82.9%     - 1514s
     0     0 64666.1139    0  364 35365.3430 64666.1139  82.9%     - 1521s
     0     0 64662.6838    0  397 35365.3430 64662.6838  82.8%     - 1525s
     0     0 64660.3957    0  401 35365.3430 64660.3957  82.8%     - 1532s
     0     0 64614.6040    0  411 35365.3430 64614.6040  82.7%     - 1556s
H    0     0                    35539.745017 64614.2978  81.8%     - 1558s
     0     0 64602.1091    0  397 35539.7450 64602.1091  81.8%     - 1570s
     0     0 64600.2486    0  363 35539.7450 64600.2486  81.8%     - 1576s
     0     0 64559.3506    0  386 35539.7450 64559.3506  81.7%     - 1603s
     0     0 64540.2818    0  426 35539.7450 64540.2818  81.6%     - 1630s
     0     0 64531.9430    0  429 35539.7450 64531.9430  81.6%     - 1637s
     0     0 64528.7522    0  434 35539.7450 64528.7522  81.6%     - 1644s
     0     0 64527.2744    0  422 35539.7450 64527.2744  81.6%     - 1646s
     0     0 64455.9487    0  425 35539.7450 64455.9487  81.4%     - 1676s
     0     0 64422.2115    0  426 35539.7450 64422.2115  81.3%     - 1698s
     0     0 64410.0214    0  440 35539.7450 64410.0214  81.2%     - 1710s
     0     0 64408.1675    0  401 35539.7450 64408.1675  81.2%     - 1714s
     0     0 64391.7175    0  400 35539.7450 64391.7175  81.2%     - 1732s
H    0     0                    36784.289694 64391.3764  75.1%     - 1735s
H    0     0                    37129.683994 64391.3764  73.4%     - 1737s
     0     0 64384.5809    0  436 37129.6840 64384.5809  73.4%     - 1749s
     0     0 64382.6011    0  416 37129.6840 64382.6011  73.4%     - 1754s
     0     0 64365.1803    0  457 37129.6840 64365.1803  73.4%     - 1769s
     0     0 64358.9547    0  454 37129.6840 64358.9547  73.3%     - 1777s
     0     0 64350.3971    0  452 37129.6840 64350.3971  73.3%     - 1789s
     0     0 64348.8654    0  453 37129.6840 64348.8654  73.3%     - 1794s
     0     0 64341.2834    0  452 37129.6840 64341.2834  73.3%     - 1804s
H    0     0                    37563.154863 64341.2538  71.3%     - 1854s
H    0     0                    38054.156454 64341.2538  69.1%     - 1857s
H    0     0                    38178.039729 64341.2538  68.5%     - 1857s
H    0     0                    38334.166642 64341.2538  67.8%     - 1857s
H    0     0                    38578.165166 64341.2538  66.8%     - 1865s
H    0     0                    38780.021747 64341.2538  65.9%     - 1865s
H    0     0                    38902.608647 64341.2538  65.4%     - 1865s
     0     0 64327.5584    0  451 38902.6086 64327.5584  65.4%     - 1884s
     0     0 64324.5488    0  441 38902.6086 64324.5488  65.3%     - 1887s
     0     0 64323.7402    0  443 38902.6086 64323.7402  65.3%     - 1889s
     0     0 64315.2827    0  433 38902.6086 64315.2827  65.3%     - 1897s
     0     0 64314.1594    0  438 38902.6086 64314.1594  65.3%     - 1905s
     0     0 64259.1505    0  415 38902.6086 64259.1505  65.2%     - 1936s
     0     0 64246.3317    0  409 38902.6086 64246.3317  65.1%     - 1948s
     0     0 64241.5071    0  414 38902.6086 64241.5071  65.1%     - 1955s
     0     0 64239.4178    0  428 38902.6086 64239.4178  65.1%     - 1960s
     0     0 64221.9324    0  464 38902.6086 64221.9324  65.1%     - 1980s
     0     0 64202.5998    0  424 38902.6086 64202.5998  65.0%     - 1994s
     0     0 64199.9741    0  415 38902.6086 64199.9741  65.0%     - 1998s
     0     0 64190.2469    0  469 38902.6086 64190.2469  65.0%     - 2011s
     0     0 64183.2346    0  457 38902.6086 64183.2346  65.0%     - 2020s
     0     0 64180.9493    0  468 38902.6086 64180.9493  65.0%     - 2025s
     0     0 64178.2848    0  474 38902.6086 64178.2848  65.0%     - 2032s
     0     0 64176.8928    0  511 38902.6086 64176.8928  65.0%     - 2038s
     0     0 64161.2745    0  463 38902.6086 64161.2745  64.9%     - 2052s
     0     0 64159.2631    0  454 38902.6086 64159.2631  64.9%     - 2057s
     0     0 64153.9255    0  419 38902.6086 64153.9255  64.9%     - 2065s
     0     0 64153.1516    0  418 38902.6086 64153.1516  64.9%     - 2069s
     0     0 64147.0916    0  420 38902.6086 64147.0916  64.9%     - 2078s
     0     0 64146.8550    0  420 38902.6086 64146.8550  64.9%     - 2085s
H    0     0                    39228.656066 64146.8550  63.5%     - 2510s
     0     2 64146.8550    0  420 39228.6561 64146.8550  63.5%     - 2517s
     1     3 64055.8905    1  401 39228.6561 64146.8550  63.5%  8587 2541s
     2     4 64091.5845    1  413 39228.6561 64091.5845  63.4%  5966 2558s
     3     5 63338.5925    2  352 39228.6561 64091.5074  63.4%  9731 2608s
     4     8 63959.4102    2  445 39228.6561 64091.4315  63.4%  8628 2642s
     7    14 63836.3939    3  412 39228.6561 63959.3566  63.0%  9145 2721s
    13    24 63737.4458    4  396 39228.6561 63959.3566  63.0% 13402 2794s
    23    34 60979.2343    5  371 39228.6561 63835.4911  62.7% 24637 2939s
    33    58 58960.6780    6  308 39228.6561 63737.4181  62.5% 22747 3423s
    57    90 61247.0626    6  364 39228.6561 63737.4181  62.5% 27993 3519s
    89   142 61218.5615    7  348 39228.6561 63737.4181  62.5% 26016 3600s

Cutting planes:
  Learned: 2
  Gomory: 6
  Implied bound: 154
  MIR: 3746
  Flow cover: 3607
  RLT: 57
  Relax-and-lift: 524
  BQP: 4

Explored 141 nodes (3801135 simplex iterations) in 3600.18 seconds (4489.48 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 39228.7 38902.6 38780 ... 36784.3

Time limit reached
Best objective 3.922865606612e+04, best bound 6.373741805338e+04, gap 62.4767%
  WARNING: Time limit reached. Using best solution found (gap: 62.48%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.22s
  Master Objective (UB) = 39228.66, θ = 228638.38
  Upper Bound (UB) = 39228.66

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 228638.38
  [DEBUG]   ✓ Scenario 0: θ = 228638.38 ≤ Q = 228638.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 228638.38 ≤ Q = 228638.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 228638.38 ≤ Q = 228638.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 228638.38 ≤ Q = 228638.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 228638.38 ≤ Q = 228638.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 228638.38 ≤ Q = 228638.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 228638.38 ≤ Q = 228638.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 228638.38 ≤ Q = 228638.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 228638.38 ≤ Q = 228638.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 228638.38 ≤ Q = 228638.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 228638.38 ≤ Q = 228638.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 228638.38 ≤ Q = 228638.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 228638.38 ≤ Q = 228638.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 228638.38 ≤ Q = 228638.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 228638.38 ≤ Q = 228638.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 228638.38 ≤ Q = 228638.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 228638.38 ≤ Q = 228638.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 228638.38 ≤ Q = 228638.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 228638.38 ≤ Q = 228638.38 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 19] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x12f48f6d
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xed0b7093
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.401722e+13
Presolve removed 2585 rows and 1875 columns
Presolve time: 0.01s
Presolved: 508 rows, 514 columns, 1439 nonzeros
Found heuristic solution: objective 6822812.3548
Variable types: 350 continuous, 164 integer (164 binary)

Root relaxation: objective -1.734967e+05, 241 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -173496.74    0  123 6822812.35 -173496.74   103%     -    0s
H    0     0                    -140457.9462 -173496.74  23.5%     -    0s
H    0     0                    -140744.8089 -173496.74  23.3%     -    0s
H    0     0                    -148184.7896 -150867.55  1.81%     -    0s
     0     0 -150867.55    0   72 -148184.79 -150867.55  1.81%     -    0s
     0     0 -149383.48    0   74 -148184.79 -149383.48  0.81%     -    0s
H    0     0                    -149050.0969 -149362.47  0.21%     -    0s
     0     0 -149290.79    0   32 -149050.10 -149290.79  0.16%     -    0s
     0     0 -149289.56    0   31 -149050.10 -149289.56  0.16%     -    0s
H    0     0                    -149097.0667 -149263.61  0.11%     -    0s
     0     0 -149221.26    0   36 -149097.07 -149221.26  0.08%     -    0s
     0     0 -149219.55    0   36 -149097.07 -149219.55  0.08%     -    0s
     0     0 -149170.79    0   13 -149097.07 -149170.79  0.05%     -    0s
     0     0 -149170.79    0   31 -149097.07 -149170.79  0.05%     -    0s
     0     0 -149136.94    0   24 -149097.07 -149136.94  0.03%     -    0s
H    0     0                    -149123.3730 -149131.94  0.01%     -    0s

Cutting planes:
  Gomory: 10
  MIR: 14
  Flow cover: 5

Explored 1 nodes (696 simplex iterations) in 0.21 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 8: -149123 -149097 -149050 ... 1.40172e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.491233730098e+05, best bound -1.491319352347e+05, gap 0.0057%
  Subproblem solved in 0.24s
  Worst-case operational profit (Z_SP) = 222323.83
  Scenario: 31 demand increases, 29 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -149123.37
  [DEBUG]   S×d_nominal = 371447.20
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 371447.20 + -149123.37 = 222323.83
  [DEBUG]   Current θ from Master = 228638.38
  [DEBUG]   ⚠️  Z_SP ≤ θ by 6314.56 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 32914.10
  Lower Bound (LB) = 38407.27
  Gap (UB-LB) = 821.3860, Absolute Gap = 821.3860, Relative Gap = 0.020938
  Not converged yet (gap = 821.39 > ε = 200)

  [DEBUG] Adding NEW scenario 19 to Master Problem...
  [DEBUG] New scenario pattern: 31 increases, 29 decreases
    [DEBUG] Scenario 19 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 19 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 19]
    [DEBUG]   - Total constraints in model: 307183
    [DEBUG]   - Total variables in model: 127060
  [DEBUG] Total scenarios in Master: 20
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 20
================================================================================
[Iteration 20] Solving Master Problem...
  Current scenarios in Master: 20
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 307183 rows, 127060 columns and 870259 nonzeros
Model fingerprint: 0x8fe8b809
Variable types: 124801 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 137520 rows and 55840 columns (presolve time = 5s)...
Presolve removed 137520 rows and 55840 columns
Presolve time: 6.95s
Presolved: 169663 rows, 71220 columns, 1043427 nonzeros
Variable types: 68961 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -314127.1816
Found heuristic solution: objective -183060.7998

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.57s

Barrier statistics:
 Dense cols : 1125
 AA' NZ     : 4.114e+06
 Factor NZ  : 1.158e+07 (roughly 200 MB of memory)
 Factor Ops : 4.122e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.02584179e+07  3.09255135e+08  1.62e+05 1.58e+01  9.55e+04    10s
   1  -1.60465595e+07  3.15310720e+08  1.17e+05 8.49e+01  7.06e+04    10s
   2  -7.35411210e+06  2.24763621e+08  5.10e+04 1.32e+00  3.27e+04    10s
   3  -1.38966440e+06  1.81779550e+08  5.98e+03 3.08e+00  4.28e+03    10s
   4  -6.28958515e+05  9.92559170e+07  8.25e+02 3.70e-01  7.91e+02    11s
   5  -5.09133560e+05  5.89416632e+07  4.00e+02 1.77e-01  3.97e+02    11s
   6  -4.57018376e+05  4.47652658e+07  2.47e+02 1.24e-01  2.65e+02    11s
   7  -4.05037295e+05  3.56237373e+07  1.17e+02 9.37e-02  1.69e+02    11s
   8  -3.49371417e+05  2.46119902e+07  6.22e+01 6.06e-02  1.04e+02    11s
   9  -2.34810735e+05  1.57983661e+07  1.87e+01 3.53e-02  5.74e+01    11s
  10  -1.79205234e+05  1.25167157e+07  1.00e+01 2.81e-02  4.36e+01    11s
  11  -1.33270261e+05  9.72271503e+06  6.13e+00 2.14e-02  3.31e+01    12s
  12  -1.15494970e+05  8.50076829e+06  3.94e+00 1.85e-02  2.86e+01    12s
  13  -9.80864382e+04  5.08672011e+06  2.20e+00 1.09e-02  1.70e+01    12s
  14  -7.24283621e+04  1.48854655e+06  7.69e-01 2.87e-03  5.08e+00    12s
  15  -4.43636642e+04  6.01673553e+05  3.80e-01 1.24e-03  2.10e+00    12s
  16  -1.26781714e+04  3.25498524e+05  1.76e-01 8.35e-04  1.10e+00    12s
  17  -4.20346858e+03  2.46420973e+05  1.50e-01 1.07e-03  8.12e-01    12s
  18   1.75475634e+04  2.08273946e+05  1.08e-01 1.19e-03  6.18e-01    12s
  19   2.26423270e+04  2.04795361e+05  9.79e-02 1.07e-03  5.90e-01    13s
  20   3.02526410e+04  1.79803804e+05  8.56e-02 1.48e-03  4.85e-01    13s
  21   3.52870418e+04  1.56730416e+05  7.71e-02 4.12e-03  3.94e-01    13s
  22   4.34867517e+04  1.45285268e+05  6.27e-02 3.60e-03  3.30e-01    13s
  23   4.89830313e+04  1.31014486e+05  5.28e-02 2.71e-03  2.66e-01    13s
  24   5.45609376e+04  1.20998956e+05  4.31e-02 2.13e-03  2.15e-01    13s
  25   6.07897768e+04  1.08569521e+05  3.24e-02 1.97e-03  1.55e-01    13s
  26   6.36472871e+04  1.05741183e+05  2.78e-02 1.40e-03  1.36e-01    14s
  27   6.73163480e+04  1.00485445e+05  2.18e-02 1.47e-03  1.07e-01    14s
  28   6.80334991e+04  9.66064288e+04  2.07e-02 1.20e-03  9.26e-02    14s
  29   7.03559473e+04  9.49152973e+04  1.69e-02 1.07e-03  7.96e-02    14s
  30   7.11149766e+04  9.21976267e+04  1.57e-02 8.67e-04  6.83e-02    14s
  31   7.30278945e+04  9.05554055e+04  1.28e-02 7.20e-04  5.68e-02    15s
  32   7.46531180e+04  8.83174525e+04  1.04e-02 5.25e-04  4.43e-02    15s
  33   7.52698855e+04  8.76398059e+04  9.47e-03 4.65e-04  4.01e-02    15s
  34   7.65192466e+04  8.66666932e+04  7.69e-03 3.76e-04  3.29e-02    15s
  35   7.76055382e+04  8.56030619e+04  6.19e-03 2.78e-04  2.59e-02    15s
  36   7.81355226e+04  8.50322673e+04  5.47e-03 2.28e-04  2.24e-02    16s
  37   7.88235476e+04  8.46283203e+04  4.52e-03 1.94e-04  1.88e-02    16s
  38   7.95162902e+04  8.40105781e+04  3.57e-03 1.41e-04  1.46e-02    16s
  39   7.99787286e+04  8.37854824e+04  2.96e-03 1.21e-04  1.23e-02    16s
  40   8.06577828e+04  8.35044589e+04  2.07e-03 9.69e-05  9.22e-03    16s
  41   8.10124316e+04  8.31487930e+04  1.62e-03 6.61e-05  6.92e-03    17s
  42   8.11090886e+04  8.28252961e+04  1.50e-03 6.54e-05  5.56e-03    17s
  43   8.16682071e+04  8.27630095e+04  8.25e-04 8.62e-05  3.55e-03    17s
  44   8.18518668e+04  8.26881761e+04  6.08e-04 6.92e-05  2.71e-03    17s
  45   8.19557139e+04  8.26153911e+04  4.81e-04 5.29e-05  2.14e-03    18s
  46   8.20137932e+04  8.25990440e+04  4.09e-04 4.95e-05  1.90e-03    18s
  47   8.20711643e+04  8.24855652e+04  3.40e-04 2.50e-05  1.34e-03    18s
  48   8.21418221e+04  8.24642726e+04  2.55e-04 2.03e-05  1.05e-03    18s
  49   8.21878671e+04  8.24372665e+04  2.01e-04 1.46e-05  8.08e-04    18s
  50   8.22755512e+04  8.24111823e+04  1.03e-04 8.82e-06  4.40e-04    19s
  51   8.23022993e+04  8.24031904e+04  7.30e-05 7.10e-06  3.27e-04    19s
  52   8.23204566e+04  8.23889886e+04  5.29e-05 4.08e-06  2.22e-04    19s
  53   8.23344844e+04  8.23805177e+04  3.69e-05 2.39e-06  1.49e-04    19s
  54   8.23609045e+04  8.23717057e+04  7.85e-06 5.84e-07  3.50e-05    19s
  55   8.23680521e+04  8.23687208e+04  5.32e-07 1.78e-08  2.17e-06    19s
  56   8.23683955e+04  8.23686103e+04  2.05e-07 1.64e-08  6.97e-07    20s
  57   8.23686097e+04  8.23686099e+04  2.74e-09 8.20e-11  6.37e-10    20s

Barrier solved model in 57 iterations and 19.79 seconds (16.49 work units)
Optimal objective 8.23686097e+04


Root crossover log...

  149189 DPushes remaining with DInf 0.0000000e+00                20s
   78566 DPushes remaining with DInf 0.0000000e+00                21s
   15986 DPushes remaining with DInf 0.0000000e+00                25s
       0 DPushes remaining with DInf 0.0000000e+00                29s

    8266 PPushes remaining with PInf 8.9864670e-05                29s
       0 PPushes remaining with PInf 0.0000000e+00                30s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.7764203e+05     30s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   77391    8.2368610e+04   0.000000e+00   1.776420e+05     30s
   77480    8.2368610e+04   0.000000e+00   0.000000e+00     30s
   77480    8.2368610e+04   0.000000e+00   0.000000e+00     30s
Concurrent spin time: 6.95s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 8.236861e+04, 77480 iterations, 28.86 seconds (29.34 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 82368.6099    0  172 -183060.80 82368.6099   145%     -   38s
H    0     0                    -176318.2931 82368.6099   147%     -   39s
H    0     0                    -150181.5729 82368.6099   155%     -   39s
H    0     0                    -149283.9784 82368.6099   155%     -   40s
H    0     0                    -144064.8358 82368.6099   157%     -   40s
H    0     0                    -143040.1613 82368.6099   158%     -   41s
H    0     0                    -142711.6009 82368.6099   158%     -   41s
H    0     0                    -78325.72581 82368.6099   205%     -   42s
H    0     0                    -22938.89926 82368.6099   459%     -   43s
H    0     0                    14958.936311 82368.6099   451%     -   43s
H    0     0                    21882.465674 82368.6099   276%     -   45s
H    0     0                    22071.047518 82368.6099   273%     -   45s
H    0     0                    22532.312669 82368.6099   266%     -   45s
H    0     0                    22616.930886 82368.6099   264%     -   45s
H    0     0                    22636.011007 82368.6099   264%     -   45s
H    0     0                    22828.093112 82368.6099   261%     -   45s
     0     0 75155.1133    0  247 22828.0931 75155.1133   229%     -  182s
H    0     0                    25522.713626 75155.0885   194%     -  185s
H    0     0                    25666.321922 75155.0885   193%     -  185s
     0     0 74787.4604    0  235 25666.3219 74787.4604   191%     -  233s
     0     0 74330.6869    0  255 25666.3219 74330.6869   190%     -  270s
     0     0 74292.5225    0  255 25666.3219 74292.5225   189%     -  276s
     0     0 74206.4396    0  255 25666.3219 74206.4396   189%     -  292s
     0     0 74194.9989    0  256 25666.3219 74194.9989   189%     -  296s
     0     0 74194.9798    0  256 25666.3219 74194.9798   189%     -  297s
     0     0 70171.7929    0  257 25666.3219 70171.7929   173%     -  467s
H    0     0                    27248.761846 70171.5936   158%     -  468s
H    0     0                    35739.320109 70171.5936  96.3%     -  468s
     0     0 69698.6981    0  305 35739.3201 69698.6981  95.0%     -  565s
     0     0 69362.3947    0  331 35739.3201 69362.3947  94.1%     -  633s
     0     0 69210.8664    0  337 35739.3201 69210.8664  93.7%     -  672s
     0     0 69197.2565    0  325 35739.3201 69197.2565  93.6%     -  682s
     0     0 69109.0836    0  340 35739.3201 69109.0836  93.4%     -  708s
     0     0 69079.7146    0  346 35739.3201 69079.7146  93.3%     -  724s
     0     0 69076.7749    0  346 35739.3201 69076.7749  93.3%     -  729s
     0     0 68933.5604    0  341 35739.3201 68933.5604  92.9%     -  757s
     0     0 68898.0256    0  355 35739.3201 68898.0256  92.8%     -  777s
     0     0 68879.9010    0  351 35739.3201 68879.9010  92.7%     -  789s
     0     0 68857.5880    0  348 35739.3201 68857.5880  92.7%     -  804s
     0     0 68852.2260    0  350 35739.3201 68852.2260  92.7%     -  816s
     0     0 68851.6142    0  345 35739.3201 68851.6142  92.6%     -  819s
     0     0 66785.6914    0  345 35739.3201 66785.6914  86.9%     -  965s
H    0     0                    36270.614297 66785.6164  84.1%     -  966s
H    0     0                    36321.922291 66785.6164  83.9%     -  966s
     0     0 66336.1399    0  341 36321.9223 66336.1399  82.6%     - 1030s
     0     0 66073.8079    0  362 36321.9223 66073.8079  81.9%     - 1094s
     0     0 65911.5270    0  346 36321.9223 65911.5270  81.5%     - 1130s
     0     0 65809.6934    0  367 36321.9223 65809.6934  81.2%     - 1158s
     0     0 65773.8473    0  373 36321.9223 65773.8473  81.1%     - 1175s
     0     0 65748.4870    0  355 36321.9223 65748.4870  81.0%     - 1191s
     0     0 65720.9446    0  348 36321.9223 65720.9446  80.9%     - 1204s
     0     0 65694.9256    0  354 36321.9223 65694.9256  80.9%     - 1221s
     0     0 65679.5908    0  353 36321.9223 65679.5908  80.8%     - 1235s
     0     0 65653.6357    0  373 36321.9223 65653.6357  80.8%     - 1260s
     0     0 65644.4673    0  376 36321.9223 65644.4673  80.7%     - 1268s
     0     0 65635.0480    0  379 36321.9223 65635.0480  80.7%     - 1278s
     0     0 65633.0038    0  374 36321.9223 65633.0038  80.7%     - 1282s
     0     0 65198.1195    0  336 36321.9223 65198.1195  79.5%     - 1366s
H    0     0                    36412.618339 65197.5181  79.1%     - 1367s
H    0     0                    36468.153160 65197.5181  78.8%     - 1367s
     0     0 65055.0048    0  341 36468.1532 65055.0048  78.4%     - 1394s
     0     0 65012.9275    0  341 36468.1532 65012.9275  78.3%     - 1415s
     0     0 65001.0647    0  337 36468.1532 65001.0647  78.2%     - 1424s
     0     0 65000.5185    0  338 36468.1532 65000.5185  78.2%     - 1426s
     0     0 64870.6208    0  385 36468.1532 64870.6208  77.9%     - 1468s
H    0     0                    36475.795229 64869.3377  77.8%     - 1469s
H    0     0                    36756.336527 64869.3377  76.5%     - 1469s
     0     0 64813.0866    0  406 36756.3365 64813.0866  76.3%     - 1505s
     0     0 64795.4433    0  405 36756.3365 64795.4433  76.3%     - 1520s
     0     0 64791.3906    0  411 36756.3365 64791.3906  76.3%     - 1528s
     0     0 64776.5358    0  394 36756.3365 64776.5358  76.2%     - 1540s
     0     0 64772.4597    0  400 36756.3365 64772.4597  76.2%     - 1545s
     0     0 64771.4297    0  400 36756.3365 64771.4297  76.2%     - 1548s
     0     0 64703.4380    0  377 36756.3365 64703.4380  76.0%     - 1579s
H    0     0                    37163.382605 64701.1215  74.1%     - 1583s
     0     0 64656.8385    0  368 37163.3826 64656.8385  74.0%     - 1608s
     0     0 64646.7749    0  408 37163.3826 64646.7749  74.0%     - 1620s
     0     0 64641.2000    0  416 37163.3826 64641.2000  73.9%     - 1628s
     0     0 64638.7609    0  423 37163.3826 64638.7609  73.9%     - 1635s
     0     0 64606.1826    0  362 37163.3826 64606.1826  73.8%     - 1659s
     0     0 64595.5652    0  347 37163.3826 64595.5652  73.8%     - 1668s
     0     0 64589.1720    0  353 37163.3826 64589.1720  73.8%     - 1674s
     0     0 64584.4690    0  357 37163.3826 64584.4690  73.8%     - 1679s
     0     0 64581.8027    0  363 37163.3826 64581.8027  73.8%     - 1684s
     0     0 64581.3366    0  356 37163.3826 64581.3366  73.8%     - 1686s
     0     0 64524.1235    0  399 37163.3826 64524.1235  73.6%     - 1721s
     0     0 64504.3019    0  415 37163.3826 64504.3019  73.6%     - 1744s
     0     0 64491.1620    0  362 37163.3826 64491.1620  73.5%     - 1754s
     0     0 64486.4960    0  363 37163.3826 64486.4960  73.5%     - 1762s
     0     0 64484.1727    0  354 37163.3826 64484.1727  73.5%     - 1769s
     0     0 64463.0577    0  427 37163.3826 64463.0577  73.5%     - 1795s
     0     0 64452.5520    0  431 37163.3826 64452.5520  73.4%     - 1808s
     0     0 64447.4578    0  391 37163.3826 64447.4578  73.4%     - 1814s
     0     0 64446.9038    0  394 37163.3826 64446.9038  73.4%     - 1816s
     0     0 64414.8176    0  452 37163.3826 64414.8176  73.3%     - 1840s
     0     0 64402.7203    0  454 37163.3826 64402.7203  73.3%     - 1858s
     0     0 64393.8507    0  468 37163.3826 64393.8507  73.3%     - 1869s
     0     0 64389.9664    0  479 37163.3826 64389.9664  73.3%     - 1884s
     0     0 64388.7184    0  462 37163.3826 64388.7184  73.3%     - 1889s
     0     0 64382.4396    0  474 37163.3826 64382.4396  73.2%     - 1899s
H    0     0                    37177.354744 64381.6491  73.2%     - 1901s
     0     0 64376.7662    0  422 37177.3547 64376.7662  73.2%     - 1911s
     0     0 64373.9095    0  430 37177.3547 64373.9095  73.2%     - 1919s
     0     0 64371.2112    0  426 37177.3547 64371.2112  73.1%     - 1925s
     0     0 64370.1763    0  420 37177.3547 64370.1763  73.1%     - 1927s
     0     0 64360.4007    0  423 37177.3547 64360.4007  73.1%     - 1940s
H    0     0                    37591.952671 64360.1096  71.2%     - 1994s
     0     0 64357.9662    0  425 37591.9527 64357.9662  71.2%     - 2000s
     0     0 64325.1984    0  453 37591.9527 64325.1984  71.1%     - 2023s
H    0     0                    37686.653992 64324.9373  70.7%     - 2024s
H    0     0                    37690.594960 64324.9373  70.7%     - 2024s
H    0     0                    37697.698067 64324.9373  70.6%     - 2024s
     0     0 64321.2475    0  420 37697.6981 64321.2475  70.6%     - 2032s
     0     0 64318.6505    0  426 37697.6981 64318.6505  70.6%     - 2039s
     0     0 64316.9950    0  426 37697.6981 64316.9950  70.6%     - 2044s
     0     0 64301.0627    0  419 37697.6981 64301.0627  70.6%     - 2058s
     0     0 64292.4037    0  419 37697.6981 64292.4037  70.5%     - 2071s
     0     0 64289.7383    0  462 37697.6981 64289.7383  70.5%     - 2080s
     0     0 64287.3857    0  424 37697.6981 64287.3857  70.5%     - 2083s
     0     0 64276.3142    0  426 37697.6981 64276.3142  70.5%     - 2096s
     0     0 64275.1438    0  438 37697.6981 64275.1438  70.5%     - 2100s
     0     0 64273.5751    0  419 37697.6981 64273.5751  70.5%     - 2106s
     0     0 64273.2571    0  419 37697.6981 64273.2571  70.5%     - 2113s
H    0     0                    37835.332858 64273.1569  69.9%     - 2539s
H    0     0                    38639.350798 64273.1569  66.3%     - 2539s
H    0     0                    39221.889730 64273.1569  63.9%     - 2546s
     0     2 64273.1569    0  419 39221.8897 64273.1569  63.9%     - 2623s
     1     3 64134.4270    1  353 39221.8897 64273.1569  63.9% 10821 2650s
     2     4 64193.2566    1  439 39221.8897 64193.2566  63.7%  9316 2667s
     3     5 63040.7103    2  356 39221.8897 64193.2307  63.7% 13679 2737s
     4     8 64013.3106    2  379 39221.8897 64193.2082  63.7% 12489 2774s
     7    12 63954.1824    3  377 39221.8897 64012.7380  63.2% 12088 2907s
    11    21 63835.3995    4  379 39221.8897 64012.7380  63.2% 16571 2972s
    20    30 61386.5196    4  310 39221.8897 63953.9800  63.1% 23799 3180s
    29    52 58220.5889    5  333 39221.8897 63835.3519  62.8% 25171 3600s

Cutting planes:
  Learned: 3
  Gomory: 7
  Implied bound: 176
  MIR: 3636
  Flow cover: 3076
  RLT: 67
  Relax-and-lift: 550

Explored 51 nodes (2303873 simplex iterations) in 3600.18 seconds (4360.95 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 39221.9 38639.4 37835.3 ... 36756.3

Time limit reached
Best objective 3.922188973049e+04, best bound 6.383535185165e+04, gap 62.7544%
  WARNING: Time limit reached. Using best solution found (gap: 62.75%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.21s
  Master Objective (UB) = 39221.89, θ = 228016.73
  Upper Bound (UB) = 39221.89

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 228016.73
  [DEBUG]   ✓ Scenario 0: θ = 228016.73 ≤ Q = 228016.73 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 228016.73 ≤ Q = 228016.73 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 228016.73 ≤ Q = 228016.73 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 228016.73 ≤ Q = 228016.73 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 228016.73 ≤ Q = 228016.73 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 228016.73 ≤ Q = 228016.73 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 228016.73 ≤ Q = 228016.73 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 228016.73 ≤ Q = 228016.73 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 228016.73 ≤ Q = 228016.73 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 228016.73 ≤ Q = 228016.73 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 228016.73 ≤ Q = 228016.73 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 228016.73 ≤ Q = 228016.73 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 228016.73 ≤ Q = 228016.73 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 228016.73 ≤ Q = 228016.73 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 228016.73 ≤ Q = 228016.73 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 228016.73 ≤ Q = 228016.73 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 228016.73 ≤ Q = 228016.73 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 228016.73 ≤ Q = 228016.73 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 228016.73 ≤ Q = 228016.73 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 228016.73 ≤ Q = 228016.73 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 20] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x37a6f10a
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xc8590ef6
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.404013e+13
Presolve removed 2586 rows and 1876 columns
Presolve time: 0.01s
Presolved: 507 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 6811116.8677
Variable types: 349 continuous, 164 integer (164 binary)

Root relaxation: objective -1.741339e+05, 243 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -174133.91    0  123 6811116.87 -174133.91   103%     -    0s
H    0     0                    -141065.3676 -174133.91  23.4%     -    0s
H    0     0                    -141352.2302 -174133.91  23.2%     -    0s
     0     0 -148800.90    0   64 -141352.23 -148800.90  5.27%     -    0s
H    0     0                    -147331.2709 -148795.71  0.99%     -    0s
H    0     0                    -147370.1115 -148795.71  0.97%     -    0s
H    0     0                    -147567.3592 -148795.71  0.83%     -    0s
     0     0 -147958.74    0   38 -147567.36 -147958.74  0.27%     -    0s
     0     0 -147864.56    0   30 -147567.36 -147864.56  0.20%     -    0s
     0     0 -147804.67    0   24 -147567.36 -147804.67  0.16%     -    0s
     0     0 -147792.98    0   25 -147567.36 -147792.98  0.15%     -    0s
     0     0 -147694.87    0   10 -147567.36 -147694.87  0.09%     -    0s
H    0     0                    -147588.1785 -147688.79  0.07%     -    0s
     0     0 -147688.79    0   10 -147588.18 -147688.79  0.07%     -    0s
     0     0 -147670.78    0    7 -147588.18 -147670.78  0.06%     -    0s
     0     0 -147670.78    0   24 -147588.18 -147670.78  0.06%     -    0s
H    0     0                    -147607.9686 -147670.78  0.04%     -    0s
*    0     0               0    -147658.3899 -147658.39  0.00%     -    0s

Cutting planes:
  Gomory: 5
  Implied bound: 1
  MIR: 17
  Flow cover: 5
  RLT: 3
  Relax-and-lift: 1

Explored 1 nodes (616 simplex iterations) in 0.15 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -147658 -147608 -147588 ... 1.40401e+13
No other solutions better than -147658

Optimal solution found (tolerance 1.00e-04)
Best objective -1.476583899423e+05, best bound -1.476583899423e+05, gap 0.0000%
  Subproblem solved in 0.18s
  Worst-case operational profit (Z_SP) = 223788.81
  Scenario: 13 demand increases, 47 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -147658.39
  [DEBUG]   S×d_nominal = 371447.20
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 371447.20 + -147658.39 = 223788.81
  [DEBUG]   Current θ from Master = 228016.73
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4227.92 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 34993.97
  Lower Bound (LB) = 38407.27
  Gap (UB-LB) = 814.6197, Absolute Gap = 814.6197, Relative Gap = 0.020770
  Not converged yet (gap = 814.62 > ε = 200)

  [DEBUG] Adding NEW scenario 20 to Master Problem...
  [DEBUG] New scenario pattern: 13 increases, 47 decreases
    [DEBUG] Scenario 20 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 20 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 20]
    [DEBUG]   - Total constraints in model: 322473
    [DEBUG]   - Total variables in model: 133300
  [DEBUG] Total scenarios in Master: 21
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 21
================================================================================
[Iteration 21] Solving Master Problem...
  Current scenarios in Master: 21
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 322473 rows, 133300 columns and 913496 nonzeros
Model fingerprint: 0x91a46845
Variable types: 131041 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 144408 rows and 58638 columns (presolve time = 5s)...
Presolve removed 144408 rows and 58638 columns
Presolve time: 5.97s
Presolved: 178065 rows, 74662 columns, 1094995 nonzeros
Variable types: 72403 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -313100.6823
Found heuristic solution: objective -183060.7998

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 2.17s

Barrier statistics:
 Dense cols : 1123
 AA' NZ     : 4.468e+06
 Factor NZ  : 1.240e+07 (roughly 200 MB of memory)
 Factor Ops : 4.185e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.07981176e+07  3.22278540e+08  1.66e+05 1.57e+01  9.76e+04    11s
   1  -1.65133209e+07  3.31228716e+08  1.20e+05 8.85e+01  7.22e+04    11s
   2  -7.57243386e+06  2.35807071e+08  5.24e+04 1.56e+00  3.34e+04    11s
   3  -1.42607280e+06  1.91114060e+08  6.19e+03 3.71e+00  4.41e+03    11s
   4  -6.44768907e+05  1.06638592e+08  8.56e+02 4.27e-01  8.16e+02    11s
   5  -5.20017055e+05  6.65643795e+07  4.14e+02 2.34e-01  4.21e+02    11s
   6  -4.72618937e+05  4.97989122e+07  2.76e+02 1.61e-01  2.88e+02    11s
   7  -4.12759794e+05  4.00064082e+07  1.18e+02 1.23e-01  1.78e+02    12s
   8  -3.68293077e+05  2.64250728e+07  6.82e+01 7.64e-02  1.09e+02    12s
   9  -2.63842158e+05  1.79886509e+07  2.25e+01 4.88e-02  6.32e+01    12s
  10  -1.86268336e+05  1.26346682e+07  8.75e+00 3.31e-02  4.16e+01    12s
  11  -1.41497960e+05  9.62281495e+06  5.56e+00 2.48e-02  3.11e+01    12s
  12  -1.20115601e+05  8.00863994e+06  3.69e+00 2.05e-02  2.56e+01    12s
  13  -1.00041139e+05  5.25716685e+06  1.90e+00 1.32e-02  1.67e+01    12s
  14  -7.19880760e+04  1.39629931e+06  6.84e-01 3.31e-03  4.55e+00    13s
  15  -4.18814396e+04  5.84852686e+05  3.34e-01 1.46e-03  1.94e+00    13s
  16  -1.01518967e+04  3.22664114e+05  1.56e-01 7.17e-04  1.03e+00    13s
  17   1.08632373e+04  2.06805517e+05  1.18e-01 1.86e-03  6.05e-01    13s
  18   2.42452111e+04  1.72972874e+05  9.64e-02 3.20e-03  4.59e-01    13s
  19   2.88854224e+04  1.61352645e+05  8.98e-02 2.11e-03  4.09e-01    13s
  20   3.70947637e+04  1.51395254e+05  7.64e-02 2.23e-03  3.53e-01    14s
  21   4.17291958e+04  1.35028108e+05  6.78e-02 1.51e-03  2.88e-01    14s
  22   4.93469372e+04  1.23838899e+05  5.59e-02 1.61e-03  2.30e-01    14s
  23   5.25223410e+04  1.15481534e+05  5.02e-02 1.26e-03  1.95e-01    14s
  24   5.66600502e+04  1.05938171e+05  4.28e-02 9.13e-04  1.52e-01    14s
  25   6.14124140e+04  9.99430847e+04  3.46e-02 7.49e-04  1.19e-01    14s
  26   6.55767480e+04  9.70318025e+04  2.75e-02 7.24e-04  9.72e-02    15s
  27   6.76167637e+04  9.32560495e+04  2.38e-02 5.66e-04  7.92e-02    15s
  28   6.83493127e+04  9.06431465e+04  2.25e-02 4.85e-04  6.89e-02    15s
  29   6.98552490e+04  8.87831657e+04  2.00e-02 3.94e-04  5.85e-02    15s
  30   7.03760846e+04  8.82712221e+04  1.91e-02 3.64e-04  5.53e-02    16s
  31   7.31189573e+04  8.72690866e+04  1.45e-02 2.92e-04  4.37e-02    16s
  32   7.47083321e+04  8.60047023e+04  1.19e-02 2.15e-04  3.49e-02    16s
  33   7.57048138e+04  8.52144199e+04  1.03e-02 1.71e-04  2.94e-02    16s
  34   7.65808880e+04  8.47666098e+04  8.93e-03 1.51e-04  2.53e-02    16s
  35   7.67431112e+04  8.42913237e+04  8.68e-03 1.14e-04  2.33e-02    17s
  36   7.77304884e+04  8.41430858e+04  7.20e-03 1.03e-04  1.98e-02    17s
  37   7.79684877e+04  8.39551445e+04  6.84e-03 9.50e-05  1.85e-02    17s
  38   7.82386982e+04  8.36915606e+04  6.42e-03 7.78e-05  1.69e-02    17s
  39   7.87950397e+04  8.34956471e+04  5.53e-03 9.63e-05  1.45e-02    18s
  40   7.95964513e+04  8.32783466e+04  4.28e-03 7.56e-05  1.14e-02    18s
  41   7.98533610e+04  8.30869324e+04  3.89e-03 7.13e-05  1.00e-02    18s
  42   8.02640463e+04  8.29262102e+04  3.27e-03 1.47e-04  8.23e-03    18s
  43   8.04942316e+04  8.28175968e+04  2.91e-03 1.22e-04  7.19e-03    18s
  44   8.09609143e+04  8.27853751e+04  2.20e-03 1.10e-04  5.64e-03    19s
  45   8.11622008e+04  8.26795929e+04  1.89e-03 7.11e-05  4.69e-03    19s
  46   8.13764318e+04  8.26394086e+04  1.57e-03 5.85e-05  3.91e-03    19s
  47   8.16056742e+04  8.25591393e+04  1.22e-03 3.26e-05  2.95e-03    19s
  48   8.16541123e+04  8.25533700e+04  1.14e-03 3.08e-05  2.78e-03    20s
  49   8.18041474e+04  8.25208240e+04  9.24e-04 2.04e-05  2.22e-03    20s
  50   8.19129331e+04  8.25034491e+04  7.69e-04 1.48e-05  1.83e-03    20s
  51   8.20604860e+04  8.24874972e+04  5.53e-04 9.70e-06  1.32e-03    20s
  52   8.20781276e+04  8.24830384e+04  5.27e-04 8.42e-06  1.25e-03    20s
  53   8.21379330e+04  8.24808263e+04  4.44e-04 7.77e-06  1.06e-03    21s
  54   8.22896542e+04  8.24744972e+04  2.36e-04 8.54e-06  5.72e-04    21s
  55   8.23357197e+04  8.24668530e+04  1.68e-04 4.38e-06  4.06e-04    21s
  56   8.23728093e+04  8.24625205e+04  1.14e-04 2.50e-06  2.77e-04    21s
  57   8.23928876e+04  8.24582043e+04  8.70e-05 3.73e-07  2.02e-04    22s
  58   8.24048830e+04  8.24579691e+04  7.01e-05 2.72e-07  1.64e-04    22s
  59   8.24177420e+04  8.24574138e+04  5.20e-05 1.38e-07  1.23e-04    22s
  60   8.24435153e+04  8.24570277e+04  1.62e-05 7.61e-08  4.18e-05    22s
  61   8.24534515e+04  8.24565472e+04  3.39e-06 2.23e-08  9.57e-06    22s
  62   8.24559822e+04  8.24563436e+04  6.84e-07 2.70e-07  1.12e-06    23s
  63   8.24562227e+04  8.24563004e+04  1.66e-07 2.15e-09  2.41e-07    23s
  64   8.24562889e+04  8.24563002e+04  5.83e-07 1.86e-07  3.53e-08    23s
  65   8.24563000e+04  8.24563002e+04  3.11e-07 6.12e-08  5.43e-10    23s

Barrier solved model in 65 iterations and 23.03 seconds (19.99 work units)
Optimal objective 8.24563000e+04


Root crossover log...

  156628 DPushes remaining with DInf 0.0000000e+00                23s
   58195 DPushes remaining with DInf 0.0000000e+00                25s
       0 DPushes remaining with DInf 0.0000000e+00                30s

    7753 PPushes remaining with PInf 9.2919702e-05                30s
    4688 PPushes remaining with PInf 1.9295288e-05                30s
       0 PPushes remaining with PInf 0.0000000e+00                31s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.0214069e+04     31s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   79368    8.2456300e+04   0.000000e+00   1.021407e+04     31s
   79459    8.2456300e+04   0.000000e+00   0.000000e+00     31s
   79459    8.2456300e+04   0.000000e+00   0.000000e+00     31s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 8.245630e+04, 79459 iterations, 24.23 seconds (28.21 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 82456.3002    0  176 -183060.80 82456.3002   145%     -   32s
H    0     0                    -74632.28897 82456.3002   210%     -   34s
H    0     0                    -20168.99672 82456.3002   509%     -   35s
H    0     0                    14360.548346 82456.3002   474%     -   36s
H    0     0                    21640.133764 82456.3002   281%     -   37s
H    0     0                    22684.188864 82456.3002   263%     -   37s
H    0     0                    22828.093112 82456.3002   261%     -   37s
     0     0 75540.7644    0  233 22828.0931 75540.7644   231%     -  159s
H    0     0                    22928.661835 75540.6069   229%     -  162s
     0     0 74910.9175    0  245 22928.6618 74910.9175   227%     -  229s
     0     0 74818.4326    0  241 22928.6618 74818.4326   226%     -  256s
     0     0 74739.3059    0  243 22928.6618 74739.3059   226%     -  298s
     0     0 74625.6540    0  251 22928.6618 74625.6540   225%     -  329s
     0     0 74563.5322    0  253 22928.6618 74563.5322   225%     -  354s
     0     0 74561.1722    0  256 22928.6618 74561.1722   225%     -  358s
     0     0 74324.5058    0  257 22928.6618 74324.5058   224%     -  405s
     0     0 74297.3076    0  259 22928.6618 74297.3076   224%     -  413s
     0     0 74293.6942    0  264 22928.6618 74293.6942   224%     -  416s
     0     0 74284.2343    0  259 22928.6618 74284.2343   224%     -  420s
     0     0 74282.4144    0  256 22928.6618 74282.4144   224%     -  422s
     0     0 74282.3577    0  256 22928.6618 74282.3577   224%     -  423s
     0     0 70495.5245    0  251 22928.6618 70495.5245   207%     -  580s
H    0     0                    38045.431590 70495.3017  85.3%     -  582s
H    0     0                    38074.753347 70495.3017  85.1%     -  582s
     0     0 69792.0682    0  254 38074.7533 69792.0682  83.3%     -  687s
     0     0 69570.4957    0  311 38074.7533 69570.4957  82.7%     -  749s
     0     0 69521.7995    0  311 38074.7533 69521.7995  82.6%     -  775s
     0     0 69489.8886    0  321 38074.7533 69489.8886  82.5%     -  797s
     0     0 69421.1998    0  326 38074.7533 69421.1998  82.3%     -  824s
     0     0 69414.0915    0  328 38074.7533 69414.0915  82.3%     -  832s
     0     0 69383.9001    0  277 38074.7533 69383.9001  82.2%     -  848s
     0     0 69377.4554    0  329 38074.7533 69377.4554  82.2%     -  858s
     0     0 69373.0940    0  330 38074.7533 69373.0940  82.2%     -  864s
     0     0 69358.1414    0  328 38074.7533 69358.1414  82.2%     -  871s
     0     0 69349.3752    0  333 38074.7533 69349.3752  82.1%     -  877s
     0     0 69311.0398    0  330 38074.7533 69311.0398  82.0%     -  892s
     0     0 69302.3104    0  329 38074.7533 69302.3104  82.0%     -  901s
     0     0 69301.1316    0  332 38074.7533 69301.1316  82.0%     -  904s
     0     0 66749.0041    0  304 38074.7533 66749.0041  75.3%     - 1057s
H    0     0                    38289.661762 66747.9499  74.3%     - 1059s
H    0     0                    38349.939458 66747.9499  74.0%     - 1059s
     0     0 66097.2466    0  403 38349.9395 66097.2466  72.4%     - 1145s
     0     0 65919.7956    0  357 38349.9395 65919.7956  71.9%     - 1184s
     0     0 65796.4324    0  386 38349.9395 65796.4324  71.6%     - 1227s
     0     0 65744.9392    0  350 38349.9395 65744.9392  71.4%     - 1253s
     0     0 65665.9619    0  394 38349.9395 65665.9619  71.2%     - 1285s
     0     0 65645.8595    0  402 38349.9395 65645.8595  71.2%     - 1296s
     0     0 65637.1915    0  399 38349.9395 65637.1915  71.2%     - 1305s
     0     0 65581.5090    0  356 38349.9395 65581.5090  71.0%     - 1334s
     0     0 65562.0839    0  360 38349.9395 65562.0839  71.0%     - 1346s
     0     0 65554.7626    0  362 38349.9395 65554.7626  70.9%     - 1354s
     0     0 65551.6594    0  361 38349.9395 65551.6594  70.9%     - 1360s
     0     0 65545.4793    0  358 38349.9395 65545.4793  70.9%     - 1370s
     0     0 65539.6318    0  368 38349.9395 65539.6318  70.9%     - 1379s
     0     0 65539.0804    0  361 38349.9395 65539.0804  70.9%     - 1381s
     0     0 65087.4382    0  358 38349.9395 65087.4382  69.7%     - 1458s
     0     0 64910.8474    0  382 38349.9395 64910.8474  69.3%     - 1510s
     0     0 64859.7996    0  443 38349.9395 64859.7996  69.1%     - 1536s
     0     0 64846.7901    0  434 38349.9395 64846.7901  69.1%     - 1547s
     0     0 64835.1435    0  433 38349.9395 64835.1435  69.1%     - 1558s
     0     0 64826.0276    0  379 38349.9395 64826.0276  69.0%     - 1569s
     0     0 64823.2288    0  443 38349.9395 64823.2288  69.0%     - 1575s
     0     0 64821.4468    0  437 38349.9395 64821.4468  69.0%     - 1580s
     0     0 64716.5487    0  467 38349.9395 64716.5487  68.8%     - 1623s
H    0     0                    38358.016954 64715.8206  68.7%     - 1625s
H    0     0                    38490.333032 64715.8206  68.1%     - 1625s
H    0     0                    38504.711403 64715.8206  68.1%     - 1625s
     0     0 64669.8284    0  466 38504.7114 64669.8284  68.0%     - 1644s
     0     0 64662.0250    0  456 38504.7114 64662.0250  67.9%     - 1653s
     0     0 64658.5912    0  439 38504.7114 64658.5912  67.9%     - 1660s
     0     0 64653.5967    0  462 38504.7114 64653.5967  67.9%     - 1665s
     0     0 64650.4924    0  464 38504.7114 64650.4924  67.9%     - 1669s
     0     0 64649.1656    0  463 38504.7114 64649.1656  67.9%     - 1671s
     0     0 64594.3811    0  431 38504.7114 64594.3811  67.8%     - 1700s
     0     0 64562.6857    0  411 38504.7114 64562.6857  67.7%     - 1749s
     0     0 64547.2113    0  439 38504.7114 64547.2113  67.6%     - 1761s
     0     0 64543.6992    0  445 38504.7114 64543.6992  67.6%     - 1768s
     0     0 64542.1954    0  442 38504.7114 64542.1954  67.6%     - 1773s
     0     0 64509.0042    0  463 38504.7114 64509.0042  67.5%     - 1801s
     0     0 64497.8967    0  471 38504.7114 64497.8967  67.5%     - 1811s
     0     0 64495.9243    0  473 38504.7114 64495.9243  67.5%     - 1816s
     0     0 64476.5013    0  421 38504.7114 64476.5013  67.5%     - 1835s
     0     0 64472.5452    0  430 38504.7114 64472.5452  67.4%     - 1852s
     0     0 64466.6333    0  470 38504.7114 64466.6333  67.4%     - 1864s
     0     0 64461.5664    0  487 38504.7114 64461.5664  67.4%     - 1871s
     0     0 64459.7431    0  455 38504.7114 64459.7431  67.4%     - 1882s
     0     0 64449.8506    0  496 38504.7114 64449.8506  67.4%     - 1901s
     0     0 64444.2966    0  487 38504.7114 64444.2966  67.4%     - 1915s
     0     0 64442.0344    0  492 38504.7114 64442.0344  67.4%     - 1922s
     0     0 64423.4679    0  492 38504.7114 64423.4679  67.3%     - 1941s
     0     0 64420.8899    0  455 38504.7114 64420.8899  67.3%     - 1953s
     0     0 64419.9356    0  490 38504.7114 64419.9356  67.3%     - 1957s
     0     0 64416.9084    0  449 38504.7114 64416.9084  67.3%     - 1966s
H    0     0                    38700.924780 64416.8125  66.4%     - 1969s
     0     0 64413.5169    0  453 38700.9248 64413.5169  66.4%     - 1976s
     0     0 64412.6146    0  454 38700.9248 64412.6146  66.4%     - 1979s
     0     0 64406.4767    0  453 38700.9248 64406.4767  66.4%     - 1992s
H    0     0                    39004.203051 64405.8854  65.1%     - 2072s
H    0     0                    39029.741321 64405.8854  65.0%     - 2072s
H    0     0                    39177.642410 64405.8854  64.4%     - 2072s
H    0     0                    39241.239289 64405.8854  64.1%     - 2091s
     0     0 64404.1129    0  447 39241.2393 64404.1129  64.1%     - 2101s
     0     0 64401.2718    0  412 39241.2393 64401.2718  64.1%     - 2108s
     0     0 64400.1917    0  449 39241.2393 64400.1917  64.1%     - 2118s
     0     0 64399.4084    0  416 39241.2393 64399.4084  64.1%     - 2124s
     0     0 64399.4058    0  416 39241.2393 64399.4058  64.1%     - 2133s
     0     2 64399.3973    0  416 39241.2393 64399.3973  64.1%     - 2807s
     1     3 64242.4211    1  367 39241.2393 64398.8303  64.1% 19411 2871s
     2     4 64322.0329    1  406 39241.2393 64322.0329  63.9% 13560 2894s
     3     5 61801.0476    2  313 39241.2393 64321.6604  63.9% 24013 3024s
     4     7 64262.2295    2  458 39241.2393 64321.6604  63.9% 19843 3092s
     6    12 64180.6801    3  399 39241.2393 64321.6604  63.9% 19320 3168s
    11    24 64052.7184    4  437 39241.2393 64262.1822  63.8% 17174 3246s
    23    35 61821.6410    5  346 39241.2393 64092.3023  63.3% 28045 3600s

Cutting planes:
  Learned: 3
  Gomory: 10
  Implied bound: 155
  MIR: 3413
  Flow cover: 3093
  RLT: 62
  Relax-and-lift: 568
  PSD: 1

Explored 34 nodes (1711163 simplex iterations) in 3600.16 seconds (4456.93 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 39241.2 39177.6 39029.7 ... 38289.7

Time limit reached
Best objective 3.924123928890e+04, best bound 6.409230228462e+04, gap 63.3289%
  WARNING: Time limit reached. Using best solution found (gap: 63.33%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.20s
  Master Objective (UB) = 39241.24, θ = 227326.73
  Upper Bound (UB) = 39241.24

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 227326.73
  [DEBUG]   ✓ Scenario 0: θ = 227326.73 ≤ Q = 227326.73 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 227326.73 ≤ Q = 227326.73 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 227326.73 ≤ Q = 227326.73 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 227326.73 ≤ Q = 227326.73 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 227326.73 ≤ Q = 227326.73 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 227326.73 ≤ Q = 227326.73 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 227326.73 ≤ Q = 227326.73 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 227326.73 ≤ Q = 227326.73 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 227326.73 ≤ Q = 227326.73 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 227326.73 ≤ Q = 227326.73 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 227326.73 ≤ Q = 227326.73 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 227326.73 ≤ Q = 227326.73 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 227326.73 ≤ Q = 227326.73 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 227326.73 ≤ Q = 227326.73 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 227326.73 ≤ Q = 227326.73 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 227326.73 ≤ Q = 227326.73 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 227326.73 ≤ Q = 227326.73 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 227326.73 ≤ Q = 227326.73 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 227326.73 ≤ Q = 227326.73 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 227326.73 ≤ Q = 227326.73 (slack: -0.00)
  [DEBUG]   ✓ Scenario 20: θ = 227326.73 ≤ Q = 227326.73 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 21] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x37f231b7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x37f231b7
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.411833e+13
Presolve removed 2584 rows and 1874 columns
Presolve time: 0.01s
Presolved: 509 rows, 515 columns, 1439 nonzeros
Found heuristic solution: objective 6796576.8706
Variable types: 351 continuous, 164 integer (164 binary)

Root relaxation: objective -1.746689e+05, 245 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -174668.95    0  123 6796576.87 -174668.95   103%     -    0s
H    0     0                    -141587.3571 -174668.95  23.4%     -    0s
H    0     0                    -141919.7884 -174668.95  23.1%     -    0s
     0     0 -150865.77    0   48 -141919.79 -150865.77  6.30%     -    0s
H    0     0                    -149181.9889 -150736.47  1.04%     -    0s
H    0     0                    -149491.9329 -150736.47  0.83%     -    0s
H    0     0                    -149739.9688 -150736.47  0.67%     -    0s
     0     0 -150188.08    0   37 -149739.97 -150188.08  0.30%     -    0s
     0     0 -150171.87    0   29 -149739.97 -150171.87  0.29%     -    0s
     0     0 -149936.23    0    9 -149739.97 -149936.23  0.13%     -    0s
     0     0 -149867.98    0   17 -149739.97 -149867.98  0.09%     -    0s
     0     0 -149867.98    0   16 -149739.97 -149867.98  0.09%     -    0s
     0     0 -149867.98    0    9 -149739.97 -149867.98  0.09%     -    0s
     0     0 -149838.92    0    9 -149739.97 -149838.92  0.07%     -    0s
     0     0 -149838.92    0   11 -149739.97 -149838.92  0.07%     -    0s
H    0     0                    -149756.1540 -149838.92  0.06%     -    0s
     0     0          -    0      -149756.15 -149770.44  0.01%     -    0s

Cutting planes:
  Gomory: 3
  Implied bound: 4
  MIR: 7
  Flow cover: 4
  Relax-and-lift: 1

Explored 1 nodes (612 simplex iterations) in 0.11 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 8: -149756 -149740 -149384 ... 1.41183e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.497561540138e+05, best bound -1.497704356400e+05, gap 0.0095%
  Subproblem solved in 0.14s
  Worst-case operational profit (Z_SP) = 221691.05
  Scenario: 16 demand increases, 44 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -149756.15
  [DEBUG]   S×d_nominal = 371447.20
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 371447.20 + -149756.15 = 221691.05
  [DEBUG]   Current θ from Master = 227326.73
  [DEBUG]   ⚠️  Z_SP ≤ θ by 5635.68 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 33605.56
  Lower Bound (LB) = 38407.27
  Gap (UB-LB) = 833.9692, Absolute Gap = 833.9692, Relative Gap = 0.021252
  Not converged yet (gap = 833.97 > ε = 200)

  [DEBUG] Adding NEW scenario 21 to Master Problem...
  [DEBUG] New scenario pattern: 16 increases, 44 decreases
    [DEBUG] Scenario 21 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 21 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 21]
    [DEBUG]   - Total constraints in model: 337763
    [DEBUG]   - Total variables in model: 139540
  [DEBUG] Total scenarios in Master: 22
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 22
================================================================================
[Iteration 22] Solving Master Problem...
  Current scenarios in Master: 22
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 337763 rows, 139540 columns and 956733 nonzeros
Model fingerprint: 0xd1b17dad
Variable types: 137281 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 151276 rows and 61426 columns (presolve time = 5s)...
Presolve removed 151276 rows and 61426 columns (presolve time = 10s)...
Presolve removed 151276 rows and 61426 columns
Presolve time: 10.84s
Presolved: 186487 rows, 78114 columns, 1147304 nonzeros
Variable types: 75855 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -311899.6497
Found heuristic solution: objective -183060.7998

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 2.35s

Barrier statistics:
 Dense cols : 1124
 AA' NZ     : 4.825e+06
 Factor NZ  : 1.331e+07 (roughly 200 MB of memory)
 Factor Ops : 4.520e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.13752346e+07  3.35395061e+08  1.70e+05 1.51e+01  9.99e+04    16s
   1  -1.69944578e+07  3.47066627e+08  1.23e+05 9.15e+01  7.40e+04    16s
   2  -7.18109546e+06  2.48467021e+08  5.14e+04 1.54e+00  3.27e+04    16s
   3  -1.48512153e+06  2.02213405e+08  6.40e+03 2.22e+00  4.52e+03    16s
   4  -6.73917428e+05  1.10491163e+08  8.18e+02 5.05e-01  7.89e+02    17s
   5  -5.27916111e+05  6.26605869e+07  3.95e+02 2.09e-01  3.86e+02    17s
   6  -4.54256898e+05  4.78604632e+07  2.37e+02 1.49e-01  2.55e+02    17s
   7  -3.93903813e+05  3.54477111e+07  1.17e+02 1.01e-01  1.56e+02    17s
   8  -3.20759867e+05  2.47260171e+07  5.53e+01 6.58e-02  9.41e+01    17s
   9  -1.89395856e+05  1.68443107e+07  1.35e+01 4.21e-02  5.41e+01    17s
  10  -1.56633394e+05  1.06731566e+07  9.41e+00 2.59e-02  3.38e+01    17s
  11  -1.38974710e+05  8.15234428e+06  7.12e+00 1.96e-02  2.56e+01    18s
  12  -1.24072782e+05  5.81708709e+06  4.94e+00 1.37e-02  1.81e+01    18s
  13  -8.77690570e+04  4.31815188e+06  1.73e+00 1.01e-02  1.31e+01    18s
  14  -6.48753285e+04  3.46480537e+06  6.62e-01 8.04e-03  1.04e+01    18s
  15  -4.71166356e+04  1.47540804e+06  3.09e-01 3.39e-03  4.49e+00    18s
  16  -2.27333853e+04  6.03660568e+05  1.35e-01 1.23e-03  1.85e+00    18s
  17  -1.95098990e+02  2.94888531e+05  7.09e-02 7.71e-04  8.70e-01    18s
  18   1.54163997e+04  2.15596394e+05  5.70e-02 1.76e-03  5.90e-01    18s
  19   2.79917136e+04  1.93367298e+05  4.56e-02 1.62e-03  4.87e-01    19s
  20   3.36925483e+04  1.73780357e+05  4.03e-02 1.27e-03  4.13e-01    19s
  21   3.88887090e+04  1.62858689e+05  3.57e-02 1.12e-03  3.65e-01    19s
  22   4.41592829e+04  1.50319852e+05  3.09e-02 9.55e-04  3.13e-01    19s
  23   5.16653663e+04  1.39012839e+05  2.41e-02 8.00e-04  2.57e-01    19s
  24   5.64488505e+04  1.25865319e+05  1.98e-02 6.05e-04  2.05e-01    20s
  25   6.17605323e+04  1.16869991e+05  1.51e-02 4.81e-04  1.62e-01    20s
  26   6.39081403e+04  1.12116363e+05  1.32e-02 4.01e-04  1.42e-01    20s
  27   6.63454628e+04  1.09069677e+05  1.12e-02 3.60e-04  1.26e-01    20s
  28   6.89717177e+04  1.04561736e+05  9.18e-03 3.00e-04  1.05e-01    20s
  29   7.03166679e+04  1.02729368e+05  8.16e-03 2.92e-04  9.55e-02    21s
  30   7.11862927e+04  9.79774485e+04  7.48e-03 3.12e-04  7.90e-02    21s
  31   7.25055972e+04  9.57067358e+04  6.45e-03 2.70e-04  6.84e-02    21s
  32   7.40183497e+04  9.42783746e+04  5.33e-03 2.41e-04  5.97e-02    21s
  33   7.47015904e+04  9.27158199e+04  4.84e-03 2.12e-04  5.31e-02    21s
  34   7.57996413e+04  9.08843841e+04  4.12e-03 1.73e-04  4.45e-02    22s
  35   7.67256716e+04  8.98168751e+04  3.53e-03 1.49e-04  3.86e-02    22s
  36   7.76656850e+04  8.81315349e+04  2.94e-03 1.15e-04  3.08e-02    22s
  37   7.80912426e+04  8.70857756e+04  2.69e-03 9.12e-05  2.65e-02    22s
  38   7.89465215e+04  8.59520399e+04  2.18e-03 6.96e-05  2.06e-02    22s
  39   7.91582861e+04  8.53697657e+04  2.05e-03 5.75e-05  1.83e-02    23s
  40   7.97622370e+04  8.48883916e+04  1.71e-03 4.60e-05  1.51e-02    23s
  41   8.04907075e+04  8.46233755e+04  1.31e-03 3.95e-05  1.22e-02    23s
  42   8.07736285e+04  8.44405678e+04  1.15e-03 3.52e-05  1.08e-02    23s
  43   8.13123468e+04  8.40396256e+04  8.44e-04 4.00e-05  8.04e-03    23s
  44   8.15884237e+04  8.37786441e+04  6.99e-04 3.01e-05  6.46e-03    24s
  45   8.18557604e+04  8.36391379e+04  5.53e-04 2.50e-05  5.26e-03    24s
  46   8.20993679e+04  8.34950159e+04  4.23e-04 1.96e-05  4.11e-03    24s
  47   8.23827214e+04  8.32576687e+04  2.74e-04 1.09e-05  2.58e-03    24s
  48   8.26771038e+04  8.30745893e+04  1.25e-04 5.83e-06  1.17e-03    25s
  49   8.27756346e+04  8.29981425e+04  7.68e-05 3.38e-06  6.56e-04    25s
  50   8.28042547e+04  8.29823486e+04  6.33e-05 2.64e-06  5.25e-04    25s
  51   8.28477788e+04  8.29746458e+04  4.36e-05 2.04e-06  3.74e-04    25s
  52   8.29078087e+04  8.29678716e+04  1.58e-05 1.57e-06  1.77e-04    25s
  53   8.29299092e+04  8.29552809e+04  5.69e-06 7.04e-07  7.48e-05    26s
  54   8.29435975e+04  8.29457178e+04  2.53e-07 2.65e-07  6.25e-06    26s
  55   8.29445079e+04  8.29445507e+04  1.32e-08 2.06e-09  1.26e-07    26s
  56   8.29445349e+04  8.29445357e+04  6.96e-10 8.68e-10  2.28e-09    26s

Barrier solved model in 56 iterations and 26.05 seconds (19.71 work units)
Optimal objective 8.29445349e+04


Root crossover log...

  164403 DPushes remaining with DInf 0.0000000e+00                26s
   40727 DPushes remaining with DInf 0.0000000e+00                30s
    5681 DPushes remaining with DInf 0.0000000e+00                35s
       0 DPushes remaining with DInf 0.0000000e+00                38s

    3372 PPushes remaining with PInf 1.6466073e-05                38s
       0 PPushes remaining with PInf 0.0000000e+00                39s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.0500799e-02     39s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   72030    8.2944535e+04   0.000000e+00   1.050080e-02     39s
   72031    8.2944535e+04   0.000000e+00   0.000000e+00     39s
   72031    8.2944535e+04   0.000000e+00   0.000000e+00     39s
Concurrent spin time: 4.84s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 8.294453e+04, 72031 iterations, 31.59 seconds (34.81 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 82944.5349    0  177 -183060.80 82944.5349   145%     -   45s
H    0     0                    -161690.3999 82944.5349   151%     -   46s
H    0     0                    -134997.8478 82944.5349   161%     -   47s
H    0     0                    -109020.1124 82944.5349   176%     -   47s
H    0     0                    -107532.1632 82944.5349   177%     -   47s
H    0     0                    -107475.5905 82944.5349   177%     -   48s
H    0     0                    -91789.18003 82944.5349   190%     -   48s
H    0     0                    -91171.30185 82944.5349   191%     -   49s
H    0     0                    -18571.07488 82944.5349   547%     -   49s
H    0     0                    -18166.91410 82944.5349   557%     -   49s
H    0     0                    3642.1585168 82944.5349  2177%     -   50s
H    0     0                    23200.539297 82944.5349   258%     -   51s
H    0     0                    23219.770102 82944.5349   257%     -   51s
H    0     0                    23281.333532 82944.5349   256%     -   51s
H    0     0                    23281.437133 82944.5349   256%     -   51s
H    0     0                    23362.548570 82944.5349   255%     -   52s
     0     0 75360.7152    0  217 23362.5486 75360.7152   223%     -  195s
H    0     0                    23537.931029 75360.6800   220%     -  197s
H    0     0                    24379.401685 75360.6800   209%     -  197s
H    0     0                    26086.847714 75360.6800   189%     -  198s
H    0     0                    26797.573677 75360.6800   181%     -  198s
H    0     0                    26799.161215 75360.6800   181%     -  198s
H    0     0                    26818.643655 75360.6800   181%     -  198s
     0     0 74597.4181    0  231 26818.6437 74597.4181   178%     -  265s
     0     0 74256.8852    0  224 26818.6437 74256.8852   177%     -  287s
     0     0 74201.9380    0  247 26818.6437 74201.9380   177%     -  311s
     0     0 74189.1810    0  244 26818.6437 74189.1810   177%     -  321s
     0     0 74187.9443    0  248 26818.6437 74187.9443   177%     -  327s
     0     0 74155.9542    0  247 26818.6437 74155.9542   177%     -  330s
     0     0 74069.6229    0  239 26818.6437 74069.6229   176%     -  340s
     0     0 74068.1072    0  233 26818.6437 74068.1072   176%     -  344s
     0     0 74033.3927    0  244 26818.6437 74033.3927   176%     -  350s
     0     0 73992.6237    0  242 26818.6437 73992.6237   176%     -  360s
     0     0 73985.8207    0  245 26818.6437 73985.8207   176%     -  365s
     0     0 73985.3133    0  243 26818.6437 73985.3133   176%     -  366s
     0     0 70278.6909    0  290 26818.6437 70278.6909   162%     -  478s
H    0     0                    28512.328947 70277.9346   146%     -  480s
H    0     0                    33387.332272 70277.9346   110%     -  480s
H    0     0                    33401.220837 70277.9346   110%     -  480s
H    0     0                    33556.775190 70277.9346   109%     -  480s
H    0     0                    33638.255872 70277.9346   109%     -  480s
H    0     0                    33653.579748 70277.9346   109%     -  480s
     0     0 69758.3729    0  297 33653.5797 69758.3729   107%     -  563s
     0     0 69638.0399    0  300 33653.5797 69638.0399   107%     -  597s
     0     0 69563.0466    0  288 33653.5797 69563.0466   107%     -  631s
     0     0 69436.6415    0  292 33653.5797 69436.6415   106%     -  662s
     0     0 69425.4023    0  292 33653.5797 69425.4023   106%     -  674s
     0     0 69399.7268    0  296 33653.5797 69399.7268   106%     -  685s
     0     0 69379.1231    0  293 33653.5797 69379.1231   106%     -  701s
     0     0 69234.6604    0  263 33653.5797 69234.6604   106%     -  744s
     0     0 69117.2702    0  312 33653.5797 69117.2702   105%     -  790s
     0     0 69079.8365    0  316 33653.5797 69079.8365   105%     -  817s
     0     0 69059.9889    0  262 33653.5797 69059.9889   105%     -  833s
     0     0 69041.7845    0  309 33653.5797 69041.7845   105%     -  858s
     0     0 68962.5248    0  294 33653.5797 68962.5248   105%     -  897s
     0     0 68954.0497    0  307 33653.5797 68954.0497   105%     -  904s
     0     0 68944.2110    0  300 33653.5797 68944.2110   105%     -  911s
     0     0 68923.1527    0  312 33653.5797 68923.1527   105%     -  924s
     0     0 68921.8993    0  311 33653.5797 68921.8993   105%     -  927s
     0     0 66355.2252    0  325 33653.5797 66355.2252  97.2%     - 1077s
H    0     0                    35578.396863 66355.1789  86.5%     - 1079s
     0     0 66095.6558    0  311 35578.3969 66095.6558  85.8%     - 1141s
     0     0 65985.8432    0  327 35578.3969 65985.8432  85.5%     - 1180s
     0     0 65906.6808    0  319 35578.3969 65906.6808  85.2%     - 1203s
     0     0 65854.7828    0  328 35578.3969 65854.7828  85.1%     - 1232s
     0     0 65820.4408    0  328 35578.3969 65820.4408  85.0%     - 1253s
     0     0 65797.2894    0  333 35578.3969 65797.2894  84.9%     - 1264s
     0     0 65794.0736    0  334 35578.3969 65794.0736  84.9%     - 1268s
     0     0 65789.1171    0  330 35578.3969 65789.1171  84.9%     - 1278s
     0     0 65764.9603    0  335 35578.3969 65764.9603  84.8%     - 1291s
     0     0 65717.9139    0  334 35578.3969 65717.9139  84.7%     - 1304s
     0     0 65707.6224    0  343 35578.3969 65707.6224  84.7%     - 1310s
     0     0 65701.6256    0  341 35578.3969 65701.6256  84.7%     - 1315s
     0     0 65696.1240    0  341 35578.3969 65696.1240  84.7%     - 1321s
     0     0 65692.2622    0  340 35578.3969 65692.2622  84.6%     - 1324s
     0     0 65688.4631    0  337 35578.3969 65688.4631  84.6%     - 1327s
     0     0 65687.0520    0  342 35578.3969 65687.0520  84.6%     - 1330s
     0     0 65098.1029    0  354 35578.3969 65098.1029  83.0%     - 1410s
H    0     0                    35607.712801 65097.6181  82.8%     - 1413s
H    0     0                    36025.753055 65097.6181  80.7%     - 1413s
     0     0 64890.0919    0  371 36025.7531 64890.0919  80.1%     - 1466s
     0     0 64868.5532    0  368 36025.7531 64868.5532  80.1%     - 1495s
     0     0 64854.0534    0  381 36025.7531 64854.0534  80.0%     - 1512s
     0     0 64809.0500    0  383 36025.7531 64809.0500  79.9%     - 1535s
     0     0 64802.6292    0  392 36025.7531 64802.6292  79.9%     - 1542s
     0     0 64801.4408    0  433 36025.7531 64801.4408  79.9%     - 1547s
     0     0 64712.0134    0  391 36025.7531 64712.0134  79.6%     - 1585s
H    0     0                    36041.445694 64710.1894  79.5%     - 1587s
     0     0 64673.5729    0  390 36041.4457 64673.5729  79.4%     - 1607s
     0     0 64663.8331    0  396 36041.4457 64663.8331  79.4%     - 1620s
     0     0 64662.1180    0  398 36041.4457 64662.1180  79.4%     - 1623s
     0     0 64612.6274    0  389 36041.4457 64612.6274  79.3%     - 1662s
     0     0 64602.7829    0  388 36041.4457 64602.7829  79.2%     - 1679s
     0     0 64601.0747    0  432 36041.4457 64601.0747  79.2%     - 1687s
     0     0 64580.0822    0  385 36041.4457 64580.0822  79.2%     - 1711s
     0     0 64574.6250    0  442 36041.4457 64574.6250  79.2%     - 1726s
     0     0 64569.1651    0  431 36041.4457 64569.1651  79.2%     - 1735s
     0     0 64562.3409    0  438 36041.4457 64562.3409  79.1%     - 1745s
     0     0 64559.8370    0  386 36041.4457 64559.8370  79.1%     - 1753s
     0     0 64495.3521    0  463 36041.4457 64495.3521  78.9%     - 1799s
     0     0 64477.8543    0  446 36041.4457 64477.8543  78.9%     - 1817s
     0     0 64469.9386    0  395 36041.4457 64469.9386  78.9%     - 1827s
     0     0 64461.6692    0  396 36041.4457 64461.6692  78.9%     - 1833s
     0     0 64459.6289    0  389 36041.4457 64459.6289  78.8%     - 1839s
     0     0 64427.8039    0  442 36041.4457 64427.8039  78.8%     - 1869s
     0     0 64417.0634    0  437 36041.4457 64417.0634  78.7%     - 1883s
     0     0 64411.5756    0  443 36041.4457 64411.5756  78.7%     - 1892s
     0     0 64408.9925    0  390 36041.4457 64408.9925  78.7%     - 1901s
     0     0 64406.3288    0  395 36041.4457 64406.3288  78.7%     - 1906s
     0     0 64405.8198    0  399 36041.4457 64405.8198  78.7%     - 1907s
     0     0 64386.3231    0  399 36041.4457 64386.3231  78.6%     - 1930s
     0     0 64384.4961    0  447 36041.4457 64384.4961  78.6%     - 1938s
     0     0 64370.3917    0  452 36041.4457 64370.3917  78.6%     - 1958s
     0     0 64369.3713    0  447 36041.4457 64369.3713  78.6%     - 1964s
     0     0 64365.0797    0  459 36041.4457 64365.0797  78.6%     - 1975s
     0     0 64363.7396    0  463 36041.4457 64363.7396  78.6%     - 1984s
     0     0 64358.8101    0  408 36041.4457 64358.8101  78.6%     - 1996s
     0     0 64358.3691    0  408 36041.4457 64358.3691  78.6%     - 2004s
H    0     0                    36078.831249 64358.3691  78.4%     - 2398s
H    0     0                    37266.105623 64358.3691  72.7%     - 2412s
H    0     2                    37410.184814 64358.3691  72.0%     - 2416s
     0     2 64358.3691    0  408 37410.1848 64358.3691  72.0%     - 2416s
     1     3 64214.5454    1  401 37410.1848 64358.3691  72.0% 15253 2458s
     2     4 64338.2614    1  404 37410.1848 64338.2614  72.0%  9448 2480s
     3     7 64066.4592    2  451 37410.1848 64338.1379  72.0%  9410 2520s
     6    11 64215.3693    3  363 37410.1848 64338.1295  72.0%  9757 2691s
    10    19 64034.1086    4  422 37410.1848 64298.3316  71.9% 17026 2766s
    18    27 61955.6604    4  337 37410.1848 64214.9390  71.7% 23080 3124s
H   26    43                    38520.228789 64068.0897  66.3% 21344 3600s

Cutting planes:
  Learned: 1
  Gomory: 11
  Implied bound: 253
  MIR: 3698
  Flow cover: 3143
  RLT: 53
  Relax-and-lift: 574

Explored 42 nodes (2226096 simplex iterations) in 3600.18 seconds (4017.45 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 38520.2 37410.2 37266.1 ... 33638.3

Time limit reached
Best objective 3.852022878852e+04, best bound 6.406808972174e+04, gap 66.3232%
  WARNING: Time limit reached. Using best solution found (gap: 66.32%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.24s
  Master Objective (UB) = 38520.23, θ = 228249.21
  Upper Bound (UB) = 38520.23

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 228249.21
  [DEBUG]   ✓ Scenario 0: θ = 228249.21 ≤ Q = 228249.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 228249.21 ≤ Q = 228249.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 228249.21 ≤ Q = 228249.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 228249.21 ≤ Q = 228249.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 228249.21 ≤ Q = 228249.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 228249.21 ≤ Q = 228249.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 228249.21 ≤ Q = 228249.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 228249.21 ≤ Q = 228249.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 228249.21 ≤ Q = 228249.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 228249.21 ≤ Q = 228249.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 228249.21 ≤ Q = 228249.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 228249.21 ≤ Q = 228249.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 228249.21 ≤ Q = 228249.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 228249.21 ≤ Q = 228249.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 228249.21 ≤ Q = 228249.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 228249.21 ≤ Q = 228249.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 228249.21 ≤ Q = 228249.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 228249.21 ≤ Q = 228249.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 228249.21 ≤ Q = 228249.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 228249.21 ≤ Q = 228249.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 20: θ = 228249.21 ≤ Q = 228249.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 21: θ = 228249.21 ≤ Q = 228249.21 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 22] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x4c2a2347
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x4c2a2347
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.419667e+13
Presolve removed 2585 rows and 1875 columns
Presolve time: 0.01s
Presolved: 508 rows, 514 columns, 1438 nonzeros
Found heuristic solution: objective 6870952.2326
Variable types: 350 continuous, 164 integer (164 binary)

Root relaxation: objective -1.738533e+05, 243 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -173853.30    0  123 6870952.23 -173853.30   103%     -    0s
H    0     0                    -140736.1332 -173853.30  23.5%     -    0s
H    0     0                    -141068.5644 -173853.30  23.2%     -    0s
     0     0 -150523.17    0  102 -141068.56 -150523.17  6.70%     -    0s
H    0     0                    -148647.1184 -150517.80  1.26%     -    0s
     0     0 -149307.20    0   78 -148647.12 -149307.20  0.44%     -    0s
     0     0 -149290.55    0   78 -148647.12 -149290.55  0.43%     -    0s
     0     0 -148979.44    0   20 -148647.12 -148979.44  0.22%     -    0s
     0     0 -148976.99    0   19 -148647.12 -148976.99  0.22%     -    0s
     0     0 -148909.69    0   29 -148647.12 -148909.69  0.18%     -    0s
H    0     0                    -148681.6364 -148810.89  0.09%     -    0s
     0     0 -148810.89    0    9 -148681.64 -148810.89  0.09%     -    0s
     0     0 -148775.29    0    9 -148681.64 -148775.29  0.06%     -    0s
     0     0 -148742.91    0    7 -148681.64 -148742.91  0.04%     -    0s
     0     0 -148742.91    0   23 -148681.64 -148742.91  0.04%     -    0s
     0     0 -148742.91    0   17 -148681.64 -148742.91  0.04%     -    0s
     0     0 -148742.91    0   14 -148681.64 -148742.91  0.04%     -    0s
H    0     0                    -148682.4565 -148742.91  0.04%     -    0s
     0     0 -148716.46    0    9 -148682.46 -148716.46  0.02%     -    0s
     0     0 -148713.17    0    8 -148682.46 -148713.17  0.02%     -    0s
H    0     0                    -148694.0161 -148707.08  0.01%     -    0s

Cutting planes:
  MIR: 6
  Flow cover: 9
  Relax-and-lift: 4

Explored 1 nodes (724 simplex iterations) in 0.13 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -148694 -148682 -148682 ... 1.41967e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.486940161178e+05, best bound -1.487070790332e+05, gap 0.0088%
  Subproblem solved in 0.16s
  Worst-case operational profit (Z_SP) = 222753.18
  Scenario: 33 demand increases, 27 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -148694.02
  [DEBUG]   S×d_nominal = 371447.20
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 371447.20 + -148694.02 = 222753.18
  [DEBUG]   Current θ from Master = 228249.21
  [DEBUG]   ⚠️  Z_SP ≤ θ by 5496.03 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 33024.20
  Lower Bound (LB) = 38407.27
  Gap (UB-LB) = 112.9587, Absolute Gap = 112.9587, Relative Gap = 0.002932
  *** CONVERGED (gap within tolerance) ***

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 22
Total Time: 68299.71s
Converged: True
Final Lower Bound: 38407.2701
Final Upper Bound: 38520.2288
Final Gap: 112.958721
Number of Critical Scenarios: 22
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [2] (1/3)
Product 1 Plants: [1, 2] (2/3)
Product 2 Plants: [1] (1/3)
Total Plant Openings: 4
DCs Opened: [0, 2, 5, 7, 9] (5/10)
Active Routes (Plant→DC): 15
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 0 customers  Mode 1: 0 customers  Mode 2: 50 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 22
Start Time: 2026-01-04 12:31:03
End Time: 2026-01-05 07:29:22
Total Time: 68299.71s
Optimal Value: 38407.27
Lower Bound: 38407.27
Upper Bound: 38520.23
Gap: 112.958721
Plants Opened: {0: [2], 1: [1, 2], 2: [1]} (4 plants)
DCs Opened: [0, 2, 5, 7, 9] (5 DCs)
================================================================================

Results saved to: result/DH_single_full_seed23_HD_gamma20_20260105_072923.csv

Total Execution Time: 68300.09 seconds
End Time: 2026-01-05 07:29:23

All tasks completed successfully!

