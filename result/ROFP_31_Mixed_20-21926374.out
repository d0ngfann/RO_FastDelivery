
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 31
DI Scenario: Mixed
Start Time: 2026-01-03 00:24:51
================================================================================
Loading data from data/DH_data_full_seed31.pkl...

Applying DI scenario: Mixed
DI values:
  Product 0: ['1.000', '1.311', '1.718'] (k=0.667)
  Product 1: ['1.000', '1.270', '1.614'] (k=0.590)
  Product 2: ['1.000', '1.119', '1.251'] (k=0.276)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=953, max=1707
  DC capacity (MC): min=537, max=893

Demand Structure (s_rk matrix):
  Total customer-product pairs: 83/150 (44.7% sparse)
  Average products per customer: 1.66

Demand (only non-zero entries):
  Nominal (μ): min=8.03, max=34.96, count=83
  Deviation (μ̂): min=4.06, max=9.95

Costs:
  Plant fixed cost: min=5416, max=9026
  DC fixed cost: min=3584, max=5357
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.311', '1.718'] (k=0.667)
    Product 1: ['1.000', '1.357', '1.840'] (k=0.752)
    Product 2: ['1.000', '1.369', '1.875'] (k=0.775)
  MD:
    Product 0: ['1.000', '1.211', '1.467'] (k=0.473)
    Product 1: ['1.000', '1.270', '1.614'] (k=0.590)
    Product 2: ['1.000', '1.303', '1.698'] (k=0.653)
  LD:
    Product 0: ['1.000', '1.027', '1.054'] (k=0.065)
    Product 1: ['1.000', '1.079', '1.163'] (k=0.187)
    Product 2: ['1.000', '1.119', '1.251'] (k=0.276)
  Mixed:
    Product 0: ['1.000', '1.311', '1.718'] (k=0.667)
    Product 1: ['1.000', '1.270', '1.614'] (k=0.590)
    Product 2: ['1.000', '1.119', '1.251'] (k=0.276)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48759 nonzeros
Model fingerprint: 0xfbcaef31
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11748 rows and 2748 columns
Presolve time: 0.21s
Presolved: 4925 rows, 5752 columns, 34182 nonzeros
Variable types: 3493 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -282651.0598
Found heuristic solution: objective -197738.4924

Root relaxation: objective 1.183377e+05, 4811 iterations, 0.20 seconds (0.33 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 118337.726    0  528 -197738.49 118337.726   160%     -    0s
H    0     0                    -177818.2915 118337.726   167%     -    0s
     0     0 110736.444    0  737 -177818.29 110736.444   162%     -    1s
     0     0 110647.503    0  746 -177818.29 110647.503   162%     -    1s
     0     0 110646.562    0  752 -177818.29 110646.562   162%     -    1s
     0     0 106363.372    0  989 -177818.29 106363.372   160%     -    2s
H    0     0                    -176680.1744 106361.098   160%     -    2s
     0     0 106074.242    0 1021 -176680.17 106074.242   160%     -    2s
     0     0 106035.666    0 1038 -176680.17 106035.666   160%     -    2s
     0     0 106030.746    0 1038 -176680.17 106030.746   160%     -    2s
     0     0 106030.578    0 1039 -176680.17 106030.578   160%     -    2s
H    0     0                    -174459.2293 103215.409   159%     -    3s
H    0     0                    -166085.8224 103215.409   162%     -    3s
H    0     0                    -164562.7366 103215.409   163%     -    3s
     0     0 103215.409    0 1104 -164562.74 103215.409   163%     -    3s
     0     0 102968.917    0 1101 -164562.74 102968.917   163%     -    4s
     0     0 102934.279    0 1102 -164562.74 102934.279   163%     -    4s
     0     0 102928.635    0 1107 -164562.74 102928.635   163%     -    4s
     0     0 102927.359    0 1110 -164562.74 102927.359   163%     -    4s
H    0     0                    -147314.9930 102927.359   170%     -    4s
H    0     0                    -141285.5635 102927.359   173%     -    4s
H    0     0                    -133302.4599 102927.359   177%     -    4s
H    0     0                    -128728.3354 102927.359   180%     -    4s
H    0     0                    -68671.63865 102927.359   250%     -    4s
H    0     0                    43101.119593 102927.359   139%     -    4s
     0     0 100473.073    0 1150 43101.1196 100473.073   133%     -    6s
     0     0 100169.153    0 1181 43101.1196 100169.153   132%     -    6s
     0     0 100126.123    0 1180 43101.1196 100126.123   132%     -    6s
     0     0 100116.261    0 1185 43101.1196 100116.261   132%     -    6s
     0     0 100115.556    0 1186 43101.1196 100115.556   132%     -    6s
H    0     0                    48640.986542 100115.556   106%     -    6s
     0     0 97102.4879    0 1134 48640.9865 97102.4879   100%     -    8s
     0     0 96781.5472    0 1145 48640.9865 96781.5472  99.0%     -    8s
     0     0 96715.7979    0 1151 48640.9865 96715.7979  98.8%     -    8s
     0     0 96700.7706    0 1157 48640.9865 96700.7706  98.8%     -    9s
     0     0 96698.9955    0 1169 48640.9865 96698.9955  98.8%     -    9s
H    0     0                    49098.776031 95305.0764  94.1%     -   10s
H    0     0                    50258.875644 95305.0764  89.6%     -   10s
H    0     0                    50443.324614 95305.0764  88.9%     -   10s
H    0     0                    50474.374572 95305.0764  88.8%     -   10s
     0     0 95305.0764    0 1139 50474.3746 95305.0764  88.8%     -   10s
     0     0 95053.8762    0 1184 50474.3746 95053.8762  88.3%     -   10s
     0     0 94983.2382    0 1209 50474.3746 94983.2382  88.2%     -   11s
     0     0 94964.0374    0 1205 50474.3746 94964.0374  88.1%     -   11s
     0     0 94962.1521    0 1219 50474.3746 94962.1521  88.1%     -   11s
H    0     0                    50640.943575 93825.7622  85.3%     -   12s
H    0     0                    50764.011399 93825.7622  84.8%     -   12s
     0     0 93825.7622    0 1127 50764.0114 93825.7622  84.8%     -   12s
H    0     0                    50871.822884 93562.0002  83.9%     -   13s
     0     0 93562.0002    0 1168 50871.8229 93562.0002  83.9%     -   13s
H    0     0                    52171.260507 93485.3605  79.2%     -   13s
H    0     0                    53465.457083 93485.3605  74.9%     -   13s
     0     0 93485.3605    0 1178 53465.4571 93485.3605  74.9%     -   13s
     0     0 93469.9927    0 1181 53465.4571 93469.9927  74.8%     -   13s
     0     0 92069.7979    0 1119 53465.4571 92069.7979  72.2%     -   15s
     0     0 91888.3439    0 1193 53465.4571 91888.3439  71.9%     -   15s
     0     0 91822.6338    0 1205 53465.4571 91822.6338  71.7%     -   16s
     0     0 91813.5740    0 1201 53465.4571 91813.5740  71.7%     -   16s
     0     0 91284.7528    0 1114 53465.4571 91284.7528  70.7%     -   17s
     0     0 91102.5075    0 1134 53465.4571 91102.5075  70.4%     -   18s
     0     0 91065.4260    0 1161 53465.4571 91065.4260  70.3%     -   18s
     0     0 91054.0907    0 1173 53465.4571 91054.0907  70.3%     -   18s
     0     0 90774.6449    0 1078 53465.4571 90774.6449  69.8%     -   19s
     0     0 90632.0228    0 1136 53465.4571 90632.0228  69.5%     -   20s
     0     0 90583.8425    0 1137 53465.4571 90583.8425  69.4%     -   20s
     0     0 90572.9801    0 1134 53465.4571 90572.9801  69.4%     -   20s
H    0     0                    53520.698253 89969.1410  68.1%     -   22s
     0     0 89969.1410    0 1075 53520.6983 89969.1410  68.1%     -   22s
     0     0 89881.4713    0 1127 53520.6983 89881.4713  67.9%     -   22s
     0     0 89857.9911    0 1150 53520.6983 89857.9911  67.9%     -   23s
     0     0 89652.3740    0 1087 53520.6983 89652.3740  67.5%     -   24s
     0     0 89599.4984    0 1096 53520.6983 89599.4984  67.4%     -   24s
H    0     0                    53824.842555 89583.0214  66.4%     -   24s
H    0     0                    54151.358330 89583.0214  65.4%     -   24s
H    0     0                    54186.125644 89583.0214  65.3%     -   24s
     0     0 89583.0214    0 1083 54186.1256 89583.0214  65.3%     -   24s
H    0     0                    54428.464432 88519.1022  62.6%     -   26s
     0     0 88519.1022    0 1024 54428.4644 88519.1022  62.6%     -   26s
     0     0 88247.9248    0 1064 54428.4644 88247.9248  62.1%     -   27s
     0     0 88168.1019    0 1067 54428.4644 88168.1019  62.0%     -   28s
     0     0 88146.2801    0 1053 54428.4644 88146.2801  61.9%     -   28s
     0     0 83833.2893    0 1007 54428.4644 83833.2893  54.0%     -   31s
     0     0 82970.7738    0 1069 54428.4644 82970.7738  52.4%     -   32s
     0     0 82792.8437    0 1076 54428.4644 82792.8437  52.1%     -   32s
     0     0 82742.1930    0 1122 54428.4644 82742.1930  52.0%     -   32s
     0     0 82723.3522    0 1083 54428.4644 82723.3522  52.0%     -   33s
     0     0 78124.2817    0  937 54428.4644 78124.2817  43.5%     -   35s
     0     0 77529.7550    0  997 54428.4644 77529.7550  42.4%     -   36s
     0     0 77407.1757    0 1011 54428.4644 77407.1757  42.2%     -   36s
     0     0 77344.3886    0 1023 54428.4644 77344.3886  42.1%     -   37s
     0     0 77332.7220    0 1037 54428.4644 77332.7220  42.1%     -   37s
     0     0 71848.8678    0  684 54428.4644 71848.8678  32.0%     -   39s
     0     0 71110.4976    0  686 54428.4644 71110.4976  30.6%     -   40s
     0     0 71017.2935    0  730 54428.4644 71017.2935  30.5%     -   40s
     0     0 70965.5394    0  694 54428.4644 70965.5394  30.4%     -   41s
     0     0 70941.8049    0  715 54428.4644 70941.8049  30.3%     -   41s
     0     0 70132.7971    0  755 54428.4644 70132.7971  28.9%     -   42s
     0     0 69788.4101    0  777 54428.4644 69788.4101  28.2%     -   43s
     0     0 69668.3025    0  818 54428.4644 69668.3025  28.0%     -   43s
     0     0 69629.5044    0  812 54428.4644 69629.5044  27.9%     -   44s
     0     0 69220.1722    0  820 54428.4644 69220.1722  27.2%     -   45s
     0     0 69029.2656    0  857 54428.4644 69029.2656  26.8%     -   45s
     0     0 68952.1941    0  814 54428.4644 68952.1941  26.7%     -   46s
     0     0 68930.5344    0  909 54428.4644 68930.5344  26.6%     -   46s
     0     0 68756.7142    0  804 54428.4644 68756.7142  26.3%     -   47s
     0     0 68756.6215    0  804 54428.4644 68756.6215  26.3%     -   47s
     0     2 68756.6053    0  804 54428.4644 68756.6053  26.3%     -   49s
     1     4 68418.1532    1  697 54428.4644 68756.6053  26.3%  2771   50s
    31    64 65543.1113    5  543 54428.4644 67718.1336  24.4%  2732   55s
   351   365 55581.6874   10  436 54428.4644 67398.5609  23.8%  1052   60s
   624   589 61364.8198   13  450 54428.4644 67367.5468  23.8%   970   65s
   993   864 57514.6082   17  534 54428.4644 67160.3139  23.4%   887   70s
  1464  1070 55810.6508   20  473 54428.4644 66355.5341  21.9%   778   75s
  1839  1249     cutoff   24      54428.4644 65540.2216  20.4%   776   80s
  2353  1610 54646.6266   19  497 54428.4644 65379.3465  20.1%   749   85s
  3014  1861 56810.8333   17  409 54428.4644 64997.9393  19.4%   722   90s
  3628  2079 infeasible   50      54428.4644 63944.7111  17.5%   727   96s
  4239  2227 56682.4741   20  428 54428.4644 63581.6252  16.8%   722  101s
  4897  2368 54859.9635   18  455 54428.4644 63164.6105  16.1%   719  106s
  5376  2425 59770.1765   14  485 54428.4644 63069.7087  15.9%   716  110s
  6201  2636 57733.9721   17  413 54428.4644 62586.3644  15.0%   713  116s
  6809  2786 57262.0437   20  391 54428.4644 62191.7490  14.3%   712  120s
  7606  2888 57907.9391   20  804 54428.4644 61894.4974  13.7%   700  135s
  7630  2904 61536.2171    9  404 54428.4644 61894.4974  13.7%   698  140s

Cutting planes:
  Gomory: 1
  Implied bound: 2
  Projected implied bound: 3
  MIR: 162
  Flow cover: 304
  RLT: 1
  Relax-and-lift: 34

Explored 8471 nodes (5686421 simplex iterations) in 144.18 seconds (330.43 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 54428.5 54186.1 54151.4 ... 50640.9

Optimal solution found (tolerance 1.00e-06)
Best objective 5.442846443221e+04, best bound 5.442846443221e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 144.19s
  Master Objective (UB) = 54428.46, θ = 202524.84
  Upper Bound (UB) = 54428.46

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 202524.84
  [DEBUG]   ✓ Scenario 0: θ = 202524.84 ≤ Q = 202524.84 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x125654ca
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xeda9ab36
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.359788e+13
Presolve removed 2580 rows and 1872 columns
Presolve time: 0.00s
Presolved: 513 rows, 517 columns, 1447 nonzeros
Found heuristic solution: objective 6929709.9026
Variable types: 351 continuous, 166 integer (166 binary)

Root relaxation: objective -1.439639e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -143963.89    0  123 6929709.90 -143963.89   102%     -    0s
H    0     0                    -108609.2682 -143963.89  32.6%     -    0s
H    0     0                    -109875.7590 -143963.89  31.0%     -    0s
*    0     0               0    -112053.1817 -112053.18  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 206

Explored 1 nodes (383 simplex iterations) in 0.01 seconds (0.01 work units)
Thread count was 32 (of 64 available processors)

Solution count 5: -112053 -109876 -108609 ... 1.35979e+13
No other solutions better than -112053

Optimal solution found (tolerance 1.00e-06)
Best objective -1.120531817393e+05, best bound -1.120531817393e+05, gap 0.0000%
  Subproblem solved in 0.03s
  Worst-case operational profit (Z_SP) = 168095.20
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -112053.18
  [DEBUG]   S×d_nominal = 280148.38
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 280148.38 + -112053.18 = 168095.20
  [DEBUG]   Current θ from Master = 202524.84
  [DEBUG]   ⚠️  Z_SP ≤ θ by 34429.64 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 19998.82
  Lower Bound (LB) = 19998.82
  Gap (UB-LB) = 34429.6442, Absolute Gap = 34429.6442, Relative Gap = 0.632567
  Not converged yet (gap = 34429.64 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 91999 nonzeros
Model fingerprint: 0xa624476d
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 19998.8 (0.01s)
MIP start from previous solve produced solution with objective 19998.8 (0.01s)
Loaded MIP start from previous solve with objective 19998.8

Presolve removed 13595 rows and 5514 columns
Presolve time: 0.31s
Presolved: 18368 rows, 9226 columns, 101748 nonzeros
Variable types: 6967 continuous, 2259 integer (2259 binary)

Root relaxation: objective 6.028185e+04, 10970 iterations, 1.72 seconds (3.51 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 60281.8460    0  355 19998.8202 60281.8460   201%     -    2s
H    0     0                    20384.684476 60281.8460   196%     -    2s
     0     0 52869.6250    0  579 20384.6845 52869.6250   159%     -    3s
H    0     0                    20414.347585 52860.2651   159%     -    3s
H    0     0                    20419.427710 52860.2651   159%     -    3s
     0     0 52636.4113    0  575 20419.4277 52636.4113   158%     -    3s
     0     0 52618.5211    0  576 20419.4277 52618.5211   158%     -    3s
     0     0 47476.0808    0  464 20419.4277 47476.0808   133%     -    5s
     0     0 46689.0153    0  509 20419.4277 46689.0153   129%     -    6s
     0     0 46644.6417    0  516 20419.4277 46644.6417   128%     -    6s
     0     0 46591.6557    0  522 20419.4277 46591.6557   128%     -    6s
     0     0 46589.6571    0  531 20419.4277 46589.6571   128%     -    6s
     0     0 42826.4786    0  564 20419.4277 42826.4786   110%     -    8s
H    0     0                    20512.403357 42826.0949   109%     -    8s
H    0     0                    20622.555423 42826.0949   108%     -    8s
     0     0 42107.8344    0  677 20622.5554 42107.8344   104%     -    9s
     0     0 41822.4392    0  703 20622.5554 41822.4392   103%     -    9s
     0     0 41755.1029    0  711 20622.5554 41755.1029   102%     -   10s
     0     0 41742.2908    0  727 20622.5554 41742.2908   102%     -   10s
     0     0 41737.1761    0  708 20622.5554 41737.1761   102%     -   10s
     0     0 41735.5891    0  713 20622.5554 41735.5891   102%     -   10s
     0     0 39754.0497    0  450 20622.5554 39754.0497  92.8%     -   12s
     0     0 39285.6044    0  473 20622.5554 39285.6044  90.5%     -   13s
     0     0 39091.8401    0  561 20622.5554 39091.8401  89.6%     -   14s
     0     0 39028.9609    0  487 20622.5554 39028.9609  89.3%     -   14s
     0     0 39014.7325    0  545 20622.5554 39014.7325  89.2%     -   14s
     0     0 39011.8516    0  497 20622.5554 39011.8516  89.2%     -   14s
     0     0 38544.1761    0  529 20622.5554 38544.1761  86.9%     -   15s
     0     0 38362.3119    0  517 20622.5554 38362.3119  86.0%     -   16s
     0     0 38252.0587    0  460 20622.5554 38252.0587  85.5%     -   16s
     0     0 38242.6873    0  454 20622.5554 38242.6873  85.4%     -   16s
     0     0 38237.2007    0  457 20622.5554 38237.2007  85.4%     -   16s
     0     0 38084.6093    0  725 20622.5554 38084.6093  84.7%     -   17s
H    0     0                    20837.930163 38082.6267  82.8%     -   17s
     0     0 38037.3011    0  674 20837.9302 38037.3011  82.5%     -   18s
     0     0 38029.1032    0  677 20837.9302 38029.1032  82.5%     -   18s
     0     0 38021.0500    0  668 20837.9302 38021.0500  82.5%     -   18s
     0     0 38020.2232    0  675 20837.9302 38020.2232  82.5%     -   18s
     0     0 37912.6751    0  442 20837.9302 37912.6751  81.9%     -   19s
     0     0 37854.1867    0  450 20837.9302 37854.1867  81.7%     -   19s
     0     0 37835.6324    0  464 20837.9302 37835.6324  81.6%     -   20s
     0     0 37829.3052    0  485 20837.9302 37829.3052  81.5%     -   20s
     0     0 37787.6679    0  560 20837.9302 37787.6679  81.3%     -   20s
     0     0 37774.4794    0  433 20837.9302 37774.4794  81.3%     -   21s
     0     0 37769.7492    0  563 20837.9302 37769.7492  81.3%     -   21s
     0     0 37754.8652    0  438 20837.9302 37754.8652  81.2%     -   21s
     0     0 37748.1548    0  433 20837.9302 37748.1548  81.2%     -   22s
     0     0 37740.1106    0  417 20837.9302 37740.1106  81.1%     -   22s
     0     0 37727.9686    0  436 20837.9302 37727.9686  81.1%     -   22s
     0     0 37725.3947    0  435 20837.9302 37725.3947  81.0%     -   22s
     0     0 37701.8709    0  439 20837.9302 37701.8709  80.9%     -   23s
     0     0 37701.8451    0  439 20837.9302 37701.8451  80.9%     -   23s
     0     2 37701.5663    0  439 20837.9302 37701.5663  80.9%     -   26s
    15    32 36090.2731    4  571 20837.9302 37266.2519  78.8%  1206   30s
H  107   146                    20957.780438 36999.4123  76.5%  1004   34s
H  127   146                    21145.623100 36999.4123  75.0%   902   34s
   145   264 35433.5632    8  453 21145.6231 36999.4123  75.0%   836   35s
H  299   324                    21367.884728 36999.4123  73.2%   654   36s
   477   468 32638.7832   16  327 21367.8847 36429.9867  70.5%   677   40s
   923   887 27512.4280   24  300 21367.8847 36086.0254  68.9%   525   45s
  1667  1508 30811.8000   15  291 21367.8847 35927.8202  68.1%   408   50s
  2628  2123 25918.9522   19  258 21367.8847 35224.1156  64.8%   339   55s
  3420  2683 29354.1748   16  267 21367.8847 35096.4889  64.2%   317   60s
  3524  2684 24456.6960   73  439 21367.8847 34875.7546  63.2%   316   74s
  3526  2685 25686.3361   58   93 21367.8847 34875.7546  63.2%   316   75s
  3534  2691 28471.4918   30  414 21367.8847 34875.7546  63.2%   315   80s
  3547  2699 30413.9331   14  429 21367.8847 34875.7546  63.2%   314   85s
  3553  2703 25132.6879   28  427 21367.8847 34875.7546  63.2%   314   90s
  3584  2757 34078.9920   20  273 21367.8847 34875.7546  63.2%   327   95s
  3772  2857 28474.8590   25  235 21367.8847 34522.9852  61.6%   353  100s
H 3821  2705                    21976.479904 34522.9852  57.1%   354  100s
  4280  2734 25772.4146   25  121 21976.4799 33961.8186  54.5%   364  105s
H 4825  2498                    21979.561490 33391.7988  51.9%   365  110s
H 4829  2375                    22015.307073 33391.7988  51.7%   365  110s
H 4842  2254                    22054.021860 33391.7988  51.4%   366  110s
* 5243  2128              36    23837.277168 30754.4434  29.0%   369  114s
  5355  2046 25367.6329   28  221 23837.2772 30754.4434  29.0%   366  115s
  6110  1577 24084.4751   24  219 23837.2772 27957.6607  17.3%   368  120s

Cutting planes:
  Learned: 2
  MIR: 199
  Mixing: 1
  Flow cover: 562
  RLT: 11
  Relax-and-lift: 48

Explored 6769 nodes (2419573 simplex iterations) in 122.53 seconds (301.25 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 23837.3 22054 22015.3 ... 20622.6

Optimal solution found (tolerance 1.00e-06)
Best objective 2.383727716838e+04, best bound 2.383727716838e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 122.54s
  Master Objective (UB) = 23837.28, θ = 164305.31
  Upper Bound (UB) = 23837.28

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 164305.31
  [DEBUG]   ✓ Scenario 0: θ = 164305.31 ≤ Q = 164305.31 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 164305.31 ≤ Q = 164305.31 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x48c94680
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xb736b980
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.527885e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 7995057.7056
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.522214e+05, 264 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -152221.42    0  133 7995057.71 -152221.42   102%     -    0s
H    0     0                    -112379.8816 -152221.42  35.5%     -    0s
H    0     0                    -113582.8462 -152221.42  34.0%     -    0s
H    0     0                    -133857.7028 -152221.42  13.7%     -    0s
H    0     0                    -139511.1582 -140678.65  0.84%     -    0s
     0     0 -140678.65    0   75 -139511.16 -140678.65  0.84%     -    0s
H    0     0                    -139769.8653 -140049.06  0.20%     -    0s
     0     0 -140032.19    0   68 -139769.87 -140032.19  0.19%     -    0s
     0     0 -139975.57    0   31 -139769.87 -139975.57  0.15%     -    0s
     0     0 -139972.86    0   19 -139769.87 -139972.86  0.15%     -    0s
     0     0 -139970.38    0   19 -139769.87 -139970.38  0.14%     -    0s
     0     0 -139829.06    0    7 -139769.87 -139829.06  0.04%     -    0s
     0     0 -139829.06    0   10 -139769.87 -139829.06  0.04%     -    0s
H    0     0                    -139809.2607 -139829.06  0.01%     -    0s
     0     0 -139811.22    0    2 -139809.26 -139811.22  0.00%     -    0s
*    0     0               0    -139810.0509 -139810.05  0.00%     -    0s

Cutting planes:
  Gomory: 5
  Implied bound: 3
  MIR: 2
  Flow cover: 6
  Relax-and-lift: 2

Explored 1 nodes (688 simplex iterations) in 0.03 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -139810 -139810 -139809 ... 1.52788e+13
No other solutions better than -139810

Optimal solution found (tolerance 1.00e-06)
Best objective -1.398100509154e+05, best bound -1.398100509154e+05, gap 0.0000%
  Subproblem solved in 0.05s
  Worst-case operational profit (Z_SP) = 140338.33
  Scenario: 37 demand increases, 23 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -139810.05
  [DEBUG]   S×d_nominal = 280148.38
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 280148.38 + -139810.05 = 140338.33
  [DEBUG]   Current θ from Master = 164305.31
  [DEBUG]   ⚠️  Z_SP ≤ θ by 23966.98 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -129.70
  Lower Bound (LB) = 19998.82
  Gap (UB-LB) = 3838.4569, Absolute Gap = 3838.4569, Relative Gap = 0.161027
  Not converged yet (gap = 3838.46 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 37 increases, 23 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135239 nonzeros
Model fingerprint: 0xe67f1d17
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -129.702 (0.02s)
Loaded MIP start from previous solve with objective -129.702

Presolve removed 20361 rows and 8271 columns
Presolve time: 0.41s
Presolved: 26892 rows, 12709 columns, 165584 nonzeros
Variable types: 10450 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...

Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 4.949931e+04, 17687 iterations, 4.18 seconds (8.05 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 49499.3109    0   95 -129.70238 49499.3109      -     -    4s
H    0     0                     633.5887251 49499.3109  7713%     -    4s
H    0     0                    5657.9620248 49499.3109   775%     -    4s
H    0     0                    8072.8761899 49499.3109   513%     -    4s
H    0     0                    8559.0430451 49499.3109   478%     -    4s
H    0     0                    10602.529000 49499.3109   367%     -    4s
H    0     0                    11723.554433 49499.3109   322%     -    5s
H    0     0                    15189.466731 49499.3109   226%     -    5s
H    0     0                    15468.368906 49499.3109   220%     -    5s
H    0     0                    15494.186310 49499.3109   219%     -    5s
     0     0 44959.6111    0  301 15494.1863 44959.6111   190%     -    7s
H    0     0                    15513.913072 44959.6111   190%     -    7s
H    0     0                    15996.944876 44959.6111   181%     -    7s
     0     0 44944.9796    0  282 15996.9449 44944.9796   181%     -    7s
     0     0 44944.9796    0  276 15996.9449 44944.9796   181%     -    7s
     0     0 44944.9796    0  286 15996.9449 44944.9796   181%     -    8s
     0     0 44944.9714    0  288 15996.9449 44944.9714   181%     -    8s
     0     0 41400.5406    0  355 15996.9449 41400.5406   159%     -   10s
     0     0 40664.3325    0  361 15996.9449 40664.3325   154%     -   11s
     0     0 40581.9196    0  369 15996.9449 40581.9196   154%     -   11s
     0     0 40555.5410    0  373 15996.9449 40555.5410   154%     -   12s
     0     0 40529.9384    0  364 15996.9449 40529.9384   153%     -   12s
     0     0 40514.9026    0  378 15996.9449 40514.9026   153%     -   12s
     0     0 40507.7184    0  366 15996.9449 40507.7184   153%     -   12s
     0     0 40501.8048    0  373 15996.9449 40501.8048   153%     -   12s
     0     0 40501.3873    0  379 15996.9449 40501.3873   153%     -   12s
H    0     0                    17786.898030 39078.7986   120%     -   14s
H    0     0                    17790.787204 39078.7986   120%     -   14s
     0     0 39078.7986    0  353 17790.7872 39078.7986   120%     -   14s
H    0     0                    17895.701905 39078.4980   118%     -   15s
H    0     0                    17920.281530 39078.4980   118%     -   15s
     0     0 38722.2618    0  405 17920.2815 38722.2618   116%     -   15s
     0     0 38466.9228    0  405 17920.2815 38466.9228   115%     -   16s
     0     0 38382.9747    0  415 17920.2815 38382.9747   114%     -   16s
     0     0 38356.3713    0  419 17920.2815 38356.3713   114%     -   16s
     0     0 38319.1507    0  423 17920.2815 38319.1507   114%     -   17s
     0     0 38310.5310    0  422 17920.2815 38310.5310   114%     -   17s
     0     0 38308.1107    0  424 17920.2815 38308.1107   114%     -   17s
     0     0 38306.5674    0  422 17920.2815 38306.5674   114%     -   17s
     0     0 38306.4358    0  422 17920.2815 38306.4358   114%     -   17s
     0     0 37618.4371    0  397 17920.2815 37618.4371   110%     -   19s
     0     0 37428.3983    0  442 17920.2815 37428.3983   109%     -   20s
     0     0 37366.4125    0  454 17920.2815 37366.4125   109%     -   21s
     0     0 37348.1066    0  455 17920.2815 37348.1066   108%     -   21s
     0     0 37331.7946    0  461 17920.2815 37331.7946   108%     -   21s
     0     0 37326.3468    0  456 17920.2815 37326.3468   108%     -   21s
     0     0 37325.3558    0  450 17920.2815 37325.3558   108%     -   21s
     0     0 37153.5396    0  341 17920.2815 37153.5396   107%     -   23s
H    0     0                    18236.153597 37153.1644   104%     -   23s
H    0     0                    18240.042770 37153.1644   104%     -   23s
H    0     0                    18245.254642 37153.1644   104%     -   23s
H    0     0                    18264.622395 37153.1644   103%     -   23s
     0     0 37093.1793    0  411 18264.6224 37093.1793   103%     -   23s
     0     0 37048.9957    0  411 18264.6224 37048.9957   103%     -   24s
     0     0 37039.4133    0  412 18264.6224 37039.4133   103%     -   24s
     0     0 37032.0983    0  420 18264.6224 37032.0983   103%     -   24s
     0     0 37028.9633    0  424 18264.6224 37028.9633   103%     -   24s
     0     0 37027.4599    0  424 18264.6224 37027.4599   103%     -   24s
     0     0 36996.4993    0  436 18264.6224 36996.4993   103%     -   25s
H    0     0                    18295.283940 36996.2880   102%     -   26s
H    0     0                    18659.964297 36996.2880  98.3%     -   26s
     0     0 36988.8567    0  431 18659.9643 36988.8567  98.2%     -   26s
     0     0 36987.5220    0  435 18659.9643 36987.5220  98.2%     -   26s
     0     0 36978.5295    0  433 18659.9643 36978.5295  98.2%     -   27s
H    0     0                    18938.621943 36975.0234  95.2%     -   27s
     0     0 36974.0163    0  435 18938.6219 36974.0163  95.2%     -   27s
     0     0 36972.6365    0  431 18938.6219 36972.6365  95.2%     -   27s
     0     0 36961.5546    0  475 18938.6219 36961.5546  95.2%     -   28s
H    0     0                    19660.060075 36961.5154  88.0%     -   28s
H    0     0                    19766.847125 36961.5154  87.0%     -   28s
H    0     0                    20155.778909 36961.5154  83.4%     -   28s
H    0     0                    20358.329898 36961.5154  81.6%     -   28s
H    0     0                    20494.286909 36961.5154  80.4%     -   28s
     0     0 36957.9137    0  475 20494.2869 36957.9137  80.3%     -   29s
     0     0 36956.8803    0  478 20494.2869 36956.8803  80.3%     -   29s
     0     0 36947.5253    0  433 20494.2869 36947.5253  80.3%     -   29s
H    0     0                    20634.802450 36946.9562  79.1%     -   29s
     0     0 36944.7390    0  484 20634.8024 36944.7390  79.0%     -   30s
     0     0 36944.4656    0  490 20634.8024 36944.4656  79.0%     -   30s
     0     0 36939.3069    0  435 20634.8024 36939.3069  79.0%     -   30s
     0     0 36938.9227    0  488 20634.8024 36938.9227  79.0%     -   30s
     0     0 36937.1626    0  498 20634.8024 36937.1626  79.0%     -   31s
     0     0 36936.9458    0  498 20634.8024 36936.9458  79.0%     -   31s
H    0     0                    20727.778097 36936.6421  78.2%     -   34s
H    0     0                    20765.677611 36936.6421  77.9%     -   35s
H    0     0                    20815.071807 36936.6421  77.5%     -   35s
H    0     0                    20820.151932 36936.6421  77.4%     -   35s
     0     2 36936.6421    0  498 20820.1519 36936.6421  77.4%     -   35s
    15    32 36030.3205    4  485 20820.1519 36128.9589  73.5%  2687   41s
    63    96 35460.5544    6  410 20820.1519 35711.2790  71.5%  2975   45s
H  135   155                    20900.116984 35711.2790  70.9%  2247   48s
   154   202 35209.4367    8  464 20900.1170 35711.2790  70.9%  2143   50s
   272   344 34787.5701    9  448 20900.1170 35711.2790  70.9%  1745   56s
   432   470 34666.1770   10  456 20900.1170 35552.4062  70.1%  1537   61s
   660   636 33258.3172   13  484 20900.1170 35450.4631  69.6%  1370   66s
   788   732 31700.0167   15  366 20900.1170 35311.7090  69.0%  1353   71s
   908   871 31198.1674   18  390 20900.1170 35311.7090  69.0%  1304   75s
  1148  1081 29158.6018   23  328 20900.1170 35311.7090  69.0%  1208   80s
  1385  1309 28266.1032   27  315 20900.1170 35171.9265  68.3%  1154   86s
  1619  1570     cutoff   29      20900.1170 35171.9265  68.3%  1097   90s
  2173  2089 23121.8247   40  128 20900.1170 35171.9265  68.3%   960   96s
  2656  2374     cutoff   49      20900.1170 35039.2512  67.7%   863  101s
  3081  2522 31871.8028   14  266 20900.1170 34938.6538  67.2%   813  106s
  3166  2594 30658.7249   16  179 20900.1170 34938.6538  67.2%   822  110s
  3371  2777 29382.6104   19  185 20900.1170 34938.6538  67.2%   815  117s
  3623  2964 28854.0689   21  126 20900.1170 34811.2314  66.6%   803  122s
  3810  2965 27735.6046   26  498 20900.1170 34811.2314  66.6%   793  131s
  3812  2966 24774.5161   43   95 20900.1170 34811.2314  66.6%   792  135s
  3814  2968 32472.0039   13  440 20900.1170 34811.2314  66.6%   792  141s
  3818  2970 21534.5495   52  421 20900.1170 34811.2314  66.6%   791  145s
  3825  2975 24836.6893   32  486 20900.1170 34811.2314  66.6%   790  150s
  3832  2980 32688.1747   12  430 20900.1170 34811.2314  66.6%   788  155s
  3841  2986 32558.7921    7  531 20900.1170 34811.2314  66.6%   786  161s
  3842  2986 33468.6990    7  531 20900.1170 34811.2314  66.6%   786  176s
  3843  2987 22395.5005   61  531 20900.1170 34811.2314  66.6%   786  182s
  3844  2991 34811.2314   14  434 20900.1170 34811.2314  66.6%   803  186s
  3850  3001 34811.2314   16  433 20900.1170 34811.2314  66.6%   808  192s
  3858  3014 34576.4553   17  494 20900.1170 34811.2314  66.6%   815  197s
  3874  3029 33424.8506   18  452 20900.1170 34574.4712  65.4%   828  204s
  3894  3054 30491.9989   19  465 20900.1170 34574.4712  65.4%   866  208s
  3926  3090 30287.3094   20  453 20900.1170 34574.4712  65.4%   885  212s
  3978  3131 30197.9351   21  456 20900.1170 34574.4712  65.4%   900  217s
  4062  3150 28894.3754   22  429 20900.1170 33688.3133  61.2%   907  220s
  4298  3190 28036.8503   23  465 20900.1170 33687.3163  61.2%   924  227s
  4371  3208 28364.9482   23  486 20900.1170 33370.2133  59.7%   930  230s
  4520  3236 27302.7334   24  361 20900.1170 32947.8019  57.6%   937  236s
  4674  3234 25326.1683   26  211 20900.1170 32256.8779  54.3%   942  242s
  4720  3246 23624.1714   26  198 20900.1170 32256.8779  54.3%   947  246s
  4815  3266 24649.3106   27  280 20900.1170 32256.8779  54.3%   953  250s
  4917  3270     cutoff   27      20900.1170 31456.4701  50.5%   962  255s
H 4954  3108                    21068.888194 31456.4701  49.3%   964  256s
  5085  3127 23258.8784   28  203 21068.8882 31234.0120  48.2%   967  262s
  5175  3140 infeasible   29      21068.8882 30766.6312  46.0%   972  265s
  5396  3181 23866.4646   26  261 21068.8882 30726.7601  45.8%   981  272s
  5511  3190 21407.2469   29  224 21068.8882 30471.5138  44.6%   983  276s
  5777  3165 26803.4902   24  254 21068.8882 30306.7423  43.8%   981  282s
  5919  3139 24147.8190   27  155 21068.8882 30298.7525  43.8%   984  286s
H 6058  2962                    21121.055438 30185.3862  42.9%   988  289s
  6154  2970 21818.3757   33  141 21121.0554 30086.9874  42.5%   990  292s
  6301  2955 25145.0803   26  227 21121.0554 29926.3054  41.7%   989  296s
  6469  2941     cutoff   28      21121.0554 29926.3054  41.7%   986  301s
  6622  2963 22252.0561   31   78 21121.0554 29757.6066  40.9%   992  305s
  6966  2922 23660.7437   29  198 21121.0554 29650.2973  40.4%   997  311s
  7022  2907 23389.7782   30   94 21121.0554 29650.2973  40.4%   998  315s
  7180  2922 25936.9794   24  369 21121.0554 29448.8139  39.4%  1003  323s
  7299  2930 27052.1976   24  355 21121.0554 29426.8839  39.3%  1004  327s
  7497  2947 27374.2516   24  261 21121.0554 29386.0962  39.1%  1007  331s
  7740  2903 23561.9499   25  348 21121.0554 29386.0962  39.1%  1009  337s
  8026  2870 24621.6571   27  298 21121.0554 28839.3963  36.5%  1011  342s
  8292  2814     cutoff   29      21121.0554 28839.3963  36.5%  1009  346s
  8561  2775 infeasible   32      21121.0554 28706.9706  35.9%  1013  351s
  8899  2732 22178.9494   34   67 21121.0554 28304.6847  34.0%  1011  356s
  9258  2665 23953.1606   25  251 21121.0554 27752.5877  31.4%  1010  361s
  9631  2593 25651.2428   26  246 21121.0554 27720.5891  31.2%  1006  367s
 10004  2558 25519.4670   25  208 21121.0554 27554.9499  30.5%  1006  373s
H10416  2277                    21226.595115 27303.0346  28.6%  1001  373s
 10438  2309 23959.7976   30  212 21226.5951 27303.0346  28.6%  1000  380s
H10473  2123                    21503.190648 27303.0346  27.0%  1000  380s
 10727  2077 24684.9807   24  212 21503.1906 27159.5871  26.3%   999  385s
*11066  1932              55    21565.432893 26985.4073  25.1%   999  385s
 11136  1921     cutoff   41      21565.4329 26855.2210  24.5%   998  392s
 11574  1862     cutoff   29      21565.4329 26700.7634  23.8%   997  398s
 12057  1875     cutoff   21      21565.4329 26356.1062  22.2%   995  404s
 12616  1850 23231.6783   27  369 21565.4329 26330.7918  22.1%   987  411s
H12977  1675                    22307.546483 26330.7918  18.0%   984  411s
 13127  1471 22642.1382   28  275 22307.5465 25937.7313  16.3%   979  418s
 13776  1186     cutoff   30      22307.5465 25496.5254  14.3%   970  425s
H13880  1186                    22408.218395 25393.1676  13.3%   966  425s
H13884  1186                    22414.654270 25371.5703  13.2%   966  425s
 14346   395 22840.5146   29  178 22414.6543 25088.4858  11.9%   959  431s
*15428   395              63    22423.819300 24745.6143  10.4%   919  431s

Cutting planes:
  Learned: 1
  MIR: 451
  Flow cover: 976
  RLT: 15
  Relax-and-lift: 72

Explored 15925 nodes (14366412 simplex iterations) in 434.94 seconds (1320.81 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 22423.8 22414.7 22408.2 ... 20900.1

Optimal solution found (tolerance 1.00e-06)
Best objective 2.242381930049e+04, best bound 2.242381930049e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 434.95s
  Master Objective (UB) = 22423.82, θ = 162394.31
  Upper Bound (UB) = 22423.82

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 162394.31
  [DEBUG]   ✓ Scenario 0: θ = 162394.31 ≤ Q = 162394.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 162394.31 ≤ Q = 162394.31 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 162394.31 ≤ Q = 162394.31 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x75ca2128
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x75ca2128
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.532552e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 8025118.6789
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.501971e+05, 272 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -150197.08    0  136 8025118.68 -150197.08   102%     -    0s
H    0     0                    -108937.5796 -150197.08  37.9%     -    0s
H    0     0                    -110004.0583 -150197.08  36.5%     -    0s
H    0     0                    -129595.2745 -150197.08  15.9%     -    0s
H    0     0                    -129617.4809 -150197.08  15.9%     -    0s
H    0     0                    -138259.2451 -150197.08  8.63%     -    0s
     0     0 -140890.45    0   75 -138259.25 -140890.45  1.90%     -    0s
H    0     0                    -139462.8429 -140870.75  1.01%     -    0s
     0     0 -140409.52    0   75 -139462.84 -140409.52  0.68%     -    0s
     0     0 -139850.45    0   57 -139462.84 -139850.45  0.28%     -    0s
     0     0 -139815.05    0   50 -139462.84 -139815.05  0.25%     -    0s
     0     0 -139806.75    0   46 -139462.84 -139806.75  0.25%     -    0s
     0     0 -139799.00    0   44 -139462.84 -139799.00  0.24%     -    0s
     0     0 -139798.37    0   43 -139462.84 -139798.37  0.24%     -    0s
     0     0 -139734.41    0   46 -139462.84 -139734.41  0.19%     -    0s
     0     0 -139732.55    0   43 -139462.84 -139732.55  0.19%     -    0s
     0     0 -139651.45    0   43 -139462.84 -139651.45  0.14%     -    0s
     0     0 -139649.56    0   43 -139462.84 -139649.56  0.13%     -    0s
     0     0 -139583.60    0   14 -139462.84 -139583.60  0.09%     -    0s
     0     0 -139583.60    0   13 -139462.84 -139583.60  0.09%     -    0s
H    0     0                    -139477.2025 -139583.60  0.08%     -    0s
     0     0 -139521.89    0    4 -139477.20 -139521.89  0.03%     -    0s
H    0     0                    -139506.4371 -139513.80  0.01%     -    0s
     0     0 -139511.50    0    2 -139506.44 -139511.50  0.00%     -    0s
     0     0     cutoff    0      -139506.44 -139506.44  0.00%     -    0s

Cutting planes:
  Gomory: 6
  MIR: 3
  Flow cover: 5
  Relax-and-lift: 3

Explored 1 nodes (864 simplex iterations) in 0.06 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -139506 -139477 -139463 ... -108938
No other solutions better than -139506

Optimal solution found (tolerance 1.00e-06)
Best objective -1.395064370865e+05, best bound -1.395064370865e+05, gap 0.0000%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 138583.77
  Scenario: 39 demand increases, 21 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -139506.44
  [DEBUG]   S×d_nominal = 278090.20
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 278090.20 + -139506.44 = 138583.77
  [DEBUG]   Current θ from Master = 162394.31
  [DEBUG]   ⚠️  Z_SP ≤ θ by 23810.54 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -1386.72
  Lower Bound (LB) = 19998.82
  Gap (UB-LB) = 2424.9991, Absolute Gap = 2424.9991, Relative Gap = 0.108144
  Not converged yet (gap = 2425.00 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 39 increases, 21 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178479 nonzeros
Model fingerprint: 0x14ee86ff
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -1386.72 (0.04s)
Loaded MIP start from previous solve with objective -1386.72

Presolve removed 27128 rows and 11018 columns
Presolve time: 0.54s
Presolved: 35415 rows, 16202 columns, 218999 nonzeros
Variable types: 13943 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 35415 rows, 16202 columns, 218999 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   45427    4.1293004e+04   0.000000e+00   1.496416e+10      5s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 4.909925e+04, 24288 iterations, 8.84 seconds (16.83 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 49099.2486    0   90 -1386.7222 49099.2486  3641%     -    9s
H    0     0                    2314.6369591 49099.2486  2021%     -    9s
H    0     0                    13590.284790 49099.2486   261%     -    9s
H    0     0                    13640.248476 49099.2486   260%     -    9s
H    0     0                    14510.101076 49099.2486   238%     -   10s
H    0     0                    14519.501209 49099.2486   238%     -   10s
H    0     0                    15363.274827 49099.2486   220%     -   10s
H    0     0                    15418.405219 49099.2486   218%     -   10s
     0     0 45690.3044    0  240 15418.4052 45690.3044   196%     -   13s
H    0     0                    15681.220225 45687.8212   191%     -   13s
H    0     0                    15844.222919 45687.8212   188%     -   13s
H    0     0                    15921.163785 45687.8212   187%     -   13s
     0     0 45260.9172    0  303 15921.1638 45260.9172   184%     -   14s
     0     0 45260.9172    0  295 15921.1638 45260.9172   184%     -   14s
     0     0 45260.9172    0  248 15921.1638 45260.9172   184%     -   14s
     0     0 41383.2819    0  280 15921.1638 41383.2819   160%     -   18s
H    0     0                    15996.944876 41382.9707   159%     -   18s
     0     0 40733.7798    0  297 15996.9449 40733.7798   155%     -   20s
     0     0 40562.9922    0  362 15996.9449 40562.9922   154%     -   21s
     0     0 40473.4722    0  361 15996.9449 40473.4722   153%     -   22s
     0     0 40450.0519    0  365 15996.9449 40450.0519   153%     -   22s
     0     0 40448.8936    0  362 15996.9449 40448.8936   153%     -   23s
     0     0 40448.1243    0  362 15996.9449 40448.1243   153%     -   23s
H    0     0                    19360.791092 40448.1243   109%     -   25s
H    0     0                    19454.898020 40448.1243   108%     -   25s
H    0     0                    19541.002120 40448.1243   107%     -   25s
H    0     0                    19578.491561 40448.1243   107%     -   25s
     0     0 38638.7230    0  457 19578.4916 38638.7230  97.4%     -   28s
     0     0 38188.3987    0  449 19578.4916 38188.3987  95.1%     -   30s
     0     0 37916.2150    0  459 19578.4916 37916.2150  93.7%     -   31s
     0     0 37872.3057    0  471 19578.4916 37872.3057  93.4%     -   32s
     0     0 37858.4467    0  468 19578.4916 37858.4467  93.4%     -   32s
     0     0 37844.0583    0  473 19578.4916 37844.0583  93.3%     -   33s
     0     0 37826.3665    0  471 19578.4916 37826.3665  93.2%     -   33s
     0     0 37821.1265    0  467 19578.4916 37821.1265  93.2%     -   33s
     0     0 37820.7143    0  475 19578.4916 37820.7143  93.2%     -   33s
     0     0 37303.0504    0  392 19578.4916 37303.0504  90.5%     -   38s
H    0     0                    19584.010521 37300.0554  90.5%     -   38s
H    0     0                    19641.355146 37300.0554  89.9%     -   38s
     0     0 37067.6642    0  440 19641.3551 37067.6642  88.7%     -   39s
     0     0 36980.4356    0  451 19641.3551 36980.4356  88.3%     -   40s
     0     0 36940.6930    0  413 19641.3551 36940.6930  88.1%     -   41s
     0     0 36924.9907    0  408 19641.3551 36924.9907  88.0%     -   41s
     0     0 36908.2578    0  414 19641.3551 36908.2578  87.9%     -   41s
     0     0 36883.0338    0  410 19641.3551 36883.0338  87.8%     -   42s
     0     0 36880.6633    0  414 19641.3551 36880.6633  87.8%     -   42s
     0     0 36880.2529    0  409 19641.3551 36880.2529  87.8%     -   42s
     0     0 36816.4611    0  405 19641.3551 36816.4611  87.4%     -   43s
     0     0 36796.6717    0  410 19641.3551 36796.6717  87.3%     -   44s
     0     0 36789.4765    0  414 19641.3551 36789.4765  87.3%     -   44s
     0     0 36785.2448    0  415 19641.3551 36785.2448  87.3%     -   44s
     0     0 36783.8823    0  418 19641.3551 36783.8823  87.3%     -   44s
     0     0 36751.3540    0  407 19641.3551 36751.3540  87.1%     -   45s
     0     0 36736.3790    0  414 19641.3551 36736.3790  87.0%     -   46s
     0     0 36735.6782    0  412 19641.3551 36735.6782  87.0%     -   46s
     0     0 36707.6765    0  417 19641.3551 36707.6765  86.9%     -   47s
     0     0 36698.7170    0  428 19641.3551 36698.7170  86.8%     -   48s
     0     0 36693.7087    0  428 19641.3551 36693.7087  86.8%     -   48s
     0     0 36691.5453    0  424 19641.3551 36691.5453  86.8%     -   48s
     0     0 36690.9258    0  430 19641.3551 36690.9258  86.8%     -   48s
     0     0 36674.8994    0  424 19641.3551 36674.8994  86.7%     -   49s
H    0     0                    19761.580288 36673.9720  85.6%     -   49s
H    0     0                    19921.475893 36673.9720  84.1%     -   49s
H    0     0                    19999.856745 36673.9720  83.4%     -   49s
H    0     0                    20011.819633 36673.9720  83.3%     -   49s
H    0     0                    20052.267615 36673.9720  82.9%     -   49s
H    0     0                    20055.217396 36673.9720  82.9%     -   49s
H    0     0                    20088.853732 36673.9720  82.6%     -   49s
H    0     0                    20094.464627 36673.9720  82.5%     -   49s
H    0     0                    20096.729756 36673.9720  82.5%     -   49s
     0     0 36671.2606    0  434 20096.7298 36671.2606  82.5%     -   49s
     0     0 36669.4807    0  429 20096.7298 36669.4807  82.5%     -   49s
     0     0 36668.9821    0  430 20096.7298 36668.9821  82.5%     -   49s
     0     0 36664.6992    0  435 20096.7298 36664.6992  82.4%     -   50s
     0     0 36661.9083    0  426 20096.7298 36661.9083  82.4%     -   50s
     0     0 36661.0644    0  436 20096.7298 36661.0644  82.4%     -   50s
     0     0 36655.5567    0  415 20096.7298 36655.5567  82.4%     -   51s
     0     0 36653.6184    0  425 20096.7298 36653.6184  82.4%     -   51s
     0     0 36653.5429    0  425 20096.7298 36653.5429  82.4%     -   51s
     0     0 36592.4832    0  411 20096.7298 36592.4832  82.1%     -   52s
     0     0 36571.7532    0  417 20096.7298 36571.7532  82.0%     -   53s
     0     0 36566.2957    0  420 20096.7298 36566.2957  82.0%     -   53s
     0     0 36565.1732    0  413 20096.7298 36565.1732  81.9%     -   53s
     0     0 36549.5580    0  417 20096.7298 36549.5580  81.9%     -   54s
H    0     0                    20137.520577 36534.7348  81.4%     -   54s
     0     0 36534.7348    0  431 20137.5206 36534.7348  81.4%     -   54s
     0     0 36532.4708    0  427 20137.5206 36532.4708  81.4%     -   55s
     0     0 36531.7988    0  430 20137.5206 36531.7988  81.4%     -   55s
     0     0 36526.5728    0  422 20137.5206 36526.5728  81.4%     -   55s
H    0     0                    20253.170941 36524.5109  80.3%     -   55s
     0     0 36523.9116    0  435 20253.1709 36523.9116  80.3%     -   56s
     0     0 36523.3629    0  431 20253.1709 36523.3629  80.3%     -   56s
     0     0 36519.4020    0  423 20253.1709 36519.4020  80.3%     -   56s
     0     0 36519.0316    0  424 20253.1709 36519.0316  80.3%     -   56s
     0     0 36514.2877    0  432 20253.1709 36514.2877  80.3%     -   57s
     0     0 36513.5746    0  437 20253.1709 36513.5746  80.3%     -   57s
     0     0 36512.1571    0  430 20253.1709 36512.1571  80.3%     -   58s
     0     0 36512.0751    0  430 20253.1709 36512.0751  80.3%     -   58s
H    0     0                    20635.212448 36512.0751  76.9%     -   65s
H    0     0                    20727.586283 36512.0751  76.2%     -   65s
H    0     0                    20815.071807 36512.0751  75.4%     -   65s
     0     2 36512.0751    0  430 20815.0718 36512.0751  75.4%     -   66s
     3     8 36106.6514    2  429 20815.0718 36415.0120  74.9%  2205   70s
    15    32 35676.1490    4  419 20815.0718 35926.3544  72.6%  3193   76s
H   31    64                    20820.151932 35676.1457  71.4%  4181   79s
    63    96 35385.2617    6  426 20820.1519 35621.8759  71.1%  3308   82s
    95   194 35322.6500    7  426 20820.1519 35621.8759  71.1%  2663   85s
   273   331 34828.7637   10  454 20820.1519 35621.8759  71.1%  1790   92s
   369   395 34264.6185   11  469 20820.1519 35384.7507  70.0%  1762   96s
   436   462 33899.7165   14  508 20820.1519 35384.7507  70.0%  1803  101s
   502   528 33440.9292   16  457 20820.1519 35384.7507  70.0%  1740  106s
   576   592 32060.9846   20  256 20820.1519 35321.8097  69.7%  1683  112s
   654   665 32841.9405   23  401 20820.1519 35321.8097  69.7%  1642  116s
   738   731 32232.6708   24  449 20820.1519 35321.8097  69.7%  1596  122s
   777   774 31121.4448   25  321 20820.1519 35203.2363  69.1%  1598  125s
   861   859 30897.4057   26  359 20820.1519 35203.2363  69.1%  1600  132s
   917   905 28969.4877   27  313 20820.1519 35203.2363  69.1%  1586  136s
  1046  1024 27427.7914   28  303 20820.1519 35203.2363  69.1%  1541  142s
  1116  1092 27398.2034   29  301 20820.1519 34844.4950  67.4%  1503  145s
  1291  1195 26076.4199   32  256 20820.1519 34755.0565  66.9%  1458  153s
  1369  1251 25411.3804   33  289 20820.1519 34425.0044  65.3%  1469  156s
  1441  1324 24406.8154   34  275 20820.1519 34425.0044  65.3%  1487  160s
  1647  1484 22778.9449   36  202 20820.1519 34425.0044  65.3%  1468  169s
  1761  1577 22470.9622   38  212 20820.1519 34425.0044  65.3%  1454  173s
  1908  1712     cutoff   40      20820.1519 34341.9205  64.9%  1416  176s
  2086  1786 21443.1924   46  193 20820.1519 34341.9205  64.9%  1372  182s
  2226  1876     cutoff   53      20820.1519 34312.9645  64.8%  1348  186s
  2404  1966 33304.9216   11  255 20820.1519 34273.2205  64.6%  1318  191s
  2578  2052 29802.3946   14  190 20820.1519 34266.0267  64.6%  1303  196s
  2712  2121 27791.3974   15  207 20820.1519 34213.9199  64.3%  1317  200s
  2831  2210 25671.5321   17  238 20820.1519 34206.1300  64.3%  1332  206s
  2970  2273 23178.4734   17  140 20820.1519 34035.4111  63.5%  1340  211s
H 2995  2265                    21034.158155 34035.4111  61.8%  1341  211s
H 3030  2264                    21068.888194 34035.4111  61.5%  1350  211s
  3075  2354 infeasible   18      21068.8882 34035.4111  61.5%  1348  216s
  3278  2428 25259.9607   20  266 21068.8882 33971.0369  61.2%  1331  222s
H 3283  2428                    21073.168127 33971.0369  61.2%  1330  222s
H 3347  2427                    21121.055438 33949.2690  60.7%  1326  222s
  3433  2541     cutoff   19      21121.0554 33940.0495  60.7%  1324  229s
  3647  2612     cutoff   24      21121.0554 33940.0495  60.7%  1318  237s
  3868  2693 22896.6917   28  208 21121.0554 33940.0495  60.7%  1315  244s
  4031  2810 31660.8860   12  417 21121.0554 33940.0495  60.7%  1331  250s
  4284  2854 29907.4269   14  449 21121.0554 33767.9369  59.9%  1317  256s
  4470  2915 25613.2216   16  327 21121.0554 33767.9369  59.9%  1326  262s
  4644  2997     cutoff   18      21121.0554 33737.1099  59.7%  1326  269s
  4856  3076 22338.5501   21  255 21121.0554 33597.6630  59.1%  1329  277s
  5072  3198 28754.3689   14  229 21121.0554 33597.6630  59.1%  1335  286s
  5316  3199 26553.7467   21  430 21121.0554 33597.6630  59.1%  1335  303s
  5318  3200 25032.5206   22   90 21121.0554 33597.6630  59.1%  1335  312s
  5319  3201 27957.0755   21  359 21121.0554 33597.6630  59.1%  1334  318s
  5320  3202 32731.9419   18  479 21121.0554 33597.6630  59.1%  1334  323s
  5321  3202 30425.1789   18  453 21121.0554 33597.6630  59.1%  1334  326s
  5324  3204 31171.4010   19  426 21121.0554 33597.6630  59.1%  1333  331s
  5328  3207 29091.0483   20  475 21121.0554 33597.6630  59.1%  1332  336s
  5332  3210 33048.0097    9  528 21121.0554 33597.6630  59.1%  1331  340s
  5336  3212 23570.7357   40  480 21121.0554 33597.6630  59.1%  1330  345s
  5339  3214 23510.1467   24  491 21121.0554 33597.6630  59.1%  1329  350s
  5343  3217 31457.8004   15  431 21121.0554 33597.6630  59.1%  1328  357s
  5345  3218 27822.1708   22  494 21121.0554 33597.6630  59.1%  1328  360s
  5346  3219 26896.0449   15  494 21121.0554 33597.6630  59.1%  1328  370s
  5347  3220 24316.6870   22  494 21121.0554 33597.6630  59.1%  1327  377s
  5348  3223 33597.6630   11  439 21121.0554 33597.6630  59.1%  1344  385s
  5350  3227 33597.6630   12  476 21121.0554 33597.6630  59.1%  1344  392s
  5354  3233 33597.6630   13  486 21121.0554 33597.6630  59.1%  1347  398s
  5362  3247 33597.6630   14  485 21121.0554 33597.6630  59.1%  1351  404s
  5378  3270 32862.5638   15  403 21121.0554 33597.6630  59.1%  1371  415s
  5407  3293 32059.5197   16  378 21121.0554 33597.6630  59.1%  1397  420s
  5439  3334 30617.6383   17  320 21121.0554 33597.6630  59.1%  1413  426s
  5493  3402 29802.8707   18  307 21121.0554 33597.6630  59.1%  1436  432s
  5589  3442 28895.0586   19  302 21121.0554 33597.6630  59.1%  1453  436s
  5680  3468 28517.2976   21  283 21121.0554 33597.6630  59.1%  1463  444s
  5767  3495 25328.4299   19  353 21121.0554 33597.6630  59.1%  1472  449s
  5838  3495 26866.9746   23  332 21121.0554 33597.6630  59.1%  1484  454s
  5888  3516 23878.9489   23  296 21121.0554 33597.6630  59.1%  1493  463s
  5959  3529 26873.2081   22  255 21121.0554 33597.6630  59.1%  1498  469s
  6033  3534 26658.9310   23  196 21121.0554 33597.6630  59.1%  1508  474s
  6106  3545 26319.5342   24  170 21121.0554 33597.6630  59.1%  1509  481s
  6181  3548 25156.9486   26  186 21121.0554 33597.6630  59.1%  1514  488s
  6244  3558 24181.6038   28  232 21121.0554 33065.5763  56.6%  1517  495s
  6323  3552 24053.8569   30  190 21121.0554 33026.7257  56.4%  1519  501s
  6387  3557 23503.2517   32  147 21121.0554 33026.7257  56.4%  1526  507s
  6460  3560 23196.3818   34  123 21121.0554 32681.1599  54.7%  1530  512s
  6529  3576     cutoff   34      21121.0554 32514.2630  53.9%  1532  520s
  6624  3599 28185.8951   17  397 21121.0554 32058.3297  51.8%  1533  526s
  6725  3624 27957.5018   19  319 21121.0554 31774.0847  50.4%  1535  532s
  6825  3626 26658.9802   24  190 21121.0554 31648.5203  49.8%  1533  538s
  6886  3663 26600.8335   25  207 21121.0554 31609.5295  49.7%  1536  544s
  6964  3683 25740.5774   28  151 21121.0554 31609.5295  49.7%  1539  550s
  7064  3712 24266.0083   32  105 21121.0554 31609.5295  49.7%  1544  556s
  7162  3753 23094.1776   37  248 21121.0554 31413.4025  48.7%  1552  562s
  7280  3762 22244.9561   44  176 21121.0554 31379.9826  48.6%  1555  569s
  7415  3778 25689.2501   20  363 21121.0554 31085.8028  47.2%  1559  577s
  7544  3754 23340.7368   22  183 21121.0554 31084.4432  47.2%  1570  582s
  7587  3798 22667.6264   23  231 21121.0554 31084.4432  47.2%  1574  588s
  7670  3823     cutoff   24      21121.0554 31084.4432  47.2%  1576  595s
  7809  3827 21519.8361   27  182 21121.0554 30952.0162  46.5%  1583  603s
  7958  3837 26300.6662   21  351 21121.0554 30870.0298  46.2%  1594  612s
  8101  3868 25696.0588   24  319 21121.0554 30755.1995  45.6%  1608  619s
  8258  3881 21659.6210   29  252 21121.0554 30669.2008  45.2%  1614  626s
  8443  3872 27943.5307   23  313 21121.0554 30352.9909  43.7%  1617  634s
  8605  3844 28780.2692   24  262 21121.0554 30232.5093  43.1%  1637  639s
  8642  3870 25195.0348   24  268 21121.0554 30232.5093  43.1%  1646  645s
  8685  3895 27717.5223   25  306 21121.0554 30232.5093  43.1%  1652  652s
  8760  3927 28383.3213   25  173 21121.0554 30232.5093  43.1%  1654  661s
  8906  3926 27678.2818   26  177 21121.0554 29868.4829  41.4%  1656  672s
  9144  3889 27223.2902   27  292 21121.0554 29868.4829  41.4%  1659  680s
  9346  3925 infeasible   31      21121.0554 29793.3126  41.1%  1674  691s
  9599  3878 infeasible   20      21121.0554 29793.3126  41.1%  1679  701s
  9925  3825 21137.3701   24  251 21121.0554 29553.1592  39.9%  1682  711s
 10129  3833 26074.2439   24  331 21121.0554 29553.1592  39.9%  1693  723s
 10405  3842     cutoff   31      21121.0554 29553.1592  39.9%  1709  731s
 10706  3796 23244.3578   22  314 21121.0554 28989.6732  37.3%  1713  742s
 11061  3725     cutoff   23      21121.0554 28989.6732  37.3%  1717  753s
 11411  3698     cutoff   21      21121.0554 28723.0950  36.0%  1728  765s
 11740  3629 26660.4835   21  324 21121.0554 28706.8245  35.9%  1745  775s
 12019  3593 26342.4876   23  326 21121.0554 28706.8245  35.9%  1749  786s
 12358  3561 24799.4877   26  146 21121.0554 28595.6664  35.4%  1763  799s
 12783  3472     cutoff   39      21121.0554 28595.6664  35.4%  1770  810s
 13107  3459     cutoff   42      21121.0554 28595.6664  35.4%  1773  822s
 13386  3435 infeasible   43      21121.0554 28323.2544  34.1%  1779  834s
 13643  3425     cutoff   44      21121.0554 28113.8607  33.1%  1784  848s
 14006  3381     cutoff   21      21121.0554 28084.3000  33.0%  1790  863s
 14512  3320     cutoff   25      21121.0554 28081.4827  33.0%  1794  877s
 15021  3247 23847.3298   22  227 21121.0554 27863.8669  31.9%  1803  891s
 15622  3386     cutoff   23      21121.0554 27639.2569  30.9%  1808  907s
 16210  3472 23918.3785   20  501 21121.0554 27537.4939  30.4%  1815  922s
 16802  3583 21368.8703   26  395 21121.0554 27430.6384  29.9%  1821  938s
 17446  3613     cutoff   26      21121.0554 27103.3974  28.3%  1827  951s
 17541  3676 24515.2613   25  126 21121.0554 27096.7176  28.3%  1831  968s
 17958  3801     cutoff   30      21121.0554 27092.8299  28.3%  1837  985s
 18594  3891 23168.5824   24  240 21121.0554 26883.4324  27.3%  1846 1003s
 19310  3998     cutoff   29      21121.0554 26669.9528  26.3%  1850 1022s
 20026  4083 22304.5437   24  266 21121.0554 26508.4662  25.5%  1858 1041s
 20759  4149 23832.3785   27  255 21121.0554 26348.5282  24.8%  1865 1060s
 21559  4213     cutoff   29      21121.0554 26214.8214  24.1%  1868 1079s
 22375  4247 22763.2154   33  143 21121.0554 26088.5507  23.5%  1871 1099s
 23330  4237     cutoff   30      21121.0554 25832.5534  22.3%  1869 1121s
 24213  4267 22531.9740   32  213 21121.0554 25636.0016  21.4%  1873 1142s
 25232  4210 22457.6926   34  172 21121.0554 25502.4982  20.7%  1867 1163s
 26274  4064 22199.8705   21  225 21121.0554 25277.5248  19.7%  1863 1186s
 27367  3880 22709.5799   35  173 21121.0554 25031.7812  18.5%  1856 1212s
 28613  3600     cutoff   21      21121.0554 24848.2986  17.6%  1843 1236s
 29931  3056 infeasible   25      21121.0554 24547.7974  16.2%  1828 1260s
 31441  2364     cutoff   38      21121.0554 24303.1945  15.1%  1803 1284s
 33393  1147     cutoff   27      21121.0554 23627.5244  11.9%  1757 1308s
 35719  1007 infeasible   40      21121.0554 23008.4635  8.94%  1693 1322s
*35775  1007              55    21154.613286 23008.4635  8.76%  1691 1322s
*35881  1007              62    21170.093557 23008.4635  8.68%  1686 1322s
H36632  1007                    21452.103431 22950.6525  6.99%  1655 1322s
H36635  1007                    21459.309469 22950.6525  6.95%  1655 1322s
*37234  1007              48    21469.275287 22949.2882  6.89%  1631 1322s
H38642  1007                    21570.215803 22930.8195  6.31%  1579 1322s
 39419   575     cutoff   46      21570.2158 21878.9014  1.43%  1552 1325s
*39914   575              76    21574.750139 21854.4222  1.30%  1533 1325s
*40071   575              63    21582.191833 21854.4222  1.26%  1527 1325s
*40187   575              54    21611.443961 21852.3847  1.11%  1523 1325s
*40213   575              42    21645.218386 21852.3847  0.96%  1522 1325s
*40684   575              50    21650.733288 21848.8679  0.92%  1505 1325s
H40703   575                    21654.041537 21848.8679  0.90%  1504 1325s
*40765   575              75    21757.229617 21848.8679  0.42%  1502 1325s
H43027     0                    21766.757447 21781.0824  0.07%  1424 1326s
*43032     0              47    21767.603558 21779.7941  0.06%  1424 1326s

Cutting planes:
  Learned: 1
  Gomory: 1
  MIR: 628
  Mixing: 4
  Flow cover: 1452
  Inf proof: 1
  RLT: 23
  Relax-and-lift: 86

Explored 43558 nodes (61382486 simplex iterations) in 1326.63 seconds (4488.91 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 21767.6 21767.6 21766.8 ... 21574.8

Optimal solution found (tolerance 1.00e-06)
Best objective 2.176760355842e+04, best bound 2.176760355842e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1326.66s
  Master Objective (UB) = 21767.60, θ = 162706.26
  Upper Bound (UB) = 21767.60

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 162706.26
  [DEBUG]   ✓ Scenario 0: θ = 162706.26 ≤ Q = 166323.46 (slack: 3617.19)
  [DEBUG]   ✓ Scenario 1: θ = 162706.26 ≤ Q = 162706.26 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 162706.26 ≤ Q = 162731.77 (slack: 25.50)
  [DEBUG]   ✓ Scenario 3: θ = 162706.26 ≤ Q = 162727.11 (slack: 20.85)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x6e85d32e
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x6e85d32e
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.531295e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 8057014.2288
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.471404e+05, 260 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -147140.39    0  129 8057014.23 -147140.39   102%     -    0s
H    0     0                    -110943.2809 -147140.39  32.6%     -    0s
H    0     0                    -112107.6202 -147140.39  31.2%     -    0s
H    0     0                    -122723.6738 -147140.39  19.9%     -    0s
     0     0 -135411.03    0   77 -122723.67 -135411.03  10.3%     -    0s
H    0     0                    -133602.0110 -135325.62  1.29%     -    0s
H    0     0                    -133624.7992 -135325.62  1.27%     -    0s
H    0     0                    -133964.9165 -135325.62  1.02%     -    0s
H    0     0                    -133987.7047 -135325.62  1.00%     -    0s
     0     0 -135114.88    0   78 -133987.70 -135114.88  0.84%     -    0s
     0     0 -135106.96    0   79 -133987.70 -135106.96  0.84%     -    0s
     0     0 -134505.15    0   32 -133987.70 -134505.15  0.39%     -    0s
H    0     0                    -134188.0098 -134499.79  0.23%     -    0s
     0     0 -134389.15    0   26 -134188.01 -134389.15  0.15%     -    0s
     0     0 -134362.09    0   13 -134188.01 -134362.09  0.13%     -    0s
     0     0 -134352.23    0   20 -134188.01 -134352.23  0.12%     -    0s
     0     0 -134350.30    0   19 -134188.01 -134350.30  0.12%     -    0s
     0     0 -134350.30    0   19 -134188.01 -134350.30  0.12%     -    0s
     0     0 -134304.22    0    5 -134188.01 -134304.22  0.09%     -    0s
     0     0 -134304.22    0   10 -134188.01 -134304.22  0.09%     -    0s
H    0     0                    -134239.6608 -134304.22  0.05%     -    0s
     0     0 -134291.08    0    3 -134239.66 -134291.08  0.04%     -    0s
H    0     0                    -134287.2038 -134288.09  0.00%     -    0s
     0     0 -134288.09    0    2 -134287.20 -134288.09  0.00%     -    0s

Cutting planes:
  Gomory: 3
  Implied bound: 4
  MIR: 3
  Flow cover: 8
  Relax-and-lift: 1

Explored 1 nodes (709 simplex iterations) in 0.06 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -134287 -134240 -134188 ... 8.05701e+06
No other solutions better than -134287

Optimal solution found (tolerance 1.00e-06)
Best objective -1.342872037989e+05, best bound -1.342872037989e+05, gap 0.0000%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 142009.99
  Scenario: 35 demand increases, 25 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -134287.20
  [DEBUG]   S×d_nominal = 276297.19
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 276297.19 + -134287.20 = 142009.99
  [DEBUG]   Current θ from Master = 162706.26
  [DEBUG]   ⚠️  Z_SP ≤ θ by 20696.28 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 1071.33
  Lower Bound (LB) = 19998.82
  Gap (UB-LB) = 1768.7833, Absolute Gap = 1768.7833, Relative Gap = 0.081258
  Not converged yet (gap = 1768.78 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 35 increases, 25 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221719 nonzeros
Model fingerprint: 0xfe693ee7
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 33895 rows and 13765 columns
Presolve time: 0.69s
Presolved: 43938 rows, 19695 columns, 272414 nonzeros
Variable types: 17436 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -361254.7791
Found heuristic solution: objective -211287.5740

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 43938 rows, 19695 columns, 272414 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   31244    2.2771421e+04   0.000000e+00   1.268303e+07      5s
   44989    3.7308718e+04   0.000000e+00   2.118796e+06     10s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 4.894193e+04, 32604 iterations, 11.80 seconds (24.33 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 48941.9294    0  170 -211287.57 48941.9294   123%     -   12s
H    0     0                    -199094.0791 48941.9294   125%     -   12s
H    0     0                    -119037.4018 48941.9294   141%     -   12s
H    0     0                    -93747.25704 48941.9294   152%     -   12s
H    0     0                    -55083.76273 48941.9294   189%     -   12s
H    0     0                    -54178.99122 48941.9294   190%     -   13s
H    0     0                    -54037.63888 48941.9294   191%     -   13s
H    0     0                    -53399.49381 48941.9294   192%     -   13s
H    0     0                    -53289.03764 48941.9294   192%     -   13s
H    0     0                    -1401.945659 48941.9294  3591%     -   13s
H    0     0                    9971.0681522 48941.9294   391%     -   13s
H    0     0                    10650.866203 48941.9294   360%     -   13s
H    0     0                    11077.186687 48941.9294   342%     -   13s
H    0     0                    11245.856457 48941.9294   335%     -   13s
H    0     0                    11555.356105 48941.9294   324%     -   13s
H    0     0                    11575.796212 48941.1918   323%     -   14s
     0     0 44624.7850    0  276 11575.7962 44624.7850   286%     -   17s
H    0     0                    11669.278631 44624.7850   282%     -   17s
     0     0 43878.7714    0  278 11669.2786 43878.7714   276%     -   19s
     0     0 43231.0512    0  286 11669.2786 43231.0512   270%     -   20s
     0     0 43231.0512    0  278 11669.2786 43231.0512   270%     -   23s
     0     0 43231.0512    0  278 11669.2786 43231.0512   270%     -   23s
     0     0 43231.0512    0  278 11669.2786 43231.0512   270%     -   23s
     0     0 43231.0512    0  277 11669.2786 43231.0512   270%     -   23s
     0     0 43231.0512    0  277 11669.2786 43231.0512   270%     -   24s
H    0     0                    12157.547582 40747.8183   235%     -   29s
H    0     0                    12212.788752 40747.8183   234%     -   29s
     0     0 40516.2333    0  340 12212.7888 40516.2333   232%     -   29s
H    0     0                    17565.078135 40516.2333   131%     -   29s
     0     0 40250.2475    0  342 17565.0781 40250.2475   129%     -   32s
     0     0 40056.4664    0  340 17565.0781 40056.4664   128%     -   33s
     0     0 39997.8682    0  341 17565.0781 39997.8682   128%     -   35s
     0     0 39930.1653    0  348 17565.0781 39930.1653   127%     -   36s
     0     0 39927.3617    0  356 17565.0781 39927.3617   127%     -   37s
     0     0 39924.6921    0  354 17565.0781 39924.6921   127%     -   37s
     0     0 39924.5472    0  352 17565.0781 39924.5472   127%     -   37s
     0     0 38315.9623    0  393 17565.0781 38315.9623   118%     -   45s
H    0     0                    17931.638521 38315.8379   114%     -   45s
     0     0 38149.5674    0  409 17931.6385 38149.5674   113%     -   48s
     0     0 38128.0401    0  417 17931.6385 38128.0401   113%     -   49s
     0     0 38099.3739    0  410 17931.6385 38099.3739   112%     -   50s
     0     0 38046.9426    0  411 17931.6385 38046.9426   112%     -   51s
     0     0 37956.0178    0  423 17931.6385 37956.0178   112%     -   52s
     0     0 37946.1672    0  424 17931.6385 37946.1672   112%     -   53s
     0     0 37937.6055    0  430 17931.6385 37937.6055   112%     -   54s
     0     0 37935.4098    0  428 17931.6385 37935.4098   112%     -   54s
     0     0 37933.5793    0  427 17931.6385 37933.5793   112%     -   54s
     0     0 37932.5475    0  432 17931.6385 37932.5475   112%     -   54s
H    0     0                    19126.125380 37326.3732  95.2%     -   60s
H    0     0                    19337.224403 37326.3732  93.0%     -   60s
     0     0 37326.3732    0  396 19337.2244 37326.3732  93.0%     -   60s
H    0     0                    20185.291264 37326.0391  84.9%     -   60s
     0     0 37197.4513    0  389 20185.2913 37197.4513  84.3%     -   62s
     0     0 37124.6066    0  387 20185.2913 37124.6066  83.9%     -   64s
     0     0 37082.3550    0  397 20185.2913 37082.3550  83.7%     -   65s
     0     0 37070.3673    0  388 20185.2913 37070.3673  83.7%     -   66s
     0     0 37064.5753    0  394 20185.2913 37064.5753  83.6%     -   66s
     0     0 37055.7992    0  398 20185.2913 37055.7992  83.6%     -   67s
     0     0 37052.4454    0  400 20185.2913 37052.4454  83.6%     -   67s
     0     0 37050.0666    0  398 20185.2913 37050.0666  83.5%     -   67s
     0     0 37049.3703    0  402 20185.2913 37049.3703  83.5%     -   67s
     0     0 36894.8685    0  439 20185.2913 36894.8685  82.8%     -   70s
H    0     0                    20506.909881 36894.5586  79.9%     -   70s
     0     0 36848.6262    0  399 20506.9099 36848.6262  79.7%     -   71s
     0     0 36841.3532    0  409 20506.9099 36841.3532  79.7%     -   72s
     0     0 36838.8959    0  406 20506.9099 36838.8959  79.6%     -   72s
     0     0 36836.9295    0  410 20506.9099 36836.9295  79.6%     -   72s
     0     0 36836.7682    0  414 20506.9099 36836.7682  79.6%     -   72s
     0     0 36771.1133    0  416 20506.9099 36771.1133  79.3%     -   75s
H    0     0                    20537.266548 36770.5691  79.0%     -   76s
     0     0 36746.2200    0  414 20537.2665 36746.2200  78.9%     -   77s
     0     0 36734.9861    0  474 20537.2665 36734.9861  78.9%     -   78s
     0     0 36724.4280    0  467 20537.2665 36724.4280  78.8%     -   78s
     0     0 36718.4379    0  474 20537.2665 36718.4379  78.8%     -   78s
     0     0 36716.7266    0  476 20537.2665 36716.7266  78.8%     -   79s
     0     0 36715.4096    0  476 20537.2665 36715.4096  78.8%     -   79s
     0     0 36653.0311    0  420 20537.2665 36653.0311  78.5%     -   81s
H    0     0                    20567.808602 36652.3942  78.2%     -   81s
     0     0 36628.5906    0  432 20567.8086 36628.5906  78.1%     -   82s
     0     0 36625.8059    0  425 20567.8086 36625.8059  78.1%     -   82s
     0     0 36624.8122    0  426 20567.8086 36624.8122  78.1%     -   82s
     0     0 36606.0105    0  433 20567.8086 36606.0105  78.0%     -   83s
     0     0 36587.8310    0  433 20567.8086 36587.8310  77.9%     -   85s
     0     0 36585.9710    0  432 20567.8086 36585.9710  77.9%     -   85s
     0     0 36584.2989    0  436 20567.8086 36584.2989  77.9%     -   85s
     0     0 36583.8967    0  431 20567.8086 36583.8967  77.9%     -   85s
     0     0 36572.0369    0  434 20567.8086 36572.0369  77.8%     -   86s
     0     0 36568.2112    0  436 20567.8086 36568.2112  77.8%     -   86s
     0     0 36567.3004    0  435 20567.8086 36567.3004  77.8%     -   87s
     0     0 36548.5427    0  437 20567.8086 36548.5427  77.7%     -   87s
     0     0 36540.2067    0  438 20567.8086 36540.2067  77.7%     -   89s
     0     0 36536.2416    0  450 20567.8086 36536.2416  77.6%     -   89s
     0     0 36534.3200    0  450 20567.8086 36534.3200  77.6%     -   89s
     0     0 36533.0735    0  443 20567.8086 36533.0735  77.6%     -   90s
     0     0 36524.1708    0  452 20567.8086 36524.1708  77.6%     -   90s
     0     0 36518.8557    0  445 20567.8086 36518.8557  77.6%     -   91s
     0     0 36517.6141    0  450 20567.8086 36517.6141  77.5%     -   91s
     0     0 36511.0361    0  436 20567.8086 36511.0361  77.5%     -   92s
H    0     0                    20820.151932 36510.9358  75.4%     -   94s
     0     0 36507.2881    0  479 20820.1519 36507.2881  75.3%     -   95s
     0     0 36506.6894    0  523 20820.1519 36506.6894  75.3%     -   95s
     0     0 36505.0032    0  488 20820.1519 36505.0032  75.3%     -   96s
     0     0 36503.9622    0  492 20820.1519 36503.9622  75.3%     -   96s
     0     0 36500.1097    0  438 20820.1519 36500.1097  75.3%     -   97s
     0     0 36499.9463    0  438 20820.1519 36499.9463  75.3%     -   98s
     0     2 36499.8888    0  438 20820.1519 36499.8888  75.3%     -  119s
     1     4 36433.7426    1  431 20820.1519 36498.5589  75.3%  1002  121s
     3     8 36390.9015    2  427 20820.1519 36433.5856  75.0%  2163  125s
     7    16 36315.7375    3  482 20820.1519 36388.1323  74.8%  3667  130s
    15    32 35798.6566    4  521 20820.1519 36315.3905  74.4%  5533  135s
    31    52 33920.2844    5  340 20820.1519 35797.7637  71.9%  6437  146s
    51    84 34077.0021    6  452 20820.1519 35797.3518  71.9%  7571  152s
    83   137 33992.1738    7  408 20820.1519 35797.3518  71.9%  5815  158s
   136   193 33812.6447   11  384 20820.1519 35797.3518  71.9%  4425  164s
   192   279 33613.8040   13  427 20820.1519 35797.3518  71.9%  3620  169s
   280   375 32828.9166   14  303 20820.1519 35797.3518  71.9%  3039  174s
   382   441 33544.8536   14  301 20820.1519 35797.3518  71.9%  2673  180s
   457   472 33560.4365   14  425 20820.1519 35797.3518  71.9%  2624  187s
   492   513 33576.1067   15  318 20820.1519 35797.3518  71.9%  2673  193s
   535   543 33212.9247   15  312 20820.1519 35797.3518  71.9%  2686  199s
   576   584 32680.1857   15  311 20820.1519 35797.3518  71.9%  2668  207s
   635   619 32507.1471   15  297 20820.1519 35797.3518  71.9%  2679  214s
   684   678 31887.6765   15  273 20820.1519 35797.3518  71.9%  2694  219s
   757   729 31821.9770   15  306 20820.1519 35797.3518  71.9%  2635  225s
   818   799 33129.2680   15  426 20820.1519 35797.3518  71.9%  2601  231s
H  959   864                    20930.490750 35797.3518  71.0%  2548  234s
   983   941 32783.9843   16  312 20930.4908 35797.3518  71.0%  2545  240s
  1171  1083 32505.8862   18  289 20930.4908 35618.3839  70.2%  2566  252s
  1271  1154 31434.8771   19  284 20930.4908 35618.3839  70.2%  2557  259s
  1384  1221 30834.9216   19  228 20930.4908 35618.3839  70.2%  2531  264s
  1481  1305 31237.5275   20  211 20930.4908 35618.3839  70.2%  2559  269s
  1569  1422 32071.2607   19  251 20930.4908 35618.3839  70.2%  2595  275s
  1694  1517 30641.7099   22  198 20930.4908 35618.3839  70.2%  2561  282s
  1835  1626 28087.5967   23  194 20930.4908 35341.1065  68.8%  2532  287s
  1970  1737 28989.3599   25  142 20930.4908 35341.1065  68.8%  2506  292s
H 2086  1737                    20965.685064 35206.0490  67.9%  2475  292s
  2117  1854 28719.1834   27  151 20965.6851 35206.0490  67.9%  2467  300s
H 2280  1959                    21053.253235 34936.4098  65.9%  2422  305s
H 2311  1956                    21121.055438 34936.4098  65.4%  2418  305s
  2407  2142 27341.1208   32  152 21121.0554 34936.4098  65.4%  2397  312s
  2633  2171 26863.5855   34  157 21121.0554 34936.4098  65.4%  2321  316s
  2668  2203 26673.1508   34  126 21121.0554 34936.4098  65.4%  2323  322s
  2706  2233 26555.2265   35  132 21121.0554 34936.4098  65.4%  2331  330s
  2790  2340 26547.5064   36  128 21121.0554 34936.4098  65.4%  2337  340s
  2887  2470 25704.2537   36  290 21121.0554 34936.4098  65.4%  2315  345s
  3047  2632 25569.8291   40  122 21121.0554 34936.4098  65.4%  2274  354s
  3311  2852 25428.0363   43  226 21121.0554 34936.4098  65.4%  2194  361s
  3611  2853 29628.6180   24  438 21121.0554 34840.1481  65.0%  2120  409s
  3613  2854 33810.8321   12  170 21121.0554 34840.1481  65.0%  2119  425s
  3614  2855 22412.8962   82  390 21121.0554 34840.1481  65.0%  2119  436s
  3615  2856 32295.2367   10  421 21121.0554 34840.1481  65.0%  2118  443s
  3616  2856 22127.7477   31  439 21121.0554 34840.1481  65.0%  2117  447s
  3617  2857 26932.2457   31  453 21121.0554 34840.1481  65.0%  2117  452s
  3618  2858 25990.0678   51  419 21121.0554 34840.1481  65.0%  2116  455s
  3620  2859 25631.5545   59  427 21121.0554 34840.1481  65.0%  2115  460s
  3624  2862 28928.1010   12  437 21121.0554 34840.1481  65.0%  2113  466s
  3627  2864 32904.3502    8  490 21121.0554 34840.1481  65.0%  2111  472s
  3629  2865 23691.5753   65  489 21121.0554 34840.1481  65.0%  2110  475s
  3631  2866 27683.8170   31  540 21121.0554 34840.1481  65.0%  2109  481s
  3634  2868 26779.5690   30  495 21121.0554 34840.1481  65.0%  2107  485s
  3637  2870 32113.2863   11  586 21121.0554 34840.1481  65.0%  2105  490s
  3639  2872 26815.9839   39  575 21121.0554 34840.1481  65.0%  2104  495s
  3642  2874 31076.8065    7  535 21121.0554 34840.1481  65.0%  2102  500s
  3644  2875 22225.0321   77  583 21121.0554 34840.1481  65.0%  2101  506s
  3646  2876 22090.4642   54  540 21121.0554 34840.1481  65.0%  2100  512s
  3648  2878 23789.1671   55  554 21121.0554 34840.1481  65.0%  2099  515s
  3650  2879 28026.5013   37  559 21121.0554 34840.1481  65.0%  2098  521s
  3652  2880 27342.8847   46  601 21121.0554 34840.1481  65.0%  2097  526s
  3654  2882 22324.8330   39  452 21121.0554 34840.1481  65.0%  2095  531s
  3657  2884 24036.6726   69  440 21121.0554 34840.1481  65.0%  2094  536s
  3659  2885 26211.2820   36  501 21121.0554 34840.1481  65.0%  2093  540s
  3660  2886 30248.5092   28  501 21121.0554 34840.1481  65.0%  2092  557s
  3661  2886 33370.7606   12  501 21121.0554 34840.1481  65.0%  2091  574s
  3662  2890 34840.1481   15  424 21121.0554 34840.1481  65.0%  2137  586s
  3664  2893 34840.1481   16  424 21121.0554 34840.1481  65.0%  2137  598s
  3668  2900 34840.1481   17  433 21121.0554 34840.1481  65.0%  2140  612s
  3676  2913 34840.1481   18  527 21121.0554 34840.1481  65.0%  2153  623s
  3692  2927 30349.8613   19  330 21121.0554 34840.1481  65.0%  2187  637s
  3711  2953 31719.7504   20  351 21121.0554 34840.1481  65.0%  2218  647s
  3743  3053 30718.4205   21  301 21121.0554 34840.1481  65.0%  2236  657s
  3859  3079 30215.0966   25  323 21121.0554 34840.1481  65.0%  2262  663s
  3935  3085 29748.2818   26  240 21121.0554 34840.1481  65.0%  2268  667s
  3967  3102 30144.4643   24  340 21121.0554 34840.1481  65.0%  2267  671s
  4004  3118 29443.4188   26  324 21121.0554 34840.1481  65.0%  2270  682s
  4044  3142 28923.2047   27  246 21121.0554 34840.1481  65.0%  2273  688s
  4085  3167 29328.7680   27  243 21121.0554 34840.1481  65.0%  2269  692s
  4138  3178 29316.2498   28  238 21121.0554 34840.1481  65.0%  2256  700s
  4258  3210 28667.6392   30  243 21121.0554 34840.1481  65.0%  2237  710s
  4331  3241 28402.6107   31  213 21121.0554 34840.1481  65.0%  2230  719s
  4417  3256 28343.6164   32  209 21121.0554 34840.1481  65.0%  2220  724s
  4487  3281 28318.5602   33  207 21121.0554 34840.1481  65.0%  2211  731s
  4579  3284 28006.5841   35  104 21121.0554 34692.1671  64.3%  2194  741s
  4663  3274 23589.7936   35   71 21121.0554 34692.1671  64.3%  2185  748s
  4743  3275 27192.6305   38  251 21121.0554 34692.1671  64.3%  2179  757s
  4814  3290 22432.3968   38   33 21121.0554 34692.1671  64.3%  2179  765s
  4906  3300 26948.5635   40  173 21121.0554 34475.8275  63.2%  2177  772s
  4991  3313 26000.7790   42  189 21121.0554 34475.8275  63.2%  2175  781s
  5066  3335 24553.7340   45  102 21121.0554 32563.8417  54.2%  2175  788s
  5147  3358     cutoff   49      21121.0554 32563.8417  54.2%  2180  795s
  5262  3358     cutoff   53      21121.0554 32563.8417  54.2%  2169  804s
  5389  3353 26865.4845   24  360 21121.0554 32286.5639  52.9%  2156  812s
  5509  3371 25795.9264   26  325 21121.0554 32286.5639  52.9%  2157  822s
  5624  3405 25744.4754   27  312 21121.0554 32286.5639  52.9%  2153  830s
  5750  3396 25062.8416   30  239 21121.0554 32072.5706  51.9%  2146  838s
  5867  3406 24740.8789   34  308 21121.0554 31693.0012  50.1%  2137  847s
  5990  3442 21670.4697   37  192 21121.0554 31693.0012  50.1%  2137  857s
  6123  3437 26027.0356   23  420 21121.0554 31530.9410  49.3%  2132  866s
  6272  3435 24878.6858   26  355 21121.0554 31368.4832  48.5%  2129  877s
  6372  3491 23323.0441   27  234 21121.0554 31192.6544  47.7%  2133  887s
  6517  3508 22044.6383   33  148 21121.0554 31192.6544  47.7%  2131  898s
  6712  3521 21349.4439   38  173 21121.0554 31192.6544  47.7%  2116  909s
  6893  3515 27456.1443   24  366 21121.0554 30731.4640  45.5%  2113  920s
  7021  3581 27061.1419   24  293 21121.0554 30454.6909  44.2%  2106  932s
  7200  3628 24952.9806   27  236 21121.0554 30454.6909  44.2%  2103  944s
  7401  3659 22356.5643   31  194 21121.0554 30454.6909  44.2%  2101  956s
  7653  3658 27136.1657   23  341 21121.0554 30303.6266  43.5%  2084  967s
  7842  3711 22624.1843   26  329 21121.0554 30288.0978  43.4%  2078  980s
  8097  3719 22905.1946   29   95 21121.0554 30021.9636  42.1%  2073  993s
  8313  3722     cutoff   40      21121.0554 30021.9636  42.1%  2069 1007s
  8604  3711 23863.7534   26  348 21121.0554 29680.9908  40.5%  2060 1022s
  8898  3717     cutoff   31      21121.0554 29667.6490  40.5%  2054 1036s
  9248  3676     cutoff   29      21121.0554 29276.7325  38.6%  2038 1051s
  9575  3679 21488.5985   35  129 21121.0554 29271.6889  38.6%  2030 1066s
  9814  3742 23665.5351   25  313 21121.0554 29207.7869  38.3%  2023 1081s
 10196  3760 infeasible   28      21121.0554 29207.7869  38.3%  2008 1096s
 10584  3822 26413.4157   27  303 21121.0554 29207.7869  38.3%  1996 1113s
 11030  3788     cutoff   39      21121.0554 29207.7869  38.3%  1978 1129s
 11506  3703     cutoff   45      21121.0554 29207.7869  38.3%  1958 1147s
 11987  3715 22764.8266   31  303 21121.0554 28845.7098  36.6%  1946 1165s
 12421  3762 26584.6675   24  347 21121.0554 28693.8352  35.9%  1941 1183s
 12862  3884 22148.0096   34  118 21121.0554 28337.9084  34.2%  1938 1201s
 13323  4039 21691.3668   25  189 21121.0554 28337.9084  34.2%  1935 1221s
 13847  4191 22950.6337   28  300 21121.0554 28082.8888  33.0%  1923 1241s
 14377  4350 26101.0827   25  342 21121.0554 28080.9873  33.0%  1913 1262s
 14916  4595 infeasible   31      21121.0554 28080.9873  33.0%  1908 1283s
 15509  4814 21832.5921   42  142 21121.0554 27861.3070  31.9%  1898 1305s
 16135  4846 23412.7763   43  162 21121.0554 27671.9474  31.0%  1888 1324s
 16212  5011 23186.9440   45  142 21121.0554 27671.9474  31.0%  1886 1347s
 16655  5322 26252.3224   28  236 21121.0554 27572.1116  30.5%  1877 1370s
 17353  5531     cutoff   32      21121.0554 27540.3798  30.4%  1864 1396s
 18158  5718 21934.3044   39  209 21121.0554 27540.3798  30.4%  1845 1424s
 18973  5890 23636.6011   27  372 21121.0554 27261.4935  29.1%  1829 1451s
 19708  6088 24751.7480   33  177 21121.0554 27071.3881  28.2%  1823 1482s
 20641  6200 22173.5971   27  339 21121.0554 26937.6056  27.5%  1803 1508s
 21213  6365     cutoff   35      21121.0554 26865.1528  27.2%  1797 1535s
 22038  6594 22558.8129   34  280 21121.0554 26799.5632  26.9%  1785 1566s
 22887  6815 22961.3793   30  233 21121.0554 26589.5199  25.9%  1780 1599s
 23765  7022 23394.9101   27  297 21121.0554 26504.3191  25.5%  1775 1631s
 24712  7177     cutoff   31      21121.0554 26302.0666  24.5%  1769 1663s
 25730  7347     cutoff   25      21121.0554 26179.8945  24.0%  1760 1699s
 26844  7449 21937.5253   33  284 21121.0554 26008.7766  23.1%  1748 1739s
 27909  7571 23066.2748   27  430 21121.0554 25865.7720  22.5%  1741 1777s
 28965  7700 23445.2250   32  288 21121.0554 25727.1688  21.8%  1735 1823s
 30353  7800 21455.2397   33  124 21121.0554 25547.7621  21.0%  1719 1859s
 31374  7940 22793.8322   30  319 21121.0554 25401.7983  20.3%  1714 1895s
 32623  8101 22296.8893   28  327 21121.0554 25275.3817  19.7%  1700 1933s
 33809  8227 22087.6065   30  203 21121.0554 25128.0559  19.0%  1690 1971s
 35131  8263     cutoff   30      21121.0554 24978.2179  18.3%  1678 2011s
 36717  8344 22411.8338   28  318 21121.0554 24885.6115  17.8%  1658 2050s
 38095  8375 infeasible   33      21121.0554 24632.4760  16.6%  1647 2092s
 39643  8386     cutoff   32      21121.0554 24508.2245  16.0%  1633 2132s
 41188  8254 23636.2090   33  125 21121.0554 24372.2041  15.4%  1620 2174s
 42946  8099     cutoff   31      21121.0554 24171.8403  14.4%  1603 2216s
 45033  7849     cutoff   31      21121.0554 24001.5528  13.6%  1577 2261s
 47081  7572     cutoff   51      21121.0554 23844.0630  12.9%  1555 2308s
 49234  7184 21220.8979   35  227 21121.0554 23645.7864  12.0%  1531 2355s
 51623  6522     cutoff   44      21121.0554 23478.6790  11.2%  1504 2401s
 54188  5683 21642.7403   41  179 21121.0554 23168.7902  9.70%  1475 2447s
 56769  4630     cutoff   31      21121.0554 23113.0172  9.43%  1444 2492s
 59983  3078     cutoff   39      21121.0554 22905.6324  8.45%  1404 2533s
 63247  1247 21975.8091   45   66 21121.0554 22687.2250  7.42%  1362 2568s
 66582     0     cutoff   47      21121.0554 22242.9656  5.31%  1316 2583s

Cutting planes:
  MIR: 730
  Flow cover: 1964
  RLT: 31
  Relax-and-lift: 114

Explored 68396 nodes (88241437 simplex iterations) in 2583.54 seconds (8454.54 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 21121.1 21121.1 21053.3 ... 20185.3

Optimal solution found (tolerance 1.00e-06)
Best objective 2.112105543834e+04, best bound 2.112105543834e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2583.56s
  Master Objective (UB) = 21121.06, θ = 166828.09
  Upper Bound (UB) = 21121.06

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 166828.09
  [DEBUG]   ✓ Scenario 0: θ = 166828.09 ≤ Q = 183679.02 (slack: 16850.92)
  [DEBUG]   ✓ Scenario 1: θ = 166828.09 ≤ Q = 166828.09 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 166828.09 ≤ Q = 179983.19 (slack: 13155.09)
  [DEBUG]   ✓ Scenario 3: θ = 166828.09 ≤ Q = 180992.64 (slack: 14164.54)
  [DEBUG]   ✓ Scenario 4: θ = 166828.09 ≤ Q = 171212.31 (slack: 4384.22)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x19013999
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xe6fec667
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.338602e+13
Presolve removed 2581 rows and 1873 columns
Presolve time: 0.00s
Presolved: 512 rows, 516 columns, 1444 nonzeros
Found heuristic solution: objective 6760709.2747
Variable types: 350 continuous, 166 integer (166 binary)

Root relaxation: objective -1.486249e+05, 254 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -148624.86    0  125 6760709.27 -148624.86   102%     -    0s
H    0     0                    -111240.5194 -148624.86  33.6%     -    0s
H    0     0                    -112397.4703 -148624.86  32.2%     -    0s
H    0     0                    -112859.4028 -124111.82  10.0%     -    0s
H    0     0                    -120438.4196 -124111.82  3.05%     -    0s
     0     0 -124111.82    0   53 -120438.42 -124111.82  3.05%     -    0s
H    0     0                    -124035.7309 -124097.94  0.05%     -    0s
     0     0 -124094.20    0    2 -124035.73 -124094.20  0.05%     -    0s
     0     0 -124094.20    0    2 -124035.73 -124094.20  0.05%     -    0s
H    0     0                    -124043.4434 -124094.20  0.04%     -    0s
H    0     0                    -124047.9172 -124094.20  0.04%     -    0s
     0     0 -124094.20    0   36 -124047.92 -124094.20  0.04%     -    0s
     0     0 -124094.20    0   29 -124047.92 -124094.20  0.04%     -    0s
H    0     0                    -124074.5667 -124094.20  0.02%     -    0s
     0     0 -124093.37    0    2 -124074.57 -124093.37  0.02%     -    0s
H    0     0                    -124083.2962 -124093.37  0.01%     -    0s
     0     0 -124093.37    0    4 -124083.30 -124093.37  0.01%     -    0s
H    0     0                    -124093.1513 -124093.37  0.00%     -    0s
     0     0     cutoff    0      -124093.15 -124093.15  0.00%     -    0s

Cutting planes:
  Implied bound: 2
  MIR: 3
  RLT: 2

Explored 1 nodes (600 simplex iterations) in 0.06 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -124093 -124079 -124075 ... 6.76071e+06
No other solutions better than -124093

Optimal solution found (tolerance 1.00e-06)
Best objective -1.240931513164e+05, best bound -1.240931513164e+05, gap 0.0000%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 156055.23
  Scenario: 11 demand increases, 49 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -124093.15
  [DEBUG]   S×d_nominal = 280148.38
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 280148.38 + -124093.15 = 156055.23
  [DEBUG]   Current θ from Master = 166828.09
  [DEBUG]   ⚠️  Z_SP ≤ θ by 10772.87 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 10348.19
  Lower Bound (LB) = 19998.82
  Gap (UB-LB) = 1122.2352, Absolute Gap = 1122.2352, Relative Gap = 0.053133
  Not converged yet (gap = 1122.24 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 11 increases, 49 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 264959 nonzeros
Model fingerprint: 0x358985fd
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 40682 rows and 16522 columns
Presolve time: 0.82s
Presolved: 52441 rows, 23178 columns, 325769 nonzeros
Variable types: 20919 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -361254.7791
Found heuristic solution: objective -211287.5740

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 52441 rows, 23178 columns, 325769 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   31533    5.7367306e+03   0.000000e+00   1.132446e+07      5s
   44620    2.8513471e+04   0.000000e+00   1.346937e+07     10s
   57019    3.8877636e+04   0.000000e+00   9.171878e+05     15s
   67174    4.1800913e+04   0.000000e+00   2.272297e+06     20s
Concurrent spin time: 0.01s

Solved with dual simplex

Root relaxation: objective 4.894193e+04, 42030 iterations, 20.49 seconds (41.50 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 48941.9294    0  170 -211287.57 48941.9294   123%     -   21s
H    0     0                    -198404.8273 48941.9294   125%     -   21s
H    0     0                    -121665.7042 48941.9294   140%     -   21s
H    0     0                    -121315.8661 48941.9294   140%     -   21s
H    0     0                    -53399.49381 48941.9294   192%     -   21s
H    0     0                    -851.0663227 48941.9294  5851%     -   21s
H    0     0                    2963.9846128 48941.9294  1551%     -   22s
H    0     0                    10782.901370 48941.9294   354%     -   22s
H    0     0                    11009.690363 48941.9294   345%     -   22s
H    0     0                    11487.859780 48941.9294   326%     -   22s
H    0     0                    11631.037382 48940.4929   321%     -   23s
H    0     0                    11724.519801 44625.2441   281%     -   29s
     0     0 44625.2441    0  279 11724.5198 44625.2441   281%     -   29s
     0     0 43414.6812    0  255 11724.5198 43414.6812   270%     -   32s
     0     0 43414.6812    0  263 11724.5198 43414.6812   270%     -   35s
     0     0 43414.6812    0  296 11724.5198 43414.6812   270%     -   35s
     0     0 43414.6812    0  290 11724.5198 43414.6812   270%     -   36s
     0     0 43414.6812    0  291 11724.5198 43414.6812   270%     -   37s
     0     0 43414.6812    0  288 11724.5198 43414.6812   270%     -   37s
     0     0 43414.6812    0  288 11724.5198 43414.6812   270%     -   37s
H    0     0                    11736.905404 40750.1694   247%     -   45s
     0     0 40678.6698    0  361 11736.9054 40678.6698   247%     -   45s
H    0     0                    17534.877914 40678.6698   132%     -   45s
     0     0 40359.5418    0  361 17534.8779 40359.5418   130%     -   48s
     0     0 40195.4691    0  357 17534.8779 40195.4691   129%     -   51s
     0     0 40154.8240    0  366 17534.8779 40154.8240   129%     -   53s
     0     0 40098.2571    0  373 17534.8779 40098.2571   129%     -   55s
     0     0 40082.8174    0  371 17534.8779 40082.8174   129%     -   56s
     0     0 40076.8579    0  379 17534.8779 40076.8579   129%     -   57s
     0     0 40076.3375    0  376 17534.8779 40076.3375   129%     -   57s
H    0     0                    17641.844349 38324.0390   117%     -   68s
     0     0 38324.0390    0  365 17641.8443 38324.0390   117%     -   68s
     0     0 38028.6676    0  402 17641.8443 38028.6676   116%     -   72s
     0     0 37937.5011    0  381 17641.8443 37937.5011   115%     -   74s
H    0     0                    17761.355235 37913.3534   113%     -   75s
     0     0 37913.3534    0  376 17761.3552 37913.3534   113%     -   75s
     0     0 37861.4459    0  452 17761.3552 37861.4459   113%     -   77s
     0     0 37846.9682    0  461 17761.3552 37846.9682   113%     -   77s
     0     0 37842.3444    0  426 17761.3552 37842.3444   113%     -   78s
     0     0 37836.5746    0  426 17761.3552 37836.5746   113%     -   79s
     0     0 37834.0861    0  427 17761.3552 37834.0861   113%     -   79s
     0     0 37833.0784    0  431 17761.3552 37833.0784   113%     -   79s
     0     0 37440.5257    0  397 17761.3552 37440.5257   111%     -   87s
     0     0 37165.6300    0  384 17761.3552 37165.6300   109%     -   90s
     0     0 37088.9485    0  392 17761.3552 37088.9485   109%     -   92s
     0     0 37058.3280    0  394 17761.3552 37058.3280   109%     -   94s
     0     0 37019.6959    0  387 17761.3552 37019.6959   108%     -   95s
     0     0 36952.2824    0  389 17761.3552 36952.2824   108%     -   96s
     0     0 36944.9205    0  389 17761.3552 36944.9205   108%     -   97s
     0     0 36936.7475    0  396 17761.3552 36936.7475   108%     -   97s
     0     0 36930.2564    0  400 17761.3552 36930.2564   108%     -   98s
     0     0 36922.2248    0  405 17761.3552 36922.2248   108%     -   99s
     0     0 36921.1264    0  406 17761.3552 36921.1264   108%     -   99s
     0     0 36828.4979    0  449 17761.3552 36828.4979   107%     -  102s
     0     0 36807.5071    0  411 17761.3552 36807.5071   107%     -  103s
     0     0 36792.6123    0  408 17761.3552 36792.6123   107%     -  104s
     0     0 36787.6173    0  464 17761.3552 36787.6173   107%     -  104s
     0     0 36783.6460    0  467 17761.3552 36783.6460   107%     -  105s
     0     0 36782.7676    0  417 17761.3552 36782.7676   107%     -  105s
     0     0 36709.2838    0  416 17761.3552 36709.2838   107%     -  107s
     0     0 36694.2228    0  419 17761.3552 36694.2228   107%     -  109s
     0     0 36681.7443    0  425 17761.3552 36681.7443   107%     -  110s
     0     0 36673.9011    0  426 17761.3552 36673.9011   106%     -  110s
     0     0 36672.8225    0  424 17761.3552 36672.8225   106%     -  110s
     0     0 36647.3646    0  428 17761.3552 36647.3646   106%     -  112s
     0     0 36639.3079    0  428 17761.3552 36639.3079   106%     -  113s
     0     0 36635.2258    0  434 17761.3552 36635.2258   106%     -  113s
     0     0 36633.6312    0  435 17761.3552 36633.6312   106%     -  114s
     0     0 36632.1949    0  438 17761.3552 36632.1949   106%     -  114s
     0     0 36611.3749    0  424 17761.3552 36611.3749   106%     -  115s
     0     0 36608.7473    0  425 17761.3552 36608.7473   106%     -  117s
     0     0 36603.2895    0  427 17761.3552 36603.2895   106%     -  117s
     0     0 36602.0197    0  428 17761.3552 36602.0197   106%     -  117s
     0     0 36596.0751    0  432 17761.3552 36596.0751   106%     -  118s
     0     0 36586.1957    0  432 17761.3552 36586.1957   106%     -  119s
     0     0 36584.1638    0  438 17761.3552 36584.1638   106%     -  119s
     0     0 36584.0442    0  436 17761.3552 36584.0442   106%     -  119s
     0     0 36581.6408    0  435 17761.3552 36581.6408   106%     -  120s
     0     0 36576.4661    0  439 17761.3552 36576.4661   106%     -  121s
     0     0 36574.6803    0  434 17761.3552 36574.6803   106%     -  121s
     0     0 36574.1168    0  437 17761.3552 36574.1168   106%     -  122s
     0     0 36571.3655    0  437 17761.3552 36571.3655   106%     -  122s
     0     0 36569.4397    0  437 17761.3552 36569.4397   106%     -  123s
     0     0 36565.0110    0  436 17761.3552 36565.0110   106%     -  124s
     0     0 36564.7528    0  436 17761.3552 36564.7528   106%     -  125s
H    0     0                    20301.713527 36564.7249  80.1%     -  142s
H    0     0                    20543.775124 36564.7249  78.0%     -  144s
H    0     0                    20583.535748 36564.7249  77.6%     -  144s
H    0     0                    20602.997541 36564.7249  77.5%     -  144s
H    0     0                    20694.024868 36564.7249  76.7%     -  144s
     0     2 36564.7249    0  436 20694.0249 36564.7249  76.7%     -  147s
     1     4 36382.6866    1  415 20694.0249 36563.6743  76.7%  5713  151s
     3     8 36194.1962    2  422 20694.0249 36382.5179  75.8%  4551  157s
     7    16 35815.5117    3  427 20694.0249 36282.9880  75.3%  6459  163s
    15    32 35489.0972    4  427 20694.0249 35898.6738  73.5%  6478  171s
    31    51 32414.9280    5  323 20694.0249 35488.9843  71.5%  9431  187s
    50    83 32713.3955    6  329 20694.0249 35488.9843  71.5%  8626  196s
H   82   115                    20722.697972 35488.9843  71.3%  7129  203s
H   86   115                    20727.778097 35488.9843  71.2%  6919  203s
H   90   115                    20766.936909 35488.9843  70.9%  6724  203s
   114   147 32613.9410    8  305 20766.9369 35488.9843  70.9%  5772  211s
   146   179 32319.6150    9  310 20766.9369 35488.9843  70.9%  5201  218s
   178   256 32564.5815    9  314 20766.9369 35488.9843  70.9%  4961  229s
   257   349 32535.3098   10  311 20766.9369 35488.9843  70.9%  4146  239s
   356   448 31672.2947   13  329 20766.9369 35488.9843  70.9%  3649  248s
   473   485 26228.2992   13  140 20766.9369 35488.9843  70.9%  3170  256s
   542   539 26133.8661   13  141 20766.9369 35488.9843  70.9%  2982  264s
   630   595 27567.8044   12  179 20766.9369 35488.9843  70.9%  2870  270s
   719   639 31437.4563   14  298 20766.9369 35488.9843  70.9%  2762  278s
   803   697 31034.9778   15  280 20766.9369 35341.7074  70.2%  2666  285s
   878   758 30723.3785   17  334 20766.9369 35341.7074  70.2%  2659  293s
   950   830 28455.9449   18  274 20766.9369 35341.7074  70.2%  2642  300s
  1042   896 30155.6998   18  214 20766.9369 35341.7074  70.2%  2590  309s
  1146   973 25868.9736   17  166 20766.9369 35341.7074  70.2%  2517  317s
  1239  1088 28871.9590   22  233 20766.9369 35341.7074  70.2%  2481  325s
  1364  1186 28830.0649   23  289 20766.9369 35341.7074  70.2%  2384  333s
  1506  1288 28568.2438   24  284 20766.9369 35341.7074  70.2%  2301  342s
  1644  1371 27964.5316   23  283 20766.9369 35341.7074  70.2%  2238  351s
  1791  1520 27506.6972   25  302 20766.9369 34468.4261  66.0%  2182  359s
  1960  1655 26831.8787   25  310 20766.9369 34278.7608  65.1%  2104  368s
  2150  1818 27430.4921   26  317 20766.9369 34278.7608  65.1%  2019  374s
  2358  1942 26305.0150   32  302 20766.9369 34278.7608  65.1%  1930  384s
  2540  2122 24950.1704   33  300 20766.9369 33963.4835  63.5%  1899  392s
  2732  2257 25392.8024   47  183 20766.9369 33963.4835  63.5%  1857  402s
  2905  2358 25260.4937   48  135 20766.9369 33963.4835  63.5%  1839  411s
  3058  2462 23636.9093   49  203 20766.9369 33963.4835  63.5%  1845  421s
  3204  2582 20947.6384   51  166 20766.9369 33963.4835  63.5%  1852  432s
  3397  2654 29412.9826   12  373 20766.9369 33610.3883  61.8%  1838  444s
  3565  2734 26884.8976   13  341 20766.9369 33554.6147  61.6%  1843  456s
  3739  2815 28315.8990   13  423 20766.9369 33554.6147  61.6%  1857  468s
  3890  2909 28044.2213   14  385 20766.9369 33516.6244  61.4%  1882  479s
  4045  2910 23767.4400   21  436 20766.9369 33516.6244  61.4%  1904  510s
  4047  2911 31365.7351   10  170 20766.9369 33516.6244  61.4%  1903  526s
  4048  2912 24357.2945   37  366 20766.9369 33516.6244  61.4%  1903  540s
  4049  2913 24650.1398   24  382 20766.9369 33516.6244  61.4%  1902  550s
  4050  2913 25054.1883   40  390 20766.9369 33516.6244  61.4%  1902  557s
  4051  2914 25512.8165    9  396 20766.9369 33516.6244  61.4%  1901  560s
  4053  2915 25881.8779   15  425 20766.9369 33516.6244  61.4%  1900  568s
  4054  2916 24802.7819   39  431 20766.9369 33516.6244  61.4%  1900  570s
  4057  2918 22467.5767   48  427 20766.9369 33516.6244  61.4%  1898  575s
  4059  2919 28036.9308   12  479 20766.9369 33516.6244  61.4%  1897  580s
  4062  2921 24513.0788   53  418 20766.9369 33516.6244  61.4%  1896  587s
  4064  2923 25881.9250   11  480 20766.9369 33516.6244  61.4%  1895  591s
  4065  2923 27242.8380   59  435 20766.9369 33516.6244  61.4%  1895  596s
  4067  2925 29373.1933   23  479 20766.9369 33516.6244  61.4%  1894  601s
  4069  2926 26760.1044   16  489 20766.9369 33516.6244  61.4%  1893  607s
  4071  2927 28143.0956   17  431 20766.9369 33516.6244  61.4%  1892  611s
  4073  2929 23537.4682   22  430 20766.9369 33516.6244  61.4%  1891  615s
  4074  2929 24076.9752   69  430 20766.9369 33516.6244  61.4%  1890  631s
  4075  2930 23309.6656   56  430 20766.9369 33516.6244  61.4%  1890  642s
  4076  2934 33516.6244   15  415 20766.9369 33516.6244  61.4%  1926  653s
  4078  2937 33516.6244   16  404 20766.9369 33516.6244  61.4%  1928  662s
  4082  2944 33516.6244   17  422 20766.9369 33516.6244  61.4%  1931  679s
  4090  2957 33516.6244   18  413 20766.9369 33516.6244  61.4%  1948  690s
  4106  2968 33516.6244   19  430 20766.9369 33516.6244  61.4%  1974  705s
  4122  2994 32471.3239   20  404 20766.9369 33516.6244  61.4%  2027  721s
  4154  3020 32095.6357   21  347 20766.9369 33516.6244  61.4%  2042  737s
  4194  3035 30338.2924   22  467 20766.9369 33516.6244  61.4%  2108  752s
  4227  3069 29793.3567   22  306 20766.9369 33516.6244  61.4%  2147  765s
  4278  3104 28938.3116   24  356 20766.9369 33516.6244  61.4%  2159  778s
H 4299  2950                    20921.400339 33516.6244  60.2%  2162  778s
  4338  3030 28903.5415   25  322 20921.4003 33516.6244  60.2%  2166  792s
  4473  3047 27336.2293   26  316 20921.4003 33516.6244  60.2%  2168  801s
  4586  3052 27825.9135   29  169 20921.4003 33516.6244  60.2%  2164  811s
  4672  3069 26739.3823   30  259 20921.4003 33516.6244  60.2%  2162  820s
  4757  3085 26347.7734   31  231 20921.4003 33516.6244  60.2%  2159  831s
  4840  3101     cutoff   34      20921.4003 33516.6244  60.2%  2157  839s
  4928  3097 23821.5195   35  279 20921.4003 33516.6244  60.2%  2154  852s
  5023  3108 24834.2264   36  203 20921.4003 33516.6244  60.2%  2147  862s
  5105  3128 infeasible   40      20921.4003 33516.6244  60.2%  2146  871s
  5188  3160 23901.5481   44  204 20921.4003 33516.6244  60.2%  2145  879s
  5284  3167     cutoff   46      20921.4003 33516.6244  60.2%  2139  889s
  5395  3154     cutoff   52      20921.4003 33516.6244  60.2%  2129  895s
  5442  3159 29194.6214   22  299 20921.4003 33516.6244  60.2%  2131  901s
  5490  3174 28886.3640   23  288 20921.4003 33516.6244  60.2%  2127  910s
  5552  3178 infeasible   25      20921.4003 33516.6244  60.2%  2128  920s
  5647  3185 25840.1131   29  114 20921.4003 33516.6244  60.2%  2123  934s
  5738  3195 22253.7499   31  120 20921.4003 33418.5862  59.7%  2123  944s
  5859  3203 21310.4042   33  121 20921.4003 33418.5862  59.7%  2120  956s
  5984  3219 29636.6477   22  310 20921.4003 33418.5862  59.7%  2117  967s
  6070  3269 28838.0307   24  294 20921.4003 33245.1587  58.9%  2128  978s
  6181  3289 26750.9946   28  330 20921.4003 32141.9536  53.6%  2142  990s
  6305  3312 26052.1977   31  316 20921.4003 32141.9536  53.6%  2149 1003s
  6427  3347 24707.4088   36  174 20921.4003 32141.9536  53.6%  2160 1016s
  6579  3358 22316.0610   43  139 20921.4003 32141.9536  53.6%  2159 1029s
  6767  3376 27786.5488   23  447 20921.4003 32141.9536  53.6%  2154 1042s
  6922  3358 26700.3407   26  328 20921.4003 31418.8675  50.2%  2156 1058s
  7065  3391 24368.7794   29  330 20921.4003 31418.8675  50.2%  2169 1071s
  7222  3410 24350.4722   30  325 20921.4003 31418.8675  50.2%  2172 1086s
  7389  3441 21008.1077   35  300 20921.4003 30741.1526  46.9%  2179 1103s
  7553  3437 21581.2929   36  280 20921.4003 30719.4447  46.8%  2188 1118s
H 7563  3292                    20978.611843 30719.4447  46.4%  2188 1118s
  7702  3325 28460.6589   28  452 20978.6118 30187.9389  43.9%  2193 1133s
  7892  3360 25906.3535   31  280 20978.6118 30187.9389  43.9%  2204 1150s
  8121  3408 23218.4205   34  324 20978.6118 30029.2550  43.1%  2200 1168s
  8435  3436 21486.4227   41  129 20978.6118 29845.8689  42.3%  2186 1185s
  8719  3403 22568.6551   24  441 20978.6118 29845.8689  42.3%  2181 1201s
H 8762  3256                    20981.926987 29845.8689  42.2%  2177 1201s
  8816  3339 22225.6114   25  434 20981.9270 29784.7319  42.0%  2180 1222s
  9122  3342 25944.3912   25  250 20981.9270 29549.6769  40.8%  2179 1242s
  9402  3270 21959.9372   31  388 20981.9270 29549.6769  40.8%  2184 1255s
  9443  3280 21847.0086   32  181 20981.9270 29456.6684  40.4%  2186 1268s
  9513  3300 24657.2365   28  190 20981.9270 29456.6684  40.4%  2185 1288s
  9745  3315 21716.2520   33  185 20981.9270 29456.6684  40.4%  2172 1307s
 10062  3371 25939.6645   27  272 20981.9270 29033.7210  38.4%  2165 1327s
 10464  3351 21104.1818   38   96 20981.9270 29007.6234  38.3%  2153 1351s
 10828  3403 24581.9698   29  268 20981.9270 28884.9585  37.7%  2155 1374s
 11185  3406 22659.0723   37   83 20981.9270 28717.6393  36.9%  2162 1397s
 11605  3425     cutoff   27      20981.9270 28480.0999  35.7%  2161 1421s
 11976  3550     cutoff   27      20981.9270 28355.7726  35.1%  2168 1457s
 12453  3729     cutoff   28      20981.9270 28222.4523  34.5%  2160 1483s
 12869  3872     cutoff   33      20981.9270 27953.2114  33.2%  2164 1509s
 13352  3954 25614.5955   31  160 20981.9270 27672.7003  31.9%  2163 1536s
 13825  4084 21377.1803   24  374 20981.9270 27672.1961  31.9%  2168 1567s
 14323  4250     cutoff   28      20981.9270 27534.1219  31.2%  2168 1598s
 14887  4358     cutoff   35      20981.9270 27251.7350  29.9%  2163 1638s
 15473  4467     cutoff   28      20981.9270 27233.0116  29.8%  2162 1669s
 16128  4493 23203.2640   32  285 20981.9270 27124.2702  29.3%  2152 1705s
 16817  4554 21369.8699   41  233 20981.9270 27017.2442  28.8%  2141 1739s
 17469  4689 23885.5287   43   91 20981.9270 26885.0445  28.1%  2139 1783s
 18134  4767 22458.2337   32  209 20981.9270 26746.9700  27.5%  2137 1818s
 18804  4844 infeasible   43      20981.9270 26583.3473  26.7%  2136 1855s
 19526  4942 24329.4034   35  125 20981.9270 26507.5917  26.3%  2134 1897s
 20303  5099     cutoff   24      20981.9270 26257.2837  25.1%  2130 1941s
 21170  5193 21802.0059   35  157 20981.9270 26200.5246  24.9%  2118 1981s
 22060  5232     cutoff   34      20981.9270 26000.5408  23.9%  2108 2025s
 22910  5245 infeasible   41      20981.9270 25850.9802  23.2%  2106 2057s
 22999  5301 23277.2338   29  348 20981.9270 25802.9283  23.0%  2108 2100s
 23762  5303 infeasible   31      20981.9270 25659.1310  22.3%  2099 2144s
 24714  5307 22189.5972   31  106 20981.9270 25499.9232  21.5%  2094 2192s
 25827  5293 21092.4774   30  239 20981.9270 25323.0407  20.7%  2081 2242s
 27029  5269 23292.3124   31  206 20981.9270 25081.8360  19.5%  2064 2291s
 28269  5116     cutoff   37      20981.9270 24911.7545  18.7%  2045 2345s
 29643  4872 infeasible   28      20981.9270 24628.9154  17.4%  2023 2394s
 31006  4568 21542.0622   36  189 20981.9270 24390.1406  16.2%  2004 2445s
 32530  4039 21839.7460   27  258 20981.9270 24179.1609  15.2%  1979 2497s
 34210  3419 22298.9838   44  160 20981.9270 23936.0854  14.1%  1948 2549s
 36043  2491     cutoff   37      20981.9270 23488.3698  11.9%  1914 2598s
 38201  1082     cutoff   38      20981.9270 23107.6078  10.1%  1867 2644s
 40957     0     cutoff   33      20981.9270 22356.6537  6.55%  1795 2665s

Cutting planes:
  Learned: 4
  MIR: 654
  Flow cover: 1690
  RLT: 16
  Relax-and-lift: 89

Explored 42897 nodes (74546168 simplex iterations) in 2665.61 seconds (8590.22 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 20981.9 20981.9 20978.6 ... 20583.5

Optimal solution found (tolerance 1.00e-06)
Best objective 2.098192698715e+04, best bound 2.098192698715e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2665.62s
  Master Objective (UB) = 20981.93, θ = 166757.89
  Upper Bound (UB) = 20981.93

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 166757.89
  [DEBUG]   ✓ Scenario 0: θ = 166757.89 ≤ Q = 181970.06 (slack: 15212.17)
  [DEBUG]   ✓ Scenario 1: θ = 166757.89 ≤ Q = 166757.89 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 166757.89 ≤ Q = 183267.19 (slack: 16509.30)
  [DEBUG]   ✓ Scenario 3: θ = 166757.89 ≤ Q = 180052.20 (slack: 13294.31)
  [DEBUG]   ✓ Scenario 4: θ = 166757.89 ≤ Q = 170149.52 (slack: 3391.63)
  [DEBUG]   ✓ Scenario 5: θ = 166757.89 ≤ Q = 167103.72 (slack: 345.83)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x7ebbd372
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x7ebbd372
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.337193e+13
Presolve removed 2581 rows and 1873 columns
Presolve time: 0.00s
Presolved: 512 rows, 516 columns, 1444 nonzeros
Found heuristic solution: objective 6776439.3726
Variable types: 350 continuous, 166 integer (166 binary)

Root relaxation: objective -1.455246e+05, 249 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -145524.63    0  123 6776439.37 -145524.63   102%     -    0s
H    0     0                    -109969.2541 -145524.63  32.3%     -    0s
H    0     0                    -111227.0241 -145524.63  30.8%     -    0s
     0     0 -126496.01    0   52 -111227.02 -126496.01  13.7%     -    0s
H    0     0                    -125199.1807 -126413.53  0.97%     -    0s
     0     0 -126025.77    0   34 -125199.18 -126025.77  0.66%     -    0s
     0     0 -126019.18    0   44 -125199.18 -126019.18  0.65%     -    0s
H    0     0                    -125306.3265 -125983.75  0.54%     -    0s
H    0     0                    -125634.0131 -125983.75  0.28%     -    0s
     0     0 -125979.59    0   30 -125634.01 -125979.59  0.28%     -    0s
     0     0 -125947.81    0   19 -125634.01 -125947.81  0.25%     -    0s
     0     0 -125941.58    0   18 -125634.01 -125941.58  0.24%     -    0s
     0     0 -125888.07    0   25 -125634.01 -125888.07  0.20%     -    0s
     0     0 -125880.82    0   22 -125634.01 -125880.82  0.20%     -    0s
     0     0 -125880.34    0   22 -125634.01 -125880.34  0.20%     -    0s
     0     0 -125771.64    0    9 -125634.01 -125771.64  0.11%     -    0s
     0     0 -125771.64    0   16 -125634.01 -125771.64  0.11%     -    0s
     0     0 -125705.47    0    3 -125634.01 -125705.47  0.06%     -    0s
H    0     0                    -125689.6495 -125703.41  0.01%     -    0s
     0     0 -125703.40    0    2 -125689.65 -125703.40  0.01%     -    0s
H    0     0                    -125695.4150 -125703.40  0.01%     -    0s
*    0     0               0    -125702.8958 -125702.90  0.00%     -    0s

Explored 1 nodes (672 simplex iterations) in 0.07 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -125703 -125695 -125690 ... 6.77644e+06
No other solutions better than -125703

Optimal solution found (tolerance 1.00e-06)
Best objective -1.257028958277e+05, best bound -1.257028958277e+05, gap 0.0000%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 154445.48
  Scenario: 23 demand increases, 37 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -125702.90
  [DEBUG]   S×d_nominal = 280148.38
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 280148.38 + -125702.90 = 154445.48
  [DEBUG]   Current θ from Master = 166757.89
  [DEBUG]   ⚠️  Z_SP ≤ θ by 12312.41 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 8669.52
  Lower Bound (LB) = 19998.82
  Gap (UB-LB) = 983.1068, Absolute Gap = 983.1068, Relative Gap = 0.046855
  Not converged yet (gap = 983.11 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 23 increases, 37 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308199 nonzeros
Model fingerprint: 0xe0a16314
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 47449 rows and 19269 columns
Presolve time: 0.97s
Presolved: 60964 rows, 26671 columns, 379184 nonzeros
Variable types: 24412 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -361254.7791
Found heuristic solution: objective -211287.5740

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 60964 rows, 26671 columns, 379184 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   36574    2.5490132e+03   0.000000e+00   1.071436e+08      5s
   50297    2.9293930e+04   0.000000e+00   1.362872e+06     10s
   61584    3.8690927e+04   0.000000e+00   5.811162e+05     15s
   70997    4.2870306e+04   0.000000e+00   1.433556e+07     20s
   81284    4.6611404e+04   0.000000e+00   2.543818e+06     25s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 4.894193e+04, 47471 iterations, 24.31 seconds (50.26 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 48941.9294    0  170 -211287.57 48941.9294   123%     -   25s
H    0     0                    -199094.0791 48941.9294   125%     -   25s
H    0     0                    -49497.18341 48941.9294   199%     -   25s
H    0     0                    -48907.33142 48941.9294   200%     -   25s
H    0     0                    -41968.28115 48941.9294   217%     -   25s
H    0     0                    16363.829639 48941.9294   199%     -   26s
H    0     0                    16767.236160 48941.9294   192%     -   26s
H    0     0                    17147.859099 48941.9294   185%     -   26s
H    0     0                    17853.258164 48941.9294   174%     -   26s
     0     0 44083.1186    0  283 17853.2582 44083.1186   147%     -   34s
     0     0 43431.6433    0  287 17853.2582 43431.6433   143%     -   39s
     0     0 43431.6433    0  282 17853.2582 43431.6433   143%     -   40s
     0     0 43033.4209    0  289 17853.2582 43033.4209   141%     -   41s
     0     0 43016.1292    0  292 17853.2582 43016.1292   141%     -   45s
     0     0 43016.1292    0  293 17853.2582 43016.1292   141%     -   47s
     0     0 43016.1292    0  293 17853.2582 43016.1292   141%     -   47s
H    0     0                    17865.643767 40451.6644   126%     -   61s
     0     0 40451.6644    0  342 17865.6438 40451.6644   126%     -   61s
     0     0 39890.4238    0  365 17865.6438 39890.4238   123%     -   67s
     0     0 39800.2636    0  368 17865.6438 39800.2636   123%     -   70s
     0     0 39758.9108    0  368 17865.6438 39758.9108   123%     -   71s
     0     0 39737.6501    0  370 17865.6438 39737.6501   122%     -   73s
     0     0 39728.6550    0  367 17865.6438 39728.6550   122%     -   74s
     0     0 39721.1943    0  371 17865.6438 39721.1943   122%     -   74s
     0     0 39719.4371    0  369 17865.6438 39719.4371   122%     -   75s
     0     0 39716.4910    0  367 17865.6438 39716.4910   122%     -   75s
     0     0 39705.1864    0  366 17865.6438 39705.1864   122%     -   76s
     0     0 39704.8098    0  369 17865.6438 39704.8098   122%     -   77s
     0     0 38389.1641    0  376 17865.6438 38389.1641   115%     -   94s
     0     0 38129.0525    0  425 17865.6438 38129.0525   113%     -  100s
     0     0 38039.8423    0  428 17865.6438 38039.8423   113%     -  102s
     0     0 38011.5216    0  373 17865.6438 38011.5216   113%     -  105s
     0     0 37990.6281    0  382 17865.6438 37990.6281   113%     -  107s
     0     0 37978.6424    0  424 17865.6438 37978.6424   113%     -  108s
     0     0 37969.0709    0  385 17865.6438 37969.0709   113%     -  108s
     0     0 37966.1201    0  384 17865.6438 37966.1201   113%     -  109s
     0     0 37954.4133    0  383 17865.6438 37954.4133   112%     -  109s
     0     0 37948.8567    0  385 17865.6438 37948.8567   112%     -  110s
     0     0 37948.7146    0  386 17865.6438 37948.7146   112%     -  110s
     0     0 37428.4696    0  378 17865.6438 37428.4696   109%     -  118s
H    0     0                    17985.154653 37278.0981   107%     -  123s
     0     0 37278.0981    0  385 17985.1547 37278.0981   107%     -  123s
     0     0 37201.6277    0  391 17985.1547 37201.6277   107%     -  126s
     0     0 37190.8911    0  392 17985.1547 37190.8911   107%     -  127s
     0     0 37173.3639    0  398 17985.1547 37173.3639   107%     -  129s
     0     0 37163.5009    0  399 17985.1547 37163.5009   107%     -  130s
     0     0 37161.6858    0  401 17985.1547 37161.6858   107%     -  130s
     0     0 37159.0466    0  406 17985.1547 37159.0466   107%     -  130s
     0     0 37157.8268    0  404 17985.1547 37157.8268   107%     -  131s
     0     0 37020.0563    0  447 17985.1547 37020.0563   106%     -  135s
     0     0 36980.4618    0  406 17985.1547 36980.4618   106%     -  138s
     0     0 36970.0592    0  412 17985.1547 36970.0592   106%     -  139s
     0     0 36964.6098    0  419 17985.1547 36964.6098   106%     -  141s
     0     0 36961.6766    0  412 17985.1547 36961.6766   106%     -  141s
     0     0 36961.4933    0  411 17985.1547 36961.4933   106%     -  141s
     0     0 36923.5347    0  403 17985.1547 36923.5347   105%     -  144s
     0     0 36911.5606    0  408 17985.1547 36911.5606   105%     -  146s
     0     0 36909.2052    0  407 17985.1547 36909.2052   105%     -  146s
     0     0 36908.0623    0  409 17985.1547 36908.0623   105%     -  147s
     0     0 36876.7308    0  413 17985.1547 36876.7308   105%     -  150s
     0     0 36808.6909    0  466 17985.1547 36808.6909   105%     -  153s
     0     0 36795.1385    0  424 17985.1547 36795.1385   105%     -  153s
     0     0 36791.1595    0  420 17985.1547 36791.1595   105%     -  154s
     0     0 36789.4011    0  416 17985.1547 36789.4011   105%     -  154s
     0     0 36788.6550    0  418 17985.1547 36788.6550   105%     -  155s
     0     0 36765.5096    0  468 17985.1547 36765.5096   104%     -  157s
     0     0 36758.7872    0  464 17985.1547 36758.7872   104%     -  159s
     0     0 36749.0370    0  464 17985.1547 36749.0370   104%     -  160s
     0     0 36747.3828    0  463 17985.1547 36747.3828   104%     -  160s
     0     0 36746.5117    0  468 17985.1547 36746.5117   104%     -  161s
     0     0 36694.7874    0  437 17985.1547 36694.7874   104%     -  163s
     0     0 36682.0893    0  432 17985.1547 36682.0893   104%     -  165s
     0     0 36674.7457    0  437 17985.1547 36674.7457   104%     -  165s
     0     0 36674.0326    0  440 17985.1547 36674.0326   104%     -  165s
     0     0 36666.2136    0  437 17985.1547 36666.2136   104%     -  167s
     0     0 36662.6837    0  437 17985.1547 36662.6837   104%     -  167s
     0     0 36662.6837    0  437 17985.1547 36662.6837   104%     -  167s
     0     0 36659.6349    0  438 17985.1547 36659.6349   104%     -  168s
     0     0 36657.5632    0  444 17985.1547 36657.5632   104%     -  169s
     0     0 36655.5478    0  445 17985.1547 36655.5478   104%     -  169s
     0     0 36654.4928    0  445 17985.1547 36654.4928   104%     -  169s
     0     0 36646.5442    0  440 17985.1547 36646.5442   104%     -  171s
     0     0 36637.6917    0  438 17985.1547 36637.6917   104%     -  173s
     0     0 36637.4537    0  440 17985.1547 36637.4537   104%     -  173s
     0     0 36630.7568    0  438 17985.1547 36630.7568   104%     -  175s
     0     0 36627.4956    0  438 17985.1547 36627.4956   104%     -  175s
     0     0 36627.0522    0  441 17985.1547 36627.0522   104%     -  176s
     0     0 36623.5054    0  448 17985.1547 36623.5054   104%     -  177s
H    0     0                    18534.771308 36623.3999  97.6%     -  184s
H    0     0                    19598.505070 36623.3999  86.9%     -  184s
H    0     0                    19612.180418 36623.3999  86.7%     -  184s
H    0     0                    19629.596501 36623.3999  86.6%     -  184s
H    0     0                    19669.182348 36623.3999  86.2%     -  184s
H    0     0                    19762.613591 36623.3999  85.3%     -  184s
H    0     0                    19984.310360 36623.3999  83.3%     -  184s
H    0     0                    20550.665020 36623.3999  78.2%     -  184s
H    0     0                    20568.081103 36623.3999  78.1%     -  185s
     0     0 36622.8767    0  444 20568.0811 36622.8767  78.1%     -  185s
     0     0 36618.9181    0  445 20568.0811 36618.9181  78.0%     -  186s
     0     0 36616.7905    0  442 20568.0811 36616.7905  78.0%     -  187s
     0     0 36615.7304    0  452 20568.0811 36615.7304  78.0%     -  187s
     0     0 36611.3251    0  454 20568.0811 36611.3251  78.0%     -  188s
     0     0 36610.9372    0  454 20568.0811 36610.9372  78.0%     -  189s
H    0     0                    20694.024868 36609.2663  76.9%     -  216s
H    0     2                    20766.936909 36609.2663  76.3%     -  229s
     0     2 36609.2663    0  454 20766.9369 36609.2663  76.3%     -  229s
     1     4 36602.8747    1  449 20766.9369 36609.2663  76.3%  1004  231s
     3     8 36518.9574    2  420 20766.9369 36602.8056  76.3%  2265  235s
     7    15 36225.1504    3  423 20766.9369 36537.0256  75.9%  4187  243s
    14    30 35930.8127    4  425 20766.9369 36224.9868  74.4%  6662  252s
    29    46 26551.7293    5  217 20766.9369 35930.5384  73.0% 10359  270s
    45    78 33300.0340    6  316 20766.9369 35930.2662  73.0%  9767  280s
    77   139 33195.4551    7  313 20766.9369 35930.2662  73.0%  7246  291s
   138   209 32704.6582   12  286 20766.9369 35930.2662  73.0%  5048  301s
   214   256 30025.0137   16  259 20766.9369 35930.2662  73.0%  4405  312s
   281   303 28653.6010   18  330 20766.9369 35930.2662  73.0%  4242  322s
   350   352 27594.8772   21  335 20766.9369 35930.2662  73.0%  4260  334s
   421   414 26945.5380   25  336 20766.9369 35930.2662  73.0%  4115  342s
   511   485 22075.2988   28  162 20766.9369 35930.2662  73.0%  3799  351s
   605   544 21608.4858   33  197 20766.9369 35874.4613  72.7%  3541  361s
   702   613     cutoff   37      20766.9369 35874.4613  72.7%  3304  370s
   791   676 26431.4609   15  261 20766.9369 35874.4613  72.7%  3144  378s
   872   744 25763.1026   17  250 20766.9369 35874.4613  72.7%  3022  386s
   957   782 25265.6042   18  265 20766.9369 35874.4613  72.7%  2910  394s
  1039   811 22143.4617   20  163 20766.9369 35874.4613  72.7%  2846  403s
  1106   862 21703.1359   23  150 20766.9369 35874.4613  72.7%  2791  412s
  1173   912     cutoff   25      20766.9369 35874.4613  72.7%  2767  420s
  1257   957 infeasible   24      20766.9369 35874.4613  72.7%  2748  429s
  1334   986     cutoff   21      20766.9369 35683.6461  71.8%  2728  437s
  1379  1053 33859.9808    6  385 20766.9369 35683.6461  71.8%  2740  447s
  1472  1126 33314.4028    7  367 20766.9369 35483.0709  70.9%  2691  456s
  1575  1195 31806.3747    9  329 20766.9369 35483.0709  70.9%  2641  466s
  1686  1281 30478.5010   10  254 20766.9369 35483.0709  70.9%  2593  476s
  1833  1363 29812.3044   12  343 20766.9369 35483.0709  70.9%  2513  486s
  1975  1447 29138.5728   14  351 20766.9369 33908.6345  63.3%  2469  497s
  2119  1496 28739.0889   16  249 20766.9369 33908.6345  63.3%  2436  508s
  2212  1524 27520.0994   18  203 20766.9369 33704.5212  62.3%  2427  518s
  2244  1554 27191.4872   19  187 20766.9369 33704.5212  62.3%  2450  527s
  2286  1587 26691.5991   20  210 20766.9369 33704.5212  62.3%  2471  538s
H 2312  1587                    20914.612581 33704.5212  61.2%  2474  538s
  2335  1693 26221.0845   21  217 20914.6126 33704.5212  61.2%  2480  550s
  2501  1786 24948.9322   34  149 20914.6126 33704.5212  61.2%  2450  562s
  2689  1867 infeasible   42      20914.6126 33642.8139  60.9%  2423  575s
  2876  1925 31428.5185    6  348 20914.6126 33642.8139  60.9%  2396  588s
  3061  1995 29879.6550    8  281 20914.6126 33642.8139  60.9%  2372  600s
  3208  2091 28537.1092   12  145 20914.6126 33414.0648  59.8%  2398  614s
  3427  2139     cutoff   20      20914.6126 33414.0648  59.8%  2370  627s
  3573  2251 30797.6404    7  437 20914.6126 33414.0648  59.8%  2394  643s
  3771  2340 24434.6791   11  277 20914.6126 33414.0648  59.8%  2390  658s
  4008  2399 22787.1212   14  175 20914.6126 33178.5750  58.6%  2364  675s
  4187  2479 22380.1069   16  257 20914.6126 33178.5750  58.6%  2354  691s
  4347  2551 30244.8453    8  337 20914.6126 32910.2484  57.4%  2386  707s
H 4371  2551                    20943.152756 32910.2484  57.1%  2390  707s
  4542  2649 29693.7869    9  309 20943.1528 32910.2484  57.1%  2370  727s
  4778  2819 28047.9324   12  279 20943.1528 32910.2484  57.1%  2358  744s
  5102  2820 24164.9724   34  454 20943.1528 32910.2484  57.1%  2325  783s
  5104  2821 26545.4275   20  170 20943.1528 32910.2484  57.1%  2324  811s
  5105  2822 22746.7008   13  442 20943.1528 32910.2484  57.1%  2324  829s
  5106  2823 22232.5107   42  387 20943.1528 32910.2484  57.1%  2323  841s
  5107  2823 26246.9648   10  395 20943.1528 32910.2484  57.1%  2323  851s
  5108  2824 26266.9410   22  448 20943.1528 32910.2484  57.1%  2322  857s
  5109  2825 30724.1773   14  421 20943.1528 32910.2484  57.1%  2322  861s
  5110  2825 29322.1974    9  468 20943.1528 32910.2484  57.1%  2321  865s
  5112  2827 25752.5342   18  436 20943.1528 32910.2484  57.1%  2321  872s
  5114  2828 23994.3966   32  431 20943.1528 32910.2484  57.1%  2320  876s
  5115  2829 29774.7793   13  465 20943.1528 32910.2484  57.1%  2319  882s
  5116  2829 25849.9840   22  480 20943.1528 32910.2484  57.1%  2319  885s
  5117  2830 24606.1847   31  471 20943.1528 32910.2484  57.1%  2318  890s
  5120  2832 24499.7289   11  487 20943.1528 32910.2484  57.1%  2317  898s
  5121  2833 24567.9346   29  443 20943.1528 32910.2484  57.1%  2316  900s
  5122  2833 21942.6507   16  531 20943.1528 32910.2484  57.1%  2316  905s
  5124  2835 30540.7618   10  547 20943.1528 32910.2484  57.1%  2315  910s
  5125  2835 21867.0106   13  525 20943.1528 32910.2484  57.1%  2315  915s
  5128  2837 22547.5535   47  478 20943.1528 32910.2484  57.1%  2313  923s
  5129  2838 21262.8952   35  474 20943.1528 32910.2484  57.1%  2313  925s
  5130  2839 23685.9451   15  569 20943.1528 32910.2484  57.1%  2312  930s
  5131  2839 27547.9641   14  569 20943.1528 32910.2484  57.1%  2312  959s
  5132  2840 24500.9758   19  569 20943.1528 32910.2484  57.1%  2311  981s
  5133  2844 32910.2484   11  567 20943.1528 32910.2484  57.1%  2347  998s
  5135  2847 32910.2484   12  555 20943.1528 32910.2484  57.1%  2350 1009s
  5139  2854 32910.2484   13  513 20943.1528 32910.2484  57.1%  2354 1023s
  5147  2867 32910.2484   14  525 20943.1528 32910.2484  57.1%  2366 1036s
  5163  2879 31374.6046   15  222 20943.1528 32910.2484  57.1%  2404 1061s
  5180  2905 32910.2484   16  416 20943.1528 32910.2484  57.1%  2427 1076s
  5212  3001 31401.5068   17  337 20943.1528 32910.2484  57.1%  2453 1092s
  5335  3029 29424.3428   21  240 20943.1528 32910.2484  57.1%  2540 1104s
  5416  3058 28921.5242   23  135 20943.1528 32910.2484  57.1%  2553 1116s
  5506  3075 26659.5950   24  107 20943.1528 32910.2484  57.1%  2559 1131s
  5587  3070 25687.5612   22  130 20943.1528 32910.2484  57.1%  2564 1142s
  5665  3065 27954.9501   25  157 20943.1528 32910.2484  57.1%  2565 1151s
  5738  3067 27799.9681   27  143 20943.1528 32910.2484  57.1%  2565 1160s
  5810  3069 27220.1367   30  118 20943.1528 32910.2484  57.1%  2563 1169s
  5868  3079 26992.6326   32   90 20943.1528 32910.2484  57.1%  2574 1177s
  5949  3079 25712.2742   34   97 20943.1528 32910.2484  57.1%  2572 1184s
  6017  3082     cutoff   34      20943.1528 32910.2484  57.1%  2574 1194s
  6095  3106 25154.6121   37  102 20943.1528 32910.2484  57.1%  2576 1204s
  6186  3106 24846.4483   39  171 20943.1528 32910.2484  57.1%  2570 1213s
  6253  3099 24157.1609   43  162 20943.1528 32910.2484  57.1%  2571 1223s
  6337  3083 infeasible   45      20943.1528 32910.2484  57.1%  2567 1233s
  6419  3091 22686.4365   47  101 20943.1528 32910.2484  57.1%  2572 1244s
  6490  3098     cutoff   47      20943.1528 32910.2484  57.1%  2579 1259s
  6576  3112 26452.2738   23  436 20943.1528 32910.2484  57.1%  2583 1269s
  6650  3141 26443.7984   24  432 20943.1528 32910.2484  57.1%  2591 1279s
  6738  3159 25864.7514   26  429 20943.1528 32910.2484  57.1%  2593 1293s
  6818  3193 23316.1844   28  309 20943.1528 32884.4949  57.0%  2601 1305s
  6920  3202 22990.2460   30  266 20943.1528 32884.4949  57.0%  2608 1318s
  6990  3246 21942.5200   34  316 20943.1528 32884.4949  57.0%  2608 1329s
  7100  3277     cutoff   36      20943.1528 32484.6986  55.1%  2609 1342s
  7249  3259 30374.6979   19  393 20943.1528 32484.6986  55.1%  2597 1355s
  7349  3254 29800.4447   20  385 20943.1528 32484.6986  55.1%  2600 1366s
  7392  3312 29115.9586   21  430 20943.1528 32484.6986  55.1%  2603 1379s
  7485  3345 28691.0985   22  438 20943.1528 32484.6986  55.1%  2605 1392s
  7635  3375 28427.0129   26  344 20943.1528 31656.9419  51.2%  2603 1407s
  7796  3370 26153.3532   29  326 20943.1528 31656.9419  51.2%  2604 1422s
  7959  3376 23957.0236   31  317 20943.1528 31076.3042  48.4%  2605 1437s
  8133  3379     cutoff   36      20943.1528 31076.3042  48.4%  2602 1456s
  8295  3373 26181.9713   20  211 20943.1528 30963.9582  47.8%  2610 1472s
  8475  3383 23338.3063   23  245 20943.1528 30963.9582  47.8%  2614 1491s
  8666  3408 22775.8435   26  208 20943.1528 30668.0990  46.4%  2613 1511s
  8842  3418 21916.1143   33  115 20943.1528 30589.7699  46.1%  2618 1529s
  9012  3437 25543.6787   19  123 20943.1528 30552.3995  45.9%  2620 1547s
  9156  3474 24430.2756   19  259 20943.1528 30552.3995  45.9%  2629 1565s
  9354  3504 21816.4354   25  247 20943.1528 30552.3995  45.9%  2635 1584s
  9558  3509 24241.5630   20  197 20943.1528 30552.3995  45.9%  2642 1606s
  9805  3530 21834.4077   26  256 20943.1528 30552.3995  45.9%  2648 1626s
 10051  3533 23743.5341   20  287 20943.1528 30552.3995  45.9%  2656 1649s
 10325  3593 22126.6744   24  269 20943.1528 29992.6757  43.2%  2659 1670s
 10637  3580 22982.2746   25  109 20943.1528 29992.6757  43.2%  2655 1694s
 11018  3534 21179.4413   33   17 20943.1528 29622.3894  41.4%  2631 1718s
 11317  3517 26883.6003   22  324 20943.1528 29202.0131  39.4%  2635 1751s
 11649  3495 22104.5609   31  181 20943.1528 29121.6855  39.1%  2639 1776s
 11895  3538 26022.6399   26  316 20943.1528 29113.7750  39.0%  2648 1804s
 12264  3514 22454.8476   34  153 20943.1528 29113.7750  39.0%  2648 1832s
 12612  3474     cutoff   23      20943.1528 29006.8223  38.5%  2654 1863s
 12961  3422 25104.7969   24  253 20943.1528 29006.8223  38.5%  2663 1892s
 13319  3406 21608.4095   29  207 20943.1528 28528.3889  36.2%  2662 1923s
 13624  3383 24254.9266   26  188 20943.1528 28441.8349  35.8%  2667 1955s
 14070  3463 21441.8063   25  236 20943.1528 28412.6276  35.7%  2667 1989s
 14510  3575 23502.2717   25  337 20943.1528 28137.0015  34.3%  2671 2024s
 14989  3617 22071.9043   27  388 20943.1528 28137.0015  34.3%  2671 2059s
 15565  3731     cutoff   26      20943.1528 27918.5472  33.3%  2663 2100s
 16127  3811     cutoff   29      20943.1528 27734.6748  32.4%  2660 2137s
 16680  3876 22676.4662   29  238 20943.1528 27572.1410  31.7%  2662 2177s
 17272  3957     cutoff   27      20943.1528 27436.6635  31.0%  2663 2218s
 17937  4010     cutoff   29      20943.1528 27334.2315  30.5%  2657 2254s
 18373  4085 23528.4167   29  278 20943.1528 27194.0331  29.8%  2655 2298s
 19040  4200 22292.2130   23  290 20943.1528 27002.0345  28.9%  2651 2342s
 19687  4302     cutoff   31      20943.1528 26892.9274  28.4%  2653 2391s
 20388  4416 24829.1023   27  265 20943.1528 26732.8853  27.6%  2654 2440s
 21093  4465 23319.3967   28  265 20943.1528 26573.0496  26.9%  2656 2492s
 21862  4523 24226.0994   21  328 20943.1528 26513.1778  26.6%  2655 2546s
 22642  4532 22789.9002   26  204 20943.1528 26273.0945  25.4%  2655 2602s
 23492  4533     cutoff   30      20943.1528 26194.4993  25.1%  2653 2660s
 24375  4488 23380.7259   23  283 20943.1528 25941.9317  23.9%  2649 2720s
 25279  4476 22559.2984   32  194 20943.1528 25767.4543  23.0%  2645 2778s
 26244  4293 22413.2680   23  263 20943.1528 25453.1415  21.5%  2640 2841s
 27325  4116 21155.1787   25  310 20943.1528 25212.5824  20.4%  2627 2903s
 28474  3841     cutoff   30      20943.1528 24967.0226  19.2%  2614 2967s
 29685  3562     cutoff   30      20943.1528 24668.9789  17.8%  2596 3032s
 30902  3044     cutoff   24      20943.1528 24408.0298  16.5%  2578 3099s
 32372  2195     cutoff   28      20943.1528 23996.9705  14.6%  2547 3171s
 34128   985     cutoff   26      20943.1528 23554.7057  12.5%  2498 3235s
 36170     0     cutoff   20      20943.1528 23010.4839  9.87%  2431 3274s

Cutting planes:
  Learned: 2
  MIR: 731
  Mixing: 3
  Flow cover: 2036
  RLT: 35
  Relax-and-lift: 136

Explored 37395 nodes (89145406 simplex iterations) in 3275.06 seconds (10482.08 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 20943.2 20943.2 20914.6 ... 19669.2

Optimal solution found (tolerance 1.00e-06)
Best objective 2.094315275642e+04, best bound 2.094315275642e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3275.09s
  Master Objective (UB) = 20943.15, θ = 166582.00
  Upper Bound (UB) = 20943.15

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 166582.00
  [DEBUG]   ✓ Scenario 0: θ = 166582.00 ≤ Q = 178692.38 (slack: 12110.38)
  [DEBUG]   ✓ Scenario 1: θ = 166582.00 ≤ Q = 166582.00 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 166582.00 ≤ Q = 180274.48 (slack: 13692.49)
  [DEBUG]   ✓ Scenario 3: θ = 166582.00 ≤ Q = 176896.06 (slack: 10314.07)
  [DEBUG]   ✓ Scenario 4: θ = 166582.00 ≤ Q = 166617.71 (slack: 35.71)
  [DEBUG]   ✓ Scenario 5: θ = 166582.00 ≤ Q = 168260.33 (slack: 1678.33)
  [DEBUG]   ✓ Scenario 6: θ = 166582.00 ≤ Q = 166589.38 (slack: 7.38)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x5a059c2f
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xa5fa63d1
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.325703e+13
Presolve removed 2581 rows and 1873 columns
Presolve time: 0.00s
Presolved: 512 rows, 516 columns, 1444 nonzeros
Found heuristic solution: objective 6739043.9369
Variable types: 350 continuous, 166 integer (166 binary)

Root relaxation: objective -1.457062e+05, 248 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -145706.19    0  123 6739043.94 -145706.19   102%     -    0s
H    0     0                    -110173.0992 -145706.19  32.3%     -    0s
H    0     0                    -111430.8692 -145706.19  30.8%     -    0s
H    0     0                    -112463.5694 -126025.87  12.1%     -    0s
H    0     0                    -117821.0641 -126025.87  6.96%     -    0s
     0     0 -126025.87    0   94 -117821.06 -126025.87  6.96%     -    0s
H    0     0                    -123309.5899 -125939.15  2.13%     -    0s
H    0     0                    -124283.5106 -125939.15  1.33%     -    0s
     0     0 -125351.74    0   97 -124283.51 -125351.74  0.86%     -    0s
     0     0 -125292.52    0   97 -124283.51 -125292.52  0.81%     -    0s
     0     0 -125292.52    0   97 -124283.51 -125292.52  0.81%     -    0s
H    0     0                    -124297.4941 -124806.73  0.41%     -    0s
     0     0 -124806.73    0   55 -124297.49 -124806.73  0.41%     -    0s
     0     0 -124777.17    0   67 -124297.49 -124777.17  0.39%     -    0s
     0     0 -124768.99    0   75 -124297.49 -124768.99  0.38%     -    0s
     0     0 -124492.48    0   34 -124297.49 -124492.48  0.16%     -    0s
     0     0 -124489.28    0   25 -124297.49 -124489.28  0.15%     -    0s
     0     0 -124433.37    0   24 -124297.49 -124433.37  0.11%     -    0s
     0     0 -124432.46    0   20 -124297.49 -124432.46  0.11%     -    0s
     0     0 -124367.29    0   11 -124297.49 -124367.29  0.06%     -    0s
     0     0 -124367.29    0   11 -124297.49 -124367.29  0.06%     -    0s
     0     0 -124322.44    0    9 -124297.49 -124322.44  0.02%     -    0s
     0     0 -124319.41    0    6 -124297.49 -124319.41  0.02%     -    0s
*    0     0               0    -124314.7144 -124314.71  0.00%     -    0s

Cutting planes:
  Gomory: 3
  Implied bound: 1
  MIR: 2
  Flow cover: 8
  RLT: 1
  Relax-and-lift: 4

Explored 1 nodes (858 simplex iterations) in 0.08 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -124315 -124297 -124284 ... 1.3257e+13
No other solutions better than -124315

Optimal solution found (tolerance 1.00e-06)
Best objective -1.243147144046e+05, best bound -1.243147144046e+05, gap 0.0000%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 155833.67
  Scenario: 44 demand increases, 16 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -124314.71
  [DEBUG]   S×d_nominal = 280148.38
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 280148.38 + -124314.71 = 155833.67
  [DEBUG]   Current θ from Master = 166582.00
  [DEBUG]   ⚠️  Z_SP ≤ θ by 10748.33 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 10194.82
  Lower Bound (LB) = 19998.82
  Gap (UB-LB) = 944.3325, Absolute Gap = 944.3325, Relative Gap = 0.045090
  Not converged yet (gap = 944.33 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 44 increases, 16 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351439 nonzeros
Model fingerprint: 0xdcaa6ea1
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 54216 rows and 22016 columns
Presolve time: 1.10s
Presolved: 69487 rows, 30164 columns, 432599 nonzeros
Variable types: 27905 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -361254.7791
Found heuristic solution: objective -215351.9614

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 69487 rows, 30164 columns, 432599 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   33829   -3.8374517e+04   0.000000e+00   3.212297e+09      5s
   44685    1.6698876e+04   0.000000e+00   2.350454e+07     10s
   53350    2.7067033e+04   0.000000e+00   8.874078e+05     15s
   61997    3.3382039e+04   0.000000e+00   3.394269e+06     20s
   71425    3.7328527e+04   0.000000e+00   3.260154e+06     25s
   79258    3.8172228e+04   0.000000e+00   5.476403e+05     30s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 4.857191e+04, 50382 iterations, 32.47 seconds (64.56 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 48571.9099    0   93 -215351.96 48571.9099   123%     -   34s
H    0     0                    -199219.9978 48571.9099   124%     -   34s
H    0     0                    -116174.3918 48571.9099   142%     -   34s
H    0     0                    -97557.82893 48571.9099   150%     -   34s
H    0     0                    -96293.41788 48571.9099   150%     -   34s
H    0     0                    -95739.71477 48571.9099   151%     -   34s
H    0     0                    -95473.28373 48571.9099   151%     -   34s
H    0     0                    -95240.39475 48571.9099   151%     -   34s
H    0     0                    -95208.77037 48571.9099   151%     -   34s
H    0     0                    -95018.38608 48571.9099   151%     -   34s
H    0     0                    -53399.49381 48571.9099   191%     -   34s
H    0     0                    -6370.547100 48571.9099   862%     -   34s
H    0     0                    11369.056589 48571.9099   327%     -   34s
H    0     0                    11555.356105 48571.9099   320%     -   34s
H    0     0                    17520.840677 48571.9099   177%     -   35s
H    0     0                    17527.483613 48571.9099   177%     -   35s
H    0     0                    17667.921305 48571.9099   175%     -   35s
H    0     0                    17720.858950 48571.9099   174%     -   35s
H    0     0                    17853.258164 48571.9099   172%     -   35s
     0     0 45447.2445    0  280 17853.2582 45447.2445   155%     -   44s
     0     0 45219.8442    0  265 17853.2582 45219.8442   153%     -   48s
     0     0 45219.8442    0  281 17853.2582 45219.8442   153%     -   49s
     0     0 45219.8442    0  281 17853.2582 45219.8442   153%     -   49s
     0     0 41469.0889    0  213 17853.2582 41469.0889   132%     -   61s
     0     0 40883.4375    0  323 17853.2582 40883.4375   129%     -   69s
     0     0 40609.6428    0  342 17853.2582 40609.6428   127%     -   74s
     0     0 40460.6909    0  337 17853.2582 40460.6909   127%     -   76s
     0     0 40357.6454    0  342 17853.2582 40357.6454   126%     -   79s
     0     0 40325.9021    0  339 17853.2582 40325.9021   126%     -   81s
     0     0 40320.5773    0  342 17853.2582 40320.5773   126%     -   81s
     0     0 40318.1466    0  343 17853.2582 40318.1466   126%     -   82s
     0     0 40317.9312    0  344 17853.2582 40317.9312   126%     -   82s
H    0     0                    17865.643767 38004.3973   113%     -   97s
     0     0 38004.3973    0  355 17865.6438 38004.3973   113%     -   97s
     0     0 37663.9733    0  379 17865.6438 37663.9733   111%     -  104s
     0     0 37412.3818    0  345 17865.6438 37412.3818   109%     -  110s
     0     0 37342.0195    0  366 17865.6438 37342.0195   109%     -  114s
     0     0 37301.8503    0  361 17865.6438 37301.8503   109%     -  117s
     0     0 37271.5857    0  368 17865.6438 37271.5857   109%     -  119s
     0     0 37244.7647    0  427 17865.6438 37244.7647   108%     -  121s
     0     0 37201.9483    0  420 17865.6438 37201.9483   108%     -  123s
     0     0 37186.4932    0  426 17865.6438 37186.4932   108%     -  124s
     0     0 37181.9569    0  431 17865.6438 37181.9569   108%     -  125s
     0     0 37179.1815    0  424 17865.6438 37179.1815   108%     -  125s
     0     0 37163.0103    0  428 17865.6438 37163.0103   108%     -  126s
     0     0 37151.4398    0  438 17865.6438 37151.4398   108%     -  127s
     0     0 37148.8888    0  434 17865.6438 37148.8888   108%     -  127s
     0     0 37147.9462    0  386 17865.6438 37147.9462   108%     -  127s
     0     0 36783.4068    0  433 17865.6438 36783.4068   106%     -  138s
     0     0 36649.4107    0  407 17865.6438 36649.4107   105%     -  142s
     0     0 36505.3434    0  401 17865.6438 36505.3434   104%     -  147s
     0     0 36458.5733    0  458 17865.6438 36458.5733   104%     -  149s
     0     0 36439.1269    0  458 17865.6438 36439.1269   104%     -  152s
     0     0 36420.2465    0  452 17865.6438 36420.2465   104%     -  154s
     0     0 36412.9723    0  457 17865.6438 36412.9723   104%     -  155s
     0     0 36410.4482    0  458 17865.6438 36410.4482   104%     -  156s
     0     0 36407.5044    0  459 17865.6438 36407.5044   104%     -  157s
     0     0 36405.7518    0  461 17865.6438 36405.7518   104%     -  157s
     0     0 36405.0206    0  465 17865.6438 36405.0206   104%     -  158s
     0     0 36254.8616    0  435 17865.6438 36254.8616   103%     -  163s
     0     0 36229.1742    0  445 17865.6438 36229.1742   103%     -  165s
     0     0 36207.2480    0  458 17865.6438 36207.2480   103%     -  167s
     0     0 36203.9387    0  451 17865.6438 36203.9387   103%     -  167s
     0     0 36201.5317    0  452 17865.6438 36201.5317   103%     -  168s
     0     0 36200.2660    0  454 17865.6438 36200.2660   103%     -  168s
H    0     0                    17875.227998 36109.2850   102%     -  172s
     0     0 36109.2850    0  412 17875.2280 36109.2850   102%     -  172s
H    0     0                    17889.468569 36106.8336   102%     -  175s
H    0     0                    17910.238951 36106.8336   102%     -  176s
H    0     0                    20596.495774 36106.8336  75.3%     -  176s
     0     0 36084.5335    0  424 20596.4958 36084.5335  75.2%     -  177s
     0     0 36073.3421    0  427 20596.4958 36073.3421  75.1%     -  179s
     0     0 36071.5657    0  421 20596.4958 36071.5657  75.1%     -  180s
     0     0 36070.6743    0  423 20596.4958 36070.6743  75.1%     -  181s
     0     0 36039.9605    0  420 20596.4958 36039.9605  75.0%     -  183s
     0     0 36031.4886    0  430 20596.4958 36031.4886  74.9%     -  185s
     0     0 36026.1889    0  424 20596.4958 36026.1889  74.9%     -  185s
     0     0 36022.8269    0  432 20596.4958 36022.8269  74.9%     -  186s
     0     0 36020.8440    0  431 20596.4958 36020.8440  74.9%     -  187s
     0     0 36019.1285    0  433 20596.4958 36019.1285  74.9%     -  187s
     0     0 36018.0275    0  430 20596.4958 36018.0275  74.9%     -  187s
     0     0 36005.6805    0  429 20596.4958 36005.6805  74.8%     -  189s
H    0     0                    20626.852441 36005.3446  74.6%     -  192s
H    0     0                    20631.932566 36005.3446  74.5%     -  192s
     0     0 36002.4536    0  430 20631.9326 36002.4536  74.5%     -  193s
     0     0 36001.1336    0  428 20631.9326 36001.1336  74.5%     -  193s
     0     0 35999.4530    0  436 20631.9326 35999.4530  74.5%     -  194s
     0     0 35997.9508    0  444 20631.9326 35997.9508  74.5%     -  195s
     0     0 35992.8949    0  440 20631.9326 35992.8949  74.5%     -  197s
     0     0 35991.8664    0  439 20631.9326 35991.8664  74.4%     -  198s
     0     0 35989.7347    0  439 20631.9326 35989.7347  74.4%     -  200s
     0     0 35989.5492    0  439 20631.9326 35989.5492  74.4%     -  201s
H    0     0                    20727.778097 35989.5492  73.6%     -  229s
     0     2 35989.5492    0  439 20727.7781 35989.5492  73.6%     -  235s
     1     4 35966.9250    1  426 20727.7781 35989.4845  73.6%  1633  240s
     3     7 35877.5996    2  420 20727.7781 35966.2334  73.5%  4545  251s
     6    14 35763.2201    3  415 20727.7781 35876.6141  73.1%  7396  263s
    13    28 35290.9106    4  461 20727.7781 35763.1441  72.5%  8998  273s
    27    42 34157.1641    5  424 20727.7781 35288.9228  70.2% 11170  294s
    41    74 31564.7135    5  405 20727.7781 35288.9228  70.2% 13280  336s
H   53    74                    20766.936909 35288.9228  69.9% 12306  336s
    73   182 31520.0948    6  401 20766.9369 34664.0378  66.9% 12447  352s
   181   227 31140.5813    9  379 20766.9369 34662.3573  66.9%  7463  361s
   226   288 30219.1551   10  283 20766.9369 34662.3573  66.9%  6691  370s
   287   372 30114.3351   11  276 20766.9369 34662.3573  66.9%  6254  379s
   371   451 29802.2994   14  269 20766.9369 34662.3573  66.9%  5717  388s
   452   534 28018.0863   19  232 20766.9369 34662.3573  66.9%  5289  396s
   544   616 27860.3528   20  234 20766.9369 34662.3573  66.9%  4881  403s
   637   665 27424.3172   22  223 20766.9369 34662.3573  66.9%  4581  412s
   728   716 26888.8378   23  228 20766.9369 34662.3573  66.9%  4317  420s
   804   760 26310.7274   26  231 20766.9369 34662.3573  66.9%  4278  430s
   882   782 25586.4790   28  234 20766.9369 34662.3573  66.9%  4224  438s
   946   829 25563.7494   29  231 20766.9369 34662.3573  66.9%  4249  447s
  1003   877 25045.5685   35  162 20766.9369 34662.3573  66.9%  4288  456s
  1061   922 23923.9444   40  128 20766.9369 34662.3573  66.9%  4342  465s
  1128   969 22409.6679   43  186 20766.9369 34662.3573  66.9%  4361  474s
  1198  1022 21798.8810   48  232 20766.9369 34662.3573  66.9%  4445  484s
  1287  1055     cutoff   51      20766.9369 34662.3573  66.9%  4437  495s
  1328  1108 32810.0613   11  397 20766.9369 34662.3573  66.9%  4508  505s
  1401  1179 32674.2497   12  363 20766.9369 34662.3573  66.9%  4512  515s
  1480  1253 31048.1968   14  395 20766.9369 34662.3573  66.9%  4525  526s
  1576  1327 30758.1940   16  354 20766.9369 34662.3573  66.9%  4484  536s
  1686  1388 29798.6826   18  355 20766.9369 34662.3573  66.9%  4425  547s
  1775  1457 27471.7393   20  331 20766.9369 34662.3573  66.9%  4460  560s
  1874  1518 26973.4484   21  338 20766.9369 34163.1350  64.5%  4429  571s
  1971  1573 26895.5648   22  290 20766.9369 34163.1350  64.5%  4405  584s
  2086  1608 26354.6813   24  266 20766.9369 34099.5101  64.2%  4391  595s
  2143  1668 26231.1775   25  282 20766.9369 34057.2254  64.0%  4426  606s
  2225  1726 25907.0071   26  264 20766.9369 34057.2254  64.0%  4466  619s
  2317  1803 25849.7553   27  267 20766.9369 34057.2254  64.0%  4480  633s
  2434  1857 25606.3792   28  267 20766.9369 34057.2254  64.0%  4484  644s
  2502  1901 25597.2873   29  261 20766.9369 34057.2254  64.0%  4471  658s
  2608  1993 24290.8775   31  308 20766.9369 34057.2254  64.0%  4473  671s
  2761  2086 23129.5735   36  256 20766.9369 34001.5664  63.7%  4448  685s
  2908  2187 22476.3655   42  243 20766.9369 33741.6396  62.5%  4458  698s
  3076  2278 21532.2999   46  232 20766.9369 33741.6396  62.5%  4445  713s
  3239  2385     cutoff   47      20766.9369 33497.1234  61.3%  4463  728s
  3416  2505 29039.6784    7  287 20766.9369 33497.1234  61.3%  4470  745s
  3608  2642 27437.5488    8  280 20766.9369 33497.1234  61.3%  4477  761s
  3814  2643 32419.5130   11  439 20766.9369 33177.0571  59.8%  4476  908s
  3816  2644 24277.5595   25   93 20766.9369 33177.0571  59.8%  4474  923s
  3817  2645 23695.4087   32  363 20766.9369 33177.0571  59.8%  4473  941s
  3818  2646 29329.9253    9  456 20766.9369 33177.0571  59.8%  4471  959s
  3819  2646 23491.1793   31  437 20766.9369 33177.0571  59.8%  4470  969s
  3820  2647 27275.4825   26  460 20766.9369 33177.0571  59.8%  4469  974s
  3821  2648 22450.8302   27  420 20766.9369 33177.0571  59.8%  4468  980s
  3823  2649 30098.6038   12  426 20766.9369 33177.0571  59.8%  4466  986s
  3824  2650 27170.1772   34  436 20766.9369 33177.0571  59.8%  4464  990s
  3827  2652 23715.5854   68  481 20766.9369 33177.0571  59.8%  4461  996s
  3828  2652 22694.6336   29  494 20766.9369 33177.0571  59.8%  4460 1001s
  3829  2653 27439.3609   14  548 20766.9369 33177.0571  59.8%  4459 1005s
  3831  2654 26466.4142   18  426 20766.9369 33177.0571  59.8%  4456 1013s
  3832  2655 25248.1347   29  452 20766.9369 33177.0571  59.8%  4455 1016s
  3833  2656 29947.9288   25  486 20766.9369 33177.0571  59.8%  4454 1023s
  3834  2656 23367.4201   34  523 20766.9369 33177.0571  59.8%  4453 1027s
  3836  2658 25261.5293   37  491 20766.9369 33177.0571  59.8%  4450 1034s
  3837  2658 24368.2675   35  496 20766.9369 33177.0571  59.8%  4449 1038s
  3838  2659 29487.3476   12  468 20766.9369 33177.0571  59.8%  4448 1048s
  3839  2660 25725.8212   42  483 20766.9369 33177.0571  59.8%  4447 1051s
  3841  2661 29532.5970   18  470 20766.9369 33177.0571  59.8%  4445 1057s
  3842  2662 30542.4212   17  439 20766.9369 33177.0571  59.8%  4443 1060s
  3843  2662 28142.2648   14  543 20766.9369 33177.0571  59.8%  4442 1066s
  3844  2663 28772.0302   10  436 20766.9369 33177.0571  59.8%  4441 1070s
  3846  2664 26484.9869   27  516 20766.9369 33177.0571  59.8%  4439 1077s
  3847  2665 30561.5814   11  447 20766.9369 33177.0571  59.8%  4438 1081s
  3848  2666 26381.3470   32  447 20766.9369 33177.0571  59.8%  4437 1097s
  3849  2666 29952.5756   13  447 20766.9369 33177.0571  59.8%  4435 1126s
  3850  2670 33177.0571   10  469 20766.9369 33177.0571  59.8%  4492 1173s
  3852  2673 33177.0571   11  469 20766.9369 33177.0571  59.8%  4494 1191s
  3856  2680 33177.0571   12  462 20766.9369 33177.0571  59.8%  4499 1210s
  3864  2693 33177.0571   13  468 20766.9369 33177.0571  59.8%  4509 1234s
  3880  2706 32179.2602   14  372 20766.9369 33177.0571  59.8%  4560 1269s
  3898  2730 32445.1599   15  328 20766.9369 33177.0571  59.8%  4609 1287s
  3930  2844 31262.4507   16  282 20766.9369 33177.0571  59.8%  4655 1313s
  4062  2831 30185.3790   20  244 20766.9369 33177.0571  59.8%  4648 1322s
  4095  2843 27659.0656   18  234 20766.9369 33177.0571  59.8%  4663 1333s
  4130  2858 29875.1118   20  319 20766.9369 33177.0571  59.8%  4690 1344s
  4166  2871 29562.2693   19  263 20766.9369 33177.0571  59.8%  4699 1355s
  4200  2884 28386.3477   21  299 20766.9369 33177.0571  59.8%  4714 1365s
  4234  2894 28278.9622   21  228 20766.9369 33177.0571  59.8%  4713 1376s
  4272  2894 28338.4000   21  304 20766.9369 33177.0571  59.8%  4727 1387s
  4315  2894 27861.4948   21  229 20766.9369 33177.0571  59.8%  4731 1399s
  4355  2897 27436.1532   20  239 20766.9369 33177.0571  59.8%  4739 1417s
  4390  2906 27041.2763   21  229 20766.9369 33177.0571  59.8%  4739 1429s
  4425  2911 27650.8390   22  295 20766.9369 33177.0571  59.8%  4741 1441s
  4463  2921 26206.6610   23  222 20766.9369 33177.0571  59.8%  4738 1452s
  4500  2931 26112.1289   24  217 20766.9369 33177.0571  59.8%  4734 1463s
  4531  2935 25637.7111   25  263 20766.9369 33177.0571  59.8%  4736 1479s
  4573  2948 25599.1621   26  264 20766.9369 33177.0571  59.8%  4725 1490s
  4631  2947 25331.0901   27  206 20766.9369 33177.0571  59.8%  4724 1502s
  4706  2953     cutoff   27      20766.9369 33177.0571  59.8%  4691 1513s
  4787  2951 24783.6669   29  262 20766.9369 33177.0571  59.8%  4664 1531s
  4880  2923 24480.7251   30  279 20766.9369 33177.0571  59.8%  4642 1549s
  4968  2924     cutoff   28      20766.9369 33177.0571  59.8%  4636 1564s
  5037  2929 24208.2265   32  228 20766.9369 33177.0571  59.8%  4664 1578s
  5122  2935 24207.8643   33  160 20766.9369 33177.0571  59.8%  4674 1598s
  5210  2953     cutoff   34      20766.9369 33177.0571  59.8%  4683 1613s
  5301  2948 22253.9038   42  167 20766.9369 32935.3140  58.6%  4690 1631s
  5410  2985 21743.8624   48   77 20766.9369 32928.9694  58.6%  4698 1647s
  5531  2964     cutoff   54      20766.9369 32928.9694  58.6%  4691 1663s
  5572  2972 infeasible   56      20766.9369 32324.9927  55.7%  4718 1676s
  5611  2983 29949.9242   18  366 20766.9369 32324.9927  55.7%  4740 1688s
  5652  2992 28675.7528   19  287 20766.9369 31949.6484  53.8%  4743 1703s
  5715  2998 28528.5488   20  285 20766.9369 31949.6484  53.8%  4730 1723s
  5796  3002 28337.5769   21  287 20766.9369 31949.6484  53.8%  4710 1741s
  5893  3001 27931.9160   22  272 20766.9369 31949.6484  53.8%  4714 1762s
  5995  3029 27460.1843   23  223 20766.9369 31949.6484  53.8%  4729 1781s
  6104  3073 26061.7915   24  245 20766.9369 31846.8638  53.4%  4746 1803s
  6250  3108 21361.2604   27  241 20766.9369 31329.8451  50.9%  4756 1826s
  6415  3157     cutoff   29      20766.9369 31329.8451  50.9%  4757 1855s
  6601  3211 25203.8594   20  149 20766.9369 31329.8451  50.9%  4754 1885s
  6794  3244 infeasible   21      20766.9369 31248.3906  50.5%  4743 1912s
  7024  3266 23755.6593   29  260 20766.9369 30782.3050  48.2%  4726 1936s
  7219  3299     cutoff   35      20766.9369 30392.0889  46.3%  4731 1963s
  7474  3273 21005.4974   44  190 20766.9369 30392.0889  46.3%  4694 1989s
  7727  3285 21280.7028   17  281 20766.9369 30126.1951  45.1%  4677 2014s
  7948  3290 26563.7548   24  334 20766.9369 30097.7286  44.9%  4678 2040s
  8205  3335 22522.9562   29  247 20766.9369 30097.7286  44.9%  4674 2070s
  8526  3350 24975.0976   22  304 20766.9369 29977.0335  44.3%  4635 2103s
  8795  3373     cutoff   25      20766.9369 29449.9107  41.8%  4639 2129s
  9081  3388 23069.5499   30  241 20766.9369 29439.0277  41.8%  4657 2158s
  9422  3384 infeasible   26      20766.9369 29379.0687  41.5%  4653 2187s
  9779  3444 infeasible   36      20766.9369 29327.7567  41.2%  4644 2215s
 10154  3478     cutoff   27      20766.9369 29022.8681  39.8%  4635 2254s
 10523  3506 infeasible   38      20766.9369 28800.8112  38.7%  4633 2284s
 10903  3559 24607.9219   24  270 20766.9369 28531.5449  37.4%  4635 2316s
 11346  3558 22406.1508   34  296 20766.9369 28520.3184  37.3%  4619 2351s
 11779  3597 21994.9559   22  303 20766.9369 28380.5715  36.7%  4617 2387s
 12165  3747 25085.9943   21  283 20766.9369 28254.9642  36.1%  4627 2424s
 12623  3943 infeasible   28      20766.9369 28187.3555  35.7%  4616 2460s
 13111  4065 20986.5628   20  304 20766.9369 28172.0732  35.7%  4617 2499s
 13585  4086 25356.3804   23  259 20766.9369 28064.2842  35.1%  4630 2530s
 13630  4138 25251.0200   24  219 20766.9369 28060.4000  35.1%  4635 2569s
 13817  4286 22444.0714   32  258 20766.9369 27980.1563  34.7%  4648 2611s
 14319  4407 22819.1242   29  329 20766.9369 27963.6450  34.7%  4654 2657s
 14955  4572     cutoff   18      20766.9369 27683.6265  33.3%  4634 2706s
 15449  4729     cutoff   22      20766.9369 27504.8138  32.4%  4639 2753s
 16051  4991     cutoff   22      20766.9369 27504.8138  32.4%  4646 2800s
 16696  5193 21435.0784   29  129 20766.9369 27300.4153  31.5%  4644 2856s
 17325  5362 23571.7031   29  218 20766.9369 27102.9446  30.5%  4656 2906s
 17961  5557 24313.2800   23  226 20766.9369 26974.4793  29.9%  4669 2957s
 18652  5708     cutoff   31      20766.9369 26855.7281  29.3%  4675 3012s
 19321  5898 21971.2681   28   86 20766.9369 26727.0888  28.7%  4691 3071s
 20076  6021 20969.8124   34  137 20766.9369 26694.9414  28.5%  4686 3136s
 20875  6178 23204.4718   22  342 20766.9369 26509.3121  27.7%  4690 3200s
 21724  6379 20998.7298   27  177 20766.9369 26423.1388  27.2%  4683 3265s
 22578  6518 22625.9730   40  135 20766.9369 26224.3086  26.3%  4681 3337s
 23465  6653     cutoff   26      20766.9369 26086.4884  25.6%  4687 3405s
 24441  6747 21682.4015   24  304 20766.9369 25994.6844  25.2%  4680 3477s
 25420  6799 23573.1675   24  309 20766.9369 25891.2969  24.7%  4680 3546s
 26422  6922     cutoff   33      20766.9369 25664.0090  23.6%  4681 3600s

Cutting planes:
  Learned: 1
  Gomory: 1
  MIR: 937
  Mixing: 1
  Flow cover: 2327
  RLT: 35
  Relax-and-lift: 120

Explored 27331 nodes (127678006 simplex iterations) in 3600.04 seconds (11918.30 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 20766.9 20727.8 20631.9 ... 17853.3

Time limit reached
Best objective 2.076693690879e+04, best bound 2.551556316513e+04, gap 22.8663%
  WARNING: Time limit reached. Using best solution found (gap: 22.87%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.04s
  Master Objective (UB) = 20766.94, θ = 168248.68
  Upper Bound (UB) = 20766.94

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 168248.68
  [DEBUG]   ✓ Scenario 0: θ = 168248.68 ≤ Q = 168248.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 168248.68 ≤ Q = 168248.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 168248.68 ≤ Q = 168248.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 168248.68 ≤ Q = 168248.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 168248.68 ≤ Q = 168248.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 168248.68 ≤ Q = 168248.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 168248.68 ≤ Q = 168248.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 168248.68 ≤ Q = 168248.68 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x18d81b83
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xe727e47d
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.357631e+13
Presolve removed 2580 rows and 1872 columns
Presolve time: 0.00s
Presolved: 513 rows, 517 columns, 1447 nonzeros
Found heuristic solution: objective 6920002.2950
Variable types: 351 continuous, 166 integer (166 binary)

Root relaxation: objective -1.438552e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -143855.20    0  123 6920002.30 -143855.20   102%     -    0s
H    0     0                    -108389.2204 -143855.20  32.7%     -    0s
H    0     0                    -109655.7112 -143855.20  31.2%     -    0s
H    0     0                    -123425.9273 -124979.60  1.26%     -    0s
     0     0 -124979.60    0   53 -123425.93 -124979.60  1.26%     -    0s
H    0     0                    -123690.0028 -124898.64  0.98%     -    0s
     0     0 -124236.57    0   54 -123690.00 -124236.57  0.44%     -    0s
H    0     0                    -123713.8673 -124220.83  0.41%     -    0s
     0     0 -123874.79    0   14 -123713.87 -123874.79  0.13%     -    0s
     0     0 -123874.73    0   13 -123713.87 -123874.73  0.13%     -    0s
H    0     0                    -123755.2914 -123865.66  0.09%     -    0s
     0     0 -123865.66    0   12 -123755.29 -123865.66  0.09%     -    0s
     0     0 -123857.22    0    9 -123755.29 -123857.22  0.08%     -    0s
     0     0 -123857.22    0   15 -123755.29 -123857.22  0.08%     -    0s
H    0     0                    -123821.3432 -123857.22  0.03%     -    0s
     0     0 -123832.85    0    9 -123821.34 -123832.85  0.01%     -    0s
     0     0 -123827.04    0    5 -123821.34 -123827.04  0.00%     -    0s
     0     0 -123821.77    0    4 -123821.34 -123821.77  0.00%     -    0s

Cutting planes:
  Gomory: 1
  MIR: 2
  Flow cover: 11
  Relax-and-lift: 2

Explored 1 nodes (626 simplex iterations) in 0.09 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 8: -123821 -123755 -123714 ... 1.35763e+13
No other solutions better than -123821

Optimal solution found (tolerance 1.00e-06)
Best objective -1.238213431713e+05, best bound -1.238213431713e+05, gap 0.0000%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 156327.04
  Scenario: 23 demand increases, 37 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -123821.34
  [DEBUG]   S×d_nominal = 280148.38
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 280148.38 + -123821.34 = 156327.04
  [DEBUG]   Current θ from Master = 168248.68
  [DEBUG]   ⚠️  Z_SP ≤ θ by 11921.65 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 8845.29
  Lower Bound (LB) = 19998.82
  Gap (UB-LB) = 768.1167, Absolute Gap = 768.1167, Relative Gap = 0.036987
  Not converged yet (gap = 768.12 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 23 increases, 37 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394679 nonzeros
Model fingerprint: 0x2c740461
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 61003 rows and 24773 columns
Presolve time: 1.09s
Presolved: 77990 rows, 33647 columns, 478286 nonzeros
Variable types: 31388 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -361254.7791
Found heuristic solution: objective -215351.9614

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 77990 rows, 33647 columns, 478286 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   37407   -9.3879157e+04   0.000000e+00   6.671189e+08      5s
   52533    1.0863639e+04   0.000000e+00   1.511125e+08     10s
   61746    1.9100726e+04   0.000000e+00   1.092454e+06     15s
   69130    2.4127102e+04   0.000000e+00   4.542055e+07     20s
   78682    3.4247893e+04   0.000000e+00   2.350685e+06     25s
   87708    3.7906847e+04   0.000000e+00   1.535826e+06     30s
   96138    4.0240305e+04   0.000000e+00   7.915511e+06     35s
  104378    4.1407679e+04   0.000000e+00   3.726642e+06     40s
Concurrent spin time: 3.10s

Solved with dual simplex

Root relaxation: objective 4.855106e+04, 73161 iterations, 45.67 seconds (91.77 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 48551.0575    0  237 -215351.96 48551.0575   123%     -   47s
H    0     0                    -203715.7318 48551.0575   124%     -   47s
H    0     0                    -152920.3038 48551.0575   132%     -   47s
H    0     0                    -143300.8839 48551.0575   134%     -   47s
H    0     0                    -143182.5600 48551.0575   134%     -   47s
H    0     0                    -142160.5769 48551.0575   134%     -   47s
H    0     0                    -53399.49381 48551.0575   191%     -   47s
H    0     0                    -31320.06081 48551.0575   255%     -   47s
H    0     0                    -31282.36099 48551.0575   255%     -   47s
H    0     0                    10441.447534 48551.0575   365%     -   47s
H    0     0                    11165.253568 48551.0575   335%     -   48s
H    0     0                    11567.741708 48551.0575   320%     -   48s
H    0     0                    11643.422985 48551.0575   317%     -   48s
H    0     0                    11724.519801 45011.8072   284%     -   61s
H    0     0                    11736.905404 45011.8072   284%     -   61s
     0     0 45011.0153    0  412 11736.9054 45011.0153   283%     -   61s
     0     0 44337.2580    0  442 11736.9054 44337.2580   278%     -   71s
     0     0 44337.2580    0  451 11736.9054 44337.2580   278%     -   75s
     0     0 44337.2580    0  456 11736.9054 44337.2580   278%     -   76s
     0     0 44337.2580    0  466 11736.9054 44337.2580   278%     -   77s
     0     0 44337.2580    0  464 11736.9054 44337.2580   278%     -   78s
     0     0 44314.5790    0  458 11736.9054 44314.5790   278%     -   80s
     0     0 44310.2681    0  454 11736.9054 44310.2681   278%     -   81s
     0     0 44309.8159    0  454 11736.9054 44309.8159   278%     -   81s
     0     0 44309.5378    0  454 11736.9054 44309.5378   278%     -   81s
     0     0 40819.6719    0  351 11736.9054 40819.6719   248%     -  100s
H    0     0                    17534.877914 40819.5836   133%     -  100s
     0     0 40128.9877    0  352 17534.8779 40128.9877   129%     -  108s
     0     0 39953.2329    0  358 17534.8779 39953.2329   128%     -  113s
     0     0 39876.6627    0  322 17534.8779 39876.6627   127%     -  115s
     0     0 39810.4775    0  324 17534.8779 39810.4775   127%     -  120s
     0     0 39722.9422    0  375 17534.8779 39722.9422   127%     -  123s
     0     0 39713.9858    0  377 17534.8779 39713.9858   126%     -  125s
     0     0 39697.1536    0  368 17534.8779 39697.1536   126%     -  127s
     0     0 39682.4219    0  376 17534.8779 39682.4219   126%     -  128s
     0     0 39680.7646    0  329 17534.8779 39680.7646   126%     -  129s
     0     0 39679.7241    0  380 17534.8779 39679.7241   126%     -  129s
     0     0 39679.4593    0  383 17534.8779 39679.4593   126%     -  129s
H    0     0                    17623.143858 37998.3942   116%     -  153s
H    0     0                    17683.208771 37998.3942   115%     -  153s
     0     0 37998.3942    0  366 17683.2088 37998.3942   115%     -  153s
     0     0 37608.6160    0  365 17683.2088 37608.6160   113%     -  160s
     0     0 37439.2665    0  373 17683.2088 37439.2665   112%     -  166s
     0     0 37342.6648    0  397 17683.2088 37342.6648   111%     -  170s
     0     0 37281.5641    0  394 17683.2088 37281.5641   111%     -  174s
     0     0 37222.0969    0  398 17683.2088 37222.0969   110%     -  177s
     0     0 37177.8733    0  380 17683.2088 37177.8733   110%     -  180s
     0     0 37163.2208    0  390 17683.2088 37163.2208   110%     -  182s
     0     0 37149.1309    0  389 17683.2088 37149.1309   110%     -  185s
     0     0 37120.3449    0  390 17683.2088 37120.3449   110%     -  187s
     0     0 37110.2227    0  386 17683.2088 37110.2227   110%     -  188s
     0     0 37102.6913    0  387 17683.2088 37102.6913   110%     -  190s
     0     0 37096.4736    0  390 17683.2088 37096.4736   110%     -  191s
     0     0 37084.7987    0  437 17683.2088 37084.7987   110%     -  193s
     0     0 37082.4614    0  392 17683.2088 37082.4614   110%     -  194s
     0     0 37073.7638    0  387 17683.2088 37073.7638   110%     -  195s
     0     0 37071.7889    0  390 17683.2088 37071.7889   110%     -  196s
     0     0 37070.9017    0  392 17683.2088 37070.9017   110%     -  196s
     0     0 36789.6070    0  400 17683.2088 36789.6070   108%     -  205s
     0     0 36583.4543    0  409 17683.2088 36583.4543   107%     -  211s
     0     0 36536.6337    0  409 17683.2088 36536.6337   107%     -  214s
     0     0 36524.2711    0  406 17683.2088 36524.2711   107%     -  216s
     0     0 36514.1035    0  416 17683.2088 36514.1035   106%     -  217s
     0     0 36498.5221    0  407 17683.2088 36498.5221   106%     -  219s
     0     0 36496.4558    0  408 17683.2088 36496.4558   106%     -  220s
     0     0 36495.2124    0  406 17683.2088 36495.2124   106%     -  220s
     0     0 36433.5525    0  460 17683.2088 36433.5525   106%     -  226s
     0     0 36410.1719    0  471 17683.2088 36410.1719   106%     -  229s
     0     0 36403.2600    0  422 17683.2088 36403.2600   106%     -  230s
     0     0 36397.2473    0  417 17683.2088 36397.2473   106%     -  231s
     0     0 36394.0295    0  416 17683.2088 36394.0295   106%     -  232s
     0     0 36393.5146    0  420 17683.2088 36393.5146   106%     -  232s
     0     0 36358.2361    0  417 17683.2088 36358.2361   106%     -  237s
H    0     0                    17708.140212 36358.1573   105%     -  239s
H    0     0                    17865.643767 36358.1573   104%     -  239s
     0     0 36333.4865    0  424 17865.6438 36333.4865   103%     -  241s
     0     0 36324.9136    0  414 17865.6438 36324.9136   103%     -  242s
     0     0 36318.1500    0  419 17865.6438 36318.1500   103%     -  244s
     0     0 36314.2478    0  426 17865.6438 36314.2478   103%     -  245s
     0     0 36313.6979    0  425 17865.6438 36313.6979   103%     -  246s
     0     0 36237.2261    0  467 17865.6438 36237.2261   103%     -  251s
     0     0 36202.6583    0  418 17865.6438 36202.6583   103%     -  255s
     0     0 36191.0372    0  421 17865.6438 36191.0372   103%     -  256s
     0     0 36177.9431    0  414 17865.6438 36177.9431   103%     -  257s
     0     0 36168.6017    0  420 17865.6438 36168.6017   102%     -  259s
     0     0 36164.9225    0  427 17865.6438 36164.9225   102%     -  260s
     0     0 36160.3411    0  485 17865.6438 36160.3411   102%     -  261s
     0     0 36155.9386    0  480 17865.6438 36155.9386   102%     -  262s
     0     0 36152.3701    0  422 17865.6438 36152.3701   102%     -  263s
     0     0 36150.9662    0  421 17865.6438 36150.9662   102%     -  264s
     0     0 36111.6993    0  427 17865.6438 36111.6993   102%     -  268s
     0     0 36101.3074    0  493 17865.6438 36101.3074   102%     -  270s
     0     0 36096.3490    0  494 17865.6438 36096.3490   102%     -  271s
     0     0 36092.8826    0  494 17865.6438 36092.8826   102%     -  273s
     0     0 36090.9278    0  497 17865.6438 36090.9278   102%     -  273s
     0     0 36089.4132    0  436 17865.6438 36089.4132   102%     -  274s
     0     0 36061.5984    0  429 17865.6438 36061.5984   102%     -  277s
     0     0 36057.3513    0  422 17865.6438 36057.3513   102%     -  278s
     0     0 36055.5757    0  422 17865.6438 36055.5757   102%     -  279s
     0     0 36055.1047    0  424 17865.6438 36055.1047   102%     -  279s
     0     0 36051.7612    0  491 17865.6438 36051.7612   102%     -  281s
     0     0 36050.3898    0  487 17865.6438 36050.3898   102%     -  283s
     0     0 36039.6951    0  483 17865.6438 36039.6951   102%     -  285s
     0     0 36036.4383    0  430 17865.6438 36036.4383   102%     -  287s
     0     0 36036.1834    0  428 17865.6438 36036.1834   102%     -  288s
     0     0 36033.9073    0  430 17865.6438 36033.9073   102%     -  289s
     0     0 36033.7227    0  430 17865.6438 36033.7227   102%     -  290s
H    0     0                    19843.301634 36033.7227  81.6%     -  331s
H    0     0                    19946.725877 36033.7227  80.6%     -  331s
H    0     0                    20034.294049 36033.7227  79.9%     -  331s
H    0     2                    20174.809589 36033.7227  78.6%     -  335s
     0     2 36033.7227    0  430 20174.8096 36033.7227  78.6%     -  335s
     3     7 35909.6976    2  423 20174.8096 35985.3893  78.4%  5483  347s
     6    14 35858.5393    3  495 20174.8096 35985.3591  78.4%  6734  358s
    13    28 35714.8088    4  426 20174.8096 35856.1345  77.7%  8386  370s
    27    42 34152.7882    5  418 20174.8096 35713.4633  77.0% 12551  397s
H   41    74                    20426.385517 35713.4633  74.8% 11601  434s
H   42    74                    20506.872153 35713.4633  74.2% 11535  434s
H   43    74                    20524.650384 35713.4633  74.0% 11482  434s
    73   172 32866.5247    7  403 20524.6504 35229.2481  71.6% 11470  462s
   171   268 32630.2234   10  400 20524.6504 35227.3633  71.6%  7475  476s
   267   335 32179.9573   14  385 20524.6504 35227.3633  71.6%  5994  488s
   334   374 32100.2089   15  373 20524.6504 35227.3633  71.6%  5753  499s
H  346   374                    20563.809196 35227.3633  71.3%  5677  499s
   373   420 31110.8930   15  355 20563.8092 35227.3633  71.3%  5602  511s
   425   470 31064.9340   17  347 20563.8092 35227.3633  71.3%  5500  522s
   484   519 30396.1549   18  319 20563.8092 35227.3633  71.3%  5467  535s
   547   538 30257.2080   19  355 20563.8092 35227.3633  71.3%  5404  547s
   595   574 29958.7203   20  292 20563.8092 35227.3633  71.3%  5341  562s
   643   611 29911.5604   21  298 20563.8092 35227.3633  71.3%  5345  574s
   696   654 29527.0762   22  299 20563.8092 35227.3633  71.3%  5404  586s
   751   695 29091.1055   23  291 20563.8092 35227.3633  71.3%  5466  598s
   806   742 28865.6157   24  252 20563.8092 35227.3633  71.3%  5529  610s
   865   793 28762.7254   25  418 20563.8092 35227.3633  71.3%  5535  621s
   930   844 28580.0489   26  421 20563.8092 35227.3633  71.3%  5486  633s
   997   886 26355.5302   27  334 20563.8092 35227.3633  71.3%  5454  648s
  1069   927 26316.4832   28  242 20563.8092 35227.3633  71.3%  5482  661s
  1144   969 23736.5317   31  223 20563.8092 35227.3633  71.3%  5560  674s
  1220  1012 22383.1873   36  229 20563.8092 34833.7459  69.4%  5651  687s
  1284  1068 22059.5364   39  183 20563.8092 34833.7459  69.4%  5688  702s
  1362  1136 21776.7684   41  378 20563.8092 34833.7459  69.4%  5660  715s
  1456  1194 21565.9792   45  376 20563.8092 34833.7459  69.4%  5651  731s
  1558  1219 20916.5935   51  180 20563.8092 34833.7459  69.4%  5651  745s
  1597  1246 20911.2958   52  176 20563.8092 34833.7459  69.4%  5726  760s
  1634  1274     cutoff   53      20563.8092 34833.7459  69.4%  5793  774s
  1672  1309     cutoff   54      20563.8092 34833.7459  69.4%  5842  789s
  1729  1357 30784.6708   12  436 20563.8092 34833.7459  69.4%  5867  805s
  1817  1408 29412.9918   13  334 20563.8092 34625.1490  68.4%  5824  823s
  1910  1443 29238.2619   14  391 20563.8092 34354.7990  67.1%  5775  842s
  1981  1522 28772.7662   15  377 20563.8092 34354.7990  67.1%  5740  859s
  2108  1608 27685.5365   16  232 20563.8092 34354.7990  67.1%  5660  879s
  2246  1715 26867.7778   18  222 20563.8092 34354.7990  67.1%  5564  898s
  2397  1816 26257.3631   22  231 20563.8092 34354.7990  67.1%  5505  917s
  2555  1929 24227.2235   24  162 20563.8092 34354.7990  67.1%  5471  940s
  2714  2004 23484.9092   27  273 20563.8092 34354.7990  67.1%  5467  962s
  2839  2100     cutoff   30      20563.8092 34354.7990  67.1%  5529  989s
  2983  2153     cutoff   34      20563.8092 34317.0276  66.9%  5593 1011s
H 2989  2153                    20598.237167 34317.0276  66.6%  5585 1011s
  3116  2270 20670.6501   53  116 20598.2372 33947.6015  64.8%  5592 1034s
  3313  2410 31282.6517    6  325 20598.2372 33947.6015  64.8%  5576 1060s
  3529  2533 29654.5181    8  260 20598.2372 33947.6015  64.8%  5542 1085s
  3718  2683 21642.0980   11  246 20598.2372 33947.6015  64.8%  5590 1112s
H 3918  2683                    20669.940974 33947.6015  64.2%  5644 1123s
  3919  2684 22625.9148   32  430 20669.9410 33947.6015  64.2%  5642 1196s
  3921  2685 22154.6064   40   97 20669.9410 33947.6015  64.2%  5639 1257s
  3922  2686 27684.0974   17  384 20669.9410 33947.6015  64.2%  5638 1284s
  3923  2687 25823.1765   28  459 20669.9410 33947.6015  64.2%  5636 1304s
  3924  2687 24555.9679   30  436 20669.9410 33947.6015  64.2%  5635 1317s
  3925  2688 21496.3423   27  404 20669.9410 33947.6015  64.2%  5634 1325s
  3926  2689 31933.0642   10  410 20669.9410 33947.6015  64.2%  5632 1333s
  3927  2689 22061.4243   20  414 20669.9410 33947.6015  64.2%  5631 1340s
  3929  2691 24888.1184   22  457 20669.9410 33947.6015  64.2%  5628 1346s
  3931  2692 24886.4891   21  420 20669.9410 33947.6015  64.2%  5625 1351s
  3933  2693 28993.4426   22  426 20669.9410 33947.6015  64.2%  5622 1355s
  3935  2695 32489.3613   14  431 20669.9410 33947.6015  64.2%  5619 1364s
  3936  2695 27954.6571   16  436 20669.9410 33947.6015  64.2%  5618 1367s
  3937  2696 27798.2320   21  438 20669.9410 33947.6015  64.2%  5616 1370s
  3940  2698 21508.2964   20  424 20669.9410 33947.6015  64.2%  5612 1380s
  3942  2699 23677.2475   41  425 20669.9410 33947.6015  64.2%  5609 1385s
  3944  2701 23832.2599   31  422 20669.9410 33947.6015  64.2%  5606 1395s
  3946  2702 23877.3602   23  471 20669.9410 33947.6015  64.2%  5604 1401s
  3948  2703 23591.4744   28  484 20669.9410 33947.6015  64.2%  5601 1406s
  3949  2704 28757.0484   11  491 20669.9410 33947.6015  64.2%  5599 1413s
  3950  2705 22691.1157   42  489 20669.9410 33947.6015  64.2%  5598 1416s
  3952  2706 23047.3030   16  455 20669.9410 33947.6015  64.2%  5595 1420s
  3953  2707 24584.8541   50  554 20669.9410 33947.6015  64.2%  5594 1431s
  3954  2707 23755.3699   60  437 20669.9410 33947.6015  64.2%  5592 1435s
  3956  2709 31564.0403    9  454 20669.9410 33947.6015  64.2%  5589 1445s
  3958  2710 22987.4594   28  508 20669.9410 33947.6015  64.2%  5587 1457s
  3959  2711 25921.5094   29  451 20669.9410 33947.6015  64.2%  5585 1461s
  3960  2711 30257.6386   13  453 20669.9410 33947.6015  64.2%  5584 1465s
  3961  2712 32172.7466   12  444 20669.9410 33947.6015  64.2%  5582 1471s
  3962  2713 29613.9360   20  459 20669.9410 33947.6015  64.2%  5581 1475s
  3964  2714 25750.0743   30  449 20669.9410 33947.6015  64.2%  5578 1486s
  3966  2715 30194.0003    9  458 20669.9410 33947.6015  64.2%  5575 1494s
  3967  2716 28796.2682   29  458 20669.9410 33947.6015  64.2%  5574 1545s
  3968  2717 23472.9103   27  458 20669.9410 33947.6015  64.2%  5572 1583s
  3969  2720 33947.6015   14  437 20669.9410 33947.6015  64.2%  5651 1629s
  3971  2724 33947.6015   15  435 20669.9410 33947.6015  64.2%  5653 1642s
  3975  2730 33947.6015   16  438 20669.9410 33947.6015  64.2%  5656 1667s
  3983  2744 33947.6015   17  493 20669.9410 33947.6015  64.2%  5670 1689s
  3999  2752 32621.2627   18  394 20669.9410 33947.6015  64.2%  5725 1722s
  4015  2778 31458.8708   19  418 20669.9410 33947.6015  64.2%  5763 1757s
  4047  2873 30610.5038   20  418 20669.9410 33947.6015  64.2%  5786 1782s
  4159  2888 30135.2032   23  356 20669.9410 33947.6015  64.2%  5827 1798s
  4211  2931 30145.8089   23  449 20669.9410 33947.6015  64.2%  5809 1814s
  4277  2958 27348.3509   24  299 20669.9410 33947.6015  64.2%  5787 1831s
  4343  2966 29956.7099   24  382 20669.9410 33947.6015  64.2%  5761 1843s
  4381  2970 26429.4030   24  450 20669.9410 33947.6015  64.2%  5752 1860s
  4420  2980 26925.7731   25  275 20669.9410 33947.6015  64.2%  5738 1889s
  4471  2989 25533.5192   28  214 20669.9410 33947.6015  64.2%  5720 1903s
  4520  2998 25070.6960   29  161 20669.9410 33947.6015  64.2%  5703 1917s
  4586  3002     cutoff   30      20669.9410 33947.6015  64.2%  5662 1929s
  4645  3013     cutoff   29      20669.9410 33947.6015  64.2%  5636 1944s
  4708  3017 25256.5542   30  349 20669.9410 33947.6015  64.2%  5608 1957s
  4771  3032 25226.3632   31  342 20669.9410 33947.6015  64.2%  5571 1969s
  4834  3028 22980.2879   34  362 20669.9410 33947.6015  64.2%  5541 1981s
  4892  3032     cutoff   35      20669.9410 33744.3676  63.3%  5515 2001s
  4947  3032 23322.7420   33  293 20669.9410 33496.5372  62.1%  5491 2015s
  4990  3032 23314.6620   34  305 20669.9410 33496.5372  62.1%  5483 2028s
  5040  3044 23085.2581   35  269 20669.9410 33496.5372  62.1%  5461 2042s
  5092  3064 21360.4341   36  133 20669.9410 33496.5372  62.1%  5442 2059s
  5148  3081     cutoff   37      20669.9410 33496.5372  62.1%  5418 2075s
  5211  3106 22689.5067   37  181 20669.9410 33496.5372  62.1%  5399 2093s
  5281  3122 22332.0269   38  263 20669.9410 33126.3674  60.3%  5374 2109s
  5342  3123 21537.2260   40  141 20669.9410 33126.3674  60.3%  5360 2125s
  5381  3128 21186.6228   41  139 20669.9410 33061.2414  59.9%  5353 2145s
  5440  3122     cutoff   42      20669.9410 33061.2414  59.9%  5333 2164s
  5499  3138 20806.2339   27   95 20669.9410 33061.2414  59.9%  5311 2179s
  5555  3162 20731.5377   28   65 20669.9410 33061.2414  59.9%  5298 2205s
  5623  3179     cutoff   29      20669.9410 33061.2414  59.9%  5271 2233s
  5711  3177 27679.1393   26  149 20669.9410 33061.2414  59.9%  5238 2259s
  5787  3191 26707.3942   27  128 20669.9410 33061.2414  59.9%  5225 2288s
  5857  3210 26442.9947   28  186 20669.9410 33061.2414  59.9%  5215 2309s
  5931  3247 26312.4181   29  193 20669.9410 33061.2414  59.9%  5216 2331s
  6031  3250 25938.9724   31  121 20669.9410 33061.2414  59.9%  5201 2355s
  6153  3255 24788.7886   33  198 20669.9410 33061.2414  59.9%  5176 2380s
  6277  3279 23293.7577   35  192 20669.9410 33061.2414  59.9%  5153 2405s
  6434  3299     cutoff   39      20669.9410 33061.2414  59.9%  5111 2436s
  6611  3306 25658.4097   24  438 20669.9410 33061.2414  59.9%  5075 2468s
  6753  3299 25268.7577   25  361 20669.9410 33061.2414  59.9%  5068 2500s
  6921  3316 21495.8249   27  272 20669.9410 31944.6345  54.5%  5048 2532s
  7097  3365 infeasible   33      20669.9410 30962.0675  49.8%  5031 2564s
  7298  3399 26943.1089   25  283 20669.9410 30962.0675  49.8%  4999 2598s
  7563  3416 23649.2509   28  251 20669.9410 30538.0605  47.7%  4932 2635s
  7799  3401 21292.0209   33  185 20669.9410 30538.0605  47.7%  4887 2672s
  8037  3394 23709.5038   25  376 20669.9410 30538.0605  47.7%  4856 2713s
  8275  3433 25342.3580   27  244 20669.9410 30538.0605  47.7%  4834 2749s
  8537  3470 21294.4190   31  244 20669.9410 30194.9265  46.1%  4798 2790s
  8808  3496 27083.4744   24  324 20669.9410 30112.5557  45.7%  4768 2834s
  9087  3530 24997.2703   30  251 20669.9410 30112.5557  45.7%  4746 2880s
  9404  3515 21765.2109   43  115 20669.9410 30112.5557  45.7%  4709 2925s
  9695  3524 21269.0077   32  232 20669.9410 29837.9182  44.4%  4694 2974s
  9991  3516 21657.9192   34  213 20669.9410 29627.8568  43.3%  4683 3024s
 10336  3529 24497.7438   28  303 20669.9410 29241.9330  41.5%  4656 3071s
 10681  3571 21466.7871   38  266 20669.9410 29015.6984  40.4%  4636 3120s
 11043  3599 23063.9090   28  323 20669.9410 28780.8857  39.2%  4614 3174s
 11498  3575 21816.3627   23  325 20669.9410 28746.6597  39.1%  4563 3232s
 11855  3580     cutoff   23      20669.9410 28451.9002  37.6%  4559 3291s
 12253  3635 21167.4647   31  251 20669.9410 28451.9002  37.6%  4540 3362s
 12703  3819 24789.2660   28  289 20669.9410 28325.8621  37.0%  4512 3428s
 13237  4003 23800.5437   23  297 20669.9410 28080.3931  35.9%  4466 3493s
 13692  4148 25468.5165   26  369 20669.9410 27950.3611  35.2%  4450 3567s
 14260  4205 25883.9065   29  379 20669.9410 27815.4841  34.6%  4406 3600s

Cutting planes:
  Learned: 1
  Projected implied bound: 59
  MIR: 1047
  Mixing: 2
  Flow cover: 2298
  RLT: 40
  Relax-and-lift: 169

Explored 14551 nodes (64159213 simplex iterations) in 3600.04 seconds (10585.24 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 20669.9 20598.2 20563.8 ... 19843.3

Time limit reached
Best objective 2.066994097441e+04, best bound 2.779316390666e+04, gap 34.4617%
  WARNING: Time limit reached. Using best solution found (gap: 34.46%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.05s
  Master Objective (UB) = 20669.94, θ = 166446.53
  Upper Bound (UB) = 20669.94

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 166446.53
  [DEBUG]   ✓ Scenario 0: θ = 166446.53 ≤ Q = 166446.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 166446.53 ≤ Q = 166446.53 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 166446.53 ≤ Q = 166446.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 166446.53 ≤ Q = 166768.53 (slack: 322.00)
  [DEBUG]   ✓ Scenario 4: θ = 166446.53 ≤ Q = 166446.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 166446.53 ≤ Q = 166446.53 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 166446.53 ≤ Q = 166446.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 166446.53 ≤ Q = 166446.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 166446.53 ≤ Q = 166446.53 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x779fd4e
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xf88602b2
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.335036e+13
Presolve removed 2581 rows and 1873 columns
Presolve time: 0.00s
Presolved: 512 rows, 516 columns, 1444 nonzeros
Found heuristic solution: objective 6777973.2532
Variable types: 350 continuous, 166 integer (166 binary)

Root relaxation: objective -1.458825e+05, 248 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -145882.51    0  123 6777973.25 -145882.51   102%     -    0s
H    0     0                    -110440.0517 -145882.51  32.1%     -    0s
H    0     0                    -111697.8217 -145882.51  30.6%     -    0s
H    0     0                    -115909.1913 -117992.54  1.80%     -    0s
     0     0 -117992.54    0   59 -115909.19 -117992.54  1.80%     -    0s
H    0     0                    -116592.1273 -117888.36  1.11%     -    0s
H    0     0                    -116934.7676 -117888.36  0.82%     -    0s
     0     0 -117627.79    0   54 -116934.77 -117627.79  0.59%     -    0s
H    0     0                    -116944.2378 -117619.59  0.58%     -    0s
     0     0 -117510.39    0   52 -116944.24 -117510.39  0.48%     -    0s
     0     0 -117510.39    0   52 -116944.24 -117510.39  0.48%     -    0s
     0     0 -117272.24    0   44 -116944.24 -117272.24  0.28%     -    0s
     0     0 -117232.61    0   43 -116944.24 -117232.61  0.25%     -    0s
     0     0 -117230.76    0   44 -116944.24 -117230.76  0.25%     -    0s
     0     0 -117164.86    0   44 -116944.24 -117164.86  0.19%     -    0s
     0     0 -117164.86    0   48 -116944.24 -117164.86  0.19%     -    0s
     0     0 -117164.86    0   36 -116944.24 -117164.86  0.19%     -    0s
     0     0 -117158.75    0   36 -116944.24 -117158.75  0.18%     -    0s
     0     0 -117110.54    0   38 -116944.24 -117110.54  0.14%     -    0s
     0     0 -117104.18    0   37 -116944.24 -117104.18  0.14%     -    0s
     0     0 -117067.50    0   22 -116944.24 -117067.50  0.11%     -    0s
     0     0 -117055.24    0   18 -116944.24 -117055.24  0.09%     -    0s
     0     0 -117054.78    0   17 -116944.24 -117054.78  0.09%     -    0s
H    0     0                    -116968.2761 -117053.35  0.07%     -    0s
     0     0 -117053.35    0   17 -116968.28 -117053.35  0.07%     -    0s
     0     0 -116972.23    0    2 -116968.28 -116972.23  0.00%     -    0s
*    0     0               0    -116968.8113 -116968.81  0.00%     -    0s

Cutting planes:
  Gomory: 7
  Implied bound: 5
  MIR: 46
  Flow cover: 12
  RLT: 1
  Relax-and-lift: 4

Explored 1 nodes (870 simplex iterations) in 0.11 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -116969 -116968 -116944 ... 1.33504e+13
No other solutions better than -116969

Optimal solution found (tolerance 1.00e-06)
Best objective -1.169688112668e+05, best bound -1.169688112668e+05, gap 0.0000%
  Subproblem solved in 0.13s
  Worst-case operational profit (Z_SP) = 163179.57
  Scenario: 23 demand increases, 37 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -116968.81
  [DEBUG]   S×d_nominal = 280148.38
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 280148.38 + -116968.81 = 163179.57
  [DEBUG]   Current θ from Master = 166446.53
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3266.97 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 17402.98
  Lower Bound (LB) = 19998.82
  Gap (UB-LB) = 671.1207, Absolute Gap = 671.1207, Relative Gap = 0.032468
  Not converged yet (gap = 671.12 > ε = 200)

  [DEBUG] Adding NEW scenario 9 to Master Problem...
  [DEBUG] New scenario pattern: 23 increases, 37 decreases
    [DEBUG] Scenario 9 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 9 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 9]
    [DEBUG]   - Total constraints in model: 154283
    [DEBUG]   - Total variables in model: 64660
  [DEBUG] Total scenarios in Master: 10
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 10
================================================================================
[Iteration 10] Solving Master Problem...
  Current scenarios in Master: 10
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 154283 rows, 64660 columns and 437919 nonzeros
Model fingerprint: 0xf7534601
Variable types: 62401 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 67790 rows and 27530 columns
Presolve time: 1.31s
Presolved: 86493 rows, 37130 columns, 528309 nonzeros
Variable types: 34871 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -362996.9195
Found heuristic solution: objective -215351.9614

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.17s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.674e+06
 Factor NZ  : 7.911e+06 (roughly 110 MB of memory)
 Factor Ops : 1.333e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.54266049e+07  1.60412753e+08  8.73e+04 2.52e+01  6.74e+04     4s
   1  -1.14940828e+07  1.41236326e+08  5.98e+04 5.16e+01  4.58e+04     4s
   2  -3.90660081e+06  1.06258375e+08  2.04e+04 1.07e-11  1.65e+04     4s
   3  -7.31978052e+05  7.28901745e+07  1.43e+03 1.23e+00  1.53e+03     4s
   4  -4.56320979e+05  3.60444825e+07  3.26e+02 4.72e-01  4.47e+02     4s
   5  -3.49468056e+05  2.18340908e+07  1.04e+02 2.42e-01  2.01e+02     4s
   6  -2.84228125e+05  1.52175607e+07  4.58e+01 1.58e-01  1.21e+02     4s
   7  -1.56455586e+05  1.10742631e+07  1.16e+01 1.09e-01  7.57e+01     4s
   8  -1.06133610e+05  4.66913906e+06  6.11e+00 4.29e-02  3.14e+01     4s
   9  -6.27405610e+04  2.44283965e+06  2.82e+00 2.17e-02  1.61e+01     4s
  10  -3.14901221e+04  7.03882540e+05  1.21e+00 5.83e-03  4.68e+00     5s
  11  -2.41937643e+03  3.16955927e+05  5.63e-01 2.49e-03  2.02e+00     5s
  12   5.61966027e+03  1.79184110e+05  3.91e-01 1.27e-03  1.10e+00     5s
  13   1.10113874e+04  1.43960766e+05  3.02e-01 8.92e-04  8.41e-01     5s
  14   1.68014777e+04  1.09439622e+05  2.36e-01 1.22e-03  5.86e-01     5s
  15   2.21599272e+04  9.33426755e+04  1.90e-01 1.24e-03  4.50e-01     5s
  16   2.63613990e+04  8.29231649e+04  1.57e-01 1.32e-03  3.58e-01     5s
  17   3.00654921e+04  7.32971440e+04  1.26e-01 1.55e-03  2.73e-01     5s
  18   3.48862100e+04  6.50887159e+04  8.99e-02 1.46e-03  1.91e-01     5s
  19   3.56655318e+04  6.34337897e+04  8.33e-02 1.40e-03  1.76e-01     5s
  20   3.84860867e+04  5.82088016e+04  6.39e-02 2.17e-03  1.25e-01     5s
  21   4.05770899e+04  5.63679638e+04  4.99e-02 1.94e-03  9.98e-02     5s
  22   4.16071099e+04  5.38056434e+04  4.31e-02 1.67e-03  7.71e-02     5s
  23   4.30865791e+04  5.23179392e+04  3.35e-02 1.54e-03  5.84e-02     5s
  24   4.41386152e+04  5.15705218e+04  2.71e-02 1.11e-03  4.70e-02     5s
  25   4.47511175e+04  5.06676851e+04  2.34e-02 7.53e-04  3.74e-02     5s
  26   4.54374856e+04  5.02319874e+04  1.91e-02 5.98e-04  3.03e-02     5s
  27   4.59612016e+04  4.98845320e+04  1.58e-02 4.70e-04  2.48e-02     5s
  28   4.62015631e+04  4.98100014e+04  1.44e-02 4.40e-04  2.28e-02     5s
  29   4.67960301e+04  4.95725687e+04  1.08e-02 3.50e-04  1.76e-02     5s
  30   4.70853412e+04  4.93022105e+04  9.09e-03 3.33e-04  1.40e-02     5s
  31   4.73563210e+04  4.91009984e+04  7.54e-03 2.16e-04  1.10e-02     5s
  32   4.74062811e+04  4.90738059e+04  7.26e-03 2.01e-04  1.06e-02     5s
  33   4.74678429e+04  4.90184531e+04  6.91e-03 1.72e-04  9.82e-03     6s
  34   4.77327596e+04  4.89613704e+04  5.34e-03 1.45e-04  7.78e-03     6s
  35   4.78263960e+04  4.89424275e+04  4.81e-03 1.36e-04  7.06e-03     6s
  36   4.79389798e+04  4.88127657e+04  4.12e-03 6.75e-05  5.53e-03     6s
  37   4.80812305e+04  4.87506309e+04  3.30e-03 7.93e-05  4.24e-03     6s
  38   4.81859732e+04  4.87203696e+04  2.70e-03 7.06e-05  3.39e-03     6s
  39   4.82517721e+04  4.87182528e+04  2.34e-03 6.69e-05  2.95e-03     6s
  40   4.83100543e+04  4.87108400e+04  2.02e-03 5.30e-05  2.54e-03     6s
  41   4.84291334e+04  4.87004069e+04  1.37e-03 7.80e-05  1.72e-03     6s
  42   4.84703919e+04  4.86970568e+04  1.14e-03 7.06e-05  1.44e-03     6s
  43   4.85050887e+04  4.86927103e+04  9.49e-04 5.73e-05  1.19e-03     6s
  44   4.85389794e+04  4.86874236e+04  7.50e-04 4.28e-05  9.40e-04     6s
  45   4.85728194e+04  4.86818884e+04  5.52e-04 2.69e-05  6.91e-04     6s
  46   4.85857872e+04  4.86789068e+04  4.76e-04 1.83e-05  5.90e-04     6s
  47   4.86074875e+04  4.86760804e+04  3.54e-04 8.97e-06  4.35e-04     6s
  48   4.86187846e+04  4.86754123e+04  2.92e-04 7.31e-06  3.59e-04     6s
  49   4.86389966e+04  4.86750846e+04  1.81e-04 6.02e-06  2.29e-04     6s
  50   4.86682282e+04  4.86738286e+04  2.00e-05 3.77e-06  3.54e-05     6s
  51   4.86716569e+04  4.86731370e+04  5.53e-06 4.33e-07  9.36e-06     6s
  52   4.86725222e+04  4.86730244e+04  1.81e-06 1.14e-07  3.18e-06     7s
  53   4.86729510e+04  4.86729930e+04  2.57e-07 2.81e-08  2.66e-07     7s
  54   4.86729813e+04  4.86729840e+04  1.89e-08 4.73e-09  1.71e-08     7s
  55   4.86729817e+04  4.86729830e+04  2.65e-07 7.41e-09  8.36e-09     7s
  56   4.86729818e+04  4.86729830e+04  2.33e-07 7.15e-09  7.46e-09     7s
  57   4.86729822e+04  4.86729824e+04  4.14e-07 8.15e-09  1.19e-09     7s

Barrier solved model in 57 iterations and 6.73 seconds (8.43 work units)
Optimal objective 4.86729822e+04


Root crossover log...

   74999 DPushes remaining with DInf 0.0000000e+00                 7s
       0 DPushes remaining with DInf 0.0000000e+00                10s

    5601 PPushes remaining with PInf 6.2375892e-05                10s
    1454 PPushes remaining with PInf 1.7599648e-05                10s
       0 PPushes remaining with PInf 0.0000000e+00                10s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.7638477e+01     10s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   41620    4.8672982e+04   0.000000e+00   2.763848e+01     10s
   41815    4.8672982e+04   0.000000e+00   0.000000e+00     10s
   41815    4.8672982e+04   0.000000e+00   0.000000e+00     10s
Concurrent spin time: 0.50s

Solved with barrier

Root relaxation: objective 4.867298e+04, 41815 iterations, 7.49 seconds (16.17 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 48672.9823    0  235 -215351.96 48672.9823   123%     -   11s
H    0     0                    -210546.3612 48672.9823   123%     -   11s
H    0     0                    -154939.7092 48672.9823   131%     -   11s
H    0     0                    -62506.15441 48672.9823   178%     -   12s
H    0     0                    -45133.28095 48672.9823   208%     -   12s
H    0     0                    -30509.62051 48672.9823   260%     -   12s
H    0     0                    7167.8874591 48672.9823   579%     -   12s
H    0     0                    7613.7492150 48672.9823   539%     -   14s
H    0     0                    7784.3729085 44255.4042   469%     -   44s
     0     0 44250.0140    0  420 7784.37291 44250.0140   468%     -   45s
     0     0 43898.1258    0  409 7784.37291 43898.1258   464%     -   61s
     0     0 43758.9185    0  464 7784.37291 43758.9185   462%     -   71s
     0     0 43660.7225    0  457 7784.37291 43660.7225   461%     -   77s
     0     0 43660.1007    0  459 7784.37291 43660.1007   461%     -   84s
     0     0 43660.1007    0  465 7784.37291 43660.1007   461%     -   86s
     0     0 43660.1007    0  477 7784.37291 43660.1007   461%     -   88s
     0     0 43657.7982    0  478 7784.37291 43657.7982   461%     -   89s
     0     0 43657.7299    0  480 7784.37291 43657.7299   461%     -   89s
H    0     0                    8106.1845238 40754.1637   403%     -  114s
H    0     0                    8341.6282127 40754.1637   389%     -  114s
     0     0 40718.2213    0  232 8341.62821 40718.2213   388%     -  114s
H    0     0                    10198.280725 40718.2213   299%     -  114s
H    0     0                    10981.786625 40718.2213   271%     -  114s
     0     0 39938.6213    0  402 10981.7866 39938.6213   264%     -  137s
     0     0 39711.8216    0  385 10981.7866 39711.8216   262%     -  148s
     0     0 39685.4508    0  378 10981.7866 39685.4508   261%     -  154s
     0     0 39664.8451    0  384 10981.7866 39664.8451   261%     -  159s
     0     0 39638.3898    0  377 10981.7866 39638.3898   261%     -  162s
     0     0 39615.0344    0  388 10981.7866 39615.0344   261%     -  165s
     0     0 39601.3774    0  376 10981.7866 39601.3774   261%     -  168s
     0     0 39477.1588    0  394 10981.7866 39477.1588   259%     -  181s
     0     0 39457.6796    0  390 10981.7866 39457.6796   259%     -  185s
     0     0 39448.1626    0  390 10981.7866 39448.1626   259%     -  189s
     0     0 39412.2120    0  381 10981.7866 39412.2120   259%     -  194s
     0     0 39334.0944    0  380 10981.7866 39334.0944   258%     -  200s
     0     0 39324.1525    0  390 10981.7866 39324.1525   258%     -  202s
     0     0 39322.2375    0  384 10981.7866 39322.2375   258%     -  203s
     0     0 39322.1916    0  384 10981.7866 39322.1916   258%     -  203s
H    0     0                    11972.047810 39322.1916   228%     -  216s
H    0     0                    13111.633834 39322.1916   200%     -  216s
H    0     0                    16423.271326 39322.1916   139%     -  216s
H    0     0                    16651.345946 37758.1044   127%     -  242s
     0     0 37758.1044    0  310 16651.3459 37758.1044   127%     -  242s
H    0     0                    17138.350759 37758.0917   120%     -  243s
H    0     0                    17317.280266 37758.0917   118%     -  243s
     0     0 37412.3944    0  450 17317.2803 37412.3944   116%     -  260s
     0     0 37292.0096    0  363 17317.2803 37292.0096   115%     -  272s
     0     0 37259.2040    0  368 17317.2803 37259.2040   115%     -  278s
     0     0 37239.3538    0  369 17317.2803 37239.3538   115%     -  282s
     0     0 37121.7045    0  368 17317.2803 37121.7045   114%     -  289s
     0     0 37093.2410    0  372 17317.2803 37093.2410   114%     -  293s
     0     0 37090.6820    0  372 17317.2803 37090.6820   114%     -  295s
     0     0 37081.8654    0  373 17317.2803 37081.8654   114%     -  298s
     0     0 37068.6043    0  374 17317.2803 37068.6043   114%     -  303s
     0     0 37062.8335    0  378 17317.2803 37062.8335   114%     -  306s
     0     0 37048.2480    0  377 17317.2803 37048.2480   114%     -  307s
     0     0 37038.1710    0  380 17317.2803 37038.1710   114%     -  310s
     0     0 37031.7899    0  459 17317.2803 37031.7899   114%     -  314s
     0     0 37020.6863    0  376 17317.2803 37020.6863   114%     -  315s
     0     0 37018.7124    0  380 17317.2803 37018.7124   114%     -  317s
     0     0 36995.8114    0  378 17317.2803 36995.8114   114%     -  319s
     0     0 36993.1826    0  384 17317.2803 36993.1826   114%     -  321s
     0     0 36992.9387    0  384 17317.2803 36992.9387   114%     -  322s
     0     0 36565.6053    0  403 17317.2803 36565.6053   111%     -  347s
     0     0 36417.4175    0  480 17317.2803 36417.4175   110%     -  358s
     0     0 36371.7064    0  480 17317.2803 36371.7064   110%     -  365s
     0     0 36355.3196    0  412 17317.2803 36355.3196   110%     -  369s
H    0     0                    17390.826264 36341.9982   109%     -  373s
     0     0 36341.9982    0  552 17390.8263 36341.9982   109%     -  373s
     0     0 36336.0777    0  488 17390.8263 36336.0777   109%     -  375s
     0     0 36332.3006    0  492 17390.8263 36332.3006   109%     -  378s
     0     0 36329.6010    0  547 17390.8263 36329.6010   109%     -  382s
     0     0 36328.8159    0  549 17390.8263 36328.8159   109%     -  383s
H    0     0                    17409.755899 36291.1063   108%     -  390s
H    0     0                    17444.831544 36291.1063   108%     -  390s
H    0     0                    17457.424276 36291.1063   108%     -  390s
     0     0 36291.1063    0  487 17457.4243 36291.1063   108%     -  390s
     0     0 36277.4957    0  429 17457.4243 36277.4957   108%     -  394s
     0     0 36265.9525    0  421 17457.4243 36265.9525   108%     -  396s
     0     0 36264.0081    0  427 17457.4243 36264.0081   108%     -  397s
     0     0 36263.1515    0  425 17457.4243 36263.1515   108%     -  398s
     0     0 36240.6581    0  413 17457.4243 36240.6581   108%     -  403s
H    0     0                    17698.112085 36240.5978   105%     -  407s
     0     0 36234.0469    0  420 17698.1121 36234.0469   105%     -  409s
     0     0 36232.3443    0  423 17698.1121 36232.3443   105%     -  410s
     0     0 36162.0231    0  415 17698.1121 36162.0231   104%     -  416s
H    0     0                    17805.078519 36161.8020   103%     -  416s
H    0     0                    17851.523067 36161.8020   103%     -  416s
     0     0 36141.6099    0  419 17851.5231 36141.6099   102%     -  418s
     0     0 36134.1687    0  429 17851.5231 36134.1687   102%     -  421s
     0     0 36124.0530    0  428 17851.5231 36124.0530   102%     -  423s
     0     0 36119.9846    0  432 17851.5231 36119.9846   102%     -  425s
     0     0 36118.2457    0  432 17851.5231 36118.2457   102%     -  427s
     0     0 36117.4673    0  431 17851.5231 36117.4673   102%     -  428s
     0     0 36048.1548    0  423 17851.5231 36048.1548   102%     -  437s
     0     0 36036.5119    0  435 17851.5231 36036.5119   102%     -  441s
     0     0 36032.0445    0  427 17851.5231 36032.0445   102%     -  443s
     0     0 36030.8806    0  431 17851.5231 36030.8806   102%     -  444s
     0     0 36025.7435    0  488 17851.5231 36025.7435   102%     -  447s
     0     0 36021.9264    0  597 17851.5231 36021.9264   102%     -  449s
     0     0 36021.5685    0  640 17851.5231 36021.5685   102%     -  450s
     0     0 36013.6163    0  516 17851.5231 36013.6163   102%     -  454s
H    0     0                    18124.701094 36013.5721  98.7%     -  460s
H    0     0                    18213.710718 36013.5721  97.7%     -  461s
H    0     0                    18616.535060 36013.5721  93.4%     -  462s
H    0     0                    19849.536827 36013.5721  81.4%     -  462s
H    0     0                    20407.327159 36013.5721  76.5%     -  462s
H    0     0                    20412.407284 36013.5721  76.4%     -  463s
H    0     0                    20462.568330 36013.5721  76.0%     -  463s
H    0     0                    20512.403357 36013.5721  75.6%     -  463s
H    0     0                    20519.570259 36013.5721  75.5%     -  463s
     0     0 36009.4045    0  441 20519.5703 36009.4045  75.5%     -  465s
     0     0 36008.9875    0  445 20519.5703 36008.9875  75.5%     -  466s
     0     0 36001.7616    0  436 20519.5703 36001.7616  75.5%     -  469s
H    0     0                    20524.650384 36001.6577  75.4%     -  470s
     0     0 35984.9722    0  445 20524.6504 35984.9722  75.3%     -  472s
     0     0 35970.5313    0  435 20524.6504 35970.5313  75.3%     -  474s
     0     0 35965.4004    0  443 20524.6504 35965.4004  75.2%     -  476s
     0     0 35964.7141    0  442 20524.6504 35964.7141  75.2%     -  477s
     0     0 35951.2804    0  486 20524.6504 35951.2804  75.2%     -  480s
H    0     0                    20563.809196 35950.9000  74.8%     -  491s
     0     0 35944.2761    0  439 20563.8092 35944.2761  74.8%     -  495s
     0     0 35941.7253    0  434 20563.8092 35941.7253  74.8%     -  496s
     0     0 35937.0097    0  599 20563.8092 35937.0097  74.8%     -  499s
     0     0 35936.2704    0  437 20563.8092 35936.2704  74.8%     -  500s
     0     0 35934.7224    0  436 20563.8092 35934.7224  74.7%     -  502s
     0     0 35929.1284    0  522 20563.8092 35929.1284  74.7%     -  505s
     0     0 35928.8351    0  516 20563.8092 35928.8351  74.7%     -  505s
     0     0 35925.8344    0  502 20563.8092 35925.8344  74.7%     -  508s
     0     0 35924.9597    0  505 20563.8092 35924.9597  74.7%     -  510s
     0     0 35919.7904    0  503 20563.8092 35919.7904  74.7%     -  514s
     0     0 35913.2099    0  437 20563.8092 35913.2099  74.6%     -  515s
     0     0 35912.1310    0  439 20563.8092 35912.1310  74.6%     -  517s
     0     0 35908.5287    0  438 20563.8092 35908.5287  74.6%     -  519s
     0     0 35908.3298    0  438 20563.8092 35908.3298  74.6%     -  521s
     0     2 35908.3298    0  438 20563.8092 35908.3298  74.6%     -  603s
     1     4 35877.1594    1  496 20563.8092 35907.6201  74.6%  2559  613s
     3     6 35424.8113    2  415 20563.8092 35876.2500  74.5%  9145  625s
     5    12 35019.3376    3  409 20563.8092 35876.2500  74.5% 10176  634s
    11    19 32505.0656    4  299 20563.8092 35446.2659  72.4%  9690  657s
    18    26 31218.0581    4  369 20563.8092 35446.2659  72.4% 16625  685s
    25    48 33980.9198    4  606 20563.8092 34846.2768  69.5% 14930  728s
    47    79 33434.1789    5  526 20563.8092 34766.4504  69.1% 15740  755s
    78   176 33355.9649    6  529 20563.8092 34766.1209  69.1% 15913  782s
   175   275 31735.0010    9  351 20563.8092 34766.1209  69.1%  9573  798s
   274   306 33252.8219    8  458 20563.8092 34766.1209  69.1%  7225  811s
   305   334 33059.5594    9  478 20563.8092 34766.1209  69.1%  6936  822s
   333   359 33150.3971    9  392 20563.8092 34766.1209  69.1%  6603  834s
   360   383 33115.8997   10  386 20563.8092 34766.1209  69.1%  6502  847s
   388   403 32782.3575   10  387 20563.8092 34766.1209  69.1%  6410  859s
   412   430 32968.2649   11  440 20563.8092 34766.1209  69.1%  6291  874s
   439   454 32775.0391   12  512 20563.8092 34766.1209  69.1%  6236  887s
   469   479 32694.2573   13  525 20563.8092 34766.1209  69.1%  6105  901s
   504   498 32621.2993   14  519 20563.8092 34766.1209  69.1%  5961  915s
   539   529 32567.4244   15  519 20563.8092 34682.2317  68.7%  5793  929s
   570   552 29883.0457   21  361 20563.8092 34682.2317  68.7%  5761  943s
   605   582 32533.5022   16  512 20563.8092 34682.2317  68.7%  5653  956s
   635   615 30587.8748   15  235 20563.8092 34682.2317  68.7%  5595  968s
   676   641 32439.9919   17  565 20563.8092 34682.2317  68.7%  5482  981s
   716   681 32438.5842   18  561 20563.8092 34682.2317  68.7%  5366  994s
   760   718 32213.8578   19  569 20563.8092 34479.6362  67.7%  5283 1010s
   797   761 32097.3811   20  571 20563.8092 34479.6362  67.7%  5292 1023s
   850   800 26366.9589   20  231 20563.8092 34479.6362  67.7%  5158 1046s
   895   857 31675.6635   21  572 20563.8092 34479.6362  67.7%  5071 1067s
   968   893 25748.8165   22  209 20563.8092 34479.6362  67.7%  4892 1083s
  1036   941 31429.5284   22  569 20563.8092 34479.6362  67.7%  4729 1101s
  1116   990 25370.8193   42  311 20563.8092 34479.6362  67.7%  4633 1120s
  1185  1049 27896.6011   22  577 20563.8092 34479.6362  67.7%  4581 1139s
  1268  1117 29789.1809   23  546 20563.8092 34479.6362  67.7%  4529 1158s
  1356  1199 28075.6634   23  549 20563.8092 34479.6362  67.7%  4413 1178s
  1468  1259 28824.4573   24  508 20563.8092 34157.5075  66.1%  4279 1198s
  1570  1340 25590.7456   24  479 20563.8092 34157.5075  66.1%  4233 1221s
  1671  1441 28763.4498   25  494 20563.8092 34157.5075  66.1%  4192 1243s
  1804  1520 28232.6981   27  464 20563.8092 33765.5167  64.2%  4098 1268s
  1952  1617 27332.9607   31  468 20563.8092 33765.5167  64.2%  3998 1292s
  2100  1662 27255.1255   32  481 20563.8092 33765.5167  64.2%  3905 1316s
  2227  1735 25706.0317   34  475 20563.8092 33557.6933  63.2%  3891 1342s
  2332  1827 25324.8677   37  416 20563.8092 33557.6933  63.2%  3940 1374s
  2446  1936 24743.3554   40  409 20563.8092 33557.6933  63.2%  3966 1407s
  2595  1990 24271.6633   45  224 20563.8092 33557.6933  63.2%  3941 1438s
  2677  2063 23942.9676   49  222 20563.8092 33431.2121  62.6%  3926 1469s
  2808  2169 23525.0362   61  253 20563.8092 33431.2121  62.6%  3900 1505s
  2996  2256 22523.6174   73   94 20563.8092 33420.0350  62.5%  3841 1540s
  3161  2403     cutoff   82      20563.8092 33420.0350  62.5%  3795 1581s
  3392  2527 30452.0629   14  567 20563.8092 33415.6301  62.5%  3737 1615s
  3582  2667 28862.9503   16  542 20563.8092 33415.6301  62.5%  3728 1650s
  3794  2668 22083.7023   29  438 20563.8092 33415.6301  62.5%  3721 1877s
  3796  2669 23707.4905   52  243 20563.8092 33415.6301  62.5%  3719 1896s
  3797  2670 27081.9783   30  465 20563.8092 33415.6301  62.5%  3718 1948s
  3798  2671 21608.0272   64  418 20563.8092 33415.6301  62.5%  3717 1991s
  3799  2671 30174.4616   14  438 20563.8092 33415.6301  62.5%  3716 2023s
  3800  2672 31335.9658   14  417 20563.8092 33415.6301  62.5%  3715 2039s
  3801  2673 27091.1092   44  480 20563.8092 33415.6301  62.5%  3714 2052s
  3802  2673 31486.5082   16  415 20563.8092 33415.6301  62.5%  3713 2065s
  3803  2674 22376.3223   30  425 20563.8092 33415.6301  62.5%  3712 2071s
  3804  2675 30414.3384   11  421 20563.8092 33415.6301  62.5%  3712 2077s
  3805  2675 30977.3425   12  420 20563.8092 33415.6301  62.5%  3711 2084s
  3806  2676 27096.4189   25  426 20563.8092 33415.6301  62.5%  3710 2089s
  3807  2677 28607.6251   28  433 20563.8092 33415.6301  62.5%  3709 2103s
  3808  2677 24671.8924   16  424 20563.8092 33415.6301  62.5%  3708 2111s
  3809  2678 21610.7154   58  447 20563.8092 33415.6301  62.5%  3707 2118s
  3810  2679 31085.4738    7  445 20563.8092 33415.6301  62.5%  3706 2122s
  3811  2679 28322.4217   27  516 20563.8092 33415.6301  62.5%  3705 2133s
  3812  2680 21463.7963   83  490 20563.8092 33415.6301  62.5%  3704 2138s
  3813  2681 26963.1759   34  493 20563.8092 33415.6301  62.5%  3703 2144s
  3814  2681 28858.4446   12  477 20563.8092 33415.6301  62.5%  3702 2155s
  3815  2682 21982.6886   23  584 20563.8092 33415.6301  62.5%  3701 2162s
  3816  2683 23589.2629   17  495 20563.8092 33415.6301  62.5%  3700 2167s
  3817  2683 29687.3027   17  488 20563.8092 33415.6301  62.5%  3699 2171s
  3818  2684 26139.3229   20  422 20563.8092 33415.6301  62.5%  3698 2181s
  3819  2685 26758.7341   41  472 20563.8092 33415.6301  62.5%  3697 2186s
  3820  2685 27266.7728   24  560 20563.8092 33415.6301  62.5%  3696 2203s
  3821  2686 31232.6005   13  621 20563.8092 33415.6301  62.5%  3695 2210s
  3822  2687 23756.7005   20  617 20563.8092 33415.6301  62.5%  3694 2216s
  3823  2687 31803.1151   11  554 20563.8092 33415.6301  62.5%  3693 2222s
  3824  2688 31469.6173   13  472 20563.8092 33415.6301  62.5%  3692 2232s
  3825  2689 22037.9356   63  480 20563.8092 33415.6301  62.5%  3691 2238s
  3826  2689 26917.5609   37  483 20563.8092 33415.6301  62.5%  3690 2242s
  3827  2690 32495.4231   18  488 20563.8092 33415.6301  62.5%  3689 2252s
  3828  2691 28879.6102   16  491 20563.8092 33415.6301  62.5%  3688 2256s
  3829  2691 21982.6886   23  555 20563.8092 33415.6301  62.5%  3687 2262s
  3830  2692 22483.1629   51  559 20563.8092 33415.6301  62.5%  3686 2269s
  3831  2693 24170.5565   62  487 20563.8092 33415.6301  62.5%  3685 2271s
  3832  2693 25390.5843   62  474 20563.8092 33415.6301  62.5%  3684 2279s
  3833  2694 22981.1621   26  581 20563.8092 33415.6301  62.5%  3683 2283s
  3834  2695 21795.6305   58  527 20563.8092 33415.6301  62.5%  3682 2287s
  3835  2695 24014.1805   48  478 20563.8092 33415.6301  62.5%  3682 2294s
  3836  2696 29971.8230   14  478 20563.8092 33415.6301  62.5%  3681 2335s
  3837  2697 22002.7274   54  478 20563.8092 33415.6301  62.5%  3680 2396s
  3838  2700 33415.6301   12  538 20563.8092 33415.6301  62.5%  3789 2461s
  3840  2704 33415.6301   13  544 20563.8092 33415.6301  62.5%  3793 2497s
  3844  2710 33415.6301   14  549 20563.8092 33415.6301  62.5%  3811 2524s
  3852  2724 33415.6301   15  584 20563.8092 33415.6301  62.5%  3825 2566s
  3868  2735 29846.1878   16  406 20563.8092 33415.6301  62.5%  3916 2622s
  3885  2762 31909.2857   17  495 20563.8092 33415.6301  62.5%  3968 2652s
  3917  2853 29712.2873   18  491 20563.8092 33415.6301  62.5%  4003 2689s
  4024  2840 29568.6653   19  491 20563.8092 33415.6301  62.5%  4051 2707s
  4061  2855 28724.3368   19  520 20563.8092 33415.6301  62.5%  4071 2723s
  4095  2872 28167.6969   20  507 20563.8092 33415.6301  62.5%  4079 2746s
  4131  2882 28387.4538   20  391 20563.8092 33415.6301  62.5%  4086 2765s
  4170  2897 29542.4228   20  481 20563.8092 33415.6301  62.5%  4094 2783s
  4210  2907 27868.4101   21  363 20563.8092 33415.6301  62.5%  4104 2801s
  4253  2918 28075.2131   20  374 20563.8092 33415.6301  62.5%  4109 2819s
  4301  2914 28057.7341   21  411 20563.8092 33415.6301  62.5%  4112 2848s
  4358  2923 27750.1848   22  290 20563.8092 33415.6301  62.5%  4107 2865s
  4408  2930 26892.5224   23  273 20563.8092 33415.6301  62.5%  4111 2885s
  4467  2948 26547.7735   24  234 20563.8092 33415.6301  62.5%  4108 2906s
  4540  2943 26308.6297   25  128 20563.8092 33415.6301  62.5%  4098 2925s
  4598  2951 26160.7221   26  128 20563.8092 33415.6301  62.5%  4103 2953s
  4673  2957 25950.4623   27  131 20563.8092 33415.6301  62.5%  4087 2971s
  4742  2968     cutoff   27      20563.8092 33288.5274  61.9%  4083 2994s
  4813  2983 infeasible   28      20563.8092 33288.5274  61.9%  4077 3012s
  4897  3003 25459.0039   30  351 20563.8092 33288.5274  61.9%  4056 3036s
  4988  2996 25364.7882   31  412 20563.8092 33288.5274  61.9%  4038 3058s
  5055  3016 25318.7927   32  408 20563.8092 33288.5274  61.9%  4038 3080s
  5129  3046 25238.7415   34  387 20563.8092 33288.5274  61.9%  4033 3109s
  5223  3081 24897.1105   38  375 20563.8092 33233.9164  61.6%  4032 3134s
  5331  3096     cutoff   37      20563.8092 32768.4480  59.4%  4030 3158s
  5432  3113 23955.6437   39  360 20563.8092 32768.4480  59.4%  4031 3185s
  5536  3132 23669.7613   43  281 20563.8092 32768.4480  59.4%  4031 3216s
  5651  3150 23477.0929   47  187 20563.8092 32768.4480  59.4%  4032 3243s
  5749  3173 22891.7963   52  173 20563.8092 32768.4480  59.4%  4049 3270s
  5837  3158     cutoff   59      20563.8092 31798.4644  54.6%  4068 3296s
  5885  3167     cutoff   58      20563.8092 31798.4644  54.6%  4076 3321s
  5929  3182 22086.1943   61  224 20563.8092 31798.4644  54.6%  4089 3347s
  5967  3196     cutoff   61      20563.8092 31798.4644  54.6%  4101 3375s
  6022  3216 21999.1495   63  157 20563.8092 31798.4644  54.6%  4110 3402s
  6086  3239 21810.2574   64  284 20563.8092 31798.4644  54.6%  4109 3431s
  6180  3274     cutoff   63      20563.8092 31798.4644  54.6%  4111 3461s
  6281  3307 21721.2481   66  278 20563.8092 31798.4644  54.6%  4113 3498s
  6423  3318 infeasible   74      20563.8092 31798.4644  54.6%  4110 3541s
  6617  3338 27987.1211   23  521 20563.8092 31798.4644  54.6%  4098 3582s
  6799  3314 27605.7521   24  501 20563.8092 31798.4644  54.6%  4102 3600s

Cutting planes:
  Implied bound: 14
  Projected implied bound: 257
  MIR: 858
  Flow cover: 2148
  RLT: 50
  Relax-and-lift: 216

Explored 6895 nodes (28710989 simplex iterations) in 3600.03 seconds (9637.67 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 20563.8 20524.7 20519.6 ... 18213.7

Time limit reached
Best objective 2.056380919582e+04, best bound 3.179846437821e+04, gap 54.6331%
  WARNING: Time limit reached. Using best solution found (gap: 54.63%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = 20563.81, θ = 167867.04
  Upper Bound (UB) = 20563.81

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 167867.04
  [DEBUG]   ✓ Scenario 0: θ = 167867.04 ≤ Q = 167867.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 167867.04 ≤ Q = 167867.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 167867.04 ≤ Q = 167867.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 167867.04 ≤ Q = 167867.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 167867.04 ≤ Q = 167867.04 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 167867.04 ≤ Q = 167867.04 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 167867.04 ≤ Q = 167867.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 167867.04 ≤ Q = 167867.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 167867.04 ≤ Q = 167867.04 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 167867.04 ≤ Q = 167867.04 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 10] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x39add88a
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xc6522776
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.364454e+13
Presolve removed 2580 rows and 1872 columns
Presolve time: 0.00s
Presolved: 513 rows, 517 columns, 1447 nonzeros
Found heuristic solution: objective 6968665.4122
Variable types: 351 continuous, 166 integer (166 binary)

Root relaxation: objective -1.442752e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -144275.20    0  123 6968665.41 -144275.20   102%     -    0s
H    0     0                    -108770.8631 -144275.20  32.6%     -    0s
H    0     0                    -110037.3539 -144275.20  31.1%     -    0s
     0     0 -119575.34    0   28 -110037.35 -119575.34  8.67%     -    0s
H    0     0                    -118568.3363 -119491.63  0.78%     -    0s
H    0     0                    -118646.0527 -119025.61  0.32%     -    0s
     0     0 -119025.61    0   26 -118646.05 -119025.61  0.32%     -    0s
     0     0 -119016.49    0   25 -118646.05 -119016.49  0.31%     -    0s
     0     0 -118996.64    0   24 -118646.05 -118996.64  0.30%     -    0s
     0     0 -118960.51    0   21 -118646.05 -118960.51  0.27%     -    0s
     0     0 -118942.26    0   15 -118646.05 -118942.26  0.25%     -    0s
     0     0 -118941.49    0   14 -118646.05 -118941.49  0.25%     -    0s
H    0     0                    -118713.8712 -118915.63  0.17%     -    0s
     0     0 -118915.63    0   14 -118713.87 -118915.63  0.17%     -    0s
     0     0 -118896.36    0    7 -118713.87 -118896.36  0.15%     -    0s
     0     0 -118896.36    0   17 -118713.87 -118896.36  0.15%     -    0s
H    0     0                    -118742.4913 -118896.36  0.13%     -    0s
*    0     0               0    -118854.5925 -118854.59  0.00%     -    0s

Cutting planes:
  Gomory: 2
  MIR: 9
  Flow cover: 8

Explored 1 nodes (577 simplex iterations) in 0.06 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -118855 -118742 -118714 ... 1.36445e+13
No other solutions better than -118855

Optimal solution found (tolerance 1.00e-06)
Best objective -1.188545925148e+05, best bound -1.188545925148e+05, gap 0.0000%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 161293.79
  Scenario: 8 demand increases, 52 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -118854.59
  [DEBUG]   S×d_nominal = 280148.38
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 280148.38 + -118854.59 = 161293.79
  [DEBUG]   Current θ from Master = 167867.04
  [DEBUG]   ⚠️  Z_SP ≤ θ by 6573.25 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 13990.56
  Lower Bound (LB) = 19998.82
  Gap (UB-LB) = 564.9890, Absolute Gap = 564.9890, Relative Gap = 0.027475
  Not converged yet (gap = 564.99 > ε = 200)

  [DEBUG] Adding NEW scenario 10 to Master Problem...
  [DEBUG] New scenario pattern: 8 increases, 52 decreases
    [DEBUG] Scenario 10 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 10 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 10]
    [DEBUG]   - Total constraints in model: 169573
    [DEBUG]   - Total variables in model: 70900
  [DEBUG] Total scenarios in Master: 11
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 11
================================================================================
[Iteration 11] Solving Master Problem...
  Current scenarios in Master: 11
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 169573 rows, 70900 columns and 481159 nonzeros
Model fingerprint: 0x4f67ef07
Variable types: 68641 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 74577 rows and 30287 columns
Presolve time: 1.35s
Presolved: 94996 rows, 40613 columns, 576164 nonzeros
Variable types: 38354 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -367877.2666
Found heuristic solution: objective -215351.9614

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.19s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 4.176e+06
 Factor NZ  : 9.156e+06 (roughly 130 MB of memory)
 Factor Ops : 1.630e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.60610121e+07  1.74359501e+08  9.09e+04 2.31e+01  6.98e+04     3s
   1  -1.21067377e+07  1.54683396e+08  6.31e+04 5.17e+01  4.80e+04     3s
   2  -3.93545960e+06  1.15454677e+08  2.05e+04 2.46e-11  1.66e+04     3s
   3  -7.66857757e+05  8.22626946e+07  1.59e+03 1.16e+00  1.67e+03     3s
   4  -4.54404175e+05  3.05456281e+07  2.79e+02 2.55e-01  3.61e+02     3s
   5  -3.23398273e+05  2.17168088e+07  5.41e+01 1.66e-01  1.59e+02     3s
   6  -2.36364139e+05  1.53820693e+07  2.06e+01 1.12e-01  9.99e+01     3s
   7  -1.37338914e+05  1.06255917e+07  4.67e+00 7.50e-02  6.36e+01     3s
   8  -9.23365230e+04  6.14507136e+06  2.64e+00 4.24e-02  3.64e+01     3s
   9  -5.94066608e+04  2.30667253e+06  1.42e+00 1.53e-02  1.37e+01     3s
  10  -1.66572700e+04  1.15445965e+06  4.93e-01 7.38e-03  6.75e+00     3s
  11  -2.02520240e+03  4.36693211e+05  2.72e-01 2.63e-03  2.52e+00     3s
  12   8.72874930e+03  2.00312291e+05  1.44e-01 9.73e-04  1.10e+00     3s
  13   1.25251435e+04  1.44888909e+05  1.18e-01 1.47e-03  7.61e-01     3s
  14   1.73971664e+04  1.24213192e+05  9.73e-02 1.85e-03  6.14e-01     3s
  15   2.09436091e+04  1.08034264e+05  8.43e-02 2.14e-03  5.00e-01     3s
  16   2.74003017e+04  9.31151230e+04  6.35e-02 1.81e-03  3.78e-01     3s
  17   3.15536919e+04  8.12330043e+04  5.07e-02 2.30e-03  2.85e-01     3s
  18   3.35044314e+04  7.62258061e+04  4.46e-02 2.16e-03  2.45e-01     3s
  19   3.72965643e+04  6.98572481e+04  3.34e-02 2.29e-03  1.87e-01     3s
  20   3.96653175e+04  6.49871171e+04  2.68e-02 1.71e-03  1.45e-01     3s
  21   4.13671717e+04  6.07466678e+04  2.23e-02 1.22e-03  1.11e-01     3s
  22   4.28331339e+04  5.82121425e+04  1.85e-02 8.82e-04  8.84e-02     3s
  23   4.36483763e+04  5.64728024e+04  1.64e-02 6.89e-04  7.37e-02     4s
  24   4.47008160e+04  5.48363035e+04  1.39e-02 7.44e-04  5.82e-02     4s
  25   4.61570641e+04  5.39734376e+04  1.05e-02 7.08e-04  4.49e-02     4s
  26   4.66721087e+04  5.35250507e+04  9.23e-03 6.22e-04  3.94e-02     4s
  27   4.71595785e+04  5.25282567e+04  7.98e-03 4.11e-04  3.09e-02     4s
  28   4.73504378e+04  5.20014093e+04  7.50e-03 2.97e-04  2.67e-02     4s
  29   4.80796581e+04  5.18196769e+04  5.70e-03 2.59e-04  2.15e-02     4s
  30   4.87784222e+04  5.16059470e+04  4.12e-03 2.14e-04  1.62e-02     4s
  31   4.89513720e+04  5.14616639e+04  3.69e-03 1.89e-04  1.44e-02     4s
  32   4.92409354e+04  5.12741283e+04  3.01e-03 1.44e-04  1.17e-02     4s
  33   4.95692113e+04  5.11385145e+04  2.23e-03 1.16e-04  9.02e-03     4s
  34   4.99137689e+04  5.10510405e+04  1.47e-03 9.74e-05  6.53e-03     4s
  35   5.00102811e+04  5.08999449e+04  1.24e-03 6.40e-05  5.11e-03     4s
  36   5.00515283e+04  5.08591963e+04  1.15e-03 5.63e-05  4.64e-03     4s
  37   5.01468266e+04  5.08028801e+04  9.30e-04 4.95e-05  3.77e-03     4s
  38   5.02573044e+04  5.07188265e+04  6.70e-04 3.17e-05  2.65e-03     4s
  39   5.03934817e+04  5.06575197e+04  3.60e-04 1.85e-05  1.52e-03     4s
  40   5.04730699e+04  5.06153389e+04  1.82e-04 1.04e-05  8.17e-04     5s
  41   5.04773859e+04  5.06023215e+04  1.72e-04 7.88e-06  7.18e-04     5s
  42   5.05017483e+04  5.05924931e+04  1.22e-04 5.93e-06  5.21e-04     5s
  43   5.05057882e+04  5.05903245e+04  1.14e-04 5.51e-06  4.86e-04     5s
  44   5.05164334e+04  5.05840745e+04  9.22e-05 4.26e-06  3.89e-04     5s
  45   5.05381285e+04  5.05744200e+04  4.56e-05 2.36e-06  2.09e-04     5s
  46   5.05404280e+04  5.05735398e+04  4.11e-05 2.18e-06  1.90e-04     5s
  47   5.05518585e+04  5.05694304e+04  1.74e-05 1.43e-06  1.01e-04     5s
  48   5.05537311e+04  5.05623928e+04  1.38e-05 1.34e-07  4.98e-05     5s
  49   5.05571188e+04  5.05621948e+04  7.70e-06 1.12e-07  2.92e-05     5s
  50   5.05583726e+04  5.05621416e+04  5.58e-06 9.86e-08  2.17e-05     5s
  51   5.05615484e+04  5.05617668e+04  8.76e-08 1.97e-08  1.25e-06     5s
  52   5.05616583e+04  5.05616884e+04  1.44e-08 2.38e-09  1.73e-07     5s
  53   5.05616751e+04  5.05616754e+04  2.47e-09 4.89e-10  1.72e-09     5s

Barrier solved model in 53 iterations and 5.23 seconds (9.32 work units)
Optimal objective 5.05616751e+04


Root crossover log...

   77353 DPushes remaining with DInf 0.0000000e+00                 5s
       0 DPushes remaining with DInf 0.0000000e+00                 8s

   12836 PPushes remaining with PInf 2.7119958e-05                 8s
       0 PPushes remaining with PInf 0.0000000e+00                 8s

  Push phase complete: Pinf 0.0000000e+00, Dinf 4.9312334e+04      8s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   48997    5.0561675e+04   0.000000e+00   4.931233e+04      9s
   49408    5.0561675e+04   0.000000e+00   0.000000e+00      9s
   49408    5.0561675e+04   0.000000e+00   0.000000e+00      9s
Concurrent spin time: 0.42s

Solved with barrier

Root relaxation: objective 5.056168e+04, 49408 iterations, 7.33 seconds (15.90 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 50561.6753    0  371 -215351.96 50561.6753   123%     -    9s
H    0     0                    -208145.2193 50561.6753   124%     -    9s
H    0     0                    -162844.5680 50561.6753   131%     -    9s
H    0     0                    -161557.4698 50561.6753   131%     -   10s
H    0     0                    -161063.7188 50561.6753   131%     -   10s
H    0     0                    -71155.62268 50561.6753   171%     -   10s
H    0     0                    -70895.47394 50561.6753   171%     -   10s
H    0     0                    -33639.16358 50561.6753   250%     -   10s
H    0     0                    -25225.23994 50561.6753   300%     -   10s
H    0     0                    -24610.42390 50561.6753   305%     -   10s
H    0     0                    -15613.18609 45181.9719   389%     -   62s
H    0     0                    -15068.59169 45181.9719   400%     -   62s
H    0     0                    -15055.85923 45181.9719   400%     -   62s
H    0     0                    -14992.63260 45181.9719   401%     -   62s
H    0     0                    -14569.88789 45181.9719   410%     -   62s
H    0     0                    -14547.25321 45181.9719   411%     -   62s
     0     0 45181.9719    0  450 -14547.253 45181.9719   411%     -   62s
H    0     0                    -10440.19841 45181.8509   533%     -   63s
H    0     0                    -10132.50414 45181.8509   546%     -   63s
H    0     0                    -7581.960722 45181.8509   696%     -   63s
H    0     0                    -7581.162878 45181.8509   696%     -   63s
     0     0 44190.1531    0  426 -7581.1629 44190.1531   683%     -   84s
     0     0 44067.2073    0  432 -7581.1629 44067.2073   681%     -   93s
     0     0 44051.7457    0  478 -7581.1629 44051.7457   681%     -  110s
     0     0 44051.7457    0  494 -7581.1629 44051.7457   681%     -  119s
     0     0 44051.7457    0  421 -7581.1629 44051.7457   681%     -  122s
     0     0 44051.7457    0  420 -7581.1629 44051.7457   681%     -  126s
     0     0 44051.7457    0  420 -7581.1629 44051.7457   681%     -  128s
     0     0 44051.7457    0  420 -7581.1629 44051.7457   681%     -  128s
     0     0 41321.0325    0  470 -7581.1629 41321.0325   645%     -  178s
H    0     0                    14795.013845 41321.0325   179%     -  179s
H    0     0                    14820.831250 41321.0325   179%     -  179s
     0     0 40679.6371    0  545 14820.8313 40679.6371   174%     -  212s
     0     0 40353.6599    0  544 14820.8313 40353.6599   172%     -  231s
     0     0 40200.7446    0  558 14820.8313 40200.7446   171%     -  242s
     0     0 40141.4387    0  554 14820.8313 40141.4387   171%     -  252s
     0     0 40013.0780    0  521 14820.8313 40013.0780   170%     -  261s
     0     0 39969.9220    0  534 14820.8313 39969.9220   170%     -  268s
     0     0 39828.5592    0  544 14820.8313 39828.5592   169%     -  278s
     0     0 39805.6844    0  559 14820.8313 39805.6844   169%     -  285s
     0     0 39766.2363    0  544 14820.8313 39766.2363   168%     -  292s
     0     0 39762.2764    0  553 14820.8313 39762.2764   168%     -  295s
     0     0 39751.6039    0  562 14820.8313 39751.6039   168%     -  300s
     0     0 39747.9409    0  560 14820.8313 39747.9409   168%     -  303s
     0     0 39747.4148    0  566 14820.8313 39747.4148   168%     -  303s
     0     0 38140.3634    0  554 14820.8313 38140.3634   157%     -  379s
     0     0 37615.7932    0  552 14820.8313 37615.7932   154%     -  397s
     0     0 37525.3695    0  577 14820.8313 37525.3695   153%     -  408s
     0     0 37479.7034    0  629 14820.8313 37479.7034   153%     -  415s
     0     0 37438.7400    0  555 14820.8313 37438.7400   153%     -  426s
     0     0 37425.3628    0  550 14820.8313 37425.3628   153%     -  432s
H    0     0                    15396.910794 37386.9983   143%     -  441s
H    0     0                    15649.517192 37386.9983   139%     -  441s
H    0     0                    15661.902795 37386.9983   139%     -  441s
     0     0 37386.9983    0  557 15661.9028 37386.9983   139%     -  441s
     0     0 37355.5542    0  550 15661.9028 37355.5542   139%     -  447s
     0     0 37323.3221    0  615 15661.9028 37323.3221   138%     -  454s
     0     0 37317.3458    0  610 15661.9028 37317.3458   138%     -  459s
     0     0 37299.3296    0  615 15661.9028 37299.3296   138%     -  466s
     0     0 37295.1755    0  623 15661.9028 37295.1755   138%     -  469s
     0     0 37294.8027    0  618 15661.9028 37294.8027   138%     -  471s
     0     0 36657.5298    0  392 15661.9028 36657.5298   134%     -  504s
     0     0 36556.0538    0  400 15661.9028 36556.0538   133%     -  514s
     0     0 36475.8025    0  403 15661.9028 36475.8025   133%     -  525s
     0     0 36424.4292    0  485 15661.9028 36424.4292   133%     -  533s
H    0     0                    16920.896335 36413.7996   115%     -  540s
H    0     0                    17059.038440 36413.7996   113%     -  540s
H    0     0                    17297.698164 36413.7996   111%     -  540s
H    0     0                    17333.763934 36413.7996   110%     -  540s
H    0     0                    17428.752611 36413.7996   109%     -  540s
H    0     0                    17471.807384 36413.7996   108%     -  540s
     0     0 36413.7996    0  412 17471.8074 36413.7996   108%     -  540s
     0     0 36399.7801    0  498 17471.8074 36399.7801   108%     -  544s
     0     0 36391.4855    0  588 17471.8074 36391.4855   108%     -  548s
     0     0 36388.4785    0  579 17471.8074 36388.4785   108%     -  550s
     0     0 36385.8574    0  579 17471.8074 36385.8574   108%     -  553s
     0     0 36383.9331    0  583 17471.8074 36383.9331   108%     -  554s
     0     0 36287.2728    0  560 17471.8074 36287.2728   108%     -  566s
H    0     0                    17475.960376 36285.3196   108%     -  566s
H    0     0                    17558.102040 36285.3196   107%     -  566s
H    0     0                    17640.759109 36285.3196   106%     -  566s
     0     0 36249.5345    0  557 17640.7591 36249.5345   105%     -  575s
     0     0 36237.9684    0  508 17640.7591 36237.9684   105%     -  578s
     0     0 36233.3204    0  411 17640.7591 36233.3204   105%     -  580s
     0     0 36228.8783    0  402 17640.7591 36228.8783   105%     -  581s
     0     0 36220.8420    0  408 17640.7591 36220.8420   105%     -  583s
     0     0 36219.7072    0  411 17640.7591 36219.7072   105%     -  584s
     0     0 36200.0655    0  400 17640.7591 36200.0655   105%     -  589s
H    0     0                    17703.436162 36199.0268   104%     -  604s
H    0     0                    17746.211395 36199.0268   104%     -  604s
H    0     0                    17970.573462 36199.0268   101%     -  604s
H    0     0                    18194.165960 36199.0268  99.0%     -  605s
H    0     0                    19141.671776 36199.0268  89.1%     -  605s
     0     0 36191.0112    0  506 19141.6718 36191.0112  89.1%     -  609s
     0     0 36187.7333    0  499 19141.6718 36187.7333  89.1%     -  611s
     0     0 36183.4677    0  509 19141.6718 36183.4677  89.0%     -  612s
     0     0 36178.5686    0  413 19141.6718 36178.5686  89.0%     -  614s
     0     0 36176.0112    0  522 19141.6718 36176.0112  89.0%     -  616s
     0     0 36175.8510    0  522 19141.6718 36175.8510  89.0%     -  617s
     0     0 36167.8713    0  526 19141.6718 36167.8713  88.9%     -  621s
     0     0 36165.5734    0  418 19141.6718 36165.5734  88.9%     -  623s
     0     0 36161.0554    0  419 19141.6718 36161.0554  88.9%     -  625s
     0     0 36160.5196    0  427 19141.6718 36160.5196  88.9%     -  626s
     0     0 36153.1786    0  414 19141.6718 36153.1786  88.9%     -  628s
H    0     0                    19872.721275 36152.9955  81.9%     -  629s
     0     0 36146.7811    0  428 19872.7213 36146.7811  81.9%     -  632s
     0     0 36145.9816    0  428 19872.7213 36145.9816  81.9%     -  633s
     0     0 36080.6630    0  419 19872.7213 36080.6630  81.6%     -  639s
     0     0 36059.3522    0  587 19872.7213 36059.3522  81.5%     -  647s
     0     0 36053.4565    0  413 19872.7213 36053.4565  81.4%     -  650s
     0     0 36052.3614    0  504 19872.7213 36052.3614  81.4%     -  651s
     0     0 36042.8585    0  507 19872.7213 36042.8585  81.4%     -  656s
H    0     0                    20116.222976 36042.3720  79.2%     -  670s
H    0     0                    20130.235237 36042.3720  79.0%     -  670s
H    0     0                    20206.659618 36042.3720  78.4%     -  670s
H    0     0                    20350.395148 36042.3720  77.1%     -  670s
H    0     0                    20400.466876 36042.3720  76.7%     -  672s
     0     0 36029.3995    0  497 20400.4669 36029.3995  76.6%     -  681s
     0     0 36025.0234    0  500 20400.4669 36025.0234  76.6%     -  683s
     0     0 36019.3001    0  503 20400.4669 36019.3001  76.6%     -  685s
     0     0 36016.8065    0  510 20400.4669 36016.8065  76.5%     -  685s
     0     0 36016.2723    0  582 20400.4669 36016.2723  76.5%     -  687s
     0     0 36013.5749    0  426 20400.4669 36013.5749  76.5%     -  690s
     0     0 36011.7167    0  425 20400.4669 36011.7167  76.5%     -  691s
     0     0 36011.3274    0  430 20400.4669 36011.3274  76.5%     -  693s
     0     0 36011.1814    0  428 20400.4669 36011.1814  76.5%     -  693s
     0     0 36007.8819    0  433 20400.4669 36007.8819  76.5%     -  695s
     0     0 36007.6930    0  435 20400.4669 36007.6930  76.5%     -  696s
     0     0 36007.4211    0  433 20400.4669 36007.4211  76.5%     -  697s
     0     0 36007.2978    0  433 20400.4669 36007.2978  76.5%     -  699s
H    0     0                    20464.091887 36007.0543  76.0%     -  832s
H    0     0                    20517.959672 36007.0543  75.5%     -  834s
     0     2 36007.0543    0  433 20517.9597 36007.0543  75.5%     -  839s
     1     4 35974.2654    1  421 20517.9597 36006.7737  75.5%  3799  846s
     3     6 34825.2178    2  394 20517.9597 35973.4181  75.3% 11051  865s
     5     8 35658.2479    2  571 20517.9597 35934.4392  75.1% 11068  882s
     7    14 33754.7253    3  404 20517.9597 35657.3702  73.8% 12142  896s
    13    27 34045.5389    4  415 20517.9597 35657.3702  73.8% 12941  921s
    26    40 33570.5388    4  400 20517.9597 35168.1241  71.4% 17944  968s
    39    71 33115.9078    6  352 20517.9597 35168.1241  71.4% 16485 1046s
    70   154 32968.6022    7  341 20517.9597 35168.1241  71.4% 17497 1081s
   153   184 32709.4039   10  319 20517.9597 35168.1241  71.4% 11896 1105s
   183   222 32595.6870   11  374 20517.9597 35168.1241  71.4% 10914 1138s
   221   258 32509.9511   12  532 20517.9597 35168.1241  71.4% 10217 1159s
   257   290 31950.7494   13  284 20517.9597 35168.1241  71.4%  9932 1181s
   289   321 31860.0338   14  312 20517.9597 35168.1241  71.4%  9788 1222s
   320   353 31605.9837   15  272 20517.9597 35168.1241  71.4%  9524 1241s
   352   378 30135.6194   16  309 20517.9597 35168.1241  71.4%  9418 1261s
   389   408 29940.6832   17  248 20517.9597 35168.1241  71.4%  9113 1283s
   420   438 28522.3435   18  248 20517.9597 35168.1241  71.4%  8970 1304s
   452   468 28277.2388   19  244 20517.9597 35168.1241  71.4%  8697 1326s
   484   499 28169.7773   20  236 20517.9597 35168.1241  71.4%  8490 1345s
   517   527 28058.9178   21  244 20517.9597 35168.1241  71.4%  8360 1364s
   553   559 27865.7133   22  226 20517.9597 35168.1241  71.4%  8160 1384s
   585   598 27857.7542   23  226 20517.9597 35168.1241  71.4%  7976 1404s
   624   635 27680.8244   24  222 20517.9597 35168.1241  71.4%  7681 1424s
   663   662 26444.7046   25  219 20517.9597 35168.1241  71.4%  7505 1446s
   704   693 26185.6154   26  212 20517.9597 35168.1241  71.4%  7374 1470s
   745   723 26053.7098   27  210 20517.9597 35168.1241  71.4%  7176 1495s
   780   760 26044.9928   28  206 20517.9597 35168.1241  71.4%  7063 1527s
   821   807 25860.5341   29  338 20517.9597 35168.1241  71.4%  6953 1549s
   870   863 25815.1649   30  338 20517.9597 35168.1241  71.4%  6811 1570s
   928   921 25566.6935   31  353 20517.9597 35168.1241  71.4%  6650 1592s
   992   984 25416.4778   32  346 20517.9597 35168.1241  71.4%  6489 1631s
  1059  1047 25245.0331   34  350 20517.9597 35168.1241  71.4%  6362 1667s
  1140  1107 24757.4921   41  476 20517.9597 35168.1241  71.4%  6196 1711s
  1220  1169 24254.3782   49  459 20517.9597 35168.1241  71.4%  6094 1754s
  1294  1267 23096.0531   57  344 20517.9597 35168.1241  71.4%  6052 1803s
  1401  1331     cutoff   66      20517.9597 34391.8355  67.6%  5910 1836s
  1528  1411 21787.3752   34  426 20517.9597 34391.8355  67.6%  5796 1870s
  1626  1491 21735.9400   35  435 20517.9597 34391.8355  67.6%  5737 1906s
  1740  1545 21404.4214   40  412 20517.9597 34391.8355  67.6%  5700 1939s
  1866  1631 infeasible   37      20517.9597 34248.4146  66.9%  5592 1977s
  1980  1688 31462.8895   10  572 20517.9597 34248.4146  66.9%  5610 2018s
  2081  1787 30001.0092   12  512 20517.9597 34248.4146  66.9%  5617 2067s
  2206  1900 29877.3626   13  517 20517.9597 34248.4146  66.9%  5592 2119s
  2367  2008 28364.4231   16  498 20517.9597 34248.4146  66.9%  5538 2164s
  2526  2142 27483.4522   17  471 20517.9597 34248.4146  66.9%  5531 2211s
  2720  2283 28314.2803   17  498 20517.9597 34248.4146  66.9%  5461 2263s
  2925  2391 26679.1942   19  166 20517.9597 33545.7570  63.5%  5398 2313s
  3107  2530 26894.9215   21  406 20517.9597 33545.7570  63.5%  5395 2366s
  3315  2609 21044.9836   24   72 20517.9597 33545.7570  63.5%  5372 2424s
  3518  2701 infeasible   30      20517.9597 33545.7570  63.5%  5366 2489s
  3672  2806 29465.3471   11  302 20517.9597 33476.7886  63.2%  5433 2557s
  3823  2908     cutoff   14      20517.9597 33476.7886  63.2%  5526 2623s
  4030  2909 21006.1675   73  433 20517.9597 33476.7886  63.2%  5548 2940s
  4032  2910 25947.2257   35   93 20517.9597 33476.7886  63.2%  5545 2948s
  4033  2911 23795.9642   52  433 20517.9597 33476.7886  63.2%  5544 3007s
  4034  2912 31558.9348    7  524 20517.9597 33476.7886  63.2%  5543 3059s
  4035  2912 27932.7695   28  434 20517.9597 33476.7886  63.2%  5541 3097s
  4036  2913 28189.6625   32  410 20517.9597 33476.7886  63.2%  5540 3122s
  4037  2914 27786.9693   18  459 20517.9597 33476.7886  63.2%  5539 3135s
  4038  2914 25310.9004   23  477 20517.9597 33476.7886  63.2%  5537 3147s
  4039  2915 28396.4888   32  425 20517.9597 33476.7886  63.2%  5536 3161s
  4040  2916 22791.2759   16  427 20517.9597 33476.7886  63.2%  5534 3175s
  4041  2916 23311.3854   50  417 20517.9597 33476.7886  63.2%  5533 3184s
  4042  2917 22116.9215   42  421 20517.9597 33476.7886  63.2%  5532 3189s
  4043  2918 28824.0729   30  431 20517.9597 33476.7886  63.2%  5530 3202s
  4044  2918 22268.2257   11  468 20517.9597 33476.7886  63.2%  5529 3210s
  4046  2920 30963.6725    9  423 20517.9597 33476.7886  63.2%  5526 3218s
  4047  2920 29151.6241   16  425 20517.9597 33476.7886  63.2%  5525 3222s
  4048  2921 33476.7886    9  466 20517.9597 33476.7886  63.2%  5524 3234s
  4049  2922 26191.0164   39  419 20517.9597 33476.7886  63.2%  5522 3239s
  4050  2922 29961.7983   18  462 20517.9597 33476.7886  63.2%  5521 3253s
  4051  2923 24625.6768   54  426 20517.9597 33476.7886  63.2%  5519 3258s
  4052  2924 22340.0193   57  496 20517.9597 33476.7886  63.2%  5518 3270s
  4053  2924 28229.5655   29  431 20517.9597 33476.7886  63.2%  5517 3276s
  4054  2925 27756.0710   18  485 20517.9597 33476.7886  63.2%  5515 3282s
  4055  2926 23887.3736   63  470 20517.9597 33476.7886  63.2%  5514 3305s
  4056  2926 29530.9990   25  434 20517.9597 33476.7886  63.2%  5513 3316s
  4057  2927 28779.6144   10  494 20517.9597 33476.7886  63.2%  5511 3331s
  4058  2928 29585.1373   19  481 20517.9597 33476.7886  63.2%  5510 3335s
  4059  2928 21713.2245   54  431 20517.9597 33476.7886  63.2%  5509 3340s
  4060  2929 26141.5047   17  483 20517.9597 33476.7886  63.2%  5507 3355s
  4061  2930 25464.3267   35  648 20517.9597 33476.7886  63.2%  5506 3362s
  4062  2930 30451.8002   21  620 20517.9597 33476.7886  63.2%  5504 3368s
  4063  2931 27949.1451   29  472 20517.9597 33476.7886  63.2%  5503 3385s
  4064  2932 22077.7870   43  542 20517.9597 33476.7886  63.2%  5502 3394s
  4065  2932 24991.4071   54  548 20517.9597 33476.7886  63.2%  5500 3400s
  4066  2933 30347.6084   15  512 20517.9597 33476.7886  63.2%  5499 3416s
  4067  2934 20602.0630   31  509 20517.9597 33476.7886  63.2%  5498 3429s
  4068  2934 30430.4587   17  508 20517.9597 33476.7886  63.2%  5496 3436s
  4069  2935 27989.3384   33  512 20517.9597 33476.7886  63.2%  5495 3448s
  4070  2936 22231.5375   36  518 20517.9597 33476.7886  63.2%  5494 3456s
  4071  2936 29201.7085   15  514 20517.9597 33476.7886  63.2%  5492 3499s
  4072  2937 28464.4605   28  501 20517.9597 33476.7886  63.2%  5491 3512s
  4073  2938 25899.7748   36  581 20517.9597 33476.7886  63.2%  5490 3520s
  4074  2938 27682.9604   28  581 20517.9597 33476.7886  63.2%  5488 3544s

Cutting planes:
  Learned: 1
  Implied bound: 13
  Projected implied bound: 216
  MIR: 410
  Flow cover: 888
  RLT: 25
  Relax-and-lift: 136

Explored 4074 nodes (23463980 simplex iterations) in 3600.02 seconds (9012.80 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 20518 20464.1 20400.5 ... 18194.2

Time limit reached
Best objective 2.051795967243e+04, best bound 3.347678861640e+04, gap 63.1585%
  WARNING: Time limit reached. Using best solution found (gap: 63.16%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.05s
  Master Objective (UB) = 20517.96, θ = 168268.11
  Upper Bound (UB) = 20517.96

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 168268.11
  [DEBUG]   ✓ Scenario 0: θ = 168268.11 ≤ Q = 168268.11 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 168268.11 ≤ Q = 168268.11 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 168268.11 ≤ Q = 168268.11 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 168268.11 ≤ Q = 168268.11 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 168268.11 ≤ Q = 168268.11 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 168268.11 ≤ Q = 168268.11 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 168268.11 ≤ Q = 168268.11 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 168268.11 ≤ Q = 168268.11 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 168268.11 ≤ Q = 168268.11 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 168268.11 ≤ Q = 168268.11 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 168268.11 ≤ Q = 168268.11 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 11] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x302dc2a2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x302dc2a2
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [3e-13, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [5e-14, 2e+02]
Found heuristic solution: objective 1.356530e+13
Presolve removed 2580 rows and 1872 columns
Presolve time: 0.00s
Presolved: 513 rows, 517 columns, 1447 nonzeros
Found heuristic solution: objective 6893565.8254
Variable types: 351 continuous, 166 integer (166 binary)

Root relaxation: objective -1.438600e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -143860.04    0  123 6893565.83 -143860.04   102%     -    0s
H    0     0                    -108358.5575 -143860.04  32.8%     -    0s
H    0     0                    -109625.0483 -143860.04  31.2%     -    0s
     0     0 -113649.64    0   51 -109625.05 -113649.64  3.67%     -    0s
H    0     0                    -113038.2798 -113649.36  0.54%     -    0s
     0     0 -113414.44    0   18 -113038.28 -113414.44  0.33%     -    0s
H    0     0                    -113285.4428 -113413.87  0.11%     -    0s
     0     0 -113288.14    0    3 -113285.44 -113288.14  0.00%     -    0s
     0     0     cutoff    0      -113285.44 -113285.44  0.00%     -    0s

Cutting planes:
  Gomory: 6
  MIR: 135
  Flow cover: 3
  RLT: 11
  BQP: 3

Explored 1 nodes (435 simplex iterations) in 0.02 seconds (0.02 work units)
Thread count was 32 (of 64 available processors)

Solution count 6: -113285 -113038 -109625 ... 1.35653e+13
No other solutions better than -113285

Optimal solution found (tolerance 1.00e-06)
Best objective -1.132854428407e+05, best bound -1.132854428407e+05, gap 0.0000%
  Subproblem solved in 0.04s
  Worst-case operational profit (Z_SP) = 166862.94
  Scenario: 6 demand increases, 54 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -113285.44
  [DEBUG]   S×d_nominal = 280148.38
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 280148.38 + -113285.44 = 166862.94
  [DEBUG]   Current θ from Master = 168268.11
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1405.17 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 19112.79
  Lower Bound (LB) = 19998.82
  Gap (UB-LB) = 519.1394, Absolute Gap = 519.1394, Relative Gap = 0.025302
  Not converged yet (gap = 519.14 > ε = 200)

  [DEBUG] Adding NEW scenario 11 to Master Problem...
  [DEBUG] New scenario pattern: 6 increases, 54 decreases
    [DEBUG] Scenario 11 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 11 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 11]
    [DEBUG]   - Total constraints in model: 184863
    [DEBUG]   - Total variables in model: 77140
  [DEBUG] Total scenarios in Master: 12
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 12
================================================================================
[Iteration 12] Solving Master Problem...
  Current scenarios in Master: 12
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 184863 rows, 77140 columns and 524399 nonzeros
Model fingerprint: 0xedaa68bd
Variable types: 74881 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 81384 rows and 33054 columns
Presolve time: 1.50s
Presolved: 103479 rows, 44086 columns, 625151 nonzeros
Variable types: 41827 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -368212.4835
Found heuristic solution: objective -215351.9614

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.20s

Barrier statistics:
 Dense cols : 606
 AA' NZ     : 3.835e+06
 Factor NZ  : 8.961e+06 (roughly 130 MB of memory)
 Factor Ops : 1.658e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.66359386e+07  1.87751334e+08  9.42e+04 2.40e+01  7.18e+04     3s
   1  -1.26299820e+07  1.67494936e+08  6.58e+04 5.13e+01  4.96e+04     3s
   2  -4.41452805e+06  1.24056886e+08  2.29e+04 2.20e+00  1.84e+04     3s
   3  -7.75632650e+05  8.95723773e+07  1.64e+03 1.59e+00  1.70e+03     3s
   4  -4.56227407e+05  3.18372636e+07  3.11e+02 3.38e-01  3.73e+02     3s
   5  -3.22882652e+05  2.23476218e+07  6.75e+01 2.12e-01  1.60e+02     3s
   6  -2.28523577e+05  1.58066829e+07  2.42e+01 1.41e-01  9.68e+01     3s
   7  -1.23512054e+05  1.13856779e+07  7.93e+00 9.84e-02  6.39e+01     3s
   8  -9.26942400e+04  4.60078546e+06  5.66e+00 3.71e-02  2.59e+01     3s
   9  -5.19685896e+04  2.64685274e+06  2.86e+00 2.06e-02  1.46e+01     3s
  10  -2.10508562e+04  9.39774786e+05  1.28e+00 6.86e-03  5.13e+00     3s
  11  -3.13503668e+03  3.93995526e+05  6.83e-01 2.62e-03  2.11e+00     3s
  12   8.08576856e+03  2.10249018e+05  3.91e-01 1.17e-03  1.07e+00     3s
  13   1.29568404e+04  1.41343013e+05  3.14e-01 9.55e-04  6.80e-01     3s
  14   1.72067912e+04  1.13801143e+05  2.57e-01 1.16e-03  5.12e-01     3s
  15   2.18360086e+04  1.00877966e+05  2.08e-01 1.14e-03  4.19e-01     3s
  16   2.79777136e+04  8.69978874e+04  1.60e-01 1.34e-03  3.12e-01     3s
  17   3.28846304e+04  7.86706390e+04  1.24e-01 1.42e-03  2.42e-01     3s
  18   3.63312887e+04  7.22440214e+04  9.66e-02 1.52e-03  1.90e-01     3s
  19   3.82260920e+04  6.66515712e+04  8.31e-02 1.46e-03  1.50e-01     3s
  20   4.13023333e+04  6.23519247e+04  6.23e-02 1.28e-03  1.11e-01     4s
  21   4.35235692e+04  5.92376949e+04  4.86e-02 1.65e-03  8.32e-02     4s
  22   4.49171178e+04  5.64406219e+04  4.02e-02 1.85e-03  6.10e-02     4s
  23   4.60725698e+04  5.48681753e+04  3.33e-02 1.23e-03  4.66e-02     4s
  24   4.73816226e+04  5.41042324e+04  2.53e-02 9.10e-04  3.56e-02     4s
  25   4.79156317e+04  5.37375854e+04  2.17e-02 7.88e-04  3.08e-02     4s
  26   4.88284084e+04  5.29592747e+04  1.60e-02 9.29e-04  2.19e-02     4s
  27   4.92301418e+04  5.25563657e+04  1.35e-02 6.70e-04  1.76e-02     4s
  28   4.95713093e+04  5.24107190e+04  1.15e-02 5.64e-04  1.50e-02     4s
  29   4.99130220e+04  5.21761469e+04  9.47e-03 4.02e-04  1.20e-02     4s
  30   5.00737534e+04  5.19732354e+04  8.54e-03 3.01e-04  1.01e-02     4s
  31   5.04241263e+04  5.18655460e+04  6.57e-03 2.24e-04  7.64e-03     4s
  32   5.05989550e+04  5.18161875e+04  5.55e-03 1.82e-04  6.45e-03     4s
  33   5.09087311e+04  5.17697227e+04  3.80e-03 1.42e-04  4.56e-03     4s
  34   5.10093249e+04  5.17299426e+04  3.22e-03 1.12e-04  3.82e-03     4s
  35   5.10472394e+04  5.17071505e+04  3.00e-03 9.59e-05  3.50e-03     4s
  36   5.10818424e+04  5.16790306e+04  2.79e-03 7.97e-05  3.17e-03     4s
  37   5.11616194e+04  5.16501887e+04  2.33e-03 5.73e-05  2.59e-03     4s
  38   5.11883037e+04  5.16430532e+04  2.17e-03 5.06e-05  2.41e-03     5s
  39   5.12190280e+04  5.16215921e+04  2.00e-03 5.79e-05  2.13e-03     5s
  40   5.12913539e+04  5.16132989e+04  1.58e-03 4.80e-05  1.71e-03     5s
  41   5.13583949e+04  5.16072111e+04  1.18e-03 4.08e-05  1.32e-03     5s
  42   5.14012271e+04  5.15959351e+04  9.37e-04 3.82e-05  1.03e-03     5s
  43   5.14613487e+04  5.15853485e+04  6.00e-04 1.95e-05  6.57e-04     5s
  44   5.14676971e+04  5.15817317e+04  5.65e-04 1.47e-05  6.05e-04     5s
  45   5.14885074e+04  5.15792338e+04  4.46e-04 1.36e-05  4.81e-04     5s
  46   5.14998436e+04  5.15777869e+04  3.82e-04 1.07e-05  4.13e-04     5s
  47   5.15012406e+04  5.15769862e+04  3.75e-04 9.59e-06  4.02e-04     5s
  48   5.15275831e+04  5.15742157e+04  2.27e-04 5.15e-06  2.47e-04     5s
  49   5.15422523e+04  5.15729773e+04  1.46e-04 3.33e-06  1.63e-04     5s
  50   5.15428758e+04  5.15717146e+04  1.43e-04 1.98e-06  1.53e-04     5s
  51   5.15482983e+04  5.15716379e+04  1.13e-04 1.78e-06  1.24e-04     5s
  52   5.15595574e+04  5.15710740e+04  5.29e-05 1.19e-06  6.10e-05     5s
  53   5.15677580e+04  5.15701944e+04  1.09e-05 8.35e-08  1.29e-05     5s
  54   5.15678507e+04  5.15701006e+04  1.05e-05 4.04e-08  1.19e-05     6s
  55   5.15698938e+04  5.15700779e+04  4.38e-07 1.66e-08  9.73e-07     6s
  56   5.15700136e+04  5.15700228e+04  3.38e-08 4.12e-08  4.89e-08     6s
  57   5.15700172e+04  5.15700228e+04  7.32e-07 3.09e-08  2.96e-08     6s
  58   5.15700226e+04  5.15700226e+04  1.16e-08 2.35e-11  6.09e-11     6s

Barrier solved model in 58 iterations and 5.73 seconds (10.29 work units)
Optimal objective 5.15700226e+04


Root crossover log...

   81358 DPushes remaining with DInf 0.0000000e+00                 6s
       0 DPushes remaining with DInf 0.0000000e+00                 8s

    3466 PPushes remaining with PInf 1.1698339e-05                 8s
       0 PPushes remaining with PInf 0.0000000e+00                 8s

  Push phase complete: Pinf 0.0000000e+00, Dinf 8.0005184e-01      8s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   33177    5.1570023e+04   0.000000e+00   8.000518e-01      8s
   33215    5.1570023e+04   0.000000e+00   0.000000e+00      8s
   33215    5.1570023e+04   0.000000e+00   0.000000e+00      9s
Concurrent spin time: 0.65s

Solved with barrier

Root relaxation: objective 5.157002e+04, 33215 iterations, 7.16 seconds (15.26 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 51570.0226    0  417 -215351.96 51570.0226   124%     -    9s
H    0     0                    -211413.4927 51570.0226   124%     -    9s
H    0     0                    -149602.3261 51570.0226   134%     -   10s
H    0     0                    -143612.6764 51570.0226   136%     -   10s
H    0     0                    -143400.2934 51570.0226   136%     -   10s
H    0     0                    -143197.0420 51570.0226   136%     -   10s
H    0     0                    -142916.4891 51570.0226   136%     -   10s
H    0     0                    -142873.5488 51570.0226   136%     -   10s
H    0     0                    -43245.26296 51570.0226   219%     -   10s
H    0     0                    -43218.98402 51570.0226   219%     -   10s
H    0     0                    -700.0432766 51570.0226  7467%     -   10s
H    0     0                    2661.5798044 51570.0226  1838%     -   10s
H    0     0                    2823.1092977 51570.0226  1727%     -   10s
H    0     0                    3011.3423258 51570.0226  1613%     -   10s
H    0     0                    3166.5268465 45512.8522  1337%     -   52s
H    0     0                    3792.8997503 45512.8522  1100%     -   52s
H    0     0                    3798.1503733 45512.8522  1098%     -   52s
     0     0 45512.8522    0  491 3798.15037 45512.8522  1098%     -   53s
     0     0 45088.0842    0  484 3798.15037 45088.0842  1087%     -   64s
     0     0 44913.7031    0  481 3798.15037 44913.7031  1083%     -   75s
     0     0 44751.0128    0  494 3798.15037 44751.0128  1078%     -   89s
     0     0 44594.1505    0  491 3798.15037 44594.1505  1074%     -   95s
     0     0 44548.5580    0  480 3798.15037 44548.5580  1073%     -  106s
     0     0 44544.1084    0  496 3798.15037 44544.1084  1073%     -  110s
     0     0 44544.1084    0  490 3798.15037 44544.1084  1073%     -  114s
     0     0 44544.1084    0  473 3798.15037 44544.1084  1073%     -  120s
     0     0 44544.1084    0  483 3798.15037 44544.1084  1073%     -  121s
     0     0 41479.0813    0  551 3798.15037 41479.0813   992%     -  173s
H    0     0                    9389.6093707 41479.0665   342%     -  174s
     0     0 40845.9260    0  443 9389.60937 40845.9260   335%     -  203s
     0     0 40699.6405    0  489 9389.60937 40699.6405   333%     -  215s
     0     0 40641.3741    0  581 9389.60937 40641.3741   333%     -  228s
     0     0 40565.4839    0  564 9389.60937 40565.4839   332%     -  241s
     0     0 40519.7550    0  494 9389.60937 40519.7550   332%     -  251s
     0     0 40500.2326    0  514 9389.60937 40500.2326   331%     -  257s
     0     0 40490.5053    0  507 9389.60937 40490.5053   331%     -  260s
     0     0 40489.7627    0  503 9389.60937 40489.7627   331%     -  261s
H    0     0                    15319.550642 38256.2706   150%     -  335s
H    0     0                    15496.939576 38256.2706   147%     -  335s
     0     0 38256.2706    0  512 15496.9396 38256.2706   147%     -  335s
H    0     0                    15673.233191 38256.2122   144%     -  335s
     0     0 37978.0182    0  606 15673.2332 37978.0182   142%     -  358s
     0     0 37765.4021    0  614 15673.2332 37765.4021   141%     -  378s
     0     0 37696.1431    0  631 15673.2332 37696.1431   141%     -  391s
     0     0 37652.1625    0  625 15673.2332 37652.1625   140%     -  401s
     0     0 37633.1011    0  633 15673.2332 37633.1011   140%     -  409s
     0     0 37617.2561    0  630 15673.2332 37617.2561   140%     -  415s
     0     0 37606.3778    0  640 15673.2332 37606.3778   140%     -  419s
     0     0 37560.0695    0  633 15673.2332 37560.0695   140%     -  425s
     0     0 37550.2305    0  634 15673.2332 37550.2305   140%     -  429s
     0     0 37535.9409    0  629 15673.2332 37535.9409   139%     -  433s
     0     0 37523.6900    0  627 15673.2332 37523.6900   139%     -  436s
     0     0 37515.3653    0  625 15673.2332 37515.3653   139%     -  439s
     0     0 37512.3918    0  625 15673.2332 37512.3918   139%     -  441s
     0     0 37505.9937    0  617 15673.2332 37505.9937   139%     -  443s
     0     0 37487.2440    0  623 15673.2332 37487.2440   139%     -  449s
     0     0 37466.7742    0  633 15673.2332 37466.7742   139%     -  456s
     0     0 37457.8267    0  626 15673.2332 37457.8267   139%     -  460s
     0     0 37456.2088    0  637 15673.2332 37456.2088   139%     -  462s
     0     0 36828.1838    0  547 15673.2332 36828.1838   135%     -  497s
     0     0 36661.9463    0  489 15673.2332 36661.9463   134%     -  516s
     0     0 36615.7945    0  586 15673.2332 36615.7945   134%     -  527s
     0     0 36581.1686    0  412 15673.2332 36581.1686   133%     -  536s
     0     0 36562.2651    0  593 15673.2332 36562.2651   133%     -  547s
     0     0 36550.3145    0  588 15673.2332 36550.3145   133%     -  556s
     0     0 36541.2680    0  598 15673.2332 36541.2680   133%     -  563s
     0     0 36523.0936    0  589 15673.2332 36523.0936   133%     -  569s
     0     0 36517.7009    0  606 15673.2332 36517.7009   133%     -  572s
     0     0 36515.6080    0  588 15673.2332 36515.6080   133%     -  575s
     0     0 36398.0400    0  424 15673.2332 36398.0400   132%     -  591s
     0     0 36380.5983    0  426 15673.2332 36380.5983   132%     -  599s
     0     0 36358.5814    0  429 15673.2332 36358.5814   132%     -  606s
     0     0 36346.4357    0  622 15673.2332 36346.4357   132%     -  611s
     0     0 36339.3056    0  642 15673.2332 36339.3056   132%     -  614s
     0     0 36334.5247    0  428 15673.2332 36334.5247   132%     -  617s
     0     0 36333.1190    0  437 15673.2332 36333.1190   132%     -  618s
     0     0 36172.0231    0  616 15673.2332 36172.0231   131%     -  638s
H    0     0                    15805.142722 36171.8096   129%     -  645s
H    0     0                    15853.277620 36171.8096   128%     -  645s
H    0     0                    16665.160049 36171.8096   117%     -  646s
     0     0 36143.9556    0  431 16665.1600 36143.9556   117%     -  653s
     0     0 36125.0422    0  564 16665.1600 36125.0422   117%     -  659s
     0     0 36119.9283    0  570 16665.1600 36119.9283   117%     -  666s
     0     0 36116.6608    0  572 16665.1600 36116.6608   117%     -  671s
     0     0 36115.5910    0  570 16665.1600 36115.5910   117%     -  673s
     0     0 36101.4233    0  499 16665.1600 36101.4233   117%     -  680s
H    0     0                    17019.022433 36101.0725   112%     -  680s
     0     0 36068.3931    0  487 17019.0224 36068.3931   112%     -  690s
     0     0 36060.9513    0  416 17019.0224 36060.9513   112%     -  696s
     0     0 36058.4113    0  590 17019.0224 36058.4113   112%     -  698s
     0     0 36057.1410    0  600 17019.0224 36057.1410   112%     -  700s
     0     0 36035.5187    0  492 17019.0224 36035.5187   112%     -  706s
H    0     0                    17074.263604 36034.9803   111%     -  707s
     0     0 36033.0591    0  501 17074.2636 36033.0591   111%     -  709s
     0     0 36032.8043    0  428 17074.2636 36032.8043   111%     -  710s
     0     0 36024.6851    0  425 17074.2636 36024.6851   111%     -  714s
H    0     0                    17153.526252 36024.6746   110%     -  715s
     0     0 36018.1811    0  431 17153.5263 36018.1811   110%     -  718s
     0     0 36015.6149    0  439 17153.5263 36015.6149   110%     -  721s
     0     0 36015.0086    0  437 17153.5263 36015.0086   110%     -  722s
     0     0 36007.5636    0  434 17153.5263 36007.5636   110%     -  725s
H    0     0                    17160.180952 36007.3033   110%     -  750s
H    0     0                    17346.196227 36007.3033   108%     -  755s
H    0     0                    17418.042395 36007.3033   107%     -  765s
H    0     0                    17436.658791 36007.3033   107%     -  771s
H    0     0                    17531.692283 36007.3033   105%     -  779s
H    0     0                    19710.872184 36007.3033  82.7%     -  779s
H    0     0                    19778.872830 36007.3033  82.0%     -  784s
H    0     0                    19813.238252 36007.3033  81.7%     -  784s
H    0     0                    19941.752076 36007.3033  80.6%     -  784s
H    0     0                    20015.340089 36007.3033  79.9%     -  784s
H    0     0                    20223.189410 36007.3033  78.0%     -  784s
     0     0 36006.3135    0  438 20223.1894 36006.3135  78.0%     -  785s
     0     0 35996.0285    0  503 20223.1894 35996.0285  78.0%     -  791s
     0     0 35995.7893    0  503 20223.1894 35995.7893  78.0%     -  794s
H    0     0                    20240.605493 35995.4529  77.8%     -  899s
H    0     0                    20248.380093 35995.4529  77.8%     -  905s
H    0     2                    20253.460218 35995.4529  77.7%     -  907s
     0     2 35995.4529    0  503 20253.4602 35995.4529  77.7%     -  907s
     1     3 35685.0607    1  309 20253.4602 35995.4529  77.7% 15765  923s
     2     4 35722.0959    1  479 20253.4602 35722.0959  76.4% 14392  935s
     3     7 35294.5302    2  368 20253.4602 35721.7819  76.4% 11625  947s
     6    13 35076.7076    3  372 20253.4602 35721.7097  76.4% 10267  968s
    12    24 34897.6464    4  370 20253.4602 35434.5654  75.0% 11398 1004s
    23    35 33718.3436    4  601 20253.4602 35350.5997  74.5% 18483 1075s
    34    64 34181.6177    5  426 20253.4602 35004.1244  72.8% 16632 1241s
H   37    64                    20301.595116 35004.1244  72.4% 16113 1241s
    63    96 33804.3728    6  393 20301.5951 34897.6366  71.9% 21988 1282s
H   95   159                    20317.969840 34897.6366  71.8% 20032 1321s
H  116   159                    20408.997166 34897.6366  71.0% 18127 1321s
   158   250 33705.9577    9  393 20408.9972 34897.6366  71.0% 15548 1360s
   249   311 33436.6190   12  389 20408.9972 34897.6366  71.0% 12172 1389s
   312   358 33043.4547   13  528 20408.9972 34897.6366  71.0% 11421 1421s
   373   418 33368.7044   12  515 20408.9972 34897.6366  71.0% 11396 1446s
   437   474 33096.8757   13  381 20408.9972 34897.6366  71.0% 10979 1473s
   501   501 31535.3392   19  496 20408.9972 34897.6366  71.0% 10896 1511s
   530   524 30069.6057   21  422 20408.9972 34897.6366  71.0% 10936 1568s
   565   554 29781.2119   13  504 20408.9972 34897.6366  71.0% 10842 1628s
   605   590 29242.2829   14  377 20408.9972 34897.6366  71.0% 10967 1651s
   645   621 28558.3538   26  393 20408.9972 34897.6366  71.0% 11014 1674s
   680   648 27662.5379   29  309 20408.9972 34897.6366  71.0% 10989 1697s
   713   682 27089.3051   32  313 20408.9972 34897.6366  71.0% 11058 1724s
   753   717 26813.6730   19  210 20408.9972 34897.6366  71.0% 11079 1751s
   794   755 26775.7712   20  183 20408.9972 34897.6366  71.0% 11048 1772s
H  817   755                    20501.792028 34897.6366  70.2% 11000 1772s
   832   813 26668.1541   22  353 20501.7920 34897.6366  70.2% 10918 1795s
   918   896 26343.5760   25  372 20501.7920 34897.6366  70.2% 10554 1818s
  1021   963 25931.9148   29  357 20501.7920 34897.6366  70.2% 10108 1843s
  1116  1040 25761.3060   32  354 20501.7920 34897.6366  70.2%  9880 1869s
  1221  1137 24639.3661   35  321 20501.7920 34897.6366  70.2%  9697 1896s
  1338  1205 24477.0194   37  373 20501.7920 34897.6366  70.2%  9467 1927s
  1454  1281 infeasible   37      20501.7920 34897.6366  70.2%  9264 1956s
  1566  1324 21965.5969   37  420 20501.7920 34897.6366  70.2%  9145 1983s
  1670  1341 21874.4121   38  423 20501.7920 34897.6366  70.2%  8953 2026s
  1784  1409 infeasible   38      20501.7920 34897.6366  70.2%  8846 2062s
  1895  1460 28446.2963   12  247 20501.7920 34897.6366  70.2%  8789 2103s
  2021  1484 27335.5898   14  230 20501.7920 34897.6366  70.2%  8685 2144s
  2104  1523 25768.1241   15  229 20501.7920 34897.6366  70.2%  8762 2185s
  2171  1567 31517.4601   11  346 20501.7920 34897.6366  70.2%  8922 2228s
  2235  1611 30605.4383   12  249 20501.7920 34897.6366  70.2%  9204 2272s
  2310  1656 24313.9755   13  167 20501.7920 34897.6366  70.2%  9389 2314s
  2395  1708 23507.4656   14  118 20501.7920 34897.6366  70.2%  9521 2354s
  2489  1766 21931.2515   18  174 20501.7920 34897.6366  70.2%  9604 2398s
  2607  1857 21568.2101   23  116 20501.7920 34897.6366  70.2%  9625 2448s
  2734  1908 20976.8757   33  107 20501.7920 34897.6366  70.2%  9658 2492s
H 2765  1906                    20611.740407 34897.6366  69.3%  9650 2492s
  2813  2001 30592.3545   11  453 20611.7404 34897.6366  69.3%  9699 2546s
  2950  2110 25786.3511   12  367 20611.7404 34897.6366  69.3%  9771 2598s
  3097  2201 24195.8314   13  457 20611.7404 34897.6366  69.3%  9836 2655s
  3230  2299 23127.8806   14  412 20611.7404 34897.6366  69.3%  9913 2709s
  3414  2432 infeasible   15      20611.7404 34845.6987  69.1%  9840 2766s
  3648  2546 33367.9996    6  380 20611.7404 34845.4517  69.1%  9665 2825s
  3824  2690 31091.6998    7  291 20611.7404 34845.4517  69.1%  9636 2893s
H 4068  2690                    20673.792732 34845.4517  68.5%  9531 2929s
  4069  2691 21591.0866   55  503 20673.7927 34845.4517  68.5%  9529 3222s
  4071  2692 23218.1325   27  248 20673.7927 34845.4517  68.5%  9524 3241s
  4072  2693 33001.9733    7  547 20673.7927 34845.4517  68.5%  9522 3338s
  4073  2694 26408.9099   33  402 20673.7927 34845.4517  68.5%  9519 3407s
  4074  2694 30096.8120   15  518 20673.7927 34845.4517  68.5%  9517 3452s
  4075  2695 24440.4795   48  459 20673.7927 34845.4517  68.5%  9515 3477s
  4076  2696 22977.3342   56  406 20673.7927 34845.4517  68.5%  9512 3493s
  4077  2696 26705.2868   13  414 20673.7927 34845.4517  68.5%  9510 3507s
  4078  2697 32203.8457   18  407 20673.7927 34845.4517  68.5%  9508 3523s
  4079  2698 28511.5584   19  476 20673.7927 34845.4517  68.5%  9505 3534s
  4080  2698 22900.3018   33  465 20673.7927 34845.4517  68.5%  9503 3540s
  4081  2699 22794.8953   44  468 20673.7927 34845.4517  68.5%  9501 3550s
  4082  2700 22378.9509   31  418 20673.7927 34845.4517  68.5%  9498 3561s
  4083  2700 26837.4289   34  473 20673.7927 34845.4517  68.5%  9496 3571s
  4084  2701 23868.0196   65  478 20673.7927 34845.4517  68.5%  9494 3576s
  4085  2702 25310.7723   26  474 20673.7927 34845.4517  68.5%  9491 3583s
  4086  2702 33002.2495    7  468 20673.7927 34845.4517  68.5%  9489 3587s

Cutting planes:
  Learned: 1
  Implied bound: 33
  Projected implied bound: 318
  MIR: 441
  Mixing: 1
  Flow cover: 724
  RLT: 38
  Relax-and-lift: 133

Explored 4086 nodes (39766313 simplex iterations) in 3600.03 seconds (8907.54 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 20673.8 20611.7 20501.8 ... 20223.2

Time limit reached
Best objective 2.067379273193e+04, best bound 3.484545167156e+04, gap 68.5489%
  WARNING: Time limit reached. Using best solution found (gap: 68.55%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.10s
  Master Objective (UB) = 20673.79, θ = 166540.58
  Upper Bound (UB) = 20673.79

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 166540.58
  [DEBUG]   ✓ Scenario 0: θ = 166540.58 ≤ Q = 166540.58 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 166540.58 ≤ Q = 166540.58 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 166540.58 ≤ Q = 166540.58 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 166540.58 ≤ Q = 166540.58 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 166540.58 ≤ Q = 166540.58 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 166540.58 ≤ Q = 166540.58 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 166540.58 ≤ Q = 166540.58 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 166540.58 ≤ Q = 166540.58 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 166540.58 ≤ Q = 166540.58 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 166540.58 ≤ Q = 166540.58 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 166540.58 ≤ Q = 166540.58 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 166540.58 ≤ Q = 166540.58 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 12] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x4767bf20
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x4767bf20
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.330370e+13
Presolve removed 2581 rows and 1873 columns
Presolve time: 0.00s
Presolved: 512 rows, 516 columns, 1444 nonzeros
Found heuristic solution: objective 6773403.9821
Variable types: 350 continuous, 166 integer (166 binary)

Root relaxation: objective -1.457627e+05, 248 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -145762.67    0  123 6773403.98 -145762.67   102%     -    0s
H    0     0                    -110252.1590 -145762.67  32.2%     -    0s
H    0     0                    -111509.9289 -145762.67  30.7%     -    0s
     0     0 -121633.04    0   51 -111509.93 -121633.04  9.08%     -    0s
H    0     0                    -120005.1209 -121545.55  1.28%     -    0s
H    0     0                    -120626.8209 -121545.55  0.76%     -    0s
     0     0 -121074.69    0   51 -120626.82 -121074.69  0.37%     -    0s
     0     0 -121035.74    0   46 -120626.82 -121035.74  0.34%     -    0s
     0     0 -121035.74    0   51 -120626.82 -121035.74  0.34%     -    0s
     0     0 -121035.74    0   50 -120626.82 -121035.74  0.34%     -    0s
H    0     0                    -120646.7050 -121035.74  0.32%     -    0s
     0     0 -120808.96    0   13 -120646.70 -120808.96  0.13%     -    0s
     0     0 -120803.92    0   11 -120646.70 -120803.92  0.13%     -    0s
     0     0 -120770.13    0   10 -120646.70 -120770.13  0.10%     -    0s
     0     0 -120769.87    0   11 -120646.70 -120769.87  0.10%     -    0s
     0     0 -120753.49    0   11 -120646.70 -120753.49  0.09%     -    0s
     0     0 -120753.49    0   13 -120646.70 -120753.49  0.09%     -    0s
H    0     0                    -120666.7741 -120753.49  0.07%     -    0s
     0     0 -120669.83    0    2 -120666.77 -120669.83  0.00%     -    0s
*    0     0               0    -120667.3436 -120667.34  0.00%     -    0s

Cutting planes:
  Gomory: 6
  Implied bound: 3
  MIR: 7
  Flow cover: 9
  Relax-and-lift: 5

Explored 1 nodes (623 simplex iterations) in 0.07 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 8: -120667 -120667 -120647 ... 1.33037e+13
No other solutions better than -120667

Optimal solution found (tolerance 1.00e-06)
Best objective -1.206673436015e+05, best bound -1.206673436015e+05, gap 0.0000%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 159481.04
  Scenario: 21 demand increases, 39 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -120667.34
  [DEBUG]   S×d_nominal = 280148.38
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 280148.38 + -120667.34 = 159481.04
  [DEBUG]   Current θ from Master = 166540.58
  [DEBUG]   ⚠️  Z_SP ≤ θ by 7059.55 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 13614.24
  Lower Bound (LB) = 19998.82
  Gap (UB-LB) = 674.9725, Absolute Gap = 674.9725, Relative Gap = 0.032649
  Not converged yet (gap = 674.97 > ε = 200)

  [DEBUG] Adding NEW scenario 12 to Master Problem...
  [DEBUG] New scenario pattern: 21 increases, 39 decreases
    [DEBUG] Scenario 12 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 12 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 12]
    [DEBUG]   - Total constraints in model: 200153
    [DEBUG]   - Total variables in model: 83380
  [DEBUG] Total scenarios in Master: 13
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 13
================================================================================
[Iteration 13] Solving Master Problem...
  Current scenarios in Master: 13
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 200153 rows, 83380 columns and 567639 nonzeros
Model fingerprint: 0xd6e5b374
Variable types: 81121 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 88171 rows and 35811 columns
Presolve time: 1.74s
Presolved: 111982 rows, 47569 columns, 675498 nonzeros
Variable types: 45310 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -367877.2666
Found heuristic solution: objective -215351.9614

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.24s

Barrier statistics:
 Dense cols : 608
 AA' NZ     : 4.345e+06
 Factor NZ  : 1.087e+07 (roughly 150 MB of memory)
 Factor Ops : 3.021e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.72387950e+07  2.01369800e+08  9.76e+04 2.45e+01  7.40e+04     3s
   1  -1.31154259e+07  1.80435135e+08  6.81e+04 5.09e+01  5.11e+04     3s
   2  -4.73312186e+06  1.33894069e+08  2.47e+04 3.77e+00  1.97e+04     3s
   3  -8.58968563e+05  9.74786457e+07  1.75e+03 1.63e+00  1.78e+03     3s
   4  -4.98134343e+05  3.47297286e+07  4.10e+02 3.60e-01  4.38e+02     3s
   5  -3.33985067e+05  2.41086931e+07  8.33e+01 2.23e-01  1.69e+02     3s
   6  -2.47335358e+05  1.72587747e+07  3.48e+01 1.50e-01  1.03e+02     3s
   7  -1.33890767e+05  1.24488792e+07  1.02e+01 1.04e-01  6.56e+01     3s
   8  -9.50255534e+04  6.64588034e+06  6.04e+00 5.28e-02  3.44e+01     3s
   9  -5.56279818e+04  3.35021748e+06  2.94e+00 2.55e-02  1.70e+01     3s
  10  -2.76990203e+04  1.14746891e+06  1.40e+00 8.18e-03  5.81e+00     4s
  11  -2.15541589e+03  3.12388026e+05  5.83e-01 1.66e-03  1.55e+00     4s
  12   8.07052706e+03  1.62289565e+05  3.73e-01 1.26e-03  7.56e-01     4s
  13   1.22124846e+04  1.35063049e+05  3.09e-01 1.19e-03  6.02e-01     4s
  14   1.71148294e+04  1.14883906e+05  2.46e-01 1.06e-03  4.79e-01     4s
  15   2.11739951e+04  1.02533734e+05  2.12e-01 1.18e-03  3.99e-01     4s
  16   2.71651982e+04  8.72634615e+04  1.66e-01 1.55e-03  2.94e-01     4s
  17   3.12363481e+04  7.46168864e+04  1.36e-01 1.41e-03  2.13e-01     4s
  18   3.50263842e+04  6.99647076e+04  1.10e-01 1.53e-03  1.71e-01     4s
  19   3.72888392e+04  6.55834723e+04  9.45e-02 1.63e-03  1.39e-01     4s
  20   3.84386994e+04  6.15349111e+04  8.63e-02 1.91e-03  1.13e-01     4s
  21   4.09461362e+04  5.85406643e+04  7.01e-02 2.00e-03  8.62e-02     4s
  22   4.27162466e+04  5.77288968e+04  5.86e-02 1.74e-03  7.36e-02     4s
  23   4.39441714e+04  5.64916568e+04  5.08e-02 1.46e-03  6.15e-02     4s
  24   4.48688269e+04  5.52092090e+04  4.51e-02 1.38e-03  5.07e-02     4s
  25   4.58186572e+04  5.45158009e+04  3.88e-02 1.64e-03  4.26e-02     4s
  26   4.62210749e+04  5.41065029e+04  3.63e-02 1.37e-03  3.87e-02     4s
  27   4.75836913e+04  5.35958145e+04  2.81e-02 9.07e-04  2.95e-02     4s
  28   4.86536786e+04  5.32406632e+04  2.11e-02 1.05e-03  2.25e-02     4s
  29   4.88906252e+04  5.29507195e+04  1.96e-02 8.57e-04  1.99e-02     5s
  30   4.91248431e+04  5.27623258e+04  1.80e-02 7.31e-04  1.78e-02     5s
  31   4.96300841e+04  5.25776916e+04  1.48e-02 5.36e-04  1.45e-02     5s
  32   4.97093307e+04  5.24708599e+04  1.43e-02 4.28e-04  1.35e-02     5s
  33   5.02904656e+04  5.23723414e+04  1.08e-02 3.25e-04  1.02e-02     5s
  34   5.05014387e+04  5.22789165e+04  9.43e-03 1.98e-04  8.72e-03     5s
  35   5.06653283e+04  5.22492258e+04  8.41e-03 1.73e-04  7.77e-03     5s
  36   5.08283611e+04  5.22102740e+04  7.38e-03 1.43e-04  6.78e-03     5s
  37   5.10441041e+04  5.21505582e+04  5.98e-03 4.03e-04  5.43e-03     5s
  38   5.13137719e+04  5.21284188e+04  4.32e-03 3.12e-04  4.00e-03     5s
  39   5.14519256e+04  5.21144685e+04  3.44e-03 2.83e-04  3.25e-03     5s
  40   5.15180332e+04  5.20981818e+04  3.03e-03 2.27e-04  2.85e-03     5s
  41   5.15851939e+04  5.20707262e+04  2.60e-03 1.70e-04  2.38e-03     5s
  42   5.16536244e+04  5.20452200e+04  2.16e-03 9.24e-05  1.92e-03     5s
  43   5.17500245e+04  5.20372554e+04  1.56e-03 6.77e-05  1.41e-03     5s
  44   5.18422798e+04  5.20212948e+04  9.90e-04 8.84e-05  8.78e-04     6s
  45   5.18885424e+04  5.20181290e+04  7.08e-04 6.04e-05  6.36e-04     6s
  46   5.18911339e+04  5.20171443e+04  6.93e-04 5.42e-05  6.18e-04     6s
  47   5.19229340e+04  5.20138979e+04  5.00e-04 2.83e-05  4.46e-04     6s
  48   5.19565149e+04  5.20129365e+04  2.99e-04 2.32e-05  2.77e-04     6s
  49   5.19751977e+04  5.20104421e+04  1.92e-04 3.38e-05  1.73e-04     6s
  50   5.19841625e+04  5.20094506e+04  1.39e-04 1.31e-05  1.24e-04     6s
  51   5.19910889e+04  5.20091669e+04  9.79e-05 7.85e-06  8.87e-05     6s
  52   5.19985220e+04  5.20087808e+04  5.32e-05 2.35e-06  5.03e-05     6s
  53   5.20043123e+04  5.20085355e+04  2.12e-05 2.15e-06  2.07e-05     6s
  54   5.20076253e+04  5.20084714e+04  5.08e-06 2.18e-06  4.14e-06     6s
  55   5.20082726e+04  5.20084006e+04  2.03e-07 1.07e-06  6.25e-07     6s
  56   5.20083307e+04  5.20083308e+04  1.39e-09 1.42e-08  6.40e-10     6s

Barrier solved model in 56 iterations and 6.20 seconds (10.71 work units)
Optimal objective 5.20083307e+04


Root crossover log...

   87763 DPushes remaining with DInf 0.0000000e+00                 6s
       0 DPushes remaining with DInf 0.0000000e+00                 9s

    5810 PPushes remaining with PInf 1.8239557e-05                 9s
       0 PPushes remaining with PInf 0.0000000e+00                 9s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.9646673e+02      9s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   41271    5.2008331e+04   0.000000e+00   3.964667e+02      9s
   41299    5.2008331e+04   0.000000e+00   0.000000e+00      9s
   41299    5.2008331e+04   0.000000e+00   0.000000e+00      9s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 5.200833e+04, 41299 iterations, 7.09 seconds (16.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 52008.3308    0  424 -215351.96 52008.3308   124%     -    9s
H    0     0                    -211413.4927 52008.3308   125%     -    9s
H    0     0                    -96926.50645 52008.3308   154%     -   10s
H    0     0                    -96750.39234 52008.3308   154%     -   10s
H    0     0                    -94889.04016 52008.3308   155%     -   10s
H    0     0                    -94752.58921 52008.3308   155%     -   10s
H    0     0                    -94687.09544 52008.3308   155%     -   10s
H    0     0                    -79988.58929 52008.3308   165%     -   10s
H    0     0                    -79422.84713 52008.3308   165%     -   10s
H    0     0                    -21162.59996 52008.3308   346%     -   10s
H    0     0                    -20596.01797 52008.3308   353%     -   10s
H    0     0                    -12692.07859 52008.3308   510%     -   10s
H    0     0                    -12561.73552 52008.3308   514%     -   10s
H    0     0                    -12335.56947 52008.3308   522%     -   10s
H    0     0                    -11913.33404 52008.3308   537%     -   12s
H    0     0                    -11581.39591 52008.3308   549%     -   12s
H    0     0                    -10734.77935 52008.3308   584%     -   12s
H    0     0                    -10731.68958 52008.3308   585%     -   12s
     0     0 46116.0475    0  497 -10731.690 46116.0475   530%     -   62s
H    0     0                    -6712.100072 46116.0475   787%     -   62s
H    0     0                    -3261.025758 46116.0475  1514%     -   62s
H    0     0                    -3110.358011 46116.0475  1583%     -   62s
H    0     0                    -3038.232168 46116.0475  1618%     -   62s
H    0     0                    -2185.936686 46116.0475  2210%     -   62s
H    0     0                    -2176.114150 46116.0475  2219%     -   62s
     0     0 45809.2937    0  482 -2176.1142 45809.2937  2205%     -   84s
     0     0 45625.4313    0  496 -2176.1142 45625.4313  2197%     -   97s
     0     0 45252.9444    0  491 -2176.1142 45252.9444  2180%     -  115s
     0     0 45053.7870    0  499 -2176.1142 45053.7870  2170%     -  127s
     0     0 44960.1978    0  501 -2176.1142 44960.1978  2166%     -  140s
     0     0 44943.6092    0  497 -2176.1142 44943.6092  2165%     -  153s
     0     0 44943.6092    0  496 -2176.1142 44943.6092  2165%     -  157s
     0     0 44943.6092    0  493 -2176.1142 44943.6092  2165%     -  167s
     0     0 44943.6092    0  497 -2176.1142 44943.6092  2165%     -  173s
     0     0 44943.6092    0  496 -2176.1142 44943.6092  2165%     -  174s
H    0     0                     308.7890269 41880.1025      -     -  244s
H    0     0                    2802.8509520 41880.1025  1394%     -  244s
H    0     0                    3920.5627663 41880.1025   968%     -  244s
H    0     0                    3988.7734513 41880.1025   950%     -  244s
H    0     0                    3993.8535762 41880.1025   949%     -  244s
     0     0 41880.1025    0  531 3993.85358 41880.1025   949%     -  244s
H    0     0                    11702.243001 41880.0406   258%     -  244s
H    0     0                    12492.348019 41880.0406   235%     -  244s
     0     0 40946.9269    0  604 12492.3480 40946.9269   228%     -  289s
     0     0 40524.2661    0  602 12492.3480 40524.2661   224%     -  320s
     0     0 40392.0122    0  596 12492.3480 40392.0122   223%     -  336s
     0     0 40289.6469    0  596 12492.3480 40289.6469   223%     -  352s
     0     0 40215.8706    0  603 12492.3480 40215.8706   222%     -  366s
     0     0 40183.9720    0  604 12492.3480 40183.9720   222%     -  376s
     0     0 40122.2173    0  610 12492.3480 40122.2173   221%     -  385s
     0     0 40097.4860    0  596 12492.3480 40097.4860   221%     -  392s
     0     0 40083.7337    0  601 12492.3480 40083.7337   221%     -  399s
     0     0 40071.6158    0  591 12492.3480 40071.6158   221%     -  405s
     0     0 40068.0865    0  604 12492.3480 40068.0865   221%     -  409s
     0     0 40065.4532    0  603 12492.3480 40065.4532   221%     -  412s
     0     0 40064.5872    0  603 12492.3480 40064.5872   221%     -  414s
     0     0 38206.6002    0  614 12492.3480 38206.6002   206%     -  498s
H    0     0                    12569.623812 38206.3522   204%     -  498s
H    0     0                    12594.234329 38206.3522   203%     -  498s
     0     0 37975.2371    0  583 12594.2343 37975.2371   202%     -  523s
     0     0 37818.5237    0  504 12594.2343 37818.5237   200%     -  543s
H    0     0                    13452.052280 37750.2697   181%     -  556s
H    0     0                    15641.120736 37750.2697   141%     -  556s
     0     0 37750.2697    0  567 15641.1207 37750.2697   141%     -  556s
     0     0 37641.4001    0  398 15641.1207 37641.4001   141%     -  568s
     0     0 37584.8196    0  390 15641.1207 37584.8196   140%     -  578s
     0     0 37562.2171    0  625 15641.1207 37562.2171   140%     -  590s
     0     0 37534.5658    0  608 15641.1207 37534.5658   140%     -  598s
     0     0 37516.0582    0  579 15641.1207 37516.0582   140%     -  604s
     0     0 37499.5734    0  564 15641.1207 37499.5734   140%     -  610s
     0     0 37493.1690    0  575 15641.1207 37493.1690   140%     -  613s
     0     0 37491.9526    0  586 15641.1207 37491.9526   140%     -  617s
     0     0 36835.8686    0  584 15641.1207 36835.8686   136%     -  655s
     0     0 36719.9108    0  422 15641.1207 36719.9108   135%     -  670s
     0     0 36670.2595    0  632 15641.1207 36670.2595   134%     -  682s
     0     0 36635.5752    0  649 15641.1207 36635.5752   134%     -  691s
     0     0 36621.6351    0  656 15641.1207 36621.6351   134%     -  697s
     0     0 36547.2737    0  652 15641.1207 36547.2737   134%     -  708s
H    0     0                    15734.443451 36537.3661   132%     -  715s
     0     0 36537.3661    0  687 15734.4435 36537.3661   132%     -  715s
     0     0 36524.4358    0  664 15734.4435 36524.4358   132%     -  721s
     0     0 36522.1582    0  672 15734.4435 36522.1582   132%     -  723s
     0     0 36399.8159    0  413 15734.4435 36399.8159   131%     -  743s
     0     0 36354.0657    0  566 15734.4435 36354.0657   131%     -  758s
     0     0 36347.6165    0  557 15734.4435 36347.6165   131%     -  763s
     0     0 36337.6244    0  551 15734.4435 36337.6244   131%     -  770s
     0     0 36329.3360    0  462 15734.4435 36329.3360   131%     -  777s
     0     0 36327.1433    0  464 15734.4435 36327.1433   131%     -  779s
     0     0 36219.6573    0  686 15734.4435 36219.6573   130%     -  798s
H    0     0                    16713.702743 36219.5059   117%     -  806s
H    0     0                    16948.251596 36219.5059   114%     -  807s
H    0     0                    18205.210006 36219.5059  99.0%     -  807s
H    0     0                    18344.035176 36219.5059  97.4%     -  807s
H    0     0                    18362.410982 36219.5059  97.2%     -  807s
H    0     0                    18399.276347 36219.5059  96.9%     -  807s
     0     0 36208.6973    0  439 18399.2763 36208.6973  96.8%     -  813s
     0     0 36176.2435    0  678 18399.2763 36176.2435  96.6%     -  823s
     0     0 36166.5712    0  678 18399.2763 36166.5712  96.6%     -  830s
     0     0 36160.2743    0  698 18399.2763 36160.2743  96.5%     -  834s
     0     0 36158.1704    0  638 18399.2763 36158.1704  96.5%     -  836s
     0     0 36107.5155    0  663 18399.2763 36107.5155  96.2%     -  847s
     0     0 36088.6306    0  440 18399.2763 36088.6306  96.1%     -  856s
     0     0 36082.5376    0  442 18399.2763 36082.5376  96.1%     -  860s
     0     0 36077.9759    0  447 18399.2763 36077.9759  96.1%     -  862s
     0     0 36077.3905    0  446 18399.2763 36077.3905  96.1%     -  863s
     0     0 36071.5745    0  443 18399.2763 36071.5745  96.0%     -  868s
H    0     0                    18647.504649 36071.4116  93.4%     -  868s
     0     0 36067.0453    0  437 18647.5046 36067.0453  93.4%     -  870s
     0     0 36064.8849    0  443 18647.5046 36064.8849  93.4%     -  873s
     0     0 36047.2605    0  668 18647.5046 36047.2605  93.3%     -  883s
H    0     0                    18700.565133 36045.5515  92.8%     -  883s
     0     0 36041.7346    0  446 18700.5651 36041.7346  92.7%     -  886s
     0     0 36040.9002    0  443 18700.5651 36040.9002  92.7%     -  887s
     0     0 36036.9978    0  444 18700.5651 36036.9978  92.7%     -  889s
     0     0 36036.9722    0  444 18700.5651 36036.9722  92.7%     -  893s
H    0     0                    19229.227570 36036.9599  87.4%     -  987s
H    0     0                    19245.949473 36036.9599  87.2%     -  987s
H    0     0                    19543.562904 36036.9267  84.4%     - 1084s
H    0     0                    19936.220141 36036.9267  80.8%     - 1095s
H    0     0                    19965.071825 36036.9267  80.5%     - 1095s
H    0     0                    20151.719966 36036.9267  78.8%     - 1100s
H    0     0                    20177.175087 36036.9267  78.6%     - 1100s
H    0     0                    20180.182139 36036.9267  78.6%     - 1100s
H    0     0                    20215.219528 36036.9267  78.3%     - 1100s
H    0     0                    20489.545001 36036.9267  75.9%     - 1103s
H    0     0                    20501.792028 36036.9267  75.8%     - 1103s
     0     2 36036.9267    0  444 20501.7920 36036.9267  75.8%     - 1177s
     1     3 35452.1734    1  344 20501.7920 36036.9267  75.8% 13187 1191s
     2     4 35841.4313    1  434 20501.7920 35841.4313  74.8% 11768 1201s
     3     6 35245.5061    2  387 20501.7920 35841.4152  74.8% 10065 1212s
     5     9 35164.1502    3  318 20501.7920 35841.4152  74.8%  8442 1227s
     8    16 35087.2215    3  496 20501.7920 35617.1987  73.7%  8865 1253s
    15    30 34870.9076    4  626 20501.7920 35518.0288  73.2% 10874 1279s
    29    44 32448.5589    5  401 20501.7920 35518.0288  73.2% 17103 1381s
    43    74 31950.2740    5  367 20501.7920 35361.6844  72.5% 18516 1577s
    73   180 34352.0370    7  328 20501.7920 35361.6844  72.5% 18341 1622s
   179   210 33931.4434    8  306 20501.7920 35361.6844  72.5% 12552 1662s
   209   245 34074.0378    9  388 20501.7920 35361.6844  72.5% 11590 1737s
   244   282 33591.1375    9  386 20501.7920 35361.6844  72.5% 10873 1765s
   281   314 34037.8836   10  383 20501.7920 35361.6844  72.5% 10118 1819s
   313   345 34008.3074   11  370 20501.7920 35361.6844  72.5%  9673 1886s
   344   376 33903.6744   12  365 20501.7920 35361.6844  72.5%  9280 1908s
   377   406 33878.1384   12  365 20501.7920 35361.6844  72.5%  9037 1934s
   409   438 33867.9586   13  377 20501.7920 35361.6844  72.5%  8796 1959s
   441   467 23024.8041   16  173 20501.7920 35361.6844  72.5%  8632 1983s
   476   498 33803.3880   14  372 20501.7920 35361.6844  72.5%  8576 2010s
   507   526 33535.4877   15  362 20501.7920 35361.6844  72.5%  8629 2040s
   541   560 33632.9135   15  500 20501.7920 35361.6844  72.5%  8572 2067s
   575   591 22586.5422   20  173 20501.7920 35361.6844  72.5%  8631 2097s
   606   622 33609.7637   16  436 20501.7920 35361.6844  72.5%  8761 2147s
   639   653 33506.6236   17  445 20501.7920 35361.6844  72.5%  8721 2173s
   672   686 32917.9387   17  432 20501.7920 35361.6844  72.5%  8640 2194s
   707   712 33398.9367   18  444 20501.7920 35361.6844  72.5%  8587 2232s
   739   744 33439.7242   18  296 20501.7920 35361.6844  72.5%  8497 2256s
   773   777 33383.1948   19  444 20501.7920 35361.6844  72.5%  8539 2285s
   812   812 31707.3565   20  322 20501.7920 35361.6844  72.5%  8751 2312s
   853   840 32336.2369   20  431 20501.7920 35361.6844  72.5%  8825 2342s
   898   873 31542.5316   21  396 20501.7920 35361.6844  72.5%  8886 2377s
   945   921 30310.2351   21  244 20501.7920 35361.6844  72.5%  8930 2411s
  1001   944 31460.3700   22  413 20501.7920 35361.6844  72.5%  8908 2445s
  1056   984 31439.0865   23  477 20501.7920 35361.6844  72.5%  8948 2481s
  1116  1030 31366.6547   24  321 20501.7920 35361.6844  72.5%  8989 2519s
  1186  1075 29350.0813   25  533 20501.7920 35361.6844  72.5%  9096 2556s
  1271  1133 31194.7600   25  317 20501.7920 35361.6844  72.5%  9210 2597s
  1349  1183 30186.1931   26  378 20501.7920 35361.6844  72.5%  9198 2637s
  1435  1244 27051.8185   27  436 20501.7920 35361.6844  72.5%  9209 2683s
  1526  1352 27054.5458   27  405 20501.7920 35361.6844  72.5%  9237 2728s
  1650  1382 26849.2669   28  281 20501.7920 35361.6844  72.5%  9202 2806s
  1684  1405 26807.1232   29  233 20501.7920 35361.6844  72.5%  9300 2902s
  1729  1436 26735.5582   30  237 20501.7920 35361.6844  72.5%  9425 2971s
  1782  1485 25977.5569   31  514 20501.7920 35361.6844  72.5%  9472 3026s
  1845  1545 24900.0393   31  201 20501.7920 35361.6844  72.5%  9461 3078s
  1913  1580 24716.2527   32  432 20501.7920 35361.6844  72.5%  9453 3127s
  1977  1627 infeasible   32      20501.7920 34965.4220  70.5%  9444 3192s
  2048  1687 24550.2945   34  458 20501.7920 34964.2582  70.5%  9470 3246s
  2120  1728 24486.8401   35  418 20501.7920 34964.2582  70.5%  9455 3306s
  2203  1780 24400.4943   36  405 20501.7920 34964.2582  70.5%  9468 3362s
  2303  1850 24287.1256   37  353 20501.7920 34964.2582  70.5%  9440 3425s
  2425  1935 24056.5685   40  357 20501.7920 34964.2582  70.5%  9334 3496s
  2556  2035 23168.4826   47  270 20501.7920 34870.3758  70.1%  9289 3566s
  2698  2101 22055.8177   59  254 20501.7920 34870.3758  70.1%  9291 3600s

Cutting planes:
  Learned: 5
  Implied bound: 339
  MIR: 3427
  Flow cover: 3199
  RLT: 193
  Relax-and-lift: 1067

Explored 2800 nodes (26680256 simplex iterations) in 3600.05 seconds (9906.26 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 20501.8 20489.5 20215.2 ... 19245.9

Time limit reached
Best objective 2.050179202792e+04, best bound 3.487037575855e+04, gap 70.0845%
  WARNING: Time limit reached. Using best solution found (gap: 70.08%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = 20501.79, θ = 167614.01
  Upper Bound (UB) = 20501.79

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 167614.01
  [DEBUG]   ✓ Scenario 0: θ = 167614.01 ≤ Q = 167614.01 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 167614.01 ≤ Q = 167614.01 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 167614.01 ≤ Q = 167614.01 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 167614.01 ≤ Q = 167614.01 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 167614.01 ≤ Q = 167614.01 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 167614.01 ≤ Q = 167614.01 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 167614.01 ≤ Q = 167614.01 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 167614.01 ≤ Q = 167614.01 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 167614.01 ≤ Q = 167614.01 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 167614.01 ≤ Q = 167614.01 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 167614.01 ≤ Q = 167614.01 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 167614.01 ≤ Q = 167614.01 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 167614.01 ≤ Q = 167614.01 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 13] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0xc6ce02
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x00c6ce02
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [5e-13, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [9e-14, 2e+02]
Found heuristic solution: objective 1.356222e+13
Presolve removed 2580 rows and 1872 columns
Presolve time: 0.00s
Presolved: 513 rows, 517 columns, 1447 nonzeros
Found heuristic solution: objective 6904748.8299
Variable types: 351 continuous, 166 integer (166 binary)

Root relaxation: objective -1.445901e+05, 249 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -144590.14    0  123 6904748.83 -144590.14   102%     -    0s
H    0     0                    -109092.6159 -144590.14  32.5%     -    0s
H    0     0                    -110359.1066 -144590.14  31.0%     -    0s
     0     0 -112908.33    0   32 -110359.11 -112908.33  2.31%     -    0s
H    0     0                    -110823.7449 -112898.28  1.87%     -    0s
H    0     0                    -111781.6550 -112898.28  1.00%     -    0s
     0     0 -112791.77    0   32 -111781.66 -112791.77  0.90%     -    0s
     0     0 -112759.68    0   32 -111781.66 -112759.68  0.87%     -    0s
H    0     2                    -111793.1939 -112759.68  0.86%     -    0s
     0     2 -112759.68    0   32 -111793.19 -112759.68  0.86%     -    0s
*   11     7               3    -112575.3233 -112648.28  0.06%   7.5    0s

Cutting planes:
  Gomory: 2
  MIR: 135

Explored 22 nodes (637 simplex iterations) in 0.05 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 8: -112575 -111793 -111782 ... 1.35622e+13
No other solutions better than -112575

Optimal solution found (tolerance 1.00e-06)
Best objective -1.125753232823e+05, best bound -1.125753232823e+05, gap 0.0000%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 167573.06
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -112575.32
  [DEBUG]   S×d_nominal = 280148.38
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 280148.38 + -112575.32 = 167573.06
  [DEBUG]   Current θ from Master = 167614.01
  [DEBUG]   ⚠️  Z_SP ≤ θ by 40.95 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 20460.84
  Lower Bound (LB) = 20460.84
  Gap (UB-LB) = 40.9540, Absolute Gap = 40.9540, Relative Gap = 0.001998
  *** CONVERGED (gap within tolerance) ***

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 13
Total Time: 32158.89s
Converged: True
Final Lower Bound: 20460.8381
Final Upper Bound: 20501.7920
Final Gap: 40.953956
Number of Critical Scenarios: 13
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [1] (1/3)
Product 1 Plants: [2] (1/3)
Product 2 Plants: [0] (1/3)
Total Plant Openings: 3
DCs Opened: [1, 2, 4, 6] (4/10)
Active Routes (Plant→DC): 12
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 0 customers  Mode 1: 0 customers  Mode 2: 50 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 13
Start Time: 2026-01-03 00:24:52
End Time: 2026-01-03 09:20:50
Total Time: 32158.89s
Optimal Value: 20460.84
Lower Bound: 20460.84
Upper Bound: 20501.79
Gap: 40.953956
Plants Opened: {0: [1], 1: [2], 2: [0]} (3 plants)
DCs Opened: [1, 2, 4, 6] (4 DCs)
================================================================================

Results saved to: result/DH_single_full_seed31_Mixed_gamma20_20260103_092051.csv

Total Execution Time: 32161.06 seconds
End Time: 2026-01-03 09:20:53

All tasks completed successfully!

