
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 13
DI Scenario: HD
Start Time: 2026-01-03 09:45:24
================================================================================
Loading data from data/DH_data_full_seed13.pkl...

Applying DI scenario: HD
DI values:
  Product 0: ['1.000', '1.413', '1.996'] (k=0.852)
  Product 1: ['1.000', '1.320', '1.743'] (k=0.685)
  Product 2: ['1.000', '1.358', '1.844'] (k=0.755)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=916, max=1753
  DC capacity (MC): min=475, max=856

Demand Structure (s_rk matrix):
  Total customer-product pairs: 80/150 (46.7% sparse)
  Average products per customer: 1.60

Demand (only non-zero entries):
  Nominal (μ): min=8.12, max=34.71, count=80
  Deviation (μ̂): min=4.05, max=9.96

Costs:
  Plant fixed cost: min=6124, max=9786
  DC fixed cost: min=3012, max=5993
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.413', '1.996'] (k=0.852)
    Product 1: ['1.000', '1.320', '1.743'] (k=0.685)
    Product 2: ['1.000', '1.358', '1.844'] (k=0.755)
  MD:
    Product 0: ['1.000', '1.286', '1.653'] (k=0.620)
    Product 1: ['1.000', '1.212', '1.468'] (k=0.473)
    Product 2: ['1.000', '1.148', '1.318'] (k=0.341)
  LD:
    Product 0: ['1.000', '1.004', '1.007'] (k=0.009)
    Product 1: ['1.000', '1.039', '1.080'] (k=0.094)
    Product 2: ['1.000', '1.030', '1.061'] (k=0.073)
  Mixed:
    Product 0: ['1.000', '1.413', '1.996'] (k=0.852)
    Product 1: ['1.000', '1.212', '1.468'] (k=0.473)
    Product 2: ['1.000', '1.030', '1.061'] (k=0.073)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48750 nonzeros
Model fingerprint: 0x5d8f624b
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11871 rows and 2871 columns
Presolve time: 0.12s
Presolved: 4802 rows, 5629 columns, 33384 nonzeros
Variable types: 3370 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -266243.3461
Found heuristic solution: objective -180743.6115

Root relaxation: objective 1.459251e+05, 4890 iterations, 0.29 seconds (0.31 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 145925.148    0  462 -180743.61 145925.148   181%     -    0s
H    0     0                    -168791.6809 145925.148   186%     -    0s
     0     0 127619.763    0  680 -168791.68 127619.763   176%     -    1s
     0     0 127490.032    0  627 -168791.68 127490.032   176%     -    1s
     0     0 127472.431    0  631 -168791.68 127472.431   176%     -    1s
     0     0 127468.121    0  630 -168791.68 127468.121   176%     -    1s
     0     0 117990.341    0  792 -168791.68 117990.341   170%     -    3s
     0     0 117502.102    0  793 -168791.68 117502.102   170%     -    3s
     0     0 117462.840    0  800 -168791.68 117462.840   170%     -    3s
     0     0 117452.977    0  798 -168791.68 117452.977   170%     -    3s
     0     0 117452.572    0  794 -168791.68 117452.572   170%     -    3s
H    0     0                    -167956.7487 106327.917   163%     -    4s
H    0     0                    -166093.0875 106327.917   164%     -    4s
     0     0 106327.917    0  582 -166093.09 106327.917   164%     -    4s
H    0     0                    -164148.1619 106327.313   165%     -    4s
H    0     0                    -116662.8341 99990.5410   186%     -    5s
H    0     0                    -104068.9362 99990.5410   196%     -    5s
H    0     0                    -98176.52703 99990.5410   202%     -    5s
H    0     0                    -54874.96838 99990.5410   282%     -    5s
H    0     0                    39358.887906 99990.5410   154%     -    5s
H    0     0                    39730.746437 99990.5410   152%     -    5s
     0     0 99990.5410    0  483 39730.7464 99990.5410   152%     -    5s
     0     0 99546.1825    0  503 39730.7464 99546.1825   151%     -    5s
     0     0 99414.4646    0  541 39730.7464 99414.4646   150%     -    5s
     0     0 99407.8263    0  554 39730.7464 99407.8263   150%     -    5s
H    0     0                    42564.021259 99407.8263   134%     -    6s
H    0     0                    42570.120659 93708.8298   120%     -    7s
H    0     0                    42906.454933 93708.8298   118%     -    7s
H    0     0                    43016.701972 93708.8298   118%     -    7s
H    0     0                    43039.730117 93708.8298   118%     -    7s
H    0     0                    45514.158153 93708.8298   106%     -    7s
     0     0 93708.8298    0  599 45514.1582 93708.8298   106%     -    7s
H    0     0                    45672.893308 92663.0057   103%     -    8s
H    0     0                    45822.414933 92663.0057   102%     -    8s
H    0     0                    45834.644818 92663.0057   102%     -    8s
H    0     0                    45968.100040 92663.0057   102%     -    8s
H    0     0                    45973.170985 92663.0057   102%     -    8s
H    0     0                    46041.339883 92663.0057   101%     -    8s
H    0     0                    47150.173732 92663.0057  96.5%     -    8s
     0     0 92663.0057    0  639 47150.1737 92663.0057  96.5%     -    8s
     0     0 92395.6674    0  689 47150.1737 92395.6674  96.0%     -    8s
     0     0 92355.5100    0  683 47150.1737 92355.5100  95.9%     -    8s
     0     0 92349.3930    0  697 47150.1737 92349.3930  95.9%     -    8s
     0     0 90422.9553    0  643 47150.1737 90422.9553  91.8%     -    9s
     0     0 90073.7454    0  691 47150.1737 90073.7454  91.0%     -   10s
     0     0 89959.7826    0  694 47150.1737 89959.7826  90.8%     -   10s
     0     0 89939.7286    0  708 47150.1737 89939.7286  90.8%     -   10s
     0     0 88506.5873    0  689 47150.1737 88506.5873  87.7%     -   11s
     0     0 88114.6425    0  729 47150.1737 88114.6425  86.9%     -   11s
     0     0 88051.5772    0  732 47150.1737 88051.5772  86.7%     -   12s
     0     0 88033.3076    0  738 47150.1737 88033.3076  86.7%     -   12s
H    0     0                    49606.484871 87042.4848  75.5%     -   13s
H    0     0                    49628.613734 87042.4848  75.4%     -   13s
H    0     0                    50285.234168 87042.4848  73.1%     -   13s
H    0     0                    50789.008418 87042.4848  71.4%     -   13s
H    0     0                    50911.455774 87042.4848  71.0%     -   13s
H    0     0                    51147.021160 87042.4848  70.2%     -   13s
H    0     0                    51381.721706 87042.4848  69.4%     -   13s
     0     0 87042.4848    0  693 51381.7217 87042.4848  69.4%     -   13s
H    0     0                    51398.410357 86668.9103  68.6%     -   13s
H    0     0                    53658.799884 86668.9103  61.5%     -   13s
H    0     0                    54714.714232 86668.9103  58.4%     -   13s
H    0     0                    54940.188771 86668.9103  57.8%     -   13s
H    0     0                    55004.733558 86668.9103  57.6%     -   13s
     0     0 86668.9103    0  705 55004.7336 86668.9103  57.6%     -   13s
     0     0 86609.8899    0  727 55004.7336 86609.8899  57.5%     -   13s
H    0     0                    55077.811033 86549.7068  57.1%     -   14s
     0     0 86549.7068    0  748 55077.8110 86549.7068  57.1%     -   14s
     0     0 86537.3306    0  735 55077.8110 86537.3306  57.1%     -   14s
H    0     0                    55209.891382 86537.3306  56.7%     -   14s
     0     0 85748.2712    0  681 55209.8914 85748.2712  55.3%     -   15s
     0     0 85555.7659    0  716 55209.8914 85555.7659  55.0%     -   16s
     0     0 85479.2757    0  727 55209.8914 85479.2757  54.8%     -   16s
     0     0 85464.6734    0  729 55209.8914 85464.6734  54.8%     -   16s
     0     0 84954.3661    0  662 55209.8914 84954.3661  53.9%     -   17s
     0     0 84821.0172    0  777 55209.8914 84821.0172  53.6%     -   18s
     0     0 84748.1208    0  809 55209.8914 84748.1208  53.5%     -   18s
     0     0 84697.6279    0  744 55209.8914 84697.6279  53.4%     -   18s
     0     0 84685.6321    0  823 55209.8914 84685.6321  53.4%     -   18s
H    0     0                    55279.548989 84372.2859  52.6%     -   20s
H    0     0                    55329.494997 84372.2859  52.5%     -   20s
     0     0 84372.2859    0  668 55329.4950 84372.2859  52.5%     -   20s
     0     0 84291.9854    0  682 55329.4950 84291.9854  52.3%     -   20s
     0     0 84264.2855    0  681 55329.4950 84264.2855  52.3%     -   20s
     0     0 84051.4313    0  720 55329.4950 84051.4313  51.9%     -   21s
     0     0 84050.9436    0  720 55329.4950 84050.9436  51.9%     -   21s
     0     2 84050.6713    0  720 55329.4950 84050.6713  51.9%     -   22s
     7    16 82085.1882    3  502 55329.4950 83699.3273  51.3%  1612   26s
    95   236 77535.5630    7  521 55329.4950 82934.1791  49.9%  1236   30s
H  115   236                    55915.583249 82934.1791  48.3%  1086   30s
H  321   410                    56018.080175 82934.1791  48.0%   631   32s
H  321   410                    56205.585976 82934.1791  47.6%   631   32s
H  526   555                    56276.776712 82934.1791  47.4%   545   34s
H  542   555                    56312.469556 82934.1791  47.3%   542   34s
   554   587 76008.0503   17  455 56312.4696 82934.1791  47.3%   542   35s
H  702   729                    56383.660291 82934.1791  47.1%   567   36s
   984  1053 70586.7922   24  339 56383.6603 82918.6865  47.1%   535   40s
H 1014  1053                    56956.609983 82918.6865  45.6%   540   40s
H 1191  1234                    56966.652299 82829.1288  45.4%   509   42s
H 1210  1234                    57151.258692 82829.1288  44.9%   504   42s
H 1350  1315                    57189.660329 82758.1978  44.7%   503   44s
H 1362  1315                    57191.385678 82758.1978  44.7%   503   44s
  1537  1577 66443.6112   39  262 57191.3857 82758.1978  44.7%   484   46s
H 1579  1577                    57229.787315 82758.1978  44.6%   477   46s
H 1604  1577                    57242.027163 82758.1978  44.6%   474   46s
H 2396  2351                    57512.623259 82748.8052  43.9%   403   48s
  2486  2643 infeasible   75      57512.6233 82748.8052  43.9%   396   50s
H 2836  2709                    57560.928930 82748.8052  43.8%   369   51s
H 2937  3048                    57578.186105 82748.8052  43.7%   362   51s
H 3216  3048                    57616.837314 82748.8052  43.6%   343   51s
  3976  3851 68416.9759   27  150 57616.8373 82726.8575  43.6%   309   55s
  4286  3883 80529.3598   18  720 57616.8373 82726.8575  43.6%   303   65s
  4317  3904 64795.2113  105  351 57616.8373 80584.1646  39.9%   301   71s
  4574  4095 71099.6414   20  304 57616.8373 79403.0269  37.8%   310   75s
H 4647  3933                    58299.703646 79403.0269  36.2%   310   75s
H 4877  3767                    58575.048032 78944.4728  34.8%   305   76s
H 4883  3588                    58609.801450 78944.4728  34.7%   305   76s
H 4887  3419                    58680.872518 78944.4728  34.5%   305   76s
H 4901  3255                    58823.361378 78944.4728  34.2%   305   76s
H 5054  3121                    58837.493584 77399.2038  31.5%   304   77s
  5492  3215     cutoff   28      58837.4936 76745.6639  30.4%   298   80s
H 5803  3065                    58988.049145 76391.6506  29.5%   294   81s
  7050  3027 66872.7370   24  195 58988.0491 73978.4998  25.4%   276   85s
  7836  3003 66722.1691   24  219 58988.0491 72745.8560  23.3%   269   90s
H 8420  2797                    59160.774245 72398.9848  22.4%   265   94s
  8511  2879 61055.5808   29   77 59160.7742 72398.9848  22.4%   265   95s
H 8523  2745                    59862.794939 72398.9848  20.9%   265   95s
H 8595  2598                    60337.749692 72398.9848  20.0%   264   95s
H 8892  2408                    60476.786494 71274.9969  17.9%   262   95s
H 8962  2273                    60502.348694 71274.9969  17.8%   262   95s
H10721  1712                    60533.190093 69361.8360  14.6%   251   99s
H10733  1705                    60613.340150 69329.8331  14.4%   251   99s
 11388  1707 62310.0537   21  237 60613.3401 68824.6984  13.5%   250  100s
*12847  1703              47    61101.630978 68111.9989  11.5%   244  103s
 14077  1607 61952.8368   22  224 61101.6310 67169.0606  9.93%   240  105s
 17730  1801     cutoff   23      61101.6310 64392.3782  5.39%   228  110s
H17839  1801                    61460.129529 64328.2258  4.67%   227  110s
H17842  1801                    61752.445155 64328.2258  4.17%   227  110s
*19670  1801              64    61854.561806 64318.9087  3.98%   210  110s
*20722  3290              62    62207.642311 63926.4897  2.76%   201  111s
*25554  2581              82    62338.238486 63090.6908  1.21%   168  111s
*28350  1661              54    62390.191109 62656.1413  0.43%   153  112s
*28354  1661              53    62416.986057 62656.1413  0.38%   153  112s

Cutting planes:
  Implied bound: 1
  Projected implied bound: 2
  MIR: 349
  Mixing: 2
  Flow cover: 466
  RLT: 10
  Relax-and-lift: 51

Explored 33908 nodes (4485706 simplex iterations) in 113.13 seconds (159.76 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 62417 62390.2 62338.2 ... 60533.2

Optimal solution found (tolerance 1.00e-06)
Best objective 6.241698605738e+04, best bound 6.241698605738e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 113.14s
  Master Objective (UB) = 62416.99, θ = 229282.02
  Upper Bound (UB) = 62416.99

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 229282.02
  [DEBUG]   ✓ Scenario 0: θ = 229282.02 ≤ Q = 229282.02 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x2879e147
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x2879e147
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.270470e+13
Presolve removed 2599 rows and 1890 columns
Presolve time: 0.01s
Presolved: 494 rows, 499 columns, 1396 nonzeros
Found heuristic solution: objective 6068764.9158
Variable types: 339 continuous, 160 integer (160 binary)

Root relaxation: objective -1.562800e+05, 241 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -156279.96    0  123 6068764.92 -156279.96   103%     -    0s
H    0     0                    -121596.0174 -156279.96  28.5%     -    0s
H    0     0                    -122602.6226 -156279.96  27.5%     -    0s
H    0     0                    -124975.2423 -124975.24  0.00%     -    0s
     0     0          -    0      -124975.24 -124975.24  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 203

Explored 1 nodes (370 simplex iterations) in 0.02 seconds (0.02 work units)
Thread count was 32 (of 32 available processors)

Solution count 5: -124975 -122603 -121596 ... 1.27047e+13
No other solutions better than -124975

Optimal solution found (tolerance 1.00e-06)
Best objective -1.249752422817e+05, best bound -1.249752422817e+05, gap 0.0000%
  Subproblem solved in 0.05s
  Worst-case operational profit (Z_SP) = 195333.12
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -124975.24
  [DEBUG]   S×d_nominal = 320308.36
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 320308.36 + -124975.24 = 195333.12
  [DEBUG]   Current θ from Master = 229282.02
  [DEBUG]   ⚠️  Z_SP ≤ θ by 33948.90 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 28468.08
  Lower Bound (LB) = 28468.08
  Gap (UB-LB) = 33948.9015, Absolute Gap = 33948.9015, Relative Gap = 0.543905
  Not converged yet (gap = 33948.90 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 91981 nonzeros
Model fingerprint: 0xa828b15b
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 28468.1 (0.02s)
MIP start from previous solve produced solution with objective 28468.1 (0.02s)
Loaded MIP start from previous solve with objective 28468.1

Presolve removed 14141 rows and 5740 columns
Presolve time: 0.46s
Presolved: 17822 rows, 9000 columns, 98638 nonzeros
Variable types: 6741 continuous, 2259 integer (2259 binary)

Root relaxation: objective 7.473278e+04, 8416 iterations, 1.42 seconds (1.78 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 74732.7810    0  251 28468.0846 74732.7810   163%     -    2s
H    0     0                    28470.545969 74732.7810   162%     -    2s
H    0     0                    29520.277177 74732.7810   153%     -    2s
H    0     0                    29655.678443 74732.7810   152%     -    2s
     0     0 68799.2912    0  269 29655.6784 68799.2912   132%     -    3s
     0     0 68540.2582    0  270 29655.6784 68540.2582   131%     -    3s
     0     0 68540.2451    0  270 29655.6784 68540.2451   131%     -    4s
     0     0 64315.2084    0  327 29655.6784 64315.2084   117%     -    5s
     0     0 63574.4622    0  359 29655.6784 63574.4622   114%     -    5s
     0     0 63499.7776    0  368 29655.6784 63499.7776   114%     -    6s
     0     0 63492.0392    0  364 29655.6784 63492.0392   114%     -    6s
     0     0 63490.6534    0  371 29655.6784 63490.6534   114%     -    6s
     0     0 60426.5522    0  437 29655.6784 60426.5522   104%     -    8s
     0     0 59900.8076    0  452 29655.6784 59900.8076   102%     -    9s
     0     0 59722.9604    0  460 29655.6784 59722.9604   101%     -    9s
     0     0 59645.5308    0  460 29655.6784 59645.5308   101%     -   10s
     0     0 59632.9821    0  476 29655.6784 59632.9821   101%     -   10s
     0     0 59626.7553    0  473 29655.6784 59626.7553   101%     -   10s
     0     0 59626.0461    0  480 29655.6784 59626.0461   101%     -   10s
H    0     0                    29673.495310 57533.3614  93.9%     -   13s
H    0     0                    29770.230666 57533.3614  93.3%     -   13s
H    0     0                    29809.824537 57533.3614  93.0%     -   13s
     0     0 57533.3614    0  448 29809.8245 57533.3614  93.0%     -   13s
     0     0 56939.6249    0  466 29809.8245 56939.6249  91.0%     -   14s
     0     0 56719.0256    0  489 29809.8245 56719.0256  90.3%     -   15s
     0     0 56671.3173    0  493 29809.8245 56671.3173  90.1%     -   15s
H    0     0                    30394.627212 56638.9961  86.3%     -   15s
     0     0 56638.9961    0  489 30394.6272 56638.9961  86.3%     -   15s
H    0     0                    30421.769327 56617.1310  86.1%     -   15s
H    0     0                    30654.994363 56617.1310  84.7%     -   15s
H    0     0                    31534.883313 56617.1310  79.5%     -   15s
H    0     0                    31635.933844 56617.1310  79.0%     -   15s
H    0     0                    31733.710257 56617.1310  78.4%     -   15s
H    0     0                    31830.649430 56617.1310  77.9%     -   15s
H    0     0                    32022.297585 56617.1310  76.8%     -   15s
     0     0 56617.1310    0  484 32022.2976 56617.1310  76.8%     -   15s
     0     0 56607.9432    0  493 32022.2976 56607.9432  76.8%     -   16s
     0     0 56565.7024    0  509 32022.2976 56565.7024  76.6%     -   16s
     0     0 56556.3538    0  505 32022.2976 56556.3538  76.6%     -   16s
     0     0 56555.6639    0  507 32022.2976 56555.6639  76.6%     -   16s
     0     0 55592.5826    0  366 32022.2976 55592.5826  73.6%     -   18s
     0     0 55370.4308    0  462 32022.2976 55370.4308  72.9%     -   19s
     0     0 55253.0653    0  414 32022.2976 55253.0653  72.5%     -   19s
     0     0 55238.1188    0  475 32022.2976 55238.1188  72.5%     -   19s
     0     0 55199.9287    0  468 32022.2976 55199.9287  72.4%     -   20s
     0     0 55170.6816    0  466 32022.2976 55170.6816  72.3%     -   20s
     0     0 55168.6503    0  468 32022.2976 55168.6503  72.3%     -   20s
     0     0 54956.7699    0  455 32022.2976 54956.7699  71.6%     -   21s
H    0     0                    32135.762966 54816.4472  70.6%     -   23s
     0     0 54816.4472    0  518 32135.7630 54816.4472  70.6%     -   23s
     0     0 54781.2294    0  470 32135.7630 54781.2294  70.5%     -   23s
     0     0 54775.8239    0  465 32135.7630 54775.8239  70.5%     -   24s
H    0     0                    32136.441100 54666.7961  70.1%     -   24s
H    0     0                    32174.186020 54666.7961  69.9%     -   24s
H    0     0                    32206.197098 54666.7961  69.7%     -   24s
     0     0 54666.7961    0  398 32206.1971 54666.7961  69.7%     -   24s
     0     0 54635.5674    0  388 32206.1971 54635.5674  69.6%     -   25s
     0     0 54630.6291    0  382 32206.1971 54630.6291  69.6%     -   25s
     0     0 54606.6237    0  396 32206.1971 54606.6237  69.6%     -   25s
H    0     0                    32292.724115 54602.9147  69.1%     -   26s
H    0     0                    32521.668670 54602.9147  67.9%     -   26s
     0     0 54597.8750    0  385 32521.6687 54597.8750  67.9%     -   27s
     0     0 54593.2343    0  391 32521.6687 54593.2343  67.9%     -   27s
     0     0 54568.7410    0  391 32521.6687 54568.7410  67.8%     -   27s
     0     0 54563.0873    0  392 32521.6687 54563.0873  67.8%     -   27s
H    0     0                    32637.280643 54563.0873  67.2%     -   28s
     0     0 54538.6250    0  380 32637.2806 54538.6250  67.1%     -   28s
     0     0 54538.5819    0  380 32637.2806 54538.5819  67.1%     -   28s
     0     2 54538.5819    0  380 32637.2806 54538.5819  67.1%     -   33s
     7    16 54034.1957    3  385 32637.2806 54368.6778  66.6%   596   35s
H   31    64                    32640.363159 53794.0183  64.8%  1230   38s
    63    96 53429.6334    6  398 32640.3632 53637.2080  64.3%  1167   40s
H   97   170                    33173.520344 53637.0996  61.7%  1067   42s
   257   334 51202.6362    8  307 33173.5203 53637.0996  61.7%   746   45s
H  259   334                    33744.417162 53637.0996  59.0%   743   45s
H  269   334                    33903.181980 53637.0996  58.2%   750   45s
H  308   334                    35364.825647 53637.0996  51.7%   731   45s
H  437   487                    35410.906704 53637.0996  51.5%   630   47s
H  443   487                    37160.282508 53637.0996  44.3%   632   47s
H  457   487                    37186.982131 53637.0996  44.2%   627   47s
H  458   487                    38255.031414 53637.0996  40.2%   626   47s
   582   627 50993.9630   11  396 38255.0314 53637.0996  40.2%   561   50s
   852   833 50195.4396   14  331 38255.0314 53312.5920  39.4%   514   55s
  1223  1221 48268.6661   20  330 38255.0314 53224.4083  39.1%   456   60s
  2053  2000 48033.4903   23  324 38255.0314 53218.8693  39.1%   328   65s
  2748  2504 42839.5785   27  282 38255.0314 53150.3674  38.9%   306   71s
  3304  2915 39737.5386   35  220 38255.0314 52996.5316  38.5%   295   75s
H 3768  3064                    38452.015027 52996.5316  37.8%   286   79s
H 3768  3064                    38477.708116 52996.5316  37.7%   286   79s
  3769  3065 39047.2102   52  380 38477.7081 52996.5316  37.7%   286   88s
  3771  3066 44325.4638   42  125 38477.7081 52996.5316  37.7%   285   90s
  3776  3070 39167.7716   61  356 38477.7081 52996.5316  37.7%   285   95s
  3786  3076 47897.2893   11  361 38477.7081 52996.5316  37.7%   284  100s
  3797  3084 47274.1262   22  390 38477.7081 52996.5316  37.7%   283  105s
  3806  3090 40559.3189   29  397 38477.7081 52996.5316  37.7%   283  110s
  3810  3092 40209.3088   62  398 38477.7081 52996.5316  37.7%   282  117s
  3813  3099 52996.5316   13  331 38477.7081 52996.5316  37.7%   290  120s
  3841  3146 50578.5980   16  334 38477.7081 51931.2642  35.0%   298  125s
  3946  3234 44660.7165   19  279 38477.7081 50981.1099  32.5%   308  130s
  4251  3328 42119.2070   23  215 38477.7081 50981.1099  32.5%   323  136s
H 4352  3172                    39258.432222 50981.1099  29.9%   325  137s
H 4490  3005                    39776.707971 49692.7319  24.9%   328  139s
  4530  2999 41318.6691   20  269 39776.7080 49692.7319  24.9%   329  141s
H 4678  2841                    40606.045360 49113.7953  21.0%   331  143s
  4704  2833     cutoff   24      40606.0454 49113.7953  21.0%   331  145s
  5156  2771 42371.4133   23  192 40606.0454 48119.1155  18.5%   336  151s
  5473  2711     cutoff   22      40606.0454 47295.2537  16.5%   340  156s
H 5482  2574                    40886.994197 47295.2537  15.7%   340  156s
H 5514  2437                    41012.618088 47210.9205  15.1%   340  156s
  5926  2287 42158.5436   21  241 41012.6181 46807.5145  14.1%   342  161s
* 5976  2150              30    41016.044317 46807.5145  14.1%   341  161s
  6290  2015 41692.5249   22  232 41016.0443 46605.8533  13.6%   343  165s
H 6752  1731                    41057.766055 45400.7965  10.6%   344  168s
  6813  1669     cutoff   21      41057.7661 45370.4865  10.5%   344  171s
  7614  1085     cutoff   21      41057.7661 43855.2797  6.81%   343  176s

Cutting planes:
  Lift-and-project: 1
  MIR: 352
  Mixing: 2
  Flow cover: 500
  RLT: 4
  Relax-and-lift: 59

Explored 8200 nodes (2763461 simplex iterations) in 177.49 seconds (278.57 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 41057.8 41016 41012.6 ... 38255

Optimal solution found (tolerance 1.00e-06)
Best objective 4.105776605546e+04, best bound 4.105776605546e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 177.50s
  Master Objective (UB) = 41057.77, θ = 193793.97
  Upper Bound (UB) = 41057.77

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 193793.97
  [DEBUG]   ✓ Scenario 0: θ = 193793.97 ≤ Q = 193793.97 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 193793.97 ≤ Q = 193793.97 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x7059e7fe
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x8fa61802
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.389457e+13
Presolve removed 2600 rows and 1892 columns
Presolve time: 0.01s
Presolved: 493 rows, 497 columns, 1390 nonzeros
Found heuristic solution: objective 6869474.5981
Variable types: 337 continuous, 160 integer (160 binary)

Root relaxation: objective -1.638860e+05, 258 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -163886.04    0  129 6869474.60 -163886.04   102%     -    0s
H    0     0                    -125067.8830 -163886.04  31.0%     -    0s
H    0     0                    -126735.8173 -163886.04  29.3%     -    0s
H    0     0                    -141274.7228 -163886.04  16.0%     -    0s
H    0     0                    -146641.5531 -163886.04  11.8%     -    0s
     0     0 -152246.74    0   94 -146641.55 -152246.74  3.82%     -    0s
H    0     0                    -148814.2733 -152095.80  2.21%     -    0s
H    0     0                    -149132.3207 -152095.80  1.99%     -    0s
H    0     0                    -149637.2443 -152095.80  1.64%     -    0s
H    0     0                    -149955.2918 -152095.80  1.43%     -    0s
     0     0 -151741.64    0   96 -149955.29 -151741.64  1.19%     -    0s
     0     0 -150412.15    0   53 -149955.29 -150412.15  0.30%     -    0s
     0     0 -150401.52    0   51 -149955.29 -150401.52  0.30%     -    0s
     0     0 -150395.13    0   50 -149955.29 -150395.13  0.29%     -    0s
     0     0 -150311.87    0   44 -149955.29 -150311.87  0.24%     -    0s
     0     0 -150309.19    0   43 -149955.29 -150309.19  0.24%     -    0s
     0     0 -150309.04    0   43 -149955.29 -150309.04  0.24%     -    0s
H    0     0                    -149967.9311 -150309.04  0.23%     -    0s
     0     0 -149991.29    0    9 -149967.93 -149991.29  0.02%     -    0s
     0     0 -149982.80    0    7 -149967.93 -149982.80  0.01%     -    0s
     0     0 -149978.14    0    5 -149967.93 -149978.14  0.01%     -    0s
H    0     0                    -149973.0876 -149975.85  0.00%     -    0s
H    0     0                    -149973.8272 -149975.85  0.00%     -    0s
     0     0 -149974.98    0    3 -149973.83 -149974.98  0.00%     -    0s
H    0     0                    -149973.9271 -149974.98  0.00%     -    0s
     0     0 -149974.48    0    1 -149973.93 -149974.48  0.00%     -    0s

Explored 1 nodes (667 simplex iterations) in 0.13 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -149974 -149974 -149973 ... -125068
No other solutions better than -149974

Optimal solution found (tolerance 1.00e-06)
Best objective -1.499739271049e+05, best bound -1.499739271049e+05, gap 0.0000%
  Subproblem solved in 0.16s
  Worst-case operational profit (Z_SP) = 171168.10
  Scenario: 44 demand increases, 16 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -149973.93
  [DEBUG]   S×d_nominal = 321142.03
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 321142.03 + -149973.93 = 171168.10
  [DEBUG]   Current θ from Master = 193793.97
  [DEBUG]   ⚠️  Z_SP ≤ θ by 22625.87 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 18431.90
  Lower Bound (LB) = 28468.08
  Gap (UB-LB) = 12589.6815, Absolute Gap = 12589.6815, Relative Gap = 0.306633
  Not converged yet (gap = 12589.68 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 44 increases, 16 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135212 nonzeros
Model fingerprint: 0xeeb03d68
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 18431.9 (0.03s)
MIP start from previous solve produced solution with objective 18431.9 (0.03s)
Loaded MIP start from previous solve with objective 18431.9

Presolve removed 21210 rows and 8610 columns
Presolve time: 0.66s
Presolved: 26043 rows, 12370 columns, 160049 nonzeros
Variable types: 10111 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   41599    6.0418068e+04   0.000000e+00   4.228665e+05      5s
Concurrent spin time: 0.04s

Solved with dual simplex

Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   16446    6.4586433e+04   0.000000e+00   0.000000e+00      5s

Root relaxation: objective 6.458643e+04, 16446 iterations, 4.68 seconds (6.17 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 64586.4327    0  125 18431.8984 64586.4327   250%     -    5s
H    0     0                    19986.561586 64586.4327   223%     -    5s
H    0     0                    29140.958382 64586.4327   122%     -    5s
H    0     0                    29211.608370 64586.4327   121%     -    5s
H    0     0                    33618.290410 64586.4327  92.1%     -    5s
H    0     0                    33687.324435 64586.4327  91.7%     -    5s
H    0     0                    33704.937013 64586.4327  91.6%     -    5s
H    0     0                    33734.707314 64586.4327  91.5%     -    5s
H    0     0                    33743.819787 64586.4327  91.4%     -    5s
H    0     0                    33910.831646 64586.4327  90.5%     -    6s
H    0     0                    33919.944119 64586.4327  90.4%     -    6s
H    0     0                    33922.013466 59593.9536  75.7%     -    8s
     0     0 59593.9536    0  197 33922.0135 59593.9536  75.7%     -    8s
     0     0 59074.1304    0  213 33922.0135 59074.1304  74.1%     -   10s
     0     0 59074.1304    0  212 33922.0135 59074.1304  74.1%     -   10s
     0     0 59074.1304    0  210 33922.0135 59074.1304  74.1%     -   10s
     0     0 59074.1304    0  208 33922.0135 59074.1304  74.1%     -   10s
     0     0 59074.1304    0  208 33922.0135 59074.1304  74.1%     -   10s
     0     0 56912.4404    0  247 33922.0135 56912.4404  67.8%     -   13s
     0     0 55996.5942    0  258 33922.0135 55996.5942  65.1%     -   14s
     0     0 55886.5904    0  266 33922.0135 55886.5904  64.8%     -   15s
     0     0 55849.5794    0  275 33922.0135 55849.5794  64.6%     -   15s
     0     0 55835.5051    0  275 33922.0135 55835.5051  64.6%     -   15s
     0     0 55822.2650    0  269 33922.0135 55822.2650  64.6%     -   16s
     0     0 55821.4119    0  271 33922.0135 55821.4119  64.6%     -   16s
     0     0 55821.3855    0  271 33922.0135 55821.3855  64.6%     -   16s
     0     0 54094.3854    0  324 33922.0135 54094.3854  59.5%     -   20s
H    0     0                    34209.550796 54089.3478  58.1%     -   20s
H    0     0                    34241.246816 54089.3478  58.0%     -   20s
H    0     0                    34274.577976 54089.3478  57.8%     -   20s
     0     0 53598.0829    0  315 34274.5780 53598.0829  56.4%     -   22s
     0     0 53490.3782    0  325 34274.5780 53490.3782  56.1%     -   23s
     0     0 53419.3693    0  321 34274.5780 53419.3693  55.9%     -   23s
     0     0 53378.3595    0  328 34274.5780 53378.3595  55.7%     -   23s
     0     0 53365.4894    0  332 34274.5780 53365.4894  55.7%     -   24s
     0     0 53358.7438    0  334 34274.5780 53358.7438  55.7%     -   24s
     0     0 53354.1915    0  339 34274.5780 53354.1915  55.7%     -   24s
     0     0 53353.4354    0  337 34274.5780 53353.4354  55.7%     -   24s
     0     0 52802.6975    0  381 34274.5780 52802.6975  54.1%     -   28s
H    0     0                    34420.442336 52802.0586  53.4%     -   28s
H    0     0                    34530.048879 52802.0586  52.9%     -   28s
     0     0 52590.6488    0  361 34530.0489 52590.6488  52.3%     -   29s
     0     0 52504.9931    0  362 34530.0489 52504.9931  52.1%     -   30s
     0     0 52468.0042    0  367 34530.0489 52468.0042  51.9%     -   31s
     0     0 52408.5892    0  367 34530.0489 52408.5892  51.8%     -   32s
     0     0 52400.9283    0  375 34530.0489 52400.9283  51.8%     -   32s
     0     0 52384.3858    0  372 34530.0489 52384.3858  51.7%     -   32s
     0     0 52382.4291    0  372 34530.0489 52382.4291  51.7%     -   32s
     0     0 52381.5913    0  371 34530.0489 52381.5913  51.7%     -   32s
     0     0 52318.4728    0  381 34530.0489 52318.4728  51.5%     -   33s
H    0     0                    34562.255873 52315.4750  51.4%     -   33s
H    0     0                    34588.281902 52315.4750  51.3%     -   33s
     0     0 52301.8771    0  383 34588.2819 52301.8771  51.2%     -   34s
     0     0 52298.5671    0  385 34588.2819 52298.5671  51.2%     -   34s
     0     0 52295.9204    0  381 34588.2819 52295.9204  51.2%     -   34s
     0     0 52295.5337    0  380 34588.2819 52295.5337  51.2%     -   34s
     0     0 52280.5152    0  386 34588.2819 52280.5152  51.2%     -   35s
     0     0 52276.7684    0  387 34588.2819 52276.7684  51.1%     -   35s
     0     0 52275.8319    0  387 34588.2819 52275.8319  51.1%     -   35s
     0     0 52275.2547    0  385 34588.2819 52275.2547  51.1%     -   35s
     0     0 52271.5518    0  385 34588.2819 52271.5518  51.1%     -   36s
     0     0 52270.7901    0  390 34588.2819 52270.7901  51.1%     -   36s
     0     0 52265.8967    0  387 34588.2819 52265.8967  51.1%     -   37s
H    0     0                    35166.097056 52265.6540  48.6%     -   37s
H    0     0                    35260.828450 52265.6540  48.2%     -   37s
     0     0 52265.1366    0  387 35260.8285 52265.1366  48.2%     -   37s
     0     0 52263.5951    0  382 35260.8285 52263.5951  48.2%     -   38s
H    0     0                    35375.773256 52263.0961  47.7%     -   38s
     0     0 52263.0445    0  386 35375.7733 52263.0445  47.7%     -   38s
     0     0 52262.4533    0  384 35375.7733 52262.4533  47.7%     -   39s
     0     0 52261.6571    0  384 35375.7733 52261.6571  47.7%     -   39s
H    0     0                    35438.761698 52261.6571  47.5%     -   44s
     0     2 52261.6571    0  384 35438.7617 52261.6571  47.5%     -   44s
     1     4 52223.3833    1  374 35438.7617 52260.2254  47.5%   870   46s
     7    16 51533.0010    3  358 35438.7617 52112.5456  47.0%  2924   51s
    15    32 51360.7048    4  367 35438.7617 51531.9343  45.4%  3216   55s
H   50    64                    35448.124189 50853.9889  43.5%  3470   58s
    63    96 50758.6351    6  400 35448.1242 50853.5777  43.5%  3387   60s
H   96   211                    35512.297327 50853.5777  43.2%  2727   62s
H  159   211                    35687.089222 50853.5777  42.5%  1991   62s
   210   289 50152.6913    8  386 35687.0892 50853.5777  42.5%  1678   65s
H  310   355                    35867.779190 50853.5777  41.8%  1464   67s
   432   490 49878.5731   10  381 35867.7792 50853.5777  41.8%  1287   72s
H  439   490                    35900.892500 50853.5777  41.6%  1293   72s
H  452   490                    35912.927158 50853.5777  41.6%  1280   72s
H  464   490                    36066.835171 50853.5777  41.0%  1275   72s
H  486   490                    36200.621818 50853.5777  40.5%  1265   72s
   570   619 49248.0783   12  373 36200.6218 50853.5777  40.5%  1192   77s
H  571   619                    36202.017852 50853.5777  40.5%  1190   77s
H  579   619                    36217.988977 50853.5777  40.4%  1189   77s
H  579   619                    36266.190990 50853.5777  40.2%  1189   77s
H  581   619                    36664.015182 50853.5777  38.7%  1193   77s
H  620   619                    36684.846354 50853.5777  38.6%  1165   77s
   628   677 49372.0880   13  367 36684.8464 50853.5777  38.6%  1161   80s
H  721   706                    36750.249833 50853.5777  38.4%  1180   82s
   727   773 49051.5473   15  353 36750.2498 50767.7060  38.1%  1177   85s
   873   920 48488.4229   21  355 36750.2498 50757.5040  38.1%  1117   91s
H  975   950                    36976.354717 50639.0420  36.9%  1082   93s
  1008   971 47284.2848   22  343 36976.3547 50639.0420  36.9%  1079  100s
H 1021   971                    36992.777720 50639.0420  36.9%  1098  100s
H 1060  1020                    37016.339121 50521.1059  36.5%  1105  102s
  1098  1088 47300.2252   23  266 37016.3391 50521.1059  36.5%  1114  105s
H 1196  1120                    37274.556535 50521.1059  35.5%  1109  106s
  1298  1237 43089.7472   25  330 37274.5565 50521.1059  35.5%  1076  111s
  1374  1323 44243.1780   27  333 37274.5565 50521.1059  35.5%  1069  115s
  1533  1499 43562.1321   31  306 37274.5565 50521.1059  35.5%  1033  121s
  1619  1575 43940.7139   31  312 37274.5565 50521.1059  35.5%  1005  127s
  1890  1855 37847.7779   33  233 37274.5565 50510.5538  35.5%   941  132s
  2068  1971 41139.2233   34  335 37274.5565 50510.5538  35.5%   899  135s
  2381  2212 39669.4249   39  292 37274.5565 50256.9544  34.8%   864  144s
  2556  2366 38949.4334   41  280 37274.5565 50256.9544  34.8%   849  148s
  2784  2488     cutoff   49      37274.5565 50256.9544  34.8%   821  151s
  2998  2592 49446.4508   11  328 37274.5565 50121.8050  34.5%   802  155s
  3353  2816 47459.0506   11  317 37274.5565 50121.8050  34.5%   797  163s
  3544  2905 45584.9203   13  313 37274.5565 49979.5952  34.1%   799  168s
  3691  3001 46127.8315   13  312 37274.5565 49836.0837  33.7%   809  172s
  3825  3002 40952.5659   26  384 37274.5565 49717.1749  33.4%   819  198s
  3827  3003 44607.5002   24  125 37274.5565 49717.1749  33.4%   818  203s
  3828  3004 46648.8268   21  283 37274.5565 49717.1749  33.4%   818  210s
  3831  3006 42092.3847   32  352 37274.5565 49717.1749  33.4%   817  215s
  3837  3010 43019.6604   17  388 37274.5565 49717.1749  33.4%   816  220s
  3842  3013 44213.8693   26  362 37274.5565 49717.1749  33.4%   815  226s
  3846  3016 47804.0294   10  380 37274.5565 49717.1749  33.4%   814  231s
  3850  3019 42923.9473   19  372 37274.5565 49717.1749  33.4%   813  235s
  3854  3021 41895.9127   24  371 37274.5565 49717.1749  33.4%   812  244s
  3855  3022 40688.8217   36  371 37274.5565 49717.1749  33.4%   812  251s
H 3855  2872                    37287.723072 49717.1749  33.3%   825  254s
  3856  2874 49717.1749   11  362 37287.7231 49717.1749  33.3%   826  257s
  3858  2877 49717.1749   12  330 37287.7231 49717.1749  33.3%   827  261s
  3870  2897 49113.1275   14  294 37287.7231 49401.5265  32.5%   833  270s
  3886  2924 47232.8482   15  264 37287.7231 49166.4949  31.9%   841  275s
H 3931  2797                    37296.879274 47759.4854  28.1%   871  279s
H 3940  2657                    37306.254451 47759.4854  28.0%   876  279s
  3950  2685 46400.1501   17  344 37306.2545 47759.4854  28.0%   878  282s
  3982  2708 46125.5166   18  335 37306.2545 47759.4854  28.0%   880  286s
  4017  2753 45209.4018   18  259 37306.2545 47759.4854  28.0%   889  290s
  4164  2809 45378.9104   19  242 37306.2545 47759.4854  28.0%   920  298s
  4235  2811 44206.2927   20  223 37306.2545 47099.0282  26.2%   937  302s
  4314  2812 43963.8720   20  262 37306.2545 47099.0282  26.2%   944  306s
  4440  2840 43578.6379   22  195 37306.2545 46752.4024  25.3%   963  312s
  4505  2844 42224.9316   23  200 37306.2545 46322.9295  24.2%   969  318s
  4584  2835 40791.8500   23  188 37306.2545 46322.9295  24.2%   973  321s
  4662  2821 41201.2919   24  202 37306.2545 46161.8108  23.7%   979  325s
  4823  2827     cutoff   26      37306.2545 46161.8108  23.7%   983  332s
  4887  2842 39788.3941   28  101 37306.2545 46161.8108  23.7%   988  335s
  4967  2834 38993.4926   30   94 37306.2545 46161.8108  23.7%   991  340s
  5165  2812     cutoff   31      37306.2545 45794.1998  22.8%   994  348s
  5257  2818     cutoff   33      37306.2545 45350.5703  21.6%   996  353s
  5357  2820 40092.4444   21  190 37306.2545 45350.5703  21.6%   999  361s
* 5388  2680              53    38292.042438 45350.5703  18.4%  1000  361s
  5465  2660     cutoff   24      38292.0424 45350.5703  18.4%  1002  365s
H 5470  2536                    38487.623099 45350.5703  17.8%  1002  365s
H 5516  2402                    38566.346964 45350.5703  17.6%  1003  365s
H 5521  2290                    38864.011396 45350.5703  16.7%  1003  365s
  5545  2266 41273.9189   22  321 38864.0114 45350.5703  16.7%  1003  370s
  5792  2202     cutoff   28      38864.0114 44736.8404  15.1%  1009  379s
  5899  2163 41353.7007   18  222 38864.0114 44736.8404  15.1%  1016  384s
  6034  2109     cutoff   21      38864.0114 44736.8404  15.1%  1020  389s
  6191  2059     cutoff   21      38864.0114 44430.0497  14.3%  1023  394s
  6335  2012     cutoff   22      38864.0114 44181.6373  13.7%  1027  399s
  6484  1959     cutoff   21      38864.0114 43822.0787  12.8%  1033  404s
  6654  1906 39951.4815   21  264 38864.0114 43689.1571  12.4%  1033  408s
H 6655  1800                    39030.672466 43689.1571  11.9%  1033  408s
  6712  1777     cutoff   22      39030.6725 43330.6316  11.0%  1036  415s
  6882  1699     cutoff   22      39030.6725 43281.3563  10.9%  1038  421s
  7084  1595 39246.8125   19  233 39030.6725 43047.8055  10.3%  1038  427s
  7313  1465     cutoff   27      39030.6725 42778.7886  9.60%  1033  432s
  7556  1320 39292.0637   22  295 39030.6725 42438.2852  8.73%  1031  439s
  7811  1140     cutoff   26      39030.6725 42194.0151  8.10%  1029  445s
  8041   881     cutoff   23      39030.6725 41817.0254  7.14%  1028  451s
  8373   510     cutoff   21      39030.6725 41372.1835  6.00%  1017  456s
  8722   381     cutoff   24      39030.6725 39995.2380  2.47%   988  460s

Cutting planes:
  MIR: 238
  Flow cover: 561
  RLT: 23
  Relax-and-lift: 67

Explored 8742 nodes (8686501 simplex iterations) in 460.46 seconds (833.05 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 39030.7 38864 38566.3 ... 37016.3

Optimal solution found (tolerance 1.00e-06)
Best objective 3.903067246578e+04, best bound 3.903067246578e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 460.47s
  Master Objective (UB) = 39030.67, θ = 191148.13
  Upper Bound (UB) = 39030.67

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 191148.13
  [DEBUG]   ✓ Scenario 0: θ = 191148.13 ≤ Q = 191148.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 191148.13 ≤ Q = 191148.13 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 191148.13 ≤ Q = 191148.13 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x643a4671
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x643a4671
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [3e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [5e-14, 2e+02]
Found heuristic solution: objective 1.398948e+13
Presolve removed 2600 rows and 1892 columns
Presolve time: 0.01s
Presolved: 493 rows, 497 columns, 1390 nonzeros
Found heuristic solution: objective 6862849.7836
Variable types: 337 continuous, 160 integer (160 binary)

Root relaxation: objective -1.615930e+05, 243 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -161593.00    0  124 6862849.78 -161593.00   102%     -    0s
H    0     0                    -126841.0156 -161593.00  27.4%     -    0s
H    0     0                    -127680.2279 -161593.00  26.6%     -    0s
H    0     0                    -133630.6788 -161593.00  20.9%     -    0s
     0     0 -145468.39    0   95 -133630.68 -145468.39  8.86%     -    0s
H    0     0                    -141454.9418 -145338.98  2.75%     -    0s
     0     0 -144284.28    0   94 -141454.94 -144284.28  2.00%     -    0s
H    0     0                    -142437.9610 -144190.48  1.23%     -    0s
     0     0 -143495.77    0   61 -142437.96 -143495.77  0.74%     -    0s
     0     0 -143426.26    0   65 -142437.96 -143426.26  0.69%     -    0s
     0     0 -143363.42    0   50 -142437.96 -143363.42  0.65%     -    0s
     0     0 -143363.15    0   49 -142437.96 -143363.15  0.65%     -    0s
     0     0 -142822.53    0   22 -142437.96 -142822.53  0.27%     -    0s
     0     0 -142762.14    0   38 -142437.96 -142762.14  0.23%     -    0s
     0     0 -142758.62    0   33 -142437.96 -142758.62  0.23%     -    0s
     0     0 -142725.55    0   36 -142437.96 -142725.55  0.20%     -    0s
     0     0 -142724.69    0   35 -142437.96 -142724.69  0.20%     -    0s
     0     0 -142572.37    0   17 -142437.96 -142572.37  0.09%     -    0s
     0     0 -142558.74    0   17 -142437.96 -142558.74  0.08%     -    0s
     0     0 -142508.81    0    7 -142437.96 -142508.81  0.05%     -    0s
     0     0 -142508.81    0    8 -142437.96 -142508.81  0.05%     -    0s
H    0     0                    -142441.3926 -142508.81  0.05%     -    0s
     0     0 -142481.83    0    2 -142441.39 -142481.83  0.03%     -    0s
H    0     0                    -142475.6920 -142479.11  0.00%     -    0s
     0     0 -142479.11    0    2 -142475.69 -142479.11  0.00%     -    0s

Cutting planes:
  Implied bound: 3
  Flow cover: 7

Explored 1 nodes (849 simplex iterations) in 0.11 seconds (0.05 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -142476 -142441 -142438 ... 6.86285e+06
No other solutions better than -142476

Optimal solution found (tolerance 1.00e-06)
Best objective -1.424756919673e+05, best bound -1.424756919673e+05, gap 0.0000%
  Subproblem solved in 0.14s
  Worst-case operational profit (Z_SP) = 178666.34
  Scenario: 44 demand increases, 16 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -142475.69
  [DEBUG]   S×d_nominal = 321142.03
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 321142.03 + -142475.69 = 178666.34
  [DEBUG]   Current θ from Master = 191148.13
  [DEBUG]   ⚠️  Z_SP ≤ θ by 12481.79 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 26548.88
  Lower Bound (LB) = 28468.08
  Gap (UB-LB) = 10562.5879, Absolute Gap = 10562.5879, Relative Gap = 0.270623
  Not converged yet (gap = 10562.59 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 44 increases, 16 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178443 nonzeros
Model fingerprint: 0x0920cb3d
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 26548.9 (0.11s)
MIP start from previous solve produced solution with objective 26548.9 (0.11s)
Loaded MIP start from previous solve with objective 26548.9

Presolve removed 28280 rows and 11480 columns
Presolve time: 1.29s
Presolved: 34263 rows, 15740 columns, 211559 nonzeros
Variable types: 13481 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 34263 rows, 15740 columns, 211559 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   33637    5.2375298e+04   0.000000e+00   6.222201e+05      5s
Concurrent spin time: 0.83s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 6.456417e+04, 19743 iterations, 7.62 seconds (9.81 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 64564.1729    0  121 26548.8799 64564.1729   143%     -    9s
H    0     0                    26945.655205 64564.1729   140%     -    9s
H    0     0                    34412.158264 64564.1729  87.6%     -    9s
H    0     0                    34431.456988 59772.7438  73.6%     -   13s
     0     0 59772.7438    0  180 34431.4570 59772.7438  73.6%     -   13s
     0     0 59348.4572    0  181 34431.4570 59348.4572  72.4%     -   15s
     0     0 59335.9082    0  182 34431.4570 59335.9082  72.3%     -   15s
     0     0 59335.9082    0  181 34431.4570 59335.9082  72.3%     -   16s
     0     0 59335.9082    0  181 34431.4570 59335.9082  72.3%     -   16s
     0     0 56827.0591    0  241 34431.4570 56827.0591  65.0%     -   20s
     0     0 56433.8884    0  273 34431.4570 56433.8884  63.9%     -   22s
     0     0 56137.1695    0  281 34431.4570 56137.1695  63.0%     -   24s
     0     0 55961.8191    0  273 34431.4570 55961.8191  62.5%     -   25s
     0     0 55921.7853    0  304 34431.4570 55921.7853  62.4%     -   25s
     0     0 55909.1194    0  280 34431.4570 55909.1194  62.4%     -   26s
     0     0 55900.5045    0  285 34431.4570 55900.5045  62.4%     -   26s
     0     0 55897.6028    0  290 34431.4570 55897.6028  62.3%     -   26s
     0     0 55897.4996    0  292 34431.4570 55897.4996  62.3%     -   26s
H    0     0                    34516.471867 54158.4927  56.9%     -   33s
H    0     0                    34565.948441 54158.4927  56.7%     -   33s
H    0     0                    34626.327786 54158.4927  56.4%     -   33s
H    0     0                    35892.013982 54158.4927  50.9%     -   33s
     0     0 54158.4927    0  343 35892.0140 54158.4927  50.9%     -   33s
H    0     0                    36091.712876 54158.2303  50.1%     -   33s
H    0     0                    36755.725006 54158.2303  47.3%     -   33s
     0     0 53647.1692    0  362 36755.7250 53647.1692  46.0%     -   36s
     0     0 53533.4704    0  359 36755.7250 53533.4704  45.6%     -   37s
     0     0 53367.4347    0  352 36755.7250 53367.4347  45.2%     -   39s
     0     0 53331.5810    0  356 36755.7250 53331.5810  45.1%     -   40s
     0     0 53295.8846    0  361 36755.7250 53295.8846  45.0%     -   40s
     0     0 53289.8865    0  363 36755.7250 53289.8865  45.0%     -   41s
     0     0 53284.3125    0  364 36755.7250 53284.3125  45.0%     -   41s
H    0     0                    36804.350340 53281.7706  44.8%     -   41s
H    0     0                    36860.705170 53281.7706  44.5%     -   41s
     0     0 53281.7706    0  364 36860.7052 53281.7706  44.5%     -   41s
     0     0 53281.4644    0  360 36860.7052 53281.4644  44.5%     -   41s
H    0     0                    37108.465275 53281.4644  43.6%     -   44s
H    0     0                    37168.532052 53281.4644  43.4%     -   44s
H    0     0                    37286.362390 53281.4644  42.9%     -   44s
H    0     0                    37376.947205 53281.4644  42.6%     -   44s
     0     0 52867.0860    0  358 37376.9472 52867.0860  41.4%     -   46s
     0     0 52576.5896    0  357 37376.9472 52576.5896  40.7%     -   49s
     0     0 52513.0254    0  370 37376.9472 52513.0254  40.5%     -   50s
     0     0 52493.4948    0  370 37376.9472 52493.4948  40.4%     -   51s
     0     0 52484.4100    0  370 37376.9472 52484.4100  40.4%     -   52s
     0     0 52478.4831    0  371 37376.9472 52478.4831  40.4%     -   52s
     0     0 52458.3449    0  373 37376.9472 52458.3449  40.3%     -   52s
     0     0 52456.7117    0  370 37376.9472 52456.7117  40.3%     -   52s
     0     0 52456.3108    0  372 37376.9472 52456.3108  40.3%     -   52s
     0     0 52441.6475    0  366 37376.9472 52441.6475  40.3%     -   53s
     0     0 52424.8742    0  374 37376.9472 52424.8742  40.3%     -   54s
     0     0 52418.0745    0  376 37376.9472 52418.0745  40.2%     -   54s
     0     0 52416.3520    0  377 37376.9472 52416.3520  40.2%     -   55s
     0     0 52415.6898    0  374 37376.9472 52415.6898  40.2%     -   55s
     0     0 52403.2611    0  370 37376.9472 52403.2611  40.2%     -   56s
     0     0 52396.1559    0  356 37376.9472 52396.1559  40.2%     -   57s
     0     0 52393.9615    0  372 37376.9472 52393.9615  40.2%     -   57s
     0     0 52393.6349    0  373 37376.9472 52393.6349  40.2%     -   57s
     0     0 52366.7004    0  375 37376.9472 52366.7004  40.1%     -   58s
     0     0 52357.3843    0  369 37376.9472 52357.3843  40.1%     -   59s
     0     0 52355.0560    0  373 37376.9472 52355.0560  40.1%     -   59s
     0     0 52354.3095    0  376 37376.9472 52354.3095  40.1%     -   59s
     0     0 52342.9939    0  368 37376.9472 52342.9939  40.0%     -   60s
     0     0 52338.4611    0  373 37376.9472 52338.4611  40.0%     -   62s
     0     0 52337.4332    0  377 37376.9472 52337.4332  40.0%     -   62s
     0     0 52333.8485    0  377 37376.9472 52333.8485  40.0%     -   63s
     0     0 52332.0308    0  373 37376.9472 52332.0308  40.0%     -   63s
     0     0 52331.4293    0  375 37376.9472 52331.4293  40.0%     -   63s
     0     0 52330.2428    0  377 37376.9472 52330.2428  40.0%     -   64s
     0     0 52328.6752    0  376 37376.9472 52328.6752  40.0%     -   65s
     0     0 52327.5085    0  380 37376.9472 52327.5085  40.0%     -   65s
     0     0 52324.6056    0  385 37376.9472 52324.6056  40.0%     -   66s
     0     0 52324.3195    0  385 37376.9472 52324.3195  40.0%     -   67s
     0     2 52324.1145    0  385 37376.9472 52324.1145  40.0%     -   78s
     3     8 52260.4230    2  367 37376.9472 52288.6594  39.9%  1921   82s
     7    16 52098.8659    3  371 37376.9472 52259.2815  39.8%  2886   87s
    15    32 51879.6462    4  370 37376.9472 52097.9800  39.4%  3685   92s
    31    54 49640.4755    5  357 37376.9472 51877.1684  38.8%  4307  102s
    53    86 48994.4067    6  329 37376.9472 51876.0705  38.8%  4485  108s
H   56    86                    37397.007463 51876.0705  38.7%  4441  108s
    85   191 48833.1209    7  324 37397.0075 51876.0705  38.7%  3791  118s
   190   222 48742.9670    9  323 37397.0075 51876.0705  38.7%  2589  121s
H  234   254                    38773.466481 51876.0705  33.8%  2289  124s
   255   363 48710.5800   10  310 38773.4665 51876.0705  33.8%  2205  128s
   364   397 48536.2584   11  304 38773.4665 51876.0705  33.8%  1872  132s
   400   439 48494.0343   11  295 38773.4665 51876.0705  33.8%  1799  136s
   493   532 48389.8984   12  306 38773.4665 51876.0705  33.8%  1677  143s
   546   573 47458.6955   13  274 38773.4665 51876.0705  33.8%  1649  148s
   603   628 48203.1672   12  298 38773.4665 51511.4871  32.9%  1613  152s
   662   693 48243.8442   13  306 38773.4665 51416.6851  32.6%  1586  155s
   800   791 48103.7060   14  299 38773.4665 50941.6944  31.4%  1488  165s
   947   923 47244.9689   14  268 38773.4665 50842.3454  31.1%  1444  176s
  1035   976 45633.3670   15  284 38773.4665 50799.2021  31.0%  1408  181s
  1205  1099 45986.2743   15  247 38773.4665 50706.5786  30.8%  1367  191s
  1369  1208 44344.7946   16  241 38773.4665 50589.1725  30.5%  1330  199s
  1462  1277     cutoff   16      38773.4665 50589.1725  30.5%  1314  205s
  1571  1356 45404.8145   18  209 38773.4665 50489.5378  30.2%  1292  210s
  1675  1456 42855.9024   20  186 38773.4665 50489.5378  30.2%  1278  216s
  1799  1577 43351.8670   27  201 38773.4665 50452.0608  30.1%  1260  222s
  1944  1714 42783.5742   36  191 38773.4665 50452.0608  30.1%  1237  230s
  2103  1825 42314.4599   39  125 38773.4665 50452.0608  30.1%  1210  236s
  2288  1948 41733.4953   46  124 38773.4665 49944.4322  28.8%  1172  242s
  2454  2082 40788.1763   50  106 38773.4665 49944.4322  28.8%  1160  247s
  2620  2169     cutoff   56      38773.4665 49732.8988  28.3%  1141  251s
  2727  2283 47649.3357   11  317 38773.4665 49732.8988  28.3%  1130  257s
  2913  2375 46040.9576   14  263 38773.4665 49732.8988  28.3%  1102  263s
  3102  2468 45209.3902   17  232 38773.4665 49672.3657  28.1%  1090  270s
  3263  2606 43462.5100   20  242 38773.4665 49671.3681  28.1%  1093  277s
  3447  2767 44101.7574   22  186 38773.4665 49671.3681  28.1%  1092  283s
  3647  2768 42620.0381   45  385 38773.4665 49632.3893  28.0%  1088  303s
  3649  2769 48445.2559    9  121 38773.4665 49632.3893  28.0%  1088  317s
  3650  2770 41768.6122   28  265 38773.4665 49632.3893  28.0%  1087  323s
  3651  2771 41447.4472   33  309 38773.4665 49632.3893  28.0%  1087  329s
  3652  2771 43848.7699   23  337 38773.4665 49632.3893  28.0%  1087  333s
  3653  2772 41062.3208   23  367 38773.4665 49632.3893  28.0%  1087  335s
  3655  2773 48342.0507    7  370 38773.4665 49632.3893  28.0%  1086  341s
  3658  2775 47928.9004   10  409 38773.4665 49632.3893  28.0%  1085  345s
  3662  2778 45133.5743   26  381 38773.4665 49632.3893  28.0%  1084  351s
  3665  2780 45165.0571   14  373 38773.4665 49632.3893  28.0%  1083  355s
  3669  2783 43193.7498   46  381 38773.4665 49632.3893  28.0%  1082  360s
  3671  2784 45563.2311   14  413 38773.4665 49632.3893  28.0%  1081  365s
  3674  2786 46209.8675    9  409 38773.4665 49632.3893  28.0%  1080  370s
  3678  2789 42648.4233   24  430 38773.4665 49632.3893  28.0%  1079  377s
  3679  2789 43738.0582   16  430 38773.4665 49632.3893  28.0%  1079  393s
  3680  2790 40108.4094   54  430 38773.4665 49632.3893  28.0%  1079  402s
  3681  2794 49632.3893   15  361 38773.4665 49632.3893  28.0%  1103  408s
  3683  2797 49632.3893   16  361 38773.4665 49632.3893  28.0%  1104  416s
  3687  2804 49632.3893   17  392 38773.4665 49632.3893  28.0%  1107  424s
  3695  2817 49632.3893   18  385 38773.4665 49632.3893  28.0%  1117  434s
  3711  2836 49632.3893   19  360 38773.4665 49632.3893  28.0%  1137  447s
  3735  2860 48648.3111   20  273 38773.4665 49632.3893  28.0%  1178  457s
  3767  2893 48607.5775   21  288 38773.4665 49632.3893  28.0%  1201  469s
  3811  2973 48447.6598   22  331 38773.4665 49632.3893  28.0%  1214  483s
  3908  3027 48020.2940   23  305 38773.4665 49632.3893  28.0%  1244  494s
  4008  3017 46287.7597   24  258 38773.4665 49632.3893  28.0%  1288  500s
  4058  3031 46043.0774   22  244 38773.4665 49632.3893  28.0%  1308  510s
  4129  3045 46761.0719   24  360 38773.4665 49632.3893  28.0%  1332  519s
  4206  3033 45348.3863   24  256 38773.4665 49632.3893  28.0%  1364  530s
  4286  3031 43778.5178   26  207 38773.4665 49632.3893  28.0%  1406  539s
  4353  3039 43234.3804   28  228 38773.4665 49632.3893  28.0%  1428  546s
  4424  3034 42133.9867   28  170 38773.4665 49632.3893  28.0%  1449  552s
  4462  3044 41860.4682   29  271 38773.4665 49632.3893  28.0%  1461  558s
  4505  3053 41664.1907   30  264 38773.4665 49632.3893  28.0%  1473  567s
  4546  3065     cutoff   29      38773.4665 49632.3893  28.0%  1487  575s
  4586  3079 41334.5321   32  272 38773.4665 49632.3893  28.0%  1497  583s
  4636  3088 41168.2760   33  250 38773.4665 49632.3893  28.0%  1500  589s
  4694  3102     cutoff   34      38773.4665 49632.3893  28.0%  1503  597s
  4775  3106 43470.7973   22  312 38773.4665 49632.3893  28.0%  1505  607s
  4882  3096 42736.6125   23  353 38773.4665 49632.3893  28.0%  1508  618s
  4979  3113 45254.3096   22  317 38773.4665 48290.2803  24.5%  1520  627s
  5066  3131 44686.0434   23  325 38773.4665 48289.2049  24.5%  1531  635s
  5168  3143 40543.2861   25  299 38773.4665 48289.2049  24.5%  1542  644s
  5287  3124     cutoff   28      38773.4665 48289.2049  24.5%  1549  655s
  5440  3106 41299.1322   23  244 38773.4665 48289.2049  24.5%  1552  665s
  5570  3091 40804.4152   24  240 38773.4665 47475.4129  22.4%  1559  675s
  5692  3126 39753.4271   26  187 38773.4665 47323.7222  22.1%  1572  684s
  5805  3106     cutoff   28      38773.4665 47233.8842  21.8%  1584  695s
  6008  3077 42474.8464   23  300 38773.4665 47233.8842  21.8%  1578  704s
  6162  3058 40661.0959   26  209 38773.4665 47233.8842  21.8%  1580  714s
  6343  3037 39808.8847   27  212 38773.4665 46749.9449  20.6%  1583  726s
  6519  2995 40424.3095   24  231 38773.4665 46749.9449  20.6%  1587  741s
  6648  2988     cutoff   26      38773.4665 46623.1544  20.2%  1590  753s
  6801  2998 39544.0853   27  173 38773.4665 46623.1544  20.2%  1601  764s
  6997  2963 40811.7793   27  288 38773.4665 46492.4148  19.9%  1604  775s
  7216  2921 40183.2766   28  267 38773.4665 46408.4054  19.7%  1608  789s
  7452  2852     cutoff   29      38773.4665 46257.0689  19.3%  1611  801s
  7735  2789 41094.1990   26  262 38773.4665 46145.5718  19.0%  1609  814s
  7912  2748 40172.2228   28  265 38773.4665 45860.5042  18.3%  1611  828s
  8163  2697 41715.8708   27  264 38773.4665 45643.8391  17.7%  1616  844s
  8409  2640 42000.6112   26  281 38773.4665 45417.0199  17.1%  1625  859s
  8668  2589     cutoff   28      38773.4665 45336.5324  16.9%  1633  875s
  8946  2525     cutoff   33      38773.4665 44823.2249  15.6%  1640  891s
  9251  2408     cutoff   31      38773.4665 44621.0405  15.1%  1641  907s
  9617  2299 40867.0897   26  275 38773.4665 44528.0938  14.8%  1635  923s
  9942  2171 39495.3251   28  168 38773.4665 44429.5450  14.6%  1639  941s
 10330  2086 38821.5303   27  240 38773.4665 44306.8511  14.3%  1638  957s
 10727  1933 39711.8746   31  189 38773.4665 43940.7588  13.3%  1635  975s
 11132  1776     cutoff   30      38773.4665 43619.8656  12.5%  1634  993s
 11513  1635 infeasible   28      38773.4665 43511.8016  12.2%  1636 1011s
 11733  1517 40933.5707   25  276 38773.4665 43361.7607  11.8%  1638 1035s
 12205  1365 39359.2150   26  392 38773.4665 43090.7222  11.1%  1636 1055s
 12689  1295     cutoff   29      38773.4665 42888.3901  10.6%  1637 1080s
 13186  1225     cutoff   29      38773.4665 42701.3545  10.1%  1637 1101s
 13695  1204 infeasible   27      38773.4665 42470.4515  9.53%  1636 1121s
 13818  1123     cutoff   29      38773.4665 42384.2809  9.31%  1638 1143s
 14277   944     cutoff   31      38773.4665 42263.8131  9.00%  1634 1168s
 14900   628     cutoff   31      38773.4665 41954.4181  8.20%  1628 1192s
 15659   148 38849.4997   30  241 38773.4665 41472.4095  6.96%  1612 1214s
 16511     0     cutoff   28      38773.4665 40618.2877  4.76%  1581 1224s

Cutting planes:
  Learned: 1
  MIR: 339
  Mixing: 1
  Flow cover: 712
  RLT: 20
  Relax-and-lift: 69

Explored 16731 nodes (26321028 simplex iterations) in 1224.88 seconds (2500.69 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 38773.5 37397 37376.9 ... 36091.7

Optimal solution found (tolerance 1.00e-06)
Best objective 3.877346648137e+04, best bound 3.877346648137e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1224.88s
  Master Objective (UB) = 38773.47, θ = 190928.63
  Upper Bound (UB) = 38773.47

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 190928.63
  [DEBUG]   ✓ Scenario 0: θ = 190928.63 ≤ Q = 190928.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 190928.63 ≤ Q = 190928.63 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 190928.63 ≤ Q = 190928.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 190928.63 ≤ Q = 190928.63 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x54fc5de4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x54fc5de4
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [7e-13, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [2e-15, 2e+02]
Found heuristic solution: objective 1.402250e+13
Presolve removed 2600 rows and 1892 columns
Presolve time: 0.01s
Presolved: 493 rows, 497 columns, 1390 nonzeros
Found heuristic solution: objective 6860796.4494
Variable types: 337 continuous, 160 integer (160 binary)

Root relaxation: objective -1.625940e+05, 258 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -162593.96    0  130 6860796.45 -162593.96   102%     -    0s
H    0     0                    -127065.5205 -162593.96  28.0%     -    0s
H    0     0                    -128329.2807 -162593.96  26.7%     -    0s
H    0     0                    -131149.8176 -162593.96  24.0%     -    0s
H    0     0                    -131809.9024 -145145.41  10.1%     -    0s
     0     0 -145145.41    0   96 -131809.90 -145145.41  10.1%     -    0s
H    0     0                    -140787.2109 -145007.08  3.00%     -    0s
     0     0 -144401.52    0   95 -140787.21 -144401.52  2.57%     -    0s
     0     0 -144386.05    0   95 -140787.21 -144386.05  2.56%     -    0s
H    0     0                    -141493.6736 -144386.05  2.04%     -    0s
     0     0 -143272.17    0   79 -141493.67 -143272.17  1.26%     -    0s
H    0     0                    -141678.8634 -143164.21  1.05%     -    0s
     0     0 -143164.21    0   81 -141678.86 -143164.21  1.05%     -    0s
     0     0 -143098.30    0   93 -141678.86 -143098.30  1.00%     -    0s
     0     0 -142772.63    0   71 -141678.86 -142772.63  0.77%     -    0s
     0     0 -142729.85    0   70 -141678.86 -142729.85  0.74%     -    0s
     0     0 -142345.70    0   61 -141678.86 -142345.70  0.47%     -    0s
     0     0 -142288.79    0   61 -141678.86 -142288.79  0.43%     -    0s
     0     0 -142164.04    0   48 -141678.86 -142164.04  0.34%     -    0s
     0     0 -142143.36    0   48 -141678.86 -142143.36  0.33%     -    0s
     0     0 -142046.99    0   48 -141678.86 -142046.99  0.26%     -    0s
     0     0 -142044.76    0   47 -141678.86 -142044.76  0.26%     -    0s
     0     0 -142042.54    0   47 -141678.86 -142042.54  0.26%     -    0s
     0     2 -142042.54    0   47 -141678.86 -142042.54  0.26%     -    0s
H   28    21                    -141698.5377 -141823.04  0.09%  10.7    0s

Cutting planes:
  Gomory: 39
  Implied bound: 17
  MIR: 94
  Flow cover: 17
  RLT: 91
  Relax-and-lift: 8
  BQP: 1

Explored 655 nodes (3366 simplex iterations) in 0.19 seconds (0.09 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -141699 -141679 -141494 ... 1.40225e+13
No other solutions better than -141699

Optimal solution found (tolerance 1.00e-06)
Best objective -1.416985377007e+05, best bound -1.416985377007e+05, gap 0.0000%
  Subproblem solved in 0.22s
  Worst-case operational profit (Z_SP) = 179443.49
  Scenario: 45 demand increases, 15 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -141698.54
  [DEBUG]   S×d_nominal = 321142.03
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 321142.03 + -141698.54 = 179443.49
  [DEBUG]   Current θ from Master = 190928.63
  [DEBUG]   ⚠️  Z_SP ≤ θ by 11485.14 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 27288.33
  Lower Bound (LB) = 28468.08
  Gap (UB-LB) = 10305.3819, Absolute Gap = 10305.3819, Relative Gap = 0.265784
  Not converged yet (gap = 10305.38 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 45 increases, 15 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221674 nonzeros
Model fingerprint: 0xf50e26ea
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 35350 rows and 14350 columns
Presolve time: 1.44s
Presolved: 42483 rows, 19110 columns, 263069 nonzeros
Variable types: 16851 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -335473.7764
Found heuristic solution: objective -170353.9630

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 42483 rows, 19110 columns, 263069 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   25200    9.4322983e+03   0.000000e+00   1.715308e+07      5s
   39679    4.8329832e+04   0.000000e+00   6.713886e+06     10s
Concurrent spin time: 0.30s

Solved with dual simplex

Root relaxation: objective 6.454904e+04, 25012 iterations, 12.38 seconds (16.51 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 64549.0373    0  129 -170353.96 64549.0373   138%     -   14s
H    0     0                    -161217.2602 64549.0373   140%     -   14s
H    0     0                    -23567.72318 64549.0373   374%     -   14s
H    0     0                    10453.249690 64549.0373   518%     -   14s
H    0     0                    16163.277675 64549.0373   299%     -   15s
     0     0 59761.7882    0  180 16163.2777 59761.7882   270%     -   21s
H    0     0                    19266.356495 59761.5191   210%     -   22s
H    0     0                    19688.139193 59761.5191   204%     -   22s
H    0     0                    20075.296218 59761.5191   198%     -   22s
H    0     0                    20138.369390 59410.1118   195%     -   24s
     0     0 59388.6107    0  194 20138.3694 59388.6107   195%     -   24s
     0     0 59325.5329    0  188 20138.3694 59325.5329   195%     -   25s
     0     0 59214.2264    0  184 20138.3694 59214.2264   194%     -   27s
     0     0 59214.2264    0  182 20138.3694 59214.2264   194%     -   27s
     0     0 59214.2264    0  186 20138.3694 59214.2264   194%     -   27s
H    0     0                    21942.751334 56810.5350   159%     -   34s
H    0     0                    22182.972744 56810.5350   156%     -   34s
H    0     0                    22781.948016 56810.5350   149%     -   34s
H    0     0                    22847.389128 56810.5350   149%     -   34s
H    0     0                    23208.629114 56810.5350   145%     -   34s
H    0     0                    23225.959313 56810.5350   145%     -   34s
H    0     0                    23853.410599 56810.5350   138%     -   34s
H    0     0                    23902.528024 56810.5350   138%     -   34s
     0     0 56810.5350    0  257 23902.5280 56810.5350   138%     -   34s
H    0     0                    28027.291845 56810.4187   103%     -   34s
H    0     0                    28200.150940 56810.4187   101%     -   34s
H    0     0                    28444.265409 56810.4187   100%     -   34s
H    0     0                    28573.534042 56810.4187  98.8%     -   34s
     0     0 56183.8560    0  261 28573.5340 56183.8560  96.6%     -   39s
     0     0 55865.9322    0  278 28573.5340 55865.9322  95.5%     -   41s
     0     0 55826.4708    0  285 28573.5340 55826.4708  95.4%     -   43s
     0     0 55822.3114    0  286 28573.5340 55822.3114  95.4%     -   43s
     0     0 55815.6678    0  276 28573.5340 55815.6678  95.3%     -   43s
     0     0 55813.5117    0  285 28573.5340 55813.5117  95.3%     -   44s
     0     0 55810.1942    0  283 28573.5340 55810.1942  95.3%     -   44s
     0     0 55810.1873    0  283 28573.5340 55810.1873  95.3%     -   44s
H    0     0                    32739.430948 55810.1873  70.5%     -   47s
H    0     0                    32904.744612 55810.1873  69.6%     -   47s
H    0     0                    33244.893352 55810.1873  67.9%     -   47s
H    0     0                    33333.193141 55810.1873  67.4%     -   47s
H    0     0                    33342.081147 55810.1873  67.4%     -   47s
H    0     0                    33369.845065 55810.1873  67.2%     -   47s
H    0     0                    33399.377481 54034.3294  61.8%     -   54s
H    0     0                    33408.934632 54034.3294  61.7%     -   54s
H    0     0                    33748.435193 54034.3294  60.1%     -   54s
H    0     0                    33768.923583 54034.3294  60.0%     -   54s
     0     0 54034.3294    0  316 33768.9236 54034.3294  60.0%     -   54s
     0     0 53598.9235    0  325 33768.9236 53598.9235  58.7%     -   59s
H    0     0                    33972.857425 53373.6248  57.1%     -   62s
H    0     0                    34012.784417 53373.6248  56.9%     -   62s
     0     0 53373.6248    0  325 34012.7844 53373.6248  56.9%     -   62s
H    0     0                    34081.048116 53283.2260  56.3%     -   64s
     0     0 53283.2260    0  331 34081.0481 53283.2260  56.3%     -   64s
     0     0 53225.5547    0  348 34081.0481 53225.5547  56.2%     -   66s
     0     0 53183.4263    0  341 34081.0481 53183.4263  56.0%     -   67s
     0     0 53130.2392    0  340 34081.0481 53130.2392  55.9%     -   69s
     0     0 53120.4982    0  340 34081.0481 53120.4982  55.9%     -   70s
     0     0 53109.3424    0  344 34081.0481 53109.3424  55.8%     -   71s
H    0     0                    34261.643588 53105.2816  55.0%     -   72s
     0     0 53105.2816    0  348 34261.6436 53105.2816  55.0%     -   72s
     0     0 53103.0410    0  340 34261.6436 53103.0410  55.0%     -   72s
     0     0 53100.7363    0  345 34261.6436 53100.7363  55.0%     -   73s
     0     0 53099.4347    0  347 34261.6436 53099.4347  55.0%     -   73s
     0     0 53098.7012    0  345 34261.6436 53098.7012  55.0%     -   74s
     0     0 52645.8635    0  355 34261.6436 52645.8635  53.7%     -   80s
     0     0 52593.3502    0  358 34261.6436 52593.3502  53.5%     -   82s
     0     0 52566.5622    0  366 34261.6436 52566.5622  53.4%     -   83s
     0     0 52550.9176    0  358 34261.6436 52550.9176  53.4%     -   83s
     0     0 52538.8622    0  359 34261.6436 52538.8622  53.3%     -   84s
     0     0 52526.0472    0  363 34261.6436 52526.0472  53.3%     -   85s
     0     0 52521.7275    0  374 34261.6436 52521.7275  53.3%     -   85s
     0     0 52520.9080    0  375 34261.6436 52520.9080  53.3%     -   86s
     0     0 52465.4992    0  369 34261.6436 52465.4992  53.1%     -   88s
     0     0 52432.7705    0  372 34261.6436 52432.7705  53.0%     -   89s
     0     0 52424.9573    0  367 34261.6436 52424.9573  53.0%     -   89s
     0     0 52421.5318    0  372 34261.6436 52421.5318  53.0%     -   90s
     0     0 52420.9289    0  376 34261.6436 52420.9289  53.0%     -   90s
     0     0 52389.2973    0  367 34261.6436 52389.2973  52.9%     -   91s
     0     0 52371.5475    0  368 34261.6436 52371.5475  52.9%     -   94s
     0     0 52363.8939    0  368 34261.6436 52363.8939  52.8%     -   94s
     0     0 52359.5482    0  365 34261.6436 52359.5482  52.8%     -   94s
     0     0 52358.8598    0  369 34261.6436 52358.8598  52.8%     -   94s
     0     0 52294.0519    0  360 34261.6436 52294.0519  52.6%     -   96s
     0     0 52287.8522    0  372 34261.6436 52287.8522  52.6%     -   98s
     0     0 52286.3096    0  380 34261.6436 52286.3096  52.6%     -   99s
     0     0 52285.9968    0  370 34261.6436 52285.9968  52.6%     -   99s
     0     0 52256.9804    0  372 34261.6436 52256.9804  52.5%     -  101s
H    0     0                    34278.881440 52256.5220  52.4%     -  102s
H    0     0                    34341.183025 52256.5220  52.2%     -  102s
     0     0 52250.7943    0  371 34341.1830 52250.7943  52.2%     -  103s
     0     0 52247.8534    0  371 34341.1830 52247.8534  52.1%     -  103s
     0     0 52247.0393    0  371 34341.1830 52247.0393  52.1%     -  103s
     0     0 52225.8150    0  382 34341.1830 52225.8150  52.1%     -  105s
     0     0 52216.3946    0  375 34341.1830 52216.3946  52.1%     -  106s
     0     0 52214.6719    0  384 34341.1830 52214.6719  52.0%     -  106s
     0     0 52213.8444    0  378 34341.1830 52213.8444  52.0%     -  107s
     0     0 52194.8051    0  368 34341.1830 52194.8051  52.0%     -  108s
H    0     0                    34372.892731 52194.5563  51.8%     -  110s
H    0     0                    34375.574359 52194.5563  51.8%     -  110s
     0     0 52189.6618    0  375 34375.5744 52189.6618  51.8%     -  111s
     0     0 52187.0056    0  377 34375.5744 52187.0056  51.8%     -  111s
     0     0 52186.9734    0  381 34375.5744 52186.9734  51.8%     -  111s
     0     0 52185.0053    0  378 34375.5744 52185.0053  51.8%     -  112s
     0     0 52184.2124    0  385 34375.5744 52184.2124  51.8%     -  113s
     0     0 52177.5667    0  378 34375.5744 52177.5667  51.8%     -  114s
     0     0 52176.2547    0  379 34375.5744 52176.2547  51.8%     -  115s
     0     0 52175.5218    0  375 34375.5744 52175.5218  51.8%     -  115s
     0     0 52173.7082    0  375 34375.5744 52173.7082  51.8%     -  116s
     0     2 52173.7082    0  375 34375.5744 52173.7082  51.8%     -  137s
     3     8 51897.1395    2  383 34375.5744 52084.8206  51.5%  3543  144s
     7    16 51832.7899    3  388 34375.5744 51930.2899  51.1%  4688  149s
    15    32 51494.4371    4  387 34375.5744 51825.5299  50.8%  5839  160s
    31    51 49516.3399    5  381 34375.5744 51493.2552  49.8%  8038  182s
H   50    83                    34454.383161 51493.2552  49.5%  8326  191s
H   67    83                    34457.240287 51493.2552  49.4%  7945  191s
    82   181 49015.3743    7  336 34457.2403 51493.2552  49.4%  7072  202s
   180   303 48860.6696   10  329 34457.2403 51493.2552  49.4%  4506  210s
   302   381 48147.9902   11  313 34457.2403 51493.2552  49.4%  3381  216s
   380   412 48518.3009   13  331 34457.2403 51493.2552  49.4%  3101  220s
   449   480 48441.3849   14  330 34457.2403 51493.2552  49.4%  2939  227s
   481   513 48318.0752   13  293 34457.2403 51493.2552  49.4%  2880  231s
   517   544 48103.5246   13  290 34457.2403 51493.2552  49.4%  2842  237s
   556   581 47921.0675   14  342 34457.2403 51319.3474  48.9%  2825  241s
   593   636 47589.4484   15  314 34457.2403 51319.3474  48.9%  2836  245s
   648   696 47910.9920   14  276 34457.2403 51319.3474  48.9%  2804  250s
   708   742 47497.6717   15  301 34457.2403 51319.3474  48.9%  2774  256s
   756   799 47941.1994   15  319 34457.2403 51319.3474  48.9%  2812  261s
   817   858 47330.3641   15  296 34457.2403 51319.3474  48.9%  2803  266s
   882   916 47402.2657   15  296 34457.2403 51319.3474  48.9%  2780  271s
   958   972 47534.3212   16  315 34457.2403 51319.3474  48.9%  2733  278s
  1036  1035 47473.3107   15  300 34457.2403 51319.3474  48.9%  2719  289s
  1120  1094 47482.5813   16  321 34457.2403 51319.3474  48.9%  2698  300s
  1203  1167 47139.7270   16  285 34457.2403 51319.3474  48.9%  2693  308s
  1300  1247 47329.6559   16  304 34457.2403 51319.3474  48.9%  2670  314s
  1411  1321 46904.5074   16  287 34457.2403 51319.3474  48.9%  2628  323s
  1528  1406 46670.0592   16  288 34457.2403 50615.0442  46.9%  2601  330s
  1631  1502 46680.5960   17  300 34457.2403 50615.0442  46.9%  2603  337s
  1744  1593 46679.2853   17  292 34457.2403 50615.0442  46.9%  2591  344s
  1864  1672 46633.1662   17  309 34457.2403 50615.0442  46.9%  2560  354s
  1989  1749 45913.5389   17  283 34457.2403 50615.0442  46.9%  2561  365s
  2088  1850 46115.7142   18  285 34457.2403 50234.5839  45.8%  2622  375s
  2203  1964 45929.3288   18  274 34457.2403 50200.1042  45.7%  2643  387s
  2339  1995 44065.3261   21  203 34457.2403 50200.1042  45.7%  2649  393s
  2376  2072 43876.5247   22  219 34457.2403 50200.1042  45.7%  2656  399s
  2465  2201 43454.7631   25  177 34457.2403 50126.5835  45.5%  2632  408s
  2606  2363 43044.8195   27  171 34457.2403 50126.5835  45.5%  2613  419s
  2784  2522 42556.6616   31  185 34457.2403 50126.5835  45.5%  2572  427s
  2952  2704     cutoff   34      34457.2403 50126.5835  45.5%  2558  436s
  3141  2705 42114.0963   29  375 34457.2403 50126.5835  45.5%  2530  461s
  3143  2706 37245.0731   67  129 34457.2403 50126.5835  45.5%  2528  479s
  3144  2707 46428.9461   14  269 34457.2403 50126.5835  45.5%  2527  494s
  3145  2708 46409.9033   13  340 34457.2403 50126.5835  45.5%  2527  503s
  3146  2708 45450.2933   18  349 34457.2403 50126.5835  45.5%  2526  510s
  3148  2710 44927.6147   23  361 34457.2403 50126.5835  45.5%  2524  516s
  3150  2711 37497.4041   33  373 34457.2403 50126.5835  45.5%  2523  520s
  3154  2714 37788.7999   33  355 34457.2403 50126.5835  45.5%  2519  525s
  3157  2716 44038.8722   30  410 34457.2403 50126.5835  45.5%  2517  530s
  3160  2718 41901.7903   32  363 34457.2403 50126.5835  45.5%  2515  535s
  3163  2720 45937.5559   14  373 34457.2403 50126.5835  45.5%  2512  540s
  3165  2721 35463.0674   33  367 34457.2403 50126.5835  45.5%  2511  545s
  3168  2723 37890.3800   48  381 34457.2403 50126.5835  45.5%  2508  550s
  3171  2725 40993.8123   33  357 34457.2403 50126.5835  45.5%  2506  556s
  3174  2727 46631.2233   21  356 34457.2403 50126.5835  45.5%  2503  580s
  3175  2728 47633.9776   14  356 34457.2403 50126.5835  45.5%  2503  591s
  3176  2731 50126.5835   16  390 34457.2403 50126.5835  45.5%  2537  602s
  3178  2735 50126.5835   17  395 34457.2403 50126.5835  45.5%  2539  609s
  3182  2741 50126.5835   18  401 34457.2403 50126.5835  45.5%  2543  620s
  3190  2755 50126.5835   19  409 34457.2403 50126.5835  45.5%  2550  639s
  3206  2772 48617.4209   20  365 34457.2403 50126.5835  45.5%  2599  662s
  3229  2797 46512.7311   21  341 34457.2403 50126.5835  45.5%  2638  674s
H 3230  2659                    34883.567671 50126.5835  43.7%  2637  674s
H 3246  2523                    34951.156899 50126.5835  43.4%  2666  674s
H 3252  2398                    35698.421912 50126.5835  40.4%  2676  674s
  3261  2525 46170.5446   22  369 35698.4219 50126.5835  40.4%  2689  690s
  3397  2509 44835.0502   25  274 35698.4219 50126.5835  40.4%  2698  696s
H 3427  2381                    35739.674306 50126.5835  40.3%  2699  696s
  3431  2435 45033.2600   24  315 35739.6743 50126.5835  40.3%  2700  705s
  3504  2435 43725.4350   26  247 35739.6743 50126.5835  40.3%  2703  716s
H 3506  2323                    35747.197517 50126.5835  40.2%  2702  716s
H 3506  2217                    35991.558252 50126.5835  39.3%  2702  716s
  3540  2227 40518.9707   26  333 35991.5583 50126.5835  39.3%  2709  722s
H 3574  2115                    36312.918485 50126.5835  38.0%  2713  722s
  3576  2149 44366.6096   26  271 36312.9185 50126.5835  38.0%  2713  736s
  3659  2140 42798.0207   27  228 36312.9185 50126.5835  38.0%  2705  748s
  3734  2136 41590.0122   30  277 36312.9185 50126.5835  38.0%  2708  762s
  3794  2147 41212.5144   29  258 36312.9185 50126.5835  38.0%  2716  773s
  3857  2155 40169.0766   30  233 36312.9185 50126.5835  38.0%  2728  782s
H 3858  2060                    36578.252508 50126.5835  37.0%  2727  782s
  3891  2083 38884.1686   31  223 36578.2525 50126.5835  37.0%  2736  791s
  3948  2098 39368.1305   31  238 36578.2525 50126.5835  37.0%  2745  798s
  4001  2109 40152.3997   32  264 36578.2525 50126.5835  37.0%  2751  810s
  4073  2109 38224.0560   34  155 36578.2525 50126.5835  37.0%  2752  819s
  4111  2125 37962.3480   35  133 36578.2525 50126.5835  37.0%  2761  826s
H 4118  2031                    37013.417440 50126.5835  35.4%  2763  826s
  4149  2050 37908.5948   36  133 37013.4174 50126.5835  35.4%  2764  836s
  4226  2061 37365.6084   41  119 37013.4174 49994.6898  35.1%  2763  846s
H 4230  1973                    37548.368712 49988.6316  33.1%  2761  846s
  4302  1972 48070.1811   24  323 37548.3687 49984.7567  33.1%  2761  857s
  4403  1955 47612.0692   25  294 37548.3687 49984.7567  33.1%  2754  868s
H 4404  1873                    37637.896120 49984.7567  32.8%  2753  868s
H 4411  1794                    37693.067969 49984.7567  32.6%  2752  868s
  4452  1805 45912.6282   26  316 37693.0680 49984.7567  32.6%  2760  878s
  4548  1804 43223.4811   27  275 37693.0680 49984.7567  32.6%  2759  891s
  4639  1838 42175.4952   28  270 37693.0680 49977.0050  32.6%  2763  905s
  4728  1833 40719.4159   30  267 37693.0680 49329.1960  30.9%  2765  919s
H 4740  1755                    37747.951602 49329.1960  30.7%  2761  919s
H 4760  1677                    38159.641825 49329.1960  29.3%  2760  919s
H 4784  1602                    38222.655109 49329.1960  29.1%  2755  919s
H 4807  1532                    38414.067382 49329.1960  28.4%  2754  919s
  4837  1521 38926.0781   32  239 38414.0674 48925.4377  27.4%  2755  930s
  4916  1523 38828.7716   34  205 38414.0674 48925.4377  27.4%  2750  941s
  4963  1529     cutoff   35      38414.0674 48925.4377  27.4%  2758  954s
  5024  1542 43802.8159   22  277 38414.0674 48925.4377  27.4%  2758  967s
  5090  1543 40716.2431   23  273 38414.0674 48925.4377  27.4%  2757  980s
  5181  1539     cutoff   24      38414.0674 48925.4377  27.4%  2748  996s
  5302  1538 40533.6067   24  311 38414.0674 48925.4377  27.4%  2741 1011s
  5437  1515     cutoff   26      38414.0674 48925.4377  27.4%  2738 1026s
  5529  1517     cutoff   26      38414.0674 48925.4377  27.4%  2742 1040s
  5674  1512     cutoff   28      38414.0674 48925.4377  27.4%  2740 1058s
  5825  1506 infeasible   28      38414.0674 46628.5878  21.4%  2736 1073s
  5976  1467 42045.4651   26  319 38414.0674 46619.3498  21.4%  2738 1088s
  6099  1473 40024.8554   27  245 38414.0674 46619.3498  21.4%  2741 1105s
  6286  1454 38522.4367   33  212 38414.0674 45661.8001  18.9%  2731 1123s
  6496  1426 39779.0442   27  251 38414.0674 45661.8001  18.9%  2718 1141s
  6716  1361     cutoff   24      38414.0674 45450.5428  18.3%  2707 1161s
  6956  1372 43320.9140   21  337 38414.0674 45117.4783  17.5%  2697 1180s
  7158  1399 38689.3556   24  321 38414.0674 44497.0018  15.8%  2701 1201s
  7345  1401 41803.3981   23  311 38414.0674 44336.9460  15.4%  2713 1221s
  7588  1411 38736.6918   29  152 38414.0674 44180.9887  15.0%  2709 1237s
  7640  1421     cutoff   30      38414.0674 44038.5763  14.6%  2711 1257s
  7778  1430 41299.0584   29  301 38414.0674 44038.5763  14.6%  2704 1280s
  8033  1421 38707.1538   35  199 38414.0674 44038.5763  14.6%  2696 1303s
  8256  1433 40244.5927   25  274 38414.0674 43811.9269  14.1%  2691 1328s
  8546  1405 infeasible   28      38414.0674 43661.4702  13.7%  2689 1353s
  8873  1395 infeasible   27      38414.0674 43661.4702  13.7%  2680 1378s
  9196  1388 39668.4633   31  264 38414.0674 43147.8940  12.3%  2674 1405s
  9536  1358     cutoff   30      38414.0674 42761.0001  11.3%  2672 1432s
  9859  1306 39787.5708   31  212 38414.0674 42747.7062  11.3%  2662 1460s
 10243  1262 38898.5566   30  224 38414.0674 42460.6106  10.5%  2652 1489s
 10644  1186     cutoff   31      38414.0674 42356.1820  10.3%  2643 1520s
 11090  1060     cutoff   31      38414.0674 41890.2011  9.05%  2629 1551s
 11568   900 38494.4440   28  205 38414.0674 41591.1877  8.27%  2609 1581s
 12035   644     cutoff   32      38414.0674 41209.1761  7.28%  2596 1615s
 12616   149     cutoff   28      38414.0674 40720.8202  6.00%  2565 1647s
 13311     0     cutoff   29      38414.0674 39937.2393  3.97%  2500 1656s

Cutting planes:
  MIR: 524
  Mixing: 2
  Flow cover: 1081
  RLT: 24
  Relax-and-lift: 103

Explored 13518 nodes (33567193 simplex iterations) in 1656.88 seconds (3336.20 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 38414.1 38222.7 38159.6 ... 36312.9

Optimal solution found (tolerance 1.00e-06)
Best objective 3.841406738206e+04, best bound 3.841406738206e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1656.89s
  Master Objective (UB) = 38414.07, θ = 191323.77
  Upper Bound (UB) = 38414.07

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 191323.77
  [DEBUG]   ✓ Scenario 0: θ = 191323.77 ≤ Q = 191323.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 191323.77 ≤ Q = 191323.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 191323.77 ≤ Q = 191323.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 191323.77 ≤ Q = 191323.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 191323.77 ≤ Q = 191323.77 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x21d73aee
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xde28c512
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.388260e+13
Presolve removed 2600 rows and 1892 columns
Presolve time: 0.01s
Presolved: 493 rows, 497 columns, 1390 nonzeros
Found heuristic solution: objective 6808425.8194
Variable types: 337 continuous, 160 integer (160 binary)

Root relaxation: objective -1.646860e+05, 259 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -164686.01    0  133 6808425.82 -164686.01   102%     -    0s
H    0     0                    -128127.1967 -164686.01  28.5%     -    0s
H    0     0                    -128951.5410 -164686.01  27.7%     -    0s
H    0     0                    -132674.2415 -164686.01  24.1%     -    0s
     0     0 -147466.26    0   51 -132674.24 -147466.26  11.1%     -    0s
H    0     0                    -144540.3053 -147355.51  1.95%     -    0s
     0     0 -146338.63    0   51 -144540.31 -146338.63  1.24%     -    0s
     0     0 -146337.91    0   51 -144540.31 -146337.91  1.24%     -    0s
     0     0 -145955.32    0   17 -144540.31 -145955.32  0.98%     -    0s
H    0     0                    -145795.9735 -145955.32  0.11%     -    0s
     0     0 -145953.41    0   15 -145795.97 -145953.41  0.11%     -    0s
     0     0 -145953.41    0   14 -145795.97 -145953.41  0.11%     -    0s
     0     0 -145936.38    0    8 -145795.97 -145936.38  0.10%     -    0s
     0     0 -145934.56    0    9 -145795.97 -145934.56  0.10%     -    0s
     0     0 -145934.56    0   15 -145795.97 -145934.56  0.10%     -    0s
H    0     0                    -145829.9397 -145934.56  0.07%     -    0s
     0     0 -145922.56    0    5 -145829.94 -145922.56  0.06%     -    0s
H    0     0                    -145879.5192 -145919.23  0.03%     -    0s
H    0     0                    -145880.8774 -145919.23  0.03%     -    0s
     0     0 -145917.01    0    7 -145880.88 -145917.01  0.02%     -    0s
     0     0 -145906.35    0    6 -145880.88 -145906.35  0.02%     -    0s
     0     0 -145906.30    0    4 -145880.88 -145906.30  0.02%     -    0s
     0     0 -145894.26    0    3 -145880.88 -145894.26  0.01%     -    0s

Explored 1 nodes (646 simplex iterations) in 0.16 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -145894 -145892 -145881 ... -128127

Optimal solution found (tolerance 1.00e-06)
Best objective -1.458942178155e+05, best bound -1.458942584654e+05, gap 0.0000%
  Subproblem solved in 0.20s
  Worst-case operational profit (Z_SP) = 175247.81
  Scenario: 22 demand increases, 38 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -145894.22
  [DEBUG]   S×d_nominal = 321142.03
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 321142.03 + -145894.22 = 175247.81
  [DEBUG]   Current θ from Master = 191323.77
  [DEBUG]   ⚠️  Z_SP ≤ θ by 16075.96 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 22338.11
  Lower Bound (LB) = 28468.08
  Gap (UB-LB) = 9945.9828, Absolute Gap = 9945.9828, Relative Gap = 0.258915
  Not converged yet (gap = 9945.98 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 22 increases, 38 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 264905 nonzeros
Model fingerprint: 0xf4f8ecfd
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 42420 rows and 17220 columns
Presolve time: 1.31s
Presolved: 50703 rows, 22480 columns, 314579 nonzeros
Variable types: 20221 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -335473.7764
Found heuristic solution: objective -170353.9630

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 50703 rows, 22480 columns, 314579 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   22272   -3.5412619e+04   0.000000e+00   2.640811e+08      5s
   34072    2.3223626e+04   0.000000e+00   4.623814e+06     10s
   43764    3.6352621e+04   0.000000e+00   2.889394e+07     15s
   54889    5.0922053e+04   0.000000e+00   5.625534e+06     20s
   65880    5.5258310e+04   0.000000e+00   2.158335e+05     25s
Concurrent spin time: 5.95s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 6.450699e+04, 55857 iterations, 29.55 seconds (34.22 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 64506.9911    0  138 -170353.96 64506.9911   138%     -   31s
H    0     0                    -157014.4566 64506.9911   141%     -   31s
H    0     0                    -14875.94658 64506.9911   534%     -   31s
H    0     0                    -172.2239431 64506.9911      -     -   32s
H    0     0                    1873.5603981 64506.9911  3343%     -   32s
H    0     0                    2623.9272230 64506.9911  2358%     -   32s
H    0     0                    3106.5745505 64506.9911  1976%     -   32s
H    0     0                    12292.593129 64506.9911   425%     -   32s
H    0     0                    12408.123122 64506.9911   420%     -   32s
H    0     0                    12766.130833 64506.9911   405%     -   32s
H    0     0                    14360.644338 64506.9911   349%     -   32s
H    0     0                    14423.855685 64506.9911   347%     -   32s
H    0     0                    14627.247967 64506.9911   341%     -   32s
H    0     0                    14660.818074 64506.9911   340%     -   32s
H    0     0                    14741.174118 64506.9911   338%     -   33s
     0     0 59710.3384    0  214 14741.1741 59710.3384   305%     -   42s
H    0     0                    19025.923754 59710.3384   214%     -   43s
H    0     0                    19094.014967 59710.3384   213%     -   43s
H    0     0                    19489.980264 59710.3384   206%     -   43s
H    0     0                    19568.258504 59710.3384   205%     -   43s
H    0     0                    19577.224882 59710.3384   205%     -   43s
     0     0 59012.7366    0  216 19577.2249 59012.7366   201%     -   48s
     0     0 58785.7070    0  209 19577.2249 58785.7070   200%     -   51s
     0     0 58764.5018    0  218 19577.2249 58764.5018   200%     -   51s
     0     0 58760.0297    0  210 19577.2249 58760.0297   200%     -   53s
     0     0 58760.0297    0  213 19577.2249 58760.0297   200%     -   53s
     0     0 58760.0297    0  213 19577.2249 58760.0297   200%     -   54s
     0     0 58760.0297    0  211 19577.2249 58760.0297   200%     -   54s
     0     0 58760.0297    0  211 19577.2249 58760.0297   200%     -   54s
H    0     0                    20675.079023 56454.1068   173%     -   63s
H    0     0                    21057.516319 56454.1068   168%     -   63s
H    0     0                    21113.015150 56454.1068   167%     -   63s
     0     0 56454.1068    0  264 21113.0152 56454.1068   167%     -   63s
H    0     0                    23236.965993 56453.8034   143%     -   64s
H    0     0                    23670.894633 56453.8034   138%     -   64s
H    0     0                    23695.445003 56453.8034   138%     -   64s
H    0     0                    24045.040743 56453.8034   135%     -   64s
     0     0 55864.7969    0  281 24045.0407 55864.7969   132%     -   69s
     0     0 55795.7526    0  278 24045.0407 55795.7526   132%     -   71s
     0     0 55704.9816    0  283 24045.0407 55704.9816   132%     -   74s
     0     0 55606.6364    0  282 24045.0407 55606.6364   131%     -   76s
     0     0 55559.2761    0  281 24045.0407 55559.2761   131%     -   78s
     0     0 55545.3030    0  279 24045.0407 55545.3030   131%     -   78s
     0     0 55542.4283    0  285 24045.0407 55542.4283   131%     -   79s
     0     0 55541.6241    0  285 24045.0407 55541.6241   131%     -   79s
H    0     0                    25560.105100 54410.9685   113%     -   94s
H    0     0                    26172.017968 54410.9685   108%     -   94s
H    0     0                    26404.995302 54410.9685   106%     -   94s
H    0     0                    27022.683691 54410.9685   101%     -   94s
H    0     0                    27489.578690 54410.9685  97.9%     -   94s
     0     0 54410.9685    0  336 27489.5787 54410.9685  97.9%     -   94s
H    0     0                    27628.903075 54410.2354  96.9%     -   94s
H    0     0                    27900.276972 53839.3481  93.0%     -  103s
H    0     0                    28768.808360 53839.3481  87.1%     -  103s
H    0     0                    28861.356738 53839.3481  86.5%     -  103s
H    0     0                    28865.677900 53839.3481  86.5%     -  103s
     0     0 53839.3481    0  342 28865.6779 53839.3481  86.5%     -  103s
     0     0 53639.9838    0  345 28865.6779 53639.9838  85.8%     -  107s
     0     0 53561.8298    0  332 28865.6779 53561.8298  85.6%     -  110s
     0     0 53526.2417    0  333 28865.6779 53526.2417  85.4%     -  111s
     0     0 53438.2943    0  373 28865.6779 53438.2943  85.1%     -  115s
     0     0 53385.7279    0  367 28865.6779 53385.7279  84.9%     -  117s
     0     0 53352.4959    0  373 28865.6779 53352.4959  84.8%     -  119s
     0     0 53317.3217    0  377 28865.6779 53317.3217  84.7%     -  121s
     0     0 53302.4809    0  382 28865.6779 53302.4809  84.7%     -  124s
H    0     0                    28939.824722 53293.3726  84.2%     -  125s
     0     0 53293.3726    0  385 28939.8247 53293.3726  84.2%     -  125s
     0     0 53290.4222    0  388 28939.8247 53290.4222  84.1%     -  125s
     0     0 53289.2461    0  387 28939.8247 53289.2461  84.1%     -  125s
     0     0 53289.1504    0  387 28939.8247 53289.1504  84.1%     -  125s
     0     0 52645.1698    0  365 28939.8247 52645.1698  81.9%     -  138s
     0     0 52471.4247    0  363 28939.8247 52471.4247  81.3%     -  142s
     0     0 52423.1152    0  362 28939.8247 52423.1152  81.1%     -  145s
     0     0 52375.7139    0  359 28939.8247 52375.7139  81.0%     -  147s
     0     0 52362.1887    0  365 28939.8247 52362.1887  80.9%     -  149s
     0     0 52356.8516    0  357 28939.8247 52356.8516  80.9%     -  150s
     0     0 52348.6836    0  367 28939.8247 52348.6836  80.9%     -  150s
H    0     0                    29229.656089 52343.2621  79.1%     -  151s
     0     0 52343.2621    0  366 29229.6561 52343.2621  79.1%     -  151s
H    0     0                    29244.505246 52339.7093  79.0%     -  151s
     0     0 52339.7093    0  367 29244.5052 52339.7093  79.0%     -  151s
     0     0 52336.8862    0  365 29244.5052 52336.8862  79.0%     -  152s
     0     0 52335.6387    0  369 29244.5052 52335.6387  79.0%     -  152s
     0     0 52293.0814    0  370 29244.5052 52293.0814  78.8%     -  155s
     0     0 52287.1078    0  365 29244.5052 52287.1078  78.8%     -  156s
     0     0 52283.9553    0  370 29244.5052 52283.9553  78.8%     -  156s
     0     0 52283.3720    0  374 29244.5052 52283.3720  78.8%     -  157s
     0     0 52261.1825    0  367 29244.5052 52261.1825  78.7%     -  158s
     0     0 52244.7043    0  368 29244.5052 52244.7043  78.6%     -  159s
     0     0 52242.3722    0  368 29244.5052 52242.3722  78.6%     -  160s
     0     0 52241.6951    0  367 29244.5052 52241.6951  78.6%     -  160s
     0     0 52220.7281    0  366 29244.5052 52220.7281  78.6%     -  163s
     0     0 52216.8850    0  373 29244.5052 52216.8850  78.6%     -  163s
     0     0 52213.9421    0  370 29244.5052 52213.9421  78.5%     -  164s
     0     0 52213.6876    0  369 29244.5052 52213.6876  78.5%     -  164s
     0     0 52209.5378    0  369 29244.5052 52209.5378  78.5%     -  165s
     0     0 52209.0673    0  373 29244.5052 52209.0673  78.5%     -  166s
     0     0 52195.4738    0  373 29244.5052 52195.4738  78.5%     -  168s
     0     0 52194.2513    0  374 29244.5052 52194.2513  78.5%     -  169s
     0     0 52185.1542    0  370 29244.5052 52185.1542  78.4%     -  171s
     0     0 52185.0716    0  370 29244.5052 52185.0716  78.4%     -  172s
H    0     0                    29318.036964 52184.7672  78.0%     -  193s
H    0     0                    29441.257982 52184.7672  77.3%     -  193s
H    0     0                    29588.080234 52184.7672  76.4%     -  193s
     0     2 52184.7672    0  370 29588.0802 52184.7672  76.4%     -  196s
     1     4 52025.4808    1  364 29588.0802 52184.2458  76.4%  3200  206s
     3     8 51874.8640    2  355 29588.0802 52025.4131  75.8%  6425  214s
     7    16 51718.4993    3  353 29588.0802 51895.3780  75.4%  7283  226s
    15    32 51136.1212    4  344 29588.0802 51715.5571  74.8%  8998  241s
    31    50 50301.7226    5  349 29588.0802 51191.3218  73.0% 10199  268s
    49    82 50089.6813    6  337 29588.0802 51191.3218  73.0% 11534  279s
H   55    82                    29714.344046 51191.3218  72.3% 10769  279s
    81   139 50060.9609    7  334 29714.3440 51191.3218  72.3%  8686  291s
   138   174 49700.0594    9  322 29714.3440 51191.3218  72.3%  5878  301s
H  139   174                    29864.003723 51191.3218  71.4%  5836  301s
H  140   174                    32149.534470 51191.3218  59.2%  5823  301s
H  154   174                    32220.845204 51191.3218  58.9%  5430  301s
   173   292 49664.2122    9  327 32220.8452 51191.3218  58.9%  5157  313s
   291   324 48836.4850   10  319 32220.8452 51191.3218  58.9%  4022  320s
H  294   324                    33201.716478 51191.3218  54.2%  4016  320s
H  295   324                    33317.516881 51191.3218  53.6%  4006  320s
H  312   324                    33410.805020 51191.3218  53.2%  3951  320s
   323   395 49442.6386   10  323 33410.8050 51191.3218  53.2%  3891  332s
   394   472 48447.6431   11  300 33410.8050 51191.3218  53.2%  3693  341s
   473   553 49067.9853   10  304 33410.8050 51191.3218  53.2%  3470  351s
   558   639 48992.5634   12  320 33410.8050 51191.3218  53.2%  3261  357s
   646   728 49230.3438   12  304 33410.8050 51191.3218  53.2%  3034  364s
   739   800 48420.0557   11  310 33410.8050 51191.3218  53.2%  2830  372s
   817   885 47405.5882   11  293 33410.8050 51191.3218  53.2%  2736  380s
   902   965 48713.0104   13  308 33410.8050 51191.3218  53.2%  2634  389s
   992  1041 47773.4960   12  283 33410.8050 51191.3218  53.2%  2539  399s
  1098  1120 48156.9969   12  285 33410.8050 51135.7147  53.1%  2424  408s
  1207  1217 48458.8939   13  308 33410.8050 51135.7147  53.1%  2349  419s
  1346  1306 47818.3333   13  284 33410.8050 50814.4489  52.1%  2238  432s
  1461  1380 47981.6786   14  303 33410.8050 50814.4489  52.1%  2177  444s
  1579  1436 46036.0809   14  248 33410.8050 50814.4489  52.1%  2140  456s
  1675  1487 44988.2268   14  293 33410.8050 50814.4489  52.1%  2138  468s
  1754  1525 48288.3093   14  303 33410.8050 50626.3134  51.5%  2157  481s
H 1764  1525                    33419.372846 50626.3134  51.5%  2156  481s
H 1771  1525                    33640.268860 50626.3134  50.5%  2154  481s
  1816  1557 47814.8096   15  296 33640.2689 50626.3134  50.5%  2192  491s
H 1823  1557                    33718.513651 50626.3134  50.1%  2199  491s
H 1833  1557                    33759.966726 50626.3134  50.0%  2201  491s
  1861  1613 46071.5403   15  279 33759.9667 50626.3134  50.0%  2230  504s
  1925  1684 45885.8991   15  246 33759.9667 50626.3134  50.0%  2274  517s
  2010  1783 43588.3663   15  260 33759.9667 50626.3134  50.0%  2307  529s
  2129  1926 43407.7411   17  211 33759.9667 50624.6470  50.0%  2294  540s
  2296  2086 42831.4671   16  242 33759.9667 50624.6470  50.0%  2232  555s
H 2502  2159                    33903.723281 50501.2951  49.0%  2135  567s
H 2504  2158                    33980.458144 50501.2951  48.6%  2138  567s
H 2554  2153                    34270.298222 50501.2951  47.4%  2119  567s
  2664  2191 45329.0667   16  231 34270.2982 50501.2951  47.4%  2103  582s
H 2682  2190                    34333.729281 50501.2951  47.1%  2111  582s
  2726  2255 45220.7011   18  254 34333.7293 50501.2951  47.1%  2126  598s
H 2857  2292                    34339.179135 50423.5974  46.8%  2137  609s
H 2862  2223                    34966.934063 50423.5974  44.2%  2139  609s
H 2898  2049                    35968.745374 50423.5974  40.2%  2137  609s
H 2917  2040                    36260.624912 50423.5974  39.1%  2148  625s
H 2932  1997                    36518.170004 50423.5974  38.1%  2154  625s
H 2975  1991                    36553.219628 50423.5974  37.9%  2161  625s
  3022  2039 43196.5479   19  271 36553.2196 50220.9255  37.4%  2177  639s
H 3035  2031                    36619.796287 50220.9255  37.1%  2179  639s
H 3051  2023                    36695.110209 50220.9255  36.9%  2171  639s
H 3112  2015                    36735.091843 50220.9255  36.7%  2164  639s
  3125  2068 42721.5976   19  216 36735.0918 50220.9255  36.7%  2167  655s
H 3194  2067                    36756.404890 50220.9255  36.6%  2159  655s
  3269  2130 41177.9889   21  205 36756.4049 50220.9255  36.6%  2179  671s
  3419  2183 39004.3078   23  168 36756.4049 50220.9255  36.6%  2191  691s
H 3441  2173                    36822.710170 50220.9255  36.4%  2189  691s
H 3529  2153                    36935.955981 50220.9255  36.0%  2200  691s
  3544  2189 37501.1624   27  138 36935.9560 50054.1620  35.5%  2209  707s
  3670  2237 46907.7365   11  332 36935.9560 50054.1620  35.5%  2244  726s
  3772  2244 45393.9197   13  283 36935.9560 50054.1620  35.5%  2274  741s
  3829  2263 43425.5472   14  312 36935.9560 50054.1620  35.5%  2287  756s
  3878  2298 42267.1586   15  323 36935.9560 49969.2620  35.3%  2305  768s
  3939  2322 42000.7387   16  280 36935.9560 49969.2620  35.3%  2320  785s
  3995  2357 40487.7018   17  233 36935.9560 49969.2620  35.3%  2331  802s
  4106  2400 38947.6233   18  185 36935.9560 49969.2620  35.3%  2320  821s
  4273  2434 37497.2687   20  172 36935.9560 49749.5579  34.7%  2305  844s
  4426  2515 46739.5128   11  321 36935.9560 49445.3238  33.9%  2319  871s
  4598  2616 45241.0939   13  241 36935.9560 49411.6084  33.8%  2337  896s
  4794  2617 44427.4480   17  370 36935.9560 49313.0143  33.5%  2343  940s
  4796  2618 39715.8865   17  138 36935.9560 49313.0143  33.5%  2342  979s
  4797  2619 38739.8802   19  282 36935.9560 49313.0143  33.5%  2342 1003s
  4798  2620 40266.5536   26  364 36935.9560 49313.0143  33.5%  2341 1016s
  4799  2620 42821.4178   39  348 36935.9560 49313.0143  33.5%  2341 1028s
  4800  2621 41180.3367   22  372 36935.9560 49313.0143  33.5%  2340 1035s
  4802  2622 44151.4855   16  404 36935.9560 49313.0143  33.5%  2339 1044s
  4803  2623 40234.4591   39  370 36935.9560 49313.0143  33.5%  2339 1046s
  4805  2624 37522.0012   47  391 36935.9560 49313.0143  33.5%  2338 1052s
  4807  2626 41756.9849   21  364 36935.9560 49313.0143  33.5%  2337 1059s
  4808  2626 46327.7013   14  363 36935.9560 49313.0143  33.5%  2337 1061s
  4810  2628 47297.7952   22  405 36935.9560 49313.0143  33.5%  2336 1067s
  4812  2629 40651.1582   21  372 36935.9560 49313.0143  33.5%  2335 1073s
  4813  2630 46587.1940   12  373 36935.9560 49313.0143  33.5%  2334 1075s
  4815  2631 37361.5327   48  448 36935.9560 49313.0143  33.5%  2333 1081s
  4817  2632 43576.3608   39  404 36935.9560 49313.0143  33.5%  2332 1088s
  4818  2633 37413.3198   34  414 36935.9560 49313.0143  33.5%  2332 1091s
  4819  2634 48815.5028    8  371 36935.9560 49313.0143  33.5%  2331 1095s
  4821  2635 47324.4868   10  419 36935.9560 49313.0143  33.5%  2330 1100s
  4823  2636 47030.1049   13  377 36935.9560 49313.0143  33.5%  2329 1106s
  4824  2637 45820.7026   22  377 36935.9560 49313.0143  33.5%  2329 1143s
  4825  2638 44090.4992   20  377 36935.9560 49313.0143  33.5%  2328 1176s
  4826  2641 49313.0143   16  359 36935.9560 49313.0143  33.5%  2361 1188s
  4828  2645 49313.0143   17  362 36935.9560 49313.0143  33.5%  2362 1204s
  4832  2651 49313.0143   18  399 36935.9560 49313.0143  33.5%  2366 1225s
  4840  2665 49313.0143   19  384 36935.9560 49313.0143  33.5%  2377 1246s
  4856  2675 49313.0143   20  393 36935.9560 49313.0143  33.5%  2414 1285s
  4872  2702 48283.0066   21  372 36935.9560 49313.0143  33.5%  2438 1303s
  4904  2772 44455.6837   22  297 36935.9560 49313.0143  33.5%  2470 1327s
  5002  2780 43159.9959   24  289 36935.9560 49313.0143  33.5%  2591 1342s
  5093  2771 42839.2944   23  238 36935.9560 49313.0143  33.5%  2611 1358s
  5184  2744 39965.3756   25  332 36935.9560 49313.0143  33.5%  2618 1375s
  5265  2737 43010.0579   25  283 36935.9560 49313.0143  33.5%  2618 1392s
  5337  2731 39070.5674   25  211 36935.9560 49313.0143  33.5%  2629 1406s
  5390  2743     cutoff   26      36935.9560 49313.0143  33.5%  2641 1416s
  5449  2744     cutoff   25      36935.9560 49313.0143  33.5%  2648 1429s
  5504  2732 38736.0080   27  184 36935.9560 49313.0143  33.5%  2647 1442s
  5577  2722     cutoff   28      36935.9560 49313.0143  33.5%  2645 1453s
  5641  2709 41791.2834   27  274 36935.9560 49313.0143  33.5%  2650 1468s
  5708  2705 41398.3204   28  240 36935.9560 49313.0143  33.5%  2651 1479s
  5755  2716 38492.7053   29  144 36935.9560 49313.0143  33.5%  2653 1491s
  5801  2715 38055.0634   30  140 36935.9560 49313.0143  33.5%  2654 1504s
  5848  2713 37423.8457   31  151 36935.9560 49313.0143  33.5%  2661 1520s
  5897  2701     cutoff   32      36935.9560 49313.0143  33.5%  2659 1534s
  5955  2707 41567.5245   23  185 36935.9560 48633.2680  31.7%  2664 1543s
  5993  2719 38169.6061   24  181 36935.9560 48599.6708  31.6%  2668 1556s
  6040  2730     cutoff   25      36935.9560 47882.6748  29.6%  2673 1573s
  6105  2724     cutoff   28      36935.9560 47782.8135  29.4%  2673 1588s
  6178  2706 41603.6734   23  306 36935.9560 47650.6171  29.0%  2675 1607s
  6249  2703 41106.5989   25  235 36935.9560 47650.6171  29.0%  2678 1627s
  6309  2705 38959.5089   28  197 36935.9560 47363.9133  28.2%  2690 1644s
  6384  2719 37722.8212   30  170 36935.9560 47363.9133  28.2%  2698 1659s
  6467  2701 37464.2300   32  171 36935.9560 47363.9133  28.2%  2700 1676s
  6567  2707 42938.6885   24  231 36935.9560 46997.1652  27.2%  2708 1692s
  6645  2707 39957.2677   26  243 36935.9560 46818.2230  26.8%  2719 1708s
  6742  2718 38690.4761   29  169 36935.9560 46703.4542  26.4%  2724 1728s
  6851  2708 37181.3305   33  137 36935.9560 46703.4542  26.4%  2728 1746s
  6967  2687 43359.9752   26  240 36935.9560 46703.4542  26.4%  2737 1761s
  7018  2712 40514.0425   27  197 36935.9560 46703.4542  26.4%  2746 1780s
  7128  2709 38807.2814   28  205 36935.9560 45901.8712  24.3%  2751 1801s
  7254  2721 39289.4567   30  163 36935.9560 45813.7158  24.0%  2765 1821s
  7407  2714 39067.9689   33  117 36935.9560 45813.7158  24.0%  2768 1844s
  7580  2711 41206.9563   23  333 36935.9560 45243.6802  22.5%  2770 1866s
  7766  2684 39507.0990   26  267 36935.9560 45148.7715  22.2%  2766 1888s
  7951  2665     cutoff   32      36935.9560 45148.7715  22.2%  2769 1912s
  8144  2621     cutoff   25      36935.9560 44909.9834  21.6%  2771 1936s
  8279  2610     cutoff   25      36935.9560 44597.2994  20.7%  2773 1959s
  8466  2607 38478.5297   26  204 36935.9560 44234.9993  19.8%  2778 1985s
  8674  2548     cutoff   29      36935.9560 44164.4932  19.6%  2785 2013s
  8921  2481     cutoff   30      36935.9560 44131.4919  19.5%  2784 2043s
  9142  2447 39639.9958   29  254 36935.9560 43892.8988  18.8%  2795 2076s
  9387  2376 37878.7105   34  188 36935.9560 43622.4678  18.1%  2802 2102s
  9530  2352     cutoff   26      36935.9560 43622.4678  18.1%  2796 2135s
  9808  2291 37527.3966   29  147 36935.9560 43449.7362  17.6%  2796 2171s
 10069  2216 39661.3869   26  301 36935.9560 43015.0990  16.5%  2804 2209s
 10380  2141     cutoff   27      36935.9560 42961.0402  16.3%  2806 2243s
 10673  2069 36965.5373   27  193 36935.9560 42704.1421  15.6%  2816 2280s
H10968  1838                    37042.273693 42501.1372  14.7%  2818 2280s
 11039  1814     cutoff   28      37042.2737 42501.1372  14.7%  2810 2317s
 11383  1735 39222.2418   24  363 37042.2737 42309.8235  14.2%  2815 2353s
 11761  1598 38798.1551   28  273 37042.2737 42087.5279  13.6%  2810 2394s
 12123  1496     cutoff   31      37042.2737 42056.1033  13.5%  2816 2437s
 12530  1427 39135.5931   25  234 37042.2737 41698.9336  12.6%  2815 2480s
 13002  1391 37047.6993   29  197 37042.2737 41526.8103  12.1%  2804 2523s
 13483  1378 37487.3480   28  266 37042.2737 41089.3961  10.9%  2794 2570s
 13959  1356 infeasible   30      37042.2737 40856.6585  10.3%  2790 2619s
 14436  1261 38327.2489   26  240 37042.2737 40721.7909  9.93%  2786 2665s
 14960  1189     cutoff   24      37042.2737 40427.1102  9.14%  2780 2714s
H14961  1189                    37042.343880 40427.1102  9.14%  2779 2714s
 15446  1025     cutoff   30      37042.3439 40236.5434  8.62%  2772 2767s
 15975   805 38273.1974   31  269 37042.3439 39824.3742  7.51%  2773 2818s
 16768   563     cutoff   27      37042.3439 39414.2104  6.40%  2737 2874s
*17538   563              86    37082.659722 39259.8329  5.87%  2655 2874s
*18256   563              41    37136.610738 39169.2731  5.47%  2577 2874s
*18262   563              42    37372.514030 39169.2731  4.81%  2576 2874s
 18482    53     cutoff   88      37372.5140 38728.9277  3.63%  2556 2890s
*19114    53              65    37394.796706 38515.4571  3.00%  2477 2890s
 19534    20     cutoff   56      37394.7967 37759.4937  0.98%  2425 2895s
*19631    20              50    37403.532968 37552.9174  0.40%  2414 2895s
*19657    20              48    37404.462955 37552.9174  0.40%  2411 2895s
*19666    20              46    37416.570270 37552.9174  0.36%  2410 2895s

Cutting planes:
  Implied bound: 1
  MIR: 630
  Flow cover: 1424
  RLT: 21
  Relax-and-lift: 129

Explored 19816 nodes (47595194 simplex iterations) in 2895.56 seconds (5639.68 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 37416.6 37404.5 37403.5 ... 36936

Optimal solution found (tolerance 1.00e-06)
Warning: max constraint violation (3.2487e-09) exceeds tolerance
Best objective 3.741657027008e+04, best bound 3.741657027008e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2895.58s
  Master Objective (UB) = 37416.57, θ = 192335.14
  Upper Bound (UB) = 37416.57

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 192335.14
  [DEBUG]   ✓ Scenario 0: θ = 192335.14 ≤ Q = 192335.14 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 192335.14 ≤ Q = 192335.14 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 192335.14 ≤ Q = 192335.14 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 192335.14 ≤ Q = 192335.14 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 192335.14 ≤ Q = 192335.14 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 192335.14 ≤ Q = 192335.14 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x2e213f91
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x2e213f91
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [1e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.415080e+13
Presolve removed 2600 rows and 1892 columns
Presolve time: 0.01s
Presolved: 493 rows, 497 columns, 1390 nonzeros
Found heuristic solution: objective 6868397.2270
Variable types: 337 continuous, 160 integer (160 binary)

Root relaxation: objective -1.644490e+05, 257 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -164448.96    0  129 6868397.23 -164448.96   102%     -    0s
H    0     0                    -122336.9305 -164448.96  34.4%     -    0s
H    0     0                    -123143.2316 -164448.96  33.5%     -    0s
H    0     0                    -130988.9283 -164448.96  25.5%     -    0s
H    0     0                    -133454.6999 -164448.96  23.2%     -    0s
H    0     0                    -139222.3589 -164448.96  18.1%     -    0s
H    0     0                    -142086.4958 -147148.67  3.56%     -    0s
     0     0 -147148.67    0   93 -142086.50 -147148.67  3.56%     -    0s
H    0     0                    -142385.2029 -147104.38  3.31%     -    0s
H    0     0                    -143025.2780 -147104.38  2.85%     -    0s
H    0     0                    -143323.9850 -147104.38  2.64%     -    0s
H    0     0                    -143582.0380 -146333.11  1.92%     -    0s
     0     0 -146322.44    0   90 -143582.04 -146322.44  1.91%     -    0s
     0     0 -145216.51    0   58 -143582.04 -145216.51  1.14%     -    0s
     0     0 -145098.20    0   66 -143582.04 -145098.20  1.06%     -    0s
     0     0 -145081.46    0   57 -143582.04 -145081.46  1.04%     -    0s
     0     0 -144938.14    0   47 -143582.04 -144938.14  0.94%     -    0s
     0     0 -144847.18    0   47 -143582.04 -144847.18  0.88%     -    0s
     0     0 -144847.18    0   47 -143582.04 -144847.18  0.88%     -    0s
     0     0 -144803.33    0   47 -143582.04 -144803.33  0.85%     -    0s
     0     2 -144803.33    0   47 -143582.04 -144803.33  0.85%     -    0s
H   32    63                    -144513.0847 -144637.81  0.09%   9.3    0s
H   33    62                    -144584.5286 -144637.81  0.04%   9.2    0s
*  143    17              17    -144606.2475 -144624.19  0.01%   4.3    0s
*  176     0              18    -144607.3274 -144617.76  0.01%   4.2    0s
*  178     0              19    -144610.4797 -144617.76  0.01%   4.2    0s

Cutting planes:
  Gomory: 50
  Implied bound: 9
  MIR: 136
  Flow cover: 17
  RLT: 58
  Relax-and-lift: 5
  BQP: 1

Explored 191 nodes (1402 simplex iterations) in 0.17 seconds (0.07 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -144610 -144607 -144606 ... -139222
No other solutions better than -144610

Optimal solution found (tolerance 1.00e-06)
Best objective -1.446104796733e+05, best bound -1.446104796733e+05, gap 0.0000%
  Subproblem solved in 0.20s
  Worst-case operational profit (Z_SP) = 176531.55
  Scenario: 21 demand increases, 39 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -144610.48
  [DEBUG]   S×d_nominal = 321142.03
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 321142.03 + -144610.48 = 176531.55
  [DEBUG]   Current θ from Master = 192335.14
  [DEBUG]   ⚠️  Z_SP ≤ θ by 15803.60 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 21612.97
  Lower Bound (LB) = 28468.08
  Gap (UB-LB) = 8948.4857, Absolute Gap = 8948.4857, Relative Gap = 0.239158
  Not converged yet (gap = 8948.49 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 21 increases, 39 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308136 nonzeros
Model fingerprint: 0xaad8f530
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 49490 rows and 20090 columns
Presolve time: 1.79s
Presolved: 58923 rows, 25850 columns, 366089 nonzeros
Variable types: 23591 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -335473.7764
Found heuristic solution: objective -170353.9630

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 58923 rows, 25850 columns, 366089 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   24948   -7.8445703e+04   0.000000e+00   2.255538e+07      5s
   37413    1.8557175e+04   0.000000e+00   7.924316e+08     10s
   46033    3.0335803e+04   0.000000e+00   1.601575e+07     15s
   55297    4.0345183e+04   0.000000e+00   7.823748e+06     20s
   64702    5.1248674e+04   0.000000e+00   2.090763e+08     25s
Concurrent spin time: 10.15s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 6.450222e+04, 56742 iterations, 34.16 seconds (40.43 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 64502.2225    0  134 -170353.96 64502.2225   138%     -   36s
H    0     0                    -157014.4566 64502.2225   141%     -   36s
H    0     0                    -154040.9006 64502.2225   142%     -   37s
H    0     0                    -151841.8982 64502.2225   142%     -   37s
H    0     0                    -149983.9785 64502.2225   143%     -   37s
H    0     0                    -40492.09561 64502.2225   259%     -   37s
H    0     0                    -40397.74303 64502.2225   260%     -   37s
H    0     0                    -356.5861341 64502.2225      -     -   37s
H    0     0                    2078.6633347 64502.2225  3003%     -   37s
H    0     0                    12805.913023 64502.2225   404%     -   37s
H    0     0                    14540.049651 64502.2225   344%     -   37s
H    0     0                    14708.914967 64502.2225   339%     -   37s
H    0     0                    14760.736757 59593.1639   304%     -   50s
H    0     0                    14765.083729 59593.1639   304%     -   50s
H    0     0                    14833.543754 59593.1639   302%     -   50s
     0     0 59593.1639    0  214 14833.5438 59593.1639   302%     -   50s
     0     0 58949.7884    0  220 14833.5438 58949.7884   297%     -   56s
     0     0 58735.6973    0  212 14833.5438 58735.6973   296%     -   58s
     0     0 58732.4347    0  211 14833.5438 58732.4347   296%     -   59s
     0     0 58732.4347    0  214 14833.5438 58732.4347   296%     -   62s
     0     0 58732.4347    0  214 14833.5438 58732.4347   296%     -   63s
     0     0 58732.4347    0  214 14833.5438 58732.4347   296%     -   64s
     0     0 58732.4347    0  214 14833.5438 58732.4347   296%     -   64s
     0     0 58732.4347    0  216 14833.5438 58732.4347   296%     -   64s
     0     0 58732.4347    0  216 14833.5438 58732.4347   296%     -   64s
     0     0 58732.4347    0  216 14833.5438 58732.4347   296%     -   65s
     0     0 58732.4347    0  214 14833.5438 58732.4347   296%     -   65s
     0     0 58732.4347    0  212 14833.5438 58732.4347   296%     -   65s
     0     0 56579.1206    0  235 14833.5438 56579.1206   281%     -   80s
H    0     0                    19505.924050 56578.9759   190%     -   80s
H    0     0                    19802.826332 56578.9759   186%     -   80s
     0     0 56203.6076    0  257 19802.8263 56203.6076   184%     -   84s
     0     0 55889.6809    0  275 19802.8263 55889.6809   182%     -   87s
     0     0 55809.3968    0  310 19802.8263 55809.3968   182%     -   89s
     0     0 55741.9303    0  284 19802.8263 55741.9303   181%     -   90s
H    0     0                    20861.531177 55727.5685   167%     -   92s
H    0     0                    20894.337422 55727.5685   167%     -   92s
     0     0 55727.5685    0  315 20894.3374 55727.5685   167%     -   92s
     0     0 55713.0433    0  314 20894.3374 55713.0433   167%     -   93s
     0     0 55703.8815    0  288 20894.3374 55703.8815   167%     -   94s
     0     0 55693.1172    0  309 20894.3374 55693.1172   167%     -   94s
     0     0 55685.0657    0  309 20894.3374 55685.0657   167%     -   95s
     0     0 55676.2745    0  313 20894.3374 55676.2745   166%     -   95s
     0     0 55668.8262    0  316 20894.3374 55668.8262   166%     -   96s
     0     0 55667.8801    0  312 20894.3374 55667.8801   166%     -   96s
     0     0 55667.4088    0  313 20894.3374 55667.4088   166%     -   96s
H    0     0                    25141.575214 55667.4088   121%     -  104s
H    0     0                    25826.472078 54453.7142   111%     -  114s
H    0     0                    25890.248960 54453.7142   110%     -  114s
H    0     0                    26102.986995 54453.7142   109%     -  114s
H    0     0                    26212.698999 54453.7142   108%     -  114s
H    0     0                    26468.202522 54453.7142   106%     -  114s
     0     0 54453.7142    0  309 26468.2025 54453.7142   106%     -  114s
     0     0 53887.0308    0  325 26468.2025 53887.0308   104%     -  121s
H    0     0                    26552.557368 53722.2514   102%     -  125s
     0     0 53722.2514    0  318 26552.5574 53722.2514   102%     -  126s
     0     0 53565.3974    0  327 26552.5574 53565.3974   102%     -  131s
     0     0 53514.4084    0  334 26552.5574 53514.4084   102%     -  134s
     0     0 53469.6123    0  328 26552.5574 53469.6123   101%     -  137s
     0     0 53444.9240    0  338 26552.5574 53444.9240   101%     -  138s
     0     0 53423.4555    0  337 26552.5574 53423.4555   101%     -  140s
     0     0 53404.7784    0  335 26552.5574 53404.7784   101%     -  142s
     0     0 53400.7417    0  337 26552.5574 53400.7417   101%     -  143s
     0     0 53394.2860    0  338 26552.5574 53394.2860   101%     -  144s
     0     0 53391.1270    0  345 26552.5574 53391.1270   101%     -  145s
     0     0 53390.0242    0  345 26552.5574 53390.0242   101%     -  146s
H    0     0                    26751.280507 53390.0242   100%     -  156s
     0     0 52948.2608    0  345 26751.2805 52948.2608  97.9%     -  165s
     0     0 52746.0267    0  343 26751.2805 52746.0267  97.2%     -  171s
     0     0 52657.4821    0  352 26751.2805 52657.4821  96.8%     -  174s
     0     0 52636.4937    0  346 26751.2805 52636.4937  96.8%     -  177s
     0     0 52622.6441    0  361 26751.2805 52622.6441  96.7%     -  178s
     0     0 52583.5867    0  379 26751.2805 52583.5867  96.6%     -  180s
     0     0 52571.9252    0  387 26751.2805 52571.9252  96.5%     -  181s
H    0     0                    27417.252125 52559.1249  91.7%     -  182s
H    0     0                    28740.039752 52559.1249  82.9%     -  182s
H    0     0                    28745.373391 52559.1249  82.8%     -  182s
H    0     0                    29116.840585 52559.1249  80.5%     -  182s
     0     0 52559.1249    0  386 29116.8406 52559.1249  80.5%     -  182s
H    0     0                    29324.445344 52555.0806  79.2%     -  183s
     0     0 52555.0806    0  386 29324.4453 52555.0806  79.2%     -  183s
     0     0 52553.8469    0  385 29324.4453 52553.8469  79.2%     -  183s
     0     0 52475.4759    0  401 29324.4453 52475.4759  78.9%     -  187s
H    0     0                    29405.651018 52472.5953  78.4%     -  187s
H    0     0                    29443.530272 52472.5953  78.2%     -  187s
H    0     0                    29633.652688 52472.5953  77.1%     -  188s
H    0     0                    29644.935317 52472.5953  77.0%     -  188s
H    0     0                    29716.954316 52472.5953  76.6%     -  188s
H    0     0                    29794.848902 52472.5953  76.1%     -  188s
H    0     0                    29809.502693 52472.5953  76.0%     -  188s
     0     0 52463.3304    0  388 29809.5027 52463.3304  76.0%     -  189s
     0     0 52455.9865    0  388 29809.5027 52455.9865  76.0%     -  191s
     0     0 52452.5645    0  359 29809.5027 52452.5645  76.0%     -  192s
     0     0 52451.4633    0  358 29809.5027 52451.4633  76.0%     -  192s
     0     0 52422.9788    0  364 29809.5027 52422.9788  75.9%     -  194s
H    0     0                    29847.236446 52421.7485  75.6%     -  195s
H    0     0                    29953.613551 52421.7485  75.0%     -  195s
     0     0 52413.3548    0  371 29953.6136 52413.3548  75.0%     -  197s
     0     0 52410.1982    0  372 29953.6136 52410.1982  75.0%     -  198s
     0     0 52405.8766    0  377 29953.6136 52405.8766  75.0%     -  198s
     0     0 52403.4365    0  371 29953.6136 52403.4365  74.9%     -  199s
     0     0 52402.8570    0  372 29953.6136 52402.8570  74.9%     -  199s
     0     0 52346.8581    0  367 29953.6136 52346.8581  74.8%     -  202s
     0     0 52338.0586    0  368 29953.6136 52338.0586  74.7%     -  203s
     0     0 52334.7450    0  363 29953.6136 52334.7450  74.7%     -  203s
     0     0 52333.8037    0  367 29953.6136 52333.8037  74.7%     -  204s
     0     0 52313.2777    0  361 29953.6136 52313.2777  74.6%     -  205s
     0     0 52304.6081    0  356 29953.6136 52304.6081  74.6%     -  207s
     0     0 52299.3581    0  364 29953.6136 52299.3581  74.6%     -  208s
     0     0 52298.6591    0  358 29953.6136 52298.6591  74.6%     -  208s
     0     0 52277.4149    0  365 29953.6136 52277.4149  74.5%     -  210s
     0     0 52274.5813    0  361 29953.6136 52274.5813  74.5%     -  212s
     0     0 52269.0218    0  361 29953.6136 52269.0218  74.5%     -  213s
     0     0 52268.4320    0  364 29953.6136 52268.4320  74.5%     -  213s
     0     0 52262.8338    0  368 29953.6136 52262.8338  74.5%     -  215s
     0     0 52259.8499    0  369 29953.6136 52259.8499  74.5%     -  221s
     0     0 52259.1813    0  374 29953.6136 52259.1813  74.5%     -  221s
     0     0 52252.9837    0  364 29953.6136 52252.9837  74.4%     -  223s
     0     0 52249.0074    0  362 29953.6136 52249.0074  74.4%     -  224s
     0     0 52249.0074    0  367 29953.6136 52249.0074  74.4%     -  225s
     0     0 52249.0074    0  367 29953.6136 52249.0074  74.4%     -  226s
     0     2 52249.0074    0  367 29953.6136 52249.0074  74.4%     -  260s
     3     8 51569.0403    2  363 29953.6136 52191.6738  74.2%  4786  276s
     7    16 51509.8488    3  406 29953.6136 51568.5178  72.2%  6362  285s
    15    32 51243.0830    4  408 29953.6136 51509.3904  72.0%  6637  298s
    31    52 50348.3374    5  350 29953.6136 51242.8956  71.1% 10446  321s
    51    84 50236.1425    6  358 29953.6136 51242.8956  71.1%  9482  347s
H   60    84                    30311.818465 51242.8956  69.1%  8994  347s
    83   220 50212.9333    7  349 30311.8185 51242.8956  69.1%  7743  369s
   219   252 49989.2332   10  337 30311.8185 51242.8956  69.1%  4703  377s
H  221   252                    30413.843386 51242.8956  68.5%  4669  377s
H  225   252                    30416.916489 51242.8956  68.5%  4660  377s
H  231   252                    30804.960062 51242.8956  66.3%  4616  377s
   251   309 49753.7571   10  329 30804.9601 51242.8956  66.3%  4600  389s
H  308   371                    30915.019462 51242.8956  65.8%  4447  399s
   370   436 49778.4362   11  340 30915.0195 51242.8956  65.8%  4392  411s
   435   497 48971.8472   11  336 30915.0195 51242.8956  65.8%  4250  424s
   496   557 49573.0457   11  323 30915.0195 51242.8956  65.8%  4146  435s
   556   588 49448.3339   10  344 30915.0195 51242.8956  65.8%  4163  447s
   587   637 49558.6794   12  363 30915.0195 51242.8956  65.8%  4111  458s
   636   667 48992.2673   12  326 30915.0195 51242.8956  65.8%  4018  469s
H  640   667                    31091.444555 51242.8956  64.8%  4001  469s
   666   752 48672.1157   11  315 31091.4446 51242.8956  64.8%  3979  482s
   751   839 49275.8506   12  355 31091.4446 51242.8956  64.8%  3777  493s
   840   938 48762.3350   12  319 31091.4446 51242.8956  64.8%  3580  505s
   941   970 48842.3707   12  333 31091.4446 51242.8956  64.8%  3400  513s
   973   999 49550.8860   13  331 31091.4446 51242.8956  64.8%  3378  524s
  1012  1028 45594.9532   13  248 31091.4446 51242.8956  64.8%  3343  536s
  1047  1059 47010.6076   13  291 31091.4446 51242.8956  64.8%  3327  547s
H 1064  1059                    31145.378744 51242.8956  64.5%  3330  547s
  1080  1088 48736.6569   12  316 31145.3787 51242.8956  64.5%  3308  555s
  1115  1117 48289.5532   13  338 31145.3787 51242.8956  64.5%  3258  568s
  1148  1164 46193.3493   14  254 31145.3787 51242.8956  64.5%  3238  578s
  1199  1246 47730.7594   14  317 31145.3787 51242.8956  64.5%  3188  591s
  1298  1314 45287.9089   14  279 31145.3787 51176.6394  64.3%  3037  605s
  1407  1392 46924.2073   14  307 31145.3787 51176.6394  64.3%  2924  620s
  1527  1461 47434.4116   15  322 31145.3787 51176.6394  64.3%  2837  637s
  1625  1557 46315.5255   15  294 31145.3787 51176.6394  64.3%  2824  652s
  1738  1663 45833.7888   15  261 31145.3787 51176.6394  64.3%  2798  669s
  1868  1757 45131.4477   15  242 31145.3787 51176.6394  64.3%  2742  684s
  2022  1852 44819.7283   16  304 31145.3787 51176.6394  64.3%  2670  699s
  2155  1888 47162.9799   16  312 31145.3787 51176.6394  64.3%  2643  715s
  2195  1951 45435.6582   17  300 31145.3787 50447.8873  62.0%  2678  730s
  2272  2059 43770.9255   16  280 31145.3787 50407.0010  61.8%  2683  748s
  2394  2181 45269.3199   18  315 31145.3787 50355.4225  61.7%  2672  766s
  2554  2296 41337.2018   18  282 31145.3787 50355.4225  61.7%  2629  787s
  2743  2437 43248.1653   20  268 31145.3787 50355.4225  61.7%  2571  807s
  2942  2576 42286.5962   21  254 31145.3787 50355.4225  61.7%  2526  827s
  3154  2645 41862.1319   22  266 31145.3787 50128.6368  61.0%  2484  842s
H 3228  2645                    31158.993670 50050.6478  60.6%  2478  842s
H 3237  2092                    34563.079142 50050.6478  44.8%  2479  842s
  3245  2137 41409.8554   23  277 34563.0791 50050.6478  44.8%  2486  864s
  3400  2229 41362.2083   24  235 34563.0791 50050.6478  44.8%  2508  887s
  3519  2336 39645.8418   26  215 34563.0791 50050.6478  44.8%  2553  907s
  3692  2515 38799.3264   29  168 34563.0791 49900.3394  44.4%  2569  931s
H 3887  2428                    34944.892389 49836.5390  42.6%  2571  986s
  3888  2425 37680.3288   20  367 34944.8924 49836.5390  42.6%  2570 1050s
  3890  2426 48813.6392    9  134 34944.8924 49836.5390  42.6%  2569 1100s
  3891  2427 46463.4111   11  274 34944.8924 49836.5390  42.6%  2568 1127s
H 3891  2305                    34986.538266 49836.5390  42.4%  2568 1147s
H 3891  2190                    35099.792549 49836.5390  42.0%  2568 1147s
  3893  2191 39190.0046   11  363 35099.7925 49836.5390  42.0%  2567 1157s
H 3893  2081                    35138.114600 49836.5390  41.8%  2567 1166s
H 3893  1977                    35243.470782 49836.5390  41.4%  2567 1166s
H 3893  1878                    35256.010751 49836.5390  41.4%  2567 1166s
  3895  1880 48001.6956   19  361 35256.0108 49836.5390  41.4%  2565 1173s
  3896  1880 48256.6365   13  354 35256.0108 49836.5390  41.4%  2565 1179s
  3897  1881 38184.2927   38  366 35256.0108 49836.5390  41.4%  2564 1184s
  3898  1882 49356.9244   10  406 35256.0108 49836.5390  41.4%  2563 1189s
  3899  1882 46848.3415   10  405 35256.0108 49836.5390  41.4%  2563 1191s
H 3899  1788                    35265.854124 49836.5390  41.3%  2563 1192s
H 3900  1699                    35534.501694 49836.5390  40.2%  2562 1195s
H 3902  1615                    35613.564565 49836.5390  39.9%  2561 1205s
  3905  1617 45644.0622   12  387 35613.5646 49836.5390  39.9%  2559 1210s
  3906  1618 45142.4662   17  390 35613.5646 49836.5390  39.9%  2558 1216s
  3908  1619 48042.6466    5  389 35613.5646 49836.5390  39.9%  2557 1220s
  3909  1620 35613.5646   57  367 35613.5646 49836.5390  39.9%  2556 1225s
  3911  1621 48764.2216   13  382 35613.5646 49836.5390  39.9%  2555 1233s
  3912  1622 46553.1508   17  366 35613.5646 49836.5390  39.9%  2554 1235s
H 3912  1540                    35714.804014 49836.5390  39.5%  2554 1239s
H 3912  1463                    35785.274612 49836.5390  39.3%  2554 1239s
H 3912  1389                    35867.295112 49836.5390  38.9%  2554 1239s
H 3912  1319                    35891.124499 49836.5390  38.9%  2554 1242s
  3914  1320 38958.7993   23  378 35891.1245 49836.5390  38.9%  2553 1245s
  3915  1321 35891.1245   26  365 35891.1245 49836.5390  38.9%  2552 1251s
  3917  1322 44906.0101   25  378 35891.1245 49836.5390  38.9%  2551 1257s
  3918  1323 40855.3259   26  381 35891.1245 49836.5390  38.9%  2550 1266s
  3919  1324 49033.0330    8  434 35891.1245 49836.5390  38.9%  2550 1271s
  3921  1325 38503.4774   24  369 35891.1245 49836.5390  38.9%  2548 1278s
  3922  1326 44335.2584   31  368 35891.1245 49836.5390  38.9%  2548 1283s
  3923  1326 42919.4939   27  368 35891.1245 49836.5390  38.9%  2547 1325s
  3924  1327 47338.3198   12  368 35891.1245 49836.5390  38.9%  2546 1352s
  3925  1331 49836.5390   16  349 35891.1245 49836.5390  38.9%  2602 1371s
  3927  1334 49836.5390   17  378 35891.1245 49836.5390  38.9%  2603 1403s
  3931  1341 49836.5390   18  435 35891.1245 49836.5390  38.9%  2609 1425s
  3939  1354 49836.5390   19  434 35891.1245 49836.5390  38.9%  2619 1449s
  3955  1367 45337.2944   20  279 35891.1245 49836.5390  38.9%  2665 1488s
H 3973  1322                    35898.334072 49836.5390  38.8%  2701 1513s
  4005  1389 46596.6339   22  373 35898.3341 49836.5390  38.8%  2762 1544s
  4097  1382 44884.8939   26  305 35898.3341 49836.5390  38.8%  2840 1567s
  4133  1389 44059.0073   25  315 35898.3341 49836.5390  38.8%  2864 1588s
  4172  1399 44483.9956   24  359 35898.3341 49836.5390  38.8%  2888 1608s
  4209  1399 43796.8781   27  315 35898.3341 49836.5390  38.8%  2895 1628s
  4259  1393 43166.9121   27  258 35898.3341 49836.5390  38.8%  2895 1657s
  4317  1392 43130.3197   28  242 35898.3341 49836.5390  38.8%  2897 1673s
  4369  1410 42543.7894   29  204 35898.3341 49836.5390  38.8%  2905 1691s
  4434  1418 40640.6032   30  166 35898.3341 49836.5390  38.8%  2912 1711s
  4496  1437 41523.6580   29  279 35898.3341 49836.5390  38.8%  2921 1728s
  4563  1453 39839.8217   30  182 35898.3341 49836.5390  38.8%  2930 1744s
  4642  1455 40251.6527   31  153 35898.3341 49836.5390  38.8%  2926 1765s
  4730  1440 40115.9456   32  230 35898.3341 49836.5390  38.8%  2921 1785s
  4776  1452 39149.5600   33  164 35898.3341 48194.2314  34.3%  2929 1806s
  4826  1474 39000.5599   34  178 35898.3341 48194.2314  34.3%  2941 1821s
  4879  1494 38621.5523   35  132 35898.3341 48194.2314  34.3%  2951 1837s
  4936  1514     cutoff   35      35898.3341 47989.5137  33.7%  2957 1854s
  5015  1533 38010.4085   36  117 35898.3341 47989.5137  33.7%  2954 1872s
  5101  1547 37727.8452   37  224 35898.3341 47989.5137  33.7%  2946 1895s
  5202  1561 37626.0718   38  217 35898.3341 47989.5137  33.7%  2927 1915s
  5318  1566     cutoff   36      35898.3341 47989.5137  33.7%  2914 1934s
  5435  1574 37502.5680   40  149 35898.3341 47989.5137  33.7%  2899 1952s
H 5448  1507                    35909.138483 47989.5137  33.6%  2900 1952s
H 5527  1420                    36802.328428 47989.5137  30.4%  2895 1952s
  5550  1432 37403.6682   41  195 36802.3284 47989.5137  30.4%  2891 1973s
  5689  1407     cutoff   50      36802.3284 47989.5137  30.4%  2884 1996s
  5828  1391 44160.9864   25  313 36802.3284 47989.5137  30.4%  2881 2020s
  5947  1357 41878.1068   27  284 36802.3284 46806.2641  27.2%  2888 2047s
* 6050  1265             100    37330.297274 46806.2641  25.4%  2898 2047s
  6073  1285 40575.2377   29  267 37330.2973 46806.2641  25.4%  2899 2072s
  6178  1282 39231.8819   32  263 37330.2973 46806.2641  25.4%  2923 2095s
  6317  1261 41456.7905   25  286 37330.2973 45407.6757  21.6%  2930 2123s
  6466  1242 39291.7792   28  272 37330.2973 45407.6757  21.6%  2933 2150s
  6603  1244 37436.1922   31  267 37330.2973 45407.6757  21.6%  2948 2177s
  6760  1227 39664.2169   24  293 37330.2973 45050.9004  20.7%  2953 2205s
  6907  1210     cutoff   26      37330.2973 44228.7721  18.5%  2966 2237s
  7085  1178 39803.1666   26  293 37330.2973 44046.6535  18.0%  2971 2266s
  7252  1160 38322.6850   31  245 37330.2973 43880.0195  17.5%  2983 2296s
  7451  1206 37531.7438   25  269 37330.2973 43800.3979  17.3%  2989 2324s
  7630  1250 40291.9635   27  179 37330.2973 43656.0711  16.9%  3003 2358s
  7867  1254     cutoff   31      37330.2973 43570.1923  16.7%  3003 2391s
  8094  1260 37425.0803   32  124 37330.2973 43570.1923  16.7%  3000 2426s
  8286  1281     cutoff   31      37330.2973 42938.2637  15.0%  3009 2462s
  8511  1308     cutoff   26      37330.2973 42678.0535  14.3%  3018 2499s
H 8766  1320                    37372.514030 42597.3836  14.0%  3019 2534s
  8940  1349 38144.8406   29  166 37372.5140 42463.9958  13.6%  3024 2575s
  9244  1355     cutoff   27      37372.5140 42370.3113  13.4%  3016 2618s
  9536  1345 37816.0661   28  254 37372.5140 42051.7620  12.5%  3022 2660s
  9906  1389 37446.3140   29  247 37372.5140 41691.5244  11.6%  3008 2705s
 10263  1399 37588.4875   26  235 37372.5140 41557.0038  11.2%  3000 2752s
 10616  1407     cutoff   27      37372.5140 41308.4664  10.5%  2996 2788s
 10672  1421 37737.5993   26  199 37372.5140 41308.4664  10.5%  2999 2821s
H10675  1421                    37384.729896 41308.4664  10.5%  2999 2821s
H10707  1421                    37394.796706 41308.4664  10.5%  3000 2821s
 10724  1381     cutoff   27      37394.7967 41308.4664  10.5%  3000 2868s
 11149  1315 37551.3087   30  275 37394.7967 41230.3175  10.3%  2986 2921s
 11609  1229 37483.0386   25  307 37394.7967 40742.1450  8.95%  2969 2973s
 12086  1164     cutoff   28      37394.7967 40496.7767  8.30%  2950 3025s
 12501  1027     cutoff   29      37394.7967 40197.3325  7.49%  2930 3077s
 13021   702     cutoff   28      37394.7967 40063.0369  7.14%  2916 3142s
 13760   100 38488.4016   31  330 37394.7967 39550.5481  5.76%  2856 3188s
 14798    12     cutoff   38      37394.7967 38700.6147  3.49%  2705 3208s
 15136     5 37423.3544   57   24 37394.7967 37858.2790  1.24%  2650 3213s

Cutting planes:
  MIR: 497
  Flow cover: 1241
  RLT: 13
  Relax-and-lift: 158

Explored 15248 nodes (40345442 simplex iterations) in 3213.60 seconds (6084.24 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 37394.8 37384.7 37372.5 ... 35714.8

Optimal solution found (tolerance 1.00e-06)
Best objective 3.739479670648e+04, best bound 3.739479670648e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3213.67s
  Master Objective (UB) = 37394.80, θ = 186479.54
  Upper Bound (UB) = 37394.80

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 186479.54
  [DEBUG]   ✓ Scenario 0: θ = 186479.54 ≤ Q = 186479.54 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 186479.54 ≤ Q = 186479.54 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 186479.54 ≤ Q = 186479.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 186479.54 ≤ Q = 186479.54 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 186479.54 ≤ Q = 186479.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 186479.54 ≤ Q = 186479.54 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 186479.54 ≤ Q = 186479.54 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0xabe9d0e
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xf54162f2
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [2e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.390637e+13
Presolve removed 2601 rows and 1893 columns
Presolve time: 0.01s
Presolved: 492 rows, 496 columns, 1387 nonzeros
Found heuristic solution: objective 6751838.0462
Variable types: 336 continuous, 160 integer (160 binary)

Root relaxation: objective -1.649042e+05, 243 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -164904.22    0  125 6751838.05 -164904.22   102%     -    0s
H    0     0                    -130011.8908 -164904.22  26.8%     -    0s
H    0     0                    -130650.2462 -164904.22  26.2%     -    0s
     0     0 -145284.21    0   92 -130650.25 -145284.21  11.2%     -    0s
H    0     0                    -140517.5972 -145237.15  3.36%     -    0s
H    0     0                    -140629.7921 -145237.15  3.28%     -    0s
H    0     0                    -141418.6583 -145237.15  2.70%     -    0s
H    0     0                    -141530.8532 -145237.15  2.62%     -    0s
     0     0 -143848.57    0   91 -141530.85 -143848.57  1.64%     -    0s
H    0     0                    -141878.5031 -143842.62  1.38%     -    0s
     0     0 -143710.80    0   91 -141878.50 -143710.80  1.29%     -    0s
H    0     0                    -141901.8936 -143710.80  1.27%     -    0s
H    0     0                    -141908.7890 -143384.02  1.04%     -    0s
     0     0 -143384.02    0   51 -141908.79 -143384.02  1.04%     -    0s
     0     0 -143256.08    0   69 -141908.79 -143256.08  0.95%     -    0s
     0     0 -142967.21    0   63 -141908.79 -142967.21  0.75%     -    0s
     0     0 -142934.65    0   63 -141908.79 -142934.65  0.72%     -    0s
     0     0 -142777.72    0   60 -141908.79 -142777.72  0.61%     -    0s
     0     0 -142764.53    0   60 -141908.79 -142764.53  0.60%     -    0s
     0     2 -142764.53    0   60 -141908.79 -142764.53  0.60%     -    0s
H   95    59                    -141908.8353 -142318.51  0.29%  11.7    0s
H  386    78                    -141949.8883 -142265.59  0.22%   6.6    0s
*  473    35              26    -141993.0263 -142265.59  0.19%   6.2    0s

Cutting planes:
  Gomory: 32
  Implied bound: 11
  MIR: 150
  Flow cover: 16
  RLT: 49
  Relax-and-lift: 13

Explored 617 nodes (4215 simplex iterations) in 0.21 seconds (0.08 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -141993 -141950 -141909 ... -130012
No other solutions better than -141993

Optimal solution found (tolerance 1.00e-06)
Best objective -1.419930263083e+05, best bound -1.419930263083e+05, gap 0.0000%
  Subproblem solved in 0.24s
  Worst-case operational profit (Z_SP) = 177544.55
  Scenario: 41 demand increases, 19 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -141993.03
  [DEBUG]   S×d_nominal = 319537.58
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 319537.58 + -141993.03 = 177544.55
  [DEBUG]   Current θ from Master = 186479.54
  [DEBUG]   ⚠️  Z_SP ≤ θ by 8934.99 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 28459.81
  Lower Bound (LB) = 28468.08
  Gap (UB-LB) = 8926.7121, Absolute Gap = 8926.7121, Relative Gap = 0.238715
  Not converged yet (gap = 8926.71 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 41 increases, 19 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351367 nonzeros
Model fingerprint: 0x3394e048
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 56560 rows and 22960 columns
Presolve time: 2.02s
Presolved: 67143 rows, 29220 columns, 417599 nonzeros
Variable types: 26961 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -335473.7764
Found heuristic solution: objective -170353.9630

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 67143 rows, 29220 columns, 417599 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   24743   -1.2855537e+05   0.000000e+00   4.415561e+08      5s
   36877    1.3497644e+04   0.000000e+00   1.098695e+09     10s
   46868    3.1017172e+04   0.000000e+00   8.834713e+06     15s
   56306    4.1506052e+04   0.000000e+00   2.354024e+07     20s
   62761    4.3985504e+04   0.000000e+00   4.291848e+07     25s
   70138    4.7368434e+04   0.000000e+00   3.072017e+07     30s
   76187    4.8869934e+04   0.000000e+00   3.872544e+08     35s
   84051    5.6971849e+04   0.000000e+00   1.637907e+08     40s
   90766    5.8573540e+04   0.000000e+00   1.422955e+07     45s
Concurrent spin time: 14.91s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 6.447592e+04, 77008 iterations, 59.75 seconds (71.78 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 64475.9169    0  134 -170353.96 64475.9169   138%     -   62s
H    0     0                    -157479.9374 64475.9169   141%     -   62s
H    0     0                    -143581.7816 64475.9169   145%     -   62s
H    0     0                    -143481.9844 64475.9169   145%     -   62s
H    0     0                    -118144.7406 64475.9169   155%     -   62s
H    0     0                    -117828.5125 64475.9169   155%     -   63s
H    0     0                    -117660.2866 64475.9169   155%     -   63s
H    0     0                    -117398.2978 64475.9169   155%     -   63s
H    0     0                    -32815.30939 64475.9169   296%     -   63s
H    0     0                    -1557.128381 64475.9169  4241%     -   63s
H    0     0                    6294.2221254 64475.9169   924%     -   63s
H    0     0                    7184.6228772 64475.9169   797%     -   63s
H    0     0                    12804.956113 64475.9169   404%     -   63s
H    0     0                    13622.392196 64475.9169   373%     -   63s
H    0     0                    13633.969522 64475.9169   373%     -   63s
H    0     0                    13659.246758 64475.9169   372%     -   63s
H    0     0                    14660.818074 64475.9169   340%     -   63s
H    0     0                    14664.299714 64475.9169   340%     -   63s
H    0     0                    14708.914967 64475.9169   338%     -   63s
     0     0 59641.1953    0  191 14708.9150 59641.1953   305%     -   78s
     0     0 59207.6292    0  183 14708.9150 59207.6292   303%     -   85s
     0     0 59136.3699    0  191 14708.9150 59136.3699   302%     -   87s
     0     0 59091.3155    0  195 14708.9150 59091.3155   302%     -   88s
     0     0 58946.1662    0  198 14708.9150 58946.1662   301%     -   92s
     0     0 58901.4168    0  203 14708.9150 58901.4168   300%     -   95s
     0     0 58896.9843    0  208 14708.9150 58896.9843   300%     -   95s
     0     0 58896.4149    0  210 14708.9150 58896.4149   300%     -   96s
     0     0 58894.9981    0  208 14708.9150 58894.9981   300%     -   96s
     0     0 58894.7192    0  202 14708.9150 58894.7192   300%     -   96s
     0     0 56499.2242    0  240 14708.9150 56499.2242   284%     -  112s
H    0     0                    15712.233186 56499.2242   260%     -  113s
     0     0 56234.5888    0  255 15712.2332 56234.5888   258%     -  119s
     0     0 55935.8134    0  280 15712.2332 55935.8134   256%     -  125s
     0     0 55835.1007    0  288 15712.2332 55835.1007   255%     -  129s
H    0     0                    16771.667632 55799.0554   233%     -  130s
H    0     0                    16827.142937 55799.0554   232%     -  130s
H    0     0                    16875.787240 55799.0554   231%     -  130s
     0     0 55799.0554    0  294 16875.7872 55799.0554   231%     -  130s
     0     0 55784.6034    0  286 16875.7872 55784.6034   231%     -  131s
     0     0 55779.7303    0  288 16875.7872 55779.7303   231%     -  131s
     0     0 55765.9447    0  289 16875.7872 55765.9447   230%     -  132s
     0     0 55758.0428    0  290 16875.7872 55758.0428   230%     -  134s
     0     0 55755.5235    0  291 16875.7872 55755.5235   230%     -  135s
     0     0 55754.0947    0  292 16875.7872 55754.0947   230%     -  135s
     0     0 55753.8333    0  294 16875.7872 55753.8333   230%     -  135s
H    0     0                    19825.080696 54573.2250   175%     -  163s
H    0     0                    19912.982527 54573.2250   174%     -  163s
     0     0 54573.2250    0  315 19912.9825 54573.2250   174%     -  163s
H    0     0                    19916.855985 54573.0224   174%     -  164s
H    0     0                    19942.514944 54573.0224   174%     -  164s
H    0     0                    19962.423268 54573.0224   173%     -  164s
H    0     0                    19986.489473 54573.0224   173%     -  164s
H    0     0                    20028.589616 54573.0224   172%     -  164s
H    0     0                    20058.122032 54573.0224   172%     -  164s
H    0     0                    21626.118260 53934.9172   149%     -  177s
H    0     0                    25002.632343 53934.9172   116%     -  177s
H    0     0                    25019.976285 53934.9172   116%     -  177s
     0     0 53934.9172    0  331 25019.9763 53934.9172   116%     -  177s
     0     0 53755.5099    0  332 25019.9763 53755.5099   115%     -  184s
     0     0 53669.0735    0  335 25019.9763 53669.0735   115%     -  190s
     0     0 53637.5903    0  338 25019.9763 53637.5903   114%     -  195s
     0     0 53595.1646    0  369 25019.9763 53595.1646   114%     -  200s
H    0     0                    25622.230723 53565.1411   109%     -  204s
H    0     0                    25698.282815 53565.1411   108%     -  204s
H    0     0                    26024.123481 53565.1411   106%     -  204s
H    0     0                    26193.360358 53565.1411   104%     -  204s
H    0     0                    26332.988324 53565.1411   103%     -  204s
H    0     0                    26462.367440 53565.1411   102%     -  204s
H    0     0                    26482.930016 53565.1411   102%     -  204s
H    0     0                    26560.069053 53565.1411   102%     -  204s
     0     0 53565.1411    0  337 26560.0691 53565.1411   102%     -  204s
     0     0 53550.4871    0  337 26560.0691 53550.4871   102%     -  206s
H    0     0                    27429.648398 53522.6636  95.1%     -  208s
H    0     0                    27478.660294 53522.6636  94.8%     -  208s
     0     0 53522.6636    0  366 27478.6603 53522.6636  94.8%     -  208s
     0     0 53488.7430    0  375 27478.6603 53488.7430  94.7%     -  210s
     0     0 53480.0219    0  342 27478.6603 53480.0219  94.6%     -  211s
     0     0 53477.3041    0  344 27478.6603 53477.3041  94.6%     -  213s
     0     0 53476.5337    0  343 27478.6603 53476.5337  94.6%     -  214s
     0     0 52935.9257    0  353 27478.6603 52935.9257  92.6%     -  237s
     0     0 52813.3826    0  359 27478.6603 52813.3826  92.2%     -  241s
H    0     0                    28456.403749 52752.4096  85.4%     -  246s
     0     0 52752.4096    0  370 28456.4037 52752.4096  85.4%     -  246s
     0     0 52716.4206    0  369 28456.4037 52716.4206  85.3%     -  249s
     0     0 52698.4910    0  359 28456.4037 52698.4910  85.2%     -  252s
     0     0 52688.1355    0  365 28456.4037 52688.1355  85.2%     -  254s
     0     0 52683.5171    0  369 28456.4037 52683.5171  85.1%     -  255s
     0     0 52677.2331    0  365 28456.4037 52677.2331  85.1%     -  256s
     0     0 52675.4950    0  364 28456.4037 52675.4950  85.1%     -  257s
     0     0 52665.7314    0  370 28456.4037 52665.7314  85.1%     -  259s
     0     0 52664.5096    0  369 28456.4037 52664.5096  85.1%     -  260s
H    0     0                    28473.625691 52518.4055  84.4%     -  265s
H    0     0                    28679.442908 52518.4055  83.1%     -  265s
H    0     0                    28751.461908 52518.4055  82.7%     -  265s
H    0     0                    28811.065957 52518.4055  82.3%     -  265s
H    0     0                    28883.084957 52518.4055  81.8%     -  265s
     0     0 52518.4055    0  365 28883.0850 52518.4055  81.8%     -  265s
H    0     0                    28983.568796 52515.8448  81.2%     -  266s
     0     0 52439.8356    0  376 28983.5688 52439.8356  80.9%     -  270s
     0     0 52418.4435    0  376 28983.5688 52418.4435  80.9%     -  272s
     0     0 52413.3406    0  377 28983.5688 52413.3406  80.8%     -  274s
     0     0 52399.1572    0  384 28983.5688 52399.1572  80.8%     -  276s
     0     0 52396.7602    0  381 28983.5688 52396.7602  80.8%     -  277s
     0     0 52395.1710    0  414 28983.5688 52395.1710  80.8%     -  279s
     0     0 52393.6837    0  420 28983.5688 52393.6837  80.8%     -  280s
     0     0 52393.2842    0  417 28983.5688 52393.2842  80.8%     -  281s
     0     0 52332.0477    0  380 28983.5688 52332.0477  80.6%     -  285s
H    0     0                    29563.059989 52330.9627  77.0%     -  289s
     0     0 52325.6147    0  379 29563.0600 52325.6147  77.0%     -  291s
     0     0 52313.7145    0  379 29563.0600 52313.7145  77.0%     -  292s
     0     0 52307.1158    0  380 29563.0600 52307.1158  76.9%     -  294s
     0     0 52302.0862    0  383 29563.0600 52302.0862  76.9%     -  295s
     0     0 52299.3103    0  379 29563.0600 52299.3103  76.9%     -  296s
     0     0 52298.2807    0  379 29563.0600 52298.2807  76.9%     -  297s
     0     0 52281.9337    0  377 29563.0600 52281.9337  76.8%     -  299s
H    0     0                    29635.078989 52281.7684  76.4%     -  300s
     0     0 52276.3263    0  388 29635.0790 52276.3263  76.4%     -  301s
     0     0 52272.4019    0  385 29635.0790 52272.4019  76.4%     -  302s
     0     0 52266.8689    0  381 29635.0790 52266.8689  76.4%     -  303s
     0     0 52264.4315    0  381 29635.0790 52264.4315  76.4%     -  304s
     0     0 52263.0161    0  382 29635.0790 52263.0161  76.4%     -  305s
     0     0 52251.9137    0  383 29635.0790 52251.9137  76.3%     -  307s
     0     0 52247.4122    0  382 29635.0790 52247.4122  76.3%     -  312s
     0     0 52244.3185    0  389 29635.0790 52244.3185  76.3%     -  313s
     0     0 52242.9651    0  420 29635.0790 52242.9651  76.3%     -  313s
     0     0 52229.1748    0  408 29635.0790 52229.1748  76.2%     -  316s
     0     0 52222.6631    0  380 29635.0790 52222.6631  76.2%     -  318s
     0     0 52221.6289    0  414 29635.0790 52221.6289  76.2%     -  319s
     0     0 52216.2002    0  370 29635.0790 52216.2002  76.2%     -  321s
     0     0 52215.0491    0  372 29635.0790 52215.0491  76.2%     -  333s
     0     0 52202.4969    0  373 29635.0790 52202.4969  76.2%     -  336s
     0     0 52201.7743    0  376 29635.0790 52201.7743  76.1%     -  337s
     0     0 52198.6959    0  378 29635.0790 52198.6959  76.1%     -  339s
     0     0 52198.6949    0  378 29635.0790 52198.6949  76.1%     -  340s
     0     2 52198.6949    0  378 29635.0790 52198.6949  76.1%     -  398s
     1     4 52177.5987    1  375 29635.0790 52198.6949  76.1%  2491  406s
     3     8 52012.1780    2  365 29635.0790 52174.9306  76.1%  5207  419s
     7    16 51688.6100    3  363 29635.0790 52012.0709  75.5%  8527  428s
    15    32 51082.9267    4  358 29635.0790 51936.4720  75.3%  8381  446s
    31    48 50178.8464    5  369 29635.0790 51209.1078  72.8% 14078  474s
    47    80 49940.3002    6  365 29635.0790 51209.1078  72.8% 12225  494s
H   49    80                    29806.849844 51209.1078  71.8% 11835  494s
H   51    80                    29916.788325 51209.1078  71.2% 11594  494s
H   57    80                    29940.977250 51209.1078  71.0% 11298  494s
H   72    80                    29974.246646 51209.1078  70.8% 10055  494s
H   74    80                    30293.381985 51209.1078  69.0%  9986  494s
    79   144 49836.8475    7  387 30293.3820 51209.1078  69.0%  9610  545s
H  143   294                    30421.014043 51209.1078  68.3%  6718  566s
H  148   294                    30542.118568 51209.1078  67.7%  6552  566s
H  158   294                    30559.582672 51209.1078  67.6%  6249  566s
H  178   294                    30890.398135 51209.1078  65.8%  5756  566s
   293   382 49277.0038   14  341 30890.3981 51209.1078  65.8%  4326  581s
   381   458 49108.4679   14  331 30890.3981 51209.1078  65.8%  3888  595s
H  382   458                    30963.361070 51209.1078  65.4%  3877  595s
H  396   458                    30993.943755 51209.1078  65.2%  3883  595s
H  402   458                    31058.815563 51209.1078  64.9%  3877  595s
   457   517 48429.2842   12  331 31058.8156 51209.1078  64.9%  3702  609s
   518   579 48964.0673   13  334 31058.8156 51209.1078  64.9%  3618  624s
   580   651 49004.7657   15  329 31058.8156 51209.1078  64.9%  3499  639s
   653   716 46011.7223   25  208 31058.8156 51209.1078  64.9%  3392  652s
   726   788 46831.4751   16  300 31058.8156 51209.1078  64.9%  3285  664s
   809   860 46023.3086   16  282 31058.8156 51209.1078  64.9%  3160  677s
   907   886 46353.8199   16  295 31058.8156 51209.1078  64.9%  2999  690s
   943   914 46673.8874   17  306 31058.8156 51209.1078  64.9%  2978  704s
H  970   914                    31128.878279 51209.1078  64.5%  3011  704s
   989   985 43606.2998   17  264 31128.8783 51209.1078  64.5%  2985  718s
H  997   985                    31139.537000 51209.1078  64.5%  2970  718s
  1078  1063 44487.6083   18  286 31139.5370 51209.1078  64.5%  2930  733s
  1176  1129 44389.2318   19  273 31139.5370 51209.1078  64.5%  2847  748s
  1280  1160 43640.5407   21  258 31139.5370 51209.1078  64.5%  2795  761s
H 1313  1189                    31588.236815 51209.1078  62.1%  2813  774s
  1366  1212 43338.0178   20  234 31588.2368 51209.1078  62.1%  2822  788s
H 1370  1212                    31658.362658 51209.1078  61.8%  2822  788s
H 1374  1212                    31733.800589 51209.1078  61.4%  2817  788s
  1405  1328 43571.8838   23  247 31733.8006 51209.1078  61.4%  2817  804s
  1529  1357 43193.1444   27  223 31733.8006 51209.1078  61.4%  2743  814s
H 1537  1357                    31889.552488 51209.1078  60.6%  2738  814s
H 1538  1357                    32241.966075 51209.1078  58.8%  2737  814s
  1564  1455 43172.0336   28  182 32241.9661 51209.1078  58.8%  2729  830s
  1725  1482 42645.7287   36  158 32241.9661 51209.1078  58.8%  2620  841s
H 1734  1482                    32280.701450 51209.1078  58.6%  2629  841s
H 1749  1482                    33101.090457 51082.7237  54.3%  2628  841s
  1762  1533 42940.8728   36  182 33101.0905 51082.7237  54.3%  2634  860s
  1879  1614 42587.0318   37  156 33101.0905 51082.7237  54.3%  2621  881s
  1992  1709 38680.9647   38  150 33101.0905 51082.7237  54.3%  2627  902s
  2131  1824 40839.3919   39  134 33101.0905 51082.7237  54.3%  2603  919s
  2282  1849 39313.5354   41  174 33101.0905 50967.2836  54.0%  2570  938s
  2438  1925 38498.5726   42  234 33101.0905 50885.2119  53.7%  2548  958s
  2608  2023 infeasible   43      33101.0905 50885.2119  53.7%  2526  983s
H 2768  2081                    33233.611273 50885.2119  53.1%  2508 1007s
H 2779  2076                    33274.439062 50885.2119  52.9%  2514 1007s
H 2797  2073                    33291.773653 50885.2119  52.8%  2500 1007s
  2867  2178     cutoff   46      33291.7737 50885.2119  52.8%  2503 1030s
  3024  2307 46024.1615   13  318 33291.7737 50885.2119  52.8%  2494 1054s
  3185  2454 46562.3883   13  292 33291.7737 50885.2119  52.8%  2495 1078s
  3392  2584 41899.3974   15  244 33291.7737 50885.2119  52.8%  2458 1105s
H 3614  2569                    33641.480968 49489.9008  47.1%  2420 1124s
H 3622  2532                    33836.524281 49489.9008  46.3%  2421 1124s
H 3651  2530                    33861.409825 49489.9008  46.2%  2437 1124s
H 3652  2504                    33960.731639 49489.9008  45.7%  2438 1124s
  3658  2527 40951.4618   16  237 33960.7316 49489.9008  45.7%  2443 1142s
H 3675  2452                    34201.524699 49489.9008  44.7%  2450 1142s
  3699  2546 37296.0976   17  227 34201.5247 49489.9008  44.7%  2462 1169s
H 3857  2534                    34259.000561 49489.9008  44.5%  2486 1215s
H 3857  2512                    34362.169952 49489.9008  44.0%  2486 1281s
  3858  2511 34864.4798   64  378 34362.1700 49489.9008  44.0%  2485 1371s
  3860  2512 45478.8960   10  134 34362.1700 49489.9008  44.0%  2484 1418s
  3861  2513 36273.0884   23  291 34362.1700 49489.9008  44.0%  2483 1462s
  3862  2514 39821.4788   38  312 34362.1700 49489.9008  44.0%  2483 1480s
  3863  2514 39354.4019   37  358 34362.1700 49489.9008  44.0%  2482 1495s
  3864  2515 37922.4384   21  336 34362.1700 49489.9008  44.0%  2481 1508s
  3865  2516 35878.5326   29  365 34362.1700 49489.9008  44.0%  2481 1515s
  3866  2516 45765.1920    9  362 34362.1700 49489.9008  44.0%  2480 1522s
  3867  2517 36845.1568   24  370 34362.1700 49489.9008  44.0%  2479 1527s
  3868  2518 43525.7185   19  369 34362.1700 49489.9008  44.0%  2479 1533s
  3869  2518 34796.5131   77  367 34362.1700 49489.9008  44.0%  2478 1536s
  3870  2519 45685.3079   13  370 34362.1700 49489.9008  44.0%  2478 1541s
  3872  2520 44743.2349   13  366 34362.1700 49489.9008  44.0%  2476 1548s
  3873  2521 35081.3564   25  415 34362.1700 49489.9008  44.0%  2476 1556s
  3875  2522 46720.0505   19  381 34362.1700 49489.9008  44.0%  2474 1563s
  3876  2523 35948.0363   29  388 34362.1700 49489.9008  44.0%  2474 1572s
  3878  2524 39549.5269   22  378 34362.1700 49489.9008  44.0%  2472 1577s
  3879  2525 47958.6658   17  370 34362.1700 49489.9008  44.0%  2472 1584s
  3880  2526 39742.7528   37  389 34362.1700 49489.9008  44.0%  2471 1589s
  3881  2526 39048.5856   39  380 34362.1700 49489.9008  44.0%  2471 1595s
  3883  2528 40185.9911   15  402 34362.1700 49489.9008  44.0%  2469 1609s
  3884  2528 45112.6832    9  411 34362.1700 49489.9008  44.0%  2469 1613s
  3885  2529 36684.8206   44  398 34362.1700 49489.9008  44.0%  2468 1617s
  3886  2530 44366.1885   13  434 34362.1700 49489.9008  44.0%  2467 1624s
  3887  2530 35766.9360   58  442 34362.1700 49489.9008  44.0%  2467 1629s
  3888  2531 48627.9721    9  374 34362.1700 49489.9008  44.0%  2466 1638s
  3889  2532 48353.8438   12  393 34362.1700 49489.9008  44.0%  2465 1641s
H 3889  2404                    34427.987594 49489.9008  43.7%  2465 1649s
  3890  2404 37155.8639   31  419 34427.9876 49489.9008  43.7%  2465 1652s
  3891  2405 43357.4404   20  374 34427.9876 49489.9008  43.7%  2464 1655s
  3893  2406 43830.7269   28  374 34427.9876 49489.9008  43.7%  2463 1666s
  3894  2407 45243.6239   13  374 34427.9876 49489.9008  43.7%  2462 1707s
  3895  2408 43091.1024   30  374 34427.9876 49489.9008  43.7%  2462 1758s
  3896  2411 49489.9008   11  353 34427.9876 49489.9008  43.7%  2524 1853s
  3898  2415 49489.9008   12  349 34427.9876 49489.9008  43.7%  2525 1877s
  3902  2421 49489.9008   13  357 34427.9876 49489.9008  43.7%  2529 1907s
  3910  2435 49489.9008   14  360 34427.9876 49489.9008  43.7%  2547 1937s
  3926  2445 48559.7032   15  358 34427.9876 49489.9008  43.7%  2595 2126s
  3942  2472 46793.0373   16  266 34427.9876 49489.9008  43.7%  2669 2159s
H 3951  2348                    34471.361675 49489.9008  43.6%  2688 2159s
  3974  2476 46741.7746   17  266 34471.3617 49489.9008  43.6%  2741 2193s
  4110  2492 44098.3807   21  268 34471.3617 49489.9008  43.6%  2823 2215s
  4173  2495 45165.0814   20  237 34471.3617 49489.9008  43.6%  2855 2236s
  4205  2513 42457.4205   22  253 34471.3617 49489.9008  43.6%  2884 2253s
H 4214  2395                    34479.482918 49489.9008  43.5%  2887 2253s
  4238  2429 42883.5805   22  249 34479.4829 49489.9008  43.5%  2916 2280s
  4308  2416 41803.4912   22  271 34479.4829 49489.9008  43.5%  2950 2299s
  4345  2428 42066.8424   23  241 34479.4829 49489.9008  43.5%  2967 2324s
H 4356  2315                    34731.992501 49489.9008  42.5%  2970 2324s
  4389  2339 41596.9474   24  211 34731.9925 49489.9008  42.5%  2978 2342s
  4467  2337 40751.8405   26  191 34731.9925 49489.9008  42.5%  2989 2362s
  4542  2325 39882.2391   29  166 34731.9925 49489.9008  42.5%  2999 2378s
H 4614  2198                    35430.773870 49489.9008  39.7%  3003 2395s
  4650  2180 37293.6814   30  175 35430.7739 49489.9008  39.7%  3011 2420s
  4706  2161     cutoff   31      35430.7739 49489.9008  39.7%  3020 2440s
  4762  2155 43735.9196   17  310 35430.7739 49489.9008  39.7%  3041 2465s
  4809  2155 40735.6036   18  283 35430.7739 49489.9008  39.7%  3060 2487s
  4859  2157 39905.5197   19  276 35430.7739 49489.9008  39.7%  3083 2506s
H 4874  2054                    35496.862172 49489.9008  39.4%  3096 2506s
  4897  2069 39826.9085   20  272 35496.8622 49489.9008  39.4%  3106 2526s
  4934  2103 39469.8605   21  309 35496.8622 49489.9008  39.4%  3131 2552s
H 4961  2000                    35715.468966 49489.9008  38.6%  3137 2552s
  4990  2024 38905.5151   22  304 35715.4690 49489.9008  38.6%  3146 2577s
  5053  2052 38532.1250   24  307 35715.4690 49489.9008  38.6%  3166 2598s
  5137  2056 37608.0176   27  320 35715.4690 49148.6693  37.6%  3181 2621s
  5226  2084 37216.5287   29  306 35715.4690 49148.6693  37.6%  3192 2654s
  5333  2080     cutoff   32      35715.4690 49148.6693  37.6%  3194 2680s
  5457  2058 infeasible   31      35715.4690 48228.9285  35.0%  3186 2701s
H 5467  1966                    35724.224390 48228.9285  35.0%  3192 2701s
H 5468  1881                    36667.418660 48228.9285  31.5%  3192 2701s
  5495  1897 45969.5084   16  388 36667.4187 48228.9285  31.5%  3210 2732s
  5599  1889 44734.3356   18  341 36667.4187 48109.7766  31.2%  3222 2756s
H 5611  1804                    37316.811355 48109.7766  28.9%  3228 2756s
  5645  1822 43631.7983   19  299 37316.8114 48109.7766  28.9%  3237 2789s
  5739  1843 42599.6675   21  272 37316.8114 48109.7766  28.9%  3259 2818s
  5823  1847 41658.9761   23  277 37316.8114 48109.7766  28.9%  3288 2848s
  5928  1828 40559.5371   27  231 37316.8114 48109.7766  28.9%  3311 2876s
  6023  1813 40371.8449   29  141 37316.8114 47214.5223  26.5%  3311 2908s
  6138  1812 infeasible   37      37316.8114 47165.1709  26.4%  3318 2941s
  6254  1822 43931.6787   21  270 37316.8114 47165.1709  26.4%  3344 2973s
  6383  1842 41722.1995   24  190 37316.8114 46885.3827  25.6%  3372 3016s
  6509  1859 39057.1373   27  247 37316.8114 46250.3438  23.9%  3396 3052s
  6652  1861     cutoff   30      37316.8114 45983.4321  23.2%  3415 3090s
  6811  1852     cutoff   32      37316.8114 45824.1245  22.8%  3435 3129s
  6967  1813 39821.2624   19  201 37316.8114 45697.3134  22.5%  3459 3163s
H 6982  1732                    37318.811207 45697.3134  22.5%  3462 3163s
  7015  1772 39348.0564   20  202 37318.8112 45697.3134  22.5%  3476 3199s
  7115  1806     cutoff   27      37318.8112 45589.5578  22.2%  3485 3239s
  7274  1805 40323.8563   23  218 37318.8112 45589.5578  22.2%  3499 3284s
  7448  1794 37652.3843   26  208 37318.8112 45224.3691  21.2%  3530 3333s
  7619  1773 37340.2958   27  278 37318.8112 45095.3789  20.8%  3568 3388s
  7798  1782 39500.5604   25  182 37318.8112 44982.4640  20.5%  3606 3437s
  8003  1750 37357.7361   31  154 37318.8112 44964.9057  20.5%  3637 3492s
  8203  1711 38049.7515   25  224 37318.8112 44719.5953  19.8%  3670 3544s
  8402  1722 38440.8470   23  283 37318.8112 44655.3468  19.7%  3711 3593s
  8543  1700 infeasible   28      37318.8112 44655.3468  19.7%  3732 3600s

Cutting planes:
  Learned: 1
  MIR: 642
  Flow cover: 1425
  RLT: 31
  Relax-and-lift: 168

Explored 8568 nodes (32234716 simplex iterations) in 3600.03 seconds (6373.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 37318.8 37316.8 36667.4 ... 34471.4

Time limit reached
Best objective 3.731881120702e+04, best bound 4.465534676287e+04, gap 19.6591%
  WARNING: Time limit reached. Using best solution found (gap: 19.66%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.04s
  Master Objective (UB) = 37318.81, θ = 189834.76
  Upper Bound (UB) = 37318.81

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 189834.76
  [DEBUG]   ✓ Scenario 0: θ = 189834.76 ≤ Q = 189834.76 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 189834.76 ≤ Q = 189834.76 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 189834.76 ≤ Q = 189834.76 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 189834.76 ≤ Q = 189834.76 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 189834.76 ≤ Q = 189834.76 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 189834.76 ≤ Q = 189834.76 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 189834.76 ≤ Q = 189834.76 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 189834.76 ≤ Q = 189834.76 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x7e8ee13a
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x7e8ee13a
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.389622e+13
Presolve removed 2600 rows and 1892 columns
Presolve time: 0.01s
Presolved: 493 rows, 497 columns, 1390 nonzeros
Found heuristic solution: objective 6894116.2731
Variable types: 337 continuous, 160 integer (160 binary)

Root relaxation: objective -1.584988e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -158498.78    0  125 6894116.27 -158498.78   102%     -    0s
H    0     0                    -122300.3071 -158498.78  29.6%     -    0s
H    0     0                    -123059.3070 -158498.78  28.8%     -    0s
H    0     0                    -123682.8764 -158498.78  28.1%     -    0s
H    0     0                    -124592.6308 -137796.41  10.6%     -    0s
H    0     0                    -134666.3119 -137796.41  2.32%     -    0s
     0     0 -137796.41    0   85 -134666.31 -137796.41  2.32%     -    0s
     0     0 -137168.10    0   86 -134666.31 -137168.10  1.86%     -    0s
     0     0 -136443.73    0   73 -134666.31 -136443.73  1.32%     -    0s
H    0     0                    -135043.6089 -136362.16  0.98%     -    0s
H    0     0                    -135427.5656 -136362.16  0.69%     -    0s
     0     0 -136362.16    0   69 -135427.57 -136362.16  0.69%     -    0s
     0     0 -136362.16    0   69 -135427.57 -136362.16  0.69%     -    0s
     0     0 -136009.52    0   62 -135427.57 -136009.52  0.43%     -    0s
     0     0 -135970.85    0   61 -135427.57 -135970.85  0.40%     -    0s
     0     0 -135950.06    0   59 -135427.57 -135950.06  0.39%     -    0s
     0     0 -135949.41    0   59 -135427.57 -135949.41  0.39%     -    0s
     0     0 -135660.32    0   31 -135427.57 -135660.32  0.17%     -    0s
     0     0 -135593.41    0   35 -135427.57 -135593.41  0.12%     -    0s
     0     0 -135592.21    0   35 -135427.57 -135592.21  0.12%     -    0s
     0     0 -135590.28    0   35 -135427.57 -135590.28  0.12%     -    0s
     0     0 -135590.28    0   35 -135427.57 -135590.28  0.12%     -    0s
     0     0 -135556.34    0   19 -135427.57 -135556.34  0.10%     -    0s
     0     0 -135556.34    0   39 -135427.57 -135556.34  0.10%     -    0s
     0     0 -135556.34    0   39 -135427.57 -135556.34  0.10%     -    0s
     0     0 -135556.34    0   21 -135427.57 -135556.34  0.10%     -    0s
H    0     0                    -135479.1195 -135556.34  0.06%     -    0s
     0     0 -135524.23    0   10 -135479.12 -135524.23  0.03%     -    0s
     0     0 -135510.91    0    6 -135479.12 -135510.91  0.02%     -    0s
     0     0 -135501.12    0    4 -135479.12 -135501.12  0.02%     -    0s
     0     0 -135498.00    0    2 -135479.12 -135498.00  0.01%     -    0s
     0     0 -135494.87    0    2 -135479.12 -135494.87  0.01%     -    0s
     0     0 -135494.87    0    3 -135479.12 -135494.87  0.01%     -    0s
H    0     0                    -135481.6530 -135494.87  0.01%     -    0s
H    0     0                    -135490.4856 -135494.87  0.00%     -    0s
H    0     0                    -135492.3623 -135494.87  0.00%     -    0s
*    0     0               0    -135493.0190 -135493.02  0.00%     -    0s

Cutting planes:
  MIR: 1
  Flow cover: 1

Explored 1 nodes (878 simplex iterations) in 0.12 seconds (0.06 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -135493 -135492 -135490 ... -134666
No other solutions better than -135493

Optimal solution found (tolerance 1.00e-06)
Best objective -1.354930189996e+05, best bound -1.354930189996e+05, gap 0.0000%
  Subproblem solved in 0.15s
  Worst-case operational profit (Z_SP) = 178959.37
  Scenario: 39 demand increases, 21 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -135493.02
  [DEBUG]   S×d_nominal = 314452.38
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 314452.38 + -135493.02 = 178959.37
  [DEBUG]   Current θ from Master = 189834.76
  [DEBUG]   ⚠️  Z_SP ≤ θ by 10875.40 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 26443.42
  Lower Bound (LB) = 28468.08
  Gap (UB-LB) = 8850.7266, Absolute Gap = 8850.7266, Relative Gap = 0.237165
  Not converged yet (gap = 8850.73 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 39 increases, 21 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394598 nonzeros
Model fingerprint: 0x7151efba
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 63630 rows and 25830 columns
Presolve time: 2.42s
Presolved: 75363 rows, 32590 columns, 469109 nonzeros
Variable types: 30331 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -335473.7764
Found heuristic solution: objective -170353.9630

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 75363 rows, 32590 columns, 469109 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   22484   -1.9407721e+05   0.000000e+00   4.092134e+06      5s
   38461   -2.6412159e+04   0.000000e+00   1.383464e+07     10s
   48778    1.7347102e+04   0.000000e+00   1.588153e+07     15s
   56585    3.0221950e+04   0.000000e+00   8.733053e+06     20s
   64284    3.9691455e+04   0.000000e+00   6.127211e+06     25s
   69682    4.1016223e+04   0.000000e+00   7.590631e+07     30s
   76366    4.3684345e+04   0.000000e+00   1.284350e+07     35s
   83803    4.6596512e+04   0.000000e+00   1.714140e+07     40s
   90534    4.9430073e+04   0.000000e+00   1.059256e+08     45s
   97147    5.2060432e+04   0.000000e+00   5.934372e+06     50s
  103450    5.3169369e+04   0.000000e+00   5.926036e+06     55s
  109492    5.3377328e+04   0.000000e+00   6.133682e+05     60s
  115221    5.4590615e+04   0.000000e+00   3.020187e+07     65s
Concurrent spin time: 20.11s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 6.444574e+04, 84252 iterations, 83.27 seconds (97.37 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 64445.7377    0  136 -170353.96 64445.7377   138%     -   86s
H    0     0                    -158696.2603 64445.7377   141%     -   86s
H    0     0                    -149023.0135 64445.7377   143%     -   87s
H    0     0                    -148923.2163 64445.7377   143%     -   87s
H    0     0                    -148835.6980 64445.7377   143%     -   87s
H    0     0                    -98491.99094 64445.7377   165%     -   87s
H    0     0                    -98033.59455 64445.7377   166%     -   87s
H    0     0                    -96533.51082 64445.7377   167%     -   87s
H    0     0                    -96514.46473 64445.7377   167%     -   87s
H    0     0                    -96309.68660 64445.7377   167%     -   87s
H    0     0                    -32815.30939 64445.7377   296%     -   87s
H    0     0                    -1557.128381 64445.7377  4239%     -   87s
H    0     0                    -292.2979611 64445.7377      -     -   87s
H    0     0                    1111.8539189 64445.7377  5696%     -   88s
H    0     0                    4909.8084150 64445.7377  1213%     -   88s
H    0     0                    8639.5042640 64445.7377   646%     -   88s
H    0     0                    9185.8959544 64445.7377   602%     -   88s
H    0     0                    9574.2225076 64445.7377   573%     -   88s
H    0     0                    13741.492697 64445.7377   369%     -   88s
H    0     0                    14858.820990 64445.7377   334%     -   90s
H    0     0                    15665.044859 64445.7377   311%     -   92s
H    0     0                    17484.446502 64445.7377   269%     -   92s
H    0     0                    17583.854576 64445.7377   267%     -   92s
     0     0 59157.3224    0  193 17583.8546 59157.3224   236%     -  116s
H    0     0                    19496.380479 59157.3224   203%     -  117s
H    0     0                    19521.635195 59157.3224   203%     -  117s
H    0     0                    19631.728266 59157.3224   201%     -  117s
H    0     0                    19647.934593 59157.3224   201%     -  117s
H    0     0                    19709.328315 59157.3224   200%     -  117s
     0     0 58926.1907    0  178 19709.3283 58926.1907   199%     -  123s
     0     0 58894.4894    0  188 19709.3283 58894.4894   199%     -  125s
     0     0 58882.9429    0  192 19709.3283 58882.9429   199%     -  129s
     0     0 58882.9429    0  194 19709.3283 58882.9429   199%     -  132s
     0     0 58882.9429    0  198 19709.3283 58882.9429   199%     -  134s
     0     0 58882.9429    0  192 19709.3283 58882.9429   199%     -  138s
     0     0 58882.9429    0  198 19709.3283 58882.9429   199%     -  141s
     0     0 58882.9429    0  198 19709.3283 58882.9429   199%     -  142s
     0     0 58882.9429    0  198 19709.3283 58882.9429   199%     -  142s
     0     0 56273.6029    0  260 19709.3283 56273.6029   186%     -  161s
H    0     0                    24275.709705 56273.6029   132%     -  161s
H    0     0                    25944.617355 56273.6029   117%     -  161s
H    0     0                    26011.058858 56273.6029   116%     -  161s
     0     0 55973.1456    0  278 26011.0589 55973.1456   115%     -  170s
     0     0 55696.1112    0  289 26011.0589 55696.1112   114%     -  180s
     0     0 55627.6201    0  297 26011.0589 55627.6201   114%     -  187s
     0     0 55553.5755    0  294 26011.0589 55553.5755   114%     -  189s
     0     0 55527.3977    0  293 26011.0589 55527.3977   113%     -  191s
     0     0 55441.3898    0  289 26011.0589 55441.3898   113%     -  195s
     0     0 55434.4624    0  294 26011.0589 55434.4624   113%     -  196s
     0     0 55363.5523    0  297 26011.0589 55363.5523   113%     -  198s
     0     0 55335.2193    0  296 26011.0589 55335.2193   113%     -  200s
     0     0 55326.7434    0  299 26011.0589 55326.7434   113%     -  202s
     0     0 55323.1415    0  296 26011.0589 55323.1415   113%     -  203s
     0     0 55321.3834    0  298 26011.0589 55321.3834   113%     -  204s
     0     0 55295.6549    0  298 26011.0589 55295.6549   113%     -  205s
     0     0 55285.0885    0  294 26011.0589 55285.0885   113%     -  207s
     0     0 55283.7952    0  296 26011.0589 55283.7952   113%     -  207s
     0     0 55282.3537    0  297 26011.0589 55282.3537   113%     -  207s
     0     0 55282.0276    0  295 26011.0589 55282.0276   113%     -  208s
     0     0 54159.0113    0  347 26011.0589 54159.0113   108%     -  232s
     0     0 53668.3461    0  319 26011.0589 53668.3461   106%     -  249s
H    0     0                    30758.389543 53542.5461  74.1%     -  256s
     0     0 53542.5461    0  327 30758.3895 53542.5461  74.1%     -  256s
H    0     0                    32375.641265 53484.9604  65.2%     -  260s
H    0     0                    32475.590685 53484.9604  64.7%     -  260s
     0     0 53484.9604    0  329 32475.5907 53484.9604  64.7%     -  260s
H    0     0                    32587.455511 53445.2878  64.0%     -  265s
     0     0 53445.2878    0  336 32587.4555 53445.2878  64.0%     -  265s
     0     0 53411.0662    0  333 32587.4555 53411.0662  63.9%     -  267s
     0     0 53387.5212    0  334 32587.4555 53387.5212  63.8%     -  271s
     0     0 53368.6164    0  337 32587.4555 53368.6164  63.8%     -  273s
     0     0 53353.8223    0  369 32587.4555 53353.8223  63.7%     -  275s
     0     0 53342.2917    0  368 32587.4555 53342.2917  63.7%     -  277s
     0     0 53340.8628    0  368 32587.4555 53340.8628  63.7%     -  279s
     0     0 53333.7700    0  340 32587.4555 53333.7700  63.7%     -  281s
     0     0 53317.2748    0  345 32587.4555 53317.2748  63.6%     -  282s
     0     0 53305.3937    0  353 32587.4555 53305.3937  63.6%     -  284s
     0     0 53300.2766    0  348 32587.4555 53300.2766  63.6%     -  285s
     0     0 53299.2201    0  348 32587.4555 53299.2201  63.6%     -  286s
     0     0 52751.6612    0  362 32587.4555 52751.6612  61.9%     -  300s
H    0     0                    32589.737513 52751.6405  61.9%     -  301s
     0     0 52550.2531    0  376 32589.7375 52550.2531  61.2%     -  307s
     0     0 52495.6442    0  373 32589.7375 52495.6442  61.1%     -  310s
     0     0 52475.0309    0  377 32589.7375 52475.0309  61.0%     -  313s
H    0     0                    32616.867969 52460.1980  60.8%     -  316s
H    0     0                    32670.453290 52460.1980  60.6%     -  316s
     0     0 52460.1980    0  376 32670.4533 52460.1980  60.6%     -  316s
     0     0 52450.4434    0  373 32670.4533 52450.4434  60.5%     -  318s
     0     0 52446.8389    0  372 32670.4533 52446.8389  60.5%     -  319s
     0     0 52443.2766    0  380 32670.4533 52443.2766  60.5%     -  322s
     0     0 52438.5240    0  372 32670.4533 52438.5240  60.5%     -  323s
     0     0 52430.7629    0  370 32670.4533 52430.7629  60.5%     -  324s
     0     0 52429.3188    0  378 32670.4533 52429.3188  60.5%     -  325s
     0     0 52429.1046    0  376 32670.4533 52429.1046  60.5%     -  326s
H    0     0                    33441.894166 52378.5587  56.6%     -  331s
H    0     0                    33628.410220 52378.5587  55.8%     -  331s
H    0     0                    33640.174022 52378.5587  55.7%     -  331s
H    0     0                    33751.135126 52378.5587  55.2%     -  331s
     0     0 52378.5587    0  397 33751.1351 52378.5587  55.2%     -  331s
     0     0 52347.9438    0  402 33751.1351 52347.9438  55.1%     -  335s
     0     0 52341.0996    0  399 33751.1351 52341.0996  55.1%     -  337s
     0     0 52334.0996    0  408 33751.1351 52334.0996  55.1%     -  339s
     0     0 52330.4212    0  409 33751.1351 52330.4212  55.0%     -  340s
     0     0 52328.1947    0  409 33751.1351 52328.1947  55.0%     -  341s
     0     0 52326.7538    0  410 33751.1351 52326.7538  55.0%     -  342s
     0     0 52326.6606    0  412 33751.1351 52326.6606  55.0%     -  342s
     0     0 52257.2606    0  379 33751.1351 52257.2606  54.8%     -  349s
H    0     0                    33786.594210 52256.8716  54.7%     -  350s
H    0     0                    33856.646048 52236.7133  54.3%     -  353s
     0     0 52236.7133    0  385 33856.6460 52236.7133  54.3%     -  353s
H    0     0                    33943.091703 52227.2408  53.9%     -  356s
H    0     0                    34036.563835 52227.2408  53.4%     -  356s
     0     0 52227.2408    0  390 34036.5638 52227.2408  53.4%     -  356s
H    0     0                    34262.610162 52225.7014  52.4%     -  357s
     0     0 52225.7014    0  386 34262.6102 52225.7014  52.4%     -  357s
     0     0 52224.1773    0  385 34262.6102 52224.1773  52.4%     -  358s
     0     0 52223.9146    0  388 34262.6102 52223.9146  52.4%     -  358s
     0     0 52171.0493    0  377 34262.6102 52171.0493  52.3%     -  363s
     0     0 52163.2053    0  383 34262.6102 52163.2053  52.2%     -  365s
     0     0 52161.1801    0  386 34262.6102 52161.1801  52.2%     -  366s
     0     0 52159.6936    0  388 34262.6102 52159.6936  52.2%     -  367s
     0     0 52159.1457    0  386 34262.6102 52159.1457  52.2%     -  367s
     0     0 52143.7368    0  377 34262.6102 52143.7368  52.2%     -  370s
     0     0 52140.8696    0  382 34262.6102 52140.8696  52.2%     -  371s
     0     0 52138.9671    0  380 34262.6102 52138.9671  52.2%     -  372s
     0     0 52138.4371    0  381 34262.6102 52138.4371  52.2%     -  372s
     0     0 52122.0730    0  379 34262.6102 52122.0730  52.1%     -  376s
     0     0 52117.1043    0  385 34262.6102 52117.1043  52.1%     -  377s
     0     0 52116.2916    0  387 34262.6102 52116.2916  52.1%     -  378s
     0     0 52112.0244    0  394 34262.6102 52112.0244  52.1%     -  380s
     0     0 52107.2404    0  386 34262.6102 52107.2404  52.1%     -  382s
     0     0 52103.9298    0  382 34262.6102 52103.9298  52.1%     -  384s
     0     0 52103.2525    0  385 34262.6102 52103.2525  52.1%     -  384s
     0     0 52099.0894    0  380 34262.6102 52099.0894  52.1%     -  386s
     0     0 52096.7345    0  387 34262.6102 52096.7345  52.1%     -  388s
     0     0 52094.3538    0  382 34262.6102 52094.3538  52.0%     -  388s
     0     0 52093.1915    0  383 34262.6102 52093.1915  52.0%     -  389s
     0     0 52091.4613    0  383 34262.6102 52091.4613  52.0%     -  391s
     0     0 52090.8183    0  383 34262.6102 52090.8183  52.0%     -  392s
     0     2 52090.7390    0  383 34262.6102 52090.7390  52.0%     -  451s
     1     4 52040.6850    1  371 34262.6102 52089.2263  52.0%  3559  456s
     3     8 51935.6112    2  367 34262.6102 52040.3629  51.9%  4659  465s
     7    16 51842.0577    3  362 34262.6102 51957.0543  51.6%  6114  480s
    15    32 51357.1610    4  441 34262.6102 51841.7997  51.3%  8308  502s
    31    48 50437.6047    5  382 34262.6102 51356.5523  49.9% 12921  682s
    47    80 49588.3835    6  374 34262.6102 51356.5523  49.9% 13105  698s
H   57    80                    34348.414484 51356.5523  49.5% 12076  698s
H   63    80                    34403.104440 51356.5523  49.3% 11590  698s
    79   167 49508.6960    7  358 34403.1044 51356.5523  49.3% 10012  723s
   166   198 49277.1078   10  351 34403.1044 51356.5523  49.3%  6860  741s
   197   237 49060.4374   10  334 34403.1044 51356.5523  49.3%  6422  755s
   236   273 48286.2495    9  326 34403.1044 51356.5523  49.3%  6055  773s
   272   307 48535.4426    8  317 34403.1044 51356.5523  49.3%  5714  790s
   306   341 49156.2219   11  339 34403.1044 51356.5523  49.3%  5600  810s
   342   371 48478.7609   11  349 34403.1044 51356.5523  49.3%  5511  831s
   372   408 48887.2615   11  299 34403.1044 51356.5523  49.3%  5484  850s
   409   446 48487.9044   11  341 34403.1044 51356.5523  49.3%  5643  866s
   447   490 45925.8412   12  236 34403.1044 51356.5523  49.3%  5586  882s
   493   525 47368.4766   12  295 34403.1044 51356.5523  49.3%  5403  898s
H  534   525                    34457.240287 51356.5523  49.0%  5284  898s
   536   581 47203.2442   12  318 34457.2403 51356.5523  49.0%  5285  917s
   608   647 43834.7302   21  310 34457.2403 51356.5523  49.0%  5145  936s
   686   708 46753.0228   12  331 34457.2403 51356.5523  49.0%  4939  955s
   751   762 42978.8568   25  336 34457.2403 51356.5523  49.0%  4838  985s
   817   831 46803.3350   12  332 34457.2403 51356.5523  49.0%  4734 1005s
   904   914 41789.2859   28  266 34457.2403 51356.5523  49.0%  4526 1023s
  1001   962 46943.5336   13  307 34457.2403 51356.5523  49.0%  4315 1043s
  1071  1041 45214.4476   13  269 34457.2403 51356.5523  49.0%  4232 1061s
  1198  1144 45855.1773   13  248 34457.2403 51356.5523  49.0%  4007 1081s
  1313  1257 45644.1342   13  268 34457.2403 51356.5523  49.0%  3890 1101s
  1458  1342 45049.1292   14  269 34457.2403 51356.5523  49.0%  3713 1124s
  1588  1367 44073.6473   15  260 34457.2403 51356.5523  49.0%  3579 1144s
  1621  1389 42405.9517   14  315 34457.2403 51356.5523  49.0%  3606 1166s
  1670  1399 43261.9663   15  258 34457.2403 51356.5523  49.0%  3624 1190s
  1731  1429 41816.0781   16  282 34457.2403 51356.5523  49.0%  3606 1209s
  1776  1459 42183.6691   16  252 34457.2403 51356.5523  49.0%  3626 1234s
  1830  1499 37389.0831   16  204 34457.2403 51356.5523  49.0%  3630 1257s
  1887  1549 40660.7337   17  227 34457.2403 51356.5523  49.0%  3620 1282s
  1977  1599 40648.4786   17  241 34457.2403 51356.5523  49.0%  3571 1308s
  2061  1656 41551.5524   17  275 34457.2403 51356.5523  49.0%  3555 1336s
  2162  1739 35893.5197   17  254 34457.2403 51356.5523  49.0%  3535 1364s
  2293  1817 40120.9762   18  242 34457.2403 51356.5523  49.0%  3472 1393s
  2413  1886 38978.9460   19  193 34457.2403 51356.5523  49.0%  3436 1421s
H 2417  1886                    34627.684919 51356.5523  48.3%  3435 1421s
H 2524  1906                    35304.724529 51356.5523  45.5%  3423 1448s
H 2540  1879                    35527.689113 51356.5523  44.6%  3417 1448s
  2639  1909 38249.0323   22  141 35527.6891 51356.5523  44.6%  3405 1483s
  2781  1977     cutoff   21      35527.6891 51033.4957  43.6%  3400 1520s
  2915  2074 37126.5452   28  156 35527.6891 51033.4957  43.6%  3436 1554s
  3062  2165 37032.5739   34   84 35527.6891 51033.4957  43.6%  3452 1592s
  3215  2187     cutoff   39      35527.6891 50052.7136  40.9%  3475 1626s
H 3216  2184                    35564.839000 50052.7136  40.7%  3474 1626s
H 3217  2170                    35649.293143 50052.7136  40.4%  3474 1626s
H 3222  2037                    36313.314603 50052.7136  37.8%  3477 1626s
  3257  2150 46510.6895    8  337 36313.3146 50052.7136  37.8%  3503 1666s
  3445  2244 45001.6960   11  253 36313.3146 49972.0032  37.6%  3497 1711s
  3605  2364 43318.7525   13  260 36313.3146 49917.3750  37.5%  3533 1752s
  3773  2512 43009.4222   13  336 36313.3146 49854.3774  37.3%  3570 1805s
H 3977  2490                    36387.720790 49854.3774  37.0%  3570 1951s
  3978  2491 48536.2716   13  383 36387.7208 49854.3774  37.0%  3569 2027s
  3980  2492 43530.6780   28  136 36387.7208 49854.3774  37.0%  3568 2122s
H 3980  2367                    36423.351701 49854.3774  36.9%  3568 2180s
H 3980  2248                    36453.916019 49854.3774  36.8%  3568 2180s
H 3980  2136                    36566.277468 49854.3774  36.3%  3568 2185s
  3982  2138 37143.1535   28  337 36566.2775 49854.3774  36.3%  3566 2209s
  3983  2138 43700.0111   14  368 36566.2775 49854.3774  36.3%  3565 2234s
  3984  2139 38060.9946   13  410 36566.2775 49854.3774  36.3%  3564 2252s
  3985  2140 40247.6972   13  369 36566.2775 49854.3774  36.3%  3563 2264s
  3986  2140 36771.8382   18  374 36566.2775 49854.3774  36.3%  3562 2271s
  3987  2141 38938.5401   25  377 36566.2775 49854.3774  36.3%  3561 2279s
  3988  2142 36769.5928   53  381 36566.2775 49854.3774  36.3%  3560 2286s
  3989  2142 44143.3078   14  385 36566.2775 49854.3774  36.3%  3560 2291s
  3990  2143 48818.6218    8  381 36566.2775 49854.3774  36.3%  3559 2296s
  3991  2144 49242.7159   12  400 36566.2775 49854.3774  36.3%  3558 2306s
  3992  2144 41079.8217   33  419 36566.2775 49854.3774  36.3%  3557 2310s
  3994  2146 43975.8614   11  399 36566.2775 49854.3774  36.3%  3555 2321s
  3996  2147 46659.9694   11  412 36566.2775 49854.3774  36.3%  3553 2326s
  3997  2148 44652.1459   13  380 36566.2775 49854.3774  36.3%  3552 2333s
  3998  2148 39324.0632   27  384 36566.2775 49854.3774  36.3%  3552 2336s
  3999  2149 45449.2412   13  378 36566.2775 49854.3774  36.3%  3551 2340s
H 3999  2041                    36572.232123 49854.3774  36.3%  3551 2344s
H 3999  1939                    36596.859703 49854.3774  36.2%  3551 2344s
  4000  1940 43690.2918   21  381 36596.8597 49854.3774  36.2%  3550 2348s
  4001  1940 42006.9727   17  380 36596.8597 49854.3774  36.2%  3549 2351s
  4002  1941 44021.2901   21  375 36596.8597 49854.3774  36.2%  3548 2363s
  4003  1942 37344.0164   57  374 36596.8597 49854.3774  36.2%  3547 2366s
  4004  1942 40726.6334   20  371 36596.8597 49854.3774  36.2%  3546 2373s
  4005  1943 37551.6394   16  381 36596.8597 49854.3774  36.2%  3545 2376s
H 4005  1845                    36663.469446 49854.3774  36.0%  3545 2382s
  4006  1846 43458.8243   13  380 36663.4694 49854.3774  36.0%  3544 2387s
H 4006  1753                    36935.955981 49854.3774  35.0%  3544 2389s
  4007  1753 46040.6555   14  375 36935.9560 49854.3774  35.0%  3544 2391s
  4008  1754 37293.1687   49  420 36935.9560 49854.3774  35.0%  3543 2397s
  4009  1755 43542.1254   24  450 36935.9560 49854.3774  35.0%  3542 2400s
  4010  1755 36935.9560   40  416 36935.9560 49854.3774  35.0%  3541 2405s
  4011  1756 46316.9199   12  416 36935.9560 49854.3774  35.0%  3540 2484s
  4012  1757 39698.5947   19  416 36935.9560 49854.3774  35.0%  3539 2552s
  4013  1760 49854.3774   15  394 36935.9560 49854.3774  35.0%  3605 2733s
  4015  1764 49854.3774   16  382 36935.9560 49854.3774  35.0%  3612 2774s
  4019  1770 49854.3774   17  384 36935.9560 49854.3774  35.0%  3619 2802s
  4027  1784 49854.3774   18  390 36935.9560 49854.3774  35.0%  3638 2855s
  4043  1794 48894.4123   19  304 36935.9560 49854.3774  35.0%  3665 2900s
  4059  1821 48142.6250   20  289 36935.9560 49854.3774  35.0%  3746 2944s
  4091  1910 47243.5425   21  332 36935.9560 49854.3774  35.0%  3785 2991s
  4193  1940 46919.0484   24  358 36935.9560 49854.3774  35.0%  3850 3022s
  4257  1972 47093.3173   22  321 36935.9560 49854.3774  35.0%  3902 3045s
  4319  1982 44741.3166   25  328 36935.9560 49854.3774  35.0%  3974 3068s
  4390  1977 43687.9375   25  269 36935.9560 49854.3774  35.0%  4027 3091s
  4467  1961 42505.5748   25  238 36935.9560 49854.3774  35.0%  4061 3113s
  4502  1963 41463.4550   25  248 36935.9560 49854.3774  35.0%  4076 3141s
  4552  1963 44609.7183   26  333 36935.9560 49854.3774  35.0%  4092 3163s
  4611  1956 40735.2322   27  266 36935.9560 49854.3774  35.0%  4135 3182s
  4678  1939 43567.3611   26  236 36935.9560 49854.3774  35.0%  4158 3204s
  4731  1937 43894.0400   22  281 36935.9560 49854.3774  35.0%  4185 3224s
  4777  1941 40557.9924   27  260 36935.9560 49854.3774  35.0%  4227 3260s
  4821  1952 40335.8917   28  239 36935.9560 49854.3774  35.0%  4259 3281s
  4888  1971 38962.4003   30  218 36935.9560 49854.3774  35.0%  4286 3299s
  4937  1991 38749.4353   31  210 36935.9560 49854.3774  35.0%  4329 3318s
  4998  1974 37607.2409   33  133 36935.9560 49854.3774  35.0%  4364 3345s
  5082  1960 38449.0709   32  209 36935.9560 49854.3774  35.0%  4367 3366s
  5132  1956     cutoff   33      36935.9560 49854.3774  35.0%  4401 3400s
  5195  1966 43831.9786   21  311 36935.9560 49854.3774  35.0%  4423 3424s
  5262  1966 43550.2809   23  249 36935.9560 49854.3774  35.0%  4470 3460s
  5348  1972 42446.3857   25  230 36935.9560 49854.3774  35.0%  4513 3485s
  5431  1966 40195.4625   28  202 36935.9560 49854.3774  35.0%  4560 3510s
  5481  1975 39537.3803   29  188 36935.9560 49854.3774  35.0%  4587 3537s
  5547  1978 38237.3893   30  134 36935.9560 49477.0464  34.0%  4613 3564s
  5622  1997 38223.0529   31  146 36935.9560 49477.0464  34.0%  4661 3594s
  5699  1977 37985.0061   32  186 36935.9560 49477.0464  34.0%  4693 3600s

Cutting planes:
  MIR: 590
  Mixing: 2
  Flow cover: 1358
  RLT: 19
  Relax-and-lift: 154

Explored 5725 nodes (27162942 simplex iterations) in 3600.05 seconds (6156.51 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 36936 36663.5 36596.9 ... 35649.3

Time limit reached
Best objective 3.693595598144e+04, best bound 4.947704638150e+04, gap 33.9536%
  WARNING: Time limit reached. Using best solution found (gap: 33.95%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = 36935.96, θ = 190575.11
  Upper Bound (UB) = 36935.96

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 190575.11
  [DEBUG]   ✓ Scenario 0: θ = 190575.11 ≤ Q = 190575.11 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 190575.11 ≤ Q = 190575.11 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 190575.11 ≤ Q = 190575.11 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 190575.11 ≤ Q = 190575.11 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 190575.11 ≤ Q = 190575.11 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 190575.11 ≤ Q = 190575.11 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 190575.11 ≤ Q = 190575.11 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 190575.11 ≤ Q = 190575.11 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 190575.11 ≤ Q = 190575.11 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x616c7989
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x616c7989
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.413530e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.01s
Presolved: 494 rows, 498 columns, 1393 nonzeros
Found heuristic solution: objective 6859528.1608
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.647517e+05, 255 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -164751.66    0  128 6859528.16 -164751.66   102%     -    0s
H    0     0                    -129137.2715 -164751.66  27.6%     -    0s
H    0     0                    -129822.4290 -164751.66  26.9%     -    0s
H    0     0                    -131483.2195 -143514.28  9.15%     -    0s
H    0     0                    -136997.7133 -143514.28  4.76%     -    0s
     0     0 -143514.28    0   95 -136997.71 -143514.28  4.76%     -    0s
H    0     0                    -140341.2120 -143419.85  2.19%     -    0s
     0     0 -143388.26    0   83 -140341.21 -143388.26  2.17%     -    0s
     0     0 -143388.26    0   95 -140341.21 -143388.26  2.17%     -    0s
     0     0 -142370.95    0   79 -140341.21 -142370.95  1.45%     -    0s
     0     0 -142350.64    0   80 -140341.21 -142350.64  1.43%     -    0s
     0     0 -142122.80    0   80 -140341.21 -142122.80  1.27%     -    0s
     0     0 -142096.25    0   80 -140341.21 -142096.25  1.25%     -    0s
     0     0 -141944.02    0   73 -140341.21 -141944.02  1.14%     -    0s
     0     0 -141934.04    0   73 -140341.21 -141934.04  1.13%     -    0s
H    0     0                    -140823.0443 -141934.04  0.79%     -    0s
H    0     0                    -141555.9328 -141934.04  0.27%     -    0s
H    0     0                    -141834.8663 -141934.04  0.07%     -    0s
H    0     0                    -141851.9494 -141934.04  0.06%     -    0s
     0     2 -141934.04    0   63 -141851.95 -141934.04  0.06%     -    0s
H   31    21                    -141870.2447 -141882.69  0.01%   3.9    0s

Cutting planes:
  Gomory: 29
  MIR: 148
  Flow cover: 1
  RLT: 25
  BQP: 2

Explored 61 nodes (732 simplex iterations) in 0.17 seconds (0.06 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -141870 -141852 -141835 ... -129137
No other solutions better than -141870

Optimal solution found (tolerance 1.00e-06)
Best objective -1.418702447177e+05, best bound -1.418702447177e+05, gap 0.0000%
  Subproblem solved in 0.20s
  Worst-case operational profit (Z_SP) = 179271.78
  Scenario: 24 demand increases, 36 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -141870.24
  [DEBUG]   S×d_nominal = 321142.03
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 321142.03 + -141870.24 = 179271.78
  [DEBUG]   Current θ from Master = 190575.11
  [DEBUG]   ⚠️  Z_SP ≤ θ by 11303.33 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 25632.62
  Lower Bound (LB) = 28468.08
  Gap (UB-LB) = 8467.8714, Absolute Gap = 8467.8714, Relative Gap = 0.229258
  Not converged yet (gap = 8467.87 > ε = 200)

  [DEBUG] Adding NEW scenario 9 to Master Problem...
  [DEBUG] New scenario pattern: 24 increases, 36 decreases
    [DEBUG] Scenario 9 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 9 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 9]
    [DEBUG]   - Total constraints in model: 154283
    [DEBUG]   - Total variables in model: 64660
  [DEBUG] Total scenarios in Master: 10
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 10
================================================================================
[Iteration 10] Solving Master Problem...
  Current scenarios in Master: 10
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 154283 rows, 64660 columns and 437829 nonzeros
Model fingerprint: 0x96f9c0c0
Variable types: 62401 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 70700 rows and 28700 columns
Presolve time: 2.64s
Presolved: 83583 rows, 35960 columns, 511899 nonzeros
Variable types: 33701 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -335473.7764
Found heuristic solution: objective -170353.9630

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.24s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.540e+06
 Factor NZ  : 7.602e+06 (roughly 100 MB of memory)
 Factor Ops : 1.284e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.59270263e+07  1.62770343e+08  1.11e+05 1.81e+01  7.86e+04     5s
   1  -1.19670835e+07  1.48686697e+08  7.70e+04 7.49e+01  5.41e+04     5s
   2  -3.98325196e+06  1.09125531e+08  2.57e+04 2.15e+00  1.92e+04     5s
   3  -1.29916763e+06  8.68425297e+07  4.35e+03 1.12e+00  3.63e+03     5s
   4  -5.41767100e+05  5.35642830e+07  6.07e+02 5.10e-01  7.45e+02     5s
   5  -4.26427768e+05  2.97615441e+07  3.47e+02 2.24e-01  3.97e+02     5s
   6  -3.11576906e+05  2.16863960e+07  7.71e+01 1.52e-01  1.84e+02     5s
   7  -2.45500639e+05  1.49777356e+07  3.28e+01 1.00e-01  1.14e+02     5s
   8  -1.27939956e+05  1.15881612e+07  8.28e-01 7.54e-02  7.65e+01     5s
   9  -9.60714056e+04  5.80896732e+06  4.94e-01 3.78e-02  3.85e+01     5s
  10  -6.13150425e+04  1.96713810e+06  2.30e-01 1.24e-02  1.32e+01     6s
  11  -1.96804267e+04  5.32451472e+05  8.64e-02 3.26e-03  3.59e+00     6s
  12   6.80395081e+03  2.59050239e+05  4.86e-02 1.38e-03  1.64e+00     6s
  13   1.94419771e+04  2.12079763e+05  3.54e-02 1.49e-03  1.25e+00     6s
  14   2.52665376e+04  1.65622162e+05  3.00e-02 9.36e-04  9.14e-01     6s
  15   3.46373939e+04  1.32373786e+05  2.20e-02 6.24e-04  6.36e-01     6s
  16   4.14899496e+04  1.15440532e+05  1.69e-02 4.66e-04  4.81e-01     6s
  17   4.69863958e+04  1.04821889e+05  1.28e-02 3.76e-04  3.76e-01     6s
  18   5.17692543e+04  9.73497160e+04  9.44e-03 3.00e-04  2.97e-01     6s
  19   5.69576671e+04  9.15901518e+04  6.09e-03 2.43e-04  2.25e-01     7s
  20   5.83444792e+04  8.36279562e+04  5.29e-03 1.73e-04  1.65e-01     7s
  21   6.01475673e+04  8.02589141e+04  4.32e-03 1.35e-04  1.31e-01     7s
  22   6.24058293e+04  7.76222603e+04  3.13e-03 1.09e-04  9.90e-02     7s
  23   6.36463840e+04  7.51381117e+04  2.51e-03 7.95e-05  7.48e-02     7s
  24   6.45400741e+04  7.34721347e+04  2.08e-03 5.69e-05  5.81e-02     7s
  25   6.62235927e+04  7.24372884e+04  1.31e-03 4.27e-05  4.04e-02     7s
  26   6.68112324e+04  7.20558145e+04  1.04e-03 3.80e-05  3.41e-02     7s
  27   6.69548272e+04  7.08846321e+04  9.74e-04 2.23e-05  2.56e-02     8s
  28   6.72965598e+04  7.08362338e+04  8.27e-04 2.17e-05  2.30e-02     8s
  29   6.78391773e+04  7.05162512e+04  5.79e-04 1.75e-05  1.74e-02     8s
  30   6.83903220e+04  7.01325505e+04  3.32e-04 1.22e-05  1.13e-02     8s
  31   6.85644999e+04  6.98583547e+04  2.59e-04 8.43e-06  8.42e-03     8s
  32   6.86409683e+04  6.97320132e+04  2.28e-04 6.86e-06  7.10e-03     8s
  33   6.87165971e+04  6.96981482e+04  1.98e-04 6.46e-06  6.39e-03     8s
  34   6.88077891e+04  6.96420366e+04  1.62e-04 5.70e-06  5.43e-03     9s
  35   6.88454253e+04  6.95371841e+04  1.46e-04 4.37e-06  4.50e-03     9s
  36   6.89034615e+04  6.94849952e+04  1.22e-04 3.63e-06  3.79e-03     9s
  37   6.90240780e+04  6.93702124e+04  7.29e-05 2.01e-06  2.25e-03     9s
  38   6.91581866e+04  6.93168612e+04  2.18e-05 1.27e-06  1.03e-03     9s
  39   6.91773260e+04  6.92872951e+04  1.49e-05 8.66e-07  7.16e-04     9s
  40   6.91943412e+04  6.92807949e+04  8.86e-06 7.79e-07  5.63e-04     9s
  41   6.91960229e+04  6.92608955e+04  8.31e-06 5.13e-07  4.22e-04     9s
  42   6.92087555e+04  6.92378162e+04  4.29e-06 2.03e-07  1.89e-04    10s
  43   6.92187225e+04  6.92277341e+04  1.19e-06 6.27e-07  5.86e-05    10s
  44   6.92188808e+04  6.92271997e+04  1.13e-06 5.61e-07  5.41e-05    10s
  45   6.92216652e+04  6.92268068e+04  2.00e-07 5.13e-07  3.35e-05    10s
  46   6.92218504e+04  6.92241639e+04  1.64e-07 1.79e-07  1.51e-05    10s
  47   6.92224164e+04  6.92228087e+04  7.05e-08 1.25e-08  2.55e-06    10s
  48   6.92226789e+04  6.92226800e+04  4.32e-09 1.51e-09  7.17e-09    11s
  49   6.92226794e+04  6.92226796e+04  8.83e-09 6.44e-11  1.01e-09    11s

Barrier solved model in 49 iterations and 10.66 seconds (8.19 work units)
Optimal objective 6.92226794e+04


Root crossover log...

   74248 DPushes remaining with DInf 0.0000000e+00                11s
       0 DPushes remaining with DInf 0.0000000e+00                13s

    4200 PPushes remaining with PInf 3.7851449e-05                13s
       0 PPushes remaining with PInf 0.0000000e+00                14s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.4604681e+05     14s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   38006    6.9222680e+04   0.000000e+00   2.460468e+05     14s
   38458    6.9222680e+04   0.000000e+00   0.000000e+00     14s
   38458    6.9222680e+04   0.000000e+00   0.000000e+00     14s
Concurrent spin time: 0.01s

Solved with barrier

Root relaxation: objective 6.922268e+04, 38458 iterations, 10.30 seconds (11.32 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 69222.6796    0  178 -170353.96 69222.6796   141%     -   14s
H    0     0                    -164203.7409 69222.6796   142%     -   14s
H    0     0                    -49177.19054 69222.6796   241%     -   15s
H    0     0                    5565.0588215 69222.6796  1144%     -   15s
H    0     0                    23820.345663 69222.6796   191%     -   15s
H    0     0                    24637.637422 69222.6796   181%     -   16s
H    0     0                    25560.905338 69222.6796   171%     -   16s
H    0     0                    25587.670579 69222.6796   171%     -   16s
H    0     0                    25840.927766 69222.6796   168%     -   16s
H    0     0                    25882.927700 69222.6796   167%     -   16s
H    0     0                    25897.544704 69222.6796   167%     -   16s
H    0     0                    25899.943581 69222.6796   167%     -   16s
H    0     0                    26071.521412 69216.6382   165%     -   18s
H    0     0                    26189.417562 63826.9002   144%     -   51s
     0     0 63704.3339    0  200 26189.4176 63704.3339   143%     -   51s
     0     0 62977.4057    0  224 26189.4176 62977.4057   140%     -   75s
     0     0 62858.6606    0  224 26189.4176 62858.6606   140%     -   83s
     0     0 62858.6606    0  236 26189.4176 62858.6606   140%     -   90s
     0     0 62858.6606    0  246 26189.4176 62858.6606   140%     -   93s
     0     0 62858.6606    0  248 26189.4176 62858.6606   140%     -   94s
     0     0 62858.6606    0  245 26189.4176 62858.6606   140%     -  100s
     0     0 62858.6562    0  245 26189.4176 62858.6562   140%     -  101s
     0     0 62858.6546    0  245 26189.4176 62858.6546   140%     -  102s
H    0     0                    26199.867248 58880.9377   125%     -  156s
     0     0 58880.9377    0  272 26199.8672 58880.9377   125%     -  157s
H    0     0                    31058.339883 58879.6748  89.6%     -  157s
     0     0 58317.4619    0  282 31058.3399 58317.4619  87.8%     -  182s
     0     0 58002.1556    0  294 31058.3399 58002.1556  86.8%     -  197s
     0     0 57754.4120    0  311 31058.3399 57754.4120  86.0%     -  212s
     0     0 57696.2893    0  300 31058.3399 57696.2893  85.8%     -  217s
     0     0 57652.0497    0  305 31058.3399 57652.0497  85.6%     -  222s
     0     0 57643.8901    0  305 31058.3399 57643.8901  85.6%     -  226s
     0     0 57620.1517    0  309 31058.3399 57620.1517  85.5%     -  229s
     0     0 57537.0515    0  302 31058.3399 57537.0515  85.3%     -  236s
     0     0 57519.5875    0  309 31058.3399 57519.5875  85.2%     -  242s
     0     0 57513.5027    0  306 31058.3399 57513.5027  85.2%     -  244s
     0     0 57509.1752    0  319 31058.3399 57509.1752  85.2%     -  247s
     0     0 57508.2592    0  322 31058.3399 57508.2592  85.2%     -  248s
H    0     0                    31468.423805 57508.2592  82.7%     -  263s
H    0     0                    31695.236024 57508.2592  81.4%     -  263s
H    0     0                    31719.336827 57508.2592  81.3%     -  263s
H    0     0                    31756.728642 57508.2592  81.1%     -  263s
H    0     0                    31768.760084 57508.2592  81.0%     -  263s
H    0     0                    32031.290505 57508.2592  79.5%     -  263s
H    0     0                    32159.949331 57508.2592  78.8%     -  263s
H    0     0                    32191.034856 57508.2592  78.6%     -  263s
     0     0 55951.2331    0  344 32191.0349 55951.2331  73.8%     -  302s
H    0     0                    32513.324792 55951.1823  72.1%     -  303s
H    0     0                    33249.381972 55951.1823  68.3%     -  303s
H    0     0                    33430.209816 55951.1823  67.4%     -  303s
H    0     0                    33435.118090 55951.1823  67.3%     -  303s
H    0     0                    33586.735891 55951.1823  66.6%     -  303s
H    0     0                    33626.715761 55951.1823  66.4%     -  303s
     0     0 55563.9302    0  344 33626.7158 55563.9302  65.2%     -  335s
     0     0 55299.4385    0  398 33626.7158 55299.4385  64.5%     -  358s
     0     0 55254.1136    0  386 33626.7158 55254.1136  64.3%     -  366s
     0     0 55213.2633    0  392 33626.7158 55213.2633  64.2%     -  371s
     0     0 55209.5718    0  397 33626.7158 55209.5718  64.2%     -  375s
     0     0 55193.4129    0  386 33626.7158 55193.4129  64.1%     -  379s
     0     0 55157.4854    0  394 33626.7158 55157.4854  64.0%     -  387s
     0     0 55139.6469    0  391 33626.7158 55139.6469  64.0%     -  392s
     0     0 55116.3585    0  411 33626.7158 55116.3585  63.9%     -  397s
     0     0 55100.3621    0  389 33626.7158 55100.3621  63.9%     -  400s
     0     0 55091.3747    0  403 33626.7158 55091.3747  63.8%     -  402s
     0     0 55088.4465    0  405 33626.7158 55088.4465  63.8%     -  403s
     0     0 55066.1391    0  403 33626.7158 55066.1391  63.8%     -  408s
     0     0 55030.4873    0  406 33626.7158 55030.4873  63.7%     -  415s
     0     0 55003.3330    0  416 33626.7158 55003.3330  63.6%     -  419s
     0     0 54996.2500    0  410 33626.7158 54996.2500  63.5%     -  420s
     0     0 54994.3648    0  410 33626.7158 54994.3648  63.5%     -  421s
H    0     0                    33846.510999 53591.5741  58.3%     -  476s
     0     0 53591.5741    0  349 33846.5110 53591.5741  58.3%     -  476s
     0     0 53243.7877    0  386 33846.5110 53243.7877  57.3%     -  501s
     0     0 53138.4999    0  355 33846.5110 53138.4999  57.0%     -  514s
H    0     0                    33973.194267 53094.9309  56.3%     -  521s
     0     0 53094.9309    0  361 33973.1943 53094.9309  56.3%     -  521s
     0     0 53076.2671    0  361 33973.1943 53076.2671  56.2%     -  526s
     0     0 53041.8530    0  359 33973.1943 53041.8530  56.1%     -  532s
     0     0 53015.8558    0  362 33973.1943 53015.8558  56.1%     -  538s
     0     0 52999.6672    0  367 33973.1943 52999.6672  56.0%     -  541s
     0     0 52951.4457    0  372 33973.1943 52951.4457  55.9%     -  546s
H    0     0                    34392.691506 52935.1162  53.9%     -  550s
     0     0 52935.1162    0  380 34392.6915 52935.1162  53.9%     -  550s
     0     0 52917.9225    0  374 34392.6915 52917.9225  53.9%     -  553s
     0     0 52909.8948    0  376 34392.6915 52909.8948  53.8%     -  556s
     0     0 52906.9771    0  370 34392.6915 52906.9771  53.8%     -  558s
     0     0 52905.1601    0  370 34392.6915 52905.1601  53.8%     -  559s
     0     0 52744.6531    0  413 34392.6915 52744.6531  53.4%     -  572s
     0     0 52632.7164    0  424 34392.6915 52632.7164  53.0%     -  586s
     0     0 52610.9573    0  421 34392.6915 52610.9573  53.0%     -  591s
     0     0 52594.3089    0  425 34392.6915 52594.3089  52.9%     -  594s
     0     0 52589.3466    0  399 34392.6915 52589.3466  52.9%     -  596s
     0     0 52579.3962    0  391 34392.6915 52579.3962  52.9%     -  600s
     0     0 52549.0649    0  384 34392.6915 52549.0649  52.8%     -  605s
     0     0 52541.9231    0  375 34392.6915 52541.9231  52.8%     -  607s
     0     0 52540.4857    0  375 34392.6915 52540.4857  52.8%     -  609s
     0     0 52453.3108    0  376 34392.6915 52453.3108  52.5%     -  621s
     0     0 52439.7118    0  380 34392.6915 52439.7118  52.5%     -  639s
     0     0 52417.7896    0  373 34392.6915 52417.7896  52.4%     -  643s
     0     0 52410.6465    0  384 34392.6915 52410.6465  52.4%     -  646s
     0     0 52406.5424    0  380 34392.6915 52406.5424  52.4%     -  647s
     0     0 52403.7542    0  383 34392.6915 52403.7542  52.4%     -  650s
     0     0 52402.7197    0  387 34392.6915 52402.7197  52.4%     -  652s
     0     0 52362.6129    0  383 34392.6915 52362.6129  52.2%     -  660s
     0     0 52352.1495    0  382 34392.6915 52352.1495  52.2%     -  666s
     0     0 52344.2124    0  383 34392.6915 52344.2124  52.2%     -  669s
     0     0 52338.1452    0  389 34392.6915 52338.1452  52.2%     -  674s
     0     0 52337.0575    0  384 34392.6915 52337.0575  52.2%     -  676s
     0     0 52311.4718    0  382 34392.6915 52311.4718  52.1%     -  683s
     0     0 52306.6542    0  379 34392.6915 52306.6542  52.1%     -  690s
     0     0 52305.1300    0  425 34392.6915 52305.1300  52.1%     -  691s
     0     0 52279.1505    0  378 34392.6915 52279.1505  52.0%     -  697s
     0     0 52257.3991    0  381 34392.6915 52257.3991  51.9%     -  701s
     0     0 52254.1747    0  387 34392.6915 52254.1747  51.9%     -  702s
     0     0 52250.6004    0  387 34392.6915 52250.6004  51.9%     -  704s
     0     0 52249.7567    0  386 34392.6915 52249.7567  51.9%     -  705s
     0     0 52234.5168    0  392 34392.6915 52234.5168  51.9%     -  710s
H    0     0                    34408.250134 52234.4558  51.8%     -  717s
     0     0 52228.1661    0  386 34408.2501 52228.1661  51.8%     -  720s
     0     0 52226.5265    0  389 34408.2501 52226.5265  51.8%     -  722s
     0     0 52212.1293    0  391 34408.2501 52212.1293  51.7%     -  725s
     0     0 52202.5800    0  394 34408.2501 52202.5800  51.7%     -  729s
     0     0 52201.0161    0  394 34408.2501 52201.0161  51.7%     -  731s
     0     0 52182.6932    0  373 34408.2501 52182.6932  51.7%     -  736s
H    0     0                    34443.925423 52181.2690  51.5%     -  756s
     0     0 52177.9381    0  378 34443.9254 52177.9381  51.5%     -  761s
     0     0 52176.4130    0  385 34443.9254 52176.4130  51.5%     -  762s
     0     0 52165.4092    0  381 34443.9254 52165.4092  51.5%     -  765s
     0     0 52163.3275    0  380 34443.9254 52163.3275  51.4%     -  768s
     0     0 52154.1277    0  373 34443.9254 52154.1277  51.4%     -  771s
     0     0 52152.7986    0  373 34443.9254 52152.7986  51.4%     -  773s
H    0     0                    34479.482918 52152.7870  51.3%     -  939s
     0     2 52152.7870    0  373 34479.4829 52152.7870  51.3%     -  941s
     1     3 51825.6304    1  373 34479.4829 52152.7870  51.3%  9987  954s
     2     4 51970.7717    1  359 34479.4829 51970.7717  50.7%  8819  964s
     3     6 51389.7221    2  370 34479.4829 51970.1734  50.7%  6759  981s
     5    11 50760.7915    3  353 34479.4829 51970.1734  50.7%  5854  999s
    10    22 50806.1707    3  399 34479.4829 51552.3178  49.5%  8130 1023s
    21    33 49853.0563    4  350 34479.4829 51265.0398  48.7% 12404 1070s
    32    65 48984.8377    6  336 34479.4829 51265.0398  48.7% 12071 1190s
    64    97 48944.9354    7  340 34479.4829 50680.9141  47.0% 17331 1206s
    96   129 48770.4941    8  276 34479.4829 50680.9017  47.0% 14692 1334s
   128   161 48753.6999    9  282 34479.4829 50680.9017  47.0% 11949 1365s
H  131   161                    34493.378739 50680.9017  46.9% 11763 1365s
   160   304 48737.5710   10  279 34493.3787 50680.9017  46.9% 10662 1405s
   303   377 47711.4675   15  265 34493.3787 50680.9017  46.9%  7446 1433s
   376   408 47397.5580   19  308 34493.3787 50680.9017  46.9%  6734 1453s
   407   440 45847.2729   20  284 34493.3787 50680.9017  46.9%  6720 1484s
   439   468 44329.0110   17  217 34493.3787 50680.9017  46.9%  6718 1509s
   467   501 40842.0778   21  243 34493.3787 50680.9017  46.9%  6872 1531s
   500   533 40201.4995   22  237 34493.3787 50680.9017  46.9%  7104 1556s
   532   565 40124.9600   23  169 34493.3787 50680.9017  46.9%  7229 1579s
   570   593 40040.7537   24  168 34493.3787 50680.9017  46.9%  7376 1606s
   606   624 40040.3863   25  166 34493.3787 50680.9017  46.9%  7553 1633s
   643   656 39983.1794   26  165 34493.3787 50680.9017  46.9%  7549 1658s
   681   684 39916.7381   27  164 34493.3787 50680.9017  46.9%  7597 1680s
   717   719 39895.4101   28  164 34493.3787 50680.9017  46.9%  7662 1705s
   759   752 39357.7023   29  274 34493.3787 50680.9017  46.9%  7692 1725s
   802   780 38901.7902   30  259 34493.3787 50680.9017  46.9%  7780 1746s
   848   812 38882.9771   31  255 34493.3787 50680.9017  46.9%  7854 1769s
   902   848 38881.5423   32  253 34493.3787 50680.9017  46.9%  7802 1794s
   958   885 38865.0884   33  247 34493.3787 50680.9017  46.9%  7747 1817s
  1011   928 38854.4767   34  244 34493.3787 50680.9017  46.9%  7747 1844s
  1070   972 38749.6939   35  247 34493.3787 50680.9017  46.9%  7707 1869s
  1136   994 infeasible   36      34493.3787 50664.6539  46.9%  7606 1898s
  1174  1042 38562.9397   37  226 34493.3787 50664.6539  46.9%  7564 1923s
  1240  1119 38419.4982   39  241 34493.3787 50664.6539  46.9%  7474 1949s
  1343  1214 36363.2921   43  220 34493.3787 50664.6539  46.9%  7231 1978s
  1463  1340 36229.7478   47  247 34493.3787 50390.1395  46.1%  7025 2006s
H 1473  1340                    34568.736496 50390.1395  45.8%  6993 2006s
  1612  1416 35597.0253   56  221 34568.7365 50390.1395  45.8%  6777 2039s
  1776  1507 infeasible   62      34568.7365 50390.1395  45.8%  6620 2071s
  1912  1621 46982.6615    8  296 34568.7365 50390.1395  45.8%  6608 2103s
  2046  1734 46743.9573   10  274 34568.7365 50286.6461  45.5%  6575 2135s
  2191  1820 40570.8304   11  266 34568.7365 50286.6461  45.5%  6484 2166s
H 2329  1834                    34696.123932 50221.4196  44.7%  6428 2202s
H 2331  1828                    34735.423373 50221.4196  44.6%  6436 2202s
  2362  1889 39034.6582   13  244 34735.4234 50221.4196  44.6%  6525 2240s
  2474  1948 37991.3840   16  256 34735.4234 50221.4196  44.6%  6606 2279s
  2569  2015 35797.2853   20  262 34735.4234 50160.8226  44.4%  6753 2323s
  2695  2097 infeasible   24      34735.4234 50160.8226  44.4%  6834 2363s
  2823  2170 47196.1855    7  310 34735.4234 50160.8226  44.4%  6947 2410s
  2954  2245 40832.1204    9  246 34735.4234 49944.5505  43.8%  7028 2458s
  3099  2340 40777.3278   10  233 34735.4234 49944.5505  43.8%  7102 2507s
  3252  2418 37623.2796   12  339 34735.4234 49944.5505  43.8%  7197 2556s
  3414  2513 infeasible   15      34735.4234 49700.9864  43.1%  7255 2610s
  3594  2600 35350.5764   18  283 34735.4234 49651.2476  42.9%  7278 2665s
  3767  2683 infeasible   19      34735.4234 49616.0129  42.8%  7308 2718s
  3918  2785 43823.4629   11  367 34735.4234 49616.0129  42.8%  7417 2772s
  4073  2786 35591.4564   50  373 34735.4234 49616.0129  42.8%  7510 3025s
H 4074  2647                    34772.117682 49616.0129  42.7%  7509 3038s
H 4074  2515                    34811.984927 49616.0129  42.5%  7509 3038s
  4075  2515 40040.1546   26  198 34811.9849 49616.0129  42.5%  7507 3040s
  4076  2516 36518.0169   62  328 34811.9849 49616.0129  42.5%  7505 3131s
  4077  2517 39830.6329   28  351 34811.9849 49616.0129  42.5%  7503 3196s
  4078  2517 41697.3785   20  359 34811.9849 49616.0129  42.5%  7501 3226s
  4079  2518 35455.6251   26  356 34811.9849 49616.0129  42.5%  7499 3242s
  4080  2519 47246.5972   12  363 34811.9849 49616.0129  42.5%  7498 3265s
  4081  2519 39824.3762   22  364 34811.9849 49616.0129  42.5%  7496 3289s
  4082  2520 37706.8403   46  371 34811.9849 49616.0129  42.5%  7494 3306s
  4083  2521 36543.6929   33  362 34811.9849 49616.0129  42.5%  7492 3323s
  4084  2521 48646.2829   14  377 34811.9849 49616.0129  42.5%  7490 3334s
  4085  2522 44098.9063   12  378 34811.9849 49616.0129  42.5%  7488 3341s
  4086  2523 39058.3870   49  373 34811.9849 49616.0129  42.5%  7487 3351s
  4087  2523 41928.7497   22  371 34811.9849 49616.0129  42.5%  7485 3356s
  4088  2524 46163.2809   13  392 34811.9849 49616.0129  42.5%  7483 3366s
  4089  2525 37993.6797   37  367 34811.9849 49616.0129  42.5%  7481 3373s
  4090  2525 38815.5422   27  370 34811.9849 49616.0129  42.5%  7479 3376s
  4091  2526 37666.0929   18  368 34811.9849 49616.0129  42.5%  7477 3381s
  4092  2527 37619.4287   13  401 34811.9849 49616.0129  42.5%  7476 3392s
  4093  2527 39078.3378   48  444 34811.9849 49616.0129  42.5%  7474 3396s
  4094  2528 34858.9508   43  418 34811.9849 49616.0129  42.5%  7472 3401s
  4095  2529 38608.1509   16  415 34811.9849 49616.0129  42.5%  7470 3406s
  4096  2529 49424.2180   10  374 34811.9849 49616.0129  42.5%  7468 3418s
  4097  2530 44994.9473   17  378 34811.9849 49616.0129  42.5%  7466 3423s
  4098  2531 39163.2186   19  375 34811.9849 49616.0129  42.5%  7465 3429s
  4099  2531 37956.1216   21  378 34811.9849 49616.0129  42.5%  7463 3437s
  4100  2532 36587.3295   56  369 34811.9849 49616.0129  42.5%  7461 3442s
  4101  2533 37177.3935   58  362 34811.9849 49616.0129  42.5%  7459 3447s
  4102  2533 39387.0537   19  362 34811.9849 49616.0129  42.5%  7457 3452s
  4103  2534 36483.5496   33  360 34811.9849 49616.0129  42.5%  7456 3462s
  4104  2535 42831.3021   19  362 34811.9849 49616.0129  42.5%  7454 3466s
  4105  2535 39398.8124   15  366 34811.9849 49616.0129  42.5%  7452 3471s
  4106  2536 45015.7078   11  399 34811.9849 49616.0129  42.5%  7450 3475s
  4107  2537 47496.0604   10  393 34811.9849 49616.0129  42.5%  7448 3490s
  4108  2537 39137.1154   19  395 34811.9849 49616.0129  42.5%  7446 3497s
  4109  2538 44786.3385   19  357 34811.9849 49616.0129  42.5%  7445 3507s
  4110  2539 37334.0969   27  357 34811.9849 49616.0129  42.5%  7443 3512s
  4111  2539 48726.0481   13  355 34811.9849 49616.0129  42.5%  7441 3521s
  4112  2540 40875.7825   19  355 34811.9849 49616.0129  42.5%  7439 3535s

Cutting planes:
  Gomory: 14
  Implied bound: 15
  Projected implied bound: 116
  MIR: 721
  Mixing: 1
  Flow cover: 605
  RLT: 18
  Relax-and-lift: 164

Explored 4112 nodes (31334505 simplex iterations) in 3600.04 seconds (5750.91 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 34812 34772.1 34735.4 ... 34392.7

Time limit reached
Best objective 3.481198492732e+04, best bound 4.961601286379e+04, gap 42.5257%
  WARNING: Time limit reached. Using best solution found (gap: 42.53%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = 34811.98, θ = 187597.46
  Upper Bound (UB) = 34811.98

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 187597.46
  [DEBUG]   ✓ Scenario 0: θ = 187597.46 ≤ Q = 187597.46 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 187597.46 ≤ Q = 187597.46 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 187597.46 ≤ Q = 187597.46 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 187597.46 ≤ Q = 187597.46 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 187597.46 ≤ Q = 187597.46 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 187597.46 ≤ Q = 187597.46 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 187597.46 ≤ Q = 187597.46 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 187597.46 ≤ Q = 187597.46 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 187597.46 ≤ Q = 187597.46 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 187597.46 ≤ Q = 187597.46 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 10] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x4e9e3ebf
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x4e9e3ebf
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.410133e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.01s
Presolved: 494 rows, 498 columns, 1393 nonzeros
Found heuristic solution: objective 6889706.3834
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.614718e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -161471.77    0  128 6889706.38 -161471.77   102%     -    0s
H    0     0                    -124752.7611 -161471.77  29.4%     -    0s
H    0     0                    -126075.2895 -161471.77  28.1%     -    0s
H    0     0                    -127886.7915 -161471.77  26.3%     -    0s
H    0     0                    -128509.1201 -142283.23  10.7%     -    0s
     0     0 -142283.23    0  107 -128509.12 -142283.23  10.7%     -    0s
H    0     0                    -136978.7812 -142189.99  3.80%     -    0s
     0     0 -141538.57    0  100 -136978.78 -141538.57  3.33%     -    0s
     0     0 -140463.28    0   92 -136978.78 -140463.28  2.54%     -    0s
H    0     0                    -139561.8098 -140446.77  0.63%     -    0s
     0     0 -140268.37    0   92 -139561.81 -140268.37  0.51%     -    0s
     0     0 -140268.37    0   92 -139561.81 -140268.37  0.51%     -    0s
     0     0 -139939.02    0   14 -139561.81 -139939.02  0.27%     -    0s
     0     0 -139793.43    0   20 -139561.81 -139793.43  0.17%     -    0s
     0     0 -139766.53    0   19 -139561.81 -139766.53  0.15%     -    0s
     0     0 -139752.53    0   20 -139561.81 -139752.53  0.14%     -    0s
     0     0 -139746.97    0   19 -139561.81 -139746.97  0.13%     -    0s
     0     0 -139745.95    0   19 -139561.81 -139745.95  0.13%     -    0s
     0     0 -139745.19    0   19 -139561.81 -139745.19  0.13%     -    0s
     0     0 -139594.68    0    4 -139561.81 -139594.68  0.02%     -    0s
H    0     0                    -139590.8003 -139592.98  0.00%     -    0s
     0     0     cutoff    0      -139590.80 -139590.80  0.00%     -    0s

Cutting planes:
  Gomory: 33
  Implied bound: 3
  MIR: 101
  Flow cover: 4
  RLT: 66
  Relax-and-lift: 6
  BQP: 1

Explored 1 nodes (645 simplex iterations) in 0.06 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -139591 -139562 -136979 ... 1.41013e+13
No other solutions better than -139591

Optimal solution found (tolerance 1.00e-06)
Best objective -1.395908002961e+05, best bound -1.395908002961e+05, gap 0.0000%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 175572.06
  Scenario: 26 demand increases, 34 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -139590.80
  [DEBUG]   S×d_nominal = 315162.86
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 315162.86 + -139590.80 = 175572.06
  [DEBUG]   Current θ from Master = 187597.46
  [DEBUG]   ⚠️  Z_SP ≤ θ by 12025.41 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 22786.58
  Lower Bound (LB) = 28468.08
  Gap (UB-LB) = 6343.9003, Absolute Gap = 6343.9003, Relative Gap = 0.182233
  Not converged yet (gap = 6343.90 > ε = 200)

  [DEBUG] Adding NEW scenario 10 to Master Problem...
  [DEBUG] New scenario pattern: 26 increases, 34 decreases
    [DEBUG] Scenario 10 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 10 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 10]
    [DEBUG]   - Total constraints in model: 169573
    [DEBUG]   - Total variables in model: 70900
  [DEBUG] Total scenarios in Master: 11
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 11
================================================================================
[Iteration 11] Solving Master Problem...
  Current scenarios in Master: 11
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 169573 rows, 70900 columns and 481060 nonzeros
Model fingerprint: 0x81c7b725
Variable types: 68641 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 77770 rows and 31570 columns
Presolve time: 3.29s
Presolved: 91803 rows, 39330 columns, 558907 nonzeros
Variable types: 37071 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -340071.5881
Found heuristic solution: objective -170353.9630

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.27s

Barrier statistics:
 Dense cols : 620
 AA' NZ     : 3.175e+06
 Factor NZ  : 7.276e+06 (roughly 110 MB of memory)
 Factor Ops : 1.305e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.59370878e+07  1.76983503e+08  1.11e+05 1.75e+01  7.82e+04     5s
   1  -1.20812467e+07  1.62034977e+08  7.75e+04 7.19e+01  5.41e+04     5s
   2  -4.49161919e+06  1.18941053e+08  2.90e+04 3.87e+00  2.16e+04     5s
   3  -7.38209620e+05  9.36750487e+07  1.28e+03 1.74e+00  1.48e+03     5s
   4  -4.86339627e+05  6.88756124e+07  3.46e+02 1.21e+00  6.45e+02     5s
   5  -3.85711484e+05  3.88528867e+07  1.17e+02 6.20e-01  3.02e+02     5s
   6  -3.32860407e+05  2.74495066e+07  4.39e+01 4.20e-01  1.88e+02     5s
   7  -2.82328334e+05  2.00450959e+07  1.11e+01 2.98e-01  1.25e+02     5s
   8  -2.23785750e+05  8.55549160e+06  1.22e+00 1.39e-01  5.24e+01     6s
   9  -1.08482308e+05  4.03926659e+06  2.13e-01 6.48e-02  2.46e+01     6s
  10  -4.50540276e+04  1.51513197e+06  9.09e-02 2.25e-02  9.26e+00     6s
  11  -6.06606235e+03  7.75977775e+05  4.22e-02 1.12e-02  4.64e+00     6s
  12   5.77980500e+03  4.54274665e+05  2.87e-02 6.23e-03  2.66e+00     6s
  13   1.51478355e+04  2.64855273e+05  1.98e-02 3.27e-03  1.48e+00     6s
  14   2.93283538e+04  1.80289668e+05  1.19e-02 1.96e-03  8.96e-01     6s
  15   3.88955968e+04  1.36703404e+05  8.25e-03 1.17e-03  5.80e-01     6s
  16   4.54297165e+04  1.17505329e+05  6.05e-03 8.45e-04  4.28e-01     6s
  17   4.89401230e+04  1.10322358e+05  4.93e-03 7.24e-04  3.64e-01     6s
  18   5.19366753e+04  1.01762994e+05  4.00e-03 5.81e-04  2.96e-01     6s
  19   5.64231124e+04  9.65264904e+04  2.69e-03 4.93e-04  2.38e-01     7s
  20   5.94363728e+04  8.59321489e+04  1.89e-03 3.08e-04  1.57e-01     7s
  21   6.21792307e+04  7.83462846e+04  1.24e-03 1.78e-04  9.59e-02     7s
  22   6.40682845e+04  7.57403040e+04  8.36e-04 1.31e-04  6.93e-02     7s
  23   6.49642356e+04  7.41226493e+04  6.50e-04 1.01e-04  5.43e-02     7s
  24   6.53763656e+04  7.33535323e+04  5.67e-04 8.71e-05  4.73e-02     7s
  25   6.61416962e+04  7.19210436e+04  4.18e-04 6.18e-05  3.43e-02     7s
  26   6.68676771e+04  7.09210046e+04  2.69e-04 4.39e-05  2.40e-02     7s
  27   6.73579398e+04  6.98323124e+04  1.81e-04 2.39e-05  1.47e-02     7s
  28   6.77659560e+04  6.93675745e+04  1.12e-04 1.53e-05  9.50e-03     8s
  29   6.79999600e+04  6.90605458e+04  7.33e-05 9.68e-06  6.29e-03     8s
  30   6.81122675e+04  6.88687189e+04  5.47e-05 6.28e-06  4.49e-03     8s
  31   6.81959707e+04  6.87361619e+04  4.19e-05 4.12e-06  3.21e-03     8s
  32   6.83471508e+04  6.86717474e+04  2.02e-05 3.04e-06  1.93e-03     8s
  33   6.84134290e+04  6.85887466e+04  1.04e-05 1.64e-06  1.04e-03     8s
  34   6.84388854e+04  6.85257250e+04  6.64e-06 5.49e-07  5.15e-04     8s
  35   6.84443457e+04  6.85175019e+04  5.95e-06 4.07e-07  4.34e-04     8s
  36   6.84731339e+04  6.85002120e+04  2.17e-06 1.28e-07  1.61e-04     8s
  37   6.84830402e+04  6.84975514e+04  9.61e-07 8.99e-08  8.61e-05     8s
  38   6.84870407e+04  6.84923233e+04  5.04e-07 1.64e-08  3.13e-05     9s
  39   6.84906222e+04  6.84917575e+04  8.23e-08 7.37e-09  6.74e-06     9s
  40   6.84914267e+04  6.84915152e+04  7.56e-09 2.33e-09  5.25e-07     9s
  41   6.84914774e+04  6.84914824e+04  3.19e-09 6.13e-11  2.96e-08     9s
  42   6.84914806e+04  6.84914806e+04  1.37e-09 2.17e-11  6.66e-11     9s

Barrier solved model in 42 iterations and 9.16 seconds (7.85 work units)
Optimal objective 6.84914806e+04


Root crossover log...

   78708 DPushes remaining with DInf 0.0000000e+00                 9s
   25722 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                13s

    1461 PPushes remaining with PInf 4.6025975e-06                13s
       0 PPushes remaining with PInf 0.0000000e+00                13s

  Push phase complete: Pinf 0.0000000e+00, Dinf 9.4762482e+00     13s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   31330    6.8491481e+04   0.000000e+00   9.476248e+00     13s
   31337    6.8491481e+04   0.000000e+00   0.000000e+00     13s
   31337    6.8491481e+04   0.000000e+00   0.000000e+00     13s
Concurrent spin time: 0.11s

Solved with barrier

Root relaxation: objective 6.849148e+04, 31337 iterations, 9.19 seconds (11.46 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 68491.4806    0  244 -170353.96 68491.4806   140%     -   13s
H    0     0                    -166115.6539 68491.4806   141%     -   13s
H    0     0                    -133534.3132 68491.4806   151%     -   14s
H    0     0                    -133030.4549 68491.4806   151%     -   14s
H    0     0                    -53554.50726 68491.4806   228%     -   14s
H    0     0                    20757.987384 68491.4806   230%     -   15s
H    0     0                    22261.230004 68491.4806   208%     -   15s
H    0     0                    23734.602424 68491.4806   189%     -   15s
H    0     0                    24400.298399 68491.4806   181%     -   16s
H    0     0                    24593.854630 68491.4806   178%     -   16s
H    0     0                    24637.783523 68491.4806   178%     -   16s
H    0     0                    25491.052714 62774.9133   146%     -   72s
H    0     0                    25497.768388 62774.9133   146%     -   72s
     0     0 62774.9133    0  249 25497.7684 62774.9133   146%     -   72s
     0     0 62298.8932    0  329 25497.7684 62298.8932   144%     -   98s
     0     0 62248.0264    0  268 25497.7684 62248.0264   144%     -  113s
     0     0 62192.7342    0  258 25497.7684 62192.7342   144%     -  120s
     0     0 62191.1225    0  321 25497.7684 62191.1225   144%     -  126s
     0     0 62191.1225    0  261 25497.7684 62191.1225   144%     -  130s
     0     0 62191.1225    0  325 25497.7684 62191.1225   144%     -  132s
     0     0 62191.1225    0  261 25497.7684 62191.1225   144%     -  136s
     0     0 62191.1225    0  324 25497.7684 62191.1225   144%     -  137s
H    0     0                    25635.122559 58356.5209   128%     -  218s
H    0     0                    25679.726190 58356.5209   127%     -  218s
H    0     0                    26147.444328 58356.5209   123%     -  218s
     0     0 58356.5209    0  312 26147.4443 58356.5209   123%     -  218s
H    0     0                    30122.014650 58356.3774  93.7%     -  219s
H    0     0                    30876.926804 58356.3774  89.0%     -  219s
H    0     0                    30894.575328 58356.3774  88.9%     -  219s
H    0     0                    31049.116344 58356.3774  87.9%     -  219s
     0     0 58043.5926    0  318 31049.1163 58043.5926  86.9%     -  259s
     0     0 57901.2085    0  334 31049.1163 57901.2085  86.5%     -  274s
     0     0 57811.8365    0  325 31049.1163 57811.8365  86.2%     -  289s
     0     0 57760.7192    0  330 31049.1163 57760.7192  86.0%     -  301s
     0     0 57741.6766    0  332 31049.1163 57741.6766  86.0%     -  308s
     0     0 57738.6647    0  331 31049.1163 57738.6647  86.0%     -  311s
     0     0 57730.5754    0  333 31049.1163 57730.5754  85.9%     -  315s
     0     0 57722.5193    0  337 31049.1163 57722.5193  85.9%     -  318s
     0     0 57708.8074    0  330 31049.1163 57708.8074  85.9%     -  322s
     0     0 57680.9081    0  300 31049.1163 57680.9081  85.8%     -  326s
     0     0 57680.0920    0  329 31049.1163 57680.0920  85.8%     -  328s
H    0     0                    31232.997321 55607.9138  78.0%     -  435s
H    0     0                    31575.292149 55607.9138  76.1%     -  435s
H    0     0                    32174.440386 55607.9138  72.8%     -  435s
H    0     0                    32243.944849 55607.9138  72.5%     -  435s
H    0     0                    32271.735963 55607.9138  72.3%     -  435s
H    0     0                    32300.003944 55607.9138  72.2%     -  435s
H    0     0                    32357.692384 55607.9138  71.9%     -  435s
H    0     0                    32422.601684 55607.9138  71.5%     -  435s
     0     0 55607.9138    0  329 32422.6017 55607.9138  71.5%     -  435s
H    0     0                    32431.479031 55607.8430  71.5%     -  436s
H    0     0                    32478.679541 55073.1848  69.6%     -  473s
     0     0 55073.1848    0  371 32478.6795 55073.1848  69.6%     -  473s
     0     0 54917.8622    0  338 32478.6795 54917.8622  69.1%     -  497s
     0     0 54873.7769    0  378 32478.6795 54873.7769  69.0%     -  512s
     0     0 54717.7072    0  330 32478.6795 54717.7072  68.5%     -  534s
     0     0 54683.0408    0  328 32478.6795 54683.0408  68.4%     -  543s
     0     0 54596.3510    0  329 32478.6795 54596.3510  68.1%     -  556s
     0     0 54563.0568    0  325 32478.6795 54563.0568  68.0%     -  565s
     0     0 54546.0338    0  336 32478.6795 54546.0338  67.9%     -  572s
     0     0 54537.0233    0  338 32478.6795 54537.0233  67.9%     -  579s
     0     0 54535.3718    0  338 32478.6795 54535.3718  67.9%     -  581s
     0     0 53622.8671    0  343 32478.6795 53622.8671  65.1%     -  643s
     0     0 53413.5407    0  384 32478.6795 53413.5407  64.5%     -  662s
     0     0 53273.7073    0  352 32478.6795 53273.7073  64.0%     -  678s
     0     0 53085.5369    0  357 32478.6795 53085.5369  63.4%     -  690s
     0     0 52987.1064    0  398 32478.6795 52987.1064  63.1%     -  706s
     0     0 52955.1904    0  400 32478.6795 52955.1904  63.0%     -  715s
     0     0 52922.8984    0  452 32478.6795 52922.8984  62.9%     -  720s
     0     0 52918.3483    0  399 32478.6795 52918.3483  62.9%     -  722s
     0     0 52881.8781    0  409 32478.6795 52881.8781  62.8%     -  726s
     0     0 52852.5208    0  402 32478.6795 52852.5208  62.7%     -  732s
     0     0 52839.5235    0  400 32478.6795 52839.5235  62.7%     -  735s
     0     0 52837.2360    0  400 32478.6795 52837.2360  62.7%     -  738s
     0     0 52684.7895    0  461 32478.6795 52684.7895  62.2%     -  755s
     0     0 52634.9336    0  471 32478.6795 52634.9336  62.1%     -  766s
     0     0 52622.5597    0  368 32478.6795 52622.5597  62.0%     -  770s
     0     0 52611.9603    0  374 32478.6795 52611.9603  62.0%     -  775s
     0     0 52602.7047    0  507 32478.6795 52602.7047  62.0%     -  781s
     0     0 52590.0930    0  375 32478.6795 52590.0930  61.9%     -  784s
     0     0 52587.0723    0  374 32478.6795 52587.0723  61.9%     -  785s
     0     0 52586.5314    0  467 32478.6795 52586.5314  61.9%     -  787s
H    0     0                    33374.737428 52586.5314  57.6%     -  788s
H    0     0                    33639.685654 52586.5314  56.3%     -  788s
H    0     0                    33760.415892 52485.9129  55.5%     -  800s
H    0     0                    33794.555510 52485.9129  55.3%     -  800s
     0     0 52485.9129    0  367 33794.5555 52485.9129  55.3%     -  800s
     0     0 52439.1767    0  464 33794.5555 52439.1767  55.2%     -  813s
     0     0 52422.6865    0  382 33794.5555 52422.6865  55.1%     -  817s
     0     0 52417.9663    0  363 33794.5555 52417.9663  55.1%     -  821s
     0     0 52415.5542    0  369 33794.5555 52415.5542  55.1%     -  823s
     0     0 52195.8636    0  469 33794.5555 52195.8636  54.5%     -  836s
     0     0 52154.8354    0  368 33794.5555 52154.8354  54.3%     -  844s
     0     0 52149.1725    0  386 33794.5555 52149.1725  54.3%     -  847s
     0     0 52144.6401    0  378 33794.5555 52144.6401  54.3%     -  850s
     0     0 52142.2180    0  378 33794.5555 52142.2180  54.3%     -  853s
     0     0 52083.2033    0  367 33794.5555 52083.2033  54.1%     -  863s
     0     0 52056.8781    0  370 33794.5555 52056.8781  54.0%     -  874s
     0     0 52044.2907    0  379 33794.5555 52044.2907  54.0%     -  878s
     0     0 52042.2779    0  378 33794.5555 52042.2779  54.0%     -  881s
     0     0 52028.8687    0  371 33794.5555 52028.8687  54.0%     -  888s
     0     0 52020.4796    0  389 33794.5555 52020.4796  53.9%     -  892s
     0     0 52013.8208    0  384 33794.5555 52013.8208  53.9%     -  894s
     0     0 52010.9093    0  379 33794.5555 52010.9093  53.9%     -  896s
     0     0 52010.0704    0  383 33794.5555 52010.0704  53.9%     -  897s
     0     0 51995.0671    0  380 33794.5555 51995.0671  53.9%     -  902s
     0     0 51990.2577    0  394 33794.5555 51990.2577  53.8%     -  909s
H    0     0                    33821.772066 51987.9629  53.7%     -  912s
     0     0 51987.9629    0  389 33821.7721 51987.9629  53.7%     -  912s
H    0     0                    33829.498950 51987.9629  53.7%     -  914s
     0     0 51970.2834    0  393 33829.4990 51970.2834  53.6%     -  917s
H    0     0                    34000.386707 51969.4497  52.8%     -  918s
     0     0 51965.8426    0  388 34000.3867 51965.8426  52.8%     -  920s
     0     0 51964.3928    0  390 34000.3867 51964.3928  52.8%     -  922s
     0     0 51933.4690    0  421 34000.3867 51933.4690  52.7%     -  931s
H    0     0                    34137.462557 51933.4051  52.1%     -  954s
H    0     0                    34222.114598 51933.4051  51.8%     -  954s
     0     0 51923.9610    0  424 34222.1146 51923.9610  51.7%     -  960s
     0     0 51919.0385    0  395 34222.1146 51919.0385  51.7%     -  964s
     0     0 51918.6242    0  390 34222.1146 51918.6242  51.7%     -  965s
     0     0 51914.4843    0  386 34222.1146 51914.4843  51.7%     -  970s
     0     0 51911.1010    0  402 34222.1146 51911.1010  51.7%     -  975s
     0     0 51910.6821    0  401 34222.1146 51910.6821  51.7%     -  975s
     0     0 51910.2096    0  404 34222.1146 51910.2096  51.7%     -  978s
     0     0 51909.9367    0  404 34222.1146 51909.9367  51.7%     -  980s
     0     2 51909.4053    0  404 34222.1146 51909.4053  51.7%     - 1217s
     1     4 51827.6104    1  378 34222.1146 51909.4053  51.7%  6829 1226s
     3     7 51750.8671    2  378 34222.1146 51825.9823  51.4%  7624 1242s
     6    13 51545.4505    3  458 34222.1146 51750.4369  51.2%  8632 1277s
    12    26 51318.3701    4  412 34222.1146 51540.4449  50.6% 12797 1303s
    25    39 49994.5088    5  456 34222.1146 51317.3224  50.0% 17300 1394s
    38    71 47557.9429    6  441 34222.1146 51317.3224  50.0% 22307 1505s
H   54    71                    34296.559663 51317.3224  49.6% 20174 1505s
    70   171 47376.7143    7  400 34296.5597 50534.9123  47.3% 22024 1566s
   170   251 47284.2595    8  389 34296.5597 50532.3412  47.3% 13122 1602s
H  208   251                    34359.416276 50532.3412  47.1% 11916 1602s
H  213   251                    34570.200366 50532.3412  46.2% 11779 1602s
   250   328 46961.0182   10  376 34570.2004 50532.3412  46.2% 10938 1636s
   327   364 46496.1194   14  327 34570.2004 50532.3412  46.2%  9609 1662s
H  338   364                    34632.643500 50532.3412  45.9%  9455 1662s
   363   427 46341.2320   15  318 34632.6435 50532.3412  45.9%  9477 1691s
   428   480 43359.1094   19  200 34632.6435 50532.3412  45.9%  9058 1716s
   481   536 46155.5988   17  349 34632.6435 50532.3412  45.9%  8915 1743s
   543   565 45274.7924   18  315 34632.6435 50532.3412  45.9%  8738 1766s
   572   591 42874.0393   19  293 34632.6435 50532.3412  45.9%  8745 1793s
   612   624 42608.4907   20  326 34632.6435 50532.3412  45.9%  8774 1817s
H  614   624                    34643.792405 50532.3412  45.9%  8764 1817s
H  618   624                    34671.268470 50532.3412  45.7%  8758 1817s
   649   694 42072.8317   22  323 34671.2685 50532.3412  45.7%  8844 1838s
   725   768 41974.0077   24  324 34671.2685 50532.3412  45.7%  8662 1859s
   821   825 40217.5437   27  222 34671.2685 50532.3412  45.7%  8235 1883s
   909   847 39799.3097   33  193 34671.2685 50532.3412  45.7%  7897 1916s
   965   882 39689.7088   34  203 34671.2685 50532.3412  45.7%  7741 1942s
  1034   934 37447.3401   36  173 34671.2685 50478.8427  45.6%  7753 1969s
  1114  1003 37217.6306   41  152 34671.2685 50478.8427  45.6%  7745 1991s
  1215  1084 36495.2076   46  131 34671.2685 50478.8427  45.6%  7574 2014s
  1334  1181 35927.4575   48   99 34671.2685 50258.0996  45.0%  7400 2040s
  1472  1205 48064.1961    8  451 34671.2685 49999.0045  44.2%  7215 2064s
H 1475  1205                    34727.428021 49999.0045  44.0%  7213 2064s
  1511  1271 47504.2865    9  383 34727.4280 49999.0045  44.0%  7273 2092s
  1639  1299 45812.9381   10  382 34727.4280 49999.0045  44.0%  7065 2117s
H 1642  1299                    34735.912936 49999.0045  43.9%  7074 2117s
H 1665  1299                    34738.824412 49999.0045  43.9%  7056 2117s
H 1678  1299                    34748.834047 49999.0045  43.9%  7120 2117s
  1685  1345 44105.1506   11  354 34748.8340 49999.0045  43.9%  7136 2150s
  1789  1398 43215.7419   13  385 34748.8340 49999.0045  43.9%  7093 2183s
  1880  1463 43134.4047   14  384 34748.8340 49999.0045  43.9%  7148 2215s
  1983  1536 42378.4045   16  440 34748.8340 49915.7028  43.6%  7156 2249s
  2092  1564 42290.9322   18  376 34748.8340 49915.7028  43.6%  7169 2274s
H 2099  1564                    34774.001746 49915.7028  43.5%  7182 2274s
  2128  1594 42012.1256   19  384 34774.0017 49915.7028  43.5%  7240 2298s
H 2143  1594                    34776.995920 49915.7028  43.5%  7254 2298s
  2162  1710 41743.0580   20  369 34776.9959 49915.7028  43.5%  7283 2332s
  2326  1793 41452.1084   23  366 34776.9959 49915.7028  43.5%  7151 2370s
  2491  1883 40773.3738   28  358 34776.9959 49870.9299  43.4%  7064 2411s
  2639  1978 40104.4626   31  336 34776.9959 49870.9299  43.4%  7034 2453s
  2782  2032 39944.3054   35  324 34776.9959 49464.3811  42.2%  7011 2500s
  2900  2075 36603.8256   38  232 34776.9959 49464.3811  42.2%  7113 2541s
H 2964  1920                    36065.465546 49464.3811  37.2%  7162 2541s
  2967  1975     cutoff   41      36065.4655 49464.3811  37.2%  7171 2592s
  3091  2036 45548.0669    7  261 36065.4655 49464.3811  37.2%  7267 2641s
  3199  2097 42914.9112   10  207 36065.4655 49464.3811  37.2%  7403 2690s
  3330  2160 37271.4839   15  182 36065.4655 49464.3811  37.2%  7518 2738s
  3471  2210     cutoff   16      36065.4655 49464.3811  37.2%  7562 2790s
  3611  2301 36733.8875   21  150 36065.4655 49104.4214  36.2%  7669 2851s
  3772  2367 43568.7060   14  312 36065.4655 49059.2346  36.0%  7751 2905s
  3866  2453 43151.6721   15  396 36065.4655 49059.2346  36.0%  7783 2960s
  4030  2479 42290.5595   16  318 36065.4655 48809.4378  35.3%  7774 3017s
  4095  2509 41391.6537   17  217 36065.4655 48809.4378  35.3%  7801 3070s
  4173  2572 39657.5545   18  319 36065.4655 48809.4378  35.3%  7834 3127s
H 4174  2561                    36093.249157 48809.4378  35.2%  7832 3127s
H 4249  2504                    36320.081437 48809.4378  34.4%  7907 3184s
  4250  2503 39200.8252   23  404 36320.0814 48809.4378  34.4%  7905 3389s
  4252  2504 37494.4864   41  227 36320.0814 48809.4378  34.4%  7901 3403s
H 4252  2378                    36421.762123 48809.4378  34.0%  7901 3484s
  4253  2379 45517.6739    8  349 36421.7621 48809.4378  34.0%  7900 3490s
  4254  2380 47107.0398    7  318 36421.7621 48809.4378  34.0%  7898 3572s

Cutting planes:
  Gomory: 50
  Implied bound: 50
  Projected implied bound: 245
  MIR: 1205
  Mixing: 19
  Flow cover: 571
  RLT: 44
  Relax-and-lift: 243

Explored 4254 nodes (34276939 simplex iterations) in 3600.03 seconds (5806.01 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 36421.8 36320.1 36093.2 ... 34727.4

Time limit reached
Best objective 3.642176212269e+04, best bound 4.880943780504e+04, gap 34.0117%
  WARNING: Time limit reached. Using best solution found (gap: 34.01%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.15s
  Master Objective (UB) = 36421.76, θ = 190623.38
  Upper Bound (UB) = 36421.76

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 190623.38
  [DEBUG]   ✓ Scenario 0: θ = 190623.38 ≤ Q = 190623.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 190623.38 ≤ Q = 190623.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 190623.38 ≤ Q = 190623.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 190623.38 ≤ Q = 190623.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 190623.38 ≤ Q = 190623.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 190623.38 ≤ Q = 190623.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 190623.38 ≤ Q = 190623.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 190623.38 ≤ Q = 190623.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 190623.38 ≤ Q = 190623.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 190623.38 ≤ Q = 190623.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 190623.38 ≤ Q = 190623.38 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 11] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x24e67552
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xdb198aae
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e-13, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [5e-15, 2e+02]
Found heuristic solution: objective 1.428606e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.01s
Presolved: 494 rows, 498 columns, 1393 nonzeros
Found heuristic solution: objective 6793476.5814
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.636811e+05, 258 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -163681.07    0  129 6793476.58 -163681.07   102%     -    0s
H    0     0                    -124680.6755 -163681.07  31.3%     -    0s
H    0     0                    -126152.3700 -163681.07  29.7%     -    0s
H    0     0                    -130202.2572 -163681.07  25.7%     -    0s
H    0     0                    -133452.3830 -147104.91  10.2%     -    0s
H    0     0                    -136388.9096 -147104.91  7.86%     -    0s
H    0     0                    -142932.4529 -147104.91  2.92%     -    0s
     0     0 -147104.91    0   87 -142932.45 -147104.91  2.92%     -    0s
     0     0 -146739.69    0   89 -142932.45 -146739.69  2.66%     -    0s
     0     0 -146730.44    0   89 -142932.45 -146730.44  2.66%     -    0s
H    0     0                    -143579.4682 -146730.44  2.19%     -    0s
     0     0 -145427.46    0   88 -143579.47 -145427.46  1.29%     -    0s
H    0     0                    -143973.8098 -145424.12  1.01%     -    0s
H    0     0                    -144178.7968 -145424.12  0.86%     -    0s
H    0     0                    -144333.7245 -145424.12  0.76%     -    0s
     0     0 -145394.84    0   87 -144333.72 -145394.84  0.74%     -    0s
     0     0 -144990.54    0   46 -144333.72 -144990.54  0.46%     -    0s
H    0     0                    -144531.1515 -144983.95  0.31%     -    0s
     0     0 -144923.98    0   53 -144531.15 -144923.98  0.27%     -    0s
     0     0 -144915.40    0   27 -144531.15 -144915.40  0.27%     -    0s
     0     0 -144782.43    0   18 -144531.15 -144782.43  0.17%     -    0s
     0     0 -144778.00    0   17 -144531.15 -144778.00  0.17%     -    0s
     0     0 -144777.88    0   18 -144531.15 -144777.88  0.17%     -    0s
     0     0 -144759.70    0   12 -144531.15 -144759.70  0.16%     -    0s
     0     0 -144758.93    0   10 -144531.15 -144758.93  0.16%     -    0s
     0     0 -144756.84    0   10 -144531.15 -144756.84  0.16%     -    0s
H    0     0                    -144541.3522 -144756.84  0.15%     -    0s
H    0     0                    -144615.6447 -144756.84  0.10%     -    0s
     0     0 -144726.89    0    7 -144615.64 -144726.89  0.08%     -    0s
     0     0 -144726.89    0   39 -144615.64 -144726.89  0.08%     -    0s
H    0     0                    -144695.2289 -144726.89  0.02%     -    0s
H    0     0                    -144698.2074 -144726.89  0.02%     -    0s
     0     0 -144724.89    0    4 -144698.21 -144724.89  0.02%     -    0s
     0     0 -144718.77    0    2 -144698.21 -144718.77  0.01%     -    0s
H    0     0                    -144705.7996 -144710.02  0.00%     -    0s
     0     0 -144710.02    0    2 -144705.80 -144710.02  0.00%     -    0s
     0     0 -144708.85    0    2 -144705.80 -144708.85  0.00%     -    0s
H    0     0                    -144707.8674 -144708.85  0.00%     -    0s

Cutting planes:
  Gomory: 8
  Implied bound: 6
  MIR: 27
  Flow cover: 8

Explored 1 nodes (827 simplex iterations) in 0.20 seconds (0.06 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -144708 -144706 -144698 ... -143974
No other solutions better than -144708

Optimal solution found (tolerance 1.00e-06)
Best objective -1.447078674485e+05, best bound -1.447078674485e+05, gap 0.0000%
  Subproblem solved in 0.24s
  Worst-case operational profit (Z_SP) = 176434.16
  Scenario: 25 demand increases, 35 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -144707.87
  [DEBUG]   S×d_nominal = 321142.03
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 321142.03 + -144707.87 = 176434.16
  [DEBUG]   Current θ from Master = 190623.38
  [DEBUG]   ⚠️  Z_SP ≤ θ by 14189.22 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 22232.54
  Lower Bound (LB) = 28468.08
  Gap (UB-LB) = 7953.6775, Absolute Gap = 7953.6775, Relative Gap = 0.218377
  Not converged yet (gap = 7953.68 > ε = 200)

  [DEBUG] Adding NEW scenario 11 to Master Problem...
  [DEBUG] New scenario pattern: 25 increases, 35 decreases
    [DEBUG] Scenario 11 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 11 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 11]
    [DEBUG]   - Total constraints in model: 184863
    [DEBUG]   - Total variables in model: 77140
  [DEBUG] Total scenarios in Master: 12
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 12
================================================================================
[Iteration 12] Solving Master Problem...
  Current scenarios in Master: 12
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 184863 rows, 77140 columns and 524291 nonzeros
Model fingerprint: 0xa6675b67
Variable types: 74881 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 84840 rows and 34440 columns
Presolve time: 3.17s
Presolved: 100023 rows, 42700 columns, 606983 nonzeros
Variable types: 40441 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -341299.9943
Found heuristic solution: objective -170353.9630

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.32s

Barrier statistics:
 Dense cols : 613
 AA' NZ     : 3.659e+06
 Factor NZ  : 8.480e+06 (roughly 130 MB of memory)
 Factor Ops : 1.584e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.59382319e+07  1.90939302e+08  1.11e+05 1.69e+01  7.78e+04     5s
   1  -1.20978754e+07  1.74906050e+08  7.74e+04 6.92e+01  5.38e+04     5s
   2  -4.71488539e+06  1.28420313e+08  3.01e+04 3.50e+00  2.22e+04     5s
   3  -8.79207807e+05  1.04624309e+08  2.09e+03 2.32e+00  2.05e+03     6s
   4  -4.34818590e+05  4.23685906e+07  5.12e+02 3.85e-01  5.45e+02     6s
   5  -3.42189356e+05  2.90176432e+07  1.85e+02 2.34e-01  2.64e+02     6s
   6  -2.86233437e+05  1.98050711e+07  6.68e+01 1.47e-01  1.43e+02     6s
   7  -2.46375744e+05  1.40752332e+07  4.05e+01 9.86e-02  9.49e+01     6s
   8  -1.21843587e+05  9.54622863e+06  3.41e+00 6.34e-02  5.38e+01     6s
   9  -6.66620569e+04  2.71559032e+06  1.11e+00 1.67e-02  1.53e+01     6s
  10  -1.40487501e+04  6.81842899e+05  4.16e-01 3.78e-03  3.81e+00     6s
  11  -2.84097718e+03  4.24451173e+05  3.34e-01 2.19e-03  2.34e+00     6s
  12   5.45640776e+03  2.70509503e+05  2.58e-01 1.53e-03  1.45e+00     6s
  13   1.77902162e+04  2.18113103e+05  1.73e-01 1.32e-03  1.09e+00     6s
  14   3.12778557e+04  1.61589817e+05  1.08e-01 9.55e-04  7.12e-01     7s
  15   3.68384961e+04  1.34567271e+05  8.62e-02 1.77e-03  5.34e-01     7s
  16   4.18335870e+04  1.20531273e+05  6.92e-02 9.47e-04  4.30e-01     7s
  17   4.85419980e+04  1.10686356e+05  4.68e-02 9.34e-04  3.39e-01     7s
  18   5.22301560e+04  1.01589907e+05  3.52e-02 1.01e-03  2.69e-01     7s
  19   5.56099347e+04  9.04164449e+04  2.53e-02 1.40e-03  1.90e-01     7s
  20   5.71574306e+04  8.48247254e+04  2.14e-02 1.06e-03  1.51e-01     7s
  21   5.92774093e+04  7.98559635e+04  1.67e-02 7.86e-04  1.12e-01     7s
  22   6.07310904e+04  7.69160155e+04  1.34e-02 6.06e-04  8.83e-02     7s
  23   6.20472882e+04  7.43735261e+04  1.07e-02 4.37e-04  6.73e-02     7s
  24   6.43230556e+04  7.23374261e+04  6.17e-03 2.99e-04  4.37e-02     8s
  25   6.52277833e+04  7.03589186e+04  4.53e-03 1.64e-04  2.80e-02     8s
  26   6.60745485e+04  6.94716590e+04  3.02e-03 1.02e-04  1.85e-02     8s
  27   6.65632115e+04  6.88502676e+04  2.18e-03 6.01e-05  1.25e-02     8s
  28   6.70239365e+04  6.84027272e+04  1.37e-03 3.04e-05  7.53e-03     8s
  29   6.74394761e+04  6.82450786e+04  7.15e-04 2.01e-05  4.40e-03     8s
  30   6.76363512e+04  6.81225977e+04  4.15e-04 1.24e-05  2.65e-03     8s
  31   6.76758369e+04  6.80582066e+04  3.54e-04 8.47e-06  2.09e-03     9s
  32   6.78077627e+04  6.79962234e+04  1.55e-04 4.58e-06  1.03e-03     9s
  33   6.78149877e+04  6.79898674e+04  1.45e-04 4.20e-06  9.54e-04     9s
  34   6.78700390e+04  6.79759214e+04  6.54e-05 3.33e-06  5.78e-04     9s
  35   6.78808202e+04  6.79591852e+04  5.07e-05 2.29e-06  4.28e-04     9s
  36   6.78930143e+04  6.79365208e+04  3.44e-05 1.03e-06  2.37e-04     9s
  37   6.79133330e+04  6.79290172e+04  7.34e-06 5.51e-07  8.56e-05     9s
  38   6.79200126e+04  6.79210856e+04  4.99e-07 3.09e-08  5.85e-06     9s
  39   6.79205634e+04  6.79205940e+04  3.92e-09 3.42e-09  1.67e-07    10s
  40   6.79205656e+04  6.79205722e+04  3.01e-09 1.52e-07  3.62e-08    10s
  41   6.79205670e+04  6.79205671e+04  3.15e-09 6.00e-10  3.96e-10    10s

Barrier solved model in 41 iterations and 10.02 seconds (8.37 work units)
Optimal objective 6.79205670e+04


Root crossover log...

   85404 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                14s

    3879 PPushes remaining with PInf 2.9557126e-05                14s
       0 PPushes remaining with PInf 0.0000000e+00                14s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.0596866e+02     14s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   38442    6.7920567e+04   0.000000e+00   3.059687e+02     14s
   38542    6.7920567e+04   0.000000e+00   0.000000e+00     15s
   38542    6.7920567e+04   0.000000e+00   0.000000e+00     15s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 6.792057e+04, 38542 iterations, 10.44 seconds (13.16 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 67920.5671    0  248 -170353.96 67920.5671   140%     -   15s
H    0     0                    -168442.0500 67920.5671   140%     -   15s
H    0     0                    -61634.99120 67920.5671   210%     -   16s
H    0     0                    18910.109513 67920.5671   259%     -   16s
H    0     0                    19484.618327 67920.5671   249%     -   16s
H    0     0                    22739.271868 67920.5671   199%     -   16s
H    0     0                    22893.478406 67920.5671   197%     -   16s
H    0     0                    23137.555028 67920.5671   194%     -   16s
H    0     0                    23239.575108 67920.5671   192%     -   16s
H    0     0                    23416.697879 67920.5671   190%     -   18s
H    0     0                    24631.380809 63060.4793   156%     -   77s
     0     0 62938.4405    0  309 24631.3808 62938.4405   156%     -   77s
H    0     0                    24724.704462 62938.4405   155%     -   78s
     0     0 62512.9301    0  326 24724.7045 62512.9301   153%     -  108s
H    0     0                    25021.799442 62351.2512   149%     -  127s
     0     0 62351.2512    0  321 25021.7994 62351.2512   149%     -  127s
     0     0 62305.3286    0  335 25021.7994 62305.3286   149%     -  136s
     0     0 62287.8702    0  336 25021.7994 62287.8702   149%     -  140s
     0     0 62263.4460    0  340 25021.7994 62263.4460   149%     -  147s
     0     0 62258.3174    0  338 25021.7994 62258.3174   149%     -  148s
     0     0 62253.1831    0  343 25021.7994 62253.1831   149%     -  151s
     0     0 62231.1151    0  340 25021.7994 62231.1151   149%     -  155s
     0     0 62229.2683    0  340 25021.7994 62229.2683   149%     -  156s
     0     0 62223.7532    0  333 25021.7994 62223.7532   149%     -  158s
     0     0 62222.7633    0  334 25021.7994 62222.7633   149%     -  159s
     0     0 62218.0976    0  340 25021.7994 62218.0976   149%     -  163s
     0     0 62216.9296    0  333 25021.7994 62216.9296   149%     -  165s
     0     0 62216.6070    0  339 25021.7994 62216.6070   149%     -  165s
     0     0 59112.4860    0  338 25021.7994 59112.4860   136%     -  238s
H    0     0                    26315.613156 59112.3768   125%     -  239s
H    0     0                    26605.919966 59112.3768   122%     -  239s
H    0     0                    26841.049125 59112.3768   120%     -  239s
H    0     0                    26859.611971 59112.3768   120%     -  239s
H    0     0                    26859.780150 59112.3768   120%     -  239s
H    0     0                    27207.603502 59112.3768   117%     -  239s
H    0     0                    27227.151334 59112.3768   117%     -  239s
     0     0 58931.7650    0  383 27227.1513 58931.7650   116%     -  257s
     0     0 58888.2330    0  392 27227.1513 58888.2330   116%     -  274s
     0     0 58852.9273    0  412 27227.1513 58852.9273   116%     -  285s
     0     0 58846.7664    0  406 27227.1513 58846.7664   116%     -  292s
     0     0 58838.1976    0  351 27227.1513 58838.1976   116%     -  295s
     0     0 58821.7082    0  346 27227.1513 58821.7082   116%     -  299s
     0     0 58811.6756    0  350 27227.1513 58811.6756   116%     -  302s
     0     0 58809.1188    0  389 27227.1513 58809.1188   116%     -  306s
     0     0 58806.0768    0  394 27227.1513 58806.0768   116%     -  309s
     0     0 58774.3506    0  355 27227.1513 58774.3506   116%     -  317s
     0     0 58771.8058    0  358 27227.1513 58771.8058   116%     -  319s
     0     0 58769.7155    0  358 27227.1513 58769.7155   116%     -  321s
     0     0 58762.4684    0  355 27227.1513 58762.4684   116%     -  324s
     0     0 58685.5387    0  407 27227.1513 58685.5387   116%     -  334s
     0     0 58683.6451    0  404 27227.1513 58683.6451   116%     -  336s
     0     0 58682.0902    0  400 27227.1513 58682.0902   116%     -  337s
     0     0 58682.0902    0  400 27227.1513 58682.0902   116%     -  338s
     0     0 56216.1931    0  298 27227.1513 56216.1931   106%     -  431s
H    0     0                    27274.335221 56216.0306   106%     -  433s
H    0     0                    27441.179426 56216.0306   105%     -  433s
H    0     0                    27737.992863 56216.0306   103%     -  433s
H    0     0                    27869.201334 56216.0306   102%     -  433s
H    0     0                    27924.545677 56216.0306   101%     -  433s
H    0     0                    27935.686426 56216.0306   101%     -  433s
H    0     0                    31285.740940 55730.2821  78.1%     -  483s
H    0     0                    32587.677137 55730.2821  71.0%     -  483s
H    0     0                    32605.799534 55730.2821  70.9%     -  483s
H    0     0                    32619.883482 55730.2821  70.8%     -  483s
H    0     0                    32645.149279 55730.2821  70.7%     -  483s
     0     0 55730.2821    0  331 32645.1493 55730.2821  70.7%     -  483s
H    0     0                    32961.969356 55549.8928  68.5%     -  508s
H    0     0                    33023.108216 55549.8928  68.2%     -  508s
H    0     0                    33040.527828 55549.8928  68.1%     -  508s
H    0     0                    33108.220038 55549.8928  67.8%     -  508s
     0     0 55549.8928    0  382 33108.2200 55549.8928  67.8%     -  508s
H    0     0                    33192.574204 55468.1792  67.1%     -  521s
     0     0 55468.1792    0  328 33192.5742 55468.1792  67.1%     -  521s
     0     0 55404.2709    0  327 33192.5742 55404.2709  66.9%     -  536s
     0     0 55362.7097    0  323 33192.5742 55362.7097  66.8%     -  548s
     0     0 55300.0234    0  326 33192.5742 55300.0234  66.6%     -  562s
     0     0 55266.1582    0  324 33192.5742 55266.1582  66.5%     -  572s
     0     0 55122.4705    0  391 33192.5742 55122.4705  66.1%     -  592s
     0     0 55064.5454    0  393 33192.5742 55064.5454  65.9%     -  606s
     0     0 55032.4365    0  398 33192.5742 55032.4365  65.8%     -  612s
     0     0 55025.9900    0  398 33192.5742 55025.9900  65.8%     -  619s
     0     0 55000.2594    0  328 33192.5742 55000.2594  65.7%     -  626s
     0     0 54990.8217    0  403 33192.5742 54990.8217  65.7%     -  630s
     0     0 54964.5929    0  401 33192.5742 54964.5929  65.6%     -  635s
     0     0 54950.3968    0  401 33192.5742 54950.3968  65.6%     -  642s
     0     0 54943.5068    0  404 33192.5742 54943.5068  65.5%     -  648s
     0     0 54916.7310    0  393 33192.5742 54916.7310  65.4%     -  655s
     0     0 54910.4072    0  401 33192.5742 54910.4072  65.4%     -  658s
     0     0 54907.5797    0  399 33192.5742 54907.5797  65.4%     -  660s
     0     0 54890.5993    0  396 33192.5742 54890.5993  65.4%     -  663s
     0     0 54889.0138    0  398 33192.5742 54889.0138  65.4%     -  665s
     0     0 53981.3222    0  360 33192.5742 53981.3222  62.6%     -  740s
     0     0 53661.7687    0  351 33192.5742 53661.7687  61.7%     -  778s
     0     0 53510.4823    0  352 33192.5742 53510.4823  61.2%     -  800s
     0     0 53401.0424    0  367 33192.5742 53401.0424  60.9%     -  816s
     0     0 53363.7852    0  412 33192.5742 53363.7852  60.8%     -  827s
     0     0 53242.4228    0  412 33192.5742 53242.4228  60.4%     -  841s
     0     0 53158.7879    0  425 33192.5742 53158.7879  60.2%     -  856s
     0     0 53138.5702    0  365 33192.5742 53138.5702  60.1%     -  862s
     0     0 53131.0649    0  369 33192.5742 53131.0649  60.1%     -  867s
     0     0 53121.7720    0  363 33192.5742 53121.7720  60.0%     -  871s
     0     0 53119.1317    0  372 33192.5742 53119.1317  60.0%     -  874s
H    0     0                    33832.728814 53102.2704  57.0%     -  881s
H    0     0                    33859.551228 53102.2704  56.8%     -  881s
H    0     0                    33860.502077 53102.2704  56.8%     -  881s
     0     0 53102.2704    0  423 33860.5021 53102.2704  56.8%     -  881s
     0     0 53081.3775    0  421 33860.5021 53081.3775  56.8%     -  891s
     0     0 53078.7039    0  429 33860.5021 53078.7039  56.8%     -  894s
     0     0 53071.9357    0  421 33860.5021 53071.9357  56.7%     -  901s
     0     0 53070.6216    0  423 33860.5021 53070.6216  56.7%     -  902s
H    0     0                    33892.834608 52777.1648  55.7%     -  936s
     0     0 52777.1648    0  391 33892.8346 52777.1648  55.7%     -  936s
     0     0 52705.3309    0  379 33892.8346 52705.3309  55.5%     -  953s
     0     0 52640.1477    0  381 33892.8346 52640.1477  55.3%     -  969s
     0     0 52609.0013    0  390 33892.8346 52609.0013  55.2%     -  983s
     0     0 52599.1736    0  381 33892.8346 52599.1736  55.2%     -  991s
     0     0 52573.8741    0  384 33892.8346 52573.8741  55.1%     -  999s
     0     0 52553.6906    0  388 33892.8346 52553.6906  55.1%     - 1008s
     0     0 52538.8554    0  392 33892.8346 52538.8554  55.0%     - 1017s
     0     0 52530.2970    0  389 33892.8346 52530.2970  55.0%     - 1022s
H    0     0                    33924.547546 52525.5478  54.8%     - 1026s
     0     0 52525.5478    0  388 33924.5475 52525.5478  54.8%     - 1026s
     0     0 52524.0278    0  392 33924.5475 52524.0278  54.8%     - 1028s
     0     0 52414.9054    0  512 33924.5475 52414.9054  54.5%     - 1058s
     0     0 52377.0705    0  524 33924.5475 52377.0705  54.4%     - 1080s
     0     0 52369.8296    0  523 33924.5475 52369.8296  54.4%     - 1087s
     0     0 52365.7676    0  533 33924.5475 52365.7676  54.4%     - 1090s
     0     0 52361.7671    0  519 33924.5475 52361.7671  54.3%     - 1094s
     0     0 52350.0762    0  517 33924.5475 52350.0762  54.3%     - 1100s
     0     0 52342.1831    0  510 33924.5475 52342.1831  54.3%     - 1105s
     0     0 52338.1548    0  524 33924.5475 52338.1548  54.3%     - 1110s
     0     0 52334.4886    0  523 33924.5475 52334.4886  54.3%     - 1114s
     0     0 52333.9268    0  524 33924.5475 52333.9268  54.3%     - 1115s
     0     0 52279.3671    0  404 33924.5475 52279.3671  54.1%     - 1130s
     0     0 52264.2495    0  365 33924.5475 52264.2495  54.1%     - 1137s
     0     0 52261.9281    0  463 33924.5475 52261.9281  54.1%     - 1138s
     0     0 52190.9249    0  472 33924.5475 52190.9249  53.8%     - 1152s
     0     0 52163.5359    0  375 33924.5475 52163.5359  53.8%     - 1160s
     0     0 52150.3715    0  371 33924.5475 52150.3715  53.7%     - 1169s
     0     0 52148.4518    0  365 33924.5475 52148.4518  53.7%     - 1171s
     0     0 52131.9889    0  405 33924.5475 52131.9889  53.7%     - 1177s
H    0     0                    34083.933839 52126.1606  52.9%     - 1182s
     0     0 52126.1606    0  369 34083.9338 52126.1606  52.9%     - 1182s
     0     0 52121.2412    0  411 34083.9338 52121.2412  52.9%     - 1186s
     0     0 52118.7691    0  424 34083.9338 52118.7691  52.9%     - 1188s
     0     0 52112.4060    0  383 34083.9338 52112.4060  52.9%     - 1194s
     0     0 52109.8272    0  380 34083.9338 52109.8272  52.9%     - 1198s
     0     0 52109.4499    0  384 34083.9338 52109.4499  52.9%     - 1199s
     0     0 52107.7452    0  373 34083.9338 52107.7452  52.9%     - 1202s
     0     0 52107.5309    0  373 34083.9338 52107.5309  52.9%     - 1205s
H    0     0                    34095.108387 52107.5309  52.8%     - 1372s
     0     2 52107.5309    0  373 34095.1084 52107.5309  52.8%     - 1377s
     1     3 51748.4032    1  373 34095.1084 52107.5309  52.8% 14771 1397s
     2     4 51964.4916    1  365 34095.1084 51964.4916  52.4% 12284 1411s
     3     7 51709.8036    2  398 34095.1084 51964.1809  52.4% 11854 1436s
     6    12 51146.3624    3  367 34095.1084 51924.0829  52.3% 12041 1586s
    11    24 50816.0155    4  356 34095.1084 51923.7853  52.3% 20083 1623s
    23    36 50886.0143    5  380 34095.1084 51608.5459  51.4% 21603 1701s
    35    68 50498.2919    6  357 34095.1084 51608.5459  51.4% 25617 2040s
    67   127 50388.6907    7  349 34095.1084 51372.6116  50.7% 27229 2111s
H  126   232                    34147.813376 51372.0681  50.4% 19750 2169s
H  130   232                    34393.993731 51372.0681  49.4% 19458 2169s
   233   300 49939.6149   10  345 34393.9937 51372.0681  49.4% 13659 2212s
H  311   352                    34413.610403 51372.0681  49.3% 12015 2247s
H  339   352                    34456.426684 51372.0681  49.1% 11706 2247s
H  357   352                    34513.620643 51372.0681  48.8% 11457 2247s
   365   404 49403.4403   13  448 34513.6206 51372.0681  48.8% 11404 2285s
   425   468 48933.8165   14  274 34513.6206 51372.0681  48.8% 11197 2320s
   493   525 42616.7243   11  245 34513.6206 51372.0681  48.8% 10686 2348s
   552   589 35127.8839   12  219 34513.6206 51372.0681  48.8% 10477 2374s
H  572   589                    34629.752922 51372.0681  48.3% 10358 2374s
   620   657     cutoff   13      34629.7529 51372.0681  48.3% 10098 2401s
   700   711 infeasible   14      34629.7529 51372.0681  48.3%  9747 2428s
   764   765 37744.3073   31  120 34629.7529 51372.0681  48.3%  9604 2451s
   832   840 37546.3674   33  146 34629.7529 51372.0681  48.3%  9284 2472s
   919   900 34851.5706   39   73 34629.7529 51372.0681  48.3%  8954 2496s
  1015   918     cutoff   41      34629.7529 51372.0681  48.3%  8652 2522s
  1051   948     cutoff   40      34629.7529 51372.0681  48.3%  8591 2545s
H 1074   948                    34663.577751 51372.0681  48.2%  8501 2545s
  1101   970 46399.5206   16  199 34663.5778 51372.0681  48.2%  8501 2570s
  1135   992 46737.6090   28  287 34663.5778 51372.0681  48.2%  8426 2597s
  1184  1009 42348.0391   29  332 34663.5778 51372.0681  48.2%  8356 2629s
  1219  1056 34974.1943   45   93 34663.5778 51372.0681  48.2%  8378 2653s
  1294  1094     cutoff   47      34663.5778 51372.0681  48.2%  8222 2683s
  1387  1118 49427.4231    9  341 34663.5778 51372.0681  48.2%  7991 2716s
H 1423  1118                    34697.645348 51372.0681  48.1%  7909 2716s
  1472  1175 49401.6353   10  344 34697.6453 51372.0681  48.1%  7918 2753s
  1549  1252 49396.9178   11  349 34697.6453 51372.0681  48.1%  8002 2791s
  1638  1330 48200.6557   12  272 34697.6453 51372.0681  48.1%  8057 2828s
  1744  1408 35983.6902   13  209 34697.6453 51372.0681  48.1%  8076 2871s
H 1763  1408                    34700.235068 51372.0681  48.0%  8114 2871s
  1848  1517 infeasible   14      34700.2351 51123.7191  47.3%  8048 2911s
  1977  1649 49475.4406    7  267 34700.2351 51123.7191  47.3%  7996 2954s
  2137  1792 48845.7937    9  260 34700.2351 51123.7191  47.3%  7858 2990s
  2314  1936 46833.4301   11  230 34700.2351 51123.7191  47.3%  7659 3035s
H 2350  1936                    34708.895296 51123.7191  47.3%  7622 3035s
  2502  2020 43878.7235   13  198 34708.8953 51123.7191  47.3%  7453 3078s
  2654  2104 39956.7882   16  171 34708.8953 50875.9826  46.6%  7454 3121s
  2800  2197 39585.7272   17  162 34708.8953 50750.2697  46.2%  7470 3168s
  2943  2320 38459.9220   22  150 34708.8953 50750.2697  46.2%  7498 3222s
  3092  2453 37285.9017   30  105 34708.8953 50750.2697  46.2%  7511 3277s
  3241  2619 35979.4987   38  149 34708.8953 50432.5509  45.3%  7535 3328s

Cutting planes:
  Gomory: 16
  Implied bound: 111
  MIR: 2650
  Flow cover: 2508
  RLT: 109
  Relax-and-lift: 678

Explored 3465 nodes (26424441 simplex iterations) in 3600.04 seconds (5586.25 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 34708.9 34700.2 34697.6 ... 34147.8

Time limit reached
Best objective 3.470889529648e+04, best bound 5.043255090578e+04, gap 45.3015%
  WARNING: Time limit reached. Using best solution found (gap: 45.30%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = 34708.90, θ = 187447.76
  Upper Bound (UB) = 34708.90

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 187447.76
  [DEBUG]   ✓ Scenario 0: θ = 187447.76 ≤ Q = 187447.76 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 187447.76 ≤ Q = 187447.76 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 187447.76 ≤ Q = 187447.76 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 187447.76 ≤ Q = 187447.76 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 187447.76 ≤ Q = 187447.76 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 187447.76 ≤ Q = 187447.76 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 187447.76 ≤ Q = 187447.76 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 187447.76 ≤ Q = 187447.76 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 187447.76 ≤ Q = 187447.76 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 187447.76 ≤ Q = 187447.76 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 187447.76 ≤ Q = 187447.76 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 187447.76 ≤ Q = 187447.76 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 12] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x1c534b90
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x1c534b90
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [2e-15, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.405032e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.01s
Presolved: 494 rows, 498 columns, 1393 nonzeros
Found heuristic solution: objective 6873114.0515
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.594408e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -159440.78    0  124 6873114.05 -159440.78   102%     -    0s
H    0     0                    -124744.3762 -159440.78  27.8%     -    0s
H    0     0                    -125775.5840 -159440.78  26.8%     -    0s
H    0     0                    -129275.9487 -141341.88  9.33%     -    0s
     0     0 -141341.88    0  126 -129275.95 -141341.88  9.33%     -    0s
H    0     0                    -135148.7467 -141194.64  4.47%     -    0s
H    0     0                    -136238.5902 -141194.64  3.64%     -    0s
     0     0 -139204.80    0  121 -136238.59 -139204.80  2.18%     -    0s
H    0     0                    -136418.7546 -139125.21  1.98%     -    0s
     0     0 -139109.71    0  127 -136418.75 -139109.71  1.97%     -    0s
     0     0 -138355.61    0  116 -136418.75 -138355.61  1.42%     -    0s
     0     0 -138318.46    0  127 -136418.75 -138318.46  1.39%     -    0s
     0     0 -137811.35    0  104 -136418.75 -137811.35  1.02%     -    0s
     0     0 -137737.28    0  113 -136418.75 -137737.28  0.97%     -    0s
     0     0 -137737.28    0  113 -136418.75 -137737.28  0.97%     -    0s
     0     0 -137448.40    0   98 -136418.75 -137448.40  0.75%     -    0s
     0     0 -137430.52    0  102 -136418.75 -137430.52  0.74%     -    0s
     0     0 -137283.79    0   77 -136418.75 -137283.79  0.63%     -    0s
     0     0 -137218.45    0   76 -136418.75 -137218.45  0.59%     -    0s
     0     0 -137218.45    0   77 -136418.75 -137218.45  0.59%     -    0s
     0     0 -137207.94    0   77 -136418.75 -137207.94  0.58%     -    0s
H    0     0                    -136420.7617 -137207.94  0.58%     -    0s
     0     2 -137207.94    0   77 -136420.76 -137207.94  0.58%     -    0s
H  102    54                    -136441.5292 -136968.87  0.39%   7.6    0s
H  159    54                    -136447.6489 -136819.99  0.27%   6.6    0s
*  898   309              34    -136448.4754 -136710.93  0.19%   4.2    0s
H 2045   803                    -136454.1966 -136648.59  0.14%   3.5    0s
H 2058   803                    -136454.4869 -136648.59  0.14%   3.5    0s
H 2063   803                    -136470.6904 -136645.99  0.13%   3.5    0s
H 2123   803                    -136471.2912 -136645.99  0.13%   3.5    0s
H 2123   803                    -136471.6514 -136645.99  0.13%   3.5    0s

Cutting planes:
  Gomory: 39
  Implied bound: 12
  MIR: 185
  Flow cover: 4
  RLT: 53
  Relax-and-lift: 8
  BQP: 5

Explored 10012 nodes (32290 simplex iterations) in 1.16 seconds (0.32 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -136472 -136471 -136471 ... -136239
No other solutions better than -136472

Optimal solution found (tolerance 1.00e-06)
Best objective -1.364716514077e+05, best bound -1.364716514077e+05, gap 0.0000%
  Subproblem solved in 1.20s
  Worst-case operational profit (Z_SP) = 178841.47
  Scenario: 60 demand increases, 0 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -136471.65
  [DEBUG]   S×d_nominal = 315313.12
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 315313.12 + -136471.65 = 178841.47
  [DEBUG]   Current θ from Master = 187447.76
  [DEBUG]   ⚠️  Z_SP ≤ θ by 8606.29 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 26102.61
  Lower Bound (LB) = 28468.08
  Gap (UB-LB) = 6240.8107, Absolute Gap = 6240.8107, Relative Gap = 0.179804
  Not converged yet (gap = 6240.81 > ε = 200)

  [DEBUG] Adding NEW scenario 12 to Master Problem...
  [DEBUG] New scenario pattern: 60 increases, 0 decreases
    [DEBUG] Scenario 12 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 12 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 12]
    [DEBUG]   - Total constraints in model: 200153
    [DEBUG]   - Total variables in model: 83380
  [DEBUG] Total scenarios in Master: 13
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 13
================================================================================
[Iteration 13] Solving Master Problem...
  Current scenarios in Master: 13
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 200153 rows, 83380 columns and 567522 nonzeros
Model fingerprint: 0xdd1a8377
Variable types: 81121 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 91910 rows and 37310 columns
Presolve time: 3.59s
Presolved: 108243 rows, 46070 columns, 654544 nonzeros
Variable types: 43811 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -347235.2356
Found heuristic solution: objective -180138.7472

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.33s

Barrier statistics:
 Dense cols : 602
 AA' NZ     : 4.202e+06
 Factor NZ  : 1.010e+07 (roughly 140 MB of memory)
 Factor Ops : 2.244e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.62894708e+07  2.05705203e+08  1.20e+05 1.63e+01  7.91e+04     5s
   1  -1.23550630e+07  1.89134193e+08  8.32e+04 7.68e+01  5.46e+04     6s
   2  -4.48030566e+06  1.38983158e+08  3.01e+04 2.99e+00  2.11e+04     6s
   3  -1.45254507e+06  1.11249019e+08  5.26e+03 2.23e+00  4.07e+03     6s
   4  -7.56357069e+05  9.07164200e+07  8.68e+02 1.49e+00  1.02e+03     6s
   5  -6.70035799e+05  6.97844727e+07  4.53e+02 1.10e+00  6.32e+02     6s
   6  -4.65161556e+05  4.47065804e+07  3.93e+02 6.23e-01  4.47e+02     6s
   7  -3.83880244e+05  3.42390033e+07  1.60e+02 4.43e-01  2.58e+02     6s
   8  -2.97966004e+05  2.17204295e+07  2.84e+01 2.61e-01  1.23e+02     6s
   9  -1.62063089e+05  1.17585482e+07  1.33e+00 1.32e-01  6.05e+01     6s
  10  -9.97972585e+04  2.75204712e+06  3.34e-01 2.72e-02  1.44e+01     6s
  11  -4.27259348e+04  1.55589824e+06  1.66e-01 1.50e-02  8.07e+00     6s
  12  -1.66158708e+04  7.30022828e+05  1.08e-01 6.76e-03  3.77e+00     6s
  13  -5.25055350e+03  4.42133119e+05  7.72e-02 3.97e-03  2.26e+00     7s
  14   1.02850559e+04  2.68709658e+05  4.41e-02 2.29e-03  1.30e+00     7s
  15   1.89099596e+04  2.17174499e+05  3.29e-02 1.62e-03  1.00e+00     7s
  16   2.54991746e+04  1.53038321e+05  2.68e-02 1.27e-03  6.44e-01     7s
  17   3.09211586e+04  1.31600397e+05  2.27e-02 9.55e-04  5.08e-01     7s
  18   3.84529504e+04  1.09283192e+05  1.74e-02 6.20e-04  3.57e-01     7s
  19   4.65109136e+04  9.56023345e+04  1.16e-02 5.06e-04  2.48e-01     7s
  20   5.23251240e+04  8.83739532e+04  7.63e-03 3.85e-04  1.82e-01     7s
  21   5.46536286e+04  8.42724230e+04  6.21e-03 3.16e-04  1.49e-01     7s
  22   5.66371754e+04  8.10859942e+04  5.00e-03 2.62e-04  1.23e-01     7s
  23   5.83099390e+04  7.75958593e+04  4.03e-03 2.10e-04  9.73e-02     8s
  24   5.99410931e+04  7.33925941e+04  3.13e-03 1.34e-04  6.79e-02     8s
  25   6.13562439e+04  7.09770081e+04  2.40e-03 1.71e-04  4.85e-02     8s
  26   6.33968846e+04  6.91209053e+04  1.35e-03 1.02e-04  2.89e-02     8s
  27   6.35773736e+04  6.80933861e+04  1.26e-03 6.65e-05  2.28e-02     8s
  28   6.43622107e+04  6.75526368e+04  8.88e-04 4.59e-05  1.61e-02     8s
  29   6.51426945e+04  6.71384978e+04  5.12e-04 2.90e-05  1.01e-02     8s
  30   6.55742358e+04  6.68641744e+04  3.10e-04 1.96e-05  6.51e-03     8s
  31   6.58186645e+04  6.66634036e+04  1.99e-04 1.27e-05  4.26e-03     9s
  32   6.59323990e+04  6.66146125e+04  1.46e-04 1.11e-05  3.44e-03     9s
  33   6.60545214e+04  6.64864233e+04  9.39e-05 6.56e-06  2.18e-03     9s
  34   6.61147832e+04  6.64343810e+04  6.86e-05 4.74e-06  1.61e-03     9s
  35   6.61515470e+04  6.63782484e+04  5.42e-05 2.90e-06  1.14e-03     9s
  36   6.62286569e+04  6.63424987e+04  2.27e-05 1.72e-06  5.74e-04     9s
  37   6.62555296e+04  6.63197950e+04  1.24e-05 9.60e-07  3.24e-04     9s
  38   6.62604402e+04  6.63082575e+04  1.07e-05 5.81e-07  2.41e-04     9s
  39   6.62653092e+04  6.62999982e+04  8.85e-06 3.06e-07  1.75e-04     9s
  40   6.62890300e+04  6.62911940e+04  3.21e-07 2.24e-08  1.09e-05    10s
  41   6.62903270e+04  6.62903771e+04  5.41e-08 8.41e-10  2.53e-07    10s
  42   6.62903496e+04  6.62903497e+04  2.71e-10 3.55e-09  2.72e-10    10s

Barrier solved model in 42 iterations and 9.88 seconds (9.26 work units)
Optimal objective 6.62903496e+04


Root crossover log...

   92531 DPushes remaining with DInf 0.0000000e+00                10s
   41629 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                14s

    2876 PPushes remaining with PInf 2.6679207e-05                14s
       0 PPushes remaining with PInf 0.0000000e+00                14s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.1740265e-01     14s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   39124    6.6290350e+04   0.000000e+00   2.174027e-01     14s
   39127    6.6290350e+04   0.000000e+00   0.000000e+00     14s
   39127    6.6290350e+04   0.000000e+00   0.000000e+00     14s
Concurrent spin time: 0.14s

Solved with barrier

Root relaxation: objective 6.629035e+04, 39127 iterations, 9.80 seconds (12.73 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 66290.3497    0  233 -180138.75 66290.3497   137%     -   15s
H    0     0                    -175900.4381 66290.3497   138%     -   15s
H    0     0                    -123691.7672 66290.3497   154%     -   15s
H    0     0                    -114096.2822 66290.3497   158%     -   16s
H    0     0                    -113624.9798 66290.3497   158%     -   16s
H    0     0                    -60566.77650 66290.3497   209%     -   16s
H    0     0                    10688.329530 66290.3497   520%     -   16s
H    0     0                    16198.928472 66290.3497   309%     -   16s
H    0     0                    16378.910024 66290.3497   305%     -   16s
H    0     0                    16464.293444 66290.3497   303%     -   17s
H    0     0                    16546.942899 66290.3497   301%     -   17s
H    0     0                    16650.502824 66290.3497   298%     -   17s
H    0     0                    18125.410701 66290.3497   266%     -   18s
H    0     0                    18962.089701 66290.3497   250%     -   18s
H    0     0                    20220.133615 66290.3497   228%     -   18s
H    0     0                    20255.736580 66290.3497   227%     -   18s
H    0     0                    20295.021577 61667.5081   204%     -   78s
H    0     0                    20295.107128 61667.5081   204%     -   78s
     0     0 61583.2345    0  362 20295.1071 61583.2345   203%     -   83s
H    0     0                    20703.542800 61583.2345   197%     -   84s
H    0     0                    20839.755209 61583.2345   196%     -   84s
H    0     0                    21172.590909 61583.2345   191%     -   84s
     0     0 61239.1096    0  362 21172.5909 61239.1096   189%     -  111s
     0     0 60930.1456    0  370 21172.5909 60930.1456   188%     -  135s
     0     0 60894.6985    0  366 21172.5909 60894.6985   188%     -  140s
     0     0 60855.5665    0  362 21172.5909 60855.5665   187%     -  156s
     0     0 60855.5665    0  349 21172.5909 60855.5665   187%     -  160s
     0     0 60855.5665    0  352 21172.5909 60855.5665   187%     -  161s
     0     0 60855.5665    0  347 21172.5909 60855.5665   187%     -  163s
     0     0 60855.5665    0  345 21172.5909 60855.5665   187%     -  165s
     0     0 60855.5665    0  345 21172.5909 60855.5665   187%     -  165s
H    0     0                    21294.473467 57293.1248   169%     -  243s
H    0     0                    21346.804464 57293.1248   168%     -  243s
H    0     0                    21375.877144 57293.1248   168%     -  243s
     0     0 57293.1248    0  380 21375.8771 57293.1248   168%     -  243s
H    0     0                    22307.969030 57292.7933   157%     -  244s
H    0     0                    22876.205627 57292.7933   150%     -  244s
H    0     0                    23573.415805 57292.7933   143%     -  244s
H    0     0                    23758.100856 57292.7933   141%     -  244s
H    0     0                    23932.160047 57292.7933   139%     -  244s
H    0     0                    24148.117575 57292.7933   137%     -  244s
     0     0 56875.5354    0  387 24148.1176 56875.5354   136%     -  286s
     0     0 56649.2028    0  379 24148.1176 56649.2028   135%     -  320s
     0     0 56521.5499    0  414 24148.1176 56521.5499   134%     -  340s
     0     0 56355.9189    0  389 24148.1176 56355.9189   133%     -  366s
     0     0 56117.5901    0  396 24148.1176 56117.5901   132%     -  392s
     0     0 56108.2360    0  403 24148.1176 56108.2360   132%     -  398s
     0     0 56101.2601    0  403 24148.1176 56101.2601   132%     -  402s
     0     0 56082.9555    0  412 24148.1176 56082.9555   132%     -  411s
     0     0 56069.2484    0  401 24148.1176 56069.2484   132%     -  414s
     0     0 56064.1342    0  414 24148.1176 56064.1342   132%     -  418s
     0     0 56057.4227    0  410 24148.1176 56057.4227   132%     -  423s
     0     0 56046.3412    0  417 24148.1176 56046.3412   132%     -  428s
     0     0 56042.0688    0  411 24148.1176 56042.0688   132%     -  429s
     0     0 56042.0134    0  411 24148.1176 56042.0134   132%     -  430s
H    0     0                    24160.973930 54601.3808   126%     -  504s
H    0     0                    24304.031782 54601.3808   125%     -  504s
H    0     0                    24477.869850 54601.3808   123%     -  504s
H    0     0                    24523.294559 54601.3808   123%     -  504s
H    0     0                    24566.686813 54601.3808   122%     -  504s
H    0     0                    24749.813951 54601.3808   121%     -  504s
H    0     0                    24849.085480 54601.3808   120%     -  504s
H    0     0                    24884.076207 54601.3808   119%     -  504s
H    0     0                    24895.953728 54601.3808   119%     -  504s
H    0     0                    24904.045794 54601.3808   119%     -  504s
H    0     0                    24939.197801 54601.3808   119%     -  504s
H    0     0                    24990.858334 54601.3808   118%     -  504s
H    0     0                    25047.503393 54601.3808   118%     -  504s
H    0     0                    25779.537207 54601.3808   112%     -  504s
H    0     0                    28091.169910 54601.3808  94.4%     -  504s
H    0     0                    28209.266958 54601.3808  93.6%     -  504s
H    0     0                    28290.527205 54601.3808  93.0%     -  504s
H    0     0                    28313.576858 54601.3808  92.8%     -  504s
H    0     0                    28354.867709 54601.3808  92.6%     -  504s
H    0     0                    28573.419770 54601.3808  91.1%     -  504s
H    0     0                    28599.526715 54601.3808  90.9%     -  504s
H    0     0                    28667.880771 54601.3808  90.5%     -  504s
H    0     0                    28674.363679 54601.3808  90.4%     -  504s
H    0     0                    28711.374564 54601.3808  90.2%     -  504s
H    0     0                    28842.221776 54601.3808  89.3%     -  504s
     0     0 54601.3808    0  386 28842.2218 54601.3808  89.3%     -  504s
H    0     0                    28878.049010 54601.2834  89.1%     -  505s
H    0     0                    29026.761451 54601.2834  88.1%     -  505s
     0     0 54113.3516    0  325 29026.7615 54113.3516  86.4%     -  546s
     0     0 53742.3759    0  408 29026.7615 53742.3759  85.1%     -  582s
     0     0 53500.8381    0  444 29026.7615 53500.8381  84.3%     -  610s
     0     0 53371.7088    0  463 29026.7615 53371.7088  83.9%     -  627s
H    0     0                    29090.081459 53210.7302  82.9%     -  643s
H    0     0                    29100.479108 53210.7302  82.9%     -  643s
     0     0 53210.7302    0  488 29100.4791 53210.7302  82.9%     -  644s
     0     0 53129.8559    0  478 29100.4791 53129.8559  82.6%     -  659s
     0     0 53117.1855    0  420 29100.4791 53117.1855  82.5%     -  666s
H    0     0                    29467.585228 53028.8978  80.0%     -  677s
H    0     0                    29556.576266 53028.8978  79.4%     -  677s
     0     0 53028.8978    0  461 29556.5763 53028.8978  79.4%     -  678s
     0     0 53004.0425    0  361 29556.5763 53004.0425  79.3%     -  685s
     0     0 52791.3935    0  466 29556.5763 52791.3935  78.6%     -  707s
     0     0 52757.8846    0  467 29556.5763 52757.8846  78.5%     -  716s
     0     0 52742.6053    0  338 29556.5763 52742.6053  78.4%     -  721s
     0     0 52738.3153    0  342 29556.5763 52738.3153  78.4%     -  725s
     0     0 52722.9942    0  343 29556.5763 52722.9942  78.4%     -  730s
     0     0 52714.2589    0  344 29556.5763 52714.2589  78.4%     -  733s
     0     0 52710.1071    0  348 29556.5763 52710.1071  78.3%     -  735s
     0     0 52688.5510    0  341 29556.5763 52688.5510  78.3%     -  739s
     0     0 52668.2268    0  342 29556.5763 52668.2268  78.2%     -  742s
     0     0 52666.1249    0  348 29556.5763 52666.1249  78.2%     -  744s
     0     0 52664.3532    0  348 29556.5763 52664.3532  78.2%     -  746s
     0     0 51750.0748    0  378 29556.5763 51750.0748  75.1%     -  788s
H    0     0                    29612.292512 51749.7769  74.8%     -  791s
     0     0 51633.3255    0  377 29612.2925 51633.3255  74.4%     -  805s
     0     0 51567.1665    0  448 29612.2925 51567.1665  74.1%     -  817s
     0     0 51425.3963    0  571 29612.2925 51425.3963  73.7%     -  836s
     0     0 51372.9637    0  382 29612.2925 51372.9637  73.5%     -  852s
     0     0 51361.4110    0  394 29612.2925 51361.4110  73.4%     -  858s
     0     0 51322.1339    0  435 29612.2925 51322.1339  73.3%     -  867s
     0     0 51316.4504    0  576 29612.2925 51316.4504  73.3%     -  871s
     0     0 51314.5263    0  574 29612.2925 51314.5263  73.3%     -  876s
     0     0 51200.9318    0  379 29612.2925 51200.9318  72.9%     -  903s
     0     0 51118.2738    0  551 29612.2925 51118.2738  72.6%     -  923s
     0     0 51080.9856    0  391 29612.2925 51080.9856  72.5%     -  933s
     0     0 51062.8338    0  403 29612.2925 51062.8338  72.4%     -  942s
     0     0 51027.7032    0  393 29612.2925 51027.7032  72.3%     -  954s
     0     0 51021.3851    0  385 29612.2925 51021.3851  72.3%     -  959s
     0     0 51010.1946    0  391 29612.2925 51010.1946  72.3%     -  963s
     0     0 51005.6935    0  386 29612.2925 51005.6935  72.2%     -  967s
     0     0 50997.2997    0  391 29612.2925 50997.2997  72.2%     -  971s
     0     0 50984.6143    0  379 29612.2925 50984.6143  72.2%     -  977s
     0     0 50980.2542    0  475 29612.2925 50980.2542  72.2%     -  983s
     0     0 50977.3483    0  478 29612.2925 50977.3483  72.1%     -  987s
     0     0 50976.1948    0  475 29612.2925 50976.1948  72.1%     -  990s
     0     0 50897.3838    0  380 29612.2925 50897.3838  71.9%     - 1006s
     0     0 50823.9291    0  458 29612.2925 50823.9291  71.6%     - 1029s
     0     0 50800.3102    0  370 29612.2925 50800.3102  71.6%     - 1040s
     0     0 50785.8371    0  385 29612.2925 50785.8371  71.5%     - 1046s
     0     0 50769.4553    0  387 29612.2925 50769.4553  71.4%     - 1054s
     0     0 50762.8788    0  390 29612.2925 50762.8788  71.4%     - 1058s
     0     0 50751.3350    0  381 29612.2925 50751.3350  71.4%     - 1068s
     0     0 50749.0954    0  391 29612.2925 50749.0954  71.4%     - 1071s
     0     0 50667.2014    0  561 29612.2925 50667.2014  71.1%     - 1089s
     0     0 50642.0592    0  375 29612.2925 50642.0592  71.0%     - 1099s
     0     0 50635.5916    0  376 29612.2925 50635.5916  71.0%     - 1102s
     0     0 50630.2290    0  379 29612.2925 50630.2290  71.0%     - 1107s
     0     0 50627.2278    0  381 29612.2925 50627.2278  71.0%     - 1111s
     0     0 50625.7675    0  379 29612.2925 50625.7675  71.0%     - 1114s
     0     0 50604.1573    0  532 29612.2925 50604.1573  70.9%     - 1124s
H    0     0                    29618.826333 50604.1361  70.9%     - 1128s
     0     0 50591.8718    0  374 29618.8263 50591.8718  70.8%     - 1134s
     0     0 50588.1631    0  384 29618.8263 50588.1631  70.8%     - 1137s
     0     0 50584.7556    0  382 29618.8263 50584.7556  70.8%     - 1140s
     0     0 50583.3006    0  382 29618.8263 50583.3006  70.8%     - 1141s
     0     0 50563.9523    0  373 29618.8263 50563.9523  70.7%     - 1146s
H    0     0                    29639.797934 50563.3048  70.6%     - 1147s
     0     0 50559.1515    0  376 29639.7979 50559.1515  70.6%     - 1151s
     0     0 50556.7056    0  375 29639.7979 50556.7056  70.6%     - 1152s
     0     0 50555.9937    0  378 29639.7979 50555.9937  70.6%     - 1154s
     0     0 50547.1147    0  376 29639.7979 50547.1147  70.5%     - 1160s
H    0     0                    29856.891462 50546.0732  69.3%     - 1165s
H    0     0                    29860.622446 50546.0732  69.3%     - 1165s
H    0     0                    29918.399270 50546.0732  68.9%     - 1165s
     0     0 50545.8944    0  374 29918.3993 50545.8944  68.9%     - 1167s
     0     0 50542.7603    0  382 29918.3993 50542.7603  68.9%     - 1172s
     0     0 50541.9321    0  382 29918.3993 50541.9321  68.9%     - 1175s
H    0     0                    29933.092891 50541.9222  68.8%     - 1392s
H    0     0                    30037.861828 50541.9222  68.3%     - 1392s
H    0     2                    30072.988238 50541.9222  68.1%     - 1395s
     0     2 50541.9222    0  382 30072.9882 50541.9222  68.1%     - 1395s
     1     3 50221.8257    1  367 30072.9882 50541.9222  68.1% 15394 1413s
     2     4 50416.0354    1  381 30072.9882 50416.0354  67.6% 12233 1426s
     3     6 50293.0267    2  455 30072.9882 50415.7230  67.6% 11673 1445s
     5    12 50145.7600    3  537 30072.9882 50415.7230  67.6%  9616 1466s
    11    24 49492.5589    4  366 30072.9882 50256.1412  67.1% 11578 1516s
    23    36 48906.6532    5  356 30072.9882 49860.4976  65.8% 21547 1600s
    35    63 46414.4154    6  351 30072.9882 49860.4976  65.8% 21402 1789s
H   39    63                    30123.700939 49860.4976  65.5% 20890 1789s
H   42    63                    30601.426722 49860.4976  62.9% 20590 1789s
H   43    63                    30670.126673 49860.4976  62.6% 20467 1789s
    62    94 47201.0999    6  475 30670.1267 49138.2981  60.2% 27328 1857s
    93   202 47153.9051    7  474 30670.1267 49125.2283  60.2% 23914 1923s
   201   256 46885.8729    9  450 30670.1267 49125.2283  60.2% 15007 1970s
   255   286 46552.5386   11  449 30670.1267 49125.2283  60.2% 14053 2013s
   285   323 46331.0532   12  404 30670.1267 49125.2283  60.2% 13459 2051s
H  292   323                    30777.072775 49125.2283  59.6% 13308 2051s
   322   381 46122.5136   14  385 30777.0728 49125.2283  59.6% 12790 2097s
   380   435 46083.3810   17  444 30777.0728 49125.2283  59.6% 12047 2141s
H  434   460                    30868.814533 49125.2283  59.1% 11578 2175s
H  435   460                    30871.395692 49125.2283  59.1% 11573 2175s
H  448   460                    30881.912268 49125.2283  59.1% 11484 2175s
H  450   460                    30891.330715 49125.2283  59.0% 11507 2175s
   459   534 45640.2857   19  383 30891.3307 49125.2283  59.0% 11464 2214s
   535   598 45544.5985   22  418 30891.3307 49125.2283  59.0% 11009 2248s
   601   651 44455.3218   23  397 30891.3307 49125.2283  59.0% 10765 2276s
   662   712 44356.0341   24  397 30891.3307 48905.0502  58.3% 10731 2314s
   725   775 43815.1800   26  405 30891.3307 48905.0502  58.3% 10683 2341s
   792   831 43411.2045   28  401 30891.3307 48905.0502  58.3% 10454 2375s
   852   859 43069.5101   30  437 30891.3307 48905.0502  58.3% 10372 2414s
   887   926 41211.1421   31  415 30891.3307 48905.0502  58.3% 10275 2444s
   962   983 40243.5103   32  348 30891.3307 48905.0502  58.3% 10180 2473s
  1041  1066 40139.6263   34  347 30891.3307 48905.0502  58.3% 10031 2503s
  1142  1142 37826.8593   37  222 30891.3307 48905.0502  58.3%  9867 2535s
H 1244  1175                    31538.573109 48905.0502  55.1%  9728 2570s
H 1256  1175                    32784.226239 48905.0502  49.2%  9695 2570s
  1297  1200 35114.6924   43  229 32784.2262 48905.0502  49.2%  9577 2609s
  1413  1227 33486.7753   49  276 32784.2262 48905.0502  49.2%  9367 2650s
  1508  1308 41291.8466   22  312 32784.2262 48905.0502  49.2%  9362 2689s
  1621  1389 40604.5713   23  410 32784.2262 48905.0502  49.2%  9264 2730s
  1736  1478 38232.7061   24  374 32784.2262 48905.0502  49.2%  9134 2774s
  1858  1549 38039.9222   25  347 32784.2262 48905.0502  49.2%  9004 2817s
  1986  1574 37643.0054   29  373 32784.2262 48905.0502  49.2%  8902 2858s
H 1999  1574                    33144.381506 48793.1241  47.2%  8952 2858s
H 2007  1574                    33173.465617 48793.1241  47.1%  8971 2858s
H 2013  1574                    33433.213996 48793.1241  45.9%  8989 2858s
H 2019  1574                    33516.404621 48793.1241  45.6%  8978 2858s
  2027  1570 37586.6516   30  362 33516.4046 48793.1241  45.6%  8959 2912s
  2082  1601 37503.0195   31  404 33516.4046 48793.1241  45.6%  8992 2958s
  2128  1650 37429.4313   32  351 33516.4046 48793.1241  45.6%  9108 3004s
  2192  1713 37404.5262   33  346 33516.4046 48793.1241  45.6%  9189 3047s
H 2246  1713                    33544.129162 48793.1241  45.5%  9242 3047s
  2255  1822 37385.6147   34  309 33544.1292 48793.1241  45.5%  9303 3092s
  2396  1884 37085.2469   40  336 33544.1292 48793.1241  45.5%  9281 3145s
  2600  1934 36304.4712   53   86 33544.1292 48793.1241  45.5%  9103 3203s
  2781  2001 infeasible   36      33544.1292 48540.5190  44.7%  8953 3265s
  2940  2033 44855.0004    9  448 33544.1292 48540.5190  44.7%  8926 3320s
H 2961  2027                    33605.650567 48540.5190  44.4%  8948 3320s
H 2983  2027                    33621.452769 48540.5190  44.4%  8994 3320s
  3016  2070 41912.4367   10  365 33621.4528 48540.5190  44.4%  8993 3377s
  3139  2132 38701.5438   11  486 33621.4528 48540.5190  44.4%  9088 3443s
  3257  2211 38302.0950   13  433 33621.4528 48478.2435  44.2%  9240 3506s
  3374  2326 36497.9214   17  415 33621.4528 48478.2435  44.2%  9439 3568s
  3527  2404 35690.7864   21  369 33621.4528 48478.2435  44.2%  9545 3600s

Cutting planes:
  Learned: 1
  Gomory: 20
  Implied bound: 264
  MIR: 3191
  Flow cover: 2934
  RLT: 114
  Relax-and-lift: 679

Explored 3649 nodes (35389794 simplex iterations) in 3600.07 seconds (5850.47 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 33621.5 33605.7 33544.1 ... 30891.3

Time limit reached
Best objective 3.362145276941e+04, best bound 4.837654371756e+04, gap 43.8859%
  WARNING: Time limit reached. Using best solution found (gap: 43.89%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.09s
  Master Objective (UB) = 33621.45, θ = 185574.24
  Upper Bound (UB) = 33621.45

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 185574.24
  [DEBUG]   ✓ Scenario 0: θ = 185574.24 ≤ Q = 185574.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 185574.24 ≤ Q = 185574.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 185574.24 ≤ Q = 185574.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 185574.24 ≤ Q = 185574.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 185574.24 ≤ Q = 185574.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 185574.24 ≤ Q = 185574.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 185574.24 ≤ Q = 185574.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 185574.24 ≤ Q = 185574.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 185574.24 ≤ Q = 185574.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 185574.24 ≤ Q = 185574.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 185574.24 ≤ Q = 185574.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 185574.24 ≤ Q = 185574.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 185574.24 ≤ Q = 185574.24 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 13] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x29f98cbe
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x29f98cbe
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.397009e+13
Presolve removed 2600 rows and 1892 columns
Presolve time: 0.01s
Presolved: 493 rows, 497 columns, 1390 nonzeros
Found heuristic solution: objective 6960698.7820
Variable types: 337 continuous, 160 integer (160 binary)

Root relaxation: objective -1.529410e+05, 245 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -152941.02    0  123 6960698.78 -152941.02   102%     -    0s
H    0     0                    -118609.9399 -152941.02  28.9%     -    0s
H    0     0                    -119604.5142 -152941.02  27.9%     -    0s
     0     0 -127443.36    0   95 -119604.51 -127443.36  6.55%     -    0s
H    0     0                    -123300.8035 -127303.97  3.25%     -    0s
H    0     0                    -124827.5238 -127303.97  1.98%     -    0s
     0     0 -126172.46    0   98 -124827.52 -126172.46  1.08%     -    0s
     0     0 -125748.36    0   72 -124827.52 -125748.36  0.74%     -    0s
H    0     0                    -125276.4097 -125740.97  0.37%     -    0s
     0     0 -125695.57    0   66 -125276.41 -125695.57  0.33%     -    0s
     0     0 -125692.41    0   67 -125276.41 -125692.41  0.33%     -    0s
     0     0 -125667.75    0   19 -125276.41 -125667.75  0.31%     -    0s
H    0     0                    -125569.3261 -125661.58  0.07%     -    0s
     0     0 -125645.96    0   17 -125569.33 -125645.96  0.06%     -    0s
     0     0 -125636.72    0    8 -125569.33 -125636.72  0.05%     -    0s
H    0     0                    -125627.3005 -125636.72  0.01%     -    0s
     0     0     cutoff    0      -125627.30 -125627.30  0.00%     -    0s

Cutting planes:
  Gomory: 12
  Implied bound: 4
  MIR: 142
  Flow cover: 9
  RLT: 29
  Relax-and-lift: 3
  BQP: 1

Explored 1 nodes (585 simplex iterations) in 0.06 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 8: -125627 -125569 -125276 ... 1.39701e+13
No other solutions better than -125627

Optimal solution found (tolerance 1.00e-06)
Best objective -1.256273005272e+05, best bound -1.256273005272e+05, gap 0.0000%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 181400.59
  Scenario: 20 demand increases, 40 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -125627.30
  [DEBUG]   S×d_nominal = 307027.89
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 307027.89 + -125627.30 = 181400.59
  [DEBUG]   Current θ from Master = 185574.24
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4173.65 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 29447.80
  Lower Bound (LB) = 29447.80
  Gap (UB-LB) = 4173.6519, Absolute Gap = 4173.6519, Relative Gap = 0.124137
  Not converged yet (gap = 4173.65 > ε = 200)

  [DEBUG] Adding NEW scenario 13 to Master Problem...
  [DEBUG] New scenario pattern: 20 increases, 40 decreases
    [DEBUG] Scenario 13 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 13 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 13]
    [DEBUG]   - Total constraints in model: 215443
    [DEBUG]   - Total variables in model: 89620
  [DEBUG] Total scenarios in Master: 14
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 14
================================================================================
[Iteration 14] Solving Master Problem...
  Current scenarios in Master: 14
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 215443 rows, 89620 columns and 610753 nonzeros
Model fingerprint: 0xaa200811
Variable types: 87361 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 98980 rows and 40180 columns
Presolve time: 3.93s
Presolved: 116463 rows, 49440 columns, 702607 nonzeros
Variable types: 47181 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -351213.2896
Found heuristic solution: objective -180138.7472

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.38s

Barrier statistics:
 Dense cols : 605
 AA' NZ     : 4.682e+06
 Factor NZ  : 1.112e+07 (roughly 160 MB of memory)
 Factor Ops : 2.262e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.67382459e+07  2.19269709e+08  1.23e+05 1.58e+01  8.09e+04     6s
   1  -1.27217576e+07  2.02255089e+08  8.55e+04 7.70e+01  5.58e+04     6s
   2  -4.68724701e+06  1.49134754e+08  3.14e+04 2.92e+00  2.19e+04     6s
   3  -9.73332368e+05  1.21134507e+08  2.58e+03 1.84e+00  2.28e+03     6s
   4  -4.76538751e+05  6.36344178e+07  6.13e+02 5.70e-01  6.64e+02     6s
   5  -4.09056032e+05  3.92975911e+07  3.57e+02 2.94e-01  3.78e+02     7s
   6  -3.14060104e+05  2.93469101e+07  7.60e+01 2.04e-01  1.77e+02     7s
   7  -2.52527707e+05  1.95457652e+07  2.33e+01 1.28e-01  1.02e+02     7s
   8  -1.31766843e+05  1.34675480e+07  8.84e-01 8.65e-02  6.41e+01     7s
   9  -7.17582683e+04  3.72237010e+06  2.77e-01 2.31e-02  1.78e+01     7s
  10  -3.55029955e+04  1.28588532e+06  1.43e-01 7.51e-03  6.21e+00     7s
  11  -9.43656383e+03  6.07491162e+05  9.37e-02 3.15e-03  2.90e+00     7s
  12   2.01830668e+03  3.66233674e+05  6.58e-02 1.87e-03  1.71e+00     7s
  13   1.25336570e+04  2.55996054e+05  4.74e-02 1.13e-03  1.14e+00     7s
  14   2.20768315e+04  1.98568009e+05  3.50e-02 1.28e-03  8.28e-01     7s
  15   2.87251672e+04  1.59153756e+05  2.80e-02 1.51e-03  6.12e-01     7s
  16   3.82291473e+04  1.28455113e+05  1.95e-02 1.06e-03  4.24e-01     8s
  17   4.39268865e+04  1.00186261e+05  1.54e-02 8.81e-04  2.64e-01     8s
  18   4.75788344e+04  9.08566799e+04  1.25e-02 6.83e-04  2.03e-01     8s
  19   4.85945503e+04  8.28614435e+04  1.18e-02 4.86e-04  1.61e-01     8s
  20   5.21683942e+04  7.86294986e+04  9.31e-03 5.93e-04  1.24e-01     8s
  21   5.46933816e+04  7.66406030e+04  7.60e-03 5.01e-04  1.03e-01     8s
  22   5.63622955e+04  7.59078705e+04  6.47e-03 4.65e-04  9.18e-02     8s
  23   5.78295177e+04  7.41245532e+04  5.50e-03 3.85e-04  7.65e-02     9s
  24   5.96870068e+04  7.25702337e+04  4.25e-03 2.97e-04  6.05e-02     9s
  25   6.08489399e+04  7.13493966e+04  3.50e-03 2.36e-04  4.93e-02     9s
  26   6.25607212e+04  7.08401548e+04  2.40e-03 2.10e-04  3.89e-02     9s
  27   6.28674588e+04  6.86681332e+04  2.20e-03 1.06e-04  2.72e-02     9s
  28   6.39614846e+04  6.82115121e+04  1.52e-03 8.21e-05  2.00e-02     9s
  29   6.45250031e+04  6.80667193e+04  1.18e-03 7.50e-05  1.66e-02     9s
  30   6.50880376e+04  6.72287972e+04  8.38e-04 3.34e-05  1.00e-02    10s
  31   6.54685700e+04  6.69804562e+04  6.25e-04 2.03e-05  7.10e-03    10s
  32   6.59249803e+04  6.68303264e+04  3.54e-04 1.32e-05  4.25e-03    10s
  33   6.59735601e+04  6.67991609e+04  3.27e-04 1.16e-05  3.88e-03    10s
  34   6.60065525e+04  6.67678956e+04  3.08e-04 1.00e-05  3.57e-03    10s
  35   6.62101300e+04  6.66957605e+04  1.91e-04 6.21e-06  2.28e-03    10s
  36   6.63950885e+04  6.66361055e+04  9.04e-05 3.26e-06  1.13e-03    10s
  37   6.64793645e+04  6.66177329e+04  4.54e-05 2.31e-06  6.50e-04    11s
  38   6.65007783e+04  6.66050009e+04  3.47e-05 1.65e-06  4.89e-04    11s
  39   6.65271250e+04  6.65877850e+04  2.15e-05 8.14e-07  2.85e-04    11s
  40   6.65279109e+04  6.65808069e+04  2.11e-05 4.92e-07  2.48e-04    11s
  41   6.65479176e+04  6.65750695e+04  1.08e-05 1.46e-06  1.27e-04    11s
  42   6.65503473e+04  6.65749734e+04  9.59e-06 1.43e-06  1.16e-04    11s
  43   6.65569778e+04  6.65732962e+04  6.33e-06 8.42e-07  7.66e-05    11s
  44   6.65586292e+04  6.65721995e+04  5.56e-06 5.44e-07  6.37e-05    12s
  45   6.65650720e+04  6.65713791e+04  2.41e-06 4.82e-07  2.96e-05    12s
  46   6.65685785e+04  6.65705942e+04  7.29e-07 3.23e-07  9.46e-06    12s
  47   6.65687168e+04  6.65704739e+04  6.67e-07 1.54e-07  8.25e-06    12s
  48   6.65700514e+04  6.65704292e+04  1.20e-07 9.61e-08  1.77e-06    12s
  49   6.65703008e+04  6.65703718e+04  2.43e-08 7.28e-09  3.33e-07    12s
  50   6.65703594e+04  6.65703668e+04  4.27e-08 7.52e-08  3.49e-08    13s
  51   6.65703662e+04  6.65703663e+04  4.43e-08 1.22e-09  4.71e-10    13s

Barrier solved model in 51 iterations and 12.73 seconds (11.84 work units)
Optimal objective 6.65703662e+04


Root crossover log...

   99997 DPushes remaining with DInf 0.0000000e+00                13s
   22661 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                19s

    7213 PPushes remaining with PInf 4.7964963e-05                19s
     476 PPushes remaining with PInf 2.3949495e-05                20s
       0 PPushes remaining with PInf 0.0000000e+00                20s

  Push phase complete: Pinf 0.0000000e+00, Dinf 7.8554755e+03     20s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   50526    6.6570366e+04   0.000000e+00   7.855475e+03     20s
   50696    6.6570366e+04   0.000000e+00   0.000000e+00     20s
   50696    6.6570366e+04   0.000000e+00   0.000000e+00     21s
Concurrent spin time: 3.12s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 6.657037e+04, 50696 iterations, 18.81 seconds (22.92 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 66570.3663    0  239 -180138.75 66570.3663   137%     -   24s
H    0     0                    -177152.2664 66570.3663   138%     -   24s
H    0     0                    -175659.6062 66570.3663   138%     -   25s
H    0     0                    -158092.3227 66570.3663   142%     -   25s
H    0     0                    -148597.3837 66570.3663   145%     -   26s
H    0     0                    -148098.3997 66570.3663   145%     -   26s
H    0     0                    -147822.0560 66570.3663   145%     -   26s
H    0     0                    -143907.3600 66570.3663   146%     -   27s
H    0     0                    -143756.9560 66570.3663   146%     -   27s
H    0     0                    -73393.76020 66570.3663   191%     -   27s
H    0     0                    -73267.99640 66570.3663   191%     -   27s
H    0     0                    -18389.71175 66570.3663   462%     -   27s
H    0     0                    3893.1343422 66570.3663  1610%     -   27s
H    0     0                    5189.5502437 66570.3663  1183%     -   27s
H    0     0                    7405.6176463 66570.3663   799%     -   28s
H    0     0                    7431.6494551 66570.3663   796%     -   28s
H    0     0                    7511.3891040 66570.3663   786%     -   28s
H    0     0                    14516.760406 61391.1828   323%     -  115s
H    0     0                    15946.109759 61391.1828   285%     -  115s
H    0     0                    16319.241235 61391.1828   276%     -  115s
H    0     0                    16423.647731 61391.1828   274%     -  115s
     0     0 61391.1828    0  351 16423.6477 61391.1828   274%     -  116s
H    0     0                    16437.137385 61389.8942   273%     -  117s
H    0     0                    16443.930300 61389.8942   273%     -  129s
     0     0 60637.5172    0  361 16443.9303 60637.5172   269%     -  160s
     0     0 60637.5172    0  362 16443.9303 60637.5172   269%     -  163s
     0     0 60637.5172    0  368 16443.9303 60637.5172   269%     -  168s
     0     0 60629.5388    0  371 16443.9303 60629.5388   269%     -  179s
     0     0 60620.0058    0  378 16443.9303 60620.0058   269%     -  182s
     0     0 60618.5855    0  371 16443.9303 60618.5855   269%     -  183s
     0     0 60616.6578    0  369 16443.9303 60616.6578   269%     -  184s
     0     0 60616.6576    0  371 16443.9303 60616.6576   269%     -  184s
H    0     0                    20468.445688 57089.1378   179%     -  289s
H    0     0                    21902.560987 57089.1378   161%     -  289s
H    0     0                    22386.501202 57089.1378   155%     -  289s
H    0     0                    22416.350996 57089.1378   155%     -  289s
H    0     0                    22496.825875 57089.1378   154%     -  289s
H    0     0                    22499.890892 57089.1378   154%     -  289s
H    0     0                    22563.212199 57089.1378   153%     -  289s
     0     0 57089.1378    0  392 22563.2122 57089.1378   153%     -  289s
H    0     0                    28199.810446 57089.1225   102%     -  290s
H    0     0                    28211.926980 57089.1225   102%     -  290s
H    0     0                    28310.864745 57089.1225   102%     -  290s
     0     0 56382.5410    0  413 28310.8647 56382.5410  99.2%     -  354s
     0     0 56227.9547    0  428 28310.8647 56227.9547  98.6%     -  387s
     0     0 56124.5220    0  395 28310.8647 56124.5220  98.2%     -  424s
     0     0 56057.4807    0  439 28310.8647 56057.4807  98.0%     -  452s
H    0     0                    28809.814298 56024.4410  94.5%     -  469s
H    0     0                    29040.588933 56024.4410  92.9%     -  469s
H    0     0                    29091.117258 56024.4410  92.6%     -  469s
     0     0 56024.4410    0  442 29091.1173 56024.4410  92.6%     -  470s
     0     0 56001.4841    0  447 29091.1173 56001.4841  92.5%     -  483s
     0     0 55964.4732    0  452 29091.1173 55964.4732  92.4%     -  497s
     0     0 55956.5649    0  431 29091.1173 55956.5649  92.3%     -  507s
     0     0 55951.0331    0  432 29091.1173 55951.0331  92.3%     -  511s
     0     0 55891.4317    0  385 29091.1173 55891.4317  92.1%     -  526s
     0     0 55852.9209    0  431 29091.1173 55852.9209  92.0%     -  539s
     0     0 55827.0921    0  448 29091.1173 55827.0921  91.9%     -  554s
     0     0 55823.1080    0  434 29091.1173 55823.1080  91.9%     -  558s
     0     0 55822.5664    0  437 29091.1173 55822.5664  91.9%     -  560s
H    0     0                    29129.410790 55822.5664  91.6%     -  584s
     0     0 54136.3139    0  329 29129.4108 54136.3139  85.8%     -  677s
H    0     0                    29134.591507 54136.3136  85.8%     -  679s
H    0     0                    29169.658706 54136.3136  85.6%     -  679s
H    0     0                    29208.115821 54136.3136  85.3%     -  679s
H    0     0                    29222.736480 54136.3136  85.3%     -  679s
H    0     0                    29226.199635 54136.3136  85.2%     -  679s
H    0     0                    29226.690985 54136.3136  85.2%     -  679s
     0     0 53727.3460    0  329 29226.6910 53727.3460  83.8%     -  720s
     0     0 53529.5237    0  458 29226.6910 53529.5237  83.2%     -  756s
     0     0 53292.6351    0  326 29226.6910 53292.6351  82.3%     -  799s
     0     0 53159.3853    0  422 29226.6910 53159.3853  81.9%     -  830s
     0     0 53078.9381    0  396 29226.6910 53078.9381  81.6%     -  856s
H    0     0                    29237.468226 53054.9677  81.5%     -  868s
H    0     0                    29240.943644 53054.9677  81.4%     -  868s
H    0     0                    29249.617264 53054.9677  81.4%     -  868s
H    0     0                    29283.442082 53054.9677  81.2%     -  868s
     0     0 53054.9677    0  424 29283.4421 53054.9677  81.2%     -  868s
     0     0 53024.2588    0  485 29283.4421 53024.2588  81.1%     -  885s
     0     0 53013.3325    0  485 29283.4421 53013.3325  81.0%     -  894s
     0     0 53001.6812    0  482 29283.4421 53001.6812  81.0%     -  902s
     0     0 52916.9242    0  488 29283.4421 52916.9242  80.7%     -  925s
     0     0 52906.4990    0  484 29283.4421 52906.4990  80.7%     -  932s
     0     0 52825.8454    0  423 29283.4421 52825.8454  80.4%     -  950s
     0     0 52796.8356    0  432 29283.4421 52796.8356  80.3%     -  960s
     0     0 52785.3269    0  358 29283.4421 52785.3269  80.3%     -  966s
     0     0 52783.2306    0  432 29283.4421 52783.2306  80.2%     -  974s
     0     0 52752.6312    0  356 29283.4421 52752.6312  80.1%     -  985s
     0     0 52734.2604    0  430 29283.4421 52734.2604  80.1%     -  993s
     0     0 52672.2221    0  445 29283.4421 52672.2221  79.9%     - 1009s
     0     0 52666.5850    0  432 29283.4421 52666.5850  79.9%     - 1013s
     0     0 52659.3719    0  443 29283.4421 52659.3719  79.8%     - 1017s
     0     0 52656.8959    0  450 29283.4421 52656.8959  79.8%     - 1023s
     0     0 52652.8406    0  441 29283.4421 52652.8406  79.8%     - 1025s
     0     0 52642.1330    0  445 29283.4421 52642.1330  79.8%     - 1031s
     0     0 52640.7243    0  452 29283.4421 52640.7243  79.8%     - 1033s
     0     0 51632.6852    0  347 29283.4421 51632.6852  76.3%     - 1115s
H    0     0                    29385.590083 51632.3966  75.7%     - 1116s
H    0     0                    29388.068680 51632.3966  75.7%     - 1116s
H    0     0                    29428.505638 51632.3966  75.5%     - 1116s
     0     0 51452.2348    0  410 29428.5056 51452.2348  74.8%     - 1132s
     0     0 51399.0925    0  356 29428.5056 51399.0925  74.7%     - 1142s
     0     0 51377.9584    0  353 29428.5056 51377.9584  74.6%     - 1151s
     0     0 51334.0506    0  352 29428.5056 51334.0506  74.4%     - 1162s
     0     0 51271.3933    0  358 29428.5056 51271.3933  74.2%     - 1171s
     0     0 51239.8697    0  351 29428.5056 51239.8697  74.1%     - 1179s
     0     0 51227.3896    0  347 29428.5056 51227.3896  74.1%     - 1184s
     0     0 51207.7763    0  347 29428.5056 51207.7763  74.0%     - 1189s
     0     0 51079.5510    0  520 29428.5056 51079.5510  73.6%     - 1203s
     0     0 51052.4085    0  358 29428.5056 51052.4085  73.5%     - 1212s
     0     0 51034.7592    0  517 29428.5056 51034.7592  73.4%     - 1221s
     0     0 51027.2826    0  350 29428.5056 51027.2826  73.4%     - 1224s
     0     0 51021.2834    0  354 29428.5056 51021.2834  73.4%     - 1226s
     0     0 51020.9722    0  356 29428.5056 51020.9722  73.4%     - 1227s
     0     0 50911.7274    0  484 29428.5056 50911.7274  73.0%     - 1244s
     0     0 50872.9365    0  559 29428.5056 50872.9365  72.9%     - 1255s
     0     0 50856.9560    0  549 29428.5056 50856.9560  72.8%     - 1262s
     0     0 50849.1700    0  371 29428.5056 50849.1700  72.8%     - 1266s
     0     0 50828.4934    0  553 29428.5056 50828.4934  72.7%     - 1274s
     0     0 50824.7752    0  556 29428.5056 50824.7752  72.7%     - 1279s
     0     0 50822.3345    0  549 29428.5056 50822.3345  72.7%     - 1281s
     0     0 50817.0531    0  572 29428.5056 50817.0531  72.7%     - 1284s
     0     0 50815.0620    0  550 29428.5056 50815.0620  72.7%     - 1287s
     0     0 50727.8849    0  440 29428.5056 50727.8849  72.4%     - 1307s
H    0     0                    29438.918000 50725.7999  72.3%     - 1309s
     0     0 50714.9510    0  376 29438.9180 50714.9510  72.3%     - 1321s
     0     0 50694.3088    0  380 29438.9180 50694.3088  72.2%     - 1328s
     0     0 50668.1582    0  462 29438.9180 50668.1582  72.1%     - 1340s
     0     0 50661.8341    0  462 29438.9180 50661.8341  72.1%     - 1346s
     0     0 50658.3674    0  395 29438.9180 50658.3674  72.1%     - 1349s
     0     0 50656.0839    0  391 29438.9180 50656.0839  72.1%     - 1351s
     0     0 50608.0493    0  447 29438.9180 50608.0493  71.9%     - 1363s
     0     0 50590.5681    0  440 29438.9180 50590.5681  71.8%     - 1374s
     0     0 50588.0560    0  445 29438.9180 50588.0560  71.8%     - 1380s
     0     0 50551.5779    0  370 29438.9180 50551.5779  71.7%     - 1394s
H    0     0                    29537.384788 50551.5646  71.1%     - 1395s
H    0     0                    29733.942259 50551.5646  70.0%     - 1395s
H    0     0                    29907.760408 50551.5646  69.0%     - 1395s
H    0     0                    30069.088543 50551.5646  68.1%     - 1395s
H    0     0                    30131.995513 50551.5646  67.8%     - 1395s
     0     0 50540.8853    0  386 30131.9955 50540.8853  67.7%     - 1402s
     0     0 50534.6981    0  539 30131.9955 50534.6981  67.7%     - 1414s
     0     0 50532.1984    0  524 30131.9955 50532.1984  67.7%     - 1418s
     0     0 50522.6962    0  500 30131.9955 50522.6962  67.7%     - 1431s
     0     0 50506.2894    0  504 30131.9955 50506.2894  67.6%     - 1442s
     0     0 50503.5208    0  516 30131.9955 50503.5208  67.6%     - 1448s
     0     0 50503.0856    0  512 30131.9955 50503.0856  67.6%     - 1452s
     0     0 50500.6067    0  525 30131.9955 50500.6067  67.6%     - 1460s
H    0     0                    30203.340459 50500.5470  67.2%     - 1461s
H    0     0                    30222.061795 50500.5470  67.1%     - 1462s
     0     0 50499.7101    0  524 30222.0618 50499.7101  67.1%     - 1464s
     0     0 50496.1647    0  508 30222.0618 50496.1647  67.1%     - 1472s
     0     0 50496.0241    0  508 30222.0618 50496.0241  67.1%     - 1477s
     0     2 50496.0241    0  508 30222.0618 50496.0241  67.1%     - 1668s
     1     3 50078.2604    1  478 30222.0618 50495.8026  67.1% 13618 1688s
     2     4 50355.0141    1  528 30222.0618 50355.0141  66.6% 11780 1704s
     3     5 48497.8894    2  331 30222.0618 50354.9772  66.6% 14402 1729s
     4    10 47615.1035    3  329 30222.0618 50354.9772  66.6% 15040 1750s
     9    19 47415.9789    4  340 30222.0618 50227.1908  66.2% 11577 1841s
    18    38 47365.2486    5  334 30222.0618 50060.2088  65.6% 16145 1879s
    37    51 48204.1134    5  462 30222.0618 49457.6979  63.6% 21966 2001s
    50    77 47568.5124    6  304 30222.0618 49457.6979  63.6% 25147 2068s
H   57    77                    30393.006662 49457.6979  62.7% 23875 2068s
H   67    77                    30534.500047 49457.6979  62.0% 22002 2068s
    76   179 47116.1339    7  319 30534.5000 49457.6979  62.0% 20283 2206s
   178   251 46805.4077   10  284 30534.5000 49457.6979  62.0% 13517 2261s
   250   300 46479.9808   12  320 30534.5000 49457.6979  62.0% 11208 2331s
   299   332 45840.8273   15  288 30534.5000 49457.6979  62.0% 10365 2367s
   331   364 45559.9335   16  288 30534.5000 49457.6979  62.0% 10051 2404s
   363   395 45518.2797   17  280 30534.5000 49457.6979  62.0%  9786 2440s
   394   424 45134.2565   18  266 30534.5000 49457.6979  62.0%  9816 2474s
   423   458 44715.9764   19  263 30534.5000 49457.6979  62.0%  9662 2513s
H  426   458                    30550.817462 49457.6979  61.9%  9610 2513s
H  435   458                    30604.542275 49457.6979  61.6%  9524 2513s
   457   549 44540.1516   20  357 30604.5423 49457.6979  61.6%  9491 2550s
   552   600 45090.6006   22  274 30604.5423 49457.6979  61.6%  9014 2583s
   613   646 44335.1365   22  263 30604.5423 49457.6979  61.6%  9229 2615s
   669   697 42285.3140   23  409 30604.5423 49457.6979  61.6%  9354 2645s
   738   767 42215.7016   24  305 30604.5423 49457.6979  61.6%  9265 2679s
   812   827 41362.1573   28  260 30604.5423 49457.6979  61.6%  9195 2709s
   881   876 40995.3178   29  362 30604.5423 49457.6979  61.6%  9116 2742s
   934   910 40956.5986   30  363 30604.5423 49457.6979  61.6%  9135 2773s
  1000   932 40058.3119   31  353 30604.5423 49457.6979  61.6%  9083 2902s
  1052   994 39983.9531   32  288 30604.5423 49457.6979  61.6%  9058 2936s
  1142  1074 39593.7334   34  349 30604.5423 49457.6979  61.6%  9179 2976s
  1236  1181 32204.8017   35  342 30604.5423 49457.6979  61.6%  9147 3009s
  1365  1269 31864.3969   36  299 30604.5423 49457.6979  61.6%  8941 3050s
  1494  1314 31635.7617   39  308 30604.5423 49457.6979  61.6%  8766 3090s
H 1498  1314                    30604.875855 49457.6979  61.6%  8762 3090s
  1576  1383 31251.0813   42  268 30604.8759 49457.6979  61.6%  8694 3130s
  1723  1513 30856.4682   45  333 30604.8759 49457.6979  61.6%  8460 3173s
  1894  1597 infeasible   45      30604.8759 49457.6979  61.6%  8219 3217s
  2054  1677 infeasible   31      30604.8759 48961.9098  60.0%  8081 3259s
  2221  1737 48804.8600    6  369 30604.8759 48957.0343  60.0%  7923 3305s
H 2364  1793                    30783.858040 48957.0343  59.0%  7857 3356s
H 2445  1793                    30797.054848 48957.0343  59.0%  7901 3356s
  2455  1863 47222.5033    6  341 30797.0548 48804.2767  58.5%  7943 3408s
  2577  1938 46413.4607    7  350 30797.0548 48804.2767  58.5%  8018 3462s
  2690  2005 44752.3725    8  313 30797.0548 48804.2767  58.5%  8109 3516s
  2791  2080 44287.7431    9  314 30797.0548 48654.1044  58.0%  8249 3573s
  2904  2117 31834.2485   66  248 30797.0548 48654.1044  58.0%  8349 3600s

Cutting planes:
  Learned: 2
  Implied bound: 333
  MIR: 3449
  Flow cover: 3036
  RLT: 112
  Relax-and-lift: 956

Explored 2979 nodes (25607660 simplex iterations) in 3600.09 seconds (5453.35 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 30797.1 30783.9 30604.9 ... 30132

Time limit reached
Best objective 3.079705484756e+04, best bound 4.865410435266e+04, gap 57.9830%
  WARNING: Time limit reached. Using best solution found (gap: 57.98%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.11s
  Master Objective (UB) = 30797.05, θ = 182856.54
  Upper Bound (UB) = 30797.05

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 182856.54
  [DEBUG]   ✓ Scenario 0: θ = 182856.54 ≤ Q = 182856.54 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 182856.54 ≤ Q = 182899.36 (slack: 42.82)
  [DEBUG]   ✓ Scenario 2: θ = 182856.54 ≤ Q = 182856.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 182856.54 ≤ Q = 182856.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 182856.54 ≤ Q = 182856.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 182856.54 ≤ Q = 182856.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 182856.54 ≤ Q = 182856.54 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 182856.54 ≤ Q = 182856.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 182856.54 ≤ Q = 182856.54 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 182856.54 ≤ Q = 182856.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 182856.54 ≤ Q = 182856.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 182856.54 ≤ Q = 182856.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 182856.54 ≤ Q = 182856.54 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 182856.54 ≤ Q = 182856.54 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 14] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x568dd946
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xa97226ba
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.413412e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.01s
Presolved: 494 rows, 498 columns, 1393 nonzeros
Found heuristic solution: objective 6943421.0347
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.562497e+05, 252 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -156249.68    0  124 6943421.03 -156249.68   102%     -    0s
H    0     0                    -121640.7110 -156249.68  28.5%     -    0s
H    0     0                    -122764.2887 -156249.68  27.3%     -    0s
     0     0 -136716.81    0   79 -122764.29 -136716.81  11.4%     -    0s
H    0     0                    -133666.6784 -136597.09  2.19%     -    0s
     0     0 -135472.53    0   72 -133666.68 -135472.53  1.35%     -    0s
H    0     0                    -134192.1523 -135469.83  0.95%     -    0s
     0     0 -135403.27    0   53 -134192.15 -135403.27  0.90%     -    0s
     0     0 -135395.47    0   64 -134192.15 -135395.47  0.90%     -    0s
H    0     0                    -134254.7258 -135395.47  0.85%     -    0s
     0     0 -134927.40    0   48 -134254.73 -134927.40  0.50%     -    0s
     0     0 -134870.85    0   38 -134254.73 -134870.85  0.46%     -    0s
     0     0 -134844.76    0   47 -134254.73 -134844.76  0.44%     -    0s
     0     0 -134844.76    0   47 -134254.73 -134844.76  0.44%     -    0s
     0     0 -134594.07    0   22 -134254.73 -134594.07  0.25%     -    0s
     0     0 -134438.76    0   24 -134254.73 -134438.76  0.14%     -    0s
     0     0 -134437.51    0   23 -134254.73 -134437.51  0.14%     -    0s
     0     0 -134437.32    0   23 -134254.73 -134437.32  0.14%     -    0s
     0     0 -134379.08    0   14 -134254.73 -134379.08  0.09%     -    0s
     0     0 -134379.08    0   16 -134254.73 -134379.08  0.09%     -    0s
H    0     0                    -134303.0608 -134379.08  0.06%     -    0s
     0     0 -134333.32    0    4 -134303.06 -134333.32  0.02%     -    0s
H    0     0                    -134332.5216 -134332.87  0.00%     -    0s
     0     0     cutoff    0      -134332.52 -134332.52  0.00%     -    0s

Cutting planes:
  Gomory: 2
  Implied bound: 1
  MIR: 2
  Flow cover: 10
  Relax-and-lift: 4

Explored 1 nodes (849 simplex iterations) in 0.15 seconds (0.05 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -134333 -134303 -134255 ... 1.41341e+13
No other solutions better than -134333

Optimal solution found (tolerance 1.00e-06)
Best objective -1.343325215853e+05, best bound -1.343325215853e+05, gap 0.0000%
  Subproblem solved in 0.18s
  Worst-case operational profit (Z_SP) = 173253.23
  Scenario: 34 demand increases, 26 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -134332.52
  [DEBUG]   S×d_nominal = 307585.75
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 307585.75 + -134332.52 = 173253.23
  [DEBUG]   Current θ from Master = 182856.54
  [DEBUG]   ⚠️  Z_SP ≤ θ by 9603.31 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 21193.75
  Lower Bound (LB) = 29447.80
  Gap (UB-LB) = 1349.2539, Absolute Gap = 1349.2539, Relative Gap = 0.043811
  Not converged yet (gap = 1349.25 > ε = 200)

  [DEBUG] Adding NEW scenario 14 to Master Problem...
  [DEBUG] New scenario pattern: 34 increases, 26 decreases
    [DEBUG] Scenario 14 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 14 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 14]
    [DEBUG]   - Total constraints in model: 230733
    [DEBUG]   - Total variables in model: 95860
  [DEBUG] Total scenarios in Master: 15
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 15
================================================================================
[Iteration 15] Solving Master Problem...
  Current scenarios in Master: 15
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 230733 rows, 95860 columns and 653984 nonzeros
Model fingerprint: 0x8457c795
Variable types: 93601 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 106050 rows and 43050 columns
Presolve time: 4.27s
Presolved: 124683 rows, 52810 columns, 768076 nonzeros
Variable types: 50551 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -335473.7764
Found heuristic solution: objective -180138.7472

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.44s

Barrier statistics:
 Dense cols : 624
 AA' NZ     : 5.854e+06
 Factor NZ  : 1.357e+07 (roughly 180 MB of memory)
 Factor Ops : 3.925e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.72891617e+07  2.33135435e+08  1.28e+05 1.55e+01  8.31e+04     7s
   1  -1.32444671e+07  2.15064433e+08  9.01e+04 7.47e+01  5.81e+04     7s
   2  -4.97143240e+06  1.59488472e+08  3.34e+04 1.53e+00  2.30e+04     7s
   3  -1.51601387e+06  1.30368119e+08  6.47e+03 1.38e+00  4.82e+03     7s
   4  -6.16858052e+05  8.09531536e+07  9.14e+02 4.74e-01  9.15e+02     7s
   5  -4.83642085e+05  4.59242834e+07  4.66e+02 2.18e-01  4.60e+02     7s
   6  -3.76969816e+05  3.40864432e+07  1.27e+02 1.46e-01  2.17e+02     7s
   7  -3.39985691e+05  2.45206365e+07  7.34e+01 9.93e-02  1.42e+02     7s
   8  -2.43151675e+05  1.68579081e+07  1.36e+01 6.43e-02  8.01e+01     7s
   9  -1.41584208e+05  8.16535326e+06  1.27e+00 3.22e-02  3.67e+01     8s
  10  -1.03685298e+05  2.41172830e+06  8.00e-01 9.37e-03  1.11e+01     8s
  11  -7.50114280e+04  1.33488094e+06  4.75e-01 5.12e-03  6.21e+00     8s
  12  -4.97206038e+04  7.27314291e+05  3.13e-01 2.70e-03  3.42e+00     8s
  13  -1.85255575e+04  3.39566879e+05  1.87e-01 1.45e-03  1.57e+00     8s
  14   6.05034825e+03  2.22524657e+05  1.18e-01 2.27e-03  9.51e-01     8s
  15   2.25724494e+04  1.64301823e+05  7.99e-02 2.24e-03  6.23e-01     8s
  16   3.15237997e+04  1.43806861e+05  5.94e-02 2.27e-03  4.93e-01     8s
  17   3.96199810e+04  1.11720287e+05  4.28e-02 2.26e-03  3.17e-01     8s
  18   4.38915186e+04  9.56665793e+04  3.44e-02 2.01e-03  2.28e-01     8s
  19   4.85051379e+04  9.16601776e+04  2.62e-02 1.80e-03  1.90e-01     9s
  20   5.01247454e+04  8.86588968e+04  2.35e-02 1.60e-03  1.69e-01     9s
  21   5.39187340e+04  8.02663811e+04  1.74e-02 1.03e-03  1.16e-01     9s
  22   5.71502896e+04  7.60795823e+04  1.28e-02 7.11e-04  8.32e-02     9s
  23   5.79845847e+04  7.35138402e+04  1.17e-02 5.20e-04  6.83e-02     9s
  24   5.97100255e+04  7.22012853e+04  9.33e-03 4.10e-04  5.49e-02     9s
  25   6.30764098e+04  7.00343233e+04  5.02e-03 2.30e-04  3.06e-02     9s
  26   6.48011897e+04  6.93646908e+04  2.82e-03 1.72e-04  2.01e-02     9s
  27   6.57242875e+04  6.82891999e+04  1.70e-03 1.44e-04  1.13e-02    10s
  28   6.60036990e+04  6.79148422e+04  1.35e-03 9.22e-05  8.40e-03    10s
  29   6.63687972e+04  6.78290541e+04  9.26e-04 8.06e-05  6.42e-03    10s
  30   6.66490920e+04  6.74957797e+04  6.04e-04 3.35e-05  3.72e-03    10s
  31   6.69089198e+04  6.73379211e+04  3.12e-04 1.47e-05  1.89e-03    10s
  32   6.70144809e+04  6.72858668e+04  1.99e-04 8.63e-06  1.19e-03    10s
  33   6.70870810e+04  6.72561647e+04  1.20e-04 5.35e-06  7.43e-04    10s
  34   6.71487734e+04  6.72277274e+04  5.60e-05 2.27e-06  3.47e-04    11s
  35   6.71728686e+04  6.72242924e+04  3.18e-05 1.90e-06  2.26e-04    11s
  36   6.71786796e+04  6.72196562e+04  2.61e-05 1.40e-06  1.80e-04    11s
  37   6.71964986e+04  6.72084213e+04  8.61e-06 2.76e-07  5.24e-05    11s
  38   6.72055801e+04  6.72061437e+04  1.26e-07 5.66e-07  2.47e-06    11s
  39   6.72059512e+04  6.72059530e+04  6.58e-09 4.82e-08  8.08e-09    11s
  40   6.72059525e+04  6.72059526e+04  3.11e-08 6.64e-10  3.15e-10    11s

Barrier solved model in 40 iterations and 11.37 seconds (10.77 work units)
Optimal objective 6.72059525e+04


Root crossover log...

  111807 DPushes remaining with DInf 0.0000000e+00                11s
    1344 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                15s

    3595 PPushes remaining with PInf 2.3411991e-05                15s
       0 PPushes remaining with PInf 0.0000000e+00                16s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.8713829e+00     16s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   54271    6.7205953e+04   0.000000e+00   2.871383e+00     16s
   54275    6.7205953e+04   0.000000e+00   0.000000e+00     16s
   54275    6.7205953e+04   0.000000e+00   0.000000e+00     16s
Concurrent spin time: 0.65s

Solved with barrier

Root relaxation: objective 6.720595e+04, 54275 iterations, 11.58 seconds (14.69 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 67205.9526    0  156 -180138.75 67205.9526   137%     -   17s
H    0     0                    -175900.4381 67205.9526   138%     -   17s
H    0     0                    -138588.2637 67205.9526   148%     -   18s
H    0     0                    -130333.2222 67205.9526   152%     -   18s
H    0     0                    -129048.1817 67205.9526   152%     -   19s
H    0     0                    -60625.07026 67205.9526   211%     -   20s
H    0     0                    -9207.269735 67205.9526   830%     -   20s
H    0     0                    13625.326106 67205.9526   393%     -   20s
H    0     0                    14940.287305 67205.9526   350%     -   21s
H    0     0                    21037.190109 67205.9526   219%     -   21s
H    0     0                    21321.114071 67205.9526   215%     -   21s
H    0     0                    21344.847543 67205.9526   215%     -   21s
H    0     0                    21370.701321 67205.9526   214%     -   21s
H    0     0                    21393.282513 61352.4676   187%     -   88s
H    0     0                    21423.889157 61352.4676   186%     -   88s
     0     0 61352.4676    0  191 21423.8892 61352.4676   186%     -   88s
     0     0 61040.8356    0  205 21423.8892 61040.8356   185%     -  113s
     0     0 60913.5543    0  216 21423.8892 60913.5543   184%     -  127s
     0     0 60890.8361    0  210 21423.8892 60890.8361   184%     -  132s
     0     0 60876.8831    0  207 21423.8892 60876.8831   184%     -  138s
     0     0 60876.8831    0  210 21423.8892 60876.8831   184%     -  141s
     0     0 60711.2152    0  210 21423.8892 60711.2152   183%     -  144s
     0     0 60711.2152    0  213 21423.8892 60711.2152   183%     -  148s
     0     0 60711.2152    0  211 21423.8892 60711.2152   183%     -  151s
     0     0 60711.2152    0  211 21423.8892 60711.2152   183%     -  152s
H    0     0                    21587.742460 57312.2567   165%     -  248s
     0     0 57246.3405    0  264 21587.7425 57246.3405   165%     -  249s
H    0     0                    28723.932953 57246.3405  99.3%     -  250s
H    0     0                    29043.788386 57246.3405  97.1%     -  250s
     0     0 56376.1047    0  299 29043.7884 56376.1047  94.1%     -  298s
     0     0 56147.2910    0  289 29043.7884 56147.2910  93.3%     -  320s
     0     0 55966.1984    0  287 29043.7884 55966.1984  92.7%     -  346s
     0     0 55954.9439    0  291 29043.7884 55954.9439  92.7%     -  353s
     0     0 55749.7852    0  283 29043.7884 55749.7852  92.0%     -  376s
     0     0 55696.7675    0  306 29043.7884 55696.7675  91.8%     -  390s
     0     0 55668.8542    0  308 29043.7884 55668.8542  91.7%     -  395s
     0     0 55645.6420    0  297 29043.7884 55645.6420  91.6%     -  407s
     0     0 55629.8194    0  311 29043.7884 55629.8194  91.5%     -  410s
     0     0 55611.8733    0  306 29043.7884 55611.8733  91.5%     -  416s
     0     0 55550.7162    0  316 29043.7884 55550.7162  91.3%     -  425s
     0     0 55548.5779    0  310 29043.7884 55548.5779  91.3%     -  428s
     0     0 55519.4387    0  318 29043.7884 55519.4387  91.2%     -  433s
     0     0 55514.5901    0  320 29043.7884 55514.5901  91.1%     -  436s
     0     0 55514.4519    0  320 29043.7884 55514.4519  91.1%     -  437s
H    0     0                    29218.207451 53725.0910  83.9%     -  523s
H    0     0                    29325.968603 53725.0910  83.2%     -  523s
H    0     0                    29335.335774 53725.0910  83.1%     -  523s
H    0     0                    29363.809297 53725.0910  83.0%     -  523s
H    0     0                    29503.393450 53725.0910  82.1%     -  523s
H    0     0                    29568.231445 53725.0910  81.7%     -  523s
H    0     0                    29575.567587 53725.0910  81.7%     -  523s
H    0     0                    29629.474164 53725.0910  81.3%     -  523s
     0     0 53725.0910    0  312 29629.4742 53725.0910  81.3%     -  523s
H    0     0                    29820.922818 53724.3715  80.2%     -  524s
H    0     0                    29968.007923 53724.3715  79.3%     -  524s
     0     0 53292.9361    0  335 29968.0079 53292.9361  77.8%     -  557s
     0     0 53292.8742    0  331 29968.0079 53292.8742  77.8%     -  558s
     0     0 53128.8313    0  337 29968.0079 53128.8313  77.3%     -  580s
     0     0 53051.6152    0  339 29968.0079 53051.6152  77.0%     -  593s
     0     0 52984.5422    0  346 29968.0079 52984.5422  76.8%     -  611s
     0     0 52939.3448    0  343 29968.0079 52939.3448  76.7%     -  628s
     0     0 52912.9551    0  350 29968.0079 52912.9551  76.6%     -  642s
     0     0 52893.8318    0  345 29968.0079 52893.8318  76.5%     -  650s
     0     0 52889.3451    0  342 29968.0079 52889.3451  76.5%     -  654s
     0     0 52875.1370    0  348 29968.0079 52875.1370  76.4%     -  660s
     0     0 52860.0638    0  363 29968.0079 52860.0638  76.4%     -  666s
     0     0 52844.6790    0  353 29968.0079 52844.6790  76.3%     -  672s
     0     0 52812.4524    0  352 29968.0079 52812.4524  76.2%     -  679s
     0     0 52771.1210    0  349 29968.0079 52771.1210  76.1%     -  686s
     0     0 52761.8265    0  351 29968.0079 52761.8265  76.1%     -  690s
     0     0 52758.1708    0  354 29968.0079 52758.1708  76.0%     -  692s
     0     0 52758.0663    0  358 29968.0079 52758.0663  76.0%     -  693s
     0     0 51706.1084    0  374 29968.0079 51706.1084  72.5%     -  751s
     0     0 51541.7036    0  376 29968.0079 51541.7036  72.0%     -  770s
     0     0 51350.9228    0  422 29968.0079 51350.9228  71.4%     -  791s
     0     0 51258.8464    0  390 29968.0079 51258.8464  71.0%     -  802s
     0     0 51206.3990    0  394 29968.0079 51206.3990  70.9%     -  812s
     0     0 51121.8588    0  426 29968.0079 51121.8588  70.6%     -  825s
     0     0 51091.7546    0  388 29968.0079 51091.7546  70.5%     -  834s
     0     0 51065.1325    0  391 29968.0079 51065.1325  70.4%     -  841s
     0     0 51057.6938    0  393 29968.0079 51057.6938  70.4%     -  845s
     0     0 51052.9117    0  388 29968.0079 51052.9117  70.4%     -  846s
     0     0 51051.4172    0  398 29968.0079 51051.4172  70.4%     -  849s
     0     0 50755.7385    0  368 29968.0079 50755.7385  69.4%     -  870s
     0     0 50661.1957    0  425 29968.0079 50661.1957  69.1%     -  886s
     0     0 50631.6071    0  434 29968.0079 50631.6071  69.0%     -  896s
     0     0 50627.4530    0  390 29968.0079 50627.4530  68.9%     -  898s
     0     0 50626.5521    0  438 29968.0079 50626.5521  68.9%     -  902s
     0     0 50538.7539    0  383 29968.0079 50538.7539  68.6%     -  914s
     0     0 50519.5341    0  376 29968.0079 50519.5341  68.6%     -  928s
     0     0 50514.0907    0  385 29968.0079 50514.0907  68.6%     -  933s
     0     0 50506.0100    0  386 29968.0079 50506.0100  68.5%     -  938s
     0     0 50502.7453    0  387 29968.0079 50502.7453  68.5%     -  941s
     0     0 50495.5683    0  388 29968.0079 50495.5683  68.5%     -  944s
     0     0 50492.4223    0  388 29968.0079 50492.4223  68.5%     -  946s
     0     0 50491.7035    0  396 29968.0079 50491.7035  68.5%     -  947s
     0     0 50475.1935    0  391 29968.0079 50475.1935  68.4%     -  954s
     0     0 50468.5617    0  398 29968.0079 50468.5617  68.4%     -  959s
     0     0 50459.0216    0  390 29968.0079 50459.0216  68.4%     -  967s
     0     0 50454.8975    0  388 29968.0079 50454.8975  68.4%     -  972s
     0     0 50454.5072    0  395 29968.0079 50454.5072  68.4%     -  973s
     0     0 50450.6902    0  387 29968.0079 50450.6902  68.3%     -  978s
     0     0 50447.4989    0  385 29968.0079 50447.4989  68.3%     -  985s
     0     0 50444.7751    0  376 29968.0079 50444.7751  68.3%     -  986s
     0     0 50437.5334    0  420 29968.0079 50437.5334  68.3%     -  991s
     0     0 50435.5767    0  414 29968.0079 50435.5767  68.3%     -  994s
     0     0 50418.6245    0  415 29968.0079 50418.6245  68.2%     - 1002s
     0     0 50414.3340    0  385 29968.0079 50414.3340  68.2%     - 1005s
     0     0 50412.6746    0  391 29968.0079 50412.6746  68.2%     - 1008s
     0     0 50398.8702    0  371 29968.0079 50398.8702  68.2%     - 1014s
H    0     0                    29983.897986 50398.0082  68.1%     - 1017s
     0     0 50393.9946    0  366 29983.8980 50393.9946  68.1%     - 1021s
     0     0 50392.5454    0  367 29983.8980 50392.5454  68.1%     - 1023s
     0     0 50389.4253    0  352 29983.8980 50389.4253  68.1%     - 1027s
     0     0 50388.3818    0  369 29983.8980 50388.3818  68.1%     - 1029s
     0     0 50386.3128    0  346 29983.8980 50386.3128  68.0%     - 1033s
H    0     0                    30033.708577 50385.8205  67.8%     - 1058s
H    0     0                    30077.686165 50385.8205  67.5%     - 1070s
H    0     0                    30096.927827 50385.8205  67.4%     - 1070s
     0     0 50382.1483    0  346 30096.9278 50382.1483  67.4%     - 1073s
     0     0 50382.0128    0  346 30096.9278 50382.0128  67.4%     - 1074s
     0     0 50375.9159    0  377 30096.9278 50375.9159  67.4%     - 1078s
     0     0 50375.7790    0  377 30096.9278 50375.7790  67.4%     - 1082s
     0     2 50375.7790    0  377 30096.9278 50375.7790  67.4%     - 1242s
     1     4 50348.8783    1  374 30096.9278 50375.6145  67.4%  3116 1278s
     3     7 50251.4612    2  356 30096.9278 50348.8114  67.3% 11836 1301s
     6    12 50115.5550    3  441 30096.9278 50251.3940  67.0% 11610 1340s
    11    23 49972.0298    4  431 30096.9278 50251.3940  67.0% 13533 1371s
    22    34 48414.1566    4  334 30096.9278 49971.2197  66.0% 17155 1428s
    33    65 47052.9368    5  313 30096.9278 49971.2197  66.0% 19606 1626s
H   35    65                    30150.979940 49971.2197  65.7% 19124 1626s
H   44    65                    30330.465605 49971.2197  64.8% 18322 1626s
H   49    65                    30349.150527 49971.2197  64.7% 17421 1626s
H   50    65                    30392.631206 49971.2197  64.4% 17194 1626s
H   53    65                    30400.579682 49971.2197  64.4% 16636 1626s
    64    97 46900.9541    6  306 30400.5797 49971.2197  64.4% 23152 1788s
    96   243 46897.1480    7  306 30400.5797 49971.2197  64.4% 20162 1869s
   242   311 45737.4681   11  239 30400.5797 49971.2197  64.4% 12101 1910s
   310   341 44941.9601   13  233 30400.5797 49971.2197  64.4% 10888 1934s
   340   369 44776.7067   14  224 30400.5797 49971.2197  64.4% 10893 1966s
   368   401 44697.2167   15  235 30400.5797 49971.2197  64.4% 10946 1991s
H  387   401                    30449.688981 49971.2197  64.1% 10717 1991s
   400   462 41992.7937   16  192 30449.6890 49971.2197  64.1% 10744 2024s
   475   494 41814.5813   18  191 30449.6890 49971.2197  64.1% 10156 2048s
H  486   494                    30449.718756 49971.2197  64.1% 10019 2048s
   507   526 35322.4329   19  176 30449.7188 49971.2197  64.1% 10059 2073s
   539   561 35292.9609   20  174 30449.7188 49971.2197  64.1% 10197 2093s
H  578   588                    30462.322747 49971.2197  64.0% 10080 2119s
   617   654 35152.6074   22  181 30462.3227 49971.2197  64.0%  9952 2144s
   695   715 32319.3345   26  150 30462.3227 49971.2197  64.0%  9745 2171s
   776   765     cutoff   30      30462.3227 49971.2197  64.0%  9438 2200s
   858   820 43710.1738   13  333 30462.3227 49971.2197  64.0%  9367 2229s
   929   849 43584.5327   13  239 30462.3227 49971.2197  64.0%  9322 2255s
   962   886 43197.6516   14  301 30462.3227 49971.2197  64.0%  9483 2282s
   999   924 43143.7386   15  289 30462.3227 49971.2197  64.0%  9546 2307s
  1039   976 42992.8853   17  292 30462.3227 49971.2197  64.0%  9539 2330s
H 1050   976                    30492.862153 49971.2197  63.9%  9542 2330s
  1093  1080 42876.1500   18  274 30492.8622 49971.2197  63.9%  9479 2356s
  1207  1190 42164.4659   20  281 30492.8622 49971.2197  63.9%  9213 2389s
  1337  1310 42739.8942   19  223 30492.8622 49971.2197  63.9%  8834 2415s
  1487  1437 42429.1270   20  230 30492.8622 49971.2197  63.9%  8438 2445s
  1661  1546 39682.3958   19  246 30492.8622 49971.2197  63.9%  8102 2478s
  1796  1657 36365.2633   21  295 30492.8622 49971.2197  63.9%  8031 2510s
  1929  1754 40264.1417   23  295 30492.8622 49971.2197  63.9%  7926 2540s
  2066  1806 39105.0211   24  269 30492.8622 49971.2197  63.9%  7875 2576s
H 2131  1806                    30510.171779 49971.2197  63.8%  7834 2576s
  2172  1887 36021.0469   23  205 30510.1718 49971.2197  63.8%  7862 2612s
  2273  1920 38763.4330   25  250 30510.1718 49768.9302  63.1%  7981 2645s
H 2283  1891                    31554.470933 49768.9302  57.7%  8006 2645s
  2306  1980 38240.7231   26  190 31554.4709 49768.9302  57.7%  8041 2681s
  2435  2107 infeasible   25      31554.4709 49768.9302  57.7%  8071 2718s
  2596  2250 36068.7382   28  300 31554.4709 49768.9302  57.7%  8055 2759s
  2801  2361 34460.5693   28  151 31554.4709 49768.9302  57.7%  7878 2797s
  3025  2488 31996.6391   34  136 31554.4709 49768.9302  57.7%  7680 2840s
  3276  2649 33252.4999   34  186 31554.4709 49768.9302  57.7%  7447 2890s
  3509  2706 31793.8524   40  170 31554.4709 48107.7343  52.5%  7304 2924s
H 3539  2705                    31575.832072 48107.7343  52.4%  7298 2924s
H 3544  2701                    31620.467922 48107.7343  52.1%  7311 2924s
  3576  2874     cutoff   39      31620.4679 48107.7343  52.1%  7304 2974s
H 3857  2871                    31655.438390 47840.9974  51.1%  7110 3025s
  3858  2872 37658.5228   22  377 31655.4384 47840.9974  51.1%  7108 3263s
H 3859  2729                    31757.913094 47840.9974  50.6%  7106 3280s
H 3859  2592                    31827.295850 47840.9974  50.3%  7106 3280s
H 3860  2463                    32037.825233 47840.9974  49.3%  7104 3441s
  3861  2464 39610.9250   22  305 32037.8252 47840.9974  49.3%  7103 3449s
H 3861  2340                    32100.094868 47840.9974  49.0%  7103 3546s
H 3861  2223                    32149.745855 47840.9974  48.8%  7103 3546s
H 3861  2112                    32161.737642 47840.9974  48.8%  7103 3546s

Cutting planes:
  Learned: 1
  Gomory: 22
  Implied bound: 4
  Projected implied bound: 24
  MIR: 1175
  Mixing: 1
  Flow cover: 730
  RLT: 17
  Relax-and-lift: 196

Explored 3862 nodes (28185470 simplex iterations) in 3600.06 seconds (5507.60 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 32161.7 32149.7 32100.1 ... 31554.5

Time limit reached
Best objective 3.216173764227e+04, best bound 4.784099735863e+04, gap 48.7513%
  WARNING: Time limit reached. Using best solution found (gap: 48.75%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.16s
  Master Objective (UB) = 32161.74, θ = 185786.05
  Upper Bound (UB) = 32161.74

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 185786.05
  [DEBUG]   ✓ Scenario 0: θ = 185786.05 ≤ Q = 185786.05 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 185786.05 ≤ Q = 185786.05 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 185786.05 ≤ Q = 185786.05 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 185786.05 ≤ Q = 185786.05 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 185786.05 ≤ Q = 185786.05 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 185786.05 ≤ Q = 185786.05 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 185786.05 ≤ Q = 185786.05 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 185786.05 ≤ Q = 185786.05 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 185786.05 ≤ Q = 185786.05 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 185786.05 ≤ Q = 185786.05 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 185786.05 ≤ Q = 185786.05 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 185786.05 ≤ Q = 185786.05 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 185786.05 ≤ Q = 185786.05 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 185786.05 ≤ Q = 185786.05 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 185786.05 ≤ Q = 185786.05 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 15] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x6a800e74
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x6a800e74
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.419306e+13
Presolve removed 2605 rows and 1896 columns
Presolve time: 0.01s
Presolved: 488 rows, 493 columns, 1377 nonzeros
Found heuristic solution: objective 6837661.0191
Variable types: 334 continuous, 159 integer (159 binary)

Root relaxation: objective -1.619375e+05, 239 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -161937.53    0  124 6837661.02 -161937.53   102%     -    0s
H    0     0                    -116793.8116 -161937.53  38.7%     -    0s
H    0     0                    -124511.1150 -161937.53  30.1%     -    0s
H    0     0                    -125448.7887 -161900.49  29.1%     -    0s
     0     0 -138552.09    0   99 -125448.79 -138552.09  10.4%     -    0s
H    0     0                    -133528.8917 -138472.11  3.70%     -    0s
     0     0 -137271.72    0   57 -133528.89 -137271.72  2.80%     -    0s
H    0     0                    -135773.6498 -137261.76  1.10%     -    0s
     0     0 -136746.46    0   42 -135773.65 -136746.46  0.72%     -    0s
     0     0 -136652.87    0   37 -135773.65 -136652.87  0.65%     -    0s
     0     0 -136652.44    0   38 -135773.65 -136652.44  0.65%     -    0s
     0     0 -136489.64    0   77 -135773.65 -136489.64  0.53%     -    0s
     0     0 -136487.64    0   68 -135773.65 -136487.64  0.53%     -    0s
     0     0 -136478.61    0   69 -135773.65 -136478.61  0.52%     -    0s
H    0     0                    -136136.7154 -136477.35  0.25%     -    0s
H    0     0                    -136205.1583 -136477.35  0.20%     -    0s
     0     0 -136473.13    0   69 -136205.16 -136473.13  0.20%     -    0s
     0     0 -136404.31    0   31 -136205.16 -136404.31  0.15%     -    0s
H    0     0                    -136356.9895 -136398.32  0.03%     -    0s
     0     0 -136398.32    0   28 -136356.99 -136398.32  0.03%     -    0s
     0     0 -136398.32    0   26 -136356.99 -136398.32  0.03%     -    0s
     0     0 -136392.24    0   25 -136356.99 -136392.24  0.03%     -    0s
     0     0 -136392.24    0   35 -136356.99 -136392.24  0.03%     -    0s
     0     0 -136392.24    0   35 -136356.99 -136392.24  0.03%     -    0s
     0     0 -136392.24    0    2 -136356.99 -136392.24  0.03%     -    0s
H    0     0                    -136359.4263 -136392.24  0.02%     -    0s
     0     0 -136379.13    0   25 -136359.43 -136379.13  0.01%     -    0s
*    0     0               0    -136365.5481 -136365.55  0.00%     -    0s

Cutting planes:
  Gomory: 6
  Implied bound: 1
  MIR: 32
  Flow cover: 10

Explored 1 nodes (784 simplex iterations) in 0.17 seconds (0.06 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -136366 -136359 -136357 ... -124511
No other solutions better than -136366

Optimal solution found (tolerance 1.00e-06)
Best objective -1.363655480689e+05, best bound -1.363655480689e+05, gap 0.0000%
  Subproblem solved in 0.20s
  Worst-case operational profit (Z_SP) = 179631.24
  Scenario: 8 demand increases, 52 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -136365.55
  [DEBUG]   S×d_nominal = 315996.78
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 315996.78 + -136365.55 = 179631.24
  [DEBUG]   Current θ from Master = 185786.05
  [DEBUG]   ⚠️  Z_SP ≤ θ by 6154.81 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 26006.92
  Lower Bound (LB) = 29447.80
  Gap (UB-LB) = 2713.9367, Absolute Gap = 2713.9367, Relative Gap = 0.084384
  Not converged yet (gap = 2713.94 > ε = 200)

  [DEBUG] Adding NEW scenario 15 to Master Problem...
  [DEBUG] New scenario pattern: 8 increases, 52 decreases
    [DEBUG] Scenario 15 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 15 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 15]
    [DEBUG]   - Total constraints in model: 246023
    [DEBUG]   - Total variables in model: 102100
  [DEBUG] Total scenarios in Master: 16
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 16
================================================================================
[Iteration 16] Solving Master Problem...
  Current scenarios in Master: 16
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 246023 rows, 102100 columns and 697215 nonzeros
Model fingerprint: 0x90bd5d49
Variable types: 99841 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 113120 rows and 45920 columns
Presolve time: 4.14s
Presolved: 132903 rows, 56180 columns, 818131 nonzeros
Variable types: 53921 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -335473.7764
Found heuristic solution: objective -180138.7472

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.64s

Barrier statistics:
 Dense cols : 626
 AA' NZ     : 6.507e+06
 Factor NZ  : 1.433e+07 (roughly 200 MB of memory)
 Factor Ops : 3.111e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.77195630e+07  2.46089073e+08  1.31e+05 1.51e+01  8.47e+04     8s
   1  -1.36235490e+07  2.27589443e+08  9.25e+04 7.52e+01  5.94e+04     8s
   2  -5.43546612e+06  1.68139011e+08  3.63e+04 3.58e+00  2.49e+04     8s
   3  -1.02024109e+06  1.28706445e+08  2.79e+03 1.70e+00  2.35e+03     8s
   4  -5.69614059e+05  9.52387212e+07  7.62e+02 1.04e+00  8.65e+02     8s
   5  -4.75950224e+05  4.97360500e+07  3.97e+02 4.40e-01  4.24e+02     8s
   6  -3.88521459e+05  3.59426116e+07  1.25e+02 2.94e-01  2.13e+02     8s
   7  -3.53346424e+05  2.54089137e+07  7.12e+01 1.95e-01  1.38e+02     8s
   8  -2.57825434e+05  1.74588675e+07  8.18e+00 1.26e-01  7.60e+01     9s
   9  -1.37121526e+05  8.59381432e+06  5.80e-02 6.18e-02  3.60e+01     9s
  10  -1.13829820e+05  4.29583438e+06  4.01e-02 3.11e-02  1.82e+01     9s
  11  -8.54097729e+04  3.10135894e+06  2.36e-02 2.23e-02  1.31e+01     9s
  12  -6.94215954e+04  1.61526218e+06  1.59e-02 1.14e-02  6.94e+00     9s
  13  -3.74435832e+04  6.12292355e+05  6.80e-03 4.08e-03  2.68e+00     9s
  14  -7.55616982e+02  3.16963126e+05  3.27e-03 1.91e-03  1.31e+00     9s
  15   9.31366360e+03  2.45470828e+05  2.57e-03 1.40e-03  9.73e-01     9s
  16   2.32646257e+04  1.57314461e+05  1.85e-03 7.65e-04  5.52e-01     9s
  17   2.76807158e+04  1.38665821e+05  1.63e-03 6.12e-04  4.57e-01    10s
  18   3.50086918e+04  1.16969842e+05  1.26e-03 4.35e-04  3.38e-01    10s
  19   4.20904615e+04  1.04245744e+05  9.16e-04 3.30e-04  2.56e-01    10s
  20   4.47225760e+04  9.40870431e+04  7.94e-04 2.46e-04  2.03e-01    10s
  21   4.94016960e+04  8.72649502e+04  6.01e-04 1.93e-04  1.56e-01    10s
  22   5.04025220e+04  8.26789639e+04  5.62e-04 1.55e-04  1.33e-01    10s
  23   5.46781685e+04  7.88918815e+04  4.08e-04 1.18e-04  9.97e-02    10s
  24   5.71451077e+04  7.65242158e+04  3.21e-04 9.40e-05  7.98e-02    11s
  25   5.95058320e+04  7.43308921e+04  2.41e-04 7.15e-05  6.11e-02    11s
  26   6.13415620e+04  7.15082955e+04  1.81e-04 4.26e-05  4.19e-02    11s
  27   6.27598261e+04  6.99201400e+04  1.36e-04 2.69e-05  2.95e-02    11s
  28   6.49741386e+04  6.89089818e+04  6.86e-05 1.62e-05  1.62e-02    11s
  29   6.56330421e+04  6.83911849e+04  4.85e-05 1.10e-05  1.14e-02    11s
  30   6.62228502e+04  6.81290083e+04  3.08e-05 8.31e-06  7.85e-03    12s
  31   6.68232999e+04  6.78999847e+04  1.34e-05 5.89e-06  4.43e-03    12s
  32   6.70333144e+04  6.75435039e+04  7.51e-06 2.13e-06  2.10e-03    12s
  33   6.70826662e+04  6.74678481e+04  6.22e-06 1.37e-06  1.59e-03    12s
  34   6.71620508e+04  6.74119662e+04  4.07e-06 8.34e-07  1.03e-03    12s
  35   6.71857347e+04  6.73835567e+04  3.44e-06 5.64e-07  8.15e-04    12s
  36   6.72259876e+04  6.73637112e+04  2.41e-06 3.83e-07  5.67e-04    12s
  37   6.72401066e+04  6.73595724e+04  2.03e-06 3.46e-07  4.92e-04    12s
  38   6.72583325e+04  6.73494497e+04  1.58e-06 2.51e-07  3.75e-04    13s
  39   6.73053066e+04  6.73376434e+04  3.43e-07 1.43e-07  1.33e-04    13s
  40   6.73161059e+04  6.73282761e+04  1.05e-07 6.10e-08  5.01e-05    13s
  41   6.73202303e+04  6.73236029e+04  5.00e-08 1.95e-08  1.39e-05    13s
  42   6.73212660e+04  6.73214195e+04  2.27e-08 1.26e-09  6.33e-07    13s
  43   6.73213300e+04  6.73213309e+04  1.44e-09 6.13e-11  3.75e-09    13s
  44   6.73213307e+04  6.73213307e+04  1.43e-08 1.11e-09  8.64e-12    14s

Barrier solved model in 44 iterations and 13.63 seconds (13.79 work units)
Optimal objective 6.73213307e+04


Root crossover log...

  119255 DPushes remaining with DInf 2.8738777e-08                14s
   26913 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                17s

    1373 PPushes remaining with PInf 1.4134093e-06                17s
       0 PPushes remaining with PInf 0.0000000e+00                18s

  Push phase complete: Pinf 0.0000000e+00, Dinf 4.9240859e-03     18s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   50745    6.7321331e+04   0.000000e+00   4.924086e-03     18s
   50747    6.7321331e+04   0.000000e+00   0.000000e+00     18s
   50747    6.7321331e+04   0.000000e+00   0.000000e+00     18s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 6.732133e+04, 50747 iterations, 12.50 seconds (15.52 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 67321.3307    0  150 -180138.75 67321.3307   137%     -   18s
H    0     0                    -173988.5252 67321.3307   139%     -   18s
H    0     0                    -122761.8007 67321.3307   155%     -   19s
H    0     0                    -115937.2619 67321.3307   158%     -   19s
H    0     0                    -102919.3691 67321.3307   165%     -   19s
H    0     0                    -100955.7338 67321.3307   167%     -   19s
H    0     0                    -99744.39242 67321.3307   167%     -   19s
H    0     0                    -61329.96818 67321.3307   210%     -   19s
H    0     0                    13375.672504 67321.3307   403%     -   20s
H    0     0                    20497.379362 67321.3307   228%     -   20s
H    0     0                    21449.988658 67321.3307   214%     -   21s
H    0     0                    21774.999311 67321.3307   209%     -   21s
H    0     0                    21799.497927 67321.3307   209%     -   21s
H    0     0                    22031.374513 67321.3307   206%     -   21s
     0     0 61802.3219    0  167 22031.3745 61802.3219   181%     -   74s
H    0     0                    22036.186905 61802.1930   180%     -   75s
     0     0 61497.7760    0  185 22036.1869 61497.7760   179%     -   93s
     0     0 61358.2090    0  187 22036.1869 61358.2090   178%     -  112s
     0     0 61319.0315    0  190 22036.1869 61319.0315   178%     -  119s
     0     0 60931.7176    0  188 22036.1869 60931.7176   177%     -  136s
     0     0 60902.6586    0  191 22036.1869 60902.6586   176%     -  144s
     0     0 60897.0825    0  190 22036.1869 60897.0825   176%     -  147s
     0     0 60643.5095    0  221 22036.1869 60643.5095   175%     -  161s
     0     0 60638.3406    0  227 22036.1869 60638.3406   175%     -  164s
     0     0 60638.3350    0  227 22036.1869 60638.3350   175%     -  166s
     0     0 57928.5902    0  281 22036.1869 57928.5902   163%     -  228s
     0     0 57928.5313    0  279 22036.1869 57928.5313   163%     -  229s
H    0     0                    25522.881178 57901.5734   127%     -  230s
H    0     0                    26644.781856 57901.5734   117%     -  230s
H    0     0                    26969.115272 57901.5734   115%     -  230s
H    0     0                    27017.802975 57901.5734   114%     -  230s
H    0     0                    27074.219667 57901.5734   114%     -  230s
H    0     0                    27074.669640 57901.5734   114%     -  230s
H    0     0                    27137.613535 57901.5734   113%     -  230s
H    0     0                    27143.952920 57901.5734   113%     -  230s
     0     0 57540.3640    0  285 27143.9529 57540.3640   112%     -  258s
     0     0 57419.5552    0  286 27143.9529 57419.5552   112%     -  270s
     0     0 57363.8561    0  286 27143.9529 57363.8561   111%     -  279s
     0     0 57271.1809    0  296 27143.9529 57271.1809   111%     -  291s
     0     0 57246.1222    0  289 27143.9529 57246.1222   111%     -  296s
     0     0 57156.3853    0  302 27143.9529 57156.3853   111%     -  305s
     0     0 57036.4444    0  283 27143.9529 57036.4444   110%     -  316s
     0     0 56984.1119    0  297 27143.9529 56984.1119   110%     -  325s
     0     0 56976.9555    0  299 27143.9529 56976.9555   110%     -  329s
     0     0 56858.7611    0  295 27143.9529 56858.7611   109%     -  343s
     0     0 56843.4781    0  297 27143.9529 56843.4781   109%     -  347s
     0     0 56737.5381    0  295 27143.9529 56737.5381   109%     -  357s
     0     0 56730.0344    0  301 27143.9529 56730.0344   109%     -  359s
     0     0 56729.6757    0  299 27143.9529 56729.6757   109%     -  361s
     0     0 54644.0951    0  326 27143.9529 54644.0951   101%     -  449s
     0     0 54076.1603    0  328 27143.9529 54076.1603  99.2%     -  497s
     0     0 53517.6441    0  321 27143.9529 53517.6441  97.2%     -  531s
     0     0 53392.7411    0  329 27143.9529 53392.7411  96.7%     -  548s
     0     0 53286.6872    0  329 27143.9529 53286.6872  96.3%     -  565s
     0     0 53253.4192    0  328 27143.9529 53253.4192  96.2%     -  572s
     0     0 53209.7848    0  333 27143.9529 53209.7848  96.0%     -  583s
     0     0 53122.8144    0  334 27143.9529 53122.8144  95.7%     -  596s
     0     0 53088.0944    0  334 27143.9529 53088.0944  95.6%     -  606s
     0     0 53034.5016    0  340 27143.9529 53034.5016  95.4%     -  614s
     0     0 53005.8002    0  325 27143.9529 53005.8002  95.3%     -  620s
     0     0 52993.7435    0  334 27143.9529 52993.7435  95.2%     -  623s
     0     0 52979.1684    0  332 27143.9529 52979.1684  95.2%     -  628s
     0     0 52975.6849    0  339 27143.9529 52975.6849  95.2%     -  630s
     0     0 52972.9681    0  335 27143.9529 52972.9681  95.2%     -  631s
     0     0 52972.4669    0  337 27143.9529 52972.4669  95.2%     -  633s
     0     0 51913.8674    0  368 27143.9529 51913.8674  91.3%     -  690s
H    0     0                    28820.002972 51913.5811  80.1%     -  691s
H    0     0                    29125.842387 51913.5811  78.2%     -  691s
H    0     0                    29193.270232 51913.5811  77.8%     -  691s
H    0     0                    29271.041898 51913.5811  77.4%     -  691s
H    0     0                    29290.083042 51913.5811  77.2%     -  691s
     0     0 51629.3750    0  373 29290.0830 51629.3750  76.3%     -  719s
     0     0 51504.8595    0  379 29290.0830 51504.8595  75.8%     -  744s
     0     0 51473.2304    0  377 29290.0830 51473.2304  75.7%     -  754s
     0     0 51432.3001    0  374 29290.0830 51432.3001  75.6%     -  766s
     0     0 51396.8453    0  380 29290.0830 51396.8453  75.5%     -  776s
     0     0 51389.1927    0  367 29290.0830 51389.1927  75.4%     -  781s
     0     0 51387.5137    0  369 29290.0830 51387.5137  75.4%     -  783s
     0     0 51192.3870    0  393 29290.0830 51192.3870  74.8%     -  818s
H    0     0                    29314.422903 51192.3026  74.6%     -  819s
     0     0 51142.8169    0  400 29314.4229 51142.8169  74.5%     -  839s
     0     0 51126.1221    0  411 29314.4229 51126.1221  74.4%     -  846s
     0     0 51106.1096    0  443 29314.4229 51106.1096  74.3%     -  858s
     0     0 51070.8488    0  451 29314.4229 51070.8488  74.2%     -  872s
     0     0 51050.4697    0  460 29314.4229 51050.4697  74.1%     -  879s
     0     0 51045.3027    0  458 29314.4229 51045.3027  74.1%     -  882s
     0     0 51041.0067    0  460 29314.4229 51041.0067  74.1%     -  885s
     0     0 51038.1989    0  469 29314.4229 51038.1989  74.1%     -  888s
     0     0 51023.0235    0  459 29314.4229 51023.0235  74.1%     -  894s
     0     0 51003.5599    0  459 29314.4229 51003.5599  74.0%     -  904s
     0     0 51001.2490    0  420 29314.4229 51001.2490  74.0%     -  908s
     0     0 50999.4783    0  426 29314.4229 50999.4783  74.0%     -  910s
     0     0 50935.3358    0  405 29314.4229 50935.3358  73.8%     -  935s
     0     0 50892.0288    0  400 29314.4229 50892.0288  73.6%     -  957s
     0     0 50879.5221    0  399 29314.4229 50879.5221  73.6%     -  965s
     0     0 50874.7911    0  450 29314.4229 50874.7911  73.5%     -  971s
     0     0 50867.8216    0  441 29314.4229 50867.8216  73.5%     -  976s
     0     0 50865.1891    0  439 29314.4229 50865.1891  73.5%     -  978s
     0     0 50863.4398    0  443 29314.4229 50863.4398  73.5%     -  981s
     0     0 50805.1208    0  399 29314.4229 50805.1208  73.3%     -  998s
     0     0 50779.9418    0  410 29314.4229 50779.9418  73.2%     - 1009s
     0     0 50746.6082    0  409 29314.4229 50746.6082  73.1%     - 1021s
     0     0 50741.0128    0  399 29314.4229 50741.0128  73.1%     - 1026s
     0     0 50739.2311    0  409 29314.4229 50739.2311  73.1%     - 1029s
     0     0 50689.1671    0  387 29314.4229 50689.1671  72.9%     - 1041s
H    0     0                    29320.839417 50689.0514  72.9%     - 1048s
     0     0 50681.5621    0  399 29320.8394 50681.5621  72.9%     - 1055s
     0     0 50679.9395    0  408 29320.8394 50679.9395  72.8%     - 1058s
     0     0 50653.5254    0  434 29320.8394 50653.5254  72.8%     - 1072s
     0     0 50625.9251    0  434 29320.8394 50625.9251  72.7%     - 1081s
     0     0 50618.5684    0  432 29320.8394 50618.5684  72.6%     - 1086s
     0     0 50616.1901    0  398 29320.8394 50616.1901  72.6%     - 1089s
     0     0 50611.9251    0  396 29320.8394 50611.9251  72.6%     - 1092s
     0     0 50611.4997    0  400 29320.8394 50611.4997  72.6%     - 1093s
     0     0 50599.6684    0  387 29320.8394 50599.6684  72.6%     - 1102s
H    0     0                    29412.767656 50599.6471  72.0%     - 1105s
H    0     0                    29445.676725 50599.6471  71.8%     - 1105s
     0     0 50590.5401    0  402 29445.6767 50590.5401  71.8%     - 1109s
     0     0 50589.6668    0  393 29445.6767 50589.6668  71.8%     - 1110s
     0     0 50582.2372    0  380 29445.6767 50582.2372  71.8%     - 1116s
H    0     0                    29574.022153 50580.8642  71.0%     - 1117s
     0     0 50576.3118    0  430 29574.0222 50576.3118  71.0%     - 1121s
     0     0 50572.3972    0  429 29574.0222 50572.3972  71.0%     - 1124s
     0     0 50570.2928    0  437 29574.0222 50570.2928  71.0%     - 1126s
     0     0 50550.5942    0  396 29574.0222 50550.5942  70.9%     - 1132s
H    0     0                    29647.561999 50548.8413  70.5%     - 1138s
H    0     0                    29705.531528 50548.8413  70.2%     - 1138s
     0     0 50545.7989    0  398 29705.5315 50545.7989  70.2%     - 1145s
     0     0 50545.6980    0  396 29705.5315 50545.6980  70.2%     - 1146s
     0     0 50541.1941    0  396 29705.5315 50541.1941  70.1%     - 1153s
     0     0 50538.7000    0  397 29705.5315 50538.7000  70.1%     - 1157s
     0     0 50537.9381    0  390 29705.5315 50537.9381  70.1%     - 1160s
     0     0 50530.3877    0  424 29705.5315 50530.3877  70.1%     - 1166s
H    0     0                    29797.481634 50530.2444  69.6%     - 1172s
     0     0 50528.3168    0  398 29797.4816 50528.3168  69.6%     - 1175s
     0     0 50523.4181    0  445 29797.4816 50523.4181  69.6%     - 1181s
     0     0 50523.2366    0  445 29797.4816 50523.2366  69.6%     - 1186s
H    0     0                    29811.313730 50523.2366  69.5%     - 1265s
H    0     0                    29977.822260 50523.2366  68.5%     - 1366s
H    0     0                    30215.892524 50523.2366  67.2%     - 1369s
     0     2 50523.2366    0  445 30215.8925 50523.2366  67.2%     - 1373s
     1     3 50225.1680    1  366 30215.8925 50523.0888  67.2%  7979 1387s
     2     4 50422.5021    1  395 30215.8925 50422.5021  66.9%  7076 1401s
     3     7 48921.0805    2  355 30215.8925 50422.0156  66.9%  7882 1428s
     6    13 50275.1420    3  389 30215.8925 50421.6292  66.9%  9323 1491s
    12    24 47588.9221    4  355 30215.8925 50275.1322  66.4% 13908 1534s
    23    35 47772.6598    4  354 30215.8925 50275.1322  66.4% 21434 1637s
    34    64 47390.3329    5  448 30215.8925 50084.5865  65.8% 20218 1884s
H   38    64                    30254.948859 50084.5865  65.5% 19963 1884s
H   53    64                    30261.316349 50084.5865  65.5% 17415 1884s
    63    96 47361.3491    6  441 30261.3163 50084.5865  65.5% 25223 1949s
    95   128 47359.0730    7  436 30261.3163 50084.5865  65.5% 21882 1999s
H   97   128                    31716.261565 50084.5865  57.9% 21533 1999s
H  127   230                    31741.659735 50084.5865  57.8% 18525 2074s
H  132   230                    31818.732584 50084.5865  57.4% 17926 2074s
H  148   230                    31968.100871 50084.5865  56.7% 16679 2074s
   229   310 47226.5052   13  377 31968.1009 50084.5865  56.7% 12797 2136s
   318   384 46993.6118   17  381 31968.1009 50084.5865  56.7% 11420 2185s
   398   472 46938.5413   19  372 31968.1009 50084.5865  56.7% 10467 2227s
   486   542 46519.0469   23  369 31968.1009 50084.5865  56.7% 10062 2260s
   560   602 45972.9956   25  368 31968.1009 50084.5865  56.7%  9985 2287s
   628   663 44180.0009   27  316 31968.1009 50084.5865  56.7%  9996 2318s
   689   718 44169.5412   28  322 31968.1009 50084.5865  56.7%  9935 2349s
   750   768 39179.1843   30  375 31968.1009 50084.5865  56.7%  9984 2376s
   822   810 37930.0607   31  294 31968.1009 50084.5865  56.7% 10088 2404s
   894   843 37686.5592   32  302 31968.1009 50084.5865  56.7%  9934 2436s
   961   893 37612.7299   33  300 31968.1009 50084.5865  56.7%  9823 2467s
  1045   959 34109.5560   35  152 31968.1009 50084.5865  56.7%  9669 2501s
  1155   987 33842.6098   37  154 31968.1009 50084.5865  56.7%  9355 2535s
  1215  1009 33397.3679   38  159 31968.1009 50081.9439  56.7%  9230 2572s
H 1247  1009                    31978.125072 50081.9439  56.6%  9155 2572s
  1271  1092 33277.2072   39  175 31978.1251 50081.9439  56.6%  9123 2609s
  1390  1173 32600.5596   45  143 31978.1251 50081.9439  56.6%  8893 2648s
  1525  1278 infeasible   48      31978.1251 50081.9439  56.6%  8527 2685s
  1672  1300 33511.9120   52  102 31978.1251 50081.9439  56.6%  8264 2725s
H 1675  1300                    32036.746112 50081.9439  56.3%  8250 2725s
H 1699  1300                    32190.478867 50081.9439  55.6%  8297 2725s
  1708  1315     cutoff   53      32190.4789 50081.9439  55.6%  8331 2762s
H 1728  1315                    32387.619755 50081.9439  54.6%  8325 2762s
  1745  1356     cutoff   54      32387.6198 50081.9439  54.6%  8341 2802s
  1856  1407 46598.5184    9  384 32387.6198 50081.9439  54.6%  8262 2848s
  1953  1460 46133.8002   12  351 32387.6198 50081.9439  54.6%  8349 2894s
  2052  1534 45489.8351   14  341 32387.6198 50081.9439  54.6%  8403 2936s
  2168  1560 44549.1600   19  321 32387.6198 50081.9439  54.6%  8433 2973s
  2206  1589 44547.2403   20  316 32387.6198 50081.9439  54.6%  8552 3012s
  2243  1619 44283.0276   21  245 32387.6198 50081.9439  54.6%  8646 3047s
H 2261  1619                    33130.203650 50081.9439  51.2%  8677 3047s
  2285  1684 40444.7119   22  326 33130.2037 50081.9439  51.2%  8733 3100s
  2398  1762 40163.9758   23  243 33130.2037 49037.9729  48.0%  8749 3153s
  2524  1827 39084.9076   30  250 33130.2037 49037.6791  48.0%  8852 3208s
  2663  1887 37786.9469   38  166 33130.2037 49037.6791  48.0%  8842 3262s
  2806  2005 36383.3672   45  181 33130.2037 48567.0265  46.6%  8874 3316s
  2962  2131 33862.8479   57  150 33130.2037 47906.1615  44.6%  8861 3373s
  3165  2219 infeasible   24      33130.2037 47792.4697  44.3%  8790 3440s
  3295  2270 45671.0648   12  390 33130.2037 47575.0778  43.6%  8929 3497s
H 3339  2267                    33146.294908 47575.0778  43.5%  8926 3497s
  3396  2329 43419.0699   13  374 33146.2949 47575.0778  43.5%  8963 3571s
  3542  2349 42716.3091   14  346 33146.2949 47575.0778  43.5%  9023 3600s
H 3543  2333                    33278.343303 47575.0778  43.0%  9021 3600s
H 3546  2302                    33447.645291 47575.0778  42.2%  9023 3600s

Cutting planes:
  Learned: 1
  Gomory: 21
  Implied bound: 235
  MIR: 3386
  Flow cover: 3171
  RLT: 44
  Relax-and-lift: 437

Explored 3576 nodes (32986273 simplex iterations) in 3600.10 seconds (5743.18 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 33447.6 33278.3 33146.3 ... 31818.7

Time limit reached
Best objective 3.344764529079e+04, best bound 4.757507782085e+04, gap 42.2375%
  WARNING: Time limit reached. Using best solution found (gap: 42.24%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.13s
  Master Objective (UB) = 33447.65, θ = 186826.39
  Upper Bound (UB) = 33447.65

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 186826.39
  [DEBUG]   ✓ Scenario 0: θ = 186826.39 ≤ Q = 186826.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 186826.39 ≤ Q = 186826.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 186826.39 ≤ Q = 186826.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 186826.39 ≤ Q = 186826.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 186826.39 ≤ Q = 186826.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 186826.39 ≤ Q = 186826.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 186826.39 ≤ Q = 186826.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 186826.39 ≤ Q = 186826.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 186826.39 ≤ Q = 186826.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 186826.39 ≤ Q = 186826.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 186826.39 ≤ Q = 186826.39 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 186826.39 ≤ Q = 186826.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 186826.39 ≤ Q = 186826.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 186826.39 ≤ Q = 186826.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 186826.39 ≤ Q = 186826.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 186826.39 ≤ Q = 186826.39 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 16] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x1ef4f6ce
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x1ef4f6ce
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.405043e+13
Presolve removed 2600 rows and 1892 columns
Presolve time: 0.01s
Presolved: 493 rows, 497 columns, 1392 nonzeros
Found heuristic solution: objective 6863328.0236
Variable types: 337 continuous, 160 integer (160 binary)

Root relaxation: objective -1.584966e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -158496.63    0  124 6863328.02 -158496.63   102%     -    0s
H    0     0                    -124049.9243 -158496.63  27.8%     -    0s
H    0     0                    -124871.9148 -158496.63  26.9%     -    0s
     0     0 -134749.18    0   85 -124871.91 -134749.18  7.91%     -    0s
H    0     0                    -130262.4244 -134708.50  3.41%     -    0s
     0     0 -133463.93    0   53 -130262.42 -133463.93  2.46%     -    0s
H    0     0                    -132711.2993 -133454.45  0.56%     -    0s
     0     0 -133163.50    0   34 -132711.30 -133163.50  0.34%     -    0s
     0     0 -133119.66    0   35 -132711.30 -133119.66  0.31%     -    0s
     0     0 -133118.72    0   40 -132711.30 -133118.72  0.31%     -    0s
     0     0 -133061.52    0   34 -132711.30 -133061.52  0.26%     -    0s
     0     0 -133055.76    0   34 -132711.30 -133055.76  0.26%     -    0s
     0     0 -133045.01    0   72 -132711.30 -133045.01  0.25%     -    0s
     0     0 -133045.01    0   32 -132711.30 -133045.01  0.25%     -    0s
     0     0 -132902.41    0   19 -132711.30 -132902.41  0.14%     -    0s
     0     0 -132890.79    0   17 -132711.30 -132890.79  0.14%     -    0s
     0     0 -132881.52    0   17 -132711.30 -132881.52  0.13%     -    0s
     0     0 -132880.52    0   20 -132711.30 -132880.52  0.13%     -    0s
H    0     0                    -132714.0400 -132880.52  0.13%     -    0s
     0     0 -132715.99    0   10 -132714.04 -132715.99  0.00%     -    0s

Cutting planes:
  Gomory: 18
  Implied bound: 12
  MIR: 66
  Flow cover: 6
  RLT: 2
  Relax-and-lift: 3

Explored 1 nodes (874 simplex iterations) in 0.20 seconds (0.06 work units)
Thread count was 32 (of 32 available processors)

Solution count 8: -132714 -132711 -130262 ... 1.40504e+13
No other solutions better than -132714

Optimal solution found (tolerance 1.00e-06)
Best objective -1.327140400158e+05, best bound -1.327140400158e+05, gap 0.0000%
  Subproblem solved in 0.24s
  Worst-case operational profit (Z_SP) = 181205.04
  Scenario: 20 demand increases, 40 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -132714.04
  [DEBUG]   S×d_nominal = 313919.08
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 313919.08 + -132714.04 = 181205.04
  [DEBUG]   Current θ from Master = 186826.39
  [DEBUG]   ⚠️  Z_SP ≤ θ by 5621.35 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 27826.30
  Lower Bound (LB) = 29447.80
  Gap (UB-LB) = 3999.8444, Absolute Gap = 3999.8444, Relative Gap = 0.119585
  Not converged yet (gap = 3999.84 > ε = 200)

  [DEBUG] Adding NEW scenario 16 to Master Problem...
  [DEBUG] New scenario pattern: 20 increases, 40 decreases
    [DEBUG] Scenario 16 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 16 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 16]
    [DEBUG]   - Total constraints in model: 261313
    [DEBUG]   - Total variables in model: 108340
  [DEBUG] Total scenarios in Master: 17
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 17
================================================================================
[Iteration 17] Solving Master Problem...
  Current scenarios in Master: 17
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 261313 rows, 108340 columns and 740446 nonzeros
Model fingerprint: 0x34f4bab3
Variable types: 106081 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 120190 rows and 48790 columns (presolve time = 5s)...
Presolve removed 120190 rows and 48790 columns
Presolve time: 5.18s
Presolved: 141123 rows, 59550 columns, 869527 nonzeros
Variable types: 57291 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -335473.7764
Found heuristic solution: objective -180138.7472

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 2.05s

Barrier statistics:
 Dense cols : 623
 AA' NZ     : 7.347e+06
 Factor NZ  : 1.607e+07 (roughly 200 MB of memory)
 Factor Ops : 3.654e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.81288339e+07  2.58716869e+08  1.34e+05 1.48e+01  8.62e+04    10s
   1  -1.39870064e+07  2.39785557e+08  9.48e+04 7.52e+01  6.06e+04    10s
   2  -5.52404327e+06  1.77348641e+08  3.67e+04 8.03e+00  2.51e+04    10s
   3  -1.78815384e+06  1.43485742e+08  7.32e+03 1.78e+00  5.39e+03    10s
   4  -7.63593456e+05  1.00918935e+08  9.41e+02 7.57e-01  9.80e+02    10s
   5  -5.91824332e+05  7.57771986e+07  6.85e+02 5.43e-01  7.03e+02    10s
   6  -4.63494439e+05  5.20409215e+07  3.59e+02 3.32e-01  4.03e+02    10s
   7  -3.76730947e+05  3.75674132e+07  1.15e+02 2.20e-01  2.06e+02    10s
   8  -3.23471794e+05  2.44722512e+07  3.65e+01 1.33e-01  1.12e+02    11s
   9  -1.89795030e+05  1.43338582e+07  1.46e-07 7.17e-02  5.64e+01    11s
  10  -1.33748319e+05  3.01043707e+06  1.50e-07 1.47e-02  1.22e+01    11s
  11  -8.87402221e+04  2.49947782e+06  9.80e-08 1.21e-02  1.00e+01    11s
  12  -6.63929793e+04  1.45955250e+06  6.90e-08 6.94e-03  5.92e+00    11s
  13  -3.44834584e+04  5.55794520e+05  3.95e-08 2.52e-03  2.29e+00    11s
  14  -1.62351961e+02  3.01245525e+05  1.57e-08 1.23e-03  1.17e+00    11s
  15   1.42665263e+04  2.18206992e+05  1.13e-08 8.08e-04  7.92e-01    11s
  16   2.48391432e+04  1.83625679e+05  8.40e-09 6.29e-04  6.16e-01    12s
  17   3.00827452e+04  1.53059958e+05  6.98e-09 4.71e-04  4.77e-01    12s
  18   3.75740815e+04  1.20501228e+05  5.11e-09 3.03e-04  3.22e-01    12s
  19   4.35226948e+04  1.05868912e+05  3.79e-09 2.24e-04  2.42e-01    12s
  20   4.75911520e+04  1.04731364e+05  2.96e-09 2.19e-04  2.22e-01    12s
  21   4.94171596e+04  9.51532204e+04  2.61e-09 1.66e-04  1.78e-01    13s
  22   5.03687282e+04  8.98724361e+04  2.44e-09 1.40e-04  1.53e-01    13s
  23   5.27657748e+04  8.60264119e+04  2.03e-09 1.16e-04  1.29e-01    13s
  24   5.72228566e+04  8.00835480e+04  1.30e-09 8.03e-05  8.87e-02    13s
  25   5.85275456e+04  7.79405617e+04  1.11e-09 6.69e-05  7.53e-02    13s
  26   6.00781930e+04  7.53759405e+04  8.92e-10 5.14e-05  5.94e-02    13s
  27   6.25036633e+04  7.19185354e+04  5.64e-10 2.96e-05  3.65e-02    14s
  28   6.47954107e+04  6.96521562e+04  2.73e-10 1.50e-05  1.88e-02    14s
  29   6.53571835e+04  6.90928445e+04  2.07e-10 1.14e-05  1.45e-02    14s
  30   6.61161604e+04  6.83226590e+04  1.21e-10 6.96e-06  8.56e-03    14s
  31   6.66583358e+04  6.78348472e+04  5.90e-11 3.47e-06  4.57e-03    14s
  32   6.67630215e+04  6.76536940e+04  4.80e-11 2.37e-06  3.46e-03    15s
  33   6.69741792e+04  6.74961634e+04  8.91e-10 1.44e-06  2.03e-03    15s
  34   6.70474068e+04  6.73963073e+04  1.10e-08 8.78e-07  1.35e-03    15s
  35   6.71510257e+04  6.73637209e+04  4.55e-08 6.90e-07  8.26e-04    15s
  36   6.71626180e+04  6.73291219e+04  6.27e-08 4.90e-07  6.46e-04    15s
  37   6.71837397e+04  6.72898272e+04  7.60e-08 2.65e-07  4.12e-04    16s
  38   6.71910716e+04  6.72855084e+04  1.55e-07 2.41e-07  3.67e-04    16s
  39   6.72082982e+04  6.72768334e+04  2.20e-07 1.97e-07  2.66e-04    16s
  40   6.72266289e+04  6.72578405e+04  1.39e-07 8.88e-08  1.21e-04    17s
  41   6.72350240e+04  6.72499531e+04  1.15e-07 4.43e-08  5.79e-05    17s
  42   6.72374212e+04  6.72473405e+04  7.30e-08 3.00e-08  3.85e-05    17s
  43   6.72388789e+04  6.72440488e+04  6.33e-08 1.22e-08  2.01e-05    18s
  44   6.72404317e+04  6.72435452e+04  4.95e-08 9.53e-09  1.21e-05    18s
  45   6.72412939e+04  6.72425006e+04  3.02e-08 4.16e-09  4.68e-06    18s
  46   6.72414847e+04  6.72418034e+04  1.88e-08 6.50e-10  1.24e-06    19s
  47   6.72416596e+04  6.72416752e+04  2.48e-08 3.49e-11  6.09e-08    19s
  48   6.72416725e+04  6.72416725e+04  2.99e-09 4.56e-09  6.13e-11    19s

Barrier solved model in 48 iterations and 18.97 seconds (18.05 work units)
Optimal objective 6.72416725e+04


Root crossover log...

  125754 DPushes remaining with DInf 0.0000000e+00                19s
   48057 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                25s

    2049 PPushes remaining with PInf 1.0370171e-05                25s
       0 PPushes remaining with PInf 0.0000000e+00                25s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.7607480e+00     25s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   54697    6.7241673e+04   0.000000e+00   1.760748e+00     25s
   54699    6.7241673e+04   0.000000e+00   0.000000e+00     25s
   54699    6.7241673e+04   0.000000e+00   0.000000e+00     25s
Concurrent spin time: 3.07s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 6.724167e+04, 54699 iterations, 21.84 seconds (23.40 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 67241.6725    0  158 -180138.75 67241.6725   137%     -   29s
H    0     0                    -175900.4381 67241.6725   138%     -   29s
H    0     0                    -89714.52341 67241.6725   175%     -   29s
H    0     0                    -88212.67067 67241.6725   176%     -   30s
H    0     0                    -74073.90523 67241.6725   191%     -   30s
H    0     0                    4713.6665706 67241.6725  1327%     -   30s
H    0     0                    20009.786224 67241.6725   236%     -   31s
H    0     0                    21273.678124 67241.6725   216%     -   32s
H    0     0                    21297.174191 67241.6725   216%     -   32s
H    0     0                    21322.462122 67241.6725   215%     -   32s
H    0     0                    21337.301310 67241.6725   215%     -   32s
H    0     0                    21358.384431 67241.6725   215%     -   32s
H    0     0                    21359.991448 67241.6725   215%     -   32s
H    0     0                    21371.332221 67241.6725   215%     -   32s
H    0     0                    21442.391717 67241.6725   214%     -   32s
     0     0 60997.5103    0  192 21442.3917 60997.5103   184%     -   91s
H    0     0                    21544.531732 60995.6760   183%     -   92s
     0     0 60775.2935    0  204 21544.5317 60775.2935   182%     -  113s
     0     0 60710.4740    0  207 21544.5317 60710.4740   182%     -  125s
     0     0 60703.5227    0  212 21544.5317 60703.5227   182%     -  127s
     0     0 60702.9370    0  210 21544.5317 60702.9370   182%     -  128s
     0     0 57654.6194    0  285 21544.5317 57654.6194   168%     -  215s
H    0     0                    22305.456559 57653.6456   158%     -  216s
H    0     0                    22538.968166 57653.6456   156%     -  216s
H    0     0                    22781.981623 57653.6456   153%     -  216s
H    0     0                    24014.101119 57653.6456   140%     -  216s
H    0     0                    24144.934254 57653.6456   139%     -  216s
H    0     0                    24159.329367 57653.6456   139%     -  216s
H    0     0                    24236.793142 57653.6456   138%     -  216s
H    0     0                    24256.860769 57653.6456   138%     -  217s
     0     0 56871.3426    0  286 24256.8608 56871.3426   134%     -  257s
     0     0 56714.1018    0  303 24256.8608 56714.1018   134%     -  281s
     0     0 56438.8090    0  307 24256.8608 56438.8090   133%     -  309s
     0     0 56133.6146    0  309 24256.8608 56133.6146   131%     -  328s
     0     0 56061.6467    0  315 24256.8608 56061.6467   131%     -  342s
     0     0 55975.5282    0  321 24256.8608 55975.5282   131%     -  355s
     0     0 55902.1362    0  321 24256.8608 55902.1362   130%     -  365s
     0     0 55892.0163    0  325 24256.8608 55892.0163   130%     -  370s
     0     0 55891.2413    0  323 24256.8608 55891.2413   130%     -  371s
     0     0 53805.1176    0  317 24256.8608 53805.1176   122%     -  483s
     0     0 53338.5465    0  379 24256.8608 53338.5465   120%     -  541s
     0     0 53197.0349    0  366 24256.8608 53197.0349   119%     -  566s
     0     0 53088.1708    0  379 24256.8608 53088.1708   119%     -  591s
     0     0 52959.0439    0  377 24256.8608 52959.0439   118%     -  618s
     0     0 52923.5549    0  394 24256.8608 52923.5549   118%     -  633s
     0     0 52903.5322    0  394 24256.8608 52903.5322   118%     -  645s
     0     0 52871.0850    0  397 24256.8608 52871.0850   118%     -  661s
     0     0 52859.2461    0  394 24256.8608 52859.2461   118%     -  670s
     0     0 52854.7405    0  400 24256.8608 52854.7405   118%     -  679s
     0     0 52839.9003    0  387 24256.8608 52839.9003   118%     -  692s
     0     0 52825.3294    0  397 24256.8608 52825.3294   118%     -  706s
     0     0 52822.6767    0  405 24256.8608 52822.6767   118%     -  711s
     0     0 52817.1079    0  405 24256.8608 52817.1079   118%     -  717s
     0     0 52814.0605    0  406 24256.8608 52814.0605   118%     -  721s
     0     0 52811.7204    0  409 24256.8608 52811.7204   118%     -  725s
     0     0 52810.9016    0  407 24256.8608 52810.9016   118%     -  727s
     0     0 51986.9939    0  367 24256.8608 51986.9939   114%     -  851s
H    0     0                    27172.157164 51986.4678  91.3%     -  852s
H    0     0                    28372.145905 51986.4678  83.2%     -  852s
H    0     0                    28479.011698 51986.4678  82.5%     -  853s
H    0     0                    28519.974683 51986.4678  82.3%     -  853s
     0     0 51787.6620    0  357 28519.9747 51787.6620  81.6%     -  891s
     0     0 51581.6401    0  356 28519.9747 51581.6401  80.9%     -  924s
     0     0 51529.6615    0  368 28519.9747 51529.6615  80.7%     -  937s
     0     0 51506.8691    0  408 28519.9747 51506.8691  80.6%     -  944s
     0     0 51503.6147    0  407 28519.9747 51503.6147  80.6%     -  948s
     0     0 51494.5472    0  436 28519.9747 51494.5472  80.6%     -  955s
     0     0 51490.7446    0  405 28519.9747 51490.7446  80.5%     -  958s
     0     0 51450.3045    0  369 28519.9747 51450.3045  80.4%     -  969s
     0     0 51433.2283    0  370 28519.9747 51433.2283  80.3%     -  977s
     0     0 51415.5053    0  374 28519.9747 51415.5053  80.3%     -  984s
     0     0 51409.7475    0  377 28519.9747 51409.7475  80.3%     -  988s
     0     0 51408.6957    0  377 28519.9747 51408.6957  80.3%     -  990s
     0     0 51137.4914    0  416 28519.9747 51137.4914  79.3%     - 1022s
     0     0 51051.8391    0  405 28519.9747 51051.8391  79.0%     - 1042s
     0     0 51017.9745    0  438 28519.9747 51017.9745  78.9%     - 1053s
     0     0 50983.2189    0  412 28519.9747 50983.2189  78.8%     - 1061s
     0     0 50944.8071    0  440 28519.9747 50944.8071  78.6%     - 1071s
     0     0 50928.6032    0  408 28519.9747 50928.6032  78.6%     - 1077s
     0     0 50925.6672    0  438 28519.9747 50925.6672  78.6%     - 1080s
     0     0 50910.4639    0  407 28519.9747 50910.4639  78.5%     - 1088s
     0     0 50901.5604    0  408 28519.9747 50901.5604  78.5%     - 1092s
     0     0 50891.9214    0  406 28519.9747 50891.9214  78.4%     - 1094s
     0     0 50889.7317    0  409 28519.9747 50889.7317  78.4%     - 1095s
     0     0 50785.2373    0  419 28519.9747 50785.2373  78.1%     - 1115s
     0     0 50748.5671    0  429 28519.9747 50748.5671  77.9%     - 1127s
     0     0 50719.8130    0  437 28519.9747 50719.8130  77.8%     - 1135s
     0     0 50714.5343    0  435 28519.9747 50714.5343  77.8%     - 1139s
     0     0 50712.2292    0  437 28519.9747 50712.2292  77.8%     - 1141s
     0     0 50707.2779    0  433 28519.9747 50707.2779  77.8%     - 1145s
     0     0 50703.4062    0  471 28519.9747 50703.4062  77.8%     - 1148s
     0     0 50700.6574    0  475 28519.9747 50700.6574  77.8%     - 1151s
     0     0 50699.2602    0  481 28519.9747 50699.2602  77.8%     - 1153s
     0     0 50608.5639    0  385 28519.9747 50608.5639  77.4%     - 1172s
H    0     0                    28636.317725 50608.1686  76.7%     - 1174s
     0     0 50589.9394    0  370 28636.3177 50589.9394  76.7%     - 1178s
     0     0 50585.5977    0  385 28636.3177 50585.5977  76.6%     - 1184s
     0     0 50583.9575    0  381 28636.3177 50583.9575  76.6%     - 1187s
     0     0 50565.9272    0  381 28636.3177 50565.9272  76.6%     - 1197s
H    0     0                    28801.693047 50565.5276  75.6%     - 1200s
H    0     0                    29125.007026 50565.5276  73.6%     - 1200s
H    0     0                    29212.881858 50565.5276  73.1%     - 1201s
H    0     0                    29271.080664 50565.5276  72.7%     - 1201s
     0     0 50548.1487    0  417 29271.0807 50548.1487  72.7%     - 1211s
     0     0 50540.9460    0  378 29271.0807 50540.9460  72.7%     - 1216s
     0     0 50537.0870    0  386 29271.0807 50537.0870  72.7%     - 1219s
     0     0 50536.1925    0  384 29271.0807 50536.1925  72.6%     - 1222s
     0     0 50527.7199    0  394 29271.0807 50527.7199  72.6%     - 1229s
H    0     0                    29340.576258 50525.6117  72.2%     - 1231s
     0     0 50521.1926    0  384 29340.5763 50521.1926  72.2%     - 1234s
     0     0 50518.8464    0  382 29340.5763 50518.8464  72.2%     - 1237s
     0     0 50518.5695    0  381 29340.5763 50518.5695  72.2%     - 1238s
     0     0 50511.3957    0  384 29340.5763 50511.3957  72.2%     - 1244s
H    0     0                    29385.515031 50510.4586  71.9%     - 1248s
     0     0 50506.2623    0  374 29385.5150 50506.2623  71.9%     - 1250s
     0     0 50501.4465    0  380 29385.5150 50501.4465  71.9%     - 1253s
     0     0 50498.0370    0  421 29385.5150 50498.0370  71.8%     - 1256s
     0     0 50496.4781    0  423 29385.5150 50496.4781  71.8%     - 1259s
     0     0 50483.8357    0  414 29385.5150 50483.8357  71.8%     - 1265s
     0     0 50472.2625    0  389 29385.5150 50472.2625  71.8%     - 1271s
     0     0 50470.8662    0  384 29385.5150 50470.8662  71.8%     - 1275s
     0     0 50469.4612    0  384 29385.5150 50469.4612  71.7%     - 1278s
H    0     0                    29397.454134 50469.3538  71.7%     - 1283s
     0     0 50469.2513    0  388 29397.4541 50469.2513  71.7%     - 1284s
     0     0 50466.6326    0  376 29397.4541 50466.6326  71.7%     - 1289s
     0     0 50466.0426    0  371 29397.4541 50466.0426  71.7%     - 1291s
     0     0 50466.0426    0  383 29397.4541 50466.0426  71.7%     - 1295s
     0     0 50466.0399    0  383 29397.4541 50466.0399  71.7%     - 1300s
H    0     0                    29410.368962 50466.0399  71.6%     - 1427s
H    0     0                    29454.567517 50466.0363  71.3%     - 1536s
H    0     0                    29538.871449 50466.0363  70.8%     - 1559s
H    0     0                    29609.938607 50466.0363  70.4%     - 1571s
H    0     0                    29626.564693 50466.0363  70.3%     - 1575s
H    0     0                    29687.844282 50466.0363  70.0%     - 1575s
H    0     0                    29693.655864 50466.0363  70.0%     - 1584s
H    0     0                    29988.900579 50466.0363  68.3%     - 1584s
H    0     0                    30012.763872 50466.0363  68.1%     - 1585s
     0     2 50466.0363    0  383 30012.7639 50466.0363  68.1%     - 1595s
     1     4 50438.5981    1  368 30012.7639 50465.7753  68.1%  6325 1619s
     3     7 50283.6458    2  363 30012.7639 50436.7886  68.1% 10321 1651s
     6    14 50193.4273    3  375 30012.7639 50302.9218  67.6% 12934 1690s
    13    28 50152.5885    4  374 30012.7639 50193.0583  67.2% 13789 1714s
    27    42 49914.0832    5  369 30012.7639 50152.5621  67.1% 18289 1828s
    41    74 49065.2359    6  353 30012.7639 50152.5621  67.1% 21504 2100s
H   44    74                    30025.618649 50152.5621  67.0% 20841 2100s
H   54    74                    30192.996769 50152.5621  66.1% 19990 2100s
    73   190 48996.7282    7  352 30192.9968 49996.5464  65.6% 22161 2170s
H  189   248                    30423.206725 49996.5464  64.3% 13116 2230s
H  196   248                    30523.508558 49996.5464  63.8% 12844 2230s
H  221   248                    30761.136959 49996.5464  62.5% 12147 2230s
   247   303 48525.6834   14  362 30761.1370 49996.5464  62.5% 11615 2273s
   302   342 48477.4185   16  368 30761.1370 49996.5464  62.5% 10911 2316s
H  307   342                    30838.466128 49996.5464  62.1% 10830 2316s
   341   405 47177.1181   17  314 30838.4661 49996.5464  62.1% 10781 2356s
   404   434 47060.3401   18  317 30838.4661 49996.5464  62.1% 10589 2406s
   433   466 46768.1405   19  301 30838.4661 49996.5464  62.1% 10614 2443s
   465   507 46498.0495   20  302 30838.4661 49996.5464  62.1% 10625 2474s
   506   539 46417.2983   21  295 30838.4661 49996.5464  62.1% 10549 2499s
H  513   539                    30862.005265 49996.5464  62.0% 10495 2499s
H  516   539                    30942.181303 49996.5464  61.6% 10478 2499s
H  533   539                    31026.920987 49996.5464  61.1% 10452 2499s
   538   619 46407.2682   22  295 31026.9210 49996.5464  61.1% 10485 2527s
   620   646 45949.9852   26  279 31026.9210 49996.5464  61.1% 10130 2571s
   653   678 45812.7881   27  287 31026.9210 49996.5464  61.1% 10018 2629s
   687   710 45626.3369   28  281 31026.9210 49996.5464  61.1%  9988 2655s
H  711   710                    31049.413460 49996.5464  61.0% 10010 2655s
   719   778 45333.0452   29  276 31049.4135 49996.5464  61.0% 10010 2684s
   805   838 45213.7877   31  224 31049.4135 49996.5464  61.0%  9792 2709s
   875   926 44339.5624   34  222 31049.4135 49996.5464  61.0%  9748 2739s
   980  1025 43700.1436   36  256 31049.4135 49996.5464  61.0%  9479 2770s
  1095  1128 43679.5975   39  197 31049.4135 49996.5464  61.0%  9127 2802s
  1202  1210 42836.1893   43  201 31049.4135 49996.5464  61.0%  8872 2832s
  1310  1311 38739.8575   45  168 31049.4135 49996.5464  61.0%  8644 2869s
  1360  1311 39482.5567   29  215 31049.4135 49996.5464  61.0%  8550 2870s
  1419  1419 33496.5948   47  121 31049.4135 49996.5464  61.0%  8481 2903s
  1549  1429 32944.0452   49  118 31049.4135 49996.5464  61.0%  8234 2940s
  1647  1453 infeasible   50      31049.4135 49761.5899  60.3%  8149 2976s
  1717  1483 48272.7930    7  372 31049.4135 49761.5899  60.3%  8253 3014s
  1751  1510 48206.6308    8  375 31049.4135 49761.5899  60.3%  8366 3051s
H 1769  1510                    31065.027668 49685.4774  59.9%  8376 3051s
  1790  1606 47970.6264    9  367 31065.0277 49685.4774  59.9%  8429 3094s
  1900  1662 46409.9068   11  325 31065.0277 49685.4774  59.9%  8407 3134s
H 1901  1662                    31246.714397 49685.4774  59.0%  8403 3134s
H 1904  1662                    31254.944379 49685.4774  59.0%  8414 3134s
  1976  1759 46035.5418   12  327 31254.9444 49685.4774  59.0%  8416 3174s
  2145  1779 45169.2338   14  327 31254.9444 49680.6172  59.0%  8217 3228s
  2186  1802 45092.4077   15  323 31254.9444 49680.6172  59.0%  8238 3318s
  2225  1840 44483.8980   16  292 31254.9444 49544.0378  58.5%  8296 3364s
H 2247  1834                    31405.645436 49470.0671  57.5%  8270 3364s
  2271  1964 44139.9468   17  308 31405.6454 49470.0671  57.5%  8293 3413s
  2475  2057 41424.9468   18  308 31405.6454 49470.0671  57.5%  8014 3460s
  2637  2136 40892.1202   20  270 31405.6454 49470.0671  57.5%  7950 3510s
  2782  2192 37803.9083   24  189 31405.6454 49470.0671  57.5%  7979 3568s
  2888  2236 36092.6800   29  150 31405.6454 49470.0671  57.5%  8053 3600s

Cutting planes:
  Learned: 2
  Gomory: 7
  Implied bound: 99
  MIR: 3373
  Flow cover: 3505
  RLT: 56
  Relax-and-lift: 568

Explored 2976 nodes (24655072 simplex iterations) in 3600.09 seconds (5370.87 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 31405.6 31254.9 31246.7 ... 30761.1

Time limit reached
Best objective 3.140564543612e+04, best bound 4.947006711643e+04, gap 57.5197%
  WARNING: Time limit reached. Using best solution found (gap: 57.52%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.12s
  Master Objective (UB) = 31405.65, θ = 183567.42
  Upper Bound (UB) = 31405.65

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 183567.42
  [DEBUG]   ✓ Scenario 0: θ = 183567.42 ≤ Q = 183567.42 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 183567.42 ≤ Q = 183567.42 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 183567.42 ≤ Q = 183567.42 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 183567.42 ≤ Q = 183567.42 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 183567.42 ≤ Q = 183567.42 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 183567.42 ≤ Q = 183567.42 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 183567.42 ≤ Q = 183567.42 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 183567.42 ≤ Q = 183567.42 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 183567.42 ≤ Q = 183567.42 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 183567.42 ≤ Q = 183567.42 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 183567.42 ≤ Q = 183567.42 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 183567.42 ≤ Q = 183567.42 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 183567.42 ≤ Q = 183567.42 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 183567.42 ≤ Q = 183567.42 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 183567.42 ≤ Q = 183567.42 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 183567.42 ≤ Q = 183567.42 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 183567.42 ≤ Q = 183567.42 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 17] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x27633755
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xd89cc8ab
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [7e-01, 2e+02]
Found heuristic solution: objective 1.399823e+13
Presolve removed 2606 rows and 1897 columns
Presolve time: 0.01s
Presolved: 487 rows, 492 columns, 1374 nonzeros
Found heuristic solution: objective 6836380.5393
Variable types: 333 continuous, 159 integer (159 binary)

Root relaxation: objective -1.559747e+05, 235 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -155974.72    0  121 6836380.54 -155974.72   102%     -    0s
H    0     0                    -112684.1982 -155974.72  38.4%     -    0s
H    0     0                    -116114.9757 -155974.72  34.3%     -    0s
H    0     0                    -126096.2387 -130900.70  3.81%     -    0s
     0     0 -130900.70    0  100 -126096.24 -130900.70  3.81%     -    0s
H    0     0                    -126924.3547 -130780.11  3.04%     -    0s
     0     0 -129609.09    0  105 -126924.35 -129609.09  2.12%     -    0s
H    0     0                    -127015.3218 -129600.05  2.03%     -    0s
     0     0 -129190.02    0   73 -127015.32 -129190.02  1.71%     -    0s
H    0     0                    -127829.9237 -129173.92  1.05%     -    0s
     0     0 -129140.38    0   86 -127829.92 -129140.38  1.03%     -    0s
     0     0 -128871.52    0   88 -127829.92 -128871.52  0.81%     -    0s
     0     0 -128853.49    0   58 -127829.92 -128853.49  0.80%     -    0s
     0     0 -128678.83    0   61 -127829.92 -128678.83  0.66%     -    0s
     0     0 -128671.04    0   93 -127829.92 -128671.04  0.66%     -    0s
     0     0 -128635.73    0   91 -127829.92 -128635.73  0.63%     -    0s
     0     0 -128631.42    0   91 -127829.92 -128631.42  0.63%     -    0s
H    0     0                    -127908.3625 -128631.42  0.57%     -    0s
H    0     0                    -127986.4271 -128631.42  0.50%     -    0s
     0     2 -128606.37    0   89 -127986.43 -128606.37  0.48%     -    0s
H   34    21                    -128004.8257 -128450.38  0.35%  11.4    0s
H   34    21                    -128032.9401 -128450.38  0.33%  11.4    0s
H  124    91                    -128047.5008 -128349.97  0.24%   5.5    0s
H 1015   123                    -128071.6999 -128294.77  0.17%   3.9    0s
H 1028   123                    -128081.5002 -128294.77  0.17%   3.9    0s
* 1336    17              29    -128087.9891 -128209.28  0.09%   3.8    0s
* 1396     0              29    -128097.7895 -128209.28  0.09%   3.8    0s

Cutting planes:
  Gomory: 51
  Implied bound: 12
  MIR: 185
  Flow cover: 13
  RLT: 8
  BQP: 1

Explored 1437 nodes (6151 simplex iterations) in 0.37 seconds (0.12 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -128098 -128088 -128082 ... -127830
No other solutions better than -128098

Optimal solution found (tolerance 1.00e-06)
Best objective -1.280977894655e+05, best bound -1.280977894655e+05, gap 0.0000%
  Subproblem solved in 0.40s
  Worst-case operational profit (Z_SP) = 179623.12
  Scenario: 31 demand increases, 29 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -128097.79
  [DEBUG]   S×d_nominal = 307720.91
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 307720.91 + -128097.79 = 179623.12
  [DEBUG]   Current θ from Master = 183567.42
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3944.30 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 27461.34
  Lower Bound (LB) = 29447.80
  Gap (UB-LB) = 1957.8445, Absolute Gap = 1957.8445, Relative Gap = 0.062341
  Not converged yet (gap = 1957.84 > ε = 200)

  [DEBUG] Adding NEW scenario 17 to Master Problem...
  [DEBUG] New scenario pattern: 31 increases, 29 decreases
    [DEBUG] Scenario 17 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 17 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 17]
    [DEBUG]   - Total constraints in model: 276603
    [DEBUG]   - Total variables in model: 114580
  [DEBUG] Total scenarios in Master: 18
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 18
================================================================================
[Iteration 18] Solving Master Problem...
  Current scenarios in Master: 18
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 276603 rows, 114580 columns and 783677 nonzeros
Model fingerprint: 0xbfd7ddf2
Variable types: 112321 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 127260 rows and 51660 columns (presolve time = 5s)...
Presolve removed 127260 rows and 51660 columns
Presolve time: 6.09s
Presolved: 149343 rows, 62920 columns, 920066 nonzeros
Variable types: 60661 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -335473.7764
Found heuristic solution: objective -180138.7472

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 2.52s

Barrier statistics:
 Dense cols : 622
 AA' NZ     : 8.154e+06
 Factor NZ  : 1.787e+07 (roughly 230 MB of memory)
 Factor Ops : 4.251e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.85767467e+07  2.72404499e+08  1.38e+05 1.44e+01  8.79e+04    11s
   1  -1.43678332e+07  2.53230172e+08  9.74e+04 7.50e+01  6.19e+04    11s
   2  -5.81552950e+06  1.87580299e+08  3.86e+04 5.50e+00  2.62e+04    11s
   3  -8.23163364e+05  1.48129771e+08  1.73e+03 1.90e+00  1.71e+03    11s
   4  -5.79470262e+05  1.09759458e+08  5.34e+02 1.24e+00  7.44e+02    12s
   5  -5.10035541e+05  6.41547036e+07  3.11e+02 6.46e-01  4.14e+02    12s
   6  -4.13184051e+05  4.98676359e+07  8.76e+01 4.78e-01  2.31e+02    12s
   7  -3.88481235e+05  3.43534384e+07  5.28e+01 3.15e-01  1.51e+02    12s
   8  -3.15115526e+05  2.35902269e+07  4.95e+00 2.08e-01  8.96e+01    12s
   9  -2.17960908e+05  1.16011765e+07  2.17e-01 9.98e-02  4.34e+01    12s
  10  -1.32182425e+05  3.97508952e+06  5.29e-02 3.27e-02  1.51e+01    12s
  11  -9.44478062e+04  3.07218609e+06  3.41e-02 2.53e-02  1.16e+01    12s
  12  -7.47761769e+04  2.25462095e+06  2.17e-02 1.84e-02  8.55e+00    13s
  13  -4.37151693e+04  1.33806040e+06  1.05e-02 1.08e-02  5.07e+00    13s
  14  -8.17131547e+03  4.51116756e+05  3.27e-03 3.40e-03  1.69e+00    13s
  15   1.03977003e+04  2.70265264e+05  2.06e-03 1.85e-03  9.54e-01    13s
  16   2.40425047e+04  1.72732968e+05  1.45e-03 1.03e-03  5.46e-01    13s
  17   2.96999363e+04  1.57842835e+05  1.21e-03 8.92e-04  4.70e-01    13s
  18   3.67223124e+04  1.19804620e+05  9.28e-04 5.61e-04  3.05e-01    14s
  19   4.30041397e+04  1.04320874e+05  7.06e-04 4.05e-04  2.25e-01    14s
  20   4.53356369e+04  9.59078258e+04  6.22e-04 3.24e-04  1.86e-01    14s
  21   5.06065476e+04  9.28815371e+04  4.48e-04 2.91e-04  1.55e-01    14s
  22   5.25880773e+04  8.83040625e+04  3.85e-04 2.46e-04  1.31e-01    15s
  23   5.50251905e+04  8.13178874e+04  3.13e-04 1.68e-04  9.65e-02    15s
  24   5.70501234e+04  7.87188605e+04  2.55e-04 1.38e-04  7.95e-02    15s
  25   5.86555150e+04  7.48003993e+04  2.12e-04 9.11e-05  5.92e-02    15s
  26   6.14480493e+04  7.36907342e+04  1.39e-04 7.76e-05  4.49e-02    15s
  27   6.37184808e+04  7.09932849e+04  8.05e-05 4.49e-05  2.67e-02    16s
  28   6.51936473e+04  6.86870819e+04  4.49e-05 1.67e-05  1.28e-02    16s
  29   6.62327902e+04  6.82571052e+04  2.04e-05 1.16e-05  7.43e-03    16s
  30   6.66192797e+04  6.78709670e+04  1.24e-05 7.14e-06  4.59e-03    16s
  31   6.66809289e+04  6.77874607e+04  1.12e-05 6.16e-06  4.06e-03    16s
  32   6.68571517e+04  6.76128183e+04  7.51e-06 4.14e-06  2.77e-03    17s
  33   6.69652502e+04  6.75246258e+04  5.30e-06 3.13e-06  2.05e-03    17s
  34   6.70494233e+04  6.74696511e+04  3.57e-06 2.50e-06  1.54e-03    17s
  35   6.71337052e+04  6.73414544e+04  1.92e-06 1.10e-06  7.62e-04    17s
  36   6.71644735e+04  6.73061568e+04  1.37e-06 6.99e-07  5.20e-04    17s
  37   6.71844840e+04  6.72857049e+04  1.01e-06 4.72e-07  3.71e-04    18s
  38   6.71967009e+04  6.72687715e+04  7.96e-07 2.91e-07  2.64e-04    18s
  39   6.72186079e+04  6.72579487e+04  3.92e-07 1.72e-07  1.44e-04    18s
  40   6.72317361e+04  6.72527828e+04  1.68e-07 1.16e-07  7.72e-05    18s
  41   6.72325818e+04  6.72510894e+04  1.52e-07 9.79e-08  6.79e-05    19s
  42   6.72371894e+04  6.72492264e+04  7.33e-08 7.81e-08  4.42e-05    19s
  43   6.72382695e+04  6.72432501e+04  2.13e-07 1.51e-08  1.83e-05    19s
  44   6.72398128e+04  6.72429632e+04  1.42e-07 1.23e-08  1.16e-05    20s
  45   6.72409653e+04  6.72423257e+04  7.71e-08 6.18e-09  4.99e-06    20s
  46   6.72413195e+04  6.72422465e+04  5.35e-08 5.40e-09  3.40e-06    21s
  47   6.72416400e+04  6.72416790e+04  2.85e-08 3.13e-11  1.43e-07    21s
  48   6.72416723e+04  6.72416726e+04  3.67e-08 2.95e-08  1.18e-09    21s

Barrier solved model in 48 iterations and 21.24 seconds (18.61 work units)
Optimal objective 6.72416723e+04


Root crossover log...

  133241 DPushes remaining with DInf 0.0000000e+00                21s
   17946 DPushes remaining with DInf 0.0000000e+00                25s
       0 DPushes remaining with DInf 0.0000000e+00                28s

    8256 PPushes remaining with PInf 7.8975043e-05                28s
       0 PPushes remaining with PInf 0.0000000e+00                29s

  Push phase complete: Pinf 0.0000000e+00, Dinf 5.2542773e+01     29s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   69599    6.7241673e+04   0.000000e+00   5.254277e+01     29s
   69638    6.7241673e+04   0.000000e+00   0.000000e+00     29s
   69638    6.7241673e+04   0.000000e+00   0.000000e+00     29s
Concurrent spin time: 0.65s

Solved with barrier

Root relaxation: objective 6.724167e+04, 69638 iterations, 22.47 seconds (26.38 work units)
Total elapsed time = 30.13s (DegenMoves)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 67241.6725    0  158 -180138.75 67241.6725   137%     -   30s
H    0     0                    -74073.90523 67241.6725   191%     -   31s
H    0     0                    -12727.69170 67241.6725   628%     -   32s
H    0     0                    4260.3267304 67241.6725  1478%     -   32s
H    0     0                    20146.093816 67241.6725   234%     -   33s
H    0     0                    21289.393503 67241.6725   216%     -   33s
H    0     0                    21372.751947 67241.6725   215%     -   33s
H    0     0                    21442.391717 67241.6725   214%     -   33s
     0     0 61662.2461    0  205 21442.3917 61662.2461   188%     -   95s
     0     0 61000.7787    0  203 21442.3917 61000.7787   184%     -  131s
     0     0 60968.7139    0  211 21442.3917 60968.7139   184%     -  136s
     0     0 60965.8105    0  209 21442.3917 60965.8105   184%     -  142s
     0     0 60932.5021    0  209 21442.3917 60932.5021   184%     -  147s
     0     0 60932.2648    0  209 21442.3917 60932.2648   184%     -  149s
     0     0 57741.2124    0  264 21442.3917 57741.2124   169%     -  268s
H    0     0                    28025.248637 57739.1509   106%     -  269s
H    0     0                    28446.342752 57739.1509   103%     -  270s
H    0     0                    28467.172910 57739.1509   103%     -  270s
     0     0 57161.2161    0  266 28467.1729 57161.2161   101%     -  323s
     0     0 57033.1863    0  272 28467.1729 57033.1863   100%     -  343s
     0     0 56898.7629    0  281 28467.1729 56898.7629   100%     -  370s
     0     0 56867.9753    0  287 28467.1729 56867.9753   100%     -  382s
     0     0 56780.2486    0  286 28467.1729 56780.2486  99.5%     -  401s
     0     0 56759.6421    0  284 28467.1729 56759.6421  99.4%     -  407s
     0     0 56630.0275    0  300 28467.1729 56630.0275  98.9%     -  430s
     0     0 56513.1801    0  307 28467.1729 56513.1801  98.5%     -  452s
     0     0 56439.6059    0  308 28467.1729 56439.6059  98.3%     -  467s
     0     0 56150.0340    0  304 28467.1729 56150.0340  97.2%     -  495s
     0     0 56123.3096    0  295 28467.1729 56123.3096  97.2%     -  506s
     0     0 56106.8597    0  295 28467.1729 56106.8597  97.1%     -  512s
     0     0 56092.2375    0  294 28467.1729 56092.2375  97.0%     -  515s
     0     0 56084.2778    0  299 28467.1729 56084.2778  97.0%     -  517s
     0     0 56061.1258    0  306 28467.1729 56061.1258  96.9%     -  523s
     0     0 56052.3517    0  312 28467.1729 56052.3517  96.9%     -  527s
     0     0 56050.8797    0  311 28467.1729 56050.8797  96.9%     -  529s
     0     0 56050.7167    0  311 28467.1729 56050.7167  96.9%     -  530s
     0     0 53914.7235    0  318 28467.1729 53914.7235  89.4%     -  646s
     0     0 53513.9780    0  341 28467.1729 53513.9780  88.0%     -  695s
     0     0 53349.1701    0  322 28467.1729 53349.1701  87.4%     -  728s
     0     0 53262.0119    0  341 28467.1729 53262.0119  87.1%     -  755s
     0     0 53239.7259    0  333 28467.1729 53239.7259  87.0%     -  764s
     0     0 53228.6150    0  351 28467.1729 53228.6150  87.0%     -  772s
     0     0 53227.3150    0  346 28467.1729 53227.3150  87.0%     -  776s
     0     0 51850.0916    0  375 28467.1729 51850.0916  82.1%     -  862s
H    0     0                    28777.157390 51850.0739  80.2%     -  863s
H    0     0                    28858.897797 51850.0739  79.7%     -  863s
H    0     0                    28875.698947 51850.0739  79.6%     -  863s
H    0     0                    28894.655485 51850.0739  79.4%     -  863s
H    0     0                    28902.207929 51850.0739  79.4%     -  863s
H    0     0                    28909.221087 51850.0739  79.4%     -  863s
     0     0 51697.9393    0  369 28909.2211 51697.9393  78.8%     -  888s
     0     0 51666.3966    0  385 28909.2211 51666.3966  78.7%     -  898s
     0     0 51637.9885    0  364 28909.2211 51637.9885  78.6%     -  909s
     0     0 51611.8052    0  384 28909.2211 51611.8052  78.5%     -  919s
     0     0 51598.1371    0  390 28909.2211 51598.1371  78.5%     -  925s
     0     0 51565.2915    0  379 28909.2211 51565.2915  78.4%     -  932s
     0     0 51553.3267    0  381 28909.2211 51553.3267  78.3%     -  940s
     0     0 51551.9163    0  386 28909.2211 51551.9163  78.3%     -  942s
     0     0 51212.4872    0  374 28909.2211 51212.4872  77.1%     -  970s
     0     0 51076.1995    0  378 28909.2211 51076.1995  76.7%     -  991s
     0     0 50999.1910    0  373 28909.2211 50999.1910  76.4%     - 1001s
     0     0 50983.0334    0  384 28909.2211 50983.0334  76.4%     - 1013s
     0     0 50972.7104    0  386 28909.2211 50972.7104  76.3%     - 1021s
     0     0 50958.1190    0  401 28909.2211 50958.1190  76.3%     - 1031s
     0     0 50948.2899    0  429 28909.2211 50948.2899  76.2%     - 1040s
     0     0 50934.5948    0  414 28909.2211 50934.5948  76.2%     - 1051s
     0     0 50927.9025    0  423 28909.2211 50927.9025  76.2%     - 1058s
     0     0 50925.6109    0  429 28909.2211 50925.6109  76.2%     - 1062s
     0     0 50925.1232    0  421 28909.2211 50925.1232  76.2%     - 1063s
     0     0 50826.3626    0  380 28909.2211 50826.3626  75.8%     - 1081s
     0     0 50745.6104    0  367 28909.2211 50745.6104  75.5%     - 1103s
     0     0 50716.9580    0  380 28909.2211 50716.9580  75.4%     - 1113s
     0     0 50703.3108    0  376 28909.2211 50703.3108  75.4%     - 1121s
     0     0 50695.4499    0  376 28909.2211 50695.4499  75.4%     - 1126s
     0     0 50692.2826    0  385 28909.2211 50692.2826  75.3%     - 1130s
     0     0 50690.1355    0  379 28909.2211 50690.1355  75.3%     - 1132s
     0     0 50659.5210    0  378 28909.2211 50659.5210  75.2%     - 1147s
     0     0 50645.8477    0  383 28909.2211 50645.8477  75.2%     - 1156s
     0     0 50643.2498    0  387 28909.2211 50643.2498  75.2%     - 1162s
     0     0 50638.7009    0  385 28909.2211 50638.7009  75.2%     - 1167s
     0     0 50637.1222    0  388 28909.2211 50637.1222  75.2%     - 1170s
     0     0 50609.0537    0  388 28909.2211 50609.0537  75.1%     - 1190s
H    0     0                    28958.847196 50607.0779  74.8%     - 1193s
     0     0 50603.8825    0  388 28958.8472 50603.8825  74.7%     - 1200s
     0     0 50603.6330    0  390 28958.8472 50603.6330  74.7%     - 1202s
     0     0 50589.8627    0  379 28958.8472 50589.8627  74.7%     - 1210s
     0     0 50583.4256    0  377 28958.8472 50583.4256  74.7%     - 1215s
     0     0 50581.2070    0  380 28958.8472 50581.2070  74.7%     - 1217s
     0     0 50574.5668    0  387 28958.8472 50574.5668  74.6%     - 1224s
H    0     0                    28960.136756 50573.0394  74.6%     - 1229s
     0     0 50571.0086    0  369 28960.1368 50571.0086  74.6%     - 1234s
     0     0 50563.5044    0  375 28960.1368 50563.5044  74.6%     - 1238s
     0     0 50558.2319    0  384 28960.1368 50558.2319  74.6%     - 1242s
     0     0 50556.5011    0  370 28960.1368 50556.5011  74.6%     - 1246s
     0     0 50537.3157    0  387 28960.1368 50537.3157  74.5%     - 1254s
H    0     0                    28980.074628 50537.1592  74.4%     - 1256s
     0     0 50532.0419    0  381 28980.0746 50532.0419  74.4%     - 1260s
     0     0 50531.0712    0  397 28980.0746 50531.0712  74.4%     - 1262s
     0     0 50517.5719    0  381 28980.0746 50517.5719  74.3%     - 1272s
     0     0 50516.1056    0  407 28980.0746 50516.1056  74.3%     - 1291s
     0     0 50509.6509    0  374 28980.0746 50509.6509  74.3%     - 1297s
     0     0 50506.9616    0  387 28980.0746 50506.9616  74.3%     - 1302s
     0     0 50506.6598    0  382 28980.0746 50506.6598  74.3%     - 1303s
     0     0 50504.0848    0  382 28980.0746 50504.0848  74.3%     - 1308s
     0     0 50504.0111    0  382 28980.0746 50504.0111  74.3%     - 1313s
H    0     0                    29650.209335 50503.9582  70.3%     - 1565s
H    0     0                    29680.757430 50503.9582  70.2%     - 1580s
H    0     0                    29698.597338 50503.9582  70.1%     - 1588s
H    0     0                    29713.814748 50503.9582  70.0%     - 1589s
H    0     0                    29738.105653 50503.9582  69.8%     - 1589s
H    0     0                    29800.957256 50503.9582  69.5%     - 1590s
H    0     0                    29804.107457 50503.9582  69.5%     - 1590s
H    0     2                    29920.886077 50503.9582  68.8%     - 1601s
     0     2 50503.9582    0  382 29920.8861 50503.9582  68.8%     - 1601s
     1     4 50464.3738    1  362 29920.8861 50501.8295  68.8%  5101 1625s
     3     7 50399.3128    2  367 29920.8861 50463.6352  68.7%  8388 1656s
     6    10 49179.7556    3  378 29920.8861 50396.5604  68.4% 14062 1779s
     9    20 47992.0391    4  367 29920.8861 50396.5604  68.4% 20909 1830s
    19    40 47706.1592    5  332 29920.8861 49993.2680  67.1% 16824 1884s
    39    52 47870.1480    5  389 29920.8861 49730.7879  66.2% 23374 1990s
    51    74 47914.2089    6  371 29920.8861 49730.7879  66.2% 26146 2087s
H   52    74                    30493.435180 49730.7879  63.1% 25644 2087s
H   54    74                    30542.784301 49730.7879  62.8% 25381 2087s
H   58    74                    30752.727336 49730.7879  61.7% 24873 2087s
    73   165 47896.1497    7  370 30752.7273 49730.7879  61.7% 21983 2214s
   164   246 47800.9857   10  358 30752.7273 49730.7879  61.7% 13979 2290s
H  237   246                    30895.980092 49730.7879  61.0% 11473 2290s
   245   277 47594.7863   11  355 30895.9801 49730.7879  61.0% 11456 2379s
   276   312 47410.7764   11  349 30895.9801 49730.7879  61.0% 11084 2494s
   311   349 47467.1230   12  357 30895.9801 49730.7879  61.0% 10391 2546s
   348   383 47403.4352   13  339 30895.9801 49730.7879  61.0%  9794 2601s
   382   411 47080.1994   13  337 30895.9801 49730.7879  61.0%  9498 2658s
   412   434 47366.5296   14  331 30895.9801 49730.7879  61.0%  9185 2714s
H  418   434                    31101.861168 49730.7879  59.9%  9174 2714s
   437   513 47296.6094   15  333 31101.8612 49730.7879  59.9%  9085 2776s
   518   590 47075.6847   17  284 31101.8612 49730.7879  59.9%  9079 2844s
H  545   590                    31282.771686 49730.7879  59.0%  8879 2844s
   595   662 46444.8248   18  283 31282.7717 49730.7879  59.0%  8595 2908s
   667   738 46355.8452   20  284 31282.7717 49730.7879  59.0%  8273 2967s
   749   810 46451.8094   12  271 31282.7717 49730.7879  59.0%  7867 3024s
   826   838 40915.3769   13  224 31282.7717 49730.7879  59.0%  7531 3068s
   856   863 46047.1311   19  255 31282.7717 49730.7879  59.0%  7451 3121s
   885   888 45411.6844   20  243 31282.7717 49730.7879  59.0%  7408 3179s
H  897   888                    31312.732540 49730.7879  58.8%  7387 3179s
   914   984 45347.5470   21  242 31312.7325 49730.7879  58.8%  7356 3240s
  1013  1013 45128.2640   22  235 31312.7325 49730.7879  58.8%  7081 3285s
  1045  1040 44932.5963   23  235 31312.7325 49730.7879  58.8%  6979 3324s
  1078  1071 35205.4289   16  182 31312.7325 49730.7879  58.8%  6918 3372s
  1109  1103 44818.9905   24  233 31312.7325 49730.7879  58.8%  6847 3418s
  1141  1134 44839.3551   24  228 31312.7325 49730.7879  58.8%  6829 3464s
  1174  1176 44323.2409   25  242 31312.7325 49730.7879  58.8%  6788 3511s
  1216  1218 44793.4053   25  232 31312.7325 49730.7879  58.8%  6672 3555s
H 1218  1218                    31336.490575 49730.7879  58.7%  6671 3555s
H 1251  1218                    31348.970863 49730.7879  58.6%  6589 3555s
  1260  1324 44536.2617   26  232 31348.9709 49730.7879  58.6%  6580 3600s

Cutting planes:
  Gomory: 11
  Implied bound: 165
  MIR: 3455
  Flow cover: 3310
  RLT: 65
  Relax-and-lift: 565

Explored 1384 nodes (9417309 simplex iterations) in 3600.08 seconds (5298.89 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 31349 31336.5 31312.7 ... 29920.9

Time limit reached
Best objective 3.134897086250e+04, best bound 4.973078790773e+04, gap 58.6361%
  WARNING: Time limit reached. Using best solution found (gap: 58.64%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.10s
  Master Objective (UB) = 31348.97, θ = 183811.32
  Upper Bound (UB) = 31348.97

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 183811.32
  [DEBUG]   ✓ Scenario 0: θ = 183811.32 ≤ Q = 183811.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 183811.32 ≤ Q = 183811.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 183811.32 ≤ Q = 183811.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 183811.32 ≤ Q = 183811.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 183811.32 ≤ Q = 183811.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 183811.32 ≤ Q = 183811.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 183811.32 ≤ Q = 183811.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 183811.32 ≤ Q = 183811.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 183811.32 ≤ Q = 183811.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 183811.32 ≤ Q = 183811.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 183811.32 ≤ Q = 183811.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 183811.32 ≤ Q = 183811.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 183811.32 ≤ Q = 183811.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 183811.32 ≤ Q = 183811.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 183811.32 ≤ Q = 183811.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 183811.32 ≤ Q = 183811.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 183811.32 ≤ Q = 183811.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 183811.32 ≤ Q = 183811.32 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 18] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x317f9067
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x317f9067
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [7e-01, 2e+02]
Found heuristic solution: objective 1.390615e+13
Presolve removed 2606 rows and 1897 columns
Presolve time: 0.01s
Presolved: 487 rows, 492 columns, 1374 nonzeros
Found heuristic solution: objective 6780299.9227
Variable types: 333 continuous, 159 integer (159 binary)

Root relaxation: objective -1.555670e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -155567.04    0  127 6780299.92 -155567.04   102%     -    0s
H    0     0                    -112700.2512 -155567.04  38.0%     -    0s
H    0     0                    -113038.9427 -155567.04  37.6%     -    0s
H    0     0                    -113317.0632 -155438.56  37.2%     -    0s
H    0     0                    -115234.2960 -133617.22  16.0%     -    0s
H    0     0                    -120830.0741 -133617.22  10.6%     -    0s
     0     0 -133617.22    0   90 -120830.07 -133617.22  10.6%     -    0s
H    0     0                    -130145.0365 -133583.75  2.64%     -    0s
H    0     0                    -130457.8024 -133583.75  2.40%     -    0s
H    0     0                    -130572.7997 -133583.75  2.31%     -    0s
H    0     0                    -130885.5656 -133583.75  2.06%     -    0s
     0     0 -133439.57    0   85 -130885.57 -133439.57  1.95%     -    0s
     0     0 -132262.50    0   75 -130885.57 -132262.50  1.05%     -    0s
     0     0 -132176.94    0   75 -130885.57 -132176.94  0.99%     -    0s
     0     0 -131944.24    0   61 -130885.57 -131944.24  0.81%     -    0s
     0     0 -131891.40    0   78 -130885.57 -131891.40  0.77%     -    0s
     0     0 -131690.36    0   58 -130885.57 -131690.36  0.61%     -    0s
     0     0 -131677.19    0   58 -130885.57 -131677.19  0.60%     -    0s
     0     0 -131644.07    0   43 -130885.57 -131644.07  0.58%     -    0s
H    0     0                    -131226.9852 -131642.79  0.32%     -    0s
H    0     0                    -131321.4799 -131642.79  0.24%     -    0s
H    0     0                    -131438.3922 -131642.79  0.16%     -    0s
     0     0 -131642.06    0   42 -131438.39 -131642.06  0.15%     -    0s
     0     0 -131612.51    0   11 -131438.39 -131612.51  0.13%     -    0s
     0     0 -131612.51    0   54 -131438.39 -131612.51  0.13%     -    0s
     0     0 -131612.51    0   54 -131438.39 -131612.51  0.13%     -    0s
H    0     0                    -131470.3696 -131612.51  0.11%     -    0s
     0     0 -131581.93    0   39 -131470.37 -131581.93  0.08%     -    0s
H    0     0                    -131506.6825 -131579.03  0.06%     -    0s
H    0     0                    -131511.9641 -131579.03  0.05%     -    0s
     0     0 -131574.13    0   10 -131511.96 -131574.13  0.05%     -    0s
*    0     0               0    -131555.8527 -131555.85  0.00%     -    0s

Cutting planes:
  Gomory: 12
  Implied bound: 8
  MIR: 53
  Flow cover: 15

Explored 1 nodes (831 simplex iterations) in 0.16 seconds (0.05 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -131556 -131512 -131507 ... -120830
No other solutions better than -131556

Optimal solution found (tolerance 1.00e-06)
Best objective -1.315558527151e+05, best bound -1.315558527151e+05, gap 0.0000%
  Subproblem solved in 0.19s
  Worst-case operational profit (Z_SP) = 175957.80
  Scenario: 23 demand increases, 37 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -131555.85
  [DEBUG]   S×d_nominal = 307513.65
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 307513.65 + -131555.85 = 175957.80
  [DEBUG]   Current θ from Master = 183811.32
  [DEBUG]   ⚠️  Z_SP ≤ θ by 7853.53 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 23495.44
  Lower Bound (LB) = 29447.80
  Gap (UB-LB) = 1901.1700, Absolute Gap = 1901.1700, Relative Gap = 0.060645
  Not converged yet (gap = 1901.17 > ε = 200)

  [DEBUG] Adding NEW scenario 18 to Master Problem...
  [DEBUG] New scenario pattern: 23 increases, 37 decreases
    [DEBUG] Scenario 18 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 18 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 18]
    [DEBUG]   - Total constraints in model: 291893
    [DEBUG]   - Total variables in model: 120820
  [DEBUG] Total scenarios in Master: 19
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 19
================================================================================
[Iteration 19] Solving Master Problem...
  Current scenarios in Master: 19
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 291893 rows, 120820 columns and 826908 nonzeros
Model fingerprint: 0x9b8f9818
Variable types: 118561 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 134330 rows and 54530 columns (presolve time = 5s)...
Presolve removed 134330 rows and 54530 columns
Presolve time: 5.71s
Presolved: 157563 rows, 66290 columns, 969713 nonzeros
Variable types: 64031 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -335473.7764
Found heuristic solution: objective -180138.7472

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.68s

Barrier statistics:
 Dense cols : 625
 AA' NZ     : 8.883e+06
 Factor NZ  : 1.992e+07 (roughly 250 MB of memory)
 Factor Ops : 5.161e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.89524636e+07  2.85350014e+08  1.40e+05 1.41e+01  8.93e+04     9s
   1  -1.46936668e+07  2.65893809e+08  9.93e+04 7.53e+01  6.28e+04     9s
   2  -6.19428141e+06  1.97327635e+08  4.10e+04 5.49e+00  2.76e+04     9s
   3  -1.97290719e+06  1.64708128e+08  8.36e+03 1.79e+00  6.02e+03     9s
   4  -7.91746403e+05  1.28768240e+08  1.11e+03 9.64e-01  1.14e+03    10s
   5  -5.14654973e+05  7.85373842e+07  5.49e+02 5.23e-01  5.92e+02    10s
   6  -4.12421004e+05  5.67527336e+07  2.01e+02 3.52e-01  3.08e+02    10s
   7  -3.78763687e+05  4.04792989e+07  9.46e+01 2.34e-01  1.88e+02    10s
   8  -3.31968322e+05  2.79995179e+07  2.33e+01 1.54e-01  1.08e+02    10s
   9  -2.34756213e+05  1.47646058e+07  7.85e-01 7.83e-02  5.24e+01    10s
  10  -1.37598927e+05  3.66989461e+06  2.09e-01 1.81e-02  1.33e+01    11s
  11  -9.50619939e+04  2.68639328e+06  1.29e-01 1.32e-02  9.69e+00    11s
  12  -6.99222912e+04  1.73132383e+06  7.85e-02 8.57e-03  6.27e+00    11s
  13  -4.44209863e+04  1.01950551e+06  4.58e-02 4.93e-03  3.70e+00    11s
  14  -1.31229089e+04  3.52936566e+05  2.31e-02 1.67e-03  1.27e+00    11s
  15   8.11787307e+03  2.25941223e+05  1.34e-02 1.14e-03  7.58e-01    11s
  16   2.34232517e+04  1.73569804e+05  9.12e-03 7.71e-04  5.23e-01    11s
  17   3.36050436e+04  1.29081153e+05  6.47e-03 6.15e-04  3.32e-01    12s
  18   3.99341344e+04  1.09135551e+05  4.95e-03 4.40e-04  2.41e-01    12s
  19   4.17722197e+04  1.04519109e+05  4.53e-03 3.94e-04  2.18e-01    12s
  20   4.68800446e+04  9.56820632e+04  3.40e-03 3.07e-04  1.70e-01    12s
  21   4.92388607e+04  9.07441843e+04  2.94e-03 2.56e-04  1.44e-01    13s
  22   5.53052147e+04  8.35768559e+04  1.79e-03 1.83e-04  9.84e-02    13s
  23   5.69891982e+04  7.87869011e+04  1.51e-03 1.33e-04  7.59e-02    13s
  24   5.84973211e+04  7.65920829e+04  1.26e-03 1.09e-04  6.30e-02    13s
  25   6.06100181e+04  7.40326478e+04  9.22e-04 7.98e-05  4.67e-02    14s
  26   6.30535859e+04  7.20008463e+04  5.45e-04 5.63e-05  3.11e-02    14s
  27   6.41027413e+04  6.99932002e+04  3.95e-04 3.29e-05  2.05e-02    14s
  28   6.49497422e+04  6.89051706e+04  2.76e-04 2.02e-05  1.38e-02    14s
  29   6.53980016e+04  6.83163468e+04  2.15e-04 1.36e-05  1.02e-02    15s
  30   6.59243273e+04  6.81983182e+04  1.45e-04 1.22e-05  7.91e-03    15s
  31   6.64096326e+04  6.77576020e+04  8.21e-05 7.26e-06  4.69e-03    15s
  32   6.67096323e+04  6.75917690e+04  4.61e-05 5.47e-06  3.07e-03    15s
  33   6.68308563e+04  6.75028351e+04  3.08e-05 4.51e-06  2.34e-03    16s
  34   6.68969503e+04  6.74120407e+04  2.28e-05 3.49e-06  1.79e-03    16s
  35   6.69359651e+04  6.73597293e+04  1.81e-05 2.90e-06  1.47e-03    16s
  36   6.70175970e+04  6.72368539e+04  8.59e-06 1.56e-06  7.63e-04    16s
  37   6.70653449e+04  6.71438185e+04  3.33e-06 5.59e-07  2.73e-04    17s
  38   6.70896473e+04  6.71190302e+04  9.37e-07 2.37e-07  1.02e-04    17s
  39   6.70978619e+04  6.71066803e+04  1.98e-07 2.05e-07  3.07e-05    17s
  40   6.71003957e+04  6.71008112e+04  4.26e-08 4.80e-09  1.45e-06    18s
  41   6.71006188e+04  6.71006199e+04  1.10e-09 5.62e-11  3.82e-09    18s
  42   6.71006195e+04  6.71006195e+04  5.94e-09 2.58e-10  2.54e-11    18s

Barrier solved model in 42 iterations and 18.04 seconds (15.94 work units)
Optimal objective 6.71006195e+04


Root crossover log...

  141349 DPushes remaining with DInf 0.0000000e+00                18s
   26882 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                23s

    2117 PPushes remaining with PInf 7.7397661e-06                23s
       0 PPushes remaining with PInf 0.0000000e+00                23s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.9496101e-01     23s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   58533    6.7100620e+04   0.000000e+00   2.949610e-01     23s
   58534    6.7100620e+04   0.000000e+00   0.000000e+00     23s
   58534    6.7100620e+04   0.000000e+00   0.000000e+00     24s
Concurrent spin time: 0.02s

Solved with barrier

Root relaxation: objective 6.710062e+04, 58534 iterations, 16.64 seconds (18.46 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 67100.6195    0  152 -180138.75 67100.6195   137%     -   24s
H    0     0                    -178226.8343 67100.6195   138%     -   24s
H    0     0                    -125853.1236 67100.6195   153%     -   25s
H    0     0                    -94657.24846 67100.6195   171%     -   25s
H    0     0                    -92591.40333 67100.6195   172%     -   25s
H    0     0                    -92251.17063 67100.6195   173%     -   26s
H    0     0                    -92250.81107 67100.6195   173%     -   26s
H    0     0                    -68792.12085 67100.6195   198%     -   26s
H    0     0                    13604.962689 67100.6195   393%     -   27s
H    0     0                    20597.970000 67100.6195   226%     -   28s
H    0     0                    20737.832757 67100.6195   224%     -   28s
H    0     0                    20779.739073 67100.6195   223%     -   28s
H    0     0                    21276.363688 67100.6195   215%     -   28s
H    0     0                    21312.389264 67100.6195   215%     -   28s
H    0     0                    21332.395292 67100.6195   215%     -   28s
H    0     0                    21406.257423 67100.6195   213%     -   28s
     0     0 61513.0332    0  200 21406.2574 61513.0332   187%     -   99s
H    0     0                    21530.484291 61512.8999   186%     -  101s
     0     0 61037.9639    0  196 21530.4843 61037.9639   183%     -  129s
     0     0 61034.3548    0  203 21530.4843 61034.3548   183%     -  133s
     0     0 61034.3443    0  210 21530.4843 61034.3443   183%     -  134s
     0     0 57749.7460    0  257 21530.4843 57749.7460   168%     -  242s
     0     0 57748.9266    0  259 21530.4843 57748.9266   168%     -  243s
H    0     0                    24408.816686 57746.5666   137%     -  245s
H    0     0                    24472.681803 57746.5666   136%     -  245s
H    0     0                    24521.705179 57746.5666   135%     -  245s
H    0     0                    24571.839979 57746.5666   135%     -  245s
     0     0 56884.7862    0  291 24571.8400 56884.7862   132%     -  317s
     0     0 56729.3313    0  284 24571.8400 56729.3313   131%     -  356s
     0     0 56682.5899    0  286 24571.8400 56682.5899   131%     -  377s
     0     0 56669.8229    0  287 24571.8400 56669.8229   131%     -  393s
     0     0 56656.3832    0  288 24571.8400 56656.3832   131%     -  401s
     0     0 56652.1494    0  291 24571.8400 56652.1494   131%     -  410s
     0     0 56649.7584    0  291 24571.8400 56649.7584   131%     -  417s
     0     0 56638.5609    0  291 24571.8400 56638.5609   131%     -  423s
     0     0 56592.3324    0  292 24571.8400 56592.3324   130%     -  447s
     0     0 56586.8562    0  293 24571.8400 56586.8562   130%     -  453s
     0     0 56582.4243    0  294 24571.8400 56582.4243   130%     -  461s
     0     0 56580.3484    0  295 24571.8400 56580.3484   130%     -  463s
     0     0 56579.2283    0  294 24571.8400 56579.2283   130%     -  467s
     0     0 54585.9840    0  358 24571.8400 54585.9840   122%     -  603s
H    0     0                    24631.037575 54585.8911   122%     -  604s
H    0     0                    24662.123100 54585.8911   121%     -  605s
     0     0 54160.7493    0  337 24662.1231 54160.7493   120%     -  673s
     0     0 54026.4832    0  347 24662.1231 54026.4832   119%     -  715s
     0     0 53996.2556    0  353 24662.1231 53996.2556   119%     -  739s
     0     0 53931.9574    0  350 24662.1231 53931.9574   119%     -  769s
     0     0 53804.1744    0  345 24662.1231 53804.1744   118%     -  814s
     0     0 53704.6852    0  353 24662.1231 53704.6852   118%     -  849s
     0     0 53671.1011    0  365 24662.1231 53671.1011   118%     -  882s
     0     0 53657.2658    0  365 24662.1231 53657.2658   118%     -  901s
     0     0 53647.5444    0  359 24662.1231 53647.5444   118%     -  914s
     0     0 53634.3892    0  361 24662.1231 53634.3892   117%     -  933s
     0     0 53593.5034    0  359 24662.1231 53593.5034   117%     -  958s
     0     0 53579.2913    0  369 24662.1231 53579.2913   117%     -  969s
     0     0 53570.4994    0  357 24662.1231 53570.4994   117%     -  981s
     0     0 53565.8925    0  360 24662.1231 53565.8925   117%     -  986s
     0     0 53511.2903    0  363 24662.1231 53511.2903   117%     -  998s
     0     0 53498.2460    0  367 24662.1231 53498.2460   117%     - 1012s
     0     0 53496.0308    0  364 24662.1231 53496.0308   117%     - 1017s
     0     0 53495.2848    0  386 24662.1231 53495.2848   117%     - 1020s
     0     0 52110.1236    0  336 24662.1231 52110.1236   111%     - 1142s
H    0     0                    25742.162162 52108.6967   102%     - 1144s
H    0     0                    29281.103754 52108.6967  78.0%     - 1144s
H    0     0                    29771.219674 52108.6967  75.0%     - 1145s
     0     0 51823.3650    0  346 29771.2197 51823.3650  74.1%     - 1183s
     0     0 51681.7204    0  337 29771.2197 51681.7204  73.6%     - 1205s
     0     0 51569.4271    0  345 29771.2197 51569.4271  73.2%     - 1218s
     0     0 51551.0755    0  365 29771.2197 51551.0755  73.2%     - 1225s
     0     0 51510.4864    0  362 29771.2197 51510.4864  73.0%     - 1232s
     0     0 51490.4979    0  366 29771.2197 51490.4979  73.0%     - 1237s
     0     0 51451.8966    0  350 29771.2197 51451.8966  72.8%     - 1252s
     0     0 51440.5370    0  352 29771.2197 51440.5370  72.8%     - 1258s
     0     0 51421.3180    0  364 29771.2197 51421.3180  72.7%     - 1264s
     0     0 51409.9618    0  367 29771.2197 51409.9618  72.7%     - 1269s
     0     0 51403.5677    0  368 29771.2197 51403.5677  72.7%     - 1274s
     0     0 51396.9071    0  367 29771.2197 51396.9071  72.6%     - 1276s
     0     0 51379.8502    0  364 29771.2197 51379.8502  72.6%     - 1283s
     0     0 51378.5590    0  370 29771.2197 51378.5590  72.6%     - 1287s
     0     0 51185.6246    0  364 29771.2197 51185.6246  71.9%     - 1312s
H    0     0                    30007.944312 51185.5306  70.6%     - 1314s
     0     0 51128.7243    0  377 30007.9443 51128.7243  70.4%     - 1329s
     0     0 51124.1440    0  379 30007.9443 51124.1440  70.4%     - 1334s
     0     0 51070.2470    0  363 30007.9443 51070.2470  70.2%     - 1347s
     0     0 51001.3247    0  374 30007.9443 51001.3247  70.0%     - 1359s
     0     0 50990.0908    0  375 30007.9443 50990.0908  69.9%     - 1364s
     0     0 50958.1805    0  368 30007.9443 50958.1805  69.8%     - 1374s
     0     0 50942.9884    0  373 30007.9443 50942.9884  69.8%     - 1386s
     0     0 50929.8092    0  379 30007.9443 50929.8092  69.7%     - 1392s
     0     0 50929.2374    0  384 30007.9443 50929.2374  69.7%     - 1394s
     0     0 50872.3511    0  386 30007.9443 50872.3511  69.5%     - 1411s
H    0     0                    30062.944047 50871.4573  69.2%     - 1418s
     0     0 50851.8355    0  393 30062.9440 50851.8355  69.2%     - 1428s
     0     0 50839.8045    0  391 30062.9440 50839.8045  69.1%     - 1437s
     0     0 50835.8480    0  390 30062.9440 50835.8480  69.1%     - 1446s
     0     0 50825.6824    0  390 30062.9440 50825.6824  69.1%     - 1453s
     0     0 50820.3631    0  392 30062.9440 50820.3631  69.0%     - 1459s
     0     0 50810.1712    0  396 30062.9440 50810.1712  69.0%     - 1465s
     0     0 50800.3061    0  393 30062.9440 50800.3061  69.0%     - 1470s
     0     0 50794.1846    0  398 30062.9440 50794.1846  69.0%     - 1478s
     0     0 50791.8425    0  397 30062.9440 50791.8425  69.0%     - 1483s
     0     0 50782.8796    0  388 30062.9440 50782.8796  68.9%     - 1486s
     0     0 50779.9651    0  392 30062.9440 50779.9651  68.9%     - 1491s
     0     0 50776.5501    0  386 30062.9440 50776.5501  68.9%     - 1494s
     0     0 50775.0592    0  393 30062.9440 50775.0592  68.9%     - 1498s
     0     0 50712.4696    0  372 30062.9440 50712.4696  68.7%     - 1522s
H    0     0                    30092.476463 50711.3659  68.5%     - 1524s
H    0     0                    30108.160732 50711.3659  68.4%     - 1524s
     0     0 50684.7214    0  370 30108.1607 50684.7214  68.3%     - 1535s
     0     0 50673.1625    0  387 30108.1607 50673.1625  68.3%     - 1540s
     0     0 50667.9124    0  396 30108.1607 50667.9124  68.3%     - 1544s
     0     0 50657.3479    0  392 30108.1607 50657.3479  68.3%     - 1549s
     0     0 50655.4719    0  390 30108.1607 50655.4719  68.2%     - 1551s
     0     0 50625.3209    0  378 30108.1607 50625.3209  68.1%     - 1563s
H    0     0                    30145.437353 50625.0765  67.9%     - 1567s
     0     0 50620.1121    0  376 30145.4374 50620.1121  67.9%     - 1572s
     0     0 50619.1402    0  376 30145.4374 50619.1402  67.9%     - 1575s
     0     0 50608.2747    0  375 30145.4374 50608.2747  67.9%     - 1584s
     0     0 50605.2551    0  375 30145.4374 50605.2551  67.9%     - 1591s
     0     0 50603.6142    0  410 30145.4374 50603.6142  67.9%     - 1593s
     0     0 50581.5804    0  381 30145.4374 50581.5804  67.8%     - 1606s
H    0     0                    30150.166522 50581.0938  67.8%     - 1610s
     0     0 50561.8248    0  378 30150.1665 50561.8248  67.7%     - 1622s
     0     0 50558.8282    0  384 30150.1665 50558.8282  67.7%     - 1627s
     0     0 50558.6617    0  384 30150.1665 50558.6617  67.7%     - 1629s
     0     0 50541.1787    0  412 30150.1665 50541.1787  67.6%     - 1646s
     0     0 50534.3526    0  385 30150.1665 50534.3526  67.6%     - 1653s
     0     0 50532.9618    0  389 30150.1665 50532.9618  67.6%     - 1656s
     0     0 50501.2223    0  410 30150.1665 50501.2223  67.5%     - 1677s
     0     0 50495.7770    0  418 30150.1665 50495.7770  67.5%     - 1711s
     0     0 50494.8662    0  390 30150.1665 50494.8662  67.5%     - 1716s
     0     0 50490.5025    0  383 30150.1665 50490.5025  67.5%     - 1727s
     0     0 50485.6052    0  384 30150.1665 50485.6052  67.4%     - 1736s
     0     0 50483.1400    0  384 30150.1665 50483.1400  67.4%     - 1745s
     0     0 50481.5879    0  384 30150.1665 50481.5879  67.4%     - 1749s
     0     0 50476.6456    0  384 30150.1665 50476.6456  67.4%     - 1754s
H    0     0                    30163.257729 50476.1437  67.3%     - 1767s
H    0     0                    30179.663349 50476.1437  67.3%     - 1768s
     0     0 50473.1610    0  382 30179.6633 50473.1610  67.2%     - 1771s
     0     0 50469.6045    0  383 30179.6633 50469.6045  67.2%     - 1779s
     0     0 50469.3731    0  388 30179.6633 50469.3731  67.2%     - 1780s
     0     0 50455.0336    0  388 30179.6633 50455.0336  67.2%     - 1788s
     0     0 50453.8700    0  388 30179.6633 50453.8700  67.2%     - 1795s
H    0     0                    30213.241465 50453.8700  67.0%     - 2083s
     0     2 50453.8700    0  388 30213.2415 50453.8700  67.0%     - 2089s
     1     3 49964.1224    1  322 30213.2415 50453.8700  67.0% 23049 2139s
     2     4 50303.2412    1  378 30213.2415 50303.2412  66.5% 18098 2170s
     3     8 49963.7369    2  375 30213.2415 50302.8263  66.5% 19272 2208s
     7    16 49902.6273    3  374 30213.2415 50241.1538  66.3% 14369 2347s
    15    32 49836.7438    4  364 30213.2415 50211.0537  66.2% 18019 2392s
    31    48 48807.8466    5  413 30213.2415 50129.6799  65.9% 26356 2500s
    47    79 47579.8584    6  409 30213.2415 50129.6799  65.9% 28941 2598s
H   56    79                    30271.766213 50129.6799  65.6% 27029 2598s
    78   183 47543.7985    7  361 30271.7662 50129.6799  65.6% 23735 2696s
   182   277 47440.6088   10  399 30271.7662 50129.6799  65.6% 14408 2753s
   276   329 45821.1402   14  307 30271.7662 50129.6799  65.6% 12122 2800s
   328   356 45799.8519   15  314 30271.7662 50129.6799  65.6% 11204 2851s
   355   375 46694.9942   13  278 30271.7662 50129.6799  65.6% 11585 2898s
   374   416 47678.2056   11  331 30271.7662 50129.6799  65.6% 11558 2941s
   415   439 45507.5809   15  321 30271.7662 50129.6799  65.6% 11480 2988s
H  426   439                    30409.647253 50129.6799  64.8% 11540 2988s
   440   483 34854.7027   22  206 30409.6473 50129.6799  64.8% 11681 3044s
   490   504 42732.6369   16  240 30409.6473 50129.6799  64.8% 11087 3098s
   515   532 41983.8957   17  278 30409.6473 50129.6799  64.8% 10837 3147s
   543   565 41805.0830   18  262 30409.6473 50129.6799  64.8% 10673 3199s
H  546   565                    30410.989471 50129.6799  64.8% 10628 3199s
   576   590 41572.8900   21  253 30410.9895 50129.6799  64.8% 10391 3245s
   605   618 41307.1925   22  266 30410.9895 50129.6799  64.8% 10113 3296s
   651   655 41304.3870   23  262 30410.9895 50129.6799  64.8%  9738 3338s
H  668   655                    30448.714528 50129.6799  64.6%  9591 3338s
   694   722 40537.4467   24  286 30448.7145 50129.6799  64.6%  9410 3388s
   775   769 40508.1026   25  279 30448.7145 50129.6799  64.6%  8896 3437s
   840   814 44314.1160   15  214 30448.7145 50129.6799  64.6%  8554 3487s
   923   853 40600.8254   14  224 30448.7145 50129.6799  64.6%  8184 3538s
   988   907 40755.4119   24  263 30448.7145 50129.6799  64.6%  7960 3597s
  1068   914 infeasible   34      30448.7145 50129.6799  64.6%  7718 3600s

Cutting planes:
  Gomory: 24
  Implied bound: 212
  MIR: 3251
  Flow cover: 3535
  RLT: 50
  Relax-and-lift: 531
  BQP: 1

Explored 1077 nodes (9056581 simplex iterations) in 3600.07 seconds (4679.41 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 30448.7 30411 30409.6 ... 30108.2

Time limit reached
Best objective 3.044871452785e+04, best bound 5.012967987603e+04, gap 64.6364%
  WARNING: Time limit reached. Using best solution found (gap: 64.64%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.10s
  Master Objective (UB) = 30448.71, θ = 183732.93
  Upper Bound (UB) = 30448.71

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 183732.93
  [DEBUG]   ✓ Scenario 0: θ = 183732.93 ≤ Q = 183732.93 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 183732.93 ≤ Q = 183732.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 183732.93 ≤ Q = 183732.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 183732.93 ≤ Q = 183732.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 183732.93 ≤ Q = 183732.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 183732.93 ≤ Q = 183732.93 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 183732.93 ≤ Q = 183732.93 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 183732.93 ≤ Q = 183732.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 183732.93 ≤ Q = 183732.93 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 183732.93 ≤ Q = 183732.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 183732.93 ≤ Q = 183732.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 183732.93 ≤ Q = 183732.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 183732.93 ≤ Q = 183732.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 183732.93 ≤ Q = 183732.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 183732.93 ≤ Q = 183732.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 183732.93 ≤ Q = 183732.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 183732.93 ≤ Q = 183732.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 183732.93 ≤ Q = 183732.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 183732.93 ≤ Q = 183732.93 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 19] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x6dcd3eda
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x9232c126
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.424836e+13
Presolve removed 2598 rows and 1890 columns
Presolve time: 0.01s
Presolved: 495 rows, 499 columns, 1396 nonzeros
Found heuristic solution: objective 6810703.2944
Variable types: 339 continuous, 160 integer (160 binary)

Root relaxation: objective -1.576104e+05, 254 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -157610.42    0  128 6810703.29 -157610.42   102%     -    0s
H    0     0                    -118945.6310 -157610.42  32.5%     -    0s
H    0     0                    -120461.1664 -157610.42  30.8%     -    0s
H    0     0                    -121429.4476 -136166.50  12.1%     -    0s
H    0     0                    -125306.8366 -136166.50  8.67%     -    0s
H    0     0                    -132263.0607 -136166.50  2.95%     -    0s
     0     0 -136166.50    0   86 -132263.06 -136166.50  2.95%     -    0s
H    0     0                    -132881.6143 -136033.74  2.37%     -    0s
     0     0 -136033.74    0   86 -132881.61 -136033.74  2.37%     -    0s
     0     0 -134458.18    0   84 -132881.61 -134458.18  1.19%     -    0s
     0     0 -134343.71    0   83 -132881.61 -134343.71  1.10%     -    0s
     0     0 -133987.21    0   57 -132881.61 -133987.21  0.83%     -    0s
     0     0 -133946.01    0   68 -132881.61 -133946.01  0.80%     -    0s
     0     0 -133942.61    0   68 -132881.61 -133942.61  0.80%     -    0s
     0     0 -133650.61    0   72 -132881.61 -133650.61  0.58%     -    0s
     0     0 -133636.91    0   74 -132881.61 -133636.91  0.57%     -    0s
     0     0 -133562.20    0   74 -132881.61 -133562.20  0.51%     -    0s
     0     0 -133555.43    0   74 -132881.61 -133555.43  0.51%     -    0s
     0     2 -133528.34    0   74 -132881.61 -133528.34  0.49%     -    0s
H  375    78                    -132890.8289 -133026.83  0.10%   5.8    0s
H  441    78                    -132908.6164 -133026.83  0.09%   5.6    0s
H  465    78                    -132915.9876 -133026.83  0.08%   5.5    0s
*  502    18              24    -132919.8966 -133004.03  0.06%   5.4    0s
H  560    27                    -132946.0814 -133004.03  0.04%   5.0    0s

Cutting planes:
  Gomory: 61
  Implied bound: 14
  MIR: 136
  Flow cover: 6
  RLT: 36
  Relax-and-lift: 1
  BQP: 1

Explored 654 nodes (3713 simplex iterations) in 0.37 seconds (0.11 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -132946 -132920 -132916 ... -118946
No other solutions better than -132946

Optimal solution found (tolerance 1.00e-06)
Best objective -1.329460814372e+05, best bound -1.329460814372e+05, gap 0.0000%
  Subproblem solved in 0.41s
  Worst-case operational profit (Z_SP) = 175047.66
  Scenario: 39 demand increases, 21 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -132946.08
  [DEBUG]   S×d_nominal = 307993.74
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 307993.74 + -132946.08 = 175047.66
  [DEBUG]   Current θ from Master = 183732.93
  [DEBUG]   ⚠️  Z_SP ≤ θ by 8685.27 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 21763.45
  Lower Bound (LB) = 29447.80
  Gap (UB-LB) = 1000.9136, Absolute Gap = 1000.9136, Relative Gap = 0.032872
  Not converged yet (gap = 1000.91 > ε = 200)

  [DEBUG] Adding NEW scenario 19 to Master Problem...
  [DEBUG] New scenario pattern: 39 increases, 21 decreases
    [DEBUG] Scenario 19 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 19 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 19]
    [DEBUG]   - Total constraints in model: 307183
    [DEBUG]   - Total variables in model: 127060
  [DEBUG] Total scenarios in Master: 20
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 20
================================================================================
[Iteration 20] Solving Master Problem...
  Current scenarios in Master: 20
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 307183 rows, 127060 columns and 870139 nonzeros
Model fingerprint: 0xd4f495b0
Variable types: 124801 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 141400 rows and 57400 columns (presolve time = 5s)...
Presolve removed 141400 rows and 57400 columns
Presolve time: 6.72s
Presolved: 165783 rows, 69660 columns, 1020288 nonzeros
Variable types: 67401 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -335473.7764
Found heuristic solution: objective -180138.7472

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.55s

Barrier statistics:
 Dense cols : 1144
 AA' NZ     : 4.073e+06
 Factor NZ  : 1.147e+07 (roughly 200 MB of memory)
 Factor Ops : 3.895e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.93579543e+07  2.98616759e+08  1.43e+05 1.38e+01  9.08e+04    10s
   1  -1.50308096e+07  2.78957171e+08  1.01e+05 7.51e+01  6.38e+04    10s
   2  -6.43702241e+06  2.08086099e+08  4.25e+04 7.96e+00  2.85e+04    10s
   3  -1.37037830e+06  1.73594937e+08  4.62e+03 2.61e+00  3.56e+03    10s
   4  -6.37117159e+05  1.04900715e+08  8.33e+02 9.73e-01  8.44e+02    10s
   5  -5.09347645e+05  5.99642280e+07  4.21e+02 4.66e-01  4.27e+02    10s
   6  -4.36590362e+05  4.66705781e+07  2.06e+02 3.43e-01  2.61e+02    11s
   7  -3.92433524e+05  3.55795110e+07  9.27e+01 2.48e-01  1.62e+02    11s
   8  -3.31108285e+05  2.37800021e+07  2.34e+01 1.54e-01  8.89e+01    11s
   9  -2.15575478e+05  1.77469934e+07  4.70e+00 1.12e-01  6.09e+01    11s
  10  -1.55640802e+05  5.58160941e+06  1.55e+00 3.32e-02  1.92e+01    11s
  11  -1.07849522e+05  4.24436912e+06  8.57e-01 2.50e-02  1.45e+01    11s
  12  -8.66389344e+04  3.19022637e+06  4.89e-01 1.86e-02  1.09e+01    11s
  13  -6.66542066e+04  2.31564410e+06  3.01e-01 1.35e-02  7.90e+00    11s
  14  -4.14724699e+04  8.22868635e+05  1.30e-01 4.34e-03  2.86e+00    12s
  15  -1.67207112e+04  3.64720396e+05  7.91e-02 1.69e-03  1.26e+00    12s
  16   6.61382369e+03  2.55707355e+05  5.02e-02 1.72e-03  8.25e-01    12s
  17   2.42130845e+04  1.73786705e+05  3.28e-02 2.46e-03  4.95e-01    12s
  18   3.07743901e+04  1.35533577e+05  2.65e-02 2.14e-03  3.47e-01    12s
  19   3.56130272e+04  1.26320473e+05  2.21e-02 1.87e-03  3.00e-01    12s
  20   4.06800231e+04  1.14565161e+05  1.76e-02 1.51e-03  2.45e-01    12s
  21   4.48673738e+04  1.03275312e+05  1.41e-02 1.18e-03  1.93e-01    13s
  22   4.71528100e+04  9.70505762e+04  1.22e-02 9.96e-04  1.65e-01    13s
  23   5.00100506e+04  8.70665301e+04  1.01e-02 7.02e-04  1.23e-01    13s
  24   5.21376678e+04  8.24315604e+04  8.64e-03 5.61e-04  1.00e-01    13s
  25   5.62831960e+04  7.97902935e+04  5.99e-03 4.67e-04  7.78e-02    13s
  26   5.69305582e+04  7.63980526e+04  5.59e-03 3.44e-04  6.45e-02    14s
  27   5.93757221e+04  7.52817888e+04  4.12e-03 3.09e-04  5.27e-02    14s
  28   6.10914954e+04  7.30216134e+04  3.13e-03 2.23e-04  3.95e-02    14s
  29   6.24374280e+04  7.19404435e+04  2.39e-03 1.87e-04  3.15e-02    14s
  30   6.41744541e+04  7.06198802e+04  1.44e-03 1.35e-04  2.13e-02    14s
  31   6.45961835e+04  6.93817613e+04  1.21e-03 8.82e-05  1.58e-02    15s
  32   6.49574922e+04  6.86175997e+04  1.03e-03 5.82e-05  1.21e-02    15s
  33   6.56395474e+04  6.81505705e+04  6.96e-04 4.01e-05  8.32e-03    15s
  34   6.61606942e+04  6.79124871e+04  4.35e-04 3.08e-05  5.80e-03    15s
  35   6.62500279e+04  6.76089762e+04  3.92e-04 1.94e-05  4.50e-03    15s
  36   6.66337626e+04  6.75076278e+04  2.09e-04 1.55e-05  2.89e-03    16s
  37   6.67655015e+04  6.74225321e+04  1.50e-04 1.23e-05  2.18e-03    16s
  38   6.69168659e+04  6.72754100e+04  7.94e-05 6.52e-06  1.19e-03    16s
  39   6.69781150e+04  6.71740257e+04  5.28e-05 2.61e-06  6.49e-04    16s
  40   6.70234391e+04  6.71421770e+04  3.23e-05 2.59e-06  3.93e-04    16s
  41   6.70773176e+04  6.71184234e+04  8.72e-06 1.52e-06  1.36e-04    17s
  42   6.70944791e+04  6.71049978e+04  2.14e-06 3.71e-07  3.48e-05    17s
  43   6.70993805e+04  6.71008593e+04  3.71e-07 6.63e-09  4.90e-06    17s
  44   6.71005475e+04  6.71006216e+04  3.46e-08 5.14e-08  2.45e-07    17s
  45   6.71006194e+04  6.71006196e+04  2.48e-08 1.07e-09  7.20e-10    17s

Barrier solved model in 45 iterations and 17.24 seconds (14.67 work units)
Optimal objective 6.71006194e+04


Root crossover log...

  148646 DPushes remaining with DInf 0.0000000e+00                17s
   31859 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                24s

    9542 PPushes remaining with PInf 8.5398701e-05                24s
       0 PPushes remaining with PInf 0.0000000e+00                25s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.7246752e+02     25s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   76896    6.7100620e+04   0.000000e+00   1.724675e+02     25s
   76937    6.7100620e+04   0.000000e+00   0.000000e+00     26s
   76937    6.7100620e+04   0.000000e+00   0.000000e+00     26s
Concurrent spin time: 0.72s

Solved with barrier

Root relaxation: objective 6.710062e+04, 76937 iterations, 18.24 seconds (20.04 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 67100.6195    0  152 -180138.75 67100.6195   137%     -   27s
H    0     0                    -173988.5252 67100.6195   139%     -   27s
H    0     0                    -68792.12085 67100.6195   198%     -   28s
H    0     0                    13604.962689 67100.6195   393%     -   29s
H    0     0                    17175.732771 67100.6195   291%     -   29s
H    0     0                    20350.401348 67100.6195   230%     -   30s
H    0     0                    20430.610649 67100.6195   228%     -   30s
H    0     0                    20759.260023 67100.6195   223%     -   30s
H    0     0                    20779.739073 67100.6195   223%     -   30s
H    0     0                    21406.257423 67100.6195   213%     -   30s
H    0     0                    21440.546224 67100.6195   213%     -   30s
     0     0 61991.7378    0  163 21440.5462 61991.7378   189%     -  103s
H    0     0                    21539.388697 61990.0365   188%     -  104s
     0     0 61631.1321    0  196 21539.3887 61631.1321   186%     -  140s
     0     0 61628.7131    0  168 21539.3887 61628.7131   186%     -  146s
     0     0 61246.0840    0  188 21539.3887 61246.0840   184%     -  180s
     0     0 61230.9670    0  195 21539.3887 61230.9670   184%     -  185s
     0     0 61222.8028    0  199 21539.3887 61222.8028   184%     -  188s
     0     0 61213.8498    0  197 21539.3887 61213.8498   184%     -  191s
     0     0 61170.1323    0  204 21539.3887 61170.1323   184%     -  197s
     0     0 61169.4303    0  210 21539.3887 61169.4303   184%     -  199s
     0     0 61159.6679    0  204 21539.3887 61159.6679   184%     -  201s
     0     0 61148.1494    0  210 21539.3887 61148.1494   184%     -  207s
     0     0 61147.9026    0  208 21539.3887 61147.9026   184%     -  208s
     0     0 57885.3094    0  247 21539.3887 57885.3094   169%     -  316s
     0     0 57885.3094    0  247 21539.3887 57885.3094   169%     -  316s
H    0     0                    29127.682703 57884.7670  98.7%     -  318s
H    0     0                    29207.887175 57884.7670  98.2%     -  318s
H    0     0                    29412.963799 57884.7670  96.8%     -  318s
     0     0 57470.2430    0  254 29412.9638 57470.2430  95.4%     -  390s
     0     0 57393.4140    0  255 29412.9638 57393.4140  95.1%     -  414s
     0     0 57365.0516    0  259 29412.9638 57365.0516  95.0%     -  426s
     0     0 57356.3724    0  259 29412.9638 57356.3724  95.0%     -  436s
     0     0 57351.1171    0  252 29412.9638 57351.1171  95.0%     -  446s
     0     0 57335.5911    0  262 29412.9638 57335.5911  94.9%     -  458s
     0     0 57327.0874    0  267 29412.9638 57327.0874  94.9%     -  476s
     0     0 57301.1774    0  268 29412.9638 57301.1774  94.8%     -  486s
     0     0 57284.6936    0  272 29412.9638 57284.6936  94.8%     -  496s
     0     0 57277.5022    0  269 29412.9638 57277.5022  94.7%     -  502s
     0     0 57262.0752    0  264 29412.9638 57262.0752  94.7%     -  508s
     0     0 57258.6609    0  265 29412.9638 57258.6609  94.7%     -  512s
     0     0 57255.8097    0  266 29412.9638 57255.8097  94.7%     -  517s
     0     0 57255.3048    0  266 29412.9638 57255.3048  94.7%     -  521s
     0     0 54716.0471    0  310 29412.9638 54716.0471  86.0%     -  682s
H    0     0                    29551.006357 54716.0205  85.2%     -  683s
H    0     0                    29587.868353 54716.0205  84.9%     -  683s
H    0     0                    29991.460268 54716.0205  82.4%     -  683s
     0     0 54331.7749    0  332 29991.4603 54331.7749  81.2%     -  744s
     0     0 54215.5030    0  342 29991.4603 54215.5030  80.8%     -  783s
     0     0 54176.5696    0  336 29991.4603 54176.5696  80.6%     -  804s
     0     0 54143.4852    0  337 29991.4603 54143.4852  80.5%     -  817s
     0     0 54117.6819    0  326 29991.4603 54117.6819  80.4%     -  828s
     0     0 54103.0049    0  338 29991.4603 54103.0049  80.4%     -  836s
     0     0 54095.1067    0  329 29991.4603 54095.1067  80.4%     -  842s
     0     0 54090.8510    0  331 29991.4603 54090.8510  80.4%     -  847s
     0     0 54087.7722    0  331 29991.4603 54087.7722  80.3%     -  851s
     0     0 54078.6258    0  335 29991.4603 54078.6258  80.3%     -  858s
     0     0 54075.8298    0  333 29991.4603 54075.8298  80.3%     -  863s
     0     0 54008.7915    0  335 29991.4603 54008.7915  80.1%     -  877s
     0     0 53998.8098    0  337 29991.4603 53998.8098  80.0%     -  888s
     0     0 53940.1451    0  335 29991.4603 53940.1451  79.9%     -  906s
     0     0 53921.8735    0  331 29991.4603 53921.8735  79.8%     -  917s
     0     0 53907.3261    0  334 29991.4603 53907.3261  79.7%     -  924s
     0     0 53904.9787    0  333 29991.4603 53904.9787  79.7%     -  928s
     0     0 53896.3085    0  328 29991.4603 53896.3085  79.7%     -  932s
     0     0 53885.8692    0  329 29991.4603 53885.8692  79.7%     -  939s
     0     0 53884.5757    0  333 29991.4603 53884.5757  79.7%     -  943s
     0     0 52559.5585    0  361 29991.4603 52559.5585  75.2%     - 1021s
H    0     0                    30004.165000 52559.4359  75.2%     - 1024s
H    0     0                    30014.990476 52559.4359  75.1%     - 1024s
H    0     0                    30037.716898 52559.4359  75.0%     - 1024s
     0     0 52184.8581    0  346 30037.7169 52184.8581  73.7%     - 1060s
     0     0 52101.2719    0  354 30037.7169 52101.2719  73.5%     - 1083s
     0     0 51897.1039    0  357 30037.7169 51897.1039  72.8%     - 1114s
     0     0 51799.5074    0  353 30037.7169 51799.5074  72.4%     - 1138s
     0     0 51734.0489    0  368 30037.7169 51734.0489  72.2%     - 1150s
     0     0 51708.4899    0  370 30037.7169 51708.4899  72.1%     - 1156s
     0     0 51697.6893    0  369 30037.7169 51697.6893  72.1%     - 1165s
     0     0 51687.4268    0  371 30037.7169 51687.4268  72.1%     - 1169s
     0     0 51651.6389    0  366 30037.7169 51651.6389  72.0%     - 1181s
     0     0 51643.7512    0  368 30037.7169 51643.7512  71.9%     - 1186s
     0     0 51626.3601    0  370 30037.7169 51626.3601  71.9%     - 1191s
     0     0 51611.8725    0  378 30037.7169 51611.8725  71.8%     - 1196s
     0     0 51607.0927    0  368 30037.7169 51607.0927  71.8%     - 1200s
     0     0 51605.6667    0  373 30037.7169 51605.6667  71.8%     - 1201s
     0     0 51389.4769    0  380 30037.7169 51389.4769  71.1%     - 1228s
     0     0 51327.1763    0  377 30037.7169 51327.1763  70.9%     - 1246s
     0     0 51302.6464    0  388 30037.7169 51302.6464  70.8%     - 1262s
     0     0 51292.6597    0  373 30037.7169 51292.6597  70.8%     - 1269s
     0     0 51287.5375    0  382 30037.7169 51287.5375  70.7%     - 1275s
     0     0 51227.2743    0  388 30037.7169 51227.2743  70.5%     - 1293s
     0     0 51218.0354    0  390 30037.7169 51218.0354  70.5%     - 1300s
     0     0 51210.9800    0  386 30037.7169 51210.9800  70.5%     - 1305s
     0     0 51196.2718    0  382 30037.7169 51196.2718  70.4%     - 1316s
     0     0 51187.3190    0  387 30037.7169 51187.3190  70.4%     - 1322s
     0     0 51185.7618    0  387 30037.7169 51185.7618  70.4%     - 1324s
     0     0 51075.1434    0  371 30037.7169 51075.1434  70.0%     - 1345s
     0     0 51051.8156    0  364 30037.7169 51051.8156  70.0%     - 1369s
     0     0 50981.0759    0  376 30037.7169 50981.0759  69.7%     - 1393s
     0     0 50968.5939    0  385 30037.7169 50968.5939  69.7%     - 1408s
     0     0 50959.8021    0  380 30037.7169 50959.8021  69.7%     - 1416s
     0     0 50944.4641    0  386 30037.7169 50944.4641  69.6%     - 1422s
     0     0 50938.2433    0  385 30037.7169 50938.2433  69.6%     - 1426s
     0     0 50930.8515    0  386 30037.7169 50930.8515  69.6%     - 1437s
     0     0 50925.3178    0  385 30037.7169 50925.3178  69.5%     - 1441s
     0     0 50918.8810    0  395 30037.7169 50918.8810  69.5%     - 1448s
     0     0 50913.9017    0  392 30037.7169 50913.9017  69.5%     - 1453s
     0     0 50906.8275    0  394 30037.7169 50906.8275  69.5%     - 1460s
     0     0 50900.6950    0  397 30037.7169 50900.6950  69.5%     - 1465s
     0     0 50898.0068    0  397 30037.7169 50898.0068  69.4%     - 1469s
     0     0 50890.8356    0  405 30037.7169 50890.8356  69.4%     - 1476s
     0     0 50889.2454    0  398 30037.7169 50889.2454  69.4%     - 1479s
     0     0 50828.2752    0  377 30037.7169 50828.2752  69.2%     - 1495s
H    0     0                    30063.242828 50825.3046  69.1%     - 1497s
     0     0 50803.3823    0  388 30063.2428 50803.3823  69.0%     - 1506s
     0     0 50795.6904    0  397 30063.2428 50795.6904  69.0%     - 1511s
     0     0 50788.7527    0  387 30063.2428 50788.7527  68.9%     - 1517s
     0     0 50785.4374    0  391 30063.2428 50785.4374  68.9%     - 1520s
     0     0 50782.3000    0  393 30063.2428 50782.3000  68.9%     - 1523s
     0     0 50777.1899    0  388 30063.2428 50777.1899  68.9%     - 1525s
     0     0 50771.1966    0  394 30063.2428 50771.1966  68.9%     - 1527s
     0     0 50767.5860    0  392 30063.2428 50767.5860  68.9%     - 1530s
     0     0 50765.6813    0  396 30063.2428 50765.6813  68.9%     - 1533s
     0     0 50710.5796    0  416 30063.2428 50710.5796  68.7%     - 1557s
H    0     0                    30217.199268 50706.2828  67.8%     - 1560s
     0     0 50684.8954    0  378 30217.1993 50684.8954  67.7%     - 1574s
     0     0 50679.4672    0  379 30217.1993 50679.4672  67.7%     - 1578s
     0     0 50677.3723    0  380 30217.1993 50677.3723  67.7%     - 1580s
     0     0 50638.9466    0  392 30217.1993 50638.9466  67.6%     - 1594s
H    0     0                    30257.474829 50638.7486  67.4%     - 1596s
     0     0 50625.2437    0  387 30257.4748 50625.2437  67.3%     - 1602s
     0     0 50622.9178    0  385 30257.4748 50622.9178  67.3%     - 1605s
     0     0 50622.1678    0  388 30257.4748 50622.1678  67.3%     - 1607s
     0     0 50596.0772    0  387 30257.4748 50596.0772  67.2%     - 1620s
H    0     0                    30282.252834 50595.6811  67.1%     - 1626s
     0     0 50592.5977    0  383 30282.2528 50592.5977  67.1%     - 1632s
     0     0 50590.3877    0  379 30282.2528 50590.3877  67.1%     - 1635s
     0     0 50569.3104    0  377 30282.2528 50569.3104  67.0%     - 1646s
     0     0 50563.2077    0  379 30282.2528 50563.2077  67.0%     - 1652s
     0     0 50560.4826    0  378 30282.2528 50560.4826  67.0%     - 1654s
     0     0 50558.1609    0  370 30282.2528 50558.1609  67.0%     - 1656s
     0     0 50544.8739    0  379 30282.2528 50544.8739  66.9%     - 1665s
     0     0 50538.0337    0  378 30282.2528 50538.0337  66.9%     - 1681s
     0     0 50535.7923    0  382 30282.2528 50535.7923  66.9%     - 1686s
     0     0 50526.1920    0  383 30282.2528 50526.1920  66.9%     - 1692s
     0     0 50523.6005    0  391 30282.2528 50523.6005  66.8%     - 1695s
     0     0 50523.4071    0  397 30282.2528 50523.4071  66.8%     - 1697s
     0     0 50517.3524    0  391 30282.2528 50517.3524  66.8%     - 1704s
     0     0 50516.7063    0  394 30282.2528 50516.7063  66.8%     - 1718s
     0     0 50514.3607    0  381 30282.2528 50514.3607  66.8%     - 1725s
     0     0 50513.9536    0  381 30282.2528 50513.9536  66.8%     - 1731s
H    0     0                    30367.407842 50511.7314  66.3%     - 1989s
     0     2 50511.7314    0  381 30367.4078 50511.7314  66.3%     - 1995s
     1     3 50347.3947    1  361 30367.4078 50511.7314  66.3% 11771 2019s
     2     4 50431.3668    1  373 30367.4078 50431.3668  66.1%  9344 2035s
     3     6 49852.6988    2  376 30367.4078 50431.3120  66.1%  9854 2076s
     5    11 49584.5891    3  367 30367.4078 50431.3120  66.1% 13450 2108s
    10    21 49260.6206    4  381 30367.4078 50341.9857  65.8% 13469 2145s
    20    31 49194.2488    4  363 30367.4078 50341.9624  65.8% 18795 2248s
    30    57 46905.1429    5  342 30367.4078 50174.5793  65.2% 18270 3151s
H   45    57                    30504.604126 50174.5793  64.5% 19605 3151s
    56    89 45759.9343    6  308 30504.6041 50174.5793  64.5% 38755 3408s
H   88   167                    30558.793890 50174.5793  64.2% 32966 3533s
H  160   167                    30564.864310 50174.5793  64.2% 22185 3533s
   166   251 45623.7133    8  309 30564.8643 50174.5793  64.2% 21853 3600s

Cutting planes:
  Learned: 3
  Gomory: 21
  Implied bound: 195
  MIR: 3814
  Flow cover: 3627
  RLT: 41
  Relax-and-lift: 401

Explored 250 nodes (5382467 simplex iterations) in 3600.11 seconds (4585.67 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 30564.9 30558.8 30504.6 ... 30015

Time limit reached
Best objective 3.056486431020e+04, best bound 5.017457925717e+04, gap 64.1577%
  WARNING: Time limit reached. Using best solution found (gap: 64.16%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.13s
  Master Objective (UB) = 30564.86, θ = 184208.06
  Upper Bound (UB) = 30564.86

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 184208.06
  [DEBUG]   ✓ Scenario 0: θ = 184208.06 ≤ Q = 184208.06 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 184208.06 ≤ Q = 184208.68 (slack: 0.62)
  [DEBUG]   ✓ Scenario 2: θ = 184208.06 ≤ Q = 184208.06 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 184208.06 ≤ Q = 184208.06 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 184208.06 ≤ Q = 184208.06 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 184208.06 ≤ Q = 184208.06 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 184208.06 ≤ Q = 184208.06 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 184208.06 ≤ Q = 184208.06 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 184208.06 ≤ Q = 184208.06 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 184208.06 ≤ Q = 184208.06 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 184208.06 ≤ Q = 184208.06 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 184208.06 ≤ Q = 184208.06 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 184208.06 ≤ Q = 184208.06 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 184208.06 ≤ Q = 184208.06 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 184208.06 ≤ Q = 184208.06 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 184208.06 ≤ Q = 184208.06 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 184208.06 ≤ Q = 184208.06 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 184208.06 ≤ Q = 184208.06 (slack: 0.00)
  [DEBUG]   ✓ Scenario 18: θ = 184208.06 ≤ Q = 184208.06 (slack: 0.00)
  [DEBUG]   ✓ Scenario 19: θ = 184208.06 ≤ Q = 184208.06 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 20] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x1e37a919
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x1e37a919
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.420728e+13
Presolve removed 2598 rows and 1890 columns
Presolve time: 0.01s
Presolved: 495 rows, 499 columns, 1396 nonzeros
Found heuristic solution: objective 6813356.4421
Variable types: 339 continuous, 160 integer (160 binary)

Root relaxation: objective -1.564700e+05, 249 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -156470.01    0  128 6813356.44 -156470.01   102%     -    0s
H    0     0                    -117835.4551 -156470.01  32.8%     -    0s
H    0     0                    -119360.0219 -156470.01  31.1%     -    0s
     0     0 -130660.56    0   81 -119360.02 -130660.56  9.47%     -    0s
H    0     0                    -129305.8729 -130651.70  1.04%     -    0s
H    0     0                    -129580.7147 -130651.70  0.83%     -    0s
     0     0 -130636.38    0   71 -129580.71 -130636.38  0.81%     -    0s
     0     0 -130622.78    0   81 -129580.71 -130622.78  0.80%     -    0s
     0     0 -130316.92    0   33 -129580.71 -130316.92  0.57%     -    0s
H    0     0                    -129645.9846 -130264.51  0.48%     -    0s
     0     0 -130264.51    0   32 -129645.98 -130264.51  0.48%     -    0s
     0     0 -130212.03    0   37 -129645.98 -130212.03  0.44%     -    0s
     0     0 -130196.91    0   37 -129645.98 -130196.91  0.42%     -    0s
     0     2 -130196.91    0   37 -129645.98 -130196.91  0.42%     -    0s
H    6     9                    -130090.5366 -130169.55  0.06%  10.3    0s
H    9     8                    -130112.5546 -130169.55  0.04%   9.0    0s
*   26     2               6    -130150.5288 -130150.53  0.00%   4.9    0s

Cutting planes:
  Gomory: 21
  MIR: 111
  Flow cover: 3
  RLT: 26
  Relax-and-lift: 2
  BQP: 1

Explored 29 nodes (579 simplex iterations) in 0.24 seconds (0.05 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -130151 -130113 -130091 ... 1.42073e+13
No other solutions better than -130151

Optimal solution found (tolerance 1.00e-06)
Best objective -1.301505287790e+05, best bound -1.301505287790e+05, gap 0.0000%
  Subproblem solved in 0.27s
  Worst-case operational profit (Z_SP) = 177349.35
  Scenario: 4 demand increases, 56 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -130150.53
  [DEBUG]   S×d_nominal = 307499.88
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 307499.88 + -130150.53 = 177349.35
  [DEBUG]   Current θ from Master = 184208.06
  [DEBUG]   ⚠️  Z_SP ≤ θ by 6858.70 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 23706.16
  Lower Bound (LB) = 29447.80
  Gap (UB-LB) = 1117.0634, Absolute Gap = 1117.0634, Relative Gap = 0.036547
  Not converged yet (gap = 1117.06 > ε = 200)

  [DEBUG] Adding NEW scenario 20 to Master Problem...
  [DEBUG] New scenario pattern: 4 increases, 56 decreases
    [DEBUG] Scenario 20 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 20 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 20]
    [DEBUG]   - Total constraints in model: 322473
    [DEBUG]   - Total variables in model: 133300
  [DEBUG] Total scenarios in Master: 21
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 21
================================================================================
[Iteration 21] Solving Master Problem...
  Current scenarios in Master: 21
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 322473 rows, 133300 columns and 913370 nonzeros
Model fingerprint: 0x8422b7ec
Variable types: 131041 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 148470 rows and 60270 columns (presolve time = 5s)...
Presolve removed 148470 rows and 60270 columns
Presolve time: 6.86s
Presolved: 174003 rows, 73030 columns, 1070713 nonzeros
Variable types: 70771 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -335473.7764
Found heuristic solution: objective -180138.7472

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 2.16s

Barrier statistics:
 Dense cols : 1142
 AA' NZ     : 4.424e+06
 Factor NZ  : 1.236e+07 (roughly 200 MB of memory)
 Factor Ops : 4.136e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.97439022e+07  3.10970641e+08  1.46e+05 1.35e+01  9.21e+04    12s
   1  -1.53715326e+07  2.90991856e+08  1.04e+05 7.63e+01  6.49e+04    12s
   2  -6.73553125e+06  2.17929095e+08  4.44e+04 5.41e+00  2.96e+04    12s
   3  -1.12089141e+06  1.81490304e+08  2.83e+03 2.76e+00  2.39e+03    12s
   4  -7.33633908e+05  1.18040270e+08  6.03e+02 1.33e+00  7.32e+02    12s
   5  -5.82752661e+05  8.85631991e+07  3.87e+02 9.42e-01  4.97e+02    13s
   6  -4.31681070e+05  6.46130137e+07  1.10e+02 6.43e-01  2.62e+02    13s
   7  -4.13108965e+05  4.39600283e+07  6.41e+01 4.17e-01  1.69e+02    13s
   8  -3.68496384e+05  3.04905942e+07  1.12e+01 2.84e-01  1.02e+02    13s
   9  -2.98855615e+05  1.55119784e+07  3.35e+00 1.51e-01  5.07e+01    13s
  10  -1.47300916e+05  4.02117914e+06  5.13e-01 3.40e-02  1.32e+01    13s
  11  -1.04321809e+05  2.48435162e+06  3.34e-01 2.08e-02  8.18e+00    14s
  12  -7.56858105e+04  1.62613267e+06  2.04e-01 1.36e-02  5.38e+00    14s
  13  -4.75256147e+04  1.10196800e+06  1.13e-01 9.23e-03  3.63e+00    14s
  14  -1.64252144e+04  4.40019096e+05  5.19e-02 3.46e-03  1.44e+00    14s
  15   7.75827934e+03  3.32577640e+05  3.08e-02 2.54e-03  1.02e+00    14s
  16   2.24473668e+04  1.97703741e+05  2.18e-02 1.35e-03  5.53e-01    14s
  17   3.28129378e+04  1.56962693e+05  1.54e-02 9.61e-04  3.92e-01    15s
  18   3.93714931e+04  1.29948964e+05  1.15e-02 6.99e-04  2.86e-01    15s
  19   4.30253347e+04  1.21703114e+05  9.53e-03 6.11e-04  2.48e-01    15s
  20   4.71176498e+04  1.03911865e+05  7.44e-03 5.73e-04  1.79e-01    15s
  21   5.19372282e+04  9.47667911e+04  5.25e-03 4.41e-04  1.35e-01    16s
  22   5.48002329e+04  9.16442064e+04  4.06e-03 3.91e-04  1.16e-01    16s
  23   5.57990990e+04  8.67757754e+04  3.67e-03 3.23e-04  9.77e-02    16s
  24   5.86464014e+04  8.39448362e+04  2.61e-03 2.78e-04  7.98e-02    17s
  25   6.00352374e+04  7.73576240e+04  2.13e-03 1.80e-04  5.47e-02    17s
  26   6.15371185e+04  7.44093173e+04  1.66e-03 1.27e-04  4.06e-02    17s
  27   6.25117144e+04  7.31055306e+04  1.37e-03 1.04e-04  3.34e-02    17s
  28   6.39030474e+04  7.14083620e+04  9.51e-04 7.27e-05  2.37e-02    18s
  29   6.47598771e+04  7.03873536e+04  7.03e-04 5.87e-05  1.78e-02    18s
  30   6.51455415e+04  6.94310023e+04  5.92e-04 4.25e-05  1.35e-02    18s
  31   6.56890763e+04  6.87333439e+04  4.40e-04 2.78e-05  9.61e-03    18s
  32   6.58879757e+04  6.84430690e+04  3.89e-04 2.15e-05  8.06e-03    19s
  33   6.62374192e+04  6.81974057e+04  2.94e-04 1.64e-05  6.18e-03    19s
  34   6.63291059e+04  6.79382201e+04  2.71e-04 1.11e-05  5.08e-03    19s
  35   6.67076084e+04  6.78800534e+04  1.74e-04 9.92e-06  3.70e-03    20s
  36   6.69271439e+04  6.76688803e+04  1.16e-04 5.55e-06  2.34e-03    20s
  37   6.70759688e+04  6.75934437e+04  7.74e-05 4.67e-06  1.63e-03    20s
  38   6.71315130e+04  6.75357346e+04  6.34e-05 3.99e-06  1.28e-03    20s
  39   6.72776210e+04  6.74873958e+04  2.72e-05 2.98e-06  6.62e-04    21s
  40   6.73236839e+04  6.74533499e+04  1.61e-05 2.62e-06  4.09e-04    21s
  41   6.73699531e+04  6.74215996e+04  5.59e-06 1.20e-06  1.63e-04    21s
  42   6.73769384e+04  6.74155750e+04  4.13e-06 9.43e-07  1.22e-04    22s
  43   6.73837546e+04  6.74075840e+04  2.71e-06 4.13e-07  7.52e-05    22s
  44   6.73921238e+04  6.74009202e+04  1.12e-06 1.05e-07  2.78e-05    22s
  45   6.73945704e+04  6.73996365e+04  6.50e-07 6.77e-08  1.60e-05    22s
  46   6.73946152e+04  6.73994256e+04  6.41e-07 6.23e-08  1.52e-05    23s
  47   6.73965378e+04  6.73987078e+04  2.64e-07 7.63e-08  6.85e-06    23s
  48   6.73976838e+04  6.73981848e+04  6.93e-08 2.67e-08  1.58e-06    24s
  49   6.73978339e+04  6.73981091e+04  4.39e-08 3.92e-09  8.69e-07    24s
  50   6.73979968e+04  6.73981014e+04  2.44e-08 1.28e-09  3.30e-07    25s
  51   6.73980273e+04  6.73981001e+04  1.69e-08 8.89e-10  2.30e-07    25s
  52   6.73980596e+04  6.73980987e+04  1.07e-08 2.33e-10  1.24e-07    25s
  53   6.73980965e+04  6.73980976e+04  7.82e-09 2.97e-09  3.48e-09    26s
  54   6.73980974e+04  6.73980974e+04  4.44e-09 9.10e-09  5.28e-12    26s

Barrier solved model in 54 iterations and 25.96 seconds (19.62 work units)
Optimal objective 6.73980974e+04


Root crossover log...

  157949 DPushes remaining with DInf 0.0000000e+00                26s
    6489 DPushes remaining with DInf 0.0000000e+00                30s
       0 DPushes remaining with DInf 0.0000000e+00                32s

    2043 PPushes remaining with PInf 1.4624248e-06                32s
       0 PPushes remaining with PInf 0.0000000e+00                32s

  Push phase complete: Pinf 0.0000000e+00, Dinf 4.7229612e-03     32s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   69090    6.7398097e+04   0.000000e+00   4.722961e-03     32s
   69147    6.7398097e+04   0.000000e+00   0.000000e+00     32s
   69147    6.7398097e+04   0.000000e+00   0.000000e+00     32s
Concurrent spin time: 0.01s

Solved with barrier

Root relaxation: objective 6.739810e+04, 69147 iterations, 23.72 seconds (20.91 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 67398.0974    0  137 -180138.75 67398.0974   137%     -   32s
H    0     0                    -173988.5252 67398.0974   139%     -   33s
H    0     0                    -84505.58339 67398.0974   180%     -   33s
H    0     0                    -77106.79778 67398.0974   187%     -   33s
H    0     0                    -63239.87203 67398.0974   207%     -   34s
H    0     0                    5373.2290483 67398.0974  1154%     -   35s
H    0     0                    19978.932169 67398.0974   237%     -   35s
H    0     0                    24901.351289 67398.0974   171%     -   35s
H    0     0                    25859.648267 67398.0974   161%     -   36s
H    0     0                    26278.717987 67398.0974   156%     -   37s
H    0     0                    26472.537293 67398.0974   155%     -   37s
H    0     0                    26513.838524 67398.0974   154%     -   37s
H    0     0                    26516.895133 67398.0974   154%     -   37s
H    0     0                    26529.797325 67398.0974   154%     -   37s
H    0     0                    26627.834106 67398.0974   153%     -   37s
     0     0 61648.2400    0  165 26627.8341 61648.2400   132%     -  146s
H    0     0                    26631.857505 61647.8739   131%     -  148s
     0     0 61371.1695    0  175 26631.8575 61371.1695   130%     -  183s
     0     0 61367.5895    0  180 26631.8575 61367.5895   130%     -  188s
     0     0 61291.2769    0  185 26631.8575 61291.2769   130%     -  207s
     0     0 61262.6135    0  189 26631.8575 61262.6135   130%     -  217s
     0     0 61262.6135    0  189 26631.8575 61262.6135   130%     -  218s
     0     0 57734.0716    0  224 26631.8575 57734.0716   117%     -  335s
     0     0 57734.0716    0  224 26631.8575 57734.0716   117%     -  335s
H    0     0                    27108.756465 57734.0354   113%     -  336s
H    0     0                    27942.232359 57734.0354   107%     -  336s
H    0     0                    28492.073257 57734.0354   103%     -  336s
     0     0 57314.7833    0  258 28492.0733 57314.7833   101%     -  409s
     0     0 57247.4520    0  259 28492.0733 57247.4520   101%     -  441s
     0     0 57194.6480    0  275 28492.0733 57194.6480   101%     -  478s
     0     0 57148.1839    0  268 28492.0733 57148.1839   101%     -  503s
     0     0 57146.3192    0  273 28492.0733 57146.3192   101%     -  513s
     0     0 57117.5498    0  267 28492.0733 57117.5498   100%     -  535s
     0     0 56789.5066    0  254 28492.0733 56789.5066  99.3%     -  587s
     0     0 56773.6023    0  262 28492.0733 56773.6023  99.3%     -  603s
     0     0 56725.6285    0  274 28492.0733 56725.6285  99.1%     -  621s
     0     0 56719.0259    0  288 28492.0733 56719.0259  99.1%     -  627s
     0     0 56716.7293    0  278 28492.0733 56716.7293  99.1%     -  630s
     0     0 56713.7659    0  278 28492.0733 56713.7659  99.1%     -  633s
     0     0 56713.7092    0  278 28492.0733 56713.7092  99.1%     -  634s
     0     0 54769.3660    0  304 28492.0733 54769.3660  92.2%     -  766s
     0     0 54218.2794    0  323 28492.0733 54218.2794  90.3%     -  833s
     0     0 54033.4191    0  331 28492.0733 54033.4191  89.6%     -  884s
     0     0 53881.3386    0  346 28492.0733 53881.3386  89.1%     -  929s
     0     0 53781.0010    0  345 28492.0733 53781.0010  88.8%     -  953s
     0     0 53750.5269    0  344 28492.0733 53750.5269  88.7%     -  969s
     0     0 53683.7110    0  337 28492.0733 53683.7110  88.4%     -  992s
     0     0 53645.5592    0  349 28492.0733 53645.5592  88.3%     - 1004s
     0     0 53614.5655    0  353 28492.0733 53614.5655  88.2%     - 1017s
     0     0 53599.4465    0  364 28492.0733 53599.4465  88.1%     - 1027s
     0     0 53581.6341    0  372 28492.0733 53581.6341  88.1%     - 1035s
     0     0 53576.3077    0  369 28492.0733 53576.3077  88.0%     - 1040s
     0     0 53571.9039    0  372 28492.0733 53571.9039  88.0%     - 1042s
     0     0 53434.8991    0  363 28492.0733 53434.8991  87.5%     - 1063s
     0     0 53412.0023    0  378 28492.0733 53412.0023  87.5%     - 1070s
     0     0 53407.5071    0  376 28492.0733 53407.5071  87.4%     - 1076s
     0     0 53396.2948    0  375 28492.0733 53396.2948  87.4%     - 1082s
     0     0 53391.3686    0  379 28492.0733 53391.3686  87.4%     - 1086s
     0     0 53389.9125    0  377 28492.0733 53389.9125  87.4%     - 1088s
     0     0 52042.8033    0  436 28492.0733 52042.8033  82.7%     - 1230s
H    0     0                    28510.965935 52042.7245  82.5%     - 1232s
H    0     0                    28557.379499 52042.7245  82.2%     - 1232s
     0     0 51667.6042    0  445 28557.3795 51667.6042  80.9%     - 1304s
     0     0 51601.4862    0  415 28557.3795 51601.4862  80.7%     - 1328s
     0     0 51537.1735    0  435 28557.3795 51537.1735  80.5%     - 1356s
     0     0 51514.7153    0  469 28557.3795 51514.7153  80.4%     - 1372s
     0     0 51454.4026    0  428 28557.3795 51454.4026  80.2%     - 1394s
     0     0 51429.3002    0  434 28557.3795 51429.3002  80.1%     - 1406s
     0     0 51413.4976    0  433 28557.3795 51413.4976  80.0%     - 1417s
     0     0 51383.8739    0  419 28557.3795 51383.8739  79.9%     - 1439s
     0     0 51359.5809    0  428 28557.3795 51359.5809  79.8%     - 1454s
     0     0 51357.6087    0  461 28557.3795 51357.6087  79.8%     - 1458s
     0     0 51102.5912    0  369 28557.3795 51102.5912  78.9%     - 1525s
H    0     0                    28606.944576 51102.0641  78.6%     - 1527s
     0     0 51026.7475    0  416 28606.9446 51026.7475  78.4%     - 1559s
     0     0 50981.0320    0  364 28606.9446 50981.0320  78.2%     - 1587s
     0     0 50951.1013    0  378 28606.9446 50951.1013  78.1%     - 1605s
     0     0 50932.0273    0  413 28606.9446 50932.0273  78.0%     - 1626s
     0     0 50916.1268    0  417 28606.9446 50916.1268  78.0%     - 1644s
     0     0 50910.0290    0  417 28606.9446 50910.0290  78.0%     - 1653s
     0     0 50907.9046    0  422 28606.9446 50907.9046  78.0%     - 1658s
     0     0 50764.8933    0  466 28606.9446 50764.8933  77.5%     - 1705s
     0     0 50738.4524    0  439 28606.9446 50738.4524  77.4%     - 1719s
     0     0 50723.1798    0  403 28606.9446 50723.1798  77.3%     - 1728s
     0     0 50715.4586    0  401 28606.9446 50715.4586  77.3%     - 1734s
     0     0 50712.8740    0  403 28606.9446 50712.8740  77.3%     - 1738s
     0     0 50712.0936    0  396 28606.9446 50712.0936  77.3%     - 1741s
     0     0 50624.7116    0  378 28606.9446 50624.7116  77.0%     - 1775s
     0     0 50605.9478    0  376 28606.9446 50605.9478  76.9%     - 1796s
     0     0 50597.8171    0  419 28606.9446 50597.8171  76.9%     - 1805s
     0     0 50590.4280    0  415 28606.9446 50590.4280  76.8%     - 1812s
     0     0 50588.4449    0  381 28606.9446 50588.4449  76.8%     - 1816s
     0     0 50568.6305    0  380 28606.9446 50568.6305  76.8%     - 1830s
     0     0 50563.7769    0  375 28606.9446 50563.7769  76.8%     - 1840s
     0     0 50552.2767    0  375 28606.9446 50552.2767  76.7%     - 1849s
     0     0 50549.8802    0  377 28606.9446 50549.8802  76.7%     - 1853s
     0     0 50548.0931    0  375 28606.9446 50548.0931  76.7%     - 1857s
     0     0 50534.2866    0  382 28606.9446 50534.2866  76.7%     - 1868s
     0     0 50528.0864    0  418 28606.9446 50528.0864  76.6%     - 1875s
     0     0 50527.0855    0  383 28606.9446 50527.0855  76.6%     - 1878s
     0     0 50518.2701    0  380 28606.9446 50518.2701  76.6%     - 1886s
     0     0 50516.5960    0  385 28606.9446 50516.5960  76.6%     - 1889s
     0     0 50509.8431    0  384 28606.9446 50509.8431  76.6%     - 1896s
     0     0 50502.8364    0  389 28606.9446 50502.8364  76.5%     - 1904s
     0     0 50501.3547    0  382 28606.9446 50501.3547  76.5%     - 1906s
     0     0 50495.9367    0  387 28606.9446 50495.9367  76.5%     - 1915s
     0     0 50495.6050    0  387 28606.9446 50495.6050  76.5%     - 1922s
H    0     0                    29134.623683 50495.6050  73.3%     - 2267s
H    0     0                    29219.257669 50495.6050  72.8%     - 2269s
H    0     0                    29323.523671 50495.6050  72.2%     - 2269s
H    0     0                    29638.974177 50495.6050  70.4%     - 2270s
H    0     2                    29910.416145 50495.6050  68.8%     - 2278s
     0     2 50495.6050    0  387 29910.4161 50495.6050  68.8%     - 2278s
     1     3 50187.0418    1  357 29910.4161 50495.2537  68.8% 12894 2313s
     2     4 50424.7169    1  405 29910.4161 50424.7169  68.6% 13118 2344s
     3     7 49701.3369    2  361 29910.4161 50423.3049  68.6% 14749 2383s
     6    14 49537.7313    3  371 29910.4161 50423.3049  68.6% 12364 2461s
    13    26 49332.4448    4  381 29910.4161 49832.0779  66.6% 15729 2517s
    25    38 47654.0485    5  362 29910.4161 49591.1466  65.8% 28567 2652s
    37    67 45697.4482    6  330 29910.4161 49591.1466  65.8% 25266 3013s
H   49    67                    29934.083321 49591.1466  65.7% 24849 3013s
    66   134 45294.3970    7  326 29934.0833 49591.1466  65.7% 29531 3203s
   133   166 45235.2044    8  327 29934.0833 49591.1466  65.7% 22631 3276s
   165   198 45129.1312    9  282 29934.0833 49591.1466  65.7% 20983 3352s
H  168   198                    29957.639579 49591.1466  65.5% 20629 3352s
H  179   198                    30070.902393 49591.1466  64.9% 19833 3352s
   197   240 45102.2718   10  279 30070.9024 49591.1466  64.9% 18574 3428s
H  208   240                    30111.059727 49591.1466  64.7% 17905 3428s
H  224   240                    30285.645226 49591.1466  63.7% 17113 3428s
   239   337 45070.7102   11  322 30285.6452 49591.1466  63.7% 16494 3542s
   336   396 44906.5867   14  277 30285.6452 49591.1466  63.7% 13998 3600s

Cutting planes:
  Learned: 1
  Gomory: 22
  Implied bound: 167
  MIR: 3783
  Flow cover: 3708
  RLT: 55
  Relax-and-lift: 539

Explored 395 nodes (6003905 simplex iterations) in 3600.05 seconds (4556.98 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 30285.6 30111.1 30070.9 ... 29134.6

Time limit reached
Best objective 3.028564522598e+04, best bound 4.959114661956e+04, gap 63.7447%
  WARNING: Time limit reached. Using best solution found (gap: 63.74%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = 30285.65, θ = 183986.59
  Upper Bound (UB) = 30285.65

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 183986.59
  [DEBUG]   ✓ Scenario 0: θ = 183986.59 ≤ Q = 183986.59 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 183986.59 ≤ Q = 183986.59 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 183986.59 ≤ Q = 183986.59 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 183986.59 ≤ Q = 183986.59 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 183986.59 ≤ Q = 183986.59 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 183986.59 ≤ Q = 183986.59 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 183986.59 ≤ Q = 183986.59 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 183986.59 ≤ Q = 183986.59 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 183986.59 ≤ Q = 183986.59 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 183986.59 ≤ Q = 183986.59 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 183986.59 ≤ Q = 183986.59 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 183986.59 ≤ Q = 183986.59 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 183986.59 ≤ Q = 183986.59 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 183986.59 ≤ Q = 183986.59 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 183986.59 ≤ Q = 183986.59 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 183986.59 ≤ Q = 183986.59 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 183986.59 ≤ Q = 183986.59 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 183986.59 ≤ Q = 183986.59 (slack: 0.00)
  [DEBUG]   ✓ Scenario 18: θ = 183986.59 ≤ Q = 183986.59 (slack: 0.00)
  [DEBUG]   ✓ Scenario 19: θ = 183986.59 ≤ Q = 183986.59 (slack: 0.00)
  [DEBUG]   ✓ Scenario 20: θ = 183986.59 ≤ Q = 183986.59 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 21] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x7c396189
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x83c69e77
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.421556e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.01s
Presolved: 494 rows, 498 columns, 1396 nonzeros
Found heuristic solution: objective 6867933.3819
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.556258e+05, 245 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -155625.82    0  124 6867933.38 -155625.82   102%     -    0s
H    0     0                    -120926.7996 -155625.82  28.7%     -    0s
H    0     0                    -121960.1118 -155625.82  27.6%     -    0s
     0     0 -133724.55    0   56 -121960.11 -133724.55  9.65%     -    0s
H    0     0                    -130556.4827 -133693.72  2.40%     -    0s
     0     0 -132622.29    0   52 -130556.48 -132622.29  1.58%     -    0s
H    0     0                    -130832.1919 -132603.72  1.35%     -    0s
H    0     0                    -131046.0382 -132603.72  1.19%     -    0s
H    0     0                    -131335.2858 -132603.72  0.97%     -    0s
     0     0 -132112.87    0   42 -131335.29 -132112.87  0.59%     -    0s
     0     0 -132039.96    0   44 -131335.29 -132039.96  0.54%     -    0s
     0     0 -132039.33    0   40 -131335.29 -132039.33  0.54%     -    0s
     0     0 -131857.20    0   40 -131335.29 -131857.20  0.40%     -    0s
H    0     0                    -131369.7245 -131839.39  0.36%     -    0s
     0     0 -131836.72    0   39 -131369.72 -131836.72  0.36%     -    0s
     0     0 -131836.43    0   40 -131369.72 -131836.43  0.36%     -    0s
     0     0 -131764.01    0   37 -131369.72 -131764.01  0.30%     -    0s
     0     0 -131749.75    0   37 -131369.72 -131749.75  0.29%     -    0s
     0     0 -131742.72    0   61 -131369.72 -131742.72  0.28%     -    0s
     0     0 -131742.72    0   61 -131369.72 -131742.72  0.28%     -    0s
     0     0 -131742.72    0   38 -131369.72 -131742.72  0.28%     -    0s
     0     0 -131649.48    0   36 -131369.72 -131649.48  0.21%     -    0s
     0     0 -131601.68    0   33 -131369.72 -131601.68  0.18%     -    0s
     0     0 -131535.30    0    7 -131369.72 -131535.30  0.13%     -    0s
H    0     0                    -131420.2780 -131529.71  0.08%     -    0s
     0     0 -131529.71    0    7 -131420.28 -131529.71  0.08%     -    0s
     0     0 -131520.59    0   27 -131420.28 -131520.59  0.08%     -    0s
     0     0 -131520.59    0   29 -131420.28 -131520.59  0.08%     -    0s
     0     0 -131520.59    0   25 -131420.28 -131520.59  0.08%     -    0s
H    0     0                    -131462.9273 -131520.59  0.04%     -    0s
     0     0 -131520.59    0   12 -131462.93 -131520.59  0.04%     -    0s
     0     0 -131520.59    0   20 -131462.93 -131520.59  0.04%     -    0s
     0     0 -131520.59    0    9 -131462.93 -131520.59  0.04%     -    0s
     0     0 -131520.59    0   16 -131462.93 -131520.59  0.04%     -    0s
     0     0 -131516.57    0    9 -131462.93 -131516.57  0.04%     -    0s
     0     0 -131516.44    0   25 -131462.93 -131516.44  0.04%     -    0s
     0     0 -131504.56    0   19 -131462.93 -131504.56  0.03%     -    0s
     0     0 -131502.03    0   21 -131462.93 -131502.03  0.03%     -    0s
     0     0 -131501.94    0   21 -131462.93 -131501.94  0.03%     -    0s
     0     0 -131493.15    0   17 -131462.93 -131493.15  0.02%     -    0s
     0     0 -131489.33    0   21 -131462.93 -131489.33  0.02%     -    0s
     0     0 -131488.95    0   21 -131462.93 -131488.95  0.02%     -    0s
     0     0 -131488.95    0   25 -131462.93 -131488.95  0.02%     -    0s
     0     0 -131488.95    0   19 -131462.93 -131488.95  0.02%     -    0s
H    0     0                    -131481.5244 -131488.95  0.01%     -    0s
     0     0 -131488.95    0   20 -131481.52 -131488.95  0.01%     -    0s
     0     0 -131488.95    0   20 -131481.52 -131488.95  0.01%     -    0s
     0     0 -131486.79    0   20 -131481.52 -131486.79  0.00%     -    0s
     0     0     cutoff    0      -131481.52 -131481.52  0.00%     -    0s

Cutting planes:
  Gomory: 19
  MIR: 18
  Flow cover: 2
  RLT: 1

Explored 1 nodes (1321 simplex iterations) in 0.62 seconds (0.09 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -131482 -131463 -131421 ... -121960
No other solutions better than -131482

Optimal solution found (tolerance 1.00e-06)
Best objective -1.314815243575e+05, best bound -1.314815243575e+05, gap 0.0000%
  Subproblem solved in 0.65s
  Worst-case operational profit (Z_SP) = 176653.85
  Scenario: 23 demand increases, 37 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -131481.52
  [DEBUG]   S×d_nominal = 308135.37
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 308135.37 + -131481.52 = 176653.85
  [DEBUG]   Current θ from Master = 183986.59
  [DEBUG]   ⚠️  Z_SP ≤ θ by 7332.74 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 22952.90
  Lower Bound (LB) = 29447.80
  Gap (UB-LB) = 837.8443, Absolute Gap = 837.8443, Relative Gap = 0.027665
  Not converged yet (gap = 837.84 > ε = 200)

  [DEBUG] Adding NEW scenario 21 to Master Problem...
  [DEBUG] New scenario pattern: 23 increases, 37 decreases
    [DEBUG] Scenario 21 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 21 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 21]
    [DEBUG]   - Total constraints in model: 337763
    [DEBUG]   - Total variables in model: 139540
  [DEBUG] Total scenarios in Master: 22
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 22
================================================================================
[Iteration 22] Solving Master Problem...
  Current scenarios in Master: 22
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 337763 rows, 139540 columns and 956601 nonzeros
Model fingerprint: 0xa4717f11
Variable types: 137281 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 155540 rows and 63140 columns (presolve time = 5s)...
Presolve removed 155540 rows and 63140 columns
Presolve time: 7.32s
Presolved: 182223 rows, 76400 columns, 1121978 nonzeros
Variable types: 74141 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -335473.7764
Found heuristic solution: objective -180138.7472

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 2.53s

Barrier statistics:
 Dense cols : 1149
 AA' NZ     : 4.734e+06
 Factor NZ  : 1.317e+07 (roughly 200 MB of memory)
 Factor Ops : 4.570e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.01220693e+07  3.23712780e+08  1.49e+05 1.32e+01  9.35e+04    12s
   1  -1.56918658e+07  3.03455164e+08  1.06e+05 7.68e+01  6.59e+04    13s
   2  -6.82937246e+06  2.27750480e+08  4.48e+04 5.41e+00  2.97e+04    13s
   3  -1.52023678e+06  1.96241578e+08  5.50e+03 1.85e+00  4.12e+03    13s
   4  -7.41117793e+05  1.17122399e+08  9.42e+02 4.83e-01  9.13e+02    13s
   5  -5.58417000e+05  6.92259054e+07  4.71e+02 2.61e-01  4.65e+02    13s
   6  -4.45091287e+05  5.54155893e+07  1.78e+02 2.01e-01  2.60e+02    13s
   7  -4.06117337e+05  4.15836770e+07  8.36e+01 1.44e-01  1.66e+02    14s
   8  -3.74893591e+05  2.80550938e+07  4.06e+01 9.16e-02  1.02e+02    14s
   9  -2.80196332e+05  2.07921806e+07  1.05e+01 6.59e-02  6.70e+01    14s
  10  -1.62538833e+05  1.12469919e+07  2.60e+00 3.43e-02  3.49e+01    14s
  11  -1.27086629e+05  7.27015370e+06  1.67e+00 2.21e-02  2.25e+01    14s
  12  -1.05914831e+05  5.28001779e+06  1.17e+00 1.61e-02  1.63e+01    14s
  13  -8.90051250e+04  2.85525650e+06  7.50e-01 8.72e-03  8.91e+00    15s
  14  -5.68844659e+04  1.98370310e+06  2.56e-01 6.12e-03  6.16e+00    15s
  15  -3.59956388e+04  6.57875812e+05  1.25e-01 1.74e-03  2.09e+00    15s
  16  -6.01609798e+03  3.08938169e+05  6.54e-02 1.37e-03  9.50e-01    15s
  17   1.47411429e+04  2.14180089e+05  4.12e-02 2.53e-03  6.01e-01    15s
  18   2.56572034e+04  1.60510496e+05  3.10e-02 3.16e-03  4.07e-01    15s
  19   3.09009832e+04  1.37280041e+05  2.62e-02 2.44e-03  3.21e-01    16s
  20   3.52964116e+04  1.26394417e+05  2.22e-02 2.09e-03  2.75e-01    16s
  21   3.92583064e+04  1.11848898e+05  1.88e-02 1.60e-03  2.19e-01    16s
  22   4.44355509e+04  9.95121575e+04  1.45e-02 1.21e-03  1.66e-01    16s
  23   4.80564975e+04  9.55136050e+04  1.17e-02 1.08e-03  1.43e-01    17s
  24   5.02671168e+04  9.03018779e+04  1.01e-02 9.14e-04  1.21e-01    17s
  25   5.25735189e+04  8.67213034e+04  8.45e-03 7.91e-04  1.03e-01    17s
  26   5.45172272e+04  8.36073615e+04  7.11e-03 6.79e-04  8.77e-02    17s
  27   5.59095501e+04  8.25698611e+04  6.21e-03 6.43e-04  8.04e-02    17s
  28   5.67833441e+04  7.86283965e+04  5.66e-03 4.93e-04  6.59e-02    18s
  29   5.87574499e+04  7.65303140e+04  4.49e-03 4.03e-04  5.36e-02    18s
  30   5.98924522e+04  7.35572765e+04  3.82e-03 2.83e-04  4.12e-02    18s
  31   6.16440411e+04  7.21273208e+04  2.84e-03 2.18e-04  3.16e-02    18s
  32   6.30356436e+04  7.08435180e+04  2.12e-03 1.60e-04  2.35e-02    19s
  33   6.38451590e+04  6.99266709e+04  1.69e-03 1.28e-04  1.83e-02    19s
  34   6.48842899e+04  6.94438114e+04  1.15e-03 1.00e-04  1.37e-02    19s
  35   6.55929467e+04  6.86165593e+04  7.94e-04 7.05e-05  9.12e-03    19s
  36   6.63716264e+04  6.82021228e+04  4.18e-04 5.21e-05  5.52e-03    20s
  37   6.66084982e+04  6.77607135e+04  3.06e-04 2.63e-05  3.47e-03    20s
  38   6.67599480e+04  6.76680187e+04  2.36e-04 2.08e-05  2.74e-03    20s
  39   6.70410236e+04  6.74954028e+04  1.09e-04 1.08e-05  1.37e-03    20s
  40   6.71655978e+04  6.73755659e+04  5.44e-05 3.88e-06  6.33e-04    21s
  41   6.72056068e+04  6.73575892e+04  3.85e-05 3.03e-06  4.58e-04    21s
  42   6.72199325e+04  6.73468147e+04  3.25e-05 2.38e-06  3.83e-04    21s
  43   6.72431864e+04  6.73321254e+04  2.29e-05 1.63e-06  2.68e-04    21s
  44   6.72683102e+04  6.73224711e+04  1.27e-05 1.10e-06  1.63e-04    21s
  45   6.72751067e+04  6.73148780e+04  1.01e-05 6.94e-07  1.20e-04    22s
  46   6.72838486e+04  6.73103311e+04  6.67e-06 4.72e-07  7.98e-05    22s
  47   6.72947593e+04  6.73052993e+04  2.50e-06 1.70e-07  3.18e-05    22s
  48   6.72977477e+04  6.73035061e+04  1.41e-06 6.94e-08  1.74e-05    22s
  49   6.73000225e+04  6.73030733e+04  6.45e-07 4.88e-08  9.20e-06    22s
  50   6.73012268e+04  6.73027404e+04  2.51e-07 3.15e-08  4.56e-06    23s
  51   6.73019879e+04  6.73020818e+04  1.67e-08 5.65e-08  2.83e-07    23s
  52   6.73020510e+04  6.73020681e+04  5.55e-09 6.88e-09  5.15e-08    23s
  53   6.73020641e+04  6.73020670e+04  9.59e-08 4.14e-09  8.57e-09    24s
  54   6.73020649e+04  6.73020650e+04  1.14e-08 4.57e-09  4.91e-10    24s

Barrier solved model in 54 iterations and 23.76 seconds (19.19 work units)
Optimal objective 6.73020649e+04


Root crossover log...

  163453 DPushes remaining with DInf 0.0000000e+00                24s
   42973 DPushes remaining with DInf 0.0000000e+00                25s
       0 DPushes remaining with DInf 0.0000000e+00                28s

    5362 PPushes remaining with PInf 4.2365234e-05                28s
       0 PPushes remaining with PInf 0.0000000e+00                29s

  Push phase complete: Pinf 0.0000000e+00, Dinf 5.1051293e+00     29s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   78097    6.7302065e+04   0.000000e+00   5.105129e+00     29s
   78138    6.7302065e+04   0.000000e+00   0.000000e+00     30s
   78138    6.7302065e+04   0.000000e+00   0.000000e+00     30s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 6.730206e+04, 78138 iterations, 21.00 seconds (20.30 work units)
Total elapsed time = 30.24s (DegenMoves)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 67302.0649    0  153 -180138.75 67302.0649   137%     -   30s
H    0     0                    -173381.4759 67302.0649   139%     -   32s
H    0     0                    -164055.2693 67302.0649   141%     -   32s
H    0     0                    -163629.6319 67302.0649   141%     -   32s
H    0     0                    -163623.8408 67302.0649   141%     -   32s
H    0     0                    -61879.27678 67302.0649   209%     -   33s
H    0     0                    -202.8361901 67302.0649      -     -   33s
H    0     0                    17805.263901 67302.0649   278%     -   33s
H    0     0                    18687.823656 67302.0649   260%     -   34s
H    0     0                    20729.073033 67302.0649   225%     -   35s
H    0     0                    20787.019465 67302.0649   224%     -   35s
H    0     0                    20950.697574 67302.0649   221%     -   35s
H    0     0                    21041.251822 67302.0649   220%     -   35s
H    0     0                    21076.652127 67302.0649   219%     -   35s
H    0     0                    21077.767637 67302.0649   219%     -   35s
H    0     0                    21104.852418 67302.0649   219%     -   35s
H    0     0                    21106.390454 67302.0649   219%     -   35s
     0     0 61871.3436    0  208 21106.3905 61871.3436   193%     -  145s
H    0     0                    21106.807982 61871.2889   193%     -  147s
H    0     0                    21276.011043 61871.2889   191%     -  148s
     0     0 61596.7652    0  213 21276.0110 61596.7652   190%     -  207s
     0     0 61560.9479    0  214 21276.0110 61560.9479   189%     -  217s
     0     0 61498.3985    0  217 21276.0110 61498.3985   189%     -  236s
     0     0 61481.7689    0  220 21276.0110 61481.7689   189%     -  244s
     0     0 61091.2548    0  219 21276.0110 61091.2548   187%     -  290s
     0     0 61006.8718    0  219 21276.0110 61006.8718   187%     -  304s
     0     0 60991.2874    0  225 21276.0110 60991.2874   187%     -  311s
     0     0 60988.5995    0  223 21276.0110 60988.5995   187%     -  314s
     0     0 60817.8207    0  221 21276.0110 60817.8207   186%     -  338s
     0     0 60811.9319    0  220 21276.0110 60811.9319   186%     -  343s
     0     0 60796.7719    0  224 21276.0110 60796.7719   186%     -  346s
     0     0 60796.7719    0  224 21276.0110 60796.7719   186%     -  347s
     0     0 58106.5776    0  244 21276.0110 58106.5776   173%     -  467s
     0     0 58106.5776    0  244 21276.0110 58106.5776   173%     -  467s
H    0     0                    29130.605140 58106.4607  99.5%     -  469s
H    0     0                    29204.933422 58106.4607  99.0%     -  469s
H    0     0                    29239.159417 58106.4607  98.7%     -  469s
H    0     0                    29271.710258 58106.4607  98.5%     -  469s
     0     0 57505.9574    0  261 29271.7103 57505.9574  96.5%     -  556s
     0     0 57346.2670    0  260 29271.7103 57346.2670  95.9%     -  596s
     0     0 57113.1850    0  276 29271.7103 57113.1850  95.1%     -  637s
     0     0 56935.1597    0  283 29271.7103 56935.1597  94.5%     -  672s
     0     0 56906.3844    0  295 29271.7103 56906.3844  94.4%     -  693s
     0     0 56872.0115    0  298 29271.7103 56872.0115  94.3%     -  715s
     0     0 56839.1501    0  294 29271.7103 56839.1501  94.2%     -  731s
     0     0 56809.2618    0  311 29271.7103 56809.2618  94.1%     -  746s
     0     0 56722.8479    0  331 29271.7103 56722.8479  93.8%     -  787s
     0     0 56698.2543    0  331 29271.7103 56698.2543  93.7%     -  807s
     0     0 56693.9778    0  334 29271.7103 56693.9778  93.7%     -  812s
     0     0 56627.7103    0  291 29271.7103 56627.7103  93.5%     -  837s
     0     0 56607.5210    0  329 29271.7103 56607.5210  93.4%     -  851s
     0     0 56601.2018    0  303 29271.7103 56601.2018  93.4%     -  857s
     0     0 56598.5395    0  305 29271.7103 56598.5395  93.4%     -  861s
     0     0 56597.3779    0  335 29271.7103 56597.3779  93.4%     -  866s
     0     0 54581.0192    0  331 29271.7103 54581.0192  86.5%     - 1033s
     0     0 54092.4790    0  329 29271.7103 54092.4790  84.8%     - 1101s
     0     0 54092.2523    0  330 29271.7103 54092.2523  84.8%     - 1102s
     0     0 53833.8752    0  335 29271.7103 53833.8752  83.9%     - 1163s
     0     0 53736.7557    0  342 29271.7103 53736.7557  83.6%     - 1213s
     0     0 53507.2061    0  340 29271.7103 53507.2061  82.8%     - 1261s
     0     0 53447.0188    0  380 29271.7103 53447.0188  82.6%     - 1291s
     0     0 53423.2191    0  339 29271.7103 53423.2191  82.5%     - 1308s
     0     0 53364.6535    0  341 29271.7103 53364.6535  82.3%     - 1334s
     0     0 53356.8931    0  346 29271.7103 53356.8931  82.3%     - 1340s
     0     0 53349.4972    0  347 29271.7103 53349.4972  82.3%     - 1348s
     0     0 53340.6087    0  346 29271.7103 53340.6087  82.2%     - 1358s
     0     0 53330.9056    0  383 29271.7103 53330.9056  82.2%     - 1365s
     0     0 53300.7795    0  339 29271.7103 53300.7795  82.1%     - 1379s
     0     0 53293.4323    0  339 29271.7103 53293.4323  82.1%     - 1386s
     0     0 53286.6135    0  344 29271.7103 53286.6135  82.0%     - 1393s
     0     0 53267.7571    0  383 29271.7103 53267.7571  82.0%     - 1408s
     0     0 53253.5039    0  393 29271.7103 53253.5039  81.9%     - 1421s
     0     0 53247.0530    0  386 29271.7103 53247.0530  81.9%     - 1428s
     0     0 53245.2560    0  347 29271.7103 53245.2560  81.9%     - 1433s
     0     0 53244.8247    0  345 29271.7103 53244.8247  81.9%     - 1435s
     0     0 52249.3950    0  340 29271.7103 52249.3950  78.5%     - 1532s
     0     0 51998.8714    0  361 29271.7103 51998.8714  77.6%     - 1591s
     0     0 51933.4085    0  364 29271.7103 51933.4085  77.4%     - 1610s
     0     0 51872.1840    0  372 29271.7103 51872.1840  77.2%     - 1639s
     0     0 51853.8203    0  371 29271.7103 51853.8203  77.1%     - 1649s
     0     0 51816.0788    0  366 29271.7103 51816.0788  77.0%     - 1662s
     0     0 51799.6771    0  362 29271.7103 51799.6771  77.0%     - 1672s
     0     0 51789.6504    0  372 29271.7103 51789.6504  76.9%     - 1680s
     0     0 51783.4551    0  370 29271.7103 51783.4551  76.9%     - 1686s
     0     0 51754.1493    0  365 29271.7103 51754.1493  76.8%     - 1700s
     0     0 51737.2863    0  365 29271.7103 51737.2863  76.7%     - 1708s
     0     0 51688.1388    0  370 29271.7103 51688.1388  76.6%     - 1724s
     0     0 51681.6812    0  369 29271.7103 51681.6812  76.6%     - 1732s
     0     0 51674.0853    0  369 29271.7103 51674.0853  76.5%     - 1736s
     0     0 51671.3244    0  370 29271.7103 51671.3244  76.5%     - 1739s
     0     0 51668.7258    0  377 29271.7103 51668.7258  76.5%     - 1744s
     0     0 51663.8941    0  376 29271.7103 51663.8941  76.5%     - 1751s
     0     0 51658.7325    0  380 29271.7103 51658.7325  76.5%     - 1759s
     0     0 51656.3816    0  377 29271.7103 51656.3816  76.5%     - 1763s
     0     0 51632.5894    0  377 29271.7103 51632.5894  76.4%     - 1778s
     0     0 51627.9741    0  377 29271.7103 51627.9741  76.4%     - 1787s
     0     0 51621.4393    0  383 29271.7103 51621.4393  76.4%     - 1792s
     0     0 51533.3102    0  381 29271.7103 51533.3102  76.1%     - 1807s
     0     0 51518.0061    0  386 29271.7103 51518.0061  76.0%     - 1818s
     0     0 51515.9890    0  382 29271.7103 51515.9890  76.0%     - 1822s
     0     0 51249.6888    0  368 29271.7103 51249.6888  75.1%     - 1874s
H    0     0                    29313.754206 51249.1700  74.8%     - 1876s
H    0     0                    29425.263976 51249.1700  74.2%     - 1876s
H    0     0                    29429.950245 51249.1700  74.1%     - 1876s
H    0     0                    29489.126565 51249.1700  73.8%     - 1876s
     0     0 51184.7213    0  364 29489.1266 51184.7213  73.6%     - 1901s
     0     0 51168.9712    0  367 29489.1266 51168.9712  73.5%     - 1914s
     0     0 51148.5342    0  366 29489.1266 51148.5342  73.4%     - 1925s
     0     0 51124.9469    0  377 29489.1266 51124.9469  73.4%     - 1941s
     0     0 51105.1757    0  387 29489.1266 51105.1757  73.3%     - 1953s
     0     0 51087.1135    0  378 29489.1266 51087.1135  73.2%     - 1965s
     0     0 51082.3009    0  379 29489.1266 51082.3009  73.2%     - 1975s
     0     0 51071.8748    0  390 29489.1266 51071.8748  73.2%     - 1984s
     0     0 51060.2055    0  391 29489.1266 51060.2055  73.1%     - 1994s
     0     0 51054.2645    0  395 29489.1266 51054.2645  73.1%     - 2004s
     0     0 51051.6693    0  396 29489.1266 51051.6693  73.1%     - 2010s
     0     0 51051.2598    0  392 29489.1266 51051.2598  73.1%     - 2014s
     0     0 50917.3764    0  376 29489.1266 50917.3764  72.7%     - 2042s
     0     0 50851.4111    0  464 29489.1266 50851.4111  72.4%     - 2077s
     0     0 50810.2629    0  393 29489.1266 50810.2629  72.3%     - 2094s
     0     0 50792.9175    0  463 29489.1266 50792.9175  72.2%     - 2115s
     0     0 50784.7642    0  474 29489.1266 50784.7642  72.2%     - 2126s
     0     0 50782.5715    0  467 29489.1266 50782.5715  72.2%     - 2132s
     0     0 50737.7865    0  394 29489.1266 50737.7865  72.1%     - 2155s
     0     0 50708.0894    0  394 29489.1266 50708.0894  72.0%     - 2175s
     0     0 50701.5011    0  390 29489.1266 50701.5011  71.9%     - 2184s
     0     0 50697.1969    0  394 29489.1266 50697.1969  71.9%     - 2192s
     0     0 50696.4900    0  395 29489.1266 50696.4900  71.9%     - 2194s
     0     0 50671.3633    0  384 29489.1266 50671.3633  71.8%     - 2213s
     0     0 50662.3369    0  392 29489.1266 50662.3369  71.8%     - 2223s
     0     0 50657.2444    0  395 29489.1266 50657.2444  71.8%     - 2229s
     0     0 50652.2548    0  392 29489.1266 50652.2548  71.8%     - 2234s
     0     0 50648.6151    0  396 29489.1266 50648.6151  71.8%     - 2240s
     0     0 50646.9737    0  396 29489.1266 50646.9737  71.7%     - 2243s
     0     0 50635.7331    0  394 29489.1266 50635.7331  71.7%     - 2255s
     0     0 50630.2257    0  426 29489.1266 50630.2257  71.7%     - 2266s
     0     0 50625.2301    0  393 29489.1266 50625.2301  71.7%     - 2278s
     0     0 50621.8236    0  396 29489.1266 50621.8236  71.7%     - 2283s
     0     0 50619.6296    0  399 29489.1266 50619.6296  71.7%     - 2287s
     0     0 50612.1546    0  391 29489.1266 50612.1546  71.6%     - 2297s
     0     0 50606.7336    0  387 29489.1266 50606.7336  71.6%     - 2306s
     0     0 50602.8469    0  389 29489.1266 50602.8469  71.6%     - 2312s
     0     0 50599.4677    0  388 29489.1266 50599.4677  71.6%     - 2318s
     0     0 50598.4303    0  393 29489.1266 50598.4303  71.6%     - 2323s
     0     0 50592.6076    0  392 29489.1266 50592.6076  71.6%     - 2332s
     0     0 50590.0031    0  390 29489.1266 50590.0031  71.6%     - 2337s
     0     0 50586.9941    0  420 29489.1266 50586.9941  71.5%     - 2341s
     0     0 50583.6822    0  414 29489.1266 50583.6822  71.5%     - 2346s
     0     0 50582.4853    0  416 29489.1266 50582.4853  71.5%     - 2351s
     0     0 50576.3461    0  379 29489.1266 50576.3461  71.5%     - 2358s
     0     0 50576.2794    0  379 29489.1266 50576.2794  71.5%     - 2366s
H    0     0                    29585.078665 50576.2794  71.0%     - 2529s
H    0     0                    29626.647244 50576.2794  70.7%     - 2685s
H    0     0                    29691.161821 50576.2794  70.3%     - 2700s
H    0     2                    29784.407333 50576.2794  69.8%     - 2753s
     0     2 50576.2794    0  379 29784.4073 50576.2794  69.8%     - 2753s
     1     4 50564.1909    1  375 29784.4073 50576.2794  69.8%  3651 2768s
     3     7 50489.6793    2  460 29784.4073 50558.8624  69.7%  7081 2817s
     6    12 50356.8558    3  379 29784.4073 50524.5842  69.6% 10048 2873s
    11    24 50257.5352    4  381 29784.4073 50425.7748  69.3% 13870 2911s
    23    36 48326.7581    5  300 29784.4073 50299.3520  68.9% 22235 3031s
    35    62 47371.0328    5  316 29784.4073 50299.3520  68.9% 26896 3424s
H   40    62                    30038.672808 50299.3520  67.4% 25891 3424s
    61    94 48008.9332    6  327 30038.6728 50007.8747  66.5% 34041 3484s
    93   154 47946.5470    7  318 30038.6728 49876.3519  66.0% 29058 3600s

Cutting planes:
  Gomory: 15
  Implied bound: 178
  MIR: 3755
  Flow cover: 3504
  RLT: 50
  Relax-and-lift: 616

Explored 153 nodes (4522907 simplex iterations) in 3600.20 seconds (4477.30 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 30038.7 29784.4 29691.2 ... 29204.9

Time limit reached
Best objective 3.003867280791e+04, best bound 4.987634582645e+04, gap 66.0404%
  WARNING: Time limit reached. Using best solution found (gap: 66.04%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.25s
  Master Objective (UB) = 30038.67, θ = 181644.48
  Upper Bound (UB) = 30038.67

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 181644.48
  [DEBUG]   ✓ Scenario 0: θ = 181644.48 ≤ Q = 181644.48 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 181644.48 ≤ Q = 181644.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 181644.48 ≤ Q = 181644.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 181644.48 ≤ Q = 181644.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 181644.48 ≤ Q = 181644.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 181644.48 ≤ Q = 181644.48 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 181644.48 ≤ Q = 181644.48 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 181644.48 ≤ Q = 181644.48 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 181644.48 ≤ Q = 181644.48 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 181644.48 ≤ Q = 181644.48 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 181644.48 ≤ Q = 181644.48 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 181644.48 ≤ Q = 181644.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 181644.48 ≤ Q = 181644.48 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 181644.48 ≤ Q = 181644.48 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 181644.48 ≤ Q = 181644.48 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 181644.48 ≤ Q = 181644.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 181644.48 ≤ Q = 181644.48 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 181644.48 ≤ Q = 181644.48 (slack: 0.00)
  [DEBUG]   ✓ Scenario 18: θ = 181644.48 ≤ Q = 181644.48 (slack: 0.00)
  [DEBUG]   ✓ Scenario 19: θ = 181644.48 ≤ Q = 181644.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 20: θ = 181644.48 ≤ Q = 181644.48 (slack: 0.00)
  [DEBUG]   ✓ Scenario 21: θ = 181644.48 ≤ Q = 181644.48 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 22] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x4afd1103
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x4afd1103
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [7e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [8e-14, 2e+02]
Found heuristic solution: objective 1.413412e+13
Presolve removed 2600 rows and 1892 columns
Presolve time: 0.01s
Presolved: 493 rows, 497 columns, 1393 nonzeros
Found heuristic solution: objective 6908289.2901
Variable types: 337 continuous, 160 integer (160 binary)

Root relaxation: objective -1.573972e+05, 253 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -157397.22    0  128 6908289.29 -157397.22   102%     -    0s
H    0     0                    -120424.2787 -157397.22  30.7%     -    0s
H    0     0                    -121839.1771 -157397.22  29.2%     -    0s
     0     0 -137832.93    0   61 -121839.18 -137832.93  13.1%     -    0s
H    0     0                    -134632.8175 -137682.90  2.27%     -    0s
     0     0 -137540.48    0   61 -134632.82 -137540.48  2.16%     -    0s
H    0     0                    -136190.6894 -137532.87  0.99%     -    0s
     0     0 -137532.87    0   61 -136190.69 -137532.87  0.99%     -    0s
     0     0 -136559.81    0   31 -136190.69 -136559.81  0.27%     -    0s
     0     0 -136451.63    0   23 -136190.69 -136451.63  0.19%     -    0s
     0     0 -136401.68    0   17 -136190.69 -136401.68  0.15%     -    0s
     0     0 -136384.29    0   16 -136190.69 -136384.29  0.14%     -    0s
     0     0 -136378.00    0   16 -136190.69 -136378.00  0.14%     -    0s
     0     0 -136375.73    0   16 -136190.69 -136375.73  0.14%     -    0s
     0     0 -136363.99    0   16 -136190.69 -136363.99  0.13%     -    0s
     0     0 -136318.03    0    8 -136190.69 -136318.03  0.09%     -    0s
     0     0 -136284.64    0   13 -136190.69 -136284.64  0.07%     -    0s
     0     0 -136282.49    0   11 -136190.69 -136282.49  0.07%     -    0s
H    0     0                    -136199.2792 -136282.49  0.06%     -    0s
     0     0 -136231.54    0    2 -136199.28 -136231.54  0.02%     -    0s
*    0     0               0    -136222.3022 -136222.30  0.00%     -    0s

Cutting planes:
  Gomory: 1
  Implied bound: 6
  MIR: 2
  Flow cover: 7
  Relax-and-lift: 3

Explored 1 nodes (641 simplex iterations) in 0.12 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 7: -136222 -136199 -136191 ... 1.41341e+13
No other solutions better than -136222

Optimal solution found (tolerance 1.00e-06)
Best objective -1.362223022456e+05, best bound -1.362223022456e+05, gap 0.0000%
  Subproblem solved in 0.17s
  Worst-case operational profit (Z_SP) = 170571.93
  Scenario: 24 demand increases, 36 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -136222.30
  [DEBUG]   S×d_nominal = 306794.23
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 306794.23 + -136222.30 = 170571.93
  [DEBUG]   Current θ from Master = 181644.48
  [DEBUG]   ⚠️  Z_SP ≤ θ by 11072.55 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 18966.12
  Lower Bound (LB) = 29447.80
  Gap (UB-LB) = 590.8719, Absolute Gap = 590.8719, Relative Gap = 0.019670
  Not converged yet (gap = 590.87 > ε = 200)

  [DEBUG] Adding NEW scenario 22 to Master Problem...
  [DEBUG] New scenario pattern: 24 increases, 36 decreases
    [DEBUG] Scenario 22 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 22 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 22]
    [DEBUG]   - Total constraints in model: 353053
    [DEBUG]   - Total variables in model: 145780
  [DEBUG] Total scenarios in Master: 23
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 23
================================================================================
[Iteration 23] Solving Master Problem...
  Current scenarios in Master: 23
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 353053 rows, 145780 columns and 999832 nonzeros
Model fingerprint: 0xea2829f7
Variable types: 143521 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 162610 rows and 66010 columns (presolve time = 5s)...
Presolve removed 162610 rows and 66010 columns
Presolve time: 7.13s
Presolved: 190443 rows, 79770 columns, 1172713 nonzeros
Variable types: 77511 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -335473.7764
Found heuristic solution: objective -180138.7472

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 2.34s

Barrier statistics:
 Dense cols : 1149
 AA' NZ     : 5.094e+06
 Factor NZ  : 1.411e+07 (roughly 220 MB of memory)
 Factor Ops : 4.903e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.05097131e+07  3.36267063e+08  1.52e+05 1.29e+01  9.49e+04    13s
   1  -1.60215954e+07  3.15921163e+08  1.08e+05 7.72e+01  6.69e+04    13s
   2  -7.04058356e+06  2.37964904e+08  4.61e+04 5.43e+00  3.05e+04    13s
   3  -1.73940932e+06  2.13312037e+08  6.94e+03 2.26e+00  5.06e+03    13s
   4  -7.73086707e+05  1.27557959e+08  1.08e+03 5.18e-01  1.02e+03    14s
   5  -5.33382553e+05  7.31306643e+07  5.02e+02 2.18e-01  4.84e+02    14s
   6  -4.53940437e+05  5.56305111e+07  2.31e+02 1.62e-01  2.80e+02    14s
   7  -4.11937112e+05  3.99088250e+07  9.94e+01 1.08e-01  1.62e+02    14s
   8  -3.79927857e+05  2.78910165e+07  5.72e+01 7.20e-02  1.04e+02    14s
   9  -2.80636209e+05  1.95885987e+07  1.05e+01 4.87e-02  6.07e+01    14s
  10  -1.71887798e+05  1.07327202e+07  2.31e+00 2.57e-02  3.19e+01    15s
  11  -1.26722531e+05  6.34194324e+06  1.47e+00 1.49e-02  1.88e+01    15s
  12  -1.05015462e+05  5.38515885e+06  1.03e+00 1.25e-02  1.59e+01    15s
  13  -8.63127478e+04  3.10784270e+06  5.78e-01 7.03e-03  9.25e+00    15s
  14  -5.89270914e+04  9.82732997e+05  2.30e-01 2.04e-03  3.01e+00    15s
  15  -3.97037301e+04  4.50674275e+05  1.40e-01 7.76e-04  1.42e+00    15s
  16   3.70178002e+03  3.00042682e+05  5.58e-02 1.57e-03  8.55e-01    15s
  17   2.31176447e+04  1.92256005e+05  2.93e-02 2.47e-03  4.88e-01    16s
  18   3.06380227e+04  1.52477560e+05  2.22e-02 1.86e-03  3.52e-01    16s
  19   3.31190771e+04  1.42489412e+05  2.02e-02 1.66e-03  3.16e-01    16s
  20   3.60239543e+04  1.28629830e+05  1.77e-02 1.39e-03  2.67e-01    16s
  21   4.08704244e+04  1.11546350e+05  1.41e-02 1.02e-03  2.04e-01    17s
  22   4.57027229e+04  1.01153754e+05  1.08e-02 8.09e-04  1.60e-01    17s
  23   4.75883480e+04  9.12408857e+04  9.60e-03 5.90e-04  1.26e-01    17s
  24   5.01822296e+04  8.48283559e+04  8.12e-03 4.66e-04  1.00e-01    17s
  25   5.46904064e+04  8.22989068e+04  5.61e-03 4.01e-04  7.97e-02    18s
  26   5.67346457e+04  7.77216287e+04  4.60e-03 2.97e-04  6.06e-02    18s
  27   5.86062213e+04  7.60416184e+04  3.70e-03 2.51e-04  5.03e-02    18s
  28   6.02876030e+04  7.38140249e+04  2.92e-03 1.89e-04  3.90e-02    18s
  29   6.10855067e+04  7.21646809e+04  2.57e-03 1.41e-04  3.20e-02    19s
  30   6.30420210e+04  7.08964124e+04  1.71e-03 1.05e-04  2.27e-02    19s
  31   6.37967808e+04  7.01907185e+04  1.38e-03 8.39e-05  1.85e-02    19s
  32   6.43077744e+04  6.89893089e+04  1.17e-03 5.09e-05  1.35e-02    19s
  33   6.53033247e+04  6.87213651e+04  7.65e-04 4.29e-05  9.86e-03    20s
  34   6.61761323e+04  6.79052098e+04  4.17e-04 1.75e-05  4.99e-03    20s
  35   6.64101505e+04  6.76051262e+04  3.27e-04 9.57e-06  3.45e-03    20s
  36   6.65476156e+04  6.75775642e+04  2.74e-04 8.66e-06  2.97e-03    20s
  37   6.70256997e+04  6.74574516e+04  9.68e-05 4.79e-06  1.25e-03    20s
  38   6.71436615e+04  6.74169677e+04  5.47e-05 3.52e-06  7.89e-04    21s
  39   6.72119706e+04  6.73750783e+04  3.02e-05 2.20e-06  4.71e-04    21s
  40   6.72207366e+04  6.73480709e+04  2.73e-05 1.37e-06  3.67e-04    21s
  41   6.72502034e+04  6.73377912e+04  1.72e-05 1.06e-06  2.53e-04    21s
  42   6.72649880e+04  6.73209411e+04  1.20e-05 5.53e-07  1.61e-04    22s
  43   6.72718047e+04  6.73115066e+04  9.69e-06 2.76e-07  1.15e-04    22s
  44   6.72821032e+04  6.73086223e+04  6.15e-06 2.01e-07  7.65e-05    22s
  45   6.72871475e+04  6.73059475e+04  4.53e-06 3.22e-07  5.43e-05    22s
  46   6.72943718e+04  6.73051350e+04  2.28e-06 2.63e-07  3.11e-05    23s
  47   6.72977314e+04  6.73035121e+04  1.25e-06 1.21e-07  1.67e-05    23s
  48   6.72988004e+04  6.73033338e+04  9.41e-07 1.06e-07  1.31e-05    23s
  49   6.73010968e+04  6.73030902e+04  2.60e-07 8.51e-08  5.75e-06    23s
  50   6.73020180e+04  6.73021244e+04  1.31e-08 1.23e-08  3.07e-07    23s
  51   6.73020378e+04  6.73020979e+04  7.69e-09 6.79e-09  1.73e-07    24s
  52   6.73020638e+04  6.73020654e+04  1.36e-09 1.58e-09  4.64e-09    24s
  53   6.73020649e+04  6.73020649e+04  1.11e-08 3.33e-09  5.20e-11    25s

Barrier solved model in 53 iterations and 24.57 seconds (20.51 work units)
Optimal objective 6.73020649e+04


Root crossover log...

  170725 DPushes remaining with DInf 0.0000000e+00                25s
   84553 DPushes remaining with DInf 0.0000000e+00                26s
   14061 DPushes remaining with DInf 0.0000000e+00                30s
       0 DPushes remaining with DInf 0.0000000e+00                33s

    2925 PPushes remaining with PInf 2.0341749e-05                33s
       0 PPushes remaining with PInf 0.0000000e+00                34s

  Push phase complete: Pinf 0.0000000e+00, Dinf 7.1802194e+01     34s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   72653    6.7302065e+04   0.000000e+00   7.180219e+01     34s
   72689    6.7302065e+04   0.000000e+00   0.000000e+00     34s
   72689    6.7302065e+04   0.000000e+00   0.000000e+00     34s
Concurrent spin time: 5.51s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 6.730206e+04, 72689 iterations, 30.42 seconds (29.24 work units)
Total elapsed time = 40.16s (DegenMoves)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 67302.0649    0  153 -180138.75 67302.0649   137%     -   40s
H    0     0                    -173988.5252 67302.0649   139%     -   40s
H    0     0                    -142922.8657 67302.0649   147%     -   42s
H    0     0                    -126191.4762 67302.0649   153%     -   42s
H    0     0                    -97445.33101 67302.0649   169%     -   42s
H    0     0                    -92816.10571 67302.0649   173%     -   42s
H    0     0                    -92777.29644 67302.0649   173%     -   43s
H    0     0                    -92379.41592 67302.0649   173%     -   43s
H    0     0                    -61879.27678 67302.0649   209%     -   43s
H    0     0                    18501.287646 67302.0649   264%     -   44s
H    0     0                    20286.392331 67302.0649   232%     -   45s
H    0     0                    20779.551825 67302.0649   224%     -   45s
H    0     0                    20887.352840 67302.0649   222%     -   45s
H    0     0                    20889.169872 67302.0649   222%     -   45s
H    0     0                    20900.990241 67302.0649   222%     -   45s
H    0     0                    20967.999238 67302.0649   221%     -   45s
H    0     0                    21049.664809 67302.0649   220%     -   45s
     0     0 62159.9513    0  174 21049.6648 62159.9513   195%     -  142s
     0     0 61925.1031    0  200 21049.6648 61925.1031   194%     -  177s
     0     0 61798.1938    0  198 21049.6648 61798.1938   194%     -  197s
     0     0 61464.9981    0  218 21049.6648 61464.9981   192%     -  231s
     0     0 61397.3884    0  220 21049.6648 61397.3884   192%     -  255s
     0     0 61092.3228    0  213 21049.6648 61092.3228   190%     -  286s
     0     0 61083.4093    0  220 21049.6648 61083.4093   190%     -  292s
     0     0 61044.3858    0  213 21049.6648 61044.3858   190%     -  298s
     0     0 61044.2885    0  220 21049.6648 61044.2885   190%     -  302s
     0     0 57782.0697    0  280 21049.6648 57782.0697   175%     -  431s
     0     0 57781.9846    0  280 21049.6648 57781.9846   175%     -  432s
H    0     0                    22703.191644 57781.9845   155%     -  434s
H    0     0                    23259.419679 57781.9845   148%     -  434s
H    0     0                    23915.094877 57781.9845   142%     -  434s
H    0     0                    23944.398622 57781.9845   141%     -  434s
H    0     0                    24040.612448 57781.9845   140%     -  434s
H    0     0                    24085.291406 57781.9845   140%     -  434s
H    0     0                    24272.437478 57781.9845   138%     -  434s
     0     0 57544.2553    0  293 24272.4375 57544.2553   137%     -  493s
     0     0 57474.1442    0  309 24272.4375 57474.1442   137%     -  525s
     0     0 57053.3750    0  285 24272.4375 57053.3750   135%     -  591s
     0     0 56956.3654    0  296 24272.4375 56956.3654   135%     -  626s
     0     0 56936.8493    0  301 24272.4375 56936.8493   135%     -  635s
     0     0 56931.6043    0  300 24272.4375 56931.6043   135%     -  642s
     0     0 56907.5975    0  302 24272.4375 56907.5975   134%     -  655s
     0     0 56898.8804    0  305 24272.4375 56898.8804   134%     -  662s
     0     0 56879.8720    0  300 24272.4375 56879.8720   134%     -  676s
     0     0 56837.5964    0  298 24272.4375 56837.5964   134%     -  687s
     0     0 56816.1176    0  305 24272.4375 56816.1176   134%     -  697s
     0     0 56811.5409    0  301 24272.4375 56811.5409   134%     -  703s
     0     0 56811.1468    0  303 24272.4375 56811.1468   134%     -  705s
     0     0 54453.0351    0  314 24272.4375 54453.0351   124%     -  886s
H    0     0                    24629.870812 54452.7173   121%     -  888s
H    0     0                    24676.951554 54452.7173   121%     -  888s
     0     0 54129.7300    0  329 24676.9516 54129.7300   119%     -  971s
     0     0 53947.1313    0  338 24676.9516 53947.1313   119%     - 1028s
     0     0 53728.5129    0  331 24676.9516 53728.5129   118%     - 1080s
     0     0 53705.8769    0  346 24676.9516 53705.8769   118%     - 1106s
     0     0 53684.1832    0  338 24676.9516 53684.1832   118%     - 1129s
     0     0 53674.6509    0  337 24676.9516 53674.6509   118%     - 1138s
     0     0 53654.0590    0  330 24676.9516 53654.0590   117%     - 1161s
     0     0 53618.1454    0  339 24676.9516 53618.1454   117%     - 1177s
     0     0 53615.2775    0  338 24676.9516 53615.2775   117%     - 1184s
     0     0 53549.0928    0  339 24676.9516 53549.0928   117%     - 1208s
     0     0 53527.0571    0  343 24676.9516 53527.0571   117%     - 1227s
     0     0 53503.1975    0  342 24676.9516 53503.1975   117%     - 1244s
     0     0 53499.6173    0  340 24676.9516 53499.6173   117%     - 1250s
     0     0 53497.0187    0  339 24676.9516 53497.0187   117%     - 1258s
     0     0 53489.5908    0  336 24676.9516 53489.5908   117%     - 1268s
     0     0 53482.0032    0  339 24676.9516 53482.0032   117%     - 1283s
     0     0 53457.4123    0  341 24676.9516 53457.4123   117%     - 1295s
     0     0 53445.9966    0  340 24676.9516 53445.9966   117%     - 1309s
     0     0 53444.4543    0  340 24676.9516 53444.4543   117%     - 1314s
     0     0 52371.5959    0  348 24676.9516 52371.5959   112%     - 1467s
H    0     0                    24762.120954 52371.5735   111%     - 1469s
     0     0 52010.0661    0  355 24762.1210 52010.0661   110%     - 1535s
     0     0 51759.5821    0  368 24762.1210 51759.5821   109%     - 1601s
     0     0 51678.0219    0  363 24762.1210 51678.0219   109%     - 1632s
     0     0 51636.9126    0  373 24762.1210 51636.9126   109%     - 1651s
     0     0 51618.3330    0  370 24762.1210 51618.3330   108%     - 1664s
     0     0 51609.9122    0  374 24762.1210 51609.9122   108%     - 1671s
     0     0 51605.7745    0  376 24762.1210 51605.7745   108%     - 1677s
     0     0 51598.1025    0  374 24762.1210 51598.1025   108%     - 1684s
     0     0 51590.1638    0  367 24762.1210 51590.1638   108%     - 1693s
     0     0 51573.8489    0  367 24762.1210 51573.8489   108%     - 1704s
     0     0 51566.5283    0  371 24762.1210 51566.5283   108%     - 1711s
     0     0 51563.6694    0  371 24762.1210 51563.6694   108%     - 1717s
     0     0 51561.0492    0  375 24762.1210 51561.0492   108%     - 1722s
     0     0 51559.2869    0  372 24762.1210 51559.2869   108%     - 1726s
     0     0 51252.6312    0  369 24762.1210 51252.6312   107%     - 1804s
     0     0 51160.4737    0  391 24762.1210 51160.4737   107%     - 1849s
     0     0 51128.4233    0  394 24762.1210 51128.4233   106%     - 1875s
     0     0 51115.6826    0  391 24762.1210 51115.6826   106%     - 1894s
     0     0 51107.1350    0  395 24762.1210 51107.1350   106%     - 1905s
     0     0 51100.5139    0  401 24762.1210 51100.5139   106%     - 1917s
     0     0 51013.2548    0  386 24762.1210 51013.2548   106%     - 1952s
     0     0 50977.5896    0  390 24762.1210 50977.5896   106%     - 1987s
     0     0 50956.9914    0  392 24762.1210 50956.9914   106%     - 2006s
     0     0 50948.2320    0  463 24762.1210 50948.2320   106%     - 2024s
     0     0 50942.6813    0  464 24762.1210 50942.6813   106%     - 2034s
     0     0 50940.1160    0  463 24762.1210 50940.1160   106%     - 2047s
     0     0 50938.4543    0  385 24762.1210 50938.4543   106%     - 2052s
     0     0 50746.0854    0  378 24762.1210 50746.0854   105%     - 2114s
     0     0 50683.3696    0  430 24762.1210 50683.3696   105%     - 2149s
     0     0 50656.8875    0  435 24762.1210 50656.8875   105%     - 2165s
     0     0 50649.6428    0  379 24762.1210 50649.6428   105%     - 2177s
     0     0 50639.9591    0  382 24762.1210 50639.9591   105%     - 2183s
     0     0 50636.1322    0  382 24762.1210 50636.1322   104%     - 2190s
     0     0 50635.3443    0  387 24762.1210 50635.3443   104%     - 2195s
     0     0 50565.7980    0  381 24762.1210 50565.7980   104%     - 2226s
     0     0 50550.2486    0  407 24762.1210 50550.2486   104%     - 2245s
     0     0 50546.8912    0  374 24762.1210 50546.8912   104%     - 2251s
     0     0 50542.0863    0  380 24762.1210 50542.0863   104%     - 2257s
     0     0 50539.1363    0  387 24762.1210 50539.1363   104%     - 2261s
     0     0 50537.1248    0  381 24762.1210 50537.1248   104%     - 2265s
     0     0 50514.2339    0  393 24762.1210 50514.2339   104%     - 2283s
H    0     0                    28347.633790 50514.1165  78.2%     - 2285s
H    0     0                    28790.738573 50514.1165  75.5%     - 2287s
H    0     0                    29207.935875 50514.1165  72.9%     - 2287s
H    0     0                    29483.366942 50514.1165  71.3%     - 2288s
H    0     0                    29657.740024 50514.1165  70.3%     - 2288s
     0     0 50500.7776    0  388 29657.7400 50500.7776  70.3%     - 2301s
     0     0 50494.6777    0  390 29657.7400 50494.6777  70.3%     - 2305s
     0     0 50491.4101    0  377 29657.7400 50491.4101  70.2%     - 2310s
     0     0 50490.2546    0  429 29657.7400 50490.2546  70.2%     - 2313s
     0     0 50479.0277    0  438 29657.7400 50479.0277  70.2%     - 2326s
H    0     0                    29664.157776 50478.7460  70.2%     - 2328s
     0     0 50474.3134    0  443 29664.1578 50474.3134  70.2%     - 2333s
     0     0 50471.0711    0  526 29664.1578 50471.0711  70.1%     - 2343s
     0     0 50469.2588    0  406 29664.1578 50469.2588  70.1%     - 2348s
     0     0 50437.5496    0  389 29664.1578 50437.5496  70.0%     - 2368s
H    0     0                    29753.202766 50437.3314  69.5%     - 2374s
H    0     0                    29931.578784 50437.3314  68.5%     - 2374s
     0     0 50426.0077    0  395 29931.5788 50426.0077  68.5%     - 2386s
     0     0 50421.8563    0  399 29931.5788 50421.8563  68.5%     - 2394s
     0     0 50418.8837    0  394 29931.5788 50418.8837  68.4%     - 2399s
     0     0 50417.8715    0  398 29931.5788 50417.8715  68.4%     - 2401s
     0     0 50388.4483    0  440 29931.5788 50388.4483  68.3%     - 2419s
     0     0 50380.0490    0  524 29931.5788 50380.0490  68.3%     - 2435s
     0     0 50378.1215    0  523 29931.5788 50378.1215  68.3%     - 2441s
     0     0 50370.4890    0  441 29931.5788 50370.4890  68.3%     - 2456s
H    0     0                    29956.065485 50370.3276  68.1%     - 2466s
H    0     0                    29987.323618 50370.3276  68.0%     - 2467s
     0     0 50369.0790    0  438 29987.3236 50369.0790  68.0%     - 2471s
     0     0 50361.6311    0  446 29987.3236 50361.6311  67.9%     - 2485s
H    0     0                    29988.876726 50361.4050  67.9%     - 2487s
     0     0 50358.4089    0  402 29988.8767 50358.4089  67.9%     - 2495s
     0     0 50357.0269    0  428 29988.8767 50357.0269  67.9%     - 2499s
     0     0 50350.2444    0  430 29988.8767 50350.2444  67.9%     - 2509s
     0     0 50346.3125    0  430 29988.8767 50346.3125  67.9%     - 2518s
H    0     0                    30304.053283 50346.2524  66.1%     - 2993s
H    0     0                    30414.994360 50346.2524  65.5%     - 2998s
H    0     0                    31063.060625 50346.2524  62.1%     - 2998s
H    0     0                    31113.080205 50346.2524  61.8%     - 2998s
H    0     0                    31115.679260 50346.2524  61.8%     - 3017s
H    0     0                    31154.698399 50346.2524  61.6%     - 3019s
H    0     2                    31494.564005 50346.2524  59.9%     - 3044s
     0     2 50346.2524    0  430 31494.5640 50346.2524  59.9%     - 3044s
     1     3 49997.5641    1  363 31494.5640 50346.1721  59.9% 12560 3073s
     2     5 49543.3910    2  387 31494.5640 50346.1721  59.9% 15628 3124s
     4    10 50079.4912    2  511 31494.5640 50228.3930  59.5% 14903 3182s
     9    17 49839.3772    3  396 31494.5640 50170.4636  59.3% 14628 3326s
    16    33 49675.2988    4  380 31494.5640 50037.6836  58.9% 19701 3400s
    32    48 47514.0861    5  383 31494.5640 49970.2488  58.7% 25974 3552s
    47    62 47252.2389    6  366 31494.5640 49970.2488  58.7% 34563 3600s
H   49    62                    31793.237061 49970.2488  57.2% 33294 3600s
H   60    62                    31796.638964 49970.2488  57.2% 28990 3600s

Cutting planes:
  Learned: 2
  Gomory: 3
  Implied bound: 154
  MIR: 4141
  Flow cover: 3392
  RLT: 40
  Relax-and-lift: 446
  BQP: 1

Explored 61 nodes (2765100 simplex iterations) in 3600.26 seconds (4397.07 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 31796.6 31793.2 31494.6 ... 29988.9

Time limit reached
Best objective 3.179663896393e+04, best bound 4.997024881780e+04, gap 57.1558%
  WARNING: Time limit reached. Using best solution found (gap: 57.16%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.30s
  Master Objective (UB) = 31796.64, θ = 184356.79
  Upper Bound (UB) = 31796.64

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 184356.79
  [DEBUG]   ✓ Scenario 0: θ = 184356.79 ≤ Q = 184356.79 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 184356.79 ≤ Q = 184356.79 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 184356.79 ≤ Q = 184356.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 184356.79 ≤ Q = 184356.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 184356.79 ≤ Q = 184356.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 184356.79 ≤ Q = 184356.79 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 184356.79 ≤ Q = 184356.79 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 184356.79 ≤ Q = 184356.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 184356.79 ≤ Q = 184356.79 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 184356.79 ≤ Q = 184356.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 184356.79 ≤ Q = 184356.79 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 184356.79 ≤ Q = 184356.79 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 184356.79 ≤ Q = 184356.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 184356.79 ≤ Q = 184356.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 184356.79 ≤ Q = 184356.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 184356.79 ≤ Q = 184356.79 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 184356.79 ≤ Q = 184356.79 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 184356.79 ≤ Q = 184356.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 184356.79 ≤ Q = 184356.79 (slack: 0.00)
  [DEBUG]   ✓ Scenario 19: θ = 184356.79 ≤ Q = 184356.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 20: θ = 184356.79 ≤ Q = 184356.79 (slack: 0.00)
  [DEBUG]   ✓ Scenario 21: θ = 184356.79 ≤ Q = 184356.79 (slack: 0.00)
  [DEBUG]   ✓ Scenario 22: θ = 184356.79 ≤ Q = 184356.79 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 23] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x6ada38f2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x9525c70e
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.402109e+13
Presolve removed 2612 rows and 1902 columns
Presolve time: 0.01s
Presolved: 481 rows, 487 columns, 1358 nonzeros
Found heuristic solution: objective 6840186.1304
Variable types: 329 continuous, 158 integer (158 binary)

Root relaxation: objective -1.563441e+05, 235 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -156344.05    0  122 6840186.13 -156344.05   102%     -    0s
H    0     0                    -114432.5382 -156344.05  36.6%     -    0s
H    0     0                    -117552.7863 -156344.05  33.0%     -    0s
H    0     0                    -127909.2493 -156344.05  22.2%     -    0s
     0     0 -136444.99    0   68 -127909.25 -136444.99  6.67%     -    0s
H    0     0                    -134171.6246 -136352.19  1.63%     -    0s
H    0     0                    -134620.5345 -136352.19  1.29%     -    0s
     0     0 -135751.69    0   61 -134620.53 -135751.69  0.84%     -    0s
     0     0 -135554.07    0   51 -134620.53 -135554.07  0.69%     -    0s
     0     0 -135554.07    0   50 -134620.53 -135554.07  0.69%     -    0s
     0     0 -135010.22    0   20 -134620.53 -135010.22  0.29%     -    0s
H    0     0                    -134665.1646 -134972.94  0.23%     -    0s
     0     0 -134877.51    0   24 -134665.16 -134877.51  0.16%     -    0s
     0     0 -134870.64    0   25 -134665.16 -134870.64  0.15%     -    0s
     0     0 -134703.23    0    7 -134665.16 -134703.23  0.03%     -    0s
     0     0 -134680.09    0    6 -134665.16 -134680.09  0.01%     -    0s
     0     0 -134678.54    0    5 -134665.16 -134678.54  0.01%     -    0s
     0     0     cutoff    0      -134665.16 -134665.16  0.00%     -    0s

Cutting planes:
  Implied bound: 1
  Flow cover: 3
  RLT: 2
  Relax-and-lift: 1

Explored 1 nodes (633 simplex iterations) in 0.10 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -134665 -134665 -134621 ... 1.40211e+13
No other solutions better than -134665

Optimal solution found (tolerance 1.00e-06)
Best objective -1.346651646219e+05, best bound -1.346651646219e+05, gap 0.0000%
  Subproblem solved in 0.13s
  Worst-case operational profit (Z_SP) = 174678.53
  Scenario: 31 demand increases, 29 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -134665.16
  [DEBUG]   S×d_nominal = 309343.69
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 309343.69 + -134665.16 = 174678.53
  [DEBUG]   Current θ from Master = 184356.79
  [DEBUG]   ⚠️  Z_SP ≤ θ by 9678.27 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 22118.37
  Lower Bound (LB) = 29447.80
  Gap (UB-LB) = 2348.8381, Absolute Gap = 2348.8381, Relative Gap = 0.073871
  Not converged yet (gap = 2348.84 > ε = 200)

  [DEBUG] Adding NEW scenario 23 to Master Problem...
  [DEBUG] New scenario pattern: 31 increases, 29 decreases
    [DEBUG] Scenario 23 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 23 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 23]
    [DEBUG]   - Total constraints in model: 368343
    [DEBUG]   - Total variables in model: 152020
  [DEBUG] Total scenarios in Master: 24
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 24
================================================================================
[Iteration 24] Solving Master Problem...
  Current scenarios in Master: 24
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 368343 rows, 152020 columns and 1043063 nonzeros
Model fingerprint: 0x52847666
Variable types: 149761 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 169680 rows and 68880 columns (presolve time = 5s)...
Presolve removed 169680 rows and 68880 columns
Presolve time: 7.17s
Presolved: 198663 rows, 83140 columns, 1223912 nonzeros
Variable types: 80881 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -335473.7764
Found heuristic solution: objective -180138.7472

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 2.33s

Barrier statistics:
 Dense cols : 1148
 AA' NZ     : 5.472e+06
 Factor NZ  : 1.524e+07 (roughly 240 MB of memory)
 Factor Ops : 5.507e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.11289140e+07  3.49356358e+08  1.56e+05 1.26e+01  9.73e+04    13s
   1  -1.65225660e+07  3.29551889e+08  1.11e+05 7.84e+01  6.86e+04    13s
   2  -7.37375398e+06  2.49267025e+08  4.83e+04 4.42e+00  3.17e+04    13s
   3  -1.70088436e+06  2.22234494e+08  6.76e+03 1.94e+00  4.92e+03    13s
   4  -7.93632287e+05  1.34546090e+08  1.14e+03 4.74e-01  1.05e+03    13s
   5  -5.79634610e+05  7.89800753e+07  5.18e+02 2.47e-01  5.00e+02    14s
   6  -5.00837680e+05  5.95847569e+07  3.15e+02 1.75e-01  3.27e+02    14s
   7  -4.24401820e+05  4.57377679e+07  1.20e+02 1.24e-01  1.85e+02    14s
   8  -3.76149800e+05  3.01949385e+07  4.54e+01 7.40e-02  1.03e+02    14s
   9  -2.86035973e+05  2.00527557e+07  7.01e+00 4.66e-02  5.85e+01    14s
  10  -1.99040328e+05  1.00429209e+07  1.71e+00 2.26e-02  2.86e+01    14s
  11  -1.46142374e+05  4.94775937e+06  1.14e+00 1.09e-02  1.42e+01    15s
  12  -1.11208626e+05  4.19571973e+06  7.51e-01 9.21e-03  1.20e+01    15s
  13  -9.33570577e+04  3.31865365e+06  4.96e-01 7.23e-03  9.47e+00    15s
  14  -7.62181737e+04  2.27530585e+06  3.35e-01 4.98e-03  6.52e+00    15s
  15  -4.86121593e+04  1.53591267e+06  1.57e-01 3.20e-03  4.39e+00    15s
  16  -2.16954221e+04  6.38800480e+05  7.63e-02 1.38e-03  1.83e+00    15s
  17   3.38041606e+03  2.94152928e+05  3.58e-02 1.22e-03  8.05e-01    16s
  18   1.80233447e+04  2.08316630e+05  2.46e-02 2.00e-03  5.27e-01    16s
  19   2.85230296e+04  1.68179929e+05  1.76e-02 2.05e-03  3.86e-01    16s
  20   3.30612166e+04  1.54857659e+05  1.48e-02 1.81e-03  3.37e-01    16s
  21   3.67900341e+04  1.22095077e+05  1.26e-02 1.20e-03  2.36e-01    17s
  22   4.19016438e+04  1.06921863e+05  9.97e-03 8.87e-04  1.80e-01    17s
  23   4.46667677e+04  9.76067027e+04  8.63e-03 7.14e-04  1.46e-01    17s
  24   4.74795227e+04  9.34142286e+04  7.34e-03 6.39e-04  1.27e-01    17s
  25   5.12727714e+04  9.07294416e+04  5.62e-03 5.75e-04  1.09e-01    18s
  26   5.39752922e+04  8.75284040e+04  4.43e-03 5.01e-04  9.28e-02    18s
  27   5.53727919e+04  8.32139783e+04  3.87e-03 4.05e-04  7.70e-02    18s
  28   5.81414835e+04  7.85122875e+04  2.83e-03 2.94e-04  5.64e-02    18s
  29   5.85654435e+04  7.71461573e+04  2.68e-03 2.59e-04  5.14e-02    19s
  30   6.08609504e+04  7.53526166e+04  1.88e-03 2.12e-04  4.01e-02    19s
  31   6.17334014e+04  7.34509132e+04  1.60e-03 1.67e-04  3.24e-02    19s
  32   6.26612631e+04  7.15524990e+04  1.31e-03 1.16e-04  2.46e-02    19s
  33   6.32621942e+04  7.10778942e+04  1.13e-03 1.03e-04  2.16e-02    20s
  34   6.41383363e+04  6.97295827e+04  8.70e-04 6.80e-05  1.55e-02    20s
  35   6.45270212e+04  6.92369941e+04  7.57e-04 5.39e-05  1.30e-02    20s
  36   6.53042500e+04  6.85778256e+04  5.36e-04 3.51e-05  9.06e-03    20s
  37   6.62738359e+04  6.80348272e+04  2.67e-04 1.98e-05  4.87e-03    21s
  38   6.65101579e+04  6.76642221e+04  2.03e-04 9.76e-06  3.19e-03    21s
  39   6.67583103e+04  6.75699220e+04  1.37e-04 7.01e-06  2.25e-03    21s
  40   6.69930241e+04  6.74505145e+04  7.59e-05 3.75e-06  1.27e-03    22s
  41   6.70034205e+04  6.74289605e+04  7.32e-05 3.20e-06  1.18e-03    22s
  42   6.71440590e+04  6.73690609e+04  3.89e-05 1.63e-06  6.23e-04    22s
  43   6.71498118e+04  6.73627652e+04  3.74e-05 1.47e-06  5.89e-04    22s
  44   6.71851032e+04  6.73499892e+04  2.85e-05 1.14e-06  4.56e-04    22s
  45   6.72166975e+04  6.73358514e+04  2.06e-05 7.84e-07  3.30e-04    23s
  46   6.72270660e+04  6.73329070e+04  1.80e-05 7.10e-07  2.93e-04    23s
  47   6.72634411e+04  6.73189398e+04  8.87e-06 3.85e-07  1.54e-04    23s
  48   6.72723031e+04  6.73103764e+04  6.78e-06 1.85e-07  1.05e-04    24s
  49   6.72843048e+04  6.73078118e+04  3.95e-06 1.24e-07  6.50e-05    24s
  50   6.72962072e+04  6.73050907e+04  1.07e-06 5.84e-08  2.46e-05    24s
  51   6.72988125e+04  6.73043569e+04  5.73e-07 4.43e-08  1.53e-05    24s
  52   6.73002159e+04  6.73036213e+04  3.04e-07 2.98e-08  9.42e-06    25s
  53   6.73011047e+04  6.73029291e+04  1.57e-07 1.63e-08  5.05e-06    25s
  54   6.73019031e+04  6.73024618e+04  2.33e-08 7.35e-09  1.55e-06    25s
  55   6.73020248e+04  6.73020688e+04  1.01e-08 6.87e-09  1.22e-07    25s
  56   6.73020630e+04  6.73020650e+04  2.91e-09 4.64e-10  5.70e-09    26s
  57   6.73020649e+04  6.73020649e+04  5.78e-07 6.44e-07  1.77e-10    26s

Barrier solved model in 57 iterations and 25.95 seconds (22.00 work units)
Optimal objective 6.73020649e+04


Root crossover log...

  178017 DPushes remaining with DInf 0.0000000e+00                26s
   23882 DPushes remaining with DInf 0.0000000e+00                30s
       0 DPushes remaining with DInf 0.0000000e+00                33s

    4865 PPushes remaining with PInf 4.5588185e-05                33s
       0 PPushes remaining with PInf 0.0000000e+00                33s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.2488055e+00     33s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   81799    6.7302065e+04   0.000000e+00   3.248806e+00     33s
   81816    6.7302065e+04   0.000000e+00   0.000000e+00     34s
   81816    6.7302065e+04   0.000000e+00   0.000000e+00     34s
Concurrent spin time: 1.22s

Solved with barrier

Root relaxation: objective 6.730206e+04, 81816 iterations, 25.99 seconds (26.44 work units)
Total elapsed time = 35.53s (DegenMoves)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 67302.0649    0  153 -180138.75 67302.0649   137%     -   36s
H    0     0                    -169222.3666 67302.0649   140%     -   37s
H    0     0                    -166729.6212 67302.0649   140%     -   38s
H    0     0                    -166729.2302 67302.0649   140%     -   39s
H    0     0                    -61879.27678 67302.0649   209%     -   39s
H    0     0                    17190.947012 67302.0649   291%     -   40s
H    0     0                    18748.229179 67302.0649   259%     -   40s
H    0     0                    19392.694582 67302.0649   247%     -   40s
H    0     0                    20950.697574 67302.0649   221%     -   41s
H    0     0                    21032.397489 67302.0649   220%     -   41s
H    0     0                    21076.652127 67302.0649   219%     -   41s
H    0     0                    21077.767637 67302.0649   219%     -   41s
H    0     0                    21104.852418 67302.0649   219%     -   41s
H    0     0                    21106.390454 67302.0649   219%     -   41s
     0     0 61822.0810    0  174 21106.3905 61822.0810   193%     -  204s
H    0     0                    21276.011043 61821.8701   191%     -  206s
     0     0 61555.1958    0  222 21276.0110 61555.1958   189%     -  250s
     0     0 61091.5943    0  216 21276.0110 61091.5943   187%     -  291s
     0     0 61040.8400    0  219 21276.0110 61040.8400   187%     -  305s
     0     0 60986.3392    0  225 21276.0110 60986.3392   187%     -  310s
     0     0 60979.4678    0  225 21276.0110 60979.4678   187%     -  316s
     0     0 60978.7967    0  224 21276.0110 60978.7967   187%     -  323s
     0     0 60966.2306    0  224 21276.0110 60966.2306   187%     -  326s
     0     0 60787.8865    0  216 21276.0110 60787.8865   186%     -  364s
     0     0 60787.6220    0  219 21276.0110 60787.6220   186%     -  367s
     0     0 57980.7048    0  245 21276.0110 57980.7048   173%     -  521s
     0     0 57980.7048    0  245 21276.0110 57980.7048   173%     -  521s
H    0     0                    23882.892325 57980.4840   143%     -  523s
H    0     0                    24249.164504 57980.4840   139%     -  523s
H    0     0                    24423.062460 57980.4840   137%     -  523s
     0     0 57608.7124    0  270 24423.0625 57608.7124   136%     -  609s
     0     0 57348.4319    0  293 24423.0625 57348.4319   135%     -  662s
     0     0 57230.4548    0  319 24423.0625 57230.4548   134%     -  702s
     0     0 57199.4190    0  308 24423.0625 57199.4190   134%     -  729s
     0     0 57130.7886    0  310 24423.0625 57130.7886   134%     -  758s
     0     0 57082.6594    0  285 24423.0625 57082.6594   134%     -  789s
     0     0 57064.2796    0  297 24423.0625 57064.2796   134%     -  813s
     0     0 56924.6232    0  289 24423.0625 56924.6232   133%     -  845s
     0     0 56899.3486    0  292 24423.0625 56899.3486   133%     -  871s
     0     0 56896.9521    0  290 24423.0625 56896.9521   133%     -  882s
     0     0 56830.0493    0  301 24423.0625 56830.0493   133%     -  919s
     0     0 56828.0341    0  301 24423.0625 56828.0341   133%     -  924s
     0     0 56806.8452    0  281 24423.0625 56806.8452   133%     -  936s
     0     0 56804.6872    0  284 24423.0625 56804.6872   133%     -  942s
     0     0 56803.2794    0  290 24423.0625 56803.2794   133%     -  947s
     0     0 56467.9331    0  297 24423.0625 56467.9331   131%     -  999s
     0     0 56402.9666    0  311 24423.0625 56402.9666   131%     - 1023s
     0     0 56387.6421    0  311 24423.0625 56387.6421   131%     - 1035s
     0     0 56386.0256    0  313 24423.0625 56386.0256   131%     - 1039s
     0     0 56385.7190    0  311 24423.0625 56385.7190   131%     - 1040s
     0     0 54059.4131    0  327 24423.0625 54059.4131   121%     - 1222s
H    0     0                    24521.974315 54059.3619   120%     - 1225s
H    0     0                    24548.168293 54059.3619   120%     - 1225s
H    0     0                    24593.135229 54059.3619   120%     - 1225s
     0     0 53764.9236    0  317 24593.1352 53764.9236   119%     - 1288s
     0     0 53545.1310    0  346 24593.1352 53545.1310   118%     - 1354s
     0     0 53482.6288    0  336 24593.1352 53482.6288   117%     - 1379s
     0     0 53425.6910    0  350 24593.1352 53425.6910   117%     - 1418s
     0     0 53398.3888    0  339 24593.1352 53398.3888   117%     - 1443s
     0     0 53388.6984    0  343 24593.1352 53388.6984   117%     - 1458s
     0     0 53385.1861    0  349 24593.1352 53385.1861   117%     - 1465s
     0     0 53342.8986    0  332 24593.1352 53342.8986   117%     - 1485s
     0     0 53332.4471    0  344 24593.1352 53332.4471   117%     - 1498s
     0     0 53325.8274    0  347 24593.1352 53325.8274   117%     - 1513s
     0     0 53324.1913    0  351 24593.1352 53324.1913   117%     - 1522s
     0     0 52320.9009    0  349 24593.1352 52320.9009   113%     - 1681s
     0     0 52042.0212    0  370 24593.1352 52042.0212   112%     - 1747s
     0     0 51907.5504    0  374 24593.1352 51907.5504   111%     - 1794s
     0     0 51860.3014    0  373 24593.1352 51860.3014   111%     - 1813s
     0     0 51819.9905    0  380 24593.1352 51819.9905   111%     - 1831s
     0     0 51808.1357    0  379 24593.1352 51808.1357   111%     - 1841s
     0     0 51751.0478    0  362 24593.1352 51751.0478   110%     - 1861s
     0     0 51702.3511    0  384 24593.1352 51702.3511   110%     - 1876s
     0     0 51643.5417    0  369 24593.1352 51643.5417   110%     - 1915s
     0     0 51614.0246    0  371 24593.1352 51614.0246   110%     - 1930s
     0     0 51608.7831    0  375 24593.1352 51608.7831   110%     - 1943s
     0     0 51598.1864    0  367 24593.1352 51598.1864   110%     - 1954s
     0     0 51593.3431    0  378 24593.1352 51593.3431   110%     - 1963s
     0     0 51584.3246    0  377 24593.1352 51584.3246   110%     - 1967s
     0     0 51583.7428    0  379 24593.1352 51583.7428   110%     - 1970s
     0     0 51358.5640    0  376 24593.1352 51358.5640   109%     - 2047s
     0     0 51312.1772    0  377 24593.1352 51312.1772   109%     - 2081s
     0     0 51295.1966    0  380 24593.1352 51295.1966   109%     - 2106s
     0     0 51276.9635    0  383 24593.1352 51276.9635   109%     - 2141s
     0     0 51262.0354    0  382 24593.1352 51262.0354   108%     - 2165s
     0     0 51247.9714    0  386 24593.1352 51247.9714   108%     - 2183s
     0     0 51214.1340    0  385 24593.1352 51214.1340   108%     - 2227s
     0     0 51205.3150    0  401 24593.1352 51205.3150   108%     - 2237s
     0     0 51189.4608    0  402 24593.1352 51189.4608   108%     - 2249s
     0     0 51175.3289    0  398 24593.1352 51175.3289   108%     - 2258s
     0     0 51163.8788    0  404 24593.1352 51163.8788   108%     - 2267s
     0     0 51157.2181    0  405 24593.1352 51157.2181   108%     - 2272s
     0     0 51154.4327    0  396 24593.1352 51154.4327   108%     - 2279s
     0     0 51150.5009    0  395 24593.1352 51150.5009   108%     - 2284s
     0     0 51139.2755    0  395 24593.1352 51139.2755   108%     - 2296s
     0     0 51136.1878    0  401 24593.1352 51136.1878   108%     - 2304s
     0     0 51129.9143    0  396 24593.1352 51129.9143   108%     - 2310s
     0     0 51128.9701    0  396 24593.1352 51128.9701   108%     - 2313s
     0     0 50978.3995    0  383 24593.1352 50978.3995   107%     - 2353s
H    0     0                    25924.844121 50978.0543  96.6%     - 2368s
     0     0 50909.6212    0  385 25924.8441 50909.6212  96.4%     - 2385s
     0     0 50890.0156    0  387 25924.8441 50890.0156  96.3%     - 2397s
     0     0 50879.1967    0  391 25924.8441 50879.1967  96.3%     - 2413s
     0     0 50871.1546    0  396 25924.8441 50871.1546  96.2%     - 2423s
     0     0 50863.0624    0  386 25924.8441 50863.0624  96.2%     - 2430s
     0     0 50861.2254    0  393 25924.8441 50861.2254  96.2%     - 2437s
     0     0 50805.7019    0  385 25924.8441 50805.7019  96.0%     - 2467s
H    0     0                    27250.095861 50805.6180  86.4%     - 2470s
H    0     0                    28442.052381 50805.6180  78.6%     - 2470s
     0     0 50768.5049    0  432 28442.0524 50768.5049  78.5%     - 2494s
     0     0 50759.6276    0  428 28442.0524 50759.6276  78.5%     - 2505s
     0     0 50755.2849    0  392 28442.0524 50755.2849  78.5%     - 2510s
     0     0 50752.3299    0  438 28442.0524 50752.3299  78.4%     - 2518s
     0     0 50751.6789    0  471 28442.0524 50751.6789  78.4%     - 2521s
     0     0 50727.1331    0  384 28442.0524 50727.1331  78.4%     - 2548s
     0     0 50722.6723    0  382 28442.0524 50722.6723  78.3%     - 2559s
     0     0 50718.8760    0  383 28442.0524 50718.8760  78.3%     - 2562s
     0     0 50713.3991    0  382 28442.0524 50713.3991  78.3%     - 2564s
     0     0 50713.2303    0  379 28442.0524 50713.2303  78.3%     - 2565s
     0     0 50696.2397    0  377 28442.0524 50696.2397  78.2%     - 2578s
     0     0 50694.1610    0  379 28442.0524 50694.1610  78.2%     - 2585s
     0     0 50678.5624    0  381 28442.0524 50678.5624  78.2%     - 2597s
H    0     0                    28734.881530 50678.5267  76.4%     - 2638s
H    0     0                    29248.099064 50678.5267  73.3%     - 2638s
H    0     0                    29418.067123 50678.5267  72.3%     - 2641s
H    0     0                    29422.770316 50678.5267  72.2%     - 2641s
     0     0 50641.9818    0  413 29422.7703 50641.9818  72.1%     - 2661s
     0     0 50637.0140    0  423 29422.7703 50637.0140  72.1%     - 2667s
     0     0 50635.3852    0  421 29422.7703 50635.3852  72.1%     - 2669s
     0     0 50619.9951    0  392 29422.7703 50619.9951  72.0%     - 2682s
     0     0 50616.1996    0  392 29422.7703 50616.1996  72.0%     - 2689s
     0     0 50616.0388    0  388 29422.7703 50616.0388  72.0%     - 2691s
     0     0 50597.9065    0  397 29422.7703 50597.9065  72.0%     - 2703s
H    0     0                    29713.645816 50597.5010  70.3%     - 2753s
H    0     0                    29960.218053 50597.5010  68.9%     - 2753s
H    0     0                    30061.905306 50597.5010  68.3%     - 2759s
     0     0 50593.1698    0  395 30061.9053 50593.1698  68.3%     - 2765s
     0     0 50591.9430    0  390 30061.9053 50591.9430  68.3%     - 2770s
     0     0 50574.0129    0  387 30061.9053 50574.0129  68.2%     - 2786s
     0     0 50572.2395    0  392 30061.9053 50572.2395  68.2%     - 2790s
     0     0 50543.5610    0  380 30061.9053 50543.5610  68.1%     - 2811s
     0     0 50526.3906    0  387 30061.9053 50526.3906  68.1%     - 2824s
     0     0 50521.1254    0  389 30061.9053 50521.1254  68.1%     - 2829s
     0     0 50518.6417    0  400 30061.9053 50518.6417  68.0%     - 2832s
     0     0 50516.9031    0  395 30061.9053 50516.9031  68.0%     - 2834s
     0     0 50507.2122    0  387 30061.9053 50507.2122  68.0%     - 2846s
     0     0 50506.0507    0  387 30061.9053 50506.0507  68.0%     - 2851s
     0     0 50502.8880    0  384 30061.9053 50502.8880  68.0%     - 2860s
     0     0 50502.0026    0  386 30061.9053 50502.0026  68.0%     - 2862s
     0     0 50501.4848    0  391 30061.9053 50501.4848  68.0%     - 2867s
     0     0 50498.0917    0  396 30061.9053 50498.0917  68.0%     - 2872s
     0     0 50497.1945    0  395 30061.9053 50497.1945  68.0%     - 2875s
     0     0 50496.5965    0  394 30061.9053 50496.5965  68.0%     - 2879s
     0     0 50496.2354    0  394 30061.9053 50496.2354  68.0%     - 2889s
H    0     0                    30300.287704 50495.9329  66.7%     - 3278s
H    0     0                    30402.272540 50495.9329  66.1%     - 3288s
     0     2 50495.9329    0  394 30402.2725 50495.9329  66.1%     - 3291s
     1     3 50078.0053    1  369 30402.2725 50495.6109  66.1% 13761 3321s
     2     4 50411.5162    1  381 30402.2725 50411.5162  65.8% 11382 3339s
     3     5 49098.2371    2  351 30402.2725 50410.6201  65.8% 14901 3389s
     4     8 50121.3444    2  370 30402.2725 50410.5094  65.8% 14335 3429s
     7    13 49923.5471    3  364 30402.2725 50214.1254  65.2% 13121 3494s
    12    26 48537.8928    4  361 30402.2725 50214.1254  65.2% 16712 3561s

Cutting planes:
  Gomory: 7
  Implied bound: 316
  MIR: 3748
  Flow cover: 3274
  RLT: 68
  Relax-and-lift: 484

Explored 25 nodes (1572906 simplex iterations) in 3600.14 seconds (4138.73 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 30402.3 30300.3 30061.9 ... 28442.1

Time limit reached
Best objective 3.040227254016e+04, best bound 4.990571536324e+04, gap 64.1513%
  WARNING: Time limit reached. Using best solution found (gap: 64.15%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.17s
  Master Objective (UB) = 30402.27, θ = 181731.32
  Upper Bound (UB) = 30402.27

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 181731.32
  [DEBUG]   ✓ Scenario 0: θ = 181731.32 ≤ Q = 181731.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 181731.32 ≤ Q = 181731.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 181731.32 ≤ Q = 181731.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 181731.32 ≤ Q = 181731.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 181731.32 ≤ Q = 181731.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 181731.32 ≤ Q = 181731.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 181731.32 ≤ Q = 181731.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 181731.32 ≤ Q = 181731.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 181731.32 ≤ Q = 181731.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 181731.32 ≤ Q = 181731.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 181731.32 ≤ Q = 181731.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 181731.32 ≤ Q = 181731.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 181731.32 ≤ Q = 181731.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 181731.32 ≤ Q = 181731.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 181731.32 ≤ Q = 181731.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 181731.32 ≤ Q = 181731.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 181731.32 ≤ Q = 181731.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 181731.32 ≤ Q = 181731.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 181731.32 ≤ Q = 181731.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 181731.32 ≤ Q = 181731.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 20: θ = 181731.32 ≤ Q = 181731.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 21: θ = 181731.32 ≤ Q = 181731.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 22: θ = 181731.32 ≤ Q = 181731.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 23: θ = 181731.32 ≤ Q = 181731.32 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 24] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x7b3ae213
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x7b3ae213
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.415354e+13
Presolve removed 2605 rows and 1896 columns
Presolve time: 0.01s
Presolved: 488 rows, 493 columns, 1377 nonzeros
Found heuristic solution: objective 6722672.2445
Variable types: 334 continuous, 159 integer (159 binary)

Root relaxation: objective -1.589428e+05, 234 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -158942.80    0  121 6722672.24 -158942.80   102%     -    0s
H    0     0                    -113418.0117 -158942.80  40.1%     -    0s
H    0     0                    -114295.1717 -158942.80  39.1%     -    0s
H    0     0                    -114589.7487 -158865.63  38.6%     -    0s
H    0     0                    -125331.5444 -135578.05  8.18%     -    0s
     0     0 -135578.05    0   89 -125331.54 -135578.05  8.18%     -    0s
H    0     0                    -128519.2773 -135416.80  5.37%     -    0s
     0     0 -134017.89    0   86 -128519.28 -134017.89  4.28%     -    0s
H    0     0                    -132734.2405 -134012.11  0.96%     -    0s
     0     0 -133338.87    0   33 -132734.24 -133338.87  0.46%     -    0s
     0     0 -133272.99    0   44 -132734.24 -133272.99  0.41%     -    0s
     0     0 -132942.33    0   16 -132734.24 -132942.33  0.16%     -    0s
     0     0 -132934.04    0   14 -132734.24 -132934.04  0.15%     -    0s
     0     0 -132856.40    0   14 -132734.24 -132856.40  0.09%     -    0s
     0     0 -132849.43    0   13 -132734.24 -132849.43  0.09%     -    0s
     0     0 -132835.70    0   13 -132734.24 -132835.70  0.08%     -    0s
     0     0 -132832.13    0   13 -132734.24 -132832.13  0.07%     -    0s
     0     0 -132831.14    0   13 -132734.24 -132831.14  0.07%     -    0s
     0     0 -132830.87    0   13 -132734.24 -132830.87  0.07%     -    0s
     0     0 -132776.66    0   10 -132734.24 -132776.66  0.03%     -    0s
     0     0 -132766.02    0    7 -132734.24 -132766.02  0.02%     -    0s
     0     0 -132765.75    0    5 -132734.24 -132765.75  0.02%     -    0s
     0     0 -132735.48    0    4 -132734.24 -132735.48  0.00%     -    0s
     0     0 -132734.93    0    1 -132734.24 -132734.93  0.00%     -    0s
H    0     0                    -132734.4661 -132734.93  0.00%     -    0s
     0     0     cutoff    0      -132734.47 -132734.47  0.00%     -    0s

Explored 1 nodes (685 simplex iterations) in 0.09 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -132734 -132734 -131179 ... 6.72267e+06
No other solutions better than -132734

Optimal solution found (tolerance 1.00e-06)
Best objective -1.327344660860e+05, best bound -1.327344660860e+05, gap 0.0000%
  Subproblem solved in 0.12s
  Worst-case operational profit (Z_SP) = 176136.19
  Scenario: 27 demand increases, 33 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -132734.47
  [DEBUG]   S×d_nominal = 308870.66
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 308870.66 + -132734.47 = 176136.19
  [DEBUG]   Current θ from Master = 181731.32
  [DEBUG]   ⚠️  Z_SP ≤ θ by 5595.13 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 24807.15
  Lower Bound (LB) = 29447.80
  Gap (UB-LB) = 954.4716, Absolute Gap = 954.4716, Relative Gap = 0.031395
  Not converged yet (gap = 954.47 > ε = 200)

  [DEBUG] Adding NEW scenario 24 to Master Problem...
  [DEBUG] New scenario pattern: 27 increases, 33 decreases
    [DEBUG] Scenario 24 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 24 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 24]
    [DEBUG]   - Total constraints in model: 383633
    [DEBUG]   - Total variables in model: 158260
  [DEBUG] Total scenarios in Master: 25
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 25
================================================================================
[Iteration 25] Solving Master Problem...
  Current scenarios in Master: 25
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 383633 rows, 158260 columns and 1086294 nonzeros
Model fingerprint: 0xfa5f4d45
Variable types: 156001 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 176750 rows and 71750 columns (presolve time = 5s)...
Presolve removed 176750 rows and 71750 columns
Presolve time: 7.40s
Presolved: 206883 rows, 86510 columns, 1274470 nonzeros
Variable types: 84251 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -335473.7764
Found heuristic solution: objective -180138.7472

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 2.70s

Barrier statistics:
 Dense cols : 1147
 AA' NZ     : 5.863e+06
 Factor NZ  : 1.640e+07 (roughly 250 MB of memory)
 Factor Ops : 6.161e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.18235458e+07  3.61986594e+08  1.62e+05 1.23e+01  1.00e+05    13s
   1  -1.70901555e+07  3.43087535e+08  1.15e+05 7.99e+01  7.05e+04    13s
   2  -7.64356759e+06  2.59999391e+08  4.99e+04 4.94e+00  3.27e+04    13s
   3  -1.12524122e+06  2.15772892e+08  3.03e+03 4.44e+00  2.50e+03    14s
   4  -6.92671057e+05  1.33614528e+08  6.33e+02 1.86e+00  7.27e+02    14s
   5  -5.98433248e+05  8.22805430e+07  3.89e+02 9.82e-01  4.25e+02    14s
   6  -4.58623188e+05  6.60114085e+07  1.39e+02 7.51e-01  2.47e+02    14s
   7  -4.30129964e+05  4.58404823e+07  7.80e+01 4.90e-01  1.58e+02    15s
   8  -3.90396993e+05  3.35805957e+07  2.47e+01 3.45e-01  9.97e+01    15s
   9  -3.15383121e+05  2.53754871e+07  5.44e+00 2.55e-01  7.00e+01    15s
  10  -2.30065528e+05  1.29122268e+07  1.34e+00 1.27e-01  3.51e+01    15s
  11  -1.62427879e+05  4.94241024e+06  5.10e-01 4.61e-02  1.36e+01    15s
  12  -1.30233730e+05  2.39846104e+06  3.86e-01 2.28e-02  6.73e+00    16s
  13  -9.20398275e+04  1.96961151e+06  2.47e-01 1.85e-02  5.48e+00    16s
  14  -6.48932146e+04  1.29432095e+06  1.62e-01 1.25e-02  3.61e+00    16s
  15  -2.06514392e+04  5.77092184e+05  5.24e-02 5.06e-03  1.59e+00    16s
  16   5.22041629e+03  2.76575162e+05  2.86e-02 2.36e-03  7.21e-01    16s
  17   1.96167783e+04  2.16731067e+05  2.05e-02 1.70e-03  5.24e-01    17s
  18   2.82728243e+04  1.74216255e+05  1.58e-02 1.23e-03  3.88e-01    17s
  19   3.61763315e+04  1.40646344e+05  1.16e-02 8.87e-04  2.78e-01    17s
  20   4.15162487e+04  1.19809198e+05  8.98e-03 6.54e-04  2.08e-01    18s
  21   4.62493730e+04  1.09479911e+05  6.93e-03 5.30e-04  1.68e-01    18s
  22   4.88346060e+04  1.01305692e+05  5.85e-03 4.41e-04  1.39e-01    18s
  23   5.12494597e+04  9.44626525e+04  4.89e-03 3.57e-04  1.15e-01    19s
  24   5.52822281e+04  8.91038505e+04  3.35e-03 2.89e-04  8.99e-02    19s
  25   5.76136916e+04  8.33150777e+04  2.56e-03 2.16e-04  6.83e-02    19s
  26   5.90187407e+04  7.90127001e+04  2.12e-03 1.67e-04  5.31e-02    19s
  27   6.06404641e+04  7.64299319e+04  1.65e-03 1.31e-04  4.20e-02    20s
  28   6.27541515e+04  7.45798591e+04  1.06e-03 1.08e-04  3.14e-02    20s
  29   6.37948219e+04  7.30677696e+04  7.96e-04 8.54e-05  2.46e-02    20s
  30   6.41819172e+04  7.09926718e+04  6.96e-04 6.14e-05  1.81e-02    21s
  31   6.51012795e+04  7.02091380e+04  4.77e-04 4.90e-05  1.36e-02    21s
  32   6.57208957e+04  6.93800812e+04  3.32e-04 3.50e-05  9.72e-03    21s
  33   6.64917911e+04  6.87921552e+04  1.58e-04 2.50e-05  6.11e-03    21s
  34   6.68607995e+04  6.79654928e+04  8.18e-05 1.09e-05  2.94e-03    22s
  35   6.68803287e+04  6.78815811e+04  7.79e-05 9.54e-06  2.66e-03    22s
  36   6.70485959e+04  6.77070668e+04  4.53e-05 6.66e-06  1.75e-03    22s
  37   6.71106085e+04  6.75365856e+04  3.34e-05 3.80e-06  1.13e-03    22s
  38   6.71880666e+04  6.74679879e+04  1.92e-05 2.66e-06  7.44e-04    23s
  39   6.72157389e+04  6.74321694e+04  1.39e-05 2.07e-06  5.75e-04    23s
  40   6.72265221e+04  6.73922366e+04  1.20e-05 1.43e-06  4.40e-04    23s
  41   6.72406877e+04  6.73630336e+04  9.65e-06 9.42e-07  3.25e-04    24s
  42   6.72635234e+04  6.73440844e+04  5.90e-06 6.44e-07  2.14e-04    24s
  43   6.72753617e+04  6.73404963e+04  4.08e-06 5.93e-07  1.73e-04    24s
  44   6.72828848e+04  6.73274604e+04  2.84e-06 3.90e-07  1.18e-04    25s
  45   6.72903207e+04  6.73201527e+04  1.73e-06 2.75e-07  7.93e-05    25s
  46   6.72952589e+04  6.73112192e+04  9.61e-07 1.69e-07  4.24e-05    25s
  47   6.72987976e+04  6.73064870e+04  4.27e-07 7.52e-08  2.04e-05    26s
  48   6.73008949e+04  6.73052195e+04  1.22e-07 5.23e-08  1.15e-05    26s
  49   6.73014626e+04  6.73037873e+04  6.11e-08 2.70e-08  6.18e-06    26s
  50   6.73019723e+04  6.73021419e+04  3.01e-08 2.74e-09  4.51e-07    27s
  51   6.73020542e+04  6.73020988e+04  5.97e-08 1.30e-09  1.19e-07    27s
  52   6.73020646e+04  6.73020652e+04  1.98e-09 3.14e-09  1.45e-09    27s

Barrier solved model in 52 iterations and 27.48 seconds (23.03 work units)
Optimal objective 6.73020646e+04


Root crossover log...

  185810 DPushes remaining with DInf 0.0000000e+00                28s
   49509 DPushes remaining with DInf 0.0000000e+00                30s
       0 DPushes remaining with DInf 0.0000000e+00                34s

   19313 PPushes remaining with PInf 1.0467487e-04                34s
    5941 PPushes remaining with PInf 6.4525890e-05                36s
       0 PPushes remaining with PInf 0.0000000e+00                36s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.3758317e+03     36s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
  109625    6.7302065e+04   0.000000e+00   2.375832e+03     36s
  109766    6.7302065e+04   0.000000e+00   0.000000e+00     37s
  109766    6.7302065e+04   0.000000e+00   0.000000e+00     37s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 6.730206e+04, 109766 iterations, 27.96 seconds (26.95 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 67302.0649    0  153 -180138.75 67302.0649   137%     -   38s
H    0     0                    -168366.6464 67302.0649   140%     -   39s
H    0     0                    -156657.3920 67302.0649   143%     -   39s
H    0     0                    -156096.1175 67302.0649   143%     -   40s
H    0     0                    -61879.27678 67302.0649   209%     -   40s
H    0     0                    19087.963209 67302.0649   253%     -   41s
H    0     0                    20773.687069 67302.0649   224%     -   41s
H    0     0                    21076.652127 67302.0649   219%     -   43s
H    0     0                    21104.852418 67302.0649   219%     -   43s
H    0     0                    21106.390454 67302.0649   219%     -   43s
     0     0 61870.0929    0  168 21106.3905 61870.0929   193%     -  175s
H    0     0                    21276.011043 61869.5850   191%     -  177s
     0     0 61612.2144    0  217 21276.0110 61612.2144   190%     -  217s
     0     0 61556.7654    0  221 21276.0110 61556.7654   189%     -  242s
     0     0 61536.6432    0  219 21276.0110 61536.6432   189%     -  247s
     0     0 61463.2256    0  226 21276.0110 61463.2256   189%     -  258s
     0     0 61460.5322    0  225 21276.0110 61460.5322   189%     -  264s
     0     0 61051.2937    0  219 21276.0110 61051.2937   187%     -  321s
     0     0 61018.1899    0  217 21276.0110 61018.1899   187%     -  332s
     0     0 61014.8564    0  216 21276.0110 61014.8564   187%     -  335s
     0     0 61011.5295    0  218 21276.0110 61011.5295   187%     -  338s
     0     0 61011.2113    0  220 21276.0110 61011.2113   187%     -  340s
     0     0 57740.1011    0  299 21276.0110 57740.1011   171%     -  476s
     0     0 57740.1011    0  299 21276.0110 57740.1011   171%     -  476s
H    0     0                    27091.006378 57740.0521   113%     -  477s
H    0     0                    27251.527884 57740.0521   112%     -  478s
H    0     0                    27269.405678 57740.0521   112%     -  479s
     0     0 57389.2028    0  287 27269.4057 57389.2028   110%     -  531s
     0     0 57324.0616    0  298 27269.4057 57324.0616   110%     -  566s
     0     0 57242.1302    0  307 27269.4057 57242.1302   110%     -  593s
     0     0 57236.3936    0  306 27269.4057 57236.3936   110%     -  600s
     0     0 57191.1068    0  291 27269.4057 57191.1068   110%     -  617s
     0     0 57129.4883    0  306 27269.4057 57129.4883   110%     -  639s
     0     0 57101.5950    0  312 27269.4057 57101.5950   109%     -  658s
     0     0 56894.8835    0  292 27269.4057 56894.8835   109%     -  703s
     0     0 56839.0377    0  306 27269.4057 56839.0377   108%     -  737s
     0     0 56832.7838    0  311 27269.4057 56832.7838   108%     -  741s
     0     0 56830.3356    0  311 27269.4057 56830.3356   108%     -  743s
     0     0 56827.9715    0  311 27269.4057 56827.9715   108%     -  745s
     0     0 56811.4534    0  307 27269.4057 56811.4534   108%     -  752s
     0     0 56800.2462    0  313 27269.4057 56800.2462   108%     -  760s
     0     0 56782.1016    0  317 27269.4057 56782.1016   108%     -  772s
     0     0 56776.7277    0  307 27269.4057 56776.7277   108%     -  778s
     0     0 56731.4407    0  312 27269.4057 56731.4407   108%     -  795s
     0     0 56728.5240    0  310 27269.4057 56728.5240   108%     -  799s
     0     0 56728.3501    0  313 27269.4057 56728.3501   108%     -  801s
     0     0 54252.4983    0  305 27269.4057 54252.4983  99.0%     -  988s
     0     0 53727.4718    0  334 27269.4057 53727.4718  97.0%     - 1090s
     0     0 53451.1858    0  347 27269.4057 53451.1858  96.0%     - 1164s
     0     0 53415.3679    0  351 27269.4057 53415.3679  95.9%     - 1189s
     0     0 53350.4952    0  346 27269.4057 53350.4952  95.6%     - 1233s
     0     0 53296.8050    0  349 27269.4057 53296.8050  95.4%     - 1261s
     0     0 53252.2686    0  354 27269.4057 53252.2686  95.3%     - 1287s
     0     0 53229.1945    0  361 27269.4057 53229.1945  95.2%     - 1300s
     0     0 53205.4992    0  357 27269.4057 53205.4992  95.1%     - 1320s
     0     0 53057.8639    0  352 27269.4057 53057.8639  94.6%     - 1356s
     0     0 52968.4521    0  348 27269.4057 52968.4521  94.2%     - 1383s
     0     0 52961.0682    0  351 27269.4057 52961.0682  94.2%     - 1393s
     0     0 52957.2163    0  352 27269.4057 52957.2163  94.2%     - 1400s
     0     0 52954.7729    0  348 27269.4057 52954.7729  94.2%     - 1403s
     0     0 52952.6391    0  348 27269.4057 52952.6391  94.2%     - 1410s
     0     0 52924.8751    0  359 27269.4057 52924.8751  94.1%     - 1421s
     0     0 52921.3263    0  361 27269.4057 52921.3263  94.1%     - 1430s
     0     0 52915.1789    0  367 27269.4057 52915.1789  94.0%     - 1443s
     0     0 52899.2830    0  362 27269.4057 52899.2830  94.0%     - 1459s
     0     0 52895.8342    0  364 27269.4057 52895.8342  94.0%     - 1465s
     0     0 52879.8081    0  366 27269.4057 52879.8081  93.9%     - 1477s
     0     0 52856.8744    0  364 27269.4057 52856.8744  93.8%     - 1487s
     0     0 52855.4239    0  374 27269.4057 52855.4239  93.8%     - 1492s
     0     0 52036.0471    0  373 27269.4057 52036.0471  90.8%     - 1597s
H    0     0                    27270.000045 52035.0907  90.8%     - 1599s
H    0     0                    27975.715956 52035.0907  86.0%     - 1599s
H    0     0                    28150.907513 52035.0907  84.8%     - 1600s
H    0     0                    28164.532560 52035.0907  84.8%     - 1601s
H    0     0                    28175.526488 52035.0907  84.7%     - 1601s
     0     0 51928.9162    0  376 28175.5265 51928.9162  84.3%     - 1641s
     0     0 51871.7512    0  367 28175.5265 51871.7512  84.1%     - 1664s
     0     0 51823.2458    0  370 28175.5265 51823.2458  83.9%     - 1690s
     0     0 51801.5257    0  378 28175.5265 51801.5257  83.9%     - 1700s
     0     0 51793.5517    0  367 28175.5265 51793.5517  83.8%     - 1706s
     0     0 51788.4148    0  366 28175.5265 51788.4148  83.8%     - 1710s
     0     0 51732.1230    0  373 28175.5265 51732.1230  83.6%     - 1726s
     0     0 51724.2737    0  377 28175.5265 51724.2737  83.6%     - 1731s
     0     0 51710.1436    0  376 28175.5265 51710.1436  83.5%     - 1737s
     0     0 51709.4085    0  377 28175.5265 51709.4085  83.5%     - 1739s
     0     0 51386.2321    0  427 28175.5265 51386.2321  82.4%     - 1800s
     0     0 51332.2152    0  438 28175.5265 51332.2152  82.2%     - 1833s
     0     0 51238.4328    0  415 28175.5265 51238.4328  81.9%     - 1861s
     0     0 51226.8202    0  426 28175.5265 51226.8202  81.8%     - 1875s
     0     0 51187.9915    0  432 28175.5265 51187.9915  81.7%     - 1899s
     0     0 51160.9651    0  432 28175.5265 51160.9651  81.6%     - 1923s
     0     0 51134.5218    0  433 28175.5265 51134.5218  81.5%     - 1941s
     0     0 51120.9289    0  437 28175.5265 51120.9289  81.4%     - 1955s
     0     0 51117.8077    0  437 28175.5265 51117.8077  81.4%     - 1969s
     0     0 51110.2481    0  439 28175.5265 51110.2481  81.4%     - 1975s
     0     0 51109.3833    0  439 28175.5265 51109.3833  81.4%     - 1978s
     0     0 50952.9461    0  377 28175.5265 50952.9461  80.8%     - 2018s
H    0     0                    28222.975591 50952.1105  80.5%     - 2031s
H    0     0                    28289.596542 50952.1105  80.1%     - 2031s
H    0     0                    28467.587343 50952.1105  79.0%     - 2031s
     0     0 50885.2594    0  430 28467.5873 50885.2594  78.7%     - 2073s
     0     0 50859.2736    0  398 28467.5873 50859.2736  78.7%     - 2097s
     0     0 50855.4071    0  396 28467.5873 50855.4071  78.6%     - 2105s
     0     0 50848.0000    0  432 28467.5873 50848.0000  78.6%     - 2119s
     0     0 50844.9427    0  430 28467.5873 50844.9427  78.6%     - 2135s
     0     0 50837.4020    0  430 28467.5873 50837.4020  78.6%     - 2144s
     0     0 50835.2824    0  391 28467.5873 50835.2824  78.6%     - 2154s
     0     0 50778.2382    0  387 28467.5873 50778.2382  78.4%     - 2191s
     0     0 50724.5948    0  439 28467.5873 50724.5948  78.2%     - 2228s
     0     0 50712.9409    0  399 28467.5873 50712.9409  78.1%     - 2240s
     0     0 50710.3762    0  401 28467.5873 50710.3762  78.1%     - 2246s
     0     0 50708.5062    0  401 28467.5873 50708.5062  78.1%     - 2251s
     0     0 50652.4070    0  434 28467.5873 50652.4070  77.9%     - 2296s
H    0     0                    28545.876459 50652.1626  77.4%     - 2299s
H    0     0                    28609.673981 50652.1626  77.0%     - 2299s
     0     0 50635.5545    0  433 28609.6740 50635.5545  77.0%     - 2321s
     0     0 50621.0059    0  436 28609.6740 50621.0059  76.9%     - 2338s
     0     0 50613.3463    0  443 28609.6740 50613.3463  76.9%     - 2348s
     0     0 50611.9212    0  445 28609.6740 50611.9212  76.9%     - 2353s
     0     0 50555.5096    0  436 28609.6740 50555.5096  76.7%     - 2383s
     0     0 50546.2737    0  447 28609.6740 50546.2737  76.7%     - 2401s
     0     0 50530.4605    0  396 28609.6740 50530.4605  76.6%     - 2413s
     0     0 50525.1442    0  395 28609.6740 50525.1442  76.6%     - 2422s
     0     0 50524.5489    0  400 28609.6740 50524.5489  76.6%     - 2425s
     0     0 50515.8235    0  394 28609.6740 50515.8235  76.6%     - 2439s
H    0     0                    28822.712807 50512.9548  75.3%     - 2442s
H    0     0                    28903.583687 50512.9548  74.8%     - 2443s
     0     0 50512.9548    0  396 28903.5837 50512.9548  74.8%     - 2448s
     0     0 50506.5439    0  386 28903.5837 50506.5439  74.7%     - 2461s
H    0     0                    29015.293877 50506.0013  74.1%     - 2464s
     0     0 50504.3666    0  389 29015.2939 50504.3666  74.1%     - 2469s
     0     0 50495.7463    0  391 29015.2939 50495.7463  74.0%     - 2486s
H    0     0                    29297.233111 50495.6771  72.4%     - 2518s
H    0     0                    29325.131783 50495.6771  72.2%     - 2526s
H    0     0                    29450.543716 50495.6771  71.5%     - 2526s
H    0     0                    29605.115931 50495.6771  70.6%     - 2526s
     0     0 50487.9838    0  426 29605.1159 50487.9838  70.5%     - 2538s
     0     0 50485.9369    0  397 29605.1159 50485.9369  70.5%     - 2543s
     0     0 50470.8120    0  390 29605.1159 50470.8120  70.5%     - 2555s
H    0     0                    29636.110176 50470.6466  70.3%     - 2557s
H    0     0                    29708.458334 50470.6466  69.9%     - 2557s
     0     0 50465.6667    0  443 29708.4583 50465.6667  69.9%     - 2566s
     0     0 50462.2041    0  391 29708.4583 50462.2041  69.9%     - 2576s
     0     0 50459.3689    0  382 29708.4583 50459.3689  69.8%     - 2581s
     0     0 50458.9707    0  395 29708.4583 50458.9707  69.8%     - 2584s
     0     0 50423.3005    0  379 29708.4583 50423.3005  69.7%     - 2608s
H    0     0                    29761.644210 50422.4573  69.4%     - 2618s
H    0     0                    29909.684272 50422.4573  68.6%     - 2620s
     0     0 50414.9089    0  391 29909.6843 50414.9089  68.6%     - 2629s
     0     0 50411.3575    0  387 29909.6843 50411.3575  68.5%     - 2633s
     0     0 50410.3643    0  391 29909.6843 50410.3643  68.5%     - 2636s
     0     0 50399.1319    0  384 29909.6843 50399.1319  68.5%     - 2657s
     0     0 50396.8359    0  380 29909.6843 50396.8359  68.5%     - 2667s
     0     0 50390.7747    0  372 29909.6843 50390.7747  68.5%     - 2679s
H    0     0                    29916.893846 50390.4103  68.4%     - 2688s
     0     0 50387.6483    0  380 29916.8938 50387.6483  68.4%     - 2696s
     0     0 50386.6950    0  384 29916.8938 50386.6950  68.4%     - 2700s
     0     0 50383.1002    0  383 29916.8938 50383.1002  68.4%     - 2709s
     0     0 50381.3015    0  388 29916.8938 50381.3015  68.4%     - 2715s
     0     0 50378.0249    0  383 29916.8938 50378.0249  68.4%     - 2724s
     0     0 50377.8467    0  383 29916.8938 50377.8467  68.4%     - 2734s
H    0     0                    30085.389586 50377.5508  67.4%     - 3091s
H    0     0                    30116.383831 50377.5508  67.3%     - 3171s
     0     2 50377.5508    0  383 30116.3838 50377.5508  67.3%     - 3178s
     1     3 50007.5828    1  360 30116.3838 50376.5406  67.3% 20618 3233s
     2     4 50315.3638    1  383 30116.3838 50315.3638  67.1% 16672 3265s
     3     6 50212.3065    2  367 30116.3838 50314.7454  67.1% 15165 3322s
     5    10 50045.0478    3  391 30116.3838 50314.7454  67.1% 15652 3383s
     9    18 49912.7016    4  386 30116.3838 50074.0386  66.3% 15554 3457s
    17    36 49781.9641    5  374 30116.3838 50044.5797  66.2% 17859 3518s

Cutting planes:
  Learned: 1
  Gomory: 16
  Implied bound: 230
  MIR: 4457
  Flow cover: 3920
  RLT: 52
  Relax-and-lift: 597

Explored 35 nodes (2062879 simplex iterations) in 3600.17 seconds (4536.74 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 30116.4 30085.4 29916.9 ... 29325.1

Time limit reached
Best objective 3.011638383107e+04, best bound 4.978130622682e+04, gap 65.2964%
  WARNING: Time limit reached. Using best solution found (gap: 65.30%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.19s
  Master Objective (UB) = 30116.38, θ = 183962.71
  Upper Bound (UB) = 30116.38

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 183962.71
  [DEBUG]   ✓ Scenario 0: θ = 183962.71 ≤ Q = 183962.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 183962.71 ≤ Q = 183962.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 183962.71 ≤ Q = 183962.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 183962.71 ≤ Q = 183962.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 183962.71 ≤ Q = 183962.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 183962.71 ≤ Q = 183962.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 183962.71 ≤ Q = 183962.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 183962.71 ≤ Q = 183962.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 183962.71 ≤ Q = 183962.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 183962.71 ≤ Q = 183962.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 183962.71 ≤ Q = 183962.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 183962.71 ≤ Q = 183962.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 183962.71 ≤ Q = 183962.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 183962.71 ≤ Q = 183962.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 183962.71 ≤ Q = 183962.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 183962.71 ≤ Q = 183962.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 183962.71 ≤ Q = 183962.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 183962.71 ≤ Q = 183962.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 183962.71 ≤ Q = 183962.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 19: θ = 183962.71 ≤ Q = 183962.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 20: θ = 183962.71 ≤ Q = 183962.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 21: θ = 183962.71 ≤ Q = 183962.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 22: θ = 183962.71 ≤ Q = 183962.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 23: θ = 183962.71 ≤ Q = 183962.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 24: θ = 183962.71 ≤ Q = 183962.71 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 25] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x5d30f4a9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xa2cf0b57
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.420728e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.01s
Presolved: 494 rows, 498 columns, 1396 nonzeros
Found heuristic solution: objective 6863048.6411
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.545705e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -154570.54    0  124 6863048.64 -154570.54   102%     -    0s
H    0     0                    -119974.5084 -154570.54  28.8%     -    0s
H    0     0                    -120958.1929 -154570.54  27.8%     -    0s
     0     0 -130364.14    0   83 -120958.19 -130364.14  7.78%     -    0s
H    0     0                    -126988.9761 -130243.55  2.56%     -    0s
H    0     0                    -127448.1376 -130243.55  2.19%     -    0s
     0     0 -129153.70    0   77 -127448.14 -129153.70  1.34%     -    0s
H    0     0                    -128239.0816 -129146.35  0.71%     -    0s
     0     0 -129128.62    0   76 -128239.08 -129128.62  0.69%     -    0s
H    0     0                    -128322.1695 -129128.62  0.63%     -    0s
     0     0 -128749.83    0   16 -128322.17 -128749.83  0.33%     -    0s
     0     0 -128678.45    0   25 -128322.17 -128678.45  0.28%     -    0s
     0     0 -128670.55    0   23 -128322.17 -128670.55  0.27%     -    0s
     0     0 -128635.11    0   29 -128322.17 -128635.11  0.24%     -    0s
     0     0 -128628.90    0   38 -128322.17 -128628.90  0.24%     -    0s
     0     0 -128466.72    0    8 -128322.17 -128466.72  0.11%     -    0s
H    0     0                    -128365.1611 -128440.46  0.06%     -    0s
     0     0 -128440.46    0    8 -128365.16 -128440.46  0.06%     -    0s
     0     0 -128411.67    0    4 -128365.16 -128411.67  0.04%     -    0s
     0     0 -128411.67    0   13 -128365.16 -128411.67  0.04%     -    0s
     0     0 -128411.67    0   10 -128365.16 -128411.67  0.04%     -    0s
     0     0 -128394.56    0    5 -128365.16 -128394.56  0.02%     -    0s
     0     0 -128391.81    0    4 -128365.16 -128391.81  0.02%     -    0s
H    0     0                    -128377.5953 -128391.81  0.01%     -    0s
     0     0     cutoff    0      -128377.60 -128377.60  0.00%     -    0s

Cutting planes:
  Implied bound: 2
  MIR: 1
  Flow cover: 1
  Relax-and-lift: 2

Explored 1 nodes (684 simplex iterations) in 0.13 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -128378 -128365 -128322 ... 1.42073e+13
No other solutions better than -128378

Optimal solution found (tolerance 1.00e-06)
Best objective -1.283775952632e+05, best bound -1.283775952632e+05, gap 0.0000%
  Subproblem solved in 0.16s
  Worst-case operational profit (Z_SP) = 178740.68
  Scenario: 24 demand increases, 36 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -128377.60
  [DEBUG]   S×d_nominal = 307118.27
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 307118.27 + -128377.60 = 178740.68
  [DEBUG]   Current θ from Master = 183962.71
  [DEBUG]   ⚠️  Z_SP ≤ θ by 5222.03 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 24894.35
  Lower Bound (LB) = 29447.80
  Gap (UB-LB) = 668.5829, Absolute Gap = 668.5829, Relative Gap = 0.022200
  Not converged yet (gap = 668.58 > ε = 200)

  [DEBUG] Adding NEW scenario 25 to Master Problem...
  [DEBUG] New scenario pattern: 24 increases, 36 decreases
    [DEBUG] Scenario 25 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 25 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 25]
    [DEBUG]   - Total constraints in model: 398923
    [DEBUG]   - Total variables in model: 164500
  [DEBUG] Total scenarios in Master: 26
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 26
================================================================================
[Iteration 26] Solving Master Problem...
  Current scenarios in Master: 26
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 398923 rows, 164500 columns and 1129525 nonzeros
Model fingerprint: 0x03cf28de
Variable types: 162241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 183820 rows and 74620 columns (presolve time = 5s)...
Presolve removed 183820 rows and 74620 columns
Presolve time: 7.65s
Presolved: 215103 rows, 89880 columns, 1324851 nonzeros
Variable types: 87621 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -335473.7764
Found heuristic solution: objective -180138.7472

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 2.74s

Barrier statistics:
 Dense cols : 1145
 AA' NZ     : 6.280e+06
 Factor NZ  : 1.738e+07 (roughly 260 MB of memory)
 Factor Ops : 6.349e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.26141547e+07  3.74890968e+08  1.68e+05 1.21e+01  1.03e+05    14s
   1  -1.77323540e+07  3.57361678e+08  1.19e+05 8.14e+01  7.28e+04    14s
   2  -7.97192177e+06  2.70311586e+08  5.23e+04 4.50e+00  3.40e+04    14s
   3  -9.83691032e+05  2.20385213e+08  2.83e+03 4.29e+00  2.40e+03    15s
   4  -6.08953839e+05  1.47779180e+08  6.66e+02 1.96e+00  7.77e+02    15s
   5  -5.34769144e+05  1.10312446e+08  3.85e+02 1.36e+00  5.00e+02    15s
   6  -4.88007548e+05  7.79594613e+07  2.41e+02 8.97e-01  3.26e+02    15s
   7  -4.35424318e+05  6.23986644e+07  1.05e+02 6.90e-01  2.12e+02    15s
   8  -4.07240896e+05  4.03039714e+07  4.30e+01 4.22e-01  1.22e+02    16s
   9  -3.28237801e+05  2.75829122e+07  1.18e+00 2.77e-01  7.17e+01    16s
  10  -2.35310390e+05  7.04162916e+06  2.24e-01 6.93e-02  1.86e+01    16s
  11  -1.55261493e+05  3.51433433e+06  1.17e-01 3.39e-02  9.38e+00    16s
  12  -1.05628337e+05  2.70597955e+06  6.93e-02 2.59e-02  7.19e+00    17s
  13  -8.42018531e+04  1.93147200e+06  4.84e-02 1.86e-02  5.15e+00    17s
  14  -4.85241236e+04  1.47775785e+06  2.11e-02 1.43e-02  3.90e+00    17s
  15  -2.66256847e+04  1.18026893e+06  1.12e-02 1.14e-02  3.08e+00    17s
  16  -3.71610161e+03  4.27086650e+05  4.84e-03 3.88e-03  1.10e+00    17s
  17   1.57543602e+04  2.53166856e+05  3.08e-03 2.14e-03  6.07e-01    18s
  18   2.79765611e+04  2.04067873e+05  2.14e-03 1.58e-03  4.50e-01    18s
  19   3.30975438e+04  1.66610336e+05  1.75e-03 1.18e-03  3.41e-01    19s
  20   3.67276970e+04  1.55084281e+05  1.49e-03 1.05e-03  3.02e-01    19s
  21   3.99973993e+04  1.16091288e+05  1.29e-03 6.51e-04  1.94e-01    19s
  22   4.18140650e+04  1.09623073e+05  1.19e-03 5.77e-04  1.73e-01    20s
  23   4.39079560e+04  1.00090806e+05  1.07e-03 4.63e-04  1.44e-01    20s
  24   4.64985328e+04  9.43178579e+04  9.29e-04 3.93e-04  1.22e-01    20s
  25   4.90475385e+04  8.87171023e+04  7.99e-04 3.25e-04  1.01e-01    21s
  26   5.06829839e+04  8.74945361e+04  7.18e-04 3.07e-04  9.41e-02    21s
  27   5.40923950e+04  8.25536937e+04  5.52e-04 2.34e-04  7.27e-02    22s
  28   5.71011185e+04  7.99960666e+04  4.14e-04 1.98e-04  5.85e-02    22s
  29   5.86781597e+04  7.81946164e+04  3.43e-04 1.70e-04  4.99e-02    22s
  30   6.08881923e+04  7.52208668e+04  2.46e-04 1.24e-04  3.66e-02    23s
  31   6.18581983e+04  7.29378634e+04  2.05e-04 8.90e-05  2.83e-02    23s
  32   6.32453093e+04  7.17242659e+04  1.49e-04 7.02e-05  2.17e-02    24s
  33   6.45044450e+04  7.05429189e+04  9.93e-05 5.15e-05  1.54e-02    24s
  34   6.47759515e+04  6.92069140e+04  8.90e-05 3.00e-05  1.13e-02    24s
  35   6.60317918e+04  6.88383636e+04  4.42e-05 2.44e-05  7.17e-03    25s
  36   6.64346227e+04  6.84934514e+04  2.87e-05 1.89e-05  5.26e-03    25s
  37   6.67088877e+04  6.81650341e+04  1.91e-05 1.36e-05  3.72e-03    26s
  38   6.69137853e+04  6.76204047e+04  1.21e-05 5.17e-06  1.81e-03    26s
  39   6.70630521e+04  6.74831189e+04  7.30e-06 2.87e-06  1.07e-03    26s
  40   6.71358152e+04  6.74546132e+04  4.96e-06 2.44e-06  8.15e-04    27s
  41   6.71765129e+04  6.73914071e+04  3.69e-06 1.50e-06  5.49e-04    27s
  42   6.71868118e+04  6.73784755e+04  3.37e-06 1.29e-06  4.90e-04    27s
  43   6.72178663e+04  6.73743192e+04  2.47e-06 1.20e-06  4.00e-04    28s
  44   6.72387190e+04  6.73554984e+04  1.83e-06 8.83e-07  2.98e-04    28s
  45   6.72616457e+04  6.73322921e+04  1.14e-06 4.75e-07  1.81e-04    28s
  46   6.72710347e+04  6.73226103e+04  8.60e-07 3.33e-07  1.32e-04    29s
  47   6.72807417e+04  6.73146430e+04  5.79e-07 2.05e-07  8.66e-05    29s
  48   6.72844596e+04  6.73129437e+04  4.72e-07 1.76e-07  7.28e-05    30s
  49   6.72929277e+04  6.73070054e+04  2.38e-07 7.83e-08  3.60e-05    31s
  50   6.72964719e+04  6.73048074e+04  1.42e-07 4.43e-08  2.13e-05    31s
  51   6.72999737e+04  6.73040424e+04  5.05e-08 3.10e-08  1.04e-05    32s
  52   6.73012206e+04  6.73031824e+04  4.19e-08 1.76e-08  5.01e-06    32s
  53   6.73018756e+04  6.73020997e+04  1.54e-08 1.21e-09  5.73e-07    33s
  54   6.73020204e+04  6.73020683e+04  4.76e-07 8.59e-08  1.22e-07    33s
  55   6.73020644e+04  6.73020652e+04  1.26e-08 5.66e-09  1.87e-09    33s
  56   6.73020649e+04  6.73020649e+04  8.99e-09 1.75e-09  7.92e-12    34s

Barrier solved model in 56 iterations and 33.61 seconds (26.05 work units)
Optimal objective 6.73020649e+04


Root crossover log...

  192628 DPushes remaining with DInf 1.7771777e-08                34s
   79280 DPushes remaining with DInf 0.0000000e+00                35s
    6431 DPushes remaining with DInf 0.0000000e+00                40s
       0 DPushes remaining with DInf 0.0000000e+00                43s

    2625 PPushes remaining with PInf 4.2714673e-06                43s
       0 PPushes remaining with PInf 0.0000000e+00                43s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.3023855e-10     43s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   78044    6.7302065e+04   0.000000e+00   0.000000e+00     44s
   78044    6.7302065e+04   0.000000e+00   0.000000e+00     44s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 6.730206e+04, 78044 iterations, 34.20 seconds (30.95 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 67302.0649    0  153 -180138.75 67302.0649   137%     -   44s
H    0     0                    -173988.5252 67302.0649   139%     -   44s
H    0     0                    -83037.22841 67302.0649   181%     -   46s
H    0     0                    -82921.06713 67302.0649   181%     -   46s
H    0     0                    -61879.27678 67302.0649   209%     -   46s
H    0     0                    20374.985534 67302.0649   230%     -   47s
H    0     0                    20688.898668 67302.0649   225%     -   48s
H    0     0                    20809.111973 67302.0649   223%     -   49s
H    0     0                    21034.385242 67302.0649   220%     -   49s
H    0     0                    21052.428748 67302.0649   220%     -   49s
H    0     0                    21076.652127 67302.0649   219%     -   49s
H    0     0                    21077.767637 67302.0649   219%     -   49s
H    0     0                    21104.852418 67302.0649   219%     -   49s
H    0     0                    21106.390454 67302.0649   219%     -   49s
     0     0 61349.3480    0  197 21106.3905 61349.3480   191%     -  212s
H    0     0                    21106.807982 61349.0868   191%     -  215s
H    0     0                    21276.011043 61349.0868   188%     -  215s
     0     0 61107.9666    0  213 21276.0110 61107.9666   187%     -  271s
     0     0 60974.8310    0  215 21276.0110 60974.8310   187%     -  305s
     0     0 60926.0093    0  219 21276.0110 60926.0093   186%     -  321s
     0     0 60907.3907    0  219 21276.0110 60907.3907   186%     -  330s
     0     0 60907.3844    0  219 21276.0110 60907.3844   186%     -  332s
     0     0 57599.9558    0  254 21276.0110 57599.9558   171%     -  540s
H    0     0                    26496.668821 57596.2939   117%     -  542s
H    0     0                    27452.707691 57596.2939   110%     -  542s
H    0     0                    27560.562758 57596.2939   109%     -  542s
H    0     0                    27894.108275 57596.2939   106%     -  542s
H    0     0                    27981.617095 57596.2939   106%     -  543s
     0     0 57001.9444    0  307 27981.6171 57001.9444   104%     -  640s
     0     0 57001.9444    0  307 27981.6171 57001.9444   104%     -  640s
     0     0 56862.7655    0  312 27981.6171 56862.7655   103%     -  708s
     0     0 56838.8940    0  305 27981.6171 56838.8940   103%     -  740s
     0     0 56795.1659    0  304 27981.6171 56795.1659   103%     -  764s
     0     0 56744.9345    0  301 27981.6171 56744.9345   103%     -  801s
     0     0 56673.2331    0  319 27981.6171 56673.2331   103%     -  839s
     0     0 56666.8606    0  313 27981.6171 56666.8606   103%     -  854s
     0     0 56655.6525    0  314 27981.6171 56655.6525   102%     -  870s
     0     0 56562.8119    0  302 27981.6171 56562.8119   102%     -  899s
     0     0 56545.0115    0  304 27981.6171 56545.0115   102%     -  915s
     0     0 56543.9625    0  301 27981.6171 56543.9625   102%     -  923s
     0     0 54370.6629    0  334 27981.6171 54370.6629  94.3%     - 1192s
     0     0 53974.7059    0  351 27981.6171 53974.7059  92.9%     - 1305s
     0     0 53824.7453    0  345 27981.6171 53824.7453  92.4%     - 1377s
     0     0 53754.3089    0  357 27981.6171 53754.3089  92.1%     - 1428s
     0     0 53710.4380    0  361 27981.6171 53710.4380  91.9%     - 1476s
     0     0 53670.6490    0  357 27981.6171 53670.6490  91.8%     - 1509s
     0     0 53646.9121    0  349 27981.6171 53646.9121  91.7%     - 1532s
     0     0 53616.0184    0  353 27981.6171 53616.0184  91.6%     - 1555s
     0     0 53586.5030    0  361 27981.6171 53586.5030  91.5%     - 1577s
     0     0 53583.6473    0  358 27981.6171 53583.6473  91.5%     - 1584s
     0     0 53566.3107    0  359 27981.6171 53566.3107  91.4%     - 1598s
     0     0 53563.0813    0  354 27981.6171 53563.0813  91.4%     - 1603s
     0     0 53558.7543    0  359 27981.6171 53558.7543  91.4%     - 1607s
     0     0 53558.0918    0  360 27981.6171 53558.0918  91.4%     - 1610s
     0     0 52585.9106    0  361 27981.6171 52585.9106  87.9%     - 1784s
H    0     0                    28033.858149 52585.8149  87.6%     - 1786s
H    0     0                    28163.307076 52585.8149  86.7%     - 1787s
H    0     0                    28283.365845 52585.8149  85.9%     - 1787s
     0     0 52361.4533    0  368 28283.3658 52361.4533  85.1%     - 1869s
     0     0 52267.0312    0  362 28283.3658 52267.0312  84.8%     - 1932s
     0     0 52105.6539    0  363 28283.3658 52105.6539  84.2%     - 2003s
     0     0 52070.9881    0  366 28283.3658 52070.9881  84.1%     - 2034s
     0     0 51926.3434    0  365 28283.3658 51926.3434  83.6%     - 2090s
     0     0 51883.7211    0  375 28283.3658 51883.7211  83.4%     - 2115s
     0     0 51871.8222    0  381 28283.3658 51871.8222  83.4%     - 2135s
     0     0 51864.3096    0  379 28283.3658 51864.3096  83.4%     - 2144s
     0     0 51855.3900    0  388 28283.3658 51855.3900  83.3%     - 2156s
     0     0 51852.9276    0  377 28283.3658 51852.9276  83.3%     - 2161s
     0     0 51848.7255    0  371 28283.3658 51848.7255  83.3%     - 2167s
     0     0 51830.1782    0  376 28283.3658 51830.1782  83.3%     - 2179s
     0     0 51803.2814    0  376 28283.3658 51803.2814  83.2%     - 2197s
     0     0 51797.4810    0  375 28283.3658 51797.4810  83.1%     - 2205s
     0     0 51787.9381    0  370 28283.3658 51787.9381  83.1%     - 2218s
     0     0 51785.3189    0  370 28283.3658 51785.3189  83.1%     - 2223s
     0     0 51781.2858    0  375 28283.3658 51781.2858  83.1%     - 2227s
     0     0 51779.5764    0  377 28283.3658 51779.5764  83.1%     - 2231s
     0     0 51499.6621    0  355 28283.3658 51499.6621  82.1%     - 2299s
H    0     0                    28361.065054 51499.6455  81.6%     - 2301s
     0     0 51402.2099    0  403 28361.0651 51402.2099  81.2%     - 2340s
     0     0 51349.2048    0  364 28361.0651 51349.2048  81.1%     - 2379s
     0     0 51260.2429    0  409 28361.0651 51260.2429  80.7%     - 2456s
     0     0 51238.6285    0  428 28361.0651 51238.6285  80.7%     - 2481s
     0     0 51233.9422    0  371 28361.0651 51233.9422  80.6%     - 2497s
     0     0 51215.8557    0  432 28361.0651 51215.8557  80.6%     - 2525s
     0     0 51187.7730    0  428 28361.0651 51187.7730  80.5%     - 2559s
     0     0 51171.4926    0  428 28361.0651 51171.4926  80.4%     - 2576s
     0     0 51159.2367    0  421 28361.0651 51159.2367  80.4%     - 2589s
     0     0 51138.1352    0  414 28361.0651 51138.1352  80.3%     - 2608s
     0     0 51127.7893    0  412 28361.0651 51127.7893  80.3%     - 2622s
     0     0 51118.2648    0  421 28361.0651 51118.2648  80.2%     - 2633s
     0     0 51117.7100    0  420 28361.0651 51117.7100  80.2%     - 2636s
     0     0 50996.2349    0  376 28361.0651 50996.2349  79.8%     - 2715s
H    0     0                    28595.418277 50996.1000  78.3%     - 2721s
     0     0 50939.5441    0  385 28595.4183 50939.5441  78.1%     - 2771s
     0     0 50925.9798    0  384 28595.4183 50925.9798  78.1%     - 2790s
     0     0 50898.6273    0  421 28595.4183 50898.6273  78.0%     - 2812s
     0     0 50872.5291    0  427 28595.4183 50872.5291  77.9%     - 2826s
     0     0 50847.1281    0  448 28595.4183 50847.1281  77.8%     - 2852s
     0     0 50826.5852    0  435 28595.4183 50826.5852  77.7%     - 2871s
     0     0 50813.7406    0  376 28595.4183 50813.7406  77.7%     - 2888s
     0     0 50810.0611    0  423 28595.4183 50810.0611  77.7%     - 2899s
     0     0 50800.1830    0  431 28595.4183 50800.1830  77.7%     - 2915s
     0     0 50798.2651    0  474 28595.4183 50798.2651  77.6%     - 2924s
     0     0 50720.2580    0  429 28595.4183 50720.2580  77.4%     - 2971s
     0     0 50689.3286    0  383 28595.4183 50689.3286  77.3%     - 3010s
     0     0 50679.1235    0  397 28595.4183 50679.1235  77.2%     - 3023s
     0     0 50672.6541    0  393 28595.4183 50672.6541  77.2%     - 3036s
     0     0 50664.9605    0  408 28595.4183 50664.9605  77.2%     - 3051s
     0     0 50660.2439    0  391 28595.4183 50660.2439  77.2%     - 3057s
     0     0 50658.5756    0  392 28595.4183 50658.5756  77.2%     - 3065s
     0     0 50640.3921    0  433 28595.4183 50640.3921  77.1%     - 3099s
H    0     0                    29099.862233 50640.3020  74.0%     - 3102s
     0     0 50636.5360    0  394 29099.8622 50636.5360  74.0%     - 3113s
     0     0 50634.1092    0  399 29099.8622 50634.1092  74.0%     - 3120s
     0     0 50633.3707    0  388 29099.8622 50633.3707  74.0%     - 3130s
     0     0 50593.8060    0  389 29099.8622 50593.8060  73.9%     - 3160s
H    0     0                    29190.134582 50593.1147  73.3%     - 3162s
     0     0 50577.6312    0  389 29190.1346 50577.6312  73.3%     - 3185s
     0     0 50575.3187    0  400 29190.1346 50575.3187  73.3%     - 3191s
     0     0 50558.6421    0  424 29190.1346 50558.6421  73.2%     - 3215s
H    0     0                    29332.742704 50558.0904  72.4%     - 3218s
     0     0 50552.5743    0  436 29332.7427 50552.5743  72.3%     - 3227s
     0     0 50550.2381    0  391 29332.7427 50550.2381  72.3%     - 3234s
     0     0 50544.8945    0  441 29332.7427 50544.8945  72.3%     - 3248s
     0     0 50543.7853    0  479 29332.7427 50543.7853  72.3%     - 3257s
     0     0 50530.6083    0  393 29332.7427 50530.6083  72.3%     - 3287s
     0     0 50527.9779    0  393 29332.7427 50527.9779  72.3%     - 3315s
     0     0 50523.7556    0  404 29332.7427 50523.7556  72.2%     - 3323s
     0     0 50522.6555    0  417 29332.7427 50522.6555  72.2%     - 3328s
     0     0 50511.3994    0  491 29332.7427 50511.3994  72.2%     - 3350s
     0     0 50510.3917    0  491 29332.7427 50510.3917  72.2%     - 3362s
H    0     0                    29485.363690 50510.3917  71.3%     - 3531s

Cutting planes:
  Learned: 1
  Gomory: 20
  Implied bound: 214
  MIR: 2547
  Flow cover: 1515
  RLT: 31
  Relax-and-lift: 265

Explored 1 nodes (1174020 simplex iterations) in 3600.03 seconds (3675.35 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 29485.4 29332.7 29190.1 ... 27981.6

Time limit reached
Best objective 2.948536368991e+04, best bound 5.051039174527e+04, gap 71.3067%
  WARNING: Time limit reached. Using best solution found (gap: 71.31%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = 29485.36, θ = 183148.82
  Upper Bound (UB) = 29485.36

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 183148.82
  [DEBUG]   ✓ Scenario 0: θ = 183148.82 ≤ Q = 183148.82 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 183148.82 ≤ Q = 183295.09 (slack: 146.28)
  [DEBUG]   ✓ Scenario 2: θ = 183148.82 ≤ Q = 183148.82 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 183148.82 ≤ Q = 183148.82 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 183148.82 ≤ Q = 183148.82 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 183148.82 ≤ Q = 183148.82 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 183148.82 ≤ Q = 183148.82 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 183148.82 ≤ Q = 183148.82 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 183148.82 ≤ Q = 183148.82 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 183148.82 ≤ Q = 183148.82 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 183148.82 ≤ Q = 183148.82 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 183148.82 ≤ Q = 183148.82 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 183148.82 ≤ Q = 183148.82 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 183148.82 ≤ Q = 183148.82 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 183148.82 ≤ Q = 183148.82 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 183148.82 ≤ Q = 183148.82 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 183148.82 ≤ Q = 183148.82 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 183148.82 ≤ Q = 183148.82 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 183148.82 ≤ Q = 183148.82 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 183148.82 ≤ Q = 183148.82 (slack: 0.00)
  [DEBUG]   ✓ Scenario 20: θ = 183148.82 ≤ Q = 183148.82 (slack: 0.00)
  [DEBUG]   ✓ Scenario 21: θ = 183148.82 ≤ Q = 183148.82 (slack: 0.00)
  [DEBUG]   ✓ Scenario 22: θ = 183148.82 ≤ Q = 183148.82 (slack: 0.00)
  [DEBUG]   ✓ Scenario 23: θ = 183148.82 ≤ Q = 183148.82 (slack: -0.00)
  [DEBUG]   ✓ Scenario 24: θ = 183148.82 ≤ Q = 183148.82 (slack: -0.00)
  [DEBUG]   ✓ Scenario 25: θ = 183148.82 ≤ Q = 183148.82 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 26] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x58e491c4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x58e491c4
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.410527e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.01s
Presolved: 494 rows, 498 columns, 1396 nonzeros
Found heuristic solution: objective 6832402.0829
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.561476e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -156147.63    0  123 6832402.08 -156147.63   102%     -    0s
H    0     0                    -121655.8401 -156147.63  28.4%     -    0s
H    0     0                    -122603.4454 -156147.63  27.4%     -    0s
H    0     0                    -127115.3056 -131434.07  3.40%     -    0s
     0     0 -131434.07    0   82 -127115.31 -131434.07  3.40%     -    0s
H    0     0                    -127882.3248 -131277.72  2.66%     -    0s
     0     0 -129655.96    0   84 -127882.32 -129655.96  1.39%     -    0s
H    0     0                    -127927.1421 -129645.39  1.34%     -    0s
     0     0 -129270.89    0   76 -127927.14 -129270.89  1.05%     -    0s
H    0     0                    -128554.1281 -129264.78  0.55%     -    0s
H    0     0                    -128618.2476 -129264.78  0.50%     -    0s
     0     0 -129193.87    0   75 -128618.25 -129193.87  0.45%     -    0s
     0     0 -129108.00    0   45 -128618.25 -129108.00  0.38%     -    0s
     0     0 -129084.87    0   46 -128618.25 -129084.87  0.36%     -    0s
     0     0 -129046.82    0   44 -128618.25 -129046.82  0.33%     -    0s
     0     0 -129045.51    0   44 -128618.25 -129045.51  0.33%     -    0s
H    0     0                    -128664.6379 -129045.19  0.30%     -    0s
H    0     0                    -128717.8502 -129045.19  0.25%     -    0s
     0     2 -129045.19    0   44 -128717.85 -129045.19  0.25%     -    0s
*   84     0              11    -128720.7140 -128762.77  0.03%   8.9    0s
*   93     0               9    -128722.5416 -128762.77  0.03%   8.3    0s
*   95     0               9    -128733.1481 -128762.77  0.02%   8.2    0s
*  105     0              10    -128737.5673 -128737.57  0.00%   7.7    0s

Cutting planes:
  Gomory: 33
  Implied bound: 5
  MIR: 158
  Flow cover: 18
  RLT: 14

Explored 118 nodes (1421 simplex iterations) in 0.21 seconds (0.06 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -128738 -128733 -128723 ... -127882
No other solutions better than -128738

Optimal solution found (tolerance 1.00e-06)
Best objective -1.287375673207e+05, best bound -1.287375673207e+05, gap 0.0000%
  Subproblem solved in 0.24s
  Worst-case operational profit (Z_SP) = 179144.99
  Scenario: 22 demand increases, 38 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -128737.57
  [DEBUG]   S×d_nominal = 307882.55
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 307882.55 + -128737.57 = 179144.99
  [DEBUG]   Current θ from Master = 183148.82
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4003.83 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 25481.53
  Lower Bound (LB) = 29447.80
  Gap (UB-LB) = 37.5628, Absolute Gap = 37.5628, Relative Gap = 0.001274
  *** CONVERGED (gap within tolerance) ***

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 26
Total Time: 78169.66s
Converged: True
Final Lower Bound: 29447.8009
Final Upper Bound: 29485.3637
Final Gap: 37.562779
Number of Critical Scenarios: 26
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [0] (1/3)
Product 1 Plants: [2] (1/3)
Product 2 Plants: [0] (1/3)
Total Plant Openings: 3
DCs Opened: [0, 4, 5, 9] (4/10)
Active Routes (Plant→DC): 12
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 0 customers  Mode 1: 9 customers  Mode 2: 41 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 26
Start Time: 2026-01-03 09:45:25
End Time: 2026-01-04 07:28:14
Total Time: 78169.66s
Optimal Value: 29447.80
Lower Bound: 29447.80
Upper Bound: 29485.36
Gap: 37.562779
Plants Opened: {0: [0], 1: [2], 2: [0]} (3 plants)
DCs Opened: [0, 4, 5, 9] (4 DCs)
================================================================================

Results saved to: result/DH_single_full_seed13_HD_gamma20_20260104_072814.csv

Total Execution Time: 78170.55 seconds
End Time: 2026-01-04 07:28:15

All tasks completed successfully!

