
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 35
DI Scenario: Mixed
Start Time: 2026-01-04 09:06:57
================================================================================
Loading data from data/DH_data_full_seed35.pkl...

Applying DI scenario: Mixed
DI values:
  Product 0: ['1.000', '1.313', '1.723'] (k=0.671)
  Product 1: ['1.000', '1.152', '1.327'] (k=0.349)
  Product 2: ['1.000', '1.016', '1.032'] (k=0.039)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=918, max=1770
  DC capacity (MC): min=522, max=896

Demand Structure (s_rk matrix):
  Total customer-product pairs: 83/150 (44.7% sparse)
  Average products per customer: 1.66

Demand (only non-zero entries):
  Nominal (μ): min=8.61, max=34.83, count=83
  Deviation (μ̂): min=4.05, max=9.98

Costs:
  Plant fixed cost: min=6086, max=9811
  DC fixed cost: min=3121, max=5698
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.313', '1.723'] (k=0.671)
    Product 1: ['1.000', '1.449', '2.100'] (k=0.915)
    Product 2: ['1.000', '1.403', '1.969'] (k=0.836)
  MD:
    Product 0: ['1.000', '1.220', '1.488'] (k=0.490)
    Product 1: ['1.000', '1.152', '1.327'] (k=0.349)
    Product 2: ['1.000', '1.232', '1.517'] (k=0.514)
  LD:
    Product 0: ['1.000', '1.117', '1.249'] (k=0.274)
    Product 1: ['1.000', '1.005', '1.010'] (k=0.012)
    Product 2: ['1.000', '1.016', '1.032'] (k=0.039)
  Mixed:
    Product 0: ['1.000', '1.313', '1.723'] (k=0.671)
    Product 1: ['1.000', '1.152', '1.327'] (k=0.349)
    Product 2: ['1.000', '1.016', '1.032'] (k=0.039)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48759 nonzeros
Model fingerprint: 0x007f525b
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11748 rows and 2748 columns
Presolve time: 0.06s
Presolved: 4925 rows, 5752 columns, 34182 nonzeros
Variable types: 3493 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -298996.2242
Found heuristic solution: objective -186301.5197

Root relaxation: objective 8.381347e+04, 4359 iterations, 0.12 seconds (0.21 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 83813.4707    0  569 -186301.52 83813.4707   145%     -    0s
H    0     0                    -157423.8581 83813.4707   153%     -    0s
     0     0 77499.9503    0  786 -157423.86 77499.9503   149%     -    0s
     0     0 77376.8959    0  779 -157423.86 77376.8959   149%     -    0s
     0     0 77350.1737    0  864 -157423.86 77350.1737   149%     -    0s
     0     0 77349.7545    0  866 -157423.86 77349.7545   149%     -    0s
H    0     0                    -149389.3357 77349.7545   152%     -    0s
H    0     0                    -144201.1171 73452.1708   151%     -    1s
     0     0 73452.1708    0  979 -144201.12 73452.1708   151%     -    1s
H    0     0                    -142482.8512 73450.7839   152%     -    1s
     0     0 73302.3279    0 1001 -142482.85 73302.3279   151%     -    1s
     0     0 73276.0698    0 1000 -142482.85 73276.0698   151%     -    1s
     0     0 73271.6811    0 1002 -142482.85 73271.6811   151%     -    1s
     0     0 73270.6860    0 1004 -142482.85 73270.6860   151%     -    1s
H    0     0                    -2614.577829 70388.6693  2792%     -    2s
H    0     0                    35140.280205 70388.6693   100%     -    2s
     0     0 70388.6693    0 1165 35140.2802 70388.6693   100%     -    2s
     0     0 70086.1496    0 1178 35140.2802 70086.1496  99.4%     -    3s
     0     0 70041.8581    0 1188 35140.2802 70041.8581  99.3%     -    3s
     0     0 70036.4169    0 1284 35140.2802 70036.4169  99.3%     -    3s
     0     0 70034.5426    0 1188 35140.2802 70034.5426  99.3%     -    3s
H    0     0                    35912.349231 67936.0735  89.2%     -    4s
H    0     0                    36001.395158 67936.0735  88.7%     -    4s
     0     0 67936.0735    0 1294 36001.3952 67936.0735  88.7%     -    4s
     0     0 67634.5153    0 1289 36001.3952 67634.5153  87.9%     -    5s
H    0     0                    36073.851283 67554.7708  87.3%     -    5s
H    0     0                    36418.129793 67554.7708  85.5%     -    5s
H    0     0                    36577.374530 67554.7708  84.7%     -    5s
H    0     0                    36578.362343 67554.7708  84.7%     -    5s
H    0     0                    37260.173480 67554.7708  81.3%     -    5s
H    0     0                    37556.406425 67554.7708  79.9%     -    5s
H    0     0                    37564.877983 67554.7708  79.8%     -    5s
H    0     0                    37613.079217 67554.7708  79.6%     -    5s
H    0     0                    37734.257893 67554.7708  79.0%     -    5s
H    0     0                    38043.393278 67554.7708  77.6%     -    5s
H    0     0                    38079.568411 67554.7708  77.4%     -    5s
H    0     0                    38093.223203 67554.7708  77.3%     -    5s
H    0     0                    38143.206740 67554.7708  77.1%     -    5s
     0     0 67554.7708    0 1286 38143.2067 67554.7708  77.1%     -    5s
     0     0 67540.2737    0 1293 38143.2067 67540.2737  77.1%     -    5s
     0     0 67538.5270    0 1294 38143.2067 67538.5270  77.1%     -    5s
H    0     0                    38209.708781 66365.9415  73.7%     -    6s
H    0     0                    38371.263027 66365.9415  73.0%     -    6s
H    0     0                    38372.250840 66365.9415  73.0%     -    6s
     0     0 66365.9415    0 1207 38372.2508 66365.9415  73.0%     -    6s
H    0     0                    38562.331263 66111.8612  71.4%     -    7s
H    0     0                    38689.709249 66111.8612  70.9%     -    7s
H    0     0                    38725.913061 66111.8612  70.7%     -    7s
H    0     0                    38726.900874 66111.8612  70.7%     -    7s
H    0     0                    38734.555606 66111.8612  70.7%     -    7s
H    0     0                    38811.828257 66111.8612  70.3%     -    7s
     0     0 66111.8612    0 1220 38811.8283 66111.8612  70.3%     -    7s
     0     0 66049.6479    0 1331 38811.8283 66049.6479  70.2%     -    7s
     0     0 66031.0304    0 1344 38811.8283 66031.0304  70.1%     -    7s
     0     0 66028.4774    0 1339 38811.8283 66028.4774  70.1%     -    7s
H    0     0                    39495.925369 66028.4774  67.2%     -    8s
H    0     0                    39783.768406 66028.4774  66.0%     -    8s
H    0     0                    39789.556439 66028.4774  65.9%     -    8s
H    0     0                    40075.178551 66028.4774  64.8%     -    8s
H    0     0                    40219.170505 66028.4774  64.2%     -    8s
H    0     0                    40264.738547 66028.4774  64.0%     -    8s
     0     0 65045.6652    0 1331 40264.7385 65045.6652  61.5%     -    9s
     0     0 64903.0561    0 1363 40264.7385 64903.0561  61.2%     -    9s
     0     0 64877.0275    0 1356 40264.7385 64877.0275  61.1%     -    9s
     0     0 64872.7479    0 1376 40264.7385 64872.7479  61.1%     -    9s
H    0     0                    40398.834407 64284.7907  59.1%     -   11s
H    0     0                    40464.386338 64284.7907  58.9%     -   11s
H    0     0                    40470.174371 64284.7907  58.8%     -   11s
H    0     0                    40487.392127 64284.7907  58.8%     -   11s
H    0     0                    40493.180160 64284.7907  58.8%     -   11s
     0     0 64284.7907    0 1314 40493.1802 64284.7907  58.8%     -   11s
     0     0 64180.1202    0 1348 40493.1802 64180.1202  58.5%     -   11s
H    0     0                    41911.767443 64161.1941  53.1%     -   11s
H    0     0                    42369.731063 64161.1941  51.4%     -   11s
H    0     0                    42485.257880 64161.1941  51.0%     -   11s
H    0     0                    42552.164974 64161.1941  50.8%     -   11s
H    0     0                    42552.807211 64161.1941  50.8%     -   11s
H    0     0                    42571.067627 64161.1941  50.7%     -   11s
H    0     0                    42571.709864 64161.1941  50.7%     -   11s
H    0     0                    42592.504469 64161.1941  50.6%     -   11s
H    0     0                    42593.146706 64161.1941  50.6%     -   11s
H    0     0                    42599.136045 64161.1941  50.6%     -   11s
H    0     0                    42624.644331 64161.1941  50.5%     -   11s
H    0     0                    42625.286568 64161.1941  50.5%     -   11s
     0     0 64161.1941    0 1368 42625.2866 64161.1941  50.5%     -   11s
     0     0 64155.0693    0 1376 42625.2866 64155.0693  50.5%     -   12s
H    0     0                    42672.950682 63690.1355  49.3%     -   13s
H    0     0                    42847.679357 63690.1355  48.6%     -   13s
H    0     0                    42938.336808 63690.1355  48.3%     -   13s
     0     0 63690.1355    0 1327 42938.3368 63690.1355  48.3%     -   13s
     0     0 63617.3607    0 1381 42938.3368 63617.3607  48.2%     -   13s
H    0     0                    43407.641665 63602.1173  46.5%     -   14s
H    0     0                    43585.087074 63602.1173  45.9%     -   14s
H    0     0                    43620.511577 63602.1173  45.8%     -   14s
H    0     0                    43657.566431 63602.1173  45.7%     -   14s
     0     0 63602.1173    0 1382 43657.5664 63602.1173  45.7%     -   14s
H    0     0                    43694.897893 62722.5944  43.5%     -   15s
H    0     0                    43711.961960 62722.5944  43.5%     -   15s
     0     0 62722.5944    0 1316 43711.9620 62722.5944  43.5%     -   16s
H    0     0                    43752.278595 62539.1404  42.9%     -   16s
H    0     0                    43758.267934 62539.1404  42.9%     -   16s
     0     0 62539.1404    0 1350 43758.2679 62539.1404  42.9%     -   16s
     0     0 62495.4146    0 1341 43758.2679 62495.4146  42.8%     -   17s
     0     0 62488.4323    0 1369 43758.2679 62488.4323  42.8%     -   17s
     0     0 61855.3858    0 1352 43758.2679 61855.3858  41.4%     -   19s
     0     0 61718.8095    0 1361 43758.2679 61718.8095  41.0%     -   19s
     0     0 61671.3541    0 1395 43758.2679 61671.3541  40.9%     -   20s
     0     0 61661.5605    0 1410 43758.2679 61661.5605  40.9%     -   20s
     0     0 61089.2328    0 1308 43758.2679 61089.2328  39.6%     -   22s
     0     0 60892.9895    0 1332 43758.2679 60892.9895  39.2%     -   23s
     0     0 60853.1484    0 1357 43758.2679 60853.1484  39.1%     -   23s
     0     0 60847.4113    0 1378 43758.2679 60847.4113  39.1%     -   24s
     0     0 60455.0075    0 1182 43758.2679 60455.0075  38.2%     -   25s
     0     0 60352.7968    0 1308 43758.2679 60352.7968  37.9%     -   26s
     0     0 60320.8929    0 1317 43758.2679 60320.8929  37.9%     -   26s
     0     0 60313.4987    0 1312 43758.2679 60313.4987  37.8%     -   27s
     0     0 59862.0480    0 1284 43758.2679 59862.0480  36.8%     -   28s
     0     0 59746.4855    0 1309 43758.2679 59746.4855  36.5%     -   29s
     0     0 59712.3269    0 1312 43758.2679 59712.3269  36.5%     -   29s
     0     0 59703.4244    0 1322 43758.2679 59703.4244  36.4%     -   30s
     0     0 58854.7839    0 1301 43758.2679 58854.7839  34.5%     -   32s
     0     0 58617.3689    0 1294 43758.2679 58617.3689  34.0%     -   33s
     0     0 58563.8756    0 1304 43758.2679 58563.8756  33.8%     -   34s
     0     0 58549.8244    0 1323 43758.2679 58549.8244  33.8%     -   34s
     0     0 58077.2895    0 1276 43758.2679 58077.2895  32.7%     -   36s
     0     0 57938.1795    0 1301 43758.2679 57938.1795  32.4%     -   37s
     0     0 57915.8760    0 1280 43758.2679 57915.8760  32.4%     -   37s
     0     0 57660.7154    0 1274 43758.2679 57660.7154  31.8%     -   38s
     0     0 57577.9240    0 1317 43758.2679 57577.9240  31.6%     -   39s
     0     0 57560.0356    0 1315 43758.2679 57560.0356  31.5%     -   40s
     0     0 57240.9225    0 1304 43758.2679 57240.9225  30.8%     -   41s
     0     0 57143.4958    0 1330 43758.2679 57143.4958  30.6%     -   42s
     0     0 57120.1868    0 1344 43758.2679 57120.1868  30.5%     -   42s
     0     0 56937.7127    0 1283 43758.2679 56937.7127  30.1%     -   44s
     0     0 56937.7053    0 1283 43758.2679 56937.7053  30.1%     -   44s
     0     2 56937.3663    0 1283 43758.2679 56937.3663  30.1%     -   48s
     1     4 56734.7583    1 1165 43758.2679 56937.3663  30.1%  3416   51s
     7    16 55926.3579    3  924 43758.2679 56332.5062  28.7%  4731   55s
    31    28 52434.1496    5  688 43758.2679 54264.4752  24.0%  5790   60s
   496   324 44283.9709   20  229 43758.2679 52664.1212  20.4%   954   65s
  1413   507 44852.1709   19  120 43758.2679 50027.3849  14.3%   503   70s
  2551   294 44222.7026   13  207 43758.2679 46955.5321  7.31%   410   75s

Cutting planes:
  Gomory: 6
  Implied bound: 451
  MIR: 2386
  Flow cover: 1399
  Zero half: 17
  RLT: 82
  Relax-and-lift: 1044

Explored 3161 nodes (1320987 simplex iterations) in 77.21 seconds (156.27 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: 43758.3 43752.3 43712 ... 42847.7

Optimal solution found (tolerance 1.00e-06)
Best objective 4.375826793355e+04, best bound 4.375826793355e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 77.22s
  Master Objective (UB) = 43758.27, θ = 163760.77
  Upper Bound (UB) = 43758.27

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 163760.77
  [DEBUG]   ✓ Scenario 0: θ = 163760.77 ≤ Q = 163760.77 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x76abede8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x76abede8
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.437402e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 7510460.4850
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.308605e+05, 248 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -130860.47    0  123 7510460.49 -130860.47   102%     -    0s
H    0     0                    -95944.51495 -130860.47  36.4%     -    0s
*    0     0               0    -98915.27862 -98915.279  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 206

Explored 1 nodes (381 simplex iterations) in 0.01 seconds (0.01 work units)
Thread count was 32 (of 256 available processors)

Solution count 4: -98915.3 -95944.5 7.51046e+06 1.4374e+13 
No other solutions better than -98915.3

Optimal solution found (tolerance 1.00e-06)
Best objective -9.891527862036e+04, best bound -9.891527862036e+04, gap 0.0000%
  Subproblem solved in 0.03s
  Worst-case operational profit (Z_SP) = 129718.39
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -98915.28
  [DEBUG]   S×d_nominal = 228633.67
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 228633.67 + -98915.28 = 129718.39
  [DEBUG]   Current θ from Master = 163760.77
  [DEBUG]   ⚠️  Z_SP ≤ θ by 34042.38 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 9715.89
  Lower Bound (LB) = 9715.89
  Gap (UB-LB) = 34042.3810, Absolute Gap = 34042.3810, Relative Gap = 0.777965
  Not converged yet (gap = 34042.38 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 91999 nonzeros
Model fingerprint: 0xf2128b5b
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 9715.89 (0.01s)
MIP start from previous solve produced solution with objective 9715.89 (0.01s)
Loaded MIP start from previous solve with objective 9715.89

Presolve removed 13535 rows and 5494 columns
Presolve time: 0.29s
Presolved: 18428 rows, 9246 columns, 102088 nonzeros
Variable types: 6987 continuous, 2259 integer (2259 binary)

Root relaxation: objective 3.636372e+04, 11273 iterations, 1.61 seconds (3.48 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 36363.7177    0  416 9715.88691 36363.7177   274%     -    2s
H    0     0                    9862.4638356 36363.7177   269%     -    2s
H    0     0                    9865.8259771 36362.5761   269%     -    2s
     0     0 28878.7212    0  517 9865.82598 28878.7212   193%     -    3s
     0     0 28753.3526    0  520 9865.82598 28753.3526   191%     -    3s
     0     0 28748.9995    0  520 9865.82598 28748.9995   191%     -    3s
     0     0 28748.1148    0  523 9865.82598 28748.1148   191%     -    3s
     0     0 25463.5237    0  532 9865.82598 25463.5237   158%     -    4s
H    0     0                    9866.4542202 25452.6214   158%     -    5s
H    0     0                    9873.2175585 25452.6214   158%     -    5s
     0     0 25206.7427    0  539 9873.21756 25206.7427   155%     -    5s
     0     0 25195.7912    0  551 9873.21756 25195.7912   155%     -    5s
     0     0 25192.9781    0  545 9873.21756 25192.9781   155%     -    5s
     0     0 22700.6891    0  532 9873.21756 22700.6891   130%     -    7s
H    0     0                    9915.0701029 22700.0626   129%     -    7s
     0     0 22260.9363    0  549 9915.07010 22260.9363   125%     -    8s
     0     0 22171.6535    0  533 9915.07010 22171.6535   124%     -    8s
     0     0 22156.4596    0  541 9915.07010 22156.4596   123%     -    8s
     0     0 22150.6406    0  547 9915.07010 22150.6406   123%     -    8s
     0     0 22150.5321    0  547 9915.07010 22150.5321   123%     -    8s
     0     0 20960.6637    0  370 9915.07010 20960.6637   111%     -   10s
H    0     0                    10057.377500 20960.4991   108%     -   10s
     0     0 20809.4963    0  571 10057.3775 20809.4963   107%     -   11s
     0     0 20672.8202    0  385 10057.3775 20672.8202   106%     -   11s
     0     0 20654.9256    0  394 10057.3775 20654.9256   105%     -   11s
     0     0 20645.8105    0  626 10057.3775 20645.8105   105%     -   11s
     0     0 20641.5586    0  388 10057.3775 20641.5586   105%     -   11s
     0     0 20137.7719    0  625 10057.3775 20137.7719   100%     -   12s
H    0     0                    10157.731458 20137.1825  98.2%     -   12s
H    0     0                    10164.927799 20137.1825  98.1%     -   12s
     0     0 20013.1697    0  547 10164.9278 20013.1697  96.9%     -   13s
     0     0 19960.3382    0  722 10164.9278 19960.3382  96.4%     -   13s
     0     0 19948.0689    0  722 10164.9278 19948.0689  96.2%     -   13s
     0     0 19943.9025    0  662 10164.9278 19943.9025  96.2%     -   13s
     0     0 19837.5614    0  359 10164.9278 19837.5614  95.2%     -   14s
H    0     0                    10170.536753 19835.8545  95.0%     -   15s
H    0     0                    10462.156918 19835.8545  89.6%     -   15s
H    0     0                    10523.449290 19835.8545  88.5%     -   16s
     0     0 19751.4963    0  359 10523.4493 19751.4963  87.7%     -   16s
     0     0 19714.2645    0  360 10523.4493 19714.2645  87.3%     -   16s
     0     0 19706.7998    0  458 10523.4493 19706.7998  87.3%     -   16s
     0     0 19705.7996    0  369 10523.4493 19705.7996  87.3%     -   16s
     0     0 19660.2179    0  364 10523.4493 19660.2179  86.8%     -   17s
H    0     0                    10529.438628 19647.8798  86.6%     -   17s
     0     0 19626.6132    0  369 10529.4386 19626.6132  86.4%     -   17s
     0     0 19614.9406    0  457 10529.4386 19614.9406  86.3%     -   17s
     0     0 19611.6199    0  529 10529.4386 19611.6199  86.3%     -   17s
     0     0 19536.1943    0  439 10529.4386 19536.1943  85.5%     -   18s
     0     0 19512.8521    0  344 10529.4386 19512.8521  85.3%     -   18s
     0     0 19483.8062    0  362 10529.4386 19483.8062  85.0%     -   18s
     0     0 19474.9263    0  364 10529.4386 19474.9263  85.0%     -   18s
     0     0 19469.0532    0  352 10529.4386 19469.0532  84.9%     -   18s
     0     0 19467.5830    0  363 10529.4386 19467.5830  84.9%     -   18s
     0     0 19434.3770    0  372 10529.4386 19434.3770  84.6%     -   19s
     0     0 19425.2127    0  444 10529.4386 19425.2127  84.5%     -   19s
     0     0 19423.0909    0  452 10529.4386 19423.0909  84.5%     -   19s
     0     0 19405.0178    0  361 10529.4386 19405.0178  84.3%     -   20s
     0     0 19390.3093    0  366 10529.4386 19390.3093  84.2%     -   20s
     0     0 19381.2030    0  363 10529.4386 19381.2030  84.1%     -   20s
     0     0 19378.5612    0  365 10529.4386 19378.5612  84.0%     -   20s
     0     0 19365.1653    0  506 10529.4386 19365.1653  83.9%     -   20s
     0     0 19363.9654    0  506 10529.4386 19363.9654  83.9%     -   21s
H    0     0                    10536.360976 19363.9654  83.8%     -   22s
H    0     0                    10543.752557 19363.9127  83.7%     -   25s
     0     2 19363.9127    0  506 10543.7526 19363.9127  83.7%     -   25s
    61    68 15880.0683    6  447 10543.7526 17184.3676  63.0%  1099   31s
   627   226 10783.6415   19  148 10543.7526 16103.9661  52.7%   468   35s
  2489   672     cutoff   15      10543.7526 12516.5610  18.7%   267   40s

Cutting planes:
  Learned: 1
  Gomory: 12
  Implied bound: 6
  MIR: 1235
  Flow cover: 781
  Zero half: 11
  RLT: 80
  Relax-and-lift: 288

Explored 4835 nodes (1122755 simplex iterations) in 44.92 seconds (105.05 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: 10543.8 10536.4 10529.4 ... 9915.07

Optimal solution found (tolerance 1.00e-06)
Best objective 1.054375255738e+04, best bound 1.054375255738e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 44.93s
  Master Objective (UB) = 10543.75, θ = 131265.89
  Upper Bound (UB) = 10543.75

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 131265.89
  [DEBUG]   ✓ Scenario 0: θ = 131265.89 ≤ Q = 131265.89 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 131265.89 ≤ Q = 131265.89 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x4c1a26a1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x4c1a26a1
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.418592e+13
Presolve removed 2584 rows and 1877 columns
Presolve time: 0.00s
Presolved: 509 rows, 512 columns, 1435 nonzeros
Found heuristic solution: objective 7453585.9069
Variable types: 346 continuous, 166 integer (166 binary)

Root relaxation: objective -1.328941e+05, 260 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -132894.05    0  131 7453585.91 -132894.05   102%     -    0s
H    0     0                    -97364.48627 -132894.05  36.5%     -    0s
H    0     0                    -107040.9098 -132894.05  24.2%     -    0s
H    0     0                    -115088.0862 -132894.05  15.5%     -    0s
     0     0 -124025.69    0   87 -115088.09 -124025.69  7.77%     -    0s
H    0     0                    -122011.4183 -123982.63  1.62%     -    0s
     0     0 -123618.20    0   84 -122011.42 -123618.20  1.32%     -    0s
     0     0 -123136.28    0   49 -122011.42 -123136.28  0.92%     -    0s
H    0     0                    -122303.9953 -123097.17  0.65%     -    0s
     0     0 -122994.88    0   38 -122304.00 -122994.88  0.56%     -    0s
     0     0 -122990.77    0   39 -122304.00 -122990.77  0.56%     -    0s
     0     0 -122659.99    0   22 -122304.00 -122659.99  0.29%     -    0s
H    0     0                    -122313.3554 -122625.88  0.26%     -    0s
     0     0 -122561.35    0   22 -122313.36 -122561.35  0.20%     -    0s
     0     0 -122541.89    0   27 -122313.36 -122541.89  0.19%     -    0s
     0     0 -122529.90    0   20 -122313.36 -122529.90  0.18%     -    0s
     0     0 -122358.88    0   10 -122313.36 -122358.88  0.04%     -    0s
     0     0 -122341.63    0   10 -122313.36 -122341.63  0.02%     -    0s
*    0     0               0    -122320.6566 -122320.66  0.00%     -    0s

Cutting planes:
  Gomory: 4
  Implied bound: 4
  MIR: 3
  Flow cover: 7
  Relax-and-lift: 1

Explored 1 nodes (755 simplex iterations) in 0.10 seconds (0.05 work units)
Thread count was 32 (of 256 available processors)

Solution count 9: -122321 -122313 -122304 ... 1.41859e+13
No other solutions better than -122321

Optimal solution found (tolerance 1.00e-06)
Best objective -1.223206565794e+05, best bound -1.223206565794e+05, gap 0.0000%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 106686.87
  Scenario: 42 demand increases, 18 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -122320.66
  [DEBUG]   S×d_nominal = 229007.53
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 229007.53 + -122320.66 = 106686.87
  [DEBUG]   Current θ from Master = 131265.89
  [DEBUG]   ⚠️  Z_SP ≤ θ by 24579.02 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -14035.27
  Lower Bound (LB) = 9715.89
  Gap (UB-LB) = 827.8657, Absolute Gap = 827.8657, Relative Gap = 0.078517
  Not converged yet (gap = 827.87 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 42 increases, 18 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135239 nonzeros
Model fingerprint: 0x5a697a6c
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -14035.3 (0.01s)
Loaded MIP start from previous solve with objective -14035.3

Presolve removed 20301 rows and 8241 columns
Presolve time: 0.35s
Presolved: 26952 rows, 12739 columns, 165764 nonzeros
Variable types: 10480 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   39314    2.6652504e+04   0.000000e+00   1.616295e+06      5s
Concurrent spin time: 0.00s

Solved with dual simplex

Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   23471    2.7483067e+04   0.000000e+00   0.000000e+00      7s

Root relaxation: objective 2.748307e+04, 23471 iterations, 6.20 seconds (12.78 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 27483.0674    0  108 -14035.269 27483.0674   296%     -    6s
H    0     0                    -2698.861200 27483.0674  1118%     -    6s
H    0     0                    9254.7684084 27483.0674   197%     -    6s
H    0     0                    9613.1431350 27483.0674   186%     -    6s
H    0     0                    9869.8554170 27483.0674   178%     -    6s
H    0     0                    9930.1851391 27483.0674   177%     -    7s
H    0     0                    10107.866356 27483.0674   172%     -    7s
     0     0 24098.8226    0  217 10107.8664 24098.8226   138%     -    8s
H    0     0                    10170.536753 24098.8226   137%     -    8s
     0     0 24098.8226    0  225 10170.5368 24098.8226   137%     -    9s
     0     0 24098.8226    0  253 10170.5368 24098.8226   137%     -    9s
     0     0 24098.8226    0  253 10170.5368 24098.8226   137%     -    9s
     0     0 21840.8471    0  327 10170.5368 21840.8471   115%     -   11s
     0     0 21554.4458    0  337 10170.5368 21554.4458   112%     -   11s
     0     0 21432.9692    0  327 10170.5368 21432.9692   111%     -   11s
     0     0 21402.5797    0  262 10170.5368 21402.5797   110%     -   12s
     0     0 21401.8186    0  262 10170.5368 21401.8186   110%     -   12s
     0     0 21401.6301    0  336 10170.5368 21401.6301   110%     -   12s
     0     0 19929.6374    0  280 10170.5368 19929.6374  96.0%     -   15s
     0     0 19511.5621    0  338 10170.5368 19511.5621  91.8%     -   16s
     0     0 19342.6373    0  284 10170.5368 19342.6373  90.2%     -   16s
     0     0 19292.5015    0  357 10170.5368 19292.5015  89.7%     -   17s
     0     0 19283.6339    0  341 10170.5368 19283.6339  89.6%     -   17s
     0     0 19281.1209    0  353 10170.5368 19281.1209  89.6%     -   17s
     0     0 19279.5756    0  347 10170.5368 19279.5756  89.6%     -   17s
     0     0 19278.5578    0  358 10170.5368 19278.5578  89.6%     -   17s
     0     0 19278.4811    0  359 10170.5368 19278.4811  89.6%     -   17s
     0     0 18796.6591    0  322 10170.5368 18796.6591  84.8%     -   19s
     0     0 18694.6999    0  318 10170.5368 18694.6999  83.8%     -   20s
     0     0 18630.8779    0  317 10170.5368 18630.8779  83.2%     -   20s
     0     0 18582.0145    0  311 10170.5368 18582.0145  82.7%     -   20s
     0     0 18572.1422    0  379 10170.5368 18572.1422  82.6%     -   20s
     0     0 18566.4868    0  377 10170.5368 18566.4868  82.6%     -   21s
     0     0 18558.8817    0  318 10170.5368 18558.8817  82.5%     -   21s
     0     0 18556.8065    0  322 10170.5368 18556.8065  82.5%     -   21s
     0     0 18556.0776    0  323 10170.5368 18556.0776  82.4%     -   21s
     0     0 18409.6559    0  313 10170.5368 18409.6559  81.0%     -   22s
     0     0 18386.2858    0  319 10170.5368 18386.2858  80.8%     -   22s
     0     0 18383.7684    0  324 10170.5368 18383.7684  80.8%     -   22s
     0     0 18382.3945    0  323 10170.5368 18382.3945  80.7%     -   22s
     0     0 18380.2458    0  323 10170.5368 18380.2458  80.7%     -   22s
     0     0 18380.1081    0  322 10170.5368 18380.1081  80.7%     -   22s
     0     0 18340.2216    0  381 10170.5368 18340.2216  80.3%     -   23s
     0     0 18328.4450    0  328 10170.5368 18328.4450  80.2%     -   23s
     0     0 18326.8819    0  329 10170.5368 18326.8819  80.2%     -   23s
     0     0 18325.7639    0  333 10170.5368 18325.7639  80.2%     -   23s
     0     0 18248.4628    0  332 10170.5368 18248.4628  79.4%     -   24s
     0     0 18228.3033    0  342 10170.5368 18228.3033  79.2%     -   24s
     0     0 18208.2874    0  403 10170.5368 18208.2874  79.0%     -   25s
     0     0 18204.0650    0  403 10170.5368 18204.0650  79.0%     -   25s
     0     0 18203.6010    0  405 10170.5368 18203.6010  79.0%     -   25s
     0     0 18173.9407    0  400 10170.5368 18173.9407  78.7%     -   25s
     0     0 18168.5681    0  353 10170.5368 18168.5681  78.6%     -   26s
     0     0 18168.0373    0  404 10170.5368 18168.0373  78.6%     -   26s
     0     0 18155.2967    0  405 10170.5368 18155.2967  78.5%     -   27s
     0     0 18073.7316    0  388 10170.5368 18073.7316  77.7%     -   27s
     0     0 18048.9594    0  405 10170.5368 18048.9594  77.5%     -   28s
     0     0 18035.4663    0  408 10170.5368 18035.4663  77.3%     -   28s
     0     0 18023.9099    0  404 10170.5368 18023.9099  77.2%     -   28s
     0     0 18018.0189    0  353 10170.5368 18018.0189  77.2%     -   28s
     0     0 18015.4122    0  415 10170.5368 18015.4122  77.1%     -   28s
     0     0 18014.8480    0  412 10170.5368 18014.8480  77.1%     -   28s
     0     0 17997.3281    0  415 10170.5368 17997.3281  77.0%     -   29s
     0     0 17991.9774    0  414 10170.5368 17991.9774  76.9%     -   29s
     0     0 17990.0129    0  359 10170.5368 17990.0129  76.9%     -   29s
     0     0 17989.0166    0  352 10170.5368 17989.0166  76.9%     -   29s
     0     0 17985.5014    0  354 10170.5368 17985.5014  76.8%     -   29s
     0     0 17982.6520    0  412 10170.5368 17982.6520  76.8%     -   30s
     0     0 17982.0993    0  368 10170.5368 17982.0993  76.8%     -   30s
     0     0 17977.0628    0  415 10170.5368 17977.0628  76.8%     -   30s
     0     0 17974.6796    0  413 10170.5368 17974.6796  76.7%     -   30s
     0     0 17974.1761    0  418 10170.5368 17974.1761  76.7%     -   30s
     0     0 17972.5924    0  414 10170.5368 17972.5924  76.7%     -   31s
     0     0 17969.2549    0  414 10170.5368 17969.2549  76.7%     -   31s
     0     0 17969.2549    0  356 10170.5368 17969.2549  76.7%     -   31s
     0     0 17968.7494    0  413 10170.5368 17968.7494  76.7%     -   31s
     0     0 17967.7781    0  413 10170.5368 17967.7781  76.7%     -   32s
     0     2 17967.1139    0  413 10170.5368 17967.1139  76.7%     -   37s
     7    16 17283.0561    3  401 10170.5368 17379.0307  70.9%  1697   40s
    95   126 16364.2115    7  393 10170.5368 16639.9108  63.6%  1472   45s
   225   233 15591.6327   10  421 10170.5368 16411.7486  61.4%  1108   50s
   370   356 15349.1413   13  372 10170.5368 16411.7486  61.4%  1052   55s
   550   475 10577.2255   15  384 10170.5368 16259.1123  59.9%   923   60s
   726   600 14107.3381   17  261 10170.5368 16127.7607  58.6%   864   65s
   975   696     cutoff   18      10170.5368 16105.1882  58.4%   790   72s
  1137   789 13471.1312   21  275 10170.5368 16105.1882  58.4%   769   76s
  1446  1007 13133.0453   23  266 10170.5368 15920.6335  56.5%   724   81s
  1862  1289 10387.8209   25  155 10170.5368 15861.5733  56.0%   651   85s
  2249  1434 12479.9374   27  191 10170.5368 15700.1670  54.4%   625   92s
  2434  1504 infeasible   28      10170.5368 15653.6131  53.9%   610   95s
  2983  1641 13855.0282   11  317 10170.5368 15391.5092  51.3%   600  102s
  3137  1677 12164.0530   14  122 10170.5368 15296.2376  50.4%   602  105s
  3483  1741     cutoff   25      10170.5368 15147.0993  48.9%   601  110s
  3879  1873 12945.3167   23  136 10170.5368 15103.2366  48.5%   603  117s
  4107  1960 11827.2316   27  130 10170.5368 15050.4439  48.0%   604  120s
  4555  2060 10721.8960    7   82 10170.5368 14986.6314  47.4%   598  127s
  4795  2149 10577.2273   16   57 10170.5368 14910.3770  46.6%   599  130s
  5419  2358 14144.9350   13  192 10170.5368 14761.9881  45.1%   583  136s
  5715  2359 12108.3443   19  413 10170.5368 14729.7223  44.8%   583  143s
  5717  2360 10973.7498   29  108 10170.5368 14729.7223  44.8%   583  149s
  5718  2361 12533.7446   20  343 10170.5368 14729.7223  44.8%   582  152s
  5720  2362 10804.0216   21  504 10170.5368 14729.7223  44.8%   582  156s
  5728  2368 11499.1263   23  347 10170.5368 14729.7223  44.8%   581  160s
  5734  2372 12413.7584   19  409 10170.5368 14729.7223  44.8%   581  165s
  5739  2375 10937.5787   19  569 10170.5368 14729.7223  44.8%   580  170s
  5743  2378 12573.2337   13  537 10170.5368 14729.7223  44.8%   580  180s
  5745  2382 14729.7223   12  529 10170.5368 14729.7223  44.8%   590  185s
  5759  2401 14729.7223   15  265 10170.5368 14729.7223  44.8%   593  191s
  5803  2427 14729.7223   17  323 10170.5368 14729.7223  44.8%   605  196s
  5872  2465 14365.2647   19  330 10170.5368 14729.7223  44.8%   616  200s
  5994  2470 13772.4635   20  313 10170.5368 14729.7223  44.8%   619  205s
  6204  2417 13444.8619   21  214 10170.5368 14729.7223  44.8%   625  211s
  6421  2342     cutoff   25      10170.5368 14729.7223  44.8%   630  217s
  6559  2274 14371.6864   22  103 10170.5368 14729.7223  44.8%   637  221s
  6694  2217 10279.1914   23   47 10170.5368 13680.9165  34.5%   642  226s
  6950  2060 11013.5484   19  381 10170.5368 13282.7203  30.6%   644  232s
  7029  1991 10657.1823   20  356 10170.5368 13282.7203  30.6%   646  235s
  7187  1899 10758.1432   27  219 10170.5368 10758.1432  5.78%   648  240s

Cutting planes:
  MIR: 156
  Flow cover: 341
  GUB cover: 1
  Zero half: 13
  RLT: 5
  Relax-and-lift: 21

Explored 7192 nodes (4731016 simplex iterations) in 240.34 seconds (637.76 work units)
Thread count was 32 (of 256 available processors)

Solution count 8: 10170.5 10107.9 9930.19 ... -14035.3

Optimal solution found (tolerance 1.00e-06)
Best objective 1.017053675257e+04, best bound 1.017053675257e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 240.35s
  Master Objective (UB) = 10170.54, θ = 128561.29
  Upper Bound (UB) = 10170.54

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 128561.29
  [DEBUG]   ✓ Scenario 0: θ = 128561.29 ≤ Q = 128561.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 128561.29 ≤ Q = 128561.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 128561.29 ≤ Q = 128561.29 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x7c1f4311
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x7c1f4311
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.438496e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 7432760.9203
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.393760e+05, 258 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -139375.96    0  128 7432760.92 -139375.96   102%     -    0s
H    0     0                    -101087.4391 -139375.96  37.9%     -    0s
H    0     0                    -112530.2460 -120162.98  6.78%     -    0s
H    0     0                    -116061.2850 -120162.98  3.53%     -    0s
     0     0 -120162.98    0   50 -116061.29 -120162.98  3.53%     -    0s
H    0     0                    -118537.6821 -120150.41  1.36%     -    0s
H    0     0                    -119332.1925 -120150.41  0.69%     -    0s
     0     0 -119956.63    0   37 -119332.19 -119956.63  0.52%     -    0s
     0     0 -119901.86    0   48 -119332.19 -119901.86  0.48%     -    0s
     0     0 -119509.25    0   18 -119332.19 -119509.25  0.15%     -    0s
     0     0 -119509.25    0   19 -119332.19 -119509.25  0.15%     -    0s
H    0     0                    -119381.4435 -119509.25  0.11%     -    0s
     0     0 -119413.58    0   11 -119381.44 -119413.58  0.03%     -    0s
     0     0 -119413.14    0   11 -119381.44 -119413.14  0.03%     -    0s
     0     0 -119412.45    0   10 -119381.44 -119412.45  0.03%     -    0s
     0     0 -119412.43    0   10 -119381.44 -119412.43  0.03%     -    0s
H    0     0                    -119387.3926 -119410.41  0.02%     -    0s
     0     0 -119408.21    0    8 -119387.39 -119408.21  0.02%     -    0s
     0     0 -119407.58    0    6 -119387.39 -119407.58  0.02%     -    0s
     0     0 -119407.08    0    3 -119387.39 -119407.08  0.02%     -    0s
     0     0 -119402.78    0    5 -119387.39 -119402.78  0.01%     -    0s
H    0     0                    -119401.3961 -119402.78  0.00%     -    0s
     0     0     cutoff    0      -119401.40 -119401.40  0.00%     -    0s

Cutting planes:
  Gomory: 3
  Implied bound: 2
  MIR: 9
  Flow cover: 5
  RLT: 1
  Relax-and-lift: 3

Explored 1 nodes (629 simplex iterations) in 0.11 seconds (0.03 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -119401 -119387 -119381 ... 7.43276e+06
No other solutions better than -119401

Optimal solution found (tolerance 1.00e-06)
Best objective -1.194013961128e+05, best bound -1.194013961128e+05, gap 0.0000%
  Subproblem solved in 0.12s
  Worst-case operational profit (Z_SP) = 110025.24
  Scenario: 17 demand increases, 43 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -119401.40
  [DEBUG]   S×d_nominal = 229426.63
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 229426.63 + -119401.40 = 110025.24
  [DEBUG]   Current θ from Master = 128561.29
  [DEBUG]   ⚠️  Z_SP ≤ θ by 18536.06 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -8365.52
  Lower Bound (LB) = 9715.89
  Gap (UB-LB) = 454.6498, Absolute Gap = 454.6498, Relative Gap = 0.044703
  Not converged yet (gap = 454.65 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 17 increases, 43 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178479 nonzeros
Model fingerprint: 0x9f762437
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -8365.52 (0.06s)
MIP start from previous solve produced solution with objective -8365.52 (0.07s)
Loaded MIP start from previous solve with objective -8365.52

Presolve removed 27068 rows and 10988 columns
Presolve time: 0.46s
Presolved: 35475 rows, 16232 columns, 219179 nonzeros
Variable types: 13973 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 35475 rows, 16232 columns, 219179 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   43982    2.3606185e+04   0.000000e+00   3.333358e+06      5s
Concurrent spin time: 1.31s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 2.744634e+04, 31328 iterations, 6.34 seconds (13.82 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 27446.3411    0  112 -8365.5197 27446.3411   428%     -    7s
H    0     0                    -5340.931757 27446.3411   614%     -    7s
H    0     0                    5837.3846275 27446.3411   370%     -    7s
H    0     0                    6013.6035460 27446.3411   356%     -    7s
H    0     0                    6052.8623340 27446.3411   353%     -    7s
H    0     0                    9799.8714835 27446.3411   180%     -    7s
H    0     0                    10105.362096 27446.3411   172%     -    7s
H    0     0                    10126.050891 24552.7786   142%     -   10s
     0     0 24299.4467    0  217 10126.0509 24299.4467   140%     -   10s
     0     0 24078.1424    0  232 10126.0509 24078.1424   138%     -   11s
     0     0 24078.1424    0  249 10126.0509 24078.1424   138%     -   12s
     0     0 24078.1424    0  253 10126.0509 24078.1424   138%     -   12s
     0     0 24078.1424    0  253 10126.0509 24078.1424   138%     -   12s
     0     0 24078.1424    0  253 10126.0509 24078.1424   138%     -   12s
     0     0 21639.9952    0  318 10126.0509 21639.9952   114%     -   15s
     0     0 21344.8825    0  332 10126.0509 21344.8825   111%     -   16s
     0     0 21314.4593    0  332 10126.0509 21314.4593   110%     -   16s
     0     0 21280.6630    0  333 10126.0509 21280.6630   110%     -   16s
     0     0 21272.1774    0  264 10126.0509 21272.1774   110%     -   17s
     0     0 21267.7454    0  338 10126.0509 21267.7454   110%     -   17s
     0     0 21265.1678    0  344 10126.0509 21265.1678   110%     -   17s
     0     0 21261.4539    0  340 10126.0509 21261.4539   110%     -   17s
     0     0 21261.4539    0  340 10126.0509 21261.4539   110%     -   17s
     0     0 19783.8904    0  358 10126.0509 19783.8904  95.4%     -   21s
     0     0 19418.0564    0  349 10126.0509 19418.0564  91.8%     -   23s
     0     0 19286.9065    0  309 10126.0509 19286.9065  90.5%     -   24s
     0     0 19274.7154    0  361 10126.0509 19274.7154  90.3%     -   25s
     0     0 19272.1219    0  308 10126.0509 19272.1219  90.3%     -   25s
     0     0 19270.6685    0  308 10126.0509 19270.6685  90.3%     -   25s
     0     0 19270.6238    0  308 10126.0509 19270.6238  90.3%     -   25s
     0     0 18830.6663    0  307 10126.0509 18830.6663  86.0%     -   27s
     0     0 18749.7933    0  302 10126.0509 18749.7933  85.2%     -   28s
     0     0 18702.2543    0  311 10126.0509 18702.2543  84.7%     -   28s
     0     0 18661.5481    0  313 10126.0509 18661.5481  84.3%     -   29s
     0     0 18660.7872    0  312 10126.0509 18660.7872  84.3%     -   29s
     0     0 18484.5400    0  353 10126.0509 18484.5400  82.5%     -   30s
     0     0 18338.6263    0  359 10126.0509 18338.6263  81.1%     -   31s
     0     0 18270.0257    0  365 10126.0509 18270.0257  80.4%     -   32s
     0     0 18259.1305    0  371 10126.0509 18259.1305  80.3%     -   32s
     0     0 18254.8782    0  373 10126.0509 18254.8782  80.3%     -   32s
     0     0 18251.8034    0  373 10126.0509 18251.8034  80.2%     -   32s
     0     0 18250.7853    0  379 10126.0509 18250.7853  80.2%     -   33s
     0     0 18186.6225    0  320 10126.0509 18186.6225  79.6%     -   34s
     0     0 18168.5748    0  313 10126.0509 18168.5748  79.4%     -   35s
     0     0 18165.9443    0  399 10126.0509 18165.9443  79.4%     -   35s
     0     0 18165.7349    0  396 10126.0509 18165.7349  79.4%     -   35s
     0     0 18155.7369    0  316 10126.0509 18155.7369  79.3%     -   35s
     0     0 18149.8989    0  400 10126.0509 18149.8989  79.2%     -   36s
     0     0 18149.5048    0  400 10126.0509 18149.5048  79.2%     -   36s
     0     0 18147.3112    0  405 10126.0509 18147.3112  79.2%     -   36s
     0     0 18146.4940    0  401 10126.0509 18146.4940  79.2%     -   37s
     0     0 18144.6886    0  391 10126.0509 18144.6886  79.2%     -   37s
     0     0 18140.3413    0  399 10126.0509 18140.3413  79.1%     -   38s
     0     0 18140.3413    0  397 10126.0509 18140.3413  79.1%     -   38s
     0     0 18140.3413    0  397 10126.0509 18140.3413  79.1%     -   38s
     0     2 18140.3413    0  397 10126.0509 18140.3413  79.1%     -   43s
     3     8 17709.6811    2  345 10126.0509 17915.0455  76.9%  2703   47s
    15    32 17293.5806    4  408 10126.0509 17554.6828  73.4%  2751   50s
    95   158 16898.4442    7  425 10126.0509 16961.2412  67.5%  2339   56s
   246   273 16379.8588    9  419 10126.0509 16958.0239  67.5%  1748   61s
   390   388 16113.0558   10  393 10126.0509 16899.4358  66.9%  1610   65s
   521   480 11170.8290   11  222 10126.0509 16899.4358  66.9%  1559   70s
   645   555 11866.2572   12  233 10126.0509 16898.2938  66.9%  1644   75s
   771   661 15690.0866   15  413 10126.0509 16898.2938  66.9%  1669   81s
   869   729 15398.0052   19  391 10126.0509 16898.2938  66.9%  1657   86s
   958   798 14005.8491   21  362 10126.0509 16898.2938  66.9%  1698   91s
  1068   871 13439.8603   22  426 10126.0509 16898.2938  66.9%  1712   96s
  1196   961 13062.9089   25  370 10126.0509 16898.2938  66.9%  1711  101s
  1340  1018 12981.2188   26  371 10126.0509 16737.9524  65.3%  1717  106s
  1496  1081 11768.0886   29  293 10126.0509 16737.9524  65.3%  1716  112s
  1570  1121     cutoff   32      10126.0509 16737.9524  65.3%  1729  115s
  1721  1240 10985.2183   33  252 10126.0509 16300.2645  61.0%  1753  121s
  1823  1307     cutoff   35      10126.0509 16237.9466  60.4%  1740  125s
  2106  1407 13678.6494   13  322 10126.0509 16211.0737  60.1%  1704  131s
  2344  1567 12066.5594   20  294 10126.0509 16211.0737  60.1%  1715  137s
  2487  1652 11697.4579   26  339 10126.0509 16211.0737  60.1%  1714  142s
  2645  1724 10740.2946   32  269 10126.0509 16211.0737  60.1%  1702  145s
  2986  1823 12125.8911   14  143 10126.0509 15923.7252  57.3%  1689  153s
  3149  1893 11782.3148   15  180 10126.0509 15923.7252  57.3%  1699  158s
  3328  1952     cutoff   17      10126.0509 15722.6270  55.3%  1688  162s
  3500  2004     cutoff   19      10126.0509 15651.0385  54.6%  1683  167s
  3650  2067 14260.1254   14  380 10126.0509 15588.0612  53.9%  1674  172s
  3871  2133 infeasible   18      10126.0509 15556.3428  53.6%  1656  177s
  4094  2192 12664.9772   22  162 10126.0509 15548.4812  53.5%  1647  181s
  4321  2251 11984.8133   27  234 10126.0509 15537.3070  53.4%  1645  187s
  4524  2316 11068.9640   31  231 10126.0509 15459.0758  52.7%  1654  191s
  4753  2399     cutoff   32      10126.0509 15446.5032  52.5%  1646  197s
  4964  2469     cutoff   35      10126.0509 15409.7933  52.2%  1653  203s
  5232  2584 13227.4599   13  176 10126.0509 15409.7933  52.2%  1649  209s
  5480  2585 13906.2604   16  397 10126.0509 15409.7933  52.2%  1653  221s
  5482  2586 12527.6076   19  112 10126.0509 15409.7933  52.2%  1652  230s
  5484  2588 11342.7154   17  363 10126.0509 15409.7933  52.2%  1652  238s
  5485  2588 11815.6647   37  351 10126.0509 15409.7933  52.2%  1651  240s
  5491  2592 13442.1588   16  311 10126.0509 15409.7933  52.2%  1649  245s
  5496  2596 14717.2974    9  448 10126.0509 15409.7933  52.2%  1648  250s
  5500  2598 13921.9006   12  505 10126.0509 15409.7933  52.2%  1647  256s
  5502  2600 14358.9972   13  511 10126.0509 15409.7933  52.2%  1646  260s
  5507  2603 12845.5871   10  526 10126.0509 15409.7933  52.2%  1645  265s
  5510  2605 12405.7872   17  557 10126.0509 15409.7933  52.2%  1644  270s
  5512  2606 11901.8453   40  346 10126.0509 15409.7933  52.2%  1643  280s
  5514  2611 15409.7933   15  516 10126.0509 15409.7933  52.2%  1658  286s
  5520  2621 15409.7933   17  493 10126.0509 15409.7933  52.2%  1660  292s
  5528  2634 15296.2217   18  383 10126.0509 15409.7933  52.2%  1661  296s
  5576  2665 14711.1609   20  408 10126.0509 15409.7933  52.2%  1675  302s
  5608  2675 14601.0169   21  417 10126.0509 15409.7933  52.2%  1682  307s
  5651  2683 14479.1775   22  409 10126.0509 15409.7933  52.2%  1691  312s
  5695  2690 12601.2574   22  328 10126.0509 15409.7933  52.2%  1693  315s
  5828  2671 13333.4746   23  319 10126.0509 15409.7933  52.2%  1689  323s
  5909  2666 12412.0106   24  324 10126.0509 15409.7933  52.2%  1683  326s
  6084  2615 11709.0202   25  342 10126.0509 15409.7933  52.2%  1664  333s
  6158  2571 11296.8444   26  409 10126.0509 14604.7843  44.2%  1657  336s
  6306  2512 11039.5776   28  367 10126.0509 14447.7311  42.7%  1643  343s
  6356  2508 10595.5872   30  301 10126.0509 14447.7311  42.7%  1640  346s
  6476  2469     cutoff   25      10126.0509 14447.7311  42.7%  1632  354s
  6550  2448     cutoff   25      10126.0509 13878.1285  37.1%  1628  356s
  6609  2438 12752.3154   31  129 10126.0509 13878.1285  37.1%  1622  360s
  6786  2349     cutoff   34      10126.0509 13579.3131  34.1%  1606  367s
  6896  2304 10266.4845   36  175 10126.0509 13373.8250  32.1%  1596  371s
  7095  2173     cutoff   32      10126.0509 13113.7987  29.5%  1576  378s
  7210  2083     cutoff   29      10126.0509 12955.0096  27.9%  1567  383s
  7305  2020 infeasible   31      10126.0509 12196.4772  20.4%  1557  386s

Cutting planes:
  MIR: 173
  Flow cover: 500
  Zero half: 16
  RLT: 3
  Relax-and-lift: 31

Explored 7379 nodes (11499332 simplex iterations) in 388.92 seconds (1126.69 work units)
Thread count was 32 (of 256 available processors)

Solution count 8: 10126.1 10105.4 9799.87 ... -8365.52

Optimal solution found (tolerance 1.00e-06)
Best objective 1.012605089078e+04, best bound 1.012605089078e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 388.92s
  Master Objective (UB) = 10126.05, θ = 128018.70
  Upper Bound (UB) = 10126.05

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 128018.70
  [DEBUG]   ✓ Scenario 0: θ = 128018.70 ≤ Q = 128018.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 128018.70 ≤ Q = 128018.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 128018.70 ≤ Q = 128018.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 128018.70 ≤ Q = 128018.70 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x668596f3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x668596f3
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.439285e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 7425480.1152
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.334964e+05, 250 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -133496.36    0  124 7425480.12 -133496.36   102%     -    0s
H    0     0                    -98461.04391 -133496.36  35.6%     -    0s
     0     0 -104788.56    0   36 -98461.044 -104788.56  6.43%     -    0s
H    0     0                    -103677.5567 -104722.75  1.01%     -    0s
     0     0 -104492.48    0   37 -103677.56 -104492.48  0.79%     -    0s
     0     0 -104451.53    0   34 -103677.56 -104451.53  0.75%     -    0s
H    0     0                    -103949.9747 -104451.53  0.48%     -    0s
H    0     0                    -103953.2759 -104451.53  0.48%     -    0s
H    0     0                    -103981.7777 -104451.53  0.45%     -    0s
     0     0 -104191.70    0   18 -103981.78 -104191.70  0.20%     -    0s
     0     0 -104191.70    0   12 -103981.78 -104191.70  0.20%     -    0s
     0     0 -104150.14    0   17 -103981.78 -104150.14  0.16%     -    0s
     0     0 -104145.72    0   14 -103981.78 -104145.72  0.16%     -    0s
     0     0 -104101.08    0   13 -103981.78 -104101.08  0.11%     -    0s
     0     0 -104101.08    0   57 -103981.78 -104101.08  0.11%     -    0s
     0     0 -104042.56    0    6 -103981.78 -104042.56  0.06%     -    0s
H    0     0                    -104004.8968 -104037.43  0.03%     -    0s
     0     0 -104037.40    0    2 -104004.90 -104037.40  0.03%     -    0s
H    0     0                    -104032.1837 -104037.40  0.01%     -    0s

Cutting planes:
  Gomory: 4
  Implied bound: 18
  MIR: 51
  Flow cover: 7

Explored 1 nodes (719 simplex iterations) in 0.07 seconds (0.04 work units)
Thread count was 32 (of 256 available processors)

Solution count 7: -104032 -104005 -103982 ... 1.43928e+13
No other solutions better than -104032

Optimal solution found (tolerance 1.00e-06)
Best objective -1.040321837452e+05, best bound -1.040321837452e+05, gap 0.0000%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 125394.45
  Scenario: 13 demand increases, 47 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -104032.18
  [DEBUG]   S×d_nominal = 229426.63
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 229426.63 + -104032.18 = 125394.45
  [DEBUG]   Current θ from Master = 128018.70
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2624.25 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 7501.80
  Lower Bound (LB) = 9715.89
  Gap (UB-LB) = 410.1640, Absolute Gap = 410.1640, Relative Gap = 0.040506
  Not converged yet (gap = 410.16 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 13 increases, 47 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221719 nonzeros
Model fingerprint: 0x542a29b7
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 33835 rows and 13735 columns
Presolve time: 0.77s
Presolved: 43998 rows, 19725 columns, 272594 nonzeros
Variable types: 17466 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -370520.0379
Found heuristic solution: objective -195169.7862

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 43998 rows, 19725 columns, 272594 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   32836    1.0869643e+04   0.000000e+00   2.439765e+06      5s
   43736    1.7093909e+04   0.000000e+00   1.302311e+06     10s
Concurrent spin time: 2.80s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 2.744634e+04, 42515 iterations, 12.25 seconds (24.62 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 27446.3411    0  112 -195169.79 27446.3411   114%     -   13s
H    0     0                    -188232.2865 27446.3411   115%     -   13s
H    0     0                    -146321.0918 27446.3411   119%     -   13s
H    0     0                    -139826.4506 27446.3411   120%     -   13s
H    0     0                    -139812.5368 27446.3411   120%     -   13s
H    0     0                    -138700.1438 27446.3411   120%     -   13s
H    0     0                    -48640.42807 27446.3411   156%     -   13s
H    0     0                    -13791.81382 27446.3411   299%     -   13s
H    0     0                    5980.4100018 27446.3411   359%     -   13s
H    0     0                    6013.6035460 27446.3411   356%     -   13s
     0     0 24278.7112    0  222 6013.60355 24278.7112   304%     -   18s
H    0     0                    7401.8175974 24278.7112   228%     -   18s
H    0     0                    7905.8261908 24278.7112   207%     -   18s
H    0     0                    8034.1195055 24278.7112   202%     -   19s
H    0     0                    8053.0291858 24278.7112   201%     -   19s
     0     0 24278.7112    0  222 8053.02919 24278.7112   201%     -   19s
     0     0 24278.7112    0  223 8053.02919 24278.7112   201%     -   20s
     0     0 24147.9292    0  247 8053.02919 24147.9292   200%     -   20s
     0     0 24145.1349    0  249 8053.02919 24145.1349   200%     -   20s
     0     0 24145.1349    0  249 8053.02919 24145.1349   200%     -   20s
     0     0 21680.2845    0  328 8053.02919 21680.2845   169%     -   24s
     0     0 21218.7509    0  326 8053.02919 21218.7509   163%     -   25s
     0     0 21143.2332    0  339 8053.02919 21143.2332   163%     -   26s
     0     0 21049.9083    0  345 8053.02919 21049.9083   161%     -   26s
     0     0 21031.5497    0  346 8053.02919 21031.5497   161%     -   27s
     0     0 21030.1901    0  347 8053.02919 21030.1901   161%     -   27s
     0     0 21030.1374    0  349 8053.02919 21030.1374   161%     -   27s
H    0     0                    9837.7729491 19642.3934   100%     -   32s
H    0     0                    10057.715156 19642.3934  95.3%     -   32s
     0     0 19642.3934    0  353 10057.7152 19642.3934  95.3%     -   32s
H    0     0                    10081.668130 19640.8309  94.8%     -   32s
     0     0 19234.5053    0  308 10081.6681 19234.5053  90.8%     -   33s
     0     0 19068.5022    0  362 10081.6681 19068.5022  89.1%     -   35s
     0     0 19006.6975    0  309 10081.6681 19006.6975  88.5%     -   35s
     0     0 18986.1669    0  304 10081.6681 18986.1669  88.3%     -   36s
     0     0 18975.1199    0  304 10081.6681 18975.1199  88.2%     -   36s
     0     0 18969.3438    0  371 10081.6681 18969.3438  88.2%     -   36s
     0     0 18968.2581    0  310 10081.6681 18968.2581  88.1%     -   36s
     0     0 18968.2429    0  310 10081.6681 18968.2429  88.1%     -   36s
     0     0 18616.3806    0  366 10081.6681 18616.3806  84.7%     -   41s
H    0     0                    10092.687101 18616.1226  84.5%     -   41s
     0     0 18503.2876    0  373 10092.6871 18503.2876  83.3%     -   42s
     0     0 18399.5346    0  356 10092.6871 18399.5346  82.3%     -   44s
     0     0 18392.9828    0  364 10092.6871 18392.9828  82.2%     -   44s
     0     0 18383.1632    0  351 10092.6871 18383.1632  82.1%     -   44s
     0     0 18382.4777    0  359 10092.6871 18382.4777  82.1%     -   44s
     0     0 18257.6459    0  305 10092.6871 18257.6459  80.9%     -   46s
     0     0 18254.1036    0  316 10092.6871 18254.1036  80.9%     -   46s
     0     0 18250.9595    0  382 10092.6871 18250.9595  80.8%     -   46s
     0     0 18249.4796    0  319 10092.6871 18249.4796  80.8%     -   47s
     0     0 18249.2532    0  322 10092.6871 18249.2532  80.8%     -   47s
     0     0 18203.8536    0  379 10092.6871 18203.8536  80.4%     -   48s
     0     0 18185.3806    0  381 10092.6871 18185.3806  80.2%     -   49s
     0     0 18177.3821    0  383 10092.6871 18177.3821  80.1%     -   50s
     0     0 18173.7764    0  380 10092.6871 18173.7764  80.1%     -   50s
     0     0 18173.3964    0  387 10092.6871 18173.3964  80.1%     -   50s
     0     0 18118.0803    0  486 10092.6871 18118.0803  79.5%     -   52s
     0     0 18107.4416    0  383 10092.6871 18107.4416  79.4%     -   52s
     0     0 18102.7758    0  382 10092.6871 18102.7758  79.4%     -   52s
     0     0 18102.0233    0  384 10092.6871 18102.0233  79.4%     -   53s
     0     0 18075.6230    0  385 10092.6871 18075.6230  79.1%     -   54s
     0     0 18052.9908    0  483 10092.6871 18052.9908  78.9%     -   55s
     0     0 18041.7875    0  484 10092.6871 18041.7875  78.8%     -   55s
     0     0 18035.6373    0  472 10092.6871 18035.6373  78.7%     -   55s
     0     0 18033.9926    0  484 10092.6871 18033.9926  78.7%     -   56s
     0     0 18033.7311    0  484 10092.6871 18033.7311  78.7%     -   56s
     0     0 18003.9604    0  483 10092.6871 18003.9604  78.4%     -   57s
     0     0 17988.8891    0  388 10092.6871 17988.8891  78.2%     -   57s
     0     0 17982.7886    0  442 10092.6871 17982.7886  78.2%     -   58s
     0     0 17980.9142    0  387 10092.6871 17980.9142  78.2%     -   58s
     0     0 17979.5008    0  396 10092.6871 17979.5008  78.1%     -   58s
     0     0 17979.2669    0  387 10092.6871 17979.2669  78.1%     -   58s
     0     0 17962.5318    0  375 10092.6871 17962.5318  78.0%     -   59s
     0     0 17960.0269    0  380 10092.6871 17960.0269  78.0%     -   60s
     0     0 17959.0163    0  399 10092.6871 17959.0163  77.9%     -   60s
     0     0 17956.6179    0  403 10092.6871 17956.6179  77.9%     -   61s
     0     0 17954.4467    0  462 10092.6871 17954.4467  77.9%     -   61s
     0     0 17954.0757    0  457 10092.6871 17954.0757  77.9%     -   61s
     0     0 17953.7536    0  405 10092.6871 17953.7536  77.9%     -   62s
     0     0 17953.6470    0  403 10092.6871 17953.6470  77.9%     -   64s
     0     0 17949.7915    0  397 10092.6871 17949.7915  77.8%     -   65s
     0     0 17949.1405    0  397 10092.6871 17949.1405  77.8%     -   65s
     0     2 17949.0031    0  397 10092.6871 17949.0031  77.8%     -   72s
     7    16 17836.6594    3  298 10092.6871 17924.3330  77.6%  1725   78s
    15    32 17454.5848    4  305 10092.6871 17836.6112  76.7%  2708   81s
    31    64 17358.0618    5  423 10092.6871 17454.5152  72.9%  3165   85s
    95   140 17083.7788    7  378 10092.6871 17356.2959  72.0%  2408   91s
   139   202 17036.6633    8  380 10092.6871 17356.2959  72.0%  2460   96s
   205   259 16398.7582    8  308 10092.6871 17356.2959  72.0%  2339  100s
   271   310 12965.4457    9  464 10092.6871 17356.2959  72.0%  2364  105s
   414   406 16300.8784   10  368 10092.6871 17356.2959  72.0%  2041  111s
   461   437 16728.6322   10  371 10092.6871 16928.6980  67.7%  1953  115s
   510   474 16577.5355   12  363 10092.6871 16928.6980  67.7%  1908  120s
   599   534 15694.2072   13  293 10092.6871 16928.6980  67.7%  1863  128s
   643   564 16151.3706   14  398 10092.6871 16928.6980  67.7%  1850  132s
   690   599 14568.7743   14  263 10092.6871 16928.6980  67.7%  1844  137s
   737   638 15998.9063   15  406 10092.6871 16928.6980  67.7%  1919  141s
   786   665 15901.2215   16  416 10092.6871 16928.6980  67.7%  1912  145s
   833   704 15805.4636   17  396 10092.6871 16928.6980  67.7%  1907  150s
   946   769 14521.0273   19  372 10092.6871 16928.6980  67.7%  1872  156s
   997   803 14676.9871   20  386 10092.6871 16928.6980  67.7%  1854  161s
  1113   913 14539.6229   21  381 10092.6871 16928.6980  67.7%  1791  169s
  1191   974 13981.2356   22  447 10092.6871 16928.6980  67.7%  1763  174s
  1283  1042 13523.4490   23  424 10092.6871 16928.6980  67.7%  1728  178s
  1384  1110 13400.6267   23  312 10092.6871 16928.6980  67.7%  1685  184s
  1486  1149 12751.4623   25  345 10092.6871 16928.6980  67.7%  1665  187s
  1549  1206 12861.8846   25  312 10092.6871 16928.6980  67.7%  1653  191s
  1642  1259 infeasible   26      10092.6871 16885.3297  67.3%  1636  198s
  1745  1326 12026.6970   27  402 10092.6871 16626.1961  64.7%  1621  204s
  1873  1383 11277.7986   30  376 10092.6871 16626.1961  64.7%  1595  209s
  1988  1451 11027.7173   32  357 10092.6871 16626.1961  64.7%  1586  214s
  2114  1491 10580.9090   37  392 10092.6871 16626.1961  64.7%  1557  218s
  2200  1563 infeasible   39      10092.6871 16554.7218  64.0%  1552  223s
  2322  1660 15946.2568   10  277 10092.6871 16469.0210  63.2%  1539  230s
  2475  1722 13746.3498   16  123 10092.6871 16469.0210  63.2%  1520  235s
  2623  1796 12773.8222   18  110 10092.6871 16389.5218  62.4%  1514  242s
  2777  1868 11940.3075   20  183 10092.6871 16389.5218  62.4%  1509  250s
  2945  1930     cutoff   29      10092.6871 16298.8604  61.5%  1497  258s
  3136  1982 infeasible   28      10092.6871 16237.7418  60.9%  1485  265s
  3294  2015 12169.7321   10  189 10092.6871 16224.4696  60.8%  1484  272s
  3389  2035 11857.4746   12  167 10092.6871 16186.0980  60.4%  1489  278s
  3499  2060 11223.7712   13  140 10092.6871 16186.0980  60.4%  1490  286s
  3592  2090 infeasible   14      10092.6871 16186.0980  60.4%  1502  293s
  3708  2137 10969.7599   13  194 10092.6871 16186.0980  60.4%  1508  301s
  3832  2192 infeasible   14      10092.6871 16120.5251  59.7%  1504  309s
  4015  2239 10886.1606   14  116 10092.6871 16114.4347  59.7%  1493  318s
  4199  2279     cutoff   16      10092.6871 16085.1669  59.4%  1488  327s
  4405  2355     cutoff    7      10092.6871 16037.0572  58.9%  1491  335s
  4613  2436 infeasible   20      10092.6871 16013.9626  58.7%  1483  344s
  4865  2521 13123.3882   15  303 10092.6871 15973.1950  58.3%  1476  355s
  5097  2647 12735.0195   15  262 10092.6871 15972.0053  58.3%  1479  366s
  5344  2648 10456.6039   17  397 10092.6871 15910.7850  57.6%  1481  384s
  5346  2649 11876.2354   23  112 10092.6871 15910.7850  57.6%  1481  395s
  5347  2650 12701.9577   20  277 10092.6871 15910.7850  57.6%  1480  404s
  5348  2651 12472.0815   24  343 10092.6871 15910.7850  57.6%  1480  409s
  5349  2651 12336.8901   11  316 10092.6871 15910.7850  57.6%  1480  412s
  5350  2652 14915.8938   13  433 10092.6871 15910.7850  57.6%  1480  415s
  5352  2653 10835.2959   23  386 10092.6871 15910.7850  57.6%  1479  420s
  5358  2657 13688.4677   15  437 10092.6871 15910.7850  57.6%  1477  427s
  5361  2659 13393.6636   13  501 10092.6871 15910.7850  57.6%  1477  430s
  5363  2661 11956.1415    9  473 10092.6871 15910.7850  57.6%  1476  435s
  5366  2663 11443.7048   47  446 10092.6871 15910.7850  57.6%  1475  442s
  5369  2665 15122.1319   14  423 10092.6871 15910.7850  57.6%  1474  445s
  5370  2665 11912.8192   12  459 10092.6871 15910.7850  57.6%  1474  450s
  5373  2667 14269.2720   18  580 10092.6871 15910.7850  57.6%  1473  456s
  5376  2669 11813.8050   34  539 10092.6871 15910.7850  57.6%  1472  462s
  5378  2671 13010.9196   13  546 10092.6871 15910.7850  57.6%  1472  467s
  5380  2672 12181.8367   21  549 10092.6871 15910.7850  57.6%  1471  472s
  5381  2673 11294.5544   29  549 10092.6871 15910.7850  57.6%  1471  485s
  5382  2673 13448.6038   17  549 10092.6871 15910.7850  57.6%  1471  491s
  5383  2677 15910.7850   12  400 10092.6871 15910.7850  57.6%  1492  508s
  5385  2680 15910.7850   13  415 10092.6871 15910.7850  57.6%  1493  514s
  5389  2685 15910.7850   14  454 10092.6871 15910.7850  57.6%  1496  518s
  5397  2694 15910.7850   15  463 10092.6871 15910.7850  57.6%  1499  524s
  5411  2705 15910.7850   16  454 10092.6871 15910.7850  57.6%  1512  529s
  5437  2723 15770.8098   17  504 10092.6871 15910.7850  57.6%  1518  534s
  5469  2730 15396.5712   18  461 10092.6871 15770.5480  56.3%  1527  540s
  5507  2745 13416.2703   19  434 10092.6871 15581.3085  54.4%  1551  546s
  5564  2747 13138.0681   20  490 10092.6871 15581.3085  54.4%  1556  552s
  5632  2750 12581.3230   21  286 10092.6871 15082.0263  49.4%  1560  558s
  5683  2754 11920.2613   22  289 10092.6871 14971.1578  48.3%  1564  562s
  5750  2758 12465.8017   23  204 10092.6871 14971.1578  48.3%  1565  566s
  5816  2755     cutoff   24      10092.6871 14971.1578  48.3%  1566  571s
  5884  2747     cutoff   25      10092.6871 14971.1578  48.3%  1567  577s
  5952  2738 11084.7838   26   94 10092.6871 14761.7687  46.3%  1570  584s
  6010  2741 10610.8648   27  382 10092.6871 14761.7687  46.3%  1576  589s
  6066  2742     cutoff   27      10092.6871 14761.7687  46.3%  1577  594s
  6133  2717 10515.2816   29  338 10092.6871 14761.7687  46.3%  1576  601s
  6202  2706 10454.1991   31   86 10092.6871 14387.9131  42.6%  1578  606s
  6269  2694     cutoff   32      10092.6871 14098.2742  39.7%  1579  612s
  6327  2680 11969.0448   20  408 10092.6871 14008.4160  38.8%  1580  617s
  6374  2688 12021.8131   21  299 10092.6871 14000.4773  38.7%  1582  621s
  6423  2682 10698.2483   23  256 10092.6871 14000.4773  38.7%  1581  626s
  6478  2666     cutoff   23      10092.6871 14000.4773  38.7%  1581  632s
  6544  2646 infeasible   23      10092.6871 14000.4773  38.7%  1581  637s
  6616  2637 10573.8818   24  341 10092.6871 14000.4773  38.7%  1580  643s
  6684  2624 11946.7729   21  518 10092.6871 13918.0299  37.9%  1578  649s
  6762  2617 10555.6045   25  337 10092.6871 13918.0299  37.9%  1579  655s
  6853  2589     cutoff   22      10092.6871 13568.5328  34.4%  1581  660s
  6950  2582     cutoff   26      10092.6871 13337.5635  32.2%  1579  667s
  7053  2572 infeasible   30      10092.6871 13296.8800  31.7%  1579  673s
  7165  2552 12003.3630   21  281 10092.6871 13250.6316  31.3%  1578  680s
  7294  2491 11489.5914   23  175 10092.6871 13250.6316  31.3%  1575  688s
  7421  2430 11038.0037   25  275 10092.6871 13087.0205  29.7%  1573  695s
  7540  2393 infeasible   28      10092.6871 12892.3375  27.7%  1578  704s
  7658  2340 11397.1765   21  178 10092.6871 12892.3375  27.7%  1581  713s
  7780  2285 10941.2420   23  175 10092.6871 12792.8737  26.8%  1587  722s
  7919  2217 10970.5737   27  311 10092.6871 12627.4479  25.1%  1591  731s
  8114  2138 10493.5241   31  269 10092.6871 12627.4479  25.1%  1580  740s
  8280  2036 infeasible   35      10092.6871 12563.2397  24.5%  1580  750s
  8497  1904     cutoff   40      10092.6871 12354.8142  22.4%  1570  759s
  8730  1778 infeasible   28      10092.6871 12060.9251  19.5%  1556  767s
  8921  1613     cutoff   19      10092.6871 11990.1751  18.8%  1551  777s
  9150  1423 infeasible   33      10092.6871 11447.7023  13.4%  1540  784s

Cutting planes:
  Learned: 2
  MIR: 240
  Flow cover: 753
  GUB cover: 1
  Inf proof: 1
  Zero half: 18
  RLT: 12
  Relax-and-lift: 38

Explored 9326 nodes (14372956 simplex iterations) in 784.29 seconds (2167.58 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: 10092.7 10081.7 10057.7 ... 5980.41

Optimal solution found (tolerance 1.00e-06)
Best objective 1.009268710142e+04, best bound 1.009268710142e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 784.31s
  Master Objective (UB) = 10092.69, θ = 128252.24
  Upper Bound (UB) = 10092.69

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 128252.24
  [DEBUG]   ✓ Scenario 0: θ = 128252.24 ≤ Q = 128252.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 128252.24 ≤ Q = 128252.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 128252.24 ≤ Q = 128252.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 128252.24 ≤ Q = 128252.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 128252.24 ≤ Q = 128252.24 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x32c1d7be
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x32c1d7be
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.437554e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 7424039.6065
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.332385e+05, 248 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -133238.49    0  124 7424039.61 -133238.49   102%     -    0s
H    0     0                    -98246.63896 -133238.49  35.6%     -    0s
     0     0 -106897.10    0   40 -98246.639 -106897.10  8.80%     -    0s
H    0     0                    -105430.3673 -106835.91  1.33%     -    0s
     0     0 -106493.97    0   37 -105430.37 -106493.97  1.01%     -    0s
     0     0 -106440.92    0   36 -105430.37 -106440.92  0.96%     -    0s
     0     0 -106440.92    0   36 -105430.37 -106440.92  0.96%     -    0s
     0     0 -106440.92    0   36 -105430.37 -106440.92  0.96%     -    0s
H    0     0                    -105645.3241 -106440.92  0.75%     -    0s
H    0     0                    -105673.9452 -106440.92  0.73%     -    0s
H    0     0                    -105695.2322 -106002.20  0.29%     -    0s
     0     0 -106002.20    0   19 -105695.23 -106002.20  0.29%     -    0s
     0     0 -105984.30    0   21 -105695.23 -105984.30  0.27%     -    0s
     0     0 -105984.20    0   19 -105695.23 -105984.20  0.27%     -    0s
     0     0 -105920.10    0   14 -105695.23 -105920.10  0.21%     -    0s
     0     0 -105920.10    0   21 -105695.23 -105920.10  0.21%     -    0s
H    0     0                    -105735.2929 -105920.10  0.17%     -    0s
     0     0 -105903.37    0   15 -105735.29 -105903.37  0.16%     -    0s
H    0     0                    -105794.4851 -105894.30  0.09%     -    0s
H    0     0                    -105827.0134 -105881.77  0.05%     -    0s
     0     0 -105881.77    0   10 -105827.01 -105881.77  0.05%     -    0s
     0     0 -105870.27    0    2 -105827.01 -105870.27  0.04%     -    0s
     0     0 -105870.27    0    7 -105827.01 -105870.27  0.04%     -    0s
H    0     0                    -105869.7181 -105870.27  0.00%     -    0s
     0     0     cutoff    0      -105869.72 -105869.72  0.00%     -    0s

Cutting planes:
  Gomory: 2
  Implied bound: 1
  MIR: 4
  Flow cover: 3
  RLT: 4

Explored 1 nodes (774 simplex iterations) in 0.10 seconds (0.04 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -105870 -105827 -105794 ... 7.42404e+06
No other solutions better than -105870

Optimal solution found (tolerance 1.00e-06)
Best objective -1.058697180682e+05, best bound -1.058697180682e+05, gap 0.0000%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 123556.91
  Scenario: 14 demand increases, 46 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -105869.72
  [DEBUG]   S×d_nominal = 229426.63
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 229426.63 + -105869.72 = 123556.91
  [DEBUG]   Current θ from Master = 128252.24
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4695.33 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 5397.36
  Lower Bound (LB) = 9715.89
  Gap (UB-LB) = 376.8002, Absolute Gap = 376.8002, Relative Gap = 0.037334
  Not converged yet (gap = 376.80 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 14 increases, 46 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 264959 nonzeros
Model fingerprint: 0xfed863d6
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 40602 rows and 16482 columns
Presolve time: 0.71s
Presolved: 52521 rows, 23218 columns, 326009 nonzeros
Variable types: 20959 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -370520.0379
Found heuristic solution: objective -195169.7862

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 52521 rows, 23218 columns, 326009 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   32258   -3.3491518e+02   0.000000e+00   3.330483e+06      5s
   43142    1.7747249e+04   0.000000e+00   1.894174e+07     10s
Concurrent spin time: 0.65s

Solved with dual simplex

Root relaxation: objective 2.742749e+04, 35306 iterations, 10.78 seconds (24.04 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 27427.4942    0  108 -195169.79 27427.4942   114%     -   11s
H    0     0                    -186405.7764 27427.4942   115%     -   11s
H    0     0                    -140598.5182 27427.4942   120%     -   12s
H    0     0                    -139776.5841 27427.4942   120%     -   12s
H    0     0                    -137794.6518 27427.4942   120%     -   12s
H    0     0                    -48640.42807 27427.4942   156%     -   12s
H    0     0                    3053.9854731 27427.4942   798%     -   12s
H    0     0                    5831.3136524 27427.4942   370%     -   12s
H    0     0                    5970.6198444 27427.4942   359%     -   12s
H    0     0                    6013.6035460 27427.4942   356%     -   12s
H    0     0                    6020.7998874 27427.4942   356%     -   13s
H    0     0                    6195.2039170 27427.2117   343%     -   13s
     0     0 24338.2125    0  246 6195.20392 24338.2125   293%     -   16s
H    0     0                    7401.8175974 24336.1703   229%     -   16s
H    0     0                    7513.5374545 24336.1703   224%     -   17s
H    0     0                    7928.3943922 24336.1703   207%     -   17s
H    0     0                    8053.0291858 24336.1703   202%     -   17s
     0     0 24232.9982    0  226 8053.02919 24232.9982   201%     -   18s
     0     0 24232.9894    0  243 8053.02919 24232.9894   201%     -   19s
     0     0 24232.9894    0  243 8053.02919 24232.9894   201%     -   19s
     0     0 21534.4480    0  333 8053.02919 21534.4480   167%     -   24s
H    0     0                    8724.0399575 21534.4480   147%     -   24s
H    0     0                    8735.0589289 21534.4480   147%     -   24s
     0     0 21319.1294    0  331 8735.05893 21319.1294   144%     -   27s
     0     0 21284.6434    0  329 8735.05893 21284.6434   144%     -   27s
     0     0 21220.9244    0  331 8735.05893 21220.9244   143%     -   28s
     0     0 21153.7074    0  340 8735.05893 21153.7074   142%     -   29s
     0     0 21145.4693    0  341 8735.05893 21145.4693   142%     -   29s
     0     0 21100.3310    0  343 8735.05893 21100.3310   142%     -   31s
     0     0 21047.0820    0  344 8735.05893 21047.0820   141%     -   32s
     0     0 21027.5326    0  350 8735.05893 21027.5326   141%     -   32s
     0     0 21024.8548    0  343 8735.05893 21024.8548   141%     -   32s
     0     0 21024.5942    0  346 8735.05893 21024.5942   141%     -   32s
H    0     0                    9508.1762076 21024.5942   121%     -   35s
H    0     0                    9538.2540949 21024.5942   120%     -   35s
H    0     0                    9556.6189083 21024.5942   120%     -   35s
H    0     0                    9730.5314255 21024.5942   116%     -   35s
H    0     0                    9755.0508535 21024.5942   116%     -   35s
     0     0 19604.5829    0  338 9755.05085 19604.5829   101%     -   41s
H    0     0                    9791.5797326 19597.2680   100%     -   41s
H    0     0                    10039.297544 19597.2680  95.2%     -   41s
     0     0 19367.1971    0  354 10039.2975 19367.1971  92.9%     -   43s
     0     0 19291.0866    0  366 10039.2975 19291.0866  92.2%     -   45s
     0     0 19266.1088    0  363 10039.2975 19266.1088  91.9%     -   46s
     0     0 19138.0047    0  354 10039.2975 19138.0047  90.6%     -   47s
     0     0 19106.9392    0  362 10039.2975 19106.9392  90.3%     -   48s
     0     0 19080.4295    0  353 10039.2975 19080.4295  90.1%     -   49s
     0     0 18999.3917    0  354 10039.2975 18999.3917  89.3%     -   49s
     0     0 18983.9049    0  365 10039.2975 18983.9049  89.1%     -   49s
     0     0 18982.2424    0  368 10039.2975 18982.2424  89.1%     -   50s
     0     0 18981.6168    0  366 10039.2975 18981.6168  89.1%     -   50s
     0     0 18581.8660    0  364 10039.2975 18581.8660  85.1%     -   54s
     0     0 18468.7124    0  366 10039.2975 18468.7124  84.0%     -   56s
     0     0 18384.4790    0  357 10039.2975 18384.4790  83.1%     -   57s
     0     0 18370.9009    0  374 10039.2975 18370.9009  83.0%     -   57s
     0     0 18366.7606    0  376 10039.2975 18366.7606  82.9%     -   58s
     0     0 18360.3351    0  370 10039.2975 18360.3351  82.9%     -   58s
     0     0 18358.9613    0  377 10039.2975 18358.9613  82.9%     -   58s
     0     0 18357.0617    0  375 10039.2975 18357.0617  82.9%     -   58s
     0     0 18354.4861    0  381 10039.2975 18354.4861  82.8%     -   59s
     0     0 18354.1525    0  378 10039.2975 18354.1525  82.8%     -   59s
H    0     0                    10046.493885 18300.9735  82.2%     -   61s
     0     0 18300.9735    0  372 10046.4939 18300.9735  82.2%     -   61s
H    0     0                    10062.683140 18300.2478  81.9%     -   61s
     0     0 18259.7927    0  380 10062.6831 18259.7927  81.5%     -   62s
     0     0 18252.1728    0  380 10062.6831 18252.1728  81.4%     -   62s
     0     0 18249.5614    0  394 10062.6831 18249.5614  81.4%     -   63s
     0     0 18246.3738    0  387 10062.6831 18246.3738  81.3%     -   63s
     0     0 18246.2042    0  390 10062.6831 18246.2042  81.3%     -   63s
     0     0 18185.4180    0  384 10062.6831 18185.4180  80.7%     -   65s
H    0     0                    10085.600291 18184.2320  80.3%     -   66s
     0     0 18166.8559    0  386 10085.6003 18166.8559  80.1%     -   68s
     0     0 18166.1248    0  400 10085.6003 18166.1248  80.1%     -   68s
     0     0 18112.3869    0  380 10085.6003 18112.3869  79.6%     -   70s
     0     0 18071.9400    0  388 10085.6003 18071.9400  79.2%     -   71s
     0     0 18067.6142    0  379 10085.6003 18067.6142  79.1%     -   71s
     0     0 18067.1744    0  381 10085.6003 18067.1744  79.1%     -   71s
     0     0 18049.0323    0  384 10085.6003 18049.0323  79.0%     -   72s
     0     0 18041.5665    0  381 10085.6003 18041.5665  78.9%     -   73s
     0     0 18041.5665    0  382 10085.6003 18041.5665  78.9%     -   73s
     0     0 18041.5665    0  388 10085.6003 18041.5665  78.9%     -   73s
     0     0 18037.1694    0  397 10085.6003 18037.1694  78.8%     -   74s
     0     0 18035.7594    0  405 10085.6003 18035.7594  78.8%     -   74s
     0     0 18035.3337    0  410 10085.6003 18035.3337  78.8%     -   74s
     0     0 18019.4939    0  379 10085.6003 18019.4939  78.7%     -   75s
     0     0 18017.0503    0  377 10085.6003 18017.0503  78.6%     -   79s
     0     0 18014.8371    0  378 10085.6003 18014.8371  78.6%     -   79s
     0     0 18014.4466    0  381 10085.6003 18014.4466  78.6%     -   80s
     0     0 18006.5406    0  385 10085.6003 18006.5406  78.5%     -   81s
     0     0 18006.0702    0  382 10085.6003 18006.0702  78.5%     -   81s
     0     0 18004.6936    0  385 10085.6003 18004.6936  78.5%     -   82s
     0     0 18004.6601    0  385 10085.6003 18004.6601  78.5%     -   82s
     0     0 18003.5877    0  386 10085.6003 18003.5877  78.5%     -   82s
     0     0 18002.8168    0  389 10085.6003 18002.8168  78.5%     -   83s
     0     0 18002.8168    0  388 10085.6003 18002.8168  78.5%     -   83s
     0     0 18002.8168    0  388 10085.6003 18002.8168  78.5%     -   84s
     0     2 18002.8168    0  388 10085.6003 18002.8168  78.5%     -   94s
     3     8 17847.5091    2  368 10085.6003 17979.1823  78.3%  1372   97s
     7    16 17302.2396    3  383 10085.6003 17847.4631  77.0%  2984  100s
    15    30 16989.4861    4  391 10085.6003 17580.7703  74.3%  2919  106s
    31    58 16442.3171    5  395 10085.6003 17146.5010  70.0%  4845  110s
    93   120 15968.0158    7  388 10085.6003 16512.2385  63.7%  3069  117s
   139   156 15905.4999    8  419 10085.6003 16440.6219  63.0%  2457  122s
   192   206 15804.3940    9  468 10085.6003 16440.6219  63.0%  2113  128s
   261   260 15803.1586   10  420 10085.6003 16440.6219  63.0%  1831  134s
   331   304 15761.9109   12  421 10085.6003 16316.4110  61.8%  1700  138s
   403   344 15680.1646   14  468 10085.6003 16316.4110  61.8%  1623  142s
   463   380 14403.4248   15  393 10085.6003 16316.4110  61.8%  1628  149s
   527   414 13871.6681   15  435 10085.6003 16272.0401  61.3%  1661  156s
   593   453 14379.1845   16  396 10085.6003 16206.5451  60.7%  1653  161s
   658   479 13173.8857   17  313 10085.6003 16135.9973  60.0%  1680  166s
   704   525 13747.7839   18  363 10085.6003 16133.9845  60.0%  1684  172s
   776   558 13715.5913   19  369 10085.6003 16131.9540  60.0%  1692  176s
   821   603 13647.8997   20  398 10085.6003 16129.0464  59.9%  1771  181s
   952   693 13223.8550   21  400 10085.6003 16129.0464  59.9%  1835  191s
  1022   724 13099.1846   22  383 10085.6003 16129.0464  59.9%  1906  195s
  1087   778 12405.4639   22  251 10085.6003 15937.5826  58.0%  1917  201s
  1162   806 11986.9649   23  237 10085.6003 15898.7244  57.6%  1955  205s
  1253   868 11979.8683   24  238 10085.6003 15898.7244  57.6%  2017  215s
  1370   957 11761.0081   28  225 10085.6003 15861.5942  57.3%  1997  226s
  1456  1012     cutoff   28      10085.6003 15861.5942  57.3%  1946  234s
  1565  1032 14028.7092   12  253 10085.6003 15847.1436  57.1%  1908  240s
  1607  1063 13764.4660   13  361 10085.6003 15786.5058  56.5%  1900  247s
  1662  1082 13554.0884   15  300 10085.6003 15786.5058  56.5%  1886  255s
  1733  1128 13006.1396   18  235 10085.6003 15786.5058  56.5%  1868  262s
  1817  1182 12030.9141   20  229 10085.6003 15780.5353  56.5%  1840  270s
  1939  1222 11679.6472   22  320 10085.6003 15780.5353  56.5%  1781  275s
  2069  1252 11345.3747   26  308 10085.6003 15780.5353  56.5%  1738  281s
  2179  1282 10789.3566   29  245 10085.6003 15571.3516  54.4%  1728  288s
  2312  1315 13751.4043   13  238 10085.6003 15571.3516  54.4%  1710  295s
  2421  1344 13420.0420   16  254 10085.6003 15387.1818  52.6%  1709  304s
  2526  1405     cutoff   18      10085.6003 15387.1818  52.6%  1728  312s
  2644  1443 11474.3660   20  214 10085.6003 15387.1818  52.6%  1727  320s
  2798  1457 10642.3465   22  183 10085.6003 15387.1818  52.6%  1710  329s
  2951  1486 13444.3509   13  251 10085.6003 15387.1818  52.6%  1707  339s
  3108  1520 11268.1477   16  214 10085.6003 15330.3568  52.0%  1706  349s
  3278  1521     cutoff   19      10085.6003 15217.6991  50.9%  1703  360s
  3458  1529 10516.6797   23  241 10085.6003 14981.1077  48.5%  1700  368s
  3514  1546     cutoff   24      10085.6003 14839.2857  47.1%  1706  375s
  3562  1554 13965.4359   10  234 10085.6003 14839.2857  47.1%  1717  384s
  3662  1567 13834.2032   11  232 10085.6003 14811.6063  46.9%  1706  394s
  3813  1596 11529.9566   15  131 10085.6003 14772.8844  46.5%  1690  404s
  3964  1643     cutoff   21      10085.6003 14772.8844  46.5%  1695  414s
  4161  1681     cutoff   11      10085.6003 14638.0450  45.1%  1695  424s
  4367  1694     cutoff   15      10085.6003 14638.0450  45.1%  1751  436s
  4623  1733 13648.5916   13  236 10085.6003 14447.1961  43.2%  1743  449s
  4839  1743 11942.5581   17  203 10085.6003 14279.8622  41.6%  1748  461s
  5081  1744     cutoff   36      10085.6003 14129.2710  40.1%  1750  474s
  5334  1753 11088.3391   21  155 10085.6003 13992.4538  38.7%  1751  488s
  5598  1732 12114.6173    9  187 10085.6003 13901.2749  37.8%  1752  500s
  5904  1715 infeasible   11      10085.6003 13852.6595  37.4%  1777  513s
  6085  1735 12627.5601   19  215 10085.6003 13852.6595  37.4%  1789  524s
  6346  1731     cutoff   25      10085.6003 13710.0849  35.9%  1781  539s
  6676  1705 11034.5338   30  152 10085.6003 13624.4073  35.1%  1776  553s
  7012  1716     cutoff   15      10085.6003 13481.9125  33.7%  1813  571s
  7333  1668 11230.0720   11  243 10085.6003 13357.7152  32.4%  1806  589s
  7723  1627     cutoff   22      10085.6003 13193.9887  30.8%  1791  607s
  8090  1570 10872.4347   21  196 10085.6003 13097.0540  29.9%  1786  624s
  8568  1503     cutoff   19      10085.6003 12824.0617  27.2%  1764  642s
  9024  1308     cutoff   20      10085.6003 12743.3382  26.4%  1752  660s
  9560  1142     cutoff   16      10085.6003 12517.7106  24.1%  1722  681s
 10156   924 infeasible   14      10085.6003 12273.7074  21.7%  1694  700s
 10823   585 10438.9094   23  223 10085.6003 12090.3600  19.9%  1662  723s
 11601   188 11337.0627   16  250 10085.6003 11779.3999  16.8%  1621  741s
 12352     0 11085.0617   19  154 10085.6003 11406.3163  13.1%  1580  751s

Cutting planes:
  Learned: 1
  Implied bound: 27
  MIR: 540
  Flow cover: 811
  Zero half: 10
  RLT: 22
  Relax-and-lift: 11

Explored 12652 nodes (19878175 simplex iterations) in 751.43 seconds (2260.40 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: 10085.6 10062.7 10046.5 ... 9508.18

Optimal solution found (tolerance 1.00e-06)
Best objective 1.008560029148e+04, best bound 1.008560029148e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 751.45s
  Master Objective (UB) = 10085.60, θ = 128086.51
  Upper Bound (UB) = 10085.60

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 128086.51
  [DEBUG]   ✓ Scenario 0: θ = 128086.51 ≤ Q = 128086.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 128086.51 ≤ Q = 128086.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 128086.51 ≤ Q = 128086.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 128086.51 ≤ Q = 128086.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 128086.51 ≤ Q = 128086.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 128086.51 ≤ Q = 128086.51 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x50140e2c
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x50140e2c
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.436613e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 7416362.9249
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.334667e+05, 248 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -133466.75    0  124 7416362.92 -133466.75   102%     -    0s
H    0     0                    -98438.66101 -133466.75  35.6%     -    0s
     0     0 -101763.24    0   36 -98438.661 -101763.24  3.38%     -    0s
H    0     0                    -100705.8803 -101705.19  0.99%     -    0s
     0     0 -101582.74    0   78 -100705.88 -101582.74  0.87%     -    0s
     0     0 -101581.70    0   78 -100705.88 -101581.70  0.87%     -    0s
H    0     0                    -100845.9951 -101581.70  0.73%     -    0s
H    0     0                    -100927.7466 -101581.70  0.65%     -    0s
     0     2 -101581.70    0   78 -100927.75 -101581.70  0.65%     -    0s
H   39    15                    -101387.7541 -101459.26  0.07%   8.1    0s
*   57     0               7    -101452.7491 -101452.75  0.00%   6.9    0s

Cutting planes:
  Gomory: 8
  MIR: 145

Explored 64 nodes (813 simplex iterations) in 0.11 seconds (0.05 work units)
Thread count was 32 (of 256 available processors)

Solution count 8: -101453 -101388 -100928 ... 1.43661e+13
No other solutions better than -101453

Optimal solution found (tolerance 1.00e-06)
Best objective -1.014527491249e+05, best bound -1.014527491249e+05, gap 0.0000%
  Subproblem solved in 0.13s
  Worst-case operational profit (Z_SP) = 128019.30
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -101452.75
  [DEBUG]   S×d_nominal = 229472.05
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 229472.05 + -101452.75 = 128019.30
  [DEBUG]   Current θ from Master = 128086.51
  [DEBUG]   ⚠️  Z_SP ≤ θ by 67.20 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 10018.40
  Lower Bound (LB) = 10018.40
  Gap (UB-LB) = 67.2013, Absolute Gap = 67.2013, Relative Gap = 0.006663
  *** CONVERGED (gap within tolerance) ***

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 6
Total Time: 2289.22s
Converged: True
Final Lower Bound: 10018.3990
Final Upper Bound: 10085.6003
Final Gap: 67.201250
Number of Critical Scenarios: 6
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [0] (1/3)
Product 1 Plants: [2] (1/3)
Product 2 Plants: [1] (1/3)
Total Plant Openings: 3
DCs Opened: [3, 5, 9] (3/10)
Active Routes (Plant→DC): 9
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 6 customers  Mode 1: 3 customers  Mode 2: 41 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 6
Start Time: 2026-01-04 09:06:57
End Time: 2026-01-04 09:45:06
Total Time: 2289.22s
Optimal Value: 10018.40
Lower Bound: 10018.40
Upper Bound: 10085.60
Gap: 67.201250
Plants Opened: {0: [0], 1: [2], 2: [1]} (3 plants)
DCs Opened: [3, 5, 9] (3 DCs)
================================================================================

Results saved to: result/DH_single_full_seed35_Mixed_gamma20_20260104_094506.csv

Total Execution Time: 2289.93 seconds
End Time: 2026-01-04 09:45:07

All tasks completed successfully!

